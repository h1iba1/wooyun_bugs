{"id": 50141, "wybug_id": "wooyun-2014-078767", "wybug_title": "All Versions Of KinEditor Cross Site Scripting", "wybug_corp": "Cncert", "wybug_author": "路人甲", "wybug_date": "2014-10-11 17:12", "wybug_open_date": "2015-01-09 17:14", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-09：\t细节向公众公开  简要描述： KinEditor所有版本都存在XSS漏洞 详细说明：  一不小心发现的~无限制可以插入任意的恶意脚本~!\nhttp://kindeditor.net/ 官网 4.1.10 版本最新版\n我相信很多CMS、BBS之类的都在用这个编辑器吧，这个富文本编辑器存在一处XSS漏洞，从老版本到最新的版本都没有修复该漏洞，无限制可以插入任意的恶意脚本~!\n\n   漏洞证明：  这里我就拿一个CMS来测试：http://www.74cms.com/  骑士CMS最新版，附带了最新的Kindeditor~ 这个后台用到了kindeditor编辑器（PS：这个编辑器不是只是后台的，很多论坛、CMS、评论的地方都有这个编辑器，比如说、phpyun人才系统、之前的乌云的drops投稿就用到了这个编辑器)...#1.先看~这个编辑器的。是最新版的~\n\n#2.漏洞是这样产生的，先使用Kindeditor编辑器的插入图片随便上传一张图片。然后——提交内容，也就是发表。这时候就要抓包了~\n\n抓包后在content中有一句图片的html代码，这段图片的html代码压根就没有过滤检查，直接导致了存储型XSS。可以替换为<img src=# onerror=alert(document.cookie)>或者<script>alert(document.cookie)</script>、<iframe/onload=alert(document.cookie)>一类的，至于XSS更多玩法请参考百度把~钓鱼、截屏、弹窗、盗cookie之类的。这时候我们来看看前台的新闻,弹了：\n\n看看源代码是怎么样的~\n\n看看~<script>alert(document.cookie)</script>是否可以插入，照样，经过测试了各种XSS，都没问题~\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-10-16 09:08 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}