{"id": 49030, "wybug_id": "wooyun-2014-075473", "wybug_title": "某通用型学习系统两处任意密码修改到后台GetShell（影响数百所学校)", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "魇", "wybug_date": "2014-09-10 12:48", "wybug_open_date": "2014-12-09 12:52", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-09：\t细节向公众公开  简要描述： BOOM! 详细说明：  前人漏洞： WooYun: 某通用型学习系统前台无限制Getshell（影响数百所学校) 由中央广播电视大学现代远程教育开发的一套资源中心系统存在任意帐号密码漏洞，后台可上传任意文件导致代码执行，影响全国所有分中心，几百所以上的学校。貌似主管是国家数字化学习资源中心。几乎涵盖全国所有省谷歌搜索：http://music.google.cn/search?newwindow=1&site=webhp&source=hp&q=%E2%80%9C%E6%8A%80%E6%9C%AF%E6%94%AF%E6%8C%81%EF%BC%9A%E4%B8%AD%E5%A4%AE%E5%B9%BF%E6%92%AD%E7%94%B5%E8%A7%86%E5%A4%A7%E5%AD%A6%E7%8E%B0%E4%BB%A3%E8%BF%9C%E7%A8%8B%E6%95%99%E8%82%B2%E8%B5%84%E6%BA%90%E4%B8%AD%E5%BF%83%E2%80%9D&btnG=Google+%E6%90%9C%E7%B4%A2 找到约 4,770,000 条结果 （用时 0.15 秒）影响实例：\nnerc.szpt.edu.cn/FrontEnd/default.aspxnerc.lnnzy.ln.cn/FrontEnd/default.aspxzy.cdrtvu.com/FrontEnd/default.aspx210.28.225.145/FrontEnd/default.aspx110.167.234.52/FrontEnd/default.aspx222.133.182.235/FrontEnd/default.aspxxxzy.hekg.cn/FrontEnd/default.aspxnerc.gdjmxx.com/FrontEnd/default.aspxnerc.gzedu.com/FrontEnd/default.aspxnerc.hebnetu.edu.cn/FrontEnd/default.aspxzyzx.whtvu.com.cn/FrontEnd/default.aspx222.91.161.219/FrontEnd/default.aspxlearn.nerc-edu.com/FrontEnd/default.aspxresource.jsgyve.com/FrontEnd/default.aspxzyzx.shztvu.com:8002/FrontEnd/default.aspx210.28.216.240/FrontEnd/default.aspxlearn.ybzy.cn/FrontEnd/default.aspx61.177.123.76/FrontEnd/default.aspxzzxxw.com.cn/FrontEnd/default.aspx218.13.33.153/FrontEnd/default.aspxres.yxgcx.com:8080/FrontEnd/default.aspxnerc.szrtvu.com.cn/FrontEnd/default.aspx218.26.168.18/FrontEnd/default.aspxzyzx.gtxy.cn/FrontEnd/default.aspxnerc.wxtvu.cn/FrontEnd/default.aspx61.186.170.110:8000/FrontEnd/default.aspx218.57.132.10:8080/FrontEnd/default.aspxnerc.cswu.cn/FrontEnd/default.aspxnerc.xartvu.sn.cn/FrontEnd/default.aspxnerc.lyvec.net/FrontEnd/default.aspxrc.niit.edu.cn/FrontEnd/default.aspxnerc.hljcedu.com/FrontEnd/default.aspx222.91.161.219/FrontEnd/default.aspxnerc.hnrtu.edu.cn/FrontEnd/default.aspx121.15.1.26/FrontEnd/default.aspx124.152.245.50/FrontEnd/default.aspx218.22.21.231/FrontEnd/default.aspxzzxxw.cn/FrontEnd/default.aspx218.20.222.100:801/FrontEnd/default.aspxwhgjjx.cn:8088/FrontEnd/default.aspxwebmedia.fjrtvu.edu.cn:81/FrontEnd/default.aspx\n   漏洞证明：  以http://nerc.szpt.edu.cn/FrontEnd/default.aspx 深圳职业技术学院为例前台忘记密码处，找回密码 http://nerc.szpt.edu.cn/frontend/member/FindPwd.aspx（这里说明一下，该系统用户名注册自带后缀，且每个学校的后缀均不同，比如深圳职业技术学院是【用户名】:szzyj 管理员帐号默认为admin）\n\n0x1: 找回管理员的帐号密码,也就是 admin:szzyj 提交之后查看源代码\n\n\n\n\n\n\n\n\n\n\n\n0x2:注册一个帐号（填写密保问题答案）-找回密码-输入自己注册的帐号- 密保验证成功后到输入密码界面-修改参数-密码修改成功例： 自注帐号 a123456:szzyj  提示问题：    a123456  提示答案：a123456\n\n\n\n\n\n\n\n讲hfID修改为6472dc67-13a7-49d7-9d72-1b063cdf4b32 （其中6472dc67-13a7-49d7-9d72-1b063cdf4b32就是admin帐号，这个hfID值是我通过第一个任意密码修改得出的，虽然不能实现任意密码修改 只能重置admin 但是admin是管理员帐号，只要重置了这个帐号就可以GetShell，而且经过我对其他站点的测试，这个hfID值是不变的）然后是后台GetShell，经过任意密码修改漏洞我将admin:szzyj 密码修改为123456\n\n\n\n在系统配置这里可以修改上传图片格式，加个|asp,直接上传一句话\n\n\n\n   修复方案：     版权声明：转载请注明来源 魇@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2014-09-15 10:36 厂商回复： CNVD确认并复现所述情况（由上海交通大学网络信息中心协助完成），同时转报给教育网应急组织，由其后续协调处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-06 01:27 |    \t\tJumbo \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:29        | 猫 - http://www.chinabaiker.com)\t\t \n  没看懂，这个文件是传到哪个目录了    \n     2014-12-21 13:18 |    \t\t用来怀念 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 不是什么人都一定要去拥有，有的东西最好用...)\t\t \n  求楼主解答一下，上传后的路径在哪里啊？？？    \n     2014-12-21 13:26 |    \t\t用来怀念 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 不是什么人都一定要去拥有，有的东西最好用...)\t\t \n  找到了，不过执行权限限制了，谢谢楼主分享~！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}