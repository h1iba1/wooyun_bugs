{"id": 10898, "wybug_id": "wooyun-2013-023296", "wybug_title": "ecshop最新版本一处用户权限越权", "wybug_corp": "ShopEx", "wybug_author": "blue", "wybug_date": "2013-05-08 17:08", "wybug_open_date": "2013-08-06 17:08", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "设计缺陷", "敏感信息泄漏", "认证缺陷", "越权操作", "敏感操作校验不足", "敏感接口缺乏校验", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-07-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-06：\t细节向公众公开  简要描述： 用户权限越权，这位置光看代码是肯定找不到滴，需要缜密的探查和思考，我觉得我就是个侦探家～～ 详细说明：  在下订单的时候，修改收货人信息时，有个隐藏的address_id，修改这个address_id再点击“配送到这个收货地址”，便修改了address_id对应的地址(实际上address_id原来对应的用户的这个地址即被删除，因为地址归属到了当前用户)，遍历就能清空所有用户的收货地址了。\n/includes/lib_transaction.php 516行,save_consignee方法if ($consignee['address_id'] > 0)    {        /* 修改地址 */        $res = $GLOBALS['db']->autoExecute($GLOBALS['ecs']->table('user_address'), $consignee, 'UPDATE', 'address_id = ' . $consignee['address_id']); //看，没判断user_id吧？    }\n   漏洞证明：  \n\n\n\n\n\n   修复方案：  save_consignee方法判断user_id   版权声明：转载请注明来源 blue@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2013-05-08 20:36 厂商回复： 感谢您为shopex安全做的贡献我们会尽快处理非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-08 17:09 |    \t\tw5r2 \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:52        )\t\t \n  ding!    \n     2013-05-08 17:35 |    \t\tdyun \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:15        | [code][/code])\t\t \n  @blue 一会艺术家，一会侦探家，你到底是什么家...    \n     2013-05-08 17:43 |    \t\tblue  \t\t\t( 普通白帽子  |\t\t\t        Rank:779 漏洞数:70        | 我心中有猛虎，细嗅蔷薇。)\t\t \n  @dyun 起码是个画家~_^    \n     2013-05-09 00:26 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  @blue  你今年多大？    \n     2013-05-09 09:16 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  这个简单描述 好牛    \n     2013-05-09 09:36 |    \t\tkimdle \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | @kimdle)\t\t \n  @blue 厉害啊!    \n     2013-05-09 10:18 |    \t\tblue  \t\t\t( 普通白帽子  |\t\t\t        Rank:779 漏洞数:70        | 我心中有猛虎，细嗅蔷薇。)\t\t \n  @_Evil 到了能当班主任的年龄了    \n     2013-08-07 09:25 |    \t\tsoftbug \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:10        | 为人类设计最好的软件，解放人的双手,一起...)\t\t \n  厂商用心来感谢你，    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}