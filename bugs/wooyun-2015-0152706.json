{"id": 81844, "wybug_id": "wooyun-2015-0152706", "wybug_title": "新为某通用系统注入漏洞大最用户信息泄露（无需登陆）", "wybug_corp": "新为软件", "wybug_author": "路人甲", "wybug_date": "2015-11-09 15:42", "wybug_open_date": "2015-12-24 15:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-09：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-12-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 新为某通用系统注入漏洞，大最用户信息泄露（无需登陆） 详细说明：  该系统是新为软件的smartbos管理系统，新为软件是目前中国最大的学习管理软件提供商之一。该系统的使用量非常之大，先来看看官方给的使用情况吧企业：http://**.**.**.**/case_enterprise.html教育：http://**.**.**.**/case_college.html政府：http://**.**.**.**/case_government.html部分案例截个图\n\n下面说说该漏洞吧，首先是多个注入漏洞：/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123这里的productUid存在注入，注意，这里的参数type一定要为：webcomment！！！简单在网上找了几个案例来测试：\nhttp://**.**.**.**:8080/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123**.**.**.**:89/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**:8080/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123**.**.**.**:8080/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123**.**.**.**:8888/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**//site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**//site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://volvo.infolearning.so/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**//site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**//site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**/kl/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123**.**.**.**:8088//site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123**.**.**.**//site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**/gsedu_admin/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://chrysler.infolearning.so//site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123**.**.**.**//site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123**.**.**.**/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123**.**.**.**/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**:8080/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123**.**.**.**:89/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123**.**.**.**:8888/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**:8080/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123**.**.**.**:8080/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123http://**.**.**.**/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123**.**.**.**:9999/cloud/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123\n这里我们就随便选一个来做个验证，我们选“华东理工大学”来做测试http://**.**.**.**/site/ajax/CommentAjax.aspx?type=webcomment&isFirstOpen=Y&contentUid=123注入参数contentUid先来张注入点的图\n\n从上面的图中我们可以看到，back-end DBMS: Microsoft SQL Server 2008，而我们知道，这个版本的xp_cmdshell默认是关闭的，我们若要使用它，就必须先把它打开。而打开xp_cmdshell又对我们获得的权限提出了要求，我们看看这个注入点的权限\n\n\n\n看到这里，我就乐了，有了sa，后面的操作就会更加顺利了吧首先启用xp_cmdshell然后顺利得到os-shell\n\n到这里，我们可以做的事情就多了，点到为止吧数据库\n\n这么多表，信息量应该不小吧\n\n最后在表nv_user里看看管理员信息吧\n\n试着解密一下看看Username：yaojundPassword：mde123登录\n\n有接近9W多的数据，这些用户的信息信息都可以在数据库中得到，当然包括他们的密码点到为止了   漏洞证明：  见 详细说明   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}