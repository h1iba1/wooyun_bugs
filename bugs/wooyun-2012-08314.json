{"id": 18732, "wybug_id": "wooyun-2012-08314", "wybug_title": "优米社区nginx解析+主站爆绝对路径", "wybug_corp": "优米网", "wybug_author": "Seay", "wybug_date": "2012-06-15 11:05", "wybug_open_date": "2012-07-30 11:06", "wybug_type": "应用配置错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-15：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-07-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： nginx解析漏洞，服务器配置问题，80sec发出的一个洞洞，优米BBS存在该漏洞，图片后加/*.php可以解析成php 详细说明：  http://upload.umiwi.com/2011/0905/1315207969664.jpg/1.php  爆网站绝对路径http://bbs.umiwi.com/static/image/common/logo.png/1.php  优米论坛nginx解析漏洞   漏洞证明：  \n\nhttp://bbs.umiwi.com/static/image/common/logo.png/1.php\n\n   修复方案：  引用自百度：1 关闭php.ini里的path_info，cgi.path_info设置成0.如果默认前面有;或者就没这段，就手动加上cgi.path_info = 0，2 修改nginx里的设置。比如原始文件server {        listen       80;        server_name typengine.com;        location / {                root   /home/www/typengine.com;                index index.php index.html index.htm;                autoindex on;             }        location ~ \\.php$ {            root           html;            fastcgi_pass   127.0.0.1:9000;            fastcgi_index index.php;if ( $fastcgi_script_name ~ \\..*\\/.*php ) {    return 403;}            fastcgi_param SCRIPT_FILENAME /home/www/typengine.com$fastcgi_script_name;            include        fastcgi_params;        }}对应的有下划线的部分就是需要添加的内容。   版权声明：转载请注明来源 Seay@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-05-02 10:32 |    \t\t优米网(乌云厂商)\t\t \n  已经修复    \n     2013-05-02 21:26 |    \t\tSeay \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:8        )\t\t \n  @优米网 老大，都一年过去了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}