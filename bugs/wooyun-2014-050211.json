{"id": 4460, "wybug_id": "wooyun-2014-050211", "wybug_title": "微信存储xss绕过过滤可弹窗可钓鱼他人账号", "wybug_corp": "腾讯", "wybug_author": "一剑萧寒", "wybug_date": "2014-02-02 19:53", "wybug_open_date": "2014-05-03 19:53", "wybug_type": "远程代码执行", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "利用技巧", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-09：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-04-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-03：\t细节向公众公开  简要描述： 之前看到某大牛爆出微信<a>的xss，随后又试了试，虽然过滤了href，但是还能绕过过滤。 详细说明：  在两个账号上面进行测试。。。首先看一下微信版本，5.2，最新版本：\n\n然后试一试之前大牛所谓的代码：\n\nhref=\"javascript\"的那个直接就被过滤了，那就试一试href=\"url\"的情况吧：\n\nrt，本地没有问题，但是登陆另一个账号就不行了，url被过滤了。。。\n\n打开消息看看，成了这个样子。。。\n\n于是突发奇想，试一试两个href，他会不会只过滤一个呢？发送代码：\n<a href=\"www.wooyun.org\" href=\"www.wooyun.org\">baidu</a>\n登录另一个账号，结果正如我所猜想。。。\n\n打开连接\n\n从显示的连接看，的确没有过滤第一个href，结果把www.wooyun.org\" href=\"当做链接，那么接下来就好说了。。。用这个代码来突破限制：\n<a href=\"javascript:window.alert(1);\" href=\"任意url\">xss</a>\n\n\n这里有三个关键点，一个是js代码后的;必不可少，还有就是第二个url一定要正确，只要可以被过滤即可，第三个是”xss“处一定要写点东西，否则就会失败。。。然后登录另一个账号，我弹~\n\n\n\n利用跳转钓鱼也so easy了\n<a href=\"javascript:window.location.href='钓鱼url';\" href=\"任意url\">xss</a>\n发送代码：\n\n\n\n注意这里的钓鱼url前一定要加http://，否则无法就会失败。。。登录另一个账号，果断跳转。。。\n\n\n\n   漏洞证明：  \n\n\n\n   修复方案：  再过滤吧。。。   版权声明：转载请注明来源 一剑萧寒@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-02-06 14:33 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-02-02 20:02 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  Mark!前排火速留名~    \n     2014-02-02 20:03 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2014-02-02 20:08 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  厉害！    \n     2014-02-02 20:30 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  楼主这么屌，腾讯知道没    \n     2014-02-02 20:34 |    \t\t漫步云端 \t\t\t( 普通白帽子  |\t\t\t        Rank:196 漏洞数:33        | I'm Ramble!)\t\t \n  被雷劈了！    \n     2014-02-02 21:31 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  大牛是我把？你是不是利用我的XSS来进行利用？    \n     2014-02-02 21:43 |    \t\t一剑萧寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:8        | 岁月无情人愿意，为你闯开新故事...)\t\t \n  @泳少 根据路人甲大牛的xss来滴~ WooYun: 微信的一个鸡肋XSS    \n     2014-02-03 10:15 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @一剑萧寒 不对啊~你看看这个WooYun: 微信出现XSS攻击    \n     2014-02-03 16:19 |    \t\t一剑萧寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:8        | 岁月无情人愿意，为你闯开新故事...)\t\t \n  这个木有公开啊。。。    \n     2014-02-03 16:19 |    \t\t一剑萧寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:8        | 岁月无情人愿意，为你闯开新故事...)\t\t \n  @泳少 你这个木有公开啊。。。    \n     2014-02-03 18:43 |    \t\t天一生水 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        )\t\t \n  关注。。    \n     2014-02-04 10:18 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @一剑萧寒 公开了好不滴~你在漏洞预警第二页找找~    \n     2014-02-26 17:23 |    \t\tfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:664 漏洞数:79        | 想刷个6D)\t\t \n  貌似看到了不该看到的，啥叫TOKYO-HOT啊    \n     2014-04-03 08:58 |    \t\t【|→上善若水】 \t\t\t( 普通白帽子  |\t\t\t        Rank:127 漏洞数:25        | 【|→上善若水】)\t\t \n  老早以前就有了    \n     2014-05-03 23:19 |    \t\tm_vptr \t\t\t( 普通白帽子  |\t\t\t        Rank:133 漏洞数:30        | 新手)\t\t \n  闪电 ＋ $$  !!!    \n     2014-05-03 23:36 |    \t\t暗影侠客 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:5        | xss,inject,ctrf)\t\t \n  我去，这么屌，你妈不知道吧！！！！！    \n     2014-05-04 09:35 |    \t\t野驴~ \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 充满强烈好奇心的菜鸟。)\t\t \n  我去，雷击加美元,第一次见那。    \n     2014-05-04 10:01 |    \t\tJuly \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:8        | 红星闪闪)\t\t \n  思路不错    \n     2014-05-04 11:30 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  按我的视角打分了 楼主    \n     2014-05-04 15:19 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  好思路！    \n     2014-05-04 16:06 |    \t\t Jesus \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:18        | 天地不仁,以万物为刍狗！)\t\t \n  这个有点意思。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}