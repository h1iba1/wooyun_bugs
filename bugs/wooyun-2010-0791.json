{"id": 23818, "wybug_id": "wooyun-2010-0791", "wybug_title": "人人桌面挂马漏洞", "wybug_corp": "人人网", "wybug_author": "路人甲", "wybug_date": "2010-11-06 23:34", "wybug_open_date": "2010-12-07 00:00", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["客户端软件", "过滤不全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-11-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2010-11-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2010-11-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2011-01-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-01-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-01-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2010-12-07：\t细节向公众公开  简要描述： 人人桌面程序对用户发表的日志中的html代码直接解析，造成攻击者有机会成功进行挂马攻击 详细说明：  在人人中发布一篇日志，期中含有html代码，在人人桌面中就会一网页方式解析这些代码，这样如果发布一个带有挂马代码或者其他恶意代码的日志，就会对通过人人桌面程序阅读或者回复这篇日志的用户完成一次攻击。   漏洞证明：  先在人人中发布一篇日志内容为:\n<html><head><title>test</title></head><body><iframe src=\"http:\\\\www.baidu.com\" weight=\"200\" height=\"500\"></iframe></body></html>\n发布后我们可以看到，在人人网页中文字没有问题（图1），而在我的好友的人人桌面中打开这篇日志（图2），可以看到代码被成功解析了，把百度的地址换成网页木马的地址，当好友用人人桌面访问时一次挂马攻击就完成了。\n\n图1\n\n图2   修复方案：  在人人桌面对用户发表的日志中的代码进行转意   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2010-11-08 12:28 厂商回复： 没有收到email通知，跑过来看到。谢谢反馈。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2010-12-07 10:42 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这里到客户端之后应该可以看看是什么权限 另外是如何实现的 自己实现的ie控件会少很多的安全限制：）    \n     2010-12-07 13:55 |    \t\tlupin \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:48        | 尊重自己的爱好 远离利益的罪恶)\t\t \n  要怎么看是什么权限？？    \n     2011-12-22 17:55 |    \t\tAnthr@X \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | Where there's a will,there's a way.)\t\t \n  这里已经可以用xss把人人桌面的token发送出去了，就是一个连接，复制到浏览器里打开可以直接登录    \n     2012-03-07 12:53 |    \t\t大肠 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 入侵研究 seo技术)\t\t \n  @Anthr@X 关注下 其实还有很多类似的通讯软件或者其他有此类漏洞。不解释。    \n     2012-04-10 12:48 |    \t\tCplusHua \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:33        | 乌云奖金:-1)\t\t \n  我使用的一个人人手机客户端也是    \n     2013-01-08 11:06 |    \t\trivers \t\t\t( 实习白帽子  |\t\t\t        Rank:85 漏洞数:10        | research on web security)\t\t \n  怀疑手机上类似情况更多，期待大牛挖掘    \n     2013-01-10 12:49 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  wap的漏洞估计会比web更容易被忽略    \n     2013-04-20 22:43 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @xsser 这个怎么感觉不算是逻辑错误，应该是一个储存xss诶、。、    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}