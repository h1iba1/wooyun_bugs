{"id": 49749, "wybug_id": "wooyun-2014-080204", "wybug_title": "邢台市人民检察院SQL注入导致后台沦陷Getshell", "wybug_corp": "邢台市人民检察院", "wybug_author": "路人甲", "wybug_date": "2014-10-21 15:25", "wybug_open_date": "2014-12-05 15:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-05：\t细节向公众公开  简要描述： 邢台市人民检察院SQL注入导致后台沦陷Getshell 详细说明：  1.邢台市人民检察院 http://www.xtkfqjcy.gov.cn/index.asp\n\n2.搜索功能存在POST型SQL注入，搜索 1'%'\"报错\n\n报错\n\n3.手工尝试得出管理员表为admin，存在字段username、password4.使用python编写脚本得到admin管理员的密码MD5为a34879a2ae60c608\n\n5.扫描得到后台 http://www.xtkfqjcy.gov.cn/admin/login.asp\n\n6.登陆成功\n\n7.在后台网站设置处尝试写入一句话\n\n8.shell连接成功\n\n9.删除shell   漏洞证明：  后台写shell\n\nshell\n\n   修复方案：  1.search.asp过滤post数据2.管理员密码设置复杂一些   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-10-25 23:59 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}