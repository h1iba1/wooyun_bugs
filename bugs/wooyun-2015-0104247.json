{"id": 45114, "wybug_id": "wooyun-2015-0104247", "wybug_title": "巨人旗下某平台未授权访问可上传文件", "wybug_corp": "巨人网络", "wybug_author": "路人甲", "wybug_date": "2015-03-27 18:06", "wybug_open_date": "2015-04-01 18:08", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["未授权访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 巨人旗下某平台未授权访问，泄露部分源码信息，可上传文件 详细说明：  rsync未授权访问，ip为222.73.30.163，含app.scloudm.com，huodong.app.scloudm.com，huodong.gamm.ztgame.com，admin.scloudm.com源码文件，可读写\nrsync 222.73.30.163::fabudrwx------        4096 2015/01/16 10:16:31 .-rwx------        1113 2014/12/01 10:52:57 云测需要的接口.txt-rwx------        4406 2015/01/16 10:16:30 推送接口20141113.txtdrwx------        4096 2014/12/01 10:51:59 admindrwx------        4096 2014/12/01 10:51:58 huodongdrwx------        4096 2014/12/01 10:51:46 nebula_svrdrwx------        4096 2014/12/01 10:52:57 yiiframeworkcat 推送接口20141113.txt调用接口地址：http://app.scloudm.com/app/push_app_info请求参数如下：id                                      你们这边的idname                            名称，汉字或者英文啥的developer                       开发者名称，英文或者汉字version                         版本号，不传的话默认1.0app_updtime                     时间戳，如1414576078description                     简介screenshots                     以竖线|字符分割的多个完整URL，只有一个也可以，一个就不要竖线分割了。intro                           详细介绍upd_info                        更新信息cover_img                       封面图，没有就留空icon_img                        icon图标图，没有就留空pkg_size                        字节数，intpkg_name                        包名pkg_url                         apk下载地址platform                        请写ANDROID//增补参数category                        目前分类如下：    1  => 网络游戏    2  => 休闲游戏    3  => 角色扮演    4  => 体育竞速    5  => 动作射击    6  => 益智棋牌    7  => 娱乐休闲    8  => 便捷生活    9  => 常用工具    10 => 聊天社交    11 => 购物理财    12 => 其他应用请直接传int数字。credit_reward       下载送积分，默认为0，int型fake_downloads      假的下载次数，默认0. 给用户展示的下载数就是这个数字加上真实的下载数。extra_mark          默认为空，可以为以下值：    firstpub    => 首测    hot         => 热门    recommend   => 推荐    lottery     => 活动//增补参数结束sign  签名//12月3日需求： credit_reward fake_downloads extra_mark 三个参数无效。签名规则：按照上面字段，进行字典序排序，例如以下数据id => 123name => 测试名称developer => 巨人version => v1.0.0app_updtime => 1414576078description => 简介，测试数据screenshotsintro => 详细介绍，测试数据upd_info => 更新1.0正式版，更多新功能 ，修复bug，iphone6Plus适配cover_img => icon_img => http://xxxxxxxpkg_size => 12354454222pkg_name => com.ztgame.jurenpkg_url => http://www.ztgame.com/releasexxxplatform => IOScategory => 1排序后应该是    [app_updtime] => 1414576078    [category] => 1    [cover_img] =>     [description] => 简介，测试数据    [developer] => 巨人    [icon_img] => http://xxxxxxx    [id] => 123    [intro] => 详细介绍，测试数据    [name] => 测试名称    [pkg_name] => com.ztgame.juren    [pkg_size] => 12354454222    [pkg_url] => http://www.ztgame.com/releasexxx    [platform] => IOS    [screenshots] =>     [upd_info] => 更新1.0正式版，更多新功能 ，修复bug，iphone6Plus适配    [version] => v1.0.0然后将值拼接起来，14145760781简介，测试数据巨人http://xxxxxxx123详细介绍，测试数据测试名称com.ztgame.juren12354454222http://www.ztgame.com/releasexxxIOS更新1.0正式版，更多新功能 ，修复bug，iphone6Plus适配v1.0.0加上KEY  RsiWoDzPFFon14145760781简介，测试数据巨人http://xxxxxxx123详细介绍，测试数据测试名称com.ztgame.juren12354454222http://www.ztgame.com/releasexxxIOS更新1.0正式版，更多新功能 ，修复bug，iphone6Plus适配v1.0.0RsiWoDzPFFon进行MD5，得到  6e616467a1273b30ac293464663664756e616467a1273b30ac29346466366475 就是加密结果。注意所有数据仅在传输时需要urlencode，加密时不涉及urlencode。所有数据请使用UTF8.一个完整请求示例：http://app.scloudm.com/app/push_app_info?app_updtime=1414576078&category=1&cover_img=&description=%E7%AE%80%E4%BB%8B%EF%BC%8C%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE&developer=%E5%B7%A8%E4%BA%BA&icon_img=http%3A%2F%2Fxxxxxxx&id=123&intro=%E8%AF%A6%E7%BB%86%E4%BB%8B%E7%BB%8D%EF%BC%8C%E6%B5%8B%E8%AF%95%E6%95%B0%E6%8D%AE&name=%E6%B5%8B%E8%AF%95%E5%90%8D%E7%A7%B0&pkg_name=com.ztgame.juren&pkg_size=12354454222&pkg_url=http%3A%2F%2Fwww.ztgame.com%2Freleasexxx&platform=IOS&screenshots=&upd_info=%E6%9B%B4%E6%96%B01.0%E6%AD%A3%E5%BC%8F%E7%89%88%EF%BC%8C%E6%9B%B4%E5%A4%9A%E6%96%B0%E5%8A%9F%E8%83%BD+%EF%BC%8C%E4%BF%AE%E5%A4%8Dbug%EF%BC%8Ciphone6Plus%E9%80%82%E9%85%8D&version=v1.0.0&sign=6e616467a1273b30ac29346466366475可以GET或者POST，成功会返回个ok。App下线接口http://app.scloudm.com/app/push_app_shutdown参数：id              你们这边的idts              时间戳，类似1417580590的UNIX时间戳sign    签名规则与前一个接口完全相同。签名正确则APP下线。\n平台介绍：http://www.scloudm.com/aboutus.php\n\n可上传文件：\nrsync wooyun.txt 222.73.30.163::fabu/\n\n\n   漏洞证明：  如上   修复方案：  添加访问权限   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-04-01 18:08 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-01 20:40 |    \t\tYuku \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:19        | 酱油哥)\t\t \n  无良厂商    \n     2015-04-01 21:00 |    \t\tHax0rs \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:4        | Hax0rs)\t\t \n  这个厂商不管怎么刷都不认领，估计偷偷修复了还是怎么的。    \n     2015-04-04 07:37 |    \t\t我爱，你老婆 \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:9        | 猥琐的猥琐！)\t\t \n  @巨人网络 傻逼厂商！    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}