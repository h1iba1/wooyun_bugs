{"id": 53747, "wybug_id": "wooyun-2014-066638", "wybug_title": "厦门大学旧系统泄漏大量学生信息", "wybug_corp": "厦门大学", "wybug_author": "JohnWong", "wybug_date": "2014-06-30 14:23", "wybug_open_date": "2014-08-14 14:24", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-14：\t细节向公众公开  简要描述： 厦门大学录取查询系统存在SQL注射漏洞，导致大量学生信息泄漏 详细说明：  python sqlmap.py -u \"http://121.192.179.132:81/ems/index.php?m=apply&c=apply&a=search\" --data=\"name=admin&id_card=admin&dosubmit=1\"数据库用的Mysql，账号密码拿到了但是限制localhost登录无法远程登录。大量数据在ems库，敏感信息包括admin和student两个表。密码加密方式采用的discuz的方式，md5(md5($pass).$salt)。管理员登录入口没找到，admin表暂时没什么用。学生信息包含了许多敏感信息，包括姓名、生日、邮箱、电话、住址、学号、身份证号等。厦大的学生账号默认是学号/身份证号码后六位，如果没有修改过密码，就能用这个登录没有限制内网访问的各种系统。   漏洞证明：  sqlmap拿到的数据库ems：\n\n拿到部分的学生数据：\n\n随便登录下http://121.192.179.132:81/ems/index.php?m=student&c=index\n\n可以查查成绩、考勤。没有王道啊不幸福啊！登录i.xmu.edu.cn之后可以做更多事情。比如查看一卡通记录、打饭记录：\n\n\n\n   修复方案：  参数化查询，默认密码首次登录必须修改。   版权声明：转载请注明来源 JohnWong@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2014-06-30 14:32 厂商回复： 通知用户处理中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}