{"id": 22998, "wybug_id": "wooyun-2011-01725", "wybug_title": "DiscuzX1.5 有权限SQL注入BUG", "wybug_corp": "Discuz!", "wybug_author": "Jannock", "wybug_date": "2011-03-27 00:53", "wybug_open_date": "2011-04-26 03:00", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-03-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-03-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-03-31：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2011-05-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-06-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-06-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-04-26：\t细节向公众公开  简要描述： DiscuzX1.5 有权限SQL注入BUG 详细说明：  source\\include\\portalcp\\portalcp_article.php//90行\tif($_G['gp_conver']) {  \t\t$converfiles = unserialize(stripcslashes($_G['gp_conver']));\t\t$setarr['pic'] = $converfiles['pic'];\t\t$setarr['thumb'] = $converfiles['thumb'];\t\t$setarr['remote'] = $converfiles['remote'];\t}可以看出变量 $converfiles 没有 addcslashes。\t\t$aid = DB::insert('portal_article_title', $setarr, 1);  //122行进入数据库查询，因此存在SQL注射BUG。   漏洞证明：  有 门户 › 门户管理 › 频道栏目 发表权限。发表文章：http://localhost:9998/portal.php?mod=portalcp&ac=article&catid=1在firebug下显示conver表单。\n\n填上：a:3:{s:3:\"pic\";s:3:\"xx'\";s:5:\"thumb\";s:2:\"xx\";s:6:\"remote\";s:2:\"xx\";}提交即暴错。Error messages:    * [Type] 查询语句错误    * [1064] You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'xx',`remote`='xx',`uid`='1',`username`='admin',`id`='0'' at line 1    * [Query] INSERT INTO portal_article_title SET `title`='xxxxxxxx',`shorttitle`='',`author`='',`from`='',`fromurl`='',`dateline`='1301158320',`url`='',`allowcomment`='1',`summary`='xxxxxxxxxxxxxxxx',`prename`='',`preurl`='',`catid`='1',`tag`='0',`status`='0',`pic`='xx'',`thumb`='xx',`remote`='xx',`uid`='1',`username`='admin',`id`='0'   修复方案：  您懂得。   版权声明：转载请注明来源 Jannock@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2011-03-28 11:13 厂商回复： 感谢您的提供 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-03-27 02:17 |    \t\tpg5yl8 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:12        | 我神马都不会 但我常常被人日 这是为神马呢)\t\t \n  给力    \n     2011-03-27 03:35 |    \t\tm0r5 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:6        )\t\t \n  有DEBUG...求突破方法    \n     2011-03-27 09:41 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  我擦勒 留名 楼上什么debug    \n     2011-03-27 10:52 |    \t\tJannock  \t\t\t( 核心白帽子 |\t\t\t        Rank:2278 漏洞数:204        | 关注技术与网络安全（招人中，有兴趣请私信...)\t\t \n  只是个鸡肋 ^-^     \n     2011-03-27 13:58 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  别想了，发出来的肯定是鸡肋，要明白国人的心理    \n     2011-03-27 23:12 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  说不定什么时候就可以用到 对于厂商还是有帮助的    \n     2011-03-28 01:12 |    \t\tsaga \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 世界上只有10种人，懂二进制的，和不懂二进...)\t\t \n  有用的都换钱了，还是xss有效    \n     2011-03-28 08:16 |    \t\t Jesus \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:18        | 天地不仁,以万物为刍狗！)\t\t \n  想不通楼主为啥公布出来，费解！    \n     2011-03-28 11:22 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  你都没看到细节 别喊了喂~~~    \n     2011-03-29 12:15 |    \t\tpiaoye \t\t\t( 普通白帽子  |\t\t\t        Rank:343 漏洞数:53        | ww)\t\t \n  DX有好几个debug，都是鸡肋    \n     2012-06-26 08:46 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  insert注入 有点意思呢    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}