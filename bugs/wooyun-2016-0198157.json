{"id": 85990, "wybug_id": "wooyun-2016-0198157", "wybug_title": "AppCan漏洞大礼包(AppCan弱口令\\XSS\\SQL注入\\敏感文件泄露\\弱口令\\文件上传漏洞合集)", "wybug_corp": "AppCan", "wybug_author": "fzxcp3", "wybug_date": "2016-04-19 14:47", "wybug_open_date": "2016-04-24 14:50", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "文件上传", "敏感文件泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： AppCan弱口令、XSS、SQL注入、敏感文件泄露、弱口令、文件上传漏洞合集 详细说明：  测试自己写的discuz扫描工具健壮性的时候发现了一个备份文件http://bbs.appcan.cn//config/config_ucenter.php.bak使用uc_key getshell失败,经测试已更改uckey.继续检测,发现了一个疑似注入点http://edu.appcan.cn/train_detail_new.html?id=498\n\n\n\n但是是时间盲注,跑数据太慢了,而且权限不高,接着寻找其他测试点http://edu.appcan.cn/train_outline1.html?train_place=%3Cscript%3Ealert%281%29%3C/script%3E在这个位置发现一个反射型xss\n\n可惜是反射基本上毫无意义.然后尝试在google中搜索site:appcan.cn inurl:login在返回结果中发现一个json数据，里面发现一个名字\"张文帅\"在burp的请求历史中发现一个自动跳转的地址:http://siteadm.appcan.cn/Daemon/appshow/listinterfaceById?status=1&typeid=82&rows=8&callback=jQuery19103505221238365238_1461031756517&_=1461031756518直接访问http://siteadm.appcan/Daemon 跳转到后台登录地址尝试各种弱密码皆失败.. 突然想起之前发现的”张文帅”, 打算尝试一下,使用zhangwenshuai,zhangws,zhangwens,zws等用户名, 最后使用用户名zws弱口令123456爆破成功!!\n\n在后台看看有没有能提权的位置,找到一个图片上传点尝试一下直接上传一句话,发现不能解析,上传图片一句话,还是解析失败,下载回来发现一句话被清除,应该是被二次渲染.找到未更改的地方再次添加一句话, 可惜还是失败..接着找, 还发现有app上传地址,抓包,修改文件名,最终上传shell成功!!   漏洞证明：  \n\n   修复方案：  1、xss过滤' \" < > （ ）等字符2、SQL注入使用预编译的方式3、弱口令，更改密码4、文件上传，把上传文件放到不可执行路径中，设置好权限   版权声明：转载请注明来源 fzxcp3@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-04-24 14:50 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-19 15:29 |    \t\ty1ngz1 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 一起交流，一起学习～ 等我申请好QQ再写上...)\t\t \n  看成了 appscan    \n     2016-04-19 16:07 |    \t\tj14n \t\t\t( 普通白帽子  |\t\t\t        Rank:1537 漏洞数:293        | print (‘\\n’.join([’ ‘.join([‘%s*%s=...)\t\t \n  @y1ngz1 +1    \n     2016-04-19 17:51 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1101 漏洞数:186        | px1624)\t\t \n  看成了 appscan...    \n     2016-04-19 17:57 |    \t\tLiuz5O69 \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:9        | 一个默默的学习者。)\t\t \n  还以为直接上传了某站的APPSCAN扫描结果。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}