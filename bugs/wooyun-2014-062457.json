{"id": 55005, "wybug_id": "wooyun-2014-062457", "wybug_title": "世纪风企业网站管理系统后台绕过", "wybug_corp": "世纪风企业网站管理系统", "wybug_author": "roker", "wybug_date": "2014-05-27 10:46", "wybug_open_date": "2014-07-11 10:47", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-27：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-07-11：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： rt 详细说明：  版本 世纪风企业网站管理系统 3.6注入方面都过滤了 。 后台验证却很奇葩= =_admin/cms_login.asp\nIf reqf(\"submit\") = \"管理登陆\" Then    Call nullback(reqf(\"login_name\"), \"用户名不能为空！\")    Call nullback(reqf(\"login_password\"), \"密码不能为空！\")    Call nullback(reqf(\"login_verifycode\"), \"验证码不能为空！\")    If CStr(Session(\"CheckCode\")) <> CStr(Request.Form(\"login_verifycode\")) Then        Call infohref(\"验证码错误！\",\"cms_login.asp\")    End If    Set rs = ado_query(\"select * from cms_admin where a_enable = 1 and a_name='\"&str_safe(request.Form(\"login_name\"))&\"' and a_password='\"&md5(str_safe(request.Form(\"login_password\")))&\"'\")    If Not rs.EOF Then\t    Response.Cookies(\"admin_check\") = request.Form(\"login_name\")        rs.close\t\tset rs = nothing        response.redirect \"cms_welcome.asp\"    Else        rs.close\t\tset rs = nothing        Call infohref(\"错误提示：用户名或密码错误，请核对后重新输入！\",\"cms_login.asp\")    End IfEnd If%>\n密码正确就赋予 admin_check username的值。inc_function.asp\n'==========获取当前账户相关信息==========If inull(Request.Cookies(\"admin_check\")) Then    Response.Redirect(\"index.asp\")End IfSet rs_gap = ado_query(\"select * from cms_admin where a_name = '\"&Request.Cookies(\"admin_check\")&\"'\")If rs_gap.EOF Then    Response.Redirect(\"index.asp\")End Ifadmin_name = rs_gap(\"a_name\")admin_truename = rs_gap(\"a_truename\")admin_penname = rs_gap(\"a_penname\")admin_purview = rs_gap(\"a_purview\")rs_gap.CloseSet rs_gap = Nothing\n这个 cookie是能伪造的。赋予admin 或者 cookie注入。这个值是没有经过str_safe过滤的百度个站来试试。。\n\n   漏洞证明：  \n\n   修复方案：  you konw   版权声明：转载请注明来源 roker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}