{"id": 63012, "wybug_id": "wooyun-2013-033401", "wybug_title": "记一次S2利用过程（跳过域名检测重定向）", "wybug_corp": "北京同方影视传媒科技有限公司", "wybug_author": "一只猿", "wybug_date": "2013-08-05 12:20", "wybug_open_date": "2013-09-19 12:20", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["补丁不及时", "文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-05：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-09-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 北京同方影视传媒科技有限公司某项目s2漏洞，域名检测重定向404被利用，成功跳过重定向导致getshell，裤子光秃秃，各种管理员。PS：本人菜鸟，大牛勿喷 详细说明：  见证明贴图：hngddyc.comzjdypt.com两个都有struts漏洞   漏洞证明：  地址：http://124.117.229.118/monitor/index.action扫描到S2漏洞，传马，结果404，被重定向了。\n\nls看目录，本菜鸟非工具党，有时候还是会用工具，尽量手工。\n\n发现photo目录，传马，此目录下没有任何检测，getshell\n\n查看数据库配置\n\n心情很激动，尝试连接数据库，结果失败\n\n一激动就容易犯混，没驱动肯定连不了，如果把驱动复制到此目录还需要重启tomcat才生效，于是乎。复制到项目所在目录，用火狐访问\n\n必然404被重定向了，仔细观察地址，发现timeout.jsp来跳转的，看下有没有这个文件，结果在根目录下并没有发现这个文件，先不管，我的想法是直接将404替换成我的马\n\n\n\n一阵窃喜，登录，发现始终登录不上，仔细观察地址，我的马在404里面，当前地址为timeout.jsp，可能是session问题,因为有重定向，那我就在根目录下造一个timeout.jsp，内容为404一样的\n\n登录成功\n\n连接数据库，现在应该是可以正常连接的\n\n数据库里面的表非常之多，我的IE已经卡的动不了，看下用户表有什么\n\n当然，裤子都光秃秃了，看下用户表\n\n管理员什么的，就不多说了。至此，成功利用404重定向拿下数据库。当然，如果使用工具用命令就另当别论了。额，裤子没动，就看了几眼。   修复方案：     版权声明：转载请注明来源 一只猿@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}