{"id": 14742, "wybug_id": "wooyun-2012-016353", "wybug_title": "7天连锁酒店可泄露用户隐私信息", "wybug_corp": "7天连锁酒店", "wybug_author": "se55i0n", "wybug_date": "2012-12-22 11:46", "wybug_open_date": "2013-02-05 11:47", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-02-05：\t细节向公众公开  简要描述： 约炮喜欢选7天的筒子们注意了，当心被女朋友（老婆）发现哟~好邪恶！ 详细说明：      其实本问题在于7天连锁酒店的用户密码找回功能存在缺陷，重置用户密码后登陆可查看用户一些隐私信息，如在7天开房的信息等...1)酒店会员都是实名制，注册信息包括用户真实姓名、身份证号码、手机号码等；7天会员可用手机号码登陆预定房间、或是找回密码；\n\n2）使用手机找回密码，系统会发送一个6位数字的安全码到对应的手机上,我们随便填写一个6位数字的安全码提交并进行抓包；\n\n3）设置\"r_phone_code\"为爆破参数进行暴力破解，当然测试只为进行漏洞利用演示，爆破参数区间设置成一个包含真实验证码的较小的6位数字区间；\n\n4）爆破测试开始，分析测试结果我们发现：无论提交的是否是真实安全码，提交的状态和系统返回的字节长度均一致，但是我们可根据response内容确定真实的验证码；安全码错误时response内容：\n\n安全码正确时response内容：\n\n5）使用真实安全码替代\"r_phone_code\"参数值并提交即可来到密码重置页面；\n\n6）填入我们需要重置的密码并提交，漏洞利用过程完成；\n\n   漏洞证明：  见详细说明   修复方案：  1)限制校验错误次数；2)增加安全码的强度；3)合理设置安全码的有效期；   版权声明：转载请注明来源 se55i0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2012-12-22 12:35 厂商回复： 确认 我们会尽快修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-23 22:47 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @7天连锁酒店 7天的同学能送个金卡会员么？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}