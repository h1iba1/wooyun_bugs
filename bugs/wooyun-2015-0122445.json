{"id": 28464, "wybug_id": "wooyun-2015-0122445", "wybug_title": "步步高程序缺陷导致服务器沦陷", "wybug_corp": "步步高商业连锁", "wybug_author": "NST", "wybug_date": "2015-06-24 16:57", "wybug_open_date": "2015-08-08 16:58", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-24：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-08-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 乌云第一发,先来个邀请码呗另外想吐糟下步步高集团，网络安全这么不重视，网管员有没有，这么任性真的好吗？BBG vip 一卡通，超市购物你懂的 详细说明：  1.步步高集团网站采用的是becoolcms系统，这套系统后台登陆页面由api调用数据进行验证，通过抓包可以获取用户名和密码等在内的敏感信息。2.后台上传过滤不严，虽然不能上直接上传脚本语言，但是可以上传txt等文件，可以通过上传文件然后重命名从而获取webshell3.服务器控制不严，可以遍历及读取服务器各磁盘信息4.跨站，步步高子站点：life.bbg.com.cn等5.内网渗透，通过shell发现是内网，scan发现旗下其他几个平台在一个网段，初步判断可以内容渗透（这里未深入内网）   漏洞证明：  1.系统信息泄露后台登陆地址：http://www.bbg.com.cn/becool/becoolapp.html通过查看源代码发现调用http://www.bbg.com.cn/becool/becoolApp.swf对其进行抓包，发现数据POST到http://www.bbg.com.cn/BeCool/api.aspx取得敏感数据：\n\n登陆后台：\n\n敏感信息\n\n\n\n\n\n后台上传与新建控制不严导致可以重命名getshell:\n\n\n\n能遍历各磁盘目录，可执行CMD命令：\n\n\n\n没有继续深入了，从上面的信息可以看到服务器安全不严，提权继而内容渗透XXOO   修复方案：  你懂的……   版权声明：转载请注明来源 NST@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}