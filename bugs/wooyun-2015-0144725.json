{"id": 66991, "wybug_id": "wooyun-2015-0144725", "wybug_title": "足记APP任意手机用户密码重置&amp;用户token设计缺陷", "wybug_corp": "足记APP", "wybug_author": "DBA", "wybug_date": "2015-10-04 23:28", "wybug_open_date": "2015-11-19 13:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-19：\t细节向公众公开  简要描述： 国庆出不去，挖挖洞。 详细说明：  1、手机注册验证码过短（0000~9999）&修改密码请求次数无限制造成可暴力猜解验证码来重置手机用户密码。\n\n重置手机号为13888888888的用户密码，得到验证码是5654，重置的密码为wooyun，可用此手机号和密码登录验证，如下\n\n\n\n\n\n2、用户token不仅仅是持久的，而是永久的，没有失效时间，而且一旦获取，永久绑定，应该是入库保存了。就算通过APP退出登录，token仍然有效，而且再次登录后仍然是一样的token。这显然是一个设计的大bug。如下是我已经退出登录后再次发包，仍能做到登录之后的事情。这个如果靠贴图比较麻烦，见谅，厂商的开发同学应该最清楚。\n\n所以之前泄露的足记联合创始人的token也可以一直使用。   漏洞证明：  1、用手机号和密码13888888888/wooyun登录足记APP验证2、token这件事情开发最清楚了。3、结合上面两个方案，我们可以有一个思路。遍历一些关键用户的token,由于token持久有效，相当于我们可以控制不少足记大V用户。   修复方案：     版权声明：转载请注明来源 DBA@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-10-05 13:12 厂商回复： 这个问题我们正在紧急讨论修改方案 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-05 06:43 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:230 漏洞数:82        | The quiter you are,the more you're able ...)\t\t \n  是不是token可被解密，然后知道token可以操作任意用户，洞主有没有试试任意用户登陆呢？    \n     2015-11-19 13:38 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1038 漏洞数:176        | px1624)\t\t \n  @Me_Fortune 感觉token是一个固定的没有加入hash的算法    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}