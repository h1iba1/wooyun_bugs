{"id": 6267, "wybug_id": "wooyun-2013-046451", "wybug_title": "21CN官方社区存在高危敏感信息泄露风险", "wybug_corp": "世纪龙信息网络有限责任公司", "wybug_author": "光头强", "wybug_date": "2013-12-19 14:28", "wybug_open_date": "2014-02-02 14:28", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "错误信息未屏蔽"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-02：\t细节向公众公开  简要描述： 由于没有一个通用标准的防御规则保护好中间件配置信息、DNS信息、业务数据信息、用户信息、源码备份文件、版本管理工具信息、系统错误信息和敏感地址信息(后台或测试地址)的泄露，攻击者可能会通过收集这些保护不足的数据，利用这些信息对系统实施进一步的攻击。 详细说明：  #1 信息泄露原因由于论坛管理员在更新服务器文件时，未注意到编辑器会默认创建各种.bak文件用来规避错误编辑时引发的数据丢失风险，从而造成了更严重的信息安全问题。#2 泄露地址网站: http://bbs.21cn.com 存在信息泄露:文件1：http://bbs.21cn.com/config/config_global.php_bak文件2：http://bbs.21cn.com/config/config_ucenter.php_bak #3 泄露内容\n<?phpdefine('UC_CONNECT', 'mysql');define('UC_DBHOST', '121.14.133.243');define('UC_DBUSER', 'freeuser');define('UC_DBPW', '21cnFree1020');define('UC_DBNAME', 'forum');define('UC_DBCHARSET', 'utf8');define('UC_DBTABLEPRE', '`forum`.ucenter_');define('UC_DBCONNECT', 0);define('UC_CHARSET', 'utf-8');define('UC_KEY', 'ieKf28G7A88c60n4jbH0le3aQf31b1Icg4Ma5dWc9dy6D5G6E0r2S3Sa69B7Ha80');define('UC_API', 'http://bbs.21cn.com/uc_server');define('UC_APPID', '1');define('UC_IP', '59.36.102.165');define('UC_PPP', 20);\n   漏洞证明：  #4 漏洞证明 (有UC_KEY，Discuz等于可以做任何事)详细利用方法参见： WooYun: 途牛网某服务配置失误 导致论坛敏感文件泄露(致使百万用户信息告急) #5 利用细节由于Discuz UC_SERVER 的updateapps接口未严格校验客户端提交的数据，导致可写入任意代码至/config/config_ucenter.php。\n$code=urlencode(_authcode(\"time=$timestamp&action=updateapps\", 'ENCODE', $uc_key));\n鉴于!Discuz在乌云已经属于无良厂商，这里不纰漏详细代码参照： WooYun: 又一次失败的漫游腾讯内部网络过程 #2 #6 获取到SHELL\n\n   修复方案：  #1 网络边界需要认真对待。#2 杜绝为了方便而造成的不必要的信息泄露。#3 安全是一个整体，保证安全不在于强大的地方有多强大，而在于真正薄弱的地方在哪里。   版权声明：转载请注明来源 光头强@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-12-20 15:09 厂商回复： 处理中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-19 15:05 |    \t\t风风 \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:43        | 。)\t\t \n  猪哥的马甲？    \n     2013-12-20 04:08 |    \t\tMoogong \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:8        | 伪法医)\t\t \n  21CN zao  昨天我访问一个页面就被挂了马 直接弹一黄色网站给我    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}