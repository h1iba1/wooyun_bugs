{"id": 20807, "wybug_id": "wooyun-2012-05874", "wybug_title": "腾讯业务交叉逻辑考虑不周导致QQ空间CSRF漏洞", "wybug_corp": "腾讯", "wybug_author": "笨猪", "wybug_date": "2012-04-08 22:16", "wybug_open_date": "2012-04-09 14:25", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-04-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 隔壁住来了个QQ邮箱的贺先生，发洞一枚以示友好，求公仔~由于腾讯在业务逻辑上存在许多交叉，导致CSRF。 详细说明：  QQ空间支持从邮箱中以邮件的方式发送文章到QQ空间，由于在邮箱中和QQ空间中的业务不同，因此对某些细节的处理不同，而这种交叉，导致在QQ空间中苦苦做的限制白做了。打开QQ的记事本，写一个新的记事，插入一张图片\n\n插入后保存，点右上角的发送到Qzone。\n\n这一文章便已被发送到了QQ空间。   漏洞证明：  在他人打开浏览的时候，就会在不知情的情况下，自动访问www.nigesb.com，造成CSRF，QQ空间中，是不允许插入这样的图片链接的。wireshark抓包，证明，确实访问了我的博客。而且QQ空间新发文章，是会出现在好友的动态的timeline中的哟。\n\n   修复方案：  这种由于业务交叉导致的问题，我相信不止这一处，由于业务不同，可能需要限制的地方也有不同，一旦两个业务数据打通，而没有进行二次过滤检查的话，很容易出现类似的问题，本问题仅为抛砖引玉，也为求公仔嘿嘿。   版权声明：转载请注明来源 笨猪@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-04-09 14:25 厂商回复： 非常感谢您的反馈，但我们认为这不是一个CSRF漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-04-08 22:27 |    \t\tJ4nker \t\t\t( 普通白帽子  |\t\t\t        Rank:136 漏洞数:35        | I have a dream)\t\t \n  蛋蛋的。不会是我跟我的那个一样吧。    \n     2012-04-08 23:56 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  我一直有个想法，像csrf和xss是很难对普通用户解释清楚的，是否有可能做个很鲜明的录像视频什么的来解释呢    \n     2012-04-09 10:31 |    \t\t笨猪 \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:13        | Jarett|最近忙，洞发得少。。)\t\t \n  @xsser 我觉得吧，普通用户也不会接触到这一层面呀，网页开发人员还可能。    \n     2012-04-09 15:07 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  哥们这个不是csrf吧。 我插入xxxx.asp# 他一样会访问的阿  以前t00ls核攻击大牛写了一个关于百度的csrf那个文章很经典 。。 Lz有空去核攻击blog看看吧 mark    \n     2012-04-09 16:57 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  貌似扣扣空间本来就支持这个发外部链接吧？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}