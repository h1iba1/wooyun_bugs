{"id": 38917, "wybug_id": "wooyun-2015-0140732", "wybug_title": "中关村在线某后台SQL注入", "wybug_corp": "中关村在线", "wybug_author": "bey0nd", "wybug_date": "2015-09-13 09:22", "wybug_open_date": "2015-09-14 16:29", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-14：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 某商场后台 详细说明：  http://maijia.zol.com/中关村商家后台。包括大量商家用户等信息。该站产品库应该是会同步到主站的。在搜索处存在sql注入\n\n\nhttp://maijia.zol.com/index.php?c=GoodsManagerAddGoods&productStatus=0&subId=851&manuId=40685&keyWords=sql\n参数keyWords存在sql注入利用注入语句可查看全站的商品信息。\n\n\n\n一共一百多万的信息\n\n利用sqlmap构造了一下语句，但是还是没能跑出更多信息。sqlmap对搜索型注入好像不是很友好。\n\n然后利用burp的小技巧来跑下数据吧-----------用了两个字典，一个是数据长度，另外一个就是char的字符，然后匹配出结果，看图\n\n那就可以看出来user()是 \nmall@10.19.34.9\n同样的看下数据库吧\n\ndatabase()\nzoldb\n看这个数据库名不会是主站吧？手里注入工具不太好使，更详细的数据就不贴出来了。\nuser()：mall@10.19.34.9\n\ndatabase()：zoldb\n   漏洞证明：  \nuser()：mall@10.19.34.9\n\ndatabase()：zoldb\n   修复方案：  过滤   版权声明：转载请注明来源 bey0nd@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-09-14 16:26 厂商回复： 有疏漏，已用手处理，谢谢围观。 最新状态： 2015-09-14：已修复，多谢关注  ", "replys": "漏洞评价：\n评论\n     2015-09-14 17:32 |    \t\t三浪兄 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:6        | I am a singer-songwriter.)\t\t \n  小技巧用得真是666666    \n     2015-09-14 17:45 |    \t\tbey0nd \t\t\t( 普通白帽子  |\t\t\t        Rank:895 漏洞数:124        | 相忘于江湖，不如相濡以沫)\t\t \n  @三浪兄 666666    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}