{"id": 21963, "wybug_id": "wooyun-2011-03307", "wybug_title": "柏顿文章管理系统无限制上传漏洞", "wybug_corp": "柏顿文章管理系统", "wybug_author": "狗样的男人", "wybug_date": "2011-11-14 09:21", "wybug_open_date": "2011-11-14 14:10", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传漏洞", "安全限制绕过", "文件上传安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-11-14：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2011-11-14：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 柏顿文章管理系统默认后台中的upload.asp文件只对asp|aspx|php|jsp|asa|shtml|html|htm|js|vbs做了限制 详细说明：  \n<!--#include file=\"../inc/upload.asp\"--><html><head><meta http-equiv=\"content-type\" content=\"text/html;charset=gb2312\"><title>上传文件</title><style>*{margin:0px;padding:0px;}body{font-size:12px;}.border{font-size:12px;border:#000 solid 1px;}</style><link rel=\"stylesheet\" rev=\"stylesheet\" href=\"images/css.css\" type=\"text/css\" media=\"all\" /></head><body leftmargin=0 topmargin=0><%Dim go:go=Request.QueryString(\"go\")If Request.QueryString(\"action\")=\"upload\" Then Set upload=new my_uploadDim filepath\tfilepath=trim(upload.form(\"filepath\"))For each formName in upload.Fileset file=upload.File(formName)Dim o,txt,FileExt:FileExt=file.FileExttxt=Split(\"asp|aspx|php|jsp|asa|shtml|html|htm|js|vbs\",\"|\")For o=0 To UBound(txt)If InStr(LCase(FileExt),txt(o))<>0 Then \tresponse.write \"<script>alert('您上传的格式错误！');location.href='up.asp';</script>\"\tresponse.endEnd ifNext\n我们可以上传cer ,ashx等文件   漏洞证明：  \n\n\n\n\n\n   修复方案：  修改源码只允许上传图片或者把漏洞文件添加   版权声明：转载请注明来源 狗样的男人@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：7 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2011-11-14 17:39 |    \t\t歌颂 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:5        | #1024)\t\t \n  围观阿狗    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 7, "Ranks": null}