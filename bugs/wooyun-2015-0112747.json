{"id": 31912, "wybug_id": "wooyun-2015-0112747", "wybug_title": "用友FE协作办公系统4处DBA权限注入", "wybug_corp": "国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-05-08 17:38", "wybug_open_date": "2015-08-10 15:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-07-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-10：\t细节向公众公开  简要描述：  详细说明：  应该是没有存在的值导致了时间盲注；如果pk_corp的值存在是不是就可以其它形式注入呢？厂商应该是这个把？\nhttp://www.flyrise.cn/  珠海飞企软件有限公司\nSQL Injection:\n/fenc/syncsubject.jsp?pk_corp=1    pk_corp存在AND/OR time-based blind注入\nCase From Google:\nhttp://oa.shunhengli.com:9090/fenc/syncsubject.jsp?pk_corp=1http://oa.chnjcdc.com:9090/fenc/syncsubject.jsp?pk_corp=1http://218.90.146.246:9090/fenc/syncsubject.jsp?pk_corp=1http://119.97.198.27:8080/fenc/syncsubject.jsp?pk_corp=1http://124.129.26.94:7742/fenc/syncsubject.jsp?pk_corp=1\nSQL注入点：\n/indexsearch/filter.jsp?tableId=1  tableId存在注入\n案例：有一些案例可使用报错形式注入\nhttp://oa.shunhengli.com:9090/indexsearch/filter.jsp?tableId=1http://119.97.198.27:8080/indexsearch/filter.jsp?tableId=1http://zszhongyou.gicp.net:9090//indexsearch/filter.jsp?tableId=1http://218.90.146.246:9090/indexsearch/filter.jsp?tableId=1http://124.129.26.94:7742/indexsearch/filter.jsp?tableId=1\nSQL注入点：\n/flex/newsmessage.jsp?uname=1\n乌云要求要5个案例吧：\nhttp://fe.hy-la.com:8088/flex/newsmessage.jsp?uname=1http://oa.chnjcdc.com:9090/flex/newsmessage.jsp?uname=1http://oa.suncorps.cn/flex/newsmessage.jsp?uname=1http://www.kwh.org.mo:4040/flex/newsmessage.jsp?uname=1http://183.57.22.222:9090/flex/newsmessage.jsp?uname=1\nSQL注入点：\n/feReport/chartList.jsp?delId=1&reportId=1   reportId参数存在注入\n案例：\nhttp://oa.chnjcdc.com:9090/feReport/chartList.jsp?delId=1&reportId=1http://fe.hy-la.com:8088/feReport/chartList.jsp?delId=1&reportId=1http://oa.suncorps.cn/feReport/chartList.jsp?delId=1&reportId=1http://124.129.26.94:7742/feReport/chartList.jsp?delId=1&reportId=1http://oa.shunhengli.com:9090/feReport/chartList.jsp?delId=1&reportId=1\n   漏洞证明：  时间盲注；我就不花时间读全部库名了~读当前用户或者库的名称\n1、\n\n\n\n\n\n\n\n\n\n2、dba权限\n\n\n\n\n\n\n\n\n\n1、\n\n2、\n\n\n\n\n\n\n\n\n\n\n\n\n拿两个来试试，时间盲注不读全库名：\n1、\n\n\n\n\n\n2、当数据库为mssql的时候可shell\n\n\n\n\n\n\n\n\n\n\n\n\n我就拿2个来测试了;有部分支持报错注入，其它支持时间、联合查询注入\n1、\n\n\n\n\n\n\n\n\n\n2、\n\n\n\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-05-12 15:24 厂商回复： CNVD确认所述情况，已经由CNVD通过网站公开联系方式向软件生产厂商通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}