{"id": 65007, "wybug_id": "wooyun-2013-020220", "wybug_title": "爱丽网设计缺陷可劫持某登陆电脑上所有的登陆帐号", "wybug_corp": "aili.com", "wybug_author": "小胖胖要减肥", "wybug_date": "2013-03-17 21:52", "wybug_open_date": "2013-05-01 21:52", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄漏", "认证缺陷", "认证设计不合理", "认证系统设计不合理", "劫持"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-01：\t细节向公众公开  简要描述： 比较好玩的一个漏洞，应该没发过吧，估计又是一大片厂商呢 详细说明：  这个也是当初php框架问题了估计，PHPSESSID没有了解透彻啊，这个只是用来通过服务器的session换取令牌的东西，至少要跟着session一起变把，每个帐号不同时刻登陆的session肯定是不同的。反正我不是做开发也说不清楚，就说说利用方式把。我们可以通过很多方式获得这个PHPSESSID，比如借用别人的电脑，xss等多种方式看图把，未登陆是有这个值的\n\n问题就在于对于一台电脑这个值是永远不会变的，而只要当前电脑保持一个登陆状态已换取令牌，另外一台电脑就可以通过这个PHPSESSID直接登陆了2台电脑也试过，现在截图都是本机的，不同浏览器一样的效果   漏洞证明：  登陆之前暴力注册的帐号wrhwrh2在chrome上登陆\n\n这个时候通过上面所说的2种方式获取PHPSESSID，然后打开firefox，编辑cookies覆盖PHPSESSID\n\n为了证明\n\n我确实是登陆的，用chrome修改资料，firefox刷新查看好了 然后chrome换个帐号看看wrhwrh3，刷新firefox看看能不能再登陆\n\n应该证明了把   修复方案：  这个洞有意思在于劫持任意该电脑帐号，比较有意思修复的话就是每次PHPSESSID变化，不同帐号或者同一帐号不同时刻登陆最好都变化，php基本不懂，可能说的不太对，但现在这样肯定有问题的   版权声明：转载请注明来源 小胖胖要减肥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-03-18 16:57 厂商回复： 扬起小鞭子，抽打小猿猴喽！ 加班加班加班！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-17 18:34 |    \t\t小仙仙 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:8        | 吊丝做完全)\t\t \n  session没更新？    \n     2013-04-18 14:28 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @小仙仙 是    \n     2013-05-07 16:04 |    \t\t邪少 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:7        )\t\t \n  产商好有意思    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}