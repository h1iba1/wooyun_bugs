{"id": 5414, "wybug_id": "wooyun-2013-046320", "wybug_title": "易想团购开源版#sql注入02", "wybug_corp": "easethink", "wybug_author": "m1x7e1", "wybug_date": "2013-12-18 11:53", "wybug_open_date": "2014-03-18 11:53", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-03-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 易想团购#sql注入 详细说明：  http://127.0.0.1/easethink/link.php?act=go&city=fujian&url=\nif($_REQUEST['act']=='go'){\t$url = ($_REQUEST['url']);\t$link_item = $GLOBALS['db']->getRowCached(\"select * from \".DB_PREFIX.\"link where (url = '\".$url.\"' or url = 'http://\".$url.\"') and is_effect = 1\");\tif($link_item)\t{\t\tif(check_ipop_limit(get_client_ip(),\"Link\",10,$link_item['id']))\t\t$GLOBALS['db']->query(\"update \".DB_PREFIX.\"link set count = count + 1 where id = \".$link_item['id']);\t\t$url = \"http://\".$url;\t}\telse\t{\t\t$url = APP_ROOT.\"/\";\t}\tapp_redirect($url);}\nurl参数未做过滤直接带入数据库 导致sql注入\n\n   漏洞证明：  \n\n   修复方案：  过滤   版权声明：转载请注明来源 m1x7e1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}