{"id": 85939, "wybug_id": "wooyun-2016-0170433", "wybug_title": "完全Bypass安全狗最新版(V3.5.12048)SQL注入防护规则(可UNION)", "wybug_corp": "安全狗", "wybug_author": "从容", "wybug_date": "2016-01-17 12:32", "wybug_open_date": "2016-04-11 16:08", "wybug_type": "非授权访问/认证绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["语法特性"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-21：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-03-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-03-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-04-11：\t细节向公众公开  简要描述： dog虐我千百回，我待dog如初恋。Bypass安全狗最新版(V3.5.12048)SQL注入防护规则，测试不易，且行且珍惜。 详细说明：  安全狗修复速度真是凶狠啊，上一发Hackbraid表哥提交了个(V3.5.12047)，我也跟风。\n\n\n\nBypass原理就是绕过union检测，FUZZ半天也无果，翻了翻mysql语法。\nhttp://**.**.**.**/doc/refman/5.7/en/union.html\n提到了UNION ALL：\nUNION在进行表链接后会筛选掉重复的记录，所以在表链接后会对所产生的结果集进行排序运算，删除重复的记录再返回结果。而UNION ALL只是简单的将两个结果合并后就返回。这样，如果返回的两个结果集中有重复的数据，那么返回的结果集就会包含重复的数据了。\n尝试了下/*!UNION ALL*//*!SELECT*/会拦截，恩......\n\n是SELECT的问题？只有/*!UNION ALL*/的话不会拦截.....没SELECT那要UNION干啥，再测试下代替UNION ALL中间的空格/*!UNION/**/ALL*//*!SELECT*/可以成功绕过~   漏洞证明：  测试环境：\nWindows Server2008 + php + Apache + mysql\n开启主动防御\n\n\n\n/*!UNION/**/ALL*/绕过：\n\n这时就要问了，想FROM获取更多数据怎么办？\nhttp://**.**.**.**/bugs/wooyun-2015-0163236\n修复了，但是后面使用UNION ALL拼接还是可以FROM~\n1 -- ')/*!UNION/**/ALL*//*!SELECT*//*!USER*/(),/*!user*//*!FROM*/users#\n\n\n   修复方案：  过滤，UNION ALL适用的场景和UNION相同，再找找其他能够应用的场合。   版权声明：转载请注明来源 从容@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-01-18 09:06 厂商回复： 安全狗也爱你，么么哒... 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-17 12:45 |    \t\t田老板 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:8        | 学校杀手)\t\t \n  唉    \n     2016-01-17 12:56 |    \t\tyichin \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:4        | 233=_=)\t\t \n  日站越来越难了    \n     2016-01-17 12:56 |    \t\t90Snake \t\t\t( 普通白帽子  |\t\t\t        Rank:152 漏洞数:53        | 人如果没有梦想，跟咸鱼有什么分别)\t\t \n  专业Bypass    \n     2016-01-17 13:01 |    \t\tXser \t\t\t( 普通白帽子  |\t\t\t        Rank:379 漏洞数:85        | JDSec)\t\t \n  厉害    \n     2016-01-17 13:20 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1854 漏洞数:296        | 风暴网络安全空间：http://www.heysec.or...)\t\t \n  默默给表弟点个赞    \n     2016-01-17 13:37 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:248 漏洞数:82        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  难怪绕到头晕眼花    \n     2016-01-17 17:41 |    \t\t高小厨  \t\t\t( 普通白帽子  |\t\t\t        Rank:955 漏洞数:88        | 不会吹牛的小二不是好厨子！)\t\t \n  刁刁的，牛    \n     2016-01-17 22:37 |    \t\t晓贤 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 用心做好每件有意义的事)\t\t \n  还让不让dog好好过年    \n     2016-01-22 07:45 |    \t\t小哲哥 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:17        | http://www.fkgeek.com)\t\t \n  火钳刘明    \n     2016-01-22 16:46 |    \t\t枫子 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | 酱油安全爱好者一枚。)\t\t \n  日站越来越难了    \n     2016-01-23 17:52 |    \t\t冷白开。 \t\t\t( 普通白帽子  |\t\t\t        Rank:228 漏洞数:91        | “想人想的厉害的时候，也是淡淡的。    ...)\t\t \n  日站越来越难了    \n     2016-01-24 11:32 |    \t\t包包 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:33        | 我是菜鸟，我怕谁？小弟新来，望大牛多多包...)\t\t \n  本是同根生，相煎何太急。    \n     2016-04-17 10:19 |    \t\tRicky.D. \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | WITH us developing.)\t\t \n  日站越来越难了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}