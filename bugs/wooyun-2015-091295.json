{"id": 40573, "wybug_id": "wooyun-2015-091295", "wybug_title": "某政务系统SQL注入", "wybug_corp": "某政务系统", "wybug_author": "路人甲", "wybug_date": "2015-01-14 11:35", "wybug_open_date": "2015-04-14 11:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-22：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-14：\t细节向公众公开  简要描述： 某政务系统SQL注入 详细说明：  通用性的案例请详见：1. http://wooyun.org/bugs/wooyun-2015-0912892. http://wooyun.org/bugs/wooyun-2015-0912903. http://wooyun.org/bugs/wooyun-2015-0912914. http://wooyun.org/bugs/wooyun-2015-0912925. http://wooyun.org/bugs/wooyun-2015-091293官网gov客户列表：http://www.asp168.com/default.php?mod=article&fid=47 教育医疗公检法等客户用例可以点相应的栏目查看。以下列举部分客户，客户列表可以直接在上述url中查看，包括政府门户、公检法、教育、医疗、企业、媒体等栏目客户。gov：POST http://www.tzpolice.gov.cn/getjwj.php?op=1DATA id=1[sqli]POST http://www.tzpolice.gov.cn/getjwj.php?op=1DATA id=1[sqli]www.yixing.gov.cn/getjwj.php?op=1&id=11. http://www.bzgt.gov.cn  2. http://www.chongchuan.gov.cn  3. http://www.yixing.gov.cn4.http://www.huishan.gov.cn  5.http://www.ntgz.gov.cn/   6.http://www.anji.gov.cnedu：1.http://www.shsmu.edu.cn   2.http://www.lixin.edu.cn  3.http://www.sdju.edu.cn4. http://eng.shift.edu.cn   5.http://www.njedu.gov.cn公检法：1.http://www.hnsqga.gov.cn   2.http://www.whga.cn   3.http://www.pingpinganan.gov.cn   4.http://www.ahga.gov.cn  5.http://www.ntga.gov.cn等等\n漏洞文件：getjwj.php<?//同步边框和标题，解决上海网通连不上河南网通数据库问题require_once('common.php');if ($op == '1'){        $sch = array();        $query = $db->query(\"select * from oho_borderlist where id>\".$id.\"\");//变量id没有单引号干扰，需要跟踪下从哪里传递进来        while($rt =$db->fetch_array($query))        {                $sch[] = $rt;        }        echo serialize($sch);}…?>\n发现是include了common.php这个文件，common.php中包含了一个伪全局变量定义函数：\n\n_chk_char方法是一个全局变量过滤函数，会过滤一些特殊字符，不过暂时不需要绕过，因为POST过来的参数只过滤了key未过滤value。所以漏洞文件：getjwj.php中的id可以通过POST方法传递，即造成了SQL注入漏洞。   漏洞证明：  利用方法：POST http://www.pingpinganan.gov.cn/getjwj.php?op=1data: id=1000000[sqli]\n\n   修复方案：  .   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-01-19 08:30 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给江苏分中心，由其后续协调网站管理单位处置。此外，根据与厂商（江苏连邦公司）的协调情况，对方电话称不需要，后续向其官方邮箱通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}