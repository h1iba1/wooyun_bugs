{"id": 15082, "wybug_id": "wooyun-2012-015581", "wybug_title": "喜闻乐见的1分钱车票+顺手发现的银联和邮储银行支付漏洞", "wybug_corp": "南通汽运集团", "wybug_author": "superwbd", "wybug_date": "2012-12-04 09:39", "wybug_open_date": "2013-01-18 09:40", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-12-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-18：\t细节向公众公开  简要描述： 喜闻乐见的1分钱车票 一看题目大家就明白是怎么回事了吧。。。自己都觉得说话多余。。。顺便求码。。。 详细说明：  南通汽运集团。我都没听过这名。注册选车次不表。注册时喜闻乐见的没有验证码。习惯了就好了。\n\n猜到怎么办了吧？这么伟大的事业，哪能烦劳burp，还是Developer Tool解决吧。。。\n\n这里改起来有点讲究，不要过头，否则银行应该是过不去的。但是。。。现在说一下银行的好事~~我们把这个金额改过头好了。\n\n现在票价是0元哈 亲~~\n\n支付去\n\n这是啥？！\n\n这又是啥？！如果金额为负数——会被银联在线拦下来。看好，银联哈！不是网站自己哈！没卡，测试无法进行，结束。订票有这么2句话：1）\t只能购买当前时间2.5小时之后的车票，请考虑留足充足的行程时间，以免造成损失。2）\t请在订票成功10分钟内完成付款，逾期请勿付款，付款无效。估计不会有人工审核了。特别是春运啊，什么的。   漏洞证明：  上面写得够多了。。。没有卡，不继续玩了。。。人在国外不方便啊。。。   修复方案：  我不是黑客。真的不是什么黑客。不懂技术。不会编程。顺手看了一下以前公布的漏洞，照猫画虎。吐槽无力。修复？翻翻前面大大的好帖子，他们写的都比我强万倍。   版权声明：转载请注明来源 superwbd@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2012-12-07 23:32 厂商回复： CNVD确认漏洞情况，已由CNVD通过公开渠道联系网站管理方进行处置，根据所述情况研判，暂认为与支付接口无关，主责在订单系统。按部分影响完整性、可用性进行评分，基本危害评分6.42(中危)，发现技术难度系数1.1，涉及行业或单位影响1.2，综合rank=6.42*1.1*1.2=8.474 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-04 09:42 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  .....广告位出租    \n     2012-12-04 09:50 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  支付了看看呢，这样买票就便宜了~~~~~~~    \n     2012-12-04 10:03 |    \t\tsuperwbd \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 一个不懂技术的黑客。。。)\t\t \n  @zzR 说得好。。。我不在国内，没有卡，所以没法测试。。。没办法了。。。    \n     2012-12-04 10:03 |    \t\tsuperwbd \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 一个不懂技术的黑客。。。)\t\t \n  @疯子 啊。。。你给我分成10%就行~~~我这个人不黑的~~~    \n     2012-12-04 10:13 |    \t\tfly@wolvez \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:7        | 打杂的)\t\t \n  @zzR 先买了，再退票，你懂的。。。。    \n     2012-12-04 10:15 |    \t\t猥琐 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 学习什么的最重要！)\t\t \n  过年求车票    \n     2012-12-04 10:44 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @fly@wolvez ......    \n     2012-12-04 10:45 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @fly@wolvez 你提供了一个新丝路，呐呐-0-不过一般都不会去支付的    \n     2012-12-04 10:47 |    \t\tsuper480 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:2        )\t\t \n  喜闻乐见。。。。。    \n     2012-12-04 10:53 |    \t\tsuperwbd \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 一个不懂技术的黑客。。。)\t\t \n  @fly@wolvez 。。。好想法。。。    \n     2012-12-04 12:42 |    \t\tghy459 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:5        | 深挖洞，广积shell。)\t\t \n  这个也是post表单没校验的原因么？    \n     2012-12-04 13:12 |    \t\t冰锋刺客 \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:14        | 请在监护人陪同下与本人交流)\t\t \n  喜闻乐见 ~~    \n     2012-12-04 19:39 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  我日啊 我测试了两个小网站,偏偏没这样的漏洞    \n     2012-12-05 12:37 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  喜闻乐见 --    \n     2013-01-09 13:42 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:31        | Hacked by @ringzero 我錯了)\t\t \n  0.0  求写12306的。。。。    \n     2013-01-18 16:41 |    \t\tunxss \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:4        )\t\t \n  写这篇文章的，你的逻辑很“强大”。    \n     2013-01-20 00:08 |    \t\tsuperwbd \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 一个不懂技术的黑客。。。)\t\t \n  @unxss 请明示？    \n     2013-01-21 10:03 |    \t\tunxss \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:4        )\t\t \n  @superwbd @superwbd 你所遇到的，叫支付漏洞，你wooyun下。支付漏洞。 这种情况，根据你的表达，我还是没看清楚你要表达什么，我理解的是2条，第一：你通过购买方在提交过程中更改了钱的那个字段，最后由于购买方的在最后的结账中没有验签，导致了钱那个字段可以任意更改，第二：更改字段后，银行没有提示错误，依旧是0，不知道你是想表达，购买方字段验签问题还是提交到银行，支付数是0，银行没有报错呢？ 其实如果按，支付漏洞来算，这和银行一点毛关系都没有。 你甚至可以改成负的，不过你里面说了，负的会报错。 你可以看下iamlonghao 写过的支付漏洞文章，在他的博客，我记得他写文章名字是3中类型的支付漏洞，其实是3个例子了，算一种支付漏洞，就是没有验签。    \n     2013-01-22 21:47 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:31        | Hacked by @ringzero 我錯了)\t\t \n  如果 你把车票改成1分钱 然后退款?就可以刷钱了?    \n     2013-01-22 23:27 |    \t\t冰锋刺客 \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:14        | 请在监护人陪同下与本人交流)\t\t \n  其实这个和银行无关的，楼主标题有问题。    \n     2013-01-24 13:05 |    \t\tsuperwbd \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 一个不懂技术的黑客。。。)\t\t \n  @unxss @冰锋刺客  我的表述分类不当，之前的工作没有做到位，向大家致歉。另：@iamlonghao 的blog中我没有查询到这篇文章，还望您不吝赐教。    \n     2013-01-25 09:35 |    \t\tunxss \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:4        )\t\t \n  @superwbd http://imlonghao.com/post/2012-08-24/%E6%94%AF%E4%BB%98%E6%BC%8F%E6%B4%9E%E7%9A%84%E4%B8%89%E7%A7%8D%E5%B8%B8%E8%A7%81%E7%B1%BB%E5%9E%8B     这篇文章，你阅读下吧。    \n     2013-01-25 09:36 |    \t\tunxss \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:4        )\t\t \n  @unxss http://imlonghao.com/post/2012-08-24    \n     2013-01-29 03:25 |    \t\tsuperwbd \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 一个不懂技术的黑客。。。)\t\t \n  @unxss 谢谢。已学习。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}