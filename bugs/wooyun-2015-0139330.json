{"id": 68932, "wybug_id": "wooyun-2015-0139330", "wybug_title": "山西省某协会网站存在SQL注入漏洞（已入后台，信息泄露，被上传木马）", "wybug_corp": "山西省科学技术协会", "wybug_author": "小将", "wybug_date": "2015-09-08 18:18", "wybug_open_date": "2015-10-25 17:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "后台被猜解", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-10：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-09-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-25：\t细节向公众公开  简要描述： 存在SQL注入  跨站脚本编制 漏洞 详细说明：  \n山西省科学技术协会（简称山西省科协）是山西省科学技术工作者的群众组织，是中共山西省委领导下的人民团体，是党和政府联系科技工作者的桥梁和纽带，是发展科学技术事业的重要社会力量。山西省科协成立于1959年6月。现有省级学会（协会、研究会）140多个，市科协11个，县（市、区）科协119个，还有众多的市县级学会、企业科协、高校科协、乡（镇）科协、农村（社区）科普分会、农村专业技术协会等基层科协组织。这些团体集中了全省理、工、农、医及交叉学科中优秀的专家、学者和科技工作者。山西省科协网等web站点是山西省科协服务联合中心，也是山西查看科协信息的重要途径，其安全性直接影响着党和政府联系科技工作者的桥梁和纽带业务的正常开展及企业形象。受山西省通信管理局邀请，同昌科技对其公网主站进行漏洞扫描并对其站点进行渗透性测试，利用各种主流的攻击技术对系统的应用层进行安全检查，以及时发现存在的安全漏洞和风险点。\n\n\nURL:http://**.**.**.**/stat/stat.aspx?code=0&statid=740507330429%27%3B&come=&width=1280弱点描述：参数: statid, 注入类型: 字符型, 数据库类型: Microsoft SQL Server 2008,数据库名: sxasdt备注：描述： 向原始参数值中附加以下字符串：HEX(3B)差异：以下更改已应用到原始请求：•\t已将参数“statid”的值设置为“740507330429%27%3B”推理：测试结果似乎指示存在脆弱性，因为响应包含 SQL Server 错误。这表明测试设法通过注入危险字符穿透了应用程序并到达 SQL 查询本身获取服务器信息：\n\n可以获取到数据库信息：\n\n当前应用程序所用数据库\n\n列出指定数据库“sxasdt”所有表—共获取116表项：\n\n发现管理表：\n\n读取指定表中的字段名称：\n\n读取指定字段内容\n\n经破译MD5得到账号:admin 密码：yzdjxxc 开始找后台：\n\n发现存在robots.txt文件\n\n猜解后台地址：\n\n\n403.2错误是由于\"读取\"访问被禁止而造成的。导致此错误是由于没有可用的默认网页并且没有对目录启用目录浏览,或者要显示的 HTML 网页所驻留的目录仅标记为\"可执行\"或\"脚本\"权限。  Manage下面还有目录\n继续找…发现后台地址后台地址http://**.**.**.**/manage/index.aspx\n\n利用 SQL注入得到的账号admin 密码yzdjxxc 登陆后台\n\n\n\n无意发现木马文件\n\n访问木马（webshell）：http://**.**.**.**/1.aspx \n\n爆破WEBSHELL密码：\n\n此webshell有乱码，无意间又发现其他webshellhttp://**.**.**.**/2014.aspx经爆破 得到密码：admin\n\n网站存在SQL注入漏洞对网站数据及公司业务信息泄露造成很大的安全隐患。因此我们将该漏洞定级为高风险。同时此网站已经黑客被上传了木马。   漏洞证明：  \n山西省科学技术协会（简称山西省科协）是山西省科学技术工作者的群众组织，是中共山西省委领导下的人民团体，是党和政府联系科技工作者的桥梁和纽带，是发展科学技术事业的重要社会力量。山西省科协成立于1959年6月。现有省级学会（协会、研究会）140多个，市科协11个，县（市、区）科协119个，还有众多的市县级学会、企业科协、高校科协、乡（镇）科协、农村（社区）科普分会、农村专业技术协会等基层科协组织。这些团体集中了全省理、工、农、医及交叉学科中优秀的专家、学者和科技工作者。山西省科协网等web站点是山西省科协服务联合中心，也是山西查看科协信息的重要途径，其安全性直接影响着党和政府联系科技工作者的桥梁和纽带业务的正常开展及企业形象。受山西省通信管理局邀请，同昌科技对其公网主站进行漏洞扫描并对其站点进行渗透性测试，利用各种主流的攻击技术对系统的应用层进行安全检查，以及时发现存在的安全漏洞和风险点。\n\n\nURL:http://**.**.**.**/stat/stat.aspx?code=0&statid=740507330429%27%3B&come=&width=1280弱点描述：参数: statid, 注入类型: 字符型, 数据库类型: Microsoft SQL Server 2008,数据库名: sxasdt备注：描述： 向原始参数值中附加以下字符串：HEX(3B)差异：以下更改已应用到原始请求：•\t已将参数“statid”的值设置为“740507330429%27%3B”推理：测试结果似乎指示存在脆弱性，因为响应包含 SQL Server 错误。这表明测试设法通过注入危险字符穿透了应用程序并到达 SQL 查询本身获取服务器信息：\n\n可以获取到数据库信息：\n\n当前应用程序所用数据库\n\n列出指定数据库“sxasdt”所有表—共获取116表项：\n\n发现管理表：\n\n读取指定表中的字段名称：\n\n\n\n读取指定字段内容\n\n\n\n经破译MD5得到账号:admin 密码：yzdjxxc 开始找后台：\n\n发现存在robots.txt文件\n\n猜解后台地址：\n\n\n403.2错误是由于\"读取\"访问被禁止而造成的。导致此错误是由于没有可用的默认网页并且没有对目录启用目录浏览,或者要显示的 HTML 网页所驻留的目录仅标记为\"可执行\"或\"脚本\"权限。  Manage下面还有目录\n继续找…发现后台地址后台地址http://**.**.**.**/manage/index.aspx\n\n利用 SQL注入得到的账号admin 密码yzdjxxc 登陆后台\n\n\n\n无意发现木马文件\n\n访问木马（webshell）：http://**.**.**.**/1.aspx \n\n爆破WEBSHELL密码：\n\n此webshell有乱码，无意间又发现其他webshellhttp://**.**.**.**/2014.aspx经爆破 得到密码：admin\n\n网站存在SQL注入漏洞对网站数据及公司业务信息泄露造成很大的安全隐患。因此我们将该漏洞定级为高风险。同时此网站已经黑客被上传了木马。   修复方案：  加屏蔽字符   版权声明：转载请注明来源 小将@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-09-10 17:33 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给山西分中心，由其后续协调网站管理单位处置。按多个风险点评分,ran k12 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}