{"id": 20446, "wybug_id": "wooyun-2012-05444", "wybug_title": "肯德基宅急送支付表单伪造金额", "wybug_corp": "肯德基宅急送", "wybug_author": "popok", "wybug_date": "2012-03-21 19:07", "wybug_open_date": "2012-05-05 19:08", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-03-21：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-05-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 肯德基宅急送网上支付时可伪造表单，一毛钱吃大餐 详细说明：  在支付选择银行时，表单中含有金额，用户可自行修改，然后提交订单，并支付   漏洞证明：  正常表单：\n\n修改金额：\n\n支付宝：\n\n   修复方案：  选择完套餐把订单金额存入客户端无法修改的区域，如session，或者直接入库。然后支付宝签名时从那里取金额   版权声明：转载请注明来源 popok@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n          这些评论似乎很乌云~~~思密达          2012-03-24 08:56 |\t\t\t\t\t杭州神话(乌云厂商)\t\t\t\t\t\t\t\n  记得订餐在线支付回来的外送账单中木有支付金额，只显示订单金额;不过不知道你们自己支付试过没有，一般系统中应该从支付宝等返回的数据中是有相应的核验的，而返回值会与系统中订单比对，如果金额不对会支付不成功，有可能反蚀一把米。。。    \n     2012-03-24 10:20 |\t\t\t\t\t一刀终情 \t\t\t( 普通白帽子  | \t\t\t\t\t\tRank:156 漏洞数:28\t\t\t| ‮‮PKAV技术宅社区-安全爱好者)\t\t\t\t\t\t\t\n  @杭州神话 一般能伪造的，根本原因就是返回时，没再核验金额，只接收一个支付成功的消息……    \n   \n \n     2012-03-21 21:24 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  最近这么火....都开始往这方面搞了    \n     2012-03-21 21:48 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  最近真火爆~    \n     2012-03-22 01:03 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  吃货们  上啊    \n     2012-03-22 11:21 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  下订单的时候，应该会有人工参与部分，所以这个可能不太现实，有成功的没？    \n     2012-03-22 11:25 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @unic02n 据了解，宅急送接单部分是集中式的~所以派送的人只接通知~因此有可能成功的    \n     2012-03-22 11:31 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  @一刀终情 分析一下，一个订单下达，kfc会根据你的地址寻找离你最近的店来派单，这部分虽然可能是自动的，但是，接收订单的店，应该会有专人负责按照单子派食，这一步肯定是人工的，这里，个人感觉，就会露馅了，外卖人员的单子上有详细的餐品和价格，如果是几毛这样的单子，应该不会成功的。    \n     2012-03-22 11:43 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @unic02n 订单系统，也许是不显示已支付金额的；只显示某订单，订了啥，订单成功；或者支付了1毛，反馈到订单系统，成功支付xx钱~人工负责根据成功订单进行派单~所以，还是有可能~    \n     2012-03-22 11:47 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @一刀终情 你，去实验一下吧，订个最便宜的    \n     2012-03-22 12:18 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @xsser 我这里不送~~~    \n     2012-03-22 14:10 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  晚饭有着落啦= =    \n     2012-03-22 19:29 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  关注，饿了。    \n     2012-03-22 23:23 |    \t\tyingzi \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:3        )\t\t \n    求夜宵~    \n     2012-03-23 03:06 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  @unic02n 我想只会显示订单价格多少，不会显示你支付宝付了多少。由于不好意思骗饭吃，所以我到支付宝页面就没继续下去了    \n     2012-03-24 08:56 |    \t\t杭州神话(乌云厂商)\t\t \n  记得订餐在线支付回来的外送账单中木有支付金额，只显示订单金额;不过不知道你们自己支付试过没有，一般系统中应该从支付宝等返回的数据中是有相应的核验的，而返回值会与系统中订单比对，如果金额不对会支付不成功，有可能反蚀一把米。。。    \n     2012-03-24 10:20 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @杭州神话 一般能伪造的，根本原因就是返回时，没再核验金额，只接收一个支付成功的消息……    \n     2012-03-24 11:59 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  @杭州神话 +1 正解    \n     2012-03-25 16:38 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  冒着被送餐员BS的危险，下了个最便宜的订单，用0.01网上支付了一次，结果是支付宝成功，跳回商户时提示支付未成功。看来是检查返回了。好吧，看来是我不够严谨，向各位同学道歉，欺骗大家感情了！    \n     2012-03-25 17:23 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  @popok 哎，果然不会掉馅儿饼    \n     2012-05-05 20:48 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @popok 这种支付宝成功，但检查返回的最坑爹。吃了钱不吐出来，幸好只是1分钱    \n     2012-05-05 20:57 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @imlonghao 可以投诉么？    \n     2012-05-05 21:05 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @xsser 不知道，告诉客服说系统错误要退钱？觉得不太可能    \n     2012-05-05 21:38 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @imlonghao 投诉，估计有用的~    \n     2014-04-21 10:38 |    \t\t小贱人 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 资深菜鸟，)\t\t \n  mark    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}