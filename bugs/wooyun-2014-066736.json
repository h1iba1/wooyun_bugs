{"id": 1086, "wybug_id": "wooyun-2014-066736", "wybug_title": "FengCMS直接getshell+SQL注入[demo已shell,管理密码已注]", "wybug_corp": "FengCMS", "wybug_author": "magerx", "wybug_date": "2014-06-30 19:33", "wybug_open_date": "2014-09-29 18:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "源码审核", "源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-08：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向公众公开  简要描述： 测试 详细说明：  首先admin.php\n<?phpdefined('TPL_INCLUDE') or die( 'Restricted access'); \tif($_SESSION['manage']==\"\"){\t\techo '<meta http-equiv=\"refresh\" content=\"0;url=login.php\">';\t}?>\n权限验证问题，导致诸多漏洞1、getshell/app/controller/tplmanageController.php:67行 \npublic function save(){ echo json_encode(M($this->model)->save($_POST)); }\n save():/app/model/tplmanageModel.php,51行 \npublic function save($array){ $files=$this->pathset($array['name'],$array['project']); if($array['type']==0){ if(file_exists($files))return array('status' => 'e');} if(file_put_contents($files,$array['content'])){ return array('status' => 'y','project' => $array['project']); }else{ return array('status' => 'n','project' => $array['project']); } } }\n2、SQL注入app/controller/classifyController.php50行 \npublic function sorts(){ $where=$_GET['classid']?'classid=\"'.$_GET['classid'].'\"':'classid=\"0\"'; return $this->display(\"classify/sorts.html\",array(\"classify\" => M($this->model)->findall($where))); }\n用官网论坛admin号称将该cms运用到极致的demo来测试下：\n\ngetshell:\n\nSQL注入：\n\n   漏洞证明：  getshell:\n\nSQL注入：\n\n   修复方案：  额。   版权声明：转载请注明来源 magerx@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-07-05 08:56 厂商回复： CNVD通过原理核验确认所述情况（未进行实例复现），已经由CNVD通过公开联系渠道向软件生产厂商 地方网络工作室通报，guf5**  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-01 10:03 |    \t\t网络小兵 \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | t00ls)\t\t \n  这是一个新的CMS吧。。。。    \n     2014-07-01 14:03 |    \t\tFengCMS(乌云厂商)\t\t \n  我要怎么样才能看到具体信息，方便我修复    \n     2014-07-01 15:50 |    \t\tFengCMS(乌云厂商)\t\t \n  @疯狗 请求把本安全漏洞转移到我帐号底下，我们要及时处理。    \n     2014-07-01 16:10 |    \t\tFengCMS(乌云厂商)\t\t \n  @疯狗 @xsser 请求认领该漏洞    \n     2014-07-06 13:35 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  这cms漏洞太多，已经不适合挖掘了。。。    \n     2014-07-06 13:37 |    \t\tmagerx \t\t\t( 普通白帽子  |\t\t\t        Rank:257 漏洞数:45        | 别说话。)\t\t \n  @phith0n 是啊，一眼望去都是。果断扔了，    \n     2014-07-06 16:50 |    \t\tstudy_vul \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 我有乌云id了，我马上就要牛叉起来了)\t\t \n  问题多 估计没有钱了 我发一个 都不给过    \n     2014-07-08 12:40 |    \t\tFengCMS(乌云厂商)\t\t \n  FengCms安全测试站地址：http://guf521656.h163.92hezu.org/ 有效期2014-7-8至2014-7-15 欢迎各位安全界的朋友帮我们寻找安全漏洞！作为一个小小的创业团队，对各位朋友对FengCms的关注表示衷心的感谢！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}