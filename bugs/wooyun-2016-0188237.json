{"id": 88142, "wybug_id": "wooyun-2016-0188237", "wybug_title": "dubbo中间件存在Java反序列化命令执行风险                                      ", "wybug_corp": "阿里巴巴", "wybug_author": "隐形人真忙", "wybug_date": "2016-03-23 19:13", "wybug_open_date": "2016-06-26 19:00", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-03-31：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-05-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-26：\t细节向公众公开  简要描述： dubbo中间件存在命令执行的风险 详细说明：  -----------------0x00 dubbo 简介------------------Dubbo是阿里巴巴提供的一个开源的分布式服务框架，致力于提供高性能和透明化的RPC远程服务调用方案。与传统的webservice不同，dubbo可以集中管理各个服务提供者、消费者集群，并提供注册中心、性能监控和管理后台等功能。官网：http://**.**.**.**/Home-zh.htm------------------------0x01 dubbo的RMI调用方式------------------------RMI就是java程序中普遍使用的一种远程过程调用的接口，用于实现远程方法的调用。Dubbo号称无侵入的API，甚至只需要JDK支持。这不禁让我想到dubbo这种远程service管理系统难不成会少了RMI的身影？看了一下dubbo的源码，发现dubbo存在多个协议的支持：\n\n不出所料，果然是支持RMI协议。来看一下dubbo里的实现：\n\n使用了Spring的RMI创建方式，底层实现还是原生RMI，如果server端使用了不安全的lib，就会造成RMI方式的反序列化漏洞。----------------------------------0x02 dubbo RMI模式下的反序列化漏洞-----------------------------------本地搭建起dubbo服务，使用zookeeper作为注册中心，protocol选择为：\n\n开启RMI服务之后，就会在dubbo控制台上看到服务信息：\n\n使用ysoserial.jar提供的RMI注册类执行命令，这里使用了cloudeye进行辅助测试：\n\n关于RMI的反序列化执行，可以看看zone上有人发的帖子，想了解原理，可以看绿盟发的分析文：http://**.**.**.**/java-deserialization-vulnerability-overlooked-mass-destruction/Cloudeye收到信息：\n\n--------------0x03 小彩蛋---------------在测试的途中，发现了不少dubbo的监控组件暴露，并且互联网上存在很多弱口令的dubbo-admin（默认用户名/密码为root）。两个小例子：**.**.**.**:8090/governance/services/jackjboss/com.chsoft.shiro.facade.UserService/providers/615**.**.**.**:8080/governance/services/com.alibaba.dubbo.monitor.MonitorService/providers/40   漏洞证明：  见详细说明   修复方案：  针对rmi协议模式做一些过滤处理   版权声明：转载请注明来源 隐形人真忙@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-03-28 18:59 厂商回复： 您好，问题已经确认，正在修复中。感谢您对阿里安全的关注和支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-28 19:36 |    \t\t隐形人真忙 \t\t\t( 普通白帽子  |\t\t\t        Rank:201 漏洞数:25        | ...)\t\t \n  应该还会有更劲爆的    \n     2016-03-28 19:46 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1754 漏洞数:269        | 以大多数人的努力程度之低，根本轮不到去拼...)\t\t \n  期待...    \n     2016-04-27 11:28 |    \t\tubuntu \t\t\t( 普通白帽子  |\t\t\t        Rank:148 漏洞数:12        | 一切皆有可能……)\t\t \n  期待。。。    \n     2016-05-24 12:27 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:5372 漏洞数:415        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  Java老司机，CommonsColections3 能发出来学习学习吗？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}