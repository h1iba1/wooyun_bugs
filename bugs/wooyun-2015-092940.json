{"id": 39912, "wybug_id": "wooyun-2015-092940", "wybug_title": "土巴兔装修网任意用户密码重置", "wybug_corp": "土巴兔装修网", "wybug_author": "hkAssassin", "wybug_date": "2015-01-21 10:56", "wybug_open_date": "2015-03-07 10:58", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证设计不合理", "设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-07：\t细节向公众公开  简要描述： 密码找回功能设计存在问题 详细说明：  先到找回密码功能处 如下图\n\n然后填写需要重置的用户账号。到第二步不管是手机还是邮箱的都点击发送验证码。之后通过谷歌浏览器的元素审查修改第二步的元素内容为如下代码：\n<form method=\"post\" onsubmit=\"return check_passWord(this)\" action=\"get_password.php\">            <div class=\"reset_content_passwd\" style=\"display:block;\">                <p>验证成功，请重新设定您的密码</p>                <div class=\"user_input\">\t\t\t\t\t<input style=\"display: none;\">                    <label>新密码：</label>                    <input class=\"input_txt\" type=\"password\" name=\"password1\" id=\"password\" autocomplete=\"off\" style=\"border: 1px solid rgb(204, 204, 204);\">                    <div class=\"message\" style=\"display: none;\"></div>                </div>                <div class=\"user_input\">\t\t\t\t\t<input style=\"display: none;\">                    <label>确认新密码：</label>                    <input class=\"input_txt\" type=\"password\" name=\"password2\" id=\"password2\" autocomplete=\"off\" style=\"border: 1px solid rgb(204, 204, 204);\">\t\t\t\t\t<div class=\"message \" style=\"display: none;\"></div>                </div>                <input type=\"submit\" class=\"next_bit\" value=\"确认\">            </div>            </form>\n这样就直接跳到第三部输入新密码的地方了。然后填写新密码确定即可重置此用户名。我在上面找了两个美女的账号重置了下看下面的截图。\n\n\n\n\n\n由于http://www.to8to.com/这个域名和http://www.shejiben.com/这个域名的账号通用，应该是从同一个数据库查的数据，所以改一个另一个也可以登录。   漏洞证明：  先到找回密码功能处 如下图\n\n然后填写需要重置的用户账号。到第二步不管是手机还是邮箱的都点击发送验证码。之后通过谷歌浏览器的元素审查修改第二步的元素内容为如下代码：\n<form method=\"post\" onsubmit=\"return check_passWord(this)\" action=\"get_password.php\">            <div class=\"reset_content_passwd\" style=\"display:block;\">                <p>验证成功，请重新设定您的密码</p>                <div class=\"user_input\">\t\t\t\t\t<input style=\"display: none;\">                    <label>新密码：</label>                    <input class=\"input_txt\" type=\"password\" name=\"password1\" id=\"password\" autocomplete=\"off\" style=\"border: 1px solid rgb(204, 204, 204);\">                    <div class=\"message\" style=\"display: none;\"></div>                </div>                <div class=\"user_input\">\t\t\t\t\t<input style=\"display: none;\">                    <label>确认新密码：</label>                    <input class=\"input_txt\" type=\"password\" name=\"password2\" id=\"password2\" autocomplete=\"off\" style=\"border: 1px solid rgb(204, 204, 204);\">\t\t\t\t\t<div class=\"message \" style=\"display: none;\"></div>                </div>                <input type=\"submit\" class=\"next_bit\" value=\"确认\">            </div>            </form>\n这样就直接跳到第三部输入新密码的地方了。然后填写新密码确定即可重置此用户名。我在上面找了两个美女的账号重置了下看下面的截图。\n\n\n\n\n\n由于http://www.to8to.com/这个域名和http://www.shejiben.com/这个域名的账号通用，应该是从同一个数据库查的数据，所以改一个另一个也可以登录。   修复方案：  服务端做验证。看你们确认的态度，手里还有更严重的问题等着你们认领呢！   版权声明：转载请注明来源 hkAssassin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-01-21 13:06 厂商回复： 感谢报告 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}