{"id": 15163, "wybug_id": "wooyun-2012-015378", "wybug_title": "果壳网存储型xss，虽经过一次修复但是仍然存在绕过。", "wybug_corp": "果壳传媒", "wybug_author": "渚熏", "wybug_date": "2012-11-28 17:56", "wybug_open_date": "2013-01-12 17:57", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-12-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-12-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-12：\t细节向公众公开  简要描述： 发帖处的连接插入可以填入xss 详细说明：  果壳网的这个发送框之前存在过xss问题，乌云上也有人提过漏洞，后来修复了，但是少考虑了利用&#编码绕过关键字检查这种情况。在发帖处：\n\n可以看到，代码模式下href不加过滤的话就会直接输出到页面的a标签里。之前爆出漏洞后果壳在这里加过一次过滤，“javascript:”等填入后会被提示包含敏感词需要审核，但是这次发现如果利用&#编码后可以绕过，而且最终浏览器端可以触发js。   漏洞证明：  下面是证明，客户端看到的源代码：\n\nfirebug中：\n\n点击后的触发js，这里是可以虽然拿到cookie，不过关键的键值做了httponly：\n\n   修复方案：  先对&#这种东西解码再过滤关键字吧。   版权声明：转载请注明来源 渚熏@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2012-11-30 13:36 厂商回复： 感谢你的反馈，问题已经收到，我们会处理好每一个反馈的！～在大家的建议下，果壳会越做越好！ 最新状态： 2012-12-03：已经修复  ", "replys": "漏洞评价：\n评论\n     2012-11-28 18:57 |    \t\t斯文的鸡蛋 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:41        | 我在这头，你在那头~)\t\t \n  果断等待忽略    \n     2012-11-30 15:22 |    \t\t果壳传媒(乌云厂商)\t\t \n  @斯文的鸡蛋 感谢大家的反馈，问题已经收到并记录下来了，我们会处理每一个大家的反馈，修改正在进行中。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}