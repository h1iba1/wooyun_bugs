{"id": 6684, "wybug_id": "wooyun-2013-040137", "wybug_title": "爱快软路由任意命令执行漏洞一枚(非st2)", "wybug_corp": "爱快免费流控路由", "wybug_author": "LinE", "wybug_date": "2013-10-18 09:14", "wybug_open_date": "2014-01-16 09:15", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["命令执行", "敏感文件操作参数未加过滤"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-21：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-12-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-16：\t细节向公众公开  简要描述： 爱快软路由任意命令执行一枚，可执行任意命令 详细说明：  首先进入后台，在系统设置---升级/备份当中，点击文件名即可进行备份改名在此处修改之前开启抓包工具，改名过程抓包，获得了改名的接口old_name和namehttp://192.168.20.100/cgi-bin/backupsAdd.php?old_name=2013-10-17-234141.bak&name=2013-10-17-234141.bak由于此处未做任何过滤，可以在url之后加入;+命令导致了该漏洞的触发因为命令执行了之后并不会在此处做返回结果，所以需要把返回的结果重定向到WEB目录下/tmp/ikuai/www/cgi-bin于是打开例如http://192.168.20.100/cgi-bin/backupsAdd.php?old_name=2013-10-17-234141.bak&name=2013-10-17-234141.bak;ls%20-l>/tmp/ikuai/www/cgi-bin/1.txt这个url即可获取当前目录下文件列表\n\n查看用户的时候我惊呆了\n\nroot有木有，可以干坏事有木有.....GetShell在这里已经不重要了....有了非交互的shell，交互的还会远么......   漏洞证明：  \n\n\n\n有图已经可以说明一切了改个Root密码\n\n   修复方案：  这个你们看着办吧   版权声明：转载请注明来源 LinE@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-10-18 15:55 厂商回复： 感谢白帽子兄弟帮忙找出漏洞，也希望更多的白帽子可以帮忙检测我们的产品，我们对安全态度的开放是令人发指的，我们认为安全是最重要的，白帽子同志们的检测是很给力的（但还请不要公开漏洞细节，会对我们造成损失，多谢）请挖到这个漏洞的兄弟联系QQ领取奖品：1808663661 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-18 10:07 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  牛掰    \n     2013-10-18 11:58 |    \t\t爱快免费流控路由(乌云厂商)\t\t \n  等待技术同事确认中，作为一个出了名注重安全的小创业公司，我们一如既往的欢迎白帽子同志们检测，并且会送出小礼物表示尊敬。    \n     2013-10-18 16:09 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  厂商挺赞~    \n     2013-10-18 16:19 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @niliu 除了腾讯等几个2我都挺喜欢的    \n     2013-10-18 16:27 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @xsser 恩，是... 对了，我提交的两个中国航空的洞怎么都小厂商啊？有时间帮忙看下呗~    \n     2013-10-22 18:15 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  我们对安全态度的开放是令人发指的  这是贬义词啊？    \n     2013-10-24 12:16 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @梧桐雨 这个是贬义当褒义用！语文挺好~    \n     2013-10-24 12:23 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @gainover 能理解能理解    \n     2013-10-28 08:55 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  好多大牛在这！    \n     2013-10-28 15:58 |    \t\t3King \t\t\t( 普通白帽子  |\t\t\t        Rank:1129 漏洞数:92        | 【study at HNUST】非常感谢大家的关注~ 大...)\t\t \n  点32个赞~    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}