{"id": 17193, "wybug_id": "wooyun-2012-011146", "wybug_title": "联想某商场账户设计缺陷，可能会导致在已知注册邮箱的情况下密码被爆破", "wybug_corp": "联想", "wybug_author": "imlonghao", "wybug_date": "2012-08-21 17:52", "wybug_open_date": "2012-10-05 17:52", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-08-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-09-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-09-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-10-05：\t细节向公众公开  简要描述： 联想最近火了~~~和之前的福建网龙有得比了。。。。就也来掺一脚~~求乐phone~~~~求乐phone~~~~求乐phone~~~~求乐phone~~~~求乐phone~~~~求乐phone~~~~--幻想有乐phone的日子ing.....在知道用户注册email的情况下，由于开发时的逻辑问题，先通过XX，然后就可以通过穷举来知道用户密码，接着就可以登录到这个用户的帐号。然后，个人信息什么的，就会泄漏了。没有去看支付过程是如何，假如有预存款余额的话，应该是可以盗钱滴.....(数字事件，你懂的....) 详细说明：  在联想官方网上商城中 http://shop.lenovo.com.cn/首先说一说注册，注册完后，用户的帐号和密码居然通通都以明文的方式发送到用户的邮箱中，假如用户的邮箱出了问题，拿下这个帐号就是无压力的了。\n\n然后就进入正题了，忘记密码的过程经过分析基本如下：用户：使用电子邮件找回密码--系统：密码重置为6位的全数字密码--系统：重置后的密码发送到用户的邮箱中--用户：使用重置后的密码登录--用户：在用户中心后台修改密码(可以省略这步)过程基本上就是这样子的，这个找回密码的过程可谓是奇葩，居然仅仅提供一个email地址就可以不经确认就重置用户的密码，而且还是6位的数字密码。   漏洞证明：  我用自己的帐号来进行实验首先找回密码，输入自己的email地址。\n\n然后，我就收到了一封邮件，明文写着我的6位数字新密码。。。。\n\n假设我们不知道这个密码是什么。。。我们来到登录的地方，一眼看上去有个验证码，理论上应该是可以防止被穷举的，但非常遗憾，这个验证码形同虚设。我们输入邮箱、假的密码和正确的验证码，使用burp抓包。\n\n没仔细研究验证码的比对方式，我猜应该是和/openapi/pam_callback/login/module/pam_passport_basic/type/member/appid/b2c/redirect/L3Bhc3Nwb3J0LXBvc3RfbG9naW4tTDIxbGJXSmxXXTVvZEcxXX5odG1s 后面的字符串进行验证的。然后就是大家都懂的，生成字典，6位数字，从100000到999999。坐等破解，破解时间看你的网络状态。。。。很快，我们就可以看到一个特殊的请求。\n\n由此可见，258729就是重置后的密码(和上图的密码不一样是因为上面那个图是补的..)我们使用这个密码登录，成功登录\n\n   修复方案：  注册后密码不要明文发给用户修改找回密码的流程加强验证码的验证方式最好的话加上一个帐号一天超过N次就锁定帐号   版权声明：转载请注明来源 imlonghao@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-08-21 18:33 厂商回复： Smart guy. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-08-21 18:01 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  奇葩漏洞    \n     2012-08-21 18:02 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @风萧萧 是啊，关键是逻辑设计得很奇葩。。    \n     2012-08-21 18:03 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @imlonghao 你是在线等回复呢    \n     2012-08-21 18:04 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @风萧萧 刷新就看到了。。。    \n     2012-08-21 18:28 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @imlonghao 以前刷豆瓣 现在刷乌云    \n     2012-08-21 18:32 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @xsser 我没刷过豆瓣，嘿嘿。。    \n     2012-08-21 19:07 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @联想 有乐phone否？嘿嘿    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}