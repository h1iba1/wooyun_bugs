{"id": 43442, "wybug_id": "wooyun-2014-082700", "wybug_title": "XYCMS心理咨询中心建站系统SQL注入漏洞打包", "wybug_corp": "江苏鑫跃科技有限公司", "wybug_author": "路人甲", "wybug_date": "2014-11-11 16:40", "wybug_open_date": "2015-02-09 16:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-11：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-02-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： SQL注入 详细说明：  下载地址:http://down.chinaz.com/soft/34989.htm漏洞参数：id漏洞文件：1.common.asp\n<%@LANGUAGE=\"VBSCRIPT\" CODEPAGE=\"936\"%><!--#include file=\"xyconn.asp\"--><!--#include file=\"Inc/xycms.asp\" --><!--#include file=\"Inc/config.asp\" --><%id=request.QueryString(\"id\")if id=\"\" or not isnumeric(id) thenresponse.write \"<script>alert('¾¯¸æ!·Ç·¨²ÎÊý£¡');window.location.href='index.html';</script>\" Response.End()end ifset rs=server.createobject(\"adodb.recordset\") exec=\"select * from common where id=\"&id //直接带入查询rs.open exec,conn,1,1%>\n2.down_detail.asp\n<%id=request.QueryString(\"id\")set rs=server.createobject(\"adodb.recordset\") exec=\"select * from [down] where id=\"& idrs.open exec,conn,1,1if rs.eof thenresponse.Write \"<div style=\"\"padding:10px\"\">Ã»ÓÐÏà¹ØÐÅÏ¢£¡</a>\"response.End()end if%>\n3.news.asp\n<%id=request.QueryString(\"id\")if  not isnumeric(id) thenResponse.Write \"<script>alert('¾¯¸æ£¡²ÎÊý´íÎó£¡');history.go(-1);</script>\" Response.End()end ifset rs=server.createobject(\"adodb.recordset\") if id=\"\" thenexec=\"select * from news order by id desc\"elseexec=\"select * from news where ssfl=\"&id&\" order by id desc\"end ifrs.open exec,conn,1,1%>\n4.job_detail.asp\n<%id=request.QueryString(\"id\")set rs=server.createobject(\"adodb.recordset\") exec=\"select * from zpxx where id=\"& idrs.open exec,conn,1,1if rs.eof thenresponse.Write \"<div style=\"\"padding:10px\"\">Ã»ÓÐÏà¹ØÐÅÏ¢£¡</a>\"response.End()end if%>\n5.news_detail.asp6.team_detail.asp7.adv_dir.asp   漏洞证明：  \n\nmask 区域\n1.://**.**.**//www.wooyun.org/bugs/wooyun-2010-066498的案例：_2.http://**.**.**3.http://**.**.**/common.aspid=1%20and%201=1 相同_4.http://**.**.**/common.aspid=1%20and%201=2 报错_*****6cf39eda5ad9918dd40c6d.jpg**********ba67f02a96dca17c9b6681.jpg*****5.http://**.**.**/down_detail.aspid=1&6.http://**.**.**/news.aspid=1&\n\n   修复方案：  id参数过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}