{"id": 58069, "wybug_id": "wooyun-2014-052413", "wybug_title": "彩票宝设计不当可重置用户密码", "wybug_corp": "www.cpbao.com", "wybug_author": "魇", "wybug_date": "2014-03-01 20:35", "wybug_open_date": "2014-04-15 20:35", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-15：\t细节向公众公开  简要描述： RT 我看上一个白帽子提交的你们忽略了，不会给我再忽略了把？ 详细说明：  小细节引发出的大隐患此方法可以重置所有绑定邮箱的用户在彩票宝忘记密码处，根据邮箱找回密码经过测试得出，需要验证原邮箱名称，验证成功后会将密码重置成6位纯数字密码发送到邮箱但是这里我们不知道绑定的邮箱名怎么办？直接谷歌浏览器F12 这个设计很有意思...已经赤裸裸的帮我们把邮箱名输出了..\n\n于是填写邮箱名，确认发送重置密码\n\n然后现在转到登录页面，这里的登录没有限制登录次数也没有验证码，可以无限尝试\n\n输入wooyunyana:123456以密码123456这个参数直接抓包进行BURP爆破\n\n\n\n设置从100000-999999从返回的长度得出重置后的密码\n\n好了，我们登录一下 看是否登录成功wooyunyana:194383\n\n\n\n登录成功！   漏洞证明：  \n\n\n\n   修复方案：  看详细说明吧,上述说明我是以自己的帐号测试，只有有绑定邮箱的都可以重置，厂商也可以自己复测下   版权声明：转载请注明来源 魇@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-03-03 12:45 厂商回复： 已经屏蔽一些，随后还会解决一些，非常感谢 最新状态： 2014-03-11：已经修订 2014-04-17：非常感谢，已经更改了，再次感谢  ", "replys": "漏洞评价：\n评论\n     2014-03-01 20:38 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  @xsser 怎么是小厂商 ..    \n     2014-03-01 20:52 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  @xsser@疯狗这个首页有中奖榜单跟随处可见的用户名随便重置一个危害也算不小吧.毕竟有RMB..    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}