{"id": 2356, "wybug_id": "wooyun-2014-065319", "wybug_title": "新网主站登录设计逻辑缺陷可撞库分析", "wybug_corp": "新网华通信息技术有限公司", "wybug_author": "onlycjeg", "wybug_date": "2014-06-23 16:52", "wybug_open_date": "2014-08-07 16:54", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-07：\t细节向公众公开  简要描述： 新网主站登录设计逻辑缺陷，弱口令用户可遭殃； 详细说明：  新网主站登录设计逻辑缺陷，去年解析域名的时候发现的问题。。。。http://www.xinnet.com/account/account.do?method=index两处登录框，可无视验证码进行暴力破解；1、账号规则固定，允许自定义账号登录和hy1XXXXX的系统固定格式id进行登录；\n\n2、虽然用户登录模块有验证码，但是主页右上角的登陆框，可无视验证码；\n\n3、使用主页右上角登录框进行登录，抓包；\n\n4、使用repeater功能进行反复提交分析，发现如果带有cookie，则无论如何提交账号，都返回空，这里如果无法直接进行批量爆破；\n\n5、反复分析后，删除cookie后，正常提交，服务器返回正常账号状态，则手工删除cookie使用hy1XXXXX格式的id，可组合12345678、admin123、password等弱口令进行批量猜测账号；\n\n6、配置猜测范围和提取页面返回错误的特征，准备进行批量；\n\n\n\n8、分分钟就出现弱口令了....口令正确，页面返回当前用户名；\n\n9、估计弱口令的都是小号，有业务的账号，不可能用12345678，不过你也可以换字典再批量跑...\n\n\n\n   漏洞证明：  8、分分钟就出现弱口令了....口令正确，页面返回当前用户名；\n\n9、估计弱口令的都是小号，有业务的账号，不可能用12345678，不过你也可以换字典再批量跑...\n\n\n\n   修复方案：  我就看看，我不说话；   版权声明：转载请注明来源 onlycjeg@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-06-23 16:59 厂商回复： 非常感谢onlycjeg@乌云，小新正在玩命确认及修复中 最新状态： 2014-07-01：漏洞已修复，非常感谢onlycjeg@乌云  ", "replys": "漏洞评价：\n评论\n     2014-06-18 09:19 |    \t\tdiguoji \t\t\t( 普通白帽子  |\t\t\t        Rank:323 漏洞数:79        | 中国吉林长春)\t\t \n  抢位，洞主给力    \n     2014-06-23 08:14 |    \t\tAnnabelle \t\t\t( 实习白帽子  |\t\t\t        Rank:46 漏洞数:15        | .)\t\t \n  我是这么想的，账号虽然可以自定义，但是撞到一个的可能性能有多少？我倒是觉得的，某些可以批量爬取登陆账号的地方才可能是设计缺陷。 我是菜鸟，各位大牛不要打我。    \n     2014-06-23 08:48 |    \t\t银狼_avi \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:13        | 本屌十二岁破处)\t\t \n  又是一个把新网华通跟新网互联搞错的    \n     2014-06-23 09:57 |    \t\tgerfalke \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | IT屌丝一枚)\t\t \n  楼主的burp本班有点老    \n     2014-06-23 17:02 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @小新 正在玩命确认及修复中    \n     2014-06-23 22:44 |    \t\tonlycjeg \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:5        | 我就看看,我不说话.)\t\t \n  @小新，原来是我发错厂商了？我看忽略了，气的我打算继续丢洞来着....    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}