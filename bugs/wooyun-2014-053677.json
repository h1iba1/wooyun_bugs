{"id": 4527, "wybug_id": "wooyun-2014-053677", "wybug_title": "麦包包主站重置任意用户密码", "wybug_corp": "麦包包", "wybug_author": "U神", "wybug_date": "2014-03-15 00:04", "wybug_open_date": "2014-04-29 00:05", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-29：\t细节向公众公开  简要描述：  详细说明：  #1.看着麦包包确认速度如此快，于是打算看看有木有什么漏洞，在主站注册了一个用户，试着看看有没有找回密码的漏洞，因为需要测试，所以我这里注册了两个帐号~一个是用QQ邮箱的、一个是用163邮箱的~首先我是用QQ邮箱注册麦麦包的进行找回密码，然后邮箱中接到类似如下的重置密码URL:\nhttp://login.mbaobao.com/user/resetpwd?type=email&__t__=System.mbaobao.getPassword&__e__=9******1%40qq.com&__c__=231135ca-e7f0-418e-9b59-7779ff744acb&__x__=635305213890183927&__ss__=5A69BB723927A5E9E0E1D6BA7A63CCC2\n不分析这个url是怎么构造的，我们先打开这个url，看看页面是这样的，也提示了重置密码的邮箱9******1@qq.com[不公开我个人邮箱，故打码]：\n\n#2.此时填好要修改的密码和验证码，然后打开burpsuite抓包，这里将\"username\"参数的值修改为你要改的邮箱的密码，这里我就改成另一个163邮箱的~然后发送数据包。\n\n然后提交密码修改成功！登录刚才我们那个163邮箱的帐号~发现密码成功被改了~\n\n\n\n   漏洞证明：  #3.为了证明漏洞的真实性，我这里找到麦包包的邮箱进行测试，友好测试，请不要见怪！\n\n\nmbb@mbaobao.com\n然后打开刚才那个重置URL的链接，修改为麦包包的邮箱~【PS：麦包包的重置密码链接可以无数次重置而不过期，这是一个设计缺陷！】（如出现要求再提交一次请再提交一次！你更会发现上面的帐号已经变成了你要改的帐号）\n\n成功登录麦包包的帐号，居然是测试帐号！【已重置密码为test10086】\n\n   修复方案：  程序员拖出去打一百大板！求礼物~求高分rank~   版权声明：转载请注明来源 U神@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-03-17 11:42 厂商回复： 感谢洞主，我们将尽快修复。 最新状态： 2014-03-21：已修复  ", "replys": "漏洞评价：\n评论\n     2014-03-15 08:52 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  啦么多变量、dz是肿么做到的？    \n     2014-03-15 09:42 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  又可以重置了？我记得之前我重置过两次密码。。。    \n     2014-03-15 09:43 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  莫非是移动端。。    \n     2014-03-15 12:01 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  麦包包主站重置任意用户资料漏洞麦包包主站重置任意用户密码你们太屌了 ..    \n     2014-03-21 14:59 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @麦包包 要发礼品了！大家赶快多找几个洞儿    \n     2014-03-21 16:01 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @U神 真的么？    \n     2014-03-29 21:36 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @px1624 我还是没收到礼物，麦包包的重置密码你去看看还有啥漏洞哇    \n     2014-04-06 15:47 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  。。。我当年证明麦包包重置密码，，貌似也是重置的那个mbb的帐号    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}