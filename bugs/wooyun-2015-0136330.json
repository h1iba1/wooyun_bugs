{"id": 65788, "wybug_id": "wooyun-2015-0136330", "wybug_title": "泛华核心业务系统前台SQL注入（oracle注入技巧）", "wybug_corp": "泛华保险服务集团", "wybug_author": "白非白", "wybug_date": "2015-08-23 19:53", "wybug_open_date": "2015-10-10 20:08", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-10：\t细节向公众公开  简要描述： 如题所述 详细说明：  泛华核心业务系统http://cbs.cninsure.net/logon/Login.jsp用户编码栏输入单引号抓包报错\n\n但是直接丢给sqlmap却一直无法识别注入点（bool型，报错型均未识别出）经过手动测试发现，bool型无法识别是因为原语句条件真假返回的数据都相同：\n\n\n\n1）构造bool注入继续测试发现支持union，字段数为4，但是union查到的数据没法直接回显，通过构造sql条件语句，可以构造出一个bool注入。如下图，改变条件真假，回显不同。\n\n\n\n但是设置了prefix和suffix之后sqlmap还是无法识别注入点（sqlmap你肿么了？），于是换一个工具，用了shack2的超级sql注入工具，设置如下：\n\n这样，便可以提取数据了，但是bool型速度很慢，既然报错有回显可以尝试报错注入2）报错注入构造依然使用shack2的超级sql注入工具，设置两处如下：\n\n\n\n（or后面需要有一个空格，不要问我为什么，这是一个bug...@shack2）把and替换成or是因为，使用and无法报错：\n\n\n\n设置完后，就可以利用报错注入快速提取数据了   漏洞证明：  环境变量信息\n\n数据库（25个）\n\n   修复方案：  应该懂   版权声明：转载请注明来源 白非白@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-08-26 20:07 厂商回复： 已在紧急处理，非常感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-23 21:55 |    \t\tGixMore \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 做个平凡的白帽子)\t\t \n  看到技巧，心神荡漾    \n     2015-08-23 22:36 |    \t\t猫和老鼠 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | ...)\t\t \n  学习了，写得详细    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}