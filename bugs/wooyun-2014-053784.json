{"id": 57639, "wybug_id": "wooyun-2014-053784", "wybug_title": "cctv某站点任意文件上传", "wybug_corp": "中国网络电视台", "wybug_author": "study_vul", "wybug_date": "2014-03-25 11:36", "wybug_open_date": "2014-05-09 11:36", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-25：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-05-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 央视某系统存在任意文件上传漏洞，殃及多个站点 详细说明：  前几天发现siteserver系统 权限绕过问题 WooYun: siteserver3.6.4一行代码击垮所有安全防护 时隔多日厂商迟迟没有确认，对于对一次来乌云提交漏洞，就这样...真的的很伤心，但是看看以往大牛们提交的siteserver漏洞，也基本未修复,真的是无言以对，这可是国内第一个。net内容管理系统呀，怎么都这样? 作为白帽子，很为站长伤心...坐下来想想，可能官方觉得没有什么危害吧，但是个人还是觉得这个问题挺严重的，因此考虑还是做一个测试案例，提交给cnvd进行处理，可能好些。因此有了下文...去siteserver官网可以看到有很多使用该cms的站点，而且各行各业，都包括了 不愧是国内最大的.net cms. 由于是0day因此，只要是使用siteserver站点，基本都在劫难逃。但由于太多使用该cms站点，无法一一列举进行测试。因此只举一个例子进行证明。http://www.siteserver.cn/case/62.html在这个页面，我看到了央视...http://www.cctvad.org该站点的使用了siteserver，但是后台管理页面被删除了，站长以为就可以逃过一劫，其实我们知道该漏洞是权限绕过(不知道说的对不对),因此后台的任意界面都可以访问的，所以我直接访问后台的系统升级功能，大家都知道在线升级功能，一般都会保留，因为这个功能很重要，打补丁嘛。\n\n发送请求，返回302，直接修改数据包，将302改成200，变成如下形式:\n\n同时去掉结尾的这行js\n\n然后进行显示\n\n可以访问该功能了。点击导入补丁包，然后选择一个a.zip(里面可以放任何文件 包括webshell)\n\n获得第一个返回请求包，\n\n就是将302 修改成200 删除跳转相关代码即可。\n\n每次都这样操作后，看到如下界面:\n\n上传完成了。访问上传的文件路径\n\n也可以是shell\n\n上面还有几个站点，没有仔细看\n\n只是为了说明 漏洞很严重，补丁要及时   漏洞证明：  如上所示该漏洞是未公开的漏洞，个人感觉还是很严重的，希望cncert责令厂商及时修复，同时通知多个使用该系统的政府教育等等站点，及时更新或者更换系统。所谓未公开，就是0day，即使上了防护(如果你是一个细心的读者，从第一个图片可看出这个站点的防护设备是什么),也未必能能够挡住所有攻击，所谓的防护类似杀毒软件，一般都是滞后，应该从根本上解决问题，才是关键。   修复方案：  一行代码的事，一行代码能成事，也能坏事。而且从官方列举的案例可以看出，很多使用siteserver站点都已经更换了系统，对于不负责任的厂商，更换系统可能是最好的修复方案(请原谅我的言辞激烈，实在是忍无可忍)   版权声明：转载请注明来源 study_vul@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-03-25 20:19 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  哥们你杯具了 ..    \n     2014-03-26 19:44 |    \t\tstudy_vul \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 我有乌云id了，我马上就要牛叉起来了)\t\t \n  @魇 呵呵 其实不是我提交到他们的 是@疯狗 说是他们的 呵呵  反正做了小厂商 没有几wb 算了    \n     2014-03-31 13:49 |    \t\t蝴蝶结 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:2        | 小小的梦想，在心中埋藏，发觉它已经在远方)\t\t \n  @study_vul 看了你另外一个关于siteserver的那个洞 自己试的时候没有成功 能留个联系方式 指导一下吗    \n     2014-05-31 16:44 |    \t\t郭斯特 \t\t\t( 普通白帽子  |\t\t\t        Rank:181 漏洞数:69        | GhostWin)\t\t \n  站长也能这么牛x？？？~jj fly~    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}