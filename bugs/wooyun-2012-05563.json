{"id": 20361, "wybug_id": "wooyun-2012-05563", "wybug_title": "中国移动mas2.0平台系统漏洞", "wybug_corp": "中国移动", "wybug_author": "Lee", "wybug_date": "2012-03-26 11:30", "wybug_open_date": "2012-05-10 11:31", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-03-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-03-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-04-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-04-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-04-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-05-10：\t细节向公众公开  简要描述： MAS是中国移动的短信代理网关（平台）。MAS是Mobile Agent Server的简称。目前多个政府部门、国有大型企业部门、运营商、金融部门都采用该平台。MAS2.0是中国新一代的代理网关系统。漏洞有可能会泄露使用该平台的单位手机通信录，利用mas发送欺骗短信。 详细说明：  一、产品说明MAS是中国移动的短信代理网关（平台）。MAS是Mobile Agent Server的简称。目前多个政府部门、国有大型企业部门、运营商、金融部门都采用该平台。MAS2.0是中国新一代的代理网关系统。二、漏洞细节1、后台验证绕过漏洞后台管理页面对session赋值存在逻辑错误，使得攻击者在登陆页面输入错误账户后可以得到一个返回true的session值，此时可以直接访问后台页面，可以获取敏感资料和发送短信（厅级领导个人电话，或者发送欺骗短信）。测试步骤：a、访问登陆页面http://x.x.x.x/logon.jsp输入任意账户，登陆。b、直接访问http://x.x.x.x/left.jsp2、文件上传部门mas平台存在通信录和彩信图片上传界面，可以通过截断和本地提交方式上传jsp文件。（不通用，仅测试了一个，部分mas2.0不存在上传页面）。三、修复建议1、对后台文件进行权限验证；2、过滤上传文件后缀；   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  1、对后台文件进行权限验证；2、过滤上传文件后缀；   版权声明：转载请注明来源 Lee@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2012-03-26 11:32 厂商回复： 添加对漏洞的补充说明以及做出评价的理由 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-03-26 11:41 |    \t\tLee \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:24        | wataru@eviloctal.com)\t\t \n  亲，很严重的哦    \n     2012-03-26 11:43 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  这也叫严重？移动要好好进行全网检查！    \n     2012-03-26 11:53 |    \t\tLee \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:24        | wataru@eviloctal.com)\t\t \n  @shine 够严重了。很多穿衣服的大领导的手机都有。    \n     2012-03-26 11:57 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  @Lee 这样的太多了，有的能造成大面积通信中断风险的，实在不想管的，今天给移动发最后一个，别找我麻烦就行了，主要我也是本省用户！    \n     2012-03-26 11:58 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  添加对漏洞的补充说明以及做出评价的理由 他妹的！    \n     2012-03-26 11:59 |    \t\tLee \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:24        | wataru@eviloctal.com)\t\t \n  @xsser 再来一个    \n     2012-03-26 12:00 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  @xsser 我发的那两个安全问题，看来是要忽略了，算了吧！解决问题就行了！    \n     2012-03-26 12:02 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @shine 我想把这个厂商禁用，交给cert处理的    \n     2012-03-26 12:05 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  @xsser 恩！我赞成，单从态度就不符合乌云厂商的基本要求！而且，我发的，有的比较严重的，现在都不修复的！    \n     2012-03-26 13:34 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @xsser @shine 强烈支持。鄙视其态度。    \n     2012-03-26 17:01 |    \t\t天行健 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:3        | 业余信息安全爱好者，没事了玩一玩)\t\t \n  @xsser 好主意，移动这帮人财大气粗，根本不把白帽放眼里，白帮他们找漏洞，还不愿意修复，直接让cert施压通过移动集团公司处理吧，高效又及时    \n     2012-05-04 09:51 |    \t\t期待爱 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | 这个家伙很精明 连条内裤也没有留下！！！)\t\t \n  我怀疑是客服处理这些问题的    \n     2012-07-24 11:22 |    \t\tSurp4ss \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 不以风骚惊天下，就以淫荡动世人。)\t\t \n  @shine - -求教关于mas方面的内容。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}