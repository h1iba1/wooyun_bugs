{"id": 9439, "wybug_id": "wooyun-2013-037115", "wybug_title": "盛大旗下有妖气漫画网某分站任意用户密码修改漏洞", "wybug_corp": "盛大网络", "wybug_author": "zer0", "wybug_date": "2013-09-18 17:14", "wybug_open_date": "2013-09-23 17:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： help.u17.com采用HDWiki，而这套系统存在重置密码存在一处逻辑漏洞，导致攻击者可以修改任意用户密码。 详细说明：  \ncontrol/user.php\tfunction dogetpass(){        ......\t\t}elseif(isset($this->post['verifystring'])){\t\t\t$uid=$this->post['uid'];\t\t\t$encryptstring=$this->post['verifystring'];\t\t\t$idstring=$_ENV['user']->get_idstring_by_uid($uid,$this->time);\t\t\tif($idstring==$encryptstring){                       //没考虑到提交为空与查询返回为空的情况，一个逻辑错误\t\t\t\t$newpass = $this->post['password'];\t\t\t\t$renewpass = $this->post['repassword'];\t\t\t\t$error=$_ENV['user']->checkpassword($newpass,$renewpass);\t\t\t\tif($error=='OK'){\t\t\t\t\t//eval($this->plugin[\"ucenter\"][\"hooks\"][\"getpass\"]);\t\t\t\t\tUC_OPEN && $msg=$_ENV['ucenter']->getpass($uid,$newpass);\t\t\t\t\t$_ENV['user']->update_field('password',md5($newpass),$uid);\t\t\t\t\t$_ENV['user']->update_getpass($uid);\t\t\t\t\t$this->message($this->view->lang['resetPassSucess'],'index.php?user-login',0);\t\t\t\t}else{\t\t\t\t  $this->message($error,'BACK',0);\t\t\t\t}\t\t\t}else{\t\t\t\t$this->message($this->view->lang['resetPassMessage'], WIKI_URL ,0);\t\t\t}\t\t}\tfunction  get_idstring_by_uid($uid,$time){  //取验证码\t\treturn $this->db->result_first(\"SELECT code FROM \".DB_TABLEPRE.\"activation WHERE uid=$uid AND available=1  AND type=1 AND time>($time-3*24*3600) ORDER BY time DESC\");\t}\n   漏洞证明：  http://help.u17.com/index.php?user-getpass-uid正常情况应该是这样，user-getpass-1-xxx，但是因为逻辑问题，可以绕过去。通过uid得到账号名 ：http://help.u17.com/index.php?list-popularity-1\n\n\n\n\n\n\n\n   修复方案：  control/user.php文件}elseif(isset($this->post['verifystring'])){$uid=$this->post['uid'];$encryptstring=$this->post['verifystring'];$idstring=$_ENV['user']->get_idstring_by_uid($uid,$this->time);/* 加入下面两行代码，判断一下空的情况 */if(empty($encryptstring) || empty($idstring)){$this->message($error,'BACK',0);}或者升级至官方最新版本：http://kaiyuan.hudong.com/   版权声明：转载请注明来源 zer0@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-09-23 17:14 厂商回复：  最新状态： 2013-09-23：18号放假，确认晚了，漏洞超过确认期限自动公开了。感谢洞主关注。已联系修复。 2013-09-23：感谢zer0的提交。有影响啊有影响。。。没忽略啊没忽略。  ", "replys": "漏洞评价：\n评论\n     2013-09-23 19:26 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  呵呵。又是这套啊。 WooYun: 盛大旗下有妖气漫画网任意用户密码修改 我之前发的有妖气主站的任意密码修改。也直接忽略了。我问原因，也告诉我说是放假没看到。盛大福利真好。天天放假。    \n     2013-09-23 20:52 |    \t\tsoftbug \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:10        | 为人类设计最好的软件，解放人的双手,一起...)\t\t \n  是的，你这个事情属于小事情，你修改密码，别人就把密码改回去。 又不影响别人总体收入。    \n     2013-09-23 20:55 |    \t\t艾特绅 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 愿意为网络安全做出我的贡献)\t\t \n  有影响啊有影响。。。没忽略啊没忽略。    \n     2013-09-25 17:24 |    \t\tzer0 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:5        | no~)\t\t \n  啊    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}