{"id": 15645, "wybug_id": "wooyun-2015-0118168", "wybug_title": "万达电影电影票设计缺陷导致可免费赠送给好友兑换券", "wybug_corp": "大连万达集团股份有限公司", "wybug_author": "Mr.leo", "wybug_date": "2015-06-04 11:35", "wybug_open_date": "2015-07-19 13:58", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-19：\t细节向公众公开  简要描述： 万达电影电影票设计缺陷导致可免费赠送给好友兑换券 详细说明：   WooYun: 万达电影电影票设计缺陷可抢他人优惠卷  前人经验看来下另外一个站点，wwwdemo.wandafilm.com 此站从域名来看是演示系统，实则与生产系统一致同步。问题出现在我的优惠，将已经存在的1张兑换券赠送给好友，该接口没有对兑换码生成的次数进行限制，导致可以批量免费赠送兑换券给好友（需要是万达注册用户）\n\n\nPOST http://wwwdemo.wandafilm.com//user/myCoupons.do?m=giveCoupons HTTP/1.1Host: wwwdemo.wandafilm.comProxy-Connection: keep-aliveContent-Length: 70Accept: application/json, text/javascript, */*; q=0.01Origin: http://wwwdemo.wandafilm.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://wwwdemo.wandafilm.com/user/myCoupons.do?m=initAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: __utma=81395784.xxxxxxxx.1428550560.2; __utmz=81395784.1428050786.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); JSESSIONID=E7A1FAxxxxxx8B1AB94BF76; jsessionid|JSESSIONID=f34038b99ba860a02472d8fba4c58d22; Hm_lvt_xxxxxxx=1433383826Connection: closecouponsNo=759073521154xxxxxx&mobileNo=152xxxxxxx&couponsType=coupons\n以上接口只要指定爆破的兑换码和手机号码即可\n\n通过http返回值和字段大小判断是否赠送成功\n\n免费赠送成功\n\n   漏洞证明：  已经证明   修复方案：  1、与主站系统隔离2、限制获取兑换码的次数   版权声明：转载请注明来源 Mr.leo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-06-04 13:56 厂商回复： 感谢同学的关注与贡献！测试系统缺陷，马上通知业务整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-19 14:25 |    \t\tMr.R \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:14        | 求大神带我飞 qq2584110147)\t\t \n  送我一打电影票吧。    \n     2015-07-19 14:26 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  难道最后可以变出无数张电影票吗？应该是兑换码有很多，但是最终只能有一个可以真实的兑换电影票并取票吧..    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}