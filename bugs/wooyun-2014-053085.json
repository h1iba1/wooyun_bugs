{"id": 3839, "wybug_id": "wooyun-2014-053085", "wybug_title": "siteserver3.6.4非常好用的文件上传", "wybug_corp": "百容千域软件技术开发有限责任公司", "wybug_author": "Vty", "wybug_date": "2014-03-08 10:06", "wybug_open_date": "2014-06-03 10:07", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-18：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-03：\t细节向公众公开  简要描述： siteserver3.6.4非常好用的文件上传 详细说明：  siteserver的系统更新功能，可以上传任意zip文件，并且会自动解压，即可获得webshell，相当高危。2012.moban.siteserver.cn/siteserver/platform/modal_hotfixUpload.aspx！需要抓访问返回包，如下：\n\n根据上图，修改Http状态码成200，Http头部 location字段去掉，并删除底部被我标黄的js代码。！！接着我们继续，会出现更新系统界面，但是没有提交按钮，牛逼的dir技术就出现了，不知道开发商是不是为了方便，只是在样式里将提交按钮隐藏了，开始上我们的神器，将其修改出来，然后开始下一步操作：\n\n！！！然后我们准备好的压缩一句话妥妥的放到桌面，方便上传，发包过程中注意修改包，跟第一步一样。当发送到http://2012.moban.siteserver.cn/siteserver/platform/modal_progressBar.aspx?isDownload=True&hotfix=True这个连接的时候，我们还需要将返回包修改，修改方法参见第一步！部分如下：\n\n修改后的包：\n\n！！！！修改完成后，一顿发送，一顿的刁啊刁啊刁！\n\n！！！！！最终，很刁的一幕发生了！\n\n！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！                         然后跟狗血的一幕出现了，详情如下：\n\n反正就是各种马场，厂商你的安全都去哪儿了%%   漏洞证明：  这个是别人留得，怕怕\n\n   修复方案：  攻城尸   版权声明：转载请注明来源 Vty@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-06-03 10:07 厂商回复：  漏洞Rank：20  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-08 10:17 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  前台？    \n     2014-03-08 10:25 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  @wefgod 分不清他的前台后台，机油求交流！    \n     2014-03-08 10:54 |    \t\tHaswell \t\t\t( 普通白帽子  |\t\t\t        Rank:167 漏洞数:18        | HorizonSec @ RDFZ)\t\t \n  前台就火了，以前貌似有人发过后台拿shell的八种方法……“非常好用”系列……    \n     2014-03-08 11:36 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Vty 是否需要登录？是否可以注册到这个登录的账户？后台的账号一般是不允许直接注册的    \n     2014-03-08 11:52 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  @wefgod 不需要啊，任意！    \n     2014-03-08 12:05 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  @wefgod @Vty 一看就不好用 否则会遭雷劈的    \n     2014-03-08 12:16 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  @在路上 你怎么那么刁，一句话都上去了那么好用的，那么刁的，那么高大上的任意传！    \n     2014-03-08 13:44 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Vty 不用登录就可以传的自然是好东西    \n     2014-03-08 14:17 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  @wefgod 嘿嘿！    \n     2014-03-08 18:28 |    \t\t忆苦思甜 \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:25        )\t\t \n  丢出来北。。    \n     2014-06-03 10:34 |    \t\tsecgov \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 安全审计，漏洞挖掘,WAF. 揭露漏洞有风险，...)\t\t \n  厂商啊,这个你也可以忽略啊 ,大家都惊呆了,不过见过很多站,首页都被篡改了也忽略    \n     2014-06-03 10:59 |    \t\tterrying \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:15        | 雅蠛蝶)\t\t \n  对这厂商给跪了    \n     2014-06-03 11:38 |    \t\tsecgov \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 安全审计，漏洞挖掘,WAF. 揭露漏洞有风险，...)\t\t \n  是要灭亡的节奏啊,这个和一个真实的事情很接近:一些客人在某酒店吃饭,吃了一半,突然发现盘子里有只安全套,然后喊服务员,服务员一下子吞下去了,说是一种佐料,可以吃的.就没有下文了,客人无语.  很多时候是逃避和毁灭事件证据的一种方式.    \n     2014-08-02 09:54 |    \t\tsf0l \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 2'xx00)\t\t \n  碉堡了！    \n     2014-09-11 01:12 |    \t\tGuoKer（ZhuLiu） \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:21        | 在校学生党的路过   霸气侧漏)\t\t \n  @Vty我上传zip的包 一直提示这个任务完成: 0%    \n     2014-09-11 21:46 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  @GuoKer（ZhuLiu） 多试几次，要清理好几次js    \n     2014-09-11 23:10 |    \t\tGuoKer（ZhuLiu） \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:21        | 在校学生党的路过   霸气侧漏)\t\t \n  @Vty 我清楚了好几次 基友有时间吗 说下你方式 麻烦你给帮忙看看    \n     2014-09-12 13:20 |    \t\t0749orz \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:4        | 厌了，烦了~~~)\t\t \n  0.0要火了，留名    \n     2014-09-27 18:18 |    \t\tGuoKer（ZhuLiu） \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:21        | 在校学生党的路过   霸气侧漏)\t\t \n  @Vty 基友 我是这用清楚 你看看任务完成: 0%进度：任务初始化...一直这样    \n     2014-11-24 07:11 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  乌云就是我晕的意思 我刚部署个这东西    \n     2014-11-24 08:25 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  @GuoKer（ZhuLiu） 遇到过，换个浏览器试试。    \n     2014-11-24 16:16 |    \t\tGuoKer（ZhuLiu） \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:21        | 在校学生党的路过   霸气侧漏)\t\t \n  @ki11y0u 我换了浏览器还是那样    \n     2014-11-24 19:35 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  @GuoKer（ZhuLiu） 换浏览器，清理缓存，测试的时候遇到过，%0就不动了，实在不行换台电脑，这个上传可用。    \n     2014-11-25 09:37 |    \t\tGuoKer（ZhuLiu） \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:21        | 在校学生党的路过   霸气侧漏)\t\t \n  @ki11y0u 谢谢了 我在看看吧    \n     2015-05-14 17:20 |    \t\t糖剩七颗 \t\t\t( 普通白帽子  |\t\t\t        Rank:430 漏洞数:61        | 天涯何处无屌丝)\t\t \n  使用火狐浏览器可以吗？    \n     2015-05-26 21:22 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  只看标题 我就贵了我的神呀，我对这厂商极其信任 这个态度让客户伤心    \n     2015-06-19 19:24 |    \t\t魂淡、 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 么么哒)\t\t \n  最新版本其实已经修正。只是厂商接受漏洞但不愿承认    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}