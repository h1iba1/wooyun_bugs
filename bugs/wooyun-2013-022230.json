{"id": 12454, "wybug_id": "wooyun-2013-022230", "wybug_title": "pcpop.com 某分站源码泄漏，后台弱口令", "wybug_corp": "IT168.com", "wybug_author": "工作专用", "wybug_date": "2013-04-21 10:46", "wybug_open_date": "2013-06-05 10:47", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "后台被猜解", "弱口令", "源码泄漏", "服务配置不当", "渗透测试思路", "运维管理不当", "配置错误", "文件泄露", "内部敏感信息泄露", "内部系统对外"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-05：\t细节向公众公开  简要描述： pcpop.com 某分站源码泄漏，后台弱口令 详细说明：  \n\nSVN 没做权限hezi.pcpop.com/.svn/entrieswangyingxinhttp://svn.it168.com/mysns/trunk/code/uc\ndefine('UC_DBHOST', '10.168.0.37'); // UCenter 数据库主机define('UC_DBUSER', 'pcpopsns'); // UCenter 数据库用户名define('UC_DBPW', '951623'); // UCenter 数据库密码define('UC_DBNAME', 'pop_uc'); // UCenter 数据库名称define('UC_CONNECT', 'mysql');define('UC_DBHOST', '192.168.1.72:3307');define('UC_DBUSER', 'yuhui');define('UC_DBPW', 'it168!@#');define('UC_DBNAME', 'pop_uc');define('UC_DBCHARSET', 'utf8');define('UC_DBTABLEPRE', '`pop_uc`.uc_');define('UC_DBCONNECT', '0');define('UC_KEY', '67ed00lqYBYbR3ICfMiLPWaKhxzpdJLau5uEaa4');define('UC_API', 'http://ucsso.pcpop.com');define('UC_CHARSET', 'utf-8');define('UC_IP', '');define('UC_APPID', '28');define('UC_PPP', '20');*///同步登录 Cookie 设置define('UC_CONNECT', 'mysql');define('UC_DBHOST', '192.168.0.40');define('UC_DBUSER', 'pcpopsns');define('UC_DBPW', '951623');define('UC_DBNAME', 'pop_uc');define('UC_DBCHARSET', 'utf8');define('UC_DBTABLEPRE', '`pop_uc`.uc_');define('UC_DBCONNECT', '0');define('UC_KEY', 'N5e5Nb58Fez3F2g7Kdu2meF7E4a2860a36S7N9T0F661k612p4NaMbz0j6qdd9j8');define('UC_API', 'http://uc.pcpop.com');define('UC_CHARSET', 'utf-8');define('UC_IP', '');define('UC_APPID', '27');define('UC_PPP', '20');$cookiedomain = ''; \t\t\t// cookie 作用域$cookiepath = '/';\t\t\t// cookie 作用路径// ----------------------------  盛拓用户中心  ----------------------------- //$config['suc']['root'] = 'http://uc.pcpop.com';     //自己的位置  根位置  发送激活邮件时用到,个别跳转时也用到$config['suc']['token'] = 'http://smsso.pcpop.com/token.ashx';$config['suc']['smsso'] = 'http://smsso.pcpop.com/login.ashx';$config['suc']['login'] = 'http://smsso.pcpop.com/login.ashx';$config['suc']['cookie'] = 'http://smsso.pcpop.com/cookie.ashx';$config['suc']['siteid'] = 3; //站点ID   1汽车之家 2车168 3泡泡网 4 IT168  5 微博$config['suc']['charset'] = 'UTF-8';define('UC_DBHOST', '129.0.0.245');define('UC_DBUSER', 'pcpopsns');define('UC_DBPW', '951623');define('UC_DBNAME', 'pop_uc');define('UC_DBCHARSET', 'utf8');define('UC_DBTABLEPRE', 'uc_');define('UC_COOKIEPATH', '/');define('UC_COOKIEDOMAIN', '.pcpop.com');define('UC_DBCONNECT', 0);define('UC_CHARSET', 'utf-8');define('UC_FOUNDERPW', 'db47a395d912c3ec8cbe36b05fa17dbf');define('UC_FOUNDERSALT', '988590');define('UC_KEY', 'aAeB5r1o2i510rdB1Qf29Add4u3o082W4eac7NdV8o4K9c9E32d4eI0Qbc506S6L');define('UC_SITEID', 'aheg5U102J5i0Bdy1ufY9Gdv4B3l0l2D4GaX7hdk894w9l9L3tdfes0KbE586o6Z');define('UC_MYKEY', 'ahen5A1w2Q5o0lds1rfi9idw4O310c2s4Kaz73dn8A4O9k9R3SdTeE0qb15J6j69');define('UC_DEBUG', false);\n假设MYSQL没做IP限制 理论上 随便拿到个内网站 数据库可以被拖分站又很容易拿。http://edit.pcpop.com/admin/Default.htmluser1123456 通过上个漏洞 SVN 源码泄漏里面的 数据库 得知常用ID。 破解密码   漏洞证明：  \n\nSVN 没做权限hezi.pcpop.com/.svn/entrieswangyingxinhttp://svn.it168.com/mysns/trunk/code/uc\n\n   修复方案：  \n\nSVN 没做权限hezi.pcpop.com/.svn/entrieswangyingxinhttp://svn.it168.com/mysns/trunk/code/uc   版权声明：转载请注明来源 工作专用@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-04-22 15:05 厂商回复： 多谢楼主的工作。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}