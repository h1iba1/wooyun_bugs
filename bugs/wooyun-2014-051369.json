{"id": 5069, "wybug_id": "wooyun-2014-051369", "wybug_title": "百度主站某处跳转存在xss+url任意跳转", "wybug_corp": "百度", "wybug_author": "小森森", "wybug_date": "2014-02-19 10:59", "wybug_open_date": "2014-04-05 11:01", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-05：\t细节向公众公开  简要描述： 跳转无过滤，存在xss，且能进行url任意跳转，以实现在QQ中传播危险网站却显示安全图标。 详细说明：  http://www.baidu.com/ulink?url=javascript:alert(1);此处url无任何过滤，虽然HTTP响应头中有X-XSS-Protection: 1;mode=block，但是由于js脚本中用的是window.location.replace()，所以并不会被浏览器拦截。虽然现在百度对关键的cookie：BDUSS用的是http-only，以至于用户账户不会被劫持，但用这个XSS完全可以实现任意修改用户新百度首页的内容，劫持首页链接的效果。以及利用这个进行url跳转，可以躲过QQ的检查，直接对任意站点显示安全。   漏洞证明：  \n\n<br>利用这个漏洞完全能够做到修改用户首页，但（编码）步骤比较繁琐，不再演示……<br>\n\n<br>注：因为QQ也会检查url中是否包含其他的网址，所以用javascript才能躲避检查。<br>   修复方案：  这个链接是我在新百度首页点击自定义链接时发现的，推测百度可能是在首页劫持了外站链接，用这个网页进行安全检测的，但是这样无token会导致xss+任意url跳转。建议在这个页面用token进行检查。   版权声明：转载请注明来源 小森森@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2014-02-19 13:28 厂商回复： 感谢提交，我们会尽快联系产品线进行修复。--“百度，因你更安全” 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-02-19 12:38 |    \t\t小森森 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 不中二 枉少年)\t\t \n  @百度 忘了说了……还可以利用这个来构造一个看起来跟真的一模一样的登录框呢～(`・ω・´)是不是要考虑给多一点rank呢？    \n     2014-02-19 12:41 |    \t\tSocial \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 我有舒肤佳，谁要看。)\t\t \n  小白路过～～    \n     2014-02-19 13:01 |    \t\t小森森 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 不中二 枉少年)\t\t \n  啊！！原来漏洞证明那里不是完全的html编辑器……<br>都被html编码了……    \n     2014-02-19 13:50 |    \t\t乌云 \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:14        | a)\t\t \n  希望打开www.baidu.com弹出alert(1)    \n     2014-02-21 19:30 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  马克    \n     2014-04-05 18:18 |    \t\tdaige13 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        )\t\t \n  这个洞在BSRC提交过很久了....一直不修复.    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}