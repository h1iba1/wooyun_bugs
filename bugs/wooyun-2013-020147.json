{"id": 13905, "wybug_id": "wooyun-2013-020147", "wybug_title": "如果你手机丢了，你觉得会损失了什么？", "wybug_corp": "腾讯", "wybug_author": "whitemonty", "wybug_date": "2013-03-16 14:38", "wybug_open_date": "2013-03-19 13:07", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "钓鱼欺诈", "用户敏感信息泄漏", "手机安全", "安全策略失效", "安全策略绕过", "支付行业敏感", "安全策略不同步", "手机软件安全", "支付安全", "用户密码泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 如果你手机丢了，你觉得会损失了什么？可能你觉得手机本身的价值没什么，通讯录才是重要的在偶年幼无知的时候……觉得手机丢了，QQ也会丢了但是，还是在偶年幼无知的时候，发现……手机丢了，也许会欲哭无泪！想像一下，如果你现在手机丢了，你会损失什么？欢迎基友们，各种诡异答案 详细说明：  现在网上各种账号一般都有跟手机绑定而且手机的权限很高很高……高不胜寒看到这里，也许你们已经知道了是怎么回事了也许你们评估过这个问题但是我觉得……非常有必要对问题进行整改！因为每天都会有人丢手机，就像每天的出生率和死亡率一样，一直不为0而手机丢了之后，有多少人会马上把手机号码挂失，又有多少人会马上对自己的网络账号与手机相关的账号进行处理？好吧，就算你有这个意识，但当你找到电脑进行各种处理时你会比有备而来的小偷速度快，准，狠？？？select money from your 财付通 where 手机丢了 = ture and 手机上有QQ号码 = ture and qq，财付通与手机绑定 = ture 想像一下，如果你现在手机丢了，你会损失什么？（1）经过测试，QQ绑定手机后，只要发一条短信就能直接修改密码，没有其他任何二次认证。这比手机明文存储密码还恐怖！因为如果只是手机明文存储密码而已，那么手机丢了，把密码修改了，可能没事了但是QQ绑定了手机，手机丢了，你的QQ除了可能被别人登录之外，你日久生情的QQ还可能不是属于你的了因为你的QQ绑定的手机号码可能会被更换了（2）如果你的财付通如果也用手机绑定了……反正腾讯会建议绑定那么，通过忘记密码的修改密码步骤，有手机验证码，就能修改财付通密码(默认和QQ密码一样)和支付密码此时如果你的财付通的有余额的话，那么它也不属于你的了（3）如果你的财付通上还有绑定着各种银行卡的快捷支付，腾讯各种优惠活动鼓励用户绑定快捷支付，绑定的卡越多，优惠越多（一般是送现金券），然后也会死得越壮烈……如果手机丢了！因为登录密码有了，支付密码有了，快捷支付的短信验证也妥妥的！（PS：支付宝也有类似问题，如果支付宝账号采用手机号码的话，财付通也可以用手机注册……其实好多平台都存在这个问题）   漏洞证明：  （1）忘记密码--忘记密保问题--通过手机找回密码\n\n（2）一条短信搞定QQ密码……足足花了偶十分钱！\n\n（3）财付通登录密码和支付密码也妥妥的\n\n开始支付吧，骚年们！手机在手，天下我有！在这个屌丝逆袭的时代，果断拿起旁边高富帅的手机进入支付热线吧！   修复方案：  认证时，不应该把手机认证作为一个万能的key建议采用多重认证，方法繁多：如手机认证的同时也需要输入密保问题，或者其他申诉的条件也可采用双手机号码验证，主号码有权发出修改密码指令，但需要副号码（如父母手机）确认，但副号码只有确认权限，无发出修改密码指令的权限。降低安全风险，往往要以牺牲方便快捷的操作为代价！也许你们评估过这个问题了但是我觉得……非常有必要对问题进行整改！因为如果手机落入恶意使用者手里，漏洞利用难度低，危害高。（相比于通过利用通讯录里面的联系人来进行诈骗）好了！到了吃早餐的时间了……(非漏洞修复必须步骤，是偶要去吃早餐罢了)码了这么多字，没功劳也有苦劳吧，没苦劳也有“咸酸劳”了吧！   版权声明：转载请注明来源 whitemonty@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-03-19 13:07 厂商回复： 非常感谢您的报告。这个问题我们经过评估，暂未发现可以对用户或者业务产生影响，故不作处理。如果您对于该结论有任何的疑问，欢迎反馈指正，我们会有专人跟进处理。 漏洞Rank：5  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-16 14:45 |    \t\tSeraph \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:6        | 没有死，不等于活着！)\t\t \n   不明真相    \n     2013-03-16 14:52 |    \t\trqndx \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:3        | 种子发我邮箱：01010101010101010101010101...)\t\t \n  艳照~~~    \n     2013-03-16 14:57 |    \t\t专业查水表 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:5        | \"><script>alert(/我是\"J.L\"的大号/);</scr...)\t\t \n  妹子也会丢了~~    \n     2013-03-16 14:58 |    \t\t屌丝一枚 \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | 屌丝一个，蛋疼的。)\t\t \n  目测是通过手机搞QQ密码    \n     2013-03-16 15:33 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  妹纸和艳照都丢了     \n     2013-03-16 16:04 |    \t\t汴京少爷 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 菜鸟)\t\t \n  坐等真相    \n     2013-03-16 19:10 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  这么玄乎，不明觉厉。    \n     2013-03-16 19:50 |    \t\tfox \t\t\t( 普通白帽子  |\t\t\t        Rank:159 漏洞数:16        | fox)\t\t \n  支付宝银行卡什么的绑定了就惨了    \n     2013-03-16 22:12 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  不明真相    \n     2013-03-16 22:43 |    \t\tBlackeagle \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 向WooYun致敬)\t\t \n  既然厂商选择了tx 那就是腾讯有关的。。。光荣而巨大的任务留给楼下了~    \n     2013-03-16 22:45 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  损失了一个手机    \n     2013-03-16 23:18 |    \t\tShady \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:8        | Test)\t\t \n  @xsser 楼上正解    \n     2013-03-19 15:20 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  哈哈。支持下，确实这个也没什么办法，但是丢了···就自认晦气了    \n     2013-03-19 15:59 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  这。。。    \n     2013-03-19 16:45 |    \t\t少校 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 别开枪，自己人！)\t\t \n  我觉得这个有影响不大    \n     2013-03-19 18:07 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  其实我觉得 在用户体验和安全直接得做到权衡。但是风险产生的时候谁来承担？    \n     2013-03-19 18:27 |    \t\t路人甲 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:4        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @齐迹 好问题.从严格的角度说，这是用户自己的责任，你自己的手机没保护好。但是从现状来说，厂商也应该加强验证方式，不能手机的权限过高。    \n     2013-03-19 20:59 |    \t\twhitemonty \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:4        | Secur1ty just lik3 a girl. B0th of th3m ...)\t\t \n  @腾讯 个人觉得，手机丢了这是一种情况，另外，现在手机应用安全问题越来越突出，而且也开始出现手机短信被劫持的情况。如果安装了恶意软件的话，不仅再是被恶意扣费而已，而是财付通和支付宝等账号被直接恶意使用，手机被恶意扣费，最多就是把话费扣完，如果财付通和支付宝也受到影响，这个不该重视吗？！难道是真的得等大量用户反馈该问题后，才进行处理？    \n     2013-03-19 21:14 |    \t\twhitemonty \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:4        | Secur1ty just lik3 a girl. B0th of th3m ...)\t\t \n  另外如果出现用户手机上不小心安装了恶意软件或者手机不小心丢了…… 作为服务提供商，你们会怎么处理？完全用户自己负责？？@腾讯 @支付宝 请现身说法！    \n     2013-03-19 21:28 |    \t\tZedeX \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:3        | zx)\t\t \n  感谢楼主提供思路，跟之前用基站要附近妹子的有一比。理论上可以从基站黑起，劫持所有附近发送接收的短信。伪造数据，中间人攻击，思路很好。厂商角度业务上没问题即可，只需尽到提醒即可，出了问题也是你丢手机造成的，厂商无需赔付你账户资金。快捷支付一般都是小额支付，你想提10万都得累死，只能通过网银，网银是需要密码的。不过话说回来，楼主的思路是不错的，楼主只局限于QQ，其实可以通过微信发起对该手机好友手机的xss攻击。    \n     2013-03-20 00:05 |    \t\twhitemonty \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:4        | Secur1ty just lik3 a girl. B0th of th3m ...)\t\t \n  @ZedeX 偶是来抛砖引玉嘀…… 接触手机安全那方面还不多，只知道短信可能会被劫持，但是具体实现方面还不了解…… 另外，快捷支付虽然一般都是小额支付，偶看过一些关于黑产的文章，网银本身也有额度限制的，但是这个限制也是有绕过的方法，那些被钓鱼的网银账号，余额可被一次转走    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}