{"id": 19307, "wybug_id": "wooyun-2012-08966", "wybug_title": "TRS内容管理平台用户注册逻辑漏洞", "wybug_corp": "TRS", "wybug_author": "kobin97", "wybug_date": "2012-06-29 11:14", "wybug_open_date": "2012-07-04 11:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "设计缺陷", "整形注射", "字符型注射", "变量覆盖", "变量未初始化", "任意文件遍历下载", "内容管理平台"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-04：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 可能引起大量政府网站安全问题 详细说明：  首先site:gov.cn  inurl:WCMTRS 的内容管理系统是国内政府网站使用最多的系统之一\n\n如上面所说：外交部 http://wcm.fmprc.gov.cn/wcm/网址加上：wcm/console/auth/reg_newuser.jsphttp://localhost:9999/wcm/console/auth/reg_newuser.jsp注册，注意使用fireBUG修改表单，注意下图\n\n即将随意表单改成  STATUS 值为 30，或增加STATUS字段表单。然后提交注册\n\n虽然说是“请等待开通！”，但实际上已经开通了，因为 STATUS 字段让我们改成正常了。直接登陆\n\n虽然没什么权限，但后台存在大量注入等漏洞如：\n\n可以通过注入直接操作数据库了。http://localhost:9999/wcm/file/read_file.jsp?FileName=U020120628383491551127/../../../../../Tomcat/webapps/wcm/WEB-INF/classes/trsconfig/domain/config.xml&sDownName=xx直接下载数据库配置文件\n\n   漏洞证明：  上面说过了。   修复方案：  应该懂，先叫官方出补丁，再修吧！   版权声明：转载请注明来源 kobin97@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-07-04 11:14 厂商回复：  漏洞Rank：18  (WooYun评价) 最新状态： 2012-07-05：未在互联网实例中复现，不过CNVD工作流程中有失误的环节，首先应该及时根据图片确认，待本地确认后进行处置。致歉。  ", "replys": "漏洞评价：\n评论\n     2012-06-29 11:24 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  洞主刷屏去啊～～    \n     2012-06-29 11:41 |    \t\tkobin97  \t\t\t( 核心白帽子 |\t\t\t        Rank:1754 漏洞数:190        | 关注网络安全。。)\t\t \n  这得可以刷。。。。    \n     2012-06-29 11:51 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  希望在wooyun这里发TRS的不被和谐。观望中。。。    \n     2012-06-29 11:56 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @刺刺 为什么要和谐啊？    \n     2012-06-29 12:40 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  @xsser 可以在baidu搜索一下“trs漏洞”，水贴还有痕迹的。当年我在百度空间的有关trs的文章都被删了，登录都不行。他那么多的政府客户……领导也不高兴。    \n     2012-06-29 12:48 |    \t\tJannock  \t\t\t( 核心白帽子 |\t\t\t        Rank:2278 漏洞数:204        | 关注技术与网络安全（招人中，有兴趣请私信...)\t\t \n  @刺刺 http://hi.baidu.com/topsecnn/blog/item/0963358566b145b00cf4d21c.html    \n     2012-06-29 12:51 |    \t\tkobin97  \t\t\t( 核心白帽子 |\t\t\t        Rank:1754 漏洞数:190        | 关注网络安全。。)\t\t \n  @刺刺 http://www.cnvd.org.cn/sites/main/preview/ldgg_preview.htm?tid=34654    \n     2012-06-29 13:08 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  多谢指点！我个人记得上传的事情是在2010年7月期间：TRSWCM_5.2.1051_Fix02(安全更新)是在2010年7月27日TRSWCM_6.5.1091.SP1_Fix01(安全更新)正式发布是在2010年8月6日补丁都发布一年多了，2011年再传播，找漏的了。    \n     2012-07-04 11:27 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  怎么忽略了........    \n     2012-07-04 12:11 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  @kobin97 这个,有补丁的。其实您只要说明注册逻辑的问题就可以了，无须附赠一个文件下载，一个SQL注入。本来就没有回报，你还一拖二。太超值，还忽略，贼……    \n     2012-07-05 18:24 |    \t\tkobin97  \t\t\t( 核心白帽子 |\t\t\t        Rank:1754 漏洞数:190        | 关注网络安全。。)\t\t \n  无法重现？大家试试。    \n     2012-07-08 19:42 |    \t\tdarksn0w \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 无折腾,不生活！)\t\t \n  @xsser 我来告诉你为什么和谐吧，某兄弟在wooyun上发了天朝某军采购网站注入漏洞，3天内被多名有关部门的人约谈，想必剑心知道此事吧，多多少少有点怕了    \n     2012-07-08 21:50 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @darksn0w 他说的你信，为什么我说的你不信？    \n     2012-07-09 21:44 |    \t\tdarksn0w \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 无折腾,不生活！)\t\t \n  @xsser 额，凌乱了，好吧，我中立了，不过wooyun还是挺靠谱的，cnvd也挺靠谱。。。    \n     2012-07-10 11:52 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  @kobin97 今天测试了一下：个人觉得可能是使用的FF访问的问题（这个页面的某个js对FF的支持不太好吧），我个人使用FF（9.0）访问wcm/console/auth/reg_newuser.jsp这个页面，点击不了提交的“确定”；也有可能是有的WCM版本注册这里的程序被修改过，提交会报500错误；也有可能是CNVD的验证测试不够深入。这个其实可以直接对wcm/console/auth/reg_newuser_dowith.jsp POST提交，本人验证了互联网上的2个实例通过。    \n     2013-11-08 15:14 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  影响什么版本？没复现~    \n     2013-11-11 11:13 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  C,这是去年的洞，人家补丁早打完了。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}