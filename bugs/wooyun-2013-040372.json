{"id": 8761, "wybug_id": "wooyun-2013-040372", "wybug_title": "百度PCS存在随意调用API的缺陷", "wybug_corp": "百度", "wybug_author": "惜颜", "wybug_date": "2013-10-22 19:29", "wybug_open_date": "2013-10-23 11:44", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "认证设计不合理", "百度网盘", "百度网盘直链"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 通过使用PCS-API进行百度网盘直链的应用生成的链接，或是使用百度PCS提供下载的链接，均可随意调用PCS-API！ 详细说明：  百度PCS-API（以下简称BPA）1、BPA的调用需要通过OAuth2.0获取Authorization Code再获取Access Token来获取调用权限（Access Token具备调用所有BPA接口的权限，并且只需Access Token）那么，能做的事情太多了。。。2、大部分使用PCS的应用要么是直接用接口链接提供文件服务，要么是Location到BPA的调用接口提供服务3、两种使用方法均可使用火狐中的Live HTTP headers获取接口调用参数！   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n后面的就不实验了。。。用Access Token直接调用回收站接口，就可以删光光了。。。   修复方案：  1、提醒用户延时使用Open API失效接口，在用户开始下载后使Access Token失效并使用Refresh Token获取一个新的Access Token存到数据库中。2、修改接口，使其无法直接删除应用文件夹3、调用时加密文件名4、调用下载、删除、清空回收站接口前，服务端先和PCS端交换一下认证信息，再授权客户端调用5、好像都可以绕过去。。。= =！不想了，我的脑细胞啊！！！！   版权声明：转载请注明来源 惜颜@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-10-23 11:44 厂商回复： 感谢提交，此策略为pcs策略所允许，因为pcs使用规范中，明确了access_token使用的保密性：1. 开放平台不允许应用泄露access_token。2. 即使token丢失，也只会丢失该用户该应用目录下的数据，不会影响到其他用户，或该用户其他应用目录下数据。--“百度，因你更安全” 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-21 23:36 |    \t\t逗比 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:6        | 逗比的年代，诶油我艹)\t\t \n  洞主求此款直连工具,QQ邮箱:2691650444@qq.com    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}