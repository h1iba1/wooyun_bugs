{"id": 6336, "wybug_id": "wooyun-2013-041721", "wybug_title": "搜狗浏览器4.2.2.9903任意网站伪造＋自有协议下XSS*2", "wybug_corp": "搜狗", "wybug_author": "blast", "wybug_date": "2013-11-02 00:51", "wybug_open_date": "2014-01-31 00:52", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-07：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-12-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-31：\t细节向公众公开  简要描述： 搜狗浏览器4.2.2.9903未严格遵守同源准则，通过二次改变地址的方式可以完美的spoof（无加载提示等），测试仅对搜狗浏览器有效另外sb://协议下有两个需要用户手动操作的鸡肋xss，成功利用的话也只可影响到少量功能的使用 详细说明：  问题的原因：【1】通过修改其他窗口的地址为：javascript:location.href='xxx';的时候，相当于在其他窗口中执行了javascript:document.write('xxx');【2】搜狗浏览器未严格遵守同源准则，打开新窗口时使用的是about:blank，但是地址栏先行改变了地址的值，导致其他页面可以随意修改该窗口内容。 测试其他浏览器都是打开新窗口后立马把新窗口的源换成要打开的地址的。【3】综合【1】【2】，在窗口域仍为about:blank时强行修改其地址为javascript:location.href='xxx';，可以让其提前“加载完”，而且因为修改location.href为javascript:时浏览器都不会改变地址栏，所以spoof可以成功执行。－－－－－－－－－【4】 两个鸡肋xss，随便感受两下，感觉没啥用。原因：没过滤javascript:伪协议\n<script>var y=\"javascript:location.assign(\\\"javascript:location.href='<h1>xx</h1><title>anx</title>'\\\")\";location.href=\"sb://tzip/Error404/error_wk.html?ecode=-118&magic=199206&url=javascript:alert(5)//\\\"><h1>\";location.href=\"sb://tzip/Error404/error_ie.html?ecode=-11844&magic=1339393993&url=javascript:document.write('<h1>hello</h1>')\";//XSSa=window.open(\"http://www.baidu.com\",\"a\");a.location.href=y;//SPOOF</script>\n   漏洞证明：  \n\n\n\n   修复方案：  修复上面的问题   版权声明：转载请注明来源 blast@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-11-04 11:31 厂商回复： 感谢提供 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-02 01:00 |    \t\tMoogong \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:8        | 伪法医)\t\t \n  可以试试csrf构造一下自动打开 协议post一下sb://    \n     2013-11-02 01:02 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  这么晚还在审核？    \n     2013-11-02 13:39 |    \t\tblast \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:57        | 五仁委员会)\t\t \n  @Moogong 恩那 昨晚试了试 搜狗把主要的功能都转移到其他se: sbxx:啥的协议下了 sb://协议下貌似只有我最喜爱的主页啥啥的几个小功能 所以觉得有点鸡肋..    \n     2013-11-04 11:49 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @blast 任意网站xss危害已经很大了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}