{"id": 49134, "wybug_id": "wooyun-2014-085843", "wybug_title": "聚美优品任意修改用户密码(非爆破)", "wybug_corp": "聚美优品", "wybug_author": "Rocky.Tian", "wybug_date": "2014-12-04 14:21", "wybug_open_date": "2014-12-04 16:17", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-04：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 可任意更改用户密码 详细说明：     漏洞证明：  通过自己账号忘记密码发送邮箱修改密码地址\n\n\n\n进入邮箱 不要打开\n\n在同浏览器内打开网站还是忘记密码输入要修改的账号\n\n这一步后停住\n\n在同一浏览器中打开发到我们邮箱的链接 \n\n一定同一浏览器输入要修改的密码就OK了\n\n成功进入\n\n   修复方案：     版权声明：转载请注明来源 Rocky.Tian@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-12-04 14:28 厂商回复： 感谢您对聚美安全的关注 最新状态： 2014-12-04：已修复。这种漏洞应该给 rank 20的，属于高危，怎么改？  ", "replys": "漏洞评价：\n评论\n     2014-12-04 14:22 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  牛啊这思路    \n     2014-12-04 14:23 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  我喜欢这种思路    \n     2014-12-04 14:25 |    \t\t鶆鶈 \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:30        )\t\t \n  这思路真是大赞啊。。    \n     2014-12-04 14:25 |    \t\tRocky.Tian \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:2        | 学不止境)\t\t \n  找一个人 只有手机号 发现她在聚美优品有Cookie记录，也帮顶了QQ，所以只有这样拿下来，进去看看，其实我是要她QQ和地址！    \n     2014-12-04 14:26 |    \t\t0x_Jin \t\t\t( 普通白帽子  |\t\t\t        Rank:319 漏洞数:37        | 微博：http://weibo.com/J1n9999)\t\t \n  我喜欢这种思路    \n     2014-12-04 14:28 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  我这败家媳妇买了这么多东西    \n     2014-12-04 14:29 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  一大堆败家媳妇回家要跪遥控器    \n     2014-12-04 14:29 |    \t\tRocky.Tian \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:2        | 学不止境)\t\t \n  @浩天 这是我媳妇。。。。    \n     2014-12-04 14:30 |    \t\tRocky.Tian \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:2        | 学不止境)\t\t \n  @疯狗 我滴媳妇    \n     2014-12-04 14:32 |    \t\tD_in \t\t\t( 普通白帽子  |\t\t\t        Rank:413 漏洞数:62        | 到我嘴里来)\t\t \n  mark    \n     2014-12-04 14:54 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:61        | 工作需要，暂别一段时间)\t\t \n  牛啊这思路（我看不到，但请允许我装个逼）    \n     2014-12-04 15:15 |    \t\t′雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n   牛逼， 这思路，  又学习了，    \n     2014-12-04 15:20 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  坐等思路    \n     2014-12-04 15:20 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  @聚美优品 修复就公开了吧    \n     2014-12-04 15:27 |    \t\tif、so  \t\t\t( 核心白帽子 |\t\t\t        Rank:1008 漏洞数:91        | 梦想还是要有的，万一实现了呢？)\t\t \n  感觉系统邮箱被搞了    \n     2014-12-04 15:29 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  这是什么思路，求细节。    \n     2014-12-04 15:37 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @if、so 来个猜对有奖活动吧    \n     2014-12-04 15:47 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  擦，咋感觉楼上都能看到详情，这不科学！    \n     2014-12-04 15:57 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  这思路，太牛逼了，怎么想到的    \n     2014-12-04 15:58 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  已复现，不知道思路对了没。    \n     2014-12-04 15:59 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  又闪电    \n     2014-12-04 16:15 |    \t\t聚美优品(乌云厂商)\t\t \n  确实神思路，醉了    \n     2014-12-04 16:27 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  牛逼，啥原理呢? session紊乱?    \n     2014-12-04 16:33 |    \t\tD_in \t\t\t( 普通白帽子  |\t\t\t        Rank:413 漏洞数:62        | 到我嘴里来)\t\t \n  能看到了，这思路，真是牛，什么原因    \n     2014-12-04 16:34 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  醉了 好淫荡呀    \n     2014-12-04 16:35 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  向要修改的的邮箱发一个修改密码的请求，那么这个账号就被标记为要修改密码的状态，这个是关键    \n     2014-12-04 16:37 |    \t\tbupter \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 曾经爱过！！)\t\t \n  不讲思路只讲过程，感觉有点徐悲鸿画马的味道。    \n     2014-12-04 16:37 |    \t\tBlackeagle \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 向WooYun致敬)\t\t \n  奇淫妓巧 这思路 醉了    \n     2014-12-04 16:42 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @浩天 其实就是越权吧，eid或者sid没有校验用户    \n     2014-12-04 16:43 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  向要修改的的邮箱发一个修改密码的请求，那么这个账号就被标记为要修改密码的状态，这个是关键    \n     2014-12-04 16:43 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  好神奇的    \n     2014-12-04 16:44 |    \t\t想要减肥的胖纸 \t\t\t( 普通白帽子  |\t\t\t        Rank:250 漏洞数:42        )\t\t \n  应该是cookie的问题···被设置了一个类似toke的东西 略懂    \n     2014-12-04 16:47 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @想要减肥的胖纸 必须为同一浏览器，目测可以共用这一token    \n     2014-12-04 16:50 |    \t\tNebula \t\t\t( 普通白帽子  |\t\t\t        Rank:215 漏洞数:22        | xxxxx)\t\t \n  应该是ssesion或cookie的覆盖(它被用作修改指定用户的密码,可能就是用户名),而服务器端只是简单判断了一下修改链接的key是否存在就可以修改密码了,而没有判断key是否对应指定用户名?    \n     2014-12-04 16:51 |    \t\tcnrstar \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:23        | Be my personal best!)\t\t \n  @浩天 @Rocky.Tian 谁的媳妇cyj_829pconline13088929286cyj_829@163.com    \n     2014-12-04 16:51 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  类似于验证码复用。。。。。    \n     2014-12-04 16:56 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  应该是通过session验证，两个用户使用的是同一个session提交的，作者说要用同一个浏览器。    \n     2014-12-04 17:02 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  应该34 楼说的那样吧，也是神逻辑    \n     2014-12-04 17:10 |    \t\txinghe \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:4        )\t\t \n  思路不错    \n     2014-12-04 17:26 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  搞了半天，原来厂商这充值密码的链接里面就没有帐号相关的加密验证，厂商竟然还不知道怎么修。。。    \n     2014-12-04 17:35 |    \t\t小鲜肉 \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:6        | 努力学习，不想在浪费时间了。)\t\t \n  @xsser  @浩天  没怎么看明白，上面是说可以修改任意用户的密码，他这思路第一步必须进入找回密码的邮箱，虽然不要点邮箱里面的修改密码的连接，但是邮箱帐号和密码不是本人的话，几乎没有机会获取到，不登录找回密码的邮箱，也会是这种结果？    \n     2014-12-04 17:39 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  @小鲜肉 先向自己邮箱发一封找回密码，再向媳妇的邮箱发一封，当前浏览器记录媳妇的账户信息，然后去自己的邮箱点击找回密码链接，读取了存在浏览器媳妇的账户信息，成功修改了密码。以前也遇到过类似的案例    \n     2014-12-04 17:46 |    \t\t小鲜肉 \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:6        | 努力学习，不想在浪费时间了。)\t\t \n  @浩天 刚才没有注意看，两个邮箱是不同的，你一解释就明白了，谢了雷锋。    \n     2014-12-04 18:14 |    \t\t火焰真菌 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:11        | 火焰真菌)\t\t \n  牛逼    \n     2014-12-04 18:26 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  神思路。    \n     2014-12-04 18:41 |    \t\t带我玩 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 带我玩)\t\t \n  思路好银荡的说    \n     2014-12-04 19:49 |    \t\tRocky.Tian \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:2        | 学不止境)\t\t \n  我当时没有账号  所以提交的漏洞信息 现在有账号了   怎么样转到我的名下？我拿着俺对象的试验的我有一个人的手机号  想找到他的QQ 然后发现法的cookie 在聚美优品，所以想到了如此损招！太恐怖了      \n     2014-12-04 20:03 |    \t\t小飞侠 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 好好学习，天天向上)\t\t \n  给思路赞一个~    \n     2014-12-04 20:39 |    \t\tgoubuli \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:61        )\t\t \n  厂商修复好神速~     \n     2014-12-04 20:55 |    \t\tpain \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:5        )\t\t \n  虽不明，但觉厉    \n     2014-12-04 21:54 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  牛逼啊。    \n     2014-12-04 22:09 |    \t\tpain \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:5        )\t\t \n  @Rocky.Tian 找乌云小秘书说一下就能转到你名下了    \n     2014-12-04 22:32 |    \t\t银冥币 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:21        | \"/upload/avatar/avatar_251_b.jpg\" />)\t\t \n  共用session和验证不严格导致,思路叼    \n     2014-12-04 22:48 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  应该是记录了修改提交的账号，可能是session问题    \n     2014-12-04 23:35 |    \t\twkc_2014 \t\t\t( 普通白帽子  |\t\t\t        Rank:164 漏洞数:45        | 2014-)\t\t \n  流弊    \n     2014-12-05 10:01 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @聚美优品 后台是什么逻辑？让我等涨涨见识呗，反正已经修复了    \n     2014-12-05 11:42 |    \t\tredsin \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:6        )\t\t \n  麻痹 这怎么想到的？    \n     2014-12-05 14:51 |    \t\t乌云 \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:14        | a)\t\t \n  我尼码。。。 这个竟然是利用session来对应账号的修改。。。醉了。。看样“session不可改” 这句话也得分情况了。。。    \n     2014-12-05 15:05 |    \t\tWoodee \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 乌云路人甲，打脸pa pa pa)\t\t \n  2014-12-04：已修复。这种漏洞应该给 rank 20的，属于高危，怎么改？    \n     2014-12-06 19:12 |    \t\t斯杰 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:5        | By：S丶jer)\t\t \n  这是要火的节奏啊    \n     2014-12-06 20:13 |    \t\t小呆呆 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:7        | 每次有人骂我猪我都说我偶像也是猪)\t\t \n  这都行！    \n     2014-12-08 11:57 |    \t\t大大怪 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | PHP 爱好者)\t\t \n  这种rank 最多打3分。从 url 中也能看出来 sid 就是 session_id 。 url 中还有个 | 而这种参数一般不会用程序去取，太麻烦还要分隔。最后面是 back 地址，很好分析。厂家这么相信session 这水平可想而知。     \n     2014-12-08 18:26 |    \t\t小涛 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 跟随大大们的脚本来的)\t\t \n    都是这么厉害啊   唉 我这种小菜 只能看 着你们在自由都翱翔     \n     2014-12-12 14:20 |    \t\tMr.Wang \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 黑与白的对立中，寻求突破。)\t\t \n  思路叼到爆点。    \n     2014-12-12 15:55 |    \t\tmilan \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:32        | 妈妈说：搬不完砖就别回家。)\t\t \n  mark    \n     2014-12-14 12:23 |    \t\t魂淡、 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 么么哒)\t\t \n  @浩天 @疯狗 @xsser 2014-12-04：已修复。这种漏洞应该给 rank 20的，属于高危，怎么改？    \n     2014-12-23 15:26 |    \t\txFrank \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 专注Android系统安全)\t\t \n  不明觉厉    \n     2014-12-24 16:48 |    \t\tMixes \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:19        | :))\t\t \n  @cnrstar 姓名: 陈奕君手机: 13008492905家庭电话: 0917-8668102性别: 女生日: 1985年08月29日地址: 西安翻译学院户口所在地: 陕西邮编: 710105是我媳妇    \n     2015-01-05 13:35 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  好想法    \n     2015-01-05 18:25 |    \t\tcooFool \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 终于通过了。)\t\t \n  极度猥琐！！    \n     2015-01-15 20:54 |    \t\t李宇航的小柠檬 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 小柠檬甜不甜)\t\t \n  @浩天 聚美某汪已被开除    \n     2015-02-04 10:31 |    \t\t深夜大冒险 \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:5        )\t\t \n  吓得我不敢败家了    \n     2015-05-16 13:54 |    \t\tLo0ston \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 热爱渗透)\t\t \n  貌似是利用cookies，思路真的不错    \n     2015-07-15 21:02 |    \t\ttheone \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:3        | hodor，hodor)\t\t \n  mark    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}