{"id": 84683, "wybug_id": "wooyun-2015-0143709", "wybug_title": "中国人保移动客户端存在多处安全漏洞", "wybug_corp": "中国人保财险", "wybug_author": "大头鬼", "wybug_date": "2015-09-27 11:55", "wybug_open_date": "2015-12-26 12:06", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["客户端程序设计错误", "手机应用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-30：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-11-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-26：\t细节向公众公开  简要描述： 对人保客户端做了简单的分析，发现在通讯协议、本地数据存储、webview上存在安全风险。 详细说明：  测试的客户端信息：    apk  : **.**.**.**sale.activity, 53, 1.1.1, 中国人保    apkmd5: c8f0c09a6c123c244d4d46496eeac8bd    证书 :    certmd5: 18d31d9a9bfa45a62437334c2f9bca5d    issuer: C=CN, ST=BeiJing, L=BeiJing, O=dtcloud, OU=dtcloud, CN=dtcloud    subject: C=CN, ST=BeiJing, L=BeiJing, O=dtcloud, OU=dtcloud, CN=dtcloud1.通讯协议使用http，敏感数据未做加密处理，很容易受到中间人攻击和网络嗅探，窃取用户隐私数据。\n\n2.应用本地明文存储账号密码，恶意程序可通过系统漏洞提升权限，窃取应用本地数据。账号密码存储在本地loginUser.xml文件中：\n\n3.webview远程代码执行漏洞，通过中间人攻击，向服务端返回的html页面插入恶意JS代码，窃取应用本地数据、执行恶意操作。通过fiddler代理，篡改服务端返回的html，植入webview漏洞检测代码：\n\n客户端显示暴露的JS接口对象：\n\n利用暴露的接口对象可执行任意命令，执行cat命令，查看本地loginUser.xml文件：\n\n4.客户端程序调试信息输出泄露用户数据：使用DMMS logcat功能查看应用运行时输出的调试信息，输出的信息含有用户隐私数据：\n\n\n\n   漏洞证明：  1.通讯协议使用http，敏感数据未做加密处理，很容易受到中间人攻击和网络嗅探，窃取用户隐私数据。\n\n2.应用本地明文存储账号密码，恶意程序可通过系统漏洞提升权限，窃取应用本地数据。账号密码存储在本地loginUser.xml文件中：\n\n3.webview远程代码执行漏洞，通过中间人攻击，向服务端返回的html页面插入恶意JS代码，窃取应用本地数据、执行恶意操作。通过fiddler代理，篡改服务端返回的html，植入webview漏洞检测代码：\n\n客户端显示暴露的JS接口对象：\n\n利用暴露的接口对象可执行任意命令，执行cat命令，查看本地loginUser.xml文件：\n\n4.客户端程序调试信息输出泄露用户数据：使用DMMS logcat功能查看应用运行时输出的调试信息，输出的信息含有用户隐私数据：\n\n\n\n   修复方案：     版权声明：转载请注明来源 大头鬼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-09-27 12:05 厂商回复： 非常感谢白帽子， 部分漏洞我们已发现正在整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-09-27 17:04 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:297 漏洞数:97        | The quiter you are,the more you're able ...)\t\t \n  跟随大牛学习安卓知识。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}