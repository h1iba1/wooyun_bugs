{"id": 1860, "wybug_id": "wooyun-2014-061955", "wybug_title": "微擎-微信公众平台自助引擎系统整站重装+SQL注入getshell", "wybug_corp": "we7.cc", "wybug_author": "路人甲", "wybug_date": "2014-05-25 17:32", "wybug_open_date": "2014-08-23 17:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["整站重装"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-23：\t细节向公众公开  简要描述： http://www.we7.cc/不知道这个程序收不收，还是交了吧。 详细说明：  http://www.we7.cc/源码下载，量还是挺大的。验证为v0.52，漏洞应该是版本通杀。\n\nhttp://bbs.we7.cc/forum.php?mod=viewthread&tid=1155在/install.php文件中26~28行代码如下：\nif(file_exists(IA_ROOT . '/data/install.lock') && $action != 'finish') {\theader('location: ./index.php');}\n如果满足条件，则跳转到index.php，但header并没有阻止程序继续往下执行。通过构造post包，可以实现整站重装。\n\nhttp://127.0.0.1/weixin/member.php?act=login&admin/111111进行登录，在全局设置---模块管理---模块设计中添加一个新的模块在作者框内填写一句话木马*/eval($_POST[chopper]);/*，生成模块模板\n\nwebshell地址：http://127.0.0.1/weixin/source/modules/test/module.php\n\n   漏洞证明：  如上   修复方案：  1.安装完后自动删除install.php文件，或满足条件处跳转后退出；2.sql注入处正确过滤。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-05-25 17:46 厂商回复： 整站重装漏洞已确认. webshell这个问题, 因为模块本来就是开发者设计的, 模块里可以定义任意代码. 这个漏洞我们会改进, 但是更重要的用户安装模块一定要确认模块来源和安全性. 最新状态： 2014-05-25：再次感谢. 路人甲  ", "replys": "漏洞评价：\n评论\n     2014-05-25 10:29 |    \t\t4ml9 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 每天前进一步。)\t\t \n  求公开    \n     2014-05-25 17:42 |    \t\t大白菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:19        )\t\t \n  。。。。忽略了~    \n     2014-06-14 20:06 |    \t\tapplychen \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:16        | 白发现首)\t\t \n  这又是哪位同学提交的？不要自毁长城啊！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}