{"id": 5574, "wybug_id": "wooyun-2013-045603", "wybug_title": " Discuz! X3.1后台任意代码执行可拿shell", "wybug_corp": "Discuz!", "wybug_author": "江南的鱼", "wybug_date": "2013-12-11 13:34", "wybug_open_date": "2014-03-08 13:35", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件包含漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-16：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-02-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-08：\t细节向公众公开  简要描述： 看有人问 Discuz! X3.1后台怎么拿shell，就下载了个看看，之前有人说HTML 生成能拿shell，我昨天官方网站下载的版本发现，静态文件的扩展名，限制了htm/html.如果服务器不存在解析漏洞，就没办法执行xxx.php;.htm,就拿不下shell。 简单研究了下，发现其实Discuz! X3.1后台 存在任意代码执行问题。也许比较鸡肋吧，要后台权限，Discuz! 本身安全性还是很不错的！ 详细说明：  直接重现场景，执行任意代码过程如下：1.先附上一张 系统版本的图片[Discuz! X3.1 Release 20131122]：\n\n2. 全局--〉网站第三方统计代码--〉插入php代码[其他地方<>会被转意]：   如插入 <?php  phpinfo();?>\n\n3.工具--〉更新缓存[为了保险起见，更新下系统缓存]： \n\n4.门户--> HTML管理--〉设置：  1） 静态文件扩展名[一定要设置成htm] ：htm  2)  专题HTML存放目录: template/default/portal  3) 设置完，提交吧！ \n\n5. 门户--〉专题管理--〉创建专题：  1）专题标题：xyz                           // 这个随便你写了  2）静态化名称：portal_topic_222        //222为自定义文件名，自己要记住  3）附加内容：选择上： 站点尾部信息 \n\n  3）提交  4）回到门户--〉专题管理,把刚才创建的专题开启，如下图 ： \n\n   5）把刚才的专题，生成  \n\n6. 下面就是关键了，现在到了包含文件的时候了。   再新建一个专题：   1）专题标题，静态化名称，这2个随便写   2）模板名：这个要选择我们刚才生成的页面：./template/default/portal/portal_topic_222.htm \n\n   3）然后提交，就执行了<?php phpinfo();?> \n\n   漏洞证明：  \n\n   修复方案：  厂家会修复    版权声明：转载请注明来源 江南的鱼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-03-08 13:35 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-11 13:53 |    \t\thacker@sina.cn \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:27        | ANONYMOUS)\t\t \n  跪求私信。补了就可惜了。    \n     2013-12-11 14:01 |    \t\t笨小猪 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:2        | 杯壁下流)\t\t \n  Mark！刚搭建的论坛就是X3.1,您就给搞一个任意代码之星    \n     2013-12-11 22:09 |    \t\t阿牛哥 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:5        | 不做恶，不做怪，一头牛)\t\t \n  我日，，赶紧755先    \n     2013-12-11 22:54 |    \t\t丶潇洒哥 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 我是一枚农民工。)\t\t \n  等了好久终于等到今天。    \n     2013-12-19 21:22 |    \t\t职业色羊 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 无)\t\t \n  Mark！    \n     2013-12-20 00:59 |    \t\tkissy \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 本人真心热爱，渗透测试、软件逆向等技术，...)\t\t \n  求方法啊      \n     2013-12-22 13:24 |    \t\t拆包 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 我如同一个初学走路的孩子。)\t\t \n  求公开啊！    \n     2013-12-22 13:31 |    \t\t拆包 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 我如同一个初学走路的孩子。)\t\t \n  真心求私信我方法！急需！谢谢！    \n     2013-12-24 13:43 |    \t\tMoogong \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:8        | 伪法医)\t\t \n  求方法 求私信！！！！    \n     2013-12-31 00:37 |    \t\t有点小鸡冻 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        )\t\t \n  求方法。。私信下吧。。    \n     2013-12-31 21:54 |    \t\tMr.醉心 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 爱生活，爱音乐，爱美女，更爱波多野结衣)\t\t \n  厂商忽略了那是不是可以公开了啊    \n     2013-12-31 21:55 |    \t\t坠落。 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | -.- 屌丝一枚,菜鸟一个,擅长windows/linux...)\t\t \n  求私信啊！！！！！    \n     2014-01-05 20:11 |    \t\t二狗子 \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | 农村非主流)\t\t \n  怎么没细节呀！！    \n     2014-01-06 00:32 |    \t\thacker@sina.cn \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:27        | ANONYMOUS)\t\t \n  好屌。    \n     2014-03-08 13:58 |    \t\tabcdefg \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 我来了。你在哪？)\t\t \n  这个我之前看过，试了几遍，反正我是没有成功。    \n     2014-03-08 14:01 |    \t\tabcdefg \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 我来了。你在哪？)\t\t \n  这个我之前看过，试了几遍，反正我是没有成功。    \n     2014-03-20 22:08 |    \t\t雷少 \t\t\t( 实习白帽子  |\t\t\t        Rank:80 漏洞数:31        | 热爱网络的爱好者，需求同道中人。)\t\t \n  我不是路人    \n     2014-03-23 11:36 |    \t\t腾讯厂商 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | script>document.cookie(\"http//a.cc/21.js...)\t\t \n  mark    \n     2014-03-23 16:59 |    \t\t雷少 \t\t\t( 实习白帽子  |\t\t\t        Rank:80 漏洞数:31        | 热爱网络的爱好者，需求同道中人。)\t\t \n  @腾讯厂商 惊现腾讯大流    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}