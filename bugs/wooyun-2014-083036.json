{"id": 48423, "wybug_id": "wooyun-2014-083036", "wybug_title": "中国铁建某应用系统getshell导致内网渗透", "wybug_corp": "中国铁建", "wybug_author": "_Thorns", "wybug_date": "2014-11-13 09:55", "wybug_open_date": "2014-12-28 09:56", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-28：\t细节向公众公开  简要描述： 中国铁建某应用系统getshell导致内网渗透 详细说明：  http://jhtj.crcc.cn/登录框注入。POST / HTTP/1.1Host: jhtj.crcc.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://jhtj.crcc.cn/Cookie: ASP.NET_SessionId=xjqfo2inmsyo4dkmhjdctosmX-Forwarded-For: 127.0.0.1Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 313__VIEWSTATE=%2FwEPDwUKLTU2MTI1MjQwNWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFDEltYWdlQnV0dG9uMY2clktYMvsQfqnmIU6bc48TSykQrQ0T%2FA1NKozwafC8&__EVENTVALIDATION=%2FwEWBAKS%2Ban1AQLz1uPtBAL65IDYBwLSwpnTCAe1mU%2FEsioCIXXti6BWvTStjZwnogwWSs0HotBcBdih&txtyhmc=123&txtyhkl=1111&ImageButton1.x=50&ImageButton1.y=6\n\n\n\n获取shell\n\n导致内网被渗透\n\n用户信息，发现密码被加密。\nprotected void ImageButton1_Click(object sender, ImageClickEventArgs e)    {        DB db;        int i_sfdl;        db = new DB();        string yhkl;        yhkl = db.EncryptPassword(txtyhkl.Text);        i_sfdl = db.getSelect(\"select * from T_User where yhid='\" + txtyhmc.Text + \"' and yhkl='\" + yhkl + \"' and sfjy='否'\");        if (i_sfdl != 0)        {\n这么坑爹的加密怎么能难得住帅气的白帽子呢？\n\nSHA1哇。哈哈。\n\n未对应用进行修改，也木有进行内网渗透。附送一个SQL注入http://crcbmc.crcc.cn/crcc_newsDetail.php?catalog=102&id=1853\n\n   漏洞证明：  http://jhtj.crcc.cn/登录框注入。POST / HTTP/1.1Host: jhtj.crcc.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://jhtj.crcc.cn/Cookie: ASP.NET_SessionId=xjqfo2inmsyo4dkmhjdctosmX-Forwarded-For: 127.0.0.1Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 313__VIEWSTATE=%2FwEPDwUKLTU2MTI1MjQwNWQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFDEltYWdlQnV0dG9uMY2clktYMvsQfqnmIU6bc48TSykQrQ0T%2FA1NKozwafC8&__EVENTVALIDATION=%2FwEWBAKS%2Ban1AQLz1uPtBAL65IDYBwLSwpnTCAe1mU%2FEsioCIXXti6BWvTStjZwnogwWSs0HotBcBdih&txtyhmc=123&txtyhkl=1111&ImageButton1.x=50&ImageButton1.y=6\n\n\n\n获取shell\n\n导致内网被渗透\n\n用户信息，发现密码被加密。\nprotected void ImageButton1_Click(object sender, ImageClickEventArgs e)    {        DB db;        int i_sfdl;        db = new DB();        string yhkl;        yhkl = db.EncryptPassword(txtyhkl.Text);        i_sfdl = db.getSelect(\"select * from T_User where yhid='\" + txtyhmc.Text + \"' and yhkl='\" + yhkl + \"' and sfjy='否'\");        if (i_sfdl != 0)        {\n这么坑爹的加密怎么能难得住帅气的白帽子呢？\n\nSHA1哇。哈哈。\n\n未对应用进行修改，也木有进行内网渗透。附送一个SQL注入http://crcbmc.crcc.cn/crcc_newsDetail.php?catalog=102&id=1853\n\n   修复方案：  你懂得   版权声明：转载请注明来源 _Thorns@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-11-18 09:20 厂商回复： CNVD确认并复现所述情况，此前联系过中国铁建官方，由于电话需要实名转接，暂未建立与官方的直接处置渠道，已向其官方网站公开邮件联系方式发送邮件通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}