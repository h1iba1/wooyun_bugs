{"id": 36938, "wybug_id": "wooyun-2015-0100794", "wybug_title": "便利店365框架漏洞", "wybug_corp": "中国联合网络通信有限公司辽宁省分公司", "wybug_author": "路人甲", "wybug_date": "2015-03-12 16:15", "wybug_open_date": "2015-04-26 16:16", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-26：\t细节向公众公开  简要描述：  详细说明：  通过一个小漏洞，发现邮箱，然后登录进了网站，余额竟然还有2w多网址：http://www.bld365.com/存在Struts 2漏洞，查看配置文件，用的dubbo，根本不懂，只看到一个smtp的账号密码，<bean id=\"mailSender\" class=\"org.springframework.mail.javamail.JavaMailSenderImpl\">          <property name=\"host\" value=\"smtp.ym.163.com\"/>          <property name=\"username\" value=\"password@ln170.com\"/>          <property name=\"password\" value=\"123gogogo\"/>      </bean>是163的企业邮箱，登录尝试：\n\n居然成功了，还有许多联系方式，入库出库清单\n\n利用此密码，尝试登录网站，账号 admin  密码 123gogogo\n\n登录成功，并且余额还有29566.32 接近三万块钱看了看系统，发现充值还需要一个充值密码，但在系统中看到这样一个请求http://www.bld365.com/ajax/getMemberInfo.action?temp=1426082592354返回的数据中有两个md5加密的密码。\n{\"member\":{\"address\":\"测试地址\",\"approved\":1,\"authorityCode\":null,\"baiduChannelId\":null,\"baiduUserId\":null,\"cell\":null,\"cerid\":null,\"ceridType\":null,\"cerimag\":null,\"city\":{\"cityName\":\"沈阳\",\"id\":1},\"deposit\":0.0,\"devices\":null,\"dxphonebillreturn\":0.019,\"email\":\"\",\"ghphonebillreturn\":0.0,\"id\":3,\"integral\":1000,\"lastDate\":\"2015-03-11T21:59:58\",\"latitude\":null,\"loginName\":\"admin\",\"loginPwd\":\"9d54d0b36f2ad1fa6f5ab25117d7f899\",\"loginTimes\":2403,\"longitude\":null,\"ltphonebillreturn\":0.016,\"memType\":null,\"memberName\":\"test111\",\"memberlevel\":{\"dxphonebillreturn\":0.019,\"favourable\":10,\"ghphonebillreturn\":0.0,\"id\":3,\"integral\":1000,\"levelName\":\"鞍山一组\",\"levelType\":null,\"ltphonebillreturn\":0.016,\"phonebillreturn\":0.012},\"mytotalreturn\":201.52,\"parent\":null,\"payPwd\":\"f48bd5f69d8280b9f25c777277c9562a\",\"phone\":\"123475969423\",\"phonebillreturn\":0.006,\"pwdcode\":null,\"realName\":\"\",\"regDate\":\"2014-06-17T13:29:08\",\"savemoney\":29566.32,\"savescore\":10020.0,\"thelevel\":null,\"token\":null,\"tokenDate\":null,\"tokenForPad\":null,\"zip\":\"555552\"}}\n界面，然后就可以任意充值手机话费了。。。   漏洞证明：  网址：http://www.bld365.com/存在Struts 2漏洞，查看配置文件，用的dubbo，根本不懂，只看到一个smtp的账号密码，<bean id=\"mailSender\" class=\"org.springframework.mail.javamail.JavaMailSenderImpl\">          <property name=\"host\" value=\"smtp.ym.163.com\"/>          <property name=\"username\" value=\"password@ln170.com\"/>          <property name=\"password\" value=\"123gogogo\"/>      </bean>是163的企业邮箱，登录尝试：\n\n居然成功了，还有许多联系方式，入库出库清单\n\n利用此密码，尝试登录网站，账号 admin  密码 123gogogo\n\n登录成功，并且余额还有29566.32 接近三万块钱看了看系统，发现充值还需要一个充值密码，但在系统中看到这样一个请求http://www.bld365.com/ajax/getMemberInfo.action?temp=1426082592354返回的数据中有两个md5加密的密码。\n{\"member\":{\"address\":\"测试地址\",\"approved\":1,\"authorityCode\":null,\"baiduChannelId\":null,\"baiduUserId\":null,\"cell\":null,\"cerid\":null,\"ceridType\":null,\"cerimag\":null,\"city\":{\"cityName\":\"沈阳\",\"id\":1},\"deposit\":0.0,\"devices\":null,\"dxphonebillreturn\":0.019,\"email\":\"\",\"ghphonebillreturn\":0.0,\"id\":3,\"integral\":1000,\"lastDate\":\"2015-03-11T21:59:58\",\"latitude\":null,\"loginName\":\"admin\",\"loginPwd\":\"9d54d0b36f2ad1fa6f5ab25117d7f899\",\"loginTimes\":2403,\"longitude\":null,\"ltphonebillreturn\":0.016,\"memType\":null,\"memberName\":\"test111\",\"memberlevel\":{\"dxphonebillreturn\":0.019,\"favourable\":10,\"ghphonebillreturn\":0.0,\"id\":3,\"integral\":1000,\"levelName\":\"鞍山一组\",\"levelType\":null,\"ltphonebillreturn\":0.016,\"phonebillreturn\":0.012},\"mytotalreturn\":201.52,\"parent\":null,\"payPwd\":\"f48bd5f69d8280b9f25c777277c9562a\",\"phone\":\"123475969423\",\"phonebillreturn\":0.006,\"pwdcode\":null,\"realName\":\"\",\"regDate\":\"2014-06-17T13:29:08\",\"savemoney\":29566.32,\"savescore\":10020.0,\"thelevel\":null,\"token\":null,\"tokenDate\":null,\"tokenForPad\":null,\"zip\":\"555552\"}}\n界面，然后就可以任意充值手机话费了。。。   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-03-17 11:47 厂商回复： CNVD确认所述情况，已经转由CNCERT下发给分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}