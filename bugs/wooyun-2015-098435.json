{"id": 36648, "wybug_id": "wooyun-2015-098435", "wybug_title": "WiFi万能钥匙客户端泄露用户wifi密码", "wybug_corp": "WiFi万能钥匙", "wybug_author": "hqdvista", "wybug_date": "2015-02-26 16:56", "wybug_open_date": "2015-05-27 18:52", "wybug_type": "用户敏感数据泄漏", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全", "手机软件安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-01：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-04-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-27：\t细节向公众公开  简要描述： WiFi万能钥匙客户端泄露用户wifi密码 详细说明：  \nprivate static boolean copyWifiConf() {        boolean bool = false;        try {            Runtime runtime = Runtime.getRuntime();            Process process = runtime.exec(\"su\");            OutputStream outputStream = process.getOutputStream();            DataOutputStream dataOutputStream = new DataOutputStream(outputStream);            dataOutputStream.writeBytes(\"cat /data/misc/wifi/wpa_supplicant.conf>/data/data/com.snda.wifilocating/wifi.conf\\n\");            dataOutputStream.writeBytes(\"chmod 777 /data/data/com.snda.wifilocating/wifi.conf\\n\");            dataOutputStream.writeBytes(\"exit\\n\");            dataOutputStream.flush();            process.waitFor();            if(process.exitValue() == 0xFF) {                return bool;            }            File file = new File(\"/data/data/com.snda.wifilocating/wifi.conf\");            if(!file.exists()) {                return bool;            }        }        catch(Exception exception) {            return bool;        }        return true;    }\nWifi万能钥匙客户端存在上述代码以读取用户的无线配置，但是将文件复制出来之后配置成了777权限，导致任何应用不需要权限均可以读取这个密码。   漏洞证明：  \n\n可以发现wifi.conf是777权限，任意应用均可以读取   修复方案：  设置成私有权限   版权声明：转载请注明来源 hqdvista@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-02-26 18:51 厂商回复： 感谢对WiFi万能钥匙安全的关注，该问题已确认，并将尽快在近期版本中予以修正。 最新状态： 2015-03-02：该问题已在新版本中修复，请下载安装最新版本WiFi万能钥匙使用。  ", "replys": "漏洞评价：\n评论\n     2015-02-26 17:00 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:31        | Hacked by @ringzero 我錯了)\t\t \n  CCTV往这拍    \n     2015-02-26 17:00 |    \t\t狂人 \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:13        | Rank:999999999 漏洞数:999999999 | 小学生...)\t\t \n  这尼玛提交了 老子以后还咋共享wifi？    \n     2015-02-26 17:00 |    \t\t第四维度 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:34        | 谦谦君子，温润如玉)\t\t \n  这下好玩了，后门被发现了    \n     2015-02-26 17:02 |    \t\t晏子 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 无)\t\t \n  别告诉我就是root权限可以查看连接的wifi密码的问题。    \n     2015-02-26 17:08 |    \t\t灭亡 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:5        | 乌云打杂 偶尔发几个垃圾洞刷存在  qq83133...)\t\t \n  这个早看见了，，一直利用来着 为什么提交    \n     2015-02-26 17:09 |    \t\tNeeke \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:24        | 求传授刷Rank方法？)\t\t \n  别告诉我就是root权限可以查看连接的wifi密码的问题。    \n     2015-02-26 17:12 |    \t\tlight \t\t\t( 普通白帽子  |\t\t\t        Rank:261 漏洞数:48        | 精华漏洞数:36 | WooYun认证√ 艺术系教授 ...)\t\t \n  希望这不是root权限可以查看wpa_supplicant.conf这个文件的问题。    \n     2015-02-26 17:14 |    \t\tMr .LZH \t\t\t( 普通白帽子  |\t\t\t        Rank:583 漏洞数:75        | 非妹子勿扰···)\t\t \n  早就知道了。http://www.freebuf.com/articles/wireless/37689.html另外，会有文件记录着密码，连接后共享给其他手机，扫二维码也可以得到。    \n     2015-02-26 17:28 |    \t\t′雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  一直都是看文件看密码    \n     2015-02-26 17:30 |    \t\ter0tic \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:23        | 某X站首席鉴黄师。本人QQ 285866931)\t\t \n  别告诉我就是root权限可以查看连接的wifi密码的问题。    \n     2015-02-26 17:38 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:19        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  请问下这个不都是公开的了么》？？？@xsser @疯狗     \n     2015-02-26 18:54 |    \t\tCh4r0n \t\t\t( 普通白帽子  |\t\t\t        Rank:391 漏洞数:87        | 苦逼青年一个！~~~)\t\t \n  这个一直不用root也可以知道密码啊！共享二维码就行了。    \n     2015-02-26 20:37 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Mr .LZH @er0tic 最好看到细节再做评论 否则太浮躁学不到东西    \n     2015-02-26 21:34 |    \t\tdangge \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 菜鸟一枚 努力学习中。)\t\t \n  意思是可以批量拖密码下来么    \n     2015-02-26 22:32 |    \t\tFire ant \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:26        | 他们回来了................)\t\t \n  其实我在想也许真有可能批量脱密码库    \n     2015-02-26 23:52 |    \t\tF4K3R \t\t\t( 普通白帽子  |\t\t\t        Rank:297 漏洞数:31        | 学习)\t\t \n  @xsser 我猜是app sql注入？    \n     2015-02-26 23:57 |    \t\tfox \t\t\t( 普通白帽子  |\t\t\t        Rank:159 漏洞数:16        | fox)\t\t \n  拿今天新闻里的段子来提交？http://www.cctime.com/html/2015-2-26/201522614650417.htmhttp://www.cctime.com/upLoadFile/2015/2/26/20152261465759.jpg    \n     2015-02-27 13:43 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  这应用也太无节操了吧    \n     2015-03-01 21:24 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  你这不是打他们的脸么    \n     2015-03-18 22:07 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  @Fire ant 师傅说的对！    \n     2015-05-27 19:52 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  思路学习了～    \n     2015-05-28 02:18 |    \t\t指尖上的故事 \t\t\t( 普通白帽子  |\t\t\t        Rank:347 漏洞数:77        | ...........)\t\t \n  我草  一直用这方法看密码你居然提交了 我勒个去    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}