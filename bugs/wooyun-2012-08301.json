{"id": 19757, "wybug_id": "wooyun-2012-08301", "wybug_title": "知道创宇WAF防火墙绕过漏洞", "wybug_corp": "知道创宇", "wybug_author": "路人甲", "wybug_date": "2012-06-14 17:46", "wybug_open_date": "2012-06-14 18:40", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "防火墙绕过", "安全", "应用安全", "技巧", "利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-14：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 知道创宇WAF防火墙可以被绕过。 详细说明：  知道创宇WAF防火墙存在问题，可以被绕过，造成SQL注入和XSS漏洞攻击成功。   漏洞证明：  访问wordpress xss会被WAF拦截http://blog.knownsec.com/wp-includes/js/swfupload/swfupload.swf?movieName=%22])}catch(e){if(!window.x){window.x=1;alert(/xss/)}}//\n\n稍微变换下函数定义，WAF就不拦截了http://blog.knownsec.com/wp-includes/js/swfupload/swfupload.swf?movieName=%22])}catch(e){if(!window.x){window.x=1;xss=alert;xss(/xss/)}}//\n\n   修复方案：  需要加强WAF规则。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-06-14 18:40 厂商回复： 非常感谢这位路人甲同学提交的知道创宇WAF绕过问题, 我们非常重视此问题.应剑心的建议, 下面我们对WAF这类产品做一个简单的科普:所有厂商的WAF规则策略都是可配的, 当WAF摆在一个网站前面的时候, 需要结合网站业务特性以及网站原程序本身特性进行仔细的规则策略配置, 可以说WAF是一款定制性较强的产品.通常各厂商的WAF在正式上线使用的时候, 都会禁用一些规则来提高效率以及针对特定业务避免误报来调整一些规则, 比如一个网站使用的数据库是mysql, 那么我们可能会禁用掉大部分只针对mssql或其他数据库的注入拦截规则以提高效率. 后期我们会专门放到网上一台WAF测试设备供大家测试, 由于结合业务而关闭大部分规则的WAF并不适合下定论是否可以bypass某些语句 :)再次感谢这位路人甲同学提交的问题, 也感谢他以及所有业界白帽子们对知道创宇以及知道创宇产品的关注, 我们会继续努力与大家共同进步! 漏洞Rank：5  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-14 19:24 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  这个回复不错。。顶。。    \n     2012-06-14 20:40 |    \t\tinsight-labs  \t\t\t( 普通白帽子  |\t\t\t        Rank:623 漏洞数:75        | Security guys)\t\t \n  顶~科普不错    \n     2012-06-15 09:11 |    \t\thblf \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:2        | 甲方安全攻城狮一枚)\t\t \n  国内有其他家就把waf部署在公网，可以查看规则可以测试。支持厂商们做这种适度的开放！    \n     2012-06-15 10:21 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n   XSS绕过是可以，SQL注入就没JS这么灵活了。。。    \n     2012-07-20 17:32 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  waf毕竟只是一定的规则，总有疏漏的地方    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}