{"id": 55228, "wybug_id": "wooyun-2014-061727", "wybug_title": "phpyun系统存储型跨站", "wybug_corp": "php云人才系统", "wybug_author": "dilcon", "wybug_date": "2014-05-22 23:26", "wybug_open_date": "2014-08-20 23:30", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-20：\t细节向公众公开  简要描述： phpyun系统对用户输入没有进行有效过滤，导致XSS漏洞存在。漏洞触发时，可拿到系统管理员COOKIE信息，修改后台设置，增加管理员等。  详细说明：  php云系统在身份认证模块，在对上传文件格式进行过滤时，只在客户端进行了过滤，我们可以绕过此方式，上传FLASH文件。进而引发存储型的FLASH跨站。当系统管理员对用户身份信息进行审核时，就会触发漏洞，我们可以通过此漏洞拿到管理员的COOKIE，或者通过脚本在后台新增管理员，进而登陆后台。   漏洞证明：  1、普通用户登录，上传准备好的swf文件，点击浏览准备上传文件。\n\n2、使用Firebug，修改上传时执行的检测函数，使其返回true：\n\n3、点击上传，文件上传成功。4、后台管理员登录系统对用户身份证进行审核：\n\n漏洞触发：\n\n5、使用Firebug查看源代码：\n\nswf文件上传成功，通过修改swf的脚本代码，可对后台设置进行修改。   修复方案：  对上传文件格式在服务端也要进行验证   版权声明：转载请注明来源 dilcon@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-05-25 17:24 厂商回复： 感谢您的提供，我们会尽快处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}