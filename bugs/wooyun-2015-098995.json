{"id": 44733, "wybug_id": "wooyun-2015-098995", "wybug_title": "魔线科技某分站配置不当导致整站源码可下载", "wybug_corp": "moxian.com", "wybug_author": "路人甲", "wybug_date": "2015-03-01 22:36", "wybug_open_date": "2015-04-15 22:38", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-15：\t细节向公众公开  简要描述： 魔线科技某分站配置不当导致整站源码可下载 详细说明：  SVN 临时文件可访问http://debug.moxian.com/key.phphttp://debug.moxian.com:8088/.svn/entries\n\n\n\n\n\n   漏洞证明：  http://debug.moxian.com:8088/test.php\n<?php$array = array('result'=>true);echo json_encode($array);exit;?>\nhttp://debug.moxian.com:8088/Inforead.php\n<?phpinclude('\\application\\library\\Environment.php');include('\\application\\library\\Singleton.php');include('\\application\\library\\ConfigRedis.php');include('\\application\\library\\RedisHelper.php');$redis = RedisHelper::getInstance();$page_num       =   isset($_GET['page_num']) ? intval($_GET['page_num']) : 1;$page_size      =   isset($_GET['page_size']) ? intval($_GET['page_size']) : 10;$start = ( $page_num - 1 ) + ( ( $page_num - 1 ) * ( $page_size - 1 ) );$end =  $start + ( $page_size - 1 );$list = $redis->zRevRange('Moxian_Info_List:'.'0', $start, $end);$result = array();// Read the listforeach ($list as $key => $value) {    $temp = $redis->hGetAll('Moxian_Info:'.$value);    if(!empty($temp)) {        $result[] = $temp;    }else{        echo 'read from mongodb';    }}echo (json_encode($result));\n   修复方案：  禁止访问，或者删除.svn目录   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-03-03 18:05 厂商回复： 谢谢帮助我们发现很多管理导致的严重安全问题，已通知安全人员处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}