{"id": 11605, "wybug_id": "wooyun-2013-024474", "wybug_title": "酒仙网窃取任意账户的方法，加个雷吧", "wybug_corp": "酒仙网", "wybug_author": "小川", "wybug_date": "2013-05-25 19:57", "wybug_open_date": "2013-07-09 19:58", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-25：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-07-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 窃取任意账户，只要他有邮箱 详细说明：  首先注册一个账户。注册好了以后，去验证一下自己的邮箱，退出系统，做忘记密码的操作，采用邮箱的方式取回密码。忘记密码后，酒仙网会给你发个邮件，点击他的重置密码的链接后会跳转到重置页，如下：\n\n输入自己要重置的密码，截获发送的请求如下：\n\n注意到图上的两个参数了吧传递了uid和uname用户名，那么猜想一下，只要这两个参数符合条件，是否就可以重置对应的用户了呢？关键是这两个值如何获取回到注册页面，注册功能是不可能注册相同账户的，以此可以猜测用户名曾经看过@路人甲那厮似乎报过酒仙网的问题那它肯定注册账户了，我们来忘记他的密码试试，如下图\n\n我们截获下发送邮件的请求\n\n这个请求传递了邮箱地址，我试过改掉邮箱为自己的邮箱，来试试是否可以把重置链接发给我但是不行，但是这个功能做的也不好，传递参数中暴露了邮箱，可以说泄露用户信息，你看，路人甲就郁闷了这条请求没什么，我们放过去放过去后会触发另一个请求如下图：\n\n可以看到uer_id暴露给我们了其实忘记密码后，浏览器上的链接就已经暴露了uid的值，以上只是说一下传递邮箱的问题。我们再回到我们刚才重置密码的请求处替换uid,uname为对应的值如下图：\n\n发送过去后\n\n\n\n   漏洞证明：  \n\n\n\n   修复方案：  感谢路人甲的无私奉献，提供账户为我们测试。虽然这个路人甲可能不是乌云上的路人甲这个系统做的很烂，包括还有可以修改邮箱等信息，可能又联系不到厂商，又被扼杀了。唉！修复方案：严格校验用户请求参数，不要从参数中获取敏感信息，采用session信息验证身份。另外说一下，某个人把我邮箱密码改了，小子，别让我找到你，川哥很生气，后果很严重。   版权声明：转载请注明来源 小川@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}