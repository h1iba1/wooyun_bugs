{"id": 65160, "wybug_id": "wooyun-2012-015290", "wybug_title": "anwsion最新版本任意上传漏洞(通杀所有。。。)", "wybug_corp": "anwsion.com", "wybug_author": "_Evil", "wybug_date": "2012-11-26 18:25", "wybug_open_date": "2013-01-10 18:26", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-12-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-12-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-10：\t细节向公众公开  简要描述： 怎么说呢,虽然程序热门,黑市价钱很高！但是得为wooyun贡献点东西吧~！！！！白帽子精神！！！！ 希望厂家给个礼物, ^_^ 详细说明：  上传附件地方没有好好处理文件后缀问题:\n\n判断的是文件头没有判断后缀问题。。。。。。。。   漏洞证明：  http://wenda.anwsion.com/uploads/questions/20121126/e826a3e05a4beb6c24373ba014fe39f8.php pass合并图片一句话木马成功~！！！！！http://wenda.anwsion.com/robots.txt \n\n   修复方案：  判断文件后缀,限制jpg png gif 等后缀其他的后缀 直接随机算法加密！！！！！   版权声明：转载请注明来源 _Evil@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2012-11-26 21:11 厂商回复： 我们已经做了一些调整。目前只要用户不在后台设置对应的后缀文件名允许上传既可。还是谢谢你！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-11-26 18:47 |    \t\ty35u \t\t\t( 普通白帽子  |\t\t\t        Rank:364 漏洞数:38        | yesu)\t\t \n  你那是什么黑市啊    \n     2012-11-26 19:46 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  哪里有黑市，我有一批威武的洞    \n     2012-11-26 20:00 |    \t\tanwsion(乌云厂商)\t\t \n  官方设置打开了PHP后缀，是不是这个缘故？    \n     2012-11-26 20:34 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  ＠anwsion 这个是部分问题,问题就是你们判断的是文件头是否为图片 格式。 如果是就直接放出路径,如果不是的话就随机+算法加密了。 这个验证也有漏洞。 如果别人支持其他的文件上传话 一样可能有安全问题如asp aspx jsp ...    \n     2012-11-26 20:47 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  你那是什么黑市啊 我也有几个注入和xss    \n     2012-11-26 20:53 |    \t\tanwsion(乌云厂商)\t\t \n  @_Evil 谢谢，我们会尽快去完善。    \n     2012-11-26 20:54 |    \t\tanwsion(乌云厂商)\t\t \n  @风萧萧 。。。没那么不堪吧。。:(，提醒下，我们做修复和调整。    \n     2012-11-26 20:55 |    \t\tanwsion(乌云厂商)\t\t \n  @冷静 一块来吧。。帮我们完善:) 谢谢！    \n     2012-11-27 01:30 |    \t\txiya \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n  Mark!    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}