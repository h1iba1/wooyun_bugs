{"id": 58353, "wybug_id": "wooyun-2014-051481", "wybug_title": "某通用型远程稿件处理系统SQL注入漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "xfkxfk", "wybug_date": "2014-02-20 10:57", "wybug_open_date": "2014-05-21 10:57", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "逻辑错误", "安全意识不足", "注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-04-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-21：\t细节向公众公开  简要描述：  详细说明：  北京勤云科技的远程稿件处理系统存在SQL注入。注入点在查询稿件——修改作者信息处，此时会查询次稿件的属性，在查询时，对稿件属性的数据字段没有过滤，导致SQL注入。在稿件处理系统的首页注册一个读者或者作者用户。登陆后，投稿。然后查询自己投的稿件，然后修改修改作者信息：\n\n此时截断，抓包，这里会发送两个请求：第一个请求放过，不管：\n\n第二个请求，我们截断：\n\n你会看到这个请求中的url中有两个跟sql有关的参数，此参数的值就是所要查询的字段键值。从正常返回的信息中也能看到，查询结果就是对应字段键值的值。此系统在其他的参数值中基本上都加了防御，输入非法字符会出现提示信息。但是在这里的参数字段值没有任何过滤，导致直接带入sql语句查询，造成sql注入，如我们在email后面加上双引号“，就会报错：\n\n而且会爆出当前的表名我们在正常的请求sql查新参数后面，加上5个emial字段，看看结果：\n\n成功被带入sql中，查出来了。如果知道这个sql，database的结果的话就能查出你想要的数据了。   漏洞证明：  见详细说明   修复方案：  过滤，控制用户可控参数   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-02-25 09:46 厂商回复： CNVD确认所述情况，与近期勤云科技的其他上传漏洞一并处置。考虑到利用复杂度（需要用户认证以及手动测试带入SQL语句），暂不作高危评价。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}