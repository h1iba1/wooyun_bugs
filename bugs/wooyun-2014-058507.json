{"id": 56214, "wybug_id": "wooyun-2014-058507", "wybug_title": "三福百货可0元购买任意物品", "wybug_corp": "sanfu.com", "wybug_author": "路人甲", "wybug_date": "2014-04-28 11:30", "wybug_open_date": "2014-06-12 11:30", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-12：\t细节向公众公开  简要描述： 三福百货可0元购买任意物品，非之前那个 详细说明：  大大在审核的时候千万不要说是跟之前那个重复，肯定是不一样的。而且之前那个已经修补了这次是另外一种嘛也还是对加入购物车的数量校验不严格通过各种手段加入了负的数量的物品\n\n看看吧，通过拼凑，价格和总数量是正的。我们继续下单\n\n这个地方看到，什么都跟我们预想的一样之前的那个任意购物漏洞是那个配送费用10可以自己定义成负的，这次测试时已经修复了这个漏洞我们直接提交订单，应该就成功了吧\n\n尼玛哦，还是服务端校验了啊。妈蛋。我们换个姿势。\n\n在这个地方提交订单的时候抓包看看\n\ncookie中有产品数量，我们修改下。现在是4+-1=3，我们改成5试试看吧，反正是测试。块接近成功了。接下来每步都把num修改下。妈蛋，到最后还是提示产品数量最小为1蛋疼啊。。看样子没救了。长长的分割线--------------------------------------------------------------------不想多说了，这里一直尝试突破这个东西，搞了很久，现在是凌晨1点多了，终于发现问题所在了，成功突破购物问题是这样的，看上面的截图数量是-1和4现在，关键的来了我们各种方法，把两件物品的位置调换下即是4和-1\n\n然后直接提交订单，什么都不用修改，直接提交成功了\n\n查看订单，可以看到数量为-1的物品已经被清0了。所以说综上所述，服务器只是验证第一个物品的数量？第二个就忽略了？如果第二个为负的就重置为0？唉，虽然到这里大家就看到是两个物品位置调换了下，但是我测试却不能马上想到这一点啊，很辛苦的测试很久才找到这个漏洞所在。厂商还不给个pad意思意思下哈。/可爱   漏洞证明：  大大在审核的时候千万不要说是跟之前那个重复，肯定是不一样的。而且之前那个已经修补了这次是另外一种嘛也还是对加入购物车的数量校验不严格通过各种手段加入了负的数量的物品\n\n看看吧，通过拼凑，价格和总数量是正的。我们继续下单\n\n这个地方看到，什么都跟我们预想的一样之前的那个任意购物漏洞是那个配送费用10可以自己定义成负的，这次测试时已经修复了这个漏洞我们直接提交订单，应该就成功了吧\n\n尼玛哦，还是服务端校验了啊。妈蛋。我们换个姿势。\n\n在这个地方提交订单的时候抓包看看\n\ncookie中有产品数量，我们修改下。现在是4+-1=3，我们改成5试试看吧，反正是测试。块接近成功了。接下来每步都把num修改下。妈蛋，到最后还是提示产品数量最小为1蛋疼啊。。看样子没救了。长长的分割线--------------------------------------------------------------------不想多说了，这里一直尝试突破这个东西，搞了很久，现在是凌晨1点多了，终于发现问题所在了，成功突破购物问题是这样的，看上面的截图数量是-1和4现在，关键的来了我们各种方法，把两件物品的位置调换下即是4和-1\n\n然后直接提交订单，什么都不用修改，直接提交成功了\n\n查看订单，可以看到数量为-1的物品已经被清0了。所以说综上所述，服务器只是验证第一个物品的数量？第二个就忽略了？如果第二个为负的就重置为0？唉，虽然到这里大家就看到是两个物品位置调换了下，但是我测试却不能马上想到这一点啊，很辛苦的测试很久才找到这个漏洞所在。厂商还不给个pad意思意思下哈。/可爱   修复方案：  我是要没救了，睡觉了。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-04-28 11:34 厂商回复： 感谢提交，修正中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-28 11:46 |    \t\t计算姬 \t\t\t( 普通白帽子  |\t\t\t        Rank:398 漏洞数:33        | 看我看我看我啊)\t\t \n  是不是有礼物啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}