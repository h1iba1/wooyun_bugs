{"id": 21417, "wybug_id": "wooyun-2011-03744", "wybug_title": "国人通信WAPI无线网络设备登陆验证绕过漏洞", "wybug_corp": "国人通信", "wybug_author": "longas_杨哲", "wybug_date": "2011-12-23 22:13", "wybug_open_date": "2012-02-06 22:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "敏感接口未加权限认证", "应用程序设计不当", "默认设置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-12-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-12-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-12-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-02-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-02-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-03-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-02-06：\t细节向公众公开  简要描述： 在国内某省运营商大量部署的某款型号国人通信WAPI无线网络设备，存在登陆验证绕过漏洞，允许攻击者绕过登陆密码验证，从而实现下载账户密码等配置文件下载、强制重启、修改配置等攻击行为，可能导致内部无线网络全面瘫痪。 详细说明：  国人通信某型号WAPI无线网络设备存在登陆验证绕过漏洞   漏洞证明：  一旦攻击成功，攻击者就能访问到该AP的配置页面。\n\n对于该已部署在某运营商内部的无线网络设备而言，厂商在设计时已经考虑了诸多的安全问题，比如在配置文件中默认管理员admin的密码就不再是明文或者简单的base64加密，而是采用了SHA256这样的强化算法。如下图中黑框部分所示，在passwd.conf配置文件中，“passwd=”后面不再是密码明文，而是经过SHA256运算过的SHA256 Hash值即常说的SHA256哈希值。\n\n但攻击者会下载修改后再重新将其一起封装成backup.tar配置文件，然后直接访问如下路径将备份数据文件恢复，如下图所示。\n\n   修复方案：     版权声明：转载请注明来源 longas_杨哲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2011-12-24 14:18 厂商回复： CNVD暂未在现网设备中直接确认，依据路人甲的报告确认漏洞可造成相关设备泄露，进入CNVD处置流程。下周工作日内确认后将收录并分配CNVD漏洞编号，生成CNVD证书。感谢路人甲，这个案例作为业务逻辑方面的漏洞也较为典型。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-02-07 11:38 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  允许攻击者绕过登陆密码验证？能否详细一点呢？谢谢    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}