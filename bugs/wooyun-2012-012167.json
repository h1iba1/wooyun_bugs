{"id": 16704, "wybug_id": "wooyun-2012-012167", "wybug_title": "网通营业厅客户信息泄露、充值支付价格修改漏洞", "wybug_corp": "华数数字电视", "wybug_author": "Michael", "wybug_date": "2012-09-13 19:29", "wybug_open_date": "2012-10-28 19:30", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-09-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-10-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-10-28：\t细节向公众公开  简要描述： 杭州华数网通宽带网上营业厅存在多处漏洞，导致客户、业务信息泄露，此外充值系统亦存在修改价格的漏洞 详细说明：  \n\n杭州华数网通宽带网上营业厅（http://self.hzcnc.com/boss/index.jsp），左侧信息查询链接均采用GET方式获得用户数据，且没有对用户ID进行判断。\n\n\n\n\n\n\n\n用户的宽带帐户名称也被泄露，若密码弱口令有暴力猜解可能。\n\n信息查询功能均使用GET方式获得且没有判断用户ID。由于测试需要，每张截图我使用了不同的ID号码。但如果使用同一号码查询，获得的用户姓名、业务情况等社工信息可被利用。接下来是充值系统的漏洞\n\n输入缴费金额98元\n\n跳转到了支付平台\n\n网页采用POST提交方式，如图圈圈处为支付金额，测试需要修改为100即1元。\n\n成功跳转到支付宝页面。没有继续实施测试。   漏洞证明：  见描述   修复方案：  客户信息查询可直接通过SESSION获得用户ID并对用户ID作验证。支付系统的价格信息也不应由用户提交。   版权声明：转载请注明来源 Michael@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2012-09-17 23:24 厂商回复： CNVD确认并复现所述漏洞情况（部分涉及业务安全，对中断修改进行了验证），由CNVD直接联系网站管理方处置。按部分影响机密性、可用性、完整性进行评分，rank=7.10*1.2*1.3=11.076 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-09-13 23:48 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  修改价格估计也是银行支付完成了back回来的数据给你冲进去吧，不然，网葱公司要垮了！    \n     2012-09-14 00:06 |    \t\tMichael \t\t\t( 实习白帽子  |\t\t\t        Rank:87 漏洞数:24        )\t\t \n  @小胖子 我看到在进入第三方支付页面已经跳转了一次到营业厅外的支付中心的页面，那里的价格是是原价。因为付款页面是设定好了按月98元起付的，所以如果价格出现问题应该很快会被发现吧。    \n     2012-09-14 08:49 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  洞主威武……    \n     2012-09-14 09:36 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  这个问题咱试过，貌似没能成    \n     2014-04-11 17:28 |    \t\t小贱人 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 资深菜鸟，)\t\t \n  mark    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}