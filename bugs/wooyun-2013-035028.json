{"id": 10270, "wybug_id": "wooyun-2013-035028", "wybug_title": "支付宝通过手机找回密码验证过于简单可能存在风险", "wybug_corp": "支付宝", "wybug_author": "Exr", "wybug_date": "2013-08-23 12:45", "wybug_open_date": "2013-08-27 13:14", "wybug_type": "账户体系控制不严", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证设计不合理", "认证缺陷", "手机安全", "支付安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 闲来无事就想测试下手机丢失情况下，个人支付宝账户是否还安全。结果是：仅通过二条短信，找回了相应手机号（前提是号码在支付宝有注册）的登录密码和支付密码… 详细说明：  现在常用的QQ，财付通和支付宝几乎都与手机号码进行了关联。问题就出来了，当手机不在本人手中的时候，相应的账户还安全么相信很多人已经对此评估过了！而且手机丢失事件还非常多，即使手机丢失后要及时挂失，可对于有备而来的人来讲，这都太晚了…关于QQ，如果与手机号码绑定，外加上手机上QQ使用者一般选择记住QQ号码，那么很快，你的QQ密码将被修改，甚至更改绑定手机。如果还开通了财付通，哼哼，你懂的因本人QQ并没有绑定手机，所以以上可以自己实践，而本人常用的支付宝却绑定了手机。而手机号码即可当支付宝账户，然后就有了下面的问题；另外相信其他关联了手机的也有类似问题！   漏洞证明：  1.进入支付宝找回登录密码页面，（因支付宝中手机号码可作为账户名）输入相应手机号码和验证码：\n\n2.选择不需要身份信息验证的仅通过手机校验码：\n\n3.点击“点此免费获取”校验码，将收到的找回登录密码短信中的校验码进行填写\n\n4.到此即可重置登录密码：\n\n\n\n下一步重置支付密码：5.进入找回支付密码页面，选择“通过手机校验码”\n\n竟然还是推荐方式……6.和第三步类似：收到的短信：\n\n将收到的找回支付密码短信中的校验码进行填写\n\n7.OK，可重置支付密码：\n\n\n\n到此，此支付宝账户已经可以被人操控了…支付宝、余额宝…更严重的情况是：支付宝账户一般还关联了银行卡，而且大都开通了快捷支付（虽然快捷支付72小时100%赔付），然后仅一条短信，即可提取关联银行卡内的RMB…来个从银行卡内提取限额阀值：\n\n选择“确认充值”后会发送快捷支付校验码：\n\n\n\nOK，充值成功！这对于有特定目的的小偷来讲，可是一种发财之路…   修复方案：  支付宝官方团队当然有考虑过这种情况，可为何还这样，难道是这种情况责任在于个人么？在认证时，建议采用两重因子鉴别机制，如太多鉴别则要以牺牲快捷为代价~因为只持有手机号即可进行账户操作，主要是涉及到RMB，所以还是希望多重视吧，虽然快捷支付72小时100%赔付，但还是降低风险为好~求邀请码，有木有、   版权声明：转载请注明来源 Exr@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-08-27 13:14 厂商回复： 感谢对支付宝关心，支付宝对账户安全从多个维度进行识别判断。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-23 13:38 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  估计支付宝会认为丢失手机比密码被盗要难    \n     2013-08-23 15:43 |    \t\tExr \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        )\t\t \n  @tpu01yzx 密码丢倒不常有，密码忘了倒是常见的事…而且手机丢失现象很严重，所以这也是种风险…    \n     2013-08-27 14:57 |    \t\tling \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:35        | 我是屌丝、我为自己代言 。)\t\t \n  忽略。我的也是忽略 --    \n     2013-08-27 16:00 |    \t\tExr \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        )\t\t \n  @ling 嗯,难道支付宝都不处理么?@支付宝,不处理么?    \n     2013-08-28 14:40 |    \t\tIXY \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | 小菜来学习的)\t\t \n  SO 用邮箱作为支付宝账号 用手机作为安全认证 才是最保险的    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}