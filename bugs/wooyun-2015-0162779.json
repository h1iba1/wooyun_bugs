{"id": 73744, "wybug_id": "wooyun-2015-0162779", "wybug_title": "万达社区笑脸App/任意用户登录/泄露全部员工信息/泄露全部数据库", "wybug_corp": "大连万达集团股份有限公司", "wybug_author": "逆流冰河", "wybug_date": "2015-12-19 19:53", "wybug_open_date": "2016-02-01 10:51", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-01：\t细节向公众公开  简要描述： 说实话,感谢审核员认真审核,本来我只是提交了一个任意用户登录的bug,提示了一下可以注入结果审核不通过,如实我就开始了,整了好久 详细说明：  1,万达社区App登录时,可以输入用户名例如:liwei' or '1'='1 登录任意用户,不过有的需要验证,有的不需要验证,这个截图证明一下\n\n\n\n2,本来是到此季结束的,不过审核不给过,于是我开始手动注入这是登录的post信息\n\nunion 注入,共23个字段\n\n看看有没有管理员表,果然\n\n\n\n\n\n3,好吧,我开始暴库\n\n下一个库\n\n库信息:gw_misc_dbdb_accessadmindb_backupoperatordb_datareaderdb_datawriterdb_ddladmindb_denydatareaderdb_denydatawriterdb_ownerdb_securityadmindboguestINFORMATION_SCHEMAsys4,继续,我开始爆表,主要是gw_misc_db库的\n\n下一个表\n\n所有表:(没有爆完,太多了)smile_p_templatesmile_bbs_collectsysdiagramsehr_orgnizationtopicsmile_bbs_commenttopic_optsmile_praisesmile_projectusersmile_bbs_filmcodesmile_reviewsmile_bbs_filmrateuser_votesmile_bbs_index_focussmile_bbs_modulevotesmile_rtxlogvote_datasmile_searchvote_ipsmile_usersmile_bbs_praisevote_option5,看到smile_user,我就看到所有人的信息了用burtsuite一炮,全出来了\n\n\n\n6,我是被逼的   漏洞证明：  Fix   修复方案：  上次说如果再获取全部员工信息,要有重大礼品的,等待中20Rank可好,截图挺辛苦,手动注入挺辛苦   版权声明：转载请注明来源 逆流冰河@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-12-21 13:52 厂商回复： 感谢逆流冰河同学的关注与贡献，马上通知业务整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-19 22:46 |    \t\tMark0smith \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:41        )\t\t \n  好想看看内容    \n     2015-12-21 11:34 |    \t\t爱上襄阳 \t\t\t( 普通白帽子  |\t\t\t        Rank:349 漏洞数:87        | ...)\t\t \n  应该还是app更新后产生的漏洞吧~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}