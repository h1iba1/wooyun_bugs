{"id": 58626, "wybug_id": "wooyun-2014-050582", "wybug_title": "EasyTalk 官网疑似被入侵及原因分析", "wybug_corp": "nextsns.com", "wybug_author": "w5r2", "wybug_date": "2014-02-10 15:43", "wybug_open_date": "2014-03-27 15:44", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-27：\t细节向公众公开  简要描述： 官网被入侵 详细说明：  有于微博漏洞造成官网被入侵。\n\n出现问题在这\npublic function index() {                parent::tologin();        $appname=trim($this->_get('appname'));                $action=$this->_get('action');//直接调用方法                $out=urldecode($_GET['out']); //未过滤，直接提交。                //是否开启应用                $app=M('Plugins')->where(\"directory='$appname' AND available=1\")->find();                $this->assign('app',$app);                if (!$app) {                        $this->display('apperror');                        exit;                }                //是否添加                if ($app['type']=='app') {                        $myapp=M('Myapps')->where(\"user_id='\".$this->my['user_id'].\"' AND appid='$app[id]'\")->find();                        if (!$myapp) {                                $this->display('addapp');                                exit;                        }                        if (time()-$myapp['lasttime']>600) {                                M('Myapps')->where(\"id='$myapp[id]'\")->setField('lasttime',time());                        }                }                //获取内容                if (@file_exists(ET_ROOT .'/Apps/'.$appname.'/index.class.php')) {                        include_once(ET_ROOT .'/Apps/'.$appname.'/index.class.php');            if (class_exists($appname)) {                                if (!@file_exists(ET_ROOT.'/Apps/'.$appname.'/'.$out)) {                    $out='';                }                if (!$out) {                    $plugin=new $appname($this);                    if ($action) {                        echo $plugin->$action();                        exit;                    } else {                        if (method_exists($appname,index)) {                            $content=$plugin->index();                        }                    }                } else {                    include_once(ET_ROOT .'/Apps/'.$appname.'/'.$out);//直接调用$out                    exit;                }            }        }                if (!$content) {            $this->display('apperror');                        exit;        }                                $this->assign('subname',$app['name']);                $this->assign('content',$content);        $this->display();    }\n文件是\n文件出现在upload\\Home\\Lib\\Model\\AppAction.class.php\n\n\n   漏洞证明：  \nhttp://www.nextsns.com/robots.txt\n   修复方案：  修复微博   版权声明：转载请注明来源 w5r2@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-02-10 20:12 厂商回复： 已修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}