{"id": 13913, "wybug_id": "wooyun-2013-018263", "wybug_title": "携程旅行网任意老板密码修改(庆在wooyun第100洞)", "wybug_corp": "携程旅行网", "wybug_author": "se55i0n", "wybug_date": "2013-02-02 01:45", "wybug_open_date": "2013-03-19 01:46", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-02-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-02-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-03-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-19：\t细节向公众公开  简要描述： 庆祝在wooyun的第100个漏洞，顺便求个礼物，上市公司不要小气哟（对不住携程的童鞋了）-_-|| 详细说明：      携程的密码重置功能相当强大，支持“用户名”、“手机号”、“邮箱帐号”、“卡号”重置；换句话说，只要我们只要以上4种信息中的任意一种，便可使用该功能重置相应用户的密码。那么且看我是如何重置任意老板的用户密码的！！1)首先注册两枚用户，sina.com用户和sina.cn用户，对sina.cn用户进行密码重置；\n\n2）填入相应的sina.cn用户的邮箱帐号，点击下一步，使用绑定邮箱进行密码重置；\n\n3）登录sina.cn邮箱获取到系统发送的密码重置链接；\n\n4）访问系统发送的密码重置链接，进行密码重置；\n\n5）设置好我们需要重置的密码，点击保存并抓包分析发现数据中一个熟悉的参数；\n\n6）是的，在数据中发现唯一标识用户身份的“Uid”信息，而这个信息在密码重置的第二步时，系统会“主动”提供给我们，有了这个信息是不是....；7）好吧，那我们赶紧去获取sina.com用户的\"Uid\"信息吧；\n\n8）使用sina.com用户的Uid值替换sina.cn用户的Uid参数并提交；\n\n9）好吧，系统已经恭喜我“密码修改成功”；\n\n10）Bingo！返回用户登录页面，使用sina.com用户邮箱帐号、刚刚修改的密码成功登录；\n\nPS:获取4种信息的任意一种，我们就能获取用户的Uid信息，那么也就可以成功重置该用户的密码！！求礼物，求给力！！！   漏洞证明：  见详细说明~   修复方案：  建议重置过程每个步骤都校验用户身份的合法性！   版权声明：转载请注明来源 se55i0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-02-04 09:33 厂商回复： 非常感谢，已紧急修复礼物随后联系并寄送！ 最新状态： 2013-03-19：已修复  ", "replys": "漏洞评价：\n评论\n     2013-02-02 01:51 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  第一个来马克～    \n     2013-02-02 02:35 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  恭喜    \n     2013-02-02 05:30 |    \t\tpeter \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 孤单的活着，只为等待你！)\t\t \n  这个牛啊。    \n     2013-02-02 10:01 |    \t\ttxcbg \t\t\t( 普通白帽子  |\t\t\t        Rank:391 漏洞数:53        | 说点什么呢？)\t\t \n  恭喜洞主    \n     2013-02-02 11:58 |    \t\tfox \t\t\t( 普通白帽子  |\t\t\t        Rank:159 漏洞数:16        | fox)\t\t \n  恭喜100洞    \n     2013-02-02 12:19 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @peter @fox @txcbg @蟋蟀哥哥 @小胖子 谢谢，你们都是好人：D    \n     2013-02-02 13:20 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @se55i0n 他们都是你的好基友     \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}