{"id": 14508, "wybug_id": "wooyun-2013-016984", "wybug_title": "PhpcmsV9 SQL注射 2013年贺岁第一发", "wybug_corp": "phpcms", "wybug_author": "我想拿个shell", "wybug_date": "2013-01-06 11:39", "wybug_open_date": "2013-02-20 11:40", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-02-20：\t细节向公众公开  简要描述： 先来发一枚有条件的SQL注射打底，如果我说我连载，会有人关注我么。我想至少明后我会连载一下。 详细说明：  在phpcmsv9的通行证程序内。phpsso_server/phpcms/modules/phpsso/classes/phpsso.class.php内的一行代码\nif(get_magic_quotes_gpc()) {\t$this->data = new_stripslashes($this->data);}\n这里的输入在magic_quotes_gpc开启的时候居然stripslashes了。。。然后就没有然后了。。。。。   漏洞证明：  在开启magic_quotes_gpc的环境下，去到phpcms登陆的界面，输入xxxxxxxxxxxx' or '1密码随意输入，提示“密码错误”而非“账户不存在”就证明你可以注入了。\n\n为什么提示不一样？？如下\nif($status == -1) {\t//用户不存在\t\t\t\t\t\tshowmessage(L('user_not_exist'), 'index.php?m=member&c=index&a=login');\t\t\t\t\t} elseif($status == -2) { //密码错误\t\t\t\t\t\tshowmessage(L('password_error'), 'index.php?m=member&c=index&a=login');\t\t\t\t\t} else {\t\t\t\t\t\tshowmessage(L('login_failure'), 'index.php?m=member&c=index&a=login');\t\t\t\t\t}\n若把v9_sso_applications中的数据读出来，这就是一个严重漏洞了。   修复方案：  其实没必要stripslashes。   版权声明：转载请注明来源 我想拿个shell@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-01-06 14:10 厂商回复： 非常感谢！！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-06 11:42 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  2013年 好戏又要开始了 我关注洞主了    \n     2013-01-06 11:43 |    \t\thongygxiang \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:12        | 蛋疼)\t\t \n  默默关注着    \n     2013-01-06 11:47 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  摸摸关爱着    \n     2013-01-06 12:28 |    \t\t1ee \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:14        | 看书中....)\t\t \n  目测又要连载了    \n     2013-01-06 14:10 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @1ee 看这标题 肯定是了     \n     2013-01-06 14:10 |    \t\tP w \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:14        | -这家伙很懒,什么都没有留下。其实我真的很...)\t\t \n  make    \n     2013-01-06 14:44 |    \t\t八神庵 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 无职业，DIAO丝？我擦)\t\t \n  V9又首当其冲啦    \n     2013-01-06 19:43 |    \t\tif、so  \t\t\t( 核心白帽子 |\t\t\t        Rank:1008 漏洞数:91        | 梦想还是要有的，万一实现了呢？)\t\t \n  啥时候咱也有连载的时候。。    \n     2013-01-06 22:04 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  俺憋不住了，冒泡。。关注，欢迎连载。。    \n     2013-01-07 14:13 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  打底 1库    \n     2013-02-05 18:33 |    \t\t烨少 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n  啊啊啊啊，好戏开始了。。    \n     2013-02-05 22:40 |    \t\twhirlwind \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:8        | 极光肖风)\t\t \n  老大你用的什么软件这个图？@我想拿个shell    \n     2013-02-07 14:58 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @whirlwind 目测是QQ    \n     2013-02-08 13:08 |    \t\tDragonEgg \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:18        | 冷漠无情的绅士，温柔善良的坏蛋。)\t\t \n  @疯狗 应该貌似不是。。QQ截图的红框的角是90度的、、这个还有个弧度    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}