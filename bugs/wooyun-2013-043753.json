{"id": 60318, "wybug_id": "wooyun-2013-043753", "wybug_title": "TCCMS SQL注入漏洞（同一文件多处）", "wybug_corp": "teamcen.com", "wybug_author": "Matt", "wybug_date": "2013-11-22 19:03", "wybug_open_date": "2014-02-20 19:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-20：\t细节向公众公开  简要描述：  详细说明：  /app/controller/picture.class.php\npublic function all() {        $_Obj = M($this->objName);        $categoryObj = M(\"category\");        $_Obj->pageSize = 20;        $where = \"1=1\";        $key = $_POST['key'];//注入        $cid = $_GET['cid'];        if ($key != \"\") {            $where .= \" and id = '\" . $key . \"' or title like '%$key%'\";//注入 下面多处都是注入        }        if (!empty($cid) && $cid != \"\") {            $where .= \" and classid = \" . $cid;        }        if ($_GET[\"type\"] == \"user\") {            $where .= \" and uid = \" . $_COOKIE['userId'];\n   漏洞证明：  测试方法打开127.0.0.1/tccms//index.php?ac=picture_allPOST提交 key=1111111121' \n\n   修复方案：  过滤   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2013-11-24 19:49 厂商回复： 获取不到敏感信息 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-24 20:05 |    \t\tMatt  \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:107        | 承接代码审计 http://codescan.cn/)\t\t \n  @teamcen.com 赤裸裸的注入 你和我说获取不到铭感信息。。。    \n     2013-11-24 20:38 |    \t\tTCCMS-PHP内容管理系统(乌云厂商)\t\t \n  @Matt 对于这个问题，我们会优先处理这个问题，查实如何获取敏感信息(特指服务器信息,用户信息)。TCCMS是面对公众的开源软件，经得起大众的检验才会成为优秀的软件。感谢关注TCCMS    \n     2013-11-24 22:14 |    \t\tMatt  \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:107        | 承接代码审计 http://codescan.cn/)\t\t \n  @TCCMS-PHP内容管理系统 我没有写出利用方法而已。。这个注入可以获取数据库里面的任何信息。。    \n     2013-11-25 14:26 |    \t\tlxj616 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:90        | <hohoho>)\t\t \n  @Matt 证明注射危害至少要跑表成功或者读文件，很多盲注+waf只能database（）的，这样的注射确实限制多危害小，你不细说很容易给厂商错觉，毕竟人家不会花时间看注射能不能获取信息    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}