{"id": 46391, "wybug_id": "wooyun-2015-091267", "wybug_title": "新浪地产认证机制设计不当导致可劫持任意会员帐号", "wybug_corp": "新浪", "wybug_author": "Forever80s", "wybug_date": "2015-01-12 09:59", "wybug_open_date": "2015-02-26 10:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-26：\t细节向公众公开  简要描述： 新浪地产认证机制设计不当导致可劫持任意会员帐号 详细说明：  新浪地产认证机制设计不当导致可劫持任意会员帐号   漏洞证明：  激活邮箱的时候逻辑有问题如果用户注册完账号，激活账号的时候会收到如下格式链接\nhttp://passport.dichan.com/ActiveEMail?email=xxxxx@163.com&sn=dacdce3f43e62d378e64c30bac385ce70e754bc4&tourl=\n\n\n分析得出sn是email的sha1只要访问这种格式的链就可以劫持该email的用户。POC：我们注册一个账号，这里用一个不能收邮件的账号notexistxxxooxx@xxoo.xx\n\n注册成功后，在打开浏览器一个in private 模式，构造链接如下\nhttp://passport.dichan.com/ActiveEMail?email=notexistxxxooxx@xxoo.xx&sn=183f3307c57206a4c59d0a2dd635e6064179a8a4&tourl=\n\n\n访问成功激活然后已经是登陆状态了，回到个人中心\n\n   修复方案：     版权声明：转载请注明来源 Forever80s@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2015-01-12 16:07 厂商回复： 感谢关注新浪安全，此为合作方业务，将通知对方进行漏洞修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}