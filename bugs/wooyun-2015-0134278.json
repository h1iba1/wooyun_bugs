{"id": 65408, "wybug_id": "wooyun-2015-0134278", "wybug_title": "对中粮集团的多个系统的渗透测试（已入多个系统）", "wybug_corp": "中粮集团有限公司", "wybug_author": "wps2015", "wybug_date": "2015-08-15 12:42", "wybug_open_date": "2015-10-01 09:36", "wybug_type": "用户资料大量泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向公众公开  简要描述： 一天动物园管理员发现袋鼠从笼子里跑出来了，于是开会讨论，一致认为是笼子的高度过低。所以他们决定将笼子的高度由原来的10米加高到20米。结果第二天他们发现袋鼠还是跑到外面来，所以他们又决定再将高度加高到30米。    没想到隔天居然又看到袋鼠全跑到外面，于是管理员们大为紧张，决定一不做二不休，将笼子的高度加高到100米。一天长颈鹿和几只袋鼠们在闲聊，“你们看，这些人会不会再继续加高你们的笼子？”长颈鹿问。“很难说。”袋鼠说∶“如果他们再继续忘记关门的话！” 详细说明：  1.最开始问题在中粮米业的oa系统：http://dmoa.cofco.com/seeyon/index.jsp无验证码和错误次数限制，先利用top500人名+top100弱口令，获取了大量职员口令信息\nzhangmei   12345678   成都lifeng     12341234       北京chenjing   123456       三江wangdan    123456    三江liying     123456       宁夏limei      123456     北京wangbo\t   123456liudan     123456   岳阳yangjing   123456   绥化wangyuying 123456  江西chenjuan   123456liyang     123456wangliang  123456lijianhua  123456zhangliang 123456zhangning  123456chenpeng   123456lijianguo  123456yangwei    123456lizhiqiang 123456chenbin    123456lixiang    123456      成都wangkun    123456      大连liwen      123456      盐城\n为什么后面会有地名呢，这是因为登陆进去发现他们属于不同的分公司的，其通讯录和一些联系人各有不同成都：\n\n北京：\n\n还有其他分公司我就不一一登录了，分公司有几十家。然后再oa系统右下方有一个关联系统，链接到中粮的相关系统上。\n\n2. 最开始看的是“单元COFCORICE邮箱”：http://mail.cofcorice.com/发现这是中粮集团大米部的企业邮箱，采用的coremail，有错误的次数限制，暂且无法爆破。不得又去看了“单元网站”：http://www.cofcorice.com/，在人才招聘处可以注册，这里我注册了一个111@qq.com  test123的账号，发现在修改个人信息的地方，居然可以遍历用户名和密码http://www.cofcorice.com/ability/register.aspx?UserId=40 (并且无需登录)\n\n既然是招聘的地方，那就有可能有中粮的员工注册过，写了个小脚本将全部应聘者用户名和密码爬了下来，由于是明文，而且有的密码比较复杂可能作为常用密码，这里打了mark（我随手就登上了一个163信箱和一个qq号）\n\n得到这份信息后，从中果然发现多个cofcorice.com域下的邮箱，其中三枚可登陆\nwangxw1@cofcorice.com  11223344zhouysh@cofcorice.com  955998066zhouzhaoyl@cofcorice.com  880921\n登陆成功，在邮件里搜索密码，发现下面这封邮件\n\n但是很可惜，这个系统已经不维护了。这时候还是开始了信息收集的过程，把三个邮箱中cofco.com域下的邮箱收集起来\n\n再把之前多个分公司通讯录中cofco.com域下的邮箱收集起来\n\n做成用户名字典，以待备用3.再去看其BI系统：http://dmbi.cofco.com:9704/analytics/saw.dll?Dashboard有之前 WooYun: 中粮集团多处弱口令打包（可审核/导出巨额订单信息） 的经验了，这种员工的管理系统一般用户名都为人名的缩写，这个时候之前收集的用户名字典就有用了，再次爆破得到多个员工弱口令\nzhangxudong  123456\thewei\t123456liujianyang\t123456xudan\t123456jialei\t123456zhangzhongtao\t123456wanjiyang\t123456liuboyang\t123456xuqifeng\t123456yu-wei1\t123456qiz\t123456xiangyang\t123456fengjun\t123456wangbei\t123456chendong\t123456liujun\t123456xulong\t123456renbo\t123456\n中粮员工酷爱123456，当然从之前邮件里面的信息可以发现运维一般给他们分配的就是123456。登陆成功，发现这是运营数据管理和分析系统，这营业额吓尿我了有木有，几个零？\n\n原来全国三十二家分公司。。\n\n利用bi系统的弱口令，登陆CRM系统也可以，有木有\nzhangxudong  123456renbo  123456\n其他我没尝试，注意这个CRM系统登录需要使用ie7及以下，并将该系统设为信任，然后安全性为最低，然后安装siebel扩展（。。。真麻烦）\n\n\n\n   漏洞证明：  如上所述   修复方案：  说了这么多，都懂了   版权声明：转载请注明来源 wps2015@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-08-17 09:34 厂商回复： 非常感谢您的支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-15 13:54 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  好隐晦的简要描述    \n     2015-08-15 13:58 |    \t\twps2015 \t\t\t( 普通白帽子  |\t\t\t        Rank:470 漏洞数:63        | 不叫一日荒废)\t\t \n  @动后河 大家都懂得^_^    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}