{"id": 44086, "wybug_id": "wooyun-2015-0109937", "wybug_title": "263通信存在多处越权(可致敏感信息泄露)", "wybug_corp": "263通信", "wybug_author": "男丶壹号", "wybug_date": "2015-04-24 10:07", "wybug_open_date": "2015-05-04 14:29", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-04：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 佛说要有光 详细说明：  上次的支付问题，果然把我的100块收回去了哈，还剩1毛~~\n\n问题概括：EM管理平台存在多处越权，可查询公司所有人员的通话记录，短信记录和内容，充值账单。EM管理平台，通话记录查询：http://ma.263em.com/callrecord!getCallRecord.actionPost参数：\ntype=1&kssj=&jssj=&call_mail=&lx=&called_mail=&start=0&limit=20&sort=call_mail&dir=DESC\n想试试有没有SQL注入，全手工操作，试了半天，SQL注入没找着。发现type参数赋值为空的话，会查询出公司所有人的通话记录（不知道什么逻辑~~）：\ntype=&kssj=&jssj=&call_mail=&lx=&called_mail=&start=0&limit=20&sort=call_mail&dir=DESC\nlimit是分页条数，改成1000，数据如下，大部分都是其他人的记录：\n\n短信记录查询：http://ma.263em.com/messagerecord!getMessagerecord.action可以查看公司所有人的短信记录，包括短信内容：\n\n信息太过敏感，不发数据了。账单明细：http://ma.263em.com/billquery!ygzdmx.action?userid=test@domain.com&type=1&date=只要修改参数userid即可查询指定用户的账单，消费情况。这里截图用的是admin,无消费记录：\n\n最后，也是最重要的一个问题：欢迎厂商用礼物来安抚我这受伤的心灵。   漏洞证明：  如上所述。   修复方案：  后台逻辑修改，加强数据权限验证。   版权声明：转载请注明来源 男丶壹号@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-04-24 11:10 厂商回复： 漏洞正在修复 最新状态： 2015-05-04：已修复  ", "replys": "漏洞评价：\n评论\n     2015-05-05 23:20 |    \t\tbacktrack丶yao \t\t\t( 普通白帽子  |\t\t\t        Rank:290 漏洞数:107        | \"><img src=x onerror=alert(666666);> <im...)\t\t \n  test    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}