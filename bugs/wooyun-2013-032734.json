{"id": 8646, "wybug_id": "wooyun-2013-032734", "wybug_title": "网趣网上购物系统旗舰版v6.7存储型XSS漏洞", "wybug_corp": "网趣商城", "wybug_author": "鲜香不油腻", "wybug_date": "2013-07-29 19:04", "wybug_open_date": "2013-10-27 19:05", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-29：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-10-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 下载网趣源码找了个xss.... 详细说明：  漏洞类型：持久型xss注册处存在存储xss具体代码：rs(\"username\")=trim(request(\"username\"))rs(\"userpassword\")=md5(trim(request(\"userpassword\")))rs(\"useremail\")=trim(request(\"useremail\"))rs(\"quesion\")=trim(request(\"quesion\"))rs(\"answer\")=md5(trim(request(\"answer\")))rs(\"userzhenshiname\")=trim(request(\"userzhenshiname\"))rs(\"shouhuodizhi\")=trim(request(\"shouhuodizhi\"))rs(\"youbian\")=trim(request(\"youbian\"))rs(\"oicq\")=trim(request(\"oicq\"))rs(\"usertel\")=trim(request(\"usertel\"))rs(\"songhuofangshi\")=trim(request(\"songhuofangshi\"))rs(\"zhifufangshi\")=trim(request(\"zhifufangshi\"))rs(\"adddate\")=now()rs(\"lastlogin\")=now()rs(\"logins\")=1rs(\"reglx\")=1rs(\"jifen\")=0rs(\"jiaoyijine\")=0rs(\"sex\")=1rs(\"userlastip\")=Request.ServerVariables(\"REMOTE_ADDR\")说明：以上变量都只是过滤了空格而已，并没有过滤xss代码。漏洞类型：权限绕过具体代码：request.cookies(\"Cnhww\")(\"username\")说明：在user.asp页面中存在上面这句代码，而且在其他一些页面中也存在这句代码，上面这句代码尽然用cookie来获取用户名，并且还不判断是否存在用户名 而是直接使用了cookie获取的username！它不管cookie获取的是什么都直接使用了，就算是xss代码也执行...碉堡了~！PS：我们可以找个已知的用户，然后用火狐插件修改下username的值就可以了。PS：好了，我们来本地测试下吧，我们用xss打进后台去，首先注册个账号，在注册页面的“您的真实姓名”处填写好xss代码，然后直接注册(其他的自己填)。OK，我们用管理账号登陆后台，到注册看看。真实姓名是空的吧，其实cookie已经到了。我们去cookie网站看看。。看到了吧。。。嘿嘿  我们吧截取的cookie拿到啊D去试试。。。嘿嘿 进去了吧....!!!  附言：其实这个系统还存在注入...   漏洞证明：  \n\n\n\n\n\n   修复方案：  过滤xss代码   版权声明：转载请注明来源 鲜香不油腻@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}