{"id": 13436, "wybug_id": "wooyun-2013-018423", "wybug_title": "50cms个别版本的程序问题导致目录遍历，已搞定官网", "wybug_corp": "云南力诺科技有限公司", "wybug_author": "wefgod", "wybug_date": "2013-03-03 15:28", "wybug_open_date": "2013-04-17 15:29", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-04-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-04-17：\t细节向公众公开  简要描述： 不是IIS的目录遍历 详细说明：  首先这个页面有一个问题，就是没有验证是否登录，比如：\npublic partial class Temple_File : System.Web.UI.Page\n没有继承AdminBase类，所以没有登录的验证；目前开放的源码里面，是做了一点简单过滤（考虑到了../）所以只能浏览跟目录，代码如下：\nprotected void BindData()        {            this.folder = base.Request.QueryString[\"folder\"];            if (string.IsNullOrEmpty(this.folder))            {                this.FileList.DataSource = GetFileList(base.Server.MapPath(this.lockpath + this.folder));                this.DataBind();            }            else            {                if (!(this.folder.IndexOf(\"../\") > -1))                {                    this.FileList.DataSource = GetFileList(base.Server.MapPath(this.lockpath + this.folder));                    this.DataBind();                            }                        }        }\n但是官网本身的版本较低，所以没有做任何过滤，浏览完了网站目录以后，把打包的站点一下，看了看数据库……OK，后台搞定   漏洞证明：  官网：http://www.50cms.com/Admin/class/temple_file.aspx?folder=/..\n\n下载那个wwwroot。搞搞进后台，搞搞拿到shell：\n\n测试站：http://test.50cms.com/Admin/class/temple_file.aspx?folder=/..\n\n   修复方案：  1.没有验证登录就不多说了，继承你们那个父类就好2.过滤的时候选..就好，别后面加一个/，这样至少可以浏览一个根目录，然后官网本身的程序干嘛不跟上更新？   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2013-03-03 15:56 厂商回复： 感谢对50cms 的关注，本系统是个开源免费的东东，因此发展离不开大家的关心和关爱，最新版本已经修补上该漏洞，可在官网瞎子，演示网站由于服务器放香港，故没更新最新程序，是我们是疏忽。再次感谢对本程序的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-03 16:02 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  哦，一刷新就确认了，不错哦！厂商态度很好，下次还有的话会继续提交给你们的！    \n     2013-03-03 16:51 |    \t\tnoah \t\t\t( 普通白帽子  |\t\t\t        Rank:384 漏洞数:40        )\t\t \n  test.xxx.xxx那个站在系统管理处可以修改允许上传的格式，直接上传拿WEBSHELL，不知道上面知否有这个站，没有的话厂商一起修复了吧，    \n     2013-03-03 17:14 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @noah 有这个问题。不过不知道他们会不会改    \n     2013-03-06 11:39 |    \t\t云南力诺科技有限公司(乌云厂商)\t\t \n  已经修复了不能修改 其他格式了 请大家手下留情啊，开源代码需要大家呵护    \n     2013-03-06 11:47 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @云南力诺科技有限公司 嗯。修复了就好    \n     2013-03-31 06:06 |    \t\tmOon \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 上线非本人，请勿打扰！)\t\t \n  额 求交流    \n     2013-03-31 11:21 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @mOon 不好意思不擅长ASP    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}