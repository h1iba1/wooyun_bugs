{"id": 9180, "wybug_id": "wooyun-2013-034901", "wybug_title": "搜房某后台post型sql盲注漏洞一枚", "wybug_corp": "搜房网", "wybug_author": "shack2", "wybug_date": "2013-08-21 16:19", "wybug_open_date": "2013-10-05 16:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-05：\t细节向公众公开  简要描述： 某后台OR型盲注 详细说明：  找回密码处，用户名username参数未过滤导致盲注http://home.www2.soufun.com/pwdapply.php发送邮件找回密码逻辑：select pwd from user where email='邮箱';发送密码到邮箱通过or来判断是否存在sql注入select pwd from user where email='5' or 'a'='a';肯定能查询到数据1.输入一个用户找回密码，看提示\n\n2.提示此用户不存在\n\n3.输入：a' or 'a'='a\n\n4.提示：此用户不能自助重置\n\n5.输入：a' or 'a'='b\n\n6.提示：提示此用户不存在\n\n输入：a' or 'a'='b正常输入:5提示一样，和输入：a' or 'a'='a不同证明此处存在SQL注入判断是否mysql数据库：\nusername=5' or(1=1 and select * from information_schema.tables) and 'a'='a提示：此用户不能自助重置，证明是mysql数据库通过ascii转换截取单个查询的数据库内容，判断大小，可以进行盲注\n数据库就不跑了，证明存在漏洞即可   漏洞证明：  找回密码处，用户名username参数未过滤导致盲注http://home.www2.soufun.com/pwdapply.php发送邮件找回密码逻辑：select pwd from user where email='邮箱';发送密码到邮箱通过or来判断是否存在sql注入select pwd from user where email='5' or 'a'='a';肯定能查询到数据1.输入一个用户找回密码，看提示\n\n2.提示此用户不存在\n\n3.输入：a' or 'a'='a\n\n4.提示：此用户不能自助重置\n\n5.输入：a' or 'a'='b\n\n6.提示：提示此用户不存在\n\n输入：a' or 'a'='b正常输入:5提示一样，和输入：a' or 'a'='a不同证明此处存在SQL注入判断是否mysql数据库：\nusername=5' or exists(select * from information_schema.tables) and 'a'='a提示：此用户不能自助重置，证明是mysql数据库通过ascii转换截取单个查询的数据库内容，判断大小，可以进行盲注\n数据库就不跑了，证明存在漏洞即可   修复方案：  过滤sql注入关键字符：',or,and,select,union等   版权声明：转载请注明来源 shack2@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-08-21 17:46 厂商回复： 已经通知程序员修改，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-21 16:38 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  好像mysql版本很低，你有跑出数据吗。    \n     2013-08-21 17:01 |    \t\tshack2 \t\t\t( 普通白帽子  |\t\t\t        Rank:470 漏洞数:71        | QQ:1341413415 一个热爱编程(Java),热爱网...)\t\t \n  5.1的哟    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}