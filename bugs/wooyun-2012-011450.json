{"id": 17873, "wybug_id": "wooyun-2012-011450", "wybug_title": "URL Redirection Bug &amp; Possible SQL注射BUG in 佳品网", "wybug_corp": "佳品网", "wybug_author": "Gunther", "wybug_date": "2012-08-28 15:29", "wybug_open_date": "2012-09-02 15:29", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-02：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： There are URL Redirection Bugs & Possible SQL注射BUG in 佳品网 详细说明：  Possible SQL注射BUG is found here:http://www.jiapin.com/listgoods/index/cat_id/+union+select+1,2,+--http://www.jiapin.com/listgoods/index/cat_id/+sleep(1)%23\nAccessing that url and you will see the following error:SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'union select 1,2, --;#sqlEye::http://www.jiapin.com/listgoods/index/cat_id/+unio' at line 1#0 /www/goods/library/Zend/Db/Statement.php(320): Zend_Db_Statement_Pdo->_execute(Array)#1 /www/goods/library/Zend/Db/Adapter/Abstract.php(481): Zend_Db_Statement->execute(Array)#2 /www/goods/library/Zend/Db/Adapter/Pdo/Abstract.php(238): Zend_Db_Adapter_Abstract->query('select cat_id,c...', Array)#3 /www/goods/library/Zend/Db/Adapter/Abstract.php(738): Zend_Db_Adapter_Pdo_Abstract->query('select cat_id,c...', Array)#4 /www/goods/application/default/models/SeoModel.php(37): Zend_Db_Adapter_Abstract->fetchAll('select cat_id,c...')#5 /www/goods/application/default/models/SeoModel.php(62): SeoModel->seo_search_lists(' union select 1...')#6 /www/goods/application/default/controllers/ListgoodsController.php(30): SeoModel->seo_TDK(' union select 1...', NULL, NULL, Array)#7 /www/goods/library/Zend/Controller/Action.php(513): ListgoodsController->indexAction()#8 /www/goods/library/Zend/Controller/Dispatcher/Standard.php(295): Zend_Controller_Action->dispatch('indexAction')#9 /www/goods/library/Zend/Controller/Front.php(954): Zend_Controller_Dispatcher_Standard->dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http))#10 /www/goods/html/bootstrap.php(102): Zend_Controller_Front->dispatch()#11 /www/goods/html/bootstrap.php(31): Application->dispatch()#12 /www/goods/html/index.php(75): Application->__construct(Array)#13 {main}\nSeverity: URL Redirection bugConfidence: ConfidentHost: http://user.jiapin.com/Path: /pageview/pos?app=from_tag&url=http://www.jiapin.com/list/14565.htmlIssue detail:This is considered quite serious if it's in a consumer type of website as attackers can make use of this to redirect victims to another website.Ok, the flaw is that the original url will look like the followinghttp://user.jiapin.com/pageview/pos?app=from_tag&url=http://www.jiapin.com/list/14565.htmlHowever, an attacker can change the final url to the followinguser.jiapin.com/pageview/pos?app=from_tag&url=http://ebay.deIf attackers have exploit kit, they can redirect victims to their website, fire up an iframe showing the original content from jiapin.comAfter they had exploited or trojanised the victim, just do another redirect to the original website.This way, victims will not notice much. :D In my test case, i redirect user(s) to ebay.de :DThe other URL Redirection bug could be found here:http://user.jiapin.com/cps/cpslogin/together/c5ac81fe5e0d6246dcb4c769ead4c3ea?url_t=http://news.jiapin.com/html/zx/jiapinguandi/2012/0822/6690.htmlSimilarly, if you replace http://news.jiapin.com/html/zx/jiapinguandi/2012/0822/6690.htmlwith http://ebay.de and the final url look like this:http://user.jiapin.com/cps/cpslogin/together/c5ac81fe5e0d6246dcb4c769ead4c3ea?url_t=http://ebay.deVictims will be redirected to eBay.de instead   漏洞证明：  Or the image below\n\n   修复方案：     版权声明：转载请注明来源 Gunther@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-09-02 15:29 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-08-28 16:04 |    \t\tMichael \t\t\t( 实习白帽子  |\t\t\t        Rank:87 漏洞数:24        )\t\t \n  标题风格咋变了。    \n     2012-08-28 19:43 |    \t\t瓜瓜 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:25        )\t\t \n  肿么成汉语了    \n     2012-08-28 20:08 |    \t\tGunther \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:10        | [ Gunther ])\t\t \n  有時需要練習我的廣東話    \n     2012-08-28 20:56 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  = = ...    \n     2012-08-28 21:58 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @xsser 佳品网是不是失去联系了，有个漏洞视乎要公开了    \n     2012-08-29 09:23 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  @Gunther 祖籍广东的华侨？    \n     2012-08-29 18:00 |    \t\tInset \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | 闲来无事，到处逛逛！)\t\t \n  广东？不理解！    \n     2012-08-29 22:48 |    \t\tGunther \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:10        | [ Gunther ])\t\t \n  祖先来自广东    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}