{"id": 46413, "wybug_id": "wooyun-2015-091169", "wybug_title": "中国通用旅游（我要去遛遛）网高危SQL注入+百万数据信息之三", "wybug_corp": "51766旅游网", "wybug_author": "Ch4r0n", "wybug_date": "2015-01-11 12:14", "wybug_open_date": "2015-02-25 12:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-11：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-02-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 继续测试，又发现一处参数未过滤，而且获取的用户、数据库等都要比前两个多，毕竟在admin目录下的原因？1、参数未过滤，存在注入2、比上两个注入点获取的用户和数据库多3、SA权限，可以获取数据库用户和密码PS：51766旅游网算是大厂商还是小厂商呢？估计又会被走小厂商流程了？ 详细说明：  1、注入点\nhttp://www.51766.com/admin/shopSelf/seniority.jsp?custclass=6&prov_id=100\n参数custclass未过滤，存在boolean-based blind&error-based注入2、上sqlmap\n\n\n\n\n\n3、获取数据库信息\n\n\n\n\n\n\n\n\n\n4、数据库权限、用户名和密码\n\n\n\n\n\n   漏洞证明：  \n\n数百万记录可以dump像数据库中含有LOG、LOGIN、USR、MEMBER、ADMIN、USER、INFO等表段或多或少可以获取用户信息，上千、上万甚至百万不等，同时也有敏感的数据库比如SYS、SAAS2、SYSTEM、SAASADMIN、STAT等等，貌似如果真要一个个看，估计都会有很多信息被利用，所以还是快快过滤参数！数据库权限过大，同时数据库密码过于简单！~~~\n\n\n\n\n\n   修复方案：  1、过滤，防注入2.安全狗3、加强密码4、修改数据库权限5、其实这个我也不知道，你们比我懂！~~~   版权声明：转载请注明来源 Ch4r0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2015-02-25 22:13 |    \t\tCh4r0n \t\t\t( 普通白帽子  |\t\t\t        Rank:391 漏洞数:87        | 苦逼青年一个！~~~)\t\t \n  被厂商忽略了，不知道修复没有，不测试了！~~~    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}