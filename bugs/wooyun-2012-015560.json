{"id": 15086, "wybug_id": "wooyun-2012-015560", "wybug_title": "畅途网手机找回密码漏洞和ddos邮件服务器问题", "wybug_corp": "畅途网", "wybug_author": "小胖胖要减肥", "wybug_date": "2012-12-03 17:29", "wybug_open_date": "2013-01-17 17:30", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-12-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-17：\t细节向公众公开  简要描述： 听说有礼物，测试了一下，2个地方有漏洞，还有一个设计问题，不验证的用户是不能通过邮件找回密码，如果业务上不验证的用户也可以下单，那就是一个很大的业务权限，用户忘记密码且消费后根本无法找回密码 详细说明：  首先登陆首页，看到找回密码，看到了手机找回，就想到了暴力破解，结果一看get方式，以为没戏，就先试试\n\n选择自己的手机号发送验证码，随便输入个验证码，查看post信息，截断\n\n暴力破解验证码，返回了一个成功的信息\n\n因为之前用其他手机号找回过密码，get的地址就保存了下来，统一地址，在爆破成功后使用该地址登录，尝试修改密码\n\n点击确定，结果成功了，再打开这个也没，再修改，再提交，又成功了\n\n确定get方式只要一次输对验证码后就能使用这个get地址   漏洞证明：  然后再看看邮箱找回密码问题，试了一下，没问题，但想起我发了很多的ddos邮件服务器，剑心对这个不太重视，之后我会提交一个详细说一下这个的危害性，人家都可以吧这个写论文呢好了，打开页面\n\n页面上只能发一次，但我可以用post嘛\n\n没用burp，burp直接参数化numbers就可执行ddos攻击，接着查看邮箱吧，之前已经设置黑名单，不想收太多垃圾邮件了\n\n   修复方案：  问题1的修复方案我感觉还是post比较好，除非你get真的逻辑没有漏洞问题2的修复方式就是限制同一邮箱每天发送次数只为求个礼物，没仔细测试，提了那么多就没厂商给下礼物吗   版权声明：转载请注明来源 小胖胖要减肥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-12-03 21:41 厂商回复： 非常感谢。请站内短信留下联系方式及真实姓名以便发放礼品 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-03 21:53 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  已发送，不知道是什么礼物    \n     2012-12-04 08:57 |    \t\t小试牛刀 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | WHO IM I)\t\t \n  @小胖胖要减肥 不错啊礼物到手@畅途网 WooYun: 畅途网某后台弱口令 这个不用去认领？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}