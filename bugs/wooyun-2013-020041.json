{"id": 12281, "wybug_id": "wooyun-2013-020041", "wybug_title": "SiteServer cms Cookie欺骗漏洞", "wybug_corp": "SiteServer cms", "wybug_author": "节奏感", "wybug_date": "2013-03-14 10:43", "wybug_open_date": "2013-06-12 10:44", "wybug_type": "地下0day/成功的入侵事件", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "欺骗"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-14：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-06-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： .net平台的SiteServer cms他的功能强大是无庸置疑的，但问题也不少，此次发现的cookis欺骗一枚  经测试，3.44以上版本通杀 详细说明：  \n\n本地搭建了一个环境  然后登陆抓取管理cookis然后又删管理员 换帐号换密码清空cookis 在登陆的时候发现cookis的值就只有useradmin=admin这个变化为当前的帐号 因此大胆判断 cookis应该是赋的固定值 BAIRONG.VC.ADMINLOGIN=6887; SITESERVER.ADMINISTRATOR.AUTH=0F7B10036E9FF94D33C4BE742E7D281E1BE923AEBB391E74FDB29EBCD0562DA027A340852E7CCAAAEAD4CA1EC30DF07E90A2CE42E5D862C84E1B06694F0C7A09788B7EE26000E7CBD14DE6AAE8E540BE403328B18792B24315DE96818A63D90CF8160F2DBCF97883216714E8AC81D63D0933DCBE; SITESERVER.ADMINISTRATOR.USERNAME=admin; lzstat_uv=28995594273945333853|677603; 然后测试 发现只要USERNAME=admin 目标站点里确实有管理员admin 就可进行cookis欺骗登入   漏洞证明：  \n\n\n\n\n\n随后连续测试了几个3.44版本 发现确实上述说的那样useraaname=管理员帐号 cookis里这条正确 就可欺骗登入 后台文件管理处 不可上传aspx  但在新建处 可任意创建 传马菜刀 完事   修复方案：  加密加密  过滤过滤,,,,,,,     版权声明：转载请注明来源 节奏感@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-03-14 15:18 |    \t\tcoco \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:1        | 授权安全测试服务)\t\t \n  再次关注下    \n     2013-08-12 21:19 |    \t\tnick被注册 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:19        | 天一)\t\t \n  没有测试成功。。    \n     2014-01-08 16:43 |    \t\t节奏感 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 这地方真合适我  能共同进步 共同奋斗 共同...)\t\t \n  @nick被注册 这个都早了 我5个月没测试了 估计还有部分3.44以上版本未修补把    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}