{"id": 55348, "wybug_id": "wooyun-2014-061253", "wybug_title": "GXCMS(光线cms) 注入一枚。", "wybug_corp": "光线CMS", "wybug_author": "′雨。", "wybug_date": "2014-05-19 19:38", "wybug_open_date": "2014-08-17 19:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-19：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-08-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 光线cms跟飞飞还挺像的。一起挖一下。 详细说明：  在core/lib/action/home/hitsaction.class.php中\npublic function show(){\t\t$id\t  = intval($_GET['id']);\t\t$mid  = trim($_GET['mid']);\t\t$type = trim($_GET['type']);\t\t$rs   = M($mid);\t\t$array = $rs->field('id,hits,monthhits,weekhits,dayhits,hitstime')->where('id='.$id)->find();\t\tif($array && $type == 'insert'){\t\t\tif(C('web_hits_way')){\t\t\t$this->hits_insert_adv($mid,$array);\t\t\t}else{\t\t\t$this->hits_insert($mid,$array);\t\t\t\t}\t\t}else{\t\t\tif($array){\t\t\t\t\t\techo(\"document.write('\".$array[$type].\"');\");\t\t\t}else{\t\t\t\techo(\"document.write('0');\");\t\t\t}\t\t}    }\n这里mid可控 且没有限制。 直接做的table让mid为asd 此时执行的语句为SELECT id,hits,monthhits,weekhits,dayhits,hitstime FROM gx_asd可以看到是表的后面一部分可控。首先补全一下表 这个表需要存在前面的这些column看了下是gx_info。而且测试后发现 如果特殊字符全部为大写 例如SELECT 变成_S_E_L_E_C_T但是小写就没问题。然后就是不能使用逗号。 使用逗号的话会被加上反引号。。。   漏洞证明：  \n\n\n\n   修复方案：  限制。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}