{"id": 15621, "wybug_id": "wooyun-2012-014405", "wybug_title": "Siteserver cms某处SQL注入漏洞", "wybug_corp": "北京百容千域软件技术开发有限公司", "wybug_author": "Nohat", "wybug_date": "2012-11-06 10:36", "wybug_open_date": "2012-12-21 10:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-01-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-21：\t细节向公众公开  简要描述： 最新程序版本3.5也存在此漏洞，官网测试成功，可到服务器权限。 详细说明：  1、以下页面存在注入点：\nhttp://demo2.siteserver.cn/LiveFiles/Pages/Inner/count.aspx?ModuleType=Count&UserModuleClientID=ctl00_ctl00_TemplateHolder_ContentHolder_ctl08&userName=friends%27%20and%20%271%27=%271\n\n\n2、注啊注：\n\n3、到这里，有两条分支可以走：（1）直接利用数据库安全配置问题来读目录、写shell等\n\n写文件就没截图了，反正就是利用数据库写文件到web目录，或非web目录（2）读取管理员帐户密码登录后台添加模板，直接添加aspx的单文件模板。ps：管理密码是加密的，没关系，我们插入一个密码找回的答案就可以去后台登录页面找回密码了（加密方式可逆、亲民）\n\n\n\n然后后台插模版写shell图可能有点乱，各种子域名都有，因为官网多数子域名存在该漏洞，主站www.siteserver.com没有本来不想发到这里公开的，毕竟开源cms不比单独某个站点，一旦公开，使用者都有可能受到影响。所以希望wooyun能够谨慎公开、厂商能够及时督促用户更新程序。借wooyun客服回复我的话：\n2 所有漏洞都会在厂商处理后45天公开的，对于你提到的cms的问题，如果的确是有安全问题就应该第一时间让厂商进行修复，因为很可能你并不是第一个发现这个安全问题的人，厂商应该建立合适的渠道去通知自己的用户修复此安全问题。\n半路出家，不专业之处还请包涵   漏洞证明：  菜刀图\n\n\n\n   修复方案：  最新版本3.5都存在此漏洞，还能怎么办？我是学美术的，半路出家，还不懂怎么防注入，但是我知道，删除 /LiveFiles/Pages/Inner/count.aspx一定管用功能强大之后不能忘了安全   版权声明：转载请注明来源 Nohat@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2012-11-07 18:58 厂商回复： 经过近日测试，在siteserver CMS官方站点上未复现漏洞情况(根据图片确认)。根据CMS软件特征及用户列表找寻互联网上实例时，实际测得一例存在注入漏洞，与官方网站安全可确认为通用软件漏洞。将在8日由CNVD直接联系生产厂商处置，同时将继续测试和确认采用该CMS的用户网站列表，视是否存在重要部门用户采取其他处置流程。按完全影响机密性进行评分，（是否可提权需要看网站个例配置情况），基本危害评分7.79，发现技术难度系数1.1(通用软件漏洞)，涉及行业或单位影响系数1.6（可能涉及多家政府和重要信息系统部门及广大企业网站），综合rank=7.79*1.1*1.6=13.710 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-15 00:23 |    \t\tl4mbda \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:3        | 嘘嘘)\t\t \n  求密码逆算方法    \n     2013-04-17 23:18 |    \t\tNohat \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:4        )\t\t \n  @l4mbda 只知道他的算法是可逆的，具体内容我也不清楚。但是通过密码找回功能就可以看到密码的明文（因为前面通过注入已经得密码找回的答案）    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}