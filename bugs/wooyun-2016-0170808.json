{"id": 72723, "wybug_id": "wooyun-2016-0170808", "wybug_title": "263某站配置不当可读取系统代码", "wybug_corp": "263通信", "wybug_author": "路人甲", "wybug_date": "2016-01-18 14:59", "wybug_open_date": "2016-01-18 16:58", "wybug_type": "系统/服务运维配置不当", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-18：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述：  详细说明：   WooYun: 263企业邮箱某站命令执行ROOT权限 http://211.150.74.101/\n\nhttp://211.150.74.101/WEB-INF/classes/log4j.properties\n\n查看web.xmlhttp://211.150.74.101/WEB-INF/web.xml\n\napplicationContext.xmlhttp://211.150.74.101/WEB-INF/classes/applicationContext.xml\n\nhttp://211.150.74.101/WEB-INF/classes//conf/spring/loginSpring.xml\n\n然后就能得到被编译过的java文件\n<bean id=\"loginAction\" class=\"com.xmail.wm.login.action.LoginAction\" scope=\"prototype\"><property name=\"loginService\" ref=\"loginService\"/><property name=\"mailOperateService\" ref=\"mailOperateService\"/><property name=\"userParamService\" ref=\"userParamService\"/><property name=\"domainLocationService\" ref=\"domainLocationService\"/></bean>\n访问http://211.150.74.101/WEB-INF/classes//com/xmail/wm/login/action/LoginAction.class则直接将代码下载查看代码\n\n\nimport com.xmail.wm.addressBook.service.PersonAddressBookService;import com.xmail.wm.base.struts2.base.action.BasicAction;import com.xmail.wm.common.converCode.CodeUtil;import com.xmail.wm.common.file.FileUtil;import com.xmail.wm.common.lanage.LanageUtil;import com.xmail.wm.common.servlet.ServletUtil;import com.xmail.wm.common.session.SessionUtil;import com.xmail.wm.common.session.vo.SessionVO;import com.xmail.wm.common.userinfo.UserInfoUtils;import com.xmail.wm.domainLocation.service.DomainLocationService;import com.xmail.wm.loadconfig.LoadConfigGroupInfo;import com.xmail.wm.loadconfig.LoadConfigWmLimits;import com.xmail.wm.loadconfig.LoadConfigWmMain;import com.xmail.wm.loadconfig.vo.GroupInfoConfigVO;import com.xmail.wm.loadconfig.vo.WmIspConfigVO;import com.xmail.wm.loadconfig.vo.WmLimitsConfigVO;import com.xmail.wm.loadconfig.vo.WmMainConfigVO;import com.xmail.wm.login.service.LoginService;import com.xmail.wm.login.vo.LoginRolesVO;import com.xmail.wm.login.vo.LoginVO;import com.xmail.wm.mailIndex.service.MailOperateService;import com.xmail.wm.mailSetting.service.UserParamService;import com.xmail.wm.mailSetting.service.impl.UserParamServiceImpl;import com.xmail.wm.mailSetting.vo.UserParamVO;\n也可以根据导入的包来下载文件这里就不继续了   漏洞证明：   WooYun: 263企业邮箱某站命令执行ROOT权限 http://211.150.74.101/\n\nhttp://211.150.74.101/WEB-INF/classes/log4j.properties\n\n查看web.xmlhttp://211.150.74.101/WEB-INF/web.xml\n\napplicationContext.xmlhttp://211.150.74.101/WEB-INF/classes/applicationContext.xml\n\nhttp://211.150.74.101/WEB-INF/classes//conf/spring/loginSpring.xml\n\n然后就能得到被编译过的java文件\n<bean id=\"loginAction\" class=\"com.xmail.wm.login.action.LoginAction\" scope=\"prototype\"><property name=\"loginService\" ref=\"loginService\"/><property name=\"mailOperateService\" ref=\"mailOperateService\"/><property name=\"userParamService\" ref=\"userParamService\"/><property name=\"domainLocationService\" ref=\"domainLocationService\"/></bean>\n访问http://211.150.74.101/WEB-INF/classes//com/xmail/wm/login/action/LoginAction.class则直接将代码下载查看代码\n\n\nimport com.xmail.wm.addressBook.service.PersonAddressBookService;import com.xmail.wm.base.struts2.base.action.BasicAction;import com.xmail.wm.common.converCode.CodeUtil;import com.xmail.wm.common.file.FileUtil;import com.xmail.wm.common.lanage.LanageUtil;import com.xmail.wm.common.servlet.ServletUtil;import com.xmail.wm.common.session.SessionUtil;import com.xmail.wm.common.session.vo.SessionVO;import com.xmail.wm.common.userinfo.UserInfoUtils;import com.xmail.wm.domainLocation.service.DomainLocationService;import com.xmail.wm.loadconfig.LoadConfigGroupInfo;import com.xmail.wm.loadconfig.LoadConfigWmLimits;import com.xmail.wm.loadconfig.LoadConfigWmMain;import com.xmail.wm.loadconfig.vo.GroupInfoConfigVO;import com.xmail.wm.loadconfig.vo.WmIspConfigVO;import com.xmail.wm.loadconfig.vo.WmLimitsConfigVO;import com.xmail.wm.loadconfig.vo.WmMainConfigVO;import com.xmail.wm.login.service.LoginService;import com.xmail.wm.login.vo.LoginRolesVO;import com.xmail.wm.login.vo.LoginVO;import com.xmail.wm.mailIndex.service.MailOperateService;import com.xmail.wm.mailSetting.service.UserParamService;import com.xmail.wm.mailSetting.service.impl.UserParamServiceImpl;import com.xmail.wm.mailSetting.vo.UserParamVO;\n也可以根据导入的包来下载文件这里就不继续了   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2016-01-18 16:57 厂商回复： 下线设备，但遗留生产文件。感谢。 最新状态： 2016-01-18：已经关闭服务。谢谢。  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}