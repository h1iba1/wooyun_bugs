{"id": 19328, "wybug_id": "wooyun-2012-07293", "wybug_title": "淘宝网某处存在严重支付漏洞", "wybug_corp": "淘宝网", "wybug_author": "imlonghao", "wybug_date": "2012-05-18 20:23", "wybug_open_date": "2012-07-02 20:24", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感操作逻辑错误", "点卡", "支付行业敏感", "支付安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-05-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-06-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-06-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-02：\t细节向公众公开  简要描述： 淘宝网某处存在支付漏洞，未使用SSL加密支付过程，同时，对支付过程相关代码的审计存在一定缺陷，导致漏洞产生。会导致允许用户对支付金额进行修改，给厂商带来很大的利益损失。 详细说明：  在阿里旺旺2012中，使用短信旺旺中心对短信条数进行充值，在该过程中，未使用SSL安全连接，同时存在支付漏洞。选择充值的金额后，下一步，使用FID截取数据包，GBK编码，修改POST数据中的数据，seriesPrice为支付的金额，seriesNum为充值的条数，这两个地方理论上都可以进行修改，这里以修改seriesPrice为例。   漏洞证明：  充值前截图\n\n选择充值的套餐\n\n修改FID截取数据包，并修改seriesPrice参数,RUN\n\n以下为过程，不必多说\n\n\n\n\n\n\n\n   修复方案：  使用SSL对支付过程进行加密只POST购买的条数，在服务器端处理所需要支付的金额，不直接POST金额和条数   版权声明：转载请注明来源 imlonghao@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-05-18 22:51 厂商回复： 非常感谢白帽子imlonghao的帮助，淘宝安全团队已经在紧急排查此漏洞。请白帽子imlonghao站内短信联系我们，我们将发放小礼物。 最新状态： 2012-05-21：周五晚紧急下线此应用，周六上午修复并重新上线；经过数据库排查发现仅有一次利用，业务团队已将错误数据更正，请白帽子imlonghao检查；  ", "replys": "漏洞评价：\n评论\n     2012-05-18 20:39 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  哈哈，淘宝也中枪？    \n     2012-05-18 20:41 |    \t\t斯文的鸡蛋 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:41        | 我在这头，你在那头~)\t\t \n  先碉堡一个    \n     2012-05-18 20:41 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @Z-0ne 某个地方，当然不会是淘宝网主站购买东西的.........    \n     2012-05-18 20:52 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  我信洞主！    \n     2012-05-18 22:40 |    \t\t小一 \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:13        )\t\t \n  @imlonghao 骚年你真猛。。。。    \n     2012-05-18 22:59 |    \t\tJannock  \t\t\t( 核心白帽子 |\t\t\t        Rank:2278 漏洞数:204        | 关注技术与网络安全（招人中，有兴趣请私信...)\t\t \n  又有礼物收，真好。。    \n     2012-05-18 23:06 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  必马    \n     2012-05-18 23:15 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @Jannock 膜拜乌云第一的神！淘宝通常会送什么？    \n     2012-05-18 23:18 |    \t\tJannock  \t\t\t( 核心白帽子 |\t\t\t        Rank:2278 漏洞数:204        | 关注技术与网络安全（招人中，有兴趣请私信...)\t\t \n  我也没收过。。    \n     2012-05-18 23:31 |    \t\txnet \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:11        | 工作～～)\t\t \n  我也要小礼物 :)    \n     2012-05-18 23:43 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  洞主是职业支付绕过师！！    \n     2012-05-19 00:45 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  楼上是首席跨站师。      \n     2012-05-19 00:47 |    \t\t冰锋刺客 \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:14        | 请在监护人陪同下与本人交流)\t\t \n  淘宝也有此漏洞啊，嘻嘻 ^_^    \n     2012-05-19 05:45 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @gainover 你是专业跨站师！    \n     2012-05-19 05:48 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @Jannock  你一个小米发的礼物都抵N个礼物了。我猜会送猫，因为天猫    \n     2012-05-19 11:45 |    \t\tTopman王 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:6        | 软件开发工程师!白帽子!XSSER,渗透,SEO)\t\t \n  淘宝的是什么礼物imlonghao@乌云    \n     2012-05-19 17:55 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  应该是淘宝环保小玩偶。    \n     2012-05-20 00:10 |    \t\tgoderci \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:47        | http://www.yunday.org)\t\t \n  25厘米的公仔！    \n     2012-05-21 17:07 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @imlonghao 大神，唯一一次利用！    \n     2012-05-21 22:59 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @一刀终情 你想表达什么    \n     2012-05-29 11:12 |    \t\tubuntu \t\t\t( 普通白帽子  |\t\t\t        Rank:148 漏洞数:12        | 一切皆有可能……)\t\t \n  @Jannock 厉害呀，哥们，那么多rank    \n     2012-06-07 23:16 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  我勒个去。还是这样的方法。    \n     2012-06-07 23:43 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @zeracker 这样多了也的确有点闷，大大勿喷啊，301你名字干嘛倒着写，哈哈。    \n     2012-06-07 23:43 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @zeracker 这样多了也的确有点闷，大大勿喷啊，301你名字干嘛倒着写，哈哈。    \n     2012-06-08 00:25 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @imlonghao — — 俺也不知道。    \n     2012-06-18 01:19 |    \t\tcircus \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:4        | 你会为一件事去说一句话,也会为一句话去干...)\t\t \n  我想问是用什么抓包的。    \n     2012-06-18 14:34 |    \t\tHenry:bobo \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:22        | 本胖吊！~又高又肥2个奶奶像地雷)\t\t \n  Fiddler汉化版 嘿嘿= =     \n     2012-06-18 19:14 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  碉堡    \n     2012-06-18 19:14 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  验证码。。    \n     2012-06-18 20:40 |    \t\tHenry:bobo \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:22        | 本胖吊！~又高又肥2个奶奶像地雷)\t\t \n  最近FID 太火了 ！！！！！！！ 一群黑阔用这个修改着 大型网站的 付费金额    \n     2012-06-18 21:45 |    \t\trandom_ \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:50        | 推动开源推动网络安全)\t\t \n  服务端没验证钱和对应的物资的关系？    \n     2012-06-19 15:02 |    \t\t小猪太子 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:8        | 地球人)\t\t \n  我比较关注的是什么礼物？    \n     2012-06-19 15:05 |    \t\tTopman王 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:6        | 软件开发工程师!白帽子!XSSER,渗透,SEO)\t\t \n  我比较关注淘宝的是什么礼物？    \n     2012-06-19 18:03 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  公仔。    \n     2012-07-02 23:08 |    \t\t顺子 \t\t\t( 普通白帽子  |\t\t\t        Rank:236 漏洞数:36        | 0-0努力像正常青年靠近，再也不当上错图的2...)\t\t \n  :)关注    \n     2012-07-03 10:14 |    \t\tMr.杨总 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 绿色 无毒  你懂得。。。。心要宽 。。。)\t\t \n   经过数据库排查发现仅有一次利用    \n     2012-07-03 10:40 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Mr.杨总 but who knows    \n     2014-04-11 16:55 |    \t\t小贱人 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 资深菜鸟，)\t\t \n  mark 牛逼啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}