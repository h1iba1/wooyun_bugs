{"id": 13562, "wybug_id": "wooyun-2013-019141", "wybug_title": "四川省商务厅各种安全隐患导致被入侵", "wybug_corp": "四川省商务厅", "wybug_author": "小胖子", "wybug_date": "2013-02-25 10:34", "wybug_open_date": "2013-04-11 10:35", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "渗透测试思路", "管理后台对外"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-02-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-03-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-03-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-04-11：\t细节向公众公开  简要描述： 纯粹检测，拒绝查水表，Gov网站也需要进步啊。@se55i0n  这次不会错了吧～ 详细说明：  一步一步的问题延续至最终拿到webshell，不提权。http://www.sccom.gov.cn/webexam/UserFiles/CkeditorFiles/Image/201302/20130224233701325.jsp请删除。问题一，注入：注入地址：http://www.sccom.gov.cn/xxfb/wsbs.do?method=enterWsbs&type=2&lm=wsbs&ksbm=  注入参数： ksbm数据库类型：Oracle\n\n非DBA，jsp，oracle。数据库user:\ndatabase management system users [27]:[*] ANONYMOUS[*] CTXSYS[*] DBSNMP[*] DIP[*] DMSYS[*] EXFSYS[*] MDDATA[*] MDSYS[*] MGMT_VIEW[*] OLAPSYS[*] ORDPLUGINS[*] ORDSYS[*] OUTLN[*] SCJC_DBA[*] SCOTT[*] SI_INFORMTN_SCHEMA[*] SWRC[*] SWRC_DBA[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WEBEXAM_DB[*] WMSYS[*] WSZS_DBA[*] XDB[*] XXFB_DBA\n数据库：available databases [20]:\n[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXFSYS[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SCJC_DBA[*] SCOTT[*] SWRC_DBA[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WEBEXAM_DB[*] WMSYS[*] WSZS_DBA[*] XDB[*] XXFB_DBA\n然后突然看到一个地址，在线考试：http://www.sccom.gov.cn/webexam/还有管理地址，果断看看考试的数据库。\n在线考试数据库Database: WEBEXAM_DB[18 tables]+-------------------+| BT_ARTICLE        || BT_MESSAGE        || BT_PAPER          || BT_QUESTION       || BT_SCORE          || BT_VIDEO          || ST_CHANNEL        || ST_CONSOLE_LOG    || ST_DICTIONARY     || ST_DICTIONARYKIND || ST_MODULE         || ST_ORGAN          || ST_ROLE           || ST_STATS          || ST_USER           || ST_USER_AND_ORGAN || ST_USER_AND_ROLE  || ST_WEBFRONT_LOG   |+-------------------+User表Database: WEBEXAM_DBTable: ST_USER[23 columns]+--------------------+----------+| Column             | Type     |+--------------------+----------+| FD_BM              | VARCHAR2 || FD_CREATEDBY       | VARCHAR2 || FD_CREATEDTIME     | DATE     || FD_CSNY            | DATE     || FD_DELETETAG       | VARCHAR2 || FD_DW              | VARCHAR2 || FD_EMAIL           | VARCHAR2 || FD_JOB_LEVEL       | VARCHAR2 || FD_LASTUPDATEDBY   | VARCHAR2 || FD_LASTUPDATEDTIME | DATE     || FD_LOGINID         | VARCHAR2 || FD_ORGAN           | VARCHAR2 || FD_PASSWORD        | VARCHAR2 || FD_PERMIT          | VARCHAR2 || FD_QQ              | VARCHAR2 || FD_QX              | VARCHAR2 || FD_REALNAME        | VARCHAR2 || FD_SECURITYLEVEL   | VARCHAR2 || FD_SEX             | VARCHAR2 || FD_SZ              | VARCHAR2 || FD_TEL             | VARCHAR2 || FD_TRAN_COUNT      | VARCHAR2 || FD_USERID          | VARCHAR2 |+--------------------+----------+\n\n\n读出admin。http://www.sccom.gov.cn/webexam/console/login.jsp?isNew=true登录后台：\n\n这一部分算隐私泄露吧。然后添加试卷的那里，是ckeditor改的，但是为过滤，存在任意文件上传。\n\nshell下。\n\n   漏洞证明：  \n\n   修复方案：  0x1：修复注入，过滤。0x2：任意管理后台请勿对外。0x3：任意文件上传有点不应该。   版权声明：转载请注明来源 小胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2013-02-26 23:39 厂商回复： CNVD确认并复现所述情况，已经在26日转由CNCERT四川分中心协调网站管理方处置。按部分影响机密性、可用性、完整性进行评分，基本危害评分7.48，发现技术难系数1.1，涉及行业或单位影响系数1.5，综合rank=7.48*1.1*1.5=12.342 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-02-25 10:52 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @cncert国家互联网应急中心  发个证书吧亲，不然以后测试政府站都担惊受怕的～～～求！    \n     2013-02-25 10:55 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @小胖子 你是个坏淫    \n     2013-02-27 10:32 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @se55i0n @小胖子 这次名字对了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}