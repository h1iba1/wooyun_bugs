{"id": 15674, "wybug_id": "wooyun-2012-014234", "wybug_title": "企鵝CSRF，可以窃取用户邮件", "wybug_corp": "腾讯", "wybug_author": "苦逼老爷爷", "wybug_date": "2012-11-02 17:19", "wybug_open_date": "2012-12-17 17:19", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-11-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-12-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-17：\t细节向公众公开  简要描述： 绕过不力的保护，csrf再显神威...话说，我花了一下午才弄出来这个，要写大段的代码才成功啊，送点小礼表示一下吧。。 详细说明：  qq邮箱CSRF，基本可以为所欲为了。什么? 用POST? 什么? 有SID? 什么？有referer？ 看上去防范很全面，但其实不堪一击。demo是转发用户的邮件到指定邮箱，毫无疑问的20RANK级高危漏洞了。证明中说过程吧。   漏洞证明：  1.发封邮件给需要攻击的用户，带上个宝贝swf\n\n2. 可爱的预览功能哦，居然和邮箱同域，flash大展神威啊在，而且绕过referer检测。\n\n3.看看我这个flash到底是什么\n\n4.看了这flash的后果\n\n5.关键一点，如何得到SID亲爱的qq,为了方便我，在URL中就有SID!在第4步中，可以看到代码中我写死了sid。那只是因为我懒得写代码了。 似乎播放器做过手脚，我无法通过常规方法得到url,但很简单，我只需要向我控制的服务器发起一个请求，然后服务端检测referer，然后返回sid和其它参数给flash就可以了。\n\n   修复方案：  你们看着办吧。   版权声明：转载请注明来源 苦逼老爷爷@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-11-05 17:26 厂商回复： 非常感谢您的报告。这个问题我们已经确认，正在与业务部门进行沟通制定解决方案。如有任何新的进展我们将会及时同步。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-11-02 17:48 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  我去，又是你~~~~坐等细节。。。。    \n     2012-11-02 18:03 |    \t\t苦逼老爷爷 \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:17        | 用户太懒什么都没留下)\t\t \n  @鬼魅羊羔 哈哈。。下一个，baidu。。然后就可以告一段落了。。不过baidu看上去不好啃，没信心。话说一口气破了4个大牛的金身，而这次这个算是最有技术含量，真希望 @xsser 同学能给个精就好了。。。    \n     2012-11-02 18:07 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @苦逼老爷爷 我觉得可以加精了，你觉得呢    \n     2012-11-02 18:52 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @苦逼老爷爷 我也觉得可以加精了，坐等你下一个作品，记得多点细节，坛子里很少这方面的东西，给我们科普下，让我学点东西撒。    \n     2012-11-02 23:54 |    \t\tHenry:bobo \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:22        | 本胖吊！~又高又肥2个奶奶像地雷)\t\t \n  ...求科普    \n     2012-11-02 23:56 |    \t\tHenry:bobo \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:22        | 本胖吊！~又高又肥2个奶奶像地雷)\t\t \n  这老爷子 到底要闹 那样...    \n     2012-11-05 15:44 |    \t\t苦逼老爷爷 \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:17        | 用户太懒什么都没留下)\t\t \n  好汗啊。。。比我先发的忽略了，比我后发的，忽略了。。就我还在这里坚挺着。。。    \n     2012-11-05 17:09 |    \t\t雨夜 \t\t\t( 普通白帽子  |\t\t\t        Rank:207 漏洞数:30        | 别和我谈感情，太伤钱……)\t\t \n  @苦逼老爷爷 你这个没看见    \n     2012-11-05 17:35 |    \t\t苦逼老爷爷 \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:17        | 用户太懒什么都没留下)\t\t \n  汗。。。终于等到确认，但只有10rank。。。严重受打击了。。    \n     2012-12-10 21:54 |    \t\tTituX \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | <script></script>)\t\t \n  槑槑 719229 ？    \n     2012-12-11 11:23 |    \t\t苦逼老爷爷 \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:17        | 用户太懒什么都没留下)\t\t \n  @TituX ...    \n     2012-12-17 22:33 |    \t\twebshell \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:18        | 没有伞的孩子必须努力奔跑。)\t\t \n  膜拜苦逼老爷爷。。。    \n     2012-12-18 11:25 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  这才10rank。。。    \n     2012-12-18 11:35 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  这个真不错 含量好高    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}