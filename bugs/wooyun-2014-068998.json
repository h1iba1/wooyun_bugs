{"id": 53058, "wybug_id": "wooyun-2014-068998", "wybug_title": "云南大学某子站后台功能完全开放导致被getwebshell", "wybug_corp": "云南大学", "wybug_author": "瓦解°", "wybug_date": "2014-07-19 13:35", "wybug_open_date": "2014-09-02 13:36", "wybug_type": "成功的入侵事件", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-02：\t细节向公众公开  简要描述： 这是存在安全问题的网址：www.summer.ynu.edu.cn，云南大学的一个子站。在选漏洞类型和写标题的时候我徘徊了很久，后来一想，这个网站能拿到webshell的主要原因还是后台功能的完全开放。 详细说明：  1.直接在该网址后面添加admin/login.asp，判断出是一个南方广或者良精CMS的网站，管理员并没有注意到这个漏洞，用南方的exp即可爆出管理员帐号和密码，如图：\n\n2.把MD5加密的密码拿去某cmd5网站解密，得到密码。3.登陆后台，在该网站的网站配置里面不能修改上传文件类型，可能是管理员对权限做了配置，但是很奇怪的是，管理员却开放了数据库备份功能，并且备份源文件路径可更改。如图：\n\n4.任意找图片管理或者什么编辑器上传webshell，由于有数据库备份，所以测试的大马扩展名直接改成了*.jpg，然后将上传路径拿去备份成asp，就不演示了。   漏洞证明：  附上webshell截图：\n\n其实这还没有结束，为了看看能不能旁注到云南大学总站，我写了一句话到这个网站里，用中国菜刀连接，比较直观。然后发现C盘D盘内的文件可以轻松访问，由于文件太多我不确定有没有敏感数据，附个截图：\n\n另外写了个网页提醒管理员：http://www.summer.ynu.edu.cn/WooYun.asp   修复方案：  修复该CMS程序存在的0day，后台地址可改，后台功能和权限重新配置。   版权声明：转载请注明来源 瓦解°@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-07-24 09:09 厂商回复： CNVD确认所述情况，转由CNCERT向教育网应急组织——赛尔网络公司通报，抄报CCERT和上海交大。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}