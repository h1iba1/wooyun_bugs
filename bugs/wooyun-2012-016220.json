{"id": 14804, "wybug_id": "wooyun-2012-016220", "wybug_title": "艺龙旅行网1元买机票漏洞", "wybug_corp": "艺龙旅行网", "wybug_author": "jerryl3e", "wybug_date": "2012-12-19 16:22", "wybug_open_date": "2013-02-02 16:23", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-02-02：\t细节向公众公开  简要描述： 无意测试发现的。。。 详细说明：  漏洞发生在艺龙的安卓客户端，艺龙安卓客户端的所有数据都是通过明文传送，包括登录名和密码，开始测试预定酒店没有发现问题，因为服务器对金额有校验，但是测试买机票就发现有问题了。首先在客户端上随便选一个日期的航班，如图1\n\n图1可以发现金额一共1100，又机票，机建，燃油3部分。然后继续补充订单信息，然后到最后确认订单。如图2\n\n图2重点就在这里，点击下面的提交订单，通过burpsuite拦截数据包，可以发现数据只是进行了url编码，如图3\n\nURL解码后，如图4\n\n图4可以发现，敏感信息都是明文传送，然后我们可以修改其中的price值为1（机票价格）OilTax值为0（燃油）airtax为0（机建），然后改一下总金额totalprice为1，然后提交数据包就可以以我们用1元去买机票了，然后跳转到这里如图5\n\n图5因为抓包修改的传送到服务器的数据，所以客户端这里显示的是原价，但是服务器上的订单数据已经被修改了，可以在网站上看下订单,如图6,7\n\n图6\n\n图7付款那里，就没有继续下去了,既然服务器的订单金额已经修改，付款也是按服务的金额来进行支付吧。。。   漏洞证明：  同上   修复方案：  对客户端传送的数据进行加密，并且在服务器对订单金额这些做校验   版权声明：转载请注明来源 jerryl3e@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2012-12-21 21:21 厂商回复： 谢谢对我们安全的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-19 16:29 |    \t\tJack \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:1        | 渴望成长)\t\t \n  看看    \n     2012-12-19 16:32 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  一块钱到北京来玩儿吧    \n     2012-12-19 16:35 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  两块钱，带我去耍嘛。元旦假期好长啊    \n     2012-12-19 16:52 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  三块钱出国吧....    \n     2012-12-19 17:02 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  求DZ帮忙1元预定回家机票~~~    \n     2012-12-19 17:03 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  四块钱整个船票吧    \n     2012-12-19 17:47 |    \t\tmyh0st \t\t\t( 普通白帽子  |\t\t\t        Rank:164 漏洞数:36        | 我是小白，我要变黑！)\t\t \n  哇，五快钱去外星吧！    \n     2012-12-19 17:59 |    \t\tlion(lp) \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:14        | 本人菜。。。千年实习白帽子)\t\t \n  额，貌似我发过吧    \n     2012-12-19 18:09 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @lion(lp) ID?    \n     2012-12-19 18:19 |    \t\tjerryl3e \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:19        )\t\t \n  @lion(lp) @xsser 看了以前那个洞，不一样的哈。    \n     2012-12-19 18:33 |    \t\tlion(lp) \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:14        | 本人菜。。。千年实习白帽子)\t\t \n  @jerryl3e  恩，我之前好像也有成功过，不过当时用BP 用的不熟，后来就没管了   这次学习一下你的方式    \n     2012-12-19 18:43 |    \t\tjerryl3e \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:19        )\t\t \n  @lion(lp) 嘿嘿，互相学习。    \n     2012-12-19 19:46 |    \t\tlion(lp) \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:14        | 本人菜。。。千年实习白帽子)\t\t \n  @jerryl3e 没错     \n     2012-12-19 20:42 |    \t\tguiker \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | PHP屌丝程序员！)\t\t \n  一块钱带我去周游世界。    \n     2012-12-21 22:09 |    \t\t摩斯 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        | 每天进步一点点！努力学习技术！)\t\t \n  ~~~一块钱    \n     2013-01-22 13:49 |    \t\tlsh4ck \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:14        | 不是黑客!但是黑客手段都要会?)\t\t \n  他们损失止5rank？太吝啬了吧    \n     2013-02-02 16:49 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  撸主。我想问问你是怎么用BP截到手机数据包的，手机wifi了代理？望不吝赐教。    \n     2013-02-02 18:18 |    \t\toldcat \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:14        )\t\t \n  @小胖子 知道了也告诉我一声，好奇    \n     2013-02-03 02:35 |    \t\t专业查水表 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:5        | \"><script>alert(/我是\"J.L\"的大号/);</scr...)\t\t \n  我也想知道怎么截手机数据包    \n     2013-02-18 14:58 |    \t\tjerryl3e \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:19        )\t\t \n  @专业查水表 @oldcat @小胖子 用的安卓模拟器，模拟器设置了代理，然后就可以截数据包了，具体我测试步骤我发在了http://www.jerryl3e.com/?p=330    \n     2013-02-18 16:35 |    \t\toldcat \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:14        )\t\t \n  谢谢@jerryl3e    \n     2013-02-18 16:37 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @jerryl3e 看了下，还安装虚拟机，麻烦，我试试别的办法呢，http代理呢，又不安全，伤不起，    \n     2013-02-18 16:59 |    \t\t专业查水表 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:5        | \"><script>alert(/我是\"J.L\"的大号/);</scr...)\t\t \n  谢谢@jerryl3e 迟些连android开发环境等一并弄了再来搞    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}