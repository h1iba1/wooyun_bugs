{"id": 88615, "wybug_id": "wooyun-2016-0213904", "wybug_title": "顺丰某系统修复不当导致getshell                                      ", "wybug_corp": "顺丰速运", "wybug_author": "路人甲", "wybug_date": "2016-05-28 21:38", "wybug_open_date": "2016-07-12 23:10", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-06-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-12：\t细节向公众公开  简要描述： 任意文件上传 详细说明：   WooYun: 顺丰某分站从列目录到代码执行Getshell 已经公开2天了，当时我就看了下，仍然能够上传，但苦于代码没摸透，上传的文件经常被截断了，要么就是长度被限制了，所以丢在文档里2天问题一个个抛出1#dll后缀文件仍然允许下载，虽然关闭了目录浏览，但iis配置不当http://218.17.224.215:8082/obj/Debug/SFWCFService.dll\n\n2#程序虽然修改了（pwd没有写死了），但关键的是pwd未改仍然是zxb@fjw\n\n3#虽然savepath在web.config中进行了定义，但从SFServerService.svc上传的文件仍然躺在web目录下，完全没起到作用，倒是SFMainService.svc上传的文件跑到了定义的目录观察2个接口的源码发现原来是程序员忘了改\n\n\n\n   漏洞证明：  4#上传长度的限制仍然不够\n\n传个原漏洞的shell-长度69\n\n会提示上传失败false，虽然文件有建立，但无内容这里我也傻了几天\n\n因为我受困于offset这个参数，因为这个参数我原先设置为2，这个参数的实际作用是从第几位字符开始上传（从0开始），所以每次我都被截取了前3位最后晒一下结果\n\n利用个asp一句话拿下，因为够短嘛呵呵数据库\n\n\n\n运单之类的文件设置上传到了D:\\TempFiles\\\n\n\n\n\n\n   修复方案：  按1、2、3、4点修复   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-05-28 23:07 厂商回复： 感谢对顺丰安全关注，佩服洞主之心思。。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}