{"id": 22908, "wybug_id": "wooyun-2011-02071", "wybug_title": "we7cmd后台上传webshell", "wybug_corp": "西部动力", "wybug_author": "路人甲", "wybug_date": "2011-05-07 14:41", "wybug_open_date": "2011-05-07 22:50", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["代码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-05-07：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2011-05-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 后台过滤不严，直接上传webshell 详细说明：  admin/Folder.aspx.cs中\n... string Filter        {            get            {                string f = Request[\"filter\"];                if (f == null)                {                    f = \"*\";                }                return f;            }        }…   void LoadFiles()        {               //if (SelectType != null)            //    dd.FolderUrl += \"&noSelect=1\";            dd.FileUrl =actionLinks;             dd.PathName = f; ;            dd.Filter = Filter;            dd.AutoCreate = AutoCreate;            dd.BasePath = Server.MapPath(\"/\");            dd.Process();            FileListGridView.DataSource = dd.Items;            FileListGridView.DataBind();            FilterLabel.Text = Filter;            PathLabel.Text = CurrentFolder;            string dir = Path.Combine(dd.BasePath, dd.PathName);            CreateHyperLink.Enabled = !IsForbid(dir) && !IsReadyonly(dir);            UploadHyperLink.Enabled = !IsForbid(dir) && !IsReadyonly(dir);        }\t...\nFilter是过滤器，就是允许上传的类型，具体见http://sdk26.we7.cn/html/c68dcc7c-d336-8c03-7fd7-cdbd18f025ef.htm很明显没有经过过滤就直接，ok，来说下利用，进入后台，模板->编辑模板->新建模板->导入静态html,弹出一个对话框，www.xx.com/admin/Folder.aspx?noSelect=0&folder=/_skins/r&filter=*.htm,copy url，在窗口打开,修改www.xx.com/admin/Folder.aspx?noSelect=0&folder=/_skins/r&filter=*.aspx直接上传webshell   漏洞证明：  \n\n   修复方案：  对Request[\"filter\"]进行过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：4 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 4, "Ranks": null}