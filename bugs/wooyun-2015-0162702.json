{"id": 73801, "wybug_id": "wooyun-2015-0162702", "wybug_title": "饿了么安卓客户端验证缺陷无限制吃霸王餐续", "wybug_corp": "饿了么", "wybug_author": "路人甲", "wybug_date": "2015-12-22 12:47", "wybug_open_date": "2016-02-06 10:45", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-06：\t细节向公众公开  简要描述： 之前提交的方法大约需要1-5分钟才可以下单成功吃霸王餐，这个是做了一点点改动，但是30秒左右就可以吃到霸王餐 详细说明：  之前提交的是：http://www.wooyun.org/bugs/wooyun-2015-0162596/trace/d0fc97930194e1e79efed3b342180193，所需要的环境还是上边的文章所说的环境，只是在第十五步出现更改：现在要把自己的电话写在备用电话上，地址写自己的地址，然后可以看到是这样的提示：\n\n虽然提示是“设备非首次下单”，但是直接无视，点击下单，会出现需要发送语音验证码的界面，这时候fiddle软件会抓到这样的一条请求：\n\n封包长度为138（有时候会为133 136 ） 右键点击这条请求点击编辑，点击原始，找到我标注的地方：\n\n将其中的几个字符随意修改为其他字母：\n\n然后对这条封包摁s键修改为5000 再次摁s键修改为2000（这个数字随意），然后软件就会自动的发包，注意观察返回的包的长度，大约20秒-60秒就会出现封包长度为96或者72或者186或者174都算成功，然互点击返回，查看自己订单，订单就会为减过20元的订单，这时候使用网页版饿了么进行支付：\n\n。当支付成功后，是有008修改器将模拟器信息更换，饿了么软件信息清除，又可以再次使用任意空号进行购买霸王餐了（每单减20元）==-==   漏洞证明：  我只是证明这个漏洞的存在，至于危害，麻烦去某宝 搜索 “饿了么 首单” 自己去看看那些商家做的，他们都是使用傻瓜式工具 一键进行下首单， 手机号是网上卖号的商城搜索的，饿了么账号是使用注册机批量注册的~~~   修复方案：  1111   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2015-12-23 11:54 厂商回复： 非常感谢您的报告。此问题是个人刷单行为，也是整个O2O行业都面临解决的问题。我们正在与业务部门进行沟通制定解决方案。如有任何新的进展我们将会及时同步。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-22 12:52 |    \t\tHackshy \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:23        | 猪猪侠爱吃棒棒糖)\t\t \n  666666666.学生党的福利啊    \n     2015-12-22 12:54 |    \t\t小人物Reno \t\t\t( 普通白帽子  |\t\t\t        Rank:477 漏洞数:114        | X)\t\t \n  来一车    \n     2015-12-22 12:54 |    \t\t番茄师傅 \t\t\t( 普通白帽子  |\t\t\t        Rank:346 漏洞数:92        | http://www.tomatoyu.com/)\t\t \n  我要吃霸王餐~~    \n     2015-12-22 13:35 |    \t\tMieless \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:10        | 我是来打酱油的。)\t\t \n  求指点    \n     2015-12-23 13:11 |    \t\t小博博 \t\t\t( 实习白帽子  |\t\t\t        Rank:80 漏洞数:14        | 工作)\t\t \n  @饿了么 别的o2o面临的是很多人使用平台的新手机号接验证码的问题 而你们面临的问题是可以通过技术手段绕过验证码！！！，我随便找个号码都可以， 这不是一个性质！！！  @饿了么    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}