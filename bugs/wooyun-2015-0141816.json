{"id": 68374, "wybug_id": "wooyun-2015-0141816", "wybug_title": "众安保险某处逻辑错误可绑定任意用户手机号或影响订单信息（以13888888888为例）", "wybug_corp": "众安在线财产保险股份有限公司", "wybug_author": "路人甲", "wybug_date": "2015-09-20 10:15", "wybug_open_date": "2015-11-02 10:52", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-02：\t细节向公众公开  简要描述： 可绑定任意用户手机号 详细说明：  问题是出现在 微信端的 众安保险 点击个人中心-我的保单然后输入手机号 13888888888点击获取验证码，然后提交的时候抓包\n\n\nGET /weixin/index.php?r=/userBind/bind&identityName=%E7%8E%8B%E5%B8%85&identity=110000197609260652&identityPhone=13012345678&verifyCode=111111 HTTP/1.1Host: **.**.**.**Referer: http://**.**.**.**/weixin/index.php?r=userBind/bindUserInfo&refferUrl=%2Fweixin%2Findex.php%3Fr%3Daviation%2ForderX-Requested-With: XMLHttpRequestAccept-Encoding: gzip, deflateAccept: application/json, text/javascript, */*; q=0.01Accept-Language: zh-cnCookie: Hm_lpvt_45707c8495c2e8cbd4584bbac4a7e6fc=1442476630; Hm_lvt_45707c8495c2e8cbd4584bbac4a7e6fc=1442476630; zhongan_open_id=o_MtruCJd8ODGSktqb80pSGIt5sQ; pgv_pvi=6374802432; pgv_si=s266788864; Userid=\"3caf1gDze8QMGglAhSqCQg==\"Connection: keep-aliveUser-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 8_4 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12H143 MicroMessenger/6.2.4 NetType/WIFI Language/zh_CN\n看下返回包\n\n然后修改返回包为\n{\"ret\":0,\"msg\":\"ok\",\"data\":\"\\u8bf7\\u91cd\\u65b0\\u8f93\\u5165\\uff01\"}\n\n\n然后成功绑定\n\n这里显示的是订单内容 只要该手机号存在订单，即可查看~\n\n   漏洞证明：  \n\n   修复方案：  完善下逻辑   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-09-18 10:50 厂商回复： 谢谢支持！ 最新状态： 2015-09-21：经验证，该漏洞无法被有效利用，为误报漏洞。对于已绑定的手机号：由于手机号已与身份证号绑定，后台验证手机号码与身份证号不匹配，会拒绝发送短信验证码。对于未绑定的手机号：13888888888可以重复进行绑定操作，页面会弹出成功绑定身份信息，但后台执行验证判断验证码不匹配，系统会自动跳转回信息输入页面。  ", "replys": "漏洞评价：\n评论\n     2015-09-17 20:51 |    \t\t红客十年 \t\t\t( 普通白帽子  |\t\t\t        Rank:336 漏洞数:64        | 去年离职富士康，回到家中上蓝翔，蓝翔毕业...)\t\t \n  这手机号动不动就躺枪了。。机主真倒霉。只要你们挖洞无辜受伤的总是他    \n     2015-09-18 08:43 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1038 漏洞数:176        | px1624)\t\t \n  有是这号，这机主真是万年小黑屋啊。。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}