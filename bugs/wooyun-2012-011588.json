{"id": 17005, "wybug_id": "wooyun-2012-011588", "wybug_title": "百度屏蔽360搜索结果的拦截页xss漏洞", "wybug_corp": "百度", "wybug_author": "路人甲", "wybug_date": "2012-08-31 11:14", "wybug_open_date": "2012-10-15 11:15", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-09-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-09-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-09-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-10-15：\t细节向公众公开  简要描述： 百度拦截页的脚本代码允许字符串匹配了包含*.baidu.com和*.hao123的跳转链接。 这个地方存在安全漏洞，只要链接中伪造一个*.baidu.com和*.hao123的字符串，就可以注入任意的javascript代码运行。 这个漏洞可能被钓鱼，挂马，劫持用户浏览器进行更多操作 碰碰运气。看看百度漏洞能审核通过不? 详细说明：  \nurl = RegExp.$1;             if(/http:\\/\\/(\\w+)\\.(baidu|hao123)\\.com/i.test(url)){                   domain1 = RegExp.$1;                   domain2 = RegExp.$2;                   if(domain2 == \"baidu\"){                         domain = domain1;                   }elseif(domain2 == \"hao123\"){                         domain = domain2;                   }             }             for(var i = 0; i < prd.length; i++) {                   if(prd[i].domain == domain){                         name = prd[i].name;                         G(\"warning\").style.display = \"block\";                         G(\"warning_name\").innerHTML = name;                         G(\"warning_url\").href = url;                         exist = true;                         break;                   }             }\n效果如下： http://www.baidu.com/search/ressafe.html?q=&url=javascript:alert(/xss/);//http://baike.baidu.com   漏洞证明：  \n\n\n\n   修复方案：  你们懂的   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2012-08-31 11:21 厂商回复： 感谢你对百度安全的关注，我们马上安排处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-08-31 11:21 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  一个xss你挂马给我看啊    \n     2012-08-31 11:33 |    \t\tgoderci \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:47        | http://www.yunday.org)\t\t \n  挂给他看...为了一个黑阔的尊严.    \n     2012-08-31 12:21 |    \t\t \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:3        | 博客寻友链 http://imlonghao.com/)\t\t \n  路人甲肯定是360...http://e.weibo.com/1645903643/yzGy13tyV    \n     2012-08-31 12:51 |    \t\tYunDay \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:4        | http://www.yunday.org)\t\t \n  @ 360已经没有底线了，鉴定完毕！    \n     2012-08-31 14:30 |    \t\t水 \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:7        | 水)\t\t \n  我昨天咋没弹出来。。。    \n     2012-08-31 14:35 |    \t\tanyunix \t\t\t( 实习白帽子  |\t\t\t        Rank:86 漏洞数:8        | 号被盗。)\t\t \n  唉,感慨一下.....    \n     2012-09-26 16:44 |    \t\t水 \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:7        | 水)\t\t \n  @anyunix 唉    \n     2012-10-15 11:20 |    \t\tpysolve \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:3        | Time is killing u when ur killing time!)\t\t \n  一个反射xss你倒是挂马给我看啊，又炒作！一看就是数字公司的人，wooyun上就别来忽悠人了，丢人啊！    \n     2012-11-26 12:12 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  外部关联：http://weibo.com/1667645563/z6RtiapnM （关联原因：热点事件关联）    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}