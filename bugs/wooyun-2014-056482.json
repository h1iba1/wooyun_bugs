{"id": 3805, "wybug_id": "wooyun-2014-056482", "wybug_title": "腾讯肯德基联手票选超级星卖家可无限刷票", "wybug_corp": "腾讯", "wybug_author": "计算姬", "wybug_date": "2014-04-20 17:01", "wybug_open_date": "2014-06-04 17:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-04：\t细节向公众公开  简要描述： 腾讯肯德基联手票选超级星卖家可无限刷票 详细说明：  看域名是腾讯的，那就提给腾讯吧。http://kfcstar.qq.com/票选超级星卖家这还是别人要给投给男神柯震东的，然后就去测试了下每小时投票10次。第11次就有提示了\n\n摸不着头脑，先想想以前的刷票机制可能是修改host，也可能是用xforwardedfor代理不同ip，不过在这里都不行然后我想着换了一个浏览器结果还是可以投票的，奇怪。抓包看了下，UA不同？于是在chrome已经投了10次，第11次抓包修改UA，结果还是失败然后还是就是比较两个浏览器抓包有什么不同，最后发现是在cookie中\n\n图中这么多cookie是因为我登录了QQ账号，其实主要有用的就3个值。我们注意到有个vote=5。然后接下来测试就是观察vote的值，发现每投一次，就增加1，当vote=10之后，再投票就有提示了。所以，我们只要把vote改为小于10的就可以继续投票了。这里用burp跑一下吧，先用repeate看一下吧\n\n200OK，\\u64cd\\u4f5c\\u6210\\u529f  unicode解码为操作成功。set-cookie把vote的值加1，不过没关系，我们继续提交就是了。因此导致无限刷票。用instruder设置一下空payload就可以跑了   漏洞证明：  看域名是腾讯的，那就提给腾讯吧。http://kfcstar.qq.com/票选超级星卖家这还是别人要给投给男神柯震东的，然后就去测试了下每小时投票10次。第11次就有提示了\n\n摸不着头脑，先想想以前的刷票机制可能是修改host，也可能是用xforwardedfor代理不同ip，不过在这里都不行然后我想着换了一个浏览器结果还是可以投票的，奇怪。抓包看了下，UA不同？于是在chrome已经投了10次，第11次抓包修改UA，结果还是失败然后还是就是比较两个浏览器抓包有什么不同，最后发现是在cookie中\n\n图中这么多cookie是因为我登录了QQ账号，其实主要有用的就3个值。我们注意到有个vote=5。然后接下来测试就是观察vote的值，发现每投一次，就增加1，当vote=10之后，再投票就有提示了。所以，我们只要把vote改为小于10的就可以继续投票了。这里用burp跑一下吧，先用repeate看一下吧\n\n200OK，\\u64cd\\u4f5c\\u6210\\u529f  unicode解码为操作成功。set-cookie把vote的值加1，不过没关系，我们继续提交就是了。因此导致无限刷票。用instruder设置一下空payload就可以跑了   修复方案：  要做到真正的验证哈   版权声明：转载请注明来源 计算姬@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-04-22 00:58 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-23 14:29 |    \t\t木马人 \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:25        | 白，灰，黑)\t\t \n  张亮，果断啊    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}