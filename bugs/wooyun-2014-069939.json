{"id": 1471, "wybug_id": "wooyun-2014-069939", "wybug_title": "oppo重置任意用户密码漏洞(3)", "wybug_corp": "广东欧珀移动通讯有限公司", "wybug_author": "noob", "wybug_date": "2014-07-27 23:46", "wybug_open_date": "2014-09-10 23:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证设计不合理", "设计缺陷", "手机短信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-10：\t细节向公众公开  简要描述： 玩刀塔传奇无意发现的接口,于是手痒了... 详细说明：  在可可软件中心下载刀塔传奇，进入刀塔传奇的时候有个可可软件小图标，点击有个登陆神马的，看到有个忘记密码，其中里面有个根据绑定手机找回密码，发一个4位数的验证码...输入手机号，发短信验证码，抓包改包如下图：\n\n本来还愁不知道哪里找手机号呢，后来通过这个接口发现可以判断手机号是否存在，于是该漏洞变成了任意重置密码...1、跑一个手机号码的后4位数，得到手机号2、通过http://game.nearme.com.cn/findPwdValid这个接口跑验证码\n\n3、拿到openid和verifyCode\n\n4、通过/findPwdReset这个接口，填入对应的openid和verifyCode,修改成新的密码\n\n5、修改完密码后使用刀塔传奇里面的那个可可登陆界面登陆抓包，发现下面这个接口:http://oauth.nearme.com.cn/oauth/XAccessTokenServlet通过它获取用户名...(其实登陆后就可以在界面上看到用户名...)\n\n6、然后...直接拿用户名和新的密码登陆其他网站咯.\n\n\n\n整个流程涉及到的接口列表：http://game.nearme.com.cn/findPwdGetCode 通过这个接口得到手机号http://game.nearme.com.cn/findPwdValid 跑验证码并拿openid和verifyCode参数http://game.nearme.com.cn/findPwdReset 重置密码http://oauth.nearme.com.cn/oauth/XAccessTokenServlet 拿用户名   漏洞证明：  在可可软件中心下载刀塔传奇，进入刀塔传奇的时候有个可可软件小图标，点击有个登陆神马的，看到有个忘记密码，其中里面有个根据绑定手机找回密码，发一个4位数的验证码...输入手机号，发短信验证码，抓包改包如下图：\n\n本来还愁不知道哪里找手机号呢，后来通过这个接口发现可以判断手机号是否存在，于是该漏洞变成了任意重置密码...1、跑一个手机号码的后4位数，得到手机号2、还是该接口，增加一个authCode参数跑验证码\n\n3、拿到openid和verifyCode\n\n4、通过/findPwdReset这个接口，填入对应的openid和verifyCode,修改成新的密码\n\n5、修改完密码后使用刀塔传奇里面的那个可可登陆界面登陆抓包，发现下面这个接口:http://oauth.nearme.com.cn/oauth/XAccessTokenServlet通过它获取用户名...(其实登陆后就可以在界面上看到用户名...)\n\n6、然后...直接拿用户名和新的密码登陆其他网站咯.\n\n\n\n   修复方案：  给出以下选择1、其他公司那样，让用户自己发短信到指定号码，然后下发验证码（用户体验就不用说了...）2、验证码难破一点，加上输入错误次数，5次后重新获取验证码没有礼物的产商不是好产商~~~这都第三部了   版权声明：转载请注明来源 noob@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-07-28 11:09 厂商回复： 非常感谢白帽子noob对我司的关注，已经通知工程师进行修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-27 23:57 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  OPPO貌似被重置过N次了，关注下，是新姿势吗    \n     2014-07-28 08:52 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  oppo又可以重置密码了！？    \n     2014-07-28 10:56 |    \t\tnoob \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:18        | 向各位大神学习，向各位大神致敬)\t\t \n  @px1624 @魇 不是新姿势，老姿势，不过找到新的地方使用老姿势！    \n     2014-07-28 11:34 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  @noob 是主站的地方吗 貌似我也找到了个 不晓得重复了没    \n     2014-07-28 12:21 |    \t\tnoob \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:18        | 向各位大神学习，向各位大神致敬)\t\t \n  @魇 不是主站，是子站点    \n     2014-07-28 12:26 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  @noob 那没应该没重复..提交了 之前也重置过3次了 ..简直    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}