{"id": 43733, "wybug_id": "wooyun-2014-081868", "wybug_title": "华思通网络会议系统任意文件上传（第一发）", "wybug_corp": "华思通网络技术有限公司", "wybug_author": "路人甲", "wybug_date": "2014-11-04 18:30", "wybug_open_date": "2014-12-19 18:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传安全", "文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-04：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-12-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 上一发：http://www.wooyun.org/bugs/wooyun-2014-081812 详细说明：  刚才看了看，这货难道属于华为吗？还是说只是合作关系？\n华思通网络技术有限公司是一家视频会议网络服务公司，是华为的技术合作伙伴，依托华为会议产品及技术实力，提供网络视频会议、 网络市场活动、网络培训等互联网在线服务。\n不管咋样，漏洞还是照常提交吧   漏洞证明：  先访问：http://meetinglive.teleuc.com/jsp/main/site/uploadsiteimg.jsp\n\n选好文件之后，再点一次浏览前面的对话会，然后点取消，之后回车就可以自动提交了，连exp都省了写\n\n从上图也可以看出实际上是imgsave这一个action出了问题，对应的class是com.teleuc.controller.SiteSettingControllers，一看就有漏洞嘛……\npublic String imgsave()  {    String str = UUID.randomUUID() + StringUtils.getExtention(this.filelogoFileName);    File localFile = new File(ServletActionContext.getServletContext().getRealPath(\"/uploadfiles\") + \"/\" + str);    try    {      if (localFile.createNewFile())      {        FileUtils.copyFile(this.filelogo, localFile);      }      else      {        SITELOG.error(\"create upload file failed. please check the space .\");      }    }    catch (IOException localIOException)    {      SITELOG.error(\"copy file failed.\");    }    this.resultSite = (\"uploadfiles/\" + str);    return \"success\";  }\n自带回显：\n\n随意shell下：\n\n亲爱的root\n\n   修复方案：  限制类型。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}