{"id": 21928, "wybug_id": "wooyun-2011-03312", "wybug_title": "Sofpro电子政务平台：在线访谈功能存在任意文件上传漏洞", "wybug_corp": "开普互联", "wybug_author": "刺刺", "wybug_date": "2011-11-14 16:45", "wybug_open_date": "2011-11-19 16:46", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["限制绕过方法", "前台限制绕过", "文件上传漏洞", "文件上传安全", "电子政务"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-11-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-11-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： Sofpro电子政务平台“在线访谈”功能，上传文件处验证方式可被绕过。 详细说明：  漏洞文件：/sofprogecslive/live/uploadfile.jsp/sofprogecsinterview/interview/uploadfile.jsp上传中对文件类型采用客户端js验证，本地禁用js，直接上传jsp脚本即可。   漏洞证明：  教育部网站：http://www.moe.edu.cn/sofprogecslive/live/uploadfile.jsphttp://www.moe.edu.cn/sofprogecsinterview/interview/uploadfile.jsp\n\n\n\n   修复方案：  建议增加服务端java验证；文件存放目录禁止动态脚本执行；平台系统权限明确，某些后台关键文件禁止未授权访问。   版权声明：转载请注明来源 刺刺@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2011-11-19 16:46 厂商回复：  漏洞Rank：8  (WooYun评价) 最新状态： 2011-11-22：已经与教育部学位信息漏洞一并通报涉事单位，感谢刺刺，因周末时间未及时确认，致歉。  ", "replys": "漏洞评价：\n评论\n     2011-11-22 17:26 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  从目前测试情况看，无法访问提供的后站shell URL。但对上传文件以及相关目录的读写权限仍然保留，只是上传后并不能直接访问生成的路径。后续处置，继续跟踪    \n     2011-12-01 09:23 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  刚刚才看到有关“教育部被黑”的消息，我很后悔公开了这个，厂商对简单漏洞的置之不理，让人有些失望，其实我当初就是想混个邀请码而已。    \n     2012-11-05 23:03 |    \t\tPCanyi \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:6        | 【为自己吹下的牛逼奋斗终身！】  幻想着改...)\t\t \n  @刺刺 厂家的态度是上传了不能执行，没有相应的路径能映射过来。写这个cms的人很2，本地验证的都很2。    \n     2012-11-06 08:54 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  @PCanyi 呵呵，这是人家早期的项目，修补自然是以堵为主，减少成本。堵的话，难免有纰漏……    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}