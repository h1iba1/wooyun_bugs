{"id": 2761, "wybug_id": "wooyun-2014-063729", "wybug_title": "多玩网歪歪之强制关注任何歪歪号（看我是如何让李学凌跟雷军关注我的!）", "wybug_corp": "广州多玩", "wybug_author": "佩佩", "wybug_date": "2014-06-06 14:30", "wybug_open_date": "2014-07-23 21:22", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "安全意识不足", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-23：\t细节向公众公开  简要描述： 多玩网歪歪之强制关注任何歪歪号！看我我是如何让李学凌跟雷军关注我的!千万粉丝不是梦,免费广告有木有！ 详细说明：  测试环境：任何歪歪版本：1.测试网址：http://find.yyemebed.yy.com:80/实现过程：首选随便对一个想要关注的YY号进行搜索.比如我的YY号94154.然后利用抓包工具抓取我对应的歪歪号的UID..因为歪歪都是由UID进行对应的.加好友关注也不例外!.抓包我们可以分析看到 加关注的提交方式是以get的方式提交的,接口是:/idol/被关注的YY号UID/自己的UID。（通过抓包分析。发现这块还有cookies验证。如果没有cookies那不是不行?经过测试奇葩的地方出现了，这里的接口居然不通过cookies验证，只对UID进行验证，而且是本地验证，没有后端验证）于是乎我这个逻辑控。。我们都会想到，我们如果互相替换被关注，跟关注的UID是不是就能变成我们可以关注任何人的歪歪号？ 经过测试，歪歪官方的技术哥哥在这个地方确实后来补上了验证，后端加了验证，可是凭我这个逻辑控多年的对歪歪技术的了解，大部分网站的技术哥哥都比较粗心，于是，让我想起了我买的渗透书网络安全里面的一则，多阶段会话安全逻辑问题。我想技术哥哥应该没有封好存在这个多阶段会话问题。意思就是：我们从点开搜索好友的那一刻的接口:http://find.yyemebed.yy.com:80/auth/index/处就进行uid的欺骗。事实证明那块技术哥哥忘记加验证了。而是在最后一步加了验证，补尾不补头的做法,实在难以恭维啊！然后就能顺利的进行任何好友关注了！PS：特别提示：我是一个对多玩非常热心的白帽子，从未对此漏洞进行拉过一次关注！也没有做过破坏，我教程所举例子的歪歪号的粉丝。均是靠自己的人气加的..并非此漏洞强制刷的.可以查后台时间呦.是官方产品的技术哥哥叫我来测试的，不要封我号额！   漏洞证明：  1.测试网址：http://find.yyemebed.yy.com:80/实现过程：首选随便对一个想要关注的YY号进行搜索.比如我的YY号94154.然后利用抓包工具抓取我对应的歪歪号的UID..因为歪歪都是由UID进行对应的.加好友关注也不例外!.\n\n抓包我们可以分析看到 加关注的提交方式是以get的方式提交的,接口是:/idol/被关注的YY号UID/自己的UID。代码如下：\nhttp://find.yyemebed.yy.com:80//idol/被关注IM的UID/关注IM的UID\n（通过抓包分析。发现这块还有cookies验证。如果没有cookies那不是不行?经过测试奇葩的地方出现了，这里的接口居然不通过cookies验证，只对UID进行验证，而且是本地验证，没有后端验证）于是乎我这个逻辑控。。我们都会想到，我们如果互相替换被关注，跟关注的UID是不是就能变成我们可以关注任何人的歪歪号？ 经过测试，歪歪官方的技术哥哥在这个地方确实后来补上了验证，后端加了验证，可是凭我这个逻辑控多年的对歪歪技术的了解，大部分网站的技术哥哥都比较粗心，于是，让我想起了我买的渗透书网络安全里面的一则，多阶段会话安全逻辑问题。我想技术哥哥应该没有封好存在这个多阶段会话问题。意思就是：我们从点开搜索好友的那一刻的接口:http://find.yyemebed.yy.com:80/auth/index/处就进行uid的欺骗。事实证明那块技术哥哥忘记加验证了。而是在最后一步加了验证，补尾不补头的做法,实在难以恭维啊！然后就能顺利的进行任何好友关注了！\n\n于是乎我这个逻辑控。。我们都会想到，我们如果互相替换被关注，跟关注的UID是不是就能变成我们可以关注任何人的歪歪号？ 经过测试，歪歪官方的技术哥哥在这个地方确实后来补上了验证，后端加了验证，可是凭我这个逻辑控多年的对歪歪技术的了解，大部分网站的技术哥哥都比较粗心，于是，让我想起了我买的渗透书网络安全里面的一则，多阶段会话安全逻辑问题。我想技术哥哥应该没有封好存在这个多阶段会话问题。意思就是：我们从点开搜索好友的那一刻的接口:http://find.yyemebed.yy.com:80/auth/index/处就进行uid的欺骗。事实证明那块技术哥哥忘记加验证了。而是在最后一步加了验证，补尾不补头的做法,实在难以恭维啊！然后就能顺利的进行任何好友关注了！PS：特别提示：我是一个对多玩非常热心的白帽子，从未对此漏洞进行拉过一次关注！也没有做过破坏，我教程所举例子的歪歪号的粉丝。均是靠自己的人气加的..并非此漏洞强制刷的.可以查后台时间呦.是官方产品的技术哥哥叫我来测试的，不要封我号额！提交了N个漏洞，一直没要过奖励，求多玩技术哥哥给个5位激活码！   修复方案：  后端验证,多阶段缓存问题,记得每个接口都要加后端验证!   版权声明：转载请注明来源 佩佩@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-06-06 16:02 厂商回复： 感谢对于欢聚时代安全工作的支持，我们会尽快安排修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-06 14:32 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  李学凌和雷军是谁？    \n     2014-06-06 14:34 |    \t\tYouYaX(乌云厂商)\t\t \n  牛叉。    \n     2014-06-06 14:37 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  看成强制关闭YY了    \n     2014-06-06 14:38 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  YY的两大老板啊...    \n     2014-06-06 14:41 |    \t\t追逐天堂 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:10        | 请叫我路人丁)\t\t \n  @乐乐、 多玩和小米的创始人    \n     2014-06-06 14:47 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  越权吗?还是平权?    \n     2014-06-06 15:32 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  撸主专注YY二十载...    \n     2014-06-07 18:06 |    \t\t小怿 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:6        | )\t\t \n  前几天一群人就这样搞。。做酱油的，做交友的，做直播的都这样整，各种拉关注，然后我也就研究，发现是某个接口。。是靠url/操作者/被关注人的类似链接。。但是通过修改内容，然后在通过burp发包。。结果发现竟然自己的号关注了别人一大堆。。但是没研究明白怎么利用别人强行关注自己。。    \n     2014-06-07 22:13 |    \t\t佩佩 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:8        | 一个热衷于网络安全的白帽子,具有很强的逻...)\t\t \n  @小怿 是官方技术叫我帮忙测试的,你说的一群人这样搞的问题,是他们花钱买的他人写的软件,那种方法已经被和谐,为了防止这种以盈利为目的的行为,官方技术叫我测试还能否实现,看你的描述,你是在关注处的接口进行修改是吧..在你测试的时候那种方法已经被官方修复了.我提交的只是突破的方法.    \n     2014-06-08 08:48 |    \t\t小怿 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:6        | )\t\t \n  @佩佩 好吧，他们都不知道在查找加token。。手机yy的关注那块有，频道内的关注也有。。    \n     2014-06-08 08:50 |    \t\t小怿 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:6        | )\t\t \n  @小怿 补充下，频道的关注指的是YY关注应用    \n     2014-06-08 08:54 |    \t\t佩佩 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:8        | 一个热衷于网络安全的白帽子,具有很强的逻...)\t\t \n  @小怿 太夸张了token没必要,最多加个cookies+时间戳就不错了...    \n     2014-08-01 06:32 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  mark    \n     2014-11-10 18:28 |    \t\t追寻 \t\t\t( 实习白帽子  |\t\t\t        Rank:86 漏洞数:18        | 闭关修炼)\t\t \n  @佩佩   表示你为何只撸YY    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}