{"id": 17856, "wybug_id": "wooyun-2015-0105685", "wybug_title": "博华网龙信息安全一体机两个命令执行漏洞", "wybug_corp": "博华网龙", "wybug_author": "路人甲", "wybug_date": "2015-04-10 14:26", "wybug_open_date": "2015-07-13 18:02", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-17：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-13：\t细节向公众公开  简要描述： 博华网龙信息安全一体机，名字是不是很牛B,安全做的怎样呢  详细说明：  注：前面两个漏洞，执行exp后会在相应的目录下面生成sh.php文件，该文件可以用菜刀连接，如该漏洞执行后，生成了：\nhttp://222.241.149.84/qos/sh.php?x=phpinfo();\n前两天有个提交了这个系统的getshell,描述很清晰，PUT getshell,于是乎有了下文/qos/ip_status.php/systemstatus/ip_status.php该两个文件存在多处命令执行漏洞，部分代码如下：\n$file = \"/tmp/ipstatus\";system(\"cp $filename $file\");if($_GET['action'] == \"sort\"){    if($_GET['order'] == \"desc\")        $cmd = \"sort $file -k \".$_GET['key'].\" -g -b -r -o /tmp/ipstatus_sort\";    else        $cmd = \"sort $file -k \".$_GET['key'].\" -g -b -o /tmp/ipstatus_sort\";    system($cmd);    $file = \"/tmp/ipstatus_sort\"; }\n很明显的漏洞，直接运行exp即可获取到服务器权限（exp见测试代码）： \nphp ip_status_exp.php 222.241.149.84 443\n\n\n5个案例：http://223.146.68.23http://222.244.38.192http://223.151.193.96http://222.242.191.219http://222.241.149.84   漏洞证明：  \nhttp://222.241.149.84/qos/sh.php?x=phpinfo();\n\n\n   修复方案：  你们比我懂   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-04-14 18:01 厂商回复： CNVD未直接复现所述漏洞情况，暂未建立与软件生产厂商（或网站管理单位）的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}