{"id": 21296, "wybug_id": "wooyun-2012-04717", "wybug_title": "UCWEB浏览器密码泄漏隐患", "wybug_corp": "UC Mobile", "wybug_author": "路人甲", "wybug_date": "2012-02-22 00:09", "wybug_open_date": "2012-02-27 00:10", "wybug_type": "用户敏感数据泄漏", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-02-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： UCWEB浏览器在登录一些SSL站点时会由于代理机制导致用户信息被明文传递，导致密码类隐私数据会明文传输，可能会遭到泄漏。 详细说明：  UCWEB浏览器在开启极速模式后，用户的web请求会先传递给uc的代理服务器，代理服务器对目标服务器发出请求后对结果进行压缩处理，使返回页面体积大大减小。但是要清楚的一点就是，这个过程用户和目标服务都不是面对面通信的，也就导致了一个问题，SSL会话中就多了UC代理服务器这么一个中间人。在登录SSL站点时，由于没有实现这个合法的登录过程。用户提交用户名密码后，UC代理服务器通过用户提交的信息重构或者模拟登录，然后再将登陆认证信息返回给客户端，这就导致了用户密码在过程中被明文传递了一次，打破了SSL的安全机制。   漏洞证明：  \n\n这个请求是登录gmail时抓到的，包括当前gmail帐号的明文用户名和密码，敏感信息已经打码。其中包括了提交程序地址，在返回信息中可以看到登录成功后google给用户返回的gmail票据交换的URL，交还给客户端。在看一下正常的gmail登录请求所需的参数：continue=http%3A%2F%2Fmail.google.com%2Fmail%2F&service=mail&rm=false&dsh=6108296191112472557&ltmpl=default&ltmpl=default&scc=1&GALX=eAPJkeTsItY&pstMsg=1&dnConn=&checkConnection=&checkedDomains=youtube&timeStmp=&secTok=&Email=[email]&Passwd=[]password&signIn=%E7%99%BB%E5%BD%95&rmShown=1其中所包含的参数在发送向UCWEB代理的数据中均可发现，由此可以大胆猜测，客户端发现登录ssl站点后，会分析出登录流程（目标url，提交参数），代理服务器根据这些信息进行重构，拿到返回的合法认证信息，比如跳转云云。从google服务器返回的成功登录页面可以大致证实这个猜想：\nHTTP/1.1 302 Moved TemporarilyContent-Type: text/html; charset=UTF-8Strict-Transport-Security: max-age=2592000; includeSubDomains... ...Location: https://mail.google.com/mail/?auth=DQAAAIQAAAAOAOrxR6zzXl4F0U8eN3XzEmLp7zIOWXIEZULqfg0UJwLcPQ8WPshF1MqoqMiU8QmOJtzDjjqLXmfDQmgPWROjUxxaVdSlvNlckWRAb-RRaYaTS_nqvUjtzGsP646VMOSxYC7A9lDKFdQeW68uv_i98FDlp29b38fn_tcFzKHfW01dVhmk2sVQ4H4_tNcQSfk... ...X-Content-Type-Options: nosniffX-XSS-Protection: 1; mode=blockContent-Length: 420Server: GSE<HTML><HEAD><TITLE>Moved Temporarily</TITLE></HEAD><BODY BGCOLOR=\"#FFFFFF\" TEXT=\"#000000\"><H1>Moved Temporarily</H1>The document has moved <A HREF=\"https://mail.google.com/mail/?auth=DQAAAIQAAAAOAOrxR6zzXl4F0U8eN3XzEmLp7zIOWXIEZULqfg0UJwLcPQ8WPshF1MqoqMiU8QmOJtzDjjqLXmfDQmgPWROjUxxaVdSlvNlckWRAb-RRaYaTS_nqvUjtzGsP646VMOSxYC7A9lDKFdQeW68uv_i98FDlp29b38fn_tcFzKHfW01dVhmk2JU8Ba4_tNcQSfk\">here</A>.</BODY></HTML>\n   修复方案：  在整个登录信息传递过程中，UCWEB代理服务器对google的传输还是SSL保护的，但是用户与UCWEB代理服务器这段路程却还是明文的，额。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-02-27 00:10 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-02-22 00:43 |    \t\tJian(64bit) \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:15        | 世界上有10种人,懂二进制的和不懂的.)\t\t \n  +1    \n     2012-02-22 21:51 |    \t\tRa1nker \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | TeST)\t\t \n  http://www.tianya.cn/publicforum/content/itinfo/1/167066.shtml    \n     2012-02-27 10:36 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  不是“打破了SSL的安全机制”，而是UC在传递用户在各站点认证信息到UC服务器上时没有使用https吧    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}