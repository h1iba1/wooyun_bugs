{"id": 14511, "wybug_id": "wooyun-2013-018928", "wybug_title": "WSS 项目管理系统 Post get shell", "wybug_corp": "http://www.wssys.net/zh-CN/", "wybug_author": "hfy", "wybug_date": "2013-02-20 10:16", "wybug_open_date": "2013-02-20 10:16", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-20：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-02-20：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： POST 数据漏洞文件执行任意后缀文件保存 详细说明：  漏洞文件/chart/php-ofc-library/ofc_upload_image.php利用：/chart/php-ofc-library/ofc_upload_image.php?name=hfy.php hfy.php 文件名Post任意数据保存位置http://localhost/chart/tmp-upload-images/hfy.php\n\n\n\n最新版wss漏洞文件，即使是收费版本也有的，在新浪商店部署的demo~\n<?php//// In Open Flash Chart -> save_image debug mode, you// will see the 'echo' text in a new window.///* print_r( $_GET );print_r( $_POST );print_r( $_FILES );print_r( $GLOBALS );print_r( $GLOBALS[\"HTTP_RAW_POST_DATA\"] );*/// default path for the image to be stored //$default_path = '../tmp-upload-images/';if (!file_exists($default_path)) mkdir($default_path, 0777, true);// full path to the saved image including filename //$destination = $default_path . basename( $_GET[ 'name' ] ); echo 'Saving your image to: '. $destination;// print_r( $_POST );// print_r( $_SERVER );// echo $HTTP_RAW_POST_DATA;//// POST data is usually string data, but we are passing a RAW .png// so PHP is a bit confused and $_POST is empty. But it has saved// the raw bits into $HTTP_RAW_POST_DATA//$jfh = fopen($destination, 'w') or die(\"can't open file\");fwrite($jfh, $HTTP_RAW_POST_DATA);fclose($jfh);//// LOOK://exit();//// PHP5://// default path for the image to be stored //$default_path = 'tmp-upload-images/';if (!file_exists($default_path)) mkdir($default_path, 0777, true);// full path to the saved image including filename //$destination = $default_path . basename( $_FILES[ 'Filedata' ][ 'name' ] ); // move the image into the specified directory //if (move_uploaded_file($_FILES[ 'Filedata' ][ 'tmp_name' ], $destination)) {    echo \"The file \" . basename( $_FILES[ 'Filedata' ][ 'name' ] ) . \" has been uploaded;\";} else {    echo \"FILE UPLOAD FAILED\";}?>\n   漏洞证明：  \n\n\n\n   修复方案：  这个漏洞文件就是个杯具，怎么破，加权限验证，后缀等验证~，自己搞   版权声明：转载请注明来源 hfy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-02-25 11:16 |    \t\tWSS Lab(乌云厂商)\t\t \n  感谢反馈，该漏洞已修复。    \n     2013-02-26 00:55 |    \t\thfy \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:3        | 打了个狗~)\t\t \n  @WSS Lab 来个rank?    \n     2013-02-27 10:11 |    \t\tWSS Lab(乌云厂商)\t\t \n  @hfy 这个漏洞没有关联到我们名下，所以我们处理不了，不过可以送您个礼物。您可以把联系方式发给我们。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}