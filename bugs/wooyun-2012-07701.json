{"id": 19082, "wybug_id": "wooyun-2012-07701", "wybug_title": "蚂蚁php分类信息 多出SQL注入", "wybug_corp": "蚂蚁php分类信息mymps 4.0i", "wybug_author": "king0war", "wybug_date": "2012-05-30 19:06", "wybug_open_date": "2012-07-14 19:07", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符型注射", "字符集", "字符集问题", "字符集导致"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-30：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-07-14：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 蚂蚁php分类信息mymps 4.0i多处字符未过滤'，存在注入风险，帮朋友解决的时候顺便发上来，希望厂商迅速给补丁 详细说明：  /include/common.fun.php  96行 get参数过滤函数 正则$string = preg_replace('/&amp;((#(\\d{3,5}|x[a-fA-F0-9]{4})|[a-zA-Z][a-z0-9]{2,5});)/', '&\\\\1',\t\tstr_replace(array('&', '\"', '<', '>'), array('&amp;', '&quot;', '&lt;', '&gt;'), $string)); 此处未过滤‘单引号，Horoscope 出错页面 search.php category.php 其他页面未测试   漏洞证明：  \n\n\n\n   修复方案：  过滤所有get输入   版权声明：转载请注明来源 king0war@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}