{"id": 2043, "wybug_id": "wooyun-2014-061078", "wybug_title": "Siteserver某处严重的sql注入（并可绕过线上waf）", "wybug_corp": "百容千域软件技术开发有限责任公司", "wybug_author": "study_vul", "wybug_date": "2014-05-19 11:22", "wybug_open_date": "2014-08-17 11:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-22：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-17：\t细节向公众公开  简要描述： siteserver 非常严重的sql注入，绕过安全狗继续测试 详细说明：  SiteServer cms的系统modal_UserView.aspx页面，存在sql注入漏洞，攻击者可以利用漏洞，未授权访问数据库。 modal_UserView.aspx页面，对应源代码在站点目录Bin\\UserCenter.Pages.dll文件中，具体sql操作代码在UserCenter.BackgroundPages.Modal.UserView类的Page_Load方法中,代码如下:\n\n可见，代码未对UserName参数进行处理，即传入GetUserInfo中进行数据库查询。具体代码在:UserCenter.Provider.dll\\UserCenter.Provider.Data.SqlServer\\UserDAO.cs\n\n可见，底层函数，直接使用拼接方式，将变量userName放入sql中进行查询。导致sql注入。   漏洞证明：  官方站点http://2012.moban.siteserver.cn 由于搞的人太多官方已经上了安全狗，为了证明这个漏洞存在，因此经过尝试 发现可以绕过安全狗 证明如下:\n\n   修复方案：  siteserver对于注入来说是非常严重的，直接影响核心数据的，真正的高危漏洞  厂商要重视哦   版权声明：转载请注明来源 study_vul@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-05-19 16:02 厂商回复： 感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-19 11:40 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  我去！    \n     2014-05-19 14:03 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  我去去！    \n     2014-05-19 14:36 |    \t\tChriSt \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:4        )\t\t \n  我去去去！    \n     2014-05-19 16:31 |    \t\tstudy_vul \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 我有乌云id了，我马上就要牛叉起来了)\t\t \n  厂商复活？    \n     2014-05-19 17:40 |    \t\tBird \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:25        | Stay hungry. Stay foolish.)\t\t \n  一定要看看～    \n     2014-06-09 11:45 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  这也可以绕过了，给力了    \n     2014-06-18 16:03 |    \t\twhat_news \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:48        | 小菜一个 希望成为大菜)\t\t \n  腻害    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}