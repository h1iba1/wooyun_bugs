{"id": 26661, "wybug_id": "wooyun-2015-0128071", "wybug_title": "50cms官方网站严重漏洞，已获取webshell", "wybug_corp": "云南力诺科技有限公司", "wybug_author": "Seven", "wybug_date": "2015-07-21 14:46", "wybug_open_date": "2015-07-26 14:48", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["渗透测试思路", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 作为南方一个比较大的开发企业，服务器中大量的重要信息，包括gov，以及其他个人信息，更应该注意网站备份问题。 详细说明：  http://wx.50cms.com/admin/login.aspx 分站后台，由于网站处于开发过程中，导致网站备份文件wwwroot.rar 泄露地址，通过web.config 找到数据库连接文件，成功外联进数据库，通过DESEncrypt.cs 文件找到加密key值以及加密方式\n/// 加密数据         /// </summary>         /// <param name=\"Text\"></param>         /// <param name=\"sKey\"></param>         /// <returns></returns>         public static string Encrypt(string Text, string sKey)        {            DESCryptoServiceProvider des = new DESCryptoServiceProvider();            byte[] inputByteArray;            inputByteArray = Encoding.Default.GetBytes(Text);            des.Key = ASCIIEncoding.ASCII.GetBytes(System.Web.Security.FormsAuthentication.HashPasswordForStoringInConfigFile(sKey, \"md5\").Substring(0, 8));            des.IV = ASCIIEncoding.ASCII.GetBytes(System.Web.Security.FormsAuthentication.HashPasswordForStoringInConfigFile(sKey, \"md5\").Substring(0, 8));            System.IO.MemoryStream ms = new System.IO.MemoryStream();            CryptoStream cs = new CryptoStream(ms, des.CreateEncryptor(), CryptoStreamMode.Write);            cs.Write(inputByteArray, 0, inputByteArray.Length);            cs.FlushFinalBlock();            StringBuilder ret = new StringBuilder();            foreach (byte b in ms.ToArray())            {                ret.AppendFormat(\"{0:X2}\", b);            }            return ret.ToString();        }\n成功破解后台密码，进后台后在系统配置中直接可添加上传脚本类型，并在后台上传中成功添加webshell。   漏洞证明：  \n\n\n\n   修复方案：  将网站备份删除，修改数据库db权限，将网站上传目录设置为无执行权限，修改后台代码不允许添加脚本后缀，修改管理员弱口令！   版权声明：转载请注明来源 Seven@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-07-26 14:48 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}