{"id": 24107, "wybug_id": "wooyun-2010-0341", "wybug_title": "盛大在线某频道存在SQL注入漏洞", "wybug_corp": "盛大在线", "wybug_author": "Jannock", "wybug_date": "2010-08-27 23:07", "wybug_open_date": "2010-09-27 03:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射", "信息未隐藏", "安全设置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-08-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2010-08-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2010-09-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2010-09-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2010-09-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2010-09-27：\t细节向公众公开  简要描述： 由于过滤不严，盛大在线某频道存在SQL注入漏洞 详细说明：  http://vote1.sdo.com/Vote.aspx?ballotid=6012使用FireBUG 等工具修改选择项的值，如：<input type=\"radio\" value=\"25759'\" name=\"radiovote\">把选中项的 value 值改为 25759'   然后提交，就会出现SQL暴错。这里可以加入任意注入语句，如：25759) SLQ 语句 --  进行注入。   漏洞证明：  “/”应用程序中的服务器错误。字符串 ')' 后的引号不完整。')' 附近有语法错误。说明: 执行当前 Web 请求期间，出现未处理的异常。请检查堆栈跟踪信息，以了解有关该错误以及代码中导致错误的出处的详细信息。异常详细信息: System.Data.SqlClient.SqlException: 字符串 ')' 后的引号不完整。')' 附近有语法错误。源错误:行 34: 行 35:         new BallotMainBC().UpdateVoteCount(1, ballotID);行 36:         new BallotDetailBC().UpdateVoteCount(1, HiddenFieldSelectID.Value);行 37: 行 38: 源文件: d:\\website\\Ballot_v20081020\\WebUI\\UserControls\\BallotDetail.ascx.cs    行: 36堆栈跟踪:[SqlException (0x80131904): 字符串 ')' 后的引号不完整。')' 附近有语法错误。]   System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection) +925466   System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection) +800118   System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj) +186   System.Data.SqlClient.TdsParser.Run(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj) +1932   System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async) +196   System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(DbAsyncResult result, String methodName, Boolean sendToPipe) +269   System.Data.SqlClient.SqlCommand.ExecuteNonQuery() +135   ZFrameWork.DB.AdoHelper.ExecuteNonQuery(IDbCommand command) in F:\\项目代码\\SVN_Project\\Ballot\\Ballot.Lib\\ZFrameWork\\DB\\AdoHelper.cs:934   ZFrameWork.DB.AdoHelper.ExecuteNonQuery(IDbConnection connection, CommandType commandType, String commandText, IDataParameter[] commandParameters) in F:\\项目代码\\SVN_Project\\Ballot\\Ballot.Lib\\ZFrameWork\\DB\\AdoHelper.cs:1079   ZFrameWork.DB.AdoHelper.ExecuteNonQuery(String connectionString, CommandType commandType, String commandText, IDataParameter[] commandParameters) in F:\\项目代码\\SVN_Project\\Ballot\\Ballot.Lib\\ZFrameWork\\DB\\AdoHelper.cs:982   ZFrameWork.DB.TableAccess.ExecuteNoneQuery(String ConnectionName, String SQL, ProcDirection`1 prepare) in F:\\项目代码\\SVN_Project\\Ballot\\Ballot.Lib\\ZFrameWork\\DB\\TableAccess.cs:859   Ballot.DA.BallotDetailDA.UpdateVoteCount(Int32 incCount, String detailIDs) in F:\\项目代码\\SVN_Project\\Ballot\\Ballot.Lib\\Ballot.DA\\BallotDetailDA.cs:26   Ballot.BC.BallotDetailBC.UpdateVoteCount(Int32 incCount, String ballotIDs) in F:\\项目代码\\SVN_Project\\Ballot\\Ballot.Lib\\Ballot.BC\\BallotDetailBC.cs:30   UserControls_BallotDetail.ButtonVote_Click(Object sender, EventArgs e) in d:\\website\\Ballot_v20081020\\WebUI\\UserControls\\BallotDetail.ascx.cs:36   System.Web.UI.WebControls.Button.OnClick(EventArgs e) +105   System.Web.UI.WebControls.Button.RaisePostBackEvent(String eventArgument) +107   System.Web.UI.WebControls.Button.System.Web.UI.IPostBackEventHandler.RaisePostBackEvent(String eventArgument) +7   System.Web.UI.Page.RaisePostBackEvent(IPostBackEventHandler sourceControl, String eventArgument) +11   System.Web.UI.Page.RaisePostBackEvent(NameValueCollection postData) +33   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +1746   修复方案：  过虑或类型转换。   版权声明：转载请注明来源 Jannock@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2010-08-30 09:06 厂商回复： 非常感谢，我们已经在处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}