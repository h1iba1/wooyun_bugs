{"id": 15838, "wybug_id": "wooyun-2012-013915", "wybug_title": "陕西、四川、重庆等移动网上营业厅验证码设计缺陷", "wybug_corp": "139移动互联", "wybug_author": "lijiejie", "wybug_date": "2012-10-26 16:45", "wybug_open_date": "2012-12-10 16:45", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-10-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-10-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-11-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-11-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-10：\t细节向公众公开  简要描述： 移动多个省份网上营业厅的验证码设计存在严重缺陷，形同虚设。 包括陕西、四川、重庆、贵州、辽宁、云南、山东等 详细说明：   陕西移动网上营业厅的验证码设计存在严重缺陷\n\n这体现在：1. 验证码是规则纯数字，识别太简单。2. 一次下载验证码，可反复使用，验证码不过期。3. wap网厅，可直接查看用户个人信息（姓名、家庭住址等），缺少获取短信动态码的流程。 http://wap.sn.10086.cn/我编写了一个用于破解网厅口令，批量扫号的小工具：\n\n填入一个起始手机号，要破解的密码，即可开始批量检测。 密码不可为以下类型：     //连号：如“123456”或“345678”    //重复号码：如“666666”或“000000”    //客户手机号码中的连续6位数字 下载该测试工具（附VB6源代码）：http://www.lijiejie.com/upload/get-SN10086-Users.zip上述漏洞如果被非法利用，可能导致大量个人信息泄露。   漏洞证明：  \n\n   修复方案：  修复的方法可以是:1. 更换验证码，采用更好的设计。2. 把验证码设计成每次提交后过期。3. wap网厅，在获取敏感信息时，增加短信动态码获取。四川移动、重庆移动也存在类似安全问题，其他省份未一一测试。   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-10-30 22:38 厂商回复： CNVD确认漏洞情况，已转由CNCERT统一协调中国移动集团公司处置。这个验证码一次性验证的机制问题在CNVD网站开发过程中也存在过，可造成遍历或破解绕过。涉及用户信息保护，rank 10 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-10-27 00:07 |    \t\tLeadUrLife \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:14        | 好好学习 天天向上)\t\t \n  好吧，右击源码有惊喜。。。唉  最终还是被爆出来了。。    \n     2012-10-30 09:17 |    \t\talong \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:7        | 关注信息安全，阿龙)\t\t \n  这些都实测过，还是仅目测？期待中......    \n     2012-12-10 21:08 |    \t\tedgerror \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n  陕西移动改了,数字变成字母,别的都没做.继续爆吧    \n     2012-12-13 11:13 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  缺陷关联： WooYun: 百度币卡充值图片验证码无效 （验证码没贯彻一次性验证）    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}