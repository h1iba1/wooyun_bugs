{"id": 16332, "wybug_id": "wooyun-2012-012829", "wybug_title": "湖北某售票网站短信验证码漏洞", "wybug_corp": "湖北公路客运（集团）有限公司", "wybug_author": "fqj1994", "wybug_date": "2012-09-28 11:18", "wybug_open_date": "2012-11-12 11:19", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-10-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-10-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-10-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-11-12：\t细节向公众公开  简要描述： 1、绕过短信验证码2、绕过发送的时间间隔60s3、发送任意验证码到任意号码 详细说明：  湖北公路客运（集团）有限公司售票网站订票地址http://www.hbglky.com/service/tickets_inquires/tickets_and_inquires.shtml的下订单页面的短信验证可以绕过。理由如下。订单页面第185行\nif (document.Input.YZM.value!=yzm){\t\t\talert(\"验证码错误\");\t\t\tdocument.Input.YZM.focus();\t\t\treturn false;\t\t}\n验证验证码正误是本地进行的。并且yzm的产生也是在本地进行的，下订单的页面第201行\nyzm = parseInt(Math.random()*65535).toString(16);\n其次，也可以绕过发送时间间隔60s的限制，因为限制是在客户端上进行的，将按钮的disabled去掉就好了。最后，验证码发送的短信接口可以利用。比如可以用js将yzm改成其他的字符串，利用接口发送其他短信（比如hello world）。也许可以用短信接口来聊天。   漏洞证明：  很明显的。   修复方案：  1、服务器生成验证码，然后发送。2、服务器限制时间   版权声明：转载请注明来源 fqj1994@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-10-01 22:20 厂商回复： CNVD根据原理分析确认漏洞情况，暂未及时进行复现。客户端验证是个大问题，开发方应该培养这方面的安全意识。按部分影响机密性、可用性、完整性进行评分，rank=7.48*1.1*1.2=9.873 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-09-28 13:09 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  发送任意验证码到任意号码？    \n     2012-10-01 12:29 |    \t\tfqj1994 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | NULL)\t\t \n  @xsser 对。现在不方便说，等公开吧。漏洞可以产生短信炸弹+短信聊天。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}