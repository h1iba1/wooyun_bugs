{"id": 68225, "wybug_id": "wooyun-2015-0130310", "wybug_title": "大米CMSFV5.53遍历目录", "wybug_corp": "damicms.com", "wybug_author": "Maxson", "wybug_date": "2015-08-04 14:14", "wybug_open_date": "2015-11-04 09:30", "wybug_type": "任意文件遍历/下载", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["目录遍历", "敏感信息泄漏", "参数未过滤"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-09：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-04：\t细节向公众公开  简要描述： 漏洞成因：未严格过滤参数 详细说明：  \nhttp://127.0.0.1/damicms/del_bom.php?dir=\n代码如下：\n\n\nif (isset($_GET['dir'])){    $basedir=$_GET['dir'];}else{    $basedir = '.';}$auto = 1;checkdir($basedir);function checkdir($basedir){if ($dh = opendir($basedir)) {  while (($file = readdir($dh)) !== false) {   if ($file != '.' && $file != '..'){    if (!is_dir($basedir.\"/\".$file)) {     echo \"filename: $basedir/$file \".checkBOM(\"$basedir/$file\").\" <br>\";    }else{     $dirname = $basedir.\"/\".$file;     checkdir($dirname);    }   }  }closedir($dh);}}\n   漏洞证明：  \nhttp://127.0.0.1/damicms/del_bom.php?dir=\n代码如下：\n\n\nif (isset($_GET['dir'])){    $basedir=$_GET['dir'];}else{    $basedir = '.';}$auto = 1;checkdir($basedir);function checkdir($basedir){if ($dh = opendir($basedir)) {  while (($file = readdir($dh)) !== false) {   if ($file != '.' && $file != '..'){    if (!is_dir($basedir.\"/\".$file)) {     echo \"filename: $basedir/$file \".checkBOM(\"$basedir/$file\").\" <br>\";    }else{     $dirname = $basedir.\"/\".$file;     checkdir($dirname);    }   }  }closedir($dh);}}\n   修复方案：  过滤   版权声明：转载请注明来源 Maxson@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2015-08-06 09:29 厂商回复： 很多PHP初学者用记事本编辑模板或php文件产生bom头 ，造成AJAX不能正确执行或JSON数据返回错误，这个del_就是删除bom头的 由于是第三方编写 没对代码审计 造成邪路文件路径，已修正 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}