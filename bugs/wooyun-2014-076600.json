{"id": 50848, "wybug_id": "wooyun-2014-076600", "wybug_title": "芒果云KODExplorer存储型xss（一）", "wybug_corp": "千帆网络工作室", "wybug_author": "Bird", "wybug_date": "2014-09-19 11:44", "wybug_open_date": "2014-12-18 11:46", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-22：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-18：\t细节向公众公开  简要描述： 麻烦审核再次仔细看一遍 详细说明：  我没说官方demo的public是可写的。而是实际下载，应用到自己的服务器的默认是可写的。是下载的版本默认配置，官网demo没有用默认配置。如果审核不信可以去下载测试：http://pan.baidu.com/s/1eQd4I9W#dir/path=%2Fkodexplorer之前的官网链接是为了让审核大哥看一下，这个东西是可以实现的。官网的public目录是专门设置成不可写的，不是程序默认配置。官网demo出于对官网服务器的安全考虑，不仅仅禁止了public写入，还禁止了重命名。但这一切都不是kod的默认配置，default组的默认权限是可以上传文件到public目录的。最后说一句，我虽然技术有限，不能和大神比，但也绝对不会恶心地去做一些虚假的事情。   漏洞证明：  default用户组可以在公共目录上传文件，文件名拦截特殊符号，通过改包的方式可以插入恶意代码。附上一个自己搭建的测试截图和用户组设定、上传可行性证明：添加default用户test：\n\n证明default有权限上传至公共目录：\n\n当打开该目录的时候：\n\n   修复方案：  虽然看起来是一个self-xss，但实际上是可以被利用的。如果我测试不通过是不会发的，每一个问题都是在我自己的机子上跑过的。虽然技术很差，但决不会做虚假的事情。   版权声明：转载请注明来源 Bird@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-09-19 11:51 厂商回复： 演示demo做了修复，下个版本会加入。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-19 11:55 |    \t\tBird \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:25        | Stay hungry. Stay foolish.)\t\t \n  @千帆网络工作室 当天就提交了- - 不过审核大哥一直拦着，也怪我没说清楚。。。    \n     2014-09-19 12:08 |    \t\t千帆网络工作室(乌云厂商)\t\t \n  @Bird 之前都没怎么在意，以后学着点了；xss还是挺严重的。    \n     2014-09-19 12:09 |    \t\tBird \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:25        | Stay hungry. Stay foolish.)\t\t \n  @千帆网络工作室 哈~ xss还是有威胁的。 等更新啦~ 我php渣~    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}