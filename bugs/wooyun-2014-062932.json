{"id": 2804, "wybug_id": "wooyun-2014-062932", "wybug_title": "大汉网络JCMS Getshell", "wybug_corp": "南京大汉网络有限公司", "wybug_author": "矿主", "wybug_date": "2014-06-06 16:11", "wybug_open_date": "2014-07-23 18:58", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-23：\t细节向公众公开  简要描述： 大汉网络JCMS Getshell，综合利用。 详细说明：  通过之前的任意文件下载等漏洞能够拿到管理员密码：\n\n登录初始化管理平台：\n\n在上传许可的地方，只在本地做了后缀明判断：\n\n绕过本地js后缀限制，上传shell：\n\n   漏洞证明：  opr_licenceinfo.jsp 代码分析：\n//上传文件if(strBillStatus.equals(\"U\")){//文件路径，上传目录为系统根目录String strDictionary =  application.getRealPath(\"\") +\"/\";java.io.File file = new java.io.File( strDictionary );//准备上传CommonUploadFile upload = null;boolean bResult = false;upload = new CommonUploadFile(strDictionary,\"\");try{//直接上传文件没有任何过滤bResult = upload.uploadFile(request);}catch(Exception e ){}try{if( bResult )strAlert += \"alert('文件上传成功!');\" ;\n   修复方案：  限制上传文件后缀。   版权声明：转载请注明来源 矿主@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-06-09 09:12 厂商回复： 感谢关注 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-06 16:23 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  mk    \n     2014-06-06 16:56 |    \t\tsex is not show  \t\t\t( 普通白帽子  |\t\t\t        Rank:1495 漏洞数:233        | 这家伙真懒！)\t\t \n  求源码    \n     2014-06-09 09:16 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @sex is not show  十万火急啊，哈哈    \n     2014-06-29 23:31 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  @矿主大牛，请问这是可逆的吗 -> md5.decrypt(strNewPwd, \"jcms2008\");    \n     2014-10-22 15:05 |    \t\t小博博 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:9        | .)\t\t \n  绕过本地js限制 是通过burp绕过的？ 还是怎么绕过的？    \n     2014-10-23 15:24 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  上传license那不是很早就提交了？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}