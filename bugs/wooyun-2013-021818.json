{"id": 13385, "wybug_id": "wooyun-2013-021818", "wybug_title": "TP-Link（普联技术）官方网上商城任意账户邮箱&amp;密码修改", "wybug_corp": "深圳普联技术有限公司", "wybug_author": "kgra", "wybug_date": "2013-04-14 14:28", "wybug_open_date": "2013-04-19 14:28", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当导致攻击界面扩大", "认证缺陷", "盲目信任用户数据", "越权操作", "敏感操作校验不足", "敏感接口缺乏校验", "平行权限", "任意密码修改", "重置密码"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 可以修改任意账户的邮箱，然后再通过找回密码的方式修改密码，让你找回密码都没办法。。。 详细说明：  步骤1:当然是先注册3个邮箱，2个TP-link官网账户假设用户A账户对应A邮箱，B账户对应B邮箱。剩下未注册的邮箱为C步骤2：A账户中修改账户资料，请求如下\n\n将memberId字段修改为B用户的id（36263，事先获取好的，实际利用中可以通过遍历的方式，5位的纯数字遍历应该很简单的），邮箱改为C，用户名改为admin，发送请求\n\n提交修改后的请求后，会看到客户端会重新请求，内容如下，为什么要这样搞？不是很清楚，也没深入，各位大牛可以看下\n\n步骤3：既然邮箱已经改了，那该密码就不是问题了。在登录页面通过忘记密码的方式找回密码，邮箱当然是填C了，此时受到了邮件哦，如下图\n\n重置密码后，欢快的登录admin用户，登录成功。\n\n此时看看admin账户的memberId，仍然是B用户的id\n\n如果通过id遍历，那么便可以...   漏洞证明：  详细说明中的截图   修复方案：  这个…服务端限制下不允许修改用户名比较好，修改资料的时候验证id与用户名的绑定关系。其实你们比较会。怎么改交流下撒，亲～   版权声明：转载请注明来源 kgra@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-04-19 14:28 厂商回复：  漏洞Rank：9  (WooYun评价) 最新状态： 2013-04-22：已修复  ", "replys": "漏洞评价：\n评论\n     2013-04-19 16:37 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  厂商一直再忽略。。。    \n     2013-04-19 16:56 |    \t\tAqua \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | hello world !)\t\t \n  竟然忽略。。。    \n     2013-04-19 17:45 |    \t\tkgra \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:3        | 一波还未平息，一波洞又来袭)\t\t \n  @深圳普联技术有限公司 @pangshenjie @ Aqua忽略肯定是有原因的。说明我找的漏洞不符合厂商的口味，如果发个成功进入内网的漏洞，应该不会忽略吧    \n     2013-04-19 17:45 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  @Aqua 不知道是不是厂商不太明白，修复了感谢然后忽略    \n     2013-04-19 17:46 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  @kgra 官网的shell他们也忽略、    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}