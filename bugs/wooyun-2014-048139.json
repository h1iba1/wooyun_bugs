{"id": 5007, "wybug_id": "wooyun-2014-048139", "wybug_title": "AuditSec运维操作审计-可获得堡垒机密码", "wybug_corp": "yinji.com.cn", "wybug_author": "leoX", "wybug_date": "2014-01-07 12:03", "wybug_open_date": "2014-04-07 12:03", "wybug_type": "默认配置不当", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["未过滤"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-07：\t细节向公众公开  简要描述： activex控件未对 启用软件 过滤 导致可获得堡垒机密码 详细说明：  1.登录堡垒机2.选择 需要ssh的机器3.选择 使用的终端工具  编写bat   \necho %1         echo %2        pause\n  效果如图2  显示用户名密码   直接连接堡垒机地址 结果 图3  需要突破的是权限的提升  此堡垒目的是安全运维，限制终端类型 来加强安全策略。出现此问题 实属不该。。。。   漏洞证明：  图1\n\n图2\n\n图3\n\n   修复方案：  过滤终端~ 加密   版权声明：转载请注明来源 leoX@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-01-08 11:45 厂商回复： 感谢乌云的反馈和路人甲的报告。1. 此漏洞获取的是连接保垒机的用户密码，这个一般是用户自己知道的密码。（就像本机用户可以想办法看到IE中缓存的信息一样）2. 即使采取加密，在远程连接时仍然要先解密再传输，通过内存察看工具，仍然能看到用户自己的密码。结合以上两条，给5分。银基向来十分重视信息安全和隐私保护，再次感谢乌云和路人甲。 如有争议请留言，谢谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-07 12:26 |    \t\t摸了你 \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:17        | 1shitMVqBjCKrnRvSoixMx6RKpG9J8pBM)\t\t \n  怎么感觉有点不靠谱，activex代填，不会存储堡垒机的密码吧，要存储应该也是存储一个有时效的类似token的串到服务器进行验证吧。这也太奇葩了，获取后有登陆成功的测试么？    \n     2014-01-07 15:37 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  activex控件未对 启用软件 过滤    就这段话目前没看明白什么意思    \n     2014-01-08 11:51 |    \t\t上海银基信息科技股份有限公司(乌云厂商)\t\t \n  补充：由于是调用putty类似的第三方工具，如果对调用参数进行加密的话，第三方工具会无法识别。    \n     2014-01-08 14:53 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @上海银基信息科技股份有限公司 这个做法还是可以理解的    \n     2014-01-08 21:52 |    \t\t上海银基信息科技股份有限公司(乌云厂商)\t\t \n  @wefgod 谢谢你的理解。     \n     2014-01-09 09:47 |    \t\t摸了你 \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:17        | 1shitMVqBjCKrnRvSoixMx6RKpG9J8pBM)\t\t \n  @上海银基信息科技股份有限公司 这种做法 已经不是堡垒机的做法了。putty代填的密码，可以不是真正的密码，是可以是随机生成数值的。你们这堡垒机太弱了吧。你这种机制，如果用户，保存session，启不是可以一直登陆。    \n     2014-01-09 10:41 |    \t\t上海银基信息科技股份有限公司(乌云厂商)\t\t \n  @摸了你 您说的没错，确实可以一直登录，只不过用户不用再次重复输帐号而已。就像本地浏览器缓存用户帐号然后代填的做法一样。    \n     2014-01-09 11:00 |    \t\tleoX \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 小白~)\t\t \n  @上海银基信息科技股份有限公司 今日放出 第二弹~ 利用~    \n     2014-01-09 11:02 |    \t\t摸了你 \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:17        | 1shitMVqBjCKrnRvSoixMx6RKpG9J8pBM)\t\t \n  @上海银基信息科技股份有限公司 所以这种做法不对呀，用户可以不用再登陆你们平台，而通过session来访问堡垒机了。如果通过这种方式访问资源，是不会有用户登陆平台的日志吧，也就没法做用户与资源访问的关联。    \n     2014-01-09 11:03 |    \t\t摸了你 \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:17        | 1shitMVqBjCKrnRvSoixMx6RKpG9J8pBM)\t\t \n  @leoX 你这客户，太不老实了...    \n     2014-01-09 11:13 |    \t\tleoX \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 小白~)\t\t \n  @摸了你 我只是小菜~ 偶然机会使用到~    \n     2014-01-09 15:08 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @上海银基信息科技股份有限公司 呃，说是可以理解，但是不一定这样做就是完全正确的哦，只是小菜路过而已    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}