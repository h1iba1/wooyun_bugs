{"id": 25604, "wybug_id": "wooyun-2015-0122337", "wybug_title": "锐捷EG易网关guest越权,可执行任意命令，通过vpn直接渗透内网", "wybug_corp": "ruijie.com.cn", "wybug_author": "纳米翡翠", "wybug_date": "2015-06-23 19:17", "wybug_open_date": "2015-06-25 11:12", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-25：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 最近看到锐捷关于rsr  npe的漏洞正好身边有人使用锐捷的产品，但是个EG网关，借过来研究了一下发现问题同样出现在锐捷的EG网关上，而且发现尽然存在任意命令执行 详细说明：     漏洞证明：  1.百度搜索：“请输入您的RG-EG易网关的用户名和密码”\n\n\n\n\n\n\n\n\n\n2，找了一个登录抓包\n\n\n\n发现参数很有意思command=执行的命令strurl=应该是当前的运行模式挖掘后发现有exec config等mode=priv_exec直接特权模式3.于是show run一下\n\n注意到这里有一个webmaster level 0 1 2通过了解0的级别是最高的，也就是权限是最好的，1和2 依次减低那我是否可以直接通过执行webmaster level 0 username guest password guest来提升权限呢？试一下\n\n把strurl改成config即可执行成功如此说来我就可以直接执行所有的命令啦，但没必要这么麻烦了。再查看show run最下面发下有telnet的密码信息\n\n于是直接telnet进来了\n\n然后嘛，就是配置一个vpn，直接内网漫游了\n\n好吧，我是好孩子，配置已经还原了试了百度搜索出来的十来个链接，发现弱口令都有http://www.jincai.sh.cn:12315/index.htmhttp://jsgz.cn/http://xczp.qhrcsc.comhttp://lbszx.comhttp://www.zmjsjt.cnhttp://wcjy.zhjedu.cn/index.htmhttp://www.lflszx.comhttp://www.jyxqxx.com:88/index.htmhttp://www.lvtaotao.comhttp://oa.haotel.comhttp://www.tzcgps.cn/index.htm百度那么多没敢一个一个试话说我看到其它漏洞，厂商回复已经做了补丁，但这些还在受害的用户，明显他们还不知道该问题，那该怎么办？对了，话说最近看到锐捷发了一个新网关产品 eg350，看链接好像web是用的php的，通过挖掘已经发现部分漏洞，版本号（EG_RGOS 11.1(3)B1T3, Release(02162111)），但不知道是不是厂商的遗留版本，如果不是请告知，我会补出来，如果是那就忽略吧。   修复方案：     版权声明：转载请注明来源 纳米翡翠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2015-06-24 09:42 厂商回复：   最新状态： 2015-06-25：设备软件版本升级到最新版本即可解决此问题。 2015-06-25：设备软件版本升级到最新版本即可解决此问题  ", "replys": "漏洞评价：\n评论\n     2015-06-24 00:52 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  关注中...    \n     2015-06-25 16:41 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  如何配置VPN呢？    \n     2015-06-25 20:03 |    \t\tSecurity \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:9        )\t\t \n  @scanf http://www.ruijie.com.cn/fw/wt-eg-1/    \n     2015-06-26 20:44 |    \t\t纳米翡翠 \t\t\t( 普通白帽子  |\t\t\t        Rank:316 漏洞数:42        | 翡翠虽小、价值极高，追求极致、共建安全)\t\t \n  @scanf so easy    \n     2015-06-26 21:36 |    \t\t纳米翡翠 \t\t\t( 普通白帽子  |\t\t\t        Rank:316 漏洞数:42        | 翡翠虽小、价值极高，追求极致、共建安全)\t\t \n  妈妈问我，没有责任心的厂家能做大吗？    \n     2015-06-28 10:24 |    \t\twy007 \t\t\t( 实习白帽子  |\t\t\t        Rank:95 漏洞数:10        | 其实我是一名卧底...)\t\t \n  赞一个，感觉思路很不错！    \n     2015-06-28 10:34 |    \t\tnzk1912 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:10        | 软件开发8年了，也来挖挖漏洞，为创建安全...)\t\t \n  程序员思维，非产口化思维。为什么不推进用户软件升级？明知有缺陷又不招回，难道要与日本汽车同流？    \n     2015-06-28 12:49 |    \t\t纳米翡翠 \t\t\t( 普通白帽子  |\t\t\t        Rank:316 漏洞数:42        | 翡翠虽小、价值极高，追求极致、共建安全)\t\t \n  @nzk1912 所以说厂家不怎么负责任    \n     2015-06-28 21:54 |    \t\t大漠長河 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:7        | ̷̸̨̀͒̏̃ͦ̈́̾( 天龙源景区欢迎您...)\t\t \n   WooYun: 锐捷EG系列网关第三次绕过（系列漏洞终结版） 我不想粗口 你们的最新版本这个问题解决了吗  不解决漏洞巡诊客户还有啥意义。@ruijie.com.cn    \n     2015-06-28 22:10 |    \t\t大漠長河 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:7        | ̷̸̨̀͒̏̃ͦ̈́̾( 天龙源景区欢迎您...)\t\t \n   WooYun: 锐捷网络NBR系列产品存在越权读取所有账号密码等问题 解决了吗. 不修补漏洞派几个工程师到处巡检就能安抚你们受伤的客户吗。出离愤怒    \n     2015-06-28 22:13 |    \t\t大漠長河 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:7        | ̷̸̨̀͒̏̃ͦ̈́̾( 天龙源景区欢迎您...)\t\t \n  @纳米翡翠  这厂商水深。。。    \n     2015-06-28 23:05 |    \t\t大漠長河 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:7        | ̷̸̨̀͒̏̃ͦ̈́̾( 天龙源景区欢迎您...)\t\t \n  未查看 web 2015.04.27.16 重要更新：修复用户跨权限访问无权限页面漏洞 虽然反射弧长点，但终究还是修复了。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}