{"id": 10372, "wybug_id": "wooyun-2013-028336", "wybug_title": "阿蛮KTV系统 任意刷RMB漏洞 刷会员 钱来的如此容易", "wybug_corp": "阿蛮歌霸卡拉OK点歌", "wybug_author": "默小文", "wybug_date": "2013-07-10 19:17", "wybug_open_date": "2013-08-24 19:18", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "安全意识不足", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-10：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-08-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 本来今天我老爸想在家里弄个KTV系统唱歌的   于是我就弄了一个阿蛮KTV系统  我老爸下歌嫌速度慢了  问我能不能给他弄个KTV红钻会员 红钻会员可以享受25倍速度下载  我一看 179元/月 这不是坑爹麽？软件上写着永久免费  就是非要搞个会员制度 来限制下载速度  唉 我也是被逼的  于是 就有了后文  继PKAV的教育  后文如此精彩 详细说明：  问题来源于：www.amanktv.cn其实只是可以刷K币  K币是可以代替人冥币支付的。1.随意注册一个帐号 \n\n2.下载客户端有个开通会员制度\n\n3.看看会员  都挺贵的喔~   \n\n4.客户端登录我了们的帐号之后  显示免费用户   而且K币为0。\n\n5.看看K币与RMB的兑换标准   1K币 = 1RMB  好贵哦~\n\n6.登录网站显示尚未开通会员。\n\n7.精彩时刻来了   在刚才开通会员的页面  点击开通红钻会员  跳转后选择 “用K币兑换”   这是在“2年”那里审查元素  把Value的值改成一个任意非零负值\n\n8.此时需要付款的金额也随之变成了一个负数   ￥-998 K币\n\n9.看  因为没有对负值过滤  所以支付成功了 \n\n 10.然后我们去“我的帐户”看看 截止日期变成了两年前的今天  K币变成了998个\n\n11.我们再用同样的方法去再续费一遍会员  这次就不改变value了  直接正常开通 会员就会变成可用状态了  看图：\n\n12.开通后去测试下载     这下载速度明显的翻了一个翻   亲  我只是用这个帐号下了几首歌  您不会计较的是吧  毕竟我下完了就立刻提交漏洞了    没有给您照成太大的危害吧    那几K币就当是送我的吧   漏洞证明：  \n\n\n\n多刷了点  我只是测试  你不愿意你就收回去吧   给我玩几天再收回去好不？   修复方案：  对负值过滤  修复方法很多  你懂的。   版权声明：转载请注明来源 默小文@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-07-11 10:42 |    \t\tDeep \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 一个小白.想要变小黑.)\t\t \n  一看就是富二代。    \n     2013-07-16 09:47 |    \t\t默小文 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | \"><img src=x onerror=alert(1);> <img src...)\t\t \n  @Deep 穷鬼一个。  0 0    \n     2013-07-22 09:51 |    \t\t紫林 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:4        | 喜欢白帽子)\t\t \n  哎，看不见细节 忽忽    \n     2013-07-23 12:59 |    \t\t默小文 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | \"><img src=x onerror=alert(1);> <img src...)\t\t \n  @紫林 披露状态：2013-07-10： 积极联系厂商并且等待厂商认领中，细节不对外公开亲 快啦快啦~     \n     2013-07-29 12:43 |    \t\t紫林 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:4        | 喜欢白帽子)\t\t \n  @默小文 貌似你们比我还激动    \n     2013-08-02 21:33 |    \t\t默小文 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | \"><img src=x onerror=alert(1);> <img src...)\t\t \n  @紫林 现在的厂商都不重视漏洞  就快公开了    \n     2013-08-02 21:34 |    \t\t默小文 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | \"><img src=x onerror=alert(1);> <img src...)\t\t \n  @紫林 我激动个毛线 我就是这样的人    \n     2013-08-02 21:56 |    \t\t紫林 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:4        | 喜欢白帽子)\t\t \n  @默小文 那是我激动了 呵呵     \n     2013-08-24 20:04 |    \t\tRootUser \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:5        | null)\t\t \n  这个和我上次弄了一个空包114里面的一样，一刷直接刷几千万    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}