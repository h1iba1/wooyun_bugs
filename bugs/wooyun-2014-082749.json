{"id": 48542, "wybug_id": "wooyun-2014-082749", "wybug_title": "我是如何登录任意新浪微博用户的（雷军微博演示）", "wybug_corp": "新浪", "wybug_author": "五道口杀气", "wybug_date": "2014-11-10 12:03", "wybug_open_date": "2014-12-25 12:04", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-25：\t细节向公众公开  简要描述： weibo.cn主域shell --> 审核源码 --> 调用内部接口获取任意用户SUB --> 登陆任意微博用户（所有权限） 详细说明：  神器又找到一个命令执行：http://weibo.cn/interface/***/***.php?ck=1&c=iphone&gsid=***&since_id=1;cat /etc/passwd;%23\n\n审核源码找到生成SUB的代码：\n\nmask 区域\n*****v4_wap/class/*****\n\n \npublic static function createSub($uid, $clienttype = CLIENT_TYPE_MOBILE_WEB, $dinfo = array(), $domain = '.weibo.cn') {\t\t$params                 = array();\t\t/* 不支持cookie的情况 不允许renew */\t\tif (System::isWapRequest() && !user_info_device::supportCookie()) {\t\t\t$params['subrenewdisable'] = 1;\t\t\t$clienttype = CLIENT_TYPE_MOBILE_APP;\t\t}        $ip                     = WapTool::getClientIP();\t\t$ua = (!empty($_GET['ua']) && !empty($_REQUEST['from'])) ? addslashes($_GET['ua']):$_SERVER['HTTP_USER_AGENT'];\t\t$dinfo['ua']\t\t\t= $dinfo['ua'] ? $dinfo['ua'] : $ua;        $dinfo                  = http_build_query($dinfo);\t\t$params['clienttype']   = $clienttype;        $params['entry']        = WAPLOGIN_SSO_ENTRY;        $params['uid']          = $uid;        $params['domain']       = $domain;        $params['ip']           = $ip;        $params['dinfo']        = $dinfo;        $params['m'] = md5($uid.$domain.$ip.$dinfo.$clienttype.WAPLOGIN_SSO_PIN);        $url = WAPLOGIN_SSO_SESS_CREATE_URL . '?' . http_build_query($params);        $ret = WapLogin::urlRequest($url, 1, 1);        $ret = json_decode($ret, true);        if (!$ret || $ret['retcode'] != '20000000' || !$ret['data']['sid']) {\t\t\ttttLogToFile('sub_create', date('H:i:s') . '|FAIL|' . self::reqFrom() . '|' . $_SERVER['REQUEST_URI'] . '|' .implode('|', $params) . '|' . json_encode($ret));\t\t\treturn false;\t\t}\t\ttttLogToFile('sub_create', date('H:i:s') . '|SUSS|' . self::reqFrom() . '|' . $_SERVER['REQUEST_URI'] . '|' . implode('|', $params) . '|' . $ret['data']['sid']);        return $ret['data']['sid'];    }\n请求雷军UID返回的SUB信息：\n\n成功登陆雷军微博：\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 五道口杀气@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-11-12 22:19 厂商回复： 感谢这位安全研究员给我们反馈的安全问题，当天中午已经迅速修复。辛苦了~！我们特别设定了一个微博账号@appsecssrc供大家安全测试和验证问题使用。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-10 12:04 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  一楼，记者拍这里    \n     2014-11-10 12:05 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  我草 要火!    \n     2014-11-10 12:05 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  我要上头条~~    \n     2014-11-10 12:05 |    \t\tnextdoor \t\t\t( 普通白帽子  |\t\t\t        Rank:325 漏洞数:74        )\t\t \n  又个洞    \n     2014-11-10 12:06 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  记者拍这里！！！    \n     2014-11-10 12:06 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  雷军、Finger，二龙，看这里....    \n     2014-11-10 12:06 |    \t\tdeepweb \t\t\t( 实习白帽子  |\t\t\t        Rank:67 漏洞数:9        | 2)\t\t \n  赶紧占个好位置    \n     2014-11-10 12:06 |    \t\tcreep \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:23        | 这家伙很懒，什么都没留下。)\t\t \n  留名    \n     2014-11-10 12:06 |    \t\txyang \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:51        | stay hungry stay foolish)\t\t \n  意思是sina的修复不顶用么？    \n     2014-11-10 12:07 |    \t\tzcy \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:15        )\t\t \n  ccav请看这里    \n     2014-11-10 12:08 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  冒泡    \n     2014-11-10 12:08 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  卧槽，主域被getshell啦？    \n     2014-11-10 12:09 |    \t\tloli  \t\t\t( 普通白帽子  |\t\t\t        Rank:550 漏洞数:52        )\t\t \n  ，，，要被玩坏了    \n     2014-11-10 12:10 |    \t\tsix-door \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:31        )\t\t \n  新浪频繁被射，是为哪般？到底是代码的扭曲还是运维的沦陷，敬请收看CCAV-13纪实频道--带你漫游新浪    \n     2014-11-10 12:10 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  怎么不是王思聪    \n     2014-11-10 12:11 |    \t\t′雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @小米 表示不服    \n     2014-11-10 12:12 |    \t\t马燕羊蝎子 \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:10        | 亲，啥时候请吃马燕羊蝎子。)\t\t \n  新浪频繁被射，是为哪般？到底是代码的扭曲还是运维的沦陷，敬请收看CCAV-13纪实频道--带你漫游新浪    \n     2014-11-10 12:13 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  听说某某被黑，难道王思聪不买乌云，你们想雷军买乌云一人给你们发个手机吗？    \n     2014-11-10 12:14 |    \t\tBeep \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:4        | 专注PHP漏洞挖掘)\t\t \n  我就是雷军！    \n     2014-11-10 12:17 |    \t\t末笔丶 \t\t\t( 普通白帽子  |\t\t\t        Rank:191 漏洞数:41        | 有阴影的地方必定有光.)\t\t \n  = =.都快被你们玩坏了    \n     2014-11-10 12:18 |    \t\t毕月乌 \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:16        | 猜猜我是谁？)\t\t \n  你们这些可恶的前排！    \n     2014-11-10 12:32 |    \t\tWindy \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:10        | 苦逼的民工)\t\t \n  mark！    \n     2014-11-10 12:32 |    \t\tloli  \t\t\t( 普通白帽子  |\t\t\t        Rank:550 漏洞数:52        )\t\t \n  @毕月乌 301喊你回家吃饭    \n     2014-11-10 12:38 |    \t\tWoodee \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 乌云路人甲，打脸pa pa pa)\t\t \n  新浪快被你们玩毁了    \n     2014-11-10 12:38 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  @新浪 上次不是说再也没人能上王思聪了么...这回怎么办呢? 准备被收购吧...    \n     2014-11-10 12:40 |    \t\twaterbug \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 我就是来给你点32个赞的！！！)\t\t \n  上个月绩效坏在你手里,这个月绩效又坏在你手里,恨死你了    \n     2014-11-10 12:40 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  。。。下次会登录谁的微博    \n     2014-11-10 12:47 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  mark    \n     2014-11-10 12:49 |    \t\t红客十年 \t\t\t( 普通白帽子  |\t\t\t        Rank:334 漏洞数:63        | 去年离职富士康，回到家中上蓝翔，蓝翔毕业...)\t\t \n  感谢这位安全研究员给我们提交的漏洞，请与我们联系讨论一下奖励。诚邀更多白帽子和我们一起保护新浪、微博的安全。 @王思聪 @雷军 今晚商量一下明天把乌云添加到购物车。    \n     2014-11-10 12:49 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n     2014-11-10 12:52 |    \t\tchock \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:15        | 今夜我们都是wooyun人，我们一定要收购长亭)\t\t \n  我是如何登录任意新浪微博用户的（罗永浩微博演示）     \n     2014-11-10 12:53 |    \t\tp4ssw0rd \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:92        | 不作死就不会死)\t\t \n  又是神奇的路人甲    \n     2014-11-10 12:57 |    \t\t大大灰狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:248 漏洞数:53        | Newbie)\t\t \n  卧槽    \n     2014-11-10 12:58 |    \t\tKnight \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:10        | 刚刚上洗手间，看到一个玉树临风的少年，气...)\t\t \n  CCAV看这里。    \n     2014-11-10 12:58 |    \t\tbey0nd \t\t\t( 普通白帽子  |\t\t\t        Rank:895 漏洞数:142        | 相忘于江湖，不如相濡以沫)\t\t \n  卧槽、又来..求关注我    \n     2014-11-10 13:02 |    \t\tSocial \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 我有舒肤佳，谁要看。)\t\t \n  CCAV看这里，妈妈我要上电视了    \n     2014-11-10 13:03 |    \t\tgoubuli \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:61        )\t\t \n  稍叼啊    \n     2014-11-10 13:10 |    \t\thughlvan \t\t\t( 实习白帽子  |\t\t\t        Rank:82 漏洞数:11        | 前半生拿命换钱，后半生拿钱换命，这就是理...)\t\t \n  这几天新浪不断被she    \n     2014-11-10 13:13 |    \t\t小红猪 \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:30        | Wow~~~哈哈~~~)\t\t \n  MARK    \n     2014-11-10 13:17 |    \t\t红客十年 \t\t\t( 普通白帽子  |\t\t\t        Rank:334 漏洞数:63        | 去年离职富士康，回到家中上蓝翔，蓝翔毕业...)\t\t \n  今天下午三时许，万达和小米联合召开记者发布会，将展示万达和小米联合收购乌云ppt，从此以后乌云更名为，万达小米乌云。    \n     2014-11-10 13:22 |    \t\tbingfeng \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 万丈红尘三杯酒，千秋大业一壶茶。)\t\t \n  只能默默的关注~    \n     2014-11-10 13:23 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  又来了！！！CCAV看这里！    \n     2014-11-10 13:27 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  不会是同一个人吧    \n     2014-11-10 13:33 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  厂家还没出来辟谣？    \n     2014-11-10 13:51 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @M4sk 记者拍这里，我是乌云网最帅的男人，我叫Mosuan    \n     2014-11-10 13:52 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  我已经猜到是谁提交的了    \n     2014-11-10 13:53 |    \t\t咸鱼翻身 \t\t\t( 普通白帽子  |\t\t\t        Rank:576 漏洞数:108        )\t\t \n  道口。。。。。    \n     2014-11-10 13:58 |    \t\t10457793 \t\t\t( 普通白帽子  |\t\t\t        Rank:867 漏洞数:128        | 说好的借，为什么从来不还？O(∩_∩)O)\t\t \n  又来？    \n     2014-11-10 13:59 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  留名，记者拍这里。    \n     2014-11-10 14:11 |    \t\t酸奶、 \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:27        )\t\t \n  路人甲永远是这样牛叉。    \n     2014-11-10 14:12 |    \t\t酸奶、 \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:27        )\t\t \n  ＠新浪      下一个人会是谁呢。期待ing    \n     2014-11-10 14:12 |    \t\t大白菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:19        )\t\t \n  主域shell 这个问题比较大~    \n     2014-11-10 14:13 |    \t\tAZ0NE \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        | AZONE)\t\t \n  ccav妓者报道    \n     2014-11-10 14:21 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  马克    \n     2014-11-10 14:54 |    \t\t毕月乌 \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:16        | 猜猜我是谁？)\t\t \n  @loli 我对小loli比较感兴趣~    \n     2014-11-10 15:01 |    \t\tT-MAC \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:2        )\t\t \n  雷军又躺枪    \n     2014-11-10 15:02 |    \t\t残废 \t\t\t( 普通白帽子  |\t\t\t        Rank:179 漏洞数:40        | 我是残废，啦啦啦啦)\t\t \n  ccav看这里    \n     2014-11-10 15:14 |    \t\tdebbbbie \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 深藏功与名 - A Rubyist)\t\t \n  @红客十年 感觉叫万小云比较好听哎。。    \n     2014-11-10 15:18 |    \t\tH1d3r \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:2        | 　‮)\t\t \n  牛×~~~ 路过的~~~    \n     2014-11-10 15:19 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  乌小万    \n     2014-11-10 15:46 |    \t\ts3xy \t\t\t( 核心白帽子 |\t\t\t        Rank:832 漏洞数:113        | 相濡以沫，不如相忘于江湖)\t\t \n  @五***气 为何如此屌    \n     2014-11-10 15:53 |    \t\tp0di \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:17        | 1+1 = 2 ？)\t\t \n  敢不敢把拿Shell的方式公布下。    \n     2014-11-10 16:39 |    \t\t红客十年 \t\t\t( 普通白帽子  |\t\t\t        Rank:334 漏洞数:63        | 去年离职富士康，回到家中上蓝翔，蓝翔毕业...)\t\t \n  今天下午16时30分，万达和小米正式收购了乌云，从此乌云改名万小云。同时也有网友提出建议应该叫云小万，具体期待明天早上万达 小米 乌云联合记者会，这里是前方ccav记者十年为您报道。    \n     2014-11-10 18:00 |    \t\t鸡鸡 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:4        )\t\t \n  主站Shell...真有你的。    \n     2014-11-10 18:49 |    \t\tPooke \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 菜鸟团撸过。)\t\t \n  把这些凑一堆，放出来，更好看。    \n     2014-11-11 10:23 |    \t\ttestKaI \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        )\t\t \n  主站shell？这么厉害    \n     2014-11-11 11:00 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  主站shell？这么厉害,    \n     2014-11-11 11:32 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  这个接口好给力啊！    \n     2014-11-11 11:52 |    \t\t大大灰狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:248 漏洞数:53        | Newbie)\t\t \n  这是个什么接口    \n     2014-11-11 13:24 |    \t\t路人N \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        )\t\t \n  m    \n     2014-11-12 22:50 |    \t\t第四维度 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:34        | 谦谦君子，温润如玉)\t\t \n  记者拍这里！！！    \n     2014-11-13 00:45 |    \t\ticow \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:11        | 平心静气...)\t\t \n  主站shell？这么厉害,    \n     2014-11-13 09:11 |    \t\t达浪 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 14X security team)\t\t \n  王思聪再不买就被雷军买了    \n     2014-12-02 22:53 |    \t\tCoffee \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:15        | Corie, a student of RDFZ.)\t\t \n  这是一个挖洞拼神器的年代    \n     2014-12-04 13:54 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  惊现神器！求神器！！    \n     2014-12-07 22:58 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  我凑，这是啥神器，这么叼？    \n     2014-12-25 12:15 |    \t\t默秒全 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | a....)\t\t \n  我只是想求神器的    \n     2014-12-25 12:26 |    \t\tc2an \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 学习中)\t\t \n  公开时间：\t1970-01-01 08:33    \n     2014-12-25 21:57 |    \t\tlock \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:6        | 菜鸟一枚，大牛多指教)\t\t \n  公开时间：\t1970-01-01 08:33    \n     2014-12-26 00:44 |    \t\tWoodee \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 乌云路人甲，打脸pa pa pa)\t\t \n  秒修复啊，赞研发    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}