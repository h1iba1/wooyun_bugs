{"id": 59199, "wybug_id": "wooyun-2014-048276", "wybug_title": "搜狐某分站两处xss漏洞", "wybug_corp": "搜狐", "wybug_author": "Mosuan", "wybug_date": "2014-01-08 16:02", "wybug_open_date": "2014-02-22 16:02", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "利用技巧", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-22：\t细节向公众公开  简要描述： 貌似很多分站都采用这个程序 详细说明：  在汽车投诉（http://tousu.auto.sohu.com）随便点个投诉进去评论插入xss代码我在投诉帖子（http://tousu.auto.sohu.com/tousu14499.shtml）这里插入代码<body/onload=alert(点云安全防线 by Mosuan)>之前插入是无压力弹窗，现在被过滤了，测试xss的时候我习惯在google浏览器测试，下面是在google浏览器下测试的。\n\n弹窗了\n\n查看下源码\n\n确实入库了，google下无压力，但是google浏览器有几个普通的网民用？可想而知，光是网吧和跟机系统里面的默认浏览器都是ie，所以我们要在ie下弹窗才算成功~~！！在IE环境下插入代码<img src=x onerror=alert(16)>\n\n刷新弹窗\n\n再来查看一下源码\n\nok了 入库了第二枚xss：测试账号vikingsb，偶遇点云安全防线内部成员mango，他貌似没测试成功，换个方式弹窗，不一定要帖子！！\n\n废话不多说，直接上流程。此xss通杀搜狐车会里面的所有版块，下面会有证明需要申请加入别的版块，但是没什么影响，一加入就能成功了。在我为搜狐提建议这版块发投票活动http://saa.auto.sohu.com/club/createVote.at?bid=11197候选项插入代码<body/onload=alert(1)>\n\n回到http://saa.auto.sohu.com/auto查看，先弹出来的是script标签里面的hello by Mosuan，那是我之前插的，那时候没限制，现在限制25字符了。Google浏览器下查看\n\nIE下查看\n\n查看源码绕过25字节\n\n回到我的空间查看我的动态照样弹窗！！http://i.auto.sohu.com/user/show/outerEvent.at?userId=5027932\n\n\n\n   漏洞证明：  看详细说明，我敢说你们很多分站都有这种程序，通杀很多吧??   修复方案：  过滤，转义   版权声明：转载请注明来源 Mosuan@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-01-08 16:43 厂商回复： 感谢支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}