{"id": 6611, "wybug_id": "wooyun-2013-044903", "wybug_title": "百度空间好用的存储型XSS漏洞一枚", "wybug_corp": "百度", "wybug_author": "Liuz5O69", "wybug_date": "2013-12-04 16:04", "wybug_open_date": "2014-01-18 16:04", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "百度"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-18：\t细节向公众公开  简要描述： 百度空间个人主页存在存储型跨站漏洞，成功攻击后可用来挂马、钓鱼、Cookie窃取等等攻击。 详细说明：  登陆百度空间，进入博客编辑界面，随便输入点内容，点击发布的同时抓包，修改其中的content数据为\n%3C%21--%5Bif%20gte%20IE%204%5D%3E%3CSCRIPT%3Ealert%28%27%5BXSS%5D%27%29%3B%3C/SCRIPT%3E%3C%21%5Bendif%5D--%3E\n，其实就是\n<!--[if gte IE 4]><SCRIPT>alert('[XSS]');</SCRIPT><![endif]-->\n，一定要escape不然会过滤的什么都不剩。如图：\n\n然后回到个人主页页面，成功触发：\n\n可以看到，绕过后的脚本基本是原生态，攻击者可以任意发挥：\n\n同理IE内核和webkit内核也能用：\n\n\n\n   漏洞证明：  1.cookie窃取\n\n2.挂马攻击（演示）\n\n3.XSS phishing,延时刷伪造页面，可URL不变\n\n4.键盘记录，这个貌似可以和XSS phishing来结合使用，也可以发挥想象力进行其它方式的利用：\n\n5.手机端的利用，可以构造个无限循环，让你必须强制退出浏览器，当然也可以用WTAI协议来拨个号或发个短信（当然有缺陷得人工干预）\n\n   修复方案：  听过你们的开发讲过滤，你们更专业。   版权声明：转载请注明来源 Liuz5O69@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-12-04 17:39 厂商回复： 感谢提交，安全组立即处理此问题。--“百度，因你更安全” 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-04 17:02 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  有多好用    \n     2013-12-04 17:30 |    \t\t李白 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:29        )\t\t \n  求难用的    \n     2013-12-04 17:45 |    \t\tLiuz5O69 \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:8        | 一个默默的学习者。)\t\t \n  哈哈，大牛门勿笑，一般好用哈，可以用来给不懂的人说什么是XSS时用。    \n     2013-12-04 17:59 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @Liuz5O69 妈的还好我知道啥是xss    \n     2013-12-05 10:52 |    \t\tStardustsky \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | ……)\t\t \n  先Mark1个    \n     2013-12-26 14:01 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  mark~    \n     2014-01-18 16:14 |    \t\tziwen \t\t\t( 实习白帽子  |\t\t\t        Rank:49 漏洞数:4        | 活着为了乐还是为了苦？)\t\t \n  mark    \n     2014-01-18 23:34 |    \t\tlitao13 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 从事互联网行业15年余载，专注于web端与网...)\t\t \n  为啥特意加<!--[if gte IE 4]>，没有直接过滤<SCRIPT>吗    \n     2014-01-20 10:09 |    \t\tLiuz5O69 \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:8        | 一个默默的学习者。)\t\t \n  @litao13 嗯不加的话全部过滤掉，这部分加了导致过滤条件完全无效    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}