{"id": 32623, "wybug_id": "wooyun-2015-0110738", "wybug_title": "CSDJCMS最新版SQL注入，我来补充案例", "wybug_corp": "chshcms.com", "wybug_author": "命途多舛", "wybug_date": "2015-04-29 17:33", "wybug_open_date": "2015-08-01 20:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-01：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 不是盲住，无需登录，秒杀所有版本。乌云大大没有让我通过，说是要补充五个案例额，这种注册厂商还用补充案例么？好吧，我来给出。 详细说明：  1.首先定位到本次的漏洞文件。首先定位到漏洞文件app/controllers/user/reg.php\npublic function check()\t{                $username = $this->security->xss_clean($this->input->get_post('username', TRUE));   //username                $sqlu=\"SELECT cs_id FROM \".CS_SqlPrefix.\"user where cs_name='\".$username.\"'\";\t\t$row=$this->CsdjDB->get_all($sqlu);\t\tif(!$row){                      echo 'no';                }else{                      echo 'ok';                }        }\n2.这是验证$username的存在与否，虽然CSDJCMS有防注入的全局过滤，不影响我们构造，见测试代码。   漏洞证明：  好吧给出互联网案例，我就直接用官方的案例了中国YY喊麦网—YY520MC.COMhttp://www.yy520mc.com/index.php/user/reg/check\n\n百度战歌网http://www.mcbaidu.com//index.php/user/reg/check\n\n灵魂DJhttp://www.mcbaidu.com//index.php/user/reg/check\n\n26音乐网http://www.26yy.com//index.php/user/reg/check\n\n桂林漫音http://www.wuquku.cn//index.php/user/reg/check\n\n亲，案例还有太多了，全部秒杀，这你们也能测试不过。哎！   修复方案：  过滤   版权声明：转载请注明来源 命途多舛@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-05-03 20:14 厂商回复： 这个漏洞在4月29好已经修复 最新状态： 2015-06-04：巳修复  ", "replys": "漏洞评价：\n评论\n     2015-06-25 20:45 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  厉害。关注一下    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}