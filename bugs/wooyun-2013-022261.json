{"id": 12337, "wybug_id": "wooyun-2013-022261", "wybug_title": "湖南某政府官网存在cookie注入与认证缺陷，免费享受VIP服务", "wybug_corp": "湖南某政府官网", "wybug_author": "非米特尼克", "wybug_date": "2013-04-25 12:27", "wybug_open_date": "2013-06-09 12:28", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证缺陷", "盲目信任用户数据", "认证设计不合理", "欺骗", "敏感接口缺乏校验", "注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-09：\t细节向公众公开  简要描述： 普通用户登录后，可伪造他人登录，也可进行cookie注入，也可免费享受VIP服务。应该还可以脱裤，因特殊原因未深入，您懂的。 详细说明：  地址：http://www.hnleader.gov.cn/Index/ 湖南领导人才网存在cookie注入、Cookie伪造、不合理的COOKIE值（包含16MD5密码容易被）简单利用：1、注册一个用户并登录，获取cookie值，其中一个cookie：HNLEADER.GOV.CN=Logins=1（登录次数）&Flag=0（会员服务识别）&UserName=user（用户名）&UserPWD=password（MD5密码）2、修改上cookie值：HNLEADER.GOV.CN=Logins=1&Flag=0&UserName=user' or '1'='1&UserPWD=password3、刷新页面，普通会员就变成了VIP会员，享受VIP服务，又让领导们亏了100块钱，呵呵。4、另外有一个很奇怪的页面，见下图。5、VIP服务页面存在认证缺陷，普通会员可阅读VIP资料，省了每年的会员费100元。作为政府，本应该免费的，呵呵。我就先体验了。。。   漏洞证明：  1、正常登录\n\n2、伪造他人\n\n3、cookie注入\n\n4、注入成功，升级为VIP会员\n\n5、访问VIP专用资料\n\n6、不明页面\n\n7、如该页面http://www.hnleader.gov.cn/Index/ViewNews/?NewsID=898154419，普通用户是看不到里面的内容，看我怎么突破。原理:请求页面时会有一个cookie值Flag=0，截获请求页面将其修改成 Flag=1，就可以查看页面中的内容。正常访问\n\n修改cookie\n\n成功查阅VIP内容\n\n   修复方案：  1、取消cookie中的密码值；2、过滤；   版权声明：转载请注明来源 非米特尼克@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2013-04-26 16:20 厂商回复： CNVD确认并复现所述情况，已转发CNCERT湖南分中心，由其协调网站管理方处置。按部分影响机密性、完整性进行评分，rank=6.82*1.1*1.4=10.502 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-16 16:23 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:170        | 力不从心)\t\t \n  6、不明页面。一看就知道是干什么的了啊！那个不是dede的漏洞利用吗？11年8月那个    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}