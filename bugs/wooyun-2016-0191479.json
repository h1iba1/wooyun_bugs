{"id": 88376, "wybug_id": "wooyun-2016-0191479", "wybug_title": "云锁设计缺陷完美Bypass SQL注入防御(多种语言/环境/数据库通用)                                      ", "wybug_corp": "yunsuo.com.cn", "wybug_author": "从容", "wybug_date": "2016-04-01 18:49", "wybug_open_date": "2016-07-04 09:40", "wybug_type": "非授权访问/认证绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-08：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-05-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-04：\t细节向公众公开  简要描述： 云锁设计缺陷Bypass SQL注入防御(多种语言/环境/数据库通用) 详细说明：  云锁在检测客户端请求的GET/POST方式时，大致的整体逻辑是这样的：\n\n注意POST那个方向，云锁在过滤检测POST传输的过程中，没有进行URL的检测，也就是说云锁会认为URL上的任何参数信息都是正常的。既然是POST请求，那就只检测请求正文咯。(神逻辑)在标准HTTP处理流程中，只要后端是GET形式的接收参数，即使客户端用POST传输，查询字符串上满足查询条件时，是会进行处理的。\n那么只要以POST进行请求，URL查询字符串任意注入都不会被拦截。\n\n\n   漏洞证明：  centos + nginx + php：\n\n\n\nWindows Server2003 + IIS + ASP:\n\n\n\n\n\n\n\n所以说其实和环境/语言/数据库并没有什么关系，全部通用。   修复方案：  要不参考下其他家？\n\n   版权声明：转载请注明来源 从容@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-04-05 09:30 厂商回复： 感谢指出此问题。此问题是升级新版本的遗漏，将会在最近发布更新解决。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-25 17:23 |    \t\t你大爷在此 百无禁忌 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:9        | 迎风尿三丈 顺风八十米)\t\t \n  666    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}