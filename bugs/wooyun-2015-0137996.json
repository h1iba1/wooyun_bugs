{"id": 66038, "wybug_id": "wooyun-2015-0137996", "wybug_title": "利用海康威视HTTP Banner可成功查找成千上万用户监控视频（有图有数据有真相）", "wybug_corp": "海康威视", "wybug_author": "wy007", "wybug_date": "2015-08-30 18:32", "wybug_open_date": "2015-10-17 17:48", "wybug_type": "用户资料大量泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "用户敏感信息泄漏", "敏感信息未加密存储"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-17：\t细节向公众公开  简要描述： 一个偶然的HTTP Banner让我引起了兴趣...超乎想要的结果... 详细说明：  一个偶然的HTTP Banner让我引起了兴趣...遂产生了以下的探索...其实是很简单的一个信息.在登录某海康监控后台的时候HTTP抓包发现，返回的HTTP报头里面有一个Server信息HTTP Banner信息：\n\n\n\n\n\n我们可以看到，有三个Banner，应该是分别代表海康三种类型的产品，\nServer: DVRDVS-WebsServer: DNVRS-WebsServer: App-websServer: Hikvision-Webs    //这个是新发现的...可能还有漏掉的。\n大体上是这么区分的，但是也有一小部分，是没有按照Banner进行区分的，但是我想既然海康设计了这三个不同的Banner，应该是要区分三种不同的产品的（仅代表个人看法）下面我们根据这个HTTP Banner进行一下批量查找，看看会有什么结果...\n\n\n\n\n\n如果这些您还觉得不够多，咱们在看看这个...\n\n是不是为批量攻击提供了很多便利？有些人可能会说，光这些有什么意思啊...花了这么大篇幅说这个，主要是因为前面的是起因，是关键也是最重要的一个步骤...后面这个各位看了可能会觉得很鸡肋，是的，没什么技术含量，就是因为不需要太多技术含量，所以被传播和利用的范围更广...那么是什么呢...就是利用海康威视的默认管理员用户和密码：用户：admin密码：12345去尝试登陆的话，发现成功几率居然有50%还多...为什么会成功几率如此之高呢，第一本人原来也做过系统集成，对这些了解一二...就简单说一下1.一般这些产品施工都是由乙方负责施工安装调试。一般调试阶段到调试完成都是使用默认管理员用户和密码，因为乙方很少私自修改用户名和密码，因为最终是要交给用户的。2.而用户呢，这个阶段一般很少参与进来，用户的态度就是只要给我弄好使就可以了！而且很多用户也不会去记一大堆复杂的密码，所以很多乙方也为了方便直接把默认管理员用户和密码就直接交给了用户。3.国内的很多用户一切都是为了方便，而不是为了安全，只有一些对安全特别敏感且重视的企业用户才会避免犯这些低级错误。在发这个漏洞之前，我也在想这个到底算不算是海康威视的一个漏洞。后来仔细的想了一下，个人认为还是应该算设计上的一个缺陷。第一：这个HTTP Banner信息其实不是必须的参数，完全可以去掉，这样的话，也就不会有前面的解说和案例了。第二：对于默认管路员用户名和密码的问题，其实很多安全厂商也遇到过这个问题，到底怎么对待，其实个人认为完全可以要求用户在第一次登陆调试的时候必须修改密码才能继续操作，这样既解决了厂商背黑锅的问题，也解决了用户的安全问题。第三：对于管理后台应该增加一些验证码校验等安全技术。一切安全从厂商做起，如果厂商的安全意识都不够高的话，又怎么能要求用户的安全意识高于厂商呢...就说这么多，完全是个人见解，说的不对，还望见谅...下面到了无图无真相环节...不然该被人骂no pic u say a jb...   漏洞证明：  一小部分漏洞地址：（地址随时可能失效，因为很多都是ADSL拨号的网络，不是固定IP，但是我说的漏洞方法是真实存在的...）用户名：admin密码：12345\n\nmask 区域\n1.http://**.**.**/doc/page/main.asp_2.http://**.**.**/doc/page/main.asp_3.http://**.**.**/doc/page/main.asp_4.http://**.**.**/doc/page/main.asp_5.http://**.**.**/doc/page/main.asp_6.http://**.**.**/doc/page/main.asp_7.http://**.**.**/doc/page/main.asp_8.http://**.**.**/doc/page/main.asp_9.http://**.**.**/doc/page/main.asp_10.http://**.**.**/doc/page/main.asp_11.http://**.**.**/doc/page/main.asp_12.http://**.**.**/doc/page/main.asp_13.http://**.**.**/doc/page/main.asp_14.http://**.**.**/doc/page/main.asp_15.http://**.**.**/doc/page/main.asp_16.http://**.**.**/doc/page/main.asp_17.http://**.**.**/doc/page/main.asp_18.http://**.**.**/doc/page/main.asp_19.http://**.**.**/doc/page/main.asp_20.http://**.**.**/doc/page/main.asp_21.http://**.**.**/doc/page/main.asp_22.http://**.**.**/doc/page/main.asp_23.http://**.**.**/doc/page/main.asp_24.http://**.**.**/doc/page/main.asp_25.http://**.**.**/doc/page/main.asp_26.https://**.**.**/doc/page/main.asp_27.http://**.**.**/doc/page/main.asp_28.http://**.**.**/doc/page/main.asp_29.http://**.**.**/doc/page/main.asp_30.http://**.**.**/doc/page/main.asp_31.http://**.**.**/doc/page/main.asp_32.http://**.**.**/doc/page/login.asp_33.http://**.**.**/doc/page/main.asp_34.http://**.**.**/doc/page/main.asp_35.http://**.**.**/doc/page/main.asp_36.http://**.**.**/doc/page/main.asp_37.http://**.**.**/doc/page/main.asp_38.http://**.**.**/doc/page/main.asp_39.http://**.**.**/doc/page/main.asp_40.http://**.**.**/doc/page/main.asp\n\n上一部分我成功登录的截图：（只是上去截了个图，没做过分的举动...其实可以做的有很多..大牛们懂得）\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n上面几个是视频回放的截图...有耐心的，可以慢慢欣赏...   修复方案：  上面说过了...1.去掉所有产品的HTTP Banner信息2.产品第一次登陆调试的时候修改默认密码3.增加登录验证码校验   版权声明：转载请注明来源 wy007@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2015-09-02 17:46 厂商回复： 目前海康威视全线产品密码机制已经更改为首次使用强制更改密码，且有密码复杂度限制。对于已经销售的设备，因为目前厂商只能尽到尽力通知客户的义务，不具备修改客户设备密码的权利。所以此类弱密码问题短期内无法彻底解决。因设备弱口令问题在乌云平台上已有白帽子提交，故rank给1。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-30 18:42 |    \t\t陆小果 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:5        | 又是忽略~)\t\t \n  前排~    \n     2015-08-30 20:34 |    \t\tLoveSnow \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:3        | 以正和，以奇胜！)\t\t \n  这个。。。。。。    \n     2015-08-30 23:16 |    \t\t昌维 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | QQ：867597730，百度贴吧ID：昌维001 个人...)\t\t \n  留名    \n     2015-09-02 18:24 |    \t\twy007 \t\t\t( 实习白帽子  |\t\t\t        Rank:95 漏洞数:10        | 其实我是一名卧底...)\t\t \n  @海康威视 直接忽略了多好...何必还浪费1个rank...还让大家等这么久 我想这个漏洞的关键是在于标题的这个HTTP Banner    \n     2015-09-02 18:26 |    \t\twy007 \t\t\t( 实习白帽子  |\t\t\t        Rank:95 漏洞数:10        | 其实我是一名卧底...)\t\t \n  @海康威视 答非所谓的回答 我也是醉了 如果你认为你的Banner没有影响的话，那么请继续保持下去    \n     2015-09-23 09:28 |    \t\t小红猪 \t\t\t( 普通白帽子  |\t\t\t        Rank:198 漏洞数:32        | Wow~~~哈哈~~~)\t\t \n  这个。。。。。。     \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}