{"id": 51335, "wybug_id": "wooyun-2014-074913", "wybug_title": "某通用程序文件上传导致任意代码执行·续篇（影响全国各省）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "Coody", "wybug_date": "2014-09-03 17:38", "wybug_open_date": "2014-12-02 17:40", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-02：\t细节向公众公开  简要描述： ... 详细说明：  继续挖掘之前发布过的漏洞 WooYun: 某通用程序任意目录遍历及文件上传导致任意代码执行（影响全国各省） 发现其他两处任意文件上传点--------------------------------------------------------百度dork: inurl:/ycportal影响范围：全国各省市地区烟草专卖局及少数GOV站点--------------------------------------------------------\n0x00:测试文件内容\n<%out.print(\"just4test....From WooYun.Org\");%>\n0x01:第一处上传点\n说明：这里没什么可说的，直接打开页面 ycportal/jsp/forupload.jsp，上传jsp文件即可。访问路径为 upload/images/itemimage/null.jsp案例：http://www.rzdonggang.gov.cn/ycportal/jsp/forupload.jsphttp://www.sxlfyc.com/ycportal/jsp/forupload.jsphttp://www.dtycgs.cn/ycportal/jsp/forupload.jsphttp://szycgs.cn/ycportal/jsp/forupload.jsphttp://www.jxfdainfo.cn/ycportal/jsp/forupload.jsphttp://www.ycycgs.com.cn/ycportal/jsp/forupload.jsphttp://219.147.39.2/ycportal/jsp/forupload.jsphttp://www.jztobacco.com.cn/ycportal/jsp/forupload.jsphttp://124.166.240.106/ycportal/jsp/forupload.jsp……给出两个上传的例子http://www.ycycgs.com.cn/ycportal/jsp/forupload.jsp\n\nhttp://www.ycycgs.com.cn/ycportal/upload/images/itemimage/null.jsp\n\nhttp://www.jztobacco.com.cn/ycportal/jsp/forupload.jsp\n\nhttp://www.jztobacco.com.cn/ycportal/upload/images/itemimage/null.jsp\n\n\n0x02:第二处上传点\n说明：上传广告图片的页面，这里可以通过 %00 达到截断的效果上传 jsp 文件，上传页面地址为：ycportal/yc/adupload.jsp?inputname=contentIP ，上传成功后，文件地址为：ycportal/styleimages/adimages/上传文件名.jsp这里给出上传的例子http://www.jztobacco.com.cn/ycportal/yc/adupload.jsp?inputname=contentIP\n\n抓取数据包，%00截断，即可上传成功\n\n最后访问地址为：http://www.jztobacco.com.cn/ycportal/styleimages/adimages/wooyun.jsp\n\n   漏洞证明：     修复方案：  @cncert国家互联网应急中心 没有查到相关厂商具体信息，不过在根目录下有个install.jsp文件，发邮件获取license的，可以研究一下那个文件，看能不能找到 相关厂商的信息。   版权声明：转载请注明来源 Coody@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-09-08 09:36 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-03 17:42 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @xsser @Finger @疯狗  求首页 = =#    \n     2014-09-03 18:19 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  你发就给钱？    \n     2014-09-03 18:58 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @专业种田 嫉妒了吧，哈哈哈哈。。。    \n     2014-09-03 23:17 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  @鬼魅羊羔 他不请客。    \n     2014-09-04 10:09 |    \t\tPgHook \t\t\t( 普通白帽子  |\t\t\t        Rank:964 漏洞数:115        | ...........................................)\t\t \n  @Coody  不用请客了，哈哈！来点牛肉干就好了。     \n     2014-09-04 10:12 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @PgHook 看来你已经吃完了这是    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}