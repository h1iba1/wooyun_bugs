{"id": 12049, "wybug_id": "wooyun-2013-020500", "wybug_title": "phpcms后台简单拿webshell", "wybug_corp": "phpcms", "wybug_author": "L.X", "wybug_date": "2013-03-23 11:30", "wybug_open_date": "2013-06-21 11:31", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "任意文件写入利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-05-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-21：\t细节向公众公开  简要描述： phpcms后台无法编辑可执行文件时拿webshell。 详细说明：  phpcms通过后台管理编辑首页模板，插入php一句话木马，更改基本设置生成index.php，便可直接获取webshell。   漏洞证明：  登陆后台，在文件编辑禁用，采用admin.php?mod=phpcms&file=safe&action=see_code&files=templates%2Fname.inc.php这样的方法修改php文件但是没有修改按钮的时候可以采用此方法简单获取webshell。\n\n步骤如下：1、编辑模板，修改首页模板，插入一句话木马。\n\n\n\n2、网站配置——基本信息，生成html选择“否”，生成文件扩展名选择“php”，保存设置。\n\n3、内容管理--生成HTML--生成首页。生成首页后直接用菜刀连接目标url/index.php便可以获得webshell。\n\n\n\n   修复方案：  关闭后台的模板编辑，或是修改php的模板编辑过滤代码。   版权声明：转载请注明来源 L.X@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-03-24 16:00 厂商回复： 这个是 phpcms 2008版本漏洞。感谢反馈！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-23 15:18 |    \t\tL.X \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 分享和谐)\t\t \n  自己做过沙发向大牛致敬    \n     2013-03-23 15:19 |    \t\tL.X \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 分享和谐)\t\t \n  自己坐沙发向大牛致敬    \n     2013-04-22 12:13 |    \t\tsuclogger \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | suclogger)\t\t \n  是admin权限吗    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}