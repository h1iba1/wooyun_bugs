{"id": 6366, "wybug_id": "wooyun-2013-045958", "wybug_title": "新东方某分站弱口令及任意附件上传", "wybug_corp": "新东方", "wybug_author": "小红猪", "wybug_date": "2013-12-15 12:32", "wybug_open_date": "2014-01-29 12:33", "wybug_type": "后台弱口令", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-29：\t细节向公众公开  简要描述： 新东方某分站管理员弱口令，登录后附件上传处可上传任意文件，导致站点沦陷。 详细说明：  存在问题的站点：http://203.95.110.97/首页下面版权处说是北京新东方学校客服中心。存在弱口令：admin/admin\n\n本来打算就提交了，怕被忽略，导致后期再出现大问题，于是进到后台管理看了看，下图是后台管理中的用户管理功能：\n\n可以对当前用户进行管理，比如修改密码、头像、附件等：\n\n上传头像这儿，文件名就已经限定死了，也就放弃了，然后传附件试试，结果发现可以上传任意后缀的附件：\n\n于是拿到shell：\n\n传cmd上去执行命令：\n\n权限不高啊，算了，就到这儿吧。上传的test1.asp和cmd.exe都已删除，未留后门，未做任何数据修改操作，赶紧修复漏洞吧，哈哈~~~谁说新东方有礼物来着~~哈哈~~~   漏洞证明：  弱口令：\n\n附件上传获取shell：\n\n   修复方案：  1、修改后台密码，确保不存在弱口令；2、该系统有文件管理功能，这些附件可供其他人员下载。建议对上传的附件类型采用白名单机制对后缀进行严格限制，或者对附件所在目录的执行权限进行限制，只有下载的权限，不给执行的权限。   版权声明：转载请注明来源 小红猪@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-12-16 09:37 厂商回复： 谢谢，我们会尽快对漏洞进行修复。PS：礼物肯定会有，请期待吧。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-16 10:34 |    \t\txlz0iza1 \t\t\t( 普通白帽子  |\t\t\t        Rank:1027 漏洞数:207        | \"><script/src=data:,alert(1)%2b\")\t\t \n  @新东方 为什么我的忽略~    \n     2013-12-16 19:14 |    \t\t小红猪 \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:30        | Wow~~~哈哈~~~)\t\t \n  @xlz0iza1 额，哈哈哈~~~    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}