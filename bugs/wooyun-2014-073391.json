{"id": 51774, "wybug_id": "wooyun-2014-073391", "wybug_title": "太仓市委组织部365体系综合平台getshell+数据信息", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "CoffeeSafe", "wybug_date": "2014-08-22 11:11", "wybug_open_date": "2014-10-06 11:12", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程命令执行", "补丁不及时"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-06：\t细节向公众公开  简要描述： 太仓市委组织部365体系综合平台getshell+数据信息 详细说明：  太仓市委组织部365体系综合平台getshell+数据信息地址：http://zzb.taicang.gov.cn/存在struts2漏洞-导致直接getshell0x01:\n\n\n\nurl：http://zzb.taicang.gov.cn/test.txt0x02：\n<config>\t<enabled>true</enabled>\t<baseDir></baseDir>\t<baseURL>http://192.168.1.102:8080/365SERVICE/userfiles/</baseURL>\t<licenseKey></licenseKey>\t<licenseName></licenseName>\t<imgWidth>1600</imgWidth>\t<imgHeight>1200</imgHeight>\t<imgQuality>80</imgQuality>\t<uriEncoding>UTF-8</uriEncoding>\t<forceASCII>false</forceASCII>\t<userRoleSessionVar>CKFinder_UserRole</userRoleSessionVar>\t<checkDoubleExtension>true</checkDoubleExtension>\t<checkSizeAfterScaling>true</checkSizeAfterScaling>\t<secureImageUploads>true</secureImageUploads>\t<htmlExtensions>html,htm,xml,js</htmlExtensions>\t<hideFolders>\t\t<folder>.svn</folder>\t\t<folder>CVS</folder>\t</hideFolders>\t<hideFiles>\t\t<file>.*</file>\t</hideFiles>\t<defaultResourceTypes></defaultResourceTypes>\t<types>\t\t<type name=\"Files\">\t\t\t<url>%BASE_URL%files/</url>\t\t\t<directory>%BASE_DIR%files</directory>\t\t\t<maxSize>0</maxSize>\t\t\t<allowedExtensions>7z,aiff,asf,avi,bmp,csv,doc,docx,fla,flv,gif,gz,gzip,jpeg,jpg,mid,mov,mp3,mp4,mpc,mpeg,mpg,ods,odt,pdf,png,ppt,pptx,pxd,qt,ram,rar,rm,rmi,rmvb,rtf,sdc,sitd,swf,sxc,sxw,tar,tgz,tif,tiff,txt,vsd,wav,wma,wmv,xls,xlsx,zip\t\t\t</allowedExtensions>\t\t\t<deniedExtensions></deniedExtensions>\t\t</type>\t\t<type name=\"Images\">\t\t\t<url>%BASE_URL%images/</url>\t\t\t<directory>%BASE_DIR%images</directory>\t\t\t<maxSize>0</maxSize>\t\t\t<allowedExtensions>bmp,gif,jpeg,jpg,png</allowedExtensions>\t\t\t<deniedExtensions></deniedExtensions>\t\t</type>\t\t<type name=\"Flash\">\t\t\t<url>%BASE_URL%flash/</url>\t\t\t<directory>%BASE_DIR%flash</directory>\t\t\t<maxSize>0</maxSize>\t\t\t<allowedExtensions>swf,flv</allowedExtensions>\t\t\t<deniedExtensions></deniedExtensions>\t\t</type>\t</types>\t<accessControls>\t\t<accessControl>\t\t\t<role>*</role>\t\t\t<resourceType>*</resourceType>\t\t\t<folder>/</folder>\t\t\t<folderView>true</folderView>\t\t\t<folderCreate>true</folderCreate>\t\t\t<folderRename>true</folderRename>\t\t\t<folderDelete>true</folderDelete>\t\t\t<fileView>true</fileView>\t\t\t<fileUpload>true</fileUpload>\t\t\t<fileRename>true</fileRename>\t\t\t<fileDelete>true</fileDelete>\t\t</accessControl>\t</accessControls>\t<thumbs>\t\t<enabled>true</enabled>\t\t<url>%BASE_URL%_thumbs/</url>\t\t<directory>%BASE_DIR%_thumbs</directory>\t\t<directAccess>false</directAccess>\t\t<maxHeight>100</maxHeight>\t\t<maxWidth>100</maxWidth>\t\t<quality>80</quality>\t</thumbs>\t<plugins>\t\t<plugin>\t\t\t<name>imageresize</name>\t\t\t<class>com.ckfinder.connector.plugins.ImageResize</class>\t\t\t<params>\t\t\t\t<param name=\"smallThumb\" value=\"90x90\"></param>\t\t\t\t<param name=\"mediumThumb\" value=\"120x120\"></param>\t\t\t\t<param name=\"largeThumb\" value=\"180x180\"></param>\t\t\t</params>\t\t</plugin>\t\t<plugin>\t\t\t<name>fileeditor</name>\t\t\t<class>com.ckfinder.connector.plugins.FileEditor</class>\t\t\t<params></params>\t\t</plugin>\t</plugins>\t<basePathBuilderImpl>com.ckfinder.connector.configuration.ConfigurationPathBuilder</basePathBuilderImpl></config>\n\n<session-factory>\t\t<!-- 杩???诲? -->\t\t<property name=\"connection.driver_class\">oracle.jdbc.driver.OracleDriver</property>\t\t<property name=\"connection.url\">jdbc:oracle:thin:@127.0.0.1:1521:ORCL</property>\t\t<property name=\"connection.username\">service365</property>\t\t<property name=\"connection.password\">service365</property>\t\t<property name=\"dialect\">org.hibernate.dialect.OracleDialect</property>\t\t<property name=\"hibernate.show_sql\">true</property>\t\t\t\t<property name=\"hibernate.current_session_context_class\">org.springframework.orm.hibernate3.SpringSessionContext</property>\t\t\t\t<property name=\"hibernate.connection.provider_class\">org.hibernate.connection.C3P0ConnectionProvider</property>\t\t <!-- ??ぇ杩????-->\n   漏洞证明：  gov 的站点何况是太仓市委组织部！被利用，后果也是挺大的。   修复方案：  升级+配置！   版权声明：转载请注明来源 CoffeeSafe@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-08-27 10:08 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给江苏分中心处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}