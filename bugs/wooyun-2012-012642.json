{"id": 16444, "wybug_id": "wooyun-2012-012642", "wybug_title": "yy冻结封禁帐号正常登录（可进频道、刷花、送月票）", "wybug_corp": "广州多玩", "wybug_author": "huliang", "wybug_date": "2012-09-24 11:19", "wybug_open_date": "2012-11-08 11:20", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-10-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-10-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-11-08：\t细节向公众公开  简要描述： yy被冻结的帐号，任然可以直接登录IM服务器，频道服务器，任然可以正常在线，参与频道业务！ 详细说明：  yy客户端登录过程分几步：1、登录Token服务器，获取Token令牌， 一般长度为0x60字节，2、利用已经取到的Token令牌登录 Udb服务器，Udb服务器对帐号进行验证。客户端登录时Udb服务器验证失败，则客户端弹出相应错误并停止继续；3、利用已取到的Token登录Im服务器，4、利用已取到的Token登录频道服务器漏洞产生原因，首先通过Token服务器获取Token令牌，不登录Udb服务器对帐号进行校验，因为Token服务器在返回Token的同时也会返回用户UserId，所以可直接使用UserId + Token 登录Im服务器 或者 频道服务器，只要不是与Udb服务器进行交互的业务逻辑都可以完成。Im服务器 和 频道服务器的登录 仅需要 UserId +  password + Token ，后台没有对用户状态进行逻辑判断，导致只要知道UserId + password + Token 就可以随意登录，进而从事一些其他业务活动！   漏洞证明：  证明就不贴了，市面上已经出现利用封禁、冻结帐号，刷花，刷月票的案例了！   修复方案：  所有服务器增加统一认证，对帐号状态加以判断！   版权声明：转载请注明来源 huliang@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2012-09-24 11:27 厂商回复： 收到，正在处理中，谢谢提供。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-09-24 11:21 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  洞主安全感觉不错，下次记得说说感觉，欢迎来乌云愉快！    \n     2012-10-22 15:19 |    \t\thuliang \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 过往如昙花一现)\t\t \n  真悲~~ 你们送的YY熊我都收到好久了~ 漏洞都公开了， 貌似你们还没有实际修复，某些群里还上叫嚣着利用工具。    \n     2012-10-25 08:58 |    \t\thuliang \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 过往如昙花一现)\t\t \n  @广州多玩    \n     2012-10-26 16:29 |    \t\tNCK_上官 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | BND技术联盟（N客）我的兄弟)\t\t \n  加以判断    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}