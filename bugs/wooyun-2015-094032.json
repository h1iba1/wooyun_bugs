{"id": 45836, "wybug_id": "wooyun-2015-094032", "wybug_title": "新浪某服务配置不当导致任意文件包含GetShell(大量内部数据库泄露)", "wybug_corp": "新浪", "wybug_author": "boooooom", "wybug_date": "2015-01-26 16:31", "wybug_open_date": "2015-03-12 16:32", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-12：\t细节向公众公开  简要描述： RT 详细说明：  \n\nmask 区域\n1.://**.**.**\n\nfastcgi对外，可包含任意文件\n\n   漏洞证明：  大量数据库配置泄露，部分库涉及几百万用户相关数据\n\nmask 区域\n*****home/finance/runtime/p**********liver.ini**********nce_********** \"re*****1.://**.**.**//dist.finance.intra.sina.com.cn:8000/delivery/distrsync_html.php\"_2.://**.**.**//dist.finance.intra.sina.com.cn:8000/delivery/distrsync_request.php\"_*****e.intra.sina.com.c**********t = &quo**********t;/usr/bin**********ync_data_center/fin**********c_data_center/fina**********e_htm********** \"re*****3.://**.**.**//dist.finance.intra.sina.com.cn:8000/delivery/distrsync_html_new.php\"_4.://**.**.**//dist.finance.intra.sina.com.cn:8000/delivery/distrsync_request.php\"_*****e.intra.sina.com.c**********t = &quo**********t;/usr/bin**********ync_data_center/fin**********c_data_center/fina******************************onfig.ini**********asco*****5.://**.**.**//root:111111@10.55.30.30:3306/chinascope\"_*****asco*****6.://**.**.**//root:111111@10.55.30.30:3306/chinascope\"_*****db_*****7.://**.**.**//moneyfinance3:TrC6rot4R6@m3329i.mars.grid.sina.com.cn:3329/fcdb\"_*****db]*****8.://**.**.**//moneyfinance3_r:xMMTZDToGh@s3329i.mars.grid.sina.com.cn:3329/fcdb\"_*****ney*****9.://**.**.**//moneyfinance:HN0YWZmLnN@m3325i.mars.grid.sina.com.cn:3325/moneyfinance\"_*****y_db*****10.://**.**.**//moneyfinance:HN0YWZmLnN@s3325i.mars.grid.sina.com.cn:3325/moneyfinance\"_*****_win*****11.://**.**.**//moneyfinance2_r:y4XTjTNP18@s3328i.mars.grid.sina.com.cn:3328/wind_dbo\"_*****es_d*****12.://**.**.**//quotes_db_r:9DmkqJ5k44okp@s3326i.mars.grid.sina.com.cn:3326/quotes_db\"_*****es_d*****13.://**.**.**//quotes_db:e5oTGxh3Xliyj@m3326i.orion.grid.sina.com.cn:3326/quotes_db\"_*****b_stan*****14.://**.**.**//quotes_db:e5oTGxh3Xliyj@m3333i.orion.grid.sina.com.cn:3333/quotes_db\"_*****res_*****15.://**.**.**//futures:9cpx53mv1siw@172.16.152.74:3309/futures_db\"_*****e_leg*****16.://**.**.**//finance:finance@202.108.37.87/finance\"_*****_db_ad*****17.://**.**.**//root:0s7lapc24@127.0.0.1:3309/mysql\"_*****tart*****18.://**.**.**//libstart_db:0l35xopq2laq@172.16.6.131:3309/libstart_db\"_*****ade*****19.://**.**.**//tradedb_r:LfQcByWiO7Vvd@s3308i.mars.grid.sina.com.cn:3308/tradedb\"_*****e_db*****20.://**.**.**//tradedb:JChMA1lYuJPy2@m3308i.mars.grid.sina.com.cn:3308/tradedb\"_*****p_md*****21.://**.**.**//webuser_r:+9oPKh_gn0yYNZRnt@s3324i.apollo.grid.sina.com.cn:3324/hkexp_mdf\"_*****d_ma*****22.://**.**.**//world_market:1wSeH45tGc@m3332i.mars.grid.sina.com.cn:3332/world_market\"_*****marke*****23.://**.**.**//world_market_r:T5Gbv3edC45f@s3332i.mars.grid.sina.com.cn:3332/world_market\"_*****rt_*****24.://**.**.**//wmrt_db:1wSeH45tGc@m3331i.mars.grid.sina.com.cn:3331/wmrt_db\"_*****_db_*****25.://**.**.**//wmrt_db_r:T5Gbv3edC45f@s3331i.mars.grid.sina.com.cn:3331/wmrt_db\"_*****et_d*****26.://**.**.**//market_r:T5Gbv3edC45f@s3730i.mars.grid.sina.com.cn:3730/market\"_*****et_d*****27.://**.**.**//market:1wSeH45tGc@m3730i.mars.grid.sina.com.cn:3730/market\"_*****_biz*****28.://**.**.**//biz_r:LdjaDdeia!kdaj@s3309i.mars.grid.sina.com.cn:3309/biz\"_*****x_0_*****29.://**.**.**//webzx_0_r:X5Gbvddiii45@s3770i.mars.grid.sina.com.cn:3770/webzx_0\"_*****x_1_*****30.://**.**.**//webzx_1_r:X5Gbvddiii45@s3770i.mars.grid.sina.com.cn:3770/webzx_1\"_*****x_2_*****31.://**.**.**//webzx_2_r:X5Gbvddiii45@s3770i.mars.grid.sina.com.cn:3770/webzx_2\"_*****x_3_*****32.://**.**.**//webzx_3_r:X5Gbvddiii45@s3771i.mars.grid.sina.com.cn:3771/webzx_3\"_*****x_4_*****33.://**.**.**//webzx_4_r:X5Gbvddiii45@s3771i.mars.grid.sina.com.cn:3771/webzx_4\"_*****x_5_*****34.://**.**.**//webzx_5_r:X5Gbvddiii45@s3771i.mars.grid.sina.com.cn:3771/webzx_5\"_*****x_0_*****35.://**.**.**//wapzx_0_r:X5Gbvddiii45@s3770i.mars.grid.sina.com.cn:3770/wapzx_0\"_*****x_1_*****36.://**.**.**//wapzx_1_r:X5Gbvddiii45@s3770i.mars.grid.sina.com.cn:3770/wapzx_1\"_*****x_2_*****37.://**.**.**//wapzx_2_r:X5Gbvddiii45@s3770i.mars.grid.sina.com.cn:3770/wapzx_2\"_*****x_3_*****38.://**.**.**//wapzx_3_r:X5Gbvddiii45@s3771i.mars.grid.sina.com.cn:3771/wapzx_3\"_*****x_4_*****39.://**.**.**//wapzx_4_r:X5Gbvddiii45@s3771i.mars.grid.sina.com.cn:3771/wapzx_4\"_*****x_5_*****40.://**.**.**//wapzx_5_r:X5Gbvddiii45@s3771i.mars.grid.sina.com.cn:3771/wapzx_5\"_*****niu*****41.://**.**.**//genius:gsyciyg6Tc2@m3329i.mars.grid.sina.com.cn:3329/genius\"_*****niu*****42.://**.**.**//genius_r:hxO878diV3c2@s3329i.mars.grid.sina.com.cn:3329/genius\"_*****e_use*****43.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_0\"_*****e_use*****44.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_1\"_*****e_use*****45.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_2\"_*****e_use*****46.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_3\"_*****e_use*****47.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_4\"_*****e_use*****48.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_5\"_*****e_use*****49.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_6\"_*****e_use*****50.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_7\"_*****e_use*****51.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_8\"_*****e_use*****52.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_9\"_*****e_use*****53.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_10\"_*****e_use*****54.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_11\"_*****e_use*****55.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_12\"_*****e_use*****56.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_13\"_*****e_use*****57.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_14\"_*****e_use********** ********** *****58.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_15\"_*****e_use*****59.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_16\"_*****e_use*****60.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_17\"_*****e_use*****61.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_18\"_*****e_use*****62.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_19\"_*****e_use*****63.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_20\"_*****e_use*****64.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_21\"_*****e_use*****65.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_22\"_*****e_use*****66.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_23\"_*****e_use*****67.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_24\"_*****e_use*****68.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_25\"_*****e_use*****69.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_26\"_*****e_use*****70.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_27\"_*****e_use*****71.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_28\"_*****e_use*****72.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_29\"_*****e_use*****73.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_30\"_*****e_use*****74.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_31\"_*****e_use*****75.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_32\"_*****e_use*****76.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_33\"_*****e_use*****77.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_34\"_*****e_use*****78.://**.**.**//moneyFINANCE:DXDja6ytRt@m3325i.mars.grid.sina.com.cn:3325/finance_user_35\"_*****_conte*****79.://**.**.**//moneyFINANCE:DXDja6ytRt@m3773i.apollo.grid.sina.com.cn:3773/\"_*****_conte*****80.://**.**.**//moneyFINANCE:DXDja6ytRt@m3774i.apollo.grid.sina.com.cn:3774/\"_*****_db_*****81.://**.**.**//news_db:1wSeH45tGc@m3329i.mars.grid.sina.com.cn:3329/news_db\"_*****ws_*****82.://**.**.**//news_db_r:T5Gbv3edC45f@s3329i.mars.grid.sina.com.cn:3329/news_db\"_*****naly*****83.://**.**.**//finanalysis:d7b6f0da096ec87@m3330i.orion.grid.sina.com.cn:3330/finanalysis\"_*****lysis*****84.://**.**.**//finanalysis_r:5756a3682327544@m3330i.orion.grid.sina.com.cn:3330/finanalysis\"_*****_my*****85.://**.**.**//root:111111@10.55.30.30:3306/test\"_*****_in*****86.://**.**.**//fn_inf_r:DAKAdfad3k4lzx@s3730i.mars.grid.sina.com.cn:3730/financeinformation\"_*****_in*****87.://**.**.**//fn_inf_w:f3u4w8n7b3h@m3730i.mars.grid.sina.com.cn:3730/financeinformation\"_*****inal*****88.://**.**.**//terminal_r:8d3399767ab0416@s3442i.hebe.grid.sina.com.cn:3442/terminal\"_*****rmi*****89.://**.**.**//terminal:d8bfe057d9ef1a7@m3442i.hebe.grid.sina.com.cn:3442/terminal\"_*****ll_*****90.://**.**.**//bill_r:0eaee128ac13d6e@s3442i.hebe.grid.sina.com.cn:3442/bill\"_*****ll]*****91.://**.**.**//bill:b7f70c611ac1dfd@m3442i.hebe.grid.sina.com.cn:3442/bill\"_*************************s.ini____**********_fil*****92.://**.**.**//money.finance.sina.com.cn/fund/api/srv.php/\"_*****uot;php_se**********rpi*****93.://**.**.**//money.finance.sina.com.cn/api/srv.php/\"_*****uot;php_se**********ndi*****94.://**.**.**//money.finance.sina.com.cn/fund/api/srv.php/\"_*****uot;php_se**********uote*****95.://**.**.**//money.finance.sina.com.cn/quotes_service/api/srv.php/\"_*****uot;php_se**********quot*****96.://**.**.**//money.finance.sina.com.cn/q/api/srv.php/\"_*****uot;php_se*****\n\n\n\n\n\n\n\n   修复方案：  配置正确   版权声明：转载请注明来源 boooooom@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-01-26 19:06 厂商回复： 此漏洞已经在报告之前内部发现并已修复，故将漏洞判为中。感谢关注新浪安全。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-26 16:33 |    \t\tf4ck \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:7        | 有些人很牛B，一个漏洞能刷成N个。)\t\t \n  叼，20rank    \n     2015-01-26 16:56 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  哎呦，不错哦    \n     2015-01-26 17:07 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  大牛，求带！    \n     2015-03-02 15:16 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  此漏洞已经在报告之前内部发现并已修复，故将漏洞判为中。感谢关注新浪安全。这句看得我吐了    \n     2015-03-13 10:19 |    \t\tidarker \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 爱生活，╮(╯▽╰)╭)\t\t \n  新的一波  fastcgi马上开始了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}