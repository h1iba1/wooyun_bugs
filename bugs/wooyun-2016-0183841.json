{"id": 86528, "wybug_id": "wooyun-2016-0183841", "wybug_title": "POS机安全之首信易设计逻辑缺陷到Getshell(泄露将近579万敏感信息用户身份证严重可操作余额)", "wybug_corp": "首信易支付", "wybug_author": "小龙", "wybug_date": "2016-03-12 16:42", "wybug_open_date": "2016-04-28 10:30", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-03-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-04-28：\t细节向公众公开  简要描述： http://www.wooyun.org/bugs/wooyun-2016-0174071通过此漏洞可以得知此网站的用户数据 详细说明：  看到厂商的公告https://www.beijing.com.cn/pages/stage/web/Declaration%20letter.jsp\n\n发现厂商对安全很重视，毕竟进去里面可以冲话费，QB。作为第三方平台疏忽的话就非常麻烦了。厂商是否可以来个20rank+个小礼物呢 ^_^  码字码的真累。。1# 爆破pay.yizhifubj.com/merchant/login.jsp当然爆破这个洞。。 修复起来很头痛。例如用户员工不上线，或许员工离职会留下一些敏感信息爆破出虽然有验证码，但是没校验次数爆破密码123456\nrequest\tpayload\tstatus\terror\ttimeout\tlength\tcomment22\tchenchen\t200\tfalse\tfalse\t5116\t42\tchenhua\t200\tfalse\tfalse\t6341\t94\tchenyan\t200\tfalse\tfalse\t4693\t353\tlitingting\t200\tfalse\tfalse\t4693\t737\twangshuai\t200\tfalse\tfalse\t5628\t853\txuli\t200\tfalse\tfalse\t4693\t985\tzhangbin\t200\tfalse\tfalse\t3608\t1016\tzhanghui\t200\tfalse\tfalse\t5488\t1039\tzhangliang\t200\tfalse\tfalse\t3610\t1106\tzhangying\t200\tfalse\tfalse\t5256\t1118\tzhangzheng\t200\tfalse\tfalse\t4682\n挺多的。不一一测试了登录 wangshuai的看看\n\n发现操作员这里没越权没注入。。这个系统做的挺好\n\n\n\n但是 主站就不是这么幸运了在上传资料处任意上传\n\n拿到webshell\n\n\n\nhttps://www.yizhifubj.com/resources/2016-03-12/bc648818-c087-4199-be1d-ecfd766763ea.jsp发现有很多资料/usr/local/tomcat/FileDir/resources/2016-03-12上传目录的都删除吧。管理971个目录，当然这只是日期格式例如今天3月12日那么a和b用户都在同一天上传的话就是上传到3月12日目录里，而不是用户的子目录\n\n105个目录看看\n\n俩不一样的。这样审核可能知道啥意思了把。。\n\n还有各种cer证书，包括vpn的证书/usr/local/tomcat/\n\n\n\n\n\n附上仁兄身份证图。审核看完记得打马赛克哦。。。不深入了。基本上整站都在我控制之中了。。   漏洞证明：  修复呗。。   修复方案：  1：爆破： 验证码只校验3次，3次错误封锁账号，或者用手机号码登录2：检查上传的后缀名，例如cer，php。jsp都不能传   版权声明：转载请注明来源 小龙@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2016-03-14 10:30 厂商回复： 非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-12 16:43 |    \t\t’‘Nome \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:31        | 有事请发邮件，2859857@gmail.com，垃圾邮...)\t\t \n  表哥吃屎吧     \n     2016-03-12 16:45 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:2293 漏洞数:484        | 我就问，还有谁！！！！！！！！！！！！！...)\t\t \n  rank超过300以上的可以加入风铃面基哦，你还在等什么:)    \n     2016-03-12 16:45 |    \t\tBrother \t\t\t( 实习白帽子  |\t\t\t        Rank:69 漏洞数:18        )\t\t \n  是不是还有第三部！表哥请续局！    \n     2016-03-12 16:54 |    \t\t大师兄 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:8        | 每日必关注乌云)\t\t \n  ...    \n     2016-03-12 16:57 |    \t\t黑色键盘丶 \t\t\t( 普通白帽子  |\t\t\t        Rank:1336 漏洞数:298        | 哥,是孤独风中的一匹狼)\t\t \n  果然不吃屎    \n     2016-03-12 17:16 |    \t\t情小北 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:8        | 那时候我们还年轻,所以任由时光作渡.)\t\t \n  火前留名    \n     2016-03-12 21:13 |    \t\t兔斯基 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 兔子)\t\t \n  这属于第三方支付安全了呢    \n     2016-03-14 16:40 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:2293 漏洞数:484        | 我就问，还有谁！！！！！！！！！！！！！...)\t\t \n  @首信易支付 真的有礼物吗    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}