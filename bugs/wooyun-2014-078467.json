{"id": 50226, "wybug_id": "wooyun-2014-078467", "wybug_title": "Doyo建站 SQL注入", "wybug_corp": "wdoyo.com", "wybug_author": "小飞", "wybug_date": "2014-10-11 18:20", "wybug_open_date": "2015-01-09 18:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-09：\t细节向公众公开  简要描述： 由用户输入表名，未任何过滤 详细说明：  在source/pay.php下\nfunction buymolds(){\t\t$this->id=$this->syArgs('id');\t\t$this->molds=$this->syArgs('molds',1);\t\tif(!$this->id&&!$this->molds)message(\"a\");\t\t$this->info=syDB($this->molds)->find(array('id'=>$this->id,'isshow'=>1),null,'title,mgold,litpic');\t\tif(!$this->info)message(\"指定购买内容不存在或未审核。\");\t\tif($this->syArgs('run')){\t\t\tif($this->mymoney<$this->info['mgold'])message(\"您的余额不足，请先充值\");\t\t\t$row=array(\t\t\t\t'type'=>4,\t\t\t\t'uid'=>$this->my['id'],\t\t\t\t'orderid'=>'',\t\t\t\t'money'=>$this->info['mgold'],\t\t\t\t'custom'=>'',\t\t\t\t'payment'=>'',\t\t\t\t'paymentno'=>'',\t\t\t\t'molds'=>$this->molds,\t\t\t\t'aid'=>$this->id,\t\t\t\t'addtime'=>time(),\t\t\t\t'auser'=>'',\t\t\t);\t\t\t$a=syClass('syaccount',array($row))->payment();\t\t\tmessage($a['msg'],$a['url']);\t\t}\t\t$this->positions='<a href=\"'.$GLOBALS[\"WWW\"].'\">首页</a>  &gt;  支付中心';\t\t$this->display(\"pay/buy_molds.html\");\t}\n可以看到表名是可控的正常流程是这样的\n\n\n\n当molds=article evilcode#时\n\n   漏洞证明：  正常流程是这样的\n\n\n\n当molds=article evilcode#时\n\n   修复方案：  指定标段为好   版权声明：转载请注明来源 小飞@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-10-11 18:27 厂商回复： 感谢提出 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}