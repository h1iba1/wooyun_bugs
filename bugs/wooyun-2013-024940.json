{"id": 64716, "wybug_id": "wooyun-2013-024940", "wybug_title": "115.com存储型xss漏洞", "wybug_corp": "广东雨林木风计算机科技有限公司", "wybug_author": "cbuteng", "wybug_date": "2013-06-04 14:14", "wybug_open_date": "2013-07-19 14:15", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-19：\t细节向公众公开  简要描述： 二次处理数据不当 详细说明：  漏洞存在于发表日志处首先发表一个日志，插入视频，然后访问日志观察可以发现这是一个img标签，当我们点击播放的时候，就会播放flash。点击前\n\n点击后\n\n可以发现img标签变成了embed标签那么就存在一个标签转换的过程，将img标签转换成embed标签。在转换的过程中就有可能存在获取img标签数据和输出的过程。而img标签的内容又一定程度的可控，所以这个转换过程是可能存在问题的经过查找最终定位到http://115.com/zone/static/js/Wo/WO.js\n\n可以发现这段js先获取了img标签的各个属性和值然后使用jquery的after方法添加到dom去但是这里却采用了attr方法来获取img标签属性的值，这个方法有个特性，就是即使编码了，获取的时候有个解码操作。刚才在img标签里面被处理了的字符，在这里获取的时候又解码回来了，接着没有任何其他处理直接使用after方法添加到dom树上，这个时候就造成了xss。   漏洞证明：  首先发表日志，插入视频\n\n然后发表\n\n点击\n\n触发\n\n   修复方案：  使用attr获取值过后先进行处理在使用after方法添加   版权声明：转载请注明来源 cbuteng@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2013-06-06 09:06 厂商回复： 非常感谢! 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-04 14:28 |    \t\thappytree \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:1        | \"如果我死了，请吃掉我吧\")\t\t \n  顶 cbuteng大牛    \n     2013-06-04 14:43 |    \t\t猪头子 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:35        | 自信的看着队友rm -rf/tar挂服务器)\t\t \n  顶 cbuteng大牛     \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}