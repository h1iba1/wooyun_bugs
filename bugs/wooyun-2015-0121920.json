{"id": 3447, "wybug_id": "wooyun-2015-0121920", "wybug_title": "某银行手机客户端存在被中间人攻击的风险", "wybug_corp": "bsb.com.cn", "wybug_author": "歪耳朵猫", "wybug_date": "2015-06-21 12:32", "wybug_open_date": "2015-09-22 14:56", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "手机应用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-22：\t细节向公众公开  简要描述： 某银行手机客户端未校验服务端证书，导致存在被中间人攻击的风险 详细说明：  对于银行来说，都应该采用https/tls这种安全通信协议，同时要对服务器证书校验。但是该银行客户端包括Android、IOS虽然采用了https，但是没有校验服务器证书，那么在不安全的网络环境中，存在被中间人攻击的可能。首先试试登陆\n\n然后可以看到，用fiddler已经把通信给截获了，可以看到返回的明文。\n\n\n\n更为危险的是，该银行的客户端核心是一个webkit，有些数据返回的是html页面。那么有可能直接被替换掉。比如在自助注册的页面，\n\n可以再fiddler中看到\n\n\n\n这个请求返回的是html。bpu下断点修改一下标题部分，篡改成功。\n\n   漏洞证明：     修复方案：  在采用https协议的同时，要对服务器证书进行验证。   版权声明：转载请注明来源 歪耳朵猫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-06-24 14:55 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向银行业信息化主管部门通报,由其后续协调网站管理单位处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-21 13:27 |    \t\t高小厨 \t\t\t( 普通白帽子  |\t\t\t        Rank:814 漏洞数:74        | 不会吹牛的小二不是好厨子！)\t\t \n  有好多银行的客户端都未使用https，使用的是http，但是数据都是经过多次加密的，想进行中间人也难    \n     2015-06-22 21:36 |    \t\t浩浩~ \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 某个喜欢折腾奇葩东西的。。。1/2码农+1/2...)\t\t \n  某银行，，，哪家都不肯说，真给面子    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}