{"id": 47119, "wybug_id": "wooyun-2014-072893", "wybug_title": "某安卓手机无需root就可以被任意应用截屏", "wybug_corp": "华为技术有限公司", "wybug_author": "三金", "wybug_date": "2014-11-06 15:53", "wybug_open_date": "2015-02-04 15:54", "wybug_type": "默认配置不当", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["华为", "截屏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-04：\t细节向公众公开  简要描述： Android的某些应用具有截屏功能。但截屏功能需要申请root权限。这些应用无法在没有获得root权限的情况下对系统进行截屏。但华为P6上存在漏洞，使得P6手机上的应用不需要获得root权限就可以对系统进行截屏。截屏将会泄露用户的重要隐私，包括输入密码时的按键。 详细说明：  1. 通过adb shell命令连接华为P6手机后，可以直接通过screencap命令对系统进行截屏。例如：shell@hwp6-u06:/ $ screencap -p /sdcard/screen1.png2. 也可以通过screenshot来截屏shell@hwp6-u06:/ $ screenshot /sdcard/screen2.png3. 手机上的任何应用只需要调用上述命令或者另外实现截屏逻辑就可以完成截屏。例如：“No Root Screenshot It”这款应用就可以在P6上直接截屏，而不需要root手机。但是在其他手机上就需要root之后并获得root权限之后才能截屏   漏洞证明：  1. 通过screencap截到的屏幕\n\n2. 通过screenshot截到的屏幕\n\n3. 通过第三方应用“No Root Screenshot It”截到的屏幕\n\n4. 存在漏洞的P6版本\n\n\n\n   修复方案：  原理：无论是通过screencap还是screenshot命令，亦或是第三方应用自己实现，截屏最终都是去访问/dev/graphics/下的fb0节点。华为P6对于这个节点的访问权限没有严格控制。任意的uid对其都可以访问。\nshell@hwp6-u06:/ $ ls -l /dev/graphics/                                        crwxrwxrwx root     graphics  29,   0 2014-08-18 12:29 fb0crw-rw---- root     graphics  29,   1 2014-08-18 12:29 fb1crwxrwxrwx root     graphics 199,   0 2014-08-18 12:29 galcore\n而其他手机，例如红米1，对f0的访问权限是严格控制的。普通应用是无法访问fb0的\nshell@HM2013022:/ $ ls -l /dev/graphics/crw-rw---- system   graphics  29,   0 2014-08-16 08:34 fb0\n修复建议：建议华为修正/dev/graphics/fb0的默认权限配置。防止普通应用直接访问。   版权声明：转载请注明来源 三金@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-11-07 17:57 厂商回复： 感谢白帽子关注。较早前已针对漏洞发布补丁。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-06 15:59 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  抱歉 ：）    \n     2014-11-06 16:06 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  抱歉 ：）    \n     2014-11-06 16:11 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  抱歉 ：）    \n     2014-11-06 16:14 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  费解 为何抱歉\"截屏将会泄露用户的重要隐私，包括输入密码时的按键。\"那么其他厂商是否也有此问题那 路人甲    \n     2014-11-06 17:24 |    \t\t小森森 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 不中二 枉少年)\t\t \n  @abaddon 请看洞主描述 “一般安卓手机需要申请root权限才能截屏”    \n     2014-11-06 17:31 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @abaddon 因为当时没通过    \n     2014-11-06 18:57 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  抱歉 ：）    \n     2014-11-08 08:10 |    \t\t萌萌哒-花粉 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:5        | 多乌云 多美女 花粉 顾名思义 就是校花班花...)\t\t \n  @xsser 足见乌云压力漏洞审核压力之大  失误在所难免 那么问题来了 某授权访问权鉴绕过高危通用漏洞(软件更新后再次绕过)希望大神门起床后优先考虑则情 审核 一如既往地支持乌云 漏洞不少奖金的问题 而是解决问题     \n     2014-11-10 14:48 |    \t\tLapplefut \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | null)\t\t \n  估计是/dev/graphics/fb0之类的驱动权限没控制好导致直接控制驱动读取截屏……    \n     2014-11-27 18:39 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  1、2步测试没啥意义么。adb shell是有截图权限的了。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}