{"id": 12246, "wybug_id": "wooyun-2015-0119094", "wybug_title": "某大型支付机构移动端产品设计不当可绕过密保问题重置任意用户密码", "wybug_corp": "某大型支付机构", "wybug_author": "高小厨", "wybug_date": "2015-06-09 11:48", "wybug_open_date": "2015-07-27 18:30", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-27：\t细节向公众公开  简要描述： 发现以前报过重置密码的问题，后来改进了，不过某些地方还是缺乏服务端校验 详细说明：  1、测试对象：IOS端银联钱包\n\n2、找回密码，然后输入你要攻击的账号，例如输入你老公/老婆的\n\n3、输入正确的验证码，拦截返回的数据包\n\n4、替换数据包放行\n\n5、点击“通过安全问题找回”，然后直接跳转到重置密码的页面\n\n6、重置密码成功\n\n   漏洞证明：  重置密码页面的链接代码：\nGLO.APP.PY.createWebPage(\"设置新密码\",\"/page/find_password/reset.html\" +  GLO.TOOL.PY.searchStr.getUrl());\n漏洞证明（重置密码后可以成功登陆）：\n\n缺点是：只能对熟人下手，因为验证码绕不过去，但是手机丢了。。。   修复方案：  看代码是JavaScript读取服务器上的数据在本地进行校验，这个过程在服务器上校验才安全，同时获取数据的JavaScript代码很有可能泄露密保问题和银行卡信息的，例如：\nGLO.TOOL.PY.cordovaInit(function(){\t\t\t//自动初始化\t\t\tGLO.TOOL.PY.autoInit();\t\t\t//安全问题验证\t\t\t$(\"input\").FormValid({\t\t\t\tcallback : function(){\t\t\t\t\tGLO.TOOL.PY.searchStr.setItem(\"answer1\",$(\"input[name=answer1]\").val());\t\t\t\t\tGLO.APP.PY.createWebPage(\"设置新密码\",\"/page/find_password/reset.html\" + GLO.TOOL.PY.searchStr.getUrl());\t\t\t\t}\t\t\t});\t\t\t\t\t    // logEvent 输入安全问题答案\t\t\t$('input[name=\"answer1\"]').logInputEvent(function () {\t\t\t    return { name: 'refind_pwd_safe_qus' };\t\t\t});\t\t})\n   版权声明：转载请注明来源 高小厨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2015-06-12 18:29 厂商回复： CNVD确认所述情况,已经转由CNCERT向中国银联通报,由其后续协调网站管理部门处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-29 01:28 |    \t\tJumbo \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:29        | 猫 - http://www.chinabaiker.com)\t\t \n  fiddler抓返回包 是不是得先发一次包？    \n     2015-07-29 09:22 |    \t\tMowen \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 没个性，不签名！)\t\t \n  手机端的软件，怎么用电脑抓包的？    \n     2015-07-29 11:40 |    \t\tSpy4man \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 职业运维师..)\t\t \n  通过burpsuite的代理功能，手机设置一下代理指向burpsuite的代理。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}