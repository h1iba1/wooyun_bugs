{"id": 44259, "wybug_id": "wooyun-2015-0109713", "wybug_title": "DNSPod域名无验证所有权限(可导致域名被恶意接管使用)", "wybug_corp": "DNSPod", "wybug_author": "剑兰", "wybug_date": "2015-04-28 18:35", "wybug_open_date": "2015-04-30 14:53", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "安全意识不足", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 因DNSPOD在添加域名时无验证域名所有权限，遂通过该漏洞可非法管理他人域名。 详细说明：  当域名 a 的 dns服务器改为 dnspod 的 dns服务器之后，所有 dnspod 的账户，均有添加该域名到自己账户管理下的权限。   漏洞证明：  域名dns服务器原来在新网，现在改为dnspod。\n\n修改成功：\n\n新注册一个 dnspod 账户，添加这个域名：\n\n添加成功：\n\n添加一个解析：\n\n解析成功，域名已经完全被我这个新账户所控制。\n\n   修复方案：  在将域名的DNS服务器修改为DNSPOD服务器之后，若不通过验证，将禁止任何人将该域名占为己有。在DNSPOD后台添加域名时，由DNSPOD像该域名注册邮箱发送验证邮件，点击之后，才可添加到对应的DNSPOD后台。   版权声明：转载请注明来源 剑兰@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-04-30 14:53 厂商回复： 这位童鞋，你邮箱帐号暴露了，请注意打码！PS: DNSPod 是开放的，从2006年上线运营至今，我们一直都允许用户在正常范围内随意添加域名，请您知晓~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-28 18:46 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  不用修改dns?    \n     2015-04-28 20:49 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  这个要关注下。    \n     2015-04-30 14:09 |    \t\t蘑菇街(乌云厂商)\t\t \n  mark    \n     2015-04-30 15:50 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  哈哈哈 笑死我了  太逗了    \n     2015-04-30 15:58 |    \t\tG9sT \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | php水平与白帽子等级相当。)\t\t \n  火钳留名，发这个的肯定是喜剧演员，话说乌云审核员是怎么搞的。。    \n     2015-04-30 16:01 |    \t\t灭亡 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:5        | 乌云打杂 偶尔发几个垃圾洞刷存在  qq83133...)\t\t \n  逗死我了   喜剧托么 @剑兰 黑阔你好    \n     2015-04-30 16:13 |    \t\t剑兰 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | Hello World.)\t\t \n  @灭亡 @G9sT @浅蓝 喜剧演员在此。该帖起源于我在注册域名时，把DNS服务器改成dnspod的，然后没有管它。后来就被其他人添加到自己账户下开始使用了。我不觉得这是正常的啊。谁来给我科普下？    \n     2015-04-30 16:44 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  @剑兰  那个人闲的蛋疼买完域名解析到dp也不绑定就扔那不管了?      \n     2015-04-30 16:51 |    \t\t剑兰 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | Hello World.)\t\t \n  @浅蓝 我就是啊。。我经常有域名在新网注册后就放那不管了，谁知道DNS改成DP之后，居然被其他人直接拿去用了呢。那这是我自己的问题了？    \n     2015-04-30 16:56 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  这是危害 ，厂商回复没明白 。    \n     2015-04-30 17:01 |    \t\t剑兰 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | Hello World.)\t\t \n  如果能有办法获取新注册的域名列表，并筛选出DNS为DP的域名，只要注册人不予理睬，那么自己就直接可以拿来用。。。。。我总觉得这。。。。。。。    \n     2015-04-30 17:14 |    \t\t端端 \t\t\t( 普通白帽子  |\t\t\t        Rank:133 漏洞数:18        | niconiconi~)\t\t \n  难道不是应该先在dnspod设置域名，然后再修改NS记录吗。如果真有人抢先的话，设置时就应该提示冲突吧（我是这么想的，谁确认下）。话说 @剑兰 ，把NS记录都改到dnspod了，还不去设置域名，我个人觉得这是你的问题……    \n     2015-04-30 17:21 |    \t\t剑兰 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | Hello World.)\t\t \n  @端端 完全没有这个意识。之前在新网注册过很多域名都是闲置的，放那从来没管过，也没出现过被别人使用的问题。非首次添加，会提示冲突，但是已经晚了，提示冲突，证明你的域名已经被人拿去用了。    \n     2015-04-30 17:27 |    \t\t端端 \t\t\t( 普通白帽子  |\t\t\t        Rank:133 漏洞数:18        | niconiconi~)\t\t \n  @剑兰 我又看了一下。即使没有修改NS记录到dnspod，如果其他用户添加过你的域名，当你添加时就会提示“域名被其他账户添加，点击取回”，这时NS记录还未修改所以是安全的。所以先添加域名确保其他人无法添加，然后再修改NS记录就可以了。毕竟NS记录不改到dnspod解析是不会生效的。（所以说既然是闲置域名，为什么要改NS记录）    \n     2015-04-30 17:30 |    \t\t灭亡 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:5        | 乌云打杂 偶尔发几个垃圾洞刷存在  qq83133...)\t\t \n  @端端 本来就是 所以说此洞特别逗    \n     2015-04-30 17:36 |    \t\t剑兰 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | Hello World.)\t\t \n  @灭亡 如果能有办法获取新注册的域名列表，并筛选出DNS为DP的域名，只要注册人不予理睬，那么自己就直接可以拿来用。这个也不属于BUG么。    \n     2015-04-30 18:30 |    \t\tDeadSea \t\t\t( 实习白帽子  |\t\t\t        Rank:86 漏洞数:28        | 静心)\t\t \n  那是个人问题-。- 表示你解析过去不绑定你解析过去干嘛？看看而已？而且你怎么知道对方绑定没绑定？难道你一个一个去试？    \n     2015-04-30 18:39 |    \t\t剑兰 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | Hello World.)\t\t \n  @DeadSea dp的dns挺好，所以我域名都在dp管理。有新注册的域名，也就在注册时，直接填写了dp的dns。否则在使用时，还要再折回去修改dns，太麻烦。只是没有料到自己没有添加的域名，别人可以随意拿去添加使用。    \n     2015-04-30 22:30 |    \t\tDeadSea \t\t\t( 实习白帽子  |\t\t\t        Rank:86 漏洞数:28        | 静心)\t\t \n  我只问一个问题你怎么知道别人有没有绑定？别说爆破    \n     2015-05-01 10:33 |    \t\t剑兰 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | Hello World.)\t\t \n  @DeadSea 上面提到一个假设，获取新注册并且设置过NS为DP的域名，这时因为是新注册，那么在DP未绑定的几率很大（当然会有先在DP添加好，再去注册的）。说具体方法，我真不知道，我发现这个问题，是因为我的一个域名 ly0371.com ，就是这么被别人使用的。至于他怎么知道我没有绑定的，这可能是关键。    \n     2015-05-01 10:40 |    \t\t大师哥 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | I am the government)\t\t \n  那就批量生成域名添加到dnspod并解析。。。    \n     2015-05-01 11:14 |    \t\t剑兰 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | Hello World.)\t\t \n  当你们看完这个笑话和这些评论，以后当你们把域名的NS改为DP后，会不会有一种要赶快把域名添加到DP自己账号下的紧迫感？我不清楚这个情况是否会带来一些危害，因为我不是专业黑客，我只是一个普通的IT从业者。。哦不，一个喜剧演员。    \n     2015-05-01 11:41 |    \t\tHero \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:31        | 药药切克闹,充气娃娃迷幻药)\t\t \n  @剑兰 我觉得这个真心是个问题,毕竟大众的安全意识确实有待提高    \n     2015-05-01 18:01 |    \t\tJumbo \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:29        | 猫 - http://www.chinabaiker.com)\t\t \n  这个很给力啊，是问题    \n     2015-05-01 18:04 |    \t\t李白 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:29        )\t\t \n  如果是洞主所说，是大问题+1    \n     2015-05-01 18:07 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  看起来似乎有逻辑问题    \n     2015-05-01 21:33 |    \t\tNAT \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        )\t\t \n  有点意思，应该不止dnspod有这样的问题。写个脚本，批量从whois提取ns，然后nslookup...    \n     2015-05-01 22:59 |    \t\tDeadSea \t\t\t( 实习白帽子  |\t\t\t        Rank:86 漏洞数:28        | 静心)\t\t \n  楼上牛B    \n     2015-05-02 21:50 |    \t\tcatcat520 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | 大家好，我是刚学网络 00后，求照顾，谢谢)\t\t \n  楼上一群菜b 图样图森破，三太奶义父，这个是厂商故意的，不然就没人买VIP了，你以为厂商傻，厂商还在捂着嘴笑你逗比闷声发大财呢    \n     2015-05-29 15:19 |    \t\tbingfeng \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 万丈红尘三杯酒，千秋大业一壶茶。)\t\t \n  应该还有其它的漏洞,今天发现我的账号被黑了,4月28号进行恶意修改dns记录,等待大牛发布漏洞    \n     2015-06-12 18:11 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  我猜楼主的WHOIS和注册DNSPOD的邮箱是一样的    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}