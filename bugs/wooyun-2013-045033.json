{"id": 5622, "wybug_id": "wooyun-2013-045033", "wybug_title": "正方教务系统目录设计不当致用户密码泄露", "wybug_corp": "杭州正方软件股份有限公司", "wybug_author": "ghy459", "wybug_date": "2013-12-05 18:35", "wybug_open_date": "2014-03-05 18:36", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["密码泄露", "目录权限", "正方教务"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-02-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-05：\t细节向公众公开  简要描述： 正方教务系统某目录权限设置不当，有可能通过猜测文件名获得用户名和密码。 详细说明：  正方教务系统一些关键操作都会记录log，而log所在默认位置就是根目录/log。以我们学校为例：\n\n里面的文件命名格式是 \"YYYY-MM-DD\"+\"-log.txt\"或\"YYYY-MM-DD\"+\"-Errorlog.txt\"\n\n从zjdx.dll里面也可以找到关于log文件建立的代码：\n\n在正方教务的安装文档中，并没有提示学校要限制log目录的访问，导致漏洞的存在。   漏洞证明：  log记录了登录用户的关键行为，提交过的参数，或数据库语句。通过default_ldap.aspx进行登录的用户，他们的账号密码都会被写入log中。\n\n在log.txt中通过搜索\"passwd\"就能找到大量用户密码。\n\n\n\n花点时间就能找到jwc01的密码了。\n\nbaidu随便搜了几个用正方教务的学校，漏洞都是存在的。\nhttp://jwch.swuyc.edu.cn/log/2013-11-03-log.txthttp://xuanke.ncepu.edu.cn/log/2013-11-03-log.txthttp://202.116.193.32/log/2013-10-23-log.txthttp://ea.uestc.edu.cn/log/2013-09-30-log.txt\n上面主要分析了账号密码泄露的问题，其它关键信息就暂且不论，但也是很重要滴~(注：学校一般在选课的时候才让同学通过default_ldap.aspx进行访问，所以在选课高峰期搜集密码比较靠谱~)   修复方案：  注意log目录的访问权限。   版权声明：转载请注明来源 ghy459@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2013-12-09 22:11 厂商回复： CNVD确认并复现所述情况，已经由CNVD在6日直接转报正方软件股份有限公司。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-05 23:17 |    \t\tblack hook \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:8        | 新人、)\t\t \n  又来正方了！。偶也    \n     2013-12-06 00:37 |    \t\tj0phy \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:4        | Bloger & Scanner & Optimist)\t\t \n  先mark一下 等公开看看~    \n     2013-12-06 09:03 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  是log？    \n     2013-12-06 16:52 |    \t\tthundrous \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 生有涯，学无涯也)\t\t \n  mark，正方已然千疮百孔    \n     2013-12-10 22:01 |    \t\tj0phy \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:4        | Bloger & Scanner & Optimist)\t\t \n  这个漏洞就我目前看，只有一个学校有。    \n     2013-12-10 22:04 |    \t\tfyth \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我就看看，不说话)\t\t \n  同5L    \n     2013-12-11 14:56 |    \t\t马桶 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 一个为了热情甘愿奉献除生命以外一切的人)\t\t \n  持续关注    \n     2013-12-30 11:17 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  好像有个别学校有而已，因为之前发现过。我看见的那个就不写密码    \n     2014-03-05 22:00 |    \t\tKnight \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:10        | 刚刚上洗手间，看到一个玉树临风的少年，气...)\t\t \n  只有我一个人奇怪LZ用菜刀连的学校系统?    \n     2014-03-05 22:01 |    \t\tayys \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 欢迎交流，熟悉正方教务系统漏洞。专业挖洞...)\t\t \n  @Knight 很正常。。。漏洞太多    \n     2014-03-05 22:34 |    \t\tKnight \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:10        | 刚刚上洗手间，看到一个玉树临风的少年，气...)\t\t \n  @ayys 都上传shell了却只发个泄露密码的漏洞这样真的好？    \n     2014-03-06 10:59 |    \t\t西瓜 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 喜爱渗透，硬件！！、、、、、、)\t\t \n  我想知道 楼主是怎么拿到shell的    \n     2014-03-07 00:18 |    \t\t廷廷 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 有很强的好奇心，爱好广泛，求女女带走。。...)\t\t \n  我们学校也行，就是下载不下来。。    \n     2014-04-01 23:57 |    \t\tSleshep \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 隼)\t\t \n  LZ幽默到不行，，，我被笑翻了。。。菜刀都上了，。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}