{"id": 46740, "wybug_id": "wooyun-2015-089632", "wybug_title": "优酷设计缺陷导致任意用户密码秒改", "wybug_corp": "优酷", "wybug_author": "niliu", "wybug_date": "2015-01-01 17:16", "wybug_open_date": "2015-02-15 17:18", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-15：\t细节向公众公开  简要描述： 元旦快乐~。~我来打卡咯~ 详细说明：  优酷密码找回处设计缺陷导致可以绕过验证码重置任意用户密码我找了2个测试账号来测试下13888888888和13111111111正常流程找回密码输入手机号码，然后获取验证码\n\n然后随便输入一个错误的验证码，提交时抓包\n\n然后 burp Action里设置Do intercept --Response to this request拦截这个请求\n\n然后把红色箭头处两个值改为‘1’，这是最关键的一步。\n\n然后Forward出去之后，紧接着会再提交一个验证码请求，这个不用改直接发出去就可以修改密码了。\n\n\n\n测试了两个账号，密码都改为了wooyun\n\n登陆看一下13888888888\n\n13111111111\n\n两个账号都可以登陆。   漏洞证明：  综上所述。   修复方案：  服务器端校验验证码。   版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-01-01 23:06 厂商回复： 多谢提醒，马上修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-01 20:04 |    \t\t天地不仁 以万物为刍狗 \t\t\t( 普通白帽子  |\t\t\t        Rank:977 漏洞数:264        | 天地本不仁 万物为刍狗)\t\t \n  需要知道原密码不？    \n     2015-01-01 21:02 |    \t\tbingfeng \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 万丈红尘三杯酒，千秋大业一壶茶。)\t\t \n  坐等公开    \n     2015-01-01 21:20 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  洞主，你又调皮了    \n     2015-01-01 22:49 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  真奇葩    \n     2015-01-01 23:11 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @天地不仁 以万物为刍狗 二楼已经替我回答了,哈哈    \n     2015-01-01 23:12 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @Coody 膜拜众测Coody大牛    \n     2015-01-01 23:13 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @zeracker 3哥帮忙审核的么？    \n     2015-01-05 12:50 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  -0-  麻烦能不能帮我改个用户名，我要admin用户的，能访问后台的那种，还有麻烦告诉我后台地址，恩    \n     2015-02-02 01:07 |    \t\tBlackeagle \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 向WooYun致敬)\t\t \n  这个赞 可以理解为把改密码的验证步骤从两步减为一步了吗@niliu     \n     2015-02-15 18:49 |    \t\tpw0 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:2        | 爱推理，爱计算机，爱社工，爱挖有（wei）...)\t\t \n  霸气死    \n     2015-02-15 22:49 |    \t\tZtz \t\t\t( 普通白帽子  |\t\t\t        Rank:152 漏洞数:40        | 自由职业)\t\t \n  那个-1是在response里的的，拦住了干嘛？判断验证码是否正确的代码在本地？    \n     2015-02-16 10:02 |    \t\ttodaro \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:12        | 完结。)\t\t \n  点解？    \n     2015-07-15 21:22 |    \t\ttheone \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:3        | hodor，hodor)\t\t \n  mark    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}