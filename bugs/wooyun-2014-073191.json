{"id": 51847, "wybug_id": "wooyun-2014-073191", "wybug_title": "时光网前端礼包大放送 XSS+CSRF 各种刷转发 回复 加关注", "wybug_corp": "时光网", "wybug_author": "0x_Jin", "wybug_date": "2014-08-20 16:51", "wybug_open_date": "2014-08-28 16:40", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-28：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 时光网CSRF 各种刷转发 回复 加关注，当大家都在say 0x_Jin 我是何种心情？ 详细说明：  今天也累了  不想挖了 但是目标得达成~挖了万达的 就再来个时光网的吧。首先把目光锁定在CSRF上吧 首先在测试群组的帖子的时候发现回复那 是做的白名单限制 限制的比较严哈 (此处点个赞)但是发现 img 标签能用 尽管无法写事件，但是此处埋下了伏笔。然后我们把目光转向 http://my.mtime.com/ 在这里 你能发一些类似于 微博一样的东西，在这里你还可以有粉丝！于是 在此处开始测试，首先是发一条微博，发现竟然是通过get 来提交的。。。先上图：\n\n看到这里 我简直惊呆了。。。还真有传说中的这种奇葩。。。。但是这还不算完，继续看！转发：\n\n加关注：\n\n这里替换成自己的ID 就可以关注自己了！哎哟我去。。。 我简直惊呆了有木有。。。并且还无token有木有现在包也抓到了 我们来玩csrf 好不好啊！在前面说了 在一些回复的地方 可以插入img标签，都知道img标签的src属性可以发出get请求 那我们说做就做吧！\n\n看下src的内容：\n\n在这里看不全 因为chrome 省略了一点，但是copy as html 就看全了！现在我们到处插了图片 我们来看看效果吧！\n\n是不是很酷炫呢，来看看大家都在说什么：\n\n大家都在说0x_Jin喔！ 那感觉 。。。好了，说好的大礼包 那就再来个存储型XSS改善下生活吧！漏洞存在于 blog 发日志的摘要处 会被带入meta的content内 并且未做过滤！\n\n\n\n可以看到xsspayload 被带入了 并且没做过滤 弹窗了漏洞地址：http://i.mtime.com/12682108/blog/7803922/温馨提示：请问safari打开喔！ps:请时光网大大 不要封我号 让我潇洒一回   漏洞证明：  今天也累了  不想挖了 但是目标得达成~挖了万达的 就再来个时光网的吧。首先把目光锁定在CSRF上吧 首先在测试群组的帖子的时候发现回复那 是做的白名单限制 限制的比较严哈 (此处点个赞)但是发现 img 标签能用 尽管无法写事件，但是此处埋下了伏笔。然后我们把目光转向 http://my.mtime.com/ 在这里 你能发一些类似于 微博一样的东西，在这里你还可以有粉丝！于是 在此处开始测试，首先是发一条微博，发现竟然是通过get 来提交的。。。先上图：\n\n看到这里 我简直惊呆了。。。还真有传说中的这种奇葩。。。。但是这还不算完，继续看！转发：\n\n加关注：\n\n这里替换成自己的ID 就可以关注自己了！哎哟我去。。。 我简直惊呆了有木有。。。并且还无token有木有现在包也抓到了 我们来玩csrf 好不好啊！在前面说了 在一些回复的地方 可以插入img标签，都知道img标签的src属性可以发出get请求 那我们说做就做吧！\n\n看下src的内容：\n\n在这里看不全 因为chrome 省略了一点，但是copy as html 就看全了！现在我们到处插了图片 我们来看看效果吧！\n\n是不是很酷炫呢，来看看大家都在说什么：\n\n大家都在说0x_Jin喔！ 那感觉 。。。好了，说好的大礼包 那就再来个存储型XSS改善下生活吧！漏洞存在于 blog 发日志的摘要处 会被带入meta的content内 并且未做过滤！\n\n\n\n可以看到xsspayload 被带入了 并且没做过滤 弹窗了漏洞地址：http://i.mtime.com/12682108/blog/7803922/温馨提示：请问safari打开喔！ps:请时光网大大 不要封我号 让我潇洒一回   修复方案：  csrf防御的方法一堆，最主要还是  连转发 跟发微博都get。。。 这点不太合适啊！   版权声明：转载请注明来源 0x_Jin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-08-20 17:20 厂商回复： 谢谢  0x_Jin ，我们会尽快修复 最新状态： 2014-08-28：已修复  ", "replys": "漏洞评价：\n评论\n     2014-09-15 20:53 |    \t\tStardustsky \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | ……)\t\t \n  5分也拿得出手？    \n     2014-09-21 20:42 |    \t\t安然意境 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:79        | 无论是你的事业还是你的个人，可能走的过程...)\t\t \n  才5分？    \n     2014-11-20 19:59 |    \t\t第四维度 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:34        | 谦谦君子，温润如玉)\t\t \n  src那个连接构造的url是怎么构造出来的？看了很多遍看不明白啊。    \n     2014-11-20 21:30 |    \t\t0x_Jin \t\t\t( 普通白帽子  |\t\t\t        Rank:319 漏洞数:37        | 微博：http://weibo.com/J1n9999)\t\t \n  @第四维度 他的加关注的链接跟发围脖的链接都是get请求  不用构造只需要更改掉关键值 然后用img去发get请求就ok了    \n     2014-12-21 10:42 |    \t\t迦南 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:11        | 我不是玩黑，我就是认真)\t\t \n  为什么才5分？    \n     2015-04-26 09:15 |    \t\tMr.R \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:14        | 求大神带我飞 qq2584110147)\t\t \n  这。 5分也能往外拿么    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}