{"id": 65710, "wybug_id": "wooyun-2015-0136376", "wybug_title": "美丽说某平台大量功能存在设计缺陷（账号越权操作）", "wybug_corp": "美丽说", "wybug_author": "Wulala", "wybug_date": "2015-08-25 12:02", "wybug_open_date": "2015-10-09 12:46", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "认证设计不合理", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-09：\t细节向公众公开  简要描述： 美丽说某平台设计缺陷多个越权操作 详细说明：  1. http://lm.meilishuo.com/ 无意发现一个号：美丽说网站：lm.meilishuo.com账户 :通付宝密码 ：tfbpay.cn简单测试一下2.  用 我自己账号 添加了一个媒体 ID 2341 \n\n 添加媒体的HTTP Request \n\n 账号\"通付宝\"新建一个媒体并抓包修改 \n\n \n\n\n\n3. 账号1 ID 2341媒体内容已经被覆盖 \n\n通过上面的测试，我们知道媒体和用户之间没有做验证，而且设计错误，用户可控source_id造成数据覆盖.4. 删除测试   账号1 删除对象 \n\n   账号二执行删除操作,修改删除source_id \n\n   通过浏览器测试也是可以删除成功的,其他的同理..5. 媒体认证-认证机制设计也太弱了   认证说明 \n\n   认证文件   认证文件是固定的 \n\n6. 认证Bypass    先认证一个自己的的网站 \n\n    使用上面的设计缺陷，覆盖source_id可以绕过认证机制 \n\n7. 其他   上面我们通过覆盖绕过认证，对于被覆盖的网站我们在另一个账号直接添加无须验证即验证成功. 8.  当然不光这些,比如推广位也是一样的.. \n\n    引用其他用户媒体 \n\n    越权删除推广位 \n\n9. 先这些吧...   漏洞证明：     修复方案：  1. source_id用户不可控2. 媒体资源和用户权限控制3. 网站认证机制: 每个媒体不同的认证文件，对媒体修改的操作需要重新验证   版权声明：转载请注明来源 Wulala@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-08-25 12:45 厂商回复： 非常感谢您对美丽说安全的关注，经验证该漏洞真实存在，已联系相关人员紧急修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}