{"id": 8639, "wybug_id": "wooyun-2013-032644", "wybug_title": "Discuz! 绕过安全密码安装插件", "wybug_corp": "Discuz!", "wybug_author": "江南的鱼", "wybug_date": "2013-07-30 10:35", "wybug_open_date": "2013-10-28 10:36", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["绕过安全密码安装插件"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-09-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-28：\t细节向公众公开  简要描述： 前段时间我写了个利用插件拿Discuz!论坛shell的文章：http://zone.wooyun.org/content/5275很多人说安装插件需要 安全密码 ，其实很早我就发现安全密码可以绕过的，这样就能在安装插件的论坛上拿下shell了 详细说明：  不管你是注入，还是社工，甚至人品大爆发输入弱智密码进入了Discuz!后台，按我那篇文章来利用插件来拿shell，却出现需要 安全密码的情况，郁闷了吧？如下图【这种情况主要是论坛管理员安装了插件，并且绑定了QQ】：\n\n看到图片所示了吧，没辙了吧，呵呵，其实还真有办法绕过密码，安装插件的。先说下我测试用的版本： Discuz! 程序版本\tDiscuz! X3 Release 20130620下面来说说绕过安全密码的步骤：1. 如果你没有QQ绑定过论坛，那么你就本地安装一个 Discuz! ，然后 应用 ——》应用中心 ——》 插件 ，左上角有个注册。\n\n 注册吧，网站名称: 随便写， 网站 URL: 随便写，也可以写你要拿的目标站，点下一步，就来到了输入安全密码的地方，这个就输入你自己的安全密码吧，要记住这个安全密码哦。\n\n好吧，点绑定QQ帐号，来绑定一个QQ\n\n我已经绑定好了，如果你有QQ绑定了论坛【不管绑定的什么论坛】，就跳过上面的步骤。2.现在我们去目标站操作，登陆目标站后，进入应用中心，点，网站信息\n\n下面有个 退出登陆 ，点 退出登陆，出现这样的界面\n\n然后点 QQ登陆 ，选择我们第一步 绑定论坛的 QQ ，登陆进去。\n\n3. 我们进入插件市场 选择一个插件，然后点安装，会出现要输入安全密码的地方，这个地方，输入我们自己QQ绑定网站的 安全密码。【别以为这样就能下载插件了，这样会出现校验错误的】，然后会跳转到插件安装页面，如果QQ绑定的域名不是目标站，会跳转到绑定站的后台登陆页面，不用管，重新输入目标站的后台进入后台。\n\n4. 这步就是关键了，决定是否能绕过安全密码安装插件的关键，进入后台后： 点应用，再点击 应用中心， 再点击 网站信息，看看网站信息是不是之前目标站原本的信息，一定要确认是原本网站的绑定信息【不能显示自己QQ绑定的信息，如果显示自己QQ绑定的信息，则失败】，如果不是，你需要重新 点 应用 再点 应用中心。\n\n5. 现在你可以去插件市场安装插件了，不会再有安全密码提示了。\n\n现在我们按 我另一篇文章写的利用插件来拿shell吧，文章地址：http://zone.wooyun.org/content/5275\n\n已经菜刀连接上了【PS：打了半天的码，预览时还是发现有一处没有打码，可以找到我这次的测试网站，算了，就不打码了，比较晚了】！\n\n   漏洞证明：  \n\n详细说明里面已经有了。   修复方案：  严格绑定QQ和对应的url，并且要 必须通过认证。   版权声明：转载请注明来源 江南的鱼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-08-01 16:42 厂商回复： 此问题我们已经修复，谢谢您的支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-30 22:52 |    \t\t冰杰 \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:6        | 彩笔是我...)\t\t \n  求绕过方法拿个站。。哎    \n     2013-08-01 16:58 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  求绕过方法拿个站。。哎    \n     2013-08-24 19:25 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  求绕过方法拿个站。。哎    \n     2013-08-24 19:29 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  5000的节奏？    \n     2013-10-27 12:34 |    \t\t命运 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我是来乌云秀智商下限的~~)\t\t \n  不错~~    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}