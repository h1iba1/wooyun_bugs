{"id": 13938, "wybug_id": "wooyun-2013-018210", "wybug_title": "好大夫在线，任意刷钱漏洞---第二弹", "wybug_corp": "好大夫在线", "wybug_author": "小囧", "wybug_date": "2013-02-01 10:38", "wybug_open_date": "2013-03-18 10:39", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "认证设计不合理", "支付行业敏感"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-02-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-02-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-03-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-18：\t细节向公众公开  简要描述： 额，放假了,睡不着，无聊。  俺以前也负责过一段时间支付，就从支付入手了。 详细说明：  1. 先测试支付一分钱，中间看看整个流程哈~~~~ 一路正常没发现问题。2. 发现他们充值的每部都生成了一个新的订单号。\n\n3. 支付成功同步通知的地址。 \nhttp://400.haodf.com/400/pay/rechargeonline?body=zj18675600179%B3%E4%D6%B5%B6%D2%BB%BB%BB%FD%B7%D6&buyer_email=xiaojiong1991%40gmail.com&buyer_id=2088702688628368&exterface=create_direct_pay_by_user&is_success=T&notify_id=RqPnCoPT3K9%252Fvwbh3I70VvLcY7qmeeu8qm3TTjGn%252FBkh%252BERX1f3Xl9bBtbubq3ZvKD0v&notify_time=2013-02-01+01%3A28%3A08&notify_type=trade_status_sync&out_trade_no=906311982_1&payment_type=1&seller_email=pay%40haodf.com&seller_id=2088101708599020&subject=%B1%EA%D7%BC-%B6%A9%B5%A5%BA%C5(906311982_1)&total_fee=0.10&trade_no=2013020144984236&trade_status=TRADE_SUCCESS&sign=55fc3aad7fc0826431e71cece8731b1b&sign_type=MD5\n4.  去生成一笔订单，记住订单号。 \n\nhttp://passport.haodf.com/telpayment/showtelaccount?from=present&orderId=906312072 （注：貌似，只有这个页面生成的订单才可以。）5.  然后去通知成功地址里面的  out_trade_no   参数改为 第4步的那个订单号。发送请求，  即 获得了第4步里面那个订单的充值积分。\n\n 注: 测试过支付宝直接充值rmb 简单测试了下 貌似没有这个bug  但是充值积分的时候发现了这个漏洞，  由于你们 积分=rmb 可以相互转换 所以更刷钱是木有区别的。   漏洞证明：  \n\n测试也要付出代价的  我的2分钱....   修复方案：  初步判断为，支付成功后那个同步通知地址 没有验证支付宝的通知参数是否合法  sign支付这个 细心点 按规则办事 应该是没有问题的呀！！！   版权声明：转载请注明来源 小囧@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-02-01 12:00 厂商回复： 我们接受这个漏洞，是程序逻辑不严谨导致的。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-02-01 10:39 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  哎吗    \n     2013-02-01 10:44 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  怕重复都不敢发 基本没控制    \n     2013-03-18 17:55 |    \t\tSuY1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:46 漏洞数:7        | 1)\t\t \n  那是2毛！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}