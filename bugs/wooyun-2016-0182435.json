{"id": 87550, "wybug_id": "wooyun-2016-0182435", "wybug_title": "中企动力设计缺陷                                      ", "wybug_corp": "中企动力科技股份有限公司", "wybug_author": "蓝冰", "wybug_date": "2016-03-10 09:48", "wybug_open_date": "2016-06-08 11:30", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-03-13：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-05-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-08：\t细节向公众公开  简要描述：  详细说明：  故事的发展是这样的,某某一天想撸一个目标,是中企动力cms的存在http://**.**.**.**/bugs/wooyun-2015-0145311 该注入点但很可惜是时间盲注点\n\nselect pwd from T_USERS 很可惜密码不是普通的md5加密 测试了好几个站点都破解不出来接着发现一个表T_USER_PASSWORDRETRIEVE看命名就能知道是密码找回验证表http://**.**.**.**/manager/user.do?method=toFindPwd随便找了一个站点上面链接就是找回密码的链接但是我们并不知道发往邮箱的链接的方法名 method爆破method参数值无果......省略各种折腾......4天时间过去后去官方溜达发现了一个很低级很严重的漏洞购买过中企动力产品的客户可以去http://**.**.**.**/MemberCenter/certification/toCertification 这里根据信息注册会员以更加方便的管理自己的站点 但是大部分客户并没有去注册 接下来就看如何伪造其他客户去注册\n\n输入客户全名\n\n这里有网站和域名两种验证 网站验证需要后台密码 所以这里用域名验证\n\n完整域名 相信很easy了吧 还有貌似域名校验是在前台完成的 所以这里基本不成障碍然后点击获取验证码\n\n改为自己的邮箱\n\n成功获取到验证码\n\n\n\n然后绑定个手机号就可以了 这里我用了阿里小号\n\n成功注册然后登录进去后 找回网站管理密码\n\n\n\n然后又发现一个越权漏洞\nhttp://**.**.**.**/MemberCenter/home/domainNameResolutionHtml?domainName=**.**.**.**\ndns解析配置\n\n越权访问其他域名\n\n结果就是可越权修改几万客户的dns配置 导致域名劫持接下来就是以管理员身份登录后台并 再添加一个管理员邮箱写自己的邮箱然后退出来找回密码用自己的邮箱 接着去邮箱拿到用来重置密码的URL\n\n\n\nmethod参数值拿到 还需要id和mes值 这两个值T_USER_PASSWORDRETRIEVE 在这个表里就有测试了百度谷歌搜索出来的站点 测试过的都可以时间盲注接下来就是 --sql-shell 然后1 select name from T_USERS拿到邮箱地址 重置密码2 select id from T_USER_PASSWORDRETRIEVE3 select mes from T_USER_PASSWORDRETRIEVE然后拼接 /manager/user.do?method=doGetPwdNew&id=***&mes=*** 重置密码进入后台后台还有一处通用任意文件下载\n\n\n\n   漏洞证明：  已证明   修复方案：  你们懂的   版权声明：转载请注明来源 蓝冰@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-03-10 11:24 厂商回复： 正在处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-10 10:15 |    \t\tdepycode \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:53        | 关注网络安全，提高技术！)\t\t \n  帅    \n     2016-03-10 10:35 |    \t\t大师兄 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:8        | 每日必关注乌云)\t\t \n  666    \n     2016-03-10 10:52 |    \t\tucifer \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:74        | 萌萌哒~)\t\t \n  浩神转审计了，求带    \n     2016-03-15 16:10 |    \t\t小葵 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:11        | 我们是害虫，我们是害虫！)\t\t \n  围观一下。    \n     2016-06-08 11:45 |    \t\t破童 \t\t\t( 实习白帽子  |\t\t\t        Rank:49 漏洞数:20        | Engout Security Team)\t\t \n  酷    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}