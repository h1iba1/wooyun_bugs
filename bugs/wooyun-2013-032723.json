{"id": 9746, "wybug_id": "wooyun-2013-032723", "wybug_title": "看我如重置暴风影音账户密码（需要与用户互交）", "wybug_corp": "暴风影音", "wybug_author": "xfkxfk", "wybug_date": "2013-07-29 17:30", "wybug_open_date": "2013-09-12 17:31", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用", "设计不当", "设计缺陷", "利用技巧", "利用", "防护策略绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-12：\t细节向公众公开  简要描述： 暴风影音某处存在设计缺陷，导致被利用后，可劫持账户，重置用户密码。 详细说明：  1、问题出现在个人中心的邮件验证功能上：\nhttp://i.baofeng.com/verify_email.html\n我们拿用户tester123做测试。首先看看tester123当前绑定的邮箱：\n\n2、然后我们来看看设置验证邮箱的请求内容，抓了个包看看，这个包是xfkxfk123的设置验证邮箱时的请求包：\n\nGET请求的啊3、由于这里设置验证邮箱的功能存在CSRF，我们构造好url请求，让tester123访问看是否存在CSRF，构造的url如下：\nuser.baofeng.com/user/?a=sendCheckMail&email=827731626%40qq.com&callback=Security.setEmailResult\n当tester123访问了如上url后，他的验证邮箱就会被更改，变成827731626@qq.com。当然，如果tester123没有绑定验证邮箱的话，这样也是一样的效果。tester123访问了上面的构造的url：\n\n我们设置的邮箱顺利收到了邮件：\n\n邮件中同时出现了用户名，哈哈，这里的用户名留着大有用处啊我们点击验证url，成功更改了tester123的验证邮箱。\n\n邮箱已经成功更改了，下面开始重置密码之旅。打开忘记密码连接\nhttp://i.baofeng.com/forget_password.html\n输入邮箱中收到的用户名，然后就直接发送邮件了，给力啊给力。\n\n\n\n哈哈，顺利收到密码重置邮件了：\n\n\n\n成功重置密码。通过csrf更改了用户的邮箱，同时加上用户名也得到了，而重置密码只需要用户名，这样就很顺利的重置了用户密码。所以我们把更改验证邮箱的链接发到论坛，诱使用户点击，就等着收邮件了！！！第二天，功夫不负有心人，终于等到了邮件！\n\n   漏洞证明：  见详细说明   修复方案：  最主要的防止scrf就好了   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-07-30 12:54 厂商回复： 感谢@xfkxfk发现并提交漏洞，我们会尽快修复漏洞，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-29 17:36 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  还是这个名字恰当啊，谢谢审核@疯狗，@xsser    \n     2013-07-29 17:51 |    \t\t修码的马修 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        )\t\t \n  @xfkxfk 不恰当吧，仔细看看    \n     2013-07-29 17:56 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  为毛不弄哇嘎的- -    \n     2013-09-12 18:02 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  很好，非常好    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}