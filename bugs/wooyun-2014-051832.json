{"id": 58245, "wybug_id": "wooyun-2014-051832", "wybug_title": "Ecmall 2.3.0本地文件包含漏洞", "wybug_corp": "ShopEx", "wybug_author": "HackBraid", "wybug_date": "2014-02-24 10:56", "wybug_open_date": "2014-05-25 10:56", "wybug_type": "文件包含", "wybug_level": "低", "wybug_rank_0": "2", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核", "文件包含漏洞", "文件包含", "文件包含漏洞利用", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-04-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-25：\t细节向公众公开  简要描述： 文件包含，受到gpc和php版本限制 详细说明：  漏洞文件：admin/app/plugin.app.php思路来源于： WooYun: Ecmall 2.3 File Inclusion Vulnerability（鸡肋） \nfunction _get_plugin_info($id)    {        //id参数存在文件包含漏洞        $plugin_info_path = ROOT_PATH . '/external/plugins/' . $id . '/plugin.info.php';        return include($plugin_info_path);    }\n在后台的插件管理处，点击启用插件时，会调用admin/app/plugin.app.php的enable()函数：\nfunction enable()    {        $id = empty($_GET['id']) ? 0 : trim($_GET['id']);        if (!$id)        {            $this->show_warning('no_such_plugin');            return;        }        //此处调用上面的函数        $plugin_info = $this->_get_plugin_info($id);\n   漏洞证明：  1.点击启动插件：\n\n2.抓包修改参数id：\n\n3.这里我没实现，百度了下是php版本的问题，%00在低版本的php下是可以截断的，参照 WooYun: Ecmall 2.3 File Inclusion Vulnerability（鸡肋） 可以侧面证明漏洞成立   修复方案：  您懂！   版权声明：转载请注明来源 HackBraid@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2014-02-24 13:12 厂商回复： 非常感谢您为shopex信息安全做的贡献我们将尽快处理谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-02-24 11:10 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  膜拜，求瓜分奖励    \n     2014-02-24 11:24 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @寂寞的瘦子 一言难尽...    \n     2014-02-24 13:04 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @ShopEx 确认确认    \n     2014-02-27 14:27 |    \t\ttnt1200 \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:17        | 关注飞机安全....)\t\t \n  nice    \n     2014-02-27 14:29 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @tnt1200 no nice    \n     2014-07-13 00:17 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @HackBraid 为什么你这个漏洞不给钱的？    \n     2014-07-13 08:29 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @U神 这个漏洞我记得后来发现有全局过滤，误报    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}