{"id": 86412, "wybug_id": "wooyun-2016-0186967", "wybug_title": "众诚汽车保险股份有限公司命令执行漏洞影响核心业务系统/自主查询系统/续保系统", "wybug_corp": "众诚汽车保险股份有限公司", "wybug_author": "z_zz_zzz", "wybug_date": "2016-03-21 07:55", "wybug_open_date": "2016-05-06 10:09", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-06：\t细节向公众公开  简要描述： 众诚汽车保险股份有限公司（简称“众诚保险”，下同）经中国保监会批准，于2011年6月成立，是首家总部设在广州市的中资保险法人机构。公司注册资本为人民币五亿元，由广汽集团、粤财信托、粤科风投、广州长隆等发起创立。核心业务系统/自主查询系统/续保系统，存在命令执行漏洞，可内网渗透 详细说明：  先看下公网登录门户。http://zc.urtrust.com.cn/\n\n核心业务系统登录地址为https://zc.urtrust.com.cn:9093/casserver/login?service=http%3A%2F%2Fzc.urtrust.com.cn%3A9080%2Fprpall%2Findex.jsp\n\n存在JAVA反序列化漏洞，如下图。\n\n随便看看。\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n应用的目录在这里，可以上传jsp，没这样做。只访问了一下现有的文件验证一下。\n\n\n\n数据库信息如下-saa：数据库类型：\noracle\n数据库URL：\njdbc:oracle:thin:@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.193.61)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.193.60)(PORT=1521))(LOAD_BALANCE=yes)(FAILOVER=ON)(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=coreprd)))\n数据库用户名：\nsaauser\n数据库密码：\nsaauser\n数据库信息如下-cas：数据库类型：\noracle\n数据库URL：\njdbc:oracle:thin:@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.193.61)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.193.60)(PORT=1521))(LOAD_BALANCE=yes)(FAILOVER=ON)(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=coreprd)))\n数据库用户名：\nutic_busiapp\n数据库密码：\nWka9Ptd8\n数据库信息如下-platform：数据库类型：\noracle\n数据库URL：\njdbc:oracle:thin:@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.193.61)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.193.60)(PORT=1521))(LOAD_BALANCE=yes)(FAILOVER=ON)(CONNECT_DATA=(SERVER=DEDICATED)(SERVICE_NAME=coreprd)))\n数据库用户名：\nutic_busiapp\n数据库密码：\nWka9Ptd8\nSSL证书信息如下：SSL私钥别名：\nserver\nSSL私钥密码：\npassword\n密钥库：\n/u02/coreprd/coreapp/sso/serverstore\n密钥库密码：\npassword\n导出SSL私钥如下。\n\n有了SSL私钥，自己做下登录，用wireshark抓包，查看解密的数据。\n\n\n\n再来看看自主查询系统。http://zc.urtrust.com.cn:9095/netqry/\n\n自主查询系统和核心业务系统在同一台服务器，也存在JAVA反序列化漏洞。\n\n\n\n\n\n再来看看续保管理系统。https://zc.urtrust.com.cn:9093/casserver/login?service=http%3A%2F%2Fzc.urtrust.com.cn%3A9058%2FIRS%2Fworkspace%2Fsaa.do\n\n续保管理系统和核心业务系统在同一台服务器，也存在JAVA反序列化漏洞。\n\n\n\n   漏洞证明：  见详细说明。   修复方案：  可以参考：修复weblogic的JAVA反序列化漏洞的多种方法http://drops.wooyun.org/web/13470如何控制开放HTTPS服务的weblogic服务器http://drops.wooyun.org/web/13681   版权声明：转载请注明来源 z_zz_zzz@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2016-03-22 10:09 厂商回复： 谢谢提醒，已经开始处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-21 11:14 |    \t\tz_zz_zzz \t\t\t( 普通白帽子  |\t\t\t        Rank:249 漏洞数:28        | 诸恶莫作)\t\t \n  补充一下，众诚汽车保险股份有限公司IT问题管理系统，也存在相同的问题，在另一个漏洞提的，但是漏洞没通过审核，请厂商注意一下一并修复    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}