{"id": 17709, "wybug_id": "wooyun-2012-010165", "wybug_title": "百度某站任意评论删除&amp;某站跨域问题", "wybug_corp": "百度", "wybug_author": "cnrstar", "wybug_date": "2012-07-26 13:24", "wybug_open_date": "2012-09-09 13:25", "wybug_type": "系统/服务运维配置不当", "wybug_level": "低", "wybug_rank_0": "4", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-08-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-09-09：\t细节向公众公开  简要描述： 随便一个用户可以越权删除其他用户的二级评论还有一个跨域问题。 详细说明：  1.越权删除其他用户评论（获取reply_id很鸡肋）如http://s.baidu.com/comment/8364dabba8236a6c06e03d11这个评论，某人发表“回应”后会在上面显示，对应一个reply_id。\n\n攻击者用自己的账号登陆上去，随意在任意一个地方发表一个评论，然后点删除该评论，抓包，获取的POST数据包大致如下图：\n\n修改POST数据包的reply_id然后repeat\n\n在刷新一下发现原来的评论已经没了。\n\n2.corssdomain.xml配置失误http://qiao.baidu.com/crossdomain.xml全允许了   漏洞证明：  1. 如上所述，同学在另外的地方发表评论我在本地可以成功删除，就是那个reply_id不好搞到。结合其他方法吧，匿了半天就发现最后两位replyid是5f不变，然后往前是依次递减，任何一个人的评论都会递减。再之后就没规律了不过如果要是递归穷举，相信可以删除一坨评论的。2.http://qiao.baidu.com/crossdomain.xml   修复方案：  你懂的~   版权声明：转载请注明来源 cnrstar@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2012-07-27 19:35 厂商回复： 感谢您对百度安全的关注，我们尽快安排处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-26 14:57 |    \t\tFallenAngel \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 啊喔呃咿呜喻。。0.0)\t\t \n  我想知道怎么获得那个id呢？好像那个只有发布者本人能看到，发布之后别人是看不到的    \n     2012-07-26 14:58 |    \t\tFallenAngel \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 啊喔呃咿呜喻。。0.0)\t\t \n  @cnrstar    \n     2012-07-26 16:42 |    \t\tcnrstar \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:23        | Be my personal best!)\t\t \n  @FallenAngel 就是这个鸡肋了。逆了半天的HASH算法，没搞出来，只有一些小规律，24位的字符串最后四位有规律：最后两位不变，倒数第三位和倒数第四位递减。目测最后四位是salt,前面20位应该是用户名或者comment_id跟salt的一个hash，但是。。。但是没逆出来。。不过搞破坏可以递归进行不断删除。。    \n     2012-07-27 09:18 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  啊喔呃咿呜喻。。0.0    \n     2012-07-28 16:23 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  百度应用的吗？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}