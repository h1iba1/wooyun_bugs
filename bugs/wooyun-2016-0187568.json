{"id": 85790, "wybug_id": "wooyun-2016-0187568", "wybug_title": "51CTO之任意密码重置风险（各种组合综合利用）", "wybug_corp": "51CTO技术网站", "wybug_author": "js2012", "wybug_date": "2016-03-22 09:31", "wybug_open_date": "2016-03-27 09:40", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT 详细说明：  上次提交审核大大没给通过，说是精确的获取用户id是关键，今天又考虑了一下，还是给我找到了。。同样上次的流程再走一遍，用两个邮箱来说明：邮箱 1 --》获取三个重置密码的链接： URL 1\nhttp://ucenter.51cto.com/setemailpass.php?id=7804861&unid=7747d234f4b2b8cab3e55485f2884abc\n unid MD5 解密得：\n1458607665\n URL 2\nhttp://ucenter.51cto.com/setemailpass.php?id=7804861&unid=679c5b68bc1b974db24b3c2ca38660a4\n unid MD5 解密得：\n1458607794\n URL 3\nhttp://ucenter.51cto.com/setemailpass.php?id=7804861&unid=27b8a923b86dfba72b40673a7fbecc14\n unid MD5 解密得：\n1458607984\n邮箱 2 --》获取两个链接： URL 1\nhttp://ucenter.51cto.com/setemailpass.php?id=10007943&unid=fc0b2180ee91325e44e9782f5b79cad8\n unid MD5 解密得：\n1458608098\n URL 2\nhttp://ucenter.51cto.com/setemailpass.php?id=10007943&unid=cca1df879eec29c438ff2b3767769ef7\n unid MD5 解密得:\n1458608188\n那么这个时候就可一对比下解密后的uind，发现只有后四位不一样：\n\n那么这个时候我们就可以生成一个四位数字的字典，在每个前面加上145860，这个在一天之中不会变的常数，然后进行32位md5加密即可对unid进行爆破。好了unid的问题解决了，那么如何精确的获取用户的id呢？老师说上课打笔记是个好习惯，我在51CTO打笔记的时候发现，有个同学的笔记，当然重点不在笔记，而是用户的名字，我点开看了一下审查了一下元素，发现网页源代码中已经泄露了用胡的id参数：\n\n为了确定这个是用户的id值我用邮箱1 登录了一下，看了下确实和重置密码中的id值相同：\n\n那么现在万事具备了，为了不影响其他用户,我就拿邮箱2来重置了：首先拼接常数生成32为md5加密的字典：\n\n然后就是获取id值对unid进行爆破,：\n\n爆破成功：\n\n   漏洞证明：  \n\n\n\n   修复方案：  RT   版权声明：转载请注明来源 js2012@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-03-27 09:40 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-22 09:32 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:925 漏洞数:80        | 哈！躁起来！)\t\t \n  我只能说存在风险，想有效利用还有点难度，但思路不错    \n     2016-03-22 09:34 |    \t\tjs2012 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:39        | 闭关修炼。。。)\t\t \n  谢谢审核大大@ 浩天    \n     2016-03-22 10:12 |    \t\tsm0nk \t\t\t( 普通白帽子  |\t\t\t        Rank:174 漏洞数:30        | all is well)\t\t \n  6    \n     2016-03-22 10:33 |    \t\t土夫子 \t\t\t( 普通白帽子  |\t\t\t        Rank:467 漏洞数:82        | 看似山穷水尽，终将柳暗花明)\t\t \n  给我充值100000个下载豆    \n     2016-03-22 11:21 |    \t\t赵健康 \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:13        | 慢慢进步！！！)\t\t \n  持续关注    \n     2016-03-22 15:54 |    \t\t闰土。 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 做自己的英雄 - rainto .)\t\t \n  相关部门正在持续关注    \n     2016-03-22 16:42 |    \t\twater \t\t\t( 普通白帽子  |\t\t\t        Rank:379 漏洞数:110        | If you have one, then we have more than ...)\t\t \n  mark    \n     2016-03-27 09:47 |    \t\t酷帥王子 \t\t\t( 普通白帽子  |\t\t\t        Rank:256 漏洞数:69        | 天之屌，人之神！天人合一，乃屌神也！)\t\t \n  这个也是一个渗透思路嘛，虽然批量化的搞，但是假想如果你要指定搞的是FBI局长的耗子的话，那这个思路就有价值多了，所以嘛洞猪，思路不错，精神可嘉!支持你    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}