{"id": 84880, "wybug_id": "wooyun-2016-0170068", "wybug_title": "艺龙旅行网邮件订阅某功能越权", "wybug_corp": "艺龙旅行网", "wybug_author": "路人甲", "wybug_date": "2016-01-15 16:55", "wybug_open_date": "2016-02-27 11:49", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-27：\t细节向公众公开  简要描述： 邮件退订越权 详细说明：  艺龙旅行网的订阅邮件取消接口发送数据为：\nPOST /abo HTTP/1.1Host: s3s.frContent-Length: 57Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://t.news.elong.comUpgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.106 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://t.news.elong.com/abo4/6fWmlkmvy/freebuf.com/l%27itdg/11459169/51187991.htmlAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8,en;q=0.6,zh-TW;q=0.4,fr;q=0.2AlexaToolbar-ALX_NS_PH: AlexaToolbar/alxg-3.3lang=zh&envoi=6fWmlkmvy&domain=qq.com&user=§test§&raison=r1\n貌似使用了一个第三方的服务，所以这应该是一个通用性的问题。使用domain和user参数来定位用户邮箱，这个接口没有做限制，遍历user就可以退订所有用户的邮件通知订阅。   漏洞证明：  使用qq邮箱进行测试：\n\n\n\n只随机了两百个邮箱就命中多个用户。结合网上泄露的用户邮箱账号会对邮箱订阅业务可能造成影响。   修复方案：  接口验证   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2016-01-18 13:58 厂商回复： 感谢白帽子，第三方漏洞，已通知修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}