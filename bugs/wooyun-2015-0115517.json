{"id": 30872, "wybug_id": "wooyun-2015-0115517", "wybug_title": "真旅网某处持久性存储型XSS", "wybug_corp": "真旅网集团", "wybug_author": "孔卡", "wybug_date": "2015-05-22 17:22", "wybug_open_date": "2015-07-09 15:30", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "9", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向公众公开  简要描述： 看见大家伙提交的XSS都过了 我也耐心的挖了个试试看可通过不~~~~ 详细说明：  http://store.tdxinfo.com  主站的正常预定机票环节\n\n旅客姓名处存在XSS直接在网页插入代码的话，会提示不符合，但是抓包看看，发现没有发包验证（后台交互），所以很简单，在burp里截断改掉就可以了，然后forwarder，让post包正常发包，先不管此订单提交成功与否。\n\npassengername这里在名字后面加上\n</b><script>alert(1)</script>\n经测试，直接查看订单是无法执行的，但是可以确定是存储型，持久性XSS，下部分证明   漏洞证明：  OK，上面的操作进行完毕之后，回到正常流程，我们重新买机票，随便找一张，点预定，这时可以看到代码成功执行。\n\n\n\n 也可打cookie，不出意外，仍然是做过httponly的说的啰嗦了点，不清楚的话登录我的账号\nwuhaitongtong  woainiaa\n  直接上去预定机票，然后就可以看到效果了   修复方案：  这个不说了~~~   版权声明：转载请注明来源 孔卡@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-05-25 15:28 厂商回复： @孔卡 感谢您对我们系统安全加固做出的贡献。谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-22 19:07 |    \t\t孔卡 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:12        | 我已经过了那个餐桌上只有一条鸡腿就一定能...)\t\t \n  @真旅网集团 附送了一个小错误，估计一会审核过了后就会更新出来的，没奔着礼物来，就希望给多几个rank就OK，所以你不用有压力，嘿嘿    \n     2015-05-25 16:27 |    \t\t孔卡 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:12        | 我已经过了那个餐桌上只有一条鸡腿就一定能...)\t\t \n  @真旅网集团 良心厂商啊  真给高rank 。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}