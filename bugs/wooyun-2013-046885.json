{"id": 6166, "wybug_id": "wooyun-2013-046885", "wybug_title": "易佰连锁旅店漏洞（用户信息泄漏、订单信息泄漏）可查开房", "wybug_corp": "易佰连锁旅店", "wybug_author": "飞扬风", "wybug_date": "2013-12-24 16:54", "wybug_open_date": "2014-02-07 16:55", "wybug_type": "用户资料大量泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄漏", "住址身份证姓名等敏感信息"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-24：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-02-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 易佰连锁旅店一个目录权限不严格导致用户信息泄漏，订单信息泄漏 详细说明：  首先，出现问题的站点http://new.100inn.cc/目录遍历 \n\n 然后翻了翻，找到另一个站点 \n\n 过去看看，有一个目录遍历 \n\n 很轻松找到接口，可以查看订单信息，用户信息，等等等等~~~~~ \n\n \n\n   漏洞证明：  自己弄了个账号，拿个订单号\n\n拿去接口查一下，确实有信息\n\n订单号是8位日期+6位数字，6位数字基本上递增状态既然说没有办法遍历，那我就拿一段订单号来跑一下吧~~~选取20131224xxxxxx这里的1000个订单吧\n\n看结果，长度2122为不存在订单，大于2122就是有数据了\n\n给一个大于2122的结果吧\n\n最后构造的1000个订单号里面一共查到有数据的有572个有数据啊~~~\n\n最后，通过订单号里面的手机号或者邮箱，还可以通过接口查用户信息包括身份证号~~~\n\n   修复方案：  怎么说呢，权限这个很关键   版权声明：转载请注明来源 飞扬风@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-01-04 17:41 |    \t\t飞扬风 \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:125        | 追求安全，热爱技术)\t\t \n  厂商默默修复情何以堪~~    \n     2014-02-08 10:48 |    \t\t繁星点点 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 无)\t\t \n  无良的厂商啊~    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}