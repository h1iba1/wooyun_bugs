{"id": 11712, "wybug_id": "wooyun-2015-0119823", "wybug_title": "分期乐存储型XSS(已打后/大量敏感数据)", "wybug_corp": "fenqile.com", "wybug_author": "r3d0x8", "wybug_date": "2015-06-14 23:54", "wybug_open_date": "2015-07-30 10:18", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向公众公开  简要描述： 分期乐是一家专注于大学生分期购物的在线商城及金融服务提供商，提供分期购物和现金消费服务。对用户输入的数据过滤方式不正确，导致存储型XSS,且定向打管理cookie.能查看商城敏感数据。 详细说明：  1.漏洞处问题出现在http://zhaopin.fenqile.com/。\n\n点击图中的立即应聘.\n\n弹出填写的框，在此处学校一栏直接填入XSS code会被客户端直接提示出错，而不会提交。用Burp Suite拦截包，在学校一栏直接插入XSS code就绕过了。\n\n然后就提交成功了。2.危害在XSS平台收到cookie,成功登录后台。\n\n\n\n观察得知打到的是类似区域经理的cookie.不是网站最高权限，但也足够影响大量数据了。提交哪个区域就打哪个区域的经理。要想扩大战果，就多提交几个繁华地区的应聘。除了业务系统和hr系统有限制，其他都有权限进入。2.1 查看和删除、修改校园经理一级的详细资料包括他们的电话、身份证号、照片、身份证照片、银行卡号（有这些东西能做很多坏事了）。以及业务情况、收益。\n\n可添加代理。甚至全部冻结、删除他们的资料，这样一个区域的营销应该就混乱了。如果把校园经理的建行卡号换成我的，会不会打工资到我的卡上呢？2.2 查看购物平台交易情况、经营状态很多数据可看，可能作为商业秘密，为避免竞争对手知晓，我就全打码。\n\n\n\n从交易量上可以看出你们在飞速发展。查看本区域所有交易情况，隐藏了交易者资料，但查看右边的查看备注就能看到交易人的姓名和手机号了。什么？李同学，你准备贷款6000+买神舟！\n\n2.3 查看众多应聘者的资料罪魁祸首的地方，有很多应聘者资料包括姓名、手机、邮箱、大学名称，甚至详细的简历单。越繁华的地方应聘者越多。\n\n   漏洞证明：  后台\n\n各种数据\n\n\n\n   修复方案：  贵商场尚未进入乌云平台，作为涉及金额交易的购物企业，安全方面的投资是重要的资产，遇到安全问题是迟早的事，建议你们正视乌云白帽子提交的漏洞，赶快在乌云注册个帐号，不要忽略了哦！技术问题你们比我更懂！   版权声明：转载请注明来源 r3d0x8@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-06-15 10:17 厂商回复： 感谢关注分期乐平台安全，已做修复处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-11 23:28 |    \t\tr3d0x8 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:3        | 1、曾经梦想成为大牛，几年了，我却还是个...)\t\t \n  通过持续收集到的cookie，已得到业务系统和hr系统权限。泄漏公司组织架构和大量员工信息。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}