{"id": 15237, "wybug_id": "wooyun-2013-016928", "wybug_title": "中国公云网(3322.org)商用户资料大量泄漏", "wybug_corp": "中国公云", "wybug_author": "李白", "wybug_date": "2013-01-06 18:59", "wybug_open_date": "2013-01-08 22:54", "wybug_type": "用户资料大量泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户大量信息泄漏", "公云"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-08：\t厂商提前公开漏洞，细节向公众公开  简要描述： 中国公云你懂的，www.3322.org 当公云的数据也云了起来……用户资料在QQ群中流传，亲自测试，发现果然存在一定安全事件这次大量泄漏，真的是大量大量大量。。 详细说明：  用户资料在QQ群中流传，亲自测试，发现果然存在一定安全事件\n\n虽然上传才仅仅5天，就有21次下载，那如果继续传播呢？后果不堪设想是不是。关于利用：\n虽然这份数据有些陈旧，但是，我抽样10份中仍有2份是今天（注意是今天）更新过，最近的有2份，哪怕域名不利用，里面的身份证信息、电话号码也是十分值得利用，拿这个发诈骗短信，谁还不信？\n   漏洞证明：  The first，我们来看一下数目\n\n7609页.....我们按字数来算10字为一条，也就是说有1973341/10为一条，我们当他有的密码长一点吧，那就20字一条，那也有1973341/20=98667条，我们再算5条里有两条不准确的，那么就是98667/5*3=59200条....而众所周知，公云作为网商，里面的资料都是准确的（后面会证明）各种身份证，各种电话号码，各种域名，这让我们情何以堪？The second 资料准确性抽样1：\n\n抽样2：\n\n抽样3：\n\n抽样4：\n\n整体：\n\n我们抽样其中一条进行剖析：05/05/2011 - 12:51:59\t61.160.235.203\t110.87.161.122\tlinsheng5188\t692064\t61.160.235.203\t\t\tBasic (GET)\t\n日期时间不解释，第一个IP来自江苏省电信，经查证后为3322.org解析之后的IP，后面那个IP来自福建省福州市，且第二个IP在信息表内经常变动，可推测出此是此用户者的IP，后面分别是账号密码，又出现一个3322.org的IP。Basic是编程语言，（get）是得到。此时分为两种可能，一种是当时被劫持了，一种是钓鱼。我们结合多条信息（整体）一起分析，发现在信息都来自同一天的，且相距时间不超过4小时，由此我们可以推断出，在2011年5月5日，3322.org曾经发生过劫持，导致一时间登录的用户资料被获取后记录，导致非常庞大的用户资料泄露\n   修复方案：  愿意提供此份数据如此庞大的数据量。建议首先阻断本数据的流通情况然后该提醒的提醒，该删除的删除。李白想说，既然如此庞大的用户数，我们不妨可以首先同意屏蔽掉登录后的个人信息界面，马赛克掉身份证信息还有电话信息，再慢慢调查。Good lucy for you！   版权声明：转载请注明来源 李白@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-01-07 11:02 厂商回复： 这个问题，是用户的密码，被嗅探器嗅探了 最新状态： 2013-01-08：我们以前在一个机房，同一网段有其他用户的 windows机器，互相没有划分vlan。他们的机器被中招过几次，然后发起arp攻击，抢夺网关，导致整个网段都不能上网。当时以为就是仅仅这个问题，后来发觉有两台windows机器被装了嗅探器，导致我们的linux机器被嗅探。2012.8.20 ，我们搬迁的新的机房，网络上我们完全独立，就不存在这个问题了。目前，我们对所有的老用户，都必须重新密码加固（使用注册邮箱重新获取密码）才能登录。 2013-01-08：谢谢李白的漏洞报告。但是：1、这个不是脱库2、文中提到“Basic是编程语言，（get）是得到”, 这个有误的。basic 这里是 http 的一种认证方式，对用户名和密码进行简单的编码。GET 是 http的方法  ", "replys": "漏洞评价：\n评论\n     2013-01-05 16:29 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  3322被微软查了水表，没人敢用了吧。    \n     2013-01-06 01:15 |    \t\t双人份 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | 打发点咯)\t\t \n  这也算。。    \n     2013-01-06 19:44 |    \t\t李白 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:29        )\t\t \n  @双人份 我会说这份东西起码有59200个人的身份信息么    \n     2013-01-06 20:31 |    \t\t双人份 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | 打发点咯)\t\t \n  @李白 大概有20.2m    \n     2013-01-06 20:55 |    \t\tSn0wLe0p4rd \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:11        | 童言无忌)\t\t \n  3322的裤子早就流传过了    \n     2013-01-06 21:25 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:31        | Hacked by @ringzero 我錯了)\t\t \n  我看见至少1000W肉鸡。。。（两眼发光）    \n     2013-01-06 21:30 |    \t\t李白 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:29        )\t\t \n  @erevus 何止啊....哈哈。。不过转IP是件非常累的事情。。    \n     2013-01-06 22:32 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:31        | Hacked by @ringzero 我錯了)\t\t \n  送我1两千只玩玩呗    \n     2013-01-06 22:37 |    \t\t李白 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:29        )\t\t \n  @erevus 等漏洞公开吧，哥有职业操守，哈哈。。。    \n     2013-01-07 11:04 |    \t\t中国公云(乌云厂商)\t\t \n  @李白, 我是厂商，请联系我: ppyy@pubyun.com    \n     2013-01-07 11:22 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @中国公云 这个是怎么被嗅探到的啊    \n     2013-01-07 14:51 |    \t\t李白 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:29        )\t\t \n  @中国公云 好的，下午联系。之前嗅探不给过...估计太短了.于是我就发钓鱼劫持了。    \n     2013-01-07 15:01 |    \t\t陈再胜 \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:13        | 微博收收听~~~●﹏●)\t\t \n  唉，这个也算漏洞？    \n     2013-01-07 16:45 |    \t\t李白 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:29        )\t\t \n  @陈再胜 属于安全事件亲。    \n     2013-01-07 16:54 |    \t\t陈再胜 \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:13        | 微博收收听~~~●﹏●)\t\t \n  @李白 我知道裤子的来源·········    \n     2013-01-07 16:59 |    \t\t李白 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:29        )\t\t \n  @陈再胜 绝对不是自产自销就对了，哈哈。。。    \n     2013-01-09 00:12 |    \t\t李白 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:29        )\t\t \n  嘿嘿，学习了，不得不说3322是我目前在乌云里看到最好最负责的厂商    \n     2013-01-09 00:28 |    \t\t西毒 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:33        | 心存谦卑才能不断超越自我)\t\t \n  我只能说楼主蛋疼....他这个3322泄露，网上早有了    \n     2013-01-09 00:29 |    \t\t西毒 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:33        | 心存谦卑才能不断超越自我)\t\t \n  几年前用3322抓鸡黑客一把一把的，当年我都用过    \n     2013-01-09 09:12 |    \t\thack2012 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:3        | 关注信息安全 http://www.waitalone.cn/)\t\t \n  厂商回复比较详细。3322不怎么用。。    \n     2013-01-09 13:34 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:31        | Hacked by @ringzero 我錯了)\t\t \n  求库下载地址。。。我要肉鸡。。。。0.0    \n     2013-01-09 14:12 |    \t\t灵惜 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:2        | 哇咔咔，搞定它)\t\t \n  尼X，我不是暴露狂，只因为衣服是透明的    \n     2013-01-09 21:01 |    \t\tby_奇奇 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:7        | 2)\t\t \n  老库了  ‎2011‎年‎5‎月‎6‎日 ‎星期五，‏‎15:34:32    \n     2013-03-05 20:08 |    \t\tForsaken \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:2        | 低调做事  低调做人 高调学习)\t\t \n  @李白 求裤子 994574511@qq.com    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}