{"id": 46925, "wybug_id": "wooyun-2014-088845", "wybug_title": "sohu某站上传过滤不严导致可劫持他人账号进行敏感操作", "wybug_corp": "搜狐", "wybug_author": "0x_Jin", "wybug_date": "2014-12-26 21:36", "wybug_open_date": "2015-02-09 21:38", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传内容未检查", "文件上传", "跨域"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-09：\t细节向公众公开  简要描述： 一步两步似爪牙 似魔鬼的步伐 详细说明：  问题出在mp.sohu.com 在发表文章的正文处可上传图片，但是没有对上传的内容做限制，导致可以上传任意内容的图片，于是便上传了一个swf内容的jpg图片。上传后的图片又是位于网站同域，并且任何人都能浏览这个图片，这样一切要求都满足了 那么就有了这个漏洞。图片地址：http://mp.sohu.com/imgview2/20141226/b03956fd3491467ebbb7ba8ef988d9e4.jpg劫持页面：http://jsbin.com/sefenepomi当mp.sohu.com的会话还存在时 打开这个页面首先会去http://mp.sohu.com/main/ad/view.action 获得到token值，获得到token值后，便会使用POST请求 来发表一篇文章。token:\n\n除了发文章外，几乎mp.sohu.com的所有需要token值的操作都能做。具体请看视频演示：http://km3.pw/Sohu%20Flash%20CORS.mp4   漏洞证明：  问题出在mp.sohu.com 在发表文章的正文处可上传图片，但是没有对上传的内容做限制，导致可以上传任意内容的图片，于是便上传了一个swf内容的jpg图片。上传后的图片又是位于网站同域，并且任何人都能浏览这个图片，这样一切要求都满足了 那么就有了这个漏洞。图片地址：http://mp.sohu.com/imgview2/20141226/b03956fd3491467ebbb7ba8ef988d9e4.jpg劫持页面：http://jsbin.com/sefenepomi当mp.sohu.com的会话还存在时 打开这个页面首先会去http://mp.sohu.com/main/ad/view.action 获得到token值，获得到token值后，便会使用POST请求 来发表一篇文章。token:\n\n除了发文章外，几乎mp.sohu.com的所有需要token值的操作都能做。具体请看视频演示：http://km3.pw/Sohu%20Flash%20CORS.mp4   修复方案：  对上传文件的内容进行限制上传的文件尽量不跟重要业务放在一个域   版权声明：转载请注明来源 0x_Jin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-12-29 13:54 厂商回复： 感谢对sohu安全的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-26 21:44 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  摩擦摩擦    \n     2014-12-26 22:00 |    \t\t0x_Jin \t\t\t( 普通白帽子  |\t\t\t        Rank:319 漏洞数:37        | 微博：http://weibo.com/J1n9999)\t\t \n  @子非海绵宝宝 似爪牙 似魔鬼的步伐    \n     2014-12-26 22:14 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  @0x_Jin 一步两步 一步两步    \n     2014-12-26 23:46 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:61        | 工作需要，暂别一段时间)\t\t \n  你们在对什么暗语么。。。。一派西山千古秀    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}