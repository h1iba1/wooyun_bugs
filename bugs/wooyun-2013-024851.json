{"id": 10219, "wybug_id": "wooyun-2013-024851", "wybug_title": "陕西电信虚拟ADSL服务器/客户端多处漏洞", "wybug_corp": "陕西电信", "wybug_author": "godfrey", "wybug_date": "2013-05-31 11:51", "wybug_open_date": "2013-08-29 11:52", "wybug_type": "非授权访问/认证绕过", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-07：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-07-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向公众公开  简要描述： 客户端接受任意IP发送指令服务器认证绕过，及任意IP任意利用他人认证信息认证 详细说明：  客户端部分：默认监听1812端口，用于接受服务器指令，但是并未对指令来源IP作审核，导致任意主机对该端口发送的指令均被接受。指令包括接收消息、强制下线等。服务器部分：1、服务器端上线/下线认证采用的是IP地址和帐号密码绑定认证，但是由于这些信息均在IP层以上，导致任意IP用户可以发送相同的认证信息至服务器端，而服务器端并没有检测机制，导致任意IP用户可使用他人认证信息通过认证或迫使他人下线；2、服务器认证通过后，相应的网关并不检测用户IP来源是否正确，导致任意用户可利用认证服务器返回的IP/网关IP地址对通过网关正常联网，即认证服务器认证部分可以绕过。   漏洞证明：  我写了个虚拟ADSL Linux ToolSet(http://code.google.com/p/vadsl)，其中包含客户端功能，另有vadsl_msg功能可对任意已监听1812端口用户发送消息，强制下线功能并未包含在当前版本中。有关认证绕过演示视频在此处下载：https://code.google.com/p/vadsl/downloads/list观看密码：1812   修复方案：  客户端部分：增加IP过滤功能，只接受来自认证服务器的指令。另外，希望能够公开虚拟ADSL所用指令，尊重用户。服务器部分：认证功能增加IP包来源IP检测功能，网关处理数据包时检测来源IP与GRE中IP是否一致。   版权声明：转载请注明来源 godfrey@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2013-06-04 23:02 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-17 09:26 |    \t\t核攻击 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:7        | 统治全球，奴役全人类！毁灭任何胆敢阻拦的...)\t\t \n  无人关注？    \n     2013-07-17 10:40 |    \t\tcircus \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:4        | 你会为一件事去说一句话,也会为一句话去干...)\t\t \n  @核攻击 这个案例不错    \n     2013-08-02 08:52 |    \t\tgodfrey \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:1        | 暂时没有介绍)\t\t \n  这都俩月了怎么还不公开？    \n     2013-08-29 12:00 |    \t\tLee Swagger \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:5        | 洗洗睡吧)\t\t \n  @godfrey 洞主QQ 多少  私聊下    \n     2013-09-12 08:39 |    \t\tgodfrey \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:1        | 暂时没有介绍)\t\t \n  @Lee Swagger 私聊还在这回复。。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}