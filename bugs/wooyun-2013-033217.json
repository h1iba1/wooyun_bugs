{"id": 9635, "wybug_id": "wooyun-2013-033217", "wybug_title": "海底捞某重要系统权限绕过，导致员工信息泄露+短信轰炸员工", "wybug_corp": "haidilao.com", "wybug_author": "godlong", "wybug_date": "2013-08-02 09:09", "wybug_open_date": "2013-09-16 09:10", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-16：\t细节向公众公开  简要描述： -----------------------------ps:看你们今天提交这么多海底捞的洞，我也谷歌了个凑个热闹啊！同样求火锅！！领导说你们海底捞火锅非常不错~-----------------------------海底捞某重要系统权限绕过，导致全国分店员工信息泄露+短信轰炸员工不是不可能！挖墙脚不是不可能！分析进货数据和招聘短信更是对企业伤害很大！总之，这个资料不能落到竞争对手手上哦！^_^最后，求火锅！ 详细说明：  1.目录遍历，这个漏洞配合源码，可以访问任意敏感信息了。比如短信内容，很多xls，以及很多员工以及管理层的手机号码。http://message.haidilao.com/manage/personalmgr/sys_account_total.aspx 此页面未授权即可访问，虽然没什么攻击性。访问：http://message.haidilao.com/Template/UpFiles/ 里面存的都是群发短信信息，如果被竞争对手获取恐怕不利啊！如下图。\n\n更多的就不截图了，你们自己知道就好！2.cookie伪造欺骗进入后台通过伪造cookie，方法如下图，可以完全获取admin（超级管理员）权限进入后台，配置整个系统，并通过通讯录可以给几千人群发短信，轰炸也行，要是被人恶意利用，群发不良信息给员工那是非常可怕的！\n\n包括以往发出的短信记录，如果被竞争对手得到，分析你们的进货记录，人事招聘记录，那么后果更加严重！\n\n短信账户余额4w多。\n\n\n\n这个就是泄露的员工资料了，竞争对手挖墙脚必备啊！有木有啊！海底捞要注意信息安全的保护，虽然你们的员工很优秀！\n\n\n\n传个txt，到了第一次说的目录下面了，不过后台还好没发现注入点和有价值的上传点，暂时没法getshell。\n\n这种没有getshell的危害也是很严重的。请海底捞重视！   漏洞证明：  证明如说明！   修复方案：  1.使用session验证，而不能单单靠cookie去判断一个用户，一切本地都是不可信任的，都是可以伪造的2.高权限用户，如admin，应该限制ip访问啊！3.涉及到管理权限的目录，比如/manage/目录也应该限制ip访问。4.不过这真不是你们的错，稍后我提交个给软件提供商北京亿美软通科技有限公司,这属于通用性软件漏洞了吧！你们赶紧先修复吧！如果在源码上修复遇到问题请联系软件提供商，顺便请他们来乌云认领下这套系统的漏洞吧：）   版权声明：转载请注明来源 godlong@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-08-02 09:57 厂商回复： 非常感谢您提报的漏洞，我方正在努力修复该漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-02 09:51 |    \t\tO.o \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:12        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  朋友看上一海底捞妹纸。你说我是去看看呢还是去看看呢还是继续社呢？    \n     2013-08-02 10:05 |    \t\tgodlong \t\t\t( 实习白帽子  |\t\t\t        Rank:68 漏洞数:7        | 戴着白色帽子的白帽子...)\t\t \n  @O.o 社啥，直接追啊。一般说朋友就是说自己！所以你赶紧追吧！把妹子照片名字发我我给你查手机号：）祝你一臂之力！    \n     2013-08-02 11:27 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @O.o 是服务员么？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}