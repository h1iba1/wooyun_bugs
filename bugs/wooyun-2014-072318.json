{"id": 52096, "wybug_id": "wooyun-2014-072318", "wybug_title": "吉林省某市电费查询系统存在上传漏洞和文件权限设置不严等漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "cf_hb", "wybug_date": "2014-08-14 10:54", "wybug_open_date": "2014-09-28 10:56", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["补丁不及时", "文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-28：\t细节向公众公开  简要描述： 该系统存在多种漏洞，包括后台目录及文件夹能直接访问，上传文件类型绕过,服务器web应用存在Struts2漏洞.可被综合利用拿下服务器权限，盗取用户资料信息。 详细说明：  问题厂商：吉林省四平市  问题系统URL： http://202.98.7.155/ 存在struts2漏洞的web应用：http://202.98.7.155:9999/\n\n\n\n后代目录及各种敏感文件截图：\n\n\n\n上传点拿shell过程:修改Content-type: 为jpeg图片type进行欺骗\n\n成功上传：\n\n菜刀连上shell:\n\n得到数据库数据：\n\n\n\nweb应用:交通违章短信定制平台漏洞证明利用URL：http://202.98.7.155:9999/login.action\n\n查看进程\n\n查看端口：\n\n测试发现可以添加管理员账号：\n\n想看看能不能登进去夸大危害等级，搞了下不知怎么登不上。最后把添加的测试管理员账号删除了的！\n\n测试上传的shell为文件：http://202.98.7.155/inc/upload/1407951979.php 麻烦管理修复时记得删除！服务器上有sql server mysql oracle数据库 如果拿下服务器权限可能会泄露更多的数据吧！唉，可惜不善提权，只能这样了！！   漏洞证明：  参见上面！   修复方案：  1. 升级struts2版本2. 禁止浏览器直接访问database  USER 等后台文件及页面   版权声明：转载请注明来源 cf_hb@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-08-18 22:13 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给吉林分中心，由其后续协调网站管理单位处置。按通用软件漏洞和信息泄露风险评分，rank 13 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}