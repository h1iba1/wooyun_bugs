{"id": 48142, "wybug_id": "wooyun-2014-089426", "wybug_title": "可能是一种通杀的waf bypass方式（安全狗实例）", "wybug_corp": "安全狗", "wybug_author": "MayIKissYou", "wybug_date": "2014-12-31 10:52", "wybug_open_date": "2015-01-05 10:54", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 由于某些字符处理不好，可能导致所有的waf bypass。 详细说明：  ps.这种类型厂商不知道提给谁，提给wooyun不被X吧1：一般所有的waf在做sql防注入的时候都会对sql注入的union注入方式防的死死的，大致模型是这样的：\nselect id from table where x = 1 union select 1,2 from dual\n各家对于此处的防范各有不同，但是防范的都很好。2：在mysql里面有一个空白符为%a0,此符号为空白符。3：但是%a0是扩展字符里面的，当%a0+另外一个字符，可能会在web层面解析的时候出现意想不到的结果。4：手上有安全狗，拿安全狗测试了，首先关闭安全狗的服务，我们在url中输入以下url：\nhttp://192.168.4.70/low.php?id=11' union%a0select version(),database() %23&Submit=a\n首先我的id是一个字符类型注入的参数，此时我们去看下页面返回的结果\n\n发现结果中出现了乱码，感觉我的%a0和s一起被解析成了乱码。但是在mysql层面去执行的时候%0a又被当做空白符执行了，显示出来了我的mysql的版本和数据库名称，感觉碉堡了。5：这样一来解析出来的结果岂不是bypass掉了无论是waf也好，还是应用程序本身的正则也好。6：我们开启安全狗试试，先输入%0a查看安全是不是好使的：\n\n果然拦截了7：此时将%0a换成%0a尝试一下：\n\n可以看到安全狗没有反应，显示出来了数据库的信息，因此看来至少可以搞定狗了，这样的web解析感觉其他的waf很有可能也会有类似的问题。ps.会不会被雷p啊   漏洞证明：  7：此时将%0a换成%0a尝试一下：\n\n   修复方案：  看着修吧   版权声明：转载请注明来源 MayIKissYou@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-01-05 10:54 厂商回复：  最新状态： 2015-01-21：不好意思，没有及时回复，确实有这个问题，近期会修复更新  ", "replys": "漏洞评价：\n评论\n     2014-12-31 11:01 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  洞主，有个好帖在给你分享下 http://zone.wooyun.org/content/16772    \n     2014-12-31 11:08 |    \t\tMayIKissYou \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:33        | 勿忘初心)\t\t \n  @疯狗 貌似这个点利用的是mysql和webserver两边解码不一样导致的    \n     2014-12-31 11:12 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  好思路终于分享    \n     2014-12-31 11:29 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  学习～    \n     2014-12-31 12:01 |    \t\tD_in \t\t\t( 普通白帽子  |\t\t\t        Rank:413 漏洞数:62        | 到我嘴里来)\t\t \n  学习    \n     2014-12-31 13:07 |    \t\t小包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:100 漏洞数:19        | 关注技术与网络安全)\t\t \n  劈了！    \n     2014-12-31 13:18 |    \t\tbacktrack丶yao \t\t\t( 普通白帽子  |\t\t\t        Rank:290 漏洞数:107        | \"><img src=x onerror=alert(666666);> <im...)\t\t \n  学习了    \n     2014-12-31 14:11 |    \t\t黑吃黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:29        | 倚楼听风雨，淡看江湖路...)\t\t \n  @疯狗 狗哥什么情况？    \n     2014-12-31 20:46 |    \t\tMayIKissYou \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:33        | 勿忘初心)\t\t \n  这里面有个知识点我理解错了，SB了，但是不影响结果!(听说我屌丝的在这发一下，你们关注的都会收到)各位新年快乐    \n     2015-01-06 11:41 |    \t\tisno \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:3        | test)\t\t \n  貌似只有linux下的mysql才认a0，我试了win下不认a0啊    \n     2015-01-06 12:18 |    \t\tMayIKissYou \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:33        | 勿忘初心)\t\t \n  @isno = =我是windows下测试的 wamp    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}