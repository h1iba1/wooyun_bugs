{"id": 57173, "wybug_id": "wooyun-2014-055133", "wybug_title": "Fengcms SQL injection &amp; 读取任意文件漏洞", "wybug_corp": "fengcms.com", "wybug_author": "catchermana", "wybug_date": "2014-07-01 16:27", "wybug_open_date": "2014-09-29 18:06", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["读取任意文件"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向公众公开  简要描述： Fengcms SQL injection & 读任意文件 & XSS。 详细说明：  \nSearchcontrol 中。      if(!empty($_POST)){                 if(URL_TYPE==1){                echo '<meta http-equiv=\"refresh\" content=\"0;url='.(($_POST['project'])?'?controller=search&project='.$_POST['project'].'&tags='.$_POST['tags']:'/tags/'.$_POST['tags'].'.html').'\">';                   }else{                      echo '<meta http-equiv=\"refresh\" content=\"0;url=?controller=search'.(($_POST['project'])?'&project='.$_POST['project'].'&tags='.$_POST['tags']:'&tags='.$_POST['tags']).'.html\">';                 }           }else{ 直接输出了 $_POST[‘tags’] 可以反射xss了。\n\n在downcontrol 中 $_GET['file']=base64_decode($_GET['file']);           if(file_exists(ROOT_PATH.$_GET['file'])){                             header(\"Content-Type: application/force-download\");                 header(\"Content-Disposition: attachment; filename=\".basename($_GET['file']));                 readfile(ROOT_PATH.$_GET['file']);           }else{                 echo '<script type=\"text/javascript\">alert(\"您要下载的文件不存在！\");history.back();</script>';           }      }}\n   漏洞证明：  \n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 catchermana@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-07-01 16:40 厂商回复： 非常感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-02 22:46 |    \t\t老黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:161 漏洞数:61        | 最爱红颜不老。)\t\t \n  base64额。。    \n     2014-07-03 13:06 |    \t\t0dmxy \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:1        )\t\t \n  应该是downController那个，，file=Y29uZmlnLnBocA==    \n     2014-07-05 22:32 |    \t\tcatchermana \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 专注代码审计，专注逆向分析，专注渗透测试)\t\t \n  0.0    \n     2014-07-08 12:38 |    \t\tFengCMS(乌云厂商)\t\t \n  FengCms安全测试站地址：http://guf521656.h163.92hezu.org/ 有效期2014-7-8至2014-7-15 欢迎各位安全界的朋友帮我们寻找安全漏洞！作为一个小小的创业团队，对各位朋友对FengCms的关注表示衷心的感谢！    \n     2014-07-10 16:24 |    \t\tFengCMS(乌云厂商)\t\t \n  非常感谢各位白帽子的辛勤工作！FengCms安全测试站地址：http://guf521656.h163.92hezu.org/ 已经升级到最新版本 有效期2014-7-8至2014-7-15 欢迎各位安全界的朋友帮我们寻找安全漏洞！作为一个小小的创业团队，对各位朋友对FengCms的关注表示衷心的感谢！@catchermana    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}