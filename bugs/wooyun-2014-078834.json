{"id": 682, "wybug_id": "wooyun-2014-078834", "wybug_title": "首都经贸大学信息系统注入可查看所有人信息(照片，手机，父母工作单位）", "wybug_corp": "首都经贸大学", "wybug_author": "丸子哥", "wybug_date": "2014-10-10 15:16", "wybug_open_date": "2014-10-15 15:18", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-15：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 年久失修的某校园信息管理平台注入点在登陆页面，获得管理账号权限，可查可改学生信息，可发短信，可注册新生。 详细说明：  \n\n在教务处右侧侧栏找到信息管理系统点击进入。\n\n看到登陆界面，随便填写，抓包保存在log里。\n\n这是包内容。\n\nsqlmap注入检查，只检查了一个参数，因为我之前试过了。\n\n爆出current-db，user权限不高。\n\n\n\n\n\n继续爆表爆列爆内容。名称都是写的拼音，除了user一看就知道是用户。\n\n回到前台登陆，可以看到菜单。那么问题来了，为什么我扫描到菜单上的时候下拉菜单出不来？好像是浏览器兼容的问题，可是js应该不存在兼容问题吧，这个问题希望了解的朋友留言告诉我一下。反正我是mac所以没有IE，只能看源码，找到地址在复制在浏览器地址栏里。功能很多，不同账号功能也不尽相同，就捡重要的说了。（超级管理员的账号停用了，在另一个表里，爆出来登陆不了。）\n\n学生信息查询吧。查询的功能还挺强大，我没试，但估计这里也是有很多注入点的就不说了。\n\n查完了是这样的，给了一个iframe我这浏览器和兼容不好显示怪怪的，但是没关系，点击详细信息仔细看。\n\n这就是详细信息的界面，可以看到很多重要的信息都暴露出来了。非常的不好。\n\n更加意料之内的是，虽然这些界面都检查了权限，但是照片的链接却没有检察权限，而且照片的名字是学号。前面的文件夹名字盖掉了，反正也是一下就能找到规律的。这样就提供了一个链接可以根据学生id找到照片的地址，真是非常不好。脑洞：剩下的功能包括可以改信息（配合有xss漏洞的教务系统），如果同步这个信息到教务系统（数据库可能是分开的，但是按照信息实时更新的程度，估计是要同步的）。还可以注册新生只不过注册新生是有日期限制的现在试不了这个功能，如果注册的时候上传webshell（更改信息时候不能改照片，注册时候应该有），结合上面看到的IIS解析漏洞，应该可以拿到webshell。还有可以利用发信息功能，进行诈骗尤其是向家长什么的。。。脑洞是不是太大了。其实我也是由于了很久要不要来报这个洞，因为我觉得，学校是不会回应修改的，而我把信息发出来，万一被坏人利用到了，我觉得我也是间接的帮凶了。所以如果管理员看到的话，如果学校没有回应，就把涉及到的图片都删掉吧，链接啊，学校名称啊，包括我log起的名字都是学校的简写。我只是为了要一个邀请码，来向大家学习的。谢谢！   漏洞证明：  证明都写在上面了。看图吧。都是证明。   修复方案：  过滤输入，还有检测照片权限。唉。说了也白说，估计没人去改这个破系统。   版权声明：转载请注明来源 丸子哥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-10-15 15:18 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-10 15:18 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  父母工作单位。。    \n     2014-10-10 16:14 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  .... 我突然想起了，留学生诈骗....    \n     2014-10-15 16:03 |    \t\tjustforfun \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:4        | 纯爱好。。。求各种猥琐淫荡思路)\t\t \n  洞主叫佟天齐么？小心查水表    \n     2014-10-15 18:40 |    \t\tTwoEyes \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:28        | 你看到我的小熊了吗)\t\t \n  我第一个想到的也是那个人人标签-_-#，ps要包装好自己    \n     2014-10-16 08:16 |    \t\tf1eecy \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | 图书管理员~)\t\t \n  楼上&楼上的楼上，me too，洞主是故意的么    \n     2014-10-16 09:26 |    \t\t海绵君 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        )\t\t \n  齐齐你好    \n     2014-10-16 10:32 |    \t\t大老赵 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 希望和大家一同学习交流)\t\t \n  佟天齐，警察叔叔喊你去派出所喝茶    \n     2014-10-20 09:52 |    \t\t丸子哥 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 我是来膜拜大家的)\t\t \n  情理之中意料之外啊，学校没回应，漏洞还是公开了，不开心。管理员没看到我说，如果没回应就删一下内容么。看来我要自己去帮助他们修复漏洞了~感觉本来是想帮他们干件好事，却干成了坏事。p.s. 楼上给位轻黑啊。警察叔叔传唤我，应该不报销回国的机票吧~    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}