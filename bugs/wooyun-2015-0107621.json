{"id": 17256, "wybug_id": "wooyun-2015-0107621", "wybug_title": "穿透金山毒霸 2011 / 2012 / 2013 / 2014 / 2015 自保护(附POC)", "wybug_corp": "金山毒霸", "wybug_author": "路人甲", "wybug_date": "2015-04-14 17:05", "wybug_open_date": "2015-07-15 13:54", "wybug_type": "非授权访问/认证绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "客户端程序设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-19：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-15：\t细节向公众公开  简要描述： 在金山毒霸全防御开启时可以将其完全结束并删除。 详细说明：  在金山毒霸 2015、Windows XP SP3 下测试通过，原理上适用于 2011 至今所有版本。如果是全新安装的金山毒霸，需要先重启一次，可能是路径判断的某种 Bug。需要存在本地网络连接。把毒霸安装目录加入网络共享，再把任意文件移动到这个网络共享然后这时候毒霸的文件保护有漏洞，没有拦截 UNC 目录的文件移动操作这时候再从正常路径访问这个被移动进去的文件，就触发了毒霸在进程保护方面的另一个漏洞，也就是只要从安装目录启动的程序都默认信任于是利用这个漏洞从安装目录启动的 taskkill.exe 就可以任意结束毒霸的进程，从安装目录启动的 cmd.exe 也可以任意删除毒霸的文件了   漏洞证明：  未正确判断 UNC 路径，导致绕过文件保护。未正确判断可信进程，导致绕过进程保护。附测试代码。   修复方案：  正确判断 UNC 路径。正确判断可信进程。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2015-04-16 13:53 厂商回复： 需要一定的特殊处理才可以实现，影响较为有限，我们已经在处理，谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-14 17:13 |    \t\tblast \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:57        | 五仁委员会)\t\t \n  膜拜    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}