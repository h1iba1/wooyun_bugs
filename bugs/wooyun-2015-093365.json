{"id": 45942, "wybug_id": "wooyun-2015-093365", "wybug_title": "益盟爱炒股商城支付逻辑漏洞", "wybug_corp": "益盟爱炒股", "wybug_author": "无痕", "wybug_date": "2015-01-22 17:29", "wybug_open_date": "2015-03-08 17:30", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "支付"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-22：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-03-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 测试发现益盟爱炒股商城可以1元购买所有商品。 详细说明：  今天无意间进入益盟爱炒股商城页面，想起来之前在乌云看过好多商城都有漏洞就想这个有没有呢。就进行了下面一系列测试，结果发现还真有，希望官方尽快修复，并希望乌云能送个邀请码。emoney.cn   漏洞证明：  进入商品页面看到商品价格购物页面，发现价格为588\n\n下个订单\n\n先检测是否过滤了小数，如果没过滤的话把购买数量变成小数价格自然会变\n\n\n\n提交订单，发现提交不成功，估计后台已经过滤过数字了。\n\n同理修改了下网页代码里面的价格，发现提交后价格还是588元。难道这样说就没漏洞了么？不尽然，接着抓包看看。\n\n发现价格和数量是在提交的cookie里面，而且竟然是明文显示，那么不管三七二十一修改下价格看看。\n\n\n\n继续运行发现还是不成功，提示订单数据不完整。\n\n本来以为到此结束了，结果无意间回到订单页面看了下发现了个很神奇的事情，订单价格竟然变成了1元。\n\n这样的话。。。付款看看。\n\n\n\n\n\n到此为止已经付款并提示购买成功。过了一会手机就提示收到激活码。\n\n那么进入软件测试下看看，提示激活成功。\n\n\n\n到此一系列的测试过程已经结束，发现商城所有商品都可修改价格。请官方尽快修改漏洞，避免造成更大损失，并且求别查水表，下的这个单子仅仅测试。官方应该能查出来并取消订单。   修复方案：  提交订单时后台判断单价是否与数据库中相符，如不符则返回错误。   版权声明：转载请注明来源 无痕@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}