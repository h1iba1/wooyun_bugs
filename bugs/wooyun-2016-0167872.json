{"id": 74272, "wybug_id": "wooyun-2016-0167872", "wybug_title": "运营商安全之中国电信189邮箱系统可Getshell（内含多库可致大量内网敏感信息泄漏）", "wybug_corp": "中国电信", "wybug_author": "李旭敏", "wybug_date": "2016-01-07 12:56", "wybug_open_date": "2016-02-22 16:48", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-10：\t细节向实习白帽子公开  简要描述： 可泄漏近大量用户姓名，联系方式，地址。大量内网敏感信息。 详细说明：   http://**.**.**.**:4180/login/login.do 存在sturts2命令执行漏洞web路径为: /opt/hermes/billManager/resin_billmanager/webapps/bill/\n\n\n\n内附大量用户信息。\n\n数据库太多了，就不仔细一一连接了。可以肯定的是，这绝对绝对不是测试系统！   漏洞证明：  \n<!-- 数据库的引用名称 -->\t\t<hermes>\t\t\t<user>{IDEA}raC3qKC2</user>\t\t\t<password>{IDEA}raC3qKC2</password>\t\t\t<database>HERMES</database>\t\t\t<server>ORADB</server>\t\t\t<driver>oracle</driver>\t\t</hermes>\t\t<aimc-test-229>\t\t\t<user>{IDEA}pKywsKg=</user>\t\t\t<password>{IDEA}W1Gm6xJC3Fer</password>\t\t\t<database>AIMC-TEST-229</database>\t\t\t<server>AIMC-TEST-229</server>\t\t\t<driver>oracle</driver>\t\t</aimc-test-229>\t\t<hermes-db-240>\t\t\t<user>{IDEA}raC3qKC2</user>\t\t\t<password>{IDEA}raC3qKC2</password>\t\t\t<database>HERMES</database>\t\t\t<server>HERMES</server>\t\t\t<driver>oracle</driver>\t\t</hermes-db-240>\t\t<integ-db-240>\t\t\t<user>{IDEA}jIuRgII=</user>\t\t\t<password>{IDEA}jIuRgII=</password>\t\t\t<database>INTEG</database>\t\t\t<server>INTEG</server>\t\t\t<driver>oracle</driver>\t\t</integ-db-240>\t\t<ms1-index-db>\t\t    <user>{IDEA}t6qqsQ==</user>            <password>{IDEA}9PT09PT0</password>\t\t\t<database>test</database>\t\t\t<server>**.**.**.**</server>\t\t\t<driver>mysql</driver>\n\ncom.mysql.jdbc.Driverjdbc:mysql**.**.**.**:3306/Bill189DB?user=root&password=bI11i89db\n\n\n某表段包含过亿数据，无奈mysql查询时直接卡死，管理员也没有进行索引\n\n\n<project basedir=\".\" default=\"mysql189bill\" name=\"189bill\">\t<path id=\"mySqlDriver.classpath\">                <pathelement location=\"../lib/mysql-connector-java-5.1.18-bin.jar\"/>        </path>        <path id=\"oracleDriver.classpath\">                <pathelement location=\"../lib/classes12.jar\"/>        </path>        <target name=\"db_189bill\" description=\"sql for 189bill\">                <sql driver=\"oracle.jdbc.driver.OracleDriver\"                url=\"jdbc:oracle:thin:ehome_bill/ehomebill090512@**.**.**.**:1521:prtdb\"                        userid=\"ehome_bill\" password=\"ehomebill090512\"                        onerror=\"continue\" print=\"yes\"                src=\"oracle.sql\"                        classpathref=\"oracleDriver.classpath\"                />        </target>\t<target description=\"Executes an SQL Script\" name=\"mysql189bill\">           <sql classpathref=\"mySqlDriver.classpath\"               driver=\"com.mysql.jdbc.Driver\"              src=\"${sqlfile}\"  print=\"yes\"            url=\"jdbc:mysql://localhost:3306/Bill189DB?autoReconnect=true&amp;useUnicode=true&amp;characterEncoding=gbk\"            userid=\"root\"              password=\"123456\"/>  \t</target>\t\t\t<!-- ?????欢  -->\t\t<property name=\"serv.user\" value=\"hermes\" />\t\t<property name=\"serv.password-scp\" value=\"!@#$&amp;*()@\" />\t\t<property name=\"serv.port\" value=\"22\" />\t\t<property name=\"serv.knownhosts\" value=\"/opt/hermes/.ssh/known_hosts\" />\t\t<!-- scp ?版??″?;  -->\t\t<target  name=\"scp2server\">\n\n<forward_alias_domain>**.**.**.**</forward_alias_domain>\t\t<ldap_url>ldap**.**.**.**:8889</ldap_url>\t\t<ldap_authtype>simple</ldap_authtype>\t\t<ldap_username>admin</ldap_username>\n\n<V_NEW_USER_URL>http://**.**.**.**/webmail/activeUser.jsp?action=0#toUserID=%s#ip=%s</V_NEW_USER_URL>                <V_COMMEND_USER_URL>http://**.**.**.**/webmail/activeUser.jsp?action=1#toUserID=%s#recommendUserID=%s#ip=%s</V_COMMEND_USER_URL>                <MT_URL>**.**.**.**:8082/uwpp/request/mt.jsp?sp_code=21CN#cp_code=21CNEMAIL#cp_id=21cnemail#cp_pwd=myemail137#service_id=DXZCYJ#fee=%s#des=%s#src=2100#content=%s#fmt=GBK#msg_type=3#link_id=%s#region=%s</MT_URL>                <CORP_MT_URL>**.**.**.**:8082/uwpp/request/corp.jsp?cp_code=21CNEMAIL#cp_id=21cnemail#cp_pwd=myemail137#des=%s#content=%s#sp_code=21CN</CORP_MT_URL>\n\n<server_ip> hermes_appdog_host</server_ip>                    <server_port>110</server_port>                    <server_conn_timeout>5</server_conn_timeout>                    <server_transport_timeout>5</server_transport_timeout>                    <test_account>hermesmon@1</test_account>                    <test_account_pwd>hermesmon</test_account_pwd>                    <smon_server_ip>**.**.**.**</smon_server_ip>                    <smon_server_port>8000</smon_server_port>\n\n<server_name>guid-svr1</server_name>                    <sap_name>guid-svc-sock-sap</sap_name>                    <test_account>hermesmon@**.**.**.**</test_account>                    <test_account_pwd>hermesmon</test_account_pwd>                    <client_group_name>guid</client_group_name>                    <server_group_id>0</server_group_id>                    <check_interval>2</check_interval>                </watch_object>                <watch_object id=\"2\">                    <name>UD</name>                    <enable>yes</enable>                    <!--modify by liyang-->                    <server_name>ud-svr1</server_name>                    <sap_name>ud-svc-sock-sap</sap_name>                    <server_conn_timeout>5</server_conn_timeout>                    <server_transport_timeout>5</server_transport_timeout>                    <test_account>hermesmon@1</test_account>                    <test_account_pwd>hermesmon</test_account_pwd>                    <client_group_name>lmtp</client_group_name>                    <server_group_id>1</server_group_id>                    <check_interval>2</check_interval>                    <restart_retry_times>3</restart_retry_times>                </watch_object>                <watch_object id=\"3\">                    <name>ms</name>                    <enable>yes</enable>                    <!--modify by liyang-->                    <server_name>ms-svr1</server_name>                    <sap_name>ms-svc-sock-sap</sap_name>                    <test_account>zas@testmail.**.**.**.**</test_account>                    <test_account_pwd>111111</test_account_pwd>                    <client_group_name>lmtp</client_group_name>                    <server_group_id>1</server_group_id>                    <check_interval>2</check_interval>                    <restart_retry_times>3</restart_retry_times>                </watch_object>                <watch_object id=\"4\">                    <name>session</name>                    <enable>yes</enable>                    <!--modify by liyang-->                    <server_name>session-svr1</server_name>                    <sap_name>session-svc-sock-sap</sap_name>                    <server_conn_timeout>5</server_conn_timeout>                    <server_transport_timeout>5</server_transport_timeout>                    <test_account>hermesmon@1</test_account>                    <test_account_pwd>hermesmon</test_account_pwd>                    <client_group_name>session</client_group_name>                    <server_group_id>1</server_group_id>                    <check_interval>2</check_interval>                </watch_object>                <watch_object id=\"5\">                    <name>pop3</name>                    <enable>yes</enable>                    <!--modify by liyang-->                    <server_name>pop3-svr1</server_name>                    <sap_name>pop3-svc-sock-sap</sap_name>                    <server_conn_timeout>5</server_conn_timeout>                    <server_transport_timeout>5</server_transport_timeout>                    <test_account>hermesmon@1</test_account>                    <test_account_pwd>hermesmon</test_account_pwd>                    <client_group_name>lmtp</client_group_name>                    <server_group_id>1</server_group_id>                    <check_interval>2</check_interval>                </watch_object>                <watch_object id=\"6\">                    <name>lmtp</name>                    <enable>yes</enable>                    <!--modify by liyang-->                    <server_name>lmtp-svr1</server_name>                    <sap_name>lmtp-svc-sock-sap</sap_name>                    <server_conn_timeout>5</server_conn_timeout>                    <server_transport_timeout>5</server_transport_timeout>                    <test_account>hermesmon@1</test_account>                    <test_account_pwd>hermesmon</test_account_pwd>                    <client_group_name>lmtp</client_group_name>                    <server_group_id>1</server_group_id>                    <check_interval>2</check_interval>                </watch_object>                <watch_object id=\"7\">                    <name>imap</name>                    <enable>yes</enable>                    <!--modify by liyang-->                    <server_name>imap-svr1</server_name>                    <sap_name>imap-svc-sock-sap</sap_name>                    <server_conn_timeout>5</server_conn_timeout>                    <server_transport_timeout>5</server_transport_timeout>                    <test_account>hermesmon@1</test_account>                    <test_account_pwd>hermesmon</test_account_pwd>                    <client_group_name>lmtp</client_group_name>                    <server_group_id>1</server_group_id>                    <check_interval>2</check_interval>                </watch_object>               <watch_object id=\"8\">                     <name>eop</name>                    <enable>yes</enable>                    <!--modify by liyang-->                    <server_name>eop-svr1</server_name>                    <sap_name>eop-svc-sock-sap</sap_name>                    <server_conn_timeout>5</server_conn_timeout>                    <server_transport_timeout>5</server_transport_timeout>                    <test_account>zas@1</test_account>                    <test_account_pwd>111111</test_account_pwd>                    <client_group_name>eop</client_group_name>                    <server_group_id>1</server_group_id>                    <check_interval>2</check_interval>              </watch_object>            </app_client_conf>            <ip_allow_list>                <ip1>**.**.**.**</ip1>                <ip2>**.**.**.**</ip2>                <ip2>**.**.**.**</ip2>\n\n<user>{IDEA}raC3qKC2</user>\t\t\t<password>{IDEA}raC3qKC2</password>\t\t\t<database>189TEST</database>\t\t\t<server>189TEST</server>\t\t\t<driver>oracle</driver>\t\t\t<charset>AMERICAN_AMERICA.WE8ISO8859P1</charset>\t\t</hermes>\t\t<aimc>\t\t\t<user>{IDEA}qay8pKui</user>\t\t        <password>{IDEA}e2CSP5MYy+Kropr09/bx</password>\t\t        <database>AIMC-LIYANG</database>\t\t        <server>AIMC-LIYANG</server>\t\t        <driver>oracle</driver>\t\t        <charset>AMERICAN_AMERICA.US7ASCII</charset>\t\t</aimc>\t\t<hermes_test>\t\t\t<user>{IDEA}QJmV9bejPbU=</user>\t\t\t<password>{IDEA}QJmV9bejPbU=</password>\t\t\t<database>mailads</database>\t\t\t<server>MAILADS</server>\t\t\t<driver>oracle</driver>\t\t</hermes_test>\t\t<ms-index-db>\t\t\t<user>{IDEA}raC3qKC2</user>\t\t\t<password>{IDEA}UjWzQr6BCwu8jQ==</password>\t\t\t<database>hermes</database>\t\t\t<server>ms_index_host</server>\t\t\t<driver>mysql</driver>\t\t</ms-index-db>                <pub-temp-db>\t\t\t<user>{IDEA}t6qqsQ==</user>\t\t\t<password>{IDEA}9Pf28fDz</password>\t\t\t<database>public</database>\t\t\t<server>localhost</server>\t\t\t<driver>mysql</driver>                </pub-temp-db>                <public-db> \t\t\t<user>{IDEA}t6qjqrexrw==</user>\t\t\t<password>{IDEA}t6qjqrexrw==</password>\t\t\t<database>DB3</database>\t\t\t<server>PUBLIC_DB</server>\t\t\t<driver>oracle</driver>\n   修复方案：  \n\n\n\n你们是当社工库一样使用了么？数据库太多了，就不仔细一一连接了。可以肯定的是，这绝对绝对不是测试系统！数据库太多了，就不仔细一一连接了。可以肯定的是，这绝对绝对不是测试系统！   版权声明：转载请注明来源 李旭敏@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-01-11 15:42 厂商回复： CNVD确认所述情况,已经转由CNCERT向中国电信集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-07 13:08 |    \t\twhynot \t\t\t( 普通白帽子  |\t\t\t        Rank:553 漏洞数:100        | 为你解冻冰河 为你放弃世界有何不可)\t\t \n  前排留名 求大牛指导structs200getshell技巧    \n     2016-01-07 14:00 |    \t\t小红猪 \t\t\t( 普通白帽子  |\t\t\t        Rank:285 漏洞数:49        | little red pig!)\t\t \n  我草！    \n     2016-01-07 14:44 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:1071 漏洞数:248        | 1.乌云最帅的男人                        ...)\t\t \n  @李旭敏  求指导那两个后台getshell    \n     2016-01-07 17:04 |    \t\t蓝天 \t\t\t( 普通白帽子  |\t\t\t        Rank:414 漏洞数:101        | 互联网上拾破烂的胖子)\t\t \n  牛逼666666666666 李姐姐 我要给你生猴子    \n     2016-01-07 18:44 |    \t\tCan \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:22        | 天地不仁 以万物为刍狗)\t\t \n  .........为什么我40rank了还是一名路人     \n     2016-01-07 21:49 |    \t\t坏男孩-A_A \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:12        | 膜拜学习中)\t\t \n  牛鼻啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}