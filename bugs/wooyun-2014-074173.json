{"id": 51536, "wybug_id": "wooyun-2014-074173", "wybug_title": "波克城市安全口令修改绕过，可CSRF设置安全口令", "wybug_corp": "波克城市", "wybug_author": "路人甲", "wybug_date": "2014-08-28 12:33", "wybug_open_date": "2014-08-28 14:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-28：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 波克城市安全口令修改绕过，可CSRF设置安全口令我也是看到了发礼物才来的 详细说明：  注册账号，进入账号中心，密码管理，安全口令设置\n\n第一次设置的时候，只需输入安全口令即可设置成功\n\n设置完之后，再次点击修改的时候，则需要验证原来的安全口令\n\n所以这里，我们就直接通过第一次的设置直接修改。POST /safety/setBankPassword.do HTTP/1.1Host: www.pook.comProxy-Connection: keep-aliveContent-Length: 19Accept: application/json, text/javascript, */*User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.143 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://www.pook.com.xxx/safety/mySafetyCenter.doCookie: [cookie]bankPassword=test12321即/safety/setBankPassword.do   bankPassword=xxx  即可直接改成新的安全口令同时，由于无token，可以结合CSRF进行攻击，即可设置任意账号的安全口令。安全口令还是挺重要的呢   漏洞证明：  注册账号，进入账号中心，密码管理，安全口令设置\n\n第一次设置的时候，只需输入安全口令即可设置成功\n\n设置完之后，再次点击修改的时候，则需要验证原来的安全口令\n\n所以这里，我们就直接通过第一次的设置直接修改。即/safety/setBankPassword.do   bankPassword=xxx  即可直接改成新的安全口令同时，由于无token，可以结合CSRF进行攻击，即可设置任意账号的安全口令。安全口令还是挺重要的呢   修复方案：  礼物噶~~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-08-28 14:19 厂商回复： 经过复现并确认，该漏洞只能在用户登录情况下修改当前登陆用户的安全口令，故评级为低. 最新状态： 2014-08-28：已修复。  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}