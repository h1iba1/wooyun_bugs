{"id": 86612, "wybug_id": "wooyun-2016-0182254", "wybug_title": "ABC360又一处敏感信息泄露可直连多个数据库", "wybug_corp": "ABC360", "wybug_author": "胡阿尤", "wybug_date": "2016-03-09 22:34", "wybug_open_date": "2016-04-24 10:29", "wybug_type": "重要敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "内部敏感信息泄漏", "源码泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-03-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-03-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-04-24：\t细节向公众公开  简要描述： RT 详细说明：  接着上一个漏洞，对115.236.70.108这个ip进行了扫描，发现开了8000端口，访问后发现是GitLab，然后就来到了这里\nhttp://115.236.70.108:8000/explore/projects\n直接可以看到有四个项目，是abc360的没有错了\n\n可以直接点进去看代码，没有什么限制哦，大概看了下，找到泄露的配置文件\n\n这个都是内网地址，访问不了啊\n\n然后是DBConfig.xml这个文件，才更新不久哦 \n\n看到一处外网地址的数据库连接配置\n<name>localhost:8888</name><username>test</username><password>test_abc360</password><jdbcurl>jdbc:mysql://115.236.70.108:3399/englishbreak</jdbcurl>\n不过仔细一看跟之前提交的是同一个地址啊，目前厂商已经修复了，厂商反应很迅速哦。补充一张新的截图吧，这是今天又访问后发现的，厂商修改了数据库连接密码了。\n\n\n\n\n<pool>\n\nmask 区域\n\n*****alhost:8888**********gt;test<**********est_abc3602wsx&**********.236.70.108:3399/eng**********t;100<**********t>&lt**********ysql.jdbc.Driv*****\n\n\n\n</pool>\n其他的没有变化，接着往下走\n\n又发现两处外网地址的数据库连接信息哦\n<pool>\n\nmask 区域\n\n*****.abc360.cn**********360test<**********360TEST<**********.108.209:3306/engli**********100<**********;</w**********ql.jdbc.Driv*****\n\n\n\n</pool><pool>\t\t<name>master</name>\t\t<username>select_only</username>\t\t<password>1qaz2wsxselect</password>\t\t<jdbcurl>jdbc:mysql://101.201.148.79:3306/englishbreak</jdbcurl>\t\t<max>100</max>\t\t<wait></wait>\t\t<driver>com.mysql.jdbc.Driver</mask></driver></pool>\n都可以连接上\n\n\n\n内容都差不多，学生信息更多一些，master这个应该是主站数据库了，更官网信息同步的。\n\n\n1457238387 --> 北京时间： 2016/3/6 12:26:27\n然后又发现一枚邮箱口令\n\n\nno-reply@abc360.com abc360no_reply150619\n成功登录，这个拿来钓鱼，应该一钓一个准吧\n\n企业通讯录，企业网盘也都可以访问，这里就不截图了。 还有一处是另一个项目里的\n\n\n<?php$conn = mysql_connect('123.57.146.107', 'log_abc360', 'a0PX@9pld1qaz2wsx');if (!$conn) {    die('Could not connect: ' . mysql_error());}mysql_select_db('ABC360_WEB_LOG', $conn);mysql_query(\"set names utf8\");// SQL server connection information$conn_details = array(\n\nmask 区域\n\n*****; 'log**********'a0PX@9pl**********'ABC360_**********; '123.5*****\n\n\n\n);?>\n   漏洞证明：  提交前再次验证数据库能够连接。\n\n\n\n\n\n   修复方案：  之前说过了，再补充一点吧全面排查，不要指哪补哪   版权声明：转载请注明来源 胡阿尤@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-03-10 10:29 厂商回复： 感谢胡阿尤，已确认漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}