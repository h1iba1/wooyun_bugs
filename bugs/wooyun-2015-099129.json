{"id": 37695, "wybug_id": "wooyun-2015-099129", "wybug_title": "DamiCMS 任意控制投票票数", "wybug_corp": "damicms.com", "wybug_author": "蓝蓝", "wybug_date": "2015-03-10 10:33", "wybug_open_date": "2015-06-09 08:22", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-09：\t细节向公众公开  简要描述： DamiCMS 任意控制投票票数 详细说明：  投票的关键代码如下。\nforeach($_POST['vote'] as $v)                {                        var_dump($v);                        $v = str_replace(\"\\n\",\"\",$v);                        $s = explode(\"=\",$v);                        var_dump($s);                        $data['vote'] = str_replace($v,$s[0].\"=\".(intval($s[1]) + 1),$data['vote']);                }                var_dump($data);                if($vote->where('id='.intval($_POST['id']))->save($data))\n传入的数据用等号分割，类似 选项1=3 会变成 array(选项1,3)， 如果只传入选项一，会变成array(选项1,null)，intval(null)会变成零，并且写入数据库。POC:一开始有100票\n\n提交以下这样的请求\n\n可以看到票数变成1票\n\n如果想提高票数可以用x-forwarded-for来进行刷票。   漏洞证明：  官方Demo测试一下\n\n   修复方案：  不要用str_replace这种诡异的实现。。。   版权声明：转载请注明来源 蓝蓝@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2015-03-11 08:20 厂商回复： 对数据验证不严，造成该bug 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}