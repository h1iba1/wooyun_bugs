{"id": 49349, "wybug_id": "wooyun-2015-0127130", "wybug_title": "安全理财之合拍网逻辑错误可重置任意用户密码", "wybug_corp": "he-pai.cn", "wybug_author": "艾薇儿", "wybug_date": "2015-07-16 13:56", "wybug_open_date": "2015-08-30 14:30", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "逻辑错误", "手机短信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-30：\t细节向公众公开  简要描述：  厂商对自己网站的安全很负责任吖  详细说明：    问题出现在密码找回功能，在测试中发现可以根据 USR_ID来重置任意用户密码。 不知道USR_ID怎么办？ 遍历USR_ID即可(纯暴力手段) 首先还是正常找回密码流程，输入会员名和手机号(都是手机号即可)  然后获取短信验证码，这里补充一下，获取短信验证码没有限制，可以造成短信炸弹 \n\n \n\n 继续，输入短信验证码，然后下一步 \n\n 来看下返回值，，可以看到返回了用户的USR_ID \n\n 然后输入密码 点下一步 抓包，可以看到重置密码的请求需要 新密码和USR_ID即可 \n\n   漏洞证明：   测试证明：  修改USR_ID 然后请求 \n\n 我的账号 \n\n 证明即可，不影响线上数据！   修复方案：     版权声明：转载请注明来源 艾薇儿@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-07-16 14:28 厂商回复： 此漏洞会修改某些重要数据，程序猿正在处理中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}