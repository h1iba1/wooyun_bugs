{"id": 2850, "wybug_id": "wooyun-2014-062970", "wybug_title": "墨迹天气android客户端系列3：修改任意邮箱用户密码姿势二", "wybug_corp": "mojichina.com", "wybug_author": "白非白", "wybug_date": "2014-06-03 11:31", "wybug_open_date": "2014-07-18 11:31", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当", "客户端程序设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-18：\t细节向公众公开  简要描述： RT 详细说明：  这次修改密码利用的是登录后的修改密码功能。正常青年改密码：\n点击修改密码->输入旧密码->验证成功，修改密码\nwooyun青年改密码：\n直接修改任意snsid密码\nhttp://payload.moji002.com/skinpay/snsuser/modifyPassword.action?SnsID=13260***&NewPassword=301752D1453E772C787DE1550E4712E9返回0，修改成功，返回1，修改失败。该方式简单，粗暴。直接修改连接中SnsID为151，即可将管理员“小墨”的密码改为123123，连接中NewPassword为123123的哈希值，至于是md5还是sha1，我就不深入了。利用:方式一：遍历连接中snsid，即可将墨迹天气所有用户密码改为123123.（不忍直视，最好不要酱紫，墨迹天气会怒的）方式二：http://ugc.moji001.com/sns_attention/FansList?&SnsID=151&Start=0&Limit=20 获得管理员“小墨”的粉丝snsid，修改之。。（最好也不要酱紫，小墨会怒的）   漏洞证明：  不信你改一下管理员“小墨”的密码试试？反正我没改，昨天只测试了自己的两个小号，都成功，没截图。。。ps:墨迹天气只能邮箱登录，改snsid只能给其他用户制造麻烦，不能自己登录墨迹天气。找了很长时间通过snsid得到邮箱的方法，未找到。Anyway，改其他用户密码也算是高危漏洞了。   修复方案：  你们懂，收费主题都设计的那么复杂，改密码这事为啥这么疏忽呢？既然要做社交服务，就不要疏忽用户的隐私与安全。这下，墨迹天气总该成为wooyun厂商了吧。   版权声明：转载请注明来源 白非白@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-06-04 19:01 厂商回复： 接口设计不当，会尽快更新该接口避免该安全问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-04 19:31 |    \t\t白非白 \t\t\t( 普通白帽子  |\t\t\t        Rank:447 漏洞数:60        | ♫ Freedom - Anthony Hamilton ♫)\t\t \n  @墨迹风云 事先不知道墨迹风云就是墨迹天气，还有两个接口问题在待认领里面。 WooYun: 墨迹天气android客户端系列2：修改任意邮箱用户密码姿势一 WooYun: 墨迹天气android客户端系列1：某接口泄露用户手机号  一起领了吧。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}