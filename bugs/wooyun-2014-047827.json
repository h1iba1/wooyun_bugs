{"id": 5086, "wybug_id": "wooyun-2014-047827", "wybug_title": "Yxcms管理员SESSION伪造漏洞", "wybug_corp": "yxcms", "wybug_author": "phith0n", "wybug_date": "2014-01-04 14:59", "wybug_open_date": "2014-04-04 15:00", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["白盒审计"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-04：\t细节向公众公开  简要描述： yxcms是一款内容管理系统。借助后台一个CSRF起飞，伪造session可直接登录后台~ 详细说明：  我也是第一次见到这样有趣的漏洞，yxcms允许我们自定义session，而且这个过程通过get方式来完成。我觉得这样的问题属于CSRF，不经意之间就能获取大效果。其问题代码如下：\n<?php//公共类class commonController extends baseController{\tpublic function __construct()\t{\t\tparent::__construct();        if(!empty($_GET['phpsessid'])) session_id($_GET['phpsessid']);//通过GET方法传递sessionid,firefox        session_starts();\t\t……\n　　当$_GET[‘phpsessid’]非空时，就令session_id为我们传入的值。　　于是我想到一个猥琐的方法，我们构造一个链接让管理员点击，管理员点击后会重新设置他的session，而且这个session就是我们构造的。因为session重置了所以管理员也需要重新登录，而重新登录后其session_id就是我们构造的。我们只要利用这个session_id就能登录管理后台了。　　比如我来构造：　　http://xxxx/index.php?r=admin/index/index&phpsessid=f4cking123　　管理员点击后会跳转到登录页面，但此时他的phpsession已经是我们构造的f4cking123了：\n\n　　这是管理员如果重新登录，那个这个session就有后台权限了。我们也利用这个链接：http://xxxx/index.php?r=admin/index/index&phpsessid=f4cking123，将自己的session设置成f4cking123，或者随意怎么修改，只要把phpsessid修改成f4cking123就能拥有后台权限了：\n\n   漏洞证明：  见详细说明。   修复方案：  后台所有操作加token，不要轻易相信用户的输入。   版权声明：转载请注明来源 phith0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-01-09 13:32 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-04 15:20 |    \t\tlxj616 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:90        | <hohoho>)\t\t \n  已交由第三方厂商(cncert国家互联网应急中心)处理......    \n     2014-01-04 21:21 |    \t\t想要减肥的胖纸 \t\t\t( 普通白帽子  |\t\t\t        Rank:250 漏洞数:42        )\t\t \n   WooYun: YXcmsApp 注入 漏洞   @cncert国家互联网应急中心  顺便处理下呗 等待认领    \n     2014-01-05 10:09 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  @想要减肥的胖纸 这个看不到，对于yxcms，此前测试与其他CMS有同源情况，根据提交的内容，我们会进行其他测试。    \n     2014-01-09 13:34 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  嗨，cncert就是好，大方，走大厂商。其他cms都是小厂商，10个注入顶这一个的rank。。。。    \n     2014-01-09 15:52 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  @xfkxfk 有钱就好啊    \n     2014-01-09 16:14 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @saline 很久很久没发钱了。。。    \n     2014-01-09 20:50 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  @xfkxfk 不信~    \n     2014-01-09 21:00 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @saline @phith0n 真的，不信你问管理    \n     2014-04-04 17:39 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @phith0n 这种漏洞有个名词，叫“会话固定”漏洞，确实有趣。这个漏洞有奖励的，等我慢慢发。    \n     2014-04-04 17:44 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  @疯狗 嘿嘿，期待！    \n     2014-04-21 15:40 |    \t\t廷廷 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 有很强的好奇心，爱好广泛，求女女带走。。...)\t\t \n  @phith0n   看的你的文章  很感谢  能提供下您的QQ不？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}