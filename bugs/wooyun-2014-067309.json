{"id": 912, "wybug_id": "wooyun-2014-067309", "wybug_title": "某充值软件存在严重充值漏洞可能导致免费充值", "wybug_corp": "某充值平台", "wybug_author": "newcenturysun", "wybug_date": "2014-07-07 12:48", "wybug_open_date": "2014-10-05 12:50", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "支付行业敏感"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-05：\t细节向公众公开  简要描述： 某充值软件存在明显的漏洞，漏洞攻击者可以使用该软件进行免费充值操作。 详细说明：      之前笔者曾经通过官方的CNNVD渠道提交过北京市政公交一卡通的充值漏洞，一共提了两个：一个是余额为负的情况下的充值漏洞；另一个是任意充值退款的漏洞。很高兴看到余额为负数的漏洞被修复了，但修复只是界面上进行了屏蔽，修复方法有点勉强吧。另一个较为严重的任意充值退款漏洞在目前的最新版本V1.0.09中仍然存在。由于CNNVD很不给力，迟迟没有给予回复，且漏洞到目前仍然存在，因此决定在乌云平台上公布该漏洞。（漏洞相关厂商：hzt360.com）   漏洞证明：  1.查看当前公交卡余额11.2元。\n\n2.充值，选择金额10元，并提交。\n\n3.使用支付宝进行正常交易，并付款成功。\n\n4.之后进行写卡操作，并同时对手机通过的流量进行拦截，并在进行到其中某一步的时候丢弃其发向服务器的数据包。\n\n5.此时软件提示“验签失败”。\n\n6.点击后退按钮，撤销本次充值操作。\n\n7.于是温馨提示要退款给我。\n\n8.收到短信。\n\n9.再次扫描下公交卡，多了10元。后面证明也成功退款到了我的账户，就不截图了。\n\n   修复方案：  修改程序流程。该漏洞个人认为非常严重，需要从软件的代码流程上下手才能解决根本问题，而不是从服务器上（目前看到一天限制退款两次）或者从软件界面上解决问题。另外，漏洞发现不易，截图一步一步操作更不易，如果漏洞已经修补或者确认，麻烦告知漏洞发现者，这也是对漏洞发现者辛苦劳动的尊重。   版权声明：转载请注明来源 newcenturysun@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-07-12 11:54 厂商回复： 经比对，与http:///bugs/wooyun-2014-认定一致。此前已经向开发厂商亿阳公司通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}