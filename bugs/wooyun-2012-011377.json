{"id": 17079, "wybug_id": "wooyun-2012-011377", "wybug_title": "新浪某站信息泄露", "wybug_corp": "新浪", "wybug_author": "upload", "wybug_date": "2012-08-26 19:00", "wybug_open_date": "2012-10-10 19:00", "wybug_type": "敏感信息泄露", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-09-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-09-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-09-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-10-10：\t细节向公众公开  简要描述： 1.该站存在test.php泄露/etc/passwd信息2.使用的kohana框架构成的系统代码貌似有问题，某些页面ReflectionException、ErrorException提示，泄露部分敏感信息 详细说明：  问题站点为新浪乐居\nhttp://watchdog.leju.com\n存在的测试页面test.php\nhttp://watchdog.leju.com/test.php\n然后异常地址：\nhttp://watchdog.leju.com/...../%20all\n（看着像cgi?不知道...）流量日志内容：\nhttp://watchdog.leju.com/log\n代码问题：\nhttp://watchdog.leju.com/log/detail/yayuncheng/120825\n   漏洞证明：  \nreadfile('/etc/passwd');\n\n\nhttp://watchdog.leju.com/...../%20all异常提示\nSYSPATH/classes/kohana/request.php [ 1029 ]1024 1025 \t\ttry1026 \t\t{1027 \t\t\t// Load the controller using reflection1028 \t\t\t1029 \t\t\t$class = new ReflectionClass($prefix.$this->controller);1030 \t\t\t1031 \t\t\tif ($class->isAbstract())1032 \t\t\t{1033 \t\t\t\tthrow new Kohana_Exception('Cannot create instances of abstract :controller',1034 \t\t\t\t\tarray(':controller' => $prefix.$this->controller));SYSPATH/classes/kohana/request.php [ 1029 ] » ReflectionClass->__construct(arguments)APPPATH/bootstrap.php [ 99 ] » Kohana_Request->execute()DOCROOT/index.php [ 103 ] » require(arguments)EnvironmentIncluded files (24)Loaded extensions (45)$_SERVER\nIncluded files....\n\nhttp://watchdog.leju.com/...../%20all的$_SERVER，有数据库用户名、密码，不过是内网的\n\n   修复方案：  此处略--   版权声明：转载请注明来源 upload@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2012-08-27 09:36 厂商回复： 感谢提供，立即安排人员处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}