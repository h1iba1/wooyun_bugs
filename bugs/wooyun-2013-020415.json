{"id": 13026, "wybug_id": "wooyun-2013-020415", "wybug_title": "百度首页反射半自动存储xss", "wybug_corp": "百度", "wybug_author": "呆子不开口", "wybug_date": "2013-03-21 15:12", "wybug_open_date": "2013-05-05 15:13", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "持久型", "利用技巧", "存储型", "应用程序后门"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-05：\t细节向公众公开  简要描述： 如果中标方是个有文采的互联网达人，此人会立马在微博上惊呼“天呐，360搜索加入了百度的阿拉丁计划” 详细说明：  chrome和ff下有效，IE没测，需要百度用户在登陆状态下百度首页搜索汉字超过两个后，会把搜索内容及拼音写入浏览器的localstorage，当你再次搜索类似的词时，会在下拉框自动填充，但在当你输入的是字母时，自动响应出的汉字对应内容没有进行html转义\n\n我们可以很简单的iframe一个构造好的搜索结果页来让用户浏览，如\n<iframe src='http://www.baidu.com/s?wd=%E5%BE%AE%E5%8D%9A%3Cimg+src%3D1+onerror%3Dalert%281%29%3E' width='0' height='0'></iframe><img src=美女高潮图>\n以后当用户再搜索或误输入\"weib\" \"weibo\"等字符时，就会执行我们的代码这个漏洞比较难利用，可以写入localstorage的搜索内容有长度要求，可利用部分很短，自动填充用的是innerhtml，<script>无效。但由于每次可以显示两条，所以通过两次拼接，还是可以实现弹窗钓鱼或者转向广告业恶意页等，还是有一定危害。比如如下代码\n<iframe src='http://www.baidu.com/s?wd=搜索<img+src+onerror%3Dlocation.href%3Da>' width='0' height='0'></iframe><iframe src='http://www.baidu.com/s?wd=搜索<img+src+onerror%3Da%3D%27%2F%2Fso.com%27>' width='0' height='0'></iframe><img src=美女完事累坏了图>\n访问这样的页面后，以后在百度搜索框里只要敲\"sous\"\"sousu\"\"sousuo\"等都会跳到360搜索，如果中标方是个有文采的互联网达人，此人会立马在微博上惊呼“天呐，360搜索加入了百度的阿拉丁计划”   漏洞证明：  如上图   修复方案：  localstorage里的内容放入页面中时，做html转义另，最好是能做到识别出，是用户主动搜索的内容才放入localstorage中   版权声明：转载请注明来源 呆子不开口@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2013-03-21 15:27 厂商回复： 感谢提交，马上联系业务部门修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-21 15:13 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  反射半自动    \n     2013-03-21 15:13 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:125        | 如果大海能够带走我的矮丑...)\t\t \n  手枪步枪有半自动，尼玛XSS也半自动?    \n     2013-03-21 15:20 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  全乌云精华比例最高的白帽子，围观下    \n     2013-03-21 15:27 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:25        | 求各种兼职)\t\t \n  @梧桐雨 我帮管理员打过飞机这事我会到处乱说么    \n     2013-03-21 15:29 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:25        | 求各种兼职)\t\t \n  @小胖子 这是一种进步，要让用户有参与感，不能只顾自己玩的爽    \n     2013-03-21 15:47 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  百度首页！！屌爆    \n     2013-03-21 17:05 |    \t\t易水寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:67 漏洞数:5        )\t\t \n  洞主绝对是乌云里相声说的最好的一个，没有之一。    \n     2013-03-21 17:54 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  卧槽。。    \n     2013-03-21 22:25 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:30        | Hacked by @ringzero 我錯了)\t\t \n  碉堡了    \n     2013-03-23 00:03 |    \t\tretaker \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | free open share)\t\t \n  ?<script></script>调用腾讯的urlcheck这个吗    \n     2013-04-01 09:18 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  这个名字有意思    \n     2013-04-03 01:23 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:25        | 求各种兼职)\t\t \n  test    \n     2013-04-12 01:27 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  @呆子不开口 你是个有想象力+细心的男人。    \n     2013-04-12 11:47 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:25        | 求各种兼职)\t\t \n  @_Evil 擦，竟然被你猜出我是个GAY    \n     2013-04-20 17:00 |    \t\tDM_ \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:15        )\t\t \n  厉害,学到了    \n     2013-04-20 18:53 |    \t\tSka \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        )\t\t \n  ...洞主高手，有时候就是需要细心，每天我们也能看到关联搜索- -    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}