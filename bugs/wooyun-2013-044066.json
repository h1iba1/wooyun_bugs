{"id": 5796, "wybug_id": "wooyun-2013-044066", "wybug_title": "RADASM 堆栈缓冲区溢出漏洞", "wybug_corp": "www.oby.ro", "wybug_author": "光刃", "wybug_date": "2013-11-26 10:19", "wybug_open_date": "2014-02-24 10:20", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-24：\t细节向公众公开  简要描述： RADASM软件包内某程序堆栈缓冲区溢出，可淹没SEH链表并可以修改SEH表。 攻击者可以构造特定的文件，修改SEH链表，即可利用此漏洞执行任意想执行的程序。 详细说明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n漏洞原因：在处理.RC文件字符串的时候由于申请空间不足可导致栈缓冲区溢出。淹没SEH链表。攻击者可以构造特定的.RC文件，修改SEH链表，即可利用此漏洞执行任意想执行的程序。本人分析的版本为2.2.1.9 ，漏洞程序为ResEd.exe  但是此漏洞可能涉及到RADASM的所有版本   漏洞证明：  \n\nnull准poc程序的FFFFFFFF和CCCCCCCC （0BH-12H）就为SEH链和SE处理程序了，我这里没有写漏洞利用程序   修复方案：  对路径和文件名总长度做检测。静止超过104H字节！   版权声明：转载请注明来源 光刃@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-11-29 22:25 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-26 10:47 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  有什么意义，放一个.asm在那里，骗管理员去编译一下提权么？@xsser    \n     2013-11-26 11:03 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  和.ASM没有任何关系。 此程序在打开.RC文件的时候。特定的.RC文件可以让此程序缓冲区溢出，淹没SEH链表并可以修改SEH表。 攻击者可以构造特定的.RC文件，修改SEH链表，即可利用此漏洞执行任意想执行的程序。    \n     2013-11-26 12:14 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  膜拜洞主 乌云很缺这样的内容    \n     2013-11-26 12:22 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  谢谢大牛    \n     2013-11-29 10:16 |    \t\tRtsjx \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:4        | ......)\t\t \n  次奥，这不是看雪的光刃胸么？    \n     2013-11-29 12:00 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  @Rtsjx 是啊，你是？？    \n     2013-12-30 17:19 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  挖草，碉堡了    \n     2014-02-26 14:53 |    \t\t炯炯虾 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我来自地球)\t\t \n  写文章的作者文笔很烂 没有章理 完全凭想象搞技术    \n     2014-02-26 14:58 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  @炯炯虾 我解释一下吧，我本来把分析报告写成了一个PDF格式。然后呢 我就截图*7 放在这里，但是图片顺序反了。 所以应该从下面开始往上面读起。话说我中学语文经常不及格，这都被你看出来了。你真厉害    \n     2014-02-26 15:02 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  @炯炯虾 除了第一张图片以外，每一个图片上面都写着 图x  （x=2 3 4 5 6 7）  这样看就可以找到顺序了。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}