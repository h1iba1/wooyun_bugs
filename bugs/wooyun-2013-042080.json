{"id": 60733, "wybug_id": "wooyun-2013-042080", "wybug_title": "shop7z sql注入漏洞", "wybug_corp": "shop7z", "wybug_author": "Matt", "wybug_date": "2013-11-07 12:12", "wybug_open_date": "2014-02-05 12:12", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-07：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-02-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： shop7z sql注入漏洞 详细说明：  getpassword3.asp\nif session(\"verifycode\")<>request.Form(\"code\") thenresponse.write \"<br><br><div align=center><a href=javascript:window.history.back()>请输入正确的验证码，点击这里返回重试</a></div>\"response.endend ifusername=trim(request.Form(\"username\"))password_Answer=trim(request.Form(\"password_Answer\"))mail=trim(request.Form(\"mail\"))if InStr(password_Answer,\"'\")>0 or InStr(password_Answer,\"--\")>0 or InStr(password_Answer,\"(\")>0 or InStr(password_Answer,\";\")>0 then\tresponse.write \"密码提示答案不合法。\"\tresponse.endEND IFif InStr(mail,\"'\")>0 or InStr(mail,\"(\")>0 or InStr(mail,\";\")>0 then\tresponse.write \"mail不合法。\"\tresponse.endEND IFsql=\"select password from x_huiyuan where username='\"&username&\"' and password_Answer='\"&password_Answer&\"' and email='\"&mail&\"' \"//注入set rs=server.createobject(\"adodb.recordset\")rs.open sql,conn,1,1\n测试192.168.236.131/getpassword3.aspPOST 内容username=1111'&password_Answer=111&mail=ddd@qq.com   漏洞证明：  \n\n   修复方案：  过滤   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}