{"id": 2924, "wybug_id": "wooyun-2014-062820", "wybug_title": "Elasticsearch远程执行漏洞影响众多国内服务器集群", "wybug_corp": "Elasticsearch", "wybug_author": "Jasonfcku", "wybug_date": "2014-05-30 09:48", "wybug_open_date": "2014-07-14 09:48", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-14：\t细节向公众公开  简要描述： 好吧，我承认我是看到刚才提交的http://www.wooyun.org/bugs/wooyun-2014-062682眼红了，不知道他提交的跟我的是不是一样的？～ 详细说明：  从撒旦网上搜索关键词：\n“You Know,for search country:CN port:9200”\n传送门：\nhttp://www.shodanhq.com/search?q=You+Know%2Cfor+search+country%3ACN+port%3A9200\n好了，一大波开了Elasticsearch 服务的服务器出现了：\n\n那么在这其中有多少可以利用的呢？写了个python脚本来自己抓ip，脚本不太好看，写漂亮了发出来，先给个demo\n#filename: url.py#author:   jason#win+python2.7.x import urllib2import refrom bs4 import BeautifulSoup def zq(url):    opener = urllib2.build_opener();    #cookie我xxx掉一部分。。    opener.addheaders.append(('Cookie','__cfduid=××××6ea46160a309e6c636c3c3011400591039236; bsau=14012888790368938084; shodan_main_session=××××b79344e25acf5dbc836ec0e70; __utma=93054943.595576510.1400591055.1401362736.1401366805.6; __utmb=93054943.4.10.1401366805; __utmc=93054943; __utmz=93054943.1401031713.3.2.utmcsr=google|utmccn=(organic)|utmcmd=organic|utmctr=(not%20provided); bsas=14013680314372166954'))    page = opener.open(url)    html_doc = page.read()    soup = BeautifulSoup(html_doc,fromEncoding='gb18030')    #print (soup)    #print \"end\"    for i in soup.find_all(attrs={\"class\":\"ip\"}):        print i zq(\"http://www.shodanhq.com/search?q=You+Know%2Cfor+search+country%3ACN+port%3A9200\")\n效果图：\n\n然后提取出ip\n\n下面测试下有多少能用的也放个demo吧\n#filename: stat.py#author:   jasonimport urllib def stat(ip):        page = urllib.urlopen(ip)    sta = page.getcode()    print ip,sta\n上图：\n\n\n\n有一些不能用，但是很大一部分还是能用的！好吧，就不写批量提权的脚本了。。。小白水平不够。   漏洞证明：  \n\n\n\n   修复方案：  在配置文件elasticsearch.yml里设置script.disable_dynamic: true引用： WooYun: 果壳网某服务远程命令执行漏洞（非st2）   版权声明：转载请注明来源 Jasonfcku@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-06-04 09:32 厂商回复： 感谢白帽子的批量检测工作，类似工作CNVD已经开展，针对政府和重要信息系统部门的处置工作在进行中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}