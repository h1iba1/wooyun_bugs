{"id": 28702, "wybug_id": "wooyun-2015-0111842", "wybug_title": "一台微信打印机引起的血案", "wybug_corp": "微忆网络", "wybug_author": "Chora", "wybug_date": "2015-05-03 23:49", "wybug_open_date": "2015-06-17 23:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-03：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-06-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 周末跟媳妇儿出去环球中心约一约，结果看到一大群人围着一台设备，原来是发送图片免费打印照片的活动，媳妇很果断的跟着人群操作，而我这种屌丝关心的是能不能搞到妹子的艳照。 详细说明：  说通俗一点其实是属于微信营销的一种。\n\n\n\n大概流程是首先扫描二维码关注公众号，每关注一个可以免费打印一张照片，关注过后传一个图片过去，会返回一篇文章，点击进入特定的URL，然后输入机台号跟对应的打印码就可以打印发送的相对应的照片了。回到家里首先确认了这个流程，并且知道了后端是这么的。http://lomoservices.lomopai.cn:10154/EditImagev2.2.html?imageName=151c6c6c3bd94899b6d1acedbdb3021c.jpg&sid=670&uid=oFrD3jmTtvVbZHbsQh0YmGKXnKm0&coid=gh_795a11896e12&m=0访问了下官网大概了解了该公司的业务www.lomopai.cn，决定直接从数据入手。通过公开信息收集到了某一个后台地址shebei.lomopai.cn\n\n发现没有验证码，并且也没有限制登录次数，使用常用的用户名跟密码进行FUZZ得到账号test密码test，应该是在测试的时候遗留下来忘了关闭的，我最开始因为就这么结束了，哪知道登录进去发现看不到任何数据，权限恨死。\n\n看来得想想其他路子了，找注入比较简单，那么就从注入下手吧，一般得系统前台很安全，单后台注入一箩筐。测试了有一会儿发现使用了框架有点绝望了，最后还是没有放弃找到了程序员拼接的地方，并没有使用框架本身而导致的注入。在注入的时候发现居然有限制，后来经过证实并不是限制，而是程序在in语句里面以,作为分隔添加引号。\n\n通过前面一个参数的报错显示出了后面语句到底是怎么过滤，怎么处理字符的。这里过滤了,号是可以注入了，为了方便使用自动化工具进行快速测试，我找到了另外一个整型的点，并且没有任何限制。\n\n通过注入找到管理员的账号密码就比较简单了，以管理员身份进入后台。\n\n查看可以管理的设备，大设备300多台，小设备50多台\n\n找到了环球的两台设备，并且可以看到我们可以远程控制这些设备，重启关机，广告，播放图片视频等等。\n\n\n\n\n\n另外发现的一个微信的管理平台http://weixin.lomopai.cn/,通过注入点跑出了所有用户的账号密码。\n\n进去看看\n\n\n\n很多敏感数据不堪入目啊。至于妹子的照片，哎失望没有艳照啊，大庭广众打照片谁敢打艳照？   漏洞证明：  。。。   修复方案：  打个酱油   版权声明：转载请注明来源 Chora@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2015-05-04 10:13 |    \t\tca1n \t\t\t( 普通白帽子  |\t\t\t        Rank:100 漏洞数:22        | not yet)\t\t \n  说好的chora妹子。。。    \n     2015-05-04 10:59 |    \t\t孤独行者 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:44        | 时光如水，总是无言。你若安好，便是晴天)\t\t \n  谁说chora是妹子？？！！！    \n     2015-05-04 11:03 |    \t\t小人物Reno \t\t\t( 普通白帽子  |\t\t\t        Rank:471 漏洞数:110        | X)\t\t \n  洞主，成都的！    \n     2015-05-04 14:47 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  chora男神！    \n     2015-05-04 15:06 |    \t\tChora \t\t\t( 普通白帽子  |\t\t\t        Rank:337 漏洞数:22        | 生存、生活、生命。)\t\t \n  @玉林嘎 嘎嘎你又调皮了，要不要帮我生猴子！    \n     2015-05-04 20:37 |    \t\t小荷才露尖尖角 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:13        | less is more)\t\t \n  我也在电影院想过这个打印机的问题，还是＠chora犀利    \n     2015-05-05 17:32 |    \t\t大漠長河 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:7        | ̷̸̨̀͒̏̃ͦ̈́̾( 天龙源景区欢迎您...)\t\t \n  很好奇啥东西    \n     2015-06-18 01:46 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  我操，宝贝你为什么这么能搞！    \n     2015-06-20 21:50 |    \t\t冰刀 \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:3        )\t\t \n  在街上使用了这种机器之后 我想的是怎样突破验证 无限打印 没想到洞主直接搞了 更牛    \n     2015-08-15 09:57 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  chora男神！    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}