{"id": 88358, "wybug_id": "wooyun-2016-0210575", "wybug_title": "好贷网核心功能源码泄露                                      ", "wybug_corp": "好贷网", "wybug_author": "杨某某", "wybug_date": "2016-05-19 17:26", "wybug_open_date": "2016-07-03 17:50", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-03：\t细节向公众公开  简要描述： Git源码泄露 详细说明：  #1 漏洞位置\nhttp://sandbox.api.haodai.com/.git/config\n   漏洞证明：  #2 漏洞证明用githack可以下载源码\n\n看了下，是好贷网APP后台api代码，TP框架搭建而成，查看Model和Action\n\n\n\n涉及到用户管理，理财产品等核心功能贴几个敏感文件\n<?phprequire_once 'changeDefine.php';return $g_config = array(//    'LAYOUT_ON' => true, //TPM配置  2013-08-09 zhuoyk    //'APP_STATUS' => 'debug', //应用调试模式状态     //'SHOW_PAGE_TRACE' => true, //trace错误信息显示    'URL_CASE_INSENSITIVE' => true, //url不区分大小写    'OUTPUT_ENCODE' => false, //启动页面压缩     'APP_GROUP_LIST' => 'Homeapi,Home', //项目分组    'DEFAULT_GROUP' => 'Homeapi', //默认分组     'URL_MODEL' => 2, //PATHINFO模式      'URL_HTML_SUFFIX' => '', //URL后缀 .html    'VAR_URL_PARAMS' => '_URL_', //PATHINFO URL参数变量 //数据库配置信息    'DB_TYPE' => 'mysql', // 数据库类型    'DB_HOST' => DB_HOST, // 服务器地址    'DB_PREFIX' => '', // 数据库表前缀 //测试机    'DB_NAME' => HD_DB_NAME, // 数据库名     'DB_USER' => HD_DB_USER, // 用户名    'DB_PWD' => HD_DB_PWD, // 密码    'DB_PORT' => HD_DB_PORT, // 端口    'DB_FIELD_CACHE' => false, //关闭字段缓存    'TOKEN_ON' => false, //表单令牌验证    'TMPL_FILE_DEPR' => '_', //模板下划线    'TMPL_TEMPLATE_SUFFIX' => '.tpl.php', //模板后缀    'DATA_CACHE_TYPE' => 'Memcache', //缓存修改为MC    'MEMCACHE_HOST' => 'tcp://127.0.0.1:11211',    'DATA_CACHE_TIME' => 300, //默认缓存时间 300秒 5分钟    'TMPL_ACTION_ERROR' => 'Tpl/dispatch_jump.tpl.php', //错误跳转    'TMPL_ACTION_SUCCESS' => 'Tpl/dispatch_jump.tpl.php', //正确跳转    'URL_HTML_SUFFIX' => '', // URL伪静态后缀设置    //Home ----------------------  规则  ----------------------    'URL_ROUTER_ON' => true, //开启路由    'URL_ROUTE_RULES' => array(),);\n\nprivate $clt = null; //链接对象\tprivate $url = ''; //接口地址\tprivate $namespace = 'http://tempuri.org'; //命名空间（梦网）\tprivate $timeout = 0; //连接超时时间，默认0，为不超时\tprivate $userId = 'J01953'; //接口用户ID\tprivate $password = '319331'; //用户密码\tprivate $qianminglength = 5; //签名字符长度  现在签名内容 “【好贷网】”;\n\n$this->userId = 'J01953';\t\t\t$this->password = '319331';\t\t\t$this->url = $this->urlarr['shengchan'][1];\t\t\t$this->service = 2;\n\n/**\t * 服务端 （北京速强软件）\t */\tprivate function toSuQiang() {\t\t$data['UserName'] = 'jtaogy';\t\t$data['Password'] = 'jtaogy386';\t\t$data['AppendNum'] = $this->data['appn'];\t\t$data['SendTime'] = $this->data['s_time'];\t\t$data['DestMobile'] = $this->data['tel'];\t\t$data['Content'] = urlencode($this->data['content']); // 短信内容URL编码;\t\t$data['Priority'] = 5;\t\t$cLength = mb_strlen($this->data['content'], 'utf8'); // 计算长度\t\tif ($cLength > 67) {\t\t\t$data['MsgType'] = 4;\t\t} else {\t\t\t$data['MsgType'] = 0;\t\t}\t\t$ctx = stream_context_create(\t\t\t\tarray(\t\t\t\t\t'http' => array(\t\t\t\t\t\t'method' => \"GET\",\t\t\t\t\t\t'timeout' => 10 //超时时间，单位为秒\t\t\t\t\t)\t\t\t\t)\t\t);\t\t$url = 'http://isms.supermore.com.cn/Mobile.asmx/SendMsg?';\t\t//$url = 'http://www.baidu.com';\t\tforeach ($data as $k => $v) {\t\t\t$url .= $k . '=' . $v . '&';\t\t}//\t\treturn true;\t\t$ret = file_get_contents($url, 0, $ctx);\t\t$ret = simplexml_load_string($ret);\t\t$ret = simplexml_load_string($ret[0]);\t\tif ($ret->code == '01') {\t\t\treturn true;\t\t} else {\t\t\treturn false;\t\t}\t}\n\nprivate function toKYT() {                $sn = 'SDK-SKY-010-02405';//序列号                $pwd = '347982';//密码                $tfid = '';//特服号 暂时不使用\n\n$sn = 'SDK-SKY-010-02405';//序列号            $pwd = '347982';//密码            $tfid = '';//特服号 暂时不使用            $data['sn'] = $sn;            $data['pwd'] = strtoupper(md5($sn.$pwd));//md5(sn+password) 32位大写密文            $url = 'http://sdk.entinfo.cn:8060/webservice.asmx/balance?sn='.$data['sn'].'&pwd='.$data['pwd'];            $ret = vcurl($url);            echo($ret);\n总之就是核心功能源码的泄露，还有各种平台的账号密码   修复方案：  删除.git目录   版权声明：转载请注明来源 杨某某@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-05-19 17:42 厂商回复： 已修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}