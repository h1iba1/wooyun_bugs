{"id": 9898, "wybug_id": "wooyun-2013-031860", "wybug_title": "糯米网任意用户密码重置漏洞", "wybug_corp": "糯米网", "wybug_author": "xfkxfk", "wybug_date": "2013-07-23 11:50", "wybug_open_date": "2013-09-06 11:50", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当", "认证设计不合理", "设计错误", "手机短信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-06：\t细节向公众公开  简要描述： 糯米网找回密码设计不当，导致任意用户密码重置漏洞 详细说明：  触屏板，点击找回密码，输入注册的手机号码：\n\n然后发送6位数字验证码到手机，这里还泄漏了用户的手机号码：\n\n然后我们随便输入一个6位数字验证码，进行抓包。由于这里没有对验证码的验证做任何限制，可以进行验证码爆破，我们跑了1000个，不到30秒就跑完了，很快看到跑出了正确的验证码，如下图中的返回长度可以判断：\n\n而且从返回的内容来看也能明显看出，爆出了正确的验证码：\n\n然后我们输入正确的验证码，看看返回的页面是否和上面一直：\n\n至此我们已经可以修改密码了！然后就没有然后。   漏洞证明：  见详细说明   修复方案：  最有效的就是限制验证码的验证次数。没有限制验证码有效时间，也没有限制次数，6位纯数字的爆破，是很快的。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2013-07-23 13:28 厂商回复： 感谢您对糯米网安全的关注，我们已经安排相关人员去处理。 最新状态： 2013-09-06：已经修复  ", "replys": "漏洞评价：\n评论\n     2013-07-23 12:03 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  。。擦，正准备在糯米网买团购呢。。    \n     2013-07-23 12:37 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  没事，你买吧，我没有重置你的密码    \n     2013-07-23 13:57 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @xfkxfk 你又不知道我的登录邮箱。    \n     2013-07-23 15:37 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @px1624 你告诉我吧，我不会告诉别人的    \n     2013-07-23 15:51 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @xfkxfk 其实我大概也知道你是怎么搞的。。    \n     2013-07-23 15:57 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @px1624 嗨，这个估计大家都知道吧    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}