{"id": 68451, "wybug_id": "wooyun-2015-0141674", "wybug_title": "伊利solr未授权访问", "wybug_corp": "yili.com", "wybug_author": "路人甲", "wybug_date": "2015-09-17 10:31", "wybug_open_date": "2015-11-01 10:50", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "默认配置不当", "服务配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-01：\t细节向公众公开  简要描述： 从小喝伊利长大的!!! 详细说明：  solr未授权访问http://wb.yili.com/solr/#/\n\n参考： WooYun: 中青宝solr外网可访问（泄露数据库密码）    漏洞证明：  \nawt.​toolkitsun.awt.X11.XToolkitconfiguration.​db.​nameossDevconfiguration.​db.​port27017configuration.​db.​server192.168.240.116file.​encodingUTF-8file.​encoding.​pkgsun.iofile.​separator/java.​awt.​graphicsenvsun.awt.X11GraphicsEnvironmentjava.​awt.​printerjobsun.print.PSPrinterJobjava.​class.​path/kingdee/jetty/resources/kingdee/jetty/lib/jetty-xml-8.1.8.v20121106.jar/kingdee/jetty/lib/servlet-api-3.0.jar/kingdee/jetty/lib/jetty-http-8.1.8.v20121106.jar/kingdee/jetty/lib/jetty-continuation-8.1.8.v20121106.jar/kingdee/jetty/lib/jetty-server-8.1.8.v20121106.jar/kingdee/jetty/lib/jetty-security-8.1.8.v20121106.jar/kingdee/jetty/lib/jetty-servlet-8.1.8.v20121106.jar/kingdee/jetty/lib/jetty-webapp-8.1.8.v20121106.jar/kingdee/jetty/lib/jetty-deploy-8.1.8.v20121106.jar/kingdee/jetty/lib/jetty-servlets-8.1.8.v20121106.jar/kingdee/jetty/lib/jetty-rewrite-8.1.8.v20121106.jar/kingdee/jetty/lib/jetty-jmx-8.1.8.v20121106.jar/kingdee/jetty/lib/jetty-ajp-8.1.8.v20121106.jar/kingdee/jetty/lib/jetty-jndi-8.1.8.v20121106.jar/kingdee/jetty/lib/jetty-plus-8.1.8.v20121106.jar/kingdee/jetty/lib/jndi/javax.activation-1.1.0.v201105071233.jar/kingdee/jetty/lib/jndi/javax.mail.glassfish-1.4.1.v201005082020.jar/kingdee/jetty/lib/jetty-annotations-8.1.8.v20121106.jar/kingdee/jetty/lib/annotations/javax.annotation-1.1.0.v201108011116.jar/kingdee/jetty/lib/annotations/org.objectweb.asm-3.1.0.v200803061910.jar/kingdee/jetty/lib/jetty-policy-8.1.8.v20121106.jar/kingdee/jetty/lib/jetty-client-8.1.8.v20121106.jar/kingdee/jetty/lib/jetty-websocket-8.1.8.v20121106.jar/kingdee/jetty/lib/jetty-overlay-deployer-8.1.8.v20121106.jar/kingdee/jetty/lib/ext/abdera-1.1.1.jar/kingdee/jetty/lib/ext/abdera-core-1.0.jar/kingdee/jetty/lib/ext/abdera-extensions-json-1.0.jar/kingdee/jetty/lib/ext/abdera-extensions-main-1.0.jar/kingdee/jetty/lib/ext/abdera-i18n-1.0.jar/kingdee/jetty/lib/ext/abdera-parser-1.0.jar/kingdee/jetty/lib/ext/activation-1.1.jar/kingdee/jetty/lib/ext/amqp-client-3.1.3.jar/kingdee/jetty/lib/ext/ant-1.8.1.jar/kingdee/jetty/lib/ext/antisamy-1.4.4.jar/kingdee/jetty/lib/ext/ant-launcher-1.8.1.jar/kingdee/jetty/lib/ext/antlr-2.7.7.jar/kingdee/jetty/lib/ext/aopalliance-1.0.jar/kingdee/jetty/lib/ext/asm-2.2.3.jar/kingdee/jetty/lib/ext/aspectjweaver.jar/kingdee/jetty/lib/ext/axiom-api-1.2.10.jar/kingdee/jetty/lib/ext/axiom-api-1.2.7.jar/kingdee/jetty/lib/ext/axiom-impl-1.2.10.jar/kingdee/jetty/lib/ext/axiom-impl-1.2.7.jar/kingdee/jetty/lib/ext/batik-anim.jar/kingdee/jetty/lib/ext/batik-bridge.jar/kingdee/jetty/lib/ext/batik-codec.jar/kingdee/jetty/lib/ext/batik-css.jar/kingdee/jetty/lib/ext/batik-dom.jar/kingdee/jetty/lib/ext/batik-ext.jar /kingdee/jetty/lib/ext/batik-extension.jar /kingdee/jetty/lib/ext/batik-gvt.jar /kingdee/jetty/lib/ext/batik-parser.jar /kingdee/jetty/lib/ext/batik-script.jar /kingdee/jetty/lib/ext/batik-svg-dom.jar /kingdee/jetty/lib/ext/batik-svggen.jar /kingdee/jetty/lib/ext/batik-transcoder.jar /kingdee/jetty/lib/ext/batik-util.jar /kingdee/jetty/lib/ext/batik-xml.jar /kingdee/jetty/lib/ext/bayeux-api-2.0.0.jar /kingdee/jetty/lib/ext/bcprov-jdk15-1.43.jar /kingdee/jetty/lib/ext/cas-client-core-3.2.0.jar /kingdee/jetty/lib/ext/com.kingdee.ssp.log.jar /kingdee/jetty/lib/ext/com.springsource.net.sf.cglib-2.2.0.jar /kingdee/jetty/lib/ext/cometd-java-client-2.0.0.jar /kingdee/jetty/lib/ext/cometd-java-common-2.0.0.jar /kingdee/jetty/lib/ext/cometd-java-oort-2.0.0.jar /kingdee/jetty/lib/ext/cometd-java-server-2.0.0.jar /kingdee/jetty/lib/ext/commonj.sdo_2.1.1.v200905221342.jar /kingdee/jetty/lib/ext/commons-beanutils-1.8.2.jar /kingdee/jetty/lib/ext/commons-codec-1.9.jar /kingdee/jetty/lib/ext/commons-collections-3.2.1.jar /kingdee/jetty/lib/ext/commons-dbcp-1.4.jar /kingdee/jetty/lib/ext/commons-digester-2.0.jar /kingdee/jetty/lib/ext/commons-email-1.2.jar /kingdee/jetty/lib/ext/commons-fileupload-1.2.2.jar /kingdee/jetty/lib/ext/commons-httpclient-3.1.jar /kingdee/jetty/lib/ext/commons-io-1.3.2.jar /kingdee/jetty/lib/ext/commons-jexl-2.1.1.jar /kingdee/jetty/lib/ext/commons-lang-2.4.jar /kingdee/jetty/lib/ext/commons-logging-1.1.1.jar /kingdee/jetty/lib/ext/commons-pool-1.6.jar /kingdee/jetty/lib/ext/commons-pool2-2.0.jar /kingdee/jetty/lib/ext/cron4j-2.2.5.jar /kingdee/jetty/lib/ext/cxf-2.2.10.jar /kingdee/jetty/lib/ext/cxf-manifest.jar /kingdee/jetty/lib/ext/cxf-xjc-boolean-2.2.10.jar /kingdee/jetty/lib/ext/cxf-xjc-bug671-2.2.10.jar /kingdee/jetty/lib/ext/cxf-xjc-dv-2.2.10.jar /kingdee/jetty/lib/ext/cxf-xjc-ts-2.2.10.jar /kingdee/jetty/lib/ext/dnsjava-2.1.3.jar /kingdee/jetty/lib/ext/dom4j-1.6.1.jar /kingdee/jetty/lib/ext/ezmorph-1.0.6.jar /kingdee/jetty/lib/ext/FastInfoset-1.2.7.jar /kingdee/jetty/lib/ext/freemarker-2.3.16.jar /kingdee/jetty/lib/ext/geronimo-activation_1.1_spec-1.0.2.jar /kingdee/jetty/lib/ext/geronimo-annotation_1.0_spec-1.1.1.jar /kingdee/jetty/lib/ext/geronimo-jaxws_2.1_spec-1.0.jar /kingdee/jetty/lib/ext/geronimo-jms_1.1_spec-1.1.1.jar /kingdee/jetty/lib/ext/geronimo-stax-api_1.0_spec-1.0.1.jar /kingdee/jetty/lib/ext/geronimo-ws-metadata_2.0_spec-1.1.2.jar /kingdee/jetty/lib/ext/gson-2.0.jar /kingdee/jetty/lib/ext/guava-16.0.1.jar /kingdee/jetty/lib/ext/guava-r04.jar /kingdee/jetty/lib/ext/htmlparser-1.0.5.jar /kingdee/jetty/lib/ext/httpasyncclient-4.0.jar /kingdee/jetty/lib/ext/httpclient-4.3.4.jar /kingdee/jetty/lib/ext/httpcore-4.3.2.jar /kingdee/jetty/lib/ext/httpcore-nio-4.3.jar /kingdee/jetty/lib/ext/httpmime-4.3.4.jar /kingdee/jetty/lib/ext/IKAnalyzer2012FF_u1.jar /kingdee/jetty/lib/ext/jackson-core-asl-1.7.4.jar /kingdee/jetty/lib/ext/jackson-jaxrs-1.5.3.jar /kingdee/jetty/lib/ext/jackson-mapper-asl-1.7.4.jar /kingdee/jetty/lib/ext/jackson-xc-1.5.3.jar /kingdee/jetty/lib/ext/javassist-3.6.0.GA.jar /kingdee/jetty/lib/ext/javax.inject-1.jar /kingdee/jetty/lib/ext/jaxb-api-2.1.jar /kingdee/jetty/lib/ext/jaxb-impl-2.1.13.jar /kingdee/jetty/lib/ext/jaxb-xjc-2.1.13.jar /kingdee/jetty/lib/ext/jaxen-1.1.1.jar /kingdee/jetty/lib/ext/jaxrs-api-1.2.1.GA.jar /kingdee/jetty/lib/ext/jdom.jar /kingdee/jetty/lib/ext/jedis-2.2.0.jar /kingdee/jetty/lib/ext/jettison-1.2.jar /kingdee/jetty/lib/ext/joda-time-1.6.jar /kingdee/jetty/lib/ext/jodconverter-2.2.2.jar /kingdee/jetty/lib/ext/jra-1.0-alpha-4.jar /kingdee/jetty/lib/ext/js-1.7R1.jar /kingdee/jetty/lib/ext/json-lib-2.1-jdk15.jar /kingdee/jetty/lib/ext/jsr311-api-1.0.jar /kingdee/jetty/lib/ext/jstl-1.2.jar /kingdee/jetty/lib/ext/juh-3.0.1.jar /kingdee/jetty/lib/ext/junit-4.8.1.jar /kingdee/jetty/lib/ext/jurt-3.0.1.jar /kingdee/jetty/lib/ext/jxls-core-1.0.2.jar /kingdee/jetty/lib/ext/jxls-reader-1.0.2.jar /kingdee/jetty/lib/ext/lucene-core-4.2.0.jar /kingdee/jetty/lib/ext/mail-1.4.4.jar /kingdee/jetty/lib/ext/mail-1.4.5.jar /kingdee/jetty/lib/ext/metrics-core-3.0.1.jar /kingdee/jetty/lib/ext/mina-1.0-fixed.jar /kingdee/jetty/lib/ext/mongo-java-driver-2.12.4.jar /kingdee/jetty/lib/ext/morph-1.1.1.jar /kingdee/jetty/lib/ext/morphia-0.99.jar /kingdee/jetty/lib/ext/mysql-connector-java-5.1.17-bin.jar /kingdee/jetty/lib/ext/neethi-2.0.4.jar /kingdee/jetty/lib/ext/nekohtml.jar /kingdee/jetty/lib/ext/ognl-3.0.jar /kingdee/jetty/lib/ext/opencsv-2.3.jar /kingdee/jetty/lib/ext/org.apache.log4j_1.2.15.v201005080500.jar /kingdee/jetty/lib/ext/oro-2.0.8.jar /kingdee/jetty/lib/ext/pdfbox-app-1.3.1.jar /kingdee/jetty/lib/ext/pinyin4j-2.5.0.jar /kingdee/jetty/lib/ext/poi-3.8-20120326.jar /kingdee/jetty/lib/ext/poi-ooxml-3.8-20120326.jar /kingdee/jetty/lib/ext/poi-ooxml-schemas-3.8-20120326.jar /kingdee/jetty/lib/ext/quartz-1.8.4.jar /kingdee/jetty/lib/ext/rabbitmq-client.jar /kingdee/jetty/lib/ext/ridl-3.0.1.jar /kingdee/jetty/lib/ext/saaj-api-1.3.jar /kingdee/jetty/lib/ext/saaj-impl-1.3.2.jar /kingdee/jetty/lib/ext/saxpath.jar /kingdee/jetty/lib/ext/scannotation-1.0.2.jar /kingdee/jetty/lib/ext/seil-common.jar /kingdee/jetty/lib/ext/sendcloud-sdk-1.0.7.jar /kingdee/jetty/lib/ext/serializer-2.7.1.jar /kingdee/jetty/lib/ext/slf4j-api-1.6.1.jar /kingdee/jetty/lib/ext/slf4j-log4j12-1.6.1.jar /kingdee/jetty/lib/ext/solr-solrj-4.2.0.jar /kingdee/jetty/lib/ext/spring-amqp-1.2.0.RELEASE.jar /kingdee/jetty/lib/ext/spring-aop-3.2.5.RELEASE.jar /kingdee/jetty/lib/ext/spring-aspects-3.2.5.RELEASE.jar /kingdee/jetty/lib/ext/spring-beans-3.2.5.RELEASE.jar /kingdee/jetty/lib/ext/spring-context-3.2.5.RELEASE.jar /kingdee/jetty/lib/ext/spring-context-support-3.2.5.RELEASE.jar /kingdee/jetty/lib/ext/spring-core-3.2.5.RELEASE.jar /kingdee/jetty/lib/ext/spring-erlang-1.2.0.RELEASE.jar /kingdee/jetty/lib/ext/spring-expression-3.2.5.RELEASE.jar /kingdee/jetty/lib/ext/spring-instrument-3.2.5.RELEASE.jar /kingdee/jetty/lib/ext/spring-jms-3.2.5.RELEASE.jar /kingdee/jetty/lib/ext/spring-orm-3.2.5.RELEASE.jar /kingdee/jetty/lib/ext/spring-oxm-3.2.5.RELEASE.jar /kingdee/jetty/lib/ext/spring-rabbit-1.2.0.RELEASE.jar /kingdee/jetty/lib/ext/spring-test-3.1.4.RELEASE.jar /kingdee/jetty/lib/ext/spring-test-3.2.5.RELEASE.jar /kingdee/jetty/lib/ext/spring-tx-3.2.5.RELEASE.jar /kingdee/jetty/lib/ext/spring-web-3.2.5.RELEASE.jar /kingdee/jetty/lib/ext/spring-webmvc-3.2.5.RELEASE.jar /kingdee/jetty/lib/ext/sqlite-jdbc-3.7.15-SNAPSHOT-2.jar /kingdee/jetty/lib/ext/stringtemplate-3.2.1.jar /kingdee/jetty/lib/ext/struts2-core-2.2.1.jar /kingdee/jetty/lib/ext/struts2-dojo-plugin-2.2.1.jar /kingdee/jetty/lib/ext/struts2-json-plugin-2.2.1.jar /kingdee/jetty/lib/ext/struts2-spring-plugin-2.2.1.jar /kingdee/jetty/lib/ext/tika-core-0.8.jar /kingdee/jetty/lib/ext/tiles-api-2.2.2.jar /kingdee/jetty/lib/ext/tiles-core-2.2.2.jar /kingdee/jetty/lib/ext/tiles-freemarker-2.2.2.jar /kingdee/jetty/lib/ext/tiles-jsp-2.2.2.jar /kingdee/jetty/lib/ext/tiles-servlet-2.2.2.jar /kingdee/jetty/lib/ext/tiles-template-2.2.2.jar /kingdee/jetty/lib/ext/unoil-3.0.1.jar /kingdee/jetty/lib/ext/urlrewritefilter-3.1.0.jar /kingdee/jetty/lib/ext/velocity-1.6.4.jar /kingdee/jetty/lib/ext/wsdl4j-1.6.2.jar /kingdee/jetty/lib/ext/wss4j-1.5.8.jar /kingdee/jetty/lib/ext/wstx-asl-3.2.9.jar /kingdee/jetty/lib/ext/xalan-2.7.1.jar /kingdee/jetty/lib/ext/xerces.jar /kingdee/jetty/lib/ext/xercesImpl-2.9.1.jar /kingdee/jetty/lib/ext/xml-apis.jar /kingdee/jetty/lib/ext/xml-apis-ext.jar /kingdee/jetty/lib/ext/xmlbeans-2.4.0.jar /kingdee/jetty/lib/ext/xml-resolver-1.2.jar /kingdee/jetty/lib/ext/XmlSchema-1.4.5.jar /kingdee/jetty/lib/ext/xmlsec-1.4.3.jar /kingdee/jetty/lib/ext/xpp3-1.1.4c.jar /kingdee/jetty/lib/ext/xstream-1.3.1.jar /kingdee/jetty/lib/ext/xwork-core-2.2.1.jar /kingdee/jetty/lib/jsp/com.sun.el-2.2.0.v201108011116.jar /kingdee/jetty/lib/jsp/javax.el-2.2.0.v201108011116.jar /kingdee/jetty/lib/jsp/javax.servlet.jsp.jstl-1.2.0.v201105211821.jar /kingdee/jetty/lib/jsp/javax.servlet.jsp-2.2.0.v201112011158.jar /kingdee/jetty/lib/jsp/org.apache.jasper.glassfish-2.2.2.v201112011158.jar /kingdee/jetty/lib/jsp/org.apache.taglibs.standard.glassfish-1.2.0.v201112081803.jar /kingdee/jetty/lib/jsp/org.eclipse.jdt.core-3.7.1.jar /kingdee/jetty/lib/jta/javax.transaction-1.1.1.v201105210645.jar /kingdee/jetty/lib/monitor/jetty-monitor-8.1.8.v20121106.jar /kingdee/jetty/lib/spdy/spdy-core-8.1.8.v20121106.jar /kingdee/jetty/lib/spdy/spdy-jetty-8.1.8.v20121106.jar /kingdee/jetty/lib/spdy/spdy-jetty-http-8.1.8.v20121106.jar /kingdee/jetty/lib/jetty-util-8.1.8.v20121106.jar /kingdee/jetty/lib/jetty-io-8.1.8.v20121106.jarjava.​class.​version51.0java.​endorsed.​dirs/kingdee/jdk/jre/lib/endorsedjava.​ext.​dirs/kingdee/jdk/jre/lib/ext/usr/java/packages/lib/extjava.​home/kingdee/jdk/jrejava.​io.​tmpdir/tmp/solrjava.​library.​path/usr/java/packages/lib/amd64/usr/lib64/lib64/lib/usr/libjava.​runtime.​nameJava(TM) SE Runtime Environmentjava.​runtime.​version1.7.0_60-b19java.​specification.​nameJava Platform API Specificationjava.​specification.​vendorOracle Corporationjava.​specification.​version1.7java.​vendorOracle Corporationjava.​vendor.​urlhttp://java.oracle.com/java.​vendor.​url.​bughttp://bugreport.sun.com/bugreport/java.​version1.7.0_60java.​vm.​infomixed modejava.​vm.​nameJava HotSpot(TM) 64-Bit Server VMjava.​vm.​specification.​nameJava Virtual Machine Specificationjava.​vm.​specification.​vendorOracle Corporationjava.​vm.​specification.​version1.7java.​vm.​vendorOracle Corporationjava.​vm.​version24.60-b09jetty.​home/kingdee/jettyline.​separator\\nlog4j.​configurationfile:/kingdee/jetty/domains/solr/etc/log4j.propertiesos.​archamd64os.​nameLinuxos.​version2.6.32-431.el6.x86_64path.​separator:solr.​solr.​home/kingdee/jetty/domains/solr/solrsun.​arch.​data.​model64sun.​boot.​class.​path/kingdee/jdk/jre/lib/resources.jar/kingdee/jdk/jre/lib/rt.jar/kingdee/jdk/jre/lib/sunrsasign.jar/kingdee/jdk/jre/lib/jsse.jar/kingdee/jdk/jre/lib/jce.jar/kingdee/jdk/jre/lib/charsets.jar/kingdee/jdk/jre/lib/jfr.jar/kingdee/jdk/jre/classessun.​boot.​library.​path/kingdee/jdk/jre/lib/amd64sun.​cpu.​endianlittlesun.​cpu.​isalistsun.​io.​unicode.​encodingUnicodeLittlesun.​java.​command/kingdee/jetty/start.jar OPTIONS=All /kingdee/jetty/domains/solr/etc/jetty.xml /kingdee/jetty/domains/solr/etc/jetty-deploy.xml /kingdee/jetty/domains/solr/etc/jetty-logging.xmlsun.​java.​launcherSUN_STANDARDsun.​jnu.​encodingUTF-8sun.​management.​compilerHotSpot 64-Bit Tiered Compilerssun.​os.​patch.​levelunknownuser.​countryUSuser.​dir/kingdee/jetty/domains/solruser.​home/rootuser.​languageenuser.​namerootuser.​timezonePRC\n   修复方案：  我是来找礼物的！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2015-09-17 10:48 厂商回复： 谢谢你的发现，我们会尽快处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}