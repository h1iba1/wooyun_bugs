{"id": 713, "wybug_id": "wooyun-2014-074341", "wybug_title": "cnzz任意用户密码重置", "wybug_corp": "cnzz.com", "wybug_author": "看风者", "wybug_date": "2014-08-29 15:41", "wybug_open_date": "2014-10-13 15:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "2", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄露", "认证缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-13：\t细节向公众公开  简要描述： cnzz任意用户密码重置 详细说明：  有点鸡肋，因为爆破需要一定运算量但是，很大大型网站都在用cnzz,这个代价还是值得的首先我们注册个cnzz的统计帐号然后找回密码进入邮箱，可以看到找回密码链接是：http://i.cnzz.com/main.php?c=findpwd&a=modifypwd&checknum=b98925768cb6bf127846056d86[马赛克]&id=[马赛克]656&tmp=4840268a511ba2e&sendtype=email 我们把tmp=XXXX去掉，输入到浏览器，依旧可以打开密码重置页面，说明这两个参数无用然后我们再用burp循环跑这个连接10000次，手动打开这个链接，还能打开密码重置，这说明cnzz没有防重复提交，给我们爆破创造了条件下面分析变量id发送几次找回密码的邮件，发现这个id是递增的，ok，这个变量也pass,下次用这个id+1即可（保险起见，可以先发送给自己注册的帐号一次,再爆破某个邮箱一次，再发送给自己一次)，如果第一次和第三次的id相隔2，那就说明猜对id了好了，到了最关键的checknum了，这个数字看起来就像md5,丢到cmd5里一看，果然是，而且是4位的，包括数字和小写字母的组合这就简单了，用python写个循环，得到所有可能，然后丢到burp里跑就ok了不过这还不完美，毕竟(26+10)^4数量上百万了,主要看人品...所以有点鸡肋，除非对方的站特别重要(毕竟服务的客户不是普通人，是是各大网站)   漏洞证明：  \n\n   修复方案：  你们更专业   版权声明：转载请注明来源 看风者@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2014-09-01 14:43 厂商回复： 感谢您对我们的支持与关注，该问题我们正在修复~~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-29 18:51 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  自己提交的漏洞，在标题里面说自己思路不错的。。。    \n     2014-08-29 19:04 |    \t\t看风者 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:14        | To shun evil is understanding)\t\t \n  @猪猪侠，我没写………某位管理员改的………    \n     2014-08-29 20:07 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @看风者 打死那个管理员！    \n     2014-09-01 17:18 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  应该写 思路不错 by 管理员 哈哈    \n     2014-09-01 17:32 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @袋鼠妈妈 @看风者 @猪猪侠 思路不错。。。厂商就给你这思路2rank    \n     2014-09-09 15:02 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:61        | 工作需要，暂别一段时间)\t\t \n  思路不错~    \n     2014-10-13 16:36 |    \t\tB1acken \t\t\t( 普通白帽子  |\t\t\t        Rank:174 漏洞数:56        | 渣渣)\t\t \n  思路不错    \n     2014-10-13 18:12 |    \t\t风花雪月 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:44        | []+[]|[]-[][][][][]%[][]|[]\\[]%[][]|[]\\[...)\t\t \n  才2 rank  打死厂商把！    \n     2014-10-13 20:39 |    \t\t黑侠 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 帮助别人，等于帮助自己)\t\t \n  才2 rank 打死厂商把！     \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}