{"id": 59210, "wybug_id": "wooyun-2014-048243", "wybug_title": "百度杀毒自我修复工具的拒绝服务漏洞", "wybug_corp": "百度", "wybug_author": "zhq445078388", "wybug_date": "2014-01-08 11:30", "wybug_open_date": "2014-04-08 11:30", "wybug_type": "拒绝服务", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-08：\t细节向公众公开  简要描述： 百度杀毒的自我修复工具的一处简单判断导致了拒绝服务 详细说明：  问题出在BaiduSdRepair.exe上.该程序会检测百度杀毒的主要程序.然后进行修复但是在一开始执行了\nv4 = OpenMutexW(0x1F0001u, 0, L\"{63900534-10AB-4c30-B0D4-95D6B65A0B74}\");  if ( v4 )  {    CloseHandle(v4);  } else  {    hObject = CreateMutexW(0, 0, L\"{63900534-10AB-4c30-B0D4-95D6B65A0B74}\");    if ( hObject )    {      if ( GetLastError() == 183 )      {        if ( hObject )        {          CloseHandle(hObject);          hObject = 0;        }      }      else      {        v7 = 1;        GetCommandLineW();        v5 = sub_401420(&v7);        if ( v5 )        {          sub_404160(&v8);          v12 = 0;          v9 = v5;          sub_4031D0();          sub_403920(&v10);          sub_403310(&v10);          sub_403090();          sub_4014B0();          if ( hObject )            CloseHandle(hObject);          v12 = -1;          sub_4040F0(&v8);        }        else        {          if ( hObject )            CloseHandle(hObject);          GetLastError();        }      }    }  }\n其他的地方处理的很好.但是导致如果系统中存在{63900534-10AB-4c30-B0D4-95D6B65A0B74}则该修复就起不来了   漏洞证明：  CreateMutex (NULL, FALSE, TEXT(\"{63900534-10AB-4c30-B0D4-95D6B65A0B74}\"));上面一行代码就可以让该程序起不来   修复方案：  普通程序使用OpenMutex进行防多开可以.但是对于安全软件来说.这是一个致命问题..建议使用其他方法防多开.或者直接就不用防多开(反正处理也很快)   版权声明：转载请注明来源 zhq445078388@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-01-08 14:29 厂商回复： 感谢提交，业务方已经开始处理此问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-08 11:45 |    \t\tzhq445078388 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:19        | 请牢记\"杀进程点康姆\")\t\t \n  当Open发现存在时,可以检索系统进程,查看所有进程的句柄,如果发现不是自己的程序的.那么说明是一个攻击.将该程序的该句柄关掉.然后重启自身.一般就行了.或者弹窗提示XX程序尝试攻击百度杀毒之类的    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}