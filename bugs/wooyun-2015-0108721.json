{"id": 44624, "wybug_id": "wooyun-2015-0108721", "wybug_title": "Coding平台未限制数据库跨应用访问+某方式泄漏密码", "wybug_corp": "coding.net", "wybug_author": "iLtc", "wybug_date": "2015-04-19 11:35", "wybug_open_date": "2015-04-19 12:45", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["跨应用访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： Coding 平台演示功能为每个应用提供了数据库服务，但是该服务没有限制跨应用访问，获得其他应用的数据库用户名和密码后可以直接访问。 详细说明：  Coding 平台演示功能为每个应用提供了数据库服务，但是该服务没有限制跨应用访问，获得其他应用的数据库用户名和密码后可以直接访问。同时根据演示平台的说明，数据库的信息是被写进环境变量的，当应用意外的输出了环境变量以后，即可轻易的拿到数据库用户名和密码。我们找到一个恰好出错显示出了这些信息的应用来演示。页面地址 http://joshell.coding.io/joshell ，打开页面以后看到的是  NotFoundHttpException错误 ，下面显示出了环境变量，我们很容易的找到了数据库信息（以下只展示了MySQL的部分信息，Redis部分全部省略）：\n{\"mysql\":[{\"name\":\"commy-mysql\",\"label\":\"mysql\",\"tags\":[\"mysql\"],\"plan\":\"default\",\"credentials\":{\"hostname\":\"10.9.1.***\",\"port\":3306,\"name\":\"cf_082c8f00_9f4f_481a_b6f8_***\",\"username\":\"qzgIlkpXmNtrwYW3\",\"password\":\"EZvyGidCWMg***\",\"uri\":\"mysql://qzgIlkpXmNtrwYW3:EZvyGidCWMg***@10.9.1.***:3306/cf_082c8f00_9f4f_481a_b6f8_***?reconnect=true\",\"jdbcUrl\":\"jdbc:mysql://10.9.1.***:3306/cf_082c8f00_9f4f_481a_b6f8_***?user=qzgIlkpXmNtrwYW3&password=EZvyGidCWMg***\"}}],\"redis-2.6\":[*******],\"filesystem-1.0\":[{\"name\":\"commy-file\",\"label\":\"filesystem-1.0\",\"tags\":[\"filesystem\",\"filesystem-1.0\",\"Persistent filesystem\"],\"plan\":\"default\",\"credentials\":{\"host_path\":\"/home/vcap/fs/078f42a123***\"}}]}\n\n\n从中我们不难看出，MySQL 数据库的连接信息是：数据库地址：10.9.1.***用户名：qzgIlkpXmNtrwYW3密码：EZvyGidCWMg***接下来我们自己建一个应用，上传 phpMyAdmin 的代码，注意在 phpMyAdmin 的配置文件中将数据库地址设为 10.9.1.*** ，也就是：\n$cfg['Servers'][$i]['host'] = '10.9.1.***';\n上传代码，启用演示功能，再部署代码到演示平台，打开演示平台测试效果，输入用户名和密码，成功登陆：\n\n打开一个数据库，可以看到各种数据表：\n\n打开一个数据表，可以看到一些明文存放的用户数据：\n\n   漏洞证明：  \n\n\n\n\n\n\n\n   修复方案：  要求用户的所有应用都都不泄露环境变量是不太现实的，但是像一些 PaaS 平台那样禁止跨应用访问应该还是可以做到的吧？   版权声明：转载请注明来源 iLtc@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-04-19 12:45 厂商回复： 感谢您对  安全的关注， 由于演示平台产品定位是非生产环境1) 跨应用数据库访问是默认允许的。2) 显示ENV信息一般是用户打开了DEBUG模式，这个我们会对用户进行更好的说明 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-19 11:40 |    \t\t無名老人 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:3        | 干过开发，日过渗透，江湖人称： 少女杀手)\t\t \n  appid？    \n     2015-04-19 12:26 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  coding.net速度很快！    \n     2015-04-19 13:45 |    \t\tca1n \t\t\t( 普通白帽子  |\t\t\t        Rank:100 漏洞数:22        | not yet)\t\t \n  细节在哪。。。    \n     2015-04-19 15:13 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @ca1n bug    \n     2015-04-19 18:23 |    \t\tzcy \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:15        )\t\t \n  @xsser 最近bug很严重    \n     2015-04-19 23:56 |    \t\tDeadSea \t\t\t( 实习白帽子  |\t\t\t        Rank:86 漏洞数:28        | 静心)\t\t \n  @疯狗 为啥木有细节 细节一点都不给，还说要打我    \n     2015-04-20 12:17 |    \t\t只发通用型 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:14        | 刷通用型奖金小号)\t\t \n  = =获得其他应用的数据库用户名和密码后可以直接访问。那你来黑我啊gctf.coding.io    \n     2015-04-20 14:31 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @只发通用型 给个phpinfo    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}