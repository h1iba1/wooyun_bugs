{"id": 62145, "wybug_id": "wooyun-2013-036717", "wybug_title": "9158视频客户端DLL劫持", "wybug_corp": "天格科技（杭州）", "wybug_author": "YY-2012", "wybug_date": "2013-09-11 11:55", "wybug_open_date": "2013-12-10 11:56", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "低", "wybug_rank_0": "2", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "设计错误", "客户端程序设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-10：\t厂商提前公开漏洞，细节向公众公开  简要描述： 测试版本为：6.0.0.3（9月10日为最新版本）在加载DLL文件时考虑不周导致可能的DLL劫持攻击，对用户造成潜在的安全隐患。 详细说明：  9158多人视频客户端默认安装路径：C:\\Program Files\\9158KTV\\具体利用方法：9158.exe运行时会加载一个不存在的DLL文件ieframe.dll，只要自己写一个ieframe.dll与9158.exe放在同一目录，这样就可以在运行9158.exe的时候会同时加载ieframe.dll，这个ieframe.dll可以为自制的任意恶意dll。此方法可用于劫持启动木马病毒。（我这里放入特定的dll后，运行9158.exe会弹出一个特定的框显示\"Hello from MyDLL!\"，如下图）    漏洞证明：  \n\n\n\n   修复方案：  你们比我懂！   版权声明：转载请注明来源 YY-2012@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-09-11 13:31 厂商回复： 感谢乌云白帽子的反馈，我们正在修复该问题 最新状态： 2013-09-11：经过确认，我们不认为这个属于漏洞，这个问题涉及到dll装载目录优先级别。DLL装载目录顺序：1.The directory where the executable module for the current process is located. 2.The current directory. 3.The Windows system directory. The GetSystemDirectory function retrieves the path of this directory. 4.The Windows directory. The GetWindowsDirectory function retrieves the path of this directory. 5.The directories listed in the PATH environment variable.我们所调用的dll是system目录下，白帽子在程序安装目录下放置一个同名dll，调用时这个dll级别比系统目录的dll优先级高。现公布这个漏洞，也希望wooyun的白帽子一起讨论下这个case是否属于漏洞。  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}