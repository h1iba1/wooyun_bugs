{"id": 16912, "wybug_id": "wooyun-2015-0116868", "wybug_title": "中国邮政储蓄银行网银系统任意文件包含漏洞", "wybug_corp": "中国邮政储蓄银行", "wybug_author": "Drizzle.Risk", "wybug_date": "2015-05-29 09:39", "wybug_open_date": "2015-07-16 10:24", "wybug_type": "文件包含", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取", "配置不当", "文件包含漏洞", "文件包含漏洞利用技巧", "通用漏洞", "网银系统"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向公众公开  简要描述： 之前发的科蓝的网银通用漏洞，貌似都没注册厂商，估计也不重视，个人觉得这个漏洞风险还是很高的，所以随便找了家大银行当案例。邮储妹子，对不住了 :-) 详细说明：  背景：_viewReferer是之前测试CSII网银时发现的一个隐藏的参数，伴随着CSII开发的网银的各个功能进行传递，根据测试与观察，判定其功能为页面出现错误时，需要跳转加载的某JSP页面，其值是预先设置的，可能是错误处理提示页面，也可能是上一个功能页面。找到了一个合适的不需要登录就能利用漏洞的地址：https://pbank.psbc.com/pweb/GetUserNickNamePre.do?_locale=zh_CN&BankId=9999\n\n具体漏洞原理就不再赘述了，直接进入正题：如下图所示，我们删除其他参数，主动让程序产生错误，并且我们在此处强制加上了_viewReferer参数，进行参数内容覆写。结果我们可以看到，程序报错，并且尝试加载我们覆写的文件名（根目录下的js文件）：\n\n继续利用，读取web.xml\n\n\n\n就不继续进行了，你们懂的。   漏洞证明：  详见漏洞说明，可模仿发包重现。   修复方案：  推荐还是联系开发商更新代码，或自己修改代码（可能比较复杂，因为几乎每个功能都存在这个参数变量）。同时修改目录和文件权限（这个可以暂时防范攻击，但治标不治本）。   版权声明：转载请注明来源 Drizzle.Risk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-06-01 10:23 厂商回复： 多谢提醒，已整改完成 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-29 09:45 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  另一个没审核呢？    \n     2015-05-29 10:39 |    \t\txiya \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n  围观！    \n     2015-05-29 10:52 |    \t\t蓝颜 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:29        )\t\t \n  随便 好一个随便    \n     2015-05-29 11:19 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  膜拜 来参加众测吧    \n     2015-05-29 12:37 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  @xsser :-)    \n     2015-05-29 15:26 |    \t\tCplusHua \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:33        | 乌云奖金:-1)\t\t \n  随便 好一个随便    \n     2015-05-29 15:49 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  必须膜拜    \n     2015-05-29 16:22 |    \t\tYang \t\t\t( 普通白帽子  |\t\t\t        Rank:247 漏洞数:86        | 作为菜鸟，大米手机摔破了怎么办？)\t\t \n  这个好，作为邮政的临时工，我不想吐槽邮政内部各种XXOO了    \n     2015-06-01 10:24 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Yang 来 挖点邮政洞    \n     2015-06-01 10:51 |    \t\tp0di \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:17        | 1+1 = 2 ？)\t\t \n  @Drizzle.Risk @xiya 为何这么风骚.    \n     2015-06-01 11:39 |    \t\tYang \t\t\t( 普通白帽子  |\t\t\t        Rank:247 漏洞数:86        | 作为菜鸟，大米手机摔破了怎么办？)\t\t \n  @xsser 要是可以～恨不得全部xxoo一遍～可是菜鸟就是我，实属无奈～    \n     2015-06-01 12:43 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  跟中行一样扣啊，才给7Rank.. 配置文件和class文件都被看光光了呢    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}