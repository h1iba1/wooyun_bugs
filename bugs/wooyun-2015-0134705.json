{"id": 70619, "wybug_id": "wooyun-2015-0134705", "wybug_title": "互联网第一金融原形金融设计缺陷导致用户账户安全", "wybug_corp": "深圳市原形互联网金融服务有限公司", "wybug_author": "路人甲", "wybug_date": "2015-08-17 14:33", "wybug_open_date": "2015-10-03 09:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-03：\t细节向公众公开  简要描述： 互联网第一金融原形金融设计缺陷导致用户账户安全 详细说明：  原先漏洞没有通过，原因说是没有爆破成功，其实我就是懒，没有爆破啊\n\n原形金融 https://www.yuancredit.com/ 登陆的时候，提示过于明显，可探测账号是否存在 账号不存在时，提示账号不存在 \n\n 账号存在时，提示用户名或密码错误，那其实就是密码错误了 \n\n 探测到账号信息，接下来就是爆破登陆了，然后登陆有验证码 但是验证码此处设计缺陷，可以绕过进行爆破 此处的验证码，在提示用户名或密码错误后，验证码不刷新，即可以重复使用。所以可以直接进行爆破 如图我们固定验证码为GFFN不变，burp直接跑密码 \n\n可以跑出密码，登陆成功 \n\n   漏洞证明：  现在补充下登陆成功案例首先是要找账号对不对，账号就是手机那想到的最先就是爆破手机号啊，下载个手机号生成器，然后开始跑用户名\n\n可悲的是，跑出的成功率不高啊于是想着换个方法收集账号信息发现原型金融注册登陆后，实名后需要开通易宝支付，那我估摸着，如果找到易宝的手机号信息，那么也应该是原形的账号咯？于是去乌云上收集 WooYun: 卡易拍平台泄露了用户充值的手机号 在这个漏洞中有一些图片\n\n可以看到部分号码，剩下的爆破，没错，还真找到有效的号码了不过这样收集到的也不多，再继续看看网站自身有没有泄露的通过google，可以找到这样的信息https://www.yuancredit.com/webChildrenDay/\n\n下面手机号也是被屏蔽的，一开始傻了，也就是爆破中间的数字信息，坑爹的，半天才爆破几个后来就抓了下包\nPOST /actBirImg/getAllActBirImg HTTP/1.1Host: www.yuancredit.comConnection: keep-aliveContent-Length: 35Accept: application/json, text/javascript, */*; q=0.01X-Requested-With: XMLHttpRequestOrigin: https://www.yuancredit.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Maxthon/4.4.6.2000 Chrome/30.0.1599.101 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8DNT: 1Referer: https://www.yuancredit.com/webChildrenDay/Accept-Encoding: gzip,deflateAccept-Language: zh-CNCookie: username1=\"1xxxxxxx,0\"; JSESSIONID=77A63A145982B6F86E1347141D7972BBcustMbl=&firstResult=0&maxResults=8\n直接出来手机号信息了\n\n然后将收集到的手机号当做账号，由于验证码缺陷，跑密码字典最后出来了几个不知道够不够了\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-08-19 09:47 厂商回复： 感谢路人甲们，漏洞存在，正在修复。此漏洞的利用需要暴力破解，影响范围有限，所以Rank 5. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}