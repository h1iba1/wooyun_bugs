{"id": 47094, "wybug_id": "wooyun-2014-082014", "wybug_title": "cmseasy设计逻辑缺陷可以不花钱买东西", "wybug_corp": "cmseasy", "wybug_author": "menmen519", "wybug_date": "2014-11-07 12:00", "wybug_open_date": "2015-02-05 12:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向公众公开  简要描述： cmseasy设计逻辑缺陷可以不花钱买东西 详细说明：  archive_act.php:\nfunction orders_action() {        $this->view->aid = trim(front::get('aid'));        if (front::post('submit')) {            $this->orders = new orders();            $row = $this->orders->getrow(\"\",\"adddate DESC\");            //var_dump(time());            if($row['adddate'] && time() - $row['adddate'] <= intval(config::get('order_time'))){                alerterror('操作频繁,请稍后再试');                return;            }            if (front::$post['telphone'] == '') {                alerterror('联系电话为必填！');                return;            }            front::$post['mid'] = $this->view->user['userid'] ? $this->view->user['userid'] : 0;            front::$post['adddate'] = time();            front::$post['ip'] = front::ip();            if (isset(front::$post['aid'])) {                $aidarr = front::$post['aid'];                unset(front::$post['aid']);                foreach ($aidarr as $val) {                    front::$post['aid'].=$val . ',';                    front::$post['pnums'].=front::$post['thisnum'][$val] . ',';                }            } else {                front::$post['aid'] = $this->view->aid;            }            if (!isset(front::$post['logisticsid']))                front::$post['logisticsid'] = 0;            front::$post['oid'] = date('YmdHis') . '-' . front::$post['logisticsid'] . '-' . front::$post['mid'] . '-' . front::$post['payname'];                        $insert = $this->orders->rec_insert(front::$post);\n这时候 我们跟进去看看：这里的条件是填写完整的订单信息，然后默认订单状态为零 就是未支付状态那么这里又没有对$post传递过来的参数做unset处理，也就是说这里我们可以传入订单的状态订单分为六个状态 新订单为0完成所有选项的状态为1那么我们发送url:http://localhost/uploads/index.php?case=archive&act=orders&aid=10postdata:pnums=1&pname=xxx&telphone=1111&address=1111111111111&status=1&postcode=710000&content=xxx&submit=+%E6%8F%90%E4%BA%A4+\n\n然后后台查看订单状态：\n\nok！！！！   漏洞证明：     修复方案：     版权声明：转载请注明来源 menmen519@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2014-11-07 13:01 厂商回复： 漏洞已经在360复现 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-07 12:32 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  通用大神,请手下我的膝盖!    \n     2014-11-07 13:18 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  http://loudong.360.cn/vul/info/id/31546http://loudong.360.cn/vul/info/id/31552厂商说的是不是这俩？    \n     2014-11-08 16:28 |    \t\tcmseasy(乌云厂商)\t\t \n  @phith0n 是的。@menmen519  感谢你对我们程序的支持。近期将对数据查询做出调整，对以前程序的查询方式进行修改，发布后希望白帽子能够给我们指出相关问题。我们会及时处理。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}