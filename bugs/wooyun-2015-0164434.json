{"id": 76637, "wybug_id": "wooyun-2015-0164434", "wybug_title": "雨润集团微软邮件系统设计逻辑缺陷导致敏感信息泄露", "wybug_corp": "雨润集团", "wybug_author": "萨瓦迪卡", "wybug_date": "2015-12-28 00:08", "wybug_open_date": "2016-02-12 18:49", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "邮件爆破", "商业秘密"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-12：\t细节向公众公开  简要描述： 雨润集团微软邮件系统设计逻辑缺陷导致敏感信息泄露 详细说明：  雨润集团使用的是微软企业邮件系统，在测试过程中发现微软邮件系统爆破方式或者说微软邮件系统处理用户登陆请求的过程比较不同，所以拿出来分享一下。   漏洞证明：  本来准备上传视频 ，无奈智商有限，不太会1、登陆首页\n\n2、微软邮件系统处理登陆请求过程分析\n和常规不一样，登陆请求一共有两个请求包，两个两个响应包，决定登陆是否成功：（1）、第一个请求包：POST /owa/auth/owaauth.dll HTTP/1.1Host: **.**.**.**Content-Length: 123Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://**.**.**.**Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.157 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://**.**.**.**/owa/auth/logon.aspx?url=http://**.**.**.**/owa/&reason=2Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8destination=http%3A%2F%2F**.**.**.**%2Fowa%2F&flags=4&forcedownlevel=0&trusted=0&username=admin&password=123456&isUtf8=1（2）、第一个响应包：HTTP/1.1 302 Moved TemporarilyServer: nginx/1.2.4Date: Thu, 24 Dec 2015 14:02:14 GMTContent-Length: 0Connection: keep-aliveLocation: http://**.**.**.**/owa/Set-Cookie: sessionid=e9ce68d6-8fec-42a4-9668-e069c273b8a9; path=/Set-Cookie: cadata=\"6Rs68V1R/wG/aoN6RnGAe650Mx2TWX/PxL87OkWTxlG0+XWKkEc4Dag==\"; HttpOnly; path=/（3）、第二个请求包：GET /owa/ HTTP/1.1Host: **.**.**.**Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2403.157 Safari/537.36Referer: http://**.**.**.**/owa/auth/logon.aspx?url=http://**.**.**.**/owa/&reason=2Accept-Encoding: gzip, deflate, sdchAccept-Language: zh-CN,zh;q=0.8Cookie: sessionid=e9ce68d6-8fec-42a4-9668-e069c273b8a9; cadata=\"6Rs68V1R/wG/aoN6RnGAe650Mx2TWX/PxL87OkWTxlG0+XWKkEc4Dag==\"（4）、第二个响应包：HTTP/1.1 302 Moved TemporarilyServer: nginx/1.2.4Date: Thu, 24 Dec 2015 14:02:39 GMTContent-Length: 0Connection: keep-aliveLocation: http://**.**.**.**/owa/auth/logon.aspx?url=http://**.**.**.**/owa/&reason=2Set-Cookie: sessionid=; path=/; expires=Thu, 01-Jan-1970 00:00:00 GMTSet-Cookie: cadata=; path=/; expires=Thu, 01-Jan-1970 00:00:00 GMT\n分析知道，第二个请求包需要第一个响应包的结果作为请求的参数内容3、截断第一个请求包\n\n4、截断第二个请求包\n\n5、第一个响应包正则表达式处理\n\n\n\n6、爆破成功\n\n\n\n7、大量商业秘密\n\n\n\n破解成功的账号密码：liuli/123456(密码已被修改)   修复方案：  1、添加验证码2、增加锁定机制，锁定IP地址3、升级微软邮件系统   版权声明：转载请注明来源 萨瓦迪卡@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-12-31 18:15 厂商回复： CNVD确认所述情况，已由CNVD通过网站管理方公开联系渠道向其邮件通报，由其后续提供解决方案。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}