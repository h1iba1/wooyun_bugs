{"id": 21022, "wybug_id": "wooyun-2015-0115276", "wybug_title": "华住酒店官网某严重逻辑漏洞可登陆任意账号（涉及任意用户账号个人基本信息、入住记录等）", "wybug_corp": "汉庭酒店", "wybug_author": "Looke", "wybug_date": "2015-05-21 11:01", "wybug_open_date": "2015-07-05 15:34", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-05：\t细节向公众公开  简要描述： 昨天520，是向女神表白的好日子，但哥的女神拒了我，却和别人约了，相约走进了禧玥。哥一下子就受打击了，这怎么能忍，心情久久不能平静。誓要找到仇敌，然后干掉他。于是我打开电脑，找到了女神经常去的华住，输入女神的手机号，就从这儿开始这个宏伟的计划吧。-------------------------------------------------------------------------------该漏洞危急旗下（包括商旅品牌——禧玥酒店、全季酒店、星程酒店、汉庭酒店、海友酒店，以及度假品牌——漫心度假酒店）所有会员账号，想查女神的开房信息、秒变变金会员、土豪联系方式及信用卡信息等等，哥都可以满足你。（指谁打谁） 详细说明：  这个漏洞比较奇葩，一个重置密码导致的后果。在官网上看了一下，华住会员有4900W,以人均10次历史开房信息，则可泄漏5亿条的开房信息，严重性不可估量。\n洞主的较乱 整理了下步骤如下：1、用目标账号进行找回密码操作的第一步2、然后直接带着cookie post请求修改密码即可\n\n\n过程如下：一、 首先，在忘记密码处，输入自己的手机号，进入下一步，输入收到的验证码及图片码。\n\n点击下一步，此时截该包的返回包，保存该包。\n\n二、返回到忘记密码页，输入要更改账号的手机号及图片验证码。我以13888888888土豪手机号作示例。\n\n点击下一步，此时抓该包的返回包，复制返回的某个参数，替换掉已保存包的这个参数。此时直接输入重置密码及确认密码。\n\n修改成功。\n\n直接略过第二步的短信验证码，到第三步，修改密码成功。写个脚本即可批量重置密码，查询各种信息。如个人基本信息、和小三的开房信息、有信用卡的信用卡信息，秒变金会员、积分任意兑换等。   漏洞证明：  测试手机号13888888888：\n\n\n\n\n\n\n\n   修复方案：  导致密码重置的原因在于对用户的身份信息本地保存且未加同步值。修复方法：1、对重要参数加入验证码同步信息或时间戳；2、服务器端对第三步用户提交参数作校验。   版权声明：转载请注明来源 Looke@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-05-21 15:33 厂商回复： 谢谢关注，已安排紧急修复 最新状态： 2015-05-27：己修复，谢谢  ", "replys": "漏洞评价：\n评论\n     2015-05-21 11:02 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  昨晚开过房的都蒙了    \n     2015-05-21 11:02 |    \t\tsauren \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:10        | 天天打DOTA，快乐你我他~)\t\t \n  我靠，火钳刘明。爽大了    \n     2015-05-21 11:08 |    \t\tTon7BrEak \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:43        | 吃苦耐劳，我只会第一个！)\t\t \n  昨天左手牵右手~很开心的一天啊~    \n     2015-05-21 11:11 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  昨晚开过房的都蒙了，666    \n     2015-05-21 11:13 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  CCAV看这里！    \n     2015-05-21 11:17 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  5月20号，高级大床房，我擦    \n     2015-05-21 11:18 |    \t\t高小厨 \t\t\t( 普通白帽子  |\t\t\t        Rank:814 漏洞数:74        | 不会吹牛的小二不是好厨子！)\t\t \n  我靠，这都不给闪电！！！！！！！！！！！！！！！！！！    \n     2015-05-21 11:22 |    \t\t我能拒绝么 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 疯爆志林)\t\t \n  CCAV不插不舒服斯基    \n     2015-05-21 11:36 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  一楼懵了    \n     2015-05-21 11:39 |    \t\tCh丶0nly \t\t\t( 普通白帽子  |\t\t\t        Rank:205 漏洞数:50        | 专注网络30年。)\t\t \n  要任意登陆你得知道对方手机号  这有点鸡肋  所以不给闪电    \n     2015-05-21 11:41 |    \t\t咸鱼翻身 \t\t\t( 普通白帽子  |\t\t\t        Rank:576 漏洞数:108        )\t\t \n  屌丝在旁边呵呵一笑，泄了又怎样，老子从来不开房。哇哈哈哈哈    \n     2015-05-21 12:14 |    \t\t依剑听雨 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 转身，梅子黄时雨。)\t\t \n  (｡･∀･)ﾉﾞ嗨 火钳刘明！！！！    \n     2015-05-21 12:14 |    \t\t高小厨 \t\t\t( 普通白帽子  |\t\t\t        Rank:814 漏洞数:74        | 不会吹牛的小二不是好厨子！)\t\t \n  @Ch丶0nly 额，可以写脚本遍历手机号，批量获取用户信息啊，其实这不是和sqlmap down数据库一个原理么    \n     2015-05-21 12:22 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  开房一般都干嘛，不太懂也!    \n     2015-05-21 12:38 |    \t\tJGHOOluwa \t\t\t( 普通白帽子  |\t\t\t        Rank:206 漏洞数:32        | 就是来看看大牛们如何超神的^-^)\t\t \n  开房不是几个人聚一起打牌么？    \n     2015-05-21 12:45 |    \t\tWulala \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:24        | ^..^ ^..^ ^↓^ ^..^ ^..^)\t\t \n  看来又得暴漏我土豪的身份了...    \n     2015-05-21 12:52 |    \t\t追寻 \t\t\t( 实习白帽子  |\t\t\t        Rank:86 漏洞数:18        | 闭关修炼)\t\t \n  卧槽          520 刚过       \n     2015-05-21 13:05 |    \t\tBlackgame \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:13        | dddd)\t\t \n  呵呵  给力! 我去查询我女神开发记录了!    \n     2015-05-21 13:22 |    \t\tComer \t\t\t( 普通白帽子  |\t\t\t        Rank:336 漏洞数:40        | 关注安全 | 关注智能漏洞挖掘)\t\t \n  1\\6\\9楼 懵了    \n     2015-05-21 13:31 |    \t\tan0nym0u5 \t\t\t( 普通白帽子  |\t\t\t        Rank:172 漏洞数:31        )\t\t \n  围观~    \n     2015-05-21 13:38 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @JGHOOluwa 打dota    \n     2015-05-21 13:54 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @xsser 真男吊丝儿，打dota多没有互动性，我们一般小猫钓鱼拉    \n     2015-05-21 14:27 |    \t\t江苏苏宁易购电子商务有限公司(乌云厂商)\t\t \n  昨晚开过房的都蒙了     \n     2015-05-21 14:34 |    \t\t朱元璋 \t\t\t( 普通白帽子  |\t\t\t        Rank:422 漏洞数:141        | 我是一个阳光帅气的男孩)\t\t \n  你昨晚是不是打飞机把飞机也搞下来了    \n     2015-05-21 14:40 |    \t\tJGHOOluwa \t\t\t( 普通白帽子  |\t\t\t        Rank:206 漏洞数:32        | 就是来看看大牛们如何超神的^-^)\t\t \n  @xsser 哈哈，剑总也打呢，带我飞啊，包鸡包眼~    \n     2015-05-21 15:57 |    \t\tLooke \t\t\t( 普通白帽子  |\t\t\t        Rank:619 漏洞数:93        | 可顺势而为，何必逆水行舟)\t\t \n  擦。。。标题被改了    \n     2015-05-22 15:45 |    \t\t小哲哥 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 关注网站安全)\t\t \n  吊炸天    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}