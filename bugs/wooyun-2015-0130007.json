{"id": 48738, "wybug_id": "wooyun-2015-0130007", "wybug_title": "沱沱加app任意密码重置+越权+SQL注入", "wybug_corp": "tootoo.cn", "wybug_author": "大白胖纸", "wybug_date": "2015-07-28 21:08", "wybug_open_date": "2015-08-31 16:49", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-31：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 鄙人不才，上传的图片进行了二次渲染，我没搞出来shell。还请哪位大神搞出来指教我一下，拜谢。 详细说明：  1、任意密码重置，比较搞笑有爱……验证码就在返回值里（注册也是，可以任意手机号注册）。\n\n\n\n2、越权。与其说越权，不如说整个软件系统就没有权限设置。例如：1）访问这个url,在用户id是100001的用户，增加了收货地址\nhttp://www.tootoojia.com/userAddress/AddAddress.htm?CityId=2&UserId=100001&DetailedAddress=wooyuntest&ProvinceId=1&DistrictId=10&RealName=%E5%93%88%E5%93%88&PhoneNumber=13888888888&Postcode=100000\n\n\n2）读取任意用户的联系方式\nhttp://www.tootoojia.com/userAddress/ShowAddressList.htm?UserId=104853\n\n\n3）读取任意用户的私信、通知\nwww.tootoojia.com/notice/noticeList.htm?Page=1&PageSize=20&UserId=\n\nwww.tootoojia.com/mail/GetMailUserList.htm?Page=1&PageSize=20&UserId=\n4）遍历id加关注、刷粉丝\nwww.tootoojia.com/friend/AddFriend.htm?FollowId=参数1&UserId=参数2\n\n\n太多了，不一一列举了，刷赞、刷邀请也可以，就到这里。3、注入点太多了。有参数的地方就有注入。举这里的例子吧：参数userid\nhttp://www.tootoojia.com/Contact/ShowContactList?UserId=100000\n\n\n\n\n登录账号，16888888882（一看就是批量灌进数据库的），md5密码是654123，试一下。\n\n\n\n用户id是100001，刚才的收货地址增加成功。   漏洞证明：  说明里已介绍的很详细   修复方案：  1、短信验证码不要放在返回值中展示2、校验用户的合法性3、过滤参数   版权声明：转载请注明来源 大白胖纸@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-07-29 10:09 厂商回复： 感谢您对沱沱安全的付出. 已通知相关人员. 最新状态： 2015-08-31：感谢您的付出, 漏洞已修复. 2015-08-31：已修复.  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}