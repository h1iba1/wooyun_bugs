{"id": 14726, "wybug_id": "wooyun-2012-016391", "wybug_title": "快乐购修复不给力再现存储型XSS", "wybug_corp": "快乐购物股份有限公司", "wybug_author": "se55i0n", "wybug_date": "2012-12-23 22:34", "wybug_open_date": "2013-02-06 22:35", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-02-06：\t细节向公众公开  简要描述： 听所你们礼物不错，过节了，特路过来求礼物呀~ 详细说明：  这个问题“路过的菜鸟A”之前已经发过，快乐购的同学于2012-11-22回复“已经修复”！1）好吧，还是注册用户一枚，来到个人头像设置；\n\n2）点击保存头像并抓包，数据中依然有\"pic\"参数；\n\n3）想要突破下，还是先看看快乐购的同学做了哪些防御吧。经过一番测试发现：  3.1）未过滤\">\",但未成功利用，放弃；  3.2）pic参数后加上构造的xss代码,系统会自动在后面加上一个“\"”;  3.3)于是想到注释掉这个双引号，加上\"//\"提交发现系统过虑掉了一个“/”；  3.4）好吧，你要注释掉一个我就加上“///”吧，提交发现还是只剩一个“/”;4）好吧，至此系统的防御方法大概就清楚了，重新提交抓包在“pic”参数后加上我们构造的xss代码提交；\n\n5）成功突破系统防御，可爱的窗口弹出来了；听说这个头像很多地方都会显示哟，危害你们知道的；\n\n   漏洞证明：  见详细说明   修复方案：  送个礼物就好了：）   版权声明：转载请注明来源 se55i0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2012-12-24 10:31 厂商回复： 由于在修复过程中未进行严格过虑，因而漏洞未完全修复，感谢白帽子se55i0n对漏洞的提交！  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-23 22:45 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @快乐购物股份有限公司 吼吼~求礼物    \n     2013-01-06 17:45 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @se55i0n 有么有给？？    \n     2013-01-13 13:34 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @px1624 还木有    \n     2013-01-13 13:39 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @se55i0n 给了5rank，那估计是没有了。。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}