{"id": 49401, "wybug_id": "wooyun-2014-078552", "wybug_title": "某药监局电子监管系统st2致系统沦陷（敏感信息泄漏、任意短信群发）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "小卖部部长", "wybug_date": "2014-10-09 22:42", "wybug_open_date": "2014-11-23 22:44", "wybug_type": "系统/服务补丁不及时", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行", "源码泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-23：\t细节向公众公开  简要描述： 国庆七天乐，外面堵车，没法出去，只得在家里拿站，这是谁的过错？ 详细说明：  在家闲来无事，于是用百度来射了一下“LOGIN.ACTION”，找到一些到现在仍然没打补丁的网站，这又是谁的错？1、百度搜索[login.action],潜在对象很多很多哦~~2、找到目标：http://hsypjg.net/login.action ，看标题是某药监局的平台，政府机构，肯定不会有什么弱密码，万能钥匙之类的，可后面却证明我错了~~~~\n\n3、使用K8将登录页面拿去爆爆菊，看有没有菊花欣赏，果然有：\n\n4、既然有菊花，那我们来看看菊花里有些什么，先看看开了哪些端口：\n\n热乎的3389啊，那岂不直接添加帐户，服务器不就被咱拿下了？5、于是用命令看下有哪些帐户，咦？管理员名字居然有错别字？看来已经被人给爆过了，我捡了个二手？\n\n6、那就先测试下远程能不能连接，不然先建帐户，会被管理发现。果然不出所料，远程连不上，既然开了3389，远程又不能连接，那肯定是防火墙上面没做映射，或者端口有变化，于是将端口扫一下看看。\n\n7、用工具看了一下，发现这菊花果然被人给爆过无数次了，就在网站的根目录下，轻而易举就发现了七八个各种马儿们~~\n\n8、既然被别人种过马，这倒还让我省事了，正所谓前人栽树，后人乘凉，抄起马儿走起！于是数据库出来了，弱密码\n\n继续翻看配置文件，发现有MAS？岂不发免费短信了？\n\n9、连接一下数据库，翻看下各种表，找到前台管理员，居然是\nadmin,12345\n，WTF！早知道是这密码，就直接拿弱口令得了！还白费我这番功夫！！\n\n10、用密码登录前台看一下，药监的平台像什么样，通过地图发现是河北的。\n\n11、发现熟悉的MAS选项-短信群发！我喜欢！不想留下我的手机号方便别人来插水表，于是点到为止~~\n\n12、继续翻看，发现有一项为【库房视频监控】，小明！快！射象头？结果被骗了，就只能看领导的手机号码，没意思。。这算敏感信息不？\n\n13、WEB平台没意思，什么东西都没有，几乎是空的，倒是发现有几处上传，和源代码泄漏密码的小玩意，没心思去测试了，\n\n14、这时想到了之前的端口扫描，看下成果：\n121.28.179.246:80 -> www-http (World Wide Web HTTP)121.28.179.246:2907 -> webmethods-b2b (WEBMETHODS B2B)121.28.179.246:3388 -> cbserver (CB Server)\n3388？ 等于3389-1？ 有意思，拿来测试下，果然能够打开，于是回去增加帐号，提权，连接，\n\n提示用户不存在？不可能啊，密码没错啊，重新来过，还是不存在，难道防火墙映射的不是这台机器？于是去 NET VIEW一下，\n\\\\HSFDA                                                                        \\\\XP-201312190844\n，果然还有一台机器。据菜鸟猜测，估计远程还真不是在这台机器上，于是放弃不深入了。15、从之前的配置文件，顺便将MAS平台的数据库连接测试一下，果然成功，嘉讯的MAS2.0，从表结构来看，可发彩信、短信、WAP PUSH，若将短信内容按字段插入到相应的表中（目测是SMS_SENT），岂不就可以进行任意短信群发了？这就不继续探索了，毕竟好奇害死猫啊。\n\n   漏洞证明：  将上面的步骤走一遍，你就能证明了~~~   修复方案：  ST2补丁要打，弱口令一定要修改啊，虽然这次没用到。。。   版权声明：转载请注明来源 小卖部部长@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-10-13 15:44 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-24 10:09 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  洞洞还没修复。。。。    \n     2015-08-27 12:09 |    \t\tMark0smith \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 我更像是一个小松鼠)\t\t \n  还没。。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}