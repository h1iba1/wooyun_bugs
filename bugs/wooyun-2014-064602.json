{"id": 2648, "wybug_id": "wooyun-2014-064602", "wybug_title": "UC某服务器配置不当导致大量敏感信息泄漏", "wybug_corp": "UC Mobile", "wybug_author": "我是小号", "wybug_date": "2014-06-12 10:47", "wybug_open_date": "2014-07-27 10:48", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["目录遍历", "安全意识不足", "默认配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-27：\t细节向公众公开  简要描述： UC某服务器配置不当导致大量敏感信息泄漏 详细说明：  IP地址：\nhttp://119.147.224.60\n服务器配置不当导致未授权访问\nhttp://119.147.224.60/include\n接着从里面的config.inc.php.temp：\n//OSAdmin常量define ( 'ADMIN_URL' ,'http://ddt.login.game.uc.cn');\n可知应该是你们UC下的网站，应该涉及某款游戏。因为这个漏洞可获得你们的：内网信息+服务器root账号+游戏管理员帐号等等   漏洞证明：  1.重要备份文件泄漏，克在未授权情况下被下载（已经露很多点了）：config.inc.php.temp泄露了包括数据库链接账户以及密码还有数据库配置结构等敏感信息，直接可以拿到服务器ROOT权限\n<?phpdefine ('ACCESS',1); error_reporting(E_ALL ^ E_NOTICE);//autoload 使用常量define ( 'ADMIN_BASE', dirname ( __FILE__ ) . '/../../include' );define ( 'ADMIN_BASE_LIB', ADMIN_BASE . '/lib/' );define ( 'ADMIN_BASE_CLASS', ADMIN_BASE . '/class/' );//Smarty模板使用常量define ( 'TEMPLATE_DIR', ADMIN_BASE . '/template/' );define ( 'TEMPLATE_COMPILED', ADMIN_BASE . '/compiled/' );define ( 'TEMPLATE_PLUGINS', ADMIN_BASE_LIB . 'Smarty/plugins/' );define ( 'TEMPLATE_SYSPLUGINS', ADMIN_BASE_LIB . 'Smarty/sysplugins/' );define ( 'TEMPLATE_CONFIGS', ADMIN_BASE . '/config/' );define ( 'TEMPLATE_CACHE', ADMIN_BASE . '/cache/' );//OSAdmin常量define ( 'ADMIN_URL' ,'http://ddt.login.game.uc.cn');define ( 'ADMIN_TITLE' ,'管理后台');define ( 'COMPANY_NAME' ,'AnGame');//OSAdmin数据库设置define ( 'OSA_DB_ID' ,'osadmin');define ( 'OSA_DB_URL','127.0.0.1');define ( 'OSA_DB_PORT','3306');define ( 'OSA_DB_NAME' ,'*****');define ( 'OSA_USER_NAME','root');define ( 'OSA_PASSWORD','6904***');//COOKIE加密密钥，建议修改define( 'OSA_ENCRYPT_KEY','whatafuckingday!');//prefix不要更改，除非修改osadmin.sql文件中的所有表名define ( 'OSA_TABLE_PREFIX' ,'osa_');//页面设置define ( 'DEBUG' ,false);define ( 'PAGE_SIZE', 25 );//数据库配置$DATABASE_LIST[OSA_DB_ID] =array (\"server\"=>OSA_DB_URL,\"port\"=>OSA_DB_PORT,\"username\"=> OSA_USER_NAME, \"password\"=>OSA_PASSWORD, \"db_name\"=>OSA_DB_NAME );$OSADMIN_COMMAND_FOR_LOG=array(\t\t\t\t\t\t\t\t'SUCCESS'=>'成功',\t\t\t\t\t\t\t'ERROR'=>'失败',\t\t\t\t\t\t\t'ADD'=>'增加',\t\t\t\t\t\t\t'DELETE'=>'删除',\t\t\t\t\t\t\t'MODIFY'=>'修改',\t\t\t\t\t\t\t'LOGIN'=>'登录',\t\t\t\t\t\t\t'LOGOUT'=>'退出',\t\t\t\t\t\t\t'PAUSE'=>'封停',\t\t\t\t\t\t\t'PLAY'=>'解封',\t\t\t\t);$OSADMIN_CLASS_FOR_LOG=array(\t\t\t\t\t\t\t'ALL' => '全部',\t\t\t\t\t\t\t'User'=>'用户',\t\t\t\t\t\t\t'UserGroup'=>'账号组',\t\t\t\t\t\t\t'Module'=>'菜单模块',\t\t\t\t\t\t\t'MenuUrl'=>'功能',\t\t\t\t\t\t\t'GroupRole'=>'权限',\t\t\t\t\t\t\t'QuickNote'=>'QuickNote',\t\t\t\t\t);?>\n2.还有多个数据库泄漏（可以在未授权的情况下被下载）\n\n导致泄露了包括管理员帐号和密码，惨不忍睹\n\nPs.看了一下上面显示的日期貌似这台服务器很活跃的   修复方案：  1.设置权限2.服务器密码修改   版权声明：转载请注明来源 我是小号@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-06-12 11:32 厂商回复： 漏洞存在，已联系相关人员处理，非常感谢我是小号提供的漏洞信息！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}