{"id": 87340, "wybug_id": "wooyun-2016-0180424", "wybug_title": "Foxmail邮件客户端远程命令执行漏洞                                      ", "wybug_corp": "腾讯", "wybug_author": "数据流", "wybug_date": "2016-03-03 13:11", "wybug_open_date": "2016-06-02 09:30", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行", "客户端安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-03-07：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-04-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-02：\t细节向公众公开  简要描述： Foxmail最新版7.2远程命令执行，点开邮件就执行 详细说明：  \n\n\n\nFoxmail本身对邮件的body是有XSS filter的，但发现支持<meta>标签。meta可以干很多事情，可以自定义一个http head等，foxmail并未对meta标签的内容进行检测以下是能执行XSS的verctor\n<meta http-equiv=\"refresh\" content=\"0; url=data:text/html,%3Cscript%3Ealert%281%29%3C%2fscript%3E\">\n\n\n这个verctor是挺有意思的 ，利用meta标签，添加一个refresh属性，可以设置时间，这里设置的是0秒，就是立即跳转，使当前页面重定向，而重定向的页面就是data伪协议\ndata:text/html,<script>alert(1)</script>\n。相当于把页面重定向到另外一个带js的页面了，从而突破Foxmail本身的防御策略。用meta和data伪协议这种verctor在一般网页上或许没什么用处，因为data伪协议是独立的空白域，也就是说一般不在任何域内，不像普通的xss就直接能获取当前域内的信息。而这种xss在客户端内就大有用处了。利用XSS执行命令\n<meta http-equiv=\"refresh\" content=\"0; url=data:text/html,%3Cscript%3Ewindow.open%28%27file%3A%2f%2fC%3A%2fwindows%2fsystem32%2fcmd.exe.%27%29%3C%2fscript%3E\">\n利用客户端的缺陷可以直接使用open打开任意程序对 file://C:/windows/system32/cmd.exe这样的路径Foxmail本身是无法执行的，但在后面加一个\".\"就能突破   漏洞证明：  点击邮箱就执行\n\n   修复方案：  对meta标签进行过滤   版权声明：转载请注明来源 数据流@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2016-03-04 09:26 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-03 13:11 |    \t\t牛肉包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:307 漏洞数:70        | baozisec)\t\t \n  前排    \n     2016-03-03 13:17 |    \t\t萨瓦迪卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:128 漏洞数:21        | 黑太子)\t\t \n  six six six     \n     2016-03-03 13:17 |    \t\t风格 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:12        | 注册为白帽子，你可以在这里提交你发现的漏...)\t\t \n  前排    \n     2016-03-03 13:19 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1137 漏洞数:199        | px1624)\t\t \n  mark    \n     2016-03-03 13:22 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:2145 漏洞数:310        | 解决问题的第一步，是要承认问题的存在。)\t\t \n  6    \n     2016-03-03 13:30 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:257 漏洞数:84        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  跳蛋流要变邮箱流了？    \n     2016-03-03 13:44 |    \t\tanswer  \t\t\t( 普通白帽子  |\t\t\t        Rank:453 漏洞数:54        | 答案)\t\t \n  前排     \n     2016-03-03 13:52 |    \t\tSevck \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 一个乌云RANK为0的脚本小子|远离娱乐圈|人...)\t\t \n  屌屌的    \n     2016-03-03 13:54 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:297 漏洞数:22        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个还得突破下     \n     2016-03-03 14:00 |    \t\t数据流  \t\t\t( 普通白帽子  |\t\t\t        Rank:817 漏洞数:100        | 没关系啊，我们还有音乐)\t\t \n  @xsser 嗯 还能干其他事情，例如窃取邮件啥的    \n     2016-03-03 14:07 |    \t\tPraise \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | null    开心就要笑得如痴如醉~)\t\t \n  Mark    \n     2016-03-03 14:28 |    \t\tMark0smith \t\t\t( 普通白帽子  |\t\t\t        Rank:172 漏洞数:68        | 我要是再正常一点就好了)\t\t \n      \n     2016-03-03 14:58 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:94        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  收藏。。    \n     2016-03-03 16:18 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1662 漏洞数:191        | 学无止境)\t\t \n  流哥最近高产呀，关注。    \n     2016-03-03 16:24 |    \t\t秦风 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:10        | 血染江山的画  怎敌妳眉间一点朱砂  覆...)\t\t \n  mark    \n     2016-03-03 16:24 |    \t\t大师兄 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:8        | 每日必关注乌云)\t\t \n  666    \n     2016-03-03 16:31 |    \t\tblast \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:60        | Destruction brings construction)\t\t \n  跳哥……蛋哥威武    \n     2016-03-03 16:36 |    \t\t数据流  \t\t\t( 普通白帽子  |\t\t\t        Rank:817 漏洞数:100        | 没关系啊，我们还有音乐)\t\t \n  @梧桐雨 (ง •̀_•́)ง    \n     2016-03-03 16:36 |    \t\t数据流  \t\t\t( 普通白帽子  |\t\t\t        Rank:817 漏洞数:100        | 没关系啊，我们还有音乐)\t\t \n  @blast 翔哥你好 (ง •̀_•́)ง    \n     2016-03-03 20:55 |    \t\tSct7p \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 懂与不懂之间只隔了一层纸，懂的人会觉得很...)\t\t \n  666666666666666    \n     2016-03-04 09:30 |    \t\t无名 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:9        | 我是一只小菜鸟呀，伊雅伊尔哟。)\t\t \n  6666666    \n     2016-03-04 09:53 |    \t\tNeeke \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:26        | 额滴歌神呀！)\t\t \n  吓得我赶紧把foxmail卸载了    \n     2016-03-04 11:38 |    \t\tJovi \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        )\t\t \n  666666666    \n     2016-03-07 10:25 |    \t\tLar2y \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:12        | 有活跃团队要人么？求带飞)\t\t \n  好可怕    \n     2016-03-07 10:26 |    \t\tLar2y \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:12        | 有活跃团队要人么？求带飞)\t\t \n  吓得我把乌云都关了    \n     2016-03-07 11:02 |    \t\tAK-47 \t\t\t( 实习白帽子  |\t\t\t        Rank:78 漏洞数:11        | 开开心心挖洞，踏踏实实上学！)\t\t \n  MARK    \n     2016-03-07 19:59 |    \t\t未了 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        )\t\t \n  酷派安全应急响应中心：卧槽 叼叼叼    \n     2016-03-11 10:23 |    \t\t小恒-blog \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 开始我是拒绝的，但是我要试一试，没有想到...)\t\t \n  厉害啊 啊啊呵呵呵    \n     2016-03-19 15:27 |    \t\tbiubiu \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:6        | 我是流氓我怕谁)\t\t \n  来站位    \n     2016-05-11 14:34 |    \t\tMartial \t\t\t( 普通白帽子  |\t\t\t        Rank:2612 漏洞数:365        | 竟然还有人冒充我，醉了，骗子QQ445697541...)\t\t \n  有人成功了么    \n     2016-06-02 09:42 |    \t\tSophone \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:5        | 屌丝一枚 共同学习)\t\t \n  新版本还有。。。。。    \n     2016-06-02 09:56 |    \t\t未了 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        )\t\t \n  叼叼叼    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}