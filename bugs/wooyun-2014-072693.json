{"id": 25, "wybug_id": "wooyun-2014-072693", "wybug_title": "浙大万鹏某通用教育类门户系统存在任意文件下载漏洞", "wybug_corp": "浙大万鹏", "wybug_author": "一只猿", "wybug_date": "2014-08-16 16:25", "wybug_open_date": "2014-11-14 16:26", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件操作不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-24：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-14：\t细节向公众公开  简要描述： 浙大万鹏某通用教育类门户系统存在任意文件下载漏洞，可下载配置文件 详细说明：  浙大万鹏某通用教育类门户系统存在任意文件下载漏洞，可下载敏感配置文件，导致服务器敏感信息泄漏，见证明   漏洞证明：  谷歌关键字：inurl:cnet/dynamic/presentation/intitle:ZDSOFT.NET信息发布平台-2001-2005 浙江大学网络信息系统有限公司 版权所有\n\n\n\n\n\n搜索发现存在大量站点使用此web系统此系统版权为浙大万鹏（http://www.zdsoft.net/）漏洞存在位置：http://www.ymedu.gov.cn/cnet/dynamic/presentation/net_1/downloaddelegate.down?domesticfile=任意文件例子：http://www.ymedu.gov.cn/cnet/dynamic/presentation/net_1/downloaddelegate.down?domesticfile=WEB-INF/struts-config.xml下载配置文件struts-config.xml截图：\n\n首先下载web.xml截图：\n\n红色框中显示了浙大网络的版权在web.xml中找到了邮件服务器的一些信息\n\n从密码可以看出邮件只是个摆设，估计也是从来不用查看配置文件位置\n\n\n\n在struts配置文件中看到\n\n数据库配置被注释，推测修改了默认的配置。由于此系统应用在众多教教育类站点，并且有一些是gov.cn的服务器，此类服务器通常情况下使用的windows操作系统，所以可以根据windows服务器的特征下载任意文件。分析到当前阶段，如果继续往下分析思路应该是1．找到数据库配置文件，测试数据库是否能够外网连接（穷举数据库配置文件）2．去找此系统的源码包，直接找到数据库配置文件位置，下载配置文件测试外连3．通过搜索引擎没有找到此系统的更多信息，看起来应该是比较老的系统，如果有源码可以对代码进行审计，但是这套系统并不是开源的，所以我没有找到源码，没有继续深入。   修复方案：  无   版权声明：转载请注明来源 一只猿@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2014-08-21 10:40 厂商回复： CNVD确认并复现所述情况，由CNVD按以往联系渠道向软件生产厂商通报，同时通报给教育网应急组织——赛尔网络公司，抄报CCERT和上海交通大学。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}