{"id": 63947, "wybug_id": "wooyun-2013-028293", "wybug_title": "十九楼存储型XSS劫持任意指定用户(可蠕虫)", "wybug_corp": "十九楼", "wybug_author": "xfkxfk", "wybug_date": "2013-07-09 14:03", "wybug_open_date": "2013-08-23 14:04", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "类型应用", "利用技巧", "黑盒测试技巧", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-23：\t细节向公众公开  简要描述： 十九楼存储型XSS，劫持任意指定用户 详细说明：  问题在私信内容处，未对私信过滤，导致手机浏览触发xss。1、首先我们发私信给指定用户，这里我们使用xfkxfk123发私信给xfkxfk。\n\n这里xfkxfk123给xfkxfk发了两条私信，如下图xfkxfk123的发件箱：\n\n2、下面我们来看看xfkxfk收到的私信，看xfkxfk的收件箱，收到两条私信：\n\n当然这里是不会触发私信内容中的xss code的。3、当我们在手机上浏览时，这里我们用xfkxfk登陆手机账户，可以看到打开私信时，xss code出发了。\n\n并且可以看到xfkxfk123发过来的私信，以及xfkxfk自己发出去的私信。\n\n4、危害：a、因为发私信可以发给任何人，只要是十九楼的用户都可以发送私信。当用户用手机登陆时，打开我们发送的微信就会触发xss code，劫持任意用户。\n\nb、由于我们可以访问任意十九楼的用户空间，这样抓取到用户的uid和name就可以给所用用户发送带有xss payload内容的私信，劫持大量用户。\n\n如上图，我们只要按照uid的递增顺序一次访问对应uid的用户空间，抓取用户name，然后循环一边，就可以给所有用户发送私信了，危害该不小吧。虽然在www下做了每天发送私信的数量的限制，但是在wap下就没有限制咯。c、当然，这里的xss蠕虫就很简单了，收到私信后在发送私信出去，这样xss私信就泛滥了。   漏洞证明：  见详细说明   修复方案：  1、过滤用户输入的内容2、控制发私信策略，你们懂。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2013-07-09 14:16 厂商回复： 谢谢楼主 问题的确存在，尽快修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-08 15:02 |    \t\t大白菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:19        )\t\t \n  - - 我测试过就是没手机~没想到啊失算！！！    \n     2013-08-08 15:43 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @大白菜 没手机也行，wap目录就行了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}