{"id": 2028, "wybug_id": "wooyun-2014-060905", "wybug_title": "74cms 逻辑漏洞导致sql注入", "wybug_corp": "74c,s.com", "wybug_author": "menmen519", "wybug_date": "2014-05-19 17:10", "wybug_open_date": "2014-08-17 17:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "源码审核", "注射漏洞利用技巧", "源码分析", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-17：\t细节向公众公开  简要描述： 74cms 逻辑漏洞导致sql注入 详细说明：  include/fun_personal.php(381-398)\n$j=get_resume_basic($uid,$pid);\t\t$searchtab['sex']=$j['sex'];\t\t$searchtab['nature']=$j['nature'];\t\t$searchtab['marriage']=$j['marriage'];\t\t$searchtab['experience']=$j['experience'];\t\t$searchtab['district']=$j['district'];\t\t$searchtab['sdistrict']=$j['sdistrict'];\t\t$searchtab['wage']=$j['wage'];\t\t$searchtab['education']=$j['education'];\t\t$searchtab['photo']=$j['photo'];\t\t$searchtab['refreshtime']=$j['refreshtime'];\t\t$searchtab['talent']=$j['talent'];\t\tupdatetable(table('resume_search_rtime'),$searchtab,\"uid='{$uid}' AND id='{$pid}'\");\t\t$searchtab['key']=$j['key'];\t\t\t\t$searchtab['likekey']=$j['intention_jobs'].','.$j['recentjobs'].','.$j['specialty'].','.$j['fullname'];\t\t\t\tupdatetable(table('resume_search_key'),$searchtab,\"uid='{$uid}' AND id='{$pid}'\");\n当第一次提交的时候，参数做了过滤，然是系统存入数据库时候，又被还原回来了，所以$j=get_resume_basic($uid,$pid);所取出来的数据，是一个干净的没有被转义过的数据，让数据流向$searchtab['likekey']=$j['intention_jobs'].','.$j['recentjobs'].','.$j['specialty'].','.$j['fullname'];并且执行updatetable(table('resume_search_key'),$searchtab,\"uid='{$uid}' AND id='{$pid}'\");时候，漏洞产生了。自己填写一份简历，然后修改求职意向那一栏，如图所示\n\n当我们点击提交后，sql完整执行，通过这里可以看出来，这是一个完全可控制的sql注入，所以你可以拿到你任何数据，危害比较大   漏洞证明：     修复方案：  对此get_resume_basic($uid,$pid);取出来的数据，要做转移   版权声明：转载请注明来源 menmen519@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-05-20 15:54 厂商回复： ok 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}