{"id": 75200, "wybug_id": "wooyun-2016-0168268", "wybug_title": "点到为止之湖北CA数字认证管理中心某服务器存在命令执行", "wybug_corp": "湖北省数字证书认证管理中心", "wybug_author": "路人甲", "wybug_date": "2016-01-08 13:08", "wybug_open_date": "2016-02-22 16:48", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行", "补丁不及时"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向公众公开  简要描述： rt 详细说明：  #Struts2命令执行\nhttp://**.**.**.**:8001/css/self/searchCertApply!searchCert.do\n不要小看css.hbca。shell后可以跨到其它站点#shell:\n\n   漏洞证明：  整理敏感信息如下：001\n#SQLServer2005以上#hibernate.dialect=org.hibernate.dialect.SQLServerDialect#validationQuery.sqlserver=SELECT 1#jdbc.url.jeecg=jdbc:sqlserver**.**.**.**:1697;DatabaseName=jeecg#jdbc.username.jeecg=sa#jdbc.password.jeecg=SA#jdbc.dbType=sqlserver#postgresSQL#hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect#validationQuery.sqlserver=SELECT 1#jdbc.url.jeecg=jdbc:postgresql://localhost:5432/jeecg#jdbc.username.jeecg=postgres#jdbc.password.jeecg=postgres#jdbc.dbType=postgres#MySQLhibernate.dialect=org.hibernate.dialect.MySQLDialectvalidationQuery.sqlserver=SELECT 1#jdbc.url.jeecg=jdbc:mysql://localhost:3306/jeewx?useUnicode=true&characterEncoding=UTF-8jdbc.url.jeecg=jdbc:mysql://WebAppServer1:3306/jeewx?useUnicode=true&characterEncoding=UTF-8&autoReconnect=true&failOverReadOnly=false&maxReconnects=10 jdbc.username.jeecg=rootjdbc.password.jeecg=11111111jdbc.dbType=mysql#Oracle#hibernate.dialect=org.hibernate.dialect.OracleDialect#validationQuery.sqlserver=SELECT 1 FROM DUAL#jdbc.url.jeecg=jdbc:oracle:thin:@**.**.**.**:1521:dhtest#jdbc.username.jeecg=jeecg#jdbc.password.jeecg=jeecg#jdbc.dbType=oracle#更新|创建|验证数据库表结构|不作改变     默认update(create,validate,none)hibernate.hbm2ddl.auto=none\n002\n<!-- 各厂商介质相关属性配置 \t\t<property name=\"ukeyMap\">\t\t \t<map>\t\t \t\t<entry key=\"HHUK JDZY CSP V3.0\">\t\t \t\t\t<map>\t\t\t\t\t\t<entry key=\"name\" value=\"华虹V3\"></entry>\t\t\t\t\t\t<entry key=\"p11Lib\" value=\"hhpkcs1114.dll\"></entry>\t\t\t\t\t\t<entry key=\"algorithm\" value=\"RSA\"></entry>\t\t\t\t\t</map>\t\t \t\t</entry>\t\t \t\t<entry key=\"HaiTai Cryptographic Service Provider 20485\">\t\t \t\t\t<map>\t\t\t\t\t\t<entry key=\"name\" value=\"海泰V3\"></entry>\t\t\t\t\t\t<entry key=\"p11Lib\" value=\"HtPkcs1120485.dll\"></entry>\t\t\t\t\t\t<entry key=\"algorithm\" value=\"RSA\"></entry>\t\t\t\t\t</map>\t\t \t\t</entry>\t\t \t\t<entry key=\"Tianyu Cryptographic Service Provider\">\t\t \t\t\t<map>\t\t\t\t\t\t<entry key=\"name\" value=\"天喻\"></entry>\t\t\t\t\t\t<entry key=\"p11Lib\" value=\"typkcs11.dll\"></entry>\t\t\t\t\t\t<entry key=\"algorithm\" value=\"RSA\"></entry>\t\t\t\t\t</map>\t\t \t\t</entry>\t\t \t\t<entry key=\"M&amp;W eKey XCSP V3\">\t\t \t\t\t<map>\t\t\t\t\t\t<entry key=\"name\" value=\"明华V3\"></entry>\t\t\t\t\t\t<entry key=\"p11Lib\" value=\"mwpkcs11_v3.dll\"></entry>\t\t\t\t\t\t<entry key=\"algorithm\" value=\"RSA\"></entry>\t\t\t\t\t</map>\t\t \t\t</entry>\t\t \t\t<entry key=\"XiangSheng Cryptographic Service Provider\">\t\t \t\t\t<map>\t\t\t\t\t\t<entry key=\"name\" value=\"翔晟\"></entry>\t\t\t\t\t\t<entry key=\"p11Lib\" value=\"NORECOVER\"></entry>\t\t\t\t\t\t<entry key=\"algorithm\" value=\"RSA\"></entry>\t\t\t\t\t</map>\t\t \t\t</entry>\t\t \t\t<entry key=\"FEITIAN ePassNG RSA Cryptographic Service Provider\">\t\t \t\t\t<map>\t\t\t\t\t\t<entry key=\"name\" value=\"飞天\"></entry>\t\t\t\t\t\t<entry key=\"p11Lib\" value=\"NORECOVER\"></entry>\t\t\t\t\t\t<entry key=\"algorithm\" value=\"RSA\"></entry>\t\t\t\t\t</map>\t\t \t\t</entry>\t\t \t\t\t\t \t</map>\t\t</property>\t\t-->\t\t\t\t\t<!-- 系统相关常量信息 -->\t\t<property name=\"map\">\t\t\t<map>\t\t\t\t<!-- 短信发送配置（URL） -->\t\t\t\t<entry key=\"smsURL\" value=\"http://**.**.**.**:8899/sms/Api/Send.do\"></entry>\t\t\t\t\t\t\t<!-- 短信发送配置（账号） -->\t\t\t\t<entry key=\"smsCORPID\" value=\"200487\"></entry>\t\t\t\t<!-- 短信发送配置（用户名） -->\t\t\t\t<entry key=\"smsUSERNAME\" value=\"hb_sz\"></entry>\t\t\t\t<!-- 短信发送配置（密码） -->\t\t\t\t<entry key=\"smsPASSWORD\" value=\"sz0815\"></entry>\t\t\t\t\t\t\t\t<!-- 短信发送配置（内容） -->\t\t\t\t<entry key=\"smsContent\" value=\"尊敬的客户，您的业务受理号为：\"></entry>\t\t\t\t\t\t\t\t<entry key=\"keyLength\" value=\"1024\"></entry>\t\t\t\t\t\t\t\t<entry key=\"tomcatUrl\" value=\"F:/apache-tomcat-6.0.32/webapps/css/downloads/\"></entry>\t\t\t\t\t\t\t\t<!-- 支付宝跳转页面 -->\t\t\t\t<entry key=\"notify_url\" value=\"**.**.**.**:8001/css/alipay/notify_url.jsp\"></entry>\t\t\t\t<entry key=\"return_url\" value=\"**.**.**.**:8001/css/alipay/return_url.jsp\"></entry>\t\t\t</map>\t\t</property>\n003\n#SQLServer2005以上#hibernate.dialect=org.hibernate.dialect.SQLServerDialect#validationQuery.sqlserver=SELECT 1#jdbc.url.jeecg=jdbc:sqlserver**.**.**.**:1697;DatabaseName=jeecg#jdbc.username.jeecg=sa#jdbc.password.jeecg=SA#jdbc.dbType=sqlserver#postgresSQL#hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect#validationQuery.sqlserver=SELECT 1#jdbc.url.jeecg=jdbc:postgresql://localhost:5432/jeecg#jdbc.username.jeecg=postgres#jdbc.password.jeecg=postgres#jdbc.dbType=postgres#MySQLhibernate.dialect=org.hibernate.dialect.MySQLDialectvalidationQuery.sqlserver=SELECT 1#jdbc.url.jeecg=jdbc:mysql://localhost:3306/jeewx?useUnicode=true&characterEncoding=UTF-8jdbc.url.jeecg=jdbc:mysql://WebAppServer1:3306/jeewx?useUnicode=true&characterEncoding=UTF-8&autoReconnect=true&failOverReadOnly=false&maxReconnects=10 jdbc.username.jeecg=rootjdbc.password.jeecg=11111111jdbc.dbType=mysql#Oracle#hibernate.dialect=org.hibernate.dialect.OracleDialect#validationQuery.sqlserver=SELECT 1 FROM DUAL#jdbc.url.jeecg=jdbc:oracle:thin:@**.**.**.**:1521:dhtest#jdbc.username.jeecg=jeecg#jdbc.password.jeecg=jeecg#jdbc.dbType=oracle#更新|创建|验证数据库表结构|不作改变     默认update(create,validate,none)hibernate.hbm2ddl.auto=none\n004\nhibernate.connection.driver_class=oracle.jdbc.driver.OracleDriverhibernate.connection.url=jdbc\\:oracle\\:thin\\:@**.**.**.**\\:1521\\:hbcadbhibernate.connection.username=cssuserhibernate.connection.password=cssuser2013hibernate.c3p0.min_size=10hibernate.c3p0.max_size=100hibernate.c3p0.timeout=180hibernate.c3p0.acquire_increment=5hibernate.c3p0.idle_test_period=300hibernate.c3p0.max_statements=0hibernate.dialect=org.hibernate.dialect.Oracle10gDialecthibernate.show_sql=falsehibernate.format_sql=falseorg.apache.ws.security.crypto.provider=**.**.**.**ponents.crypto.Merlinorg.apache.ws.security.crypto.merlin.file=css.jksorg.apache.ws.security.crypto.merlin.keystore.type=jksorg.apache.ws.security.crypto.merlin.keystore.password=11111111org.apache.ws.security.crypto.merlin.keystore.alias=cssorg.apache.ws.security.crypto.merlin.alias.password=11111111appId=wx9c2f15696ed15cb1appSecret=5072c85598a157e90d29a9ed4611132ebycxkey=bycxllcxkey=llcxzdcxkey=zdcxfwcxkey=fwcxnotbd=yhbdwxfw=**.**.**.**\\:80\n   修复方案：  尽快修复。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-01-12 16:15 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT下发给湖北分中心,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}