{"id": 39707, "wybug_id": "wooyun-2015-0105419", "wybug_title": "今日特价APP设计缺陷导致垂直权限提升", "wybug_corp": "趣购网", "wybug_author": "HackBraid", "wybug_date": "2015-04-02 16:41", "wybug_open_date": "2015-05-17 16:42", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "越权操作", "认证缺陷", "设计不当导致攻击界面扩大"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-02：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-05-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： cookie处设计缺陷导致客服人员提升至系统管理！，cookie还是永不失效的，程序员就是这么任性~@疯狗 狗哥，这个算不算经典漏洞？ 详细说明：  之前盲打到另外一个cookie，发现一天了怎么还能用，这个cookie对应账户是最高权限，后来经过分析cookies字段发现原因：http://qugou-inc.com/qugou/admin#thread_admincookie信息如下：\nCookie：uid=19; user_name=cheng.zhou; models=1,36,2,3,4,5,6,7,8,10,11,12,13,14,15,16,17,18,19,20,21,22,23,26,27,28,39,29,31,34,35,37,41,99; privileges=0101,0102,0103,0104,0105,0106,3602,3606,0201,0301,0302,0303,0401,0403,0404,0501,0601,0602,0603,0604,0701,0801,0802,0803,0804,1008,1101,1201,1301,1401,1501,1601,1701,1801,1901,2006,2101,2102,2201,2301,2302,2308,2309,2310,2303,2304,2305,2306,2307,2308,2601,2602,2604,2701,2702,2801,3901,3902,3903,2901,3101,3102,3201,3401,3501,3502,3503,3504,3505,3506,3507,3701,4101,9901\n发现cookies信息很明确：uid：用户的iduser-name:用户名models:侧栏的功能栏序列privileges:权限，01对应models的1,0101,0102,0103,0104,0105,0106代表models1的功能有6个，cookies字段里有说明有这个权限   漏洞证明：  1.查看系统内部员工账户，并编辑下：\n\n2.把cookie字段中的uid和user_name换为李霞的14和lixia，发现李霞也有系统管理权限：\n\ncookie还是永不失效的，程序员就是这么任性~   修复方案：  duang~duang~duang~   版权声明：转载请注明来源 HackBraid@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}