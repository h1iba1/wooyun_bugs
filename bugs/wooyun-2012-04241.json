{"id": 21090, "wybug_id": "wooyun-2012-04241", "wybug_title": "手机搜房网路径泄漏", "wybug_corp": "搜房网", "wybug_author": "Ambulong", "wybug_date": "2012-02-06 02:29", "wybug_open_date": "2012-03-22 02:30", "wybug_type": "敏感信息泄露", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["错误信息未屏蔽"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-02-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-02-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-02-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-03-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-03-22：\t细节向公众公开  简要描述： 手机搜房网配置不当或代码不完善导致路径泄漏(顺便告诉我如何领取礼物，不知是我不会领还是厂商放送的步骤错误，只有一个收到礼物后点击“确认”的提醒，谢谢厂商了啊:-) 详细说明：  手机搜房网代码不完善导致在处理SESSION的过程中程序返回warning,配置问题导致警告的显示，警告的显示导致路径泄漏。在http://wap.soufun.com/先随便登录下，产生SESSION后再点击“注册”，在注册页面中就会返回找不到储存SESSION的文件的路径和程序的路径。\nWarning: session_start() [function.session-start]: open(/usr/local/tmp/sess_5117cf6ae2050f3b5a00857b479a7417, O_RDWR) failed: No such file or directory (2) in /www/webdev/wap.soufun.com/bbs/register.php on line 2Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent (output started at /www/webdev/wap.soufun.com/bbs/register.php:2) in /www/webdev/wap.soufun.com/bbs/register.php on line 2\n路径显而易见。Rank为5是因为搜房网的注入问题有点多（后面的漏洞报告会证明），路径暴露容易被利用插入后门。   漏洞证明：  \nWarning: session_start() [function.session-start]: open(/usr/local/tmp/sess_5117cf6ae2050f3b5a00857b479a7417, O_RDWR) failed: No such file or directory (2) in /www/webdev/wap.soufun.com/bbs/register.php on line 2Warning: session_start() [function.session-start]: Cannot send session cache limiter - headers already sent (output started at /www/webdev/wap.soufun.com/bbs/register.php:2) in /www/webdev/wap.soufun.com/bbs/register.php on line 2\n\n\n下面是正常页面\n\n   修复方案：  修改程序配置，不是测试应该没必要显示错误和警告。或者改善程序代码   版权声明：转载请注明来源 Ambulong@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2012-02-06 12:27 厂商回复： 已经修复，多谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}