{"id": 44744, "wybug_id": "wooyun-2015-098908", "wybug_title": "中兴某站奇葩文件上传绕过GetShell", "wybug_corp": "中兴通讯股份有限公司", "wybug_author": "路人甲", "wybug_date": "2015-03-01 11:07", "wybug_open_date": "2015-04-15 11:08", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-15：\t细节向公众公开  简要描述： 搞了半天终于传上去了，来个首页吧~ 详细说明：  \nhttp://www.appstar.com.cn\n中兴应用之星网站，看见有人报过常规的文件上传绕过漏洞\n WooYun: 中兴某网站文件上传绕过漏洞GetShell \n目前已经修复了，下面来看看奇葩的文件上传。#1，首先肯定是去找上传的地方，找了一个制作图文APP应用的地方，制作的过程中会叫你上传相关文件，首先上传一个正确的docx文档可以正常上传，但是再上传jsp文件提示文件类型不符：\n\n#2 本来想用burp拦截进行绕过，结果发现拦截不到消息，于是分析了半天，居然发现了这个：\n\n文件上传的格式居然是被这个imgTextBook.js的js文件控制的。#3 接下来就是退出该网站，清除所有缓存，用burp开启拦截服务器相应，等待再次加载imgTextBook.js的那个请求，然后把请求的imgTextBook.js文件给改了，拦了半天：\n\n好了，js文件改过来了：\n\n#4 接下来就是直接上传jsp的shell了，上传后的文件路径只要查看js代码就能轻松找到：\n\nshell地址：\nhttp://www.appstar.com.cn/upload/itBook/2015010507709/it201503010048023471/word/J.jsp\n\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-03-02 09:44 厂商回复： 感谢~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-01 12:02 |    \t\t牧马 \t\t\t( 普通白帽子  |\t\t\t        Rank:107 漏洞数:17        | 我是要成为猪猪侠的男人。。。。)\t\t \n  fck?    \n     2015-04-15 11:24 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  绕这么大圈，我觉得应该是一点上传就立刻弹出对话框，判断是本地验证，F12编辑下不就ok了？    \n     2015-04-15 12:27 |    \t\t有归于无 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:15        | 有归于无)\t\t \n  就一个js本地验证，，我还以为多奇葩。。。问下二楼@char 我f12修改没成功过，每次都是burp提交截断改后缀    \n     2015-04-29 15:44 |    \t\tAerfa21 \t\t\t( 普通白帽子  |\t\t\t        Rank:165 漏洞数:44        )\t\t \n  禁用加载js呢？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}