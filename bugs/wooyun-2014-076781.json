{"id": 50798, "wybug_id": "wooyun-2014-076781", "wybug_title": "OPEN.COM.CN SQL注入（一）", "wybug_corp": "open.com.cn", "wybug_author": "Feei", "wybug_date": "2014-09-21 10:49", "wybug_open_date": "2014-11-05 10:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-05：\t细节向公众公开  简要描述： 过滤不严导致SQL注入，189万用户信息泄露 详细说明：  注入点（需登陆）：http://learn.open.com.cn/Inquiry/View.aspx?QueryID=534&ResourceType=R1&ResourceCode=23859035-DD61-4C02-AB27-59190ABBC524先登陆http://learn.open.com.cn/登陆后\n\n注入点检测\n\n服务器与DB信息web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005database management system users [2]:[*] lms[*] sa共有189万用户信息存在被泄露风险，而且通过关联表可以查出这些用户在读的专业以及地址等更加详细的信息，这些信息如果泄露将有很大危害！   漏洞证明：  数据库[*] Lms[*] master[*] model[*] msdb[*] tempdbDatabase: Lms+-----------------------------------------------------+---------+| Table                                               | Entries |+-----------------------------------------------------+---------+| dbo.tb_r_InfoClickRecord                            | 43599317 || dbo.tb_r_StudentCourse                              | 27612911 || dbo.vw_StudentCourse                                | 27612904 || dbo.online_r_StudentExercise                        | 25522113 || dbo.OES_StudentExercise                             | 25522085 || dbo.v_Goods_InValidSelectCourse                     | 21969812 || dbo.vw_PassStudyStudentCourse                       | 21797450 || dbo.vw_PassStudyStudentMasterCourse                 | 21797450 || dbo.vw_PassStudyStudentSlaveCourse                  | 21796172 || dbo.Online_r_HomeWorkResult                         | 19464208 || dbo.Online_r_HomeWorkFinish                         | 16964515 || dbo.sco_Cmi_Core                                    | 15088486 || dbo.tb_r_studentcourse_ForDel                       | 10695086 || dbo.tb_r_ReceiveMessage                             | 10478476 || dbo.online_r_StudentExercise_del                    | 7751195 || dbo.vw_MasterCourseUniversityLcenter                | 7603003 || dbo.tb_e_UserLog                                    | 7532440 || dbo.vw_InStudyStudentMasterCourse                   | 5641814 || dbo.v_Goods_ValidSelectCourse                       | 5641619 || dbo.vw_InStudyStudentCourse                         | 5634245 || dbo.vw_InOrPassStudyStudentSlaveCourse              | 5634043 || dbo.vw_InStudyStudentSlaveCourse                    | 5634043 || dbo.tb_r_QueryResult                                | 4688141 || dbo.online_e_TestPaperDetail                        | 3876609 || dbo.tb_r_StudentJobRecordLog_new20120827            | 3196753 || dbo.tb_r_StudentJobRecord                           | 3127671 || dbo.evaluation_e_Result                             | 2446320 || dbo.temporary_e_Inquiry                             | 2313124 || dbo.tb_r_StudentJobRecordLog                        | 2248387 || dbo.tb_r_StudentCourseClick                         | 2072514 || dbo.Online_r_HomeWork                               | 1987674 || dbo.sco_UserObjectives                              | 1923408 || dbo.tb_e_UserInfo                                   | 1894167 | 用户信息 189万| dbo.FI_UserInfo                                     | 1894163 || dbo.v_ValidUserInfo                                 | 1893574 || dbo.tb_e_StudentBaseInfo                            | 1881696 || dbo.tip_e_ActionLog                                 | 1855706 || dbo.OES_StudentJobScore                             | 1804964 || dbo.[user]                                          | 1795621 || dbo.tb_e_StudentSchoolInfo                          | 1688146 || dbo.vw_tb_e_UserInfo                                | 1656116 || dbo.vw_ValidStudentSchoolRelativeInfo               | 1656100 || dbo.vw_ValidStudentBaseInfo                         | 1592285 || dbo.vw_ValidStudentInfo                             | 1592285 || dbo.online_r_HomeworkResultDetail                   | 1557254 || dbo.LearningBar_e_UserAction                        | 1266086 || dbo.CSVTable                                        | 1155063 |用户信息：包括用户名、密码、手机、QQ、邮箱、公司、真实姓名等信息\n\n管理员账号信息：\n\n   修复方案：  严格过滤参数目测没有做全局过滤，建议直接先上WAF   版权声明：转载请注明来源 Feei@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-09-26 08:15 厂商回复： 研发人员更替，规范性差 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}