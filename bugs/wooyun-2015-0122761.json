{"id": 28356, "wybug_id": "wooyun-2015-0122761", "wybug_title": "链家地产某站点存在设计逻辑错误，普通账号可变身管理员", "wybug_corp": "homelink.com.cn", "wybug_author": "默之", "wybug_date": "2015-06-26 09:30", "wybug_open_date": "2015-08-10 13:40", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-10：\t细节向公众公开  简要描述： 链家地产某站点存在设计逻辑错误，普通账号可变身管理员 详细说明：  链家微校：http://119.254.70.121/用自己的手机号注册一个账号，登陆之后发现没有名称，不过有一个个人中心和后台管理两个链接\n\n1. 直接点击个人中心可以看到名称出现了，不过这个登录人到底是谁，现在也确定不了，程序设计太乱了\n\n可以查看学习的课程（现在可以确定是张佳）\n\n2. 返回到刚才的界面，打开后台管理，可以看出，用户直接变为管理员账号了，权限很大\n\n可以进行课程的增删操作\n\n在http://119.254.70.121/admin/upload/video/video_More.jsp，可以进行上传课程，不过没有对上传文件进行验证，导致任意文件上传，不过直接传到内网服务器了，无法shell，不过如果内部人员就完全可以进行操作了，所以还是有一定风险的\n\n   漏洞证明：  \n\n   修复方案：  如果可以的话，禁止外人注册对上传文件进行校验设计的逻辑错误，这个太傻了狠狠地抽打程序员吧   版权声明：转载请注明来源 默之@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-06-26 13:39 厂商回复： 谢谢对链家安全的关注，由于该系统还属于开发阶段，属于仓促上线，没有进行安全评估，马上回去吊打开发。～ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-26 14:14 |    \t\t默之 \t\t\t( 普通白帽子  |\t\t\t        Rank:334 漏洞数:67        | 沉淀。)\t\t \n  @北京链家房地产经纪有限公司 每次只给5rank吗？都是辛辛苦苦找到的。。。感觉好少啊    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}