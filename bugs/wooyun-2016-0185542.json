{"id": 87769, "wybug_id": "wooyun-2016-0185542", "wybug_title": "QQ邮箱ios版存储型XSS漏洞                                      ", "wybug_corp": "腾讯", "wybug_author": "mramydnei", "wybug_date": "2016-03-17 09:52", "wybug_open_date": "2016-06-15 11:20", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-03-20：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-05-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-15：\t细节向公众公开  简要描述：  详细说明：  问题出现在QQ邮箱ios版附件的XSS防御上。起初是测试下面的vector时发现可以执行自定义的JavaScript：\n<body> ｡frame onload=confirm(/kcf/)&gt; <img src=x:x onerror=\"innerHTML=previousSibling.nodeValue.replace('｡','<')\"> </body>\n想当然的就以为是QQ邮箱的JS sandbox被我bypass了。不过经过后面几次加试发现是因为image tag前方的特殊字符［｡］导致后面的xss vector没有被拦截。※对于［｡］的可替代性没有做太多的测试。粗略的测试了一下应该是数字字母和一般的特殊符号结束后的unicode区域。   漏洞证明：  将下面的vector保存成test.htm并发送给受害者。\n○<img src=x onerror=\"prompt(/pwned/)\">\n受害者预览附件时会遭受XSS攻击（如下图）\n\n   修复方案：  该产品有很多诡异的表现，不太好说要怎么修复。   版权声明：转载请注明来源 mramydnei@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-03-17 11:11 厂商回复： 非常感谢您的报告。该问题已经确认并已着手处理。如果您有任何的疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-17 09:57 |    \t\the1renyagao \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:31        | 是金子总会发光，在还未发光之前，先磨磨)\t\t \n  牛逼真不是吹的    \n     2016-03-17 10:05 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:871 漏洞数:161        | raw_input(\"你知道我要输入什么？\"))\t\t \n  6    \n     2016-03-17 10:22 |    \t\t晓庄 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:7        | Make money.)\t\t \n  火车不是推的    \n     2016-03-17 10:51 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:95        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  握草。。6666    \n     2016-03-17 13:05 |    \t\tzmx \t\t\t( 普通白帽子  |\t\t\t        Rank:164 漏洞数:42        | wooyun)\t\t \n  是APP？    \n     2016-03-17 14:04 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1149 漏洞数:207        | px1624)\t\t \n  我信洞主！    \n     2016-03-17 14:08 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:871 漏洞数:161        | raw_input(\"你知道我要输入什么？\"))\t\t \n  @px1624 我信px得永生    \n     2016-03-17 20:01 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:400 漏洞数:87        )\t\t \n  @zmx 嗯 是app    \n     2016-03-17 20:26 |    \t\t香草 \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:15        | javascript,xss,jsp、aspx)\t\t \n  我信    \n     2016-03-20 13:12 |    \t\t陆由乙 \t\t\t( 普通白帽子  |\t\t\t        Rank:597 漏洞数:133        | 我是突突兔！)\t\t \n  信    \n     2016-03-20 21:40 |    \t\tzhchbin \t\t\t( 普通白帽子  |\t\t\t        Rank:153 漏洞数:31        )\t\t \n  M神，这个是fuzz出来的？好6！！    \n     2016-03-20 22:13 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:400 漏洞数:87        )\t\t \n  @zhchbin 这个不是fuzz出来的，但和测试方法关系大一些。    \n     2016-03-20 23:02 |    \t\tannt \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 无)\t\t \n  @px1624 0.0  你也看洞主直播么。。。    \n     2016-03-21 10:09 |    \t\tSH0X8001 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:6        | 你猜)\t\t \n  牛    \n     2016-04-13 17:58 |    \t\tMazing \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:6        )\t\t \n  啊。我什么时候才能摆脱见框就插的地步啊。    \n     2016-06-01 17:09 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1149 漏洞数:207        | px1624)\t\t \n  没试试web或者m端？还是只有ios可以？    \n     2016-06-02 02:33 |    \t\t随随意意 \t\t\t( 普通白帽子  |\t\t\t        Rank:175 漏洞数:36        )\t\t \n  以前提交过。亲，问题经过仔细研究，得出以下结论，首先点开html文件会下载到手机本地，然后访问该文件，属于正常功能，且没有作用域，所以没有危害，故不通过审核，望见谅，再接再厉，与君共勉 14年乌云回复您好，无危害，暂不处理。 14年tsrc回复。。。。。。。    \n     2016-06-02 10:54 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:95        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  @随随意意 哈哈哈。。。真的？来个链接    \n     2016-06-03 20:11 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:400 漏洞数:87        )\t\t \n  @px1624 测试结果是只有ios可以。报告里没有提到，顺便在这里补充一下。测试附件的编码是sjis+tag前面的字符也是日文的句号。如果附件的编码是utf-8,上述的测试向量是不会触发的。    \n     2016-06-03 20:12 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:400 漏洞数:87        )\t\t \n  @随随意意 看截图可以看到js被执行的域名是什么。    \n     2016-06-03 20:44 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1149 漏洞数:207        | px1624)\t\t \n  @mramydnei 。。。把各个国家的语言编码都测一遍    \n     2016-06-03 21:47 |    \t\t数据流  \t\t\t( 普通白帽子  |\t\t\t        Rank:817 漏洞数:100        | 没关系啊，我们还有音乐)\t\t \n  @随随意意 睁大你眼睛看看截图里是哪个域的！    \n     2016-06-04 00:27 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1149 漏洞数:207        | px1624)\t\t \n  @随随意意 ...这是有效域的~    \n     2016-06-05 14:20 |    \t\t随随意意 \t\t\t( 普通白帽子  |\t\t\t        Rank:175 漏洞数:36        )\t\t \n  @mramydnei @数据流 @px1624 没仔细看是有效域的~，只注意到了位置是一样的。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}