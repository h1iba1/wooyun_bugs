{"id": 57802, "wybug_id": "wooyun-2014-053279", "wybug_title": "phpcms后台php代码执行获取webshell", "wybug_corp": "phpcms", "wybug_author": "TestRoot", "wybug_date": "2014-03-11 18:14", "wybug_open_date": "2014-04-25 18:15", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-25：\t细节向公众公开  简要描述： 虽然新版后台代码过滤了某些字符，但是病根并未去除 详细说明：  这个漏洞之前有提交过，但是未予通过http://wooyun.org/bugs/wooyun-2013-028083/trace/cb41b9ed8e389d6da2cd33f5b85701e2上次提交之后最新版过滤了字符并且系统设置了不允许在线编辑模板，但是之前安装的用户群和用户自行开启在线编辑模板的网站还是很多的，PHPCMS程序版本测试成功：Phpcms V9.5.4 Release 20140226文件 htdocs\\phpcms\\modules\\template\\file.php\n$code = str_replace(array('<?'),array('<？'),$code);\n介于文化水平的问题，只看到这行代码并且看懂了这是修改后加入了一行代码 将提交代码的文件包含有<? 转换成了<？ 全角的问号 修改前\n\n修改后 \n\n  生成首页后\n\n   漏洞证明：  虽然他把<?过滤成了<？，但是还可以绕过的使用\n<script language=\"php\">echo ok ;</script>\n下面就不一一的贴图了，另外在修改默认模板文件footer.html的时候 看到了第十一行\n{php echo runhook('glogal_footer')}\n原来使用{php echo ok} 也可以执行php，至于原来我就不分析源代码了 也看不懂提交漏洞能不能索要一枚邀请码   修复方案：  继续过滤吧   版权声明：转载请注明来源 TestRoot@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2014-03-12 13:15 厂商回复： 感谢反馈！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-11 18:57 |    \t\t小贱人 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 资深菜鸟，)\t\t \n  mark    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}