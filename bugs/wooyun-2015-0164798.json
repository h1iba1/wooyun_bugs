{"id": 76492, "wybug_id": "wooyun-2015-0164798", "wybug_title": "西部证券客服系统未授权访问+可更改任意客服账号的密码", "wybug_corp": "西部证券", "wybug_author": "程序员鼓励师", "wybug_date": "2015-12-26 13:17", "wybug_open_date": "2016-02-09 23:29", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-09：\t细节向公众公开  简要描述：  - - 圣诞节挖洞的白帽子都是好样的! 详细说明：  \nhttp://wb.west95582.com:8080/newback/\n\nhttp://wb.west95582.com/wcc/service/\n首先是未授权访问。直接访问\nhttp://wb.west95582.com/wcc/service/index.jsp\n\n\n直接进入到客服管理的界面...只是没有经过正规途径登录,对象都是null状态.然后可以随便看看客户问了啥问题..聊天记录..\n\n然后我们看到一个修改密码的按钮..没要求输入原密码 - -抓包看看\n\n\n\n这里我们看到有个id的值为null.. 这应该就是客服账号的id - - 这样就是说只要我们找到其他客服账号的id就应该可以修改任意客服账号的密码了。然后可以看到 最底下有个聊天记录的按钮.我们点进去看下.\n\n\n\nkf0001 找到了.然后我们再次修改密码.\n\n\n\n登录一下看看  kf0001/thisistest  登录成功\n\n - - 这样子就能伪装客服诱骗客户了..一上来就发现有个客户咨询我...但是我没理他...简单测试了下. 改了2个客服账号的密码kf0001/thisistestrenyuan/thisistest   漏洞证明：  \nhttp://wb.west95582.com/wcc/service/index.jsp\n\n\n\n\n\n\n\n\n\n\n   修复方案：   验证,加判断.   版权声明：转载请注明来源 程序员鼓励师@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-12-29 10:34 厂商回复： 感谢“路人甲”。 最新状态： 2015-12-29：我公司已修复此漏洞。  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}