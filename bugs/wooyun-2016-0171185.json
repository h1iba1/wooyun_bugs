{"id": 84964, "wybug_id": "wooyun-2016-0171185", "wybug_title": "搜狗云测平台找回密码功设计不当可任意重置他人密码", "wybug_corp": "搜狗", "wybug_author": "冰无漪", "wybug_date": "2016-01-20 09:41", "wybug_open_date": "2016-03-05 09:52", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "搜狗", "密码重置"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-03-05：\t细节向公众公开  简要描述： 重置密码设计缺陷，知道手机号可任意重置他人密码 详细说明：  一共犯错了3个错误：第一：验证码是简短的4位纯数字，造成猜解时间段。第二：验证码没有错误次数限制，导致可暴力破解。第三：验证码没有发送次数上限，已知可对手机短信轰炸。此次问题主要是前两点，一分钟之内可任意重置他人密码。\n\n输入手机号码，点击获取短信验证码，填写新密码后点击重置密码，抓包\n\n它的短信验证码是4位数字，我从1000开始暴力破解\n\n可以看到这一行返回数据长度与其它地方不一样，payload值2234就是我们的短信验证码此时密码已经被重置为7777777\n\nOK! 登陆成功！   漏洞证明：  \n\n   修复方案：  第一：加大验证码复杂度，建议6位数字和字母混合。第二：限制重试次数，同一手机号验证码错误次数3次后，当前验证码失效，需要重新获取。第三：限制获取次数，每个手机号一天中获取验证码次数不超过3次。   版权声明：转载请注明来源 冰无漪@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-01-20 16:47 厂商回复： 感谢支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}