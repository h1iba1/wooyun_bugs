{"id": 21310, "wybug_id": "wooyun-2012-04748", "wybug_title": "深澜Srun3000宽带认证计费系统伪造登陆ip，绕过计费验证", "wybug_corp": "深澜软件", "wybug_author": "Asuimu", "wybug_date": "2012-02-23 08:56", "wybug_open_date": "2012-02-23 08:56", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-23：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-02-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 登陆信息验证不完善，可通过伪造ip绕过计费验证实现免费上网 详细说明：  在登陆srun3000客户端时只记录客户端ip，因此只要将自己电脑的ip改为以通过验证的ip地址不用登陆帐号即可上网。   漏洞证明：     修复方案：  以mac地址作为验证   版权声明：转载请注明来源 Asuimu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-02-23 11:55 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  话说DRCOM也是这样，你登陆后，你的IP就是可上网的。你直接拔了网线，然后别人设你这个IP照样上网。关键是客户端有心跳机制，10分钟左右，自动断网了    \n     2012-02-23 11:58 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  没用过楼主说的srun3000，不过应该也是差不多的东西，关键是“以通过验证的ip地址”哪里来的，是专门设置的可以上网的IP呢，还是用客户端登陆过的，后者的话，账户照样会扣钱吧？    \n     2012-02-23 12:55 |    \t\tAsuimu \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:46        )\t\t \n  @popok srun3000在10分钟后还能上~~    \n     2012-02-23 13:03 |    \t\tAsuimu \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:46        )\t\t \n  @popok 显然是后者，不过扣的是通过验证人的钱，至于以通过验证的ip，c段扫一下在线的，踢下去就行了，怎么踢就自由发挥了~~    \n     2012-02-23 18:51 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  @Asuimu 那就需要客户端加入类似心跳机制，MAC验证一样可以伪造    \n     2012-02-23 21:53 |    \t\tAsuimu \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:46        )\t\t \n  @popok 嗯，是的，不过厂商对此不太关心，呵呵~~    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}