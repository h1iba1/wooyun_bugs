{"id": 41782, "wybug_id": "wooyun-2014-087685", "wybug_title": "Doyo建站 SQL注入", "wybug_corp": "wdoyo.com", "wybug_author": "宇少", "wybug_date": "2014-12-25 15:41", "wybug_open_date": "2015-04-02 10:23", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-30：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-02-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向公众公开  简要描述： 两头牛在一起吃草，青牛问黑牛：“喂！你的草是什么味道？”黑牛道：“草莓味！”青牛靠过来吃了一口，愤怒地喊到：“你骗我！”黑牛轻蔑地看他一眼，回道：“笨蛋，我说草没味。” 详细说明：  #1 source\\message.php\nfunction add(){\t\tif($GLOBALS['G_DY']['vercode']==1){\t\tif(!$this->syArgs(\"vercode\",1)||md5(strtolower($this->syArgs(\"vercode\",1)))!=$_SESSION['doyo_verify'])message(\"验证码错误\");\t\t}\t\tif(!$this->syArgs('tid'))message(\"请选择栏目\");\t\t$tid=$this->syArgs('tid');\t\t$this->type=syDB('classtype')->find(array('tid'=>$tid),null,'molds,classname,msubmit');\t\tif($this->type['msubmit']!=1){\t\t\t$this->member->p_r($this->type['msubmit']);\t\t}\t\t$isshow = ($this->my['group']['audit']==1) ? 1 : 0;\t\t$user = ($this->my['id']!=0) ? $this->my['user'] : '游客';\t\t$fmolds = ($this->syArgs('fmolds',1)!='') ? $this->syArgs('fmolds',1) : '';\t\t$title = ($this->syArgs('title',1)!='') ? $this->syArgs('title',1) : $this->type['classname'];\t\t$body = ($this->syArgs('body',1)!='') ? $this->syArgs('body',1) : '';\t\t$row1 = array('tid' => $tid,'fmolds' => $fmolds,'faid' => $this->syArgs('faid'),'title' => $title,'addtime' => time(),'orders' => 0,'isshow' => $isshow,'user' => $user,'body' => $body,'reply'=>'');\t\t$row2=$this->fields_args('message',$tid);\t\t$add = syClass('c_message');$newv=$add->syVerifier($row1);\t\tif(false == $newv){\t\t\t$a=$add->create($row1);$row2=array_merge($row2,array('aid' => $a));\t\t\tsyDB('message_field')->create($row2);\t\t\tif($this->my['id']!=0){\t\t\t\tsyDB('member_file')->update(array('hand'=>$this->syArgs('hand'),'uid'=>$this->my['id']),array('hand'=>0,'aid'=>$a,'molds' => 'message'));\t\t\t}else{\t\t\t\tsyDB('member_file')->update(array('hand'=>$this->syArgs('hand'),'ip'=>GetIP()),array('hand'=>0,'aid'=>$a,'molds' => 'message'));\t\t\t}\t\t\tmessage('发布成功',$GLOBALS[\"WWW\"]);\t\t}else{message_err($newv);}\t}\nmessage 是可以控制的   漏洞证明：  正常情况是这样\n\n这里已经报错了 \n\n注入成功：\n\n   修复方案：  过滤！！   版权声明：转载请注明来源 宇少@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-04-02 10:23 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-25 16:07 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  扭扭扭    \n     2014-12-25 16:09 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  宇哥开始挖通用了。羡慕啊    \n     2014-12-25 16:12 |    \t\t宇少 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:41        | Jyhack-TeaM：bbs.jyhack.com 群:308694453...)\t\t \n  @泳少 有啥好羡慕的 你是大黑阔，你全家都是     \n     2014-12-25 16:17 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  @泳少 一句经典 你才是黑阔 你全家都是黑阔    \n     2014-12-25 18:13 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @zhxs @宇少 在黑我。。你们一个家族都是:-(    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}