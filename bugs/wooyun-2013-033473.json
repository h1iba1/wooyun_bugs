{"id": 9579, "wybug_id": "wooyun-2013-033473", "wybug_title": "东方财富网帐号暴力注册（burpsuite教科书）", "wybug_corp": "东方财富网", "wybug_author": "px1624", "wybug_date": "2013-08-04 18:14", "wybug_open_date": "2013-09-18 18:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "暴力注册", "东方财富网"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-18：\t细节向公众公开  简要描述： 貌似标题已经将详情全部暴露了，诶，不知道怎么写好，要么剑心给处理下标题？这个漏洞，可以说是对burpsuite的基础使用的一个教科书，想学习bp的朋友们可以关注下~ 详细说明：  1 注册位置提供给了用户三种选择，手机注册、邮箱注册、用户名注册。我们这次的漏洞说的就是利用邮箱注册。为什么呢？聪明的朋友们可能已经发现了，邮箱注册的位置没有验证码（其他两种方式都有验证码，可能这里是开发人员疏忽了）。\n\n2 输入自己的邮箱、填写好密码和昵称后注册。注册后会提示去邮箱验证，但是我发现不去验证邮箱，也可以登录帐号。这样注册没验证码，又不用验证邮箱，要是post数据中还没有token，服务端没有请求时间间隔限制的话，那么就可以去暴力注册了。 3 现在就去验证。随便输入邮箱、密码（这里我输入的是123456）、昵称。\n\n4 输入好之后点击注册同时用bp抓包（抓包前bp需先设置好代理，不会的请百度）。可以看到post数据中只有三个数据，并没有token神马的东西。那么只要这里没有限制post请求时间间隔限制，理论上就存在暴力注册了。\n\n5 选择将这条post数据send to intruder\n\n6 在positions中设置clear掉所有的变量，仅留下nick（这个是注册时候的用户名）\n\n7 在payloads中导入自己之前写好的用于注册的帐号的字典（我这里导入了30个帐号用于测试）。\n\n8 选择intruder的start attack进行暴力注册\n\n9 2秒钟就执行完毕了30个帐号的注册\n\n10 理论上来说整个过程已经测试完毕，但是我们还要验证下是否注册成功。随便选个帐号去登录下，选一个就可以了，因为上面的length显示的是一样的都是392，所以就是要么全部成功，要么全部失败。11 结果证明之前的分析和测试是完全没问题的，注册的帐号可以成功登录，不信你们自己试试（测试暴力注册的帐号：px0001到px0030 一共30个，密码：123456）。\n\n12 如果我注册几十万的账户呢？你们的数据库会不会爆？服务器不知道能不能扛得住。。。   漏洞证明：  见上面。   修复方案：  1 添加验证码2 post数据加token3 限制post请求发送的频率4 听说你们的礼物挺不错   版权声明：转载请注明来源 px1624@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2013-08-05 14:36 厂商回复： 验证码代码被注释了:( 现已恢复，谢谢提醒！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-04 18:43 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  纯粹是看教科书来了    \n     2013-08-04 18:55 |    \t\tYwiSax \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:4        | 淡定。)\t\t \n  看教程的路过    \n     2013-08-04 18:56 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  @xsser 为嘛百度用bp代理不了？    \n     2013-08-04 18:57 |    \t\t流星warden \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:8        | The quieter you become,the more you are ...)\t\t \n  纯粹是看教科书来了    \n     2013-08-04 19:11 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  burp拼错了。。。。。    \n     2013-08-04 19:13 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  哈哈哈哈哈，人家是burp。。。捉急啊。。。    \n     2013-08-04 19:16 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  是burpsuite @px1624 标题党啊    \n     2013-08-04 19:27 |    \t\t啦绯哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:107 漏洞数:20        )\t\t \n  老师好！    \n     2013-08-04 19:29 |    \t\tc2c2 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        )\t\t \n  教科书~    \n     2013-08-04 19:36 |    \t\t有妹子送上 \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:28        | 杭州最帅的男人)\t\t \n  马克    \n     2013-08-04 19:43 |    \t\t蘑菇 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | 没有做不到的，只有想不到的！)\t\t \n  路过关注学习！    \n     2013-08-04 19:48 |    \t\tRings \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | Try again.)\t\t \n  看教科书来了！    \n     2013-08-04 19:50 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小胖胖要减肥 额，标题写对着，简要描述手抖了一下，多敲了个n    \n     2013-08-04 19:50 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @Finger 我去。。怎么标题党了啊。。。    \n     2013-08-04 19:52 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @Finger 简要描述的多了个n，有时间帮改下额，英语不行的人伤不起啊~~    \n     2013-08-04 20:28 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @px1624 因为标题是错的  finger就帮你改了标题    \n     2013-08-04 20:55 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小胖胖要减肥 。。。诶。。不是标题错了，是单词写错了额    \n     2013-08-04 21:37 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  看书来啦 嘎嘎    \n     2013-08-04 21:53 |    \t\t猥琐 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 学习什么的最重要！)\t\t \n  马克教科书    \n     2013-08-04 22:42 |    \t\tCroxy \t\t\t( 普通白帽子  |\t\t\t        Rank:513 漏洞数:54        | 只会送人头)\t\t \n  老师好    \n     2013-08-05 08:13 |    \t\tMorker \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:24        | 双手是最重要的、、、)\t\t \n  又开课了    \n     2013-08-05 09:28 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  等着学习    \n     2013-08-05 09:58 |    \t\tAdra1n \t\t\t( 普通白帽子  |\t\t\t        Rank:437 漏洞数:68        )\t\t \n  学习。。。。    \n     2013-08-05 15:22 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @东方财富网 我去，才4rank？？    \n     2013-08-05 15:54 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @px1624 我的直接劫持才9      \n     2013-08-05 16:22 |    \t\tp0di \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:17        | 1+1 = 2 ？)\t\t \n  @px1624  老师好，这就是经典啊。没公开已经3人收藏    \n     2013-08-05 21:02 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @p0di 因为我也是从小白慢慢晋升为菜鸟的，所以我清楚新手求知欲的渴望，所以比较乐意分享一些自己的思路和方法。    \n     2013-08-05 21:02 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小胖胖要减肥 我觉得我的比你的严重。    \n     2013-08-05 22:40 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @px1624  WooYun: 快乐购认证设计的几处缺陷   3个漏洞集合才5分你就开朗了 一个就是注册的    \n     2013-08-05 22:43 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小胖胖要减肥 我56.com大礼包4rank     \n     2014-02-18 17:53 |    \t\twusuopubupt \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        | BUPTer, linux lover.)\t\t \n  学习~    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}