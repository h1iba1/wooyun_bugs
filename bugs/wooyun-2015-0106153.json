{"id": 38201, "wybug_id": "wooyun-2015-0106153", "wybug_title": "上海大智慧某站任意文件上传非授权访问导致代码执行", "wybug_corp": "上海大智慧", "wybug_author": "Tea", "wybug_date": "2015-04-06 11:07", "wybug_open_date": "2015-05-22 13:14", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-22：\t细节向公众公开  简要描述： 看给得高不高，不高就换着提了 详细说明：  这个漏洞： WooYun: 大智慧某后台授权绕过导致几万用户信息泄露 是修补好了，直接访问ERROR 404但是。在谷歌发现了个另外的后台“http://tg.gw.com.cn/tzzgx/admin/login.php”直接JS禁用掉~~然后看下面的效果图...直接上传PHP文件试试。http://tg.gw.com.cn/tzzgx/admin/add.php提示上传成功，没看到回显，于是找到了个注入。http://tg.gw.com.cn/tzzgx/admin/add.php?id=368 And 1=2 Union Select 1,pdf_path,3,4,5,6 from tzzgx where id=368--+把我上传的文件名给注入了出来。。有了文件名，没有了路径，我们扫一下。。http://tg.gw.com.cn/tzzgx/admin/upload/Good Job..http://tg.gw.com.cn/tzzgx/admin/upload/150406093742.php   漏洞证明：  \n\n\n\n\n\n\n\n\n\n   修复方案：  非授权先修补掉，然后任意文件上传修补掉，然后注入修补掉，最后服务器上面有不少分站，别人传的SHELL，都很久的时间了，删除掉。   版权声明：转载请注明来源 Tea@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-04-07 13:13 厂商回复： 已通知具体的运维负责人处理 最新状态： 2015-05-18：已修复  ", "replys": "漏洞评价：\n评论\n     2015-04-07 10:09 |    \t\t上海大智慧(乌云厂商)\t\t \n  感谢乌云对漏洞网页信息及时发现    \n     2015-04-07 14:11 |    \t\t小邪 \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:47        | ielts过过过)\t\t \n  呵呵 rank给的真够低的    \n     2015-05-22 15:52 |    \t\tHax0rs \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:4        | Hax0rs)\t\t \n  厂商真是够抠门的@上海大智慧    \n     2015-05-22 23:44 |    \t\t曙光的希望 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 曙光的希望)\t\t \n  能不能带我玩。。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}