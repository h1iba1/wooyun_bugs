{"id": 46720, "wybug_id": "wooyun-2014-083752", "wybug_title": "Win7以上系统360浏览器安全性低于IE（CVE-2014-6332漏洞可直接执行代码）", "wybug_corp": "奇虎360", "wybug_author": "路人甲", "wybug_date": "2014-11-18 17:18", "wybug_open_date": "2015-02-16 17:20", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "客户端程序设计错误", "浏览器"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-22：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-16：\t细节向公众公开  简要描述： 最近CVE-2014-6332漏洞poc已经公布，这个poc在xp系统上可以执行任意程序和命令，但在win7以上系统由于IE存在沙箱机制，无法启动cmd等白名单以外的进程，而win7以上系统，如果安装有360浏览器，访问此poc页面后，由于360浏览器存在设计漏洞，依然可以顺利启动cmd等任意程序。 详细说明：  详细的说，Win7以上系统的IE沙箱，使用了主要的2个安全机制：1.完整性机制：使渲染子进程以Low完整性启动，强制限制进程低权限，所有高权限操作请求，通过IE Broker后由主进程实现；而360浏览器虽然使用了IE核心，但是对此功能进行了缩水，没有使用IE的此安全机制；2.虚拟化机制：对文件、注册表的写入操作全部进行了重定向；   漏洞证明：  win7x64上的漏洞证明：\n\n\n\n\n\n\n\nwin8.1x64上的漏洞证明：\n\n\n\n\n\n\n\n   修复方案：  应该对浏览器渲染子进程能够启动的进程进行约束，IE和chrome沙箱的白名单机制可以借鉴。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-11-19 14:00 厂商回复： 感谢白帽子向我们反馈此问题：1.关于IE核心沙箱沙箱是浏览器深度防御机制中的一环，360浏览器默认运行Chrome内核上，是具备沙箱功能的我们会尽快在高版本系统上，某些切换到IE核心的情况下也应用沙箱机制，全面保护用户安全2.关于CVE 2014-6332 目前360安全卫士已经具备防御这个漏洞的能力，我们正在尽快升级360浏览器相应的防御组件，防御此漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-18 17:25 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  关注    \n     2014-11-18 17:41 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  mark    \n     2014-11-18 17:50 |    \t\t白非白 \t\t\t( 普通白帽子  |\t\t\t        Rank:447 漏洞数:60        | ♫ Freedom - Anthony Hamilton ♫)\t\t \n  piapia,轻点~疼    \n     2014-11-18 18:10 |    \t\t大白菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:19        )\t\t \n  。。有啥用，这是IE的问题    \n     2014-11-18 18:10 |    \t\t大白菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:19        )\t\t \n  你要是能在chrome上触发，你就发了    \n     2014-11-19 02:32 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  强势围观！    \n     2014-11-19 10:52 |    \t\tshineast \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:4        )\t\t \n  @大白菜 是IE vbs脚本引擎的问题，但是Win7以上IE的沙箱机制防御了此漏洞的利用，至少不能直接运行白名单以外的进程（例如cmd），而360浏览器一旦安装就提示用户将其设置为默认浏览器，用户一旦被这个漏洞挂马，将直接启动cmd执行任意命令。    \n     2014-11-19 14:18 |    \t\t我勒个去 \t\t\t( 实习白帽子  |\t\t\t        Rank:98 漏洞数:8        | 我勒个去)\t\t \n  厂商回复略不专业啊，用HTML可以指定让浏览器自动切换到哪个内核的吧。对比看了下，应该是浏览器活生生的把人家IE的进程Integrity从Low变成了Medium，表示只能呵呵~    \n     2014-11-19 22:04 |    \t\t大白菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:19        )\t\t \n  @shineast ...~！我的意思是，能不能挖到别的浏览器的，360浏览器公司都不用    \n     2014-11-23 07:46 |    \t\t邪恶魔法师 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | cat /proc/versioncat /etc/redhat-relea...)\t\t \n  故意放的后门吧    \n     2014-11-24 13:47 |    \t\t邪恶大咖 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        )\t\t \n  围观   0.0    \n     2014-11-25 12:14 |    \t\t草榴社区 \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:26        | 未满18周岁,不准进入.)\t\t \n  @我勒个去 顶科学家    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}