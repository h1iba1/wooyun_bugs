{"id": 86709, "wybug_id": "wooyun-2016-0190161", "wybug_title": "四川某市公积金查询网站getshell后泄漏全市370w+人的公积金详情/含身份证号/公积金详情/大量备份文件可打包下载", "wybug_corp": "四川某市公积金", "wybug_author": "路人甲", "wybug_date": "2016-03-28 23:20", "wybug_open_date": "2016-05-15 11:20", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-15：\t细节向公众公开  简要描述： 求首页全市370w人的公积金详情/含身份证号/工作单位/大量备份文件可打包下载 详细说明：  1.泸州市公积金贷款合同打印系统存在webdav 上传漏洞，可直接上传shell，漏洞网址：**.**.**.**:7003/直接利用iis写权限写入asp一句话的txt，然后通过move命令重命名为1.asp;.txt，利用iis6的解析漏洞得到shell。菜刀一句话：**.**.**.**:7003/1.asp;.txt     密码：xx\n\n2.菜刀成功连接。\n\n3.发现多个mdb数据库文件，大小为几十兆到几百兆不等，还有网站备份文件的压缩包，可整站打包下载了。\n\n\n\n\n\n\n\n\n\n4.发现网上查询系统的数据备份，约五十个压缩包，每个压缩包大小为70M到130M左右。也算是大量数据了吧。\n\n5.在D:\\dataupdate\\as400\\文件夹下发现7个txt，分别对应四县三区的共7个公积金数据库，全是从数据库里复制出来的个人公积金详情。\n\n6.打开最小的1个（gzhbk.txt）为例查看内容，发现是详细的个人信息和公积金缴纳信息。平均每2排是一个人的数据，这个共有11443排，除以二约为5721个人的信息，这里我们只是确认一下各个数据库导出文件保存的格式和所泄漏的信息。具体泄漏的数字见第8步。\n\n7.然后在log文件夹下面找到导入数据库信息的操作日志，可以查到7个库总共370w+条数据。\n\n8.里面发现了每个数据库拷贝了具体多少条信息，以刚才打开的gzhbk为例，发现共有5663个人的数据，和第6步估算的5721接近，说明这个日志文件是准确的，那么接下来我们就来算算7个数据库的日志文件里共有多少条个人信息，到底有多严重。共7个数据库分别有2764715、102875、44455、185939、579656、5663、24149人的数据，总计：3707452个，约370w。所以这7个txt文档里大约就有370w+的个人信息和公积金缴纳信息，一旦泄漏后果非常严重！！！\n\n\n\n\n\n\n\n\n\n\n\n\n\n这里仅仅是测试之用，只是为了测算一下泄漏的数量方便审核大大评定等级，证明危害性即可，未保存和传递任何公积金相关个人的资料。   漏洞证明：  如上   修复方案：  及时升级、打补丁。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2016-03-31 11:12 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT下发给四川分中心,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-28 23:47 |    \t\t小苹果 \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:59        | 只要锄头挥的好，哪有洞挖不到)\t\t \n  哥们儿，给厂商找漏洞是好事，但是删除修改系统内的内容这也就有点有违白帽子的职业道德了吧，导致现在公积金几个部门账号登陆异常了。    \n     2016-03-29 09:54 |    \t\tDNS \t\t\t( 普通白帽子  |\t\t\t        Rank:765 漏洞数:81        | root@qisec.com)\t\t \n  @小苹果 有基情    \n     2016-03-29 11:18 |    \t\t小苹果 \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:59        | 只要锄头挥的好，哪有洞挖不到)\t\t \n  泸Z 。。。。    \n     2016-04-20 11:25 |    \t\t小苹果 \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:59        | 只要锄头挥的好，哪有洞挖不到)\t\t \n  给了11个。370W    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}