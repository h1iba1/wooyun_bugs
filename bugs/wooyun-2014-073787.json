{"id": 51658, "wybug_id": "wooyun-2014-073787", "wybug_title": "逐浪cms多出存储型XSS(劫持cookie可以利用)", "wybug_corp": "逐浪CMS", "wybug_author": "xlz0iza1", "wybug_date": "2014-08-26 15:39", "wybug_open_date": "2014-11-21 15:40", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-31：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-21：\t细节向公众公开  简要描述： RT 详细说明：  看着大家都在挖注入，发现官网的测试站点也开始变态了，单引号都直接纳入非法注入检测。于是无奈之下就，看看都加都不关注的xss，防注入做得确实不错，但是这个跨站漏洞就是坑爹啊、第一处：OA办公系统http://demo.zoomla.cn/Mis/OA/第二处：社区互动http://demo.zoomla.cn/User/UserZone/Default.aspx   漏洞证明：  用OA系统办公系统打比方吧。首先我注册俩个账号分别为zaizai和zaizai1、1、用户zaizai1给用户zaizai发送一份邮件，标题处存在xss漏洞。\n\n2、用户zaizai打开邮箱就会触发漏洞。\n\n\n\n3、截取到的cookie可以自己拿来利用，用户zaizai1修改自己的cookie为用户zaizai的虽然没有显示为用户zaizai，但是可以获取他邮箱里面的内容和等一些操作。\n普通会员|zaizai1 2014年8月25日 星期一\n\nManageState=ManageId=1&LoginName=YWRtaW4=&TrueName=YWRtaW4=&Password=7fef6171469e80d32c0559f88b377245&Role=,1,&randNum=7872110513; WT_FPC=id=2c049e16f183bc9ad451408945989454:lv=1408945989454:ss=1408945989454; hasshown=1; __qc_wId=311; pgv_pvid=3011473620; users=; UserState=WorekNum=&UserID=17&LoginName=emFpemFp&Password=7a1f45cd86473541727d47c96b0ad231\n\n\n互动社区漏洞证明：\n\n\n\n这里我还提权一个点吧，结合这里的xss邮箱附件的地方是以用户名和文件名为路径的保存，在截取到管理员的cookie或者利用crsf工具，创建一个【用户名.asp】的用户，可以得到一枚鸡肋getshell。   修复方案：  不要只专心在注入。   版权声明：转载请注明来源 xlz0iza1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-11-21 15:40 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}