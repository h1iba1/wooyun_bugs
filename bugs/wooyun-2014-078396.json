{"id": 48190, "wybug_id": "wooyun-2014-078396", "wybug_title": "腾讯QQ浏览器IOS版URL欺骗漏洞", "wybug_corp": "腾讯", "wybug_author": "mramydnei", "wybug_date": "2014-10-05 18:32", "wybug_open_date": "2015-01-03 18:34", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-03：\t细节向公众公开  简要描述： 设计不合理导致可进行URL欺骗 详细说明：  QQ浏览器for ios会将页面中的title的body显示在地址栏当中，使URL欺骗成本大大降低，可能会间接导致用户遭受钓鱼攻击。先构造一个和mail.qq.com近似的域名，POC地址如下：\nhttp://mail.qq.com.cgi-bin.frame-html.siduz1gjqsctztfk8br0c141773e.x55.me\n随后，将页面的title设置为：\nhttp://en.mail.qq.com/cgi-bin/loginpage\n页面具体内容，都是从原始的mail.qq.com那边copy过来的。   漏洞证明：  当受害者通过QQ浏览器for ios打开钓鱼者的页面并尝试登录时的画面效果：\n\n微信和QQ也存在相似的问题，我就不一一截图了。不单是在ios上，在安卓上也是这样。由于它们没有地址栏我们也不能称其为URL欺骗。可以考虑一下，是否需要整改。\n\n   修复方案：  作为浏览器，我觉得在地址栏中显示title的body而不是原始地址是不合理的。如果结合Homoglyph Attack可能会让该类攻击在QQ浏览器中更加隐蔽。   版权声明：转载请注明来源 mramydnei@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2014-10-08 11:44 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-08 13:47 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  平均分又降低了。善哉    \n     2014-10-08 13:51 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  1分。。。还不如自己留着    \n     2014-10-08 16:20 |    \t\t小思 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 乌云杰出青年 | null)\t\t \n  1，呵呵    \n     2014-10-08 17:23 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  写个分析文章发drops里至少20WB，腾讯自从有了src在乌云这边态度就这样了。    \n     2014-10-08 17:35 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  @瘦蛟舞 这个问题很水的。发drops估计会被打死。lol    \n     2014-10-29 11:07 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  算通用吧？    \n     2015-01-05 21:43 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:75        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  缓存的问题吧？你打开那个页面之后清理下缓存再看看    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}