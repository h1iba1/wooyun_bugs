{"id": 50841, "wybug_id": "wooyun-2014-076615", "wybug_title": "豆果一处储存xss跨站漏洞，可泄露用户信息", "wybug_corp": "豆果网", "wybug_author": "oHtb", "wybug_date": "2014-09-19 13:44", "wybug_open_date": "2014-11-03 13:46", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-03：\t细节向公众公开  简要描述： 豆果一处储存xss跨站漏洞，可泄露用户信息 详细说明：  豆果个人头像上传时可以触发xss，上传个人作品也可以，但是个人作品那里做了长度限制，但是头像上传未做处理。拿到其他用户cookie之后，如果该用户用户兑换过积分，还可以拿到他的地址。   漏洞证明：  上传头像时加入onload，虽然这里禁止写入document.cookie，但是还是可以插其他语句的\n\n另外，豆果上传自己作品的时候也可以插onload，但是那里应该是设置了maxlength，想要插长语句不容易。只要用此用户去关注别人，别人就会收到私信提醒，只要打开提醒，出现此用户头像，就会中招。www.douguo.com/message/remind/3\n\n\n\n拿到cookie\n\n登入用户\n\n\n\n如果这个用户之前在积分商城兑换过东西，呵呵...\n\n   修复方案：  后台增加关键字判断   版权声明：转载请注明来源 oHtb@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-09-19 14:24 厂商回复： 感谢关注，已转给开发，我们会尽快修复。特别感谢你的支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}