{"id": 20215, "wybug_id": "wooyun-2012-07026", "wybug_title": " 易通企业网站系统(cmseasy) 权限提升 &amp; getShell通杀漏洞", "wybug_corp": "cmseasy", "wybug_author": "CodePlay", "wybug_date": "2012-05-14 15:47", "wybug_open_date": "2012-05-19 15:48", "wybug_type": "非授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "任意文件上传", "变量覆盖"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  易通企业网站系统(cmseasy) 注册用户在更新资料时和本地构造groupid表单(判断管理员权限 为888即为管理员)，可直接拿提升为管理权限,后台多处可以 getShell,只要开放注册 通杀 详细说明：  漏洞文件在 table.php中的  sql_update($tbname,$row,$where)  函数 \nfunction sql_update($tbname,$row,$where) {        $sqlud='';        if (is_string($row))            $sqlud=$row.' ';        else            foreach ($row as $key=>$value) {                if (in_array($key,explode(',',$this->getcolslist()))) {                    $value=addslashes($value);                    if (preg_match('/^\\[(.*)\\]$/',$value,$match))                        $sqlud .= \"`$key`\".\"= \".$match[1].\",\";                    elseif ($value === \"\")                        $sqlud .= \"`$key`= NULL, \";                    else                        $sqlud .= \"`$key`\".\"= '\".$value.\"',\";                   }            }        $sqlud=rtrim($sqlud);        $sqlud=rtrim($sqlud,',');        $this->condition($where);        $sql=\"UPDATE `\".$tbname.\"` SET \".$sqlud.\" WHERE \".$where;        return $sql;    }\n循环遍历 POST  值    然后直接写入数据库更新  导致用户可以自定义权限判断字段 权限提升漏洞     漏洞证明：  注册用户名  编辑资料\n\n得到管理权限(ps: 后台超炫)\n\nGetShell\n\n   修复方案：  不要把前台用户和普通会员放到一个表,任意权限提升 ,  取消table.php 中的函数sql_update 函数 或做出相应过滤 。   版权声明：转载请注明来源 CodePlay@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-05-19 15:48 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-19 22:29 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  牛    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}