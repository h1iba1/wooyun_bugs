{"id": 24261, "wybug_id": "wooyun-2010-0129", "wybug_title": "优酷网持久xss、设计缺陷、用户权限越权", "wybug_corp": "优酷", "wybug_author": "blue", "wybug_date": "2010-07-29 01:31", "wybug_open_date": "2010-08-28 03:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "认证设计不合理", "密码破解", "权限绕过", "用户敏感数据泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-07-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t1970-01-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t1970-01-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t1970-01-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t1970-01-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2010-08-28：\t细节向公众公开  简要描述： 持久xss(有字数限制)、设计缺陷、几处严重用户权限越权 详细说明：  1.个人空间的“修改样式”功能，只是在保存前做了js判断，并没有对实质内容进行过滤，导致持久型xss。(expression(alert(1)) 在IE6,IE8下测试通过，此处有字数限制)2.xss得到cookie，cookie中对密码的存储只是一次md5后的密码，获取后可一定程度上破解。3.权限越权:登录后,可查看他人来往信件(只要更改下面地址的数字id)查看、修改他人专辑信息请自行测试是否有其它xss或越权问题   漏洞证明：  持久xss:http://u.youku.com/user_show/uid_jquery2 (IE查看)越权：http://u.youku.com/my_mail/type_read_ref_inbox_id_52379500_desc_1?__rt=1&__ro=myInboxListhttp://u.youku.com/my_mail/type_read_ref_outbox_id_52380790_desc_1?__rt=1&__ro=myOutboxListhttp://u.youku.com/my_video/type_editfolder_step_1_id_4774704?__rt=1&__ro=myPlaylistList   修复方案：  1.严谨判断用户输入2.建议修改cookie机制，如改变密码加密方式、HttpOnly.3.严谨判断用户权限   版权声明：转载请注明来源 blue@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2010-07-29 01:31 厂商回复： 修复中 最新状态： 2010-09-14：已经修复  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}