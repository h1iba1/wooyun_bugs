{"id": 17225, "wybug_id": "wooyun-2012-012862", "wybug_title": "绕过六间房舞曲VIP和随意进限制", "wybug_corp": "六间房", "wybug_author": "F1n9er", "wybug_date": "2012-09-29 11:21", "wybug_open_date": "2012-10-04 11:22", "wybug_type": "未授权访问/权限绕过", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-10-04：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 绕过舞曲房间的VIP和随意进限制 详细说明：  当房间人满3000的时候会提示你进不去。如果在弹出这个窗口之前获取网页源码。然后再弹出之后修改为弹出网页之前的源码可以绕过VIP和随意进限制。   漏洞证明：  \n\n之后\n\n之前弹窗之后 去掉下面这段代码即可。\ndefault://正常模板\t\t\tpage.uid=pageMessage.user.uid;\t\t\tvar _iszhan = parseInt('0');\t\t\tif(page.puid != page.uid && page.liveType ==0 && (page.myVideo.url!=''||_iszhan==1) ){  // 录像\t\t\t\tpage.isVideo=1;\t\t\t\tif(_iszhan==1){\t\t\t\t\tswfobject.embedSWF('apple/musicPlayer/smallShow.swf', 'videoPlayer', 464, 457, '10.1', page.noF, {uid:page.rid}, {wmode:'opaque'});\t\t\t\t\tdocument.getElementById('preTopGift').style.display='none';\t\t\t\t}else{\t\t\t\t\tvar vvp=page.myVideo.type==2 ? page.VplayerPP: page.Vplayer;\t\t\t\t\tswfobject.embedSWF(vvp, 'videoPlayer', page.fw, page.fh, '10.1', page.noF, {vid:page.myVideo.url, pvid:page.myVideo.url, flag:1, model:1}, {wmode:'transparent'});\t\t\t\t}\t\t\t}else{\t\t\t\tif(page.puid == page.uid){ // 房主\t\t\t\t\tvar g_fx264installed=false;\t\t\t\t\t(function(){\t\t\t\t\t\t\ttry{\t\t\t\t\t\t\t\tg_fx264installed=PlugTest();\t\t\t\t\t\t\t}catch(e){\t\t\t\t\t\t\t\tsetTimeout(arguments.callee, 50);\t\t\t\t\t\t\t\treturn;\t\t\t\t\t\t\t}\t\t\t\t\t\tvar userInfo = Login.getUserInfo();\t\t\t\t\t\tpage.liveMaster=1;\t\t\t\t\t\tmemo=encodeURIComponent(\"{'url':'\"+location.href+\"'}\");//参数集\t\t\t\t\t\t//var wmode = Browser.firefox?'window':'opaque';\t\t\t\t\t\tswfobject.embedSWF(page.Mplayer, \"videoPlayer\", page.fw, page.fh, \"10.1\", page.noF, {uid: page.uid, userName: pageMessage.user.username, userPassword:userInfo.pwd, fx264:g_fx264installed, cooperateid:'', memo:memo, v6size:'400*300'}, {wmode:'opaque', allowscriptaccess:'always'}, {id:'videoPlayer'});\t\t\t\t\t\tif(page.liveType ==0 && page.myVideo.url!=''){\t\t\t\t\t\t\tvar _div = document.createElement('div');\t\t\t\t\t\t\t\t_div.id='changePlayerBtn';\t\t\t\t\t\t\t\t_div.className='vVideoBtn';\t\t\t\t\t\t\t\t_div.innerHTML = '<em onclick=\"return changePlayer()\"></em>';\t\t\t\t\t\t\tdocument.getElementById('video').appendChild(_div);\t\t\t\t\t\t}\t\t\t\t\t})();\t\t\t\t\t\t\t\t}else{\t\t\t\t\tvar autoPlay = page.liveType==10?'true':'';\t\t\t\t\tswfobject.embedSWF(page.Fplayer, 'videoPlayer', page.fw, page.fh, '10.1', page.noF, {mute:0, fileName:(page.flvTitle&&page.flvTitle[1].flvtitle?page.flvTitle[1].flvtitle:''), autoplay:autoPlay/*自动取流*/, libUrl:'http://rio.6rooms.com/lib/lib.asp', ServerURL:page.uploadurl}, {allowscriptaccess:'always',wmode:'Opaque'});\t\t\t\t\t\t\t\t\t}\t\t\t}\t\t}}).script(JSF.mt).wait().script(JSF.z).wait(function(){\tif($6('myAccountTool')){\t\tcontrolCenter = new ControlCenter({centerBtn:$('myAccountTool')});\t}\t\tif(Browser.name == 'ie' && Browser.version == 6){\t\t$LAB.script(JSF.png).wait(function(){\t\t\tDD_belatedPNG.fix('.talentshowIco');\t\t})\t}}).script(JSF.room).wait(function(){\tAddReady(function(){\t\tsetTimeout(function(){\t\t\tvar _imgs = document.getElements('img[data-src]');\t\t\tfor(var i=0; i<_imgs.length; i++){\t\t\t\t_imgs[i].src = _imgs[i].getAttribute('data-src');\t\t\t\t_imgs[i].removeAttribute('data-src');\t\t\t}\t\t},500);\t\tRoom.init();\t});}).script(JSF.im).script(JSF.mission);if(__tpl__!='game'){ //边栏\t$LAB.script(JSF.gmsg);}</SCRIPT>\n   修复方案：  禁止修改即可。   版权声明：转载请注明来源 F1n9er@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-10-04 11:22 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-09-29 14:09 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  洞主好这口    \n     2012-09-29 14:27 |    \t\tF1n9er \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 、)\t\t \n  @xsser  大家都爱这口。    \n     2012-10-07 13:23 |    \t\tSunshine \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:10        | Nothing.)\t\t \n  六间房是搞这个？    \n     2013-12-19 15:34 |    \t\t邪少 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:7        )\t\t \n   - -厂商好好笑。自己修复了。然后忽略    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}