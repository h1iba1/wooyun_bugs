{"id": 86716, "wybug_id": "wooyun-2016-0186460", "wybug_title": "P2P金融安全之北京银行直销银行任意账户登录", "wybug_corp": "北京银行", "wybug_author": "咚咚呛", "wybug_date": "2016-03-28 19:50", "wybug_open_date": "2016-05-15 11:20", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["金融小能手"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-15：\t细节向公众公开  简要描述： 北京银行直销银行是一个在线提供金融服务系统，涵盖更惠存、更慧赚、更会贷、更汇付等多个产品体系。此次风险影响北京银行直销银行的所有账户。 详细说明：  此风险漏洞在密码找回功能中，漏洞利用必须要具有被攻击者的姓名及身份证号，故此处风险有所缩小，建议配合其他漏洞一同使用。漏洞利用过程如下：1、首先正常操作密码找回功能，可知其流程如下，\n\n正确填写姓名及身份证号码，手机号会自动从服务端返回(这个风险也提下)，填入正确的图形验证码，点击获取手机验证码后，填入任意短信验证码如123456，如图：\n\n之后截断数据，如图：\n\n不对数据包做任何修改，截断response的返回包，如图：\n\n可知其验证码校验错误，篡改response返回包内容，为了让它后面正确的生成token和加密，如图：\n\n\n{\"ec\":\"0\",\"em\":\"\",\"TranResult\":null,\"bindflag\":null,\"EAcFlag\":null,\"EAcStatus\":null,\"sequenceNo\":\"1019287160\",\"windowId\":\"null\"}\n放行后可以跳到密码修改界面，如图：\n\n此处就可以填写你要篡改的密码即可，如图：\n\n可以完美的篡改了相关用的密码。且可以正常登录，由于是刚申请的新用户，还没审核通过，登录后就这德行，讲究这看吧。\n\n   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  建议在对密码修改的关键数据包中加入短信验证参数，防止分部绕过。   版权声明：转载请注明来源 咚咚呛@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-03-31 11:15 厂商回复： CNVD未复现所述情况,已经转由CNCERT向银行业信息化主管部门通报,并抄报北京分中心协助处置,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-28 20:28 |    \t\tBMa  \t\t\t( 核心白帽子 |\t\t\t        Rank:2039 漏洞数:225        )\t\t \n  通用？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}