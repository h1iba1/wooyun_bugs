{"id": 8386, "wybug_id": "wooyun-2013-037929", "wybug_title": "多玩网可以卡任何高于OW权限的灰色马甲", "wybug_corp": "广州多玩", "wybug_author": "佩佩", "wybug_date": "2013-09-24 11:27", "wybug_open_date": "2013-11-08 11:27", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-08：\t细节向公众公开  简要描述： 多玩网某应用设计缺陷，无验证. 详细说明：  多玩网某应用设计缺陷，无验证.导致可以卡任何高于OW权限的灰色马甲,配合另外一个漏洞，可以卡任何ID的马甲.连公会频道创始人(OW)都无法权限!   漏洞证明：  这是激活码邀请申请入会进行身份验证出的逻辑验证不严的问题.没有对身份进行验证。在这之前.我发现了激活码申请入会这个地方,有个很奇葩的地方。可以进行文档表格导出查看激活码。这个功能本来是为了方便OW，但我换位思考，把自己设想成多玩的技术,一般人都会忽略进行2次验证。这里也是利用了隐藏表单提交的手法，于是我习惯性的打开firfox 安好firbug本来直接想用firbug进行调试,但是我习惯了打开burp进行抓包如图:\n\n其中invitecodecount 代表是激活码数量    expireDate      代表时间    inviteciderole  代表激活码的马甲身份 这图里的100 代表的是会员数值是100 嘉宾则是80    最下面的这个jsessionid 是官方这几天加的验证..官方前几天就注意到我这个问题,但是没封完善。我还没提交乌云就先处理了。可能我身边太多接触的官方朋友吧.    这里的jsessionid 是对导出的频道序列号文档进行的验证。我们这里抓包修改频道号 其中 sid 就是频道号 修改成想要的频道就可以任意在任何ID卡任何马甲了...不过多玩的技术现在加了这个验证.但是没有对验证的身份.时间。以及其他参数进行验证.     所以接下来。。我们直接在inviteciderole 这个数值 修改成其他任意的数值。就代表着一个官方不存在的马甲，样子跟系统卡了的时候的临时嘉宾一样显示灰色。如图:\n\n    这个马甲 连OW都不能权限.也不能踢。配合之前的卡任何ID的漏洞 十分严重.刷什么广告,也不能踢人.不过好在没人发现.我就测试了赶紧提交了.在所在公会信息里显示的是如图：\n\n我认为这个漏洞挺严重的.而且没有几个人知道,所以赶快提交了.自己测试卡了几个,请多玩的技术哥哥看到跟秩序组的哥哥姐姐们说声别封我的号.往歪歪投了好多心血了.我一直都是一名白帽子并以身做则,没有拿这个干坏事情.也是虾哥论坛的一员.一直联系不到厂商。有些漏洞不能积极反映。 爱多玩好久了。求厂商联系。求个5位歪歪激活码吧。   修复方案：  漏洞修复: js验证.你们比我更专业.更速度!   版权声明：转载请注明来源 佩佩@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-09-25 09:28 厂商回复： 感谢对于欢聚时代安全工作的支持，我们会尽快安排修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-24 13:52 |    \t\tMas \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:15        )\t\t \n  我想进妹子YY 始终没有权限说话 所以我点了关注 希望对我有用    \n     2013-09-24 15:28 |    \t\t佩佩 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:8        | 一个热衷于网络安全的白帽子,具有很强的逻...)\t\t \n  @Mas  交流ID YY:480  上线了找OW 就行了。注明乌云白帽子    \n     2013-09-25 10:45 |    \t\t阿峰 \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:9        | 关注网络安全，人人有责。)\t\t \n  希望厂商继续主动忽略，细节向公众公开。    \n     2013-09-25 19:45 |    \t\tiiiiiiiii \t\t\t( 普通白帽子  |\t\t\t        Rank:680 漏洞数:89        | )\t\t \n  @佩佩 真的吗？    \n     2013-09-25 21:31 |    \t\t佩佩 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:8        | 一个热衷于网络安全的白帽子,具有很强的逻...)\t\t \n  @iiiiiiiii 真的啊。怎么了-.-    \n     2013-09-27 18:17 |    \t\tiiiiiiiii \t\t\t( 普通白帽子  |\t\t\t        Rank:680 漏洞数:89        | )\t\t \n  @佩佩 那你是男的还是女的。    \n     2013-10-09 19:18 |    \t\tNCK_上官 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | BND技术联盟（N客）我的兄弟)\t\t \n  @阿峰 这种漏洞厂商会忽略吗0.0    \n     2013-10-09 19:19 |    \t\tNCK_上官 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | BND技术联盟（N客）我的兄弟)\t\t \n  @佩佩 我能不能去啊0.0   妹纸    \n     2013-10-09 22:00 |    \t\t佩佩 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:8        | 一个热衷于网络安全的白帽子,具有很强的逻...)\t\t \n  @NCK_上官 忽略你妹啊..歪歪最重要的就是马甲权限,在厂商眼里比xss重要多了    \n     2013-10-16 18:26 |    \t\tNCK_上官 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | BND技术联盟（N客）我的兄弟)\t\t \n  @佩佩 貌似没我事....    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}