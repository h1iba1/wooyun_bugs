{"id": 12476, "wybug_id": "wooyun-2013-022132", "wybug_title": "方正宽带秒改任意用户密码，可查看任意用户宽带信息", "wybug_corp": "方正宽带", "wybug_author": "koohik", "wybug_date": "2013-04-19 13:01", "wybug_open_date": "2013-06-03 13:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-03：\t细节向公众公开  简要描述： 方正宽带秒改用户密码，可查看宽带用户信息 详细说明：  先通过注册邮箱找回密码，然后我们在邮箱里面找到重置密码链接\n\nhttp://www.bnchina.com/user/repassword/userid/60xxx1366333027找回密码链接后面组合是用户id+时间戳不过后来经过验证发现，这个时间戳根本就没有用处，前面的用户id才是最重要的，修改ID即可修改此ID的用户密码，也没有什么验证\n\n直接修改新密码然后使用新密码登陆\n\n\n\n另一处漏洞任意验证注册邮件的漏洞，此漏洞和上面的相似\n\n注册新用户，注册成功会验证邮件，但是url地址返回注册用户的id，通过测试发现下面的链接即可激活当前用户输入的邮箱地址http://www.bnchina.com/member/changepass/userid/注册用户ID1366281757这个也是用户id+时间戳直接打开就激活成功了\n\n   漏洞证明：  如上图   修复方案：  更改加密方式或者其他。。。   版权声明：转载请注明来源 koohik@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-04-19 14:16 厂商回复： 感谢，已经确认，正在处理 最新状态： 2013-04-22：经过内部协调相关部门，核实漏洞确实存在，第一时间把所涉及问题的网站入口全部关闭，所涉及的bug及程序漏洞不影响社区用户的使用。感谢koohik和px1624       ", "replys": "漏洞评价：\n评论\n     2013-04-19 13:05 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  脑海中回荡的一句话。。。欢迎欢迎，热烈欢迎。。。    \n     2013-04-19 13:08 |    \t\tkoohik \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:63        | 没什么介绍的http://www.koohik.com/)\t\t \n  @疯狗 哈哈    \n     2013-04-19 13:57 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  我觉得，你应该将任意二字去掉额。。。    \n     2013-04-19 13:58 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @px1624 呃？你也找到了？    \n     2013-04-19 14:12 |    \t\tkoohik \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:63        | 没什么介绍的http://www.koohik.com/)\t\t \n  @px1624 遍历一下，是可以找到用户名的吧，这样说任意也可以的吧    \n     2013-04-19 14:31 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @疯狗 我昨晚私下给厂商提交了。破admin搞了半天，没找到对应的userid 然后就私下提交了 密码重置和四五个潜在漏洞。。因为最近密码重置 提交的有点多，所以就没忍心再来刷了。。。    \n     2013-04-19 14:34 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @koohik 不要只说可以，你去试试就知道可以不可以了。这个是剑心之前教导我的，不要只说理论可以，要拿出证据。可以告诉你，只能遍历到一部分，admin有被特殊处理的    \n     2013-04-19 14:57 |    \t\tkoohik \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:63        | 没什么介绍的http://www.koohik.com/)\t\t \n  @px1624 刚才我也去跑了一下。。。这个admin是否在用户表就不得而知了    \n     2013-04-19 14:59 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  呃，为何才5分。。    \n     2013-04-19 15:00 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @px1624 soga...    \n     2013-04-19 15:18 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @疯狗 可能是洞主把危害夸大了，加之我在他之前已经私下提交过了的原因吧    \n     2013-04-19 15:20 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @koohik 嗯，我觉得要么就没在这个表中，重置admin密码在另一个逻辑系统中。要么就是做了特殊处理，比如userid搞个负数，或者指定的一个数字，或者字母之类的。    \n     2013-04-19 15:21 |    \t\tkoohik \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:63        | 没什么介绍的http://www.koohik.com/)\t\t \n  @px1624 嗯，很有可能是这样的    \n     2013-04-19 15:25 |    \t\tkoohik \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:63        | 没什么介绍的http://www.koohik.com/)\t\t \n  @疯狗 至于为什么是5分，这个就不知道了，刚才随便跑了一下，还没有跑完，差不多可以重置2W+的用户密码了，危害算起来也不低了。。。    \n     2013-04-19 15:28 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @koohik 因为我在你之前私下提交过了。。。基本也就是2w多，不过没啥信息价值。能搞到admin 才给力额    \n     2013-04-19 15:43 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @koohik @px1624 能改2w+用户的密码对于厂商影响确实挺大的，因为可能涉及宽带申请人信息，上网密码等    \n     2013-04-19 15:49 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @疯狗 你去看下就知道，没啥有用信息，上网密码就更没有了。不然我也不会不来乌云提交的，哈哈，刷多了，也会不好意思的。。。    \n     2013-04-22 16:54 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @方正宽带 2013-04-22：经过内部协调相关部门，核实漏洞确实存在，第一时间把所涉及问题的网站入口全部关闭，所涉及的bug及程序漏洞不影响社区用户的使用。感谢koohik和px1624厂商好给力！    \n     2013-04-22 18:39 |    \t\tkoohik \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:63        | 没什么介绍的http://www.koohik.com/)\t\t \n  @疯狗 @方正宽带 确实给力哈，不过最好还是修复一下先。    \n     2013-04-22 18:45 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @疯狗 哈哈。看我没乱说吧、、我是提前给通知了，吼吼~~虽然把我名字写在了后面，嘎嘎~    \n     2013-05-20 22:54 |    \t\t木头 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:5        | 一二三，木头人)\t\t \n  上网记录查询的那个图，为啥2012年11月的上网时长为32天3小时多呢？    \n     2013-05-21 12:03 |    \t\t10457793 \t\t\t( 普通白帽子  |\t\t\t        Rank:867 漏洞数:29        | 说好的借，为什么从来不还？O(∩_∩)O)\t\t \n  @木头 多次宽带拨号导致的    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}