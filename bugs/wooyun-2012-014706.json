{"id": 15462, "wybug_id": "wooyun-2012-014706", "wybug_title": "苏宁易购会员中心某验证功能权限设计错误", "wybug_corp": "江苏苏宁易购电子商务有限公司", "wybug_author": "纷纭", "wybug_date": "2012-11-13 15:21", "wybug_open_date": "2012-12-28 15:22", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "7", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口未加权限认证", "安全意识不足", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-12-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-12-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-28：\t细节向公众公开  简要描述： 苏宁易购会员中心某功能权限无验证，容易造成权限以外的滥用。 详细说明：  1.苏宁易购会员中心，有一个手机验证功能。该功能为了方便会员绑定手机。2.手机绑定，需要先通过邮箱认证，该过程需要输入验证码进行。3.通过邮箱验证获取验证码后，可以进行手机验证，但是不限定手机号码，也不需要验证码，仅仅输入手机号，即可获取验证码，而且所谓的60秒等待再发功能是通过网页JS控制的，实际上无时间限制。4.通过抓包后再次提交进行权限验证，该手机验证码发布接口，未做任何验证，没有对提交来源，提交次数，提交号码等做出验证，通过该接口可以无限制的提交手机验证请求。通过简单的编程可以瞬间对某号码发出上千条验证码，可以简单的来制作一个“手机短信轰炸机”。   漏洞证明：  1.在后台按照常规的验证手机号的步骤进行验证，通过邮箱验证后，可以进行手机号验证，对手机号验证过程进行抓包。\n\n\n\n2.验证完毕后，手机接到验证码，转到抓包工具中，可以看到网页端提交了2个请求。\n\n我提交了2次获取验证码，得到4条请求信息，经查看，第一条是验证号码信息是否合法的，没有意义，第二条请求是发送手机验证码的。通过POST(实际上是GET也可以)协议，提交一个请求：https://member.suning.com/emall/SNMemberCardValidCtrlCmd?cellphone=手机号&action=send&step=bindEmail没有任何来源验证，或者权限验证，也没有次数以及手机号码的验证，验证短信瞬间就到你手机了。3.简单的编写一个小程序，或者通过PHP编程，甚至做个网页刷新工具，不停的刷新就会发现，瞬间你的手机多了N多的苏宁易购“温馨提示”，简单的提交了几条。大家研究下。\n\n4.苏宁易购的短信网关不知道收费不。如果刷十万条要不要钱。   修复方案：  1.加入权限验证，非用户禁止提交。2.加入时间验证，如60s一次。3.加入号码验证。某号码一段时间内只允许发N条。   版权声明：转载请注明来源 纷纭@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2012-11-13 17:46 厂商回复： 感谢提交，我们加紧整改 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}