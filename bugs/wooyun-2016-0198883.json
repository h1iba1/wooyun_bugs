{"id": 87479, "wybug_id": "wooyun-2016-0198883", "wybug_title": "Uber社区存在多个漏洞(可执行任意SQL)                                      ", "wybug_corp": "优步Uber", "wybug_author": "猪猪侠", "wybug_date": "2016-04-21 15:00", "wybug_open_date": "2016-06-06 05:00", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-06：\t细节向公众公开  简要描述： Uber社区存在多个漏洞，可进入系统后台，可执行任意SQL，影响8W会员dig www.uber.com.cn , 解析结果和uber主站在同一IP上 详细说明：  #0 影响描述dig ubernihao.comdig uber.com.cn记录显示，部署在同一个网络内部#1 .git 文件导致整站源码泄露\npython wyspider.py http://cms.ubernihao.com--------------------------------------------------* scan http://cms.ubernihao.com start--------------------------------------------------[200] http://cms.ubernihao.com => http://cms.ubernihao.com/[200] http://cms.ubernihao.com/login.html => http://cms.ubernihao.com/login.html[200] http://cms.ubernihao.com/.git/config => http://cms.ubernihao.com/.git/config--------------------------------------------------* scan complete...--------------------------------------------------{  \"dirs\": {    \"http://cms.ubernihao.com\": [      \"http://cms.ubernihao.com/\"    ]  },   \"files\": {    \"http://cms.ubernihao.com\": {      \"/.git/\": [        \"http://cms.ubernihao.com/.git/config\"      ],       \"/\": [        \"http://cms.ubernihao.com/login.html\"      ]    }  }}\nhttp://cms.ubernihao.com/.git/config\n[core]\trepositoryformatversion = 0\tfilemode = true\tbare = false\tlogallrefupdates = true[remote \"origin\"]\tfetch = +refs/heads/*:refs/remotes/origin/*\turl = git@git.oschina.net:muzhibuluo/uber_cms_v2.git[branch \"master\"]\tremote = origin\tmerge = refs/heads/master\n\n\n#2 系统调试日志、错误日志、访问日志可远程访问http://code.ubernihao.com/logs/\nIndex of /logs/../access.log                                         21-Apr-2016 06:32    357Mdebug.log                                          21-Apr-2016 06:32    440Mdebug.log-2016-04-13                               13-Apr-2016 09:42     71Kdebug.log-2016-04-14                               14-Apr-2016 17:34    174Kdebug.log-2016-04-15                               16-Apr-2016 15:59    293Mdebug.log-2016-04-16                               17-Apr-2016 15:59    260Mdebug.log-2016-04-17                               18-Apr-2016 08:16    152Mdebug.log-2016-04-18                               19-Apr-2016 15:59    129Mdebug.log-2016-04-19                               20-Apr-2016 09:28     85Mdebug.log-2016-04-20                               21-Apr-2016 04:01     92Merror.log                                          21-Apr-2016 06:32    329Minfo.log                                           21-Apr-2016 06:32    685M\n   漏洞证明：  #3 日志泄露大量敏感信息用户的访问TOKEN，登录密码信息\n[2016-04-13 16:21:26.008] [INFO] http - 116.23.126.182 - - \"PUT /adminUsers/1?authorization=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJpZCI6MSwidHlwZSI6ImxvY2FsIiwiaWF0IjoxNDYwNTM1NjcwLCJleHAiOjE0NjI2MDkyNzB9.dscvgrWIzwL-Kl_jeElfAes93RLGRC3gG4nxa2BwTzU HTTP/1.0\" 200 196 \"http://cms.ubernihao.com/index.html\" \"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.76 Mobile Safari/537.36\"[2016-04-13 16:21:26.046] [DEBUG] mysqlDb - query sql : select id,email,nickname,cities,level,create_time as createTime from admin_user where level>=:level { level: '0' }[2016-04-13 16:21:26.047] [DEBUG] mysqlDb - formatedSql: select id,email,nickname,cities,level,create_time as createTime from admin_user where level>='0'[2016-04-13 16:21:26.049] [DEBUG] mysqlDb - operator back rows length :  1[2016-04-13 16:21:26.050] [INFO] http - 116.23.126.182 - - \"GET /adminUsers/manage?cities=*&level=0 HTTP/1.0\" 304 - \"http://cms.ubernihao.com/index.html\" \"Mozilla/5.0 (Linux; Android 6.0; Nexus 5 Build/MRA58N) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.76 Mobile Safari/537.36\"[2016-04-13 16:21:37.959] [ERROR] app.js - NoUnauthorizationHeader /adminUsers?email=muzhi&passwd=uber undefined undefined undefined undefined\n明文密码传输获取\ncat debug.log-2016-04-16 | grep passwd[2016-04-17 00:48:14.330] [ERROR] app.js - NoUnauthorizationHeader /adminUsers?email=muzhi&passwd=ubernihao undefined undefined undefined undefined[2016-04-17 00:48:14.334] [DEBUG] mysqlDb - query sql : select id,email,nickname,passwd,cities,level,status,create_time,create_by,update_time,update_by from admin_user where 1=1  and email='muzhi' and passwd='f1a89ad1f8388af2fe5b99ee07d2f468' order by  id desc[2016-04-17 00:48:14.336] [INFO] http - ::ffff:127.0.0.1 - - \"GET /adminUsers?email=muzhi&passwd=ubernihao HTTP/1.1\" 200 270 \"\" \"undefined\"[2016-04-17 14:31:32.614] [ERROR] app.js - NoUnauthorizationHeader /adminUsers?email=gz01&passwd=gz0101 undefined undefined undefined undefined[2016-04-17 14:31:32.618] [DEBUG] mysqlDb - query sql : select id,email,nickname,passwd,cities,level,status,create_time,create_by,update_time,update_by from admin_user where 1=1  and email='gz01' and passwd='e6144bda3a2f257ac9b59c9007bd9dbb' order by  id desc[2016-04-17 14:31:32.620] [INFO] http - ::ffff:127.0.0.1 - - \"GET /adminUsers?email=gz01&passwd=gz0101 HTTP/1.1\" 200 260 \"\" \"undefined\"\n#4 利用调试信息里面找到的用户信息进入后台\n\n\n\n\n\n\n\n   修复方案：  加强安全意识，就这样   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-04-22 04:54 厂商回复： 谢谢您提供的信息，我们正在尽快处理中 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-21 15:03 |    \t\tjye33 \t\t\t( 普通白帽子  |\t\t\t        Rank:1255 漏洞数:286        | 没有什么能够阻挡，我对静静的向往)\t\t \n  靠    \n     2016-04-21 15:06 |    \t\t87技术联盟-Jack \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 来自于浩瀚网络中的小白！)\t\t \n  前排    \n     2016-04-21 15:16 |    \t\t路人毛 \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:64        | 要想Rank给高，标题一定得屌)\t\t \n  我擦    \n     2016-04-21 15:21 |    \t\t土夫子 \t\t\t( 普通白帽子  |\t\t\t        Rank:475 漏洞数:85        | 看似山穷水尽，终将柳暗花明)\t\t \n   猪哥霸气    \n     2016-04-21 15:26 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1137 漏洞数:200        | px1624)\t\t \n  能解封不？帮我解封下啊~    \n     2016-04-21 15:43 |    \t\thoopyoung \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:13        | I'm here to Protect You)\t\t \n  猪哥又出动了，不用看，股票又跌了。    \n     2016-04-21 15:49 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:1553 漏洞数:375        | bye)\t\t \n  猪哥又收割了100万    \n     2016-04-21 15:57 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:5265 漏洞数:404        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @hoopyoung 暴跌啊    \n     2016-04-21 15:58 |    \t\t刘海哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:135 漏洞数:30        | 索要联系方式但不送礼物的厂商定义为无良厂...)\t\t \n  @hoopyoung 哈哈    \n     2016-04-21 16:10 |    \t\t猪猪侠的男朋友 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        )\t\t \n  乌云股市播报者:猪猪侠    \n     2016-04-21 16:54 |    \t\t路人毛 \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:64        | 要想Rank给高，标题一定得屌)\t\t \n  @猪猪侠的男朋友 你这ID让猪哥很尴尬啊    \n     2016-04-21 17:04 |    \t\t孤梦° \t\t\t( 普通白帽子  |\t\t\t        Rank:143 漏洞数:48        )\t\t \n  猪哥又出动了，不用看，股票又跌了。    \n     2016-04-21 17:07 |    \t\tzkk \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:4        | 只留下清澈的心)\t\t \n  屌爆了，666    \n     2016-04-21 17:10 |    \t\tsql小神 \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:13        | 有些漏洞可以提，有些漏洞不可以提。)\t\t \n  @猪猪侠的男朋友 你这id也是够吊的。。。。。    \n     2016-04-21 19:02 |    \t\t数据流  \t\t\t( 普通白帽子  |\t\t\t        Rank:817 漏洞数:100        | 没关系啊，我们还有音乐)\t\t \n  报官方hackone 1w美刀    \n     2016-04-21 19:30 |    \t\tdragon110 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 谨言、慎行、多思。)\t\t \n  @猪猪侠的男朋友 顶一个。    \n     2016-04-21 19:35 |    \t\t土豆俠 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我爱吃土豆)\t\t \n  土豆侠到此一游！！！    \n     2016-04-21 20:38 |    \t\tFreebug \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:39        | 流氓是一种高尚的职业！)\t\t \n  后排火速留名。    \n     2016-04-21 23:41 |    \t\tSTCX \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:8        | 向大黑阔们致敬)\t\t \n  留个名    \n     2016-04-22 07:36 |    \t\t我在不想理你 \t\t\t( 普通白帽子  |\t\t\t        Rank:162 漏洞数:46        | 人生路漫漫)\t\t \n  666    \n     2016-05-09 11:15 |    \t\t过客 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:13        )\t\t \n  看到 uber 3000$ 的 xss 了https://hackerone.com/reports/117068    \n     2016-05-09 13:37 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1137 漏洞数:200        | px1624)\t\t \n  @过客 。。。我擦 一个反射xss  2w块rmb    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}