{"id": 79943, "wybug_id": "wooyun-2015-0157003", "wybug_title": "飞客旅行网csrf+设计缺陷", "wybug_corp": "飞客旅行网", "wybug_author": "socket", "wybug_date": "2015-11-30 16:31", "wybug_open_date": "2015-12-01 17:59", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-01：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 如果还是觉得这个没危害就算了。 详细说明：  这个又有csrf ，又有设计缺陷，慢慢说吧先注册两个测试账号上图\n\n\n\n测试账号有了，并且资料也有，通过抓包发现修改个人资料是访问如下这个地址，http://www.flyertrip.com/hotels/personalCenter/mydata.php?flag=update&email=test111@test.com&nickname=test111@test.com，参数应该看的懂吧，然后登陆test222账号去访问这个链接之后，test222的资料就会被更改如图\n\n本来改改资料倒不是多大问题，问题是，重新登陆一下test222，惊讶发现密码错误，，test111账号密码test111，test222账号test222，怎么会错，我以为输错了，然后把input的type改成text如图\n\n好嘛，还是错误，然后没法只有重置了，然而来到重置页面却发现账号不存在。图：\n\n，最后得出的结论是通过csrf可以删除别人账号，只要他登陆着访问csrf链接，他的账号就不存在了,就相当于删除账号。够清楚了吧   漏洞证明：  同上   修复方案：  csrf =>token   设计缺陷你应该懂了   版权声明：转载请注明来源 socket@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-12-01 09:45 厂商回复： 谢谢！！！ 最新状态： 2015-12-01：已修复 2015-12-01： 2015-12-01：已经修复 2015-12-01：  ", "replys": "漏洞评价：\n评价\n     2015-12-02 14:22 |    \t\t风格 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:12        | 注册为白帽子，你可以在这里提交你发现的漏...)\t\t \n  当两个或两个以上的账号点击了poc账号就会失效，用一个账号测试是可以供改后的账号登录的    \n     2015-12-02 14:50 |    \t\tsocket \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:14        | )\t\t \n  @风格 什么意思呢    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}