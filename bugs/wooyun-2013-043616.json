{"id": 60359, "wybug_id": "wooyun-2013-043616", "wybug_title": "建站宝最新版sql注入漏洞", "wybug_corp": "建站宝", "wybug_author": "Matt", "wybug_date": "2013-11-21 18:49", "wybug_open_date": "2014-02-19 18:49", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-21：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-02-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 建站宝注入漏洞 详细说明：  \nmodule/mod_product.phppublic function prdlist() {$this->_layout = 'frontpage';$curr_product_category = new ProductCategory();$cap_id = trim(ParamHolder::get('cap_id','0'));//没有过滤$user_role = trim(SessionHolder::get('user/s_role','{guest}'));$curr_locale = trim(SessionHolder::get('_LOCALE'));$page_title = new MenuItem();$title_info = $page_title->find(\" `link`=?  and  s_locale=?\",array(\"_m=mod_product&_a=prdlist\",$curr_locale),\" limit 1\");$search_where = '';$search_params = array();$prd_keyword=trim($_REQUEST[\"prd_keyword\"]);if (strlen($prd_keyword) >0) {$search_where .= ' AND (name LIKE ? OR description LIKE ?)';$search_params = array_merge($search_params,array('%'.$prd_keyword.'%','%'.$prd_keyword.'%'));$this->assign('prd_keyword',$prd_keyword);}else if (intval($cap_id) >1) {$product_category = new ProductCategory();$product_categories = $product_category->findAll();if(empty($product_categories)) $product_categories = array();foreach($product_categories as $k =>$v){$this->stack[$v->id] = $v->product_category_id;}$this->findout[] = $cap_id;$this->getCategoryList();$search_where = \" AND product_category_id IN (''\";foreach($this->findout as $k =>$v){$search_where .= \",$v\";}$search_where .= ') AND product_category_id <> 0';$curr_product_category = new ProductCategory($cap_id);//这里注入了}try {官方测试http://test.3655188.com/index.php?_m=mod_product&_a=prdlist&cap_id=90\n   漏洞证明：  \n\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}