{"id": 22904, "wybug_id": "wooyun-2011-02079", "wybug_title": "风讯安全问题[当两个鸡助的漏洞合体的时候]", "wybug_corp": "风讯", "wybug_author": "冷冷的夜", "wybug_date": "2011-05-08 16:01", "wybug_open_date": "2011-05-08 19:42", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "逻辑错误", "利用", "发生点上下文敏感"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-05-08：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2011-05-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 很多人认为XSS危害很小，在很多情况下还是很有危害的。比如这个cms,一个XSS+一个后台上传漏洞，单单这两个漏洞来说，都很鸡助，但是当两个鸡助的漏洞合体以后，威力将不可忽视 详细说明：  1.http://www.xx.com/user/index.aspx?urls=http://www.XXX.com存在XSS2.http://www.xx.com/user/index.aspx点击控制面板，修改资料，职业处存在存储型xss填入sss\"><script>alert(22)</script>,查看资料，弹出警告框3.http://www.xx.com/user/index.aspx点击社区/讨论->创建讨论组,内部公告存在存储型XSS，填入xx\"><script>alert(55)</script>,转到首页，讨论组，找到刚才创建的讨论组，点击，弹出警告框，不过貌似讨论组管理的时候会爆出输入字符串的格式不正确。4.登录网站后台，点击插件管理，在点击左边的文件管理，上传文件，上传webshell命名为XX.jpg,上传.OK，看到xx.jpg，右边操作栏->改名为XX.aspx，找到路径/files/xxx.aspx,直接得到webshell.漏洞明显设计逻辑有问题，不能直接上传aspx，但是可以间接的上传aspx.ok,下面来说下这几个漏洞的危害，单单这几个漏洞来说，都很鸡助，但是结合起来，威力不小， 首先，利用XSS窃取管理员cookies，例如你可以在职业处构造XSS，当管理员查看你的资料就会泄露cookies等其他信息 当你得到cookies。进入后台，上传webshell   漏洞证明：  \n\n\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 冷冷的夜@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：10 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2011-06-11 19:38 |    \t\twdlei \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:6        | 安全界里的年轻人。)\t\t \n  首先，利用XSS窃取管理员cookies，例如你可以在职业处构造XSS，当管理员查看你的资料就会泄露cookies等其他信息当你得到cookies。进入后台，上传webshell.Good    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 10, "Ranks": null}