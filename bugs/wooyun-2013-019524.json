{"id": 13394, "wybug_id": "wooyun-2013-019524", "wybug_title": "新浪微博用户明文密码泄露。。明文。。", "wybug_corp": "新浪微博", "wybug_author": "fox", "wybug_date": "2013-03-04 19:54", "wybug_open_date": "2013-04-18 19:55", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["后台地址泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-03-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-04-18：\t细节向公众公开  简要描述： 新浪微博用户明文密码泄露 详细说明：  新浪微博手机版泄露用户登陆状态继而还会露出明文用户名首先， 漏洞的起源见  WooYun: 新浪微博认证信息gsid永不过期… 新浪的回复居然是漏洞已过时， 而我亲测有效去google， baidu，搜索 gsid site:weibo.cn 或 gsid site:weibo.com可以找到大量的gsid，经过测试， 大概有一半左右是有效的登陆后，自然可以以该用户身份进行发微博、关注、取消关注等操作但是由于没有原密码， 无法进行改密等操作而当我访问\nhttp://weibo.cn/u/1768856242?vt=1&wm=4007&gsid=xxxxxxxxxxx\n的时候，奇迹出现了，居然爆出了明文的密码。情何以堪啊！只要通过搜索引擎找到gsid，或者社工的方式让朋友把正在手机浏览的url发给自己得到gsid，就可以搞到密码。由于当时没有在电脑前， 爆密码的测试环境是中国移动GPRS网络，HTC G18， 自带浏览器或UC浏览器均有效。而在我回到宿舍后复测时却没有复现， 不过即使没有得到密码， 也可以进行很多操作了。   漏洞证明：  搜索gsid site:weibo.cn 或gsid site:weibo.com等关键词\n\n通过谷歌，我们找到一个vdisk的链接\nhttp://vdisk.weibo.com/s/m9P9-/1356973028?vt=3&wm=2444_8001&gsid=3_5affa62b5e9fd35d18ba8850123b62868c6d3b7b8500\n访问\nhttp://weibo.cn/u/1768856242?vt=1&wm=4007&gsid=3_5affa62b5e9fd35d18ba8850123b62868c6d3b7b8500\n成功登陆进别人账号了\n\n同时，给出两个爆出明文密码的图\n\n\n\n   修复方案：  gsid过期，或不要放在url里密码莫非是明文存的？不要这样吧。。来个礼物吧   版权声明：转载请注明来源 fox@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-03-06 20:43 厂商回复： 感谢关注新浪安全，由于移动网关接入特性，不是很好支持cookie，有些用户不明白gsid 传输方式，分享出去，导致问题产生。至于明文密码泄露问题是不存在的，是由于临时调试接口产生的。已经通知研发人员进行处理了。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-04 21:51 |    \t\tTituX \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | <script></script>)\t\t \n  沙发 强势关注    \n     2013-03-04 23:56 |    \t\tLittlePig \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | </html>)\t\t \n  还是明文的？！    \n     2013-03-05 00:26 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  求明文    \n     2013-03-05 06:32 |    \t\t廷廷 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 有很强的好奇心，爱好广泛，求女女带走。。...)\t\t \n  围观！！    \n     2013-03-05 08:35 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  明文？    \n     2013-03-05 10:27 |    \t\tG8dSnow \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 一直在学习技术、分享知识的路上)\t\t \n  应该是早期业务逻辑设计的不合理导致的，唉，所以产品的初期设计非常重要，老是想着快上线快编码，太急功近利，往往后期会倒霉    \n     2013-03-05 10:33 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这个。。明文，名副其实？官方在哪里？    \n     2013-03-05 12:18 |    \t\tfox \t\t\t( 普通白帽子  |\t\t\t        Rank:159 漏洞数:16        | fox)\t\t \n  @G8dSnow 是通过那个gsid的接口显示出来的， 怀疑是通过gsid计算出来的，因为我输入一个旧密码的gsid，显示的就是旧密码    \n     2013-03-05 17:23 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  @fox 真相在哪里？怎么算？gsid的接口？    \n     2013-03-05 17:56 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  你这是要等着切jj啊！！！    \n     2013-03-05 19:06 |    \t\tfox \t\t\t( 普通白帽子  |\t\t\t        Rank:159 漏洞数:16        | fox)\t\t \n  @tpu01yzx 其实爆出明文的接口不是很稳定， 我是用手机测试时，页面直接返回了gsid对应的明文。 我猜测搞不好是新浪程序员在网页运行的时候打的调试信息呢。不过gsid窃取用户登陆状态倒是可以轻易复现    \n     2013-03-06 18:54 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  @fox 接口在哪里？赶紧去脱裤刷粉    \n     2013-04-07 16:18 |    \t\t廷廷 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 有很强的好奇心，爱好广泛，求女女带走。。...)\t\t \n  这是要逆天啊，要是能定向破解就好了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}