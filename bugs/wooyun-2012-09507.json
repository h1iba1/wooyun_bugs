{"id": 18064, "wybug_id": "wooyun-2012-09507", "wybug_title": "H3C IMC Portal  hash密码认证漏洞", "wybug_corp": "H3C", "wybug_author": "KMSRussian", "wybug_date": "2012-07-11 19:59", "wybug_open_date": "2012-08-25 20:00", "wybug_type": "默认配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-19：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-09-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-09-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-09-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-25：\t细节向公众公开  简要描述： 拿到用户Hash并以此为密码可以直接绕过H3C IMC Portal的Portal认证 详细说明：  \n\n很短的时间内拿到了两个同学的账号和密码密码分别为0TU4MzAz  ，  YWFh0Dg5MDk40A==。很明显一看密码肯定是用HASH做过散列的说，后面的那个貌似还用Base64编过码，SQL注入的时候拿到后台管理员密码肯定都是加密的，运气好的话MD5加密的找个网站可以查表查出管理员密码来，呵呵。而H3C ImcPortal的加密我曾经花了一个下午鼓捣，没有成果，应该是H3C家自己的私钥，本来我就应该就此放弃了，即使用ARP欺骗，出来的也只是加密之后的密文，让不懂加解密的小白无甚作为，说明人家即使不用SSL，也足够小心，把防范做的很到位，呵呵，可是让我大跌眼镜的是，直接拿到的hash填入密码栏竟然认证通过。这样就可以花着别人的钱免费蹭网。由于Portal认证采用的设备是H3C家自己的无线交换机。对于ARP欺骗，根本是没有办法防范的。看漏洞证明的图片     漏洞证明：  \n\n   修复方案：  改变密码验证逻辑使得即使在无线网络ARP欺骗拿到hash 也可以使拿到的hash也无用武之地   版权声明：转载请注明来源 KMSRussian@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-07-16 01:57 厂商回复： CNVD暂未直接验证，根据图片进行确认，此前与华三公司有过漏洞事件处置接触，将由其进行自查。鼓励此类通用性软件漏洞，虽然仅是相邻网络才可能进行测试。按部分影响机密性、可用性、完整性进行评估，rank=7.1*1.1*1.3=10.153 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-16 09:43 |    \t\tx7iao \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:41        | 文能床上控萝莉，武能床上定人妻)\t\t \n  @KMSRussian 跟我们学校一样的程序，我已经拿到hash了。 能否告知一下详情    \n     2012-07-16 21:09 |    \t\tKMSRussian \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | Loving lifeLoving windows kernelLovi...)\t\t \n  直接回复是不是不太好啊 你留个邮件吧    \n     2012-07-16 21:11 |    \t\tKMSRussian \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | Loving lifeLoving windows kernelLovi...)\t\t \n  拿到用户Hash并以此为密码可以直接绕过H3C IMC Portal的Portal认证    \n     2012-07-17 08:49 |    \t\tx7iao \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:41        | 文能床上控萝莉，武能床上定人妻)\t\t \n  @KMSRussian my@x7iao.org 谢谢    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}