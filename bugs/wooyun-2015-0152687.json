{"id": 72328, "wybug_id": "wooyun-2015-0152687", "wybug_title": "中国电信某处奇葩漏洞可批量登录/可给任意手机号发送短信/海量历史机票订单超详细（实时更新）", "wybug_corp": "中国电信", "wybug_author": "路人甲", "wybug_date": "2015-11-07 23:46", "wybug_open_date": "2015-12-26 10:42", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "认证设计不合理", "认证缺陷", "账户体系控制不严"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-26：\t细节向公众公开  简要描述： 奇葩漏洞导致的灾难：可任意手机号（移动、联通、电信均可）发送短信，可查部分信息含姓名/手机号/身份证号/PNR码/护照/银行卡开户行/卡号/地址/邮箱等。可否来点雷声掌声？ 详细说明：  中国电信机票运营系统好奇葩的漏洞，且看详细。\n0x00 此处应该mask咯**.**.**.**/Home/LogIn\n任何系统管理员账号总是首当其冲的，此刻也不例外。\nhbadmin\n小样 没验证码，嗯作死啦，来上我的祖传大字典。可是，等我上完大字典我就诧异了！看图：\n\n竟然这么多302跳转，说明了啥？一个账号这么多密码均可以登录成功！好奇葩，到底是啥验证逻辑~\nhbadmin可登陆成功的密码列表（mask一下咯）：abc123abc123.abc.123abc123..abc..123abc123...abc...123abc123++abc++123abc123,./abc,./123abc.123.abc123.+abc123??abc??123abc123?abc?123abc,.123abc123,.abc123.,abc.,123\n进去了看看功能吧。批量登录后边再提。————————————————————华丽分割线——————————————————————\n\n\n\n管理员权限。可根据客户id/姓名/手机号任意查询\n\n\n0x01 用户个人信息\n输入客户id查询抓包，遍历客户id，看返回包信息：姓名、身份证号码、手机号、卡号等，目测至少100万可查：\n\n100万开外离散可查不连续了（呀呀 高等数学术语都用上了）\n\n\n0x02 海量机票订单信息（实时更新！）\n\n\n其中看到了PNR码，来百度百科一下。\nPNR是旅客订座记录，即Passenger Name Record的缩写，它反映了旅客的航程，航班座位占用的数量，及旅客信息。适用民航订座系统。一个PNR记录了旅客订座的完整信息, 计算机赋于每个PNR一个编号，也称订座记录编号。一个PNR由以下几项组成:1.姓名组 2.航段组 3.团体情况 4.联系地址 5.出票情况 6.邮票地址组7. 开帐地址组 8.票价情况组 9.辅助项目组（订旅馆、出租飞机、地面运输服务、出租车）10.特殊服务组 11.其他服务情况组 12. 备注13.责任组\n也就是说拿到了PNR码可以查到旅客的全部信息。查看订单详情：\n\n点击PNR码，可查订单详情/订单支付日志/短信发送日志：\n\n\n\n\n\n\n\n短信日志包含各种敏感信息：姓名、手机号、证件号码、通行证、生日、支付宝等。\n\n\n\n\n\n\n\n\n0x03 可操作订单（锁定/解锁/取消订单/修改订单/派单/返单/退票/出票等），让未登机人员登不了机！！\n\n\n\n\n\n\n\n\n\n0x04 邮寄单泄露姓名/地址/联系方式\n\n\n\n0x05 各种报表\n\n\n\n0x06 短信发送日志查询\n\n\n\n\n————————————————————华丽分割线——————————————————————\n【0x07 可给任意手机号发送短信，可用于钓鱼欺诈！】\n\n\n\n\n\n\n————————————————————华丽分割线——————————————————————拿到员工列表 呵呵~进一步测试出\nmajiaoyun\n同样的密码列表可登录（mask一下咯）。\nabc123abc123.abc.123abc123..abc..123abc123...abc...123abc123++abc++123abc123,./abc,./123abc.123.abc123.+abc123??abc??123abc123?abc?123abc,.123abc123,.abc123.,abc.,123\n另，测试出其他的50例弱口令（密码均为123456），含不少管理员。弱口令账户如下（此处应该mask一下咯）：\nzouyunyuanhaifenghuangxytzwangmating8813611188136070881360068813600188136108881361038813610188136100881360818813607588136074881360698813606888136061881360598813605488136053881360528813604388136037881360368813603588136034881360338813603288136031881360308813602988136028881360278813602388136021881360208813601988136018881360178813601688136009881360088813601088136005881360118813600788136004881360128813600388136013\n不明白为啥管理员真多！\n\n以上可登陆的账号不一一登录啦！   漏洞证明：  如上好多图，好累。审核辛苦！   修复方案：  1.神马验证逻辑 多个密码都可以登录成功，开发打屁屁吧！2.无验证码是硬伤；3.弱口令改之；4.所有账户改密码；5.为啥这么多管理员；   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-11-11 10:40 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国电信集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-11-08 00:42 |    \t\t金馆长 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | Up)\t\t \n  啪啪啪    \n     2015-11-08 00:44 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1077 漏洞数:139        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  电信跟机票有啥关联？    \n     2015-11-08 09:12 |    \t\t10457793 \t\t\t( 普通白帽子  |\t\t\t        Rank:1013 漏洞数:156        | 说好的借，为什么从来不还？O(∩_∩)O)\t\t \n  商旅服务    \n     2015-12-01 11:48 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1365 漏洞数:333        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  好奇葩的逻辑……    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}