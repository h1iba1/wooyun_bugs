{"id": 58885, "wybug_id": "wooyun-2014-049247", "wybug_title": "北京理工大学图书馆SQL注入漏洞", "wybug_corp": "北京理工大学", "wybug_author": "retanoj", "wybug_date": "2014-01-20 15:58", "wybug_open_date": "2014-03-06 15:58", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "图书馆", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-20：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-03-06：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 观察图书馆数据库已久，原因呢？因为可爱的学生们会登陆图书馆，可爱的学生们的信息也许都在图书馆数据库里。这次用工具很巧合的找到了一个SQL注射，但可惜用户信息并不在这边。不过后来发现学生们登陆图书馆数据库的用户名和密码竟然是.....同时，这个SQL漏洞还是能造成不小的影响 详细说明：  说说发现过程吧：1.用 WebCruiser 扫描 http://lib.bit.edu.cn 会发现有一些可注入点 （这个软件效果其实一般般）2.机缘巧合的用某个注入点，扔进 Havij v1.15 里面跑，跑到了结果我是工具党，嗯！   漏洞证明：  操起Havij就上网址：http://lib.bit.edu.cn/searchResource/bookDataDetail.jsp?srLeftIndex=10&id=%Inject_Here%99999999参数： GET方法，Integer类型很简单的能跑到如下信息看到竟然是个root\n\n所有用户的密码HASH值都是一样的，其实可以口算出来，原文是123456 :)\n\n接下来用Havij跑出更多的数据就一点问题都没有了..\n\n发现了lgdx_web库cms_users表里有这样的内容，估计是cms管理的帐号密码\n\n但问题是，user_password字段中的密码值看似是BASE64，但是解不开，估计是用不同顺序的BASE64映射关系得到的值到此为止，没有再继续下去了   修复方案：  大牛们都比我懂。   版权声明：转载请注明来源 retanoj@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}