{"id": 6277, "wybug_id": "wooyun-2013-042182", "wybug_title": "看我如何调查放置后门之Thinkphp", "wybug_corp": "ThinkPHP", "wybug_author": "疯子", "wybug_date": "2013-11-06 21:34", "wybug_open_date": "2014-02-01 21:35", "wybug_type": "地下0day/成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "用户敏感信息泄漏", "后台被猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-11：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-01：\t细节向公众公开  简要描述： 提交这个我纠结了很久，本来我是可以做一个坏帽子，贼喊捉贼，昨天晚上想了想，我的偶像猪猪侠提交的那些漏洞和我这比我这就是渣渣，他都可以无私的提交而不去换取不正当的金钱，我为什么就不可以呢？这个应该属于通用漏洞奖励鸟 详细说明：  渗透thinkphp完全是因为无聊之余搞了搞，可是没想到的还搞进去了，呵呵，首先在一个群里面发现别人发了一个thinkphp的连接 打开是一个压缩包 800多MB就下载了 可是下载速度我不敢恭维啊，几KB几十KB每秒，呵呵。\n\n下了四个小时才下载完，下载了那么久，当然要看看里面的东西，源码，呵呵这安全运维可真厉害，在里面找到了一个config 看看好东西，果然有干货。\n\n尝试外链这mysql数据，连接不了，然后继续往下面看。\n\n发现了邮件配置，拿着这个登陆试一下。\n\n成功了，看了一下里面没什么东西，多半是发送注册邮件什么的，继续往下看会有的。\n\n我和我的小伙伴们都惊呆了，确定可以登陆吗？试一下不就知道了。。\n\n真不知道说什么了，这是一个礼物，大礼物。。。可是FTP的IP和官网的IP不是一个，所以就翻了一下没找到什么东西。然后查询了一下IP上绑定的域名发现有一个thinkphp的下载域名在里面：down.thinkphp.cn\n\n我就不多写过程了，而在我去thinkphp的网站上下载包的时候发现包是在down这个服务器上面。\n\n如果我把里面的包加上后门或者在你一次升级重要版本的时候加上后门 那样岂不是很多站都会被挂上shell？当然 做为一个猪猪侠的崇拜者，我是不会干这事的。一个shell算什么？最后还提权了这台服务器 利用的是mysql root权限直接UDF提权\n\n最后在邮箱中也找回了一个管理员的密码，好不容易找到的管理员邮箱啊 开始第一个没找回来 一直没发送邮件 最后这个才找回成功 可以直接编辑N多东西 下载包也可以更新。\n\n\n\n在这里我终于明白了 为什么经常会有大型CMS存在后门了。   漏洞证明：  \n\n\n\n   修复方案：  没什么建议的，加油吧，追风的骚年！   版权声明：转载请注明来源 疯子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-02-01 21:35 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-06 21:39 |    \t\t猪头子 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:35        | 自信的看着队友rm -rf/tar挂服务器)\t\t \n  前排花生瓜子，楼主也是我的偶像    \n     2013-11-06 21:39 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  前排关注。。为嘛不是精华？    \n     2013-11-06 21:40 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  @齐迹 精华可以吃吗？给老夫来两碗！    \n     2013-11-06 21:41 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  围观疯子大牛。    \n     2013-11-06 21:41 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  @疯子 洞主的意思是tp留后门？    \n     2013-11-06 21:48 |    \t\tHBSpy \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | Tech0taku一枚)\t\t \n  洞主这动机太纯朴了，感动    \n     2013-11-06 21:48 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  @齐迹 你的领悟很好，给你32个赞！    \n     2013-11-06 21:50 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  @疯子 1024把 刚好整数 省的零头和小数 麻烦。我还是觉得应该是无意间留下的或者服务器被黑客拿下修改过。    \n     2013-11-06 21:53 |    \t\tayys \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 欢迎交流，熟悉正方教务系统漏洞。专业挖洞...)\t\t \n  请问洞主这个是thinkphp的漏洞还是网站自身漏洞？    \n     2013-11-06 22:31 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  默默的关注    \n     2013-11-06 22:53 |    \t\t‫‌ \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:14        )\t\t \n  好样的小伙伴！    \n     2013-11-06 23:51 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  @‫‌ 楼上的你的名字为何这么叼    \n     2013-11-06 23:58 |    \t\t我疯癫 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | i)\t\t \n  @‫‌楼上的楼上你的名字为何这么叼     \n     2013-11-07 09:05 |    \t\tMr.醉心 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 爱生活，爱音乐，爱美女，更爱波多野结衣)\t\t \n  前排花生瓜子，楼主也是我的偶像    \n     2013-11-07 09:18 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  @‫‌ @‫‌ 你的名字为何这么叼    \n     2013-11-07 09:20 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  关注    \n     2013-11-07 09:21 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @疯子  挖什么洞！赶紧写作业去！    \n     2013-11-07 09:39 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  偶像    \n     2013-11-07 09:42 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  坐等公开！    \n     2013-11-07 10:46 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @疯子 必须通用型！有奖金的！    \n     2013-11-07 10:55 |    \t\tX防部 \t\t\t( 普通白帽子  |\t\t\t        Rank:487 漏洞数:137        )\t\t \n  @疯狗 通用的QB奖励啥时候给啊？？    \n     2013-11-07 14:48 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  悄悄尾随....    \n     2013-11-07 14:53 |    \t\t大胆 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 大胆)\t\t \n  @猪猪侠 召唤LZ偶像    \n     2013-11-07 15:14 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  @大胆 偶像是不会出来的。偶像在挖洞刷Rank    \n     2013-11-07 19:43 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  洞主碉堡    \n     2013-11-13 06:46 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  楼主是我的偶像    \n     2013-11-13 08:55 |    \t\tJJ碎大石 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | ……白天抢银行，晚上做牛郎，至今买不起房...)\t\t \n  @疯子  你这是官网漏洞,还是THINKPHP本身的漏洞啊    \n     2013-11-13 09:07 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  危害等级：无影响厂商忽略?    \n     2013-11-17 01:15 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:31        | Hacked by @ringzero 我錯了)\t\t \n  楼主是我的偶像    \n     2013-11-17 03:20 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  忽略后的内容呢？    \n     2013-11-28 22:38 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  我承认被标题忽悠了。。但是过程很精彩    \n     2013-12-03 10:24 |    \t\t浪迹海角 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | 低调，谢绝各种查水表、快递、家电下乡、人...)\t\t \n  标题很唬人。    \n     2013-12-08 17:13 |    \t\t煦阳。 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:27        | 这个人很懒，什么都没留下。)\t\t \n  为毛我看不到内容？ @xsser    \n     2013-12-20 09:51 |    \t\t╰╃清風 \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:9        | 这家伙很懒，什么都没有留下)\t\t \n  地下0day/成功的入侵事件.....    \n     2013-12-20 22:41 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  @╰╃清風 地底下,不然你以为能轻易找到下载地址吗    \n     2014-02-01 21:55 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  恭喜无影响厂商忽略    \n     2014-02-02 00:40 |    \t\tMurk Emissary \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:14        | 低调做人 低调行事)\t\t \n  忽略了，厂商啊  做人得厚道    \n     2014-02-02 15:26 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  看 我XXX系列好流行啊    \n     2014-03-05 22:38 |    \t\thead \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 装b都是要死的节奏)\t\t \n  那邮箱是QQ邮箱？    \n     2014-11-19 22:57 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  这个漏洞，厂商居然选择忽略了啊？    \n     2014-11-20 08:31 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  @猪猪侠 @疯狗  @Finger  这漏洞应该给我补点rank啊！！！！没天理！！！    \n     2014-12-01 15:35 |    \t\tnoob \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:18        | 向各位大神学习，向各位大神致敬)\t\t \n  居然忽略了...    \n     2015-01-24 14:42 |    \t\t一天到晚吃 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:23        | 好好看,好好学 test12xx)\t\t \n  厂商怎么想的    \n     2015-03-11 15:56 |    \t\t路人丶乙 \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:13        | 花谢花飞飞满天 红消香断有谁怜)\t\t \n  有时候厂商就是这样，自己把漏洞给补上了，然后有忽略。。。    \n     2015-03-11 16:15 |    \t\tSkull \t\t\t( 实习白帽子  |\t\t\t        Rank:95 漏洞数:33        | 菜鸟一枚。)\t\t \n  危害等级：无影响厂商忽略    \n     2015-09-15 12:10 |    \t\t指尖的温度 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:7        )\t\t \n  危害等级：无影响厂商忽略    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}