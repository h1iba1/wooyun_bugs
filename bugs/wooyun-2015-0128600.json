{"id": 68899, "wybug_id": "wooyun-2015-0128600", "wybug_title": "AfterLogic WebMail多个版本信息泄露可直接登录后台", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "xfkxfk", "wybug_date": "2015-07-25 12:24", "wybug_open_date": "2015-10-26 08:08", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "应用敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-28：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-07-31：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-26：\t细节向公众公开  简要描述： AfterLogic WebMail多个版本信息泄露可直接登录后台 详细说明：  AfterLogic WebMail存在多个版本：AfterLogic WebMail ProAfterLogic WebMail lite这两个应该是轻量级的，一个是高级版本，都是php开发的都存在同样的问题，如果web服务器配置不到，即可导致严重信息泄露从官方下载AfterLogic WebMail lite版本：在/data/seetings/目录下存在这样一个xml文件settings.xml\n\n来看看这个xml里面的内容：\n<?xml version=\"1.0\" encoding=\"utf-8\"?><Settings xmlns:xsd=\"http://**.**.**.**/2001/XMLSchema\" xmlns:xsi=\"http://**.**.**.**/2001/XMLSchema-instance\">\t<Common>\t\t<SiteName>AfterLogic WebMail Lite</SiteName>\t\t<LicenseKey />\t\t<AdminLogin>mailadm</AdminLogin>\t\t<AdminPassword>12345</AdminPassword>\t\t<DBType>MySQL</DBType>\t\t<DBPrefix />\t\t<DBHost />\t\t<DBName />\t\t<DBLogin />\t\t<DBPassword />\t\t<UseSlaveConnection>Off</UseSlaveConnection>\t\t<DBSlaveHost>**.**.**.**</DBSlaveHost>\t\t<DBSlaveName />\t\t<DBSlaveLogin>root</DBSlaveLogin>\t\t<DBSlavePassword />\t\t<DefaultLanguage>English</DefaultLanguage>\t\t<DefaultTimeZone>0</DefaultTimeZone>\t\t<DefaultTimeFormat>F12</DefaultTimeFormat>\t\t<DefaultDateFormat>MM/DD/YYYY</DefaultDateFormat>\t\t<AllowRegistration>Off</AllowRegistration>\t\t<AllowPasswordReset>Off</AllowPasswordReset>\t\t<EnableLogging>Off</EnableLogging>\t\t<EnableEventLogging>Off</EnableEventLogging>\t\t<LoggingLevel>Full</LoggingLevel>\t\t<EnableMobileSync>Off</EnableMobileSync>\t</Common>\t<WebMail>\t\t<AllowWebMail>On</AllowWebMail>\t\t<IncomingMailProtocol>IMAP4</IncomingMailProtocol>\t\t<IncomingMailServer>**.**.**.**</IncomingMailServer>\t\t<IncomingMailPort>143</IncomingMailPort>\t\t<IncomingMailUseSSL>Off</IncomingMailUseSSL>\t\t<OutgoingMailServer>**.**.**.**</OutgoingMailServer>\t\t<OutgoingMailPort>25</OutgoingMailPort>\t\t<OutgoingMailAuth>AuthCurrentUser</OutgoingMailAuth>\t\t<OutgoingMailLogin />\t\t<OutgoingMailPassword />\t\t<OutgoingMailUseSSL>Off</OutgoingMailUseSSL>\t\t<OutgoingSendingMethod>Specified</OutgoingSendingMethod>\t\t<UserQuota>0</UserQuota>\t\t<ShowQuotaBar>On</ShowQuotaBar>\t\t<AutoCheckMailInterval>1</AutoCheckMailInterval>\t\t<DefaultSkin>AfterLogic</DefaultSkin>\t\t<MailsPerPage>20</MailsPerPage>\t\t<AllowUsersChangeInterfaceSettings>On</AllowUsersChangeInterfaceSettings>\t\t<AllowUsersChangeEmailSettings>On</AllowUsersChangeEmailSettings>\t\t<EnableAttachmentSizeLimit>Off</EnableAttachmentSizeLimit>\t\t<AttachmentSizeLimit>102400000</AttachmentSizeLimit>\t\t<ImageUploadSizeLimit>10240000</ImageUploadSizeLimit>\t\t<AllowLanguageOnLogin>On</AllowLanguageOnLogin>\t\t<FlagsLangSelect>Off</FlagsLangSelect>\t\t<LoginFormType>Email</LoginFormType>\t\t<UseReCaptcha>Off</UseReCaptcha>\t\t<AllowNewUsersRegister>On</AllowNewUsersRegister>\t\t<AllowUsersAddNewAccounts>Off</AllowUsersAddNewAccounts>\t\t<AllowOpenPGP>Off</AllowOpenPGP>\t\t<AllowIdentities>On</AllowIdentities>\t\t<AllowInsertImage>On</AllowInsertImage>\t\t<AllowBodySize>Off</AllowBodySize>\t\t<MaxBodySize>600</MaxBodySize>\t\t<MaxSubjectSize>255</MaxSubjectSize>\t\t<Layout>Side</Layout>\t\t<AlwaysShowImagesInMessage>Off</AlwaysShowImagesInMessage>\t\t<SaveMail>Always</SaveMail>\t\t<IdleSessionTimeout>0</IdleSessionTimeout>\t\t<UseSortImapForDateMode>On</UseSortImapForDateMode>\t\t<DetectSpecialFoldersWithXList>On</DetectSpecialFoldersWithXList>\t\t<EnableLastLoginNotification>Off</EnableLastLoginNotification>\t\t<ExternalHostNameOfLocalImap />\t\t<ExternalHostNameOfLocalSmtp />\t\t<ExternalHostNameOfDAVServer />\t</WebMail>\t<Calendar>\t\t<AllowCalendar>Off</AllowCalendar>\t\t<ShowWeekEnds>Off</ShowWeekEnds>\t\t<WorkdayStarts>9</WorkdayStarts>\t\t<WorkdayEnds>18</WorkdayEnds>\t\t<ShowWorkDay>On</ShowWorkDay>\t\t<WeekStartsOn>Monday</WeekStartsOn>\t\t<DefaultTab>Month</DefaultTab>\t\t<AllowReminders>On</AllowReminders>\t\t<DAVUrl />\t</Calendar>\t<Contacts>\t\t<AllowContacts>On</AllowContacts>\t\t<ContactsPerPage>20</ContactsPerPage>\t\t<ShowGlobalContactsInAddressBook>Off</ShowGlobalContactsInAddressBook>\t\t<GlobalAddressBookVisibility>Off</GlobalAddressBookVisibility>\t</Contacts>\t<Socials>\t\t<Google>\t\t\t<Allow>On</Allow>\t\t\t<Name>Google</Name>\t\t\t<Id />\t\t\t<Secret />\t\t\t<Scopes>auth filestorage</Scopes>\t\t\t<ApiKey />\t\t</Google>\t\t<Dropbox>\t\t\t<Allow>On</Allow>\t\t\t<Name>Dropbox</Name>\t\t\t<Id />\t\t\t<Secret />\t\t\t<Scopes>filestorage</Scopes>\t\t\t<ApiKey />\t\t</Dropbox>\t\t<Facebook>\t\t\t<Allow>On</Allow>\t\t\t<Name>Facebook</Name>\t\t\t<Id />\t\t\t<Secret />\t\t\t<Scopes>auth</Scopes>\t\t\t<ApiKey />\t\t</Facebook>\t\t<Twitter>\t\t\t<Allow>On</Allow>\t\t\t<Name>Twitter</Name>\t\t\t<Id />\t\t\t<Secret />\t\t\t<Scopes>auth</Scopes>\t\t\t<ApiKey />\t\t</Twitter>\t</Socials>\t\t</Settings>\n全部是系统的配置信息，包括后台账户，数据库账号信息，系统配置等信息因为这是php开发的系统，如果配置不当的话就会导致xml解析失败导致信息泄露我们来看看外网案例：AfterLogic WebMail Pro的案例：\nhttp://**.**.**.**/data/settings/settings.xml**.**.**.**/data/settings/settings.xml**.**.**.**/data/settings/settings.xml\n\n\n这里有后台账户，数据库信息等这里的后台账户用户名基本上都是一样的mailadm密码是一串md5值，但是千万不要想着去解密这里很郁闷，直接拿这个md5串作为密码就登陆成功了。。。。后台地址：http://**.**.**.**/adminpanel/\n\n再来看看AfterLogic WebMail lite的案例：\nhttp://webmail.fph.cz/data/settings/settings.xmlhttp://mail.silnice-klatovy.cz/webmail/data/settings/settings.xmlhttps://www.lacucaracha.sk/data/settings/settings.xmlhttps://drivemont.sk/data/settings/settings.xmlhttps://**.**.**.**/data/settings/settings.xml\n\n\n同样也可以那这里的账户登陆后台后台地址：http://**.**.**.**/adminpanel/\n\n   漏洞证明：  见详细说明   修复方案：  不能保证每个服务器都配置正确的情况下，将settings.xml改为settings.php   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-07-28 08:07 厂商回复： CNVD确认并复现所述情况,应为用户案例默认配置风险,不作为通用漏洞确认.由于涉及案例均位于国外,暂未能建立直接处置渠道. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}