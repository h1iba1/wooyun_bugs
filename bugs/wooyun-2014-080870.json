{"id": 47352, "wybug_id": "wooyun-2014-080870", "wybug_title": "qibocms地方门户系统注入（多处类似,demo测试)", "wybug_corp": "齐博CMS", "wybug_author": "′雨。", "wybug_date": "2014-10-29 22:44", "wybug_open_date": "2015-01-27 22:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-27：\t细节向公众公开  简要描述： 初始化啊 初始化。 详细说明：  很多类似的 随便找个地方把。首先注册个会员。在dianping/post.php中\nif($action==\"postnew\"){  \tif($webdb[ForbidPostMore]){\t\tif($db->get_one(\"SELECT * FROM {$_pre}content WHERE uid='$lfjuid' LIMIT 1\")){\t\t\tshowerr(\"系统设置每人只能发布一个商铺!\");\t\t}\t}\tif(!check_rand_num($_POST[\"$webdb[rand_num_inputname]\"])){\t\tshowerr(\"系统随机码失效,请返回,刷新一下页面,再重新输入数据,重新提交!\");\t}\tif(!$postdb[city_id]){\t\tshowerr(\"请选择城市\");\t}\t/*验证码处理*/\tif($webdb[Info_GroupPostYzImg]&&in_array($groupdb['gid'],explode(\",\",$webdb[Info_GroupPostYzImg]))){\t\t\tif(!$web_admin&&!check_imgnum($yzimg)){\t\t\t\t\tshowerr(\"验证码不符合,发布失败\");\t\t}\t}\t$postdb['list']=$timestamp;\tif($iftop){\t\t//推荐置顶\t\t@extract($db->get_one(\"SELECT COUNT(*) AS NUM FROM `{$_pre}content$_erp` WHERE list>'$timestamp' AND fid='$fid' AND city_id='$postdb[city_id]'\"));\n让哥来发布个点评。@extract($db->get_one(\"SELECT COUNT(*) AS NUM FROM `{$_pre}content$_erp` WHERE list>'$timestamp' AND fid='$fid' AND city_id='$postdb[city_id]'\"))来看看这个语句。 {$_pre}content$_erp  来看看这个文件中的$_erp哪里来的\n\n可以看到 我们的这个语句位于 173行。而对$_erp 赋值是在187行。  那么相当于我们173行的这个$_erp就没有初始化了。结合qibocms 伪全局机制 那么我们就可以控制173行的这个$_erp 来达到注入的效果。dianping/post.php?action=postnew&fid=11&postdb[address]=xx&postdb[city_id]=x&_erp=aaa&iftop=1&yzimg=a1df\n\n构造一下\n\n成功出数据。___________________________________________________________________________测试demo。\n\n嗯。   漏洞证明：  \n\n   修复方案：  把\t$_erp=$Fid_db[tableid][$fid]; 放在前面。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-10-30 09:27 厂商回复： 感谢提出来 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-29 22:45 |    \t\tbacktrack丶yao \t\t\t( 普通白帽子  |\t\t\t        Rank:290 漏洞数:107        | \"><img src=x onerror=alert(666666);> <im...)\t\t \n  你关注的白帽子 ′ 雨。 发表了漏洞 qibocms 地方门户系统 注入#2 (多处类似,demo测试)    \n     2014-10-29 22:57 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  你妹呀，不是说没了嘛？大半夜来这刷洞，我靠    \n     2014-10-29 23:07 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  无情啊    \n     2014-10-29 23:12 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  自从有了mask 标签 咋老情不自禁的点到mask了。    \n     2014-10-30 10:50 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  确认的好快啊，你又涨了20rank    \n     2014-10-30 12:39 |    \t\tMxx \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 没有)\t\t \n  你关注的白帽子 ′ 雨。 发表了漏洞 qibocms 地方门户系统 注入#2 (多处类似,demo测试)    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}