{"id": 67674, "wybug_id": "wooyun-2015-0153073", "wybug_title": "点到为止之abc360配置不当敏感造成订单信息泄露", "wybug_corp": "ABC360", "wybug_author": "路人甲", "wybug_date": "2015-11-09 16:50", "wybug_open_date": "2015-11-09 19:57", "wybug_type": "系统/服务运维配置不当", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-09：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： rt 详细说明：  0x01:订单信息泄露\nhttp://www.abc360.com/log.txt\n\n\n   漏洞证明：  0x02：.viminfo\nhttp://tc.abc360.com/.viminfo\n\n# This viminfo file was generated by Vim 7.2.# You may edit it if you're careful!# Value of 'encoding' when this file was written*encoding=utf-8# hlsearch on (H) or off (h):~H# Last Search Pattern:~MSle0~/openOneCl# Last Substitute String:$# Command Line History (newest to oldest)::q:w:e .:set nu# Search String History (newest to oldest):?/openOneCl? ^\\d\\{-}\\/?/TestCon?/TestC? ^\\d\\{3}ÿ?/saveBookCp?/fix 3?/fix3?/fix:?/fix?/fix : de# Expression History (newest to oldest):# Input Line History (newest to oldest):# Input Line History (newest to oldest):# 寄存器:\"0\tLINE\t0\t        //  请假过滤\t        if( M('TeacherLeaveRecords')->where('tid = %d AND begin_time <= %d AND end_time >= $d',array($tid,$begin_time,$begin_time))->count() > 0 ) {\t            logtest('老师请假,开课失败');\t            return false;\t        }\"\"1\tLINE\t0\t        //  请假过滤 test\t        if( M('TeacherLeaveRecords')->where('tid = %d AND begin_time <= %d AND end_time >= %d',array($tid,$begin_time,$begin_time))->count() > 0 ) {\t            logtest('老师请假,开课失败');\t            return false;\t        }else{\t\t\techo M('TeacherLeaveRecords')->getLastSql();\t\t}\"2\tLINE\t0\t\techo 'x';\"3\tLINE\t0\t\"4\tLINE\t0\t\"5\tLINE\t0\t\"6\tLINE\t0\t\"7\tLINE\t0\t\"8\tLINE\t0\t\"9\tLINE\t0\t\" ============================================================================\t\" Netrw Directory Listing                                        (netrw v134)\t\"   /home/vhost/abc360.com/www/Application/Admin\t\"   Sorted by      name\t\"   Sort sequence: [\\/]$,\\.h$,\\.c$,\\.cpp$,*,\\.o$,\\.obj$,\\.info$,\\.swp$,\\.bak$,\\~$\t\"   Quick Help: <F1>:help  -:go up dir  D:delete  R:rename  s:sort-by  x:exec\t\" ============================================================================\t../\tCommon/\tConf/\tController/\tLogic/\tModel/\tView/\tindex.html*\t.swp\"-\tCHAR\t0\t$# 文件标记:'0  181  12  ~/Application/Common/Logic/TeacherBaseLogic.class.php'1  180  147  ~/Application/Common/Logic/TeacherBaseLogic.class.php'2  9  0  ~/Application/Admin/Controller'3  1  1  /cron/jobs/fixmemo/memo_exec.log'4  184  22  ~/Application/Students/Controller/BookController.class.php'5  111  0  /cron/jobs/getTodayZoommeeting/fixzoommeetingid.php'6  1  0  /cron/jobs/getTodayZoommeeting/fixzoommeetingid.php'7  1  0  /cron/jobs/getTodayZoommeeting/2014-11-07.log'8  18276  58  /home/vhost/abc360.com/log/2014-11-07.log'9  15691  57  /home/vhost/abc360.com/log/2014-11-07.log# 跳转列表 (从新到旧):-'  181  12  ~/Application/Common/Logic/TeacherBaseLogic.class.php-'  180  12  ~/Application/Common/Logic/TeacherBaseLogic.class.php-'  1  0  ~/Application/Common/Logic/TeacherBaseLogic.class.php-'  9  0  ~/Application/Admin/Controller-'  1  0  ~/Application/Admin/Controller-'  156  0  ~/Application/Admin/Controller-'  148  0  ~/Application/Admin/Controller-'  112  0  ~/Application/Admin/Controller-'  93  0  ~/Application/Admin/Controller-'  12  0  ~/Application/Admin-'  3  0  ~/Application/Admin-'  17  0  ~/Application-'  7  0  ~/Application-'  1  0  ~/Application-'  7  0  ~/Application/Admin/Common-'  1  0  ~/Application/Admin/Common-'  21  0  ~/Application/Admin-'  1  0  ~/Application/Admin-'  20  0  ~/Application/Admin-'  1  1  /cron/jobs/fixmemo/memo_exec.log-'  1031  0  /cron/jobs/fixmemo/memo_exec.log-'  3  0  /cron/jobs/fixmemo/memo_exec.log-'  184  22  ~/Application/Students/Controller/BookController.class.php-'  1  0  ~/Application/Students/Controller/BookController.class.php-'  111  0  /cron/jobs/getTodayZoommeeting/fixzoommeetingid.php-'  1  0  /cron/jobs/getTodayZoommeeting/fixzoommeetingid.php-'  1  0  /cron/jobs/getTodayZoommeeting/2014-11-07.log-'  18276  58  /home/vhost/abc360.com/log/2014-11-07.log-'  18269  58  /home/vhost/abc360.com/log/2014-11-07.log-'  18263  58  /home/vhost/abc360.com/log/2014-11-07.log-'  18255  58  /home/vhost/abc360.com/log/2014-11-07.log-'  18250  58  /home/vhost/abc360.com/log/2014-11-07.log-'  18248  58  /home/vhost/abc360.com/log/2014-11-07.log-'  18242  58  /home/vhost/abc360.com/log/2014-11-07.log-'  18322  58  /home/vhost/abc360.com/log/2014-11-07.log-'  18317  58  /home/vhost/abc360.com/log/2014-11-07.log-'  18311  58  /home/vhost/abc360.com/log/2014-11-07.log-'  18305  58  /home/vhost/abc360.com/log/2014-11-07.log-'  18300  58  /home/vhost/abc360.com/log/2014-11-07.log-'  18294  58  /home/vhost/abc360.com/log/2014-11-07.log-'  18288  58  /home/vhost/abc360.com/log/2014-11-07.log-'  18282  58  /home/vhost/abc360.com/log/2014-11-07.log-'  1  0  /home/vhost/abc360.com/log/2014-11-07.log-'  18241  58  /home/vhost/abc360.com/log/2014-11-07.log-'  15691  0  /home/vhost/abc360.com/log/2014-11-07.log-'  16721  53  /home/vhost/abc360.com/log/2014-11-07.log-'  16770  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16769  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16768  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16767  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16766  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16765  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16764  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16763  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16762  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16761  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16760  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16759  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16758  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16757  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16756  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16755  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16754  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16753  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16752  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16751  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16750  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16749  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16748  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16747  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16746  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16745  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16744  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16743  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16742  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16741  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16740  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16739  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16738  58  /home/vhost/abc360.com/log/2014-11-07.log-'  16737  58  /home/vhost/abc360.com/log/2014-11-07.log-'  9  0  ~/Application/Admin/Controller-'  1  0  ~/Application/Admin/Controller-'  156  0  ~/Application/Admin/Controller-'  148  0  ~/Application/Admin/Controller-'  112  0  ~/Application/Admin/Controller-'  93  0  ~/Application/Admin/Controller-'  12  0  ~/Application/Admin-'  3  0  ~/Application/Admin-'  17  0  ~/Application-'  7  0  ~/Application-'  1  0  ~/Application-'  7  0  ~/Application/Admin/Common-'  1  0  ~/Application/Admin/Common-'  21  0  ~/Application/Admin-'  1  0  ~/Application/Admin-'  20  0  ~/Application/Admin-'  1  1  /cron/jobs/fixmemo/memo_exec.log-'  1031  0  /cron/jobs/fixmemo/memo_exec.log-'  3  0  /cron/jobs/fixmemo/memo_exec.log# 文件内的标记历史记录 (从新到旧):> ~/Application/Common/Logic/TeacherBaseLogic.class.php\t\"\t181\t12\t^\t180\t148\t.\t171\t0\t+\t175\t65\t+\t171\t28\t+\t171\t1\t+\t171\t0\t+\t171\t6\t+\t171\t91\t+\t171\t0> /cron/jobs/fixmemo/memo_exec.log\t\"\t1\t1> ~/Application/Students/Controller/BookController.class.php\t\"\t184\t22> /cron/jobs/getTodayZoommeeting/fixzoommeetingid.php\t\"\t111\t0> /cron/jobs/getTodayZoommeeting/2014-11-07.log\t\"\t1\t0> /home/vhost/abc360.com/log/2014-11-07.log\t\"\t18276\t58> ~/delete.me\t\"\t1\t4\t^\t1\t5\t.\t1\t5\t+\t1\t5\n   修复方案：  我是来找礼物的！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-11-09 18:20 厂商回复： 感谢路人甲的反馈，我们将尽快修复漏洞。 最新状态： 2015-11-09：漏洞已修复  ", "replys": "漏洞评价：\n评论\n     2015-11-09 18:27 |    \t\t带头大哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:369 漏洞数:112        | 很早前，我就有个梦想。哪一天能站在国家会...)\t\t \n  小礼物都没有吗？ @ABC360    \n     2015-11-09 20:18 |    \t\tABC360(乌云厂商)\t\t \n  路人甲的礼物已发。    \n     2015-11-09 21:33 |    \t\t带头大哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:369 漏洞数:112        | 很早前，我就有个梦想。哪一天能站在国家会...)\t\t \n  @ABC360 额，是我提交的，我匿名提交了就是路人甲。你获取了我的联系方式。我已经接受了！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}