{"id": 15747, "wybug_id": "wooyun-2012-015758", "wybug_title": "Discuz! X系列对md5与明文登录区分不明", "wybug_corp": "Discuz!", "wybug_author": "Panni_007", "wybug_date": "2012-12-10 11:21", "wybug_open_date": "2012-12-15 11:22", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "明文"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-15：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 在Discuz！平台上，如果密码够安全的话，经过md5md5newpw.salt 加密之后是很难破解出密码的，但是你又没有想过，如果别人有一个还有你的密码的md5加密的数据库的时候，可以直接用你的32位md5加密之后的密文直接登录，那岂不是很不安全？ 详细说明：  在登录时，除了你的明文密码之外，32位的md5也可以登录，当你拥有一个还有他/她密码的32位md5加密后的密码不也是能进去了么？具体的代码部分没有看，但是只有X系列会出现这样的错误，应该是Ucenter出的错了吧！   漏洞证明：  前言：在Discuz！平台上，如果密码够安全的话，经过md5(md5($newpw).$salt) 加密之后是很难破解出密码的，但是你又没有想过，如果别人有一个还有你的密码的md5加密的数据库的时候，可以直接用你的32位md5加密之后的密文直接登录，那岂不是很不安全？介绍：在登录时，除了你的明文密码之外，32位的md5也可以登录，当你拥有一个还有他/她密码的32位md5加密后的密码不也是能进去了么？实例：以下部分可以认为我们是一个cracker，已经获得了某人的32位md5加密后的密文1.Discuz! x2.0 RC我们先试一下用明文登录（如图一）成功（如图二） \n\n图一 \n\n图二现在我们试着用32位md5密文登录试试（如图三）  \n\n图三成功了（图四）\n\n 图四以上仅仅是discuz！x2 RC的一个例子，很多站都可以这样2. Discuz! x2.5和上面一样我们也是找一个论坛试一试 \n\n\n\n\n\n\n\n   修复方案：  设计全点呗！   版权声明：转载请注明来源 Panni_007@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-12-15 11:22 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-11 22:24 |    \t\tPanni_007 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:10        | 专注于信息安全领域    http://www.panni00...)\t\t \n  什么时候没事了分析分析判断的源码  看看到底是哪里的问题    \n     2012-12-12 10:08 |    \t\tBreaker \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:1        )\t\t \n  这不是早就被人发现了么，怎么现在才提交    \n     2012-12-14 22:38 |    \t\tPanni_007 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:10        | 专注于信息安全领域    http://www.panni00...)\t\t \n  Panni_007@Breaker 因为看到没人提交，怕出点神马问题才提交的    \n     2012-12-15 12:20 |    \t\thack2012 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:3        | 关注信息安全 http://www.waitalone.cn/)\t\t \n  这个以前倒是没有试过！！    \n     2012-12-17 10:34 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  这个好，可以利用md5和明文登陆。    \n     2012-12-20 13:00 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  这是正常的应该忽略。    \n     2013-01-06 16:36 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  叛逆的撸撸羞~·嗯 登录的时候jsmd5了下 点击的时候可以看出来 我怎么就没试试呢！！！    \n     2013-04-23 20:01 |    \t\tanyis \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:3        | 教主、八进制时代的产物。)\t\t \n  我测试怎么不成功呢， 直接使用 pre_common_member 表里的MD5 当做密码进行登陆失败  DISCUZ! X2.5    \n     2013-04-24 00:25 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  @anyis 亲，使用的是md5(明文密码)登陆，而不是数据库中的那个看起来叫md5的字段的东西    \n     2013-07-22 16:20 |    \t\t廷廷 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 有很强的好奇心，爱好广泛，求女女带走。。...)\t\t \n  貌似还可以    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}