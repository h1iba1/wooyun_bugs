{"id": 19979, "wybug_id": "wooyun-2012-06185", "wybug_title": "腾讯QQ空间跨站漏洞", "wybug_corp": "腾讯", "wybug_author": "啤酒", "wybug_date": "2012-04-18 17:40", "wybug_open_date": "2012-06-02 17:41", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "未正确设置", "本地"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-04-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-04-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-05-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-05-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-06-02：\t细节向公众公开  简要描述： QQ空间存在一处储存型跨站 详细说明：  QQ空间应用处有一个文件夹应用，该应用可以重命名文件名，正常情况下客户端是过滤了特殊字符的。\n\n但是特殊字符仅仅在客户端做了过滤并没有在服务端 和输出端过滤。因此我们可以通过本地修改post内容绕过这一限制\n\n点击确定产生post\n\n         （拦截post数据修改post内容） 将name值修改为\"><script>alert('by:pijiu')</script><\"\n\n回到QQ空间文件夹这时可以看到文件已经成功被重命名而且构造的 \"> 已经将titile标签阻断\n\n虽然这里没有显示alert但是可以看到<script>标签已经处在可以运行的状态了。只是需要细心构造一下就可以形成攻击。再 抓包得到 json 在json里面 脚本畅通执行\n\n如果有人通过腾讯其他xss获得QQ空间权限然后再修改此处可能会对受害者造成长期影响。因此自评 rank 10   漏洞证明：  \n\n\n\n   修复方案：  抓个漂亮妹纸，过滤下.   版权声明：转载请注明来源 啤酒@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-04-19 14:11 厂商回复： 非常感谢您的报告 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-04-18 17:55 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  有一个XSS  有一个黑阔出山！    \n     2012-04-18 18:20 |    \t\t啤酒 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:8        | 道不同.喝酒结盟)\t\t \n  @疯子 前辈看笑话了，都是些没有啥技术含量的洞。    \n     2012-04-18 19:08 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  碉堡了，这几天。。是肿么了。    \n     2012-04-18 19:23 |    \t\tValo洛洛 \t\t\t( 普通白帽子  |\t\t\t        Rank:458 漏洞数:52        | 。)\t\t \n  @gainover 是不是最近TX更新产品？    \n     2012-04-18 20:44 |    \t\t啤酒 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:8        | 道不同.喝酒结盟)\t\t \n  @Valo洛洛 @gainover 这是很早之前的洞， 今天才注册wooyun所以把以前的几个洞一起交了，反正留着也木用。    \n     2012-04-18 20:55 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  mk    \n     2012-05-20 02:55 |    \t\tBlackeagle \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 向WooYun致敬)\t\t \n  呃，感觉和邮箱的那个方法差不多。    \n     2012-06-02 18:03 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  有想法啊    \n     2012-06-02 20:19 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  “虽然这里没有显示alert但是可以看到<script>标签已经处在可以运行的状态了.”----------------客串补充：这里没弹窗，是因为 文件名 是以  xxx.innerHTML=\".....<script>alert(1)</script>.....\" 的方式进行显示的。 innerHTML里写入的<script>标签不会被运行，如果改为  <img src=1 onload=alert(1) /> 就可以运行了。    \n     2012-06-02 20:20 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  纠正楼上，是 onerror     \n     2012-06-02 20:35 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这么好的漏洞这么好的讨论可惜了 我也准备要刷分了    \n     2012-06-02 23:26 |    \t\t小雨 \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:19        | phper)\t\t \n  @xsser 能把乌云留个sql inj的后门，供虚荣心较强的人自助刷分么？    \n     2012-06-02 23:28 |    \t\t啤酒 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:8        | 道不同.喝酒结盟)\t\t \n  @gainover 3q，之前没有去分析源代码，只是粗糙的去测试了下，看到标签有被阻断就提交了。innerHTML写入内容运行回头测试下。还没注意过    \n     2012-06-03 10:15 |    \t\tHxai11 \t\t\t( 普通白帽子  |\t\t\t        Rank:1137 漏洞数:218        | 于是我们奋力向前游，逆流而上的小舟，不停...)\t\t \n  碉堡了。。。    \n     2012-07-02 17:18 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  @gainove error弹  <script>在里面不能运行 img可以 或者用html实体化 这是个 dom xss 笔记。。分析。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}