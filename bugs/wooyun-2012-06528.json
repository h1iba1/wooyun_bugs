{"id": 20546, "wybug_id": "wooyun-2012-06528", "wybug_title": "拍客piikee竞拍网站系统注射漏洞", "wybug_corp": "竞拍系统", "wybug_author": "piaoye", "wybug_date": "2012-04-29 10:49", "wybug_open_date": "2012-04-29 10:49", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "数字类型注射", "源码审核", "源码分析", "白盒测试", "拍客"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-29：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-04-29：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 刚在乌云看以快拍拍网站充值BUG，就搜索了下这个网站，谷歌里有个类似的网站，程序注射一堆,然后就进去了。 详细说明：  因没有厂商，就写个竞拍系统吧，传出来好给用这系统的站长提个醒。该系统名为：拍客piikee竞拍网站系统为什么说2B那？前台所有文件参数值都这样来的，大家看下这段代码news_arc.php\n<?phpdefine('IN_JP',true);require_once(\"./config/init.php\");\t$arcid = $_REQUEST[\"arcid\"];\tif($arcid!=\"\"){\t\t$qrynews2 = \"select * from news where id = \".$arcid;\t\t\t\t$objnews2=$GLOBALS['db']->get_one($qrynews2);\t\t\t\t    \t}else{\t$objnews2=\"\";\t}  $qrycount = \"select w.id,r.username,w.won_date,p.name,a.auc_final_price,a.auctionID,p.picture1,p.price,(100-100*a.auc_final_price/p.price) as discount,a.auctionID from won_auctions w left join auction a on w.auction_id=a.auctionID left join products p on a.productID=p.productID inner join registration r on w.userid = r.id where w.userid>=0 order by w.won_date desc limit 0,7 \";    $obj1 = $GLOBALS['db']->select($qrycount);$smarty->assign(\"obj1\",$obj1);$smarty->assign(\"objnews2\",$objnews2);$smarty->display('news_arc.htm');?>\n估计程序员赶着回家生孩子，凑合着写的。   漏洞证明：  因数据库密码是明文储存，这就省了破解啥的了，具体可以在siteadmin/addadminmember.php里查看。拿shell怎么办？看是什么主机，iis6 or 阿帕奇的话，在广告管理处;号文件以及%上传即可。   修复方案：  这程序得重写。。。   版权声明：转载请注明来源 piaoye@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-04-29 10:53 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  给力呢。。。可以批量拿站    \n     2012-04-30 15:11 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  ”%上传“ 给个例子    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}