{"id": 43609, "wybug_id": "wooyun-2014-082248", "wybug_title": "搜狗输入法权限提升漏洞", "wybug_corp": "搜狗", "wybug_author": "wefgod", "wybug_date": "2014-11-07 12:13", "wybug_open_date": "2015-02-05 12:14", "wybug_type": "权限提升", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["提权"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向公众公开  简要描述： 搜狗输入法安装量非常大，似乎很危险啊？就连服务器上都有，以后又多了一个提权的手段吗？ 详细说明：  测试的是7.4.0.4142和一个7.4的稍老一点的版本，均存在该问题。\n\n说白了就是调用createprocess的时候第一个参数是null了吧？所以会自动调用c盘下的program.exe详细的看下面漏洞证明   漏洞证明：  复制cmd.exe到c盘下，改名为program.exe，如下：\n\n重启后等待一段时间，会发现该程序被调用了：\n\n看默认的路径就知道，是咱们亲爱的搜狗的文件夹下某个程序调用了他……看下进程的调用命令：\n\n有问题的文件是SGTool.exe ！！！肯定是在createProcess的时候第一个参数有问题吧……如果调用的是其它恶意的程序呢？那就呵呵了   修复方案：  参考http://www.nsfocus.net/vulndb/8240  （好老的问题了） WooYun: 百度输入法调用CreateProcess函数漏洞 或官方文档http://msdn.microsoft.com/en-us/library/ms682425.aspxc:\\program.exe files\\sub dir\\program namec:\\program files\\sub.exe dir\\program namec:\\program files\\sub dir\\program.exe namec:\\program files\\sub dir\\program name.exe   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2014-11-10 20:11 厂商回复： 感谢支持，欢迎到SGSRC平台提交漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-10 20:44 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  居然是低，好歹随便放个中啊    \n     2014-12-15 09:11 |    \t\tsco4x0 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:13        | O_o)\t\t \n  感谢支持，欢迎到SGSRC平台提交漏洞    \n     2015-01-04 15:15 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  这种还是留着用吧，3分，呵呵了~    \n     2015-07-10 12:21 |    \t\t苏安泽 \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:25        | 敢不敢关注一下，<script>alert('关注成功'...)\t\t \n  他是要你去SGSRC提交，搜狗厂商真.....    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}