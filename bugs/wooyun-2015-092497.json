{"id": 46141, "wybug_id": "wooyun-2015-092497", "wybug_title": "银行业(招商银行)设计缺陷可被穷举攻击", "wybug_corp": "招商银行", "wybug_author": "猪猪侠", "wybug_date": "2015-01-18 04:07", "wybug_open_date": "2015-03-04 04:08", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-04：\t细节向公众公开  简要描述： 缺陷1：银行类设计缺陷，每张银行卡的开始区间是地址码，接着是地区码，再按照卡号ID顺序为客户发卡，银行卡的卡号可被枚举，同时所有银行只允许用户使用6位数字的密码，都互联网银行了，实在无法理解。缺陷2：2011年，互联网泄密事件引爆了整个信息安全界，导致传统的用户+密码认证的方式已无法满足现有安全需求，某酒店的数据泄露，导致几千万用户身份证被公开，如果银行还允许客户使用身份证作为登录账号的话，而中国人又偏偏喜欢用生日做为密码，更无语的是身份证里面还包含生日。# 每个身份标识一天能尝试登录5次，999999个密码要500年才能破解，可总有一些人的密码有规律可猜(非常非常喜欢用自己、爱人、子女的生日做密码)，300101，1930年1月1日 -- 2015年1月18日，密码一下变成了31025个，哈哈哈哈哈哈哈哈 详细说明：  #1 利用设计缺陷，通过公开渠道获取到的身份证，以用户生日为密码，同时因为招商银行的登陆接口验证码可识别，即可直接批量穷举。#2 移动银行网页版并没有安全控件，可以轻松提交\n\n\nPOST: https://mobile.cmbchina.com/MobileHtml/Login/LoginC.aspxXmlReq:<PwdC>880808</PwdC><ExtraPwdC>2584</ExtraPwdC><LoginMode>0</LoginMode><LoginByCook>false</LoginByCook><IDTypeC>01</IDTypeC><IDNoC>430921198808082222</IDNoC><RememberFlag>false</RememberFlag><UserAgent>Mozilla/5.0 (iPhone; CPU iPhone OS 7_0 like Mac OS X; en-us) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/7.0 Mobile/11A465 Safari/9537.53</UserAgent><screenW>320</screenW><screenH>568</screenH><OS>iPhone</OS>\n#3 网页版理论上也可以\n\n   漏洞证明：  #4 验证码真的太简单\n二值化：120图像滤波：图像降噪4线性滤波：边缘\n根据以上滤镜建立字模后，就能轻松实现识别招商银行的数字验证码了移动版验证码机器识别\n\n网页版验证码机器识别\n\n系统自带贴心小功能，告诉你这个身份证的人是屌丝，连申请信用卡的级别都没到（图片里面那个人是我，说的我自己，开个玩笑，不是嘲笑）\n\n穷举后可以看到用户的账单\n\n用户信息\n\n消费记录(可能你们觉得这不算啥，不会在意的，最关心这些的估计也就只有坏人了)\n\n   修复方案：  #1 升级验证码难度#2 密码强度   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-01-19 17:07 厂商回复： 感谢对招商银行的安全关注。由于银行卡需在POS、ATM等场合跨行使用，卡号必须有统一的编码规则，密码必须是设备支持的数字。我行已通过各种途径提示客户避免使用生日等容易猜测的密码。网银及手机银行的安全是一个综合防护体系，除密码外，我行交易还有手机短信验证码、UKEY等其他安全措施保障资金安全，请用户放心使用。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-18 04:09 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:207        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  在个人电脑上，同IP用按键精灵自动尝试了30个身份证号，未被安全规则拦截    \n     2015-01-18 04:20 |    \t\t#6c6c6c \t\t\t( 普通白帽子  |\t\t\t        Rank:291 漏洞数:46        | 像一条狗孤独的活着，渴望的活着，绝望的活...)\t\t \n  @猪猪侠 这么叼...    \n     2015-01-18 06:44 |    \t\tJulyTornado \t\t\t( 普通白帽子  |\t\t\t        Rank:339 漏洞数:43        | 善战者，无赫赫之功)\t\t \n  都开始搞银行了。。。    \n     2015-01-18 08:02 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  一哥又开挂了！    \n     2015-01-18 09:03 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:15        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  @猪猪侠 猪哥能否把你字典丢我份？？？感觉你字典如此庞大呢~~~~先谢谢了    \n     2015-01-18 10:00 |    \t\the1renyagao \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:29        | 是金子总会发光，在还未发光之前，先打磨打...)\t\t \n  从研究直观漏洞到设计缺陷的转变了，    \n     2015-01-18 11:17 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:78        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @猪猪侠 说好的发两个就不发呢。    \n     2015-01-18 11:34 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  \"哈哈哈哈哈哈哈哈哈\",?    \n     2015-01-18 11:46 |    \t\t李宇航的小柠檬 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 小柠檬甜不甜)\t\t \n  思路很好    \n     2015-01-18 13:59 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:207        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  猪猪侠居然在刷验证码的洞。他在我心目中高大的形象瞬间坍塌成黑洞了。    \n     2015-01-18 14:00 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @猪猪侠 撞到牛逼的帐号了额    \n     2015-01-18 14:02 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:207        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @泳少 这个登录名和密码是可以算到的，所以应该是穷举攻击，只发了两个穷举，一个撞库    \n     2015-01-18 16:20 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:78        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @猪猪侠 原来如此，不如过几天咱们研究下乌云？只要不被@疯狗 吊起来打就好了    \n     2015-01-18 16:43 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:15        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  @泳少 @猪猪侠  、、、、、祝你俩黑乌云成功~~~ 我潜水    \n     2015-01-18 16:51 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:15        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  猪猪侠居然在刷验证码的洞。他在我心目中高大的形象瞬间坍塌成黑洞了。     \n     2015-01-18 21:20 |    \t\t葫芦岛小弱智 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 葫芦岛小弱智)\t\t \n  我的CenturionCard是否也存在此类漏洞！    \n     2015-02-04 16:04 |    \t\t命运 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我是来乌云秀智商下限的~~)\t\t \n  。。。这算个鸟    \n     2015-02-18 03:02 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:54        | 故乡的原风景.MP3)\t\t \n  @猪猪侠 猪猪侠居然在刷验证码的洞。他在我心目中高大的形象瞬间坍塌成黑洞了。 这是上错马甲了麽？    \n     2015-02-27 23:26 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  高危啊这个    \n     2015-03-04 07:53 |    \t\t90Snake \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:41        | 最大的漏洞就是人)\t\t \n  猪猪侠居然在刷验证码的洞。他在我心目中高大的形象瞬间坍塌成黑洞了。 这是上错马甲了麽？    \n     2015-03-04 10:22 |    \t\t静默 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | 安全小白)\t\t \n  猪猪侠居然在刷验证码的洞。他在我心目中高大的形象瞬间坍塌成黑洞了。 这绝对是上错马甲了啊，看看这页没有杀气王子哦。    \n     2015-04-23 09:22 |    \t\t胡小树 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:8        | 我是一颗小小树)\t\t \n  @猪猪侠 猪哥，我看到亮点了，打码不全啊    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}