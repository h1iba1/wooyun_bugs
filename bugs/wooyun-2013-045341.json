{"id": 6517, "wybug_id": "wooyun-2013-045341", "wybug_title": "扩散性百万亚瑟王-官网后台管理系统（后台漏洞）", "wybug_corp": "盛大游戏", "wybug_author": "Tang", "wybug_date": "2013-12-09 10:48", "wybug_open_date": "2014-01-23 10:49", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型", "未授权访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-23：\t细节向公众公开  简要描述： 昨天提交的http://www.wooyun.org/bugs/wooyun-2013-045242的续集。后台存在越权、XSS漏洞，若被外部（或内部人员）利用，则可以获得大量用户数据。 详细说明：  之前盛大回复到关于后台系统安全性的问题，于是今天继续深入进行了测试，遂发现两处可造成影响的漏洞。考虑到此后台可能为内部通用性软件，影响可以更大。后台地址为：\nhttp://api.mam.sdo.com/index.php?g=Admin&m=Index\n对m参数进行猜解发现：\nhttp://api.mam.sdo.com/index.php?g=Admin&m=Admin\n访问后发现竟然存在越权，可随意修改其他帐户的密码。进一步观察，猜解出了：\nhttp://api.mam.sdo.com/index.php?g=Admin&m=Admin&a=addAdmin\n可随意添加帐户联系到盛大后，获得授权。观察了下超级管理员权限的管理页面，发现全部未做授权，任何管理员均可访问敏感信息（猜解访问地址，并不困难，关键词都是常用单词），包括所有MA游戏帐号等。另外，文章管理处存在存储型XSS漏洞，直接使用HTML代码模式即可。最后，存在一处报错：\nhttp://api.mam.sdo.com/index.php?g=Admin&m=News&a=Add\n   漏洞证明：  未授权访问：\n\n\n\n存储型XSS：\n\n报错：\n\n   修复方案：  1、授权2、kindeditor   版权声明：转载请注明来源 Tang@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-12-09 11:55 厂商回复： 确实存在管理员和超级管理员傻傻分不清楚的情况，对开发回复\"都是管理员\"也相当无语！谢谢报告！ 最新状态： 2013-12-09：补充一下：kindeditor 我们是统一上传到图片服务器   ", "replys": "漏洞评价：\n评论\n     2014-01-24 12:58 |    \t\t木马游民 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:8        | I love LSD!)\t\t \n  都是管理员.....    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}