{"id": 51705, "wybug_id": "wooyun-2014-073616", "wybug_title": "某通用系统存在SQL注入", "wybug_corp": "西安网科创想", "wybug_author": "小邪", "wybug_date": "2014-08-26 12:29", "wybug_open_date": "2014-11-24 12:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-03：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-24：\t细节向公众公开  简要描述： 网科创想通用系统存在SQL注入 客户案例上百个 之前分析有些错误重新写了 求审核 详细说明：  客户案例地址：http://www.xanet.net/case.phpheader.php\n<?php\tdefine('IN_WKCX', true);\tinclude_once(\"includes/init.php\");\t$catid = !empty($_GET['catid']) ? intval($_GET['catid']) : '';\t$id = !empty($_GET['id']) ? intval($_GET['id']) : '';//用intval进行过滤\t$type = !empty($_GET['type']) ? trim($_GET['type']) : '';?>\n问题文件\n<?phpinclude_once('header.php');//加载过滤文件$catid=!empty($_REQUEST['catid']) ? $_REQUEST['catid'] : '';$act=!empty($_REQUEST['act']) ? trim($_REQUEST['act']) : '';//问题处 对变量值是否为空进行判断 但逻辑存在错误 使变量在不为空的情况下二次赋值 从而使之前的过滤无效  $sql = \"select * from wkcx_class where id=$catid order by class_order asc,ps_time desc\";$res = $db->query($sql);$row = $db->getarray($res);?>\n   漏洞证明：  我们拿厂商站进行测试注入地址：http://www.xanet.net/site.php?id=444\n\n\n\n\n\n这里我整理了点案例出来 还有很多就没试了 http://www.xanet.net/site.php?id=444http://www.weishangzhiye.com/about_1.php?big_id=410http://www.hzmflower.com/bisai_list.php?catid=545http://www.xalhda.gov.cn/list.php?catid=130http://www.deqian56.com/com.php?id=13http://www.jdsh88.com/com.php?id=230http://www.sxsfz.cn/com.php?bid=230&id=342http://www.ciecos-xa.net/com.php?id=481http://www.ciecos-xa.net/com.php?id=481http://www.qiangjing120.com/com.php?id=230http://www.jprjkj.com/com.php?id=230http://www.dky53.com/news.php?big_id=465&cat_id=468   修复方案：  将!empty改成empty 另外加强过滤   版权声明：转载请注明来源 小邪@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-08-31 09:36 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-26 14:28 |    \t\t小邪 \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:47        | ielts过过过)\t\t \n  修改求审核@xsser    \n     2014-08-26 14:39 |    \t\t小邪 \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:47        | ielts过过过)\t\t \n  为什么小厂商处理了= = 都能出密码啊@xsser@疯狗    \n     2014-08-27 17:17 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  膜拜大大..    \n     2014-08-27 18:58 |    \t\t小邪 \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:47        | ielts过过过)\t\t \n  @zhxs 小神蝈蝈求不黑    \n     2014-09-04 20:01 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  洞主，给了你多少钱啊    \n     2014-09-04 21:49 |    \t\t小邪 \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:47        | ielts过过过)\t\t \n  @贫道来自河北 最低的..    \n     2014-09-04 22:02 |    \t\t小邪 \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:47        | ielts过过过)\t\t \n  @贫道来自河北 200 = =    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}