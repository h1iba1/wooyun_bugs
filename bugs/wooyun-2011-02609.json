{"id": 22314, "wybug_id": "wooyun-2011-02609", "wybug_title": "腾讯3个鸡肋漏洞组合的利用", "wybug_corp": "腾讯", "wybug_author": "only_guest", "wybug_date": "2011-08-02 01:13", "wybug_open_date": "2011-09-01 01:14", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["利用技巧", "黑盒测试技巧", "手机短信", "敏感接口未加权限认证"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-08-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-08-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-08-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-08-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-09-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-09-01：\t细节向公众公开  简要描述： 权限绕过+跨站+服务端未验证=一夜之间4亿用户的悲剧 详细说明：  先登陆http://faxin.soso.com/有cookie后打开下面的页面http://faxin.soso.com/_JSON_Page_User_Getgold.php?method=sendInvite&parameters=%5B%225447055%22%5D中间%5B%225447055%22%5D里面的5447055是要发送的QQ号随意设置,可以发送给任何人,但是系统中写的是邀请好友,但这里可以发给仍何人打开页面显示true则为发送成功`对方电脑界面会显示一个QQ系统消息,提示好友邀请参加发薪计划.所以造成了第一个权限绕过\n\n之后就是我发现打开那个消息之后,加载的网页中会调用邀请人的QQ名称,我就使用QQ那个页面的一个H3的标签作为我的QQ姓名试了一下,发现果然存在跨站,而QQ的名称最长限制字符是24个字符,所以刚好够用<iframe>来做跨站,我就测试了下,可以成功,但是限制太大,因为只能24个字符,太短了.但是这里跨站已经成功了,所以是第二个漏洞,跨站之后为了突破QQ名字长度限制,就去抓了WEBqq的包,发现果然可以改长度,轻松达到30位以上,虽然QQ名称显示是24位,但其实已经有30多位了,在上面的跨站调用中成功.第三个漏洞,服务端没有做长度的二次验证.\n\n我做了小范围测试,我8M的带宽,限制每秒2000次提交,一小时近千万的发送量.如果我换台高性能服务器呢?带宽在大点呢?我们来算个简单数学题,跨站中挂个弹窗代码,我发送1亿用户,2千万点开了这个消息.1000IP=5元那么我就轻松有10万的收益了...也许数据是理想值,但是如果挂的不是弹窗,是一个诱导下载呢?你们自己算哦..发现这漏洞后没有公布出去,也没有做任何利用,就立即提交了,希望能帮我们小组的几个人认证下腾讯微搏,提交了很多次了, 也没被通过.谢谢了.   漏洞证明：  http://faxin.soso.com/_JSON_Page_User_Getgold.php?method=sendInvite&parameters=%5B%225447055%22%5D   修复方案：  你们最专业了..   版权声明：转载请注明来源 only_guest@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2011-08-02 09:24 厂商回复： thx 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-08-02 09:44 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  ...额,确认了.能帮我认证下微搏么?没门路啊..    \n     2011-08-02 16:51 |    \t\tyoustar \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:8        | 我们人啊~)\t\t \n  支持，看码    \n     2011-09-02 01:10 |    \t\t帅气凌云 \t\t\t( 普通白帽子  |\t\t\t        Rank:314 漏洞数:60        | 弱点扫描{Www.VulScan.CN} 为网站健康检查...)\t\t \n  这个可以    \n     2011-09-02 07:43 |    \t\t但丁 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 比較懶 沒什麽好介紹的)\t\t \n  干嘛不留着呀....    \n     2011-09-02 23:13 |    \t\tSogili \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:27        )\t\t \n  很V5    \n     2011-09-03 19:26 |    \t\t饮恨 \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:6        | 既然选择了远方就必须日夜兼程)\t\t \n  这个可以把QQ当成后门来用的说。。。    \n     2011-10-21 11:39 |    \t\t风云 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 简要介绍)\t\t \n  好牛比    \n     2011-11-22 18:24 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  这个蛮经典的。    \n     2011-11-23 20:47 |    \t\tWebSPRing \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:18        | Focus on Web Security (wspringox@gmail.c...)\t\t \n  来学习了。    \n     2012-01-21 08:49 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  经典案例，mark之    \n     2012-04-30 12:50 |    \t\tSay \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:4        | 谁又会鉴定谁正常？)\t\t \n  这个威武 = = 我发现TC不少xss啊    \n     2012-06-07 14:02 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @gainover 你那个礼物的要是没有次数限制的话，貌似杀伤力比这个还厉害啊。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}