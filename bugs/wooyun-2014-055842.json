{"id": 56919, "wybug_id": "wooyun-2014-055842", "wybug_title": "qibocms 下载系统SQL注入一枚（官网可重现）", "wybug_corp": "齐博CMS", "wybug_author": "′雨。", "wybug_date": "2014-04-07 23:22", "wybug_open_date": "2014-07-06 23:23", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-06-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-06：\t细节向公众公开  简要描述： 过滤不严。或许qibo上的其他的系统也还存在这个洞   不过我没细看。 表示也不清楚。 详细说明：  刚从齐博官网上面下了几个系统下来看看。 首先先说一下  企业系统 和 黄页系统、   上次我在乌云发了两个类似的洞     虽然官方是在论坛上发布补丁了。   在首页上把b2b系统的文件更新了 ,但是在主页上并没有更新 企业系统 和 黄页系统 这两个类似的漏洞文件。____________________________________________________________________________下载系统。在download/s_rpc.php中\n<?phprequire(dirname(__FILE__).'/global.php');header('Content-Type: text/html; charset=gb2312');require_once(ROOT_PATH.\"inc/class.chinese.php\");$cnvert = new Chinese(\"UTF8\",\"GB2312\",$_POST['queryString'],ROOT_PATH.\"./inc/gbkcode/\");$_POST['queryString'] = $cnvert->ConvertIT();$queryString = $_POST['queryString'];   if(strlen($queryString) >0) {\t\t\t  $query = $db->query(\"SELECT title FROM {$_pre}article WHERE title LIKE '$queryString' ORDER BY hits DESC LIMIT 10\");\t\t  while ($result = $db->fetch_array($query)) {\t\t\t\t\t  echo '<li onClick=\"fill(\\''.$result[title].'\\');\">'.$result[title].'</li>';\t\t  }  }\n虽然全局转义 不过有\n$cnvert = new Chinese(\"UTF8\",\"GB2312\",$_POST['queryString'],ROOT_PATH.\"./inc/gbkcode/\");$_POST['queryString'] = $cnvert->ConvertIT();$queryString = $_POST['queryString'];\n这个 就可以来宽字节了。在我看的qibo官网上的那些系统 有些过滤了这个 不过这个系统没有过滤。我也没看完 不清楚 其他系统过滤没。然后直接带入了查询  输出。   漏洞证明：  \n\n本地测试成功测试一下官网\n\n官网测试成功 有图 有真相。   修复方案：  求过滤。求20分。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-04-10 09:27 厂商回复： 以前的老问题。下载系统遗漏了打补丁。感谢提出来 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-09 11:37 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  机油你很给力阿，关注你了    \n     2014-04-09 12:35 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @Mody 谢谢。    \n     2014-04-12 19:43 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @′ 雨。 大神你好，求大神挖掘马克思CMS，现在的AV站就靠maxcms 0day了    \n     2014-04-12 19:45 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @U神    asp 不会。。。    \n     2014-04-12 19:50 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @′  雨。 大神，你天天挖CMS的洞儿，奖了多少人民币了    \n     2014-04-12 20:08 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @U神 。。。。 还没发钱 就发了三个洞的。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}