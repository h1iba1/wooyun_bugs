{"id": 10539, "wybug_id": "wooyun-2013-027779", "wybug_title": "重庆联通某华为三层交换机SNMP漏洞导致该设备沦陷", "wybug_corp": "重庆联通", "wybug_author": "灰帽子", "wybug_date": "2013-07-05 10:17", "wybug_open_date": "2013-08-19 10:17", "wybug_type": "网络未授权访问", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["默认团体字符串"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-19：\t细节向公众公开  简要描述： 重庆联通一华为设备未授权访问。 详细说明：  重庆联通一个H3C设备存在SNMP漏洞。通过只读权限的团体字符串读到帐号和密码，已经成功登录后台，相同用户名密码Telnet连接成功。   漏洞证明：  第一步，发现了这个IP默认读写团体字符串，读出基本信息。\n\n第二步，使用这个BT5R3下的SNMPCHECK 读出来用户名和密码。较老的版本是这个命令\nsnmpwalk -c public -v 1 211.158.16.90 1.3.6.1.4.1.2011.10.2.12.1.1.1\n\n\n第三步，使用用户名h3c密码huawei-3com登录80端口。\n\n换个界面看看，\n\n第四步，使用用户名h3c密码huawei-3com 登录23端口进去。\n\n最后，还是没发现ftp+ftp的组合是什么情况，求路过的解释   修复方案：  1 如果可以，那就关闭SNMP功能，否则首先增加团体字符串复杂度。2 使用较安全的SNMPv3版本，不使用SNMPv1/v2。3 在使用SNMPv1/v2时，增加ACL或FireWall来限制访问。4 在使用SNMPv1/v2时，屏蔽能够查询用户帐户信息的特定MIB节点。下面这个是华为的安全公告\nhttp://support.huawei.com/support/pages/news/NewsInfoAction.do?actionFlag=view&doc_id=IN0000054930&colID=ROOTENWEB|CO0000000170\n这个还是华为的安全公告\nhttp://support.huawei.com/support/pages/news/NewsInfoAction.do?doc_id=IN0000054931&colID=ROOTWEB|CO0000000060&actionFlag=view\n   版权声明：转载请注明来源 灰帽子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2013-07-09 23:28 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}