{"id": 9408, "wybug_id": "wooyun-2013-034106", "wybug_title": "中国人寿任意用户密码重置二", "wybug_corp": "中国人寿", "wybug_author": "xfkxfk", "wybug_date": "2013-08-11 18:55", "wybug_open_date": "2013-09-25 18:55", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感接口缺乏校验", "逻辑错误", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-25：\t细节向公众公开  简要描述： 中国人寿任意用户密码重置，另一种方法 详细说明：  传送门：\nhttp://wooyun.org/bugs/wooyun-2013-034101\n现在我们换一种方法重置密码。先随便找一个用户，我们看看admin@e-chinalife.com这个账户，已注册\n\n首先我们打开忘记密码功能，重置我们自己的账户，重置密码连接发送到邮箱\n\n我们来看看这个连接的构造：\n\n最主要的参数，一长串字符，这写字符是base64编码的，我们解码后看到是邮箱地址和当前时间，那么我们把邮箱地址换成admin@e-chinalife.com，然后再编码：\n\n然后，打开构造好的连接\n\n成功构造了连接，输入新密码\n\n成功重置admin@e-chinalife.com密码。   漏洞证明：  登录一下，看看是否成功\n\n\n\n   修复方案：  重置密码连接的参数应该不可逆，不可被猜测。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2013-08-12 08:11 厂商回复： 感谢对中国人寿的关注，尽快组织整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-25 23:54 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  这代码写的 时间戳都没检验    \n     2013-09-26 00:17 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小胖胖要减肥 。。。额，就直接邮箱base64加密了一下额。。其实我还是觉得 在服务器端生成一个随机数 配合验证下比较靠谱 时间戳都不安全    \n     2013-09-26 08:50 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @px1624 @小胖胖要减肥 这估计都是N年前堆的代码吧，不过这种情况还挺多的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}