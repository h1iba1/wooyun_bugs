{"id": 2939, "wybug_id": "wooyun-2014-062304", "wybug_title": "某省联通可转移他人某些流量实现自己下月免费上网", "wybug_corp": "中国联通", "wybug_author": "ppcat", "wybug_date": "2014-05-29 13:49", "wybug_open_date": "2014-07-13 13:50", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-13：\t细节向公众公开  简要描述： 妈妈再也不用担心我的上网！4G用户不可用哦~！ 详细说明：  把某省联通所有用户红包流量转移到自己账户先来到重置密码界面，http://17wo.cn/ForgetPassword.action\n\n验证码写到Cookie，真的好高端的说！\n\n既然这样的话，就可以写个程序，遍历手机号码，获取验证码，并从HTTP响应头获得到下发到手机的验证码，并自动重置用户密码。重置验证码的请求为POST请求，没有Token,请求如下所示：\n\n下面使用重置的密码进行登陆\n\n登陆的地方没有验证码，也没有Token。OK！成功登陆！下一步导航到转移流量页面http://17wo.cn/FlowRedPacket!enterSendFlowRedPacket.action?pageName=sentdirect\n\n输入要转给流量的号码和流量值，当前账户剩余的流量值可以从页面上通过正则表达式匹配到。下面进行流量转移，流量转移的请求是通过GET请求发起，无Token。\n\n此时，会向被转移用户的手机发送一条短信，但是这条短信可以从转移用户的页面里获取到http://17wo.cn/FlowRedPacket!sendRedPacketList.action\n\n故，可用正则表达式匹配到该地址，访问该地址，并进行登陆，即可成功领取流量。\n\n此处为了能够批量接收其他用户的流量，可以复用接收流量用户的SESSION，这样就不用再登陆了，非常方便。用户原来的红包流量是\n\n转移之后的红包流量是\n\n按照规则，流量红包本月赚取下月生效。------------------------------------割-------------------------------------------------------综合分析以上步骤，可以写出程序遍历该省联通手机号码，并批量进行密码重置（可采用代理），自动登录，进行红包流量转移，纯机器操作，忽略发送到手机上的领取流量的链接即可。------------------------------------割-------------------------------------------------------红包流量的获取是通过用户的一些活动产生，有许多用户未参加过，故可写程序自动参加，参加活动也是一个请求而已，一般每个用户可获得50M左右的红包流量。当然，对于未开通的手机号码，如网上营业厅的手机号码，也是有效的。   漏洞证明：     修复方案：  主要是短信验证码，改了还是有问题。再就是关键地方没有防止机器。   版权声明：转载请注明来源 ppcat@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2014-06-03 10:48 厂商回复： CNVD确认所述情况，未直接复现，已经转由CNCERT下发给广东分中心，由其后续通报给当地基础电信企业处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-29 13:59 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  牛逼~！    \n     2014-05-29 15:05 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  — —。我流量是不是被你X的    \n     2014-05-29 15:12 |    \t\t小震 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | ~)\t\t \n  cncert国家互联网应急中心已转交至日本省联通运营商处理。    \n     2014-07-13 16:17 |    \t\tThe soul \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:12        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  哥，我的流量 ，我已经拨打110了，盗我流量 - -    \n     2014-07-26 21:56 |    \t\tppcat \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:5        | 喵喵~~~)\t\t \n  @The soul 呜呜……偶不是故意的，ps：谁说我是你“哥”了？~哼哼~~    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}