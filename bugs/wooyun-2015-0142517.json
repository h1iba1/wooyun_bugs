{"id": 67730, "wybug_id": "wooyun-2015-0142517", "wybug_title": "华金证券主站任意文件下载", "wybug_corp": "华金证券", "wybug_author": "ㄚ冷的微笑", "wybug_date": "2015-09-23 11:03", "wybug_open_date": "2015-11-09 13:52", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-25：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-10-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向公众公开  简要描述： 华金证券主站任意文件下载 详细说明：  这次说明一下思路好了：1.發現http://**.**.**.**/download/report?file=/public/images/2014cwbb.pdf，很容易就找到漏洞的点。2.定位一下pdf的档案，找file参数值定向的位置。发现http://**.**.**.**/public/images/2014cwbb.pdf可下载，所以确定是在网站根目录。3.找了一下有无php扩展名，发现有**.**.**.**/index.php/Ywfw/index07，所以尝试http://**.**.**.**/download/report?file=/index.php\n\n4.从网站结构上，不难发现是MVC架构，但从index.php上，确定是知名的php framework:\n\n5.从php framework中，可以得知几个比较重要的配置文件位置，以及如何下载原始码：config中有database.php可以得知DB帐密，routes.php中可以得知从网址如何对应到程序代码位置。database.php:\n\nroutes.php\"\n\n6.附註:执行中发现响应竟然是找不到档案，还以为下载失败，结果从status code发现是500 internal error，查看500的content竟然有原始码。\n\n\n\n   漏洞证明：  \nhttp://**.**.**.**/download/report?file=/index.php\n\n\n   修复方案：     版权声明：转载请注明来源 ㄚ冷的微笑@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-09-25 13:52 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT向证券业信息化主管部门通报，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}