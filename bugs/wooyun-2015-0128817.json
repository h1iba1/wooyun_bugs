{"id": 26378, "wybug_id": "wooyun-2015-0128817", "wybug_title": "威锋某系统重要信息泄露", "wybug_corp": "weiphone", "wybug_author": "路人甲", "wybug_date": "2015-07-23 23:57", "wybug_open_date": "2015-09-07 10:38", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄漏", "默认配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-07：\t细节向公众公开  简要描述： 威锋某系统重要信息泄露 详细说明：  备份文件导致ROOT密码泄露   漏洞证明：  http://editor.feng.com/config.php.bak\n<?php$db_config['db_driver']   = 'db';\t              //db,adodb,mdb$db_config['db_type']     = 'mysql';                  //mysql,mssql,oracle$db_config['db_host']     = 'localhost:3306';      //数据库主机\t$db_config['db_user']     = 'root';      //数据库用户名\t$db_config['db_password'] = 'cididc_yp106520921';  //数据库用户密码\t$db_config['db_name']     = 'editor_naivix_com';      //数据库名\t\t$db_config['table_pre']   = 'cmsware_'; //CMS表名前缀\t$db_config['db_charset']   = 'utf8'; //数据库字符集 latin1,utf8,utf8...$SYS_CONFIG['enable_validcode'] = 0; //是否开启登陆图形验证码. 1-开启,0-关闭$SYS_CONFIG['language'] = 'utf8-zh'; //系统语言$SYS_CONFIG['ftp_mode'] = 0 ; //系统运行在FTP模式,1-是,0-否$SYS_CONFIG['ftp_host'] = 'cmsware'; //FTP主机地址$SYS_CONFIG['ftp_port'] = '21'; //FTP服务器端口$SYS_CONFIG['ftp_username'] = 'cms'; //FTP用户名$SYS_CONFIG['ftp_password'] = 'cms'; //FTP密码$SYS_CONFIG['ftp_cms_admin_path'] = ''; //CMS管理目录相对FTP根目录的路径 $SYS_CONFIG['dir_mode'] = 0777; //系统创建目录的默认权限$SYS_CONFIG['file_mode'] = 0777; //系统创建文件的默认权限$SYS_CONFIG['error_reporting'] = 'html'; //系统报错模式 file,html,js$SYS_CONFIG['tpl_error_display'] = true; //是否在最终页面显示报错信息 true, false$SYS_CONFIG['admin_dir_name'] = 'admin'; //管理入口目录名//--------------------------------以下部分请不要修改--------------------------//$db_config['table_content_pre']     = 'content';\t$db_config['table_contribution_pre']     = 'contribution';\t$db_config['table_collection_pre']     = 'collection';\t$db_config['table_publish_pre']     = 'publish';$lang_user = 'lang_user';$lang_admin = 'lang_admin';$SYS_DEBUG = true;class table {\tvar $sys;\tvar $user;\tvar $group;\tvar $admin_sessions;\tvar $sessions;\tvar $site;\tvar $cate;\tvar $content_fields;\tvar $content_index;\tvar $content_table; \tvar $psn; \tvar $resource;\tvar $publish_log;\tvar $collection_cate;\tvar $collection_rules;\tvar $tasks; \tvar $contribution;\tvar $resource_ref;\tvar $workflow;\tvar $workflow_state;\tvar $workflow_record ;\tvar $log_admin;\tvar $log_login ;\tvar $block_ip;\tvar $contribution_note;\t  \tvar $keywords;\tvar $pubadminmasks; \tvar $plugins;\tvar $tpl_vars; \tvar $tpl_cate; \tvar $tpl_data;\tfunction table()\t{\t\tglobal $db_config;\t\t$this->sys = $db_config['table_pre'].'sys';\t\t$this->user = $db_config['table_pre'].'user';\t\t$this->group = $db_config['table_pre'].'group';\t\t\t$this->admin_sessions = $db_config['table_pre'].'admin_sessions';\t\t$this->sessions = $db_config['table_pre'].'sessions';\t\t$this->site = $db_config['table_pre'].'site';\t\t$this->content_fields = $db_config['table_pre'].'content_fields';\t\t$this->content_index = $db_config['table_pre'].'content_index';\t\t$this->content_table = $db_config['table_pre'].'content_table';\t\t$this->psn = $db_config['table_pre'].'psn';\t\t$this->resource = $db_config['table_pre'].'resource';\t\t$this->publish_log = $db_config['table_pre'].'publish_log';\t\t$this->collection_cate = $db_config['table_pre'].'collection_category';\t\t$this->collection_rules = $db_config['table_pre'].'collection_rules';\t\t$this->tasks = $db_config['table_pre'].'tasks';\t\t$this->cate = $db_config['table_pre'].'category';\t\t$this->contribution = $db_config['table_pre'].'contribution';\t\t$this->contribution_note = $db_config['table_pre'].'contribution_note'; \t\t$this->keywords = $db_config['table_pre'].'keywords';\t\t$this->pubadminmasks = $db_config['table_pre'].'pubadminmasks';\t\t$this->plugins = $db_config['table_pre'].'plugins';\t\t$this->tpl_vars = $db_config['table_pre'].'tpl_vars';\t\t$this->resource_ref = $db_config['table_pre'].'resource_ref';\t\t\t\t$this->workflow = $db_config['table_pre'].'workflow';\t\t$this->workflow_state = $db_config['table_pre'].'workflow_state';\t\t$this->workflow_record = $db_config['table_pre'].'workflow_record';\t\t\t\t$this->log_login = $db_config['table_pre'].'log_login';\t\t$this->log_admin = $db_config['table_pre'].'log_admin';\t\t$this->block_ip = $db_config['table_pre'].'block_ip';\t\t\t$this->tpl_cate  = $db_config['table_pre'].'tpl_cate';\t\t$this->tpl_data = $db_config['table_pre'].'tpl_data';\t\t$this->tpl_block = $db_config['table_pre'].'tpl_block';\t\t$this->extra_publish = $db_config['table_pre'].'extra_publish';\t\t$this->node_fields = $db_config['table_pre'].'node_fields';\t}}$table=new table();define(\"TPL_Error_Display\", $SYS_CONFIG['tpl_error_display']);define(\"ADMIN_NAME\", $SYS_CONFIG['admin_dir_name']);?>\n   修复方案：  删之   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2015-07-24 10:36 厂商回复： 谢谢提醒 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}