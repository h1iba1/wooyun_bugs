{"id": 24236, "wybug_id": "wooyun-2010-0411", "wybug_title": "phpcms 2008 sp4 爆路径及任意文件删除漏洞", "wybug_corp": "PHPCMS", "wybug_author": "CnCxzSec(衰仔)", "wybug_date": "2010-09-04 14:54", "wybug_open_date": "2010-09-04 22:04", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意删除文件"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-09-04：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2010-09-04：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 某页面下，未作容错处理导致爆路径，同时过滤不严导致恶意攻击者可以删除网站任意文件 详细说明：  corpandresize/config.inc.php中定义：\n$tmp = $_COOKIE['tmp'];define(\"TMP_PATH\", $tmp);\n在corpandresize/process.php中用到TMP_PATH，满足前面的一系列条件后（这个很好满足，都是用户可控的）：\n76: @unlink(TMP_PATH.'/'.$thumbfile);\n没有检查$_COOKIE['tmp']就直接放入unlink()了，只要修改cookie就可以删除网站的任意文件。google了一下，发现网上有人在今年5月份公开过同目录下另一个文件造成的爆路径问题（http://lcx.cc/?FoxNews=123.html），但分析得不够详细，利用方法也稍显麻烦，这里给出的利用方式更简单。   漏洞证明：  注册用户登陆后访问\nhttp://localhost/phpcms/corpandresize/process.php?pic=../images/logo.gif\n此时爆出绝对路径（当收集信息，没什么好利用的）在cookie中添加一句（或修改原有值）tmp=../index.php%00即可删除首页文件测试的时候发现官方demo站不成功。。。但是本地测试ok（官方最新安装包），在网上找大站测试，一打一个准~   修复方案：  你懂的，麻烦盛大的同学转给phpcms那边吧。   版权声明：转载请注明来源 CnCxzSec(衰仔)@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：10 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 10, "Ranks": null}