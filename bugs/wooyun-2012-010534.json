{"id": 18501, "wybug_id": "wooyun-2012-010534", "wybug_title": "盛大乐众ROM的几个安全问题", "wybug_corp": "盛大网络", "wybug_author": "Claud", "wybug_date": "2012-08-03 19:11", "wybug_open_date": "2012-08-08 19:12", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 可能造成个人数据泄露。攻击难度有点大，出现攻击的可能性不高。作为学习案例发出来吧。为了避免公开前被娱乐化讨论，申明下，和以前我报的别的问题相比，产生的原因不同。 详细说明：  先说环境。手机：Nexus S；系统：乐众ROM 1.7.27。主要对“备份助手”的同步联系人和同步日历功能做评估。潜在的安全问题如下：1. 未向用户提示、未经用户同意，首次使用该功能时，自动向SP号码106575160882发送两条短信以注册盛大账号，每条1毛钱。这是相当不标准的做法。2. 将新建的盛大账号和密码以短信方式发送给用户。攻击者如果注册一个短信的接收器，可以获取到这一初始密码。3. 以IMSI码作为唯一凭证与服务器端进行联系人和日历同步，可能产生伪造攻击。即攻击者在获得乐众ROM用户的IMSI码后，可以采用重打包做个桩、修改ROM硬编码IMSI返回值、还原通信协议等方法，以IMSI码与盛大服务器进行通信，通过验证后进行同步，从而获得用户存储在云端的数据。（注：这里的攻击方法是理论上的，我没有做实际的攻击验证。无论如何，以IMSI码作为唯一认证凭据，这个问题可以归为OWASP Top Mobile 10 Risks之一。）4. 同步过程完全明文。在开放的WiFi环境下，或钓鱼WiFi热点下，数据可以被攻击者读取。   漏洞证明：  1. 从移动查到的发短信记录（本地没有发送提示，也没有发送记录）：\n\n2. 收到包含密码的短信：\n\n3. 以IMSI作为唯一凭据与服务器认证：\n\n4. 明文通信同步：\n\n   修复方案：  别用这种简陋和不正规的协议，少用明文传输个人数据。如果为了考虑用户体验，用系统的账户管理啊。从郭振架构师的一次技术交流看，你们在账户、同步、备份上做了很多定制工作，怎么这个备份还自己再搞一套？   版权声明：转载请注明来源 Claud@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-08-08 19:12 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-08-27 14:46 |    \t\tRona \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:23        | test)\t\t \n  这些个问题，除了自动发两条短信的流氓行为，其他的现在都这样。    \n     2012-08-27 14:47 |    \t\tRona \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:23        | test)\t\t \n  话说lz如何用wireshark抓取的手机包    \n     2012-08-27 20:46 |    \t\tClaud \t\t\t( 普通白帽子  |\t\t\t        Rank:161 漏洞数:18        | secmobi.com)\t\t \n  @Rona 手机上tcpdump以后，拷出来看。另一种方法是用PC共享Wifi网络，第三种方法是配置PC作为proxy    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}