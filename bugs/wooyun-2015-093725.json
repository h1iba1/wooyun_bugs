{"id": 45877, "wybug_id": "wooyun-2015-093725", "wybug_title": "3322域名重置任意用户密码", "wybug_corp": "3322.org", "wybug_author": "路人甲", "wybug_date": "2015-01-24 19:33", "wybug_open_date": "2015-03-10 19:34", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "找回密码"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-10：\t细节向公众公开  简要描述： 找回密码时可以重置任意用户的密码。 详细说明：  找回密码功能发送到email中的验证码和cookie中的一个值绑定，未和需要找回的用户名绑定，导致可用A邮箱中的验证码，验证找回任意用户。   漏洞证明：  找回密码时看了下，出现如图这么一个token，直觉告诉我，这个发过去的验证码和cookie绑定了\n\n于是，随便找了一个用户测试，先给我自己的账户发一个找回密码邮件，如图：\n\n收到了，验证码是6867然后找个测试目标，随便搜索一个，就你了：qq99330646.f3322.org,试了下用户名就是qq99330646，点找回，输入我邮箱里的那个验证码6867，验证通过，\n\n输入新密码，然后进去\n\n由于之前3322被别人拖过库，所以那些手机没验证过的用户，重置完密码，登陆上去的时候需要绑定手机才能登陆成功。   修复方案：  找回密码功能发送的验证码和需要找回的用户名绑定吧   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-01-29 08:44 厂商回复： CNVD未直接复现，转由CNCERT向3322域名注册服务商——常州某公司通报，由其后续确认和处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-24 19:42 |    \t\t鬼五 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:83        )\t\t \n  抓鸡阔不会放过你的    \n     2015-01-24 19:46 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  其实这种标题一写出来，基本都能知道内容了，对厂商不利。    \n     2015-01-24 19:52 |    \t\t阿萨帝 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:68        | 不发礼物的索要联系方式都是耍流氓。)\t\t \n  要不高大上的标题怎么来的。    \n     2015-01-24 20:26 |    \t\tsco4x0 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:13        | O_o)\t\t \n  鸡总们会打死你    \n     2015-01-24 21:22 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  多少人的肉鸡要变成二手货啊。    \n     2015-01-24 21:45 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  黑产帝 ddos帝不会放过你！    \n     2015-01-24 21:45 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  估计还有3322的洞吧？    \n     2015-01-24 21:57 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  由于这个洞标题太明显，已经通知3322技术修复了，所以大家不用再试了，复现不了。    \n     2015-01-24 22:19 |    \t\t蛇精病 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:10        | 你连棒棒糖都没有，还谈什么狗屁爱情？)\t\t \n  多少人的肉鸡要变成二手货啊。    \n     2015-03-11 09:35 |    \t\tliyang \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:11        | 低调 沉默 守望)\t\t \n  楼主我有个问题：你说的那个cookies看名字应该是django的csrf token，这个漏洞应该和cookies没关系，可能是别的逻辑问题。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}