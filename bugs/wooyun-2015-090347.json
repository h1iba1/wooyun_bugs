{"id": 40965, "wybug_id": "wooyun-2015-090347", "wybug_title": "MES每实内部敏感信息泄露", "wybug_corp": "MES每实", "wybug_author": "orange", "wybug_date": "2015-01-07 12:18", "wybug_open_date": "2015-02-21 12:20", "wybug_type": "内部绝密信息泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "管理后台对外", "安全意识不足", "管理员密码泄漏", "内部运维管理不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-07：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-02-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： MES每实内部敏感信息泄露，危及21cake 详细说明：  0x00 关键字\ngithub，llllllllllllllllllllllll\n0x01 过程由于昨天提交了一个21cake的漏洞，出于习惯就上了一下github，搜索关键字 “21cake”\n\ncode那里好像有东西\n\n嗯？！ (●′ω`●)  svn，顺势看了下去\n\n貌似是短信接口，登了一下发现账户被禁用\n\n继续往下翻\n\n\n\n\n\n\n<?php2\t/**3\t * Cake Detail4\t * @copyright Copyright (c) 2012, 21cake food co.ltd5\t * @author 21Cake Dev Team…\t5\t * @author 21Cake Dev Team6\t */7\t8\trequire(dirname(__FILE__) . '/includes/init.php');9\t$_REQUEST['act'] = empty($_REQUEST['act']) ? 'list' : trim($_REQUEST['act']);\n直接进入作者的github主页\nhttps://github.com/llllllllllllllllllllllll?tab=repositories\n\n\n\n\n\n\n粗略看了下，源码属于www.mescake.com，加上之前看到@author 21Cake Dev Team于是就联系了一下21cake的工作人员，询问mes与21cake的联系，得知mes是他们在北京的团队\nm_alladmin    m-cmsold  m_db_old       m_paltformadmin  m_webadminm_call        m_crm     m_html_static  m_security       mweb_mainm_callsearch  m_db      mordercms      mstatic_main     mweb_touch\n信息量略大，就用github自带的检索功能，搜索 pass， pwd ，admin，mes等关键字\nhttps://github.com/llllllllllllllllllllllll/mweb_main/search?utf8=%E2%9C%93&q=pass\n\n$db_name   = \"shop\";7\t8\t// database username9\t$db_user   = \"yucheng\";10\t11\t// database password12\t$db_pass   = \"yucheng\";13\t14\t// table prefix\n\n\n\nhttps://github.com/llllllllllllllllllllllll/mordercms/search?utf8=%E2%9C%93&q=pass\n\n5\t$my_db_name_write   = \"mescake\";6\t$my_db_user_write   = \"root\";7\t$my_db_pass_write   = \"\";8\t9\t10\t//读操作服务器配置11\t$my_db_host_read   = \"210.51.166.149\";…\t11\t$my_db_host_read   = \"210.51.166.149\";12\t$my_db_name_read   = \"mescake\";13\t$my_db_user_read   = \"root\";14\t$my_db_pass_read   = \"\";\n\nhttps://github.com/llllllllllllllllllllllll/m_crm/search?p=2&q=admin&type=Code&utf8=%E2%9C%93\n\n1\t﻿-- phpMyAdmin SQL Dump2\t-- version 4.0.103\t-- http://www.phpmyadmin.net4\t--5\t-- 主机: localhost6\t-- 生成日期: 2014-04-25 09:43:43…\t553\tINSERT INTO `userinfo` (`id`, `userid`, `userpwd`, `username`, `xingb`, `usertel`, `usermail`, `addtime`, `modytime`, `departmentid`, `parentid`, `departmentname`, `fuze`) VALUES554\t(00000000001, 'admin', 'admin', '管理员', '女', '1890115550', '', '', '', 0, -1, 'admin', '1');\n\n\n\nhttps://github.com/llllllllllllllllllllllll/m_db/search?utf8=%E2%9C%93&q=admin\n\ncreate table mes_admin(2\t id int(4) not null primary key auto_increment,3\t username char(20) not null,…\t8\tINSERT INTO mes_admin (username,password,type) values ('mescakewebadmin','0B6763665B8AB1786EA78780E590ABFB',1);\n\nhttps://github.com/llllllllllllllllllllllll/m_paltformadmin/search?utf8=%E2%9C%93&q=admin\n\ncreate table platform_admin_user(2\t id int(5) not null primary key auto_increment,3\t realname char(20) not null,…\t6\t password varchar(256) not null,7\t extension varchar(256)8\t);9\t10\tinsert into platform_admin_user (realname,email,type,password) values ('renyuan','renyuan','0','123456');\n\nhttps://github.com/llllllllllllllllllllllll/m_paltformadmin/blob/5b74ba982b859c2128894cadf8a3f93cddbadb1c/config.json\n\n[{  \"name\":\"new_admin\",  \"chnName\":\"新版商品管理平台\",  \"url\":\"http://www.mescake.com/mescakewebadmin/index.php\",  \"icon\":\"iconfont-edit.png\"},{  \"name\":\"old_admin\",  \"chnName\":\"旧版商品管理平台\",  \"url\":\"http://mes.admin.n.mescake.com/newcake/admin/privilege.php?act=login\",  \"icon\":\"iconfont-edit.png\"},{  \"name\":\"order_search\",  \"chnName\":\"订单追踪系统(打单，配送)\",  \"url\":\"http://mes.admin.n.mescake.com/ordercms/privilege.php?act=login\",  \"icon\":\"iconfont-tijiaodingdan.png\"},{  \"name\":\"cash_card\",  \"chnName\":\"礼金卡生成\",  \"url\":\"http://mes.admin.n.mescake.com/czk2/privilege.php?act=login\",  \"icon\":\"iconfont-huiyuanqia.png\"},{  \"name\":\"email\",  \"chnName\":\"邮件系统\",  \"url\":\"http://ym.163.com/\",  \"icon\":\"iconfont-youjian.png\"},{  \"name\":\"call\",  \"chnName\":\"客服系统\",  \"url\":\"http://mescall.n.mescake.com/order_all.php?agentuid=1000\",  \"icon\":\"iconfont-edit.png\"},{  \"name\":\"bug\",  \"chnName\":\"BUG管理系统\",  \"url\":\"http://easybug.net/Member/Login?url=http%3a%2f%2feasybug.net%2fProject%2fProjectInfo%2f10557\",  \"icon\":\"iconfont-bug.png\"},{  \"name\":\"wiki\",  \"chnName\":\"wiki系统\",  \"url\":\"http://wiki.n.mescake.com\",  \"icon\":\"iconfont-bug.png\"},{  \"name\":\"sms\",  \"chnName\":\"短信平台\",  \"url\":\"http://sdk.kuai-xin.com:8888/logins.html\",  \"icon\":\"iconfont-faduanxin.png\"},{  \"name\":\"crm\",  \"chnName\":\"客户关系管理系统\",  \"url\":\"http://crm.n.mescake.com:8081/\",  \"icon\":\"iconfont-crm.png\"}]\n其中客服系统可以直接访问\nhttp://mescall.n.mescake.com/order_all.php?agentuid=1\n\n\n下面的好像涉及到加密算法\nhttps://github.com/llllllllllllllllllllllll/m_security\n就贴这些吧   漏洞证明：  如上   修复方案：  删除吧， 提高安全意识   版权声明：转载请注明来源 orange@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}