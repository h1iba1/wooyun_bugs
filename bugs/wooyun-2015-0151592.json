{"id": 72165, "wybug_id": "wooyun-2015-0151592", "wybug_title": "我为母校做贡献之看我如何获取全校的水电费情况", "wybug_corp": "中山大学", "wybug_author": "zhchbin", "wybug_date": "2015-11-03 22:23", "wybug_open_date": "2015-12-20 20:44", "wybug_type": "敏感信息泄露", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-20：\t细节向公众公开  简要描述： 吾校矗立 蔚为国光虽然我毕业了，但还是很很关心母校的，朋友圈看到学校的水电自助缴费平台上线了，所以就来为母校做点贡献吧。 详细说明：  首先是众多接口存在未授权访问，如：\nhttp://ewpay.sysu.edu.cn/ewpay/business/charge.do?action=getCustomerByRoomListhttp://ewpay.sysu.edu.cn/ewpay/business/charge.do?action=getCustomerAccountJournalhttp://ewpay.sysu.edu.cn/ewpay/business/charge.do?action=waitPayOrderList\n利用上述接口，我们可以做些什么事情呢？第一：先获取一下各个宿舍，各个单位的情况。getCustomerByRoomList这个接口可以用来查询每个宿舍的信息，不过，我们中大那么多校区（今天还说要在深圳建第五个！），那么多宿舍，一个个查太麻烦了，好在这个系统的外包商犯错了。利用上面提到的接口，使用以下的参数进行post请求，即可获取全校的情况：\n\n参数fieldValue指定%，这里的SQL语句用了like进行查询，没处理好（也有可能是%号被过滤变成空字符串的情况）。你也可以选择把这个参数置为空进行查询，就能查出所有数据。图中取100条数据作为验证。第二：从上面那个接口，就可以得到所有的宿舍的：CUST_GUID，接下来就是另外一个接口getCustomerAccountJournal查询该宿舍的详情了，一样是未登录的情况下即可以查到。\n\n第三：接口waitPayOrderList可以通过netid查到历史订单详情，也是存在未授权登录即可访问，由于系统上刚上线，所以没有数据。但我觉得提醒一下外包商的开发确认一下吧。这个接口可以拿来干嘛呢？通过netid就可以精准定位每个学生所在的宿舍。\n\n   漏洞证明：  上面已经证明了。   修复方案：  1. 哦，不在学校里的IP网就不要人家访问了，外面的世界很危险。我有VPN可以登录回去2. 修复好上面提到的问题，检查应该还存在的问题3. 我想问问这个系统开发用了多少，能不能请我来   版权声明：转载请注明来源 zhchbin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-11-05 20:43 厂商回复： 感谢校友提醒，我们马上处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-11-04 00:12 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  我也想为母校做贡献    \n     2015-11-04 07:54 |    \t\t路人毛 \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:18        | 呵呵)\t\t \n  我为母校提交了，乌云不给过    \n     2015-11-04 09:07 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:7        | 每日必关注乌云)\t\t \n  看来在广东的不少啊！那谁，那谁，还有那个谁，对吧？    \n     2015-11-04 12:47 |    \t\t0hey_boy0 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:19        | balaba~)\t\t \n  @夏殇 感觉有风险哇    \n     2015-11-04 19:06 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  @0hey_boy0 确实有风险，分分钟让你回去复读    \n     2015-11-04 22:23 |    \t\tzhchbin \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:13        | 要走得再远一些！)\t\t \n  @夏殇 哈哈，很多工作的人都想回去学校读书呢！@大师兄 莫非你就是大师兄！@路人毛，我只能说：感谢审核大大@xsser 通过了！其实好奇怪为什么这个这么水的漏洞有10+个关注。    \n     2015-11-05 16:41 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  @zhchbin 关注你的都是校友    \n     2015-11-05 21:20 |    \t\t王小二丶 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 趁年轻，努力拚。)\t\t \n  哈哈 像你这样说 我是不是也去写个母校渗透啊！！！    \n     2015-11-05 23:06 |    \t\t慢慢 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:201        | 低调求发展)\t\t \n  一大波校园正在接近中……    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}