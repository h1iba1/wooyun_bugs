{"id": 71006, "wybug_id": "wooyun-2015-0142016", "wybug_title": "浙江大学某站存在横向越权（敏感信息泄露，可查看/修改任意用户信息）", "wybug_corp": "CCERT教育网应急响应组", "wybug_author": "roomy", "wybug_date": "2015-09-23 10:12", "wybug_open_date": "2015-09-28 10:14", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "越权操作", "未授权访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 今天交学费。。。好贵。。。交钱需要登录，遍历其他人交钱不需要登录。。。原来以为只能看到这些数据结果不只是订单信息暴露。。。测试环境为IE8。。。还可以直接获取/修改别人的任何数据。。。好羞耻，自己学校的。。。想想还是发上来了。。。 详细说明：  \nhttp://**.**.**.**/payment/\n到这里交学费。。。输入账号密码进去之后交学费。。。\n\n交学费的链接为：(可直接复制在浏览器打开。。。)http://**.**.**.**/payment/pay/payment_selBank.action?billinfo.billno=181406&billdate=2015-09-18%2016:35:58&billinfo.billamt=20000.0&type=&cancollection=F&cansaving=false&feeitemdefords=262&ords=201509&isbankrole=CCB,CFCA,CPAY&jfbFlag=false&usage=%25E7%25AC%25AC%25E4%25BA%258C%25E5%25AD%25A6%25E5%25B9%25B4%25E5%25AD%25A6%25E8%25B4%25B9-201509然而直接遍历billinfo.billno就可以查看到其他人交钱的链接。。。（链接不完全。。。我在补充里面添加吧。。。）如:\nhttp://**.**.**.**/payment/pay/payment_selBank.action?billinfo.billno=181410&billdate=2015-09-18%2016:35:58&billinfo.billamt=20000.0&type=&cancollection=F&cansaving=false&feeitemdefords=262&ords=201509&isbankrole=CCB,CFCA,CPAY&jfbFlag=false&usage=%25E7%25AC%25AC%25E4%25BA%258C%25E5%25AD%25A6%25E5%25B9%25B4%25E5%25AD%25A6%25E8%25B4%25B9-201509\n\nhttp://**.**.**.**/payment/pay/payment_selBank.action?billinfo.billno=181409&billdate=2015-09-18%2016:35:58&billinfo.billamt=20000.0&type=&cancollection=F&cansaving=false&feeitemdefords=262&ords=201509&isbankrole=CCB,CFCA,CPAY&jfbFlag=false&usage=%25E7%25AC%25AC%25E4%25BA%258C%25E5%25AD%25A6%25E5%25B9%25B4%25E5%25AD%25A6%25E8%25B4%25B9-201509\n到了这里。。。我打开我的IE8。。。首先在在其中输入：\nhttp://**.**.**.**/payment/pay/payment.jsp\n这个时候界面会跳转到这里：\nhttp://**.**.**.**/payment/login.jsp\n\n\n然而，我们把刚才的链接：http://**.**.**.**/payment/pay/payment_selBank.action?billinfo.billno=181406&billdate=2015-09-18%2016:35:58&billinfo.billamt=20000.0&type=&cancollection=F&cansaving=false&feeitemdefords=262&ords=201509&isbankrole=CCB,CFCA,CPAY&jfbFlag=false&usage=%25E7%25AC%25AC%25E4%25BA%258C%25E5%25AD%25A6%25E5%25B9%25B4%25E5%25AD%25A6%25E8%25B4%25B9-201509先复制到刚才的浏览器中。。。\n\n得到上面的。。。接着我们打开刚才会跳转的链接。。。在浏览器中输入：（不要关闭刚才的页面，新开一个tab）\nhttp://**.**.**.**/payment/pay/payment.jsp\n然后出现了：\n\n可以改的东西好多。。。\n\n以上。。。   漏洞证明：  随便放上几个我遍历的图吧。。\n\n\n\n\n\n以上   修复方案：  访问交钱链接还会自带cookie。。。做好访问控制。。。   版权声明：转载请注明来源 roomy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-09-28 10:14 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}