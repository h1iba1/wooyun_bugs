{"id": 12310, "wybug_id": "wooyun-2013-025188", "wybug_title": "dedecms变量覆盖漏洞，可重装网站", "wybug_corp": "Dedecms", "wybug_author": "VIP", "wybug_date": "2013-06-05 14:14", "wybug_open_date": "2013-06-10 14:15", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-10：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  dedecms的install/index.php中，有这样一段代码\nforeach(Array('_GET','_POST','_COOKIE') as $_request){    foreach($$_request as $_k => $_v) ${$_k} = RunMagicQuotes($_v);}\n任何传入的变量都会被定义，导致变量覆盖漏洞，可以通过覆盖insLockfile变量，破坏原来程序的逻辑，重装网站。POC：http://127.0.0.1/dede/install/index.php?insLockfile=1   漏洞证明：  直接访问，提示有安装锁。\n\n变量覆盖后，直接进入安装界面\n\n   修复方案：  去掉这段代码，使用其他更安全的方式。   版权声明：转载请注明来源 VIP@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-06-10 14:15 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-05 14:25 |    \t\tLauRen \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 苦逼屌丝一枚。)\t\t \n  沙发，做等公开    \n     2013-06-05 14:35 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  DEDECMS无尽的洞    \n     2013-06-05 14:40 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  小学六年级 必须mark    \n     2013-06-05 15:01 |    \t\t偉哥 \t\t\t( 实习白帽子  |\t\t\t        Rank:67 漏洞数:11        | 哥是没帽子)\t\t \n  小学六年级 必须mark    \n     2013-06-05 15:07 |    \t\t紫藤居士 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:8        | 我是来向大神们学习的)\t\t \n  小学六年级 必须mark     \n     2013-06-05 15:22 |    \t\tSunnyJay \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | 专业打酱油~)\t\t \n  小学六年级 必须mark    \n     2013-06-05 15:31 |    \t\tby_奇奇 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:7        | 2)\t\t \n  小学六年级 必须mark    \n     2013-06-05 16:18 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:125        | 如果大海能够带走我的矮丑...)\t\t \n  - -........ VIP 你是想逆天？    \n     2013-06-05 16:18 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:125        | 如果大海能够带走我的矮丑...)\t\t \n  擦,上错号了- -    \n     2013-06-05 16:20 |    \t\tz7y \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:9        | 关注技术与网络安全)\t\t \n  - -........ VIP 你是想逆天？ 擦,上错号了- -     \n     2013-06-05 16:24 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小胖子 啥号啊    \n     2013-06-05 16:27 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  - -........ VIP 你是想逆天？ 擦,上错号了- -    \n     2013-06-05 16:35 |    \t\t戏子_AINI \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:7        | 我是一只小小小小鸟，想要飞却飞也飞不高。...)\t\t \n  围观小学6年级    \n     2013-06-05 16:38 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:64        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  小学六年级 必须mark    \n     2013-06-05 16:53 |    \t\t偉哥 \t\t\t( 实习白帽子  |\t\t\t        Rank:67 漏洞数:11        | 哥是没帽子)\t\t \n  小学六年级 必须mark    \n     2013-06-05 16:58 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  mark    \n     2013-06-05 17:00 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:245        | 我有个2b女友！)\t\t \n  这个洞不会是那个吧。。。。    \n     2013-06-05 17:02 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @mango 哪个    \n     2013-06-05 17:05 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:245        | 我有个2b女友！)\t\t \n  我看不见你这个。。。所以不能判断。。。。so,应该不是吧，或者我看错了。    \n     2013-06-05 17:07 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @mango 哪个啊    \n     2013-06-05 17:10 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:245        | 我有个2b女友！)\t\t \n  我上次在微博上也看到这个安装漏洞，不知道是不是你这个覆盖的。    \n     2013-06-05 17:18 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:245        | 我有个2b女友！)\t\t \n  @VIP跟你商量个事呗。。。能不能转点乌云币给我，我想买那件乌云衣服可是要30大洋啊～    \n     2013-06-05 17:40 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  这个漏洞，t00ls发过了吧。小学生，不要抄作业哦。。， install 那个    \n     2013-06-05 17:59 |    \t\t1ee \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:14        | 看书中....)\t\t \n  我也好像在几天前就听过重装漏洞了 - -     \n     2013-06-05 18:19 |    \t\tSct7p \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 懂与不懂之间只隔了一层纸，懂的人会觉得很...)\t\t \n  为啥要发出来呢。我都没玩够    \n     2013-06-05 18:40 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @mango 要多少？    \n     2013-06-05 18:41 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @围剿 我没有t00ls帐号啊    \n     2013-06-05 18:56 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:6        )\t\t \n  @VIP 话说你是不是六年级的小学生啊，我很好奇啊    \n     2013-06-05 19:02 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  比起你们猜测，我更愿意相信六年级的小朋友也有代码审计的能力！嘿嘿:D    \n     2013-06-05 19:10 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:47        | 我思故我猥琐，我猥琐故我强大)\t\t \n  小学六年级 必须mark     \n     2013-06-05 19:14 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @xsjswt 赶集网的大牛，必须关注    \n     2013-06-05 21:26 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  @xsjswt 拜超级猥琐大牛，膜拜赶集网云监控，求开源，求share    \n     2013-06-05 21:58 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:245        | 我有个2b女友！)\t\t \n  @VIP  还差17点   谢谢了。~  我真么挺喜欢的。    \n     2013-06-05 23:48 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  - -........ VIP 你是想逆天？ 擦,上错号了- -    \n     2013-06-06 01:03 |    \t\t小鸡鸡 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:4        )\t\t \n  需要数据库帐号密码吗    \n     2013-06-06 09:43 |    \t\tiproute \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 为路由器生，为交换机死，为Ping通奋斗一辈...)\t\t \n  小学六年级 必须mark     \n     2013-06-06 13:30 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:30        | Hacked by @ringzero 我錯了)\t\t \n  小学六年级 必须mark    \n     2013-06-07 02:39 |    \t\tFuzz \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        )\t\t \n  我抓的包 不会出现cookie值，我改了post值也没用。求解！    \n     2013-06-07 13:46 |    \t\tleehenwu \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:24        | 撸·啊·撸)\t\t \n  小学六年级 必须mark    \n     2013-06-08 09:49 |    \t\t点点 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:38        | 准备申请سمَـَّوُوُحخ ̷̴̐...)\t\t \n  小学六年级 必须mark    \n     2013-06-10 22:59 |    \t\tRootUser \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:5        | null)\t\t \n  你确定这个是你自己挖的？我好像前段时间就看到过了    \n     2013-10-21 16:57 |    \t\tHuc-Unis \t\t\t( 普通白帽子  |\t\t\t        Rank:1055 漏洞数:61        | 诶，现在通用奖励越来越低了；离买保时捷卡...)\t\t \n  我居然发现dedecms的全部都是忽略，以后谁还敢给他提交漏洞？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}