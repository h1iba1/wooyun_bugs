{"id": 24252, "wybug_id": "wooyun-2010-0142", "wybug_title": "19楼持久型XSS、敏感信息泄露", "wybug_corp": "十九楼", "wybug_author": "blue", "wybug_date": "2010-07-30 21:30", "wybug_open_date": "2010-08-30 00:00", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "持久型", "使用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-07-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2010-08-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2010-08-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2010-08-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2010-09-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2010-08-30：\t细节向公众公开  简要描述： XSS位置较明显,一些地方会泄露sql数据信息 详细说明：  个人空间DIY时可以使用expression,IE6、IE7测试通过   漏洞证明：  http://blog.19lou.com/?18202069   (请用IE6,IE7查看)http://blog.19lou.com/user/69/diy_css_18202069.cache.css在DIY中，sql处理过慢时，会出现类似以下：Time: 2010-7-30 7:28pmScript: /spacecp.phpSQL: UPDATE [Table]userspacefields SET layout='1', showside='0', choiceblockmain='newblog,mythread,bbsthread,newimage,newgoods,newfile,newlink', choiceblockleft='photo,action,calendar,archive,search,visitor,track,friend,guestbook,comment,favorite,userlink,music,information,rss', choiceblockright='', diy='a:28:{s:9:\"bodycolor\";s:0:\"\";s:9:\"bodyimage\";s:0:\"\";s:10:\"bodyrepeat\";s:0:\"\";s:14:\"bodyattachment\";s:0:\"\";s:9:\"headcolor\";s:0:\"\";s:9:\"headimage\";s:0:\"\";s:13:\"headtextcolor\";s:0:\"\";s:10:\"headrepeat\";s:0:\"\";s:12:\"contentcolor\";s:0:\"\";s:12:\"contentimage\";s:0:\"\";s:13:\"contentrepeat\";s:0:\"\";s:9:\"sidecolor\";s:0:\"\";s:9:\"sideimage\";s:0:\"\";s:10:\"siderepeat\";s:0:\"\";s:15:\"blocktitlecolor\";s:0:\"\";s:15:\"blocktitleimage\";s:0:\"\";s:19:\"blocktitletextcolor\";s:0:\"\";s:16:\"blocktitlerepeat\";s:0:\"\";s:10:\"blockcolor\";s:0:\"\";s:14:\"blocktextcolor\";s:0:\"\";s:10:\"blockimage\";s:0:\"\";s:11:\"blockrepeat\";s:0:\"\";s:9:\"maincolor\";s:20:\"expression(alert(1))\";s:9:\"mainimage\";s:0:\"\";s:10:\"mainrepeat\";s:0:\"\";s:9:\"fontcolor\";s:0:\"\";s:9:\"linkcolor\";s:0:\"\";s:6:\"cursor\";s:0:\"\";}' WHERE uid='18202069'Error: MySQL server has gone awayErrno.: 2006Similar error report has beed dispatched to administrator before.   修复方案：  修改x-space源码，过滤出问题位置.当然cookie重要部分使用了HttpOnly，很不错.   版权声明：转载请注明来源 blue@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2010-08-02 12:54 厂商回复： 已经确认，立即修补 谢谢blue 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}