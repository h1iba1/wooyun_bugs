{"id": 71223, "wybug_id": "wooyun-2015-0154330", "wybug_title": "国网某微信公众号下投票系统存在注入漏洞", "wybug_corp": "国家电网公司", "wybug_author": "路人甲", "wybug_date": "2015-11-20 15:16", "wybug_open_date": "2015-11-22 16:12", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-22：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 国网某微信公众号下投票系统对用户提交的投票数据验证存在漏洞，导致可以伪造IP地址进行投票以及注入漏洞。 详细说明：  微信关注公众号“qcgwwxpt”后，在团聚力菜单下有“青创赛互动投票”网站，该网站IP地址为182.92.161.198。测试后发现该网站限制了投票行为，每个IP地址只能投一张票。通过burp抓包，并在投票提交数据中增加X-Forwarded-For字段，并生成随机IP地址可以进行刷票：\n\n后台判断投票的IP地址为X-Forwarded-For字段内容，在X-Forwarded-For字段后加上'，测试报错，可能存在注入。   漏洞证明：  增加X-Forwarded-For字段后，可以绕过投票系统对IP地址的限制：\n\n构造测试注入用数据包：\n\n用sqlmap进行注入点测试：\n\nsqlmap测试结果：\n\n验证注入点到此为止，没有继续。   修复方案：  网站后台应该采用了类似代码获取用户IP：\n\n因此通过X-Forwarded-For字段可以欺骗IP地址。1、修改后台程序获取用户IP地址的方法，并使用验证码方式进行验证，防止恶意刷票。2、对插入数据库的数据进行过滤验证，防止特殊构造的字段造成注入漏洞。ZZ。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-11-22 16:12 厂商回复： 漏洞无法复现 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}