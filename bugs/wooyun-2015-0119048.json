{"id": 45893, "wybug_id": "wooyun-2015-0119048", "wybug_title": "苏宁APP 苏宁易购拒绝服务打包(非批量纯手工附分析)", "wybug_corp": "江苏苏宁易购电子商务有限公司", "wybug_author": "小手冰凉", "wybug_date": "2015-06-09 15:47", "wybug_open_date": "2015-09-07 16:28", "wybug_type": "拒绝服务", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["拒绝服务"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-07：\t细节向公众公开  简要描述： 苏宁易购拒绝服务打包(非批量纯手工附分析)拒绝服务攻击虽然危害不大，但是经常的“停止响应”会严重影响用户体验 详细说明：  安卓端的拒绝服务一般有几个原因，一个是未验证Intent.getXXOOExtra方法造成的，还有是打破程序执行顺序的页面启动导致某些变亮未初始化，还有就是一些程序测试的接口在发布版本中存在，等等第一处：Activity:com.suning.mobile.paysdk.ui.CashierPrepareActivity测试命令\nadb shell am start -n com.suning.mobile.ebuy/com.suning.mobile.paysdk.ui.CashierPrepareActivity\n这个界面从名字看应该是测试用的，分析代码发现似乎是测试支付的其中发生了如下调用关系\ncom.suning.mobile.paysdk.ui.CashierPrepareActivity.onCreate()com.suning.mobile.paysdk.ui.CashierPrepareActivity.c()com.suning.mobile.paysdk.ui.c.a.a.a()com.suning.mobile.paysdk.ui.c.a.a.b()\n最后的函数b有如下未验证代码导致程序崩溃\n\n第二处：Activity:com.unionpay.upomp.bypay.activity.SplashActivity测试命令\nadb shell am start -n com.suning.mobile.ebuy/com.unionpay.upomp.bypay.activity.SplashActivity\n目测这个界面应该属于第三方SDK，在问题出在初始化布局文件上，应该是引入不完整，缺少布局文件\n\n第三处：receiver:com.suning.mobile.ebuy.appstore.app.ui.PackageReceive测试命令\nadb shell am broadcast -a android.intent.action.PACKAGE_ADDED -c android.intent.category.HOME -n com.suning.mobile.ebuy/.appstore.app.ui.PackageReceive\n这里直接使用了未验证的getDataString方法\n\n第四处：Activity:com.suning.dl.ebuy.dynamicload.SuningDLProxyActivity测试命令\nadb shell am start -n com.suning.mobile.ebuy/com.suning.dl.ebuy.dynamicload.SuningDLProxyActivity\n启动时发生如下调用\ncom.suning.dl.ebuy.dynamicload.SuningDLProxyActivity.onCreate()com.suning.dl.ebuy.dynamicload.internal.DLProxyImpl.onCreate()\n后面这个onCreate中使用了未验证方法，导致程序崩溃\n\n第五处：Activity:com.suning.dl.ebuy.dynamicload.SuningDLProxySingleTaskActivity测试命令\nadb shell am start -n com.suning.mobile.ebuy/com.suning.dl.ebuy.dynamicload.SuningDLProxySingleTaskActivity\n这里问题产生的根源跟上面一样，都是调用了DLProxyImpl.onCreate()这个方法。   漏洞证明：  如上   修复方案：  格外注意 Intent.getXXOOExtra方法怀疑一切，不相信输入，做足检查   版权声明：转载请注明来源 小手冰凉@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-06-09 16:26 厂商回复： 感谢提交，移动客户端拒绝服务漏洞一律按照200元礼品卡计算。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-09 15:48 |    \t\thh2014 \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:11        | 继续)\t\t \n  楼主犀利，学习    \n     2015-08-13 18:39 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:37        | I'm Me_Fortune)\t\t \n  学习。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}