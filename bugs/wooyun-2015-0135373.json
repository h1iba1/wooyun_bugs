{"id": 70175, "wybug_id": "wooyun-2015-0135373", "wybug_title": "南京中小型企业服务平台getshell各种敏感信息泄露", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-08-22 18:53", "wybug_open_date": "2015-10-09 09:04", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-25：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-09-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-09：\t细节向公众公开  简要描述： rt 详细说明：  站点:**.**.**.**:8080/samoton/存在Struts2命令执行验证地址：**.**.**.**:8080/samoton/sys/BSysAttach_downLoadForUEditor.actiongetshell:\n\n   漏洞证明：  整理信息如下：\n# oracle# jdbc:oracle:thin:@<host>:<port>:<SID> # jdbc:oracle:thin:@//<host>:<port>/<service_name> #jdbc.driver=oracle.jdbc.driver.OracleDriver#jdbc.url=jdbc:oracle:thin:@localhost:1521:orcl#jdbc.user=ciss#jdbc.password=1#电子口岸数据库负载均衡#jdbc.url=jdbc:oracle:thin:@(DESCRIPTION=(LOAD_BALANCE=on)(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=**.**.**.**)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=**.**.**.**)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=racdb)))#jdbc.driver=oracle.jdbc.driver.OracleDriver#jdbc.url=jdbc:oracle:thin:@**.**.**.**:1521:samoton#jdbc.user=SAMOTON#jdbc.password=SAMOTON#jdbc.driver=oracle.jdbc.driver.OracleDriver#jdbc.url=jdbc:oracle:thin:@**.**.**.**:1521:orcl#jdbc.user=SAMOTON#jdbc.password=SAMOTONjdbc.driver=oracle.jdbc.driver.OracleDriverjdbc.url=jdbc:oracle:thin:@**.**.**.**:1521:orcl1jdbc.user=SAMOTONjdbc.password=SAMOTON#系统自定义配置文件# 附件存放绝对路径前缀，不填取项目路径 old# 附件存放绝对路径前缀，使用基于SMB/JCIFS协议的共享目录存放附件 new# smb://{domain;}{user}{:password}@{host}/{path}#ATTACH_ABS_PATH = smb://administrator:123444997@**.**.**.**/shipATTACH_ABS_PATH = smb://sumex-dev5;administrator:sumexsoft@**.**.**.**/tship$# 附件存放目录相对目录# ATTACH_REL_PATH = uploadATTACH_REL_PATH = 225upload#镇江老系统附件存放位置ATTACH_REL_PATH_ZJOLD = zjold/files#百度编辑器中上传图片访问地址ATTACH_ABS_PATH_IMAGE = http://**.**.**.**:8000/#公告内容百度编辑器中上传图片地址ATTACH_REL_PATH_IMAGE = 225image# 申报端/审批段系统的标志 申报端：declare,审批端:approval,若配置成all申报用户及审批用户都可登陆LOGIN_ROLE = all# 海事用户及船舶资料接口WEBSERVICE开关，true:打开，false:关闭SWITCH_WEBSERVICE = false#船舶基础资料和海事同步开关，true:打开，false:关闭BASE_INFO_SHIP_SWITCH = false#船舶基础资料和海事同步间隔时间：59 59 23 ? * SUN（每周日晚23：59：59）SHIP_SYNC_TRIGGER_TIME =59 59 23 ? * SUN#电子签章PDF文件临时路径SIGNDLG_PATH_TMP = C:\\\\signdlg# ------------------------------- 单点登录 SSO 配置 Begin------------------------------- # 神码单点登录平台 开关，true:打开，false:关闭。# 如果不使用单点登录，除了将开关设置为false外，还需要修改web.xml，把单点登录配置注释掉。SSO_LOGIN_SWITCH = false# 神码单点登录平台 对应 船舶申报系统 管理员登录名(电子口岸机构)；# 由于船舶申报系统管理员是admin，而在单点登录平台那边不能使用admin这个名称，所以配置了对应名称。# 正式部署时需要配置 单点登录平台 对应 船舶申报系统 管理员登录名(电子口岸机构)。# 使用单点登录平台时，使用以下登录名；不使用单点登录平台时，依然使用admin登录SSO_LOGINUSER_ADMIN = shipadmin# ------------------------------- 单点登录 SSO 配置 End-------------------------------# 电子签章开关，true:打开，false:关闭SIGNDLG_SWITCH = false#用来进行签名验证的江苏CA服务器地址JSCA_SERVER_IP = **.**.**.**#用来进行签名验证的江苏CA服务器端口JSCA_SERVER_PORT = 9188#镇江行政机构代码ZJ_ORG_ADM_CODE = ADM_10001011#镇江国检机构代码ZJ_ORG_CIQ_CODE = CIQ_10001004#南京国检机构代码NJ_ORG_CIQ_CODE = CIQ_10001000<?xml version=\"1.0\" encoding=\"UTF-8\"?><config>    <!--附件存放绝对路径前缀，使用基于SMB/JCIFS协议的共享目录存放附件  -->    <attach_abs_path>smb://administrator:zhongxing@**.**.**.**/samoton/</attach_abs_path>    <!-- 附件存放目录相对目录 -->    <attach_rel_path>upload</attach_rel_path>    <!-- 图片存放目录相对目录 -->    <image_rel_path>images</image_rel_path>    <!--附件发布路径-->    <attach_pub_path>**.**.**.**:8087/</attach_pub_path>    <!-- 文件流缓冲区大小（字节）。 -->    <buffer_size>2097152</buffer_size>    <!-- 百度编辑器附件存在路径 -->    <attach_editor_path>editor_upload</attach_editor_path>    <!--是否给企业用户或服务机构审核通过后自动分配角色 0：否 1：是-->    <is_assign_role>1</is_assign_role>    <!-- 日志记录对象。 -->    <msg_log></msg_log>    <mail_log>MailService</mail_log>    <!-- 发送开关：true/发送、false/不发送。 -->    <mail_switch>false</mail_switch>    <!-- 服务器。 -->    <mail_smtp_host>**.**.**.**</mail_smtp_host>    <!-- 是否需要身份认证。 -->    <mail_smtp_auth>true</mail_smtp_auth>    <!-- 发件人。 -->    <mail_smtp_from>pub</mail_smtp_from>    <!-- 用户。 -->    <mail_smtp_user>pub</mail_smtp_user>    <!-- 密码。 -->    <mail_smtp_password>88888888</mail_smtp_password>    <!-- 消息中心发邮件暂时不能用  -->    <!-- 远程发布地址。 http://**.**.**.**/sms.wsdl -->    <msg_remote_publish_address>http://**.**.**.**/webservice.php?wsdl</msg_remote_publish_address>    <!-- 短信授权码。 -->    <sms_code>STC1311001</sms_code>    <!-- 短信模板ID。 -->    <sms_template>0</sms_template>    <!-- 短信发送开关：true/发送、false/不发送。 -->    <sms_switch>false</sms_switch>    <!-- 邮件授权码。 -->    <mail_code>STC1311001</mail_code>    <!-- 邮件模板ID。 -->    <mail_template>0</mail_template>    <!-- 邮件发送开关：true/发送、false/不发送。 -->    <mail_switch>false</mail_switch></config>\n   修复方案：  尽快修复！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-08-25 09:02 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给江苏分中心,由其后续协调网站管理单位处置.按通用软件漏洞案例评分,rank 10 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}