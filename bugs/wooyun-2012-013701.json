{"id": 15921, "wybug_id": "wooyun-2012-013701", "wybug_title": "腾讯微博存储型XSS漏洞--看我这标题多普通8", "wybug_corp": "腾讯", "wybug_author": "心伤的胖子", "wybug_date": "2012-10-22 10:52", "wybug_open_date": "2012-12-06 10:52", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-10-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-10-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-11-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-11-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-06：\t细节向公众公开  简要描述： 嗯！很普通！ 详细说明：  这次是私信的接口存在漏洞！1、发送私信，内容为:\n<img src=# onerror=alert(1)>\n2、当然直接访问私信是不存在问题的，不过有两个json接口是和私信相关的下面这个接口是返回和多少用户有私信往来，同事返回最后一条私信内容，参数包括返回的记录数等：\nhttp://api.t.qq.com/inbox/pm_list.php<code>下面这个接口是返回和指定用户的私信内容，参数包括返回的记录数等：\nhttp://api.t.qq.com/inbox/pm_conversation.php?account=xxx</code>3、由于上面两个接口返回的Content-Type为：text/html; charset=utf-8，同时返回的私信json数据中 oc 也为私信内容，但是没有经过编码处理，直接输出为：<img src=# onerror=alert(1)>。所以造成漏洞的出现。   漏洞证明：  给某个用户发私信，但是要想办法让他访问接口地址。\n\n\n\n   修复方案：  1、指定Content-Type为application/json; charset=utf-82、对oc的值进行html编码处理   版权声明：转载请注明来源 心伤的胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-10-24 15:25 厂商回复： 非常感谢您的报告。这个问题我们已经确认，正在与业务部门进行沟通制定解决方案。如有任何新的进展我们将会及时同步。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-10-22 10:56 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个序列一定是个很好的学习教程    \n     2012-10-22 10:57 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  顶一个，稍后送上WB    \n     2012-10-22 11:06 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  顶～    \n     2012-10-22 11:22 |    \t\tdyun \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:15        | [code][/code])\t\t \n  @xsser公开了一定要好好学习好习，感觉wooyun机制又可以稍做改善，出系列了也可以考虑评为核心~~~    \n     2012-10-22 11:42 |    \t\t心伤的胖子 \t\t\t( 普通白帽子  |\t\t\t        Rank:308 漏洞数:29        | 因为心伤，所以胖子。)\t\t \n  @dyun 哥之所以发普通是因为哥是普通白帽子    \n     2012-10-22 11:43 |    \t\tMEng \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | 刚接触这个领域、来学习了)\t\t \n  学习学习~~但还要好久才公开= =    \n     2012-10-22 11:46 |    \t\thongygxiang \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:12        | 蛋疼)\t\t \n  前排 学习    \n     2012-10-22 11:56 |    \t\tMEng \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | 刚接触这个领域、来学习了)\t\t \n  提交洞，一般审核要多久？    \n     2012-10-22 12:10 |    \t\tupload \t\t\t( 普通白帽子  |\t\t\t        Rank:251 漏洞数:43        | 此处略--！)\t\t \n  @MEng 可能秒过，可能很久（+∞），总之都有可能    \n     2012-10-22 13:05 |    \t\tMEng \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | 刚接触这个领域、来学习了)\t\t \n  昨天提交了两个洞，求批。。。    \n     2012-10-23 18:15 |    \t\tBlackeagle \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 向WooYun致敬)\t\t \n  @upload 无穷0.0    \n     2012-10-23 21:07 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  腾讯不敢收了么?什么情况    \n     2013-03-02 07:50 |    \t\t苏南同学 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:5        | 苏南同学，就是苏南同学~~~)\t\t \n  这样也能爆漏洞... 学习了，头一次知道 contenttype还能利用的...     \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}