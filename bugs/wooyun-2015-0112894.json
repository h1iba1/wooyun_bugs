{"id": 31862, "wybug_id": "wooyun-2015-0112894", "wybug_title": "麦途网设计不当任意密码重置", "wybug_corp": "www.imaitu.com", "wybug_author": "千斤拨四两", "wybug_date": "2015-05-18 14:24", "wybug_open_date": "2015-07-02 14:26", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-02：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 麦途网设计不当任意密码重置！挖洞不易求给过了吧！ 详细说明：  0x1:自己注册两个用户来测试,于是找了两个手机号，这里我都已经注册号。\n\n接到验证码后填写正确的验证码，之后点击下一步。\n\n接下来我们就来看这里的逻辑错误。填上重置的密码，burp suite截断数据。\n\n修改参数mobile的值既用户的账户名，这里没有验证直接就修改任意用户的密码。\n\n0x2:还有一种方法也可重置。在发送验证码后截断数据包修改数据。\n\n之后就跳到重置密码的页面！\n\n   漏洞证明：  0x3:可直接得到用户的验证码，直接看操作！\n\n点击获取验证码，burp suite截断数据包，在返回数据里可直接得到验证码！\n\n0x4:若是用户绑定了邮箱，通过邮箱也可修改密码，这里我已经绑定好邮箱！\n\n发送邮件，可收到一封修改密码的地址！\n\n可以看到修改密码的地址直接是自己的邮箱地址，所以修改email的值就能修改用户密码了！\n\n我已经用任意一个用户的邮箱测试，通过！   修复方案：  重新构造修改密码的框架，设置session和用户ID绑定使验证码发挥作用！挖了一天的洞写了这么多好辛苦啊，求给良心rank   版权声明：转载请注明来源 千斤拨四两@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}