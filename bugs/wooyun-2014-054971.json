{"id": 3339, "wybug_id": "wooyun-2014-054971", "wybug_title": "74CMS Sql注入漏洞一枚2", "wybug_corp": "74c,s.com", "wybug_author": "′雨。", "wybug_date": "2014-03-30 10:12", "wybug_open_date": "2014-06-25 10:13", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-04：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-25：\t细节向公众公开  简要描述： 过滤不严。 详细说明：  在plus/ajax_user.php中\nelseif($act =='check_usname'){\trequire_once(QISHI_ROOT_PATH.'include/fun_user.php');\t$usname=trim($_POST['usname']);\t\tif (strcasecmp(QISHI_DBCHARSET,\"utf8\")!=0)\t{\t$usname=iconv(\"utf-8\",QISHI_DBCHARSET,$usname);\t}\t$user=get_user_inusername($usname); \tempty($user)?exit(\"true\"):exit(\"false\");}\n也是iconv 转gbk 就可以无视转义了。 然后跟入函数。\nfunction get_user_inusername($username){\tglobal $db;\t$sql = \"select * from \".table('members').\" where username = '{$username}' LIMIT 1\";\t\treturn $db->getone($sql);}\n直接带入了查询当中。  造成了注入。这里没输出。 我就直接把这个var_dump出来 说明还是可以注入的\n$user=get_user_inusername($usname);    var_dump ($user);\n   漏洞证明：  \n\n在这个文件中  类似这个的地方还有几处我就不贴啦。   修复方案：  过滤。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-06-25 10:13 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-30 10:30 |    \t\tlucky \t\t\t( 普通白帽子  |\t\t\t        Rank:409 漏洞数:84        | 三人行必有我师焉########################...)\t\t \n  这么多呀    \n     2014-03-30 11:07 |    \t\t浮生 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:5        | 浮生偷得半日闲)\t\t \n  你这不是自己挖的吧。。。    \n     2014-03-30 11:09 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @浮生 那是谁挖的?    \n     2014-03-30 11:33 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @浮生 You are so 马来西亚、    \n     2014-03-31 17:49 |    \t\t五色花 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | jvav)\t\t \n  支持下    \n     2014-04-04 22:13 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @′  雨。 有很多都是360那公开的    \n     2014-04-04 22:17 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @px1624 不清楚 我看不到360的洞。 看乌云没提  官网还存在 就提乌云咯。    \n     2014-04-04 22:20 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @′  雨。 额，好多漏洞的内容和360那是一模一样的，也不知道是谁复制的谁，不过貌似360那比较早。。。    \n     2014-04-04 22:28 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @px1624 给个地址我看看。3Q    \n     2014-04-05 10:47 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @′  雨。 你不是看不到360么？。。。这是自相矛盾么    \n     2014-04-05 10:56 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @px1624 不清楚 至少我在360搜的74cms 没能看到的。 所以才让你发个地址我看看咯。    \n     2014-04-08 11:04 |    \t\t猪头子 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:35        | 自信的看着队友rm -rf/tar挂服务器)\t\t \n  这个一大堆宽字节注入漏洞    \n     2014-06-25 10:59 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  叼    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}