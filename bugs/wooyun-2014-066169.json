{"id": 53885, "wybug_id": "wooyun-2014-066169", "wybug_title": "某政务服务中心通用任意文件上传漏洞(非登录)", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "sex is not show", "wybug_date": "2014-06-27 13:50", "wybug_open_date": "2014-09-25 13:52", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-25：\t细节向公众公开  简要描述： 任意文件上传，无需登陆。。  据说发政府的会上首页 详细说明：  程序名称：人民政府服务中心开发公司：深圳太极软件有限公司 （http://www.sztaiji.com/）漏洞类型：任意文件上传导致代码执行漏洞文件：bgxz/bgxzAction_uploadSpsxBg.action漏洞参数：upload关键词：百度：inurl:indexAction.action              inurl:zxjbAction_showInfo.action?wid=影响用户：百度收集\n贵州省安顺市人民政府政务服务中心http://zwzx.anshun.gov.cn/bgxz/bgxzAction_executeBack.action兴义市人民政府政务服务中心http://zwzx.gzxy.gov.cn/bgxz/bgxzAction_executeBack.action纳雍县政务服务中心http://nyzw.gov.cn/bgxz/bgxzAction_executeBack.action清镇市人民政府政务服务中心 http://www.qzasc.cn/bgxz/bgxzAction_executeBack.action息烽县人民政府政务服务中心http://zwzx.xifeng.gov.cn/bgxz/bgxzAction_executeBack.action六盘水市人民政府政务服务中心http://61.159.149.200/bgxz/bgxzAction_executeBack.action东港市行政服务中心    http://fuwu.donggang.gov.cn/bgxz/bgxzAction_executeBack.action北票市公共行政服务中心http://211.140.246.58:8080/bgxz/bgxzAction_executeBack.action牡丹江市行政服务中心http://mdjsp.gov.cn/bgxz/bgxzAction_executeBack.action\n利用方式：第一步：上传文件（/bgxz/bgxzAction_executeBack.action）    打开上面写的地址，依次点击 【部分】-->【事项】，在【操作】栏里点击添加，上传.jsp后缀的文件\n\n第二步：找文件地址（/bgxz/bgxzAction_executeIndex.action?menu=4）        打开上面的链接，依次点击 【部分】-->【事项】，在【操作】栏里点击选中下载，右击查看地址。你会看到类似：/download/fileDownload.action?fileName=silicwebshell.jsp&&inputPath=D:\\TJWebSite-Tomcat6\\webapps\\ROOT\\file\\1403661538796-silicwebshell.jsp&&id=201406250958586373这样的链接地址，文件存放路径知道了.. 同事也爆出了web的物理路径**************************************************************************####<b>温馨提示，最好在IE下测试，谷歌不兼容，点了事项后没反应</b>######**************************************************************************   漏洞证明：  实例演示：#####实例1：贵州省安顺市人民政府政务服务中心http://zwzx.anshun.gov.cn/bgxz/bgxzAction_executeBack.action直接上传：\n\n访问：http://zwzx.anshun.gov.cn/bgxz/bgxzAction_executeIndex.action?menu=4\n\n上传后的shell:http://zwzx.anshun.gov.cn//file/1403661538796-silicwebshell.jsp\n\n上传步骤都一样，不全部截图啊..######实例2：兴义市人民政府政务服务中心http://zwzx.gzxy.gov.cn/bgxz/bgxzAction_executeBack.action\n\nshell地址：http://zwzx.gzxy.gov.cn/file/1403665270709-silicwebshell.jsp\n\n######实例3：纳雍县政务服务中心http://nyzw.gov.cn/bgxz/bgxzAction_executeBack.action\n\n访问：http://nyzw.gov.cn/bgxz/bgxzAction_executeIndex.action?menu=4\n\nshell地址：http://nyzw.gov.cn/file/1403655789375-silicwebshell.jsp\n\n####实例4：清镇市人民政府政务服务中心 http://www.qzasc.cn/bgxz/bgxzAction_executeBack.action访问：http://www.qzasc.cn/bgxz/bgxzAction_executeIndex.action?menu=4\n\nshell地址：http://www.qzasc.cn/file/1403667293421-silicwebshell.jsp\n\n######实例5：息烽县人民政府政务服务中心http://61.159.149.200/bgxz/bgxzAction_executeBack.action访问：http://61.159.149.200/bgxz/bgxzAction_executeIndex.action?menu=4\n\nshell地址：http://61.159.149.200/file/1403668175328-silicwebshell.jsp\n\n   修复方案：  过滤上传.. 下载的时候，采用相对路径   版权声明：转载请注明来源 sex is not show@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-07-01 23:16 厂商回复： CNVD确认并复现所述情况，已经先期根据测试结果下发给CNCRT贵州分中心处置本省案例，同时由CNVD按以往处置渠道联系软件生产厂商处置。rank 20+ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-27 16:07 |    \t\tsex is not show  \t\t\t( 普通白帽子  |\t\t\t        Rank:1495 漏洞数:233        | 这家伙真懒！)\t\t \n  @疯狗@xsser 我发了政务的都小厂商（三四个有了吧），别人都走大厂商.. 请轻虐我可好?    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}