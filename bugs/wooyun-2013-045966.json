{"id": 6376, "wybug_id": "wooyun-2013-045966", "wybug_title": "多玩虾哥论坛某程序任意代码写入漏洞", "wybug_corp": "广州多玩", "wybug_author": "猪猪侠", "wybug_date": "2013-12-14 20:20", "wybug_open_date": "2014-01-28 20:20", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "文件写入内容未检查"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-28：\t细节向公众公开  简要描述： 多玩YY虾哥论坛为了方便，使用了某程序进行效率提升，但由于此程序存在任意代码写入漏洞，从而导致威胁放大。 详细说明：  #1 漏洞细节Discuz!某自带程序存在任意代码写入漏洞 WooYun: discuz!某自带工具可拿shell 看到了 @kobin97 大牛提到了一个Discuz!自带工具的漏洞，我想应该就是这个！#2 详细描述Discuz! X 系列产品升级/转换程序，utility\\convert\\include\\global.func.php文件中的save_config_file函数过滤不够严格，导致可写入任意代码至\\data\\config.inc.php文件。#3 漏洞利用http://xiage.yy.com/convert/index.php?a=config&source=d7.2_x1.5\n\n   漏洞证明：  #4 漏洞证明\n[*] 基本信息 [ \tLinux ubuntu 2.6.32-38-server #83-Ubuntu SMP Wed Jan 4 11:26:59 UTC 2012 x86_64(www-data) ][/data/webapps/xiage.yy.com/convert/]$ /sbin/ifconfig -aeth0      Link encap:Ethernet  HWaddr 78:e7:d1:61:26:ee            inet addr:183.61.12.161  Bcast:183.61.12.191  Mask:255.255.255.192          inet6 addr: fe80::7ae7:d1ff:fe61:26ee/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:6754456611 errors:0 dropped:0 overruns:0 frame:0          TX packets:8548195735 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:1194955209657 (1.1 TB)  TX bytes:6318339994356 (6.3 TB)eth1      Link encap:Ethernet  HWaddr 78:e7:d1:61:26:ef            inet addr:10.20.61.161  Bcast:10.20.61.255  Mask:255.255.255.0          inet6 addr: fe80::7ae7:d1ff:fe61:26ef/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:28566049269 errors:0 dropped:715 overruns:715 frame:0          TX packets:19446179184 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:3018930018781 (3.0 TB)  TX bytes:9824272438586 (9.8 TB)lo        Link encap:Local Loopback            inet addr:127.0.0.1  Mask:255.0.0.0          inet6 addr: ::1/128 Scope:Host          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:23164743892 errors:0 dropped:0 overruns:0 frame:0          TX packets:23164743892 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:8436610112215 (8.4 TB)  TX bytes:8436610112215 (8.4 TB)[/data/webapps/xiage.yy.com/convert/]$\n#5 影响25万用户信息\nSELECT COUNT(*) AS CNT FROM `xg_ucenter_members`251760\n   修复方案：  #1 不需要时刻用到的程序或功能，用完即删！   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-12-16 10:43 厂商回复： 感谢对于欢聚时代安全工作的支持，我们会尽快安排修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-14 20:23 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2013-12-14 20:23 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  流弊。    \n     2013-12-14 20:24 |    \t\t小土豆 \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:23        )\t\t \n  前排留名。。。    \n     2013-12-14 20:25 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  总是无理由关注    \n     2013-12-14 22:13 |    \t\talso \t\t\t( 普通白帽子  |\t\t\t        Rank:424 漏洞数:52        | 招渗透/php/前端/ios&android安全，广州地...)\t\t \n  放0DAY了，赶紧围观    \n     2013-12-14 22:20 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  刷分的节奏啊    \n     2013-12-15 16:21 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  真想有个shell玩一下    \n     2013-12-15 17:13 |    \t\tStardustsky \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | ……)\t\t \n  Mark    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}