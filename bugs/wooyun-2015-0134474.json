{"id": 65504, "wybug_id": "wooyun-2015-0134474", "wybug_title": "福建联通某业务设计缺陷漏洞打包", "wybug_corp": "福建联通", "wybug_author": "路人甲", "wybug_date": "2015-08-18 18:28", "wybug_open_date": "2015-10-03 11:12", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-03：\t细节向公众公开  简要描述： 福建联通某站设计缺陷 详细说明：  福建联通流量交易平台http://ll.fj10010.com/fa/faLoginAction!loginOut.action?accountType=0可进行流量的交易、分享和话费购买流量。   漏洞证明：  1、用户名的暴破在登陆界面，尝试用万能密码登录，发现登陆失败后验证码并没有刷新，可以暴破用户。因为登陆失败后返回信息无法确定用户名是否存在，我们可以根据忘记密码处来确定用户名账号。\n\n用户的登陆方式为账户、邮箱和手机号，所以可以花时间来跑联通手机号来获得大量用户名。输入的密码进过简单的变形，我们可以写个脚本将我们的密码字典转化下。\nf = open('C:\\\\Users\\\\xk\\\\Desktop\\\\password.txt','r')q = open('C:\\\\Users\\\\xk\\\\Desktop\\\\pass.txt','w')for a in f.readlines():\ta = a.strip()\tstr1 = ''\tfor i in a:\t\tstr1 = str1+str(hex(ord(i)+3))\t\tv = str1.replace('0x','%5Cu')\tprint(v)\tq.write(v+'\\n')\n我就使用常见的账户名字典来确定用户名，跑出些简单账户，如：admin、test、aaa、lin、wang、zhang、1、123等\n\n可以看到还返回了该账号的accountid，这个accountid很重要，后面会用到。2、查看任意用户资料我们使用一个账号登陆，是没有实名认证的，aaa：123在资料维护处可修改accountid查看对应用户信息。\n\n将accountid替换为1处得到的accountid。\n\n得到该用户的手机号和身份证信息。\n\n3、重置任意用户密码我们可以修改accountid来解除对应账户绑定的邮箱和绑定我们的邮箱来重置密码，手机是否可以并没有测试。\n\n依然使用aaa账户来绑定邮箱，修改要绑定邮箱的accountid。\n\n输入验证码，并在次修改accountid。\n\n邮箱绑定成功，可以重置此账号密码了。\n\n如果账户已经绑定了邮箱，可以修改email将验证发送至我们的邮箱来解除绑定。\n\n   修复方案：  修改代码   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-08-19 11:11 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给福建分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}