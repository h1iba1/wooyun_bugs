{"id": 22116, "wybug_id": "wooyun-2011-02814", "wybug_title": "shopex密码取回处新生成密码可预测漏洞", "wybug_corp": "ShopEx", "wybug_author": "路人甲", "wybug_date": "2011-09-13 16:43", "wybug_open_date": "2011-10-13 16:44", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["密码破解", "设计错误", "逻辑错误", "密码窃取", "数据库密码泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-09-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-09-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-09-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-10-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-10-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-10-13：\t细节向公众公开  简要描述： shopex在找回密码的地方存在一些逻辑设计问题，导致可以预测新生成的密码，可能被用来攻击获取他人密码 详细说明：  相关代码/core/shop/controller/ctl.passport.php中：\nfunction sendPSW(){        $this->begin($this->system->mkUrl('passport','lost'));        $member=&$this->system->loadModel('member/member');        $data=$member->getMemberByUser($_POST['uname']);        if(($data['pw_answer']!=$_POST['pw_answer']) || ($data['email']!=$_POST['email'])){            $this->end(false,__('问题回答错误或当前账户的邮箱填写错误'),$this->system->mkUrl('passport','lost'));        }         if( $data['member_id'] < 1 ){            $this->end(false,__('会员信息错误'),$this->system->mkUrl('passport','lost'));        }         $messenger = &$this->system->loadModel('system/messenger');echo microtime().\"<br/>\";        $passwd = substr(md5(print_r(microtime(),true)),0,6);\n   漏洞证明：  \n\n   修复方案：  完全随机   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2011-09-13 16:52 厂商回复： 感谢提供，我们正在尽力查找！正在处理中！ 最新状态： 2011-09-14：已经修复  ", "replys": "漏洞评价：\n评论\n     2012-04-10 15:48 |    \t\tf19ht \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:15        | 依依不舍的还是你的菊花。)\t\t \n  亲。求exp、。、    \n     2012-09-17 14:56 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  刺总    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}