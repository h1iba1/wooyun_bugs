{"id": 55723, "wybug_id": "wooyun-2014-060109", "wybug_title": "Linux兼容内核网「龙井」SQL注入", "wybug_corp": "浙大网新科技股份有限公司", "wybug_author": "疯狂的dabing", "wybug_date": "2014-05-09 22:52", "wybug_open_date": "2014-06-23 22:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-09：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-06-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 最近WineQQ最近的崩溃频率已经接近我的忍耐极限了，妈蛋果断上官网看看有没有更新了。官网地址：www.longene.org翻了半天没有发现最新的更新，但是发现了一个SQL注入。。。。。 详细说明：  翻到下载页面，看到居然有下载统计，看了下URL的形状:http://www.longene.org/fileDownload.php?id=73&page=download嗯，大概能猜出来下载统计是怎么做的。。。。。然后就测了下。\n\nhttp://www.longene.org/fileDownload.php?id=65%20%20and%201=2%20union%20select%201,2,@@version,4,5,6,7,8,9&page=download嗯，支持回显且支持union查询。\n\n查库。惊奇的发现居然支持单引号。果断load_file。\n\n那么outfile如何？赶紧找物理路径。发现两个奇葩文件：http://www.longene.org/test.php隐隐感觉已经被黑了。。。http://www.longene.org/phpinfo.phpphpinfo文件，非常nice啊。但是天不遂人愿，load_file网站根目录的文件时候没有回显，直接outfile也不行。于是先outfile到/tmp/tmp1，然后再load_file过来，发现是可行的，果然是权限不够啊。\n\n- - 尝试寻找什么可写目录，比如临时目录、upload目录什么的，找了几个没发现，那就到这吧。希望开发组尽快发布稳定的新版本qq。。。。。   漏洞证明：  http://www.longene.org/fileDownload.php?id=65%20%20and%201=2%20union%20select%201,2,@@version,4,5,6,7,8,9&page=download\n\n   修复方案：  sqli的通用防护方法。   版权声明：转载请注明来源 疯狂的dabing@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}