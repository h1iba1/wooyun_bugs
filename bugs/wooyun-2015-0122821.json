{"id": 7468, "wybug_id": "wooyun-2015-0122821", "wybug_title": "苏宁某站任意用户密码重置", "wybug_corp": "江苏苏宁易购电子商务有限公司", "wybug_author": "专业种田", "wybug_date": "2015-06-26 09:23", "wybug_open_date": "2015-08-10 17:36", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-10：\t细节向公众公开  简要描述： 他们说有购物卡，我是小马过河，不自己核实一下是不会相信的。 详细说明：  苏宁招标平台任意用户密码重置漏洞\nhttp://zb.suning.com/bid-web/supRegisterInitForPw.htm\n先来说一下信息泄露，找回密码功能时输入用户名会显示用户的详细邮箱，而且验证码是可以重复使用的，所以可以批量获取用户信息\n\n\n\n\nPOST /bid-web/supRegisterCheckUsandCode.htm?loginUserName=armstrong&authCode=0987 HTTP/1.1Host: zb.suning.com\n   漏洞证明：  找到几个存在的用户，拿armstrong用户做重置密码测试。1.先使用自己的帐号通过邮箱密码找回。\n\n2.填入验证码，到下一步，不操作。3.新开一个找回密码的窗口向armstrong帐号邮箱发送密码找回\n\n4.回到上一步直接修改密码，这时后会提示：验证的帐号与重置密码的帐号不同。修改数据包\nPOST /bid-web/supUpdateForgetPsw.htm?loginPassWord=Aa222222&passGrade=67&loginUserNo=armstrong HTTP/1.1Host: zb.suning.com\n把loginUserNo改为armstrong修改成功\n\n\n\n\n\n   修复方案：  校验，防止session的验证用户名被覆盖   版权声明：转载请注明来源 专业种田@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-06-26 17:34 厂商回复： 感谢提交，稍后送上礼品卡。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-26 09:25 |    \t\tPgHook \t\t\t( 普通白帽子  |\t\t\t        Rank:964 漏洞数:115        | ...........................................)\t\t \n  大牛求带    \n     2015-06-26 09:34 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  @PgHook 我除了暴破还是暴破，哈哈。    \n     2015-06-26 11:14 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  现在换没给。。。    \n     2015-06-26 15:36 |    \t\t1937nick \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:32        | 水能载舟,亦能煮粥。物尽其用,人尽其能。)\t\t \n  我也没收到礼物。。。    \n     2015-06-26 17:46 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  醉了....    \n     2015-06-26 19:22 |    \t\tBusliv \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:16        | to be，and to be)\t\t \n  之前一个苏宁的ssrf，放个假回来就修复了，哎    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}