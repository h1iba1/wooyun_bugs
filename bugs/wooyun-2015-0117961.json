{"id": 48549, "wybug_id": "wooyun-2015-0117961", "wybug_title": "迅雷PC端（迅雷7.x&amp;迅雷极速版）全系列最新版本通杀，可被中间人攻击利用植入木马", "wybug_corp": "迅雷", "wybug_author": "内谁", "wybug_date": "2015-06-03 14:42", "wybug_open_date": "2015-09-01 14:56", "wybug_type": "非授权访问/认证绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["迅雷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-07-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-01：\t细节向公众公开  简要描述： 迅雷PC端（迅雷7.x&迅雷极速版）全系列最新版本通杀（迅雷7.x均可、极速版任意版本均可），组件升级过程可被中间人攻击利用，可使得获得更新程序的PC被植入任意DLL文件，形成DLL劫持，执行任意代码。 详细说明：  迅雷在启动后1分钟左右，会主动向服务器GET一个xml文档，URL如下：http://media.info.client.xunlei.com/ThunderPush/ThunderPush.7.XX.XX.xml(XX为子版本号，不同的版本，URL不同，但结构相同)。回应包为一个标准的xml文档，该文档描述了各组件的名称、更新url地址、版本、以及加载方式等信息。攻击者如果劫持了这个TCP会话，并修改伪造xml文档，插入TCP会话，可以造成任意dll文件被下载的后果，如果根据相对路径来伪造一个zip压缩包的话，则可以形成dll劫持，执行任意代码（修改xml的方法为增加一个节点，name随便，url正确就OK）。迅雷没有对组件更新文件进行任何校验，仅仅通过xml的描述就去更新组件（连hash都没有做！），且迅雷7以后的任意版本均有这个问题，原来的尊享版也有，后来改为极速版仍然没有改正这个问题！   漏洞证明：  正常的数据包请求及回应截图：\n\n劫持并插入会话后截图：\n\n迅雷7劫持后截图：\n\n迅雷极速版劫持后截图：\n\n伪造的zip包截图：\n\n   修复方案：  校验组件文件，修改组件升级方法。   版权声明：转载请注明来源 内谁@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-06-03 14:54 厂商回复： 感谢反馈！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-07 21:31 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:23        | 开发真是日了狗了)\t\t \n  洞主是MITM小号吧    \n     2015-06-13 18:04 |    \t\t内谁 \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:5        | 我是内谁)\t\t \n  @f4ckbaidu 不是，可能同一领域    \n     2015-09-01 15:43 |    \t\twanger \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 每个不曾起舞的日子，都是对生命的辜负！)\t\t \n  膜拜一下~    \n     2015-09-01 17:29 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  @内谁 厉害。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}