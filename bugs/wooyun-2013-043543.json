{"id": 60390, "wybug_id": "wooyun-2013-043543", "wybug_title": "西子湖畔任意用户密码重置漏洞", "wybug_corp": "bbs.xizi.com", "wybug_author": "寂寞的瘦子", "wybug_date": "2013-11-21 14:35", "wybug_open_date": "2014-01-05 14:36", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-05：\t细节向公众公开  简要描述：   还记得那年的西子湖畔吗？娘子………… 详细说明：     找回密码有两种方式，手机和邮箱\n\n。我肯定手机是能通过爆破的目测就是6位数字。俺不想刷了，来个邮箱找回吧。输入密保邮箱之后点击发送。然后去看我们的邮箱。http://my.xizi.com/index.php?r=members/resetpwd&code=VgRXUlBTAQ==&verify=1  nice，我发现code有点可疑啊。于是吧我就猜想了——然后验证，注册了几个小号。同样的也是找回密码发送邮件。然后对比这个所谓的code。我以为会是一样的（有个本地cookies认证）。直接复制url是不能重置密码的。不过最后还是和我的预期有带点差距啊。   VgRXUlBSAA   VgRXUlBTAQ   VgRXUlBSBg   这是3次的code。发现原来这个code是有一定的规律的。应该是每注册一个用户就按照一定有序规律生成一个code。这样当然可以枚举啊，而且很轻松。最后测试发现code的最后一个值是可以随意的！这尼玛…………   不会用软件爆破？手工慢慢吧，因为这是没有时间限制的。提示是一周内有效期，但是再发送一次就好了。每次同一个账户发送的code是一样的\n\n   漏洞证明：    还有那个手机找回密码也是可以通过爆破的，也加强一下吧。   修复方案：     版权声明：转载请注明来源 寂寞的瘦子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-11-21 14:46 厂商回复： 已加强感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}