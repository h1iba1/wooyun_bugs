{"id": 45835, "wybug_id": "wooyun-2015-094035", "wybug_title": "企业应用安全的软肋之唯品会内网漫游（DBA系统、项目管理系统等）", "wybug_corp": "唯品会", "wybug_author": "北京方便面", "wybug_date": "2015-01-26 16:56", "wybug_open_date": "2015-03-12 16:58", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "账户体系控制不严"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-12：\t细节向公众公开  简要描述： 唯品会内网漫游（DBA系统、项目管理系统等）账户体系的控制一直是企业应用安全的一个软肋！ 详细说明：  账户体系的控制一直是企业应用安全的一个软肋！完整的漫游过程是这样的：入口点：https://mail.vipshop.com用15000常见姓名列表及我们收集唯品会的邮箱作为用户名字典由于邮箱web端爆破可能会有验证码的干扰，我们想到了爆破其smtp自己写了个小python脚本，进行简单的弱口令密码组合爆破获得了第一个账号：\n\nmask 区域\n*****p.com :*****\n\n\n\n由于是公共邮箱，里面没有我们想要的敏感信息，这里我们只去获取所有邮箱列表有了邮箱列表，我们也就有了准确的用户名字典。唯品会的邮箱账号构成：名.姓@vipshop.com  ，抓取的邮箱列表里也有其完整姓名的文字，我们对其做如下转化：姓名＝xingming最后我们密码字典可以有如下组合常见弱口令姓名123姓名@123姓名123456姓名@123456Vipshop123姓123姓@123姓123456姓@123456Vipshop@123....等等自己写爆破脚本的好处就在于可以随意按照自己的规则组合密码字典爆破结果如下：\n\n\nmask 区域\n\n*****: yuqi********** : jujia**********: plc**********kd.com.cn**********om : yucong**********shop.com :**********com.cn : z**********hop.com :**********shop.com **********.com : V**********vipshop.co**********pshop.com **********shop.com :********** : li@123456**********p.com : p**********shop.com :**********shop.com :**********shop.com :*****\n\n\n\n\n登陆各个邮箱进行查找及收集信息找到了vpn地址：https://vpn-gz.vip.com/por/login_psw.csp就用这个账号登陆试试[Y]:rone.li@vipshop.com : li@123456  项目经理\n\nmask 区域\n*****密码：*****\n\n\n\n至此轻松进入内网   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n外网的：\n\n有收集到的信息 同样可以在内网爆破等一次的信息收集 之后再进内网或者其他系统就会变得很容易   修复方案：  邮箱内发现邮件：公共邮箱弱口令整改通知对存在弱口令的邮箱进行了通知，信息安全人员的策略是好的，可其他同事不够配合呀！   版权声明：转载请注明来源 北京方便面@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-01-26 17:47 厂商回复： 感谢您对唯品会信息安全的支持，非常感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-26 16:58 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  对于这种企业来说123456、admin这种弱口令真的少见几乎绝迹了，但密码问题确实永不停歇，新的思路会不断出现。    \n     2015-01-26 17:00 |    \t\the1renyagao \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:29        | 是金子总会发光，在还未发光之前，先打磨打...)\t\t \n  弱口令！！！！    \n     2015-01-26 17:01 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  弱口令不见得就一定是123456、admin、888888等，研究用户账号密码组成习惯也会是一个突破口    \n     2015-01-26 17:03 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  死在弱口令上，又是一起悲惨的事故    \n     2015-01-26 17:06 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  弱口令还是永不停息啊    \n     2015-01-26 17:06 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  干的漂亮！    \n     2015-01-26 17:06 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:2738 漏洞数:547        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  弱口令...    \n     2015-01-26 17:07 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  @方便面蜀黍 好厉害的样子    \n     2015-01-26 17:14 |    \t\tbitcoin \t\t\t( 普通白帽子  |\t\t\t        Rank:715 漏洞数:218        | 学习是最好的投资！)\t\t \n  哇哦！好牛！    \n     2015-01-26 17:48 |    \t\t二哥三摆手 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:3        | 淡出江湖，专心学习！)\t\t \n  。。。。    \n     2015-01-26 17:56 |    \t\t帅气小狼狗 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 汪汪汪)\t\t \n  看到洞主，我就感觉好饿好饿。    \n     2015-01-26 17:59 |    \t\t白开水 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:27        | 苍茫的天涯是我的爱~)\t\t \n  洞主的漏洞全是￥￥￥啊      \n     2015-01-26 18:25 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n     2015-01-26 18:54 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @帅气小狼狗 方便面是留给妹子“泡”的    \n     2015-01-26 19:05 |    \t\thack雪花 \t\t\t( 实习白帽子  |\t\t\t        Rank:67 漏洞数:18        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  加打雷有钱？多少    \n     2015-01-26 19:24 |    \t\tT0ne5 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 搬砖真的很累。)\t\t \n  /***..*/    \n     2015-01-26 20:08 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  用弱口令的人都该tjjtds    \n     2015-01-26 21:02 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  这个大概应该叫“个性化弱口令”    \n     2015-01-26 23:47 |    \t\t苏州同程旅游网络科技有限公司(乌云厂商)\t\t \n  被“强弱密码”坑过的表示关注    \n     2015-01-27 10:32 |    \t\tBlackeagle \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 向WooYun致敬)\t\t \n  弱口令 容易猜 强口令 又被类似CSDN保存明文密码的厂商泄漏 从而被拿去分析 设密码好难 谁来教教我    \n     2015-01-27 10:35 |    \t\tpapaver \t\t\t( 普通白帽子  |\t\t\t        Rank:197 漏洞数:35        | 95后，高一学生一枚... 萌萌哒..)\t\t \n  吼吼 .....  此处应该有蜡烛... 默哀....    不怕那啥 就怕那啥....     \n     2015-01-27 15:08 |    \t\t黑吃黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:29        | 倚楼听风雨，淡看江湖路...)\t\t \n  关注    \n     2015-03-12 17:38 |    \t\t盛大网络(乌云厂商)\t\t \n  求漫游 @北京方便面    \n     2015-03-12 17:46 |    \t\t途牛旅游网(乌云厂商)\t\t \n  @盛大网络 同求漫游 @北京方便面    \n     2015-03-12 22:18 |    \t\t小杰哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:155 漏洞数:25        | 逆水行舟，不进则退。)\t\t \n  求字典一份    \n     2015-03-13 11:20 |    \t\t苏州同程旅游网络科技有限公司(乌云厂商)\t\t \n  看起来是深信服的vpn，为什么不做硬件绑定呢，第一次登录vpn绑定硬件，拿到密码也无法拨入。我们上次也是owa密码被爆破过一次  WooYun: 连环撞库可导致同程内网继续沦陷  ，天天扫弱密码，还是漏了。还好有绑定，要不然也被漫游了。后来干脆一刀切关闭了邮箱的外网访问，其实挺不方便的，我本来想试试这家的双步验证的 https://www.cloudentify.com/portal/@盛大网络 @途牛旅游网 我觉得我们三个人什么时候应该聚一聚，哈。    \n     2015-03-13 13:40 |    \t\t帅气小狼狗 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 汪汪汪)\t\t \n  好厉害    \n     2015-04-06 16:47 |    \t\tPgHook \t\t\t( 普通白帽子  |\t\t\t        Rank:964 漏洞数:115        | ...........................................)\t\t \n  今天才看到这个漏洞，我只想说干得漂亮。    \n     2015-05-14 18:50 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  owa的规则 对两个强弱口令进行爆破，一般情况下都会有收获。1qaz@WSX !QAZ2wsx    \n     2015-07-19 17:17 |    \t\tucifer \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:52        | 萌萌哒~)\t\t \n  没有永远安全的系统，只有无处不在的弱口令..    \n     2015-08-02 08:29 |    \t\t暗影侠客 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:5        | xss,inject,ctrf)\t\t \n  大侠，你的python脚本能否公布一下呢！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}