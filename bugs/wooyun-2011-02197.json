{"id": 22620, "wybug_id": "wooyun-2011-02197", "wybug_title": "遨游浏览器远程代码执行漏洞", "wybug_corp": "傲游", "wybug_author": "rayh4c", "wybug_date": "2011-05-31 16:39", "wybug_open_date": "2011-06-30 18:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["路径优先漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-05-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-05-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-06-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-06-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-06-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-06-30：\t细节向公众公开  简要描述： 遨游浏览器2未考虑IE6,7,8场景下库文件的兼容问题，导致一个低级的DLL库加载错误，最终造成一个严重的远程代码执行漏洞 详细说明：  遨游浏览器2会以绝对路径加载ieframe.dll，而IE6环境下无ieframe.dll，将ieframe.dll和HTML网页文件放同一个目录下，遨游浏览器打开网页后将会注入ieframe.dll。   漏洞证明：  测试环境: IE6+xp sp3以UNC路径浏览网页文件,如下图:\n\n   修复方案：  loadlibary加载DLL的路径顺序:1. 程序路径2. system323. system4. windows5. 程序执行路径6. PATH环境变量使用相对路径导入库文件,就有可能导致DLL劫持漏洞.漏洞软件在无库文件的环境,以webdav等方式的UNC路径访问关联文件,漏洞软件走到第5条路径后,将以程序执行路径为标准加载远程的DLL库!免费补习安全知识,最后怎么补,你懂的.   版权声明：转载请注明来源 rayh4c@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2011-05-31 17:34 厂商回复： 感谢指出问题. 正在处理中. 最新状态： 2011-06-01：虚拟机内无法重现.  ", "replys": "漏洞评价：\n评论\n     2011-05-31 16:56 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  顶一个？    \n     2011-06-01 13:18 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  2011-06-01：虚拟机内无法重现.再仔细测测,可以用微软相关工具procmon监控验证.    \n     2011-06-16 15:02 |    \t\t傲游(乌云厂商)\t\t \n  无法重现, 是否能详细说明重现的方法及相关的环境设置.或者给个联系方式.    \n     2011-06-30 20:05 |    \t\tSogili \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:27        )\t\t \n  必须的..    \n     2011-06-30 22:37 |    \t\tpg5yl8 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:12        | 我神马都不会 但我常常被人日 这是为神马呢)\t\t \n  DLL Hijacking Exploit？    \n     2011-07-01 11:46 |    \t\t继续沉默 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 好好学习，天天向上)\t\t \n  学习了    \n     2011-07-02 00:57 |    \t\tlatentwind \t\t\t( 实习白帽子  |\t\t\t        Rank:85 漏洞数:4        | 来 dota 吧?)\t\t \n  茄子牛逼    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}