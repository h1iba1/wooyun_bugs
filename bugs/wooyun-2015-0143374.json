{"id": 84725, "wybug_id": "wooyun-2015-0143374", "wybug_title": "jiasale电商支付系统重要漏洞，卖家损失巨大", "wybug_corp": "北京派道网络科技有限责任公司", "wybug_author": "路人甲", "wybug_date": "2015-10-16 12:38", "wybug_open_date": "2015-11-30 12:40", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-16：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-11-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： jiasale电商购物按钮重大漏洞，支付环节重要漏洞，泄露卖家产品核心信息。不需花钱，购买所有产品。 详细说明：  1、在含有jiasale的网站，购买商品下订单2、记录订单号3、登录任意一个jiasale网站账户，通过特殊链接可以随意的更改价格，完成支付。比如把999元的改成0.01元4、如果是自动发卡的，自动发货的，可以直接受到商品。5、不管是商业用户，还是普通用户，都收到此影响。   漏洞证明：  1、下订单后，记录订单号，比如79982、访问http://shop.jiasale.com/jiasale/order/order_money_modify.jsp?order_id=7998&site_id=2950这里的7998是订单号， 2950是店铺号。这个是我测试的一个。有朋友问怎么得到店铺号，jiasale的店铺号都是4位数字，随便跑一下看返回的信息就知道了。3、然后改成我们需要的价格。\n\n4、修改成功\n\n5、接着上面的支付步骤付款，发现金额变成了我们修改后的金额\n\n6、然后就收到了卡密。为了让大家测试，重现漏洞，我提供一个官方的代码。自行在本地做一个页面测试。\n<div id=\"pdBuy\"  class=\"PDB2C_moban_warp\"><img src=\"http://code.jiasale.com/pdbs/images/init_wait.gif\"></div><script type=\"text/javascript\" id=\"pdB2C_js\"></script><script type=\"text/javascript\" id=\"pdB2C_shell_js\" src=\"http://code.jiasale.com/shoptemplet/36aff1649fad407e91907cd2734dba38/t25101.js\"></script>\n   修复方案：  店家号码更复杂点。组号还是更改验证机制。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}