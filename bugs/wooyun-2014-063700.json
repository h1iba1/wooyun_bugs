{"id": 3663, "wybug_id": "wooyun-2014-063700", "wybug_title": "魅族两处任意文件上传，root权限可内网渗透，邮箱泄露，潜在被拖库", "wybug_corp": "魅族科技", "wybug_author": "lijiejie", "wybug_date": "2014-06-06 00:26", "wybug_open_date": "2014-06-11 00:26", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-11：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 上次给魅族提个漏洞，被直接忽略了。。。 于是乎，我想，不如来个更大力点的，让他们不好意思忽略？ 详细说明：  任意文件上传的地方位于http://developer.meizu.com/common/upload还有上传身份证的地方。Flash本地判断扩展名啊，魅族的大神...一开始测试发现存在任意文件上传，但无法得到上传路径。于是，早上用假身份证去注册了个账号，下午发现你们已经审核通过了。轻松拿到shell，root呐,内网呐:\n\n\n\n找到account@meizu.com，登录了邮箱，限于时间，还没拿得到的密码去爆你们其他的账号：\n\n魅族的密码Salt是:meizu.system.salt.v1=xxx@meizu.com@xxx数据库连接密码被jetty cipher加密了，以前没逆过，但是AES哥是成功逆过的，呵呵两台数据库服务器是192.168.16.XXX。过了会儿发现哥的shell被删了，原来魅族服务器上安装了个叫tencent.security.packagescan的玩意儿。。。  一开始太疏忽了，额。。。就玩到这里吧，都被发现。 无力拖库了。。。  不过我试了下，随时都还能再上传成功，说明只是被扫描器干掉了，管理员指不定还不清楚状况呢？   漏洞证明：     修复方案：  你们更专业   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-06-11 00:26 厂商回复：  最新状态： 2014-06-12：该问题已经引起我们的高度重视，并第一时间进行了处理和对相关文件进行了检查！非常感谢大家对魅族的关注，谢谢！ 2014-06-12：非常抱歉没有第一时间和作者确认漏洞，我们会进一步加强我们的业务安全，同时再次感谢大家对魅族业务的关注！  ", "replys": "漏洞评价：\n评论\n     2014-06-06 02:14 |    \t\tM4ster \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:7        | www.m4ster@gmail.com)\t\t \n  这个牛逼，mark一下。    \n     2014-06-06 06:41 |    \t\tYouYaX(乌云厂商)\t\t \n  魅族用户飘过    \n     2014-06-06 07:08 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  魅族用户飘过    \n     2014-06-06 08:11 |    \t\tHxai11 \t\t\t( 普通白帽子  |\t\t\t        Rank:1137 漏洞数:218        | 于是我们奋力向前游，逆流而上的小舟，不停...)\t\t \n  我去，脱裤    \n     2014-06-06 08:54 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  求忽略...求详情...    \n     2014-06-06 08:59 |    \t\t柠檬菜 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 新手一枚)\t\t \n  魅族在安全方面做的真心不足    \n     2014-06-06 09:05 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  靠..MX3飘过    \n     2014-06-06 09:13 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  魅族用户飘过    \n     2014-06-06 09:34 |    \t\twkc_2014 \t\t\t( 普通白帽子  |\t\t\t        Rank:164 漏洞数:45        | 2014-)\t\t \n  MX3    \n     2014-06-06 10:40 |    \t\t影刺 \t\t\t( 实习白帽子  |\t\t\t        Rank:67 漏洞数:25        | 关注web安全)\t\t \n  魅族用户飘过    \n     2014-06-06 11:21 |    \t\tMartial \t\t\t( 普通白帽子  |\t\t\t        Rank:544 漏洞数:103        )\t\t \n  Iphone飘过    \n     2014-06-06 13:45 |    \t\t鱼化石 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:18        | 介绍不能为空)\t\t \n  厂商已忽略.    \n     2014-06-06 14:34 |    \t\taaaaty \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:28        | 爱情就像，我问服务器whoami，它说root)\t\t \n  魅族用户飘过    \n     2014-06-06 16:47 |    \t\tLucien \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 一个普通用户)\t\t \n  魅族忽略率76%    \n     2014-06-06 17:42 |    \t\t4ck \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | 过来转转)\t\t \n  魅族    \n     2014-06-09 20:24 |    \t\tz7y丶 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 我是z7y的表弟)\t\t \n  魅族用户飘过    \n     2014-06-11 00:45 |    \t\td0u \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 大道至简,衍化至繁)\t\t \n  密码salt有点脑残    \n     2014-06-11 03:58 |    \t\tヤ深蓝T透 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | 菜鸟求发展)\t\t \n  [img src=\"http://logo.99965.org/weixiao.jpg\"/] iphone飘过    \n     2014-06-11 06:51 |    \t\tSiro \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:11        | )    <Freedom />    (Fuck)\t\t \n  忽略……    \n     2014-06-11 08:20 |    \t\tdiguoji \t\t\t( 普通白帽子  |\t\t\t        Rank:323 漏洞数:79        | 中国吉林长春)\t\t \n  这种厂商不多说什么了。洞主辛苦    \n     2014-06-11 08:26 |    \t\tj14n \t\t\t( 普通白帽子  |\t\t\t        Rank:114 漏洞数:23        | 我是一只小小小小鸟....)\t\t \n  忽略。。    \n     2014-06-11 09:20 |    \t\t计算姬 \t\t\t( 普通白帽子  |\t\t\t        Rank:398 漏洞数:90        | 看我看我看我啊)\t\t \n  拖库走起    \n     2014-06-11 09:21 |    \t\tLonely \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:27        | 人生如梦,始终都游不过当局者迷的悲哀。)\t\t \n  洞主提交时  看看厂商  魅族就没确认过 - - 提了也是白提。    \n     2014-06-11 09:30 |    \t\ttenzy \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:21        | Need not to know)\t\t \n  忽略。。    \n     2014-06-11 11:00 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  我靠？这也忽略？尼玛的，我tm用的可是你魅族的东西，乱忽略好不，给力点找人及时看看啊    \n     2014-06-11 11:39 |    \t\t无名 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:9        | 我是一只小菜鸟呀，伊雅伊尔哟。)\t\t \n  还好没用魅族的。。    \n     2014-06-11 11:43 |    \t\t49miner \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 哈喽)\t\t \n  @超威蓝猫 sqlmap提示：Sqlmap.exe: error: missing a mandatory option 该怎么办？    \n     2014-06-11 11:44 |    \t\t49miner \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 哈喽)\t\t \n  @wefgod 请问？    \n     2014-06-11 12:01 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @49miner ？what    \n     2014-06-11 12:48 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  @49miner 缺必要的参数。(您不会用翻译吗？    \n     2014-06-11 13:08 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  @wefgod 擦，我用的也是。。。    \n     2014-06-11 13:10 |    \t\thacker@sina.cn \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:27        | ANONYMOUS)\t\t \n  魅族真TMD弱智    \n     2014-06-11 13:10 |    \t\tcooFool \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 终于通过了。)\t\t \n  忽略。。。    \n     2014-06-11 13:16 |    \t\t49miner \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 哈喽)\t\t \n  @超威蓝猫 谢谢    \n     2014-06-11 13:48 |    \t\tqiaoy \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:16        )\t\t \n  这厂商，没话说    \n     2014-06-11 14:03 |    \t\t迦南 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:11        | 我不是玩黑，我就是认真)\t\t \n  这个忽略的的牛叉了    \n     2014-06-11 16:13 |    \t\thackesc \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:3        | 求各种基友)\t\t \n  我用的MX3    \n     2014-06-11 18:16 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  五天...这是超时忽略了吧    \n     2014-06-11 18:49 |    \t\t云云 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 我就一个马甲还要填信息？)\t\t \n  居然又忽略....    \n     2014-06-12 17:33 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  就魅族的态度，作为MX3用户的我 估计很快就能在网上下载到自己的库子了！    \n     2014-06-12 17:53 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  。。就没看到魅族有确认几个漏洞。。    \n     2014-06-15 00:14 |    \t\t78基佬 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:20        | 不会日站的设计师不是好产品经理)\t\t \n  心疼老大！    \n     2014-09-23 09:50 |    \t\t百晓生 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:14        | 我的时代，我做主)\t\t \n  楼主不知道上传路径，后来是怎么拿到shell的？    \n     2015-06-25 16:43 |    \t\t魅族科技(乌云厂商)\t\t \n  @lijiejie 非常感谢白帽子lijiejie对魅族安全做出的贡献，我司安全部门刚刚成立不久，接管魅族厂商帐号之后，确实觉得之前的漏洞确认和评分不尽人意，特地申请了一批手机，一则感谢白帽子提供漏洞，二则反馈Wooyun社区，届时乌云管理员会联系你提供地址的，再次感谢您对魅族安全的关注。    \n     2015-06-25 17:43 |    \t\tlijiejie  \t\t\t( 核心白帽子 |\t\t\t        Rank:2210 漏洞数:294        | Just for fun.)\t\t \n  @魅族科技  好的，多谢    \n     2015-06-25 22:48 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  哇，申请了MX4 PRO？别是魅蓝哈    \n     2015-06-26 12:27 |    \t\tj14n \t\t\t( 普通白帽子  |\t\t\t        Rank:114 漏洞数:23        | 我是一只小小小小鸟....)\t\t \n  直接mx5吧     \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}