{"id": 86211, "wybug_id": "wooyun-2016-0189913", "wybug_title": "富德保险APP之E动生命存在重置任意用户密码漏洞(以亲戚为案例)", "wybug_corp": "富德保险控股", "wybug_author": "zsmj", "wybug_date": "2016-03-28 12:37", "wybug_open_date": "2016-05-13 10:20", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-13：\t细节向公众公开  简要描述： 亲戚买了该公司的保险（价值30万），下载了客户端，于是乎便有了下文重置任意用户密码。wooyun看了一下厂商漏洞信息，发现之前也爆出过,生命人寿手机客户端E动生命可修改任意用户密码——http://www.wooyun.org/bugs/wooyun-2015-0141335厂商也积极响应并修补了漏洞，今天看我另一个姿势 详细说明：      检测发现E动生命（Android-5.1.4，,截止今天，官方最新版），在找回密码功能中，服务器对客户端的请求数据未进行有效验证，可重置任意用户密码。威胁程度：高漏洞链接地址：https://gw-m.sino-life.com/SL_MAS/mas/appPost.do   漏洞证明：  1、准备两个测试手机号（189和155）注册e动生命会员，点击找回密码，输入189手机号，发现请求和响应数据包中都有userId（尾号831）\n\n使用这个接口，获得155目标用户的userId号（尾号为841），用户ID号有规律可循，便于遍历.\n\n另:利用此接口，使用手机号字典，便可查出手机号有无注册e动生命会员2、回到找回密码功能，输入手机号，获取手机验证码，并提交验证码\n\n3、输入新密码，点击完成并截获修改密码请求数据包\n\n通过url解码可清楚看到请求的数据包如下\n{\"msg\":{\"type\":2,\"param\":{\"otpCode\":\"379155\",\"password\":\"aaaa1111\",\"userId\":\"2016000000000****831\"},\"method\":\"resetUserPasswordV5\",\"version\":25}}\n到此找回密码流程一切正常，我们把拦截的数据包中userId参数值替换成155用户的userId（841），并提交数据包，显示修改成功\n\n4、登录155账号成功\n\n5、同样方法，把我亲戚的密码重置，30多万的保险，为他着急！\n\n6、另外，发现服务器响应的数据包中存在大量的内网IP信息，什么鬼，基本每个响应都会内网IP\n\n   修复方案：  1）\t建议对数据进行签名并在服务器端进行有效校验。2）\t客户端和服务器之间交互的数据包最好先使用复杂的加密算法进行加密再传输   版权声明：转载请注明来源 zsmj@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2016-03-29 10:18 厂商回复： 非常感谢您的报告，我们技术已着手处理该问题，将尽快修复此漏洞！感谢白帽的关注与支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-28 12:37 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:760 漏洞数:148        | raw_input(\"你知道我要输入什么？\"))\t\t \n  会玩！！亲戚都不放过    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}