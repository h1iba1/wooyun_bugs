{"id": 554, "wybug_id": "wooyun-2014-069289", "wybug_title": "某用户量特别大的数字校园系统一处奇葩漏洞直接爆管理员密码", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "魇", "wybug_date": "2014-07-22 15:28", "wybug_open_date": "2014-10-20 15:30", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-30：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-20：\t细节向公众公开  简要描述： 面对开发的机智..此刻我流下了感动的泪水..用户量特别庞大，如果还小厂商.. 详细说明：  提供四个 goole and 百度关键词，这里需要说明的是，我也不清楚到底算是哪个公司开发的，因为系统都一样，百度了一下都有相关信息，这里就需要cncert帮忙判断核实一下了，也可能三家都是同一家公司。\n1.inurl:News/news_list.jsp （以这个居多）2.版权所有：重庆顺章科技有限公司 服务电话：023-651022813.版权所有：上海瑞聪网络科技有限公司 服务电话：021-346112834.技术支持：无锡尚蠡信息科技有限公司\n直接上案例吧（中小学，幼儿园都有）默认登录页面为*/admin\nhttp://www.dctrain.cn/get_pwd.jsp (重庆顺章科技有限公司 官网)http://www.wxsl.net/get_pwd.jsp (无锡尚蠡信息科技有限公司 官网)http://www.rcwl.net/get_pwd.jsp (上海瑞聪网络科技有限公司 官网)http://oa.xndxfz.com/get_pwd.jsphttp://oa.bsyey.com/get_pwd.jsphttp://oa.dhssx.com/get_pwd.jsphttp://oa.bashu.com.cn/get_pwd.jsphttp://www.cqxjwxx.com.cn/get_pwd.jsphttp://ltzx.zhedu.net.cn/get_pwd.jsphttp://www.wxzzyey.com/get_pwd.jsphttp://ww1980.cqjjzx.com/get_pwd.jsphttp://zqzx.mhedu.sh.cn/get_pwd.jsphttp://www.czlcxx.com/get_pwd.jsphttp://mhzx.mhedu.sh.cn/get_pwd.jsphttp://www.cqjjzx.com/get_pwd.jsphttp://www.whjksyxx.com/get_pwd.jsphttp://218.4.82.234/get_pwd.jsphttp://www.thgz.net/get_pwd.jsphttp://www.trxx.fxedu.cn/get_pwd.jsphttp://www.jsgyve.com/get_pwd.jsphttp://www.cqyc.com/get_pwd.jsphttp://jsshrzx.com:8987/get_pwd.jsphttp://ptsunshine.cn/get_pwd.jsphttp://www.nths.cn/get_pwd.jsphttp://www.slyey.cn:89/slyey/get_pwd.jsphttp://www.ysx.net.cn/get_pwd.jsphttp://mqxx.mhedu.sh.cn/get_pwd.jsphttp://58.214.27.195/get_pwd.jsphttp://www.sx-school.net/get_pwd.jsphttp://bj50f.com:8080/get_pwd.jsphttp://222.191.250.185/get_pwd.jsphttp://www.xishan.net/get_pwd.jsphttp://www.zcbgxx.net:81/get_pwd.jsphttp://222.190.122.226:2080/get_pwd.jsphttp://tk.cqbxzx.com/get_pwd.jsphttp://219.153.125.109/get_pwd.jsphttp://www.bndjw.com/get_pwd.jsp等等......\n   漏洞证明：  从我提供的案例中可以看出，出现问题的是找回密码的页面。如：http://www.wxzzyey.com/wxzzyey/get_pwd.jsp 无锡市震泽实验幼儿园\n\n\n\n我们输入要找回的用户名后，会自动发起一次请求，然后回显姓名，但是奇葩的是..看一下这个请求..\n\n密码加密后的MD5直接输入了，解密一下测试。\n\n然后在http://www.wxzzyey.com/admin 输入管理员密码登录的时候,发现管理员在登录状态，那这个就不登录不打草惊蛇了\n\n再示例2个：http://www.slyey.cn:89/slyey/get_pwd.jsp 无锡市胜利幼儿园\n\n输入密码登录后有时候会提示您访问的页面不存在\n\n不过没关系，转到主页访问就可以看到已经以管理员身份登录了\n\n\n\n\n\nhttp://www.thgz.net/webschool/get_pwd.jsp  江苏省太湖高级中学\n\n\n\n\n\n转到主页访问\n\n\n\n   修复方案：  以上详细说明的案例都存在该漏洞，通杀，虽然有些是付费密文，不过MD5基本都能在CMD5查询出还有这就是之前说的..分不清是哪个厂商，百度了一下，连这三个官网都存在该漏洞\n\n\n\n\n\n   版权声明：转载请注明来源 魇@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-07-27 09:58 厂商回复：   最新状态： 2014-07-28：补充一下处置情况，目前只能先行确认，还不能直接确认软件生产厂商。  ", "replys": "漏洞评价：\n评论\n     2014-07-22 15:31 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  @xsser @疯狗 @Finger  无语了 这个用户量这么多还是小厂商？    \n     2014-07-22 15:47 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  审核总算听到我的声音了 ..    \n     2014-07-22 16:04 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  无语了~刷那么多rank也不让我刷一下，我的不管怎么的都是小厂商    \n     2014-07-22 16:30 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  @U神 最近新来了审核小伙伴，审核有差异，据说已经准备制定评估标准了，你有啥好意见可以告诉疯狗    \n     2014-07-22 17:28 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @魇 @疯狗 已证明用户量特别大、漏洞属于危害大的    \n     2014-07-22 17:55 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  你持积极态度哦    \n     2014-07-22 17:56 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  @超威蓝猫 打你哦 这又是什么梗    \n     2014-07-22 18:35 |    \t\t妇科圣手 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 苦逼程序员)\t\t \n  新xx?    \n     2014-07-22 18:35 |    \t\t瓦解° \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:5        | web渗透学习小菜一枚。)\t\t \n  请教各位前辈，厂商给我确认的是13Rank,为什么乌云只给我4Rank呢？    \n     2014-07-22 18:44 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @瓦解°   小厂商无疑    \n     2014-07-22 19:21 |    \t\t瓦解° \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:5        | web渗透学习小菜一枚。)\t\t \n  @′  雨。 国家互联网应急响应中心评的13Rank，是某政府站的，但是乌云就给我4Rank。。    \n     2014-07-22 19:25 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @瓦解°   正常  没上首页的都这样 要淡定    \n     2014-07-22 19:29 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  @瓦解° 乌云分大厂商/小厂商流程，大厂商就是前台可见，厂商给你多少RANK，你就拿多少RANK，小厂商是 高危 4RANK 中危 2RANK 低危 1RANK    \n     2014-07-22 23:14 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  @魇 你吃jj太多    \n     2014-07-23 00:44 |    \t\t瓦解° \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:5        | web渗透学习小菜一枚。)\t\t \n  @魇 谢谢前辈给的讲解~    \n     2014-07-23 08:14 |    \t\t果冻好吃 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:11        | 大学通知书下来那天，我迫不及待的用四百块...)\t\t \n  我似乎看见了很多学校沉浸在痛苦之中！    \n     2014-07-27 21:16 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  @疯狗 找了好几个帖子 终于找到你了   求 私信一个邀请码     \n     2014-10-20 16:55 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:23        | 开发真是日了狗了)\t\t \n  这程序猿可以开除了    \n     2014-10-21 11:29 |    \t\t博丽灵梦 \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:7        | = =cf)\t\t \n  醉了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}