{"id": 84366, "wybug_id": "wooyun-2015-0145033", "wybug_title": "Wifi万能钥匙AppS12345678tore版存在设计缺陷实现无限次数连接运营商热点", "wybug_corp": "WiFi万能钥匙", "wybug_author": "路人甲", "wybug_date": "2015-10-07 10:05", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "低", "wybug_rank_0": "2", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "手机应用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： 使用iOS版wifi万能钥匙的运营商wifi连接功能时会出现多次重复扣除连接次数的问题，并且可使越狱设备无限制连接运营商热点。 详细说明：  1.在已经成功通过运营商热点连接互联网之后再次通过Wifi万能钥匙进行连接会重复扣除连接次数，造成了资源的大量浪费。2.在连接次数只有1的时候，无法连接运营商热点(经过多次确认），具体表现为：点击连接，提醒连接次数不足，而次数已经被减少为0.3.根据对APP网络连接的分析,只要能过阻止     **.**.**.**     **.**.**.**     **.**.**.**这三个域名的连接即可实现次数为0的时候依然可以连接（但不提示成功）。具体方法可以修改hosts文件。   漏洞证明：  \n\nwifi万能钥匙网络连接请求测试：\n\n此时连接次数为0我们连接上CMCC-WEB，执行下方测试代码，再次回到万能钥匙页面，点击连接，\n\n多次尝试得到同一个结果：连接失败这时已经可以访问互联网了，打开浏览器，随便打开一个网页\n\n确认问题存在。   修复方案：  1.优化程序设计，先验证是否已经连接互联网再确认是否需要连接，避免资源浪费。2.更改次数确认方式，次数为1时允许连接。3.随着iOS设备的升级，越狱人数已经减少，不越狱的用户极少能做到上述操作，结合iOSwifi的自动断线的特点，可以尝试更改连接规定，如同一设备连接成功之后一段时间内可以重新连接不扣除次数，VIP当天同一设备无限制连接，按小时折算连接次数等。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-10-08 18:07 厂商回复： 感谢您的关注，已将问题转交至相关团队查证。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}