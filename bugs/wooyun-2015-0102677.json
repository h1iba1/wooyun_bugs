{"id": 36065, "wybug_id": "wooyun-2015-0102677", "wybug_title": "杭州云造科技有限公司某站上传过滤不严导致服务器上所有站点被shell", "wybug_corp": "zhixingche.me", "wybug_author": "路人甲", "wybug_date": "2015-03-24 23:59", "wybug_open_date": "2015-05-09 00:22", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "敏感信息泄露", "默认配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-09：\t细节向公众公开  简要描述： 人家是造智能智行车了云马X1 详细说明：  我记得在云马X1 这个名字公布那天，我就跟Angle说了你们站有漏洞，结果呢………………今天很闲就发一下吧   漏洞证明：  ①==文件过滤验证基本没有，任意文件上传步骤：1)注册账号 test是我注册的2)登陆，设置头像。上传3)第一次上传一个1.html，上传成功，获取图片地址\n\n，获得了一个http://zhixingche.me/upload/img/*******.html的地址\nhttp://zhixingche.me/upload/img/*******.html\n你有见过这么坑的头像上传吗？4)由此，上传1.php，一句话木马。地址：http://zhixingche.me/upload/img/4eb42c72dd3d678e01d515464dfabb07.php  密码: test 5）菜刀连接\n\n谁见过这么坑爹的漏洞………………\n\n②==网站目录权限控制不严，跨站\n\n影响到的网站：\nyunmake.comwww.yunbike.cn\n   修复方案：  ①==参考：1）http://www.freebuf.com/articles/web/54086.html确保抓包改文件后缀不能成功的情况下，可直接用php函数过滤。②==解决方案：目录权限控制好（运维肯定在偷懒）参考：1)http://php.net/manual/zh/ini.sections.php你们的开发一定在睡觉   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-03-25 00:22 厂商回复： 谢谢提醒 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}