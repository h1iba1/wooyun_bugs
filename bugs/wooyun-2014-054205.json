{"id": 4438, "wybug_id": "wooyun-2014-054205", "wybug_title": "腾讯某接口未严格校验访问来源IP，导致ClientKEY访问保护被绕过", "wybug_corp": "腾讯", "wybug_author": "猪猪侠", "wybug_date": "2014-03-21 14:23", "wybug_open_date": "2014-05-05 14:23", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-05：\t细节向公众公开  简要描述： 研究过腾讯客户端安全的人都知道，ClientKEY对于QQ整体的业务系统来说，是一个全局的访问令牌，只要获取到用户的ClientKEY，就能访问所有腾讯旗下的业务系统。腾讯单点登录系统跨域劫持漏洞http://www.wooyun.org/bugs/wooyun-2010-0118腾讯单点登录系统跨域劫持漏洞 Ⅱhttp://www.wooyun.org/bugs/wooyun-2010-0197曾经多个白帽子报道过腾讯单点登陆系统的漏洞，于是腾讯加了一个来源IP验证来减少客户端攻击带来的威胁。腾讯当时的想法可能是：“就算你能搞到我的KEY，不在一个内网，你也影响不到我！”。如今，这个防御措施仅仅因为某个接口的疏忽，就被绕过了！ 详细说明：  # 问题描述clubclient.qq.com 域名下的 /clubclient_goto.php 脚本并未严格校验来源IP，直接允许ClientKEY远程登录。# 利用EXP\nhttp://clubclient.qq.com/clubclient_goto.php?uin=63636&key=2724F259C5FB538000EF24D374D60165452526EA51985EE962D5379B4BF4BD30&sendclick=1&qptag=1&statid=10001903&gotourl=http://qzone.qq.com&tipsid=52684&ADUIN=2533750203&ADSESSION=1356685136&ADTAG=CLIENT.QQ.4855_.0&ADPUBNO=26095\n   漏洞证明：  # 直接远程换个IP登录了别人的QQ空间\n\n   修复方案：  # 每个登录的接口都尽量校验完全吧！   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-03-24 11:14 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-21 14:24 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-03-21 14:26 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-03-21 14:30 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-03-21 14:32 |    \t\tjusker \t\t\t( 实习白帽子  |\t\t\t        Rank:67 漏洞数:11        | xxoo决定未来)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-03-21 14:35 |    \t\tJiuShao \t\t\t( 普通白帽子  |\t\t\t        Rank:405 漏洞数:94        | ╮(╯▽╰)╭锄禾日当午)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-03-21 15:00 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  撸主是黑客~~~我两眼就看出来了！    \n     2014-03-21 15:11 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-03-21 15:24 |    \t\t浪子阿Q \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 我爱我家)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-03-21 15:43 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-03-21 15:54 |    \t\tLineZero \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:7        | 我是来围观的。)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-03-21 15:55 |    \t\tdoosit \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:4        | 木有介绍。)\t\t \n  撸主是黑客~~~我一眼就看出来了    \n     2014-03-21 15:57 |    \t\t封印师 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 我是小彩笔来的。...(｡•ˇ‸ˇ•｡) ...)\t\t \n  撸主是黑客~~~我一眼就看出来了    \n     2014-03-21 15:59 |    \t\t浮生若梦 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:7        | 浮生若梦)\t\t \n  撸主是黑客~~~我一眼就看出来了    \n     2014-03-21 16:11 |    \t\t萧然 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 喜欢一切美丽的东西！)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-03-21 16:15 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-03-21 16:36 |    \t\tHINT \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 一步一步)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-03-21 17:26 |    \t\t路人N \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        )\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-03-21 17:51 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-03-21 17:53 |    \t\tB1acken \t\t\t( 普通白帽子  |\t\t\t        Rank:174 漏洞数:56        | 渣渣)\t\t \n  撸主是黑客~~~我一眼就看出来了！     \n     2014-03-21 18:47 |    \t\tX,D \t\t\t( 普通白帽子  |\t\t\t        Rank:143 漏洞数:8        | X,D)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-03-21 20:47 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  专注破坏队形三十年    \n     2014-03-21 21:47 |    \t\t乌云最帅的淫 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:23        | 不以淫荡惊天下,就以闷骚动世人)\t\t \n  专注破坏队形三十年    \n     2014-03-21 22:00 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  专注破坏队形三十一年    \n     2014-03-21 22:42 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  专注破坏队形三十二年    \n     2014-03-21 22:51 |    \t\t浪子阿Q \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 我爱我家)\t\t \n  专注破坏队形三十三年    \n     2014-03-21 23:00 |    \t\t酱油甲 \t\t\t( 普通白帽子  |\t\t\t        Rank:645 漏洞数:126        | 打个酱油，吃个海蜇~)\t\t \n  专注破坏队形三十四年    \n     2014-03-22 01:47 |    \t\t熊猫 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:33        | panda)\t\t \n  专注破坏队形三十六年^^    \n     2014-03-22 10:11 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  专注破坏队形三十七年    \n     2014-03-22 12:38 |    \t\t马燕羊蝎子 \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:10        | 亲，啥时候请吃马燕羊蝎子。)\t\t \n  你们对企鹅下手好重啊    \n     2014-03-22 13:54 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  你们对企鹅下手好重啊    \n     2014-03-22 19:12 |    \t\t路人5 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:5        | 你们别再问我是谁，你们可以叫我神奇的路人...)\t\t \n  你们对企鹅下手好重啊     \n     2014-03-22 19:31 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  你们对企鹅下手好重啊    \n     2014-03-22 23:21 |    \t\tGrayTrack \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:14        | 灰色轨迹)\t\t \n  mark    \n     2014-03-23 08:40 |    \t\tMr.醉心 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 爱生活，爱音乐，爱美女，更爱波多野结衣)\t\t \n  你们对企鹅下手好重啊    \n     2014-03-23 09:09 |    \t\t银狼_avi \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:13        | 本屌十二岁破处)\t\t \n  你们对企鹅下手好重啊     \n     2014-03-23 09:28 |    \t\ttnt1200 \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:17        | 关注飞机安全....)\t\t \n  队形不要乱，楼下继续    \n     2014-03-23 09:42 |    \t\tSicalpath \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:4        | 做爱做的事 交配交的人)\t\t \n  暴插楼上菊花    \n     2014-03-23 17:09 |    \t\t小火苗 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 我是一只小火苗呀，春风吹又生呀...)\t\t \n  爆破楼上菊花    \n     2014-03-23 22:52 |    \t\t233 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 小孩子看了根本把持不住)\t\t \n  爆搞楼上菊花     \n     2014-03-24 10:22 |    \t\tFakehac \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:1        | 菜鸟刚来，努力挖洞洞。。。)\t\t \n  爆搞楼上菊花    \n     2014-03-24 13:22 |    \t\t东方的肚皮舞 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | 社区变了。)\t\t \n  爆搞楼上菊花    \n     2014-03-24 13:33 |    \t\tフ天天好心情 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | 啦啦啦~好高兴)\t\t \n  爆搞楼下菊花    \n     2014-03-24 15:19 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  爆搞楼下菊花    \n     2014-03-24 15:46 |    \t\tTeeMoo \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | teemoo)\t\t \n  爆搞楼下菊花     \n     2014-03-25 13:47 |    \t\t纷纭 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:8        | 学习者。)\t\t \n  爆搞楼下菊花    \n     2014-03-25 14:41 |    \t\tice \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | inevitable...)\t\t \n  你们对企鹅下手好重啊     \n     2014-03-25 14:55 |    \t\tterrying \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:15        | 雅蠛蝶)\t\t \n  爆搞楼下菊花    \n     2014-04-03 16:16 |    \t\t那些花 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:4        | 怀念那些花，那么美！)\t\t \n  爆搞楼下菊花    \n     2014-04-25 13:44 |    \t\tAnnabelle \t\t\t( 实习白帽子  |\t\t\t        Rank:46 漏洞数:15        | .)\t\t \n  专注破坏队形三十八年~    \n     2014-05-05 15:32 |    \t\t有点小鸡冻 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        )\t\t \n  楼上全是我小JJ    \n     2014-05-05 22:14 |    \t\t4399gdww \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | )\t\t \n  楼上全是我小JJ    \n     2014-05-06 13:18 |    \t\t夜 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 小夜，一个苦逼程序员)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-05-13 14:16 |    \t\t有点小鸡冻 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        )\t\t \n  楼上全是helen    \n     2014-07-25 22:54 |    \t\t1n. \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | ...)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}