{"id": 3636, "wybug_id": "wooyun-2015-0124940", "wybug_title": "517旅行网某站漏洞导致用户资金告急(同时部分订单，用户信息泄露)", "wybug_corp": "517na.com", "wybug_author": "大物期末不能挂", "wybug_date": "2015-07-06 17:29", "wybug_open_date": "2015-08-20 21:52", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-20：\t细节向公众公开  简要描述： 很严重。 详细说明：  在寻找517旅行网IP段时发现很多517网站打开了80,443,8080端口，由此特意检测了OpenSSL漏洞。结果，在某C段发现了一台机器。\n59.151.11.79\n以前也有过监控Openssl的想法，并且尝试过写一个批处理调用ssltest.py,然后前几天就看到zone里的帖子（http://zone.wooyun.org/content/21272），报着实践的心态，就深入了一下。然而并不会写python，于是还是采用手动检测的方法。各位大牛误笑。\n调用ssltest.py的批处理脚本@echo off set /p url=url:echo -------------------------------------------------- echo -------------正在执行心脏出血监控脚本------------- echo -------------------------------------------------- cd C:\\Python26for /l %%d in (1 1 100000) do for /f \"tokens=1-3 delims=- \" %%a in (\"%date%\") do for /f \"tokens=1-4 delims=:.\" %%i in (\"%time%\") do cmd /c \"ping -n 1 -w 1000 1.0.0.1 | ssltest1.py %url% >> C:\\Python26\\heartbleed\\%url%_%%a%%b%%c_%%i%%j%%k%%l.txt| echo 已执行%%d次 \"pause 我的python装在了C:\\Python26目录下，让抓取结果输出到C:\\Python26\\heartbleed\\目录下，以url_日期_时间.txt命令\n抓取了10分钟，然而并没有抓取到可用的账号密码，在抓取的内容中发现了一下url，尝试访问。\n\n\n\n付过款的订单没有什么太大的价值啊，继续寻找，抓取到了一些cookie，于是尝试登陆。\n\n成功登陆\n\n查看了一下，能够接触到很多东西。\n\n这是这个大客户经理可以接触到的用户信息。\n\n可以查询平台报表。\n\n账户余额5000多元。\n\n近期交易记录。查看wooyun历史提交漏洞，对 WooYun: 517某处设计不当从而爆破用户密码影影响多系统各种订单个人敏感信息等（成功账户案例） 中出现的域名一一进行尝试，可以进入很多系统。\n\n\n\n报表系统\n\n\n\n\n\n订单查询系统\n\n客票变更系统为了证明不是偶然泄露cookie或只泄露个人cookie，又抓取了一次数据，再次测试登录。\n\n账户余额2W多。。。最后检测的时候发现，yc.517na.com这个站点也存在Openssl漏洞，经过判断，此域名就对应着上面的ip：59.151.11.79，由于yc.517na.com这个站点是517钱包，所以抓取到的cookie金额都很大。综上所述，会影响到用户的资金安全，同时利用cookie登陆上账户之后，用户手上的订单信息，用户信息也会泄露。同时发现一个小问题，这个站的80端口并没有禁止目录浏览。\n\n   漏洞证明：  \n\n\n\n   修复方案：  1.补丁2.可否考虑httponly？   版权声明：转载请注明来源 大物期末不能挂@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-07-06 21:50 厂商回复： 感谢您对517的关注，已安排修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-06 17:29 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  学以致用：）    \n     2015-07-06 17:31 |    \t\t大物期末不能挂 \t\t\t( 普通白帽子  |\t\t\t        Rank:132 漏洞数:23        | 1.一个学渣，只求每门都不挂2.想把漏洞提...)\t\t \n  秒确认:)    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}