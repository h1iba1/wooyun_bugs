{"id": 2738, "wybug_id": "wooyun-2014-064027", "wybug_title": "永煤集团VPN登录信息泄漏内部系统存在SQL注入", "wybug_corp": "永煤集团", "wybug_author": "RedFree", "wybug_date": "2014-06-08 10:28", "wybug_open_date": "2014-07-23 22:08", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-23：\t细节向公众公开  简要描述： 永煤集团将VPN登录说明文档上传于文库，其他人可以使用VPN访问其内网资源。且其内部系统安全欠佳。 详细说明：  VPN登录地址：http://vpn.ycmd.com.cn/用户名：ymgs 密码：123456\n\n\n\n登录框处Oracle注入：\n\n\n[10:04:22] [INFO] the back-end DBMS is Oracleback-end DBMS: Oracle[10:04:22] [INFO] fetching tables for databas[10:04:22] [INFO] the SQL query used returnsDatabase: GJJXT[202 tables]+------------------------+| CZ_DWXXB               || CZ_DYBGQC              || CZ_DYHJS               || CZ_GRXXB               || F_DXQFTEMP             || F_HKTXB                || F_SJHMDSZB             || F_SMSSEND              || F_SMSUSER              || SYRQ                   || SYS_LOG                || TBILOABELONGBANK       || TBLLOABANK             || TBLLOAINTR             || TBLLOARETMODE          || TEMP_CJKBU_130829      || TEMP_EXCPZBH           || TEMP_INDEXPZ           || TEMP_MHKH130829        || TEMP_NEWIDCARD_0370035 || TEMP_PZBHTH            || TEMP_PZBHTH1           || TEMP_PZBH_130929       || TEMP_PZHZ_130926_01    || TEMP_PZHZ_130926_02    || TEMP_PZHZ_130926_03    || TEMP_PZHZ_130926_04    || TEMP_PZJHZJB_130901    || TEMP_PZJH_130901       || TEMP_PZPX_130903       || TEMP_PZPX_131008       || TEMP_PZTH_130901       || TMENU                  || TMP_IDCARD             || TPERMIT                || TROLE                  || TROLEPERMIT            || TUSERROLE              || V_BBSZB                || V_BZDWB                || V_CWMXZ                || V_DBFSB                || V_DBGSB                || V_DKDBHDYBB            || V_DKDYB                || V_DKFKBHIS             || V_DKFKBTMP             || V_DKHTB                || V_DKHTBH               || V_DKKKBHIS             || V_DKKKBTMP             || V_DKQKB                || V_DKQKYQBFB            || V_DKSJLSB              || V_DKSQB                || V_DKXTCSB              || V_DKYQYBB              || V_DKZJB                || V_DKZLSCB              || V_DKZQYBB              || V_DWXZB                || V_DYSQB                || V_FCXZB                || V_FXLVB                || V_GRDBB                || V_HKMXB                || V_HKMXBAY              || V_HKMXBHIS             || V_HKMXBTEMP            || V_HMD                  || V_HPTMP                || V_JGBBYBB              || V_JGDKQXQKB            || V_JGDKQXQKB3           || V_JGDKYBB              || V_JGKHQKYBB            || V_JGWYJCYBB            || V_JGWYJEBLB            || V_JGWYJEBLB3           || V_JGWYKHBLB            || V_JGWYKHBLB3           || V_JGZLJCYBB            || V_JGZLJCYBB5           || V_JZJFSQB              || V_JZPZB                || V_JZPZBTEMP            || V_JZPZLSB              || V_KFSBANB              || V_KKHPBHIS             || V_KKHPBTMP             || V_KMB                  || V_KMJB                 || V_KMLB                 || V_KMYEB                || V_KZB                  || V_LBSQB                || V_LPXXB                || V_OTHER_KKHPDATA       || V_PZZB                 || V_QHTSJHDB             || V_QSTMP                || V_SQDKYBB1             || V_TQHKYYB              || V_XGMXB                || V_XYJBB                || V_YHDKQXQKB            || V_YHDKQXQKB3           || V_YHDKYBB              || V_YHHKQKYBB            || V_YHRJB                || V_YHRJZ                || V_YHWYJCYBB            || V_YHWYJEBLB            || V_YHWYJEBLB3           || V_YHWYKHBLB            || V_YHWYKHBLB3           || V_YHYJB                || V_YHZLJCYBB            || V_YHZLJCYBB5           || V_YQMXB                || V_ZBZLB                || V_ZCFZB                || V_ZFGJJTJBX            || V_ZFGJJYBB             || V_ZFGJJZJBBB           || V_ZHKSYEB              || V_ZHSL                 || V_ZHYBB                || V_ZPZLB                || V_ZQHDMXB              || V_ZQQYB                || V_ZYSZB                || V_ZZSYB                || V_ZZSYFPB              || YZ_CJDB                || YZ_CSB                 || YZ_CZY                 || YZ_DWGRJJBFB           || YZ_DWJCYSB             || YZ_DWJXB               || YZ_DWMXB               || YZ_DWQKB               || YZ_DWQKBCHANGE         || YZ_DWXZB               || YZ_DWYEQKB             || YZ_FKDWZHB             || YZ_FSFSB               || YZ_GLB                 || YZ_GRBJMXB             || YZ_GRJXB               || YZ_GRJZB               || YZ_GRLSJS              || YZ_GRMXB               || YZ_GRMXBAY             || YZ_GRQKB               || YZ_GRQKBCHANGE         || YZ_GRXXBGB             || YZ_GZB                 || YZ_GZQKTJB_YB          || YZ_HISDWGRJJBFB        || YZ_HISDWJXB            || YZ_HISDWMXB            || YZ_HISGRJXB            || YZ_HISGRMXB            || YZ_HISGZB              || YZ_HISJZB              || YZ_HISJZD              || YZ_HISJZHB             || YZ_HISZQMXB            || YZ_HYB                 || YZ_JCYBB               || YZ_JSB                 || YZ_JSTZ                || YZ_JZB                 || YZ_JZBHTEMP            || YZ_JZD                 || YZ_JZFSB               || YZ_JZHB                || YZ_KMB                 || YZ_LLBDB               || YZ_NDJXB               || YZ_QU                  || YZ_RJDHZB              || YZ_RJDMXB              || YZ_RJDYWMXB            || YZ_TODAYJZB            || YZ_TODAYJZD            || YZ_WDB                 || YZ_XTB                 || YZ_YEYBB               || YZ_YTLXB               || YZ_ZJB                 || YZ_ZQBANB              || YZ_ZQDB                || YZ_ZQGFLXB             || YZ_ZQMXB               || YZ_ZQYBB               || YZ_ZQYYB               || YZ_ZQZGLBB             || YZ_ZTDYB               || YZ_ZXB                 || YZ_ZYQKB               |+------------------------+\n\n[10:05:50] [INFO] the back-end DBMS is Oracleback-end DBMS: Oracle[10:05:50] [INFO] testing if current user is DBAcurrent user is DBA:    True\n\n\n   漏洞证明：  \n\n\n\n\n\n   修复方案：  VPN登录信息修改下，不要再侧漏了。   版权声明：转载请注明来源 RedFree@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2014-06-12 16:17 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给河南分中心处置。按多个漏洞进行评分，rank 14 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-08 10:50 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  多么2b的案例啊....    \n     2014-06-12 16:37 |    \t\t含泪的微笑 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 求学习 求交流)\t\t \n  好吧 我承认我就在这挖煤    \n     2014-07-24 10:12 |    \t\t小明 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 主研web渗透，脚本漏洞分析，安全审计)\t\t \n  @RedFree 为什么楼主的sqlmap可以显示中文，楼主是怎么配置的啊？求解答。^-^    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}