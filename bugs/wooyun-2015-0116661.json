{"id": 1292, "wybug_id": "wooyun-2015-0116661", "wybug_title": "金山毒霸的一个逻辑漏可绕过主防", "wybug_corp": "金山毒霸", "wybug_author": "反病毒工程师", "wybug_date": "2015-05-28 17:26", "wybug_open_date": "2015-08-26 19:16", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["消息机制漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-31：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-07-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-26：\t细节向公众公开  简要描述： 对某些消息处理不当,与程序保护逻辑互斥.两种情况两种效果:1主程序及主动防御退出.2程序托盘区不退出,主程序调用失效,主防不退出. 详细说明：  发送WM_QUIT消息给窗口名为\"金山毒霸\"的窗口.后果是:1打开金山毒霸主界面的情况下.获得WM_QUIT消息.A金山毒霸失去响应.B金山毒霸完全退出.C其主动防御彻底失效.用户可以运行非法程序.\n\n2没有打开金山毒霸主界面的情况下(最小化).获得WM_QUIT消息.A用户右键查杀病毒失效.B金山托盘区图标不退出的前提下,无法通过托盘区打开主界面.C用户无法通过重新启动金山毒霸打开其界面进行查杀.   漏洞证明：  可能原因:未对消息\"WM_QUIT\"合理处理.导致金山毒霸接收到该消息后开始退出,但是其保护机制在退出的某个阶段阻止了这个过程.致使:既不能退出,又不能恢复原来正常运行状态.例如:它的防止进程重复启动的进制已经退出了.如下图:\n\n   修复方案：  相信金山反病毒团队能够对这个漏洞提出非常优秀的解决方案.因为对毒霸的机制不是很了解.所以就不献丑了.   版权声明：转载请注明来源 反病毒工程师@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2015-05-28 19:14 厂商回复： 收到，非常感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-03 09:44 |    \t\t无名 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:9        | 我是一只小菜鸟呀，伊雅伊尔哟。)\t\t \n  这个6    \n     2015-08-26 22:02 |    \t\thuoji \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:9        | 目标是当个农民)\t\t \n  WM_QUIT-我恨我实践机会少！    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}