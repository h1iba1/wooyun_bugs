{"id": 1959, "wybug_id": "wooyun-2014-061680", "wybug_title": "用友协作办公平台严重信息泄露（包括管理员账号、系统配置信息）", "wybug_corp": "用友软件", "wybug_author": "xfkxfk", "wybug_date": "2014-05-21 11:39", "wybug_open_date": "2014-08-19 11:40", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-19：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 看最近路人甲玩用友玩的不亦乐乎，凑个热闹测试了下，问题真的太多了 详细说明：  用友协作办公平台严重信息泄露（包括管理员账号、系统配置信息）案例：google关键字：intitle：FE协作基本上全部搜索结果都存在下列问题0x001 第一处信息泄露：http://oa.bnuz.edu.cn:8080/admin/login/logon.jsp\n\n来看看登陆的源码：\n<% String suser=request.getParameter(\"j_username\");  String spassword=request.getParameter(\"j_password\"); String code=request.getParameter(\"j_validcode\"); String message=\"请输入用户名和密码和验证码！\"; if(suser!=null&&!suser.equals(\"\")&&spassword!=null&&!spassword.equals(\"\")){    String validSys = (String) request.getSession().getAttribute(fe.kaptcha.Constants.KAPTCHA_SESSION_KEY);    if(code==null||code.equals(\"\")||validSys==null||!validSys.equals(code)){       message=\"验证码错误，请重新输入！\";    }else{\t    String propertieFileName=\"user.properties\";\t    String path=application.getRealPath(\"\")+\"/admin/login/\"+propertieFileName;\t    Properties props = new Properties();\t    try{\t      InputStream ips = new BufferedInputStream(new FileInputStream(path));\t      props.load(ips);\t      String user=props.getProperty(\"user\");\t      String password=props.getProperty(\"password\");\t      if(suser.equals(user)&&spassword.equals(password)){\t        session.setAttribute(session.getId(),session.getId());\t        response.sendRedirect(\"/admin/\");\t        return;\t      }else{\t        message=\"用户名或者密码错误！\";\t      }\t    }catch(Exception e){\t       out.print(path+\",配置文件不存在，请检查文件目录！\");\t       return;\t    }    }     } %>\n这里没有通过查询数据库，直接通过文件中信息对比/admin/login/user.properties那么我们来访问一下这个文件：http://oa.bnuz.edu.cn:8080/admin/login/user.properties用户名，明文密码躺在这里：\n\n而且经测试，这些都是一样的账户，都是弱口令。0x002 第二处信息泄露http://oa.bnuz.edu.cn:8080/admin/systemXml/system-bean.xml\n\n   漏洞证明：  见详细说明   修复方案：  控制权限user.properties改为user.properties.jsp等   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2014-05-26 09:22 厂商回复： 1. 关于密码信息泄露问题，前几天也有白帽子反应，这个问题已经修复；2. 关于配置信息泄露问题，我们会尽快安排修复。多谢白帽子！ 最新状态： 2014-05-26：本次发现的漏洞是属于我们在升级系统中已经废弃功能,该功能已经不能做任何对系统的有效操作.所暴露的用户密码及系统配置文件都属于被废弃的对象.并非系统正式环境下的真实信息. 处理方案是清理掉类似因升级遗留的过程文件!感谢您的转发与提醒！  ", "replys": "漏洞评价：\n评论\n     2014-08-19 11:44 |    \t\t番茄师傅 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:59        | http://www.tomatoyu.com/)\t\t \n  感谢您的     转发     与提醒！    \n     2014-08-19 12:20 |    \t\tNimda \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 人的欲望就是一个超级大坑，永远也填不满。...)\t\t \n  感谢您的 转发 与提醒！！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}