{"id": 5725, "wybug_id": "wooyun-2013-044412", "wybug_title": "金山防御微软内核漏洞的版本存在漏洞可被轻松绕过", "wybug_corp": "金山网络", "wybug_author": "zeroday-king", "wybug_date": "2013-11-29 19:12", "wybug_open_date": "2014-02-27 19:13", "wybug_type": "权限提升", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["驱动权限提升"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-27：\t细节向公众公开  简要描述： 微软最新NDProxy驱动内核漏洞（CVE-2013-5065）， 金山毒霸宣布推出可以防御漏洞攻击的最新版本，不过貌似这次跟风有些匆忙，可以被攻击者轻易绕过防御。 详细说明：  仔细分析下NdProxy驱动就知道，可以触发这个漏洞的设备控制码有两个：0x8FFF23C8和0x8FFF23CC，这两个控制码是一模一样的。\n\n但是金山的拦截驱动KisKnl.sys显然只拦截第一个，华丽丽滴无视了第二个测试的驱动版本是KisKnl.sys 28号晚上发布的拦截漏洞最新版（http://bbs.duba.net/forum.php?mod=viewthread&tid=22953419）：\n\n   漏洞证明：  *((DWORD *)((PCHAR)InputBuffer+0x14)) = 0x7030125;   bResult = DeviceIoControl(hDevice, 0x8fff23cc, InputBuffer, 0x400, InputBuffer, 0x80, &junk, 0);和0x8FFF23C8用法一样，使用后BSOD或内核代码执行蓝屏图:\n\n   修复方案：  有能力修复就尽快修吧。   版权声明：转载请注明来源 zeroday-king@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2013-11-29 19:54 厂商回复： 收到，我们将尽快联合业务团队进行确认测试，并推动业务部门进行修复与升级。 最新状态： 2013-12-10：目前最新版本，已经修复。非常感谢  ", "replys": "漏洞评价：\n评论\n     2014-02-28 09:36 |    \t\t小城 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:8        | 低调，才能活的长久)\t\t \n  大牛啊。难道这就是传说中的堆笺溢出    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}