{"id": 54082, "wybug_id": "wooyun-2014-065612", "wybug_title": "svnMaia svn管理系统后台getshell", "wybug_corp": "svnMaia", "wybug_author": "papaver", "wybug_date": "2014-06-20 15:48", "wybug_open_date": "2014-09-18 15:50", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["后台权限提升"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-18：\t细节向公众公开  简要描述： svnmaia svn管理系统是一个使用较多的懒人svn管理系统，系统设计上存在缺陷，导致获取root账号后后台可获取webshell，国内一些企业在用（政企类不清楚）。 详细说明：  https://code.google.com/p/svnmaia/，通杀所有版本。第一个问题:extension/showaccess.php 访问限制缺失，导致可获取当前系统所有用户名等信息。\n\n第二个问题：获取用户名了，当然可以爆破了，登陆验证码缺失，第三个问题：后台getshellroot有权限设置svn的相关配置，config/index.php页面，却没有对写入的内容做验证限制，修改post内容即可修改config/config.php，\n\n\n\n其实怎么弄很多方法，这是第一个方法，下面是第二个方法:在注册的时候，user/reg.php,77行， \texec($htpasswd.' -m -b '. $passwdfile . ' '.$username.' '.$passwd0);而$htpasswd 是从config.php读取的，所以，只要修改config.php里面的htpasswd 值，就可以实现命令执行了。\n\n   漏洞证明：  见详细说明吧，   修复方案：  php获取post就不要使用数组了，   版权声明：转载请注明来源 papaver@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-06-25 14:18 厂商回复： CNVD确认第一个风险点，对于爆破类以及认证前提未进行直接确认，根据所述情况先行确认。暂未能建立与软件开发者的联系渠道，希望开发者能认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-07 11:24 |    \t\tHRay \t\t\t( 普通白帽子  |\t\t\t        Rank:196 漏洞数:28        | 018)\t\t \n  lz6月份挖了好多洞啊    \n     2014-08-07 11:37 |    \t\tpapaver \t\t\t( 普通白帽子  |\t\t\t        Rank:197 漏洞数:35        | 95后，高一学生一枚... 萌萌哒..)\t\t \n  求工作啊 ..      \n     2014-08-07 11:38 |    \t\tpapaver \t\t\t( 普通白帽子  |\t\t\t        Rank:197 漏洞数:35        | 95后，高一学生一枚... 萌萌哒..)\t\t \n  是六月份提得，不是六月份挖的。。。    \n     2014-08-07 14:11 |    \t\tHRay \t\t\t( 普通白帽子  |\t\t\t        Rank:196 漏洞数:28        | 018)\t\t \n  @papaver 又换地方了？    \n     2014-08-07 14:52 |    \t\tpapaver \t\t\t( 普通白帽子  |\t\t\t        Rank:197 漏洞数:35        | 95后，高一学生一枚... 萌萌哒..)\t\t \n  楼上的认识我？？    \n     2014-08-07 18:55 |    \t\tHRay \t\t\t( 普通白帽子  |\t\t\t        Rank:196 漏洞数:28        | 018)\t\t \n  @papaver 回忆一下你年初在哪待了一个礼拜，再想一下有几个做安全的，就大概能猜出我是谁了吧    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}