{"id": 1258, "wybug_id": "wooyun-2014-070654", "wybug_title": "乌云主站XSS（持久xss涉及部分浏览器）", "wybug_corp": "乌云官方", "wybug_author": "mramydnei", "wybug_date": "2014-08-06 21:29", "wybug_open_date": "2014-09-20 21:30", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["黑盒测试技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-20：\t细节向公众公开  简要描述： 如果你审核的时候弹了，就是存储型如果没弹，也不一定是selfXSS。所以先看看详细说明 详细说明：  今天正好交完论文，又有时间了。就来水一洞问题出在，插入视频功能上。任何包含http://*.swf的URL都是被允许的，且该URL最终会输出到下面代码所显示的位置：\n<embed src=\"输出\" type=\"application/x-shockwave-flash\" allowscriptaccess=\"never\" allowfullscreen=\"true\" wmode=\"opaque\" width=\"480\" height=\"370\"></embed>\n故，可以简单构造：\njavascript:alert(document.domain);//http://test.swf\n并将其插入到视频当中。   漏洞证明：  预览时，可以看到：\n\n可以看到弹起来了。由于，此处有对URL进行一定量的判断，根据经验多半是不会再有第二次的过滤了。所以很有可能是存储型XSS。为了进行验证，我在漏洞证明里插了一段弹domain的代码。如果要验证，请使用火狐打开当前页面。\n<video href=\"javascript:alert(document.domain);//http://test.swf\"/>\n－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－－剑总给了个编辑的机会，确认是存储型XSS。加个截图留纪念：\n\n   修复方案：  对URL进行合理判断。   版权声明：转载请注明来源 mramydnei@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-08-06 21:34 厂商回复： 影响firefox和safari 高 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-01 21:08 |    \t\t索马里的海贼 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:24        | http://tieba.baidu.com/f?kw=WOW)\t\t \n  爱慕锅千秋万代一统江湖    \n     2014-08-01 21:14 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  哇    \n     2014-08-01 21:17 |    \t\t天地不仁 以万物为刍狗 \t\t\t( 普通白帽子  |\t\t\t        Rank:977 漏洞数:264        | 天地本不仁 万物为刍狗)\t\t \n  前排     \n     2014-08-01 21:22 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  爱慕锅千秋万代一统江湖    \n     2014-08-01 21:32 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  爱慕锅千秋万代一统江湖 前排上CCTV    \n     2014-08-01 21:33 |    \t\ts3xy \t\t\t( 核心白帽子 |\t\t\t        Rank:832 漏洞数:113        | 相濡以沫，不如相忘于江湖)\t\t \n  前排    \n     2014-08-01 21:34 |    \t\tbey0nd \t\t\t( 普通白帽子  |\t\t\t        Rank:895 漏洞数:142        | 相忘于江湖，不如相濡以沫)\t\t \n  中排    \n     2014-08-01 21:35 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  怎么我印象中，乌云审核洞都是查看txt文本的。。    \n     2014-08-01 21:42 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:15        | Talk is cheap,show me the shell.)\t\t \n  PL    \n     2014-08-01 21:43 |    \t\tHeartOfOcean \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        )\t\t \n  @HackPanda 我也来围观了。    \n     2014-08-01 22:01 |    \t\t随随意意 \t\t\t( 普通白帽子  |\t\t\t        Rank:160 漏洞数:35        | 我对XSS并非真爱(┬＿┬)最近有人冒充该...)\t\t \n  哎    \n     2014-08-01 22:01 |    \t\tnoob \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:18        | 向各位大神学习，向各位大神致敬)\t\t \n  验证码总是错，怎么搞的。。。    \n     2014-08-01 22:03 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  我试试错不错    \n     2014-08-01 22:05 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  弹了    \n     2014-08-01 22:09 |    \t\t番茄师傅 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:59        | http://www.tomatoyu.com/)\t\t \n  可恶的验证码    \n     2014-08-01 22:10 |    \t\tadm1n \t\t\t( 普通白帽子  |\t\t\t        Rank:216 漏洞数:66        | 只是一个渣渣而已。。。)\t\t \n  老师真给力    \n     2014-08-01 22:15 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  爱慕锅千秋万代一统江湖     \n     2014-08-01 22:17 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  wb去哪了?    \n     2014-08-01 22:26 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  上CCTV了@疯狗    \n     2014-08-01 22:49 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  确实是弹了，恩    \n     2014-08-01 23:05 |    \t\tJack.Chalres \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:15        | ..............)\t\t \n  前排.mark    \n     2014-08-01 23:17 |    \t\tC4ndy \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        )\t\t \n  弹窗啦 怎么办    \n     2014-08-01 23:24 |    \t\t小火苗 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 我是一只小火苗呀，春风吹又生呀...)\t\t \n  洞主插审核人员插的爽吗？    \n     2014-08-01 23:42 |    \t\t07@jyhack.com \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:10        | 希望和大家多多交流，多多沟通、)\t\t \n  老师真给力    \n     2014-08-01 23:46 |    \t\tAug0st \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:32        | 看你后面~)\t\t \n  真有啊    \n     2014-08-01 23:48 |    \t\tAug0st \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:32        | 看你后面~)\t\t \n  \"></script><script>alert(22)</script>    \n     2014-08-01 23:59 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  楼上真相了    \n     2014-08-02 00:04 |    \t\t浑水 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 学习)\t\t \n  这个厉害了，    \n     2014-08-02 00:35 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  真弹了    \n     2014-08-02 01:25 |    \t\t浩森 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:6        )\t\t \n  可以转账了    \n     2014-08-02 07:46 |    \t\tLinE \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:13        | Just For Like Hack)\t\t \n  哀木哥威武87    \n     2014-08-02 08:02 |    \t\t糊涂 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:3        | 没的。。。)\t\t \n  厉害    \n     2014-08-02 08:32 |    \t\t腹黑 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:10        | (◦ \"̮ ◦))\t\t \n  火钳留名    \n     2014-08-02 08:46 |    \t\t残废 \t\t\t( 普通白帽子  |\t\t\t        Rank:179 漏洞数:40        | 我是残废，啦啦啦啦)\t\t \n  爱慕锅千秋万代一统江湖     \n     2014-08-02 11:16 |    \t\t帅克笛枫 \t\t\t( 普通白帽子  |\t\t\t        Rank:207 漏洞数:46        | 键盘只为不平而起落，鼠标亦会点到为止！)\t\t \n  管理还敢审核这个bug嘛，一审核，哐当的一声，弹出个框框    \n     2014-08-02 11:19 |    \t\t天鱼 \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:5        | 逝去的梦)\t\t \n  太牛了    \n     2014-08-02 11:31 |    \t\tB1acken \t\t\t( 普通白帽子  |\t\t\t        Rank:174 漏洞数:56        | 渣渣)\t\t \n  在哪里弹    \n     2014-08-02 12:27 |    \t\t好人 \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:6        | 多少人曾爱慕你年轻的容颜)\t\t \n  @B1acken 审核界面    \n     2014-08-02 14:47 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  你咋知道审核页面什么样的。。。    \n     2014-08-02 14:48 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  @M4sk 你猜～！    \n     2014-08-02 14:50 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  @mramydnei 你肯定就是审核的大牛~    \n     2014-08-02 14:51 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  @M4sk 我是逗逼～～    \n     2014-08-02 15:33 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  马克    \n     2014-08-02 15:39 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n  mmmmmmmmmmmmmmmmmmmmmmmmmmmmm老湿    \n     2014-08-02 18:06 |    \t\t番茄师傅 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:59        | http://www.tomatoyu.com/)\t\t \n  小顿泡妹子去了。。。来不及确认。   @疯狗   是吗？    \n     2014-08-02 20:30 |    \t\tdepycode \t\t\t( 普通白帽子  |\t\t\t        Rank:275 漏洞数:44        | 关注网络安全，提高技术！)\t\t \n  围观    \n     2014-08-02 22:57 |    \t\tMurk Emissary \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:14        | 低调做人 低调行事)\t\t \n  这个提交漏洞的到底是何方神圣..    \n     2014-08-03 12:42 |    \t\tz7y丶 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 我是z7y的表弟)\t\t \n  爱慕锅千秋万代一统江湖     \n     2014-08-03 18:43 |    \t\t浅兮 \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:30        )\t\t \n  \"如果你审核的时候弹了，就是存储型如果没弹，也不一定是selfXSS。所以先看看详细说明\"如果弹了，那你就拿到管理cookie了，为所欲为            \n     2014-08-05 08:20 |    \t\t黑吃黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:29        | 倚楼听风雨，淡看江湖路...)\t\t \n  人类已经无法阻止你了    \n     2014-08-06 21:11 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  。。。我被弹了，为什么漏洞被忽略了。。    \n     2014-08-06 21:36 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  前两秒就确认了，哈哈    \n     2014-08-06 21:57 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:61        | 工作需要，暂别一段时间)\t\t \n  围观    \n     2014-08-06 22:29 |    \t\t路人丁丁 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 杂学型大学狗)\t\t \n  嗯？怎么刚刚被公开了（    \n     2014-08-06 22:30 |    \t\t阿萨帝 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:68        | 不发礼物的索要联系方式都是耍流氓。)\t\t \n  把xss插到这个页面哪儿？刚才还弹来。    \n     2014-08-07 00:01 |    \t\tCplusHua \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:33        | 乌云奖金:-1)\t\t \n  当前访问疑似黑客攻击，已被百度云加速拦截。    \n     2014-08-07 00:59 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  其实不只是Safari和Firefox。Opera也可以，不过乌云应该没人用Opera    \n     2014-08-07 08:39 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @mramydnei 低版本的谷歌内核应该也可以，我用最新版的360弹了。。。    \n     2014-08-07 08:42 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @mramydnei @px1624 表示可能限制浏览器了？但是乌云不是用百度云的吗？这。。唉！也懂了。    \n     2014-08-07 08:49 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @泳少 和百度云有毛关系    \n     2014-08-07 08:50 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @px1624 我知道了。。刚发的时候想起了点东西。    \n     2014-08-07 09:54 |    \t\t不知道2017 \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:6        | 专注信息安全领域)\t\t \n  都这么多人留言了？那我也踩一下吧    \n     2014-08-07 10:03 |    \t\t小杨 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:4        | 。)\t\t \n  mark    \n     2014-08-07 11:48 |    \t\tiproute \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 为路由器生，为交换机死，为Ping通奋斗一辈...)\t\t \n  mark    \n     2014-08-07 12:57 |    \t\t78基佬 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:20        | 不会日站的设计师不是好产品经理)\t\t \n  M锅泥豪啊    \n     2014-08-07 13:56 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n     2014-08-07 15:36 |    \t\t安然意境 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:79        | 无论是你的事业还是你的个人，可能走的过程...)\t\t \n  洞主拿到了wooyun管理员的cookie  然后给了20rank[笑:-D]    \n     2014-08-07 16:43 |    \t\t‫‌ \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:14        )\t\t \n  @泳少 哦呵呵。大牛懂了好多的样子    \n     2014-08-08 22:14 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @‫‌     为什么你没有名字？ 68楼的。    \n     2014-08-08 22:25 |    \t\t番茄师傅 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:59        | http://www.tomatoyu.com/)\t\t \n  68楼？？？  你的名字插了XSS执行了？？？？？    \n     2014-09-15 11:56 |    \t\tIT偏执狂 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 禁锢我们的究竟是什么？)\t\t \n  68楼，%E2%80%AB‌ 。    \n     2014-09-15 12:03 |    \t\tB1acken \t\t\t( 普通白帽子  |\t\t\t        Rank:174 漏洞数:56        | 渣渣)\t\t \n  @番茄师傅 @‫‌     \n     2014-09-15 18:24 |    \t\tnoob \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:18        | 向各位大神学习，向各位大神致敬)\t\t \n  @‫‌ 丧心病狂的名字...    \n     2014-09-15 18:45 |    \t\tflying \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 呵呵)\t\t \n  后台是不是泄露了....    \n     2014-09-21 09:25 |    \t\t乌云小生 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | 活该酱油一辈子)\t\t \n  爱慕锅千秋万代一统江湖    \n     2014-09-21 10:26 |    \t\tStardustsky \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | ……)\t\t \n  你连你的衣食父母都要x？    \n     2014-09-22 11:31 |    \t\t8qwe24657913 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:2        | 叫我8q就好……)\t\t \n  屌……    \n     2014-10-08 11:29 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  68楼 /whitehat_detail.php?whitehat=%E2%80%AB%E2%80%8C    \n     2014-10-08 11:33 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @ki11y0u 你怎么找到的？    \n     2014-10-08 11:39 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  @泳少 在DOM面板中查看到的 ：）    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}