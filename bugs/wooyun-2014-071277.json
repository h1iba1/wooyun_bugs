{"id": 52420, "wybug_id": "wooyun-2014-071277", "wybug_title": "深澜软件漏洞SrunDisk注入漏洞三", "wybug_corp": "srun.com", "wybug_author": "xlz0iza1", "wybug_date": "2014-08-06 17:28", "wybug_open_date": "2014-11-01 17:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-11：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-01：\t细节向公众公开  简要描述： RT 详细说明：  文件：\\userinfo.php\ninclude_once(\"kernel/eidolon.class.php\");$eidolon=new Eidolon(\"templets/userinfo.html\");include_once(\"kernel/member.class.php\");$member=new Member();if($res=$member->searchByName($_GET[\"username\"],0,\"\")){\tforeach($res as $v)\t{\t\textract($v,EXTR_OVERWRITE);\t}}$eidolon->parseBlock(\"_main\");$eidolon->showBlock(\"_main\");\n\n$res=$member->searchByName($_GET[\"username\"],0,\"\"))\n传递到searchByName中，然后跟中member.class.php文件中\nfunction searchByName($key,$mo,$order)\t{\t\t\t$where=\"\";\t\t\t\t$where.=($this->role_id>0)?\" AND role_id=\".($this->role_id - 1):\"\";\t\t\t$where.=($this->mg_id>0)? \" AND members.mg_id=\".$this->mg_id:\"\";\t\t\tif($order!=\"member_name\" && $order !=\"member_reg_date\" && $order != \"member_log_date\" && $order != \"role_id\")\t\t\t{\t\t\t\t$order=\"member_id\";\t\t\t}\t\t\tif($key==\"\")\t\t\t{\t\t\t\t$sql= \"SELECT * FROM members LEFT JOIN member_groups ON members.mg_id=member_groups.mg_id WHERE 1=1 \".$where.\" ORDER BY '\".$order.\"' DESC  LIMIT \".$this->getLimit();;\t\t\t}\t\t\t\t\t\telse if($mo==1)\t\t\t{\t\t\t\t\t$sql= \"SELECT * FROM members LEFT JOIN member_groups ON members.mg_id=member_groups.mg_id WHERE member_name LIKE '%\".$key.\"%' \".$where.\" ORDER BY '\".$order.\"' DESC  LIMIT \".$this->getLimit();;\t\t\t}\t\t\telse\t\t\t{\t\t\t\t\t$sql=\"SELECT * FROM members LEFT JOIN member_groups ON members.mg_id=member_groups.mg_id WHERE member_name='\".$key.\"' \".$where.\" ORDER BY '\".$order.\"' DESC  LIMIT \".$this->getLimit();\t\t\t}//echo $sql;\t\t\treturn $this->find($sql);\t}\n\n$sql=\"SELECT * FROM members LEFT JOIN member_groups ON members.mg_id=member_groups.mg_id WHERE member_name='\".$key.\"' \".$where.\" ORDER BY '\".$order.\"' DESC  LIMIT \".$this->getLimit();\n可以看到为经过处理带入到$key函数中直接查询。   漏洞证明：  官网测试站点：http://218.75.75.92/userinfo.php?username=zaizai（注意这里需要登录才能注册）抓包：\nGET /userinfo.php?username=zaizai HTTP/1.1Host: 218.75.75.92Proxy-Connection: keep-aliveCache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8User-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/32.0.1700.102 Safari/537.36Accept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: PHPSESSID=4dec0dc3125003fc97364110a3e142eb\n比较懒啊，直接丢入sqlmap中跑就可以了。\n\n\n\n不继续跑了啊。   修复方案：  过滤，过滤~   版权声明：转载请注明来源 xlz0iza1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-11-01 17:30 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}