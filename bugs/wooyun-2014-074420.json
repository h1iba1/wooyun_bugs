{"id": 51450, "wybug_id": "wooyun-2014-074420", "wybug_title": "辽宁工程技术大学教务处存在多处严重漏洞", "wybug_corp": "CCERT教育网应急响应组", "wybug_author": "路人甲", "wybug_date": "2014-09-01 10:21", "wybug_open_date": "2014-09-06 10:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["上传漏洞", "教务系统", "注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-06：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：   放假准备渗透下教务处，发现教务处存在多处严重漏洞如XSS，SQL注入，Tomcat自身漏洞（版本过低）。最要命的是SQL注入漏洞，他会导致大量信息外泄，甚至可以直接修改成绩。 详细说明：  目前发现两处注入漏洞如下：1.\thttp://60.18.131.131//lntu/aao_52/index.jsp?curformat=d&curid=10498&depfid=5986&depfname=教学研究与质量科&fid=10498（fid参数过滤不严）2.\thttp://60.18.131.131:11180/newacademic/bing/answer/answer.jsp 教务答疑查询功能(POST型)通过sqlmap神器，测试注入点，探测些关键信息。\n\n接下来，查询数据库中有什么表。教务处系统比较大，有300多张表，发现有张叫做DS_USER的表。\n\n自定义SQL语句，查询出大约有8W行数据，就是他了。\n\n  因为我们学号是纯数字组成，我推测管理员或者其他高权限用户应该是字母。接着自定义SQL语句，查询不含0-9字符的用户，查询出60行。\n\n接着就是体力活了……尝试哪个用户权限大……此处省略1000字。。。最后，找到一个叫“ZHANGkb”的用户，登陆后，管理员了。\n\n找到用户管理功能，查询有维护教务公告权限的用户，因为它有上传权限。\n\nOK，接下来以他们的身份登陆。\n\n点击添加，看到了编辑器，上传点。\n\n发现可以上传任何类型的文件，那我要试试。\n\n很显然他是进行了服务器验证，接下来把后缀名改成doc试试。\n\n应该是上传成功了。接下来启动burpsuite神器研究下是怎么回事。直接改包，将doc改成jsp然后发包，返回一个地址。\n\n但是访问改地址提示404，看了不行。接下来试试00截断上传。将Content-Length长度+1，文件名后面加个空格，用16进制编辑器将20改成00\n\n\n\n重新提交，返回出了地址\n\n复制到浏览器\n\n恩，就这样了，没干坏事，谢绝查水表（全程开着vpn+tor我相信你也找不到我）   漏洞证明：  目前发现两处注入漏洞如下：1.\thttp://60.18.131.131//lntu/aao_52/index.jsp?curformat=d&curid=10498&depfid=5986&depfname=教学研究与质量科&fid=10498（fid参数过滤不严）2.\thttp://60.18.131.131:11180/newacademic/bing/answer/answer.jsp 教务答疑查询功能(POST型)注入1验证\n\n\n\n注入2验证查询时提交’ and ‘1’=’2，没有搜索到结果\n\n提交’ or ‘1’=’1，查询到所有结果\n\n   修复方案：    升级Tomcat，修复注入漏洞，加装硬件防火墙……   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-09-06 10:22 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-03 17:57 |    \t\twellsun \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | www.wellsun.com)\t\t \n  欢迎大家加入通杀教务系统漏洞QQ 群： 310068074    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}