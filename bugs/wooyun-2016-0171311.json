{"id": 85005, "wybug_id": "wooyun-2016-0171311", "wybug_title": "辽宁省卫生某系统（涉及海量个人详细信息/附艰难环境下获取数据）", "wybug_corp": "center", "wybug_author": "路人甲", "wybug_date": "2016-01-20 13:36", "wybug_open_date": "2016-03-07 10:49", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-03-07：\t细节向公众公开  简要描述：  详细说明：  **.**.**.**/nhis/index.jsp  存在命令执行，数据涉及到的稍微说下吧，5000W批示信息，近1000W的个人详细信息，就看了前几个表，这不重要，接着来说环境，得到命令执行，已经做了外网映射，可以顺利登录，但是问题来了，系统session验证，JSP,JSPX,替换统统失效，在这卡住了，难道真的拿不了数据吗，想到了，weblogic部署，但是默认的console被删掉了，查找了几个可疑的端口也没找到，这时候，突然想到了，自己添加一个域，不就OK了？利用这个域本地配置war包来读取内网的数据库。成功！   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<name>nhis2015</name>  <jdbc-driver-params>    <url>jdbc:oracle:thin:@(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=**.**.**.**)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=**.**.**.**)(PORT=1521)))(CONNECT_DATA=(SERVICE_NAME=rac)))</url>    <driver-name>oracle.jdbc.OracleDriver</driver-name>    <properties>      <property>        <name>user</name>        <value>nhis2015</value>      </property>    </properties>    <password-encrypted>{AES}vciR+kCUrJPR7w2eH1kStYFUwUlOFWxOZHO4CYoXNeI=</password-encrypted> LNyw!2015**.**.**.**jdbc:oracle:thin:@**.**.**.**:1521/rac\n数据库配置\nQuery#0 : select t.TABLE_NAME,t.NUM_ROWS from user_tables t order by NUM_ROWS descTABLE_NAMEVARCHAR2\tNUM_ROWSNUMBERT_FLOW_AUDITING\t42963285T_IC_PERSON\t4191191T_IC_PUBLICPLACES_HISTORY\t2885828T_IC_PUBLICPLACES\t2289376T_DETECTION\t1171552T_DISCIPLINE_PUNISHED\t1101357T_DISCIPLINE_ILLEGAL\t630905T_DISCIPLINE\t428550T_IC_PUBLIC_COMPTYPE\t265647T_IC_WATER_PROCESS\t199035T_CPHC\t188229T_IC_UNVOUCHER\t169422T_DISCIPLINE_STAFF\t148370T_DISCIPLINE_HISTORY\t131777T_IC_RADIATION_TYPE\t101721T_IC_WATER_SOURCE\t97343T_SUPERVISE_PERSON\t84301T_IC_WATER_CHECKCONTENT\t73855T_IC_MEDICAL_HISTORY\t57356T_IC_MEDICAL\t56884T_IC_DISINFECTANT\t36562T_IC_DISINFECTANT_HISTORY\t27442T_IC_WATER_PROD\t21726T_SUPERVISION_CONT\t20394T_IC_DISINFECTANT_TESTCONTENT\t17400T_FLOW_RECENTLYREPORTED\t16894T_SUPERVISE_ORGAN\t14693T_IC_PERSON_HISTORY\t12901T_IC_DETAILED\t10946T_IC_WATER_HISTORY\t10942T_IC_SCHOOL_HISTORY\t9860T_FLOW_CASEINFORMATION\t8814T_FLOW_PENDINGMATTER\t8014T_IC_RADIATION_HISTORY\t6395T_IC_OCC_SERVICES\t6036T_IC_TABLEWARE\t5462T_IC_WATER\t5333T_IC_SCHOOL\t4827T_DETECTION_SUB\t3378T_IC_RADIATION\t3243T_ORGTW_REL\t2975T_IC_BLOOD_HISTORY\t2657T_IC_OCC_SERVICES_TYPE\t2343T_IC_TABLEWARE_HISTORY\t2312T_QUALITYCONTROL\t1493T_IC_SCHOOL_WATER_TYPE\t1304T_IC_BLOOD\t876T_IC_OCC_SERVICES_HISTORY\t365T_SUPERVISE_ORGAN_HISTORY\t254T_IC_DISINFECTANT_PROD\t139T_IC_INFECTIOUS\t121T_IC_UNVOUCHER_HISTORY\t27T_IC_BIRTH_SERVICE_TYPE\t25T_IC_BIRTH\t14T_IC_BIRTH_LICENSE\t14T_IC_INFECTIOUS_HISTORY\t7T_IC_BIRTH_HISTORY\t2T_DISCIPLINE_PROD\t0T_SUPER_ORG_NO_TWCODE\t0\n数据库结构   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-01-22 10:55 厂商回复： CNVD确认未复现所述情况,已经转由CNCERT下发给辽宁分中心,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}