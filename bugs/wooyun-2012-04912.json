{"id": 20738, "wybug_id": "wooyun-2012-04912", "wybug_title": "中软融兴CMS上传验证漏洞", "wybug_corp": "中软", "wybug_author": "Lee", "wybug_date": "2012-02-29 13:30", "wybug_open_date": "2012-04-14 13:31", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-03-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-03-05：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-04-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-05-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-05-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-04-14：\t细节向公众公开  简要描述：  详细说明：  厂商信息：中软融兴是中软总公司旗下专门从事金融领域软件开发、系统集成、产品代理、技术服务的专业化公司，在行业应用系统开发与服务、自主产品创新研发等方面具有雄厚实力和成熟经验。存在漏洞产品：中软融兴CMS是一套面向金融、政府领域的高端CMS系统，基于j2ee和mysql。漏洞信息：1 模板管理->文件上传->将jspshell修改成图片格式并上传,如shell.jpg->重命名->将图面(jspwebshell)修改名字为shell.jsp。2 中软融兴CMS列目录与后台上传漏洞。由于未对browser.jsp文件中的webapppath参数进行过滤和指定路径，使得攻击者可以修改并构造相对路径来访问磁盘中其他目录并列出文件。http://www.yjrb.com.cn/cms/common/filechooseold/browser.jsp?webapppath=../htdocs/web/&uploadpath=/   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 Lee@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2012-03-02 08:42 厂商回复： CNVD确认目录列举漏洞存在，但文件上传漏洞需要内部用户认证后方可测试，通过图片确认。对于该漏洞，将分两步进行：1、协调生产厂商，确认上传漏洞情况及成因，提供修复补丁；2、同时尝试通报其产品涉及的政府和重要信息系统部门用记。CNVD对该漏洞评分如下：基本得分CVSS：(AV:R/AC:M/Au:R/C:C/A:N/I:P/B:N) score:5.67（中危）技术难度系数：1.0（一般）影响危害系数：1.3（较严重）CNVD综合评分：5.67*1.0*1.3=7.37 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-03-01 12:23 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  某实例站点已经确认，通用性待确认。    \n     2012-03-01 16:12 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  上传文件漏洞由于需要用户认证，暂未能复现。将根据图片协调厂商进行确认，不过一般没有实例证据，厂商可能会很不“友好”的否认。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}