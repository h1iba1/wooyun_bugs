{"id": 20516, "wybug_id": "wooyun-2012-06418", "wybug_title": "非vip也能用世纪佳缘的一个vip功能", "wybug_corp": "世纪佳缘", "wybug_author": "taylortai", "wybug_date": "2012-04-26 19:06", "wybug_open_date": "2012-05-01 19:06", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄漏", "算法破解", "逆向破解思路"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  在北京很无聊啊，这个周末扁桃体发炎，找工作有一个征婚网站，自己还是单身啊，就到世纪家园的网站研究下，看看最近哪些妹子看过我，看过我的妹子有好看的啊，但是不能点击啊，然后就开始研究如何进入妹的主页，去看妹子的信息。\n\n\n\n我们先看妹子照片的连接\n\n    <a onmousedown=”if(typeof(send_jy_pv2)==’function’){send_jy_pv2(‘Usercpn_skgwdj’);}” target=”_blank” href=”http://www.jiayuan.com/vipcenter/?src_key=myjy_lookedme&amp;from=vipcenter-1″><img width=”74px” height=”90px” src=”http://photos7.jiayuan.com/a8/ed/a72f543c8127e155728a0330609f/avatar_p.jpg”></a>http://photos7.jiayuan.com/a8/ed/a72f543c8127e155728a0330609f/avatar_p.jpg我们要的就是这个，你从 <a></a>里面是看不到任何妹子的信息的。通过图片可以得知，家园的网站的用户的图片是放在不同的服务器的上的，通过二级域名来负载均衡了一般来说图片跟用户的信息都是有关联的，注意看后边的连接，查一下个数a72f543c8127e155728a0330609f 这个是28位，你第一个想到什么，md5，对了，有30位的的md5加密数据，但是我估计不会用，反解这个东西太累，而且只有28位该补什么好呢？注意看到a72f543c8127e155728a0330609f前面还有a8/ed这两个字母，凑起来是32位，这才是标准的md5么。但是顺序组合起来，放到md5反解网站上，明显不对，好，我自己也注册了一个世纪佳缘，把我自己的id md5 了一下，乐了，原来世纪家园的程序员懒了，将id md5后，用以下的格式来放照片了    前两位/后两位/中间的字母/avatar_p.jpg找到规律了，我们就用http://profile.jiayuan.com/反解出来的Id来进入妹子空间。等等，怎么是一个爷们？拿到找的规律不对？不对，到首页随便点了两个妹子的主页，拿到数据跟头像对比，用excel算了一下，原来如此。ori \tMD5 \t45894109 \t44894109 \t100000069850195 \t68850195 \t100000069647082 \t68647082 \t1000000原始的uid 在MD5前都被减了100W是这样啊，taylortai猜想，世纪佳缘应该是之前的图片命名有问题，或者排序是从100W开始的，所以要减去100W，这个数据好了，我们给反解出来的uid加上1000000 ，然后通过 http://profile.jiayuan.com/反解出来的UId即可 进入妹子的主页了。顺手写了个 脚本页面http://pztai.com/jiayuan/index.php?key=taylortai  你可以点击这个来实验成果~\n\n\n\n\n\n\n\n   漏洞证明：  http://pztai.com/jiayuan/index.php?key=taylortai  你可以点击这个来实验成果~   修复方案：  健壮图片路径算法   版权声明：转载请注明来源 taylortai@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-05-01 19:06 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-04-26 19:06 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  洞主造福全人类啊    \n     2012-04-26 19:11 |    \t\ttaylortai \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 三分钟热度)\t\t \n  @xsser 总算是白帽子了，嘿嘿    \n     2012-04-26 19:12 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @taylortai 是不是感觉也是有身份有地位的人了...    \n     2012-04-26 20:13 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  感觉和民工搬砖的,没啥区别。    \n     2012-04-26 22:49 |    \t\t瓜瓜 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:25        )\t\t \n  @zeracker 感觉搬沙子不错...    \n     2012-04-26 22:58 |    \t\ttaylortai \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 三分钟热度)\t\t \n  @瓜瓜 @xsser @zeracker 我们是码砖的，没事看看别人的砖砌的整不整齐，透不透风~    \n     2012-04-27 10:18 |    \t\t瓜瓜 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:25        )\t\t \n  @taylortai 码砖必须有透风嘿嘿，传说这个洞太好咧...    \n     2012-05-01 19:21 |    \t\tanyunix \t\t\t( 实习白帽子  |\t\t\t        Rank:86 漏洞数:8        | 号被盗。)\t\t \n  洞主造福全人类啊。顺便提下，楼主发漏洞能不能选漂亮MM的照片。    \n     2012-05-01 22:03 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  缺陷关联： WooYun: 腾讯3366小游戏站算法被破解 （算法破解）    \n     2012-05-01 22:46 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  这个楼主造福我等光杆啊，关于30位md5的解密就是去掉前8位后6位，拿中间的16位试试    \n     2012-05-01 23:18 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @taylortai 求相互交流码砖技巧    \n     2012-05-02 10:39 |    \t\tLee \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:24        | wataru@eviloctal.com)\t\t \n  这个分析很到位！    \n     2012-05-02 15:10 |    \t\tbaifeng \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 做人如果没有梦想，那和咸鱼有什么区别！)\t\t \n  IT男拯救全世界啊。    \n     2012-05-02 15:10 |    \t\t踏歌公子 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:7        | 江湖夜雨卌年灯，一剑一箫入红尘！)\t\t \n  洞主很给力！    \n     2012-05-03 00:40 |    \t\ticefish \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:8        | 欢迎大家和我用邮件进行交流~)\t\t \n  这种洞才有意思    \n     2012-05-06 20:12 |    \t\ttaylortai \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 三分钟热度)\t\t \n  @anyunix 哈哈，当时截图也觉得这个很丑    \n     2012-05-06 20:12 |    \t\ttaylortai \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 三分钟热度)\t\t \n  @horseluke 我就是菜鸟啊~    \n     2012-05-06 20:17 |    \t\ttaylortai \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 三分钟热度)\t\t \n  五一到现在一直忙着别的事情。。。大家的访问居然把我的网站搞瘫痪了。。。。。刚刚恢复    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}