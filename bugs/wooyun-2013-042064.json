{"id": 7344, "wybug_id": "wooyun-2013-042064", "wybug_title": "敏感信息泄露系列#5 信息泄露导致UC论坛1100万用户信息告急", "wybug_corp": "UC Mobile", "wybug_author": "猪猪侠", "wybug_date": "2013-11-05 15:29", "wybug_open_date": "2013-12-20 15:29", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "错误信息未屏蔽"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-20：\t细节向公众公开  简要描述： 由于没有一个通用标准的防御规则保护好中间件配置信息、DNS信息、业务数据信息、用户信息、源码备份文件、版本管理工具信息、系统错误信息和敏感地址信息(后台或测试地址)的泄露，攻击者可能会通过收集这些保护不足的数据，利用这些信息对系统实施进一步的攻击。 详细说明：  #1 信息泄露原因由于UC论坛管理员在更新服务器文件时，未注意到编辑器会默认创建各种.bak文件用来规避错误编辑时引发的数据丢失风险，从而造成了更严重的信息安全问题。#2 泄露地址网站: http://bbs.uc.cn 存在信息泄露网址：http://bbs.uc.cn/config/config_global.php.bak 网址：http://bbs.uc.cn/uc_server/data/config.inc.php.bak #3 泄露内容\n<?php$_config = array();// ---------------------------- CONFIG DB ----------------------------- //$_config['db']['1']['dbhost'] = '10.**.***.***:3308';$_config['db']['1']['dbuser'] = 'ultrax2';$_config['db']['1']['dbpw'] = 'On**********SIN';$_config['db']['1']['dbcharset'] = 'gbk';$_config['db']['1']['pconnect'] = '0';$_config['db']['1']['dbname'] = 'ultrax2';$_config['db']['1']['tablepre'] = 'pre_';//db156$_config['db']['slave'] = array();$_config['db']['slave']['1']['dbhost'] = '10.**.***.***:3301';$_config['db']['slave']['1']['dbuser'] = 'ultrax2';$_config['db']['slave']['1']['dbpw'] = 'On**********SIN';$_config['db']['slave']['1']['dbcharset'] = 'gbk';$_config['db']['slave']['1']['pconnect'] = '0';$_config['db']['slave']['1']['dbname'] = 'ultrax2';$_config['db']['slave']['1']['tablepre'] = 'pre_';//db155$_config['db']['slave']['2']['dbhost'] = '10.**.***.***:3301';$_config['db']['slave']['2']['dbuser'] = 'ultrax2';$_config['db']['slave']['2']['dbpw'] = 'On**********SIN';$_config['db']['slave']['2']['dbcharset'] = 'gbk';$_config['db']['slave']['2']['pconnect'] = '0';$_config['db']['slave']['2']['dbname'] = 'ultrax2';$_config['db']['slave']['2']['tablepre'] = 'pre_';//db68$_config['db']['slave']['4']['dbhost'] = '10.**.***.***:3308';$_config['db']['slave']['4']['dbuser'] = 'ultrax2';$_config['db']['slave']['4']['dbpw'] = 'On**********SIN';$_config['db']['slave']['4']['dbcharset'] = 'gbk';$_config['db']['slave']['4']['pconnect'] = '0';$_config['db']['slave']['4']['dbname'] = 'ultrax2';$_config['db']['slave']['4']['tablepre'] = 'pre_';//db12//$_config['db']['slave']['3']['dbhost'] = '10.**.**.**:3306';//$_config['db']['slave']['3']['dbuser'] = 'ultrax2';//$_config['db']['slave']['3']['dbpw'] = 'On**********SIN';//$_config['db']['slave']['3']['dbcharset'] = 'gbk';//$_config['db']['slave']['3']['pconnect'] = '0';//$_config['db']['slave']['3']['dbname'] = 'ultrax2';//$_config['db']['slave']['3']['tablepre'] = 'pre_';//$_config['db']['slave']['2']['dbhost'] = 'xxx'; //$_config['db']['slave']['2']['dbuser'] = 'xxxxxx'; //...$_config['db']['common']['slave_except_table'] = '';// -------------------------- CONFIG MEMORY --------------------------- //$_config['memory']['prefix'] = '5X07iz_';$_config['memory']['eaccelerator'] = 1;$_config['memory']['apc'] = 1;$_config['memory']['xcache'] = 1;$_config['memory']['memcache']['server'] = 'membbs.uc.local';$_config['memory']['memcache']['port'] = 11312;$_config['memory']['memcache']['pconnect'] = 1;$_config['memory']['memcache']['timeout'] = 1;// -------------------------- CONFIG SERVER --------------------------- //$_config['server']['id'] = 2;// ------------------------- CONFIG DOWNLOAD -------------------------- //$_config['download']['readmod'] = 2;$_config['download']['xsendfile']['type'] = '0';$_config['download']['xsendfile']['dir'] = '/down/';// --------------------------- CONFIG CACHE --------------------------- //$_config['cache']['type'] = 'sql';// -------------------------- CONFIG OUTPUT --------------------------- //$_config['output']['charset'] = 'gbk';$_config['output']['forceheader'] = 1;$_config['output']['gzip'] = '0';$_config['output']['tplrefresh'] = 1;$_config['output']['language'] = 'zh_cn';$_config['output']['staticurl'] = 'static/';$_config['output']['ajaxvalidate'] = '1';$_config['output']['iecompatible'] = '0';// -------------------------- CONFIG COOKIE --------------------------- //$_config['cookie']['cookiepre'] = 'r9xU_';$_config['cookie']['cookiedomain'] = 'bbs.uc.cn';//$_config['cookie']['cookiedomain'] = '';$_config['cookie']['cookiepath'] = '/';// ------------------------- CONFIG SECURITY -------------------------- //$_config['security']['authkey'] = 'f914a1uE55KbvhE8';$_config['security']['urlxssdefend'] = 1;$_config['security']['attackevasive'] = '0';$_config['security']['querysafe']['status'] = 1;$_config['security']['querysafe']['dfunction']['0'] = 'load_file';$_config['security']['querysafe']['dfunction']['1'] = 'hex';$_config['security']['querysafe']['dfunction']['2'] = 'substring';$_config['security']['querysafe']['dfunction']['3'] = 'if';$_config['security']['querysafe']['dfunction']['4'] = 'ord';$_config['security']['querysafe']['dfunction']['5'] = 'char';$_config['security']['querysafe']['daction']['0'] = 'intooutfile';$_config['security']['querysafe']['daction']['1'] = 'intodumpfile';$_config['security']['querysafe']['daction']['2'] = 'unionselect';$_config['security']['querysafe']['daction']['3'] = '(select';$_config['security']['querysafe']['daction']['4'] = 'unionall';$_config['security']['querysafe']['daction']['5'] = 'uniondistinct';$_config['security']['querysafe']['dnote']['0'] = '/*';$_config['security']['querysafe']['dnote']['1'] = '*/';$_config['security']['querysafe']['dnote']['2'] = '#';$_config['security']['querysafe']['dnote']['3'] = '--';$_config['security']['querysafe']['dnote']['4'] = '\"';$_config['security']['querysafe']['dlikehex'] = 1;$_config['security']['querysafe']['afullnote'] = '0';// -------------------------- CONFIG ADMINCP -------------------------- //// -------- Founders: $_config['admincp']['founder'] = '1,2,3'; --------- ////$_config['admincp']['founder'] = '1,21***,42***,23***85';$_config['admincp']['founder'] = '42***18';$_config['admincp']['forcesecques'] = '0';$_config['admincp']['checkip'] = 1;$_config['admincp']['runquery'] = 1;$_config['admincp']['dbimport'] = 1;// -------------------------- CONFIG REMOTE --------------------------- //$_config['remote']['on'] = '0';$_config['remote']['dir'] = 'remote';$_config['remote']['appkey'] = '62cf0b3c3e6a*******7216839721d8e';$_config['remote']['cron'] = '0';// ------------------- THE END -------------------- //?>\n\n:<?php define('UC_DBHOST', 'localhost');define('UC_DBUSER', 'root');define('UC_DBPW', 'root');define('UC_DBNAME', 'discuz');define('UC_DBCHARSET', 'gbk');define('UC_DBTABLEPRE', 'pre_ucenter_');define('UC_COOKIEPATH', '/');define('UC_COOKIEDOMAIN', '');define('UC_DBCONNECT', 0);define('UC_CHARSET', 'gbk');define('UC_FOUNDERPW', '61e067eea9*********482350ce271e8');define('UC_FOUNDERSALT', 'I****8');define('UC_KEY', 'ufP208Xdm5j6y3m***************3Mebfl2D0L2ofJf79k2K3zao9');define('UC_SITEID', 'yfw2f8BdG5y6j3DcX2t5Yck***************fr2M0N29fjfs9y2M3SaP9');define('UC_MYKEY', 'SfD2386d95g6s3qcV215Gcb1***********KfD2F0N2DfxfJ962t3Lab9');define('UC_DEBUG', false);define('UC_PPP', 20)\n   漏洞证明：  #4 漏洞证明 (有UC_KEY，Discuz等于可以做任何事)详细利用方法参见： WooYun: 途牛网某服务配置失误 导致论坛敏感文件泄露(致使百万用户信息告急) #5 证明细节(对于有些人你不发个SHELL出来，他们永远会觉得这不是安全问题！)例如盛大： WooYun: 盛大某分站敏感配置文件泄露#1 可导致内网渗透 ~！不要以为把admin.php加个登陆限制就没事了\n\n~！论坛用户数1100万，未深入测试uc.cn的统一用户接口，估计用户更多。\n\n~！更深入的证明\n\n   修复方案：  #1 网络边界需要认真对待。#2 杜绝为了方便而造成的不必要的信息泄露。#3 安全是一个整体，保证安全不在于强大的地方有多强大，而在于真正薄弱的地方在哪里。   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-11-05 16:36 厂商回复： 漏洞的确存在，已联系运维及研发处理，非常感谢猪猪侠提交的漏洞信息。 最新状态： 2013-11-05：漏洞已修改，再次感谢猪猪侠！ 2013-11-05：漏洞已修复，再次感谢猪猪侠！  ", "replys": "漏洞评价：\n评论\n     2013-11-05 15:29 |    \t\tFz-sea \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:21        | 没有要介绍的)\t\t \n  社工牛~    \n     2013-11-05 15:30 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  社工牛！    \n     2013-11-05 15:31 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB    \n     2013-11-05 15:34 |    \t\tFz-sea \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:21        | 没有要介绍的)\t\t \n  @寂寞的瘦子 怎么看你都是小号    \n     2013-11-05 15:35 |    \t\t灬相随灬 \t\t\t( 普通白帽子  |\t\t\t        Rank:369 漏洞数:68        | 大胆天下去得，小心寸步难行。)\t\t \n  @Fz-sea 我也觉得~    \n     2013-11-05 15:36 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @灬相随灬 @Fz-sea 事实上我是大号。    \n     2013-11-05 15:47 |    \t\tadm1n \t\t\t( 普通白帽子  |\t\t\t        Rank:216 漏洞数:66        | 只是一个渣渣而已。。。)\t\t \n  连载的节奏~    \n     2013-11-05 15:59 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  关注哟！！    \n     2013-11-05 16:03 |    \t\tdyun \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:15        | [code][/code])\t\t \n  4去哪了...    \n     2013-11-05 16:17 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @Fz-sea @寂寞的瘦子 这不是社工，谢谢！    \n     2013-11-05 16:41 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  必须关注    \n     2013-11-05 19:32 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  膜拜    \n     2013-11-25 20:15 |    \t\talso \t\t\t( 普通白帽子  |\t\t\t        Rank:424 漏洞数:52        | 招渗透/php/前端/ios&android安全，广州地...)\t\t \n  煤老板    \n     2013-12-21 13:35 |    \t\tw5r2 \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:52        )\t\t \n  good    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}