{"id": 46148, "wybug_id": "wooyun-2015-092457", "wybug_title": "12306登录接口依然可被撞库攻击(验证码可识别)", "wybug_corp": "12306", "wybug_author": "猪猪侠", "wybug_date": "2015-01-17 20:33", "wybug_open_date": "2015-03-03 20:34", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-03：\t细节向公众公开  简要描述： 每个账号登陆的阀值20分钟可登录5次，验证码可识别，手机客户端无验证码 详细说明：  手机客户端无验证码https://kyfw.12306.cn/otn/login/init\n\n\nPOST /otn/login/loginAysnSuggest HTTP/1.1Host: kyfw.12306.cnContent-Length: 152Accept: */*Origin: https://kyfw.12306.cnX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: https://kyfw.12306.cn/otn/login/initAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8,en;q=0.6,zh-TW;q=0.4Cookie: JSESSIONID=91FA1614F112D5178E44705FDF85E4D1; BIGipServerotn=1725497610.24610.0000; current_captcha_type=CConnection: Keep-AliveloginUserDTO.user_name=10000%40qq.com&userDTO.password=123456&randCode=wh6e&randCode_validate=&MTQwOTA5=ZGY5Y2ZjYjEyMjI2MWJiMg%3D%3D&myversion=undefined\n手机客户端无需验证码，密码在提交的时候，md5加密即可，阀值20分钟\nPOST /otsmobile/apps/services/api/MobileTicket/android/query HTTP/1.1Host: mobile.12306.cnContent-Length: 591Origin: file://Accept-Language: zh_CNAuthorization: {\"morCustomRealm\":\"aDHgAUw92AQQCYjZyEX5TcAVgAncDZmQCAAUAewNzcgEoYAxMQjJrAEBBRWEWNX9AHnULd1w9cykTXj8xRxxxIlsxFUVPQmAfN0IlOi0iRRE7azdSPjVIIjVEGjIQNz46FVw8ZxZERQMeVSZoMF5nFU12Hk4xQ2ocGU4zYiJObDR3NSZPQCJJZEBtG2JBS3AyaF5EQgVGIU1IZ0VWBXdgTn1tCV89ajxgQDM5XyQ0PmVkVjRyBlc5Nm9oJEMSZnh2dkYcSjplfkd+NBx/GGhAWjFoFmEUZVNHLDFGKz5iaGtrYSVsEGZvdg==\"}X-Requested-With: XMLHttpRequestx-wl-app-version: 2.0x-wl-platform-version: 6.0.0WL-Instance-Id: u76dbkg7kq364qrpfrp2oflm3fContent-type: application/x-www-form-urlencoded; charset=UTF-8Accept: text/javascript, text/html, application/xml, text/xml, */*User-Agent: Mozilla/5.0 (Linux; U; Android 4.2.2; zh-cn; GT-N7100 Build/JDQ39; CyanogenMod-0.9.9.7) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30/Worklight/6.0.0Accept-Encoding: gzip,deflateAccept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7Cookie: BIGipServerworklight=3705078026.16420.0000; AlteonP=0a02eb040a02ebc5284cfdfd2378; JSESSIONID=0000D6oVUcQ2f3Uw70wtfc73C9v:196iqvou7; BIGipServernginxformobile=32178698.50215.0000Connection: Keep-Aliveadapter=CARSMobileServiceAdapterV2&procedure=login&compressResponse=true&parameters=[{\"baseDTO.os_type\":\"a\",\"baseDTO.device_no\":\"53469c87548547e\",\"baseDTO.mobile_no\":\"123444\",\"baseDTO.time_str\":\"20150117212733\",\"baseDTO.check_code\":\"170294cbd0ab3398d8ed39217170c9ad\",\"baseDTO.version_no\":\"1.1\",\"baseDTO.user_name\":\"10000@qq.com\",\"password\":\"327bc4e22b649d47c4546a3ec93f376b\"}]&__wl_deviceCtxVersion=-1&__wl_deviceCtxSession=30549131421501159027&isAjaxRequest=true&x=0.8806376396678388\n识别\nhttp://www.80vul.com/yzm/v.php?url=http://static.loner.fm/upload/201501/1720224632ac157f9dd635bd901105790c35853f.jpg\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   漏洞证明：  # 识别平台1\n\n# 识别平台2\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  登录接口的验证码可以加强，真的   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-01-18 01:30 厂商回复： 可被绕过和可被自动识别应该是两个意思。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-17 20:34 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:54        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  要开刷了吗    \n     2015-01-17 20:35 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:116        | STEAM_0:0:55968383)\t\t \n  wew    \n     2015-01-17 20:39 |    \t\t安然意境 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:69        | 无论是你的事业还是你的个人，可能走的过程...)\t\t \n  要开刷验证码专题了吗？    \n     2015-01-17 20:44 |    \t\tsdc1992 \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:11        )\t\t \n  “验证码100%被绕过”0 0    \n     2015-01-17 20:47 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:207        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @李旭敏 就2个，不再发了    \n     2015-01-17 20:54 |    \t\t疯狂的dabing \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:9        | Hehe is golden.)\t\t \n  快别折腾12306了。。。去年铁道部搞过动态变色验证码，眼都瞎了。。。    \n     2015-01-17 20:54 |    \t\t小呆呆 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:7        | 每次有人骂我猪我都说我偶像也是猪)\t\t \n  好快    \n     2015-01-17 21:20 |    \t\tObserver \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:6        | 我在夕阳下奔跑，那是我逝去的青春)\t\t \n  前排    \n     2015-01-17 21:36 |    \t\t李宇航的小柠檬 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 小柠檬甜不甜)\t\t \n  百度验证码最恶心    \n     2015-01-17 21:52 |    \t\t小呆呆 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:7        | 每次有人骂我猪我都说我偶像也是猪)\t\t \n  @李宇航的小柠檬 你谁啊    \n     2015-01-17 22:04 |    \t\tim503 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:8        | 失踪的路人甲| Rank:-503 漏洞数:0 |爱pyth...)\t\t \n  12306...     \n     2015-01-17 22:15 |    \t\tilll \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:8        | 轻吟一句情话，执笔一副情画。绽放一地情...)\t\t \n  乌云验证码有多diao？？？？    \n     2015-01-17 22:34 |    \t\tsco4x0 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:12        | O_o)\t\t \n  猪哥要开验证码专场了    \n     2015-01-17 22:37 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:78        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  CCTV拍我~    \n     2015-01-18 00:02 |    \t\t窝窝哥 \t\t\t( 实习白帽子  |\t\t\t        Rank:86 漏洞数:29        | 没WB啊啊啊啊！)\t\t \n  12306打脸第二弹！    \n     2015-01-18 10:15 |    \t\t铁汉 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:5        | 向各种大神学习之)\t\t \n  猪哥，都不休息的    \n     2015-01-18 13:05 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:15        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  可被绕过和可被自动识别应该是两个意思。    \n     2015-01-18 13:18 |    \t\t李宇航的小柠檬 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 小柠檬甜不甜)\t\t \n  @’‘Nome 哈哈，    \n     2015-01-20 11:06 |    \t\tsky \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:30        | 有一天，我带着儿子@jeary 去@园长 的园长...)\t\t \n  @国家安全局 这位大神比较吊    \n     2015-01-20 11:18 |    \t\twinalva \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | rank是什么？)\t\t \n  @疯狂的dabing hahahahahahahahahah    \n     2015-03-11 10:29 |    \t\t小清新 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 以后再写)\t\t \n  @sky 哈哈    问下   这是个人ID   还是“厂商啊？”    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}