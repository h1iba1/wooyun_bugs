{"id": 67760, "wybug_id": "wooyun-2015-0152168", "wybug_title": "聚胜万合一个信息泄漏引发的血案", "wybug_corp": "mediav.com", "wybug_author": "_Thorns", "wybug_date": "2015-11-06 10:30", "wybug_open_date": "2015-11-09 10:08", "wybug_type": "应用配置错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-09：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 一个信息泄漏引发的血案 详细说明：  逛着微博，神器抓到了一个简单的svn信息泄漏http://material.mediav.com/compile/m2/.svn/entries\n\n看起来像是一个应用系统，对他的文件进行分析。\n<?php// change the following paths if necessary$yiic=dirname(__FILE__).'/../../../frame/yii/yii-1.1.9.r3527/framework/yiic.php';$config=dirname(__FILE__).'/../../../frame/config/console.php';define('CONFIG_SET_BASE_PATH', dirname(__FILE__));require_once($yiic);\n也审计出来了几个漏洞，但是这些页面一访问就直接跳转下载，小弟实在不甘心，硬着头皮翻敏感信息。\n\n终于翻出来了敏感信息，眼都特么看花了！\n\n$mail->IsSMTP(); // telling the class to use SMTP            $mail->Host       = \"smtp.mediav.com\"; // SMTP server            $mail->SMTPSecure = \"ssl\";            $mail->SMTPAuth   = TRUE;                  // enable SMTP authentication            $mail->Host       = \"smtp.mediav.com\"; // sets the SMTP server            $mail->Port       = 465;                    // set the SMTP port for the GMAIL server            $mail->Username   = \"mvadmin@mediav.com\"; // SMTP account username            $mail->Password   = \"miscUsage4MV\";        // SMTP account password            $mail->SetFrom('mvadmin@mediav.com');            $mail->CharSet    = 'UTF-8';            $mail->Encoding   = 'base64';            $mail->Subject    = $subject;            $mail->MsgHTML($message);            $mail->AddAddress($addr);\n\n这个邮箱看起来没有什么用，之后又翻出来了另外一个员工邮箱。$mail->Username   = \"liujian@mediav.com\"; // SMTP account username        $mail->Password   = \"liujian\";        // SMTP account password\n\n邮箱里提供了VPN，但是测试是发现没办法链接的。在翻阅邮件的过程中，看到你们内部在推送这个系统。http://www.5star.cn/skin/.svn/entries这个也存在信息泄漏，自己检查把。\n\n一大堆帐号，我就不帖了，好麻烦的说。   漏洞证明：  逛着微博，神器抓到了一个简单的svn信息泄漏http://material.mediav.com/compile/m2/.svn/entries\n\n看起来像是一个应用系统，对他的文件进行分析。\n<?php// change the following paths if necessary$yiic=dirname(__FILE__).'/../../../frame/yii/yii-1.1.9.r3527/framework/yiic.php';$config=dirname(__FILE__).'/../../../frame/config/console.php';define('CONFIG_SET_BASE_PATH', dirname(__FILE__));require_once($yiic);\n也审计出来了几个漏洞，但是这些页面一访问就直接跳转下载，小弟实在不甘心，硬着头皮翻敏感信息。\n\n终于翻出来了敏感信息，眼都特么看花了！\n\n$mail->IsSMTP(); // telling the class to use SMTP            $mail->Host       = \"smtp.mediav.com\"; // SMTP server            $mail->SMTPSecure = \"ssl\";            $mail->SMTPAuth   = TRUE;                  // enable SMTP authentication            $mail->Host       = \"smtp.mediav.com\"; // sets the SMTP server            $mail->Port       = 465;                    // set the SMTP port for the GMAIL server            $mail->Username   = \"mvadmin@mediav.com\"; // SMTP account username            $mail->Password   = \"miscUsage4MV\";        // SMTP account password            $mail->SetFrom('mvadmin@mediav.com');            $mail->CharSet    = 'UTF-8';            $mail->Encoding   = 'base64';            $mail->Subject    = $subject;            $mail->MsgHTML($message);            $mail->AddAddress($addr);\n\n这个邮箱看起来没有什么用，之后又翻出来了另外一个员工邮箱。$mail->Username   = \"liujian@mediav.com\"; // SMTP account username        $mail->Password   = \"liujian\";        // SMTP account password\n\n邮箱里提供了VPN，但是测试是发现没办法链接的。在翻阅邮件的过程中，看到你们内部在推送这个系统。http://www.5star.cn/skin/.svn/entries这个也存在信息泄漏，自己检查把。\n\n一大堆帐号，我就不帖了，好麻烦的说。   修复方案：     版权声明：转载请注明来源 _Thorns@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2015-11-06 10:51 厂商回复： thank you, we're checking it now 最新状态： 2015-11-09：謝謝，已經FIX，主要是我們管理上的疏漏。  ", "replys": "漏洞评价：\n评论\n     2015-11-06 12:41 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1056 漏洞数:181        | WooYun is the Bigest gay place :))\t\t \n  到手1rank，简直这拉低我的rank值……    \n     2015-11-09 10:10 |    \t\t聚胜万合(乌云厂商)\t\t \n  @_Thorns THANK YOU    \n     2015-11-09 11:28 |    \t\tsenmmy \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 应该为这个世界的安全做点儿什么？！对，先...)\t\t \n  楼主辛辛苦苦给二楼挖洞，没功劳也是有苦劳的啊，1rank...心寒...人辛辛苦苦给你找出来问题告诉你，要是这个洞不小心流到地下交易，就不是Thank YOU就搞得定的事儿了 让我们也看到你们的专业和尊重 OK？严重建议厂商给白帽rank不要简单以修复难度来评？给点儿诚意嘛    \n     2015-11-09 11:33 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1056 漏洞数:181        | WooYun is the Bigest gay place :))\t\t \n  @senmmy 淡定淡定，解决问题就好啦。主要看自己学到什么。^_^    \n     2015-11-09 11:48 |    \t\t黑色的屌丝 \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:6        | →_→→_→)\t\t \n  没有修？    \n     2015-11-09 11:53 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1056 漏洞数:181        | WooYun is the Bigest gay place :))\t\t \n  @黑色的屌丝 没修也敢公布的话，估计要被别人搞烂了。    \n     2015-11-09 12:21 |    \t\t霝z \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:38        | 乌~~有进步才是最重要的事！)\t\t \n  SVN这漏洞很久前就爆了，但好像还是没升级版本也没有删除./SVN 厂商运维的人员好像没怎么重视啊。    \n     2015-11-09 20:02 |    \t\t菜鸟v3 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | 菜鸟一个，多学习，多指教~)\t\t \n  @_Thorns 那个……请教神器是指哪个？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}