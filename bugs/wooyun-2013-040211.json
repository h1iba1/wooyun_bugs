{"id": 7816, "wybug_id": "wooyun-2013-040211", "wybug_title": "华为某站点任意用户订单遍历和取消", "wybug_corp": "华为技术有限公司", "wybug_author": "带馅儿馒头", "wybug_date": "2013-10-18 17:52", "wybug_open_date": "2013-12-02 17:53", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "敏感接口未加权限认证", "越权操作", "用户敏感信息泄露", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-02：\t细节向公众公开  简要描述： RT 详细说明：  \n问题站点：华为爱旅，hwtrip.smartcom.cc\n\n一.任意用户订单取消\n1.使用两个用户分别生成两个订单（从浏览器区分）；\n\n\n\n2.点击取消其中一个用户的订单并抓包；\n\n3.抓包得到如下请求链接；\nhttp://hwtrip.smartcom.cc/user/ucenter.html?is_ajax=1&act=changeOrderStatus&id=13207&changeto=8&page=1&pageCount=1\n4.将id修改为13209并提交，再返回用户页面刷新，已成功取消用户订单；\n\n5.攻击者只需要来进行一个id遍历，即可取消所有用户订单；二.订单支付逻辑缺陷；6.使用一个用户生成如下订单，系统对产品数量未进行严格校验，可提交负数订单；\n\n7.这里就不支付测试了；三.任意用户订单联系人信息查询；8.在上面的测试中，发现下面这样一个链接；\nhttp://hwtrip.smartcom.cc/book.php?bookAct=pay&orderSN=1310181xxxx\n9.生成这样一个订单；\n\n10.使用另一个用户访问即可获取用户的信息；\n\n11.遍历orderSN参数值即可获取所有订单的联系人信息；   漏洞证明：  见详细说明   修复方案：  权限控制   版权声明：转载请注明来源 带馅儿馒头@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-10-21 16:25 厂商回复： 感谢带馅儿馒头的关注，业务部门正安排整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}