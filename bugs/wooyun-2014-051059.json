{"id": 4143, "wybug_id": "wooyun-2014-051059", "wybug_title": "AVCON6系统管理平台任意文件上传漏洞及信息泄漏漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "wefgod", "wybug_date": "2014-02-20 14:21", "wybug_open_date": "2014-05-21 14:22", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传", "文件上传安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-04-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-21：\t细节向公众公开  简要描述： 直接拿shell。 详细说明：  官网：http://www.avcon.com.cn/曾经有大牛提交过其命令执行： WooYun: AVCON多媒体通信系统全部版本存在通用型远程代码执行 谷歌：http://www.google.co.in/search?sourceid=chrome&ie=UTF-8&q=inurl%3AchangLang.action先放两个信息泄漏：http://meeting.nsjy.com/AvconWebService/fingerprint.jsp\n\nhttp://meeting.nsjy.com/AvconWebService/happyaxis.jsp\n\n   漏洞证明：  接着是任意文件上传：http://www.avms.com.cn:8080/voip/basemanager/dorolldata\nString webRoot = request.getSession().getServletContext().getRealPath(\"/\");    String flag = \"up_ok\";    String path = webRoot + \"/upload/\";    ServletConfig config = getServletConfig();MyFile mf = new MyFile(request, response, config, path);\n写到upload文件夹this.su.setAllowedFilesList(\"wav,sql\");而且只允许sql或wav，但是，不自动重命名文件！直接上传一个如div.jsp .sql的，中间用00截断即可\n\nShell成功\n\n再看一个例子，在谷歌搜索排前面的：http://61.153.10.88:8080/voip/basemanager/dorolldata\n\n   修复方案：  文件写到临时目录算了……   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-02-25 09:55 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-23 07:28 |    \t\t郭斯特 \t\t\t( 普通白帽子  |\t\t\t        Rank:181 漏洞数:69        | GhostWin)\t\t \n  我想问下前辈是如何找到返回的路径的？burp没有返回吧？    \n     2014-05-23 11:07 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @郭斯特 文件名没改，后面猜个upload是基本技能吧？    \n     2014-05-23 16:23 |    \t\t郭斯特 \t\t\t( 普通白帽子  |\t\t\t        Rank:181 漏洞数:69        | GhostWin)\t\t \n  @wefgod 0.0 学习了~    \n     2014-05-24 15:21 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @郭斯特 加上我都附上代码了一点代码了，可想而知    \n     2014-05-24 16:52 |    \t\t郭斯特 \t\t\t( 普通白帽子  |\t\t\t        Rank:181 漏洞数:69        | GhostWin)\t\t \n  soga~~赞~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}