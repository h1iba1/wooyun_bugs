{"id": 85443, "wybug_id": "wooyun-2016-0169119", "wybug_title": "12306账户安全逻辑错误导致可能会被永久盗号无法找回", "wybug_corp": "12306", "wybug_author": "木鱼", "wybug_date": "2016-01-14 10:31", "wybug_open_date": "2016-02-27 11:49", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-27：\t细节向公众公开  简要描述： 12306开通手机核验之后，手机号码允许作为帐号登录。但目前存在的验证逻辑导致，一旦密码泄露，将有可能被人彻底修改安全资料，导致只能注销账号。 详细说明：  12306开通手机核验之后，手机号码允许作为帐号登录。但目前存在的验证逻辑中，手机号码重新核验的时候，可以修改号码，但无需原号码校验。这可能导致未经许可的直接修改手机号码。在修改之后，可以凭借新的手机号码接收验证码，然后彻底修改安全邮箱。至此，原账号已经无法使用任何手段找回密码，只能去火车站注销账号。   漏洞证明：  1.登录一个正常的12306账号2.进入手机核验环节，直接修改为自己的手机号码\n\n3.直接提示修改成功，并不需要原手机号核验\n\n4.继续核验手机号码，按常规流程发短信收验证码\n\n5.核验完成，接着去安全资料中修改邮箱\n\n6.用新手机号接收短信，并继续修改\n\n7.至此，手机号码和安全邮箱完全被修改，账号已收入囊中。现在，如果原账号所有人要重新注册账号，只能选择去车站使用证件注销账号。   修复方案：  1.修改手机号时，对于已核验的手机号，要求使用原手机号先确认身份2.对于未核验的手机号，在核验之前禁止修改邮箱3.已核验手机号丢失的，可提交身份证扫描件等资料确认身份，或去车站校验身份人工修改   版权声明：转载请注明来源 木鱼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2016-01-18 18:11 厂商回复： 1，对换号的已核验用户，如果原手机号码已不使用或已停用，会出现使用新号码无法核验的情况，则需要提供身份证明或去线下核验了。2，目前系统是这样卡控的。3，如不按建议1改动，目前可使用新号通过双向核验重新完成新号绑定。考虑到换号的情况比丢失密码的情况多，故系统采用了目前的解决方案。谢谢您的建议！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-14 10:33 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:215 漏洞数:59        | 工欲善其事，必先利其器)\t\t \n  桌上几杯酒，哪一杯是茅台！    \n     2016-01-14 10:42 |    \t\t90Snake \t\t\t( 普通白帽子  |\t\t\t        Rank:148 漏洞数:50        | 人如果没有梦想，跟咸鱼有什么分别)\t\t \n  火钳刘明    \n     2016-01-14 10:48 |    \t\twebshell \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:19        | hello word.)\t\t \n  CCAV快看这里，哈哈哈哈哈哈哈哈哈！    \n     2016-01-14 10:49 |    \t\tFormat_smile \t\t\t( 普通白帽子  |\t\t\t        Rank:350 漏洞数:116        | ···孰能无过，谁是谁非！)\t\t \n  社区送温暖，洞主开下门    \n     2016-01-14 10:51 |    \t\t木易 \t\t\t( 普通白帽子  |\t\t\t        还没有发布任何漏洞        | 历代鬼谷子虽一人之力，却强于百万之师。一...)\t\t \n  看看    \n     2016-01-14 10:52 |    \t\thkcs \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:9        | 只是路过)\t\t \n  时间过得真快，两年了    \n     2016-01-14 11:04 |    \t\t骑虎打狗 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 认真对待每个洞..)\t\t \n  你是12306请来的救兵吗    \n     2016-01-14 11:06 |    \t\t番茄师傅 \t\t\t( 普通白帽子  |\t\t\t        Rank:346 漏洞数:82        | http://www.tomatoyu.com/)\t\t \n  社区送温暖，洞主开下门    \n     2016-01-14 11:21 |    \t\t土夫子 \t\t\t( 普通白帽子  |\t\t\t        Rank:453 漏洞数:78        | 看似山穷水尽，终将柳暗花明)\t\t \n  顺丰快递，到付    \n     2016-01-14 11:37 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:217 漏洞数:18        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  楼主，你家水表超啦，我们看下，开下门。    \n     2016-01-14 11:46 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:532 漏洞数:69        | 潜心学习~~~)\t\t \n  ＬＺ好专一    \n     2016-01-14 12:17 |    \t\tilll \t\t\t( 实习白帽子  |\t\t\t        Rank:46 漏洞数:15        | 轻吟一句情话，执笔一副情画。绽放一地情...)\t\t \n  cctv快看    \n     2016-01-14 13:15 |    \t\t毛猴 \t\t\t( 普通白帽子  |\t\t\t        Rank:107 漏洞数:33        | 一 只 怀 有 梦 想 的 猴 ......)\t\t \n  表哥 遇见还几个人找不回了！    \n     2016-01-14 13:51 |    \t\tMartial \t\t\t( 普通白帽子  |\t\t\t        Rank:2074 漏洞数:104        | 竟然还有人冒充我，醉了，骗子QQ445697541...)\t\t \n  这是一个悲惨的故事    \n     2016-01-14 14:04 |    \t\t你猜我是谁 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 一起好好玩就是了)\t\t \n  12306：你们在造谣    \n     2016-01-14 14:49 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1662 漏洞数:110        | WooYun is the Bigest gay place.  网络工...)\t\t \n  我的号现在还用不了.......    \n     2016-01-14 14:53 |    \t\t暮晨 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | ------ 对这世上的一切未知抱有一颗探求之...)\t\t \n  此洞会火    \n     2016-01-14 14:54 |    \t\t米怀特 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 安全真的安全么？)\t\t \n  12306：你们在造谣    \n     2016-01-14 15:37 |    \t\t伤心的猫猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:6        | @sangfor,@qq,@alibaba,@baidu)\t\t \n  火起来，火起来。    \n     2016-01-14 16:59 |    \t\t恶魔小西瓜 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:1        )\t\t \n  楼主！你家厕所漏了，开下门！    \n     2016-01-16 11:30 |    \t\tSuperRookie \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:11        | 求收编，本人会注入，会上传，会Xss，会破...)\t\t \n  我十几个E架设的网站 是你们这些人能挖到漏洞的？ 小心给你送下乡    \n     2016-02-18 16:01 |    \t\t木鱼 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:3        | 木鱼。)\t\t \n  差点把这事儿忘记了，然而12306的回应……23333.相对于换号、原号码停用，很明显个人信息、密码被盗更严重。一旦被盗无法找回，这才是关键。    \n     2016-02-18 16:03 |    \t\t木鱼 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:3        | 木鱼。)\t\t \n  他们怎么会因为考虑到有人换号而原号码停用的因素来放弃验证原号码啊。。。就算真的考虑这种场景，那起码得要原号码或原邮箱之一验证吧， 而不能完全不验证。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}