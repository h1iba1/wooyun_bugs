{"id": 9296, "wybug_id": "wooyun-2013-038387", "wybug_title": "支付宝付款时密保工具（短信验证，宝令等）绕过", "wybug_corp": "支付宝", "wybug_author": "丢小丢", "wybug_date": "2013-09-28 10:08", "wybug_open_date": "2013-09-30 11:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 支付宝付款时，绕过密保工具（短信验证，宝令，数字证书等）的验证。 详细说明：  简单说就是支付宝设置了支付验证密保工具，到了wap版就无验证机制了即使用户设置了支付宝付款需要验证密保工具（比如手机验证码，宝令，动态密码，电子证书），只要先把订单提交，到验证密保这一步。换手机上wap的支付宝，找到未支付订单，就可以只凭支付密码完成支付。简单的验证机制问题，既然出了支付二次验证密保，就应该做好，不能光在电脑上验证。虽然说只有快捷支付和余额支付可以绕过。但还是挺严重的问题。因为密保工具就是为了“当用户帐号密码等信息泄漏时用户账户资金安全”如果可以绕过，他们也就没有存在意义了.   漏洞证明：  简单拍下一个商品支付。\n\n你看这里需要同时验证支付宝支付密码和宝令动态口令。关了这个页面换手机\n\n找到这个未提交订单，页面上只有一个支付密码输入框。只凭支付宝支付密码就可进行支付。宝令之类的密保工具是不需要的。\n\n支付成功了。虽然不是太严重的问题，不过终究是验证体系里的短板。   修复方案：  估计是支付宝考虑到手机wap页面的限制，没法验证某些密保（比如-数字证书），就设置为只需要支付密码就可以完成支付了。这就成了验证系统里的短板。其实可以强制wap支付宝支付时，验证短信验证码。   版权声明：转载请注明来源 丢小丢@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-09-30 11:14 厂商回复： 感谢对支付宝系统安全的支持与关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-28 12:40 |    \t\t艾特绅 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 愿意为网络安全做出我的贡献)\t\t \n  关注    \n     2013-09-28 12:50 |    \t\t萧然 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 喜欢一切美丽的东西！)\t\t \n  发财的洞+1    \n     2013-09-29 15:34 |    \t\t丢小丢 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 爱好，只是单纯的爱好)\t\t \n  @萧然 只是绕过支付验证，确认收货时的密保工具绕不过，只能等到时间自动确认收货。。。这就要等好久了，容易被发现。    \n     2013-09-30 11:25 |    \t\tACGT \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:4        | another script kiddie)\t\t \n  @丢小丢 那时候攻击者已经收到赃物了，还管什么确认不确认    \n     2013-09-30 11:27 |    \t\tNULL0 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:3        | ..............)\t\t \n  发财的洞+1     \n     2013-09-30 11:41 |    \t\t丢小丢 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 爱好，只是单纯的爱好)\t\t \n  @ACGT 支付宝忽略漏洞，汗一个！    \n     2013-09-30 11:47 |    \t\t丢小丢 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 爱好，只是单纯的爱好)\t\t \n  @ACGT 地址啊！你填的地址是个大问题。如果被用户提前发现。那就麻烦了。不过。。如果你就是网店店主，那就无所谓啦，随便编个地址就行了。    \n     2013-10-04 17:47 |    \t\t大仙 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n  我记得要安装支付宝钱包或者控件才能付款成功吧~    \n     2013-10-08 16:34 |    \t\t丢小丢 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 爱好，只是单纯的爱好)\t\t \n  @大仙 他会提示让你认证，无视就好了。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}