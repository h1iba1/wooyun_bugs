{"id": 708, "wybug_id": "wooyun-2014-068621", "wybug_title": "深圳互联系统存在任意文件上传+SQL注射+弱口令+数据库可被下载漏洞", "wybug_corp": "国家互联网应急中心", "wybug_author": "U神", "wybug_date": "2014-07-15 21:58", "wybug_open_date": "2014-10-13 22:00", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-13：\t细节向公众公开  简要描述： 希望乌云君交给国家互联网应急中心联系厂商修复漏洞！先膜拜U大牛，格式按照U大牛的来，走首页应该很合理了吧？ 详细说明：          深圳市商科网络科技有限公司【http://www.intersk.com/】，是一家致力于品牌网站建设，优化推广，400电话，企业邮箱、网站应用程序开发（B/S）等互联网领先服务商。简单的来说该公司开发的一套系统虽然没有什么名字这里就以“深圳互联系统”来命名，该系统主要用于深圳市各大企业公司网站的建设，该系统存在注射漏洞和未授权的任意文件上次漏洞，可能造成极大的危害，如何识别为深圳互联系统，我们看看后台的风格：输入admin可到下面后台：\n\n官网成功案例：\n\n该系统的url特征比较普遍，所以构造关键字比较难：\n\"网站制作：商科网络\"inurl:“products.asp?classid” intitle:深圳\n\n\n第二个关键字搜索的大多是深圳互联系统，部分非互联系统，更好认证为该系统的方法只要在域名后加上：/admin。则会跳转到后台，如果后台页面风格与上面所提到的一样则可断定为深圳互联系统   漏洞证明：  【警告：以下所提到的漏洞杀伤力极强，仅供CNVD测试与漏洞报告，其它人不得用此漏洞进行恶意破坏或利用，否则后果自负！】一、SQL注射漏洞：\n注射漏洞1：/productlist.asp?ID=  注入参数ID <部分没有该页面>注射漏洞2：/admin/Employee/Login.asp <登录框Post注射，通杀注射>\n*********************************************************************************************SQL注射一、证明【该系统部分装有安全狗】：\n\n\n\n\n\n测试跑跑吧：\n\n\n\n*********************************************************************************************SQL注射二证明：\n\n\n\n\n\n\n\n*********************************************************************************************二、GETSHELL漏洞：\nif filelx<>\"\" then     if (fileext=\"asp\") or (fileext=\"jsp\") or (fileext=\"jspx\") or (fileext=\"php\") or (fileext=\"exe\") or (fileext=\"inc\") or (fileext=\"js\") or (fileext=\"htm\") or (fileext=\"html\") then\n多个未授权访问的上传页面：\n根目录、cn目录、en目录下都有PIC/upload_flash.asp?formname=Userform&editname=ProductPicc&uppath=&picclass=Product&picSize=200&filelx=asaPIC/upfile_flash1.asp?formname=Userform&editname=ProductPic&uppath=PIC&picclass=Product&picSize=200&filelx=asaPIC/upload.asp?formname=Userform&editname=ProductPic&uppath=PIC&picclass=Product&picSize=200&filelx=asa\n根据分析代码发现这个缺少判断若为asa、cer等文件呢？这里提供两种方法突破后缀名的方法。可以构造参数巧妙突破上传：【注意先访问jpg的，例如：PIC/upload_flash.asp?formname=Userform&editname=ProductPicc&uppath=&picclass=Product&picSize=200&filelx=jpg，然后再将jpg改成asa，不需要回车，然后再上传asa，否则无法上传成功】以第一个为实例测试：\n\n源代码返回文件名：\n\n\n\n*********************************************************************************************三、高危弱口令漏洞 该CMS的根目录、cn目录或en目录下存在一个Ewebeditor编辑器，使用了默认弱口令可导致修改上传文件类型而GETSHELL。编辑器的目录位于以下：\nadmin/eWebEditorforASP/admin/login.aspcn/admin/eWebEditorforASP/admin/login.aspen/admin/eWebEditorforASP/admin/login.asp[有英文版的系统才有该目录]\n\n\nEwebeditor怎么利用我就不说多了吧，大家都知道的！*********************************************************************************************四、默认数据库：\nDataBase/shop.mdbcn/DataBase/shop.mdben/DataBase/shop.mdb\n\n\n   修复方案：  不多说了，注射漏洞有一些装了安全狗，建议CNVD测试的时候官网有案例，以上均不深入咯！其次说一下通报漏洞的联系方式：\n官网：http://www.intersk.com/技术支持邮箱：support@intersk.com  投诉建议邮箱：feedback@intersk.com热线：+86-755-36959568 / 36959569        服务投诉：400-0755-469\n   版权声明：转载请注明来源 U神@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-07-20 12:16 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-15 22:08 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  @U神     \n     2014-07-15 22:33 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @袋鼠妈妈 膜拜大黑阔    \n     2014-07-15 22:42 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  看着别人的审核过了，自己还在待审核真是悲哀..顺便膜拜下V神大牛@U神     \n     2014-07-16 12:03 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @U神 是你的还是你。。    \n     2014-07-16 12:18 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @泳少 请不要撸管！谢谢    \n     2014-07-16 12:24 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @U神 你已经被揭露了    \n     2014-07-16 13:00 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @U神 谁让你在撸管。。哼    \n     2014-09-11 18:04 |    \t\t逗比 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:6        | 逗比的年代，诶油我艹)\t\t \n  U神，你又在撸了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}