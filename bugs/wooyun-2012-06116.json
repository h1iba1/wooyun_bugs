{"id": 20706, "wybug_id": "wooyun-2012-06116", "wybug_title": "南京大学主站成功入侵", "wybug_corp": "南京大学", "wybug_author": "FuckHelen", "wybug_date": "2012-04-16 17:54", "wybug_open_date": "2012-04-16 17:54", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-16：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-04-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 权限设置不当，直接loadfile读取文件 详细说明：  打开谷歌搜索南京大学。http://www.nju.edu.cn/  点开链接自动跳转到http://www.nju.edu.cn/cps/site/newweb/foreground/ 这里来了，撸了两下对网站有个基本的认识，换了个大小写不存在说明是很有可能linux或者unix的,点了两个连接发现都有变量传入，这个比较少见，我看见的一些比较好的大学主站都是静态页面，然后链接到各个分站。再接着看，打开一条新闻，查看图片的url，没有发现什么典型编辑器的痕迹。但穿的像处女不代表就是处女啊，网站也撸不下去了，撸来撸去也没看出什么。打开wvs（多久没用你了~~）开始大扫特扫，俺先去洗个澡。等我洗完澡再回来看发现wvs还没有扫完，不过我觉得没有必要继续扫下去了。因为俺扫到了注入。。 直接打开havij开始注入。很顺利的得到了一些基本信息，而且用户还是root， 我没急着去解密，先去找phpmyadmin，很可惜的是，没找到，用dirbuster扫了一遍也没有什么收获。后来我才发现原来root的密码解不出来。。。到这里似乎卡住了，于是我又去注了一下表段，同时打开wscan对http://www.nju.edu.cn/cps/site/newweb/ 来扫描目录，希望能够扫到后台。很可惜的是，我还是没有扫到。。于是我又绕回了到了root，既然找不到phpmyadmin，也不代表不能写啊，select into outfile也能写一句话进去的，但是绝对路径呢？http://www.nju.edu.cn/cps/site/newweb/foreground/show1.php?id=1'  出来了，就这么简单。下面就开始写shell啊，过程不细说了，大家都知道的，结果发现不成功啊。。GPC肯定是关闭的啊。。难道是目录不可写？（windows下的不多见，但是linux下权限分配很严格，容易出现无权写入的现象）于是开始各种换目录，换到图片目录，还是不行。。。到这里又卡了一下，于是来翻了下wvs的扫描报告，结果翻到了很可疑的东西。 妹的原来有人拿到了webshell。。心里郁闷死了，俺就这么菜。。郁闷归郁闷，还是直接loadfile读取文件，然后拿到密码，进去了。。 进去之后找到了几个马。。不过都是09年的，然后仔细翻了下目录，发现权限设置的确实好紧，目录都是755，webshell无权写入（不是root，执行whoami回显nobody），文件都是644，改都改不了，尝试chmod命令无回显，再来看文件权限依旧没有改变，找到数据库连接文件和phpmyadmin目录（原来是phpMadmin。。）root权限登录发现依旧无法select into outfile。参观了一下网站目录就走了。。就这么完了？确实完了。。。   漏洞证明：  \n\n\n\n   修复方案：  漏洞修复你懂得   版权声明：转载请注明来源 FuckHelen@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-04-16 18:15 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  作者思路有点意思    \n     2012-04-16 21:36 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  学习一下 应该给点rank的呀 呵呵    \n     2012-04-16 21:54 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @xsser 忘记通报CNVD了吧，WEBSHELL存在貌似也管的。    \n     2012-04-16 21:58 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  以前很喜欢看别人各种入侵思路。此例说明webshell里密码最好也用md5()处理一下    \n     2012-04-17 08:41 |    \t\tKk_p \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | 做白帽应做之事)\t\t \n  洞主有的地方还是值得学习一下的    \n     2012-04-17 10:45 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n   洞主这个可以做教程了，工具打包一并发了，哈~    \n     2012-04-17 15:11 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Kk_p 额外为洞主发放了一枚邀请码，洞主居然没来...    \n     2012-04-17 15:51 |    \t\tKk_p \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | 做白帽应做之事)\t\t \n  @xsser 可惜了。开放思路的屌丝特别少，应鼓励屌丝们多发发思路    \n     2012-04-18 16:37 |    \t\t随风.潜入夜 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:5        )\t\t \n  居然拿着别人的洞来提交！鄙视    \n     2012-04-18 16:38 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @随风.潜入夜 路人甲也许就是他自己~    \n     2012-04-19 00:09 |    \t\tdarksn0w \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 无折腾,不生活！)\t\t \n  @xsser 剑心，帮忙看一下他的邮箱，这文章不是作者的，被别人发过来的，邮箱PM我，好去论坛删ID.....    \n     2012-04-19 00:12 |    \t\tdarksn0w \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 无折腾,不生活！)\t\t \n  @随风.潜入夜 查出来他直接删论坛ID，不解释....    \n     2012-04-19 00:12 |    \t\tdarksn0w \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 无折腾,不生活！)\t\t \n  @一刀终情 明显不是A11来发的，被人冒发的    \n     2012-04-19 13:28 |    \t\t随风.潜入夜 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:5        )\t\t \n  @一刀终情 真正的作者是我们论坛上的一哥们。正在那里抱怨呢。。。。    \n     2012-04-19 13:28 |    \t\t随风.潜入夜 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:5        )\t\t \n  @darksn0w 你想怎么查？    \n     2012-04-21 01:57 |    \t\tdarksn0w \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 无折腾,不生活！)\t\t \n  @随风.潜入夜 只能问问剑心，看看能不能从乌云这边查到他的IP    \n     2012-04-21 02:09 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @随风.潜入夜 @darksn0w 我想说说乌云判断价值的宗旨，当时乌云是建立一个平台，想通过报告和解决厂商安全问题的同时能够有所技术沉淀，所以安全问题可能不一定是原创，譬如乌云经常有被黑的信息报告到厂商能够及时解决问题，实际上已经产生了价值，而且乌云很难去判断一个信息是否是原创或者是否是原作者，更多的希望大家都更积极主动共享一些，不只对别人对自己成长也有好处，当然我们也是很反对直接的抄袭的，我们也在建立一些监督机制，譬如第三方知情者的评分很反馈来慢慢减少这种问题，但是还是希望所有人都能更开放一些，这个氛围会更好一些。    \n     2012-04-21 02:13 |    \t\tdarksn0w \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 无折腾,不生活！)\t\t \n  @xsser 嗯，好的= =其实现在圈子就是气氛不正，我们只是希望能够尊重作者，哪怕共享署名，我们一直很支持wooyun的，也看到了中国互联网安全的情况    \n     2012-04-21 02:16 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @darksn0w =。= 添加评论，评分等的目的就是希望有个大家第三方透明的监督来压制这种，内容不错，向原作者致敬，欢迎他来乌云分享    \n     2012-04-21 08:36 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  对于普通人来说，能看到有所收获的文章，思路，就已经可以了。当然更应该提倡是自己的想法，如果是转载最好还是能带上原作者...    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}