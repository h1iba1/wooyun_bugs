{"id": 88417, "wybug_id": "wooyun-2016-0192638", "wybug_title": "绿盟、启明星辰、依讯等厂商的WAF存在上传检测bypass                                      ", "wybug_corp": "绿盟、启明星辰、依讯WAF产品", "wybug_author": "gyLinuxer", "wybug_date": "2016-04-05 17:00", "wybug_open_date": "2016-07-06 18:00", "wybug_type": "权限控制绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-10：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-06-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-06：\t细节向公众公开  简要描述： 绿盟、启明星辰、依讯等厂商的WAF存在上传检测漏洞，可利用该漏洞，绕过WAF检测，直接上传shell 详细说明：  绿盟、启明星辰、依讯等厂商的WAF存在上传检测漏洞，可利用该漏洞，绕过WAF检测，直接上传shell。或结合变filename==\"123.(0xff)a(0xff)sp\" 也可染过asp的后缀名黑名单检测，也是微软asp的漏洞   漏洞证明：  具体利用 将上传表单中的filename=\"xxx.asp\" 变为filename(0xff等)=\"123.asp\" alt=\"无标题.png\" />xx.asp\"即可绕过WAF检测，成功上传!或者变为filename==\"123.(0xff)a(0xff)sp\" 也可染过asp的后缀名黑名单检测，也是微软asp的漏洞如filename?=\"xxx.asp\"  其中的?为0xff等非可打印字符的16进制。\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 gyLinuxer@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2016-04-07 17:51 厂商回复： CNVD未直接复现所述情况，已由CNVD通过软件生产厂商公开联系渠道向其邮件和电话通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-05 17:07 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:259 漏洞数:96        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  绿盟、启明星辰、依讯等厂商的WAF SQL注入检测bypass，适用于post方式的表单中的注入，将sql语句中所有空格用(0x00-0x19)代替，即可bypass其SQL注入检测。    \n     2016-04-05 17:18 |    \t\tMark0smith \t\t\t( 普通白帽子  |\t\t\t        Rank:178 漏洞数:72        )\t\t \n  楼上霸气    \n     2016-04-05 17:20 |    \t\tgyLinuxer \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:3        )\t\t \n  @随风的风 兄弟，你干嘛啊？    \n     2016-04-05 17:21 |    \t\tBreaker \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:1        | NSFOCUS)\t\t \n  233333    \n     2016-04-05 17:22 |    \t\t安全狗(乌云厂商)\t\t \n  欢迎你来我这提交漏洞。    \n     2016-04-05 17:23 |    \t\tgyLinuxer \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:3        )\t\t \n  @安全狗 谢谢，愿意效劳！    \n     2016-04-05 17:35 |    \t\tsangfor.org \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:26        | 天下熙熙，皆为利来；天下攘攘，皆为利往...)\t\t \n  我司WAF呢    \n     2016-04-05 17:35 |    \t\t伤心的猫猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:32        | @sangfor,@qq,@alibaba,@baidu)\t\t \n  @gyLinuxer 这叫漏洞？？    \n     2016-04-05 17:37 |    \t\tgyLinuxer \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:3        )\t\t \n  @伤心的猫猫 兄弟，就是绕过WAF的后缀名检测，属于WAF的检测漏洞吧。^_^    \n     2016-04-06 05:36 |    \t\t指尖上的故事 \t\t\t( 普通白帽子  |\t\t\t        Rank:806 漏洞数:180        | 放手不是我们不合适 | 而是成就你们更适合)\t\t \n  666666666    \n     2016-04-10 21:06 |    \t\tExplo1t \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:9        | 流生若川，不要小看人生啊！)\t\t \n  渍渍    \n     2016-04-22 12:07 |    \t\t龙腾虎跃 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:5        | 00后)\t\t \n  我没猜错的话，应该是没有过滤上传asp|aspx|php|jsp|等后缀的上传。    \n     2016-04-22 16:27 |    \t\tinner \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  连项目都说出来了，太直接了    \n     2016-04-25 06:59 |    \t\tstudy_vul \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 我有乌云id了，我马上就要牛叉起来了)\t\t \n  目测 楼主要要火，估计已经拿到绿盟的offer了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}