{"id": 3422, "wybug_id": "wooyun-2014-059786", "wybug_title": "途牛旅游网任意用户密码重置", "wybug_corp": "途牛旅游网", "wybug_author": "于小木", "wybug_date": "2014-05-07 17:26", "wybug_open_date": "2014-06-21 17:27", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-21：\t细节向公众公开  简要描述： 可以修改途牛旅游网主站任意用户的密码，不能透露再多了 详细说明：  在途牛网上报了个名，当时随意设置了个密码，游玩回来之后途牛提醒我做出评论即可获得积分和现金，记不得密码怎么办呢，重置密码的时候抓包发现如下报文\n\n打开www.tuniu.com/u/modPasswordSubmit，post“password=123456789&tel=1381682XXXX”如下\n\n修改post中的tel值，既可以修改该用户的密码了。具体怎么知道手机号码是否被注册过呢，注册时候会提醒你，如下：\n\n您感受下？   漏洞证明：  在途牛网上报了个名，当时随意设置了个密码，游玩回来之后途牛提醒我做出评论即可获得积分和现金，记不得密码怎么办呢，重置密码的时候抓包发现如下报文\n\n打开www.tuniu.com/u/modPasswordSubmit，post“password=123456789&tel=1381682XXXX”如下\n\n修改post中的tel值，既可以修改该用户的密码了。具体怎么知道手机号码是否被注册过呢，注册时候会提醒你，如下：\n\n您感受下？   修复方案：  开发大大肯定知道怎么修复的吧？我的思路是把重置密码的页面和手机验证码一起验证不就可以了ps:上次明明回复已修复...   版权声明：转载请注明来源 于小木@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-05-07 17:48 厂商回复： 正在确认处理中，感谢 @路人甲。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-07 17:31 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n   惨..。厂商要负责任点呀，人手不够来乌云招几个回去.... 前提是待遇要给力啊    \n     2014-05-07 17:51 |    \t\tFocusstart \t\t\t( 普通白帽子  |\t\t\t        Rank:574 漏洞数:163        | 努力让某某某成为最幸福的女人！)\t\t \n  @zeracker  待遇要给力真是给力！    \n     2014-05-07 17:52 |    \t\t假马 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:18        | 我存在,你婶婶的脑海里.)\t\t \n  我想我已经知道了！！@途牛旅行网   不厚道 我的才给10R  还没礼物    \n     2014-05-07 17:56 |    \t\t于小木 \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:4        )\t\t \n  @假马 会有什么礼物？能送一个欧洲游的路线吗？    \n     2014-05-07 18:00 |    \t\t途牛旅游网(乌云厂商)\t\t \n  @zeracker 招人中，求推荐。    \n     2014-05-07 18:02 |    \t\t假马 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:18        | 我存在,你婶婶的脑海里.)\t\t \n  @途牛旅游网 厂商修复完了没！    \n     2014-05-07 18:28 |    \t\t途牛旅游网(乌云厂商)\t\t \n  已经修复，感谢各位白帽子。 这次的问题是因为工程师在验证的时候tel 和 email 用的一个方法，在||条件下，因为email为空，导致 $email == $_SESSION['changePwEmail'] 成立，从而使得验证被跳过，导致了这次bug的发生。    \n     2014-06-21 23:43 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @途牛旅游网 接口规范没有呀，测试也不充分    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}