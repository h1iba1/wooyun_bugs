{"id": 46407, "wybug_id": "wooyun-2014-084953", "wybug_title": "豪杰大眼睛处理TGA文件格式缓冲区溢出漏洞（EIP可控）", "wybug_corp": "北京世纪豪杰计算机技术有限公司", "wybug_author": "光刃", "wybug_date": "2014-11-27 14:47", "wybug_open_date": "2015-02-25 14:48", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["缓冲区溢出"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-27：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-02-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 软件介绍：http://baike.baidu.com/view/222352.html下载地址：http://www.onlinedown.net/soft/2704.htmhttp://dl.pconline.com.cn/html_2/1/114/id=1879&pn=0.html在处理TGA文件格式时候存在缓冲区溢出漏洞，eip可控。 详细说明：  poc：\n0200080000000064 0064000100010010FFFFFFFFFFFFFFFF FFCCCCCCCCFFFF\n把这些数据以16进制保存在文件中，重命名为poc.tga环境配置：windows xp sp3豪杰大眼睛2.5版本（不能先打开豪杰再载入图片，那样不会成功触发漏洞。而是对着图片直接右键：用大眼睛浏览）安装后，需要在工具-注册图像类型中注册所有的图片格式。\n\n在poc样本上右键，选择“用大眼睛预览”\n\n正常情况下程序会因崩溃而闪退，用OD调试会发现，EIP已经修改为我们定义的数值CCCCCCCCH\n\n。   漏洞证明：  poc：\n0200080000000064 0064000100010010FFFFFFFFFFFFFFFF FFCCCCCCCCFFFF\n把这些数据以16进制保存在文件中，重命名为poc.tga偏移19H处的CCCCCCC为要控制的EIP地址，这里用CCCCCCCC表示。\n\neip已经被修改   修复方案：  检测样本的有效性。   版权声明：转载请注明来源 光刃@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-11-27 14:52 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  屌毛    \n     2014-11-27 15:04 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  用你开发的工具，搞出来的？    \n     2014-11-27 15:06 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  @贫道来自河北 yes    \n     2014-11-27 15:22 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  @光刃 卧槽 你的那个工具这么好用啊，我也用试试看    \n     2014-11-27 16:46 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  光哥复活了    \n     2014-11-28 15:43 |    \t\t孤月寒城 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        )\t\t \n  膜拜光刃牛    \n     2014-12-04 01:02 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @贫道来自河北 推荐一款paimei秒杀他eaayfuzzer    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}