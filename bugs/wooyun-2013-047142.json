{"id": 59497, "wybug_id": "wooyun-2013-047142", "wybug_title": "新浪博客某处鸡肋越权及CSRF漏洞", "wybug_corp": "新浪", "wybug_author": "q601333824", "wybug_date": "2013-12-27 10:58", "wybug_open_date": "2014-02-10 10:59", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口未加权限认证", "越权操作", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-10：\t细节向公众公开  简要描述：  详细说明：    1.新浪博客拉黑功能存在平行权限漏洞+CSRF漏洞   拉黑功能接口     http://footprint.cws.api.sina.com.cn/del.php?pid=1&uid=[UID参数]&deleteuid=[被来黑的UID参数]&inblack=1&varname=requestId_71119117   2.看图片应该知道了，为了测试效果，用了360极速浏览器和火狐浏览器     第一个号，360极速，第二个号是火狐浏览器 \n\n     5.遍历修改uid或者遍历修改deleteuid，就是一个人在不知道的情况下把所有人拉黑，或者被所有人拉黑    6.还有的就是这个接口存在CSRF,我开始以为&varname是防CSRF的参数，但是，下面两张图，说明&varname参数只是个摆设 \n\n     7. &varname参数有跟没有一样，        (1).http://footprint.cws.api.sina.com.cn/del.php?pid=1&uid=3953772058&deleteuid=1878520072&inblack=1&varname=requestId_84750103        (2).http://footprint.cws.api.sina.com.cn/del.php?pid=1&uid=3953772058&deleteuid=1878520072&inblack=1        结果都是A00006成功注：经测试uid或deleteuid其中一个必须是登陆者的，所以此处只能是拉黑别人或被人拉黑，可csrf，越权只能是双方，不能影响第三方。   漏洞证明：   \n\n\n\n   修复方案：  你是专业   版权声明：转载请注明来源 q601333824@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-12-27 13:41 厂商回复： 感谢关注新浪安全，马上跟进处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-27 12:00 |    \t\tq601333824 \t\t\t( 普通白帽子  |\t\t\t        Rank:217 漏洞数:49        | 出自《丹特丽安的书架》---吾问汝,汝为人否...)\t\t \n  ....这个没试=_=    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}