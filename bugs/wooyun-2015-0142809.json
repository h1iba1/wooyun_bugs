{"id": 67455, "wybug_id": "wooyun-2015-0142809", "wybug_title": "海军工程大学Getshell", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-09-24 22:45", "wybug_open_date": "2015-11-13 09:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-29：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-10-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-13：\t细节向公众公开  简要描述： 海军工程大学官网漏洞导致Getshell 详细说明：  网站使用phpcms注册账号登陆进去前台。\n\n访问http://**.**.**.**/index.php?m=member&c=index&a=account_manage_avatar&t=1查看源代码获取密文\n\nbase64解密密文得到\n\nhttp://**.**.**.**/phpsso_server/index.php?m=phpsso&c=index&a=uploadavatar&auth_data=v=1&appid=1&data=b0adVAhUVlUCAAUFUg5TB1MJDFNSBFFbUlADVApAXwEFVBYUSzsHEEZYal4HTww0MXFgMQ8eM1wrBGwHRFdBE08MQFZeHBEiSHdARVQBZw修改其中uploadavatar为getapplist访问:http://**.**.**.**/phpsso_server/index.php?m=phpsso&c=index&a=getapplist&auth_data=v=1&appid=1&data=228cVVVRBQUDVgIDVAFSVFQJVAAIVwRbBVUCWFxHDFQMAx8VFj5UQEcObVgBQA1nNnE4YlVNZlx8AW0LElASRkZbSVcDGUJySSFHQ1IOZg得到authkey\n\nVSIYRmxUdN2Z2vbwvwmp2fxwGzGup67V构造注射：\n\n得到后台账号密码\n\n登陆后台利用数据源 插一句话木马到数据库拿到shellhttp://**.**.**.**/index.php?m=dbsource&c=call&a=get&id=9密码seo   漏洞证明：  \n\n   修复方案：  更新网站程序清除木马   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-09-29 09:46 厂商回复： CNVD确认所述情况,已由CNVD向教育网应急组织——赛尔网络公司通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}