{"id": 17223, "wybug_id": "wooyun-2015-0108058", "wybug_title": "邮箱大师可导致用户邮箱通讯录泄露（可在不安全网络利用）", "wybug_corp": "网易", "wybug_author": "Nicky", "wybug_date": "2015-04-15 10:21", "wybug_open_date": "2015-07-15 15:54", "wybug_type": "用户敏感数据泄漏", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感数据未加密", "手机软件安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-19：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-15：\t细节向公众公开  简要描述： 邮箱大师存在设计缺陷可导致用户邮箱通讯录泄露 详细说明：  1.这是个很奇怪的问题，我使用邮箱大师登录我的网易邮箱(同时测试了hotmail)，因为默认使用HTTPS（也许是网易自己写的协议）传输，所以整个过程通过抓包工具是无法抓到的。2.但当我使用邮箱大师登录我的QQ邮箱（同类的如@vip.qq.com,@foxmail.com），使用抓包工具却可以抓到我的邮箱通讯录(来自https://dav.qq.com域）,使用的是PROPFIND和REPORT请求（相关协议源码位于 com.netease.mobimail.net.protocol.a.f），返回XML格式的邮箱通讯录信息   漏洞证明：  \n\n\n\n反编绎分析了下源码，发现多处重写了onReceivedSslError方法和checkServerTrusted方法，会忽略证书错误继续加载和信任所有证书，但具体是哪处影响了https://dav.qq.com还待分析\n\n\npackage com.netease.mobimail.net.protocol.activesync;import java.security.cert.X509Certificate;import javax.net.ssl.X509TrustManager;final class b implements X509TrustManager {    b() {        super();    }    public void checkClientTrusted(X509Certificate[] arg1, String arg2) {    }    public void checkServerTrusted(X509Certificate[] arg1, String arg2) {//此方法为空，没检测服务器证书有效性    }    public X509Certificate[] getAcceptedIssuers() {        return new X509Certificate[0];    }}\n   修复方案：  你们更专业   版权声明：转载请注明来源 Nicky@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-04-16 15:52 厂商回复： 感谢您对网易的关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-15 10:29 |    \t\t天地不仁 以万物为刍狗 \t\t\t( 普通白帽子  |\t\t\t        Rank:977 漏洞数:264        | 天地本不仁 万物为刍狗)\t\t \n  前排····    \n     2015-04-15 10:30 |    \t\tzcy \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:15        )\t\t \n  打脸了-。-    \n     2015-04-15 10:34 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  瞬间打脸    \n     2015-04-15 10:34 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  直接甩脸上了，前排哈哈！！！    \n     2015-04-15 10:36 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  啪！啪！啪！帽子再打我一次！    \n     2015-04-15 10:41 |    \t\ther0ma \t\t\t( 核心白帽子 |\t\t\t        Rank:598 漏洞数:84        | 专注小厂商三十年！)\t\t \n  后排膜拜大婶！    \n     2015-04-15 10:42 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  好疼    \n     2015-04-15 10:48 |    \t\tbey0nd \t\t\t( 普通白帽子  |\t\t\t        Rank:895 漏洞数:142        | 相忘于江湖，不如相濡以沫)\t\t \n  打脸打的啊，说好的黑客都放弃了呢    \n     2015-04-15 10:56 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @zeracker 3哥你的广告:p    \n     2015-04-15 10:57 |    \t\tB1gstar \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:6        | 向各位学习来了。)\t\t \n  http://ww3.sinaimg.cn/bmiddle/005Jtae7gw1er5d5q0ujhj30hs0rsn4g.jpg  在这里    \n     2015-04-15 11:20 |    \t\tsco4x0 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:13        | O_o)\t\t \n  仿佛听到了清脆的耳光声    \n     2015-04-15 11:23 |    \t\tchock \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:15        | 今夜我们都是wooyun人，我们一定要收购长亭)\t\t \n  黑客大侠求放过啊，我再也不敢吹牛逼了    \n     2015-04-15 11:23 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  脸好痛~    \n     2015-04-15 11:28 |    \t\t暗羽 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:6        | 喵呜，给人类的智商跪了)\t\t \n  啪啪啪    \n     2015-04-15 12:44 |    \t\t庙口大王 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:6        | 呵呵)\t\t \n  安全、让人放心    \n     2015-04-15 12:57 |    \t\tclass \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | class)\t\t \n  好痛，能请点好不好，欧巴。    \n     2015-04-22 20:09 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  这脸打的啪啪响啊    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}