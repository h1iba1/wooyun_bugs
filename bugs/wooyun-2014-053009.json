{"id": 5586, "wybug_id": "wooyun-2014-053009", "wybug_title": "我是如何在艺龙旅行网任意金额购买商品的", "wybug_corp": "艺龙旅行网", "wybug_author": "小人物Reno", "wybug_date": "2014-03-07 12:24", "wybug_open_date": "2014-03-07 19:27", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["你们比我懂多了"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 上班无聊就到处逛，耍手机，结果把我吓尿了！O(∩_∩)O~（我用的UC浏览器！随便改了几个，付了一个0.1元的车票！），。。如下： 详细说明：  \n\n\n\n\n\n在手机任意浏览器上，打开百度，搜索“艺龙网”，进入官网随便注册一个号，登录进去，然后，，，，，，我们点击“火车票那一栏” 进去任意 选购任意地点的火车票， 最后我们点击。。“预定”  关键的来了！！！！你会看见手机浏览器上方的地址栏里，类似这张票的地址“        http://m.elong.com/train/order?durationtime=5:36&startdate=201403080700&startstation=%E5%8C%97%E4%BA%AC%E5%8D%97&enddate=201403081236&endstattion=%E4%B8%8A%E6%B5%B7%E8%99%B9%E6%A1%A5&seatlowprice=933&seatname=%E4%B8%80%E7%AD%89%E5%BA%A7&seatcode=M&trainno=G101           ”（这张票的金额是seatlowprice=933，933元）有购票金额的明文参数。 然后我们就把参数随意改，0元0.1元0.111111元都可以，   你们懂的!最后我就花了0.1元付款款，，，，   漏洞证明：  \n\n\n\n\n\n我们点击“火车票那一栏” 进去任意 选购任意地点的火车票， 最后我们点击。。“预定”  关键的来了！！！！你会看见手机浏览器上方的地址栏里，有购票金额的明文参数。 然后我们就把参数随意改，0元0.1元0.111111元都可以，   你们懂的!最后我就花了0.1元付款款，，，，   修复方案：  你们比我懂！   购票金额就在地址栏明文摆着，求虐的节奏啊！ 还有身份过滤不严，名字和身份证号貌似乱填都行，试了一个张三，   。。。。。@乌云 邀请码。。上次那个四川大学就业网的直接闷死了啊？虽然我是路人甲《《   版权声明：转载请注明来源 小人物Reno@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-03-07 19:27 厂商回复： 感谢 @小人物Reno，经过我们确认，这个地方订单只是记录，后续艺龙要通过铁路的订票系统才能成功出票，这里如果金额不对的话，出票会失败，然后艺龙告知用户出票失败并退款，这是正常的业务流程，除金额不对以外还有其他多种退款逻辑存在（火车票，你懂的），而因用户篡改数据导致的出票失败相信退款也是厚到的做法。这个漏洞不会给艺龙用户带来经济损失、不会给攻击者带来经济利益，也不会给艺龙带来经济损失，为避免误会，我们选择驳回这个漏洞。但出于用户体验考虑，我们后面也会修复这个问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-07 22:11 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  厂商很靠谱！    \n     2014-03-07 22:53 |    \t\t乌云 \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:14        | a)\t\t \n  @xsser +1    \n     2014-03-08 02:06 |    \t\t小人物Reno \t\t\t( 普通白帽子  |\t\t\t        Rank:471 漏洞数:110        | X)\t\t \n  @xsser. @乌云   这是打击神奇的路人甲的节奏么？。。如果我改的金额不是太明显，相差不大，会不会可以去领票呢？？！ 0  rank太没意思了啊。    \n     2014-03-08 15:25 |    \t\t乌云 \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:14        | a)\t\t \n  @小人物Reno 厂商已经回复非常明确：金额和12306对不起来不会出票，这东西不是你给多少钱的问题，是12306和艺龙之间的数据校验，如果实际收到金额和12306同步的时候发现不一致，则订单失效退款。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}