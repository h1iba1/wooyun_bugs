{"id": 56503, "wybug_id": "wooyun-2014-057527", "wybug_title": "水晶DJ网存在存储型XSS漏洞", "wybug_corp": "水晶DJ网", "wybug_author": "夏殇", "wybug_date": "2014-04-18 16:53", "wybug_open_date": "2014-06-02 16:54", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-06-02：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 水晶DJ网存在存储型XSS，可无声无息劫持任意浏览者cookie（无弹窗触发XSS,杀人于无形）。网站浏览量挺大的，做了一个小测试，十几分钟至少可截取几百用户cookie。也曾劫持过网站管理员cookie…… 详细说明：  没有对用户昵称进行过滤，导致存储型XSS漏洞。只要在用户昵称处插入一句XSS后台代码，所有该用户留痕之处皆是坑。简单的挖掘XSS没多少好说的，说多都是泪。直接上操作图吧。\n\n虽然在页面看不到昵称的完整正常显示，也看不到弹出的XSS窗口。但是XSS已在无声无息中触发了。O(∩_∩)O哈哈~\n\n\n\n刚才听《只愿得一人心》蛮好听的，这首歌就在首页被推荐的地方。我赞了一下，然后这个就留下了我的昵称了。不可预料的事情发生了！！！十几分钟，邮件收了几百封！！！这首歌真火啊！！！\n\n   漏洞证明：  有图有真相。\n\n邮箱收了70多封的时候，被QQ邮箱认为是垃圾邮件了吧？这不，后来把cookie扔垃圾箱了。\n\n很久以前劫持到的管理的cookie，可惜过期了呢。嘿嘿，管理登陆的ip是湖南滴，还是Mac土豪啊！！！本来想再劫持到管理员cookie再提交漏洞的，但是我的邮箱和XSS后台要爆了啊！！！以后有机会再套套管理cookie，哈哈。\n\n随便挑两用户cookie登陆下。（发现opera浏览器对cookie的管理很方便有木有？！）\n\n\n\n   修复方案：  你们比我懂，过滤~过滤~   版权声明：转载请注明来源 夏殇@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}