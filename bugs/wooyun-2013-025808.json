{"id": 11147, "wybug_id": "wooyun-2013-025808", "wybug_title": "爱爱医任意上传", "wybug_corp": "爱爱医", "wybug_author": "roofsec", "wybug_date": "2013-06-13 05:34", "wybug_open_date": "2013-07-28 05:34", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-28：\t细节向公众公开  简要描述： 严重啊严重 详细说明：  http://www.yinei.com/修改头像处，只限制了100x100的  没有控制后缀名只要copy 一句话到一张大于100x100的GIF图像 即可拿到shell\n\n\n\n权限忒大了\n\n数据就面临全军覆没的凤险  (我没拖)\n\n   漏洞证明：  详细说明   修复方案：  加强对分站安全的监控严格分配权限无节操地求礼物   版权声明：转载请注明来源 roofsec@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-06-13 09:44 厂商回复： 万分感谢，我们技术已经受理，目前正在处理... 最新状态： 2013-06-13：此漏洞已处理！  ", "replys": "漏洞评价：\n评论\n     2013-07-28 14:00 |    \t\tIXY \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | 小菜来学习的)\t\t \n  @roofsec 只要copy 一句话到一张大于100x100的GIF图像 即可拿到shell  这是什么意思 一张太大的图片会被截取 如何保证不被截取掉一句话呢    \n     2013-07-28 14:43 |    \t\troofsec \t\t\t( 普通白帽子  |\t\t\t        Rank:151 漏洞数:19        )\t\t \n  @IXY 它只判断了不能少于100x100 没有限制多大。    \n     2013-07-28 15:23 |    \t\tIXY \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | 小菜来学习的)\t\t \n  @roofsec 懂了 弄错了 因为很多论坛是判断大于多少 然后其它截断掉 多谢    \n     2013-07-28 22:46 |    \t\troofsec \t\t\t( 普通白帽子  |\t\t\t        Rank:151 漏洞数:19        )\t\t \n  @IXY 有的经过二次处理的不是源图片 比如加了水印..    \n     2013-07-28 22:57 |    \t\t习惯一个人 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:6        | 动荡年代,我只图个安宁…)\t\t \n  对于截断的，该怎么解决呢？ 如果搞到没截断的突破地址？ 难道爆破？还是传个100x100的就不截断了？    \n     2013-07-29 09:26 |    \t\troofsec \t\t\t( 普通白帽子  |\t\t\t        Rank:151 漏洞数:19        )\t\t \n  @习惯一个人 这里只是特殊情况，有些上传后的地址是有规律的，比如上传个gif上去 被处理过的地址是20121212_100x100.gif   我i们上传的文件可能就是20121212.gif，具体都要看环境而定。    \n     2013-07-30 00:28 |    \t\t习惯一个人 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:6        | 动荡年代,我只图个安宁…)\t\t \n  @roofsec 额，我遇到个站的情况是，他把一个图片给截图3个，3个不一样的大小，比如，200x200,160x160,80x80 图片的地址也是/200x200.jpg 、/160x160.jpg、 /80x80.jpg 这样的，可还有办法搞到原始地址？ 还是他这剩下这几个大小的地址了吗？ 亲，求Q号，交流交流。我Q 51284343    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}