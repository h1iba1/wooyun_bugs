{"id": 4700, "wybug_id": "wooyun-2014-049356", "wybug_title": "新版安全狗上传拦截百分百绕过", "wybug_corp": "安全狗", "wybug_author": "cmd2k", "wybug_date": "2014-01-20 15:19", "wybug_open_date": "2014-04-20 15:19", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意", "文件上传安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-24：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-20：\t细节向公众公开  简要描述： 突破安全狗上传拦截,秒杀小狗 详细说明：  绕过安全狗上传拦截shell后缀安全狗会在上传的时候拦截.php .jsp .asp .aspx 等列如 fck中解析安全狗肯定是百分百拦截 而 新版安全狗连文件名为.asp 这些都会拦截上传的时候可以使用burp 截取数据 修改 添加c.asp 安全狗验证上传机制是 如果同时上传 只会对第一次上传的文件进行检查 只要第一次的为图片 就不会对第二次的进行检测。这个上传只针对于网站源码本身允许上传一些shell后缀。搞定后打开c.asp 是500服务器错误 过狗刀连接。   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  修改上传拦截机制，只检测首次上传文件格式是败笔   版权声明：转载请注明来源 cmd2k@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2014-01-21 17:37 厂商回复： 后续版本会进行修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-20 15:20 |    \t\thacker@sina.cn \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:27        | ANONYMOUS)\t\t \n  目测最多5rank    \n     2014-01-20 15:23 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @hacker@sina.cn 目测找到狗的软肋    \n     2014-01-20 15:49 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  @xsser 目测抓住了狗的要害……    \n     2014-01-20 16:16 |    \t\t忆苦思甜 \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:25        )\t\t \n  mark    \n     2014-01-20 16:17 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  坐等细节！    \n     2014-01-20 17:33 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  我是冲着百分百来的。。    \n     2014-01-20 19:43 |    \t\tcmd2k \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 学习,努力,加油)\t\t \n  100%X100%    \n     2014-01-20 23:45 |    \t\t黑吊丝 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:4        | 木心木肺黑吊丝)\t\t \n  目测有打狗棍了    \n     2014-01-21 23:04 |    \t\tGosuto \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | )\t\t \n  @hacker@sina.cn 真会猜    \n     2014-01-21 23:10 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Gosuto 他是未来的核心    \n     2014-01-21 23:20 |    \t\tGosuto \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | )\t\t \n  @wefgod @hacker@sina.cn 核心大牛 求抱大腿    \n     2014-01-22 15:56 |    \t\tLeon \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:6        | 永无宁日啊)\t\t \n  @安全狗  我已对你失望了，WPCPlugin64.dll 这个模块害我不浅啊,莫名的出现好多错误，你们也解决不掉错误。卸载了之后就好了！已经在试用别家产品。感谢这一年多的陪伴啊!    \n     2014-04-20 16:08 |    \t\tstudy_vul \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 我有乌云id了，我马上就要牛叉起来了)\t\t \n  这个都低 真是没有天理了 通用绕过方法呀    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}