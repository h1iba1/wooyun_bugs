{"id": 5114, "wybug_id": "wooyun-2014-048025", "wybug_title": "红米手机金山清理大师应用内存清理权限泄露漏洞", "wybug_corp": "小米科技", "wybug_author": "somebody365", "wybug_date": "2014-01-06 14:57", "wybug_open_date": "2014-04-03 14:58", "wybug_type": "非授权访问/认证绕过", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全", "内存清理", "权限泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-11：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-03：\t细节向公众公开  简要描述： 红米手机中的Android应用程序金山清理大师3.8.0版本存在权限泄漏漏洞，泄露的权限为自定义权限android.permission.RESTART_PACKAGES，用来结束进程来达到清理内存的目的。当没有申请此权限的app向金山清理大师发送相应的intent时，便可以结束后台运行的部分app进程。 详细说明：  金山清理大师暴露了com.cleanmaster.appwidget.WidgetService服务组件（详见下图），当向此服务发送action为com.cleanmaster.appwidget.ACTION_FASTCLEAN的intent时，便可结束后台运行的一些app进程。\n\n   漏洞证明：  实验手机为红米手机，详细信息见下图：\n\n发送intent前，用ps命令查看进程信息，如下：\n\n发送intent后，用相同的方法查看进程，如下：\n\n比较两次ps命令得到的进程信息发现，上图红框中的进程被杀掉。   修复方案：  对金山清理大师app暴露出的com.cleanmaster.appwidget.WidgetService服务组件进行修补，设置exported属性为false（详见下图），即只允许内部组件访问，不允许外部第三方的app访问，即可修补该漏洞。\n\n   版权声明：转载请注明来源 somebody365@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-04-03 14:58 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-06 16:36 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 承接:钻井，架工，木工，电工，水暖工，力...)\t\t \n  神奇的路人甲    \n     2014-01-06 17:31 |    \t\tsomebody365 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | android安全)\t\t \n  @雷锋 兄台，怎么讲？    \n     2014-01-28 15:52 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  被忽略了？@somebody365 你没注册的时候是显示的路人甲    \n     2014-02-22 15:37 |    \t\tsomebody365 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | android安全)\t\t \n  @wefgod 何时可以戴帽子？rank达到多少呢？    \n     2014-02-22 15:50 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @somebody365 你看排行就知道了    \n     2014-04-03 15:30 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @somebody365 10个洞子戴上绿色帽子~    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}