{"id": 47435, "wybug_id": "wooyun-2014-086726", "wybug_title": "中国工控网任意用户密码重置漏洞", "wybug_corp": "中国工控", "wybug_author": "0x 80", "wybug_date": "2014-12-11 11:13", "wybug_open_date": "2015-01-25 11:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "认证设计不合理", "设计缺陷", "手机短信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-11：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-01-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 任意用户密码重置漏洞无聊玩玩 详细说明：  直接访问http://nuser.gongkong.com/user/Activation/2815193这里就出现问题了其中的ID是代表会员的ID名字，这里可以任意修改邮箱地址替换ID可以找到其他不同的用户，没有任何的加密比如当前用户是您注册的手机号为13501739886，若确认此号码有效，请发送验证码短信那么修改我的邮箱地址，让邮箱地址发到邮箱，这时候\n\n我已经修改了，这时候，值得注意的是，不能在这里重置我们在登录口，忘记密码输入邮箱：http://nuser.gongkong.com/user/getmypass输入我改掉的邮箱\n\n接收到邮件\n\n您在工控网的验证码是：C9104E，请您于半小时内输入该验证码验证。输入上去随便改成12345678\n\n\n\n成功了接着输入我的邮件466196038@qq.com 12345678登录进去的却是另外1个用户就是当前的这个了\n\n============================================好吧,乌云是个不错的平台,一直要求讲清楚我就讲清楚这样大家也玩得愉快首先我们改掉其他的一个用户换1个比如http://nuser.gongkong.com/user/Activation/2815190另外1个了这时候,还是老规矩您注册的手机号为13093711385，若确认此号码有效，请发送验证码短信（免费）；若此号码不对，请更改手机号码。如果他对邮箱有重复绑定的限制，这时候只需要拿其他邮箱即可了=====================绑定的肯定是登录当前的用户了那么我们马上注册1个163的邮箱用于修改这个用户的，也就是http://nuser.gongkong.com/user/Activation/2815190\n\n由于是他单个绑定，我们只需要利用其他邮箱进行修改绑定即可，这个原理很简单申请个QQ号邮箱吧这是我的申请邮箱接着还是老规矩，先改掉这个用户的邮箱申请成功，您获得号码：3068742713密码77882501453这样我们先开通QQ邮箱你的邮箱3068742713@qq.com已开通。接着修改邮箱地址尊敬的weijin218，您好！  感谢您成为中国工控网的会员！  请点击下面的链接完成安全账号激活：  http://nuser.gongkong.com/user/BindEmailByValidCode?id=2815190&email=3068742713@qq.com&ecode=2BAE8C  (如果链接无法点击，请将它拷贝到浏览器的地址栏中)  谢谢您的加入！  这时候，访问一次老规矩，遗忘\n\n\n\n新申请的也收到验证码，立马修改密码\n\n也成功了登录看看3068742713@qq.com  7788250\n\n值得注意的是，这时候我们成功更改了这个用户的密码你们都应该看懂了。呵呵====================================   漏洞证明：  \n\n   修复方案：  你们懂的   版权声明：转载请注明来源 0x 80@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2015-01-26 12:04 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  更改手机号码也一样    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}