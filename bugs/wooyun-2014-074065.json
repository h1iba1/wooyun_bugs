{"id": 51570, "wybug_id": "wooyun-2014-074065", "wybug_title": "YiDacms 最新版信息泄露及绕过口令暴力操作后台", "wybug_corp": "yidacms.com", "wybug_author": "xfkxfk", "wybug_date": "2014-08-27 17:06", "wybug_open_date": "2014-11-25 17:08", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "设计缺陷", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-30：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-25：\t细节向公众公开  简要描述： YiDacms最新版存在信息泄露，以及绕过口令暴力操作后台任意功能 详细说明：  易达CMS 企业建站系统当前最新版本是：YidaCms X3.2（20140718）版第一处漏洞：服务器信息泄露：文件：/Yidacms/admin/admin_syscome.asp\n<%@language=\"vbscript\" codepage=\"65001\"%><%'※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※'※                                                            ※'※  易达CMS企业建站系统、易达WAP手机建站系统                  ※'※  软件由哈尔滨伟成科技有限公司开发完成                      ※'※  著作权登录号：2012SR001955     网址：http://yidacms.com   ※'※  软件享有著作权，未经公司同意禁止去除版权信息或出售源码。  ※'※                                                            ※'※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※※option explicitresponse.buffer = trueserver.scripttimeout=\"2000\"on error resume nextdim starttime:starttime=timer()dim vbcrlf:vbcrlf=chr(32)&chr(10)dim server_os,server_cpu,server_cpusdim WSshell,isobjver\n没有判断后台权限,可以直接访问服务器详细信息建议加上后台权限判断访问：\n<!--#include file=\"CheckAdmin.asp\" -->\n这里泄露的信息就是一个服务器探针，具体见截图：服务器概况：http://10.65.40.6/Yidacms/admin/admin_syscome.asp?stype=server_info\n\n服务器支持组件：http://10.65.40.6/Yidacms/admin/admin_syscome.asp?stype=com_list\n\n服务器速度：http://10.65.40.6/Yidacms/admin/admin_syscome.asp?stype=speed_info\n\n这些服务器的信息还是非常重要的。第二处绕过口令暴力操作后台YiDacms后台登陆有一个管理员密码，有一个口令这个口令默认是12345，但是大部分应该是会修改的但是后台的权限判断处，并没有判断此口令我们来看看判断后台权限的文件：/Yidacms/admin/CheckAdmin.asp\nusername = login_Str(request.Cookies(\"username\"))password = login_Str(request.Cookies(\"password\"))cookies_md5 = request.Cookies(\"cookies_md5\")dim admin_name,admin_pass,admin_qx,admin_aqxset rs = server.createobject(\"adodb.recordset\")sql=\"select * from shuaiweb_vipadministrator where username='\"&username&\"'\"rs.open sql,dbok,1,1\tadmin_name = rs(\"username\")\tadmin_pass = rs(\"password\")\tadmin_qx = rs(\"wait_ader\")\tadmin_aqx = rs(\"wait_adyi\")rs.Closeset rs=nothingif cookies_md5 <> left(MD5(admin_name&admin_pass),10) then\tresponse.write \"checkadmin.asp-登录超时，请重新登录!\"\tresponse.cookies(\"username\") = \"\"\tresponse.cookies(\"password\") = \"\"\tresponse.endend if\n这里根据cookie中的username查询处此username对应的用户名密码，然后将用户名密码进行一次md5去10位，再跟cookie中的cookies_md5进行对比，如果相等即可操作后台那么这里的username从cookie中获取，我们可控，这里cookie中的cookies_md5也是可控的那么只要我们的username存在，只需要爆破提交cookies_md5即可这里的cookies_md5为10为字符串，破解还是可以的。如后台修改网站基本设置：http://10.65.40.6/Yidacms/admin/admin_system.aspusername=admin，是存在的然后暴力提交cookies_md5的值即可。\n\n其他地方的后台操作，同样。   漏洞证明：  来一张官方demo的服务器探针信息：http://wap.yidacms.com/yidawap/syscome.asp服务器信息\n\n用户信息：http://wap.yidacms.com/yidawap/syscome.asp?stype=safe_info\n\n   修复方案：  加上后天权限判断，加上口令验证或者加强权限判断。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-08-27 17:40 厂商回复： 谢谢提供 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}