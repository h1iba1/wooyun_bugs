{"id": 2089, "wybug_id": "wooyun-2014-066935", "wybug_title": "乐视旗下网酒网一个小失误一步一步控制到某服务器（可内网渗透）", "wybug_corp": "乐视网", "wybug_author": "乐乐、", "wybug_date": "2014-07-02 09:22", "wybug_open_date": "2014-08-16 09:24", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-16：\t细节向公众公开  简要描述： 早上上班 吃完饭逛逛乌云 看看昨天的漏洞还没有确认 距离周五还有2天了 48小时 2880分钟  172800秒 .......  详细说明：  有问题的站点：http://css.wangjiu.com/ 打开后乱七八糟的 有种遗弃的赶脚!三个问题：0x01:信息泄露http://css.wangjiu.com//WEB-INF/web.xml\nThis XML file does not appear to have any style information associated with it. The document tree is shown below.<web-app xmlns=\"http://java.sun.com/xml/ns/j2ee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" id=\"WebApp_9\" version=\"2.4\" xsi:schemaLocation=\"http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd\"><display-name>Struts Blank</display-name><session-config><session-timeout>120</session-timeout></session-config><filter><filter-name>struts2</filter-name><filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class><!--         <init-param>            <param-name>actionPackages</param-name>            <param-value>com.mycompany.myapp.actions</param-value>        </init-param>         --></filter><filter-mapping><filter-name>struts2</filter-name><url-pattern>*.action</url-pattern></filter-mapping><filter-mapping><filter-name>struts2</filter-name><url-pattern>*.jsp</url-pattern></filter-mapping><filter><filter-name>static</filter-name><filter-class>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter</filter-class><init-param><!--  配置Struts 2的配置文件  --><param-name>config</param-name><param-value>struts-freemarker.xml</param-value></init-param></filter><filter><filter-name>creatHtml</filter-name><filter-class>com.qdevelop.freemark.web.filter.FreemarkerStaticFilter</filter-class></filter><filter-mapping><filter-name>creatHtml</filter-name><url-pattern>*.html</url-pattern></filter-mapping><filter-mapping><filter-name>static</filter-name><url-pattern>*.html</url-pattern></filter-mapping><!--  \t<filter-mapping>  --><!--  \t\t<filter-name>api-encoding</filter-name>  --><!--  \t\t<url-pattern>*.json</url-pattern>  --><!--  \t</filter-mapping>  --><!--  \t<filter-mapping>  --><!--  \t\t<filter-name>api-encoding</filter-name>  --><!--  \t\t<url-pattern>*.xml</url-pattern>  --><!--  \t</filter-mapping>  --><welcome-file-list><welcome-file>system/public/index.jsp</welcome-file></welcome-file-list><!--  Quartz 配置信息  --><servlet><servlet-name>QuartzInitializer</servlet-name><servlet-class>org.quartz.ee.servlet.QuartzInitializerServlet</servlet-class><init-param><param-name>config-file</param-name><param-value>quartz.properties</param-value></init-param><init-param><param-name>shutdown-on-unload</param-name><param-value>true</param-value></init-param><init-param><param-name>start-scheduler-on-load</param-name><param-value>true</param-value></init-param><load-on-startup>0</load-on-startup></servlet><servlet><servlet-name>memCacheControl</servlet-name><servlet-class>com.qdevelop.cache.servlet.CacheManageServlet</servlet-class></servlet><servlet-mapping><servlet-name>memCacheControl</servlet-name><url-pattern>/cacheManage/*</url-pattern></servlet-mapping><!--  webInit 配置信息  --><servlet><servlet-name>webInit</servlet-name><servlet-class>com.wangjiu.oa.init.WebInit</servlet-class><load-on-startup>100</load-on-startup></servlet><!-- \t<servlet>\t\t<servlet-name>API_Select</servlet-name>\t\t<servlet-class>com.wangjiu.api.servlet.APISelectServlet</servlet-class>\t</servlet>\t<servlet-mapping>\t\t<servlet-name>API_Select</servlet-name>\t\t<url-pattern>/api/*</url-pattern>\t</servlet-mapping>\t --><!--  初始化spring 配置文件  --><listener><listener-class>org.springframework.web.context.ContextLoaderListener</listener-class></listener><context-param><param-name>contextConfigLocation</param-name><param-value>classpath:freemarker-methods.xml</param-value></context-param><error-page><error-code>404</error-code><location>/error.jsp</location></error-page><error-page><error-code>500</error-code><location>/error.jsp</location></error-page></web-app>\n0x02:不知道是任意文件下载还是怎么样http://css.wangjiu.com/login.jsp\n\n既然下下来了就看一看吧。\n\n然后直接百度了\n\n直接就出来登陆地址了\nhttp://online.wangjiu.com/login.action\n没登陆进去 只是提示到期了之类的\n\nroot权限 这就好玩了\nuid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)\n   漏洞证明：  这下又能提交好多了乐视的漏洞了 \n\n   修复方案：  求高RANK ~ 求礼物 ~ 求同志 ~   版权声明：转载请注明来源 乐乐、@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-07-02 09:37 厂商回复： 辛苦了 ：）  昨天的漏洞还没有确认应该不是乐视的吧~~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-02 09:32 |    \t\tmoses \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | 细节)\t\t \n  -.-    \n     2014-07-02 09:39 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  @moses 这么悠闲~    \n     2014-07-02 09:39 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  @乐视网 昨天？我昨天没提交乐视啊。。    \n     2014-07-02 11:00 |    \t\tmoses \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | 细节)\t\t \n  @乐乐、 今天闲 - -     \n     2014-07-02 11:03 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  @moses 挺好~     \n     2014-07-22 10:30 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  好奇洞主最后一张网状图是怎么做的，方便告知下么？    \n     2014-07-22 10:34 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  @梧桐雨 Zenmap GUI  - - ！    \n     2014-07-22 10:36 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @乐乐、 感谢感谢。。。    \n     2014-07-22 10:46 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  @梧桐雨 :-D    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}