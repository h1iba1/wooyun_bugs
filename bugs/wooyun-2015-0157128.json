{"id": 72600, "wybug_id": "wooyun-2015-0157128", "wybug_title": "搜狗某配置不当可泄露密码管理数据库", "wybug_corp": "搜狗", "wybug_author": "子墨", "wybug_date": "2015-11-30 18:40", "wybug_open_date": "2016-01-15 11:12", "wybug_type": "系统/服务运维配置不当", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["目录遍历", "默认配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-15：\t细节向公众公开  简要描述： 搜狗某配置不当可泄露密码管理数据库 详细说明：  话说phpmyadmin有个setup的东东，如果配置不当，可以直接看到数据库账号密码，看我截图步骤：http://sbs.m.sogou.com/phpmyadmin/setup/index.php\n\n\n\n\n\n由此，得数据库地址及账号密码分别如下：地址main.tcm.rds.sogou      用户名pfms     密码pfms12345678   漏洞证明：  用上面的账号登陆看看，http://sbs.m.sogou.com/phpmyadmin/index.php\n\n该账号权限偏低，就不getshell献丑了，同时附赠几个小漏洞吧http://sbs.m.sogou.com/index.php/site/login    无线Side-by-side系统用户名guest    密码123456http://sbs.m.sogou.com/f/ 目录遍历找出了几个敏感文件，内有数据库连接信息，如下：http://sbs.m.sogou.com/f/code/main.py\ndb = MySQLdb.connect(\"search04.mysql.db.sogou-op.org\", \"vrfront\", \"sbsSafety\", \"VR_SBS\", charset='utf8')#db = MySQLdb.connect(\"localhost\", \"root\", \"\", \"VR_SBS2\", charset='utf8')\nhttp://sbs.m.sogou.com/f/code/iptest.py\ndb = MySQLdb.connect(\"search04.mysql.db.sogou-op.org\", \"frontoms\", \"frontoms\", \"sogou_oms\", charset='utf8')#db = MySQLdb.connect(\"localhost\", \"root\", \"\", \"VR_SBS2\", charset='utf8')\nhttp://sbs.m.sogou.com/f/newcode/db.py\nHOST = \"search04.mysql.db.sogou-op.org\"USERNAME = \"vrfront\"PASSWORD = \"sbsSafety\"DATABASE = \"VR_SBS\"CHARSET = \"utf8\"# HOST = \"10.11.195.224\"# USERNAME = \"root\"# PASSWORD = \"\"# DATABASE = \"sbs\"# CHARSET = \"utf8\"\n   修复方案：  1、setup删除2、目录遍历修复：环境配置与权限   版权声明：转载请注明来源 子墨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-12-01 11:10 厂商回复： 感谢支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-11-30 19:36 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这个是通用的问题么？能拿shell不？    \n     2015-12-01 12:26 |    \t\t子墨 \t\t\t( 普通白帽子  |\t\t\t        Rank:253 漏洞数:27        | 天地不仁,以万物为刍狗;圣人不仁,以百姓为...)\t\t \n   @疯狗 见过几例但通用性不算高；能否拿shell的当前账号权限及系统环境相关    \n     2016-01-15 11:13 |    \t\t刺蝴蝶De箫启灵 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:5        | http://www.51zuosi.com/ QQ:1457801730)\t\t \n  6666666666 关注一下    \n     2016-01-15 11:29 |    \t\t有归于无 \t\t\t( 普通白帽子  |\t\t\t        Rank:114 漏洞数:25        | 有归于无)\t\t \n  这个叼啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}