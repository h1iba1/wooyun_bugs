{"id": 61180, "wybug_id": "wooyun-2013-040555", "wybug_title": "福建省国资委网站未授权访问&amp;getshell", "wybug_corp": "福建省人民政府国有资产监督管理委员会", "wybug_author": "cyber_jt", "wybug_date": "2013-10-22 17:52", "wybug_open_date": "2013-12-06 17:52", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["未授权访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-06：\t细节向公众公开  简要描述： 福建省人民政府国有资产监督管理委员会网站(www.fjgzw.gov.cn)存在未授权访问,可导致网站被入侵。 详细说明：  有段日子没这么戳站了，今天戳一个温习一遍，感觉还是非常爽的。(未授权访问部分)网站后台路径：/admin/，加些个常用页面试试水：login.aspx、main.asp、left.aspx...加到menu.aspx时，跳出个可爱操作菜单，可看到网站后台各种操作\n\n点击系统管理-用户配置，出现404，跳转至/FileNotFound.htm?aspxerrorpath=/Sys_Config/UserConfig.aspx，仔细一瞧发现访问的URL是/Sys_Config/UserConfig.aspx，我们不是在admin下么，很可能程序员犯二了，改成/admin/Sys_Config/UserConfig.aspx，ok了...平时用户尼玛怎么操作的？汗一个..:D页面转到了登录页面，但是呢不是立即跳转，虽然我很近视，也还看得出这是个载入后跳转，没说的，肯定是JS跳了，禁用JS，再访问，成功显示内容:\n\n有个密码还原功能，咱可不能轻易点人家的，出事担不起，查看下HTML源码，发现还原后的密码是8888，没说的，这是个默认密码，禁用了JS毕竟不好操作，能正常登录后台就方便多了。随便找几个帐号试试，果然有很多密码是8888的，登录进去，操作方便多了，通过用户管理还可以添加一个管理员用户，这不多表。(GetShell部分)发布信息，有个文本编辑框，长得可像eweb，上传张图片瞧瞧，没现没有重命名，心里就有了三分高兴（为什么是三分不是七分，因为这是IIS7），再传个aspx，弹框不允许，这是本地的，不管这么多，来burp改包试下，结果嗖地一声传上去了,服务端没作验证...汗\n\n   漏洞证明：  \n\n   修复方案：  说不清道不明，笼统地说三个方面吧：1.未授权访问;2.默认密码8888;3.文件上传验证。   版权声明：转载请注明来源 cyber_jt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2013-10-26 21:03 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}