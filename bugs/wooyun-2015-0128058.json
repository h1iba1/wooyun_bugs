{"id": 45916, "wybug_id": "wooyun-2015-0128058", "wybug_title": "数据安全之5某财产/车辆保险公司系统漏洞可泄露大量数据", "wybug_corp": "某财产/车辆保险公司", "wybug_author": "路人甲", "wybug_date": "2015-07-21 11:23", "wybug_open_date": "2015-09-07 16:20", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-07：\t细节向公众公开  简要描述： ... 详细说明：  1. 均是弱口令 具体密码就不写了 很容易猜解http://124.128.232.167:7001/console/http://124.128.232.173:7001/console确认厂商http://124.128.232.247:7004/lpcx/  \n\nhttp://124.128.232.167:7010/autoclaim-srs/LoginServlet\n\n2. shell：http://124.128.232.173:7001/jmxroot/jmxroot.jsp  \n360butian\nhttp://124.128.232.167:7001/jmxroot/jmxroot.jsphttp://124.128.232.247:7004/jmxroot/jmxroot.jsp3. 从多个3枚shell中取得数据源信息\n<jdbc-driver-params>    <url>jdbc:oracle:thin:@10.1.3.26:1521:orcl</url>    <driver-name>oracle.jdbc.OracleDriver</driver-name>    <properties>      <property>        <name>user</name>        <value>lpcx</value>  密码和用户名一致      </property>    </properties>    <password-encrypted>{3DES}4URK7v+hGn8=</password-encrypted>  </jdbc-driver-params>  <jdbc-connection-pool-params>\n\n<jdbc-driver-params>    <url>jdbc:oracle:thin:@10.1.3.52:1521:TESTDEV</url>    <driver-name>oracle.jdbc.OracleDriver</driver-name>    <properties>      <property>        <name>user</name>        <value>tsportal</value>  密码和用户名一致 多枚账号均是如此      </property>    </properties>    <password-encrypted>{3DES}4TXoJGR7EMjMb6epUMToXg==</password-encrypted>  </jdbc-driver-params>\n\n<jdbc-driver-params>    <url>jdbc:oracle:thin:@10.1.3.1:1521:oradb</url>    <driver-name>oracle.jdbc.OracleDriver</driver-name>    <properties>      <property>        <name>user</name>        <value>typt</value>   密码：typt553      </property>    </properties>    <password-encrypted>{3DES}IVvVTKeb4KU=</password-encrypted>  </jdbc-driver-params>  <jdbc-connection-pool-params> <jdbc-driver-params>    <url>jdbc:oracle:thin:@10.1.3.1:1521:oradb</url>    <driver-name>oracle.jdbc.OracleDriver</driver-name>    <properties>      <property>        <name>user</name>        <value>pcisv6_tsky</value>  密码：pass876      </property>    </properties>    <password-encrypted>{3DES}ujUfmawxtXg=</password-encrypted>  </jdbc-driver-params>\n4. 取分析数据吧...多个库的数据从中选取数据量较多和敏感的数据作为提交有些图片过长的截取部分8.4W条汽车公司的参保数据\n\n\n\n2800W条金额记录 虽然没看懂这些是什么数据\n\n6.3W 保险人信息\n\n\n\n670W 个人证件信息+职业\n\n169W车主信息\n\n\n\n89W个人信息\n\n\n\n\n\n再来308W 个人证件信息\n\n168W 详细信息  手机+姓名+住址+身份证\n\n\n\n好吧...可用信息收集到这  其他一些投保金额/理赔记录之类的就不截图上来最后提权下服务器作为警示从shell分析文件中得出一份账号信息 即是服务器账号administrator  密码：chaxun_app\n\n同时任务栏还有未关闭的pl\\sql  又省去了连接数据库的步骤再一次将会有更多数据库信息泄露\n\n安全检测，点到为止   漏洞证明：     修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-07-24 16:19 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向保险行业信息化主管部门通报,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-07 16:25 |    \t\t撸至深 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 撸至于形)\t\t \n  你以为我不知道你脱裤了吗，交裤不杀    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}