{"id": 51614, "wybug_id": "wooyun-2014-073930", "wybug_title": "YiDacms 最新版SQL注入及任意刷钱漏洞", "wybug_corp": "yidacms.com", "wybug_author": "xfkxfk", "wybug_date": "2014-08-26 19:10", "wybug_open_date": "2014-11-24 19:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "安全意识不足", "代码审计"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-30：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-24：\t细节向公众公开  简要描述： YiDacms 最新版SQL注入，任意刷钱，任意金额购物等漏洞 详细说明：  易达CMS 企业建站系统当前最新版本是：YidaCms X3.2（20140718）版文件/Yidacms/buy_settlement.asp：\nset rs = server.createobject(\"adodb.recordset\")\t\tsql=\"select shuaiweb_usermoney from shuaiweb_user where shuaiweb_useremail='\"&request(\"shuaiweb_useremailbuy\")&\"'\"\t\trs.open sql,dbok,1,3\t\trs(0) = rs(0) - trim(request.form(\"yidacms_quanbujiage\"))\t\trs.update\t\trs.Close\n看到了这里直接获取shuaiweb_useremailbuy，没有经过过滤处理即进入SQL语句，导致SQL注入然后直接获取购买商品的最后全部价格yidacms_quanbujiage，然后更新用户的shuaiweb_usermoney，导致任意刷钱漏洞这里还存在任意金额购买物品漏洞，当然可以刷钱就不存在价格问题咯   漏洞证明：  首先我们来看看用户初始金额：\n\n初始金额为500然后发送如下请求：\n\n再来看看现在的金额\n\n成功添加500，现在金额为1000但是发送如下请求后：\n\n再来看看此时的金额：\n\n此时金额仍为1000，没有添加500金额成功达到SQL盲注，刷钱的目的。   修复方案：  全局过滤咧？判断一下金额正负啊。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-08-27 08:59 厂商回复： 谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}