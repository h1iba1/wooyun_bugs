{"id": 12071, "wybug_id": "wooyun-2013-023152", "wybug_title": "微信-腾讯微博认证机制存在严重缺陷 可直接控制他人微博", "wybug_corp": "腾讯", "wybug_author": "猪猪侠", "wybug_date": "2013-05-06 11:57", "wybug_open_date": "2013-06-20 11:57", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-20：\t细节向公众公开  简要描述： 微信某个接口在处理用户认证时未进行严格的业务逻辑设计，导致可直接控制他人微博。 详细说明：  部署在微信m.3g.qq.com的微博接口，仅仅通过用户的一个固定UID进行用户认证，如果直接通过算法算出每个用户的固定md5 UID，即可大面积沦陷腾讯微博业务。具体认证接口如下http://m.3g.qq.com/account.html?uid=59e0434******b3475a17dc10d5ce912&fr=2&aid=aullik5#1 点开微信某个联系人信息\n\n#2 复制链接或者在浏览器中打开，你将获得如下认证链接。http://m.3g.qq.com/account.html?uid=59e0434******b3475a17dc10d5ce912&fr=2&aid=aullik5这样即可得到用户的固定md5 UID。\n\n#3 利用搜索引擎大面积搜索类似链接\n\n#4 利用获取到的UID进行操作\n\n#5 成功收听道哥微博\n\n   漏洞证明：  成功收听道哥微博\n\n   修复方案：  认证因子动态随机化，并加入过期机制。   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-05-07 15:19 厂商回复： 非常感谢您的报告。这个问题我们已经确认，正在与业务部门进行沟通制定解决方案，如有任何新的进展我们将会及时同步。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-06 12:00 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:134        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  洞主，求测试。    \n     2013-05-06 12:03 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:76        | coder)\t\t \n  这回是heige？还是煤总啊？    \n     2013-05-06 12:03 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:134        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @shine 煤老板。    \n     2013-05-06 12:04 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  煤老板开始来售腾讯牌的煤了～    \n     2013-05-06 12:06 |    \t\tckaexn \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | ~)\t\t \n  前排关注    \n     2013-05-06 12:29 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  Mark    \n     2013-05-06 12:48 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:89        | 一名普通的phper开发者，关注web安全。)\t\t \n  有闪电图标 果断关注！    \n     2013-05-06 13:56 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @zeracker 301 这不是黑哥的马甲吗？    \n     2013-05-06 14:09 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:41        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  哎呀。    \n     2013-05-06 14:25 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:134        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @Finger 不是    \n     2013-05-06 14:28 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  关注    \n     2013-05-06 15:03 |    \t\t钱途 \t\t\t( 普通白帽子  |\t\t\t        Rank:273 漏洞数:44        )\t\t \n  @Finger 不是黑哥的马甲。 这个人就是黑哥    \n     2013-05-06 16:48 |    \t\tgoderci \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:47        | http://www.yunday.org)\t\t \n  mk    \n     2013-05-06 18:06 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:41        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @钱途 靠！你确定@Finger这个是黑哥？    \n     2013-05-06 18:21 |    \t\t钱途 \t\t\t( 普通白帽子  |\t\t\t        Rank:273 漏洞数:44        )\t\t \n  @鬼魅羊羔 我说洞主是黑哥    \n     2013-05-06 19:21 |    \t\t存在敏感词 \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:9        | 昵称存在敏感词)\t\t \n  火前留名    \n     2013-05-06 20:37 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:41        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @钱途 好吧。。。    \n     2013-05-07 00:13 |    \t\t堕络 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:2        | 一个新手菜鸟 求关爱)\t\t \n  - -  哎呀 帅    \n     2013-05-07 11:37 |    \t\tBincker \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:23        )\t\t \n  作为一个wooyun白帽子我想你必要的贞操是需要有的    \n     2013-05-07 13:07 |    \t\t豆芽 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 修行中)\t\t \n  作为一个wooyun白帽子我想你必要的贞操是需要有的    \n     2013-05-07 15:07 |    \t\t射不出来 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:4        | 我是来混的...)\t\t \n  作为一个wooyun白帽子我想你必要的贞操是需要有的    \n     2013-05-07 16:03 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:125        | 如果大海能够带走我的矮丑...)\t\t \n  作为一个wooyun白帽子我想你必要的贞操是需要有的    \n     2013-05-07 16:32 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  @gainover 5分。代表什么?    \n     2013-05-07 20:34 |    \t\t堕络 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:2        | 一个新手菜鸟 求关爱)\t\t \n  搞什么 就5分    \n     2013-05-08 23:06 |    \t\t冷冷的夜 \t\t\t( 普通白帽子  |\t\t\t        Rank:135 漏洞数:12        )\t\t \n  0。0    \n     2013-05-11 00:51 |    \t\tCpt.Tony \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 兴趣)\t\t \n  感觉有内幕…    \n     2013-06-20 13:29 |    \t\t╰╃清風 \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:9        | 这家伙很懒，什么都没有留下)\t\t \n  已测试，此洞还在，可批量刷听众    \n     2013-06-21 12:44 |    \t\t堕络 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:2        | 一个新手菜鸟 求关爱)\t\t \n  @╰╃清風 擦擦 今天就收了几个     \n     2013-06-21 16:04 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  这漏洞新浪不是暴露过??腾讯的不吸取教训..    \n     2014-07-18 15:49 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:68        | 潜心学习~~~)\t\t \n  没看懂，只是可以收听怎么是可以直接控制呢？    \n     2014-07-18 16:48 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  #3 利用搜索引擎大面积搜索类似链接貌似一共就搜到了3条。。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}