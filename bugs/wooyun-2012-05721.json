{"id": 20258, "wybug_id": "wooyun-2012-05721", "wybug_title": "网路岗可截获QQ密码和聊天记录", "wybug_corp": "腾讯", "wybug_author": "盡情盡興", "wybug_date": "2012-04-01 20:34", "wybug_open_date": "2012-05-16 20:35", "wybug_type": "用户敏感数据泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-04-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-04-09：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-05-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-06-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-06-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-05-16：\t细节向公众公开  简要描述： 如果在网关安装了网络岗的话，网络岗可以截获该网络中使用QQ的用户的QQ密码和聊天记录。 详细说明：  很多公司、学校都用网路岗来监控网络状况。如果网关被不怀好意的hacker进入，并装上网路岗的话，那用户的QQ密码和隐私就被窃取了。   漏洞证明：  \n\n我想密码连第一位都有了，那就等于都有了吧我很好奇网路岗是怎么得到密码的，是腾讯的加密算法被它破解了..?\n\n个人感觉这是个严峻的问题.刚知道网路岗有这么强大的功能时，我震惊了..这是什么情况..?腾讯该不会不知道网路岗有这功能吧..?   修复方案：  你懂得..   版权声明：转载请注明来源 盡情盡興@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-04-06 10:58 厂商回复： 感谢您的报告，我们已经在处理中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-04-01 20:47 |    \t\t明.   \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:7        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  恶心死了.    \n     2012-04-01 21:05 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  愚人节？    \n     2012-04-01 21:12 |    \t\t水泥中的鱼 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:4        | 我就是我，尘世中一迷途小书童。)\t\t \n  混分？    \n     2012-04-02 00:06 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个还可以 挺好的 不知道企鹅会怎么说    \n     2012-04-02 08:17 |    \t\t盡情盡興 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:2        | 一个白帽子)\t\t \n  @明 看下人家 @xsser 多有见解    \n     2012-04-02 08:18 |    \t\t盡情盡興 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:2        | 一个白帽子)\t\t \n  @明. 看下人家 @xsser 多有见解    \n     2012-04-02 10:12 |    \t\t明.   \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:7        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  @盡情盡興 我是说网络岗很恶心啊。！！！！    \n     2012-04-02 10:22 |    \t\t明.   \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:7        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  我觉得QQ加个加密选项，在不同的环境，用户可以选择开不开。    \n     2012-04-02 10:25 |    \t\t盡情盡興 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:2        | 一个白帽子)\t\t \n  @明.   哦    \n     2012-04-06 12:20 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  聊天记录监控不是各种内网审计设备的必备功能么？    \n     2012-04-06 15:11 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  还真是？期待细节。    \n     2012-04-06 15:20 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @horseluke 隐私何在？？    \n     2012-04-06 15:45 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @xsser 我觉得网路游侠应该可以解答你的疑问：http://weibo.com/1408734653/y3YI5nOR9    \n     2012-05-08 17:27 |    \t\tEoh \t\t\t( 普通白帽子  |\t\t\t        Rank:286 漏洞数:35        )\t\t \n  @xsser @horseluke 要是这软件能移植安装在天朝的网关下，我们还完毛线啊。大牛们天天都是说网络无绝对安全，现在连相对都没，谈何无绝对。求解决方案……    \n     2012-05-08 18:51 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @Eoh 召唤@网路游侠    \n     2012-05-17 13:25 |    \t\ticefish \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:8        | 欢迎大家和我用邮件进行交流~)\t\t \n  哇，这个软件碉堡了。果断收藏下    \n     2012-05-17 13:55 |    \t\tGaRY \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:3        | 真悲剧平男君)\t\t \n  广告贴？    \n     2012-05-17 14:10 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  网络岗 牛逼    \n     2012-05-17 15:24 |    \t\tby china \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  软件推广。。广告贴。。。    \n     2012-05-17 15:29 |    \t\t柒_Tam \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | <script src=\"http://xss.wuaiql.com/?u=20...)\t\t \n  这年头什么东西都有    \n     2012-05-17 16:52 |    \t\twormcy \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | 扒洞 球变身.)\t\t \n  算了 不说脏话了...  以后出门直接用国外SSH得了  比裸奔安全    \n     2012-05-17 17:07 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  外部关联：《由“网路岗可截获QQ密码和聊天记录”谈起》，作者heart：http://hi.baidu.com/xisigr/blog/item/159691ae10160bec7dd92ae9.html （原文关键信息摘要：我想说的是QQ在网络中传输的加密算法是没有问题的。此次网络岗事件，是由于网络岗使用了中间人攻击：这个软件使QQ登陆时帐号异常，强迫用户去输入密码解锁，此时就完成了中间人攻击，QQ明文密码被截获到。然后软件使用QQ密码的2遍MD5做密钥，解开QQ聊天文本信息。这种中间人攻击的隐蔽性比较强，因为QQ有时候会经常弹出框说异地登录要输入什么东东之类的，所以用户看到这样的情况也习以为常，不会想到被攻击。就像小G说的“ 我现在开机就弹登陆异常，要输入验证码，哪天要是假窗口要密码，也许我也会填。。。最近一直在外地，习惯了填这个”。）    \n     2012-05-17 17:41 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  @horseluke 关联帝    \n     2012-05-17 17:44 |    \t\ttestcvc \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | test)\t\t \n  我勒个去，这个也能弄20Rank？？？很早以前，10年那会在以前单位就用这个管理局域网    \n     2012-05-17 20:35 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  @horseluke 看看QQ2011的协议，好像就没那么好做了，其实觉得TX早就知道了，木有公开而已。下面这篇给你参考一下：http://blog.sina.com.cn/s/blog_562317150100toar.html    \n     2012-05-18 11:24 |    \t\t盡情盡興 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:2        | 一个白帽子)\t\t \n  @testcvc 可是这的确是很严重的事情啊.10年了都没人重视,如果现在还不去重视它,那以后还有什么隐私可言.    \n     2012-05-18 15:11 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  @盡情盡興 其实这完全是由于http明文传输“密码”而已。都10年了，也都这样，说明问题不算很严重，大家已经适应了。    \n     2012-05-18 20:28 |    \t\t盡情盡興 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:2        | 一个白帽子)\t\t \n  @tpu01yzx 密码泄露,聊天记录被窃听,这样都不算严重?!看了下网上大家对这事情的看法，发现大家真的是适应了，居然还有认为这是广告的...看来不止是网络安全,整个社会,需要走的路还很长..    \n     2012-05-18 22:11 |    \t\ttestcvc \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | test)\t\t \n  @盡情盡興 09-10年那会我一直在用这个管理过局域网，虽然知道侵犯隐私，但是人在屋檐下，自己只是混口饭吃，没有办法。其实这个软件截取到密码只是最后在网页上激活的那个时候获取到的，感觉这东西最多算个低级的盗号程序，只能说是在协议上的问题，而且这么明显的地方TX肯定也早知道了。    \n     2012-05-19 12:57 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  @盡情盡興 这是安全人员的惯性思维，对于大部分用户来说，这本身真不算严重。你听说过ISP在网关上弄这个东西了吗？也就是企业网吧等特定的网络中看起来“理所应当”地被监听。如果能导致一般的家庭用户也能受到影响那才是严重。换个角度来说，这完全是TX的问题，如果用户不能放弃QQ，那就要去适应，尽量不要在QQ上进行隐私的谈话。    \n     2012-05-19 15:14 |    \t\t盡情盡興 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:2        | 一个白帽子)\t\t \n  @testcvc 搞不懂TX，我也觉得TX早知道了，可它怎么都不管？其实问题就出现在那个激活网页上，应该不难解决才对.    \n     2012-05-19 15:31 |    \t\t盡情盡興 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:2        | 一个白帽子)\t\t \n  @tpu01yzx 如果说是在企业这样的办公网络中,大家都了解并接受被监听,那的确\"理所当然\",但是存在着大家并不了解而被监听的情况,而且网吧不是办公场所,大家都是在做私事,这样的话,还算不严重吗?还有一些免费wifi本来就已经很不安全了.说不定网路岗公司已经搜集了大量的用户信息了.真的不算严重吗?    \n     2012-05-19 19:23 |    \t\t网路游侠 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:2        | 不玩渗透好多年……)\t\t \n  @horseluke 亲，感谢关注我的微博    \n     2012-05-19 19:25 |    \t\t网路游侠 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:2        | 不玩渗透好多年……)\t\t \n  @horseluke 这个应该是激活网页的问题，以前看到有厂家说明。qq加密默认没问题，但是装了这个会提示你密码错误，让你去验证……好像是如此。问题就出现在这里。。。。    \n     2012-05-19 19:27 |    \t\t网路游侠 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:2        | 不玩渗透好多年……)\t\t \n  看了下91ri的说明，其实这样进行qq密码和聊天内容审计的方式，几年前就做到了。第一家并不是网路岗，我知道的是一家成都公司。然后OEM了一大堆，包括上海的几家，都是用它的。然后后来网路岗也有了……就是那个说你登录异常之后搞的鬼。但是他妈的把密码显示到界面太恶心了    \n     2012-05-20 01:03 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  刚简单逛了一下TX的网站，发现一大堆需要登陆的网站还是在用http，尼玛就每个https吗?跨域认证协议一大堆，这么大间公司连个像样的专业人员都没有吗？别以为什么md5(uid+vcode+md5(pass))类似这样就安全了，http没保障，js代码完全可以被替换掉。    \n     2012-05-20 01:25 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  大家可以关注一下http中嵌套https表单的安全性问题，通病啊。何况这TX是http嵌套http表单，想不被截取密码都难啦。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}