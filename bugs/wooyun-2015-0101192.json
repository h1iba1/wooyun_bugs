{"id": 36736, "wybug_id": "wooyun-2015-0101192", "wybug_title": "徐福记官网一个注入引发的血案", "wybug_corp": "徐福记", "wybug_author": "LinE", "wybug_date": "2015-03-16 14:44", "wybug_open_date": "2015-04-30 18:48", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-16：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-04-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 因为主站的一个注入导致...........GetShell可能都是小问题了···· 详细说明：  某日闲着没事，对徐福记官网进行了一个检测，结果发现一处注入http://www.hsufuchifoods.com/Contact.aspx?MenuID=001008001然后丢到sqlmap直接跑去了，果然可以跑出来信息\n\n看一下库的信息\n\nSQL Server的用户信息\n\n当时想着既然是SQL Server，那有可能有命令执行，结果试了一下果然有\n\n不光有，权限还是蛮大的- -！然后想着，既然有命令执行，在sqlmap里毕竟不好搞，想换到1433下，于是查了一下IP，是外网的独立IP，扫了一下端口\n\n1433开放，然后就打算破SQL Server的密码\n\n搞到密码hash之后扔到cmd5查了一下， 出来了两个\n[*] bear [1]:    password hash: 0x010063497720145122ec5bd6c2b5384be74c78046df8f76ceb3e        header: 0x0100        salt: 63497720        mixedcase: 145122ec5bd6c2b5384be74c78046df8f76ceb3e[*] btopsxufuji [1]:密码为xufuji123    password hash: 0x010018dbe795bbf3a8f3d7e7e7935c951ccb1175807dff3bae9b        header: 0x0100        salt: 18dbe795        mixedcase: bbf3a8f3d7e7e7935c951ccb1175807dff3bae9b[*] sa [1]:    password hash: 0x01006d12341a3b0450efa7a3af5f9d4f92b5ebb95701cf767a97        header: 0x0100        salt: 6d12341a        mixedcase: 3b0450efa7a3af5f9d4f92b5ebb95701cf767a97[*] wsb147 [1]: 密码为151844    password hash: 0x010048da0d499644113ea6701934e11614306929d242bd278154\t        header: 0x0100        salt: 48da0d49        mixedcase: 9644113ea6701934e11614306929d242bd278154[*] xufuji [1]:    password hash: 0x01006eb32ab4eb3f3778e6f60a07c20f09bf8cacbcd2e1feb1a0        header: 0x0100        salt: 6eb32ab4        mixedcase: eb3f3778e6f60a07c20f09bf8cacbcd2e1feb1a0\n然后随便找了一个登陆上去，再次命令执行，果然不出我所料，也是system\n\n然后查了一下账户，看样子徐福记官方已经被拿过了\n\n然后既然被拿过了，我就毫不客气的吧$darkmoon的密码改了，顺便查了一下终端的端口号\n\n然后我就登陆上去了...登上去了...上去了...去了...了......\n\n看了一下IIS配置，徐福记主站果然在上面，尝试在网站的根下加了一个txt，果然访问到了\n\n到了这一步已经个人觉得没啥能继续深入的余地了，也就没有再继续深入下去所有创建的文件均已删除，截图仅作证明，就酱紫了   漏洞证明：  \n\n\n\nSQL Server信息：www.hsufuchifoods.com:1433btopsxufuji       xufuji123wsb147            151844远程桌面信息：www.hsufuchifoods.com:9168$darkmoon         line   修复方案：  弱弱的问一句，有糖吃么◕ ̯͡◕   版权声明：转载请注明来源 LinE@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}