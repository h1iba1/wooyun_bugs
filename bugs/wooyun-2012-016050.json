{"id": 14881, "wybug_id": "wooyun-2012-016050", "wybug_title": "360网站安全检测,域名验证存在风险，有可能被他人验证通过", "wybug_corp": "奇虎360", "wybug_author": "shack2", "wybug_date": "2012-12-15 01:32", "wybug_open_date": "2013-01-29 01:33", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-29：\t细节向公众公开  简要描述： 有时候可以绕过360网站安全检测平台的域名验证，这样通过了，扫扫别人网站，有什么好洞，拿来看看 详细说明：  今天没事看到360网站安全检测，要看扫别人的网站的漏洞信息，需要验证域名于是去看了一下怎么验证的，发现这个验证就验证一段html于是想到，要是能在别人网站首页留下这个东西，就能扫拿到别人网站扫描报告了拿我自己的博客来实验添加域名\n\n使用文字验证\n\n我博客有留言功能，没有对html过滤，首页还会显示最新留言，这才是关键\n\n看首页的验证代码\n\n确认开始验证验证通过\n\n这样就可以收到这个网站的安全扫描的报告了，要是看到几个高危，就真的高危了总结利用条件就是：能控制网站首页的html，如网站留言，发布文章，评论这些的，只要能插html代码在首页就行个人感觉这种验证方法还是有些弊端   漏洞证明：  今天没事看到360网站安全检测，要看扫别人的网站的漏洞信息，需要验证域名于是去看了一下怎么验证的，发现这个验证就验证一段html于是想到，要是能在别人网站首页留下这个东西，就能扫拿到别人网站扫描报告了拿我自己的博客来实验添加域名\n\n使用文字验证\n\n我博客有留言功能，没有对html过滤，首页还会显示最新留言，这才是关键\n\n看首页的验证代码\n\n确认开始验证验证通过\n\n这样就可以收到这个网站的安全扫描的报告了，要是看到几个高危，就真的高危了总结利用条件就是：能控制网站首页的html，如网站留言，发布文章，评论这些的，只要能插html代码在首页就行个人感觉这种验证方法还是有些弊端   修复方案：  这个验证方法不太科学   版权声明：转载请注明来源 shack2@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2012-12-15 12:15 厂商回复： 感谢您的反馈，该问题确认存在，我们正在处理。另补充两点：1，这个要求一个网站开评论，且能提交html，且html在首页能够完整显示，这是一个典型的致命的存储型跨站2，本文的网站经过我们的测试是不满足前提条件的，￼ 不过漏洞存在，提交者流程判断是对的。下次请用真实的案例。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-15 01:34 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  看完标题，菊花一紧。    \n     2012-12-15 01:42 |    \t\tshack2 \t\t\t( 普通白帽子  |\t\t\t        Rank:470 漏洞数:71        | QQ:1341413415 一个热爱编程(Java),热爱网...)\t\t \n  @鬼魅羊羔 坐等忽略，哈哈，觉得这个有点鸡肋    \n     2012-12-15 08:38 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @shack2 不鸡肋 谢谢提交    \n     2012-12-15 10:11 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @shack2 条件很苛刻 但是思路还不错    \n     2012-12-15 18:47 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  这个我都知道，嘿嘿    \n     2013-01-14 13:00 |    \t\tzsx \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | undefined)\t\t \n  360的人没用过WP么。。HTML白名单机制。。    \n     2013-01-15 19:42 |    \t\t半世倾尘 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:8        | 努力)\t\t \n  思路很好    \n     2013-01-29 09:10 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  前几天一个客户网站就遭到了360webscan这样的扫描，管理员没有提交或申请使用过360webscan，这货从下午一直扫描到第二天的上午，拦截的内容多包含“360webscan”，（站点的动态内容居多，取库没有cache，这货简直就是dos，直接把站点扫挂）没有办法，只好手工封禁了那来自北京的4个网段。难道就是这样实现的呀……    \n     2013-01-29 12:44 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  这是一个典型的致命的存储型跨站    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}