{"id": 1753, "wybug_id": "wooyun-2014-062388", "wybug_title": "Discuz UC_Server 本地文件包含漏洞（有条件限制）", "wybug_corp": "Discuz!", "wybug_author": "Net4ky", "wybug_date": "2014-05-30 12:25", "wybug_open_date": "2014-08-28 12:26", "wybug_type": "文件包含", "wybug_level": "低", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件包含漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-28：\t细节向公众公开  简要描述： 怀着忐忑的心情提交了这个漏洞，依旧相信wooyun是一个良好的平台 赌上了作为一个白帽子的节操，不要在让他碎一地 详细说明：  条件一：需要UC管理员权限。条件二：前台可上传带有PHP代码的可控文件。漏洞函数onping在文件uc_server\\control\\admin\\app.php\nfunction onping() {\t\t$ip = getgpc('ip');\t\t$url = getgpc('url');\t\t$appid = intval(getgpc('appid'));\t\t$app = $_ENV['app']->get_app_by_appid($appid);\t\t$status = '';\t\tif($app['extra']['apppath'] && @include $app['extra']['apppath'].'./api/'.$app['apifilename']) {\t\t\t$uc_note = new uc_note();\t\t\t$status = $uc_note->test($note['getdata'], $note['postdata']);\t\t} else {\t\t\t$this->load('note');\t\t\t$url = $_ENV['note']->get_url_code('test', '', $appid);\t\t\t$status = $_ENV['app']->test_api($url, $ip);\t\t}\t\tif($status == '1') {\t\t\techo 'document.getElementById(\\'status_'.$appid.'\\').innerHTML = \"<img src=\\'images/correct.gif\\' border=\\'0\\' class=\\'statimg\\' \\/><span class=\\'green\\'>'.$this->lang['app_connent_ok'].'</span>\";testlink();';\t\t} else {\t\t\techo 'document.getElementById(\\'status_'.$appid.'\\').innerHTML = \"<img src=\\'images/error.gif\\' border=\\'0\\' class=\\'statimg\\' \\/><span class=\\'red\\'>'.$this->lang['app_connent_false'].'</span>\";testlink();';\t\t}\t}\n其中的变量$app['extra']['apppath']和$app['apifilename']是从\n\n这两栏读过来的 修改其中的值就可以了   漏洞证明：  \n\n   修复方案：  对值过滤   版权声明：转载请注明来源 Net4ky@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-05-30 12:30 厂商回复： 感谢您对问题的提出。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-30 12:26 |    \t\tHmily \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 吾爱破解论坛)\t\t \n  节操多少钱一斤？    \n     2014-05-30 12:32 |    \t\tDiscuz!(乌云厂商)\t\t \n  之前我们已经注意到这个问题的存在，但鉴于ucenter代码发布周期很慢，加之其危害需要获得管理权限，所以一直未给于足够的重视。    \n     2014-05-30 12:34 |    \t\tHmily \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 吾爱破解论坛)\t\t \n  @Discuz! discuz的代码发布也没见快啊？现在外面的洞洞你们什么时候能发补丁？    \n     2014-05-30 12:35 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Hmily 这人用的dz 鉴定完毕    \n     2014-05-30 12:37 |    \t\tHmily \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 吾爱破解论坛)\t\t \n  @xsser 上次和你说微信提醒那bug不是你们问题，我之前搜错文字了o(╯□╰)o，换了一下现在提醒了，收到信息就上来瞧一下，挺方便。    \n     2014-05-30 18:01 |    \t\tnclove \t\t\t( 普通白帽子  |\t\t\t        Rank:383 漏洞数:73        | 弹指安全！)\t\t \n  应用漏洞~~    \n     2014-05-30 20:21 |    \t\tGrayTrack \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:14        | 灰色轨迹)\t\t \n  @Hmily @xsser 这人是吾爱的管理？鉴定一下    \n     2014-05-30 20:52 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @GrayTrack 是    \n     2014-05-31 00:36 |    \t\tLauRen \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 苦逼屌丝一枚。)\t\t \n  吾爱boss    \n     2014-05-31 09:11 |    \t\t小怿 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:6        | )\t\t \n  @xsser http://wooyun.org/bugs/wooyun-2014-062944/trace/a00663888d982a15d7f27edebca8f5b4 求审核    \n     2014-05-31 09:18 |    \t\t小怿 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:6        | )\t\t \n  @Hmily 看到你对dz这么关注！快去看看你cn域名下的service邮箱吧！    \n     2014-05-31 21:50 |    \t\tHmily \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 吾爱破解论坛)\t\t \n  @小怿 求不黑    \n     2014-05-31 21:54 |    \t\t小怿 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:6        | )\t\t \n  @Hmily 你可是dz的忠实粉丝!可惜dz伤透了你的心!不过,你要在说我黑你!我可开burp了!嘿嘿!我今天还玩了一下乌云的help邮箱,你说xsser会不会杀了我!!    \n     2014-05-31 22:03 |    \t\tHmily \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 吾爱破解论坛)\t\t \n  @小怿 深受dz其害，我私聊你。    \n     2014-05-31 22:08 |    \t\t小怿 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:6        | )\t\t \n  @Hmily 给你一个脸盆，你能创造一堆眼泪。哈哈哈哈    \n     2014-12-14 19:38 |    \t\t马丁 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:23        | 大爷~给口饭吧。)\t\t \n  @Hmily H大52邀请码开放免费的时候到社区发一下啊    \n     2014-12-14 20:27 |    \t\tHmily \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 吾爱破解论坛)\t\t \n  @马丁 jianxin要banid的，还是关注论坛微信吧，开放就会发通知。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}