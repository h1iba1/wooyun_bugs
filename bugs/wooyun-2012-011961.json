{"id": 16821, "wybug_id": "wooyun-2012-011961", "wybug_title": "PPTV某站任意文件上传", "wybug_corp": "PPTV(PPlive)", "wybug_author": "only_guest", "wybug_date": "2012-09-10 05:01", "wybug_open_date": "2012-10-25 05:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-09-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-09-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-10-25：\t细节向公众公开  简要描述： PPTV某站任意文件上传.可以直接拿到webshell 详细说明：  听说pptv有公仔拿.我就带队来了.一人一个哦.要不然组织内部会很混乱的.首先找到如下地址http://gm.pptv.com/k2x/page/login/login.php点击找回密码按钮随便输入一个帐号.提示账号长度6位以上!然后输入111111提示用户没有设置密保信息判断用户存在.然后返回登录页使用帐号111111密码111111成功登陆..上面这段内容只是想证明我懒得注册.然后发现http://gm.pptv.com/k2x/page/profile/avatar.php?aui=dXNlcl9pZD00NDI2MyZjaGFubmVsX2lkPSY=此地址可以上传头像直接上传PHP文件提示类型错误然后抓包修改文件后缀,依然提示类型错误判断是使用Content-Type做文件类型判断的.于是修改Content-Type为image/jpeg直接提交后返回HTTP/1.1 302 Found此时打开用户头像查看的地方.发现用户头像已经是个X了..右键新标签打开.http://gm.pptv.com/k2x/smarty/templates/avatar/81289_20_20.php成功得到webshell   漏洞证明：  http://gm.pptv.com/k2x/smarty/templates/avatar/81289_20_20.php   修复方案：  判断太容易绕过了   版权声明：转载请注明来源 only_guest@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2012-09-10 09:40 厂商回复： thx; 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-09-10 08:07 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  这是在履行诺言么！    \n     2012-09-10 08:14 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  又一个骚年就这么毁了~~    \n     2012-09-10 12:27 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  pptv专场。z z z    \n     2012-09-10 12:29 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  @gainover 你都不发...    \n     2012-09-10 22:30 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @only_guest 就给你发礼物了。。~~~~(>_<)~~~~     \n     2012-10-25 09:43 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  discuz uc的这个avatar判断一直都是这么搓，见过好多次了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}