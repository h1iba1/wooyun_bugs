{"id": 56196, "wybug_id": "wooyun-2014-058541", "wybug_title": "记事狗后台代码执行漏洞(可getshell)", "wybug_corp": "杭州神话", "wybug_author": "喵星人", "wybug_date": "2014-05-02 14:19", "wybug_open_date": "2014-07-31 14:20", "wybug_type": "文件包含", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-07：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-06-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-31：\t细节向公众公开  简要描述： 对模块输入过滤不严格 影响范围在3.6版本到4.7(for now) 详细说明：  \n//WriteFile 函数 写入文件$set=$this->Post['sharetemp'];\t\t$set = jstripslashes($set);\t\t$file = ROOT_PATH . 'templates/default/share/sharetemp_'.$shareid.'.html';\t\t\t\tif(!is_dir(dirname($file))) {\t\t\tjmkdir(dirname($file));\t\t}\t\t$len = Load::lib('io', 1)->WriteFile($file, $set);\t\tif(!$len) {\t\t\tdie($file.\" 文件无法写入,请检查是否有可写权限。\");\t\t}\n\n{\t\t\t$topic_list[$k]['content'] = stripslashes($topic_list[$k]['content']);\t\t\tif($share['string'] && $share['string'] > 0){\t\t\t\t$topic_list[$k]['content'] = cut_str(strip_tags($topic_list[$k]['content']),$share['string'],'<a>');\t\t\t}\t\t}\t\tinclude  $this->TemplateHandler->Template('share/sharetemp_'.$ids);<<<直接进行包含 导致代码执行\n\n\n   漏洞证明：  \n\n\n\n\n\n   修复方案：  过滤标签 严格规定输入 修改正则   版权声明：转载请注明来源 喵星人@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2014-05-04 09:05 厂商回复： 和前面的反馈重复了 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-10 03:49 |    \t\tdoor \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 没什么说明)\t\t \n  话说怎么还没公开。，，速度是不是太慢了啊    \n     2014-05-25 19:18 |    \t\tddy \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:12        | 其实第一次要我挖洞我是拒绝的。因为，你不...)\t\t \n  @door  WooYun: 记事狗后台代码执行漏洞(可getshell)    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}