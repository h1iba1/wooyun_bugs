{"id": 15016, "wybug_id": "wooyun-2013-017384", "wybug_title": "我是如何绕过PHPCMS补丁继续注入的", "wybug_corp": "phpcms", "wybug_author": "我想拿个shell", "wybug_date": "2013-01-16 15:56", "wybug_open_date": "2013-01-21 15:56", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 无意中看了一下phpcms的补丁，只想吐个槽。另外PHPCMS发布了补丁为什么不可以在论坛感谢一下wooyun平台呢，漏洞是我在平台发的多少可以提一下吧，这也是行业的一贯作风啊？ 详细说明：  \npublic function add_special_char(&$value) {\t\tif('*' == $value || false !== strpos($value, '(') || false !== strpos($value, '.') || false !== strpos ( $value, '`')) {\t\t\t//不处理包含* 或者 使用了sql方法。\t\t} else {\t\t\t$value = '`'.trim($value).'`';\t\t}\t\tif (preg_match(\"/\\b(select|insert|update|delete)\\b/i\", $value)) {\t\t\t$value = preg_replace(\"/\\b(select|insert|update|delete)\\b/i\", '', $value);\t\t}\t\treturn $value;\t}\n   漏洞证明：  将多个字符替换为空是不安全的。seselectlect经过这个函数就会变成select，因为中间的select被替换为空了。   修复方案：  你再想想？请在补丁发布页面感谢一下wooyun，在代码补丁处及补丁说明页面提供漏洞提交者信息是行业惯例。   版权声明：转载请注明来源 我想拿个shell@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-01-21 15:56 厂商回复：  最新状态： 2013-01-21：@我想拿个shell@乌云-------------------------------------------------------如果wooyun平台希望在phpcms做推广，我们很乐意帮助！  ", "replys": "漏洞评价：\n评论\n          这些评论似乎很乌云~~~思密达          2013-01-16 15:58 |\t\t\t\t\t我想拿个shell \t\t\t( 实习白帽子  |\t\t\t\t\t\tRank:70 漏洞数:5\t\t\t| 好码近似诗，挫码不如屎。)\t\t\t\t\t\t\t\n  刚看到wooyun的帮助里也写了这个要求：http://www.wooyun.org/helpb）尊重问题提交者，在必要的程序更新日志和安全公告时能够署名问题发现者和漏洞来源，譬如某某某@wooyun  WooYun: 皮皮播放器ActiveX出现溢出漏洞第三波    \n     2013-01-22 11:01 |\t\t\t\t\t乱雪 \t\t\t( 路人 |\t\t\t\t\t\tRank:2 漏洞数:3\t\t\t| 一事无成，身心半健，穷。)\t\t\t\t\t\t\t\n  很显然限定了单词边界的，不能用楼主的方法绕过。。。在希望厂家感谢wooyun时，也希望各位洞主在亲手测试过后，连漏洞+测试例子一同附上，这样说服力比较强。有时候不能光通过阅读代码后主管判断就发漏洞公告的：）    \n     2013-01-22 13:17 |\t\t\t\t\t我想拿个shell \t\t\t( 实习白帽子  |\t\t\t\t\t\tRank:70 漏洞数:5\t\t\t| 好码近似诗，挫码不如屎。)\t\t\t\t\t\t\t\n  ：（ sorry 另外这个补丁没有考虑到magic_quote_gpc为off下的SQL注射，在那个环境下补丁依旧是无效的，关于这个事情，我写到了http://zone.wooyun.org/content/2444中。    \n   \n \n     2013-01-16 15:57 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  “我是如何” 体火了    \n     2013-01-16 15:58 |    \t\t我想拿个shell \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:5        | 好码近似诗，挫码不如屎。)\t\t \n  刚看到wooyun的帮助里也写了这个要求：http://www.wooyun.org/helpb）尊重问题提交者，在必要的程序更新日志和安全公告时能够署名问题发现者和漏洞来源，譬如某某某@wooyun  WooYun: 皮皮播放器ActiveX出现溢出漏洞第三波    \n     2013-01-16 16:00 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  全是马甲 其实都是一个人，一个人    \n     2013-01-16 16:11 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  收到电视剧更新 前来围观！！    \n     2013-01-16 16:16 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  我是如何XXOOXXOOXXOO的~    \n     2013-01-16 16:49 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @我想拿个shell  的确，厂商应该知道点起码的尊重...    \n     2013-01-16 19:47 |    \t\t蓝风 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:25        | 崬汸慾哓 嗼檤焄垳皁 沓猵圊屾亾沬荖 颩憬...)\t\t \n  你可以@phpcms 它    \n     2013-01-17 08:27 |    \t\tClar \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 当前无)\t\t \n  Mark!!!!洞主威武    \n     2013-01-21 17:25 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  厂商不厚道！    \n     2013-01-21 17:25 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  厂商不厚道！    \n     2013-01-21 17:47 |    \t\t斯文的鸡蛋 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:41        | 我在这头，你在那头~)\t\t \n  可耻的笑了    \n     2013-01-21 18:41 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  厂商先修复吧...    \n     2013-01-21 23:17 |    \t\trdpclip \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:4        | 脚踏实地，不慕虚华，实事求是的rdpclip)\t\t \n  我认为厂商的回复可以这样理解：搜集所有phpcms漏洞，简单写个批量脚本修改主页+黑帽SEO来做WooYun的推广，PHPCMS不会介意的。Ps：纯属虚构，如有雷同，纯属巧合    \n     2013-01-22 00:54 |    \t\t小雨 \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:19        | phper)\t\t \n  洞主的正则学的不及格，\\b是匹配单词边界的, seselectlect中的select显然是不能匹配的。    \n     2013-01-22 11:01 |    \t\t乱雪 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | 一事无成，身心半健，穷。)\t\t \n  很显然限定了单词边界的，不能用楼主的方法绕过。。。在希望厂家感谢wooyun时，也希望各位洞主在亲手测试过后，连漏洞+测试例子一同附上，这样说服力比较强。有时候不能光通过阅读代码后主管判断就发漏洞公告的：）    \n     2013-01-22 11:09 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @乱雪 +1    \n     2013-01-22 11:11 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @乱雪 貌似之前洞主发了好几个phpcms漏洞吧    \n     2013-01-22 11:17 |    \t\t乱雪 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | 一事无成，身心半健，穷。)\t\t \n  @xsser 可能挖上瘾了 在“我又发现一个漏洞”的情况下一激动，就提交到wooyun了 哈哈。。    \n     2013-01-22 13:17 |    \t\t我想拿个shell \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:5        | 好码近似诗，挫码不如屎。)\t\t \n  ：（ sorry 另外这个补丁没有考虑到magic_quote_gpc为off下的SQL注射，在那个环境下补丁依旧是无效的，关于这个事情，我写到了http://zone.wooyun.org/content/2444中。    \n     2013-01-22 13:19 |    \t\t我想拿个shell \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:5        | 好码近似诗，挫码不如屎。)\t\t \n  @小雨 @乱雪 感谢二位。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}