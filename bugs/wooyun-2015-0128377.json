{"id": 46605, "wybug_id": "wooyun-2015-0128377", "wybug_title": "通联支付多台服务器存在任意文件上传漏洞（已getshell）", "wybug_corp": "allinpay.com", "wybug_author": "路人甲", "wybug_date": "2015-07-22 15:26", "wybug_open_date": "2015-09-06 13:34", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向公众公开  简要描述： 通联支付多台服务器存在任意文件上传漏洞（已getshell） 详细说明：  1.http://weixin.allinpay.com/\n\n上传成功\n\n执行成功，系统好老啊，应该能轻松提上root的吧。\nLinux tlwx_web02 2.6.18-164.el5 #1 SMP Tue Aug 18 15:51:48 EDT 2009 x86_64 x86_64 x86_64 GNU/Linux\n2.http://ocs.allinpay.com:8082/\n\n这台直接就是root了\n\n   漏洞证明：  \n##memcache paramsinitConnNum=5minConnNum=5maxConnNum=50maintSleepTime=5serverList=188.0.51.172:11211;188.0.51.173:11211##initservlet switchisInit=false##openid verificationopenidVerification=true##winxin numberwechatNo=allinpay-weixin##deskey pathdeskeyPath=/tlwx/conf/deskey.des##business urltlwxAppUrl=http://188.0.50.137:8080/tlwx-app/index.do?id=tlwxMerchantToBindUrl=http://weixin.allinpay.com/tlwx/merchant/toBind.dotlwxBillToQueryUrl=http://weixin.allinpay.com/tlwx/bill/toQuery.dotlwxImagesFwsqUrl=http://weixin.allinpay.com/tlwx/images/fwsq.jpgtlwxServiceToApplyTypeUrl=http://weixin.allinpay.com/tlwx/service/toApplyType.dotlwxImagesYwsqUrl=http://weixin.allinpay.com/tlwx/images/ywsq.jpgtlwxImagesWelcomeUrl=http://weixin.allinpay.com/tlwx/images/welcome.jpgtlwxBusinessToIntroductionUrl=http://weixin.allinpay.com/tlwx/business/toApplyType.dotlwxImagesCjhdUrl=http://weixin.allinpay.com/tlwx/images/banner2.giftlwxDrawIndexUrl=http://weixin.allinpay.com/tlwx/draw/index.do##oauth pagetlwxOauthGetOauthUrl=http://weixin.allinpay.com/tlwx/oauth/getOauth.do?tourl=rootUri=/tlwx##menu pagereHomePage=http://weixin.allinpay.com/tlwx/view/website/home.htmlreContactPage=http://weixin.allinpay.com/tlwx/view/website/contact_us.htmlreBindPage=http://weixin.allinpay.com/tlwx/merchant/toBind.doreAboutTonglianPage=http://weixin.allinpay.com/tlwx/view/website/about_tonglian.htmlreComplaintPage=http://weixin.allinpay.com/tlwx/service/toApply.do?type=6##weixin interfaceaccessTokenUrl=https://api.weixin.qq.com/cgi-bin/token?grant_type=client_credential&appid=APPID&secret=APPSECRETmenuCreateUrl=https://api.weixin.qq.com/cgi-bin/menu/create?access_token=ACCESS_TOKENgetUsersUrl=https://api.weixin.qq.com/cgi-bin/user/get?access_token=ACCESS_TOKEN&next_openid=NEXT_OPENIDoauth2GetCodeUrl=https://open.weixin.qq.com/connect/oauth2/authorize?appid=APPID&redirect_uri=REDIRECT_URI&response_type=code&scope=SCOPE&state=STATE#wechat_redirectoauth2GetOpenIdUrl=https://api.weixin.qq.com/sns/oauth2/access_token?appid=APPID&secret=SECRET&code=CODE&grant_type=authorization_codegetUserInfoUrl=https://api.weixin.qq.com/cgi-bin/user/info?access_token=ACCESS_TOKEN&openid=OPENID&lang=zh_CNtlwxPrizesActivityUrl=http://mp.weixin.qq.com/s?__biz=MzA3ODA3MTUzNQ==&mid=201721368&idx=1&sn=560e427119f5c90a529994966b5927e7#rd##sign tokensignToken=tlwx_wanghua38675547appId=wx101d21fc68055583appSecret=5ef092a0ba8f90451c9440b945be5e72##cookie parameters#60*60*24*30=2592000;60*60*24*365=31536000maxAge=2592000domain=.allinpay.com##appServiceCheckListappServiceCheckList=188.0.51.172:8080;188.0.51.173:8080checkUrlTlwxApp=http://APPSERVICE/tlwx-app/ServiceCheckServlet##luck drawdrawType=100drawBeginTime=20141201000000drawEndTime=20150131235959\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-07-23 13:32 厂商回复： 谢谢,我们已着手进行系统修复工作. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}