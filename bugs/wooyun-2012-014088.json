{"id": 15757, "wybug_id": "wooyun-2012-014088", "wybug_title": "盛大某站SQL注入拿webshell居然是root", "wybug_corp": "盛大在线", "wybug_author": "浩天", "wybug_date": "2012-10-30 19:35", "wybug_open_date": "2012-12-14 19:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-10-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-10-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-11-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-11-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-14：\t细节向公众公开  简要描述： N多问题：1.存在SQL注入点2.存在跨站点3.存在phpmyadmin可以访问4.无错误相应机制，爆路径5.最后拿到root权限的webshell6.居然与盛大主站同一网段7.还有太多问题...... 详细说明：  1.注入点：http://market.sdo.com/snda_market_0.2/detail.php?id=2304%20and%201=2%20union%20select%201,2,user%28%29,4,database%28%29,version%28%29,7,8,@@basedir,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,@@datadir,29,30--2.PMA：http://market.sdo.com/phpmyadmin/   漏洞证明：  1.注入点：\n\n2.服务器配置：\n\n3.爆mysql用户：\n\n配合这个http://market.sdo.com/phpmyadmin/ 知道能干嘛吧4.爆路径：\n\n5.load_file读源码找mysql密码(明文)：\n\n6.爆管理员(不知道哪个是)：\n\n\n\n\n\n后台入口还真没找到7.跨站确定没开启magic_quote_gpc,也没对引号过滤、转译\n\n8.load_file它媳妇outfile输出了1句话，拿到了webshell\n\n9.居然是root\n\n10.点到为止了，赶紧修吧，发现和主站在同一个网段   修复方案：  你们比我专业。你们懂的。   版权声明：转载请注明来源 浩天@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-10-31 15:03 厂商回复： 谢谢浩天兄的反馈，我们立即处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-10-30 20:54 |    \t\t盛大在线(乌云厂商)\t\t \n  细节在哪里？    \n     2012-10-30 21:35 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @盛大在线 在@盛大网络 那里    \n     2012-10-30 21:37 |    \t\tSunshine \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:10        | Nothing.)\t\t \n  漏了漏了！！！    \n     2012-10-30 22:01 |    \t\t盛大在线(乌云厂商)\t\t \n  @xsser  其实我是盛大游戏，有点乱，有管理在么？    \n     2012-10-30 23:38 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @盛大在线 @盛大游戏 @盛大网络 @盛大起点 @盛大彩虹 @盛大密宝 @盛大安全 我试试有几个管理    \n     2012-10-31 01:40 |    \t\t冷冷的夜 \t\t\t( 普通白帽子  |\t\t\t        Rank:135 漏洞数:12        )\t\t \n  @盛大在线 @盛大妹子 在哪里    \n     2012-10-31 09:01 |    \t\t盛大在线(乌云厂商)\t\t \n  继续等细节啊    \n     2012-10-31 09:41 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  忘说了，还有phpinfo()的测试页，这个站的存在就是个bug    \n     2012-10-31 09:56 |    \t\tSeay \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:8        )\t\t \n  @盛大在线 @盛大妹子 在哪里    \n     2012-10-31 11:28 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  @盛大在线 貌似我应该发给你，sdo的站    \n     2012-10-31 13:59 |    \t\t盛大在线(乌云厂商)\t\t \n  没错，我正在等细节呢    \n     2012-10-31 13:59 |    \t\t盛大在线(乌云厂商)\t\t \n  @浩天 没错，我正在等细节呢    \n     2012-10-31 14:02 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @盛大在线 修改了 ：）    \n     2012-10-31 14:47 |    \t\t盛大在线(乌云厂商)\t\t \n  @xsser 多谢，正在确认问题    \n     2012-11-23 23:06 |    \t\t猴子 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:5        | 我是一只骚猴子)\t\t \n  @蟋蟀哥哥 @盛大妹子 @盛大充气娃娃 @盛大MM @盛大美女 @盛大。。。。。。。。。。@盛大各种    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}