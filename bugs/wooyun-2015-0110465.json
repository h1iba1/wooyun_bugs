{"id": 32733, "wybug_id": "wooyun-2015-0110465", "wybug_title": "同程旅游旗下多平台共享用户信息，设计缺陷可导致撞库", "wybug_corp": "苏州同程旅游网络科技有限公司", "wybug_author": "纳米翡翠", "wybug_date": "2015-04-27 10:31", "wybug_open_date": "2015-06-11 11:00", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-11：\t细节向公众公开  简要描述： 同程旅游旗下多平台共享用户信息，设计缺陷可导致撞库 详细说明：     漏洞证明：  从主站上可以看到同程旗下重点推三个网站\n\n在主站ly.com下面似乎不存在这个问题，但17u.net却可以发挥fuzzing首先在ly.com下面注册用户，在17u.net下面登录或者在17u.net下面注册，在ly.com下面登录我就不截图了。这个是100%可以的。因为两边我都试过了。包括在17u.com下面也是可以登录的。那么fuzzing发生在哪里呢？就是在17u.net下面首先fuzzing用户名在17u.net下面注册的时候如果手机号码已经存在，会有这样的提示\n\n如果不存在，会有这样的提示\n\n抓包可以看到，存在时返回status:200\n\n不存在时返回status:100\n\n那通过这个status，我们就可以判断账号是否存在，可以进入账号fuzzing再说密码fuzzing.17u.net里面没有对登录做任何限制，也就是可以通过脚本或者burp无限登录尝试\n\n\n\n同样登录失败的时候会返回status200\n\n登录成功的时候会返回status100\n\n这个问题老早就发现了，但一直没提，因为想到可能会被忽略，直到我看到这些： WooYun: 携程某管理系统存在缺陷导致无限扫号 # 2  WooYun: 携程某管理系统存在缺陷导致无限装库之3 （附验证脚本与结果）  WooYun: 携程某酒店系统验证码存在缺陷导致无限撞库之4 所以还是提出来吧，避免同样的问题在同程发生。   修复方案：     版权声明：转载请注明来源 纳米翡翠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-04-27 10:59 厂商回复： 感谢关注同程旅游，主站对撞库做了防护，这个站是另外一个项目组维护的，没关注到。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}