{"id": 70553, "wybug_id": "wooyun-2015-0134022", "wybug_title": "中国中钢集团公司某业务Getshell导致OA沦陷", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "只抽红梅", "wybug_date": "2015-08-17 20:59", "wybug_open_date": "2015-10-03 18:58", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-19：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-08-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-03：\t细节向公众公开  简要描述： 中国中钢集团公司某业务存在漏洞，可导致 Getshell，并且 root 权限，进一步沦陷 OA 系统。 详细说明：  1. http://**.**.**.** 存在 FCKEditor 文件上传漏洞，漏洞地址：\nhttp://**.**.**.**/editor/editor/filemanager/upload/php/upload.php\n对漏洞利用直接获取 webshell 为：\nhttp://**.**.**.**/upload/File/l.php 密码 l\n2. 之前发现在这台服务器上面还开放 8888 端口，运行 tomcat 服务，并没有猜到用户名和密码3. 在 “E:\\Program Files\\htoa\\Tomcat\\conf\\tomcat-users.xml” 文件中找到用户名和密码：\n<user username=\"admin\" password=\"147887.asd\" roles=\"admin,manager\"/>\n，直接登录 tomcat 管理后台，发现已经被人上传过后门，如下图\n\n4. 查看 one.jsp 发现为 jsp 一句话 webshell，密码为 147 如下图\n\n5. 通过菜刀连接 jsp 一句话后门，权限为 system \n\n6. 8888 端口运行一套 OA 系统，翻到数据库配置文件，找到连接帐号密码：\njdbc:mysql**.**.**.**:3316/oa8000?user=root&password=htoa8000\n7. 获取 OA 用户数据\n\n通过对密码进行 md5 解密能够登录用户的 OA，比如：\n用户：yangxl，密码：868686\n登录 OA 如下：\n\n   漏洞证明：  \n\n   修复方案：  1. 修复文件上传漏洞2. 删除 tomcat 管理后台3. 清理后门   版权声明：转载请注明来源 只抽红梅@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-08-19 18:56 厂商回复： CNVD确认所述情况,已经转由CNCERT向能源行业信息化主管部门通报,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}