{"id": 56719, "wybug_id": "wooyun-2014-056776", "wybug_title": "暨南大学教务处系统配置漏洞导致getshell", "wybug_corp": "暨南大学", "wybug_author": "Gump", "wybug_date": "2014-04-14 17:27", "wybug_open_date": "2014-05-29 17:28", "wybug_type": "重要敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-29：\t细节向公众公开  简要描述： 通过注入漏洞获取到帐号以及通过加密后的密码，网站测试时没有删掉测试文件，访问这些文件可以从网上找到相关加密算法，通过这些资料可以把密文转回明文。进入服务器后可以获得大量学生个人信息 详细说明：  SQL注入就不说了从网上找到了相关的加密算法\n<%Class clsRSAPublic PrivateKeyPublic PublicKeyPublic ModulusPublic Function Crypt(pLngMessage, pLngKey)On Error Resume NextDim lLngModDim lLngResultDim lLngIndexIf pLngKey Mod 2 = 0 ThenlLngResult = 1For lLngIndex = 1 To pLngKey / 2lLngMod = (pLngMessage ^ 2) Mod Modulus' Mod may error on key generationlLngResult = (lLngMod * lLngResult) Mod ModulusIf Err Then Exit FunctionNextElselLngResult = pLngMessageFor lLngIndex = 1 To pLngKey / 2lLngMod = (pLngMessage ^ 2) Mod ModulusOn Error Resume Next' Mod may error on key generationlLngResult = (lLngMod * lLngResult) Mod ModulusIf Err Then Exit FunctionNextEnd IfCrypt = lLngResultEnd FunctionPublic Function Encode(ByVal pStrMessage)Dim lLngIndexDim lLngMaxIndexDim lBytAsciiDim lLngEncryptedlLngMaxIndex = Len(pStrMessage)If lLngMaxIndex = 0 Then Exit FunctionFor lLngIndex = 1 To lLngMaxIndexlBytAscii = Asc(Mid(pStrMessage, lLngIndex, 1))lLngEncrypted = Crypt(lBytAscii, PublicKey)Encode = Encode & NumberToHex(lLngEncrypted, 4)NextEnd FunctionPublic Function Decode(ByVal pStrMessage)Dim lBytAsciiDim lLngIndexDim lLngMaxIndexDim lLngEncryptedDataDecode = \"\"lLngMaxIndex = Len(pStrMessage)For lLngIndex = 1 To lLngMaxIndex Step 4lLngEncryptedData = HexToNumber(Mid(pStrMessage, lLngIndex, 4))lBytAscii = Crypt(lLngEncryptedData, PrivateKey)Decode = Decode & Chr(lBytAscii)NextEnd FunctionPrivate Function NumberToHex(ByRef pLngNumber, ByRef pLngLength)NumberToHex = Right(String(pLngLength, \"0\") & Hex(pLngNumber), pLngLength)End FunctionPrivate Function HexToNumber(ByRef pStrHex)HexToNumber = CLng(\"&h\" & pStrHex)End FunctionEnd Classfunction Encryptstr(Message)Dim LngKeyEDim LngKeyDDim LngKeyNDim StrMessageDim ObjRSALngKeyE = \"32823\"LngKeyD = \"20643\"LngKeyN = \"29893\"StrMessage = MessageSet ObjRSA = New clsRSAObjRSA.PublicKey = LngKeyEObjRSA.Modulus = LngKeyNEncryptstr = ObjRSA.Encode(StrMessage)Set ObjRSA = Nothingend functionFunction Decryptstr(Message)Dim LngKeyEDim LngKeyDDim LngKeyNDim StrMessageDim ObjRSALngKeyE = \"32823\"LngKeyD = \"20643\"LngKeyN = \"29893\"StrMessage = MessageSet ObjRSA = New clsRSAObjRSA.PrivateKey =LngKeyDObjRSA.Modulus=LngKeyNdecryptstr=ObjRSA.Decode(StrMessage)Set ObjRSA = Nothingend function%>\n从此算法可以得出字符对照表(此资料可参照\"饭团尔想迩\"的博客)1_____6EBB2_____5C1F3_____4D754_____26CC5_____4F886_____3F4E7_____0A9D8_____1A1C9_____6D200_____1089a_____0F3Eb_____3159c_____3517d_____419Ce_____615Cf_____556Fg_____2B7Fh_____0F9Ci_____00FAj_____5A50k_____2850l_____3E7Bm_____71C5n_____1FC8o_____74C1p_____5FB8q_____6085r_____3AC4s_____2F50t_____36F8u_____7010v_____0B42w_____1C7Ax_____16F8y_____2EE7z_____5CF3!_____6233@_____3A45#_____2291$_____5D5C%_____09B9^_____43EA&_____62B9*_____6301(_____4659)_____5C82服务器上面存在大量学生个人信息，可找到身份证等信息   漏洞证明：  \n\n上传一句话木马\n\nhttp://202.116.0.173/DownloadMore.asp?DownloadClassID=4此页面可进行注入\n\n   修复方案：  先修补该SQL注入漏洞吧.....加密算法换成别的   版权声明：转载请注明来源 Gump@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2014-04-16 11:33 厂商回复： 正在通知相关学校处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}