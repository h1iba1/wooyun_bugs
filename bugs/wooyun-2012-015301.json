{"id": 16090, "wybug_id": "wooyun-2012-015301", "wybug_title": "腾讯QQ客户端某功能设计存在严重缺陷。", "wybug_corp": "腾讯", "wybug_author": "zeracker", "wybug_date": "2012-11-27 00:18", "wybug_open_date": "2012-11-27 11:03", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感信息泄露", "逻辑错误", "设计不当", "设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 腾讯QQ客户端某功能机制存在严重安全问题，QQ会员服务可变成犯罪份子帮凶。亲，你还在使用QQ会员吗？你妹，啥时候能给我把这个妹子的QQ密保改回来？太晚了，睡觉去了。。如果修复及时，PKAV提前公布。 详细说明：  腾讯QQ客户端聊天记录漫游功能机制存在问题，笔者在另一台电脑上测试QQ漫游记录功能，无需对用户密保进行认证可直接设置QQ漫游聊天记录独立密码功能。危害：一旦用户密码泄露，若用户未设置其独立密码功能，可直接设置用户聊天记录独立密码，非会员可造成泄露所有好友1周聊天记录，QQ会员则会泄露1个月聊天记录信息。如果用户使用QQ进行商务办公、亲友聊天等等，包含在聊天记录中的敏感信息一旦泄露，可对用户自身造成重大影响。亲，你还在使用QQ聊隐私信息吗啊？   漏洞证明：  具体测试过程如下：1.常用地:北京测试QQ：4XXXXXX二代密保+QQ会员。测试环境为QQ2012正式版首先我们直接打开一个聊天框，选择聊天记录，漫游消息。直接跳出设置聊天记录独立密码。\n\n为了证明真实性，测试QQ登陆QQ安全中心(aq.qq.com),页面显示二代密保，手机和邮箱均为绑定。\n\n具体测试过程，好友本地消息显示聊天记录为一页，\n\n我们直接设置了一个长达15位的密码。\n\n即可直接获取到与好友1个月的聊天记录，并且系统提示：尊敬的QQ会员，已为您漫游全体好友30天的消息记录，您还可以永久漫游与该好友的消息记录。具体危害，大家可以想象的到，后文会提到具体利用过程。\n\nQQ会员2代密保测试结果，成功!！！\n\n接下来我们测试一个异地登陆的1代密保用户。一代QQ：1013XXXX我们直接登陆该女号，显示账号异常。\n\n我们直接给该号发信息测试，QQ安全中心直接提示了谨防他人冒充好友骗钱。（账户有异常..........忽略一万字）。\n\n我们测试直接可设置异地登陆的一代密保用户QQ服务独立密码。。\n\n设置成功，测试漫游聊天记录信息。系统显示：已为您漫游最近7天的消息记录（不含图片）QQ会员用户可以永久漫游消息记录与图片.....测试成功！！！\n\n使用测试QQ登陆QQ安全中心（aq.qq.com），则显示账号存在异常，但仍然可以设置。\n\n其实我们一直在思考，腾讯QQ用户基数如此之大，网民的日常生活已经离不开QQ了，但从安全的角度上看，反而带来了更大的危害。犯罪份子为什么能够很轻易获取到各种敏感信息呢？接下来我们测试一下。\n\n\n\n\n\n搜索关键字可用\" 账号、密码、手机号码、银行、卡号、支付宝、身份证等等敏感关键字进行搜索\"，犯罪份子永远比开发人员、安全人员更聪明，只有这群人知道一个漏洞能带来的“价值”有多大。附图新闻:\n\n\n\n最后，我想说的是，QQ你妹啊，妹子天天跟我闹，密码泄露密保忘记申述不成功，这忒安全了吧？强烈抗议，改个密保吧。   修复方案：  加密保验证等等。。。。。其实我说的是，这个月没礼物了。： （乌云你看着办吧。   版权声明：转载请注明来源 zeracker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-11-27 11:03 厂商回复： 非常感谢您的报告。这个问题我们经过评估，暂未发现可以对用户或者业务产生影响，故忽略。如果您对于该结论有任何的疑问，欢迎反馈指正，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-11-27 00:20 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  我擦，重复了2张图片。。。。。。伤不起    \n     2012-11-27 00:32 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @zeracker 编辑下，看不懂    \n     2012-11-27 01:09 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  ........ 仔细看了下 觉得是打酱油了    \n     2012-11-27 01:44 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @xsser 剑总，我愧对于你了。    \n     2012-11-27 01:50 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @风萧萧 怎么讲    \n     2012-11-27 02:07 |    \t\t斯文的鸡蛋 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:41        | 我在这头，你在那头~)\t\t \n  @风萧萧 干坏事了？    \n     2012-11-27 07:15 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @xsser 好吧，应该听lake2的直接扔TSRC，我只想说这玩意影响到我自己了    \n     2012-11-27 08:38 |    \t\tSunshine \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:10        | Nothing.)\t\t \n  嘿嘿，客户端还有个好东西。只是加密方式还没看出来。    \n     2012-11-27 10:06 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @zeracker 哥，你在TSRC搜获的多还是乌云，你在TSRC结识的基友多还是乌云！乌云是娘家，常回来发发洞啊！    \n     2012-11-27 10:28 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @zeracker lake2用ipad诱惑你了么    \n     2012-11-27 10:46 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  @zeracker 麻烦下次要么直接发TSRC.要么就别挂着PKAV的名字在乌云发这样的内容.    \n     2012-11-27 10:58 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @zeracker 蛋定，要经得起诱惑~    \n     2012-11-27 11:02 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  好吧。 封号，WB全捐公益    \n     2012-11-27 11:03 |    \t\t心伤的胖子 \t\t\t( 普通白帽子  |\t\t\t        Rank:308 漏洞数:29        | 因为心伤，所以胖子。)\t\t \n  @zeracker 我是公益，捐给我啊，魂蛋！！！    \n     2012-11-27 11:15 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  信仰和ipad是难选啊!哈哈    \n     2012-11-27 11:19 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  @shine 难选么?PKAV的人从来都不犹豫    \n     2012-11-27 11:23 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @only_guest 别乱扣帽子    \n     2012-11-27 11:25 |    \t\t米兰春天 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 1)\t\t \n  看了这个漏洞，觉得301犯不着这么长的问题描述吧。。。    \n     2012-11-27 11:33 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  @zeracker 至少我们做的很好.意见不统一罢了.    \n     2012-11-27 11:46 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @only_guest ： ） 我只看态度。    \n     2012-11-27 11:59 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @zeracker 别怒啊... 真的是漏洞看法的不一致 这个你认为应该如何修复啊    \n     2012-11-27 12:24 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  @zeracker @zeracker @xsser 好好沟通，不要说气话，各位大哥，不是一个人能撑起这个平台，不是一个人牛逼就行了，靠大家，白菜路过    \n     2012-11-27 13:31 |    \t\ticeyes \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:6        | 老马塞个里！)\t\t \n  懒婆娘的裹脚布，又长又臭。1.查看QQ漫游聊天记录时设置QQ服务独立密码没有二次验证。2.QQ默认开启了漫游聊天记录功能，待验证。（其实我们的聊天记录都被记录了）3.可导致当QQ被盗，而未设置QQ服务独立密码的情况下，盗QQ者可以远程查看一定时间内的QQ聊天记录，其中可能包括各类隐私信息、身份信息，可为QQ诈骗提供了有利素材。建议腾讯开启二次验证，但不要使用QQ密码作为验证。PS，其实腾讯已经考虑到了，设置独立密码时不允许使用当前QQ使用的密码。    \n     2012-11-27 13:34 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  两点，1 301犯不着因为无聊或者干嘛花费那么长时间来的描述这个问题所在的严重性质。2 QQ诈骗这种事情不少见，301这么描述也是为了大家能提防下这点，剑心 过客跟301的想法可能不一致，所有导致301要走人。 不管是TSRC也好还是乌云也好，如果你心里认为你是搞技术的，那么这个问题就很严重的，相反，亲，还是走人吧。娱乐圈不好混个人认为301提交的这个很严重。。出来混迟早要还的，早晚有一天会出现在你们身上或者你们周围，到时候你们就知道这问题的严重性了    \n     2012-11-27 14:35 |    \t\t陈再胜 \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:13        | 微博收收听~~~●﹏●)\t\t \n  我敢赌1个乌云币，腾讯未来肯定会修复这个漏洞·······    \n     2012-11-27 15:11 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  @陈再胜 我赌2个乌云币，要是腾讯不修复这个漏洞 我让老西把红黑给关掉     \n     2012-11-27 15:15 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @腾讯 这确实属于很严重的安全缺陷  作为用户量如此大的IM聊天软件  你们有责任避免任何可能威胁使用者利益的问题或缺陷  你们所说的“暂未发现可以对用户或者业务产生影响” 对你们业务确实无影响 但这可能威胁用户的利益  应该先从用户的角度出发吧？  真心觉得@zeracker 挺冤    \n     2012-11-27 16:32 |    \t\t小猪太子 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:8        | 地球人)\t\t \n  话说，这个BUG其实影响很大的，我在10月发现的，我在乌云发布，被剑心忽略，10月28号我把BUG在自己的博客公布了 地址http://www.zhuhongliu.cn/?post=43    \n     2012-11-27 16:35 |    \t\t小猪太子 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:8        | 地球人)\t\t \n  这个BUG绝对的影响很大的，特别针对女朋友管得严的，这个BUG 被搞IT的妹子了解之后，对于本来就猥琐的男男来说，简直就是一个很凶残的事情！！！腾讯做事情怎么这样？那么PC客户端的密码验证有何意义？    \n     2012-11-27 16:38 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  遇到了，确实能发生像301描述的严重情况~但是影响的群体与庞大的用户基数比起来就小的太多了~虽然这样~作为全球用户量no.1的IM来说~确实应该引起重视~~    \n     2012-11-27 16:44 |    \t\t小猪太子 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:8        | 地球人)\t\t \n  @小猪太子 顺便解释下哈，PKAV写的是一些没有设置过漫游密码的，对于我的那个，是你已经设置过漫游密码了，但是只要有QQ密码，不需要密码保护等直接绕过漫游密码验证的，抱歉，刚没仔细看内容对于 PKAV 的这个，个人觉得无法修补，除非重新设计整个用户习惯操作方式……    \n     2012-11-27 16:53 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  这个问题我是这样理解的，这样的设计肯定是不妥当的，但是还没有上升到能直接利用的漏洞的层面。还停留在可能存在风险的层面。TX忽略了确实不妥。    \n     2012-11-27 16:54 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @xsjswt 我觉得提交者定位风险等级为高 也有点问题...     \n     2012-11-27 17:18 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @xsser 着眼点不一样罢了，作者认为涉及到个人隐私信息就是大问题，自评高危也无可厚非~~    \n     2012-11-27 17:20 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  @se55i0n @xsser 是的。对于个人的特定情况来说，这个很可能是一个大问题。但是对于一个企业来说，问题还不算很严重。没有听说过亏几十W就垮掉的企业，但是没有听说过被骗了几W软妹币还心理很淡定的屌丝。    \n     2012-11-27 17:20 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  类似的问题我也碰到过，我个人评估安全风险是中，被管理员改为低，最后还被忽略了，但随后给出的实际案例，足以评为高。所以，肯定要看到实际案例及可利用成本的，当然还让厂商觉得这不会是个例。    \n     2012-11-27 17:52 |    \t\t小猪太子 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:8        | 地球人)\t\t \n  @xsser 帮忙查下，我没通过的那个BUG，就是无密码可以绕过QQ漫游密码验证的。我测试过很多次，也有很多人都测试了。如果你觉得我的那一点不对，麻烦加下我Q57-93-094  谢谢    \n     2012-11-27 17:57 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @小猪太子 漏洞id多少?    \n     2012-11-27 23:08 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @iceyes 奇怪了，在我的测试中，漫游消息功能只有会员才能开通，非会员无论怎么测都不行，界面会一直提示“只需5秒点击，3步操作，就可以拥有1辈子的回忆已有千万QQ会员使用消息记录漫游，赶快加入吧”。所以理解不了“非会员可造成泄露所有好友1周聊天记录”的说法...    \n     2012-11-28 10:27 |    \t\t小猪太子 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:8        | 地球人)\t\t \n  @xsser 我今天重新提交一次吧    \n     2012-11-28 10:30 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @小猪太子 客观点 详细点 嗯 ：）    \n     2012-11-28 11:06 |    \t\t小猪太子 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:8        | 地球人)\t\t \n  @xsser 搞定了    \n     2014-08-09 11:14 |    \t\t包子哥 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | test)\t\t \n  腾讯你妈逼，为对你们业务造成影响，草泥马的，那用户呢？ 难道没有对用户造成影响么。@腾讯    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}