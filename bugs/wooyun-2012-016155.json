{"id": 14829, "wybug_id": "wooyun-2012-016155", "wybug_title": "库巴科技任意用户密码重置", "wybug_corp": "库巴科技", "wybug_author": "se55i0n", "wybug_date": "2012-12-17 22:55", "wybug_open_date": "2013-01-31 22:56", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-31：\t细节向公众公开  简要描述： 这个真不是来刷分的，前面的相同类型的洞重在描述漏洞的理论危害性，但是不具备很强的实际操作性；本例理论结合实际（图文并茂），具有较强的实际操作性！ 详细说明：  1）库巴科技的密码找回功能很强大，很大程度的方便了用户，但是方便的同时带来的风险也大大增加，库巴科技支持用户名、邮箱、手机三种用户信息找回密码；\n\n2）攻击者只要知道以上三种任意一种信息，便可使用手机找回密码功能重置用户密码（ps:购物网站用户基本上都会绑定手机号码），输入用户名或者邮箱系统将直接发送安全码到帐号绑定的手机号码；\n\n3）本例与之前相同类型的漏洞去别是：可以直接在获取用户的帐号信息，增加了漏洞利用的实际操作性；  3.1）来到网站某个产品的评论处，发现有很多用户在购买产品后对产品进行评价； \n\n      对应的源代码如下：\n<div class=\"usr\"><div class=\"avatar\"><img src=\"http://img.51mdq.com/logo/userlevel1_new.jpg\" alt=\"13916956033\" onerror=\"this.src='http://img.51mdq.com/logo/user_new.jpg'\"></div><p class=\"name\">13916956***</p><p class=\"info\">蜗居会员</p></div>\n   3.2）我们再能看另一处； \n\n    对应的源代码如下：\n<div class=\"usr\"><div class=\"avatar\"><img src=\"http://img.51mdq.com/logo/userlevel1_new.jpg\" alt=\"weinixiong521\" onerror=\"this.src='http://img.51mdq.com/logo/user_new.jpg'\"></div><p class=\"name\">weinixiong***</p><p class=\"info\">蜗居会员</p></div>\n   3.3）通过上面，我们不难发现img标签内的alt属性的命名规则正是与用户名相对应；有了这个发现我们就能找到大量的用户信息，大大增加了漏洞利用的实际操作性；4）现在开始使用手机密码找回功能吧（本次测试用的是本人自己的手机号码），随意输入一个6位数字的安全码；\n\n5）点击下一步提交并抓包；\n\n6）设置identifyCode参数为爆破对象，本例只为进行漏洞利用演示，爆破区间设置包含真实验证码的一个较小的6位数字区间进行爆破，根据提交的状态、返回字节长度均可确认真实验证码；\n\n7）返回抓包页面，使用真实验证码替代任意提交的identifyCode参数并比较，即可来到密码重置页面；\n\n8）输入我们要更改的密码并提交，用户密码重置漏洞利用完成；\n\n   漏洞证明：  见详细说明~   修复方案：  1)增加验证码的复杂程度，如:数字与大小写子母回合；2)限制校验错误次数；3)设置验证码的有效期；   版权声明：转载请注明来源 se55i0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-12-18 23:28 厂商回复： 谢谢你的发现和建议，我们会尽快处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-17 23:01 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  这么晚了，自己先来占个广告位！@xsser 剑心这个不算刷分吧，能算个好例子么？    \n     2012-12-17 23:03 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @se55i0n 看情况啊... 危害大的刷分也没关系 但是危害小的再虚报就有问题啦    \n     2012-12-17 23:05 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @xsser 哈哈，获取用户信息加爆破，自卖自夸下~~~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}