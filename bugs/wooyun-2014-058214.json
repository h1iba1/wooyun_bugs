{"id": 2807, "wybug_id": "wooyun-2014-058214", "wybug_title": "车辆GPS监控系统权限绕过漏洞导致全国众多地区车辆及人员信息泄露", "wybug_corp": "GPSweb", "wybug_author": "小威", "wybug_date": "2014-04-24 12:13", "wybug_open_date": "2014-07-23 18:42", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "越权操作"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-06-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-23：\t细节向公众公开  简要描述： rt- 详细说明：  言简意赅吧！没有了解清楚这个系统的具体开发公司！用360搜索引擎搜索“GPSweb” 为了省事 直接请看8-14页左右的位置！\n\n随便复制了一些来：\nhttp://61.156.14.159:8088/newmapware/Main.aspxhttp://219.133.34.198:8080/http://183.60.143.160:8086/http://211.162.125.200:8080/http://gpsweb.hn-dg.cn:8086/http://59.39.182.131:81/http://www.anxgps.com:6000/\n随便打开一个地址  管理用户登录（或者企业用户登录 这里的登录名称有修改）输入万能密码 admin'or'1'='1   密码随意  可直接登录系统\n\n\n\n\n\n   漏洞证明：  \n\n\n\n\n\n   修复方案：  此段摘自：http://www.2cto.com/Article/201101/82666.html方法1: Replace过滤字符解决方法:查找login.asp下的<from找到下边的类似username=request.Form(”name”)pass=request.Form(”pass”)修改为：username=Replace(request.Form(”name”), “’”, “’’”)pass=Replace(request.Form(”pass”), “’”, “’’”)语法是屏蔽’和’’字符来达到效果.方法2：在conn.asp 内加入注前提 登陆页面有)把以下代码保存为safe.asp程序代码<%Dim Query_Badword,Form_Badword,i,Err_Message,Err_Web,nameErr_Message = 3Err_Web = “safe.htm”’出错时转向的页面Query_Badword=”’|and|select|update|chr|delete|%20from|;|insert|mid|master.|set|chr(37)|=”’在这部份定义get非法参数,使用”|”号间隔Form_Badword=”’|(|)|;|=”’在这部份定义post非法参数,使用”|”号间隔On Error Resume Nextif request.QueryString”\" thenChk_badword=split(Query_Badword,”|”)FOR EACH Query_Name IN Request.QueryStringfor i=0 to ubound(Chk_badword)If Instr(LCase(request.QueryString(Query_Name)),Chk_badword(i))0 ThenSelect Case Err_MessageCase “1″Response.Write “alert(’传参错误！参数 “&name&” 的值中包含非法字符串！ 请不要在参数中出现：and update delete ; insert mid master 等非法字符！’);window.close();”Case “2″Response.Write “location.href=’”&Err_Web&”’”Case “3″Response.Write “alert(’传参错误！参数 “&name&”的值中包含非法字符串！ 请不要在参数中出现：and update delete ; insert mid master 等非法字符！’);location.href=’”&Err_Web&”’;”End SelectResponse.EndEnd IfNEXTNEXTEnd ifif request.form”\" thenChk_badword=split(Form_Badword,”|”)FOR EACH name IN Request.Formfor i=0 to ubound(Chk_badword)If Instr(LCase(request.form(name)),Chk_badword(i))0 ThenSelect Case Err_MessageCase “1″Response.Write “alert(’出错了！表单 “&name&” 的值中包含非法字符串！ 你的非法操作已记录,请马上停止非法行为！’);window.close();”Case “2″Response.Write “location.href=’”&Err_Web&”’”Case “3″Response.Write “alert(’出错了！参数 “&name&”的值中包含非法字符串！ 谢谢您光临！,请停止非法行为！’);location.href=’”&Err_Web&”’;”End SelectResponse.EndEnd IfNEXTNEXTend if%>   版权声明：转载请注明来源 小威@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-04-29 08:46 厂商回复： CNVD确认所述情况，暂未能通过公开联系渠道联系软件生产厂商。未进行处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}