{"id": 19836, "wybug_id": "wooyun-2012-06420", "wybug_title": "Discuz!X2.5Release20120407版命令执行", "wybug_corp": "Discuz!", "wybug_author": "kobin97", "wybug_date": "2012-04-26 20:03", "wybug_open_date": "2012-06-10 20:04", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-04-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-05-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-05-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-05-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-06-10：\t细节向公众公开  简要描述： Discuz!X2.5Release20120407版命令执行，官方4月13号更新了，但没提示更新内容和后台没提示升级！大家使用旧版本的自己赶快升级吧！ 详细说明：  Discuz!X2.5Release20120407版命令执行，官方4月13号更新了，但没提示更新内容和后台没提示升级！今天无意看了一下官网版本，发现更新了http://www.discuz.net/thread-2744369-1-1.html于是对比，发现修复了重要漏洞！但进入旧版后台没有任何提示升级。更新也没有说明作了那些修改。个人觉得这是个对用户不负责的行为！具体不说，看图吧：漏洞文件：upload\\source\\class\\helper\\helper_seo.php只要后台设置了，前台就能通过添加特殊内容进行命令执行。   漏洞证明：  \n\n\n\n\n\n\n\n\n\n   修复方案：  唉。其实想说，应该要有更新说明，对于一些不重要的可以不升级！   版权声明：转载请注明来源 kobin97@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2012-04-27 15:56 厂商回复： Discuz!是开源产品，很容易通过对比的手段找到以前的修正过的问题。所以这个虽然是高危问题，但鉴于早已经被修复，不能给过高的rank了。感谢您对Discuz！的关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-04-26 20:10 |    \t\tLitteryi \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 来自塞伯坦的天使。)\t\t \n  静静等待详细内容    \n     2012-04-26 20:59 |    \t\t斯文的鸡蛋 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:41        | 我在这头，你在那头~)\t\t \n  这个波及的厉害啊，一大堆没更新的论坛    \n     2012-04-26 21:23 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  不会又是修正符e引发的血案吧？    \n     2012-04-26 21:29 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  洞主根据更新逆推的么……    \n     2012-04-26 21:43 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @一刀终情 我也想问    \n     2012-04-26 21:46 |    \t\tkobin97  \t\t\t( 核心白帽子 |\t\t\t        Rank:1754 漏洞数:190        | 关注网络安全。。)\t\t \n  有关系么？^-^    \n     2012-04-26 22:36 |    \t\t北北 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:5        | 广告位招租。有阿里、万网的漏洞私信给我有...)\t\t \n  霸气 坐等    \n     2012-04-26 22:37 |    \t\t北北 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:5        | 广告位招租。有阿里、万网的漏洞私信给我有...)\t\t \n  @北北 没看说明 原来是diff出来的，我还以为是首发，赶紧去看看……谢楼主    \n     2012-04-26 22:39 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @kobin97 这是个好思路啊，类似大牛挖微软的洞~    \n     2012-04-26 23:25 |    \t\tYaseng \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:7        | 干)\t\t \n  去官网找 更新的  对比一下文件  看能逆向出来不     \n     2012-04-27 07:40 |    \t\tP w \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:14        | -这家伙很懒,什么都没有留下。其实我真的很...)\t\t \n  危险咯。。。。    \n     2012-04-27 09:31 |    \t\tqing \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 自由，平等，共享，互助)\t\t \n  关注中。。。    \n     2012-04-27 09:53 |    \t\tPhp0day \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | php安全开发、代码审计、渗透测试。)\t\t \n  回去对比一下咯    \n     2012-04-27 09:57 |    \t\t西毒 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:33        | 心存谦卑才能不断超越自我)\t\t \n  这个杀伤力大啊    \n     2012-04-27 10:12 |    \t\t神刀 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:3        | www.shellsec.com内射那么牛，虾米没妹子？)\t\t \n  牛B    \n     2012-04-27 10:16 |    \t\txiya \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n  马克    \n     2012-04-27 10:25 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  强烈关注。。    \n     2012-04-27 10:46 |    \t\tsker \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 暂无)\t\t \n  @北北 黑客你好    \n     2012-04-27 12:20 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  http://www.zhu.cm/discuz-x2-5-getwebshell-exp-xday.html    \n     2012-04-27 12:21 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  嘿嘿~    \n     2012-04-27 13:25 |    \t\tmario \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 可以省略吗)\t\t \n  dz每升级一个版本必出一洞啊    \n     2012-04-27 13:27 |    \t\thacx \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:6        )\t\t \n  漏洞比较鸡肋，这里有完整的exp http://weibo.com/2242334800/ygxonqLF9    \n     2012-04-27 15:30 |    \t\t北北 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:5        | 广告位招租。有阿里、万网的漏洞私信给我有...)\t\t \n  @hacx 其实不鸡肋，我只能说你没完全搞清楚，你的利用没错，但是太局限了。    \n     2012-04-27 16:19 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  只有这个一个小版本号么？Release20120407 ？    \n     2012-04-27 16:54 |    \t\tkobin97  \t\t\t( 核心白帽子 |\t\t\t        Rank:1754 漏洞数:190        | 关注网络安全。。)\t\t \n  RC 版没测试。其实想说漏洞严重不严重不重要。要提示升级呀！    \n     2012-04-27 17:13 |    \t\tkobin97  \t\t\t( 核心白帽子 |\t\t\t        Rank:1754 漏洞数:190        | 关注网络安全。。)\t\t \n  还在有较多人没升级或不知道升级。。。嘻嘻。。    \n     2012-04-27 17:16 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @kobin97 默认不可用的    \n     2012-04-27 17:24 |    \t\tkobin97  \t\t\t( 核心白帽子 |\t\t\t        Rank:1754 漏洞数:190        | 关注网络安全。。)\t\t \n  @xsser 嗯。默认是不可用。    \n     2012-04-27 22:49 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  .    \n     2012-05-02 09:52 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @hacx @xsser @kobin97 ，@北北 说“不鸡肋”的原因在此：http://yaonie.org/archives/165.html V5啊...我愣是被[attath]正则给误导了。    \n     2012-05-02 10:46 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @horseluke 属于附加功能，默认不开启的，中间时间也很短    \n     2012-05-02 11:15 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @xsser 站长多多少少都喜欢搞SEO的    \n     2012-05-06 12:01 |    \t\tkookxiang \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:6        | 苦逼PHP程序猿…)\t\t \n  @horseluke 神马原理？被模版引擎解析了？    \n     2012-05-06 12:07 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @kookxiang SEO模块中的preg_replace+修正符e+双引号引发的远程代码执行漏洞。链接写得比较清楚了    \n     2014-05-19 11:11 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  百度谜题 哈哈 原来在这里研究研究去    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}