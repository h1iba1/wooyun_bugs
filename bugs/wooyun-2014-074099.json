{"id": 51560, "wybug_id": "wooyun-2014-074099", "wybug_title": "深圳市社会保障卡单位系统存在命令执行", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "袋鼠妈妈", "wybug_date": "2014-08-27 18:48", "wybug_open_date": "2014-10-11 18:50", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-11：\t细节向公众公开  简要描述： 深圳市社会保障卡单位系统存在命令执行 详细说明：  深圳市社会保障卡单位系统:（看到银行朋友在朋友圈发的,说是所有的社保卡都要换了,可以直接去办理,带上身份证和社保卡。）地址:https://zk.szsi.gov.cn/jrsbksb/dwlogin.action\n\n\n\n\nTarget: https://zk.szsi.gov.cn/jrsbksb/dwlogin.actionWhoami: weblogicWebPath: OS.Name: LinuxOS.Version: 2.6.18-194.el5Java.Home: /bea/jdk160_24/jreJava.Version: 1.6.0_24OS.arch: i386User.Name: weblogicUser.Home: /home/weblogicUser.Dir: /bea/user_projects/domains/JRSBKSB_9002Java.Class.Path: /bea/user_projects/domains/JRSBKSB_9002/lib/jt400.jar:/bea/user_projects/domains/JRSBKSB_9002/lib/util400.jar:/bea/user_projects/domains/JRSBKSB_9002/lib/antlr-2.7.6.jar:/bea/user_projects/domains/JRSBKSB_9002/lib/commons-lang-2.3.jar:/bea/patch_wls1035/profiles/default/sys_manifest_classpath/weblogic_patch.jar:/bea/jdk160_24/lib/tools.jar:/bea/wlserver_10.3/server/lib/weblogic_sp.jar:/bea/wlserver_10.3/server/lib/weblogic.jar:/bea/modules/features/weblogic.server.modules_10.3.5.0.jar:/bea/wlserver_10.3/server/lib/webservices.jar:/bea/modules/org.apache.ant_1.7.1/lib/ant-all.jar:/bea/modules/net.sf.antcontrib_1.1.0.0_1-0b2/lib/ant-contrib.jar:/bea/wlserver_10.3/common/derby/lib/derbyclient.jar:/bea/wlserver_10.3/server/lib/xqrl.jarJava.IO.Tmpdir: /tmp====================\n上面涉及的系统还挺多的:(1)WebSphere,部署了不少的应用:\n\n\nCacheMonitor.earDefaultApplication.earDynaCacheEsi.earDynacacheMessageHandler.earEventServiceMdb.earHttpErrorHandler.eariehs.warivtApp.earPerfServletApp.earquery.earSdoRepository.earSIBMsgMigrationUtility.earsibwsauthbean.earsibws.earsibwshttpchannel1.earsibwshttpchannel2.earsibwshttpepl.earsibwsjmschannel1.earsibwsjmschannel2.earsibwsjmsepl.earuddi.earWebSphereTP.earwsgw.ear\n（2）涉及多个系统:\n\n（3）可以继续深入数据库:/bea/user_projects/domains/JRSBKSB_9002/config/jdbc/oracle-jdbc.xml、db2as400-jdbc.xml等\n<?xml version='1.0' encoding='UTF-8'?><jdbc-data-source xmlns=\"http://xmlns.oracle.com/weblogic/jdbc-data-source\" xmlns:sec=\"http://xmlns.oracle.com/weblogic/security\" xmlns:wls=\"http://xmlns.oracle.com/weblogic/security/wls\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://xmlns.oracle.com/weblogic/jdbc-data-source http://xmlns.oracle.com/weblogic/jdbc-data-source/1.0/jdbc-data-source.xsd\">  <name>oracle</name> <internal-properties>    <property>      <name>CountOfTestFailuresTillFlush</name>      <value>10</value>    </property>    <property>      <name>CountOfRefreshFailuresTillDisable</name>      <value>20</value>    </property>  </internal-properties>  <jdbc-driver-params>    <url>jdbc:oracle:thin:@192.168.1.8:1521:jrs[打码]</url>    <driver-name>oracle.jdbc.xa.client.OracleXADataSource</driver-name>    <properties>      <property>        <name>user</name>        <value>szjrsbk</value>      </property>    </properties>    <password-encrypted>{AES}SO4j[打码]30CbAF4Fz2tizOXM+QVIfYl01wc9Qr5DasZk=</password-encrypted>  </jdbc-driver-params>  <jdbc-connection-pool-params>    <initial-capacity>10</initial-capacity>    <max-capacity>100</max-capacity>    <capacity-increment>10</capacity-increment>    <test-table-name>SQL SELECT 1 FROM DUAL</test-table-name>    <statement-cache-size>10</statement-cache-size>    <statement-cache-type>LRU</statement-cache-type>  </jdbc-connection-pool-params>  <jdbc-data-source-params>    <jndi-name>JRSBK</jndi-name>    <global-transactions-protocol>TwoPhaseCommit</global-transactions-protocol>  </jdbc-data-source-params></jdbc-data-source>\n   漏洞证明：  如上   修复方案：  如果深入,涉及的东西会比较多,早日修复   版权声明：转载请注明来源 袋鼠妈妈@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2014-09-01 10:08 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给广东分中心，由广东分中心后续协调网站管理单位处置。 按通用软件漏洞评分，rank 7 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-27 19:19 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  妈妈真牛逼    \n     2014-08-27 20:54 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  @泳少 我擦..你是在讥讽我么    \n     2014-08-27 21:07 |    \t\tgodblessme \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:3        | 维护世界和平)\t\t \n  袋鼠很厉害的样子    \n     2014-08-27 21:09 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @袋鼠妈妈 木有喔    \n     2014-08-27 21:22 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  @godblessme  我是打酱油滴,厉害的都在搞审计呢 么么哒    \n     2014-08-27 21:23 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  @泳少 你回来没有?    \n     2014-08-27 21:30 |    \t\tgodblessme \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:3        | 维护世界和平)\t\t \n  @袋鼠妈妈 是因为有了你，他们才要审计吧 哈哈    \n     2014-08-27 21:43 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  @godblessme 哼.你们尽管嘲笑我吧..我去叫我表哥来    \n     2014-08-27 23:47 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @袋鼠妈妈 妈妈，你不知道儿子明天得火车吗    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}