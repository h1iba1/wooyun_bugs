{"id": 19847, "wybug_id": "wooyun-2012-06394", "wybug_title": "IC卡自助洗衣机金额算法过于简单", "wybug_corp": "深圳市兴瑞来电子技术有限公司", "wybug_author": "tnt1200", "wybug_date": "2012-04-26 11:27", "wybug_open_date": "2012-06-10 11:28", "wybug_type": "设计不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["硬件安全", "算法破解", "逆向破解思路", "默认口令", "卡"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-04-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-05-03：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-06-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-06-10：\t细节向公众公开  简要描述： IC卡采用了默认密码并且金额算法过于简单。 详细说明：  厂家网址http://www.hi-sun.net/\n\n1.卡使用了默认的key FF FF FF FF FF FF2.金额算法过于简单图中红色部分为变动区域。以FF 00 65为例FF为金额代表0，00为进位，65为校验位。校验位为金额位与9A进行异或，然后再与进位异或。例如FF与9A异或得到65   漏洞证明：  可以进行重放攻击或者修改卡内数据   修复方案：  修改卡的默认密码   版权声明：转载请注明来源 tnt1200@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2012-04-30 22:56 厂商回复： CNVD根据图片确认所述漏洞情况。由于事件处置需要相应复现情况，暂未能及时跟进处置。对于该IC漏洞，将争取复现更多细节后进行处置。感谢tnt1200提供的进一步情况。对漏洞评分如下（以所述利用方式评分）：CVSS：(AV:L/AC:L/Au:NR/C:C/A:C/I:C/B:N) score:7.15（最高10分，高危）即：本地攻击、攻击难度低、不需要用户认证，对机密性、完整性、可用性构成完全影响。技术难度系数：1.3（比较有技术含量，IC卡芯片存储结构和逻辑破解）影响危害系数：1.2（一般，暂未判别是否有其他同种类的IC卡母卡受影响）CNVD综合评分：7.15*1.3*1.2=11.154 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-04-26 12:34 |    \t\t子墨 \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:22        | 天地不仁,以万物为刍狗;圣人不仁,以百姓为...)\t\t \n  这个要关注下...    \n     2012-04-30 23:02 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  马克    \n     2012-04-30 23:36 |    \t\tzhk \t\t\t( 普通白帽子  |\t\t\t        Rank:436 漏洞数:70        | 先看公告～)\t\t \n  卡里的数据到底怎么读出来的？？？    \n     2012-05-01 08:01 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  11R,很少见CNVD给那么高    \n     2012-05-01 10:31 |    \t\ttnt1200 \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:17        | 关注飞机安全....)\t\t \n  @zhk 用读卡器    \n     2012-05-01 10:46 |    \t\tzhk \t\t\t( 普通白帽子  |\t\t\t        Rank:436 漏洞数:70        | 先看公告～)\t\t \n  @tnt1200 什么读卡器，能说下吗？是所有卡都可以，还是只针对那种？    \n     2012-05-01 14:10 |    \t\ttnt1200 \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:17        | 关注飞机安全....)\t\t \n  @zhk acr122u,不是所有的卡都可以，只是针对默认key或者是有漏洞的ic卡    \n     2012-05-01 14:56 |    \t\tzhk \t\t\t( 普通白帽子  |\t\t\t        Rank:436 漏洞数:70        | 先看公告～)\t\t \n  @tnt1200 ^_^ 那怎么判断卡用的是哪种读卡器啊？？？    \n     2012-06-26 21:18 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:15        | Talk is cheap,show me the shell.)\t\t \n  @zhk 针对用默认密码的卡可以用122U读取到信息的 如果不是默认密码需要PM3截获破解的    \n     2012-06-28 15:33 |    \t\tcy3ber \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        | 11</textarea><script>alert(xss)</script>)\t\t \n  RFID黑客～    \n     2012-07-12 17:09 |    \t\tB1n4ry \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:6        )\t\t \n  亲们关注下我们的wiki：http://wiki.radiowar.org/    \n     2012-07-12 20:53 |    \t\ttnt1200 \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:17        | 关注飞机安全....)\t\t \n  @B1n4ry 经常关注你们的wiki 希望ubertooth-one更新使用案例~    \n     2012-12-25 13:02 |    \t\tSnow陈伦 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 闷骚的家伙，何处都是你的战场。)\t\t \n  默认的 弱口令 哎，多为用户考虑全面什么都有了。    \n     2013-04-13 00:34 |    \t\txsleaf \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:5        | 探索无尽的网海~)\t\t \n  都是神人哦……    \n     2013-06-13 22:10 |    \t\t噬魂 \t\t\t( 普通白帽子  |\t\t\t        Rank:141 漏洞数:37        | 08安全团队)\t\t \n  我们学校的一卡通可以么、、、    \n     2013-06-14 10:21 |    \t\tBreaker \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:1        )\t\t \n  @噬魂  想得美    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}