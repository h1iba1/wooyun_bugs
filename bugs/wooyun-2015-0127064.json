{"id": 46993, "wybug_id": "wooyun-2015-0127064", "wybug_title": "银行积分商城系统通用漏洞可泄露大量银行卡和密码（附分析过程）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-07-16 01:47", "wybug_open_date": "2015-09-06 00:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向公众公开  简要描述： 涉及到多家银行的积分商城系统。 详细说明：  某积分商城系统存在业务逻辑漏洞，可批量枚举银行卡和交易密码，早大量用户信息泄露。部分银行如下：桂林银行积分商城  https://lejifen.taccb.com.cn/jfyMall/攀枝花市商业银行积分商城  https://jf.pzhccb.com/jfyMall/济宁银行积分商城  https://jf.jn-bank.com/jfyMall/齐商银行积分商城  https://jf.qsbank.cc/jfyMall/东营银行积分商城  https://jf.dyccb.net/jfyMall/江苏邳州农村商业银行综合积分商城  https://jf.pznsh.com/jfyMall/泰安市商业银行  https://lejifen.taccb.com.cn/jfyMall/5个以上算通用了吧   漏洞证明：  用户在注册过程中确认银行卡和找回用户名时，均可对银行卡和密码进行暴力枚举。通过用户注册：https://ebank.guilinbank.com.cn/jfyMall/user/register.do或找回用户名，https://ebank.guilinbank.com.cn/jfyMall/user/findnameto.do进行暴力猜解。拿用户注册来示范：用户注册共分三步：1，填写个人信息 2，确认银行卡 3，注册成功写个人信息这一步没有问题。问题出在第二步，如下图：\n\n因无桂林银行的银行卡，去网上搜索一张，得到桂林银行的银行卡如下：622856700000*****前六位应该是相同的，本次测试仅测试后五位，生成一个5位数的字典，交易密码为111111，开始进行枚举，返回结果会有五种情况：卡号不存在，卡号已关闭，卡号未启用，这三种我们可以忽略了，来下面两种情况：\n\n表示银行卡卡号存在，但密码不正确。\n\n表示该银行卡已注册过，同时表示交易密码为111111，拿到银行卡号和交易密码，去找回用户名：https://ebank.guilinbank.com.cn/jfyMall/user/findnameto.do\n\n成功得到登录帐号用户名，然后通过银行卡帐号，交易密码，用户名，去找回登录密码：https://ebank.guilinbank.com.cn/jfyMall/user/findpwdto.do\n\n此时，密码已经重置成功，登录个人中心，如下图：\n\n登录后，除了会有一些敏感信息泄露外，可以利用积分兑换商品，银行卡和交易密码已得到了，新增收货地址，就可以送到你家了。本次只介绍了方法，没有大量去爆破尝试，首先通过第一次筛选得到已存在的银行卡卡号，再进行第二次爆破密码，可有五次机会，出现在银行卡弱密码top5的同学统统中招了。成功率还是很高的，数量你们去估吧。漏洞危害：1，可造成大量银行卡和密码泄露，可以干很多事情~2，故意把银行卡自动挂失（五次错误密码后会自动挂失，只能到柜台去处理了）这漏洞危害可算是100%有危害吧，假如猜出了密码，密码泄露。没有猜出密码，银行卡锁定。是不是太坏了，值多少rank？哈哈，业务逻辑漏洞就是这样。   修复方案：  1，确认银行卡和找回用户名 密码过程中添加验证码2，对银行卡卡号和密码添加控件，拒绝明文传输。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-07-20 17:37 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT向银行业信息化主管部门通报，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-16 02:24 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  噢    \n     2015-07-16 03:16 |    \t\tHaswell \t\t\t( 普通白帽子  |\t\t\t        Rank:167 漏洞数:18        | HorizonSec @ RDFZ)\t\t \n  qianpai    \n     2015-07-16 08:55 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  bandeng    \n     2015-07-16 09:38 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  这套系统是中国银联做的。 ：）     \n     2015-07-16 11:13 |    \t\t染血の雪 \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:16        | 击缻)\t\t \n  居然没雷    \n     2015-07-16 14:12 |    \t\t高小厨 \t\t\t( 普通白帽子  |\t\t\t        Rank:814 漏洞数:74        | 不会吹牛的小二不是好厨子！)\t\t \n  @zeracker 某某某又要加班了    \n     2015-07-20 11:19 |    \t\test \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 本id和邪㈧组织无关，虽然也在论坛混过。)\t\t \n  多家银行的积分商城系统。。。密码都能泄露啊。。我日    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}