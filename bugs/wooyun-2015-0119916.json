{"id": 11168, "wybug_id": "wooyun-2015-0119916", "wybug_title": "金融小能手之浦发银行(越权修改他人信息和查看订单信息)", "wybug_corp": "浦发银行", "wybug_author": "咚咚呛", "wybug_date": "2015-06-12 07:55", "wybug_open_date": "2015-07-31 10:58", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["金融小能手"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-31：\t细节向公众公开  简要描述： 越权修改他人信息。。。这测试卡上金额真他妈多，我所有的东西全部变卖了也没人家零头多。浦发果然是土豪的第一选择啊。 详细说明：  本次测试用了大概2个小时，其中高危的两个，低危不计其数主要是内网IP、信息泄露啥的(没啥意思就不写了)，高危就2俩。1、越权修改任意账户别名说明：可以修改任意指定的账户凭证别名，储蓄卡或者信用卡都可。功能点：我的账户>账户管理>凭证别名/默认卡号>>凭证别名设置 连接：https://ebank.spdb.com.cn/per/main参数：SelectedMenuId=menu8_4_1_1&l1MenuId=menu8&l2MenuId=menu8_4&groupName=MyAccount&transName=PUserAcctInfoManage&resultcount=2&acctType0=1&acctNo0=6225212800256817&acctnickname0=aa&acctType1=U&acctNo1=&acctnickname1=&submitButton=%C8%B7%B6%A8参数acctNo0为卡号，acctnickname0为凭证别名，只需修改acctNo0为指定卡号，即可修改，比如：6225212800256817\n\n又比如：6225220180241309\n\n登陆后查看，如下：\n\n如果有人恶作剧的对所有卡号进行遍历并修改或者此处别名存在xss存储漏洞，那就真的通杀了。2、订单号可以跑单这个洞起初不想提的，因为订单参数OrderNum它是按照时间格式来命名，比如它的订单号是20150612012922376345，可以明显看出是一个精确到毫秒的命名，如果对这个进行一天的脱裤的话最起码要跑10位数字，没测过在保证业务安全的前提下要跑多长时间，所以这个洞是否能否真实应用有待考验，不过问题确实存在，本着负责想了一想还是写出来了。功能点：我的订单>订单查询>订单详情连接：https://ebank.spdb.com.cn/fmall/RealGoldQueryOrderStatus.do参数：{\"OrderNum\":\"20150612012922376345\",\"_locale\":\"zh_CN\"}\n\n\n\n\n\n   漏洞证明：  详情看上面吧，其实我测试的时候，老版个人网银系统明显给我的感觉要比新版个人网银安全很多，从提示判断来看，可能大体架构没换，但从参数传递上看有变化了好多，总感觉有很多问题，回头有时间好好测测，拿着别人的号测起来总是很“烫手”的。   修复方案：  对链接判断下权限就OK了，之前的链接做的都挺好的。   版权声明：转载请注明来源 咚咚呛@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-06-16 10:56 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向保险行业信息化主管部门通报,由其后续协调网站管理单位处置.  最新状态： 2015-06-25：根据网站管理单位反馈和测试的情况,漏洞不存在.此前CNVD确认情况有误.  ", "replys": "漏洞评价：\n评论\n     2015-06-12 08:03 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  洞主测试下瑞士银行的呗    \n     2015-06-12 08:57 |    \t\t高小厨 \t\t\t( 普通白帽子  |\t\t\t        Rank:814 漏洞数:74        | 不会吹牛的小二不是好厨子！)\t\t \n  尼玛，牛    \n     2015-06-12 09:00 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  真的是连载啊？？？niubility    \n     2015-06-12 12:44 |    \t\t咚咚呛 \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:10        | 我是一只小毛驴咿呀咿呀呦~~)\t\t \n  测个网银都要看是不是客户，不好弄啊！    \n     2015-06-12 12:45 |    \t\t咚咚呛 \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:10        | 我是一只小毛驴咿呀咿呀呦~~)\t\t \n  咦~~为啥我的回复消失了？    \n     2015-06-12 13:01 |    \t\t咚咚呛 \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:10        | 我是一只小毛驴咿呀咿呀呦~~)\t\t \n  测试下，看能回复不。    \n     2015-06-12 13:05 |    \t\t咚咚呛 \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:10        | 我是一只小毛驴咿呀咿呀呦~~)\t\t \n  。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}