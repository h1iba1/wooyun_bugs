{"id": 37560, "wybug_id": "wooyun-2015-099424", "wybug_title": "某通用健康体检档案管理系统再次越权/泄露敏感信息/getshell（可影响大量社会公民信息）", "wybug_corp": "中卫信软件", "wybug_author": "BMa", "wybug_date": "2015-03-06 17:19", "wybug_open_date": "2015-06-09 10:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-09：\t细节向公众公开  简要描述： 某通用健康体检档案管理系统再次越权/泄露敏感信息/getshell（可影响大量社会公民信息）挖一个，发一个 - -！影响数据量粗略估计145W +  详细说明：  公司：中卫信软件地址：http://www.chiscdc.com/简介：中卫信软件成立以来以“传递科技，控制疾病”为使命，致力于中国公共卫生事业信息化建设，在社会各界的大力支持下，通过全体员工的不懈的努力，在公共卫生行业信息建设方面取得了良好的业绩。公司开发的相关软件产品覆盖江苏省公共卫生领域近70%的市场份额，用户数达1500多家，成为江苏省公共卫生领域信息化建设的领先企业。 案例：\n上海市化工职业病防治院体检查询系统\thttp://www.shhgzf.com:8280/dwcx/detail.asp?idx=10080&dt=&bhkrsl=&mhkadv=泰州市健康体检查询系统\thttp://221.230.140.60:8080/dwcx/detail.asp?idx=10080&dt=&bhkrsl=&mhkadv=宿迁市健康体检档案管理系统\thttp://218.93.201.187:8888/dwcx/detail.asp?idx=10080&dt=&bhkrsl=&mhkadv=镇江市健康体检档案管理系统\thttp://221.230.8.231:8081//dwcx/detail.asp?idx=10080&dt=&bhkrsl=&mhkadv=南通市健康体检档案管理系统\thttp://222.184.250.2:8001//dwcx/detail.asp?idx=10080&dt=&bhkrsl=&mhkadv=吴江市健康体检档案管理系统\thttp://58.211.131.154:84//dwcx/detail.asp?idx=10080&dt=&bhkrsl=&mhkadv=宜兴市体检档案管理系统\thttp://58.221.214.82:82//dwcx/detail.asp?idx=10080&dt=&bhkrsl=&mhkadv=无锡市健康体检档案管理系统\thttp://58.214.247.138:8088/dwcx/detail.asp?idx=10080&dt=&bhkrsl=&mhkadv=宜兴职业健康档案管理系统\thttp://yianjkong.vicp.cc:8081/dwcx/detail.asp?idx=10080&dt=&bhkrsl=&mhkadv=苏州市健康体检档案管理系统\thttp://www.szcdc.cn/wstjnew/dwcx/detail.asp?idx=10080&dt=&bhkrsl=&mhkadv=\n以http://www.shhgzf.com:8280/dwcx/detail.asp?idx=10080&dt=&bhkrsl=&mhkadv=为例，上海市化工职业病防治为例1、越权及敏感信息泄露：http://www.shhgzf.com:8280/dwcx/detail.asp?idx=10080&dt=&bhkrsl=&mhkadv=http://www.shhgzf.com:8280/dwcx/detail.asp?idx=10076&dt=&bhkrsl=&mhkadv=\n\n\n\n2、注入：http://www.shhgzf.com:8280/dwcx/detail.asp?idx=10080&dt=&bhkrsl=&mhkadv=文件：/dwcx/detail.asp参数：idx=10080代码：\ndim bhkidx,dt\t\t   bhkidx=request(\"idx\")\t\t   dt=request(\"dt\")\t\t   bhkrsl=request(\"bhkrsl\")\t\t   mhkadv=request(\"mhkadv\")  <%\t\t  \t\t   set cn=getConn()           set rs=server.createObject(\"adodb.recordset\")\t\t   sql=\"select * from td_tj_bhksub where mtbidx=\"&bhkidx&\" order by bhkgrpidx\"\t\t   \t\t   'response.Write(sql)\t       rs.open sql,cn,1,1\t\tif rs.eof then\t\t   response.Write(\"您所查看的信息不存在！<a href=window.close();>关闭</a>\")    else\t\t  \t\t\t  %>\t\t  \t\t  <table width=\"631\"  class=\"tb_main\" cellspacing=\"1\">\t\t\t  <tr class=\"tr0\">\t\t\t    <td width=\"25%\" align=\"center\">体检小组</td>              <td width=\"25%\" height=\"25\" align=\"center\">项目名称</td>              <td width=\"25%\" height=\"25\" align=\"center\" >检查结果</td>              <td width=\"25%\" align=\"center\" >是否合格</td>            </tr>\t\t\t<%\t\t\tj=1\t\t\tm=\"tr1\"\t\t\tdo while not rs.eof \t\t\t%>            <tr class=\"<%=m%>\">              <td width=\"25%\" align=\"center\"><%\t\t\t  \t\t  set rs1=server.createObject(\"adodb.recordset\")\t\t   sql1=\"select * from tb_tj_grp where idx=\"&rs(\"bhkgrpidx\")\t       rs1.open sql1,cn,1,1 \t\t\t  bhkgrp=rs1(\"grpnam\")\t\t\t rs1.close \t\t\t  response.Write(bhkgrp)\t\t\t  %></td>              <td width=\"25%\" height=\"25\" align=\"center\"><%\t\t\t  set rs2=server.createObject(\"adodb.recordset\")\t\t   sql2=\"select * from tb_tj_bhkitm where idx=\"&rs(\"bhkitmidx\")\t       rs2.open sql2,cn,1,1 \t\t\t  subman=rs2(\"itmnam\")\t\t\t rs2.close \t\t\t  response.Write(subman)\n\n\n\n\n\n\n其他的案例：\n\n\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 BMa@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-03-11 10:53 厂商回复： CNVD确认并复现所述情况，由CNVD通过网站公开联系方式向软件生产厂商通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}