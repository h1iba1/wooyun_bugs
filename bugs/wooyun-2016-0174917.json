{"id": 74244, "wybug_id": "wooyun-2016-0174917", "wybug_title": "12306某站多个问题(绕过添加数据/XSS/设计缺陷泄露密码/大数据查看)", "wybug_corp": "12306", "wybug_author": "Hxai11", "wybug_date": "2016-02-05 12:46", "wybug_open_date": "2016-02-23 15:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-02-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-23：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： rt 详细说明：  问题站点：http://ad.12306.cn/首先看绕过限制添加数据当我们添加应用的时候显示被不行，我们查看源码得知，是前端限制，可绕过\n\n\n\n\n\n地址出来了，我们去添加试试\n\n这里应用描述这里有xss，虽然有长度限制可以绕过就用常规的<script>来测试，毫无过滤\n\n\n\n同理，其他添加页面都能够添加查询出来的\nvar dePwd = $.md5(\"123456\");\tfunction toPlacementjsp(){\t\tif('' == dePwd){\t\t\talert(\"请您修改默认密码\");\t\t\twindow.location.href =\"/web/admin/developer/updatePassword/updatePassword.jsp\";\t\t}else{\t\t\tif(\"1\" == '2'){\t\t\t\twindow.location.href = \"/web/admin/developer/adplace/adplaceAdd.jsp\";\t\t\t}else{\t\t\t\talert(\"账户尚未审核通过\");\t\t\t\treturn false;\t\t\t}\t\t}\t}\tfunction toApp(){\t\tif('' == dePwd){\t\t\talert(\"请您修改默认密码\");\t\t\twindow.location.href =\"/web/admin/developer/updatePassword/updatePassword.jsp\";\t\t}else{\t\t\tif(\"1\"  == '2'){\t\t\t\twindow.location.href = \"/web/admin/developer/application/addApp.jsp\";\t\t\t}else{\t\t\t\talert(\"账户尚未审核通过\");\t\t\t\treturn false;\t\t\t}\t\t}\t}\t\tfunction toAudit1(){\t\tif('' == dePwd){\t\t\talert(\"请您修改默认密码\");\t\t\twindow.location.href =\"/web/admin/developer/updatePassword/updatePassword.jsp\";\t\t}else{\t\t\tif(\"1\"  == '2'){\t\t\t\twindow.location.href = \"/web/admin/developer/adplace/auditList.jsp\";\t\t\t}else{\t\t\t\talert(\"账户尚未审核通过\");\t\t\t\treturn false;\t\t\t}\t\t}\t}\n再来就是设计缺陷可以泄露密码\n\n登录进来后，查看源代码，这里有一个判断，如果你的密码是123456，就提示你修改密码，但是，源码直接读取了数据库里的pass字段，放在password里，导致泄露密码，如果配合前面xss，可想危害再来就是大数据查看，当我们退回admin目录看看\n\n数据这么巨大，明显不是我们的，估计应该是网站实时的广告数据看看过去30天的数据，更吓人\n\n   漏洞证明：  \n\n   修复方案：  限制严格点   版权声明：转载请注明来源 Hxai11@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2016-02-05 15:39 厂商回复： 正在修改,谢谢！ 最新状态： 2016-02-23：漏洞已修复。感谢乌云的检测！  ", "replys": "漏洞评价：\n评价\n     2016-02-05 12:49 |    \t\tQ1NG \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:21        | 临 兵 斗 者 皆 阵 列 前 行 !)\t\t \n  欢迎来到12306专场......    \n     2016-02-05 13:24 |    \t\t暴走 \t\t\t( 普通白帽子  |\t\t\t        Rank:477 漏洞数:91        | Wooyun的Rank获取如同Dota冲天梯有过之而无...)\t\t \n  开发人员自己的行为，已通知发开人员加班整改。    \n     2016-02-05 13:47 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:207 漏洞数:72        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  厂商回应：危害等级：低漏洞Rank：1确认时间：2016-02-05 15:07厂商回复：开发人员自己的行为，已通知发开人员加班整改。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}