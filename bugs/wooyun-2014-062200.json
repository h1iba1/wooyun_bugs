{"id": 55089, "wybug_id": "wooyun-2014-062200", "wybug_title": "Youyax 注入第一枚 多处。", "wybug_corp": "youyax.com", "wybug_author": "′雨。", "wybug_date": "2014-05-28 14:21", "wybug_open_date": "2014-08-26 14:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-26：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 过滤不严。 详细说明：  刚在官网下的最新版在lib/voteaction.php中\nif (match($_SESSION['youyax_user'], \"session_user\")) {            $vradio = addslashes($_POST['vradio']);            $vid    = addslashes($_POST['vid']);            $cid    = addslashes($_POST['cid']);            if (!empty($_SERVER['HTTP_CLIENT_IP']))                $myIp = $_SERVER['HTTP_CLIENT_IP'];            else if (!empty($_SERVER['HTTP_X_FORWARDED_FOR']))                $myIp = $_SERVER['HTTP_X_FORWARDED_FOR'];            else                $myIp = $_SERVER['REMOTE_ADDR'];            if (match($vradio, \"vote\")) {                if ($ips_arr = $this->find(C('db_prefix') . \"vote_ips\", \"string\", \"vid=\" . $vid)) {                    $ips = unserialize($ips_arr['ips']);                                        if (in_array($myIp, $ips)) {                        echo '<script>alert(\"您已经投过票了\");history.back();</script>';                        exit;                    } else {                        $ips[]       = $myIp;                        $data['ips'] = serialize($ips);                        $this->save($data, C('db_prefix') . \"vote_ips\", \"vid=\" . $vid);                                                $vote_arr = $this->find(C('db_prefix') . \"vote\", \"string\", \"id=\" . $vid);                        $comb     = unserialize($vote_arr['comb']);\n这里的$ip 为xff 是可以控制的 并且未过滤。只是经过了一次序列化,然后insert 造成了注入。在ext/register.phpext/mobile/register.phplib/commonaction. phplib/laudaction.php中 均有此洞不多说了。   漏洞证明：  \n\n   修复方案：  Check It   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-05-28 14:36 厂商回复： 这个问题已经有白帽子提出来了，在ext/ext/mobile/lib/commonaction. php修复了这3个，另外2个文件我遗漏了，多谢提醒 最新状态： 2014-05-28：修复完成  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}