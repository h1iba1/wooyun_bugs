{"id": 3483, "wybug_id": "wooyun-2014-059483", "wybug_title": "PPTV小漏洞合集", "wybug_corp": "PPTV(PPlive)", "wybug_author": "路人甲", "wybug_date": "2014-05-05 10:33", "wybug_open_date": "2014-06-19 10:34", "wybug_type": "后台弱口令", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "后台地址泄露", "配置下载"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-19：\t细节向公众公开  简要描述： 几个PPTV的小漏洞，包括后台弱口令、配置文件下载等。 详细说明：  1.后台弱口令http://acm.pptv.com/ （最新一次检测已修复）用户名：ejacky 密码：123456http://cooperation.pplive.com/用户名：test 密码：1234562.配置文件下载http://sr3.pplive.com/upload.php（已修复）\n<?php/** * Controller for upload * * @author luoqiang * */class Controller_Upload extends Controller_Common_Base {\tprivate $_upload_cache_path;\tprivate $_ftp_server;\tprivate $_ftp_user_name;\tprivate $_ftp_user_pass;\tprivate $_file_md5;\tprivate $_files;\tprivate $_off; // 返回操作状态(成功/失败)    private $_conn_id; // FTP连接    private $_return;    private $_img_upload_config_url;    private $_img_upload_config_info;    private $_img_upload_config_local_file;    private $_cache_time;    private $_max_size;    private $_server_num;    private $_relaxation_size;    const EXTEND_MAX_SIZE = 0;    const EXTEND_CUSTOM_SIZE = 1;    const SIZE_OK = 2;    \tpublic function __construct(){\t\t$this->_upload_cache_path = WEB_ROOT_DIR . '/../cache/';\t\t//$this->_ftp_server = \"180.153.106.41\";\t\t//$this->_ftp_server = \"static.ftp.pplive.cn\";//公网域名走CDN，会出现图片上传很慢以及失败的情况\t\t$this->_ftp_server = \"static.ftp.idc.pplive.cn\";//内网域名\t\t$this->_ftp_user_name = \"unsrser\";\t\t$this->_ftp_user_pass = \"********\";\t\t$this->_return = array();\t\t$this->_file_md5 = \"\";\t\t$this->_files = array();\t\t$this->_img_upload_config_url = \"http://config.aplusapi.pptv.com/web/img_upload/?\".time();\t\t$this->_img_upload_config_info = array();\t\t$this->_img_upload_config_local_file = '../../cache/cms/configurations_img_upload.json';\t\t$this->_cache_time = 600;\t\t$this->_max_limit_size = 100;\t\t$this->_server_num = 4;\t\t$this->_relaxation_size = array(\"swf\");\t\t\t}\tpublic function index(){\t\t$inputId =  Request::get(\"inputId\");\t\t$this->view->assign('inputId', $inputId);\t\t$this -> render('upload_img.tpl');\t}\t\tpublic function uploadImgConfig($width,$height,$size){\t\t\t\t$filemtime = filemtime($this->_img_upload_config_local_file);........\nhttp://180.153.106.106:8888/conf.tar.gzhttp://180.153.106.107:8888/conf.tar.gzhttp://180.153.106.26:8888/conf.tar.gzhttp://180.105.106.27:8888/conf.tar.gz（最新一次检测已修复）   漏洞证明：  \n\n\n\n\n\n   修复方案：  ·修改相关密码·删除对应文件   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-05-05 10:45 厂商回复： 多谢关注PPTV 安全，我们正在跟进处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-19 11:41 |    \t\t麻花藤 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | ด้้้้้็็็็็้้้้้็็็็...)\t\t \n  有几个还是没修复！    \n     2014-06-20 08:32 |    \t\t马化腾 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:2        | 动词大呲咚呲哒呲)\t\t \n  @麻花藤 居然模仿我名字    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}