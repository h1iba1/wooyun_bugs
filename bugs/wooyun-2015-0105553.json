{"id": 34756, "wybug_id": "wooyun-2015-0105553", "wybug_title": "厦门市工商管理局年报系统存在应用程序命令执行漏洞", "wybug_corp": "厦门市工商管理局", "wybug_author": "路人甲", "wybug_date": "2015-04-07 11:48", "wybug_open_date": "2015-05-25 17:30", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-25：\t细节向公众公开  简要描述： 厦门市工商管理局年报系统由于部署了JBOSS环境，可以通过默认的应用包getshell。 详细说明：  由于应用系统上的/invoker/JMXInvokerServlet没有删除，由于jboss在默认安装的时候，会安装http-invoker.sar站点，可知当请求invoker/JMXInvokerServlet或invoker/EJBInvokerServlet会调用org.jboss.invocation.http.servlet.InvokerServlet.class处理请求，jboss直接获得客户端提交数据进行反序列化，获得对象，然后调用对象。因此，攻击者需要自己构造一个jboss的类，并且将其序列化，然后将序列化的数据直接提交到存在漏洞站点的invoker/JMXInvokerServlet页面，恶意代码将会被执行。   漏洞证明：  1.厦门市工商管理局年报系统\n\n2.部署了jboss，且没有删除默认的一些包。\n\n\n\n默认存在http-invoker,直接利用exp，可以直接获取系统相关信息：\n\n3.getshell，上传大马被杀，部署了小马可以成功getshell\n\n\n\n访问测试ok：\n\n测试马：http://222.76.242.84:8084/myname/index.jsphttp://222.76.242.84:8084/myname/test.jsp?cmd=ipconfig   修复方案：  1.删除无用的war包；2.添加相关安全防护措施。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-04-10 17:28 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给福建分中心，由福建分中心后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}