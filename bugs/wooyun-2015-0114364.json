{"id": 22100, "wybug_id": "wooyun-2015-0114364", "wybug_title": "佳能打印机打印信息泄露可远程打印文件", "wybug_corp": "人人网", "wybug_author": "路人甲", "wybug_date": "2015-05-15 20:49", "wybug_open_date": "2015-07-02 17:30", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-02：\t细节向公众公开  简要描述： 佳能打印机打印信息泄露可远程打印文件 详细说明：  使用zoomeye搜索app:\"Canon printer http config\" ver:\"2.21\"可查询到大量配置不当的佳能打印机远程用户界面 没有设置权限\n\n然后点击进入在direct print选项\n\n里面有详细的打印选项可选择打印页数打印文档等等然后 strat print那边就开始打印了下面有证明同时在log选项里面可以查看打印日志 在打印文件夹里面有99个文件夹里面的打印信息泄露 有个前辈写的可以恢复打印内容的文档大家可以借鉴借鉴 使得用户信息泄露   漏洞证明：  \n\n下面是漏洞证明可以看到打印序列里面显示正在打印有的时候机器繁忙的时候会造成打印失败 选项里面先是Error 表示打印失败然后在打印日志里面查看我们打印的文件 与administrator打印的文件一同显示出来\n\n以证明基本都可用无意看到一个日本的 愤青精神来了 打印999份\n\n希望厂商尽快发布解决方案 否者用户危害很大   修复方案：  方法有很多种 可以禁用Remote UI Print Image Files 或者设置特定的ip访问 指定特定的域 指定特定的组访问   或者加用户登录访问限制 设置用户登录访问界面   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-05-18 17:30 厂商回复： 谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-02 23:50 |    \t\tdlevr \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:10        | 菜鸟一只，大神勿喷！)\t\t \n  干的漂亮！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}