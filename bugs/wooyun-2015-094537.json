{"id": 44280, "wybug_id": "wooyun-2015-094537", "wybug_title": "中兴手机助手本地提权与WIFI远程管理的认证机制绕过（详细Android分析过程与思路）", "wybug_corp": "中兴通讯股份有限公司", "wybug_author": "小荷才露尖尖角", "wybug_date": "2015-01-29 11:34", "wybug_open_date": "2015-04-29 11:36", "wybug_type": "非授权访问/认证绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全", "组件暴露", "认证机制绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-29：\t细节向公众公开  简要描述： 包括两个漏洞：（1）组件暴露，导致本地提权和远程访问（2）远程管理认证机制绕过 详细说明：  中兴手机助手是中兴官方的安卓智能手机管理软件，官方下载地址为http://joinme.ztems.com/，我们测试的安卓版本为最新版2.1.66.3224，百度搜索显示下载量已有86万，不知中兴手机是否内置该应用。包括两个漏洞：第一个漏洞：本地组件暴露导致提权，只要用户安装中兴手机助手，无需任何权限的本地恶意应用就可在用户不知情的情况下启动供远程访问的FTP服务，且该FTP服务具有默认的用户名和密码。暴露的两个安卓组件分别为 com.joinme.ftp.FtpServerService和JoinMeServiceReceiver。通过如下代码，\nm_testbutton1=(Button)findViewById(R.id.BySvc);        m_testbutton1.setOnClickListener(new OnClickListener()        {@Overridepublic void onClick(View v) {// TODO Auto-generated method stubIntent i = new Intent();i.setAction(\"com.joinme.ftp.FtpServerService\");startService(i);}        });\n或者\nm_testbutton2=(Button)findViewById(R.id.ByReceiver);        m_testbutton2.setOnClickListener(new OnClickListener()        {@Overridepublic void onClick(View v) {// TODO Auto-generated method stubIntent i = new Intent();i.setAction(\"android.intent.action.JoinMe_Ftp_Server_Service_Start\");sendBroadcast(i);}        });\n之一即可启动手机助手内置的FTP服务。正常情况下启用服务需要用户干预，如图\n\n在用户不知情的情况下开启服务（只需要手机安装中兴手机助手）\n\nFTP服务还具有内置的默认用户名和密码，并在端口2121监听。如下图，见位于FtpServerService中的代码片段。加载FTP服务设置\n\n跟入Defaults类，得到默认username、password为JoinMe，port为2121\n\n第二个漏洞：在手机助手后台运行的情况下，泄露SecretKey，导致可在WIFI环境远程控制手机在分析第一个漏洞的时候，发现了第二个漏洞，与这个漏洞相比，上一个漏洞简直不算啥。漏洞位于 JoinMeUdpService,该服务打开udp的65532端口监听，接收特定的命令字后可返回手机的敏感信息，包括SecretKey如图，JoinMeUdpService的doListen方法\n\n跟入doComm，可发现特定的命令为“JoinMe Broadcast\"\n\n   漏洞证明：  第一个漏洞的证明：利用默认用户名和密码远程访问FTP服务，非root条件下可浏览、下载/sdcard等目录中的文件。\n\n该FTP服务支持的命令\n\n第二个漏洞的证明：\n\n注意上面的SecretKey，就是中兴手机助手PC端管理手机的验证码。当手机助手在后台运行的情况下，可在PC端通过验证码完全管理手机，获得所有通信录、短信、照片及应用信息，并具有手机助手所有的添加、删改权限！！\n\n\n\n比较有杀伤力的场景是在公共WIFI场所，在用户手机助手运行的情况下，通过以下脚本可以扫描获得SecretKey，并利用PC端进行远控！scan.sh\n#!/bin/bashnetwork=\"192.168.1\"for address in $(seq 1 254)do    echo  ${network}.${address}    echo -n \"JoinMe Broadcast\" | nc  -w 2 -u  ${network}.${address}  65502done\n扫描结果\n\nPC端远控相应手机\n\n   修复方案：  针对漏洞一： 设置com.joinme.ftp.FtpServerService、 JoinMeServiceReceiver为exported:false，或者设置自定义权限，并将保护级别设为signature。FTP服务的用户名和密码，不要硬编码在代码中，可以设置在配置文件中读取。或者由用户在PC端手机助手临时指定。针对漏洞二：禁用远程回显SecretKey   版权声明：转载请注明来源 小荷才露尖尖角@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-01-30 09:06 厂商回复： 厉害，话说洞主不是学生吧，要是学生能静下心来研究如此深入，那是真心膜拜~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-29 11:34 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  好漂亮的分析啊    \n     2015-01-29 11:37 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  厉害    \n     2015-01-29 11:40 |    \t\t白非白 \t\t\t( 普通白帽子  |\t\t\t        Rank:447 漏洞数:60        | ♫ Freedom - Anthony Hamilton ♫)\t\t \n  关注    \n     2015-01-29 11:40 |    \t\tfelixk3y \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:41        | php python jsp)\t\t \n  @xsser @疯狗 明知看不了，简直赤裸裸的诱惑...    \n     2015-01-29 11:41 |    \t\tAno_Tom \t\t\t( 普通白帽子  |\t\t\t        Rank:368 漏洞数:40        | Talk is cheap.:)\t\t \n  这个叼，楼上2位我的漏洞是不给我审了么@疯狗@xsser    \n     2015-01-29 11:41 |    \t\t天地不仁 以万物为刍狗 \t\t\t( 普通白帽子  |\t\t\t        Rank:977 漏洞数:264        | 天地本不仁 万物为刍狗)\t\t \n  前排  坐等公开    \n     2015-01-29 11:41 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @小荷才露尖尖角 在公共Wi-Fi里简直就是屠杀啊，给你生猴子行不行？    \n     2015-01-29 11:45 |    \t\t小荷才露尖尖角 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:13        | less is more)\t\t \n  还是有利用条件，需要用户运行该应用。    \n     2015-01-29 11:46 |    \t\tp4ssw0rd \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:92        | 不作死就不会死)\t\t \n  关注    \n     2015-01-29 11:46 |    \t\tbey0nd \t\t\t( 普通白帽子  |\t\t\t        Rank:895 漏洞数:142        | 相忘于江湖，不如相濡以沫)\t\t \n  关注    \n     2015-01-29 11:50 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  我鄙视能看到漏洞的人，看了之后诱惑我们的    \n     2015-01-29 12:10 |    \t\t鸟云厂商  \t\t\t( 核心白帽子 |\t\t\t        Rank:1313 漏洞数:146        | 中国菜鸟)\t\t \n  原来是这样，神思路啊！    \n     2015-01-29 12:12 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  @鸟云厂商 我一直以为你的ID是乌云厂商……    \n     2015-01-29 12:22 |    \t\t鸟云厂商  \t\t\t( 核心白帽子 |\t\t\t        Rank:1313 漏洞数:146        | 中国菜鸟)\t\t \n  @zph 我在zone是乌云厂商，在主站是鸟云厂商    \n     2015-01-29 12:35 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @鸟云厂商 你知道什么了    \n     2015-01-29 12:37 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  @鸟云厂商 怎么做到的。。    \n     2015-01-29 12:42 |    \t\t鸟云厂商  \t\t\t( 核心白帽子 |\t\t\t        Rank:1313 漏洞数:146        | 中国菜鸟)\t\t \n  @疯狗 我就是来装个逼，啥也不知道。    \n     2015-01-29 14:17 |    \t\the1renyagao \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:29        | 是金子总会发光，在还未发光之前，先打磨打...)\t\t \n  牛逼的思路    \n     2015-01-29 14:27 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  略吊6    \n     2015-01-29 14:30 |    \t\tnzk1912 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:10        | 软件开发8年了，也来挖挖漏洞，为创建安全...)\t\t \n  我靠，牛XX就是牛XX，这分析能力~    \n     2015-01-29 15:05 |    \t\t刘海哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:114 漏洞数:28        | 索要联系方式但不送礼物的厂商定义为无良厂...)\t\t \n  吓尿了！    \n     2015-01-29 15:10 |    \t\t计算姬 \t\t\t( 普通白帽子  |\t\t\t        Rank:398 漏洞数:90        | 看我看我看我啊)\t\t \n  我次奥，盗了狗哥的号上去看了下，果然牛逼。    \n     2015-01-29 15:45 |    \t\tonpu \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:19        | 静坐常思己过，闲谈莫论人非)\t\t \n  默默的点赞。    \n     2015-01-29 15:47 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:2738 漏洞数:547        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  应该扔到drops      \n     2015-01-29 16:24 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n     2015-01-29 17:18 |    \t\tQiudays \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:9        | 感觉自己萌萌哒)\t\t \n  坐等公开    \n     2015-01-29 17:21 |    \t\tLongY \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:11        | 强行送一血)\t\t \n  mark    \n     2015-01-29 17:27 |    \t\ttracyfan \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 崇尚进攻只能编出烂代码的抢点型前锋)\t\t \n  坐等该洞上头条，奖楼主手机一台    \n     2015-01-29 20:30 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:23        | 开发真是日了狗了)\t\t \n  屌，mark    \n     2015-01-29 21:37 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  真牛逼    \n     2015-01-29 21:41 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  思路真赞！ 好漂亮的分析啊    \n     2015-02-02 09:30 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @M4sk 明知看不到详情还在这里诱惑大家    \n     2015-02-02 09:48 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  不错的思路，为洞主漂亮的分析点下赞。    \n     2015-02-02 11:43 |    \t\tgoubuli \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:61        )\t\t \n  你们都能看到详细了？我只能Mark一下    \n     2015-02-02 14:10 |    \t\t乌云白帽子 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:4        | 路人甲)\t\t \n  操，赤裸裸的诱惑    \n     2015-02-02 15:41 |    \t\tSneezry \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | I write code.)\t\t \n  我去，洞主太厉害了，这思路绝了（其实我啥都看不到……    \n     2015-02-02 15:46 |    \t\t中酒时代酒业（北京）有限公司(乌云厂商)\t\t \n  厂商来赞，服气！    \n     2015-02-03 00:07 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  @中酒时代酒业（北京）有限公司 厂商来赞不容易啊    \n     2015-02-03 09:49 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  坐等公开啊－－    \n     2015-02-03 09:54 |    \t\tnoob \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:18        | 向各位大神学习，向各位大神致敬)\t\t \n  尼玛，看不到，评论还那么诱惑，坑爹呢    \n     2015-02-03 11:09 |    \t\t那个夏天骚年未老 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 呵呵，呵，呵呵呵)\t\t \n  好叼的分析，这年头能沉下心研究分析的课不多。赞一个~~    \n     2015-02-03 11:29 |    \t\twoody \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | 菜鸟一枚)\t\t \n  坐等公开啊－－     \n     2015-02-03 11:39 |    \t\tNeeke \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:24        | 求传授刷Rank方法？)\t\t \n  赶紧公开    \n     2015-02-03 12:37 |    \t\tFireweed \t\t\t( 普通白帽子  |\t\t\t        Rank:107 漏洞数:14        | Show me the #)\t\t \n  膜拜下    \n     2015-02-03 12:45 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @浅蓝 @M4sk @nzk1912 @计算姬 @刘海哥 @he1renyagao @鸟云厂商  你们能不装逼么？明明看不到还装着看的到    \n     2015-02-03 12:50 |    \t\t鸟云厂商  \t\t\t( 核心白帽子 |\t\t\t        Rank:1313 漏洞数:146        | 中国菜鸟)\t\t \n  @U神 师傅对不起我错了    \n     2015-02-03 13:44 |    \t\tlaoyao \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:5        | ด้้้้้็็็็็้้้้้็็็็...)\t\t \n  ------mark    \n     2015-02-03 14:34 |    \t\tArthur \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:33        | USA，I am coming！！！！！)\t\t \n  @U神 你何时在乌云变得如此霸气。。囧，求代刷rank    \n     2015-02-03 15:01 |    \t\t刘海哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:114 漏洞数:28        | 索要联系方式但不送礼物的厂商定义为无良厂...)\t\t \n  @U神 师傅对不起我错了     \n     2015-02-03 15:34 |    \t\the1renyagao \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:29        | 是金子总会发光，在还未发光之前，先打磨打...)\t\t \n  @U神 师傅对不起我错了    \n     2015-02-03 16:49 |    \t\tzhuixing \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:9        | 纯纯的小白。)\t\t \n  等公开呀等公开……    \n     2015-02-04 16:26 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  mark    \n     2015-02-05 13:04 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  两位顶级白帽子的赞叹和 乌云闪电还有一堆美刀符号暗示这个漏洞公开后值得反复研究与借鉴，做个标记几个月后回来看    \n     2015-02-05 13:45 |    \t\tx-star \t\t\t( 普通白帽子  |\t\t\t        Rank:124 漏洞数:13        | Windows/Linux Kernel.  Information Secur...)\t\t \n  MARK !!!!    \n     2015-02-05 17:23 |    \t\t小黄蜂 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:3        | 好男儿名垂千古&好姑娘永垂不朽)\t\t \n  马克    \n     2015-02-05 20:00 |    \t\t狼狗 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 我来到这里是为了国家各个互联网安全。学习...)\t\t \n  多多跟着楼主学习。、    \n     2015-02-06 11:22 |    \t\t黑吃黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:29        | 倚楼听风雨，淡看江湖路...)\t\t \n  好漂亮的分析啊    \n     2015-02-07 18:00 |    \t\t乌山云雨 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:1        | 一只正在乌山云雨中翻滚的小菜鸟)\t\t \n  看着你们吹牛逼，我又吹不过你们！这日子没法过了。    \n     2015-02-17 18:11 |    \t\t半夏 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 新人一枚。。)\t\t \n  坐等公开啊    \n     2015-02-19 10:44 |    \t\t吃虾小能手 \t\t\t( 普通白帽子  |\t\t\t        Rank:213 漏洞数:21        | 老板，还有虾吗？)\t\t \n  509team, 好吊的名字, 是wushi吗    \n     2015-02-28 13:43 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  很给力。@吃虾小能手 509是宿舍房号？    \n     2015-03-04 14:19 |    \t\tMujj \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:4        | IDC商)\t\t \n  好漂亮的分析啊    \n     2015-03-04 21:19 |    \t\tNicky \t\t\t( 普通白帽子  |\t\t\t        Rank:477 漏洞数:69        | http://www.droidsec.cn 安卓安全中文站)\t\t \n  不错的分析，已转www.droidsec.cn    \n     2015-04-15 17:34 |    \t\tzzzzy \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 熟练各种语言名称的拼写)\t\t \n   - -我这个路人就不装逼了。。。猴年马月才能看到啊    \n     2015-04-29 11:52 |    \t\tonly_admin \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:5        | ~~~~我只是个孩子╭(°A°`)╮~~~~)\t\t \n  坐看大神    \n     2015-04-29 12:19 |    \t\t冰海 \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:7        | I can do better , why not ?)\t\t \n  分析过程和作文方式都值得学习，很赞！    \n     2015-04-29 14:05 |    \t\t小胖纸 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:12        | 找人拿指定金融期货原油网站，只要客户资料...)\t\t \n  LZ请收下我的膝盖。    \n     2015-04-29 14:37 |    \t\t圣路西法 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 围观大神ส็็็็็็ ̷̸̨̀͒̏̃ͦ...)\t\t \n  卧槽，这个真心大神。    \n     2015-04-30 11:50 |    \t\t黑色的屌丝 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:5        | →_→→_→)\t\t \n  大神。你应该上榜了    \n     2015-05-19 22:20 |    \t\t暗羽 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:6        | 喵呜，给人类的智商跪了)\t\t \n  mark    \n     2015-05-26 14:53 |    \t\t胡小树 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:11        | 我是一颗小小树)\t\t \n  @小荷才露尖尖角  大牛能推荐些相关资料不    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}