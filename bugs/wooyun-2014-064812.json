{"id": 2608, "wybug_id": "wooyun-2014-064812", "wybug_title": "厦门航空一系列安全漏洞打包", "wybug_corp": "xiamenair.com", "wybug_author": "chuan", "wybug_date": "2014-06-13 17:05", "wybug_open_date": "2014-07-28 17:06", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证设计不合理", "手机短信", "搞笑有爱"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-28：\t细节向公众公开  简要描述： 差3rank换衣服 详细说明：  一、短信炸弹漏洞点：http://ffp.xiamenair.com/About/Regist.aspx这个没啥好说，应该懂的 返回1表示成功 \n\n\n\n修复方案：1、在服务端做校验，同一手机号码一天内短信发送值某个值（如5条）就拒绝发送2、配置短信网关，同一手机号超过某个阀值就拒绝发送二、短信验证绕过漏洞点：http://ffp.xiamenair.com/About/Regist.aspx短信验证码基于前端校验，所以可以通过修改返回数据包的方式绕过，如下图，通过将返回的数据包{\"d\":4}改为{\"d\":2}即可绕过前端校验，以下为该JS代码\n$.ajax({                type: \"Post\",                url: \"Regist.aspx/checkcode\",                data: \"{'txtcode':'\" + txtcode + \"','cmobile':'\" + cmobile + \"'}\",                contentType: \"application/json; charset=utf-8\",                dataType: \"json\",                success: function (data) {                    var rstatu = data.d;                    for (var i = 0; i < 6; i++) {                        if (rstatu == 2) {                            $(\"#checkauthcodestatus\").val(\"true\");                        } else {                            $(\"#checkauthcodestatus\").val(\"false\");                        }                        if (rstatu == i) {                            $(\"#spancode\" + i).css('display', 'inline-block');                        } else {                            $(\"#spancode\" + i).css('display', 'none');                        }                        if (rstatu == 4) {                            $(\"#checkauthcodestatus\").val(\"false\");                        }                    }                }\n\n\n图一：输入错误的验证码\n\n图二：输入错误的验证码\n\n图三：拦截返回的数据包，如图所示，显示的参数是 d：4  4表示错误\n\n图四：将d:4 修改为d:2  2表示成功修复方案：1、在最后提交时对短信验证码做二次校验就可以了三、短信验证绕过（暴力破解短信验证码）这个没啥好说的\n\n图一：短信校验出错未做限制，可暴力破解修复方案：1、做限制2、放弃前端校验，仅在提交时做校验，并对提交时出错做限制。记得其他地方有类似的问题，具体哪忘了，都是些恶心人的缺陷四、struts2开启开发模式（s2-19？）S2-19没验证，自行排查，如果版本<=2.3.15.1就存在漏洞点：http://wap.xiamenair.com//introduce.do\n\n修复方案:1、 You are seeing this page because development mode is enabled. Development mode, or devMode, enables extra debugging behaviors and reports to assist developers. To disable this mode, set:  struts.devMode=falsein your WEB-INF/classes/struts.properties file. 五、tomcat样例文件夹没删运维No do no die\n\n通过wap.xiamenair.com/examples/servlets/servlet/SessionExample能操纵会话变成管理员修复方案：1、删了2、安全培训 OR 搞个服务器的安全基线存在这种问题的网站还有 http://m.xiamenair.comhttp://wap.xiamenair.com其他自行排查    漏洞证明：     修复方案：     版权声明：转载请注明来源 chuan@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2014-06-13 17:46 厂商回复： 都是小问题，对网站几乎没有影响，但也很感谢对厦航信息安全的支持，后续我们会确认并整改相关漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-04 17:31 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  你能换衣服了 正好3rank...    \n     2014-07-14 03:15 |    \t\tSunshine \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:10        | Nothing.)\t\t \n  通过wap.xiamenair.com/examples/servlets/servlet/SessionExample能操纵会话变成管理员，问下dongzhu这个怎么实现?    \n     2014-07-29 04:03 |    \t\tkeke \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:8        | 目测和口算各种妹纸)\t\t \n  哈哈 3 RANK 玩猴    \n     2014-12-17 18:28 |    \t\t阿一 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | \\)\t\t \n  请教下，“通过wap.xiamenair.com/examples/servlets/servlet/SessionExample能操纵会话变成管理员”  能提供个简单步骤么？    \n     2015-03-15 12:37 |    \t\t魂淡、 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 么么哒)\t\t \n  3rank...笑尿    \n     2015-06-18 10:59 |    \t\t赵健康 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:3        | 慢慢进步！！！)\t\t \n  通过wap.xiamenair.com/examples/servlets/servlet/SessionExample能操纵会话变成管理员  这个很鸡肋吧   不能操作吧    \n     2015-06-18 11:14 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @赵健康 他可以添加session的信息的，但是你必须知道后台的代码是怎么处理session的    \n     2015-09-01 16:37 |    \t\t月影歌 \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:1        | 一名新人求互相交流)\t\t \n  3rank笑尿    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}