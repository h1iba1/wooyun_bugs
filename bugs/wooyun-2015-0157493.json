{"id": 79717, "wybug_id": "wooyun-2015-0157493", "wybug_title": "好贷网主站任意账户密码重置（13888888888账户演示）", "wybug_corp": "好贷网", "wybug_author": "Looke", "wybug_date": "2015-12-02 10:02", "wybug_open_date": "2016-01-21 09:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-21：\t细节向公众公开  简要描述： 奇葩方式重置任意账户密码 详细说明：  漏洞地址：\nhttp://www.haodai.com/ajax/getpasswd\n奇葩重置过程，过程如下：1、输入目标手机号138888888888\n\n2、这步是关键，当服务器认为你输入了一个正确的验证码时，验证通过返回步骤3中的页面，那我们是否可以通过某种方式获取服务器的通过权呢？答案是肯定的，经过我多次尝试，发现下面一种绕过方式：在没有获取手机短信验证码或获取验证码后待短信验证码2小时失效后，随意输入一个验证码，提交时抓包，去掉图中标出部分的参数，直接提交，即可通过服务器的验证。因为我们在步骤1输入目标手机号提交后，服务器已向目标手机下发了短信验证码，所以只有等待2小时短信验证码失效后修改参数通过服务器验证进入下一步，验证码未失效时修改参数提交是不成功的，会一直返回验证码错误。当然为了节省时间，我们可以直接用自己手机号作测试，在输入手机验证码步骤中修改id参数并去掉id参数后面的验证码参数，提交也通过了服务器的验证，这种方法可以方便简单的批量修改会员密码。声名：作为一个有节操的白帽子，未做破坏性测试。\n\n3、输入新密码，提交 \n\n4、密码重置成功\n\n   漏洞证明：  登陆验证下，账户：13888888888 密码：wooyun1234\n\n好贷是乌云良心厂商之一，求20rank   修复方案：  @@   版权声明：转载请注明来源 Looke@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-12-07 09:09 厂商回复： 感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-02 10:30 |    \t\tLooke \t\t\t( 普通白帽子  |\t\t\t        Rank:1041 漏洞数:129        )\t\t \n  这个不能上首页吗=_=@浩天    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}