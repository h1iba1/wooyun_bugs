{"id": 19740, "wybug_id": "wooyun-2012-06589", "wybug_title": "又拍网旗下某站存在严重支付漏洞", "wybug_corp": "杭州纬聚网络有限公司", "wybug_author": "imlonghao", "wybug_date": "2012-05-01 23:33", "wybug_open_date": "2012-06-15 23:34", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["盲目信任用户数据", "设计缺陷", "敏感操作逻辑错误", "点卡", "支付安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-05-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-05-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-06-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-06-15：\t细节向公众公开  简要描述： 逆向使用支付功能，不扣钱，反而会给自己的帐户充值。 详细说明：  又拍网旗下又拍图片管家v.yupoo.com在对支付进行处理时，未使用SSL安全连接，也没有对购买时间进行限制。导致当购买时间为负数时，不但不会从帐户中扣除相应的金额，反而还会对帐户进行充值。   漏洞证明：  这里以续费VIP服务为例，其他支付服务麻烦厂商自检。====================================================选定续费的时候后，点击提交，使用Fiddler拦截发送的数据\n\n我们可以看到，其中的renewals_period中包括了我们续费的时间，我们将其修改为负数,RUN\n\n然后发现，神奇的事情来了。总共: ¥-15,840.00。确定支付！\n\n然后会返回首页~使用期限： 2012-05-02 至 1923-05-02 (有功能的，VIP功能可用)您的账户余额: ￥16,020.00 (原先有180)\n\n   修复方案：  使用SSL进行对支付页面的加密限制购买时间的大小，设定最小值和最大值   版权声明：转载请注明来源 imlonghao@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2012-05-02 13:15 厂商回复： 原有购买流程中，没有判断购买服务时间为负数的情况, 目前程序已修正，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-01 22:33 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  已经通知厂商进行修复，并尝试引导其注册为厂商。    \n     2012-05-01 23:18 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @xsser 厂商说他上次注册被拒绝，他可能用的是upai.com的邮箱，我已经叫他用yupoo.com的邮箱注册了。你看我写得那么辛苦，还有图有真相，独特的手法，给个闪电哈。。    \n     2012-05-01 23:20 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @imlonghao 必须闪电 哈哈    \n     2012-05-02 08:37 |    \t\t王老公 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:8        | 最新门事件 色中色门户网 www.sexofsex.ca ...)\t\t \n  洞主可否相告个人联系方式？    \n     2012-05-02 10:48 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  充值负值么@@    \n     2012-05-02 12:22 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  嗯，倒找钱，@Joey Yin 在 WooYun: 花一分钱给地铁里回收旧报纸的老人订了半年《新京报》  的话应验了    \n     2012-05-02 14:00 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @horseluke LS记性真好，我觉得@xsser可以外聘，让你来做个归类，索引……我随口一说，估计不是这么回事~有闪电哦    \n     2012-05-02 22:09 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @王老公 大大想玩什么。。    \n     2012-05-02 22:12 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @horseluke 预言在这里实现了。。    \n     2012-05-03 11:02 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  缺陷关联： WooYun: 115网盘存在支付绕过 （支付安全：异常处理缺陷绕过）    \n     2012-05-18 21:16 |    \t\t王老公 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:8        | 最新门事件 色中色门户网 www.sexofsex.ca ...)\t\t \n  @imlonghao 想跟你学习下那个截包改包软件的用法    \n     2014-04-21 12:24 |    \t\t小贱人 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 资深菜鸟，)\t\t \n  mark    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}