{"id": 43903, "wybug_id": "wooyun-2014-081315", "wybug_title": "某商业链系统通用任意文件上传漏洞及列目录泄露源码和数据库信息", "wybug_corp": "北京富基融通科技有限公司", "wybug_author": "路人甲", "wybug_date": "2014-10-31 10:14", "wybug_open_date": "2015-01-29 10:16", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "列目录"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-08：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向公众公开  简要描述： 涉及全国多家超市、商场，系统涉及的都是每天的流水账。 详细说明：  http://wooyun.org/bugs/wooyun-2010-066857 发掘另外几处漏洞技术支持:北京富基融通科技有限公司(http://www.e-future.com.cn/)程序名称：商业供应链系统漏洞类型：任意文件上传导致代码执行、列目录泄露备份源码、数据库信息一、任意文件上传前人的漏洞是自己本地构造一个html，其实网站同级目录下就有upload.html/web/epublic/upload.html1.http://123.127.107.117/web/epublic/upload.html\n\n直接上传jsp小马，位置如下：\n\nmask 区域\n1.http://**.**.**/web/upload/x.jsp aa_2.2.http://**.**.**/web/upload/x.jsp aa_3.3.http://**.**.**/web/upload/x.jsp aa_4.4.http://**.**.**/web/upload/x.jsp aa_5.5.http://**.**.**/web/upload/x.jsp aa_6.6.http://**.**.**/web/upload/x.jsp aa_7.7.http://**.**.**/web/upload/x.jsp aa_8.8.http://**.**.**/web/upload/x.jsp aa_9.9.http://**.**.**/web/upload/x.jsp aa\n\n二、bak目录遍历，网站源码、数据库文件备份等都可下载：1.http://221.194.122.150/web/bak/\n\n打开后发现是数据库备份\n\n2.http://60.213.49.66:8000/web/bak/\n\n3.http://61.161.160.102:8080/web/bak/\n\n看看源码：\n\n4.http://gyl.jxggls.com:8080/web/bak/5.http://scm.brjt.cn:8081/web/bak/6.http://123.127.107.117/web/bak/7.http://60.10.134.176:8080/web/bak/   漏洞证明：  \n\n   修复方案：  上传点：服务器端做后缀校验，白名单策略列目录：备份目录更改下权限   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-11-05 08:15 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}