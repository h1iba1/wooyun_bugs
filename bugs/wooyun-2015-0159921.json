{"id": 78674, "wybug_id": "wooyun-2015-0159921", "wybug_title": "国国家工商行政管理总局绕过验证获取数据（外送SQL注射）", "wybug_corp": "国国家工商行政管理总局", "wybug_author": "加州菲猫", "wybug_date": "2015-12-10 17:27", "wybug_open_date": "2016-01-25 18:01", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-25：\t细节向公众公开  简要描述： 可以绕过查询验证，对数据进行抽取，达到一种拖库行为。 详细说明：  可以绕过查询验证，对数据进行抽取，达到一种拖库行为。   漏洞证明：  1、通过一个URL进入列表页，查看URLhttp://**.**.**.**:9080/tmois/wszhcx_pageZhcxMain.xhtml?type=reg&intcls=&regNum=12000020\n12000020是注册号\nhttp://**.**.**.**:9080/tmois/wszhcx_pageZhcxMain.xhtml?type=${类型}&intcls=&regNum=${注册号}\n\n2、验证后的URL：具体信息：http://**.**.**.**:9080/tmois/wszhcx_getDetailByRegInt.xhtml?regNum=12000020&intcls=5&seriaNum=1&codeShow=68v5经营信息：http://**.**.**.**:9080/tmois/wszhcx_getGoodsDetail.xhtml?regNum=12000020&intcls=5生成规则就是加上RegNum和Intcls就能直接拿到数据3、我们可以构造http://**.**.**.**:9080/tmois/wszhcx_pageZhcxMain.xhtml?type=reg&intcls=&regNum=120000201200000 - 5000000 二分法写个脚本去寻找起始值和最后的值生成URL然后写一个程序：1、取URL参数  RegNum和Intcls2、提取信息(直接访问构造的地址可以绕过验证码,可见开发人员有多马虎)\n\n-----最后给一个好玩的，大家可以深入测试下：\n\n   修复方案：  过滤   版权声明：转载请注明来源 加州菲猫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-12-14 16:42 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向国家上级信息安全协调机构上报,由其后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-11 17:13 |    \t\t加州菲猫 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:7        | 加菲猫的初体验。%00 01 022 0 1 0 5)\t\t \n  某人爬完了没有，待确定？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}