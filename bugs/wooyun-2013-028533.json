{"id": 9084, "wybug_id": "wooyun-2013-028533", "wybug_title": "金山WPS存在安全漏洞可能导致任意代码执行", "wybug_corp": "金山软件集团", "wybug_author": "dragonltx", "wybug_date": "2013-07-11 11:57", "wybug_open_date": "2013-10-09 11:58", "wybug_type": "远程代码执行", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-09-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-09：\t细节向公众公开  简要描述： 可以造成远程代码执行攻击 详细说明：  WPS抢先版主程序wps.exe、wpp.exe、et.exe存在dll劫持风险，wps.exe在启动时会加载wpsrw.dll，wpp.exe在启动时会加载wpprw.dll和uofswr.dll,et在启动时会加载uofssrw.dll，这些dll在本地不存在，如果黑客将htm格式的文件加上上述对应的恶意dll打包放在一起，发给用户。诱使用户打开上述格式文件，就会执行恶意程序，危害较大。   漏洞证明：  1、随便建个文件夹，再将证明漏洞的wpprw.dll与test.htm放在一起，用wps演示打开test.htm，就会加载wpsrw.dll，如下图：\n\n\n\n2、Poc见\nhttp://wydrops-wordpress.stor.sinaapp.com/uploads/2013/07/WPSTEST.zip\n   修复方案：  使用LoadLibrary API加载DLL时使用绝对路径   版权声明：转载请注明来源 dragonltx@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2013-07-11 13:02 厂商回复： 作为客户端程序加载dll路径劫持类威胁，综合考虑漏洞严重程度、利用难度、影响范围，评估为低危。同时该威胁之前多家国内安全机构和个人反馈过。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-11 12:11 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  2013吗??win还是linux??    \n     2013-07-11 12:24 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @基佬库克 看标题基友。。。是可能，，    \n     2013-07-11 12:30 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  利用难度大啊    \n     2013-07-11 12:34 |    \t\tdyun \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:15        | [code][/code])\t\t \n  dz 在腾讯呀，咋不发binvul    \n     2013-07-11 17:31 |    \t\tChu \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:9        | 学习ing。)\t\t \n  给跪了，原来是dll劫持...    \n     2013-07-11 18:03 |    \t\tdyun \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:15        | [code][/code])\t\t \n  记得binvul里说过呀wps一堆洞...    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}