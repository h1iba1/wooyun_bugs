{"id": 42268, "wybug_id": "wooyun-2014-086283", "wybug_title": "宜信某平台突破服务端验证（业务逻辑设计错误）", "wybug_corp": "宜信", "wybug_author": "diguoji", "wybug_date": "2014-12-08 11:07", "wybug_open_date": "2015-01-22 11:08", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "手机短信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-22：\t细节向公众公开  简要描述： 某平台可以突破绕过服务器认证 进入自己的账户 无需服务端审核  并且可以用自己指定的邮箱手机号码，进行注册，无需验证。 详细说明：  http://i.yixin.com/ 宜信在线使用手机号注册好 点击进入我的账户\n\n此时会进行身份验证，只有投资过验证通过才能进入资产账户，也就是说宜信那边要通过某种方式确认你是投资了，服务端会进行确认或者其他类型操作确认你是投资过的才能通过，正常没有验证通过的用户输入身份证后是这样的\n\n下边来抓包看 http请求和响应 都拦截，观察，经过测试查看到其中端倪，看下图\n\n中途还进行了一次get请求，没做测试 仅限于做逻辑测试，所以直接看回应包\n\n此处服务器返回数据无参数 开发人员开发中利用此项服务器返回值作为验证用户是否投资，客户端返回数据可以修改，经过尝试将值改为1 看返回结果\n\n发送下响应到客户端执行，经过 4次回应，如下，已经绕过验证\n\n\n\n首先确定没有注册邮箱和手机号码，所以肯定收不到校验码，没关系，验证方式还是一样，随便填上校验码提交上抓包，拦截响应继续改，看截图\n\n\n\n这里需要验证身份此处将自己的邮箱和手机号填上，\n\n\n\n\n\n至此可以绕过服务器认证 进入自己的账户 并且可以用自己指定的邮箱手机号码，进行注册，无需验证。   漏洞证明：  验证方式同一拨开发人员的开发的 问题应该都一样 其他平台位测试，感觉可以刷钱，由于没有正常账号所以未做测试。   修复方案：  认证方式需要修改   版权声明：转载请注明来源 diguoji@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2014-12-12 17:21 厂商回复： 感谢，问题提交很详细。后端认证并未通过 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}