{"id": 82375, "wybug_id": "wooyun-2015-0151270", "wybug_title": "荷包金融android客户端手势密码绕过及其他漏洞", "wybug_corp": "hebaodai.com", "wybug_author": "云之凡", "wybug_date": "2015-11-03 13:28", "wybug_open_date": "2015-12-17 14:48", "wybug_type": "非授权访问/认证绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["客户端程序设计错误", "安全", "手机软件安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-06：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 具体看详细信息 详细说明：  一: 配置备份漏洞\n\nandroid:allowBackup=\"true\"表示应用允许用户通过系统备份工具备份应用数据然后恢复,荷包应用涉及用户隐私与财产安全不应该选择开启此功能,因为这样用户在未 root 的情况下应用数据可能被短时间内被攻击者复制,从而导致用户帐户被盗。备份命令:adb backup -apk -nosystem -noshared -f backup.db com.hebao.app恢复命令app restore backup.db二:手势明文存储漏洞荷包应用将用户设置的手势密码明文保存在/data/data/com.hebao.app/shared_prefs/shared_other.xml文件中,我通过 ADB 工具可以很轻松的读取此文件内容:\n\n把九宫格转换为数字,按照对应的数字滑动手势\n\n   漏洞证明：  三: 服务拒绝漏洞对intent 未做异常处理, 导致应用崩溃adb shell am broadcast -n com.hebao.app/com.igexin.download.DownloadReceiver\n\n\n\n四: 泄露用户敏感信息用户手机号码和Token信息泄露\n\n\n\n   修复方案：  1 android:allowBackup 设置为false2 手机密码做加密3 做异常处理   版权声明：转载请注明来源 云之凡@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-11-03 16:50 厂商回复： 已收到，技术已经在核实中... 最新状态： 2016-02-02：在12月份已修复  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}