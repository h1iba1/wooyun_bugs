{"id": 79222, "wybug_id": "wooyun-2015-0158602", "wybug_title": "魅力惠设计逻辑缺陷可任意重置口令（两种方法）", "wybug_corp": "魅力惠时尚奢侈品闪购网", "wybug_author": "userlxx", "wybug_date": "2015-12-07 12:01", "wybug_open_date": "2016-01-21 12:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证设计不合理", "重置口令"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-07：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-01-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 魅力惠时尚奢侈品闪购网（http://www.mei.com/）。 详细说明：  魅力惠（http://www.mei.com/）网站可重置任意用户口令。1、注册账号，然后就“忘记密码”了。url: http://www.mei.com/user/tofindPassWord。填入自己手机号、验证码，点击“获取验证码”。验证码就发到手机了，5位数字。\n\n2、方法一：5位数字的验证码，且检查“验证码”的接口没有次数限制，可暴力破解。当时验证码是65532，跑了好一会儿还差一大截。。果断放弃了，但是此方法是可行的。重点讲方法二。3、方法二：使用正确的验证码通过检查，然后设置重置账号手机号，输入密码即可重置。重置口令过程中涉及到的URL及对应功能如下：\n/user/tofindPassWord：找回密码的开始页；/user/toCheckRandom：检验向重置账号手机发送的验证码，若成功则“注册”sessionID；（参数：random=xxxxx）/user/toNext：传入手机号，返回重置密码页面（参数：userAccount=18600001234）；/user/toModifyPassWord：重置密码（参数：passWord=xxxxxx）。\n4、从/user/toModifyPassWord的传入参数发现报文并未携带账号id，则可知其根据sessionID重置账号的口令。那么，这个账号与sessionID的绑定肯定是/user/toNext完成的。5、输入正确的验证码（65532）——猜测此步骤完成session的注册，因为直接重放/user/toNext不成功。\n\n6、接下来发送请求：/user/toNext，参数为账户号码（修改为另外注册的号码）。\n\n7、重置口令页面填入密码，即可重置账户口令。\n\n\n\n   漏洞证明：  1、重置口令如上。2、另外，可纵向越权删除收货地址（url：/userAddress/deleteaddress）。由于其id并非递增（如1158115899000003095、1172117299000002725），漏洞影响有限。但是id还是存在一定规律的：xxxx xxxx 9900000 zzzz，可遍历xxxx、yyyy删除（两处xxxx为相同四位数字）。\n\n   修复方案：  你们更专业~   版权声明：转载请注明来源 userlxx@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}