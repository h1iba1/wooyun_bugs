{"id": 35573, "wybug_id": "wooyun-2015-0103634", "wybug_title": "问津kiford任意用户密码重置验证码漏洞", "wybug_corp": "问津专业在线咨询", "wybug_author": "路人甲", "wybug_date": "2015-03-26 16:34", "wybug_open_date": "2015-05-10 16:36", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "2", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-26：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-05-10：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  1 可重置任意用户的密码，找回密码时验证码可以遍历2 某页面存在后台弱口令问津\nhttp://www.kiford.com/\n 问题所在是：找回密码的验证码是6位数字，有效期24小时，这样就可以遍历了。点击找回密码 \n\n 输入用户名，用户名可以在客户端中查看到，随便选 然后邮箱方式，给邮箱发送验证码测试一下验证码111111，抓取验证验证码的包，\nPOST /website/check-pw-valid-code.json HTTP/1.1Host: www.kiford.comConnection: keep-aliveContent-Length: 40Accept: */*Origin: http://www.kiford.comX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36 LBBROWSERContent-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://www.kiford.com/website/changepw.htmlAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=76E0B8D0FF3EFD9BC4257A1ADAA77B36userid=ur00000000000282&validcode=111111\n然后验证码从100000到999999遍历，\n\n\n\n六位数虽然不算多，但是也得运行一段时间。验证码正确则\"retCode\":\"000000\"，否则\"retCode\":\"030009\"：\n\n\n\n这样就找到了验证码，输入改密：\n\n\n\n改密成功可以登录，产品的登录需下载客户端（ps:这个体验是很糟糕的）。\n\n另外，网站有一个弱口令存在：\nhttp://www.kiford.com/manager/\n用户名密码为：\nadmin/kiford\n\n\n\n\n   漏洞证明：  证明如上：\n\n\n\n另，\n\n   修复方案：  1 验证码有效时间给短一点2 验证码不近限于数字，加入大小写字母3 管理页面密码改了，不要和网站同名   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}