{"id": 5764, "wybug_id": "wooyun-2014-048606", "wybug_title": "腾讯QQ举报漏洞可直接可以封任意一个好友的QQ号", "wybug_corp": "腾讯", "wybug_author": " 老灰", "wybug_date": "2014-01-12 10:11", "wybug_open_date": "2014-02-26 10:12", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-26：\t细节向公众公开  简要描述： 已经有不法分子利用此漏洞冒充黑客进行勒索，以及冒充腾讯内部人员进行敲诈，此漏洞的危害极大，经本人测试，可永久封号。 详细说明：  其实原理非常的简单，但是这么简单为什么偏偏出现这样的漏洞，修改本地内存数据，将自己的QQ号修改成对方的QQ号，然而进行发广告骂人等恶意信息，让程序误判是对方发来的消息，然而举报即可。   漏洞证明：  首先我们打开自己的QQ，之后找到要封对方的QQ号。我拿我自己的测试号来做实验，号码：609792954首先我用我自己的号加这个测试号为好友。然后我打开聊天窗口，看图。\n\n然后打开CE，做外挂的朋友我想对这个都很了解，我就不解释了。打开之后选择QQ进程，如图：\n\n现在进程点击打开：搜索自己的QQ号，比如我的QQ号：712060625我就搜索712060625\n\n搜索之后看结果：\n\n结果非常多，我这里的结果有408个，每个人的搜索的结果都是不一样的。由于本人不是专业做外挂的，而且这些数据大部分都是固定的，不会更变。所以我用最郁闷的方法，一个一个尝试，我测试了几次，每次都在前面二十个地址以内。会动的地址我们排除掉。\n\n然后我们一个一个修改尝试，然后我们在QQ聊天窗口下发信息。\n\n然后我们发布一些广告信息，就是自己发的信息变成对方发的信息。比如：看图\n\n发布垃圾广告之后，把之前CE修改的QQ号修改回去 也就是修改自己的。\n\n如果不修改无法举报，修改回来之后进行举报。\n\n如图：\n\n没多久腾讯就发过邮件来了，请看邮件。\n\n然后我登陆小号\n\n这个图是今天的，时间是昨天的，因为我昨天测试的时候用同样的方法，小号没有解除限制所以时间显示是昨天的时间。\n\n需要修改密码才能解除限制，想象一下有多少菜鸟不知道什么是密保的?而且多次举报，行为恶劣号码将永久封号。这漏洞的危害个人认为是非常大的，直接可使一个无辜的人永久封号，有网友找我说，有一个人自称是马化腾，说他的QQ号有非法行为，需要他汇款过去，否则封他的话。问话他是不是马化腾他确实封了他的号。希望腾讯尽快修复，以防不法分子继续勒索诈骗，让无辜的人受害。   修复方案：  可以在程序中加判断，也可以修改举报规则，方案非常多，想必你比我懂吧。   版权声明：转载请注明来源  老灰@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-01-12 19:16 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-12 10:27 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  神奇的路人甲    \n     2014-01-12 11:05 |    \t\t计算姬 \t\t\t( 普通白帽子  |\t\t\t        Rank:398 漏洞数:90        | 看我看我看我啊)\t\t \n  神奇的路人甲    \n     2014-01-12 13:52 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  神奇的路人甲    \n     2014-01-12 16:07 |    \t\tBlackeagle \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 向WooYun致敬)\t\t \n  封一个369458956试试 看看啥效果（测试 勿见怪^_^）    \n     2014-01-12 16:40 |    \t\t微尘 \t\t\t( 普通白帽子  |\t\t\t        Rank:218 漏洞数:74        )\t\t \n   路人甲，你在wooyun这么牛逼，你家里人知道吗？    \n     2014-01-12 19:01 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  为什么要这牛逼！    \n     2014-01-12 19:17 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  路人甲现在变老灰了。。    \n     2014-01-12 21:35 |    \t\t网维 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 为您提供优质服务！)\t\t \n  神奇的路人甲     \n     2014-01-13 14:17 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  我去，好像两周之前在52pojie看到一个利用软件来着~    \n     2014-01-29 19:24 |    \t\t毕月乌 \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:16        | 猜猜我是谁？)\t\t \n  mark一下~神奇的老灰~    \n     2014-02-02 20:39 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小川 我去！这个算是越权啊！！！    \n     2014-02-06 20:52 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  @px1624 恩，不是我们常见的http协议，太NB了    \n     2014-02-07 02:09 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小川 修改内存信息的    \n     2014-02-08 10:34 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  这人老灰了……    \n     2014-02-12 01:02 |    \t\t大白菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:19        )\t\t \n  ...还有一个比这个更好的工具，以前玩反恐OL的时候刷枪用的    \n     2014-02-12 09:28 |    \t\t计算姬 \t\t\t( 普通白帽子  |\t\t\t        Rank:398 漏洞数:90        | 看我看我看我啊)\t\t \n  @大白菜 求介绍    \n     2014-02-12 12:27 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  老灰、、、、、还记得我不    \n     2014-02-12 16:54 |    \t\t纷纭 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:8        | 学习者。)\t\t \n  这个貌似老早都有这个工具了，以前有人拿易语言写过。20RANK啊真值    \n     2014-02-26 22:34 |    \t\t脚本菜菜 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | 我只是混个邀请码。)\t\t \n  这都能想出来，厉害    \n     2014-02-27 09:38 |    \t\t卖火柴的小男孩 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:4        | muyou)\t\t \n  这都给你想出来了、    \n     2014-03-01 17:22 |    \t\t东方的肚皮舞 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | 社区变了。)\t\t \n  你怎么做的？    \n     2014-04-24 16:55 |    \t\tdebbbbie \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 深藏功与名 - A Rubyist)\t\t \n  赞！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}