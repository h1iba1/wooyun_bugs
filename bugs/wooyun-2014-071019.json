{"id": 52504, "wybug_id": "wooyun-2014-071019", "wybug_title": "某通用型校园管理系统SQL注射(sa权限)", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "xlz0iza1", "wybug_date": "2014-08-05 12:03", "wybug_open_date": "2014-11-03 12:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-03：\t细节向公众公开  简要描述： RT 详细说明：  关键字:inurl:/ws2004/后台地址:/ws2004/SysManage/index.asp\n\n注入漏洞：\n第一处：\\SysManage\\Resource\\resset\\add.asp\tID= Request.QueryString(\"ID\")\tif ID=empty then\t\tResponse.Write \"未指定资源分类\"\t\tResponse.End()\tend if\t\tdim objData\tset objData = Server.CreateObject(\"wsmanage.template\")\tstrSql = \"SQL:select FunctionName from webFunction where ID=\" &ID\tstrFunctionName = objData.GetOneData(strSql)\tset objData = nothing第二处：\\SysManage\\Resource\\resset\\edit.asp\tID= Request.QueryString(\"ID\")\tresflagID = Request.QueryString(\"flagID\")'\tResponse.Write resflagID\tif ID=empty then\t\tResponse.Write \"未指定资源分类设置ID\"\t\tResponse.End()\tend if\t\tdim objData\tset objData = Server.CreateObject(\"wsmanage.template\")\t\tdim regUser,sysUser\tstrSql=\"SQL:select UN from resDownRight where UserType='reg' and resFlagID=\" &resflagID\tregUser = objData.GetOneData(strSql)\tstrSql=\"SQL:select UN from resDownRight where UserType='sys' and resFlagID=\" &resflagID\tsysUser = objData.GetOneData(strSql)\t\tstrSql = \"SQL:select b.FunctionName, a.bNeedRight, a.AllowedFileType, a.AllowedFileSize, a.SavePath \"\tstrSql = strSql & \" from resFlag a, webFunction b where b.ID=a.resFunID and a.ID=\"&ID\t\tset Rs = objData.GetRecordSet(strSql)\t\t'\tset objData = nothing\t\tif Rs.eof then\t\tResponse.Write \"该设置项已经被删除\"\t\tResponse.End()\tend if\n   漏洞证明：  案例：\nhttp://www.fzjcxx.cn/http://lnjpgz.com/http://www.cgyz.net.cn/http://www.yygy.net/http://www.sdjnzx.com/http://www.zjk2z.cn/http://www.sdjnzx.com/http://www.hwsyxx.com/http://sgtjb.com/http://www.tadyzx.com/http://www.gzsjx.cn/http://www.yygy.net/http://www.sdjnzx.com/http://www.zjgzjzx.cn/http://www.hn26z.com/http://www.wuai.lwedu.sh.cn/http://www.yzsx.net.cn/\n未授权访问+sql注入。\n\n\n\n太多的案例我就不一一演示。   修复方案：  过滤哦，亲~   版权声明：转载请注明来源 xlz0iza1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2014-08-10 09:27 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}