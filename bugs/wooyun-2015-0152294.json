{"id": 82010, "wybug_id": "wooyun-2015-0152294", "wybug_title": "巨圣鞋业有限公司BOS系统漏洞导致getshell（员工信息、VIP客户信息、门店等等信息泄露）", "wybug_corp": "温州市巨圣鞋业有限公司", "wybug_author": "路人甲", "wybug_date": "2015-11-06 13:54", "wybug_open_date": "2015-12-25 10:40", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-25：\t细节向公众公开  简要描述： 可获取该企业进销存信息，部分也包含员工信息、VIP客户信息、门店等等信息，本来打算提交通用漏洞了，后来发现个体差异太大。 详细说明：  由上海伯俊软件科技有限公司开发的BOS系统目前发现存在以下几点问题#1.某测试页面泄露系统内具有管理权限的用户信息#2.伯俊bpos系统登陆设计缺陷，可用于获取用户明文密码#3.伯俊portal系统后台python代码执行用于获取webshell代言人:杨幂系统地址\n**.**.**.**:90\n露个面\n\n   漏洞证明：  #1.某测试页面泄露系统内具有管理权限的用户信息页面**.**.**.**:90/html/portal/test.jsp泄露敏感信息\n\n#2.伯俊bpos系统登陆设计缺陷，可用于获取用户明文密码（通用漏洞）访问**.**.**.**:90/bpos如遇下面提示，请等待升级完毕\n\n挂burpsuite，拦截数据，输入#1中获取的用户名\n\n为什么这里使用这个账户那？因为有些账户没有激活或不存在，测试这个可以使用拦截请求，返回信息如下\n\n返回信息中的\ntinglong\n就是密码登录bpos失败，提示XX控件问题，不管了，登陆portal去登陆成功\n\n#3.伯俊portal系统后台python代码执行用于获取webshell进入\n后台管理-元数据层-系统命令在线脚本执行界面\n\n\n地址为\n**.**.**.**:90/html/nds/shell/index.jsp\n\n\n利用Python获取网站当前路径\nimport sysprint sys.path[0]\n\n\n在当前路径处写webshell\nimport sysoutput = file(r\"E:\\newbos_new\\portal422\\server\\default\\deploy\\nds.war\\html\\nds\\portal\\index1.jsp\", 'w+')output.writelines(r'''webshell code wooyun''')output.close()\n\n\n最终可以任意获取webshell\n\nwebshell已删除好了 漏洞证明完毕，看看系统里都有什么吧VIP客户资料\n\n还有商品信息什么的   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-11-10 10:39 厂商回复： 暂未建立与网站管理单位的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}