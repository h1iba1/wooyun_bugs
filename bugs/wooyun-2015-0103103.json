{"id": 43805, "wybug_id": "wooyun-2015-0103103", "wybug_title": "绕过和讯网WAF爆破用户进行撞酷", "wybug_corp": "和讯网", "wybug_author": "new", "wybug_date": "2015-03-22 22:27", "wybug_open_date": "2015-05-07 09:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-07：\t细节向公众公开  简要描述： 和讯网提供了遍历用户的接口，但是在爆破用户密码的时候被WAF给拦截了，百般试探下终于绕过WAF，成功爆破 详细说明：  和讯网用户邮箱遍历接口：https://reg.hexun.com/regname.aspx简单的注册功能，填写完邮箱后便可以使用ajax提交检验用户是否已经注册过，未注册过返回只为：\n{\"state\":\"Y\",\"msg\":\"可用\"}\n注册过未：\n{\"state\":\"N\",\"msg\":\"邮箱已经被注册\"}\n这个接口没什么问题，知道一部分注册过的邮箱而已，使用其中一个用户爆破密码试试，看看可不可以撞库什么的，但是爆破十几次之后出现了这个：HTTP/1.1 200 OKServer: nginx/1.6.2Date: Sun, 22 Mar 2015 13:46:58 GMTContent-Type: Text/Html; charset=gb2312Content-Length: 98Connection: closeCache-Control: no-cachePragma: no-cacheExpires: -1X-AspNet-Version: 4.0.30319Set-Cookie: hexunGoUrl=http://i.hexun.com; path=/X-Powered-By: ASP.NET<Script Language='JavaScript'>alert('您暂时不能登录，请过一段时间再登录');history.go(-1);</Script>\n\n这个明显有waf，我看看能不能绕过，换个账号再试，\n\n什么，换号都不好用？这明显封了我的ip，我决定换个ip试试，就是这一试，我发现了：先试试给个x—forwarded－for，看能不能，开启火狐的插件，来个：X-Forwarded-For\t127.0.0.1看你还拦不拦，结果就是这样：\n\n成功登录：\n\n至此waf的账号锁定已然失效，其它用户不再一一爆破，望莫出12306门   漏洞证明：  同上   修复方案：  修改waf策略   版权声明：转载请注明来源 new@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-03-23 09:41 厂商回复： 谢谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}