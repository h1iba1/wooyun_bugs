{"id": 16151, "wybug_id": "wooyun-2012-012928", "wybug_title": "新理念外语网络教学平台文件上传", "wybug_corp": "上海外语教育出版社", "wybug_author": "Icyblade", "wybug_date": "2012-10-09 16:37", "wybug_open_date": "2012-11-23 16:38", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-10-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-10-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-10-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-11-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-11-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-11-23：\t细节向公众公开  简要描述： 好多大学都在用这个教学平台，这个漏洞会导致直接拿到试题答案，甚至作为跳板继续渗透进入学校其他服务器中 详细说明：  信息泄露和权限不严导致列目录及上传以南开大学的为例: \nhttp://222.30.60.3/NPELS\nNPELS_LearningCenter_5.0 客户端下的 Update.exe.config 文件泄露一个重要地址\n<setting name=\"Update_CommonSvr_CommonService\" serializeAs=\"String\">        <value>http://222.30.60.3/NPELS/CommonService.asmx</value></setting>\n及版本号\n<add key=\"TVersion\" value=\"1, 0, 0, 2187\"></add>\n直接访问\nhttp://222.30.60.3/NPELS/CommonService.asmx\n使用GetTestClientFileList操作，直接 HTTP GET 列目录：\nhttp://222.30.60.3/NPELS/CommonService.asmx/GetTestClientFileList?version=1, 0, 0, 2187\n进一步列目录（返回的网页很大，可以直接 wget 下来）\nhttp://222.30.60.3/NPELS/CommonService.asmx/GetTestClientFileList?version=../../\n发现\nhttp://zzxx.nankai.edu.cn/npelsv/editor/editor.htm\n可以上传，直接上传aspx木马即可，不需要改后缀名或者文件头上传后继续列目录找到木马地址直接访问即可OOXXGoogle \"新理念外语网络教学平台\" 测试了几个其他的站，都有类似的列目录上传方法   漏洞证明：  列目录：\nhttp://222.30.60.3/NPELS/CommonService.asmx/GetTestClientFileList?version=../../\n文件上传：\nhttp://222.30.60.3/npelsv/editor/editor.htm\n上传木马：\nhttp://222.30.60.3/npelsv/editor/uploadfiles/1.aspx\n   修复方案：  好像考试系统必须使用 CommonService.asmx最好配置文件加密或者用别的方式不让它泄露出来并且检查或删除各上传入口，像 http://222.30.60.3/NPELS/Upload.aspx 一样   版权声明：转载请注明来源 Icyblade@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2012-10-12 22:33 厂商回复： CNVD确认漏洞并复现所述情况，并交由上海交通大学网络中心协同分析处置，已完成相关软件两个版本的通用漏洞确认。对于厂商，由CNVD联系处置，同时已商请上海交通大学网络中心协助对各高校处置情况进行技术监督。按通用软件漏洞类型，按完全影响机密性，部分影响可用性和完整性进行评分，rank=8.97*1.2*1.4=15.069 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-11-30 16:37 |    \t\thack2012 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:3        | 关注信息安全 http://www.waitalone.cn/)\t\t \n  webservice黑客呀。。支持！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}