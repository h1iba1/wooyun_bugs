{"id": 44743, "wybug_id": "wooyun-2015-098900", "wybug_title": "WordPress某插件全版本存储型XSS可打后台影响3万多站点", "wybug_corp": "wordpress某插件", "wybug_author": "风居住的街道", "wybug_date": "2015-03-01 11:27", "wybug_open_date": "2015-04-15 11:28", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "插件"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-15：\t细节向公众公开  简要描述： 等公开吧，我觉得利用门槛挺低的，而且可以批量 详细说明：  今天我像往常一样进自己的博客后台，打开SEO Redirection这个插件的设置界面查看网站的redirect情况，看是否有谁扫我的站或者又来了哪些爬虫。由于我把网站所有不存在的页面全导向自己设置的404.html页面，如果访客访问了不存在的链接，那么都会被导向该404.html页面并被这款插件记录下来。问题就出在历史记录页面上：该插件没做任何过滤就将跳转链接显示在后台。如果某个WP网站装了这个插件，我们只需访问一个简单的链接：\nhttp://xxx.xxx/<script>alert(1)</script>\n即可让此链接在网站后台显示，并执行脚本。\n\n我们再测试一下打cookie.结果成功收到cookie\n\n由于该跳转记录如果不手动清除会一直存在于后台，所以每次站长进入这个页面都会被打到一次，因此也不用怕cookie过期的问题。该插件还会在数据库里建三个表，历史跳转记录也会写入数据库，如图\n\n由于水平有限，尚不清楚这样做是否会有更大风险。此插件被大概三万多站长安装，所以危害还挺大。\n\n如果写一个爬虫，匹配网站指纹将所有WP站点跑一遍，那么凡是装了这个插件的网站基本全部躺枪了。当然我没这么做 ：）该插件为国外的作者制作，我并未发出通知，还请乌云代为联系。   漏洞证明：  \n\n\n\n   修复方案：  1.对后台输出页面进行过滤；2.另外考虑改变链接在数据库的存储方式   版权声明：转载请注明来源 风居住的街道@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-03-06 08:34 厂商回复： 先行确认,暂未能完整复现,同时也未能建立与插件相关方的联系渠道. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-01 11:45 |    \t\tJumbo \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:29        | 猫 - http://www.chinabaiker.com)\t\t \n  1    \n     2015-03-01 12:13 |    \t\t阿里阿里 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 来打酱油的)\t\t \n  mark    \n     2015-03-01 12:16 |    \t\t1c3z \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:29        | 我读书少，你可别骗我！！！)\t\t \n  操作失败，请与管理员联系!    \n     2015-03-01 14:57 |    \t\t白开水 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:27        | 苍茫的天涯是我的爱~)\t\t \n  duang~~~~~~~~~~~~~~~~~    \n     2015-03-01 16:34 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  这厮是200个rank的节奏吗？    \n     2015-03-01 16:44 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  突然想到可以自己写插件，然后提交漏洞＝＝    \n     2015-03-06 09:33 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  0day    \n     2015-04-15 12:18 |    \t\tZtz \t\t\t( 普通白帽子  |\t\t\t        Rank:152 漏洞数:40        | 自由职业)\t\t \n  @qhwlpg 你要证明你的用户量足够大，能产生影响。    \n     2015-04-15 16:51 |    \t\tDeep. \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | &#8238;)\t\t \n  最近测试,抓到wp的cookie都登不了后台...这个抓出来能登?    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}