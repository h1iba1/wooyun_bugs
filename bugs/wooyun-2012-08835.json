{"id": 18439, "wybug_id": "wooyun-2012-08835", "wybug_title": "华为某盘远程代码执行漏洞", "wybug_corp": "华为技术有限公司", "wybug_author": "乌山云雨", "wybug_date": "2012-06-27 01:29", "wybug_open_date": "2012-08-11 01:29", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-11：\t细节向公众公开  简要描述： 远程执行任意代码 详细说明：  Struts2的核心是使用的webwork框架，处理 action时通过调用底层的getter/setter方法来处理http的参数，它将每个http参数声明为一个ONGL（这里是ONGL的介绍）语句。当我们提交一个http参数：Java代码?user.address.city=Bishkek&user['favoriteDrink']=kumys ?user.address.city=Bishkek&user['favoriteDrink']=kumysONGL将它转换为：Java代码action.getUser().getAddress().setCity(\"Bishkek\")  action.getUser().setFavoriteDrink(\"kumys\") action.getUser().getAddress().setCity(\"Bishkek\")action.getUser().setFavoriteDrink(\"kumys\")这是通过ParametersInterceptor（参数过滤器）来执行的，使用用户提供的HTTP参数调用 ValueStack.setValue()。为了防范篡改服务器端对象，XWork的ParametersInterceptor不允许参数名中出现“#”字符，但如果使用了Java的 unicode字符串表示\\u0023，攻击者就可以绕过保护，修改保护Java方式执行的值：    漏洞证明：  \n\n   修复方案：  打补丁   版权声明：转载请注明来源 乌山云雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-06-29 10:33 厂商回复： 已经修改，谢谢白帽子的支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-27 02:24 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  无法相信    \n     2012-06-27 04:25 |    \t\tHenry:bobo \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:22        | 本胖吊！~又高又肥2个奶奶像地雷)\t\t \n  ..神奇的路人甲    \n     2012-06-27 09:35 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  这个的确是真的，直接秒了。    \n     2012-06-27 09:50 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  某网盘？华为网盘？    \n     2012-06-27 10:39 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  搞笑的云 搞笑的云安全    \n     2012-06-27 11:19 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @xsser 这个也叫云？安全？    \n     2012-06-27 11:20 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @zeracker 网盘就是云的概念，这样的数据往上放放心么？    \n     2012-06-27 11:53 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  ... 洞主你这名字    \n     2012-06-27 16:07 |    \t\tHenry:bobo \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:22        | 本胖吊！~又高又肥2个奶奶像地雷)\t\t \n  @xsser -  -说明他爱。。    \n     2012-06-27 18:06 |    \t\tBlackeagle \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 向WooYun致敬)\t\t \n  @xsser 很多网盘都不安全。。    \n     2012-06-29 21:39 |    \t\t波波虎 \t\t\t( 普通白帽子  |\t\t\t        Rank:266 漏洞数:51        | 11111111111)\t\t \n  工具加快了生产效率    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}