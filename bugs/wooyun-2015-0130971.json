{"id": 25595, "wybug_id": "wooyun-2015-0130971", "wybug_title": "土巴兔某处权限控制不严，可越权/遍历大量订单信息", "wybug_corp": "土巴兔装修网", "wybug_author": "wps2015", "wybug_date": "2015-08-03 14:49", "wybug_open_date": "2015-09-17 15:04", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-17：\t细节向公众公开  简要描述： 20rank有木有 详细说明：  先去土巴兔注册一个账号，这里我注册的是 root123 root123<img src=\"/upload/201508/0121335730e5a223921c289e4b9116b9de09c316.png\" alt=\"1.png\" /登录成功后点击商城订单去商城随意下单，填写各种信息后，回到商城订单处，点击查看订单\n\n这里记住order_no的值：678440000054再注册一个账号，这里我注册的是root234 root234登录成功后，直接访问root123的订单链接：\nhttp://www.to8to.com/my/order_info.php?order_no=678440000054\n\n\n没有任何限制，没有任何限制可以直接访问成功，甚至还可以直接付款（当然帮别人付款的事一般不会有人做）\n\n为了研究订单规律，我又通过这两个账号随意下了一些订单，订单号如下：\n664842000005678440000054664845000005678480000054\n发现第一个和第三个很接近，第二个和第四个很接近，只是改了一位而已，为了多遍历一些订单，先只遍历三位数67xxx0000054\n\n成功的三位数payload\n483068  074  785  788  105   848   100  116  844  104   041  478  016  320  727  443  083 556 752\n\n\n\n\n\n\n再设计一下遍历的订单号:664xxx000005  ，通过同样的方式，遍历处三位payload\n115  042  842  830  815  099  467   207  489   782\n\n\n\n\n   漏洞证明：  rt   修复方案：  严格控制权限   版权声明：转载请注明来源 wps2015@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-08-03 15:03 厂商回复： 非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-03 15:31 |    \t\twps2015 \t\t\t( 普通白帽子  |\t\t\t        Rank:426 漏洞数:60        | 不叫一日荒废)\t\t \n  唉，每个都是小厂商。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}