{"id": 47316, "wybug_id": "wooyun-2014-087191", "wybug_title": "太平洋保险寿险行销支持系统敏感信息泄漏入手的检测", "wybug_corp": "太平洋保险", "wybug_author": "老周", "wybug_date": "2014-12-15 10:41", "wybug_open_date": "2015-01-29 10:42", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向公众公开  简要描述： 对该系统的检测主要从敏感信息泄漏入手，发现登录账户以及密码规则信息，登录系统进行的检测，主要发现问题如下：1.敏感信息泄漏2.任意文件下载3.越权操作4.储存型跨站 详细说明：  1.敏感信息泄漏在入手检测时，发现系统在登录过程中并没有对用户名以及密码错误信息进行有针对性的提示，从而无法通过系统提示来判断用户名或密码的输入是否正确。因此，只能通过其他方法进行尝试。首先，在对系统帮助文件的查看过程中，发现有这样的提示。\n\n在帮助文件的提示下，得知系统登录用户名为用户的工号，密码也是有规则的，下来就是收集员工相关信息的过程。在对网站系统的信息收集过程中，发现有这样的功能\n\n“营销员验真”功能，该功能可以查看集团中营销人员的相关信息，通过对功能的分析，发现能够收集到的信息远远要多于页面中展示的内容。\n\n在返回的数据包中，包括了员工的很多信息，如出生日期、家庭住址、入职时间、身份证号码等等。得到这些信息之后，加之帮助文件中的内容，提示密码信息为88888888或者P+身份证后7位，可以对其中的用户进行登录尝试。通过测试，得到很多员工的登录信息，本次测试只使用了两个账户。\n\n2.任意文件下载在对系统的下载功能检测过程中，发现该功能通过相对路径的方式下载系统中的文件，而数据包中的相对路径可以更改，这样，用户可以下载系统中的指定文件，但是由于权限的限制，下载权限只限制在根目录以下。\n\n3.越权操作系统中的越权操作有很多，这里就提一下任意用户手机号码修改的问题。在用户信息查看功能中，用户无法对其中的信息进行修改，但是在对源文件的查看中，发现，用户手机号码修改功能是被隐藏掉了。\n\n通过删除源文件中的隐藏标签，可以激活手机号码修改功能。\n\n在修改手机号码过程中，被修改目标的身份标识仅仅是依靠数据包中的用户ID，当用户修改该ID号时，用户就能对指定ID用户进行手机号码的更改。修改前信息\n\n数据提交过程\n\n修改后信息\n\n4.储存型跨站根据对系统的检测，储存型跨站可能会出现在留言以及其他可保存数据的功能中，出于不影响系统原始数据的原因，并未对业务相关的提交过程以及留言功能（留言信息无法删除）进行检测，本次储存型跨站检测点依然是刚才的手机号码修改功能。很简单，如下图\n\n\n\n\n\n   漏洞证明：  1.敏感信息泄漏\n\n\n\n\n\n2.任意文件下载\n\n3.越权操作修改前信息\n\n数据提交过程\n\n修改后信息\n\n4.储存型跨站\n\n   修复方案：  1.控制敏感信息2.优化字符过滤3.修改下载功能   版权声明：转载请注明来源 老周@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-12-17 09:26 厂商回复： 感谢指正，已修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-29 19:26 |    \t\ttodaro \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:12        | 完结。)\t\t \n  感觉你是做安全服务的。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}