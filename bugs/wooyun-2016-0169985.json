{"id": 85307, "wybug_id": "wooyun-2016-0169985", "wybug_title": "搜狗云测头像上传过滤不严导致任意文件上传可挂黑页", "wybug_corp": "搜狗", "wybug_author": "冰无漪", "wybug_date": "2016-01-18 16:09", "wybug_open_date": "2016-03-06 14:18", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["搜狗", "上传黑页"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-03-06：\t细节向公众公开  简要描述： 重要的事情要说三次：搜狗全体员工新年快乐！搜狗全体员工新年快乐！搜狗全体员工新年快乐！ 详细说明：  搜狗云测平台注册之后，上传头像处服务端过滤不严，通过抓包改文件后缀可上传任意格式文件虽然控制了执行权限，但是百密一疏！可以上传html文件，上传后html文件中的js代码也可执行，可以挂黑页哦！首先上传头像处抓包上传自己写的html页面http://mt.sogou.com/g2/M00/06/A6/CoZsllaXllqAJE9yAAAAppGzKZ070.html\n\nburp对中文内容没有完美显示，其实内容是这样的<html><body><script>alert('happy newyear')</script><h1>这不是一个黑页！</h1><h1>没错！这不是一个黑页！</h1><h1>搜狗的全体员工新年快乐！</h1></body></html>上传后得到url，直接拼接域名即可访问\n\n\n\n要是挂个黑页被老板看到，这年终奖还要吗？   漏洞证明：  \n\n\n\n   修复方案：  服务端判定上传文件后缀名，不允许上传图片意外后缀。如果条件允许，对图片进行二次渲染。   版权声明：转载请注明来源 冰无漪@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-01-21 19:21 厂商回复： 感谢支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}