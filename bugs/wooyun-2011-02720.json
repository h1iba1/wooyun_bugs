{"id": 22338, "wybug_id": "wooyun-2011-02720", "wybug_title": "PHPWIND最新版本SQL注入漏洞", "wybug_corp": "PHPwind", "wybug_author": "Ray", "wybug_date": "2011-08-26 13:40", "wybug_open_date": "2011-08-26 13:41", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核", "注射漏洞利用技巧", "漏洞分析技巧", "注射防御"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-08-26：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2011-08-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： phpwind在实现占位符SQL过程中，代码质量出现了一个小黑点。 详细说明：  在phpwind/lib/utility/querybuilder.class.php_parseStatement函数内在/phpwind/actions/ajax/leaveword.php的一个引用处Line 78行$db->update(pwQuery::buildClause(\"UPDATE :pw_table SET leaveword=\" . S::sqlEscape($atc_content) . \" $sqladd WHERE pid=:pid AND tid=:tid\", array($pw_posts, $pid, $tid)));没考虑$atc_content内可能会有占位符也没有考虑pid应该为数字，直接取了字符串Line：31S::gp(array('pid','atc_content','ifmsg'), 'P');导致SQL注入但是由于PW替换了等于号，替换了),无法导致非常严重的SQL注入漏洞。当提交pid=asd，atc_content为:pid的情况下提示Query Error: UPDATE pw_posts SET leaveword= ' 'asd' ' WHERE pid= 'asd' AND tid= ''    漏洞证明：  \n\n   修复方案：  你们可能全局忘记了替换:为HTML实体，这个也可以试试 ：）   版权声明：转载请注明来源 Ray@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：10 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2011-08-26 16:16 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个是真实的啊...    \n     2011-08-26 16:36 |    \t\tRay \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:7        )\t\t \n  嗯 绝无虚假 感谢你的回复  我眼泪好像都掉下来了几滴。    \n     2011-08-26 22:59 |    \t\tnull \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 左岸是无法忘却的回忆，右岸是值得把握的青...)\t\t \n  这么激动？    \n     2011-08-27 13:56 |    \t\tQQ852451559 \t\t\t( 实习白帽子  |\t\t\t        Rank:79 漏洞数:18        | 学生党)\t\t \n  继续挖掘哈..    \n     2011-08-31 10:02 |    \t\tphpwind(乌云厂商)\t\t \n  Hi all,关于此漏洞，并非我们未确认或者积极拒绝；这个漏洞在wooyun公布后，我们在第一时间就做出了响应，当天就已经修复并发布，同时我们在pw源代码和pw官方论坛都致以感谢，论坛信息参考：http://www.phpwind.net/read-htm-tid-1400034.html这里再次感谢Ray提交漏洞给阿里巴巴旗下的pw，感谢所有给阿里巴巴集团报过漏洞的安全人员，感谢所有关注阿里巴巴安全的人，谢谢你们的关注，鞭策着我们前行，我们一直在努力，致力于创造安全的阿里巴巴。同时也欢迎大家提交漏洞给阿里巴巴集团（阿里巴巴、淘宝、支付宝、cnzz，phpwind）的漏洞收集邮箱security@service.alibaba.com，将会得到精美小礼品一份：）由于wooyun最近无法访问，所以回复较晚，请见谅。    \n     2011-08-31 10:18 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  论坛上外部链接都没有.... 情何以堪    \n     2011-11-15 20:15 |    \t\tMujj \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:4        | IDC商)\t\t \n  奖励娃娃一个    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 10, "Ranks": null}