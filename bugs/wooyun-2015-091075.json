{"id": 40677, "wybug_id": "wooyun-2015-091075", "wybug_title": "CCF计算机职业资格认证系统存在低级上传漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-01-13 12:39", "wybug_open_date": "2015-02-27 12:40", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传内容未检查"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-27：\t细节向公众公开  简要描述： CCF计算机职业资格认证系统，用户可以通过上传网页木马，取得网站控制权进而获取和修改网站和数据库信息。 详细说明：  1.首先注册并登陆该系统（www.cspro.org）。然后进入“我的信息”——“考生个人信息”页面。(具体页面应该是：http://www.cspro.org/lead/leadbpm.do?__action=goto_iframe&path=CCF_KS_BMXX&djtype=TT)在考生简历部分有一个“上传附件”，点开，直接上传一个JSP马。\n\n2.之后点击保存。然后重新进入“考生个人信息”页面。点开刚才上传的JSP的链接。——竟然能访问！！！\n\n3.之前我做测试的时候，马是很稳定的，一直能访问到。后来可能有所察觉，大概是加了个扫描并删除JSP文件的机制。但是毕竟是传上去了，毕竟已经访问到了。之后，你有大概30秒的时间做你想做的工作。\n\n4.翻一翻网站的源文件，就能顺势拿下数据库。这个认证考试，考生是要交费的。虽然一大部分组团的考生有优惠（免费、100元/人），但是个人报名要多少钱呢？三百块！！！数据库拿到了sa权限，就能改成绩、改缴费状态、看考生个人信息等等……\n\n\n\n\n\n该服务器貌似是托管在阿里云上的。   漏洞证明：  没有下载其源代码。想想也知道根本没有对上传进行有效过滤，连基本的后缀名过滤也没有。   修复方案：  进行上传过滤。同时不要解析上传目录下的jsp文件。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-01-16 16:53 厂商回复： CNVD确认并复现所述情况，暂未建立与网站管理单位的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}