{"id": 61416, "wybug_id": "wooyun-2013-039571", "wybug_title": "新浪某分站上传html以及路径泄漏", "wybug_corp": "新浪", "wybug_author": "厦门佬", "wybug_date": "2013-10-14 17:19", "wybug_open_date": "2013-11-28 17:19", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-28：\t细节向公众公开  简要描述： 新浪某分站上传html以及路径泄漏，造成存储型xss 详细说明：  1.先来路径泄漏图片上传处推测应该是用白名单,只要把上传处的jpg文件用抓包改个后缀，我改成ashx,返回出错爆出网站路径非法文件格式{\"name\":\"\\u65b0\\u5efa\\u6587\\u672c\\u6587\\u6863.rar\",\"type\":\"application\\/octet-stream\",\"tmp_name\":\"\\/data2\\/www\\/userupload\\/phpbCiJ3b\",\"error\":0,\"size\":58}\n\n2.上传html先上传jpg图像，中途利用Charles抓包把后缀改成html能上传的上去。http://s3.guba.sina.com.cn/sina_guba/2013/10/13/image_201310130932331505797.html\n\n\n\n能上传html那xss也就没什么问题了，所以把他归结为存储型xssxss代码的构造也简单,就不班门弄斧了。测试了下 html txt均可上传.按照以往的评分 存储型应该为7rank + 一处路径泄漏 1rank =所以自评8rank   漏洞证明：     修复方案：     版权声明：转载请注明来源 厦门佬@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2013-10-14 17:31 厂商回复： 感谢关注新浪安全，马上安排人员修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}