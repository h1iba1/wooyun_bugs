{"id": 85567, "wybug_id": "wooyun-2016-0171577", "wybug_title": "上汽通用某站漏洞（涉及海量信息/大量顾客信息记录泄露/大量员工内部信息）", "wybug_corp": "上汽通用", "wybug_author": "路人甲", "wybug_date": "2016-01-22 11:25", "wybug_open_date": "2016-03-08 21:29", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-03-08：\t细节向公众公开  简要描述：  详细说明：  **.**.**.**:9080/DMSFrameworkWeb/  首先发现这样一个站点，判断不出，经过转发进入内网。找到目录，写了shell，期间ipconfig了下，发现dns是 **.**.**.**，访问了下主域名发现是上汽通用主站，配置了数据库，发现也是车辆以及车辆维修更换信息，经判断应该是上汽某工作站，域也有好几个。泄露了大量工单信息以及员工内部工作信息，数据过大，截取部分。不知道上汽通用和上汽大众是不是属于一个厂商，如果是请审核调整下，   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<name>jdbc/dsASMSSDE</name>  <jdbc-driver-params>    <url>jdbc:oracle:thin:@localhost:1521:dmsasc</url>    <driver-name>oracle.jdbc.xa.client.OracleXADataSource</driver-name>    <properties>      <property>        <name>user</name>        <value>owdmsasc</value>      </property>    </properties>    <password-encrypted>{AES}BPAYZgiSrVAc9IUov2OQQ+f3OHQH8s5F7jF+KSHyxbU=</password-encrypted> sgm_ap0m58_user  <name>jdbc/dsEWS</name>  <jdbc-driver-params>    <url>jdbc:oracle:thin:@localhost:1521:dmsasc</url>    <driver-name>oracle.jdbc.xa.client.OracleXADataSource</driver-name>    <properties>      <property>        <name>user</name>        <value>eservice</value>      </property>    </properties>    <password-encrypted>{AES}+6rCjolg3gQOg3Ov4v550de9pgaxHhGL8yAFGJpVu48=</password-encrypted> sgm_ap0m58_user\n数据库配置\nQuery#0 : select t.TABLE_NAME,t.NUM_ROWS from user_tables t order by NUM_ROWS descTABLE_NAMEVARCHAR2\tNUM_ROWSNUMBERTT_DELETE_LOG_HISTORY\t20076255TM_WR_CAMPAIGN_VINLIST\t17978639TT_CAMPAIGN_VEHICLE\t6234208WORKITEMHISTORY\t5009645TT_PART_MONTH_REPORT\t2061597TT_PART_PERIOD_REPORT\t2061597TT_PART_FLOW\t1854111TT_BALANCE_REPAIR_PARTS\t1753173TT_BALANCE_UNION_PARTS\t1481317TT_OPERATE_LOG\t1373097TT_REPAIR_ORDER_LINK\t1243373TT_BALANCE_LABOUR\t1168300TA_SMAP_CUST_CLASS_STAT\t1079657TT_CAMPAIGN_COMPLETEVEHICLE\t1007851TT_RO_ASSIGN\t887731TT_ESTIMATE_REPAIR_PARTS\t530731DE_DEMESSAGEIDMAP\t485852TT_PRODUCTIVE_VALUE\t438404TT_RO_BALANCED\t375679TT_BALANCE_ACCOUNTS\t375679TT_RO_CLAIM_MAPPING\t375338TA_SMAP_VEHICLE_BALANCE_DAILY\t352946TA_SMAP_VEHICLE_REPAIR_MONTH\t335454TT_DELETE_LOG\t305575TT_RECEIVE_MONEY\t292362TA_SMAP_VEHICLE_INFO\t276797TM_SGM_UPCFNA_PARTCODE\t269298TT_TRACING_TASK\t254044TT_ESTIMATE_LABOUR\t245759TT_PART_WAITORDER_LIST_DETAIL\t225230TT_DO_RECEIVE_ITEM\t205947TT_PART_SPQ_SHOW_DETAIL\t204888TT_PART_BUY_ITEM\t199611TT_TOOL_FLOW\t196431TT_ORDER_ITEM_RESULT\t186091TT_PART_ORDER_ITEM\t184127TT_BILLING_ITEM\t177892TT_NO_REPORT_ORDER_ITEM\t177517TT_GWM_STATUS\t174275TM_GWM_PRE_WRT_VINLIST\t171151TM_MAIN_PART\t160668DE_ASCRECEIVELOG\t158116TM_CLAIM_LABOUR_HOUR_DATA\t132465DE_ASCSENDSUBLOG\t111241DE_ASCSENDLOG\t108752TT_TOOL_RETURN_ITEM\t97614TT_TOOL_BORROW_ITEM\t97599TT_CLAIM_ORDER\t91573TT_TOOL_BORROW\t81741TT_TOOL_RETURN\t80482TT_CLAIM_PART\t73659TT_CHARGE_DERATE\t70075TM_SPECIAL_SP_LOG\t68695TT_SGM_WR_APPPAYMENT\t55735TA_SMAP_SERVICE_ANALYSIS\t54720TT_ESTIMATE_ORDER\t52866TT_CLAIM_RO_ITEM_MAPPING\t51179TM_OWNER\t50247TM_VEHICLE\t46683TM_PLANT_VEHICLE\t45485TM_REPAIR_ITEM\t41082TT_GWM_RESULT\t39529TM_SGM_UPCFNA_LABOR\t39277TT_SGM_RETURN\t35667TM_SGM_UPCFNA_INFO\t35377TT_PART_PERIOD_REPORT_TMP\t35012TM_VEHICLE_SGM\t32444TM_GWM_WARRANTYCLASS_BY_LABOR\t31959TT_PART_INNER_ITEM\t30424TT_BOOKING_ORDER_ITEM\t28250TM_PART_STOCK\t27143TT_ALLOCATE_OUT_ITEM\t26468TT_BALANCE_REPAIR_PARTS_3R\t24598TT_INSURANCE_FLOW\t22974TT_TERMLY_MAINTAIN\t22641TT_PART_FLOW_3R\t22640TT_NEW_IN_CAR\t22572TT_PART_BUY\t22131TT_CLAIM_MONTH_REPORT\t21453TT_BALANCE_UNION_PARTS_3R\t21254TM_CLAIM_LABOUR\t20722TT_SPQ_EXCEPTION_MESSAGE\t20695TT_BALANCE_LABOUR_3R\t19075TT_GWM_STATUS_3R\t18772TT_INVOICE\t18269TT_PART_PERIOD_REPORT_BAK\t17495TT_CLAIM_OTHER_CHARGE\t17471TT_PRE_RECEIVE_MONEY\t17222TT_CLAIM_PART_PRINT\t15753TT_GWM_RESULT_DSP_REASON\t15261TM_CLAIM_ADD_LABOUR_HOUR\t15136TA_SMAP_BUICK_CUST_STAT\t13680TA_SMAP_LOST_CUST_ANALYSIS\t13680TT_RO_ASSIGN_3R\t13598TT_BALANCE_ADD_ITEM\t13438TA_SMAP_BUICK_CUST_STATOEM\t13260TT_SHORT_PART\t12970TT_PART_INNER\t12945TT_TRACING_TASK_QUESTION\t11648TT_CLAIM_PART_RTN_ITEM\t11503TT_BOOKING_ORDER\t10741TT_PRODUCTIVE_VALUE_3R\t10498TT_RESERVED_CHANGE\t10414TT_BILLING\t9563TT_DO_RECEIVE\t9554TM_ASC_PT_SP_PART_LIST\t9369TT_PART_INVENTORY_ITEM\t8861TT_INSURANCE_EXPIRE\t7816TT_CAMPAIGN_FINISH_VEHICLE\t7801TT_BOOKING_PROMPT\t7619TT_MONITOR_VEHICLE\t7229TT_CLAIM_ORDER_3R\t7222TT_PART_ALLOCATE_OUT\t6902TT_BOOKING_ORDER_REMIND\t6682TT_VEHICLE_BLOCK\t6603TL_CLAP_BPOINT_CHANGE_LOG\t6459TT_RO_BALANCED_3R\t6120TT_BALANCE_ACCOUNTS_3R\t6120TT_BALANCE_ACCOUNTS_EXT\t6034TA_ASC_MONTHLY_REPORT_MODEL\t5554TI_PART_STOCK\t5413TT_SGM_WR_LABOROP_MAP_FVS\t5130TI_OWNER_VEHICLE\t5057TT_PART_ALLOCATE_ITEM\t4923TT_ORDER_RESULT\t4914TT_CLAIM_PART_3R\t4892TT_PART_ORDER\t4383TM_REPAIR_ITEM_MAIN\t4365TT_ASC_STAGNANT_INVENTORY\t4065TT_DS_ASC_SCANNERLOG\t4012TT_GWM_RESULT_3R\t3981TT_TRACING_DAY\t3894TT_USER_FUNCTION\t3861TT_NO_REPORT_ORDER\t3614TM_WR_CAMPAIGN_VINRULE\t3602TT_REMIND_PLAN\t3551TT_PART_SUGGEST_PART_DETAIL\t3426TM_CLAIM_NO_RETURN\t3183TT_SGM_RETURN_3R\t3052TA_SMAP_INCOME_ANALYSIS\t2950TA_SMAP_MONTH_RPT_SERIES\t2904TA_SMAP_CUST_INSTORE_ANALYSIS\t2904TM_CLAP_MEMBER_CONTACTOR\t2900TA_SMAP_STAT_SERIES\t2882TM_CLAP_MEMBER_VEHICLE\t2862TM_CLAP_MEMBER_CARD\t2855TM_CLAP_VEHICLE_OWNER\t2855TM_CLAP_MEMBER\t2855DE_MESSAGE_LOG\t2753TT_SGM_WR_CLAIMCORRECT\t2732TT_PART_ALLOCATE_IN\t2606TT_REJECT_HISTORY\t2440TT_BILL_NO\t2363TT_SGM_WR_WITHOUTREF\t2337TT_ESTIMATE_ADD_ITEM\t2204TT_PART_AB_TYPE\t2010TT_PART_TRACE_FLOW_ITEM\t1962TT_SGM_WR_WCCREFRECORD\t1951TM_MAIN_PART_INTERFACE\t1938TM_OTHER_LABOUR_HOUR\t1935TT_PART_PROFIT_ITEM\t1843TT_PART_TRACE_FLOW\t1831TT_BALANCE_SALE_PART\t1752TT_PART_MOVE_ITEM\t1639TT_WAITORDER_PART_DRAFT\t1549TM_PART_MONITOR\t1443TT_BALANCE_ADD_ITEM_3R\t1435TT_RO_REPAIR_PARTS\t1380TT_SGM_WR_3R_BASE\t1271TM_COMMON_DATA\t1233TM_GWM_3C_RELATION\t1232TM_PART_TIME\t1196TT_PART_BILL_NO\t1180TT_PART_LOSS_ITEM\t1173TM_ORDERDATE_SET\t1153TM_TOOL_STOCK\t1152TT_REPORT_ORDER_COUNT\t1150TT_TOOL_BUY_ITEM\t1135TT_CLAIM_PART_RTN_ITEM_3R\t1078DE_TASKSCHEDULERULETARGET\t1016TT_CLAIM_OTHER_CHARGE_3R\t861TT_SGM_WR_UNWARRANTYPART\t838TM_PART_PAINT\t830TT_PART_ORDER_CONDITION\t813TA_SMAP_MONTH_RPT_VHCLAGE\t792TT_SGM_WR_CASELABOUR\t744DE_ASCSENDLOGCOUNT\t723TT_PART_SUGGEST_PART\t694TM_SYSTEM_STATUS\t677TT_RO_LABOUR\t636TT_PO_DELAY_CANCEL_ITEM\t622TT_ROLE_FUNCTION_MAPPING\t618TT_USER_OPTION_MAPPING\t584TT_CHARGE_DERATE_3R\t570TT_SGM_WR_REPAIRLOCATION\t568TT_TRACING_WEEK\t563TT_USER_HISTORY\t535TT_PT_BONUS_USED\t531TA_SMAP_MONTH_RPT_REPAIR\t528TA_SMAP_TASK_HISTORY\t512TT_CLAIM_MONTH_REPORT_3R\t490TM_ATTACHMENT_PART\t459WORKITEM\t440TT_DS_ASC_TABLELIST\t425TT_PO_DELAY_CANCEL\t400TT_ORDINARY_CLAIM_COLLECT\t399TT_CAMPAIGN\t391TT_PRE_DEDUCT\t380TM_SPECIAL_SQL\t373TM_SPECIAL_PARTS\t367TM_GWM_PRE_WRT_RULE\t353TM_WR_CAMPAIGN_PART\t349TM_FUNCTION\t348TM_WR_CAMPAIGN\t339TT_PART_FAST_FLOW\t332TL_DA_OPER_LOG\t321TM_PAINT_SUPPLIER_MAPPING\t312TT_BOOKING_ORDER_PARTS\t309TT_RO_PRE_CLAIM\t303TM_PACKAGE_PART\t300TM_SPECIAL_LABORCODE\t300TT_PART_MOVE\t290TT_CLAIM_PART_URGENT_RTN\t279TT_PART_CLAIM_ITEM\t276TT_VEHICLE_ALARM_REMIND\t273TT_PART_CLAIM\t272TA_SMAP_MONTH_RPT_VHCLTYPE\t264TM_CMG_MY_MAPPING\t248TT_PART_COST_ADJUST\t243TM_EMPLOYEE\t234TM_PART_CUSTOMER\t233TT_PART_CLAIM_REPARATIONS\t228TT_PART_CLAIM_RETURN_ITEM\t225TT_PART_RETURN_INFORM\t223TT_PRE_CLAIM_ORDER\t220TM_SPECIAL_TABLES\t217COPY_TM_EMPLOYEE\t216TT_PART_CLAIM_BILLING_ITEM\t214TT_PART_CLAIM_BILLING\t211TM_WR_CAMPAIGN_REPLACE_PART\t208TM_ASC_INFO\t204TT_CLAIM_ADD_LABOUR\t202TT_BILLING_SUB_ITEM\t201TT_ESTIMATE_SALE_PARTS\t200TA_ASC_MONTHLY_FINANCE\t192TT_REPAIR_ORDER\t191TT_CAMPAIGN_ITEM\t190TT_RO_PRE_CLAIM_STATUS\t188TT_ASC_DATASTORE_ERRLOG\t176TM_GWM_AD_REASON_CODES\t170DE_APPTYPE\t168TT_SGM_WR_BACKREFERENCE\t150TT_PART_LEND_RETURN_ITEM\t137TM_ACCOUNTING_CYCLE\t136TT_CAMPAIGN_RECALLCODE\t136TT_PART_LEND_ITEM\t136TM_MODEL\t135TA_SMAP_CUST_INSURANCE_STAT\t132TA_SMAP_BUICK_MONTH_RPT_STAT\t132TA_SMAP_BOOKING_STAT\t132TM_GWM_CAUSE\t131TT_MONTH_CYCLE\t131TM_GWM_PRE_WRT_VINRULE\t126TT_TOOL_BUY\t125TT_SO_PROJECT\t123TT_GWM_RESULT_ADJ_REASON\t121TM_CLAIM_MODEL_SMC\t120TT_SO_PRE_CLAIM_NEW\t120TM_ASC_MONTHLY_REPORT\t112TT_PART_CLAIM_DISCOUNT\t112TA_ASC_NEW_MONTHLY_REPORT\t110TT_PART_WAITORDER_LIST\t106TT_ORDINARY_CLAIM_INVOICE\t105\n\n**.**.**.**:9080/DMSFrameworkWeb/jsp/123.jsp carry\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-01-26 08:27 厂商回复： 维修站管理的服务器漏洞，已通知并制定修复计划 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}