{"id": 6233, "wybug_id": "wooyun-2013-046053", "wybug_title": "天涯某处OAuth认证缺陷可劫持oauth_token", "wybug_corp": "天涯社区", "wybug_author": "超威蓝猫", "wybug_date": "2013-12-20 16:21", "wybug_open_date": "2014-02-03 16:22", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-03：\t细节向公众公开  简要描述： 天涯某处OAuth认证缺陷可劫持oauth_token 详细说明：  这是通过天涯帐号登录\"微博通\"应用的授权页面:\nhttp://open.tianya.cn/oauth/authorize.php?oauth_token=e65d28ab0862cbd517c67c3cc6f2247e052ad9c22&oauth_callback=http%3A%2F%2Fm.wbto.cn%3A80%2F%3Fc%3Dm_setting%26m%3Dauth%26b%3Dcallback%26pid%3D24%26aid%3D%26wbto%3D1658628_953c148f2d%26oauth_token%3De65d28ab0862cbd517c67c3cc6f2247e052ad9c22%26oauth_token_secret%3D2fde10390cd1a2477abaa3dcd44e4b99\n其中，oauth_callback没有与应用的oauth_token进行绑定，没有对可用性进行校验，可以修改为任意地址。   漏洞证明：  这里我们把oauth_callback的值改为wooyun.org，并没有提示uri非法\n\n登录并授权，跳转到了指定的地址，用户的oauth_token泄漏。\n\n危害:可以构造一个恶意网页来记录、劫持用户的token，从而控制用户的账号。   修复方案：  请遵循OAuth协议规范，将应用的oauth_token与oauth_callback绑定，对oauth_callback进行有效性校验。   版权声明：转载请注明来源 超威蓝猫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-12-20 16:42 厂商回复： 感谢提供，正在联系相关负责人修复。 :) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}