{"id": 50899, "wybug_id": "wooyun-2014-076435", "wybug_title": "试客联盟后台任意账户登录", "wybug_corp": "shikee.com", "wybug_author": "Grayon", "wybug_date": "2014-09-18 14:16", "wybug_open_date": "2014-11-02 14:18", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-02：\t细节向公众公开  简要描述： 试客联盟后台管理系统任意账户登录。 详细说明：  发现新厂商 试客联盟稍微百度一下，发现一个对外的客户管理系统\n\nhttp://kh.shikee.com/打开出现登录界面\n\n看到是天生创想的OA办公系统去百度了一下这个oa系统，找到了官方站点\n\n试一下演示系统\n\n用测试账号登陆\n\n看了下cookie\n\n发现出现了一个toa_auth值为MgkwNzFkMGIyNWQ4ZDk4NTExOTY5ZWJlZDNiNDM4YTc2OA%3D%3D看到%3D%3D马上想到了==这样一看就是base64加密的感觉MgkwNzFkMGIyNWQ4ZDk4NTExOTY5ZWJlZDNiNDM4YTc2OA==拿去解密试试\n\n看到数字2就觉得是用户id，后面的像md5加密的不知道是什么，可能是类似时间戳的东西把数字改成1再加密MQkwNzFkMGIyNWQ4ZDk4NTExOTY5ZWJlZDNiNDM4YTc2OA==改cookie刷新一下再看\n\n直接变成管理员了！！！如果没有删除install文件夹可以利用任意文件下载配置文件，任意文件删除，然后重装系统在配置文件写shell WooYun: 天生创想OA办公系统漏洞大礼包(xss,csrf,下载,删除,写shell) 现在回到试客联盟直接在cookie里添加toa_auth=MQkwNzFkMGIyNWQ4ZDk4NTExOTY5ZWJlZDNiNDM4YTc2OA%3D%3D\n\n直接进入管理界面\n\n\n\n\n\n\n\n   漏洞证明：  \n\n\n\n\n\n\n\n   修复方案：  管理系统不对外找售后PS：听说会有小礼物：）   版权声明：转载请注明来源 Grayon@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-09-22 11:34 厂商回复： 此系统确实存在此漏洞，感谢提醒:) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}