{"id": 15425, "wybug_id": "wooyun-2012-016359", "wybug_title": "四川省宗教事务局官网源码泄漏及权限绕过", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "O.o", "wybug_date": "2012-12-25 10:32", "wybug_open_date": "2012-12-30 10:33", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "11", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "越权操作", "未授权访问", "用户敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 四川省宗教事务局官网源码泄漏及管理权限绕过漏洞，宗教局个人觉得比较敏感，万一在上面搞个xxxx教xxxxxxx然后xxxxx然后xxxx了然后···就木有然后了。 详细说明：  1.源码泄漏。http://www.scszjj.gov.cn/wwwroot.rar不解释。带数据库。2.通过下载的源码中的数据库进行查询。获取到密码的MD5值。通过查询。等待一周后，失败了。\n\n于是。花了点时间看代码1.=.=后台权限检查使用了cookie。显然。Cookie伪造很容易ydadmin\\permit.asp\n<%Call PermisstionUserCode(0)Function PermisstionUserCode(Num)\tIsperssion=false\t'PList=Split(session(\"role\"),\",\",-1,1)\tPList=Split(request.Cookies(\"role\"),\",\",-1,1)\tFor I=0 To UBound(PList)\t  if Num=int(PList(i)) then\t\tIsperssion=true\t  end if\tNext\tif Isperssion=false then        Response.Write(\"<script>alert(\"\"<操作失败>\\n您的权限不足！\"\");window.history.back();</script>\")\t\tResponse.end()\tend ifend function%>\nydadmin\\check.asp\n<%  if Request.Cookies(\"username\")=\"\" then\t  response.write\"连接超时或未登陆！<a href=../default.asp target=_parent>重新登陆</a>！\"\t  response.end  end if%>\n根据ydadmin\\left.asp中的源码获取各个功能对应权限的设置。既然有了权限。后台发xxxxx然后xxxxx然后。。。就木有然后了。   漏洞证明：  设置cookie\n\n\n\n打开windos.asp\n\n\n\n\n\nOVER   修复方案：  session。删不需要的东西。   版权声明：转载请注明来源 O.o@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-12-30 10:33 厂商回复：  最新状态： 2012-12-30：先致个歉，由于近日工作安排关系，CNVD未及时确认，该漏洞事件已经在27日转由CNCERT四川分中心协调涉事单位处置。建议补上rank 10  ", "replys": "漏洞评价：\n评论\n     2012-12-31 09:38 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  @O.o 与时俱进啊    \n     2012-12-31 10:08 |    \t\tO.o \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:12        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  @凤凰 这·····    \n     2013-01-04 10:26 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @O.o 。。貌似没有给补rank哦。。    \n     2013-01-04 17:33 |    \t\tO.o \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:12        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  @px1624 我也觉得=。=继续等等=。=    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}