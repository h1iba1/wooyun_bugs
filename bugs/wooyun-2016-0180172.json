{"id": 87418, "wybug_id": "wooyun-2016-0180172", "wybug_title": "海康威视某备份系统通用型SQL注入(两处无需登录)                                      ", "wybug_corp": "海康威视", "wybug_author": "YY-2012", "wybug_date": "2016-03-02 21:44", "wybug_open_date": "2016-06-04 10:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-03-09：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-04-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-04：\t细节向公众公开  简要描述： rt 详细说明：  /data/fetchPlanStatus.php\n<?php\tinclude('../common/connDb.php');\t$dbQuery = new DataBaseQuery();\t$page=$_POST['page']; \t$rows=$_POST['rows'];\t$guid=$_POST['guid'];\t$start=($page -1)*$rows;\t$result = $dbQuery->query('select * from planinfo where rule_guid=\"'.$guid.'\" order by update_time desc limit '.$start.','.$rows);\t$count = $dbQuery->querySingle('select count(*) from planinfo where rule_guid=\"'.$guid.'\"');\t$jsonStr =\"\";\twhile ($row = $dbQuery->fetchArray($result)){\t\t$row['status']= get_plan_status_name($row['status']);\t\t$jsonStr = $jsonStr.json_encode($row).\",\";\t}\tif($jsonStr !=\"\"){\t\t$jsonStr = substr($jsonStr,0,strlen($jsonStr)-1);\t}\t$str ='{\"total\":'.$count.',\"rows\":['.$jsonStr.']}';\t$dbQuery->closeDb();\techo ($str);\tfunction get_plan_status_name($plan_status){\n/data/fetchBackupPlan.php\n<?php\t\t\tinclude('../common/connDb.php');\t\t$dbQuery = new DataBaseQuery();\t\t$page=$_POST['page']; \t\t$rows=$_POST['rows'];\t\t$sort=$_POST['sort'];\t\t$order=$_POST['order'];\t\t\t$start=($page -1)*$rows;\t\t$re = $dbQuery->query('select guid,description,plan_type,device_type,server_ip,device_ip,channel_id,channel_no,update_time,\"\" statusName from planrule limit '.$start.','.$rows);\t\t$count = $dbQuery->querySingle('select count(*) from planrule');\t\t$jsonStr =\"\";\t\twhile ($row = $dbQuery->fetchArray($re)){\t\t\t//$row['statusName']=get_plan_status($row['guid'],$dbQuery);\t\t\t$jsonStr = $jsonStr.json_encode($row).\",\";\t\t}\t\tif($jsonStr !=\"\"){\t\t\t$jsonStr = substr($jsonStr,0,strlen($jsonStr)-1);\t\t}\t\t$str ='{\"total\":'.$count.',\"rows\":['.$jsonStr.']}';\t\t$dbQuery->closeDb();\t\techo ($str);\t\tfunction get_plan_status($guid,$dbQuery){\t\t\t$result = $dbQuery->query('select * from planinfo where rule_guid=\"'.$guid.'\" order by begin_time asc');\n   漏洞证明：  \n\n\n\n影响众多监控服务器了，随便20个案例：\n**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/http://**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/\n   修复方案：  过滤   版权声明：转载请注明来源 YY-2012@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2016-03-06 10:07 厂商回复： 您好，该问题属于与WooYun-2016-重复问题，该产品线目前已停产，已使用java架构取代php架构。我们会通过各种渠道对使用旧版本的客户平台进行加固升级。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}