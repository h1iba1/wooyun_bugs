{"id": 11662, "wybug_id": "wooyun-2013-024307", "wybug_title": "安全宝sql注入可被绕过", "wybug_corp": "安全宝", "wybug_author": "在路上", "wybug_date": "2013-05-23 01:04", "wybug_open_date": "2013-07-07 01:05", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-07：\t细节向公众公开  简要描述： 安全宝的sql注入可被绕过 详细说明：  今天一个朋友给我发一个连接，http://secaqb.anquanbao.org/sqlin.php?id=9 问我有没有注入，闲着无聊就试试，http://secaqb.anquanbao.org/sqlin.php?id=9'\n\n简单看一下，额这是什么东西 没有见过呀，朋友说是waf,好高端的样子，百度wafhttp://zhidao.baidu.com/question/437176497.html 原来这个是waf,那就是说web前面多了牛叉的东西防止注入了吧。继续搞不信这么安全。php的 应该是mysql吧，试试http://secaqb.anquanbao.org/sqlin.php?id=9 or 1=1额 还不行 又出来拦截了。http://secaqb.anquanbao.org/sqlin.php?id=9 or 1>1额 考虑的挺全呀，这个也考虑了呀http://secaqb.anquanbao.org/sqlin.php?id=9 or(1)in(1)额 这个不拦了 结果是正确的\n\nhttp://secaqb.anquanbao.org/sqlin.php?id=-9%20or(-1)in(1)在试一下这个\n\n没有结果确实是一个注入点。给朋友反馈说是注入，没想到这家伙贪得无厌，还让我查数据，说这个不过瘾。那就继续吧，union select才能查询数据吧 那就试试。http://secaqb.anquanbao.org/sqlin.php?id=-9%20union不拦 可以用union http://secaqb.anquanbao.org/sqlin.php?id=-9%20union%20select大喜 这个也不拦悲剧刚刚开始，在select后面添加字符就拦了 不知道怎么搞了，想来想去，这是怎么回事呢朋友说，这个是因为它使用正则进行匹配了，遇到union select就可能给拦截了 正则大概就是union\\sselect,正则就是希望呀，正则是精确匹配，稍微有点不同就完蛋了。哈哈，上特殊字符直接就绕过正则了，经测试终于搞定了，构造语句如下:http://secaqb.anquanbao.org/sqlin.php?id=-9%20union%0bselect%0b1,user(),version(),database()\n\n就这样了没有什么意思，发给朋友交差了。后话:后来得知这个是安全宝的防护设备，因此上来偏点rank 想弄本书，希望能得逞。   漏洞证明：  \n\n   修复方案：  修复这个我也不是很懂但是其实搞一个通用防护还是挺不容易的，有点疏忽也是正常的哈哈，都这么说了不知道有没有rank。   版权声明：转载请注明来源 在路上@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2013-05-27 12:04 厂商回复： 您好，这个问题在{安全宝waf绕过反馈得大礼}活动中已经被反馈过，正在修复中，非常感谢您对安全宝的支持，waf绕过需要反馈到security@anquanbao.com 这个邮箱才能参加这个活动，也欢迎更多的白帽子向我们反馈安全问题 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-23 02:27 |    \t\t小智 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:5        | 低调低调，学习学习~)\t\t \n  这个不是好像报道过？在某个网站？好像是构造uft-7？    \n     2013-05-23 07:17 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  @小智 @xsser 乌云又没有说非要原创呀，@疯狗 为啥另一个不给通过    \n     2013-05-23 09:43 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:67        | 活到老，学到老!)\t\t \n  不是原创？ 岂不是我随便找个人家发出的粘贴来就中~ 版权呢？    \n     2013-05-23 11:19 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  @小威 目测是原创 等公开开了如果有问题就给差评吧    \n     2013-05-23 12:00 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:64        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  @小威 威B 以后有洞我来帮你发 哈哈    \n     2013-05-23 14:42 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:67        | 活到老，学到老!)\t\t \n  @孤独雪狼  我次奥~~    \n     2013-05-23 20:25 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  其实是与不是都不重要嘛 最主要的是看完能有所收获嘛 当然我这个比较菜 也没有写明白 呵呵 sorry    \n     2013-07-11 15:28 |    \t\tw5r2 \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:48        )\t\t \n  GBD安全宝    \n     2014-09-30 08:46 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:58        | going)\t\t \n  good job    \n     2015-03-20 01:04 |    \t\tWinck \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | http://weibo.com/hackwinck hackwinck  By...)\t\t \n  @在路上 求QQ   求技术  求神器  求交流   719811394    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}