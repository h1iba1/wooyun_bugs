{"id": 58783, "wybug_id": "wooyun-2014-049660", "wybug_title": "CSDN博客管理CSRF漏洞", "wybug_corp": "CSDN开发者社区", "wybug_author": "wusuopubupt", "wybug_date": "2014-01-23 18:59", "wybug_open_date": "2014-03-09 18:59", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-09：\t细节向公众公开  简要描述：  详细说明：  删除文章url完全暴露给其他用户，都是这种形式：\nhttp://write.blog.csdn.net/postlist?t=del&id=这里就是文章的Id\n，所以完全可以伪造出删除文章的url；删除造作也没有加token,这样就形成了一个典型的CSRF漏洞。正常情况下，CSDN博主删除自己的文章，会弹出对话框确认是否删除，但是，如果我们删除文章的url，并伪装成一张图片来篇用户点击，那么，用户的文章就会在没有有任何对话框弹出的情况下被删掉。下面是CSRF攻击的整个过程（我用2个用户A, B模拟）1.首先看A用户发表了一篇文章：http://blog.csdn.net/u013546030/article/details/18705767\n\n2.然后我用用户B的身份去访问这篇文章(注意这时并不能看见删除文章的链接):\n\n3.但是，我们可以“猜”出这个删除文章的URL:CSDN博客删除文章的链接一般形式是这样的：\nhttp://write.blog.csdn.net/postlist?t=del&id=这里就是文章的Id\n4.用户B发表一篇博客，里面先传一张图片\n\n然后给图片加一个url,这个url就是上面猜解出来的删除文章的url:\n\n注意现在图片上的链接已经是我们猜出的删除文章的链接了：\n\n5.让用户A访问用户B的这篇文章，并点击图片：\n\n6.用户A访问用户B，并点击用户B博客里的图片后，用户A的那篇文章就偷偷地被删掉了~   漏洞证明：  用户A点击用户B博客里的图片后，再去看这篇文章：http://blog.csdn.net/u013546030/article/details/18705767发现已经没有了：\n\n注：后面这里可以用img标签或者其他随便标签随便构造个get请求即可   修复方案：  你们比我懂！   版权声明：转载请注明来源 wusuopubupt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2014-01-23 22:20 厂商回复： 尽快修复。 最新状态： 2014-03-04：已修复，多谢！  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}