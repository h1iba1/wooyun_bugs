{"id": 44660, "wybug_id": "wooyun-2015-0128695", "wybug_title": "中国人民保险用户任意密码重置漏洞", "wybug_corp": "中国人民保险", "wybug_author": "0x 80", "wybug_date": "2015-07-23 16:45", "wybug_open_date": "2015-09-11 08:36", "wybug_type": "应用配置错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["错误信息未屏蔽", "配置错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-11：\t细节向公众公开  简要描述： 中国人民保险用户任意密码重置漏洞 详细说明：  http://www.epicc.com.cn/ecenter/views/ecenterClub/loginRegisterNew/login.jsp思路我慢慢来说我先随便重置一个，如admin他是1个查询用户的原理，如果用户存在，那么就会显示看看代码：\n</div>                <div class=\"account\">                    <p>账号<label style=\"font-size:12px;color:gray;\">(用户名/已验证邮箱/已验证手机号)</label></p>                    <input type=\"text\"  class=\"name\" tabindex=\"1\" value=\"用户名/已验证邮箱/已验证手机号\" maxlength=\"60\"  id=\"entryId\" name=\"entryId\" onfocus=\"if(this.value=='用户名/已验证邮箱/已验证手机号') this.value='';\" onblur=\"if(this.value=='') this.value='用户名/已验证邮箱/已验证手机号';\" />                    <div class=\"loginForEmailSearch\" style=\"background:#fff; filter:alpha(opacity=90); -moz-opacity:0.9;  -khtml-opacity: 0.9;  opacity: 0.9; position:absolute; z-index:999; \">                \t\t<ul class=\"on_changes\" style=\"display:none\">\t\t\t\t\t\t\t<li emailForLogin=\"\">请选择邮箱类型</li>\t\t\t\t\t\t\t<li emailForLogin=\"@163.com\"></li>\t\t\t\t\t\t\t<li emailForLogin=\"@126.com\"></li>\t\t\t\t\t\t\t<li emailForLogin=\"@139.com\"></li>\t\t\t\t\t\t\t<li emailForLogin=\"@189.cn\"></li>\t\t\t\t\t\t\t<li emailForLogin=\"@qq.com\"></li>\t\t\t\t\t\t\t<li emailForLogin=\"@vip.sina.com\"></li>\t\t\t\t\t\t\t<li emailForLogin=\"@sina.cn\"></li>\t\t\t\t\t\t\t<li emailForLogin=\"@sina.com\"></li>\t\t\t\t\t\t\t<li emailForLogin=\"@sohu.com\"></li>\t\t\t\t\t\t\t<li emailForLogin=\"@hotmail.com\"></li>\t\t\t\t\t\t\t<li emailForLogin=\"@gmail.com\"></li>\t\t\t\t\t\t\t<li emailForLogin=\"@wo.com.cn\"></li>\t\t\t\t\t\t\t<li emailForLogin=\"@21cn.com\" id=\"theLastLi\"></li>\t\t\t\t\t\t</ul>\t\t\t\t\t</div>                </div>       \t\t            </div>\n这么多格式的账号我先输入admin点忘记密码http://www.epicc.com.cn/ecenter/views/ecenterClub/loginRegisterNew/findPwdFirst.jsp\n\n\n\n这里也出现缺陷了用户名和手机都泄露了\n\n我们要利用邮箱验证方式开burp，代理抓包\n\n这时候，重新发送这，点击时截包\n\n修改email=zhoubin@163.com为自己的邮箱我就修改成我自己的~~然后点下GO发到repeator功能修改下\n\n然后GO\n\n这时候会收到重置密码的邮件\n\n接着，我们看看\n\nhttp://www.epicc.com.cn/ecenter/ecenterClub/loginRegisterNew/passwordFind/validLink?entryId=d4b413a70e83f19e&email=0419e7160ac6e9140e36ee91c8e906c63eabddd3a4f87073&rand=862f19a4cde963c2\n\n这时候可以重置密码了重置为7788250\n\n\n\n这时候问题来了，500错误原因是什么呢？分析下因为不是主人，呵呵而且一次POST请求，他的CODE都是不同的，我们思路是先找回抓包接着，修改地址，给自己发邮件接着，重置密码处再抓包修改回原主人的邮件，即可我们试试重新来~~~·老规矩~~\n\n修改为自己的邮件，然后GO\n\n然后接收激活重置的邮件\n\n打开\n\n重点来了~~我们点下重置http://www.epicc.com.cn/ecenter/ecenterClub/loginRegisterNew/passwordFind/validLink?entryId=d4b413a70e83f19e&email=0419e7160ac6e9140e36ee91c8e906c63eabddd3a4f87073&rand=f04cdc8f7c416612\n\n就改为7788250吧，老规矩，这里需要在修改密码处再次抓包\n\n\n\n我们需要把主人换回来还记得主人的邮箱把~~没错，就是他：zhoubin@163.com改回主人\n\n接着ON下\n\n接下来，admin  7788250登陆看看\n\n成功了\n\n\n\n===============================================================再来改个http://www.epicc.com.cn/ecenter/views/ecenterClub/loginRegisterNew/findPwdFirst.jsp改test\n\n\n\n老规矩sdfs@sdf.com记住主人的邮箱\n\n抓包\n\n修改\n\n接着，激活邮件来了\n\n打开\n\n\n\n老规矩更改时抓包还是7788250吧\n\n修改原主人邮箱sdfs@sdf.com\n\n接着ON下\n\ntest 7788250登陆看看\n\nOK了~~   漏洞证明：  \n\n   修复方案：  二次验证做一些过滤！   版权声明：转载请注明来源 0x 80@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-07-28 08:35 厂商回复：  CNVD确认并复现所述情况，已经转由CNCERT向中国人保公司通报，对方已经收悉并已及时跟进处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-23 16:51 |    \t\t黑翼、 \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:10        | o(∩_∩)o)\t\t \n  叼    \n     2015-07-23 16:58 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:544 漏洞数:103        | 低调求发展)\t\t \n  屌    \n     2015-07-23 17:01 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  吊    \n     2015-07-23 17:03 |    \t\tLooke \t\t\t( 普通白帽子  |\t\t\t        Rank:619 漏洞数:38        | 可顺势而为，何必逆水行舟)\t\t \n  刁    \n     2015-07-23 17:05 |    \t\t泪雨无魂 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:21        )\t\t \n  吊    \n     2015-07-23 17:22 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:55        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  铞    \n     2015-07-23 20:09 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:125        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  狗哥都来了！屌！    \n     2015-07-23 20:10 |    \t\t0x 80 \t\t\t( 普通白帽子  |\t\t\t        Rank:1301 漏洞数:373        | 某安全公司招聘系统运维、渗透测试、安全运...)\t\t \n  @DloveJ 你也来了，更吊    \n     2015-07-23 20:34 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:125        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  @0x 80 -_-||    \n     2015-09-11 09:40 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  这个算是越权了的    \n     2015-09-11 16:02 |    \t\t眯眯眼 \t\t\t( 普通白帽子  |\t\t\t        Rank:304 漏洞数:10        | 精华漏洞数:22 | WooYun认证√ 漏洞审核员)\t\t \n  so ga    \n     2015-09-12 13:09 |    \t\tMowen \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 没个性，不签名！)\t\t \n  厂商给评论的是15个wb,为什么实际收到的却不是这个，我的评价是9个，实际才2个    \n     2015-09-12 13:17 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  @Mowen 走了小厂商流程，rank/5    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}