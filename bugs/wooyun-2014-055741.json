{"id": 56956, "wybug_id": "wooyun-2014-055741", "wybug_title": "某政府网站存在SQL注入拿到整区的gov站群", "wybug_corp": "鼎城区国家保密局", "wybug_author": "E先生", "wybug_date": "2014-04-11 14:42", "wybug_open_date": "2014-05-26 14:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-26：\t细节向公众公开  简要描述： SQL注入漏洞 详细说明：  存在SQL注入，拿到整个区的gov站群http://www.dcbmj.gov.cn/content.asp?id=378   漏洞证明：  \n\n\n\n\n\n   修复方案：  方法1: Replace过滤字符解决方法:查找login.asp下的username=request.Form(\"name\")pass=request.Form(\"pass\")修改为：username=Replace(request.Form(\"name\"), \"’\", \"’’\")pass=Replace(request.Form(\"pass\"), \"’\", \"’’\")语法是屏蔽’和’’字符来达到效果.方法2：在conn.asp 内加入 注：（前提 登陆页面有）把以下代码保存为safe.asp下面是程序代码********************************************************<%Dim Query_Badword,Form_Badword,i,Err_Message,Err_Web,nameErr_Message = 3Err_Web = \"safe.htm\"’出错时转向的页面Query_Badword=\"’|and|select|update|chr|delete|%20from|;|insert|mid|master.|set|chr(37)|=\"’在这部份定义get非法参数,使用\"|\"号间隔Form_Badword=\"’|(|)|;|=\"’在这部份定义post非法参数,使用\"|\"号间隔On Error Resume Nextif request.QueryString<>\"\" thenChk_badword=split(Query_Badword,\"|\")FOR EACH Query_Name IN Request.QueryStringfor i=0 to ubound(Chk_badword)If Instr(LCase(request.QueryString(Query_Name)),Chk_badword(i))<>0 ThenSelect Case Err_MessageCase \"1\"Response.Write \" Case \"2\"Response.Write \" Case \"3\"Response.Write \" End SelectResponse.EndEnd IfNEXTNEXTEnd ifif request.form<>\"\" thenChk_badword=split(Form_Badword,\"|\")FOR EACH name IN Request.Formfor i=0 to ubound(Chk_badword)If Instr(LCase(request.form(name)),Chk_badword(i))<>0 ThenSelect Case Err_MessageCase \"1\"Response.Write \" Case \"2\"Response.Write \" Case \"3\"Response.Write \" End SelectResponse.EndEnd IfNEXTNEXTend if%>   版权声明：转载请注明来源 E先生@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-04-16 14:03 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给湖南分中心处置。涉及多个政府部门网站集群，rank 20 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-26 20:28 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  从没见过如此认真的修复方案!   赞一个              aNd 1=1   没办法防吧..都转义了 更没办法    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}