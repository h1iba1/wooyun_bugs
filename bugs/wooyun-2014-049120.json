{"id": 58918, "wybug_id": "wooyun-2014-049120", "wybug_title": "CupCMS最新版sql注入漏洞2", "wybug_corp": "CupCMS", "wybug_author": "Matt", "wybug_date": "2014-01-23 14:13", "wybug_open_date": "2014-04-23 14:14", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-23：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-04-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： cupcms 注入漏洞2 详细说明：  \ncupcms/modules/member/archivers.phpif($G['do'] == 'update'){     $data['arc'] = P('archives');$data['model'] = P('model');//设置Module\t $id = (int)p('id');\t echo INC.'libs/model/'.$_GET['model'].'.func.php';\t if(file_exists(INC.'libs/model/'.$_GET['model'].'.func.php'))\t {\t      f('model/'.$_GET['model']);\t }\t if(function_exists($_GET['model'].'post'))\t {\t      $data['model'] = call_user_func($_GET['model'].'post',$data['model']);\t }\t\t $arc->update($data['arc'],$data['model'],$id);\t //update插入 第二个参数是列名~~\t if(!empty($arc->error))\t {\t   showtips($arc->error,url('detail',dreferer()));\t }\n   漏洞证明：  测试方法注册用户之后登陆然后打开http://127.0.0.1/cup/index.php?m=member&e=archives&d=update&model=music where 1=1 and 1=1s%23POST提交 id=1然后就哦了\n\n   修复方案：  过滤   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}