{"id": 37870, "wybug_id": "wooyun-2015-0114815", "wybug_title": "酒仙网两层风控验证规则均可绕过进行定位或者非定位密码碰撞用户", "wybug_corp": "酒仙网", "wybug_author": "黑暗游侠", "wybug_date": "2015-05-18 19:44", "wybug_open_date": "2015-05-23 19:46", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 时间都停了，他们都回来了 详细说明：  登陆处：http://m.jiuxian.com/m_v1/user/login做了2层风控：（1）验证规则：登陆错误3次以上需要输入验证码进行匹配（2）混淆规则：post提交用户输入的密码做了md5加密如何来解呢？注册了一个测试的小号，18*******31尾号31对于（1）：分析是对cookie的判断，来set了验证码so clear cookie or set cookie=NULL then fuzzing ！普通碰撞测试（带cookie）：\n\n返回207均为验证码规则丢弃。Clear Cookie\n\n碰撞结果：\n\n457为密码错误，458为登陆成功（尾号31），这个是定位密码碰撞用户那么对于（2）：规则----> MD5(password) 对猜解的密码字典，进行md5编码，传入后就可以进行非定位的暴力碰撞整个设计体系还是很多问题的。修复的话：（1）：方案很多，不给建议了（2）：时间哈希   漏洞证明：     修复方案：  （1）：方案很多，不给建议了（2）：时间哈希   版权声明：转载请注明来源 黑暗游侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-05-23 19:46 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-24 09:43 |    \t\t这只猪 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 南无阿弥陀佛！)\t\t \n  说的我好凌乱。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}