{"id": 9905, "wybug_id": "wooyun-2013-031621", "wybug_title": "中国电信某站点JBOSS任意文件上传漏洞", "wybug_corp": "中国电信", "wybug_author": "在路上", "wybug_date": "2013-07-23 10:41", "wybug_open_date": "2013-09-06 10:42", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["补丁不及时"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-06：\t细节向公众公开  简要描述： 中国电信某站点jboss漏洞 详细说明：  1.目标站点 http://125.69.112.239/login.jsp\n\n2.简单测试 发现是jboss，HEAD请求头绕过失败，猜测弱口令失败，发现没有删除http://125.69.112.239/invoker/JMXInvokerServlet这个是jboss的另一个漏洞了.3.大家都懂这里简单分析一下 Jboss在默认安装的时候，会安装http-invoker.sar站点,其web.xml配置如下：\n\n可知当请求invoker/JMXInvokerServlet或invoker/EJBInvokerServlet会调用org.jboss.invocation.http.servlet.InvokerServlet.class处理请求。该类对GET请求和POST请求，统一调用processRequest函数处理.\n\n\n\n该漏洞主要原因是jboss直接获得客户端提交数据进行反序列化，获得对象，然后调用对象。因此，攻击者需要自己构造一个jboss的类，并且将其序列化，然后将序列化的数据直接提交到存在漏洞站点的invoker/JMXInvokerServlet页面，恶意代码将会被执行。牛人写了攻击代码:可从http://www.hsc.fr/ressources/outils/jisandwis/download下载学习后可以写出自己的利用工具(因为原工具有个功能有点问题,当然也可以直接使用msf)最主要原因自己写的可以随心所欲修改，可以批...,额废话太多，直接上图。\n\n第一个功能是调用jboss的ServerInfo类的 OSVersion方法，可以获得系统版本信息。第二个功能是调用jboss的DeploymentFileRepository类的 store方法，后面是其参数。执行成功后，会获得shell。4.shell路径然后上传大马即可\n\n权限还挺高5.看到后门无数\n\n   漏洞证明：  1.留下验证http://125.69.112.239/myname/index.jsp2.别人的还在   修复方案：  删掉无用的包   版权声明：转载请注明来源 在路上@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-07-27 18:38 厂商回复： CNVD确认漏洞所述情况，并向白帽子请教所述新的exp。拟于下周继续推进该案例的处置，拟通报中国电信集团公司。rank 10 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-12 10:56 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  求EXP    \n     2013-09-13 19:18 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  @wefgod 怎么给你    \n     2013-09-15 11:42 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  好像五颗星就是我给的啊……已经评价过    \n     2013-10-05 17:13 |    \t\txx123 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 雷锋)\t\t \n  求exp，邮箱1540433714@qq.com。非常感谢    \n     2013-10-08 22:42 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  @xx123 http://buchedan.org/download/jboss-exploit.zip放到这里了，自己下载吧    \n     2013-10-09 00:16 |    \t\txx123 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 雷锋)\t\t \n  @在路上 求密码，密码是好多啊    \n     2013-10-09 20:10 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  @xx123 buchedan.org    \n     2013-10-14 13:15 |    \t\tWooYun_Zhang \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | I'm trying...)\t\t \n  是不是程序写死了OSName 和OSVersion，可以直接查看别的信息吗？我只能执行这两个命令，返回操作系统server 2003和版本5.2，我想知道是不是误报    \n     2013-10-14 13:16 |    \t\tWooYun_Zhang \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | I'm trying...)\t\t \n  @在路上 是不是程序写死了OSName 和OSVersion，可以直接查看别的信息吗？我只能执行这两个命令，上传出错，我不懂JBoss，没看懂详细信息，返回操作系统server 2003和版本5.2，我想知道是不是误报    \n     2013-10-14 19:28 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  @WooYun_Zhang 1.这OSName 和OSVersion 是jboss提供的方法，jboss提供的方法有限，最好用的 是store和 远程部署war的 ，但是那两个方法利用其他的类，2.出错我也遇到过 是因为需要的类运行时错误了 ，没有找到解决方法3.返回的信息不是误报，是正确的     \n     2014-02-12 14:54 |    \t\t小乐天 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:14        | From KnownSec)\t\t \n  正好遇到这样的一个问题，谢了    \n     2014-06-22 16:21 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  感谢您提供的exp    \n     2014-07-21 01:34 |    \t\t小夜 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:8        | 漫长的日子)\t\t \n  正好我也遇见了一个谢谢了     \n     2014-12-24 13:05 |    \t\tjk_影 \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:9        | 专注google三十年)\t\t \n  远程部署shell是个问题啊，如果不给连外网就部署不了shell了，有办法直接部署一个吗    \n     2015-01-13 00:13 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  @在路上 http://buchedan.org/download/jboss-exploit.zip失效了啊，求大牛共享一下下啊    \n     2015-01-16 12:44 |    \t\t日月星辰 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:10        | 关注于网络安全，贡献于网络安全，立志成为...)\t\t \n  求此jboss exp 邮箱1023194472@qq.com非常感谢    \n     2015-05-11 09:29 |    \t\t凌晨的星星 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:5        | 入侵是偶然的，但安全一定不是必然的!)\t\t \n  同求jboss exp，邮箱thomas702@126.com，非常感想～～～    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}