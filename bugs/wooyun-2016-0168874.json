{"id": 74986, "wybug_id": "wooyun-2016-0168874", "wybug_title": "旅务通某结算系统漏洞（泄露200W订单详情/200W注册会员详细信息/可伪造数据骗取结算）", "wybug_corp": "云南旅务通科技有限公司", "wybug_author": "路人甲", "wybug_date": "2016-01-10 18:52", "wybug_open_date": "2016-02-27 11:49", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-27：\t细节向公众公开  简要描述：  详细说明：  http://**.**.**.**/  存在命令执行，通过写shell，配置数据库，发现近300W订单详情，200W注册会员信息，详细信息。其他就是旅务通西双版纳结算平台的整体运作数据。数据量巨大，只截取部分证明，   漏洞证明：  \n\n\n\n\n\n\n\n\n\n<img \n\n />\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nQuery#0 : select t.TABLE_NAME,t.NUM_ROWS from user_tables t order by NUM_ROWS descTABLE_NAMEVARCHAR2\tNUM_ROWSNUMBERBTA_FEE\t2327220BTA_POLICY_DETAIL\t1806745ORDER_LIST_1\t1636319BTA_POLICY_TOTAL\t1031336ORDER_BASIC2\t837674ORDER_LIST\t614221CHECKSUM_CODE\t596028ORDER_DERATE\t558030ORDER_IDCARD_DETAIL\t538203BTA_DETAIL\t488175ORDER_IDCARD\t355001ORDER_BASIC\t321833BTA_TICKET\t260909BTA_ORDER\t253170DEAL_ORDER_LOG\t82505MEMBER_CREDITS_LIST\t50764ORDER_DISCOUNT\t46812RUN_LOG\t39795ORDER_IDCARD_CHECK\t36775TICKET_ORDER\t31126DRP_INTEGRAL_DETAIL\t25526BTAP_DETAIL\t22948MEM_INTEGRAL_DETAIL\t21800TRANS_DETAIL\t14507BTA_TOTAL\t13803MEMBER_CARD\t11760ORDER_COUNT_TMP\t11694CMG_LIST\t10927GUIDE_CREDITS_LIST\t10905BTA_PAY_DATA\t10256REWARD_TICKET_DETAIL\t10188HOTEL_ORDER_TOTAL\t8846GUIDE_CHARGE_LIST\t7662PRICE_DETAIL\t6284MANUAL_PROCESS_ORDER\t2252TEST\t1688CORP_PRICE\t1623COMBINE_TICKET_AUTHORITY\t1244GUIDE_CREDITS_TOTAL\t1076TEMP\t928GUIDE_USER\t861PRICE_LOG\t858COMBIN_TICKET_MUNIT_PRICE\t775REPORT_ITEMS\t595MEMBER_USER\t503MEM_CONFIG\t495SALE_POLICY_ACTOR\t441COMBINE_TICKET_DETAIL\t411ECAR_ORDER_TOTAL\t393CORP_MEMBER_GROUP\t389ZONE\t329PRICE\t291COUNT_MEMBER_PRODUCT_CONSUME\t275NOTICE\t273REPORT_CONS\t259COMBINE_TICKET_PRICE\t237MANUAL_ORDER_COUNT\t229CTL_ACT_ORDER\t220MEMBER\t204MEMBER_MAP\t197GUIDE_BANK_LIST\t196CORP_RATE\t196MUNIT_CASH\t167USER_RIGHT\t150REPORT_ELEMENT\t147MEMBER2\t143MEMBER_ACOUNT_TOTAL\t143COMBINE_TICKET\t138COMB_WHO_CAN_ORDER_DIC\t135CASH_POINTER\t134CENTER_SMSCHECKCODE\t128GUIDE_MUNIT_PRODUCT\t128BTA_POLICY_DETAIL_TEMP\t120N_BOOK_CARD_GROUP\t112SQL_DEBUG\t112CORP_USER\t112TRAVEL_REC\t106MEMBER_PAY_PASS\t100MEM_INTEGRAL_TOTAL\t97AUTO_CONFIRM\t85KC_MEMBER_BIND\t80CORP_MENU\t74REWARD_TICKET_TOTAL\t71NEED_CREATE\t62CENTER_MENU\t60MEMBER_CREDITS_TOTAL\t59DRP_INTEGRAL_TOTAL\t57REPORT_CON_ELEMENT\t56REPORTS\t54MUNIT\t52SALE_POLICY_EXE\t46CENTER_USER\t46COUNT_CORPINCOME\t44MEMBER_RIGHT\t42KC_LOGINTEMP\t38BEAN_HEADER\t38ACCOUNTS_NO_CASH\t37NATION\t37ORDER_OPENAPI\t35PROVINCE\t34MEMBER_MENU\t34PAY_MODE\t31USER_ROLE\t31LOG_EVENTS\t31TRANS_DIC\t30MUNIT_ADDITION_INFO\t27LOG_TYPE\t27BTA_FEE_UNIT\t27PRICE_DIC\t26MENU_GROUP\t24PRICE_RULE\t23COUNT_CORPINCOME_RESULT\t22TICKET_TYPE_DIC\t21ACCOUNTS_NO\t20ID_VALIDATION_RATE\t19COUNT_CORPINCOME_TMP\t18ORDER_STATUS_DIC\t17CASH_TEMP\t14REPORT_CON_SEL_LIST\t14AUDIT_GRADE\t13N_BOOK_GROUP_DIC\t13N_BOOK_PRICE_DIC\t13CORP_GRADE\t12GUIDE_LOG\t12N_BOOK_CARD_LIST\t12ADDITION_ITEM\t12SYS_CONFIG\t12BTA_SPECIAL_BOUNTY\t12BTA_MEMBER_TYPE\t12N_BOOK_PRICE\t12PRICE_RISE\t10ID_INPUT\t10STD_DIC_CODE\t9REPORT_CON_TYPE\t9BTA_POLICY_AP\t8MEMBER_LEVEL\t8ARRIVE_DIC\t8ROOM_INFO\t8MEMBER_MENU_GROUP\t8SPECIAL_FEE_OBJECT\t7CORP_TYPE\t7BTA_FEE_DIC\t6FEE_LIST\t6WARES\t6SPECIAL_FEE\t6TERM_TYPE\t6FEE_TYPE\t6BTA_TYPE\t5EXT_DATA_PRICE\t5EXT_DATA_TYPE\t5SPECIAL_FEE_PRICE\t5POLICY_GROUP\t5POLICY_MEM_GROUP_DETAIL\t5GUIDE_MUNIT\t5CASH_TYPE\t4COMB_PRICE_DIC\t4EXTEND_INFO\t4IP_JUDGE\t4POLICY_OBJECT\t4UNIT_TYPE\t4INTEGRAL_TYPE_DIC\t4BTA_LOG\t3CAL_MODE\t3COMB_TKT_TYPE\t3CTP_TYPE_DIC\t3ARRIVE_CORP_LIST\t3MANAGE_CORP\t3MEMBER_TYPE\t3ROOM_TYPE\t3DISCOUNT\t3CMG_TYPE\t2ECAR_PRICE_DIC\t2ECAR_PRICE_INFO\t2EXT_AUTH_MAN\t2POLICY_TYPE\t2WL_LLR_ADMINSERVER\t2SALE_POLICY\t2SALE_POLICY_MEM_GROUP\t2SUM_TYPE\t2SYSTEM_LOG\t2REWARD_TICKET_PERIODS\t2EXT_CUSTOMER_SRC\t1EXT_CUSTOMER_UNIT\t1ACT_INFO\t1POLICY_MEM_GROUP\t1TMP1\t1EXT_DATA_DETAIL\t1MEMBER_GROUP_WEB\t0FEE_RATE\t0NEWS\t0NORESULT\t0ORDER_LOG\t0ORDER_SPECIAL_FEE\t0PLAN_TABLE\t0POLICY_GROUP_DETAIL\t0TRAVEL_CONSUME_COUNT\t0USER_LOG\t0WASTE_BOOK\t0ADVICE\t0ADVICE_TYPE\t0BANK_ACCOUNT\t0BANK_ACCOUNT_QUEUE\t0BTA_DETAIL_TEMP\t0BTA_FEE_TEMP\t0BTA_ORDER_TEMP\t0BTA_PAY_DATA_TEMP\t0BTA_POLICY_TOTAL_TEMP\t0BTA_PROC\t0BTA_TICKET_TEMP\t0CHECK_LOG\t0CMG_MOVE_LOG\t0COMBINE\t0COMBINE_CORPS\t0COMBINE_DETAILS_WEB\t0COMBINE_POLICY_WEB\t0CORP_POLICY\t0CORP_REBATE\t0CUSTOMER_SERVICE\t0DIC_CORP_STATUS\t0DIV_DETAILS\t0EXT_CERTI_TYPE\t0FEE_COMP\t0MUNIT_LOG\t0\n数据库结构\n<url>jdbc:oracle:thin:@**.**.**.**:1521/tour</url>    <driver-name>oracle.jdbc.OracleDriver</driver-name>    <properties>      <property>        <name>user</name>        <value>bntour</value>      </property>    </properties>    <password-encrypted>{AES}9EBK20rfSY4r10PX7tqTvg2Sfgq7IurgizU94MniYwk=</password-encrypted> tour\n\nhttp://**.**.**.**/1.jsp?o=vLogin 7\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-01-14 16:43 厂商回复： CNVD确认所述情况,已经转由CNCERT下发给云南分中心,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}