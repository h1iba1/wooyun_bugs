{"id": 49395, "wybug_id": "wooyun-2014-073854", "wybug_title": "国内某短信业务平台存在通用型高危SQL注入漏洞导致短信各网关（移动、联通、电信、小灵通）接入入口和账户信息泄露", "wybug_corp": "cncert国家应急响应中心", "wybug_author": "HackBraid", "wybug_date": "2014-08-26 10:04", "wybug_open_date": "2014-11-24 10:06", "wybug_type": "地下0day/成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "信息泄露", "内部应用安全边界缺失", "项目管理不当", "内部管理不完善"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-03：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-24：\t细节向公众公开  简要描述： 可在多个省市推送定制短信！这次报告主要内容如下※通过高危SQL注入漏洞，由于权限很高可以直接添加管理员账户并成功入侵拿到一台服务器※通过对平台业务的认识，发现存在某省（移动，联通，电信，小灵通）短信网关接入账户。再利用某个高大上的软件的各种功能，攻击者可设计出一条推送特定短信到百万级用户的方案※由于该系统通用并且以省为单位，按照上面思路动动鼠标即可在多个省市推送特制短信。 详细说明：  青海省：http://110.167.173.18/default.asp 青海气象短信业务平台\n#落脚点（SQL注入）\n登录处存在注入\n\n\n\nSa权限，直接添加管理账户，远程连接\n\n连上数据库查看下管理员账户，super|密码为空\n\n由上图可以看到定制气象短信用户也就35w不到，取消了64w- -！为什么说我能推送定制短信到百万级呢？\n#短信网关接入信息泄露\n短信各网关接入参数，移动、联通、小灵通、电信的登录账户密码都在下面了\n\n以电信CDMA为例http://125.**.**.5:7001/ismp/spportal/ SP门户\n\n看下有哪些业务产品\n\n业务资费2元，收益60%=1.2元\n\n还有推送短信功能，但是只能推送到定制业务的号段\n\n看到这里感觉这个sp账户虽然权限很高了，但是还是有种种限制。\n#核心终端系统-气象短信业务平台\n\n\n1.统计号码数量登上后，我们看到有个号段管理，粗略统计了下青海省移动130W+号码，联通143W+号码，电信120W+号码，小灵通10W，加起来400W号码。\n\n2.构造定制短信首先选中任务管理--》电信任务管理（或者直接在D盘找到对应的exe执行即可，见下面两图）\n\n\n\n然后选择创建通道，归属地区填青海，通道名称填“WooYun漏洞定向推送”（^ ^意淫了）\n\n然后创建任务，选择刚刚创建的发布通道“WooYun漏洞定向推送”\n\n发布内容如下：\n\n3.青海总共定制业务的也就30W个人，我该怎么提高业务量？首先我们先回到上面的创建任务里的发布用户，点击按业务\n\n那么我们只要给所有用户都订上这个业务就ok啦，到主菜单点击业务处理，选择批量定制，左边把所有号码都导入进来，右边的定制业务选择上图中的某个业务\n\n哈哈，还能把用户全都设定为免费的\n\n这样就能实现任意短信的全省推送了。上面操作很费时间，发现其实有另外一处更快更省时。在业务处理—批量发送消息左边导入电话号码，右边导入短信内容\n\n   漏洞证明：  通用型证明：重庆：http://218.201.40.65:7001/ 四川：http://218.205.236.59/以四川为例\n\n   修复方案：  注入点修补不要开3389   版权声明：转载请注明来源 HackBraid@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-08-31 09:28 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-26 10:19 |    \t\t走火入魔 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:2        | 多读书，多看报，少吃零食，多睡觉。)\t\t \n  前排广告位    \n     2014-08-26 15:31 |    \t\t杨聪 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 新手上路，多多照顾，)\t\t \n  二楼广告位    \n     2014-08-26 17:32 |    \t\tJack.Chalres \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:15        | ..............)\t\t \n  三楼卖瓜子花生玉米棒    \n     2014-11-24 10:50 |    \t\t小卖部部长 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:3        | 别拿部长不当干部！)\t\t \n  洞主应该发：WOOYUN 路人甲到此一游     \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}