{"id": 374, "wybug_id": "wooyun-2014-081140", "wybug_title": "盛大游戏《最终幻想14》某活动系统未授权访问引发蝴蝶效应，涉及大量激活码、玩家数据", "wybug_corp": "盛大游戏", "wybug_author": "3King", "wybug_date": "2014-10-29 01:08", "wybug_open_date": "2014-10-29 12:17", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-29：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： http://www.wooyun.org/bugs/wooyun-2014-080889，盛大认为这是正常的业务设计，不是漏洞，评无影响或忽略，那今天就给你们演示演示如何通过这个产生影响。当初你们游戏送我鼠标垫的原因就是活动的未授权访问，现在我把人情还给你们。从此两清。希望你们sdg从此以后不要再拿鼠标垫来怀疑我的人品。否则这不是一个市值17亿公司的处事风格。 详细说明：  通过 WooYun: 盛大某系统设计缺陷可导致上千后台地址暴露 ，我们可以通过脚本批量获取所有接入盛大统一应用管理平台的后台管理地址。经过确认，目前最新的后台应用id为3373。如果只获取到很少数量的后台地址，那么没什么意义，因为这些后台业务都需要经过UAM的验证才能登入，否则都做未授权处理而被跳出。但是， WooYun: 盛大某系统设计缺陷可导致上千后台地址暴露 可以获取到大规模的后台地址，完全可以根据这些数据做出一些分析，然后举一反三。从这些后台地址可以分析出，盛大各大游戏平台的活动应用相当多，达到一千多个。这么多数量的活动，运维难免会出现一些疏忽。而 WooYun: 盛大某系统设计缺陷可导致上千后台地址暴露 获取到的后台地址是实时更新的，甚至包含前台未上线活动，那么完全可以猜测是否存在一般测试系统常见问题，如弱口令、未授权访问等。通过对这些后台地址进行遍历，发现http://act.ff.sdo.com/project/20140926bhmt/admin/存在未授权访问。\n\n\n\n用户资料不贴。你们自己清楚。通过查看cookies发现，它对应的session path为站点根目录，而不是该应用路径。\n\n那么我们猜测，是否可以通过这个已经授权的session登录其它同域名下未授权登录的后台？\n和《夺冠之路》不同的是，这里的问题系统是asp语言编程的，给予的是aspsession，所以影响asp的活动平台，对.net开发的平台无效。\n于是从获取到的所有后台列表内查找act.ff.sdo.com且以asp编程的后台，找到4个相关后台。\nhttp://act.ff.sdo.com/project/140402sc/adminhttp://act.ff.sdo.com/project/140610cosplay/adminhttp://act.ff.sdo.com/project/cbtevent/adminhttp://act.ff.sdo.com/project/20140904fftime/admin\n\n这里有个细节，即使你有漏洞系统生成的session，如果直接访问这些后台，依然会跳转到UAM认证界面，我们需要绕一下。刚才挖掘发现一个通用问题，盛大所有以asp编程的活动平台的后台menu.asp文件均存在未授权访问，所以我们需要先访问待检测系统的menu.asp，才能进入后台系统。\n于是这几个原本安全、需要统一验证才能登录的后台，由于这个未授权访问产生的session，全部变成未授权访问了。   漏洞证明：  \n\n\n\n\n\n\n\n   修复方案：  ·自求多福。   版权声明：转载请注明来源 3King@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-10-29 01:16 厂商回复： 收到，着手进行解决，THX 最新状态： 2014-10-29：   ", "replys": "漏洞评价：\n评论\n     2014-10-29 01:09 |    \t\t健宇 \t\t\t( 普通白帽子  |\t\t\t        Rank:131 漏洞数:14        | tools kid)\t\t \n  你关注的白帽子 3King 发表了漏洞 盛大游戏《最终幻想14》某活动系统未授权访问引发蝴蝶效应，涉及大量激活码、玩家数据    \n     2014-10-29 01:13 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  牛!~    \n     2014-10-29 01:14 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  顶着wooyun 400 好累啊 希望正常了    \n     2014-10-29 01:18 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  凌晨1点确认 不睡觉的?    \n     2014-10-29 01:26 |    \t\t宝宝 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:33        | 我是好宝宝)\t\t \n  3King发飙了，这个早点发布就好了，当时最终幻想封测时候激活码还可以卖钱呢    \n     2014-10-29 08:12 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  盛大市值才17亿    \n     2014-10-29 08:17 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  3King牛，好厉害。    \n     2014-10-29 08:23 |    \t\t盛大网络(乌云厂商)\t\t \n  标题好吓人 FF14激活码是FF开头的 这些529开头的是干嘛用的...不清楚...但是还得谢谢3king把私货终于放出来了！     \n     2014-10-29 08:54 |    \t\txiaokinghk \t\t\t( 实习白帽子  |\t\t\t        Rank:82 漏洞数:16        | 【DBA】)\t\t \n  厂商依然NB    \n     2014-10-29 09:38 |    \t\tViigoss \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:5        | viigoss)\t\t \n  @3King 你该找个女朋友了。    \n     2014-10-29 10:41 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @盛大网络 哥，你态度怎么变了？换人了吗    \n     2014-10-29 12:21 |    \t\t炯炯虾 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我来自地球)\t\t \n  @3King 你惨了 盛大要报警了 赶快跑路吧 那个529v什么的不是激活码 我去`¬`    \n     2014-10-29 13:07 |    \t\t雅柏菲卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:1213 漏洞数:234        | 雙魚座聖鬥士雅柏菲卡)\t\t \n  @3King 你惨了 盛大要报警了 赶快跑路吧 那个529v什么的不是激活码 我去`¬`    \n     2014-10-29 16:03 |    \t\t天地不仁 以万物为刍狗 \t\t\t( 普通白帽子  |\t\t\t        Rank:977 漏洞数:264        | 天地本不仁 万物为刍狗)\t\t \n  @3King 你惨了 盛大要报警了 赶快跑路吧 那个529v什么的不是激活码 我去`¬`    \n     2014-10-29 16:28 |    \t\tdarkrerror \t\t\t( 普通白帽子  |\t\t\t        Rank:263 漏洞数:44        )\t\t \n  @3King 你惨了 盛大要报警了 赶快跑路吧 那个529v什么的不是激活码 我去`¬`    \n     2014-11-07 18:58 |    \t\tMxx \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 没有)\t\t \n  难道挖的洞就值一个鼠标垫？    \n     2014-11-25 16:31 |    \t\tsysALong \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:5        | 电脑里的AV片 永远 和 电脑旁的卫生纸 成 ...)\t\t \n  求个激活码 然后我进游戏装逼去       \n     2014-11-25 20:47 |    \t\t炯炯虾 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我来自地球)\t\t \n  人是不是已经抓了？    \n     2014-12-04 15:19 |    \t\t小涛 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 跟随大大们的脚本来的)\t\t \n  吓死人 我草  这么厉害   膜拜啊 大大们     \n     2014-12-04 15:19 |    \t\t小涛 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 跟随大大们的脚本来的)\t\t \n  @天地不仁 以万物为刍狗  00表哥是你嘛     \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}