{"id": 8518, "wybug_id": "wooyun-2013-037312", "wybug_title": "知乎某中间件配置不当 导致httponly保护的COOKIE泄露", "wybug_corp": "知乎", "wybug_author": "猪猪侠", "wybug_date": "2013-09-16 18:25", "wybug_open_date": "2013-10-31 18:26", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-31：\t细节向公众公开  简要描述： 知乎现在的版本启用了httponly保护机制，使普通的xss跨站攻击无法获取到用户的COOKIE，进而阻止了信息安全风险的扩散。但由于某处配置不当，直接泄露了httponly保护的COOKIE。 详细说明：  # 问题出处由于知乎的dailyproxy配置不当，直接输出400错误的调试信息！# 漏洞地址http://parse.at.zhihu.com:8567/wooyun# 漏洞利用方法 WooYun: 利用squid轻松获取经http only保护的cookie内容    漏洞证明：  # 漏洞证明\nERRORThe requested URL could not be retrievedInvalid Request error was encountered while trying to process the request:GET /wooyun HTTP/1.1Host: parse.at.zhihu.com:8567Connection: keep-aliveAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/29.0.1547.66 Safari/537.36Accept-Encoding: gzip,deflate,sdchAccept-Language: en,en-US;q=0.8,zh-CN;q=0.6,zh;q=0.4Cookie: q_c2=46a110b9f**********4b37b3|1364395429000|1364395429000; q_c1=398d72731d***********68822c98ba|1379323430000|1379323430000; q_c0=\"MWNjMGMxZ******************************COWp1WQ==|1379324039|071958d9af413bcd4928b50654c9aab783e32eaf\"; _ga=GA1.2.1916379174.1365957109; __utma=51854390.1916379174.1365957109.1379323695.1379323695.1; __utmc=51854390; __utmz=51854390.1379323695.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utmv=51854390.100-1|2=registration_date=20121116=1^3=entry_date=20121116=1Some possible problems are:Missing or unknown request method.Missing URL.Request is too large.Content-Length missing for POST or PUT requests.Illegal character in hostname; underscores are not allowed.HTTP/1.1 Expect: feature is being asked from an HTTP/1.0 software.\n\n\n   修复方案：  # 配置出错信息屏蔽# 调试信息关闭   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-09-16 19:02 厂商回复： 多谢反馈，我们立刻修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-16 19:01 |    \t\the1renyagao \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:29        | 是金子总会发光，在还未发光之前，先打磨打...)\t\t \n  练级的节奏    \n     2013-09-17 17:50 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  练级的节奏    \n     2013-09-22 08:47 |    \t\tfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:664 漏洞数:79        | 想刷个6D)\t\t \n  猪哥v5    \n     2013-11-12 00:07 |    \t\tSogili \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:27        )\t\t \n  这个应该是利用不了的    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}