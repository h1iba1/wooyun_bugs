{"id": 62645, "wybug_id": "wooyun-2013-034878", "wybug_title": "果壳网csrf漏洞可致用户强制登出漏洞", "wybug_corp": "果壳传媒", "wybug_author": "nasdaq", "wybug_date": "2013-08-21 16:22", "wybug_open_date": "2013-10-05 16:23", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["跨域"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-05：\t细节向公众公开  简要描述： CSRF,以及Flash安全性问题.可以导致访问指定帖子或链接的指定用户登出,或全部用户伪登出. 详细说明：  1.果壳网编辑器可以通过[flash]url[/flash]标签插入flash内容,而flash内容并没有做allowNetworking限制,导致flash可以任意发送post/get跨域请求或弹出新窗口.2.果壳网登出链接https://account.guokr.com/sign_out/$uid/,提交不需要token,可以通过指定uid对指定的一个或多个用户实施CSRF导致登出.也可以通过访问https://www.guokr.com/sso/signout/,使所有用户在页面刷新之后呈现\"伪登出(刷新后页面显示登出状态,但点击登录按钮不用输入用户名密码即可再次登入)\"的状态.潜在的威胁:flash不加allowNetworking限制,使得flash发送的恶意请求可以绕过Referer验证,一旦发生CSRF或者XSS漏洞,会增大风险和CSRF蠕虫传播的可能.   漏洞证明：  利用fly_flash,将配置好的flash内容插入帖子页面, fly_flash.txt内容为2,https://www.guokr.com/sso/signout/1,https://account.guokr.com/sign_out/0927426014/用户在访问该页面后,所有用户将处于\"伪登出\"状态, id 为0927426014的用户实际登出.实际测试页面见http://www.guokr.com/post/503856/使用果壳账号登陆该页面后,刷新页面,页面显示登出状态.   修复方案：  1.登出动作加token验证.2.对于非视频类的flash增加allowNetworking限制.   版权声明：转载请注明来源 nasdaq@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-08-22 11:24 厂商回复： 感谢你的反馈，漏洞已堵 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}