{"id": 55712, "wybug_id": "wooyun-2014-060147", "wybug_title": "逐浪cms两处文件上传漏洞（有服务器环境限制）", "wybug_corp": "逐浪CMS", "wybug_author": "what_news", "wybug_date": "2014-05-10 21:51", "wybug_open_date": "2014-08-05 21:52", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传", "解析文件漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-11：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-05：\t细节向公众公开  简要描述： 也是要结合iis6的解析漏洞，不知道这两处跟之前提交的会不会重复 详细说明：  由于官网不是iis6的环境 我本地进行测试第一处\nhttp://127.0.0.1/Plugins/ckfinder/ckfinder.html\n在左边文件夹Files下新建字幕了1.asp 然后点击1.asp目录然后上传图片木马3.gif\n\n然后右键查看文件 就可以看到文件地址了\n\n文件地址\nhttp://127.0.0.1/UploadFiles/files/1.asp/3.GIF\n第二处\nhttp://127.0.0.1/plugins/imageupload.aspx\n\nprotected void btnUpload_Click(object sender, EventArgs e){    string str = \"\";    string str2 = Path.GetExtension(this.fup_Image.FileName).ToLower();    if (!this.CheckFilePostfix(str2.Replace(\".\", \"\"))) //上传文件类型白名单可以自己设置    {        this.ReturnManage(\"上传的附件不是符合扩展名\" + base.Request[\"Ext\"] + \"的文件\");    }    else    {        string path = base.Server.MapPath(\"~/UploadFiles/Images/S\" + base.Request.QueryString[\"SID\"]); //可创建文件夹自己可控制        if (!Directory.Exists(path))        {            Directory.CreateDirectory(path);        }        string str4 = DateTime.Now.ToString(\"yyyyMM\");        string str5 = DataSecurity.MakeFileRndName();        str = str4 + str5 + str2;        string filename = path + @\"\\\" + str;        this.fup_Image.PostedFile.SaveAs(filename);        (this.Page.FindControl(\"span_Error\") as HtmlGenericControl).Style[\"display\"] = \"block\";        string s = string.Format(\"<script>parent.document.getElementById('hdPath_'+ {0}).value='/UploadFiles/Images/{1}/{2}';parent.document.getElementById('img_'+ {0}).src='/UploadFiles/Images/{1}/{2}';</script>\", base.Request.QueryString[\"QID\"], \"S\" + base.Request.QueryString[\"SID\"], str);        base.Response.Write(s);    }}\n访问\nhttp://127.0.0.1/plugins/imageupload.aspx?SID=2.ASP&Ext=jpg\n上传jpg格式木马\n\n右键查看源代码就有文件路径了\n\n   漏洞证明：  漏洞证明如上   修复方案：  修复   版权声明：转载请注明来源 what_news@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-08-05 21:52 厂商回复： 感谢反馈，自zoomla!逐浪CMS21.4开始，iis6和混和环境既非我方官方支持范围，同时也非微软官方支持范围，亦即此环境是不会存在的。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-10 21:58 |    \t\twhat_news \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:48        | 小菜一个 希望成为大菜)\t\t \n  @疯狗 这公司给的rank这么低 还走小产商。。。    \n     2014-05-11 10:41 |    \t\t逐浪CMS(乌云厂商)\t\t \n  感谢反馈，自zoomla!逐浪CMS21.4开始，iis6和混和环境既非我方官方支持范围，同时也非微软官方支持范围，亦即此环境是不会存在的。    \n     2014-05-11 14:12 |    \t\twhat_news \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:48        | 小菜一个 希望成为大菜)\t\t \n  @逐浪CMS  我提交的另一个还没确定啊 http://wooyun.org/bugs/wooyun-2014-060071    \n     2014-05-11 23:36 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @逐浪CMS 哦~这样啊，晓得了    \n     2014-05-11 23:38 |    \t\twhat_news \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:48        | 小菜一个 希望成为大菜)\t\t \n  @疯狗 之前 WooYun: 逐浪CMS一个漏洞的各种拿Shell姿势（系统环境限制）  这个也是结合iis6解析漏洞 他就确定  现在这个就不确定了  感觉开始坑了    \n     2014-05-11 23:42 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @what_news 不是开始坑了，厂商是开始主动跟平台和白帽子同步一些安全细节了，开始互动而不是一味的只确认漏洞没反馈    \n     2014-05-11 23:44 |    \t\twhat_news \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:48        | 小菜一个 希望成为大菜)\t\t \n  @疯狗 也没有啊  我提醒 @逐浪CMS 帮我确认这个漏洞很久都没回应 http://wooyun.org/bugs/wooyun-2014-060071估计又是忽略的节奏了    \n     2014-05-12 11:11 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @what_news 应该是看到了在确认吧    \n     2014-05-12 11:15 |    \t\twhat_news \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:48        | 小菜一个 希望成为大菜)\t\t \n  @疯狗 应该不会了的  比 wooyun.org/bugs/wooyun-2014-060071 晚提交的漏洞都确定了或者忽略了 这个估计就不会理了 产商开始恢复以前的原貌了感觉    \n     2014-05-13 22:14 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  亦即此环境是不会存在的，没人用IIS6的。哈哈@疯狗    \n     2014-05-13 22:21 |    \t\twhat_news \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:48        | 小菜一个 希望成为大菜)\t\t \n  @wefgod 官网也没说要装在大于iis6的版本上 或者就直接集成服务器呗 哈哈    \n     2014-05-13 22:53 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @what_news 老实说没看明白官方意思。不知道是不是漏洞太有内容了    \n     2014-05-13 23:03 |    \t\twhat_news \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:48        | 小菜一个 希望成为大菜)\t\t \n  @wefgod 官网的意思 应该是说他的系统是给人装在iis7以上的服务器的，官网都没通知用户 有点坑 估计是购买他版权的用户才会告知吧  还有一点之前有人提交的也是iis6 他都没说明这个问题    \n     2014-05-13 23:04 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @what_news 免费的一般谁还管那么多。不过老实说iis6的解析漏洞那么经典，要防一下也比较简单，只是看想不想做的问题了。反正他主动忽略了，按我理解就是不改，哪天如果改了……你懂的    \n     2014-05-13 23:05 |    \t\twhat_news \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:48        | 小菜一个 希望成为大菜)\t\t \n  @wefgod 明白 应该会改的 我觉得哈哈 不然别的用户就会被坑了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}