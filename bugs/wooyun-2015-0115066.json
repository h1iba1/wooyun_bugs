{"id": 31033, "wybug_id": "wooyun-2015-0115066", "wybug_title": "csdn某处存在xss漏洞", "wybug_corp": "CSDN开发者社区", "wybug_author": "byteway", "wybug_date": "2015-05-20 11:20", "wybug_open_date": "2015-07-04 11:24", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["技巧", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-04：\t细节向公众公开  简要描述：  详细说明：  0x00.私信功能XSS过滤不严,只要向目标发私信,只要用户登陆CSDN，并且预览私信，立即触发XSS，我们就可以通过XSS平台收到cookie，从而模拟登陆。0x01.尝试简单的私信，测试是否存在XSS\n\n0x02.当用户看到有私信提醒，并点击预览时触发\n\n\n\n0x03.看到没有任何过滤的触发，我感到心都凉了。。。，下面直接收cookie吧~我们可以在CSDN博客或首页找特定的用户发私信，用户的ID就是他博客空间的后缀，如http://blog.csdn.net/qq_203 ....,这里的qq_203...(省略)就是一个在CSDN唯一的ID，可以用着的名字得目标ID，下面测试给qq_203用户发私信：\n\n0x04.下面当用户收到私信提醒，要预览私信\n\n看到解析了，我们就去xss平台看下吧~   漏洞证明：  0x05.收获cookie\n\n0x06.使用收到的cookie登陆这里登陆我们选择登陆http://msg.csdn.net/letters?linker=qq_203...(省略)&start_id=0\n\n0x07.登陆因为我们最初可能不清楚目标qq_203...会有哪些私信对象，所以我们可以把linker参数改成目标自己，这样尝试登陆之后，可以看到左侧通信栏中有私信记录，然后在修改为他的私信好友可以查看具体信息了。。。\n\n0x08.登陆博客\n\n0x09.总结：该功能可以任意用户发私信只是在预览环节出现问题(其实check这里，也是因为自己之前收到过垃圾私信才注意到这里)，发信时又没有验证码，可以进一步用XSS蠕虫做一些D之类的事，如向好友之间相互传递私信，这样大量用户都会遭殃。。。   修复方案：  预览时转义为html实体编码   版权声明：转载请注明来源 byteway@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-05-20 11:23 厂商回复： 尽快修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}