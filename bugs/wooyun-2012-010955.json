{"id": 18177, "wybug_id": "wooyun-2012-010955", "wybug_title": "东软高校数字校园平台校园信息门户上传漏洞", "wybug_corp": "东软集团", "wybug_author": "headhuanglan", "wybug_date": "2012-08-16 09:27", "wybug_open_date": "2012-08-21 09:28", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 东软的高校数字校园平台有上传漏洞，可以遍历目录，也可用来拿shell 详细说明：  东软的高校数字校园平台有上传漏洞，可以通过构造本地表单的方式绕过上传文件类型检测。最终能上传jsp木马，可遍历目录，甚至下载数据库配置文件，从而远程连接数据库。后果很严重。   漏洞证明：  \n\n\n\n\n\n正常的用户上传头像的网页，通过构造本地表单，把js部分的判断文件类型代码省去，即可上传任意类型文件。上传后文件地址如下，如图：http://XXX/eapdomain/static/cmsfiles/personInfo/photos/学号.jsp由于网站权限设置，无法执行jfolder的全部功能，通过遍历目录，找到数据库配置文件，并下载查看，可见数据库用户名密码，可远程连接此数据库，危害极大。其余通过遍历目录，还可下载其他用户上传的文件，头像等...   修复方案：  在服务器端进行图片类型验证   版权声明：转载请注明来源 headhuanglan@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-08-21 09:28 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-08-16 10:09 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n   WooYun: 东软的高校数字校园平台上传漏洞    \n     2012-08-16 10:25 |    \t\theadhuanglan \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | 非科班出身，网络爱好者~~呵呵)\t\t \n  @风萧萧 和这个很类似tiny_mce/plugins/advimage/uoload.jsp这个文件在服务器上并没有找到~~~    \n     2012-08-16 17:27 |    \t\tf1eecy \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | 图书管理员~)\t\t \n  这个我已经提交过了，还被东软数字校园的人威胁了。。。不过我还有一个拿在手里不递交了。。    \n     2012-08-16 17:45 |    \t\theadhuanglan \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | 非科班出身，网络爱好者~~呵呵)\t\t \n  @f1eecy 这个和你那个调用的上传地址是不一样的~~同一类漏洞~~不是吧，还威胁~白帽子生命安全有保障吗？    \n     2012-08-16 18:06 |    \t\tf1eecy \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | 图书管理员~)\t\t \n  @headhuanglan 是有很多上传点，都是一样的毛病，他们给的补丁补了四个，应该还有2个，不过也有可能各个高校的目录结构有点不一样。    \n     2012-08-16 18:12 |    \t\theadhuanglan \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | 非科班出身，网络爱好者~~呵呵)\t\t \n  @f1eecy 有上传漏洞倒没啥~顶多拿个shell，关键是能读到数据库配置文件~我就一普通学生账号，这个很严重啊，没敢再深入做测试了~希望开学放映给学校信息中心能协同解决这个问题。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}