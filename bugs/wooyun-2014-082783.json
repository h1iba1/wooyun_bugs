{"id": 48336, "wybug_id": "wooyun-2014-082783", "wybug_title": "phpcms设计不当可绕过验证码继续暴力破解用户（demo演示）", "wybug_corp": "phpcms", "wybug_author": "鬼五", "wybug_date": "2014-11-10 18:35", "wybug_open_date": "2014-12-30 14:44", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-15：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向公众公开  简要描述： 看淡成败，做好自己 详细说明：  首先来到phpcms的官网，然后点击产品演示\n\n可以看到已经来到了demo演示界面，然后点击登录\n\n看到网站是有验证码限制的，于是我就蛋疼了，肿么办呢？只能想办法看看能不能绕过了\n\n我先抓包看看，用户名和密码全部明文传输，而且可以抓取验证码的包（八成有戏，嘿嘿）\n\n然后带到repeater下看看回显，这时我们先用正确的验证码go一下看看，可以看到提示无此用户\n\n再换成错误的验证码，可以看到提示验证码错误\n\n再换回正确的验证码，可以看到又提示无此用户，综合以上信息可以判断：验证码只要第一次输入正确，第二次，第三次，第四次。。都会是正确的\n\n接下来就是直接爆破了，跑了几分钟，可以看到跑出了不少用户的\n\n\n\n随便选几个看看全部可以登录成功\n\n\n\n\n\n\n\n   漏洞证明：  \n\n\n\n\n\n\n\n   修复方案：  。。。。找了好多路径提交都没过，说暴力破解不属于大问题，个人感觉还是应该受到重视   版权声明：转载请注明来源 鬼五@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-30 14:44 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-10 18:37 |    \t\tterm \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:21        )\t\t \n  双投？    \n     2014-11-10 18:47 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @term 双投也没什么，PHPCMS厂商比较厚道，会回复已被提交过的    \n     2014-11-10 19:27 |    \t\t鬼五 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:83        )\t\t \n  @term @U神 我提交360显示没有过，确实不知道，我之前也绝对没有双投过的漏洞案例，乌云这边后提交的，就算了，rank之类的奖励我也不要，清空吧，造成的误会实在不好意思    \n     2014-11-10 19:28 |    \t\t鬼五 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:83        )\t\t \n  @疯狗疯狗呢？把我这个清空了吧，添麻烦了，实在不好意思    \n     2014-11-10 20:01 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  做人要厚道啊。    \n     2014-11-10 20:13 |    \t\t鬼五 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:83        )\t\t \n  @机器猫 。。。。再说一遍，确实没有看到，之前也绝对没有过双投的案例，你也可以看修复方案，我说了之前提交过一些路径没有过，我确实不知道360那边过了的，造成的麻烦，实在不好意思    \n     2014-11-10 21:35 |    \t\tterm \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:21        )\t\t \n  @U神 两方审核人员累啊    \n     2014-11-10 21:57 |    \t\t鬼五 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:83        )\t\t \n  @term 再次表示歉意，实在不好意思    \n     2014-11-10 22:09 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  爆牛    \n     2014-11-10 22:12 |    \t\t鬼五 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:83        )\t\t \n  @老和尚 烦着呢，郁闷    \n     2014-11-10 22:23 |    \t\tterm \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:21        )\t\t \n  @鬼五 木事，大牛带我飞可好？    \n     2014-11-10 22:34 |    \t\t鬼五 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:83        )\t\t \n  @term 汗死，我渣渣    \n     2014-11-10 22:38 |    \t\tterm \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:21        )\t\t \n  @鬼五 求大牛联系方式，或者加我，我个人资料有QQ，    \n     2014-11-10 22:48 |    \t\t鬼五 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:83        )\t\t \n  @term 额，QQ981274933    \n     2014-11-11 00:37 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  鬼五人不错啊，嘿嘿，你猜猜我是谁？    \n     2014-11-11 07:02 |    \t\t鬼五 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:83        )\t\t \n  @老和尚 虽然不玩乌云，但还是晓得你是谁的    \n     2014-11-11 07:04 |    \t\t鬼五 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:83        )\t\t \n  @疯狗  郁闷，疯狗呢？咋还不把这个删了啊，这回丢人丢大了。。唉    \n     2014-11-11 09:05 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  @鬼五 不信，你说啊    \n     2014-11-11 09:08 |    \t\t鬼五 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:83        )\t\t \n  @老和尚 250的那个，哈哈    \n     2014-11-12 08:22 |    \t\t萌萌哒-花粉 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:5        | 多乌云 多美女 花粉 顾名思义 就是校花班花...)\t\t \n  @鬼五 @term 双投多数是因为一方两天以上没有审核 结果对面审核后另一方也审核了 360有这样一种机制 在漏洞上前台前可以取消修改 希望乌云也弄瞎 @xsser     \n     2014-11-12 11:09 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @萌萌哒-花粉 我们关心的是漏洞厂商有没有及时修复，修复后漏洞能不能让其他人学习，我们并不会用漏洞来实现某种利益，所以只要企业没有修复的，漏洞本身有价值的我们都会通过的  ：）    \n     2014-11-12 12:45 |    \t\t鬼五 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:83        )\t\t \n  @xsser e，咋还不把俺这个删了，真的没有双投的意思，我提交360显示没有过，确实不知道，我之前也绝对没有双投过的漏洞案例，把这个删了吧，rank之类的奖励我也不要，清空吧，造成的误会实在不好意思    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}