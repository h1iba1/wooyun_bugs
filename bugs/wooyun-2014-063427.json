{"id": 2793, "wybug_id": "wooyun-2014-063427", "wybug_title": "迅雷商场上传任意文件可秒首页", "wybug_corp": "迅雷", "wybug_author": "路人甲", "wybug_date": "2014-06-03 23:26", "wybug_open_date": "2014-07-23 19:44", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-23：\t细节向公众公开  简要描述： 6-1过的很不错，回家就开始瞎逛，运气不错遇到小洞一枚！上传限制不严格导致任意文件上传！可以秒首页？可以撸服务器？我只想要个路由器:) 详细说明：  http://shop.xunlei.com/test.txt写个test测试成功！刚开始我只是去玩活动http://act.shop.xunlei.com/xlrouter/，想抽个迅雷路由器玩玩！然后就开始了下面的测试！几个任务我都先看了一遍！发现最后一个上传哇，传个我最爱的美女图片，手贱的审查元素，看路径，鼠标点开上传文件接口，http://image.shop.xunlei.com/objects/swfupload.swf，记得某大牛说过这种可以修改后缀上传任意文件，我抄起我的菜刀就上了，各种改后缀，然后再审查元素看看，然后发现了\n\n这难道就是传说中的上传规则？上去就一顿改，jsp，php，jspx各种后缀走一遍先！文件大小限制各种改成999kb！上传php菜刀全成了xml，我是逗b，我表示不服！发现我2b了，头文件验证的哇！瞎搞了半天，好吧给他一个不认识的头\"doubimen\"后面再接我的大菜刀，好吧还是不行！禁止了我的xxoo函数！但是有一丢丢收获！\n\n路径在手 webshell我有！上传情况摸的差不多了，试试写个文件\ndoubimen<?php$file = fopen(\"../../test.txt\", \"a\");fwrite($file, \"test!good job!for doubimen!\");fclose($file);?>\n就到这吧！再继续下去影响太大，也很多不可控情况！不瞎搞了！   漏洞证明：  \n\nhttp://shop.xunlei.com/test.txt   修复方案：  你们比我更懂！我只是个逗b :）   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-06-04 18:14 厂商回复： 感谢反馈，我们正在处理中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-03 23:27 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  屌    \n     2014-06-03 23:29 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  膜拜！！！    \n     2014-06-03 23:29 |    \t\tvipons \t\t\t( 普通白帽子  |\t\t\t        Rank:284 漏洞数:65        | *^◎^*)\t\t \n  屌    \n     2014-06-03 23:53 |    \t\t逗b炮 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:1        | muyou)\t\t \n  @光刃 方丈速度好快哇！可惜没抢到沙发！    \n     2014-06-04 10:25 |    \t\t我来找快乐 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:2        | 我来找快乐)\t\t \n  呵呵，逗么？别人分享出来，你来这里逗逼？神器的路人甲真是搞笑啊。这个人咋不敢用自己的号提交啊，逗逼。只能说楼主屌。哈哈    \n     2014-06-04 10:27 |    \t\t那一份执着 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:4        | 只有不断学习不断思考才能使自己进步，我不...)\t\t \n  这个才是王道    \n     2014-06-04 10:28 |    \t\thuotoo \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:3        | 努力学习中)\t\t \n  .....流弊...    \n     2014-06-04 11:06 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  我去！    \n     2014-06-04 11:19 |    \t\t他是个撸丝 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:3        | 我有一头小毛驴啊，我就是不敢骑)\t\t \n  屌    \n     2014-06-04 12:08 |    \t\tMorker \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:24        | 双手是最重要的、、、)\t\t \n  已被纵多黑阔拿去装逼  估计楼主的路由器没希望了    \n     2014-06-04 12:46 |    \t\t小火苗 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 我是一只小火苗呀，春风吹又生呀...)\t\t \n  已被纵多黑阔拿去装逼 估计楼主的路由器没希望了    \n     2014-06-04 12:51 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  裤子被脱了！我擦！刚才在这里看到了：http://www.mfhk8.com/thread-129879-1-1.html  求迅雷抓住这装B黑客    \n     2014-06-04 14:49 |    \t\t逗b炮 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:1        | muyou)\t\t \n  @U神 我没有做这种事！我就留了个文本验证而已！请分清楚谢谢！    \n     2014-06-04 15:02 |    \t\t小火苗 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 我是一只小火苗呀，春风吹又生呀...)\t\t \n  @U神 估计媒体又要开始了。。。    \n     2014-07-06 21:40 |    \t\t刘海哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:114 漏洞数:28        | 索要联系方式但不送礼物的厂商定义为无良厂...)\t\t \n  http://image.shop.xunlei.com/objects/swfupload.swf，记得某大牛说过这种可以修改后缀上传任意文件，我抄起我的菜刀就上了，各种改后缀，然后再审查元素看看，然后发现了怎么给修改发 求教啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}