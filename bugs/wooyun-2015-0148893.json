{"id": 83109, "wybug_id": "wooyun-2015-0148893", "wybug_title": "某驾校自动化运营管理通用型系统存在高危漏洞[getshell、大批量考生信息泄露]", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-10-25 15:11", "wybug_open_date": "2015-12-17 14:48", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "未授权访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-01：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 某驾校自动化运营管理通用型系统存在高危漏洞，敏感文件未授权访问，批量getshell，大批量考生信息泄露 详细说明：  未授权访问：该通用型程序未对后台相关敏感文件进行权限校验，导致任意匿名用户可对其敏感文件进行提交任意文件上传：该通用型程序未对用户上传的文件进行任何校验，任意匿名用户可上传任意脚本文件   漏洞证明：  这里，先列举部分问题URL：http://**.**.**.**http://**.**.**.**http://**.**.**.****.**.**.** http://**.**.**.****.**.**.**....好的，这里就以第一个为例子。下面开始进入正题。1.这里我也废话不多说了，直接找到问题URL：http://**.**.**.**/admin/admin_addFile.aspx[未授权访问，这个刚开始我也不晓得，是从一个弱口令进去后台的系统里，然后找到这个URL，然后，你懂的]，如下图所示\n\n这里为了证明一下这个问题其他网站也存在，这里我也附上截图，如下：\n\n\n\n\n\n\n\n\n\n好的，以上只是我找的部分网站。。。2.接下来，简单说明下利用[getshell]，具体操作如下：\n\n\n\n点击“确定”\n\nok，接下来访问上传后的URL：http://**.**.**.**/images/zxgg.aspx，如下图\n\n接下来，菜刀连接之，如下图所示\n\nshell已经到手，接下来，找到数据库链接信息，然后，数据你懂的，，我这里就附截图了，如下所示\n\n\n\n\n\n\n\n这才是一个数据库的，还有好几个没看。。。\n\n好的，这个站点就到这里，看其他的，同样的操作，这里我就附上截图，如下：http://**.**.**.**/admin/admin_addFile.aspx\n\nshell地址：http://**.**.**.**/images/zxgg.aspx，菜刀连接之，如下图\n\n接下来，同样来看下数据库\n\n\n\n\n\n\n\n这只是一个数据库的，其他的我这里就不截图了。。。好了，其他站点一样的道理，，，，我这里就不截图了，，太累了。。。。。唉。大批量考生信息就这样简单粗暴的外泄了。。。   修复方案：  未授权访问：程序需对后台敏感文件设置操作权限并验证用户身份。任意文件上传：客户端和服务端都要对用户上传的文件进行后缀、内容等校验工作。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-10-29 09:58 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给河北分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}