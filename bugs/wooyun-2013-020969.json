{"id": 11866, "wybug_id": "wooyun-2013-020969", "wybug_title": "B2Bbuilder B2B网站管理系统之注入漏洞  2013/03/30", "wybug_corp": "B2Bbuilder B2B网站管理系统", "wybug_author": "流浪的风", "wybug_date": "2013-03-30 16:09", "wybug_open_date": "2013-06-28 16:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-05-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-28：\t细节向公众公开  简要描述： 存在注入漏洞 详细说明：  ###########################################  Title: B2Bbuilder B2B网站管理系统之注入漏洞#  Time：2013/03/30#  Team:c0deplay#######################################   源码下载地址:http://down.chinaz.com/soft/24224.htm程序：B2Bbuilder B2B网站管理系统 v6.6 正式版 20130225<?php/** * powered by b2bbuilder * Coprighty http://www.b2b-builder.com * Auter:brad zhang; * Des:Reveiw */include_once(\"includes/global.php\");include_once(\"includes/smarty_config.php\");//===============================================if (!empty($_GET['ctype'])){\tif ($_GET['ctype']==1)\t   $sql=\"select title from \".NEWSD.\" where  nid=\".$_GET['conid'];\tif ($_GET['ctype']==2)\t   $sql=\"select title from \".INFO.\" where  id=\".$_GET['conid'];\tif ($_GET['ctype']==3)\t   $sql=\"select pname as title from \".PRO.\" where   id=\".$_GET['conid'];\tif ($_GET['ctype']==4)\t   $sql=\"select title from \".EXHIBIT.\" where  id=\".$_GET['conid'];\tif ($_GET['ctype']==5)\t   $sql=\"select downname as title from \".down.\" where  id=\".$_GET['conid'];\tif ($_GET['ctype']==7)\t\t   $sql=\"select projecttitle as title from \".PROJECT.\" where  id=\".$_GET['conid'];\t$db->query($sql);\t$titlemsg=$db->fetchRow();\t$titlem=$titlemsg['title'];\t$tpl->assign(\"tmsg\",$titlem);}  $sql=\"select a.*,b.user from \".COMMENT.\" a left join \".ALLUSER.\" b on a.fromuid=b.userid     where a.conid=\".intval($_GET['conid']).\" and a.ctype=\".intval($_GET['ctype']);//---------------include_once(\"includes/page_utf_class.php\");$page = new Page;$page->listRows=20;if (!$page->__get('totalRows')){\t$db->query($sql);\t$page->totalRows = $db->num_rows();}$sql .= \"  limit \".$page->firstRow.\",20\";//-----------------------------$db->query($sql);$review[\"page\"]=$page->prompt();$review[\"list\"]=$db->getRows();$tpl->assign(\"revdetail\",$review);include_once(\"footer.php\");$tpl->display(\"rewiew_detail.htm\",$flag)?>conid未过滤产生注入   漏洞证明：  这是本地测试的\n\ngoogle搜索过来的\n\n   修复方案：  不懂修复，相信厂家懂得。。。   版权声明：转载请注明来源 流浪的风@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2013-04-03 14:16 厂商回复： CNVD确认并在多个实例上复现所述情况，已在2日联系到软件生产厂商上海远丰信息科技有限公司。2日下午，厂商及时反馈了处置方案，对存在SQL注入的页面提供源文件替换的解决方案。按部分影响机密性、可用性、完整性进行评分，rank=7.48*1.1*1.5=12.342 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}