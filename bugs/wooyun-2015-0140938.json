{"id": 68661, "wybug_id": "wooyun-2015-0140938", "wybug_title": "去哪儿某站Cookie认证问题导致任意账户登录", "wybug_corp": "去哪儿", "wybug_author": "crown丶prince", "wybug_date": "2015-09-13 20:10", "wybug_open_date": "2015-10-29 16:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "认证缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-29：\t细节向公众公开  简要描述： 去哪儿某站Cookie认证问题导致任意账户登录 详细说明：  http://wooyun.org/bugs/wooyun-2015-0130299这个漏洞未修复完全 依然可以进入账户http://182.92.234.7/Admin/user/Login 登陆后台设计缺陷 账号处填入admin'or 1=1--密码任意直接登录后台读取了下cookie 发现仅仅是这样的USID=1%7ctest那么我们如果更改了test会不会造成登陆成他人的账号呢？在test账号里 找到用户名列表  一共800多个账户 还有admin账户\n\n找个简单工具 啊D修改cookie为admin 用户名变成了admin 可以执行admin操作\n\n再试试这个syx1026778如果无效 可以把cookie修改成这样 USID=1%7csyx1026778; USID=1%7cadmin 总之是不再利用test账号 达到随意进入账号了\n\n   漏洞证明：  说一下危害：  即使去哪儿之后修复了该站点SQL注入问题  依然可以达到利用cookie认证缺陷进入任意账号  进行操作审核测试时候可以多试几次 有时候我的方式可能行不通 多试几次就好【附送后台；里的疑似注入】182.92.234.7/Admin/order/Detail?orderNo='   修复方案：     版权声明：转载请注明来源 crown丶prince@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-09-14 16:12 厂商回复： 感稿白帽子同学关注去哪儿网安全，此域名非去哪儿网域名，是合作方的域名，修复也由合作方来修复。我们尽快通知对方进行修复处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}