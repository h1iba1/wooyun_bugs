{"id": 19303, "wybug_id": "wooyun-2012-09202", "wybug_title": "完美时空某分站短文件名泄露", "wybug_corp": "完美时空", "wybug_author": "HRay", "wybug_date": "2012-07-04 12:00", "wybug_open_date": "2012-07-04 13:09", "wybug_type": "敏感信息泄露", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄漏", "暴力猜解", "短文件名漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-04：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 完美时空某分站短文件名泄露，配合字典可以更高效率的扫出敏感文件或目录 详细说明：  完美时空某分站存在短文件名泄露，首先判断漏洞是否存在，找一个存在的文件http://perfectrisingstar.wanmei.com/Views/findpwd.aspx,利用通配符加短标签构造出http://perfectrisingstar.wanmei.com/Views/fa*~1*/.aspx访问这个地址IIS会返回给我们一个错误，大多数是bad request错误\n\n说明不存在fa开头的文件或目录，构造http://perfectrisingstar.wanmei.com/Views/fi*~1*/.aspx返回404，说明存在以fi开头的文件，利用这个特性我们仅需要对每一位循环遍历26个字母就可以获取文件短文件名称，由于短文件名的规律为前6个字符+~1-9+扩展名前三位，我们可以根据短文件名结果推测或配合字典暴力猜测文件全名，测试后缀名构造http://perfectrisingstar.wanmei.com/Views/findpw~1.*/.aspx即可\n\n有些扩展名为2个字符，我们可以用http://perfectrisingstar.wanmei.com/Views/findpw~1.%3f%3f/.aspx单独位匹配测试\n\n这里返回错误，所以后缀不是两个字符知道了原理利用poc测试，跑出以下结果\n\n   漏洞证明：  \n\n\n\n   修复方案：  升级.Net Framework到4版本   版权声明：转载请注明来源 HRay@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-07-04 13:09 厂商回复： 感谢HRay对完美世界的关注，这个站完全是第三方的，只是用了wanmei的域名，我们会在第一时间通知合作方。谢谢 漏洞Rank：3  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-04 12:31 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  ...是刚出的漏洞那个么 短文件 Microsoft IIS文件枚举漏洞？？？    \n     2012-07-04 13:03 |    \t\tHRay \t\t\t( 普通白帽子  |\t\t\t        Rank:196 漏洞数:28        | 018)\t\t \n  @king 是的    \n     2012-07-04 13:29 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  属于第三方怎么了？你们的域名洞主知道是第三方啊？上面大大的写着说‘这网站是第三方，请勿检测？’是吗？你至少也给洞主点rank在去通知第三方修复吧。真的Eggache。现在厂商一个德性..    \n     2012-07-04 13:35 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  真是与时俱进呀 这个洞也会成为刷屏洞    \n     2012-07-04 13:45 |    \t\tpfdz \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:13        | Stay hungry. Stay foolish.)\t\t \n  同样存在ddos嘛，顺带测试下好了:)    \n     2012-07-04 14:06 |    \t\tHRay \t\t\t( 普通白帽子  |\t\t\t        Rank:196 漏洞数:28        | 018)\t\t \n  @疯子 其实也没什么事，这漏洞也不值几个rank，这样也能公开利用方法，还有一个问题，你是怎么变成普通白帽子的，是要申请吗    \n     2012-07-04 14:50 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  @HRay 不知道吖...无缘无故就变这样了~.~找剑心问问    \n     2012-07-09 11:30 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  这个漏洞配合其他的漏洞一起利用，还是非常的强大 ，顶！！！    \n     2013-04-27 11:50 |    \t\t3King \t\t\t( 普通白帽子  |\t\t\t        Rank:1129 漏洞数:92        | 【study at HNUST】非常感谢大家的关注~ 大...)\t\t \n  @king 你不就是我失散多年的哥哥么……    \n     2013-07-29 14:29 |    \t\tIXY \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | 小菜来学习的)\t\t \n  @HRay 为什么我的这个利用工具只能探测6位以上的 正常这个不是只能探测6位以上文件名的吗 你那里面怎么有显示 三位的四位的    \n     2014-11-23 15:51 |    \t\tdebbbbie \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 深藏功与名 - A Rubyist)\t\t \n  @IXY 你那个也是java的工具吧？貌似匹配值不一样。那个工具更加坑爹的一点是，只能用于位数大于等于9的。。只显示6位。 难搞。除非猜出来。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}