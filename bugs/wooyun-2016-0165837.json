{"id": 76020, "wybug_id": "wooyun-2016-0165837", "wybug_title": "五彩今天酒店多个漏洞致用户敏感信息泄露", "wybug_corp": "湖南今天酒店有限公司", "wybug_author": "路人甲", "wybug_date": "2016-01-02 02:24", "wybug_open_date": "2016-02-20 15:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-20：\t细节向公众公开  简要描述： 各种姿势泄漏用户信息 详细说明：  \n\n   漏洞证明：  1.主页下载APP并添加官方微信公众号，http://**.**.**.**/\n\n1.微信里面点击注册：\n\n\n\n2.填写完信息之后点击获取验证码并抓包（信息可以随便写，包括手机号）\n\n系统将验证码发回：%d1%e9%d6%a4%c2%eb%a3%ba047466%a3%ac%c7%eb%ce%f0%b8%e6%cb%df%cb%fb%c8%cb%a3%a8%ce%e5%b7%d6%d6%d3%c4%da%d3%d0%d0%a7%a3%a9%a1%a3%a1%be%ce%e5%b2%ca%bd%f1%cc%ec%c1%ac%cb%f8%be%c6%b5%ea%a1%bf|047466|yinmidai1|DEC27FE9CD5007E43DD2EE9C7C5C2B2E将上面信息url解码\n\n之后点击个人中心系统发送发下包到系统，并返回用户信息\n\n直接访问如上urlhttp://**.**.**.**/ajax/Interface.ashx?apiname=UserInfo+&loginName=app673201512291712&Data=Tue+Dec+29+2015+19%3A29%3A51+GMT%2B0800+(CST)既可返回用户信息，尝试LoginName加单引号发现一些有趣的事情http://**.**.**.**/ajax/Interface.ashx?apiname=UserInfo+&loginName=‘发现每次请求返回的数据都不一样\n\n\n\n经过大量的返回发现返回的用户名有以下规律：用户类型1：X60006021 X60006081 X60006153用户类型2：021201502130410  021201505181179 021201510020416用户类型1前面以x6000开头，后面跟四位数字 可遍历出所有用户用户类型2前面以021开头之后是一个日期格式，通过构造也可遍历出所有用户针对第一种用户，通过burpsuite简单批量了一下：\n\n\n\n接下来针对拿到的用户登录，发现系统登录只是在cookie里面插入了一个userid 也就是只要替换userid为用户的id既可登录相应的用户http://**.**.**.**/myIndex.htm\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2016-01-08 21:15 厂商回复： CNVD确认所述漏洞情况，暂未建立与网站管理单位的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}