{"id": 88555, "wybug_id": "wooyun-2016-0212174", "wybug_title": "沈阳市社会医疗保险管理局某系统运维不当（涉及沈阳数百万市民敏感信息）                                      ", "wybug_corp": "沈阳市社会医疗保险管理局", "wybug_author": "SREAUDIO", "wybug_date": "2016-05-24 02:40", "wybug_open_date": "2016-07-10 15:20", "wybug_type": "重要敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-06-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-10：\t细节向公众公开  简要描述： 涉及沈阳数百万市民的身份证号、姓名、工作单位、医保卡的消费记录、就诊记录、身患何病等等敏感信息。 详细说明：  \n问题出现在这个站点 http://**.**.**.**/test.aspx\n一个test页面未删除，不过这个test页面权限也太大了，可以通过医保号查询任意市民的身份证号，姓名，工作单位，甚至连医保卡的消费记录何时何地在哪里买的药都有，数据量可怕。你问我怎么知道医保号，简单测试了一下，医保号是连续的，只需写个小脚本，就能遍历全部信息。默认界面是这样的，可以看到每个查询接口有默认的参数（不是我输入的）：\n\n直接执行这些数据，得到的结果是这样的：\n\n简单分析一下，左边查询的参数基本都是医保卡号，除了中间有一个8位的应该是单位编号。具体数据的意义再说明一下，个人信息这一栏泄露身份证号、真实姓名和工作单位。1600这一栏是消费记录，后面201406是消费年月，不信的话看下图：\n\n还有比较敏感的信息就是最后2000这一栏，看一下信息说明，特病审批信息：\n\n至于数据量有多大，也很好测试，直接拿个人信息这一栏做测试：\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n几百万信息肯定是有的，猜的没错医保号是一个个递增的，试了很多随机数字都有。   漏洞证明：  手注了一下，应该是存在注入的，但是有狗，水平有限没能过的去。不过这都已经开放查询接口了，不注入利用也很简单，只需写个小脚本就可以爬出所有信息了。声明一下，绝对没有爬过数据。   修复方案：  漏洞简单但是危害很大，望重视。   版权声明：转载请注明来源 SREAUDIO@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2016-05-26 15:15 厂商回复： CNVD未直接复现所述情况，按照漏洞报送者所述情况整理通报，转由CNCERT下发给辽宁分中心，由分中心后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}