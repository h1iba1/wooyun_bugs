{"id": 86568, "wybug_id": "wooyun-2016-0182087", "wybug_title": "海洋石油HES.HOME APP后台弱口令任意文件上传导致getshell", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "倚笑趁风凉", "wybug_date": "2016-03-08 03:30", "wybug_open_date": "2016-04-25 16:53", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "后台弱口令"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-03-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-03-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-04-25：\t细节向公众公开  简要描述： 海洋石油HES.HOME APP后台弱口令并且任意文件上传导致getshell 详细说明：  介于两次审核未通过我表示这次我要事无巨细的写详细一点。C段扫描发现此主机ip:**.**.**.**漏洞url:http://**.**.**.**/service \n\n感觉像任意文件读取，但是权限控制职能看到web目录结构。但也是重要信息。路径爆破发现后台登陆url:http://**.**.**.**/web/login.html\n\n弱口令:admin admin 登陆后台。登陆后台寻找上传点\n\n发现上传apk的文件上传可以截包绕过前台js检测（ps在这之前尝试使用广告管理里的图片上传上传shell发现截包绕过js检测，但是在image目录下不解析asp文件）。\n\n（注:截图中详解）\n\n\n\n可见任意文件上传成功。shell地址:http://**.**.**.**/web/upload/file/20160308/98106aa7-af55-448e-9106-b55f413872a9.asp\n\n执行系统命令，sys权限\n\n通过shell获取服务器应用代码，发现此后台是海油集团app的一个后台控制系统。其app登录url:http://**.**.**.**/hyweb/WEB/\n\n通过注册登录（可惜的是短信验证码不存在重放，3次验证码后台写有时间间隔）app页面展示为海油集团旗下app\n\n详尽描述，请审核认真理清逻辑。另敏感url请打码。shell请海油集团管理员自行删除。   漏洞证明：  执行系统命令，sys权限\n\n通过shell获取服务器应用代码，发现此后台是海油集团app的一个后台控制系统。app页面展示为海油集团旗下app\n\n   修复方案：  修复你们更专业。   版权声明：转载请注明来源 倚笑趁风凉@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2016-03-11 16:53 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向能源行业信息化主管部门通报,由其后续协调网站管理单位处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}