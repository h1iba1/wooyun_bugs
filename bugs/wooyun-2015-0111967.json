{"id": 27892, "wybug_id": "wooyun-2015-0111967", "wybug_title": "百度应用设计缺陷导致可随意构造baidu.com域xss", "wybug_corp": "百度", "wybug_author": "s0mun5", "wybug_date": "2015-05-04 16:09", "wybug_open_date": "2015-06-19 15:22", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-19：\t细节向公众公开  简要描述： 百度应用设计缺陷导致可随意构造baidu.com域xss 详细说明：  我们在百度搜索 “linux命令大全”会出现一个百度应用\n\n而这个应用存在注入漏洞，按理说不是百度的错误\n\n然而当我们把注入点写成 xss代码的hex后\n\n会直接弹出百度域的cookie这是为什么呢 我们看一下流程这个应用的原始url是linuxso.duapp.com这样cookie肯定不是baidu域的   漏洞证明：  但是在百度搜索结果中显示时做了一次代理就变成了 https://sp0.baidu.com/5aU_bSa9KgQFm2e88IuM_a/linuxso.duapp.com/index.php?key=ls%27+and+1=2+union+select+1,0x3c7363726970743e616c65727428646f63756d656e742e636f6f6b6965293c2f7363726970743e%23\n\n这样的结果大家都知道了吧这只是一个例子如果我们任意伪造一个app上线并且是包含明显的漏洞，那么就可以随意构造baidu.com的xss了   修复方案：  重新设计流程   版权声明：转载请注明来源 s0mun5@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-05-05 15:21 厂商回复： 感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-04 16:11 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  .......    \n     2015-05-04 16:12 |    \t\t孤独行者 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:44        | 时光如水，总是无言。你若安好，便是晴天)\t\t \n  .......    \n     2015-05-04 16:14 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  有点意思    \n     2015-05-04 16:15 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  有意思    \n     2015-05-04 16:23 |    \t\t′雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  有思    \n     2015-05-04 16:24 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  有    \n     2015-05-04 16:26 |    \t\tanswer \t\t\t( 普通白帽子  |\t\t\t        Rank:347 漏洞数:45        | 答案)\t\t \n  …    \n     2015-05-04 16:26 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  敢问楼上，我的台词是什么    \n     2015-05-04 16:28 |    \t\tJiuShao \t\t\t( 普通白帽子  |\t\t\t        Rank:405 漏洞数:94        | ╮(╯▽╰)╭锄禾日当午)\t\t \n  有意思    \n     2015-05-04 16:33 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @sogoli     \n     2015-05-04 16:34 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @sogili     \n     2015-05-04 16:34 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  有点意思    \n     2015-05-04 16:40 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  我是过来发呆的    \n     2015-05-04 16:41 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  这是不是玩烂的那个?    \n     2015-05-04 16:46 |    \t\t浮世浮城 \t\t\t( 普通白帽子  |\t\t\t        Rank:284 漏洞数:60        | 我存于这俗世烟火的浮世，我爱这时光倒影的...)\t\t \n  都闪开……快闪开，我要赞他，这个人是我兄弟，他五岁破了对门小女孩处，六岁去勾引隔村那个张寡妇，七岁在情界横扫千军。八岁嫖完各大妓院，九岁学会了人兽交杂。十岁打倒无数飞机，十一岁迷奸无数少女，十二岁强奸无数的村姑。十三岁喜欢上凤姐，十四岁爱上如花，十五岁退出这个行业。十六岁自宫了。十七岁他得到全国通报，得奖为精王，十八岁隐藏山林，是什么让他如此的放弃自己，内疚还是爱情………反正我要赞他！楼下注意队形    \n     2015-05-04 18:00 |    \t\tizy \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:22        | http://1zy.pw/)\t\t \n  有意思    \n     2015-05-04 19:10 |    \t\tD_in \t\t\t( 普通白帽子  |\t\t\t        Rank:413 漏洞数:62        | 到我嘴里来)\t\t \n  有思    \n     2015-05-05 11:21 |    \t\txtnnd \t\t\t( 普通白帽子  |\t\t\t        Rank:180 漏洞数:43        )\t\t \n  有屎    \n     2015-06-19 22:56 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  有意思    \n     2015-06-20 00:45 |    \t\tq601333824 \t\t\t( 普通白帽子  |\t\t\t        Rank:217 漏洞数:49        | 出自《丹特丽安的书架》---吾问汝,汝为人否...)\t\t \n  思意有    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}