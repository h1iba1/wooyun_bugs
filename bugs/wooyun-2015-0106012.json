{"id": 34595, "wybug_id": "wooyun-2015-0106012", "wybug_title": "某药店系统一处SQL注入", "wybug_corp": "杭州珍诚网络科技有限公司", "wybug_author": "岩少", "wybug_date": "2015-04-08 11:32", "wybug_open_date": "2015-07-09 18:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向公众公开  简要描述： RT 详细说明：  杭州珍诚网络科技有限公司官网:http://www.zc511.com/说明一下这个注入很鸡肋。需要注册才能注入。而且还是Get请求。这是一个购物车里产生的漏洞。看案例如下：http://www.zjrrt.com/addProductShoppingCart.do?amount=1&productID=248926                 注册的账号ceshi123456 123456http://www.smdyf.cn/addProductShoppingCart.do?amount=1&productID=148596                  注册的账号ceshi123456 123456http://www.ewj2009.com/addProductShoppingCart.do?amount=1&productID=248926http://www.46buy.com/addProductShoppingCart.do?amount=1&productID=248926http://www.hnjbyy.cn/addProductShoppingCart.do?amount=1&productID=248926http://www.hnlbxdyf.com/addProductShoppingCart.do?amount=1&productID=248926http://test.gxjjls.com/addProductShoppingCart.do?amount=1&productID=248926http://test.hzyibai.com/addProductShoppingCart.do?amount=1&productID=248926说明一下.我就注册了两个。其他的都存在这样的问题。比较麻烦而已。请看productID=248926这个参数。后面的值一定注意。必须是药店商品的值,而且必须有货。我演示一下\n\n2.然后我们这个连接http://www.smdyf.cn/addProductShoppingCart.do?amount=1&“productID=148596” 这里就是上面的那个值了。我就测试一个注入。1.测试注入：http://www.smdyf.cn/addProductShoppingCart.do?amount=1&productID=148596抓的包如下：GET /addProductShoppingCart.do?amount=1&productID=148596 HTTP/1.1Host: www.smdyf.cnProxy-Connection: keep-aliveAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8User-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/35.0.1916.153 Safari/537.36Accept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=C0AF0179A41F860AEE9DF67784D013E9; pgv_pvi=4297144320; pgv_si=s1353802752; jiathis_rdc=%7B%22http%3A//www.smdyf.cn/getProductInfo.do%3FproductId%3D148357%22%3A-163299437%2C%22http%3A//www.smdyf.cn/getProductInfo.do%3FproductId%3D149908%22%3A-163215445%2C%22http%3A//www.smdyf.cn/getProductInfo.do%3FproductId%3D149901%22%3A-163211192%2C%22http%3A//www.smdyf.cn/product/149921%22%3A-163206448%2C%22http%3A//www.smdyf.cn/product/149917%22%3A-163202082%2C%22http%3A//www.smdyf.cn/product/149920%22%3A-163198263%2C%22http%3A//www.smdyf.cn/getProductInfo.do%3FproductId%3D149921%22%3A-163192592%2C%22http%3A//www.smdyf.cn/getProductInfo.do%3FproductId%3D149758%22%3A0%7C1417176019794%2C%22http%3A//www.smdyf.cn/getProductInfo.do%3FproductId%3D148596%22%3A%220%7C1417176031359%22%7D; hisProduct=%5B%7B%22reURL%22%3A%22http%3A%2F%2Fwww.smdyf.cn%2FgetProductInfo.do%3FproductId%3D148357%22%2C%22imageURL%22%3A%22http%3A%2F%2Ftest.smdyf.cn%2Fproduct_small_pic%2Fs1172.jpg%22%2C%22title%22%3A%22%E8%82%A4%E7%97%92%E9%A2%97%E7%B2%92%22%2C%22price%22%3A%2225.20%22%7D%2C%7B%22reURL%22%3A%22http%3A%2F%2Fwww.smdyf.cn%2FgetProductInfo.do%3FproductId%3D149908%22%2C%22imageURL%22%3A%22http%3A%2F%2Ftest.smdyf.cn%2Fproduct_small_pic%2Fs44630.jpg%22%2C%22title%22%3A%22%E6%B1%A4%E8%87%A3%E5%80%8D%E5%81%A5%E6%B6%B2%E4%BD%93%E9%92%99%E8%BD%AF%E8%83%B6%E5%9B%8A%22%2C%22price%22%3A%2298.00%22%7D%2C%7B%22reURL%22%3A%22http%3A%2F%2Fwww.smdyf.cn%2FgetProductInfo.do%3FproductId%3D149901%22%2C%22imageURL%22%3A%22http%3A%2F%2Ftest.smdyf.cn%2Fproduct_small_pic%2Fs3417.jpg%22%2C%22title%22%3A%22%E6%B1%A4%E8%87%A3%E5%80%8D%E5%81%A5%E7%BB%B4%E7%94%9F%E7%B4%A0C%22%2C%22price%22%3A%22118.00%22%7D%2C%7B%22reURL%22%3A%22http%3A%2F%2Fwww.smdyf.cn%2FgetProductInfo.do%3FproductId%3D149921%22%2C%22imageURL%22%3A%22http%3A%2F%2Ftest.smdyf.cn%2Fproduct_small_pic%2Fs3456.jpg%22%2C%22title%22%3A%22%E6%B4%8B%E5%8F%82%E5%90%AB%E7%89%87(%E5%BA%B7%E5%AF%8C%E6%9D%A5)%22%2C%22price%22%3A%228.40%22%7D%2C%7B%22reURL%22%3A%22http%3A%2F%2Fwww.smdyf.cn%2FgetProductInfo.do%3FproductId%3D149758%22%2C%22imageURL%22%3A%22http%3A%2F%2Ftest.smdyf.cn%2Fproduct_small_pic%2Fs3077.jpg%22%2C%22title%22%3A%22%E5%AE%9D%E6%B6%A6%E9%80%9A%E5%86%B2%E5%89%82%22%2C%22price%22%3A%2230.00%22%7D%2C%7B%22reURL%22%3A%22http%3A%2F%2Fwww.smdyf.cn%2FgetProductInfo.do%3FproductId%3D148596%22%2C%22imageURL%22%3A%22http%3A%2F%2Ftest.smdyf.cn%2Fproduct_small_pic%2Fs11859.jpg%22%2C%22title%22%3A%22%E6%84%9F%E5%86%92%E7%81%B5%E9%A2%97%E7%B2%92%22%2C%22price%22%3A%225.50%22%7D%5D; CNZZDATA3425515=cnzz_eid%3D1063865882-1417175881-%26ntime%3D1417175881\n\n\n\n   漏洞证明：  \n\n\n\n   修复方案：  参数过滤。   版权声明：转载请注明来源 岩少@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-04-10 18:41 厂商回复： 暂未建立与软件生产厂商（或网站管理单位）的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}