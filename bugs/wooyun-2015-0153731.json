{"id": 81417, "wybug_id": "wooyun-2015-0153731", "wybug_title": "iwebshop 盲注一枚（附exp）demo复现", "wybug_corp": "www.jooyea.cn", "wybug_author": "一只寂寞的小鸟", "wybug_date": "2015-11-23 12:53", "wybug_open_date": "2015-12-17 14:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-26：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2016-01-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 这下有exp了 不鸡肋了 求过 多谢猪猪侠的美丽说盲注脚本  详细说明：  simper控制器下的 find_password_mobile方法//手机短信找回密码\tfunction find_password_mobile()\t{\t\t$username = IReq::get('username');\t\tif($username === null || !Util::is_username($username)  )\t\t{\t\t\tIError::show(403,\"请输入正确的用户名\");\t\t}\t\t$mobile = IReq::get(\"mobile\");\t\tif($mobile === null || !IValidate::mobi($mobile))\t\t{\t\t\tIError::show(403,\"请输入正确的电话号码\");\t\t}\t\t$mobile_code = IReq::get('mobile_code');\t\tif($mobile_code === null)\t\t{\t\t\tIError::show(403,\"请输入短信校验码\");\t\t}\t\t$userDB = new IModel('user as u , member as m');\t\t$userRow = $userDB->getObj('u.username = \"'.$username.'\" and m.mobile = \"'.$mobile.'\" and u.id = m.user_id');\t\tif($userRow)\t\t{\t\t\t$findPasswordDB = new IModel('find_password');\t\t\t$dataRow = $findPasswordDB->getObj('user_id = '.$userRow['user_id'].' and hash = \"'.$mobile_code.'\"');\t\t\tif($dataRow)\t\t\t{\t\t\t\t//短信验证码已经过期\t\t\t\tif(time() - $dataRow['addtime'] > 3600)\t\t\t\t{\t\t\t\t\t$findPasswordDB->del(\"user_id = \".$userRow['user_id']);\t\t\t\t\tIError::show(403,\"您的短信校验码已经过期了，请重新找回密码\");\t\t\t\t}\t\t\t\telse\t\t\t\t{\t\t\t\t\t$this->redirect('/simple/restore_password/hash/'.$mobile_code); \t\t\t\t}\t\t\t}\t\t\telse\t\t\t{\t\t\t\tIError::show(403,\"您输入的短信校验码错误\");\t\t\t}\t\t}\t\telse\t\t{\t\t\tIError::show(403,\"用户名与手机号码不匹配\");\t\t}\t}gpc开了等于没开。 他会把反斜杠去掉 然后用自己的方法去过滤注入 利用条件 能注册普通会员即可 废话。mobile_code 这个方法没过滤   漏洞证明：  \n\n本地测试\n\n这是百度找的一个站  没设置发包间隔时间  但是看到还是出来了。看下demo 设置了发包间隔时间 返回有点慢额  貌似不太对 一会能访问一会不能访问 好烦 就这样看吧（貌似我写的代码也有问题 →_→ 见谅）\n\nPOSThttp://**.**.**.**/index.php?controller=simple&action=find_password_mobileusername=123321&mobile=18900890089&mobile_code=123   修复方案：  过滤   版权声明：转载请注明来源 一只寂寞的小鸟@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-11-23 13:58 厂商回复： 感谢提交，我们会尽快修正 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}