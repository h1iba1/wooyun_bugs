{"id": 21100, "wybug_id": "wooyun-2015-0131623", "wybug_title": "看我如何远程黑掉KTV点歌台（弹幕/切歌、点歌等操作）", "wybug_corp": "雷石-中国最大的VOD供应商", "wybug_author": "路人甲", "wybug_date": "2015-08-04 17:50", "wybug_open_date": "2015-09-18 17:50", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "逻辑错误", "认证设计不合理", "设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-04：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-09-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 某天，几个妹子非拉着一起去唱歌，唱了好几个小时好累哦。过程中演示了下如何远程控制KTV的点歌台，可远程切掉其他ktv的歌曲神马的。结果玩了， 妹子们说邀请我跟去她们家里玩，说她们家里网络好，说要教她们一起玩这个...我那么机智，我怎么会上当，家里还有众测项目没刷完呢... 详细说明：  雷石早在1997年就与微软合作开发“维纳斯计划”，直到目前为止，仍然是微软在中国唯一一家合作开发的公司，目前有员工人数1000多人。雷石拥有最前沿的嵌入式技术，同时拥有一支年轻的系统分析、软件开发和技术支持队伍，由众多资深的技术专家和有多年行业开发经验的工程师组成。多年来，雷石始终致力于开发专业的嵌入式VOD视频点播设备——机顶盒以及专业的VOD视频点播软件，又结合KTV娱乐服务行业的特殊需求不断完善，使设备从软件到硬件都更符合KTV娱乐服务行业的需求，同时拥有最完善周到的售后服务。截至2006年9月，雷石共承接国内外KTV项目工程已经突破10000个，客户遍布全国三十三个省市自治区以及英国、马来西亚等地，是我们最大、最珍贵的经验宝库。客户皆对雷石赞誉有加，不仅肯定了我们的努力，而且给了我们很大的动力。首先，我们了解下这是个什么东西。首先要保证雷石点歌系统支持无线点歌，微信里面：通讯录--添加--查找公众账号--雷石点歌台--关注；在微信公众号雷石点歌机的对话框中输入电视电视画面上的数字码，提示绑定成功后，即可点歌开唱！雷石提供了开放的接口，酷我等APP都可以选择加入，而且除了点歌之外，雷石还将开放更多的功能，比如打分、切歌、送礼物等等。这些功能目前在雷石自己开发的“雷石点歌台”微信公众号中可以实现，关注这个账号之后，回复一串特定的数字绑定房间点歌系统，便可以在微信中点歌、切歌、点赞，不同用户各自点歌互不影响。2.线上线下互动“雷石点歌台”中提供了一些简单的互动，给演唱者点赞、扔屎或者送礼物，这些操作都会出现在KTV屏幕上。大概是这样的一个东西。\n\n打开链接后，发现是这样的一个东西。\n\n原来只需要输入8位数字的房台码即可，每个包间的点歌设备对应的一个8位数字ID。burpsuite爆破开启。\n\n刚开始，不到10秒钟就出现2个可用的房间号了。43003741011false76044885741011false76079000941011false760108880311011false7601088个请求，4个存在， 平均250次请求就有1个存在。。。我们使用测试出来的id，进行测试演练。\n\n比如：03741011通过查看包房信息，显示，这个KTV是在云南普洱市的一家KTV（建花园KTV吖19包房）\n\n大概坐标是在这里：\n\n看到这里来了。。。。。能点歌、切歌，各种控制功能啊。   漏洞证明：  在这么激动的日子里，肯定要点一首靠谱的歌曲。。就选个  难忘今宵吧。。\n\n打开未唱清单看看。。。\n\n结果，手一斗，一不小心就点了3次。真是对不住啊。。果断帮人家切了下歌曲测试下。。如下图：\n\n\n\n\n\n最终实现的效果，大概是这样子。\n\n然后 包房说说：输入框 没有过滤，存在xss漏洞。。。\n\n   修复方案：  每个房间限制次数。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2015-08-04 17:52 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  来一首忠诚的赞歌    \n     2015-08-04 17:57 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:134        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  来一首小苹果。    \n     2015-08-04 20:07 |    \t\t李叫兽就四李叫兽 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:8        | 啦啦啦啦)\t\t \n  果盘能黑吗？    \n     2015-08-04 20:10 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:4        | 心若没有栖息的地方，走到哪里都是在流浪。)\t\t \n  楼主，来个大保健。    \n     2015-08-05 11:44 |    \t\tExpl0r3r \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:13        | 野心大过高潮)\t\t \n  楼主，来个大保健。    \n     2015-08-05 22:07 |    \t\t毕月乌 \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:10        | 猜猜我是谁？)\t\t \n  我只看到了“妹子们”    \n     2015-08-07 13:07 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:74        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  来一首大悲咒    \n     2015-09-19 00:02 |    \t\tMark \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 渗透你的心)\t\t \n  这个不错    \n     2015-09-20 23:02 |    \t\ttSt \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:3        | 在开发里运维最强，运维里网络最强，网络里...)\t\t \n  我只看到了“妹子们”    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}