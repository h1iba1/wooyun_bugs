{"id": 62703, "wybug_id": "wooyun-2013-034670", "wybug_title": "某保险客户分析系统struts2命令执行漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "YY-2012", "wybug_date": "2013-08-21 11:27", "wybug_open_date": "2013-10-05 11:27", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行", "补丁不及时", "远程代码执行", "数据库信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-05：\t细节向公众公开  简要描述： 某保险客户分析系统struts2命令执行漏洞，导致多个数据库密码泄漏 详细说明：  上海保险客户分析系统http://114.80.84.105/fna/login.action已上传的shell密码nintyhttp://114.80.84.105/fna/guige.jsp   漏洞证明：  \n\n\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?><beans xmlns=\"http://www.springframework.org/schema/beans\"\txmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:tx=\"http://www.springframework.org/schema/tx\"\txsi:schemaLocation=\"       http://www.springframework.org/schema/beans       http://www.springframework.org/schema/beans/spring-beans-2.5.xsd       http://www.springframework.org/schema/tx       http://www.springframework.org/schema/tx/spring-tx-2.5.xsd\">\t<bean class=\"org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor\"/> \t<!-- Oracle DataSource ��������������� -->\t <!-- <bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\" destroy-method=\"close\">\t\t <property name=\"driverClassName\" value=\"oracle.jdbc.driver.OracleDriver\"></property> \t\t <property name=\"url\" value=\"jdbc:oracle:thin:@192.168.21.86:1521:DEXTRYS\"></property>\t\t <property name=\"username\" value=\"ebofna\"></property>\t\t <property name=\"password\" value=\"admin\"></property>\t\t -->\t\t <!--\t\t <property name=\"url\" value=\"jdbc:oracle:thin:@114.80.84.106:15210:ora220\"></property>\t\t <property name=\"username\" value=\"fna_prod\"></property>\t\t <property name=\"password\" value=\"fna_prodpwd\"></property>\t\t -->\t\t <!-- \t\t <property name=\"url\" value=\"jdbc:oracle:thin:@114.80.84.106:15210:ora220\"></property>\t\t <property name=\"username\" value=\"fna_uat\"></property>\t\t <property name=\"password\" value=\"fna_uat\"></property>\t\t  -->\t\t <!-- \t\t <property name=\"url\" value=\"jdbc:oracle:thin:@192.168.21.147:1521:DEXTRYS\"></property>\t\t <property name=\"username\" value=\"ebofnatest\"></property>\t\t <property name=\"password\" value=\"ebofnatest\"></property> \t </bean> \t -->\t<!-- MySql Datasource ���������������\t<bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\" destroy-method=\"close\">\t\t<property name=\"driverClassName\" value=\"com.mysql.jdbc.Driver\"/>\t\t<property name=\"url\" value=\"jdbc:mysql://localhost:3306/ebaofna\"/>\t\t<property name=\"username\" value=\"root\"/>\t\t<property name=\"password\" value=\"admin\"/>\t</bean>  \t-->   \t <!-- Microsoft SQL Server DataSource ��������������� \t\t<bean id=\"datasource\" class=\"org.springframework.jdbc.datasource.DriverManagerDataSource\">\t\t\t<property name=\"driverClassName\" value=\"net.sourceforge.jtds.jdbc.Driver\"/> \t\t\t<property name=\"url\" value=\"jdbc:jtds:sqlserver://localhost:1433/������������\"/>\t\t\t<property name=\"username\" value=\"sa\" />\t\t    <property name=\"password\" value=\"sa\" />\t\t</bean>\t --> <bean id=\"propertyConfigurer\"       class=\"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer\">  <property name=\"location\" value=\"classpath:/db.properties\"/> </bean>\t   \t<!-- JNDI DataSource ���������������    FNA_fna���������������������Datasource��������������� -->\t<bean id=\"dataSource\" class=\"org.springframework.jndi.JndiObjectFactoryBean\">\t\t<property name=\"jndiName\">\t\t\t<value>${iam.jndi.name}</value>\t\t</property>\t\t<property name=\"resourceRef\"> \t\t\t<value>false</value>\t\t</property> \t\t<property name=\"jndiEnvironment\"> \t\t\t<props> \t\t\t\t<prop key=\"java.naming.provider.url\">${java.naming.provider.url}</prop>\t\t\t\t<prop key=\"java.naming.factory.initial\">${java.naming.factory.initial}</prop> \t\t\t</props> \t\t</property> \t</bean> \t<!-- JNDI DataSource ���������������  (FNA_uat���������������Datasource ���������������)\t<bean id=\"dataSource\" class=\"org.springframework.jndi.JndiObjectFactoryBean\">\t\t<property name=\"jndiName\">\t\t\t<value>ebaoDs</value>\t\t</property>\t\t<property name=\"resourceRef\"> \t\t\t<value>false</value>\t\t</property> \t\t<property name=\"jndiEnvironment\"> \t\t\t<props> \t\t\t\t<prop key=\"java.naming.provider.url\">t3://192.168.154.225:7001</prop>\t\t\t\t<prop key=\"java.naming.factory.initial\">weblogic.jndi.WLInitialContextFactory</prop> \t\t\t</props> \t\t</property> \t</bean>\t  -->\t<!-- JPA EntityManagerFactoryBean for EntityManager -->    \t<bean id=\"entityManagerFactory\" class=\"org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean\">    \t\t<property name=\"persistenceXmlLocation\" value=\"classpath:META-INF/persistence.xml\" />    \t\t<property name=\"persistenceUnitName\" value=\"HibernateJPAPU\" />    \t\t<property name=\"dataSource\" ref=\"dataSource\" />    \t</bean>     \t<!-- Transaction manager for JPA -->    \t<bean id=\"transactionManager\" class=\"org.springframework.orm.jpa.JpaTransactionManager\">    \t\t<property name=\"entityManagerFactory\">    \t\t\t<ref bean=\"entityManagerFactory\" />    \t\t</property>    \t</bean>     \t<!-- ��������������������� --> <tx:annotation-driven transaction-manager=\"transactionManager\"/> </beans>   修复方案：  补丁修改数据库连接密码   版权声明：转载请注明来源 YY-2012@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-08-26 00:07 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}