{"id": 57681, "wybug_id": "wooyun-2014-053672", "wybug_title": "Hi捞汇（海底捞）设计缺陷可重置任何手机用户登陆密码", "wybug_corp": "haidilao.com", "wybug_author": "PythonPig", "wybug_date": "2014-03-18 16:52", "wybug_open_date": "2014-03-28 12:37", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 海底捞设计缺陷可重置任何手机用户登陆密码 详细说明：  假设自己注册的帐号为A， 想要重置帐号为B的密码（A、B都是手机注册或手机绑定用户）1、找回密码的URL: http://hi.haidilao.com/pages/haidl/alter_password_phone.jsp，如下图所示，在找回密码的第一步填写帐号A的手机号和手机收到的验证码：\n\n2、点击“找回”，此时一定要用软件拦截住这个request请求，并把A的手机号改为B的手机号，修改完成后把拦截取消，使该请求正常发送至服务器（这是第一次拦截，且本次拦截只拦截一条请求）如下图：\n\n3、在找回密码的第三步，填写新的密码（重置后B的密码）并点击“确定”按钮，并用拦截软件拦截该请求\n\n（这是第二次拦截，也是最后一次，且本次拦截只拦截一条请求）,把myphone的值改为B的电话号码（即把A的号码改为B的号码），然后取消拦截，使被修改后的请求正常发送至服务器，如下图所示：\n\n4、最后成功在B不知情的情况下修改其密码，并可以成功登陆。\n\n   漏洞证明：  见详细说明   修复方案：     版权声明：转载请注明来源 PythonPig@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-03-28 12:37 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-21 10:40 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  爆破还是逻辑？    \n     2014-03-21 11:01 |    \t\tPythonPig \t\t\t( 普通白帽子  |\t\t\t        Rank:491 漏洞数:71        | 只会简单工具的小小菜)\t\t \n  @魇 逻辑，真心求带啊，您才是密码杀手啊，我刚开始学相关的东西    \n     2014-03-21 11:08 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  @PythonPig 囧 我自己也菜 看标题的话你这个跟我之前提交的那个有点类似，但愿没重复..    \n     2014-03-21 13:40 |    \t\tPythonPig \t\t\t( 普通白帽子  |\t\t\t        Rank:491 漏洞数:71        | 只会简单工具的小小菜)\t\t \n  @魇 没事，你那个在前面，呵呵~你现在都是密码杀手了~    \n     2014-03-29 13:12 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  重复了..    \n     2014-03-29 18:46 |    \t\tPythonPig \t\t\t( 普通白帽子  |\t\t\t        Rank:491 漏洞数:71        | 只会简单工具的小小菜)\t\t \n  怪不得给忽略了呢~~哈哈    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}