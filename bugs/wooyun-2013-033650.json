{"id": 9523, "wybug_id": "wooyun-2013-033650", "wybug_title": "17k小说网waf防护存在缺陷可绕过（1600万用户信息告急）", "wybug_corp": "17k小说网", "wybug_author": "猪猪侠", "wybug_date": "2013-08-06 17:24", "wybug_open_date": "2013-09-20 17:25", "wybug_type": "用户资料大量泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["补丁绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-20：\t细节向公众公开  简要描述： 由于WAF拦截规则存在设计缺陷，导致可绕过继续OOXX。 详细说明：  17k小说网在处理struts2漏洞时，只是简单的写了个WAF拦截规则，过滤掉相关攻击行为。但这个WAF只是简单的过滤的用户的GET请求数据，POST数据并未处理，所以导致命令执行漏洞依然存在。# 挑选两个典型的\nhttp://search.17k.com/query.dohttp://manager.17k.com/login.action\n# 获取WEBROOT、执行命令\n\n\n\n\n\n# 核心数据库配置\n<bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\" destroy-method=\"close\">        <property name=\"driverClassName\" value=\"com.mysql.jdbc.Driver\" />        <property name=\"url\" value=\"jdbc:mysql://db.17k.com:3306/chi*****ll?useUnicode=true&amp;characterEncoding=utf8&amp;autoReconnect=true\" />        <property name=\"username\" value=\"chi*****ll\" />        <property name=\"password\" value=\"cha*************\" />        <property name=\"maxActive\" value=\"20\"/>        <property name=\"maxIdle\" value=\"10\"/>        <property name=\"maxWait\" value=\"1000\"/>\n   漏洞证明：  # 1600万用户\n\n \n\n# 涉及用户信息\n\n   修复方案：  #1 WAF针对所有类型的客户端请求进行安全过滤。#2 更新官方补丁：http://struts.apache.org/release/2.3.x/docs/s2-016.htmlhttp://struts.apache.org/release/2.3.x/docs/s2-017.htm   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-08-06 18:25 厂商回复： 十分感谢你关注17k网站，祝您身体健康，工作愉快，多谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-06 17:29 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  16000000 ...    \n     2013-08-06 17:33 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  @疯狗 这么多人看小说？    \n     2013-08-06 17:33 |    \t\tHxai11 \t\t\t( 普通白帽子  |\t\t\t        Rank:1137 漏洞数:218        | 于是我们奋力向前游，逆流而上的小舟，不停...)\t\t \n  @疯狗 我会告诉你我曾经连接过他们数据库吗？嘻嘻嘻嘻    \n     2013-08-06 17:39 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @疯狗 我会告诉你这里面有15000000是我的测试账号么....    \n     2013-08-06 17:43 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @Hxai11 没瞧见，不信    \n     2013-08-06 17:47 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  洞主怎么知道有waf    \n     2013-08-06 17:51 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n   = =1600万  一半的测试帐号？......表示我从来不看小说 不看小说的楼下举个手    \n     2013-08-06 17:54 |    \t\tdyun \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:15        | [code][/code])\t\t \n  @xsser 标题不是waf存在缺陷，可绕过,不知道有waf,dz怎么绕过的...    \n     2013-08-06 18:02 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  原来宅男屌丝群体这么大了    \n     2013-08-06 19:03 |    \t\tGrayTrack \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:14        | 灰色轨迹)\t\t \n  黑哥，人家要看xxoo小说的啊    \n     2013-08-06 19:40 |    \t\tfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:664 漏洞数:79        | 想刷个6D)\t\t \n  几个零啊，1234567890好多    \n     2013-08-06 21:41 |    \t\t有妹子送上 \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:28        | 杭州最帅的男人)\t\t \n  求刷凹凸票，贵宾票    \n     2013-08-07 18:08 |    \t\tSpid3r \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:10        | 常年撒网打鱼.)\t\t \n  祝洞主身体健康...工作愉快...     哈哈    \n     2013-09-09 01:48 |    \t\t银冥币 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:21        | \"/upload/avatar/avatar_251_b.jpg\" />)\t\t \n  绕过...    \n     2013-11-14 13:10 |    \t\tfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:664 漏洞数:79        | 想刷个6D)\t\t \n  这图是不是暴露了你把人家裤子给脱了    \n     2013-12-15 12:47 |    \t\t风风 \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:43        | 。)\t\t \n  @feng 你以为猪哥稀罕他的1600万的库啊。猪哥google的库都有  不上亿根本上不上的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}