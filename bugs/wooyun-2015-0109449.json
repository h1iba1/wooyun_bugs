{"id": 33171, "wybug_id": "wooyun-2015-0109449", "wybug_title": "天天果园某处任意用户密码重置", "wybug_corp": "fruitday.com", "wybug_author": "xlz0iza1", "wybug_date": "2015-04-22 11:46", "wybug_open_date": "2015-06-06 13:12", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-06：\t细节向公众公开  简要描述： RT 详细说明：  Url:http://m.fruitday.com/login触屏版的地方这里注册用户的时候发送的验证码是四位的，密码重置也是四位的。注册抓包：\nPOST /ajax/register HTTP/1.1Host: m.fruitday.comProxy-Connection: keep-aliveContent-Length: 68Accept: application/json, text/javascript, */*; q=0.01Origin: http://m.fruitday.comX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.111 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://m.fruitday.com/registerAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: PHPSESSID=916jkh5hu99jopfqd5ost6sgq7; Hm_lvt_4fcef85541447c750b4753df83ff1a32=1429544216; _ga=GA1.2.1839032413.1429542473; Hm_lvt_2296b146cc501cc0082dddd0d1f1b434=1429544226,1429544261,1429544269,1429604053; Hm_lpvt_2296b146cc501cc0082dddd0d1f1b434=1429604155Connection: closemobile=15288888888&password=***&re_password=***&identcode=0168\n重置密码抓包：\nPOST /ajax/login/forgetps HTTP/1.1Host: m.fruitday.comProxy-Connection: keep-aliveContent-Length: 68Accept: application/json, text/javascript, */*; q=0.01Origin: http://m.fruitday.comX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_9_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.111 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://m.fruitday.com/login/forgetpsAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: PHPSESSID=916jkh5hu99jopfqd5ost6sgq7; Hm_lvt_4fcef85541447c750b4753df83ff1a32=1429544216; _ga=GA1.2.1839032413.1429542473; Hm_lvt_2296b146cc501cc0082dddd0d1f1b434=1429544226,1429544261,1429544269,1429604053; Hm_lpvt_2296b146cc501cc0082dddd0d1f1b434=1429604577mobile=15288888888&password=123456&re_password=123456&identcode=1111\n   漏洞证明：  用自己手机收到的验证码，注册和重置密码都是四位数的。\n\n用手机号：15288888888测试一下注册。\n\n成功注册。\n\n然后重置密码试试。\n\n   修复方案：     版权声明：转载请注明来源 xlz0iza1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-04-22 13:10 厂商回复： 非常感谢您提供的漏洞！我们会尽快修复，谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}