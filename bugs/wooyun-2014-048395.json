{"id": 59156, "wybug_id": "wooyun-2014-048395", "wybug_title": "TCCMS SQL注入漏洞3(盲注鸡肋)", "wybug_corp": "teamcen.com", "wybug_author": "xfkxfk", "wybug_date": "2014-01-09 18:17", "wybug_open_date": "2014-04-09 18:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "数字类型注射", "逻辑错误", "安全意识不足", "源码审核", "注射漏洞利用技巧", "源码分析", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-16：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-09：\t细节向公众公开  简要描述： TCCMS SQL注入漏洞3(盲注) 详细说明：  在删除文章时：app/controller/news.class.php\npublic function delete() {\t\t$_Obj = M($this->objName);\t\t$newsObj = M(\"content\");\t\t$msgObj = new Msg();\t\t$id = $_GET['id'];\t\t$idAry = $_POST['id'];//注入\t\t$idStr = count($idAry) == 0 ? intval($id) : implode(\",\", $idAry);\t\t$newIdAry = explode(\",\", $idStr);\t\t$idSize = count($newIdAry);\t\tif (empty($newIdAry[0]) && empty($id)) {\t\t\t$msgObj->addMsg('error', Config::lang(\"PLEASECHOOSEDELETEDATA\"));\t\t}\t\tfor ($i = 0; $i < $idSize; $i++) {\t\t\t$news = get(\"news\",$newIdAry[$i]);\t\t\tif (Authen::checkIsSelfData($news->uid)) {\t\t\t\t$newsObj->deleteById($newIdAry[$i]);\t\t\t\t$_Obj->deleteById($newIdAry[$i]);\t\t\t} else {\t\t\t\t$msgObj->addMsg('error', Config::lang(\"CANBEDELNOTSELFNEWS\"));\t\t\t}\t\t}\t\tif (!$msgObj->hasMsg) {\t\t\t$newsObj->delete();\t\t\t$_Obj->delete();\t\t}\t\theader('Location: index.php?ac=news_all&type=user&page='.$_GET[\"page\"]);\t\texit;\t}\n跟进deleteById。system/core/model.class.php：\npublic function deleteById($id) {        $this->db->Delete($this->table, $this->PRI, $id);    }\nPOST的id未过滤。   漏洞证明：  先看看我们的文章：\n\n然后我们构造错误的语句，来删除：\n\n虽然会提示成功删除一个文章，但实际上文章并没有被删除，条件不成立。构造正确的条件：\n\n文章被成功删除。数据库记录：\n\n   修复方案：  过滤   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-01-13 10:30 厂商回复： Thanks focus 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}