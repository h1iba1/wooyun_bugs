{"id": 48232, "wybug_id": "wooyun-2014-083805", "wybug_title": "息壤linux主机某安全问题", "wybug_corp": "xirang.com", "wybug_author": "我了个去", "wybug_date": "2014-11-19 10:22", "wybug_open_date": "2015-01-03 10:24", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-03：\t细节向公众公开  简要描述： 这个问题很严重的，作为一个道德感很强的人 我不得不说 下面请看详细。。。。。 详细说明：  详细呢，就是息壤的linux虚拟主机内核版本过老，存在提权漏洞，而且虚拟主机都上百个ip，也就是存在上百个网站，随便getshell一个 就可以拥有整个服务器的权限，其实这还不算严重，严重的是。。。。。 严重的是该虚拟主机可以直接访问内网的ftp，当然这个也不算太严重，更严重的是ftp上面还存放一些重要的资料   漏洞证明：  [root@S0486 ~]# iduid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)[root@S0486 ~]# uname -aLinux S0486.xrnet.cn 2.6.18-238.12.1.el5.centos.plus #1 SMP Wed Jun 1 11:12:25 EDT 2011 x86_64 x86_64 x86_64 GNU/Linux[root@S0486 ~]# ifconfig -a|grep \"inet addr\"|wc -l602[root@S0486 ~]# cat /etc/hosts# Do not remove the following line, or various programs# that require network functionality will fail.127.0.0.1        localhost.localdomain localhost::1             localhost6.localdomain6 localhost6180.86.64.7        S0486.xrnet.cn2.6.18-238.12.1.el5.centos.plus   该内核可以直接秒的。证明：ip：180.86.64.7port: 2211user:rootpass:whoami.so 你登录下试试？    关于内网ftp的：[root@S0486 au]# cat core.sh#!/bin/bashcd /root/auremote_ip=\"203.158.18.24\"prefix=\"ftp://xradm:147258369@$remote_ip/scripts/\"2014/11/07  13:17    <DIR>          .2014/11/07  13:17    <DIR>          ..2014/02/27  21:24            37,418 2.jpg2014/02/27  21:24               458 apachelog.py2014/02/27  21:24         1,450,004 AspUpload3.rar2014/09/18  02:30    <DIR>          Evernote2014/02/27  21:24           229,888 FreeBSD7.4安装教程.doc2014/02/27  21:24        15,670,346 HA-EasyRecoveryPro_xp500.com.rar2014/02/27  21:23               280 kill_sa.sh2014/02/27  21:23               284 kill_sb_php.sh2014/09/18  02:30    <DIR>          Linux2014/02/27  21:23            25,088 linux常用.doc2014/02/27  21:23             1,748 mysql.php2014/09/18  02:30    <DIR>          mysql反向解析2014/02/27  21:23             3,601 NAS.txt2014/02/27  21:23                79 ns3的替换机.txt2014/02/27  21:23            47,563 phpweb_soap20120309.rar2014/02/27  21:23            44,717 pinginfoview_1.26_DownG.com.rar2014/02/27  21:23        10,657,697 SecureCRT.rar2014/02/27  21:23            39,128 servers-xin.xlsx2014/02/27  21:23                29 sn.txt2014/02/27  21:23         5,517,312 SSHSecureShellClient-3.2.9.exe2014/11/06  17:37    <DIR>          Windows2014/02/27  21:20                72 windows 序列号.txt2014/02/27  21:20            32,243 windows.jpg2014/02/27  21:20           232,192 windows限制连接数量.jpg2014/09/18  02:30    <DIR>          主控操作2014/09/18  02:30    <DIR>          云---管理中心2014/09/18  02:30    <DIR>          公司网络2014/02/27  21:19            25,088 再线解压缩不好用.doc2014/02/27  21:20               551 华顿安装流程.txt2014/02/27  21:20               522 工作日志.txt2014/02/27  21:20                55 常用服务器信息.txt2014/02/27  21:19           128,512 新密码表.xls2014/02/27  21:19               179 新建 文本文档.txt2014/02/27  21:19            75,264 最新密码.xls2014/02/27  21:20               915 流程规定.txt2014/09/18  02:30    <DIR>          添加模块2014/02/27  21:20               391 特殊域名加邮局.txt2014/02/27  21:20               401 登录平台.txt2014/02/27  21:20               201 禁止函数的服务器.txt2014/02/27  21:20               141 管理卡.txt2014/02/27  21:20            10,346 网通机柜.xlsx2014/09/18  02:30    <DIR>          脚本2014/09/18  02:30    <DIR>          运维常用软件2014/02/27  21:19               952 运维题.txt2014/02/27  21:20             1,530 配windows流程.txt2014/02/27  21:20               510 香港机器分布.txt              36 个文件     34,235,705 字节              13 个目录 584,594,739,200 可用字节很小一部分，哈哈更有意思的是，运维人员将自己的crt都放在里面，然后里面都配置好了的，可以直接连接各个dns，邮局等linux主机。   修复方案：  首先大批量的虚拟主机需要更新内核，centos的主机 yum update kernel -y一下重启就完事  ，其次不建议虚拟主机可以直接连接内部ftp，或者ftp里不要放太多敏感的资源在里面。   版权声明：转载请注明来源 我了个去@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-11-19 18:40 厂商回复： 非常感谢您的报告，问题已着手处理，感谢您对息壤业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理,或可邮件专门与我们联系。 最新状态： 2014-12-25：已经进行升级操作  ", "replys": "漏洞评价：\n评论\n     2014-11-19 10:48 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  喔~~自主开源的易软    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}