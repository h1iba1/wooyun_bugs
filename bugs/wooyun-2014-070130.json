{"id": 52796, "wybug_id": "wooyun-2014-070130", "wybug_title": "Qwbm深山行者留言板可通杀绕过登陆获得后台权限", "wybug_corp": "深山工作室", "wybug_author": "zph", "wybug_date": "2014-07-29 14:58", "wybug_open_date": "2014-09-12 15:00", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "未授权访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-12：\t细节向公众公开  简要描述： powered by qwbm找到约 98,400 条结果 （用时 0.33 秒）:) 详细说明：  0x01 代码审计我们先看admin/index/index.asp\n<%@LaNGUaGE=\"VBSCRIPT\" CODEPaGE=\"936\"%><!--#include file=\"../inc/qwbm_conn.asp\"--><!--#include file=\"../inc/qwbm_cheack.asp\"--><html><head><title><%=qwbmcms1%></title><meta http-equiv=Content-Type content=text/html;charset=gb2312><link rel=\"stylesheet\" type=\"text/css\" href=\"../skin/01/index.css\"><script language=\"javascript\">var oldmenus = 0;function headmenu(menus,value){\tdocument.getElementById(\"lefttop\").innerHTML=value;\tvar mes=document.getElementById(\"leftmain0\"+menus);\tvar oldmes = document.getElementById(\"leftmain0\"+oldmenus);\tif (mes != null && oldmes != null){\t\toldmes.style.display=\"none\";\t\tmes.style.display='block';\t\toldmenus = menus;\t}}function gotourl(urls){document.getElementById(\"ifrmameid\").src=urls;}function setTabs(m,n){ var tli=document.getElementById(\"leftmain0\"+m).getElementsByTagName(\"li\"); var mli=document.getElementById(\"leftmain0\"+m).getElementsByTagName(\"ul\"); for(i=0;i<tli.length;i++){  \ttli[i].className=i==n?\"leftmainhover\":\"\";\t}}</script></head>\n显然，inc/qwbm_cheack.asp这个文件是用来判断用户是否登陆的，那么我们看一下代码\n<%if request.cookies(\"\"& qwbmcms2 &\"username\") = \"\" then\tresponse.write \"您没有查看该文件的权限\"\tresponse.endend if%>\n程序只是对\"\"& qwbmcms2 &\"username\" cookie进行判断，只要isset就回登陆ok\"\"& qwbmcms2 &\"username\" 这个cookie即是qwbm%5Fbookusername   漏洞证明：  0x02 绕过&登陆open url：http://site/admin/index/index.asp修改cookie为：\nqwbm%5Fbookusername=admin\n即可成功登陆\n\n\n\n\n\n\n\n   修复方案：  更改登陆验证策略，加强安全意识   版权声明：转载请注明来源 zph@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-07-30 09:26 厂商回复： CNVD确认所述情况，但未能建立与软件生产厂商的直接联系处置渠道，未列入处置流程，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-29 15:14 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  秒过啊 :) 希望能秒确认就更好了 :) @cncert国家互联网应急中心    \n     2014-08-12 21:33 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  @奖金 疯狗有没？    \n     2014-08-12 21:34 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  @疯狗 奖金有没……居然把狗哥和奖金换了个位置啊……于心不忍    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}