{"id": 18761, "wybug_id": "wooyun-2012-08280", "wybug_title": "小米MIUI系统漏洞可能导致资源消耗和用户数据泄漏", "wybug_corp": "小米科技", "wybug_author": "Claud", "wybug_date": "2012-06-13 23:53", "wybug_open_date": "2012-07-28 23:54", "wybug_type": "用户敏感数据泄漏", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "权限绕过", "用户敏感数据泄漏", "敏感信息未加密存储", "安全", "手机软件安全", "敏感数据未加密", "明文密码", "敏感应用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-17：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-08-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-28：\t细节向公众公开  简要描述： 在满足触发条件时，该漏洞可以导致用户网络流量少量消耗，任意应用软件可以得到手机中已保存的Wi-Fi网络SSID、类型、明文密码，以及手机的IMEI、IMSI。危害不高，只是一个案例。题外话：折腾了一个晚上，想做成自动满足触发条件，都被Android的一些设定挡住了。还是没能演示出这类攻击的真正能力。 详细说明：  MIUI系统中预装的备份程序（Backup.apk），在满足以下条件时可以触发该漏洞：1. 用户已经设置MIUI账号；2. 用户选择了在线自动备份项目。无论用户是否开启在线自动备份，均可触发。漏洞产生的主要原因有三个方面：1. 对com.miui.milk.ui.AutoBackupReceiver接收器、com.miui.milk.service.AutoBackupService服务均没有做权限检查，存在permission re-delegation类型漏洞，通过触发其中任何一个组件，都可以直接导致开始在线自动备份；2. AutoBackupService调用的com.miui.milk.service.AutoBackupService输出过多的Log信息；3. 应用软件可以读取这些Log信息。如果用户选择了备份WLAN设置，则会log下SSID、类型、明文密码。   漏洞证明：  利用代码片段如下：\nIntent intent = new Intent();intent.setAction(\"com.miui.backup.AUTO_BACKUP\");sendBroadcast(intent);\n利用前：\n\n利用完成后，说明该功能确实被触发了：\n\n利用开始后的日志信息：\n\n日志中的Wi-Fi密码：\n\n日志中的设备IMEI、IMSI：\n\n至于一个软件怎么读取logcat数据，应该不需要多说了吧。RunTime.getRunTime().exec(\"logcat\");然后读取返回的Process的标准输出即可。   修复方案：  1. 对com.miui.milk.ui.AutoBackupReceiver接收器加入运行时或静态权限；2. 去掉整个com.miui.backup项目中的Log代码。以及，你们什么时候出云端数据管理功能？   版权声明：转载请注明来源 Claud@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2012-06-14 11:19 厂商回复： 感谢上报！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-14 01:47 |    \t\txiya \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n  马克    \n     2012-06-14 03:17 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  mark....估计lz有手机了    \n     2012-06-14 09:21 |    \t\tVi0lent \t\t\t( 普通白帽子  |\t\t\t        Rank:131 漏洞数:14        | hello~)\t\t \n  膜拜，坐等细节    \n     2012-06-14 11:39 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  非常赞！    \n     2012-07-15 14:41 |    \t\tknickers \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:6        | 偶是一个大帅哥)\t\t \n  nokia2220s坑爹的s40系统.......下载还不能超过500k.......lz有啥解决吗........用浏览器也不行啊.....提示文件太大无法储存.....    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}