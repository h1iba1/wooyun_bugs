{"id": 50333, "wybug_id": "wooyun-2014-078083", "wybug_title": "中标麒麟软件#某站点信息泄露可被shell(二)", "wybug_corp": "中标软件", "wybug_author": "爱上平顶山", "wybug_date": "2014-10-05 13:07", "wybug_open_date": "2014-11-19 13:08", "wybug_type": "重要敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "内部敏感信息泄漏", "源码泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-05：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-11-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 0.0传说，要出国产操作系统了，希望能撑起国人的门面，唉，坐等~ 详细说明：  中标麒麟软件http://osc.cs2c.com.cn/forum/index.php源代码托管在github了  囧~  sohttps://github.com/insekkei/os-cs2c-backup/blob/7d768e509d050d76daaf7c56a63790055e703b9f/html/forum/upload/uc_server/data/config.inc.php<?php define('UC_DBHOST', 'localhost');define('UC_DBUSER', 'root');define('UC_DBPW', 'qwer*****');define('UC_DBNAME', 'forum');define('UC_DBCHARSET', 'utf8');define('UC_DBTABLEPRE', 'cdb_uc_');define('UC_COOKIEPATH', '/');define('UC_COOKIEDOMAIN', '');define('UC_DBCONNECT', 0);define('UC_CHARSET', 'utf-8');define('UC_FOUNDERPW', '387ea0207790dafa******2e7ea1cf');define('UC_FOUNDERSALT', '7bofv7');define('UC_KEY', '9bdfG7e4PcOcX3Z517r7u0Af7******8W2m944L1a7w4kfGfi1J921Sd51Va');define('UC_SITEID', 'ibUfN7V49cvcu3q5p7L7C0nfFa0fO2x9tfn8g******Kfw1D921Cda1ta');define('UC_MYKEY', 'Ub0fw7y4Gc8cR3p5J7V7D0DffaNf42x9NfS8N2******Zfq179S1udy18a');define('UC_DEBUG', false);define('UC_PPP', 20);<?PHP exit;?>\tUCenterAdministrator\t10.1.11.5\t1378796555\tlogin\tsucceed<?PHP exit;?>\tUCenterAdministrator\t10.1.11.5\t1378796586\tsetting_register_update\t<?PHP exit;?>\tUCenterAdministrator\t10.1.11.5\t1378796608\tsetting_register_update\t<?PHP exit;?>\tUCenterAdministrator\t10.1.11.5\t1378796628\tsetting_register_update\t<?php/*\t[Discuz!] (C)2001-2006 Comsenz Inc.\tThis is NOT a freeware, use is subject to license terms\t$RCSfile: config5.inc.php,v $\t$Revision: 1.9 $\t$Date: 2007/01/26 01:11:32 $*/// [CH] 以下变量请根据空间商提供的账号参数修改,如有疑问,请联系服务器提供商\t$dbhost = 'localhost';\t\t\t// 数据库服务器\t$dbuser = 'root';\t\t\t// 数据库用户名\t$dbpw = 'qwer******';\t\t\t\t// 数据库密码\t$dbname = 'forum';\t\t\t// 数据库名\t$pconnect = 0;\t\t\t\t// 数据库持久连接 0=关闭, 1=打开// [CH] Mysql 辅助服务器设置，只有当您拥有多个 Mysql 服务器且协同工作时请进行设置\t$multiserver = array();\t\t\t// 服务器变量初始化，请勿修改或删除 // [CH] 如您对 cookie 作用范围有特殊要求, 或论坛登录不正常, 请修改下面变量, 否则请保持默认\t$cookiepre = 'IhR_';\t\t\t// cookie 前缀\t$cookiedomain = ''; \t\t\t// cookie 作用域\t$cookiepath = '/';\t\t\t// cookie 作用路径// [CH] 论坛投入使用后不能修改的变量\t$tablepre = 'cdb_';   \t\t\t// 表名前缀, 同一数据库安装多个论坛请修改此处// [CH] 小心修改以下变量, 否则可能导致论坛无法正常使用\t$database = 'mysql';\t\t\t// 论坛数据库类型，请勿修改\t$dbcharset = '';\t\t\t// MySQL 字符集, 可选 'gbk', 'big5', 'utf8', 'latin1', 留空为按照论坛字符集设定\t$charset = 'utf-8';\t\t\t// 论坛页面默认字符集, 可选 'gbk', 'big5', 'utf-8'\t$headercharset = 0;\t\t\t// 强制论坛页面使用默认字符集，可避免部分服务器空间页面出现乱码，一般无需开启。 0=关闭 1= 开启\t$tplrefresh = 1;\t\t\t// 论坛风格模板自动刷新开关 0=关闭, 1=打开。// [CH] 论坛安全设置, 调整以下设置，可以增强论坛的安全性能和防御性能\t$adminemail = 'os@bj.cs2c.com.cn';\t\t// 系统管理员 Email\t$forumfounders = '1';\t\t\t// 论坛创始人 UID, 可以支持多个创始人，之间使用 “,” 分隔。[出于安全考虑，请务必设置一名管理员为创始人]\t\t\t\t\t\t// 论坛创始人可对其他管理员进行设置。如果不设置论坛创始人，则论坛管理员之间权利平等。\t$dbreport = 0;\t\t\t\t// 论坛出现数据库错误时，是否通过 email 发送错误报告给系统管理员\t$errorreport = 1;\t\t\t// 是否屏蔽程序错误信息, 0=屏蔽所有错误(安全) 1=报告给管理员和版主(安全) 2=报告给任何人\t$attackevasive = 0;\t\t\t// 论坛防御级别，可防止大量的非正常请求造成的拒绝服务攻击\t\t\t\t\t\t// 防护大量非正常请求造成的拒绝服务攻击,\t\t\t\t\t\t// 0=关闭, 1=cookie 刷新限制, 2=限制代理访问, 4=二次请求, 8=回答问题（第一次访问时需要回答问题）\t\t\t\t\t\t// 组合为: 1|2, 1|4, 2|8, 1|2|4... \t$urlxssdefend = 1;\t\t\t// 论坛访问页面防御开关，可避免用户通过非法的url地址对本站用户造成危害，建议打开。1=打开 0关闭\t$admincp = array();\t$admincp['forcesecques'] = 0;\t\t// 管理人员必须设置安全提问才能进入系统设置, 0=否, 1=是[安全]\t$admincp['checkip'] = 1;\t\t// 后台管理操作是否验证管理员的 IP, 1=是[安全], 0=否。仅在管理员无法登陆后台时设置 0。\t$admincp['tpledit'] = 0;\t\t// 是否允许在线编辑论坛模板 1=是 0=否[安全]\t$admincp['runquery'] = 1;\t\t// 是否允许后台运行 SQL 语句 1=是 0=否[安全]\t$admincp['dbimport'] = 1;\t\t// 是否允许后台恢复论坛数据  1=是 0=否[安全]// ============================================================================define('UC_CONNECT', 'mysql');define('UC_DBHOST', 'localhost');define('UC_DBUSER', 'root');define('UC_DBPW', 'qwer*****');define('UC_DBNAME', 'forum');define('UC_DBCHARSET', 'utf8');define('UC_DBTABLEPRE', '`forum`.cdb_uc_');define('UC_DBCONNECT', '0');define('UC_KEY', '6brfv734VcJc4315n7l7a0zfwamfS2g9******A7549f8fG1w9W11dK17a');define('UC_API', 'http://10.1.50.7/forum/upload/uc_server');define('UC_CHARSET', 'utf-8');define('UC_IP', '127.0.0.1');define('UC_APPID', '1');define('UC_PPP', '20');有了UC_KEY等信息，对于discuz，可以做任何事情~ 拿shell参照： WooYun: 途牛网某服务配置失误 导致论坛敏感文件泄露(致使百万用户信息告急) 第二：mediawiki-1.21.2的数据库等配置文件：# Protect against web entryif ( !defined( 'MEDIAWIKI' ) ) {\texit;}## Uncomment this to disable output compression# $wgDisableOutputCompression = true;$wgSitename = \"CS2C_OS\";## The URL base path to the directory containing the wiki;## defaults for all runtime URL paths are based off of this.## For more information on customizing the URLs## (like /w/index.php/Page_title to /wiki/Page_title) please see:## http://www.mediawiki.org/wiki/Manual:Short_URL$wgScriptPath = \"/mediawiki-1.21.2\";$wgScriptExtension = \".php\";## The protocol and server name to use in fully-qualified URLs$wgServer = \"http://10.1.50.7\";## The relative URL path to the skins directory$wgStylePath = \"$wgScriptPath/skins\";## The relative URL path to the logo.  Make sure you change this from the default,## or else you'll overwrite your logo when you upgrade!$wgLogo             = \"$wgStylePath/common/images/wiki.png\";## UPO means: this is also a user preference option$wgEnableEmail = true;$wgEnableUserEmail = true; # UPO$wgEmergencyContact = \"taotao.liu@cs2c.com.cm\";$wgPasswordSender = \"taotao.liu@cs2c.com.cm\";$wgEnotifUserTalk = false; # UPO$wgEnotifWatchlist = false; # UPO$wgEmailAuthentication = true;## Database settings$wgDBtype = \"mysql\";$wgDBserver = \"localhost\";$wgDBname = \"cs2c_os\";$wgDBuser = \"root\";$wgDBpassword = \"qwer******\";# MySQL specific settings$wgDBprefix = \"cs2c_os\";# MySQL table options to use during installation or update$wgDBTableOptions = \"ENGINE=InnoDB, DEFAULT CHARSET=binary\";# Experimental charset support for MySQL 5.0.$wgDBmysql5 = false;## Shared memory settings$wgMainCacheType = CACHE_NONE;$wgMemCachedServers = array();好了 https://github.com/insekkei/os-cs2c-backup  下面的  不深入了   漏洞证明：  如上~   修复方案：  安全加强~   版权声明：转载请注明来源 爱上平顶山@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}