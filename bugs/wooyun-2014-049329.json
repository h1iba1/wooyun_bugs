{"id": 58863, "wybug_id": "wooyun-2014-049329", "wybug_title": "安踏商城订单修改（已发货）", "wybug_corp": "anta.com", "wybug_author": "乌云", "wybug_date": "2014-01-20 11:56", "wybug_open_date": "2014-03-06 11:57", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "支付行业敏感"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-06：\t细节向公众公开  简要描述： 周六闲着看了下安踏，然后发现可以修改订单价格并付款。然后因为周末乌云上的小伙伴们都不玩去了就没提交，结果昨晚看了下竟然发货了！！！希望收到的不是手镯。。。-_-|| 详细说明：  安踏官方商城URL:    http://www.anta.cn/点击任意商品，加入购物车，购买，一路下一步，直到提交订单处。（前面的一切数据包都不可修改，就是改了没有用）\n\n然后抓包分析\n\n其中的一个shipping_fee=0引起了我的注意，看起来像是运费的意思，我们尝试改一下。我的这个订单价格是199，我们改为-198。发包，然后就成功提交订单了。价格也显示1元，去付款。付完款后就仍那里了，因为周末审核少就没提交，结果今天周一一看竟然发货了，就赶紧来提交了。   漏洞证明：  \n\n。。   修复方案：  快修复把。。。。官网是PHP的，在相应的php页面的$shipping_fee=$_REQUEST['shipping_fee'];后面添加：\nif((!is_numeric($shipping_fee))||($shipping_fee<0))   return \"wrong shipping_fee\";//这里返回值需要和你们当前函数的返回值对应，仅作参考\n   版权声明：转载请注明来源 乌云@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-01-21 17:40 厂商回复： 感谢您的反馈，问题正在修复中。 最新状态： 2014-01-23：问题己修复.谢谢乌云  ", "replys": "漏洞评价：\n评论\n     2014-02-27 13:09 |    \t\t笨小猪 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:2        | 杯壁下流)\t\t \n  不用感谢乌云，送洞主一副手镯！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}