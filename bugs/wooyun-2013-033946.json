{"id": 9442, "wybug_id": "wooyun-2013-033946", "wybug_title": "太平洋保险逻辑缺陷导致秒进入任意用户帐号！(可直接获取到用户明文密码)", "wybug_corp": "太平洋保险", "wybug_author": "VIP", "wybug_date": "2013-08-09 14:42", "wybug_open_date": "2013-09-23 14:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-23：\t细节向公众公开  简要描述：     我是看到zone的帖子才来的，求别给6rank（并非密码修改漏洞，是直接进入任意帐号）（密码明文储存 不光可以进入帐号 还可以直接获取用户明文密码！！！）    引用七楼的话：据说怕给的rank太高引起注意被挖洞 你就不怕给得太低引起民愤导致被挖洞？    “安全是一个整体，保证安全不在于强大的地方有多强大 而在于真正薄弱的地方在哪里”--剑心 详细说明：  注册后激活邮件会跳转到一个激活成功的页面，然后自动跳转到了会员中心（登录状态）。页面如下\nhttp://member.cpic.com.cn/ucf/register/regActiveOk?theme=new&email=邮件地址&msg=activeSuccess\n5秒后，就会自动跳转到会员中心。这里存在一个逻辑缺陷所以，要进入别人的帐户，只要知道他的邮件地址比如，我注册了个帐号就可以通过这个链接（打开后要等待自动跳转，不能手动点击）进入我的帐号：\nhttp://member.cpic.com.cn/ucf/register/regActiveOk?theme=new&email=smtp_admin@yeah.net&msg=activeSuccess\n   漏洞证明：  \nhttp://member.cpic.com.cn/ucf/register/regActiveOk?theme=new&email=smtp_admin@yeah.net&msg=activeSuccess\n\n\n在这个过程中 有好几次ajax发起登录请求其中被一个请求亮瞎了！！！明文密码！！！！\n\n   修复方案：  修复下逻辑问题   版权声明：转载请注明来源 VIP@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-08-11 10:32 厂商回复： 问题已经确认并修复，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-09 14:44 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  V5，这貌似又是个安全点    \n     2013-08-09 15:20 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  买保险 就是买平安.....PPPPP..帐号都被人进了 还平安 ............o(∩_∩)o     \n     2013-08-09 15:21 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @M4sk 亲 你仔细看标题了吗 太平洋表现表示伤不起    \n     2013-08-09 15:24 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @疯狗 难道一个id数据遍历？    \n     2013-08-09 15:25 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @小胖胖要减肥 细节不能透漏啊，等厂商修复吧    \n     2013-08-09 15:30 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  尼玛...同样是保险啊......soga    \n     2013-08-09 15:37 |    \t\t菊花卫士 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 网站卫士是360旗下为网站提供有偿主动保护...)\t\t \n  据说怕给的rank太高引起注意被挖洞你就不怕给得太低引起民愤导致被挖洞？    \n     2013-08-09 15:55 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n   - -求指导    \n     2013-08-09 16:40 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @疯狗 再次测试了下 还能无条件获取用户明文密码，求过新补充的内容    \n     2013-08-09 16:57 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @VIP 补充了么？     \n     2013-08-09 16:59 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @疯狗 补充了 还没过啊    \n     2013-08-11 10:37 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  明文密码才8rank 用户数据就这么没有价值：（    \n     2013-08-11 10:39 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @VIP 这种厂商没节操- - 应该爆菊    \n     2013-08-11 10:48 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @mango 果断去打差评了    \n     2013-08-11 13:55 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @VIP 我觉得应该走小厂商，哈哈    \n     2013-08-11 13:56 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小胖胖要减肥 :(    \n     2013-08-12 12:37 |    \t\t小布 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 爱好者)\t\t \n  @VIP, 明文密码不假，但是使用的是ＨＴＴＰＳ传输，不算很严重吧。。。    \n     2013-08-12 12:42 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小布 全程可控 不需要中间人攻击 告诉我你的帐号就能获取你的密码 和https没关系 这还不严重？？？？？    \n     2013-08-12 12:43 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小布 知道你的帐号就能直接获取你的明文密码 进你的帐号    \n     2013-08-12 12:43 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小布 完全不需要任何限制！！！和https没关系！！！    \n     2013-08-12 12:43 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小布 这是逻辑问题 并且使用了密码明文存储的原因！！！    \n     2013-08-12 12:44 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小布 直接获取到了明文密码 帐号随便进 保单随便改 这还不严重？？？？？    \n     2013-08-12 12:45 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小布 所有用户数据 保单数据面临泄露 这还不严重？？？？    \n     2013-08-12 12:45 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小布 这个和https传输没有任何关系！！！！这个链接可以构造 只需要代入你的帐号就能获取你的密码    \n     2013-08-12 12:46 |    \t\t小布 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 爱好者)\t\t \n  @mango 网络层已经ssl了，应用层明文传输没什么啊。    \n     2013-08-12 12:47 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小布 所以这个厂商评分太不准确了！！！！！几百万甚至上千万用户数据直接泄露 这还不严重？？？？用户数据才值8rank?????果断去打差评    \n     2013-08-12 12:47 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小布 告诉我的你帐号 我就能知道你的明文密码    \n     2013-08-12 12:49 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小布 ssl能影响什么呢？帐号都控制了ssl能影响什么呢？？？    \n     2013-08-12 12:52 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小布 漏洞现在已经修复了 其实就是个逻辑问题 激活账号后会自动登录 这个过程中没有任何验证 改改地址栏里的用户名就能进别的帐号 并且这个过程中是使用ajax登陆的 直接就能抓到你的明文密码！！我知道你的用户名就能知道你的明！文！密码，这不严重/？？？？？    \n     2013-08-12 13:03 |    \t\t小布 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 爱好者)\t\t \n  @VIP 知道了，谢谢。    \n     2013-08-12 15:47 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  嗨，飞马网的，一样的洞，才5rank    \n     2013-08-12 16:07 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @xfkxfk 不过这个还有明文密码    \n     2013-08-12 16:08 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @VIP 飞马的，虽然不是明文密码，但是用户名密码都有的    \n     2013-09-23 20:54 |    \t\tsoftbug \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:10        | 为人类设计最好的软件，解放人的双手,一起...)\t\t \n  不好意思，写代码的是刚招的临时工，你也知道，最近phper不好招    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}