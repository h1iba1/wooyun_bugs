{"id": 86765, "wybug_id": "wooyun-2016-0191273", "wybug_title": "携程企业邮箱奇葩设计至成功爆破", "wybug_corp": "携程旅行网", "wybug_author": "千机", "wybug_date": "2016-04-01 09:24", "wybug_open_date": "2016-05-16 13:40", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-16：\t细节向公众公开  简要描述： RT，4月第一发 详细说明：  邮箱登陆处的奇葩设计，，，活久见邮箱的链接为\nhttps://webmail.ctrip.com/CookieAuth.dll?GetLogon?curl=Z2F&reason=2&formdir=1\n先是看到这个漏洞\n WooYun: 携程旅游网邮件服务器可开启Origin模式绕过验证码撞库/躺枪vpn \n然后呢，点进去看看，咦，加了验证码，以为没戏了不过看验证码，貌似辨识度挺大的，应该可以用pkav的fuzz工具爆破当然是要找验证码的链接了，， ∑(っ °Д °;)っ卧槽链接呢，你跑哪去了！于是去代码里找\n\ncreateCode()这个生成验证码的于是定位到js里找到以下内容，，\n\n (╯‵□′)╯︵┻━┻ 合着你们的验证码是前端生成，前端验证的啊，要不要这么懒(╯‵□′)╯︵┻━┻ 这么敷衍的修复方法你们领导知道吗直接抓包，然后根据之前那个漏洞爆出的账户密码规则以及弱口令开始爆破。\n\n成功出来一枚是的，，被发现了。我被封ip了，所以只爆出一枚试图登陆也发现该账户已经很快被封了，这安全应急还是该点赞的\n\n   漏洞证明：  \n\n应该算已经验证危害了吧   修复方案：  这个不知道是哪个程序员的敷衍之作求个携程小海豚公仔，最近突然想收集各大公司的公仔玩玩   版权声明：转载请注明来源 千机@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2016-04-01 13:35 厂商回复： 感谢您的提交 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}