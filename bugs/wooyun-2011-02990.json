{"id": 22115, "wybug_id": "wooyun-2011-02990", "wybug_title": "三星级商务度假酒店网站系统注入+上传漏洞[asp+access]", "wybug_corp": "三星级商务度假酒店网站系统[asp+access]", "wybug_author": "08小组", "wybug_date": "2011-10-13 21:21", "wybug_open_date": "2011-10-13 22:26", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "任意文件上传", "整形注射", "源码审核", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-10-13：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2011-10-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 存在注入和上传过滤不严的问题。 详细说明：  源码下载地址：[url]http://down.admin5.com/asp/76153.html[/url]多个页面存在SQL注入漏洞：cps/clientnewsmore.asp 新闻页面。但是数据库和管理员数据库是分开的。cycont.asp              消费指南页面数据库和管理员数据库是同一个。看代码吧：\nclientnewsmore.asp：<!--#include file=\"conn.asp\"--><% set rs=server.createobject(\"adodb.recordset\") sql=\"select * from human where id=\"&request.querystring(\"id\")&\"\" rs.open sql,conn,1,1 %>\n没经过任何过虑，直接进数据查询。。。conn.asp\n<%  connstr=\"DBQ=\"+server.mappath(\"2004050261603.mdb\")+\";DefaultDir=;DRIVER={Microsoft Access Driver (*.mdb)};\"    set conn=server.createobject(\"adodb.connection\")  conn.open connstr  %>\n和管理员数据库不是同一个。cycont.asp\n<%Response.Buffer =TrueResponse.ExpiresAbsolute =Now() - 1Response.Expires=0set fs=server.createobject(\"adodb.connection\")fs.connectionstring= \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\"&server.mappath(\"200409221234.mdb\")fs.open           set rs=server.createobject(\"ADODB.Recordset\")                 sql=\"select * from cy where id=\" & request.querystring(\"id\")  rs.open sql,fs,1,1    %>\n同样没经过任务过虑。。。再看下上传页面。upload111_flash.asp\n<%uppath=request(\"uppath\")&\"/\"\t\t\t'文件上传路径filelx=request(\"filelx\")\t\t\t\t'文件上传类型formName=request(\"formName\")\t\t\t'回传到上页面编辑框所在Form的NameEditName=request(\"EditName\")\t\t\t'回传到上页面编辑框的Name%>...............<form name=\"myform\" method=\"post\" action=\"upfile111_flash.asp\" enctype=\"multipart/form-data\" ><div id=\"esave\" style=\"position:absolute; top:18px; left:40px; z-index:10; visibility:hidden\"> ..........</td><td width=20%></td></tr></table></div><table width=\"90%\" border=\"1\" align=\"center\" cellpadding=\"3\" cellspacing=\"1\" bordercolor=\"#5985D5\" bgcolor=\"#FFFFFF\" class=\"tableBorder\"><tr> <td align=\"center\" bgcolor=\"#254B8F\"><b class=\"wz\"><font color=\"#ffffff\">图片上传 <input type=\"hidden\" name=\"filepath\" value=\"<%=uppath%>\">     //上传文件路径通过表单传递的。。。 t.asp  NC抓包都是可以<input type=\"hidden\" name=\"filelx\" value=\"<%=filelx%>\"><input type=\"hidden\" name=\"EditName\" value=\"<%=EditName%>\"><input type=\"hidden\" name=\"FormName\" value=\"<%=formName%>\"><input type=\"hidden\" name=\"act\" value=\"uploadfile\"></font></b></td>\n后台地址 ：manager/   漏洞证明：  本地测试的。\n\n   修复方案：  你懂的   版权声明：转载请注明来源 08小组@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}