{"id": 13906, "wybug_id": "wooyun-2013-018255", "wybug_title": "博库网任意用户密码重置漏洞，非暴力破解", "wybug_corp": "博库网（bookuu）", "wybug_author": "xfkxfk", "wybug_date": "2013-02-02 13:02", "wybug_open_date": "2013-03-19 13:03", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "敏感接口未加权限认证", "越权操作", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-02：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-03-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 博库网——品种最多的中文网上书店，存在任意用户密码重置漏洞，还是个非主流的。不用burp suite，不再暴力，只要轻轻的改一改就可重置任意用户密码了。预知详情，请见详细说明。 详细说明：  \n=====第一种利用绕过进行密码重置=====\n1、在博库网找到任意一个用户，复制他的用户名。2、在找回登录密码时选择手机找回密码。3、此时第一步完成，在发送验证码并验证完后进入第二步，这里修改url直接进入第二步。4、修改完密码后直接拿此用户名和新密码登录成功。\n不知道wooyun上怎么传视频，必须是.swf文件才行，先放到优酷上了。视频地址：http://v.youku.com/v_show/id_XNTA5ODQxMjU2.html视频密码：123456123456\n\n=====第二种就是常规的暴力破解=====\n1、发送验证码后开始破解验证码。2、这里的验证码是4位随机数，利用burp suite进行爆破。3、根据返回信息或者返回内容长度都能判断出正确的验证码。4、验证码正确时返回{\"flag\":\"100\",\"msg\":\"\\u8bf7\\u7ee7\\u7eed\\u64cd\\u4f5c!\"}={\"flag\":\"100\",\"msg\":\"请继续操作!\"}，长度404。验证码错误时返回{\"flag\":\"101\",\"msg\":\"\\u6821\\u68c0\\u7801\\u586b\\u5199\\u9519\\u8bef!\"}={\"flag\":\"101\",\"msg\":\"校检码填写错误!\"}，长度416。5、根据上述信息暴力4位随机数的破解，很快就出来了，这里不做截图演示了。   漏洞证明：  见详细说明。   修复方案：  1、直接绕过可以进行权限限制或者不能直接进入下一步或者其他。2、进行次数限制或者其他。3、其他。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}