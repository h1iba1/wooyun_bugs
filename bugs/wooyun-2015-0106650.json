{"id": 20067, "wybug_id": "wooyun-2015-0106650", "wybug_title": "苏宁易购服务器支持EXP密码套件可SSL FREAK攻击解密通信流量（含poc）", "wybug_corp": "江苏苏宁易购电子商务有限公司", "wybug_author": "GoSSIP_SJTU", "wybug_date": "2015-04-08 18:41", "wybug_open_date": "2015-07-08 09:04", "wybug_type": "默认配置不当", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["攻击", "登陆信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-08：\t细节向公众公开  简要描述： 苏宁易购服务器因支持EXP密码套件，遭受SSL FREAK攻击，中间人可在线解密通信流量（获取到登陆凭证等敏感信息） 详细说明：  服务器会接受EXP-DES-CBC-SHA(SSLv3、TLSv1)、EXP-RC2-CBC-MD5(SSLv3、TLSv1)、EXP-RC4-MD5(SSLv3、TLSv1)这三种出口级密码套件。以登陆页面https://passport.suning.com/ids/login为例，中间人在受此漏洞影响的客户端（如还未打补丁的IE、Chrome、Safari、Opera on Mac OS等）访问页面时，如果有中间人发起FREAK攻击，将client hello消息中的密码套件改为EXP类别，那么服务器会选择使用EXP级别的密码套件进行通信，发送512bitRSA公钥给客户端。客户端用这个512bit的公钥加密Pre Master Secret，服务器收到后用私钥解密出Pre Master Secret，两方依据此秘密信息同时计算出后续通信的密钥。而对于中间人来说，如果其可以分解服务器发送的512bit的公钥，那么即可计算出私钥，从而也同样可以得到Pre Master Secret，进而算出通信的密钥，解密客户端和服务器的通信内容。 对于suning.com服务器来说，目前支持EXP密码套件的主机有18台，每台有一个固定的512bit的公钥，那么对于攻击者来说，只要分解其中的一个公钥，不管每次客户端DNS查询到的是哪台主机，中间人都可以连接到已分解公钥的那台主机进行通信获取发送给客户端的必要信息，从而成功建立与客户端和服务器的通信。服务器与其对应的公钥如下\n\nmask 区域\n*****ode**********.85.**********3ce7f782a7344e46a3201db8578fac**********133.**********d2faec9d6e974dec41a21bf6ad08b1**********107.**********3e3089fb7af21cbad09d080138af54**********.64.**********b7193899ec88f54233b145bf6f8166**********.139**********d3091c167ff0aee3e98f22ad1f7d12**********.53.**********7ba74a6b27ea10ef70bb96652324ca**********.53.**********a937dab7656e0d4da1e5cbac356ead**********196.**********aa5f4ac2be86d8353717228a0f2294**********.53.**********554aaa40b03287599f6b20192679a6**********151.**********2588038e35d16438e3b01e3515067b**********.22.**********8eafddcff67bf0d5b72853b559349a**********.226**********d67faa7b81355295a48e6ec3554903**********.64.**********32b093eb36d6ca0ccc64c819e5ef7f**********7.102**********f38d6e9e42a1fd350a722e464f89a0**********252.**********d2f73d8cd108fcc992011f64022aaa**********151.**********c2136e2f7c94fcb1faf4a64a6a9e4b**********196.**********0a417bf330856f8ad20e72307805ed**********.230**********f6198b52e90bb2f2cf9442f67083be**********cod*****\n\n   漏洞证明：  我们用两天时间分解了ip为119.188.139.98的主机对应的512bit公钥\n\nmask 区域\n*****其对应的私钥为57c07aa7e7b8fd4f12094b6e7b173c78e3ef4ebc28f87*****\n\n获取私钥后，使用自己开发的FREAK中间人攻击工具，即可成功与客户端和服务器建立通信，并解密后续通信，我们成功得到某次用户的登陆信息，用户名为gossip，密码为loccs@sjtu，见下图\n\n   修复方案：  服务器停止支持EXP级别的密码套件，如果一定要支持，那么在通信时实时生成512bit的公钥，或者提前生成一批密钥，在使用过一段时间后更换。总之，要保证密钥使用的周期不超过512bit密钥分解需要的时间   版权声明：转载请注明来源 GoSSIP_SJTU@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-04-09 09:02 厂商回复： 感谢提交，请洞主pm联系方式探讨具体漏洞详情，谢谢。 最新状态： 2015-05-27：稍后送上苏宁易购2000元礼品卡，精华漏洞按照高级别*2计算。  ", "replys": "漏洞评价：\n评论\n     2015-04-09 00:18 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  关注下。    \n     2015-04-13 19:56 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n   NB!    \n     2015-05-08 16:26 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  前排关注！    \n     2015-06-03 23:33 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  给力啊，没看懂    \n     2015-06-04 14:38 |    \t\t名字xsser \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 顺流而下，把梦做完|最近小忙，有问题可以...)\t\t \n  前排    \n     2015-06-04 15:01 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  给力啊，看不到    \n     2015-06-13 10:06 |    \t\t随页清风 \t\t\t( 普通白帽子  |\t\t\t        Rank:131 漏洞数:41        | 剑有所指)\t\t \n  没看懂,求科普    \n     2015-07-08 09:24 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  给力啊，没看懂,求科普    \n     2015-07-08 09:36 |    \t\txsser_w \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:33        | 哎)\t\t \n  求科普    \n     2015-07-08 09:50 |    \t\tAdra1n \t\t\t( 普通白帽子  |\t\t\t        Rank:437 漏洞数:68        )\t\t \n  求知识库    \n     2015-07-08 09:53 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  poc呢？    \n     2015-07-08 10:11 |    \t\t黑妹不爱我 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | I'am yyc.)\t\t \n  what are you 说啥咧    \n     2015-07-08 11:30 |    \t\t陆由乙 \t\t\t( 普通白帽子  |\t\t\t        Rank:119 漏洞数:38        | 呵呵！)\t\t \n  牛逼    \n     2015-07-08 12:18 |    \t\t晏子 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 无)\t\t \n  mark    \n     2015-07-09 10:38 |    \t\t多情公子 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | google)\t\t \n  看不懂啊:(    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}