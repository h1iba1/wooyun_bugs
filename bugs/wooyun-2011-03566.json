{"id": 21782, "wybug_id": "wooyun-2011-03566", "wybug_title": "支付宝/淘宝登陆安全登陆控件密码获取", "wybug_corp": "支付宝", "wybug_author": "104705824", "wybug_date": "2011-12-08 12:45", "wybug_open_date": "2011-12-08 14:34", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["边界绕过", "盲目信任用户数据", "设计缺陷", "内部应用安全边界缺失"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-12-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-12-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 支付宝和淘宝为了账号安全登陆时输入密码引用了安全控件，登陆网页系统设计却留下了密码加密接口，修改网页某个值能获取到密码明文。登陆密码，支付密码包括淘宝网站的登陆都存在此漏洞！ 详细说明：  在https://www.alipay.com/看了下源代码，找到了显示密码控件的那段代码：<object id=\"_fmu.l._0.p_ie\" name=\"_fmu.l._0.p_ie\" width=\"194\" height=\"24\" tabindex=\"2\" classid=\"clsid:488A4255-3236-44B3-8F27-FA1AECAA8844\"  codebase=\"https://download.alipay.com/aliedit/aliedit/2401/aliedit.cab#Version=1,1,0,0\" >其中:488A4255-3236-44B3-8F27-FA1AECAA8844是密码控件clsid值， _fmu.l._0.p_ie是IDgetElementById(\"_fmu.l._0.p_ie\").innerHTML获取到的以下代码<PARAM NAME=\"_cx\" VALUE=\"5133\"><PARAM NAME=\"_cy\" VALUE=\"635\"><PARAM NAME=\"PasswordMode\" VALUE=\"-1\"><PARAM NAME=\"SecurityMode\" VALUE=\"-1\"><PARAM NAME=\"TextValue\" VALUE=\"3DES_2_000000000000000000000000000000_FDB704F0F6FA87B7\"><PARAM NAME=\"MaxLength\" VALUE=\"20\"><PARAM NAME=\"LogMode\" VALUE=\"0\"><PARAM NAME=\"TextData\" VALUE=\"3DES_2_000000000000000000000000000000_FDB704F0F6FA87B7\"><PARAM NAME=\"Readonly\" VALUE=\"0\"><PARAM NAME=\"CryptoMode\" VALUE=\"4\"><PARAM NAME=\"cm5ts\" VALUE=\"\"><PARAM NAME=\"cm5pk\" VALUE=\"\">得到了数字1的加密内容3DES_2_000000000000000000000000000000_FDB704F0F6FA87B73DES是加密方式，FDB704F0F6FA87B7是加密后的密文。修改CryptoMode的值为0时表示密码输入不加密，这样就可以获取到密码明文！getElementById(\"_fmu.l._0.p_ie\").CryptoMode =\"0\"  经测试引用这个密码安全控件的支付宝登陆页面登陆密码，支付页面的支付密码，淘宝的登陆页面登陆密码，都可以用这种方法获取到密码明文！只是每个页面的ID值不一样而已!   漏洞证明：  \n\n测试程序到我网盘下载：http://115.com/file/dn8552sm   修复方案：  建议去掉密码加密外部引用接口   版权声明：转载请注明来源 104705824@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2011-12-08 14:34 厂商回复： 该参数是控件业务的一个状态值，被利用来窃取用户口令成本较高。 漏洞Rank：8  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-12-08 13:47 |    \t\t80sec \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:5        | 不要停止我的音乐)\t\t \n  nice!    \n     2011-12-08 14:06 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  漂亮    \n     2011-12-08 14:09 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  给力    \n     2011-12-08 15:24 |    \t\tPnig0s \t\t\t( 实习白帽子  |\t\t\t        Rank:46 漏洞数:2        | The quiter you are,the more you're able ...)\t\t \n  厂商忽略的也很给力~    \n     2012-01-18 23:21 |    \t\t梦想肥羊 \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:18        | 博客：dnswalk.blog.163.com)\t\t \n  ·····唉    \n     2013-04-28 10:02 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  本地js加密自然可以解密。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}