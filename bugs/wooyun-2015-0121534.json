{"id": 10056, "wybug_id": "wooyun-2015-0121534", "wybug_title": "途牛网任意用户密码重置非暴力", "wybug_corp": "途牛旅游网", "wybug_author": "li3ying", "wybug_date": "2015-06-19 08:32", "wybug_open_date": "2015-08-03 08:50", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向公众公开  简要描述： 途牛任意用户密码重置登录 详细说明：  一. 首先遍历土牛上的用户；   可以通过手机号对土牛帐户进行验证是否存在；但发现在遍历时，遍历几个就有了验证码；   当然这个验证码太简单了，是可以通过打码软件搞定，不过我不想麻烦了；这时的验证码   建议设置的在复杂些；二. 任意用户密码重置；   问题出在忘记密码的地方；   URL为： https://passport.tuniu.com/forget/username   1）首先用自己的手机号注册了一个用户 A；然后进行忘记密码找回操作如下图所示： \n\n    用自己的手机，走完第一步，验证完；到第二步如下图： \n\n    注意：在此处暂停对当前页面的操作；    2）在浏览器中在打开一个tab页面，在此我们对13333333333 这个用户的密码进行重置；    仍按忘记密码，走第一步，走到如下图示部分暂停： \n\n   3）然后切到用户A的tab页面；点击下一步，这一步我提交后，一次变灰不让提交，一次提交后校验用户不对；但对这个页面做下刷新操作后，均可成功提交；      如对13333333333 这个用户重置密码成功后，跳转到页面：这个用户重置后的密码（1234QWER），通知用户改下密码吧！或者你们帮他重置下！ \n\n      登录进去查看订单及详情如下所示： \n\n      进入订单，便能看到更为详细的信息，包括同行人，住的酒店等待，有的还有身份证信息和护照信息；   4）到这，我在想以后我是不是在土牛游的话是不是不要写真实姓名和身份证信息； 好怕怕呀！       漏洞证明：  如上已证明！   修复方案：  你懂的；   版权声明：转载请注明来源 li3ying@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-06-19 08:48 厂商回复： 谢谢白帽子提醒，我们会尽快修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-19 09:04 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  叼叼的！    \n     2015-08-03 08:59 |    \t\thasz \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:7        | 信息安全)\t\t \n  高手啊！有点不明白，那个手机验证码不用输，就可以下一步了吗？    \n     2015-08-03 09:19 |    \t\t狮子找女友 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | life in security)\t\t \n  @hasz 因为他先用自己的账号输入过验证码了,自己手机号那个是可以成功的    \n     2015-08-03 09:53 |    \t\tgeegirl \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:27        )\t\t \n  666666，这种问题乌云上有些案例，只是不太明白问题出在哪里？cookies？哪位大牛解释下呗，谢谢    \n     2015-08-03 10:29 |    \t\t胡小树 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:11        | 我是一颗小小树)\t\t \n  感觉这个逻辑比较牛逼，一般测试，都不会去做刷新页面再提交的，学习了    \n     2015-08-03 10:34 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:71        | I'm Me_Fortune)\t\t \n  @geegirl 这个是和session没绑定用户有关吧，这个得问开发。。    \n     2015-08-03 15:05 |    \t\t3ang \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 风往北吹，你走的好干脆！)\t\t \n  这逻辑 有点6啊    \n     2015-08-05 00:11 |    \t\t土夫子 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:41        | 逆流而上，顺势而为)\t\t \n  6666    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}