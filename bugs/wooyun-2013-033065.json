{"id": 8589, "wybug_id": "wooyun-2013-033065", "wybug_title": "简单CMS多处SQL注入漏洞", "wybug_corp": "简单CMS", "wybug_author": "Matt", "wybug_date": "2013-08-01 10:25", "wybug_open_date": "2013-10-30 10:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-01：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-10-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： sql注入 详细说明：  1，注射一\npublic function accountAction() {\t\t$user_mod = M ( \"User\" );\t\t$data ['name'] = $_POST [\"name\"];\t\t$data ['age'] = $_POST [\"age\"];\t\t$data ['sex'] = $_POST [\"sex\"];\t\t$data ['info'] = $_POST [\"info\"];\t\t$province = ($_POST ['province'] == \"请选择\") ? '' : $_POST ['province'];\t\t$city = ($_POST ['city'] == \"请选择\") ? '' : \"|\" . $_POST ['city'];\t\t;\t\t$county = ($_POST ['county'] == \"请选择\") ? '' : \"|\" . $_POST ['county'];\t\t;\t\t$data ['address'] = $province . $city . $county;\t\t\t\t$name = $_POST [\"name\"];\t\t$id = $_POST [\"id\"];//获取\t\t$user_info = $user_mod->where ( \"name='$name' and is_del=0\" )->find ();//查询\t\t$oldUname = $user_mod->where ( \"id=$id and is_del=0\" )->getField ( \"name\" );\t\techo \"id=$id and is_del=0\" ;\nhttp://127.0.0.1/jd/index.php?a=accountAction&m=Uc&g=Home&id=1post id=1%Inject_Here%2，注射二\npublic function likeItemsDel() {\t\t$items_mod = M ( \"Items\" );\t\t$user_mod = M ( \"User\" );\t\t$items_id = $_GET ['id'];\t\t$uid = $_COOKIE ['id'];\t\t$items_likes_mod = M ( \"Items_likes\" );\t\t$del = $items_likes_mod->where ( \"items_id=$items_id and uid=$uid\" )->delete ();\t\tif ($del) {\t\t\t$items_mod->where ( \"id=$items_id\" )->setDec ( 'likes', 1 ); // 商品的喜欢数减1\t\t\t$user_mod->where ( \"id=$uid\" )->setDec ( 'likes_num', 1 );\t\t\t$url = get_url ( 'like', '', 'user' );\t\t\theader ( 'location:' . $url );\t\t}\t}\nhttp://127.0.0.1/jd/index.php?a=likeItemsDel&m=Uc&g=Home&id=1Accept: */*Cookie: id=1%Inject_Here%User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727) Havij3，注射三\npublic function albumItemsDel() {\t\tC ( 'TOKEN_ON', false );\t\t$items_id = $_GET ['id'];//获取\t\t$aid = $_GET ['aid'];//获取\t\t$items_mod = M ( \"Items\" );\t\t$album_mod = M ( \"Album\" );\t\t$album_items_mod = M ( \"Album_items\" );\t\t$uid = $album_mod->where ( \"id=$aid and is_del=0\" )->getField ( \"uid\" );\t\techo \"id=$aid and is_del=0\";\t\tif ($uid == $_COOKIE ['id']) {\t\t\t$del = $album_items_mod->where ( \"pid=$aid and items_id=$items_id\" )->delete ();\t\t\tif ($del) {\t\t\t\t$url = get_url ( 'albumDetail', $aid, 'user' );\t\t\t\theader ( 'location:' . $url );\t\t\t}\t\t}\t}\nhttp://127.0.0.1/jd/index.php?a=albumItemsDel&m=Uc&g=Home&aid=1   漏洞证明：  \n\n   修复方案：  过滤   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}