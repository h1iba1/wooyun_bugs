{"id": 56284, "wybug_id": "wooyun-2014-058327", "wybug_title": "FineCMS存储型xss可盲打后台管理员", "wybug_corp": "dayrui.com", "wybug_author": "wutongyu", "wybug_date": "2014-04-25 10:49", "wybug_open_date": "2014-07-24 10:50", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "黑盒测试技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-24：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 某处没有过滤导致可xss 详细说明：  FineCMS v2（简称v2）是Php+Mysql开发的一款开源的跨平台网站内容管理系统，以“实用+好用”为基本产品理念。但是良好的设计不等于良好的实现，该cms在会员中心处对于xss代码完全没有进行过滤。导致只要开启了会员功能即可盲打管理员：有如下几个输出点：0x01：设置空间名称处，该处允许超长的字符，设置\"><script>alert(1)</script>试试\n\n保存之后，刷新页面：\n\n也许这样就过去了，但是当管理员访问此人空间的时候，xss代码又再一次被触发（因此可用来打管理员）：\n\n0x02：除此之外，日志功能的标题处也存在跨站：\n\n\n\n   漏洞证明：  切换回管理员角色，访问事先种好的xss代码：成功获取cookie等敏感信息：\n\n   修复方案：  利用htmlspecialchars()对用户输出部分进行转义处理。   版权声明：转载请注明来源 wutongyu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2014-04-25 11:16 厂商回复： 进入后台-会员空间-自定义自动-选择字段-修改-关闭XSS过滤-否，默认系统是关闭XSS过滤的， 最新状态： 2014-04-25：进入后台-会员空间-自定义自动-选择字段-修改-关闭XSS过滤-否，默认系统是关闭XSS过滤的，需要过滤的文本块等字段开启就行了，由于ci框架的非法字符过滤很严谨，默认开启的话会导致其他字段出现乱码，因此系统设置为默认关闭xss过滤  ", "replys": "漏洞评价：\n评论\n     2014-06-11 18:34 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:15        | Talk is cheap,show me the shell.)\t\t \n  膜拜厂商- -    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}