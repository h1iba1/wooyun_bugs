{"id": 9455, "wybug_id": "wooyun-2013-033920", "wybug_title": "盛大在线某处存在文件读取漏洞(padding oracle使用技巧)", "wybug_corp": "盛大在线", "wybug_author": "梧桐雨", "wybug_date": "2013-08-09 09:39", "wybug_open_date": "2013-09-23 09:40", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用", "任意文件读取", "利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-23：\t细节向公众公开  简要描述： 这过程很曲折。知道盛大不少站点都是用这种架构，但是真正能用到的，这么曲折的估计就这么一个了。 详细说明：  如何找到利用的点就不说了(谷歌百度各种都行)，在上一节唯品会的利用已经说的很多了。这次主要讲讲有些朋友们和我说我跑了一天都没出来啊。找到一个url 178.sdo.com/Activity/youni/login.aspx右击查看源代码\n\n黑，找到了。应该有戏，拿去跑一下\n\n果不其然\n\n在跑的过程中，多次失败了。看返回字节码，不甘心。于是继续（相信不少人在这里就放弃了，但是实际上是可以继续跑的）\n\n到下面，基本眉目都出来了(到这里基本你离跑出你想要的文件已经八九不离十了，不要放弃)\n\n\n\n到上图，有了密钥。破解基本上都能成，剩下的就是时间问题了。在这里说下，一般而言，正常情况最后那步骤都会在半个小时到一个小时完成，如果没跑出来，则中断，重新再跑。如此类推，跑出来为止。   漏洞证明：  最后破解出来的web.config:\n\n   修复方案：  微软已经有补丁了   版权声明：转载请注明来源 梧桐雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2013-08-09 10:28 厂商回复： 十分感谢！已联系业务部门处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-09 09:41 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  拿这个方法测试了不少aspx架构的站点，基本都能成。跑不出的同学们可以关注一下~    \n     2013-08-09 09:47 |    \t\twinsyk \t\t\t( 普通白帽子  |\t\t\t        Rank:108 漏洞数:16        | 越长大越孤单)\t\t \n  @梧桐雨 snda的补丁也不打，堪忧啊。。    \n     2013-08-09 09:48 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @winsyk 我测试了几个这个比较经典就发上来了。    \n     2013-08-09 09:55 |    \t\tlucky \t\t\t( 普通白帽子  |\t\t\t        Rank:409 漏洞数:84        | 三人行必有我师焉########################...)\t\t \n  @梧桐雨 呵呵，学习一下    \n     2013-08-09 09:58 |    \t\t啦绯哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:107 漏洞数:20        )\t\t \n  看这个趋势，POD要在wooyun大规模提交了    \n     2013-08-09 10:01 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @啦绯哥 大规模提交比较难，因为想找到能利用的并不多，而且不少已经打了补丁，即便存在漏洞，方法不正确也是很难跑出密钥文件的。    \n     2013-08-09 10:06 |    \t\t小痞子 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:21        | <xss>alert(\"a\")</xss>￥&@&……dssKhwjcw...)\t\t \n  ....估计难普及    \n     2013-08-09 10:21 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  关注    \n     2013-08-09 10:24 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  关注妹子    \n     2013-08-09 11:22 |    \t\tlxj616 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:90        | <hohoho>)\t\t \n  我也碰到过报padding oracle 的站，但是一方面我不做.NET开发，另一方面这个比较繁琐，所以直接忽略了    \n     2013-08-09 11:43 |    \t\twinsyk \t\t\t( 普通白帽子  |\t\t\t        Rank:108 漏洞数:16        | 越长大越孤单)\t\t \n  这本质上不是web漏洞，可能很多人把这个当成了web漏洞，漏洞的本质是因为微软的安全漏洞ms10-070，打补丁的都不受影响，so，这根本原因是补丁不及时。    \n     2013-08-09 11:46 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @winsyk 你这么理解我也赞同，根本原因的确是补丁不及时。但是可以造成遍历文件的危害。还是感谢你的提出    \n     2013-08-26 16:54 |    \t\tHRay \t\t\t( 普通白帽子  |\t\t\t        Rank:196 漏洞数:28        | 018)\t\t \n  围观正确的利用方法    \n     2013-09-12 17:24 |    \t\tapplychen \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:16        | 白发现首)\t\t \n  不是16位的KEY能行不    \n     2013-09-23 11:16 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @梧桐雨 我一直以为 d 后面字符串中如果有 - 符号就不能利用呢，看来我错了。。。。    \n     2014-04-16 12:00 |    \t\twooyunmibu \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 嗯嗯嗯)\t\t \n  makk    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}