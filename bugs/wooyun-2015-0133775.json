{"id": 65278, "wybug_id": "wooyun-2015-0133775", "wybug_title": "百度某推广插件引起的一处xss（附整个利用过程）", "wybug_corp": "百度", "wybug_author": "keny", "wybug_date": "2015-08-13 08:39", "wybug_open_date": "2015-09-27 10:48", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["利用技巧", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-27：\t细节向公众公开  简要描述：       从带有这个推广的网站  打到百度的cookies  带有这个推广代码的网站也不少！ 详细说明：  用户访问我构造的页面   会在浏览器里留下一个搜索记录  推广代码在进入页面的时候  把这个记录提取出来   当然这时候我们肯定要思考一个问题   那么多搜索记录  总不可能一次性提取显示出来把    是的  他会按网站页面的关键字去处理这一个问题！这里我拿红黑做个演示！\n\n从上图红色箭头指向的就是提取出来之后的关键字！页面地址：\nhttp://www.2cto.com/Article/200609/12101.html\n这里我要声明下  为什么要用这个页面去测试   从上图可以很明显的看到页面充带有 xss的一个介绍和语句  这样插件会提取类似的出来！ 其实自己构造个页面也行的  只不过页面中有一定要有 xss语句的关键字 ！\n\n页面代码:\n<iframe src=\"https://www.baidu.com/s?ie=utf-8&f=8&rsv_bp=1&rsv_idx=1&tn=baidu&wd=%3Cscript%3Ealert(%2FXSS%2F)%3C%2Fscript%3E&oq=%3Ciframe%E9%9A%90%E8%97%8F&rsv_pq=9c530e380002e87d&rsv_t=1dffkkKbr1JsW1IHUOLBrby4Beo6UbNvCeo98YV7p%2BtYSOSkB%2BWoPpZ22qQ&rsv_enter=1&inputT=35734&rsv_sug3=49&rsv_sug1=26&rsv_n=2&rsv_sug2=0&rsv_sug4=35734\" width=0 height=0 frameborder=0 >\n保存为html打开就行了  这时候回到红黑页面刷新！\n\n\n\n\n\n从上面第一张图中可以看到框框上面显示的网站 entry.baidu.com 也可以看到关键字被提取到了页面  并且执行了 为了确定没什么限制   我自己还用平台测试了下\n\n从上图中可以很清楚看到打到的是entry.baidu.com  的cookies   访问过我们构造的页面之后   浏览器就留下了一条记录了  就算没有特定关键字的网站  有时候进去了  随机提取出来的也一样！只是有关键字存在就能准确！     漏洞证明：  \n\n\n\n   修复方案：  你们更专业！   版权声明：转载请注明来源 keny@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-08-13 10:46 厂商回复： 感谢关注百度安全 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-13 08:42 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:107        | 低调求发展)\t\t \n  撸大叔你好    \n     2015-08-13 08:48 |    \t\tkeny \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:21        )\t\t \n  @prolog 早啊    \n     2015-08-13 10:40 |    \t\t1937nick \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:32        | 水能载舟,亦能煮粥。物尽其用,人尽其能。)\t\t \n  @keny 你是没睡还是怎么早就起来嗨了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}