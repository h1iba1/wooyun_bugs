{"id": 827, "wybug_id": "wooyun-2014-073768", "wybug_title": "从一个联通沃app信息泄露到数十万身份证及银行卡信息泄露", "wybug_corp": "中国联通", "wybug_author": "第十人", "wybug_date": "2014-08-25 12:51", "wybug_open_date": "2014-10-09 12:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-09：\t细节向公众公开  简要描述： 安全不容忽视 详细说明：  APP发现一URL，找到注入   漏洞证明：  一、漏洞概述：由于“联通沃服务”应用后台系统页面没有对输入数据进行严格过滤，导致SQL注入漏洞存在，导致大量用户隐私信息泄漏。利用该漏洞可获取489055条用户身份信息数据，其中涉及用户个人信息如：用户姓名、通讯地址、手机号码、身份证号码、营业执照、护照、IMSI号、SIM/UIM卡号、银行代码、银行帐号等。还可获取1668条管理员帐号信息，其中包括管理员姓名、密码密文、手机号码等信息。二、测试验证：“联通沃服务”应用可进行话费查询、流量查询、积分查询、VIP会员卡号查询等操作。可通过下图中链接下载。\n\n通过对android版本应用反编译逆向分析，发现应用中存在相关功能页面的URL地址，如http://211.95.193.97/unicom/com.php?act=cmd.jsonhttp://211.95.193.97/unicom/com.php?act=hold.getHoldInfo等等URL地址。\n\n通过测试发现这些页面并没有对输入数据进行严格过滤，导致SQL注入漏洞存在，使用渗透测试工具SQLMAP即可对其进行验证。\n\n如上图所示，探测出系统使用数据库为MySQL，数据库存在2和用户，用户名及密码密文分别是：unicom:*FC0BB8E604B3***B26E0873EF189B9Croot:*FC0BB8E604B390***26E0873EF189B9C利用暴力破解等方式可破解出帐号密码分别是：unicom:unil1*****root:unil1*****通过WEB应用扫描发现，系统使用phpmyadmin进行数据库管理，管理接口地址为：http://211.95.193.97/phpmyadmin/index.php。使用破解出的帐号密码可登录并进行数据管理。\n\n在“unicom”数据库中发现“u_user”表，其中存放489055条用户身份信息数据，其中涉及用户个人信息如：用户姓名、通讯地址、手机号码、身份证号码、营业执照、护照、IMSI号、SIM/UIM卡号、银行代码、银行帐号等等。\n\n\n\n在“unicom”数据库中发现“u_admin”表，其中存放1668条管理员帐号信息，其中包括管理员姓名、密码密文、手机号码等信息。\n\n   修复方案：     版权声明：转载请注明来源 第十人@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-08-30 10:24 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-25 15:42 |    \t\twkc_2014 \t\t\t( 普通白帽子  |\t\t\t        Rank:164 漏洞数:45        | 2014-)\t\t \n  能上头条么    \n     2014-08-25 16:16 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:61        | 工作需要，暂别一段时间)\t\t \n  记者同志看这里看这里……    \n     2014-08-25 20:50 |    \t\t兔兔侠 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        )\t\t \n  坑爹的程序猿    \n     2014-08-26 20:19 |    \t\t红客十年 \t\t\t( 普通白帽子  |\t\t\t        Rank:334 漏洞数:63        | 去年离职富士康，回到家中上蓝翔，蓝翔毕业...)\t\t \n  记者同志看这里看这里……    \n     2014-08-30 11:23 |    \t\t云云 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 我就一个马甲还要填信息？)\t\t \n  马上又有库了！幸好我用的移动。    \n     2014-08-30 12:02 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  联不通用户：沃靠！    \n     2014-10-09 13:34 |    \t\tx1aog \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 打酱油)\t\t \n  靠，我对你的破解能力很看好，说说配置呗    \n     2014-10-09 14:23 |    \t\t鱼化石 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:18        | 介绍不能为空)\t\t \n  洞主的爆破筒貌似很牛X    \n     2014-10-09 15:20 |    \t\t小卖部部长 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:3        | 别拿部长不当干部！)\t\t \n  @云云 呵呵，移动裤也有，至少四川我能看到~~    \n     2014-10-10 00:12 |    \t\t金枪银矛小霸王 \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:25        | 不会挖洞洞的猿猿不是好学生)\t\t \n  这是什么反编译工具    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}