{"id": 47151, "wybug_id": "wooyun-2015-094484", "wybug_title": "大麦网某处敏感信息再次泄露(安全是动态的)", "wybug_corp": "大麦网", "wybug_author": "jaffer", "wybug_date": "2015-01-29 10:43", "wybug_open_date": "2015-02-03 10:44", "wybug_type": "服务弱口令", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-03：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： rt用别人的手机注册，让别人无法注册。大麦网敏感信息泄露外加一个可以用任何手机邮箱注册的漏洞 详细说明：  1、大麦网rsync服务器弱密码\nrsync 58.83.157.187::website\n\ndrwxr-xr-x           0 2015/01/13 15:25:10 .-rw-r--r--     4144684 2014/04/24 11:06:30 mchannelcms.damai.cn.rar-rw-r--r--     4313299 2012/11/28 14:22:04 mm.rar-rw-r--r--          11 2011/10/27 16:10:44 nagiostest.htmdrwxr-xr-x           0 2014/12/09 15:15:59 163.m.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 AppMultiple.damai.cndrwxr-xr-x           0 2015/01/12 02:40:16 AppPlatforms.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 MobileValidatedrwxr-xr-x           0 2015/01/12 02:40:18 NewSh.piao.com.cndrwxr-xr-x           0 2014/04/23 01:19:41 NewYear2012.damai.cndrwxr-xr-x           0 2015/01/12 02:40:19 Newother.piao.com.cndrwxr-xr-x           0 2014/11/12 10:25:10 Piao2009Admindrwxr-xr-x           0 2014/04/23 01:19:43 Pony.damai.cndrwxr-xr-x           0 2012/05/31 17:19:19 admin.piao.com.cn90drwxr-xr-x           0 2014/04/23 01:19:43 admin.piao.com.cn91drwxr-xr-x           0 2014/10/31 21:13:37 alipay.m.damai.cndrwxr-xr-x           0 2014/04/23 01:19:41 alladmindrwxr-xr-x           0 2015/01/12 02:40:16 anti.damai.cndrwxr-xr-x           0 2012/05/28 15:26:40 api.flash.damai.cndrwxr-xr-x           0 2014/12/03 01:59:54 api.movie.damai.cndrwxr-xr-x           0 2014/04/23 01:19:41 api.scorecenter.damai.cndrwxr-xr-x           0 2014/12/09 10:50:39 banka.damai.cndrwxr-xr-x           0 2012/05/28 15:12:19 biz.damai.cndrwxr-xr-x           0 2015/01/12 02:40:19 bj.piao.com.cndrwxr-xr-x           0 2012/05/31 17:28:31 bus.piao.com.cndrwxr-xr-x           0 2014/06/17 21:45:42 cd_en_piaodrwxr-xr-x           0 2013/01/15 20:17:28 cdadmin.piao.com.cndrwxr-xr-x           0 2011/10/27 16:13:15 city.piao.com.cndrwxr-xr-x           0 2014/04/23 01:19:41 classical.damai.cndrwxr-xr-x           0 2014/09/15 11:09:31 cmb.m.damai.cndrwxr-xr-x           0 2014/04/23 01:19:41 cms.damai.cndrwxr-xr-x           0 2015/01/20 23:46:33 cms1.damai.cndrwxr-xr-x           0 2011/10/27 16:13:31 cooperdrwxr-xr-x           0 2014/04/23 01:19:41 cp.piao.cndrwxr-xr-x           0 2015/01/12 02:40:17 cpe.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 cpgateway.piao.com.cndrwxr-xr-x           0 2015/01/12 02:40:20 d.damai.cndrwxr-xr-x           0 2011/10/27 16:14:33 damai.95516.netdrwxr-xr-x           0 2015/01/08 21:34:12 damaisdk_datadrwxr-xr-x           0 2012/11/20 21:13:18 dianjiang.damai.cndrwxr-xr-x           0 2012/05/31 19:48:46 dianjiang1.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 dianjiang2.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 diy.damai.cndrwxr-xr-x           0 2012/06/02 23:26:39 djmanage.damai.cndrwxr-xr-x           0 2012/06/02 23:26:39 djmanage1.damai.cndrwxr-xr-x           0 2015/01/12 02:40:16 djmanage2.damai.cndrwxr-xr-x           0 2014/04/23 01:19:41 drama.damai.cndrwxr-xr-x           0 2014/07/02 21:59:40 e.damai.cndrwxr-xr-x           0 2012/06/14 19:38:17 e1.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 edm.damai.cndrwxr-xr-x           0 2015/01/12 02:40:19 en.piao.com.cndrwxr-xr-x           0 2014/10/31 00:13:55 en_piaodrwxr-xr-x           0 2015/01/12 02:40:16 enmanage.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 ewalletdrwxr-xr-x           0 2015/01/12 02:40:19 fansaction.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 fenghuang.damai.cndrwxr-xr-x           0 2015/01/12 02:40:20 global.damai.cndrwxr-xr-x           0 2014/10/31 00:17:45 gz_en_piaodrwxr-xr-x           0 2013/06/04 17:38:08 gzadmin.piao.com.cndrwxr-xr-x           0 2013/07/01 10:23:21 gznews.piao.com.cndrwxr-xr-x           0 2014/05/22 10:06:18 i.damai.cndrwxr-xr-x           0 2013/08/27 18:24:34 jf.damai.cndrwxr-xr-x           0 2015/01/12 02:40:19 jp_piaodrwxr-xr-x           0 2014/10/30 20:08:06 kids.damai.cndrwxr-xr-x           0 2011/09/05 14:02:08 kr_piaodrwxr-xr-x           0 2014/04/23 01:19:41 live.damai.cndrwxr-xr-x           0 2015/01/12 02:40:19 lycprogramorderdealdrwxr-xr-x           0 2015/01/20 16:50:59 m.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 mai.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 manti.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 mapi.damai.cndrwxr-xr-x           0 2015/01/12 02:40:19 mark.damai.cndrwxr-xr-x           0 2014/04/23 01:19:41 matix.netdrwxr-xr-x           0 2015/01/12 02:40:18 mayday3d.damai.cndrwxr-xr-x           0 2014/04/23 01:19:42 mball.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 mbanka.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 mchannelcms.damai.cndrwxr-xr-x           0 2015/01/12 02:40:19 mdianying.damai.cndrwxr-xr-x           0 2015/01/12 02:40:19 mdrama.damai.cndrwxr-xr-x           0 2014/04/23 01:19:43 metasearch.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 mjf.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 mmessage.damai.cndrwxr-xr-x           0 2015/01/12 02:40:16 mmovie.damai.cndrwxr-xr-x           0 2015/01/12 02:40:19 mmsg.damai.cndrwxr-xr-x           0 2015/01/12 02:40:19 mnews.damai.cndrwxr-xr-x           0 2014/04/23 01:19:41 mobile.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 mobileapi.damai.cndrwxr-xr-x           0 2014/12/03 01:09:43 movie.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 moviesitedrwxr-xr-x           0 2014/03/06 21:13:04 moviex.damai.cndrwxr-xr-x           0 2015/01/12 02:40:20 mpay.damai.cndrwxr-xr-x           0 2014/11/27 09:23:57 mperform.damai.cndrwxr-xr-x           0 2015/01/15 09:53:35 mperform1.damai.cndrwxr-xr-x           0 2012/10/25 23:50:12 mperfrom.damai.cndrwxr-xr-x           0 2014/04/23 01:19:41 mpopup.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 mprivilege.damai.cndrwxr-xr-x           0 2014/04/23 01:19:44 mqa.damai.cndrwxr-xr-x           0 2015/01/12 02:40:20 mrock.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 mscore.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 mshop.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 mshoping.damai.cndrwxr-xr-x           0 2014/01/14 12:17:07 msubcenter.damai.cndrwxr-xr-x           0 2014/04/23 01:19:48 msuperticket.damai.cndrwxr-xr-x           0 2015/01/27 17:46:51 mtang.damai.cndrwxr-xr-x           0 2015/01/12 02:40:20 mtravel.damai.cndrwxr-xr-x           0 2014/11/06 20:36:36 muserdata.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 mvenue.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 mwarn.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 news.damai.cndrwxr-xr-x           0 2012/07/02 11:08:57 news.piao.com.cndrwxr-xr-x           0 2015/01/12 02:40:19 nothingSitedrwxr-xr-x           0 2015/01/12 02:40:20 npapi.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 open.damai.cndrwxr-xr-x           0 2015/01/12 02:40:19 page.damai.cndrwxr-xr-x           0 2015/01/12 02:40:19 paytemp.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 perdrwxr-xr-x           0 2014/01/14 12:18:03 permmovie.damai.cndrwxr-xr-x           0 2014/12/25 23:21:53 permovie.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 psm.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 qinz.damai.cndrwxr-xr-x           0 2014/03/06 21:13:14 rock.damai.cndrwxr-xr-x           0 2014/10/30 22:10:40 s.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 sadmin.damai.cndrwxr-xr-x           0 2012/06/02 23:29:40 sadmin.piao.com.cndrwxr-xr-x           0 2014/12/09 15:39:01 sale.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 sbuy.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 seoeedrwxr-xr-x           0 2011/08/31 03:13:31 sh.piao.com.cndrwxr-xr-x           0 2011/09/05 14:05:45 sh.piao.com.cn90drwxr-xr-x           0 2013/08/09 11:24:37 sh_en_piaodrwxr-xr-x           0 2011/10/27 16:46:08 shnews.piao.com.cndrwxr-xr-x           0 2015/01/12 02:40:20 sina.damai.cndrwxr-xr-x           0 2014/10/31 08:37:16 sinabuy.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 sseat.damai.cndrwxr-xr-x           0 2015/01/12 02:40:20 super.damai.cndrwxr-xr-x           0 2014/04/23 01:19:46 superticket.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 t.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 tang.damai.cndrwxr-xr-x           0 2014/04/23 01:19:43 train.piao.com.cndrwxr-xr-x           0 2015/01/12 02:40:18 travel.damai.cndrwxr-xr-x           0 2014/03/13 15:19:55 traveloff.damai.cndrwxr-xr-x           0 2015/01/12 02:40:16 union.damai.cndrwxr-xr-x           0 2015/01/12 02:40:20 unioncms.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 venue.damai.cndrwxr-xr-x           0 2015/01/12 02:40:19 wangzhanhoutai2009.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 wap.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 wr.piao.com.cndrwxr-xr-x           0 2015/01/12 02:40:20 www.3721inn.comdrwxr-xr-x           0 2015/01/12 02:40:19 www.baotoo.comdrwxr-xr-x           0 2015/01/12 02:40:18 www.czslyydd.comdrwxr-xr-x           0 2015/01/12 02:40:17 www.maikr.comdrwxr-xr-x           0 2015/01/12 02:40:17 www.maitix.comdrwxr-xr-x           0 2011/09/05 14:54:57 www.piao.com.cndrwxr-xr-x           0 2015/01/12 02:40:19 zdj.damai.cndrwxr-xr-x           0 2015/01/12 02:40:17 zhaopin.damai.cndrwxr-xr-x           0 2015/01/12 02:40:18 zzj.damai.cn\n因为看大麦网官网有些是aspx，所以认为这可能是一些旧的网站备份。但是里面还是有很多敏感信息。主要集中在Web.config,以及一些链接数据库的asp文件上。完全可以下载。比如：ContoDb.asp文件。\nfunction OpenConn(sitename)\tif sitename=\"\" then response.Write \"OpenConn(sitename) 参数为空\":response.Redirect \"login.asp\":response.End()\t\tdim constr\tconstr=\"\"\tconstr = \"driver={sql server};server=192.168.68.175;database=newoldpiaodb;UID=piao2008;PWD=newpiao2008!@#\"\tdomain = \"www.piao.com.cn\"\t\tif sitename=\"44\" then\t\tdomain = \"tj.piao.com.cn\"\t\tsession(\"sitename\")=\"天津\"\tend if\tif sitename=\"24\" then\t\tdomain = \"xa.piao.com.cn\"\t\tsession(\"sitename\")=\"西安\"\tend if\tif sitename=\"42\" then\t\tdomain = \"cs.piao.com.cn\"\t\tsession(\"sitename\")=\"长沙\"\tend if\tif sitename=\"27\" then\t\tdomain = \"cd.piao.com.cn\"\t\tsession(\"sitename\")=\"成都\"\tend if\tif sitename=\"28\" then\t\tdomain = \"cq.piao.com.cn\"\t\tsession(\"sitename\")=\"重庆\"\tend if\tif sitename=\"46\" then\t\tdomain = \"suz.piao.com.cn\"\t\tsession(\"sitename\")=\"苏州\"\tend if\t\tif sitename=\"15\" then\t\tdomain = \"nj.piao.com.cn\"\t\tsession(\"sitename\")=\"南京\"\tend if\t\tif sitename=\"34\" then\t\tdomain = \"km.piao.com.cn\"\t\tsession(\"sitename\")=\"昆明\"\tend if\t\tif sitename=\"50\" then\t\tdomain = \"gy.piao.com.cn\"\t\tsession(\"sitename\")=\"贵阳\"\tend if\t\tif sitename=\"31\" then\t\tdomain = \"sz.piao.com.cn\"\t\tsession(\"sitename\")=\"深圳\"\tend if\t\tif sitename=\"4\" then\t\tdomain = \"gz.piao.com.cn\"\t\tsession(\"sitename\")=\"广州\"\tend if\t\tif sitename=\"26\" then\t\tdomain = \"hz.piao.com.cn\"\t\tsession(\"sitename\")=\"杭州\"\tend if\t\tif sitename=\"5\" then\t\tdomain = \"sh.piao.com.cn\"\t\tsession(\"sitename\")=\"上海\"\tend if\t\tif sitename=\"city\" then\t\tdomain = \"city.piao.com.cn\"\t\tsession(\"sitename\")=\"全国\"\t\tconstr=\"driver={sql server};server=220.181.68.175;database=city_piao_db;UID=piao_citys_site;PWD=site!))01\"\tend if\t\tdim seoconn\tset seoconn=server.CreateObject(\"adodb.connection\")\tresponse.write constr\tseoconn.open constr\t\tif err.number>0 then\t\tresponse.Write \"打开数据库失败\"\t\tresponse.End()\tend if\t\t\tset OpenConn = seoconnend function\n里面就包含了一些数据库用户名密码。尝试去同步，发现不成功，IP地址220.181.68.175也ping不通。Web.config里面的一些敏感内容如下：\n<configSections>    <section name=\"voosay.controller\" type=\"Voosay.Web.Framework.ControllerSection, Voosay.Web, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\" allowLocation=\"true\" allowDefinition=\"Everywhere\" allowExeDefinition=\"MachineToApplication\" overrideModeDefault=\"Allow\" restartOnExternalChanges=\"true\" requirePermission=\"true\" />  </configSections>  <!--  voosay.controller节点用于指定页面表现层所在的程序集，以及名称空间  -->  <voosay.controller assembly=\"App.Controller, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null\" namespace=\"App.Controller.Pages\" />  <appSettings>    <add key=\"ImgServer\" value=\"http://pimg.damai.cn/\"/>     <add key=\"changan_venueid\" value=\"69\"/>     <add key=\"need_devide_maitix\" value=\"10009\" />    <add key=\"ippath\" value=\"|APPBASE|IP_Data\\QQWry.Dat\"/>    <add key=\"xmlpath\" value=\"D:\\work\\website\\AppPlatforms.damai.cn\\View\\Manage\\ChangAn\\Excel\\\" />    <add key=\"vendorIdMSG\" value=\"5\" />    <add key=\"passwordMSG\" value=\"piaowu_cupclub\" />    <add key=\"vendorId\" value=\"000000000000033\" />    <add key=\"password\" value=\"cum211.144.139.186\" />    <add key=\"Memcached_ServerList\" value=\"192.168.68.144:11211\" />    <add key=\"MongDB-thirdPiao\" value=\"server=192.168.68.144:10144\"/>    <add key=\"damaisdk\" value=\"system=third_universal;sess-timeout=30;log-out=logs;\"/>    <add key=\"LiveConnectionString\" value=\"Data Source=192.168.68.161\\SQLpointA,14330;Initial Catalog=piao_3.0;User ID=Piao_3.0_owner;Password=bEEv@#$fghcx12\" />    <add key=\"BJMatixConnectionString\" value=\"Data source=192.168.68.161\\SQLpointA,14330;Initial Catalog=PiaoCenterDB;User ID=PiaoCenterDB_owner;Password=45GG6f!!@@$$^d;Connect Timeout=60000\" />    <add key=\"SHMatixConnectionString\" value=\"Data Source=192.168.68.161\\SQLpointA,14330;Initial Catalog=SH_PiaoCenterDB;User ID=SH_PiaoCenterDB_owner;Password=xcBBv1!@#%^20;Connect Timeout=60000\" />    <add key=\"GZMatixConnectionString\" value=\"Data Source=192.168.68.161\\SQLpointA,14330;Initial Catalog=GZ_PiaoCenterDB;User ID=GZ_PiaoCenterDB_owner;Password=kuyDD)(*^%t46;Connect Timeout=60000\" />      </appSettings>  <connectionStrings>    <add name=\"BJMatix\" connectionString=\"Data source=192.168.68.161\\SQLpointA,14330;Initial Catalog=PiaoCenterDB;User ID=PiaoCenterDB_owner;Password=45GG6f!!@@$$^d;Connect Timeout=60000\" providerName=\"System.Data.SqlClient\"/>    <add name=\"shopping\" connectionString=\"Data Source=192.168.68.162\\SQLpointB,14332;Initial Catalog=Shopping;User ID=shopping_owner;Password=45R6nFF#$%dfggf;Connect Timeout=60000\" providerName=\"System.Data.SqlClient\"/>    <add name=\"crm\" connectionString=\"packet size=8192;user id=CRM_owner;password=ytr(DD)F%$#!789;data source=192.168.68.162\\SQLpointB,14332;persist security info=false;initial catalog=CRM;Connect Timeout=120\" providerName=\"System.Data.SqlClient\" />    <add name=\"AppPlatforms\" connectionString=\"Data Source=192.168.68.162\\SQLpointB,14332;database=cp;uid=CP_owner;pwd=))NVN((*$002YUY\" providerName=\"System.Data.SqlClient\" />    <add name=\"kaixin\" connectionString=\"Data Source=192.168.68.163\\SQL2008,14332;user id=kaixin_owner;password=J##$$@@KL456;database=kaixin;\" providerName=\"System.Data.SqlClient\"/>    <add name=\"AppPlatforms_old\" connectionString=\"Data Source=192.168.68.163\\SQL2008,14332;user id=ChinaPay_owner;password=FFDSD!@#GHLK;database=ChinaPay;\" providerName=\"System.Data.SqlClient\"/>  </connectionStrings>  <system.web>\n很多内网的数据库的密码用户之类的。里面还有很多组件之类的。东西实在是太多了。可以挖掘的东西也是太多了。2 一个可以注册完所有手机和email的漏洞域：cmb.damai.cn:这个域下面也特别有趣。用户如果没有在这个域下登陆，就会被要求登陆，或者注册。注册页面：http://cmb.m.damai.cn/reg.aspx?from=userinfo.aspx注册界面是这样的。\n\n直接输入手机号码就可以注册好嘛。不需要任何验证。而且这个域下注册的账号在其他域下是通用的，注册过的不能再注册了。那我可以干什么？？我可以立马将所有手机号码都注册一个大麦网，这样持有这个号码的用户就不能再注册大麦网了。我可以变相将所有没注册大麦网的用户都注册了，让他们不能注册。   漏洞证明：  \n\n任意手机注册那个可以现场注册。   修复方案：  1、rsync服务器权限控制2、建议安全人员对大麦网旗下所有的域进行安全检查。凭感觉，很多域下问题很多，静待挖掘。偶3、没进行安全检查的域不要上线。   版权声明：转载请注明来源 jaffer@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-02-03 10:44 厂商回复：  漏洞Rank：13  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-29 10:45 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  处理过的问题，莫名其妙在同一个地方又出现了，安全确实是动态的    \n     2015-02-03 13:57 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  居然忽略。。。乌云爱心补rank    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}