{"id": 66369, "wybug_id": "wooyun-2015-0128686", "wybug_title": "五车图书管理系统漏洞集合(越权/SQL注入/任意文件遍历/下载/上传）", "wybug_corp": "五车信息技术(北京)有限公司", "wybug_author": "路人甲", "wybug_date": "2015-07-25 17:08", "wybug_open_date": "2015-10-26 08:44", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-31：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-26：\t细节向公众公开  简要描述： 最后一次提该系统漏洞了五车图书管理系统漏洞集合(高危越权/SQL注入/任意文件遍历/任意文件下载/任意文件上传）包括：命令执行 ：N处高危越权：2处任意文件遍历：2处POST型SQL注入：5处GET型SQL注入：1处任意文件下载：1处任意文件上传：3处 详细说明：   注:命令执行重复关于我们:五车信息技术（北京）有限公司一直致力于数字出版领域应用，提供相关产品技术和服务。五车公司掌握的数字 出版核心技术与国际同步，可提供服务主导型模式（SOA）完全解决方 案，实现传统出版物数字化、商用数字内容、互联网文献信息资源的无缝集成，具有全球竞争力。   五车图书管理系统漏洞集合(命令执行/高危越权/SQL注入/任意文件遍历/任意文件下载/任意文件上传）包括：命令执行 ：N处高危越权：2处任意文件遍历：2处POST型SQL注入：5处GET型SQL注入：1处任意文件下载：1处任意文件上传：3处\n1、Struts-016命令执行漏洞：任何一个带.action的页面都存在任意命令执行漏洞！\n\n\n\n2、高危越权（两处）：/5clib/Inuseraction.action?actionkind=reg  增加管理员；增加后提示无权访问实质已经添加到了\n\n\n\n\n\n/5clib/property.action  参数配置 可配置以及获取WEB的物理路径\n\n\n\n\n\n3、POST 搜索型注入（五处）：/5clib/bookmanger.action?formAction=bookList /5clib/bookmanger.action?formAction=bookCatalogList/5clib/newsContextListAction.action/5clib/paperManage.action?formAction=paperList/5clib/userManage.action?formAction=userQuery测试Paload:【%' AND 1=1 AND '%'='】；下述所有页面中的keyword参数存在注入  \n\n\n\n\n\n\n\n4、GET型SQL注入（一处）：/5clib/classNavigation.action?formAction=zhongCatalog 该页面下类似：/5clib/classNavigation.action?formAction=subCatalog&ccode=000_000008&navigation=??? 的链接中ccode参数存在注入\n\n\n\n5、任意文件遍历（两处）：A：/5clib/kindaction.action?kind=music&subkind=subkind&curpage=1 kind可以为video、disc等，点上面的链接抓包subkind参数修改为遍历的路径\n\n\n\n\n\nB：/5clib/kinweblistaction.action?filePath=&kind=disc&curpage=1&actionName=&subkind=c:/windows&doAction=second&pagesize=20&curPage=1&toPage=\n\n\n\n\n\n6、任意文件上传：(三处)上传的时候修改为web的物理路径，可通过越权或者其它获取物理路径/5clib/addaction.action?kind=music/5clib/addaction.action?kind=video/5clib/addaction.action?kind=disc \n\n\n\n\n\n\n \n7、任意文件下载：（一处）/5clib/paperWeb.action?formAction=paperDownLoad&fileName=/../WEB-INF/classes/config/struts-action.xml\n\n\n   漏洞证明：  Case:\nhttp://183.64.83.104:8081/5clib/bookWeb.action?formAction=ztclass&ccode=000&class=1http://222.208.6.176:8081/5clib/web.action?formAction=getWebListhttp://lyqk.xjlib.org:8081/5clib/web.action?formAction=getWebListhttp://sybook.5clib.com:8081/bookWeb.action?formAction=ztclass&ccode=000&class=1http://210.44.232.43:8081/5clib/bookWeb.action?formAction=ztclass&ccode=000&class=1...因漏洞危害大，不列举太多...\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-07-28 08:43 厂商回复： CNVD确认所述情况，已由CNVD通过软件生产厂商公开联系渠道向其邮件（和电话）通报，由其后续提供解决方案并协调相关用户单位处置。 按多个风险点评分，rank 20 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-23 17:27 |    \t\t闪电小子 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:5        | PKAV技术宅社区！---闪电小子！)\t\t \n  学富五车，6666    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}