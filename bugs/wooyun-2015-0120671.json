{"id": 29019, "wybug_id": "wooyun-2015-0120671", "wybug_title": "同济大学某站文件上传（可getshell）", "wybug_corp": "同济大学", "wybug_author": "Aerfa21", "wybug_date": "2015-06-15 19:05", "wybug_open_date": "2015-07-30 19:42", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传漏洞", "文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向公众公开  简要描述： dvbbs 8.2 文件上传漏洞，虽然对注册用户进行了各种限制，但经过不断尝试，最终还是上传成功获得shell（请自行删除）。在此主要介绍一下上传遇到的问题和一些尝试。 详细说明：  \n目标：mat.tongji.edu.cn/bbs\n\n0x01 post方法不允许注册用户： test / test123上传页面： http://mat.tongji.edu.cn/bbs/mymodify.asp 上传过程： 修改头像处上传图片马xx.asp;.gif（该场景为IIS 6.0 存在解析漏洞）上传结果： 成功，用菜刀连接失败（这也是意料之中了）\n\n\n\n0x02 突破post禁用失败针对http post方法被禁用，尝试了几种解决办法：①更换上传目录；②尝试上传大马；③使用BS木马....均以失败告终\n\n0x03 利用dvbbs弱口令，以admin身份上传成功下载相同模板进行分析，尝试了数据库下载、fckeditor等均未果。尝试默认管理员账号密码进入：admin  admin888\n\n\n进入后台后，赶紧找上传的地方：①论坛基本设置：可以修改上传后的文件目录②论坛版面分类：可以修改上传文件类型在这里，Firefox不支持发新帖添加附件，可以使用360浏览器。在后台添加了asp/asa/cer/cdx类型的文件，显示仍然不能上传成功。但实际已经成功上传。\n\n\n\n\nhttp://mat.tongji.edu.cn/bbs/UploadFace/2015-5/cun.asp  cun\n\n\n未深入....   漏洞证明：  如上   修复方案：  修改默认口令；只要是上传点都应该做加固。   版权声明：转载请注明来源 Aerfa21@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-06-15 19:41 厂商回复： 可能是以前提前提交的漏洞，现BBS功能已经关闭，还是感谢提醒。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}