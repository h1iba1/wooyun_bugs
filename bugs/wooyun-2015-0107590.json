{"id": 33965, "wybug_id": "wooyun-2015-0107590", "wybug_title": "中国电信全球眼业务平台通用程序Jboss漏洞", "wybug_corp": "中国电信全球眼业务平台", "wybug_author": "myh0st", "wybug_date": "2015-04-14 18:13", "wybug_open_date": "2015-06-01 14:18", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-01：\t细节向公众公开  简要描述： 中国电信全球眼业务平台通用程序Jboss漏洞,导致获取webshell 详细说明：  问题IP：http://222.76.124.135/Jboss 漏洞说明:http://www.1337day.com/exploit/23480该IP上运行着一个Jboss的通用程序，由于Jboss的漏洞导致过去webshell\n\n下面是这个linux hosts文件的内容，初步判断是属于电信的[/opt/inms/jboss-6.1.0.Final/common/deploy/admin-console.war/]$ cat /etc/hosts127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4::1         localhost localhost.localdomain localhost6 localhost6.localdomain6222.76.124.135  fjvam_oc1134.129.65.206\tfjvam_c12222.77.183.170  fjvam_c18 #117.27.130.49  localhost.localdomain localhost#117.27.130.122 WIN-Q7D3FVPZ6AA117.27.130.123 WINDOWS-O5LMI9S#117.27.130.126 WINDOWS-UBWHF8C117.27.130.124 WINDOWS-G0X3A2X#移动全球眼117.27.130.104 msp1117.27.130.106 msp3117.27.130.107 fzWebservice1117.27.130.108 fzWebservice2117.27.130.113 WIN-3LCB9S9VL4T117.27.130.114 WIN-KNOLK2IUTTC117.27.130.120 PSS-3117.27.130.22 WIN-DVJFKLQ1PNK117.27.130.23 WIN-1MQUYZPDS1P117.27.130.125 WINDOWS-L4RU46W117.27.130.122 WIN-Q7D3FVPZ6AA#固网全球眼222.77.183.29 wangguanserver222.77.183.46   loghost.loghost.com222.77.183.50 rizhiserver-1222.77.183.51 access5_51222.77.183.52 WEBserver202.101.126.201 SMjieru01202.101.126.202 SMjieru02222.77.183.54  access2_back222.77.183.55  access1_back222.77.183.56  access4_back222.77.183.57  access3_back222.77.183.58 oracle_back222.77.183.70  access6_back222.77.183.71  access5_back222.77.183.141 access05_master222.77.183.142 access06_master222.77.183.143 access07_master222.77.183.144 access7_back222.77.183.145  update222.77.183.152 lvs01222.77.183.153 lvs02222.77.183.154 access01_master222.77.183.155 access02_master222.77.183.156 access03_master222.77.183.157 access04_master222.77.183.166 update222.77.183.167 Fz_Jiaojing_Access222.77.183.191 access5_191#222.77.183.223 center02_back222.77.183.73  97_01#固网全球眼09扩容222.77.183.37 center01_back222.77.183.39 oracle-back222.77.183.40 center04_back#222.77.183.148 center02_back              loghost center02_back.com222.77.183.148 center02_back  222.77.183.149  center03_back117.27.130.28 ky-qqy117.27.130.30 store2117.27.130.37 WIN-MY8SXKCD0BW117.27.130.38 localhost117.27.130.41 megaeyes117.27.130.42 oracle01.localdomain.com117.27.130.45 oracle02.localdomain.com117.27.130.21 zxserver-117.27.130.21117.27.130.27 cuncserver-117.27.130.27117.27.130.25 ffserver-117.27.130.25222.77.183.150 node1_boot1222.77.183.151 node2_boot1222.77.183.158 node1_boot1 node2_boot1#大众全球眼222.77.183.74  jboss-74222.77.183.209 dz_access01222.77.183.210 dz_access02222.77.183.212 dz_access03222.77.183.213 dz_access04222.77.183.215 dz_duanxin222.77.183.228 dz_web01222.77.183.229 dz_web02222.77.183.231 dz_center01222.77.183.232 dz_center02222.77.183.233 dz_disp01222.77.183.236 dz_shengxun#固网全球眼2010扩容222.77.183.27 jrserver-222.77.183.27117.27.130.49 ISMP-01222.77.183.203 center203222.77.183.31  vpncenter1222.77.183.223 jboss-223#宁德全球眼61.131.25.147 NDupdate61.131.25.163 NDwangguan0261.131.25.139 NDduanxin61.131.25.174 ehomeWeb161.131.25.175 ehomeWeb2222.77.146.71 vauc1222.77.146.72 vauc2222.77.146.68 NDvaum1222.77.146.69 NDvaum2222.77.146.74 NDWebService1222.77.146.75 NDWebService261.131.25.158 NDlogserver222.77.146.81 localhost.localdomain222.77.146.82 localhost.localdomain222.77.146.78 localhost.localdomain222.77.146.83 msp_1222.77.146.84 msp_2222.77.146.91 tupian222.77.146.92 peizhi61.131.25.177 NDaccess0161.131.25.178 NDaccess0261.131.25.181 NDcenter0161.131.25.182 NDcenter0261.131.25.152 NDoracle0161.131.25.153 NDoracle0261.131.25.179 NDaccess0361.131.25.180 NDaccess0461.131.25.183 NDcenter0361.131.25.184 NDcenter0461.131.25.189 access0561.131.25.190 NDcenter0561.131.25.145 NDstorage0261.131.25.148 zhuangtai0161.131.25.149 zhuangtai02#莆田全球眼218.6.16.29 PTweb218.6.16.30 shengji-server218.6.16.83 WIN-4ENPW7TB2EQ218.6.16.84  vum2218.6.16.3  PTjieru01218.6.16.4  PTjieru02218.6.16.23 PTzhongxin01218.6.16.24 PTzhongxin02218.6.16.34 rac2 218.6.16.33 rac1218.6.16.37 oracle_bak 218.6.16.31 logserver218.6.16.5  access3-5218.6.16.25 center3_25218.6.16.48 access4_48218.6.16.51 access5_51218.6.16.52 access-52218.6.16.49 zhuangtai_49218.6.16.26 center_26218.6.16.28 center_dz#云平台110.84.128.27 WIN-I8HQ26R1V8J#翼校通平台61.131.51.122 ONECARD-APP1#入云平台--天翼景象110.84.128.75 tyjxdb#厦门全球眼117.25.223.2 XMjieru01117.25.223.3 XMjieru02117.25.223.4 XMjieru03117.25.223.5 XMzhongxin01117.25.223.6 XMzhongxin02117.25.223.7 XMzhongxin03117.25.223.9 XMweb117.25.223.12  XMdba117.25.223.14 XMjieru04117.25.223.15 XMjieru05117.25.223.16 XMzhongxin04117.25.223.26 XMzengzhi117.25.223.70 XMDZweb04117.25.223.57 WIN-QV5QLEMWSHR117.25.223.64 XMDZzhongxin01117.25.223.65 XMDZzhongxin02117.25.223.67 XMDZweb01117.25.223.68 XMDZweb02117.25.223.69 XMDZweb03117.25.223.70 XMDZweb04117.25.223.106 XMjieru6117.25.223.107 XMjieru7117.25.223.108 XMzhongxin06117.25.223.109 XMzhongxin07117.25.223.116 XMjieruzt02#三明全球眼218.67.62.22  SMcunchu07218.67.62.13  SMcunchu02202.101.126.218 SMzhongxin03202.101.126.221 ehome_center1202.101.126.206 ehome_web1202.101.126.207 ehome_web2202.101.126.209 shengxuejiekou202.101.126.216 SMzhongxin01202.101.126.217 SMzhongxin02202.101.126.233 SMdba202.101.126.211 SMzengzhi202.101.126.231 SMweb202.101.126.232 SMshengji202.101.126.203 smjieru03202.101.126.210 duanxin218.67.62.11 SMcunchu01218.67.62.12 SMcunchu02#sm-quanqiuyan202.101.126.221 duanxin202.101.126.205 SMjieru05202.101.126.236 SMjieru06202.101.126.237 SMjieru07202.101.126.220 SMzhongxin05202.101.126.225 SMzhongxin06202.101.126.226 SMzhongxin07202.101.126.252 SMjieruzhuangtai01202.101.126.253 SMjieruzhuangtai02202.101.126.238 SMjieru08202.101.126.227 SMzhongxin08202.101.126.239 SMjieru0902.101.126.228 SMzhongxin09#xm-quanqiuyan#172.16.2.116 XMjieruZT02117.25.223.116 XMjieruZT02#TSP59.56.74.51 NginxMaster59.56.74.52 Business359.56.74.53 MessageIFMaster下面是root的用户的bash记录，可以证明这个主机是可以到达很多地方的rm JbossMonitor.logrm jboss-6.1.0.Final/server/all/log/server.logsh ./run.shexitpwdsu - inmsexitsu -touchessujava -versionllpwdsu - inmsllps -ef|grep jbossdatepwdsu - inmsexitps -ef |grep jbosspwdcd /opt/inmsllvi JbossMonitor.logcd jboss-6.1.0.Final/server/all/logllvi server.logexitllsu - inmsexitcd /opt/vamllps -ef |grep tomcatcd apache-tomcat-6.0.41llcd logsllmv catalina.out catalina.out.bak0211llcd ..llcd binll./startup.shcd ../logsllvi catalina.outdf -hexitlssu - inmsexitllcd /opt/inmscd /opt/vamllcd apache-tomcat-6.0.41llcd binsh ./shutdown.shps -ef |grep tomcatcd ../logsllmv catalina.out catalina.out.bak0213llrm catalina.out.bak1225cd ..cd binsh ./startup.shcd ../logslltail -f catalina.outdf -hexitsu - inmsexittelnet 117.27.130.28 10163telnet 117.27.130.28 10161nc -v -w2 117.27.130.28 10163nc -v -w2 117.27.130.28 10161nc -u -z -v -w2 117.27.130.28 10161nc -u -z -v -w2 218.6.16.31 10161nc -u -z -v -w2 117.27.130.113 10161nc -v -w2 117.27.130.113 10163nc -u -z -v -w2 117.25.223.81 10161nc -u -z -v -w2 218.6.16.51 10161nc -u -z -v -w2 117.25.223.16 10161nc -u -z -v -w2 117.25.223.26 10161nc -u -z -v -w2 222.77.183.209 10161nc -u -z -v -w2 222.77.183.145 10161nc -u -z -v -w2 202.101.126.211 10161nc -u -z -v -w2 202.101.126.202 10161nc -u -z -v -w2 202.101.126.201 10161ping 202.101.126.201nc -u -z -v -w2 218.6.16.55 161cd Testllsu - inmsexitnetstat -anp |grep 11165iptables -A INPUT -ptcp --dport 11165 -j ACCEPTnetstat -anp |grep 11165exit/etc/init.d/iptables status exitcd /etc/sshls -l sshd_configvi sshd_config/etc/init.d/sshd restartvi /etc/sysconfig/iptablesexit   漏洞证明：  问题IP：http://222.76.124.135/该IP上运行着一个Jboss的通用程序，由于Jboss的漏洞导致过去webshell\n\n下面是这个linux hosts文件的内容，初步判断是属于电信的[/opt/inms/jboss-6.1.0.Final/common/deploy/admin-console.war/]$ cat /etc/hosts127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4::1         localhost localhost.localdomain localhost6 localhost6.localdomain6222.76.124.135  fjvam_oc1134.129.65.206\tfjvam_c12222.77.183.170  fjvam_c18 #117.27.130.49  localhost.localdomain localhost#117.27.130.122 WIN-Q7D3FVPZ6AA117.27.130.123 WINDOWS-O5LMI9S#117.27.130.126 WINDOWS-UBWHF8C117.27.130.124 WINDOWS-G0X3A2X#移动全球眼117.27.130.104 msp1117.27.130.106 msp3117.27.130.107 fzWebservice1117.27.130.108 fzWebservice2117.27.130.113 WIN-3LCB9S9VL4T117.27.130.114 WIN-KNOLK2IUTTC117.27.130.120 PSS-3117.27.130.22 WIN-DVJFKLQ1PNK117.27.130.23 WIN-1MQUYZPDS1P117.27.130.125 WINDOWS-L4RU46W117.27.130.122 WIN-Q7D3FVPZ6AA#固网全球眼222.77.183.29 wangguanserver222.77.183.46   loghost.loghost.com222.77.183.50 rizhiserver-1222.77.183.51 access5_51222.77.183.52 WEBserver202.101.126.201 SMjieru01202.101.126.202 SMjieru02222.77.183.54  access2_back222.77.183.55  access1_back222.77.183.56  access4_back222.77.183.57  access3_back222.77.183.58 oracle_back222.77.183.70  access6_back222.77.183.71  access5_back222.77.183.141 access05_master222.77.183.142 access06_master222.77.183.143 access07_master222.77.183.144 access7_back222.77.183.145  update222.77.183.152 lvs01222.77.183.153 lvs02222.77.183.154 access01_master222.77.183.155 access02_master222.77.183.156 access03_master222.77.183.157 access04_master222.77.183.166 update222.77.183.167 Fz_Jiaojing_Access222.77.183.191 access5_191#222.77.183.223 center02_back222.77.183.73  97_01#固网全球眼09扩容222.77.183.37 center01_back222.77.183.39 oracle-back222.77.183.40 center04_back#222.77.183.148 center02_back              loghost center02_back.com222.77.183.148 center02_back  222.77.183.149  center03_back117.27.130.28 ky-qqy117.27.130.30 store2117.27.130.37 WIN-MY8SXKCD0BW117.27.130.38 localhost117.27.130.41 megaeyes117.27.130.42 oracle01.localdomain.com117.27.130.45 oracle02.localdomain.com117.27.130.21 zxserver-117.27.130.21117.27.130.27 cuncserver-117.27.130.27117.27.130.25 ffserver-117.27.130.25222.77.183.150 node1_boot1222.77.183.151 node2_boot1222.77.183.158 node1_boot1 node2_boot1#大众全球眼222.77.183.74  jboss-74222.77.183.209 dz_access01222.77.183.210 dz_access02222.77.183.212 dz_access03222.77.183.213 dz_access04222.77.183.215 dz_duanxin222.77.183.228 dz_web01222.77.183.229 dz_web02222.77.183.231 dz_center01222.77.183.232 dz_center02222.77.183.233 dz_disp01222.77.183.236 dz_shengxun#固网全球眼2010扩容222.77.183.27 jrserver-222.77.183.27117.27.130.49 ISMP-01222.77.183.203 center203222.77.183.31  vpncenter1222.77.183.223 jboss-223#宁德全球眼61.131.25.147 NDupdate61.131.25.163 NDwangguan0261.131.25.139 NDduanxin61.131.25.174 ehomeWeb161.131.25.175 ehomeWeb2222.77.146.71 vauc1222.77.146.72 vauc2222.77.146.68 NDvaum1222.77.146.69 NDvaum2222.77.146.74 NDWebService1222.77.146.75 NDWebService261.131.25.158 NDlogserver222.77.146.81 localhost.localdomain222.77.146.82 localhost.localdomain222.77.146.78 localhost.localdomain222.77.146.83 msp_1222.77.146.84 msp_2222.77.146.91 tupian222.77.146.92 peizhi61.131.25.177 NDaccess0161.131.25.178 NDaccess0261.131.25.181 NDcenter0161.131.25.182 NDcenter0261.131.25.152 NDoracle0161.131.25.153 NDoracle0261.131.25.179 NDaccess0361.131.25.180 NDaccess0461.131.25.183 NDcenter0361.131.25.184 NDcenter0461.131.25.189 access0561.131.25.190 NDcenter0561.131.25.145 NDstorage0261.131.25.148 zhuangtai0161.131.25.149 zhuangtai02#莆田全球眼218.6.16.29 PTweb218.6.16.30 shengji-server218.6.16.83 WIN-4ENPW7TB2EQ218.6.16.84  vum2218.6.16.3  PTjieru01218.6.16.4  PTjieru02218.6.16.23 PTzhongxin01218.6.16.24 PTzhongxin02218.6.16.34 rac2 218.6.16.33 rac1218.6.16.37 oracle_bak 218.6.16.31 logserver218.6.16.5  access3-5218.6.16.25 center3_25218.6.16.48 access4_48218.6.16.51 access5_51218.6.16.52 access-52218.6.16.49 zhuangtai_49218.6.16.26 center_26218.6.16.28 center_dz#云平台110.84.128.27 WIN-I8HQ26R1V8J#翼校通平台61.131.51.122 ONECARD-APP1#入云平台--天翼景象110.84.128.75 tyjxdb#厦门全球眼117.25.223.2 XMjieru01117.25.223.3 XMjieru02117.25.223.4 XMjieru03117.25.223.5 XMzhongxin01117.25.223.6 XMzhongxin02117.25.223.7 XMzhongxin03117.25.223.9 XMweb117.25.223.12  XMdba117.25.223.14 XMjieru04117.25.223.15 XMjieru05117.25.223.16 XMzhongxin04117.25.223.26 XMzengzhi117.25.223.70 XMDZweb04117.25.223.57 WIN-QV5QLEMWSHR117.25.223.64 XMDZzhongxin01117.25.223.65 XMDZzhongxin02117.25.223.67 XMDZweb01117.25.223.68 XMDZweb02117.25.223.69 XMDZweb03117.25.223.70 XMDZweb04117.25.223.106 XMjieru6117.25.223.107 XMjieru7117.25.223.108 XMzhongxin06117.25.223.109 XMzhongxin07117.25.223.116 XMjieruzt02#三明全球眼218.67.62.22  SMcunchu07218.67.62.13  SMcunchu02202.101.126.218 SMzhongxin03202.101.126.221 ehome_center1202.101.126.206 ehome_web1202.101.126.207 ehome_web2202.101.126.209 shengxuejiekou202.101.126.216 SMzhongxin01202.101.126.217 SMzhongxin02202.101.126.233 SMdba202.101.126.211 SMzengzhi202.101.126.231 SMweb202.101.126.232 SMshengji202.101.126.203 smjieru03202.101.126.210 duanxin218.67.62.11 SMcunchu01218.67.62.12 SMcunchu02#sm-quanqiuyan202.101.126.221 duanxin202.101.126.205 SMjieru05202.101.126.236 SMjieru06202.101.126.237 SMjieru07202.101.126.220 SMzhongxin05202.101.126.225 SMzhongxin06202.101.126.226 SMzhongxin07202.101.126.252 SMjieruzhuangtai01202.101.126.253 SMjieruzhuangtai02202.101.126.238 SMjieru08202.101.126.227 SMzhongxin08202.101.126.239 SMjieru0902.101.126.228 SMzhongxin09#xm-quanqiuyan#172.16.2.116 XMjieruZT02117.25.223.116 XMjieruZT02#TSP59.56.74.51 NginxMaster59.56.74.52 Business359.56.74.53 MessageIFMaster下面是root的用户的bash记录，可以证明这个主机是可以到达很多地方的rm JbossMonitor.logrm jboss-6.1.0.Final/server/all/log/server.logsh ./run.shexitpwdsu - inmsexitsu -touchessujava -versionllpwdsu - inmsllps -ef|grep jbossdatepwdsu - inmsexitps -ef |grep jbosspwdcd /opt/inmsllvi JbossMonitor.logcd jboss-6.1.0.Final/server/all/logllvi server.logexitllsu - inmsexitcd /opt/vamllps -ef |grep tomcatcd apache-tomcat-6.0.41llcd logsllmv catalina.out catalina.out.bak0211llcd ..llcd binll./startup.shcd ../logsllvi catalina.outdf -hexitlssu - inmsexitllcd /opt/inmscd /opt/vamllcd apache-tomcat-6.0.41llcd binsh ./shutdown.shps -ef |grep tomcatcd ../logsllmv catalina.out catalina.out.bak0213llrm catalina.out.bak1225cd ..cd binsh ./startup.shcd ../logslltail -f catalina.outdf -hexitsu - inmsexittelnet 117.27.130.28 10163telnet 117.27.130.28 10161nc -v -w2 117.27.130.28 10163nc -v -w2 117.27.130.28 10161nc -u -z -v -w2 117.27.130.28 10161nc -u -z -v -w2 218.6.16.31 10161nc -u -z -v -w2 117.27.130.113 10161nc -v -w2 117.27.130.113 10163nc -u -z -v -w2 117.25.223.81 10161nc -u -z -v -w2 218.6.16.51 10161nc -u -z -v -w2 117.25.223.16 10161nc -u -z -v -w2 117.25.223.26 10161nc -u -z -v -w2 222.77.183.209 10161nc -u -z -v -w2 222.77.183.145 10161nc -u -z -v -w2 202.101.126.211 10161nc -u -z -v -w2 202.101.126.202 10161nc -u -z -v -w2 202.101.126.201 10161ping 202.101.126.201nc -u -z -v -w2 218.6.16.55 161cd Testllsu - inmsexitnetstat -anp |grep 11165iptables -A INPUT -ptcp --dport 11165 -j ACCEPTnetstat -anp |grep 11165exit/etc/init.d/iptables status exitcd /etc/sshls -l sshd_configvi sshd_config/etc/init.d/sshd restartvi /etc/sysconfig/iptablesexit   修复方案：  你应该比我懂   版权声明：转载请注明来源 myh0st@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-04-17 14:17 厂商回复： CNVD未直接复现所述情况,已经转由CNCERT向中国电信集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}