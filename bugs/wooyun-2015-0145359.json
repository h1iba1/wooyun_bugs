{"id": 65894, "wybug_id": "wooyun-2015-0145359", "wybug_title": "如何用微信运动在朋友圈占据第一名", "wybug_corp": "腾讯", "wybug_author": "路人甲", "wybug_date": "2015-10-10 10:59", "wybug_open_date": "2015-10-13 17:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 两个多月前，朋友圈的同学们每天都“高谈阔步”，一走就是“几万里”。抱着学习的态度，萌生了这个bug。PS：没什么技术含量，大牛勿喷，纯属娱乐。 详细说明：  当使用第三方数据源向微信运动提交数据的时候，其实微信运动并没有校验数据的真实性，直接update到db。所以在提交数据的时候，我们抓个包，修改数据的steps，再提交给微信运动。这样微信运动里的steps就可以达到程序定义的max需要一个第三方app：乐动力将手机和电脑设置在同一vlan下，用电脑抓取乐动力手动提交给微信运动的数据包，修改steps，重新send。Response中\"status\": \"OK\"表示提交成功。\n\nRequest的请求数据：\nPOST /xq/io.ashx HTTP/1.1Content-Type: application/x-www-form-urlencoded; charset=UTF-8User-Agent: Dalvik/2.1.0 (Linux; U; Android 5.0.2; MI 2 MIUI/5.7.16)Host: pl.api.ledongli.cnConnection: Keep-AliveAccept-Encoding: gzipContent-Length: 262action=profile&pc=867064010207023&cmd=updatedaily&uid=2836992&list=%5B%7B%22date%22%3A1443369600%2C%22calories%22%3A0%2C%22activeValue%22%3A108%2C%22steps%22%3A99999%2C%22pm2d5%22%3A0%2C%22duration%22%3A0%2C%22distance%22%3A0%2C%22report%22%3A%22%5B%5D%22%7D%5D\n写了个python脚本，自己验证通过，其他人验证还不清楚。在运行脚本之前，需要先在脚本中编辑两个变量。stepsuid（uid在乐动力app的界面上）\n#coding: utf-8#date: 2015年9月29日01:50:37#usage: edit steps and ledongli's uid(u need to download this app) .That would be ok .Good luck. ^_^import requestsimport sysimport jsonimport datetimeimport timedef isnum(value):    try:        temp = int(value)    except Exception, e:        return False    else:        return True# like 2015-09-25 00:00:00 converts to unix time stampdef formatDate():    nowtime = datetime.datetime.now()    date = time.strftime('%Y-%m-%d')    strtemp_date = date + ' 00:00:00'    ledongli_date = time.strptime(strtemp_date, '%Y-%m-%d %H:%M:%S')    finaldate = time.mktime(ledongli_date) # rusult is 1443456000.0(float type), but still need to format to 1443456000    finaldate = int(finaldate)    return finaldatedef main(steps, uid):    if not isnum(steps):        print 'param error. steps must be an integer.'    url = 'http://pl.api.ledongli.cn/xq/io.ashx'    fake_headers = {                        'User-Agent'     : 'Dalvik/2.1.0 (Linux; U; Android 5.0.2; MI 2 MIUI/5.7.16)',                        'Content-Type'   : 'application/x-www-form-urlencoded; charset=UTF-8',                        'Accept-Encoding': 'gzip'                    }    keycontentjson = [                        {                            \"date\": formatDate(),                            \"calories\": 0,                            \"activeValue\": 108,                            \"steps\": steps,                            \"pm2d5\": 0,                            \"duration\": 0,                            \"distance\": 0,                            \"report\": \"[]\"                        }                     ]    # key is a str type    # key must be a json data convert to string    key = json.dumps(keycontentjson)    param = {                'action': 'profile',                'pc':     '867064010207023',                'cmd':    'updatedaily',                'uid':    uid,                'list':   key            }    r = requests.post(url, data = param, headers = fake_headers)    print r.text    print '_kazakhsoft曰：装逼成功'if __name__ == '__main__':    steps = 6666    uid = '34452077'    main(steps, uid)\n   漏洞证明：  \n\n   修复方案：  。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-10-13 17:02 厂商回复： 非常感谢您的反馈，经评估报告中反馈的漏洞并不属于腾讯业务漏洞，请反馈给相关厂商处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}