{"id": 80508, "wybug_id": "wooyun-2015-0155752", "wybug_title": "两种姿势重置飞客旅行网密码（1需要邮箱+2无需任何信息）", "wybug_corp": "飞客旅行网", "wybug_author": "路人甲", "wybug_date": "2015-11-25 12:12", "wybug_open_date": "2015-11-27 13:51", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-27：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 这个网站啊... 详细说明：  先说第一个姿势，很简单使用邮箱找回密码，会向你的邮箱发送一封邮件，通过链接修改密码然而 邮箱的格式是这样的 http://www.flyertrip.com/member/changepassword.php?p=xxxxxxx@xx.com.....测试时直接替换后面的邮箱地址就好了。。直接^^重置了。。接着是第二种姿势首先用自己的账号登陆个人中心，进行重置密码操作\n\n输入后拦截看看包里的内容\n\n这里面有 UserId=495; UserId__ckMd5=35051070e572e47d  这个俩个东西我的思路就是先替换着俩个值，userid 不用说了，剩下就是解密这个userid__ckmd5了，首先尝试拿那个值进行解密，无果。经过测试后发现~~\n\n看见红框里的值都明白了吧~~~所以果断尝试一下别人的值   漏洞证明：  在包里还有这个值UserName=2xxxxxxxxx%40qq.com; UserName__ckMd5=xxxxxxxxx;我直接给删掉了，然后测试的时候使用 399、400俩个账号进行测试登陆时直接用id登陆。。。\n\n\n\n这是399的账号\n\n这是400的。。   修复方案：  测试时修改了399、400的密码。。。望见谅。。主站还有xss，已经有人发过了 多检查一下吧。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-11-25 15:06 厂商回复： 谢谢！！！ 最新状态： 2015-11-27：已修改使用SESSIOIN替换COOKIE验证，找回密码增加验证码和邮箱的校验  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}