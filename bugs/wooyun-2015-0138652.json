{"id": 66043, "wybug_id": "wooyun-2015-0138652", "wybug_title": "苏宁某站SQL注入漏洞绕过修复已登录后台后台还有越权注入等漏洞", "wybug_corp": "江苏苏宁易购电子商务有限公司", "wybug_author": "路人甲", "wybug_date": "2015-09-02 17:42", "wybug_open_date": "2015-10-17 18:06", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["管理后台对外", "后台被猜解", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-17：\t细节向公众公开  简要描述： 据说有卡？ 详细说明：  漏洞是苏宁FOTA服务器系统缺陷报告服务器之前应该是登陆的时候登录框存在注入，简单去测试下，反正sqlmap默认的跑不出来改写下sqlmap的tamper，带入去注入，还是存在注入的\n\n存在注入后就跑库，拿登陆用户信息去登陆。这里我们就去反解mgbvfapo用户的密码\n\n浪费一毛钱解出来密码，还是挺复杂的\n\n然后就登陆后台了\n\n同时我们在没跑注入之前，已经猜到了一个弱口令用户低权限guset/guest什么权限都没有\n\n刚才解出的用户mgbvfapo登陆后，有意见反馈的查询权限\n\n觉得这后台这里应该也有注入，于是果断清空sqlmap的缓存，开跑，果断存在后台注入\nhttp://122.96.93.126/index.php?c=ufr&model=Pioneer+M1&fid=6\n\n\n同时觉得此处应该存在越权，于是登陆无任何权限的guest用户直接访问http://122.96.93.126/index.php?c=ufr&model=Pioneer+M1&fid=6也成功访问到意见反馈数据\n\n同时在我的账户请求下，抓包，看返回包，可以看到隐藏起来的功能菜单\n\n自己构造访问链接c=plist，也成功访问到本应该无法访问的功能\n\n同时可以看到cookies中，参数bug_salt就是明文的密码   漏洞证明：  见详细描述就算登录框不存在注入那我可以通过guest/guest 低权限账号登陆然后越权查看信息后台还可以注入得到高权限的账户信息危害还是挺多的   修复方案：  修复   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-09-02 18:05 厂商回复： 洞主给力，下班了还不忘挖个洞给我！！ 最新状态： 2015-09-07：路人甲pm下你的联系方式，美好的事情即将发生。  ", "replys": "漏洞评价：\n评论\n     2015-09-02 22:44 |    \t\t计算姬 \t\t\t( 普通白帽子  |\t\t\t        Rank:404 漏洞数:92        | 看我看我看我啊)\t\t \n  看到评论觉得对不起厂商了，应该让你有个美好的假期的~我的锅    \n     2015-09-03 14:27 |    \t\t-路人甲- \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:4        | 你的是我的,是我的还是我的，拿走也没用。)\t\t \n  9月3号放假的才是好公司啊。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}