{"id": 61924, "wybug_id": "wooyun-2013-037458", "wybug_title": "经纬中天-访谈直播应用管理系统任意文件上传漏洞", "wybug_corp": "北京经纬中天信息技术有限公司", "wybug_author": "刺刺", "wybug_date": "2013-09-18 12:27", "wybug_open_date": "2013-12-17 12:27", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-12-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 经纬中天-访谈直播应用管理系统某功能页面存在任意文件上传问题，无须登录。PS:客户网站需要调用这个系统的图片，于是检查了一下该系统，上传文件类型没有校验，此外该上传问题在几年前就有人利用了。 详细说明：  存在问题的页面：BVvisit20\\Tomcat-5.5_v5.0\\webapps\\ivss\\web\\jwzt\\service09\\meetingRoom\\upload_img.jsp该页面尽管是管理功能页面但是没有权限验证，可以直接访问。比如：http://cftv.forestry.gov.cn:8080/ivss/web/jwzt/service09/meetingRoom/upload_img.jsp这个系统不是太好找，在搜索引擎中搜索/ivss/web/jwzt可以找到一些例子。   漏洞证明：  以国家林业局为例：http://cftv.forestry.gov.cn:8080/ivss/web/jwzt/service09/meetingRoom/upload_img.jsp直接上传jsp脚本，提交以后在当前页查看源码就可以看到webshell的路径；\n\n上图中文件的时间是2012年，最近7月29和30日也有一兄弟在利用这个上传问题。\n\n\n\n\n\n   修复方案：  1. 去除废弃不用的页面；2.验证上传的文件格式；（建议增加服务端java验证而不仅仅是客户端的js验证）3.可能是版本比较杂，有的版本的后台管理多个页面没有权限验证；另外，国家林业局的http://cftv.forestry.gov.cn:8080/cms/frame/login.jsp这里是默认的admin  jwztadmin同样,流媒体管理系统 - BroadVision SOMS的上传功能的代码也是一塌糊涂。比如：cms/system/image_manage/upload_img.jsp只不过需要猜解一下nodeId，才可以成功得到上传webshell。   版权声明：转载请注明来源 刺刺@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-09-18 15:03 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  非常感谢审核管理员补图，学习了。以后一定不偷懒，下不为例，多谢。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}