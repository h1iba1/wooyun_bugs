{"id": 30821, "wybug_id": "wooyun-2015-0115629", "wybug_title": "JJ某功能越权操作", "wybug_corp": "竞技世界(北京)网络技术有限公司", "wybug_author": "小红猪", "wybug_date": "2015-05-25 11:08", "wybug_open_date": "2015-07-10 09:46", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-10：\t细节向公众公开  简要描述： JJ某功能越权操作及2个xss 详细说明：  1、越权为任意用户发说说～2、越权删除任意用户说说的评论或回复（测试发现不能删除其他用户的说说，唉..）。3、2个反射xss1、越权为任意用户发说说在发说说时，篡改用户id就可以了，简单吧，好玩吧～来，我们还是找那个代课老师吧，看下图：\n\n好，看到5月22号凌晨2点多发的说说，为不让鹏老师产生恐慌，咋们还是照发这条说说吧。用我的帐号登录，发说说，截断，篡改用户id，如下图：\n\n其中speak_notice值的内容就是说说的内容。放过该请求后提示发说说成功，又来到代课老师的页面，呀，真的发出去了，嘎嘎..\n\n再来一发，额。。\n\n唉，不能越权删说说，不好玩～2、越权删除任意用户说说的评论或回复同样的方法，在删除评论或回复时，篡改回复id（cid）就可以删除其他说说里的回复了。\n\n这里就不演示了，你们自己试试就知道了。3、反射型xss1）注册成功后，会有个提示，对应/reg/regsuccess.php文件，参数username可嵌入脚本并执行，验证链接：http://jj.cn/reg/regsuccess.php?siteid=0&nickName=&username=aaaa\"><iframe src=javascript:alert(/xss/)>&cardType=&promoterid=0看下图：\n\n2）在club里搜索时keywords参数可嵌入脚本并执行，验证链接：http://club.jj.cn/commune_join/join.php?keywords=aaa\"><script>alert(/xss/)</script>&act=search看下图：\n\n另外，为啥把密码加个密放在cookie里呢，不建议这么做。   漏洞证明：  参考详细说明里。   修复方案：  1、在发说说、删除评论时，进行身份校验；2、针对xss，在展示用户提交的数据时对特殊字符做转义。   版权声明：转载请注明来源 小红猪@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2015-05-26 09:45 厂商回复： 感谢，已提交相关技术人员处理了 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-26 09:52 |    \t\t竞技世界(北京)网络技术有限公司(乌云厂商)\t\t \n  能留下联系方法吗，想跟你交流一下    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}