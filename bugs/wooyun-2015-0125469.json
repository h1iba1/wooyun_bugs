{"id": 65825, "wybug_id": "wooyun-2015-0125469", "wybug_title": " 青果教务系统高危无限制注射(影响海量学校)", "wybug_corp": "湖南青果软件有限公司", "wybug_author": "路人甲", "wybug_date": "2015-07-09 10:45", "wybug_open_date": "2015-10-12 10:47", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-14：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-12：\t细节向公众公开  简要描述： 这么严重的SQL注射；青果会来确认吗？ 详细说明：  青果某系统存在无限制SQL注射；居然没有见到传说中的WAF拦截；并且大部分可以使用SQLMAP自动化注入测试工具进行测试；并且均为DBA权限；危害极大！SQL Injection：\n/_data/index_LOGIN.aspx   学生登录时UserID参数存在SQL注射漏洞\nCase: 99%以上都是存在该漏洞；我想我该Mask一下保护这些学生！审核员你说呢？\n\nmask 区域\n1.http://**.**.**/_data/index_LOGIN.aspx_2.http://**.**.**/xsweb//_data/index_LOGIN.aspx_3.http://**.**.**//_data/index_LOGIN.aspx_4.http://**.**.**/xsweb/_data/index_LOGIN.aspx_5.http://**.**.**/xsweb/_data/index_LOGIN.aspx_6.http://**.**.**/xsweb/_data/index_LOGIN.aspx_7.http://**.**.**/xsweb/_data/index_LOGIN.aspx_8.http://**.**.**/xsweb/_data/index_LOGIN.aspx_9.http://**.**.**/xsweb//_data/index_LOGIN.aspx_10.http://**.**.**/xsweb//_data/index_LOGIN.aspx_11.http://**.**.**/xsweb//_data/index_LOGIN.aspx_12.http://**.**.**/xsweb//_data/index_LOGIN.aspx_13.http://**.**.**/xsweb//_data/index_LOGIN.aspx_14.http://**.**.**/xsweb/_data/index_LOGIN.aspx_15.http://**.**.**/xsweb//_data/index_LOGIN.aspx_16.http://**.**.**/xsweb//_data/index_LOGIN.aspx_17.http://**.**.**/xsweb//_data/index_LOGIN.aspx_18.http://**.**.**/_data/index_LOGIN.aspx_19.http://**.**.**/xsweb//_data/index_LOGIN.aspx_20.http://**.**.**/xsweb//_data/index_LOGIN.aspx_21.http://**.**.**/xsweb//_data/index_LOGIN.aspx_22.http://**.**.**/xsweb//_data/index_LOGIN.aspx_23.http://**.**.**/xsweb//_data/index_LOGIN.aspx_24.http://**.**.**/_data/index_LOGIN.aspx_25.http://**.**.**/xsweb//_data/index_LOGIN.aspx_26.http://**.**.**/xsweb//_data/index_LOGIN.aspx_27.http://**.**.**/xsweb//_data/index_LOGIN.aspx_28.http://**.**.**/xsweb/(ratfv3201hlusmzcsyjkwn45)/_data/index_LOGIN.aspx_29.http://**.**.**/xsweb//_data/index_LOGIN.aspx_30.http://**.**.**/XSWEB//_data/index_LOGIN.aspx_31.http://**.**.**/xsweb//_data/index_LOGIN.aspx_32.http://**.**.**/xsweb//_data/index_LOGIN.aspx_33.http://**.**.**/xsweb//_data/index_LOGIN.aspx_34.http://**.**.**/xsweb//_data/index_LOGIN.aspx_35.http://**.**.**/_data/index_LOGIN.aspx_36.http://**.**.**/xsweb//_data/index_LOGIN.aspx_37.http://**.**.**/xsweb//_data/index_LOGIN.aspx_38.http://**.**.**/_data/index_LOGIN.aspx_39.http://**.**.**/_data/index_LOGIN.aspx_40.http://**.**.**/xsweb//_data/index_LOGIN.aspx_41.http://**.**.**/xsweb//_data/index_LOGIN.aspx_42.http://**.**.**/Xsweb//_data/index_LOGIN.aspx_43.http://**.**.**/_data/index_LOGIN.aspx_44.http://**.**.**/bzzyxs//_data/index_LOGIN.aspx_45.http://**.**.**/xsweb//_data/index_LOGIN.aspx_46.http://**.**.**/xsweb//_data/index_LOGIN.aspx_47.http://**.**.**/_data/index_LOGIN.aspx_48.http://**.**.**/xsweb//_data/index_LOGIN.aspx_49.http://**.**.**/xsweb//_data/index_LOGIN.aspx_50.http://**.**.**/xsweb//_data/index_LOGIN.aspx_51.http://**.**.**/_data/index_LOGIN.aspx_52.http://**.**.**/xsweb//_data/index_LOGIN.aspx_53.http://**.**.**/xsweb//_data/index_LOGIN.aspx_54.http://**.**.**/xsweb//_data/index_LOGIN.aspx_55.http://**.**.**/_data/index_LOGIN.aspx_56.http://**.**.**/_data/index_LOGIN.aspx_57.http://**.**.**/xsweb//_data/index_LOGIN.aspx_58.http://**.**.**/xsweb//_data/index_LOGIN.aspx_59.http://**.**.**/XSWEB//_data/index_LOGIN.aspx_60.http://**.**.**/xsweb//_data/index_LOGIN.aspx_61.http://**.**.**/xsweb//_data/index_LOGIN.aspx_62.http://**.**.**/xsweb//_data/index_LOGIN.aspx_63.http://**.**.**/xsweb//_data/index_LOGIN.aspx_64.http://**.**.**/_data/index_LOGIN.aspx_65.http://**.**.**/xsweb//_data/index_LOGIN.aspx_66.http://**.**.**//_data/index_LOGIN.aspx_67.http://**.**.**/xsweb//_data/index_LOGIN.aspx_68.http://**.**.**/_data/index_LOGIN.aspx_69.http://**.**.**/xsweb//_data/index_LOGIN.aspx_70.http://**.**.**/xsweb//_data/index_LOGIN.aspx_71.http://**.**.**/xsweb/_data/index_LOGIN.aspx_72.http://**.**.**/xsweb/_data/index_LOGIN.aspx_73.http://**.**.**//_data/index_LOGIN.aspx_74.http://**.**.**/_data/index_LOGIN.aspx_75.http://**.**.**/xsweb//_data/index_LOGIN.aspx_76.http://**.**.**/xsweb//_data/index_LOGIN.aspx_77.http://**.**.**//_data/index_LOGIN.aspx_78.http://**.**.**///_data/index_LOGIN.aspx_79.http://**.**.**/xsweb///_data/index_LOGIN.aspx_80.http://**.**.**/xsweb//_data/index_LOGIN.aspx\n\n   漏洞证明：  Security Testing\n手工1、\n\n\n\n\n\n2、SQLMAP自动化测试；使用SQLMAP自动化测试的方法就在于验证码会随机变换；经过测试在抓包获取POST提交数据后将CheckCode改为下一个验证码；注射参数后面*号标志即可绕过无限制SQL注射！POST /xsweb/_data/index_LOGIN.aspx HTTP/1.1Host: ***.**.***.**Proxy-Connection: keep-aliveContent-Length: 141Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://***.**.***.*User-Agent: **********************Content-Type: application/x-www-form-urlencodedReferer: http://***.**.***.*/xsweb/_data/index_LOGIN.aspxAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: ASP.NET_SessionId=rvmviarpqq0i3b3eemf5xmae__VIEWSTATE=dDwtMTc5NzIxMDUzMDs7PlnVMA1CpUQ5r4Nrg5HDOU7eG%2BMh&pcInfo=&typeName=&Sel_Type=STU&UserID=aaa*&PassWord=aaaaa&random=新的验证码&sbtState=\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-10-12 10:47 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-09 10:56 |    \t\tWeiy、 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:6        | 为了梦想我会一直前行、)\t\t \n  反正我很期待，我们学校就是用的这个系统，不知 洞主可以分享一下思路吗！！ 你懂的， 期末，请不要乱想哈！    \n     2015-07-09 12:02 |    \t\tMieless \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | 我是来打酱油的。)\t\t \n  我手上也有个洞，在考虑提不提交，毕竟这家企业几乎总是忽略，然后偷偷修复    \n     2015-07-09 12:14 |    \t\tWeiy、 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:6        | 为了梦想我会一直前行、)\t\t \n  @Mieless 嗯、可以拿到管理员的帐号吗？？    \n     2015-07-09 12:37 |    \t\tMieless \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | 我是来打酱油的。)\t\t \n  @Weiy、 可以，数据库地址端口账号密码都在手    \n     2015-07-09 16:13 |    \t\tWeiy、 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:6        | 为了梦想我会一直前行、)\t\t \n  @Mieless 可以看看我们学校吗？     \n     2015-07-09 16:15 |    \t\tWeiy、 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:6        | 为了梦想我会一直前行、)\t\t \n  @Mieless 可以给个联系方式吗？    \n     2015-07-10 11:06 |    \t\t大老赵 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 希望和大家一同学习交流)\t\t \n  @Mieless 可以给个联系方式吗    \n     2015-07-14 12:02 |    \t\tD_in \t\t\t( 普通白帽子  |\t\t\t        Rank:413 漏洞数:62        | 到我嘴里来)\t\t \n  mark    \n     2015-07-14 13:27 |    \t\tevil \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:21        )\t\t \n  mark    \n     2015-07-14 18:06 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:185 漏洞数:24        | 开发真是日了狗了)\t\t \n  好多学生党。。    \n     2015-07-14 22:53 |    \t\twhite hat \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:17        | 没有网络安全就没有国家安全，没有信息化就...)\t\t \n  怎么没有$$$    \n     2015-07-15 10:05 |    \t\tBloodwolf \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:8        | whoami)\t\t \n  青果的都是偷偷修复 很少给过，洞多了去了。随便X    \n     2015-07-15 10:17 |    \t\t大老赵 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 希望和大家一同学习交流)\t\t \n  青果每次都是无影响忽略漏洞，但是自己偷偷修复，最恶心    \n     2015-07-15 17:20 |    \t\t哎呦我去 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 新手白帽子！！继续努力)\t\t \n  又是忽略。。。    \n     2015-07-15 17:21 |    \t\t哎呦我去 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 新手白帽子！！继续努力)\t\t \n  @Mieless 有个什么洞啊？？可不可以分享下的咯     \n     2015-07-15 21:57 |    \t\twellbug \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:1        | 为人民服务)\t\t \n  11年曾经用这个系统的论坛注入拿到服务器权限.改过成绩和选课.    \n     2015-08-28 14:43 |    \t\t哎呦我去 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 新手白帽子！！继续努力)\t\t \n  @Mieless 居然还有青苹果的洞？    \n     2015-09-01 18:31 |    \t\t大蛮子 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 专注且低调，为人民服务!)\t\t \n  @Weiy、 大神，你好，洞主能否给个思路，谢谢啦    \n     2015-09-10 00:52 |    \t\twellsun \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | www.wellsun.com)\t\t \n  青果学生综合系统  跟  青果教务系统  是两个系统，1个是官方放弃升级了.一个是无限升级. 请分辨清楚,目测是xsweb的学生综合教务系统，sqlmapp --tamper 调用脚本即可绕过注射.    \n     2015-09-11 20:43 |    \t\t洛辰 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | 小白~~)\t\t \n  大神可以分享一下思路吗？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}