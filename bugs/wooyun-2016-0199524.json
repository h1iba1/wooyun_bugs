{"id": 87572, "wybug_id": "wooyun-2016-0199524", "wybug_title": "锦江之星账户体系不严导致集团全部人员邮箱泄露(附outlook联系人下载办法)                                      ", "wybug_corp": "锦江之星旅馆有限公司", "wybug_author": "路人甲", "wybug_date": "2016-04-23 00:54", "wybug_open_date": "2016-06-09 10:20", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "用户敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-09：\t细节向公众公开  简要描述： 总会有一两个弱口令的，有一两个又会引出后续更多的问题，更严重。感谢@HackBraid 大牛的教育 详细说明：  https://mail.jj-inn.com/owa/锦江之星的邮件系统，看了一下以前的漏洞，似乎很少有关于锦江之星邮箱弱口令的,基本上都是SQL注入类的，今天找到一枚弱口令邮箱\ngufang/1qaz@WSX\n看到跳转了，跳到了重置密码的页面，后来在邮箱里面发现有一个90天的周期，周期结束，强制更改密码，我估计这个账号已经很久没有人登陆了\n\n\n\n\n\n重置密码为：adm!n123，OK了\n\n邮箱有很多关于账号密码的邮件，且大部分都是弱口令\n\n\n\n后面发现很多账号使用的是1qaz2wsx,111111,a12345等弱口令(当然不是邮箱账号，而是分配给代理商的账号和密码)\n\n\n\n\n\n\nhttps://220.196.57.152:442/por/service.csp vpn地址\n使用账号密码登陆，没有vpn权限，看来还得找运维的人才是靠谱。\n\n   漏洞证明：  下面开始重点，就是outlook web app的联系人导出问题这个问题，我请教了@HackBraid 大牛，他告诉我，看一下这篇\n WooYun: 视频网站安全之优酷土豆账户体系控制不严引发内网漫游（涉及后台\\云平台主站\\内部商城全部源码\\100台服务器权限和数据库信息等） \n每个联系人都有一个特别的ID，如下面\n\n按分组，找到全部员工然后保存网页到本地\nhttps://mail.jj-inn.com/owa/?ae=Item&a=Open&t=ADDistList&id=K15rPYxhC0OQKMpSvP7uPw%3d%3d&pspid=_1461300333450_341817680\n自己写一个脚本程序，使用正则表达式将id提取出来，共计3000多个id\n\n由于变成不是很好，试着使用脚本访问https，一直出错，verify设置为False也不行，求教育。这条路子封了，我们还有别的路，对了burp suite，设置变量，将提出的id导入burp中，开跑了\n页面get包GET /owa/?ae=Item&a=Open&t=AD.RecipientType.User&id=§xvJJGKCHR0ayfdGVbJhkvw%3d%3d§&pspid=_1461299763468_260363118 HTTP/1.1Host: mail.jj-inn.comConnection: keep-aliveCache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.154 Safari/537.36 LBBROWSERAccept-Encoding: gzip, deflate, sdchAccept-Language: zh-CN,zh;q=0.8Cookie: MstrPgLd1=1; MstrPgLd2=1; OutlookSession=15b24012de8a4933869***909a092192; PBack=0; cadata=\"0mAqYK1o8RGO0J5O4f****8xJ2CoQkT+7xsdJ2XlPt3*****5zfJzlaAzk3IYW8KZCamJPaLIj0Q0wwW+***FDQ==\"; sessionid=8c87b22b-1****6-4a23-9073-1ee0d78f6b3f; UserContext=I8fkTxI27kWUL-lZbr2cp8z4piBDcNMIBjGhfTfhzZ7S73u99o-2vRYCXR8wJ6ELYTv***Gq1bk.; tzid=China Standard Time; owacsdc=1\n使用burp中的正则表达式提取邮箱\n\n很顺利拿到了全部邮箱\n\n   修复方案：  增强员工安全意识   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-04-25 10:10 厂商回复： 已确认，感谢提醒 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-23 12:12 |    \t\tPgHook \t\t\t( 普通白帽子  |\t\t\t        Rank:1020 漏洞数:123        | Portulaca grandiflora Hook.)\t\t \n  表示对outlook联系人下载办法感兴趣    \n     2016-04-25 15:10 |    \t\tMark0smith \t\t\t( 普通白帽子  |\t\t\t        Rank:172 漏洞数:70        | 我要是再正常一点就好了)\t\t \n  感興趣    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}