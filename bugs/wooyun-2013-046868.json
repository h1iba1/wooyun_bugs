{"id": 59573, "wybug_id": "wooyun-2013-046868", "wybug_title": "联想旗下某子公司严重信息泄漏及某业务系统struts漏洞", "wybug_corp": "联想", "wybug_author": "袋鼠妈妈", "wybug_date": "2013-12-24 18:19", "wybug_open_date": "2014-02-07 18:20", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "用户敏感信息泄露", "漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-07：\t细节向公众公开  简要描述： 联想旗下某子公司严重信息泄漏及某业务系统struts漏洞 详细说明：  \n阳光雨露信息技术服务(北京)有限公司(以下简称阳光雨露)是联想集团旗下的全资子公司，成立于2002年，是一家专注于 “IT专业服务”的服务型企业。十年来为国内外产品厂商及企业持续提供不同纬度的IT专业服务。阳光雨露拥有超过3000名员工，126家直属服务中心，5个管理平台及3个二级维修中心。并在全国建立了覆盖105个主要城市的骨干服务网络。阳光雨露并拥有2000余位合作伙伴，认证的工程师总数量超过5700名，超过2400个服务支持站点覆盖全国2287个城市\n#1.（1）本来查另外一个资料，结果躺着中枪,搜索到\nhttp://uc.sunits.com/index.php?m=content&c=index&a=show&catid=6&id=98\n好多Email地址，实在喜欢，随手点了\"首页\",还有2个:\nucsupport@sunits.com、itservice@sunits.com\n\n\n\n\n（2）找到邮箱地址mail.sunits.com,把刚刚找到的邮箱都用起来吧,打开burp,载入刚刚找到的邮箱地址,测试弱口令:\n\n\n\n（3）发现itservice@sunits.com弱口令为000000,第六感这样服务类邮箱没撒内容，结果大跌眼镜，闪坏钛金眼,各种系统密码重置邮件,包括OA、Email、HRM系统、helpdesk系统:\n\n\n\n（4）到此为止,就不继续了，这么充足的信息量，难道不会发现更有价值的信息?进入各系统收集各类邮箱、帐号，使用常用密码猜解，more and more account、password、information.......（5）贵司的密码强度灰常高，设置相当复杂.比如定期强制修改密码、密码中包含身份证号码、各种字母数字符号结合等,但是却忽略了重要的系统帐号(itservice、service)....\n\n#2Helpdesk系统存在struts2漏洞，地址:\nhttp://helpdesk.sunits.com/hd/login!login.do\n\n\n\n\n\n\n\n网站物理路径： /home/jboss/jboss-4.2.3.GA/server/default/./tmp/deploy/tmp125374713270438648hd-exp.warjava.home: /home/jdk1.6.0_27/jrejava.version: 1.6.0_27os.name: Linuxos.arch: amd64os.version: 2.6.18-238.el5user.name: jbossuser.home: /home/jbossuser.dir: /home/jboss/jboss-4.2.3.GA/binjava.class.version: 50.0java.class.path: /home/jboss/jboss-4.2.3.GA/bin/run.jar:/home/jdk1.6.0_27/lib/tools.jarjava.library.path: /home/jdk1.6.0_27/jre/lib/amd64/server:/home/jdk1.6.0_27/jre/lib/amd64:/home/jdk1.6.0_27/jre/../lib/amd64:/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/libfile.separator: /path.separator: :java.vendor: Sun Microsystems Inc.java.vendor.url: http://java.sun.com/java.vm.specification.version: 1.0java.vm.specification.vendor: Sun Microsystems Inc.java.vm.specification.name: Java Virtual Machine Specificationjava.vm.version: 20.2-b06java.vm.vendor: Sun Microsystems Inc.java.vm.name: Java HotSpot(TM) 64-Bit Server VMjava.specification.version: 1.6java.specification.vender: java.specification.name: Java Platform API Specificationjava.io.tmpdir: /tmphibernate信息\n   漏洞证明：  #1.信息泄漏Email:\n\nOA;\n\n#2.helpdesk系统漏洞\n\n   修复方案：  1.检查并修复帐号弱口令，防止信息泄漏.个人觉得网上联系方式留公司电话就好了,手机和邮箱就不要了 2.给IMB Lotus增加验证码功能，防止猜解,Baidu了下,这个功能自带木有，要自己开发3.升级helpdesk系统struts2   版权声明：转载请注明来源 袋鼠妈妈@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-12-28 15:22 厂商回复： 阳光雨露不属于我们管理，我们只是转发了漏洞信息给阳光雨露的邮箱，如有其它阳光雨露的漏洞，请联系阳光雨露，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-25 15:34 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  @xsser @Finger @疯狗 别人联想1个弱口令都是正常流程，为什么我这个是小厂商呢。有过程，有数据，有危害。(以上抄的)，这个虽然是个子公司,信息拿到的还不少.如果要深入,还是可以发掘很多东西...    \n     2013-12-25 15:39 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @袋鼠妈妈 联想这个厂商这样漏洞太多了 只有对于有特别详细技术的才会走正常流程，你关注下那个弱口令的漏洞，等他公开了看看吧    \n     2013-12-25 15:42 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  @xsser OK 谢谢啦哈~~    \n     2013-12-27 19:02 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  @联想 貌似修正了，咋木有人回来确认哇，亲╭(╯3╰)╮    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}