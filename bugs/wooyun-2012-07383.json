{"id": 20155, "wybug_id": "wooyun-2012-07383", "wybug_title": "深信服AC系列上网行为管理产品存在文件任意下载", "wybug_corp": "深信服", "wybug_author": "星辰", "wybug_date": "2012-05-21 16:42", "wybug_open_date": "2012-05-22 18:14", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "文件操作不当", "参数未过滤", "文件操作参数未过滤", "深信服"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-22：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 1、下载处理文件未进行验证；2、任意文件下载，可以下载设备中的PHP等源代码。经过部分测试，影响的设备版本为有Sangfor--3.3，Sangfor--SG-3.4，Sangfor-AC-4.0.1。我们认为深信服的上网行为设备均存在该问题 详细说明：  通过https://XXX.XXX.XXX.XXX/php/loadfile.php?file=/index.php可以下载设备中的文件。另外php/loadfile.php文件的访问不需要验证。   漏洞证明：  下载的index.php文件：\n\n下载的/php/checklogin.php文件:\n\n下载的/php/depends.php文件：\n\n   修复方案：  厂商懂的。   版权声明：转载请注明来源 星辰@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-05-22 18:14 厂商回复：  漏洞Rank：8  (WooYun评价) 最新状态： 2012-05-22：感谢您对深信服上网行为管理产品的关注，该漏洞属实，属于产品数据中心访问权限设计缺陷。我司已经采取措施加强各产品的安全设计检查，在5月初的产品版本安全检视工作中，我们也通过内部员工发现了上网行为管理AC产品存在的任意文件下载、绝对路径泄露的相关漏洞，并针对已发现的漏洞问题启动了补丁版本，原计划将在本月的25号、28号分别发布针对3.3X和4.X版本的补丁，启动了自动更新功能的客户将通过在线升级的方式自动修复此漏洞，其余客户我们会通过客服部门公告的方式推动更新。白帽子的工作对厂商是非常有益的，感谢你们以无私的精神推动业界技术完善，希望能够共同进步。以下为我司5月内部版本安全检视所发现问题的部分截图，以示说明http://www.sangfor.com//images/ac_info.jpg 2012-05-22：抱歉，刚才操作有误（评级和rank值冲突后导致乌云网站自动返回为厂商忽略），未能给出rank评价，请乌云管理员协助修改回应，谢谢 2012-05-23：鉴于漏洞已被披露，我们加快了漏洞修复补丁的发布，目前已经在更新服务器上发布了覆盖3.x和4.x版本的自动修复补丁，请打开AC产品的自动升级功能进行升级，可进一步测试相关漏洞是否修复完毕，谢谢！  ", "replys": "漏洞评价：\n评论\n     2012-05-21 21:42 |    \t\twebvul@sohu.com \t\t\t( 实习白帽子  |\t\t\t        Rank:80 漏洞数:13        | www.freebuf.com)\t\t \n  求细节。    \n     2012-05-21 21:58 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  关注ing    \n     2012-05-21 23:47 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  细节快来吧。深信服做安全的不会这么大意吧。    \n     2012-05-22 00:22 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  最好去找找源码漏洞然后找个代码执行    \n     2012-05-22 08:11 |    \t\t星辰 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:3        | )\t\t \n  @xsser 暂时不准备发掘了，等厂商回应。    \n     2012-05-22 10:02 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  “我们认为深信服的上网行为设备均存在该问题”出卖了你    \n     2012-05-22 10:08 |    \t\t星辰 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:3        | )\t\t \n  @凤凰 咋出卖了啊，不解。    \n     2012-05-22 13:34 |    \t\tiCorn \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:1        | Using technology for a higher purpose !)\t\t \n  关注一下，等细节    \n     2012-05-22 14:13 |    \t\tnull \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 左岸是无法忘却的回忆，右岸是值得把握的青...)\t\t \n  登录支持~~~~~~    \n     2012-05-22 14:49 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  @星辰 \"我们\" ...集体行动？    \n     2012-05-22 14:50 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  这个“我们”值得揣摩。。。    \n     2012-05-22 15:47 |    \t\t星辰 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:3        | )\t\t \n  @Z-0ne 写文章习惯了，哈哈    \n     2012-05-22 15:49 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  @星辰 用“我们”这个词听起来好像有点权威的感觉    \n     2012-05-22 15:52 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @星辰 的确，我写的paper就全部是“我们”    \n     2012-05-22 22:33 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @xsser 靠谱的厂商。    \n     2012-05-23 11:11 |    \t\t星辰 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:3        | )\t\t \n  @深信服 说好的rank呢？    \n     2012-05-23 11:28 |    \t\t深信服(乌云厂商)\t\t \n  @星辰 抱歉，因为我无法直接修改，需要@乌云 管理员协助修改，另外请把你的联系方式发给我们，我们有个小礼品奉上。    \n     2012-05-23 11:46 |    \t\t阿门 \t\t\t( 普通白帽子  |\t\t\t        Rank:187 漏洞数:19        | 123)\t\t \n  典型的管理人物代表，纳闷了，怎么没有说到感谢党的呢。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}