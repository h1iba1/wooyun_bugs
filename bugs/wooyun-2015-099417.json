{"id": 37562, "wybug_id": "wooyun-2015-099417", "wybug_title": "开元旅游频道设计缺陷导致重置用户密码", "wybug_corp": "kaiyuan.eu", "wybug_author": "阿萨帝", "wybug_date": "2015-03-15 18:42", "wybug_open_date": "2015-04-29 18:44", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-29：\t细节向公众公开  简要描述： 如果上个漏洞通过的话，重置密码就更简单了。 详细说明：  网站的设计缺陷是：重置密码链接是固定值，不管送至重置多少次重置连接是邮箱+固定数字base64编码。可以分为两种方法：1、知道邮箱，id不知道；2、上一个漏洞通过的话，后台内有用户邮箱和id。重置连接例如：如：muzi@firsttravel.dk   密码为：111111重置连接为：http://www.kaiyuan.eu/?go=register&mod=setpass&email=muzi@firsttravel.dk&id=91670编码后为：http://www.kaiyuan.eu/?Z289cmVnaXN0ZXImbW9kPXNldHBhc3MmZW1haWw9bXV6aUBmaXJzdHRyYXZlbC5kayZpZD05MTY3MA==但在重置前要对？后面字符串进行url编码，主要是对=编码，不然不会打开重置页面。最终重置连接为：http://www.kaiyuan.eu/?Z289cmVnaXN0ZXImbW9kPXNldHBhc3MmZW1haWw9bXV6aUBmaXJzdHRyYXZlbC5kayZpZD05MTY3MA%3d%3d重置成功\n\n方法1、不知道id由于邮箱是知道，id没办法直接知道，id是固定可以爆破得到，每位用户注册时会有一个，初试id不清楚，就从1-149800爆破，未做限制，得到正确只是时间问题。\n\n爆破成功，\n\n   漏洞证明：  方法2、上一个漏洞，泄露的后台可获得用户邮箱和id。\n\n此处得到用户邮箱和id，参照上面得到用户重置连接http://www.kaiyuan.eu/?Z289cmVnaXN0ZXImbW9kPXNldHBhc3MmZW1haWw9dG9uZ3l1ZWh1YTIwMTNAMTYzLmNvbSZpZD0xNDk2NTc%3d\n\n   修复方案：  通过的话，麻烦厂商吧上面3位用户密码改下吧。重要的后台做好，里面用户权限不小。   版权声明：转载请注明来源 阿萨帝@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2015-03-15 18:46 厂商回复： 简单进行了base64_encode加密，在不断尝试ID的情况下可以重置密码 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-15 19:34 |    \t\t阿萨帝 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:62        | 不发礼物的索要联系方式都是耍流氓。)\t\t \n  不要查表啊    \n     2015-03-15 20:14 |    \t\t0x 80 \t\t\t( 普通白帽子  |\t\t\t        Rank:1301 漏洞数:373        | 某安全公司招聘系统运维、渗透测试、安全运...)\t\t \n  来我群玩吧~~182910788    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}