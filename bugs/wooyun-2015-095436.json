{"id": 38800, "wybug_id": "wooyun-2015-095436", "wybug_title": "福建省水利信息网getshell，涉及邮件服务器", "wybug_corp": "福建省水利信息网", "wybug_author": "Zxsoft", "wybug_date": "2015-02-04 15:13", "wybug_open_date": "2015-03-21 15:14", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "17", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-21：\t细节向公众公开  简要描述： 福建省水利信息网同服其他程序有文件上传漏洞。导致服务器沦陷，邮件服务器也在上面 详细说明：  福建省水利信息网http://www.fjwater.gov.cn:7080/index.aspx 这个是桃源网盘系统，这个有注入，http://www.fjwater.gov.cn:7080/show.aspx?type=1&filepath=hhtp 参数filepath没有过滤可以直接注入。而且还是sa权限，可以通过注入获取网盘的用户名和密码。通过上传文件直接getshell。   漏洞证明：  注入点：http://www.fjwater.gov.cn:7080/show.aspx?type=1&filepath=hhtp'\n\n经判断是sa权限\n\n看到是桃园网盘系统，就通过注入获取一个账号lmk 密码是111111 （弱口令，后面你还会发现默认密码）通过上传xx.ashx文件，然后访问http://www.fjwater.gov.cn:7080/myfile/lmk/11.ashx 就会生成一个一句话shell （参照：百度搜索 桃源网盘 getshell ）http://www.fjwater.gov.cn:7080/x.aspx 这个是一句话，\n\n发现计算机名字是mailserver 难道mail服务器也是这台。这个是邮件登录http://www.fjwater.gov.cn:6080/翻了一下目录发现Magic Winmail\n\nC:\\Program Files\\Magic Winmail\\server\\userauth.cfg 这个是邮箱的账号和密码的配置文件，密码是md5加密，很容易解出来。下面是登录邮箱的截图\n\n邮箱有个通用密码：**c123 总共有72个md5值是一样的.我在这里就不一一列举了。   修复方案：  更新网站程序，邮寄密码规则要求加点特殊字符。   版权声明：转载请注明来源 Zxsoft@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-02-09 11:01 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给福建分中心，由其后续协助调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}