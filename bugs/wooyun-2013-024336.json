{"id": 11220, "wybug_id": "wooyun-2013-024336", "wybug_title": "TCL商城xss到商城后台到服务器", "wybug_corp": "TCL官方网上商城", "wybug_author": "piaoye", "wybug_date": "2013-05-27 18:32", "wybug_open_date": "2013-07-24 16:41", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-24：\t细节向公众公开  简要描述： xss到后台后再到服务器沦陷 详细说明：  问题出现在http://shop.tcl.com/ 该系统使用了ecshop+phpthink进行了二次开发发现问题蛮多，这里就说说XSS 用户中心的投诉中心，然后利用xss登录到后台，后台文章管理处发现有fckeditor，media上传任意文件，oracle数据库为内网机器，不过可直接拖。。。因数据安全及金额过大等原因，我以联系TCL方进行修复处理   漏洞证明：  \n\n\n\n\n\ncookie中包含密码账户等信息，也可爆破后登陆。比较简单的过程。   修复方案：  对一些客户端可控的参数进行验证过滤正则等等处理。   版权声明：转载请注明来源 piaoye@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-05-29 10:52 厂商回复： 以前看过一个网络的报道，一个运维小伙子因为公司长期加班导致失恋，结果他把公司的数据清空了，另外还有些网站长期受到外部的攻击；网站的存在着各种内忧外患，我们商城也无法避免，感谢这位朋友非常耐心地告知我们存在的安全问题，而且还不厌其烦地告知解决方式，由于本人负责运营，对IT方面一窍不通，只能反馈给我们的IT人员解决，公司对安全问题非常重视，积极配合处理，当然后续可能还会发现其他的安全问题，希望有热心的朋友（例如：漏洞作者： piaoye） 不吝赐教。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-24 15:37 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  TCL一直都木有人来……    \n     2013-05-24 23:19 |    \t\tpiaoye \t\t\t( 普通白帽子  |\t\t\t        Rank:343 漏洞数:53        | ww)\t\t \n  @wefgod tcl的人来认领了，乌云@xsser还没审核通过。。    \n     2013-05-25 10:50 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @piaoye 赶紧来吧！    \n     2013-05-29 12:25 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  厂商太靠谱了    \n     2013-05-29 12:33 |    \t\tpiaoye \t\t\t( 普通白帽子  |\t\t\t        Rank:343 漏洞数:53        | ww)\t\t \n  嗯，态度很好，交流比较轻松    \n     2013-05-29 12:39 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @piaoye 都这样的话和谐社会指日可待    \n     2013-06-18 11:37 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  通用型安全漏洞？商城算通用的？难道ECSHOP？@xsser    \n     2013-06-18 14:49 |    \t\tpiaoye \t\t\t( 普通白帽子  |\t\t\t        Rank:343 漏洞数:53        | ww)\t\t \n  @wefgod 哪里写通用型了？ 不过确实是ecshop 老版本二次开发的    \n     2013-06-18 15:08 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @piaoye 提醒：为保证通用型安全漏洞的信息保密性，该漏洞无法使用乌云币提前查看，请踏实的杀洞升级吧。这里写哦    \n     2013-06-18 15:10 |    \t\tpiaoye \t\t\t( 普通白帽子  |\t\t\t        Rank:343 漏洞数:53        | ww)\t\t \n  @wefgod 不清楚，我看不到的，估计是内容里有账户敏感等信息吧。    \n     2013-06-18 17:05 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @piaoye 你直接看细节的……毕竟是你发的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}