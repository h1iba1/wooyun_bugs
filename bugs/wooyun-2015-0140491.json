{"id": 66564, "wybug_id": "wooyun-2015-0140491", "wybug_title": "济源农商行主站某功能设计缺陷导致用户开户行账号/开户行地址/身份证号码/姓名/电话号码/营业执照号码等信息泄露", "wybug_corp": "济源农商行", "wybug_author": "路人甲", "wybug_date": "2015-09-13 14:49", "wybug_open_date": "2015-10-30 14:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-30：\t细节向公众公开  简要描述： 安全无小事。 详细说明：  济源农商行主站POS业务申请功能设计缺陷导致用户开户行账号/开户行地址/身份证号码/姓名/电话号码/营业执照号码等信息泄露。   漏洞证明：  济源农商行主站POS业务申请功能设计缺陷导致用户开户行账号/开户行地址/身份证号码/姓名/电话号码/营业执照号码等信息泄露。问题出现在首页的“POS业务申请”功能处。\n\n点击“POS业务申请”页面跳转到如下页面：\n\nOK，就是这里，存在问题。问题1：根据“营业执照号”和“申请支行”就可查询用户的申请详细信息。（没有验证码，可以暴力破解）跑到一个用户账号：举例证明：（不要问我如何获取的营业执照号，这年头信息泄露那么多，收集一点有用信息还是有可能的）营业执照号输入：410881190027224申请支行选择：济水支行此时点击查询按钮，系统响应如下：用户名姓名、身份证号码、开户行账号、开户行地址、身份证号码、税务登记号等都在看到。（还可以看用户的身份证照片、营业执照照片）\n\n点击最下方的查看图片可查看身份证照片等，顺便看一下：身份证照片：\n\n营业执照：\n\n问题2：该系统查询最后一位POS业务申请用户的信息时，经过测试：不需要输入正确信息就可查看。（应该是程序设计有问题吧.）证明：之前自己先随便“申请”了一下POS业务（为了测试，不好意思。）在“营业执照号”中随便输入信息，例如：111111“申请支行”随便选，例如选择：宣化支行\n\n点击“查询”，系统响应如下：\n\n此时点击“查看图片”（四个中随便点击一个），此时我刚才申请的信息就可以看到了（因为我刚刚申请，所有我是最后一个POS申请的人）\n\n这个是我申请POS业务申请时自己填写的。OK，问题证明到此，赶快修改。   修复方案：  改代码。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-09-15 14:41 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT同步下发给河南分中心并向银行业信息化主管部门通报,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}