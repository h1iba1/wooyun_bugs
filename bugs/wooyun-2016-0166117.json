{"id": 75905, "wybug_id": "wooyun-2016-0166117", "wybug_title": "厦门E通卡公司存在SQL注射漏洞，导致主站管理密码泄露", "wybug_corp": "厦门E通卡公司", "wybug_author": "乌托邦", "wybug_date": "2016-01-03 22:34", "wybug_open_date": "2016-02-22 21:30", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["公交", "厦门", "通卡"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向公众公开  简要描述： 厦门E通卡公司存在SQL注射漏洞，导致主站管理密码泄露，密码加密但是也是弱口令!厦门的公交系统还是比较不错的，支持在线充值，虽然还是去补登机做写卡的操作，总体来讲还是比较方便的。之前测试在线一个充值的账号以为没有到账，联系客服小妹，后来经过小妹反复查找，找到了问题所在，是笔者充错卡号。一不小心让客服小妹反馈错了Bug，于是笔者决定找出一个有意义的Bug。 详细说明：  注入点\nhttp://**.**.**.**/about.aspx?cid=1\n找到管理员密码，进入管理中心，进一步上次Shell，然后就可以拿下整站，可能还有内网，这个漏洞还是比较严重的，由于笔者是应届毕业生，忙着写简历，没有进一步深入了。   漏洞证明：  网站aspx+Mysql的，还好这个管理配置的时候不是用root账号，MySQL的账户权限不是最高。看到数据库里面有两个数据库：\n\n主站用的是第一个数据库：etkdb，进一步深入可以看到存在如下表：\n\n\n\n\na_name,\t\ta_pwdadmin,\t\t21232f297a57a5a743894a0e4a801fc3 (admin)admin888,\t21232f297a57a5a743894a0e4a801fc3 (admin)\n明显的弱口令，安全性有待加强，厦门还是比较大的城市，公交的服务关系民生，公交系统的安全还是很多必要加强一下安全机制的。笔者时间忙着毕业的事情，没有进一步深入。   修复方案：  你们懂的！   版权声明：转载请注明来源 乌托邦@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2016-01-08 21:43 厂商回复： CNVD确认所述情况，已经转由CNCERT下发给福建分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}