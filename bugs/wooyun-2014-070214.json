{"id": 394, "wybug_id": "wooyun-2014-070214", "wybug_title": "某OA系统两处SQL注射到GetShell", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "魇", "wybug_date": "2014-07-30 14:26", "wybug_open_date": "2014-10-28 14:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-07：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-28：\t细节向公众公开  简要描述： 捡漏、前者提交是前台显示我这也走前台吧。 详细说明：  前人漏洞： WooYun: 某OA系统SQL注射+后台getshell 厂商：北京联杰海天科技有限公司 官网：http://www.haitiansoft.com/产品：OA协同办公系统搜索引擎语法：intitle:系统登录 系统检测到您没有安装OA客户端控件影响实例:\nhttp://121.30.226.44/login.asp 大同煤矿集团雁崖煤业公司http://124.65.69.14/login.asp 路恒安市政工程http://vos.tjufe.edu.cn/login.asp 天津财经大学http://211.68.250.42/login.asp 天津农学院http://www.fzsyxx.com/oa/ 抚州市实验学校http://oa.ccib.com.cn/login.asp 长城保险http://www.cnshuiyu.com/login.asp 上海水域环境发展有限公司http://oa.tjfsu.edu.cn/login.asp 天津外国语大学http://old.mdjagri.gov.cn/oa/login.asp 海天网络http://60.171.34.204:8086/ 淮南市城市管理行政执法局http://116.228.82.237/login.asp 德林义肢http://dfoa.shhjwl.com/login.asp 上海东飞公司http://www.cnshuiyu.com/login.asp 上海水域环境发展有限公司http://211.68.192.21/login.asp\t天津音乐学院http://121.30.226.44/login.asp\t大同煤矿集团http://180.166.7.94/login.asp 上海市市容环境卫生汽车运输处http://cqkyoa.oicp.net/login.asp 科云建筑有限公司\n【第1处SQL注射示例】实例1. http://oa.tjfsu.edu.cn/NewRegisterDo.asp (注册处)\nPost:AddOrEdit=88952634&TureName=88952634&UserPassWord=88952634&PassWord=88952634&DepartMentDis=88952634&DepartMentID=88952634&UserName=88952634\nUserName参数存在注入 \n\n\n\n实例2. http://oa.tjfsu.edu.cn/NewRegisterDo.asp\nPost:AddOrEdit=88952634&TureName=88952634&UserPassWord=88952634&PassWord=88952634&DepartMentDis=88952634&DepartMentID=88952634&UserName=88952634\n\n\n实例3. http://www.cnshuiyu.com/login.asp\nPost:AddOrEdit=88952634&TureName=88952634&UserPassWord=88952634&PassWord=88952634&DepartMentDis=88952634&DepartMentID=88952634&UserName=88952634\n\n\n   漏洞证明：  【第2处SQL注射示例】实例1. http://oa.ccib.com.cn/Public/OA_Download.asp?FieldName=Filename&FileContentField=FileContent&Table=Usr_Init&OAID=UsrID&Value=1Value参数存在注入\n\n实例2. http://211.68.208.53/Public/OA_Download.asp?FieldName=Filename&FileContentField=FileContent&Table=Usr_Init&OAID=UsrID&Value=1\n\n实例3. http://180.166.7.94/Public/OA_Download.asp?FieldName=Filename&FileContentField=FileContent&Table=Usr_Init&OAID=UsrID&Value=1 \n\n实例4. oa.tjfsu.edu.cn/Public/OA_Download.asp?FieldName=Filename&FileContentField=FileContent&Table=Usr_Init&OAID=UsrID&Value=1\n\n\n\n   修复方案：  GetShell可参考蓝猫所述： WooYun: 某OA系统SQL注射+后台getshell 以oa.tjfsu.edu.cn 天津外国语大学为例：利用注入点跑出管理员帐号密码，密码有的是BASE64加密，可解\n\n\n\n登录后点击\"资讯内容维护\"-\"修改\"在编辑器中点击添加图片按钮，上传一句话。接下来的懒猫证明过了，到这里Shell我就不传了~撤   版权声明：转载请注明来源 魇@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-08-04 10:33 厂商回复： CNVD确认并复现所述情况，已经由CNVD电话和邮件通报软件生产厂商处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-30 15:22 |    \t\tadm1n \t\t\t( 普通白帽子  |\t\t\t        Rank:216 漏洞数:66        | 只是一个渣渣而已。。。)\t\t \n  前台了    \n     2014-07-30 15:32 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  你是修瓦房，漏水的么，天天捡漏    \n     2014-11-04 07:39 |    \t\tMurk Emissary \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:14        | 低调做人 低调行事)\t\t \n  @U神 哈哈，修瓦房    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}