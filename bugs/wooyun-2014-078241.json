{"id": 50295, "wybug_id": "wooyun-2014-078241", "wybug_title": "THEOL网络教学综合平台漏洞合集", "wybug_corp": "THEOL网络教学综合平台", "wybug_author": "夏殇", "wybug_date": "2014-10-13 12:26", "wybug_open_date": "2015-01-11 12:28", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["越权操作"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-11：\t细节向公众公开  简要描述： THEOL网络教学综合平台漏洞合集，包括越权访问（如果足够幸运的话，看老师的试题，同学的作业、论文神马的都不是问题啦），及各种XSS（存储型的、反射型的、全打的，打自己的）。这么多的洞，只需要几个rank，你值得拥有！世界上最遥远的距离是：我们俩一起出门，你去买苹果六代，我去买六袋苹果！ 详细说明：  google:THEOL网络教学综合平台,发现用这个平台的学校还真不少。\n\n之前我也是有上报过这个平台的各种XSS，当时我不知道是通用，厂商只写了一所高校，不知道后来这些漏洞有没有通报给真正的厂商，所以这里也是再一次帖出来和新漏洞一起报给厂商了。 WooYun: 华南农业大学网络教学综合平台存在XSS漏洞 下面就来看看一些新的洞啦。一.邮件越权访问，可遍历ID查看所有邮件http://***/eol/common/mail/printmail.jsp?mailID=29944将mailID遍历一边可以查看所有邮件，只要你的运气足够好的话，说不定还能找到老师的试题哦，还有同学的作业、论文等等。前提你需要有一个账号先登录进去平台然后再遍历。\n\n\n\n\n\n二.讨论区越权访问，可遍历ID访问所有版面http://***/eol/common/faq/forum.jsp?forumid=1正常情况下，至只能访问所选课程的版面。可通过遍历forumid访问所有版面，包括root版面（id应该统一是1）和管理信息系统版面等等。\n\n\n\n三.权限管理，封禁IP页面越权访问。http://***/eol/common/forum/admin/permmanage.jsp?forumid=1（权限管理）http://***/eol/common/forum/admin/forbidlist.jsp?forumid=1（封禁IP)\n\n\n\n四.笔记本处存在存储型XSShttp://***/eol/common/notebook/notepad.jsp上传文件，然后截包，将文件名改成<script>alert(/xss/)</script>.***。把开放范围设为学生级，然后所有用户都可以看到你的笔记啦，再然后，你懂的。\n\n\n\n五.资源中心的目录管理存在存储型XSShttp://***/resource/myres/favorite/myfolder_list.jsp?indexStatus=1\n\n六.作业处存在存储型XSS添加作业处，标题输入<script>alert(1)</script>。如果攻击者可以先得到一个教师的账号的话，然后再利用这个发一个作业出去，然后你懂的。\n\n七.课程问卷处存在存储型XSS用教师账号发起一个问卷调查，标题，说明输入<script>alert(1)</script>。\n\n八.试题试卷库存在存储型XSS\n\n九.在线测试存在存储型XSS\n\n十.几个反射型XSShttp://***/resource/view/reslistbysubject.jsp?courseName=\"></iframe><script>aler(1)<%2Fscript>http://***/resource/banks/banksindex.jsp?title=%22%3E%3Cscript%3Ealert%281%29%3C%2Fscript%3E&mediaType=&Submitdd=%B2%E9%D1%AF\n\n\n\n到处都是跨站啊啊啊，测不下去了！快疯了！求首页，不然真的疯了。   漏洞证明：  看详细说明~~   修复方案：  1.越权：做好访问控制啊，严格控制权限啊2.XSS：做好输入过滤啊，做好输出编码啊3.给个礼物呗，不容易啊   版权声明：转载请注明来源 夏殇@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-10-16 17:05 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-14 00:32 |    \t\tl0u1s \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:3        | 崇尚自由、开放、共享、简约。)\t\t \n  夏大神求带！    \n     2014-10-14 12:55 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  @l0u1s 颖总求带    \n     2014-10-15 08:20 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  @夏殇 夏老大，打包呀。    \n     2015-01-16 17:52 |    \t\tsin \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:2        | 寻找最优雅的解决方案)\t\t \n  @夏殇 其实你可以更深入的。为何不试试getshell    \n     2015-01-16 18:01 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  @sin 尝试过了，get不到    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}