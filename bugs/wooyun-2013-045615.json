{"id": 6450, "wybug_id": "wooyun-2013-045615", "wybug_title": "苏宁易购分站SQL注射可泄漏大量用户信息", "wybug_corp": "江苏苏宁易购电子商务有限公司", "wybug_author": "se55i0n", "wybug_date": "2013-12-11 14:46", "wybug_open_date": "2014-01-25 14:47", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "字符类型注射", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-25：\t细节向公众公开  简要描述： 苏宁易购分站SQL注射可泄漏大量用户信息~ 详细说明：  1）存在问题的站点：http://venus.suning.comhttp://venus.suning.com/CN/user.aspx?act=tag&type=1&id=4\n\n2）非常典型的字符型注入，同时泄漏路径信息；\nStack Trace:[SqlException (0x80131904): 字符串 '4' and mu_project_type=2 ) t where ROWID between 1 and 12  order by mu_id desc' 后的引号不完整。'4' and mu_project_type=2 ) t where ROWID between 1 and 12  order by mu_id desc' 附近有语法错误。]     ......    Sex_Lib.SqlHelper.ExecuteReader(SqlConnection connection, SqlTransaction transaction, CommandType commandType, String commandText, SqlParameter[] commandParameters, SqlConnectionOwnership connectionOwnership) in E:\\Community\\Project\\Special\\Code\\LongBaby\\Sex_Lib\\SqlHelper.cs:865   Sex_Lib.SqlHelper.ExecuteReader(String connectionString, CommandType commandType, String commandText, SqlParameter[] commandParameters) in E:\\Community\\Project\\Special\\Code\\LongBaby\\Sex_Lib\\SqlHelper.cs:917   Sex_Lib.SqlHelper.ExecuteReader(String connectionString, CommandType commandType, String commandText) in E:\\Community\\Project\\Special\\Code\\LongBaby\\Sex_Lib\\SqlHelper.cs:882   Sex_DAL.Second_DataBse.GetPageList(String connstr, String tableName, String columKey, String whereStr, String orderStr, Int32 pageIndex, Int32 perPageCount, Int32& recordCount) in E:\\Community\\Project\\Special\\Code\\LongBaby\\Sex_DAL\\DataCommon\\Second_DataBse.cs:57   Sex_BLL.mz_user.GetListPrdtId(String where, Int32 pageIndex, Int32 perPageCount, Int32& recordCount) in E:\\Community\\Project\\Special\\Code\\LongBaby\\Sex_BLL\\mz_user.cs:125   Sex_BLL.mz_user.GetProductListBy(String where, Int32 pageIndex, Int32 perPageCount, Int32& recordCount) in E:\\Community\\Project\\Special\\Code\\LongBaby\\Sex_BLL\\mz_user.cs:20   LongBaby.CN.user.Bind() in E:\\Community\\Project\\Special\\Code\\LongBaby\\LongBaby\\CN\\user.aspx.cs:129   LongBaby.CN.user.Page_Load(Object sender, EventArgs e) in E:\\Community\\Project\\Special\\Code\\LongBaby\\LongBaby\\CN\\user.aspx.cs:35   System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) +25   System.Web.UI.Control.LoadRecursive() +71   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +3048\n3）sa权限，数据库里含大量库信息；\n\n\n\n4）查询了下红孩子的管理员信息，一览无余呀~\n\nPS：其他的我就不继续深入测试了，赶紧修复吧~   漏洞证明：  \n\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 se55i0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-12-11 15:05 厂商回复： 感谢您对苏宁易购的关注，正在安排人员对此漏洞进行修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-11 15:41 |    \t\tx1aoh4i \t\t\t( 普通白帽子  |\t\t\t        Rank:403 漏洞数:62        )\t\t \n  你很久没有冒泡了 亚麻跌    \n     2013-12-11 16:12 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  ：） 苏宁狮子真难看    \n     2013-12-11 16:22 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @小胖胖要减肥 @x1aoh4i 咔咔~苏宁发狮子么    \n     2013-12-11 16:33 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @se55i0n 你要就给      \n     2013-12-11 16:51 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @小胖胖要减肥 苏宁发狮子么    \n     2013-12-11 18:17 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @zzR 发了我一个  你前同事发的 他开始搞技术了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}