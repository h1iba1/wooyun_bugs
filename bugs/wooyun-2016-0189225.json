{"id": 86147, "wybug_id": "wooyun-2016-0189225", "wybug_title": "bilibili某内部接口设计不当可根据会员id任意登录（内部API文档泄露）", "wybug_corp": "bilibili.com", "wybug_author": "端端", "wybug_date": "2016-03-26 09:17", "wybug_open_date": "2016-05-10 09:51", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-10：\t细节向公众公开  简要描述： bilibili某内部接口设计不当可根据会员id任意登录（内部API文档泄露） 详细说明：  注：问题的源头是由于Gitlab开在外网上导致存于公开项目中的内部文档泄露，但该风险似乎已于近日被bilibili内部发现并修复（无法访问该私有Gitlab，80端口拒绝连接），本漏洞中是使用在其修复前获得的文档，根据其中获取到内网接口的地址和参数再配合不当设计或意外暴露于外网的内网接口完成根据之前bilibili的源代码泄露漏洞（ WooYun: bilibili某站git服务配置不当，造成信息泄露 ）可以得知其git服务使用域名syncsvn.bilibili.co，该域名解析到内网\n\n同时发现类似的sync.bilibili.co域名指向外网，并且其上部署有Gitlab（在提交这个漏洞的时间点其80端口已拒绝链接，但如果把ip地址放到zoomeye上去查还是可以发现之前部署的是Gitlab）\n\n虽然不知道Gitlab的账户但公开项目还是可以看的，主要是一些文档和一些前端项目，其中一些文档包含敏感内容泄露了内部使用的接口其实问题到这里还不严重，单单泄露接口地址和使用方法还不足以造成威胁，因为毕竟接口在设计上还是有鉴权的，但问题处在某接口的实际实现上并没有像文档上所述那样的有鉴权，也许是因为是内网接口意外暴露在外网环境下的原因根据泄露的文档“【内部】API接口使用手册.doc”\n\n其中本是有签名的要求的，不知是否是因为设计上是内网接口所以就没有实现\n\n其中有一个接口“登陆到指定用户控制面板”\n\n抱着试试看的心态尝试了一下\nhttp://passport.bilibili.com/intranet/acc/login?mid=1\n居然正常返回数据了（我整个人都懵逼了\n\n颤抖着把授权url复制到地址栏bingo\n\n   漏洞证明：  登录站长帐号\n\n\n\n   修复方案：  1、Gitlab不要给普通用户开放建立公开项目的权限2、Gitlab无特殊需要不要开在外网（至少Web不要）3、内部接口要限制在内网访问4、就算是内网接口也要鉴权哪怕是比较简单的，总比没有要好   版权声明：转载请注明来源 端端@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2016-03-26 09:51 厂商回复： 我都想要的内部API文档居然这么容易拿到了..快..发我一份~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-26 10:13 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:297 漏洞数:22        | 当我又回首一切,这个世界会好吗?)\t\t \n  什么心情    \n     2016-03-26 13:41 |    \t\tF4ther \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:10        | 有些人挖洞就是为了挖洞。仅此而已。)\t\t \n  github?    \n     2016-03-26 13:48 |    \t\t端端 \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:28        | niconiconi~)\t\t \n  @F4ther 不    \n     2016-03-26 14:24 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:389 漏洞数:96        | Enjoy Hacking Just Because It's Fun  |  ...)\t\t \n  有点6    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}