{"id": 33356, "wybug_id": "wooyun-2015-0109001", "wybug_title": "万科某系统任意密码重置", "wybug_corp": "万科", "wybug_author": "路人甲", "wybug_date": "2015-04-24 14:35", "wybug_open_date": "2015-06-08 14:36", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当", "短信轰炸"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-24：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-06-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 不但可以短信轰炸，而且可以....你猜可以什么 详细说明：  测试不容易，求不查水表，不忽略，再给个合情合理的rank测试环境：住这儿app，ios客户端忘记密码流程中，第一步：http://zhuzher.vanke.com/uip/vhome/user/checkAccount.do是校验用户是否存在的请求。绕过这步点方法有两个：（1）方法1:可以填入正确的手机号码通过验证，此处通过验证根后面实际发送短信到的号码无关系，所以无需关系（2）方法2:随便填入个手机号，修改response的userid字段，修改成一个存在的id，比如说1第二步：http://zhuzher.vanke.com/uip/messagesend/smsSend.do是短信校验码的请求，修改mobile字段即为发送短信到的号码。修改content字段即为发送短信的内容在获得smsSend.do的请求后，可以直接通过回放第二步的包进行轰炸，duang，duang，duang看到这，就知道不但可以短信轰炸，还可以自定义轰炸内容，duang，duang，duangPS：自定义了个短信内容为www.wooyun.org,结果后面就再也发不出短信了，I’m so sorry，我只是测试下，不想被查水表啊 > _ <以为到这就完了吗？各位看官，请继续上面说了短信校验码是客户端生成并发送给服务端的，所以填写上别人的账号，看下请求的内容就知道短信校验码了，爆破都省了。当然了，要知道万科业主的电话号，不过在这电话号码信息满天飞的时代，这个肯定不难，最简单的获取方式：公告栏里面各种管家的电话、各种保安的电话...\n所以该漏洞不但可以短信轰炸，还可以自定义短信内容，更可以直接获取短信验证码而进行密码重置\n   漏洞证明：  \nPOST /uip/messagesend/smsSend.do HTTP/1.1Host: zhuzher.vanke.comAuthorization: Basic Og==Accept: */*Accept-Encoding: gzip, deflateAccept-Language: zh-Hans;q=1, en;q=0.9, fr;q=0.8, de;q=0.7, ja;q=0.6, nl;q=0.5Content-Type: application/x-www-form-urlencoded; charset=utf-8Content-Length: 468Connection: keep-aliveProxy-Connection: keep-aliveUser-Agent: zhù zhè ér/2041 (iPhone; iOS 8.8.8; Scale/2.00){\"head\":{\"os\":\"ios\",\"sessionId\":\"嗯嗯\",\"sysid\":\"uip\",\"password\":\"嗯嗯\",\"osVersion\":\"8.8.8\",\"userId\":\"\",\"timestamp\":\"20880818188888\",\"version\":\"2.6.6\",\"functionid\":\"smsSend\"},\"parameter\":{\"content\":\"www.wooyun.org\",\"mobile\":\"010－82990999\",\"smsType\":\"1\"}}\n上面的请求被我和谐过了，只是给大家看看样子   修复方案：  服务端限制短信间隔，服务端定义校验码\n\n，   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}