{"id": 53396, "wybug_id": "wooyun-2014-067806", "wybug_title": "某通用型事业单位用人才系统任意用户密码修改/信息遍历", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "魇", "wybug_date": "2014-07-08 14:53", "wybug_open_date": "2014-10-06 14:54", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-06：\t细节向公众公开  简要描述： 事业单位用人才系统 详细说明：   WooYun: 某事业单位用人才系统存在任意文件下载漏洞和越权查看简历  WooYun: 某通用型事业单位用人才系统存在搜索型SQL注入影响众多事业单位考试考生信息！！ 已经有别人提交过了，摘取一下关键字：\ninurl:sydwzk/demandinurl:sydwzk/download/Down.jsp\n 以下全程以www.zzsyzp.com（漳州市事业单位招聘考试网）示例：从该站点击注册报名提示报名已截止以及报名流程处的说明，首先可以确定的是可以注册的，只是要到招聘开始\n\n当然这里无暇等待，于是直接弱口令进了一个帐号，123456：123456（仅供乌云审核与cncert国家互联网应急中心测试）1. 先说信息遍历登录后访问http://www.zzsyzp.com/syrcservlet?RequestType=SHOWINFO&memberID=11496&RightCode=Guest&InfoFlag=state修改memberID可查看他人报考进度\n\n\n\n   漏洞证明：  2. 再说任意密码修改http://www.zzsyzp.com/sydwzk/signup/PasswordUpdate.jsp 修改密码处\n\nPOST：Name=%BA%AB%B4%BA%D0%E3&Name=123456&Pwd1=123456&Pwd2=123456&memberID=11496&RightCode=Guest Name为账户姓名，memberID即账户所对应的id参数，其中经过多次测试，修改密码无需验证Name参数，而是根据memberID进行更新，从而可以修改memberID重置任意账户密码，但是这里的情况是修改后无法得知所修改帐号登录名，不过由于memberID是递增的，所以可以批量update，造成他人帐号无法登录。至于我怎么证明可行性呢，请往下看： WooYun: 某通用型事业单位用人才系统存在搜索型SQL注入影响众多事业单位考试考生信息！！ 此处存在一处未修复的SQL注入，利用该漏洞跑出memberID以及USERNO（登录名）进行测试\n\n3416     | 181417518 以修改这个帐号作为演示，memberID修改为3416，密码为123456\n\n\n\n181417518 ：123456，登录一下，可以看到已经成功修改181417518帐号\n\n接下来就可以利用该漏洞对全站用户进行批量update   修复方案：  请尽快通报所涉及站点，因为发现除了我提交的这两个漏洞之后，任意文件下载，越权查看简历 貌似也仍未修复。   版权声明：转载请注明来源 魇@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-07-12 22:52 厂商回复： CNVD确认并复现所述多个实例情况，根据测试实例，已经转由CNCERT下发给福建分中心处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}