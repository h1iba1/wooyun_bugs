{"id": 38785, "wybug_id": "wooyun-2015-095464", "wybug_title": "中国船舶工业集团SQL注入漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "萨瓦迪卡", "wybug_date": "2015-02-04 15:54", "wybug_open_date": "2015-03-21 15:56", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-21：\t细节向公众公开  简要描述： 中国船舶集团工业公司的船舶文化网站存在Mysql注入漏洞，导致泄露后台数据库的敏感信息以及可以读取系统重要的配置文件信息 详细说明：  中国船舶集团工业公司的某个域名由于没有对URL参数进行严格的恶意字符过滤，导致恶意用户可以构造恶意语句达到SQL注入攻击的目的，轻则导致企业重要商业信息的泄露，重则导致网站服务器被攻陷。   漏洞证明：  1、SQL注入漏洞页面：http://www.cssc-cul.org.cn/component_news/zhuanti.php?typeid=732、加单引号报错：\n\n3、根据报错提示可以看到，语句后面自动补充了很长的sql语句，其中含有order by,所以使用mysql注释符 -- ，我试过了，不加注释符不能成功\n\n\n\n4、进一步注入测试：\n\n\n\n\n\n5、可以读取系统重要文件，不一一列举，但是不能into outfile！6、工具注入\n\n7、通过后台登陆：http://www.cssc-cul.org.cn/admin/index.php\n\n8、也不能上传，没有好的方法   修复方案：  1、对应像php?id=123这样的页面，应该严格对用户输入的参数做非法字符过滤；2、分配的用户权限过高，不能使用root权限   版权声明：转载请注明来源 萨瓦迪卡@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-02-09 11:18 厂商回复： CNVD确认并复现所述情况，由CNVD通过网站公开联系方式尝试向其通报 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-23 10:07 |    \t\t萨瓦迪卡 \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:8        | 傻逼的坚持可能有牛逼的结果。)\t\t \n  修复了？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}