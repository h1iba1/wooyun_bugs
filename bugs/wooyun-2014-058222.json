{"id": 3730, "wybug_id": "wooyun-2014-058222", "wybug_title": "新华社某分社信息录入系统与短信系统文件遍历与注入导致大量用户手机泄露", "wybug_corp": "新华社", "wybug_author": "小威", "wybug_date": "2014-04-24 08:49", "wybug_open_date": "2014-06-08 08:49", "wybug_type": "重要敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["目录遍历", "敏感信息泄露", "默认配置不当", "内部敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-08：\t细节向公众公开  简要描述： 现有的文件便利之后又想到了注入~  详细说明：  地址：http://218.57.170.91:8080/  广西新华社信息录入系统1）系统存在文件遍历：http://218.57.170.91:8080/adduser.asphttp://218.57.170.91:8080/modify.asp此处可直接获取管理员帐号密码\n\n或者可自己添加一个账户\n\n随便找个权限为“1”（1为最大）的帐号登录\n\n2）登录账户后 注入点 http://218.57.170.91:8080/view.asp?dd=69701 \n\n注射到表段发现，此站不单单是个信息录入平台，而且还有大量的手机用户订阅信息。\n\n出去了会回来  数据已经跑到了1000000多万  估计总体在几百万左右吧\n\n可获取服务器内容：\n\n3）其它一些小地方：（关键处打码）\n[ManageDB]DBServerName=. DBName=managedb UserID=sa PassWord=ch***55[iAgentDB]DBServerName=. DBName=iagentdb UserID=sa PassWord=ch***55[infodb]DBServerName=. DBName=info UserID=sa PassWord=ch***55\n短信发送服务器配置信息（贴出一小段）：（关键处打码）\n[Public]  ;网号NetID=1   ;网名  NetName=1   ;站点代码ComID=053*  ;站点名称ComName=维坊信息台  ;中心联网服务所在URL地址UniteServiceURL=http://192.***.**.60/uniteservice/    ;中心联网数据源所在URL地址DistributeURL=http://192.***.**.60/wwwdata/   ;此项设置为运行写服务日志和通道日志的组件所在的机器名称LOGSERVER=192.***.**.60AppManagerSvr=192.***.**.60[iAgent]  ;iAgent本地数据库服务器名称DBServerName=192.***.**.60  ;iAgent本地数据库名称DBName=iAgentDB   ;iAgent本地数据库用户代码UserID=sa     ;iAgent本地数据库用户口令PassWord=ch***55          ;发送短信息的MTS服务器名称SMintfMachine=192.***.**.60  ;短信息发送的服务号SMintfServiceID=8  ;iAgent本地URL地址iAgentURL=http://192.***.**./iAgent/   ;支持的终端列表Terminal=www;wap;cti [iAgentCenterDB]  ;iAgent中心数据库服务器名称DBServerName=192.***.**.60  ;iAgent中心数据库名称DBName=uniteservicecenter  ;iAgent中心数据库用户代码UserID=sa     ;iAgent中心数据库用户口令PassWord=ch***55[LocalInfo]   ;数据库所在的机器名称 DBServerName=192.***.**.60   ;数据库名称 DBName=LocalinfoDB   ;连接数据库使用的帐号 UserID=sa   ;连接数据库使用的帐号密码 PassWord=ch***55   ;日志文件路径 LogFilePath=C:\\LDLogFile                ;代理服务器的主机地址 ProxyHost=   ;代理服务器的端口号 ProxyPort=80    ;本地数据库对外输出数据的URL地址 LocalinfoUrl=HTTP://192.***.**.60/LocalInfoData/   ;本地数据库模块对外公布的ASP对象名称说明\n   漏洞证明：  1）系统存在文件遍历：http://218.57.170.91:8080/adduser.asphttp://218.57.170.91:8080/modify.asp此处可直接获取管理员帐号密码\n\n或者可自己添加一个账户\n\n随便找个权限为“1”（1为最大）的帐号登录\n\n2）登录账户后 注入点 http://218.57.170.91:8080/view.asp?dd=69701 \n\n注射到表段发现，此站不单单是个信息录入平台，而且还有大量的手机用户订阅信息。\n\n出去了会回来  数据已经跑到了1000000多万  估计总体在几百万左右吧\n\n可获取服务器内容：\n\n3）其它一些小地方：（关键处打码）\n[ManageDB]DBServerName=. DBName=managedb UserID=sa PassWord=ch***55[iAgentDB]DBServerName=. DBName=iagentdb UserID=sa PassWord=ch***55[infodb]DBServerName=. DBName=info UserID=sa PassWord=ch***55\n短信发送服务器配置信息（贴出一小段）：（关键处打码）\n[Public]  ;网号NetID=1   ;网名  NetName=1   ;站点代码ComID=053*  ;站点名称ComName=维坊信息台  ;中心联网服务所在URL地址UniteServiceURL=http://192.***.**.60/uniteservice/    ;中心联网数据源所在URL地址DistributeURL=http://192.***.**.60/wwwdata/   ;此项设置为运行写服务日志和通道日志的组件所在的机器名称LOGSERVER=192.***.**.60AppManagerSvr=192.***.**.60[iAgent]  ;iAgent本地数据库服务器名称DBServerName=192.***.**.60  ;iAgent本地数据库名称DBName=iAgentDB   ;iAgent本地数据库用户代码UserID=sa     ;iAgent本地数据库用户口令PassWord=ch***55          ;发送短信息的MTS服务器名称SMintfMachine=192.***.**.60  ;短信息发送的服务号SMintfServiceID=8  ;iAgent本地URL地址iAgentURL=http://192.***.**./iAgent/   ;支持的终端列表Terminal=www;wap;cti [iAgentCenterDB]  ;iAgent中心数据库服务器名称DBServerName=192.***.**.60  ;iAgent中心数据库名称DBName=uniteservicecenter  ;iAgent中心数据库用户代码UserID=sa     ;iAgent中心数据库用户口令PassWord=ch***55[LocalInfo]   ;数据库所在的机器名称 DBServerName=192.***.**.60   ;数据库名称 DBName=LocalinfoDB   ;连接数据库使用的帐号 UserID=sa   ;连接数据库使用的帐号密码 PassWord=ch***55   ;日志文件路径 LogFilePath=C:\\LDLogFile                ;代理服务器的主机地址 ProxyHost=   ;代理服务器的端口号 ProxyPort=80    ;本地数据库对外输出数据的URL地址 LocalinfoUrl=HTTP://192.***.**.60/LocalInfoData/   ;本地数据库模块对外公布的ASP对象名称说明\n   修复方案：     版权声明：转载请注明来源 小威@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-04-29 08:30 厂商回复： CNVD确认并复现所述情况，转由CNCERT直接向网站管理单位通报，并同时下发给了广西分中心加快处置进度。 最新状态： 2014-04-30：根据新华社广西分社后续反馈情况，网站为分社手机短信部2006年与一家通讯公司合作开发短信上传系统，只使用了两年，从2008年分社已停止与该公司的合作，不再使用该系统。目前分社已与该合作公司联系，并已关闭该系统。  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}