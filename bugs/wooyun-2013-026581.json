{"id": 10902, "wybug_id": "wooyun-2013-026581", "wybug_title": "对苏宁易购一次完整的web检测过程（多图）", "wybug_corp": "江苏苏宁易购电子商务有限公司", "wybug_author": "HRay", "wybug_date": "2013-06-22 14:53", "wybug_open_date": "2013-08-06 14:53", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["完整"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-06：\t细节向公众公开  简要描述： 无意中发现苏宁厂商的态度不错，对漏洞评价一般也很详细，于是对苏宁易购进行了一次简单的web安全检测，整个过程几乎全部截图，希望没泄露关键信息... 详细说明：  无意中发现苏宁厂商的态度不错，对漏洞评价一般也很详细，于是对苏宁易购进行了一次简单的web安全检测首先通过google搜索site:suning.com inurl:login目的是搜索可登陆的地方，看看能否找到一些敏感系统的入口然后搜到了这个点\n\n直接访问，发现竟然是已登录状态\n\n推测google搜到的地址包含相关验证参数，抓包看了一下链接为http://sop.suning.com/scs/NewSCSHomePage.jsp?login=Bdl8BJlQcA9UNnPxZ5Iu1NdBX36Awia7SzNsl0XkxlAj8gbDH6jvZt6d+QQXQZJe由于这套系统默认是需要登录认证的\n\n点击下方知识管理的一处链接，本来是想测试一下有无注入的，结果发现了一个新的地址\n\n直接请求http://b2bkm.suning.cn:9080/跳转到了http://b2bkm.suning.cn:9080/restrictedHomePage/index.jsp 依然是登录状态\n\n此时考虑兼容问题转战IE，但是IE访问竟然跳到了登陆页，此时猜测是referer的问题，得到证实，http头中无referer会302跳转\n\n加了referer后，只需要添加http://即可绕过认证直接访问\n\n之前发现一个上传下载功能很讨人喜欢，于是访问看了一下，可惜未发现利用点\n\n后来随便点击，发现了熟悉的ewebeditor\n\n查看源码即得到ewebeditor的路径，访问http://b2bkm.suning.cn:9080/eWebEditor/admin/login.jsp看到后台界面ewebeditor后台用默认口令admin/admin成功登陆，利用方式大家应该都很熟了，拷贝样式，上传类型添加jsp，然后预览样式，上传，通过上传管理功能可以看到成功传上去了\n\n但是访问竟然是404，于是继续利用列目录那个漏洞http://b2bkm.suning.cn:9080/eWebEditor/admin/upload.jsp?id=26&d_viewmode=list&dir=../发现有个filemanager\n\n看看是个啥东西，点开一看，可以新建，上传文件，也可以改名删除操作，简直就是个后门功能\n\n直接传一个jspshell，无任何拦截，并且为root权限\n\n   漏洞证明：  问题1：sop.suning.com访问认证缺陷\n\n问题2：b2bkm.suning.cn:9080在http头部添加referer字段即可绕过认证\n\n问题3：ewebeditor编辑器综合问题（后台默认口令，列目录）\n\n问题4：filemanager-后门一样的存在\n\n   修复方案：  问题1：如果一定需要一个添加可直接访问的字段，建议增加时效性，并且用post方式提交问题2：完善验证流程问题3：删除默认后台及列目录功能，必要保留的话建议登陆文件改名并且修改默认口令问题4：这个没啥说的，最好直接删除该功能，必要保留的话增加登陆验证并且限制上传文件类型注：码了这么多字，截了这么多图，给加个精吧:)   版权声明：转载请注明来源 HRay@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-06-24 09:21 厂商回复： 感谢您对苏宁易购安全的关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-23 00:56 |    \t\tHRay \t\t\t( 普通白帽子  |\t\t\t        Rank:196 漏洞数:28        | 018)\t\t \n  补充一条吧，webserver降权运行。。。    \n     2013-06-23 03:42 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  标题很类似额。。。。    \n     2013-06-23 09:30 |    \t\tHRay \t\t\t( 普通白帽子  |\t\t\t        Rank:196 漏洞数:28        | 018)\t\t \n  @淡漠天空 是啊：）    \n     2013-06-25 16:49 |    \t\t0x0F \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:60        | 尖刀安全 (JDSec.Com).......................)\t\t \n  昊哥在努力赚钱娶媳妇    \n     2013-07-14 17:28 |    \t\t黄小昏 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:7        | alert（妹子）)\t\t \n  @0x0F @HRay 确定有妹子啦？    \n     2013-07-14 18:45 |    \t\tHRay \t\t\t( 普通白帽子  |\t\t\t        Rank:196 漏洞数:28        | 018)\t\t \n  @黄小昏 已经有两年多了。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}