{"id": 29410, "wybug_id": "wooyun-2015-0119495", "wybug_title": "金山词霸某站点php代码泄漏", "wybug_corp": "金山词霸", "wybug_author": "lijiejie", "wybug_date": "2015-06-10 13:54", "wybug_open_date": "2015-07-25 14:10", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-25：\t细节向公众公开  简要描述： 金山词霸某站点php代码泄漏 详细说明：  php文件没有解析，直接下载：\nhttp://web.iciba.com/wap/sms/send_msg.phphttp://web.iciba.com/wap/sms/config.inc.phphttp://web.iciba.com/wap/sms/RPC.php\n   漏洞证明：  Key泄漏\n<?phperror_reporting(0);$rpcConf['rpcHost'] = \"send.sms.kingsoft.com\";$rpcConf['rpcPort'] = \"8080\";$rpcConf['rpcPath'] = \"/sender/sendMessage\";$rpcConf['method']\t= \"sender.send\";$user = \"iciba\";$md5key = \"1$0I*!c#i%b^a!%$\";require_once(dirname(__FILE__).\"/RPC.php\");function sendMsg($mobile,$message){    global $rpcConf,$user,$md5key;     $message = iconv(\"utf-8\",\"gbk\",$message);    $message = base64_encode($message);    $md5Str\t= md5($user.$mobile.$message.$md5key);    $params = array(        new XML_RPC_Value($user, 'string'),        new XML_RPC_Value($mobile, 'string'),        new XML_RPC_Value($message, 'string'),        new XML_RPC_Value($md5Str, 'string'),     );    $msg = new XML_RPC_Message($rpcConf['method'], $params);    $cli = new XML_RPC_Client($rpcConf['rpcPath'], $rpcConf['rpcHost'],$rpcConf['rpcPort']);    $cli->setDebug(0);    $rep = $cli->send($msg);    $val = $rep->value();    $res = $val->scalarval();    return $res;}?>\n测试给自己发短信，并没有成功：\n\n   修复方案：  删除文件   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2015-06-10 14:08 厂商回复： 收到，非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}