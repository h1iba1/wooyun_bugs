{"id": 83526, "wybug_id": "wooyun-2015-0147561", "wybug_title": "全国房地产估价行业管理信息平台存在漏洞导致众多房地产估价师信息泄露", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "crown丶prince", "wybug_date": "2015-10-19 21:38", "wybug_open_date": "2015-12-07 16:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-07：\t细节向公众公开  简要描述： 全国房地产估价行业管理信息平台存在漏洞导致众多房地产估价师信息泄露应该可以交给cncert国家互联网应急中心处理 详细说明：  【对象分析】这个系统有两个后台后台一：http://**.**.**.**/ 这个后台涉及内容已经在下图标出\n\n涉及了中国的房地产估价师们的个人信息，证书信息后台二：http://**.**.**.**/Member/CheckMember.aspx从中可以看到登录需要身份证，那么如果存在注入，拿到数据库，就可以获得所有估价师的包含身份证信息的个人信息，证书信息了【开始测试】：在后台二发现了POST注入sqlmap测试语句：\npython sqlmap.py -u \"http://**.**.**.**.cn/Member/CheckMember.aspx\" --data \"__VIEWSTATE=dDwxMDE2NjY4Mjc1Ozs%2Bm1hdmKxx8HMqIvYibJ89jAZlO90%3D&txtname=88952634&btnLogin=%EF%BF%BD%EF%BF%BD%C2%BC&txtnum=88952634\" --current-db\nsqlmap截图：\n\n但是从图中可看出，注入非常慢，想获得所有数据需要很长时间【另辟蹊径】检测该站点其他二级域名发现了另一个注入点：http://**.**.**.**/website/dfxhs_cx_gs.asp?DwID=7297and 1 = 1 不变 and 1 = 2 报错sqlmap语句：python sqlmap.py -u \"http://**.**.**.**/website/dfxhs_cx_gs.asp?DwID=7297\" 两者数据库竟然是相同的。。（相当于获得了这个站点的注入数据，也就是我们想拿到的后台二的数据）sqlmap截图：\n\n数据库分的很多，根据职业比如专家，估价师等等存储了400多个表（如下图）\n\n这里看一下 dbo.BrokerInfo 这个表的英文对应的是经纪人只查看了字段，点到为止吧\n\n【KO】至此导致全国房地产估价行业管理信息平台沦陷    导致众多房地产估价师（全国的量应该很大）信息泄露   漏洞证明：     修复方案：     版权声明：转载请注明来源 crown丶prince@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-10-23 16:30 厂商回复： CNVD确认并复现所述情况，已由CNVD通过网站管理方公开联系渠道向其邮件通报，由其后续提供解决方案。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}