{"id": 9383, "wybug_id": "wooyun-2013-033780", "wybug_title": "城市中国验证缺陷可随意伪造用户登录并获取密码以及一处存储xss", "wybug_corp": "ccoo.cn", "wybug_author": "Ov4ns7wp", "wybug_date": "2013-08-12 15:55", "wybug_open_date": "2013-09-26 15:56", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "明文密码", "欺骗", "久型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-26：\t细节向公众公开  简要描述： 验证判断不够严谨可随意伪造信息登录论坛，总版主密码以明文方式保存 修改密码时可显示、个人中心可XSS；话说城市中国几乎在每个省份都有2-3个分舵，使用量还是挺多的； 详细说明：  0x01 可随意注册一个用户登录到论坛个人中心；然后可利用总版主(城市中国论坛最大权限的貌似只有总版主)用户名，通过伪造cookie ，直接刷新即显示为总版主用户个人中心；权限跟正常登陆无任何区别。0x02 总版主安全中心修改密码，旧密码中显示明文0x03 个人中心xss漏洞   漏洞证明：  0x01到http://www.ccoo.cn/随意挑选一个比较热门的地方；注册，进入个人中心\n\n环境： chrome 工具： chrome插件 Edit This Cookie 1.2.1删除多余项，仅仅留下 ccoo 将自己的用户名改成总版主的\n\n刷新下，回到自己的个人中心；结果立竿见影\n\n0x02 前往 http://www.yszx.ccoo.cn/my/repass.asp 修改用户密码旧密码框虽然是原点，但是在html中密码还是可见的；ps：有了这个密码感觉有些鸡肋，没法拿SHELL，城市中国好像有个统一平台管理的？知道的同学还望指教~\n\n0x03在个人中心发表心情的地方， 编辑框有字数限制； 不过没关系，我们通过html中的 value  来直接提交\n\n刚发表完，结果就来了\n\n这个说说是全论坛人可见的， cookie 就像洪水一样袭来；   修复方案：  严谨判断+加密+过滤   版权声明：转载请注明来源 Ov4ns7wp@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-08-12 18:10 厂商回复： 感谢提交，我们会尽快修复漏洞！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}