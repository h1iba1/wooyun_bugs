{"id": 21407, "wybug_id": "wooyun-2011-03753", "wybug_title": "xiage论坛配置文件泄漏", "wybug_corp": "广州多玩", "wybug_author": "天鱼", "wybug_date": "2011-12-24 15:10", "wybug_open_date": "2012-02-07 15:11", "wybug_type": "重要敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "安全架构设计导致攻击界面变大", "默认配置不当", "源代码泄漏", "数据敏感"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-12-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-12-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-01-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-01-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-01-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-02-07：\t细节向公众公开  简要描述： 论坛存在svn信息，且能下载代码文件，导致论坛用户数据库泄漏 详细说明：  http://3g.yy.com/bbs/.svn/text-base/config.inc.php.svn-base这里能下到xiage.yy.com论坛的配置文件，里面有UC_KEY，可以用该key绕过论坛邀请注册限制，直接连接ucenter注册用户http://3g.yy.com/bbs/uc_server/data/.svn/text-base/config.inc.php.svn-base这里能下到ucenter的配置文件，里面也有UC_KEY如果只是这样还不严重，但论坛和ucenter有个数据库备份的文件dbbak.php,该文件在api目录下，该文件只验证KEY，只要key正确就可以进行数据库备份，数据库导入等操作通过PHP生成对应的验证code\necho \"apptype=ucenter&code=\".urlencode(_authcode(\"time=\".time().\"&method=export\", \"ENCODE\", UC_KEY));\n然后访问http://xiage.yy.com/uc_server/api/dbbak.php?加上生成的code串即可导出ucenter的数据库把method改成list，即可知道网站的全路径   漏洞证明：  http://3g.yy.com/bbs/.svn/text-base/config.inc.php.svn-basehttp://3g.yy.com/bbs/uc_server/data/.svn/text-base/config.inc.php.svn-base\n\n\n\n\n\n   修复方案：  把3g.yy.com/bbs/下面的.svn目录删除或者禁止外部访问dbbak.php最好加上session登录验证(貌似是discuz的问题)然后就是修改UC_KEY，删除导出的那份sql文件等等等   版权声明：转载请注明来源 天鱼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2011-12-24 17:53 厂商回复： 正在处理，谢谢提供。 最新状态： 2012-01-08：已经修复，谢谢。  ", "replys": "漏洞评价：\n评论\n     2011-12-25 00:39 |    \t\t天鱼 \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:5        | 逝去的梦)\t\t \n  呃，系统提示给我发了礼物？我很好奇我都没写地址怎么发礼物。。。。    \n     2011-12-25 19:49 |    \t\tSnow \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:6        | 换马甲  擦擦擦)\t\t \n  等你挂了 多玩也许会给拟烧到下面去    \n     2012-01-01 02:05 |    \t\t天鱼 \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:5        | 逝去的梦)\t\t \n  呃，收到多玩给的YY熊了。。。    \n     2013-03-05 12:27 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @天鱼 噗嗤    \n     2013-03-08 18:51 |    \t\t天鱼 \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:5        | 逝去的梦)\t\t \n  @xsser 挖坟啊。。。。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}