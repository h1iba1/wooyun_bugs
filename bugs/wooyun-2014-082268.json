{"id": 43603, "wybug_id": "wooyun-2014-082268", "wybug_title": "ILASⅢ Digital library System DBA Sql Injection", "wybug_corp": "深圳市科图自动化新技术应用公司", "wybug_author": "路人甲", "wybug_date": "2014-11-07 17:53", "wybug_open_date": "2015-02-05 17:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-07：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-02-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： ILASⅢ数字图书馆系统存在DBA权限的注入漏洞 详细说明：  这次可别告诉我又有人提交。审核哥哥，能不要待认领么？这都rank都没了还是由cncert上报个厂商吧。 厂商： \nhttp://www.ilas.com.cn/ ILAS世界,深圳市科图自动化新技术应用公司 产品：ilasIII数字图书馆 http://www.ilas.com.cn/ProductsView.Asp?Id=3\n Google收录： \n\nmask 区域\n*****b83a6420df018d70c20e32.jpg*****\n\nSQL注入点：\n/GetPassword.aspx  找回密码处的UserName参数过滤不严导致SQL注入,DBA权限\n非常明显的Oracle报错注入：\n\n   漏洞证明：  【免责声明：为证明漏洞和复现漏洞的危害性，以互联网实例作为安全测试参考。以下为漏洞报告非利用方式，仅供证明漏洞未获取任何有效数据，案例仅供国家互联网应急中心测试复现并上报厂商，其它人不可利用漏洞进行恶意破坏，否则后果自负，漏洞在厂商确认后均做打码处理，感谢您的支持与理解！】枚举一些案例，单引号就可以报错。\n\nmask 区域\n1.http://**.**.**/\n\nGetPassword.aspx\n\nmask 区域\n1.http://**.**.**/\n\nGetPassword.aspx\n\nmask 区域\n1.http://**.**.**/\n\nGetPassword.aspx\n\nmask 区域\n1.http://**.**.**/\n\nGetPassword.aspx\n\nmask 区域\n1.http://**.**.**/\n\nGetPassword.aspx\n\nmask 区域\n1.http://**.**.**/\n\nGetPassword.aspx\n\nmask 区域\n1.http://**.**.**/\n\nGetPassword.aspx我就随机挑3个来测试一下，以后再也不测5个了，累死了~案例测试证明1：\n\nmask 区域\n1.http://**.**.**\n\n/GetPassword.aspx抓个数据包：\nPOST /GetPassword.aspx HTTP/1.1Host: l***.***.**u.cnProxy-Connection: keep-aliveContent-Length: 399Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://l***.***.**u.cnUser-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://l****.***.**u.cn/GetPassword.aspxAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: ASP.NET_SessionId=4pkmwwamogrkwu55rfd4br55__VIEWSTATE=%2FwEPDwUKMjEzODQ2Njg5MQ9kFgICAw9kFgQCAw8PFgIeBFRleHQFRuWPkemAgemCruS7tuWHuumUmSEgT1JBLTAxNzU2OiDlvJXlj7flhoXnmoTlrZfnrKbkuLLmsqHmnInmraPnoa7nu5PmnZ9kZAIRDw8WAh8ABQQ5NTQ1ZGRkXERd%2FFIfmp42xGXyNhLyNA7lNEQ%3D&UserName=aaaaa&TBEmail=123456%40qq.com&txtAppendix=9545&btnLogin=%E6%8F%90%E4%BA%A4&__EVENTVALIDATION=%2FwEWBQK%2Bic3VCQKvruq2CALsr7KBDwLN3bW9DQKC3IeGDAEfT%2F5BDd0umcZMgxHfgy0cl30B\n\n\n\n\n案例测试证明2：\n\nmask 区域\n1.http://**.**.**\n\n/GetPassword.aspx\n\n\n\nmask 区域\n1.http://**.**.**/\n\nGetPassword.aspx\n\n\n\n   修复方案：  全是DBA啊~参数过滤要严格啊。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}