{"id": 52099, "wybug_id": "wooyun-2014-072302", "wybug_title": "图虫网安全监测（一）", "wybug_corp": "图虫网", "wybug_author": "Ev1l", "wybug_date": "2014-08-14 11:46", "wybug_open_date": "2014-09-28 11:48", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "设计缺陷", "逻辑错误", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-28：\t细节向公众公开  简要描述： 我决定为了冲击实习来发一个连续剧了 详细说明：  #01 莫名其妙的爆路径首先在注册的时候选择QQ登陆，然后创建新用户，然后就一切都正常填，不知道怎么就出来了个success，着我就知道了，当我们再次注册的时候果断就爆出来了绝对路径\n\n这种低级错误不该犯#02 Cookie中包含用户邮箱密码ID当我们登出抓包的时候，发现用户的cookie中竟包含用户密码我的测试账号cookie如下\nPHPSESSID=6qc492s65bv1oqb3hid1muk5d5; __utmc=115147160; site=tuchong; __utma=115147160.2134742573.1407940497.1407940497.1407940497.1; __utmb=115147160.5.10.1407940497; __utmz=115147160.1407940497.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); email=ev1l%40vip.qq.com; storage=456150; password=fd6111f92380c6dc6c91d2c39bb4c9e4\n从中得出密码的md5  经解密与实际密码相同#03 XSS\n\n如果单独输入</>就会被过滤只剩下>\n\n但是通过分析输入 <<//>就可以达到绕过过滤\n\n\n\n截稿时</及>暂未过滤\n\n成功弹窗配合前面的cookie问题，我们可以轻易的拿到大量的cookie配合第二条的问题，我们可以直接拿到密码账号邮箱但是在挖完洞总结的时候好像<被过滤的感觉- -不管怎么弄都没有弹了#04 又一处爆绝对路径http://tuchong.com/settings/avatar/上传头像处上传shell.php.jpg弹出了一个下载框，包含了几个绝对路径\n\n# 小结虽说这次发的几个洞都是无关紧要的，主要是看看厂商的积极性，手里找到了一个sql注入和越权，就下次再发吧，毕竟我是要连续剧的提醒下厂商，某些微不足道的小错误积累多了就会成为大错误   漏洞证明：  \n\n我喜欢这张的妹子   修复方案：  整体看下系统第一弹发的主要问题，都是检测系统基础的稳定性，而不是大的差错毕竟你面对的是用户，而白帽子只是特殊的用户而已。   版权声明：转载请注明来源 Ev1l@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-08-14 13:02 厂商回复： 谢谢，但是这些都是老版图虫的漏洞，小公司没有那么多人手同时维护新老两个版本，老版图虫很快会下线。欢迎找找新版的漏洞。谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-14 14:15 |    \t\tEv1l \t\t\t( 实习白帽子  |\t\t\t        Rank:68 漏洞数:20        | 问题真实存在但影响不大。联系邮箱security...)\t\t \n  @图虫网 新版系统木有找到在哪，话说怎么走小厂商了呢……    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}