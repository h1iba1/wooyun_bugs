{"id": 23741, "wybug_id": "wooyun-2010-0873", "wybug_title": "Phpwind远程任意代码执行漏洞", "wybug_corp": "phpwind", "wybug_author": "路人甲", "wybug_date": "2010-11-25 11:45", "wybug_open_date": "2010-12-25 12:00", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["代码执行", "源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-11-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2010-11-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2010-11-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2011-01-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-01-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-02-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2010-12-25：\t细节向公众公开  简要描述： Phpwind对于某些用户提交的参数过滤不严，导致可能的一个远程代码执行，普通前台恶意用户可以取得使用phpwind站点的权限 详细说明：  ./phpwind7.2/thread.php中\nInitGP(array('page','type','search','orderway','asc','special'));…… //此处省略X行$db_maxpage && $page > $db_maxpage && $page = $db_maxpage;(int)$page<1 && $page = 1;…… //此处也省略X行$numofpage < 1 && $numofpage = 1;if ($page > $numofpage) {\t$page  = $numofpage;}最终Page这个变量进入了两次判断，都只是判断了大小，而后走入if ($db_fcachenum && $page < $db_fcachenum && empty($urladd)) {\t$fcachetime = pwFilemtime(D_P.\"data/bbscache/fcache_{$fid}_{$page}.php\");\t$lastpost = explode(\"\\t\",$foruminfo['lastpost']);\tif (!file_exists(D_P.\"data/bbscache/fcache_{$fid}_{$page}.php\") || $lastpost[2]>$fcachetime && $timestamp-$fcachetime>$db_fcachetime) {\t\t$fcache = 1;\t} else {\t\t$fcache = 2;\t}}当开启了版块缓存的话，且D_P.data/bbscache/fcache_{$fid}_{$page}.php的创建时间在缓存有效期间内的话……include_once(D_P.\"data/bbscache/fcache_{$fid}_{$page}.php\");\n则毫不留情的包含了良好的设计需要良好的实现，良好的实现依赖于人员良好的执行，你说呢？   漏洞证明：  需要么   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2010-11-25 16:04 厂商回复： 谢谢漏洞提交者，我们正在修复此漏洞，谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2010-11-25 12:01 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  坐等~~~    \n     2010-11-25 12:07 |    \t\tFIr3D1i \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 啥都没有)\t\t \n  坐等+1....    \n     2010-11-25 16:08 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  草 这也是中啊~~    \n     2010-11-25 17:37 |    \t\tGaRY \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:3        | 真悲剧平男君)\t\t \n  远程代码执行就给个中？坐等开放出来看    \n     2010-11-25 18:27 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  ... 坐等真相。    \n     2010-11-26 16:03 |    \t\tanyunix \t\t\t( 实习白帽子  |\t\t\t        Rank:86 漏洞数:8        | 号被盗。)\t\t \n  排队等    \n     2010-11-28 23:49 |    \t\t少帅 \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:14        )\t\t \n  求等.    \n     2010-11-29 01:23 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:25        | 求各种兼职)\t\t \n  建议先公布文件名第一个字母和行数的第一个数字    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}