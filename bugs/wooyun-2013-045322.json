{"id": 6499, "wybug_id": "wooyun-2013-045322", "wybug_title": "百度贴吧某功能CSRF+XSS漏洞可对用户留置后门", "wybug_corp": "百度", "wybug_author": "q601333824", "wybug_date": "2013-12-09 17:09", "wybug_open_date": "2014-01-23 17:10", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用", "蠕虫"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-23：\t细节向公众公开  简要描述： 百度贴吧某功能缺陷，配合已经存在的XSS，可对用户留置后门 详细说明：      1.问题出在上次的收藏图片功能(我有点啰嗦,因为怕出错)     2.和上次一样，截获收藏图片请求,如图 \n\n    3. get请求,如图 \n\n    4.这个连接，我用别的号测试，然后在想，为什么会收藏失败啊，最后测试出来猜测失败的原因是UID参数，如图,图上是我UID，然后就是如何寻找别人的UID \n\n     5.这个漏洞就拿我的小号测试，点击头像进入新版主页,如图 \n\n \n\n    6.然后打开网页源码，搜索user_id,如图 \n\n     7.然后那个连接上我的UID，替换我小号的UID，如图 \n\n     8.配合已经存在的百度相册XSS（上次没修复）,可以构造一个CSRF连接让我小号访问，然后小号就会自动收藏带代码的图片，只要当小号访问自己收藏的时候就会触发,构造方法如图 \n\n      9.但是问题来了，就是这个连接插入图片那会出现未知错误，原因就是连接太长了     如图 \n\n      10.接下来修改下连接，留下必须的参数，去掉多余的参数，还有些参数不能为空但可以缩短      （1）：&descript参数没啥用，但是不能空，打个1就行      （2）：&tags参数没啥用，但是不能空，打个1就行      （3）：&url参数是图片地址，收藏的图片地址太长，修改成百度首页logo图片，那个地址短       (4):最后那个参数&_=感觉删掉了没影响      11.下面，这张图是修改之后的连接，如图 \n\n      12.修改之后的连接，可以插入图片了，发帖成功，这样楼主打开帖子就能访问那个连接,如图  \n\n \n\n     13.登录自己的小号ID，卖萌的中二，看看csrf和XSS的效果,已经登录小号，如图  \n\n      14.查看收藏，已经收藏了百度首页的logo图片，如图 \n\n      15.然后当中了CSRF的用户访问自己的相册收藏的时候，会触发XSS，如图。可以看见卖萌的中二的最新照片出现了百度首页logo图片了.................. \n\n       16.可以发现出现了弹框，而且是在卖萌的中二这个ID的收藏里面，这样应该算是CSRF配合XSS了.............  \n\n         漏洞证明：    1.\n\n  2.\n\n  3.\n\n  4. \n\n \n\n 5.\n\n  6.\n\n   7.\n\n  8. \n\n  9. \n\n  10.\n\n \n\n  11. \n\n  12.\n\n   13. \n\n   14. \n\n   修复方案：  UID那么明显，竟然没人看见..........啊   版权声明：转载请注明来源 q601333824@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2013-12-10 12:49 厂商回复： 感谢提交，安全组已经联系产品线处理此问题，新版上线还需要时间。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-09 18:38 |    \t\t233 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 小孩子看了根本把持不住)\t\t \n  mark    \n     2013-12-09 19:13 |    \t\tq601333824 \t\t\t( 普通白帽子  |\t\t\t        Rank:217 漏洞数:49        | 出自《丹特丽安的书架》---吾问汝,汝为人否...)\t\t \n  =_=    \n     2014-01-23 17:55 |    \t\tRicter \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:15        | 渣渣一个)\t\t \n  低...百度是不是舍不得给rank QAQ    \n     2014-01-23 21:45 |    \t\tBloodwolf \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:8        | whoami)\t\t \n  测试一下，无语    \n     2014-01-24 02:15 |    \t\tq601333824 \t\t\t( 普通白帽子  |\t\t\t        Rank:217 漏洞数:49        | 出自《丹特丽安的书架》---吾问汝,汝为人否...)\t\t \n  @Ricter cook拿不到，危害肯定不大.......=_=    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}