{"id": 57692, "wybug_id": "wooyun-2014-053598", "wybug_title": "YunGouCMS 商业框架存在XSS SQL注入", "wybug_corp": "yungoucms.com", "wybug_author": "Levine", "wybug_date": "2014-03-17 15:19", "wybug_open_date": "2014-06-15 15:19", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-20：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-15：\t细节向公众公开  简要描述： 存储型XSS,可放置至商品页,所有用户浏览即中招.使用此框架有几个网站做的比较大.用户量较大.波及用户过多可获得用户完全控制权.如果恶意利用 呵呵 详细说明：  用户修改头像处头像地址未进行过滤.导致XSS的出现. 此处未进行过滤的参数也可在提交订单逻辑处进行sql注入.因为本质上是一个漏洞.修复了此漏洞订单提交处sql注入无出现可能这里就不列举了.   漏洞证明：  \n\n\n\n\n\n到这步已经成功,因为这里有个单引号.所以在提交订单的时候顺便发现了sql注入点.订单提交失败.所以要换成\nString.fromCharCode(36,46,103,101,116,83,99,114,105,112,116,40,39,47,47,122,117,111,115,105,46,109,101,47,122,117,111,46,106,115,39,41,59);\n下面这已经成功的插入到商品页了 只要有用户浏览,cookie便可以获取到.拿个cookie提个现什么的 呵呵呵\n\n   修复方案：  不会我教你   版权声明：转载请注明来源 Levine@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-03-17 15:25 厂商回复： 谢谢你啊，好人一生平安！ 加个Q呗  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}