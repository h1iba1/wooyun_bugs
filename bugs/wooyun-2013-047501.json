{"id": 6047, "wybug_id": "wooyun-2013-047501", "wybug_title": "江苏省某系统漏洞问题打包", "wybug_corp": "江苏省某系统", "wybug_author": "雅柏菲卡", "wybug_date": "2013-12-31 12:59", "wybug_open_date": "2014-02-14 12:59", "wybug_type": "系统/服务运维配置不当", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-14：\t细节向公众公开  简要描述： ................ 详细说明：  ............   漏洞证明：  \n江苏省食品生产企业动态监管系统一、目录遍历加注册企业信息泄露1、目录遍历 遍历处如下http://222.190.96.178:9995/2、注册企业用户名and密码泄露（明文密码）http://222.190.96.178:9995/User.aspx\n\n二、越权1、赋权网页http://222.190.96.178:9995/RelationUserTypePopedomManage.aspx\n\n\n\n2、权限管理页面\n\n\n\n3、P2监督检查录入\n\n\n\n4、不知道是什么的收件箱 里头一堆华丽丽的整改通知书 \n\n\n\n三、任意文件上传并执行问题就出现在这个页面上http://222.190.96.178:9995/CheckInput.aspx\n\n\n\n aspx的小文件上传成功了 通过查源码 得知 C:\\web\\FCDM\\Web\\userFiles\\specialTask\\31495514209\\1.aspx返回到<dir> userFiles ——  <dir> specialTask ——  2013/12/30     8:12        <dir> 313927643832013/12/31    12:45        <dir> 314955142092013/12/31    12:45        72996 1.aspxhttp://222.190.96.178:9995/userFiles/specialTask/31392764383/1.aspx  密码 admin\n\n\n\n四 报错信息夹带着绝对路径“/”应用程序中的服务器错误。未将对象引用设置到对象的实例。说明: 执行当前 Web 请求期间，出现未处理的异常。请检查堆栈跟踪信息，以了解有关该错误以及代码中导致错误的出处的详细信息。 异常详细信息: System.NullReferenceException: 未将对象引用设置到对象的实例。源错误: 行 50:         string PermissionNameList = string.Empty;行 51:         CompanyBaseInfo companyModel = companyBaseBll.GetLatestModel(OrgCode);行 52:         txtOrgName.Text = companyModel.Entname;行 53:         DdlOrgType.SelectedValue = companyModel.EntType.ToString().Trim();行 54:         /* 绑定公司已获许可证列表*/源文件: c:\\web\\FCDM\\Web\\CompanyPermissionManage1.aspx.cs    行: 52 堆栈跟踪: [NullReferenceException: 未将对象引用设置到对象的实例。]   CompanyPermissionManage.bindPermission() in c:\\web\\FCDM\\Web\\CompanyPermissionManage1.aspx.cs:52   CompanyPermissionManage.Page_Load(Object sender, EventArgs e) in c:\\web\\FCDM\\Web\\CompanyPermissionManage1.aspx.cs:44   System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) +14   System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) +35   System.Web.UI.Control.OnLoad(EventArgs e) +99   System.Web.UI.Control.LoadRecursive() +50   System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) +627\n   修复方案：  ................   版权声明：转载请注明来源 雅柏菲卡@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：19  确认时间：2014-01-05 10:07 厂商回复： CNVD确认并复现所述多个情况，已经转由CNCERT下发江苏分中心，由其后续协调网站管理单位处置，按多个漏洞进行评分,rank 19 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-06 22:28 |    \t\t雅柏菲卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:1213 漏洞数:234        | 雙魚座聖鬥士雅柏菲卡)\t\t \n  @疯狗  这个也太高危了 居然是小厂商？    \n     2014-01-07 12:24 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @雅柏菲卡 已经修改    \n     2014-02-14 14:52 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  似乎不是通用的    \n     2014-02-14 17:54 |    \t\twoody \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | 菜鸟一枚)\t\t \n  国企啊毛病都已经公开了  结果漏洞还在那  都不带修复的真心牛逼    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 19, "Ranks": null}