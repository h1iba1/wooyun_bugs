{"id": 18043, "wybug_id": "wooyun-2012-09550", "wybug_title": "115网盘用户密码重置漏洞+某个页面允许无限次使用缺陷", "wybug_corp": "广东雨林木风计算机科技有限公司", "wybug_author": "imlonghao", "wybug_date": "2012-07-12 15:44", "wybug_open_date": "2012-08-26 15:45", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-26：\t细节向公众公开  简要描述： 略。 详细说明：  115网盘忘记密码有缺陷，未对手机验证码提交的次数进行限制，导致可以通过无限穷举手机验证码来重置用户的密码。不过，手机验证码的位数为6位全数字，范围很大，对电脑的网络要求比较高。同时用户手机也会收到提醒，所以自评15还有一个缺陷就是输入正确的手机验证码后，302跳转到的输入新密码的地址可以无限次使用，所以，只要拿到了这个地址，就可以无限次修改用户的密码。即使用户在正确的页面修改了密码，这个页面也是有效的，这样就有一个后门的感觉，自评1？？   漏洞证明：  下面是破解过程。=============================首先在忘记密码的页面输入帐号，然后选择使用密保手机找回。系统会自动给你发送一条疑验证短信\n\n验证的是6位的数字，所以我们来生成密码本\n\n然后随便输入一个假码，截取数据包，我们可以在里面找到我们输入的假码\n\n然后简单设置\n\n由于网络限制，速度非常慢，不能完整地从000000到999999进行穷举测试，由于我已经知道了手机验证码是多少，所以我们就从这个范围进行测试。导入密码库\n\n开始\n\n突然，我们截取到一个长度仅为610的数据包，前面的数据为114376，与我手机收到的相同。\n\n接着，我把114376输入进了网页的那个框，不过似乎错误了，过期了。额，从此可以得出这个密码的使用是一次性的。看上面的图，我们可以发现是一个302地址，那么他重定向到的地址可能就是修改密码的地址了。我们仔细去看看那个302的地址，发现了一个连接。\n\n进去，我们就来到了这个页面。\n\n成功重置\n\n成功侵入\n\n到此就结束了，不过我把密码通过正常的途径又修改了过来，在通过刚刚那个重置链接，发现并没有过期，我再通过重置连接修改，发现密码被修改成功，这个你懂的，有后门的含义。。。   修复方案：  要求用户输入自己的手机号码，与数据库比对。限制次数，一个验证码我不信他输入10次还是错的。其实你可以6位小数+小写字母。重置链接一次性。   版权声明：转载请注明来源 imlonghao@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2012-07-12 15:59 厂商回复： 非常感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-08-11 19:58 |    \t\t神刀 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:3        | www.shellsec.com内射那么牛，虾米没妹子？)\t\t \n  好洞！    \n     2012-08-12 15:47 |    \t\t鬼哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:136 漏洞数:13        | 鬼哥 ！！！！)\t\t \n  很多站验证码都是6位数字，没去测试。6位也是999999 如果有时间限制就难了些    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}