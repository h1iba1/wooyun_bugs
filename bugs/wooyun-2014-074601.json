{"id": 630, "wybug_id": "wooyun-2014-074601", "wybug_title": "人人网账户机制存在安全隐患(可导致未授权登录他人账号)", "wybug_corp": "人人网", "wybug_author": "jaffer", "wybug_date": "2014-09-02 12:47", "wybug_open_date": "2014-10-17 12:50", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["未授权访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-17：\t细节向公众公开  简要描述： 你还敢分享人人页面到微信吗？ 详细说明：  过程：1、首先在用户A手机网页上登录人人，查看任何人的日志，然后点击分享到微信。发送给微信上的用户B，或者分享到朋友圈。2、用户B在朋友圈看到用户A的分享，然后就直接进入了用户A的人人页面，可以干任何事情。用户B访问用户A分享的页面，抓数据包，过程：请求：GET /?v=1&src=l4uLj8XQ0MyY0Y2akY2akdGckJLQjJeejZrQjJeejZqakYuNhtGbkMCXi5nCzsrOy9mWm8LOyMnPzsfKys7GzdmMipabwszPysbKz87KztmNmovCjJeejZrazbmXkIuMl56NmtGbkNrMudKR0tq6yNrHzNq%2Bu9q6xtrGyNq%2Bx9q6ytrHx9rHydq6y9q9vtq%2BvdKR0s%2FZjJabwsfLm56enM6eycmdx5rNxs7Gy8vPz8rKyc6bmc%2BcyMuezdnJzIiQz5o%3D&restype=1&ucshare=1&country=cn&pf=jdaEnfXr%2BcSL152d7OPsuw%3D%3D&from=singlemessage&isappinstalled=1 HTTP/1.1Host: tc.uc.cnProxy-Connection: keep-aliveAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8X-Requested-With: com.tencent.mmUser-Agent: Mozilla/5.0 (Linux; U; Android 4.2.1; zh-cn; M355 Build/JOP40D) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 MicroMessenger/5.4.0.50_r797544.480 NetType/WIFIAccept-Encoding: gzip,deflateAccept-Language: zh-CN, en-USAccept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7Cookie: _pk_id.0294ad34f7ad.3156=2cc11ccaaae34e05.1409532873.1.1409532895.1409532873.; _pk_ses.0294ad34f7ad.3156=*返回信息：HTTP/1.1 200 OKServer: Tengine/1.4.6Date: Mon, 01 Sep 2014 01:21:31 GMTContent-Type: text/html;charset=UTF-8Content-Length: 20068Connection: keep-aliveVary: Accept-EncodingUCCode: -3<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE html PUBLIC \"-//WAPFORUM//DTD XHTML Mobile 1.0//EN\" \"http://www.wapforum.org/DTD/xhtml-mobile10.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><base href=\"http://3g.renren.com/share/shareentry.do?htf=1514&id=17601855192&suid=305950151&ret=share%2Fhotshare.do%3F-n-%E7%83%AD%E9%97%A8%E5%88%86%E4%BA%AB-n-0&sid=84daac1a66b8e291944005561df0c74a2&63wo0e\" /><title>ææºäººäººç½ - æ¥å¿åäº«</title><META name=\"msApplication-ID\" content=\"BUILD.70a71681-f761-44f7-b6fb-029238bddf44\"/><META name=\"msApplication-PackageFamilyName\" content=\"BUILD.70a71681-f761-44f7-b6fb-029238bddf44_jmektqcje7yt4\"/><meta http-equiv=\"Expires\" CONTENT=\"0\"><meta http-equiv=\"Cache-Control\" CONTENT=\"no-cache\"><meta http-equiv=\"Pragma\" CONTENT=\"no-cache\"><link href=\"http://s.xnimg.cn/wap/apple_icon_.png\" rel=\"apple-touch-icon-precomposed\" /><link rel=\"stylesheet\" href=\"http://s.xnimg.cn/a66577/wap/i.css\" type=\"text/css\"/></head><body><a id=\"shenma_page_url\" href=\"http://3g.renren.com/share/shareentry.do?htf=1514&id=17601855192&suid=305950151&ret=share%2Fhotshare.do%3F-n-%E7%83%AD%E9%97%A8%E5%88%86%E4%BA%AB-n-0&sid=84daac1a66b8e291944005561df0c74a2&63wo0e\" keep-url></a><script language=\"javascript\">//<!--//é¡µé¢èªå¨è·³è½¬(.......还有很多这里不列举。关键是sid。人人网分享会将sid传输。那么这个sid有什么用？选一个纯净的浏览器直接访问url:http://mreg.renren.com/guide/wguidehome.do?&sid=84daac1a66b8e291944005561df0c74a2页面如下：\n\nsid是关键，应该是类似sessionid的。但是人人却在页面传输这个关键的参数。据有限数据分析，sid在下面的域下是直接传输的：3g.renren.commreg.renren.com尤其是mreg.renren.com，希望能好好检查一下这个域。手机端的不能这么大意。   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 jaffer@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-09-02 14:07 厂商回复： 谢谢喽 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-02 12:55 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  我操！互联网真不安全，原来是分享到微信的那个接口的问题额    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}