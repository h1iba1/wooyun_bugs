{"id": 58292, "wybug_id": "wooyun-2014-051687", "wybug_title": "PHPMYWIND sql 一枚 无视GPC", "wybug_corp": "phpmywind.com", "wybug_author": "′雨。", "wybug_date": "2014-02-22 18:20", "wybug_open_date": "2014-05-23 18:21", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-04-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-23：\t细节向公众公开  简要描述：   今天又去重新看了看phpmywind   在官网上下的 版本还是4.6.6  无需登录 无需单引号。 详细说明：  在order.php中\nif(empty($_COOKIE['shoppingcart'])){   \theader('location:shoppingcart.php');\texit();}//不允许游客下单跳转登陆if(empty($_COOKIE['username'])){   \theader('location:member.php?c=login');\texit();}\n让这两个不为空就好。\n$action    = isset($action)    ? $action    : '';$datagroup = isset($datagroup) ? $datagroup : '';$level     = isset($level)     ? $level     : '';$v         = isset($areaval)   ? $areaval   : '0';//获取级联if($action == 'getarea'){\t$str = '<option value=\"-1\">--</option>';\t$sql = \"SELECT * FROM `#@__cascadedata` WHERE level=$level And \";\tif($v == 0)\t\t$sql .= \"datagroup='$datagroup'\";\telse if($v % 500 == 0)\t\t$sql .= \"datagroup='$datagroup' AND datavalue>$v AND datavalue<\".($v + 500);\telse\t\t$sql .= \"datavalue LIKE '$v.%%%' AND datagroup='$datagroup'\";\t\t$sql .= \" ORDER BY orderid ASC, datavalue ASC\";\t$dosql->Execute($sql);\n什么$level v啊 都是可控的 但是会被转义。观察这个语句。、\telse if($v % 500 == 0)\t\t$sql .= \"datagroup='$datagroup' AND datavalue>$v AND datavalue<\".($v + 500);只要满足这个 可以发现 v是没有单引号的。 所以就可以持续注入了。但是内置80sec的ids 就是dede那个不过已经被绕过了。@`'` 但是这个单引号会被转义。 我添加一个这个还是没绕过然后再在结尾又添加了一个 然后绕过成功。然后构造一下语句 注入成功。   漏洞证明：  \n\n注入成功 有图 有真相。   修复方案：  求20分.求包养。求过滤。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-03-03 13:40 厂商回复： 感谢提交漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-05 18:38 |    \t\tj2ck3r \t\t\t( 普通白帽子  |\t\t\t        Rank:406 漏洞数:92        | 别关注我，跟你不熟。)\t\t \n  洞主 你使用是什么工具 插件名字叫什么啊    \n     2014-06-05 18:40 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @j2ck3r hackbar    \n     2014-06-05 18:49 |    \t\tj2ck3r \t\t\t( 普通白帽子  |\t\t\t        Rank:406 漏洞数:92        | 别关注我，跟你不熟。)\t\t \n  @′  雨。 谢谢拉     \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}