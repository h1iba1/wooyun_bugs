{"id": 26270, "wybug_id": "wooyun-2015-0122047", "wybug_title": "一个被用来抓取访客QQ的XSS（一）", "wybug_corp": "腾讯", "wybug_author": "路人甲", "wybug_date": "2015-06-22 00:20", "wybug_open_date": "2015-06-23 10:46", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： sevael nellaf will appear. 详细说明：  XSS代码来自于正在被使用的案例，一个被骚扰的朋友发给我的什么贷相关的网站。放了几天，到提交漏洞时，发现这个网站并没有使用该代码了，不知道是腾讯做了一些修复还是怎样～分析XSS如下：1. 先是用了一处QQ接口缺陷。http://read.html5.qq.com/image?imageUrl=某短链接网址2. 短连接网址跳转至一张图片。http://42.120.11.238:8888/x/ （现在已经不是原来的内容了）该短连接的返回头中加入了 Set-Cookie: uin=XSS 这个头。\n\n3. 问题来了， http://read.html5.qq.com/image?imageUrl= 在读取远程图片时，会将原请求的返回头也输出。4. 这意味着，通过这个点，可以在qq.com域下设置任意COOKIES了。5. 接着，攻击者 利用了腾讯另外一次 基于cookie的DOM XSS来利用了上面这个漏洞。链接如下：http://comment5.qq.com/comment_user2.htm?uin=1&uid=11090&ref=&furl=6. 当 在qq.com域下设置 uin这个cookie=\"><img src=1 OnerrOr=alert(1)> 后，再打开http://comment5.qq.com/comment_user2.htm?uin=1&uid=11090&ref=&furl=就会触发DOM XSS。7. 其中OnerrOr里的O要大写哦！ 这是因为腾讯的奇葩过滤方式所致～，看看相关的代码！\n\n8. 弹窗～\n\n   漏洞证明：  。   修复方案：  对从cookies中取出的数据进行过滤处理，再进入DOM。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-06-23 10:46 厂商回复： 非常感谢您的报告，经评估该问题并不存在，故此忽略。如果您有任何的疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-23 11:03 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:544 漏洞数:107        | 低调求发展)\t\t \n  非常感谢您的报告，经评估该问题并不存在，故此忽略。如果您有任何的疑问，欢迎反馈，我们会有专人跟进处理。    \n     2015-06-23 12:33 |    \t\t昌维 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | QQ：867597730，百度贴吧ID：昌维001)\t\t \n  腾讯偷偷修复漏洞之后说“非常感谢您的报告，经评估该问题并不存在，故此忽略。”这句话？    \n     2015-06-23 12:39 |    \t\t绽放的菊花 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 绽放中的菊花)\t\t \n  的确有很多抓去qq访客的东西，百度就能搜索到很多某些学校网站就是，你进去后，不久就会加上你QQ    \n     2015-06-28 23:02 |    \t\t落叶 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | xxxx)\t\t \n  你是谁?    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}