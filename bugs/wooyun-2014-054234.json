{"id": 57471, "wybug_id": "wooyun-2014-054234", "wybug_title": "Yungoucms Sql Injection 第一枚", "wybug_corp": "yungoucms.com", "wybug_author": "′雨。", "wybug_date": "2014-03-21 18:18", "wybug_open_date": "2014-06-16 18:19", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-28：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-16：\t细节向公众公开  简要描述： 过滤不严。 详细说明：  在system/modules/vote/vote.action.php中\npublic function checked_option(){\t\t //var_dump($_POST);\t\t $mysql_model=System::load_sys_class('model');\t\t $title=\"投票\";\t \t     $curtime=time();\t\t $option_id=$_POST['radio']; \t\t $vote_id=$_POST['vote_id'];\t\t $clientip=self::getIP(); //获取客户端地址\t\t $sqlallowguest='';\t\t $sqlinterval=0;\t\t \t\t//查询投票项的规则和规定时间\t\t $vote_subjects=$mysql_model->GetOne(\"select * from `@#_vote_subject` where `vote_id`='$vote_id'\");          \t\t $sqlallowguest=$vote_subjects['vote_allowguest'];//1允许游客投票 0不允许游客投票\t\t $sqlinterval=$vote_subjects['vote_interval'];  //N天后可再次投票，0 表示此IP地址只能投一次 \t\t if(1==$sqlallowguest){//判断是否允许游客投票\t\t \t\t      \t\t \t\t\t  $vote_activer=$mysql_model->GetOne(\"select * from `@#_vote_activer` where `vote_id`='$vote_id' and `ip`='$clientip' order by subtime desc\"); \t\t\t   \t\t\t  \t\t\t if(!empty($vote_activer)){//判断该ip用户已经投过票\t\t\t    \t\t\t\t //上次投票间隔天数\t\t\t       $datenum=($curtime-$vote_activer['subtime'])/(60*60*24);\t\t\t\t  \t\t\t\t\t\t\t    if($sqlinterval==0 || $datenum<=$sqlinterval){ //0 表示此IP地址只能投一次\t\t\t\t   _message(\"您已参加此次投票活动\",null,3);\t\t\t\t}else{\t\t\t\t\t\t\t\t\t\t //查出新增加的票数\t\t \t\t\t\t\t$vote_option=$mysql_model->GetList(\"select * from `@#_vote_option` where  `option_id`='$option_id' \");\t\t\t\t\t\t  \t\t\t\t\t  $option_number=$vote_option[0]['option_number']+1;\t\t\t\t\t  \t\t\t\t\t $mysql_model->Query(\"UPDATE `@#_vote_option` SET option_number='$option_number' where `vote_id`='$vote_id' and `option_id`='$option_id' \");\n$clientip=self::getIP(); \nfunction getIP()\t{\t\tglobal $ip;\t\tif (getenv(\"HTTP_CLIENT_IP\"))\t\t$ip = getenv(\"HTTP_CLIENT_IP\");\t\telse if(getenv(\"HTTP_X_FORWARDED_FOR\"))\t\t$ip = getenv(\"HTTP_X_FORWARDED_FOR\");\t\telse if(getenv(\"REMOTE_ADDR\"))\t\t$ip = getenv(\"REMOTE_ADDR\");\t\telse $ip = \"Unknow\";\t\treturn $ip;\t}\nxff是可控的。。。  而且没过滤。。  直接注入了。   漏洞证明：  \n\n注入成功。   修复方案：  过滤呗。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-06-16 18:19 厂商回复：  最新状态： 2014-03-28：已确认  ", "replys": "漏洞评价：\n评论\n     2014-03-28 14:08 |    \t\t云购CMS(乌云厂商)\t\t \n  谢谢    \n     2014-03-28 14:15 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @云购CMS      同学  为什么要忽略？    \n     2014-03-28 14:20 |    \t\t云购CMS(乌云厂商)\t\t \n  @′  雨。 没有看到，今天才看到啊    \n     2014-03-28 14:22 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @云购CMS   。。  你忽略的你还不知道。。    \n     2014-03-28 14:24 |    \t\t云购CMS(乌云厂商)\t\t \n  @′  雨。 我真不知道怎么忽略的，但是这个漏洞你发布时我看见了的    \n     2014-03-28 14:26 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @云购CMS   嗯  也没事  早点去修复吧，    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}