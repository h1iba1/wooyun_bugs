{"id": 4116, "wybug_id": "wooyun-2014-055932", "wybug_title": "淘宝主站运维不当导致可以登录随机用户并且获取服务器敏感信息", "wybug_corp": "淘宝网", "wybug_author": "insight-labs", "wybug_date": "2014-04-08 15:36", "wybug_open_date": "2014-05-23 15:37", "wybug_type": "重要敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["内部源码泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-23：\t细节向公众公开  简要描述：  详细说明：  详情请见http://drops.wooyun.org/papers/1381针对Openssl heartbeat漏洞的exp已经流出，经过测试可以dump出任何使用openssl库进程的内存数据，每次64kb，位置随机，但是由于exp起来十分容易速度很快并且可以多线程，一会就获得了几千个用户的cookie，随机抽取了几个发现可以任意登录。\n\ncookie。\n\n经过大量测试，该漏洞不但能获取cookie等信息，还能获取web应用的源码，web服务器的配置，包括ssl 证书私钥和加密私钥的key。正在针对大量https服务器做测试，获取私钥只是时间问题，建议淘宝全站更换SSL证书   漏洞证明：  详情请见http://drops.wooyun.org/papers/1381针对Openssl heartbeat漏洞的exp已经流出，经过测试可以dump出任何使用openssl库进程的内存数据，每次64kb，位置随机，但是由于exp起来十分容易速度很快并且可以多线程，一会就获得了几千个用户的cookie，随机抽取了几个发现可以任意登录。\n\ncookie。\n\n经过大量测试，该漏洞不但能获取cookie等信息，还能获取web应用的源码，web服务器的配置，包括ssl 证书私钥和加密私钥的key。正在针对大量https服务器做测试，获取私钥只是时间问题，建议淘宝全站更换SSL证书   修复方案：  更新openssl到最新版或者降级到1.0.0，并且更换证书   版权声明：转载请注明来源 insight-labs@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-04-09 14:15 厂商回复： 感谢您对我们的支持与关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-08 15:37 |    \t\tadm1n \t\t\t( 普通白帽子  |\t\t\t        Rank:216 漏洞数:66        | 只是一个渣渣而已。。。)\t\t \n  前排卖瓜子    \n     2014-04-08 15:37 |    \t\tinsight-labs  \t\t\t( 普通白帽子  |\t\t\t        Rank:623 漏洞数:75        | Security guys)\t\t \n  更新下，不但能获得cookie，用户的明文用户名和密码也保存在内存中一段时间    \n     2014-04-08 15:38 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  qianpai    \n     2014-04-08 15:38 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  .........    \n     2014-04-08 15:39 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n     2014-04-08 15:39 |    \t\txy小雨 \t\t\t( 普通白帽子  |\t\t\t        Rank:171 漏洞数:50        | 成为海贼王的男人)\t\t \n  膜拜一下    \n     2014-04-08 15:39 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  拜膜。。。    \n     2014-04-08 15:41 |    \t\t心伤的胖子 \t\t\t( 普通白帽子  |\t\t\t        Rank:308 漏洞数:29        | 因为心伤，所以胖子。)\t\t \n  牛逼打发了，全是明文登录名和密码啊    \n     2014-04-08 15:42 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  泥马    \n     2014-04-08 15:44 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  拜膜先    \n     2014-04-08 15:45 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  我去！    \n     2014-04-08 15:45 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  十万否?  这样下去 阿里的500W好像不够呀  哈哈    \n     2014-04-08 15:46 |    \t\tHxai11 \t\t\t( 普通白帽子  |\t\t\t        Rank:1137 漏洞数:218        | 于是我们奋力向前游，逆流而上的小舟，不停...)\t\t \n  淘宝这是惹了谁啊，哈哈    \n     2014-04-08 15:47 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  厉害啊！    \n     2014-04-08 15:48 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  掉渣天    \n     2014-04-08 15:51 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  @Hxai11 没办法  5W诱惑太大    \n     2014-04-08 15:54 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  明文。。。。淘宝这是要上头条了。。腾讯速度报道起    \n     2014-04-08 15:56 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  我天。。。    \n     2014-04-08 15:56 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  沦了负载后面的一台服务，然后随机登陆了用户，顺手调戏了服务器？    \n     2014-04-08 16:01 |    \t\tgoderci \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:47        | http://www.yunday.org)\t\t \n  不敢用了    \n     2014-04-08 16:02 |    \t\tak47 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 扫射)\t\t \n  入侵容易，运维不易，且行且珍惜    \n     2014-04-08 16:10 |    \t\tkelon \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        )\t\t \n  难道是memcache类的服务器？    \n     2014-04-08 16:11 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  http://drops.wooyun.org/papers/1381   zhege ?    \n     2014-04-08 16:14 |    \t\t摸了你 \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:17        | 1shitMVqBjCKrnRvSoixMx6RKpG9J8pBM)\t\t \n  这个看着跟猪哥的漏洞标题一样样的，莫非真是同一原理？    \n     2014-04-08 16:15 |    \t\thqdvista \t\t\t( 普通白帽子  |\t\t\t        Rank:154 漏洞数:31        | N/A)\t\t \n  openSSL的问题    \n     2014-04-08 16:16 |    \t\thqdvista \t\t\t( 普通白帽子  |\t\t\t        Rank:154 漏洞数:31        | N/A)\t\t \n  struts后又一波刷rank风    \n     2014-04-08 16:22 |    \t\tMujj \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:4        | IDC商)\t\t \n  openSSL，唉，又要刷分了，我先去了    \n     2014-04-08 16:32 |    \t\tJannock  \t\t\t( 核心白帽子 |\t\t\t        Rank:2278 漏洞数:204        | 关注技术与网络安全（招人中，有兴趣请私信...)\t\t \n  @zzR 你们家的站点好像也是存在的！    \n     2014-04-08 16:39 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @Jannock 雅蠛蝶，求爆    \n     2014-04-08 16:44 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @Jannock 一哥私信exp    \n     2014-04-08 16:52 |    \t\tFocusstart \t\t\t( 普通白帽子  |\t\t\t        Rank:574 漏洞数:163        | 努力让某某某成为最幸福的女人！)\t\t \n  mark！    \n     2014-04-08 16:53 |    \t\t大亮 \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:65        | 慢慢挖洞)\t\t \n  标记一下    \n     2014-04-08 16:55 |    \t\tgoubuli \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:61        )\t\t \n  这个nb    \n     2014-04-08 16:55 |    \t\t我是壮丁  \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 专业打酱油)\t\t \n  围观围观    \n     2014-04-08 17:00 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  这个是什么问题%    \n     2014-04-08 17:24 |    \t\tD_in \t\t\t( 普通白帽子  |\t\t\t        Rank:413 漏洞数:62        | 到我嘴里来)\t\t \n  是openssl的么    \n     2014-04-08 17:27 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  @D_in 应该是    \n     2014-04-08 17:35 |    \t\twangbing86 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 慢慢学习路)\t\t \n  同一洞洞，不同人插！目测集体躺枪    \n     2014-04-08 17:44 |    \t\t好人 \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:6        | 多少人曾爱慕你年轻的容颜)\t\t \n  占个坐    \n     2014-04-08 17:48 |    \t\tB1acken \t\t\t( 普通白帽子  |\t\t\t        Rank:174 漏洞数:56        | 渣渣)\t\t \n  求EXP    \n     2014-04-08 18:02 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  我赌2rank    \n     2014-04-08 19:52 |    \t\tMr .LZH \t\t\t( 普通白帽子  |\t\t\t        Rank:583 漏洞数:75        | 非妹子勿扰···)\t\t \n  狂刷openSSL的节奏啊    \n     2014-04-09 01:34 |    \t\t小火苗 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 我是一只小火苗呀，春风吹又生呀...)\t\t \n  感谢您对我们的关注，此问题我们已经发现并已修复，    \n     2014-04-09 08:50 |    \t\tQQ852451559 \t\t\t( 实习白帽子  |\t\t\t        Rank:79 漏洞数:18        | 学生党)\t\t \n  火后留名    \n     2014-04-09 09:23 |    \t\t网维 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 为您提供优质服务！)\t\t \n  明文太强悍了吧    \n     2014-04-09 13:37 |    \t\t钱富贵 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 掘金黑客 别人肉我)\t\t \n  国外东西国内发，而且纯属标题党    \n     2014-04-09 14:09 |    \t\tAnnabelle \t\t\t( 实习白帽子  |\t\t\t        Rank:46 漏洞数:15        | .)\t\t \n  谨慎围观~    \n     2014-04-23 17:47 |    \t\tinsight-labs  \t\t\t( 普通白帽子  |\t\t\t        Rank:623 漏洞数:75        | Security guys)\t\t \n  你们这些花wb提前看的有没有觉得很坑爹？    \n     2014-04-23 18:04 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @insight-labs 得了好处卖乖    \n     2014-05-24 10:18 |    \t\t橘子 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | 呢个...羞射高中生一枚。带上大神@Haswell...)\t\t \n  求exp OAO    \n     2014-05-27 12:39 |    \t\t银冥币 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:21        | \"/upload/avatar/avatar_251_b.jpg\" />)\t\t \n  @橘子 社区不是发过了吗    \n     2014-05-29 17:30 |    \t\t橘子 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | 呢个...羞射高中生一枚。带上大神@Haswell...)\t\t \n  @银冥币 木有找到OAO    \n     2014-05-29 17:38 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  @橘子 OpenSSL 在 Freebuf有文章和利用POC    \n     2014-05-29 21:37 |    \t\t橘子 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | 呢个...羞射高中生一枚。带上大神@Haswell...)\t\t \n  @MeirLin 哦哦看到了！谢谢的说~~~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}