{"id": 59719, "wybug_id": "wooyun-2013-046362", "wybug_title": "中国知网分站sql注射漏洞", "wybug_corp": "中国知网", "wybug_author": "rick", "wybug_date": "2013-12-18 16:11", "wybug_open_date": "2014-02-01 16:11", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-01：\t细节向公众公开  简要描述：  详细说明：  中国知网分站中国学术会议网，注册页面存在SQL注射漏洞http://conf.cnki.net/UserDo/UserRegister.aspx1.打开注册页面随便输入一个用户名后点击检测按钮，抓包&初步测试证明可以注入\n\n\n\n2.sqlmap跑下\n\n\n\n3.尝试列表和字段均成功，未做深入测试，目测分站非常多不知道影响多大   漏洞证明：  表| dbo.BKUSER                     || dbo.CNKI_AdminLogin            || dbo.CNKI_AdminPerday           || dbo.CNKI_AdminProductInfo      || dbo.CNKI_AdminProductLink      || dbo.CNKI_AdminSubSystemLink    || dbo.CNKI_AdminUserInfo         || dbo.CNKI_CFEDDownloadNum       || dbo.CNKI_CFEDDownloadNum_bak   || dbo.CNKI_CNKIDataAnalysis      || dbo.CNKI_CNKIDataAnalysis_bak  || dbo.CNKI_CalisUser             || dbo.CNKI_City                  || dbo.CNKI_FunctionRecord        || dbo.CNKI_IPAreaInfo            || dbo.CNKI_IPAreaName            || dbo.CNKI_IdenIDOtherInfo!      || dbo.CNKI_IndestryUserName      || dbo.CNKI_IndustryInfo          || dbo.CNKI_KBaseServer           || dbo.CNKI_LanMuType             || dbo.CNKI_LoacalSvrIP           || dbo.CNKI_LoadUser              || dbo.CNKI_LoginIPLimit          || dbo.CNKI_LoginIPLimit_20081119 || dbo.CNKI_illegalIPInfo         || dbo.CNKI_illegalIPInfo100119   || dbo.CNKI_illegalIPInfo_091130  || dbo.Cnki_Login_DataDictionary  |Database: CNKILoginDBTable: dbo.CNKI_AdminUserInfo[11 columns]+----------------+-------------+| Column         | Type        |+----------------+-------------+| DepartMent     | varchar     || Duty           | varchar     || IsProductLimit | smallint\\02 || IsSystemLimitA | \\11         || IsUpFeeLimit   | int         || Name           | varchar     || Password       | varchar     || RegTime        | datetime    || UserID         | int\\03      || UserName       | varchar     || UserRight      | varchar     |   修复方案：  检测用户名是否可用 参数化   版权声明：转载请注明来源 rick@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2013-12-23 08:39 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}