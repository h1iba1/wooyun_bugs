{"id": 49525, "wybug_id": "wooyun-2014-078322", "wybug_title": "魅族任意密码重置及后续分析", "wybug_corp": "魅族科技", "wybug_author": "专业种田", "wybug_date": "2014-10-04 19:16", "wybug_open_date": "2014-11-18 19:18", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-18：\t细节向公众公开  简要描述： RT 详细说明：  邮箱找回密码功能6位纯数字，30分钟内验证失败时没有次数限制。这种例子很常见,主要是后续再分析。根据信息得到:1.收到验证码邮件提示30分钟内有效。2.发送验证码时有1分钟限制1次。边等30分钟后验证是否会失效，边找其它绕过方法。测试发现变换account可以绕过1分钟限制。(邮箱没变所以不影响验证码的接收)POST /uc/system/vcode/sendEmailVcode HTTP/1.1email=test%40163.com&vCodeTypeValue=8&account=aeo445566deae\n\n\n\n以为可以通过该方法不断发送验证码，可以提高验证码的数量，后面发现验证码只以最后一次接收的有效。30分钟过后测试验证码已失效。就这样失败了，最多需要30分钟内跑999999次才能成功。\n\n最后注意到发送验证码的时候没有验证用户是否存在，可以给任意邮箱发邮件，当然只发验证码的邮件没有任何意义，仔细看邮件的抬头就是account，上面提到可以自定义的，那就用来发钓鱼邮件吧，在最后面加上 <!--  验证码内容邮箱会忽略，只看到自定义的内容，测试过163.com qq.com    漏洞证明：  \n\n\n\n   修复方案：  验证码及时失效邮件抬头不可自定义内容   版权声明：转载请注明来源 专业种田@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-10-06 21:47 厂商回复： 已在处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-04 19:34 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  ...    \n     2014-10-04 19:53 |    \t\tj14n \t\t\t( 普通白帽子  |\t\t\t        Rank:114 漏洞数:23        | 我是一只小小小小鸟....)\t\t \n  把黄章的重置了。    \n     2014-10-04 21:00 |    \t\tYouYaX(乌云厂商)\t\t \n  开源软件的弊端暴露无遗，商业软件发布前都会做安全测试。    \n     2014-10-04 21:18 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  @YouYaX 厂商不放假    \n     2014-10-04 23:22 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 承接:钻井，架工，木工，电工，水暖工，力...)\t\t \n  魅族号称技术不是很吊么....    \n     2014-10-05 00:10 |    \t\t庙口大王 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:6        | 呵呵)\t\t \n  就不能换张脸接着打么    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}