{"id": 88060, "wybug_id": "wooyun-2016-0206807", "wybug_title": "Amazon AWS Elastic Beanstalk Remote Command Execution                                      ", "wybug_corp": "亚马逊", "wybug_author": "从容", "wybug_date": "2016-05-09 22:49", "wybug_open_date": "2016-06-24 12:50", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-24：\t细节向公众公开  简要描述： Amazon AWS Elastic Beanstalk Remote Command Execution.RCE嘛，inbound rules也就形同虚设了。 详细说明：  https://aws.amazon.com/cn/elasticbeanstalk/\n\n亚马逊AWS Elastic Beanstalk可以让用户快速方便的搭建web环境，例如PHP环境，EBS将直接把常用的module部署上去，包括ImageMagick。也就是说只要选择好哪种语言的环境，直接自动化部署，不能自定义module，用户没的选择。直到现在亚马逊也没有给EBS用户推送CVE-2016-3714的补丁。这是刚刚搭建的环境：\n\n   漏洞证明：  一个Demo：\n<!doctype html><html lang=\"en\"><head>\t<meta charset=\"UTF-8\">\t<title>upload</title></head><body>\t<form action=\"\" method=\"post\" enctype=\"multipart/form-data\">\t\t <input type=\"file\" name=\"file\">\t\t <input type=\"submit\" value=\"submit\">\t</form></body><?php \t$filename = $_FILES['file']['name'];\t$type = substr($filename, strrpos($filename, '.')+1);\tif ($type === \"jpg\" || $type === \"png\" || $type === \"gif\") {\t\tmove_uploaded_file($_FILES['file']['tmp_name'], $filename);\t\t\t$imgObject = new Imagick($filename);\t}?></html>\nhttp://52.36.61.47/imagick.php\n\nhttp://52.36.61.47/wordpress/\ngougouxiameijj\n\n\n\n\n   修复方案：  EBS的模式是挺不错，但是要第一时间\"意识到\"自动部署的模块存在漏洞，并推送补丁，因为用户没的选择。EBS ImageMagick Update to 7.0.1   版权声明：转载请注明来源 从容@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2016-05-10 12:45 厂商回复： 已确认。目前Elastic Beanstalk服务提供给客户的默认PHP环境受此漏洞影响，我们将紧急推送补丁到客户的环境。 最新状态： 2016-05-10：Hello,Thank you for contacting Amazon. For future reference, you may pass these types of reports directly to us at 我爱乌云amazon.com.Thank you for sharing with us your concerns.Kind regards,  ", "replys": "漏洞评价：\n评价\n     2016-05-09 22:58 |    \t\tk0_pwn \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:17        | 专注且自由)\t\t \n  my biaoge ，can you speak Chinese，wo kan bu dong    \n     2016-05-09 23:08 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:415 漏洞数:99        | 哇啦啦啦啦啦 我的宝贝  |  Tr3jer@Gmail.c...)\t\t \n  @k0_pwn Rest assured,content is  Chinese language    \n     2016-05-10 00:03 |    \t\t小良不能说的秘密 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:15        | 一直等待与你再见一面)\t\t \n  ni men shuo de wo yi ge dou kan bu dong    \n     2016-05-10 00:10 |    \t\tAnkey. \t\t\t( 实习白帽子  |\t\t\t        Rank:67 漏洞数:23        | 小甜甜)\t\t \n  我知道你是谁，咋不给我发个5块钱红包呀 土豪。 然而我还没精通php……    \n     2016-05-10 13:42 |    \t\ttnt1200 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:18        | 关注飞机安全.... @从容 是我师傅)\t\t \n  biao ge six six six!    \n     2016-05-10 14:22 |    \t\t高小厨  \t\t\t( 普通白帽子  |\t\t\t        Rank:998 漏洞数:91        | 不会吹牛的小二不是好厨子！)\t\t \n  six six six ！    \n     2016-05-10 14:46 |    \t\t坏男孩-A_A \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:23        | 膜拜学习中)\t\t \n  reports directly to us at 我爱乌云amazon.com看傻了=。=    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}