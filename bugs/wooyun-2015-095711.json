{"id": 38687, "wybug_id": "wooyun-2015-095711", "wybug_title": "bilibili账户体系不严导致多处重要功能越权", "wybug_corp": "bilibili.com", "wybug_author": "9Gh0st", "wybug_date": "2015-02-05 12:06", "wybug_open_date": "2015-02-05 16:49", "wybug_type": "网络未授权访问", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-05：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 实测可以无需密码进入任意用户（需要是最近登录过的用户）的会员中心，查看收藏夹、历史观看记录、好友，可以看、发私信，删除视频弹幕，修改空间名称（应该还可以删视频，未测试） 详细说明：  www.bilibili.com首先登录B站，用火狐浏览器的firebug插件查看cookie，发现有一个名称为“DedeUserID”的cookie，对应的值即为B站会员的uid\n\n通过修改“DedeUserID”这个cookie的值，可以实现无需密码登录会员中心的效果，前提是目标会员在线或最近登录过我们去直播区选一个目标就以这个up主为例\n\n进入这个up主的空间，其空间地址后面的6位数字就是他的uid\n\n回到B站主页，把所有cookie删除，只留下DedeUserID这个cookie（这里非常重要，不然无法成功，甚至会导致无法再利用漏洞登录这个目标的账号），把它的值改为目标up主的uid，然后刷新\n\n神奇的事情发生了，我们发现在右上角竟然可以查看这个目标up主的动态、收藏和历史观看\n\n\n\n还不只这些，我们还可以进入该up主的会员中心\n\n\n\n除了刚才说的，发现还可以阅读私信、发私信、删除弹幕（应该可以发表和删除视频，为了不给人家添麻烦我没实验），查看悄悄关注的好友和黑名单，修改空间名称等能干的事比我想象中的多。。。要知道，我们现在几乎什么都没做，仅仅修改了一个cookie！不过账号和商城做了验证，进不去一直很喜欢B站，希望B站能修复这个漏洞，防止有人恶作剧（最后，我是新手，希望乌云能给我一个邀请码，感激不尽）   漏洞证明：  \n\n\n\n\n\n   修复方案：  调整cookie登录的机制   版权声明：转载请注明来源 9Gh0st@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-02-05 16:44 厂商回复： 对最近有登陆用户有影响 最新状态： 2015-02-05：已完成修复  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}