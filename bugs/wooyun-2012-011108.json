{"id": 17921, "wybug_id": "wooyun-2012-011108", "wybug_title": "深信服web认证使用穷举可以导致登陆被绕过", "wybug_corp": "深信服", "wybug_author": "路人甲", "wybug_date": "2012-08-20 13:50", "wybug_open_date": "2012-08-31 16:29", "wybug_type": "设计不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当导致攻击界面扩大", "设计不当", "认证绕过", "欺骗登陆"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-31：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 深信服的网络认证机制存在漏洞，对于已知用户但不知密码用户可通过穷举通过认证 详细说明：  \n\n\n\n1.在通过深信服上网机制时，对于已经知道用户名但不知密码状态下，随意输入密码，然后重复输入达15次以上后会自动通过认证，并且该用户本人也不掉线（即多用户同时在线，其深信服配置并未配置可多用户同时在线）。2.此认证必须为直接认证界面，如果通过跳转认证的界面无法通过认证   漏洞证明：     修复方案：  修改源代码   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-08-31 16:29 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n          这些评论似乎很乌云~~~思密达          2012-08-31 16:11 |\t\t\t\t\t深信服(乌云厂商)\t\t\t\t\t\t\t\n  感谢大家关注，深信服产品具有认证失败冻结功能，经过和漏洞反馈者所在单位的直接沟通，此漏洞应属于误报。主要原因是管理员未开启认证失败冻结功能（AC 4.0以后版本已经将此功能默认开启），并且这台AC使用了第三方认证（就是说用户帐号的合法性由第三方服务器验证），导致认证次数超过15次就会成为合法账号的原因估计跟这个第三方认证服务器有关（由于管理员出差，我们还没完成现场测试），目前在启用认证失败冻结功能后此问题已经得到解决。由于与客户服务器有关，我们会等管理员回来远程做现场排查，最终确认后再进行评价。    \n   \n \n     2012-08-20 14:15 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  牛B啊    \n     2012-08-20 17:29 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  超出理解能力的漏洞总是很多    \n     2012-08-20 17:31 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  等公开    \n     2012-08-20 18:31 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @xsser 看标题，很诡异。。。    \n     2012-08-20 18:56 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @gainover 要相信，可能就是第一印象那样    \n     2012-08-21 09:55 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  难道真是fuzzer下即可 没验证码?那样也不至于要20分撒 要个3分差不多了肯定有 \"引擎\"    \n     2012-08-21 09:56 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  既然是精华了 那肯定没那么简单..    \n     2012-08-21 19:47 |    \t\tupload \t\t\t( 普通白帽子  |\t\t\t        Rank:251 漏洞数:43        | 此处略--！)\t\t \n  爆破很科学    \n     2012-08-25 13:57 |    \t\tjames0672 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:4        | 我会灰的~~)\t\t \n  这不科学！    \n     2012-08-31 16:11 |    \t\t深信服(乌云厂商)\t\t \n  感谢大家关注，深信服产品具有认证失败冻结功能，经过和漏洞反馈者所在单位的直接沟通，此漏洞应属于误报。主要原因是管理员未开启认证失败冻结功能（AC 4.0以后版本已经将此功能默认开启），并且这台AC使用了第三方认证（就是说用户帐号的合法性由第三方服务器验证），导致认证次数超过15次就会成为合法账号的原因估计跟这个第三方认证服务器有关（由于管理员出差，我们还没完成现场测试），目前在启用认证失败冻结功能后此问题已经得到解决。由于与客户服务器有关，我们会等管理员回来远程做现场排查，最终确认后再进行评价。    \n     2012-08-31 16:22 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  @深信服 搞了半天是白帽的单位自己搞出乌龙了    \n     2012-08-31 16:46 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @popok 关键是这哥们也能发现啊    \n     2012-08-31 17:26 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  发现这问题的人思路该有多猥琐啊,总感觉好科幻    \n     2012-08-31 21:45 |    \t\tHRay \t\t\t( 普通白帽子  |\t\t\t        Rank:196 漏洞数:28        | 018)\t\t \n  重复输入一个密码15次以上，真的想知道是怎么产生的    \n     2012-08-31 22:10 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  @Xhm1n9 他是用工具跑着跑着就成功了，然后换了几个账号，突然发现15这个规律了吧    \n     2012-08-31 22:20 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  @popok 也许吧!    \n     2012-09-01 00:55 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  测试视频好蛋疼啊……    \n     2012-09-16 18:21 |    \t\tCHForce \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 路过不代表我冷漠，走路不代表没有马)\t\t \n  顶部的标题好猥琐哦    \n     2013-03-29 04:50 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  上面的标题，看起来真心蛋疼啊..    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}