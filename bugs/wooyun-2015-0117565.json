{"id": 16345, "wybug_id": "wooyun-2015-0117565", "wybug_title": "美乐乐重置任意用户密码(N种方法重置admin账户)", "wybug_corp": "美乐乐", "wybug_author": "千斤拨四两", "wybug_date": "2015-06-02 15:47", "wybug_open_date": "2015-07-17 15:48", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "安全意识不足", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-02：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 若忽略求补rank，多种重置方案，步骤详细。。。美乐乐是中国最大的家居电子商务平台。2011年，美乐乐率先在国内实现由线上“美乐乐家具网”与线下“美乐乐体验馆”为基础的“双平台O2O”经营模式，是国内领先的家居电商O2O平台。 详细说明：  0x1：注册一个测试用户绑定上手机号或者邮箱，这里绑定了手机号，走一遍正确的流程，记录下第一步返回的响应包！\n\n\nHTTP/1.1 200 OKServer: ngx_openresty/1.2.7.1Date: Mon, 01 Jun 2015 10:08:31 GMTContent-Type: application/json;charset=UTF-8Connection: keep-aliveX-Powered-By: Servlet/3.0; JBossAS-6x-server: 17Cache-Control: no-cacheContent-Length: 120{\"userName\":\"doubao\",\"uid\":2838307,\"isValidatePhone\":1,\"phone\":\"13xxxxxxxx2\",\"error\":0,\"msg\":\"ææ¾åå¯ç çéå¾\"}\n\n\n0x2：现在就可以用admin用户测试，原因继续向下看为什么要有0x1的原因！\n\nadmin并没有绑定密码找回方式，修改响应包如下就能通过手机或者邮箱找回密码，其实这种方法笨了，可以用测试的用户直接修改username，这也算是一种思路吧（可填入任意手机号，因为我们根本不需要验证码，在服务端根本就没有验证，直接修改响应包即可）。\n\n0x3:在验证码处任意填写数字修改响应包，把1改成0放行!\n\n\n\n0x4:修改密码为wooyun123.\n\n0x5：最后一步再次修改响应包把1改成0，就能重置成功！\n\n\n\n0x6：登陆验证!\n\n   漏洞证明：  上面已经说明一些重置方法，还可以在发送验证码是修改手机号，点击获取验证码是get方式请求，修改为任意的手机号。\n\n也可以在完全正确的步骤下在最后一步修改想要重置的密码用户名，之后修改响应包1为0，就可成功，意思已说明不在演示！   修复方案：  完善服务端的验证机制，若忽略求补rank，思路说明的很明白，过程也很详细，很不容易的！！！   版权声明：转载请注明来源 千斤拨四两@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：8 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2015-06-03 13:32 |    \t\tmeilele(乌云厂商)\t\t \n  已在进行处理    \n     2015-06-03 13:55 |    \t\t千斤拨四两 \t\t\t( 普通白帽子  |\t\t\t        Rank:510 漏洞数:88        | 是时候表演真正的技术了。。。)\t\t \n  @meilele 有没有小礼物啊，啊哈哈！！！    \n     2015-06-03 14:00 |    \t\tmeilele(乌云厂商)\t\t \n  可以帮你申请一下。    \n     2015-06-06 10:10 |    \t\t千斤拨四两 \t\t\t( 普通白帽子  |\t\t\t        Rank:510 漏洞数:88        | 是时候表演真正的技术了。。。)\t\t \n  @meilele 怎么还没有认领呢？  ——!    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 8, "Ranks": null}