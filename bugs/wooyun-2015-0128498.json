{"id": 26499, "wybug_id": "wooyun-2015-0128498", "wybug_title": "大连某211大学易卡通充值终端存在沙盒绕出及潜在风险", "wybug_corp": "大连海事大学", "wybug_author": "pw0", "wybug_date": "2015-07-22 22:23", "wybug_open_date": "2015-07-27 22:24", "wybug_type": "网络未授权访问", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["终端机漏洞", "沙盒绕出", "饭卡充值"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 涉及到用户隐私和钱的都不是小漏洞！（由于给饭卡充值，所以涉及到饭的不是小漏洞！）大连海事大学多出易卡通充值终端系统简陋，可用简单方法绕出沙盒，可直接获得管理员权限查看关键数据，有潜在安装恶意程序风险。 详细说明：  \n\n安静的教职工食堂，趁着周围的系的学生上课偷偷过来的。\n\n终端机可以看出可以充值ic卡，外置硬件齐全，但是一看这么简陋一界面和熟悉的鼠标就手痒了。\n\n随便打开界面\n\n长按出右键……真是出乎意料的古老的漏洞\n\n\n\n尝试了另存为和新建打印的经典方法，没用，倒是属性中的ip地址是个惊喜。找了台内网的机子试了一下，没有深入挖掘，目测控制终端的机器在食堂里面某个幽暗的小房间里，所以这个发现并没有什么卵用。\n\n出于好奇和对前辈的敬佩（据说海大的所有终端系统和办公系统都是学生diy的）查看了下源码，诶，这是什么弹出来了，win7的系统么。\n\n网络没有连接，果断修好连接，逛不了外网？果断看系统。\n\n各种系统文件毫不设防。在开始的位置和下面一栏有一个有机玻璃挡板，再加上虚拟鼠标偏上所以比较费劲，但是还是成功啦无奈手指细。\n\n打开了关键的终端系统文件及学生数据，某些程序貌似可以进行充值？（没有尝试）不多解释全在这里，居然还有一个校歌……这时候外面传来欢笑和脚步声，迅速收回手机关掉页面若无其事地装作在充值，然后看到没关严的一个提示框骂了一句又出问题了然后顶着扫地大妈奇异的目光大步流星地走出食堂。   漏洞证明：  终端机风险老生常谈，不从概念上再多说总结风险：1、一台终端机允许人绕出沙盒并任意进行操作（包括玩扫雷）本身就是一种巨大的漏洞，是需要警惕的。2、系统程序没有仔细查看，但显然如果有足够的时间爬出数据甚至安装恶意程序也不是没可能。（不要对我说时间等问题，一个忙碌的给学生充值的机器运行什么不正当程序都会造成损失）3、可以看出学校在基础设施的网络安全上需要跟进，其实问题不大毕竟没有连外网，但给饭卡充值的东西出了小漏洞也原谅我废话如此之多。   修复方案：  建议：1、更新系统和终端程序，这方面你们比我更专业，比如新华的自动售书机完全采用内嵌沙盒，很难攻破。起码不要一看就是html然后有明显的鼠标了。2、进行小手脚，比如在跳出沙盒的时候自动关机之类的，如果不想全面换系统应该比较划算的方法。望校方关注吃饭大事！漏洞虽小态度需大！   版权声明：转载请注明来源 pw0@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-07-27 22:24 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}