{"id": 20101, "wybug_id": "wooyun-2015-0115537", "wybug_title": "如家酒店某严重逻辑漏洞可登陆任意账号可导致几千万敏感信息泄露（涉及任意用户账号个人基本信息、入住记录等）", "wybug_corp": "如家酒店集团", "wybug_author": "Looke", "wybug_date": "2015-05-22 14:54", "wybug_open_date": "2015-07-08 00:30", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "大量信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-08：\t细节向公众公开  简要描述： 对，就是这个，华住酒店的也是我发的：http://www.wooyun.org/bugs/wooyun-2015-0115276书说上回：在华住酒店没有找到女神的X房记录，心情顿时高兴无比，但是就在刚刚看到了女神，她的膝盖是红肿的，于是我好像知道了什么，我又打开了电脑，输入女神的手机号，就从这儿再次开始这个宏伟的计划吧。 详细说明：  1、目标网址：http://www.homeinns.com/homeinn，自己先注册一个账号，后面要用；2、使用自己的账户进行找回密码，并使用fiddler截取返回的数据包；3、将自己收到的验证码输入进去，然后点下一步，此时将返回的数据包全都复制到空白文档中备用；4、重新进入找回密码的页面，输入你想登录账户的姓名和手机号，点击获取验证码（这步是必须的，稍后会讲为什么是必须的），然后随意输入一个六位数字，点击下一步，拦截返回的数据包，我们此时将第3步中截获的数据替换掉现在所拦截的数据，然后放行该数据包。5、此时可以跳到重置密码的页面，这里我们输入我们要更改的密码；6、点击下一步，重置密码成功。7、到这里就结束了么？显然没有，因为这次重置密码我们必须要知道用户的名字和手机号，但是搞华住的时候是不需要知道用户的名字的，但是如果我不输入用户名字或者输入错误的用户名字都会导致验证码发送无效，我们要怎么处理呢？8、还是到找回密码的第一步的界面，我们输入错误的名字，要改密码的手机号，输入验证码（图片验证码），然后拦截发送的数据包，此时点击获取手机验证码，将发送的数据包中的名字置为空，然后放行数据包，此时可以发现服务器那端给手机发验证码了（ps：一定要保证服务器给手机发送验证码了，否则后面的步骤即使成功了，密码也不会改成功的）；9、此时不要激动，（重点）点击图片验证码重新获取图片验证码，然后输入，然后随便输入一个六位数字，然后按照第3步继续。10、ok，我们可以只根据手机号码来获取任意账户的开房信息等敏感信息了，也可以写个脚本遍历一下所有手机号。   漏洞证明：  1、目标网址：http://www.homeinns.com/homeinn，自己先注册一个账号，后面要用；2、使用自己的账户进行找回密码，并使用fiddler截取返回的数据包；\n\n3、将自己收到的验证码输入进去，然后点下一步，此时将返回的数据包全都复制到空白文档中备用；4、重新进入找回密码的页面，输入你想登录账户的姓名和手机号，点击获取验证码（这步是必须的，稍后会讲为什么是必须的），然后随意输入一个六位数字，点击下一步，拦截返回的数据包，我们此时将第3步中截获的数据替换掉现在所拦截的数据，然后放行该数据包。\n\n5、此时可以跳到重置密码的页面，这里我们输入我们要更改的密码；\n\n6、点击下一步，重置密码成功。\n\n7、到这里就结束了么？显然没有，因为这次重置密码我们必须要知道用户的名字和手机号，但是搞华住的时候是不需要知道用户的名字的，但是如果我不输入用户名字或者输入错误的用户名字都会导致验证码发送无效，我们要怎么处理呢？\n\n8、还是到找回密码的第一步的界面，我们输入错误的名字，要改密码的手机号，输入验证码（图片验证码），然后拦截发送的数据包，此时点击获取手机验证码，将发送的数据包中的名字置为空，然后放行数据包，此时可以发现服务器那端给手机发验证码了（ps：一定要保证服务器给手机发送验证码了，否则后面的步骤即使成功了，密码也不会改成功的）；\n\n9、此时不要激动，（重点）点击图片验证码重新获取图片验证码，然后输入，然后随便输入一个六位数字，然后按照第3步继续。10、ok，我们可以只根据手机号码来获取任意账户的开房信息等敏感信息了，也可以写个脚本遍历一下所有手机号。\n\n\n\n\n\n   修复方案：  对重要参数加入验证码同步信息或时间戳；   版权声明：转载请注明来源 Looke@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-05-24 00:28 厂商回复： 十分感谢关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-22 14:55 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  昨天去如家的速速来报道。    \n     2015-05-22 15:06 |    \t\t高小厨 \t\t\t( 普通白帽子  |\t\t\t        Rank:814 漏洞数:74        | 不会吹牛的小二不是好厨子！)\t\t \n  华住，如家，下一个会是谁，酒店敲响信息安全警钟吧    \n     2015-05-22 15:07 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:544 漏洞数:107        | 低调求发展)\t\t \n  可怜的屌丝只能撸站。。。    \n     2015-05-22 15:07 |    \t\tLooke \t\t\t( 普通白帽子  |\t\t\t        Rank:619 漏洞数:93        | 可顺势而为，何必逆水行舟)\t\t \n  求打雷！！！！！    \n     2015-05-22 15:35 |    \t\tL1nkS \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 我要去收拾收拾桌子。)\t\t \n  路人来围观，CCTV可以看我么？    \n     2015-05-22 15:36 |    \t\tJGHOOluwa \t\t\t( 普通白帽子  |\t\t\t        Rank:206 漏洞数:32        | 就是来看看大牛们如何超神的^-^)\t\t \n  @疯狗狗哥，路过如家的算不算，吊丝只能看着壕带着妹纸进去啊~     \n     2015-05-22 15:38 |    \t\tTYPCN \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | TYPCN)\t\t \n  CCAV 看过来    \n     2015-05-22 15:47 |    \t\ttester.wang \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 菜鸟刚上路)\t\t \n  刘明，向大牛学习    \n     2015-05-22 15:54 |    \t\tNeeke \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:24        | 求传授刷Rank方法？)\t\t \n  我屮艸芔茻    \n     2015-05-22 16:00 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @疯狗 狗哥，昨天和谁一块进去了？    \n     2015-05-22 16:16 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  还来？    \n     2015-05-22 16:39 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  还好没去这种大酒店开过房    \n     2015-05-22 18:08 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  我叫方小顿，参加过天天向上，你查下有没我的    \n     2015-05-23 22:42 |    \t\t墨迹 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 为安全事业奋斗)\t\t \n  围观，没开过房    \n     2015-05-24 12:59 |    \t\tWulala \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:24        | ^..^ ^..^ ^↓^ ^..^ ^..^)\t\t \n  楼主堪比段子手啊    \n     2015-05-25 09:48 |    \t\t我能拒绝么 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 疯爆志林)\t\t \n  @Wulala 这段子真的是写的一套一套的    \n     2015-05-25 10:03 |    \t\tLooke \t\t\t( 普通白帽子  |\t\t\t        Rank:619 漏洞数:93        | 可顺势而为，何必逆水行舟)\t\t \n  @我能拒绝么 难道你不想知道下一个段子是怎么接的么？    \n     2015-06-15 09:02 |    \t\tNeeke \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:24        | 求传授刷Rank方法？)\t\t \n  还是看不了    \n     2015-06-15 23:50 |    \t\t小红猪 \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:30        | Wow~~~哈哈~~~)\t\t \n  还是看不了    \n     2015-07-08 09:33 |    \t\tsauren \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:10        | 天天打DOTA，快乐你我他~)\t\t \n  他那个名字和手机号验证应该是js 控制的吧，随便一下绕过就ok了～    \n     2015-07-08 11:20 |    \t\t月无痕 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:11        | 千里之行始于兴趣~)\t\t \n  从漏洞上看，貌似服务端有一定的验证，当短信服务器发送了验证码以后才可以被绕过吧..    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}