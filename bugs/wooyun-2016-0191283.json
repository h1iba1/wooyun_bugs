{"id": 88225, "wybug_id": "wooyun-2016-0191283", "wybug_title": "任意具有某服务权限的安卓应用都能轻松截获支付宝支付密码                                      ", "wybug_corp": "支付宝", "wybug_author": "小挺子爱装B", "wybug_date": "2016-04-01 09:40", "wybug_open_date": "2016-06-30 10:10", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["客户端程序设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-04：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-05-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-30：\t细节向公众公开  简要描述： 支付宝的安全键盘上没有做好对于某服务功能一定的防护，任意的具有该服务权限的安卓应用，并在设置中的无障碍开启的应用比如微信抢红包插件都有可能成为窃取支付宝支付密码的工具 详细说明：  支付宝的安全键盘上没有做好对于accessibility service一定的防护，任意的具有accessibility service权限，并在设置中的无障碍开启的应用比如微信抢红包插件都有可能成为窃取支付宝支付密码的工具安卓软件有一个功能叫做无障碍，本来是用于给一些残障人士使用的，比如talkback应用给一些视力不好的人士使用，在开启后，当手指触碰到某个view的时候，系统会把这个view的内容读出来给你。春节的时候，流行各种的微信抢红包插件就是利用了这个aceessibility service来实现获取屏幕上的信息以及自动抢红包。虽然这个功能是用户自己开启的，而且开启的时候，提醒用户可嫩会读取信用卡信息。但是作为一个涉及到财产安全的app，还是要对这个功能做一层防护的。在这方面，微信和掌上生活都做得很好，对于aceessibility service做了一定的防护。然而作为一个大厂，支付宝显然没有这方面的意识，所谓的安全键盘形同虚设\n\n\n\n\n\n   漏洞证明：  现在只是在logcat里面打印出来密码，完全可以做到收集到密码后上传到服务器。甚至是自己空\n\n视频地址：http://**.**.**.**/v_show/id_XMTUxOTA1NzM4OA==.html   修复方案：  可参考微信的防护措施，设立一个安全键盘，安全键盘的每一个键都设置一个自定义的accessibility delegate ,这样的话，支付密码就不会被任意有accessibility 权限的应用监听到\n\n\n\n   版权声明：转载请注明来源 小挺子爱装B@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2016-04-01 10:06 厂商回复： 感谢对支付宝安全的关注 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-01 10:09 |    \t\tMark0smith \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:71        )\t\t \n  Mark    \n     2016-04-01 10:10 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:259 漏洞数:96        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  Mark    \n     2016-04-01 10:28 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:905 漏洞数:165        | raw_input(\"你知道我要输入什么？\"))\t\t \n  火    \n     2016-04-01 11:48 |    \t\tTaro \t\t\t( 普通白帽子  |\t\t\t        Rank:349 漏洞数:89        | 走向最远的方向，哪怕前路迷茫；抱着最大的...)\t\t \n  Mark    \n     2016-04-01 12:14 |    \t\tGabriel \t\t\t( 普通白帽子  |\t\t\t        Rank:152 漏洞数:40        )\t\t \n  mark    \n     2016-04-01 14:03 |    \t\tWenR0 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | ...)\t\t \n  mark    \n     2016-04-01 15:03 |    \t\t无名 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:9        | 我是一只小菜鸟呀，伊雅伊尔哟。)\t\t \n  艹    \n     2016-04-01 15:04 |    \t\t逆戟鲸 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 学习中，请大大们多多指教)\t\t \n  混脸熟    \n     2016-04-01 15:28 |    \t\t追寻 \t\t\t( 普通白帽子  |\t\t\t        Rank:210 漏洞数:46        | 学习新姿势中)\t\t \n  66666666666    \n     2016-04-01 15:52 |    \t\t坏男孩-A_A \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:23        | 膜拜学习中)\t\t \n  ...    \n     2016-04-01 16:16 |    \t\tPraise \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | null    开心就要笑得如痴如醉~)\t\t \n  Mark    \n     2016-04-01 16:22 |    \t\tMartial \t\t\t( 普通白帽子  |\t\t\t        Rank:2639 漏洞数:370        | 竟然还有人冒充我，醉了，骗子QQ445697541...)\t\t \n  明文传输？    \n     2016-04-01 16:23 |    \t\t0xLucifer \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | NULL)\t\t \n  听着就像用Root权限做了个底层Hook。哦对了，在电脑上也叫外挂。    \n     2016-04-01 20:01 |    \t\tMark0smith \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:71        )\t\t \n  标题还改了，看来很重要啊    \n     2016-04-01 20:10 |    \t\t笙箫默 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 学安全，做安全。)\t\t \n  列害    \n     2016-04-01 21:12 |    \t\tHxy \t\t\t( 普通白帽子  |\t\t\t        Rank:309 漏洞数:79        | Jasmine)\t\t \n  mark    \n     2016-04-01 21:33 |    \t\tautO_pw \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:25        | o_O``)\t\t \n  围观    \n     2016-04-01 21:44 |    \t\t双腿间的颤抖 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 快,来不及了,快上车。)\t\t \n  要打雷了。    \n     2016-04-01 22:07 |    \t\tjye33 \t\t\t( 普通白帽子  |\t\t\t        Rank:1340 漏洞数:314        | 没有什么能够阻挡，我对静静的向往)\t\t \n  吓死我了    \n     2016-04-01 23:48 |    \t\tPost \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:12        | 本人所到之处，必定留下一坨凶残表情(#‵′...)\t\t \n  小子挺爱装B    \n     2016-04-07 00:21 |    \t\tRainism \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:4        | hacking for fun)\t\t \n  目测要火    \n     2016-04-09 06:01 |    \t\t少宇 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:19        | QQ ：1126179674  By : 少宇 http://www.90...)\t\t \n  小挺子爱装B  这id 好吊的样子    \n     2016-06-15 11:19 |    \t\t咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:23        )\t\t \n  6     \n     2016-06-30 10:11 |    \t\tMr_Java \t\t\t( 普通白帽子  |\t\t\t        Rank:170 漏洞数:43        | 高三党，当，档，裆！)\t\t \n  什么鬼。。。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}