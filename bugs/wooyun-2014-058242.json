{"id": 56310, "wybug_id": "wooyun-2014-058242", "wybug_title": "新版中国联通验证码可被简单识别（验证码识别实例及演示代码）", "wybug_corp": "中国联通", "wybug_author": "路人甲", "wybug_date": "2014-04-24 11:51", "wybug_open_date": "2014-06-08 11:51", "wybug_type": "内容安全", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["验证码"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-08：\t细节向公众公开  简要描述： 新版中国联通验证码可被简单识别 详细说明：  新版中国联通验证码可被简单的处理就能识别，识别率接近百分之百，和没有验证码有啥区别呢?这个可以调用用来短信轰炸机一类的恶意平台发送垃圾短信，同样对用户安全造成威胁。   漏洞证明：     新版中国联通验证码可被简单的处理就能识别，识别率接近百分之百，和没有验证码有啥区别呢?这个可以调用用来短信轰炸机一类的恶意平台发送垃圾短信，同样对用户安全造成威胁。地址：https://upay.10010.com/npfweb/NpfCellWeb/NpfverifyCode/getVerifyCode.action?timestamp=0.5371090464926236测试地址：http://www.fox163.com/UniconTest.aspx识别代码：\npublic String GetCheckString(Bitmap bitmap) {           UnCodebase ud = new UnCodebase(bitmap);           ud.GrayByPixels();           ud.ClearPicBorder(2);           ud.CutMap(14, 15, 0, 0);           bitmap = ud.bmpobj;         //  bitmap = ud.ClearNoise(128, 1);           String chkcode = \"\";           Bitmap[] arrmap = ud.SplitImg(bitmap, 4, 1);           foreach (Bitmap item in arrmap) {               String str = ud.GetCodebybitmap(item, 128);               Boolean isEques = false;               foreach (String strss in code) {                   String[] a = strss.Split(':');                   if (str == a[1]) {                       chkcode += a[0];                       isEques = true;                       break;                   }               }               if (!isEques) {                   String strCurrent = \"\";                   double max = 0.0;                   foreach (String strss in code) {                       int len1, len2, min, count = 0;                       String[] a = strss.Split(':');                       len1 = a[1].Length;                       len2 = str.Length;                       min = len1;                       if (min > len2) {                           min = len2;                       }                       for (int i = 0; i < min; i++) {                           if (str[i] == a[1][i]) {                               count++;                           }                       }                       double currrent = (count * 100.0 / min);                       if (max < currrent) {                           max = currrent;                           strCurrent = a[0].Trim();                       }                   }                   chkcode += strCurrent.Trim();               }           }           return chkcode;       }\n识别证明截图：\n\n\n\n   修复方案：  不要再想什么新花样换验证码了，老老实实用谷歌的，麻花的那类的吧。另外乌云可不可以给个邀请码？第二次提交了，   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2014-04-29 08:36 厂商回复： 暂不作为安全风险认定，属于其他应用技术范畴。已经转报给中国联通集团公司。rank 7 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}