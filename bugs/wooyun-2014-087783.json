{"id": 41744, "wybug_id": "wooyun-2014-087783", "wybug_title": "dtcms判断不严导致订单遍历(泄露电话地址等)", "wybug_corp": "dtcms.net", "wybug_author": "darker", "wybug_date": "2014-12-19 15:31", "wybug_open_date": "2015-04-02 10:23", "wybug_type": "非授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-24：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-02-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向公众公开  简要描述： dtcms判断不严导致订单遍历(泄露电话地址等) 详细说明：  既然dtcms要加入商城功能,这个问题得注意下吧。显示订单函数\nprotected override void InitPage()\t\t{\t\t\tthis.id = DTRequest.GetQueryInt(\"id\");\t\t\tDTcms.BLL.orders bll = new DTcms.BLL.orders();\t\t\tif (!bll.Exists(this.id))\t\t\t{\t\t\t\tHttpContext.Current.Response.Redirect(base.linkurl(\"error\", new object[]\t\t\t\t{\t\t\t\t\t\"error.aspx?msg=\" + Utils.UrlEncode(\"出错啦，您要浏览的页面不存在或已删除啦！\")\t\t\t\t}));\t\t\t}\t\t\telse\t\t\t{\t\t\t\tthis.model = bll.GetModel(this.id);\t\t\t\tthis.payModel = new DTcms.BLL.payment().GetModel(this.model.payment_id);\t\t\t\tif (this.payModel == null)\t\t\t\t{\t\t\t\t\tthis.payModel = new DTcms.Model.payment();\t\t\t\t}\t\t\t}\t\t}\nhttp://demo.dtcms.net/user/order/show-1.htmlhttp://demo.dtcms.net/user/order/show-2.htmlhttp://demo.dtcms.net/user/order/show-3.html......直接根据id查询数据。   漏洞证明：  \n\n\n\n   修复方案：  增加权限判断。   版权声明：转载请注明来源 darker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-04-02 10:23 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}