{"id": 82292, "wybug_id": "wooyun-2015-0151514", "wybug_title": "小皮网络某页面存在SQL注入漏洞", "wybug_corp": "xiaopi.com", "wybug_author": "路人甲", "wybug_date": "2015-11-03 15:13", "wybug_open_date": "2015-12-22 22:46", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-22：\t细节向公众公开  简要描述： 小皮网络某页面特殊字符未过滤，存在sql注入，有被暴库的可能 详细说明：  corp.xiaopi.com/api.php此请求中pagesize参数未做合法性校验，导致拼接sql语句的时候，混入了特殊字符，出现截断sql语句、注入恶意代码的可能。   漏洞证明：  1.正常情况下，使用这样的参数进行访问：http://corp.xiaopi.com/api.php?op=ajax_lists_joinus&page=0&catid=12&pagesize=10正常的返回内容：\n\n2.现在对pagesize加上注入代码：http://corp.xiaopi.com/api.php?op=ajax_lists_joinus&page=0&catid=12&pagesize=10%27%3B现在的返回内容如下，成功注入。\n\n3.进一步，通过特殊字符;，可以注入show tables、select * from xp_user等拖库语句，影响蛮大的。不过考虑到影响，这种高度危险的动作就没有试了。   修复方案：  最简单的方式是pagesize=intval(pagesize)进行整形过滤，确保不会有特殊字符混进来。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-11-07 22:44 厂商回复： 感谢对小皮游戏的关注，欢迎继续监督小皮游戏的进步 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-11-03 15:29 |    \t\t小皮游戏(乌云厂商)\t\t \n  多谢提供漏洞信息，目前已经处理完成    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}