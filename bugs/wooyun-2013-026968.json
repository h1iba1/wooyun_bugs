{"id": 9426, "wybug_id": "wooyun-2013-026968", "wybug_title": "shopex最新版前台一处想不到的SQL注入", "wybug_corp": "ShopEx", "wybug_author": "blue", "wybug_date": "2013-06-26 16:44", "wybug_open_date": "2013-09-24 16:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-08-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-24：\t细节向公众公开  简要描述： shopex代码核心的地方都做了加密处理，找漏洞就需要一点想象空间了，比如这个SQL注入... 详细说明：  存在于用户注册(想不到的位置吧？)1. \n/core/shop/controller/ctl.passport.php 267行if( !$info = $account->create($_POST,$message) ) {...\n2.看到1，想到有没有可能$account->create是foreach $_POST构造sql语句的呐？3.看数据表结构：\n\n果断提交时$_POST里加入member_id测试(其实测试时我还试了mobile等，嘿，只捡有用的字段说)，然后就有了下图：\n\n   漏洞证明：  \n\n   修复方案：  插入时去掉member_id，遍历拼接sql语句时还是多注意点吧～   版权声明：转载请注明来源 blue@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-06-26 19:16 厂商回复： 非常感谢您为shopex信息安全做的贡献我们将尽快修复非常感谢 最新状态： 2013-07-30：该问题已经处理 补丁包：485safe20130708.zip  ", "replys": "漏洞评价：\n评论\n     2013-06-26 16:51 |    \t\tBlackWidow7 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:28        | 屌丝~)\t\t \n  难道很猥琐的注入?    \n     2013-06-26 16:58 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  蓝哥一直很猥琐    \n     2013-06-26 17:30 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  前排关注！    \n     2013-06-26 17:51 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  blue出品，必定精品    \n     2013-06-26 19:09 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  貌似很给力的感觉    \n     2013-06-27 07:20 |    \t\t Jesus \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:18        | 天地不仁,以万物为刍狗！)\t\t \n  blue出品，必定精品    \n     2013-07-30 12:47 |    \t\tdyun \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:15        | [code][/code])\t\t \n  噗...blue打码还是漏了    \n     2013-08-06 09:06 |    \t\tcmdshell \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:9        )\t\t \n  漏了 哈哈    \n     2013-08-08 20:07 |    \t\t习惯一个人 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:6        | 动荡年代,我只图个安宁…)\t\t \n  明显测漏。。。42.121.84.118    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}