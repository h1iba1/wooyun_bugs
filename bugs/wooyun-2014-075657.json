{"id": 49026, "wybug_id": "wooyun-2014-075657", "wybug_title": "万户EzOffice又一处SQL注入漏洞", "wybug_corp": "万户", "wybug_author": "路人甲", "wybug_date": "2014-09-10 15:24", "wybug_open_date": "2014-12-09 15:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "17", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-09：\t细节向公众公开  简要描述： 又一处未过滤传入参数造成的注入！ 详细说明：  漏洞文件：defaultroot/iWebOfficeSign/Template/InfoTemplateEdit.jsp漏洞参数：RecordID漏洞成因：\nString mRecordID=request.getParameter(\"RecordID\");  String mFileType=request.getParameter(\"FileType\");  String mEditType=\"1\";  String mUserName=\"Administrator\";  //取得模式  if ( mEditType==null)  {    mEditType=\"2\";\t\t// 2 起草  }  //取得类型  if ( mFileType==null)  {    mFileType=\".doc\";\t// 默认为.doc文档  }  //取得用户名  if (mUserName==null)  {    mUserName=\"金格科技\";  }  //取得模板  if ( mRecordID==null)  {    mRecordID=\"\";\t// 默认没有模板  }  //打开数据库  DBstep.iDBManager2000 DbaObj=new DBstep.iDBManager2000();  if (DbaObj.OpenConnection())  {    String mSql=\"Select * From Template_File Where RecordID='\"+ mRecordID + \"'\";    try    {      result=DbaObj.ExecuteQuery(mSql);      if (result.next())      {        mRecordID=result.getString(\"RecordID\");        mFileName=result.getString(\"FileName\");        mFileType=result.getString(\"FileType\");        mDescript=result.getString(\"Descript\");      }\n很明显，没有过滤参数，直接带入了查询语句中。影响案例：百度搜索：inurl:7001 intitle:wanhu   漏洞证明：  以其中一个例子为例：\nsqlmap -u \"119.254.81.197:7001/defaultroot/iWebOfficeSign/Template/InfoTemplateEdit.jsp?RecordID=1\"\n\n\n\n\n   修复方案：  过滤上述参数。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-09-15 10:37 厂商回复： CNVD确认并复现所述情况，已经由CNVD按以往联系渠道邮件向软件生产厂商通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-10 15:42 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  我了个去。    \n     2014-09-10 20:41 |    \t\t安然意境 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:79        | 无论是你的事业还是你的个人，可能走的过程...)\t\t \n  又又又一处    \n     2014-12-09 17:51 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  洞主暴露了，嘿嘿    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}