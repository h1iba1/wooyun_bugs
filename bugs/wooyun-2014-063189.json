{"id": 1672, "wybug_id": "wooyun-2014-063189", "wybug_title": "phpdisk最新20140529版注入 无视防御", "wybug_corp": "phpdisk.com", "wybug_author": "索马里的海贼", "wybug_date": "2014-06-03 11:34", "wybug_open_date": "2014-09-01 11:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-01：\t细节向公众公开  简要描述： 我发的好像都是无视防御的。。这个也是，输入点的问题 绕过全局过滤 详细说明：  ajax.php行75\ncase 'uploadCloud':  $folder_id = (int)gpc('folder_id','P',0);  $folder_id = $folder_id ? $folder_id : -1;  $data = trim(gpc('data','P',''));  …………省略部分代码…………  if($data){    $file_key = random(8);    if(strpos($data,',')!==false){      $add_sql = $msg = '';      $arr = explode(',',$data);      for($i=0;$i<count($arr)-1;$i++){      \t$file = unserialize(base64_decode($arr[$i])); //base64_decode 无视防御      \t$file[file_id] = (int)$file[file_id];\t\t//file_id 检查了      \t$file[file_size] = (int)$file[file_size];\t//file_size检查了      $file[file_extension] = $db->escape(trim($file[file_extension])); //file_extension检查了      $file[file_name] = $db->escape(trim($file[file_name]));\t\t\t//file_name检查了      …………省略部分代码…………      //这里的$file[file_description]没过滤！      $add_sql .= \"({$file[file_id]},'{$file[file_name]}','$file_key','{$file[file_extension]}','application/octet-stream','{$file[file_description]}','{$file[file_size]}','$timestamp','$is_checked','$in_share','$report_status','$pd_uid','$folder_id','$onlineip'),\";      …………省略部分代码…………      //进查询了      $db->query_unbuffered(\"insert into {$tpf}files(yun_fid,file_name,file_key,file_extension,file_mime,file_description,file_size,file_time,is_checked,in_share,report_status,userid,folder_id,ip) values $add_sql ;\");\n   漏洞证明：  1、先注册一个账号 然后去“我的网盘”新建一个文件夹 记住这个folder_id\n\n2、生成payload\n\n3、提交请求folder_id=刚才记住的id&data=刚才生成的payload\n\n4、查看网盘中的文件就能看到注入结果了\n\n   修复方案：  别漏了   版权声明：转载请注明来源 索马里的海贼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-06-03 11:44 厂商回复： 感谢反馈 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-03 11:54 |    \t\t索马里的海贼 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:24        | http://tieba.baidu.com/f?kw=WOW)\t\t \n  这是小厂商？还是小漏洞？    \n     2014-09-01 12:26 |    \t\t好基友一辈子 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:37        )\t\t \n  这么神奇的思路    \n     2014-09-01 12:34 |    \t\t铁汉 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 向各种大神学习之)\t\t \n  好技巧啊    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}