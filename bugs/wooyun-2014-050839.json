{"id": 4261, "wybug_id": "wooyun-2014-050839", "wybug_title": "手把手教你获取wdCP主机管理系统的PHP源代码", "wybug_corp": "wdlinux", "wybug_author": "狂小子", "wybug_date": "2014-02-13 15:45", "wybug_open_date": "2014-05-15 11:26", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-17：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-04-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-15：\t细节向公众公开  简要描述： 获取源代码后可通过阅读源代码查找是否存在漏洞，万一找到漏洞危害性还是比较大的。 详细说明：  　　wdCP是WDlinux Control Panel的简称,是一套通过WEB控制和管理服务器的Linux服务器管理系统以及虚拟主机管理系统,旨在易于使用Linux系统做为我们的网站服务器系统,以及平时对Linux服务器的常用管理操作,均可在wdCP的后台里操作完成。　　wdCP是使用PHP语言开发并对PHP文件进行加密，需要php_wdcpm.so扩展解析。　　其实这次的方法很简单，此方法对一些类似的PHP文件加密也有效，下面来看操作(以index.php文件为例)。1、查看服务器上的/www/wdlinux/wdcp/index.php文件内容，确实是加密的\n\n2、浏览器访问下wdCP控制面板并查看浏览器中的html源码，这一切都正常。\n\n\n\n3、编辑服务器上的/www/wdlinux/wdphp/lib/php.ini文件，这个文件正是wdCP运行PHP环境所使用的配置文件，关闭short_open_tag配置项\n\n改成\n\n4、重启服务，命令： /www/wdlinux/tools/httpd_restart.sh5、再回浏览器访问下wdCP控制面板并查看浏览器中的html源码，出现白页，html源码中漏出了php源码。\n\n\n\n   漏洞证明：  \n\n   修复方案：  在写PHP代码时，不要使用php的短标签，即 <? 改为 <?php 后再对文件加密   版权声明：转载请注明来源 狂小子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-02-14 11:26 厂商回复： 很严重 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-02-13 16:03 |    \t\thacker@sina.cn \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:27        | ANONYMOUS)\t\t \n  mark    \n     2014-02-14 11:38 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  这个必须mark    \n     2014-02-14 14:14 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  坐等公开    \n     2014-02-17 16:29 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  低调求一份    \n     2014-05-29 21:02 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  我擦！已看到详情    \n     2015-03-03 14:37 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  够猥琐的－－    \n     2015-06-02 15:57 |    \t\tmalayke \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:4        )\t\t \n  看看是什么    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}