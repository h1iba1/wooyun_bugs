{"id": 78736, "wybug_id": "wooyun-2015-0159785", "wybug_title": "房房通在线经纪人工作平台多个漏洞打包", "wybug_corp": "武汉泰悦互动科技有限公司", "wybug_author": "soFree", "wybug_date": "2015-12-10 16:48", "wybug_open_date": "2016-01-23 15:16", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["越权操作", "未授权访问", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-10：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-01-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 房房通在线经纪人工作平台多处越权缺陷 详细说明：  《平行越权》：1.修改密码：http://www.fft365.com/User/UpdateUserPwd.aspx?saveType=1&ismypwd= 首先修改密码设计缺陷，未验证新密码，直接提交新密码即可，因为存在越权，能造成极大危害，可任意修改他人登录密码通过遍历txtUserID（纯数字），可任意修改他人的登录密码\n\n2.修改个人信息：http://www.fft365.com/User/SaveUser.aspx?action=edit&self=self&editType=1通过遍历txtUserID（纯数字），可任意修改他人的个人信息\n\n《垂直越权》：3.公司资料修改：http://www.fft365.com/Department/UpdateDeptCompanyName.aspx普通员工可垂直越权，访问只能经理才能访问的公司资料修改模块，并能正常进行后续操作\n\n4.IP访问限制：http://www.fft365.com/Department/PermitIPList.aspx普通员工可垂直越权，访问只能经理才能访问的IP访问限制模块，并能正常进行后续操作\n\n5.时间访问限制：http://www.fft365.com/Department/LoginTime.aspx普通员工可垂直越权，访问只能经理才能访问的时间访问限制模块，并能正常进行后续操作\n\n6.批量转移房源：http://www.fft365.com/Aid/BatchTransfer.aspx普通员工可垂直越权，访问只能经理才能访问的批量转移房源模块，并能正常进行后续操作\n\n后面的也一样，危害也比较大，不再一一截图7.新建部门模块：http://www.fft365.com/Department/DeptAdd.aspx...8.组织管理模块：http://www.fft365.com/Department/DeptList.aspx...9.新增员工模块：http://www.fft365.com/User/AddUser.aspx...10.员工资料管理模块：http://www.fft365.com/User/UserList.aspx...11.员工权限管理模块：http://www.fft365.com/User/UserPurviewFullList.aspx.........   漏洞证明：  房房通在线经纪人工作平台某处设计缺陷，可任意重置密码首先，找回密码处有两处设计缺陷：http://www.fft365.com/apply/getpass.ashx?txtMail=xssss@163.com&txtUser=xss124&num=Wed%20Dec%2009%202015%2013:02:46%20GMT+0800%20(%E4%B8%AD%E5%9B%BD%E6%A0%87%E5%87%86%E6%97%B6%E9%97%B4)1.找回密码，需要提交账号和绑定的邮箱，结果代码居然没有校验账号和绑定的邮箱的对应关系，任意填一个邮箱，结果重置密码邮件就发到哪个邮箱了，奇葩同一个账号提交两个不同邮箱：\n\n\n\n2.找回密码设计缺陷，提交找回密码后，所有账号重置的密码都为：abc123。低级的逻辑\n\n另外：注册：http://www.fft365.com/Apply/AddErpSimpleVersion.aspx?isfistr=0&ftype=1&saveType=1遍历txtDomain，可批量注册，建议增加图片验证码sql注入在登录请求： http://www.fft365.com/DealLogin.aspx?hz=&action=login&str_username=范晓凤&str_userpwd=aaa111&reb=false注入点：str_username呃！post方式使用有误吧，而且明文传输账号和密码，开发哥哥！post的话：账号和密码应该放在 HTTP 消息主体中发送的，好吗？而不是放在请求的 URL 中注入payload:abc123' or '1'='1abc124' or '1'='1abc125' or '1'='1范晓凤' or '1'='1均能成功登录登录账号：abc123\n\n\n\n登录账号：abc124:\n\n\n\n大量敏感信息，房源，客源，要是卖给其他房产公司，这个收益...呃...：出售房源：\n\n出租房源：\n\n求购客源：\n\n求租客源：\n\n身份证手机号姓名等敏感信息：\n\n获取大量存在的账号：\n\n属于盲注，最后顺便用sqlmap证明一下，191个表啊，我没脱裤，没干别的，不要查我水表，just prove it：\n\n列：\n\n另外：登录请求，密码无错误频次限制无图片验证码，可爆破和撞库，建议修改哟\n\n   修复方案：  优化权限控制机制   版权声明：转载请注明来源 soFree@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}