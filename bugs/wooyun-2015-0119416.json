{"id": 13034, "wybug_id": "wooyun-2015-0119416", "wybug_title": "海南航空某站点一次安全测试(可Shell内网)", "wybug_corp": "海南航空", "wybug_author": "路人甲", "wybug_date": "2015-06-10 11:35", "wybug_open_date": "2015-07-26 10:32", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口未加权限认证", "用户敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向公众公开  简要描述： 海南航空某站点由于某接口未授权配置不当可以获取系统权限。 详细说明：  海南航空某站点由于某接口未授权配置不当可以获取系统权限。   漏洞证明：  1.海航集团采购管理平台http://srm.hnair.com:8001/\n\n2.发现对外开放了8082端口，访问发现时jboss的建站服务中间件，在wooyun上发现有人提交过关于jboss的漏洞了（ WooYun: 海南航空后台配置不当导致可Getshell(二) ），测试发现对jmx控制台以及web-console进行了修复，但是并没有对inovker接口进行加固，导致可以通过这个敏感接口Getshell。\n\nJMX控制台加固了，添加了认证访问：\n\nWeb-console也进行了加固：\n\n还存在部分服务器信息泄漏的如下：\n\n由于inovker接口未配置认证信息，可以直接执行系统命令：\n\nGetshell：\n\n访问地址：http://srm.hnair.com:8082/aqcs/index.jsp\n\n部署ok，上传部署一个菜刀马：\n\n菜刀连接：\n\n接口地址以及id信息：\n\n相关帐号信息：\n\n端口相关信息：\n\n站点erp目录：\n\n附两个小马，便于工作人员验证：菜刀马：http://srm.hnair.com:8082/aqcs/test00.jsp    密码：Atest@123_ok小马：http://srm.hnair.com:8082/aqcs/test01.jsp测试就到这，这个上面部署了ERP登录系统，没深入，问题确实存在，尽快修复吧，给维护工作人员带来的不便，敬请谅解。   修复方案：  加固inovker接口，配置认证授权访问。To大海航：大晚上的我还在测试，能给送个礼物么（比如咱们海航的vip），谢谢。（不便就当我没说-_-）   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-06-11 10:31 厂商回复： 谢谢，我们会立即组织修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-10 11:42 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  接口,难道是中间件jboss,机场那个？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}