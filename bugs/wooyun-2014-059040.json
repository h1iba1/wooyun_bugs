{"id": 56067, "wybug_id": "wooyun-2014-059040", "wybug_title": "浙江省质量监督局某系统任意文件上传", "wybug_corp": "浙江省质量监督局", "wybug_author": "鸟云厂商", "wybug_date": "2014-05-07 19:26", "wybug_open_date": "2014-06-21 19:27", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-21：\t细节向公众公开  简要描述： 浙江省质量监督局某系统任意文件上传 详细说明：  #1发现漏洞\nhttp://jlxzxk.zjbts.gov.cn:93/UserManage/UserApply.aspx\n此处任意上传文件。\n\n#2上传文件传好了提交自动跳转到浙江省计量管理信息系统\nhttp://jlxzxk.zjbts.gov.cn:93/Login.aspx\n用刚刚注册的账号s55555555以及默认密码000000登陆\n\n企业信息管理的页面直接显示asp文件路径。#3菜刀连接菜刀连接之\nhttp://jlxzxk.zjbts.gov.cn:93/UploadFiles/s55555555/20140430204221662.asp\n密码wooyun-test\n\n#4数据泄露重要系统源代码、数据库配置泄露。实验室资质管理系统web.config\n</session-factory>\t</hibernate-configuration>\t<connectionStrings>\t\t<add name=\"conDatabase\" connectionString=\"Data Source=localhost;Initial Catalog=InsepctInfo;User ID=sa;Password=1*****c\" providerName=\"System.Data.SqlClient\" />\t</connectionStrings>\t<appSettings>\t\t<add key=\"DocToSwf.Service1\" value=\"http://192.168.13.107:8000/Service1.asmx\" />\t\t<!--<add key=\"DocToSwf.Service1\" value=\"http://1**.**.**.7/Service1.asmx\"/>-->\t\t<!--自动保存时间设置。value为1表示间隔一分钟，且必须为整数-->\t\t<add key=\"AutoSaveTime\" value=\"3\" />\t\t<add key=\"PreLinkName\" value=\"***\" />\t\t<add key=\"PreLinkTel\" value=\"0****51\" />\t\t<add key=\"CertSeal\" value=\"C:\\CertSeal.gif\" />\t\t<!--短信应用帐号-->    \t\t<add key=\"ApplicationID\" value=\"F*****g\"/>    \t\t<!--密码-->   \t\t<add key=\"Password\" value=\"8********2\"/>   \t\t<!--短信扩展号-->   \t\t<add key=\"ExtendCode\" value=\"****\"/>   \t\t<!--OpenMas二次开发接口的代理类-->  \t\t<add key=\"OpenMasUrl\" value=\"http://1.*.*.*/OpenMasService\"/>    \t\t<!--评审组长额外选择-->    \t\t<!--<add key=\"Other_330100\" value=\"826;828;830;832;833;834;835;836;837;838;841;843;844;845;847;848;850;853;855;856;860;863;868;872;877;885;886;880;894;907;906;888;889;904;920;921;922;905;902;912\"/>-->\t</appSettings>\n浙江省计量信息管理系统web.config\n<!--使用SQL进行查询的时候请注意该链接，yty，2013/04/25 -->  <connectionStrings>    <!--<add name=\"conDatabase\" connectionString=\"Data Source=1**.***.**.0;Initial Catalog=EnterpriseStandard;User ID=d*****op;Password=******\" providerName=\"System.Data.SqlClient\"/>-->    <add name=\"conDatabase\" connectionString=\"Data Source=localhost;Initial Catalog=MeasureMIS;User ID=sa;Password=1****c\" providerName=\"System.Data.SqlClient\"/>  </connectionStrings>    <system.web>\n还有浙江省质监电子监察系统、特种设备管理系统、组织机构代码管理系统、内部行政OA系统、质监局登录系统的源代码、数据库配置就不一一列了。5#成功连接数据库\n\n   漏洞证明：  上述   修复方案：     版权声明：转载请注明来源 鸟云厂商@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-05-10 00:29 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给浙江分中心处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}