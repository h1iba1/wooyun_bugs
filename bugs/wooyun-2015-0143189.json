{"id": 67442, "wybug_id": "wooyun-2015-0143189", "wybug_title": "盛心阳光咨询有限公司的门户Web网站存在若干漏洞", "wybug_corp": "eapchina.net", "wybug_author": "Budi", "wybug_date": "2015-09-27 15:13", "wybug_open_date": "2015-11-13 10:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-13：\t细节向公众公开  简要描述： 盛心阳光咨询有限公司的门户Web网站存在更新任意人的个人信息漏洞、后台弱口令、不安全Cookie问题。。。 详细说明：  1、了解一下这个公司，是一家中美合资的心理咨询公司，客户都是大公司：百度、联想、海尔、中石油。。。\n\n2、修改任意会员信息漏洞（1）在修改个人页，将自己的手机号修改为18000000000，其请求报文如下：\n\n为了方便验证，通过APP的个人信息接口，验证修改成功\n\n（2）漏洞分析与验证从请求报文可以看出，在更新个人信息时，提交了用户ID，那么如果修改该ID是否会修改他人的个人信息呢？   漏洞证明：  3、修改任意会员信息漏洞验证（1）下面把用户ID修改为319096，再次发送该请求，其报文如下：\n\n（2）再次使用APP的个人信息接口，验证是否修改成功，如下图所示，信息修改成功\n\n（3）为了验证不是偶发漏洞，再使用用户ID：000002，发送修改个人信息请求，其请求如下：\n\n（4）如下图所示，使用APP的个人信息接口，验证修改成功\n\n4、后台弱口令（1）后台界面如下：\n\n（2）使用用户名：eapchina密码：eapchina登陆，居然登陆成功了，可惜权限不足。。\n\n5、不安全的Cookie漏洞（1）从联想定制页面登陆http://www.eapchina.net/lenovo/\n\n登陆的请求和响应报文如下：\n\n从登陆后的报文可以看出，用户名和密码居然存在Coookie内，这是真让人不可思议….这种存在很大风险，如果网站存在XSS漏洞或者有意者在路由器截去流量，岂不直接获取了用户名和密码（2）从盛心阳光的会员登陆页登陆http://www.eapchina.net:90/member_toIndexNew.do\n\n登陆的请求和响应报文如下：\n\n从登陆后的报文可以看出，不仅用户名和密码放在在Coookie内，还有用户ID、公司ID、公司名称….   修复方案：  （1）将用户ID放入Session内，每次使用从Session获取（2）后台管理加强密码复杂度，避免弱口令（3）Cookie内不要保存任何敏感信息   版权声明：转载请注明来源 Budi@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-09-29 10:00 厂商回复： 感谢大牛的细心，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}