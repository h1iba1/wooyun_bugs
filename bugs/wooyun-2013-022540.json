{"id": 12319, "wybug_id": "wooyun-2013-022540", "wybug_title": "新浪某分站持久xss，配合csrf危害更大（五）", "wybug_corp": "新浪", "wybug_author": "px1624", "wybug_date": "2013-04-26 10:11", "wybug_open_date": "2013-06-10 10:12", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "新浪"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-10：\t细节向公众公开  简要描述： 位置在距离这个漏洞不远处，http://www.wooyun.org/bugs/wooyun-2010-022491，别人也可以通过uid的链接访问。也可以配合利用csrf进行xss的攻击。影响整个sina.com.cn域名下的所有产品。噢，也可以蠕虫额、、、 详细说明：  1 xss位置，新浪 李宁个人空间，现居城市 省市资料，市的那个位置。2 测试地址：\nhttp://lining.sina.com.cn/irun/uc/space.php?uid=1870758683\n3 漏洞原因，前端有限制，服务端啥都没过滤，也没有长度限制。4 证明过程：5 修改资料，现居城市，随便修改为xx省 xx市，抓包。（这里貌似是抓包工具编码出现问题，现显示成了乱码，无视之，没啥影响）图1\n\n6 修改xx省 xx市为下图测试代码，发送post数据包。图2\n\n7 刷新看下效果，成功alert(2)图3\n\n8 看下源码，看来xx省那里有做判断和过滤。xx市那个疏忽了，没有判断。图4\n\n9 修改xx市位置，为外部调用js文件的代码图5\n\n10 成功插入。图6\n\n11 换个浏览器，用小号去访问\nhttp://lining.sina.com.cn/irun/uc/space.php?uid=1870758683\n成功获取cookie。说明，那个插入的外部js文件成功被执行了。图7\n\n12 post数据没有token等验证，故可以蠕虫，蠕虫证明略去。13 配合csrf进行xss更大危害的利用，详情见 WooYun: 新浪某分站持久xss，配合csrf危害更大（四） 此处不做详细描述。   漏洞证明：  请见上面证明。   修复方案：  前端限制 = 没有限制   版权声明：转载请注明来源 px1624@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2013-04-26 17:03 厂商回复： 感谢关注新浪安全，已经通知开发人员进行处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-26 10:22 |    \t\tlucky \t\t\t( 普通白帽子  |\t\t\t        Rank:409 漏洞数:81        | 三人行必有我师焉########################...)\t\t \n  都进行连载呀！    \n     2013-04-26 10:39 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:41        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  都进行连载呀！    \n     2013-04-26 16:46 |    \t\tblue  \t\t\t( 普通白帽子  |\t\t\t        Rank:779 漏洞数:68        | 我心中有猛虎，细嗅蔷薇。)\t\t \n  ~_^    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}