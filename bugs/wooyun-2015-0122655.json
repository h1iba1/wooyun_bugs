{"id": 65450, "wybug_id": "wooyun-2015-0122655", "wybug_title": "三个爸爸空气净化器设备任意控制漏洞", "wybug_corp": "sangebaba.com", "wybug_author": "宋兵甲", "wybug_date": "2015-07-03 18:21", "wybug_open_date": "2015-10-01 18:32", "wybug_type": "非授权访问", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["未授权访问", "智能设备", "空气净化器"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向公众公开  简要描述： 可以通过枚举获取三个爸爸大部分设备序列号及设备信息，从而无需授权，也能控制设备。 详细说明：  三个爸爸净化器通过HTTP协议进行设备绑定和控制，通过API控制指令cleaner/check查询指定的设备是否已经入网，通过cleaner/simple指令将在线设备绑定到手机上。在查询设备和绑定手机的过程中，三个爸爸未对数据做任何校验。导致我们可以遍历三个爸爸的入网的大部分设备和绑定任意在线设备。绑定设备之后即可控制该设备。\n\n攻击示意图   漏洞证明：  \n\n设备列表图\n\n绑定用户设备   修复方案：  1、服务器限制一段时间内同一token的设备查询次数2、设备ID不要使用连续或者容易枚举的数字串3、使用加密的通信方式，而不是用简单的明文URL来提交参数4、对明显的异地绑定需要其他绑定人授权，或者至少要提醒下已经绑定的用户。   版权声明：转载请注明来源 宋兵甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-07-03 18:30 厂商回复： 感谢您的发现和建议，我们会持续完善智能设备的安全问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-25 12:56 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  洞主能完善下协议分析过程以及具体的api地址么    \n     2015-06-25 14:12 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  你家爸爸真多    \n     2015-06-25 19:31 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  @夕风号 买买买    \n     2015-06-26 08:50 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  为何有三个？亲生的，干爹，外加一个啥？    \n     2015-06-26 10:45 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  @wefgod 空气净化器    \n     2015-06-26 11:40 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @瘦蛟舞 不错    \n     2015-07-02 16:15 |    \t\t宋兵甲 \t\t\t( 普通白帽子  |\t\t\t        Rank:165 漏洞数:15        | Numen Team团队账号)\t\t \n  @xsser 亲，在哪里改，没找到入口    \n     2015-07-03 18:24 |    \t\tAnymous \t\t\t( 普通白帽子  |\t\t\t        Rank:124 漏洞数:28        )\t\t \n  爸爸都可以当净化器了？高科技！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}