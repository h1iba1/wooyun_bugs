{"id": 30692, "wybug_id": "wooyun-2015-0115974", "wybug_title": "博库网重置任意用户密码漏洞（管理员客服用户测试）", "wybug_corp": "bookuu.com", "wybug_author": "千斤拨四两", "wybug_date": "2015-07-03 17:41", "wybug_open_date": "2015-08-17 17:48", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-17：\t细节向公众公开  简要描述： 深夜挖洞很不容易啊，给高神rank吧！博库网是博库网络有限公司独立运营的目前国内领先、可供图书品种最多的文化知识平台，是浙江省新华书店集团有限公司投资人民币5000万元设立的全资子公司。[1] 博库网作为浙江省新华书店集团“十二五”发展规划项目之一，依靠新华书店集团公司强有力的资源背景(全行业领先、具有自主知识产权的ERP系统、14万平方米规模的现代物流中心，丰富的产品资源和信息资源、以及全集团信息一体化、库存一体化、市场一体化的连锁经营运作体系),博库网有信心迈好“走出去——大力发展博库文化品牌”的每一个步伐，努力成为世界一流、国内领先、具有出版物中盘特色的中文图书购书平台和博库文化品牌 详细说明：  0x1：只要知道用户的账户就可以重置用户的密码，于是在官网上找到了这个，就拿热线电话测试！\n\n\n95105940\n重置热线之前先走一下正确的流程，拿自己手机申请的用户抓取响应包！\n\n\n\n\nHTTP/1.1 200 OKServer: nginx/0.8.46Date: Sun, 24 May 2015 15:38:49 GMTContent-Type: text/html; charset=utf-8Connection: keep-aliveVary: Accept-EncodingX-Powered-By: PHP/5.3.6Expires: Thu, 19 Nov 1981 08:52:00 GMTCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0Pragma: no-cacheContent-Length: 31517<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\">    <head>        <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />        <title>æ¾åå¯ç -ååºç½</title>        <link href=\"http://style.bookuu.com/css/sys.css\" rel=\"stylesheet\" type=\"text/css\" />        <link href=\"http://style.bookuu.com/css/base.css\" rel=\"stylesheet\" type=\"text/css\" />        <link href=\"http://style.bookuu.com/index/css/layout.css\" rel=\"stylesheet\" type=\"text/css\" />        <link href=\"http://style.bookuu.com/index/css/login-reg.css\" rel=\"stylesheet\" type=\"text/css\" />        <link rel=\"stylesheet\" type=\"text/css\" href=\"http://style.bookuu.com/index_new/css/sub_head.css\" />        <link rel=\"stylesheet\" type=\"text/css\" href=\"http://style.bookuu.com/css/feedback.css\"><link rel=\"icon\" href=\"http://style.bookuu.com/favicon.ico\" type=\"image/x-icon\" /><script type=\"text/javascript\" src=\"http://style.bookuu.com/jquery/jquery-1.5.1.min.js\"></script><script type=\"text/javascript\" src=\"http://style.bookuu.com/jquery/jqueryTabs.js\"></script><script type=\"text/javascript\" src=\"http://style.bookuu.com/jquery/base.js\"></script>        <script type=\"text/javascript\">            $(document).ready(function(){       \t\t$('#submitid').bind('click',function(){       \t\t\tcheckform();           \t\t});            //éªè¯è¡¨å            function checkform(){                var name= $.trim($(\"#nicknameid\").val());                var checkcode = $('#seccode').val();                if(Len(name)<5||Len(name)>20){                \talert('è¯·è¾å¥æ­£ç¡®çç¨æ·åä¿¡æ¯ï¼');\t\t\t\t\treturn false;                 }else if(Len(checkcode)!=4){                    \talert('è¯·æ­£ç¡®çéªè¯ç ï¼');    \t\t\t\t\treturn false;                 }/*else{                \t$.get(\"getpassword.php\", {name:name, checkcode: checkcode,step:1 }, function(data){              \t\t \tif(data.flag==101||data.flag==102){\t\t\t\t\t\t\talert(data.msg);\t\t\t\t\t\t\treturn false;                  \t\t \t}else{\t\t\t\t\t\t\talert('è¯·ç»§ç»­æä½');\t\t\t\t\t\t\t//window.location.href='./getpassword.php?t='+Math.random();\t\t\t\t\t\t\t                      \t\t \t}              \t\t});                       }*/            }                       //å­ç¬¦ä¸²é¿åº¦            function Len(str){                var i,sum;                sum=0;                for(i=0;i<str.length;i++)                {                    if ((str.charCodeAt(i)>=0) && (str.charCodeAt(i)<=255))                        sum=sum+1;                    else                        sum=sum+2;                }                return sum;            }            })                    </script>        <style type=\"text/css\">            <!--            .default {color: #999999}            .login_form_wrong {                background: url(\"../images/bg_login_wrong.gif\") no-repeat scroll 3px 4px transparent;                color: #CC3300;                padding-left: 14px !important;                padding-right: 2px;                width: 167px !important;            }            -->            .serve-form{ display: none;}        </style>    </head>    <body>                     <div class=\"layout\">\t<div class=\"login-logo-pannel\">    \t<a href=\"http://www.bookuu.com\" class=\"bk-logo\"></a>        <a href=\"http://www.bookuu.com\" class=\"gotoboku\">åååºé¦é¡µ</a>    </div>        <div class=\"register-pannel\">    \t<div class=\"cbox\">    \t<div class=\"cbox-inner\">        \t<h1 class=\"underline\">æ¾åå¯ç </h1>          <div class=\"gpb\">            <p>æ¨çè´¦å·å·²ç»å®ææºï¼è¯·éæ©ææºç»å®æ¾åå¯ç ã</p>            <div class=\"options\">                           <a href=\"./getpwbymobile.php?act=update&step=1\"><img src=\"http://style.bookuu.com/index/images/m1_phone.png\">ææºç»å®æ¾åå¯ç </a>              \t                            <a href=\"http://help.bookuu.com/helper.php?typeDeal=79\"><img src=\"http://style.bookuu.com/index/images/m2_support.png\">èç³»å®¢ææ¾åå¯ç </a>            </div>          </div>      \t<b class=\"cbox-ctl\"></b>        <b class=\"cbox-ctr\"></b>        <b class=\"cbox-cbl\"></b>        <b class=\"cbox-cbr\"></b>    </div>    </div>    </div></div>\t        <div id=\"footer\" class=\"footer\">    <ul class=\"clearfix\">        <li>            <h3>æ°æå¥é¨</h3>            <ul>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=39\" target=\"_blank\">è´­ç©æµç¨</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=51\" target=\"_blank\">åç¥¨å¶åº¦</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=37\" target=\"_blank\">ç§¯åè¯´æ</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=68\" target=\"_blank\">äº¤ææ¡æ¬¾</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=458\" target=\"_blank\">è®¢åç¶æ</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=79\" target=\"_blank\">å¸¸è§é®é¢</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=4153\" target=\"_blank\">ICåå¼å¡è¯´æ</a></li>            </ul>        </li>        <li>            <h3>ééæ¹å¼</h3>            <ul>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=41\" target=\"_blank\">ééèå´ä¸è¿è´¹</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=42\" target=\"_blank\">ééæ¶é´</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=44\" target=\"_blank\">ä¸é¨èªå</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=43\" target=\"_blank\">ååéªè´§ä¸ç­¾æ¶</a></li>            </ul>        </li>        <li>            <h3>æ¯ä»æ¹å¼</h3>            <ul>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=46\" target=\"_blank\">è´§å°ä»æ¬¾</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=47\" target=\"_blank\">ç½ä¸æ¯ä»</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=48\" target=\"_blank\">é®å±æ±æ¬¾</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=49\" target=\"_blank\">é¶è¡æ±æ¬¾ä¸è½¬è´¦</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=50\" target=\"_blank\">ååºå¸</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=593\" target=\"_blank\">ååºå¸</a></li>            </ul>        </li>        <li>            <h3>å®åæå¡</h3>            <ul>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=53\" target=\"_blank\">éè´§è¯´æ</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=52\" target=\"_blank\">éæ¢è´§æµç¨</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=59\" target=\"_blank\">éæ¢è´§å°å</a></li>                <li><a href=\"http://help.bookuu.com/helper.php?typeDeal=60\" target=\"_blank\">éæ¬¾è¯´æ</a></li>            </ul>        </li>        <li>            <h3>äºè§£ååº</h3>            <ul>                <li><a href=\"http://help.bookuu.com/anentbookuu.php?typeDeal=94\" target=\"_blank\">å³äºååº</a></li>                <li><a href=\"http://help.bookuu.com/anentbookuu.php?typeDeal=98\" target=\"_blank\">å³äºæµæ±æ°å</a></li>                <li><a href=\"http://help.bookuu.com/anentbookuu.php?typeDeal=459\" target=\"_blank\">èç³»æä»¬</a></li>                <li><a href=\"http://help.bookuu.com/anentbookuu.php?typeDeal=4034\" target=\"_blank\">å¬å¸æè</a></li>                <li><a href=\"http://help.bookuu.com/anentbookuu.php?typeDeal=97\" target=\"_blank\">åä½ä¼ä¼´</a></li>                <li><a href=\"http://help.bookuu.com/anentbookuu.php?typeDeal=93\" target=\"_blank\">åæé¾æ¥</a></li>            </ul>        </li>        <li class=\"serphone\">            <h3>æå¡ç­çº¿</h3>            <div class=\"phone-footer-bg\">                <p>æå¡æ¶é´: 9:00 -- 21:00</p>                <p class=\"tel\">TEL: 95105940</p>            </div>        </li>    </ul>    <p class=\"binfo\">        <img src=\"http://style.bookuu.com/index_new/images/footer_banner.jpg\">    </p>    <div class=\"copyright\">        <dl>            <dd class=\"polices_icon\"></dd>            <dd class=\"ll\"><a href=\"http://www.itrust.org.cn/yz/pjwx.asp?wm=1575312902\" target=\"_blank\" title=\"ç¹å»æ¥éªçµå­è¯ä¹¦\"><img src=\"http://style.bookuu.com/images/itrust47.jpg\" alt=\"ä¸­å½ä¿¡ç¨ä¼ä¸\"></a></dd>            <dd class=\"web_gs\"><script type=\"text/javascript\" src=\"http://zjnet.zjaic.gov.cn/sjqybswj/3300000000022054.js\"></script></dd>            <dd class=\"copy_txt\">Copyright 2005-<script type=\"text/javascript\">(function(){document.write(new Date().getFullYear())})()</script> <a href=\"http://www.bookuu.com\" target=\"_blank\" title=\"ååºç½\">bookuu.com</a> çæææ<br>å¢å¼çµä¿¡ä¸å¡ç»è¥è®¸å¯è¯:<a href=\"http://www.miibeian.gov.cn/\" target=\"_blank\" title=\"æµB2-20110278\" rel=\"nofollow\">æµB2-20110278</a></dd>            <dd class=\"ll\"><a href=\"https://ss.knet.cn/verifyseal.dll?sn=e14082133010052836nfbw000000&comefrom=trust&trustKey=dn&trustValue=www.bookuu.com\" target=\"_blank\"><img src=\"http://style.bookuu.com/images/kxwz.jpg\"></a></dd>            <dd class=\"ll\">                <a id='___szfw_logo___' href='https://search.szfw.org/cert/l/CX20131024003180003178' target='_blank'><img src='http://style.bookuu.com/images/cxwz.png'></a>                <script type='text/javascript'>(function(){document.getElementById('___szfw_logo___').oncontextmenu = function(){return false;}})();</script>            </dd>        </dl>    </div></div><!-- E åºé¨ --><div id=\"cat-menu\">    <div class=\"max-menu\"><a href=\"http://www.bookuu.com/sort/book.html\">å¾ä¹¦</a></div>    <ul class=\"cat-menu-bd\">            </ul>    <div class=\"max-menu\"><a href=\"http://www.bookuu.com/sort/music.html\">å½±é³</a> <a href=\"http://www.bookuu.com/sort/software.html\">è½¯ä»¶</a></div></div><script type=\"text/javascript\">    //å¸®å©ä¸­å¿        $(\".site-help\").hover(function(){        $(this).addClass(\"site-help-on\");        $(this).find(\".help-bd\").show();    },function(){        $(this).removeClass(\"site-help-on\");        $(this).find(\".help-bd\").hide();    });        //æç´¢æ¡    $('#key_S').focus(function(){        if($(this).val()==this.defaultValue){            $(this).css(\"color\",\"#000\");        }          }).blur(function(){        if($(this).val()==''){                            $(this).val(this.defaultValue);            $(this).css(\"color\",\"#999\");        }       });         //åç±»    var timer = 0;    $('.main-nav h2').hover(function(){        clearTimeout(timer);        $('#cat-menu').toposition(this, {x:0, y:35}).show();        $(this).addClass(\"on\");    });    $(\".cat-menu-bd li\").hover(function(){        $(this).addClass(\"hover\");                    var oChild = $(\".cat-mod\", this);        // è®¡ç® .cat-mod ç top        var iHeight      = 35 + 32 * ($(this).index() + 1),        iChildHeight = oChild.height(),        iMinHeight   = 50; // paddingTop + 30        if ((iChildHeight - iHeight) < iMinHeight) {            var iCatHeight = $('#cat-menu').height() - 35,             iTop       = iHeight - (iChildHeight - iMinHeight);            if ((iTop + iChildHeight) > iCatHeight) {                iTop = iCatHeight - iChildHeight;            }            oChild.css('top', iTop);        }        oChild.show();    },function(){        $(this).removeClass(\"hover\");        $(\".cat-mod\", this).hide();    });    $('.main-nav h2').mouseout(function() {        timer = setTimeout(function() {            $(\"#cat-menu\").hide();            $(\".main-nav h2\").removeClass(\"on\");        }, 100);    });    $('#cat-menu').live('mouseout', function() {        timer = setTimeout(function() {            $(\"#cat-menu\").hide();            $(\".main-nav h2\").removeClass(\"on\");        }, 100);    });        $('#cat-menu').live('mouseover', function() {        clearTimeout(timer);    });        //è´­ç©è½¦    var enter = function(){        if($(\"#top-cart-list\").is(\":hidden\")){            $(\"#top-cart-list\").show();            var html_list = $.ajax({url:\"/sync/getcart.php\",async:false});            $('#top-cart-list').html(html_list.responseText);            if($(\".smb .shoppingcartnumid\").html()===null){                $(\".shoppingcartnumid\").html(0);            }else{                $(\".shoppingcartnumid\").html(parseFloat($(\".smb .shoppingcartnumid\").html()));            };            return false;        }else{            $(\"#top-cart-list\").hide();            return false;        };    };    var _enter;    $(\"#bk-t-cart\").mouseenter(function(){        clearTimeout(_enter);        _enter = setTimeout(enter, 200);    });    $(\"#bk-t-cart\").mouseleave(function(){        clearTimeout(_enter);        $(\"#top-cart-list\").hide();        return false;    });    function del_cart(spbs){        var dnum = parseFloat($(\"#cald_\"+spbs).attr('cal'));        $.ajax({            url:\"http://www.bookuu.com/sync/getcart.php\",        data :{            action:'del',                    spbs:spbs        },        success: function(data){            $(\"#top-cart-list\").html(data);            $(\".shoppingcartnumid\").html(parseFloat($(\".shoppingcartnumid\").html())-dnum);        }    });    }    </script><!--ç¹å»--><div class=\"contact-list\">    <ul>        <li class=\"yjfk\"><a href=\"javascript:void(0);\" id=\"_yjfk\" name=\"yjfk\">ç¨æ·åé¦</a></li>        <li class=\"hdsy\"id=\"huidao_top\"><a href=\"javascript:void(0);\">åå°é¡¶é¨</a></li>    </ul></div><!-- å¼¹çªé®ç½© --><div class=\"fb-mask\"></div><!--ç¨æ·ç»å½--><div class=\"serve-form\">    <div id=\"khzx-login\">        <div id=\"kfzx-header\" class=\"khzx-hd\"><h3>ç¨æ·ç»å½</h3><em id=\"close\" class=\"close\">Ã</em></div>        <div class=\"khzx-bd login\">            <p id=\"kfzx_show_info\"></p>            <!-- <h4>ç¨æ·ç»å½</h4> -->            <div class=\"info\">                <form>                    <ul>                        <li><label class=\"label\">ç¨æ·å:</label>                            <input type=\"text\" name=\"nickname\" id=\"_nickname\" onkeydown='if(event.keyCode==13){syncLogin()}'  value=\"\" maxlength=\"32\" ></li>                        <li><label class=\"label\">å¯&nbsp;&nbsp;&nbsp;ç :</label>                            <input type=\"password\" name=\"passwd\" id=\"_passwd\"  onkeydown='if(event.keyCode==13){syncLogin()}'  value=\"\" maxlength=\"32\"></li>                        <li class=\"li-btn\">                            <input id=\"kfzx-send-login\"  type=\"button\" value=\"æäº¤\"  class=\"submit-btn\" onclick=\"syncLogin();\" /><a href=\"http://passport.bookuu.com/getpassword.php\">æ¾åå¯ç </a>                        </li>                        <li class=\"alliance-login\">                            <a href=\"http://passport.bookuu.com/qqlogin.php\" target=\"_blank\" title=\"ç¨QQè´¦å·ç»å½\"><img src=\"http://style.bookuu.com/index/images/qqlogin_icon.gif\" alt=\"ç¨QQè´¦å·ç»å½\"></a>                            <a href=\"http://passport.bookuu.com/alilogin.php\" target=\"_blank\" title=\"ç¨æ¯ä»å®å¸å·ç»å½\"><img src=\"http://style.bookuu.com/index/images/alipaylogin_icon.gif\" alt=\"ç¨æ¯ä»å®å¸å·ç»å½\" /></a>                            <a href=\"http://passport.bookuu.com/xunleilogin.php\" target=\"_blank\" title=\"è¿é·è´¦å·ç»å½\"><img src=\"http://style.bookuu.com/index/images/xunlei.jpg\" alt=\"è¿é·è´¦å·ç»å½\" style=\"vertical-align:middle;\">è¿é·</a>                            <a href=\"http://passport.bookuu.com/feixinlogin.php\" target=\"_blank\" title=\"é£ä¿¡è´¦å·ç»å½\"><img src=\"http://style.bookuu.com/index/images/feixin.png\" alt=\"é£ä¿¡è´¦å·ç»å½\" style=\"vertical-align:middle;\">é£ä¿¡</a>                        </li>                        <li class=\"sub-reg\">è¿ä¸æ¯ååºç½ç¨æ·ï¼<a href=\"http://passport.bookuu.com/reg.php\" target=\"_blank\">å¿«éæ³¨å>></a></li>                    </ul>                </form>            </div>        </div>    </div><!--ç¨æ·åé¦-->    <div id=\"khzx-feedback\">        <div id=\"kfzx-header3\" class=\"khzx-hd\"><h3>ç¨æ·åé¦</h3><em id=\"close\" class=\"close\">Ã</em></div>        <div class=\"khzx-bd khzx-fb\" id=\"khzx-fb\" style=\"display: none\">            <span class=\"yjjy\">                <label class=\"on\"><input type=\"radio\" id=\"_yjjy\" name=\"radio\" checked=\"checked\" value=\"0\">æè§å»ºè®®</label>                <label><input type=\"radio\" id=\"_ddwt\" name=\"radio\" value=\"1\">è®¢åé®é¢</label>                <label><input type=\"radio\" id=\"_wycw\" name=\"radio\" value=\"2\">ç½ç«éè¯¯</label>            </span>            <div class=\"info\" id=\"_yjandjy\">                <form>                    <textarea id=\"content1\" name=\"yjfka\" rows=\"10\" maxLength=\"1000\" style=\"width:418px;\" onkeyup=\"checkLength(this)\" placeholder=\"ä¸ºæ´å¥½çæåååºç½æå¡ï¼çè¯å¸ææ¨è½å¯¹ååºç½çä¸è¶³æåºå®è´µæè§ã\"></textarea>                    <br />                    <span>æ¨è¿å¯ä»¥è¾å¥<span style=\"color:#DE5401\" id=\"spanword\">1000</span>å­</span>                    <br />                    <span id=\"yj-eeror\"></span>                    <input type=\"button\" value=\"æäº¤åé¦\" class=\"submit-btn\" onclick=\"yjfkbutton()\">                </form>            </div>            <div class=\"info\" id=\"_ddandwt\" style=\"display: none\">                    <ul>                        <li><label class=\"label\"><font color='red'>*</font>è®¢åç¼å·:</label>                            <input class=\"inpt\" type=\"text\" name=\"num\" id=\"num\" maxlength=\"32\" placeholder=\"å¦ï¼E00019999912\" style=\"width:300px;\">&nbsp;&nbsp;</li>                        <li style=\"padding-left:70px;\"><span id=\"dd-num\"></span></li>                        <li><label class=\"label\"><font color='red'>*</font>èç³»çµè¯:</label>                            <input class=\"inpt\" type=\"phone\" name=\"phone\" id=\"phone\" maxlength=\"32\" placeholder=\"ææºå·ç \" style=\"width:300px;\"></li>                        <li style=\"padding-left:70px;\"><span id=\"dd-phone\"></span></li>                        <li><label class=\"label\" style=\"vertical-align: top;\"><font color='red'>*</font>è¯¦ç»æè¿°:</label>                            <textarea id=\"content\" name=\"content\" rows=\"5\" maxLength=\"500\" onkeyup=\"Lengthb(this)\" placeholder=\"è¯·å°½éè¯¦ç»æè¿°æ¨çè®¢åé®é¢\" ></textarea>                            <br />                                                    </li>                        <li style=\"padding-left:70px;\"><span>æ¨è¿å¯ä»¥è¾å¥<span style=\"color:#DE5401\" id=\"spanwordb\">500</span>å­</span><br /><span id=\"dd-error\"></span></li>                        <li>                            <input type=\"hidden\" id=\"ckitem_ddadwt\" value=\"0\" >                            <input type=\"button\" value=\"æäº¤åé¦\" class=\"submit-btn\" onclick=\"send_msg()\">                        </li>                    </ul>            </div>            <div class=\"info\" id=\"_wyandcw\" style=\"display: none\">                 <form action='/sync/feedback.php?a=uploadimg' method=\"post\">                    <ul>                        <li><label class=\"label\"><font color=\"red\">*</font>é¡µé¢é¾æ¥:</label>                            <input class=\"inpt\" type=\"text\" name=\"url\" id=\"_url\" maxlength=\"200\" placeholder=\"å¦: http://www.bookuu.com/\">                            <select id=\"_oldtime\" name=\"oldtime\" style=\"padding:5px;\">                                <option value=\"\">éè¯¯åçæ¶é´</option>                                <option value=\"åå\">åå</option>                                <option value=\"ä¸å°æ¶å\">ä¸å°æ¶å</option>                                <option value=\"ä¸å¤©å\">ä¸å¤©å</option>                                <option value=\"ä¸å¤©å\">ä¸å¤©å</option>                            </select>                            <br />                            <li style=\"padding-left:70px;\"><span id=\"ym-url\"></span></li>                                                    </li>                        <!--li><label class=\"label\"><font color=\"red\">*</font>éè¯¯å¾çä¸ä¼ :</label>                            <input type=\"file\" name=\"publish\" id=\"file\" style=\"width:180px;\" /><span>JPG/PNG&nbsp;&nbsp;500Kä»¥å</span>                        </li-->                        <li><label class=\"label\"><font color=\"red\">*</font>æè¿°æä½:</label>                            <textarea id=\"_bugcontent\" name=\"bugcontent\" rows=\"5\" maxLength=\"500\" onkeyup=\"Length(this)\" placeholder=\"è¯·è¯¦ç»æè¿°é¡µé¢åçéè¯¯åæ¨çæä½\"></textarea>                            <li style=\"padding-left:70px;\">                            <span>æ¨è¿å¯ä»¥è¾å¥<span style=\"color:#DE5401\" id=\"spanworda\">500</span>å­</span>                            <br /><span id=\"ym-error\"></span></li>                        </li>                        <li><input type=\"button\" value=\"æäº¤åé¦\" class=\"submit-btn\" onclick=\"send_bugmsg()\"></li>                    </ul>                 </form>            </div>        </div>    </div></div><script type=\"text/javascript\">//å¼¹åºå±ç¹å»æ¶var is_opened = false;//å¤æ­æ¯å¦ç»å½var _logined = false;if (!_logined) {    $.get(\"/sync/feedback.php?login=1&num=\"+Math.round(Math.random()*10000),function(result){        if(result==1){            _logined=true;        }else{            _logined=false;        }    });}$(\".yjfk\").click(function() {\t$(\".fb-mask\").fadeIn(200);\t$(\".serve-form\").fadeIn(400);\t$(\"#khzx-fb\").show();\tif (_logined) {\t\tif (is_opened) {\t\t\tis_opened = false;\t\t\t$(\".serve-form\").hide();\t\t\t$(\"#khzx-feedback\").hide();\t\t\t// $(\"#khzx-fb\").hide();\t\t} else {\t\t\t$(\"#khzx-feedback\").show();\t\t\t$(\"#khzx-login\").hide();\t\t\tis_opened = true;\t\t}\t} else {\t\tif (is_opened) {\t\t\tis_opened = false;\t\t\t$(\".serve-form\").hide();\t\t\t$(\"#khzx-feedback\").hide();\t\t\t// $(\"#khzx-fb\").hide();\t\t} else {\t\t\t$(\"#khzx-login\").show();\t\t\t$(\"#khzx-feedback\").hide();\t\t\tis_opened = true;\t\t}\t}});// $(\".contact-list\").show();// ç¨æ·åé¦éèæ¾ç¤º$(window).scroll(function(){   if( $(document).scrollTop() > 0 ) {      $('.contact-list').show();   } else {      $('.contact-list').hide();   }});//ç»å½function syncLogin() {\t$.post(\"/sync/login.php\", {\t\tnickname: $(\"#_nickname\").val(),\t\tpasswd: $(\"#_passwd\").val()\t},\tfunction(result) {\t\tif (result == \"ç»å½æå\") {\t\t\t$(\"#kfzx-t\").text(\"å®¢æå¨è¯¢\");\t\t\t//è·åç½é¡µæ å¤´æ¶æ¯\t\t\t$.post(\"/sync/refreshheader.php\",\t\t\tfunction(result) {\t\t\t\t$(\"#bk-site-nav\").html(result);\t\t\t});\t\t\t_logined = true;\t\t\t$(\"div.serve-form\").show();\t\t\t$(\"#khzx-fb\").show();\t\t\t$(\"#khzx-login\").hide();\t\t\t$(\"#khzx-feedback\").show();\t\t} else {\t\t\t$(\"#kfzx-t\").text(\"ç¨æ·ç»å½\");\t\t\t$(\"#kfzx_show_info\").html(\"<font color='red'>\" + result + \"</font>\");\t\t}\t});}//æè§å»ºè®®æäº¤function yjfkbutton() {\tvar data = $(\"#content1\").val();\tif (data == '') {\t\t$(\"#yj-eeror\").html(\"<font color='red'>åå®¹ä¸è½ä¸ºç©º</font>\");\t\treturn;\t}\t$.post(\"/sync/feedback.php\", {\t\tyjfka: encodeURIComponent($(\"#content1\").val()),\t\tsurl: window.location.href\t},\tfunction(_data) {\t\tvar _show = _data == '1' ? \"<font color='green'>æ¨çæè§å·²æäº¤æåï¼æä»¬å°ä»ç»éè¯»æ¨çåé¦æè§ï¼æè°¢æ¨çæ¯æã</font>\": \"<font color='red'>æ±æ­ï¼æ¶æ¯åéå¤±è´¥ï¼è¯·ç¨åéè¯ã</font>\";\t\t$(\"div.khzx-bd\").html(_show);\t\tsetTimeout(\"location.reload()\", 1500);\t});}//è®¢åéè¯¯æäº¤function send_msg() {    $(\"#num\").blur();    $(\"#phone\").blur();    var number = $(\"#num\").val();    var phone = $(\"#phone\").val();    var content = $(\"#content\").val();    if (content.length > 500) {        $(\"#dd-error\").html(\"<font color='red'>å­æ°è¶åºéå¶</font>\");        error = 1;    } else if (!content) {        $(\"#dd-error\").html(\"<font color='red'>åå®¹ä¸è½ä¸ºç©º</font>\");    } else {        $(\"#dd-error\").html(\"\");    }    if ($('#dd-num').html() || $('#dd-phone').html() || $('#dd-error').html()) {        return;    }    if (phone != \"\" && number != \"\" && content != \"\") {\t\t$.get(\"/sync/feedback.php?a=ddbh&phone=\" + $(\"#phone\").val() + \"&ddbh=\" + number + \"&msg_content=\" + encodeURIComponent(content),\t\tfunction(data) {\t\t\tvar _show = data == '1' ? \"<font color='green'>æ¨çæè§å·²æäº¤æåï¼æä»¬å°ä»ç»éè¯»æ¨çåé¦æè§ï¼æè°¢æ¨çæ¯æã</font>\": \"<font color='red'>æ±æ­ï¼æ¶æ¯åéå¤±è´¥ï¼è¯·ç¨åéè¯ï¼</font>\";\t\t\t$(\"div.khzx-bd\").html(_show);\t\t\tsetTimeout(\"location.reload()\", 1500);\t\t});\t} else {\t\t$(\"#dd-error\").html(\"<font color='red'>åå®¹ä¸è½ä¸ºç©º</font>\");\t\treturn;\t}}// ç½ç«éè¯¯function send_bugmsg() {    $(\"#_url\").blur();    var url = $(\"#_url\").val();    var bugcontent = $('#_bugcontent').val();    var oldtime = $('#_oldtime').val();    if (bugcontent.length > 500) {        $(\"#ym-error\").html(\"<font color='red'>å­æ°è¶åºéå¶</font>\");    } else if (!bugcontent) {        $(\"#ym-error\").html(\"<font color='red'>åå®¹ä¸è½ä¸ºç©º</font>\");    } else {        $(\"#ym-error\").html(\"\");    }    if ($('#ym-url').html() || $('#ym-error').html()) {        return;    }    if (url != \"\") {\t\t$.post(\"/sync/feedback.php\", {a: 'pagebug', url : url, oldtime : oldtime, bugcontent: encodeURIComponent(bugcontent)},\t\tfunction(data) {\t\t\tvar _show = data == '1' ? \"<font color='green'>æ¨çæè§å·²æäº¤æåï¼æä»¬å°ä»ç»éè¯»æ¨çåé¦æè§ï¼æè°¢æ¨çæ¯æã</font>\": \"<font color='red'>æ±æ­ï¼æ¶æ¯åéå¤±è´¥ï¼è¯·ç¨åéè¯ï¼</font>\";\t\t\t$(\"div.khzx-bd\").html(_show);\t\t\tsetTimeout(\"location.reload()\", 1500);\t\t});\t} else {\t\t$(\"#ym-error\").html(\"<font color='red'>åå®¹ä¸è½ä¸ºç©º</font>\");\t\treturn;\t}}$(\".close\").click(function() {\t$(\".fb-mask\").fadeOut(200);\t$(\"#khzx-login\").fadeOut(200);\t$(\"#khzx-feedback\").hide();\t//$('#khzx-feedback input').val('');\t//$('#khzx-feedback textarea').val('');\t//location.reload();\tis_opened = false;});$(function() {\t$(\":radio\").click(function() {\t\tvar radio = $(this).val();\t\tswitch (radio) {            case \"1\":                $(\"#_ddandwt\").show();                $(\"#_wyandcw\").hide();                $(\"#_yjandjy\").hide();                break;            case \"2\":                $(\"#_wyandcw\").show();                $(\"#_ddandwt\").hide();                $(\"#_yjandjy\").hide();                break;            default:                $(\"#_yjandjy\").show();                $(\"#_ddandwt\").hide();                $(\"#_wyandcw\").hide();            }\t});    $(\"#content1\").blur(function(){        });    $(\"#num\").blur(function(){        var number = $(\"#num\").val();        var reg = /^[A-Z]\\d{11}$/;        var error = 0        if (number == '') {            $(\"#dd-num\").html(\"<font color='red'>è®¢åç¼å·ä¸è½ä¸ºç©ºï¼</font>\");            error = 1;        }else if (!reg.test(number)) {            $(\"#dd-num\").html(\"<font color='red'>è®¢åå·ç æ ¼å¼æè¯¯ã</font>\");            error = 1;        }        if (!error) {            $(\"#dd-num\").html(\"\");        }        });    $(\"#phone\").blur(function(){        var phone = $(\"#phone\").val();        var error = 0;        var reg = /^(13[0-9]|15[0|3|6|7|8|9]|18[8|9])\\d{8}$/;                if (phone == '') {            $(\"#dd-phone\").html(\"<font color='red'>èç³»çµè¯ä¸è½ä¸ºç©ºã</font>\");            error = 1;        } else if (!reg.test(phone)) {            $(\"#dd-phone\").html(\"<font color='red'>è¯·è¾å¥ææçææºå·ç ã</font>\");            error = 1;        }        if (!error) {            $(\"#dd-phone\").html(\"\");        }        });    $(\"#_url\").blur(function(){        var url = $(\"#_url\").val();        var error = 0;        if (url == '') {            $(\"#ym-url\").html(\"<font color='red'>è¯·è¾å¥é¡µé¢é¾æ¥å°åã</font>\");            error = 1;        } else if (url.indexOf('bookuu') < 0) {            $(\"#ym-url\").html(\"<font color='red'>URLæ ¼å¼æè¯¯ã</font>\");            error = 1;        }        if (!error) {            $(\"#ym-url\").html(\"\");        }        });});$(\".yjjy label\").click(function() {\t$(\".yjjy label\").removeClass(\"on\");\t$(this).addClass(\"on\");});//åå°é¡¶å±window.onload = function() {    var oTop = document.getElementById(\"huidao_top\");    var screenw = document.documentElement.clientWidth || document.body.clientWidth;    var screenh = document.documentElement.clientHeight || document.body.clientHeight;    oTop.style.left = screenw - oTop.offsetWidth +\"px\";    oTop.style.top = screenh - oTop.offsetHeight + \"px\";    window.onscroll = function() {        var scrolltop = document.documentElement.scrollTop || document.body.scrollTop;        oTop.style.top = screenh - oTop.offsetHeight + scrolltop +\"px\";    }    oTop.onclick = function() {        document.documentElement.scrollTop = document.body.scrollTop =0;    }}//å­æ°ç»è®¡function checkLength(which) {    var maxChars = 1000;    if (which.value.length > maxChars)        which.value = which.value.substring(0,maxChars);    var curr = maxChars - which.value.length;    document.getElementById(\"spanword\").innerHTML = curr.toString();}function Length(lengths) {    var maxChars = 500;    if (lengths.value.length > maxChars)        lengths.value = lengths.value.substring(0,maxChars);    var curr = maxChars - lengths.value.length;    document.getElementById(\"spanworda\").innerHTML = curr.toString();}function Lengthb(lengthb) {    var maxChars = 500;    if (lengthb.value.length > maxChars)        lengthb.value = lengthb.value.substring(0,maxChars);    var curr = maxChars - lengthb.value.length;    document.getElementById(\"spanwordb\").innerHTML = curr.toString();}</script><!--ENDå®¢æ·å¨è¯¢--></body></html>        <script type=\"text/javascript\" src=\"http://style.bookuu.com/shoping/js/shopping-cart.js\"></script>           <script type=\"text/javascript\">            function reg(){}            function resign() {                var qq = Math.round((Math.random()) * 100000000);                $('#sign').attr('src', './imgcode.php?r='+qq);            }            $(\".contact-list\").hide();        </script>\n0x2:需要的数据抓到就可以重置热线！\n\n热线是没有绑定手机号！\n\n所以在第一步填入用户名时截断数据把返回的数据包修改成第一步的响应包，就能通过手机修改密码！\n\n选择手机修改密码，手机号显示****其实是不存在手机号，就无法发送验证码，验证码若是发送不成功是不能提交数据进行下一步，其实4位的验证码，但无法爆破输入三次就无法在输入！\n\n获取验证码截断数据，修改响应包102改为100放行即可！\n\n之后在验证码随意输入几个数字点击提交，接着修改响应包102改为100放行！\n\n\n\n   漏洞证明：  0x3：之后放行就能到修改密码的页面，修改密码为wooyun123！\n\n\n\n0x4：修改密码成功登录验证！\n\n方法一样复线上面的过程重置admin的密码，密码wooyun123\n\n   修复方案：  完善服务端的验证机制！深夜挖洞求高神rank！   版权声明：转载请注明来源 千斤拨四两@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-07-03 17:46 厂商回复： 感谢乌云和千斤拨四两大神提供漏洞信息，我们会尽快修复，致敬。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}