{"id": 39834, "wybug_id": "wooyun-2015-093135", "wybug_title": "LebiShop商城系统最新版任意用户登陆", "wybug_corp": "www.lebi.cn", "wybug_author": "xfkxfk", "wybug_date": "2015-01-27 11:25", "wybug_open_date": "2015-04-27 11:26", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "设计缺陷", "敏感接口缺乏校验", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-30：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-27：\t细节向公众公开  简要描述： LebiShop商城系统最新版任意用户登陆 详细说明：  LebiShop商城系统最新版Powered by LebiShop V3.1.01，存在任意用户登陆官方demo测试http://plus.demo.lebi.cn/——可注册普通用户和商家用户http://demo.lebi.cn/——可注册普通用户我们使用http://plus.demo.lebi.cn/进行测试首先我们注册一个普通用户222222，并登陆\n\n注意这里的COOKIE中user的值，id=37，这里是用户222222的用户userid然后我们修改这里的id，id=1，hash不变，其他都不变，只修改id的值\n\n可以看到，我们已经登陆了用户userid=1的用户test了再来修改id=25此时会登陆userid=25的用户shoptest，因为此用户已经注册申请为商家用户所以访问http://plus.demo.lebi.cn/supplier/即可登陆商家页面\n\n拿外网案例测试：http://shop.lutoog.com/注册用户111111，登陆，然后修改id=1即可登陆userid=1的用户\n\n   漏洞证明：  \n\n   修复方案：  登陆状态验证时，加上hash的验证，不要只通过currentuserid进行判断   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-01-27 13:37 厂商回复： 漏洞已修复，感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-10 08:01 |    \t\t90Snake \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:42        | 最大的漏洞就是人)\t\t \n  诶？这个不是应该给钱的吗  @xfkxfk    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}