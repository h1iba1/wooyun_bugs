{"id": 18938, "wybug_id": "wooyun-2012-09978", "wybug_title": "Android无视屏幕解锁保护界面", "wybug_corp": "安卓", "wybug_author": "only_guest", "wybug_date": "2012-07-21 17:42", "wybug_open_date": "2012-07-21 17:42", "wybug_type": "非授权访问/认证绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全", "手机后门", "手机软件安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-21：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-07-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 感谢小管子提供此漏洞.我是来刷分的. 详细说明：  Android无视屏幕解锁保护界面1 原理\tAndroid存在三种屏幕解锁保护：图案解锁、PIN密码解锁和密码解锁。其界面分别如下： 图表 1 图案解锁界面 \n\n图表 2 PIN密码解锁界面 \n\n图表 3 密码解锁界面\n\n我们可以使用java.lang.Object.android.app.KeyguardManger中的子类KeyguardLock可以控制Disable掉这些屏幕锁界面,从而达到不用输入密码,直接过掉屏幕锁界面来使用手机主要使用KeyguardLock.disableKeyguard()和KeyguardLock.enableKeyguard()方法来Disable、enable屏幕锁界面2 代码说明Demo程序主要代码如下：\n//获取KeyguardManagerKeyguardManager manager = (KeyguardManager) getSystemService(KEYGUARD_SERVICE);If(manager.inKeyguardRestrictedInputMode()){   //处于锁定界面,界面则通过KeyguardLock类方法来解锁KeyguardLock keyguard = manager.newKeyguardLock(getLocalClassName());   keyguard.disableKeyguard();}   \t\t需要权限：<uses-permission android:name=\"android.permission.DISABLE_KEYGUARD\"/>\n3 结论1.\t图案锁界面使用此方法调用disableKeyguard() 方法disable图案锁屏界面后，按home键会触发锁屏界面enable重新显示锁屏界面。2.\tPin密码锁界面使用此方法调用disableKeyguard()方法后disable图案界面后，按home键会出现闪屏。不会返回主页面3.\t密码锁界面使用此方法调用disableKeyguard()方法后disable图案界面后，按home键会出现闪屏。不会返回主页面虽然不知道Google为什么提供这样一个api，但开发者利用此api几乎就可以使Android的屏幕锁保护功能形同虚设了，而且调用此方法后home键出现的异常现象应该是个bug吧。4 Demo由于屏幕锁定时通过电脑上豌豆荚等软件只能安装Apk，并不能启动apk,所以此Demo程序写成了开机启动，即当屏幕锁屏时，通过电脑豌豆荚等软件安装此软件后重启即可实现Pass掉屏幕锁界面。Android 2.2 ,2.3,4.0平台测试通过。Demo apk程序：  乌云不能上传..Demo源码： 乌云不能上传..   漏洞证明：  试试看.反正我的9100直接绕过了...   修复方案：  谷歌真有爱,提供这么好的api   版权声明：转载请注明来源 only_guest@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：5 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2012-07-21 17:52 |    \t\tK1night \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        )\t\t \n  记得这个360上有个软件叫 刷机精灵 上面有个功能是一键解锁屏保功能。    \n     2012-07-21 20:37 |    \t\t『 Change_era 』 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:1        | 追逐时代的脚步，奋斗向上，努力先前进。)\t\t \n  @only_guest 求此Demo  Email:445452791@qq.com    \n     2012-07-24 09:55 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  天天动听锁屏后，按主页键，无视其锁定和屏幕滑动锁定，直接打开主页    \n     2012-08-02 20:37 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:31        | Hacked by @ringzero 我錯了)\t\t \n  厂商不是google么    \n     2012-08-09 06:19 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  亲，你在群里吗    \n     2012-10-22 01:30 |    \t\tzidane \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:2        | 噢 乖，你们应该明白 这样下去对我们谁都不...)\t\t \n  makesi    \n     2012-10-22 16:57 |    \t\tcircus \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:4        | 你会为一件事去说一句话,也会为一句话去干...)\t\t \n  昨天听了讲座说的就是如何破解。安卓的锁屏密码是以sha-1存储的。然后再debug模式下可以生成128M的彩虹表。直接跑出来锁屏顺序。    \n     2014-06-10 02:01 |    \t\t~奈何~ \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | web安全有点兴趣)\t\t \n  跪求demo  email:1535068423@qq.com  谢谢哈！  测试下    \n     2014-06-10 02:02 |    \t\t~奈何~ \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | web安全有点兴趣)\t\t \n  @circus 嫩跟我具体说说吗？  我打算尝试下操作。。     \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 5, "Ranks": null}