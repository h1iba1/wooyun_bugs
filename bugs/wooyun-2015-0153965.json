{"id": 72368, "wybug_id": "wooyun-2015-0153965", "wybug_title": "魅族手机媒体服务SQL注入", "wybug_corp": "魅族科技", "wybug_author": "路人甲", "wybug_date": "2015-11-19 10:32", "wybug_open_date": "2015-12-29 11:00", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-29：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 魅族手机上的媒体服务可产生SQL注入。 详细说明：  文件名有引号的时候可导致媒体服务产生SQL注入风险，直接影响就是媒体服务不断崩溃，图库无法使用，引用图库的第三方应用如QQ无法拍照发送图片。设备型号：m2 noteFlayme版本：4.5.4.1A   漏洞证明：  \nE/SQLiteLog(16495): (1) near \"suki\": syntax errorE/AndroidRuntime(16495): FATAL EXCEPTION: Download ServiceE/AndroidRuntime(16495): Process: android.process.media, PID: 16495E/AndroidRuntime(16495): android.database.sqlite.SQLiteException: near \"suki\": syntax error (code 1): , while compiling: SELECT _id, date_modified, mini_thumb_magic FROM images WHERE (_data=\"/storage/emulated/0/Pictures/Mbooru/yande.re/yande.re 336109 sample cleavage game_cg goshogawara_yuuki k-ko pantsu panty_pull undressing watashi_ga_suki_nara_\"suki\"_tte_itte!.jpg\")E/AndroidRuntime(16495): at android.database.sqlite.SQLiteConnection.nativePrepareStatement(Native Method)E/AndroidRuntime(16495): at android.database.sqlite.SQLiteConnection.acquirePreparedStatement(SQLiteConnection.java:898)E/AndroidRuntime(16495): at android.database.sqlite.SQLiteConnection.prepare(SQLiteConnection.java:509)E/AndroidRuntime(16495): at android.database.sqlite.SQLiteSession.prepare(SQLiteSession.java:588)E/AndroidRuntime(16495): at android.database.sqlite.SQLiteProgram.<init>(SQLiteProgram.java:58)E/AndroidRuntime(16495): at android.database.sqlite.SQLiteQuery.<init>(SQLiteQuery.java:37)E/AndroidRuntime(16495): at android.database.sqlite.SQLiteDirectCursorDriver.query(SQLiteDirectCursorDriver.java:44)E/AndroidRuntime(16495): at android.database.sqlite.SQLiteDatabase.rawQueryWithFactory(SQLiteDatabase.java:1346)E/AndroidRuntime(16495): at android.database.sqlite.SQLiteQueryBuilder.query(SQLiteQueryBuilder.java:400)E/AndroidRuntime(16495): at android.database.sqlite.SQLiteQueryBuilder.query(SQLiteQueryBuilder.java:333)E/AndroidRuntime(16495): at com.android.providers.media.MediaProvider.query(MediaProvider.java:3137)E/AndroidRuntime(16495): at android.content.ContentProvider.query(ContentProvider.java:1110)E/AndroidRuntime(16495): at android.content.ContentProvider$Transport.query(ContentProvider.java:238)E/AndroidRuntime(16495): at android.content.ContentResolver.query(ContentResolver.java:485)E/AndroidRuntime(16495): at android.content.ContentResolver.query(ContentResolver.java:429)E/AndroidRuntime(16495): at com.android.providers.downloads.DownloadNotification.getThumbFromImage(DownloadNotification.java:853)E/AndroidRuntime(16495): at com.android.providers.downloads.DownloadNotification.getThumb(DownloadNotification.java:1068)E/AndroidRuntime(16495): at com.android.providers.downloads.DownloadNotification.updateCompletedNotification(DownloadNotification.java:531)E/AndroidRuntime(16495): at com.android.providers.downloads.DownloadNotification.updateNotification(DownloadNotification.java:186)E/AndroidRuntime(16495): at com.android.providers.downloads.DownloadService$UpdateThread.run(DownloadService.java:375)\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-11-19 18:58 厂商回复： 测试的过程是曲折的。根据白帽子日志中泄露的APP信息我们成功复现了该问题。让人震惊的是，竟然有人在一边看H漫，一边找漏洞，这是什么样的Hacker精神！？来吧，小伙，你私信我地址，我来给你发礼品。 最新状态： 2015-12-28：已于最新版固件修复此问题。 2015-12-29：已于最新版固件修复此问题。  ", "replys": "漏洞评价：\n评论\n     2015-11-19 20:00 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:372 漏洞数:109        )\t\t \n  让人震惊的是，竟然有人在一边看H漫，一边找漏洞，这是什么样的Hacker精神！？    \n     2015-11-19 20:12 |    \t\t染血の雪 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:30        | 击缻)\t\t \n  魅族通过日志收集个人信息？    \n     2015-11-19 20:14 |    \t\tgodsec \t\t\t( 普通白帽子  |\t\t\t        Rank:243 漏洞数:38        | 不走小厂商,我们还是好朋友@乌云)\t\t \n  让人震惊的是，竟然有人在一边看H漫，一边找漏洞，这是什么样的Hacker精神！？    \n     2015-11-19 20:15 |    \t\t破童 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:5        | 破童Engout_网络安全技术团队创始者学...)\t\t \n  这是什么样的Hacker精神！？    \n     2015-11-19 20:23 |    \t\tqiaoy \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:16        )\t\t \n  2楼的哥们，看完详情再判断可好？    \n     2015-12-29 11:09 |    \t\t紫衣大侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:22        | 愿结天下有识之士)\t\t \n  yande.re 涨姿势了～    \n     2015-12-29 11:09 |    \t\t终于明白 \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:13        | 来看看。。)\t\t \n  666    \n     2015-12-29 11:14 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1422 漏洞数:221        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  H漫？Hacker漫的缩写？请叫我小纯洁^_^    \n     2015-12-29 11:23 |    \t\t1ron3gg \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | What a fucking day!)\t\t \n  让人震惊的是，竟然有人在一边看H漫，一边找漏洞，这是什么样的Hacker精神！？    \n     2015-12-29 11:28 |    \t\tFormat_smile \t\t\t( 普通白帽子  |\t\t\t        Rank:264 漏洞数:96        | ···孰能无过，谁是谁非！渗透穷三代，黑...)\t\t \n  楼主的精神 让我震惊了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}