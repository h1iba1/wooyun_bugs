{"id": 17480, "wybug_id": "wooyun-2012-010636", "wybug_title": "当当网严重的支付问题", "wybug_corp": "当当网", "wybug_author": "zzR", "wybug_date": "2012-08-06 16:21", "wybug_open_date": "2012-09-20 16:22", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-08-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-09-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-09-20：\t细节向公众公开  简要描述： 这几天处理公司的洞洞，处理时发现了这么一严重的问题，又是一元买-0- 详细说明：  这应该算是一个严重的问题了！   漏洞证明：  我也不知道支付过程中是怎样的一个环节，但是问题存在于厂商和银行之间吧，看图\n\n修改价格参数试试\n\n提交银行试试\n\n是不是一块钱买4s？我选的招商银行，其他银行貌似没有这样的问题，你们也可以试试！   修复方案：  我没支付，因为我没有网银，你们可以支付了试试！还有就是招商银行，问题挺多，多，对！感谢@风萧萧同学的指导   版权声明：转载请注明来源 zzR@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2012-08-06 16:38 厂商回复： 您好，这个问题，我们已经知道，如果没有付完整的款项，系统会一直处在等待付款状态。而且后边还会有相关的审核。另外，我们也准备修改这个问题。不使用前端提交的数据。另外@XSSER 你的10元钱，系统会在一定时间内退还到你的账户，不用担心。也多谢@zzR 对我们的关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-08-06 16:22 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  不审核？    \n     2012-08-06 16:23 |    \t\tnidao \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:3        | 还是木有。)\t\t \n  1分买都是浮云。。。问题是不发货。。。    \n     2012-08-06 16:26 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @nidao 服务器有订单信息做检查的吧？    \n     2012-08-06 16:26 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  嗯 的确是不发货啊... 坑爹的我还损失了10块钱    \n     2012-08-06 16:30 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @xsser 那就买虚拟商品唉，还有审核？    \n     2012-08-06 16:35 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @zzR 我早期测试的时候买了个东西，结果支付之后去看订单说是等待补款... 我猜测是在银行完成支付之后银行会与当当有这么一个交互的功能，他们会额外去比对数据的有效性    \n     2012-08-06 16:36 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  围观~    \n     2012-08-06 16:39 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  当当，钱真退给我了么...    \n     2012-08-06 16:47 |    \t\tlion(lp) \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:14        | 本人菜。。。千年实习白帽子)\t\t \n  @xsser 真退，不过，就是等着付款超时后会退,得等一小段时间。    \n     2012-08-06 17:18 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @xsser 对的，银行和厂商会对支付数据审核；不过这个问题貌似与招行的接口有关，很多电商的招行接口都存在这样的问题    \n     2012-08-07 12:50 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @zzR 话说，我还等着顶你的帖子！怎么一直看不到，原来已经确认了一天了！赞！    \n     2012-08-07 13:02 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @风萧萧 昨天提交就秒过，我也很惊讶    \n     2012-09-20 16:56 |    \t\tLeadUrLife \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:14        | 好好学习 天天向上)\t\t \n  问题的关键是不发货，好多篡改的价格的单子虽显示正常，但最后会出现各种失败。    \n     2012-09-21 14:19 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  缺陷关联： WooYun: 再爆苏宁某站点重大漏洞  （原因：招行接口未签名问题？） @xsser ，结合这个关联中的苏宁回复、和之前在微博的讨论（http://e.weibo.com/1981622273/yCKsEAXGx ），觉得有必要提醒一下，使用招行的接口需要升级一下，要加上签名校验这个环节了。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}