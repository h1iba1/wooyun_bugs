{"id": 21118, "wybug_id": "wooyun-2012-04190", "wybug_title": "阿里云(aliyun)帐户系统逻辑漏洞", "wybug_corp": "阿里巴巴", "wybug_author": "猪哥靓", "wybug_date": "2012-02-03 16:55", "wybug_open_date": "2012-03-19 16:56", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当导致攻击界面扩大", "逻辑错误", "密码窃取", "修改邮箱来间接修改密码", "黑盒", "用户私人信息泄露", "阿里云", "逻辑错误前台限制绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-02-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-02-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-02-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-03-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-03-19：\t细节向公众公开  简要描述： 可以通过一些逻辑获取其他账号的完全权限（我这样好不道德啊 眼看今天就周五了还给阿里同学找事。。。） 详细说明：  问题出现在忘记密码处，可以通过手机找回和邮箱找回密码两种方式获得指定帐户的新密码设置权限   漏洞证明：  进入忘记密码，填写想要获取权限帐号的ID获得url:\nhttps://account.aliyun.com/forget/findAccount.htm?profile=blueforyou%40aliyun.com-profile-1327128258196715\n需要牢记（blueforyou%40aliyun.com-profile-1327128258196715）很重要\n\n选择邮箱找回或手机找回均可获得url:\nhttps://account.aliyun.com/forget/email.htm?profile=blueforyou%40aliyun.com-profile-1327128258196715&_resubmit_token_=_resubmit_token_1749728258196796\n\n\n系统已将新密码设置url发送给邮箱\n\n此时只需要将前面获取的url修改一下将findAccount.htm?profile=blueforyou%40aliyun.com-profile-1327128258196715修改为reset.htm?profile=blueforyou%40aliyun.com-profile-1327128258196715即可获得设置该用户新密码的权限\n\n成功侵入该用户\n\n\n\n   修复方案：  尽快修复，尽快下班！   版权声明：转载请注明来源 猪哥靓@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-02-06 12:01 厂商回复： 谢谢猪哥靓提供的信息，漏洞已经处理，我们会努力做得更好的，再次谢谢~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-02-03 19:41 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  这个最后会公开吗？很期待。。想学习下    \n     2012-02-03 19:44 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  所有的都会公开    \n     2012-02-03 20:06 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  猪哥.不地道啊...    \n     2012-02-06 16:04 |    \t\tMujj \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:4        | IDC商)\t\t \n  等公开    \n     2012-03-04 01:17 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  这个舒服。猪哥学习了。    \n     2012-03-20 09:55 |    \t\tubuntu \t\t\t( 普通白帽子  |\t\t\t        Rank:148 漏洞数:12        | 一切皆有可能……)\t\t \n  向猪哥学习    \n     2012-03-20 11:51 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  @xsser 求指出问题根源。我的理解是存在两个修改通道，直接修改url进行密码重设的通道未验证用户身份，导致可以被任意用户重置。对吗？谢谢！    \n     2012-03-20 12:16 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @凤凰 应该是识别用户身份的（session）里的验证逻辑出了问题，求@阿里巴巴 给出解释    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}