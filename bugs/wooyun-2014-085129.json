{"id": 42624, "wybug_id": "wooyun-2014-085129", "wybug_title": "捷旅假期系统SQL注入&amp;反射型xss", "wybug_corp": "深圳市捷旅国际旅行社有限公司", "wybug_author": "路人甲", "wybug_date": "2014-11-29 17:38", "wybug_open_date": "2015-01-13 17:38", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-29：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-01-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： SQL注入漏洞及反射型xss漏洞 详细说明：  看到 WooYun: 深圳市某旅行社订房系统110W+开房信息泄露 里的描述就试了一下，结果发现一系列问题。1.当改变selectorderrequestid参数值为非int值或没有记录的int值的时候，页面会有错误的堆栈信息，分别为java.lang.NullPointerException、NumberFormatException\n\n出现这种情况说明系统还存在很多问题。2.在这个页面发现js/framework.js文件\n\n在页面构造查询条件，然后提交到数据库？这样岂不是有sql注入的问题。但是这个系统对于外网访问似乎限制很多，于是在百度上搜了下：捷旅，用这个系统的还挺多。经测试下面这个网站存在sql注入漏洞，构造sqlmap:python sqlmap.py -u \"http://hz.jlfzg.com:6372/booking/bookingAction!hotelIndex.action\" --data \"star=55&priceSearchValue=0&currentPage=1&selectEventId=82&salebyareaid=&hotelid=&roomtypeid=&hotelSearchJson=mon_bx\" --dbs --threads=3\n\n\n\n\n\n3.在页面搜索的地方存在反射型xss输入\" onfocus=\"javascript:alert(1)\"\n\n   漏洞证明：  \n\n\n\n\n\n\n\n   修复方案：  代码需要好好review下   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}