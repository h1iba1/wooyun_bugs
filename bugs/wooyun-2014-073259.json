{"id": 51820, "wybug_id": "wooyun-2014-073259", "wybug_title": "frcms 注入一枚 。", "wybug_corp": "finereason.com", "wybug_author": "′king", "wybug_date": "2014-08-25 11:23", "wybug_open_date": "2014-11-23 11:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-23：\t细节向公众公开  简要描述： 无视gpc。 详细说明：  在plus/count/count.php中\nif($c_come=='') $c_come=\"网址输入或收藏夹打开\";$c_page=$_SERVER[\"HTTP_REFERER\"];$c_year=date('Y');$c_month=date('m');$c_day=date('d');$c_hour=date('H');$c_time=date('Y-m-d H:i:s');$c_week=date('w');$c_where=trim(getip_from($c_ip));$date=date(\"Y-m-d\");$rss = $db->get_one(\"SELECT c_ip FROM {$cfg['tb_pre']}count WHERE DATE(c_time)='$date' AND c_ip='$c_ip' ORDER BY c_id DESC LIMIT 1\");$sql=\"INSERT INTO {$cfg['tb_pre']}count(c_ip,c_where,c_come,c_page,c_brower,c_os,c_year,c_month,c_day,c_hour,c_time,c_week) VALUES('$c_ip','$c_where','$c_come','$c_page','$c_brower','$c_os','$c_year','$c_month','$c_day','$c_hour','$c_time','$c_week')\";$db->get_one($sql);$c_id=$db ->insert_id();\n$c_page=$_SERVER[\"HTTP_REFERER\"];这里直接获取server中的referer 然后直接带入到了insert当中进行查询。因为全局中的SERVER变量 未过滤造成了注入。\n\n报错了 此时执行的语句为INSERT INTO job_count(c_ip,c_where,c_come,c_page,c_brower,c_os,c_year,c_month,c_day,c_hour,c_time,c_week) VALUES('127.0.0.1','本机地址','网址输入或收藏夹打开','a'','others','Windows 2000','2014','08','18','20','2014-08-18 20:31:20','1')构造一下语句。\n\n即可盲注。   漏洞证明：  \n\n   修复方案：  过滤。   版权声明：转载请注明来源 ′king@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-08-25 11:25 厂商回复： 此漏洞影响用户站点信息安全，感谢提交！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-29 23:37 |    \t\tnextdoor \t\t\t( 普通白帽子  |\t\t\t        Rank:325 漏洞数:74        )\t\t \n  数据搞不出来吧，在封装sql语句时把三个注视符都过滤了    \n     2014-10-30 23:05 |    \t\t′king \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:8        | 马甲甲)\t\t \n  @nextdoor  WooYun: frcms 多处注入可导致任意文件删除。 请看这个 80sec ids 轻松过。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}