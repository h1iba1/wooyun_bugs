{"id": 65095, "wybug_id": "wooyun-2013-019115", "wybug_title": "我是如何登录爱丽网后台的(非JS绕过、非盲打、非IP欺骗)", "wybug_corp": "aili.com", "wybug_author": "leaf", "wybug_date": "2013-02-24 11:38", "wybug_open_date": "2013-04-10 11:38", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["后台被猜解", "设计不当导致攻击界面扩大", "认证缺陷", "认证设计不合理", "认证绕过", "管理后台对外", "认证系统设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-02-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-03-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-03-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-04-10：\t细节向公众公开  简要描述： 我是如何登录爱丽网后台的(非JS绕过、非盲打、非IP欺骗)！感谢 @upload 和其它各位在zone对相关问题的讨论... 详细说明：  找到后台：\nhttp://wed.27.cn/marry/marryadmin/web/login.php\n不难猜解到后台管理的相关页面名称（不存在的页面服务器返回404，而存在的页面会直接跳转到上面的登录页面）。请求不存在的页面：\n\n请求存在的页面：\n\n用FF禁用JS后请求admin.php页面，依然跳转到登录页面，说明不存在JS绕过的问题。鉴于 WooYun: 我是如何登录住哪网后台的(突破IP限制!) 的灵感，用http editor请求看看，奇迹出现了：\n\n如此是何道理？浏览器请求和工具请求没什么区别，怎么就是不一样的结果呢？工具发送的请求也不带有合法的cookie信息，排除cookie的因素，而前面也排除了JS的因素，那是怎么个情况呢？看下响应：\n\n不难看出，http editor此时呈现的是这个302响应，而不是Location的login.php，而用浏览器请求的时候，浏览器就直接跳转并呈现Location的login.php页面。看来后台页面有程序逻辑错误，借用@upload的测试代码简单说明下：eg.php\n<?php header('Location: http://www.google.com');phpinfo();?>\n用浏览器请求该页面，会显示Google首页，而如果用http editor来请求则显示phpinfo信息。浏览器请求：\n\nhttp editor请求：\n\n\n\n既然如此，就可以查看admin.php页面的HTML源代码，逐个请求各超链接页面，任意使用后台相关功能了：\n\n\n\n\n\n.........and so on!!! 未进一步深入，不再一一贴图！   漏洞证明：  如上所述！    修复方案：     版权声明：转载请注明来源 leaf@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-02-25 09:28 厂商回复： 感谢Leaf ！ 此后台是爱丽网外包站点后台。分给少点吧。没有触及核心业务。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-02-24 12:20 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  这样登陆了后台页面但实际应该并没有操作权限把，难道操作的时候没有验证用户么    \n     2013-02-24 12:25 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  @小胖胖要减肥 有权限操作...呵呵！    \n     2013-02-24 12:26 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @leaf 洞主要出连续剧呀，    \n     2013-02-24 12:27 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  @se55i0n 标题类似，但是原理不一样...    \n     2013-02-24 12:30 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @leaf 坐等公开，    \n     2013-02-24 12:51 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  骚年，你这是要闹哪样？？？？？    \n     2013-02-24 12:54 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  @小胖子 我看到了好多胖子、瘦子类似名称的，是不是都是你？    \n     2013-02-25 12:07 |    \t\t心伤的裤子 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:2        | 看啥，裤子都掉了还看！)\t\t \n  @leaf  是的，但我不是    \n     2013-03-28 14:00 |    \t\t法海 \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:5        | 许仙去哪了)\t\t \n  好强大的样子    \n     2013-04-11 09:55 |    \t\twinger \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | Dark Net Top Hacker)\t\t \n  少年啊 哀直接说标题: 爱丽网HTTP头绕过可进后台详细说明:”后台使用 返回 HTTP 302 头标识来控制用户跳转， 造成可以在客户端绕过。 进入后台。“ 会不会简单点？而且用burp suite的proxy-->options-->match and replace 功能, 是可以自动替换header内容的.    \n     2013-04-11 10:13 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  @winger 额！对头，这种情况下burp suite会更方便操作...    \n     2013-04-18 19:58 |    \t\trampage \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:16        | 网站建设、安全与开发)\t\t \n  @winger 学到了，我今天用Fiddler测了的，早看到我就用BurpSuite了    \n     2013-06-02 23:34 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  忘记加exit（）这外包的。。    \n     2014-12-19 13:56 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @leaf 洞主这个工具在哪儿下载的，可否告知下    \n     2014-12-19 14:30 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  @HackBraid Acunetix Web Vulnerability Scanner 自带的http editor工具。    \n     2014-12-19 14:36 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @leaf 嗯嗯 3ks，这种思路很酷炫    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}