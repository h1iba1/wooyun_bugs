{"id": 7337, "wybug_id": "wooyun-2013-046547", "wybug_title": "乌云集市验证码机制绕过", "wybug_corp": "乌云官方", "wybug_author": "shack2", "wybug_date": "2013-12-20 17:02", "wybug_open_date": "2013-12-20 17:09", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-20：\t厂商提前公开漏洞，细节向公众公开  简要描述： 验证码绕过，直接狂发请求包刚刚测试兑换QB，手抖了一下，点快了，一不小心wb全换光了 详细说明：  乌云的验证码机制是页面加载完成后，去请求captcha.php生成验证码，将验证码记录当再次请求或跟换验证码时，在访问一次captcha.php生成验证码，那么我们直访问一次captcha.php生成验证码后，不去访问captcha.php后，验证码永远为第一次产生的。嘎嘎说到底就是验证码和页面不是同步机制，而是异步交互，导致绕过\n\n   漏洞证明：     修复方案：  同步机制   版权声明：转载请注明来源 shack2@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-12-20 17:07 厂商回复： 感谢提交，已修复，方案如下：1. 限制用户提交的验证码不能为空2. 判断提交的验证码与服务器上存储的是否一致3. 无论是否一致，都将服务器上存储的验证码清空 最新状态： 2013-12-20：已公开  ", "replys": "漏洞评价：\n评论\n     2013-12-20 17:04 |    \t\the2des \t\t\t( 普通白帽子  |\t\t\t        Rank:170 漏洞数:31        | )\t\t \n  土豪~我们做朋友把,V58Q    \n     2013-12-20 17:06 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  get方式提交，token是退出处的，不会改变，random按照算法对应验证码，NND居然不过期？    \n     2013-12-20 17:27 |    \t\t灬相随灬 \t\t\t( 普通白帽子  |\t\t\t        Rank:369 漏洞数:68        | 大胆天下去得，小心寸步难行。)\t\t \n  哎呀我草、、    \n     2013-12-20 17:49 |    \t\tWalle \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:5        | ...   位卑、未敢忘忧国！   ...)\t\t \n  洞主、、你这么吊、、你家里人知道吗？、、    \n     2013-12-20 18:39 |    \t\tshack2 \t\t\t( 普通白帽子  |\t\t\t        Rank:470 漏洞数:71        | QQ:1341413415 一个热爱编程(Java),热爱网...)\t\t \n  哈哈，其实大家爆后台的，别看到验证码，就不爆了，其实很多地方都放异步实现验证码机制，这样后端逻辑控制不好，就被绕了。    \n     2013-12-20 21:29 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  跟之前那个emlog的类似    \n     2013-12-20 21:34 |    \t\tnoob \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:18        | 向各位大神学习，向各位大神致敬)\t\t \n  我也遇到很多    \n     2013-12-23 09:21 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  @shack2 大神，我们做朋友吧！！    \n     2013-12-25 22:06 |    \t\tB1uH4ck \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | 大牛们你们好，小弟刚来。)\t\t \n  擦擦，没事没事大家继续。。我好想叫楼主一声尼奥可以么，恩可以，尼奥！！！！    \n     2014-01-03 16:57 |    \t\tdeepviolet \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 专注于密码学理论研究，业余爱好Web开发。)\t\t \n  s围观    \n     2014-01-05 22:49 |    \t\tJ′aron \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | 问题真实存在但是影响不大.)\t\t \n  围观    \n     2014-01-06 19:32 |    \t\t可乐、 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 为了宇宙和平)\t\t \n  只是一个疏忽    \n     2014-01-08 16:59 |    \t\tMr .LZH \t\t\t( 普通白帽子  |\t\t\t        Rank:583 漏洞数:75        | 非妹子勿扰···)\t\t \n  呵呵，等我考完试，再搞死这个验证码    \n     2014-01-22 21:47 |    \t\tpnck \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 渣一枚。)\t\t \n  @shack2 大神做我男朋友好不的啦（我们还是做普通朋友吧√    \n     2014-04-21 22:13 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  @可乐、 其实 乌云的所有漏洞 都是各种或严重 或不严重的疏忽或者软件设计师的疏忽  程序员的疏忽 网络规划师工程师的疏忽 部署工程师的疏忽 各种疏忽。。。。大意。。。渎职。。。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}