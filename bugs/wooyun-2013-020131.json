{"id": 13152, "wybug_id": "wooyun-2013-020131", "wybug_title": "尚品网任意手机号码绑定漏洞（两种不同方法）", "wybug_corp": "尚品网", "wybug_author": "xfkxfk", "wybug_date": "2013-03-16 10:16", "wybug_open_date": "2013-04-30 10:17", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["权限绕过", "设计缺陷", "逻辑错误", "权限验证不足", "手机短信", "权限越界", "验证码爆破"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-16：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-04-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 1、尚品网ShangPin.com_领先的高端时尚和奢侈品购物网站2、看看我们如何为尚品网用户绑定任意手机。。。 详细说明：  \n=====第一种：截包改数据法=====\n1、注册账户，然后进行绑定手机操作，首先输入正确的手机号码，这里测试我们就用我们自己的手机号码：\n\n2、然后，验证码会发到你的手机。这里为了找到规律我多发了几次，然后发现：验证码为6位随机数，但是第一位是固定不变的7，所以就变成了5位随机数了。\n\n3、当我们输入正确的验证后，截包：\n\n4、我们修改这里我们自己的手机号码为任意的手机号码。然后发送请求，从返回信息中能看到，绑定成功我们修改的手机号码。所以断定这里的逻辑是：当验证码正确时，就把post_data的数据当成了要绑定的手机号码对象，而不是我们发送验证码的手机号码。5、我们来看看成功绑定的结果：\n\n\n\n\n=====第二种：经典的爆破法=====\n验证方法：发验证码，输入随便验证码，截包，设置payload，爆破，判断正确验证码，输入正确验证码，查看结果。这里就不一一截图了。参考：http://wooyun.org/bugs/wooyun-2013-020130——“尚品网任意邮箱绑定漏洞（两种不同方法）”   漏洞证明：  \n\n\n\n   修复方案：  1、限制验证码的次数。2、逻辑错误。3、求礼物。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：5 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2013-04-23 13:30 |    \t\tLove \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 学习)\t\t \n  目测这个网的洞，被洞主全部破了    \n     2013-04-30 21:02 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  还有漏洞，不发了，这厂商，没意思    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 5, "Ranks": null}