{"id": 53595, "wybug_id": "wooyun-2014-067045", "wybug_title": "置信经典OriTop管理系统sql注入以及任意文件下载", "wybug_corp": "置信经典OriTop管理系统", "wybug_author": "BMa", "wybug_date": "2014-07-06 13:20", "wybug_open_date": "2014-10-04 13:22", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-04：\t细节向公众公开  简要描述：  详细说明：  置信经典OriTop管理系统sql注入以及任意文件下载这是一个小的cms，主要是用于医院网站如：http://xtmc.oritop.com/shixi/admin/http://www.xtzyyy.com/admin/http://www.xtguke.com/admin/http://www.eyehospital.com/admin/http://www.xtsz.com.cn/admin/http://www.xtast.org/admin/http://jingniugqt.com/admin/sql注入点：http://www.eyehospital.com/About.php?id=4代码如下，参数id只是简单地检测了变量是否设置，然后直接带入查询：\n<?phpif(!isset($_GET['id']) && !isset($_GET['Id'])){\techo \"<script language=javascript>top.location.replace('./');</script>\";\texit;}$id = isset($_GET['id']) ? $_GET['id'] : $_GET['Id'];include \"Include/global.php\";include \"Include/config.php\";$DataBase = new DataBase;$DataBase->OpenDataBase();$qid = mysql_query(\"SELECT * FROM about WHERE id='$id'\");if(mysql_num_rows($qid) > 0){\t$row = mysql_fetch_row($qid);}else{\theader(\"location: ./\");\texit;}include \"Template/Header.tpl\";include \"Template/About.tpl\";include \"Template/Footer.tpl\";?>\n任意文件下载http://xtsz.com.cn/ShowFile.php?id=../index.php代码如下，也是没有验证：\n<?phpinclude \"Include/global.php\";include \"Include/config.php\";if(isset($_GET['id']) && $_GET['id'] != \"\"){\t$file_name = $_GET['id'];\t$file_root_name = \"$upfile_root_path/$file_name\";\tif (!file_exists($file_root_name))\t{\t\techo \"文件不存在\";\t\texit;\t}\t$file_postfix = pathinfo($file_name);\t$file_postfix = strtolower($file_postfix[\"extension\"]);\t\t\tif($file_postfix != \"jpg\" && $file_postfix != \"gif\")\t{\t\t$file = fopen($file_root_name,\"r\"); // 打开文件 \t\t// 输入文件标签\t\tHeader(\"Content-type: application/octet-stream\");\t\tHeader(\"Accept-Ranges: bytes\");\t\tHeader(\"Accept-Length: \".filesize($file_root_name));\t\tHeader(\"Content-Disposition: attachment; filename=\" . $file_name);\t\t// 输出文件内容\t\techo fread($file,filesize($file_root_name));\t\tfclose($file);\t\texit;\t}\telse\t{\t\t// Content type\t\theader('Content-type: image/gif');\t\tif($file_postfix != \"gif\")\t\t{\t\t\t$image = imagecreatefromjpeg($file_root_name);\t\t\timagejpeg($image);\t\t}\t\telse\t\t{\t\t\t$image = imagecreatefromgif($file_root_name);\t\t\timagegif($image);\t\t}\t\t// Output\t\tImageDestroy($image);\t}}?>\n   漏洞证明：  \n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 BMa@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-07-11 09:39 厂商回复： CNVD确认所述漏洞情况，由于未能建立与软件生产厂商的联系渠道，该漏洞需要厂商认领，待处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}