{"id": 7804, "wybug_id": "wooyun-2013-036070", "wybug_title": "爱快软路由某功能存储型XSS漏洞", "wybug_corp": "爱快免费流控路由", "wybug_author": "LinE", "wybug_date": "2013-09-04 11:42", "wybug_open_date": "2013-12-03 11:43", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型", "过滤不严", "软路由"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-07：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-10-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-03：\t细节向公众公开  简要描述： 软路由配置不当导致存储型XSS，可引起其他攻击 详细说明：  在目前为止的最新版本当中，Version 1.1.0，页面推送设置中存在存储型XSS，若被恶意管理员利用可能会引起其他资料盗取的风险进入到软路由配置当中  网络服务---页面推送在通知内容当中写入html代码即可如果引用了恶意的JS或者iframe框架会导致用户强制访问某页面，引起其他攻击\n\n弹个窗···\n\n\n\n   漏洞证明：   WooYun: 爱快软路由任意文件下载漏洞 由上次的漏洞获得了这个推送设置页面的源代码，查看源代码得知写入的内容没有进行任何过滤导致XSS攻击产生行118-126\n<td class=\"tstit\">通知内容：</td>      <td colspan=\"3\">            \t<div style=\"width:78px;height:70px;float:left;padding-top:40px;display:inline;\"><div><a href='../webls/index.php'target=\"_blank\"  style='text-decoration:none;' id=\"yl\"> <img src=\"../public/img/ymylbut.jpg\" class=\"yl\" /></a></div> </div>\t\t <div style=\"width:300px;height:100px;float:left;margin-left:15px;display:inline;padding-top:10px;\">       \t\t<textarea name=\"\" class=\"ff\" style=\"width:350px;height:80px;\" id='ff'><?php while(!feof($fp)){echo fgets($fp);}fclose($fp); ?></textarea>            </div>        </td>\n可以看到内容由$fp变量传来，而$fp变量由/tmp/tuisongl.txt这个文件传递而来\n\n   修复方案：  获取到文件内容之后过滤常见符号，例如引号，空格，<>符号等等   版权声明：转载请注明来源 LinE@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2013-09-04 14:49 厂商回复： 感谢友情提供，爱快是一家开放的创业公司，虽然没钱，但我们更注重安全，如果发现我们有漏洞，欢迎提交或联系话事人：1808663661 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-03 15:17 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  厂商的回复好有爱······    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}