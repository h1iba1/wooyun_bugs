{"id": 50338, "wybug_id": "wooyun-2014-078074", "wybug_title": "无忧企业网站系统绕过防御注入4枚", "wybug_corp": "无忧网络", "wybug_author": "Xser", "wybug_date": "2014-11-03 10:43", "wybug_open_date": "2015-02-01 10:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-01：\t细节向公众公开  简要描述： 我还以为asp程序比php安全，结果一看，一堆注入。一个个上报麻烦，一次来个大集合！无忧企业网站系统V2014.9.30 更新日志： 修复下载中心链接功能，修复产品添加功能。 软件类别: 国产软件 | 企业政府 在中国站长源码下载的 可能危害到政府 详细说明：  第一处：/CompVisualizeBig.asp中\n<%dim idid=request.QueryString(\"id\")%><%set rs=server.CreateObject(\"adodb.recordset\")rs.open \"select * from CompVisualize where id=\"&id,conn,1,1%>\nid没有过滤-------------------------------------第二处在/DownloadShow.asp中\n<%ShowSmallClassType=ShowSmallClassType_Articledim IDID=trim(request(\"ID\"))if Id=\"\" then\tresponse.Redirect(\"Download.asp\")end ifsql=\"select * from Download where ID=\" & ID & \"\"Set rs= Server.CreateObject(\"ADODB.Recordset\")rs.open sql,conn,1,3if rs.bof and rs.eof then  response.write\"<SCRIPT language=JavaScript>alert('找不到此下载！');\"  response.write\"javascript:history.go(-1)</SCRIPT>\"else  rs(\"Hits\")=rs(\"Hits\")+1  rs.update%>\nid没有过滤-------------------------第三处在/News_search.asp中\n<%key=Trim(request(\"key\"))otype=Trim(request(\"otype\"))BigClass=request(\"BigClass\")if key=\"\" then   response.write \"<script>alert('查找字符串不能为空！');history.back();</Script>\"   response.endend if%>                                 <% Set rs= Server.CreateObject(\"ADODB.Recordset\")if otype=\"title\" thensql=\"select * from NEWS where title Like '%\"& key &\"%' order by id desc\"elseif otype=\"msg\" thensql=\"select * from NEWS where content Like '%\"& key &\"%' order by id desc\"elseend ifrs.open sql,conn,1,1if rs.eof and rs.bof thenresponse.write \"<p align='center'>对不起，没有找到相关新闻</p>\"else%>\nkey值没有过滤-------------------第四处在/NewsClass.asp中\n<% BigClass=request(\"BigClass\")SmallClass=request(\"SmallClass\")%>            <% page=clng(request(\"page\"))\t\t Set rs=Server.CreateObject(\"ADODB.RecordSet\") if BigClass<>\"\" and SmallClass <>\"\" thensql=\"select * from news where BigClassName='\"&BigClass&\"' and SmallClassName='\"&SmallClass&\"' order by AddDate desc\"rs.Open sql,conn,1,1elseif BigClass<>\"\" thensql=\"select * from news where BigClassName='\"&BigClass&\"' order by AddDate desc\"rs.Open sql,conn,1,1end ifif rs.eof and rs.bof then  response.Write(\"暂时没有记录\")else %>\nSmallClass和BigClass都没有过滤----------------------------   漏洞证明：  \n\n第一处本地测试--------------------------------------------第二处本地测试\n\n-----------------------------------------第三处本地测试\n\n------------------第四处本地测试\n\n   修复方案：  唉，没心情看了，要是耐心看下去，保证上10个！   版权声明：转载请注明来源 Xser@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-11-07 10:54 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}