{"id": 39324, "wybug_id": "wooyun-2015-094308", "wybug_title": "某省建设工程投标站被入侵", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "酷帥王子", "wybug_date": "2015-01-28 16:51", "wybug_open_date": "2015-03-14 16:52", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-14：\t细节向公众公开  简要描述： 由整站全部是注入点引发的一次黑盒测试，成功拿下网站服务器 详细说明：  sqlmap测试注入点为http://www.sxztbw.cn:20046/newsDetail.jsp?id=10 mssql dba权限，用最新版的sqlmap发现不能使用--os-shell执行命令，提示不支持，差点就放弃，后来经过多次测试，用一个旧版本可以成功执行，既然权限是system，那么问题就简单了，思路是找到web绝对路径，那么就用 dir /S /D 命令找，先用网站上传点上传一个jsp的jpg文件，然后执行 dir /S /D d:\\2014050xxoo.jpg <1.txt这里只是举个例子，然后执行结果就在system32目录下，用type命令可以查询，我这里执行回显了如图：\n\n注： dir /S /D d:\\2014050xxoo.jpg <1.txt 这里可以分别列c、d、e都可以列，这个命令适合注入点为盲注，速度慢的时候，这个命令还是相当快速的。。\n\n获取到网站路径，由于权限是system，可以直接用copy命令改jpg为jsp或者想要的格式如图：\n\n注意：有空格和&连接符的时候记得要把路径用双引号括起来，否则不成功然后用lcx反弹出来，激活guest账号进服务器，内网服务器很卡，其实还可以试试sqlmap的另一个上传方法上传，因为权限大嘛，笔者在这里就不做测试了。。。如图：\n\n   漏洞证明：  \n\n   修复方案：  请管理员尽快修复吧，最好换一套CMS，这个漏洞实在太多了，还有列目录漏洞，不过上传漏洞倒是不存在，笔者已测试，笔者没什么恶意，请管理员自行清理后门程序。。。   版权声明：转载请注明来源 酷帥王子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-02-02 08:44 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT下发给山西分中心,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-02 10:57 |    \t\t酷帥王子 \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:34        | 天朗日清，和风送闲，可叹那俊逸如我顾影自...)\t\t \n  哈哈    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}