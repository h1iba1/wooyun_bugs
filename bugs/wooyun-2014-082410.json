{"id": 43549, "wybug_id": "wooyun-2014-082410", "wybug_title": "youdiancms存储型XSS可盲打后台", "wybug_corp": "youdiancms", "wybug_author": "wutongyu", "wybug_date": "2014-11-10 15:17", "wybug_open_date": "2015-02-08 15:18", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-10：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-02-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 某处没有过滤导致可以盲打后台 详细说明：  youdiancms是一款基于thinkphp开发的内容管理系统，但是在留言的地方没有进行很好的输出过滤，导致存在存储型xss可以盲打后台。问题文件：App\\Tpl\\Admin\\Default\\Guestbook\\index.html。因为是动态调用的，因此html没有过滤，直接导致的xss。代码出现在：202行，{$m.AllInfo}用来获取用户输入的留言内容，{$m.GuestName}获取用户名。这部分没有进行转义导致了xss。        <td style=\"text-align:left\">{$m.AllInfo}</td>        <td>{$m.MessageTime|strtotime|yd_friend_date}</td>   漏洞证明：  留言之后在后台触发：\n\n打cookie也没问题。\n\n\n\n又因为cookie没有http-only，所以直接打了就能拿来用了：\n\n   修复方案：  对输出数据过滤，thinkphp有过滤机制，直接拿来用就可以了。   版权声明：转载请注明来源 wutongyu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}