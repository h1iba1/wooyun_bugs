{"id": 55721, "wybug_id": "wooyun-2014-060113", "wybug_title": "PHPMYWIND V5.0 Sql Injection 两处。", "wybug_corp": "phpmywind.com", "wybug_author": "′雨。", "wybug_date": "2014-05-09 22:56", "wybug_open_date": "2014-08-07 22:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-07：\t细节向公众公开  简要描述： 看到更新了 我再来看看。一个文件中。 详细说明：  在member.php中\nelse if($a == 'savefavorite'){\t$aid   = isset($aid)   ? intval($aid)   : '';\t$molds = isset($molds) ? intval($molds) : '';\t$link  = isset($_SERVER['HTTP_REFERER']) ? htmlspecialchars($_SERVER['HTTP_REFERER']) : '';\t\tif($aid == '' or $molds == '' or $link == '')\t{\t\theader('location:?c=default');\t\texit();\t}\t$r = $dosql->GetOne(\"SELECT `id`,`expval`,`integral` FROM `#@__member` WHERE `username`='$c_uname'\");\t$uid   = $r['id'];\t$uname = $c_uname;\t$time  = time();\t$ip    = GetIP();\t$r2 = $dosql->GetOne(\"SELECT `aid`,`molds` FROM `#@__userfavorite` WHERE `aid`=$aid and `molds`=$molds\");\tif(!is_array($r2))\t{\t\t$dosql->ExecNoneQuery(\"INSERT INTO `#@__userfavorite` (aid,molds,uid,uname,link,time,ip,isshow) VALUES ('$aid','$molds','$uid','$uname','$link','$time','$ip','1')\");\n在这里$link是referer  这里跟之前版本的不同的就是 这里的referer 经过了htmlspecialchars的处理。但是在这里htmlspecialchars的quotestyle是没有设置的, 就是为默认的。默认的为ENT_COMPAT。  这个是只会对双引号编码, 而不会对单引号编码。所以可以继续来注入了。第二处在也member.php中在保存评论的时候 跟这个的原理一样 就不多说了。\n//保存评论else if($a == 'savecomment'){\t//是否开去文章评论功能\tif($cfg_comment == 'N') exit();\t//初始化参数\t$aid   = isset($aid)   ? intval($aid)   : '';\t$molds = isset($molds) ? intval($molds) : '';\t$body  = isset($body)  ? htmlspecialchars($body) : '';\t$link  = isset($_SERVER['HTTP_REFERER']) ? htmlspecialchars($_SERVER['HTTP_REFERER']) : '';\n   漏洞证明：  \n\n   修复方案：  过滤。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-05-10 09:00 厂商回复： 感谢提交，我们会尽快修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-10 00:28 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n  又不带我。    \n     2014-10-14 17:22 |    \t\tlinadmin \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:30        | 低调进取，低调为人)\t\t \n  可否请教下phpmywind的那个SQL语句过滤程序CheckSql怎么绕过。。发现了一小波漏洞，可是都被CheckSql给禁掉了。。    \n     2014-10-14 17:29 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @linadmin   80sec ids绕过 百度有    \n     2014-10-14 17:54 |    \t\tlinadmin \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:30        | 低调进取，低调为人)\t\t \n  @′  雨。 多谢啦    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}