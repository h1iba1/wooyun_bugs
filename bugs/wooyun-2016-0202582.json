{"id": 87695, "wybug_id": "wooyun-2016-0202582", "wybug_title": "韵达快递某站命令执行直入内网                                      ", "wybug_corp": "韵达快递", "wybug_author": "卡卡", "wybug_date": "2016-04-28 09:44", "wybug_open_date": "2016-06-12 19:20", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-12：\t细节向公众公开  简要描述： 好久没冒泡了 详细说明：  漏洞站点\nhttp://soa.dongputech.com:7010/\n存在weblogic反序列化漏洞\n\ncat /usr/local/nginx/conf/nginx.conf\nworker_processes  4;google_perftools_profiles /tmp/tcmalloc; events {    worker_connections  8192;}http {\t# 1 ip    geo $limited {        default          1;        127.0.0.1/32     0;        10.0.0.0/16      0;        10.3.0.0/16      0;        10.4.0.0/16      0;        10.10.0.0/16     0;        192.168.1.0/24   0;        192.168.105.0/24 0;        58.40.18.71/32   0;        218.83.242.38/32 0;        116.228.72.131   0;        222.72.45.34    0;        211.103.142.2/32 0;    }    map $limited $limit {        1        $binary_remote_addr;        0        \"\";    }    limit_req_zone $limit zone=one:10m rate=300r/m;    limit_req zone=one burst=20;\t# 2 config    include       mime.types;    default_type  application/octet-stream;    sendfile        on;    keepalive_timeout  65;    server_tokens off;\t\t# 3 zip    gzip              on;    gzip_min_length   4096;    gzip_buffers      4 8k;    gzip_types        text/* text/css application/javascript application/x-javascript;    gzip_comp_level   1;    gzip_vary         on;    gzip_http_version 1.1;\t\t# 4 server    server {        listen       11113;        server_name  localhost;        root         /yd;        access_log   /dev/null;        error_log    /dev/null;        index  index.php;                error_page   500 502 503 504  /50x.html;        location = /50x.html {            root   html;        }\t\t\t\t# 5 filter\t\tif ($request_uri ~* \"(cost\\()|(concat\\()\") {\t\t\t\treturn 404;\t\t}\t\tif ($request_uri ~* \"[+|(%20)]union[+|(%20)]\") {\t\t\t\treturn 404;\t\t}\t\tif ($request_uri ~* \"[+|(%20)]and[+|(%20)]\") {\t\t\t\treturn 404;\t\t}\t\tif ($request_uri ~* \"[+|(%20)]select[+|(%20)]\") {\t\t\t\treturn 404;\t\t}\t\tif ( $query_string ~* \".*[\\;'\\<\\>].*\" ){\t\t\t\treturn 404;\t\t}\t\t\t\t# 6 match        location ~ \\.jsp$ {            proxy_set_header Host $host:11113;            proxy_set_header X-Real-IP $remote_addr;            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;            proxy_pass   http://127.0.0.1:7001;        }\t\t        location ~ \\.(js|htm|html|xml|txt|jpg|gif|png|css|ico|xsl|swf|zip|exe|doc|docx|xls|xlsx)$        {            expires  1h;        }\t\t# 7 status        location /nginx_status {                stub_status on;                access_log off;                allow 10.0.2.0/24;                deny all;        }    }}\n系统自带nmap，可直接进行扫描。架设socks可进一步对内网进行渗透，就不深入了   漏洞证明：  \n\ncat /usr/local/nginx/conf/nginx.conf\nworker_processes  4;google_perftools_profiles /tmp/tcmalloc; events {    worker_connections  8192;}http {\t# 1 ip    geo $limited {        default          1;        127.0.0.1/32     0;        10.0.0.0/16      0;        10.3.0.0/16      0;        10.4.0.0/16      0;        10.10.0.0/16     0;        192.168.1.0/24   0;        192.168.105.0/24 0;        58.40.18.71/32   0;        218.83.242.38/32 0;        116.228.72.131   0;        222.72.45.34    0;        211.103.142.2/32 0;    }    map $limited $limit {        1        $binary_remote_addr;        0        \"\";    }    limit_req_zone $limit zone=one:10m rate=300r/m;    limit_req zone=one burst=20;\t# 2 config    include       mime.types;    default_type  application/octet-stream;    sendfile        on;    keepalive_timeout  65;    server_tokens off;\t\t# 3 zip    gzip              on;    gzip_min_length   4096;    gzip_buffers      4 8k;    gzip_types        text/* text/css application/javascript application/x-javascript;    gzip_comp_level   1;    gzip_vary         on;    gzip_http_version 1.1;\t\t# 4 server    server {        listen       11113;        server_name  localhost;        root         /yd;        access_log   /dev/null;        error_log    /dev/null;        index  index.php;                error_page   500 502 503 504  /50x.html;        location = /50x.html {            root   html;        }\t\t\t\t# 5 filter\t\tif ($request_uri ~* \"(cost\\()|(concat\\()\") {\t\t\t\treturn 404;\t\t}\t\tif ($request_uri ~* \"[+|(%20)]union[+|(%20)]\") {\t\t\t\treturn 404;\t\t}\t\tif ($request_uri ~* \"[+|(%20)]and[+|(%20)]\") {\t\t\t\treturn 404;\t\t}\t\tif ($request_uri ~* \"[+|(%20)]select[+|(%20)]\") {\t\t\t\treturn 404;\t\t}\t\tif ( $query_string ~* \".*[\\;'\\<\\>].*\" ){\t\t\t\treturn 404;\t\t}\t\t\t\t# 6 match        location ~ \\.jsp$ {            proxy_set_header Host $host:11113;            proxy_set_header X-Real-IP $remote_addr;            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;            proxy_pass   http://127.0.0.1:7001;        }\t\t        location ~ \\.(js|htm|html|xml|txt|jpg|gif|png|css|ico|xsl|swf|zip|exe|doc|docx|xls|xlsx)$        {            expires  1h;        }\t\t# 7 status        location /nginx_status {                stub_status on;                access_log off;                allow 10.0.2.0/24;                deny all;        }    }}\n   修复方案：  程序猿懂得   版权声明：转载请注明来源 卡卡@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2016-04-28 19:13 厂商回复： 感谢指出,我们将及时修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-28 20:23 |    \t\tsqlfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:663 漏洞数:83        | 慢慢来,不急)\t\t \n  66666    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}