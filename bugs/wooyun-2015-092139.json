{"id": 40223, "wybug_id": "wooyun-2015-092139", "wybug_title": "MoMoCMS_v3.1重装系统", "wybug_corp": "youyax.com", "wybug_author": "沦沦", "wybug_date": "2015-01-26 11:56", "wybug_open_date": "2015-04-02 10:23", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-26：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向公众公开  简要描述： MoMoCMS_v3.1重装系统 详细说明：   MoMoCMS_v3.1企业建站系统Install/index.php里没有进行判断lock，你们能判断一下lock吗？在install/index.php\n<script type=\"text/javascript\">$(document).ready(function(){\t\t/* setup navigation, content boxes, etc... */\t\t// validate signup form on keyup and submit\tvar validator = $(\"#loginform\").validate({\t\trules: {\t\t\tdb_host: \"required\",\t\t\tdb_name: \"required\",\t\t\tdb_user: \"required\",\t\t\tdb_prefix: \"required\",\t\t\tadmin: \"required\",\t\t\tpassword: \"required\",\t\t\turl: \"required\"\t\t},\t\tmessages: {\t\t\tdb_host: \"数据库地址必填\",\t\t\tdb_name: \"数据库名必填\",\t\t\tdb_user: \"数据库用户名必填\",\t\t\tdb_prefix: \"数据表前缀必填\",\t\t\tadmin: \"管理员账号必填\",\t\t\tpassword: \"管理员密码必填\",\t\t\turl: \"网站首页地址必填\"\t\t},\t\t// the errorPlacement has to take the layout into account\t\terrorPlacement: function(error, element) {\t\t\terror.insertAfter(element.parent().find('label:first'));\t\t}\t});});</script></head><body>\t<!-- Header -->\t<header id=\"top\">\t\t<div class=\"wrapper-login\">\t\t\t<!-- Title/Logo - can use text instead of image -->\t\t\t<div id=\"title\"><img SRC=\"../resource/logo.gif\" /><!--<span>Administry</span> demo--></div>\t\t\t<!-- Main navigation -->\t\t\t<nav id=\"menu\">\t\t\t\t<ul class=\"sf-menu\">\t\t\t\t\t<li class=\"current\"><a href=\"javascript:;\">安装界面</a></li>\t\t\t\t</ul>\t\t\t</nav>\t\t</div>\t</header>\t<!-- End of Header -->\t<!-- Page title -->\t<div id=\"pagetitle\">\t\t<div class=\"wrapper-login\"></div>\t</div>\t<!-- End of Page title -->\t\t<!-- Page content -->\t<div id=\"page\">\t\t<!-- Wrapper -->\t\t<div class=\"wrapper-login\">\t\t\t\t<!-- Login form -->\t\t\t\t<section class=\"full\">\t\t\t\t\t\t\t\t\t\t<h3></h3>\t\t\t\t\t<div class=\"box box-info\">欢迎使用MoMoCMS, 请完成下面的安装<br>为更好的体验，默认带上安装数据包</div>\t\t\t\t\t<form id=\"loginform\" enctype=\"multipart/form-data\" method=\"post\" action=\"./install_do.php\" target=\"hiddenframe\" onsubmit=\"document.documentElement.scrollTop = document.body.scrollTop =0;\">\t\t\t\t\t<iframe id=\"hiddenframe\" name=\"hiddenframe\" style=\"width:0;height:0;\"></iframe>\t\t\t\t\t\t<p>\t\t\t\t\t\t\t<label class=\"required\">数据库地址:</label><br/>\t\t\t\t\t\t\t<input type=\"text\" id=\"db_host\" class=\"full\" value=\"localhost\" name=\"db_host\"/>\t\t\t\t\t\t</p>\t\t\t\t\t\t\t\t\t\t\t\t<p>\t\t\t\t\t\t\t<label class=\"required\">数据库名:</label><br/>\t\t\t\t\t\t\t<input type=\"text\" id=\"db_name\" class=\"full\" value=\"momocms\" name=\"db_name\"/>\t\t\t\t\t\t</p>\t\t\t\t\t\t<p>\t\t\t\t\t\t\t<label class=\"required\">数据库用户名:</label><br/>\t\t\t\t\t\t\t<input type=\"text\" id=\"db_user\" class=\"full\" value=\"root\" name=\"db_user\"/>\t\t\t\t\t\t</p>\t\t\t\t\t\t<p>\t\t\t\t\t\t\t<label>数据库密码:</label><br/>\t\t\t\t\t\t\t<input type=\"password\" id=\"db_psw\" class=\"full\" value=\"root\" name=\"db_psw\"/>\t\t\t\t\t\t</p>\t\t\t\t\t\t<p>\t\t\t\t\t\t\t<label class=\"required\">数据表前缀:</label><br/>\t\t\t\t\t\t\t<input type=\"text\" id=\"db_prefix\" class=\"full\" value=\"momo_\" name=\"db_prefix\"/>\t\t\t\t\t\t</p>\t\t\t\t\t\t<p>\t\t\t\t\t\t\t<label class=\"required\">管理员帐号:</label><br/>\t\t\t\t\t\t\t<input type=\"text\" id=\"admin\" class=\"full\" value=\"\" name=\"admin\"/>\t\t\t\t\t\t</p>\t\t\t\t\t\t<p>\t\t\t\t\t\t\t<label class=\"required\">管理员密码:</label><br/>\t\t\t\t\t\t\t<input type=\"password\" id=\"password\" class=\"full\" value=\"\" name=\"password\"/>\t\t\t\t\t\t</p>\t\t\t\t\t\t<!--<p>\t\t\t\t\t\t\t<label class=\"required\">管理员邮箱:</label><br/>\t\t\t\t\t\t\t<input type=\"text\" id=\"email\" class=\"full\" value=\"\" name=\"email\"/>\t\t\t\t\t\t</p>-->\t\t\t\t\t\t<p>\t\t\t\t\t\t\t<label class=\"required\">网站首页地址(带上http://):</label><br/>\t\t\t\t\t\t\t<input type=\"text\" id=\"url\" class=\"full\" value=\"\" name=\"url\"/>\t\t\t\t\t\t</p>\t\t\t\t\t\t<p>\t\t\t\t\t\t\t<input type=\"submit\" class=\"btn btn-green big\" value=\"创建安装\"/> \t\t\t\t\t\t</p>\t\t\t\t\t\t<div class=\"clear\">&nbsp;</div>\t\t\t\t\t</form>\t\t\t\t\t\t\t</section>\n没有进行判断lock 。可以直接重装   漏洞证明：  \n\n现在我就拿几个站点来做实例吧：\nhttp://www.xinhansy.com/install/http://www.dinghuiex.com/install/http://www.jincangyuan.com/install/http://www.52yuliao.com/install/http://ddgg.info/install/http://sddy888.com/install/http://www.hbmadao.com/install/http://vsobao.gotoip2.com/install/http://www.vsobao.com/install/http://www.whdingsheng.net/install/http://gongsi.youol.com/install/\n以上的都可以进行重装系统http://www.xinhansy.com/install/\n\nhttp://www.dinghuiex.com/install/\n\nhttp://www.jincangyuan.com/install/\n\nhttp://www.52yuliao.com/install/\n\nhttp://ddgg.info/install/\n\n   修复方案：  在安装完成之后 生成一个lock然后在安装的时候判断是否已经有locak如果有lock就退出。或者安装完成之后自动删掉install文件   版权声明：转载请注明来源 沦沦@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-04-02 10:23 厂商回复： 安装说明.txt下有，当你安装到目录后，首先运行http://localhost/momocms/install 进行安装，安装完成后，请删除install文件夹 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-29 23:29 |    \t\t′雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @YouYaX 又不是每个人都会注意看到那里。   总会有人遗忘去删除,要不就自己写代码自动删除install 要不就老老实实写个lock 判断是否有安装。    \n     2015-01-30 11:14 |    \t\t沦沦 \t\t\t( 普通白帽子  |\t\t\t        Rank:504 漏洞数:127        | 爱老婆，爱生活)\t\t \n  @′雨。 说的对雨：）    \n     2015-04-28 19:12 |    \t\t不能忍 \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:16        | 不要关注我，给我钱就好。)\t\t \n  5555555555555，为什么这漏洞我在补天提交的时候被人拒绝了,说这类漏洞他们不关注，你这里就给过了，还给钱。这不公平！！！    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}