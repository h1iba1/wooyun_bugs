{"id": 5289, "wybug_id": "wooyun-2013-047118", "wybug_title": "php云人才系统任意文件删除漏洞", "wybug_corp": "php云人才系统", "wybug_author": "neal", "wybug_date": "2013-12-26 21:19", "wybug_open_date": "2014-03-26 21:19", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-30：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-02-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-26：\t细节向公众公开  简要描述：    一处代码逻辑有问题,导致任意文件删除漏洞. 2.5版本测试成功 3.0最新版本测试成功 算通用吧? 直接删除了 wafphp. 导致后面的注入 详细说明：    问题出在 /model/model/index.class.php   \n\n  delfiledir  这个function就不详细看了 就传个路径过去 直接删除.  利用很简单.  看下$this->uid  的获取方式   /model/class/common.php  22行.   $this->uid=$_COOKIE['uid'];  直接在cookie里面取.  虽然自己写的有过滤器 但是利用的数据根本不在过滤的范围内.    漏洞证明：    利用方法:  1.  先注册个会员 登陆 默认显示基本信息 问题也出在基本信息 然后在cookie里面的uid 后面加上 /../../../data/db.safety.php \n\n  2. 随便填数据 然后点击保存 即可删除 db.safety.php.    修复方案：     加个判断吧.   版权声明：转载请注明来源 neal@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-12-27 11:03 厂商回复： 感谢您的提供！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-27 00:28 |    \t\t船长 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:4        )\t\t \n  厉害啊  http://heigouqi.z5it.com    \n     2013-12-27 07:46 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  好nb关注    \n     2013-12-27 12:11 |    \t\tneal \t\t\t( 普通白帽子  |\t\t\t        Rank:219 漏洞数:23        )\t\t \n  早知道，我就不找注入了，我就怕说一个任意文件删除影响太小，我就找了sql注入，然后找了拿shell方法， 哎呀我去，分开发居然不过。好吧。白担心了    \n     2013-12-27 12:13 |    \t\tneal \t\t\t( 普通白帽子  |\t\t\t        Rank:219 漏洞数:23        )\t\t \n  拿shell前提就是利用此漏洞删除过滤文件。所以该漏洞影响很大的，而且是所以版本通杀。    \n     2013-12-28 21:47 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  @neal 我也找到一个任意删除，不知道和楼主的是否一样，如果不一样就能提交了。求PM……    \n     2013-12-29 07:08 |    \t\tneal \t\t\t( 普通白帽子  |\t\t\t        Rank:219 漏洞数:23        )\t\t \n  @phith0n 已经发布补丁了，你可以去看    \n     2013-12-29 22:40 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  @neal 一样的……哭了    \n     2014-01-16 11:15 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  我去 难道ID 都没有判断，，岂不是还可以伪造成为其他用户！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}