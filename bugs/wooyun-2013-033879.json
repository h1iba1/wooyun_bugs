{"id": 9448, "wybug_id": "wooyun-2013-033879", "wybug_title": "珍品网订单在线支付漏洞", "wybug_corp": "珍品网", "wybug_author": "xfkxfk", "wybug_date": "2013-08-09 11:54", "wybug_open_date": "2013-09-23 11:55", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "认证设计不合理", "设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-23：\t细节向公众公开  简要描述： 珍品网设计不当，存在支付漏洞，好贵的奢侈品，任意买 详细说明：  此问题是在当你买东西时，先不要立即购买，把物品先添加到购物车，添加时，抓包，修改商品数量为负数，虽然修改后页面会提示错误，还但是成功添加，而且在最后，结算时，此商品的价钱就会变成0，不知道为什么。所以正常购买，抓包，修改数据，是不允许修改的，但是通过购物车后就会存在此问题。我们购买两个物品，第二个通过上面方法，先加入购物车，物品id=2337\n\n然后抓包修改数量为负数\n\n结算时就会发现物品金额变成0，两个物品就算了一个物品的金额\n\n而且订单成功提交\n\n   漏洞证明：  利用上面的方法，我们买两个，一个便宜的，一个贵的，然后可以支付一个便宜的金额就可以买两件物品。\n\n订单成功提交\n\n最后，我们看看能不能支付\n\n哈拉，也可以成功支付金额。这样就可以不用怕很贵的礼品买不起啦!   修复方案：  虽然限制了商品数量不能为负数，但是在最后并没有拒绝提交，还能成功支付。重新限制数量，然后看下逻辑问题。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-08-09 12:38 厂商回复： 十分感谢作者xfkxfk，已联系相关部门处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}