{"id": 40961, "wybug_id": "wooyun-2015-090357", "wybug_title": "LebiShop系统sql注入", "wybug_corp": "www.lebi.cn", "wybug_author": "hello", "wybug_date": "2015-01-15 10:43", "wybug_open_date": "2015-04-15 10:44", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-15：\t细节向公众公开  简要描述： 官网 http://www.lebi.cn/demo站点 http://demo.lebi.cn/ 详细说明：  用google搜索 关键词 intext:Powered by LebiShop或者google搜索关键词Powered by LebiShop inurl:Category.aspx部分案例\nhttp://168dev.com/lebishop/Category.aspxhttp://oa.psy123.com.cn/AllCategories.aspxhttp://www.huacaiye.com/Category.aspx?tid=1http://daiba.com.cn/Category.aspx?id=9http://hkapp.cn/EN/Category.aspx?id=10http://54mbb.com/EN/NewsDetails.aspx?id=5http://shop.lutoog.com/Brand.aspx?id=189http://queengift.net/EN/Brand.aspx?id=190http://www.snsrn.com/en/http://www.skycastle100.com/Search.aspx?keyword=lianyiquanhttp://71pg.com/Category.aspx?tid=35http://www.rft.net.cn/Search.aspx?keyword=[key]&sort=1&page=2http://lovedou.com/en/http://www.woofoo51.com/EN/Category.aspx?id=111&pid=0&sort=1&tid=0&page=1http://newautoch.com/NewsDetails.aspx?id=5http://memy.cc/http://www.thanks789.com/Brand.aspx?id=191http://m.gzyytz.cn/http://www.thanks789.com/Brand.aspx?id=191\n漏洞地址\nhttp://demo.lebi.cn/ajax/Ajax_userin.aspx\n\npublic void LikeToBasket(){    string str = RequestTool.RequestString(\"id\"); //只对单引号进行处理    string str2 = \"\";    if (str != \"\")    {        foreach (Lebi_User_Product product in B_Lebi_User_Product.GetList(string.Concat(new object[] { \"(Type_id_UserProductType=141 or Type_id_UserProductType=144) and User_id=\", base.CurrentUser.id, \" and id in (\", str, \")\" }), \"\")) //存在注入        {            Lebi_User_Product model = B_Lebi_User_Product.GetModel(string.Concat(new object[] { \"User_id=\", base.CurrentUser.id, \" and product_id=\", product.Product_id, \" and type_id_UserProductType=142\" }));            if (model != null)            {                model.count = product.count;                B_Lebi_User_Product.Update(model);            }            else            {                product.Type_id_UserProductType = 0x8e;                product.count = product.count;                B_Lebi_User_Product.Add(product);            }        }        str2 = string.Concat(new object[] { base.Tag(\"商品已加入购物车\"), \"<div>\", base.Tag(\"数量\"), \" <span>\", base.Basket_Product_Count(), \"</span> \", base.Tag(\"件\"), \" <span>\", base.FormatMoney(base.Basket_Product_Price()), \"</span></div><div><a href='\", base.URL(\"P_Basket\", \"\"), \"' class='btn btn-7'><s></s>\", base.Tag(\"查看购物车\"), \"</a>  <a href='javascript:void(0)' onclick='cloesedialog();' class='btn btn-11'><s></s>\", base.Tag(\"关闭\"), \"</a></div>\" });    }    base.Response.Write(string.Concat(new object[] { \"{\\\"msg\\\":\\\"OK\\\",\\\"count\\\":\\\"\", base.Basket_Product_Count(), \"\\\",\\\"amount\\\":\\\"\", base.FormatMoney(base.Basket_Product_Price()), \"\\\",\\\"mes\\\":\\\"\", str2, \"\\\",\\\"url\\\":\\\"\", base.URL(\"P_AddToBasket\", \"\"), \"\\\"}\" }));}\n   漏洞证明：  漏洞证明先注册账号登陆  http://demo.lebi.cn/Register.aspxtest333 密码111111注册登陆后访问  \nhttp://demo.lebi.cn/ajax/Ajax_userin.aspx\npost提交\n__Action=LikeToBasket&id=@@version\n\n\n   修复方案：  对id进行处理   版权声明：转载请注明来源 hello@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-01-15 17:09 厂商回复： 感谢关注 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}