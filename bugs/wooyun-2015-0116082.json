{"id": 30645, "wybug_id": "wooyun-2015-0116082", "wybug_title": "七匹狼官方商城可重置任意用户密码", "wybug_corp": "七匹狼官方商城", "wybug_author": "路人甲", "wybug_date": "2015-06-03 14:31", "wybug_open_date": "2015-07-18 14:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-03：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 使用找回密码链接重置用户密码时，可以修改为其他用户的邮箱，密码修改成功 详细说明：  七匹狼官方商城用户还是很多，只支持使用邮箱注册，大部分用户都使用的是QQ邮箱，虽然进行了匿名化处理，很容易暴力猜解，在找回密码时，缺少逻辑判断，导致出现该漏洞   漏洞证明：  Step1：首先输入购物系统中已经存在的邮箱，得到当前系统中已经注册过邮箱的正常响应\n\nStep2：在购物系统中查看用户的购买记录或者购买评论，虽然进行了必要的匿名化处理，但是大部分使用的是QQ邮箱，而且知道了前面的6位数字，那么就很容易使用burpsuite暴力猜解出已经注册的邮箱，过程如下，请看截图：\n\n\n\n\n\n\n\nStep3：使用自己已经注册过的邮箱，发送验证码到自己的邮箱\n\nStep4：问题就出在这一步，登录邮箱，打开重置密码的链接，输入需要修改的密码，拦截请求，将请求中的邮箱修改为我们第二步猜解到的邮箱，修改成功\n\n\n\n\n\nStep5：使用该用户登录，可以查看到购买记录\n\n   修复方案：  增加判断条件   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}