{"id": 77187, "wybug_id": "wooyun-2015-0163091", "wybug_title": "四川省住房和城乡建设厅建设单位项目管理信息系统SQL注入漏洞（DBA权限）", "wybug_corp": "四川省住房和城乡建设厅", "wybug_author": "honey程程", "wybug_date": "2015-12-21 12:52", "wybug_open_date": "2016-02-07 17:56", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向公众公开  简要描述： 四川省住房和城乡建设厅的建设单位项目管理信息系统密码找回功能处存在SQL注入漏洞。 详细说明：  四川省住房和城乡建设厅的建设单位项目管理信息系统密码找回功能处存在SQL注入漏洞，连接数据库的用户dx sql_01_sql拥有DBA权限，导致可以在sqlmap中直接执行操作系统命令，且可以查看多个数据库的信息。   漏洞证明：  1、进入四川省住建厅主页，http://**.**.**.**/，找到勘查设计综合管理平台并进入到平台首页http://**.**.**.**:88/SurveyDesign/share/webside/default.aspx，然后进入建设单位项目管理信息系统首页http://**.**.**.**:88/SurveyDesign/share/webside/JSDWLogin1.aspx，点击密码找回功能，并进入到密码找回页面http://**.**.**.**:88/SurveyDesign/share/webside/FindPassword.aspx。\n\n2、参数t_FCompany与t_FJuridcialCode存在Sql注入漏洞，漏洞利用URL为http://**.**.**.**:88/SurveyDesign/share/webside/FindPassword.aspx  \"__VIEWSTATE=mkpimFMCoMuDCCDUDvR0q5yhDbPbSYzWKmiJxp3kJ%2ByCyb9OczneU40WdaoTke3cwC7uLPLb2JeVmKRWnYO6QYDl%2Fhvo%2FnExN92OIKVgbY8k1YX4BoIzsY21%2BUSbfqIdWZhH5g%3D%3D&__VIEWSTATEGENERATOR=16AB938E&t_FCompany=111&t_FJuridcialCode=111&bntGetPassWord=%C8%B7%B6%A8\"，post请求。\n\n3、DBA权限\n\n4、执行OS命令\n\n\n\n\n\n5、查看多个库\n\n   修复方案：  1、对用户提交参数进行严格过滤，防止SQL注入2、降低dx sql_01_sql用户的权限，不要以ＤＢＡ权限的用户作为应用程序连接数据库的用户3、删除xp_cmdshell扩展存储过程   版权声明：转载请注明来源 honey程程@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-12-25 11:18 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给四川分中心，由其后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}