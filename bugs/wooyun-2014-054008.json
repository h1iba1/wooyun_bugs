{"id": 4468, "wybug_id": "wooyun-2014-054008", "wybug_title": "SupperRadius企业版V3.0 SQL注射漏洞", "wybug_corp": "SupperRadius", "wybug_author": "路人甲", "wybug_date": "2014-03-19 10:16", "wybug_open_date": "2014-05-03 10:17", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-03：\t细节向公众公开  简要描述： SupperRadius企业版V3.0 SQL注射漏洞 详细说明：  家里上网用的宽带恰好是用supperradius来计费的。在企业版中的web services存在一处SQL注射漏洞，能够查询、删除、修改数据库内的账号从而达到免费上网的目的：）访问以下计费服务器地址：http://192.168.1.1/GateWay/RosApi.asmx\n\n其中的CheckLoginUser与SetUserOffLine能够注入SQL语句：http://192.168.1.1/GateWay/RosApi.asmx?op=CheckLoginUserhttp://192.168.1.1/GateWay/RosApi.asmx?op=SetUserOffLine\n\n\n\n将上面的两个POST数据包复制到burp suite中进行提交，首先是CheckLoginUser： \n\n上图中的userid与gid节点都能够实施注入，返回如下图：\n\n下面查询sr_ent_sysmember中的数据：1'and 1=(select top 1 name from sr_ent_sysmember)-- \n\n提交查询之后页面很明显的进入延迟状态，说明当前角色为sa。使用账号密码进入到后台：\n\n   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：0  确认时间：2014-03-27 08:44 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-19 10:29 |    \t\tapplychen \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:16        | 白发现首)\t\t \n  关注    \n     2014-03-30 14:12 |    \t\tLee Swagger \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:5        | 洗洗睡吧)\t\t \n  SupperRadius> In fact, find many loopholes    \n     2014-04-16 13:42 |    \t\tapplychen \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:16        | 白发现首)\t\t \n  跟我这个 WooYun: SupperRadius企业版V3.0 SQL注射漏洞 漏洞一模一样，连截图都一样还评价15rank，这咋么通过的？@疯狗    \n     2014-04-16 13:48 |    \t\taphack \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:3        | 话说当年计算机，谈论未来机器人~！)\t\t \n  @applychen 好紧张！手头0days中了吧！哈哈 O_O    \n     2014-05-03 11:39 |    \t\tKnight \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:10        | 刚刚上洗手间，看到一个玉树临风的少年，气...)\t\t \n  @applychen 我仔细地对比过截图。你不要胡说好不，人家没有全盗你截图，他只不过把你截图再剪切一下再发到乌云而已，而且他用的图片都不是从乌云下的，其中一张还有云安的水印。    \n     2014-05-03 11:41 |    \t\tKnight \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:10        | 刚刚上洗手间，看到一个玉树临风的少年，气...)\t\t \n  @xsser @疯狗 为什么抄袭的都能过？    \n     2014-05-03 17:42 |    \t\tLee Swagger \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:5        | 洗洗睡吧)\t\t \n  还有1个SupperRadius密码破解的没有放出来。。。。开发的不给力    \n     2014-05-03 17:42 |    \t\tapplychen \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:16        | 白发现首)\t\t \n   @疯狗 @xsser 再次@    \n     2014-05-04 12:12 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @applychen 收到，这个问题我们正在评估，其实漏洞的抄袭情况非常严重，目前控制到这个程度已经是很不错了，但仍会存在极少量的漏网之鱼，这个漏洞就是其一。rank和wb已经进行了回收，维护对首发者的公平公正。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 0, "Ranks": null}