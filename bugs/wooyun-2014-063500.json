{"id": 54736, "wybug_id": "wooyun-2014-063500", "wybug_title": "YXcms最新版任意文件删除漏洞", "wybug_corp": "yxcms.net", "wybug_author": "3xpl0it", "wybug_date": "2014-10-10 13:02", "wybug_open_date": "2014-10-15 13:04", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-15：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： YXcms最新版可以删除任意文件 详细说明：  问题文件：\\YXcms1.2.4\\protected\\apps\\member\\controller\\inforController.php\npublic function index()\t    {        if(!$this->isPost()){           $auth=$this->auth;           $id=$auth['id'];           $info=model('members')->find(\"id='{$id}'\");           $this->info=$info;           $this->path=__ROOT__.'/upload/member/image/';           $this->twidth=config('HEAD_W');           $this->theight=config('HEAD_H');           $this->display();        }else{           $id=intval($_POST['id']);           $data['nickname']=in(trim($_POST['nickname']));           $acc=model('members')->find(\"id!='{$id}' AND nickname='\".$data['nickname'].\"'\");           if(!empty($acc['nickname'])) $this->error('该昵称已经有人使用~');           if (empty($_FILES['headpic']['name']) === false){                $tfile=date(\"Ymd\");                $imgupload= $this->upload($this->uploadpath.$tfile.'/',config('imgupSize'),'jpg,bmp,gif,png');                $imgupload->saveRule='thumb_'.time();                $imgupload->upload();                $fileinfo=$imgupload->getUploadFileInfo();                $errorinfo=$imgupload->getErrorMsg();                if(!empty($errorinfo)) $this->alert($errorinfo);                else{                    if(!empty($_POST['oldheadpic'])){                   //只要post表单中存在oldheadpic参数，就会执行删除老图像                       $picpath=$this->uploadpath.$_POST['oldheadpic'];                       if(file_exists($picpath)) @unlink($picpath);    //可修改oldheadpic的值，删除任意文件                    }                    $data['headpic']=$tfile.'/'.$fileinfo[0]['savename'];                }                }\n   漏洞证明：  修改参数为网站中的一个文件1.txt\n\n成功删除\n\n   修复方案：  对参数进行判断。。   版权声明：转载请注明来源 3xpl0it@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-10-15 13:04 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}