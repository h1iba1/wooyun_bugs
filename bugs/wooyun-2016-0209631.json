{"id": 88295, "wybug_id": "wooyun-2016-0209631", "wybug_title": "海航集团旗下免税网站任意号码注册及任意用户登录漏洞                                      ", "wybug_corp": "hnagroup.com", "wybug_author": "loca1h0st", "wybug_date": "2016-05-17 12:43", "wybug_open_date": "2016-07-02 11:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "认证设计不合理", "设计错误", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-02：\t细节向公众公开  简要描述： 网站地址：www.mianshui365.com/m.mianshui365.com1.海航集团旗下免税网站任意号码注册及任意用户登录漏洞。 2.订单遍历漏洞 3.手机号码明文泄漏 4.身份证号码加*的逻辑有问题 5.个人资料页面身份证号码、手机号码明文显示 营销活动能不能靠谱点 详细说明：  网站地址：www.mianshui365.com/m.mianshui365.com手机收到推送消息，免税易购要包机送优惠卷。 一、任意号码注册 进入活动页面发现只要输入手机号码就能注册会员，都不用验证。且发现密码是手机号码的第4-9位，6个数字。 示范： URL：http://m.mianshui365.com/index.php?_a=charter&_c=active&partner_id=51&pid=706&step=2 随便输入一个手机号码，即可注册一个会员领券。 当然这个洞当前看起来没什么卵用就是了。。 step1 \n\n step2 \n\n 二、任意号码快速登录+订单中手机号码、身份证号码明文泄漏本来写这个洞的时候是想说找快捷注册或者找回密码的点的因为这个网站的短信验证码只有4位数字，很容易爆破，然后突然发现我有了第一步的东西，为什么不直接用一个已有的手机号码，直接快速登录呢？万一可行呢？对吧。 证明： 直接输入一个已有的手机号码（我的），完成领券后进入个人中心查看下 step1: \n\n step2（直接登录了已有的会员帐号）: \n\n step3（订单查看，身份证号码及手机号码都是明文显示）: \n\n 三、订单遍历漏洞按理说到这一步就结束了，但是看着URL中带着一个明晃晃的orderId，不遍历试一下不爽。 copy所有的数据进工具，遍历下试试先。 这里发现一个问题。。正常的订单页面的身份证号码是加*的。。未验证的订单页面身份证号码是明文的。。 不过问题不大，页面的身份证加*的地方是人的生日区域，这个社工库里匹配下问题不大（如果不是，社工牛请别黑我。。） 1.页面加*的区域 \n\n 2.copy访问订单页面的http信息进入工具遍历试试 \n\n 3.结果（订单可被遍历） \n\n 这个时候再结合2，则可以进入这个手机号码的账户到第四部。。 四、PC端个人信息页面身份证号码明文显示 这个地方一般是依赖用户自己去填写，但是也算一个小bug吧，毕竟万一填了，然后万一被直接重置密码进入账户了，就万一被泄漏了身份证信息。 \n\n   漏洞证明：  见漏洞详情   修复方案：  你们比我懂   版权声明：转载请注明来源 loca1h0st@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2016-05-18 10:52 厂商回复： 谢谢，我们会立即安排整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}