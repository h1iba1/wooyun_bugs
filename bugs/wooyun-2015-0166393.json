{"id": 74079, "wybug_id": "wooyun-2015-0166393", "wybug_title": "58同城员工私搭Tomcat被Getshell影响内网安全", "wybug_corp": "58同城", "wybug_author": "路人甲", "wybug_date": "2015-12-31 14:34", "wybug_open_date": "2016-02-12 18:49", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-12：\t细节向公众公开  简要描述： 内部员工搭建tomcat未删除关键目录 详细说明：  发现58同城测试环境有一处tomcat的弱口令http://testcmbc.58v5.cn/manager/\ntomcat：tomcat\n\n\n登录进去找到上传点\n\n上传jsp大马\n\n但是大马有点问题。。。上传上去的文件并不能用。。。又自己找了一个小马上传上去\n\n接着上传一个可以连接菜刀的马\n\n感觉有点绕了。。。直接反弹shell吧。。。但是发现木有nc上传一个netcat到服务器反弹shell成功\n\n然后挂代理，然后扫描内网发现大量在线机器\n\n   漏洞证明：  \n\n   修复方案：  严禁私自搭建tomcat，看看司马大牛做的密码弱口令规范   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-01-04 09:44 厂商回复： 感谢对58安全的关注 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-31 15:07 |    \t\t诚殷的小白帽 \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:25        )\t\t \n  骚年你这样告状好莫...    \n     2015-12-31 15:28 |    \t\t哈兹本德 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:2        | 哎呀，菜鸟一枚。)\t\t \n  是tomcat manager 吗    \n     2015-12-31 16:18 |    \t\t番茄师傅 \t\t\t( 普通白帽子  |\t\t\t        Rank:346 漏洞数:92        | http://www.tomatoyu.com/)\t\t \n  @her0ma  干活了~    \n     2015-12-31 16:36 |    \t\tsol0king \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:1        | 膜拜大牛)\t\t \n  @哈兹本德 恩，是的    \n     2016-01-03 19:16 |    \t\t路人毛 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:25        | ../)\t\t \n  你知道你漏洞为什么没确认么？因为负责确认的员工已经被开除了    \n     2016-01-03 20:23 |    \t\t冰海 \t\t\t( 实习白帽子  |\t\t\t        Rank:80 漏洞数:8        | I can do better , why not ?)\t\t \n  本自同根生，哈哈哈哈哈哈    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}