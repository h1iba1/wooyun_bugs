{"id": 53888, "wybug_id": "wooyun-2014-066164", "wybug_title": "搜狐博客某处存储xss漏洞,影响搜狐博客用户", "wybug_corp": "搜狐", "wybug_author": "路人甲", "wybug_date": "2014-06-27 13:53", "wybug_open_date": "2014-08-11 13:54", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-11：\t细节向公众公开  简要描述： 可利用该漏洞钓鱼，可影响大量博客用户 详细说明：  问题页面存在于1、新注册用户激活页面2、个人资料设置处ps:其实应该是同一个表单\nhttp://blog.sohu.com/home/setting/info.htm\n\nxss code：\"/><svg onload=alert(/1/)>\n就这样插入了恶意代码，导致访问该主页弹框\n\n\n\n第一处插入点：\n\n第二处插入点：\n\n用小号访问该博客，继续弹\n\n再进一步测试了下看是否能够获取cookie，注册了个小号，在激活页面上插入xss code，这里是通过修改了input标签内的maxlength属性插入的\n\n然后去跟随一个好友，保证小号的状态好友能够看到，发布一条微博短消息，开始钓鱼\n\n当然还尝试了其他渠道，比如说将连接发到qq群。。。不一会儿就收到了cookie\n\n\n\n   漏洞证明：  \n\n\n\n   修复方案：  1、过滤危险标签，输入要求严格一点吧2、排查下所有站点涉及maxlength属性的input标签，是否仅仅做了前台页面对长度的限制，若是，请增加后台校验长度3、用户的cookie还是看紧点吧应该有小礼物的吧：）   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-06-27 14:29 厂商回复： 感谢对搜狐安全关注，此漏洞为重复提交 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}