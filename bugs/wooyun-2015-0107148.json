{"id": 36859, "wybug_id": "wooyun-2015-0107148", "wybug_title": "正一味高危漏洞可导致18万用户敏感信息订单泄露", "wybug_corp": "正一味", "wybug_author": "路人甲", "wybug_date": "2015-04-10 19:02", "wybug_open_date": "2015-05-25 19:04", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-10：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-05-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 罪过罪过··· 详细说明：  先道个歉，为了测试漏洞，我下了个订单，手机和邮箱还有地址都是乱写。我才知道原来订单了下了是不能删除或者取消的，除非打电话给当地分店····我没敢打啊辛苦送外卖的小伙子和浪费了那份牛肉 石锅拌饭 和五花肉 石锅拌饭对不起对不起·············   漏洞证明：  \n\n\n\n\n\n\n\n网站需要注册才能查询订单，所以问题不在这。问题出在下订单的时候，会get出去一个请求，然后返回订单确认信息。结算时会post多条请求，其中一条就有越权·看截图中的ID可以遍历\nGET /online/api/mc/order/detail.json?orderId=185165 HTTP/1.1Host: www.4008917917.cnProxy-Connection: keep-aliveAccept: */*X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.76 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8DNT: 1Referer: http://www.4008917917.cn/online/wisecommerce/order/submitSuccess.jspAccept-Encoding: gzip, deflate, sdchAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=AA10040BD6B8EE23BF129C96A72FA4F8.worker2; deliveryFee=0.00; lang=zh_CN; currentCity=%E5%8C%97%E4%BA%AC; eatingStyleEnumId=702; isCarryOut=no; queryStartCode=; deliveryAddress=****************************************\ncookie我就不公开了。   修复方案：  验证token····   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：8 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2015-04-11 21:28 |    \t\tsleep \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 不能名垂千古,亦要遗臭万年...)\t\t \n  忽略。    \n     2015-04-12 17:27 |    \t\t小孩 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | 杀器王子的小太阳)\t\t \n  洞主目测是个单身订餐狗     \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 8, "Ranks": null}