{"id": 45393, "wybug_id": "wooyun-2015-095968", "wybug_title": "国家电网某省微信密码重置逻辑漏洞可重置全省任意用户密码", "wybug_corp": "国家电网公司", "wybug_author": "Mik3y_14", "wybug_date": "2015-02-06 18:15", "wybug_open_date": "2015-03-23 18:16", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-23：\t细节向公众公开  简要描述：  详细说明：  详细看漏洞证明国家电网山西省电力公司微信公众平台密码重置功能存在设计逻辑缺陷，可对山西全省任意用户进行密码重置。从而获取用电用户的个人信息、联系方式、个人住址、用电详细情况等。   漏洞证明：  山西省电力公司微信平台如下，\n\n进入密码重置功能\n\n\n\n输入用户编号，我们随便使用某用户编号，0200269990，进入密码重置页面如下：\n\n查看该页面html源码，可以看到xg()这个函数用于控制向/wechat/gwsx/pwdReseat!yzPwd.action发送post请求，以进行短信验证码验证操作，而返回值data为1时，进入密码重置页面pwdReseat，否则提示错误。\n\n我们将该页面中if(data==1)改为永真，if(1)，可以直接绕过进行密码重置，\n\n点击获取验证码，然后输入任意验证码后进入密码重置页面，\n\n输入新密码，进行密码重置。\n\n使用重置后的密码成功绑定账户，\n\n\n\n   修复方案：  你们来吧...还有一点就是 希望Rank能给高点 这个也是对我们的一种肯定。。。谢谢。   版权声明：转载请注明来源 Mik3y_14@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-02-06 21:05 厂商回复： 谢谢 都辛苦了 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-06 22:40 |    \t\tppmars \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 业余码农)\t\t \n  你们别这样，让人回家过年吧    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}