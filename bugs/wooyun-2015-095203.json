{"id": 45587, "wybug_id": "wooyun-2015-095203", "wybug_title": "上海机场某安全系统Getshell+众多数据库信息+某分论坛权限（涉及众多飞机公司培训信息）", "wybug_corp": "上海机场(集团)有限公司", "wybug_author": "路人甲", "wybug_date": "2015-02-02 14:17", "wybug_open_date": "2015-03-19 14:18", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程命令执行", "补丁不及时"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-19：\t细节向公众公开  简要描述： 上海机场某安全系统Getshell+数据库信息+某分论坛权限（涉及众多飞机公司培训信息） 详细说明：  sms.shairport.com上海机场(集团)有限公司安全信息管理系统存在Struts命令执行漏洞\n\n\n飞机公司培训信息？\n\n\n0x02:BBS还可以登陆\nuserName=webmasteruserPassWord=1234\n\nhttp://sms.shairport.com/BBS/adminMain.bbscs\n\n\n   漏洞证明：  \n#sqlserver Configjdbc.url=jdbc:sqlserver://10.139.137.68:1433;DatabaseName=smsjavajdbc.username=sa jdbc.password=sms_18jdbc.driverClassName=com.microsoft.sqlserver.jdbc.SQLServerDriveribatis.dialect=cn.sh.cares.framework.core.dao.dialect.SQLServer2005DialectuserName=webmasteruserPassWord=1234# UC comunication settings#  # #uc server urlUC_API = http://172.20.36.70:8089/uc_server/#uc ip addressUC_IP = 172.20.36.70#keyUC_KEY = 123456#appidUC_APPID = 2#connect mode: default value is \"\"UC_CONNECT = mysqlBBS\\WEB-INF\\classes\\init.propertiesdatasource.driverClassName=com.microsoft.sqlserver.jdbc.SQLServerDriverdatasource.url=jdbc:sqlserver://10.139.137.68:1433;DatabaseName=bbscsdatasource.username=sadatasource.password=sms_18datasource.defaultAutoCommit=truedatasource.maxActive=10datasource.maxIdle=2datasource.maxWait=120000#datasource.defaultAutoCommit=true#datasource.defaultAutoCommit=falsedatasource.whenExhaustedAction=1datasource.validationQuery=select 1 from dualdatasource.testOnBorrow=truedatasource.testOnReturn=false#hibernate.dialect=net.sf.hibernate.dialect.MySQLDialecthibernate.dialect=net.sf.hibernate.dialect.SQLServerDialecthibernate.jdbc.batch_size=25hibernate.jdbc.fetch_size=50hibernate.show_sql=truehibernate.hbm2ddl.auto=create-drop\n   修复方案：  涉及数据库信息较多，具体一一排查解除。作为白帽子这是我应该做的。命令执行升级补丁。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2015-02-03 16:32 厂商回复： CNVD确认所述漏洞情况，已经由CNVD通过以往建立的处置渠道向网站管理单位通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-03 10:33 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  您好！    感谢您对CNVD的支持，请您提供详细的漏洞细节，包括：Struts命令执行漏洞的测试入口，并邮件vreport@cert.org.cn，以便CNVD及时处置。谢谢！    祝好！    \n     2015-02-03 13:05 |    \t\t黄口小儿 \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:49        | coffeesafe的号子)\t\t \n  @cncert国家互联网应急中心 您好，我已直接在乌云平台直接编辑修改了，您现在审核下。    \n     2015-02-03 15:00 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  @黄口小儿 您好，感谢您对CNVD的支持，现在依然没有查看到struts测试入口，请您邮件vreport@cert.org.cn，以便CNVD及时处置。谢谢！ 祝好！     \n     2015-02-03 15:30 |    \t\t黄口小儿 \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:49        | coffeesafe的号子)\t\t \n  @cncert国家互联网应急中心 您好，我方才通过QQ邮箱已经将测试入口以及部分细节发往您的邮箱，希望您尽快审核！    \n     2015-03-19 14:35 |    \t\tDARKSTON \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        )\t\t \n  @黄口小儿 你好,路人甲。    \n     2015-03-19 15:46 |    \t\t黄口小儿 \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:49        | coffeesafe的号子)\t\t \n  @DARKSTON 神秘的路人甲就是我！    \n     2015-03-20 09:25 |    \t\thead \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 装b都是要死的节奏)\t\t \n  路人甲 好牛逼哦    \n     2015-03-20 09:26 |    \t\thead \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 装b都是要死的节奏)\t\t \n  想拜他为师  ╮(╯▽╰)╭ 但是大神貌似不刁我    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}