{"id": 71681, "wybug_id": "wooyun-2015-0138757", "wybug_title": "优酷客户端存在高危漏洞导致低版本远程代码执行", "wybug_corp": "优酷", "wybug_author": "Moonight", "wybug_date": "2015-09-06 11:02", "wybug_open_date": "2015-12-05 17:16", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-09：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-10-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-05：\t细节向公众公开  简要描述： 优酷客户端代码逻辑存在问题导致客户端可被远程控制执行指令 详细说明：  这是一个高危漏洞，这是一个高危漏洞，这是一个高危漏洞。重要的事情说三遍，请你们一定理解清楚再评判，非常感谢这个漏洞的最终的情况是在非root的设备上，我发送一个intent，这个可以是任意应用，就可以控制整个优酷客户端，包括获取任意机密数据、执行相应逻辑等1. 优酷客户端存在导出组件com.youku.gamecenter.GameWebViewActivity2. 该组件会接收外部攻击者可控制的intent的extra参数url3. 我将url设置为自己搭建的html，这个html是可以被加载执行的\n\n4. 优酷的webview采用了addjavascriptinterface导出了gamecenter这个变量，可以利用该变量反射调用shell去远程执行代码\n\n   漏洞证明：  可以看到加载我可以控制的攻击url后，payload被执行了，执行了我示例演示的ls －l命令并输出了出来，当然也可以使用任意指令，由于是在优酷进程内做的事情，所以我也可以在非root下获取所有优酷所有敏感数据或植入加载木马等\n\n   修复方案：  1. 不要导出com.youku.gamecenter.GameWebViewActivity2. @JavascriptInterface 代替addjavascriptInterface或者不调用addjavascriptInterface   版权声明：转载请注明来源 Moonight@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-09-06 17:14 厂商回复： 感谢“Moonight”关注优酷安全！我们会尽快修复该漏洞！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-06 19:36 |    \t\tMoonight \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:7        | 无线安全攻城狮)\t\t \n  标题起错了，不是低版本，是最新版本。。。＝ ＝    \n     2015-09-10 09:10 |    \t\t有归于无 \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:18        | 有归于无)\t\t \n  赶快公开吧~~    \n     2015-09-26 19:20 |    \t\t茫茫涯 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 郑州工作，从事网络安全工作和程序设计)\t\t \n  高价收购OD 联系QQ：1291806522    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}