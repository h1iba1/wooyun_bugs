{"id": 16551, "wybug_id": "wooyun-2012-012467", "wybug_title": "PHPCMS V9 getwebshell漏洞", "wybug_corp": "phpcms", "wybug_author": "tenzy", "wybug_date": "2012-09-20 15:34", "wybug_open_date": "2012-11-04 15:34", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-10-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-10-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-11-04：\t细节向公众公开  简要描述： 无须任何权限，直接得到WEBSHELL。。。。其实。。是有条件限制的，有PHP解析漏洞的主机通杀。。。。人生在外，最重要不是朋友多而是，超长待机。我是陈冠希，你认识我啦 详细说明：  漏洞文件：phpcms\\modules\\attachment\\attachments.php漏洞函数：crop_upload\nif (isset($GLOBALS[\"HTTP_RAW_POST_DATA\"])) {\t$pic = $GLOBALS[\"HTTP_RAW_POST_DATA\"];//这里可以得知，图片内容由POST控制\t//中间省略十万行if (strpos($_GET['file'], pc_base::load_config('system', 'upload_url'))!==false) {$file = $_GET['file'];$basename = basename($file);if (strpos($basename, 'thumb_')!==false) {$file_arr = explode('_', $basename);$basename = array_pop($file_arr);}$new_file = 'thumb_'.$width.'_'.$height.'_'.$basename;}//中间省略十万行\tfile_put_contents($this->upload_path.$filepath.$new_file, $pic);\t//上面可见，文件名$basename可控，图片内容可控，还有什么不能做？？}\n   漏洞证明：  我只想证明给你看。。PHPCMS真的很不安全。。。还有很多洞洞我没爆。你。。懂的。。   修复方案：  你。。懂的。。   版权声明：转载请注明来源 tenzy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2012-09-24 09:21 厂商回复： 非常感谢！  tenzy 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-09-20 15:38 |    \t\t路人戊 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | 偶尔来看看，关注关注)\t\t \n  最近phpcms很火爆呀    \n     2012-09-20 15:39 |    \t\tupload \t\t\t( 普通白帽子  |\t\t\t        Rank:251 漏洞数:43        | 此处略--！)\t\t \n  后排看    \n     2012-09-20 15:41 |    \t\tkelon \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        )\t\t \n  我是来看冠希    \n     2012-09-20 15:55 |    \t\tEl4pse \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:7        | 世界上从来没有不可能这几个字，可不可能完...)\t\t \n  我猜我知道了    \n     2012-09-20 15:57 |    \t\ttenzy \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:21        | Need not to know)\t\t \n  @El4pse 。。。。。。你们这些刷库黑阔。。有0day捂着不发啊。我替天行道去了    \n     2012-09-20 16:01 |    \t\tEl4pse \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:7        | 世界上从来没有不可能这几个字，可不可能完...)\t\t \n  @tenzy - -谁刷库了。。我有正当职业的    \n     2012-09-20 17:29 |    \t\tJannock  \t\t\t( 核心白帽子 |\t\t\t        Rank:2278 漏洞数:204        | 关注技术与网络安全（招人中，有兴趣请私信...)\t\t \n  我猜我知道了，利用条件有限。。。    \n     2012-09-20 18:00 |    \t\tx7iao \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:41        | 文能床上控萝莉，武能床上定人妻)\t\t \n  我猜我知道了    \n     2012-09-20 19:02 |    \t\t鱼化石 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:18        | 介绍不能为空)\t\t \n  我猜不到    \n     2012-09-20 19:33 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  猜不到的路过    \n     2012-09-20 20:18 |    \t\t96° \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 一个人默默的努力着,)\t\t \n  小弟不才,看了一个小时终于知道额,    \n     2012-09-20 20:48 |    \t\ttenzy \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:21        | Need not to know)\t\t \n  求礼品。。。。不要U盘不要书啊～～    \n     2012-09-20 23:29 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  哎，v9啊，getshell。    \n     2012-09-21 08:56 |    \t\tDarkSun.Evil \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:2        | 请多关照...Thx...)\t\t \n  呃...继续猜猜，like nginx ?!! 关注下！    \n     2012-09-21 19:50 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  V5  87 又一个 getshell    \n     2012-09-22 11:16 |    \t\t巴克 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 禽兽)\t\t \n  我不是黑客，所以没猜出来    \n     2012-11-04 16:17 |    \t\tSeay \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:8        )\t\t \n  @tenzy 都有解析洞了，直接传图片一句话就可以了，毕竟文件名不可控，不过要学的还是思路，感谢楼主，赞一个    \n     2012-11-04 16:19 |    \t\tSeay \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:8        )\t\t \n  ...看错了，不好意思，文件名可控。。。    \n     2013-02-28 22:03 |    \t\tBlack World \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 无孔不入)\t\t \n  @Seay 挖了目录可控的。服务器解析没问题、目录执行权限是个问题， 丷。丷    \n     2015-04-17 15:52 |    \t\tbobbi \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:6        | 人生真是寂寞如雪)\t\t \n  ...    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}