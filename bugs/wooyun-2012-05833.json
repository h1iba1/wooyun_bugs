{"id": 20168, "wybug_id": "wooyun-2012-05833", "wybug_title": "腾讯3GQQ修改密码后仍可通过旧书签登陆", "wybug_corp": "腾讯", "wybug_author": "Malash", "wybug_date": "2012-04-07 11:15", "wybug_open_date": "2012-05-22 11:16", "wybug_type": "未授权访问/权限绕过", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-04-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-04-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-04-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-05-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-05-22：\t细节向公众公开  简要描述： 腾讯3GQQ登陆后可以保存书签（URL），方便下次通过书签直接登陆。但当用户修改QQ密码后原书签依旧可以登陆成功且可以多次登陆、顶掉其他客户端。 详细说明：  腾讯3GQQ登陆后可以保存书签（URL），方便下次通过书签直接登陆。但当用户修改QQ密码后原书签依旧可以登陆成功且可以多次登陆、顶掉其他客户端。如发生密码泄露等情况用户权限将会被黑客通过保存书签的方式长期持有，可作为QQ盗号后保持权限的一种手段。   漏洞证明：  首先我们注册一个qq号以供测试2606522034，注册完成后通过3GQQ进行登陆。\n\n获得书签（URL地址）\nhttp://q32.3g.qq.com/g/s?aid=nqqchatMain&sid=AWQEiNqJnpk0LKWL3joj1fNO&myqq=2606522034\n然后登陆QQ的PC客户端，点击系统设置——安全设置——修改密码，通过QQ安全中心修改密码，修改成功后有如下提示：\n\n必须输入新密码才可以从PC登陆。此时我们再次访问书签URL（为了防止其他因素影响，每次测试时删除Cookies、缓存并重新进入Chrome的隐身窗口）\nhttp://q32.3g.qq.com/g/s?aid=nqqchatMain&sid=AWQEiNqJnpk0LKWL3joj1fNO&myqq=2606522034\n\n\n可以看到3GQQ登陆成功，并且PC端被顶掉线了。经过测试，3GQQ的书签登陆可以多次使用，用户无法使其强制下线（这一点不同于QQ刚推出的多出登陆，因为3GQQ是直接把其他客户端顶掉的）   修复方案：  用户修改密码后立即使现有书签过期（刚才发了填收邀请码的邮箱，抱歉）   版权声明：转载请注明来源 Malash@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2012-04-10 09:19 厂商回复： 非常感谢您的反馈 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-04-07 12:09 |    \t\twdlei \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:6        | 安全界里的年轻人。)\t\t \n  好像不行吧 修改密码后就失效了我记得 经常保持朋友的3GQQ书签 被发现后朋友修改密码就没用了    \n     2012-04-07 12:48 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  老毛病了，我觉得TX会直接忽略    \n     2012-04-07 13:08 |    \t\tMalash \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        | https://malash.me)\t\t \n  @tpu01yzx @wdlei 可能书签本身还有过期时间，但貌似时间有点长，上面的链接还是可以登陆的    \n     2012-04-07 14:07 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  厂商拒绝或积极忽略此漏洞！腾讯回应：thx    \n     2012-04-12 13:53 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  有key?    \n     2012-05-24 10:03 |    \t\txcl0ud \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        )\t\t \n  aid 不失效？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}