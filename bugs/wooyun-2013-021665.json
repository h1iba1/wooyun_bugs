{"id": 12598, "wybug_id": "wooyun-2013-021665", "wybug_title": "任我行CRM权限绕过、上传、XSS、SQL注入各种简单测试", "wybug_corp": "任我行CRM", "wybug_author": "clzzy", "wybug_date": "2013-04-12 11:09", "wybug_open_date": "2013-05-27 11:09", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["上传", "注入", "任我行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-27：\t细节向公众公开  简要描述： 任我行CRM系统的权限绕过、上传、XSS、SQL注入各种简单测试某公司内部网络使用这套系统，第一回见到，看到WEB应用就忍不住手贱~~哎~~可能这就是找不到女朋友的原因吧。 详细说明：  1、上传个人平台里面的编写内部邮件的时候上传附件，很多类型没有过滤，比如asa、cdx，当然也没有过滤xx.asp;x.jpg这种格式：\n\n找到地址：\n\n得到shell：\n\n2、XSS发生在很多地方，截图截了邮件标题这里：\n\n3、权限绕过可能有朋友所没有员工账户进不去系统这些都没办法利用啊！不够呢！这程序有权限绕过的~~直接访问：http://192.168.0.88/crm/Message/ExMailSend.asp?UID=&AccountID=&MailID=1&IsPrivate=1&OperateType=ReSend&TimeID=0.13946238309452646进入编写邮件界面，你可以上传、可以XSS，当然权限绕过不久就就发生在这里，很多页面都有权限绕过：\n\n4、SQL注入这个就不多解释了~~我通过webshell看了一些源码，很长很长也不贴出啦， 一些参数做了类型检查，不过还是有些没有过滤的：\n\n   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  请个代码审计吧~~听说这公司在成都，我在重庆，喜欢成都，然后我也待业中...你懂的   版权声明：转载请注明来源 clzzy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-04-16 23:15 厂商回复： 在近几日的测试中，尚未在互联网上通过实例复现所述情况，商请白帽子提供软件检测识别特征，以便完成测试和确认、处置工作。先行通过图片确认，按多个漏洞进行评分，rank=5+7+3+5=20 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-12 11:15 |    \t\tclzzy \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:18        )\t\t \n  对了，我把测试的版本信息帖出来：任我行ECT 8.0 【软件ID号】7140000160(ECT)  【用户许可】50  【软件更新版本】sp1-2009-09-14      \n     2013-05-27 11:59 |    \t\tlion(lp) \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:14        | 本人菜。。。千年实习白帽子)\t\t \n  建议收了楼主~~我都看懂了      \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}