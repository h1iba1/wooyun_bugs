{"id": 1014, "wybug_id": "wooyun-2015-0116084", "wybug_title": "Wi-Fi万能钥匙Android客户端加密算法较弱导致信息泄露", "wybug_corp": "WiFi万能钥匙", "wybug_author": "droidcat", "wybug_date": "2015-05-25 22:49", "wybug_open_date": "2015-08-27 11:36", "wybug_type": "用户敏感数据泄漏", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["信息泄露", "万能钥匙客户端", "加密算法较弱"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-01：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向公众公开  简要描述： Wi-Fi万能钥匙Android客户端3.2.1版本（高版本未验证）加密算法较弱，导致向服务器提交任意MAC地址就可以返回该MAC地址对应AP的接入口令，可以用于通过遍历MAC地址获取AP接入口令 详细说明：  在查询AP接入口令时，Wi-Fi万能钥匙使用了HTTP协议，通过POST方法提交数据。\nPOST /wifiapi/fa.cmd HTTP/1.1Content-Length: 321Content-Type: application/x-www-form-urlencodedHost: wifiapi02.51y5.netConnection: Keep-Alive数据部分如下：och=hiapk&ii=*****&appid=0001&pid=qryapwd:commonswitch&mac=c4:6a:b7:**:**:**&lang=cn&sign=4F5BAC7FC640D50AAA7104742DA30EC4&bssid=0e:c8:97:4c:f7:**,&v=631&ssid=CMCC,&uhid=a0000000000000000000000000000001&method=getDeepSecChkSwitch&st=m&chanid=hiapk&dhid=*******\n其中，sign为校验字段，对整个post数据加盐后做了MD5运算，盐值为硬编码“LQ9$n******KOL”提交数据后，服务器返回含有AP接入口令的JSON数据。如下：\n{    \"retSn\": \"****\",    \"qryapwd\": {        \"retCd\": \"0\",        \"psws\": {            \"0e:c8:97:4c:f7:**\": {                \"bssid\": \"0e:c8:97:4c:f7:**\",                \"pwd\": \"4924364E06341F06F90F3BD86C7DDBCE648B1D0E449479A9CC25EC1D855C5522\",                \"hid\": \"**********\",                \"xJs\": \"\",                \"ssid\": \"CMCC\",                \"xUser\": \"\",                \"type\": \"internet\",                \"xPwd\": \"\",                \"securityLevel\": \"2\"            }        },        \"topn\": {            \"0e:c8:97:4c:f7:**CMCC\": 0        },        \"qid\": \"60fd55e3-eb8a-4e11-9a70-f90b3193ef1d\",        \"sysTime\": \"1432530097687\"    },    \"retCd\": \"0\",    \"commonswitch\": {        \"retCd\": \"0\",        \"switchFlag\": \"true\"    }}\npwd就是密码，但是经过加密了。但是解密算法也很简单，采用了AES加密，    key = 'jh16@*****vpos'， iv = 'j#bd0*****j!3jnv'，都是硬编码。解密后就是AP接入口令了。   漏洞证明：  \n\n   修复方案：  升级加密算法，停止旧版本的服务   版权声明：转载请注明来源 droidcat@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-05-29 11:34 厂商回复： 感谢您的关注，已将问题转交至相关团 队查证。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-26 08:10 |    \t\tNicky \t\t\t( 普通白帽子  |\t\t\t        Rank:477 漏洞数:69        | http://www.droidsec.cn 安卓安全中文站)\t\t \n  @瘦蛟舞 开小号了~    \n     2015-05-26 08:28 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  影响5亿用户,果断走通用漏洞！    \n     2015-05-26 09:28 |    \t\tCplusHua \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:33        | 乌云奖金:-1)\t\t \n  这不是drops上的文章么?    \n     2015-05-26 10:00 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  @Nicky 不是我....    \n     2015-05-26 10:04 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  可能关联文章:http://drops.wooyun.org/tips/6049可能关联漏洞: WooYun: WIFI万能钥匙密码查询接口算法破解（可无限查询用户AP明文密码）    \n     2015-05-26 10:27 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:31        | Hacked by @ringzero 我錯了)\t\t \n  @goodwell     \n     2015-05-27 12:50 |    \t\tdroidcat \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 关注移动安全)\t\t \n  @瘦蛟舞 有可能是同一个漏洞    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}