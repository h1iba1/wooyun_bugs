{"id": 4848, "wybug_id": "wooyun-2014-048878", "wybug_title": "Dedecms 会员中心注入漏洞3", "wybug_corp": "Dedecms", "wybug_author": "Matt", "wybug_date": "2014-01-14 16:13", "wybug_open_date": "2014-04-14 16:14", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-17：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-14：\t细节向公众公开  简要描述： Dedecms 会员中心注入漏洞3我不是来刷洞的！ 详细说明：  \nmember/flink_main.phpif($dopost==\"addnew\"){    AjaxHead();    $row = $dsql->GetOne(\"SELECT COUNT(*) AS dd FROM `#@__member_flink` WHERE mid='\".$cfg_ml->M_ID.\"' \");    if($row['dd']>=50)    {        echo \"<font color='red'>增加网址失败，因为已经达到五十个网址的上限！</font>\";        GetLinkList($dsql);        exit();    }    if(!preg_match(\"#^http:\\/\\/#\",$url)) $url = \"http://\".HtmlReplace($url, 2);//如果前面有http就不过滤了    $title = HtmlReplace($title);    $inquery = \"INSERT INTO `#@__member_flink`(mid,title,url) VALUES(\".$cfg_ml->M_ID.\",'$title','$url'); \";//这不就注入了么\techo $inquery ;    $dsql->ExecuteNoneQuery($inquery);    echo \"<font color='red'>成功增加一链接！</font>\";    GetLinkList($dsql);    exit();\n   漏洞证明：  测试方法打开http://127.0.0.1/dede/member/flink_main.php#在连接网址里面写入 http://sss2'),(8,1,@`'`),(8,(select user()),'33333连接名称随意这里的8 是我的用户ID 想要查看 必须得知道自己的用户id这个so easy 查看cookie 里面有一个DedeUserID 我的就是DedeUserID=8 这个一看就知道自己的id是神马了\n\n\n\n   修复方案：  过滤啊   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2014-01-14 22:25 厂商回复： 已修复，感谢反馈 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-15 08:55 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  我嘞个去哟！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}