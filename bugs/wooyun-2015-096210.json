{"id": 46884, "wybug_id": "wooyun-2015-096210", "wybug_title": "一步一步击垮傲游官网（多处敏感信息泄漏,可替换官网安装包,漫游内网）", "wybug_corp": "傲游", "wybug_author": "梧桐雨", "wybug_date": "2015-02-07 19:13", "wybug_open_date": "2015-02-11 11:34", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-11：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 审计傲游浏览器找0day什么的太累人了，还是直接拿下官网替换安装包快啊~ 详细说明：  问题出在傲游官网http://www.maxthon.cn/根据之前白帽子报告 WooYun: 遨游某服务器配置问题导致部分数据库备份文件泄漏主站可shell 尝试傲游官网后台：admin/login.php尝试弱口令:test test，居然进去了，真的吓坏了：没有想到傲游的官网这么不堪一击\n\n泄漏大量的简历\n\n但是目前test帐号权限很低，有没有办法提升权限呢？我忽然想到上面的例子，如果存在test这样的弱口令和弱密码，是否上面泄漏的sql文件也会存在没有更改密码的账户？花了几毛钱，把 WooYun: 遨游某服务器配置问题导致部分数据库备份文件泄漏主站可shell \n\n里头泄漏了的密码都丢去cmd5跑了一遍，逐个尝试登录，功夫不负有心人，sxfsxf_gw成功登录，并且属于高权限账户\n\n替换新闻，替换安装包全部不在话下：\n\n找到了一处上传图片的地方，由于对上传后缀没有做任何处理，直接上传php就拿到了webshell：\n\n为了证明确实能黑掉官网，对比了下文件：\n\n   漏洞证明：  上传一个php在线代理，即可漫游内网了：\n\n\n\n编写了一个简单脚本去遍历内网：\n<script>for(var i=0;i<=254;i++){\tdocument.write(\"<iframe src=http://www.maxthon.cn/images/ads/proxy.php?url=10.0.16.\"+i+\"></iframe><br>\")}</script>\n成功弹出的内网网段：10.0.9.x  8.x 192.168.0.x 10.0.16.x\n\n\n\n\n\n\n\n某台内网服务器还存在大量的用户调试信息：\n\n\n\n不一一列举了。。来个雷可好？0 0   修复方案：  修改后台地址，修改所有泄漏过的口令和账户，杜绝test test这样的账户密码   版权声明：转载请注明来源 梧桐雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2015-02-11 11:32 厂商回复： 已修复 最新状态： 2015-02-11：已修复. 禁止外网访问后台  ", "replys": "漏洞评价：\n评论\n     2015-02-07 19:17 |    \t\tMik3y_14 \t\t\t( 普通白帽子  |\t\t\t        Rank:181 漏洞数:29        | 愿君多采撷，此物最相思。)\t\t \n  厉害!!带着4哥来围观    \n     2015-02-07 19:18 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  支持～    \n     2015-02-07 19:30 |    \t\tNoxxx \t\t\t( 普通白帽子  |\t\t\t        Rank:509 漏洞数:41        )\t\t \n  前排    \n     2015-02-07 19:35 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  围观！    \n     2015-02-07 19:36 |    \t\t苏州同程旅游网络科技有限公司(乌云厂商)\t\t \n  牛逼    \n     2015-02-07 19:42 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  @苏州同程旅游网络科技有限公司 ←_←    \n     2015-02-07 19:45 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n  @苏州同程旅游网络科技有限公司 ←_←    \n     2015-02-07 19:45 |    \t\t天地不仁 以万物为刍狗 \t\t\t( 普通白帽子  |\t\t\t        Rank:977 漏洞数:264        | 天地本不仁 万物为刍狗)\t\t \n  前排  关注  学习    \n     2015-02-07 19:46 |    \t\t天地不仁 以万物为刍狗 \t\t\t( 普通白帽子  |\t\t\t        Rank:977 漏洞数:264        | 天地本不仁 万物为刍狗)\t\t \n  @苏州同程旅游网络科技有限公司  调皮    \n     2015-02-07 19:59 |    \t\tLyleaks \t\t\t( 普通白帽子  |\t\t\t        Rank:137 漏洞数:9        | 这个人很聪明，什么也没有留下)\t\t \n  牛逼    \n     2015-02-07 20:00 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  @苏州同程旅游网络科技有限公司 厂商都来凑热闹了    \n     2015-02-07 20:57 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  干掉遨游的乌云帐号，给2哥20rank！    \n     2015-02-07 20:58 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  学习了    \n     2015-02-07 21:06 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  关注    \n     2015-02-07 21:23 |    \t\t天朝城管 \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:35        | 不要等到命玩你的时候才开始玩命)\t\t \n  给跪了    \n     2015-02-07 21:48 |    \t\tg0odnight \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:19        | 么么哒，呵呵哒，么蛤蛤~)\t\t \n  今天的膝盖就给你了！    \n     2015-02-07 21:49 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  厉害    \n     2015-02-07 22:22 |    \t\tloli  \t\t\t( 普通白帽子  |\t\t\t        Rank:550 漏洞数:52        )\t\t \n  一步一步是爪牙,是魔鬼的步伐，是魔鬼的步伐。    \n     2015-02-07 23:37 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:19        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  @苏州同程旅游网络科技有限公司 ←_←  厂商感觉你和盛大一样  喜欢热闹_______哈哈    \n     2015-02-08 11:47 |    \t\tanswer \t\t\t( 普通白帽子  |\t\t\t        Rank:347 漏洞数:45        | 答案)\t\t \n  终于打雷了    \n     2015-02-08 11:49 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  妹子喜欢直接的    \n     2015-02-08 11:55 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  终于打雷了  我就说嘛  这个必须要霹雷啊    \n     2015-02-08 12:14 |    \t\t暧昧 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 此号乃是吾用来装孙子也)\t\t \n  调皮    \n     2015-02-08 12:33 |    \t\t′雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  妹纸好猛。    \n     2015-02-08 12:39 |    \t\t第四维度 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:34        | 谦谦君子，温润如玉)\t\t \n  怎么还没认领？    \n     2015-02-08 17:43 |    \t\tJeremy \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:11        | )\t\t \n  先拜。遨游TV看这里。    \n     2015-02-08 21:10 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  一步两步，一步两步，一步一步似爪牙    \n     2015-02-08 21:15 |    \t\tg0odnight \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:19        | 么么哒，呵呵哒，么蛤蛤~)\t\t \n  无影响厂商积极忽略    \n     2015-02-09 12:54 |    \t\ttenzy \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:21        | Need not to know)\t\t \n  无影响厂商积极忽略    \n     2015-02-09 13:03 |    \t\ttenzy \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:21        | Need not to know)\t\t \n  我来围观师傅入侵大站    \n     2015-02-09 17:57 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n     2015-02-09 22:46 |    \t\t空格 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 呃？)\t\t \n  @苏州同程旅游网络科技有限公司 ←_←    \n     2015-02-11 11:39 |    \t\t第四维度 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:34        | 谦谦君子，温润如玉)\t\t \n  良心厂商    \n     2015-02-11 11:42 |    \t\t第四维度 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:34        | 谦谦君子，温润如玉)\t\t \n  看完我就蛋疼了，弱口令引发的血案！    \n     2015-02-11 11:46 |    \t\tanswer \t\t\t( 普通白帽子  |\t\t\t        Rank:347 漏洞数:45        | 答案)\t\t \n  看完就觉得牛逼啊    \n     2015-02-11 11:58 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  梧桐雨大神 在线代理能共享吗？    \n     2015-02-11 12:49 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  下次去找你和lion啊     \n     2015-02-11 13:23 |    \t\tWulala \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:24        | ^..^ ^..^ ^↓^ ^..^ ^..^)\t\t \n  @scanf 这就是一个用php和curl做的网页代理，这里有一个这样的代码https://github.com/acanimal/Openlayers-Cookbook/blob/master/utils/proxy.php    \n     2015-02-11 13:26 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  @Wulala 谢了.    \n     2015-02-11 14:22 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  我怎么从来没有弱口令的人品    \n     2015-02-11 15:10 |    \t\t 飞鞋拍小强 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 小强)\t\t \n  这种安全防护级别，看了也是醉了    \n     2015-02-11 15:49 |    \t\t❤ \t\t\t( 普通白帽子  |\t\t\t        Rank:276 漏洞数:69        | ❤)\t\t \n  牛逼    \n     2015-02-11 16:10 |    \t\tGrayTrack \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:14        | 灰色轨迹)\t\t \n  这个代理是用的nginx反向代理么    \n     2015-02-11 16:17 |    \t\tjustforfun \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:4        | 纯爱好。。。求各种猥琐淫荡思路)\t\t \n  梧老师，开大招啦    \n     2015-02-11 16:45 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  大神，请收下我的膝盖。    \n     2015-02-11 18:03 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  @Wulala 报错，怎么回事呢？    \n     2015-02-11 19:30 |    \t\tWulala \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:24        | ^..^ ^..^ ^↓^ ^..^ ^..^)\t\t \n  @ki11y0u @scanf  我刚才测试了一下这个具体的代码，有时会出现错误，出错的原因是原来的代码指定content-type:application/xml,所以当返回的数据不符合xml标准就报错了，我对这个代码进行了修正,目前在我这里测试一切正常,你们可以做一下测试.修正的代码地址：https://github.com/KaiyiZhang/Secipt/blob/master/Proxy.php    \n     2015-02-11 19:33 |    \t\t老笨蛋 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:8        | 老笨蛋一个)\t\t \n  来看一下大婶们大招放雷。    \n     2015-02-11 22:46 |    \t\tJumbo \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:29        | 猫 - http://www.chinabaiker.com)\t\t \n  @Wulala 想问下，如何在这个基础上扫描内网呢    \n     2015-02-11 22:47 |    \t\tjianFen \t\t\t( 普通白帽子  |\t\t\t        Rank:530 漏洞数:83        | 避其锋芒，剑走偏锋)\t\t \n  运维必须跪了，test test都可以进官网后台    \n     2015-02-12 09:08 |    \t\tsky \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:33        | 有一天，我带着儿子@jeary 去@园长 的园长...)\t\t \n  @Jumbo <script>for(var i=0;i<=254;i++){\tdocument.write(\"<iframe src=http://www.maxthon.cn/images/ads/proxy.php?url=10.0.16.\"+i+\"></iframe><br>\")}</script>直接在控制台运行    \n     2015-02-12 10:14 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  @Wulala 感谢基友分享，测试成功。    \n     2015-02-12 10:26 |    \t\tJumbo \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:29        | 猫 - http://www.chinabaiker.com)\t\t \n  @sky 谢谢    \n     2015-02-12 12:40 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  哈哈哈，学习了    \n     2015-02-17 17:04 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  @Wulala 有jsp版的吗？    \n     2015-02-18 12:16 |    \t\tWulala \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:24        | ^..^ ^..^ ^↓^ ^..^ ^..^)\t\t \n  @scanf 我这没有，可以上网找找，或者参考代码写一个 。    \n     2015-03-04 16:07 |    \t\tMr.R \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:14        | 求大神带我飞 qq2584110147)\t\t \n  @苏州同程旅游网络科技有限公司 厂商你为何这么调皮    \n     2015-03-09 01:01 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  叼叼叼    \n     2015-03-24 09:12 |    \t\tFire ant \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:26        | 他们回来了................)\t\t \n  @苏州同程旅游网络科技有限公司   约    \n     2015-04-23 15:50 |    \t\thh2014 \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:39        | 继续)\t\t \n  学习了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}