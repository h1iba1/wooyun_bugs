{"id": 34324, "wybug_id": "wooyun-2015-0106649", "wybug_title": "某通用型图书馆管理系统可getshell-使用量极大+默认口令依然存在#第二弹", "wybug_corp": "北京匡九羽科技有限有限公司", "wybug_author": "姗姗来迟", "wybug_date": "2015-04-09 11:24", "wybug_open_date": "2015-07-12 15:08", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "补丁不及时", "命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-16：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-12：\t细节向公众公开  简要描述： 安全不可姗姗来迟！ 详细说明：  九羽图书馆系统描述:凡是九羽图书管理系统均可命令执行，此图书管理使用量系统极大！大部分保持原样，还有一大批被二次开发，但是漏洞依然存在！以下就以一个二次开发与几个原样测试做出案例，漏洞描述:此系统存在Struts2命令执行漏洞，导致直接getshell，通过进一步信息收集，可以提权服务器获取所搭建服务器上的敏感信息！0x01:getshell+info：网站：云南直机关工委图书馆后台管理系统（二次开发）网址：http://223.223.176.56:8080/background/Main/login.action \ndemo:http://223.223.176.56:8080/1.jsp\n目录：D:\\juuo\\app\\  win-uf8g7uvffbs\\administrator \n\n0x01-2:\n活动连接  协议  本地地址          外部地址        状态  TCP    0.0.0.0:21             0.0.0.0:0              LISTENING  TCP    0.0.0.0:80             0.0.0.0:0              LISTENING  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING  TCP    0.0.0.0:445            0.0.0.0:0              LISTENING  TCP    0.0.0.0:1433           0.0.0.0:0              LISTENING  TCP    0.0.0.0:2383           0.0.0.0:0              LISTENING  TCP    0.0.0.0:8080           0.0.0.0:0              LISTENING  TCP    0.0.0.0:47001          0.0.0.0:0              LISTENING  TCP    0.0.0.0:49152          0.0.0.0:0              LISTENING  TCP    0.0.0.0:49153          0.0.0.0:0              LISTENING  TCP    0.0.0.0:49154          0.0.0.0:0              LISTENING  TCP    0.0.0.0:49155          0.0.0.0:0              LISTENING  TCP    0.0.0.0:49164          0.0.0.0:0              LISTENING  TCP    0.0.0.0:56926          0.0.0.0:0              LISTENING  TCP    0.0.0.0:56928          0.0.0.0:0              LISTENING  TCP    0.0.0.0:63389          0.0.0.0:0              LISTENING  TCP    127.0.0.1:1433         127.0.0.1:50287        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:50759        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:51579        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:56447        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:58579        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:59091        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:59096        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:59705        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:59706        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:59875        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:60148        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:60149        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:60152        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:60162        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:60163        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:60164        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:60166        ESTABLISHED  TCP    127.0.0.1:1433         127.0.0.1:64504        ESTABLISHED  TCP    127.0.0.1:1434         0.0.0.0:0              LISTENING  TCP    127.0.0.1:6600         0.0.0.0:0              LISTENING  TCP    127.0.0.1:6800         0.0.0.0:0              LISTENING  TCP    127.0.0.1:14147        0.0.0.0:0              LISTENING  TCP    127.0.0.1:14147        127.0.0.1:57872        ESTABLISHED  TCP    127.0.0.1:50272        127.0.0.1:1433         TIME_WAIT  TCP    127.0.0.1:50275        127.0.0.1:1433         TIME_WAIT  TCP    127.0.0.1:50277        127.0.0.1:1433         TIME_WAIT  TCP    127.0.0.1:50278        127.0.0.1:1433         TIME_WAIT  TCP    127.0.0.1:50280        127.0.0.1:1433         TIME_WAIT  TCP    127.0.0.1:50281        127.0.0.1:1433         TIME_WAIT  TCP    127.0.0.1:50282        127.0.0.1:1433         TIME_WAIT  TCP    127.0.0.1:50283        127.0.0.1:1433         TIME_WAIT  TCP    127.0.0.1:50284        127.0.0.1:1433         TIME_WAIT  TCP    127.0.0.1:50285        127.0.0.1:1433         TIME_WAIT  TCP    127.0.0.1:50286        127.0.0.1:1433         TIME_WAIT  TCP    127.0.0.1:50287        127.0.0.1:1433         ESTABLISHED  TCP    127.0.0.1:50759        127.0.0.1:1433         ESTABLISHED  TCP    127.0.0.1:51579        127.0.0.1:1433         ESTABLISHED  TCP    127.0.0.1:56447        127.0.0.1:1433         ESTABLISHED  TCP    127.0.0.1:56927        127.0.0.1:56929        ESTABLISHED  TCP    127.0.0.1:56929        127.0.0.1:56927        ESTABLISHED  TCP    127.0.0.1:57872        127.0.0.1:14147        ESTABLISHED  TCP    127.0.0.1:58579        127.0.0.1:1433         ESTABLISHED  TCP    127.0.0.1:59091        127.0.0.1:1433         ESTABLISHED  TCP    127.0.0.1:59096        127.0.0.1:1433         ESTABLISHED\n   漏洞证明：  0x02:默认口令大部分站点依然存在\nadmin/admin\n\n\n0x03:案例http://218.246.34.99:8090/background/Main/login.action 非二次开发http://222.86.206.53:9090/background/Main/login.action 非二次开发http://121.28.11.149:90/background/Main/login.action   非二次开发http://210.35.35.28:90/background/Main/login.action    非二次开发   修复方案：   九羽图书系统使用量很广泛！教育/政务/等都涉及，都可执行命令。建议尽快修复！20rank有木有！$$有木有哈。   版权声明：转载请注明来源 姗姗来迟@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-04-13 15:07 厂商回复： CNVD未直接复现所述漏洞情况，暂未建立与软件生产厂商的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}