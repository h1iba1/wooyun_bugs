{"id": 14413, "wybug_id": "wooyun-2013-017198", "wybug_title": "TRS的WCM6漏洞权限绕过以及绕过密码的登陆方式", "wybug_corp": "北京拓尔思信息技术股份有限公司", "wybug_author": "Nohat", "wybug_date": "2013-01-11 11:31", "wybug_open_date": "2013-02-25 11:32", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "逻辑错误", "认证绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-02-25：\t细节向公众公开  简要描述： 未对权限进行严格验证导致未授权访问 详细说明：  1、由来：建立在  WooYun: TRS的WCM6可直接获取管理员密码  漏洞的基础上2、首先访问wcm目录，会自动跳转到登录页面:\n\n3、在网址后加上查看管理员密码的链接：\nwcm/infoview.do?serviceid=wcm6_user&MethodName=getUsersByNames&UserNames=admin\n\n\n*之前的漏洞说查看管理员信息的危害不大是因为MD5加密只取半截，并且即使破解还有可能遇到admin账号未启用的问题（截图在后面）。4、这时我们点击浏览器的后退按钮或在地址栏的网址后面直接输入\nwcm/app/login.jsp\n，这样就绕过权限登录了：\n\n\n\n这个system是个什么身份？见下图：\n\n原来是系统保留账号，权限还是比较大的。附admin账号未开通截图：\n\n完毕   漏洞证明：  完全如上   修复方案：  等待官方修复，对访问权限进行严格的控制   版权声明：转载请注明来源 Nohat@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-01-14 16:54 厂商回复： CNVD确认并在多个实例上复现所述情况，将作为重要事件分两方面同步进行，一是协调拓尔思公司进行处置；二是通过测试，通过CNCERT以及各分中心协调存在漏洞的政府部门进行处置，以便监督拓尔思公司的处置进度。目前看，获得的system用户权限在多个案例上还需进一步测试，按部分影响机密性、可用性进行评分，基本危害评分6.82(中危)，发现难度系数1.1，涉及行业或单位影响系数1.9（目前测试复现3个政府部门案例），综合rank=6.82*1.1*1.9=14.253 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-11 11:35 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  good job!    \n     2013-01-11 12:22 |    \t\tJoker \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:6        | while(age++) {\tmake(rmb);\tif (outOf(...)\t\t \n  威武87...绕过密码登陆的话，直接就上JSP了啊，TRS WCM6里貌似低权限就直接可以上传JSP了。用这系统的还不少。    \n     2013-01-11 12:49 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  TRS和有关部门搭配果然是天衣无缝。    \n     2013-01-11 14:28 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  擦，果断关注~    \n     2013-02-04 08:56 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  果然是： WooYun: TRS WCM 6.x系列用户密码泄漏 中最后那点那见证奇迹的时刻，还可以说什么呢，还能说什么呢。    \n     2013-02-25 12:10 |    \t\t木易耳朵 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:4        | 搞搞基，日日站，人生乐逍遥。)\t\t \n  @刺刺 就是骗分的。    \n     2013-02-26 09:07 |    \t\tNohat \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:4        )\t\t \n  @木易耳朵 事先并没有看到，确实是按照我上面提到的步骤来的，难道你能确保乌云上所有的漏洞都不重复么？况且我刚看了下 WooYun: TRS WCM 6.x系列用户密码泄漏   作者也没有说清楚之后的步骤和危害等等信息，仅一句话见证奇迹？呵呵，那我就来扮演董卿的角色好了    \n     2013-02-26 10:52 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @Nohat @木易耳朵 @刺刺 各位稍安毋躁，这个漏洞虽然跟之前细节重复，但是在漏洞细节体现与危险最大化的证明上还是可学习的。因为乌云上无法保证所有人技术与理解能力持平，很多漏洞没表述明确较难理解，之前的漏洞（ WooYun: TRS WCM 6.x系列用户密码泄漏 ）与此篇加在一起就很完美了，因为文字图片就能说明的问题就免去了自己再去找站点尝试的过程。同时也希望之后各位提交漏洞尽量细节话，危害最大化，就能杜绝此类争执啦 ：）    \n     2013-02-26 13:42 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  呵呵，楼上说的极是，多谢！努力做一个豁达的人！    \n     2013-02-26 18:57 |    \t\tNohat \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:4        )\t\t \n  @疯狗 十分感谢    \n     2013-02-28 19:48 |    \t\tcnbird \t\t\t( 普通白帽子  |\t\t\t        Rank:547 漏洞数:47        | http://blog.csdn.net/cnbird2008)\t\t \n  他的TRS IDS产品同样有这样的问题，我是在某次做项目过程中发现的。求trs ids的环境    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}