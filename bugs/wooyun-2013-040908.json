{"id": 7624, "wybug_id": "wooyun-2013-040908", "wybug_title": "易名中国逻辑错误可重置他人密码(绕过验证码有效次数)", "wybug_corp": "易名中国", "wybug_author": "niliu", "wybug_date": "2013-10-25 11:33", "wybug_open_date": "2013-12-09 11:34", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "认证设计不合理", "设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-09：\t细节向公众公开  简要描述： 应@小川 要求，来一发菊花残~  详细说明：  易名中国，一个域名服务提供商。貌似好多大站都在这注册的。本着试试看的态度测试了一下，没想到竟然可以重置他人密码！此处漏洞比较隐蔽，非常规的简单爆菊。问题当然是出在了密码找回页面，先正常流程测试一下来到密码找回页面\nhttps://www.ename.net/user/findpassword\n\n\n下一步，手机接收6位数字验证码，然后随便填写个111111提交时抓包\n\n\nPOST /user/sendcaptcha HTTP/1.1Host: www.ename.netConnection: keep-aliveContent-Length: 62Cache-Control: max-age=0Origin: https://www.ename.netUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Maxthon/4.0.3.6000 Chrome/22.0.1229.79 Safari/537.1Content-Type: application/x-www-form-urlencodedAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8DNT: 1Referer: https://www.ename.net/user/sendcaptchaAccept-Encoding: gzip,deflateAccept-Language: zh-CNAccept-Charset: GBK,utf-8;q=0.7,*;q=0.3Cookie: @!#$@$%^%Mobile=18********4&MobileVoiceValue=18********4&Captcha=§111111§\n此处未对验证码做提交错误次数限制，导致可暴力破解对参数Captcha进行破解，如图\n\n成功得到验证码256534，去页面试一下，结果悲剧了。。。\n\n提示：对不起，您的验证码已经被使用过。原来网站还是做了限制的，刚才破解时已经使用的一次验证码，就算破解出来也不能用了。此时陷入尴尬..有点不甘心，换个思路，先正常重置下密码看看页面会跳转到哪？经过测试输入正确的验证码后页面会跳转到这\nhttps://www.ename.net/user/resetpassword\n那么，思路有了，破解成功后，虽然页面提交时提示验证码已经被使用。这里不管它，直接访问\nhttps://www.ename.net/user/resetpassword\n即可重置密码。\n\n   漏洞证明：  都在上面了...   修复方案：  验证码先修复了，再修复逻辑问题！   版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-10-25 18:49 厂商回复： 感谢niliu发现漏洞，稍早前已和niliu有做过沟通，虽然目前可判定该漏洞只会造成没有设置操作保护的ID密码被修改，而正常使用的帐号都会强制用户设置操作保护。通常ID下每一项针对域名或款项的功能，都有由用户自定义再次操作保护或手机验证保护的功能，所以通常有了密码登录进去，也不会对用户的ID产生太大的损失，但我们仍然非常的感激，并且会发送礼物给予感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-24 16:26 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  膜拜楼主    \n     2013-10-24 16:31 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @小川 哎，网速不给力，正在玩命爆菊中...    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}