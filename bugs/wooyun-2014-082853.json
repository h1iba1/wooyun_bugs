{"id": 43396, "wybug_id": "wooyun-2014-082853", "wybug_title": "中旅总社星旅网sql+上传（可以shell并提权服务器）", "wybug_corp": "ctsho.com", "wybug_author": "px1624", "wybug_date": "2014-11-11 17:43", "wybug_open_date": "2014-11-16 17:44", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 在乌云看别人的漏洞，然后发现那个漏洞忽略后修补了，然后又找到了一个，可以shell并提权服务器（乌云发的第一个shell，求不要小厂商）。 详细说明：  ##1 之前平顶山提交了个struts2的漏洞 http://wooyun.org/bugs/wooyun-2010-053212地址：http://www.osrqd.com/HQWCMS/login_login.action发现厂商忽略后给修好了。##2 然后就去继续看了看这个地址http://www.osrqd.com/HQWCMS/login_login.action发现登录框位置存在注入啊，然后admin' or ''='密码随便写就可以进入后台了。##3 后台东西很丰富啊，还有各种敏感信息、敏感操作以及某些核心功能。\n\n\n\n\n\n##4 然后发现这里有个自带的_res目录下的文件管理功能，还可以上传，嘿嘿。\n\n##5 不过测试发现，这里大部分都是静态页面文件，不解析php等文件，能解析jsp，但是传jsp木马连不上啊。##6 经过测试发现，上传后缀为jspx文件的话，就可以成功解析并且连上菜刀了，目测是在服务器的配置中吧jsp给做了下特殊化了。然后_res根目录上传个jspx木马，成功连菜刀了。\n\n##7 这个是传的木马，你们自己清理下吧。\n\n##8 然后shell后就是linux下的提权了，这个玩意小菜我不会，所以就请教了一下 爱上平顶山 大牛，然后他给我甩了张图，让我贴上来证明下可以拿到服务器权限。\n\n   漏洞证明：  看上面的图片。   修复方案：  1 修补掉那个登录位置的注入点2 后台最好搞个vpn或者内网吧   版权声明：转载请注明来源 px1624@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-11-16 17:44 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-11 18:57 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  果然还是小厂商了。。。    \n     2014-11-17 15:26 |    \t\tzt22172 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 跟着大家一起前进，做一个思想开放，思路开...)\t\t \n  这就小厂商了？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}