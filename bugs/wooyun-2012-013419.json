{"id": 16877, "wybug_id": "wooyun-2012-013419", "wybug_title": "迅雷一处成因很诡异的xss+服务器信息泄漏", "wybug_corp": "迅雷", "wybug_author": "xsjswt", "wybug_date": "2012-10-16 18:36", "wybug_open_date": "2012-10-21 18:36", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-10-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-10-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 迅雷一处成因很诡异的xss+服务器信息泄漏 详细说明：  http://click.cm.sandai.net/UClick?gs=cmuclick&ad=1&location=xx这个链接没有对location做检查，直接拿来做http header的location输出了，那么最直接的，产生一个任意地址跳转的漏洞。\n\n这样来看，很多http header的location利用就限制在任意跳转了，利用范围顿时觉得小了很多。（ WooYun: 腾讯URL跳转 & XSS 这个帖子说opera的location是可以X的，但是没有装，也不了解，先这样吧）。接下来想的，自然是给location提交一些其他奇葩的值，比如回车之后再输出一个location，浏览器会怎么解析这个http头呢？不过就这时，神奇的事情发生了：\n\n很明显的，程序框架或者语言本身防范了回车这个问题，或者说很严格的执行了http的标准，导致这样的输出是不被认可的。。。。但是细心的洞主立即想到了另外一个问题，这个出错信息会不会没有过滤？立即尝试下。。。。果然不会过滤\n\n注意到服务器返回的conten-type是text/plain;，所以几乎对IE以外的浏览器没有影响了\n\n一些web应用没有关闭错误显示，并且很直接没有过滤的把错误信息显示出来，至少这是我第二次遇到错误信息导致的xss了。   漏洞证明：  先发个黄图见详细描述   修复方案：  球迅雷会员卡或者迅雷t-shirt，去年签约时候发的几张卡和衣服被同学抢走了   版权声明：转载请注明来源 xsjswt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-10-21 18:36 厂商回复：  最新状态： 2012-10-22：感谢反馈，早上一来收到的wooyun通报邮件，不过上来一看，居然被忽略了！诡异！我们马上进行处理！  ", "replys": "漏洞评价：\n评论\n     2012-10-21 19:13 |    \t\thqdvista \t\t\t( 普通白帽子  |\t\t\t        Rank:154 漏洞数:31        | N/A)\t\t \n  ym被迅雷挖走的洞主！    \n     2012-10-22 10:32 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  @hqdvista xsser为了不给我得rank，帮迅雷忽略了。。。嗯，应该是这样的。我还有另外提交了一个迅雷漏洞一箩筐，他们就不审核    \n     2012-11-01 13:48 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n    主要是处理Java异常时，开发人员习惯不好，主动去接管了异常信息的处理，但又随意向外抛，形成XSS! <<j2ee异常信息处理形成的XSS>>也可以算是个话题,很普遍！    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}