{"id": 61305, "wybug_id": "wooyun-2013-040046", "wybug_title": "小米某账户登录页面oauth缺陷（可钓鱼）", "wybug_corp": "小米科技", "wybug_author": "libmaru", "wybug_date": "2013-10-17 15:40", "wybug_open_date": "2013-10-22 15:40", "wybug_type": "URL跳转", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["跳转", "跳转导致钓鱼"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-22：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 登录成功后重定向到callback指定的网址，callback已经加了sign验证，但是存在接口可以提交URL给sign 详细说明：  求米2S标准版的F码～谢谢http://order.xiaomi.com/site/loginurl 验证不严例1:利用http://order.xiaomi.com/site/loginurl?followup=http://requestb.in/1kd0b981?.xiaomi.com构造出https://account.xiaomi.com/pass/serviceLogin?callback=http%3A%2F%2Forder.xiaomi.com%2Flogin%2Fcallback%3Ffollowup%3Dhttp%253A%252F%252Frequestb.in%252F1kd0b981%253F.xiaomi.com%26sign%3DMWFiNDVhOGNiNWUyYWE3NjMxNDFiYjA3MzE0Yjc1Zjg0OWZiMjQ1Ng%2C%2C&sid=eshop例2:利用http://order.xiaomi.com/site/loginurl?followup=http://www.xiaomi.com.example.com构造出https://account.xiaomi.com/pass/serviceLogin?callback=http%3A%2F%2Forder.xiaomi.com%2Flogin%2Fcallback%3Ffollowup%3Dhttp%253A%252F%252Fwww.xiaomi.com.example.com%26sign%3DYTBjMDVhN2ZlYjg0OGQ3MWRiYTg3M2NmMTg3NzA5MDViYzkyMWNmYw%2C%2C&sid=eshop借着活动的宣传，打着保证抢到之类的旗号一定能掉到好多好多人 > <   漏洞证明：     修复方案：  http://order.xiaomi.com/site/loginurl 验证不严，这个不应该https://account.xiaomi.com/pass/serviceLogin 只查sign不查url也不合理，白名单几个域名又不累   版权声明：转载请注明来源 libmaru@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-10-22 15:40 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}