{"id": 73108, "wybug_id": "wooyun-2015-0161687", "wybug_title": "aspcms后台备份逻辑错误导致被注入一句话木马", "wybug_corp": "aspcms", "wybug_author": "路人甲", "wybug_date": "2015-12-16 14:15", "wybug_open_date": "2016-01-28 17:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-16：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-01-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： aspcms后台的备份逻辑存在严重的逻辑问题，可导致一句话木马被“引入”执行 详细说明：  众所周知，对以xxx.asp命名的access数据库，只要插入著名的一句话：┼攠數畣整爠煥敵瑳∨≡┩愾访问该asp即可得到webshellaspcmsv2.5.8 最新版虽然对正在使用的数据库的名字加了#号，导致无法直接访问，但是数据库的备份功能却是直接把数据备份成了 xxx.asp  导致访问备份的数据库网址即可得到webshell利用过程：1、在站点前台留言本以 \" ┼攠數畣整爠煥敵瑳∨≡┩愾 \"做标题留言一则2、利用我刚提交的aspcms爆后台路径以及http://demo.aspcms.com/ 的弱口令，我轻易的进入了后台。3、利用后台的备份功能备份数据库，得到存在一句话木马的web地址，得到webshell\n\n\n\n   漏洞证明：  得到webshell，请看图：\n\n   修复方案：  后台的备份，不应该自动生成可直接访问的asp文件。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评价\n     2015-12-16 14:20 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:1593 漏洞数:230        | 闭关修炼易筋经)\t\t \n  也就是说所有版本都自带一句话？    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}