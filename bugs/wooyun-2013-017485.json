{"id": 14259, "wybug_id": "wooyun-2013-017485", "wybug_title": "成都公积金任意账户密码修改漏洞", "wybug_corp": "成都公积金", "wybug_author": "蟋蟀哥哥", "wybug_date": "2013-01-18 13:20", "wybug_open_date": "2013-03-04 13:21", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-02-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-04：\t细节向公众公开  简要描述： 你们懂的。。。 详细说明：  漏洞一:修改任意账号密码。csrf漏洞+逻辑漏洞。在网站上，如果需要改密码是需要输入原始密码的。但是根本不是，再加上是get传值就造成了该漏洞。。。只要得知对方的公积金账号，再把构造好的url发给对方。就可以随意登陆对方公积金账号。密码改为:wooyun的URL为:\nhttp://www.cdzfgjj.gov.cn/getlogin?oldps=&newpsd=wooyun&method=xgmm\n就算不知道对方的账号，随意把这段URL嵌入某个大型网站，就会造成一堆用户密码被修改。。然后再遍历公积金账号登陆。。获取公民信息。包括姓名，身份证号，手机号，工作单位等。根据缴纳的公积金以及缴存基数，还可以初步估算出个人收入等。社工必备!!!!漏洞二，修改账户信息让被攻击者在已经登录的情况下访问URL:\nhttp://www.cdzfgjj.gov.cn/getlogin?tel=138008008&email=麻花藤@qq.com&method=xggrxx\n或者把该URL嵌入第三方网站，隐蔽攻击。。本来想尝试在电话或者email字段注入xss的。但是发现服务端进行了过滤，不能修改。。不然威力很强大滴。。如果cnvd没有账号进行测试复现，请联系本人。thx   漏洞证明：  \n\n\n\n   修复方案：  改用post请求，或者加token。   版权声明：转载请注明来源 蟋蟀哥哥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-01-22 18:21 厂商回复： CNVD确认漏洞并复现所述情况，已转由CNCERT协调涉事单位进行处置。rank=8 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-18 13:33 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  欢迎洞主回来发洞~    \n     2013-01-18 13:46 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @se55i0n 他一直都在，现在为了iphone5来了，哈哈    \n     2013-01-19 21:28 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  关注    \n     2013-01-21 23:12 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  关注~    \n     2013-01-22 10:14 |    \t\tr0ckEr \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | >>>print Hello world.)\t\t \n  公积金账户？开门，查水表。。。    \n     2013-03-04 13:26 |    \t\tzmx \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:9        | wooyun)\t\t \n  目测这个账户是不是你自己的吧    \n     2013-03-05 02:03 |    \t\ttmp \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | 此人很懒)\t\t \n  @蟋蟀哥哥 weblogic+jeecms 也许可以走得更远一点    \n     2013-03-05 08:30 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @tmp jeecms检查过。。对方把很多模块都直接删除了的。所以只有源码报错泄露路径等问题    \n     2013-05-09 15:21 |    \t\trootsec \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:3        | 此人已经懒得不行了。。。)\t\t \n  神马单位这么牛逼    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}