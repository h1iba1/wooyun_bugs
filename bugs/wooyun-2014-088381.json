{"id": 48395, "wybug_id": "wooyun-2014-088381", "wybug_title": "三福百货GetShell可导致500多万用户信息泄露", "wybug_corp": "sanfu.com", "wybug_author": "0x70", "wybug_date": "2014-12-24 09:53", "wybug_open_date": "2014-12-29 09:54", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-29：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 三福百货内网 可导致500多万用户信息泄露 详细说明：  看到很多带闪电的都是漫游内网,不知道这个有木有闪电之前用三福的SQL注入得出后台管理员账户密码,但是管理的账号密码一直没改。三福用的是360shop的程序,这次顺便也发下360shop后台拿shell的方法。进入后台：\n\n360shop在后台上传处进行了过滤，但在 促销页面管理 处却值过滤了 危险的后缀(比如php phtml asp等)。但是我们可以上传.htaccess,<FilesMatch \"haha\">SetHandler application/x-httpd-php</FilesMatch>只要我们上传的文件名中带haha 即可当php解析,这个都懂的 就不多说了。GETSHELL后开sock5代理进内网。   漏洞证明：  数据用户(真没想到三福在全国有这么多用户了)：\n\n只查询了以下几条,未脱裤\n\n\n\n\n\n\n\n还有一些oracle数据库的没截图   修复方案：  修改密码加强内网安全   版权声明：转载请注明来源 0x70@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-29 09:54 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-24 14:15 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  妈蛋！    \n     2014-12-24 15:19 |    \t\t0x70 \t\t\t( 普通白帽子  |\t\t\t        Rank:228 漏洞数:33        | 正在输入中....)\t\t \n  @小胖子 为何要来这么一句    \n     2014-12-24 15:28 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @0x70 因为我是500万分之1    \n     2014-12-24 15:40 |    \t\t0x70 \t\t\t( 普通白帽子  |\t\t\t        Rank:228 漏洞数:33        | 正在输入中....)\t\t \n  @小胖子 其实我也是500万分之一    \n     2014-12-24 15:45 |    \t\t承诺 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 你关注的漏洞 发表了白帽子)\t\t \n  我也是500万分之一    \n     2014-12-24 16:03 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @小胖子 哈哈哈，快去脱了小胖子，上他的wooyun账户提现    \n     2014-12-24 16:33 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这百货这么多用户    \n     2014-12-24 16:50 |    \t\t0x70 \t\t\t( 普通白帽子  |\t\t\t        Rank:228 漏洞数:33        | 正在输入中....)\t\t \n  @疯狗 三福貌似是全国性的    \n     2014-12-29 09:57 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  @疯狗 LZ好屌蛮。http://loudong.360.cn/vul/info/qid/QTVA-2014-136142   2个地方提交。    \n     2014-12-29 11:00 |    \t\t影刺 \t\t\t( 实习白帽子  |\t\t\t        Rank:67 漏洞数:25        | 关注web安全)\t\t \n  三福数据特多。哎 让你们去过这些商场就难逃魔掌了。。。    \n     2014-12-29 14:13 |    \t\t0x70 \t\t\t( 普通白帽子  |\t\t\t        Rank:228 漏洞数:33        | 正在输入中....)\t\t \n  @momo @疯狗 这个不是我提交的    \n     2014-12-29 22:31 |    \t\t继续沉默 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 好好学习，天天向上)\t\t \n  你娘的。我也在里面    \n     2015-01-06 22:16 |    \t\t氓氓童鞋 \t\t\t( 普通白帽子  |\t\t\t        Rank:374 漏洞数:65        )\t\t \n  你为何要用之前的sqlmap跑来的管理数据登陆呢？如果不是弱口令的话，从这个切入点进后台getshell不大好吧，那用这种方式，岂不是能发一大堆漏洞了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}