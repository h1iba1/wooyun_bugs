{"id": 66013, "wybug_id": "wooyun-2015-0137614", "wybug_title": "某省电信大量无线设备存在弱口令及SNMP信息泄露", "wybug_corp": "广东省电信", "wybug_author": "wy007", "wybug_date": "2015-08-30 15:45", "wybug_open_date": "2015-10-17 10:38", "wybug_type": "基础设施弱口令", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "管理后台对外", "安全意识不足", "默认配置不当", "后台地址泄露", "默认口令"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-17：\t细节向公众公开  简要描述： 下一个会不会是某省联通了... 详细说明：  本是无意间发现一台无线AP设备存在默认口令，后来挖掘了一下（信息搜集），发现应该是广东省电信全省采购的这几种型号的AP设备（且这几种AP型号设备的默认口令居然都是一致的...，貌似都是国产XX货...），随机挑了一些进行测试，发现存在弱口令的设备不少，但并不是所有AP设备都存在这里简单说一下测试过程中发现的几个主要问题：1.无线AP管理后台弱口令：                 三元达WPB-5000：   目前测试的99%都存在弱口令智达康ZDC ZG-5000：目前测试的%80都存在弱口令国人通信SRG-W5000：一小部分存在弱口令中兴ZTE W860A：    设备数量较少，暂未发现2.SNMP Public默认口令：基本上目前测试的80%无线AP设备默认都开了SNMP端口，就算管理后台弱口令无法登陆，但依然可以通过SNMP获取设备的详细配置信息3.登陆页面没有验证码校验和失败次数限制：可以进行暴力破解通过以上几个方面，对广东省电信的外网IP进行扫描，然后使用工具或脚本批量进行爆破和弱口令登陆。应该会有不少收获...下面开始进入正题：默认用户名：admin默认密码：password目前已经测试的漏洞地址：（实际存在漏洞的数量远大于这些，因广东省电信IP段太广，只测试小部分IP段，其他自行排查吧...测试这些还浪费了我大半天功夫...）广东省汕头市电信：https://121.10.200.39/cgi-bin/webprochttps://121.10.200.40/cgi-bin/webprochttps://121.10.200.144/cgi-bin/webprochttps://121.10.200.145/cgi-bin/webprochttps://121.10.200.146/cgi-bin/webprochttps://121.10.200.148/cgi-bin/webprochttps://121.10.200.149/cgi-bin/webprochttps://121.10.200.151/cgi-bin/webprochttps://121.10.200.153/cgi-bin/webprochttps://121.10.200.155/cgi-bin/webprochttps://121.10.200.157/cgi-bin/webprochttps://121.10.200.159/cgi-bin/webprochttps://121.10.200.161/cgi-bin/webprochttps://121.10.200.162/cgi-bin/webprochttps://121.10.200.163/cgi-bin/webproc广东省汕头市电信：https://59.35.31.239/cgi-bin/webproc广东省湛江市电信：https://113.86.163.35/login_zdc.htmhttps://113.86.163.46/login_zdc.htmhttps://113.86.163.55/login_zdc.htmhttps://113.86.163.183/login_zdc.htm广东省湛江市电信：https://113.86.184.106/login1.htmhttps://113.86.184.112/login1.htm广东省云浮市电信：https://113.107.192.45/login_zdc.htm https://113.107.192.131/login_zdc.htmhttps://113.107.192.6/login1.htm https://113.107.192.81/login1.htm https://113.107.192.138/login1.htm https://113.107.192.205/login1.htm 广东省深圳市电信：（SNMP Public弱口令）119.146.17.46119.146.17.90下面说一下测试思路：可以对广东省电信IP段进行443端口扫描，这些AP默认全是开放443端口，开放的443端口的一般即为无线AP管理后台，然后使用通用用户名密码进行测试，嫌手动测试麻烦的，其实可以写个脚本或使用工具进行批量测试用户名：admin密码：password广东省电信部分IP段443端口扫描：\n\n\n\n\n\n\n\n可以看到上面我使用工具已经查询了几个广东省电信的IP段。121.10.190.0-121.10.231.255   广东省汕头市电信113.86.128.0-113.86.255.255   广东省湛江市电信119.146.14.0-119.146.27.255   广东省深州市电信113.107.189.0-119.107.194.255 广东省潮州市电信获得到了开放443端口的IP地址之后，下一步就是测试默认口令了，我这里没有写工具，是手动测试的，本来以为不多就手动上去测试了...结果悲剧了。测试发现有一些默认口令是无法登陆的，但是默认依然开了SNMP端口，我们可以利用工具搜集一些网络信息和设备配置信息\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n仔细看其实上面搜集到的信息还是不少的，最后一张图里获取的信息是最多的，基本设备的所有配置信息都在里面可以看到，包括设备的用户名有人可能觉得光知道用户名有什么用...这些信息虽然不能直接进行利用，但是为APT攻击提供了很多便利。例如知道了用户名，就只需要对密码进行爆破了，爆破的排列组合少了不少自然成功率和速度就增加了不少...下面就要说到，这些国产AP的安全做得确实不到位，应该都有年头了吧...都没有验证码校验，且没有失败尝试次数限制，我想对于有字典的大牛们，爆破这种应该不难吧...\n\n\n\n\n\n\n\n   漏洞证明：  下面就直接上图吧...\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n过程写这么详细，只是为了让厂商意识到严重性（你们可以拿我的测试方法自行测试还有多少漏洞存在...），如果我只贴几个地址给你的话，你会不会觉得只有这几个地址存在弱口令，换个密码就OK了...量变引起质变你们懂得...   修复方案：  1.所有设备的默认口令都修改下吧...2.不做采集的话就关了SNMP端口吧..3.防火墙上做策略来限制访问吧...   版权声明：转载请注明来源 wy007@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-09-02 10:36 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国电信集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}