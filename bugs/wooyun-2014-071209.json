{"id": 230, "wybug_id": "wooyun-2014-071209", "wybug_title": "某商业供应链系统存在任意文件上传及目录列举漏洞，同时发现多套系统已被入侵", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "wefgod", "wybug_date": "2014-08-06 13:22", "wybug_open_date": "2014-11-04 13:24", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传安全", "文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-04：\t细节向公众公开  简要描述： 这系统对一些商场什么的影响比较大，存在文件上传和目录列举的问题，同时还发现了有网站已经被上传了webshell 详细说明：  系统名称：商业供应链系统技术支持：北京富基融通科技有限公司   漏洞证明：  文件上传漏洞页面：http://scm.brjt.cn:8081/web/epublic/upload.jsp上传页面：http://scm.brjt.cn:8081/web/epublic/upfiles.html如果不存在就用下面的代码：<html><form action=\"http://scm.brjt.cn:8081/web/epublic/upload.jsp\" name=\"test\" method=\"post\" enctype=\"multipart/form-data\"><input type=\"file\" name=\"file\" size=\"23\" id=\"file\" /><input type=\"submit\" value=\"Submit\" /></form></html>\n\n上传之后不会重命名，直接写到upload文件夹下：\n\n\n\nhttp://222.223.124.193:8081/web/epublic/upload.jsp如果手工传记得修改数据包\n\n如果如下图一样报错，忽视就可以了\n\n一样会写进去\n\n\n\n其它一些系统的链接也有人曾经列举出来过了：\n北京奥特莱斯SCM商业供应链系统 http://123.127.107.117/web/epublic/upload.jsp 哈尔滨联强乐买SCM商业供应链系统 http://1.58.67.114/web/epublic/upload.jsp 北人集团_商业供应链SCM系统-超市 http://scm.brjt.cn:8081/web/epublic/upload.jsp 国光SCM商业供应链系统 http://gyl.jxggls.com:8080/web/epublic/upload.jsp 家乐园供应链系统 http://222.223.124.193:8081/web/epublic/upload.jsp 商业供应链系统 http://js.bjcsf.com/web/epublic/upload.jsp 商业供应链系统 http://218.66.37.70:8081/web/epublic/upload.jsp 商业供应链系统 http://218.207.88.11/web/epublic/upload.jsp 商业供应链系统 http://60.2.37.237:8080/web/epublic/upload.jsp 沈阳新一城商场经营管理有限公司 http://61.161.160.102:8080/web/epublic/upload.jsp 新朝阳购物中心网 http://60.10.134.176:8080/web/epublic/upload.jsp 东方购物广场有限公司SCM系统 http://60.213.49.66:8000/web/epublic/upload.jsp http://221.194.122.150/web/epublic/upload.jsp\n这套系统很多在7月的时候就被上传了webshellhttp://scm.brjt.cn:8081/web/upload/silicwebshell.jsp\n\n\n\nhttp://222.223.124.193:8081/web/upload/silicwebshell.jsp\n\n下面的部分就不截图了http://gyl.jxggls.com:8080/web/upload/silicwebshell.jsphttp://123.127.107.117/web/upload/silicwebshell.jsphttp://1.58.67.114/web/upload/silicwebshell.jsp另外还有目录列举，基本所有都可以：http://222.223.124.193:8081/web/upload/\n\nhttp://61.161.160.102:8080/web/epublic/\n\n   修复方案：  限制文件上传的类型和upload文件夹的脚本执行权限。关闭目录列举，删除webshell   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-08-11 10:31 厂商回复： CNVD确认并复现所述情况，已经由CNVD按以往联系渠道电话和邮件向软件生产厂商通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-06 13:28 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  哈哈！等下@sex is not show 就会来抱怨了，因为他的没有上首页 WooYun: 某商业链系统通用任意文件上传漏洞,直接Getshell    \n     2014-08-06 13:43 |    \t\tsex is not show  \t\t\t( 普通白帽子  |\t\t\t        Rank:1495 漏洞数:233        | 这家伙真懒！)\t\t \n  @U神 我抱怨也没用..     \n     2014-08-06 23:38 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @U神 我去？之前看到他另外一个，原来这个他提交过了的啊，还是叫狗哥撤了吧。你不发我还真没注意到。擦    \n     2014-08-06 23:38 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @疯狗  好像重复了    \n     2014-08-06 23:41 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @wefgod 好诚实的孩子    \n     2014-08-07 00:30 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @U神 重复了就没啥意义了留着在这又不是来搞诈骗，浪费大家的精力。我直接用搜索的当时没看见有人提交就放了    \n     2014-08-12 09:55 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @sex is not show @U神 狗哥没来    \n     2014-08-12 10:16 |    \t\tsex is not show  \t\t\t( 普通白帽子  |\t\t\t        Rank:1495 漏洞数:233        | 这家伙真懒！)\t\t \n  @wefgod 嗯，我再发商业链就都小厂商了.. 不知道他们怎么判断大小厂商的    \n     2014-08-20 13:23 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @sex is not show 悲剧咯，没办法，没看到你发过文件上传就发了，看到之前那个sql注入还是什么的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}