{"id": 46536, "wybug_id": "wooyun-2015-090308", "wybug_title": "中兴某网站文件上传绕过漏洞GetShell", "wybug_corp": "中兴通讯股份有限公司", "wybug_author": "深度安全实验室", "wybug_date": "2015-01-07 10:58", "wybug_open_date": "2015-02-21 11:00", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-21：\t细节向公众公开  简要描述：  详细说明：     漏洞证明：  1.\nhttp://www.appstar.com.cn\n还是应用之星网站，对上面的礼品非常感兴趣，最开始以为没有上传漏洞呢，想不到翻一页还有上传功能，哈哈，终于拿到shell了。2.在应用中心有上传应用功能，可以上传apk程序给大家分享。\n\n3.点击上传，然后会出现上传界面，第一步是上传apk程序，这里的上传是没有问题的，校验挺严格的，还会检查apk里面的文件，然后生产下一页的apk信息表。\n\n4.那就老老实实传一个apk程序上去，点击下一步，会出现一个界面要求你对刚上传的apk进行描述，这里可以上传几张应用的图片，这个地方有问题。\n\n5.直接上传一个jsp文件会提示错误：\n\n6.那把jsp文件后缀改成jpg，然后再用burpsuit拦截下来，把文件名改成jsp后缀就可以了：\n\n收到响应：\n\n7.直接在网址后面加上上面的路径找不到shell，上传了一张真是图片发现真实路径中间还多了一个/downloads/,\n\n那么真实路径就是：\nhttp://www.appstar.com.cn/downloads/out/20150106155151/1420530894269.jsp\n8.\n\n\n\n   修复方案：     版权声明：转载请注明来源 深度安全实验室@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-01-07 13:44 厂商回复： 感谢~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-07 10:59 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  天天研究中兴的孩子    \n     2015-01-07 14:31 |    \t\t用来怀念 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 不是什么人都一定要去拥有，有的东西最好用...)\t\t \n  中兴这都不把你招去？？？    \n     2015-01-07 16:34 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  中兴哪得罪你了    \n     2015-01-08 14:25 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  哈哈，刷系列的带上我哟！~    \n     2015-02-21 22:07 |    \t\t静默 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:6        | 安全小白)\t\t \n  中兴和你什么愁，什么怨，先刷人礼物，又拿人shell    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}