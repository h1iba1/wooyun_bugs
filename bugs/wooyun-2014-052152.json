{"id": 58152, "wybug_id": "wooyun-2014-052152", "wybug_title": "iSiteCMS最新版本一处鸡肋sql注射漏洞", "wybug_corp": "kometo.com", "wybug_author": "寂寞的瘦子", "wybug_date": "2014-02-27 15:23", "wybug_open_date": "2014-05-28 15:24", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-03：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-04-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-28：\t细节向公众公开  简要描述： 非常的鸡肋,但是我想到两种利用方式，感觉还是有点自欺欺人的感觉... 详细说明：   /iSite 2.0 RC1 B684/isite/components/menbers/menbers.be.php第259行\nfunction _ACT_create(){\t\t$this->setHtmlTitle(\"新增用户\");\t\tcAuth(AUTH_M_USER) or authMsg();\t\t$form = &$this->loadForm('user_create');\t\tif($form->status == TFORM_STATUS_GETED_VALID){\t\t\t$name = &$form->getItem('name');//接受form表单中传递过来的name的value\t\t\tif($this->DBE->getOne(\"select count(*) from #__user where `name` = '$name->value'\")>0){//这里带入查询\t\t\t\t$name->errMsg = '这个用户名已经有人在使用了!';\t\t\t\t$form->status = TFORM_STATUS_GETED;\t\t\t}else{\n为啥说鸡肋，以为注册的时候用户名的长度被限制在了20个字符，于是就傻逼了，感觉啥也干了...   漏洞证明：  \n\n'被带入查询了http://127.0.0.1/site/index.php?igo=iss,menbers,reg去注册用户利用方式一：需要有人注册如test' and 1=2#这样的用户名，带入sql语句执行是这样的select count(*) from flexi_user where `name`='test' and 1=2#'//是否有这个用户名这一句永远为假，如果判断为假则把这个name插入数据库（插入的时候过滤了）~~所以像这种用户的密码是可以重置的。。。利用方式二：还有一个就是使用sleep函数或者benchmark函数把数据库拖死~~简直掉渣啊...   修复方案：  还是建议过滤下   版权声明：转载请注明来源 寂寞的瘦子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2014-02-28 09:01 厂商回复： 确实存在给安全带来不确定性，将会在下一版本更新修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}