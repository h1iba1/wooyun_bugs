{"id": 31529, "wybug_id": "wooyun-2015-0113735", "wybug_title": "世纪新图建站系统某漏洞不用进后台直接拿shell", "wybug_corp": "深圳市世纪新图企业形象设计有限公司", "wybug_author": "崔超杰", "wybug_date": "2015-05-13 11:18", "wybug_open_date": "2015-06-27 11:20", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-13：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-06-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 客户挺多的，而且很多做外贸的 详细说明：  涉及网站类型为：品牌官网、专业外贸\n\n里面的一大半都可以直接拿shell，只测试了几个如下：\nhttp://www.isun3d.com/admin/upfile.php http://www.excelsz.com/admin/upfile.php http://www.ythkj.cn/admin/upfile.phphttp://www.xiliufu.com/admin/upfile.phphttp://www.uv-print.net/admin/upfile.phphttp://www.szyouyun.net/admin/upfile.phphttp://www.sunet-sz.com/admin/upfile.phphttp://www.teralinks.com/admin/upfile.phphttp://www.idiadem.com/admin/upfile.phphttp://www.xyintl.com/admin/upfile.phphttp://www.skilhunt.com/admin/upfile.php\n第一步：随便找个存在/admin/upfile.php文件的网站\n\n第二步：打开漏洞页面\n\n第三步：上传木马图片，并用burp进行抓包\n\n第四步：对木马图片进行00截断\n\n\n\n第五步：点击go进行上传，最后得到木马文件地址\n\n通过对网站图片url进行分析，测试得到木马保存地址为：/upfile/目录下通过上门过程，可以拿到shell如下\n建议审核把密码给mask下，只允许审核和厂商看，防止被人利用http://www.isun3d.com/upfile/201504020522488961.php       密码：hacker567http://www.excelsz.com/upfile/201505121915536504.php      密码：hacker567http://www.ythkj.cn/upfile/201505121916478712.php         密码：hacker567http://www.xiliufu.com/upfile/201505121117376368.php      密码：hacker567http://www.uv-print.net/upfile/201505121918223617.php     密码：hacker567http://www.szyouyun.net/upfile/201505121919086902.php     密码：hacker567http://www.sunet-sz.com/upfile/201505121919516808.php     密码：hacker567http://www.teralinks.com/upfile/201505120420317024.php    密码：hacker567http://www.idiadem.com/upfile/201505120421188597.php      密码：hacker567http://www.xyintl.com/upfile/201505121922216169.php       密码：hacker567http://www.skilhunt.com/upfile/201505120423116727.php     密码：hacker567\n   漏洞证明：  \nhttp://www.isun3d.com/admin/upfile.php http://www.excelsz.com/admin/upfile.php http://www.ythkj.cn/admin/upfile.phphttp://www.xiliufu.com/admin/upfile.phphttp://www.uv-print.net/admin/upfile.phphttp://www.szyouyun.net/admin/upfile.phphttp://www.sunet-sz.com/admin/upfile.phphttp://www.teralinks.com/admin/upfile.phphttp://www.idiadem.com/admin/upfile.phphttp://www.xyintl.com/admin/upfile.phphttp://www.skilhunt.com/admin/upfile.php\n\n建议审核把密码给mask下，只允许审核和厂商看，防止被人利用http://www.isun3d.com/upfile/201504020522488961.php       密码：hacker567http://www.excelsz.com/upfile/201505121915536504.php      密码：hacker567http://www.ythkj.cn/upfile/201505121916478712.php         密码：hacker567http://www.xiliufu.com/upfile/201505121117376368.php      密码：hacker567http://www.uv-print.net/upfile/201505121918223617.php     密码：hacker567http://www.szyouyun.net/upfile/201505121919086902.php     密码：hacker567http://www.sunet-sz.com/upfile/201505121919516808.php     密码：hacker567http://www.teralinks.com/upfile/201505120420317024.php    密码：hacker567http://www.idiadem.com/upfile/201505120421188597.php      密码：hacker567http://www.xyintl.com/upfile/201505121922216169.php       密码：hacker567http://www.skilhunt.com/upfile/201505120423116727.php     密码：hacker567\n   修复方案：  过滤   版权声明：转载请注明来源 崔超杰@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}