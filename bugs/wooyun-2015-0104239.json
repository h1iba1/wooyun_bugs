{"id": 35308, "wybug_id": "wooyun-2015-0104239", "wybug_title": "某省公共缴费平台漏洞合集(可shell)", "wybug_corp": "山东省电子商务综合运营管理有限公司", "wybug_author": "火焰真菌", "wybug_date": "2015-03-30 12:27", "wybug_open_date": "2015-05-18 14:20", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-18：\t细节向公众公开  简要描述： 某省公共缴费平台漏洞合集，任意手机号注册、短信轰炸，个人信息泄露、拿shell 详细说明：  某省公共缴费平台：www.elifepay.com.cn\n\n1：任意手机号码注册点击注册：随便填写手机号码、密码、手机验证码\n\n提交时抓包，并截取修改返回的false为true。注册成功。\n\n\n\n注册成功：\n\n2：短信轰炸在上面注册时在获取手机验证码时抓包。\n\nuserid就是手机号，因没有时间及次数限制，可无限次发送。\n\n3：个人信息：该平台提供水费、电费、燃气费、通信费用的查询，查询页面虽然有验证码，但鸡肋。\n\n以燃气费查询为例：此时随便输入缴费户号，抓包发现先进行验证码的验证，然后进行户号查询。\n\n\n\n此时userNO就是刚才输入的户号，可批量查看用户名称、家庭住址等信息\n\n水费貌似如果用户不欠费就不显示个人信息，话费的话只能呵呵了，查查那个土豪在用牛x号码4：struts S2-019\n\nroot权限，命令执行\n\n   漏洞证明：  某省公共缴费平台：www.elifepay.com.cn\n\n1：任意手机号码注册点击注册：随便填写手机号码、密码、手机验证码\n\n提交时抓包，并截取修改返回的false为true。注册成功。\n\n\n\n注册成功：\n\n2：短信轰炸在上面注册时在获取手机验证码时抓包。\n\nuserid就是手机号，因没有时间及次数限制，可无限次发送。\n\n3：个人信息：该平台提供水费、电费、燃气费、通信费用的查询，查询页面虽然有验证码，但鸡肋。\n\n以燃气费查询为例：此时随便输入缴费户号，抓包发现先进行验证码的验证，然后进行户号查询。\n\n\n\n此时userNO就是刚才输入的户号，可批量查看用户名称、家庭住址等信息\n\n水费貌似如果用户不欠费就不显示个人信息，话费的话只能呵呵了，查查那个土豪在用牛x号码4：struts S2-019\n\nroot权限，命令执行\n\n   修复方案：  你们懂得，把设备上yjsp.txt、yjsp.jsp、bjsp.txt、bjsp.jsp都删了吧   版权声明：转载请注明来源 火焰真菌@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-04-03 14:18 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给山东分中心，由其后续协调网站管理单位处置。按多个漏洞综合评分，rank 14 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}