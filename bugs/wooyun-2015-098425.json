{"id": 44843, "wybug_id": "wooyun-2015-098425", "wybug_title": "e代驾某业务系统设计缺陷可至所有代驾司机信息泄露(身份证/驾驶证/手机住址等)", "wybug_corp": "edaijia.cn", "wybug_author": "路人甲", "wybug_date": "2015-02-26 16:07", "wybug_open_date": "2015-04-13 16:58", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-13：\t细节向公众公开  简要描述： e代驾某业务系统设计缺陷可至所有代驾司机信息泄露 详细说明：  e代驾某业务系统设计缺陷可至所有代驾司机信息泄露，包括代驾人员的详细信息如：身份证驾驶证扫描件、手机号住址等等信息。为了保护厂商，本漏洞提交中隐去了敏感的账户信息，望乌云谅解。   漏洞证明：  第一步：获取密码利用https://mail.edaijia-inc.cn邮箱某地区运营代理账户弱口令登录邮箱获取到http://www.edaijia.cn/v2地区运营账户和密码，注意，他是一周一变动的。\n\n第二步：进入系统尝试登录该地区运营账户\n\n第三步：利用缺陷功能可以遍历查看所有代驾人员信息，该系统设计默认只能查看自己地区代驾员进入司机管理-司机资料\n\n点击详情查看文字资料\n\n点击上传其他资料可以查看身份证和驾驶证扫描件\n\n去掉url中的\n_middle?ver=1424936483\n可查看高清图遍历请求参数中的\nhttp://www.edaijia.cn/v2/index.php?r=driver/archives&id=XXyy\nid值即可获取所有驾驶员信息，其中XX为字母例如北京为BJ，yy为数字，从1-6，测试中发现大多数为5位数字。   修复方案：  1.zimbra邮箱登陆加入验证码机制2.严格限制业务逻辑，如北京运营人员禁止查看广州代驾信息。3.后台登陆密码不仅仅是每周更换，最好加入手机动态验证码验证机制。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-02-26 21:26 厂商回复： 是否感谢，已经处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}