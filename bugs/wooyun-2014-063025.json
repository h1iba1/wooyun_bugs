{"id": 3770, "wybug_id": "wooyun-2014-063025", "wybug_title": "12306逻辑漏洞：可批量修改账号他人密码", "wybug_corp": "中国铁道科学研究院", "wybug_author": "lijiejie", "wybug_date": "2014-06-01 11:02", "wybug_open_date": "2014-06-06 11:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-06：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 12306某处存在逻辑缺陷，可以大范围修改他人账号密码。 详细说明：  这两天在写一个HTTP扫描器，顺便拿12306测试。 发现一处逻辑缺陷，找回密码的功能位于：https://kyfw.12306.cn/otn/forgetPassword/initforgetMyPassword\n\n存在三个问题:1，不要验证码可以猜解 用户名 / 邮箱。输入用户名，点击提取问题，只要返回的existError为N，均是存在的用户。 12306用户太多，大量猜解毫不费力，包括去猜解留了公司邮箱的人。@baidu.com、@youku.com等。 得到这些员工的个人信息，拿到后可以社工，设法渗透对应的商业公司（只是思路，(⊙o⊙)）。2，找回密码的地方验证码没有立即过期。这是常见的验证码缺陷，问题也很严重。因为验证码可以反复使用，直接被绕过了。个人估计12306是考虑到了性能的关系，才没让它立即过期。3，通常密码提示答案都非常简单。  早些年通过回答问题破解163邮箱也蛮容易的不是？综合上述3个问题，演示漏洞利用就很简单了：1) 固定cookie和验证码2) 固定问题: 您的出生地是？3) 固定答案：北京4) 用户名直接用双拼做字典2)和3)还可以组合其他问题和答案，如果想破解更多的账号。有心人可以通过这个漏洞来获取大量个人信息。为了不影响太多用户，我只登陆了前面两个账号，在获取账号后及时终止了程序。   漏洞证明：  \n\n常用联系人泄露他人身份证和手机：\n\n   修复方案：  因为你们更专业，就不多说了   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-06-06 11:02 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-01 11:03 |    \t\t小学猹 \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:30        | 暮春者，春服既成，冠者五六人，童子六七人...)\t\t \n  - -火钳刘明    \n     2014-06-01 12:23 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB！    \n     2014-06-01 13:45 |    \t\tTenk \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 岂能尽如人意，但求无愧于心)\t\t \n  Mark    \n     2014-06-01 17:23 |    \t\t耐小心 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:5        | 噗 我是新手 新手求罩)\t\t \n  mark    \n     2014-06-01 17:56 |    \t\t未了 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | 我在乌云网，你在哪)\t\t \n  这么吊    \n     2014-06-01 21:48 |    \t\t小火苗 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 我是一只小火苗呀，春风吹又生呀...)\t\t \n  改密码还能带批量的？我受惊了。    \n     2014-06-06 18:36 |    \t\t49miner \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 哈喽)\t\t \n  搜噶    \n     2014-06-06 21:33 |    \t\tnextdoor \t\t\t( 普通白帽子  |\t\t\t        Rank:325 漏洞数:74        )\t\t \n  被忽略    \n     2014-06-07 13:00 |    \t\t未了 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | 我在乌云网，你在哪)\t\t \n  洞主，提交中文答案出错怎么破 burpsuit    \n     2014-06-07 13:40 |    \t\tlijiejie  \t\t\t( 核心白帽子 |\t\t\t        Rank:2210 漏洞数:294        | Just for fun.)\t\t \n  @未了  需要先UTF-8 urlEncode    \n     2014-06-07 14:10 |    \t\t未了 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | 我在乌云网，你在哪)\t\t \n  这个可以有！    \n     2014-06-11 16:08 |    \t\tGrayTrack \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:14        | 灰色轨迹)\t\t \n  好思路    \n     2014-07-10 17:36 |    \t\tRovegaby \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 努力)\t\t \n  好多网站都有  有的用户名直接是邮件  关键是社工比较麻烦    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}