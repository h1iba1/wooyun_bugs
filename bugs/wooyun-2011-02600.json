{"id": 22425, "wybug_id": "wooyun-2011-02600", "wybug_title": "17173整站源码泄露", "wybug_corp": "17173游戏", "wybug_author": "路人甲", "wybug_date": "2011-07-31 19:19", "wybug_open_date": "2011-08-05 21:00", "wybug_type": "系统/服务运维配置不当", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设置不当", "源码泄漏", "服务配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-07-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-08-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 17173分站由于配置不当，导致源码泄露，包括数据库账号密码 详细说明：  \n\n   漏洞证明：  \n<?php\tinclude_once(\"../include/config.php\");\tinclude_once(\"../include/db.php\");\tinclude_once(\"inc.php\");?><?php\t//读取指定数据\t$str \t  = filter($_REQUEST[\"str\"]);\t$classStr = filter($_REQUEST[\"classStr\"]);\tif(!empty($classStr)){\t\t$classStr = substr($classStr,0,-1);\t\t$classStr = split(\",\",$classStr);\t}\tif (!is_array($classStr)) {\t\t$classStr = array(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);\t}\t$conn = new MyAdodb($DbHost,$DbName,$DbUser,$DbPwd);\t$conn->OpenDB();?><!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\" /><title>17173·天龙八部数据库</title><link href=\"css/master.css\" rel=\"stylesheet\" type=\"text/css\" /><SCRIPT LANGUAGE=\"JavaScript\" src=\"js/ajax.js\"></SCRIPT><SCRIPT LANGUAGE=\"JavaScript\" src=\"js/tkl_pagelist.js\"></SCRIPT><script type=\"text/javascript\"> function addBookmark(title,url) {        if( document.all ) {            window.external.AddFavorite( url, title);        } else if (window.sidebar) {            window.sidebar.addPanel(title, url,\"\");        } else if( window.opera && window.print ) {            return true;        }}function setValue(){\tObj = getObject(\"a\");\tvar i = 0;\tvar strValue = \"\";\tfor(var j = 0;j < Obj.length; j++){\t\t//alert(j+\"|\"+Obj[j].value+\"|\"+Obj[j].checked);\t\tif(true == Obj[j].checked ){\t\t\ti++;\t\t\tstrValue += Obj[j].value+\",\";\t\t}\t}\tif (i < 1) {\t\talert(\"请选择搜索分类！\");\t\treturn false;\t}\tdocument.form1.classStr.value = strValue;\t//alert(Obj.length+\"|\"+strValue);}/**检查表单**/function checkForm(){\tsetValue();\tObj = document.form1;\tif (Obj.str.value.length < 2){\t\talert(\"请输入2位以上的关键字！\");\t\tObj.str.focus();\t\treturn false;\t}}//设置指定id的选项function SetCheckBox(str){\tvar tempStr,reg;\tvar ObjectField_1 = getObject(\"a\");\tvar i=0,len;\tlen = ObjectField_1.length;  if (len == null) {    \tlen=1;  }  if (len == 1){    \treg = eval(\"/,\"+ObjectField_1.value+\",/g\");    \ttempStr = str.replace(reg,\"\");    \tif (tempStr.length < str.length) {    \t\tObjectField_1.checked = true;    \t}   }else{\t  for ( j = 0; j < len; j++){\t    \treg = eval(\"/,\"+ObjectField_1[j].value+\",/g\");    \t\ttempStr = str.replace(reg,\"\");    \t\tif (tempStr.length < str.length) {\t    \t\tObjectField_1[j].checked = true;\t\t\t\t}\t\t}\t}}//读取对像function getObject(objectId) {   if (document.all && document.all(objectId)) { \t\t\treturn document.all(objectId);   }else if(document.getElementById && document.getElementById(objectId)) { \t\t\treturn document.getElementById(objectId);   }else if(document.getElementsByName && document.getElementsByName(objectId)) { \t\t\treturn document.getElementsByName(objectId);   }else { \t\t\treturn false;   }}</script></head><body><div id=\"wrapper\">  <div id=\"wrapperLeft\">    <div id=\"innerWrapperLeft\">      <div id=\"panelSearch\">        <div id=\"panelSearchTop\"><?php include(\"header.html\"); ?></div>        <div id=\"panelSearchContent\">        <table width=\"95%\" border=\"0\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\">         <form name=\"form1\" method=\"get\" action=\"search.php\" onsubmit=\"return checkForm();\">          <tr>            <td align=\"center\">              综合搜索：                <input name=\"str\" type=\"text\" id=\"str\" style=\"width:200px;\" value=\"\"/>                <input type=\"hidden\" value=\"\" name=\"classStr\">                <input type=\"image\" name=\"imageField\" id=\"imageField\"src=\"http://ue1.17173.itc.cn/tldb/sousuo.jpg\" style=\"width:49px; height:20px; border:none;\"/>            </td>          </tr>          <tr>              <td style=\"padding-bottom:10px; text-align:center;\">                <input type=\"checkbox\" name=\"a\" value=\"1\" checked  style=\"width: 20px;\"/> 装备                <input type=\"checkbox\" name=\"a\" value=\"2\" checked style=\"width: 20px;\"/> 套装                <input type=\"checkbox\" name=\"a\" value=\"3\" checked style=\"width: 20px;\"/> 珍兽                <input type=\"checkbox\" name=\"a\" value=\"4\" checked style=\"width: 20px;\"/> 技能                <input type=\"checkbox\" name=\"a\" value=\"5\" checked style=\"width: 20px;\"/> 元宝                <input type=\"checkbox\" name=\"a\" value=\"6\" checked style=\"width: 20px;\"/> 任务                <input type=\"checkbox\" name=\"a\" value=\"7\" checked style=\"width: 20px;\"/> 地图                <input type=\"checkbox\" name=\"a\" value=\"8\" checked style=\"width: 20px;\"/> 怪物                <input type=\"checkbox\" name=\"a\" value=\"9\" checked style=\"width: 20px;\"/> NPC                <input type=\"checkbox\" name=\"a\" value=\"10\" checked style=\"width: 20px;\"/> 物品              </td>\t\t\t</tr>          </form>        </table>        </div>        <div class=\"clear\"></div>      </div>      <?php if(!empty($classStr)){?>      <div id=\"dh\">      <?php\t  for ($j = 0; $j < count($classStr); $j++){\t  \t$a = $classStr[$j];\t\tswitch($a){\t\t\t\tcase 1:\t\t\t\t\t$ItemClass = \"&nbsp;装备&nbsp;\";\t\t\t\t\tbreak;\t\t\t\tcase 2:\t\t\t\t\t$ItemClass = \"&nbsp;套装&nbsp;\";\t\t\t\t\tbreak;\t\t\t\tcase 3:\t\t\t\t\t$ItemClass = \"&nbsp;珍兽&nbsp;\";\t\t\t\t\tbreak;\t\t\t\tcase 4:\t\t\t\t\t$ItemClass = \"&nbsp;技能&nbsp;\";\t\t\t\t\tbreak;\t\t\t\tcase 5:\t\t\t\t\t$ItemClass = \"&nbsp;元宝&nbsp;\";\t\t\t\t\tbreak;\t\t\t\tcase 6:\t\t\t\t\t$ItemClass = \"&nbsp;任务&nbsp;\";\t\t\t\t\tbreak;\t\t\t\tcase 7:\t\t\t\t\t$ItemClass = \"&nbsp;地图&nbsp;\";\t\t\t\t\tbreak;\t\t\t\tcase 8:\t\t\t\t\t$ItemClass = \"&nbsp;怪物&nbsp;\";\t\t\t\t\tbreak;\t\t\t\tcase 9:\t\t\t\t\t$ItemClass = \"&nbsp;NPC&nbsp;\";\t\t\t\t\tbreak;\t\t\t\tcase 10:\t\t\t\t\t$ItemClass = \"&nbsp;物品&nbsp;\";\t\t\t\t\tbreak;\t\t}\t  ?>      <div id=\"content<?=$j+1?>\"><?=$ItemClass?></div>      <?php } ?>      </div>\t  <?php\t\tfor ($j = 0; $j < count($classStr); $j++){\t\t\t$a = $classStr[$j];\t\t\tswitch($a){\t\t\t\tcase 1:\t\t\t\t\t$table = \"tl_eqiupment\";\t\t\t\t\t$sqlWhere = \" where ItemName like BINARY '%\".$str.\"%' group by ItemName\";\t\t\t\t\tbreak;\t\t\t\tcase 2:\t\t\t\t\t$table = \"tl_taozhuang\";\t\t\t\t\t$sqlWhere = \" where ItemName like BINARY '%\".$str.\"%'\";\t\t\t\t\tbreak;\t\t\t\tcase 3:\t\t\t\t\t$table = \"tl_bb\";\t\t\t\t\t$sqlWhere = \" where ItemName like BINARY '%\".$str.\"%'\";\t\t\t\t\tbreak;\t\t\t\tcase 4:\t\t\t\t\t$table = \"tl_skill\";\t\t\t\t\t$sqlWhere = \" where ItemName like BINARY '%\".$str.\"%'\";\t\t\t\t\tbreak;\t\t\t\tcase 5:\t\t\t\t\t$table = \"tl_yuanbao\";\t\t\t\t\t$sqlWhere = \" where ItemName like BINARY '%\".$str.\"%'\";\t\t\t\t\tbreak;\t\t\t\tcase 6:\t\t\t\t\t$table = \"tl_questinfo\";\t\t\t\t\t$sqlWhere = \" where ItemName like BINARY '%\".$str.\"%' group by ItemName\";\t\t\t\t\tbreak;\t\t\t\tcase 7:\t\t\t\t\t$table = \"tl_map\";\t\t\t\t\t$sqlWhere = \" where ItemName like BINARY '%\".$str.\"%'\";\t\t\t\t\tbreak;\t\t\t\tcase 8:\t\t\t\t\t$table = \"tl_monster\";\t\t\t\t\t$sqlWhere = \" where ItemName like BINARY '%\".$str.\"%'\";\t\t\t\t\tbreak;\t\t\t\tcase 9:\t\t\t\t\t$table = \"tl_npc\";\t\t\t\t\t$sqlWhere = \" where ItemName like BINARY '%\".$str.\"%'\";\t\t\t\t\tbreak;\t\t\t\tcase 10:\t\t\t\t\t$table = \"tl_things\";\t\t\t\t\t$sqlWhere = \" where ItemName like BINARY '%\".$str.\"%'\";\t\t\t\t\tbreak;\t\t\t\tdefault:\t\t\t\t\t$table = \"\";\t\t\t}\t\t\t$sqlStr = \"select * from \".$table.$sqlWhere.\" limit 0,20\";\t\t\t$rs = $conn->ReadDB($sqlStr);\t\t?>        <div id=\"ccontent<?=$j+1?>\">        <div class=\"panelRevelation\">        <div id=\"panelRevelationTop\">          <div class=\"p12 cWhite current\">显示前 <?=count($rs)?> 条记录</div>          <div class=\"p12 cWhite pagination\"></div>        </div>        <div id=\"panelRevelationList\">          <div id=\"innerPanelRevelationList\">        <?php if($a == 1){ ?>            <div class=\"dl\">              <div class=\" p14 cBlack backgroundGray dt\">【图标】</div>              <div class=\" p14 cBlack backgroundGray dd col13\">【装备名称】</div>              <div class=\" p14 cBlack backgroundGray dd col16\">【装备种类】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【装备类型】</div>              <div class=\" p14 cBlack backgroundGray dd col15\">【等级】</div>              <div class=\" p14 cBlack backgroundGray dd col15\">【外功】</div>              <div class=\" p14 cBlack backgroundGray dd col15\">【内功】</div>              <div class=\" p14 cBlack backgroundGray dd col15\">【外防】</div>              <div class=\" p14 cBlack backgroundGray dd col15\">【内防】</div>              <div class=\" p14 cBlack backgroundGray dd col15\">【命中】</div>              <div class=\" p14 cBlack backgroundGray dd col15\">【闪避】</div>            </div>            <?php for($i=0;$i<count($rs);$i++){ ?>            <div class=\"dl\" onmouseover=\"currentcolor=this.style.backgroundColor;this.style.backgroundColor='#E5F0EA'\" onmouseout=\"this.style.backgroundColor=currentcolor\">              <div class=\"p14 dt\"><a href=\"arm.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><img src=\"http://ue1.17173.itc.cn/tldb/images/<?=$rs[$i]['FileName']?>.jpg\" width=\"41\" height=\"42\" border=\"0\"  onMouseOver=\"Face_MouseOver(event,1,<?=$rs[$i]['ClassID']?>)\" onMouseOut=\"Face_MouseOut()\"/></a></div>              <div class=\" p14 cBlack dd col13\"><span onMouseOver=\"Face_MouseOver(event,1,<?=$rs[$i]['ClassID']?>)\" onMouseOut=\"Face_MouseOut()\"><a href=\"arm.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><?=$rs[$i]['ItemName']?></a></span></div>              <div class=\" p14 cBlack dd col16\"><a href=\"arms.php?ClassType=<?=$rs[$i]['ClassType']?>\"><?=$rs[$i]['ClassType']?></a></div>              <div class=\" p14 cBlack dd colTwo\"><a href=\"arms.php?ItemClass=<?=$rs[$i]['ItemClass']?>\"><?=$rs[$i]['ItemClass']?></a></div>              <div class=\" p14 cBlack dd col15\"><a href=\"arms.php?MinLv=<?=$rs[$i]['Lv']?>&MaxLv=<?=$rs[$i]['Lv']?>\"><?=$rs[$i]['Lv']?></a></div>              <div class=\" p14 cBlack dd col15\"><?=$rs[$i]['OATK']>0?$rs[$i]['OATK']:0?></div>              <div class=\" p14 cBlack dd col15\"><?=$rs[$i]['IATK']>0?$rs[$i]['IATK']:0?></div>              <div class=\" p14 cBlack dd col15\"><?=$rs[$i]['ODEF']>0?$rs[$i]['ODEF']:0?></div>              <div class=\" p14 cBlack dd col15\"><?=$rs[$i]['IDEF']>0?$rs[$i]['IDEF']:0?></div>              <div class=\" p14 cBlack dd col15\"><?=$rs[$i]['Hit']>0?$rs[$i]['Hit']:0?></div>              <div class=\" p14 cBlack dd col15\"><?=$RS[$i]['Avoid']>0?$RS[$i]['Avoid']:0?></div>            </div>            <?php } ?>        <?php }else if($a == 2){ ?>            <div class=\"dl\">              <div class=\" p14 cBlack backgroundGray dd colTwo\">【套装名称】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【套装类型】</div>              <div class=\" p14 cBlack backgroundGray dd colFour\">【等级】</div>              <div class=\" p14 cBlack backgroundGray dd colFour\">【件数】</div>              <div class=\" p14 cBlack backgroundGray dd colEleven\">【附加属性】</div>            </div>            <?php for($i=0;$i<count($rs);$i++){ ?>            <div class=\"dl\" onmouseover=\"currentcolor=this.style.backgroundColor;this.style.backgroundColor='#E5F0EA'\" onmouseout=\"this.style.backgroundColor=currentcolor\">              <div class=\" p14 cBlack dd colTwo\"><span onMouseOver=\"Face_MouseOver(event,2,<?=$rs[$i]['ClassID']?>)\" onMouseOut=\"Face_MouseOut()\"><a href=\"suit.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><?=$rs[$i]['ItemName']?></a></span></div>              <div class=\" p14 cBlack dd colTwo\"><a href=\"suits.php?ItemClass=<?=$rs[$i]['ItemClass']?>\"><?=$rs[$i]['ItemClass']?></a></div>              <div class=\" p14 cBlack dd colFour\"><a href=\"suits.php?MinLv=<?=$rs[$i]['Lv']?>&MaxLv=<?=$rs[$i]['Lv']?>\"><?=$rs[$i]['Lv']?></a></div>              <div class=\" p14 cBlack dd colFour\"><a href=\"suits.php?Nums=<?=$rs[$i]['Nums']?>\"><?=$rs[$i]['Nums']?></a></div>              <div class=\" p14 cBlack dd colEleven\"><?=$rs[$i]['AdditionalEffects']?></div>              </div>            <?php } ?>        <?php }else if($a == 3){ ?>            <div class=\"dl\">              <div class=\" p14 cBlack backgroundGray dt\">【图标】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【珍兽名称】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【战斗类型】</div>              <div class=\" p14 cBlack backgroundGray dd colThree\">【等级】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【食物类别】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【标准寿命】</div>              <div class=\" p14 cBlack backgroundGray dd colSix\">【自带技能】</div>            </div>            <?php for($i=0;$i<count($rs);$i++){ ?>            <div class=\"dl\" onmouseover=\"currentcolor=this.style.backgroundColor;this.style.backgroundColor='#E5F0EA'\" onmouseout=\"this.style.backgroundColor=currentcolor\">              <div class=\"p14 dt\"><a href=\"baby.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><img src=\"http://ue1.17173.itc.cn/tldb/images/<?=getImage($rs[$i]['FileName'])?>.jpg\" width=\"41\" height=\"42\" border=\"0\"  onMouseOver=\"Face_MouseOver(event,3,<?=$rs[$i]['ClassID']?>)\" onMouseOut=\"Face_MouseOut()\"/></a></div>              <div class=\" p14 cBlack dd colTwo\"><span onMouseOver=\"Face_MouseOver(event,3,<?=$rs[$i]['ClassID']?>)\" onMouseOut=\"Face_MouseOut()\"><a href=\"baby.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><?=$rs[$i]['ItemName']?></a></span></div>              <div class=\" p14 cBlack dd colTwo\"><a href=\"babys.php?Fight=<?=$rs[$i]['Fight']?>\"><?=$rs[$i]['Fight']?></a></div>              <div class=\" p14 cBlack dd colThree\"><a href=\"babys.php?Lv=<?=$rs[$i]['Lv']?>\"><?=$rs[$i]['Lv']?></a></div>              <div class=\" p14 cBlack dd colTwo\"><a href=\"babys.php?Food=<?=$rs[$i]['Food']?>\"><?=$rs[$i]['Food']?></a></div>              <div class=\" p14 cBlack dd colTwo\"><a href=\"babys.php?Age=<?=$rs[$i]['Age']?>\"><?=$rs[$i]['Age']?></a></div>              <div class=\" p14 cBlack dd colSix\"><?=getSkillNameById($rs[$i]['SkillID1'])?><?=getSkillNameById($rs[$i]['SkillID2'])?><?=getSkillNameById($rs[$i]['SkillID3'])?><?=getSkillNameById($rs[$i]['SkillID4'])?><?=getSkillNameById($rs[$i]['SkillID5'])?></div>            </div>            <?php } ?>        <?php }else if($a == 4){ ?>            <div class=\"dl\">              <div class=\" p14 cBlack backgroundGray dt\">【图标】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【技能名称】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【技能分类】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【技能类型】</div>              <div class=\" p14 cBlack backgroundGray dd colTen\">【学习要求】</div>              <div class=\" p14 cBlack backgroundGray dd col14\">【冷却时间】</div>            </div>            <?php for($i=0;$i<count($rs);$i++){ ?>            <div class=\"dl\" onmouseover=\"currentcolor=this.style.backgroundColor;this.style.backgroundColor='#E5F0EA'\" onmouseout=\"this.style.backgroundColor=currentcolor\">              <div class=\"p14 dt\"><a href=\"skill.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><img src=\"http://ue1.17173.itc.cn/tldb/images/<?=$rs[$i]['FileName']?>.jpg\" width=\"41\" height=\"42\" border=\"0\"  onMouseOver=\"Face_MouseOver(event,4,<?=$rs[$i]['ClassID']?>)\" onMouseOut=\"Face_MouseOut()\"/></a></div>              <div class=\" p14 cBlack dd colTwo\"><span onMouseOver=\"Face_MouseOver(event,4,<?=$rs[$i]['ClassID']?>)\" onMouseOut=\"Face_MouseOut()\"><a href=\"skill.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><?=$rs[$i]['ItemName']?></a></span></div>              <div class=\" p14 cBlack dd colTwo\"><a href=\"skills.php?ClassType=<?=$rs[$i]['ClassType']?>\"><?=$rs[$i]['ClassType']?></a></div>              <div class=\" p14 cBlack dd colTwo\"><a href=\"skills.php?ItemClass=<?=$rs[$i]['ItemClass']?>\"><?=$rs[$i]['ItemClass']?></a></div>              <div class=\" p14 cBlack dd colTen\"><?=$rs[$i]['Condition']?$rs[$i]['Condition']:\"&nbsp;\"?></div>              <div class=\" p14 cBlack dd col14\">              <?php\t\t\t  \tif($rs[$i]['ClassType']=='门派战斗技能'){\t\t\t\t\techo $rs[$i]['CoolTime']?$rs[$i]['CoolTime'].\"秒\":\"瞬发\";\t\t\t\t\techo strpos($rs[$i]['CoolTime'],'-')?\"（随心法等级提高而减少）\":\"\";\t\t\t\t}\t\t\t\telse\t\t\t\t\techo \"&nbsp;\";\t\t\t  ?>              </div>              </div>            <?php } ?>        <?php }else if($a == 5){ ?>            <div class=\"dl\">              <div class=\" p14 cBlack backgroundGray dt\">【图标】</div>              <div class=\" p14 cBlack backgroundGray dd colEight\">【物品名称】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【物品类别】</div>              <div class=\" p14 cBlack backgroundGray dd colFour\">【等级】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【使用等级】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【使用期限】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【元宝价格】</div>              <div class=\" p14 cBlack backgroundGray dd colTen\">【功能属性】</div>            </div>            <?php for($i=0;$i<count($rs);$i++){ ?>            <div class=\"dl\" onmouseover=\"currentcolor=this.style.backgroundColor;this.style.backgroundColor='#E5F0EA'\" onmouseout=\"this.style.backgroundColor=currentcolor\">              <div class=\"p14 dt\"><a href=\"gold.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><img src=\"http://ue1.17173.itc.cn/tldb/<?=$rs[$i]['FileName']?>\" width=\"41\" height=\"42\" border=\"0\"  onMouseOver=\"Face_MouseOver(event,5,<?=$rs[$i]['ClassID']?>)\" onMouseOut=\"Face_MouseOut()\"/></a></div>              <div class=\" p14 cBlack dd colEight\"><span onMouseOver=\"Face_MouseOver(event,5,<?=$rs[$i]['ClassID']?>)\" onMouseOut=\"Face_MouseOut()\"><a href=\"gold.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><?=$rs[$i]['ItemName']?></a></span></div>              <div class=\" p14 cBlack dd colTwo\"><a href=\"golds.php?ItemClass=<?=$rs[$i]['ItemClass']?>\"><?=$rs[$i]['ItemClass']?></a></div>              <div class=\" p14 cBlack dd colFour\"><a href=\"golds.php?MinLv=<?=$rs[$i]['Lv']?>&MaxLv=<?=$rs[$i]['Lv']?>\"><?=$rs[$i]['Lv']?></a></div>              <div class=\" p14 cBlack dd colTwo\"><?=$rs[$i]['UseLv']?></div>              <div class=\" p14 cBlack dd colTwo\"><?=$rs[$i]['DeadLine']?></div>             <div class=\" p14 cBlack dd colTwo\"><?=$rs[$i]['Cost']?></div>             <div class=\" p14 cBlack dd colTen\"><a href=\"golds.php?Property=<?=$rs[$i]['Property']?>\"><?=$rs[$i]['Property']?></a></div>            </div>            <?php } ?>        <?php }else if($a == 6){ ?>            <div class=\"dl\">              <div class=\" p14 cBlack backgroundGray dd colSix\">【任务名称】</div>              <div class=\" p14 cBlack backgroundGray dd colNine\">【任务类别】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【等级】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【所在地图】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【金钱奖励】</div>              <div class=\" p14 cBlack backgroundGray dd colEight\">【经验奖励】</div>            </div>            <?php for($i=0;$i<count($rs);$i++){ ?>            <div class=\"dl\" onmouseover=\"currentcolor=this.style.backgroundColor;this.style.backgroundColor='#E5F0EA'\" onmouseout=\"this.style.backgroundColor=currentcolor\">              <div class=\" p14 cBlack dd colSix\"><a href=\"questinfo.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><?=$rs[$i]['ItemName']?></a></div>              <div class=\" p14 cBlack dd colNine\"><a href=\"questinfos.php?ItemClass=<?=$rs[$i]['ItemClass']?>\"><?=$rs[$i]['ItemClass']?></a></div>              <div class=\" p14 cBlack dd colTwo\"><a href=\"questinfos.php?MinLv=<?=$rs[$i]['Lv']?>&MaxLv=<?=$rs[$i]['Lv']?>\"><?=$rs[$i]['Lv']?></a></div>              <div class=\" p14 cBlack dd colTwo\"><?=getMapById($rs[$i]['StartMap'])?></div>             <div class=\" p14 cBlack dd colTwo\"><?=$rs[$i]['Money']?></div>             <div class=\" p14 cBlack dd colEight\"><?=$rs[$i]['Experience']?></div>            </div>            <?php } ?>        <?php }else if($a == 7){ ?>            <div class=\"dl\">              <div class=\" p14 cBlack backgroundGray dd colTwo\">【地图名称】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【地图类型】</div>              <div class=\" p14 cBlack backgroundGray dd colFive\">【地图说明】</div>            </div>            <?php for($i=0;$i<count($rs);$i++){ ?>            <div class=\"dl\" onmouseover=\"currentcolor=this.style.backgroundColor;this.style.backgroundColor='#E5F0EA'\" onmouseout=\"this.style.backgroundColor=currentcolor\">              <div class=\" p14 cBlack dd colTwo\"><a href=\"map.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><?=$rs[$i]['ItemName']?></a></div>              <div class=\" p14 cBlack dd colTwo\"><a href=\"maps.php?ItemClass=<?=$rs[$i]['ItemClass']?>\"><?=$rs[$i]['ItemClass']?></a></div>              <div class=\" p14 cBlack dd colFive\" title=\"<?=str_replace(\"#r\",\" \",$rs[$i]['DescItem'])?>\"><?=substr_cut(str_replace(\"#r\",\" \",$rs[$i]['DescItem']),88)?></div>            </div>            <?php } ?>        <?php }else if($a == 8){ ?>            <div class=\"dl\">              <div class=\" p14 cBlack backgroundGray dt\">【图标】</div>              <div class=\" p14 cBlack backgroundGray dd colEight\">【怪物名称】</div>              <div class=\" p14 cBlack backgroundGray dd colNine\">【等级】</div>\t\t\t  <div class=\" p14 cBlack backgroundGray dd colNine\">【经验】</div>              <div class=\" p14 cBlack backgroundGray dd colSeven\">【所在地图】</div>\t\t\t  <div class=\" p14 cBlack backgroundGray dd col13\">【坐标】</div>            </div>            <?php for($i=0;$i<count($rs);$i++){ ?>            <div class=\"dl\" onmouseover=\"currentcolor=this.style.backgroundColor;this.style.backgroundColor='#E5F0EA'\" onmouseout=\"this.style.backgroundColor=currentcolor\">              <div class=\"p14 dt\"><a href=\"monster.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><img src=\"http://ue1.17173.itc.cn/tldb/images/<?=getImage($rs[$i]['FileName'])?>.jpg\" width=\"41\" height=\"42\" border=\"0\"  onMouseOver=\"Face_MouseOver(event,7,<?=$rs[$i]['ClassID']?>)\" onMouseOut=\"Face_MouseOut()\"/></a></div>              <div class=\" p14 cBlack dd colEight\"><span onMouseOver=\"Face_MouseOver(event,7,<?=$rs[$i]['ClassID']?>)\" onMouseOut=\"Face_MouseOut()\"><a href=\"monster.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><?=$rs[$i]['ItemName']?><? if($rs[$i]['ItemClass']=='BOSS怪物') echo \"<font color=red>[boss]</font>\";?></a></span>              </div>              <div class=\" p14 cBlack dd colNine\"><?=$rs[$i]['Lv']?></div>\t\t\t  <div class=\" p14 cBlack dd colNine\"><?=$rs[$i]['Experience']?$rs[$i]['Experience']:\"&nbsp;\"?></div>              <div class=\" p14 cBlack dd colSeven\"><?=getMapByName($rs[$i]['Map'])?></div>\t\t\t  <div class=\" p14 cBlack dd col13\">\t\t\t  <? if($rs[$i]['ItemClass']!='首领头目'){ ?><?=$rs[$i]['Points']?\"(\".str_replace(\"&\",\",\",$rs[$i]['Points']).\")\":\"&nbsp;\"?><? }else echo \"多处\"; ?></div>\t\t\t  </div>            <?php } ?>        <?php }else if($a == 9){ ?>            <div class=\"dl\">              <div class=\" p14 cBlack backgroundGray dt\">【图标】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【NPC名称】</div>              <div class=\" p14 cBlack backgroundGray dd colFour\">【类别】</div>              <div class=\" p14 cBlack backgroundGray dd colEight\">【称号】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【所在地图】</div>              <div class=\" p14 cBlack backgroundGray dd colEight\">【位置】</div>              <div class=\" p14 cBlack backgroundGray dd col12\">【职能】</div>            </div>            <?php for($i=0;$i<count($rs);$i++){ ?>            <div class=\"dl\" onmouseover=\"currentcolor=this.style.backgroundColor;this.style.backgroundColor='#E5F0EA'\" onmouseout=\"this.style.backgroundColor=currentcolor\">              <div class=\"p14 dt\"><? if(strlen($rs[$i]['FileName'])){ ?><a href=\"npc.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><img src=\"http://ue1.17173.itc.cn/tldb/images/<?=getImage($rs[$i]['FileName'])?>.jpg\" width=\"37\" height=\"38\" border=\"0\"  onMouseOver=\"Face_MouseOver(event,6,<?=$rs[$i]['ClassID']?>)\" onMouseOut=\"Face_MouseOut()\"/></a>              <?php }else echo \"&nbsp;\"; ?></div>              <div class=\" p14 cBlack dd colTwo\"><span onMouseOver=\"Face_MouseOver(event,6,<?=$rs[$i]['ClassID']?>)\" onMouseOut=\"Face_MouseOut()\"><a href=\"npc.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><?=$rs[$i]['ItemName']?></a></span></div>              <div class=\" p14 cBlack dd colFour\"><a href=\"npcs.php?ItemClass=<?=$rs[$i]['ItemClass']?>\"><?=$rs[$i]['ItemClass']?></a></div>              <div class=\" p14 cBlack dd colEight\"><?=$rs[$i]['Title']?$rs[$i]['Title']:\"&nbsp;\"?></div>              <div class=\" p14 cBlack dd colTwo\"><?=getMapByName($rs[$i]['Map'])?></div>             <div class=\" p14 cBlack dd colEight\"><?=$rs[$i]['Place']?></div>             <div class=\" p14 cBlack dd col12\"><a href=\"npcs.php?Duty=<?=$rs[$i]['Duty']?>\"><?=$rs[$i]['Duty']?$rs[$i]['Duty']:\"&nbsp;\"?></a></div>            </div>            <?php } ?>        <?php }else if($a == 10){ ?>            <div class=\"dl\">              <div class=\" p14 cBlack backgroundGray dt\">【图标】</div>              <div class=\" p14 cBlack backgroundGray dd col13\">【装备名称】</div>              <div class=\" p14 cBlack backgroundGray dd col16\">【物品分类】</div>              <div class=\" p14 cBlack backgroundGray dd colTwo\">【物品类型】</div>              <div class=\" p14 cBlack backgroundGray dd col15\">【等级】</div>              <div class=\" p14 cBlack backgroundGray dd colNine\">【物品用途】</div>              <div class=\" p14 cBlack backgroundGray dd col18\">【获取路径】</div>            </div>            <?php for($i=0;$i<count($rs);$i++){ ?>            <div class=\"dl\" onmouseover=\"currentcolor=this.style.backgroundColor;this.style.backgroundColor='#E5F0EA'\" onmouseout=\"this.style.backgroundColor=currentcolor\">              <div class=\"p14 dt\"><a href=\"thing.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><img src=\"http://ue1.17173.itc.cn/tldb/images/<?=$rs[$i]['FileName']?>.jpg\" width=\"41\" height=\"42\" border=\"0\"  onMouseOver=\"Face_MouseOver(event,8,<?=$rs[$i]['ClassID']?>)\" onMouseOut=\"Face_MouseOut()\"/></a></div>              <div class=\" p14 cBlack dd col13\"><span onMouseOver=\"Face_MouseOver(event,8,<?=$rs[$i]['ClassID']?>)\" onMouseOut=\"Face_MouseOut()\"><a href=\"thing.php?id=<?=$rs[$i]['ClassID']?>\" target=\"_blank\"><?=$rs[$i]['ItemName']?></a></span></div>              <div class=\" p14 cBlack dd col16\"><a href=\"things.php?ClassType=<?=$rs[$i]['ClassType']?>\"><?=$rs[$i]['ClassType']?></a></div>              <div class=\" p14 cBlack dd colTwo\"><a href=\"things.php?ItemClass=<?=$rs[$i]['ItemClass']?>\"><?=$rs[$i]['ItemClass']?></a></div>              <div class=\" p14 cBlack dd col15\"><a href=\"things.php?MinLv=<?=$rs[$i]['Lv']?>&MaxLv=<?=$rs[$i]['Lv']?>\"><?=$rs[$i]['Lv']?></a></div>              <div class=\" p14 cBlack dd colNine\"><?=$rs[$i]['Uses']?$rs[$i]['Uses']:\"&nbsp;\"?></div>              <div class=\" p14 cBlack dd col18\" title=\"<?=filters($rs[$i]['GetWay'])?>\"><?=filters(getMapByName(substr_cut($rs[$i]['GetWay'],32)))?></div>              </div>            <?php }?>        <?php }?><div class=\"clear\"></div>                  </div>                  <div class=\"clear\"></div>                </div>                <div id=\"panelRevelationBottom\">                  <div class=\"p12 cWhite current\"></div>                  <div class=\"p12 cWhite pagination\"></div>                </div>                <div class=\"clear\"></div>              </div>        </div>\t\t<?php } ?>        <SCRIPT>\t\t<!--        var tab_config = {\"label\"  :[\"content1\",\"content2\",\"content3\",\"content4\",\"content5\",\"content6\",\"content7\",\"content8\",\"content9\",\"content10\"],                          \"content\":[\"ccontent1\",\"ccontent2\",\"ccontent3\",\"ccontent4\",\"ccontent5\",\"ccontent6\",\"ccontent7\",\"ccontent8\",\"ccontent9\",\"ccontent10\"],                          \"current\":\"quhuan\",                          \"normal\" :\"quhuan1\",                          \"current_label\":\"content1\"                          }        var tab2 = new tab_effect(tab_config);        tab2.init(\"滑过\");        //-->        </SCRIPT>        <?php } ?>    </div>  </div>  <?php include(\"sidebar.html\"); ?>  <div class=\"clear\"></div></div><?php include(\"footer.html\"); ?></body></html>\n\n<?/*系统配置文件*/$DbHost=\"10.59.96.114:3307\";$DbName=\"wowdb\";$DbUser=\"wowdb\";$DbPwd =\"@!#$%$#$@@@@\";$DbHost1=\"10.59.96.114:3307\";$DbName1=\"wow_interface\";$DbUser1=\"wow_interface\";$DbPwd1 =\"@!#$%$#$@@@@\";$sys_config = array(\"list_ip\"=>\"218.66.59.108|10.5.21.49|127.0.0.1\",\"comment_url\"=>\"http://comment.news.17173.com/makecomment.php\",\"comment_identy\"=>\"newgame@!sc90ke2!cn3gh+*)\");$manager_type = array( 1 => \"一般管理员\",  9 => \"系统管理员\");$popedom_type = array( 1 => \"一级\",  2 => \"二级\", 3 => \"三级\",  4 => \"四级\",  5 => \"五级\");$geKey = \"1qwerfdsa\";//装备表名$itemTableArr = array(\"ge_item_weapon\", \"ge_item_safe\", \"ge_item_adorn\", \"ge_item_other\");//NPC性别$npcSexArr = array(\"Both\"=>\"男/女\", \"Female\"=>\"女\", \"Male\"=>\"男\");$htmlDir = \"/html/\";?>\n   修复方案：  配置啊 低级问题啊   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2011-08-05 21:00 厂商回复：  漏洞Rank：3  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-08-02 10:52 |    \t\ttenzy \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:21        | Need not to know)\t\t \n  这个给力啊！    \n     2011-08-02 15:40 |    \t\tP w \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:14        | -这家伙很懒,什么都没有留下。其实我真的很...)\t\t \n  太给力了啊 被脱裤？    \n     2011-08-04 13:50 |    \t\tsaga \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 世界上只有10种人，懂二进制的，和不懂二进...)\t\t \n  这个玩大了啊～～    \n     2011-08-05 13:27 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  持续关注中。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}