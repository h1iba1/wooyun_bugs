{"id": 21432, "wybug_id": "wooyun-2012-04227", "wybug_title": " 将乐人新闻系统任意添加、修改管理账号", "wybug_corp": "将乐人新闻系统", "wybug_author": "ゼ羽人", "wybug_date": "2012-02-05 22:11", "wybug_open_date": "2012-02-05 22:11", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "权限验证不足", "后台功能未做限制", "乐人新闻系统", "提权白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-05：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-02-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 修改管理员的文件未作权限验证即直接操作数据库管理员表，可从外部直接传递参数添加管理员或修改管理账号 详细说明：  将乐人新闻系统的mofei_admin_save.asp 未验证权限，直接获取从外部提交的use跟pass 参数添加进admin表中   漏洞证明：  \n<!--#include file=\"conn.asp\"--><!--#include file=\"md5.asp\"--><%use2=request.form(\"use\")pass2=request.form(\"pass\")pass2=md5(pass2)if use2=\"\" or pass2=\"\" then       //判断用户名或者密码是否为空%><p></p><p></p><p></p><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" width=\"600\" align=\"center\" bgcolor=\"#FFFFFF\">    <tr>      <td height=\"25\" background=\"mofeiimg/login_bg.gif\">        <p align=\"center\"><b><font size=\"3\" color=\"#FFFF00\">: : 将乐二中         : : 发现错误</font></b></td>    </tr>    <tr>      <td height=\"30\">   请<a href=\"javascript:history.go(-1)\">后退</a>填写完整资料!                     </td>          </tr>          <tr>            <td height=\"30\" bgcolor=\"#F9F9F9\">          <img border=\"0\" src=\"mofeiimg/login_stop.gif\"><font  color=\"#FF0000\">您的用户名,密码可能为空!</font>       </td>          </tr>          <tr>            <td height=\"30\">                     </td>          </tr>             </table><%elseSet rs = Server.CreateObject(\"ADODB.Recordset\")    //如果接收的用户名或者密码不为空,直接update  管理表sql=\"select * from admin\"rs.open sql,conn,1,3rs(\"usename\")=use2rs(\"password\")=pass2rs.updaters.closeresponse.redirect(\"mofei_admin_edit.asp\")end if%>\n   修复方案：  在文件头加入session验证<%if not session(\"mofeicheck\")=\"true\" thenresponse.redirect(\"mofei_login.asp\")%>   版权声明：转载请注明来源 ゼ羽人@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：9 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 9, "Ranks": null}