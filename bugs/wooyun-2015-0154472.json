{"id": 81106, "wybug_id": "wooyun-2015-0154472", "wybug_title": "某通用证券客服系统存在未授权访问漏洞可获取超管明文密码", "wybug_corp": "webcall", "wybug_author": "路人甲", "wybug_date": "2015-11-20 16:42", "wybug_open_date": "2015-12-17 14:48", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-27：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 未授权访问漏洞 详细说明：  前人的一个上传漏洞http://**.**.**.**/bugs/wooyun-2010-0135332在仔细研究之下，发现该套建站系统还存在未授权访问漏洞华安证券：访问http://**.**.**.**:8080/manage/admin/admin.jsp，可对超管直接进行新增，编辑等操作\n\n在加载该页面的时候，会向服务器提交一个post请求，manage/admin/getAdmin.jsp，返回值中带了超管的明文密码\n\n使用获取到的帐号密码登录系统\n\n\n\n就算厂商修复了上传漏洞页面的未授权访问http://**.**.**.**/bugs/wooyun-2010-0135332，但此时可以获取管理帐号密码直接登录系统内再getshell另一个比较严重的未授权访问在http://**.**.**.**:8080/manage/expert/expertinfo.htm\n\n可对所有客服人员的帐号密码进行修改，并且新增客服其它的一些未授权访问页面http://**.**.**.**:8080/manage/zsk/commontype.htmlhttp://**.**.**.**:8080/manage/ywtj/expertactive.htmlhttp://**.**.**.**:8080/manage/ywtj/customeractive.jsphttp://**.**.**.**:8080/manage/right/expertright.htmlhttp://**.**.**.**:8080/manage/right/expertrelation.htmlhttp://**.**.**.**:8080/manage/zsk/commoninfo.htmlhttp://**.**.**.**:8080/manage/msg/msg.jsp其它案例：这里要说明一下，该系统部分版本获取管理员管理的页面是在manage/admin/admin.jsp，部分版本是在manage/admin/admin.html，其实究其原因，都是由于manage/admin/getAdmin.jsp\nPOST http://*/manage/admin/getAdmin.jsp HTTP/1.1Accept: */*X-Requested-With: XMLHttpRequestContent-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: *Accept-Language: zh-cnAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Host: *Content-Length: 8Connection: Keep-AlivePragma: no-cacheCookie: *limit=10\n西部证券http://**.**.**.**/manage/admin/admin.html，\n\n\n\n登录系统\n\n你懂的\n\nhttp://**.**.**.**/manage/zsk/commoninfo.htmlhttp://**.**.**.**/manage/right/expertrelation.htmlhttp://**.**.**.**/manage/right/expertright.htmlhttp://**.**.**.**/manage/ywtj/expertactive.htmlhttp://**.**.**.**/manage/zsk/commontype.html   漏洞证明：  中国民族证券http://**.**.**.**/manage/expert/expertinfo.htm\n\n上面之所以可以改密码，是因为该系统修改密码的策略，不需要验证旧密码\n\nhttp://**.**.**.**/manage/admin/admin.html\n\nhttp://**.**.**.**/manage/zsk/commoninfo.htmlhttp://**.**.**.**/manage/right/expertrelation.htmlhttp://**.**.**.**/manage/right/expertright.htmlhttp://**.**.**.**/manage/ywtj/expertactive.htmlhttp://**.**.**.**/manage/zsk/commontype.html财达证券\n\n\n\nhttp://**.**.**.**:18090/manage/expert/expertinfo.htm\n\nhttp://**.**.**.**:18090/manage/msg/msg.jsp\n\nhttp://**.**.**.**:18090/manage/zsk/commoninfo.htmlhttp://**.**.**.**:18090/manage/right/expertrelation.htmlhttp://**.**.**.**:18090/manage/right/expertright.htmlhttp://**.**.**.**:18090/manage/ywtj/customeractive.jsphttp://**.**.**.**:18090/manage/ywtj/expertactive.htmlhttp://**.**.**.**:18090/manage/zsk/commontype.html西南证券http://**.**.**.**:8080/manage/msg/msg.jsp\n\nhttp://**.**.**.**:8080/manage/zsk/commontype.html\n\nhttp://**.**.**.**:8080/manage/admin/admin.html\n\nhttp://**.**.**.**:8080/manage/right/expertright.html\n\nhttp://**.**.**.**:8080/manage/ywtj/customeractive.jsp\n\nhttp://**.**.**.**:8080/manage/ywtj/expertactive.htmlhttp://**.**.**.**:8080/manage/zsk/commontype.html   修复方案：  权限控制   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-11-24 18:19 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT向证券业信息化主管部门通报，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}