{"id": 9251, "wybug_id": "wooyun-2013-034656", "wybug_title": "59互联某处任意文件上传可构造为存储型XSS", "wybug_corp": "59互联", "wybug_author": "Black Angel", "wybug_date": "2013-08-18 17:16", "wybug_open_date": "2013-10-02 17:17", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型", "利用技巧", "黑盒测试技巧", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-02：\t细节向公众公开  简要描述： 求20rank，求小礼物增进感情交流~ 详细说明：  问题还是出在提交事务处。首先注册一号，提交事务，\n\n然后发现有一任意上传，试试上传asp文件，\n\n上传成功后查看地址。\n\n发现目录限制。\n\n此处不急，通过分析测试，发现此处上传只检测图片头，不检测后缀名，asp，php之类的动态可执行文件不给运行，那么我们调转枪头，html呢？ 我们把图片与xss代码合成，保存为一个html，html是静态文件，理论上来讲是可以的，所以试试。\n\n\n\n\n\n其实到了这一步，我已经知道了结果了，但是要给这次漏洞挖掘来一次完美的结尾，所以。\n\n   漏洞证明：  问题还是出在提交事务处。首先注册一号，提交事务，\n\n然后发现有一任意上传，试试上传asp文件，\n\n上传成功后查看地址。\n\n发现目录限制。\n\n此处不急，通过分析测试，发现此处上传只检测图片头，不检测后缀名，asp，php之类的动态可执行文件不给运行，那么我们调转枪头，html呢？ 我们把图片与xss代码合成，保存为一个html，html是静态文件，理论上来讲是可以的，所以试试。\n\n\n\n\n\n其实到了这一步，我已经知道了结果了，但是要给这次漏洞挖掘来一次完美的结尾，所以。\n\n   修复方案：  严格检查上传文件类型，不仅仅只检测图片头。过滤可疑攻击代码。   版权声明：转载请注明来源 Black Angel@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-08-21 08:07 厂商回复： 感谢，该漏洞已经修补 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-18 18:20 |    \t\tSct7p \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 懂与不懂之间只隔了一层纸，懂的人会觉得很...)\t\t \n  任意文件上传构造xss。什么意思？    \n     2013-08-18 18:49 |    \t\t流星warden \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:8        | The quieter you become,the more you are ...)\t\t \n  坐等更新哦    \n     2013-08-18 22:27 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @Sct7p 剑心改的名字- - 看着这个名字好像蛮厉害的，实际上不厉害。。    \n     2013-08-18 22:29 |    \t\t流星warden \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:8        | The quieter you become,the more you are ...)\t\t \n  果然被我下午说中了，你秒过，然后黑色屌丝4个都不过    \n     2013-08-18 22:46 |    \t\tSct7p \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 懂与不懂之间只隔了一层纸，懂的人会觉得很...)\t\t \n  @Black Angel 我就找到一个存储性xss还正在等待可爱客服上线    \n     2013-08-18 22:51 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @Sct7p 打客服- - 这种我不交的。。上次打酷狗那些的客服直接给忽略了，还有没过的，我现在能打客服都不打了。。    \n     2013-08-18 23:06 |    \t\tSct7p \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 懂与不懂之间只隔了一层纸，懂的人会觉得很...)\t\t \n  @Black Angel 直接getshell?    \n     2013-08-19 07:39 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @Sct7p 不行 那么多人盯着呢。。我可找不到getshell的洞子。只不过盲打之类的 盗取管理cookie还是可以的    \n     2013-08-19 13:37 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  好熟悉啊，我以前的单位。。。。    \n     2013-08-19 22:01 |    \t\tSct7p \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 懂与不懂之间只隔了一层纸，懂的人会觉得很...)\t\t \n  @Black Angel 不一定哦    \n     2014-01-09 17:48 |    \t\tBlack-Hole \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:5        | 屌丝撸过....)\t\t \n  这是哪个xss平台 求共享    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}