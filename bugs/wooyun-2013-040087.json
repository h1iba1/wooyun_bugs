{"id": 61285, "wybug_id": "wooyun-2013-040087", "wybug_title": "百度卫士存在设计缺陷导致存在风险", "wybug_corp": "百度", "wybug_author": "我是小号", "wybug_date": "2013-10-17 18:18", "wybug_open_date": "2014-01-15 18:18", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-12-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-15：\t细节向公众公开  简要描述： 百度卫士存在设计缺陷导致存在风险 详细说明：  百度卫士存在设计缺陷。1.百度卫士的用户配置文件夹在系统盘的\nC:\\Documents and Settings\\All Users\\Application Data\\baidu\\BaiduAn\n下面，这个文件夹里面没有自我保护，所有程序都有写入权限，这边就很容易出问题。\n\n我们看到上面图里面用户优化过的计划任务项目被备份在了上面的文件夹里面。\nC:\\Documents and Settings\\All Users\\Application Data\\baidu\\BaiduAn\\FTSOManager\\BDMDisabled\\Tasks\n这个文件夹是任何权限都可以写入。那么这边就出现缺陷了。2.我们随便做个测试吧。自己写个test.job写到这个文件夹下面去。\n\n看看在百度卫士相关位置能不能显示。如果能显示的话应该就有缺陷，有可趁之机。\n\n你看，在计划任务处被显示了。而且状态是“禁用”，并且可以被启用。3.如何利用？1）做一个伪装的计划任务，这个计划任务设置好我病毒组件的启动时间，然后用户手动点击“启用”这个计划任务就被百度卫士释放到了系统计划任务文件夹中，然后病毒就可以借助这个缺陷达到神不知鬼不觉的被计划启动了2）更要命的是，百度卫士被卸载的时候会恢复所有优化的项目，如果我们偷偷释放一个启动病毒的计划任务job文件进入相关百度卫士文件夹，当用户卸载百度卫士的时候这个用来启动病毒的job文件也被自动放入了计划任务中，并默认为启用状态。   漏洞证明：  \n\n   修复方案：  设置权限不能任意写入/删除   版权声明：转载请注明来源 我是小号@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2013-10-20 20:58 厂商回复： 感谢对百度安全的关注，安全组已经联系业务部门处理此问题。--“百度，因你更安全” 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-17 18:20 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  哈哈，早几天发就有奖金了额！http://anquan.baidu.com/bbs/thread-10589-1-1.html?qq-pf-to=pcqq.c2c    \n     2013-10-17 18:24 |    \t\t我是小号 \t\t\t( 普通白帽子  |\t\t\t        Rank:334 漏洞数:51        | Martin)\t\t \n  @px1624 嘻嘻，谢谢PX大大。我知道有这么一个活动。故意留了一个，因为我觉得这个有威胁比较低，发出来给大家看看吧。    \n     2013-10-17 20:59 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @我是小号 额，原来是某大牛的小号额。。。好吧，目测有一群人会在下面鄙视我了。    \n     2013-10-21 17:19 |    \t\t我是小号 \t\t\t( 普通白帽子  |\t\t\t        Rank:334 漏洞数:51        | Martin)\t\t \n  @px1624 被确认了昂！可惜走的小厂商····    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}