{"id": 9757, "wybug_id": "wooyun-2013-032647", "wybug_title": "掌阅读iReader签到活动可获取任意数量阅饼（人民币50:1）", "wybug_corp": "zhangyue.com", "wybug_author": "mine", "wybug_date": "2013-07-29 14:35", "wybug_open_date": "2013-09-12 14:36", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["手机应用", "掌阅", "阅饼"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-12：\t细节向公众公开  简要描述： ireader第三期签到漏洞可获取任意数量阅饼 详细说明：  首先得到自己手机签到和抽奖时候的链接，下次可以直接用浏览器访问链接签到、抽奖。抽奖时候的连接类似这样的（XXX是替代字符）：\nhttp://ah2.zhangyue.com/zybook/u/p/user.php?action=qiandao&Act=turn_card&key=2QM&usr=156XXX01&rgt=5&p1=1307271227XXXX74&p2=108X5&p3=63X0&p4=501603&p5=12&p6=IJIGXXXFIHD&p7=DFIFHEXXXEEC&p9=1&p15=XT615&p16=XT615&p19=ireader_2.3.1&pk=\n抽奖过程是由js控制的，结果已经设定好了是6，就是会抽到6个阅饼，是由count这个变量定义的。只要用浏览器打开，修改这个变量即可：\n\n这个变量应该是在上一步的时候生成的连接定义的，从连接中的变量传递过来，所以可以直接访问链接：\nhttp://ah2.zhangyue.com/zybook/u/p/user.php?price=5100&key=2QM&action=qiandao&Act=registration&usr=156XXX01&rgt=5&p1=1307271227XXXX74&p2=108X5&p3=63X0&p4=501603&p5=12&p6=IJIGXXXFIHD&p7=DFIFHEXXXEEC&p9=1&p15=XT615&p16=XT615&p19=ireader_2.3.1&pk=2Q2\n注意，里面的price=5100表示这一次将抽到5100阅饼，设置多少得多少，目前测试7位数可行，再多就没测试了。   漏洞证明：  \n\n\n\n   修复方案：  这东西真心和金钱挂钩的话，我想用https+post可能会更安全些。   版权声明：转载请注明来源 mine@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-07-29 16:36 厂商回复： 非常感谢mine@乌云的帮助！！技术人员已调整业务逻辑，避免在前端传递重要数值，后端对前端的数值做逻辑校验和检查。 最新状态： 2013-07-29：漏洞已修复。  ", "replys": "漏洞评价：\n评论\n     2013-07-29 13:39 |    \t\t有妹子送上 \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:28        | 杭州最帅的男人)\t\t \n  mark    \n     2013-08-28 23:15 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  不错，顶LZ    \n     2013-08-29 11:12 |    \t\t黄小昏 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:7        | alert（妹子）)\t\t \n  马克，思路不错    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}