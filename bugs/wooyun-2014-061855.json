{"id": 3001, "wybug_id": "wooyun-2014-061855", "wybug_title": "北京住房公积金帐号安全机制可被绕过漏洞（查询他人信息）", "wybug_corp": "北京公积金", "wybug_author": "secretsdigg", "wybug_date": "2014-05-26 19:25", "wybug_open_date": "2014-07-10 19:25", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-10：\t细节向公众公开  简要描述： 北京住房公积金帐号安全机制可被绕过漏洞（查询他人信息） 详细说明：  设计缺陷，可以修改任何人的初始公积金账号密码（非初始密码也可以词典出来），可以查看个人信息，姓名 身份证号 手机 住址 公司 公积金详情等一  针对默认密码的情况北京住房公积金网站可以使用身份证号来登陆，默认密码是身份证后四位+00，如果最后一位是字母，默认密码就是最后的四个数字+00，之前可以使用默认密码登陆，现在不行了，需要凭借公积金联名卡号去登陆，或者带个人身份证去公积金管理中心修改默认密码。\n\n通过抓包发现可以绕过默认密码的检测，通过http://www.bjgjj.gov.cn/wsyw/wscx/gjjcx-edit.jsp直接去修改默认密码，就可以通过身份证号去登陆了，需要通过GET提交bh参数，值其实就是身份证号+00 的base64编码\n\n先通过该接口去测试下是不是默认密码http://www.bjgjj.gov.cn/wsyw/wscx/modfy.jsp?bh=MTEwMXXXXXXXXXXEyMDg2MTQ2MDA=\n\n\n\n可以登陆查看个人信息，然后去修改默认密码http://www.bjgjj.gov.cn/wsyw/wscx/gjjcx-edit.jsp?bh=MTEwMXXXXXXXXXXEyMDg2MTQ2MDA=\n\n\n\n\n\n修改成功，去登陆\n\n二  针对非默认密码的情况如果某人的密码不是默认的，也可以通过字典来遍历，因为密码被限制为6位数字，所以时间不是问题。遍历密码的URL就用这个http://www.bjgjj.gov.cn/wsyw/wscx/modfy.jsp?bh=MTEwXXXXXXNDEyMDg2MTQ2MDA=  ，因为无需验证码，可以不停的提交。通过抓包发现，提交的密码是加密的\n\n查看源码，发现了密码的加密信息\n\n提交的时候填写的密码是888888，验证下\n\n果然是，具体算法 http://www.bjgjj.gov.cn/wsyw/wscx/js/Encrypt.js通过该js加密方法生成6为数字的字典，然后burp跑一下，就可以得到某个人的登陆密码。测试的时候发现网站会偶尔出程序错误的页面，稍等片刻再尝试就好了    漏洞证明：  \n\n\n\n   修复方案：  加强权限控制提高网站支持的密码位置   版权声明：转载请注明来源 secretsdigg@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-05-30 17:51 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-26 19:42 |    \t\tsecgov \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 安全审计，漏洞挖掘,WAF. 揭露漏洞有风险，...)\t\t \n  这个有点小猛    \n     2014-05-26 22:30 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @secgov 很多政府网站都有这问题的。。成都的还不是一样。    \n     2014-05-27 07:39 |    \t\tnzk1912 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:10        | 软件开发8年了，也来挖挖漏洞，为创建安全...)\t\t \n  悄悄问下 政府网有人处理吗？    \n     2014-07-11 09:50 |    \t\t水泥中的鱼 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:4        | 我就是我，尘世中一迷途小书童。)\t\t \n  这个比较强大了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}