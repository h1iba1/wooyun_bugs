{"id": 8266, "wybug_id": "wooyun-2013-042287", "wybug_title": "驴妈妈某分站敏感信息泄露可导致信息系统被渗透", "wybug_corp": "驴妈妈旅游网", "wybug_author": "猪猪侠", "wybug_date": "2013-11-07 20:44", "wybug_open_date": "2013-11-12 20:45", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 由于没有一个通用标准的防御规则保护好中间件配置信息、DNS信息、业务数据信息、用户信息、源码备份文件、版本管理工具信息、系统错误信息和敏感地址信息(后台或测试地址)的泄露，攻击者可能会通过收集这些保护不足的数据，利用这些信息对系统实施进一步的攻击。由于只是安全测试，本次未深入一步获取服务器和数据库权限！ 详细说明：  #1 信息泄露原因由于驴妈妈论坛管理员在更新服务器文件时，未注意到编辑器会默认创建各种.bak文件用来规避错误编辑时引发的数据丢失风险，从而造成了更严重的信息安全问题。#2 泄露内容网站： http://bbs.lvmama.com网址：http://bbs.lvmama.com/config/config_global.php.bak 内容：\n<?php$_config = array();// ---------------------------- CONFIG DB ----------------------------- //$_config['db']['1']['dbhost'] = 'localhost';$_config['db']['1']['dbuser'] = 'lv_bbs_x2';$_config['db']['1']['dbpw'] = 'fSyU.NSXt.Qi8F9r';$_config['db']['1']['dbcharset'] = 'utf8';$_config['db']['1']['pconnect'] = '0';$_config['db']['1']['dbname'] = 'bbsx2';$_config['db']['1']['tablepre'] = 'utf8_pre_';$_config['db']['common']['slave_except_table'] = '';// -------------------------- CONFIG MEMORY --------------------------- //$_config['memory']['prefix'] = 'loC4Nb_';$_config['memory']['redis']['server'] = '';$_config['memory']['redis']['port'] = 6379;$_config['memory']['redis']['pconnect'] = 1;$_config['memory']['redis']['timeout'] = '0';$_config['memory']['redis']['serializer'] = 1;$_config['memory']['memcache']['server'] = '192.168.10.51';$_config['memory']['memcache']['port'] = 12000;$_config['memory']['memcache']['pconnect'] = 1;$_config['memory']['memcache']['timeout'] = 1;$_config['memory']['apc'] = 1;$_config['memory']['xcache'] = 1;$_config['memory']['eaccelerator'] = 1;$_config['memory']['wincache'] = 1;// -------------------------- CONFIG SERVER --------------------------- //$_config['server']['id'] = 1;// ------------------------- CONFIG DOWNLOAD -------------------------- //$_config['download']['readmod'] = 2;$_config['download']['xsendfile']['type'] = '0';$_config['download']['xsendfile']['dir'] = '/down/';// --------------------------- CONFIG CACHE --------------------------- //$_config['cache']['type'] = 'sql';// -------------------------- CONFIG OUTPUT --------------------------- //$_config['output']['charset'] = 'utf-8';$_config['output']['forceheader'] = 1;$_config['output']['gzip'] = '1';$_config['output']['tplrefresh'] = 1;$_config['output']['language'] = 'zh_cn';$_config['output']['staticurl'] = 'static/';$_config['output']['ajaxvalidate'] = '0';$_config['output']['iecompatible'] = '0';// -------------------------- CONFIG COOKIE --------------------------- //$_config['cookie']['cookiepre'] = 'lylv_';$_config['cookie']['cookiedomain'] = '';$_config['cookie']['cookiepath'] = '/';// ------------------------- CONFIG SECURITY -------------------------- //$_config['security']['authkey'] = '854a80x16M6pQyTq';$_config['security']['urlxssdefend'] = 1;$_config['security']['attackevasive'] = '';$_config['security']['querysafe']['status'] = 1;$_config['security']['querysafe']['dfunction']['0'] = 'load_file';$_config['security']['querysafe']['dfunction']['1'] = 'hex';$_config['security']['querysafe']['dfunction']['2'] = 'substring';$_config['security']['querysafe']['dfunction']['3'] = 'if';$_config['security']['querysafe']['dfunction']['4'] = 'ord';$_config['security']['querysafe']['dfunction']['5'] = 'char';$_config['security']['querysafe']['daction']['0'] = 'intooutfile';$_config['security']['querysafe']['daction']['1'] = 'intodumpfile';$_config['security']['querysafe']['daction']['2'] = 'unionselect';$_config['security']['querysafe']['daction']['3'] = '(select';$_config['security']['querysafe']['daction']['4'] = 'unionall';$_config['security']['querysafe']['daction']['5'] = 'uniondistinct';$_config['security']['querysafe']['dnote']['0'] = '/*';$_config['security']['querysafe']['dnote']['1'] = '*/';$_config['security']['querysafe']['dnote']['2'] = '#';$_config['security']['querysafe']['dnote']['3'] = '--';$_config['security']['querysafe']['dnote']['4'] = '\"';$_config['security']['querysafe']['dlikehex'] = 1;$_config['security']['querysafe']['afullnote'] = '0';// -------------------------- CONFIG ADMINCP -------------------------- //// -------- Founders: $_config['admincp']['founder'] = '1,2,3'; --------- //$_config['admincp']['founder'] = '1';$_config['admincp']['forcesecques'] = '0';$_config['admincp']['checkip'] = 1;$_config['admincp']['runquery'] = '1';$_config['admincp']['dbimport'] = 1;// -------------------------- CONFIG REMOTE --------------------------- //$_config['remote']['on'] = '0';$_config['remote']['dir'] = 'remote';$_config['remote']['appkey'] = '62cf0b3c3e6a4c9468e7216839721d8e';$_config['remote']['cron'] = '0';// --------------------------- CONFIG INPUT --------------------------- //$_config['input']['compatible'] = 1;// --------------------------- CUSTOM --------------------------------- //// 登录提交间隔时间$_config['custom']['loginInterval'] = 15;// 用户资料修改Url$_config['custom']['registerUrl'] = 'http://login.lvmama.com/nsso/register/registering.do';$_config['custom']['changePasswordUrl'] = 'http://www.lvmama.com/myspace/userinfo/password.do';$_config['custom']['forgotPasswordUrl'] = 'http://login.lvmama.com/nsso/findpass/index.do';$_config['custom']['changeEmailUrl'] = 'http://www.lvmama.com/myspace/userinfo/email_bind.do';// 联合登陆Url$_config['custom']['lmmDomain'] = 'http://www.lvmama.com';$_config['custom']['loginTencentQQ'] = 'http://login.lvmama.com/nsso/cooperation/tencentQQUnionLogin.do';$_config['custom']['loginTencentWeibo'] = 'http://login.lvmama.com/nsso/cooperation/tencentUnionLogin.do?isRefresh=false';$_config['custom']['loginSinaWeibo'] = 'http://login.lvmama.com/nsso/cooperation/sinaUnionLogin.do?isRefresh=false';$_config['custom']['loginAlipay'] = 'http://login.lvmama.com/nsso/cooperation/alipayUnionLogin.do?isRefresh=false';$_config['custom']['loginSnda'] = 'http://login.lvmama.com/nsso/cooperation/sndaUnionLogin.do?isRefresh=false';$_config['custom']['loginKaixin'] = 'http://www.kaixin001.com/login/connect_login.php?flag=1&url=%2Flogin%2Fconnect.php%3Fappkey%3D85704812783077bafc036569af59c655%26re%3Dhttp%3A%2F%2Flogin.lvmama.com%2Fnsso%2Fcooperation%2FkaixinUnionLogin.do%3FisRefresh%3Dfalse%26t%3D92&appkey=85704812783077bafc036569af59c655';// ------------------- THE END -------------------- //?>\n   漏洞证明：  # 再附送一个论坛的SQL注入漏洞\nhttp://bbs.lvmama.com/sosv_award-my_gift.html?model=list&acid=6'SELECT * FROM sosv_award_statistics WHERE act_id=6\\' and gift_id>0 and uid=60339\n\n\n# 漏洞证明\n$_config['remote']['appkey'] = '62cf0b3c3e6a4c9468e7216839721d8e';\n有时候，论坛appkey泄露，骇客利用恶意调用论坛API将对论坛造成严重破坏。# 间接利用获取到论坛管理员权限(由于只是安全测试，未深一步获取服务器和数据库权限！)\n\n# 可禁止所有IP访问论坛，并删除所有论坛交流贴\n\n   修复方案：  #1 杜绝为了方便而造成的不必要的信息泄露。   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-11-12 20:45 厂商回复：  漏洞Rank：10  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-07 20:47 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2013-11-07 20:49 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  mark    \n     2013-11-07 20:54 |    \t\tMr.醉心 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 爱生活，爱音乐，爱美女，更爱波多野结衣)\t\t \n  世人笑我太疯癫，我笑世人看不穿~    \n     2013-11-07 20:57 |    \t\t光头强 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:3        | 惹我光头强，揍你没商量！)\t\t \n  亲，你不能看到别的白帽子提交了驴妈妈的漏洞，你就立马去刷一个呀！这样对厂商太不公平了。。。  WooYun: 我是如何获取驴妈妈旅游网用户信息及2013年所有订单信息    \n     2013-11-07 20:57 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @光头强 不好意思，手贱了一下。    \n     2013-11-07 21:02 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  克制    \n     2013-11-07 21:13 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  我也找到个，不知道是不是，各种日志    \n     2013-11-07 21:35 |    \t\t→Ｈack涛 \t\t\t( 普通白帽子  |\t\t\t        Rank:158 漏洞数:55        | 好好学习，天天向上！)\t\t \n  按照@猪猪侠的提交漏洞的趋势，是要变成白帽子第一名啊！    \n     2013-11-07 22:39 |    \t\t然后爱 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:4        | 我是一个粗鲁的斯文人)\t\t \n  太没节操了……    \n     2013-11-07 23:40 |    \t\tfyth \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我就看看，不说话)\t\t \n  马克……    \n     2013-11-08 09:13 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  你都有那么多超级棒棒糖了，还要节操干吗？    \n     2013-11-12 22:30 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  mark    \n     2013-11-12 23:24 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @驴妈妈旅游网 这又是把漏洞补丁了，忘记回来确认漏洞的节奏啊。    \n     2013-11-28 11:56 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  偶像这个$_config['remote']['appkey']怎么利用呢？求教    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}