{"id": 72059, "wybug_id": "wooyun-2015-0151200", "wybug_title": "优酷加密视频存在多个万能密码可绕过限制(奇葩漏洞)", "wybug_corp": "优酷", "wybug_author": "路人甲", "wybug_date": "2015-11-02 16:56", "wybug_open_date": "2015-12-17 18:08", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 优酷加密的视频，有多个万能密码 详细说明：  只要在密码框输入两个英文的双引号。例如: \"\"  按确定键即可播放所有的加密视频。管理补充：\n\"\"   \\   { }  <> %% or a=a\n等多种字符可绕过视频密码   漏洞证明：  http://v.youku.com/v_show/id_XMTMzMTI2OTUzNg==.htmlhttp://v.youku.com/v_show/id_XMTM0NTcwODg1Ng==.htmlhttp://v.youku.com/v_show/id_XMTM0NTM2NTk3Mg==.htmlhttp://v.youku.com/v_show/id_XMTM0NTM2NTg4MA==.html   修复方案：  有一个地方抓包是http://play.youku.com/play/get.json?vid=XMTM0NTM2NTg4MA==&ct=10&ran=437   手动填写pwd http://play.youku.com/play/get.json?vid=XMTM0NTM2NTg4MA==&ct=10&pwd=%22%22&ran=437即可获得一个值stream_fileid 这个值是用来算ep的。这些值就不讲了，关键的地方就是pwd可以用\"\"万能密码   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-11-02 18:06 厂商回复： 感谢支持！漏洞修复中！ 最新状态： 2015-11-06：更新一下漏洞产生的原因，由于传入的pwd参数没有进行urlencode，导致特殊字符绕过。  ", "replys": "漏洞评价：\n评论\n     2015-11-02 17:06 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1250 漏洞数:124        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  看看有奇葩    \n     2015-11-02 17:24 |    \t\t啊L川 \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:39        | 菜鸟 ，菜渣， 菜呀！)\t\t \n  看看有奇葩    \n     2015-11-02 17:25 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1250 漏洞数:124        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  已成功复现    \n     2015-11-02 17:31 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 哈！躁起来！)\t\t \n  @子非海绵宝宝 你复现那个不算奇葩，有更奇葩的    \n     2015-11-02 17:32 |    \t\tsauren \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:27        | 天天打DOTA，快乐你我他~)\t\t \n  看看有奇葩     \n     2015-11-02 17:42 |    \t\tcode001 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:5        | 爱生活，爱自由，希冀一个更加安全开放的互...)\t\t \n  求密码 哪个程序员干的    \n     2015-11-02 18:16 |    \t\thecate \t\t\t( 普通白帽子  |\t\t\t        Rank:569 漏洞数:89        | ®高级安全工程师 | WooYun认证√)\t\t \n  看看有多奇葩    \n     2015-11-02 18:25 |    \t\t邪少 \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:9        | 百里长苏)\t\t \n  求方案  求文    \n     2015-11-02 19:04 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1250 漏洞数:124        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  @浩天 坐等公开    \n     2015-11-02 22:11 |    \t\tMark0smith \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:32        | 唉)\t\t \n  坐等公开    \n     2015-11-02 22:53 |    \t\t爱与诚一号 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        )\t\t \n  坐等公开    \n     2015-11-03 08:46 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:7        | 每日必关注乌云)\t\t \n  站等公开    \n     2015-11-03 10:16 |    \t\tapplychen \t\t\t( 普通白帽子  |\t\t\t        Rank:309 漏洞数:28        | 白发现首)\t\t \n   好奇这个代码是怎么写出来的    \n     2015-11-03 10:56 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:16        | Talk is cheap,show me the shell.)\t\t \n  if($pass==$row['pass']||$pass=='!xxxx'){    xxx;}    \n     2015-11-04 03:38 |    \t\t邪少 \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:9        | 百里长苏)\t\t \n  @HackPanda 求解释此代码    \n     2015-11-06 11:30 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:16        | Talk is cheap,show me the shell.)\t\t \n  求厂商解释- -这代码是怎么写的才会出现这样的问题 @优酷    \n     2015-12-03 13:09 |    \t\tKnight \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:11        | 刚刚上洗手间，看到一个玉树临风的少年，气...)\t\t \n  真奇葩。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}