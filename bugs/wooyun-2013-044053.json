{"id": 5774, "wybug_id": "wooyun-2013-044053", "wybug_title": "Ecshop后台getshell-2", "wybug_corp": "ShopEx", "wybug_author": "Matt", "wybug_date": "2013-11-26 19:52", "wybug_open_date": "2014-02-24 19:53", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-30：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-24：\t细节向公众公开  简要描述： Ecshop后台getshell-2 详细说明：  \nadmin/database.phpif ($_REQUEST['act'] == 'dumpsql'){省略若干    if (empty($_REQUEST['sql_file_name']))    {        $sql_file_name = $dump->get_random_name();    }    else    {省略若干        $sql_file_name = str_replace(\"0xa\", '', trim($_REQUEST['sql_file_name'])); // 过滤 0xa 非法字符        $pos = strpos($sql_file_name, '.sql');        if ($pos !== false)        {            $sql_file_name = substr($sql_file_name, 0, $pos);        }    }省略若干            if (!@file_put_contents(ROOT_PATH . DATA_DIR . '/sqldata/' . $sql_file_name . '.sql', $dump->dump_sql))            {                sys_msg(sprintf($_LANG['fail_write_file'], $sql_file_name . '_' . $vol . '.sql'), 1, array(array('text'=>$_LANG['02_db_manage'], 'href'=>'database.php?act=backup')), false);            };\n   漏洞证明：  备份数据库可以直接写出shell我们可以insert一个shell然后备份制定的表利用数据查询执行insert into ecs_wholesale values(2,1,'<?php phpinfo();?>',1,1,1)然后在进行备份ecs_wholesale 这个表然后我们备份文件名设置成1.php.sql利用解析漏洞就可以获得一个shell了\n\n\n\n\n\n   修复方案：  你猜~~   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2013-11-27 09:29 厂商回复： 非常感谢您为shopex信息安全做的贡献我们将尽快修复非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-02-25 09:48 |    \t\tc4rp3nt3r \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:10        | 人生的意义就在于从一个圈子跳到另一个更大...)\t\t \n  没有解析漏洞后台也能拿shell...    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}