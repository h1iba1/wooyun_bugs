{"id": 75423, "wybug_id": "wooyun-2016-0167520", "wybug_title": "天津银行openssl漏洞攻击者可以发起中间人攻击并利用此漏洞篡改或监听SSL加密传输的数据（如：卡号密码）", "wybug_corp": "天津银行股份有限公司", "wybug_author": "路人甲", "wybug_date": "2016-01-06 10:27", "wybug_open_date": "2016-02-22 21:46", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向公众公开  简要描述： 快过年了，来个礼物嘛 详细说明：  \n WooYun: 我是这样伪造天津银行官方邮件的（@tccb.com.cn） 说送我的礼物现在还没有到，都快放假回家啦\n\n(2014-06-05) OpenSSL 发布了关于漏洞 CVE-2014-0224 的安全公告，并发布了已修复此漏洞的最新 OpenSSL版本。由于此漏洞是 OPenSSL ChangeCipherSpec 设计缺陷造成，被称为 CCS 注入漏洞。攻击者可以发起中间人攻击并利用此漏洞篡改或监听SSL加密传输的数据。\n\nSSL握手过程中 两端会发起 ClientHello 和 ServerHello 握手消息。在握手过程中双方会协商一些会话参数,如协议版本、加密套件、会话密钥等SSL协议中 允许双方在握手阶段通过使用ChangeCipherSpec（CCS） 来修改连接的加密策略按照标准，CCS消息应该是在 握手加密参数协商完成之后  最终确认消息发送之前 来发送。但 Openssl没有这么设计，它允许 CCS消息在 加密参数协商完成之前发送.中间人攻击可以利用这点 在 一个SSL握手过程中向客户端和服务端分别发送一个 CCS包并用长度为零的预主密钥来协商会话密钥，这样攻击者就可以知道会话密钥 并可以篡改或截获SSL通信数据。\n   漏洞证明：  \n\n   修复方案：  \nWindows环境下的apache及nginx等使用openssl的webserver直接重新下载最新的webserver版本就可解决。Linux环境下    Nginx：使用ldd nginx指令检查是否有的libssl.so和libcrypto.so的调用，如果用，直接升级openssl就可以了，如果没有，那么需要重新编译Nginx    Apache：          如果你的apache是使用管理安装的，那么直接使用包管理升级openssl就可以了。          如果你的apache是自己编译的，那么您需要检查apache的编译参数，看有没有指定自己的openssl目录；                  如果没有那么也可以直接使用包管升级openssl。                  如果您编译安装的时候使用了自己的openssl目录而非系统的openssl，那请升级对应目录的openssl或重新编译apache.    升级openssl：对于使用包管理安装的openssl直接使用包管理升级就可以了，升级后版本号可能不在安全的版本号之只，但是它们是被打过补丁的，是安全的。从源码编译安装openssl：从openssl下载自己希望使用的openssl版本的最新文件。编译时请加上参数shared以打开共享库。完成后需按自己的环境来安装。\n   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2016-01-11 14:43 厂商回复： 经过验证该网站只显示首次验证结果，目前我行系统不存在该漏洞，应属于误报，感谢白帽对我行的大力支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}