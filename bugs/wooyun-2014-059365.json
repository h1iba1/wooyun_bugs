{"id": 55978, "wybug_id": "wooyun-2014-059365", "wybug_title": "移动微博交互型XSS的搞基利用", "wybug_corp": "中国移动", "wybug_author": "路人甲", "wybug_date": "2014-05-04 12:41", "wybug_open_date": "2014-06-18 12:41", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-18：\t细节向公众公开  简要描述： 交互式xss二次包装 详细说明：  首先说一下这个xss点 移动微博首页发微博的时候 对短地址的包装存在问题 可以用引号闭合封装过程来构造一个交互式的xss输入http://139url.cn/a\"onmouseover=\"alert(1)\"a=\"提交后此地址将被自动加上<a>标签 如图所示 引号无转移被引入，导致xss\n\n\n\n但是这么一条微博 虽然是onmouseover，相信触发概率不会很高，而且太容易被发现了。下面说说怎么来二次包装这个交互型xss变成一条真正的蠕虫。   漏洞证明：  为了不被轻易发觉让虫子胎死腹中，首先想到的办法是用style来隐藏a标签实际操作如下：\n\n效果：\n\n多写几个a还能增加触发概率，但总觉得还是有点不太蠕的起来。绝大多数的人滚动页面的时候鼠标会放到浏览器右侧 免得指针挡住中间的内容。 所以想到了第二套方案，指针劫持。onmouseover嘛 鼠标滑过就行了，如果我在某个地方iframe加载这条微博的页面 然后设置iframe为隐藏且跟随鼠标（听起来是不是跟点击劫持很像？没错，确实差不多）。会有什么事发生呢。包装好后的流程：1、先去发一条onmouseover=$.getscript('xss.js');的微博 xss.js功能是获取crumb（移动微博的token 有了token想干啥都行了）并转发微博。2、新建一个html页面，示例代码如下\n\nbody里的图片只是个演示 当然可以放任何东西了。 3、发一条诱惑点击的微博加上上面这个html的地址。4、坐等虫儿慢慢蠕。这个html的效果如下 打开后在页面任何位置稍微动一下鼠标 就触发xss了，实际测试中，点开微博链接新窗口中移动鼠标去关掉这个窗口 js已经执行了\n\n   修复方案：  1、xss修了2、检查父窗口   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-05-07 21:53 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT直接通报给中国移动集团公司处置 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}