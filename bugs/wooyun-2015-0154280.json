{"id": 73227, "wybug_id": "wooyun-2015-0154280", "wybug_title": "小牛电动某站越权可以获取其他管理员明文密码", "wybug_corp": "niu.com", "wybug_author": "计算姬", "wybug_date": "2015-11-19 11:59", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口未加权限认证", "后台被猜解", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： 小牛电动某站越权可以获取管理员密码，这不给20R说不过去啊 详细说明：  上一个漏洞https://www.wooyun.org/bugs/wooyun-2015-0141818随便找个弱口令了xuelong/1q2w3e4r登陆进入售后系统。这里弱口令很多，就不多说了。\n\n后台功能这么强大，我觉得肯定有越权的存在，其他不多看，就直奔用户管理这块\n\n到员工档案这块，点击查看员工信息，点击权限设置。\n\n可以看到ascii hex保存了用户的密码，基本是明文了。同时此过程抓包\nGET /RightSet/Exec?ECEvent=OPEN&itemid=3123&userright=BNEDCU&winid=setRight&sessionid=769de3f9-bd18-41f9-a31a-1db738f8eec4&seriod_content_no=0.3636090673971921 HTTP/1.1Host: sh.niu.com\n可以看到itemid=3123查到的是自己的账号，我们把itemid改为1试试因为之前了解到，管理员的id就是1\n\n可以看到成功越权查询到管理员的密码信息。直接4E6975323031352121解码就是Niu2015!!我们登录admin账户试试看\n\n基本上什么权限都有了，后台各种用户信息，客户信息，经销商信息，会员卡信息，充值卡信息等等，就不深入了。求前台，求20R   漏洞证明：  见详细描述   修复方案：  越权修复   版权声明：转载请注明来源 计算姬@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-11-20 11:39 厂商回复： 非常感谢对小牛电动安全的关注，20R 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}