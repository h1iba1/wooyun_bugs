{"id": 84852, "wybug_id": "wooyun-2015-0140188", "wybug_title": "国美在线Android客户端之伪造升级下载恶意应用", "wybug_corp": "国美控股集团", "wybug_author": "骑虎打狗", "wybug_date": "2015-09-10 14:32", "wybug_open_date": "2015-12-13 11:06", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-13：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 本漏洞针对国美在线Android客户端Ver4.1.3最新版本；国美服务端对客户端请求的返回数据是一段JSON格式数据，HTTP协议传输下很容易被截包篡改，伪装升级，诱导客户下载恶意程序。 详细说明：  1.在客户端设置->检测更新，得到下面的服务器返回：\n\n2.使用Fiddler截到返回的包，自动解码，将返回数据修改为如下；\n\n即：result表示是否更新；upgradeURL表示更新地址；remarks表示更新说明；versionName是版本号。   漏洞证明：  \n\n\n\n\n\n\n\n   修复方案：  后来测试发现，京东除了登陆的时候HTTPS加密传输，其他的几乎都是HTTP传输，返回数据都是简单编码，升级最好对升级的链接啊、apk包啊，进行校验..觉得最最的安全点在于：1.升级的链接为HTTP协议传输，攻击容易；2.返回数据的编码形式..   版权声明：转载请注明来源 骑虎打狗@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2015-09-14 11:05 厂商回复： 感谢提供信息 最新状态： 2015-10-23：已修复，感谢提供的信息  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}