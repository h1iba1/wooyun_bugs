{"id": 56980, "wybug_id": "wooyun-2014-055677", "wybug_title": "厦门大学一分站存在strunts2漏洞", "wybug_corp": "厦门大学", "wybug_author": "寻梦", "wybug_date": "2014-04-10 11:33", "wybug_open_date": "2014-05-25 11:33", "wybug_type": "恶意信息传播", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-25：\t细节向公众公开  简要描述： 厦门大学一分站存在struts2漏洞，权限为root 详细说明：  利用点 http://183.62.138.14/xmusz/portal!memberLogin.action     漏洞证明：  \n\n    具体的 自己看吧   修复方案：  1.删除的jar包 jsonplugin-0.30.jar（此jar由struts2-json-plugin-2.3.15.1.jar代替，如果以前采用过其他jsonplugin插件的话） 2.添加的jar包 commons-lang3-3.1.jar struts2-json-plugin-2.3.15.1.jar 3.替换的jar包 将原有低版本的ognl-x.x.x.jar替换为ognl-3.0.6.jar 将原有低版本的struts2-core-x.x.x.x.jar替换为struts2-core-2.3.15.1.jar 将原有低版本的xwork-core-x.x.x.x.jar替换为xwork-core-2.3.15.1.jar 将原有低版本的javassist-x.x.x.jar替换为javassist-3.11.0.GA.jar 4.xwork-conversion.properties 注释掉java.lang.Enum=com.opensymphony.xwork2.util.EnumTypeConverter 5.替换工程中所有*.xml Struts配置文件中type=\"redirect-action\"为type=\"redirectAction\",并将xml的头部信息修改为： [html] view plaincopy01.<!DOCTYPE struts PUBLIC  02.    \"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN\"  03.    \"http://struts.apache.org/dtds/struts-2.3.dtd\">   6.修改struts.xml中返回类型为json的处理类相关的配置。（如果你的工程原来采用的是其他的json类型处理插件的话） 将其中片段修改成如下状态： [html] view plaincopy01.<result-types>  02.            <!-- 添加的自定义类型JSON对象 -->  03.            <!-- 04.                <result-type name=\"json\" class=\"com.googlecode.jsonplugin.JSONResult\" /> 05.            -->  06.            <result-type name=\"json\" class=\"org.apache.struts2.json.JSONResult\" />  07.</result-types>   7.所有涉及到jsonplugin-0.30.jar的类由struts2-json-plugin-2.3.15.1.jar中的对应类替换。（如果你的工程原来采用的是其他的json类型处理插件的话） 8.struts2标签库的升级 将原有的struts-tag.tld升级为最新。   版权声明：转载请注明来源 寻梦@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-04-10 11:39 厂商回复： 已通知厦大处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}