{"id": 14873, "wybug_id": "wooyun-2012-016055", "wybug_title": "某CDN服务器缺陷可导致末日提前", "wybug_corp": "网宿科技", "wybug_author": "园长", "wybug_date": "2012-12-15 13:25", "wybug_open_date": "2013-01-29 13:26", "wybug_type": "内部绝密信息泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-29：\t细节向公众公开  简要描述： 最初以为是腾讯的缓存服务器，后来发现这尼玛是一个能够毁掉国内所有大战的CDN节点服务器数据！2012最后一周了逆天了。 详细说明：  起因：公司3.0项目上线测试部服务器被某人入侵，查日志发现3306被提权了。于是跑了个3306扫描....得到数据库连接，发现数据量异常庞大，看数据库表结构应该是个腾讯的缓存节点。看到fd_user表的数据后发现有点不对劲，这东西怎么会有怎么多乌云上的厂商.360、天涯、腾讯、京东....\n\n查看了系统配置表发现了几个网站管理入口和敏感配置：\n\n系统后台似乎有IP限制，不过从开发入口进去了。\n\n果然是个CDN提供商，登录客户后台：\n\n淘宝的流量果然惊人：\n\n看了下官方提供的帮助文档，ping了下17173某子站，果真使用的是此CDN节点，那么如果要是修改了节点IP，是不是2012就提前来了呢？\n\n360似乎流量也非常大：\n\n回到后台发现又是SSH，讨厌SSH。推荐Spring+Spring MVC+Mybatis+Freemarker。同为Java程序员深知不负责的人太多了，直接get了CDN后台控制服务器的shell：\n\n拿到shell和数据库了想修改某些厂商的节点应该会变得非常容易了。   漏洞证明：  回到后台发现又是SSH，讨厌SSH。推荐Spring+Spring MVC+Mybatis+Freemarker。同为Java程序员深知不负责的人太多了，直接get了CDN后台控制服务器的shell：\n\n拿到shell和数据库了想修改某些厂商的节点应该会变得非常容易了。   修复方案：  求妹子，2012了哥还是.....   版权声明：转载请注明来源 园长@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-12-17 16:03 厂商回复： CNVD根据图片确认，同时根据白帽子的反馈：其已通报给CDN厂商（网宿科技）。17日下午，网宿科技与CNVD联系，确认已经修复了漏洞，同时正在做好漏洞事件可能造成影响的应对工作。rank 20 最新状态： 2012-12-17：补充：根据网宿科技反馈情况，存在风险的主机为测试机，非在线生产系统。  ", "replys": "漏洞评价：\n评论\n     2012-12-15 13:48 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  好吧。。搞下cdn。。牛逼了    \n     2012-12-15 14:50 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  蓝讯也无压力，CDN也一般般嘛。    \n     2012-12-15 16:08 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  @无敌L.t.H 全是些国内大型门户网站....    \n     2012-12-15 16:27 |    \t\t蓝风 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:25        | 崬汸慾哓 嗼檤焄垳皁 沓猵圊屾亾沬荖 颩憬...)\t\t \n  秘密、机密、绝密；神马才是绝密？    \n     2012-12-15 18:30 |    \t\t丶小蓝丶 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        | 小白)\t\t \n  期待啊~好期待啊~    \n     2012-12-15 23:22 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  围观    \n     2012-12-16 00:20 |    \t\tmerid4n \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | ‭111     |         .('\"><!--)\t\t \n  洞主的空间里有图有真相了    \n     2012-12-16 00:30 |    \t\t马杀鸡 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 作为一匹勇敢的马，杀鸡是必不可少的)\t\t \n  重蹈2011 CSDN    \n     2012-12-16 00:32 |    \t\talso \t\t\t( 普通白帽子  |\t\t\t        Rank:424 漏洞数:52        | 招渗透/php/前端/ios&android安全，广州地...)\t\t \n  2012cdn末日    \n     2012-12-16 00:39 |    \t\talso \t\t\t( 普通白帽子  |\t\t\t        Rank:424 漏洞数:52        | 招渗透/php/前端/ios&android安全，广州地...)\t\t \n  据我所知，这个应该是网X科技    \n     2012-12-16 00:44 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  @merid4n 你好邪恶...    \n     2012-12-16 00:44 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  @also 厂商那写了，乌云没有不写厂商这个功能。    \n     2012-12-16 01:03 |    \t\t马杀鸡 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 作为一匹勇敢的马，杀鸡是必不可少的)\t\t \n   亲，DDOS哦，外部IP过滤，应用范围有限    \n     2012-12-16 01:09 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  @马杀鸡 后台似乎有个东西叫修改客户配置....使用CDN的前提就是把域名指向CDN服务器。如果修改了地址是不是就可以劫持域名？    \n     2012-12-16 08:46 |    \t\t马杀鸡 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 作为一匹勇敢的马，杀鸡是必不可少的)\t\t \n  @园长 yeah,可以改一改具体的指向，比如将指向cdn的解析指向源IP什么的，或者是其它IP什么的，至于什么结果么，你猜猜    \n     2012-12-16 10:43 |    \t\talso \t\t\t( 普通白帽子  |\t\t\t        Rank:424 漏洞数:52        | 招渗透/php/前端/ios&android安全，广州地...)\t\t \n  @园长 开始没留意···    \n     2012-12-16 18:12 |    \t\tshack2 \t\t\t( 普通白帽子  |\t\t\t        Rank:470 漏洞数:71        | QQ:1341413415 一个热爱编程(Java),热爱网...)\t\t \n  @园长 膜拜园长    \n     2012-12-16 18:53 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  @shack2 卖酱油了，又黑又咸的酱油...    \n     2012-12-16 20:56 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  @shack2 貌似有点严重，百度直接删我空间文章，没有任何提示。其实我想说：2012算个球。    \n     2012-12-16 22:53 |    \t\t马杀鸡 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 作为一匹勇敢的马，杀鸡是必不可少的)\t\t \n  @园长 嘿嘿，要不解析到百度去，试试百度的集群如何，哈哈    \n     2012-12-16 23:00 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  @马杀鸡 其实知道源IP你也不一定打得开，iptables，ACL，甚至是内网的都有。    \n     2012-12-16 23:42 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  @马杀鸡 听朋友说老公是部队的被带走了发了条短信给家人叫他们避难。2012如果真的来了，我打算就这么安静的等死。    \n     2012-12-17 09:05 |    \t\t马杀鸡 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 作为一匹勇敢的马，杀鸡是必不可少的)\t\t \n  @园长 严重了，如果真有2012的话，到时候打声招呼，咱们喝着革命的酒，编着苦逼的java一起就这么等呗    \n     2012-12-17 10:52 |    \t\tleehenwu \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:24        | 撸·啊·撸)\t\t \n  围观    \n     2012-12-17 17:47 |    \t\tshack2 \t\t\t( 普通白帽子  |\t\t\t        Rank:470 漏洞数:71        | QQ:1341413415 一个热爱编程(Java),热爱网...)\t\t \n  坐等末日    \n     2012-12-20 22:16 |    \t\txiaoshi \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:2        )\t\t \n  洞主走好    \n     2013-01-29 14:48 |    \t\t \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:3        | 博客寻友链 http://imlonghao.com/)\t\t \n  昨天有朋友给阿D反馈，\"DNSPod解析异常“。经过查证，阿D发现是网宿的CDN出现阶段性不正常，请大家知晓。如果大家不知道什么原因导致了网站出现问题，请联系我们的技术人员哟，我们会尽力为大家解决问题。http://e.weibo.com/1644913943/zgy1uy2VP    \n     2013-01-30 00:26 |    \t\tYKS \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:8        | 无)\t\t \n  前几天网易豆瓣等站访问不正常就是洞主搞的？    \n     2013-01-30 12:29 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个完爆啊    \n     2013-01-30 12:52 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  幸亏我提交的洞被忽略了，不然哪天www.gov.cn不能访问就完了……LZ快把12306的IP发出来报答社会。    \n     2013-01-30 12:53 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @无敌L.t.H 什么洞？    \n     2013-01-30 13:27 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  @无敌L.t.H 哥可没有那么傻，还想回家过年呢。    \n     2013-01-30 15:13 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  @xsser  WooYun: ChinaCache节点监控后台无授权访问并存在任意文件读取漏洞 这个洞    \n     2013-01-30 17:04 |    \t\tChinaCache(乌云厂商)\t\t \n  @无敌L.t.H 那是一个后台研发自己搭建的虚拟机，跑的是一个研发中的测试系统，映射到了公网上。忽略的原因是我们没有收到乌云的告警邮件，5 天后收到了被忽略的信息。目前那个虚拟机已经被勒令去掉了 NAT 映射，对之前没能及时响应感到抱歉，我们尝试联系了乌云尝试重新打开以作出响应，但没有得到任何反馈。谢谢 @无敌L.t.H 提供的信息    \n     2013-01-31 01:14 |    \t\txiya \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n  网宿很蛋疼，之前搞还是弱口令进去的。    \n     2013-01-31 09:35 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @xiya 乌云啊    \n     2013-02-08 02:56 |    \t\tMujj \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:4        | IDC商)\t\t \n  @ChinaCache :21900    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}