{"id": 49476, "wybug_id": "wooyun-2014-078509", "wybug_title": "蘑菇街存在XXE漏洞", "wybug_corp": "蘑菇街", "wybug_author": "基佬库克", "wybug_date": "2014-10-07 08:39", "wybug_open_date": "2014-11-21 08:40", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-21：\t细节向公众公开  简要描述： 虽然漏洞存在，但情景比较特殊，利用很有限，应提早引起重视，已防将来业务改变引起更大问题 详细说明：  二哥的典型例子：http://wooyun.org/bugs/wooyun-2010-058381这边也有：http://wooyun.org/bugs/wooyun-2014-073439介绍可以看这里：http://wooyun.org/bugs/wooyun-2010-058381出问题的点在校招平台上传docx文件，docx是典型的xml文件（压缩过的）对实体做解析就会允许远程访问网站，本地文件访问，DOS攻击在这个场景下利用比较有限吧，因为返回的数据有限。对docx解析后，只提取其中 电话 邮箱 学校等信息，信息过长的话又会被忽略返回数据。所有普通看一些文件是行不通的，可利用的话就访问网站和dos攻击了。   漏洞证明：  以下证明其可以进行网站的访问：首先在自己的网站部署一个页面：内有少量数据如：http://xxxx/xxe.htm构造如下的xml实体：<!DOCTYPE ANY [<!ENTITY xee SYSTEM \"http://xxxxx/xxe.htm\">]><w:t>&xee;@qq.com</w:t>将这份docx提交，最终被解析成对用数据\n\n   修复方案：  换用安全的解析库顺便问下，你们校招人数是不是很少,10个都不招1个？   版权声明：转载请注明来源 基佬库克@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-10-08 10:25 厂商回复： 感谢@基佬库克，该漏洞已修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-07 10:01 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  蘑菇街还有xml？    \n     2014-10-07 12:30 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  @老和尚 看来你业务还没走透。。很不起眼的一个点，但是好多网站都有类似的店    \n     2014-10-07 13:49 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  @基佬库克 蘑菇街是尼姑们逛的，俺乃一介法僧    \n     2014-10-08 11:05 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @基佬库克 这个是很不错    \n     2014-10-08 11:21 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @基佬库克 强烈推荐收藏    \n     2014-10-08 11:56 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  @xsser 神马意思 @蘑菇街 能回答下我的提问吗？    \n     2014-10-08 14:28 |    \t\t黑色的屌丝 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:5        | →_→→_→)\t\t \n  这个已经修复，并且不会影响其它，能提交公开这个吗？    \n     2014-10-08 16:48 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  http://security.tencent.com/index.php/blog/msg/69这篇介绍了利用php过滤器编码后发到远程，即使不回显也over，不过蘑菇街好像java的。    \n     2014-10-08 22:12 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  @黑色的屌丝 它还没修复呢。    \n     2015-03-26 09:22 |    \t\t干脆面 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 慢慢学)\t\t \n  @基佬库克 ：）请问一下，这个 docx 是怎么构造的呢？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}