{"id": 3389, "wybug_id": "wooyun-2014-059945", "wybug_title": "安智网某接口设计缺陷导致任意用户密码重置+用户邮箱地址泄露", "wybug_corp": "安智网", "wybug_author": "猪猪侠", "wybug_date": "2014-05-08 18:32", "wybug_open_date": "2014-06-22 18:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-22：\t细节向公众公开  简要描述： 安智网某接口设计缺陷导致任意用户密码重置，重设论坛管理员密码后，1600万用户敏感信息就要告急了，愿世界和平！ 详细说明：  #1 漏洞详情，任意用户邮箱地址查询\nPOST /forgetpass.php?number=0.07094058976508677 HTTP/1.1Host: www.anzhi.comusername=a61323636&mark=3\n\n\n#2 任意密码重置因为生成的密码重置链接内，用于校验用户身份的TOKEN只是6位数字，非常容易暴力破解出来，进而重置掉用户的密码。\nhttp://www.anzhi.com/change_pwd.php?code=933836&id=******&r=1399543904.15&verify_type=1\n参考： WooYun: 美团网某接口设计缺陷导致任意用户密码重置   漏洞证明：  #3 任意密码重置证明\n\n   修复方案：  #TOKEN再复杂点就好了。   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-05-08 18:39 厂商回复： 我们正在改善，十分感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-08 18:38 |    \t\tFocusstart \t\t\t( 普通白帽子  |\t\t\t        Rank:574 漏洞数:163        | 努力让某某某成为最幸福的女人！)\t\t \n  1600w…    \n     2014-05-08 18:38 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @安智网  惨.. 别再给低分了    \n     2014-05-08 19:18 |    \t\t小人物Reno \t\t\t( 普通白帽子  |\t\t\t        Rank:471 漏洞数:110        | X)\t\t \n  晕！这都行！猪哥，我的都确认了啊！@安智网    \n     2014-05-08 19:19 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @小人物Reno 不一样的问题    \n     2014-05-08 19:20 |    \t\t小人物Reno \t\t\t( 普通白帽子  |\t\t\t        Rank:471 漏洞数:110        | X)\t\t \n  额，好吧    \n     2014-05-08 19:59 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  不带你们这样欺负新厂商的    \n     2014-05-08 20:07 |    \t\tBadCat \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:21        | 悲剧的我什么都不会)\t\t \n  不带你们这样欺负新厂商的    \n     2014-05-08 21:14 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  不带你们这样欺负新厂商的    \n     2014-05-08 22:03 |    \t\t安然意境 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:79        | 无论是你的事业还是你的个人，可能走的过程...)\t\t \n  不带你们这样欺负新厂商的    \n     2014-05-09 00:24 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  不带你们这样欺负新厂商的    \n     2014-05-11 09:48 |    \t\tSoul \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:9        | 1+1=?)\t\t \n  不带你们这样欺负新厂商的    \n     2014-05-16 08:08 |    \t\t撸人乙 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 大家好，我是撸人乙，请多多关照！)\t\t \n  不带你们这样欺负新厂商的    \n     2014-05-21 18:54 |    \t\t哦哦 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 好123，最好的导航，没有之一)\t\t \n  不带你们这样欺负新厂商的    \n     2014-05-22 21:17 |    \t\tddy \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:16        | 其实第一次要我挖洞我是拒绝的。因为，你不...)\t\t \n  提醒：目前漏洞有限制开放中，你的 Rank 级别不够 ( 可以等待进一步公开或者支付 10 个乌云币提前查看    \n     2014-05-28 12:31 |    \t\t未了 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | 我在乌云网，你在哪)\t\t \n  裤子在哪    \n     2014-06-01 17:39 |    \t\t未了 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | 我在乌云网，你在哪)\t\t \n  惨。。我还是路人    \n     2014-06-25 22:06 |    \t\t闪了 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:6        | 微博被封 准备新开 初来乍到 多多指教)\t\t \n  学习了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}