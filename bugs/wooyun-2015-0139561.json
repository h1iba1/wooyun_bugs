{"id": 69118, "wybug_id": "wooyun-2015-0139561", "wybug_title": "妈淘网逻辑设计错误可重置任意用户密码", "wybug_corp": "妈淘网", "wybug_author": "zowie", "wybug_date": "2015-09-08 17:17", "wybug_open_date": "2015-10-23 17:18", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-08：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-10-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 妈淘网——帮助亿万宝妈选购母婴用品！ 妈淘网是一个全部由达人和真实用户贡献的母婴购物经验和母婴产品信息分享平台，帮助年轻父母更合理、放心、高效的进行智慧消费。集合消费攻略、导购、大数据帮助用户进行母婴消费决策（买什么，怎么买，如何买的更安全、合理和便宜），同时为母婴品牌和商家搭建一个精准营销平台。通过导购佣金模式、商家推广、品牌合作等多样化推广以及闪购特卖等电商模式，打造一个国内独特的社会化母婴消费分享平台。 详细说明：  妈淘网（www.matao.com）安卓商店里有个app下载下来看了看在密码找回处存在明显逻辑缺陷首先在客户端进行找回密码，输入手机号选择找回密码\n\n在发送验证码之前进行截停并抓取返回包\n\n可以看到在response的返回信息中包含了verfcode用来手机接收的验证码，和用户的userid\nHTTP/1.1 200 OKCache-Control: no-cachePragma: no-cacheContent-Length: 135Content-Type: application/json; charset=utf-8Expires: -1Server: Microsoft-IIS/7.5X-AspNet-Version: 4.0.30319X-Powered-By: ASP.NETDate: Mon, 07 Sep 2015 08:14:04 GMT{\"Code\":0,\"Msg\":\"åéæåï¼\",\"Data\":{\"UserId\":1007185,\"VerificationCode\":\"666341\",\"Token\":\"fa339564-d937-4a84-b68f-11e19860c07a\"}}\n返回手机查看验证码，与抓包返回的验证码相同\n\n这里我们修改新的密码为 wooyun123\n\n\nHTTP/1.1 200 OKCache-Control: no-cachePragma: no-cacheContent-Length: 64Content-Type: application/json; charset=utf-8Expires: -1Server: Microsoft-IIS/7.5X-AspNet-Version: 4.0.30319X-Powered-By: ASP.NETDate: Mon, 07 Sep 2015 08:15:12 GMT{\"Code\":0,\"Msg\":\"ä¿®æ¹æåï¼\",\"Data\":{\"OperateResult\":true}}\n重置密码为wooyun123并进入该账户\n\n   漏洞证明：  妈淘网（www.matao.com）安卓商店里有个app下载下来看了看在密码找回处存在明显逻辑缺陷首先在客户端进行找回密码，输入手机号选择找回密码\n\n在发送验证码之前进行截停并抓取返回包\n\n可以看到在response的返回信息中包含了verfcode用来手机接收的验证码\nHTTP/1.1 200 OKCache-Control: no-cachePragma: no-cacheContent-Length: 135Content-Type: application/json; charset=utf-8Expires: -1Server: Microsoft-IIS/7.5X-AspNet-Version: 4.0.30319X-Powered-By: ASP.NETDate: Mon, 07 Sep 2015 08:14:04 GMT{\"Code\":0,\"Msg\":\"åéæåï¼\",\"Data\":{\"UserId\":1007185,\"VerificationCode\":\"666341\",\"Token\":\"fa339564-d937-4a84-b68f-11e19860c07a\"}}\n返回手机查看验证码，与抓包返回的验证码相同\n\n这里我们修改新的密码为 wooyun123\n\n\nHTTP/1.1 200 OKCache-Control: no-cachePragma: no-cacheContent-Length: 64Content-Type: application/json; charset=utf-8Expires: -1Server: Microsoft-IIS/7.5X-AspNet-Version: 4.0.30319X-Powered-By: ASP.NETDate: Mon, 07 Sep 2015 08:15:12 GMT{\"Code\":0,\"Msg\":\"ä¿®æ¹æåï¼\",\"Data\":{\"OperateResult\":true}}\n重置密码为wooyun123并进入该账户\n\n   修复方案：  客户端不返回验证码    版权声明：转载请注明来源 zowie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}