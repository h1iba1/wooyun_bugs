{"id": 87480, "wybug_id": "wooyun-2016-0180812", "wybug_title": "东软集团股份有限公司的Digitalized DCP的SQL注入影响众多高校（附多案例）                                      ", "wybug_corp": "东软集团", "wybug_author": "wonderkun", "wybug_date": "2016-03-04 14:16", "wybug_open_date": "2016-06-06 09:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-03-11：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-05-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-06：\t细节向公众公开  简要描述： 当年年少无知，发过Digitalized DCP 的一个任意文件上传漏洞，才给了我2个rankhttp://www.wooyun.org/bugs/wooyun-2010-0101007求这个给多地点吧 详细说明：  先证明一下通用性：\n百度：Digitalized DCP\n\n\n少说也有几十所大学了吧。登陆之后，获取通知的地方存在sql注入：截取数据包\nPOST /dcp/pim/pim.action HTTP/1.1Host: **.**.**.**Content-Length: 161Cache-Control: max-age=0User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.106 Safari/537.36Origin: http://**.**.**.**render: jsonclientType: jsonContent-Type: text/plain;charset=UTF-8Accept: */*Referer: http://**.**.**.**/dcp/forward.action?path=/portal/portal&p=pimHomePageAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=1JmhWZdKQQlPZnQQm2Lzy91f0yJ7yLBps4C3pbSxhbzF2xKwT8r6!2027647504; _gscu_172888939=507946429kmudl60; _gscs_172888939=t57069275dy14ws60|pv:1; _gscbrs_172888939=1{\"map\":{\"method\":\"setPimViewed\",\"params\":{\"javaClass\":\"java.util.ArrayList\",\"list\":[\"16600\",\"201309024315_S1414466619752.jpg\"]}},\"javaClass\":\"java.util.HashMap\"}\njson数据，list键值存在sql注入；   漏洞证明：  登陆之后：\n\n随便点一个通知，获取通知详情的地方，会发下面的一个数据包\nPOST /dcp/pim/pim.action HTTP/1.1Host: **.**.**.**Content-Length: 161Cache-Control: max-age=0User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.106 Safari/537.36Origin: http://**.**.**.**render: jsonclientType: jsonContent-Type: text/plain;charset=UTF-8Accept: */*Referer: http://**.**.**.**/dcp/forward.action?path=/portal/portal&p=pimHomePageAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=1JmhWZdKQQlPZnQQm2Lzy91f0yJ7yLBps4C3pbSxhbzF2xKwT8r6!2027647504; _gscu_172888939=507946429kmudl60; _gscs_172888939=t57069275dy14ws60|pv:1; _gscbrs_172888939=1{\"map\":{\"method\":\"setPimViewed\",\"params\":{\"javaClass\":\"java.util.ArrayList\",\"list\":[\"16600\",\"201309024315_S1414466619752.jpg\"]}},\"javaClass\":\"java.util.HashMap\"}\npost提交的json数据，list存在sql注入\n\nsqlmap跑一下：\n\n\n\n妥妥的DBA权限啊…………\n\n这么多数据库啊，经朋友提醒，才发现，幸福来得太突然了，教务系统竟然也用的这个数据库能不能改成绩啊？？  画面太美，不敢继续想下去了   修复方案：  过滤   版权声明：转载请注明来源 wonderkun@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2016-03-08 09:18 厂商回复： 感谢白帽子提供的漏洞信息，经与ZHF事业部确认，该问题确认存在，我们已经开始与客户联系，争取在第一时间将漏洞修复完毕！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-04 21:06 |    \t\t魔域思密达 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 研究为主)\t\t \n  东软是惨    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}