{"id": 12991, "wybug_id": "wooyun-2013-020521", "wybug_title": "万达主站重置任意用户密码缺陷", "wybug_corp": "大连万达集团股份有限公司", "wybug_author": "zzR", "wybug_date": "2013-03-23 11:22", "wybug_open_date": "2013-05-07 11:23", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "手机短信", "敏感接口缺乏校验", "任意密码修改", "验证码爆破"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-07：\t细节向公众公开  简要描述： 万达改版了嘛，界面是漂亮了，还存在一个重置任意用户密码的小缺陷。 详细说明：  万达主站万达的注册用户一般都是会绑定手机的，因为需要通过手机完成一系列的操作和买票、取票程序。登陆模块中忘记密码模块由于验证码过于简单且时间限制较长导致可以通过爆破的手段重置任意用户密码。   漏洞证明：  1·开始找回密码流程\n\n2·截断请求，并将本次post请求发送到burpsuite的intruder模块进行爆破\n\n3·\n\n测试时从353000开始。4·从爆破的结果看，短信码错误的情况下，返回的内容有{flag:'error',text:'ÑéÖ¤Âë´íÎó'}，并且返回的字节数为为203.短信码成功爆破时，返回的字节数只有195个字节，并且返回的内容是{flag:'success',text:''}！将成功的短信码请求request复制到代理模块， forward一下，就可以成功登陆爆破的账号了！看图5·error\n\n6·success\n\n7·成功进入重置新密码\n\n8·登陆成功\n\nTHAT IS ALL   修复方案：  参考修复方案： WooYun: 我是如何重置酒美网任意用户密码的 另外随机密码的方案确实有很好的用户体验，但是随机密码一个小时的有效时间，有点长。安全和用户体验貌似还真就是一个矛盾点，怎么办呢！我说清楚了嘛？   版权声明：转载请注明来源 zzR@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-03-25 08:59 厂商回复： 感谢zzR同学的关注与贡献，抓紧修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-23 11:25 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:125        | 如果大海能够带走我的矮丑...)\t\t \n  改版了啊 ，去看看。    \n     2013-03-23 11:30 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:111        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @小胖子 我这是又给大家带福利了啊    \n     2013-03-23 22:53 |    \t\tyhoojj \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        | BurNing)\t\t \n  小缺陷...    \n     2013-03-25 08:58 |    \t\t大连万达集团(乌云厂商)\t\t \n  感谢zzR同学的关注与贡献！这个貌似是以前改过的一个洞，改版的时候又冒出来了。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}