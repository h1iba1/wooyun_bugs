{"id": 6248, "wybug_id": "wooyun-2014-049677", "wybug_title": "Dnspod登录ip可以伪造", "wybug_corp": "DNSPod", "wybug_author": "ksc", "wybug_date": "2014-01-23 18:33", "wybug_open_date": "2014-02-02 18:34", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-02：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 伪造ip，可能会绕过与ip相关的任何限制（黑盒测试不知道dnspod代码具体填写的） 详细说明：  获取用户ip的时候 使用了信息 X-Forwarded-For而此信息是不可以信的   漏洞证明：  下面是我登录后dnspod给我发送的提醒邮件尊敬的用户：您的帐号 ks**@**.com 于2014-01-23 17:46:13 在 IP 110.110.110.110 上登录成功！如果本次登录不是您本人所为，说明您的帐号已经被盗！为了减少您的损失，请 点击这里，立即进行锁定帐号。\n\n   修复方案：  假如仅仅是邮件提示的地方使用的此信息，则问题不大若其他地方有基于ip地址做安全校验的地方就修改下代码吧 **关键地方不要使用 HTTP_X_FORWARDED_FOR中的信息**   版权声明：转载请注明来源 ksc@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-02-02 18:34 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-23 18:34 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  HTTP头的 X-Forwarded-For 吗    \n     2014-01-23 20:19 |    \t\tzeuser \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 新人一枚......)\t\t \n  除了x-forward-for,没准还有http_client_ip.可以被伪造不可怕,可怕的是,在这个地方能插入xss哟    \n     2014-01-24 14:00 |    \t\tTestRoot \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:19        | sys)\t\t \n  @超威蓝猫 @zeuser 是的，用那个插件就可以    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}