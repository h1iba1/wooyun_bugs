{"id": 54272, "wybug_id": "wooyun-2014-064984", "wybug_title": "phpwind 9.0后台执行任意php代码", "wybug_corp": "phpwind", "wybug_author": "芙兰朵露斯卡雷特", "wybug_date": "2014-06-17 12:38", "wybug_open_date": "2014-08-01 12:40", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传内容未检查", "文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-01：\t细节向公众公开  简要描述： 诶呀我这种小透明总算是能够发一个看起来比较高大上的漏洞了(´･ω･`)--这次漏洞的利用需要APT或者社工才能做到(｡・`ω´･)--所以请各位使用pw系统的站长要看好自己的权限咯~ _(:з」∠)_话说我打这么多颜文字会不会看起来很萌( σ'ω')σ哈哈哈哈哈就这样吧,高考完了闲得慌来一发漏洞肉肉肉我爱你~（开玩笑的） 详细说明：  漏洞的利用需要“门户设计”权限，也就是在线编辑网站模板所需要的权限。测试的phpwind版本为 v9.0 20130702本来直接告诉了开发组结果被说“你不给他权限不就好了嘛”，遂发到乌云来。由于是0day所以估计涉及了大量版本（？）正片：1.首先从官网下载了一个空模板。\n\n2.在模板中的index.htm中插入一句话代码\n\n3.重新打包，进入模板编辑模式，导入模板。\n\n4.导入成功\n\n5.用GET方式提交php代码~测试成功~\n\n小结：其实漏洞的利用还算简单。比如。。“只要20块钱定制网站模板包安装咯~只需要门户权限！”   漏洞证明：  \n\n   修复方案：  你们比我更专业~   版权声明：转载请注明来源 芙兰朵露斯卡雷特@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-06-18 09:50 厂商回复： 感谢您对我们的关注和支持，该漏洞我们正在修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-17 21:41 |    \t\t芙兰朵露斯卡雷特 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 看我闪现逃走闪现逃走六不六)\t\t \n  更新到phpwind v9.0 20140228，重现成功    \n     2014-06-28 19:18 |    \t\t博丽灵梦 \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:7        | = =cf)\t\t \n  四个wb 真贵...    \n     2014-07-01 14:52 |    \t\t芙兰朵露斯卡雷特 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 看我闪现逃走闪现逃走六不六)\t\t \n  @博丽灵梦 pw那几个管理员功利心很重，以后不挖pw的洞了    \n     2014-07-02 08:27 |    \t\t博丽灵梦 \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:7        | = =cf)\t\t \n  @芙兰朵露斯卡雷特 ╮(╯_╰)╭    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}