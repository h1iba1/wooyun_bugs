{"id": 24393, "wybug_id": "wooyun-2015-0113717", "wybug_title": "我爱卡任意用户密码重置二", "wybug_corp": "我爱卡", "wybug_author": "geegirl", "wybug_date": "2015-05-13 11:55", "wybug_open_date": "2015-06-27 12:04", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-27：\t细节向公众公开  简要描述： 再次重置任意用户密码  虽然第一个不是我发的，感谢@假马给了灵感   wooyun-2010-055118问题和之前的不太一样， 详细说明：  叙述逻辑可能有些乱，审核大人尽量看吧，谢谢啦1.首先自己注册个账号，之后点击忘记密码\n\n之后系统会向用户绑定的邮箱发送验证码，由于我要正常走一遍流程所以就填写正确的验证码了2.验证码通过后会进入重置密码页面，这里抓下包把验证码通过后的返回信息保存下（其实就是重置密码页面的html代码，这里没带响应头）\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /><title>æ¾åå¯ç âæç±å¡</title> <script type=\"text/javascript\" src=\"/js/jquery-1.8.3.min.js\"></script><script src=\"http://detail.51credit.com/javascript/jquery-1.4.2.min.js\" type=\"text/javascript\" ></script><script type=\"text/javascript\" src=\"/js/jquery.form.js\"></script><script type=\"text/javascript\" src=\"/js/jquery.validate.min.js\"></script><link type=\"text/css\" href=\"/css/new_login_common.css\" rel=\"stylesheet\"/><link type=\"text/css\" href=\"/css/new_login.css\" rel=\"stylesheet\" /><style type=\"text/css\" media=\"screen\">@import '/css/common.css';@import '/css/new_login.css';</style><!--[if IE 6]><script type=\"text/javascript\" src=\" http://img.51credit.com/credit/images/DD_belatedPNG.js\" ></script><script type=\"text/javascript\">DD_belatedPNG.fix('*');</script><![endif]--><script type=\"text/javascript\">$(document).ready(function(){\t$(\"#paw1\").keyup(function(){\t\tvar pawL=$(this).val().length;\t\tif(pawL>7&&pawL<17){\t\t\tcheckPwdLevel();\t\t}else{\t\t\t$('#pwdLevel').removeClass().addClass(\"password_qr\");\t\t}\t}).focus(function(){\t\t$(this).nextAll().hide().end().siblings(\".tishi\").css(\"display\",\"inline-block\");\t}).blur(function(){\t\tpassWord($(this));\t});\t$(\"#rePwd\").blur(function(){\t\targinPassword($(this));\t});\t//æäº¤è¡¨åæ ææ\t/**\t$(\"#reset_btn\").bind(\"click\",function(){\t\tif(checkPwdLevel>1){\t\t\tvar pawFlag=passWord($(\"#paw1\"));\t\t\tvar pawFlag1=arginPassword($(\"#rePwd\"));\t\t\tvar flag=pawFlag&&pawFlag1;\t\t\tif(flag){\t\t\t\t$(\"#safetyVerificationForm\").submit();\t\t\t}else{\t\t\t\treturn false;\t\t\t}\t\t}else{\t\t\treturn false;\t\t}\t\t\t\t});\t*/});............太长了省略了。。。</body></html>\n3.设置新密码时会发送如下请求\n\n注意这里的code参数和username参数  会面会有大用。4.ok大致流程了解了，下面试试重置doudou87这个用户的密码，\n\n5.点击下一步后，停在这里，然后点击重发邮件\n\n6.重发邮件时抓包，恩看有code，呦西，，记下来\n\n7.之后进入验证码阶段，我又布吉岛验证码，所以随便写啦，\n\n8.这里拦截下应答包，并将其中html源码部分替换为之前正常流程中返回的html代码（@恋锋大神抄袭你的思路啦。。）\n\n9.很自然一定会进入重置密码页面，10.提交新密码后，抓下包，将code和username参数改成之前获取的信息\n\n11.提示成功\n\n12.登陆看看\n\n成功了，对了之前我觉得直接在改密码时改code和username就行，可我试的不行（可能是我太菜吧）所以才用到了，这个方法。。写的有些乱，审核时添麻烦了！   漏洞证明：  \n\n\n\n求高rank，，谢谢   修复方案：  这个，，我也不太清楚   版权声明：转载请注明来源 geegirl@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-05-13 12:02 厂商回复： 感谢您对我爱卡的关注，请留个联系方式吧 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}