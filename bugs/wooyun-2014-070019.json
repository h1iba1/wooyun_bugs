{"id": 1462, "wybug_id": "wooyun-2014-070019", "wybug_title": "通卡数据库连接信息泄露可能影响会员卡信息安全(如账户、密码等信息)", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "小包子", "wybug_date": "2014-07-28 16:00", "wybug_open_date": "2014-09-11 16:02", "wybug_type": "用户资料大量泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄漏", "用户敏感数据泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-11：\t细节向公众公开  简要描述： 由于通卡服务器配置不当导致数据库信息泄露，Oracle数据库尽收眼底其中泄露的信息包括但不限于用户的：账户ID会员卡密码mobile消费记录... ...另外泄露合作厂商的：优惠券使用交易记录... ... 详细说明：  #0 漏洞站点：http://www.tongcard.com/embeded/login.do st-08漏洞\n网站物理路径： /opt/sits/tongcard.com/ROOT/java.home: /usr/java/jdk1.6.0_11/jrejava.version: 1.6.0_11os.name: Linuxos.arch: i386os.version: 2.6.18-238.9.1.el5user.name: rootuser.home: /rootuser.dir: /rootjava.class.version: 50.0java.class.path: :/opt/tomcatcom/bin/bootstrap.jar:/opt/tomcatcom/bin/commons-logging-api.jarjava.library.path: /usr/local/apr/binfile.separator: /path.separator: :java.vendor: Sun Microsystems Inc.java.vendor.url: http://java.sun.com/java.vm.specification.version: 1.0java.vm.specification.vendor: Sun Microsystems Inc.java.vm.specification.name: Java Virtual Machine Specificationjava.vm.version: 11.0-b16java.vm.name: Java HotSpot(TM) Server VMjava.specification.version: 1.6java.specification.name: Java Platform API Specificationjava.io.tmpdir: /opt/tomcatcom/temp\n#1 Oracle数据库连接信息，17个Oracle：/opt/sits/tongcard.com/ROOT/WEB-INF/classes/jdbc.properties\nhibernate.dialect=org.hibernate.dialect.Oracle10gDialectjdbc.driver=oracle.jdbc.OracleDriver#tcb.jdbc.url=jdbc:oracle:thin:@59.***.***.138:1521:tongcard#tcb.jdbc.password=AlMz9dBP@ss!#tcb.jdbc.user=tcb2#tcb.pool.size=2#tcb.max.pool.size=5tip.jdbc.url=jdbc:oracle:thin:@59.***.***.138:1521:tongcardtip.jdbc.user=tip2tip.jdbc.password=AlMz9dBP@ss!tip.pool.size=2tip.max.pool.size=20atip.jdbc.url=jdbc:oracle:thin:@59.***.***.134:1521:tongcardatip.jdbc.user=t**2atip.jdbc.password=AlM**s!atip.pool.size=5atip.max.pool.size=20db0.jdbc.url=jdbc:oracle:thin:@59.***.***.133:1521:tongcarddb0.jdbc.user=t**db0.jdbc.password=Al**ss!db0.pool.size=2db0.max.pool.size=20db1.jdbc.url=jdbc:oracle:thin:@59.***.***.29:1521:tongcarddb1.jdbc.user=t**2db1.jdbc.password=AlM**!db1.pool.size=2db1.max.pool.size=20db2.jdbc.url=jdbc:oracle:thin:@59.***.***.133:1521:tongcarddb2.jdbc.user=t**db2.jdbc.password=AlM**!db2.pool.size=2db2.max.pool.size=20db3.jdbc.url=jdbc:oracle:thin:@59.***.***.27:1521:tongcarddb3.jdbc.user=**db3db3.jdbc.password=AlM**!db3.pool.size=2db3.max.pool.size=20db4.jdbc.url=jdbc:oracle:thin:@59.***.***.25:1521:tongcarddb4.jdbc.user=tm**db4.jdbc.password=AlM**!db4.pool.size=2db4.max.pool.size=20adb0.jdbc.url=jdbc:oracle:thin:@59.***.***.230:1521:tongcardadb0.jdbc.user=t**adb0.jdbc.password=Al**ss!adb0.pool.size=5adb0.max.pool.size=20adb1.jdbc.url=jdbc:oracle:thin:@59.***.***.230:1521:tongcardadb1.jdbc.user=t**2adb1.jdbc.password=A**@ss!adb1.pool.size=5adb1.max.pool.size=20adb2.jdbc.url=jdbc:oracle:thin:@59.***.***.69:1521:tongcardadb2.jdbc.user=t**b2adb2.jdbc.password=AlMz**s!adb2.pool.size=5adb2.max.pool.size=20adb3.jdbc.url=jdbc:oracle:thin:@59.***.***.26:1521:tongcardadb3.jdbc.user=t**3adb3.jdbc.password=AlMz**s!adb3.pool.size=5adb3.max.pool.size=20adb4.jdbc.url=jdbc:oracle:thin:@59.***.***.232:1521:tongcardadb4.jdbc.user=t**4adb4.jdbc.password=Al@**ss!adb4.pool.size=5adb4.max.pool.size=20sms.modem.jdbc.url=jdbc:oracle:thin:@59.***.***.138:1521:tongcardsms.modem.jdbc.user=t**sms.modem.jdbc.password=AlM**s!sms.modem.pool.size=3sms.modem.max.pool.size=20site.jdbc.url=jdbc:oracle:thin:@59.***.***.138:1521:tongcardsite.jdbc.user=c**site.jdbc.password=138com1q2w**3e!site.pool.size=2site.max.pool.size=20tccdb1.jdbc.url=jdbc:oracle:thin:@59.***.***.137:1521:tcctccdb1.jdbc.user=××tccdb1.jdbc.password=137tccdb11q2w3etccdb1.pool.size=5tccdb1.max.pool.size=20tccdb2.jdbc.url=jdbc:oracle:thin:@59.***.***.137:1521:tcctccdb2.jdbc.user=t**1tccdb2.jdbc.password=137tccdb11q2w3etccdb2.pool.size=5tccdb2.max.pool.size=20\n#2 以jdbc:oracle:thin:@59.151.23.230:1521:tongcard为例，看下数据：首先看下用户，直接亿级别账户条数，下图那列是NUM_ROWS\n\n查询前1000条看都泄露了什么\n\n交易记录\n\n交易记录详情\n\n优惠券交易和使用\n\n   漏洞证明：  大部分都在详细说明提到了，连接Oracle数据库出现好多次504，所以上述截图只是部分在前几个数据库连接的地方会泄露会员卡信息，回忆下包括：会员卡账户ID（md5）会员卡密码（md5）是否使用 use 或者 unused... ...另外由于是root权限，直接添加账户Xshell连接了：\n\n\n\n   修复方案：  升级st到最新版，账户我会自行删掉   版权声明：转载请注明来源 小包子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-08-02 09:39 厂商回复：   最新状态： 2014-08-04：CNVD确认并复现所述情况，已经由向其网站公开邮箱通报。  ", "replys": "漏洞评价：\n评论\n     2014-07-28 16:03 |    \t\tadm1n \t\t\t( 普通白帽子  |\t\t\t        Rank:216 漏洞数:66        | 只是一个渣渣而已。。。)\t\t \n  好长的标题    \n     2014-07-28 16:05 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  卧槽，Diao    \n     2014-07-28 16:07 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  标题够长才够猛    \n     2014-07-28 16:18 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  吊炸天    \n     2014-07-28 16:37 |    \t\t红客十年 \t\t\t( 普通白帽子  |\t\t\t        Rank:334 漏洞数:63        | 去年离职富士康，回到家中上蓝翔，蓝翔毕业...)\t\t \n  火前留名    \n     2014-07-28 17:28 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  火前留名    \n     2014-07-28 17:30 |    \t\t安然意境 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:79        | 无论是你的事业还是你的个人，可能走的过程...)\t\t \n  看到这么长的标题再加上括号  第一反应是猪猪侠的携程漏洞。。。      \n     2014-07-28 17:52 |    \t\t小包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:100 漏洞数:19        | 关注技术与网络安全)\t\t \n  再深入下去，你们的会员卡就都是我的了    \n     2014-07-28 18:36 |    \t\t低调的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:466 漏洞数:68        | loading……………………)\t\t \n  竟然没闪电！    \n     2014-07-28 18:41 |    \t\t小包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:100 漏洞数:19        | 关注技术与网络安全)\t\t \n  @低调的瘦子 良心啊 @xsser @疯狗 来闪电渡劫    \n     2014-07-28 18:47 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:75        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  小包子我爱你！我要给你生孩子~    \n     2014-07-28 18:55 |    \t\t        Jn·  \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:14        | 本小菜很可爱，如果不服你TM来打我啊--哎呀...)\t\t \n  好长的标题,看样子很牛    \n     2014-07-28 18:57 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:75        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  @        Jn·  他本来想写更多的，可惜不允许了    \n     2014-07-28 19:19 |    \t\t包包兄 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | 最爱包包)\t\t \n  标题好屌    \n     2014-07-28 19:28 |    \t\t小包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:100 漏洞数:19        | 关注技术与网络安全)\t\t \n  @ 包包兄 你的名字和签名。。。    \n     2014-07-28 21:54 |    \t\tinsight-labs  \t\t\t( 普通白帽子  |\t\t\t        Rank:623 漏洞数:75        | Security guys)\t\t \n  被你们拖的都gateway timeout了……    \n     2014-07-28 21:57 |    \t\tinsight-labs  \t\t\t( 普通白帽子  |\t\t\t        Rank:623 漏洞数:75        | Security guys)\t\t \n  我猜是WEB-INF暴露了    \n     2014-07-28 22:09 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @insight-labs 没脱，应该是在修补吧    \n     2014-07-28 22:13 |    \t\t小包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:100 漏洞数:19        | 关注技术与网络安全)\t\t \n  @HackBraid 囧，这个真没脱，只是做安全测试试了几个简单sql语句而已    \n     2014-07-28 22:18 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  亿级啊？牛逼啊    \n     2014-07-29 09:23 |    \t\tWalle \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:5        | ...   位卑、未敢忘忧国！   ...)\t\t \n  脱了吧、、    \n     2014-07-29 09:29 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  该问题不存在，商家已忽略。    \n     2014-07-29 09:48 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  动次打次    \n     2014-07-29 09:49 |    \t\tinsight-labs  \t\t\t( 普通白帽子  |\t\t\t        Rank:623 漏洞数:75        | Security guys)\t\t \n  @小包子 昨天从看到这个洞开始那个网站就打不开了，一直gateway timeout……    \n     2014-07-29 09:49 |    \t\t小包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:100 漏洞数:19        | 关注技术与网络安全)\t\t \n  @Walle 不敢脱。。。    \n     2014-07-29 09:49 |    \t\t小包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:100 漏洞数:19        | 关注技术与网络安全)\t\t \n  @紫霞仙子 %>_<%    \n     2014-07-29 18:32 |    \t\t小火苗 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 我是一只小火苗呀，春风吹又生呀...)\t\t \n  @insight-labs  其他人在脱吧？    \n     2014-07-31 01:04 |    \t\txiaolan \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:2        )\t\t \n  已经拖完..........................    \n     2014-09-11 16:36 |    \t\tT-MAC \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:2        )\t\t \n  运维已经被开除了    \n     2014-09-11 20:50 |    \t\twellsun \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | www.wellsun.com)\t\t \n  诚心诚信RMB收购乌云币~ 价格加Q谈：7520024 （加者备注）    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}