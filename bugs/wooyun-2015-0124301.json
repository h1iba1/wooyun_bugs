{"id": 4647, "wybug_id": "wooyun-2015-0124301", "wybug_title": "分享销客存在任意用户密码重置等问题", "wybug_corp": "北京易动纷享科技有限责任公司", "wybug_author": "暮夕水寒", "wybug_date": "2015-07-03 11:52", "wybug_open_date": "2015-08-17 16:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-17：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 存在几个问题，依次说一下 详细说明：  1、官方测试账号弱口令登陆网址：www.fxiaoke.com/h/home/admin企业账号：fxiaoke个人账号:admin密码：123456当然这个似乎是用来测试的吧？没有任何有用的信息2、用户弱口令通过百度知道看到了一些使用纷享销客的客户，登陆它们的官网，能够猜测企业账号。比如友昌集团官网www.ycg.com.cn。企业账号可能就是ycg。企业账号：ycg个人账号admin密码：888888能够得整个企业的信息，可以添加员工等等。为了测试，添加了一个员工提权为管理员。之后在www.fxiaoke.com/XV/User/Login员工登陆，可以下载企业文件等等。\n\n3、任意重置用户密码上面两个问题显然不能影响大多数用户，那么下面就来演示如何重置所有用户密码（知道账号情况下）首先在友昌的通讯录获得纷享销客的客服手机号\n\n之后在员工登陆的页面有个找回账户或密码的按钮。之后我用刚才的账户测试了一下，发现邮件是这样的\n\n显然四位验证码非常好破解，而且输入验证码的次数没有做限制。之后我为了不对业务造成影响，用自己注册的账号进行了测试\n\n可以通过穷举来提交正确验证码   漏洞证明：  \n\n如图为跑出的验证码和邮件收到的验证码。之后输入正确验证码可以修改密码。\n\n   修复方案：  1、关于弱口令，用户第一次登录时会被系统提示修改密码，但是新密码可以和原密码相同，不知道是不是设计上的疏忽。2、修改密码的界面增加验证码，或限制输入次数。不知道漏洞类型写的对不对。。。   版权声明：转载请注明来源 暮夕水寒@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-07-04 00:18 厂商回复： 非常感谢提供漏洞信息，我们将尽快研究并解决。 最新状态： 2015-08-17：已修复已上线，再次感谢。  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}