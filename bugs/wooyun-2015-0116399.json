{"id": 18500, "wybug_id": "wooyun-2015-0116399", "wybug_title": "中柏电脑Office 365充值账号数据泄露", "wybug_corp": "深圳市中柏电脑技术有限公司", "wybug_author": "reker", "wybug_date": "2015-05-28 11:06", "wybug_open_date": "2015-07-12 11:08", "wybug_type": "内容安全", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-28：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 中柏电脑（Office365国内代理）的Office365激活助手后台存在漏洞，无需鉴权即可遍历数据库中的所有卡密账号信息 详细说明：  0.预备知识：中柏电脑出售的Office365卡是需要充值激活才能使用的。卡片长这样：\n\n1.根据卡的激活说明，在www.office-home.com.cn上下载365激活助手并打开2.http抓包可得知，激活助手会连接一个webservice接口进行通信，地址为：http://www.office-home.com.cn/webservice/api.asmx3.新建个vs工程，添加服务引用，就可以详细的看到这个webservice提供的所有接口和参数。其中GetCodeXX系列接口引起了我的兴趣4.把激活助手反编译，该程序是vb.net 4.0编写的，并未混淆，能够还原全部源码。于是分析源码，从输入卡密直到获取365账号的整个流程我都看了一遍。漏洞1：激活助手会使用内置的明文账号密码（xiaorong/1qazxcde321）调用CheckLogin接口登陆验证。此账号可以通过抓包获取，也可以反编译激活助手看到。漏洞2：成功调用CheckLogin接口登陆后，获取到一个合法的SessionId。使用此SessionId调用GetCodeV2接口，传入任意卡号，即可从服务器端获取该卡号所对应的Microsoft账号、密码和Office365激活序列号。假设此卡号已被人激活使用，那么还存在更大风险，因为使用者很可能通过Office365将私人文件、图片上传到了该Microsoft账号绑定的OneDrive中，攻击者登录账号后一览无余   漏洞证明：  随便遍历了几个卡号\n\n用获取到的Microsoft账号登陆后\n\n   修复方案：  漏洞1：应该通过用户购买的卡密来登陆。漏洞2：此接口只验证了卡号，并未要求客户提供卡号所对应的密码，也没有验证卡号是否属于当前Session，所以只要传入任意合法卡号，就能获取到该卡号的信息。   版权声明：转载请注明来源 reker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}