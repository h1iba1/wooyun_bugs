{"id": 18871, "wybug_id": "wooyun-2012-08079", "wybug_title": "百度网盘“离线下载下”下载腾讯软件后误报！", "wybug_corp": "百度", "wybug_author": "xiaoshi", "wybug_date": "2012-06-08 18:15", "wybug_open_date": "2012-07-23 18:15", "wybug_type": "内容安全", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感数据缺乏完整性校验"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-23：\t细节向公众公开  简要描述： 用百度网盘离线下载腾讯官方软件后（比如QQ,QQ音乐），软件不能运行！会被360误报为木马！ 详细说明：  用百度网盘离线下载腾讯官方软件后（比如QQ,QQ音乐），软件不能运行！会被360误报为木马！下载到网盘后:\n\n下载到电脑后：\n\n\n\n   漏洞证明：  上面有图    修复方案：  俺小白一个 不知道咋修复  哈哈   版权声明：转载请注明来源 xiaoshi@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2012-06-11 12:02 厂商回复： 感谢提交，我们正在检查bug 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-08 18:30 |    \t\t          \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 求不要和谐俺！)\t\t \n  试了一下，从官网下的和从百度网盘离线下载的QQ,它们的MD5值还真不一样。    \n     2012-06-08 18:32 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @          你不怕被和谐？    \n     2012-06-08 18:45 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @          坑爹的名字。。    \n     2012-06-08 19:16 |    \t\tz@cx \t\t\t( 普通白帽子  |\t\t\t        Rank:434 漏洞数:56        | 。-。-。)\t\t \n  @          霸气的名字    \n     2012-06-08 19:30 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @              \n     2012-06-08 20:17 |    \t\txiaoshi \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:2        )\t\t \n  @xsser @z@cx 蛋定！    \n     2012-06-08 20:59 |    \t\t数据流 \t\t\t( 普通白帽子  |\t\t\t        Rank:716 漏洞数:88        | all or nothing,now or never)\t\t \n  @          坑爹的%20    \n     2012-06-08 21:11 |    \t\txiaoshi \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:2        )\t\t \n  @imlonghao 我发下我打错字了......    \n     2012-06-08 21:32 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n      \n     2012-06-08 23:25 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  @          V5的名字    \n     2012-06-08 23:37 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  经测试，对于工行的控件下载后一切正常，腾讯的扣扣离线下载就有问题，简单观察后发现腾讯的数字签名不见了，文件大小也不对。    \n     2012-06-08 23:53 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  经过对比，发现在文件开始的400000（16进制）处开始出现不同的。是故意的吗?    \n     2012-06-11 11:28 |    \t\tFallenAngel \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 啊喔呃咿呜喻。。0.0)\t\t \n  @          你这个名字太给力了    \n     2012-06-11 11:40 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @tpu01yzx Good!分析给力    \n     2012-06-11 11:56 |    \t\tFallenAngel \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 啊喔呃咿呜喻。。0.0)\t\t \n  @tpu01yzx 正常下载没问题吧，上传后的文件好像也没问题的，是离线下载的问题吧  有两种可能  上传文件的时候将文件写入的时候写坏了  在就是离线下载的时候 出现了下载的数据的bug    \n     2012-06-11 13:17 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  @FallenAngel 从出错的位置看，0x40000这个偏移量太特别了，懂逆向的童鞋可以发表一下意见，偶就不班门弄斧了。另外，上传上去的文件显示的大小已经发生了改变了。应该是上传到服务器保存的时候出了问题，与离线下载无关。又另外，工行的控件同样是exe文件，却没有问题，莫非百度和腾讯有仇。大伙可以多测试一下其他的exe，猜想大部分应该也没问题。当然还有一种情况就是有人上传了一个hash一样的错误文件，云端通过hash检测发现已经存在了就不再保存，而直接使用了之前错误的那个文件，这对于云端来说也是一个安全性挑战啊。    \n     2012-06-11 13:18 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @tpu01yzx 再次顶，这也是我的想法    \n     2012-06-11 13:21 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  @xsser 好吧，我想说，通过简单的肉眼统计分析，400000之后的内容不太符合一般exe文件的统计特性，随机性很强，应该是被加壳了，绝对是有意为之的，不像是程序出错造成的，由此有个大胆的假设：百度的网盘被攻击了。    \n     2012-06-11 15:39 |    \t\tFallenAngel \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 啊喔呃咿呜喻。。0.0)\t\t \n  @tpu01yzx @xsser 额···刚分析了下下载的文件，不是什么恶意行为或者病毒木马  原版大小: 49075616 字节文件版本: 1.84.3470.0修改时间: 2012年6月11日, 14:01:41MD5: 4E6B80E1516DBE1C81B0A8FBB98EC567SHA1: 984FB3C88B391C3FACFE59570E01ABF4ACE215A0CRC32: C1BF9488离线下载 48M大小: 50331648 字节修改时间: 2012年6月11日, 14:07:43MD5: D4EE6F2DEB32E7EA432632DB0556120ESHA1: DD0D06922E34CF64FB406440A9AD85D0C35898D6CRC32: A069C740普通下载大小: 49075616 字节文件版本: 1.84.3470.0修改时间: 2012年6月11日, 14:05:47MD5: 4E6B80E1516DBE1C81B0A8FBB98EC567SHA1: 984FB3C88B391C3FACFE59570E01ABF4ACE215A0CRC32: C1BF9488下载文件从00400开始偏移此处开始写入文件 文件的内容是0000到00400的内容一样的后面的依次是01C000200002c00看规律 如果我分析没错的话  0100处开始重写就这样一样一遍一遍的写  最后确定 还是离线下载保存的问题  但是我不明白为啥别的exe不会这样呢     \n     2012-06-11 15:41 |    \t\tFallenAngel \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 啊喔呃咿呜喻。。0.0)\t\t \n  我去 怎么乱七八糟的 日~下载文件从00400开始偏移此处开始写入文件 文件的内容是0000到00400的内容一样的后面的依次是 01C00 02000 02c00 看规律 如果我分析没错的话 0100处开始重写 就这样一样一遍一遍的写 最后确定 还是离线下载保存的问题 但是我不明白为啥别的exe不会这样呢 网盘一bug    \n     2012-06-11 16:40 |    \t\txiaoshi \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:2        )\t\t \n  @tpu01yzx 我这里只有tx的exe出错    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}