{"id": 18242, "wybug_id": "wooyun-2012-09177", "wybug_title": "人人网Android客户端可能导致劫持或恶意软件安装", "wybug_corp": "人人网", "wybug_author": "Claud", "wybug_date": "2012-07-03 15:46", "wybug_open_date": "2012-08-17 15:46", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当导致攻击界面扩大", "手机安全", "安全", "手机软件安全", "手机应用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-03：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-08-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 人人网最新版Android客户端由于一个策略，可以导致恶意软件安装或劫持攻击。 详细说明：  人人网最新版Android客户端使用了私信功能，私信采用单独的Android软件实现，在首次启用时，联网下载该软件客户端，并存储在SD卡固定目录，然后安装并使用。如果该目录已经存在这个文件，则直接安装，而不验证这个文件是否完整无误。具体而言，该目录地址为/sdcard/Renren/downloads/Sixin.apk。另一方面，在Android中，SD卡是任何应用软件可以随意读写的。因此，攻击者只需要先将恶意软件写入/sdcard/Renren/downloads/目录并命名为Sixin.apk，在人人网客户端中启用私信，这个恶意软件就会直接被安装。特别的，攻击者可以投放一个篡改后的Sixin.apk（用repackaging技术），可以用于劫持用户会话或回传用户数据等。   漏洞证明：  不写利用代码了。直接说利用步骤吧：1. 确定手机上还没装人人私信软件2. 随便搞个apk文件，放到/sdcard/Renren/downloads/目录并命名为Sixin.apk3. 进入人人网客户端，点击私信功能这样就可以看到这个apk软件被安装了。   修复方案：  两种方法：1. 把Sixin.apk的缓存地址改为人人客户端的私有目录，而不是SD卡这样的所有软件都可读写的目录；2. 对Sixin.apk的完整性做验证后再安装。   版权声明：转载请注明来源 Claud@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-07-03 15:46 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  唉 这个进入了黑名单的公司啊    \n     2012-07-03 17:01 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  @xsser 你太狠了。。人人 我接触过一些，感觉还是比较严谨的，毕竟人家不是专业的嘛  多担待点！！    \n     2012-07-03 17:36 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @king 人家用客服来忽悠我啊 url跳转的20分啊    \n     2012-07-03 18:18 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  我们用直接公开来忽悠他们。。。    \n     2012-07-04 14:53 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  @xsser 怎么有越看越搞笑，哈哈....    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}