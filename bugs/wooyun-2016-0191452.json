{"id": 86788, "wybug_id": "wooyun-2016-0191452", "wybug_title": "宜人贷理财app多处缺陷可登录任意用户账号/任意操作", "wybug_corp": "宜人贷", "wybug_author": "BMa", "wybug_date": "2016-04-01 16:52", "wybug_open_date": "2016-05-16 17:20", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-16：\t细节向公众公开  简要描述： 宜人贷理财app多处缺陷可登录任意用户账号/任意操作 详细说明：  宜人贷理财app我们看看登录请求：\n\n看看其返回包，\n\n{\"result\":\"success\",\"errorCode\":\"\",\"msg\":\"\",\"data\":{\"token\":\"e48d6b42c4马赛克6ef647\",\"name\":\"*龄\",\"accountStatus\":\"1\",\"accountType\":\"1\",\"accountTypeChangeable\":\"\",\"isNew\":\"\",\"level\":\"000\"}}只有一个token，那也就意味着搞定一个token就可以登录任意账号，哪里有呢？在重置密码的第一个步骤，输入手机号码，查看其返回数据\n\n\n\n一模一样，那么就可以用这里的token来替换返回请求啦，然后就可以绕过客户端的sign，登录用户账号，因为token对应着用户身份来试试一个测试账号，随意输入任意密码，可以看到提示密码错误\n\nok，我们通过找回密码的接口得到其token\n\n然后构造数据，替换登录返回包\n\n成功登录\n\n查看用户个人信息：\n\n查看可用金额：\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 BMa@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-04-01 17:16 厂商回复： 感谢关注宜人贷安全 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-01 18:10 |    \t\tPgHook \t\t\t( 普通白帽子  |\t\t\t        Rank:1020 漏洞数:123        | Portulaca grandiflora Hook.)\t\t \n  牛逼啊！！！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}