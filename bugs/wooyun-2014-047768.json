{"id": 5998, "wybug_id": "wooyun-2014-047768", "wybug_title": "iGENUS5.0邮件系统的一些漏洞打包（注射及登陆等）", "wybug_corp": "爱琴思科技", "wybug_author": "clzzy", "wybug_date": "2014-01-03 15:26", "wybug_open_date": "2014-02-17 15:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-17：\t细节向公众公开  简要描述： 没事的时候下载了iGENUS5.0来看了看，时间紧，只看了个大概。大量政府、学校、科研机构、大型公司在使用这套系统。 详细说明：  先说下我使用的版本和环境：\n\n\n\n\n\n整套程序，没有防注入措施，除邮件标题和外没有放XSS错误，导致漏洞一大堆，以下测试均在魔术引号关闭的情况下进行（php5.4以后魔术引号就默认关闭了）1、信息泄露（开发者用于调试的功能）：\n\n\n\n\n\n2、各种xss：反射性：\n\n\n\n发送邮件时，邮件中插入图片，图片地址和描述存在xss：\n\n邮件签名xss：\n\n\n\n系统日志xss可以x管理员（域管理员和系统管理员），还可以csrf（大家自己去试）：\n\n\n\n3、注入存在性：\n\n\n\n4、登陆框SQL注入导致登陆任意存在的账户，或者登陆自己的账户查看别人的邮件（iGENUS的邮件存放在文件夹中）：登陆框输入：\nbaidu' and 1=2 union select 9999,'baidu','mydomains.com','$1$cKT9CGj7$svBg/NeQckI2rvfm2GWc40',0,0,'','/home/vpopmail/domains/mydomains.com/baidu','104857600S','1','2013-12-31 16:39:38','2015-12-31 00:00:00',1,1048,10,'/home/netdisk/mydomains.com/../',0,1048,0,1,0,0 from vpopmail where 'a'='a\n\n\n\n\n\n\n   漏洞证明：  \n\n\n\n   修复方案：  其实这套系统还有很多花样可以玩，程序写得不怎么样。另外网上能找到的使用这套系统的网站版本分化比较大。测试的时候差异性比较明显。   版权声明：转载请注明来源 clzzy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-01-08 08:17 厂商回复： 至8日上午，针对igenus 5.0、5.5以及其他多个版本的实例测试工作仍在进行。对于存储型XSS，暂未重点测试，目前重点测试SQL注入。同时，先行根据本地测试结果对上述漏洞进行确认。rank 20 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-08 09:06 |    \t\t4399gdww \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | )\t\t \n  mark    \n     2014-01-28 13:30 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  我去？牛逼啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}