{"id": 45679, "wybug_id": "wooyun-2015-094342", "wybug_title": "有货网存在两处安全漏洞可重置任意帐号密码（逻辑与设计缺陷）", "wybug_corp": "YOHO!有货", "wybug_author": "路人甲", "wybug_date": "2015-01-30 14:13", "wybug_open_date": "2015-03-16 14:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当", "认证设计不合理", "手机短信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-16：\t细节向公众公开  简要描述： 有货网存在多处安全漏洞可重置任意帐号密码（逻辑与设计缺陷） 详细说明：  首先有货网主站邮件密码取回功能似乎是自己的加密，没什么问题，但是细看他还有cn分站，这个分站存在逻辑漏洞，并且帐号机制居然与主站是通用的。\n\n取回一次密码\n\nbase64解码后发现哈哈了\n\n国际惯例，前面的是时间戳，后面的就是用户邮箱了。   漏洞证明：  利用就简单了，取回一次密码\n\n重点看这里的时间戳，GMT+8就是中国所在时区了。但这里还是要注意网络通信以及B/S段时间不同步的延迟问题，所以我们正负10秒区域进行一次爆破。\n\n最终发现时间戳是 1422416945，果然相差4秒！！经过两个&&符号与邮箱连接，在base64编码后拼接URL。\n\n重置成功。\n\n对了，之前不是说两处漏洞么？另一处比较明显了，就是这里\n\n手机取回密码只要4位数字，爆破太简单了。。。   修复方案：  你懂我懂大家懂   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-01-30 15:01 厂商回复： 感谢@路人甲 ,对应这样的低级漏洞我们马上解决，希望给我们多多提出意见，感觉 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-28 17:57 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  他撸你也来撸    \n     2015-01-30 16:34 |    \t\t计算姬 \t\t\t( 普通白帽子  |\t\t\t        Rank:398 漏洞数:90        | 看我看我看我啊)\t\t \n  @Finger 还有谁撸？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}