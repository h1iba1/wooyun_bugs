{"id": 5046, "wybug_id": "wooyun-2015-0114875", "wybug_title": "启明星辰/网御星云安全配置核查管理系统存在默认数据库口令及默认账户问题", "wybug_corp": "北京启明星辰信息安全技术有限公司", "wybug_author": "路人甲", "wybug_date": "2015-05-19 08:03", "wybug_open_date": "2015-08-17 12:10", "wybug_type": "默认配置不当", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-22：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-07-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-17：\t细节向公众公开  简要描述： 启明星辰、网御星云两家公司（实际上也算一家人了吧？）使用的基线出于同一个开发团队，功能和代码上大同小异，但是同时存在下列问题：1.\t可远程连接的mysql数据库默认口令（固定的，两家相同）；2.\t某个客户正常情况下不会关注到的默认账户（两家都有，而且一般情况下谁都不会关注到这个账户） 详细说明：  以下为网御星云版基线测试结果：版本：v6.0.80.3_U1.3，应该是15年1月份的版本。\n\n数据库用的是mysql，端口为3308数据库用户名为tsoc（泰合？）密码为venustech.****.*****关键的问题有两点：1．\t此账号可远程连接； 2．\t此账号密码都是统一的。 下图网御星云基线数据库配置信息：\n\n连接数据库测试：\n\n\n\n\n\n\n\n获取登录基线的用户名和加密的密码（sha1）\n\n某用户可获取明文密码：ha*****/**.venus其中，此密码也是通用的默认口令。一般用户不会注意到此用户名，更不会更改其密码。因为其主要用于分布式存储，如果不在特定的情况下，是不会关注到存在此用户的。登录此用户的截图：\n\n另外一台基线的测试截图：\n\n\n\n   漏洞证明：  以下为启明星辰版基线测试结果，登录界面不同点主要是图标（此处是显示的启明星辰的泰合的图标）：\n\n启明星辰版数据库配置截图，主要只是保存的路径不同（比如此处是venustech）：\n\n上图可以看出，ha*****账号密码和网御版的配置文件还有数据库里面的密码是一样的。所以同理会存在上面说的那个默认口令的问题。数据库连接测试：\n\n数据库的构成和网御的基本一致：\n\n   修复方案：  1.\t每次安装使用随机数据库用户名、密码2.\t数据库用户进制远程连接。3.\t提示超级管理员系统存在多少用户、哪些用户还使用了默认密码，尽量避免默认口令被利用。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-05-19 12:09 厂商回复： 已经确认存在此问题，我们正在进行修复。因为需要有登录到主机系统的权限才能查看配置文件，利用需要一定条件，所以给中级，10 rank。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-19 15:28 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  基线有安装包吧，有安装包谁都可以看到的吧，不一定需要主机的权限吧。多半是所有版本的数据库xx都一样    \n     2015-05-21 18:22 |    \t\t北京启明星辰信息安全技术有限公司(乌云厂商)\t\t \n  @wefgod 我指的是硬件版本。如果都有安装包了，那当然也没什么秘密可言了，做安全的都明白的道理。当然我们实现上也存在问题，正在改进，感谢路人甲。    \n     2015-05-22 11:28 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @北京启明星辰信息安全技术有限公司 不是说有没有秘密的问题，主要是说实现上的问题而已。如果是所有数据库密码都设置为一样的话（按标题就知道是默认密码），那别人只要拿到一个安装包，以后遇到这类系统基本都可以用同一个账户密码去连数据库，我仅仅表达这个意思。    \n     2015-05-22 11:30 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @北京启明星辰信息安全技术有限公司 如果采用的是随机的数据库密码，至少这个问题不一定会有。    \n     2015-05-23 20:01 |    \t\txsser_w \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:33        | 哎)\t\t \n  这人是谁 胆敢搞乙方 你死定了    \n     2015-05-25 12:40 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @xsser_w 哈哈    \n     2015-05-27 14:42 |    \t\t北京启明星辰信息安全技术有限公司(乌云厂商)\t\t \n  @wefgod 您说的有道理，我们会在修补方案中考虑您的建议。多谢大家关注。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}