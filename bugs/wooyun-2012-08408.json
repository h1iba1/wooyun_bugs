{"id": 18674, "wybug_id": "wooyun-2012-08408", "wybug_title": "六间房可修改任意用户密码", "wybug_corp": "六间房", "wybug_author": "blue", "wybug_date": "2012-06-17 18:53", "wybug_open_date": "2012-08-01 18:54", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证缺陷", "盲目信任用户数据", "认证设计不合理", "权限绕过", "用户敏感数据泄漏", "敏感接口未加权限认证"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-01：\t细节向公众公开  简要描述： 通过一系列的操作，可以修改任意用户的密码，好多妹子啊~~ 详细说明：  1.绑定了安全邮箱后，点击登录时的\"忘记密码\"，输入安全邮箱，到邮箱里获取到找回密码的链接(此链接在24小时内可以不限次使用)，进入重置密码页面。2.重置密码的表单里，有几个隐藏字段，其中有uname一项，即用户名，更改为任意用户名(测试只有绑定了邮箱的用户才能起作用，起码高级用户都会绑定吧？)3.提交，密码修改成功，并且已登录受害用户的账号。   漏洞证明：  1.注册成功并绑定自己的邮箱后，退出进入找回.\n\n2.获取修改链接 http://6.cn/user/losepass.php?uid=******&code=*****,提交前修改隐藏字段uname\n\n3.修改完默认直接登录受害用户的账号，退出再登录测试密码也成功，OK了\n\n   修复方案：  把生成的code和用户绑定，修改提交时再验证一次   版权声明：转载请注明来源 blue@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-06-18 09:47 厂商回复： 非常感谢提出的BUG， 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-17 18:54 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个世界肿么了～～    \n     2012-06-17 19:03 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @xsser = = 末日了。。     \n     2012-06-17 19:13 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  俺是来抢板凳的。每个会火的洞，俺都是前排的。四楼知道俺的，五六楼的兄弟也知道。    \n     2012-06-17 19:15 |    \t\tThe End \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n  大牛，绝对的大牛    \n     2012-06-17 19:20 |    \t\t西毒 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:33        | 心存谦卑才能不断超越自我)\t\t \n  。。。。。这个要是真被人拖了，要被爆菊的    \n     2012-06-17 19:37 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  现在大家都知道密码修改这个位置的脆弱性，，于是。。。就陆续各种爆了。。    \n     2012-06-17 22:05 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  汗，那串玩意居然一直生效，不会过期!改下*name就成了    \n     2012-06-17 22:13 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  @Xhm1n9 灵异，又失败了?    \n     2012-06-18 12:36 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  终于补了    \n     2012-07-19 15:51 |    \t\t洛辰 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | 小白~~)\t\t \n  牛叉~~~    \n     2012-07-19 21:21 |    \t\tca3tie1 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:4        | castiel)\t\t \n  又是验证机制不严格！！给力！！！    \n     2012-07-21 00:29 |    \t\tSpy4man \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 职业运维师..)\t\t \n  niubility！方法简单实用    \n     2012-08-02 14:42 |    \t\t性感的蛐蛐 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 少年,母猪喊你回家拱地!)\t\t \n  呵呵,验证机制不完善,cookies一直生效?    \n     2012-08-02 15:50 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @性感的蛐蛐 验证问题~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}