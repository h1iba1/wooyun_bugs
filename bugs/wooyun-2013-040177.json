{"id": 7826, "wybug_id": "wooyun-2013-040177", "wybug_title": "华为某站点逻辑设计缺陷可重置任意用户密码", "wybug_corp": "华为技术有限公司", "wybug_author": "带馅儿馒头", "wybug_date": "2013-10-18 14:54", "wybug_open_date": "2013-12-02 14:55", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-02：\t细节向公众公开  简要描述： RT 详细说明：  \n问题站点：华为爱旅，hwtrip.smartcom.cc\n\n\n1.注册两个用户XXX@sina.com和XXXX@sina.cn,使用@sina.com用户进行密码找回；\n\n2.登陆邮箱获取密码重置链接；\n\n3.系统仅仅校验了url请求中的各项值是否匹配，配置方可成功进入密码重置页面；\nhttp://hwtrip.smartcom.cc/user.php?act=resetPSW&email=xxxx@sina.com&ck=fada81749**********6e63c7c0c8&uid=123456789\n4.但是在成功进入密码重置页面后却没有继续进行后续的校验；\n\n5.填入我们想要重置的密码，提交提交并抓包分析发现数据中提交了重置密码对应的帐号，直接替换成@sina.cn用户的帐号并提交；\n\n6.系统提示我们重置密码成功了；\n\n7.使用@sina.cn用户和重置后的密码成功登陆帐号；\n\n8.最后，使用上面的方法重置一个华为的企业用户，居然发现没激活，汗...\n\n   漏洞证明：  见详细说明   修复方案：  在密码重置过程中的每一步都要严格校验；   版权声明：转载请注明来源 带馅儿馒头@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2013-10-21 16:27 厂商回复： 感谢带馅儿馒头的关注，业务部门正安排整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-18 18:32 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  连载的节奏。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}