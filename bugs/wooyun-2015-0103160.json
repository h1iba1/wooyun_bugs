{"id": 35791, "wybug_id": "wooyun-2015-0103160", "wybug_title": "云农场重置密码漏洞", "wybug_corp": "云农场", "wybug_author": "路人甲", "wybug_date": "2015-03-24 16:04", "wybug_open_date": "2015-05-08 16:06", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-24：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-05-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  云农场1 手机验证码在返回包中2 POST请求直接改密\nhttp://www.ync365.com\n首先我用自己手机号注册了一个用户，然后可以登录，之后我就退出账户，找回密码。在首页“登录”下点“忘记密码”，然后到了找回密码链接中：\nhttp://www.ync365.com/resetPassword.php?act=default&type=users\n输入手机号18700000000，点击发送验证码，这里手机号不存在\n\n抓取数据包，一个GET请求验证手机号是否存在：\nGET /resetPassword.php?val=18700000000&type=0&act=checkPhone HTTP/1.1Host: www.ync365.com\n返回的是：\nno\n然后我输入自己的手机号187********，发送验证码，\n\n先有一个验证手机是否存在的数据包，这个返回的是：\nyes\n这个可以用来证明一个手机号是否存在，后面用到的。然后是发送验证码的包,\nGET /resetPassword.php?val=187********&type=0&act=sendCode HTTP/1.1Host: www.ync365.com\n这个可以用来进行手机短信轰炸，可以频发的发送，然后返回的是\nbool(true)\n然后我不看手机验证码，自己输入一个111111，\n\n这个有发送数据包，抓包，看到了返回包的信息：\n\n是的，这个code确实是验证码，650406，输入，进去了\n\n改密成功，然后也可以登录的。\n\n好的，抓下改密的数据包：\nPOST /resetPassword.php HTTP/1.1Host: www.ync365.comConnection: keep-aliveContent-Length: 74Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://www.ync365.comContent-Type: application/x-www-form-urlencodedReferer: http://www.ync365.com/resetPassword.phpAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8new_password=111111&new_pass=111111&type=0&act=resetDone&phone=187********\n然后单独发送这个数据包，注意下长度，然后就可以成功改密了，新密码可以登录。到这里，如果我知道一个已经注册了该网站的用户的手机号，那么我就可以不发送验证码直接这个POST请求来更改密码了，但是找到手机号还是不方便的，不过侥幸的是，我找到了这个：\n\n\nhttp://www.ync365.com/article.php?id=906\n根据模糊的查看，然后在根据之前的GET请求验证手机号是否存在，然后就找到了一个，\n\n\n\n然后就可以改密了，因为已经用我的手机号测试过了，所以这里就没给他改密码。这个POST请求直接改密时，返回302重定向是改密成功，200OK的是没改密成功。   漏洞证明：  \n\n改密成功，可以登录。   修复方案：  逻辑   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}