{"id": 51772, "wybug_id": "wooyun-2014-073395", "wybug_title": "江苏移动订单信息泄露", "wybug_corp": "中国移动", "wybug_author": "店小二", "wybug_date": "2014-08-22 11:18", "wybug_open_date": "2014-10-06 11:20", "wybug_type": "用户资料大量泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄露", "平行权限", "错误回显"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-06：\t细节向公众公开  简要描述： 江苏移动wap网页订单信息泄露，设计用户姓名、住址、联系电话等大量敏感信息。订单号有规律，通过枚举查询，可查看大量用户信息。 详细说明：  wap网页订单信息查询地址为http://wap.js.10086.cn/mall/mall/activity.do?pageCont=order_detail&orderid=011012073020150通过orderid可查询出对应的订单信息，且订单有规律。第一份订单如下：\n\n从图中可以看到用户姓名、住址、联系电话、所购商品详细信息。接下来我们看看订单号的规律：前4位为订单时间（图中绿线所示，与下面的时间01:10对应），中间6为日期（图中红线所示，与下面的日期12-07-30对应），后5位是订单序号。通过订单的规律，我们可以使用Burpsuite等工具枚举出所有事间段的订单信息，可导致大规模用户隐私信息泄露。由于错误的订单会返回错误信息，并造成服务器的日志负担，这里就不在暴力遍历所有订单号了。这是返回的错误信息：\n\n通过错误信息科看到web服务器版本、所使用的编程技术、过滤函数等信息。这里更进一步的漏洞我就不深挖了。   漏洞证明：  另外两份订单：http://wap.js.10086.cn/mall/mall/activity.do?pageCont=order_detail&orderid=102914080140585\n\nhttp://wap.js.10086.cn/mall/mall/activity.do?pageCont=order_detail&orderid=121913081993294\n\n   修复方案：  1、进行权限验证，只用本用户可查询自己的订单2、关闭错误回显，可用固定错误页面代替。   版权声明：转载请注明来源 店小二@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-08-27 10:12 厂商回复： CNVD确认所述情况，已经转由CNCERT通报给中国移动集团公司，由其后续协调处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}