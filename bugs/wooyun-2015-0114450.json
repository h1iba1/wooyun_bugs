{"id": 22956, "wybug_id": "wooyun-2015-0114450", "wybug_title": "美囤妈妈登陆验证码可绕过进而可撞库（影响宝宝树）", "wybug_corp": "美囤妈妈", "wybug_author": "路人甲", "wybug_date": "2015-05-16 16:13", "wybug_open_date": "2015-06-30 20:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["验证码绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-30：\t细节向公众公开  简要描述： 之前提交非要证明，周末用常见弱密码跑出来了几个用户 详细说明：  主站登陆接口user.meitun.com/user/ajaxLogin?callback=jQuery&username=手机号&password=password此接口请求过多时会出验证码，其实是根据cookie中的session来决定有没有验证码的。因此删掉所有cookie去请求此接口即可免去验证码。本来就到此为止了，可乌云非要有数据证明才给过。。。注册接口未限制单IP请求数，导致可以遍历手机号查询得到已注册用户列表用burp 的Intruder遍历北京联通的一个号段，跑了1W多次，得到94个已注册手机号[抱歉，用你们发短信的接口给1W用户发了注册短信:) ]\n\n94个手机号为\n18601140052186011403951860114039418601140466186011405421860114055318601140746186011411291860114118118601141217186011412781860114127918601141300186011413801860114141818601141668186011416781860114189018601142001186011420731860114230218601142558186011426861860114273218601142861186011428851860114289918601142913186011429591860114298118601143019186011433851860114351318601143534186011435351860114373118601143919186011439591860114396018601144019186011440411860114404018601144220186011443551860114459518601144632186011449871860114503518601145105186011452821860114540618601145524186011455211860114564518601145779186011459031860114620118601146280186011464961860114649718601146599186011466601860114682318601147002186011472121860114731918601147547186011475601860114756218601147605186011476911860114774618601147877186011478831860114799718601148167186011483371860114849318601148513186011486291860114866118601148692186011487441860114878218601148812186011489991860114909118601149164186011491631860114940518601149438186011497121860114971118601149806\n然后用csdn的top100密码对这94个用户进行撞库9400次请求，最后跑出来两个密码为123456的用户\nusername=18601141418&password=123456username=18601148812&password=123456\n\n\n另外，看用户昵称似乎是宝宝树的用户，自动开通了美囤妈妈的账号，试着在宝宝树登陆，还真成功了\n\nTo审核人员：虽然只有两个用户，但也说明了验证码可绕过的问题，如果要大量成功数据，就得给更多人发短信，有些不太好...   漏洞证明：  \n\n   修复方案：  1.登陆的验证码策略不能和session绑定，应该和IP绑定2.m页登陆接口是完全无验证码的，也可以直接用来撞库3.注册接口要限制单IP发送短信量4.移动端注册接口同样需要限制短信发送量   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-05-16 20:00 厂商回复： 其实此问题我们已经知道，还没来得急修复。谢谢洞主，请继续关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-16 16:31 |    \t\tkydhzy \t\t\t( 普通白帽子  |\t\t\t        Rank:362 漏洞数:62        | 软件测试)\t\t \n  好像是这家唯一一个上大厂商的    \n     2015-05-16 18:17 |    \t\t90Snake \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:42        | 最大的漏洞就是人)\t\t \n  @kydhzy 目测10Rank    \n     2015-06-30 21:23 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:71        | I'm Me_Fortune)\t\t \n  洞主以后直接跑123456就没错，99个就从来没用过    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}