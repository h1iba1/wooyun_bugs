{"id": 55337, "wybug_id": "wooyun-2014-061302", "wybug_title": "某图书馆自动化集成系统注入导致可写shell", "wybug_corp": "深圳市科图自动化新技术应用公司", "wybug_author": "abcdlzy", "wybug_date": "2014-05-20 13:10", "wybug_open_date": "2014-08-18 13:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-18：\t细节向公众公开  简要描述： 随着ILAS人不断的努力，ILAS已成为国内用户数最多、推广面最广、实用性最强、联网性能最佳的图书馆自动化集成系统，它改写了国内图书馆自动化管理多依赖国外进口软件的历史。在第62届国际图联大会期间展出时，被誉为“中国图书馆自动化的骄傲”。ILAS先后获得国家“科技进步三等奖”、文化部“科技进步一等奖”和广东省文化厅“科技进步一等奖”等十多个奖项。 详细说明：  如果需要在公网验证,可以谷歌搜inurl:\"NTRdrLogin.aspx\"目前找了个比较好的就是opac.jxlib.gov.cn.http://opac.jxlib.gov.cn/NTRdrLogin.aspx因为桂电的图书馆也是ILASIII所以用桂电的校园网可以访问的图书馆来验证.202.193.70.138为桂电校园网的可以访问的地址   漏洞证明：  下图仅仅是证明都存在这个问题,未对其进行下一步渗透.直接按ctrl+c了\n\n因为桂电的图书馆也是ILASIII所以用桂电的校园网可以访问的图书馆来验证.202.193.70.138为桂电校园网的可以访问的地址\n\n然后用http://huaidan.org/archives/2967.html的方法直接上存储过程写一句话\n\n上菜刀拿dll\n\n   修复方案：  \nprotected void BtnLogin_Click(object sender, EventArgs e){    string text = string.Empty;    string str2 = string.Empty;    if ((this.txtName.Text.Equals(\"\") && (this.txtName.Text.Length == 0)) && ((this.txtPassWord.Text.Length == 0) && this.txtPassWord.Text.Equals(\"\")))    {        this.LabMessage.Text = \"对不起，用户名和密码不能为空！\";    }    else    {        text = this.txtName.Text;        this.txtPassWord.Text.Trim();        string str3 = this.txtPassWord.Text.Trim();        MD5 md = new MD5CryptoServiceProvider();        byte[] bytes = Encoding.GetEncoding(\"UTF-8\").GetBytes(\"ilas\" + str3);        byte[] buffer2 = md.ComputeHash(bytes);        for (int i = 0; i < buffer2.Length; i++)        {            str2 = str2 + buffer2[i].ToString(\"x2\");        }    }    string cmdText = \"select R000,R01p,R01s from NEW_READER where R01b='\" + text + \"'\";\ntext变量可控,来源于登陆界面的 用户名应该使这个变量不可控   版权声明：转载请注明来源 abcdlzy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-05-25 09:08 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}