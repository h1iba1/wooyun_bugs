{"id": 13117, "wybug_id": "wooyun-2013-020242", "wybug_title": "人人网某分站储存型xss，可以盗cookie、蠕虫，对指定用户攻击，战火有蔓延到主站", "wybug_corp": "人人网", "wybug_author": "px1624", "wybug_date": "2013-03-18 11:55", "wybug_open_date": "2013-05-02 11:55", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-02：\t细节向公众公开  简要描述： 人人网某分站储存型xss，可以盗cookie、蠕虫，对指定用户进行攻击，战火有蔓延到主站。不小心发现的，由于中招途径多样化，所以cookie接收速度是超快的额。求礼物~~还没有人人网的礼物呢。 详细说明：  以下部分证明以弹窗证明（盗cookie页面体现不出来，只需要把弹窗代码变下就可以了）。1 缺陷分站为 http://goldenonline2013.renren.com/2 貌似是一个人人活动的页面，里面有一个功能就是 “发心愿，求祝福”。这里直接啥都没过滤。图1\n\n3 弹窗证明。图2 \n\n4 盗取cookie证明，可以看到cookie的来源是有蛮多途径的。（短短10分钟就抓了400个左右）图3 图4\n\n\n\ncookie登录证明（这号不是我的，不认识）图000\n\n5 指定用户攻击。（求祝福的时候，可以选定好友站内消息提醒，抓包发送数据可以无视好友关系）图5 图6 图7 \n\n\n\n\n\n6 蠕虫也可以，这里不做证明了。   漏洞证明：  如上   修复方案：  人人网，这个可以有礼物的额。我是好孩子~修补：方案1 过滤。方案2 无视，等待活动结束（3月31日结束）。图8\n\n   版权声明：转载请注明来源 px1624@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2013-03-18 14:04 厂商回复： 感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-18 11:58 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:84        )\t\t \n  加你还是找到了    \n     2013-03-18 11:59 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  尼玛，哥不玩人人真明智    \n     2013-03-18 12:08 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  。。标题要不要写这么长。    \n     2013-03-18 12:08 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  似曾相识    \n     2013-03-18 12:12 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @xsser 给审核更新通过下，图1 图2 我刚才忘记 马赛克 个人信息了。。。    \n     2013-03-18 12:13 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小胖胖要减肥 你教我的工具不给力啊！半天都扫不出一个分站，我最后是直接谷歌搜索的。。。    \n     2013-03-18 12:14 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @gainover 长了霸气，哈哈~    \n     2013-03-18 12:14 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @风萧萧 估计是那句 蔓延到主站 你感觉熟悉。    \n     2013-03-21 14:56 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  又是淫淫网....好久没上过了...     \n     2013-03-21 16:01 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @Drizzle.Risk 为什么要加个 又 字、、     \n     2013-03-21 17:13 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  @px1624 人人XSS很多啊    \n     2013-03-21 17:18 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @Drizzle.Risk 以前很多，现在还好吧、、我挖了一个小时 就挖了这一个、、你那很多？？    \n     2013-03-21 22:17 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  @px1624 一直年后就没挖了...    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}