{"id": 70551, "wybug_id": "wooyun-2015-0133878", "wybug_title": "太平洋直购某功能逻辑错误任意帐号密码重置", "wybug_corp": "太平洋直购", "wybug_author": "节奏感", "wybug_date": "2015-08-17 21:17", "wybug_open_date": "2015-10-03 19:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-19：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-08-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-03：\t细节向公众公开  简要描述： 太平洋直购 真正的消费者联盟 打造全球唯一全新理念BMC商城 太平洋直购(www.tpy100.com)是江西精彩生活投资发展有限公司旗下最专业、最全面的电子商务平台之一。 详细说明：  问题就出在找回密码处  随便输入帐号  我这里输入admin进行测试   然后点击下一步\nhttp://**.**.**.**/Apply/SubmitLoginName.aspx\n\n\n   漏洞证明：  之后选择通过注册手机找回密码  确认发送短信  然后查看了下JS  8位验证码  此时随便输入8位置验证码  然后burp 抓包\n<script language=\"javascript\" >    function checkCode() {        var Error = '<img src=\"images/error.gif\"/>';        var rightCode=/^\\d{8}$/;        var code = document.getElementById(\"txtCode\");        var Ctu = document.getElementById(\"Ctu\");        var CErr = document.getElementById(\"CErr\");        if (code.value == \"\") {            Ctu.innerHTML = Error;            CErr.innerHTML = \"请输入验证码！\";            return false;        }        else if (!rightCode.test(code.value)) {            Ctu.innerHTML = Error;            CErr.innerHTML = \"请正确输入验证码！\";            return false;        } else {        Ctu.innerHTML = \"\";        CErr.innerHTML = \"\";        return true;        }            return false;    }</script>\n   修复方案：  \nCookie: AJSTAT_ok_pages=1; AJSTAT_ok_times=1; CNZZDATA1777806=cnzz_eid%3D1566587197-1439448765-%26ntime%3D1439448765; UserPvInfo-=1%7c%7c%7c%7c%7c0.0300%7c%7c%7c%7c%7ctpy100%7c%7c%7c%7c%7c0%7c%7c%7c%7c%7c0%7c%7c%7c%7c%7c%7c%7c%7c%7c%7c0.0300; MWS_User=Bindusername=admin&phonecode=48052502__VIEWSTATE=%2FwEPDwUJLTcxMDQ2NjQ1D2QWAgIBD2QWBAIBDw8WAh4EVGV4dAUFYWRtaW5kZAIDDw8WAh8ABQ4xMzYqKioqKioqKjQ4MWRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBQdidG5Db2RlBQZTdWJtaXQcT0NpsacPV8ehA1JzmISpAAAAAA%3D%3D&__EVENTVALIDATION=%2FwEWBALIyOzuAQKWt8CPBALChPzDDQK8w4S2BO9kqca5%2BUXsPwjdNdZm9%2BMAAAAA&txtCode=12312312&Submit.x=69&Submit.y=22\n抓到如下包  大家请看cookie处phonecode=后面的8位数字 这TM验证码就在这里...此时我们截断把post的我们输入的验证码改为cookie里的验证码 就成功通过验证进入密码重置了\n\n\n\n\n\n   版权声明：转载请注明来源 节奏感@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-08-19 18:58 厂商回复： CNVD确认所述漏洞情况，暂未建立与软件生产厂商（或网站管理单位）的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}