{"id": 31036, "wybug_id": "wooyun-2015-0115061", "wybug_title": "p2p金融安全之金海贷多处存储XSS(打包)", "wybug_corp": "jinhaidai.com", "wybug_author": "her0ma", "wybug_date": "2015-05-20 11:16", "wybug_open_date": "2015-07-04 17:18", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-04：\t细节向公众公开  简要描述： p2p金融安全系列，金海贷存储XSS漏洞打包了.....一开始让我提交存储XSS这种漏洞，我是拒绝的……后来脑海中想起了px1624的一句话:\"苍蝇再小也是肉！\"，这句话让我幡然醒悟，提了！ 详细说明：  金海贷社区(http://www.jinhaidai.com/sns)有多处存储XSS漏洞，用户体系和官网使用的是同一套，因此存储XSS危害还是比较大的。存在存储XSS漏洞的功能有以下几个：1，小组发表话题功能，话题标题未进行输入过滤和输出编码；http://www.jinhaidai.com/sns/groups/562，个人资料简介、毕业院校、专业、公司、职位等未进行输入过滤和输出编码。http://www.jinhaidai.com/sns/people/94529/personal主要是第一个漏洞，发布话题，抓包请求如下：POST /sns/groups/updatetopic/56?topic_id=6509 HTTP/1.1Host: www.jinhaidai.comJHD_CSRF_TOKEN=c0e97d95f831f830708bc48604722ce8ae5ed3ab&group_id=56&Topic%5Btitle%5D=&Topic%5Bstatus%5D=2&Topic%5Btags%5D=%E9%87%91%E6%B5%B7%E8%B4%B7&yt0=%E4%BF%9D%E5%AD%98&Topic%5Bcontent%5D=Topic%5Btitle%5D未进行输入过滤和输出编码，由于帖子是任意用户都可以浏览的，因此危害较大，可以盲打到cookie，如图：\n\n   漏洞证明：  \n\n   修复方案：  检查所有的输入点和输出点，进行输入过滤或者输出的编码。   版权声明：转载请注明来源 her0ma@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-05-20 17:17 厂商回复： 感谢提供的漏洞信息。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-21 09:26 |    \t\tuu7737 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 导航站平台)\t\t \n  楼主怎么联系？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}