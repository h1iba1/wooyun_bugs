{"id": 58222, "wybug_id": "wooyun-2014-051884", "wybug_title": "大麦网任意账户（手机注册）密码重置", "wybug_corp": "大麦网", "wybug_author": "hkAssassin", "wybug_date": "2014-02-24 13:38", "wybug_open_date": "2014-04-10 13:38", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "认证设计不合理", "手机短信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-10：\t细节向公众公开  简要描述： 只要知道手机号，就可以重置任意用户名密码。看详细说明…… 详细说明：  \n\n到找回密码功能区。输入手机号。就会显示此手机号是不是已经被注册，以此来判断大麦网的注册用户。遍历188010……这样的手机号段我想能找到很多已经注册的用户。这里我只是做一个测试，为了避免对其他用户造成影响，我用自己注册的账号做测试！\n\n这是通过爆破得到的正确手机码\n\n这是我手机上收到的手机码，对比爆破得到的手机码，可以看到大麦网吧手机码在后台程序中都转换成了小写，这大大降低了爆破的难度……\n\n爆破成功后关闭bp自动跳转到重设密码页   漏洞证明：  \n\n到找回密码功能区。输入手机号。就会显示此手机号是不是已经被注册，以此来判断大麦网的注册用户。遍历188010……这样的手机号段我想能找到很多已经注册的用户。这里我只是做一个测试，为了避免对其他用户造成影响，我用自己注册的账号做测试！\n\n这是通过爆破得到的正确手机码\n\n这是我手机上收到的手机码，对比爆破得到的手机码，可以看到大麦网吧手机码在后台程序中都转换成了小写，这大大降低了爆破的难度……\n\n爆破成功后关闭bp自动跳转到重设密码页   修复方案：  1）手机码 为什么只有4位，26个字母加上0到9十个数字的组合总共36个字符。总共160多万中组合可能。一台机器上开10个线程爆破1W大概需要5分钟左右。所以用一台机器8个多小时就可以完全爆破出一个密码，如果两台，三台……你懂嘚！2）其实4位手机码不是问题，问题是为什么不加验证次数，这才是硬伤。3）手机增加到6位，同时加验证次数，这个理论上就绝对安全了（不排除人品爆发的那种人，一下子就蒙对了）。   版权声明：转载请注明来源 hkAssassin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-02-28 18:14 厂商回复： 你好感谢您提供的网站漏洞，后续情况我会在跟您沟通 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}