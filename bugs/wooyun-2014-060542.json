{"id": 2211, "wybug_id": "wooyun-2014-060542", "wybug_title": "某电子政务平台通用型SQL注入漏洞", "wybug_corp": "北京网盟信息技术发展有限公司", "wybug_author": "xlz0iza1", "wybug_date": "2014-05-13 15:42", "wybug_open_date": "2014-08-11 15:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-19：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-11：\t细节向公众公开  简要描述： 涉及还是比较多。 详细说明：  育软电子政务平台文件/include/upload/showaccessory.jsp\n<%@ page contentType=\"text/html;charset=GBK\" %><%@ page errorPage=\"../errorpage.jsp\" %><jsp:useBean id=\"info\" class=\"edoas.e_info\" scope=\"page\" /><%  String fileid=request.getParameter(\"fileid\");  String filetype=request.getParameter(\"filetype\");  String filename=request.getParameter(\"filename\");  String filetypeclass=request.getParameter(\"filetypeclass\");  String outstr=\"\";  byte[] tByte=info.getfile(fileid);  if (filetype.equals(\"text/plain\"))  {    outstr=new String(tByte);    outstr=edoas.EdoasKit.replaceAll(outstr,\"\\r\\n\",\"<br>\");\tout.println(outstr);    }  else  {\tif (filetypeclass.equals(\"1\"))//判断如果是IE识别的文件类型则直接显示\t{      response.setContentType(filetype);\t  ServletOutputStream out1=response.getOutputStream();      out1.write(tByte);      out1.close();\t}\telse//判断如果不是IE识别的文件类型则下载\t{//  \t  String filename=new String(Things.getfilename(fileid).getBytes(),\"ISO-8859-1\");      response.setContentType(filetype);\t  response.setHeader(\"Content-disposition\",\"attachment; filename=\"+filename);\t  ServletOutputStream out1=response.getOutputStream();      out1.write(tByte);      out1.close();\t}  }%>\nfileid没有过滤直接带入查询判断文件是否下载文件。谷歌搜索：inurl:edoas2\n\n还是有蛮多的把.   漏洞证明：  \n\n通过谷歌来搜索这样方便点，不然找得麻烦。举例：http://edoas.ahut.edu.cn/edoas2/include/upload/showaccessory?fileid=1261969826085118\n\n\n\n\n\n   修复方案：  过滤哦。   版权声明：转载请注明来源 xlz0iza1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-05-16 19:19 厂商回复： CNVD确认并复现所述情况，转由CNCERT向教育网信息中心协调处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-13 15:45 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  ……    \n     2014-05-13 15:49 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  首页好。    \n     2014-05-13 16:36 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  首页好！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}