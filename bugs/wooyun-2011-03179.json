{"id": 21836, "wybug_id": "wooyun-2011-03179", "wybug_title": "创新工厂安全宝安全防护绕过漏洞", "wybug_corp": "安全宝", "wybug_author": "rayh4c", "wybug_date": "2011-11-01 15:38", "wybug_open_date": "2011-12-01 15:38", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全策略绕过", "安全限制绕过", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-11-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-11-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-11-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-11-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-12-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-12-01：\t细节向公众公开  简要描述： 安全宝本质是CND加DDOS防护加web安全防护,其web安全防护功能存在漏洞，可以轻易绕过。 详细说明：  web安全防护就想到于一个WAF，但是WEB应用过于复杂，很容易就能绕过，如安全宝无法防护80SEC所发现的几种攻击方法：参考http://www.80sec.com/浅谈绕过waf的数种方法.html   漏洞证明：  如下面安全保护的网站www.51qljr.com，如果拦截到SQL注入攻击是405状态，用下面的包发送SQL注入攻击将绕过安全保护。GET /xinxi/shownews.asp HTTP/1.1Accept: */*Accept-Language: zh-cnUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.1; Trident/4.0; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET4.0C)Accept-Encoding: gzip, deflateProxy-Connection: Keep-AliveHost: www.51qljr.comPragma: no-cacheContent-Length: 21Content-Type: application/x-www-form-urlencodedid=572' and 1=1--   修复方案：  web应用太复杂，还有各种复杂场景可以绕过类似的安全防护。   版权声明：转载请注明来源 rayh4c@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2011-11-01 20:30 厂商回复： 今天下午，rayh4c@乌云指出安全宝存在安全隐患，安全宝团队已经分析完毕，在此表示衷心的感谢。 此隐患会使得攻击者绕过安全宝部分的检查，但不会降低用户自身原有的安全性，随后我们将公布完整的分析报告。 如同在过去20年，病毒技术的研究者极大地推动了反病毒技术的发展，网络漏洞的研究者们也实实在在地为信息安全技术的发展做出了卓越的贡献。安全宝团队感谢80Sec和乌云等众多优秀的网络安全研究者提出的安全建议，并期望和大家一起共同提升中国互联网的安全。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-11-01 17:24 |    \t\timiyoo2010 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 神马都是浮云)\t\t \n  您好,首先我代表安全宝团队全体成员向您表示感谢,我们技术部门正在极积查明情况,谢谢您的支持和关注.    \n     2011-11-01 17:34 |    \t\tRay \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:7        )\t\t \n  http://www.51qljr.com/ggxl/list.asp?news_id=329%20and%20%281%29=%281%29    \n     2011-11-01 17:51 |    \t\t安全宝(乌云厂商)\t\t \n  今天下午，rayh4c@乌云指出安全宝存在安全隐患，安全宝团队已经分析完毕，在此表示衷心的感谢。 此隐患会使得攻击者绕过安全宝部分的检查，但不会降低用户自身原有的安全性，随后我们将公布完整的分析报告。如同在过去20年，病毒技术的研究者极大地推动了反病毒技术的发展，网络漏洞的研究者们也实实在在地为信息安全技术的发展做出了卓越的贡献。安全宝团队感谢80Sec和乌云等众多优秀的网络安全研究者提出的安全建议，并期望和大家一起共同提升中国互联网的安全。    \n     2011-11-01 19:46 |    \t\t7INMoKu \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | [ChenMoKu])\t\t \n  这个……    \n     2011-11-01 21:03 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  居然只有5 RANK，白费我发那么详细的东西了，安全基础性的东西居然只值5分，寒心了。    \n     2011-11-01 21:04 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  =。= 永远的5分 你懂得    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}