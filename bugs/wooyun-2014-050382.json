{"id": 6094, "wybug_id": "wooyun-2014-050382", "wybug_title": "支付宝的一些潜在安全风险（社会工程学角度分析及证明）", "wybug_corp": "支付宝", "wybug_author": "路人甲", "wybug_date": "2014-02-07 17:53", "wybug_open_date": "2014-02-12 10:49", "wybug_type": "成功的入侵事件", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 支付宝的一些潜在安全风险（社会工程学角度分析及证明） 详细说明：  从社会工程学角度研究新时期的个人网络安全问题                 —————以丢失手机后破解失主支付宝账户安全为例昌吉学院·冯翔2014-2-6一、前言     在智能手机的普及和3G网络的飞速发展的今天，越来越多的移动应用在丰富着我们的移动生活，这些应用的安全问题越来越受到人们的关注，其中理财支付类的应用由于其与经济利益息息相关二最受关注，支付宝则是该领域的领头羊，据易观国际发布的《2012年中国第三方互联网支付市场交易额份额》显示，支付宝交易份额为46.6%高居榜首，所以说，支付宝账户资金的安全影响到中国大部分网民的资金安全。      尽管在技术上的升级换代使支付宝账户日益安全，但是我们从社会工程学的角度可以发现漏洞仍然存在，下面我们就以“一个普通网民的手机丢失后如何破解其支付宝账户”为例，演示这一漏洞，并给予解决方案。二、情景设计：丢失者：一名普通的网民，它使用的手机是安卓系统的智能手机，ta在使用的移动APP有QQ、微信、微博、淘宝（关联支付宝），使用的是中国联通的3G网络，平时网购主要通过淘宝进行，开通了快捷支付及余额宝，但手机设有手势密码。破解者：  一名捡拾到其手机的别有用心者（其有着丰富的社会工程学经验）。三、步骤演示1.取出丢失者的SIM卡，插进自己的手机，发送短信MMCZ#123450到10010将密码重置为123450.（如图1）\n\n2.拨打电话到另外一部手机，得知这手机号码。3.使用手机登陆mob.10010.com，点击“业务查询-我的信息”，可以看到机主身份证的前四位和后四位。（通过前四位我们判断ta应该是个本地人），所以我们实际上知道了ta身份证号码的前六位和后四位。（如图2）\n\n4.破解ta的微博账号，并且将ta的手机存入另一部手机的通讯录，登陆一个QQ号，点通讯录查询到ta的QQ号，并且查看ta的微博及QQ（含空间）资料，判断其具体生日是某年某月某日。5.这样我们可以得知ta的具体的身份证号码。6.挂上一个位于美国的VPN，登陆支付宝，点击找回密码，我们通过刚才获取的信息，成功修改其登陆密码。（如图）\n\n\n\n\n\n7.试图用“支付宝钱包”破解其支付密码，遇到密保问题，发现这个问题是“我父亲的名字”。通过查看其电话本查询到其父亲的电话，但是姓名是“老爹”，然后我通过交话费的方式，查到他父亲的名字，然后成功修改支付密码。（如图）\n\n\n\n\n\n8.将其资金通过洗钱的方式（如比特币）迅速转移，销毁一切作案工具。四、防范策略  Ⅰ、支付宝方面1.       应用更人性化和在逻辑上更安全的安全策略，如：设置急用密保手机，这个手机号可以是其朋友或家人的，只有一个功能，就是发送短信“锁定”到95188，可以迅速锁定支付宝账户，并且在24小时内无法使用支付宝的任何功能。2.       使用其他依赖的密保方式，减少对手机短信的依赖。Ⅱ、运营商方面1.       通过更人性化的方式防止手机在丢失后卡号别恶意利用。（如与手机绑定的方式）2.       严格保护用户的资料和隐私。Ⅲ、用户方面1.       学会使用PIN码。2.       尽量避免将个人真实资料发到较为公开的社交网络上。3.       手机丢失后及时联系客服要求冻结（或锁定）账户。4.       及时去补卡5.       密保问题要尽量“仅自己知道”，如，密保问题为：“我父亲的名字是？”答案：不应该是：“张三”，而应该是“张san”。6.       尽量不要“越狱”、“ROOT”或“打开USB调试”。7.       不要使用来源不明的应用，不应给应用过多的权限（如读取信息记录、读取通话记录和读取手机位置等）。五、反思总结在新的时期，有两个趋势：1.应用移动化愈来愈强。 2.应用账户的安全的愈来愈重要。我们应该更加重视用户账户的安全，不仅是理财支付账户的安全、还应该有社交账户的及其他账户，云时代的来临，用户将有更多的信息会保存在云端，但是加密算法的进步和用户步骤简约的要求，我们该如何保证用户账户的安全呢？这是个问题，我们要共同努力！                                       联系方式：share1995@outlook.com                                            新疆昌吉市昌吉学院·中文系 冯翔                                                  2014年2月7日0:05:09   漏洞证明：  http://pan.baidu.com/s/1qW11Fek   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-02-12 10:49 厂商回复： 感谢您对支付宝安全的关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-02-08 09:42 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  漏洞类型：\t 成功的入侵事件 ！！！！    \n     2014-02-09 17:13 |    \t\t小杨 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:4        | 。)\t\t \n  还有这样的？    \n     2014-02-12 15:45 |    \t\tjeary \t\t\t( 普通白帽子  |\t\t\t        Rank:296 漏洞数:106        | (:‮.kcaH eb nac gnihtynA))\t\t \n  漏洞不一定要体现于技术。    \n     2014-02-12 16:00 |    \t\t乌云最帅的淫 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:23        | 不以淫荡惊天下,就以闷骚动世人)\t\t \n  咳咳... 如果小偷都变黑牛 ..那世界都黑暗了    \n     2014-02-12 17:53 |    \t\thacker@sina.cn \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:27        | ANONYMOUS)\t\t \n  干净有力， 这才是社工。 抵制意淫党    \n     2014-02-12 19:14 |    \t\t汤包998 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:12        | 木有)\t\t \n  手机掉了，第一件事就是去办张新卡。    \n     2014-02-12 20:43 |    \t\tziwen \t\t\t( 实习白帽子  |\t\t\t        Rank:49 漏洞数:4        | 活着为了乐还是为了苦？)\t\t \n  改革起来很难 毕竟现在太依懒手机短信了    \n     2014-02-14 22:45 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  @jeary 是的    \n     2014-02-18 22:52 |    \t\twebshell \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:18        | 没有伞的孩子必须努力奔跑。)\t\t \n  或许厂商真的不太重视手机安全，我可以这么说吧，支付宝给手机的权限实在太大了。应该加以限制，而不是继续扩大手机的安全性，如果继续这样的话，必定会损失惨重。希望支付宝继续加强网络安全和移动网络安全。加油！    \n     2014-02-22 17:46 |    \t\t脚本菜菜 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | 我只是混个邀请码。)\t\t \n  捡到到手机的几率 在加上手机上安装快捷支付-   这得多巧啊    \n     2014-02-24 16:09 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  如果能解决在安卓手机里破解手机卡问题 此漏洞才算漏洞  不过去年双11 此问题让我砰然心动 12月 被爆有人手机突然掉下 异地补卡网上银行被劫  当然利用的不是我们的这个快捷支付问题这个和老婆抢工资本里德钱 是利器奥  别人我不告诉他    \n     2014-03-20 11:30 |    \t\t网维 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 为您提供优质服务！)\t\t \n  小偷也这么有文化 太可怕了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}