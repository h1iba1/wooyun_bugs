{"id": 25212, "wybug_id": "wooyun-2015-0132386", "wybug_title": "奥鹏教育某分站后台弱口令&amp;SQL注入", "wybug_corp": "open.com.cn", "wybug_author": "暴走", "wybug_date": "2015-08-07 16:50", "wybug_open_date": "2015-09-21 17:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "后台弱口令"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向公众公开  简要描述： 后台弱口令&SQL注入 详细说明：  详细说明见漏洞证明。   漏洞证明：  问题1：奥鹏网络学习云平台后台登录存在弱口令(admin/888888)，后台登录界面如下：\n\n使用admin/888888帐户登录后台，后台功能包括：组织结构管理、基础数据管理、招生管理、教务管理、学籍管理、学务管理、考务管理7大功能（看起来很强大哦）\n\n每个大项功能又包含比较多的子功能，经过一番查看，好像很多数据都未录入，但是感觉系统蛮重要的。以“学务管理”为例，该功能包含：设置选课方式、学生选课管理、集体选课等功能。（拥有管理员权限可以做任何操作哦，不过我就看了看）\n\n可以“免修免考”（让你可以不用考试，嘿嘿）\n\n其他功能就不一一列举了，功能很丰富。问题2：简单测试了一下，发现存POST型SQL注入（注入点为courseName参数）POST数据如下：\nPOST /WebApi/edus/base/Course_GetDataGrid?token={%22UserID%22:%228371cea6-945a-43ca-b996-8ef53b0f0293%22,%22OrganizationID%22:%22038699a3-17dc-4d48-aa5a-7aaf681fe811%22,%22OrgType%22:3,%22OrgImage%22:null,%22ServiceOrgID%22:%2200000000-0000-0000-0000-000000000000%22,%22DataOrgID%22:%22038699a3-17dc-4d48-aa5a-7aaf681fe811%22} HTTP/1.1Host: edus.open.com.cnProxy-Connection: keep-aliveContent-Length: 46Accept: application/json, text/javascript, */*; q=0.01Origin: http://edus.open.com.cnX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.132 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://edus.open.com.cn/Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: b_t_s=t238655849967x; b_t_s_100200=f58fcd5f-b60f-4646-b9e8-ae20323d7df1; up_first_date=2015-08-04; up_beacon_id_100200=f58fcd5f-b60f-4646-b9e8-ae20323d7df1-1438655850891; b_t_s_100100=f77a5bfa-976f-4a62-9f1e-51c6079b2873; up_beacon_id_100100=f77a5bfa-976f-4a62-9f1e-51c6079b2873-1438656292175; __CT_Data=gpv=4&apv_52710_www=4; WRUID=0; b_t_s_100201=624ff061-3c08-4864-91aa-1c9b54986608; up_beacon_id_100201=624ff061-3c08-4864-91aa-1c9b54986608-1438656384677; b_t_s_100102=61155c61-46b2-457a-8d26-532dd1d1d259; up_beacon_user_id_100201=eduadmin; up_page_stime_100201=1438827948471; up_beacon_vist_count_100201=21; up_page_stime_100103=1438842467811; up_beacon_vist_count_100103=1; b_t_s_100103=8e366208-e9ed-473c-89e8-a0a3918f7afa; up_beacon_id_100103=8e366208-e9ed-473c-89e8-a0a3918f7afa-1438842467819; up_page_stime_100200=1438852497632; up_beacon_vist_count_100200=6; __utma=238318431.811077368.1438657123.1438825517.1438852500.3; __utmc=238318431; __utmz=238318431.1438852500.3.3.utmcsr=bj.open.com.cn|utmccn=(referral)|utmcmd=referral|utmcct=/; Hm_lvt_e208d74b7fc93539fb0706a17abb4f67=1438852508; Hm_lpvt_e208d74b7fc93539fb0706a17abb4f67=1438852508; up_page_stime_100100=1438852507842; up_beacon_vist_count_100100=5; up_page_stime_100202=1438911384462; up_beacon_vist_count_100202=1; b_t_s_100202=63922bf9-d1fe-4e6b-80f4-cb6b39bf618f; up_beacon_id_100202=63922bf9-d1fe-4e6b-80f4-cb6b39bf618f-1438911384468; ASP.NET_SessionId=ujy2dp2fbe2iuumdqfaf2xdmcourseName=&courseCode=&status=&page=1&rows=10\n直接用SQLMAP测试如下（网速慢就稍微跑了一下，我们不脱库，证明漏洞存在即可）：操作系统为Windows 2008系统，使用的数据库是SQL Server 2008\n\n包含8个数据库\n\nmqdel数据库表：\n\nQ表的的结构：\n\nOK，漏洞证明到此结束。   修复方案：  你们是行家里手。   版权声明：转载请注明来源 暴走@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-08-07 17:34 厂商回复： 新上的项目，我们会联系研发进行处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}