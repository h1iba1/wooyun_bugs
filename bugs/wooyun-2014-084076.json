{"id": 46631, "wybug_id": "wooyun-2014-084076", "wybug_title": "新开普一卡通免费消费且系统无纪录续集（一卡通支付漏洞）", "wybug_corp": "新开普电子股份有限公司", "wybug_author": "绝对领域", "wybug_date": "2014-11-21 11:10", "wybug_open_date": "2015-02-19 11:12", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-19：\t细节向公众公开  简要描述： 轻松实现新开普一卡通免费消费且系统无纪录（WooYun-2014-83322 ）的问题厂商处理之后异常消费的卡会被暂时冻结，但是。。。新的问题来了，我还是可以愉快的购物只需要花1/n的money  详细说明：  1、系统检测到两次异常消费下发黑名单冻结卡需要时间，在这个时间内我可以重复消费>3次2、厂商对上次提交的问题进行修复，已经用冻结消费来防止类似消费行为，但是去解冻处理后并没有对账目进行纠正。3、也就是说用复制的一卡通在pos机上大额费，然后用自己的一卡通小额消费，卡会被冻结，用自己的一卡通去解冻后系统未对卡上消费金额进行纠正，用户实际花了200大洋买了东西，但是卡上和系统里实际只扣了0.01大洋。 我又可以快乐的购物了，虽然要多跑下路。   漏洞证明：  \n\n克隆卡余额\n\n克隆卡大金额消费\n\n原始卡余额\n\n原始卡小额消费\n\n过一会后卡被冻结大概2分钟左右，在这期间我还可以用更多的克隆卡消费\n\n解冻去\n\n钱又回来了。。。。   修复方案：  \n\n既然你以经把消费都入库了。。。你就把卡上的金额和库里的同步下啊，还有你上面那么多灰帐，这种用户去解冻的时候敢不敢给操作员一个大大的警告。。。。   版权声明：转载请注明来源 绝对领域@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-11-24 17:04 厂商回复： 非常感谢从独特的视角给出问题的分析解决办法。我们将尽快安排解决。初步分析需要几个特定条件才能完成此类操作。是管理 人员用有解冻的管理权限，且非常熟悉系统的业务流程。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-21 11:11 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这个有意思，射频卡支付漏洞    \n     2014-11-21 11:27 |    \t\tsix-door \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:31        )\t\t \n  这个有意思，射频卡支付漏洞     \n     2014-11-21 12:05 |    \t\t只发通用型 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:14        | 刷通用型奖金小号)\t\t \n  @疯狗 连载都不给打雷能忍？    \n     2014-11-21 12:34 |    \t\t绝对领域 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:3        | 大穴码农网管)\t\t \n  @只发通用型 我是来拿通用的。。。这两个洞覆盖全国n多高校啊    \n     2014-11-21 22:48 |    \t\tdangge \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 菜鸟一枚 努力学习中。)\t\t \n  我说为何我校最近卡机全部维护。。。。    \n     2014-11-24 18:31 |    \t\t绝对领域 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:3        | 大穴码农网管)\t\t \n  @dangge 他是在告诉你好好吃饭，少吃零食少抽烟，认真撸代码    \n     2014-11-24 23:23 |    \t\tAnonymous \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:30        | 园长是大傻逼)\t\t \n  混个脸熟 基友可加Q 5737796    \n     2014-12-17 10:21 |    \t\tCplusHua \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:33        | 乌云奖金:-1)\t\t \n  @绝对领域 这个哈，我跟你说，你要是去对账会被纠正的，是按照你的消费进行纠正的；另外你要是做一张大额卡，比如65535，然后去消费，你发现系统里的余额也是6553x，但是消费记录记录了下来，数据库里的余额是读取卡里的并入库的；不准确。    \n     2014-12-19 10:15 |    \t\t绝对领域 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:3        | 大穴码农网管)\t\t \n  @CplusHua 不是。。。会纠正我就不再这里提出了，现在完全不懂他的处理方式，至少我这里不是完全按卡来的    \n     2014-12-23 12:46 |    \t\t绝对领域 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:3        | 大穴码农网管)\t\t \n  @疯狗 @xsser 这个洞也木有奖励么-，-！    \n     2015-02-19 15:29 |    \t\t娃哈哈 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:6        | 伟大的科学家)\t\t \n  好厉害    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}