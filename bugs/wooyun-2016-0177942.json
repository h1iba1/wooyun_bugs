{"id": 87133, "wybug_id": "wooyun-2016-0177942", "wybug_title": "致远A8协同系统存在任意用户密码修改漏洞（秒改）", "wybug_corp": "seeyon.com", "wybug_author": "路人甲", "wybug_date": "2016-02-23 13:17", "wybug_open_date": "2016-05-26 16:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-02-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-29：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-04-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-26：\t细节向公众公开  简要描述： 不仅仅修改密码，还可以禁用、删除、添加用户上传下载文件等等 详细说明：  协同系统的一些接口如下：\n\n\n\n1.2 验证服务服务名称：authorityServiceWSDL：http://{host}:{port}/seeyon/services/authorityService?wsdl1.2.1 登录验证**.**.**.** 身份验证令牌实体（UserToken）**.**.**.** 身份验证使用用户名和密码进行身份验证。用户名不能更改，必须使用\n\nmask 区域\n*****ce-*****\n\n，缺省密码为\n\nmask 区域\n*****45*****\n\n，可以通过修改A8Config系统参数配置的a8.plugin.webservice.password值修改密码。为了设置方便，缺省情况下密码使用明文保存，如果为了安全，可以将a8.plugin.webservice.password.encode设置为1，在a8.plugin.webservice.password保存密码的MD5值。有了token后可以干很多的事情可以删除、添加用户，可以禁用用户，还可以下载上传文件等等上面接口的操作都需要token可以参考文档\n\nmask 区域\n1.http://**.**.**/a/2015/09-09/946261.html\n\n这里以修改密码为例修改密码有两种方法一种是根据ID 一种是根据用户名由于ID不知道 所以测试的时候都是根据用户名   漏洞证明：  http://**.**.**.**/seeyon/services/authorityService?wsdl获取token\n\n访问http://**.**.**.**//seeyon/getAjaxDataServlet?S=ajaxOrgManager&M=isOldPasswordCorrect&CL=true&RVT=XML&P_1_String=zw&P_2_String=wooyun返回false 说明zw密码不正确\n\n修改密码\n\n\n\n新密码修改成功58到家http://**.**.**.**/seeyon/index.jsp以 audit-admin 为例\n\n\n\n登录提示 \n\n换一个密码登录提示\n\n说明密码修改成功为了严谨 再修改一个anhanhan  密码修改为wooyun\n\n\n\n登录成功\n\n-------下面就不再修改密码了  只获取tokenhttp://**.**.**.**/seeyon/services/authorityService?wsdl\n\n官网好像有毒，密码修改不了，用户封禁了但是解不了。。-----------http://**.**.**.**/bugs/wooyun-2010-0166129http://**.**.**.**//seeyon/services/authorityService?wsdl\n\n....案例乌云上都不少\n\n\n\n水平有限，上传就不测试了   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-02-26 16:07 厂商回复： 非常感谢，问题非常严重，正在修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-05-01 18:10 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1712 漏洞数:261        | 以大多数人的努力程度之低，根本轮不到去拼...)\t\t \n  大兄弟，私信我下...  有个马赛克的地方不懂。    \n     2016-05-01 18:18 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1712 漏洞数:261        | 以大多数人的努力程度之低，根本轮不到去拼...)\t\t \n  用户名不能更改，必须使用mask 区域*****ce-*****，缺省密码为mask 区域*****45*****这马赛克打的...    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}