{"id": 5937, "wybug_id": "wooyun-2013-043664", "wybug_title": "siteserver最新版3.6.4 sql inject 第七蛋", "wybug_corp": "百容千域软件技术开发有限责任公司", "wybug_author": "小新", "wybug_date": "2013-11-21 23:09", "wybug_open_date": "2014-02-19 23:10", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["代码审计", "注射", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-19：\t细节向公众公开  简要描述： siteserver 最新版3.6.4 存在注入， 第七个注入 详细说明：  第七个注入存在/UserCenter/cms/contents.aspx用.NET Reflector 反编译UserCenter.Pages.dll这个文件查看代码如下：\nint totalCount;    bool flag;    string keyword = this.Keyword.Text.Trim();    if ((((uint) totalCount) - ((uint) flag)) <= uint.MaxValue)    {        string start = this.start.Value;        if (0 != 0)        {            return;        }        string end = this.end.Value;        if ((((uint) flag) - ((uint) flag)) <= uint.MaxValue)        {            base.SetPublishmentSystemID(TranslateUtils.ToInt(this.ddlPublishmentSystemID.SelectedValue));            this.spContents.ControlToPaginate = this.dlContents;            this.dlContents.ItemDataBound += new RepeaterItemEventHandler(this.x140df91522580d1f);            this.spContents.ItemsPerPage = 30;            this.spContents.ConnectionString = BaiRongDataProvider.ConnectionString;            this.spContents.SelectCommand = DataProvider.ContentDAO.GetSelectCommendOfTouGao(base.PublishmentSystemInfo.AuxiliaryTableForContent, base.PublishmentSystemID, start, end, keyword, base.UserName, this.touGaoType);        }        this.spContents.SortField = \"ID\";\n关注keyword\npublic string GetSelectCommendOfTouGao(string tableName, int publishmentSystemID, string start, string end, string keyword, string userName, ETouGaoType touGaoType){....   builder.AppendFormat(\"AND (Title LIKE '%{0}%' OR Content LIKE '%{0}%')\", keyword);\n很明显的注入   漏洞证明：  因为这次是post类型，server会对viewstate进行check，所以需要注册一个会员，登录后访问\nhttp://www.target.com/UserCenter/cms/contents.aspx?PublishmentSystemID=1\n在关键字处填写\n' and @@version=1 and 1='\n\n\n\n\n   修复方案：  对keyword进行过滤   版权声明：转载请注明来源 小新@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2013-11-24 19:49 厂商回复： 周末刚上来看见，回头让产品部门测试，若确实存在，我们立马修复，谢谢小哥最近的工作，辛苦了！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-22 10:51 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  能不能来一次完整的 - -     \n     2013-11-22 19:56 |    \t\t小新 \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:19        | 我可是要成为普通白帽子的小新)\t\t \n  @xsser as you with, my load    \n     2013-11-24 10:10 |    \t\t麻花藤 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | ด้้้้้็็็็็้้้้้็็็็...)\t\t \n  X！(此评论虽仅有一个字，却深刻的表达了回复人深深的祝福和刻骨的情感。可为是言简意深。一字千金。字字扣人心旋，捶人泪下。足以见得作者扎实的文字功底和信手拈来的写作技巧。及惨绝人圜的创新能力。此回复在加一感叹号收尾。点睛之笔。秒笔生花、意境深远、照应前文、升华主题。把作者的情感表达的淋漓尽致。给人无限感动与惆怅，有浑然天成之感。此乃评论中极品，回复中绝笔。)    \n     2013-11-24 23:52 |    \t\t小新 \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:19        | 我可是要成为普通白帽子的小新)\t\t \n  @百容千域软件技术开发有限责任公司  rank 敢给高一点不    \n     2013-11-25 19:03 |    \t\t百容千域软件技术开发有限责任公司(乌云厂商)\t\t \n  哥哥，你要说啊，你不说我怎么知道呢，呵呵，确实没注意这方面，不好意思啊，小新同学，回头给你补钙!    \n     2013-11-25 20:46 |    \t\t小新 \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:19        | 我可是要成为普通白帽子的小新)\t\t \n  @百容千域软件技术开发有限责任公司 还会有的，请给高一点  ：）    \n     2013-11-30 15:29 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  我去，新版加了什么模块吗那么多注入    \n     2015-05-29 03:38 |    \t\t地瓜 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:7        | hacked by Finger)\t\t \n  这个还是找不到利用点。。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}