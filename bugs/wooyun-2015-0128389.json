{"id": 46694, "wybug_id": "wooyun-2015-0128389", "wybug_title": "永诚财产保险逻辑缺陷多种方法重置任意用户密码(admin用户测试/秒改)", "wybug_corp": "永诚财产保险股份有限公司", "wybug_author": "千斤拨四两", "wybug_date": "2015-07-22 16:05", "wybug_open_date": "2015-09-06 10:46", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "安全意识不足", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向公众公开  简要描述： 若是忽略了求补rank！ 详细说明：  0x1:直接用admin用户测试，之前admin用户是没有绑定任何邮箱和手机号，第一次测试时修了响应包，可跳到第二步选择验证的方法，现在再次复现重置密码的过程就不会再显示账户未激活。\n\n到了第二步选择重置密码的途径，先用邮箱测试。选择邮箱截断响应包，可以看到发送邮箱的地址，把邮箱改为自己的邮箱接受修改密码的连接。\n\n\n\n再下一步发送至邮箱，在此也可截断修改接受连接的地址。\n\n图证明接受到验证码的连接邮箱。\n\n点开连接修改密码为wooyun123.   漏洞证明：  0x2:第二种方法是用手机号接受验证码，看方法可轻松得到验证码。\n\n点击获取验证码，在响应包中可得到验证码。\n\n同样也可以利用1种的方法，修改接受验证码的手机号码。0x3：登录证明\n\n   修复方案：  完善服务端验证，禁止验证码返回本地。过忽略求补rank，过程写的很详细，不容易啊。。。   版权声明：转载请注明来源 千斤拨四两@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-07-23 10:45 厂商回复： 感谢您对我司系统的关注以及发现我司系统安全漏洞，我司正在积极整改，请留下具体联系方式，后续将赠送相应小礼物，谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}