{"id": 84672, "wybug_id": "wooyun-2015-0143745", "wybug_title": " Dswjcms! X1.3 sql注入#4", "wybug_corp": "dswjcms.com", "wybug_author": "不能忍", "wybug_date": "2015-10-07 09:46", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述：  详细说明：  /Lib/Action/Home/SiteAction.class.php\npublic function article($id=0){\t\t  //标题、关键字、描述\t\t$Site = D(\"Site\");\t\t$mod = D(\"Article\");\t\t$si=$mod->field('keyword,remark,title,catid')->where('id='.$id)->find();//mark\t\t$sb=$Site->field('title,link')->where('id='.$si['catid'])->find();\t\t$sin['title']=','.$si['title'];\t\t$this->assign('so',$sin);\t\t$si['title']=$si['title'].\"-\".$sb['title'];\t\t$si['link']=$sb['link']?$sb['link']:1;\t\t$si[$si['link']]='active';\t\t$this->assign('si',$si);\t\t$active[$si['link']]='active';\t\t$this->assign('active',$active);\t\t\t\t\t\t  //左边\t\t $site=$Site->field('title,link,id,type')->where('type>1 and status=1')->select();\t\t $this->assign('site',$site);\t\t if(!$id){\t\t\t $this->error(\"请先选择栏目\");\t\t }\t         if(!$id){\t\t\t $this->error(\"请先选择文章\");\t\t }\t\t \t\t $list = $mod->where(\"id=\".$id)->relation(\"site\")->find();\t\t $this->assign('list',$list);\t\t $artic=$Site->field('title,id')->where('id='.$list['catid'])->find();\t\t $this->assign('artic',$artic);\t\t $this->display($list['content_tpl']);\t  }\t        //封面\t  \t  public function page($id=0){\t\t  //标题、关键字、描述\t\t$Site = D(\"Site\");\t\t$si=$Site->field('keyword,remark,title,link')->where('id='.$id)->find();//mark\t\tif(!$si['link']){\t\t\t$si['link']=1;\t\t}\t\t$this->assign('si',$si);\t\t$active[$si['link']]='active';\t\t$this->assign('active',$active);\t\t$si['title']=','.$si['title'];\t\t$this->assign('so',$si);\t\t //左边\t\t $Site = D(\"Site\");\t\t $site=$Site->field('title,id,type')->where('type>1 and status=1')->select();\t\t $this->assign('site',$site);\t\t $artic=$Site->field('title')->where('id='.$id)->find();//mark\t\t $this->assign('artic',$artic);\t\t if(!$id){\t\t\t $this->error(\"请先选择栏目\");\t\t }\t\t\t $mod = D(\"Site\");\t\t $list = $mod->where(\"id=\".$id)->relation(\"site_add\")->find();\t\t $this->assign('list',$list);\t\t//$this->display($list['page_tpl']);\t\t$this->display($list['content_tpl']);\t  }\t  \t  //列表\t  public function listTpl($id=0){\t\t//标题、关键字、描述\t\t$Site = D(\"Site\");\t\t$si=$Site->field('keyword,remark,title,link')->where('id='.$id)->find();//mark\t\tif(!$si['link']){\t\t\t$si['link']=1;\t\t}\t\t$this->assign('si',$si);\t\t$active[$si['link']]='active';\t\t$this->assign('active',$active);\t\t  //左边\t\t $Site = D(\"Site\");\t\t $site=$Site->field('title,id,type')->where('type>1 and status=1')->select();\t\t $this->assign('site',$site);\t\t $artic=$Site->field('title')->where('id='.$id)->find();//mark\t\t $this->assign('artic',$artic);\t\t if(!$id){\t\t\t $this->error(\"请先选择栏目\");\t\t }\t\t$mod = D(\"Article\");\t\t$list = $mod->where(\"catid=\".$id)->relation(\"site\")->select();\t\t $this->assign('list',$list);\t\t $this->display(\"list\");\t  }\n一共有5个地方是进库的   漏洞证明：  \n\n因为执行了两次，所以是12秒   修复方案：  过滤   版权声明：转载请注明来源 不能忍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-10-08 08:27 厂商回复： 此类问题已经处理，已在官方论坛贴出修复办法，并在新版本中已测试无法执行，感谢楼主的宝贵意见 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}