{"id": 32052, "wybug_id": "wooyun-2015-0112395", "wybug_title": "TOM邮箱某接口设计不当可撞库邮箱（大量成功账号证明）", "wybug_corp": "TOM在线", "wybug_author": "路人甲", "wybug_date": "2015-05-07 11:30", "wybug_open_date": "2015-05-12 11:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "14", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 挖洞最苦逼的事莫过于编辑了半天的漏洞最后发现竟然不存在。。 详细说明：  http://web.mail.tom.com/webmail/login/index.action?from_domain=web.mail.tom.com无意间发现的这个接口，看到了登陆的地方没有限制，有点震惊，觉得不太可能吧，以为要有限制或者说登陆错误一定次数才有限制的，结果测试过后是没有限制的\n\n然后抓包查看一下发现用户名和密码竟然也都是明文传输的。。\n\n这里撞库必须是用户名，手上没有高效率的用户名字典，再去收集的话肯定不少浪费时间，然后我这里临时写了个小脚本（每次都用PHP写脚本也是够苦逼。。）用的QQ邮箱的字典来分割了一下做成了用户名字典\n<?php Header( \"Content-type:   application/octet-stream \"); Header( \"Accept-Ranges:   bytes \"); header( \"Content-Disposition:   attachment;   filename=test.txt \"); header( \"Expires:   0 \"); header( \"Cache-Control:   must-revalidate,   post-check=0,   pre-check=0 \"); header( \"Pragma:   public \"); $a=file(\"E:\\zkmail1.txt\");foreach($a as $b){\t$c=explode('@',$b);\techo $c[0];\techo \"\\r\\n\";}?>\n\n\n因为没有去收集用户名字典，所以撞库成功率比较低，但仍然出来了不少用户，而且邮箱撞库的危害绝对不容忽视\n\n随便选几个登陆一下看看吧：\n\n\n\n\n\n   漏洞证明：  rs，部分账号证明：\nsadf\t123456\t539sqyhj\t5377550\t540gzwh\t100471\t540fgdfg\t111111\t540zlkkk\t7274518\t540anjei\tnnzmhww\t541bl0775\t982005\t541xtidr\t123456\t541x_zero\t4194304\t541xlgzs\t19870509\t541wu88yu\t9327187\t541ukiss\t931930\t541wjl349\t31507022\t542xrcui\txiaolingtong\t542werwrw\t111111\t542wyg1258\tw5722u\t54212313\t123123\t542richky\t8898975\t542snwcwt\t1980222\t542zafira\t123456\t542couldme\t2002314\t543ldsldsaq\t730102\t543easycyan\t112849\t543ayy0617\t926322\t54356565656\t123456\t543zzt2003\tbnmmnb2003\t543sunyan1\t123456789\t543andykee\t821014\t543zhxccc\tzhxvvv\t543bill_koa\t830111\t544tyyk1984\t578284\t544ynsimple\tsimple\t544weihc123\taijielun21\t544123456q\t123456\t544liveskg\twayne0723\t544wangji8\t123456\t544qinyudong\tqyd1984\t544sun198757\t198757\t544songtao23\t123456\t545bambooeer\t9b9s9dmg\t545westlorn\t123156\t545sandwitsh\t61214891\t545zhouyin23\tzhouyin23\t545huangzs20\t64389914\t545weishuia\t7758521\t545www.17173\t123456789\t545xiangya123\txiangya\t545muzhenning\t253176466\t545zhangji25\t3242510543\t545lzs_jeff\tlzsjeff\t545sandannis\twangsen\t546blood_0726\tlovehot\t546tanjunshow\ttanjundiao\t546raulhanlei\traul1984801\t546waq13218600\t364667331\t547yingzhouliu\t12011089\t547wanghu1689\t8523297\t547zhaoleiwj766\tnbv7a52c\t547zml19881116\tfkcqdxv\t547baccahatis\t4inlove\t547guixiang1988\t6273513\t548huanglili812\t1985812\t548liying850105\t850105\t548charliebrown218\t19910218\t551ejjg\t19651116\t557js34\t2250866\t557djmcy\t87315800\t558ydcz\t13095302\t55812456\t123456\t559sp3478\t16947410\t559shtuy\t515237\t559djmcy\t87315800\t559dulton\t811024\t559lusiye\thnlnjfc\t560xuey45\t1035041145\t560jiaoex\tex468257913\t560wli419\t810419\t560flazh\tzhhzhh714\t560szguoke\t790725\t560swplh\t5521220\t560let5see\txuyuanjian\t561cqsazx\t1998424\t561ralf1989\t123578963\t561yfj8168\t20162016\t561ybkgvk\tkgdufhvk\t561hehe_hh\tqlh19880620\t561spbsqlq\t12342234\t561chenw502\t19860817\t562kangnan39\tkangnan\t562lx353400\tlx353400\t562staridea\tliuqing\t562handpiano\tlike83823\t562gavyfish\t111111\t562yaqi-1984\t1271125711\t562hananning\t8876611\t562shoukong3\t82199172\t562oiuy4503\tyujiahong123\t562flyxiyue\twoaini\t562moon40782\t64861120\t563cjqq284586\twoainiqq\t563lx189710\tlx3681336\t563jksdhu526\t8320640\t563hananning\t8876611\t563caolei0805\t19840805\t563xielu456\tbyswdh741\t563jackielong\t198168\t564wos47qwudi\t19880616\t564afeng2075\tzhansheng\t564seraphcool\t1987322\t564mingzishuo\tmayuan\t565zengdong012\t5515293\t565chromosomegg\twoaini\t566tianlesoftware\twoshidmm\t568liuyue236869543\taaa008\t569loung\tlon1324\t607131313\t123456\t608454564\t123456\t609xxj0303\t521ddxxj\t610liy12586\tlisbfyong\t611zuoyouzhua\twoshihaozi\t616love_xuelin\t1984090308\t616\n   修复方案：  邮箱撞库无小事，好好修复一下吧   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-05-12 11:32 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}