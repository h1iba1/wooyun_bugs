{"id": 10445, "wybug_id": "wooyun-2015-0121101", "wybug_title": "亿玛在线多个漏洞打包(Rsync未授权\\服务邮箱泄露\\Getshell等)", "wybug_corp": "emar.com", "wybug_author": "路人甲", "wybug_date": "2015-06-17 14:37", "wybug_open_date": "2015-08-01 14:44", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["默认配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-01：\t细节向公众公开  简要描述： rsync未授权访问导致shell 详细说明：  1、rsync未授权访问\n\n某爬虫web源码目录2、rsync emar.com::es/web/ 可直接下载、上传这个应该是之前谁提交过得到的邮箱密码。mail.server.user=servicesmail.server.pass=eqifaservicesnginx配置泄漏其它域名 IP信息\nuser  root;worker_processes  8;error_log  logs/error.log;#error_log  logs/error.log  notice;#error_log  logs/error.log  info;pid        logs/nginx.pid;worker_rlimit_nofile 10240;events {        use epoll;    worker_connections  102400;}http {    include       mime.types;    default_type  application/octet-stream;    log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '                      '$status $body_bytes_sent \"$http_referer\" '                      '\"$http_user_agent\" \"$http_x_forwarded_for\" \"$http_host\"';    #access_log  logs/access.log  main;    proxy_hide_header Vary;    sendfile        on;    #tcp_nopush     on;       upstream cm_fair {        server   127.0.0.1:8081;        server   127.0.0.1:8082;        server   127.0.0.1:8083;        server   127.0.0.1:8084;\tserver   127.0.0.1:8085;        server   127.0.0.1:8086;        server   127.0.0.1:8087;\t#server   114.113.233.77 weight=8 backup;        #server   106.38.251.106:8082 weight=1 backup;        #server   106.38.251.186:8082 weight=1 backup;        check interval=3000 rise=2 fall=5 timeout=120 type=http;        check_http_send \"GET / HTTP/1.0\\r\\n\\r\\n\";        #check_http_expect_alive http_2xx http_3xx;    }    #keepalive_timeout  0;    #keepalive_timeout  65;    keepalive_timeout  10;    client_max_body_size 50m;    proxy_buffer_size   1024k;    proxy_buffers   32 64k;    proxy_busy_buffers_size   1024k;    proxy_temp_file_write_size 1024k;    client_header_buffer_size 1024K;    large_client_header_buffers 48 2048k;    underscores_in_headers on;    gzip  on;    add_header Vary Accept-Encoding;    gzip_http_version 1.0;    gzip_min_length  1000;    gzip_buffers     4 8k;    gzip_comp_level 9;    gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;\t     server {        listen       80    default     ;        #server_name  emarbox.com *.emarbox.com ckm.emarbox.com dmpcm.emarbox.com dmpcm.yigao.com;        gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;        #access_log  logs/adwiser.log;        location ~ /WEB-INF/ {                return 404;        }        error_page  404              /404.html;        error_page   500 502 503 504  /50x.html;        location = /50x.html {            root   html;        }        #if ($host ~* \"emarbox\\.com$\"){        #       rewrite /(.*)$   http://adwiser_1k0gd.emarbox.com/$1 last;        #}             location / {                #access_log  logs/cookiematch.log main;\t\taccess_log off;                index index.jsp;                proxy_pass http://cm_fair;\t\tproxy_next_upstream http_500 http_502 http_503 http_504 error timeout invalid_header;                proxy_set_header  Host $host;                proxy_set_header  X-Real-IP  $remote_addr;                proxy_set_header  X-Forwarded-For $remote_addr;                proxy_headers_hash_max_size     1024;                proxy_headers_hash_bucket_size  128;                add_header Cache-Control no-cache;                add_header Cache-Control private;        }              location /nstatus {                check_status;                access_log off;                #allow SOME.IP.ADD.RESS;                #deny all;        }    }    server {        listen       443         default;        #server_name  emarbox.com *.emarbox.com  dmpcm.emarbox.com dmpcm.yigao.com;        gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;            #access_log  logs/adwiser.log;            ssl on;              ssl_certificate /usr/local/nginx/conf/https/emarbox.cer;        ssl_certificate_key /usr/local/nginx/conf/https/emarbox.key;        location ~ /WEB-INF/ {                return 404;        }                error_page  404              /404.html;                error_page   500 502 503 504  /50x.html;        location = /50x.html {                   root   html;        }        #if ($host ~* \"emarbox\\.com$\"){        #       rewrite /(.*)$   http://adwiser_1k0gd.emarbox.com/$1 last;        #}                location / {                access_log  logs/cookiematch.log main;                index index.jsp;                proxy_pass http://cm_fair;                #proxy_pass http://cm_fair2;                proxy_set_header  SSL true;                proxy_set_header  Host $host;                proxy_set_header  X-Real-IP  $remote_addr;                proxy_set_header  X-Forwarded-For $remote_addr;                proxy_headers_hash_max_size     1024;                proxy_headers_hash_bucket_size  128;        }    }    server {        listen       80 ;        server_name  www.emar.com emar.com;        gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;        location / {                access_log  logs/emar.com.log main;                index index.html index.php index.jsp;                proxy_pass http://221.122.127.14;            \t  proxy_set_header  Host $host;                proxy_set_header  X-Real-IP  $remote_addr;                proxy_set_header  X-Forwarded-For $remote_addr;                proxy_headers_hash_max_size     1024;                proxy_headers_hash_bucket_size  128;        }    }\tserver {                        listen       8011 ;                 server_name_in_redirect off;                       server_name    www.emar.com.cn;                access_log      logs/www.emar.com.cn_8011.log main;                        location / {                        proxy_pass http://221.122.127.49:8011/;                        proxy_set_header X-Forwared-For $proxy_add_x_forwarded_for ;                        proxy_set_header Host $http_host ;                        proxy_set_header X-Real-IP  $remote_addr;                        proxy_set_header X-Forwarded-For $http_x_forwarded_for;                    }              }\tserver {        listen       80 ;        server_name  www.yijifen.com yijifen.com;        gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;        location / {                access_log  logs/emar.com.log main;                index index.html index.php index.jsp;                proxy_pass http://221.122.127.200;            \t  proxy_set_header  Host $host;                proxy_set_header  X-Real-IP  $remote_addr;                proxy_set_header  X-Forwarded-For $remote_addr;                proxy_headers_hash_max_size     1024;                proxy_headers_hash_bucket_size  128;        }    }    server {        listen       80 ;        server_name  www.intdmp.com *.intdmp.com intdmp.com;        gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;        location / {        \t\t\t\troot /data/intdmp;        \t\t\t\tindex intdmp.htm index.html index.php index.jsp;                access_log  logs/emar.com.log main;                       }    }\t server {        listen       80 ;        server_name  www.emaryun.com *.emaryum.com emaryun.com;        gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;        location / {        \t\t\t\troot /data/emaryun;        \t\t\t\tindex emaryun.htm index.html index.php index.jsp;                access_log  logs/emar.com.log main;                       }    }\t server {        listen       80 ;        server_name  www.emarbox.net *.emarbox.net emarbox.net;        gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;        location / {        \t\t\t\troot /data/emarbox.net;        \t\t\t\tindex emarbox.htm index.html index.php index.jsp;                access_log  logs/emar.com.log main;                       }    }\t server {        listen       80 ;        server_name  www.emardmp.com *.emardmp.com emardmp.com;        gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;        location / {        \t\t\t\troot /data/emardmp;        \t\t\t\tindex emardmp.htm index.php index.jsp;                access_log  logs/emar.com.log main;                       }    }\tserver {        listen       80 ;        server_name  www.emaradx.com *.emaradx.com emaradx.com;        gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;        location / {                access_log  logs/emaradx.com.log main;                index index.html index.php index.jsp;                proxy_pass http://118.26.150.214;            \t  proxy_set_header  Host $host;                proxy_set_header  X-Real-IP  $remote_addr;                proxy_set_header  X-Forwarded-For $remote_addr;                proxy_headers_hash_max_size     1024;                proxy_headers_hash_bucket_size  128;        }    }     server {        listen       80 ;        server_name  www.eqile.com *.eqile.com eqile.com;        gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;        location / {                access_log  logs/www.eqile.com.log main;                index index.html index.php index.jsp;                proxy_pass http://221.122.127.157;                  proxy_set_header  Host $host;                proxy_set_header  X-Real-IP  $remote_addr;                proxy_set_header  X-Forwarded-For $remote_addr;                proxy_headers_hash_max_size     1024;                proxy_headers_hash_bucket_size  128;        }    }}\n3、可直接上传导致主域名下机器getshellhttp://emar.com:15801/js_ss.jsp\n\n4、http://221.122.127.117:15801/某处爬虫 泄漏大量内网IP\n\n   漏洞证明：  见详细   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-06-17 14:42 厂商回复： 路人甲 感谢，我们紧急处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}