{"id": 52776, "wybug_id": "wooyun-2014-070210", "wybug_title": "Qwbm深山行者旅行社管理系统可通杀绕过登陆获得后台权限", "wybug_corp": "深山工作室", "wybug_author": "zph", "wybug_date": "2014-07-31 18:01", "wybug_open_date": "2014-10-29 18:02", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-08：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-29：\t细节向公众公开  简要描述： 本漏洞与http://www.wooyun.org/bugs/wooyun-2014-070130 是一个原理 :) 详细说明：  0x01 代码审计我们先看admin/qwbm_index.asp\n<%@LaNGUaGE=\"VBSCRIPT\" CODEPaGE=\"936\"%><!--#include file=\"qwbm_conn.asp\"--><!--#include file=\"qwbm_cheack.asp\"--><META http-equiv=Content-Type content=\"text/html; charset=gb2312\"> <html><head><meta http-equiv=Content-Type content=text/html;charset=gb2312><title><%=qwbmcms1%></title><style type=\"text/css\">.navPoint {COLOR: white; CURSOR: hand; FONT-FAMILY: Webdings; FONT-SIZE: 9pt}.a2{BACKGROUND-COLOR: A4B6D7;}.top_r {text-align:right;padding-left:300px;}.top_r a{color:#FFFFFF;text-decoration:none;}</style></head>\n同样地，admin/qwbm_cheack.asp为权限检查文件\n<%if request.cookies(\"\"& qwbmcms2 &\"username\") = \"\" thenresponse.write \"您没有查看该文件的权限\"response.endend if%>\n文件中，程序只对qwbmcms2 &\"username\" cookie进行判断，如果isset，就会成功登陆。但与 WooYun: Qwbm深山行者留言板可通杀绕过登陆获得后台权限 不同的是，qwbmcms2变量未知我们在response.end前加上response.write qwbmcms2，来输出qwbmcms2变量的内容但是我们访问admin/qwbm_cheack.asp后，发现qwbmcms2变量内容为空，所以我们构造cookie：\nusername=admin\n修改cookie后，即可成功登陆   漏洞证明：  0x02 修改&绕过\n\n\n\n\n\n\n\n   修复方案：  更改登陆验证策略，加强安全意识   版权声明：转载请注明来源 zph@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-08-05 09:30 厂商回复： CNVD未建立与软件开发者的处置联系渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-31 18:47 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  @疯狗 为什么这两个也是小厂商啊？  WooYun: Qwbm深山行者旅游网站管理系统可通杀无视任何条件限制绕过登陆获得后台权限    \n     2014-08-01 16:30 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  @疯狗 @Finger @肉肉 WooYun: Qwbm深山行者旅行社管理系统可通杀绕过登陆获得后台权限 WooYun: Qwbm深山行者旅游网站管理系统可通杀无视任何条件限制绕过登陆获得后台权限 这两个为什么也是小厂商？    \n     2014-08-12 21:32 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  @疯狗 奖金有乎？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}