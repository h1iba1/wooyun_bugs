{"id": 20063, "wybug_id": "wooyun-2012-06004", "wybug_title": "金山毒霸2012企业版管理平台漏洞", "wybug_corp": "金山毒霸", "wybug_author": "james0672", "wybug_date": "2012-04-13 09:34", "wybug_open_date": "2012-05-28 09:35", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-04-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-04-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-05-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-05-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-05-28：\t细节向公众公开  简要描述： sql injection...你懂的。。关键是泄露信息 详细说明：  sql injection...比较常见\n$sql = \"select * from T_ADMINISTRATOR where name='\".$username.\"' and pw='\".md5($password).\"'\";\t\t\t\t\t$result = $this->db_handler->query($sql);\t\t\t\t\t$record = $result->fetch(PDO::FETCH_ASSOC);\t\t\t\t\t$result->closeCursor();\n\nfunction check_passport($username,$password)\t{\t\t$ret = false;\t\t$this->init_db_handler(1);\t\t$this->init_db_handler(3);\t\tif($this->db_handler != null)\t\t{\t\t\t$exist = $this->get_userinfo_mongo($username,$password);\t\t\tif($exist > 0)\t\t\t{\t\t\t\t$ret = true;\t\t\t}\t\t\telse if($exist == -1)\t\t\t{\t\t\t\ttry\t\t\t\t{\t\t\t\t\t$sql = \"select * from T_ADMINISTRATOR where name='\".$username.\"' and pw='\".md5($password).\"'\";\t\t\t\t\t$result = $this->db_handler->query($sql);\t\t\t\t\t$record = $result->fetch(PDO::FETCH_ASSOC);\t\t\t\t\t$result->closeCursor();\t\t\t\t\tif($record != null)\t\t\t\t\t{\t\t\t\t\t\tunset($record['id']);\t\t\t\t\t\t$s_c = $this->mon_handler->selectDB($this->setting_db)->selectCollection($this->t_administrator);\t\t\t\t\t\t$s_c->insert($record);\t\t\t\t\t\t$ret = true;\n   漏洞证明：  \n\n\n\n   修复方案：  各种过滤吧   版权声明：转载请注明来源 james0672@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-04-13 18:07 厂商回复： 感谢您对金山毒霸企业版2012的关注，您提出的问题已得到研发人员的确认并在20120413.142634版本解决，再次感谢您在漏洞被利用之前通知我们，据我们分析，此漏洞没有对用户造成影响，如有产品问题可以直接联系我们，非常感谢！  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-04-13 10:41 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这是企业内部的管理平台么？    \n     2012-04-13 12:18 |    \t\tjames0672 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:4        | 我会灰的~~)\t\t \n  不是，是个对外产品来的    \n     2012-04-13 12:30 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @james0672 产品...?其他企业内部用的？    \n     2012-04-13 13:22 |    \t\tjames0672 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:4        | 我会灰的~~)\t\t \n  @xsser http://www.ijinshan.com/eduba/index.shtml这个    \n     2012-04-13 13:46 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @james0672 要是这个就玩儿大了    \n     2012-04-13 14:02 |    \t\tjames0672 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:4        | 我会灰的~~)\t\t \n  @xsser 的确有那么点。。。    \n     2012-04-13 14:55 |    \t\ther0ma \t\t\t( 核心白帽子 |\t\t\t        Rank:598 漏洞数:84        | 专注小厂商三十年！)\t\t \n  表示 关注……     \n     2012-05-28 10:38 |    \t\t紫梦芊 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:9        | 踏踏实实做测试)\t\t \n  整个也太基础的2了20 RANK啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}