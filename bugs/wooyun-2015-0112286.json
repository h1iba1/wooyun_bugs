{"id": 41895, "wybug_id": "wooyun-2015-0112286", "wybug_title": "麦当劳分站存在注入可多姿势Getshell顺便漫游内网", "wybug_corp": "麦当劳(中国)有限公司", "wybug_author": "路人甲", "wybug_date": "2015-05-05 21:49", "wybug_open_date": "2015-05-10 21:50", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-10：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 已加入肯打鸡豪华午餐 详细说明：  注入点:http://franchising.mcdonalds.com.cn/cn/faq.aspx?cid=5 (GET)http://convention.mcdonalds.com.cn/2012/login.aspx (POST)附图:\n\n后台地址:http://convention.mcdonalds.com.cn/whir_******/login.aspxhttp://franchising.mcdonalds.com.cn/whir_******/login.aspx找到后台地址后 登陆后台 发现有可以任意读取文件内容 也能保存 但是上传目录没有可写权限 直接保存一个不存在的文件成功Getshell 在Shell里面发现有ewebeditor目录,熟悉的后台熟悉的弱口令直接进去所以说除了后台拿shell外 别人有扫到ewebeditor的后台地址也能直接GetshellShell:http://convention.mcdonalds.com.cn/2012/index1.aspx\n\n可看出还不止一个编辑器可是服务器是Windows 2008 R2系统 通过已知提权漏洞没有成功提权通过翻阅数据库配置文件 可看到connectionString=\"Data Source=172.18.0.163;User ID=mcd;Password=*********本机IP:172.18.0.162站库分离情况下 可因为数据库帐号不是Sa所以也无法提权 再通过翻数据库配置文件发现connectionString=\"Data Source=172.20.49.19;User ID=Sa;Password=*******发现Sa帐号 可一直都连接不了 ping也ping不通 想了想 可能是以前的配置文件已经失效了于是拿着Sa密码去连接172.18.0.163\n\n导出服务器帐号密码发现Administrator用户和APEUser密码简直不要太通杀!通过103机器直接连接到102机器上记得麦当劳有说过有几台服务器是托管的 所以已经深入不了把内网里的其他服务器用通杀密码搞定后 激情也便褪去了   漏洞证明：  -   修复方案：  -   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-05-10 21:50 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}