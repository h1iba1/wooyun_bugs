{"id": 7683, "wybug_id": "wooyun-2013-040692", "wybug_title": "tower.im某系统敏感信息泄露 导致网络边界被突破", "wybug_corp": "彩程设计", "wybug_author": "猪猪侠", "wybug_date": "2013-10-23 10:55", "wybug_open_date": "2013-12-07 10:56", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "错误信息未屏蔽", "后台被猜解", "后台地址泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-07：\t细节向公众公开  简要描述： 由于没有一个通用的防御规则保护好配置信息、业务数据信息、系统错误信息和敏感地址信息(后台或测试地址)的泄露，攻击者可能会通过收集这些保护不足的数据，利用这些信息对系统实施进一步的攻击。本次测试通过收集到的信息，突破了tower.im所处网络的边界，成功获取了彩程设计旗下多个产品的数据库信息和产品源码！最终利用可直接接触到tower.im的github源码仓库，读取到数据库配置内的信息后，即可通过已突破边界连接数据库查看所有项目内容、项目人员信息。 详细说明：  #1 信息泄露BIG BROTHER 系统预设值登陆信息https://bb.tower.im/users/sign_in用户名：demo@bb.tower.im密码：123456\n\n#2 获取到彩程设计旗下服务器列表\nA7 Running 42.121.85.157E3 Running 42.121.193.118F16A Running 112.124.33.140F16B Running 112.124.33.141B52 Running 42.121.96.170KC135 Running 42.121.194.93F16C Running 112.124.24.102F16D Running 112.124.24.183\n\n\n#3 通过获取到的信息进一步测试{42.121.194.93} 绑定域名列表 (这你只简单描述测试成功的服务器)\nhttp://blog.mycolorway.comhttp://mycolorway.comhttp://www.mycolorway.com\n#4 进一步指纹识别所有获取到的URLhttp://blog.mycolorway.com 博客使用了wordpress系统；自动化FUZZ：\n获取到用户名列表：['admin', 'zchar', 'peng', 'fish', 'farthinker', 'lendice', 'mayuan', 'alfred','inmay', 'shawn', 'maklu', 'et', 'lulu', 'dragon', 'calf']\n字典枚举，成功测试到如下用户的密码：calf:123456et:123456进入后台写入任意脚本：\n\n   漏洞证明：  # 生产环境配置信息\nproduction:  adapter: mysql2  encoding: utf8  reconnect: false  database: tower_prd  pool: 5  username: root  password: \"likeadamnshit\"\n# GITHUB 服务端\n\n# tower.im 主站的源码仓库\n\n   修复方案：  #1 网络边界需要认真对待。#2 安全是一个整体，保证安全不在于强大的地方有多强大，而在于真正薄弱的地方在哪里。#3 杜绝为了方便而造成的不必要的信息泄露。   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-10-23 11:48 厂商回复： 非常感谢@猪猪侠发现漏洞并联系我们进行处理。漏洞确实存在，我们的源代码确实泄漏，这让我们胆战心惊。了解到情况后，我们已经修复了该漏洞。所幸tower.im正式环境跟GIT服务器隔离，用户数据没有被泄漏。再次感谢@猪猪侠，我们会更努力做好安全工作，安全不在于强大的地方，我们还有很多要改进的。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n          这些评论似乎很乌云~~~思密达          2013-10-23 12:20 |\t\t\t\t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t\t\t\tRank:3224 漏洞数:254\t\t\t| 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t\t\t\t\t\t\n  @彩程设计 厂商还是没理解简单描述内的这句话：“攻击者可能会通过收集这些保护不足的数据，利用这些信息对系统实施进一步的攻击”，突破了边界，获取到了源代码，控制了内部服务器。再结合以战养战的思路，白帽子和看官们觉得离用户数据泄漏还有多远？    \n   \n \n     2013-10-22 22:32 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  偶像呀    \n     2013-10-22 22:46 |    \t\t李白 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:29        )\t\t \n  @se55i0n 偶像呀    \n     2013-10-22 23:24 |    \t\tM0nster \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:17        | 允许我国的艺术家先富起来)\t\t \n  我就知道tower肯定很快爆菊    \n     2013-10-23 09:33 |    \t\tdyun \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:15        | [code][/code])\t\t \n  mark    \n     2013-10-23 11:28 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  牙刷 这个我有注册。。。    \n     2013-10-23 11:57 |    \t\twinsyk \t\t\t( 普通白帽子  |\t\t\t        Rank:108 漏洞数:16        | 越长大越孤单)\t\t \n  小厂商。。    \n     2013-10-23 12:20 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @彩程设计 厂商还是没理解简单描述内的这句话：“攻击者可能会通过收集这些保护不足的数据，利用这些信息对系统实施进一步的攻击”，突破了边界，获取到了源代码，控制了内部服务器。再结合以战养战的思路，白帽子和看官们觉得离用户数据泄漏还有多远？    \n     2013-10-23 12:27 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  以战养战的方法，在每一次现代战争中都适用，同样网络中的攻防对抗也可用！，至今都没有一个好的对策来彻底防御这种攻击！    \n     2013-10-23 12:30 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @猪猪侠 军事家    \n     2013-10-23 12:30 |    \t\tM0nster \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:17        | 允许我国的艺术家先富起来)\t\t \n  @猪猪侠 别拆穿人家厂商嘛    \n     2013-10-23 12:38 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  绝对的偶像啊！    \n     2013-10-23 12:59 |    \t\t彩程设计(乌云厂商)\t\t \n  @猪猪侠 嗯，我们理解这次网络边界被突破的严重性，我们的意思只是说，幸好这次少侠高抬贵手，没有继续进行攻击，所以目前为止，这个商业产品的用户数据并没有泄露出去，我们需要让用户知道这个实际情况，让他们可以稍微安心一些。但是这并不代表我们认为猪猪侠的攻击不会造成数据泄露，我们也知道，如果给猪猪侠更多一些时间，感染最终一定会蔓延到我们的用户数据里面去，毕竟我们的一台正式环境的战斗机已经被控制了，所以这种貌似对最不起眼的公司网站博客系统的安全问题的疏忽，也能导致灾难性的后果，我们是明白的，谢谢猪猪侠童鞋给我们的教训。    \n     2013-10-23 13:41 |    \t\twinsyk \t\t\t( 普通白帽子  |\t\t\t        Rank:108 漏洞数:16        | 越长大越孤单)\t\t \n  @彩程设计 厂商无形中把攻击的目标说出来了，我想我大概知道如何攻击的了。    \n     2013-12-08 00:33 |    \t\tSafeGUN \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:8        | None)\t\t \n  @猪猪侠 想知道wp是怎么踹开的，求私信细节...    \n     2013-12-08 11:44 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @SafeGUN AWVS的自动化FUZZ，从aouth得到用户名了wp-login来爆破密码。    \n     2013-12-08 11:45 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  我擦，上错马甲了！    \n     2013-12-08 19:10 |    \t\tSafeGUN \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:8        | None)\t\t \n  @小胖子 哈哈抓到马甲了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}