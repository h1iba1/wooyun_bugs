{"id": 26902, "wybug_id": "wooyun-2015-0127387", "wybug_title": "东方网景域名站重大漏洞导致随意重置他人账号密码（通杀所有企业，工作人员密码，附经典案例）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "0x 80", "wybug_date": "2015-07-19 22:28", "wybug_open_date": "2015-09-07 05:30", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-07：\t细节向公众公开  简要描述： 东方网景域名站重大漏洞导致随意重置他人账号密码（通杀所有企业，工作人员密码，附经典案例）理论上，只要我知道他的邮箱，他的密码任意被我改掉附几个经典案例给大家包括东方网景的工作人员额 详细说明：  inurl:www.east.net/user/showUserSuccess这个案例我会说清楚的一步一步来通过这个，打开http://www.east.net/user/showUserSuccess?email=caiym@tsinghua.org.cn获取到第1个邮箱\n\n这里我用BURP抓包，修改成我的激活邮件，失败了\n\n这个网站的原理，我分析过，如果修改这里邮箱那么，如果你的邮箱没在网络上注册，那么他会提示1个不存在该邮箱后来我自己就注册了一个同样发包，还是没有发到我的邮箱去我们思路是，自己注册1个邮箱这个地址是个关键http://www.east.net/user/showUserSuccess?email=caiym@tsinghua.org.cn如当前=caiym@tsinghua.org.cn 我们要改为他的密码我们先给自己发重置密码搭配我们自己的邮箱http://www.east.net/user/showUserSuccess?email=466196038@qq.com接着发送\n\n这里重发1次就可以了接着，我们在邮箱里找到我们邮箱密码重置CODE\n\n这时候访问下http://www.east.net/user/userForgetPassword?code=b0f47076c2df6d4d44296952099ce6ab&email=466196038%40qq.com我发现1个很大的问题他的CODE几乎是通用的也就是说，这个KEY可以任何邮箱通用比如现在到了重置密码这步了我们看看\n\n我们还记得我们要改掉谁的密码把当然就是他：caiym@tsinghua.org.cn我们先登录自己账号看看\n\n由于是刚注册的，所以什么也没有关键来了，我们要改掉caiym@tsinghua.org.cn的密码，那么就要配合这个通用CODE组合下http://www.east.net/user/userForgetPassword?code=b0f47076c2df6d4d44296952099ce6ab&email=caiym@tsinghua.org.cn这样\n\n我们就改为7788250cc试试\n\n注意账号：caiym@tsinghua.org.cn密码：7788250cc登录看看\n\n成功了，看看\n\n\n\n一览无遗。我们还可以发现一个地方\n\n上个销售部的，很明显，CODE都是通用的，我们照样可以改掉它的配合下http://www.east.net/user/userForgetPassword?code=b0f47076c2df6d4d44296952099ce6ab&email=luguohe@east.net同样改成7788250cc登录看看\n\n沦陷了吧~~\n\n\n部门客服部销售部续费部联系电话010-62692880-1600010-62692880-5858010-62692880-1800电子邮箱support@east.netsales@east.netxufei@east.net传真010-62692880-1105010-62691675010-62691003\n这里有三个邮箱先来改客服部的support@east.net试试同样改成7788250cchttp://www.east.net/user/userForgetPassword?code=b0f47076c2df6d4d44296952099ce6ab&email=support@east.net\n\n\n\n客服部沦陷了。。==========================================================再来改1个企业会员的http://www.east.net/user/showUserSuccess?email=admin@cmmrchina.com配合下http://www.east.net/user/userForgetPassword?code=b0f47076c2df6d4d44296952099ce6ab&email=admin@cmmrchina.com7788250zz改成这个登录看看\n\n又沦陷了~~~   漏洞证明：  http://www.east.net/user/userForgetPassword?code=b0f47076c2df6d4d44296952099ce6ab&email=(这里是通杀处，输入邮箱地址即可改掉）   修复方案：  验证过滤   版权声明：转载请注明来源 0x 80@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-07-24 05:29 厂商回复： CNVD确认并复现所述情况,已经由CNVD通过该域名注册服务商公开联系渠道,由其电话和邮件通报处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}