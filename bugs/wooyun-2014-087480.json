{"id": 41853, "wybug_id": "wooyun-2014-087480", "wybug_title": "福建联通分站运维不当导致整套源码泄露", "wybug_corp": "福建联通", "wybug_author": "星明月稀", "wybug_date": "2014-12-17 12:52", "wybug_open_date": "2015-01-31 12:54", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "源代码泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-31：\t细节向公众公开  简要描述： 福建联通分站运维配置不当导致整套源码泄露！！！可审计，未深入，望及时修复！ 详细说明：  问题站点：http://zg.fj10010.com/svn泄露，导致可遍历下载整套源代码！http://zg.fj10010.com//.svn/entries\n\n详见证明！   漏洞证明：  （1）主目录entries文件\n\n（2）我们知道在.svn目录下会有以.svn-base结尾的源代码文件副本，如果服务器没有解析这个后缀名，黑客就可以下载文件的源代码。（路径在./svn/text-base下）如：找到个敏感文件只要输入如下格式\nhttp://zg.fj10010.com/App/Conf/.svn/text-base/config.php.svn-base\n\n\n数据库账号密码和邮箱账号密码皆泄露额！数据库不可远程登录，但有数据库结构文件未删，邮箱也可登陆！\n\n\n\n（3）按照上面下载源文件的格式，我们就可以写个小脚本，从主目录下的entries文件开始遍历下载整套位于SVN下的源代码！！！\n\n   修复方案：  参考可见：http://drops.wooyun.org/tips/352如果已经线上的生产环境已经有了.svn目录不想删掉可以在服务器上设置禁制访问此目录：另外svn更新至1.7+ .svn/entries目录就不包含文件目录列表了。Apache:\n<Directory ~ \"\\.svn\">Order allow,denyDeny from all</Directory>\nNginx:\nlocation ~ ^(.*)\\/\\.svn\\/ {return 404;}\n   版权声明：转载请注明来源 星明月稀@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-12-22 08:24 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT下发给福建分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}