{"id": 37096, "wybug_id": "wooyun-2015-0100431", "wybug_title": "天天网查看修改使用任意用户信息(可以使用用户余额和积分)", "wybug_corp": "tiantian.com", "wybug_author": "0x70", "wybug_date": "2015-03-11 11:32", "wybug_open_date": "2015-04-25 11:34", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-25：\t细节向公众公开  简要描述： 天天网查看修改使用任意用户信息(可以使用用户余额和积分),查看地址,订单等等 详细说明：  天天网用户的判断只在cookie中的AspToUserID=进行了验证,更改AspToUserID=为用户名即可任意操作此用户。我新注册了个账号：先来看看查看和修改任意用户的地址：这是我的，我没有填任何地址\n\n在商品评论中随便这个用户名,把AspToUserID=修改为受害者用户名\n\n查看到地址\n\n试试修改地址：点击修改--把所有拦截包中的AspToUserID=都改成受害者用户名(如果嫌麻烦，可以用burp添加正则规则)修改好后点击确认的时候也要修改AspToUserID=\n\n\n\n再利用上面的任意查看再看一遍\n\n查看任意订单(跟上面步骤是一样的)\n\n再看看任意使用积分兑换礼品：先看下我的积分\n\n利用上面漏洞找个积分多的用户\n\n我去兑换一个600积分的东西,用上面的漏洞可以兑换,但是因为天天网不能单独光兑换东西,要买东西,屌丝没什么要买的,就放弃了\n\n余额应该也是存在同样的漏洞,但是没找到账号有余额的,所以没法测试,天天网的安全人员自查吧。   漏洞证明：  我的红包、消息管理、账号安全等等  都是存在的\n\n   修复方案：  你们懂的   版权声明：转载请注明来源 0x70@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-03-11 11:54 厂商回复： 已确认 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}