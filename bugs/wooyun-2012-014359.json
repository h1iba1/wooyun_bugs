{"id": 15640, "wybug_id": "wooyun-2012-014359", "wybug_title": "第三方开源程序上二次开发的xss安全隐患（以178的discuz为例）", "wybug_corp": "178游戏网", "wybug_author": "0x_Jin", "wybug_date": "2012-11-05 11:18", "wybug_open_date": "2012-12-20 11:19", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-11-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-12-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-20：\t细节向公众公开  简要描述： 未对输入的字符串做任何过滤 ！可输入字符 40个 基本上可以调用每个平台的钩子了！ 不需要闭合任何标签 详细说明：   我想如果个人资料能显示在哪个页面 哪个页面就会执行你输入的脚本  不过有的页面不能！需要测试 不过像178工会这种 利用率很大！漏洞页面：main.php这里我是拿的gh.178.com 做的实验！ 可以在这个创建个圈子 也就是论坛！在游戏昵称内 可以输入四十个字符！ 四十个字符完全可以加载一个钩子了  你不需要闭合任何标签！受影响页面：应该是所有加载游戏昵称的页面都会执行一次！ 除非那个页面做了过滤 如果原封不动的从数据库调的话 应该会报的！然后点击提交即可！   漏洞证明：  \n\n\n\n   修复方案：  过滤掉可输入的用户昵称标签的 敏感字符 以及缩短可输入的字节！ 一个名字 四十个字节  他得多NB阿。。。   版权声明：转载请注明来源 0x_Jin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2012-11-05 13:03 厂商回复： 感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-11-05 11:58 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  霸气的标题。    \n     2012-11-05 12:07 |    \t\t0x_Jin \t\t\t( 普通白帽子  |\t\t\t        Rank:319 漏洞数:37        | 微博：http://weibo.com/J1n9999)\t\t \n  @鬼魅羊羔 霸气的标题才是个良好的开始    \n     2012-11-05 18:58 |    \t\t0x_Jin \t\t\t( 普通白帽子  |\t\t\t        Rank:319 漏洞数:37        | 微博：http://weibo.com/J1n9999)\t\t \n   我神算？ 今天去学校的路上我就在想 会给我多少RANK  当时想的 最多8RANK... 没想到 真的是8    \n     2012-11-05 19:07 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  满足吧，这年头，厂商不忽略就是万幸了。    \n     2012-11-05 19:11 |    \t\t0x_Jin \t\t\t( 普通白帽子  |\t\t\t        Rank:319 漏洞数:37        | 微博：http://weibo.com/J1n9999)\t\t \n  @鬼魅羊羔 我想知道RANK 有啥用  1RANK  就是1个乌云币？    \n     2012-11-05 19:22 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  恩，乌云币高有好处，可以提前看一些帖子。也可以兑换礼品，我现在才101→_→    \n     2012-11-05 23:28 |    \t\t0x_Jin \t\t\t( 普通白帽子  |\t\t\t        Rank:319 漏洞数:37        | 微博：http://weibo.com/J1n9999)\t\t \n  @鬼魅羊羔 是不是 50乌云币就可以买个xsser.me的邀请码了    \n     2012-11-05 23:30 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @0x_Jin 嗯，所以，加油吧。。。    \n     2012-12-05 14:34 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  听说商城里可以用乌云币兑换切糕？    \n     2012-12-20 16:10 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  缺陷关联： WooYun: ”用qq登陆“api接口xss （引入插件等第三方内容导致被引用页面出现安全问题）    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}