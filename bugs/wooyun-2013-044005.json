{"id": 6862, "wybug_id": "wooyun-2013-044005", "wybug_title": "爱毒霸社区存在高危敏感信息泄露风险#2", "wybug_corp": "金山毒霸", "wybug_author": "猪猪侠", "wybug_date": "2013-11-25 14:48", "wybug_open_date": "2014-01-09 14:48", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "错误信息未屏蔽"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-09：\t细节向公众公开  简要描述： 你们的补丁为防止再次发生，在webserver端屏蔽了对.bak的请求，这样简单补丁后就大吉了吗？攻击者会通过收集保护不足的数据，利用这些信息对系统实施进一步的攻击。尽可能的不要哪里出了问题补哪里，补完之后草草了事，应思考想办法建立一套自动协调的防御机制，一个地方出现的安全问题，一次补丁即可覆盖所有系统！ 详细说明：  #1 信息泄露原因由于论坛管理员在更新服务器文件时，未注意到编辑器会默认创建各种.bak文件用来规避错误编辑时引发的数据丢失风险，从而造成了更严重的信息安全问题。#2 你们说你们补丁了这类问题？？？网站: http://bbsuc.duba.net 存在信息泄露:文件1：http://bbsuc.duba.net/data/config.inc.php.bak内容：\n<?php define('UC_DBHOST', '10.10.1.26:13291');define('UC_DBUSER', 'bbs_uc_pro');define('UC_DBPW', '8487eacf*****************b6428f8bcc10');define('UC_DBNAME', 'bbs_uc');define('UC_DBCHARSET', 'gbk');define('UC_DBTABLEPRE', 'cdb_uc_');define('UC_COOKIEPATH', '/');define('UC_COOKIEDOMAIN', '');define('UC_DBCONNECT', 0);define('UC_CHARSET', 'gbk');define('UC_FOUNDERPW', '5d3ec9697*****************976ee8d94c53cc');define('UC_FOUNDERSALT', '172583'); define('UC_KEY', 'M8O8m9b2y390l8RaL3x4pb*****************5i1paa4t8Z2M1LbC0qbi5e9Hc');define('UC_SITEID', 'v86879s2H3g0S8Na83c4YbZ*****************a8m2h1Gbq0Ebs5c90c');define('UC_MYKEY', '48n8w9R2x3Y0Z8*****************1Aac4T8o251AbE0xb95S9hc');define('UC_DEBUG', false);define('UC_PPP', 20);\n   漏洞证明：  #3 直接利用\n[ Linux yw_0_0.KIDC14118 2.6.32-358.14.2.el6.x86_64 #1 SMP Mon Jul 22 15:08:38 CST 2013 x86_64(www) ][/data/app/bbsuc.duba.net/]$ /sbin/ifconfig -aem1       Link encap:Ethernet  HWaddr 74:86:7A:E9:6B:FC            inet addr:10.10.2.153  Bcast:10.10.2.255  Mask:255.255.255.0          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:127813902 errors:0 dropped:0 overruns:0 frame:0          TX packets:109178214 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:55844207523 (52.0 GiB)  TX bytes:52319692684 (48.7 GiB)          Interrupt:35 em1:1     Link encap:Ethernet  HWaddr 74:86:7A:E9:6B:FC            inet addr:192.168.166.204  Bcast:192.168.166.255  Mask:255.255.255.0          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          Interrupt:35 em2       Link encap:Ethernet  HWaddr 74:86:7A:E9:6B:FD            BROADCAST MULTICAST  MTU:1500  Metric:1          RX packets:0 errors:0 dropped:0 overruns:0 frame:0          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)          Interrupt:38 em3       Link encap:Ethernet  HWaddr 74:86:7A:E9:6B:FE            BROADCAST MULTICAST  MTU:1500  Metric:1          RX packets:0 errors:0 dropped:0 overruns:0 frame:0          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)          Interrupt:34 em4       Link encap:Ethernet  HWaddr 74:86:7A:E9:6B:FF            BROADCAST MULTICAST  MTU:1500  Metric:1          RX packets:0 errors:0 dropped:0 overruns:0 frame:0          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)          Interrupt:36 lo        Link encap:Local Loopback            inet addr:127.0.0.1  Mask:255.0.0.0          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:130727988 errors:0 dropped:0 overruns:0 frame:0          TX packets:130727988 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:21833330683 (20.3 GiB)  TX bytes:21833330683 (20.3 GiB)[/data/app/bbsuc.duba.net/]$\n#4 利用细节由于Discuz UC_SERVER 的updateapps接口未严格校验客户端提交的数据，导致可写入任意代码至/config/config_ucenter.php。\n$code=urlencode(_authcode(\"time=$timestamp&action=updateapps\", 'ENCODE', $uc_key));\n鉴于!Discuz在乌云已经属于无良厂商，这里不纰漏详细代码参照： WooYun: 又一次失败的漫游腾讯内部网络过程 #2   修复方案：  #1 网络边界需要认真对待。#2 杜绝为了方便而造成的不必要的信息泄露。#3 安全是一个整体，保证安全不在于强大的地方有多强大，而在于真正薄弱的地方在哪里。   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-11-25 16:06 厂商回复： 感谢猪猪侠的报告，我们尽快修复 最新状态： 2013-12-10：目前已经修复，非常感谢  ", "replys": "漏洞评价：\n评论\n     2013-11-25 14:52 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  你们的补丁为防止再次发生，在webserver端屏蔽了对.bak的请求，这样简单补丁后就大吉了吗？    \n     2013-11-25 14:52 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  你以为这样就玩死大鸡了吗？    \n     2013-11-25 15:07 |    \t\t花生^_^ \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 加强学习~~)\t\t \n  期待【爱毒霸社区存在高危敏感信息泄露风险】#2#3#4#5#6#7#8    \n     2013-11-25 15:27 |    \t\t摸了你 \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:17        | 1shitMVqBjCKrnRvSoixMx6RKpG9J8pBM)\t\t \n  膜拜音总...    \n     2013-11-25 16:20 |    \t\tfelixk3y \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:41        | php python jsp)\t\t \n  漏洞提前公开，供小伙伴们学习    \n     2013-11-25 16:22 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  你以为这样就玩死大鸡了吗？     \n     2013-11-25 16:53 |    \t\tfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:664 漏洞数:79        | 想刷个6D)\t\t \n  跨擦 猪哥被人肉了，音总都出来了，还有天理么    \n     2013-11-25 23:42 |    \t\tdemonalex \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:4        | demonalex是傻逼，呵呵呵！)\t\t \n  楼猪又开始了？请记住不是谁都是大牛 你只是一头猪    \n     2013-11-26 15:05 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  恶意围观    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}