{"id": 59315, "wybug_id": "wooyun-2014-047908", "wybug_title": "某网页游戏平台越权操作涉及旗下全部网游所有服的登录密钥、充值密钥、客户端接口等信息", "wybug_corp": "上海万游网络科技有限公司", "wybug_author": "nauscript", "wybug_date": "2014-01-05 11:17", "wybug_open_date": "2014-02-19 11:18", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口未加权限认证", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-05：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-02-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 某网页游戏平台越权操作，涉及旗下全部网游所有服的登录密钥、充值密钥、客户端接口等重要信息，原来办个网页游戏也是可以赚上百万的。。。。 详细说明：  上海万游网络科技有限公司旗下的91prg网页游戏平台，经营多款手游、页游后台的http://www.91rpg.com/system/top.htmhttp://www.91rpg.com/system/left.htm两个页面可以直接登录  也可以直接http://www.91rpg.com/system/ 照样等后台的大部分功能都可以用，大量敏感信息都无限制访问多说无益、上图\n\n后台主界面\n\n\n\n\n\n再看看有多少游戏\n\n经营的游戏还不少，服也挺多，每个服的服务器地址、充值密钥、登录密钥、客户端接口等重要信息都可查可改，对于网页游戏没有什么了解，看到那个添加新服，不知道可不可以添加一个自己的私服，或者将那个充值接口做一个伪造，将充值账号改为自己的支付宝（看了下他的支付页面，是支付宝  有点猥琐 哈哈）\n\n说道充值，查询了一下游戏总收入，150多万。。。\n\n还要一些游戏推广的信息\n\n\n\n\n\n\n\n\n\n另外还可以添加公会和用户，还找到一个充值接口，添加了一个用户admni（在这里还可以猜解已有的用户名、邮箱，例如admin、test等账号都提示已经存在，登录无验证码，可以暴力破解，渗透过程中通过充值接口为账户充值的金额已经清零）\n\n\n\n身份证信息和邮箱信息在后台添加账户时可以避开不填，前台注册就不可以了，但是再修改就无法修改了，空格、null、不填都提示和原来不相符（这是为啥）还有其他一些功能：\n\n\n\n\n\n\n\n\n\n因是非法登录，部分功能只能修改不能添加，但是还是可以利用的，比如flash游戏管理那和首页广告推送那，都是指向aspx的一些页面，这里可以改为我们的恶意url，变相挂马。。。用工具跑了下，注入点却查不出数据库类型。。误报？ 于是看看是什么系统先看到后台的tittle是这样的\n\n然后又用搜索引擎看到了\n\n发现二级域名站都存在left.htm、top.htm直接登录的这个问题\nhttp://mhzc.91rpg.com/admin/left.htmhttp://djj.91rpg.com/admin/left.htmhttp://sxd.91rpg.com/admin/left.htmhttp://sq.91rpg.com/admin/left.htmhttp://blcx.91rpg.com/admin/left.htmhttp://xlfc.91rpg.com/admin/left.htmhttp://long.91rpg.com/admin/left.htmhttp://hzw.91rpg.com/admin/left.htm\n\n\n但是并不能越权操作，大都500错误\n然后googletittle:机械专家网站内容管理系统tittle:网优宝SEO企业网站管理系统--后台管理\n发现原来是该游戏平台主页用的是网优宝seo企业网站管理系统v1.0这个系统普遍存在后台上述两个页面可以越权访问到，但是功能并不能用，下载了一个在本地测试一下，没发现其他问题（个人能力有限）估计91prg是进行了二次开发？网优宝的主站都可以越http://www.expsky.com/admin/left.htm http://www.expsky.com/admin/top.htm   漏洞证明：  如上，不知道这样的越权是不是十分没含金量，但他确实可以威胁到部分重要信息，之前有被忽略过此类洞，看这次了，不过就在不拿这个现眼了，过了就发个更猥琐的    修复方案：  对功能页面加验证，避免信息泄露   版权声明：转载请注明来源 nauscript@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}