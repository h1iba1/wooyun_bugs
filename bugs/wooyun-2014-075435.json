{"id": 51174, "wybug_id": "wooyun-2014-075435", "wybug_title": "互动出版社SQL注入+XSS", "wybug_corp": "china-pub.com", "wybug_author": "lightless", "wybug_date": "2014-09-09 10:37", "wybug_open_date": "2014-10-24 10:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-24：\t细节向公众公开  简要描述： 竟然说我的截图是伪造的。。。 详细说明：  我不知道你们是怎么测试的，导致漏洞没有复现，我也没必要在这里伪造截图骗RANK。首先，SQL注入是一定存在的，http://product.china-pub.com/member/bookpinglun/memberpl.asp?membername=Demonm&bookid=&orderstr=flower'&px=asc&Curpage=1&mtype=&stype=这样都报错了难道还不算复现？反射型的XSS在Firefox下可以正常弹窗，IE默认情况下会拦截，Chrome似乎也有对反射XSS的保护。存储型的XSS是必然存在的。1.SQL注入http://product.china-pub.com/member/bookpinglun/memberpl.asp?membername=Demonm&bookid=&orderstr=flower&px=asc&Curpage=1&mtype=&stype=orderstr参数存在注入漏洞，好像px参数也有，没有测试其他的。\n\n2.反射XSS一枚http://product.china-pub.com/member/bookpinglun/memberpl.asp?membername=%3C/title%3E%3Cscript%3Ealert%28%29%3C/script%3E%3Ctitle%3E直接把<title>标签闭合掉。\n\n3.存储型XSS一枚在用户的个人中心，账户信息中，有个“我的标签”功能，这里限制了字符数量，实际测试可以输入12个字符。\n\n抓到了两个URL：http://member.china-pub.com/member/mypub/Handdle/AddRemark.ashx?mark=<your mark>http://member.china-pub.com/member/mypub/Handdle/DelMarks.ashx?id=1591第一个是增加标签的，第二个是删除标签的。因为只能输入12个字符，我们用多次插入标签的办法绕过限制，构造以下URL，http://member.china-pub.com/member/mypub/Handdle/AddRemark.ashx?mark=<script>/*http://member.china-pub.com/member/mypub/Handdle/AddRemark.ashx?mark=*/alert();/*http://member.china-pub.com/member/mypub/Handdle/AddRemark.ashx?mark=*/</script>想搞cookie的话一样的方法，只不过多添加几个标签就可以了。alert后面的分号是必须的。\n\nchina-pub的链接丢到QQ里可是通过官方认证的，分分钟就搞到cookie了。   漏洞证明：  1.SQL注入http://product.china-pub.com/member/bookpinglun/memberpl.asp?membername=Demonm&bookid=&orderstr=flower&px=asc&Curpage=1&mtype=&stype=orderstr参数存在注入漏洞，好像px参数也有，没有测试其他的。\n\n2.反射XSS一枚http://product.china-pub.com/member/bookpinglun/memberpl.asp?membername=%3C/title%3E%3Cscript%3Ealert%28%29%3C/script%3E%3Ctitle%3E直接把<title>标签闭合掉。\n\n3.存储型XSS一枚在用户的个人中心，账户信息中，有个“我的标签”功能，这里限制了字符数量，实际测试可以输入12个字符。\n\n抓到了两个URL：http://member.china-pub.com/member/mypub/Handdle/AddRemark.ashx?mark=<your mark>http://member.china-pub.com/member/mypub/Handdle/DelMarks.ashx?id=1591第一个是增加标签的，第二个是删除标签的。因为只能输入12个字符，我们用多次插入标签的办法绕过限制，构造以下URL，http://member.china-pub.com/member/mypub/Handdle/AddRemark.ashx?mark=<script>/*http://member.china-pub.com/member/mypub/Handdle/AddRemark.ashx?mark=*/alert();/*http://member.china-pub.com/member/mypub/Handdle/AddRemark.ashx?mark=*/</script>想搞cookie的话一样的方法，只不过多添加几个标签就可以了。alert后面的分号是必须的。\n\nchina-pub的链接丢到QQ里可是通过官方认证的，分分钟就搞到cookie了。   修复方案：     版权声明：转载请注明来源 lightless@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-09-10 10:56 厂商回复： 谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}