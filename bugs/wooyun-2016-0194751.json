{"id": 87121, "wybug_id": "wooyun-2016-0194751", "wybug_title": "大疆某处支付逻辑漏洞可1元买无人机", "wybug_corp": "dji.com", "wybug_author": "锄禾哥", "wybug_date": "2016-04-11 10:01", "wybug_open_date": "2016-05-26 12:20", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-26：\t细节向公众公开  简要描述： 周末实在太懒，不想起床，但是没烟抽了，那个愁啊。心里想着，要是有个无人机去买烟多好。设定个自动航线，和老板说一说，来回多方便。起床就打开了电脑，居然发现大疆的无人机可以编程。摸了摸口袋，锄禾哥被股灾弄的卡内余额一元。那我就斥资巨款一元，买入这台无人机吧！ 详细说明：  首先注册一个大疆的账号，打开大疆的商城，挑选一件商品进入点击购买http://store.dji.com/cn/product/phantom-4然后跳转进入了购买页面https://store.dji.com/cn/buy/checkout?t=bn&i=4231&q=1&bind_care_id=0打开fiddler进行拦截，咿呀，居然不行，证书有强制握手。那试试把https改成http试试呢？居然可以访问\n\n填写完所有信息后，选择【银联】支付 点击提交订单然后选择支付银行。开始拦截https://store.dji.com/cn/transactions/32457360e54d332213645731228b456c此接口有个total的参数，改为1返回了一个支付宝的支付接口，打开支付界面不付款。再次调用此接口，修改total为实际支付金额，然后开始付款\n\n1元大疆到手！   漏洞证明：  \n\n   修复方案：  取消store域的http访问检查付款逻辑。并且check实际金额因为提交乌云失败了，所以重拍了一份@@ 会发货吗？   版权声明：转载请注明来源 锄禾哥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-04-11 12:16 厂商回复： 感谢提交漏洞，已经确认，晚点有工作人员和你联系。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-11 10:03 |    \t\tJuemo \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | Changing)\t\t \n  又是你!    \n     2016-04-11 10:05 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1638 漏洞数:208        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  厉害了，肯定送一台    \n     2016-04-11 10:14 |    \t\t路人毛 \t\t\t( 普通白帽子  |\t\t\t        Rank:131 漏洞数:58        | 要想Rank给高，标题一定得屌)\t\t \n  送一台！！！    \n     2016-04-11 10:22 |    \t\t泡泡堂 \t\t\t( 普通白帽子  |\t\t\t        Rank:605 漏洞数:157        | 学习，学习。。。)\t\t \n  送一架    \n     2016-04-11 10:22 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:94        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  666  求送一台    \n     2016-04-11 10:33 |    \t\tPost \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:12        | seven)\t\t \n  <code>心里想着，要是有个无人机去买烟多好。设定个自动航线，和老板说一说，来回多方便。</code>你猜那个老板会不会把你的无人机拿去卖废品。    \n     2016-04-11 10:43 |    \t\t染血の雪 \t\t\t( 普通白帽子  |\t\t\t        Rank:247 漏洞数:36        | 你挖 或者不挖漏洞就在哪儿不会增加 不...)\t\t \n  牛逼，找过大疆这方面的漏洞，没发现。思路一定很奇特~    \n     2016-04-11 10:56 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:2113 漏洞数:310        | 解决问题的第一步，是要承认问题的存在。)\t\t \n  @专业种田 只要没去他们自己那个官方邮箱提交漏洞 是不会送飞机的    \n     2016-04-11 11:04 |    \t\t’‘Nome \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:31        | 有事请发邮件，2859857@gmail.com，垃圾邮...)\t\t \n  @锄禾哥    抽烟有害健康，尽早戒烟！！！    \n     2016-04-11 11:08 |    \t\tMartial \t\t\t( 普通白帽子  |\t\t\t        Rank:2530 漏洞数:355        | 竟然还有人冒充我，醉了，骗子QQ445697541...)\t\t \n  买了吗    \n     2016-04-11 11:13 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:2566 漏洞数:506        | 我就问，还有谁！！！！！！！！！！！！！...)\t\t \n  又是你！！    \n     2016-04-11 11:46 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1638 漏洞数:208        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  @mango 我挖小漏洞送我电池吧，哈哈    \n     2016-04-11 11:46 |    \t\t锄禾哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:126 漏洞数:20        | <script>alert('我没帽子')</script>)\t\t \n  @mango 已经发货了…不知道到时候会不会当礼物送了 …    \n     2016-04-11 11:48 |    \t\t锄禾哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:126 漏洞数:20        | <script>alert('我没帽子')</script>)\t\t \n  @专业种田 我估计难送给我 我第一次试没记录 第二次试乌云没审过 我拍了三单 估计送给我他们的临时工又要被fire了 哈哈哈…    \n     2016-04-11 12:29 |    \t\t带头大哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:807 漏洞数:245        | |任意邮件伪造| |目录遍历| |任意文件读取|...)\t\t \n  @mango 科斯沃送你礼物没有？我前天提交了也获取了我的联系方式，说发送礼物，并没收到。    \n     2016-04-11 12:41 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:2113 漏洞数:310        | 解决问题的第一步，是要承认问题的存在。)\t\t \n  @带头大哥 送了 不过是后来我私聊了一部分漏洞 才给的 一套烘焙套件    \n     2016-04-11 13:12 |    \t\t锄禾哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:126 漏洞数:20        | <script>alert('我没帽子')</script>)\t\t \n  顺风发货和大姜发货真的快……无人机快递已经到我手上了…… 几乎和漏洞公开时间同步……    \n     2016-04-11 13:13 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:2113 漏洞数:310        | 解决问题的第一步，是要承认问题的存在。)\t\t \n  @锄禾哥 66666  工作人员 跟你联系  估计让你寄回去    \n     2016-04-11 13:32 |    \t\tAgony \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:11        | you know a cat has nine lives.)\t\t \n  6666666    \n     2016-04-11 13:43 |    \t\t白无常 \t\t\t( 实习白帽子  |\t\t\t        Rank:92 漏洞数:11        )\t\t \n  好久没见了 特斯拉呢？    \n     2016-04-11 14:07 |    \t\t锄禾哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:126 漏洞数:20        | <script>alert('我没帽子')</script>)\t\t \n  大姜说申请去了……看直接送给我了……不论申请成功否，太有节操了…………    \n     2016-04-11 17:36 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1638 漏洞数:208        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  @锄禾哥 那你下的单是精灵4还是精灵3    \n     2016-04-12 19:27 |    \t\t锄禾哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:126 漏洞数:20        | <script>alert('我没帽子')</script>)\t\t \n  @专业种田 经委M100 原来顺丰还有这功能 她们和快递联系细节寄回了@@    \n     2016-04-12 19:33 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:2113 漏洞数:310        | 解决问题的第一步，是要承认问题的存在。)\t\t \n  @锄禾哥 最后送你了嘛    \n     2016-05-26 12:25 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:5038 漏洞数:389        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  还是喜欢开着特斯拉去买烟    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}