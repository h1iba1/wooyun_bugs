{"id": 44550, "wybug_id": "wooyun-2015-093002", "wybug_title": "用友某系统通用型远程命令执行", "wybug_corp": "用友软件", "wybug_author": "路人甲", "wybug_date": "2015-01-21 12:12", "wybug_open_date": "2015-04-21 12:14", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-24：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-21：\t细节向公众公开  简要描述： 用友，用友，来三发。 详细说明：  #1U8-MA移动应用（Mobile Application）是为用友U8提供基于手机和PAD的客户端移动应用，拓展和延伸ERP系统的应用时间、场所和人员，可以随时随地访问ERP系统。将单据审批操作扩展到手机上，使得审批可以随时进行，规范了企业的管理流程；将ERP系统中的关键消息及时、快捷、自动地通过手机客户端通知相关人员。#2然而该系统存在一个对外的移动应用管理站点，当然用友内部也在使用该移动应用做为移动审批。其中使用了JBoss做为中间件，版本为JBoss-4.2.3.GA，然而开发人员在系统安装包中集成了invoker/JMXInvokerServlet，并且默认安装后，会对外网开放该接口。该接口存在一处远程命令执行，可远程上传部署war包，导致getshell#3目前已知影响的站点有：\n58.17.217.62:8080 1.202.212.25114.247.34.133:8080 218.84.134.160:8080  60.13.167.26:8080111.205.84.151:8080 111.75.254.143:809058.252.101.161 219.141.185.114219.141.185.102222.189.187.21:8080 119.255.63.19:80801.189.209.34:8080 221.237.157.186 221.230.3.230:8080119.2.10.187m.xhlbdc.com1.202.248.4758.213.23.245:8080 123.125.28.41  124.127.121.54:8080\n#4下面以用友内部使用站点为getshell例子：219.141.185.102\n\n上图为登录移动应用管理站点，在对该系统测试时发现，用友内部默认使用的账号为admin，密码均为111111。\n\n\n\n接口都来了，就不客气了，getshell。#5\n\n\n\n\n\n发现该站点还跑着其他Web站点，也作为内部的数据库。#6内网信息\n主机名:           WIN-PINENM2P32OOS 名称:          Microsoft Windows Server 2008 R2 Enterprise OS 版本:          6.1.7600 暂缺 Build 7600OS 制造商:        Microsoft CorporationOS 配置:          独立服务器OS 构件类型:      Multiprocessor Free注册的所有人:     Windows 用户注册的组织:       产品 ID:          00486-001-0001076-84542初始安装日期:     2012/4/25, 6:59:46系统启动时间:     2014/10/15, 15:21:52系统制造商:       VMware, Inc.系统型号:         VMware Virtual Platform系统类型:         x64-based PC处理器:           安装了 8 个处理器。                  [01]: Intel64 Family 6 Model 37 Stepping 1 GenuineIntel ~2533 Mhz                  [02]: Intel64 Family 6 Model 37 Stepping 1 GenuineIntel ~2533 Mhz                  [03]: Intel64 Family 6 Model 37 Stepping 1 GenuineIntel ~2533 Mhz                  [04]: Intel64 Family 6 Model 37 Stepping 1 GenuineIntel ~2533 Mhz                  [05]: Intel64 Family 6 Model 37 Stepping 1 GenuineIntel ~2533 Mhz                  [06]: Intel64 Family 6 Model 37 Stepping 1 GenuineIntel ~2533 Mhz                  [07]: Intel64 Family 6 Model 37 Stepping 1 GenuineIntel ~2533 Mhz                  [08]: Intel64 Family 6 Model 37 Stepping 1 GenuineIntel ~2533 MhzBIOS 版本:        Phoenix Technologies LTD 6.00, 2013/7/30Windows 目录:     C:\\Windows系统目录:         C:\\Windows\\system32启动设备:         \\Device\\HarddiskVolume1系统区域设置:     zh-cn;中文(中国)输入法区域设置:   zh-cn;中文(中国)时区:             (UTC+08:00)北京，重庆，香港特别行政区，乌鲁木齐物理内存总量:     16,384 MB可用的物理内存:   13,129 MB虚拟内存: 最大值: 32,765 MB虚拟内存: 可用:   22,258 MB虚拟内存: 使用中: 10,507 MB页面文件位置:     D:\\pagefile.sys域:               WORKGROUP登录服务器:       \\\\WIN-PINENM2P32O修补程序:         安装了 3 个修补程序。                  [01]: KB2621440                  [02]: KB2667402                  [03]: KB958488网卡:             安装了 1 个 NIC。                  [01]: Intel(R) PRO/1000 MT Network Connection                      连接名:      本地连接                      启用 DHCP:   否                      IP 地址                        [01]: 10.10.5.229                        [02]: fe80::201e:c638:365c:79eb\n   漏洞证明：  #1U8-MA移动应用（Mobile Application）是为用友U8提供基于手机和PAD的客户端移动应用，拓展和延伸ERP系统的应用时间、场所和人员，可以随时随地访问ERP系统。将单据审批操作扩展到手机上，使得审批可以随时进行，规范了企业的管理流程；将ERP系统中的关键消息及时、快捷、自动地通过手机客户端通知相关人员。#2然而该系统存在一个对外的移动应用管理站点，当然用友内部也在使用该移动应用做为移动审批。其中使用了JBoss做为中间件，版本为JBoss-4.2.3.GA，然而开发人员在系统安装包中集成了invoker/JMXInvokerServlet，并且默认安装后，会对外网开放该接口。该接口存在一处远程命令执行，可远程上传部署war包，导致getshell#3目前已知影响的站点有：\n58.17.217.62:8080 1.202.212.25114.247.34.133:8080 218.84.134.160:8080  60.13.167.26:8080111.205.84.151:8080 111.75.254.143:809058.252.101.161 219.141.185.114219.141.185.102222.189.187.21:8080 119.255.63.19:80801.189.209.34:8080 221.237.157.186 221.230.3.230:8080119.2.10.187m.xhlbdc.com1.202.248.4758.213.23.245:8080 123.125.28.41  124.127.121.54:8080\n#4下面以用友内部使用站点为getshell例子：219.141.185.102\n\n上图为登录移动应用管理站点，在对该系统测试时发现，用友内部默认使用的账号为admin，密码均为111111。\n\n\n\n接口都来了，就不客气了，getshell。#5\n\n\n\n\n\n发现该站点还跑着其他Web站点，也作为内部的数据库。#6内网信息\n主机名:           WIN-PINENM2P32OOS 名称:          Microsoft Windows Server 2008 R2 Enterprise OS 版本:          6.1.7600 暂缺 Build 7600OS 制造商:        Microsoft CorporationOS 配置:          独立服务器OS 构件类型:      Multiprocessor Free注册的所有人:     Windows 用户注册的组织:       产品 ID:          00486-001-0001076-84542初始安装日期:     2012/4/25, 6:59:46系统启动时间:     2014/10/15, 15:21:52系统制造商:       VMware, Inc.系统型号:         VMware Virtual Platform系统类型:         x64-based PC处理器:           安装了 8 个处理器。                  [01]: Intel64 Family 6 Model 37 Stepping 1 GenuineIntel ~2533 Mhz                  [02]: Intel64 Family 6 Model 37 Stepping 1 GenuineIntel ~2533 Mhz                  [03]: Intel64 Family 6 Model 37 Stepping 1 GenuineIntel ~2533 Mhz                  [04]: Intel64 Family 6 Model 37 Stepping 1 GenuineIntel ~2533 Mhz                  [05]: Intel64 Family 6 Model 37 Stepping 1 GenuineIntel ~2533 Mhz                  [06]: Intel64 Family 6 Model 37 Stepping 1 GenuineIntel ~2533 Mhz                  [07]: Intel64 Family 6 Model 37 Stepping 1 GenuineIntel ~2533 Mhz                  [08]: Intel64 Family 6 Model 37 Stepping 1 GenuineIntel ~2533 MhzBIOS 版本:        Phoenix Technologies LTD 6.00, 2013/7/30Windows 目录:     C:\\Windows系统目录:         C:\\Windows\\system32启动设备:         \\Device\\HarddiskVolume1系统区域设置:     zh-cn;中文(中国)输入法区域设置:   zh-cn;中文(中国)时区:             (UTC+08:00)北京，重庆，香港特别行政区，乌鲁木齐物理内存总量:     16,384 MB可用的物理内存:   13,129 MB虚拟内存: 最大值: 32,765 MB虚拟内存: 可用:   22,258 MB虚拟内存: 使用中: 10,507 MB页面文件位置:     D:\\pagefile.sys域:               WORKGROUP登录服务器:       \\\\WIN-PINENM2P32O修补程序:         安装了 3 个修补程序。                  [01]: KB2621440                  [02]: KB2667402                  [03]: KB958488网卡:             安装了 1 个 NIC。                  [01]: Intel(R) PRO/1000 MT Network Connection                      连接名:      本地连接                      启用 DHCP:   否                      IP 地址                        [01]: 10.10.5.229                        [02]: fe80::201e:c638:365c:79eb\n   修复方案：  1.删除接口2.限制访问   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2015-01-21 12:43 厂商回复： 也经提过了，不要重复提 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-24 17:16 |    \t\t蛇精病 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:10        | 你连棒棒糖都没有，还谈什么狗屁爱情？)\t\t \n  也经提过了，不要重复提    \n     2015-01-26 08:49 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  也经提过了，不要重复提。 审核哥啥情况？@疯狗    \n     2015-02-04 20:24 |    \t\tf4ck \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:7        | 有些人很牛B，一个漏洞能刷成N个。)\t\t \n  厂商也太小气了吧，才1个rank，@疯狗，@xsser    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}