{"id": 55345, "wybug_id": "wooyun-2014-061267", "wybug_title": "Iwebsns sql 第五枚。", "wybug_corp": "Jooyea", "wybug_author": "′雨。", "wybug_date": "2014-05-19 00:32", "wybug_open_date": "2014-08-17 00:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-19：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-08-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 过滤不严格。 详细说明：  在action/msgscript/msg_del.action.php中\n$msg_id=intval(get_argg(\"id\"));\t$user_uid=get_sess_userid();\t$del_array=get_argp(\"attach\");\t\t//数据表定义区\t$t_msg_inbox = $tablePreStr.\"msg_inbox\";\t$t_msg_outbox = $tablePreStr.\"msg_outbox\";\t$dbo = new dbex;\t//读写分离定义函数\tdbtarget('w',$dbServs);\tif($del_array==NULL){\t\t$del_array[]=$msg_id;\t}    \tforeach($del_array as $rs){\t\t$rs=short_check($rs);\t\tif(get_argg(\"t\")==\"0\"){\t\t   $sql=\"delete from $t_msg_inbox where mess_id=$rs and user_id=$user_uid\";\t\t   echo $sql;exit;\n这里对$del_array循环出来后 用short_check过滤。short_check 只是做一个addslashes 和 过滤#这里是没有被单引号的。 所以轻松注入。    漏洞证明：  \n\n\n\n   修复方案：  单引号。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}