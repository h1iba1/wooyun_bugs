{"id": 62481, "wybug_id": "wooyun-2013-035495", "wybug_title": "本地命令执行-金山毒霸2013", "wybug_corp": "金山毒霸", "wybug_author": "8th", "wybug_date": "2013-09-02 14:02", "wybug_open_date": "2013-12-01 14:03", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "低", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-10-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-01：\t细节向公众公开  简要描述： 金山毒霸客户端程序设计中一处错误导致可以在本地任意命令执行 详细说明：  Window规定如果传入CreateProcess函数的启动程序名称和参数中包含空格，那么这些名称和参数在传入之前必须用双引号””进行包含，比如c:/program files/sub dir/program name，如果程序中不使用””对文件名和参数包含，系统可能会产生歧异，造成多种解释的存在(如图黑体部分为可执行程序名称，而细体部分为参数)：\n\n金山毒霸（悟空）SP4.5客户端在启动子进程（如ksafesvc.exe）的时候使使用了CreateProcess函数 但是未将路径用双引号包含，因此导致本地命令执行。金山毒霸默认安装在c:\\\\program files目录下 如果在安装盘的根目录写入一个program.exe。启动子进程时， CreateProcess函数将会启动根目录下的program.exe 而非安装目录下的ksafesvc.exe   漏洞证明：  c盘根目录写入文件\n\n漏洞证明截图：\n\n\n\n   修复方案：  对传入CreateProcess函数的文件名称和参数使用双引号””进行包含   版权声明：转载请注明来源 8th@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-09-03 09:25 厂商回复： 收到，非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}