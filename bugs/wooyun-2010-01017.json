{"id": 23729, "wybug_id": "wooyun-2010-01017", "wybug_title": "TaoBao.Com几处上传过滤不严", "wybug_corp": "淘宝网", "wybug_author": "dbgger", "wybug_date": "2010-12-24 20:01", "wybug_open_date": "2010-12-29 21:00", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["淘宝风险", "风险", "文件上传导致", "应用安全", "文件上传安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-12-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2010-12-29：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 对swf上传没有严格限制.导致可以向主域名内上传swf文件. 详细说明：  swf上传的危害太大.这里不多做解释.另外.有几处fck.仍然可以上传伪装成png的swf.(不管扩展名是什么.只要加上flash标签,都可以执行flash脚本)   漏洞证明：  http://tianxia.taobao.com/uploadfile/2010/1222/20101222101004357.swf<embed height=\"150\" width=\"950\" type=\"application/x-shockwave-flash\" src=\"http://tianxia.taobao.com/uploadfile/2010/1224/20101224072517201.png\" quality=\"high\" allowscriptaccess=\"always\" wmode=\"transparent\"/>http://www.tbtianxia.com/attachment.php?&action=upload&module=phpcms&from=fckeditor&id=2&dosubmit=23&MM_objid=contenthttp://design.taobao.com/shop/designShop.htm?action=page/TagAction&event_submit_do_upLoadFlashBanner=true&userId=xxxx&flashPath=http://img.uu1001.cn/materials/original/2010-06-14/12-29/11111111111111111111.png&flash_sid=000000000&productId=0000&sign=xxxxxxxxxxxxxxxxxxxxxx&http://banner.alimama.com/wangpu/apply_design?coop_id=superwangpu&flash_path=http://img.uu1001.cn/materials/original/2010-06-14/12-29/11111111111111111111.png&ad_board_id=111111111&templet_id=11111&person_id=111111&is_ordered=0&is_b2c=0&apt=aboard这里个人敏感数据我替换掉.怕被社工.另外,店铺后台这里.flashpath= 可以随便应用.当然是跨不出img.uu1001.cn的.但是经过测试.flashpath= pic url后面,&结束前 依然可以注入代码.还有一点,实在搞不懂,为什么店铺后台那里,完全都是get操作.而且基本都是明文.   修复方案：  重画函数.文件类型严格检测   版权声明：转载请注明来源 dbgger@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2010-12-29 21:00 厂商回复：  漏洞Rank：9  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2010-12-31 01:18 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  很给力 哈哈    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}