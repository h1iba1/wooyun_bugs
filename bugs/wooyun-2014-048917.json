{"id": 4834, "wybug_id": "wooyun-2014-048917", "wybug_title": "Dedecms 注入漏洞9", "wybug_corp": "Dedecms", "wybug_author": "Matt", "wybug_date": "2014-01-14 18:52", "wybug_open_date": "2014-04-14 18:53", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-17：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-14：\t细节向公众公开  简要描述： Dedecms 注入漏洞9 详细说明：  \nelse if($action=='save'){    if(!empty($_COOKIE['GUEST_BOOK_POS'])) $GUEST_BOOK_POS = $_COOKIE['GUEST_BOOK_POS'];    else $GUEST_BOOK_POS = 'guestbook.php';    if(empty($validate)) $validate=='';    else $validate = strtolower($validate);    $svali = GetCkVdValue();    if($validate=='' || $validate!=$svali)    {         ShowMsg(\"验证码不正确!\",\"\");         exit();    }    $ip = GetIP();    $dtime = time();    $uname = trimMsg($uname);    $email = trimMsg($email);    $homepage = trimMsg($homepage);    $homepage = preg_replace(\"#http:\\/\\/#\", '', $homepage);    $qq = trimMsg($qq);    $msg = trimMsg(cn_substrR($msg, 1024), 1);    $tid = empty($tid) ? 0 : intval($tid);    $reid = empty($reid) ? 0 : intval($reid);    if($msg=='' || $uname=='') {        showMsg('你的姓名和留言内容不能为空!','-1');        exit();    }    $title = HtmlReplace( cn_substrR($title,60), 1 );    if($title=='') $title = '无标题';        if($reid != 0)    {        $row = $dsql->GetOne(\"SELECT msg FROM `#@__guestbook` WHERE id='$reid' \");        $msg = \"<div class=\\\\'rebox\\\\'>\".addslashes($row['msg']).\"</div>\\n\".$msg;    }    $query = \"INSERT INTO `#@__guestbook`(title,tid,mid,uname,email,homepage,qq,face,msg,ip,dtime,ischeck)                  VALUES ('$title','$tid','{$g_mid}','$uname','$email','$homepage','$qq','$img','$msg','$ip','$dtime','$needCheck'); \";\t\t\t\t  echo $query;//img没有过滤    $dsql->ExecuteNoneQuery($query);    $gid = $dsql->GetLastID();\n   漏洞证明：  测试方法127.0.0.1/dede/plus/guestbook.php?action=save&validate=scuf&msg=1&uname=1&img=111'吧SCUF改成你自己的验证码就哦了 我就不写exp了。。我没安装留言~\n\n   修复方案：  你猜   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2014-01-14 22:24 厂商回复： 已修复，感谢反馈 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-14 19:01 |    \t\t漫步云端 \t\t\t( 普通白帽子  |\t\t\t        Rank:196 漏洞数:33        | I'm Ramble!)\t\t \n  这是连载到多少。    \n     2014-01-14 19:16 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  有10 J Q K A吗？    \n     2014-01-14 19:23 |    \t\tStranger \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 我注意你很久了.....)\t\t \n  我要关注你    \n     2014-01-14 19:28 |    \t\t404 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        )\t\t \n  这是要火啊    \n     2014-01-14 19:47 |    \t\t走火入魔 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:2        | 多读书，多看报，少吃零食，多睡觉。)\t\t \n  要火啊     \n     2014-01-14 20:03 |    \t\tYinkan \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 码农)\t\t \n  单单看标题就觉得菊花一紧。    \n     2014-01-14 22:01 |    \t\twhirlwind \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:8        | 极光肖风)\t\t \n   大牛膜拜~楼下是2B    \n     2014-04-16 09:28 |    \t\t大大怪 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | PHP 爱好者)\t\t \n  php 5.2 就没办法了。 5.3 默认取消了自动转义 引号带来的不少问题。     \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}