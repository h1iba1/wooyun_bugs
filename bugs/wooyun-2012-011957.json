{"id": 16824, "wybug_id": "wooyun-2012-011957", "wybug_title": "微信找回密码短信无限发", "wybug_corp": "腾讯", "wybug_author": "popok", "wybug_date": "2012-09-10 01:20", "wybug_open_date": "2012-10-25 01:20", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-09-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-09-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-10-25：\t细节向公众公开  简要描述： 微信找回密码发送短信限制不严，导致可以无限发送，导致短信轰炸 详细说明：  发送短信的数据：\nPOST /cgi-bin/mmsupport-bin/getresetpwdurl HTTP/1.1Host: support.weixin.qq.comConnection: keep-aliveContent-Length: 85Cache-Control: max-age=0Origin: http://support.weixin.qq.comUser-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/535.19 (KHTML, like Gecko) Chrome/18.0.1025.152 Safari/535.19 CoolNovo/2.0.3.55Content-Type: application/x-www-form-urlencodedAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Referer: http://support.weixin.qq.com/cgi-bin/mmsupport-bin/readtemplate?uin=&stype=&promote=&fr=&lang=zh_CN&ADTAG=&check=false&t=w_password_phone&method=mobileAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Accept-Charset: GBK,utf-8;q=0.7,*;q=0.3Cookie: **********lang=zh_CN&t=w_password_phone&method=wait&getmethod=web&country=A86&phone=180********\n发送10条左右，就会提示号码对正确，看来后台有记数。这时手机号后面随便加一个非数字符号，就能继续发送。看来后台记数的时候没有对号码做验证，直接对post过来的号码记数了，但是发送的时候正则匹配了正确的号码，所以虽然加了符号，还是可以正常收到。   漏洞证明：  手机截图麻烦，不证明   修复方案：  记数时先验证一下号码   版权声明：转载请注明来源 popok@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2012-09-10 16:12 厂商回复： 感谢反馈，我们正在跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-09-10 07:44 |    \t\tEoh \t\t\t( 普通白帽子  |\t\t\t        Rank:286 漏洞数:35        )\t\t \n  有时间限制的把,我前几天测试过,10几条后就 有限制了,提示号码不存在?     \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}