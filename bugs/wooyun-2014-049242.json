{"id": 5626, "wybug_id": "wooyun-2014-049242", "wybug_title": "甘肃移动神州行卡利用10086网站认证和边界漏洞开通5元包8G流量卡，最高可达32G流量", "wybug_corp": "中国移动通信集团甘肃移动公司", "wybug_author": "berman", "wybug_date": "2014-01-19 09:41", "wybug_open_date": "2014-03-05 09:42", "wybug_type": "账户体系控制不严", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-05：\t细节向公众公开  简要描述： 甘肃移动神州行卡，利用10086网站业务开通认证漏洞，开通8G流量，最高可叠加流量达32G，并可利用系统边界漏洞，造成5元包8G 或 5元包32G流量 详细说明：  首先准备一张甘肃神州行卡（如畅听卡），确保未开通任何GPRS套餐，且话费余额保持大于16元。然后凭手机号码和服务密码登录甘肃移动官方网站办理手机上网套餐，地址是http://www.gs.10086.cn/service/obsh.html#GPRSTC登录后总共有5元～200元共七档<移动数据业务套餐>可以办理，例如办理100元包2G上网流量，办理的时候选择生效方式为【次月】，然后点开通，会提示需要确认，此时再打开一个浏览器窗口登录同样的网址，选择办理100元包2G上网流量，次月生效，点开通，弹出确认提示。重复同样步骤打开5个浏览器窗口，然后逐一点确定办理，均提示办理成功。\n\n\n\n然后在甘肃掌上营业厅的【在用业务】可查询到，次月叠加生效了四个100元包2G流量套餐（测试发现同一档套餐最高只能叠加四次），也就是有8G流量，掌厅查询地址是http://wap.gs.10086.cn/page.do?page=CX_ZYYW&busiNum=CX_ZYYW&reqHandle=queryHandle\n\n接着将其他六档数据流量套餐按照以上步骤 叠加办理次月生效，即(30M + 70M + 150M + 280M + 500M + 2G + 5G)×4 = 8198M ×4 = 32792M （32G流量）实际使用中因移动系统有15G封顶限制，所以即使同一套餐不叠加，也有8198M（8G流量）在办理好次月生效的流量后，取消GPRS功能，再进入停机保号地址http://www.gs.10086.cn/service/obsh.html#TJBH预备办理停机保号，确认停机的同时，网页同时确认开通GPRS功能，均提示办理成功。因系统认证和边界漏洞造成停机仍可以上网。重启手机，上网正常，但不能拨打电话和发送短信。等待次月1日流量生效后，流量套餐费均不扣取，仅扣取5元停机保号费，造成5元包8G流量或5元包30G流量。   漏洞证明：  \n\n\n\n   修复方案：  同一档次和不同档次流量套餐套餐需互斥。否则同一档次和不同档次流量套餐会叠加，造成重复扣费和赠送流量，同时会导致流量加油包业务失去意义。且在办理停机业务是应设定业务指令锁定时间，需在该指令处理完毕后方可处理下一个指令，以避免边界绕过漏洞。   版权声明：转载请注明来源 berman@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-01-23 08:28 厂商回复： CNVD未直接复现，已经转报给中国移动集团公司处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-20 01:21 |    \t\tJany \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 宅女一枚。。很宅的宅女。)\t\t \n  移动这次一定修复的很快。    \n     2014-01-23 10:04 |    \t\t麻花藤 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | ด้้้้้็็็็็้้้้้็็็็...)\t\t \n  移动，你还好吗    \n     2014-03-05 10:46 |    \t\tNeeke \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:24        | 求传授刷Rank方法？)\t\t \n  吊    \n     2014-03-05 11:12 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  goingdown    \n     2014-03-05 12:26 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @berman  撸主 你晓得你惹众怒了   奴晓得吧    \n     2014-03-05 12:35 |    \t\t路易崽 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:3        | 各种游荡中~)\t\t \n  移动的龟速下流量用的爽吧    \n     2014-03-05 18:46 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  吊啊！    \n     2014-03-09 13:53 |    \t\t专业查水表 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:5        | \"><script>alert(/我是\"J.L\"的大号/);</scr...)\t\t \n  就这网速开个100G都没用    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}