{"id": 16656, "wybug_id": "wooyun-2015-0131776", "wybug_title": "易自驾某站高权限sql注入导致主站和bbs被控（可内网渗透）", "wybug_corp": "北京天下游信息技术有限公司", "wybug_author": "littelfire", "wybug_date": "2015-08-05 15:33", "wybug_open_date": "2015-09-19 15:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-05：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-09-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 易自驾中旅总社出境自驾游唯一战略合作伙伴，易自驾（原名图途网）诞生于2013年骄阳似火的夏天，致力于打造国内一流的一站式境外自驾旅游服务平台，是由北京天下游信息技术有限公司运营的。我们将结合直观明了的GIS地图系统为您进行行程制作，并提供强大的资讯支持及专业的团队服务为您解决自驾旅行过程中涉及的所有问题，以期达到让您安全愉快出行的目的。 详细说明：  原网站图途网存在sql注入，通过注入可执行命令，该数据库服务器和主站为同一台服务器，通过命令执行，可获取主站和bbs控制权限。   漏洞证明：  注入连接：http://www.tourtour.com.cn:80/main/userSetting/JourShowForCT.aspx?userId=337&id=85392注入点是id\nParameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: userId=337&id=85392 AND 8815=8815    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: userId=337&id=85392;WAITFOR DELAY '0:0:5'--\n为dba权限sqlserver注入\n\n跑了一下dbs有很多数据在里面\n\n看到一个和中国国旅相关的数据库，跑了一下数据验证\n\n\n\n可直接利用--os-cmd进行命令执行\n\n利用命令执行可以直接给激活服务器guest用户添加权限，通过ipconfig可找到其开放了公网ip210.14.156.104该地址指向主站易自驾\n\n该服务器还开启了3389，直接用guest连过去\n\n看了下网络配置是公网内网双网卡。。。。。在该服务器上还可找到其bbs的源码和mysql数据库的配置文件\n\n\n\n利用服务器上的navicat可连接mysql查看相关数据\n\n\n\n   修复方案：  做好过滤。。。   版权声明：转载请注明来源 littelfire@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}