{"id": 12116, "wybug_id": "wooyun-2013-025745", "wybug_title": "新网数码三个重要分站可拿shell", "wybug_corp": "新网华通信息技术有限公司", "wybug_author": "Finger", "wybug_date": "2013-06-12 17:19", "wybug_open_date": "2013-06-17 17:20", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 新网数码三个重要分站可拿shell，涉及域名管理、注册的重要接口。 详细说明：  漏洞很低级，对安全重视一些即可避免。FCKeditor任意文件上传新网主站出现过FCKeditor的漏洞、代理商的网站系统也出现过FCKeditor漏洞，可见新网的很多web系统是用FCKeditor编辑器的那么其他分站是不是也存在这种漏洞呢？这里我们看下http://qqmail.xinnet.comhttp://qqmail.xinnet.com/FCKeditor/editor/filemanager/browser/default/browser.html?type=File&connector=connectors/jsp/connector很不幸 返回状态是404那么是不是qqmail.xinnet.com就不是使用FCKeditor呢？我们继续看 于是发现了：http://qqmail.xinnet.com/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector返回HTTP Status 500 很明显 文件是存在的新网应该是对FCKeditor的问题做过考虑的那这样我们是不是就无法利用了呢？不是的 我们可以本地构建个表单向http://qqmail.xinnet.com/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector提交但事实上不用这么麻烦后来我又发现了这个http://qqmail.xinnet.com/Modules/common/components/FCKeditor/editor/filemanager/browser/default/browser.html?type=File&connector=connectors/jsp/connector当然 这个url是不对的\n\n因为connectors/jsp/connector这个路径是错误的正确的url:http://qqmail.xinnet.com/Modules/common/components/FCKeditor/editor/filemanager/browser/default/browser.html?type=File&connector=../../../../../../../../FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector到这里我们就可以上传任意文件了传个helloworld吧\n<HTML><HEAD><TITLE>HelloWorld!</TITLE></HEAD><BODY><%out.println(\"<h1>Hello World!<br>世界，你好！</h1>\");%></BODY></HTML>\n其他的还有：http://sinamail.xinnet.com/Modules/common/components/FCKeditor/editor/filemanager/browser/default/browser.html?type=File&connector=../../../../../../../../FCKeditor/editor/filemanager/browser/default/connectors/jsp/connectorhttp://api.xinnet.com/Modules/common/components/FCKeditor/editor/filemanager/browser/default/browser.html?type=File&connector=../../../../../../../../FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector   漏洞证明：  \n\n\n\nQQ域名邮箱管理系统、新浪域名邮箱管理系统、代理商的域名管理、注册的api、代理系统上传shell之后 可以做很多的 里面有新网一些数据库连接信息（虽然是内网地址，但我们还是可以连接的） 新网代理商的api权限还是很大的   修复方案：     版权声明：转载请注明来源 Finger@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-06-17 17:20 厂商回复：  漏洞Rank：10  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-15 00:28 |    \t\t射不出来 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:4        | 我是来混的...)\t\t \n  这是跟新网有仇？    \n     2013-06-17 22:08 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  这种厂商。。大家怎么看。？    \n     2013-06-18 01:38 |    \t\tRa1nker \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | TeST)\t\t \n  @蟋蟀哥哥 我用快播看    \n     2013-06-18 14:53 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:170        | 力不从心)\t\t \n  忽略并全部删除。洞主啊，留着自己玩吧，何必呢    \n     2013-07-24 13:51 |    \t\t农夫娃哈哈 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | 初来乍到 请多关照)\t\t \n  不地道    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}