{"id": 15436, "wybug_id": "wooyun-2012-014777", "wybug_title": "苏宁招行分期付款信用卡支付漏洞", "wybug_corp": "江苏苏宁易购电子商务有限公司", "wybug_author": "Doom-s小菜", "wybug_date": "2012-11-14 18:00", "wybug_open_date": "2012-12-29 18:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-12-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-12-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-29：\t细节向公众公开  简要描述： 某宁分期付款，招行付款没签名sign，没加密，可以修改价格。 详细说明：  \n\n\n\n\n\n\n\n   漏洞证明：  \n\n\n\n\n\n   修复方案：  签名，加密，难道招行没给文档吗？   版权声明：转载请注明来源 Doom-s小菜@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2012-11-15 14:12 厂商回复： 感谢Doom-s小菜的提交，经过沟通，我们了解到目前招行提供的分期接口确实存在没有签名字段，数据可被篡改的问题。此类被篡改过的订单，是无法通过支付成功的校验，页面显示的状态错误，是订单中心显示问题，不会造成错误发货的风险。为了减少犯罪分子的可乘之机，会在近期联系银行提供有较高安全机制的接口版本，并在最近版本发布上线。rank5以示对白帽子的鼓励，感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n          这些评论似乎很乌云~~~思密达          2012-11-20 11:39 |\t\t\t\t\txsser  \t\t\t( 普通白帽子  | \t\t\t\t\t\tRank:254 漏洞数:18\t\t\t| 当我又回首一切,这个世界会好吗?)\t\t\t\t\t\t\t\n  非常感谢招商银行对问题的重视：1.我行分期支付接口支持对订单进行签名和不签名两种支付方式，如果商户选择后者，则则银行不会验证签名来防止订单篡改。从该案件来看，应该是商户选择了不签名的方式，导致银行未验证签名。 2.我们的文档中明确说明，“商户必须判断通知数据中各字段的值，通知中的数据才是用户实际支付的数据，一定要以此数据为准，而不能以之前商户系统产生定单时的数据为准！这是为了防止用户在支付过程中修改金额等支付数据”，黑客虽然可以更改订单金额，但无法修改通知金额，从该案件来看，商户接收到通知后，未对支付订单进行任何数据核对。 3.由于黑客可能在用户提交支付前（商户页面上）篡改订单信息，即使使用订单签名的方式也无法防范，要防范这一点，商户需在支付完成后与银行进行核对，以获取最终完成的支付订单的真实信息。   这对于其他的可能存在问题的厂商这也是一个很重要的信息    \n   \n \n     2012-11-14 18:56 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  　真发货了？    \n     2012-11-14 19:33 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  等待补款？    \n     2012-11-14 19:45 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  我去。。这个有看点。。    \n     2012-11-14 20:03 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @鬼魅羊羔 @xsser @风萧萧 你们觉得这个能成？    \n     2012-11-14 20:39 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @zzR 亲，你指的是？    \n     2012-11-14 20:45 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @zzR 你买个0.01元的试试，肯定不发    \n     2012-11-14 20:52 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @小胖胖要减肥 要是能发货我愿意付款0.1元    \n     2012-11-14 20:54 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @鬼魅羊羔 有个叫风萧萧的早就测试过了吧'只是这个问题••••••    \n     2012-11-14 23:08 |    \t\tat0xm \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:2        | I love Chao)\t\t \n  @Doom-s小菜 呵呵    \n     2012-11-15 08:56 |    \t\tyhoojj \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        | BurNing)\t\t \n  @Doom-s小菜 洞主能够现身说法，看看订单什么状态呢？    \n     2012-11-15 09:18 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @xsser 我有个用户很多很多，厂商很巨大的积分兑换，我点了几种方式……几样东西都发货了……我我我都不敢报wooyun了～是积分+现金方式的，测试了三种支付漏洞，结果发了两样实物礼品，一种虚拟礼品    \n     2012-11-15 09:26 |    \t\tzidane \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:2        | 噢 乖，你们应该明白 这样下去对我们谁都不...)\t\t \n  详细讲讲吧    \n     2012-11-15 14:10 |    \t\tDoom-s小菜 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | http://<script> alert(document.cookie); ...)\t\t \n  @zzR @xsser 怕被跨省，不敢支付，价钱就直接可改而已。最后一张图片是ps的，希望引起厂商重视。o(∩_∩)o 哈哈~    \n     2012-11-15 14:14 |    \t\t江苏苏宁易购电子商务有限公司(乌云厂商)\t\t \n  @Doom-s小菜 我们尊重白帽子的贡献，也希望白帽子如实提交问题，谢谢    \n     2012-11-15 14:20 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @江苏苏宁易购电子商务有限公司 好专业！    \n     2012-11-15 14:23 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @江苏苏宁易购电子商务有限公司 @Doom-s小菜 坑爹呢？需要封杀账号么？  @疯狗    \n     2012-11-15 14:37 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xsser 。。。。。那么凶残      \n     2012-11-15 14:38 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @xsser 顶~    \n     2012-11-16 12:35 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @xsser @江苏苏宁易购电子商务有限公司 @Doom-s小菜 漏洞信息居然PS，过分了啊。。    \n     2012-11-16 13:10 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  V5    \n     2012-11-20 11:39 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  非常感谢招商银行对问题的重视：1.我行分期支付接口支持对订单进行签名和不签名两种支付方式，如果商户选择后者，则则银行不会验证签名来防止订单篡改。从该案件来看，应该是商户选择了不签名的方式，导致银行未验证签名。 2.我们的文档中明确说明，“商户必须判断通知数据中各字段的值，通知中的数据才是用户实际支付的数据，一定要以此数据为准，而不能以之前商户系统产生定单时的数据为准！这是为了防止用户在支付过程中修改金额等支付数据”，黑客虽然可以更改订单金额，但无法修改通知金额，从该案件来看，商户接收到通知后，未对支付订单进行任何数据核对。 3.由于黑客可能在用户提交支付前（商户页面上）篡改订单信息，即使使用订单签名的方式也无法防范，要防范这一点，商户需在支付完成后与银行进行核对，以获取最终完成的支付订单的真实信息。   这对于其他的可能存在问题的厂商这也是一个很重要的信息    \n     2012-11-20 15:41 |    \t\t江苏苏宁易购电子商务有限公司(乌云厂商)\t\t \n  @xsser 感谢xsser以及WooYun  对于银行的回复，我们已经通知到公司相关部门，并且与招行取得有效沟通，将于近期升级解决此类问题。再者，支付问题在这里总算有了一个很好的解释:）    \n     2012-11-20 15:44 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @江苏苏宁易购电子商务有限公司 如果招商银行能够下次有技术人员参与进来讨论就非常棒了 :)    \n     2012-11-20 15:52 |    \t\t江苏苏宁易购电子商务有限公司(乌云厂商)\t\t \n  @xsser 那必是极好的~    \n     2012-12-29 18:44 |    \t\twugui \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:4        | wugui@lcx.cc)\t\t \n  你妈。。 付款了。 发货了、    \n     2012-12-29 22:21 |    \t\tZedeX \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:3        | zx)\t\t \n  @wugui 截图或者拍照留念或者单发一个漏洞吧？这不仅是技术漏洞更是企业流程漏洞了。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}