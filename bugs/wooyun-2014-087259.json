{"id": 48785, "wybug_id": "wooyun-2014-087259", "wybug_title": "威锋网某处配置不当导致邮件随机泄露（密码重置连接泄漏）", "wybug_corp": "weiphone", "wybug_author": "鸟云厂商", "wybug_date": "2014-12-15 17:29", "wybug_open_date": "2014-12-16 21:37", "wybug_type": "应用配置错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-16：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 威锋网某处配置不当导致邮件随机泄露（密码重置连接泄漏） 详细说明：  http://edm.feng.com/这个是威锋网的邮件群发系统在根目录下有个aaa.txt  http://edm.feng.com/aaa.txt这个txt文件不是固定的，而是随着邮件发送，不断变化。简单地说就是把发送邮件的记录写入到这里\n\n随时打开都能看到例如：\nINSERT INTO `mail_deliver_log_queue` (did,ip,msgid,code,email,cid,domain,mx,cmd,reason,is_retry,add_time) VALUES ('855785','162.209.149.40','3552','250','120727698@qq.com','1920847','delivery_tencent','mx1.qq.com','/www/client/sendEmail -f \\\\\\\"=?utf-8?B?5aiB6ZSL572R?= <edm@weiphone.com>\\\\\\\" -t 120727698@qq.com -u \\\\\\\"=?utf-8?B?cWl1amluZ2h1YSDlnKjlqIHplIvnvZHkv67mlLnnmbvlvZXlr4bnoIHmiJDlip/noa7orqTkv6E=?=\\\\\\\" -m \\\\\\\"PCFkb2N0eXBlIGh0bWw+IAo8aHRtbD4gCjxoZWFkPiAKICAgIDxtZXRhIGNoYXJzZXQ9InV0Zi04Ij4gCiAgICA8dGl0bGU+5L+u5pS555m75b2V5a+G56CB5oiQ5YqfLeWogemUi+eUqOaIt+S4reW/gzwvdGl0bGU+IAo8L2hlYWQ+Cjxib2R5ID4KCTxkaXYgIHN0eWxlPSIgZmxvYXQ6bGVmdDsgYmFja2dyb3VuZC1jb2xvcjogI2U1ZWFmMTsgZm9udDoxNHB4LzEuNyB0YWhvbWEsYXJpYWwsJ0hpcmFnaW5vIFNhbnMgR0InLCdcNWI4Ylw0ZjUzJyxzYW5zLXNlcmlmOyB3aWR0aDoxMDAlOyBoZWlnaHQ6MTAwJTsiPgoJCTxkaXYgc3R5bGU9IiBjb2xvcjojNjY2OyBmb250LXNpemU6MTRweDsgbWFyZ2luOjAgYXV0bzsgd2lkdGg6NzQwcHg7Ij4KCQkJPGRpdiBzdHlsZT0iIGZsb2F0OmxlZnQ7ICBiYWNrZ3JvdW5kOiNmZmYgdXJsKGh0dHA6Ly9lZG0uZmVuZy5jb20vc3RhdGljL3RlbXBsYXRlcy81M2Y2YmUyY2U4YmI4L2ltYWdlcy90b3BfYmcuanBnKSBuby1yZXBlYXQgbGVmdCB0b3A7IGJvcmRlcjoxcHggc29saWQgI2UzZTNlMzsgcGFkZGluZzo4NXB4IDcwcHggNTRweCA3MHB4OyBoZWlnaHQ6YXV0bzsgd2lkdGg6NjAwcHg7IHBvc2l0aW9uOnJlbGF0aXZlOyI+CgkJCQk8ZGl2IHN0eWxlPSIgcG9zaXRpb246YWJzb2x1dGU7IHJpZ2h0Oi01MnB4OyB0b3A6NTJweDsiPjxpbWcgc3JjPSJodHRwOi8vZWRtLmZlbmcuY29tL3N0YXRpYy90ZW1wbGF0ZXMvNTNmNmJlMmNlOGJiOC9pbWFnZXMvZW1haWxfbG9nby5wbmciIGhlaWdodD0iOTAiIHdpZHRoPSIxOTciLz48L2Rpdj4KCQkJCTxoMSBzdHlsZT0iIGNvbG9yOiM0ODgyY2U7IGZvbnQtc2l6ZToyMnB4OyI+SGnvvIxxaXVqaW5naHVh77yaPC9oMT4KCQkJCTxkaXYgc3R5bGU9IiBtYXJnaW4tdG9wOjM1cHg7Ij4KCQkJCQk8aDEgc3R5bGU9ImNvbG9yOiMzMzM7IGZvbnQtc2l6ZToxNnB4OyI+5oKo55qE5aiB6ZSL5biQ5Y+3IHFpdWppbmdodWEg55m75b2V5a+G56CB6YeN572u5oiQ5Yqf77yM6K+356Gu6K6k5Li65oKo5pys5Lq65pON5L2c44CCPC9oMT4KCQkJCQk8cD7kuLrkuobkv53pmpzmgqjnmoTluJDlj7flronlhajvvIzor7fmgqjkv53nrqHlpb3oh6rlt7HnmoTlr4bnoIHlubblu7rorq7mgqjkuLrotKblj7forr7nva48YSBzdHlsZT0iY29sb3I6IzQ4ODJjZTsgdGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZTsgdGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZSIgaHJlZj0iaHR0cDovL3Bhc3Nwb3J0LmZlbmcuY29tL2luZGV4LnBocD9yPXNhZnQvYmluZFNhZnRRQ2hvb3NlJmlnbm9yZT1jb2RlIiB0YXJnZXQ9Il9ibGFuayI+5a6J5YWo5o+Q56S66Zeu6aKYPC9hPuOAgjwvcD4KCQkJCQk8cD7mgqjov5jlj6/ku6XpgJrov4flqIHplIvkvJrlkZjkuK3lv4Pmn6XnnIvotKblj7flronlhajmiJbov5vooYzlr4bnoIHnrqHnkIbjgII8L3A+CgkJCQkJPHA+PGEgaHJlZj0iaHR0cDovL2VkbS5mZW5nLmNvbS9hcGkvdXJsanVtcC5odG1sP2NpZD0xOTIwODQ3Jm1pZD0zNTUyJmVtYWlsPTEyMDcyNzY5OEBxcS5jb20mdXJsPWh0dHAlM0ElMkYlMkZwYXNzcG9ydC5mZW5nLmNvbSIgdGFyZ2V0PSJfYmxhbmsiIHN0eWxlPSJjb2xvcjojNDg4MmNlOyB0ZXh0LWRlY29yYXRpb246dW5kZXJsaW5lOyI+5Lya5ZGY5Lit5b+DID48L2E+PC9wPgoJCQkJPC9kaXY+CgkJCQk8ZGl2IHN0eWxlPSIgYm9yZGVyLXRvcDoxcHggc29saWQgI2ViZWRmMTsgcGFkZGluZy10b3A6NDVweDsgbWFyZ2luOjMwcHggMCAyMHB4IDA7Ij7lqIHplIvnvZE8YSBocmVmPSJodHRwOi8vZWRtLmZlbmcuY29tL2FwaS91cmxqdW1wLmh0bWw/Y2lkPTE5MjA4NDcmbWlkPTM1NTImZW1haWw9MTIwNzI3Njk4QHFxLmNvbSZ1cmw9aHR0cCUzQSUyRiUyRnd3dy5mZW5nLmNvbSIgdGl0bGU9IuWogemUi+e9kSIgdGFyZ2V0PSJfYmxhbmsiIHN0eWxlPSIgY29sb3I6IzQ4ODJjZTsgbWFyZ2luOjAgMTBweDsgdGV4dC1kZWNvcmF0aW9uOm5vbmU7Ij5GZW5nLmNvbTwvYT4yMDE05bm0MTLmnIgxNeaXpTwvZGl2PgoJCQk8L2Rpdj4JCgkJCTxkaXYgc3R5bGU9IiBjbGVhcjpib3RoOyBjb2xvcjojNzU3NTc1OyBmb250LXNpemU6MTBweDsgcGFkZGluZzoyMHB4IDAgODBweDsgdGV4dC1hbGlnbjpjZW50ZXI7Ij4KCQkJCTxwIHN0eWxlPSJtYXJnaW46MDsgcGFkZGluZzowOyI+6L+Z5piv5LiA5bCB57O757uf56Gu6K6k5Ye977yM6K+35LiN6KaB5Zue5aSN5q2k6YKu5Lu277yB5q2k6YKu5Lu255qE5Zyw5Z2A5peg5rOV5o6l5Y+X5oKo5p2l5L+h44CCPC9wPgoJCQkJPHAgc3R5bGU9Im1hcmdpbjowOyBwYWRkaW5nOjA7Ij4gwqkgMjAxNCA8YSBocmVmPSJodHRwOi8vZWRtLmZlbmcuY29tL2FwaS91cmxqdW1wLmh0bWw/Y2lkPTE5MjA4NDcmbWlkPTM1NTImZW1haWw9MTIwNzI3Njk4QHFxLmNvbSZ1cmw9aHR0cCUzQSUyRiUyRnd3dy5mZW5nLmNvbSIgdGFyZ2V0PSJfYmxhbmsiIHN0eWxlPSJjb2xvcjojNDg4MmNlOyB0ZXh0LWRlY29yYXRpb246bm9uZTsiPkZlbmcuY29tPC9hPi4gQWxsIFJpZ2h0cyBSZXNlcnZlZC48L3A+CgkJCTwvZGl2PgkKCQk8L2Rpdj4KCTwvZGl2Pgo8L2JvZHk+CjwvaHRtbD4KCjxpbWcgc3JjPSdodHRwOi8vZWRtLmZlbmcuY29tL2FwaS91cmxqdW1wL2luZGV4Lmh0bWw/Y2lkPTE5MjA4NDcmbWlkPTM1NTImZW1haWw9MTIwNzI3Njk4QHFxLmNvbSZ0eXBlPTEmdXJsPWh0dHA6Ly9lZG0uZmVuZy5jb20vc3RhdGljL2ltZy9pY29ucy9iZ19zcmMucG5nJyBzdHlsZT0nZGlzcGxheTpub25lJyAvPg==\\\\\\\" -s mx1.qq.com  -b 162.209.149.40  -o reply-to=support@office.weiphone.com -o message-content-type=html -o message-charset=utf8 -o timeout=6000 -o fqdn=162.209.149-40.edm.feng.com','Email was sent successfully','0','1418634847');\n当中包含的信息：邮件内容、发送者ip、发件人、收件人。邮件内容是base64加密解密之后是html的代码以网页形式打开看看\n\n   漏洞证明：  \n\n会不断变化，定时抓取可导致严重信息泄露。   修复方案：     版权声明：转载请注明来源 鸟云厂商@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-12-16 21:36 厂商回复： 谢谢,我们已经修复，请联系我们，以便寄送礼物 最新状态： 2014-12-16：已经更改  ", "replys": "漏洞评价：\n评论\n     2014-12-15 17:29 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  太有想法了。。。    \n     2014-12-15 17:31 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  我没忍住笑了    \n     2014-12-15 17:36 |    \t\t鸟云厂商  \t\t\t( 核心白帽子 |\t\t\t        Rank:1313 漏洞数:146        | 中国菜鸟)\t\t \n  @浩天 @疯狗 谢谢补图。。。我比较懒，用闪电劈我我就不懒了    \n     2014-12-15 17:39 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @鸟云厂商 劈了，求不懒。    \n     2014-12-15 17:40 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  貌似我看了会笑    \n     2014-12-15 17:41 |    \t\t鸟云厂商  \t\t\t( 核心白帽子 |\t\t\t        Rank:1313 漏洞数:146        | 中国菜鸟)\t\t \n  @niliu 反正我当时是笑了    \n     2014-12-15 17:48 |    \t\t天地不仁 以万物为刍狗 \t\t\t( 普通白帽子  |\t\t\t        Rank:977 漏洞数:264        | 天地本不仁 万物为刍狗)\t\t \n  不明真相的路过。。。    \n     2014-12-15 17:50 |    \t\t鸟云厂商  \t\t\t( 核心白帽子 |\t\t\t        Rank:1313 漏洞数:146        | 中国菜鸟)\t\t \n  @疯狗 谢谢老板  我一定好好干    \n     2014-12-15 17:56 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  既然那么好笑，也mark一下    \n     2014-12-15 18:00 |    \t\t黑吃黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:29        | 倚楼听风雨，淡看江湖路...)\t\t \n  好吧，我也关注一下吧    \n     2014-12-15 18:06 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  。。。。 瞎了，涨姿势了    \n     2014-12-15 18:08 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  我靠 赶紧mark 持续关注修复就公开吧@weiphone    \n     2014-12-15 18:43 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n     2014-12-15 18:56 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  这姿势。。。好狠    \n     2014-12-15 19:09 |    \t\tbey0nd \t\t\t( 普通白帽子  |\t\t\t        Rank:895 漏洞数:142        | 相忘于江湖，不如相濡以沫)\t\t \n  卧槽    \n     2014-12-15 21:51 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:61        | 工作需要，暂别一段时间)\t\t \n  mark    \n     2014-12-15 22:26 |    \t\t啊L川 \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:39        | 菜鸟 ，菜渣， 菜呀！)\t\t \n  mark    \n     2014-12-16 01:36 |    \t\t龍 、 \t\t\t( 普通白帽子  |\t\t\t        Rank:398 漏洞数:135        | 你若安好  我就是晴天)\t\t \n  mark     \n     2014-12-16 03:38 |    \t\tlaoyao \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:5        | ด้้้้้็็็็็้้้้้็็็็...)\t\t \n  已关注！！！    \n     2014-12-16 21:45 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  这是厂商有想法    \n     2014-12-16 21:51 |    \t\tanswer \t\t\t( 普通白帽子  |\t\t\t        Rank:347 漏洞数:45        | 答案)\t\t \n  厂商太溜了    \n     2014-12-16 22:02 |    \t\t漂流瓶 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:4        | 2B)\t\t \n  不知道怎么想的,思维跟不上了    \n     2014-12-16 22:17 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:15        | Talk is cheap,show me the shell.)\t\t \n  已哭瞎- -    \n     2014-12-16 22:26 |    \t\t安然意境 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:79        | 无论是你的事业还是你的个人，可能走的过程...)\t\t \n  产商这样也是醉了。    \n     2014-12-16 22:26 |    \t\tWoodee \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 乌云路人甲，打脸pa pa pa)\t\t \n  好奇怪的姿势    \n     2014-12-16 22:58 |    \t\t毕月乌 \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:16        | 猜猜我是谁？)\t\t \n  这攻城狮怎么想的……    \n     2014-12-16 23:28 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  笑屎了    \n     2014-12-16 23:28 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  当时应该是作为测试的吧我写代码也有这个习惯    \n     2014-12-16 23:52 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @子非海绵宝宝 宝宝，这习惯不好啊，容易啪啪啪的,哈哈    \n     2014-12-17 00:59 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  @Coody 哈哈 那不会 只在调试模式下运行输出代码    \n     2014-12-17 09:30 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  厂商为什么要这么做！！    \n     2014-12-17 16:24 |    \t\t耐小心 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:5        | 噗 我是新手 新手求罩)\t\t \n  有想法！！    \n     2014-12-17 16:28 |    \t\t摩西 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 码农..)\t\t \n  就算输出调试信息也找个别的地方啊... - = 放在网站根目录，真有想法    \n     2014-12-24 16:27 |    \t\txbuther \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 多多交流，一起进步。。。O(∩_∩)O~)\t\t \n  学习了。。。    \n     2014-12-31 17:01 |    \t\tucifer \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:52        | 萌萌哒~)\t\t \n  厂商思维独特啊    \n     2015-01-15 20:33 |    \t\t李宇航的小柠檬 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 小柠檬甜不甜)\t\t \n  @ucifer 确实    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}