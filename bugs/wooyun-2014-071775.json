{"id": 1182, "wybug_id": "wooyun-2014-071775", "wybug_title": "如家酒店暴力破解和任意密码重置漏洞", "wybug_corp": "如家酒店集团", "wybug_author": "ｌeader", "wybug_date": "2014-08-09 23:59", "wybug_open_date": "2014-09-24 00:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["暴力破解", "密码重置"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-24：\t细节向公众公开  简要描述： 如家酒店暴力破解和任意密码重置漏洞 详细说明：  问题出在手机端应用没有对应用进行加壳混淆，通过逆向应用可直接找到接口地址进行暴力破解！   漏洞证明：  某日闲着无聊从官网DOWN了APP回来研究，通过逆向发现里面很多API接口。。。首先先用下面API接口验证是否注册过。。。\n\n拿字典随便生成一个号段丢工具验证下。。。\n\n返回 \"result_code\":1  为已注册， 然后丢下面接口。。。直接上图！！\n\n丢进工具。。。。。。。。\n\n通过这种方式应该可跑出很多弱口令账户，我就不跑了。。。 最后用自己的账号验证下成功的效果。。。\n\n通过上面的方式可获得大量身份证号、姓名、邮箱等信息，还可消费账户积分。。。。。。。。。下面说下任意密码重置的问题，在重置密码的时候只是验证手机号和姓名，然后会向手机发送5位数字的验证码即可重置密码。重点是如何知道一个手机号的用户名呢？其实很多方式，如你想知道女朋友是否开过房？因为注册一般都实名的！！什么？你不知道你女友叫什么名字？。。。。。。。。。或者社工。。在或者。。通过支付宝转账给对方手机0.01员。。。 转账给对方账户时填手机号就可看到名字，但是看不到姓氏。转过一次帐后可以支付宝的转账里面看到全名。。。不多说直接上图。。。\n\n然后丢入下面接口。。。\n\n5位数字还是很快的。。。。求高rank。。。   修复方案：  你们比我懂！！！！！！！！！1   版权声明：转载请注明来源 ｌeader@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-08-10 15:25 厂商回复： 感谢关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-10 22:48 |    \t\t丶小蓝丶 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        | 小白)\t\t \n  厂商就这反映....    \n     2014-08-11 08:39 |    \t\t铁汉 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 向各种大神学习之)\t\t \n  良心厂商啊，为了夫妻能互查开房记录，一直留着个漏洞。如今你们发出来干嘛    \n     2014-08-11 10:20 |    \t\tｌeader \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:6        )\t\t \n  @铁汉 原来是这样啊。。我错了- -!    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}