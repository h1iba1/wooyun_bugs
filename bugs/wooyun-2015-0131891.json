{"id": 25321, "wybug_id": "wooyun-2015-0131891", "wybug_title": "某省电信重置任意人网厅密码漏洞(有一定限制)", "wybug_corp": "中国电信", "wybug_author": "路人甲", "wybug_date": "2015-08-07 13:13", "wybug_open_date": "2015-09-25 14:20", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "认证设计不合理", "敏感功能直接对外", "认证缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-25：\t细节向公众公开  简要描述： 某省电信网厅可有限制条件的重置任意用户服务密码漏洞,只要一个信息,就可以永久保持重置的权限.许多软件都会读取这个信息,发到服务器端进行存储........!!!!!!!!!!!!!!!!!! 详细说明：  北京电信.............(这次还是要感谢借给我手机用的那个北京的朋友......亲爱的朋友不要打我.......)URL:http://bj.189.cn/service/manage/findPassword.action需要的信息是ICCID.(就是卡背面那个号码)安卓/IOS手机的上装的软件都可以获取ICCID........以下为安卓获取ICCID相关代码:\nTelephonyManager tm = (TelephonyManager) this.getSystemService(Context.TELEPHONY_SERVICE);        String imei = tm.getDeviceId();       //取出IMEI        String tel = tm.getLine1Number();     //取出MSISDN，很可能为空        String imei =tm.getSimSerialNumber();  //取出ICCID        String imsi =tm.getSubscriberId();     //取出IMSI\n官方参考链接:http://developer.android.com/reference/android/telephony/TelephonyManager.html以上要是哪个APP数据库泄露了.......后果不堪设想.另外一种方法: 可以直接通过规则推算...这种影响更加巨大.......http://wenku.baidu.com/link?url=A-EVzwrBDV-RBmdu2xhoIl6ODgT3oQErMmCsZcDexNSB17VFX7TpVky-empv4iKYm-ZUgXtK-9XGQVVSDou_57hhGhTAhdv3fmBVf3lHhcG8986031584010329001\t180104607768986031584010329002\t180104602068986031584010329004\t180101050378986031584010329005\t18901339215   漏洞证明：  \n\nURL: http://bj.189.cn/service/manage/findPassword.action首先第一步需要输入手机号码,但是没关系,你看旁边提供一个ICCID查询手机号码的功能\n\nhttp://bj.189.cn/service/commonquery/问:iccid如何获得答:ICCID是有一定规律的,且可以在一定范围内进行特别有效的推算.此处可参考电信ICCID算法文档.http://wenku.baidu.com/link?url=A-EVzwrBDV-RBmdu2xhoIl6ODgT3oQErMmCsZcDexNSB17VFX7TpVky-empv4iKYm-ZUgXtK-9XGQVVSDou_57hhGhTAhdv3fmBVf3lHhcG通过以上文档进行随机推算.8986031584010329001\t180104607768986031584010329002\t180104602068986031584010329004\t180101050378986031584010329005\t18901339215手机号有了,下面进行重置.\n\n在上面输入ICCID即可进行重置为了证明有效性,我们随机抽取一个号码进行重置,朋友对不住了.8986031584010329004\t18010105037恭喜您，尊敬的客户，您的新密码为135791，请妥善保管。亲测有效.......\n\n\n\n截止2014年12月北京电信的手机用户量大概4000多万用户..http://www.bca.gov.cn/default/content.jsp?id=0001945-7/2011-03023\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-08-11 14:19 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国电信集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}