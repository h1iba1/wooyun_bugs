{"id": 83445, "wybug_id": "wooyun-2015-0147825", "wybug_title": "轻停停车跳过支付完成订单并且成功退款到账户（刷停车费）", "wybug_corp": "qtparking.com", "wybug_author": "路人甲", "wybug_date": "2015-12-02 18:38", "wybug_open_date": "2016-01-21 10:50", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-21：\t细节向公众公开  简要描述： 轻停停车，由于业务逻辑设计缺陷，可以直接跳过，支付步骤完成预定车位，同时可以取消订单完成退款到注册账户。 详细说明：  1. 通过微信正常下单子。（通过 Burp 修改订单价格-成功下单，不多测试）\n\n2. 正常下单子，burp 可以看到支付成功后的跳转地址http://www.qtparking.com:80/weixin\"+\"/zhiFuSuccess?parkCode=\"+\"XXXXXXXXXXXXXXX\"+\"&userOpenId=\"+\"XXXXXXXXXXXX\"+\"&outTradeNo=\"+\"XXXXXXXXXXXXXXX\"\n\n3. 可以到订单里直接取消订单，套取回款。   漏洞证明：  1. 跳过支付页面，完成订单\n\n2. 退款情况，原来有30元退款，加测试后的32元变成62元。\n\n   修复方案：  你们知道的。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2015-12-07 10:43 厂商回复： 我们的程序员由于缺乏经验，在demo设计时没有考虑一下必要因素，造成此风险隐患，单鞋提交者和乌云对我们帮助。我们已经部署了新架构，解决了此问题，感谢大家的关系 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}