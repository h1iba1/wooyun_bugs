{"id": 6016, "wybug_id": "wooyun-2014-047707", "wybug_title": "百度某系统源码及多个数据库密码泄露", "wybug_corp": "百度", "wybug_author": "niliu", "wybug_date": "2014-01-02 21:01", "wybug_open_date": "2014-02-16 21:01", "wybug_type": "重要敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "内部敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-16：\t细节向公众公开  简要描述： 某服务器配置不当，造成某系统源码泄露，以及多个数据库配置文件泄露。多个idc人员姓名，身份证及内部开发人员邮箱手机等信息泄露。 详细说明：  服务器地址：\nhttp://61.135.185.214/\n配置不当，目录遍历。\n\natm-256.tar.gz          12-Nov-2013 20:12   72M 下载下来看一下，原来是RMS系统的源码文件\n\n通过对下载文件的查看，发现其为内部开发系统，涉及的东西比较多还有机房管理系统文件\n\n#多个数据库密码泄露\natm-256\\atm-256\\protected\\config\\conf.php\n\n<?php// ============== 线上环境 ===============//if(RMS_ENV == 'prod') {\t$homeUrl = \"http://rms.baidu.com\";\t$svp_hostname = \"sys.baidu.com\";\t$svp_login_url = \"{$homeUrl}/?r=login/checkAuthenticated\";\t$svp_logout_url = \"{$homeUrl}/?r=login/index\";\n\n/* RMS 数据库连接 */\t//$rms_db_connection = 'mysql:host=10.81.52.5;port=4561;dbname=sys_rms';\t$rms_db_connection = 'mysql:host=10.50.15.154;port=6107;dbname=sys_rms';\t$rms_db_username = 'sys_rms_w';\t$rms_db_password = 'g7yg6U7hUa';\n\n/* RMS 线上只读数据库连接*/\t//$rms_readonly_db_connection = 'mysql:host=10.81.52.5;port=4561;dbname=sys_rms';\t$rms_readonly_db_connection = 'mysql:host=10.50.15.154;port=6107;dbname=sys_rms';\t$rms_readonly_db_username\t= 'sys_rms_r';\t$rms_readonly_db_password\t= 'XF55D3ED83EEB5B9X';\n\n/* 安全统计平台数据库连接*/\t$stat_db_connection = 'mysql:host=jx-idc-service0.jx.baidu.com;dbname=stat_db_online';\t$stat_db_username   = 'ams';\t$stat_db_password   = 'ams';\n\n/* 接口监控数据库 */\t\t$interface_monitor_connection = 'mysql:host=jx-idc-service0.jx.baidu.com;dbname=interface_monitor';\t$interface_monitor_username = 'ams';\t$interface_monitor_password = 'ams';\n\n/* 工作流相关配置 */\t$workflow_user \t\t= 'noah';\t$workflow_password \t= 'noah';\t$workflow_wsdl \t\t= 'http://bpm.baidu.com/services/GWFPOutWebService?wsdl';\t$workflow_ext_wsdl \t= 'http://bpm.baidu.com/services/GWFPExtendOutWebService?wsdl';\t$workflow_bpm_wsdl \t= 'http://bpm.baidu.com/services/BPMWebService?wsdl';\n\n/* SMS相关配置 */\t$sms_wsdl = 'http://emp01.baidu.com:8080/smsp/services/SmspOutService?wsdl';\t$sms_user = 'zhangleiqiang';\t$sms_password = 'sysatm@f6';\t$sms_business_code = '99';\n\n/* HelpDesk数据库连接*/\t$help_desk_connection \t= 'mysql:host=jx-idc-service0.jx.baidu.com;dbname=help_desk' ;\t$help_desk_username\t\t= 'helpdesk_admin' ;\t$help_desk_password\t\t= 'helpdesk_passwd' ;\t\t/* RMS Config数据库连接 */    $config_db_connection \t= 'mysql:host=jx-idc-service0.jx.baidu.com;dbname=ams';\t$config_db_username\t\t= 'ams';\t$config_db_password \t= 'ams';\n\n/* RMS Deliver数据库连接 */    $deliver_db_connection \t= 'mysql:host=m1-atm-ur-statistic04.m1;dbname=rms_downline_data';\t$deliver_db_username\t= 'rms_online';\t$deliver_db_password \t= 'yk18f';\n\n/* RMS iplat日志数据库连接*/\t$iplat_log_db_connection = 'mysql:host=10.50.15.154;port=6107;dbname=sys_unilog';\t$iplat_log_db_username  = 'sys_unilog_w';\t$iplat_log_db_password  = 'er1eeLLveUmrPhrM';\n\n/* Memcached相关配置 */\t$memcachedMainHost = 'm1-atm-ur-statistic04.m1.baidu.com';\t$memcachedMainPort = 11211;\t$cache_anti\t\t   = '1';\t/* Memcachedq相关配置*/\t$memcacheqMainHost = '10.42.3.144';\t$memcacheqMainPort = '13000';\t$memcacheqOtherHost = '10.42.3.144';\t$memcacheqOtherPort = '13100';\n\n/* Memcacheq线上备用 */\t/*\t  $memcacheqMainHost = '10.65.43.75';\t  $memcacheqMainPort = '11242';\t  $memcacheqOtherHost = '10.65.43.75';\t  $memcacheqOtherPort = '11241';\t */\n\n/* 单点登录系统地址 */    $uuap_server = 'uuap.baidu.com';    $uuap_port = 443;\t$uuap_remote_login = \"https://\" . $uuap_server . \"/remoteLogin\";\t$uuap_remote_logout = \"https://\" . $uuap_server . \"/logout\";\t    /* UIC接口地址 */    $uic_company_service_wsdl = \"http://uuap.baidu.com:10086/webservice/CompanyService?wsdl\";    $uic_department_service_wsdl = \"http://uuap.baidu.com:10086/webservice/DepartmentService?wsdl\";    $uic_position_service_wsdl = \"http://uuap.baidu.com:10086/webservice/ProductService?wsdl\";    $uic_product_service_wsdl = \"http://uuap.baidu.com:10086/webservice/PositionService?wsdl\";    $uic_user_service_wsdl = \"http://uuap.baidu.com:10086/webservice/UserService?wsdl\";\t$uid_email_wsdl = \"http://uuap.baidu.com:10086/webservice/EmailgroupService?wsdl\" ;\t/* 流程自动化处理 */\t/* 拼接处理地址使用*/\t$envUrl = \"http://rms.baidu.com\";\t/* 出错邮件通知默认收件人*/\t$default_mail_receiver = 'rms-help@baidu.com';\t/* VRP VM接口地址*/\t$vrp_server_url = \"http://http://172.21.157.161/test/r=testvmop\";\t$vrp_server_access_ips = \"172.21.9.1|172.21.9.25\";\t/*PIS 接口*/\t$pis_soap_url = \"http://pisprod.offlineb.bae.baidu.com/?r=rms\" ;\t$vrp_operate_wsdl = 'http://pisprod.offlineb.bae.baidu.com/?r=vrp&wsdl';\t/* EIP接口地址 */\t//$eip_soap_url = \"http://api.noah.baidu.com/eip/ws/EIPWebService?wsdl\" ;\t$eip_soap_url = \"http://java.noah.baidu.com:8040/eip/ws/EIPWebService?wsdl\" ; //2013-02-28\t/* NOAH的API验证地址 */\t$noah_api_auth_url = \"http://noah.baidu.com/api/AuthController/auth\";\t$noah_auth_appid = '34';\t$noah_auth_app_token = '9053a9fb1e8695714f66a50add67c000';\t\t/* OSS的API接口地址 */\t//$oss_api_url = \"http://yf-cdn-mic-05.yf01.baidu.com:8080/oss/index.php?r=cdnossapi/flow\";\t//$oss_api_url = \"http://yx-testing-qapool03.yx01.baidu.com:8080/oss/index.php?r=cdnossapi/Flow\";\n这是登陆日志吧\n\nsvn \nhttp://61.135.185.214/atm-263/.svn/entries\n\n\nphpinfo \nhttp://61.135.185.214/phpinfo.php\n\n\n多个idc人员信息泄露\n\n一个小后台 \nhttp://idc-service.baidu.com/index.php?r=site/login\n\n\n内部开发人员邮箱，手机号泄露\n\n源码中涉及的东西还是比较多的，不深挖了。。。   漏洞证明：  如上   修复方案：  更改服务器配置   版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2014-01-02 22:52 厂商回复： 恶意持续下载代码文件，安全尝试应点到为止，不应进行恶意的持续下载。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-02 21:15 |    \t\t剑无名 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:32        | 此剑无名。)\t\t \n  恭喜恭喜    \n     2014-01-02 21:16 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @剑无名 哎呀我去，为了这个洞费了老劲了...    \n     2014-01-02 21:34 |    \t\t剑无名 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:32        | 此剑无名。)\t\t \n  @niliu 搞到剑心的邮箱手机身份证没？    \n     2014-01-02 21:57 |    \t\t233 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 小孩子看了根本把持不住)\t\t \n  裤子！    \n     2014-01-02 22:49 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @niliu rsy..?    \n     2014-01-03 07:56 |    \t\t4399gdww \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | )\t\t \n  看到厂商回复，感觉是要被查水表的节奏？    \n     2014-01-03 08:29 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @百度 我觉得厂商在这里可能有些误会，我在不下载的情况下是无法判断服务器是不是百度所有，并无什么恶意下载之说，只是凑巧下载的数据比较敏感。    \n     2014-01-03 08:29 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @Coody 不是    \n     2014-01-03 08:29 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @4399gdww 不清楚哎    \n     2014-01-03 10:29 |    \t\tclown岩 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:13        | 哎呀 谁的肥皂？ 各位大牛多多关照！陪聊 ...)\t\t \n  只给1rank、、百度显得有点局气了    \n     2014-01-03 10:45 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @百度 厂商要我联系方式了。是查水表的节奏吗？怕怕    \n     2014-01-03 10:47 |    \t\t4399gdww \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | )\t\t \n  @niliu 百度很生气，后果很严重哦--    \n     2014-01-03 10:49 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @4399gdww @百度 真是这样么？    \n     2014-01-03 11:40 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @niliu 还是小心，下了他们所谓的“那么多敏感信息”    \n     2014-01-03 11:41 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @wefgod 他私信说送礼物，不会查水表啊，已经给他地址了    \n     2014-01-03 11:44 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @niliu 哈，已经给了就先不管了，真查再说    \n     2014-01-03 11:53 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @wefgod 恩，闹心啊    \n     2014-02-16 21:16 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @niliu 什么礼物    \n     2014-02-16 21:53 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  百度给了啥？ 感觉百度是为了惩罚你才给你1rank    \n     2014-02-16 22:01 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @mango @wefgod 是啊，贴的内容太敏感了。。。送了一个百度B7音响    \n     2014-02-16 23:31 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @niliu 觉得不舒服，我可以帮你把音响收了，哈哈    \n     2014-02-16 23:36 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @niliu B7是什么级别？100块还是1000块的    \n     2014-02-16 23:55 |    \t\t大麦 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:6        | ~)\t\t \n  1rank  百度.....     \n     2014-02-17 08:18 |    \t\tziwen \t\t\t( 实习白帽子  |\t\t\t        Rank:49 漏洞数:4        | 活着为了乐还是为了苦？)\t\t \n  中国厂商就这样 无良    \n     2014-02-17 08:32 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @wefgod 估计最多也就200吧，非卖品。    \n     2014-02-17 08:48 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @niliu   给他来个万恶的马赛克    \n     2014-02-17 09:03 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @Damo 是有必要    \n     2014-02-17 11:19 |    \t\tFireweed \t\t\t( 普通白帽子  |\t\t\t        Rank:107 漏洞数:14        | Show me the #)\t\t \n  1rank  私下再发礼物，这是厂商新模式莫？    \n     2014-02-17 11:53 |    \t\t王一了 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 不希望看到网络末日到来。)\t\t \n  日后查水表的节奏吧    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}