{"id": 3590, "wybug_id": "wooyun-2014-053786", "wybug_title": "某政务服务中心系统通用任意文件上传", "wybug_corp": "Cncert国家互联网应急中心", "wybug_author": "U神", "wybug_date": "2014-03-16 14:42", "wybug_open_date": "2014-06-14 14:43", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-14：\t细节向公众公开  简要描述：  详细说明：  #1.这套系统主要是用在政务服务中心、行政服务中心之类的，是一套JSP的CMS，并且百度谷歌等搜索引擎均可以用关键字搜索到存在该类系统的网站，全部都为政府级别的网站，该系统中的后台上传页面未经过任何权限验证，导致可以访问上传页面，并且可上传任意格式的文件。我们来谷歌一下关键字，你就会发现全是政务服务中心的标题：<img src=\"/upload/201403/161256078a78013af2ab82a25c49f39d8d27a2ef.jpg\" \n\n利用页面：\nadmin/upload.jsp 主要是这个上传页面getFileList.action 管理文件页面admin/getFileList.action 管理文件页面mutual/getFileList.action 管理文件页面\n#2.以下是收集了不少，只要关键字构造的好，可穿梭在各搜索引擎爬行到，希望Cncert尽快通报修复该高危漏洞。\nhttp://***.gov.cn/admin/upload.jsphttp://www.y***.gov.cn:9999/admin/upload.jsphttp://www.h***x.gov.cn/admin/upload.jsphttp://www.t***.net/admin/upload.jsphttp://***w.t***ao.gov.cn/admin/upload.jsphttp://www.***.gov.cn/admin/upload.jsphttp://www.y***w.gov.cn/admin/upload.jsphttp://www.x***x.gov.cn/admin/upload.jsphttp://www.w***w.gov.cn/admin/upload.jsphttp://www.***p.gov.cn/admin/upload.jsphttp://***w.s***u.gov.cn/admin/upload.jsphttp://***p.***k.gov.cn:8070/admin/upload.jsphttp://218.***.***.19/admin/upload.jsphttp://x***.***s.gov.cn/admin/upload.jsphttp://www.t***x.com/admin/upload.jsphttp://110.7.***.***:8081/admin/upload.jsphttp://221.235.***.***/admin/upload.jsphttp://www.***.gov.cn:82/web_xzfw/admin/upload.jsphttp://www.b***.gov.cn:8092/admin/upload.jsphttp://www.y***5.gov.cn:9999/admin/upload.jsphttp://***p.***y.gov.cn/admin/upload.jsphttp://221.229.***.***/admin/upload.jsp\n   漏洞证明：  #3.我们看看它的上传页面全部都是一样，可推断是同款系统。\n\n\n\n\n\n#4.以第一个作为例子来证明可任意上传文件，上传一个JSP大马，上传完毕后跳转到文件管理，复制下载地址，默认是在http://www.***.com/upimg/info/***.jsp 这里。上传文件并没有被改名，看了不少这样的政府网，估计都被入侵了不少~\n\n\n\n权限还蛮大~\n\n   修复方案：  PS：测试的Shell已删除，求不跨省，求发证书，不过很多网站已经被其它黑客挂了不少Shell~求通报尽快修复该漏洞，对这些页面做权限认证！   版权声明：转载请注明来源 U神@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-03-23 20:46 厂商回复： CNVD确认并复现所述多个案例情况，已经转由CNCERT将所述案例及时分发给对应分中心，同时对于该软件的生产厂商或是否存在与其他软件同源情况，还在进一步确认。后续如果有对厂商的跟踪处置，再进一步更新补充。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-16 15:30 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  牛逼？    \n     2014-03-16 15:52 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @wefgod 哪里有你牛B啊，找这个其实很简单~    \n     2014-03-16 19:17 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @U神 我只是打酱油的……现在也不怎么搞了    \n     2014-03-16 19:45 |    \t\t马云 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:5        | 啪啪啪啪啪啪啪啪)\t\t \n  @U神 挖槽 你的签名一直再换    \n     2014-03-16 19:48 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @马云 每审核一个漏洞，我的签名就自动换呢~    \n     2014-03-17 10:01 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  已经跟进复现，需要确认一下生产厂商。    \n     2014-03-17 11:27 |    \t\t马云 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:5        | 啪啪啪啪啪啪啪啪)\t\t \n  @U神 不装逼大家还是好朋友哈哈哈    \n     2014-03-17 12:20 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @cncert国家互联网应急中心 忘记跟你说了，第三个直接点确定就可以进入后台    \n     2014-06-14 17:15 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:75        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  走小厂商还是大厂商流程？    \n     2014-06-14 23:50 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  【声明：以上提供的全部案例一方面证明通用型，一方面是给CNVD或Cncert测试，其他人不得用此作非法用途或者破坏操作，否则后果自负】    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}