{"id": 43789, "wybug_id": "wooyun-2014-081661", "wybug_title": "Discuz! x某功能越权漏洞", "wybug_corp": "Discuz!", "wybug_author": "Noxxx", "wybug_date": "2014-11-04 16:11", "wybug_open_date": "2014-12-30 14:44", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-09：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向公众公开  简要描述： rt 详细说明：  相册功能,里面的编辑图片说明可以越权修改在 source/include/spacecp/spacecp_album.php中[code]\t\tforeach ($_POST['title'] as $picid => $value) {//这里遍历数据\t\t\tif($value == $_GET['oldtitle'][$picid]) {\t\t\t\tcontinue;\t\t\t}\t\t\t$title = getstr($value, 150);\t\t\t$title = censor($title);\t\t\tif(censormod($title) || $_G['group']['allowuploadmod']) {\t\t\t\t$pic_status = 1;\t\t\t\tmanage_addnotify('verifypic');\t\t\t} else {\t\t\t\t$pic_status = 0;\t\t\t}\t\t\t$wherearr = array('picid'=>$picid);\t\t\tif(!$managealbum) $wherearr['uid']  = $_G['uid'];\t\t\tC::t('home_pic')->update($picid, array('title'=>$title, 'status' => $pic_status));//直接把$picid 当作where条件来update。所以能直接修改说明。\t\t}[/code]   漏洞证明：  用2个账号来测试[img src=\"http://static.wooyun.org/upload/image/201409/2014092920001882940.png\" alt=\"I\"/][img src=\"http://static.wooyun.org/upload/image/201409/2014092920021477541.png\" alt=\".png\"/]picid[img src=\"http://static.wooyun.org/upload/image/201409/2014092920064686931.png\" alt=\"QQ截图20140929200213.png\"/][img src=\"http://static.wooyun.org/upload/image/201409/2014092920075860631.png\" alt=\"QQ截图20140929200330.png\"/]提交,看原先那张图 说明已经变了[img src=\"http://static.wooyun.org/upload/image/201409/2014092920090323741.png\" alt=\"QQ截图20140929200427.png\"/]   修复方案：  and uid=$_G['uid']   版权声明：转载请注明来源 Noxxx@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-30 14:44 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-04 21:34 |    \t\tMartes \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:3        | 人若无名，便可专心练剑)\t\t \n  前来膜拜！    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}