{"id": 27914, "wybug_id": "wooyun-2015-0121477", "wybug_title": "慕课网设置不当可重置任意用户密码", "wybug_corp": "慕课科技", "wybug_author": "路人甲", "wybug_date": "2015-06-19 12:26", "wybug_open_date": "2015-06-19 14:39", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-19：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 慕课网设置不当可重置任意用户密码(前段时间在极客学院学习，今天来到了慕课网） 详细说明：  重置任意用户密码漏洞研究这个有点意思重置密码post内容active 是邮箱+，+时间戳 linkid是六位数字，一定时间段这六位数字是前3,4，5 位是相同的，所以只需要破解的数字只有1-3位一个是hr 的qq 一个是随机的708883600@qq.com 123wsx   漏洞证明：  先给自己邮箱发一份重置密码邮件，看一下linkid，记住前三位数字然后给要修改的邮箱密码重置邮件，记录一下服务器返回的时间戳<img src=\"/upload\n\n/201506/182035170367906d81ac436e0d7612f9931eb782.png\" alt=\"i1.png\" />把这个字符串做base64加密 ，并把active改成加密后的base64字符串\n\n\n\n字需要破解三位纯数字验证码（其实可以是1-2位）\n\n重置成功\n\n\n\n登录一下\n\n\n\n   修复方案：  code应该设置成随机的字符串   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2015-06-19 13:42 厂商回复： 感谢白帽子同学的提醒。此漏洞确实存在，影响范围是：需要知道其它用户的邮箱地址才可能操作，而邮箱地址在慕课网目前是未公开的。因此设置危害等级为中。 最新状态： 2015-06-19：已修复，后续会做更优方案升级，敬请关注，谢谢！  ", "replys": "漏洞评价：\n评论\n     2015-06-19 16:09 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:84        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  大牛 我求份字典行不 ？      \n     2015-06-24 17:29 |    \t\tSecurity \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:9        )\t\t \n  厂商也是的，你到底修复了吗？答案是：肯定没有。 WooYun: 慕课网任意账号密码重置漏洞 WooYun: 慕课科技重置任意用户密码 这个洞加上你这次我都在乌云看到3次了 \\捂脸逃    \n     2015-06-25 09:14 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:84        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  @Security 人家修补修复是人家的事  你操心过了哈    \n     2015-06-25 09:19 |    \t\tSecurity \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:9        )\t\t \n  @牛 小 帅 我是他们的用户！！！    \n     2015-06-25 09:43 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:84        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  @Security 好吧 我错了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}