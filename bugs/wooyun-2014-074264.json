{"id": 51502, "wybug_id": "wooyun-2014-074264", "wybug_title": "斗鱼网规则不严导致入口文件可以被下载", "wybug_corp": "douyu.tv", "wybug_author": "路人甲", "wybug_date": "2014-08-29 11:35", "wybug_open_date": "2014-09-03 11:36", "wybug_type": "敏感信息泄露", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-03：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 访问网址会直接下载入口文件，唔不知道可不可以用来猜路径下载其他的php文件 详细说明：  http://staticlive.douyutv.com/robots.txthttp://staticlive.douyutv.com/index.php访问后可以直接下载到入口文件，感觉很神奇   漏洞证明：  \n<?php/* *--------------------------------------------------------------- * APPLICATION ENVIRONMENT *--------------------------------------------------------------- * * You can load different configurations depending on your * current environment. Setting the environment also influences * things like logging and error reporting. * * This can be set to anything, but default usage is: * *     development *     testing *     production * * NOTE: If you change these, also change the error_reporting() code below * */\tdefine('ENVIRONMENT', 'production');/* *--------------------------------------------------------------- * ERROR REPORTING *--------------------------------------------------------------- * * Different environments will require different levels of error reporting. * By default development will show errors but testing and live will hide them. */if (defined('ENVIRONMENT')){\tswitch (ENVIRONMENT)\t{\t\tcase 'development':\t\t\terror_reporting(E_ALL);\t\tbreak;\t\t\tcase 'testing':\t\tcase 'production':\t\t\terror_reporting(0);\t\tbreak;\t\tdefault:\t\t\texit('The application environment is not set correctly.');\t}}/* *--------------------------------------------------------------- * SYSTEM FOLDER NAME *--------------------------------------------------------------- * * This variable must contain the name of your \"system\" folder. * Include the path if the folder is not in the same  directory * as this file. * */\t//$system_path = '/var/ZmrServer/www/newzmr/sys';\t$system_path = '../sys';/* *--------------------------------------------------------------- * APPLICATION FOLDER NAME *--------------------------------------------------------------- * * If you want this front controller to use a different \"application\" * folder then the default one you can set its name here. The folder * can also be renamed or relocated anywhere on your server.  If * you do, use a full server path. For more info please see the user guide: * http://codeigniter.com/user_guide/general/managing_apps.html * * NO TRAILING SLASH! * */\t//$application_folder = '/var/ZmrServer/www/newzmr/app';\t$application_folder = '../app';/* * -------------------------------------------------------------------- * DEFAULT CONTROLLER * -------------------------------------------------------------------- * * Normally you will set your default controller in the routes.php file. * You can, however, force a custom routing by hard-coding a * specific controller class/function here.  For most applications, you * WILL NOT set your routing here, but it's an option for those * special instances where you might want to override the standard * routing in a specific front controller that shares a common CI installation. * * IMPORTANT:  If you set the routing here, NO OTHER controller will be * callable. In essence, this preference limits your application to ONE * specific controller.  Leave the function name blank if you need * to call functions dynamically via the URI. * * Un-comment the $routing array below to use this feature * */\t// The directory name, relative to the \"controllers\" folder.  Leave blank\t// if your controller is not in a sub-folder within the \"controllers\" folder\t// $routing['directory'] = '';\t// The controller class file name.  Example:  Mycontroller.php\t// $routing['controller'] = '';\t// The controller function you wish to be called.\t// $routing['function']\t= '';/* * ------------------------------------------------------------------- *  CUSTOM CONFIG VALUES * ------------------------------------------------------------------- * * The $assign_to_config array below will be passed dynamically to the * config class when initialized. This allows you to set custom config * items or override any default config values found in the config.php file. * This can be handy as it permits you to share one application between * multiple front controller files, with each file containing different * config values. * * Un-comment the $assign_to_config array below to use this feature * */\t// $assign_to_config['name_of_config_item'] = 'value of config item';// --------------------------------------------------------------------// END OF USER CONFIGURABLE SETTINGS.  DO NOT EDIT BELOW THIS LINE// --------------------------------------------------------------------/* * --------------------------------------------------------------- *  Resolve the system path for increased reliability * --------------------------------------------------------------- */\t// Set the current directory correctly for CLI requests\tif (defined('STDIN'))\t{\t\tchdir(dirname(__FILE__));\t}\tif (realpath($system_path) !== FALSE)\t{\t\t$system_path = realpath($system_path).'/';\t}\t// ensure there's a trailing slash\t$system_path = rtrim($system_path, '/').'/';\t// Is the system path correct?\tif ( ! is_dir($system_path))\t{\t\texit(\"Your system folder path does not appear to be set correctly. Please open the following file and correct this: \".pathinfo(__FILE__, PATHINFO_BASENAME));\t}/* * ------------------------------------------------------------------- *  Now that we know the path, set the main path constants * ------------------------------------------------------------------- */\t// The name of THIS file\tdefine('SELF', pathinfo(__FILE__, PATHINFO_BASENAME));\t// The PHP file extension\tdefine('EXT', '.php');\t// Path to the system folder\tdefine('BASEPATH', str_replace(\"\\\\\", \"/\", $system_path));\t// Path to the front controller (this file)\tdefine('FCPATH', str_replace(SELF, '', __FILE__));\t\tdefine('HTMLPATH', str_replace(\"\\\\\", \"/\", FCPATH));\t\t// Name of the \"system folder\"\tdefine('SYSDIR', trim(strrchr(trim(BASEPATH, '/'), '/'), '/'));\t// The path to the \"application\" folder\tif (is_dir($application_folder))\t{\t\tdefine('APPPATH', $application_folder.'/');\t}\telse\t{\t\tif ( ! is_dir(BASEPATH.$application_folder.'/'))\t\t{\t\t\texit(\"Your application folder path does not appear to be set correctly. Please open the following file and correct this: \".SELF);\t\t}\t\tdefine('APPPATH', BASEPATH.$application_folder.'/');\t}    spl_autoload_register(function($class_name){        // if(strpos($class_name, 'CI_') === 0) return ;                switch (strrchr($class_name, '_'))        {            case '_Controller':                $dirname = 'core/';                break;            case '_model':                $dirname = 'model/';                break;            default:                $dirname = 'libraries/';                break;        }        if (file_exists(APPPATH.$dirname.$class_name.EXT))            include APPPATH.$dirname.$class_name.EXT;        elseif (file_exists(APPPATH.$dirname.strtolower($class_name).EXT))            include APPPATH.$dirname.strtolower($class_name).EXT;                // throw new Exception('class '.$class_name.' not found!');    });/* * -------------------------------------------------------------------- * LOAD THE BOOTSTRAP FILE * -------------------------------------------------------------------- * * And away we go... * */require_once BASEPATH.'core/CodeIgniter'.EXT;/* End of file index.php *//* Location: ./index.php */\n   修复方案：  感觉应该是规则的事情，php文件直接可以下载   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-09-03 11:36 厂商回复：  最新状态： 2014-09-03：已处理，谢谢！  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}