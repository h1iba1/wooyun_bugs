{"id": 15716, "wybug_id": "wooyun-2012-014170", "wybug_title": "网易有道招聘可重置任意用户密码", "wybug_corp": "网易", "wybug_author": "谱外符", "wybug_date": "2012-11-01 12:28", "wybug_open_date": "2012-12-16 12:28", "wybug_type": "账户体系控制不严", "wybug_level": "低", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计错误", "逻辑错误", "用户敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-11-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-12-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-16：\t细节向公众公开  简要描述： RT 详细说明：  网易有道招聘系统邮件验证存在严重设计缺陷，可导致任意邮箱跳过邮件验证、对任意用户重置密码，严重威胁到应聘者的资料安全。网易有道招聘的注册、验证邮件格式如下：点击此链接激活您的网易招聘网站帐号：http://campus.youdao.com/submit/activate.php?user=XXXXXFxLmNvbQ==&code=MTM1MTczOTkwNg==谢谢！请点击此链接，您的密码将被重设为：1351741688 http://campus.youdao.com/submit/resetpass.php?user=XXXXXFxLmNvbQ==&pass=MTM1MTc0MTY4OA==网易有道招聘小组其中，user，code，pass等字段均为base64编码格式，解码后对应的是用户注册邮件和操作时的时间戳，恶意用户可以轻易的猜测到时间戳。更不可思议的是，服务器只检查了链接访问时间的有效性，经测试，只要是在短时间内，都可以绕过服务器验证。最最最不可思议的是，重置的密码就是时间戳。ps:有道毕业生招聘不会就是毕业生开发的吧！   漏洞证明：  \n\n\n\n此处将时间戳base64替换成1234567890的base64\n\n\n\n只要取回一下密码，马上提交构造好的url对方密码就被改掉了。   修复方案：  重写邮件激活、验证模块的逻辑   版权声明：转载请注明来源 谱外符@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2012-11-02 10:21 厂商回复： 感谢您对网易的关注，漏洞已经修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-11-01 13:10 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  开发人员网上找的代码就用了，也不想想有没有bug，是不是这种情况，如果只post随机的一个绑定用户的参数应该不会有这种问题了吧    \n     2012-11-01 15:30 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  用了1分钟 把漏洞也给找到了唉！    \n     2012-11-01 15:31 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  而且 空密码都可以 太给力了！    \n     2012-11-01 17:16 |    \t\t谱外符 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:3        | 我是来WooYun打酱油的)\t\t \n  只有找不到，没有想不到 :)    \n     2012-11-22 11:36 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  好逻辑    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}