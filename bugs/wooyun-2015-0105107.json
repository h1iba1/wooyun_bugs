{"id": 40284, "wybug_id": "wooyun-2015-0105107", "wybug_title": "一号专车重置任意用户密码", "wybug_corp": "一号专车", "wybug_author": "Vinc", "wybug_date": "2015-04-01 10:04", "wybug_open_date": "2015-05-16 11:12", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-16：\t细节向公众公开  简要描述： :) 详细说明：  管理补充：在相同浏览器找回两个账号的密码(点击忘记密码)，就都收到邮件了。然后点击第一个账号的重置密码链接，然后修改页面cid参数为后一个账号的cid(这里有个重点，第二个账号也必须点击忘记密码接受邮件，这样第二个账号也有要改密码的状态，不然改不了)，改后即可重置当前cid账号的密码了。很简单的一个问题，权限校验不够。无意间看到这个站：https://biz.vvipone.com，注册两个账户，找回密码，发送邮件。来到这一步https://biz.vvipone.com/v/password/pass_3?id=388&verifyCode=7878969106255726输入新密码，查看下POST的内容\ncid=92090988&email=****&password_1=*****&password_2=*****&verifyCode=a5hr\n这里的cid可以修改为我另外一个账户的cid。然后返回\n{\"ret\":{\"code\":0,\"msg\":\"\"},\"data\":\"0\"}\n表示重置成功。   漏洞证明：  很简单的一个问题，权限校验不够。无意间看到这个站：https://biz.vvipone.com，注册两个账户，找回密码，发送邮件。来到这一步https://biz.vvipone.com/v/password/pass_3?id=388&verifyCode=7878969106255726输入新密码，查看下POST的内容\ncid=92090988&email=****&password_1=*****&password_2=*****&verifyCode=a5hr\n这里的cid可以修改为我另外一个账户的cid。然后返回\n{\"ret\":{\"code\":0,\"msg\":\"\"},\"data\":\"0\"}\n表示重置成功。   修复方案：  :）   版权声明：转载请注明来源 Vinc@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-04-01 11:11 厂商回复： 感谢提交，逻辑上的问题会改进，但我理解这个不算任意重置，首先你需要知道对方的cid和email才行 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-01 10:23 |    \t\tVinc \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:22        | :))\t\t \n  谢谢管理补充...    \n     2015-04-01 10:44 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  思路还是要清晰些，不然厂商复现不出来，忽略了就不好了    \n     2015-04-01 10:53 |    \t\tVinc \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:22        | :))\t\t \n  @浩天 恩     \n     2015-04-01 11:14 |    \t\t快的打车(乌云厂商)\t\t \n  @浩天 @Vinc 鱼人节快乐    \n     2015-04-01 11:16 |    \t\tVinc \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:22        | :))\t\t \n  @快的打车  愚人节快乐- -     \n     2015-04-01 11:17 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  这漏洞是真的，不骗人 @快的打车    \n     2015-04-01 11:19 |    \t\t快的打车(乌云厂商)\t\t \n  @浩天 我确认了啊，没忽略。但是有前提条件的，所以只评了5分    \n     2015-04-01 11:20 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  @快的打车 恩恩，愚人节快乐    \n     2015-04-01 12:28 |    \t\tboooooom  \t\t\t( 普通白帽子  |\t\t\t        Rank:467 漏洞数:50        | 我有一个好想法！)\t\t \n  @快的打车 lanz？    \n     2015-04-01 12:57 |    \t\t快的打车(乌云厂商)\t\t \n  @boooooom 是的，你哪位    \n     2015-04-01 13:30 |    \t\tboooooom  \t\t\t( 普通白帽子  |\t\t\t        Rank:467 漏洞数:50        | 我有一个好想法！)\t\t \n  @快的打车 少年！    \n     2015-04-01 13:36 |    \t\tVern \t\t\t( 普通白帽子  |\t\t\t        Rank:517 漏洞数:77        | Keep It Simple, Stupid)\t\t \n  @快的打车   你们和一号专车是什么关系    \n     2015-04-01 13:50 |    \t\t快的打车(乌云厂商)\t\t \n  @Vern 一家人    \n     2015-04-01 13:52 |    \t\t快的打车(乌云厂商)\t\t \n  @boooooom 少年啊，隐藏好深    \n     2015-04-01 13:54 |    \t\t#6c6c6c \t\t\t( 普通白帽子  |\t\t\t        Rank:291 漏洞数:47        | 像一条狗孤独的活着，渴望的活着，绝望的活...)\t\t \n  \"/><img src=x onerror=alert(1)> 不要激动，我不是在测试乌云的xss，是在测试一个网站的。。。。    \n     2015-04-22 10:13 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @Vinc 我比较好奇cid=92090988怎么得到的？    \n     2015-05-16 22:24 |    \t\t这只猪 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 南无阿弥陀佛！)\t\t \n  求大神出个burp的返回参数怎么提交的。。。。    \n     2015-05-17 11:44 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @BMa cid是类似userID的作用？还是类似验证码的作用？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}