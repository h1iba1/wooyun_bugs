{"id": 48429, "wybug_id": "wooyun-2014-083035", "wybug_title": "看我如何重置乐峰网供应商管理系统任意用户密码（管理员已被重置）", "wybug_corp": "乐蜂网", "wybug_author": "hkAssassin", "wybug_date": "2014-11-12 17:37", "wybug_open_date": "2014-12-27 17:38", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-27：\t细节向公众公开  简要描述： 20多万条的供应商信息。有点怕怕。本来想拿shell，怕下错刀，所以到此为止吧！ 详细说明：  点击忘记密码，输入用户名admin,选择手机找回，点击发送验证码，然后不用管，继续随便写验证码，然后下一步，此时抓包\n\n然后按照下图所示的操作，截断返回的数据包\n\n经过测试，将下图中的返回码，改成200即可绕过，直接到修改密码页面\n\n修改密码页面。\n\n修改之后，返回用刚才重置的密码做登陆试试，请看下图\n\n20多万的供应商信息，表示不敢再拿shell。怕下错刀……\n\n   漏洞证明：  点击忘记密码，输入用户名admin,选择手机找回，点击发送验证码，然后不用管，继续随便写验证码，然后下一步，此时抓包\n\n然后按照下图所示的操作，截断返回的数据包\n\n经过测试，将下图中的返回码，改成200即可绕过，直接到修改密码页面\n\n修改密码页面。\n\n修改之后，返回用刚才重置的密码做登陆试试，请看下图\n\n20多万的供应商信息，表示不敢再拿shell。怕下错刀……\n\n   修复方案：  你们懂！ps:admin 的密码 被我设置成了 123456。你们自己设置下吧。还有一个小问题提醒一下。你们那个真的能保护供应商的电话号码么？\n\n看图吧。我读书少别骗我！！！！base64我还是认识滴！望重视！！！！   版权声明：转载请注明来源 hkAssassin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-11-13 09:19 厂商回复： 谢谢关注乐蜂，我们马上安排修补整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-12 20:46 |    \t\t萌萌哒-花粉 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:5        | 多乌云 多美女 花粉 顾名思义 就是校花班花...)\t\t \n  管理员已被重置...希望 无水表     \n     2014-11-13 00:31 |    \t\t0c0c0f \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:15        | My H34rt c4n 3xploit 4ny h0les!)\t\t \n  （管理员已被重置）    \n     2014-11-13 01:11 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  管理员已哭瞎    \n     2014-11-13 07:40 |    \t\t萌萌哒-花粉 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:5        | 多乌云 多美女 花粉 顾名思义 就是校花班花...)\t\t \n  @子非海绵宝宝 应该收到新密码了吧.,,毕竟楼主是乌云    \n     2014-11-13 09:30 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  @萌萌哒-花粉 管理自己可以重置回去啊。新密码写在详情里面了……    \n     2014-11-13 09:35 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  @乐蜂网 给20rank 会~~~xxxxx么？里面还帮你们提了些小问题。你们这是打击我挖洞的信心么！！！！    \n     2015-08-26 08:58 |    \t\t西西 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:7        | 走过路过不会错过！)\t\t \n  看完洞主所有帖子 瞬间感觉腰也不酸了 腿也不疼了 重置密码更有精神了    \n     2015-08-26 09:52 |    \t\t西西 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:7        | 走过路过不会错过！)\t\t \n  表示还是不会截断返回包 望洞主欧巴指教一二。这样操作之后还需要提交吗    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}