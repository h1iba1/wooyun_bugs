{"id": 3855, "wybug_id": "wooyun-2014-052699", "wybug_title": "大汉xxgk（政府信息公开）系统某处越权+getshell", "wybug_corp": "南京大汉网络有限公司", "wybug_author": "wefgod", "wybug_date": "2014-03-04 12:25", "wybug_open_date": "2014-06-02 12:26", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传安全", "文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-07：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-04-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-02：\t细节向公众公开  简要描述： 政府信息公开系统的getshell。和前两天发的那个拿shell方式是不一样的。 详细说明：  越权发生在setup/opr_setting.jsp拿shell是在上传license文件的jsp中setup/opr_licenceinfo.jsp   漏洞证明：  \n<%\tString strRealPath = application.getRealPath(\"\");\t\tstrRealPath = strRealPath.replace('\\\\','/');\tif(strRealPath.endsWith(\"/\")) \t\tstrRealPath = strRealPath.substring(0, strRealPath.length() - 1);\t//系统路径\tjcms.sys.Install install = new jcms.sys.Install( strRealPath );\tinstall.setMerpHome( );\t\tString servername = Convert.getParameter( request,\"servername\");\tservername = servername.toLowerCase();\tString jndi = Convert.getParameter( request,\"jndi\");\tString adminpwd = Convert.getParameter( request,\"adminpwd\");\tString dbtypename = Convert.getParameter( request,\"dbtypename\");\tdbtypename = dbtypename.toLowerCase();\t\t//写merpserver.ini配置文件\tString iniPath = strRealPath + \"/WEB-INF/ini/merpserver.ini\";\tboolean bl = false;\tString strMsg = \"\";\tIniFile ini = new IniFile( iniPath );………………\n木有权限的验证。直接访问http://xxgk.yzcity.gov.cn/govdiropen/setup/opr_setting.jsp可以直接清空setup后台的配置数据。\n\n此时已经将setup的登录密码清空。（有风险，请勿随意尝试，不要跟着我犯错……）提交数据的时候清空密码即可登录成功\n\n\n\n这里有上传licence文件的选项，直接上传一个jsp.licence，然后改包，修改文件名为\"jsp.jsp\"，\n\n\n\n成功，连之\n\n   修复方案：  唉唉。   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-03-04 13:36 厂商回复： 非常感谢您对大汉产品的关注以及对产品安全方面的指正，涉及问题已在新版本中修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-04 13:01 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  怎么又是大汉    \n     2014-06-02 12:28 |    \t\t伟哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:29        | 不怕流氓有文化,就怕色狼有耐心,那么一只起...)\t\t \n  @光刃 大汉大方每个通用型漏洞 都给奖金     \n     2014-06-02 22:38 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @伟哥 是乌云给钱。    \n     2014-06-03 03:34 |    \t\t伟哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:29        | 不怕流氓有文化,就怕色狼有耐心,那么一只起...)\t\t \n  @wefgod ......     \n     2014-06-03 09:46 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @伟哥 和厂商半毛钱关系都没有，厂商从来不出钱啊。给个礼物都不错了还指望他们给钱啊    \n     2014-06-03 11:38 |    \t\t伟哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:29        | 不怕流氓有文化,就怕色狼有耐心,那么一只起...)\t\t \n  @wefgod 我一直以为是厂商给钱。    \n     2014-06-03 12:20 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @伟哥 别想太多了。厂商&……（*&*……*&（省略1000000字）    \n     2014-06-03 13:35 |    \t\t伟哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:29        | 不怕流氓有文化,就怕色狼有耐心,那么一只起...)\t\t \n  @wefgod 请允许我做一个悲伤的表情     \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}