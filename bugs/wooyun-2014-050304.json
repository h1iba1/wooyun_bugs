{"id": 4372, "wybug_id": "wooyun-2014-050304", "wybug_title": "Thinksaas找回密码处设计错误利用账户可找回密码。", "wybug_corp": "thinksaas.cn", "wybug_author": "′雨。", "wybug_date": "2014-02-08 18:44", "wybug_open_date": "2014-05-09 18:45", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-04-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-09：\t细节向公众公开  简要描述： 找回密码处 设置的链接不好把。。 详细说明：  找回密码处 发送邮件给找回密码的地址 但是找回密码的地址只有一个变量。只要知道要找回的账户 就可以直接爆破。http://127.0.0.1/thinksaas2/index.php?app=user&ac=resetpwd&mail=admin@admin.com&set=1d8c9f71eaa6923fc9d3cd5d10aea4ce找回密码的地址。 app  ac   mail 这些都是知道的  只有set不知道。在/app/user/action/forgetpwd.php处。\n$resetpwd = md5(rand());\t\t\t$new['user']->update('user',array(\t\t\t\t'email'=>$email,\t\t\t),array(\t\t\t\t'resetpwd'=>$resetpwd,\t\t\t));\t\t\t\t\t\t//发送邮件\t\t\t$subject = $TS_SITE['base']['site_title'].'会员密码找回';\t\t\t\t\t\t$content = '您的登陆信息：<br />Email：'.$email.'<br />重设密码链接：<br /><a href=\"'.$TS_SITE['base']['site_url'].'index.php?app=user&ac=resetpwd&mail='.$email.'&set='.$resetpwd.'\">'.$TS_SITE['base']['site_url'].'index.php?app=user&ac=resetpwd&mail='.$email.'&set='.$resetpwd.'</a>';\t\t\techo $content;\n可以看到 只有$resetpwd 不知道。  但是$resetpwd = md5(rand());是随机的 然后再md5    RAND_MAX 只有 32768所以可以爆破之。写个脚本  循环给1-32768 md5 一次 然后再载入burpsuite 进行爆破。在测试过程中 最少的一次 只有300多。  最多的一次20000多 这个都看运气了。。爆破速度也是很快的 吃个饭完了就好了。   漏洞证明：  循环脚本。\n\n\n\n循环出来的数据。然后载入Burpsuite \n\n设置好变量 \n\n开始爆破。\n\n观察length 可以知道哪个是正确的。  可以看到我这个在7446的时候 就成功了。然后直接访问 \n\n重置成功。   修复方案：  还是不要用随机的把。。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-02-08 20:14 厂商回复： 已经修复，感谢支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-27 15:21 |    \t\t木马游民 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:8        | I love LSD!)\t\t \n  学习了，我要把你全集看完    \n     2015-01-30 10:47 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  学习了，我要把你全集看完     \n     2015-01-30 10:48 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  向雨神学习！    \n     2015-08-06 00:16 |    \t\t昌维 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | QQ：867597730，百度贴吧ID：昌维001)\t\t \n  我是从论php常见漏洞这篇文章来的    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}