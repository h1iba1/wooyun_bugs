{"id": 70618, "wybug_id": "wooyun-2015-0134213", "wybug_title": "香舍网账户密码重置", "wybug_corp": "香舍网", "wybug_author": "LionEiJonson", "wybug_date": "2015-08-18 18:23", "wybug_open_date": "2015-10-03 09:54", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-03：\t细节向公众公开  简要描述： 网站逻辑有缺陷，导致任意用户密码可以重置。 详细说明：  本来 WooYun: 香舍网任意用户密码重置 已经提出了这个问题，但是问题根本没有解决完整啊，原本是明文，将链接的code和userid加密，仍然有办法重置密码。\n\n首先注册了A用户，和B用户。A,B同时向网站申请忘记密码，然后进入两个账户的密码重置链接，抓包记下两者的UD，我A用户的UID151123，B用户的UID151124。再进入A的密码重置链接，抓包将UID由A的151123改成B的151124，再进行code的爆破，code为固定的5位数，所以很快就能爆破出来。\n\n\n\n   漏洞证明：  见详细说明。   修复方案：     版权声明：转载请注明来源 LionEiJonson@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-08-19 09:53 厂商回复： 该问题必须满足三个条件才能成功：1. 知道指定侵入帐户的userid2. 只有在侵入帐户点击重置密码的同时才可以操作3. code爆破的时间要小于用户操作的时间，否则code失效这三个条件同时满足的机率较小感觉路人甲曝出的漏洞，我们会积极改善 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-20 15:38 |    \t\twsg00d \t\t\t( 普通白帽子  |\t\t\t        Rank:130 漏洞数:15        | 这也不会，那也得学)\t\t \n  大哥就是屌    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}