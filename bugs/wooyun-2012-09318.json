{"id": 18175, "wybug_id": "wooyun-2012-09318", "wybug_title": "度度熊relay系统配置不当", "wybug_corp": "百度", "wybug_author": "xsjswt", "wybug_date": "2012-07-07 12:36", "wybug_open_date": "2012-08-21 12:37", "wybug_type": "系统/服务运维配置不当", "wybug_level": "低", "wybug_rank_0": "2", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当导致攻击界面扩大", "边界绕过", "任意文件读取利用", "应用程序设计不当", "任意文件写入利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-21：\t细节向公众公开  简要描述： 度度熊relay系统配置不当导致用户可以绕过系统限制写入本地文件或者读取本地文件 详细说明：  度度熊relay系统配置不当，部分shell命令没有禁用完全，导致本地文件写入和读取的问题   漏洞证明：  1. 本地文件写入history命令有一个-w 和 -a参数，可以将命令历史写入本地文件；-r参数可以读取本地文件进入命令历史。度度熊relay系统没有禁用完整的这两个参数，只将-w参数和-r参数替换为-n参数，忽略了-a参数，成功登陆relay的用户可以用history -a命令写权限内的任意文件。图为在登录用户的.ssh/authorized_keys下写入publickey后使用publickey直接登录relay系统，绕过了其相关密码验证措施。\n\n\n\n2. 本地文件读取文件读取，管道之类的相关命令已经限制得比较死了，但是漏了一个地方，RT。另外还可以从/proc/pid/cmdline中读取命令行和用户信息，对于apt的童鞋来说，是一个很好的搜集机器与人的对应关系的信息点。\n\n   修复方案：  我是不会了，问大磊   版权声明：转载请注明来源 xsjswt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2012-07-10 12:24 厂商回复： . 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-10 12:12 |    \t\tFallenAngel \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 啊喔呃咿呜喻。。0.0)\t\t \n  擦  猥琐么？ 你的修复方案好给力啊~~    \n     2012-07-10 12:59 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  @FallenAngel 擦 你谁啊    \n     2012-07-11 10:25 |    \t\tFlyR4nk \t\t\t( 普通白帽子  |\t\t\t        Rank:119 漏洞数:18        )\t\t \n  @FallenAngel 擦，你能看到细节    \n     2012-07-11 11:22 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  @FlyR4nk 擦，他好像是百度的人    \n     2012-07-11 11:29 |    \t\tFlyR4nk \t\t\t( 普通白帽子  |\t\t\t        Rank:119 漏洞数:18        )\t\t \n  @xsjswt 擦，我也感觉他是百度的人，靠要不怎么知道修复碉堡了    \n     2013-01-02 21:21 |    \t\thqdvista \t\t\t( 普通白帽子  |\t\t\t        Rank:154 漏洞数:31        | N/A)\t\t \n  擦，楼上一群百度的人    \n     2013-05-27 16:14 |    \t\tl4mbda \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:3        | 嘘嘘)\t\t \n  @xsjswt 没有禁用完整的这两个参数，意思是默认不禁用吗？    \n     2013-05-28 09:42 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  @l4mbda history命令分内置和外置的两种。他这里的history用的是bash内置的history。relay上使用的bash是百度自己修改重新编译过的，针对history命令限制了好几个参数，但是我这里用到的几个参数没有限制    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}