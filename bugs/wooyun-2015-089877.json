{"id": 46690, "wybug_id": "wooyun-2015-089877", "wybug_title": "联想某重要业务站点配置不当导致被Shell", "wybug_corp": "联想", "wybug_author": "米兰的小铁匠", "wybug_date": "2015-01-04 10:36", "wybug_open_date": "2015-02-18 10:38", "wybug_type": "应用配置错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["配置错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-18：\t细节向公众公开  简要描述： 不知道厂商会不会送点礼物呢，好人一生平安！！！ 详细说明：  首先是git泄漏http://kdb.lenovo.com.cn/.git/config然后通过git找到一处配置文件http://kdb.lenovo.com.cn/_core/config.php.bak里面的内容是：\n<?phpreturn  array_merge(array(\t/* 数据库设置 */\t'DB' => array(\t\t'HOST'=>'svn.xml.so',\t\t'USER'=>'portaluser',\t\t'PWD'=>'KDB_portal',\t\t'NAME'=>'portaldb',\t),\t'VAR_PAGE'\t=> 'p',\t// \t'TPL_REPLACE'\t=>array('{STATICS}'=>STATICS),));\n数据库直接对外网访问：\n\n里面的数据库,然后翻到了这个网站http://isv.winxml.com/的数据库lenovoclent.care_configlenovoclent.care_ucenter_member额。。。smtp使用qq邮箱，直接找回管理员密码，如图：\n\n\n\n然后服务器存在解析漏洞，然后后台上传一个一句话图片http://isv.winxml.com/ueditor/php/upload/image/20141231/1420025197145404.png直接使用http://isv.winxml.com/ueditor/php/upload/image/20141231/1420025197145404.png/1.php密码：dadaodiguozhuyi   漏洞证明：  站点还挺多滴：\n\n还包括http://es.lenovo.com.cn/css/wooyun.txt   修复方案：  3306端口还是不要对外访问了吧，好危险的说   版权声明：转载请注明来源 米兰的小铁匠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-01-04 16:37 厂商回复： 谢谢您对联想安全工作的支持,我们会尽快修复漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-28 15:53 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  不知道是哪个大牛的 马甲。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}