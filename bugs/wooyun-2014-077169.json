{"id": 48604, "wybug_id": "wooyun-2014-077169", "wybug_title": "live800在线沟通平台客户端存储型XSS可攻击客服", "wybug_corp": "live800.com", "wybug_author": "mramydnei", "wybug_date": "2014-09-24 16:40", "wybug_open_date": "2014-12-23 16:46", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-23：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 帮朋友测试项目时无意间发现的。 详细说明：  我没有做过大量统计和测试，但根据我这几个月零零散散的测试我认为仍然存有大量的桌面应用，web应用和浏览器插件存有一摸一样的问题。所以，这个XSS的输入点还是文件名。   漏洞证明：  首先我们构造这样的文件名：\n<iframe src=file&#58&#47&#47c&#58&#47WINDOWS&#47system32&#47drivers&#47etc&#47hosts onload=alert(frames[0].document.body.innerHTML)>.jpg\n随后通过http://x55.me/800.htm向客服发送文件，如下图：\n\n现在切换到客服的应用界面，看发生了什么？\n\n可以看到live800在线沟通平台不但正常解析了我们的iframe，我们还顺利地访问到了本地的文件内容。从这个结果来看，我们还是可以通过这个XSS来窃取一些本地文件的内容的。不过应该还是会受到文件类型（扩展名）的限制。除此之外，还有一点需要提一下的是。一旦客户端被中下了xss后门，这段html会作为聊天记录一直被存储在下图所示的目录当中。\n\n如果需要修复这问题，建议在发布补丁的同时，检查或者清除live800在线沟通平台的的cache文件。因为这个文件名是攻击者完全可预测的。   修复方案：  暂无   版权声明：转载请注明来源 mramydnei@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2014-09-25 00:21 厂商回复： 非常感谢，确实有部分系统有这个问题，已经修复 最新状态： 2014-09-25：已修复  ", "replys": "漏洞评价：\n评论\n     2014-09-24 16:49 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  厉害✔    \n     2014-09-24 17:00 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  攻击客服妹子做什么呢    \n     2014-09-24 17:12 |    \t\tPgHook \t\t\t( 普通白帽子  |\t\t\t        Rank:964 漏洞数:115        | ...........................................)\t\t \n  @zzR 还不是想调戏下人家啊！！    \n     2014-09-24 17:22 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  这个系统，有一次跑出过注入，，，但是不能再次的复现了。。。。忘记哪个点了。。。。    \n     2014-09-24 18:01 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  已膜拜m神 m神千秋万代一桶浆糊    \n     2014-09-24 19:27 |    \t\tz7y \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:9        | 关注技术与网络安全)\t\t \n  哈哈哈哈哈，这东西好玩！    \n     2014-09-24 22:03 |    \t\tBird \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:25        | Stay hungry. Stay foolish.)\t\t \n  666666    \n     2014-09-25 02:04 |    \t\tz7y \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:9        | 关注技术与网络安全)\t\t \n  @mramydnei T A T 补了！！没得玩了    \n     2014-09-25 15:15 |    \t\tz7y丶 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 我是z7y的表弟)\t\t \n  已膜拜m神 m神千秋万代一桶浆糊    \n     2014-12-08 10:52 |    \t\t冰无漪 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:4        | 寂傲沧溟远，睥越天关，剑殃造劫竞锋寒，祸...)\t\t \n  洞主果然有过人的长处    \n     2014-12-23 17:59 |    \t\tNeeke \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:24        | 求传授刷Rank方法？)\t\t \n  2分？    \n     2014-12-23 18:22 |    \t\tblack hook \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:8        | 新人、)\t\t \n  @mramydnei 爱慕哥还记得调戏的那个客服妹纸么    \n     2015-01-26 22:10 |    \t\tM4ster \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:7        | www.m4ster@gmail.com)\t\t \n  m哥，你提交后把你的帐号借我一下    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}