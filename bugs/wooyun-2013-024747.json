{"id": 10266, "wybug_id": "wooyun-2013-024747", "wybug_title": "ECShop留言页面存储型XSS", "wybug_corp": "ShopEx", "wybug_author": "monster", "wybug_date": "2013-05-29 17:38", "wybug_open_date": "2013-08-27 17:38", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "4", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-01：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-07-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-27：\t细节向公众公开  简要描述： ECShop留言页面存储型XSS 详细说明：  回复的时候邮箱可以XSS\n247 {248     if (empty($_REQUEST['parent_id']))249     {250         $sql = \"INSERT INTO \".$ecs->table('feedback').\" (msg_title, msg_time    , user_id, user_name , \".251                     \"user_email, parent_id, msg_content) \".252                 \"VALUES ('reply', '\".gmtime().\"', '\".$_SESSION['admin_id'].\"    ', \".253                     \"'\".$_SESSION['admin_name'].\"', '\".$_POST['user_email'].    \"', \".254                     \"'\".$_REQUEST['msg_id'].\"', '\".$_POST['msg_content'].\"')     \";255         $db->query($sql);256     }\n这里直接把邮箱带入SQL语句中，在之前只做了addslashes返回的时候又stripslashes() 了一次   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 monster@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-05-29 19:55 厂商回复： 非常感谢您为shopex信息安全做的贡献我们将尽快修复非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-29 17:46 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  早发现这个问题了，尚未找到触发点 就没提。难道@monster 发现了？    \n     2013-05-29 17:48 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @齐迹 坐等洞主回复    \n     2013-05-29 17:52 |    \t\tmonster \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:10        )\t\t \n  @xsser 也没想到。。不过我觉得可能有这样的情况。超级管理员设置了一个权限很弱的管理员组。这时间可能会用到。    \n     2013-05-29 17:54 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @monster 低了...    \n     2013-05-29 18:20 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  等等我也发个储存的...    \n     2013-05-29 18:26 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  @Rookie 看来都是有货的人哦。。后台一堆，求前台xss哦！    \n     2013-07-04 13:19 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  原来是后台的xss 也能5分。。@xsser 后台到处都是xss 看来我也要来混分了哦？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}