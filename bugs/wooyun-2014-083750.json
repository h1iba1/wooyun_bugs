{"id": 43129, "wybug_id": "wooyun-2014-083750", "wybug_title": "界面网设计不当绕过验证码爆破用户", "wybug_corp": "界面", "wybug_author": "花心h", "wybug_date": "2014-11-18 16:51", "wybug_open_date": "2015-01-02 16:52", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-02：\t细节向公众公开  简要描述： 界面网设计不当绕过验证码爆破用户，准备到圣诞节了挖点漏洞送老婆礼物~ 详细说明：  先说明啊。。。因为呢。。这个网站可能是用户量目前来说比较小吧所以呢。。我没爆破成功几个。本来是没想提交的。。。可是就是瞎猫碰到死耗子爆破了一个。。。我就是演示可以绕过验证码爆破的。先让我慢慢道来。。。。。首先呢，，我先大概浏览了下这个网站，还是不错的登陆口引起了我的注意。。。\n\n邮箱啊。。有点蛋疼，毕竟我没邮箱的用户名，结果机智的我就把用户名字典加上了@126.com   @163.com   @hotmail.com还有@qq.com结果一！个！都！没！爆！破！成！功！好吧有点无奈，，看了下发送的包。。（图丢了就懒得重新再爆破了）有4个不同的字节，一个是486，一个是480，一个是536，还有600多少我不记得了，分析了下，486的是没有注册的，480是用户名不是邮箱的。536是邮箱没有激活的，600多的那个是密码错误的。好吧，，看来不是因为验证码拦截。也不是抓包限制了。。。就在我万念俱灰的时候看到了一个用户名。。。@jiemian.com。。。然后就在开脑洞。。会不会这个有弱口令呢。。然后我就又开始爆破。。。结果功夫不负有心人。。终于是爆破成功了一个。。。一个818字节的包，用户名是@jiemian.com 返回信息是{\"status\":\"y\",\"info\":\"\\u767b\\u5f55\\u6210\\u529f\",\"go\":\"http:\\/\\/www.jiemian.com\"}\"status\":\"y\"y是成功，n是失败。因为我字典问题。。。所以才爆破出来一个。而且只检测了一个弱口令，就是123456，因为这个网站是测试版我不知道这么重复发包会不会对服务器照成堵塞，所以我就停止了。就大概意思是能绕过验证码爆破就对了。。等以后网站大了这肯定是会照成损失的。   漏洞证明：  \n\n818爆破成功，536未激活。486没有这个用户发送包：POST /user/logindo HTTP/1.1Host: passport.jiemian.comProxy-Connection: keep-aliveContent-Length: 100Accept: application/json, text/javascript, */*; q=0.01Origin: http://passport.jiemian.comX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.31 (KHTML, like Gecko) Chrome/26.0.1410.43 BIDUBrowser/6.x Safari/537.31Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://passport.jiemian.com/user/loginAccept-Encoding: gzip,deflateAccept-Language: zh-CN,zh;q=0.8Accept-Charset: iso-8859-1,*,utf-8Cookie: pgv_pvi=663669760; pgv_si=s8850992128; _authCode=ef2cafc19c8d3b24547766cfa189d577from=jm&backurl=http%3A%2F%2Fwww.jiemian.com&email=1@qq.com&password=123456&verify_code=爆破成功的用户名：security@jiemian.com密码123456\n\n   修复方案：  1.加强验证码验证机制2.https加密3.iP限制（不是限制用户名。。上次有人限制了用户名没限制IP。。）4.你们比我更专业，你懂的。   版权声明：转载请注明来源 花心h@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-11-18 17:33 厂商回复： 知道了，修复中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}