{"id": 5719, "wybug_id": "wooyun-2013-044491", "wybug_title": "通用漏洞# 华为光纤路由器HG8245任意命令执行漏洞(通过web界面执行系统命令)", "wybug_corp": "华为技术有限公司", "wybug_author": "Hxai11", "wybug_date": "2013-11-30 10:35", "wybug_open_date": "2014-02-28 10:35", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-05：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-28：\t细节向公众公开  简要描述： 因为家里用的就是这款路由器，所以稍稍做了下检测，看看有什么漏洞 详细说明：  HG8245这款路由器是华为出品的一款光纤wan接口的路由器，我家因为是铁通移动的，所以就默认送了一个，于是就有了以下的一些检测。。首先此款路由的wan是光纤接口，功能还蛮多的，有一个普通用户，一个超级用户，一般来说普通用户的登陆是user:rootpass:admin这是默认的，我们今天就用普通用户测试吧首先我们登陆web管理界面先\n\n之后我们点击系统工具再点击维护\n\n看到这里，或许有些童鞋已经知道了，没做，我当时在想，这里测试连接，ping，那么，可能是通过cgi脚本之类的执行系统中的ping命令在返回数据，我是我开始了测试\n\n这里我填入回环地址，之后进行抓包，果然如此，是通过脚本运行命令，于是嘿嘿，我们直接改其他命令执行试试看。。这整个命令的意思就是id > /var/tmp/xbb.txt之后执行，现在我们回到shell中看看命令是否执行成功\n\nok，直接执行成功shell命令，而且还是root权限哦！！！这样子，一个任意代码执行就成功了，可以在用户不知道shell密码的情况下执行命令，各种操作啊！！！   漏洞证明：  \n\n   修复方案：  你们懂   版权声明：转载请注明来源 Hxai11@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-12-02 16:03 厂商回复： 感谢白帽子的支持，该漏洞为华为历史版本问题，目前发货的版本已经修复了该问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-30 10:46 |    \t\t九零少帅 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:10        | 喂 你干嘛哩.)\t\t \n  坐前排！    \n     2013-11-30 11:22 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2013-11-30 11:57 |    \t\tsysALong \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:5        | 电脑里的AV片 永远 和 电脑旁的卫生纸 成 ...)\t\t \n  关注    \n     2013-11-30 12:24 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  我的是HG255D~    \n     2013-11-30 12:42 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  前排围观!    \n     2013-11-30 15:00 |    \t\t撸王之王撸断肠 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 撸不动了)\t\t \n  mark     \n     2013-12-01 09:02 |    \t\t花生^_^ \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 加强学习~~)\t\t \n  mark    \n     2013-12-02 20:19 |    \t\t小森森 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 不中二 枉少年)\t\t \n  mark！家里用的就是这一款！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}