{"id": 41334, "wybug_id": "wooyun-2014-089182", "wybug_title": "E-learning在线学习平台#SQL注射1", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "xy0er", "wybug_date": "2014-12-31 17:32", "wybug_open_date": "2015-03-31 17:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-08：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-31：\t细节向公众公开  简要描述： RT 详细说明：   WooYun: E-learning在线学习平台cookie#SQL注入 根据前面提交过的案例。关键词：inurl:e-learning/index.asp文件:\\e-learning\\advance_search.asp\nkeyword=request(\"keyword\")kemu=trim(request(\"kemu\"))leixing=trim(request(\"leixing\"))nandu=trim(request(\"nandu\"))chengshi=trim(request(\"chengshi\"))nianfen=trim(request(\"nianfen\"))keyword=trim(request(\"keyword\"))tixing=trim(request(\"tixing\"))jieduan=trim(request(\"jieduan\"))shijuanid=trim(request(\"shijuanid\"))Set rs = Server.CreateObject(\"ADODB.Recordset\")sql=\"SELECT * FROM kaoshi where 1=1 \"if kemu<>\"\" thensql=sql&\"  and kemu='\"&kemu&\"'\"end ifif leixing<>\"\" thensql=sql&\"  and leixing='\"&leixing&\"'\"end ifif tixing<>\"\" thensql=sql&\"  and tixing='\"&tixing&\"'\"end ifif jieduan<>\"\" thensql=sql&\"  and tixing='\"&jieduan&\"'\"end ifif nandu<>\"\" thensql=sql&\"  and nandu='\"&nandu&\"'\"end ifif keyword<>\"\" thensql=sql&\"  and (wenti like '%\"&keyword&\"%' or feixuanzedaan like '%\"&keyword&\"%')\"end ifif nianfen<>\"\" thensql=sql&\"  and nianfen='\"&nianfen&\"'\"end ifif chengshi<>\"\" thensql=sql&\"  and chengshi='\"&chengshi&\"'\"end ifsql=sql & \" order by id desc\"'response.write sqlrs.open sql,conn,1,1shuliang=request(\"shuliang\")if shuliang=\"\" then shuliang=20rs.pagesize=shuliangrcount=rs.recordcountpcount=rs.pagecountpage=clng(request(\"page\"))if isempty(page) or page=0  then page=1end ifif page>rs.pagecount thenpage=rs.pagecountend if'response.write page&\"1\"if not rs.eof then 'response.write page&\"2\"       rs.absolutepage=page'response.write rs.absolutepage\n这里可以看到keyword 等参数都没有经过过滤就带入查询。   漏洞证明：  相关案例：\nhttp://xitong.mingjuan.net/e-learning/index.asphttp://www.mdjiaoyu.com/e-learning/shownews.asp?id=1520http://www.xuejiedu.com/e-learning/index.asphttp://www.xgnjiaoyu.com/e-learning/index.asphttp://www.mdjiaoyu.com/e-learning/index.asphttp://www.wanhuaedu.com/E-learning/index.asphttp://www.bajianedu.org/E-learning/index.asphttp://haerbinjiajiao.com/e-learning/index.asphttp://jiajiao.xuezikeji.com/e-learning/index.asphttp://www.juntop.com/E-learning/index.asp\n\n\n\n\n   修复方案：  添加防注入脚本，过滤相关参数。   版权声明：转载请注明来源 xy0er@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-01-05 08:20 厂商回复： CNVD确认并复现所述情况,由CNVD按以往联系渠道向软件生产厂商通报. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}