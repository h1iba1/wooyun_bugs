{"id": 1050, "wybug_id": "wooyun-2014-071274", "wybug_title": "绕过携程某接口双重限制进行扫号（测试3W数据成功破解391个账号）", "wybug_corp": "携程旅行网", "wybug_author": "niliu", "wybug_date": "2014-08-06 17:01", "wybug_open_date": "2014-09-29 20:06", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-06：\t该漏洞正等待厂商内部评估\t\t\t\t\t\t\t\t\t2014-08-06：\t厂商已经确认，与白帽子共同解决该漏洞中，漏洞信息仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向公众公开  简要描述： 携程某处接口双重限制可被绕过进行扫号测试某N中前3w条数据，成功破解391个账号可登陆他人账号 详细说明： 测试时偶然发现的接口页面 \nhttp://ct.ctrip.com/crptravel/index.aspx\n企业差旅自助平台虽然说是企业用的平台，但是也会影响到主站普通用户数据具体过程思路如下：首先页面登陆 随便输入一个用户名admin连续以不同的密码登陆同一个账号，失败5次后系统会锁定该用户30分钟...\n\n于是想着以密码不变，对用户名进行猜解..但是尝试3次以后会弹出验证码，于是第一次故意输入错误的验证码，页面虽然提示验证码错误，但是发现验证码无变化，所以导致可以重复使用验证码进行fuzz\n\n但是企业的平台为什么会影响到普通用户呢？看下面先简单测试几个用户名观察一下成功破解了一个用户\n\n登陆试一下，结果提示：\n\n然后发现成功破解出的用户名的返回页面代码中的一个链接\n\n\nhttp://ct.ctrip.com/corptravel/mainpage.aspx\n从链接上看应该是用户中心页面 说明用户密码是正确的，只是非企业用户，于是去主站登陆，成功。用户名：guo 密码：123456\n\n于是接下来就可以用大数据进行扫号，由于时间关系，仅测试某n前3w条数据\n\n成功破解391个账号\n\n\nmask 区域\n\n*****.com\tla**********q.com\t**********com\tch**********com\tsyh**********6.com\t8**********a.com\t52**********com\t315**********3.com\t**********com\tjyp1**********com\t898**********ail.com\t**********o.cn\tzy**********.com\thu**********COM\tmm1**********.com\t3**********6@163.co**********.com\t198**********sina.com\t**********3.com\t8**********om\tguoha**********com\tgyt**********ptec.com\t**********w.cn\t1**********163.com\t**********3.com\t1**********com\t237**********com\tliu**********il.com\t0**********63.com\t**********mail.com\t**********h.net\thu**********com\tzn**********.com\ts1**********com\t778**********6.com\t51**********3.com\t2**********3.com\tw**********ail.com\t**********com\tswt1**********q.com\t**********63.com\ta1**********l.com\t77**********a.com\t1**********.com\t2**********.com\t13**********om\t7216**********.com\twes**********com\t471**********om\tlf88**********com\twan**********.com\t19**********q.com\t**********hoo.cn\t**********26.com\t**********.com\t65**********om\txuji**********3.com\t1**********om\t2513**********com\t86**********na.com\t**********com\tzhl**********com\t881**********mail.com**********.com\tzs**********.com\t15**********163.com**********3.com\t**********com\tcan**********l.com\t**********com\txq8**********com\tch**********om\t1989**********q.com\t**********q.com\t**********q.com\t**********.com\tgao**********na.com\t1**********.com\t41**********com\t24**********com\t063**********.com\t816**********.com\t48**********q.com\t**********3.com\t1**********com\t1376**********om\twds**********ail.com**********63.com\t**********hu.com\t7**********m\tliying**********3.com\t6**********.com\tm**********com\txlk**********3.com\t**********o.com.cn**********yeah.net\t**********om\t645**********m\tswallo**********com\tlc**********.com\t5**********6.com\t19**********om\t123**********.com\ts**********com\tsu**********a.com\tat**********126.com\t**********126.com\t**********q.com\t**********l.com\tti**********q.com\tq**********na.com\t7**********com\tafr**********com\t198**********63.com\t8**********.cn\twa**********.com\tm**********ail.com\t**********6.com\t20**********il.com\ta**********il.com\t**********om\t935**********om\thuan**********6.com\tw**********q.com\t**********.com.cn\t7**********6.com\tR**********.com.cn\t4**********.cn\t616**********com\tfen**********.com\two**********.com\t33**********3.com\t**********m\tLuoJia**********6.com\t**********m\tselina**********hoo.cn\t**********com\tlao**********.com\tli**********3.com\ta**********3@qq.com\t**********163.com**********.com\td**********m\tLOVEba**********q.com\t**********ina.com\t5**********net\t879**********6.com\tb**********@163.com\t**********\tzzz248**********com\t19**********6.com\ts**********com\t135**********om\t198**********.com\tgh**********com\tlhw**********163.com\t**********26.com\t**********tmail.com**********6.com\t30**********.com\t3**********om\tasd**********om.cn\t1**********com\twq**********63.com\tji**********om\thh5**********.qq.com\ts13**********q.com\t**********.com\tc**********com\tzhang**********.com\t19**********l.com\twb**********com\tzl**********.com\t65**********il.com\tl**********l.com\t2**********.com\tzh**********6.com\th**********om\timi**********.com\t83**********com\trac**********126.com\t**********eah.net\t**********com\tttt**********.com\t19**********com\tbin**********a.com\t64**********mail.com\t**********o.com.hk**********com.cn\t74**********om\tzouqia**********3.com\tw**********il.com\t**********il.com\t2**********com\txi**********.com\t8**********.com\t19**********.com\tzc**********63.com\t**********com\tzhi**********.com\t820**********ah.net\t**********l.com\t1**********om\ty90**********com\t372**********3.com\t0**********.com\tl**********.com\tia**********com\tyc**********.com\txb**********.com\tc**********163.com\t**********m\tjjf697**********com\t669**********sina.com**********qq.com\t**********.com\t21**********.com\tz**********n.com\t**********hu.com\t**********mail.com**********om\t1981**********h.net\t**********com\tjzz**********6.com\ts**********.com\tCo**********com\tzj**********.com\t1**********3.com\t1**********.com\ty**********com\t1359**********q.com\t**********a.com\t**********om\tw21**********63.com\t**********l.com\t9**********na.com\t**********om\thnc**********O.COM\t3**********om\t569**********@163.com**********com.cn\t13**********.com\tos**********q.com\t**********3.com\t**********3.com\t2**********om\tcjc**********ail.com\t**********il.com\t**********26.com\t**********.com\t8**********com\tkm**********.com\tw**********om\tfuj**********6.com\t1**********com\tsun**********ina.com\t1**********3.com\t**********com\t85**********6.com\tj**********q.com\t**********ail.com**********l.com\t1**********com\t881**********3.com\ts**********63.com\t**********com\tlg8**********com\t11**********l.com\tja**********.com\tz**********3.com\t**********q.com\t**********\tmy179**********il.com\tk**********.cn\t1394**********mail.com\t**********sn.com\t**********com\twud**********3.com\ty**********.com\txn**********.com\tle**********3.com\tx**********3.com\ty**********@sina.co**********.com\ts**********om\twlx2**********com\t876**********3.com\tf**********o.com.cn**********.com\ts**********om\tdhla**********il.com\t38**********com\tx8**********com\thas**********a.com\tp**********.com\tw**********3.com\t4**********m.com\t**********3.com\tb**********om\twjq139**********.com\tx**********com\t45**********.com\the2**********ail.com**********3.com\tN**********3.com\thjf**********edu.cn\t**********q.com\t**********o.com.cn**********u@163.co**********s.com\t**********com\t383**********om\t1437**********com\tjsa**********u.com\t**********q.com\tLo**********@qq.com\t**********.com\twj1**********ina.com**********6.com\tq**********na.com\to**********mat.com**********3.com\tz**********u.com\t8**********.com\t2**********l.com\t**********oo.com.c**********com\t30**********3.com\t5**********63.com\t**********3.com\tw**********om\thon**********u.com\tw**********a.com\tfo**********com\thrj**********qq.com\t**********.com\tliu**********3.com\t**********ail.com\t**********na.com\ts**********com\tmaz**********ail.com**********om\t797**********163.ne**********.com\twan**********q.com\t**********na.com\t**********com\txi**********.com\tn**********com\t638**********il.com\t**********m\tqyijQ1**********qq.com\t**********.com\tp**********com\t77**********ail.com**********.com\two**********se.com\t**********3.com\t**********63.net\t**********ail.com\tw**********tmail.co**********.com\t2l**********com\tb0**********m\t123456**********na.com\tAt**********com\t26**********com\ttlt**********.com\tzha**********3.com\t**********63.com\tD**********.com\t3**********com\txx**********com\twoa**********com\tcl1**********ail.com\th**********.com\tor**********3.com\t1**********m.cn\ti**********163.com\t**********com\thzy**********com\tsha**********com\t82**********mail.co**********63.com\t1**********6.com\t27**********l.com\tz**********com\t52ca**********q.com\t**********.jp\tregi**********com\t208*****\n\n\n\n\n随机登陆部分测试t\n\nmask 区域\n*****gmai*****\n\nm\n\ng\n\nmask 区域\n*****@163*****\n\nm\n\nz\n\nmask 区域\n*****11@1*****\n\nm\n\n订单中可查看个人信息\n\n  漏洞证明： 如上  修复方案： 对登陆接口再限制严格一些。  版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应 厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-08-06 17:34 厂商回复： 此漏洞为商旅客户漏洞，和散客用户是有区别的，但我们认为问题还是挺严重的，我们会尽快安排人员进行该漏洞的修复工作。再次感谢您提交此漏洞信息。 最新状态： 暂无 ", "replys": "漏洞评价：\n评论\n     2014-09-29 20:18 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  扫号漏洞确实挺严重    \n     2014-09-29 20:25 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  我是来看洞主的    \n     2014-09-30 08:39 |    \t\tgodblessme \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:3        | 维护世界和平)\t\t \n  我们认为问题还是挺严重的    \n     2014-09-30 21:33 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  这个就是1w的么，哈哈，看来携程的漏洞提交到乌云比在携程src给力多了啊！    \n     2014-10-01 15:19 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @px1624 没那么多。。。    \n     2014-10-20 12:51 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  3个美刀是5K?    \n     2015-01-21 16:49 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  3$是5K    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}