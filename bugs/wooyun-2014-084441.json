{"id": 42880, "wybug_id": "wooyun-2014-084441", "wybug_title": "东软两套通用型系统存在任意文件上传漏洞（测试可成功上传webshell）", "wybug_corp": "东软集团", "wybug_author": "Blunber", "wybug_date": "2014-12-02 11:20", "wybug_open_date": "2015-03-02 11:22", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-07：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-02：\t细节向公众公开  简要描述： 使用第三方编译器，导致任意文件上传。 详细说明：  东软某在线学习系统存在FCK编译器，可导致任意文件上传，getshell。   漏洞证明：  东软的两个系统在线学习系统\n\n人力资源管理系统\n\n谷歌搜索：\ninurl:login.do?state=login\nintitle\ninurl:loginindex.do\n涉及的系统金川集团公司网络学校迈瑞在线学习管理系统中交股份人力资源信息系统泸州老窖人力资源管理信息系统雅莹人力资源管理系统沈阳中光电子人力资源管理系统。。。（改变搜索规则,可以暴露更多系统)例1：测试站点：http://wx.jnmc.com/sk4/FCKeditor/editor/dialog/fck_about.html  \n\n测试过程：测试上传组件存在，上传webshell。\n\n测试结果：连接菜刀。\n\n连接成功\n\n例2：测试站点：http://my-learning.mindray.com/loginindex.do\n\n测试结果如下:\n\n看来已经有人来过了。\n\n到目前为止都是Administrator/root权限\n\n例3:TalentBase人才资本管理系统1、测试站点：中国航天科技集团人力资源管理系统\n\n2、测试方法：补齐目录测试FCK版本信息\n\n3、测试结果：直传可以拿下webhell上传组件没被删除，显示错误500\n\n虽然没回显，但是通过的FCK目录遍历找到建立的目录\n\n同法可以传shell\n\n 通过测试，几乎100%命中，只要系统匹配，就直接getshell。   修复方案：  修复还是你们比较专业，不多说了，你们懂！   版权声明：转载请注明来源 Blunber@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-12-04 15:07 厂商回复： 感谢白帽作者提供的漏洞信息，我公司已经与相关客户取得联系，并已经制定修复计划，并由业务部门督促进行修复。再次感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-02 11:23 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  +1    \n     2014-12-02 16:07 |    \t\tBlunber \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:13        )\t\t \n  @光头 rank 够高的呀！    \n     2014-12-02 16:08 |    \t\tBlunber \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:13        )\t\t \n  @光刃 漏洞提交数，终于追上你的余数了！    \n     2014-12-04 14:39 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  @Blunber 貌似又赶不上了吧。    \n     2014-12-04 15:08 |    \t\tBlunber \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:13        )\t\t \n  @光刃 这就追上。。。骚等    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}