{"id": 88451, "wybug_id": "wooyun-2016-0193103", "wybug_title": "Aspx环境下(其他环境下亲们自测)绿盟科技WAF最新版本号(6.0.5.0.32608)上传文件后缀名检测绕过                                      ", "wybug_corp": "绿盟科技", "wybug_author": "gyLinuxer", "wybug_date": "2016-04-07 11:23", "wybug_open_date": "2016-07-07 15:20", "wybug_type": "设计不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-11：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-06-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-07：\t细节向公众公开  简要描述： Aspx环境下(其他环境下亲们自测)，绿盟科技WAF最新版本号(6.0.5.0.32608)上传文件后缀名检测绕过 详细说明：  Aspx环境下(其他环境下亲们自测)，绿盟科技WAF最新版本号(**.**.**.**.32608)上传文件后缀名检测绕过测试环境 Win2003R2x64 IIS6.0 .net 2.0  绿盟科技WAF最新版本号(**.**.**.**.32608)   漏洞证明：  Aspx环境下(其他环境下亲们自测)，绿盟科技WAF最新版本号(**.**.**.**.32608)上传文件后缀名检测绕过测试环境 Win2003R2x64 IIS6.0 .net 2.0  绿盟科技WAF最新版本号(**.**.**.**.32608)\n\n\n\n之前测试，被WAF阻挡\n\n利用变形的参数污染大法，将\n\n变为\n\n并且将Aspx源文件的<%@Page language = “C#” >变为\n\n即可绕过WAF的上传后缀名检测，asp下无效，asp下的绕过方法可参考我的http://**.**.**.**/bugs/wooyun-2016-0192638\n\n结果如下：\n\n   修复方案：     版权声明：转载请注明来源 gyLinuxer@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2016-04-08 15:18 厂商回复： 非常感谢@gyLinuxer的反馈！经过产品团队分析确认，此问题属于产品提供的安全防护功能的缺陷，在某些情况下可绕过WAF的文件上传防护。产品团队正着手修复此问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-07 08:17 |    \t\tVinc \t\t\t( 普通白帽子  |\t\t\t        Rank:383 漏洞数:58        | 提莫队长正在待命！)\t\t \n  @胡大神    \n     2016-04-07 12:02 |    \t\tsilencea \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:5        | 混迹互联网的小白)\t\t \n  666    \n     2016-04-07 12:04 |    \t\t小葵 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:11        | 我们是害虫，我们是害虫！)\t\t \n  绿盟WAF会检测上传文件内容。这个早就给他们报过了。    \n     2016-04-07 12:16 |    \t\tgyLinuxer \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:3        )\t\t \n  @小葵 绿盟自己测试，证明漏洞存在    \n     2016-04-07 17:12 |    \t\t小葵 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:11        | 我们是害虫，我们是害虫！)\t\t \n  @gyLinuxer OK OK 我也是绿盟的。绿盟的WAF是有很多问题的。    \n     2016-04-08 10:05 |    \t\tgyLinuxer \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:3        )\t\t \n  @小葵 依讯，启明星辰，绿盟哪家强？    \n     2016-04-08 11:01 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:16        | Talk is cheap,show me the shell.)\t\t \n  @小葵 绿盟哪里的？    \n     2016-04-22 15:41 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1829 漏洞数:183        | 力不从心)\t\t \n  绿盟出来的已经呵呵，这也可以？我们12年的是和公司争论了那么久，最后不了了之，居然丢乌云就开始重视了？呵呵呵了    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}