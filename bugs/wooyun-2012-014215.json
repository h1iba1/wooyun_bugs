{"id": 15676, "wybug_id": "wooyun-2012-014215", "wybug_title": "GPL广联达职业精英赛网站sql盲注,可获取shell提权,刷票技巧等", "wybug_corp": "上海兴安得力软件", "wybug_author": "gxw", "wybug_date": "2012-11-02 17:05", "wybug_open_date": "2012-12-17 17:06", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-02：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-12-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： GPL广联达职业精英赛(http://www.gplcn.com/) 虽说是个小赛,关注人数不多.但还是有人让我检测一下他的安全性.系统逻辑控制不严,形同虚设.查看图片集锦时出现注入点. 详细说明：  同上   漏洞证明：  GPL广联达职业精英赛(http://www.gplcn.com/) 虽说是个小赛,关注人数不多.但还是有人让我检测一下他的安全性.先说下注册表单:\n\n验证码稍微有点复杂,但发现最后提交数据的时候没有对验证码参数(只在填写时检测是否正确,有意?)于是批量注册就产生了.\nfor i in `seq 22658889 1 22658989`; do echo $i;curl -A \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.0)\" -e \"http://www.gplcn.com/\" -d \"username=\"$i\"@qq.com&password=1\" http://www.gplcn.com/enroll/audience; done;\n\n\n进入系统后,发现对某用户的投票,每天只能投一票.检测post参数显示.\n\nfromUsername这个变量值得一改,测试发现只要这个用户是有效的并且还没投票给toUserId,即可有效.于是最简单最不靠谱的批量投票也可以产生了.这种地址 http://www.gplcn.com/videos/info/id/95 一般不考虑. 浏览整站后但这样的 http://www.gplcn.com//picturewall/photoinfo?id=4 可以考虑下,于是\n\n获取race库的users表试试\n\n获取sql_shell\n\n这不是想让谁的票多些就多谢么....到此为止,一点技术含量都没有.不提权了.....   修复方案：  逻辑能不能再好点,再好的验证码也经不起这样用哦   版权声明：转载请注明来源 gxw@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-12-17 19:42 |    \t\tif、so  \t\t\t( 核心白帽子 |\t\t\t        Rank:1008 漏洞数:91        | 梦想还是要有的，万一实现了呢？)\t\t \n  洞主的sqlshell是怎么获得的，求方法    \n     2012-12-17 22:07 |    \t\tjohn \t\t\t( 普通白帽子  |\t\t\t        Rank:222 漏洞数:25        )\t\t \n  @if、so  sqlmap.py -u url --os -shell    \n     2012-12-18 01:28 |    \t\tif、so  \t\t\t( 核心白帽子 |\t\t\t        Rank:1008 漏洞数:91        | 梦想还是要有的，万一实现了呢？)\t\t \n  thx    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}