{"id": 11553, "wybug_id": "wooyun-2013-021710", "wybug_title": "Discuz点触验证码插件验证绕过+密码明文传输", "wybug_corp": "Discuz!", "wybug_author": "桔子", "wybug_date": "2013-04-13 09:31", "wybug_open_date": "2013-07-12 09:31", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "设计不当导致攻击界面扩大", "认证缺陷", "盲目信任用户数据", "认证设计不合理", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-19：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-06-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-12：\t细节向公众公开  简要描述： 部分DZ论坛启用点触验证码后验证码完全没有起作用。同时由于更改了登录逻辑，还会造成论坛登录密码明文传输。 详细说明：  由于点触验证码插件的验证逻辑有问题，启用验证码之后可以简单绕过。同时由于更改了登录逻辑，会将DZ原本的md5传输的密文变成明文传输。   漏洞证明：  将红框中的display: none;\n\n去掉，然后可以看到多了一个登录按钮。\n\n这个按钮是没有启用验证逻辑的。直接输入用户名密码就可以登录。同时这样登录的话POST提交的是正常的md5加密后的密码。但是如果输入验证码提交的话，POST数据就变成了：\n\n其中可以看到明文的密码字段。   修复方案：  不说啥了太坑了。。。TX你也是的，居然让这样的插件过了审核。。。。。。。。。。。。。。。   版权声明：转载请注明来源 桔子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2013-04-16 15:16 厂商回复： 感调对Discuz!X的关注与支持，该问题插件已暂做下架处理，明文密码传输是因为后台没有开启登录密码加密处理的结果 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-13 10:10 |    \t\t斯文的鸡蛋 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:40        | 我在这头，你在那头~)\t\t \n  http://www.ry0751.com/forum.php?mod=viewthread&tid=83990&extra=page%3D1    \n     2013-04-13 13:22 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:41        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  http://www.ry0751.com/forum.php?mod=viewthread&tid=83990&extra=page%3D1    \n     2013-04-15 14:31 |    \t\t桔子 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 一个小小的学生而已)\t\t \n  @鬼魅羊羔 @斯文的鸡蛋 这也行。。。我反正是不知道这个帖子。。。而且我发现的方法跟这个不一样。。。虽然逻辑漏洞都是存在的。。。    \n     2013-04-15 14:39 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:41        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @桔子 嗯，我看了，跟你的应该不一样，不过效果差不多，哈哈。我就是跟热闹，复制粘贴的。。    \n     2013-04-17 22:22 |    \t\t桔子 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 一个小小的学生而已)\t\t \n  厂商不能这样啊。。。明文密码传输是因为后台没有开启登录密码加密处理的结果。。。根本不是啊！！！正常登录的时候是加密传输的！！！。。。。。。    \n     2013-07-12 09:57 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:330        | 呵呵！)\t\t \n  桔子兄？    \n     2013-07-13 12:37 |    \t\t桔子 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 一个小小的学生而已)\t\t \n  @xfkxfk 噗。。。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}