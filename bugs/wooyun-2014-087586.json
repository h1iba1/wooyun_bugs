{"id": 47227, "wybug_id": "wooyun-2014-087586", "wybug_title": "唱吧安卓客户端用户登录敏感信息泄露漏洞", "wybug_corp": "Changba-inc", "wybug_author": "somebody365", "wybug_date": "2014-12-17 22:25", "wybug_open_date": "2015-01-31 22:26", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-31：\t细节向公众公开  简要描述： 唱吧(版本6.0.9)是一款以KTV为特色的社交化安卓APP，登录模块除了支持传统的注册登录方式，也支持第三方平台（新浪微博、腾讯QQ、人人网）登录，登录后可以充金币，查看个人信息等。用户首次登录后服务端返回的认证信息（Token等）存储在SDCard中中login.key文件中，虽然加密，但是加密处理都是与手机平台无关的（秘钥是硬编码的），恶意应用获取这些登录信息后，根本无需解密，就可登录。 详细说明：  用户首次输入用户名、密码登录后，server端会返回token等登录信息，客户端将这些登录敏感信息存储在SDCard中login.key文件中，虽然采用了DES和base64加密处理，但是加密处理是与手机平台无关的，因为秘钥是硬编码的。加密后的login.key文件内容如下：\n\nSDCard的数据很容易读到，因为加密处理是与平台无关的，得到加密的信息后，根本无需解密，将信息存储到另一台手机SDCard中相应的目录下，打开唱吧执行登录便可自动成功登录。   漏洞证明：  在一台手机上登录唱吧后，将SDCard中登录信息文件移到另一台没有登录唱吧的手机上，并放置于SDCard对应的目录下，打开唱吧点击登录按钮后发现可以成功登录。以上说明，如果恶意应用盗取了SDCard里中登录信息，便可以以该用户的身份成功登录唱吧。以下是登录成功后的界面：\n\n   修复方案：  将登录信息存储到/data/data/com.changba目录下，利用安卓的沙箱机制，恶意应用无法获取登录信息。   版权声明：转载请注明来源 somebody365@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-12-18 11:10 厂商回复： 谢谢，这个仅当用户安装恶意软件后才会导致本地文件被泄露。但是一旦用户安装恶意软件，很多数据其实都无法保证，包括用户的一些图片、作品等其他数据，因此相对而言，按照木桶理论，这个漏洞本身堵上也无法补上所有短板，比如用户本地的网络也许同样会泄露他的各种敏感信息。从这个漏洞被利用的难度和波及的用户量看，这个漏洞危害较低。不过，我们还是会尽快修复这个问题，并谢谢这位白帽子的发现，请联系我们以方便我们寄赠礼物。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-18 11:38 |    \t\tcnrstar \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:23        | Be my personal best!)\t\t \n  这个简要描述。。太简要了。。。    \n     2014-12-18 11:47 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  回复很赞    \n     2015-01-08 12:26 |    \t\tcnrstar \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:23        | Be my personal best!)\t\t \n  个人感觉，这尼玛绝壁高危了，任何一个应用都可以读取这个key然后登录，首先恶意开发者可以，其次webview本地的file域等XSS也可以用来截获这个数据。。这绝对是唱吧的认证机制缺陷，哪有直接替换文件就可以伪造用户登录的。    \n     2015-01-08 13:00 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @cnrstar 不公开你吐槽的几乎都没有    \n     2015-01-08 14:24 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @cnrstar 确实很简要  - - !    \n     2015-02-01 15:48 |    \t\t刺蝴蝶De箫启灵 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 我有一只小毛驴，我从来都不骑)\t\t \n  唱吧还送礼物呢。。会不会是女朋友啊    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}