{"id": 17203, "wybug_id": "wooyun-2012-012896", "wybug_title": "盛大旗下有妖气漫画网任意用户密码修改", "wybug_corp": "盛大网络", "wybug_author": "only_guest", "wybug_date": "2012-09-29 22:38", "wybug_open_date": "2012-10-04 22:39", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-10-04：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 盛大旗下有妖气漫画网任意用户密码修改今天这个站流量爆棚了.就检测了一下.庆祝10万个冷笑话第二集更新! 详细说明：  使用邮件找回密码处出现逻辑问题.使用一个已知帐号找回密码.得到如下链接地址http://passport.u17.com/member/reset_password.php?auth=70adcfad448d76c0b70480d787f734&id=2544380&t=1348903015访问后如下图:\n\n在此处输入新密码提交时抓包得到如下内如:\nPOST /member/reset_password.php?auth=70adcfad448d76c0b70480d787f734&id=2544380&t=1348903015 HTTP/1.1Host: passport.u17.comProxy-Connection: keep-aliveContent-Length: 63Cache-Control: max-age=0Origin: http://passport.u17.comUser-Agent: Mozilla/5.0 (Windows NT 6.2) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.47 Safari/536.11Content-Type: application/x-www-form-urlencodedAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Referer: http://passport.u17.com/member/reset_password.php?auth=70adcfad448d76c0b70480d787f734&id=2544380&t=1348903015Accept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Accept-Charset: GBK,utf-8;q=0.7,*;q=0.3Cookie: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXnew_password=zzzzzz&confirm_password=zzzzzz&%E6%8F%90%E4%BA%A4=\ncookies里并无任何与此操作相关的信息.post的数据中只提交了新密码.我们可以看到提交地址里用get方式提交了用户ID.这里是识别修改哪个用户密码的标识.修改此处ID.重新做一次提交.得到下图:\n\n成功修改密码.此时对有妖气的管理员来一次密码修改.我们通过访问自己的个人空间可以得到用户ID如http://i.u17.com/1844269/可以得到用户ID1844269但只能得到其ID和昵称.即使修改了密码也不知道帐号.无法进行登陆.此时我们访问http://i.u17.com/1得到管理员昵称是Xcily我尝试使用昵称做为帐号.失败了.这个时候看到一个贴心的小功能.叫做记不清用户名？但是记得昵称，点击这里试试看http://passport.u17.com/member/forgot_begin.php然后输入管理员昵称.\n\n您的账户名x*******9X开头,9结束.我们把管理员的昵称放在百度上搜索了一下.\n\nxcily0429然后使用次帐号尝试..存在这个帐号...修改用户ID为1的密码.使用xcily0429登陆成功.\n\n管理员帐号.尝试了下论坛.此帐号在论坛ID也是1.但由于论坛的后台设置了访问权限.403了...又尝试了其他几个管理员.都成功修改并且进入了其帐号.没做其他任何操作.只是想唤起管理员警觉.非常喜欢有妖气的动漫.管理员xcily也是个技术宅.希望有机会能一起交流一下.庆祝十万个冷笑话更新第二集!!!   漏洞证明：  \n\n   修复方案：  修改密码处多增加些身份认证吧.   版权声明：转载请注明来源 only_guest@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-10-04 22:39 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-10-05 01:52 |    \t\thacx \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:6        )\t\t \n  有妖气。呵呵。    \n     2012-10-05 03:21 |    \t\tLaTCue \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:27        | 满脑子的艺术细菌，当然，是人体艺术。)\t\t \n  盛大87    \n     2013-02-08 09:48 |    \t\t盛大网络(乌云厂商)\t\t \n  @北京四月星空网络技术有限公司    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}