{"id": 13266, "wybug_id": "wooyun-2013-022437", "wybug_title": "关于IE页面欺骗漏洞", "wybug_corp": "浏览器", "wybug_author": "杀戮", "wybug_date": "2013-04-24 17:23", "wybug_open_date": "2013-04-24 17:23", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["钓鱼欺诈", "浏览器漏洞利用技巧", "浏览器漏洞挖掘", "浏览器漏洞利用", "浏览器实现漏洞", "浏览器安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-24：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-04-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：    就是要带感~~   好吧，不怎么带感。。。。   下午在测试一些东西的时候无意发现的玩意。 详细说明：  先说下页面欺骗漏洞，原理是处理多个函数竞争阻塞发生逻辑错误。Such As: \n WooYun: 腾讯浏览器7.1.5753.400存在内容欺骗漏洞，可以伪造任意网站 \n一般的搭配就是导向函数 window.open location.href和对话框与写页面函数的堵塞，就是write和alert。一般安全人员都把重点放在document，所以忽略了alert，这次问题就是出在alert上我们先来看下 window.open 和alert的处理。\ntest.html<a onclick=\"test()\">CLICK</a><script>function test(){  window.open('http://baidu.com/')  alert('http://t.qq.com/SlaughterSain');}</script>\nQQ浏览器打开(IE内核)，可以看到百度上弹出了小框，危害就是可以用来进行一些钓鱼之类的，不过就危害而言小于document.write 因为这个是直接写页面。\n\n\n\n要利用的话最好插入一个时间延迟\nsetTimeout(function(){alert(/test/);},2000)\nIE对这种类型的东西做了很好地防护，但是披着IE外壳的东西就没那么幸运了。测试\nQQ浏览器:成功傲游浏览器:成功360浏览器(IE内核):成功\n   漏洞证明：  上面上面   修复方案：  路过一下   版权声明：转载请注明来源 杀戮@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2013-04-24 18:03 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这种问题还好，影响不是特别大    \n     2013-04-25 09:14 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @xsser @杀戮 洞主 看代码可知 你弹的框 实际上还是在原网页内 而不是新打开的百度你出现幻觉了！！！    \n     2013-04-25 09:15 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @xsser 这个不是漏洞 也不是bug  审核不过关 扣工资    \n     2013-04-25 10:14 |    \t\t杀戮 \t\t\t( 普通白帽子  |\t\t\t        Rank:141 漏洞数:19        | 我，是来打酱油的。)\t\t \n  @Finger 这个要达到的目的并不是在新页面执行 而是欺骗 如果能在新页面执行的话那属于跨域问题了    \n     2013-04-25 10:48 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @杀戮 在新窗口弹出百度之后 才在test.html页面执行alert('http://t.qq.com/SlaughterSain'); 即便延迟setTimeout(function(){alert(/test/);},2000) 也还是在test.html页面上执行的没觉得有欺骗性 你是IE几？    \n     2013-04-25 11:33 |    \t\t杀戮 \t\t\t( 普通白帽子  |\t\t\t        Rank:141 漏洞数:19        | 我，是来打酱油的。)\t\t \n  @Finger 你是用IE 然后测试的时候百度那里没弹框是吧    \n     2013-04-25 12:26 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @杀戮 360浏览器    \n     2013-04-25 12:51 |    \t\t杀戮 \t\t\t( 普通白帽子  |\t\t\t        Rank:141 漏洞数:19        | 我，是来打酱油的。)\t\t \n  @Finger 那玩意支持两个内核 谷歌对这个是有防范的    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}