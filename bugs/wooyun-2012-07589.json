{"id": 19114, "wybug_id": "wooyun-2012-07589", "wybug_title": "ITools &lt;= 1.4.6.0 远程代码执行漏洞", "wybug_corp": "深圳创想天空科技有限公司", "wybug_author": "路人甲", "wybug_date": "2012-05-29 18:58", "wybug_open_date": "2012-07-13 18:59", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "19", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["劫持", "客户端安全", "劫持利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-01：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-07-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-13：\t细节向公众公开  简要描述： ITools 低于1.4.6.0版本存在远程代码执行漏洞，恶意攻击者可以利用ITools中存在的远程代码执行漏洞使浏览ipa文件用户远程运行恶意代码 详细说明：  ITools是由腾讯投资的深圳创想天空科技有限公司开发的一款号称领先业界的苹果设备同步管理软件。用户可以使用iTools非常方便的完成对苹果设备(ios系统，包括iphone,ipad,ipod touch）的信息查看、音乐/铃声/照片/书籍/文件管理、软件安装、互联网资源下载甚至是设备系统修改等。该软件1.4.6.0及以下版本存在远程代码执行漏洞，由于该软件关联了苹果应用程序扩展名.IPA的文件打开，当用户安装了ITools并双击打开一个.ipa文件时，ITools会加载一个IPA文件同目录下的CFNetwork.dll文件，如果攻击者精心构造一个恶意的 CFNetwork.dll文件，并放置到网络路径或WEBDAV路径上，当导致用户在网络路径访问远程的IPA文件，或者用浏览器浏览WEBDAV上的IPA文件时，就会触发攻击者的恶意代码得到执行，安装恶意程序或窃取用户隐私。   漏洞证明：  安装ITools 1.4.6.0及其声明需要的ITunes 10+（这里选用目前苹果官网上最新的 ITunes 10.6.1.7安装包）在网络路径上放置任意一个.IPA文件，例如123.ipa同时放置一个具备下面导出函数的CFNetwork.dll到IPA的同目录下CFHTTPMessageSetHeaderFieldValuekCFHTTPVersion1_1CFHTTPMessageCreateRequestCFURLRequestCreateMutableHTTPRequestCFURLResponseGetHTTPResponseCFReadStreamCreateForHTTPRequestCFURLConnectionSendSynchronousRequestCFHTTPMessageGetResponseStatusCodeCFURLRequestSetSSLPropertieskCFStreamPropertyHTTPResponseHeaderkCFStreamSSLValidatesCertificateChainCFHTTPMessageSetBody双击IPA文件，CFNetwork.dll内的代码立即被加载并执行。仅安装ITunes并关联IPA文件并无此漏洞效果如下图\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2012-05-29 22:23 厂商回复： 感谢乌云平台对维护产业环境做出的努力iTools工程师对WooYun所举报的问题评估如下：1、这个问题是微软“Windows程序执行时优先加载本目录下DLL”的机制，存在被人恶意利用的可能。这个风险对国内外大部分软件而言都存在，包括国内安全软件360的相关产品，并不能算是iTools产品独有的漏洞或缺陷。（360杀毒软件也遇到相同问题，参见：http://www.wooyun.org/bugs/wooyun-2010-0305）2、触发此问题的前提是将一个精心制作的DLL文件放到用户电脑的IPA目录。但iTools并不会下载IPA以外的任何文件，已经完全杜绝了网络下载DLL文件的可能。iTools也已经调整做出预防。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-29 22:32 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  神奇的路人甲    \n     2012-05-29 22:34 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  靠谱的厂商！    \n     2012-05-31 12:12 |    \t\tmj0011 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 360safe security researcher & programmer)\t\t \n  一个远程代码执行漏洞，居然Rank只评到3危害低，简直是太搞笑了！连360的那个主防绕过的还有rank10呢，那个实际不是安全漏洞，而这个则是高危的远程代码执行漏洞厂商不懂安全乱评，乌云也没有修正机制吗？    \n     2012-05-31 12:18 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @mj0011 乌云后期会对漏洞评分进行修正，我们提供平台的同时实际上也是能够看到漏洞双方站在不同的角度对同一个问题的评价，这个评价的最终结果会是真实的，公开之后白帽子的评价会影响到rank的多少的 ：）    \n     2012-05-31 16:33 |    \t\tmj0011 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 360safe security researcher & programmer)\t\t \n  ITools官方已经全面否认此漏洞，称漏洞是误报了。看看乌云怎么处理吧！http://it.chinabyte.com/419/12345919.shtml    \n     2012-05-31 16:51 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @mj0011 被删除了找快照去。    \n     2012-05-31 16:58 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @zeracker http://sec.chinabyte.com/1/12346001.shtml 这个还有～     \n     2012-05-31 17:05 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @gainover http://cache.baidu.com/c?m=9f65cb4a8c8507ed4fece763104d91711923d139678b83453492c45f93130a1c187be5b82c3f1304d2c37b6c02a45e5c9db16c34685d34f2c688de4586fd85295f9f2743671df610488845fcdc4755916bd60dfeae69f0ba872592de838e804353bb55067197f0fa590015cc68fb173af4a7e95f152807bb9d713fb90629&p=c066c54ad7c20efc57ecc62b440c&user=baidu&fm=sc&query=http%3A//it%2Echinabyte%2Ecom/419/12345919%2Eshtml&qid=f885642f1020da10&p1=1    \n     2012-05-31 17:15 |    \t\t牛奶坦克 \t\t\t( 普通白帽子  |\t\t\t        Rank:355 漏洞数:21        | 晚安,牛奶)\t\t \n  @zeracker @mj0011 哪里看到wooyun官方说漏洞属于误报的声明了？itools爱怎么说就怎么说，还能管住别人的嘴了？    \n     2012-05-31 17:18 |    \t\tmj0011 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 360safe security researcher & programmer)\t\t \n  @牛奶坦克 我是说itools官方说漏洞是误报了，没说wooyun官方。wooyun官方刚才给我说，他只能管这里的，管不了人家在外面怎么说，所以只要itools在这里承认，然后给一个奇低的rank，他就可以随便怎么说了，反正你也没细节，证明不了他说谎    \n     2012-05-31 17:20 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @牛奶坦克 我躺着也中枪啊。 @mj0011 这种事在乌云经常发生    \n     2012-05-31 17:22 |    \t\tmj0011 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 360safe security researcher & programmer)\t\t \n  @zeracker 太悲剧了，还是自家的漏洞平台好 T T    \n     2012-05-31 17:26 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @mj0011 自家的平台连个标题都看不到，20年也不公开    \n     2012-05-31 17:28 |    \t\tmj0011 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 360safe security researcher & programmer)\t\t \n  @xsser 你这说的不就不对了，你看，http://vulreport.360.cn/ 不光标题有，连概述也很清楚，下周我们还会上更华丽和详细的公告展示页面    \n     2012-05-31 17:35 |    \t\t牛奶坦克 \t\t\t( 普通白帽子  |\t\t\t        Rank:355 漏洞数:21        | 晚安,牛奶)\t\t \n  @mj0011 嗯，关于对你的误解，我抱了个歉的。但还是那句话，itools爱怎么说就怎么说，还能管住别人的嘴了？反正我们也看不到细节，不管是真漏洞假漏洞，等漏洞修复周期后公开了就知道咯。    \n     2012-05-31 17:36 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @mj0011 真的假的啊    \n     2012-05-31 17:37 |    \t\tmj0011 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 360safe security researcher & programmer)\t\t \n  @xsser 自己看啊。。。- -     \n     2012-06-01 14:16 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  事情看来太复杂了：http://www.newsmth.net/bbstcon.php?board=Apple&gid=672612&start=672612&pno=1    \n     2012-06-01 14:22 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @horseluke 这......    \n     2012-06-01 14:35 |    \t\tmj0011 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 360safe security researcher & programmer)\t\t \n  @xsser 这公司的疯狗咬人能力很强啊，在这里回个评论都中枪了    \n     2012-06-01 17:04 |    \t\t穿精带淫 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | hoho```)\t\t \n  我去，特地注册账号来回复，楼上的也不用马甲啊，迟果果的···    \n     2012-06-01 18:38 |    \t\t网络骑士 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:4        | 低调是最NB的炫耀！高调是要被打的征兆！)\t\t \n  看厂商的描述，如果属实的话，本目录DLL支持确实算是个不痛不痒的事，很少有软件专门去处理这个问题，这是微软的问题。这应该甚至连本地溢出都不算吧，可是看到“远程代码执行”的字样，我决定坐等漏洞公开了……    \n     2012-06-01 19:13 |    \t\tmj0011 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 360safe security researcher & programmer)\t\t \n  @网络骑士 本目录DLL劫持当然是微软的问题，但是浏览文件目录的DLL劫持就是远程代码执行漏洞了，自己去看看微软最近两年发布的文件目录DLL劫持的补丁吧，几乎每月都有，这个漏洞看描述就知道是远程代码执行漏洞了。    \n     2012-06-29 14:16 |    \t\tmj0011 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 360safe security researcher & programmer)\t\t \n  @网络骑士 信息终于公开了～ 很明显这是一个高危远程执行漏洞，没什么可说的了。    \n     2012-07-14 15:02 |    \t\t神刀 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:3        | www.shellsec.com内射那么牛，虾米没妹子？)\t\t \n  亮了    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}