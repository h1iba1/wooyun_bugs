{"id": 48974, "wybug_id": "wooyun-2014-075880", "wybug_title": "MTK M4U_device设备内核驱动任意地址可读写导致的权限提升", "wybug_corp": "MediaTek（MTK）", "wybug_author": "Ov4ns7wp", "wybug_date": "2014-09-12 12:30", "wybug_open_date": "2014-12-11 12:32", "wybug_type": "权限提升", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["权限提升", "设备驱动"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-20：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-11：\t细节向公众公开  简要描述： MTK6582/MTK6589/MTK6592/dev/M4U_device 驱动未进行参数过滤导致任意地址可读写 详细说明：  \nkernel\\drivers\\m4u\\m4u.ccase MTK_M4U_T_REG_GET:{    unsigned int para[2];    M4U_ASSERT(a_Param);    ret = copy_from_user(para, (void*)a_Param , 2*sizeof(unsigned int));    /*参数未过滤 导致任意地址可读*/    para[1] = COM_ReadReg32(para[0]);    ret=copy_to_user((void*)a_Param, para, 2*sizeof(unsigned int));}break;case MTK_M4U_T_REG_SET:{    unsigned int para[2];    M4U_ASSERT(a_Param);    ret = copy_from_user(para, (void*)a_Param , 2*sizeof(unsigned int));     /*参数未过滤 导致任意地址可写*/    COM_WriteReg32(para[0], para[1]);}\n涉及的现有机型：Coolpad 8297Coolpad 8297wxiaomi hm note 1tdthl t100huawei h30 t00xiaomi hm1NibiruH1thl t200Coolpad9976Ahuawei g750 t01bbk y17tHUAWEI G6-T00   漏洞证明：  \nchmod 755 /data/local/tmp/exp测试机型:HUAWEI G6-T00系统版本:<code>安卓版本: 4.2.2Linux版本:3.4.5Linux编译版本: #1 SMP PREEMPT Sun Apr 13 00:36:44 CST 2014\n/data/local/tmp/exp[+]Ov4ns7wp Android Security Team [AST]chattr: stat /system/bin/su: No such file or directory rm failed for /system/bin/su, No such file or directory rm failed for /system/app/Superuser.apk, No such file or directoryroot:/ # ididuid=0(root) gid=0(root) context=u:r:init:s0</code>   修复方案：     版权声明：转载请注明来源 Ov4ns7wp@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-09-17 05:28 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-14 13:26 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 承接:钻井，架工，木工，电工，水暖工，力...)\t\t \n  MTK...    \n     2014-09-17 09:12 |    \t\tlivers \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:6        | mov esp,0jmp espcrash.....)\t\t \n  是keen那边的吗？    \n     2014-09-17 10:16 |    \t\tOv4ns7wp \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:9        | Email:5365785365634071712E636F6D)\t\t \n  @livers 不是 :)    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}