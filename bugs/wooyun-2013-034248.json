{"id": 62794, "wybug_id": "wooyun-2013-034248", "wybug_title": "内网安全厂商系列之1亿赛通第三方开源程序导致Getshell", "wybug_corp": "esafenet.com", "wybug_author": "n0bele", "wybug_date": "2013-08-20 15:38", "wybug_open_date": "2013-10-04 15:38", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["渗透测试思路"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-04：\t细节向公众公开  简要描述： 在我印象中亿赛通应该算是国内第一家做文件加解密的厂商，他们当时号称的第一个内核加解密的ssdt hook技术，时过境迁后头看只能算是一种尝试了。本人对透明加解密兴趣不大，什么fsd hook、多fcb更是听都没听过. 详细说明：  \n\n恩，看来是dedecms的系统，但看页面怎么感觉不像呢?看看版本吧。http://www.esafenet.com/data/admin/ver.txt20110624那么就存在被以下这些漏洞搞的可能•  2013-06-07dedecms 修改任意管理员漏洞•  2013-03-29DedeCms 5.x 本地文件包含漏洞(respond方法)•  2012-11-05Dedecms v5.7 plus\\feedback.php SQL注入漏洞•  2012-05-29织梦(dedecms) 5.7 /plus/car.php sql注入0day•  2012-04-29DEDECMS 5.7之前版本远程SQL注入漏洞•  2012-03-21织梦(DedeCMS)后门远程代码执行漏洞•  2011-12-30dedecms(织梦) < 5.7 多个SQL注入漏洞•  2011-12-30Dede(织梦) CMS SQL Injection Vulnerability•  2011-10-14DEDECMS 全版本 gotopage变量XSS漏洞•  2011-09-23DeDeCMS(织梦)变量覆盖0day getshell•  2011-08-11织梦(DedeCms) v5.6-5.7 越权访问漏洞(直接进入后台)•  2011-08-11dedecms织梦 标签远程文件写入漏洞接下来尝试默认后台登陆：http://www.esafenet.com/dede/index.php 管理员改了后台2个有趣的地方:http://www.esafenet.com/info.phphttp://www.esafenet.com/user通过nday拿到shell\n\n<?php//鏁版嵁搴撹繛鎺ヤ俊鎭?$cfg_dbhost = 'localhost';$cfg_dbname = 'yst';$cfg_dbuser = 'root';$cfg_dbpwd = 'chenyi210673**';$cfg_dbprefix = 'wcm_';$cfg_db_language = 'utf8';?>\n\n看到这个提权不在话下了，但接下来的我就没兴趣了.   漏洞证明：  已证明过   修复方案：  补吧，很多   版权声明：转载请注明来源 n0bele@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2013-08-20 17:30 厂商回复： 很全面！非常感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}