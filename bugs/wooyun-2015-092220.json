{"id": 40192, "wybug_id": "wooyun-2015-092220", "wybug_title": "Mao10CMS可直接重装", "wybug_corp": "mao10.com", "wybug_author": "路人甲", "wybug_date": "2015-01-16 15:47", "wybug_open_date": "2015-04-16 15:48", "wybug_type": "默认配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-20：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-16：\t细节向公众公开  简要描述： rt 详细说明：  下载源码之后，搭建完该cms之后。发现install.php文件还在。\nerror_reporting(0);header(\"Content-Type: text/html; charset=utf-8\");$site_url = \"http://\".$_SERVER[\"HTTP_HOST\"].$_SERVER['PHP_SELF'];$site_url = preg_replace(\"/\\/[a-z0-9]+\\.php.*/is\", \"\", $site_url);if($_POST['db_host'] && $_POST['db_name'] && $_POST['db_user'] && $_POST['db_prefix']) {\t$file = \"Application/Common/Conf/db.php\";\t$data = \"<?phpreturn array(\t'DB_TYPE'   => 'mysql', // 数据库类型\t'DB_HOST'   => '\".$_POST['db_host'].\"', // 服务器地址\t'DB_NAME'   => '\".$_POST['db_name'].\"', // 数据库名\t'DB_USER'   => '\".$_POST['db_user'].\"', // 用户名\t'DB_PWD'    => '\".$_POST['db_pwd'].\"', // 密码\t'DB_PORT'   => 3306, // 端口\t'DB_PREFIX' => '\".$_POST['db_prefix'].\"', // 数据库表前缀\t'DB_CHARSET' => 'utf8', //数据库编码\t'ADMIN_LOGIN' => '\".$_POST['admin_login'].\"', //创始人账号\t'ADMIN_PASS' => '\".$_POST['admin_pass'].\"', //创始人密码); ?>\";\t$db_info = file_put_contents ($file, $data);\tif($db_info) {\t\t$callback = 1;\t} else {\t\t$callback = 2;\t};\t$con = mysql_connect($_POST['db_host'],$_POST['db_user'],$_POST['db_pwd']);\tmysql_query(\"CREATE DATABASE \".$_POST['db_name'],$con);\tif (!$con) {\t\t$callback = 2;\t};} else {\t$callback = 0;}\n可以看到没有任何验证，可以直接重新安装。   漏洞证明：  \n\n\n\n五个互联网实例\nhttp://www.dxsfood.com/install.php\n\nhttp://www.meiguo.com.cn/install.php\n\nhttp://freshfoodday.com/install.php\n\nhttp://www.hanguo2.com/install.php\n\nhttp://www.sushe.wang/install.php\n   修复方案：  看看其他cms吧！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-01-17 14:05 厂商回复： 这个在官网安装教程里，有提到安装完成后，手动删除相关安装文件。。不过还是有可能发生的，谢谢提示。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}