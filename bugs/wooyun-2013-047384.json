{"id": 59440, "wybug_id": "wooyun-2013-047384", "wybug_title": "番茄网敏感数据泄漏并可cookie欺骗登录后台", "wybug_corp": "番茄网", "wybug_author": "D_in", "wybug_date": "2013-12-30 11:21", "wybug_open_date": "2014-02-13 11:22", "wybug_type": "重要敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-30：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-02-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 番茄网原码泄漏，有数据库，但密码破解不出，查看原码发现cookie验证不严可构造登录后台 详细说明：  番茄网原码地址为：http://www.fqw8.com/web.rar下载后的原码\n\n发现数据库备份文件，导入mssql\n\n密码破解不出，查看后台登陆原码，发现cookie验证不严关键代码：\nprotected void BtnLogin_Click(object sender, EventArgs e)    {        string username = txtUserName.Text.Trim();        string userpwd = txtPassword.Text.Trim();        user.User_id = username;        user = userLogic.Login(user, EncryDncry.Encrypt(userpwd));        if (user != null)        {            SetCookie(\"BackUser\", \"USERINFO\", user.Id + \",\" + user.User_id + \",\" + user.User_name + \",\" + user.Role_id, 60);            Response.Redirect(\"../Main.aspx\");        }        else        {            base.ShowMessage(\"账号或密码错误或是账号未开启！\", \"\");        }    }\n未验证密码，可构造登录\n\n   漏洞证明：  如上！！！   修复方案：  登录处的cookie验证肯定要验证密码的。。。。。其实我也不是很懂。。   版权声明：转载请注明来源 D_in@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}