{"id": 12653, "wybug_id": "wooyun-2013-021445", "wybug_title": "迅雷会员帐号认证逻辑错误，导致业务限制失控", "wybug_corp": "迅雷", "wybug_author": "SinSoul", "wybug_date": "2013-04-09 13:19", "wybug_open_date": "2013-05-24 13:19", "wybug_type": "未授权访问/权限绕过", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当导致攻击界面扩大", "边界绕过", "认证缺陷", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-24：\t细节向公众公开  简要描述： 迅雷会员帐号认证逻辑错误，导致业务限制失控 详细说明：  在使用正确用户名登录一次后保存下跳转会话ID，即使在该用户已经修改密码后，会话ID仍然有效，并能成功登录和使用迅雷离线下载和云点播等服务。1.使用正确的白金会员帐号在迅雷云播桌面客户端（XunleiCloudPlayer.exe）中登录。2.在“云列表”选项卡中“去离线”链接便是包含持久sessionid的链接。3.即使用户此时更改密码，此链接依然有效，能跳转登录除aq.xunlei.com外的大多数迅雷二级域名以及kankan.com。4.之前一直购买淘宝1毛角6小时的白金会员帐号，并利用此漏洞可以连续使用一个月的迅雷离线下载和云播服务，现在迅雷离线手机客户端免费，这也没多大用了。   漏洞证明：  1.跳转至迅雷看看首页，并以会员身份登录http://jump.xunlei.com/sessionid/?sessionid=313129A35812E635FE0403B87BB90421BC057D5C26B6733F31F2529B66CCD55B1123CBCF8CD7763CC5CAD12578501DA96B9B68A0F5D6CD17882C3CF958529A5C65921D037DF4CE2B19C55F1101302354&u1=http://xunlei.com\n\n2.跳转至迅雷云播，并能正常使用白金会员功能http://jump.xunlei.com/sessionid/?sessionid=313129A35812E635FE0403B87BB90421BC057D5C26B6733F31F2529B66CCD55B1123CBCF8CD7763CC5CAD12578501DA96B9B68A0F5D6CD17882C3CF958529A5C65921D037DF4CE2B19C55F1101302354&u1=http://vod.xunlei.com\n\n3.跳转至迅雷离线下载，并可添加链接高速取回本地http://jump.xunlei.com/sessionid/?sessionid=313129A35812E635FE0403B87BB90421BC057D5C26B6733F31F2529B66CCD55B1123CBCF8CD7763CC5CAD12578501DA96B9B68A0F5D6CD17882C3CF958529A5C65921D037DF4CE2B19C55F1101302354&u1=http://lixian.xunlei.com\n\n4.跳转时设置cookie的HTTP请求及响应头（1）HTTP请求头GET /sessionid/?sessionid=313129A35812E635FE0403B87BB90421BC057D5C26B6733F31F2529B66CCD55B1123CBCF8CD7763CC5CAD12578501DA96B9B68A0F5D6CD17882C3CF958529A5C65921D037DF4CE2B19C55F1101302354&u1=http://vod.xunlei.com HTTP/1.1Accept: image/jpeg, application/x-ms-application, image/gif, application/xaml+xml, image/pjpeg, application/x-ms-xbap, */*Accept-Language: zh-CNUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)Accept-Encoding: gzip, deflateHost: jump.xunlei.comConnection: Keep-Alive（2）HTTP响应头HTTP/1.1 302 FoundSet-Cookie: downbyte=120090084222; PATH=/; DOMAIN=xunlei.com;Set-Cookie: downfile=81; PATH=/; DOMAIN=xunlei.com;Set-Cookie: isvip=1; PATH=/; DOMAIN=xunlei.com;Set-Cookie: jumpkey=F9D22467C5A96D326DD81F2151A0CACC1CFFE3729308142F5FACA3AF89C101551FBD40C63D3958E97A569DC18C63B0B1564218D92649CD1B95DEE975E3C940BEACE2FDB5CC52DDD5DE0CB4543570D033; PATH=/; DOMAIN=xunlei.com;Set-Cookie: logintype=0; PATH=/; DOMAIN=xunlei.com;Set-Cookie: nickname=bhkxvwrish; PATH=/; DOMAIN=xunlei.com;Set-Cookie: onlinetime=397261; PATH=/; DOMAIN=xunlei.com;Set-Cookie: order=193073842; PATH=/; DOMAIN=xunlei.com;Set-Cookie: safe=0; PATH=/; DOMAIN=xunlei.com;Set-Cookie: score=949; PATH=/; DOMAIN=xunlei.com;Set-Cookie: sessionid=313129A35812E635FE0403B87BB90421BC057D5C26B6733F31F2529B66CCD55B1123CBCF8CD7763CC5CAD12578501DA96B9B68A0F5D6CD17882C3CF958529A5C65921D037DF4CE2B19C55F1101302354; PATH=/; DOMAIN=xunlei.com;Set-Cookie: sex=u; PATH=/; DOMAIN=xunlei.com;Set-Cookie: upgrade=0; PATH=/; DOMAIN=xun   修复方案：  不修复也无所谓，反正云播无登录IP限制，一个链接便可大家一起分享使用迅雷白金服务，业界良心。   版权声明：转载请注明来源 SinSoul@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2013-04-09 16:31 厂商回复： 要修复，本周的新版云播会改进这个问题。感谢反馈！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-12 11:49 |    \t\t八云幽紫 \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:9        | 无)\t\t \n  看云播里的内容我各种呵呵    \n     2013-05-26 17:05 |    \t\tscan_z \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:4        | /home/work/newsphp/newsroot/temp/smarty/...)\t\t \n  买过几毛钱用迅雷看种子都清楚。。。而且买的号里面有前辈遗留的“福利”楼猪是不是也打算去扫黄那举报下？还有奖金哦。很高兴只给Rank：2     \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}