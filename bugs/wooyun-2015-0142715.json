{"id": 67473, "wybug_id": "wooyun-2015-0142715", "wybug_title": "安徽某银行官网SQL注入一枚（附送XSS两枚）", "wybug_corp": "tlrcb.com.cn", "wybug_author": "路人甲", "wybug_date": "2015-09-24 10:14", "wybug_open_date": "2015-11-13 08:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-29：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-10-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-13：\t细节向公众公开  简要描述： 喜闻乐见的注入. 详细说明：  安徽省铜陵农商行主站存在SQL注入，导致系统可被拖库泄露敏感信息，顺便附赠XSS。   漏洞证明：  问题1：存在注入的页面：http://**.**.**.**/public.asp?page=2&search=1&second_id=8003&third_id=0\n\n在search参数后面加一个’,系统报错，明显存在SQL注入\n\nSQLMAP拿来测试下：\n\n证明SQL注入问题存在，网速慢我就不拖库了。该系统在select.asp页面中同样使用了search参数，提交方式为POST，也存在SQL注入。构造如下POST请求：\nPOST /select.asp?second_id=18001 HTTP/1.1Content-Length: 37Content-Type: application/x-www-form-urlencodedReferer: http://**.**.**.**/Cookie: id=0; ASPSESSIONIDCSQSSQRT=ANGKDHODMECNMJIAKMHEKGHLHost: **.**.**.**Connection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*search=1&second_id=18001&submit=1\n测试如下：\n\n问题2：系统同样存在XSS漏洞第一个XSS：构造如下数据提交：\n\n第二个XSS：构造如下数据提交：\n\n还有呢，就不一一列举了，过滤字符吧....   修复方案：  你们是Expert。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-09-29 08:36 厂商回复： CNVD确认所述情况,已经转由CNCERT下发给安徽分中心,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-29 08:53 |    \t\t暴走 \t\t\t( 普通白帽子  |\t\t\t        Rank:282 漏洞数:62        | Wooyun的Rank获取如同Dota冲天梯有过之而无...)\t\t \n  厂商给10个，Wooyun你就给2个，可以的....    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}