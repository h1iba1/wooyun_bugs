{"id": 49437, "wybug_id": "wooyun-2015-0126265", "wybug_title": "生命人寿保险越权查询其他用户保单信息/泄漏1700万条信息", "wybug_corp": "富德保险控股", "wybug_author": "Jinone", "wybug_date": "2015-07-12 11:06", "wybug_open_date": "2015-08-30 11:46", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-30：\t细节向公众公开  简要描述： 你看看 详细说明：  测试过程：1 为方便操作，A.B用户在网上商城分别在网上商城下单：A用户登录手机客户端查看保单(李先生)：\n\n查看B用户保单号以及信息（王先生）：\n\n手机端查看时修改请求数据中的保单号\n\n手机端看到B用户保单信息：\n\n看来越权存在,测试了另一个保单号：\n\n看着关键信息被隐藏掉，但是查看请求数据返回值时发现，返回了全部的信息：\n\n\n\n看保单号的格式，应该是+1自增长，测试了几个数据：10万：\n\n100万：\n\n1000万：\n\n1500万：\n\n由此可证明数据量已经达到1800多万，使用burp进行了测试，只遍历了一下最后46000多条数据：\n\n跑到3600条时查看了一下，有35600多条记录(没有截取地址信息)：\n\n几乎每条请求都有返回身份证号，目前共有1866万余条数据，去掉个别空的以及最开始的测试数据，数据量达到1700万应该没有问题。从返回数据可以看出，泄露了投保人员的姓名，性别，证件号，家庭住址，手机号等隐私信息。被其他保险公司利用只是丢失客户，如果被非法分子利用，有如此详细的信息，诈骗成功的机会应该非常高。为了测保单，都真的花钱买了。。。。   漏洞证明：  10万：\n\n100万：\n\n1000万：\n\n1500万：\n\n由此可证明数据量已经达到1800多万，使用burp进行了测试，只遍历了一下最后46000多条数据：\n\n跑到3600条时查看了一下，有35600多条记录(没有截取地址信息)：\n\n   修复方案：  权限检查   版权声明：转载请注明来源 Jinone@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-07-16 11:45 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向保险行业信息化主管部门通报,由其后续协调网站管理单位处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-16 09:19 |    \t\t生命人寿(乌云厂商)\t\t \n  @疯狗 看不到漏洞详情。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}