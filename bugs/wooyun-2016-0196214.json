{"id": 87361, "wybug_id": "wooyun-2016-0196214", "wybug_title": "富士施乐打印机默认配置不当/可远程查看打印记录并打印文件                                      ", "wybug_corp": "富士施乐", "wybug_author": "K‘", "wybug_date": "2016-04-14 18:40", "wybug_open_date": "2016-06-02 16:40", "wybug_type": "默认配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["终端机安全", "安全管理不到位", "默认密码", "网络边界设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-02：\t细节向公众公开  简要描述： 富士施乐公司是全球最大数字与信息技术产品生产商，是一家全球500强企业。是复印技术的发明公司，具有悠久的历史，在其复印机市场占有率，特别是彩色机器的市场占有率，占据全球第一的位置 详细说明：  富士施乐智能打印机默认配置不当，打印机默认开启端口如下：\n\n打印机默认是以LPD方式进行打印，LPD它的功能是等待接受客户使用行式打印机远程（LPR）协议传来的打印工作。当LPD收到一个打印任务后，它先将打印任务暂存于打印队列中，打印队列是一个文件子目录，其中有许多打印工作等待LPD进行处理。当打印设备空闲时，LPD从打印队列中取出打印任务并将它传给打印机进行打印。但是实际上，可以通过Port9100和FTP服务进行打印。默认打印机配置是不对IP地址进行限制的，而且也存在默认账户口令\n用户名：11111密码：x-admin\n首先先说Port9100Port9100也是一种默认的打印流协议端口，但是富士施乐打印机默认并不会对Port9100端口进行限制，而暴露在公网上的打印机则可以通过远程的方式进行打印（附POC），通过向Port9100端口传输信息即可实现打印。Ftp服务默认状态下也是开启的，之前并没有想过Ftp居然也可以打印，后来登陆Ftp服务器之后put了一个文件，发现居然被打印机打印出来了！而Ftp方面并不在Web界面的默认配置中，也就是说，无法通过限制IP的方式限制其他用户远程通过Ftp进行打印，当然，前提是用户名密码是默认的。附一张测试图\n\n好吧，也许本地的没啥说服力，我又找了个远程的\n\n貌似是一个台湾的洗衣店对！这也是另一个问题，可以查看打印记录！虽然说暂时只能看标题，但是我觉得拿到VNRAM中的东西是迟早的事，好吧，我吹的，但是确实安全性上跟易用性冲突很多，大概思路是利用Ftp上传pdf，嗯富士施乐默认使用Adobe打开~好的，也许“漏洞之王”能给点福利呢。 远程打印问题说大不大，往小了说顶多耗光你的纸。往大了，其实可以通过远程散发一些小传单啊 伪造文件之类还是很好实现的。   漏洞证明：  \n\n\n\n\n\nzoomeye上还是很多的，远程打印机设备\n\n\n目前测试来看，不论啥具体型号~只要是远程的富士施乐设备，就有这个问题~~~\n然后还有一个问题！EPSON的某些打印机使用的跟富士施乐的一样的系统~是的，端口也一样！也有这个问题，百度了一下这也不是一家啊，感觉可能是一个通用的问题？   修复方案：  默认配置要改改或者加点限制吧？   版权声明：转载请注明来源 K‘@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-04-18 16:38 厂商回复： CNVD未复现所述情况，已经由CNVD通过网站公开联系方式向网站管理单位通报。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}