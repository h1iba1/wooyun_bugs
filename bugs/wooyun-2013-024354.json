{"id": 64778, "wybug_id": "wooyun-2013-024354", "wybug_title": "电子科技大学中山学院图书馆后台万能密码登陆", "wybug_corp": "电子科技大学", "wybug_author": "malayke", "wybug_date": "2013-05-23 15:47", "wybug_open_date": "2013-07-07 15:48", "wybug_type": "后台弱口令", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "配置错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-23：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-07-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 电子科技大学中山学院图书馆后台万能密码登陆http://lib.zsc.edu.cn/admin/adminlogin.asp 详细说明：  万能密码:'or'='or' 直接能进入后台页面   漏洞证明：  \n\n   修复方案：  方法1: Replace过滤字符解决方法:查找login.asp下的<from找到下边的类似username=request.Form(\"name\")pass=request.Form(\"pass\")修改为：username=Replace(request.Form(\"name\"), \"'\", \"''\")pass=Replace(request.Form(\"pass\"), \"'\", \"''\")语法是屏蔽'和''字符来达到效果.方法2：在conn.asp 内加入<!--#include file=\"safe.asp\"-->注：（前提 登陆页面有<!--#include file=\"conn.asp\"-->）把以下代码保存为safe.asp下面是程序代码********************************************************<% Dim Query_Badword,Form_Badword,i,Err_Message,Err_Web,name Err_Message = 3Err_Web = \"404.htm\" '出错时转向的页面 Query_Badword=\"'|and|select|update|chr|delete|%20from|;|insert|mid|master.|set|chr(37)|=\" '在这部份定义get非法参数,使用\"|\"号间隔,还可以增加Form_Badword=\"'|(|)|;|=\" '在这部份定义post非法参数,使用\"|\"号间隔 On Error Resume Next if request.QueryString<>\"\" then Chk_badword=split(Query_Badword,\"|\") FOR EACH Query_Name IN Request.QueryString for i=0 to ubound(Chk_badword) If Instr(LCase(request.QueryString(Query_Name)),Chk_badword(i))<>0 Then Select Case Err_Message Case \"1\" Response.Write \"<Script Language=JavaScript>alert('传参错误！参数 \"&name&\" 的值中包含非法字符串！nn请不要在参数中出现：and update delete ; insert mid master 等非法字符！');window.close();</Script>\" Case \"2\" Response.Write \"<Script Language=JavaScript>location.href='\"&Err_Web&\"'</Script>\" Case \"3\" Response.Write \"<Script Language=JavaScript>alert('传参错误！参数 \"&name&\"的值中包含非法字符串！nn请不要在参数中出现：and update delete ; insert mid master 等非法字符！');location.href='\"&Err_Web&\"';</Script>\" End Select Response.End End If NEXT NEXT End ifif request.form<>\"\" then Chk_badword=split(Form_Badword,\"|\") FOR EACH name IN Request.Form for i=0 to ubound(Chk_badword) If Instr(LCase(request.form(name)),Chk_badword(i))<>0 Then Select Case Err_Message Case \"1\" Response.Write \"<Script Language=JavaScript>alert('出错了！表单 \"&name&\" 的值中包含非法字符串！nn你的非法操作已记录,请马上停止非法行为！');window.close();</Script>\" Case \"2\" Response.Write \"<Script Language=JavaScript>location.href='\"&Err_Web&\"'</Script>\" Case \"3\" Response.Write \"<Script Language=JavaScript>alert('！参数 \"&name&\"的值中包含非法字符串！n谢谢您光临！,请停止非法行为！');location.href='\"&Err_Web&\"';</Script>\" End Select Response.End End If NEXT NEXT end if %>防注意入也可以用这段代码。。。   版权声明：转载请注明来源 malayke@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}