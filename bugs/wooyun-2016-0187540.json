{"id": 86201, "wybug_id": "wooyun-2016-0187540", "wybug_title": "运营商安全之中国移动某海外业务命令执行（涉及多库）", "wybug_corp": "中国移动", "wybug_author": "李旭敏", "wybug_date": "2016-03-22 02:20", "wybug_open_date": "2016-05-09 17:29", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-09：\t细节向公众公开  简要描述：  详细说明：  \nhttps://**.**.**.**\n\n\n\nWhoami: WebPath: /app/smscorpoffer/v07/htdocs/htmlOS.Name: SunOSOS.Version: 5.10Java.Home: /usr/jdk/instances/jdk1.6.0/jreJava.Version: 1.6.0_16OS.arch: sparcv9User.Name: tomcatUser.Home: /usr/local/jakartaUser.Dir: /usr/local/jakartaJava.Class.Path: ./:/usr/java/lib/tools.jar:/usr/java/bin:/usr/java/lib:/u01/app/oracle/product/10.2/jdbc/lib/ojdbc14.jar:/u01/app/oracle/product/10.2/jdbc/lib/classes12.zip:/u01/app/oracle/product/10.2/jdbc/lib/nls_charset12.jar:/usr/j2ee/lib/j2ee.jar:/usr/local/jakarta/tomcat/bin/bootstrap.jar:/usr/local/jakarta/tomcat/bin/commons-logging-api.jarJava.IO.Tmpdir: /usr/local/jakarta/tomcat/temp\n   漏洞证明：  \n\nhosts文件\n#::1\tlocalhost\t**.**.**.**\tlocalhost\t**.**.**.**     ad**.**.**.**   vas1    game1\t**.**.**.****.**.**.**   vas3    **.**.**.** \tloghost**.**.**.**  orgsms  **.**.**.****.**.**.**  dsd     **.**.**.****.**.**.**  corpsms     **.**.**.****.**.**.**1  vasback1**.**.**.**04 test-vas3       test-**.**.**.****.**.**.**14 test-**.**.**.****.**.**.**15 test-**.**.**.****.**.**.**00 itadmin01 log01**.**.**.**     hp01**.**.**.**     mis01**.**.**.**     mbs1**.**.**.**     mbs2**.**.**.**     mbs1-vip**.**.**.**     mbs2-vip**.**.**.**  hpmis     **.**.**.****.**.**.**     gemprot**.**.**.**     gemprop\n在网站的根目录下有个叫hi.jsp的文件，我起初以为是webshell，但神奇的是里面保存了数据库配置信息 \t\t\t\nString driverClassName = \"oracle.jdbc.driver.OracleDriver\";\t\t\tString dbURL = \"jdbc:oracle:thin:@dev2:1521:ptcdev2\";\t\t\tString dbUser = \"ptcwap\";\t\t\tString dbPassword = \"pawptc\";\t\t\tClass.forName(driverClassName);\n\n#database connectiondbcpName = java:comp/env/jdbc/debug_ptcwap_ptcgvasdb_driver= oracle.jdbc.driver.OracleDriverdb_url   = jdbc:oracle:thin:@dev2:1521:ptcdev2db_username = ptcmailerdb_password = ptcmailer\n\n#database connection#corpsms.dbcpName =java:comp/env/jdbc/ptcwap_ptcgvascorpsms.db_driver=oracle.jdbc.OracleDrivercorpsms.db_url=jdbc:oracle:thin:@vas1:1521:vascorpsms.db_username=vascorpsms.db_password=freevas#mms.dbcpName =java:comp/env/jdbc/ptcwap_ptcgvasmms.db_driver=oracle.jdbc.OracleDrivermms.db_url=jdbc:oracle:thin:@vas1:1521:ptcgvasmms.db_username=MMSOWNmms.db_password=OWNMMS\n   修复方案：     版权声明：转载请注明来源 李旭敏@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2016-03-25 17:29 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国移动集团公司通报,由其后续协调网站管理部门处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}