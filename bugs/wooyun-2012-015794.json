{"id": 14982, "wybug_id": "wooyun-2012-015794", "wybug_title": "某机场主站后台登陆绕过以及上传漏洞", "wybug_corp": "机场", "wybug_author": "肉肉", "wybug_date": "2012-12-10 11:40", "wybug_open_date": "2013-01-24 11:40", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "本地"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-12-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-24：\t细节向公众公开  简要描述： 某机场主站后台登陆绕过和上传漏洞，拿的shell直接是root权限. 详细说明：  成都双流机场网站的漏洞网站后台：http://www.cdairport.com/cdairportback/利用弱口令：1'or'1'='1 可以成功进后台然后在增加新闻的地方（注意：需要在已发布的新闻里面上传才行，直接发布新闻上传服务器会过滤上传文件，编辑已发布新闻服务器那边就会报错，从而绕过服务器对上传文件的检测），先随便发布一个新闻，或者编辑已有的新闻，然后再编辑该新闻里面选择类型二就会出现有上传漏洞的上传点如图1\n\n该上传点虽然本地和服务器都有验证，但是编辑已有新闻的情况下去抓包修改一下后缀就可以成功上传jsp的webshell,然后webshell直接是root了。如图2\n\n   漏洞证明：  同上   修复方案：  修补后台登陆的逻辑处理代码，并且那个上传页面进行服务器端的文件验证。   版权声明：转载请注明来源 肉肉@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2012-12-11 14:14 厂商回复： CNVD确认漏洞情况，已转由CNCERT四川分中心协调涉事单位处置，此前有白帽提交了该网站的远程代码执行漏洞。按部分影响机密性、可用性、完整性进行评分，基本危害评分7.48（高危），发现技术难度系数1.1，涉及行业或单位影响系数1.3，综合rank=10.696 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-10 12:50 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  @cncert国家互联网应急中心最开始提交的漏洞描述有问题哦，描述里面的方法不能复现那个漏洞的，现在编辑了，乌云还需要审核才能更新,如果看到是之前发的漏洞描述，麻烦等一下更新哈，不然无法复现漏洞的。=。=    \n     2012-12-11 14:12 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  @肉肉 没事，已经下发处置了，无碍。    \n     2013-01-01 08:44 |    \t\tSunshine \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:10        | Nothing.)\t\t \n  求一个jspspy。。。。。    \n     2013-01-03 12:44 |    \t\tJ4nker \t\t\t( 普通白帽子  |\t\t\t        Rank:136 漏洞数:35        | I have a dream)\t\t \n  表示他们居然还没处理。 好心告诉 居然不当回事    \n     2014-01-17 21:18 |    \t\t小七 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 好好学习，天天向上)\t\t \n  @cncert国家互联网应急中心 为啥我提交的政府网站 漏洞rank 是12  给我的且不到12？才两三个     \n     2014-01-17 22:07 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  @小七 有些漏洞走的是小厂商流程，这个漏洞是改革前的    \n     2014-01-18 10:46 |    \t\t小七 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 好好学习，天天向上)\t\t \n  @肉肉 是国家应急中心的。。。。但是给我不到他给的rank      \n     2014-01-18 14:08 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  其实我没懂你在说什么呢，不过，看这里吧http://wooyun.org/notice.php?action=view&id=28    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}