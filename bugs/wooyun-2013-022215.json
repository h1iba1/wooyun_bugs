{"id": 12450, "wybug_id": "wooyun-2013-022215", "wybug_title": "多玩客户端大规模挂马思路+安全性测试", "wybug_corp": "广州多玩", "wybug_author": "杀戮", "wybug_date": "2013-04-21 13:33", "wybug_open_date": "2013-06-05 13:34", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-05：\t细节向公众公开  简要描述：    就是要带感~~~~    本屌丝申明一下，我是一名非常有道德感的前端安全爱好者，绝对不是想下载刺客信条的时候吃饱撑的打了一个引号进去。 详细说明：  问题出现在客户端上面，很多著名的公司都会忽略了存在于客户端上面的Web问题，可能他们想法就是类似 网站的安全是SQL XSS之类的 客户端的就是溢出之类的.....多玩公司有一个主产品 快快游戏，用来下载各种类型的游戏。\n\n好吧，我是吃饱撑的看见那个搜索框无聊了一下，结果发现存在XSS漏洞;\n\n这种漏洞跟没用也没多大区别，但是换一种思路，这玩意的构架是Web，所以ENTER\n<a onclick=alert(location.href);>CLICK</a>\n\n\n就可以通过浏览器打开网页进行系统一点的检测了。\n\n在想想有没有别的地方还可能存在同样的漏洞，对了，回复。我们试试，为了方便大家观看，接下来都是插入单击事件。为了不影响到玩家，我们用超级玛丽的页面测试(没什么人玩)，ENTER:\n<a onclick=alert(1)>CLICK</a>\n\n\n为了方便接下来的测试，我们需要检测下客户端的使用的浏览器，Enter:\n<a onclick=alert(navigator.userAgent)>CLICK</a>\n\n\n看见Trident就可以知道是IE了，那么接下来呢，测试下IE版本下比较容易出现过的漏洞;其中一个是UNC访问问题，具体阅读黑哥这篇文章\nhttp://www.80vul.com/webzine_0x05/走向本地的邪恶之路\nEnter:\n<iframe src=\"file:////127.0.0.1/\">CLICK</a>\n\n\n你个悲剧。。。。其他自己测试吧，再想想这玩意能不能挂马呢。。。先测试下能不能进行页面跳转，或者有没有域的限制。先Enter\n<a onclick=\"location='http://www.baidu.com';\">CLICK</a>\n输入之后再测试，丫的没跳成功，直接出现一个通用错误页面，用浏览器查看，发现问题了，好吧，网址给过滤掉了。\n\n有没有办法绕过呢，一般检测网址的手段是 查看有没有http://  或者是有没有WWW啊其实 输入 //[网址]  也是可以的 这样的输入会根据当前协议进行跳转。比如file:// 你页面中的//url跳的时候就是用file://Enter:\n<a onclick=\"location='//baidu.com';\">CLICK</a>\n然后.......\n\n你个悲剧..........然后我们改如何进行挂马呢，一般用户用这个软件图什么呢，下载游戏呗，我们淫荡下，首先准备一个别人下载了也不会殴打我的文件，嗯，对，就是这个。。。。\n\n然后用插入DOM将代码修改，或者使用点击劫持。然后就是.。。。。\n\n\n\n大概就是这种效果......   漏洞证明：  上面上面话说，写完这篇，有点想吐。   修复方案：  打个广告。http://t.qq.com/SlaughterSain技术不行，哪里写错了见谅   版权声明：转载请注明来源 杀戮@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-04-22 16:44 厂商回复： 非常感谢对于欢聚时代(YY/多玩游戏)的安全工作的支持，请继续支持欢聚时代安全工作！ 谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-21 15:30 |    \t\tyy520 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:12        )\t\t \n  刺客信条 变得不好玩了    \n     2013-04-22 16:47 |    \t\tlucky \t\t\t( 普通白帽子  |\t\t\t        Rank:409 漏洞数:81        | 三人行必有我师焉########################...)\t\t \n  什么情况！    \n     2013-05-13 15:39 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:170        | 力不从心)\t\t \n  5？不行啊，应该给10以上    \n     2013-05-23 15:50 |    \t\tACGT \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:4        | another script kiddie)\t\t \n  给5rank说明根本没搞明白这个漏洞的严重性。。    \n     2013-06-05 13:52 |    \t\t脚本小伙 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:15        | 小书童)\t\t \n  这么严重的问题 才给5 RANK? 多玩这个丫的 太小气了    看来裤子还被拖的次数不够的导致的    \n     2013-06-05 14:00 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  楼主v5    \n     2013-06-08 13:56 |    \t\tMax \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:7        | When you see this sentence, I have been ...)\t\t \n  @ACGT +1多玩不重视    \n     2014-07-02 15:09 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @脚本小伙 严重么。。。其实就是一个xss    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}