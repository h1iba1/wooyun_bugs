{"id": 13853, "wybug_id": "wooyun-2013-018393", "wybug_title": "住哪网密码重置缺陷和订单支付漏洞新年红包", "wybug_corp": "住哪网", "wybug_author": "带馅儿馒头", "wybug_date": "2013-02-05 11:53", "wybug_open_date": "2013-03-22 11:54", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-02-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-02-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-03-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-22：\t细节向公众公开  简要描述： RT 详细说明：  1.任意用户密码重置；1.1 来到用户重置密码功能页面，输入需要重置的手机号码；\n\n1.2 点击下一步，系统会发送一个6位数字验证码到对应手机号码，验证码有效期45分钟（足够我们重置一个用户密码）；\n\n1.3 随意填写一个6位数字验证码和需要重置的密码，点击提交并抓包；\n\n1.4 设置\"mobileverifycode\"为爆破参数开始暴力破解，这里测试用自己手机号码，设置验证码区间为包含真是验证码的一个较小6位数字区间，系统未限制验证码校验错误次数，当爆破到真实验证码时密码即被重置，我们可根据系统返回字节长度进行确认；\n\n1.5 使用重置后的密码即可成功登录该用户账户；2.订单支付漏洞；2.1 随意选择一张机票预订，下面是正常预订的情况；\n\n2.2 重新预订该机票，并在过程中抓包分析发现了各种价格参数；\n\n2.3 这里为了进行测试，各种价格全部修改为“1”并提交；\n\n2.4 能够正常进行支付；\n\n3.服务器敏感信息泄露；\n\n\n\n\n\n   漏洞证明：  见详细说明   修复方案：  1.限制验证码校验错误次数；2.校验各个参数合法行；3.隐藏服务器敏感信息；   版权声明：转载请注明来源 带馅儿馒头@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-02-05 14:07 厂商回复： 谢谢对我们安全的关注！ 最新状态： 2013-02-06：@带馅儿馒头 请留下联系方式，以便我们给您送出礼物..  ", "replys": "漏洞评价：\n评论\n     2013-02-05 13:34 |    \t\tValo洛洛 \t\t\t( 普通白帽子  |\t\t\t        Rank:458 漏洞数:52        | 。)\t\t \n  都来走流程了。。被你先发了    \n     2013-02-05 13:36 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:143        | 心在，梦在)\t\t \n  @Valo洛洛 哈哈，，，管理员看我还是0分，，，    \n     2013-02-05 13:39 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @带馅儿馒头 快说哪个的小号 我发现除了我都是一个人的马甲    \n     2013-02-05 15:08 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:143        | 心在，梦在)\t\t \n  @xsser http://www.wooyun.org/bugs/wooyun-2013-018402/trace/f0e61fc3be285fd9972e28e6630527be 这洞子重复了么？    \n     2013-02-06 12:50 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:143        | 心在，梦在)\t\t \n  @住哪网 已经短消息发给你们咯！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}