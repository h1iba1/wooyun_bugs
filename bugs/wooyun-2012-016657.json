{"id": 14611, "wybug_id": "wooyun-2012-016657", "wybug_title": "过年放假，买点1分钱华图网校充电吧~外加一个误操作引发的血案", "wybug_corp": "华图网校", "wybug_author": "superwbd", "wybug_date": "2012-12-30 14:52", "wybug_open_date": "2013-02-13 14:53", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-30：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-02-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 预祝大家过年好~过年了，别光顾着休闲，适当的充电也是必要的~比如——考个铁饭碗什么的虽说就是一个网校，但是价格可不比肾5便宜呢~ 详细说明：  华图网校。我在国外都知道这个名字，貌似在公考界比蓝翔有名？注册啊，购买啊，就不说了。\n\n好贵的说。。。先burp吧。。。很明显的是，管理员用心了。价格走数据库，burp什么的才没用呢~~\n\n改过一次，还是会回来的。。。而且。。。26个match。。。这得闹到猴年马月啊。。。自我批评下，我一般发漏洞的时候，都是完成一次，然后再来一次，供演示截图。所以吧。。。就误操作了。。。把没有改完的数据直接扔出去了。。。\n\n看起来好像是改了，但实际上支付的金额。。。那个地方还没有改啊魂淡！无奈，死马当活马医吧。先支付看看。然后。。。看到了惊人的一幕：\n\n亲。。。您怎么。。。在这里post真正的金额啊？！   漏洞证明：  接下来放走一大堆支付宝的数据包。这些不要改。。。改了也是没有用的。。。只会让支付宝报错。。。\n\n看来。。。是成功了的说。。。没支付宝，没法测试了。这种网校，估计没有人工复查，都是即时开通的。。。危害大家可以自行脑补了~   修复方案：  所谓的“死在最后一哆嗦上”。亲，前面都想起来价格走数据库了，最后一下让用户POST。。。您是怎么想的呢？   版权声明：转载请注明来源 superwbd@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-12-30 16:07 |    \t\t小菜虫 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:5        )\t\t \n  明年还准备靠这个呢 结果你发出来了    \n     2012-12-31 06:44 |    \t\tsuperwbd \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 一个不懂技术的黑客。。。)\t\t \n  补充下：最后POST的时候是真实的金额，截图晚了，把原数字改了之后才想起来。。。原文是：MoneySum=5590 （看来在床上干活还是不行的。。。掏鼠标费劲。。。）    \n     2013-02-13 18:07 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  其实偷偷告诉你 前面再怎么取数据库的值，推送到支付接口的数据是肯定可以改的，只不过没做签名校验和回调检查    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}