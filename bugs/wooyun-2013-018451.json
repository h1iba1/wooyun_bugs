{"id": 13680, "wybug_id": "wooyun-2013-018451", "wybug_title": "住哪网取消任意用户订单，可批量执行", "wybug_corp": "住哪网", "wybug_author": "小胖胖要减肥", "wybug_date": "2013-02-18 14:47", "wybug_open_date": "2013-04-04 14:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-02-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-02-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-03-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-03-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-04-04：\t细节向公众公开  简要描述： 住哪网取消任意用户订单，可批量执行，权限控制问题，希望重视，还看到有礼物 详细说明：  这类问题我提过很多次，影响的话还是蛮大的，注册2个账号，下1个订单，问题还是在于有字段可以做控制但开发童鞋没有做控制\n\n这个时候先查看另一个账号的作废订单的链接\nhttp://www.zhuna.cn/user/canceled.asp?f=51273654&u=aa43e59168c91dbf\nmd5解密为li51273654看上去这个u应该能作为唯一判断，只要li为不固定的话，那样就无法批量执行了，即时知道订单，因为脚本可以参数啊递增可是下了单在另外一个账号试了一下，复制上面地址，订单改为\n\n即链接\nhttp://www.zhuna.cn/user/canceled.asp?f=51274571&u=aa43e59168c91dbf\n   漏洞证明：  另外一个账号访问该链接，查看结果\n\n在看当前订酒店的账号的订单状态\n\n   修复方案：  严格校验url里的u作为控制条件或使用其他方式认证身份权限   版权声明：转载请注明来源 小胖胖要减肥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2013-02-18 14:52 厂商回复： 非常感谢，这个问题我们已经重视，并正在解决 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}