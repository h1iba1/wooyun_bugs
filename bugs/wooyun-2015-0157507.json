{"id": 72630, "wybug_id": "wooyun-2015-0157507", "wybug_title": "亲宝宝Android客户端任意账户密码重置", "wybug_corp": "http://www.qbb6.com/", "wybug_author": "路人甲", "wybug_date": "2015-12-02 10:02", "wybug_open_date": "2016-01-16 10:04", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["客户端程序设计错误", "手机应用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-02：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-01-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 媳妇推荐我用这个APP，于是顺手改了她的密码。。。 详细说明：  在用手机注册的时候，发现验证码是4位的，感觉有被暴力猜解的可能，于是测试一下，结果却发现验证码在发送请求的时候被直接返回了。这样，即使用一个实际不存在的手机号也可以注册，如13512345678。\n\n验证码 code:6390被直接返回了\n\n输入验证码，进到这里。提示已注册过了，可以登录或者继续注册一个（如果选择这一项，原来的内容就废了，失去了和手机号的关联）。登陆进去发现，这应该是一个测试人员的账号，囧\n\n同样的方式，换一个没被注册过的号码试试，可以注册成功。\n\n并且找回密码也是一样，可以直接根据返回的code重置密码。\n\n实际上，输入验证码后是会再次到服务器验证的。所以在请求时直接返回了验证码应该是个bug，但是影响很大。\n\n如图，在对code进行des加密后，会再次到服务器上验证。\n\n发送到服务器的数据包会进行自签名(计算值sign)，如果用burp简单的修改手机号码后就进行重发就会报500\n\n但是这个算法是可以被模拟的，也不是绝对的安全。\n\n\n\n用一个类似的算法就可以计算sign。\n\n   漏洞证明：  可以随意申请账号，也可以重置任意账号密码。   修复方案：  1. 千万不要在请求手机验证码时直接把验证码通过web返回2. 最好使用6位验证码3. IOS端如果是类似逻辑需要一并修改   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评价\n     2015-12-07 10:37 |    \t\t》学无止境《 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 关注智能硬件，打造美好生活。)\t\t \n  大神带我装逼带我飞好不好嘛。    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}