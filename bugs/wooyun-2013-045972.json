{"id": 6374, "wybug_id": "wooyun-2013-045972", "wybug_title": "ESET官方论坛某程序任意代码写入漏洞", "wybug_corp": "ESET NOD32", "wybug_author": "猪猪侠", "wybug_date": "2013-12-14 21:05", "wybug_open_date": "2014-01-28 21:06", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "客户端提交内容未检查"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-28：\t细节向公众公开  简要描述： ESET官方论坛为了方便，使用了某程序进行效率提升，但由于此程序存在任意代码写入漏洞，从而导致威胁放大。 详细说明：  #1 漏洞细节Discuz!某自带程序存在任意代码写入漏洞 WooYun: discuz!某自带工具可拿shell 看到了 @kobin97 大牛提到了一个Discuz!自带工具的漏洞，我想应该就是这个！#2 详细描述Discuz! X 系列产品升级/转换程序，utility\\convert\\include\\global.func.php文件中的save_config_file函数过滤不够严格，导致可写入任意代码至\\data\\config.inc.php文件。#3 漏洞利用http://club.eset.com.cn/convert/index.php?a=config&source=d7.2_x2.0\n\n   漏洞证明：  #4 漏洞证明\n\n\n[*] 基本信息 [ \tLinux CNAYCET6083 2.6.32-220.13.1.el6.x86_64 #1 SMP Tue Apr 17 23:56:34 BST 2012 x86_64(www) ][/usr/local/webroot/club.eset.com.cn/wwwupgrade/convert/data/]$ /sbin/ifconfig -aeth0      Link encap:Ethernet  HWaddr 00:16:3E:0E:0C:EE            inet addr:10.200.6.170  Bcast:10.200.15.255  Mask:255.255.240.0          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:69396772 errors:0 dropped:0 overruns:0 frame:0          TX packets:70642 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:3119866448 (2.9 GiB)  TX bytes:3726468 (3.5 MiB)          Interrupt:19 eth1      Link encap:Ethernet  HWaddr 00:16:3E:0E:0C:F0            inet addr:42.121.99.83  Bcast:42.121.99.255  Mask:255.255.252.0          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:597597090 errors:0 dropped:0 overruns:0 frame:0          TX packets:140603318 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:35419942701 (32.9 GiB)  TX bytes:309437988853 (288.1 GiB)          Interrupt:20 lo        Link encap:Local Loopback            inet addr:127.0.0.1  Mask:255.0.0.0          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:125674285 errors:0 dropped:0 overruns:0 frame:0          TX packets:125674285 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:176335194279 (164.2 GiB)  TX bytes:176335194279 (164.2 GiB)[/usr/local/webroot/club.eset.com.cn/wwwupgrade/convert/data/]$\n   修复方案：  #1 不需要时刻用到的程序或功能，用完即删！   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-12-16 11:25 厂商回复： 感谢您的反馈，已经通知程序员修复中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-14 21:07 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  mark！什么程序存在任意代码写入漏洞？    \n     2013-12-14 21:23 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  mark! 前排火速留名！ Discuz!X2的？    \n     2013-12-15 03:14 |    \t\t闪电小子 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:5        | PKAV技术宅社区！---闪电小子！)\t\t \n  mark    \n     2013-12-15 12:11 |    \t\t58同城(乌云厂商)\t\t \n  这是刷rank的节奏么？也去刷点吧 ！哎 …………    \n     2013-12-15 12:14 |    \t\ther0ma \t\t\t( 核心白帽子 |\t\t\t        Rank:598 漏洞数:84        | 专注小厂商三十年！)\t\t \n  @58同城 你丫咋这么手贱呢…………哎！    \n     2013-12-15 12:18 |    \t\t‫‌ \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:14        )\t\t \n  @58同城 你丫确实手贱啊。。    \n     2013-12-15 12:27 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @‫‌ @58同城   司马你越来越手贱了    \n     2013-12-15 12:30 |    \t\ther0ma \t\t\t( 核心白帽子 |\t\t\t        Rank:598 漏洞数:84        | 专注小厂商三十年！)\t\t \n  少年你太天真了，其实wooyun就我一个人，不信我换ID给你说同样的话    \n     2013-12-15 12:41 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  @58同城 岂止手贱，明明就是手残！    \n     2013-12-15 17:16 |    \t\t哦哦 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 好123，最好的导航，没有之一)\t\t \n  少年你太天真了，其实wooyun就我一个人，不信我换ID给你说同样的话    \n     2013-12-15 17:27 |    \t\t不好不坏 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        )\t\t \n  少年你太天真了，其实wooyun就我一个人，不信我换ID给你说同样的话    \n     2013-12-15 18:47 |    \t\t火星人 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 我来自火星)\t\t \n  http://club.eset.com.cn/ 这个论坛很久没有人管了    \n     2013-12-15 23:02 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  你们说我手贱？丫的，我换个马甲跟你们说话    \n     2013-12-16 10:22 |    \t\t0x334 \t\t\t( 普通白帽子  |\t\t\t        Rank:171 漏洞数:35        | 漏洞无影响，已忽略～～～～～～～)\t\t \n  0day演示？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}