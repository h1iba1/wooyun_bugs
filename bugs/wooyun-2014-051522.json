{"id": 58340, "wybug_id": "wooyun-2014-051522", "wybug_title": "某通用型处理系统多处getshell", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "酱油甲", "wybug_date": "2014-02-20 17:21", "wybug_open_date": "2014-05-21 17:21", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-04-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-21：\t细节向公众公开  简要描述： 某通用型处理系统getshell 详细说明：  北京勤云科技 远程稿件处理系统8.0 http://www.e-tiller.com/ch/index.aspx案例涉及国内各大期刊杂志： http://www.e-tiller.com/ch/reader/view_cpList.aspx注：需要IIS6.0解析漏洞注册用户（投稿的，开放注册，不然不能投稿）/ch/common/目录下的带有upload_xxx.aspx的文件几乎都有问题,大部分都可以getshell在上传包中截获路径，可用base64解码，发现上传的马路径\n\n\n\n-----------------------------------------------------------------------------------------随便举一个例子：以上海理工为例：首先注册，（部分需要激活：/ch/common/activate_user.aspx），登录，都在这个页面完成：http://uustj.cnjournals.cn/ch/author/login.aspx\n\n“登录后”来到/ch/common/upload_attache_first.aspx   或者/ch/common/upload_attache.aspx\n\n上传并抓包：\n\n修改为iis解析漏洞格式：123.cer;.jpg然后找路径如上面漏洞概要 所述，可以base64解码获得最终得到shell:\n\n   漏洞证明：  都在上面   修复方案：  你们懂   版权声明：转载请注明来源 酱油甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-02-25 10:03 厂商回复： CNVD确认并在多个实例上复现所述情况，已经与近期的勤云科技漏洞一并处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-19 16:13 |    \t\txlz0iza1 \t\t\t( 普通白帽子  |\t\t\t        Rank:1027 漏洞数:207        | \"><script/src=data:,alert(1)%2b\")\t\t \n  楼主编码工具能否发一下~找了半天也没有解密出base64。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}