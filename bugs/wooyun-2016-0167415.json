{"id": 74225, "wybug_id": "wooyun-2016-0167415", "wybug_title": "速达快递一处SQL注入（26万订单信息包括金额等详情）", "wybug_corp": "速达快递", "wybug_author": "Dota", "wybug_date": "2016-01-05 13:46", "wybug_open_date": "2016-02-22 17:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向公众公开  简要描述： 速达快递一处SQL注入（26万订单信息包括金额等详情） 详细说明：  1.登录到速达快递，进入如下页面后点击-仓库存储\n\n2\n\n3，抓包\n\n4.将代码保存到文本中 用sqlmap跑起来5.数据库web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005available databases [7]:[*] kuaidi0522[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb6.表Database: kuaidi0522[61 tables]+---------------------+| BalanceLog          || CustomerJFLog       || CustomerJFLog       || DBKouAn             || DP_BaoZhuang        || DP_JJDZ             || DP_relax            || Daigou              || DeliType            || Downs               || EpsPrint            || JF_Goods            || Job                 || OrderFormat         || OrderFormat         || OrderPackage        || PackPrice           || PackPrice           || PackType            || Pags                || PayMode             || PayType             || Query               || SendType            || StateType           || StoreCangKu         || StoreClass          || StoreInfo_Items     || StoreInfo_Items     || StoreItem           || StoreLog            || StoreOutInfo_Items  || StoreOutInfo_Items  || StorePrice          || Store_ZYGS          || UserIds             || VirtualOrders       || WebInfo             || addressbook         || adminLogin          || bagInfo             || city                || kd_join             || kd_know             || kd_message          || kd_news             || kd_ps               || kd_qa               || kd_url              || orderlog            || siteLog             || type1               || type2               || vBagsOrder          || vJJRelax            || vOrderList          || vStoreInfo_Items    || vStoreInfo_Items    || vStoreOutInfo_Items || vStoreOutInfo_Items || vw_Customer         |+---------------------+sqlmap resumed the following injection point(s) from stored session:7.Database: kuaidi0522+-------------------------+---------+| Table                   | Entries |+-------------------------+---------+| dbo.orderlog            | 1412665 || dbo.OrderPackage        | 264665  || dbo.vOrderList          | 264556  |vOrderList 这个订单视图 里面有26万的订单8.我们再看下表结构---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005Database: kuaidi0522Table: vOrderList[47 columns]+--------------+----------+| Column       | Type     |+--------------+----------+| Aweight      | nvarchar || baozhuangID  | int      || CM           | int      || deliID       | int      || DIM          | nvarchar || epsno        | varchar  || FTEdate      | nvarchar || id           | int      || indat        | datetime || isdel        | int      || ispay        | int      || orderid      | nvarchar || orderprice   | decimal  || packages     | nvarchar || packid       | int      || packtypeid   | int      || payerAccount | nvarchar || PayModeID    | int      || PayTypeID    | int      || recaddress   | nvarchar || reccompany   | nvarchar || reccountry   | nvarchar || recdate      | nvarchar || recer        | nvarchar || recphone     | nvarchar || recpostal    | nvarchar || recsign      | nvarchar || sendaddress  | nvarchar || sendcompany  | nvarchar || sendcountry  | nvarchar || sender       | nvarchar || sendphone    | nvarchar || sendpostal   | nvarchar || sendsign     | nvarchar || sendtype     | nvarchar || sentID       | int      || signdate     | nvarchar || state        | int      || tax          | nvarchar || totalValue   | nvarchar || txt1111      | nvarchar || txt2222      | nvarchar || txt3333      | nvarchar || txt4444      | nvarchar || username     | nvarchar || Vweight      | nvarchar || zydh         | nvarchar |+--------------+----------+这里的sender  sendercompany  送件人 地址 公司 订单金额 电话 以及收件人的公司地址电话都有   漏洞证明：  如上图   修复方案：  参数化查询   版权声明：转载请注明来源 Dota@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-01-08 19:42 厂商回复： CNVD未复现所述情况，已由CNVD通过网站管理方公开联系渠道向其邮件通报，由其后续提供解决方案。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}