{"id": 17023, "wybug_id": "wooyun-2015-0117084", "wybug_title": "慕课网主站代码任意读取命令任意执行遍历目录", "wybug_corp": "imooc.com", "wybug_author": "喂", "wybug_date": "2015-05-30 10:24", "wybug_open_date": "2015-07-16 09:42", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向公众公开  简要描述： 看我标题 详细说明：  学习python中，突然想到一个问题   权限是否控制严格然后发生了接下来的事情首先猜测是否能代码任意执行，废话当然能啊，首先测试一个打印时间的代码\nfrom time import strftime,localtimeprint '%s' %strftime('%Y-%m-%d %H:%M:%S',localtime())\n打印成功\n\n随后想到那是不是能进行任意文件读取\nfile = open('./index.php','r')for (num,value) in enumerate(file):    print valuefile.close()\n读取成功\n\n进行下一步测试，那我这个文件夹里面有什么文件呢？测试文件夹遍历\nimport oscmd = \"dir ./\"for i in os.popen(cmd).readlines():    print i,\n很明显成功了，不成功的我都要忽略掉\n\n那我再测试下，能否遍历其它文件夹，以及跟文件夹\n\n\n\n既然都已经，遍历文件夹了，那再测测任意文件读取\n\n读来读去的没意思，那测测能不能命令执行（linux）\nimport subprocessp = subprocess.Popen('uname -a', shell=True, stdout=subprocess.PIPE, stderr=subprocess.STDOUT)for line in p.stdout.readlines():    print line,retval = p.wait()\n虽然我不知道上面的代码是什么意思，但是我看的到结果\n\n最后测下 文件写入\n\n\n\n   漏洞证明：  某个地方的配置文件\n\n读取etc文件夹\n\n其中文件在某些文件夹写入不成功，权限不够，这个也算是亮点了\n\n不知道删除命令用不用的了好像是\nrm -rf /*\n不知道对不对原本准备测试下网站目录下能不能写，但是为了避免一些不必要的麻烦....   修复方案：  总体来说，就是代码环境没有和课件环境分离开现在的东西感觉什么都能干一样，太危险了希望能借鉴目前市场上所存在的虚拟化的技术，将代码环境虚拟化，禁止掉危险的函数其实可以看其它人的代码也有一个漏洞，后期有机会再提交url=http://www.imooc.com/code/3255写在后面：  希望在修复过程中不要停掉课件   版权声明：转载请注明来源 喂@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-06-01 09:40 厂商回复： 在线编程安全性问题，之前已经暴露过，确实是想通过虚拟化解决的。具体推进上因为其它业务影响，慢了一些。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-30 14:13 |    \t\torange \t\t\t( 普通白帽子  |\t\t\t        Rank:185 漏洞数:38        | 戒骄戒躁。)\t\t \n  我也发现了！！！！    \n     2015-05-30 21:56 |    \t\tQ1NG \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:16        | 临 兵 斗 者 皆 阵 列 前 行 !)\t\t \n  然而我也发现了!!!但并没什么卵用     \n     2015-07-16 10:43 |    \t\thack2012 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:3        | 关注信息安全 http://www.waitalone.cn/)\t\t \n  我之前直接报告给他们的客服人员了，结果没有啥回应。我当时测试的时候，有一些命令是被限制了的，而且python代码执行的服务器并不是主站，而是另外一台服务器，所以你无法通过直接写入shell的方式，直接搞定主站，搞定分站是可以的。    \n     2015-07-17 11:19 |    \t\t喂 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 他很懒)\t\t \n  @hack2012 正解,为了号。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}