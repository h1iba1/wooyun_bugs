{"id": 29851, "wybug_id": "wooyun-2015-0118125", "wybug_title": "蔚蓝地图移动客户端接口未做校验导致能够重置账户密码", "wybug_corp": "蔚蓝地图App", "wybug_author": "helobin", "wybug_date": "2015-06-04 11:40", "wybug_open_date": "2015-07-24 12:48", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "越权操作", "未授权访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-24：\t细节向公众公开  简要描述： 接口webservice未做任何访问限制导致可以非授权修改用户信息、重置密码 详细说明：  抓包工具抓包，分析初步得到相关用户信息\n\n\n\n模拟用户资料数据提交，获得uid=1的用户资料 得到用户名和邮箱\n\n观察接口，发现接口为asp.net开发的webservice，http://mobile.ipe.org.cn/app/app_V2.asmx?op=ModifyUser_PwdValidateCode复制到浏览器打开，得到所有接口方法找到关键方法ModifyUser_Email 个人信息-修改邮箱ModifyUser_EmailSendCode 个人信息-修改邮箱发送验证码ModifyUser_EmailValidateCode 个人信息-修改邮箱验证验证码ModifyUser_NickName 个人信息-昵称ModifyUser_PwdSendCode 个人信息-找回密码发送验证码ModifyUser_PwdValidateCode 个人信息-找回密码验证验证码ModifyUser_Pwd_Login 个人信息-密码ModifyUser_Pwd_Logout 个人信息-找回密码修改密码\n\n点击找回密码接口 http://mobile.ipe.org.cn/app/app_V2.asmx?op=ModifyUser_PwdValidateCode输入刚刚获取的uid=1的用户信息和新密码，提交\n\n修改成功\n\n   漏洞证明：  用新修改的密码测试登陆，登陆成功！\n\n   修复方案：  对webservice增加权限控制，禁止未授权访问。   版权声明：转载请注明来源 helobin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-06-09 10:36 厂商回复： 暂未能建立与软件开发厂商或开发者的直接联系渠道,待认领. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}