{"id": 24238, "wybug_id": "wooyun-2010-0395", "wybug_title": "ecshop修改任意用户密码漏洞", "wybug_corp": "ShopEx", "wybug_author": "结界师", "wybug_date": "2010-09-01 22:08", "wybug_open_date": "2010-09-02 15:28", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计错误", "修改邮箱来间接修改密码"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-09-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2010-09-02：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： ecshop在设计认证机制的时候存在一个问题，导致恶意用户可以窃取其他用户的密码 详细说明：  在ecshop的权限机制当中修改密码是需要知道原密码的，但是修改用于取回密码的Email却不需要任何其他的限制，是一个典型的设计错误，成功利用此漏洞可以修改其他用户的密码   漏洞证明：  1 构建html页面和修改email的参数诱骗用户访问2 通过修改的email找回密码即可获得其他用户的权限   修复方案：  你知道的 ：）   版权声明：转载请注明来源 结界师@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2010-09-02 15:28 厂商回复： 系统在密码找回的时候获取的email是从会员表里取出来的，而修改这个email地址的时候，会和保存在session里用户id进行校验的，A用户不能修改到B用户的email地址。 漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-11-07 10:32 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  CSRF    \n     2013-02-22 12:59 |    \t\tSeay \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:8        )\t\t \n  系统在密码找回的时候获取的email是从会员表里取出来的，而修改这个email地址的时候，会和保存在session里用户id进行校验的，A用户不能修改到B用户的email地址。蛋疼的回复    \n     2013-07-19 09:18 |    \t\tsaviour \t\t\t( 普通白帽子  |\t\t\t        Rank:188 漏洞数:29        | Saviour.Com.Cn 网站正在备案中)\t\t \n  @Seay  亲爱的，厂商有时候很奇葩的！    \n     2014-08-18 11:18 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  标题有歧义嘛    \n     2014-11-17 11:31 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @D＆G 现在看来很好理解了。厂商说这里没有越权，洞主说的是这里有CSRF    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}