{"id": 38048, "wybug_id": "wooyun-2015-0106341", "wybug_title": "网鱼网咖鱼泡泡应用任意账户登录漏洞（影响账号内余额安全）", "wybug_corp": "网鱼网咖", "wybug_author": "xsser_w", "wybug_date": "2015-04-08 12:01", "wybug_open_date": "2015-05-23 12:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-08：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-05-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT 详细说明：  \n\n我们来分析下这个包请求参数是screen=640%2A960&device_model=iphone&signature=11906247c37e42f2add87994c7e9a116decfb6c3&sys_version=7.1.2&request=xxx&method=GetGodList&soft_version=1.0&platform=ios&timespan=1428371452289先打个马赛克， 这里的request参数是base64后的一个json数据\"token\":\"dxxx30b250dda6f8aa\"里面有个token   这个token 永久有效 是身份的唯一标示\nPOST /api/index HTTP/1.1Host: yppapi.wanyoo.comProxy-Connection: closeAccept-Encoding: gzipContent-Type: application/x-www-form-urlencoded; charset=utf-8Content-Length: 281Connection: closeCookie: ci_session=a%3A5%3A%7Bs%3A10%3A%22session_id%22%3Bs%3A32%3A%220534970c3d43c54a61815486e55740db%22%3Bs%3A10%3A%22ip_address%22%3Bs%3A15%3A%22183.129.152.142%22%3Bs%3A10%3A%22user_agent%22%3Bs%3A55%3A%22%E9%B1%BC%E6%B3%A1%E6%B3%A1+2.1+rv%3A2.1.3+%28iPhone%3B+iPhone+OS+6.1.2%3B+en_US%29%22%3Bs%3A13%3A%22last_activity%22%3Bi%3A1428371775%3Bs%3A9%3A%22user_data%22%3Bs%3A0%3A%22%22%3B%7D05fb18ef3bff00635af67f7ab31583fcUser-Agent: é±¼æ³¡æ³¡ 2.1 rv:2.1.3 (iPhone; iPhone OS 6.1.2; en_US)screen=640%2A960&device_model=iphone&signature=d61798ec625bb563c211f2da605db395056dbc73&sys_version=7.1.2&request={\"token\":\"WYWKAPPV1TESTTOKEN\",\"mobile\":\"188152209\",\"password\":\"1929\"}&method=SignIn&soft_version=1.0&platform=ios&timespan=1428371783599\n这个包发出后我们对他的返回包的token进行替换就可以登录任意账户了- -然后我们看下第一个女神的账户\n\n   漏洞证明：  \n\n   修复方案：  想一套新的方案出来替换这个或者是根据行业主流做法   版权声明：转载请注明来源 xsser_w@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：13 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 13, "Ranks": null}