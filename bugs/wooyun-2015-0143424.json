{"id": 67291, "wybug_id": "wooyun-2015-0143424", "wybug_title": "某人力资源系统任意文件上传（已shell）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-09-28 20:05", "wybug_open_date": "2015-11-15 17:04", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传内容未检查", "文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-01：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-15：\t细节向公众公开  简要描述： 拿到服务器权限，影响该公司旗下所有业务；各种用户数据，简历，公司等信息泄漏。 详细说明：  1.http://**.**.**.**/talent/upload.jsp  文件上传，有后缀过滤2.泄漏上传路径\n18:    //鎵╁睍鍚嶇殑鏂囦欢鍜屾病鏈夋墿灞曞悕鐨勬枃浠�19:    su.setDeniedFilesList(\"exe,bat,jsp,htm,html,,\");20:    //涓婁紶鏂囦欢21:    su.upload();22:    //灏嗕笂浼犳枃浠跺叏閮ㄤ繚瀛樺埌鎸囧畾鐩綍23:    int count=su.save(\"upload/jianli\");24:\n3.burp截断上传getshell\nhttp://**.**.**.**/upload/jianli/1.jsp cmd\n\n\n4.数据库信息\n\n帐号密码信息\n\n\n\n用户个人信息\n\n\n\n\n\n5.由于shell是administrator权限，导出hash破解获得密码。结果不能登录。。\n\n居然把administrator加到了guest。重新加到管理员组，搞定。\n\n6.以下为同服务器站点，该公司涉及的业务网站均受影响\nhttp://**.**.**.**http://**.**.**.**http://**.**.**.**http://**.**.**.**http://**.**.**.**http://**.**.**.**http://**.**.**.**http://**.**.**.**http://**.**.**.**http://**.**.**.**http://www.**.**.**.**\n7.未动任何数据和设置，仅为说明问题   漏洞证明：  \n\n   修复方案：  1.上传过滤2.web权限设置3.sqlserver权限设置   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-10-01 17:03 厂商回复： CNVD未直接复现所述漏洞情况，暂未建立与网站管理单位的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}