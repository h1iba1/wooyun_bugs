{"id": 57440, "wybug_id": "wooyun-2014-054333", "wybug_title": "飞鸿商城重置任意绑定邮箱账号", "wybug_corp": "飞鸿商城", "wybug_author": "Comer", "wybug_date": "2014-03-24 17:41", "wybug_open_date": "2014-05-08 17:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感接口缺乏校验", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-24：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-05-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： @xsser 知道你会原谅我的。发现这个问题又算上多次验证也就十几分钟吧。来wooyun提交验证码不配合登不上是一说，各种慢各种抽半小时之多啊。好吧，又多了个小号。话说咱们wooyun也整个favicon.ico呗，这样看起来会更好点 : ) 详细说明：  最近正有换手机的打算，so，在飞鸿那边逛的略多些（界面风格简单价格有一定的参考性吧~）。突然发现飞鸿UI是刚换的，不错~然后就发现了这个，算是祝贺一下下吧。邮箱找回密码流程跟大众无别\n填写账户信息-> 确认账户信息并发送确认邮件 -> 收到确认邮件 -> 重设密码\n重设密码确认链接是这样子的\nhttp://www.22shop.com/member/ForgetPwd.aspx?mid=te***rr&email=i***i@yeah.net&code=A4C00***157***42\n提的这个，无需发送重置邮件这些只需一个请求即可。#1 大概走了下邮箱验证的流程看了看路边的野花JS和页面源代码，结果在确认邮件链接\nhttp://www.22shop.com/member/ForgetPwd.aspx?mid\n页面源码中发现\n\n是否可以自定义POST请求来实现重置呢？试试就知道！#2 邮箱用户名不知道？看这里\n\n有邮箱，用户名这些不用愁啦。#3 注册个新的账号，自定义post请求\n\n夭折（issucc为1时，成功）。以往的经验告诉我是session过期的原因。于是乎，重新获取session编辑请求重发（为方便查看，发送请求后以省略号代替部分请求头）\n\n再次夭折....#4 多次测试后\n\nbingo! 有没有发现sessionID跟上一个是同样的为啥还能成功呢？因为在第三步时我只是获取一个新的session。测试后发现需要去找回密码进行至第二步也就是我#2截图那里。猜测是在头次获取的session未作记录，到了第二步是后端或DB中做了记录的，此session非彼session啊。   漏洞证明：  \n以截图中的密码 rootfei 来登录\n\n\n   修复方案：  你懂得   版权声明：转载请注明来源 Comer@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}