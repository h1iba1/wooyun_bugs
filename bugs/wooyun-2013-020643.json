{"id": 11976, "wybug_id": "wooyun-2013-020643", "wybug_title": "校园卡转账机密码记录并进行内网渗透", "wybug_corp": "新开普电子有限公司", "wybug_author": "机械葫芦娃", "wybug_date": "2013-03-25 16:54", "wybug_open_date": "2013-06-23 16:54", "wybug_type": "非授权访问", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当导致攻击界面扩大", "终端机安全", "沙盒环境绕过", "网络边界设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-30：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-05-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-23：\t细节向公众公开  简要描述： 河南大多高校所使用的一卡通转账机存在此缺陷，能够绕过前端界面进行操作并安装恶意软件 详细说明：      一卡通转账机能够实现银行卡与校园卡的绑定和圈存（本例为工商银行），机器上有银行卡刷卡槽和校园卡插槽。而且校园所有终端均接入校园网。\n\n    对漏洞进行利用时可通过断网使其弹出浏览器界面并进行打开文件操作，或断电重启后进入Windows XP界面快速打开“我的电脑”进而定位到CMD。机器输入设备仅提供了数字键和“确定”“取消”键，貌似没有其他的输入设备可用.但在“C:\\WINDOWS\\system32\\”文件夹下能找到系统内置的osk.exe（系统软键盘）\n\n然后即可在CMD窗口中进行指令输入，进行更多的渗透操作。   漏洞证明：     通过CMD查询网络信息得知该转账机的外网信息：\n\n然后远程下载预先设置好的远控服务端，对转账机进行完全控制，然后切回到机器正常工作界面。（安装键盘记录之后能捕获到转账者的密码。）    使用扫描器获知同网段其他转账机的IP。通过对C盘系统数据的分析，可得到系统的登录密码，由此可对同网段其他机器进行渗透。\n\n\n\n   修复方案：  1.对系统进行优化，在浏览器处做好屏蔽2.删除系统自带软键盘3.不要用一个ghost镜像来安装所有机器，即使安装，系统密码不要设置相同的   版权声明：转载请注明来源 机械葫芦娃@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-03-27 23:07 厂商回复： 对于终端机绕过，CNVD未直接复现，已经由CNVD以简要方式通报软件生产厂商，同时感谢白帽子提供的位置信息，目前尚未有进一步反馈。参考自评rank 10 最新状态： 2013-03-29：厂商已经提供解决方案，并在近期在全国进行修复：1.屏蔽系统中的软键盘和命令行（即删除系统中cmd.exe和osk.exe两个系统文件 ）；2.更新应用程序的浏览器组件，屏蔽浏览器组件的右键功能。3.更换所有终端的操作系统密码，保证每台终端采用复杂密码并且密码不一致。  ", "replys": "漏洞评价：\n评论\n     2013-03-25 19:11 |    \t\tcircus \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:4        | 你会为一件事去说一句话,也会为一句话去干...)\t\t \n  擦 这个得关注     \n     2013-03-25 20:09 |    \t\tblrk \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:6        | 粪豆褶)\t\t \n  关注一哈~    \n     2013-03-25 22:20 |    \t\t小九 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:5        | 非尖刀小九,民间草根)\t\t \n  不公布方法的木JJ    \n     2013-04-27 10:31 |    \t\tAqua \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | hello world !)\t\t \n  怎么跳出的界面？    \n     2013-05-09 17:20 |    \t\t浮生 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:4        | 浮生偷得半日闲)\t\t \n  早应该提交的，和我的一样，我去。。。    \n     2013-06-23 16:59 |    \t\t纠结师 \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:12        | 传说中的废材)\t\t \n  这个不是应该高危么？？ 涉及个人利益的安全问题了。    \n     2013-06-24 01:19 |    \t\t猪头子 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:35        | 自信的看着队友rm -rf/tar挂服务器)\t\t \n  删除了还有dllcaches，或者还可以远程下马。。要解决的应该是拔网线弹出浏览器这个问题。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}