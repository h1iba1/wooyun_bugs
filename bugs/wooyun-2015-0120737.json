{"id": 28995, "wybug_id": "wooyun-2015-0120737", "wybug_title": "指动生活漏洞大礼包（任意用户密码重置、多处XSS、支付逻辑漏洞）", "wybug_corp": "指动生活", "wybug_author": "路人甲", "wybug_date": "2015-06-16 12:30", "wybug_open_date": "2015-07-31 12:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "逻辑错误", "设计缺陷", "支付行业敏感"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-16：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-31：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 指动生活，山东最大生活服务类平台 详细说明：  指动生活：http://www.zdlife.net\n\n漏洞大礼包：一、任意用户密码重置二、XSS，窃取用户Cookie等。三、充值逻辑漏洞，可0.01元充100万。一、任意用户密码重置：http://chaoshi.zdlife.net/passwordjs代码如下：\n}else if(i==2){\t\t\t\t//重置密码\t\t\t\tvar pass1 = $(\"#pass1\").val();\t\t\t\tvar pass2 = $(\"#pass2\").val(); //生成的验证码\t\t\t\tvar uphone = $(\"#uphone\").val();\t\t\t\tif(validatev(\"#pass1\",\"#pass1h\")){\t\t\t\t\tif(pass1!=pass2){\t\t\t\t\t\t$(\"#pass2h\").css(\"border\",\"1px solid red\");\t\t\t\t\t\t$(\"#pass2h\").show();\t\t\t\t\t\t$(\"#pass2\").focus();\t\t\t\t\t}else{\t\t\t\t\t\t$(\"#pass2h\").css(\"border\",\"1px solid #ccc\");\t\t\t\t\t\t$(\"#pass2h\").hide();\t\t\t\t\t\t$.post(\"rpass\",{ \t\t\t\t\t\t password:pass1,\t\t\t\t\t\t phone:uphone\t\t\t\t\t\t},function(msg){\t\t\t\t\t\t\tif(msg.succeed==\"000\"){\t\t\t\t\t\t\t\talert(\"密码已成功重置！\");\t\t\t\t\t\t\t\tlocation.href=\"preloginCustomers?pagetype=index&&id=null&cur=1\";\t\t\t\t\t\t\t}\t\t\t\t\t\t},\"json\");\t\t\t\t\t}\t\t\t\t}\t\t\t}\n发现重置密码参数只有password和phone。发送请求：\n\n这样提示重置成功，但是无法登录，最后在登录的地方发现密码需要编码：请求地址：http://www.zdlife.net/main/aesEnCode\n\n利用编码后的密码，重置成功，登录成功：外卖平台：\n\n团购平台：\n\n重置了此账号的密码：账号：15215311884 密码：123456789二、XSS用户昵称：\n\n前端js验证，服务器无验证，抓包修改昵称为<script>alert(/hello/)</script>保存成功：\n\n收货地址：\n\n\n\nXSS处太明显也太多，不再列举。三、支付漏洞，充值：http://chaoshi.zdlife.net/center-rechargeStreet\n\n抓包，有两个请求，一个提交订单，一个提交到支付平台。发现提交到支付平台的金额可以任意修改，订单号不变。\n\n支付平台界面，接受了0.01的订单：\n\n   漏洞证明：  已证明。   修复方案：  ~~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}