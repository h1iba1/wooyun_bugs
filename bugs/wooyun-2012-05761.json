{"id": 20222, "wybug_id": "wooyun-2012-05761", "wybug_title": "中华人民共和国人力资源和社会保障部 bug严重", "wybug_corp": "中华人民共和国人力资源和社会保障部", "wybug_author": "possible", "wybug_date": "2012-04-04 00:42", "wybug_open_date": "2012-05-19 00:43", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-04-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-04-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-04-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-05-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-05-19：\t细节向公众公开  简要描述： 中华人民共和国人力资源和社会保障部 未授权访问，可得shell. 详细说明：  中华人民共和国人力资源和社会保障部 网站由于用户管理页面没有权限限制，导致任意访问，添加账户，登录后台，后台上传客户端限制，绕过后可得shell,虽然shell不是系统权限，但是可以修改站点文件,数据库等，危害还是挺大。   漏洞证明：  以下操作仅为了证明漏洞存在，未做任何破坏.\n\n\n\n\n\n测试过程:1.一个任意文件下载点http://www.mohrss.gov.cn/download?path=WEB-INF\\classes\\com\\flx\\struts\\base/BaseAction.class2.可以下载到站点的配置文件，主要是些xml文件3.最大量xml中，找到添加用户界面http://www.mohrss.gov.cn/view/AccessControl/userManagementUserEdit.jsp使用下载点，可以创建一个账号（由于不知道管理员组，因此只创建了一个普通账号权限不够）4.使用创建的账号访问http://www.mohrss.gov.cn/userGroupManagement.do?command=save可以管理用户组,在管理员组中重新添加一个管理员 重新登录进后台5.上传点客户端验证，简单绕过，得shell.当然可能还有更简单方法...   修复方案：  未有权限限制直接可以访问页面很多，建议逐一检查:如:http://www.mohrss.gov.cn/view/ImageManage/sysImage/sysImageUpload.jsp   版权声明：转载请注明来源 possible@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2012-04-08 18:38 厂商回复： CNVD确认所述漏洞情况，复现部分过程。将在周一作为重要事件处置。对该漏洞评分如下：CVSS评分：(AV:R/AC:L/Au:NR/C:C/A:P/I:P/B:N) Score:8.97（最高10分，高危)即：远程攻击、攻击难度低、不需要用户认证，对机密性造成完全影响，对可用性、完整性造成部分影响。技术难度系数：1.0(一般)影响危害系数：1.7(严重，涉及重要部门主站系统)综合评分：8.97*1.0*1.7=14.352 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-04-04 02:45 |    \t\t水泥中的鱼 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:4        | 我就是我，尘世中一迷途小书童。)\t\t \n  这事不小~~~    \n     2012-04-04 08:52 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @水泥中的鱼 不会找我吧 好怕... 只是无意看到，花点时间顺便证明一下,什么都没干呀 呵呵管理我的题目上 还有 友情提示呢 咋没了?    \n     2012-04-04 15:53 |    \t\t水泥中的鱼 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:4        | 我就是我，尘世中一迷途小书童。)\t\t \n  @possible 没有没有，就是乱猜下，政府站伤不起啊，就怕没干啥被扣帽子，那就郁闷了，我也小菜鸟一个乱说的。    \n     2012-04-05 14:16 |    \t\t期待爱 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | 这个家伙很精明 连条内裤也没有留下！！！)\t\t \n  做好准备 被跨的心里吧。天朝的站你伤不起    \n     2012-04-08 20:41 |    \t\tSZn \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | 雄鹰小时候也叫菜鸟！)\t\t \n  最近，好像各个部很受关注啊！    \n     2012-04-08 21:43 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @SZn 无意间看到...主要还是国内安全意识不高呀，都是小公司的产品，漏洞百出也很正常...而且使用这套代码都是重要部门，这就是国内安全现状...    \n     2012-05-19 10:21 |    \t\t瓜瓜 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:25        )\t\t \n  WEB-INF\\classes\\com\\flx\\struts\\base/BaseAction.class这个事怎么找到的？    \n     2012-05-19 11:50 |    \t\tTopman王 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:6        | 软件开发工程师!白帽子!XSSER,渗透,SEO)\t\t \n  楼主不怕跨省？    \n     2012-05-19 12:00 |    \t\tMoments \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 2)\t\t \n  看来政府的虚拟化建设的还可以，已经实际投入到生产环境啦    \n     2012-05-19 13:58 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @Topman王 @瓜瓜 这个class文件主要是通过文件下载点，找到一个动态页面如1.jsp，里面就会有数据库操作的class，通过类直接的继承关系，就可以找到数据库操作类。有点类似爬虫思想，形象的是顺藤摸瓜...非常怕跨省，可是我不是第一个吃螃蟹的人，有人已经发过部级站点...    \n     2012-05-19 14:04 |    \t\tTopman王 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:6        | 软件开发工程师!白帽子!XSSER,渗透,SEO)\t\t \n  @possible 推荐去弄弄军工企业的    \n     2012-05-19 23:03 |    \t\t瓜瓜 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:25        )\t\t \n  @possible 奥，有点懂了，看来应该学学jsp了...    \n     2012-05-29 22:08 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @瓜瓜 简单看看就行 我也不怎么会 就知道点基础    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}