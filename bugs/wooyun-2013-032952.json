{"id": 9688, "wybug_id": "wooyun-2013-032952", "wybug_title": "UC某处设计缺陷可登录任意账户（各种VIP）", "wybug_corp": "UC Mobile", "wybug_author": "xfkxfk", "wybug_date": "2013-07-31 13:46", "wybug_open_date": "2013-09-14 13:46", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "逻辑错误", "敏感接口未加权限认证", "越权操作", "未授权访问", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-14：\t细节向公众公开  简要描述： UC某处设计缺陷导致登录任意账户，各种VIP啊。不知道这里面的原因是啥，反正就是能登陆，任意用户。 详细说明：  这个问题是在无意中发现的，研究几天都没整明白是怎么个原因，什么导致的，但是确实存在此漏洞，问题很验证啊。先说说我的操作步骤吧：1、显示在手机上打开了UC浏览器，看见有注册账户的地方，就注册了一个。2、看了看地址栏的url地址，是id.uc.cn/xxxxxx3、于是在电脑上输入id.uc.cn，就到了uc账户的登陆页面4、登陆注册的uc账户，然后在用户中心主页有个账号安全，进入账号安全管理页面5、然后设置我的密保邮箱，输入你的邮箱地址，然后会发送验证码到邮箱地址6、然后邮箱会收到4位数的验证码7、在本地设置代理，然后随便输入一个验证码，我在这里用burp suite进行抓包，然后用burp suite的intruder功能跑了一下这个4位数的验证码，如下图的操作截图：\n\n\n\n8、在跑验证码的过程中，不小心把cookie替换选项勾选了，这个cookie是前面设置的Discuz的cookie，cookie内容如下： NTyo_2132_saltkey=dpWpwoVv;NTyo_2132__lastvisit=1364918188;NTyo_2132_sid=V6RuR7;NTyo_2132_lastact=1364924736%09misc.php%09patch;NTyo_2132_visitedfid=2;NTyo_2132_viewid=tid_1;NTyo_2132_ulastactivity=a2c3b6DCp00+tRDsAjpfaNM3yjG891nvRjrXNauJ5Vsy0g5uYfME;NTyo_2132_auth=cc29kM39wa+nxidNH3GK1K2pMfc6hKCX1Q7SzBmphRmxpPC5JIC6ux8+HNp1LyHsZhGIQus5vYoDemLZ7vGT;NTyo_2132_lastcheckfeed=1|1364922510;NTyo_2132_smile=1D1;NTyo_2132_editormode_e=1;NTyo_2132_sendmail=1; NTyo_2132_checkpatch=19、最后就导致返回结果是页面错误，然后我们关掉代理，在刷新页面，进入用户中心，就看见我们进入其他的账户了，重复了上面的操作，进入如下的账户：\n\n\n\n\n\n\n\n10、后来发现其实不用用brup suite进行爆破验证码就能重现上面的问题。同样设置好代理：\n\n11、然后勾选上替换cookie的选项，不停刷新页面，然后再返回页面上的用户中心，就能看见此时账户已经换成其他账户了。   漏洞证明：  见详细说明   修复方案：  这是一个很诡异的权限控制问题，我没找到修复的办法，你们看看服务器那边的验证吧。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2013-08-01 15:00 厂商回复： 使用上面的方法不能重现漏洞，与作者聊过，是5月8日发现的漏洞，咱们的版本已更新过多次，也修复过串号的问题。但当时的版本在特定环境下存在应该能重现，我们会继续跟进，非常感谢xfkxfk提供的漏洞信息及安全建议。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-31 15:13 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  看来uc对大家吸引度不够啊    \n     2013-07-31 15:18 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @xsser 怎么说？    \n     2013-07-31 19:27 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  坐等更多细节    \n     2013-07-31 19:59 |    \t\t我是小号 \t\t\t( 普通白帽子  |\t\t\t        Rank:334 漏洞数:51        | Martin)\t\t \n  @xsser 说有更多的漏洞被xsser发现了~这个漏洞只是皮毛对吧（顺便问一下···漏洞被确认了···为何为何！乌云币不到账！）    \n     2013-08-01 15:04 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  应该第一时间提交的，谢谢厂商@UC Mobile    \n     2013-08-28 19:22 |    \t\ttzrj \t\t\t( 实习白帽子  |\t\t\t        Rank:87 漏洞数:24        | 1111)\t\t \n  @VIP @各种VIP    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}