{"id": 18720, "wybug_id": "wooyun-2012-08333", "wybug_title": "奇虎360任意用户密码修改漏洞", "wybug_corp": "奇虎360", "wybug_author": "牛奶坦克", "wybug_date": "2012-06-15 15:36", "wybug_open_date": "2012-07-30 15:36", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "用户敏感信息泄漏", "设计错误", "逻辑错误", "黑盒", "黑盒分析技巧", "任意密码修改"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-30：\t细节向公众公开  简要描述： 奇虎360用户通行证取回密码存在逻辑问题，导致可以修改任意用户的密码。怕影响别的用户帐号安全，所以只用了3个朋友的帐号进行测试，均成功。360的业务线也很广了，比如360安全卫士系统云备份，云盘存储，网站宝，团购等项目，利用这个sso漏洞可以通杀，危害还是很严重的。 详细说明：  先正常流程取回一次密码，查看邮箱，邮件内容类似：\n360个人中心找回密码（重要）！重设密码地址：http://i.360.cn/findpwd/setpwdfromemail?vc=c4ce4dd3d566ef83f9[马赛克]&u=[马赛克]%40gmail.com,马上重设密码！如果您没有进行过找回密码的操作，请不要点击上述链接，并删除此邮件。\nvc可以看出是一串md5，解密一下发现是个数字，类似1339744000，第一感觉是个id，那么遍历id并且修改u变量是否可以修改任意用户密码呢，试了一下不可以，在看这个数字，感觉有点太大了，在看，在看，在看，怎么像是个unix时间戳呢？解开一下发现真的是个时间戳！那么可以大胆的猜测一下此处的流程，用户取回密码时，产生一个精确的时间戳，与帐号绑定，记录在某个密码重置库内，那么修改这个用户密码必须得知道这个时间戳才可以，看似合理，但程序员忽略了一个细节，就是假如这个时间戳是新生成得，我在一定得时间段内进行暴力猜解，很快就可以获取到这个有效得链接！写了个exp测试一下。   漏洞证明：  \n\n打开果然是\n\n修改密码后跳到了登陆首页，用刚刚修改得密码登陆\n\nBingo~看看其他应用。\n\n奇怪，不是sso，但是既然知道了密码，so不o的无所谓啦。PS:另外发现了一个小小的问题，如果某个重置密码链接未使用的话，时间戳貌似不会失效，这样给预测带来了点麻烦，但这只是时间问题。   修复方案：  不可预测性没有做到位，设计之初就做错了，真是。。。   版权声明：转载请注明来源 牛奶坦克@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2012-06-15 15:52 厂商回复： 感谢您对360的支持，我们正在修复该问题... 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-15 15:37 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  我信洞主    \n     2012-06-15 15:40 |    \t\tJannock  \t\t\t( 核心白帽子 |\t\t\t        Rank:2278 漏洞数:204        | 关注技术与网络安全（招人中，有兴趣请私信...)\t\t \n  太牛了。。。    \n     2012-06-15 15:50 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  洞主很牛~~~    \n     2012-06-15 15:56 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个修改任意用户密码的才11分？    \n     2012-06-15 15:58 |    \t\tJannock  \t\t\t( 核心白帽子 |\t\t\t        Rank:2278 漏洞数:204        | 关注技术与网络安全（招人中，有兴趣请私信...)\t\t \n  @xsser 看来用户不重要呀。。。    \n     2012-06-15 18:15 |    \t\tlanz \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:5        | whatever)\t\t \n  好可怕..    \n     2012-06-15 18:20 |    \t\t鱼化石 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:18        | 介绍不能为空)\t\t \n  细节SSO    \n     2012-06-15 18:51 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  .。 = = 为什么才 11 rank 。。。，看来360的用户信息没价值。    \n     2012-06-15 18:55 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  神人出现鸟。    \n     2012-06-16 08:42 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @gainover @Jannock @xsser 360觉得我的用户，账号、密码神马的对我来说不重要；他们的资料，我要有就有~~该装机的还是会装~    \n     2012-06-16 10:48 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  重置新密码 到邮箱 这个可以考虑下，如一般的取回密码参数含义被人知晓，就很容易绕过了。。    \n     2012-06-16 10:52 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  这个漏洞干嘛不爆到他们平台上，应该有几千的奖金吧！！    \n     2012-06-16 11:14 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @king 真正为了钱，就不会来乌云了。    \n     2012-06-16 11:27 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  这个漏洞应该还有些附加条件，要知道 账号名字和注册的邮箱吧！！这样的漏洞貌似一大堆！！    \n     2012-06-16 12:20 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @king 几百块就掩饰那么大的漏洞，厂商还挺值    \n     2012-06-16 12:22 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @xsser 囧，用户不值钱，还是厂商不值钱？    \n     2012-06-16 13:26 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  这个往往出现常规式的加密方式不对，如时间，别人找到这个常规加密方式，在伪造一个加密窜就可以绕过，可以使用无规律的加密机制！！让人无法构造就可以避免，刚随便测试几个，都有类似情况，只要构造个他加密方式发送一个找回的功能，就可以成功    \n     2012-06-16 13:55 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @king 乌云吧，更多人了解才可以避免    \n     2012-06-16 14:22 |    \t\t牛奶坦克 \t\t\t( 普通白帽子  |\t\t\t        Rank:355 漏洞数:21        | 晚安,牛奶)\t\t \n  @king 是的，当然你要先知道你要修改谁的账号了。    \n     2012-06-16 14:34 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  http://zone.wooyun.org/content/406  不知道这样讲，大家理解不理解，欢迎一起讨论    \n     2012-07-02 21:08 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  有木有来个腾讯任意修改用户密码？那就帅了！    \n     2012-07-17 09:02 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  给的rank太少了~~大胆猜测为了避免吸引更多人测试    \n     2012-07-17 10:52 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  原来，果然还是要有流氓的思想，才能做大黑客    \n     2012-07-17 13:31 |    \t\tCp0204 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:4        | 著名艺术家)\t\t \n  太无所谓了，下次该改客服的密码，懂吧    \n     2012-07-17 14:02 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  。。。这个起码也价值几十万吧，还是说用户信息在60兄看来，就这么一文不值。。。    \n     2012-07-17 14:07 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @px1624 只值一文    \n     2012-07-17 21:55 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @xsser 话说腾讯，我提交了一个漏洞他们都确认一个半月了，已经公开了。现在还没修补、、    \n     2012-07-30 16:51 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  @xsser 图虫网也很像时间戳。    \n     2012-07-30 16:54 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  @xsser 不过他们的时间戳戳了几次的    \n     2012-07-30 20:00 |    \t\tsoftbug \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:10        | 为人类设计最好的软件，解放人的双手,一起...)\t\t \n  only_guest 你的那篇pdf很不错啊    \n     2012-07-30 21:09 |    \t\t鬼哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:136 漏洞数:13        | 鬼哥 ！！！！)\t\t \n  哎    \n     2012-08-01 17:10 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  rank 11?!!!!!!!!!!    \n     2012-08-01 17:22 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @Passer_by 嗯，你没看错，rank是11 。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}