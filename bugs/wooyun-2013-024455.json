{"id": 11594, "wybug_id": "wooyun-2013-024455", "wybug_title": "百度搜索和新浪视频组合产生反射型XSS（作用域在www.baidu.com）", "wybug_corp": "百度", "wybug_author": "zyymartin", "wybug_date": "2013-05-26 11:29", "wybug_open_date": "2013-07-10 11:30", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-10：\t细节向公众公开  简要描述： 百度搜索和新浪视频组合产生反射型XSS（作用域在www.baidu.com） 详细说明：  无意间发现的这个漏洞，希望尽快修复，同时这里感谢@blast帮助分析！，好了咱们来看看漏洞是如何构造的吧~跨站构造过程：1、 先在新浪视频投稿，视频名称为xss代码，例如</script>alert(/xss/)</script>等待审核通过http://video.sina.com.cn/v/b/78301751-2731820701.html2.然后等百度收录以后，在百度搜索这段代码3.之后由于sina.com返回给百度的视频信息hash表中存储标题的地方没有过滤掉XSS跨站代码导致百度这个综合搜索结果出现了xss重现跨站漏洞：\nhttp://www.baidu.com/baidu?word=%22%2F%3E%3Cscript%3Ealert(%2Fxss%2F)%3C%2Fscript%3E&tn=myie2dg&ch=6\n漏洞现场：\n\n   漏洞证明：  重现跨站漏洞链接：\nhttp://www.baidu.com/baidu?word=%22%2F%3E%3Cscript%3Ealert(%2Fxss%2F)%3C%2Fscript%3E&tn=myie2dg&ch=6\n漏洞证明：1、http://video.sina.com.cn/v/b/78301751-2731820701.html2、HASH表没过滤\n<a data-click=\"{    'F':'778717EA',    'F1':'9D73F1E4',    'F2':'4CA6DE6B',    'F3':'54E5343F',    'T':'1369461963',        'y':'DFF9FFF7'              ,'rsv_sug9':'\"><script>alert(/xss/)</script> site:video.sina.com.cn'        }\"  href=\"http://www.baidu.com/link?url=1uq__E6Y0Y3wZnKiqd0vhen-uhLKHE_mU3Zj8isDG2kll_RwYfQRE2v4f3hdwZp6FlmtPLUMhQ619DUPcXN-\"   target=\"_blank\" &gt;<em>\"/&gt;&lt;script&gt;alert(/xss/)&lt;/script&gt;</em>.php__新浪播客</a></h3>     <div class=\"c-abstract\"><em>\"/&gt;&lt;script&gt;alert(/xss/)&lt;/script&gt;</em>.php相关视频 \"/&gt;&lt;... 0  实拍纽约布朗克斯动物园海獭残忍... 0  播-亚冠第4轮: 蒙通联VS广州恒... ...</div>\n\n\n3.跨站成功！\n\n   修复方案：  过滤综合搜索处合作商返回的结果   版权声明：转载请注明来源 zyymartin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2013-05-27 10:09 厂商回复： 感谢反馈，我们尽快安排处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-26 11:40 |    \t\tblast \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:57        | 五仁委员会)\t\t \n  前排mark    \n     2013-05-26 11:51 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  我记得google也出过类似问题 洞主敏感啊    \n     2013-05-26 12:36 |    \t\tzyymartin \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:22        )\t\t \n  @blast 哈哈哈，讲到这个漏洞还要谢谢Blast呢！Thx    \n     2013-05-26 13:16 |    \t\tblast \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:57        | 五仁委员会)\t\t \n  @zyymartin 我是打酱油的＝。＝    \n     2013-05-26 15:29 |    \t\tDemon \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:14        | You are my dream)\t\t \n  mark    \n     2013-07-03 09:48 |    \t\t核攻击 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:7        | 统治全球，奴役全人类！毁灭任何胆敢阻拦的...)\t\t \n  good..    \n     2013-07-10 12:16 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  不错    \n     2013-07-11 09:51 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:29        | Focus On Web Secur1ty)\t\t \n  感觉和以前百度快照的那个xss差不多额    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}