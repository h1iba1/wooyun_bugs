{"id": 8944, "wybug_id": "wooyun-2013-039645", "wybug_title": "去哪儿任意进入他人账号（OAuth 2.0无绑定token问题）", "wybug_corp": "去哪儿", "wybug_author": "lhshaoren", "wybug_date": "2013-10-14 12:42", "wybug_open_date": "2013-10-14 17:01", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-14：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： OAuth 2.0协议，access_token无验证 详细说明：  1、A账户登录A应用\n\n2、获取A账户access_token\n\n3、B账户登录去哪儿网\n\n4、在response时，截包修改为A账户access_token\n\n   漏洞证明：  登录为A账户\n\n   修复方案：   WooYun: 啪啪任意进入他人账号（OAuth 2.0无绑定token问题） 58也存在同样问题，懒得提交了   版权声明：转载请注明来源 lhshaoren@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-10-14 17:01 厂商回复： 首先非常感谢lhshaoren同学对去哪儿网的关注，这个问题已经与\tlhshaoren沟通并确认，问题不是发生在我们的应用上。这个攻击测试过程是通过authorize接口，获取到code，这个code是用来通过授权回调地址传入，然后通过OAuth2/access_token 换取access_token，问题应该出在oauth接口上同时我们对第三方登录成功后还要求再验证一个用户密码。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-14 14:23 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  access_token较难获取到得其实    \n     2013-10-14 17:07 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  赞去哪儿    \n     2013-10-14 21:22 |    \t\tlhshaoren \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:7        | OM)\t\t \n  同赞，经分析，问题出在request_token上，weibo对不同应用返回的是同一code，导致可以相互登录    \n     2013-10-15 01:49 |    \t\t想要减肥的胖纸 \t\t\t( 普通白帽子  |\t\t\t        Rank:250 漏洞数:42        )\t\t \n  这token神马的不是cookies么。有cookies神马网站登录不上去？尼玛我有某网站A用户的cookie然后换成B用户。。。QQ的有IP验证····唉。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}