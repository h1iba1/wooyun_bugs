{"id": 88717, "wybug_id": "wooyun-2016-0195744", "wybug_title": "北方网内容管理系统SQL注入                                      ", "wybug_corp": "天津北方网新媒体集团股份有限公司", "wybug_author": "Azui", "wybug_date": "2016-04-13 10:40", "wybug_open_date": "2016-07-15 23:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-06-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-15：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： RT 详细说明：  @刺刺 感谢大牛带领挖洞~1#:验证码设计缺陷导致可爆破账号登录估计是这样的逻辑：1. 同一个账号多次尝试，会被封禁30min2. 同一个ip，多次尝试会出现验证码。获取客户端的IP没有考虑XFF\n\n基于IP地址来统计尝试次数的使用XFF来伪造IP地址可避免验证码爆破将逻辑改一下：我们一般破解是这样的a 123a 1234a 123456用户不变，试密码我改成了a 123b 123c 123用户字典大一点，这样就不容易被封禁了2#:后台注入找到一处地方存在注入注入点：/pub/m_user/userList.jsp?keyword=1%27&channel_id=2760600000000000参数：keywordORA-00911: invalid character Query: select * from (select tn_user.*,row_number() over(order by state desc,channel_id asc,true_name asc) r__ from tn_user where state in (0,1) and (user_name like '%'%' or true_name like '%'%') ) where r__>=1 and r__<=20 Parameters: []注入点没任何过滤，可直接用注入工具跑利用注入来注出root就可以为所欲为了。   漏洞证明：  引用刺刺大牛发布的漏洞：http://**.**.**.**/bugs/wooyun-2014-081724以**.**.**.**:9001来做案例：用top500简单测试一下\n\n\n\n没一会结果就出来了，弱口令还是挺多的登录进去 利用尝试注入\n\n\n\n注入点到为止，不再深入~   修复方案：  你们懂得   版权声明：转载请注明来源 Azui@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-04-16 23:38 厂商回复： 十分感谢乌云提供的漏洞信息，目前已经针对此漏洞进行了紧急处置，制作了相应补丁程序，并修复了所有相关系统。再次感谢路人甲的协助！ 最新状态： 2016-07-06：漏洞已修复，感谢乌云及白帽子的帮助！  ", "replys": "漏洞评价：\n评价\n     2016-04-13 11:40 |    \t\ttangtanglove \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:7        | 一个对安全感兴趣的屌丝phper)\t\t \n  年前我也拔过，没拔到    \n     2016-04-20 15:36 |    \t\tAzui \t\t\t( 实习白帽子  |\t\t\t        Rank:61 漏洞数:15        | 人有两件宝，双手和大脑。)\t\t \n  匿名就没奖金了吗？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}