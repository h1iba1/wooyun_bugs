{"id": 6580, "wybug_id": "wooyun-2013-045012", "wybug_title": "51CTO存在严重逻辑设计缺陷（已证明可SHELL主站）", "wybug_corp": "51CTO技术网站", "wybug_author": "猪猪侠", "wybug_date": "2013-12-05 15:42", "wybug_open_date": "2014-01-19 15:43", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "敏感功能未限制次数"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-19：\t细节向公众公开  简要描述： 看到了伟大的路人甲提交了一个安全事件，于是顺着去看了下51CTO的安全。http://www.wooyun.org/bugs/wooyun-2013-044990 详细说明：  #1 信息收集通过分析51cto.com的网络结构，发现整体业务由多个分站构成，往往越多的系统会带来越多的安全问题，所以一个一个的摸索。\n\n~ linkphone.cn 大面积使用PHPCMS\nhttp://publish.linkphone.cn/index.php?m=admin&c=index&a=login&pc_hash=http://www.linkphone.cn/phpsso_server/?m=admin&c=login&a=init&forward=\n我想狗狗侠的PHPCMS漏洞，能直接SHELL这里！ WooYun: phpcms v9 前台无限制GETSHELL（第一弹） ~ 其它子站都采用了Discuz论坛，我们都知道Discuz如果不做专业的安全基线配置，在这个大数据满天飞的年代，肯定不安全。#2 继续收集信息\nhttp://whois.chinaz.com/51cto.comhttp://whois.chinaz.com/linkphone.cnhttp://whois.chinaz.com/cioage.comhttp://whois.chinaz.com/watchstor.comhttp://whois.chinaz.com/hc3i.cnhttp://e.weibo.com/watchstor\n这样就锁定了一些人员的邮箱或者用户名信息，这里关键的是刘强。\n\n#3 利用获取到的信息FUZZ\n%username% = 用户名%domain% = 公司域名%username%%domain%%username%1%username%12%username%123%username%1234%username%12345%username%123456%username%@123%username%@123.com%username%@163%username%@163.com%username%163%username%8%username%88%username%888%username%999%username%666%username%2008%username%2009%username%2010%username%2011%username%2012%username%2013%username%@2008%username%@2009%username%@2010%username%@2011%username%@2012%username%@2013%username%!@#\n如何FUZZ Discuz论坛参见： WooYun: 大数据HACK系列#4 百姓网论坛基础架构逻辑缺陷 (Discuz某设计缺陷的实战Fuzz篇) #4 成功FUZZ到强哥的密码\n\n   漏洞证明：  #5 刚好强哥是某个论坛的管理员\n\n#6 测试下是否可SHELL，可直接影响主站\n\n   修复方案：  # 管理入口更名或加IP限制# 登录接口加入验证码或重复次数暴力猜解限制# Discuz管理用户登陆后台增加安全提问   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-12-06 16:30 厂商回复： 感谢提交漏洞和给出安全建议，我们己经开始修复工作。再次感谢白帽子的辛苦付出。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-05 15:47 |    \t\t煦阳。 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:27        | 这个人很懒，什么都没留下。)\t\t \n  碉堡了。沙发    \n     2013-12-05 15:48 |    \t\tNoxxx \t\t\t( 普通白帽子  |\t\t\t        Rank:509 漏洞数:41        )\t\t \n  小板凳..    \n     2013-12-05 15:56 |    \t\t摸了你 \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:17        | 1shitMVqBjCKrnRvSoixMx6RKpG9J8pBM)\t\t \n  前排~~~    \n     2013-12-05 15:56 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  地板    \n     2013-12-05 16:01 |    \t\tnick被注册 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:20        | 天一)\t\t \n  火钳    \n     2013-12-05 16:08 |    \t\tFixw \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:4        )\t\t \n  拜大神~    \n     2013-12-05 16:10 |    \t\tHuc-Unis \t\t\t( 普通白帽子  |\t\t\t        Rank:1055 漏洞数:292        | 诶，现在通用奖励越来越低了；离买保时捷卡...)\t\t \n  求大神收下小弟！    \n     2013-12-05 16:10 |    \t\t大白菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:19        )\t\t \n  来学习    \n     2013-12-05 16:21 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  前10    \n     2013-12-05 16:25 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  前排关注    \n     2013-12-05 17:06 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  我是来看细节的！    \n     2013-12-05 17:28 |    \t\t花生^_^ \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 加强学习~~)\t\t \n  围观学习大神！！！    \n     2013-12-05 18:12 |    \t\tStardustsky \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | ……)\t\t \n  51都逃不掉，必须mark    \n     2013-12-05 18:31 |    \t\tMujj \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:4        | IDC商)\t\t \n  唉。。。这次51cto倒霉了 数据库都脱了， 我只想对你那个脱裤的人骂一句！ 求一份数据库    \n     2013-12-05 18:33 |    \t\t封印师 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 我是小彩笔来的。...(｡•ˇ‸ˇ•｡) ...)\t\t \n  我来给大神捡肥皂了！    \n     2013-12-05 19:04 |    \t\ttxcbg \t\t\t( 普通白帽子  |\t\t\t        Rank:391 漏洞数:53        | 说点什么呢？)\t\t \n  关注    \n     2013-12-05 20:17 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  @封印师 亮了。。。。    \n     2013-12-05 23:39 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 承接:钻井，架工，木工，电工，水暖工，力...)\t\t \n  猪猪侠阔指定网站入侵无压力！！！    \n     2013-12-06 09:45 |    \t\twinsyk \t\t\t( 普通白帽子  |\t\t\t        Rank:108 漏洞数:16        | 越长大越孤单)\t\t \n  51cto是discuz。。    \n     2013-12-06 10:30 |    \t\tfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:664 漏洞数:79        | 想刷个6D)\t\t \n  不会又是wp吧    \n     2013-12-06 19:19 |    \t\txiaogui \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:24        | 围观大牛来了~~~)\t\t \n  给大神跪了    \n     2013-12-07 02:46 |    \t\t情逍遥 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        )\t\t \n  51cto呀，我博客还在上面    \n     2013-12-07 20:05 |    \t\t子墨 \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:22        | 天地不仁,以万物为刍狗;圣人不仁,以百姓为...)\t\t \n  洞主所出，必属精品！    \n     2013-12-12 23:40 |    \t\t廷廷 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 有很强的好奇心，爱好广泛，求女女带走。。...)\t\t \n   太厉害了！    \n     2014-01-06 01:12 |    \t\tnick被注册 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:20        | 天一)\t\t \n  好思路！    \n     2014-01-06 10:36 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  我是抱着学习的心态来的，我是一个好学的孩纸~洞主你收了我把！    \n     2014-01-09 14:00 |    \t\t小仙仙 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:8        | 吊丝做完全)\t\t \n  可想而知，他手里有多少裤子，太危险了。    \n     2014-01-19 18:02 |    \t\tStranger \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 我注意你很久了.....)\t\t \n  我注意你很久了....    \n     2014-01-19 22:55 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  得了吧，狗狗侠就是你把？    \n     2014-01-19 23:56 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  51CTO已经被打成马蜂窝了……    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}