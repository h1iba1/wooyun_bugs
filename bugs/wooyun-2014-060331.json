{"id": 2263, "wybug_id": "wooyun-2014-060331", "wybug_title": "逐浪CMS某处组合getshell（需管理员权限证明已经得到官方shell）", "wybug_corp": "逐浪CMS", "wybug_author": "xlz0iza1", "wybug_date": "2014-05-12 11:41", "wybug_open_date": "2014-08-10 11:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-10：\t细节向公众公开  简要描述： RT 详细说明：  检测demo测试站点。通过下面俩个站点组合直接shell。http://demo.zoomla.cn/user/http://demo.zoomla.cn/Admin/Site/Default.aspx   漏洞证明：  通过官网的测试用户admin/admin888登录到管理员中心。如果渗透普通站点可以利用 WooYun: 逐浪CMS某设计缺陷任意用户登录(可获取删除修改权限) ,绕过提升权限。首先进入：http://demo.zoomla.cn/user/找到发表文章处。\n<form method=\"post\" action=\"/Common/FileUpload.aspx?ModelID=2&amp;FieldName=pic&amp;NodeId=136\" id=\"form1\">//..代码省略    </form>先冲这里上传任意文件\n获取上传URL:http://demo.zoomla.cn//Common/FileUpload.aspx?ModelID=2&FieldName=pic&NodeId=136这里没有用户权限验证,可以直接不需要登录的情况下上传图片文件。\n\n\nparent.DealwithUploadPic(\"jzzjlm/jpg/2014/5/201405111556413889.jpg\",\"txt_pic\");parent.DealwithUploadImg(\"/UploadFiles//jzzjlm/jpg/2014/5/201405111556413889.jpg\",\"Img_pic\");\n图片没有对内容进行恶意判断,只是对文件名进行了恶意后缀判断。然后在来到：http://demo.zoomla.cn/Admin/Site/Default.aspx页面：http://demo.zoomla.cn/Admin/Site/SiteFileManage.aspx?siteName=demo.zoomla.cn&index=0&PPath=\\UploadFiles//jzzjlm/jpg/2014/5/直接修改文件,删除文件，等操作。\n\n一句话木马地址：http://demo.zoomla.cn/UploadFiles/jzzjlm/jpg/2014/5/z.aspx\n\n泄漏一些数据就蛮多啦。\n\n\n\n   修复方案：  1、对文件上传进行检测判断文件内恶意代码2、对修改文件类型进行判断或者过滤   版权声明：转载请注明来源 xlz0iza1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-05-12 17:14 厂商回复： 感谢反馈。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-12 12:31 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  后台？还要管理员权限？好像看起来危害没那么大？    \n     2014-05-12 13:23 |    \t\txlz0iza1 \t\t\t( 普通白帽子  |\t\t\t        Rank:1027 漏洞数:207        | \"><script/src=data:,alert(1)%2b\")\t\t \n  @wefgod 跟面前面的任意用户登录可以结合利用。    \n     2014-05-12 16:27 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @xlz0iza1 结合使用的话其实作为一个案例看着最爽。    \n     2014-06-02 22:43 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  之前的任意用户登录只是前台的吧？好像这里要的是后台权限？前台登录了好像不自动关联到后台登录去吧    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}