{"id": 55872, "wybug_id": "wooyun-2014-059728", "wybug_title": "四川省某市人民法院后台敏感信息泄漏并造成潜在破坏风险", "wybug_corp": "四川省某市人民法院", "wybug_author": "路人甲", "wybug_date": "2014-05-06 23:54", "wybug_open_date": "2014-06-20 23:55", "wybug_type": "重要敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["后台敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-20：\t细节向公众公开  简要描述： 源于开源模版的漏洞，可以构造SQL注入攻击，返回网站后台超级管理员权限，以全功能模式登录后台利用Chrome或者Firebug修改页面元素可以链接一句话，也可以通过插入改变config.asp文件导致数据库信息错误，网站无法访问。 详细说明：  1：弱后台，很好猜出来。2：见到后台界面，很常见，可以人工判断是aspcms的开源模版。3：利用SQL过滤逻辑问题构造的exp的不贴了，因为之前网上已经有人发过且详细解释过nindonCMS这个exp的成因。4：搜索关键词nindon，同类站点有批量的风险。5：关于服务器，如果服务器是IIS 6.0，可以利用服务器解析漏洞上传一句话拿webshell（已在其它同类网站实践过）。6：如果服务器是IIS 7.5，可以利用一个旧的aspcms IIS 7.5通杀漏洞来插入一句话拿webshell，这个我不多说了，链接如下http://www.myhack58.com/Article/html/3/62/2012/35468.htm7：要说明的是6中的这种插入成功后实际修改了config.asp这个文件中和数据库链接的参数。因此如果一句话插入不成功，会导致整个网站无法访问，必须通过远程服务器或者ftp打开config.asp文件修改回原始config.asp内容。虽然后台超级用户密码泄漏不稀奇，但是失败的一句话插入却能造成很大的问题。   漏洞证明：  考虑到安全，只向乌云提交了真实地址，其它抹掉。www.pzfy.org\n\n这个后台很熟悉是不是？没错，就是aspcms的后台，虽然图片里写着nindon\n\nadmin出来了\n\n登录全功能后台\n\n因为是超级管理员，其它用户权限皆可修改，也可以通过后台删除网站内容和备份，风险已经相当大\n\n这个站是用的IIS7.5，所以要突破接着上面第6点，但是我自己在VM上搭建的nindonCMS+IIS7.5网站直接被插崩溃了，后台通过修改config.asp恢复。这里没有图片，而且我也不可能拿这个站点做这么危险的试验，感兴趣的可以自己搭建环境试试。   修复方案：  1.如果是直接用aspcms开源模版，那就升级，升级版已经没有那个构造exp的函数逻辑错误了。2.如图3，如果是nindoncms，没有升级版，有两个方法，用远程服务器或者ftp都可行：  a)将远程服务器上网站根目录下的wwwroot.rar文件移动到其它目录，这样用户将无法通过后台页面进入后台进行管理。要更新网站内容的时候再把wwwroot.rar文件移回默认位置即可正常登入后台。  b)用ftp删除后台登录的asp文件，需要登录时再上传后台asp文件。  c)根治的办法，修改/inc/AspCms_CommonFun.asp中的SQL过滤规则，但是这对于普通网管来说不太容易实现。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-05-10 00:09 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给四川分中心处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-07 14:31 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  您好！    请您提供下详细的漏洞过程，包括：测试入口及登录账号、密码，可邮件：vreport@cert.org.cn，以便CNVD及时验证、处置。谢谢！    祝好！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}