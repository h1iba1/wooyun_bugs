{"id": 25992, "wybug_id": "wooyun-2015-0116424", "wybug_title": "明道运维不当导致通过系统api查看企业内部信息", "wybug_corp": "上海万企明道软件有限公司", "wybug_author": "0c0c0f", "wybug_date": "2015-05-27 08:15", "wybug_open_date": "2015-06-24 09:25", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-24：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 运维不当导致黑客可获取access_token，进而通过api查看企业(部分)内部信息。 详细说明：  1、神器发现明道log.mingdao.com分站存在目录遍历漏洞\n\n\n\n2、通过日志查看企业私有信息Index of /api/2015-05-26/../10-6-1-41_api.log                                  27-May-2015 01:30       010-6-2-60_api.log                                  27-May-2015 01:30       010-6-5-130_api.log                                 27-May-2015 01:30       010-6-8-109_api.log                                 27-May-2015 01:30    143K日志中包含带有access_token的url：http://api.mingdao.com/post/v2/img.aspx?access_token=2a691ac8247447baa90223b9374168b4&pagesize=10&post_type=0&filter_type=0&format=json\n\n\n\n4、通过返回的json内容查找文档发现可以下载\n\n理论上来说通过access_token可以获取任何数据了。5、其他目录同样有一些敏感信息，不再一一例举。   漏洞证明：  1、Index of /api/2015-05-26/../10-6-1-41_api.log                                  27-May-2015 01:30       010-6-2-60_api.log                                  27-May-2015 01:30       010-6-5-130_api.log                                 27-May-2015 01:30       010-6-8-109_api.log                                 27-May-2015 01:30    143K日志中包含带有access_token的url：http://api.mingdao.com/post/v2/img.aspx?access_token=2a691ac8247447baa90223b9374168b4&pagesize=10&post_type=0&filter_type=0&format=json\n\n\n\n2、通过返回的json内容查找文档发现可以下载\n\n   修复方案：  1、禁止目录遍历。   版权声明：转载请注明来源 0c0c0f@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-05-27 15:19 厂商回复： 谢谢作者的提交，第一时间堵上了运维上的漏洞，将端口等防火墙重新设置，同时对后端运维系统再次核实做了策略上的巩固，也对截图上的信息做了临时处理。 最新状态： 2015-06-24：感谢作者的提交，第一时间已经修复，可以公开  ", "replys": "漏洞评价：\n评论\n     2015-05-27 08:23 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  我以为你知道access_token算法了，每次都固定的。    \n     2015-05-27 09:06 |    \t\t0c0c0f \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:15        | My H34rt c4n 3xploit 4ny h0les!)\t\t \n  @专业种田 恩，都是固定的。那些url是记录到日志里面的，只能获取少部分，所以影响面不大。但是每天都有会产生新的log。    \n     2015-05-27 09:43 |    \t\t糖剩七颗 \t\t\t( 普通白帽子  |\t\t\t        Rank:430 漏洞数:61        | 天涯何处无屌丝)\t\t \n  日志的产生了很多token，我也看到了    \n     2015-05-27 10:24 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  — —。洞察能力很强啊，我也闻到了    \n     2015-05-27 10:46 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  @0c0c0f 他们的日志太多了，我靠，down了一部分，没看，直接删了，发现他们redis里面有人写的shell，哈哈，    \n     2015-05-27 11:43 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  @紫霞仙子 我写的，已私下提交明道相关负责人。    \n     2015-05-27 12:12 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:2738 漏洞数:547        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  @hkAssassin @紫霞仙子   nice   明道是良心厂商  大家要多帮助    \n     2015-05-27 12:16 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  @爱上平顶山 是啊，只有一次高危的厂商,要多帮助下    \n     2015-05-27 12:45 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  @爱上平顶山 需要多帮助    \n     2015-05-27 12:46 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  @紫霞仙子 哈哈！有些回复你自己意会就可以了！redis 的shell 不是被你也发现了么！    \n     2015-06-24 12:21 |    \t\tBan have \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:4        | 面朝黑夜，彼心与月)\t\t \n  什么神器    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}