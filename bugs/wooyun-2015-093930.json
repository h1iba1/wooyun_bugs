{"id": 39494, "wybug_id": "wooyun-2015-093930", "wybug_title": "惠普网络打印机默认配置不当（大量打印机可未授权外部访问）", "wybug_corp": "惠普", "wybug_author": "HeartOfOcean", "wybug_date": "2015-01-26 12:38", "wybug_open_date": "2015-04-02 10:23", "wybug_type": "默认配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["配置不当", "默认密码"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-27：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向公众公开  简要描述： 惠普网络打印机配置不当，可远程打印任意内容（HP Network Printer with a wrong default configuration which can print any document unauthorized through the web）英语不太好，凑合着翻译了一下。看惠普的审核好像只懂英语，汉语的都忽略了。 详细说明：  前言：前几天去打印店，老板告诉我网断了不能打印，U盘里的也不行。难道打印机还需要联网，不是USB的么？回来之后查了一下才发现，有一种打印机叫做网络打印机。最近知道了zoomeye能搜索网络设备，我就随便搜了一下试试。发现好多打印机开着80端口。以http://131.193.***.58/为例：打开之后的界面如图一所示。The web page (Fig.1) which show us the Black Cartridge ,Pages printed with this supply ,etc：\n\n能够显示墨盒、已打印张数等内容。甚至可以更改设置，如图二。Even we can change the settings (Fig2).\n\n网络连接也可以更改，如图三。Network settings(Fig3)\n\n只看改这些设置没意思啊。试试能不能用它打印东西呢？于是在网上查找了一篇怎么连接HP网络打印机的教程，如图四。I want to try if I can print with this printer .I searched for a passage about how to centect a HP network printer (Fig4)按着教程的，添加打印机-从网络添加-输入IP-选择打印机型号-自动下载驱动-竟然连接上了！如图五所示。Step by step , Im surprised that the printer is Connected!!!(Fig5)\n\n试试能不能打印东西？如图一所示，此墨盒已打印张数是1085，为了不吓到打印机的主人，我打印了此Web页面（根据Networking界面的Domain name查了一下是芝加哥某大学的），如图六。然后他变成了1086，开始怀疑是不是正好赶上他们用打印机了。故意隔了一段时间，又试了一次，数字变成了1087（如图七）！！Try to print ,\"Pages printed with this supply*: 1085\"in Fig1.I printed the web page(Fig6)and it changed to 1086 ,after a moment I try again ,the number changed to 1087!!(Fig7)\n\n\n\n为了证明不是个例，对HP的设备进行了搜索如图八。In order to prove it's common, I searched the HP device .(Fig8)\n\n又随机找了一台在线的设备进行测试，再次成功连接，图九、十。Tried to find another device,and contected successfully(Fig9,10).\n\n\n\n尝试打印了两张空白页面，已打印张数从958（图十一）长到了960（图十二）。Tried to print two pages , the number \"Pages printed with this supply\" changed from 958 to 960.\n\n\n\n测试完毕，所有打印机已删除。I've deleted these printer connects .   漏洞证明：  \n\n\n\n\n测试的两台打印机地址。没敢多测，有些设备能搜到，但是无法连接web页面，因为此时打印机没有开机吧？能打开web页面的应该都能打印。The address that I testedhttp://131.193.174.58/http://124.133.48.247:8080/(The printer only which can open web page can be connected )\n   修复方案：  1.更新固件update software2.默认关闭web界面Don not open the 80/8080 port defaultly3.对打印机连接进行身份认证Identity authentication of the printer connection   版权声明：转载请注明来源 HeartOfOcean@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-04-02 10:23 厂商回复：  最新状态： 2015-04-02：Hello,As you have explained, this problem is a configuration issue.  ", "replys": "漏洞评价：\n评论\n     2015-06-23 12:23 |    \t\t蝶舞天涯 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 家穷人丑，一米四九，小学文化，农村户口，...)\t\t \n  还带中英互译的。哈哈，有趣，    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}