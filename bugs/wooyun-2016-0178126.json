{"id": 87140, "wybug_id": "wooyun-2016-0178126", "wybug_title": "某集中无线控制器命令执行（从svn信息泄露到命令执行/需要登陆)", "wybug_corp": "sunnada.com", "wybug_author": "带头大哥", "wybug_date": "2016-02-24 14:03", "wybug_open_date": "2016-05-26 17:40", "wybug_type": "", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["应用敏感信息泄漏", "信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-02-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-29：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-04-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-26：\t细节向公众公开  简要描述： 从svn信息泄露到命令执行 详细说明：  #三元达通信集中无线控制器#存在SVN文件源代码泄漏漏洞漏洞#案例演示（漏洞深度影响等不再过多赘述）:#**.**.**.**/.svn/entries\n\n#**.**.**.**/.svn/entries\n\n#**.**.**.**/.svn/entries\n\n#**.**.**.**/.svn/entries \n\n#**.**.**.**/.svn/entries\n\n通过svn信息泄露把源代码down到本地其他页面都需要登录验证\n\n如\n<?php include '../isLogin.php' ?>\n在审计过程中发现如下\napgroup/getChannelByCountryCode.php\n\n\n系统中gpc为off,这里就是个sql了但是默认不回显，我们加上or 1=1使他回显，然后用sqlmap注入\n\n\n\n在islogin.php文中，我们知道他的管理员保存的表如下：\n\nselect * from LoginAccount where UserId=\".$_UserId.\" and UserName='\".$_UserName.\"'\" 直接sql-shell获取\n\n[12:00:02] [INFO] retrieved: 347[12:00:28] [INFO] retrieved: 25d55ad283aa400af464c76d713c07ad\n\n在ap/ap_base_info.php处找到一处命令执行\n\n由于该处命令执行不回显，所以采用cloudeye使用cloudeye执行命令\n\n但是在cloudeye后台死活没反应，经过快2小时找原因，特么的，居然不能访问外网，我擦最终找到web路径直接内网执行，但是得注意的是，他对参数有过滤\nfunction safeValue($data){    if (!get_magic_quotes_gpc())    {           $srcarr=array('<','>');           $replacarr=array('&lt;','&gt;');           return is_array($data) ? array_map('safeValue', $data) :str_replace($srcarr,$replacarr,addslashes($data));    }}\n所以我们执行下\n\n\n\n   漏洞证明：  #附带剩余35案例：\n**.**.**.**/.svn/entries       **.**.**.**/.svn/entries**.**.**.**/.svn/entries       **.**.**.**/.svn/entries**.**.**.**/.svn/entries       **.**.**.**/.svn/entries**.**.**.**/.svn/entries        **.**.**.**/.svn/entries**.**.**.**/.svn/entries       **.**.**.**/.svn/entries**.**.**.**/.svn/entries       **.**.**.**/.svn/entries**.**.**.**/.svn/entries       **.**.**.**/.svn/entries**.**.**.**/.svn/entries       **.**.**.**/.svn/entries**.**.**.**/.svn/entries       **.**.**.**/.svn/entries**.**.**.**/.svn/entries       **.**.**.**/.svn/entries**.**.**.**/.svn/entries       **.**.**.**/.svn/entries**.**.**.**/.svn/entries       **.**.**.**/.svn/entries**.**.**.**/.svn/entries        **.**.**.**/.svn/entries**.**.**.**/.svn/entries        **.**.**.**/.svn/entries**.**.**.**/.svn/entries       **.**.**.**/.svn/entries**.**.**.**/.svn/entries       **.**.**.**/.svn/entries**.**.**.**/.svn/entries        **.**.**.**/.svn/entries**.**.**.**/.svn/entries\n所以我们执行下\n\n\n\n   修复方案：  立即修复.注：注入重复http://**.**.**.**/bugs/wooyun-2015-0151898   版权声明：转载请注明来源 带头大哥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2016-02-26 17:31 厂商回复： CNVD确认并复现所述情况，已由CNVD通过软件生产厂商公开联系渠道向其邮件通报，由其后续提供解决方案并协调相关用户单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-02-24 14:19 |    \t\tYY-2012 \t\t\t( 核心白帽子 |\t\t\t        Rank:3814 漏洞数:726        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  www.wooyun.org/bugs/wooyun-2015-0151898    \n     2016-02-25 08:33 |    \t\t带头大哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:819 漏洞数:247        | |任意邮件伪造| |目录遍历| |任意文件读取|...)\t\t \n  @YY-2012 注入重复，已在漏洞详细中备注。SVN的是另一种设备~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}