{"id": 73208, "wybug_id": "wooyun-2015-0154506", "wybug_title": "1号社区APP及网站多个安全漏洞合集（已GetShell）", "wybug_corp": "yihao01.com", "wybug_author": "伏地魔", "wybug_date": "2015-11-23 17:25", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "平行权限", "命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： 1号社区APP及网站存在多个高危安全漏洞，已获得全部网站及服务器权限 详细说明：  1号社区APP及网站存SQL注入，后台弱口令，订单遍历，struts2命令执行等多个高危安全漏洞   漏洞证明：  1、APP某接口存在注入点，以root权限运行，可以查看到全部数据库信息http://eshop.yihao01.com/basedata/api/getUnitListByCity?cityCode=610900&sign=50E09B39C916C1C3A06506EBDBBC0427&v=2.4.0&pageNumber=0&pageSize=10&ttid=1存在注入的参数：cityCode、pageNumber、pageSize\n\n注册用户及密码：\n\n管理后台用户及密码：\n\n2、管理后台验证码功能未生效可造成暴力破解，发现某些账户存在弱口令，客服账号可以即时查看到手机用户接受到的短信验证码，利用该功能可以发送验证码查看后重置任意用户密码。（其实通过上面的注入漏洞可以看到后台管理用户密码，32位、修改后的30位、31位md5值都有，但大部分没破解出来……）http://eshop.yihao01.com/gl/admin/kefu：123456kmh：kmh666\n\n\n\n3、APP存在任意查看订单漏洞，通过修改orderId参数的值可越权查看到其他人的订单，并且可遍历全部订单信息，造成客户敏感信息泄露存在问题的请求：\n\n查看其他人的订单信息，如：\n\n\n\n遍历订单信息：\n\n4、本来以为拿不到网站权限的，后来找到公司的另一个网站，发现管理后台网站存在struts2框架漏洞，以root权限运行，可以执行任意命令。上传一句话木马，成功拿到webshell后，竟然发现全部网站放在同一台服务器里面，于是就呵呵了http://www.0easy.com/login_login.do\n\n\n\n\n\n   修复方案：  以上漏洞对应的修复方案如下，你比我懂的……1、过滤特殊字符，并不要以root用户连接数据库2、更改后台管理账号为复杂的密码，修改验证码机制使其生效3、对用户权限进行验证，只能查看到自己的订单信息4、更新struts2框架到最新版本，并不要以root权限运行花了好多时间去挖漏洞和写出来，厂商可以送个礼物给我么，嘻嘻   版权声明：转载请注明来源 伏地魔@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-11-23 18:02 厂商回复： 安全无小事，正在修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}