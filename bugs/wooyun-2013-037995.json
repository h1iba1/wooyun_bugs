{"id": 61801, "wybug_id": "wooyun-2013-037995", "wybug_title": "福建省教育厅某分站注入漏洞", "wybug_corp": "福建省教育厅", "wybug_author": "ifc0nfig", "wybug_date": "2013-09-25 13:01", "wybug_open_date": "2013-11-09 13:01", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "尘缘雅境"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-09：\t细节向公众公开  简要描述： 在处理querystring的时候，仅仅过滤了单引号，对于整形数值的参数，可以直接注入，并爆出后台用户名密码 详细说明：  dig.asp中的第6行\n\n，可以看到仅仅对单引号进行了替换，而本身newsid是int类型的，只要提交类似的请求:newsid=11 union select username from admin ，就可以完全执行起来， 尘缘雅境1.5默认的管理员和用户表分别为 admin， ft_user, 可以分别爆出对应的前台和后台密码，然后登陆，通过修改上传文件类型getshell   漏洞证明：  如下，首先爆出后台用户名\n\n接着可以爆出密码：\n\n对于前台的用户表可以同样的获取，需要注意只有admin的key字段为super的才为超级管理员然后前台登陆, login.asp\n\n接着登陆后台，添加上传文件类型，不可为asp，asa，cdx，aspx，因为上传做了限制，可以利用iis6的解析漏洞，自己联想\n\n最后是菜刀获取shell的证明：\n\n   修复方案：  修复方案， 对传入的newsid进行严格的检查直接百度 尘缘雅境文章系统1.5，可以发现很多中小站点使用这套系统，包括很多的gov站点，以及改自尘缘雅境的站点。   版权声明：转载请注明来源 ifc0nfig@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2013-09-30 10:09 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-25 13:11 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  您好！请提供该漏洞的测试入口，以便CNVD测试。谢谢    \n     2013-09-25 16:15 |    \t\tifc0nfig \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 希望和各位白帽子一起分享各种奇妙的bug)\t\t \n  @cncert国家互联网应急中心 http://fjzjxh.fjedu.gov.cn    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}