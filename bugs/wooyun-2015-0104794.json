{"id": 22213, "wybug_id": "wooyun-2015-0104794", "wybug_title": "成都地铁公交卡可被无限复制篡改从而可免费出行（射频卡设计安全隐患）", "wybug_corp": "CNCERT", "wybug_author": "Ano_Tom", "wybug_date": "2015-03-30 17:12", "wybug_open_date": "2015-07-02 15:32", "wybug_type": "设计不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-02：\t细节向公众公开  简要描述： 继上次免费用水、吃饭后，这次该免费出行了，很简单的M1卡设计缺陷，可将卡数据无限复制篡改，且使用时，各卡金额互不影响。 详细说明：  初始过程为，天府通卡。充值电子钱包10.20，充值公交次数6次（刷卡金额提示12元，2元一次）。刷地铁是消耗的电子钱包，分段计费。刷工具有时是按次数计费（冲6次，刷卡会提示有12元，此12元不是电子钱包的余额），有的公交是扣的电子钱包的钱（刷卡提示的金额为电子钱包的余额）详情如下\n\n\n\n\n\n复制卡如图\n\n关于算法缺陷等等问题，请自行查看国外相关paper。我们只需要证明公交卡可以被读取全卡数据，且卡可被无限复制，而且其在刷卡过程中并未进行网络验证即可。读取的初始卡信息为\n\n同时将数据写入白卡里（可改uid，可多次擦写）。上午公交测试：初始刷的白卡，消耗的为公交次数\n\n消耗1次公交次数，剩余10元然后刷了原卡，消耗了1.8元，其消耗的是电子钱包，剩余8.4元。由于上午测试，有两张未拍到照片，所以将复制卡也消费了1.8元电子钱包，使其金额也为8.4元，与原始卡金额相同。转而下午进行测试。下午测试，从地铁口刷卡，然后直接在出口刷，如图复制卡，入口：\n\n直接出口刷：\n\n此时余额为6.6元，即一站的地铁花了1.8元测试原始卡，入口：\n\n出口\n\n也花费了1.8元，剩余6.6元。两张卡的金额互不影响。其在初始状态并未联网进行数据的确认。测试公交：原始卡（未拍到卡）：\n\n在之前6.6的基础上消费了0.9元然后测试复制卡：\n\n同样可以使用。综上，卡信息可被完全读取，再消费完毕后，可以将卡的信息继续写入，从而可以无限使用。在消费过程中卡数据并未联网认证。在消费了几次后，去柜台充值，依然可以正常使用。当然，财务汇总对账的时候是否会出现异常，并不清楚。   漏洞证明：  如上。注：以上的消费均为善意地安全测试，如封卡请查看图片的卡号以及uid序列号   修复方案：  升级卡   版权声明：转载请注明来源 Ano_Tom@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-04-03 15:31 厂商回复： CNVD未直接复现，已经转由CNCERT下发给四川分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-30 17:14 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  成都牛带上我    \n     2015-03-30 18:04 |    \t\tsco4x0 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:13        | O_o)\t\t \n  正好公交卡只剩4次了    \n     2015-03-30 18:06 |    \t\t黑色二进制 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:3        | 一只小白)\t\t \n  围观大牛    \n     2015-03-30 19:07 |    \t\t牛肉包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:64        )\t\t \n  请充值    \n     2015-03-31 08:51 |    \t\tLinglin \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:5        | 迷糊...)\t\t \n  没啥意思，你确实可以无限制复制，但是只要你用复制的卡消费，那么你原来的卡就会被卡公司给锁定，将会无法充值。等你用完  那就是废卡一张。并且现在地铁也在验证，也就是说，你用复制的卡在某些地铁口子是出不去的。    \n     2015-03-31 21:53 |    \t\tAno_Tom \t\t\t( 普通白帽子  |\t\t\t        Rank:368 漏洞数:40        | Talk is cheap.:)\t\t \n  @Linglin 没啥意思？是没意思，本来就很简单。不过楼主您测试过么？您能帮我解释下，为何我前几天原始卡和复制卡都刷了，昨天两张卡也都刷了，今晚去充值后卡都能正常使用，是什么鸟情况么？    \n     2015-04-19 22:06 |    \t\t黑暗游侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:1780 漏洞数:268        | 123)\t\t \n  @Ano_Tom 我笑哭了    \n     2015-04-21 10:54 |    \t\tHerolon \t\t\t( 普通白帽子  |\t\t\t        Rank:185 漏洞数:42        | ******)\t\t \n  还是M1类型的射频卡啊 这个类型的卡 只要有一个射频读卡器 一个空卡 想做什么样的卡 就做什么样的卡    \n     2015-05-27 12:22 |    \t\t小辉 \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:21        | 低调。。。)\t\t \n  @Linglin 实习白帽子，请测试后再说，OK？我就测试成功了，谁说出不了出口？    \n     2015-06-25 11:56 |    \t\tLinglin \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:5        | 迷糊...)\t\t \n  @小辉 多测试几次哈    \n     2015-07-02 16:04 |    \t\tTon7BrEak \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:43        | 吃苦耐劳，我只会第一个！)\t\t \n  mark    \n     2015-07-02 18:42 |    \t\tDeep. \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | &#8238;)\t\t \n  你上班怎么走``一路不``    \n     2015-07-02 23:43 |    \t\tStardustsky \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | ……)\t\t \n  成都的盆友一起玩啊    \n     2015-08-24 13:10 |    \t\tJoyChou \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:4        | 无)\t\t \n  nice    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}