{"id": 6032, "wybug_id": "wooyun-2013-043195", "wybug_title": "中国联通某培训中心一卡通(M1卡)饭卡金额破解", "wybug_corp": "RFID一卡通（M1卡）系统", "wybug_author": "timem", "wybug_date": "2013-11-18 00:24", "wybug_open_date": "2014-02-16 00:25", "wybug_type": "设计不当", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "硬件安全", "安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-25：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-16：\t细节向公众公开  简要描述： 一卡通系统存在安全缺陷，可复制，可修改饭卡金额等数据 详细说明：  \n\n通过ID卡漏洞，破解出所有扇区密码，如何DUMP出数据这里就不用说了吧，以下是卡里数据，红框里是保存饭卡金额扇区的KEY A\n\n刚领一卡通的饭卡金额是26元，数据没有加密存储，直接可以换算出\n\n这里对M1卡的值段简单说明下：值段，实现电子钱包的功能。（有效的命令有：读，写，增，减，恢复，发送）。值段有一个固定的数据格式，可以进行错误检测和纠正并备份管理。值段只能在值段格式的写操作时产生：值：表示一个带符号4字节值。这个值的最低一个字节保存在最低的地址中。取反的字节以标准2的格式保存。为了保证数据的正确性和保密性，值被保存了3 次，两次不取反保存，一次取反保存。红框内是正码，蓝框里是反码由于最低一个字节保存在最低的地址中，所以28 0A 00 00 正确数值是0A28，换成10进制即2600，前面两位是个位和十位，后面两位是小数点后两位。即26.00元。经过一天的一顿早饭，两顿正餐后，卡里剩23.5元\n\n2E 09 00 00  换算即23.50   漏洞证明：  由于没有刷卡机，刷卡时也没拍照，服务员都在看着呢，所有无法证明。通过以上数据应该可以证明了。   修复方案：  不要使用默认密码，通讯加密。或者换成加密强度更高的射频卡。   版权声明：转载请注明来源 timem@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-11-22 22:25 厂商回复： CNVD未直接复现所述情况，根据所述测试结果进行确认，该案例与Mifare 卡破解较为相似。已经转由CNCERT直接通报中国联通集团公司，由其后续协调所属单位处置。 硬件破解在WOOYUN上较为少见，rank 20 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-18 00:47 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  神奇的路人甲。    \n     2013-11-18 00:55 |    \t\tbig、face \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:36        | |上天请赐我一个洞|想要一件乌云衣服|)\t\t \n  神奇的路人甲。    \n     2013-11-18 00:56 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 承接:钻井，架工，木工，电工，水暖工，力...)\t\t \n  这个早就存在的洞洞。。。    \n     2013-11-18 01:08 |    \t\tbite \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | qbite)\t\t \n  只要是IC卡都可以    \n     2013-11-18 08:37 |    \t\tMr.醉心 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 爱生活，爱音乐，爱美女，更爱波多野结衣)\t\t \n  神奇的路人甲。    \n     2013-11-18 08:55 |    \t\t丶潇洒哥 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 我是一枚农民工。)\t\t \n  神奇的路人甲。    \n     2013-11-18 08:55 |    \t\tBloodwolf \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:8        | whoami)\t\t \n  ..pm    \n     2013-11-18 14:58 |    \t\t职业色羊 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 无)\t\t \n  神奇的路人甲。    \n     2013-11-18 17:24 |    \t\t小智 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:5        | 低调低调，学习学习~)\t\t \n  不是他们说pm的东西不要乱公布么-。-    \n     2013-11-23 08:00 |    \t\trootnmxx \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n  我也要学习哈哈。。    \n     2013-11-23 10:55 |    \t\t残废 \t\t\t( 普通白帽子  |\t\t\t        Rank:179 漏洞数:40        | 我是残废，啦啦啦啦)\t\t \n  神奇的路人甲。    \n     2014-02-16 02:33 |    \t\t0749orz \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:4        | 厌了，烦了~~~)\t\t \n  0.0这个给力，，我有NFC工具另有一张M1的白卡    \n     2014-02-16 12:46 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  吃了一天，花了3块多？！我去，福利太好了吧    \n     2014-02-16 13:07 |    \t\t野驴~ \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 充满强烈好奇心的菜鸟。)\t\t \n  吃了一天，花了3块多？！我去，福利太好了吧    \n     2014-02-16 13:15 |    \t\t刘海哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:114 漏洞数:28        | 索要联系方式但不送礼物的厂商定义为无良厂...)\t\t \n  大哥你是怎么吃饭的，我一顿最少都得6块    \n     2014-02-20 12:00 |    \t\tT-MAC \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:2        )\t\t \n  大哥你是怎么吃饭的，我一顿最少都得10块    \n     2014-02-21 00:42 |    \t\t0749orz \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:4        | 厌了，烦了~~~)\t\t \n  表示- -牛X    \n     2014-02-21 10:50 |    \t\tMillet \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:4        )\t\t \n  是两块多啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}