{"id": 22240, "wybug_id": "wooyun-2011-02844", "wybug_title": "利用xss攻击某些ATM", "wybug_corp": "各大银联ATM", "wybug_author": "结界师", "wybug_date": "2011-09-19 15:07", "wybug_open_date": "2011-09-19 15:08", "wybug_type": "设计不当", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "设计缺陷", "钓鱼欺诈", "安全意识不足", "利用技巧", "存储型", "目录浏览漏洞", "目录遍历文件泄漏", "配置不当", "终端机安全", "沙盒环境绕过", "遍历目录", "配置错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-09-19：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2011-09-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 某些银行/银联的ATM功能慢慢强大起来，融入了很多的其他的如购物，购买水电，在线转账等等功能，但是功能的强大意味着安全问题的可能性也增加了，譬如利用xss就可能控制一些ATM机 详细说明：  某些ATM的复杂界面的实现，都是封装了浏览器做一个沙盒，某些情况可能可以跳出沙盒（Win环境），但是某些情况跳出比较难（Linux环境没有复杂的用户潜在接口），这个时候我们可以选择利用前端复杂的逻辑，譬如xss漏洞来做一些事情   漏洞证明：  \n\n似乎找到了一个xss，扰乱了界面展现，同时也是证明使用了HTML技术的\n\n弹一个，哦，貌似是Linux的浏览器\n\n其实是需要一些技巧的，这里的输入很有限，需要绕一绕\n\n弄到本地看一看，原来是这样\n\n额，不好意思再往下了，这么挫的系统啊原来是封装了没有做安全设置的apache，还与银联有接口可以转账，这钱赚得太轻松了我只想说   修复方案：  不知道   版权声明：转载请注明来源 结界师@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2011-09-19 15:14 |    \t\tRay \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:7        )\t\t \n  牛逼    \n     2011-09-19 15:18 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  牛比    \n     2011-09-19 16:07 |    \t\t风云 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 简要介绍)\t\t \n  牛比啊  只能说牛比    \n     2011-09-19 16:29 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  牛逼，我也去试试    \n     2011-09-19 17:19 |    \t\tp.z  \t\t\t( 普通白帽子  |\t\t\t        Rank:411 漏洞数:40        )\t\t \n  牛瓣大了    \n     2011-09-19 18:02 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  kiosk 原来叫这个啊http://www.kmychina.com.cn/    \n     2011-09-20 10:35 |    \t\tsw0rder \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:5        | /*菜菜*/)\t\t \n  牛逼，上次国际大会有人展示从atm取钱，现在咱的atm也有这趋势了。呵呵 小心下次被抓    \n     2011-09-21 10:25 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  @xsser 高新技术产业联合协会XX单位 你懂的    \n     2011-10-21 20:06 |    \t\tw0lfram \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:2        | 流氓无罪，文化可耻。)\t\t \n  。。。膜拜    \n     2012-02-08 19:13 |    \t\t紫梦芊 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:9        | 踏踏实实做测试)\t\t \n  终端机都是这样的~以前读书的时候拿图书馆终端机背后的win2003环境用画图工具玩五子棋 被老师逮住痛批了一顿~    \n     2012-02-14 21:48 |    \t\txiya \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n  围观啊...    \n     2012-02-23 16:28 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  期待上TV    \n     2012-04-13 17:08 |    \t\t期待爱 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | 这个家伙很精明 连条内裤也没有留下！！！)\t\t \n  这才是真正的大黑阔    \n     2012-04-20 17:30 |    \t\t蓝风 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:25        | 崬汸慾哓 嗼檤焄垳皁 沓猵圊屾亾沬荖 颩憬...)\t\t \n  你一走 ATM吐钱了    \n     2012-05-15 23:49 |    \t\t神倦懒言 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 从事php开发以及服务器的运维工作，还是菜...)\t\t \n  \"弄到本地看一看，原来是这样\"?你把程序拷走了？——！    \n     2012-05-16 13:30 |    \t\tRay \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:7        )\t\t \n  @神倦懒言 我觉得他是说location跳到  http://localhost/    \n     2012-05-23 20:49 |    \t\t阿普 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:3        | NFT小组成员)\t\t \n  叫他吐2倍出来就好了    \n     2012-08-27 12:32 |    \t\tSunny \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 本人已参加中国共产党！中国共产党是中国工...)\t\t \n  下载了信息就好玩了……LZ你就发财了    \n     2012-08-27 20:28 |    \t\tyangff \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 介绍写什么呢？)\t\t \n  。。。你是怎么在atm上干这么多事情没被查水表的……    \n     2012-09-07 17:38 |    \t\tNimda \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 人的欲望就是一个超级大坑，永远也填不满。...)\t\t \n  牛逼    \n     2012-09-10 09:01 |    \t\tguiker \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | PHP屌丝程序员！)\t\t \n  重口味。    \n     2012-09-29 19:40 |    \t\tkkappa \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 宅男！)\t\t \n  这个貌似见过啊http://attach.blackbap.org/forum/201209/19/211810kqok4k1bp4tr11vt.jpg不知道是不是同一个漏洞    \n     2012-10-09 10:39 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  我只搞过一个工行自助的，搞溢出了，幸亏没蓝屏。不过移动打话费单的搞死机过一次，趁人不备重启，见个企鹅，原来是Linux。    \n     2012-11-09 10:02 |    \t\t小博 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 一个关注与信息安全 程序开发的IT程序员)\t\t \n  牛逼    \n     2012-11-19 17:30 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  深更半夜去的ATM吧。 -。-      大白天早被查水表了。   确实太牛b了。         \n     2012-11-21 00:32 |    \t\t7z1 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:14        | 黑客：探险家、网络中的幽灵、用技术捍卫正...)\t\t \n  @sw0rder 很危险吧。说得是，取款机前还有摄像头，要是调试到其他页面去了，弄不回来，岂不是玩大了。。。    \n     2012-12-02 13:06 |    \t\tsaber \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 我只是一个人走了太久，久到习惯了一个人。)\t\t \n  楼主发财了。。    \n     2012-12-25 12:56 |    \t\tSnow陈伦 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 闷骚的家伙，何处都是你的战场。)\t\t \n  记得在火车站无聊 也是捣鼓公共计费系统 装个程序 利用系统自带的各种设置进入操作系统，这个bug 安全审核随处可见，只是一层沙，很容易捅破。天朝早该行动了。    \n     2012-12-31 20:43 |    \t\ts1Ng4r \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:2        | runningm4n)\t\t \n  @紫梦芊 亮了    \n     2013-01-30 18:10 |    \t\t猫头鹰 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:6        | 不解释)\t\t \n  亮爆了    \n     2013-02-05 00:24 |    \t\tbombless \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 熟悉x86汇编、C语言及系统编程。实战经验较...)\t\t \n  不错，增长了知识……洞主牛啊〜    \n     2013-02-24 17:53 |    \t\theiben \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | A man)\t\t \n  只有当Linux足够的茂盛起来，真正需要我们的时代才会来临。。。    \n     2013-06-13 21:37 |    \t\t金属狂人 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 这个人很懒，什么都没留下。)\t\t \n  只能膜拜    \n     2013-06-22 12:06 |    \t\t花心 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:6        | 我是来找机油的。)\t\t \n  终端帝啊    \n     2013-07-17 17:08 |    \t\t打酱油 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:4        | 我只是个打酱油的！！！！)\t\t \n  学习了！    \n     2013-07-22 23:18 |    \t\t佐瞳 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | 专业小白二十年~)\t\t \n  膜拜。。    \n     2013-07-25 16:14 |    \t\t小杨 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:4        | 。)\t\t \n  膜拜啊，大神！    \n     2013-07-28 12:55 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  玩终端，吊炸了，膜拜    \n     2014-04-14 09:07 |    \t\t小贱人 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 资深菜鸟，)\t\t \n  mark    \n     2015-04-25 00:05 |    \t\t昌维 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | QQ：867597730，百度贴吧ID：昌维001)\t\t \n  以前我在建设银行的多媒体取款机里面一直往左下角猛按，结果把开始菜单按出来了，发现用的还是win2000专业版，然后就可以打开我的电脑和cmd，然后，，，，，，    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}