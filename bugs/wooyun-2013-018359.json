{"id": 13866, "wybug_id": "wooyun-2013-018359", "wybug_title": "买卖宝存储型xss两枚，成功盲打后台", "wybug_corp": "无锡买卖宝信息技术有限公司", "wybug_author": "xfkxfk", "wybug_date": "2013-02-04 17:08", "wybug_open_date": "2013-03-21 17:09", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型", "敏感信息泄露", "利用技巧", "盲打后台"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-02-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-02-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-03-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-21：\t细节向公众公开  简要描述： 买卖宝存储型xss两枚，成功盲打后台，劫持的cookie中尽然有用户名密码信息。。。 详细说明：  1、第一处xss在用户的收获地址处，详细地址为任何过滤，导致xss。\n\n\n\n2、第二处在用户反馈处，反馈内容为做任何过滤，导致xss。\n\n3、买卖宝的反馈处理还是很及时的，刚提交反馈信息，一会就有反映了。。。\n\n4、从cookie信息中可以截取到买卖宝的后台地址：\nhttp://admin.ebinf.com/adult-admin/login.do\n\n\n5、从上图的cookie信息中可以看出，尽然包含用户名和密码信息：\n反馈处理的用户名：zhongxiaomei，zhuyan3后台管理的用户名：wangchao3\n但是没能拿cookie登陆进去，不过，要登录后台也不难，这里已经有了用户名，而且后台登陆没有验证码的，暴力一下很easy就能出来登陆密码的。这里就不做测试了。   漏洞证明：  见详细说明。谢谢。   修复方案：  1、过滤。2、禁止cookie中的敏感信息。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2013-02-05 10:12 厂商回复： 感谢指出。已修正。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-02-04 17:16 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  我打的晚。。。    \n     2013-02-04 17:27 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @小胖胖要减肥 他这个cookie好像不能利用，上了钓鱼，好几天了没钓到，全是后台的cookie，然后就放出来了。。。    \n     2013-02-04 17:36 |    \t\t空城 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:11        | 这个人很懒，什么也没有留下)\t\t \n  我上次发的还没审核    \n     2013-02-04 22:24 |    \t\tMetas \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        )\t\t \n  我擦，我发的比这个早啊！！！！！竟然现在还没审核通过。    \n     2013-02-04 23:57 |    \t\tBlackeagle \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 向WooYun致敬)\t\t \n  这都是一个马甲么    \n     2013-02-05 08:33 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @Metas @空城 嗨，不要提了，我那里面一堆xss都没审核，这个估计人品好，通过了，嘿嘿。。。    \n     2013-02-05 08:43 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @xfkxfk 大牛。不过现在乌云好多东西都不审核……    \n     2013-02-05 09:26 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @wefgod 这是为什么呢？    \n     2013-02-05 09:49 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @xfkxfk 严格把关。莫非只要审核人认为是小洞就不审核？    \n     2013-02-05 11:03 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xfkxfk zhuyan3改密码了？    \n     2013-02-05 11:04 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @小胖胖要减肥 不知道啊，你等不了？肯定改密码了啊，厂商都知道了    \n     2013-02-05 11:06 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  厂商可以说下作者为什么登陆失败么？@买卖宝    \n     2013-02-05 11:07 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xsser 盲打不能登录也给过了?    \n     2013-02-05 11:10 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @小胖胖要减肥 我觉得不能登录是他自己原因 后台可以访问的 不是漏洞原因 ：）    \n     2013-02-05 11:10 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @小胖胖要减肥 @xsser 尝试用cookie登陆了，cookie里面有用户名，但是密码长得不像，也解码过，但是登陆不上，不知道为什么    \n     2013-02-05 11:11 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @xfkxfk 需要厂商来解释啊    \n     2013-02-05 11:12 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @xsser @小胖胖要减肥 而且，这里面没有验证码，有用户名，有类似密码的信息，想登陆还不简单么    \n     2013-02-05 11:13 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xfkxfk @xsser 我也打到了 登录不了撒  TZ=0; u=zhuyan3; ru=1; opau=zhuyan3; opap=c2lvc2lv; rp=0; webfx-tree-cookie-persistence=wfxt-4 wfxt-61 wfxt-12 wfxt-16 感觉密码时opap 直接cookies不行 使用opap也不行 我也奇怪     \n     2013-02-05 11:14 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @xsser 嗯，我想知道是为什么不能用cookie，密码是什么编码的    \n     2013-02-05 11:14 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xfkxfk 真不简单啊，要爆破别人一个复杂密码就没戏了 弱口令看运气的    \n     2013-02-05 11:17 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @小胖胖要减肥 这只是时间问题。opap=c2lvc2lv这个肯定是密码或者经过加密或者编码的密码，我试过解码，但是都登陆不了，等厂商解释吧    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}