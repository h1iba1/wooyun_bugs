{"id": 16514, "wybug_id": "wooyun-2012-012511", "wybug_title": "Dr.com校园无线热点数据库弱口令，学生帐号信息密码全部泄露", "wybug_corp": "Dr.com", "wybug_author": "Docee", "wybug_date": "2012-09-21 13:18", "wybug_open_date": "2012-11-05 13:19", "wybug_type": "基础设施弱口令", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-21：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-11-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 数据库弱口令，可获取数据库中所有上网账号及密码。 详细说明：  因为CMCC账号到期，并且万恶的学校每天11点后会断网，所以就对校园无线网的登陆站点和用户个人管理页面进行了扫描，结果发现在用户个人管理界面下存在一个Proxool，目录位置为admin。\n\n从上图可以看出，使用的是Oracle数据库，以及数据库地址，和......数据库用户名。于是就用drcom密码试了一下....撒花！！进了！\n\n查了一下用户表，所有的信息都出来了，姓名，电话号码等，密码是加密过的，只是对ASCII进行了加减，所以解出来不难。研究了一下发现是这样加密的：每个字符加密后ASCII都是在32-126之间，从第一位开始加28，第二位加28+29，第三位加28+29+30，如果超过126的部分，则返回32开始，每个加密后的密码尾巴都会加a,如果你看到的加密后的密码是a，那就空密码了。试了一下登陆账号，拿南方学院的账号测试看看，用户名是nanfang,加密后的密码是Mk*Ga,也就是1234\n\n进了！到此为止！---------------------------------------------------------------以上演示的数据库和个人管理登陆界面并不是我们学校的，是通过百度找到的（大部分学校都只开放了内网地址，百度能找到的只有几个）如果你们学校存在以下登陆界面，那么恭喜你，尽情的上网吧。PS：查了一下，这个学校是南京林业大学\n\n在Dr.com的网站里，他们的合作案例中有南京林业大学，相信其他的大学也有此漏洞，至少我们学校有。呵呵。\n\n   漏洞证明：  南京林业大学：http://121.248.150.36数据库连接池：http://121.248.150.36/admin个人用户账号：nanfang 密码:1234Oracle数据库：121.248.150.36密码和账号都是drcom   修复方案：  还能怎么样，修改密码咯。   版权声明：转载请注明来源 Docee@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-10-25 10:49 |    \t\t167怪兽 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        | 167怪兽)\t\t \n  //?啥时候公布？？    \n     2012-10-25 12:51 |    \t\tDocee \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 屌丝)\t\t \n  @167怪兽 貌似厂家没认领！！    \n     2012-10-25 22:51 |    \t\tMatt  \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:107        | 承接代码审计 http://codescan.cn/)\t\t \n  @Docee  球私信细节     \n     2012-10-26 09:27 |    \t\tDocee \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 屌丝)\t\t \n  @Matt 无非就是弱口令而已。。。难道你们学校用这个？    \n     2012-10-26 14:56 |    \t\tMatt  \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:107        | 承接代码审计 http://codescan.cn/)\t\t \n  @Docee 恩 是的，球弱口令    \n     2012-10-26 16:30 |    \t\tDocee \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 屌丝)\t\t \n  @Matt 私心给我你学校的无线网络登录地址。。。    \n     2012-10-26 18:17 |    \t\tMatt  \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:107        | 承接代码审计 http://codescan.cn/)\t\t \n  @Docee 内网。。。    \n     2012-10-26 18:22 |    \t\t167怪兽 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        | 167怪兽)\t\t \n  我学校就是这个啊  不是三十天公布么??    \n     2012-10-26 18:24 |    \t\t167怪兽 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        | 167怪兽)\t\t \n  求私信细节啊！！1    \n     2012-10-29 09:36 |    \t\tEnjoy_Hacking \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:8        | 时间无言，如此这般。)\t\t \n  赶紧忽略吧亲！！！！！！！    \n     2012-10-29 11:29 |    \t\tDocee \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 屌丝)\t\t \n  @xsser 这个是要忽略还是转交第三方？虽然这个洞没啥技术含量，但是放出来可能会造成一些学校的上网账号被盗用。    \n     2012-10-30 21:30 |    \t\t167怪兽 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        | 167怪兽)\t\t \n  算了 你给我洞洞吧！    \n     2012-11-05 13:27 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  这个洞好猛！    \n     2012-11-05 14:51 |    \t\tMetasploit \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:7        | http://www.metasploit.cn/)\t\t \n  额 又没妹纸QQ    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}