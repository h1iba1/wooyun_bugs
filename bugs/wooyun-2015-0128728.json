{"id": 26411, "wybug_id": "wooyun-2015-0128728", "wybug_title": "商旅安全之金色世纪商旅网设计缺陷导致任意账户密码重置（土豪账户演示）", "wybug_corp": "金色世纪", "wybug_author": "路人甲", "wybug_date": "2015-07-23 23:59", "wybug_open_date": "2015-09-10 20:26", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-10：\t细节向公众公开  简要描述： 1998年创立至今，北京金色世纪商旅网络科技股份有限公司积累了丰富的商旅服务专业经验，创建了\"D2D\" 商旅全程管家服务的全新模式。截止到2014年底，金色世纪拥有36家分支机构、1200名员工、23个机场&高铁金色逸站，向超过200万会员提供\"D2D商旅全程管家服务\"。未来3—5年，机场&高铁金色逸站将达到50个，基本覆盖省会及其它重点城市。 详细说明：  漏洞地址：\nhttp://member.jsj.com.cn/findpwd?type=1\n1、输入目标账户，直接更改返回包为正常响应包跳到第三步，跳过验证码验证环节\n\n正常响应包如下：\nHTTP/1.1 200 OKServer: nginx/1.6.0Date: Thu, 23 Jul 2015 09:41:15 GMTContent-Type: text/htmlConnection: keep-aliveExpires: Thu, 19 Nov 1981 08:52:00 GMTCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0Pragma: no-cacheSet-Cookie: MobileCard=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMTSet-Cookie: MobileCardJSJID=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMTContent-Length: 5851<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\" ><head>    <title>è®¾ç½®æ°å¯ç </title>    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=Edge\" />    <link href=\"http://file.jsj.com.cn/css/member/header_footer.css\" rel=\"stylesheet\" type=\"text/css\" media=\"all\">    <link href=\"http://file.jsj.com.cn/css/member/login.css\" rel=\"stylesheet\" type=\"text/css\" media=\"all\">    <link href=\"http://file.jsj.com.cn/css/public/public.css\" rel=\"stylesheet\" type=\"text/css\" media=\"all\">    <link rel=\"shortcut icon\" href=\"http://file.jsj.com.cn/images/public/favicon.ico\" type=\"image/x-icon\"/>    <script type=\"text/javascript\" src='http://file.jsj.com.cn/js/member/login.js'></script>    <script type=\"text/javascript\" src='http://file.jsj.com.cn/js//jquery.js'></script>    <script type=\"text/javascript\" src='http://file.jsj.com.cn/js//jsj.js'></script>    <script type=\"text/javascript\" src='http://file.jsj.com.cn/js/member/member.findpwd2.js'></script> </head><body>    <div class=\"top_bg\">        <div class=\"top\">            <a href=\"http://www.jsj.com.cn/\"><div class=\"logo\"></div></a>        </div>    </div> <div class=\"findpwd_box\">\t<div class=\"mt\">\t\t<h2>è®¾ç½®æ°å¯ç </h2>\t\t<b></b>\t</div>\t<div class=\"mc\">\t\t<div class=\"step\">\t\t\t<ul class=\"reg_step\">\t\t\t\t<li class=\"current\"><span></span>éªè¯èº«ä»½</li>\t\t\t\t<li class=\"current\"><span></span>è®¾ç½®æ°å¯ç </li>\t\t\t\t<li><span></span>å®æ</li>\t\t\t</ul>\t\t</div>\t\t<div class=\"form\">\t\t\t<form action='/index/findpwd3' method='post'>\t\t\t\t<div class=\"item\"><span class=\"label\">æ°ç»å½å¯ç ï¼</span><div class=\"left\"><input id='newpwd1' type=\"password\" name=\"newpwd1\" /><span class=\"clr\"></span><label class=\"msg-error\"></label></div></div>\t\t\t\t<div class=\"item\"><span class=\"label\">ç¡®è®¤æ°å¯ç ï¼</span><div class=\"left\"><input id='newpwd2' type=\"password\" name=\"newpwd2\" /><span class=\"clr\"></span><label class=\"msg-error\"></label></div></div>\t\t\t\t<div class=\"item\"><span class=\"label\">&nbsp;</span><div class=\"left user_form\"><a name=\"next\" class=\"btnstep\">æäº¤</a></div></div>\t\t\t</form>\t\t</div>\t</div></div><div class=\"ft\">\t<div class=\"foot\">        <div class=\"footer_con\">\t\t<div class=\"contant\">\t\t\t<ul>\t\t\t  <li><a href=\"http://www.jsj.com.cn/BottomLink/about_intro.aspx\">å³äºæä»¬</a><u>|</u></li>\t\t\t  <!--<li><a href=\"http://www.jsj.com.cn/BottomLink/D2D/index.html\"> D2Dæå¡</a><u>|</u></li>-->\t\t\t  <li><a href=\"http://www.jsj.com.cn/sitemap.aspx\"> ç½ç«å°å¾</a><u>|</u></li>              <!--<li><a href=\"http://gc.jsj.com.cn/bscrm/ebooking/login.aspx\">éåºç»å½</a><u>|</u></li>-->\t\t\t  <li><a href=\"http://www.jsj.com.cn/BottomLink/dfdl.aspx\">ä»£çä¸­å¿</a><u>|</u></li>\t\t\t  <li><a href=\"http://www.jsj.com.cn/BottomLink/job.aspx\">æèä¿¡æ¯</a><u>|</u></li>\t\t\t  <li><a href=\"http://www.jsj.com.cn/Card/index.html\">VIPæå¡</a><u>|</u></li>\t\t\t  <li><a href=\"http://www.jsj.com.cn/BottomLink/about_department.aspx\">èç³»æä»¬</a><u>|</u></li>\t\t\t  <li><a href=\"http://www.jsj.com.cn/BottomLink/flink.aspx\">åæé¾æ¥</a></li>\t\t\t  <!--<li><a href=\"http://forum.jsj.com.cn/\">ä¼åè®ºå</a></li>-->\t\t\t</ul>\t\t</div>\t\t<div class=\"contant_t\">            <p>ICPå¤12022924å· äº¬å¬ç½å®å¤110105017926å· å¢å¼çµä¿¡ä¸å¡ç»è¥è®¸å¯è¯B2-20060235å·</p>\t\t    <p>Copyright 1998-2015 jsj.com.cn All Rights Reserved. åäº¬éè²ä¸çºªåæç½ç»ç§æè¡ä»½æéå¬å¸çæææ</p>            <p>éè²ä¸çºªåæç½æä¾å½éèªç­æ¥è¯¢ï¼å½éæºç¥¨é¢è®¢ï¼å½éèªç­æ¥è¯¢æ¶å»è¡¨ï¼å½éæºç¥¨ä»·æ ¼æ¥è¯¢ï¼è¿æå½éèªç­æè¿è¡æè§å®ä¿¡æ¯ï¼å½éèªç­å®æ¶æ¥è¯¢æå¡ä¾æ¨éã</p>\t    </div>\t\t<!-- <div class=\"bottom_jp\">\t\t\t\t\t<ul>\t\t\t\t\t\t</ul>\t\t</div> -->        <div class=\"contant_img\" align=center><a href=\"http://www.jsj.com.cn/promotion/cata-zs/index.htm\" target=_blank><img src=\"http://file.jsj.com.cn/images/public/ico_footer_img01.gif\" style=\"padding-right:5px;\" /></a><a href=\"http://www.itrust.org.cn/yz/pjwx.asp?wm=2582501947\" target=_blank><img src=\"http://file.jsj.com.cn/images/public/ico_footer_img02.gif\" style=\"padding-right:5px;\"/></a><a href=\"https://search.szfw.org/cert/l/CX20120801001603001683\" target=_blank><img src=\"http://file.jsj.com.cn/images/public/ico_footer_img03.gif\" style=\"padding-right:5px;\" /></a><a href=\"http://www.anquan.org/s/www.jsj.com.cn\" target=_blank><img src=\"http://file.jsj.com.cn/images/public/ico_footer_img04.gif\" /></a></div>\t\t        </div>    </div> </div>\t<!-- TQ kefu --><script language=\"JavaScript\" src=http://float2006.tq.cn/floatcard?adminid=9556114&sort=0></script><!-- google tongji --><script type=\"text/javascript\">    var _gaq = _gaq || [];    _gaq.push(['_setAccount', 'UA-21387771-1']);    _gaq.push(['_setDomainName', 'jsj.com.cn']);    _gaq.push(['_trackPageview']);    _gaq.push(['_trackPageLoadTime']);    (function () {        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);    })();</script><!-- baidu tongji --><script type=\"text/javascript\">    var _bdhmProtocol = ((\"https:\" == document.location.protocol) ? \" https://\" : \" http://\");    document.write(unescape(\"%3Cscript src='\" + _bdhmProtocol + \"hm.baidu.com/h.js%3Ff73a1947fcd9c6158387fc848ecf4b5a' type='text/javascript'%3E%3C/script%3E\"));</script></body></html>\n2、输入新密码wooyun123,提交直接跳转到登陆状态\n\n   漏洞证明：  土豪账号：13333333333，密码：wooyun123：\n\n   修复方案：  1、加强服务器验证逻辑，防止顺序执行绕过2、在最后提交时加入身份验证同步信息   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-07-27 20:24 厂商回复： CNVD确认所述漏洞情况，暂未建立与网站管理单位的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}