{"id": 72940, "wybug_id": "wooyun-2015-0158615", "wybug_title": "看我如何控制广东部分电信宽带账户敏感信息（订单与个人信息等）", "wybug_corp": "中国电信", "wybug_author": "Looke", "wybug_date": "2015-12-07 13:22", "wybug_open_date": "2016-01-23 15:16", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-23：\t细节向公众公开  简要描述： RT 详细说明：  无意间找到了翻了翻电信的系统，找到今天的主角系统：广东电信宽带网络分销平台\n**.**.**.**\n怕是假冒系统，看下备案信息，的确是广东省的。\n\n0x01:好奇探索之路：看看有没有注入，登陆有动态验证码，看来是我想多了。突然看到了重置密码，那就试试。用账户名admin试试\n\n先获取验证码，然后随便输入了个验证码，提交，看了看返回包，习惯性的把false修改为true,咦，还真通过了验证，不过不到最后一步怎么能算成功呢\n\n3、输入新的密码，wooyun123,提交，内心无比激动，成功了吗？\n\n4、这种类型的密码重置，出现在广东电信的身上，我表示震惊了下，成功了\n\n5、抑制住刚一秒小激动，最后还是得登陆下，成功了吗？\n\n超级管理员权限，不错不错。0x02:步步深入之循序渐近：1、任意添加和修改全省宽带套餐，大广东的套餐就是便宜\n\n2、佣金审核，你交钱了吗？不用，这么客气，我来帮你过。\n\n3、任意操作客服账号，添加，删除，修改，不知道哪个是我心中的美女。\n\n4、任意操作短信模块\n\n5、短信接口配置信息泄漏\n\n6、下发短信一览无遗\n\n7、任意操作商户信息，修改、删除、重置其密码、冻结其账号。\n\n\n\n8、再往下翻，终于找到全省安装宽带信息，可任意查询和修改\n\n近10W全省各地户宽带安装订单信息，包括用户名、身份证号码、手机号码、宽带产品名称、宽带接入账号、银行卡号、多媒体账号、CRM号、身份证证件照。\n\n\n\n\n\n可任意操作客户订单：包括修改接入账号、修改CRM账号、修改多媒体账号等等\n\n\n\n广东电信同胞，你能不能上网，我说了算，嘿嘿   漏洞证明：  0x03、冰火交加之高潮迭起1、SQL注入翻完了功能，看下有没有注入，找了半天没找到，最后终于找到一个。\nPOST /yh/distributor/distributorSelectOfJunior.do?selected=226&pselected=3&typeId=97&zxsl=zxsl HTTP/1.1Host: **.**.**.**Proxy-Connection: keep-aliveContent-Length: 143Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://**.**.**.**Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://**.**.**.**/yh/distributor/distributorSelectOfJunior.do?selected=226&pselected=3&typeId=97&zxsl=zxslAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=5094098D23FCC8F801105EF52EE4FD21; JSESSIONID=843779D95ADCC524082D7EB8F9E220E5; Hm_lvt_b7d25053179bdfd2acea09e4b5b1f41a=1449254825; Hm_lpvt_b7d25053179bdfd2acea09e4b5b1f41a=1449293418disType=&typeAttribute=&city=&area=&orderId=&conditions=&conditionsValue=%E5%8F%B6%E5%81%A5%E8%8B%B1*&totalPage=2536&showNumber=10&currentPage=1\nconditionsValue参数存在注入\n\n\n\n2、秒变千万富豪不是梦再次翻看了菜单功能，发现还有一个功能，佣金提现，只是管理员的余额为0.于是兴起重置了提现账号记录的一个账号：ZQ000453 该账户余额90登入账号，开始提额，发现有提现密码\n\n于是乎试下重置提现密码，如出一撤，和重置密码过程一样。于是乎拿到了提现密码。又开始提现0.1元，这次提现是成功了，只是提到该账户绑定的银行卡里去了。\n\n那我能不能提现到我的银行卡账号呢于是来到个从信息修改处，修改成我的信息，发现有手机验证码，怎么办呢？绕不过去，突然想起来在上面admin账号中可能查看所有下发手机验证码信息，登陆看看，果然，得到了下发的验证码。修改账户信息成功。再次提现，还是发现不对，绑定的银行只能是广东省的银行卡，在开户地点处必须是广东省银行卡。但我没有广东的银行卡，怎么办呢再次翻了翻了管理员账户，发现其个人信息绑定了银行卡，有了，那我把钱转到管理员的银行账号总可以了吧。\n\n\n\n重置完提现密码，修改完绑定账户信息，开始提现0.1元，最终提现成功。\n\n也就是说，只要我去开一张广东省的银行卡，我就可以变千万富豪了，想想都有些小激动呢？哎，小子，醒醒，该交漏洞了。   修复方案：  @@   版权声明：转载请注明来源 Looke@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-12-10 17:54 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国电信集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-07 13:24 |    \t\t成长之路 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | **)\t\t \n  前排出售爆米花、汽水、花生    \n     2015-12-07 13:29 |    \t\tHackshy \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:23        | 猪猪侠爱吃棒棒糖)\t\t \n  。。。二楼，这个要看看、    \n     2015-12-07 13:31 |    \t\tMieless \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:10        | 我是来打酱油的。)\t\t \n  也许很简单    \n     2015-12-07 14:02 |    \t\t第四维度 \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:42        | 本人学识渊博，经验丰富，代码风骚，效率恐...)\t\t \n  这个标题好熟悉    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}