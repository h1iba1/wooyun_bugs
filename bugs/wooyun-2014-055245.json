{"id": 4223, "wybug_id": "wooyun-2014-055245", "wybug_title": "360云盘可以被恶意利用进行DDOS攻击", "wybug_corp": "奇虎360", "wybug_author": "一剑萧寒", "wybug_date": "2014-04-01 19:06", "wybug_open_date": "2014-05-16 19:06", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感接口缺乏校验", "设计不当", "认证设计不合理", "设计错误", "搞笑有爱"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-16：\t细节向公众公开  简要描述： 360云盘可以被恶意利用进行DDOS攻击。 详细说明：  本人才疏学浅，对DDOS了解不是很深，所以有说错的地方还请大家指出...灵感来源于利用Google爬虫DDoS攻击，详情见http://www.freebuf.com/articles/web/28273.html由于360云盘未进行离线下载次数的限制，用户可以利用其流量下载一些网站的大文件，对其造成DDOS攻击。以我们老师的某台服务器做个试验：\n\n不是什么大型服务器，网络一般般了。在网站上上传了一个7.5M的文件作为测试：\n\n打开360云盘离线下载：\n\n这里说明一下，当360云盘下载重复文件时，并不会占用网盘空间，只保留一份，但是它还是会一个一个下载的。至于为什么在文件名后面加一个r=*，根据那篇文章，笔者个人认为可以绕过一些缓存机制。此时burpsuite抓包：\n\nsend to intruder：\n\n\n\n这是攻击前服务器状态：\n\n开始攻击：\n\n由于是老师服务器，暂时攻击30秒看看：\n\n\n\n可能由于服务器网速不是太好，所以出流量不是很大。。。再看看360云盘，直接170线程下载：\n\n   漏洞证明：  这就是传说中的拒绝服务吧。。。\n\n然后我的远程桌面也被卡掉了。。。看看日志，你们的服务器你们应该认识吧。\n\n只是攻击了30s，就已经产生了效果，如果打上几个小时效果就会更加明显了吧。至于这种攻击放大了多少倍大家可以算一算。如果把这些流量打到360的主站，那就是以己之矛，攻己之盾了吧。要是再打到腾讯百度什么的，360就有理也说不清了，说不定爆发一场网络大战？好吧，我想多了。。。   修复方案：  限制离线下载数量，或者当下载量多的时候加个验证码什么的   版权声明：转载请注明来源 一剑萧寒@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-04-02 13:50 厂商回复： 云盘服务端本身是对请求数量有限制的，目前的限制较为宽松，加上作者测试所使用的目标站点网络配置较低所以导致拒绝服务。感谢您的反馈，稍后我们将对限制策略做出调整。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-01 20:46 |    \t\tYHHK \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:5        | love hacker!love technology!)\t\t \n  婶-样    \n     2014-04-02 10:41 |    \t\t一剑萧寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:8        | 岁月无情人愿意，为你闯开新故事...)\t\t \n  求小礼物啊    \n     2014-04-02 13:58 |    \t\t奇虎360(乌云厂商)\t\t \n  @一剑萧寒 欢迎关注360安全应急响应中心月奖励计划！ http://security.360.cn/Index/news/id/30.html    \n     2014-05-16 19:25 |    \t\t灭亡 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:5        | 乌云打杂 偶尔发几个垃圾洞刷存在  qq83133...)\t\t \n  为啥大牛们 提交这么多漏洞    \n     2014-05-16 21:39 |    \t\t浅兮 \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:30        )\t\t \n  好高深啊！    \n     2014-05-16 21:49 |    \t\tAnonymous.L \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:8        | 最后一位关注xxxx的人 , 孤独之人)\t\t \n  无量厂商360    \n     2014-06-15 01:35 |    \t\t晏子 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 无)\t\t \n  @Anonymous.L 我看看还可以啊。对于大型服务器问题应该不大。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}