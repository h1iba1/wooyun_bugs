{"id": 39404, "wybug_id": "wooyun-2015-094120", "wybug_title": "Mallbuilder(多用户商城)储存型XSS盲打后台，内附超详细解说", "wybug_corp": "Mallbuilder", "wybug_author": "路人甲", "wybug_date": "2015-01-30 17:11", "wybug_open_date": "2015-04-30 18:48", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "黑盒测试技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-30：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-04-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 你可以看不惯我装逼，但不可以阻止我装逼 by:helen 详细说明：   WooYun: Mallbuilder(多用户商城)验证缺陷导致可查看+修改他人收货地址+一个存储型XSS（demo测试成功） 看到大牛的洞，我也来几发吧这里首先说明一下，大牛发的洞中是有些问题的（不是漏洞的问题而是地址的问题），问题在于官方首先来看大牛的洞说到：官方demo地址：http://democn.mall-builder.com/嗯好吧我测试也来到这个页面，因为这套cms是收费的，所以不提供下载，也搞不到源码，所以只能是demo演示，但是这里就出问题了我先来到官方demo地址：http://democn.mall-builder.com/，然后注册个用户bklm2并登陆\n\n接下来来到修改个人资料的地方，插入3处XSS：\"/><svg onload=alert(/1/)>\n\n然后可以看到提示成功保存\n\n返回后成功弹窗3次\n\n好了那么问题来了，是不是self-xss呢？额我怎么知道是不是，去后台查看才知道啊。。但是大牛的洞中并没有提到后台地址，接下来只能靠自己了，看到二级域名问democn，去掉后应该就是官网了吧，先去官网看看应该会有后台访问：http://mall-builder.com/果然到了官网\n\n然后在产品演示那里会有前台和后台：http://mall-builder.com/demo.html\n\n点击来到后台后需要用户名和密码的，那个需要关注官方微信才给发的，我不知道后台用户名和密码，只能猜了，用户名admin密码admin成功进入~\n\n但是来到后台以后查看会员发现是没有我注册的那个用户的，不管怎么找都找不到\n\n\n\n这时候我就郁闷了，然后注意到了地址：http://cn.mall-builder.com/admin/main.php我刚才的前台demo是：http://democn.mall-builder.com后台和前台的二级域都不一样，难道还有后台？或者说大牛提供的前台demo地址不对？先不管这个了，返回官网，看看前台演示地址不就知道了返回官网查看后确实前台演示地址为：http://democn.mall-builder.com\n\n那我就郁闷了，怎么回事呢不管了，分析url来找后台吧：注意官网提供的后台目录为：admin/main.php，那么构造：http://democn.mall-builder.com/admin/main.php访问后确实来到了democn.mall-builder.com的后台地址，但是用户名和密码试了好多都不对，估计是改了的\n\n那怎么办呢，只能返回http://cn.mall-builder.com/admin/main.php测试了，我去掉http://cn.mall-builder.com/admin/main.php后面的admin/main.php直接访问：http://cn.mall-builder.com成功来到前台地址\n\n原来这还有个前台啊。。找到了就好办了，注册个账号测试吧~来到注册页面后，我注册个bklm1的账号，但是这里又出问题了，注册的时候和之前那个不一样，这里有个验证问题，是为空的，输入的话只能乱猜，根本不可能猜对。\n\n到了这里也就基本明白官方的用意了：故意提供两个后台地址和前台地址，分开来，第一个能进前台不能进后台，第二个能进后台不能进前台，不让别人测试这套系统但是这能难倒我吗？能吗？好吧确实难倒我了。。不过过了不久机制的我便想到了机制的方法：审查元素。。再次来到页面，你不是不让我注册吗？就是因为有个验证问题而已，我把你去掉不就OK了。。其实也就是想想，以为服务端会有验证机制的，但是没想到真的成功了= =\n\n\n\n\n\n既然注册成功了那就开始测试吧~和之前一样插入3处XSS：\"/><svg onload=alert(/1/)>\n\n提示操作成功\n\n返回后查看成功弹窗3次\n\n来到后台后查看成功弹窗~而且不知道为啥是弹了5次的哦~\n\n我擦写这个洞将近2小时。。够详细的吧。。奖金不给高点好意思吗你。。   漏洞证明：  \n\n   修复方案：  过滤关键字，加强验证机制   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}