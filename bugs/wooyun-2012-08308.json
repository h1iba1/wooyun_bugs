{"id": 18748, "wybug_id": "wooyun-2012-08308", "wybug_title": "360极速安全浏览器存在设计缺陷可导致一序列安全问题", "wybug_corp": "奇虎360", "wybug_author": "唐尸三摆手", "wybug_date": "2012-06-14 19:02", "wybug_open_date": "2012-07-29 19:03", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-08-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-29：\t细节向公众公开  简要描述： 看到微博上有人说ext.chrome.360.cn存在安全问题，事实上360存在更大的问题，只需要任意一个xss漏洞即可实现完全控制360安全浏览器，包括跨域获取其他网站的数据（譬如gmail），修改绑定的主页，窃取过去的浏览器记录等等，最新版测试通过，希望和上次的钓鱼url一起能给一个大的奖励。 详细说明：  360利用浏览器里每次随机生成的一个securityID来进行权限控制，利用该key可以进行跨域数据请求和读取，修改主页，历史浏览记录读取等特权操作，该securityID控制十分严格，只有在少数的几个域下面才可以被获得，这次ext.chrome.360.cn应该就是在此列，但是其在设计上存在一些缺陷导致任意一个域名都可以实现窃取该securityID为了实现某些功能，hao.360.cn/i/index.html里存有该key，而hao.360.cn/i/index.html里存在着致命的一句\n<body id=\"skin-inner\"><script>document.domain = \"360.cn\";</script><iframe src='http://my.360.cn/iefix.php' style=\"display:none;\" frameborder='0' scrolling='no' id='ifrm-init' name='ifrm-init'></iframe><form action=\"\" id=\"__init_form\" name=\"__init_form\" target=\"ifrm-init\">\n那么利用该问题即可获取securityID   漏洞证明：  请利用一个xss运行如下poc代码：\n<script>document.domain=\"360.cn\";</script><a href=\"javascript:x=window.open('http://hao.360.cn/i/index.html ');x.eval('alert(external.twGetSecurityID(window))');\">x</a>\n即可\n\n   修复方案：  以前好像有个代码执行的？   版权声明：转载请注明来源 唐尸三摆手@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-06-15 15:51 厂商回复： 感谢您对360的支持，我们将很快全面修复此类漏洞！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-14 19:32 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  项!    \n     2012-06-14 21:58 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  洞主，恭喜可以获得按仔一个。    \n     2012-07-07 21:32 |    \t\tHacker7x \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:5        | 学习)\t\t \n  好牛逼的！！！360浏览器安全浏览器不安全呀...    \n     2012-07-07 22:55 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @Hacker7x 要说安全，火狐和谷歌还是相对比较安全的，毕竟360用的还是IE的内核，好多IE有的洞，360都有、、、    \n     2012-07-08 23:21 |    \t\tCzBiX \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | CzBiX)\t\t \n  @px1624 这里说的360极速浏览器用的就是Chrome的那个内核,此漏洞的主要原因是给予了ext.chrome.360.cn域过大的权限导致的    \n     2012-07-09 14:40 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @CzBiX 急速不清楚，那个一般的用的貌似是IE7的    \n     2012-07-16 19:06 |    \t\tLittlePig \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | </html>)\t\t \n  @px1624 急速用的应该是chromium的代码    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}