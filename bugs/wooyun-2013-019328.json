{"id": 65077, "wybug_id": "wooyun-2013-019328", "wybug_title": "爱丽团购删除任意用户信息", "wybug_corp": "aili.com", "wybug_author": "xfkxfk", "wybug_date": "2013-02-28 14:25", "wybug_open_date": "2013-04-14 14:25", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "越权操作", "未授权访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-02-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-03-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-03-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-04-14：\t细节向公众公开  简要描述： 爱丽团购由于为验证用户权限，可删除任意用户地址信息。 详细说明：  \n测试环境：攻击者：xfkxfk受害者：tester\n1、注册并登陆爱丽团购网，添加收货地址。攻击者xfkxfk的两个地址为20644和20643.\n\n2、我们来删除自己的编号为20643的地址信息。\n\n\n\n3、我们抓包然后看到：\n\n\n删除操作的url为：http://tuan.27.cn/account/ajax.php?action=deladd&id=20643\n我们修改这里的id为受害者的地id，这里修改为受害者tester的地址20655。\n\n\nurl为：http://tuan.27.cn/account/ajax.php?action=deladd&id=20655\n   漏洞证明：  5、先看看返回结果：\n{\"error\":0,\"data\":{\"data\":[{\"data\":\"\\u5220\\u9664\\u5730\\u5740\\u6210\\u529f\",\"type\":\"alert\"},{\"data\":null,\"type\":\"refresh\"}],\"type\":\"mix\"}}\n从上面的data我们看到已经成功删除地址了。6、界面上也返回了删除成功：\n\n7、现在来看看受害者tester的20655号地址被我们成功删除了：\n\n但是我们自己的地址20643依然存在：\n\n8、==================================================危害：这里的地址删除操作是GET请求的，那我们可以循环一边这样，按照id就能把所有的用户地址信息删除了，尾号不小，这里我只是自己测试，未作任何操作！   修复方案：  用户值能操作自己的内容，增加用户权限验证   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-02-28 14:31 厂商回复： 根据乌云的漏洞评价对厂商的要求，以后我们都会这样回复！客观性：高完整性：高学习性：高 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-02-28 14:33 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  爱丽网啊，如果白帽子有一些问题 关于漏洞怎么产生之类的 一定记得也分享学习下啊，一定给你好评！    \n     2013-02-28 14:46 |    \t\t爱丽网(乌云厂商)\t\t \n  @xsser 嗯，懂了！ 会的！ 互相促进，互相学习。    \n     2013-02-28 14:50 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @xsser @爱丽网 大家好，才是真的好！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}