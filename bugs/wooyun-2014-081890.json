{"id": 48338, "wybug_id": "wooyun-2014-081890", "wybug_title": "一种猥琐办法结束360主动防御", "wybug_corp": "奇虎360", "wybug_author": "王And木", "wybug_date": "2014-11-04 21:39", "wybug_open_date": "2014-12-30 14:44", "wybug_type": "默认配置不当", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-06：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向公众公开  简要描述： 发现一个很简单的方法就可以结束掉360的主动防御 详细说明：  主要针对3609.7.0.2001。其中有一个文件360FileUnlock.exe，可以用命令行去调用。于是去拦截命令行。\"C:\\Program Files\\360\\360safe\\Utils\\360FileUnlock.exe\" /queryfilelist=\"C:\\DOCUME~1\\ADMINI~1\\LOCALS~1\\Temp\\{E2E433A7-3235-4bcb-BCC3-1C41E5A4D728}.tmp\"得到如上数据。然后我们去看一下这个临时数据[tag]tag=1[filelist]0=C:\\Program Files\\360\\360safe\\deepscan\\ZhuDongFangYu.exe[pathlist]这样可以出现结束的界面了，剩下的可以对其进行模拟点击然后就可以了。已测试可行。   漏洞证明：  \n\n\n\n\n\n   修复方案：  稍微判断下是不是自己的程序就可以把~   版权声明：转载请注明来源 王And木@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-30 14:44 厂商回复： 感谢漏洞作者的反馈。昨天接到报告后，我们验证结果是360主动防御能够拦截此攻击方法。之后经过与漏洞作者交流，得悉测试环境为Win7 X64系统并手工提权了UAC，并且没有开启核晶引擎，从而实现了模拟点击攻击。X86系统无此问题。如果开启核晶引擎或没有手工提权UAC，X64系统上也都是无法攻击成功的，因此忽略漏洞。欢迎继续关注和支持360安全，谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-05 00:30 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  有多猥琐？    \n     2014-11-05 08:19 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  能比老和尚还猥琐？    \n     2014-11-05 09:22 |    \t\tchock \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:15        | 今夜我们都是wooyun人，我们一定要收购长亭)\t\t \n  来来来，发到我们都是猥琐流去，让大家一起猥琐    \n     2014-11-05 09:28 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  →_→ 有多猥琐？    \n     2014-11-05 11:40 |    \t\t无心、 \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:20        | 你不是风儿，我也不是沙，再怎么缠绵也到不...)\t\t \n  什么时候公开啊。。    \n     2014-11-06 16:18 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  原来没公开亚    \n     2014-11-06 20:30 |    \t\t毕月乌 \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:16        | 猜猜我是谁？)\t\t \n  win7我就没见过几个人开UAC的，包括我自己……    \n     2014-11-06 20:36 |    \t\t毕月乌 \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:16        | 猜猜我是谁？)\t\t \n  作为面向小白级用户的桌面安全软件，本就不应该要求用户自己采取正确的安全防护措施，而是尽可能在不安全环境中保护用户的安全。如果每个人都知道如何识别恶意软件，知道正确使用UAC限制程序权限，那还要安全软件做什么？核晶引擎默认不开启，绝大多数win7关闭了UAC，也就是说在实际情况下绝大多数用户是受到威胁的，作为安全厂商难道不应该去解决问题，而不是推卸责任么？    \n     2014-11-07 09:07 |    \t\tby灰客 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:12        )\t\t \n  三百六怎么不说去安全模式也不行呢？    \n     2014-11-09 18:50 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  作为面向小白级用户的桌面安全软件，本就不应该要求用户自己采取正确的安全防护措施，而是尽可能在不安全环境中保护用户的安全。如果每个人都知道如何识别恶意软件，知道正确使用UAC限制程序权限，那还要安全软件做什么？核晶引擎默认不开启，绝大多数win7关闭了UAC，也就是说在实际情况下绝大多数用户是受到威胁的，作为安全厂商难道不应该去解决问题，而不是推卸责任么？    \n     2014-11-15 12:31 |    \t\tBird \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:25        | Stay hungry. Stay foolish.)\t\t \n  @zph 也不能这么说吧- - UAC一般不是开着的么    \n     2014-11-15 18:06 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  @Bird 现在cpu都是x64的，厂商说x86不能攻击的“鸡肋”情况完全不存在。而且现在用户n多都会关uac，包括我，所以360这么回应完全是推卸责任的表现。    \n     2014-11-20 11:40 |    \t\tBird \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:25        | Stay hungry. Stay foolish.)\t\t \n  @zph 呃，你所的也是。    \n     2014-12-31 10:33 |    \t\tidarker \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 爱生活，╮(╯▽╰)╭)\t\t \n  @Bird 我也一直关着UAC （づ￣3￣）づ    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}