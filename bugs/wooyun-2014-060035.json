{"id": 55747, "wybug_id": "wooyun-2014-060035", "wybug_title": "YY直播系统存在安全验证漏洞（可越权操作）", "wybug_corp": "广州多玩", "wybug_author": "菜猿子", "wybug_date": "2014-05-11 20:06", "wybug_open_date": "2014-06-25 20:07", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["越权操作", "未授权访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-25：\t细节向公众公开  简要描述： YY直播系统权限验证出现严重漏洞，涉及用户资金安全。 详细说明：  YY游戏直播，“开通守护”功能使用的是web页面，通过修改发送的数据可以绕过权限验证，为他人开通守护。闲来无事，想帮YY语音加强下安全验证，无意中发现的这个很严重的问题（和钱有关了）。希望YY官方能够尽快修复，保护用户账号内的资金安全，祝YY越(给)办(点)越(奖)好(励)。   漏洞证明：  进入YY语音客户端，打开使用游戏直播的频道（如90001），点击频道右上角的“开通守护”，弹出页面。\n\n简单抓包可知，地址为：\nhttp://live.yy.com/client/guard.php?uid=299042412&guardUid=000000&channelId=36163746&shortChannelId=90001&type=1&sign=sssssssssssssssssssss&t=1399611550&template=yy490\n注：地址中已去掉敏感数据，测试时请通过YY语音客户端自行获取对应链接。使用chrome打开，然后右击审查元素，\n<input type=\"hidden\" name=\"guardUid\" value=\"00000000\">\n，更改value值，选择开通时长，然后点击“立即开通”。如果对应用户账号内Y币余额不足，会出错提示“Y币余额不足！”，同时提示内的Y币余额数值会变化。如果对应用户账号内有足够Y币余额，会弹出付费确认（如果用户设置需要确认），然后提示“已成功开通主播守护者”。\n\n由此可知，此处并没有验证用户的真实身份，可以通过此漏洞为他人开通守护，非正常途径花费对方Y币。最后附上几个测试uid：2843071、134960612、133841207（随便找的，用于观察提示中余额数值出现的变化，测试时请选择520个月，不要真开通了。。。）   修复方案：  加入用户真实身份验证，保护用户资金安全。   版权声明：转载请注明来源 菜猿子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-05-12 11:58 厂商回复： 感谢对于欢聚时代安全工作的支持，我们会尽快安排修复，多谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-16 10:37 |    \t\t菜猿子 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:2        | 一个还没入门的菜鸟程序猿)\t\t \n  @广州多玩，说好的给点小礼物的呢。找BUG也不容易哇    \n     2014-07-24 14:49 |    \t\t佩佩 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:8        | 一个热衷于网络安全的白帽子,具有很强的逻...)\t\t \n  @菜猿子 你提的啊这个bug? ..... 这bug真好.从来不会想到多玩技术还会再value=uid 这块出问题。没后端验证。。 上市公司！！！    \n     2014-07-24 14:50 |    \t\t佩佩 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:8        | 一个热衷于网络安全的白帽子,具有很强的逻...)\t\t \n  @菜猿子 你提的啊这个bug? ..... 这bug真好.从来不会想到多玩技术还会再value=uid 这块出问题。没后端验证。。 上市公司！！！    \n     2014-08-05 17:12 |    \t\t小怿 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:6        | )\t\t \n  @佩佩 上市公司也有逗比技术。。他们大部分只重视功能的实现，大多把安全问题抛之脑后，只有给他们报告了，他们才会去处理。。    \n     2014-12-26 09:20 |    \t\tsaga \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 世界上只有10种人，懂二进制的，和不懂二进...)\t\t \n  YY还有更牛逼的 我会乱说？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}