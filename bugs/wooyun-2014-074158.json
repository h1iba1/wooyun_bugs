{"id": 49350, "wybug_id": "wooyun-2014-074158", "wybug_title": "帕拉迪/华为/江南天安堡垒机高危漏洞泄露用户服务器密码", "wybug_corp": "pldsec.com", "wybug_author": "王小贝", "wybug_date": "2014-08-28 09:42", "wybug_open_date": "2014-11-26 09:44", "wybug_type": "设计不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-01：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-26：\t细节向公众公开  简要描述： 帕拉迪堡垒机产品设计上存在安全漏洞，只要能访问443端口，任意人均可获取堡垒机管辖下服务器的SSH/TELNET/ORACLE账号密码。 详细说明：  漏洞原理有两个：1.堡垒机在记录字符操作时对密码部分未做处理，比如堡垒机远程登录某台SSH，在代填密码时这个密码字符串不应该记录在日志文件中；2.报表的临时数据不应该保存在WEB目录下；   漏洞证明：  上次 WooYun: 帕拉迪/华为/江南天安堡垒机高危漏洞获取所有用户密码 被原厂以老漏洞很早就升级修复了为由忽略了，没有赚到RANK，所以这次只好截图，还是以江苏电信为例，有图有真相：首先下载https://202.102.36.209/module/cmd/realtime_report.xls，打开\n\n电信ORACLE的密码设置这么简单可不符合《中国电信安全配置规范》的基本要求哦再来找找SSH的登录密码：\n\n就这么明目张胆地告诉别人密码，把密码设置得再复杂也没用啊只要有足够耐心，定期来查看此文件，一段时间以后，江苏电信所有服务器的SSH密码、ORACLE密码就都采集到了，危害是不是非常大。   修复方案：  将报表临时数据文件存放在WEB目录以外的目录。   版权声明：转载请注明来源 王小贝@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-08-29 09:02 厂商回复： 事件涉及版本为早期特殊客户定制版本，据帕拉迪排查，除了漏洞发现人做了少量的测试外，并没有出现恶意的攻击事件，用户的信息安全没有受到影响。目前公司已敦促客户升级对应漏洞补丁。该版本对应通用产品未被用于和任何其他公司OEM/ODM合作，此事件说明中涉及的华为/江南天安漏洞信息不实。躺枪！！！你懂的！！！帕拉迪现行的ST系列产品不受乌云近期发布漏洞影响。帕拉迪一贯对信息安全非常重视，针对此事给用户造成的困扰，帕拉迪诚恳致歉。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-28 09:44 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  帕拉迪杀手    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}