{"id": 13929, "wybug_id": "wooyun-2013-020243", "wybug_title": "淘宝店铺自定义模块疑似可调用外部JS", "wybug_corp": "淘宝网", "wybug_author": "偉哥", "wybug_date": "2013-03-18 11:48", "wybug_open_date": "2013-03-18 13:53", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["钓鱼欺诈", "跳转漏洞", "发生点上下文敏感", "上下文敏感淘宝风险"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 具体请看详细说明 详细说明：  一网友发来一个淘宝店铺\nhttp://shop36171919.taobao.com/?spm=a1z10.1.0.36.RJcKkF\n问我怎么做像他那样的弹窗。隐约中，觉得这个弹窗有问题。但我没开过店，不知道这在淘宝是否合法，特发上来向淘宝求证一下！下图是有问题模块，图片标注团购，但打开后仅是一个普通的购买连接，卖家涉嫌欺炸。\n\n   漏洞证明：  经过查看网页源码发现，先是通过框架调用淘宝开放平台的一个自定义页面。\n\n\nhttp://container.api.taobao.com/container?appkey=12314158&seller_nick=%E5%B1%88%E7%B4%A0%E6%B4%811975&envMode=prod&module_width=190&shop_id=36171919\n但打开这个地址后，发现转到\nhttp://uhz001125.chinaw3.com/TuanGou/view/show.do?top_appkey=12314158&top_parameters=aWZyYW1lPTEmdHM9MTM2MzU3Njk5MjE3NyZ2aXNpdG9yX2lkPS0xJnZpc2l0b3Jfbmljaz2CpTAxQUxtSzNRZGI2V21JWXh3SldDYVNvQT09&top_session=&module_width=190&envMode=prod&shop_id=36171919&seller_nick=%E5%B1%88%E7%B4%A0%E6%B4%811975&top_sign=Nr4fWK11orWz7vsfOn9x6g%3D%3D\n经过查询域名信息，貌似不是淘宝的域名。\n\n如果是淘宝的域名，那么：然后在在自定义页面里调用JS脚本，弹出网页，而且弹出的网址是可控的。可以定义成任何地址。\n\n\n\n如果不是淘宝域名，那么危害就不用说了。   修复方案：  由于自己没有店铺可供测试，具体也没有更深入的分析，特发上来向你们求证。   版权声明：转载请注明来源 偉哥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-03-18 13:53 厂商回复： 首先感谢您对淘宝及淘宝上接入的三方资源安全问题的关注。此业务属于淘宝开放平台的一种应用类型：店铺模块类应用，详情参见：http://mdev.taobao.com/卖家可以在营销市场中选择使用由外部开发者开发的店铺模块应用，详情参见: http://yingxiao.taobao.com/该类应用有严格的接入规范和流程，并且淘宝会定期对应用进行web黑盒扫描，对违规的应用会有处罚。详情参见：http://bangpai.taobao.com/group/thread/14277161-265569273.htm?spm=0.0.0.0.BUebg8http://bangpai.taobao.com/group/thread/14277161-265564929.htm?spm=0.0.0.0.bCVgsL\t 针对您提到的由 container.api.taobao.com 跳转到外部，这个是当前淘宝开放平台（open.taobao.com）的正常业务模式，淘宝会对跳转地址进行检查以控制跳转目的。 漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}