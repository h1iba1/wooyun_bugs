{"id": 11434, "wybug_id": "wooyun-2015-0131870", "wybug_title": "淘宝网宝贝页面存储型XSS（需要卖家方发起攻击）", "wybug_corp": "淘宝网", "wybug_author": "wcl17", "wybug_date": "2015-08-05 16:11", "wybug_open_date": "2015-09-20 17:50", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-20：\t细节向公众公开  简要描述： 淘宝卖家可通过编辑宝贝，构造特殊的字符串，造成存储型xss 详细说明：     漏洞证明：     修复方案：  此漏洞是js在读取dom的title属性的时候，对内容没有进行转义就输出到dom中，导致被当作html代码执行，从而新建出来img标签，并且对标签的属性未做严格###白名单###检查，造成了js代码执行。1. js在读取dom中的内容并再次写入dom前，做html代码转义。保证写入的内容为text。2. 对富文本内容做白名单检查，比如只允许a、b、img标签，并且img只允许width、height属性、同时指定width、height的取值范围。Ps:###任何黑名单检查都是纸老虎### 我在构造特殊字符的时候，发现有空格，或者有冒号都会被过滤。。。   版权声明：转载请注明来源 wcl17@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-08-06 17:49 厂商回复： 您好，您之前已在ASRC平台提交了该漏洞，属于一洞多投。按照ASRC漏洞评分标准，原定的高危漏洞奖励取消。感谢您对我们的关注和支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-05 16:13 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @wcl17 洞主可否把具体xss代码补充一下呢，学习学习 :P    \n     2015-08-05 16:20 |    \t\twcl17 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 业余找漏洞的。。。)\t\t \n  @疯狗 话说，我已经报给人家阿里了，没看到说不让上报第三方。。。 怎么能把这个漏洞从乌云下掉啊？ 这样对阿里好不好啊。。。    \n     2015-08-05 17:30 |    \t\twcl17 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 业余找漏洞的。。。)\t\t \n  阿里把奖励给取消了~ 呵呵 真是业界良心啊~~     \n     2015-08-06 17:51 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:544 漏洞数:107        | 低调求发展)\t\t \n  @wcl17 洞主可否把具体xss代码补充一下呢，学习学习 :P    \n     2015-08-06 18:00 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:485 漏洞数:101        | 长期1:7回收WB,手续费协商,个位数到三位数...)\t\t \n  @wcl17 表哥请节哀    \n     2015-08-06 18:00 |    \t\t苏安泽 \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:25        | 敢不敢关注一下，<script>alert('关注成功'...)\t\t \n  一同双投就这样了。    \n     2015-08-06 18:01 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  @wcl17 洞主可否把具体xss代码补充一下呢，学习学习 :P    \n     2015-08-06 18:03 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  @wcl17 按照ASRC漏洞评分标准，原定的高危漏洞奖励取消。感谢您对我们的关注和支持！    \n     2015-08-06 18:12 |    \t\tCh丶0nly \t\t\t( 普通白帽子  |\t\t\t        Rank:205 漏洞数:50        | 专注网络30年。)\t\t \n  @wcl17 这不能怪别人啊   毕竟双投了    \n     2015-08-06 18:36 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  哈哈   淘宝的漏洞奖励应该不错哦~ 有5K？    \n     2015-08-06 18:57 |    \t\tzcy \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:15        )\t\t \n  @乐乐、 2k    \n     2015-08-06 19:18 |    \t\t快樂為主 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 城市的喧嚣淹没了丧家犬的远吠)\t\t \n  好厉害的感觉    \n     2015-08-06 19:23 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @wcl17  干嘛老是想着钱，你要记住中国有句古话“知识是无价的”学那么多难道就被这2k诱惑了吗    \n     2015-08-06 19:55 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  节哀    \n     2015-08-06 20:05 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  30000啊，就没了    \n     2015-08-06 20:25 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  让你一洞多提交啊？    \n     2015-08-06 22:04 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  好牛逼    \n     2015-08-06 23:24 |    \t\t#6c6c6c \t\t\t( 普通白帽子  |\t\t\t        Rank:291 漏洞数:47        | 像一条狗孤独的活着，渴望的活着，绝望的活...)\t\t \n  @夏殇 哪有三万！！！    \n     2015-08-07 08:39 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  @#6c6c6c 那至少也是五位数哒    \n     2015-08-07 09:16 |    \t\t#6c6c6c \t\t\t( 普通白帽子  |\t\t\t        Rank:291 漏洞数:47        | 像一条狗孤独的活着，渴望的活着，绝望的活...)\t\t \n  @夏殇 不可能，你想多了，xss只算高危，如果牛逼的另说。    \n     2015-08-07 09:28 |    \t\txtnnd \t\t\t( 普通白帽子  |\t\t\t        Rank:180 漏洞数:43        )\t\t \n  @夏殇 核心高危210安全币  没额外奖金    \n     2015-08-07 09:55 |    \t\twcl17 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 业余找漏洞的。。。)\t\t \n  统一回复下大家。。。 你们看我上报的漏洞数。。。 我不是圈里的，不了解行规~~ 所以，我是想把漏洞记录在乌云帐号下~ 真不是要一洞多投~~ 望理解~~~ 阿里的做法也对，只怪我不了解规则~ 哈哈     \n     2015-08-18 14:12 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  视频挂掉了。。下次记得上传到优酷:-)    \n     2015-09-20 18:58 |    \t\tRand0m \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 真的有一米八五。。)\t\t \n  视频挂掉了，洞主能不能补下视频的链接啊，谢谢    \n     2015-09-20 20:40 |    \t\tJumbo \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:29        | 猫 - http://www.chinabaiker.com)\t\t \n  @wcl17 视频挂了    \n     2015-09-21 02:07 |    \t\tdslxin \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:11        | 最近很烦躁。。。)\t\t \n  @wcl17 按照ASRC漏洞评分标准，原定的高危漏洞奖励取消。感谢您对我们的关注和支持！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}