{"id": 37799, "wybug_id": "wooyun-2015-098886", "wybug_title": "蘑菇街某业务设计不当导致可以xss+支付金额篡改", "wybug_corp": "蘑菇街", "wybug_author": "小龙", "wybug_date": "2015-03-02 15:24", "wybug_open_date": "2015-04-16 15:26", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-16：\t细节向公众公开  简要描述： 蘑菇街，危害高不高你们自己懂。。。 详细说明：  \nhttp://www.xiaodian.com/pc/download\n下载一个小店首先审核员别紧张，说啥提交小店怎么厂商是蘑菇街。。。看这里：http://news.ename.cn/yumingjiaoyi_20150118_97290_1.html蘑菇街为新项目收购“小店”双拼域名xiaodian.com/.cn联系方式:新浪微博: @小店app 联系邮箱: xiaodian@mogujie.com基本上可以确定是蘑菇街的了。。 蘑菇街安全做的这么好，难免会漏了空子这次这个非常严重首先第一个是http://www.xiaodian.com/h5/im/im?imver=1.2&name=mmmm&show_header=shop#chat/130oicm这里其实也就是联系卖家的地方啦首先你要有两个号反正我有了看图\n\n可以看到这里有个聊天的我们进聊天的然后抓包，得到地址：http://www.xiaodian.com/h5/im/im?imver=1.2&name=mmmm&show_header=shop#chat/130oicmOK我们再看下在客户端里面发个<img src=# onerror=alert(/fuck/)>\n\n\n\n\n\n我弄了一个黄色网站。。。 如果用框架给他弄全屏，被同事，家人看到就- -。。。然后最严重的一点是这里\n\n有个收款功能。。\n\n\n\n\n\n然后得到地址：\n老板买单啦：￥0.20！mmmm向你发起一笔收款请求，点http://www.xiaodian.com/h5/money/detail/16zff9s 进行付款，支持信用卡/储蓄卡，支付宝和微信支付\n我们点付款会出现个验证码：\n验证码：653196。您即将使用尾号7144卡，消费0.20元，商家：蘑菇街【快钱】\n653196 OK，我爆破试试代理burp加上函数\n\n\n\n直接就给我付款了，请求发过去立马付款。。。 坑爹。。。\n\n   漏洞证明：  \nhttp://www.xiaodian.com/pc/download\n下载一个小店首先审核员别紧张，说啥提交小店怎么厂商是蘑菇街。。。看这里：http://news.ename.cn/yumingjiaoyi_20150118_97290_1.html蘑菇街为新项目收购“小店”双拼域名xiaodian.com/.cn联系方式:新浪微博: @小店app 联系邮箱: xiaodian@mogujie.com基本上可以确定是蘑菇街的了。。 蘑菇街安全做的这么好，难免会漏了空子这次这个非常严重首先第一个是http://www.xiaodian.com/h5/im/im?imver=1.2&name=mmmm&show_header=shop#chat/130oicm这里其实也就是联系卖家的地方啦首先你要有两个号反正我有了看图\n\n可以看到这里有个聊天的我们进聊天的然后抓包，得到地址：http://www.xiaodian.com/h5/im/im?imver=1.2&name=mmmm&show_header=shop#chat/130oicmOK我们再看下在客户端里面发个<img src=# onerror=alert(/fuck/)>\n\n\n\n\n\n我弄了一个黄色网站。。。 如果用框架给他弄全屏，被同事，家人看到就- -。。。然后最严重的一点是这里\n\n有个收款功能。。\n\n\n\n\n\n然后得到地址：\n老板买单啦：￥0.20！mmmm向你发起一笔收款请求，点http://www.xiaodian.com/h5/money/detail/16zff9s 进行付款，支持信用卡/储蓄卡，支付宝和微信支付\n我们点付款会出现个验证码：\n验证码：653196。您即将使用尾号7144卡，消费0.20元，商家：蘑菇街【快钱】\n653196 OK，我爆破试试代理burp加上函数\n\n\n\n直接就给我付款了，请求发过去立马付款。。。 坑爹。。。\n\n   修复方案：  1:过滤特殊符号2:加个https或者使用银行他们的自己接口。为嘛非要用自己的3：我测试3分钱没了。。。   版权声明：转载请注明来源 小龙@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-03-03 10:22 厂商回复： 感谢@小龙对蘑菇街安全的关注一、XSS经过确认存在。不过利用成本较高，移动端发送需要在PC端触发。二、收款支付的时候验证码是6位，并且有时间限制，所以目前不存在被爆破的可能。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-10 15:23 |    \t\t七寸往事 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:10        | <script>alert(document.cookie)</script>)\t\t \n  6位数你得爆破多久    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}