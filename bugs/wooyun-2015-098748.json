{"id": 37877, "wybug_id": "wooyun-2015-098748", "wybug_title": "WDCP一处小地方不严谨引发的一系列安全隐患", "wybug_corp": "wdlinux", "wybug_author": "ddy", "wybug_date": "2015-03-02 10:10", "wybug_open_date": "2015-03-07 10:12", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 求打雷求打雷貌似WDCP的用户好多呀，然后某宝上面用wdcp做控制面板开空间的也好多...WDCP一处小地方不严谨，引发成功登录和登录失败的IP均可以被伪造、“登录锁定”这个功能被绕过、登录记录前台无法查看、奇怪的生物混进来以及各种xss 详细说明：  本漏洞是基于 WooYun: WDCP后台的登录IP可被伪造 的再深入挖掘\n系统信息系统名称：WDlinux Control Panel (简称wdCP) (WD订阅)当前版本: wdcp_v2.5.11(20140926) 最新 wdcp_v2.5.11(20140926) 更新日志操作系统：Linux 2.6.18-308.el5\n获取用户ip的时候 使用且仅使X-Forwarded-For的信息详细说明见漏洞证明   漏洞证明：  0x01 WooYun: WDCP后台的登录IP可被伪造 补充说明一下，成功登录和登录失败的IP均可以被伪造0x02伪造了IP之后，绕过了后台“登录锁定”这个功能\n登录锁定\t  密码错误三次将锁定半小时,即半小时内同一个IP不能登录\n\n\n开启“登录锁定”这个功能\n\n输入一个IP，然后登录，当然啦登录时候填写的密码是错误的\n\n\n\n然后密码错误三次将锁定半小时,即半小时内同一个IP不能登录，打不开登录页了别担心，再重复上面一步，改下IP就么么哒满血复活了\n\n\n\n好了，又可以继续登录了\n系统登录日志ID\t用户名\t密码\tIP\t时间\t状态280\tadmin\t********\t1.1.1.3\t2015-02-28 13:52\t失败279\tadmin\t********\t1.1.1.3\t2015-02-28 13:52\t失败278\tadmin\t********\t1.1.1.2\t2015-02-28 13:51\t失败277\tadmin\t********\t1.1.1.2\t2015-02-28 13:51\t失败276\tadmin\t********\t1.1.1.2\t2015-02-28 13:51\t失败275\tadmin\t********\t1.1.1.1\t2015-02-28 13:51\t失败274\tadmin\t********\t1.1.1.1\t2015-02-28 13:51\t失败273\tadmin\t********\t1.1.1.1\t2015-02-28 13:51\t失败\n\n\n0x03轻松隐藏历史登录IP直接显示，即未授权用户可以阻止普通用户、正常用户、管理员查看历史登录IP为了更好地演示，我先刷一遍登录日志，我绝对不是炫耀我IP好看而这样做的！！\n系统登录日志ID\t用户名\t密码\tIP\t时间\t状态329\tadmin\t******\t183.18.1*****8\t2015-02-28 14:11\t成功328\tadmin\t******\t183.18.1*****8\t2015-02-28 14:11\t成功327\tadmin\t******\t183.18.1*****8\t2015-02-28 14:11\t成功326\tadmin\t******\t183.18.1*****8\t2015-02-28 14:11\t成功325\tadmin\t******\t183.18.1*****8\t2015-02-28 14:11\t成功324\tadmin\t******\t183.18.1*****8\t2015-02-28 14:11\t成功323\tadmin\t******\t183.18.1*****8\t2015-02-28 14:11\t成功322\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功321\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功320\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功319\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功318\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功317\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功316\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功315\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功314\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功313\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功312\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功311\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功310\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功309\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功308\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功307\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功306\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功305\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功304\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功303\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功302\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功301\tadmin\t******\t183.18.1*****8\t2015-02-28 14:10\t成功300\tadmin\t******\t183.18.1*****8\t2015-02-28 14:09\t成功注:只显示最近30条记录\n\n\n\n\n在IP填上这样的代码\n<script>alert(1)</sc\n\n\n然后登录，无论成功于否，IP都不见了（尼玛噢，我辛辛苦苦刷得这么好看的IP一下子不见了）\n\n\n\n0x05莫好奇，好奇被雷x好吧 我又刷一次IP，刷满满的然后，在IP里面填入\n<c/onclick=alert()>c\n\n\n然后到前台登录一下（成功失败都记录IP的），我们在后台，查看IP咦，这是什么鬼？怎么长得这么奇特\n\n长得好独特的IP啊，让我们用树枝戳一下它\n\n\n\n雷到了吗。。打雷的吗。。。求打雷啊啊0x06毕竟不是所有人看到奇特的生物都会拿树枝戳一下它，那就最后一个吧，写完我也该洗洗睡了\n<svg/onload=alert()>\n\n\n\n\n还是原来的窗口,还是熟悉的框框\n\n   修复方案：  呃，感觉自己说得有点啰嗦噢，不过这是我第二次研究xss（第一次献给了ip138）\n\n===========据说可以让名字或ID,永久驻留wdcp的手册里求礼物。。。。。===========呃- -感觉修复我不用说了吧。。。。过滤。。。。。关键地方不要使用或者只用 HTTP_X_FORWARDED_FOR中的信息么么哒，快点发布新版本嘛。。好久没更新了。。。。   版权声明：转载请注明来源 ddy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-03-07 10:12 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}