{"id": 1606, "wybug_id": "wooyun-2014-069211", "wybug_title": "利用搜狗拼音输入法放置猥琐后门", "wybug_corp": "搜狗", "wybug_author": "Knight", "wybug_date": "2014-07-21 16:52", "wybug_open_date": "2014-09-04 16:52", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-04：\t细节向公众公开  简要描述： RT 详细说明：  搜狗拼音输入法在调用程序时没有对程序进行校检，导致可执行任意程序。此处以搜狗拼音输入法SogouCloud.exe（一般位于C:\\Program Files\\SogouInput\\一串版本号）为例。用漏洞证明中提供的代码编译的程序在运行后会在原目录生成a.txt，看是否有a.txt便知是否运行。或者随手用任意程序替换皆可，例如用python.exe替换后在输入各种账号密码或者百度谷歌资料时会弹出python.exe的窗口。猥琐之处：将SogouCloud.exe替换成后门后启动项不会有任何异常后门会不定次数、不定时运行，但一般都会在用户输入各种账号密码或者百度谷歌时运行，方便盗号等后门不需24H开启，调用一次运行一次，运行完即可结束ps：搜狗在多次调用替换后的SogouCloud.exe之后会提示一次文件被破坏，忽略即可（或者直接干掉搜狗保护程序，反正直接就能删而且删了也不影响搜狗正常运行）   漏洞证明：  编译以下代码，将程序改名替换掉SogouCloud.exe,当程序运行时就会在目录中生成a.txt。\n#include<fstream>using namespace std;void main(void){ofstream file;file.open(\"a.txt\",ostream::app);file<<\"hack program run\";file.close(); file.clear();}\n   修复方案：  校检   版权声明：转载请注明来源 Knight@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2014-07-26 09:00 厂商回复： 感谢支持，我们正在修复，欢迎到SGSRC提交漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-21 16:53 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  就是自定义输入法的那个dll么，这样的地方多了去了，到处都可以搞    \n     2014-07-21 17:29 |    \t\tJack.Chalres \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:15        | ..............)\t\t \n  MARK    \n     2014-07-21 17:34 |    \t\tKnight \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:10        | 刚刚上洗手间，看到一个玉树临风的少年，气...)\t\t \n  @xsjswt No.    \n     2014-07-22 09:16 |    \t\tv0yager_1ce \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        )\t\t \n  难道是pinyinup.exe    \n     2014-07-26 17:21 |    \t\tKnight \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:10        | 刚刚上洗手间，看到一个玉树临风的少年，气...)\t\t \n  @疯狗 这个算通用不？    \n     2014-08-10 21:01 |    \t\tsec_jtn \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:56        | 本想无耻的刷rank，最后发现是我想太多了。...)\t\t \n  搜狗也有自己的应急平台了    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}