{"id": 8798, "wybug_id": "wooyun-2013-032374", "wybug_title": "DESTOON后台多处SQL注入漏洞", "wybug_corp": "DESTOON", "wybug_author": "xfkxfk", "wybug_date": "2013-07-26 11:44", "wybug_open_date": "2013-10-21 11:45", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核", "注射漏洞利用技巧", "源码分析", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-31：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-09-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-21：\t细节向公众公开  简要描述： DESTOON后台多处SQL注入。 详细说明：  后台的sql注入太多了，如下：\nhttp://localhost/destoon/admin.php?file=admin&action=edit&userid=1\n\nhttp://localhost/destoon/admin.php?moduleid=1&file=admin\n\nhttp://localhost/destoon/admin.php?moduleid=1&file=admin&action=add\n\nhttp://localhost/destoon/admin.php?file=database\n\nhttp://localhost/destoon/admin.php?file=database&action=process\n\nhttp://localhost/destoon/admin.php?rand=92&file=database&action=execute\n\n\n如此处：\nhttp://localhost/destoon/admin.php?rand=92&file=database&action=execute\n\ncase 'execute':\t\tif(!isset($CFG['executesql']) || !$CFG['executesql']) msg('系统禁止了执行SQL，请FTP修改根目录config.inc.php<br/>$CFG[\\'executesql\\'] = \\'0\\'; 修改为 $CFG[\\'executesql\\'] = \\'1\\';');\t\tif($submit) {\t\t\tif(trim($sql) == '') {\t\t\t\tmsg('SQL语句为空');\t\t\t} else {\t\t\t\t$sql = stripslashes($sql);\t\t\t\tif(preg_match(\"/DROP(.*)(TABLE|DATABASE)/i\", $sql)) msg('系统禁止DROP语句');\t\t\t\t\t\t\t\tsql_execute($sql);\t\t\t\tdmsg('执行成功', '?file='.$file.'&action=execute');\t\t\t}\t\t} else {\t\t\tinclude tpl('database_execute');\t\t}\tbreak;\n变量$sql没有任何过滤，就直接sql_execute($sql)了，如图结果：\n\n\n\n后台的注入还有很多，就不一一列举了。虽然是在后台，但是导出都是注入，低级的错误还是很不好的。   漏洞证明：  将详细说明   修复方案：  过滤啊，很多地方都过滤，但是后台就没过滤。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-10-21 11:45 厂商回复：  最新状态： 2013-08-20：感谢提醒，已经修复，详见：http://bbs.destoon.com/thread-53071-1-1.html后台数据已经做了过滤。但是执行SQL语句那块，如果过滤，功能将不可用，用户可以在配置文件里自行决定是否开启。  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}