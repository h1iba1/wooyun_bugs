{"id": 36009, "wybug_id": "wooyun-2015-0102769", "wybug_title": "无忧英语短信接口泄漏", "wybug_corp": "无忧英语", "wybug_author": "路人甲", "wybug_date": "2015-03-23 10:57", "wybug_open_date": "2015-05-09 18:40", "wybug_type": "内部绝密信息泄漏", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-09：\t细节向公众公开  简要描述： 无忧英语短信接口泄漏 详细说明：  \n\n\nclass SendSms{\t//定义是否是dev 如果是dev 则不实际发送短信 上线修改为pub\tvar $_is_dev = 'pub'; //pub\t//报警手机号设置\tvar $_report_phone = '13070127***';\t//定义短信渠道 mw 梦网 ym 亿美 sy 三一\tvar $_set_sms_channel = 'mw,ym,sy';\t//三一恒信用户名配置\tvar $_sy_user_name = 'sy050';\tvar $_sy_password  = '123456';\t\t/**\t\t发送短信\t\t@param string $phone  发送手机号\t\t@param string $msg    发送内容\t\t@param string $type   model_notice/sale_notice/custom_notice/sys_notice/else_notice/admin_notice\t\t@param string 为空 及时发送\t*/\n\n$notice_url = \"http://219.239.91.112/sdkproxy/querybalance.action?cdkey=3SDK-EMY-0130-NBTRS&password=194342\";\t\t$sale_url = \"http://219.239.91.112/sdkproxy/querybalance.action?cdkey=3SDK-EMY-0130-NBTRT&password=198165\";\t\t$sale_alone_url = \"http://219.239.91.112/sdkproxy/querybalance.action?cdkey=3SDK-EMY-0130-JFXNO&password=569244\";\n\nprivate  function _getSmsSelNumMw() {\t\t\t\t$url = 'http://61.145.229.29:9003/MWGate/wmgw.asmx/MongateQueryBalance?userId=J01279&password=515391'; //通知\t\t//$yx_url = 'http://61.145.229.29:9003/MWGate/wmgw.asmx/MongateQueryBalance?userId=F12525&password=819927';//营销\t\t$result = $this->send_get_curl($url);\t\treturn $result;\t}\n\nprivate function _send_msg_by_mw($phone, $msg , $send_time , $type) {\t\t$content = str_replace(\"%20\", \" \", $msg);\t\t$data_string = \"http://61.145.229.29:9003/MWGate/wmgw.asmx/MongateCsSpSendSmsNew?userId=J01279&password=515391\t\" . $phone . \"&pszMsg=\" . urlencode($content) . \"&iMobiCount=1&pszSubPort=*\";\t\tif($this->_is_dev == 'pub') {\t    $result = $this->send_get_curl($data_string);\t\t}else {\t\t\t$result = 0;\t\t}\t\tif(intval($result) == 0) {\t\t\t$this->_send_msg_log($phone, $msg , 1 , $type,'mw');\t\t}else{\t\t\t$this->_send_msg_log($phone, $msg , 0 , $type, 'mw');\t\t}\t}\t/**\t\tymmodel 短信发送\t*/\tprivate function _send_msg_by_ym($phone , $msg , $send_time , $type) {\t\t\t\tif (strpos($msg, \"【51Talk】\") === false) {            $msg = \"【51Talk】\" .'new world';        }        if($this->_is_dev == 'pub') {\t\t\t$result = $this->send_get_curl(\"http://219.239.91.112/sdkproxy/sendsms.action?cdkey=3SDK-EMY-0130-NBTRS&password=194342&phone=$phone&message=$msg\");\t\t}else{\t\t\t$result = 0;\t\t}\t\t$result = 0;\t\tif(intval($result) == 0) {\t\t\treturn $this->_send_msg_log($phone, $msg , 1 , $type,'ym');\t\t}else{\t\t\treturn $this->_send_msg_log($phone, $msg , 0 , $type, 'ym');\t\t}\t}\t\t/**\t\tymmodel 短信发送  营销通道\t*/\tprivate function _send_msg_by_ym_yx($phone , $msg , $send_time , $type) {\t\t\t\tif (strpos($msg, \"【51Talk】\") === false) {            $msg = \"【51Talk】\" . $msg;        }        if($this->_is_dev == 'pub') {\t\t\t$result = $this->send_get_curl(\"http://219.239.91.112/sdkproxy/sendsms.action?cdkey=3SDK-EMY-0130-NBTRT&password=198165&phone=$phone&message=$msg\");\t\t}else{\t\t\t$result = 0;\t\t}\t\t$result = 0;\t\tif(intval($result) == 0) {\t\t\treturn $this->_send_msg_log($phone, $msg , 1 , $type,'ymyx');\t\t}else{\t\t\treturn $this->_send_msg_log($phone, $msg , 0 , $type, 'ymyx');\t\t}\t}\t\t/**\t\tymmodel 短信发送  亿美独享\t*/\tprivate function _send_msg_by_alone_ym($phone , $msg , $send_time , $type) {\t\t\t\t/*if (strpos($msg, \"【51Talk】\") === false) {            $msg = \"【51Talk】\" . $msg;        }*/        if($this->_is_dev == 'pub') {\t\t\t$result = $this->send_get_curl(\"http://219.239.91.112/sdkproxy/sendsms.action?cdkey=3SDK-EMY-0130-JFXNO&password=569244&phone=$phone&message=$msg\");\t\t}else{\t\t\t$result = 0;\t\t}\t\t\t\tif(intval($result) == 0) {\t\t\treturn $this->_send_msg_log($phone, $msg , 1 , $type,'ymal');\t\t}else{\t\t\treturn $this->_send_msg_log($phone, $msg , 0 , $type, 'ymal');\t\t}\t}\n   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-03-25 18:39 厂商回复： 谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-23 11:27 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  无忧英语你们至于吗，我就是测试个短信接口。要不要给我打了三天电话！让我学英语！！！ 啥意思啊你们！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}