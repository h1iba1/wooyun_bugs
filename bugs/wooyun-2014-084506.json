{"id": 42852, "wybug_id": "wooyun-2014-084506", "wybug_title": "天地行设计缺陷", "wybug_corp": "天地行", "wybug_author": "鸟云厂商", "wybug_date": "2014-11-25 12:40", "wybug_open_date": "2015-01-09 12:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "手机短信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-09：\t细节向公众公开  简要描述： 天地行设计缺陷 详细说明：  设计缺陷导致可以爆破用户名密码，无验证码策略。\nPOST /login HTTP/1.1Host: appapi.tdxinfo.comProxy-Connection: keep-aliveContent-Type: application/json; charset=utf-8Content-Length: 67Connection: closeAccept-Language: zh-Hans, en-usUser-Agent: TDX/1.2 CFNetwork/711.1.12 Darwin/14.0.0{\"username\":\"monica\",\"responseDataType\":\"JSON\",\"password\":\"123456\"}\n#1 首先先判断是否存在该用户名，弄了份简易的用户名字典进行爆破。看看返回值存在的返回长度是268：\n{\"errInfo\":\"用户名密码不正确\",\"userKey\":\"546ef5dd45cec70f6b535be0\"}\n\n\n如果不存在则返回的长度是225：\n{\"errInfo\":\"用户名不存在\"}\n\n\n#2 用268的那部分正确用户名进行爆破，弱口令有111111也有123456正确的话就返回一个大约是356-358左右的数据\n\n\n\n   漏洞证明：  随意爆破\n\n   修复方案：  不会又是废弃系统吧天地行：www_tdxinfo_com (主平台)可是直接跳转到这个系统的   版权声明：转载请注明来源 鸟云厂商@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-11-27 15:14 厂商回复： 我们欢迎和鼓励白帽子在不影响系统、破坏系统以及窃取数据的前提下，对我们真旅网旗下各个平台做安全检测。我们将根据漏洞等级/严重程度给予报告漏洞的白帽子发放相应的Rank及礼物。新系统列表(含里面菜单包括的所有模块)：天地行：www_tdxinfo_com (主平台)运营商：op_tdxinfo_com供应商：provider_tdxinfo_comB2G： vipcorp_travelzen_com注：1，请大家对我们列表的站点进行检测，列表外的特别是废弃不用的系统，我们将不再给予礼物发放哦，谢谢谅解！2，漏洞细节严禁包含密码、敏感资料等内容，未做处理的一律给予1分并不发送礼物，请大家注意哦~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}