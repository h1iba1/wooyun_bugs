{"id": 48537, "wybug_id": "wooyun-2014-077757", "wybug_title": "Win64位Ring3下强制结束360（无视主动防御和自我保护）", "wybug_corp": "奇虎360", "wybug_author": "木马游民", "wybug_date": "2014-09-29 13:46", "wybug_open_date": "2014-12-25 13:48", "wybug_type": "拒绝服务", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-29：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-25：\t细节向公众公开  简要描述： 64位下强制结束360杀毒和360卫士进程。无视主动防御和自我保护。 详细说明：  64位下强制结束360杀毒和360卫士进程。无视主动防御和自我保护。之前有个朋友提交过一个64位卸载360的。我这个实现起来的思路和他的不一样。所以还是提交了。我实现的方法是:1.利用360安全防护中心模块做外壳，创建一个傀儡进程。然后傀儡带参数(“ /disablesp 1”)运行360tray.exe文件，这样就会弹出360关闭自我保护的对话框。至于为啥要用360自己的文件做傀儡.是因为带上参数(“ /disablesp 1”)后，直接去运行360tray.exe会被360的进程防护模块会直接拦截掉。而用360自己文件做傀儡就能绕过了\n\n------------------------------------------------------2.当关闭自我保护的对话框成功弹出后，程序后台找图，取得确定按钮的屏幕坐标。然后模拟鼠标单击确定按钮。------------------------------------------------------3.现在360的自我保护已经从有到无了。直接调用系统文件taskkill.exe就能将360所有进程杀掉，包括zhudongfangyu.exe   漏洞证明：  附上demo下载链接:http://pan.baidu.com/s/1o6BgmgUhttp://drops.wooyun.org/wp-content/uploads/2014/09/kill360.zip(解压密码:123)附上演示视频下载链接:http://pan.baidu.com/s/1ntDkjwP（演示视频是我开源的时候录的，大家将就着看。）关于傀儡进程:http://bbs.pediy.com/showthread.php?p=1171054   修复方案：  你们更专业。   版权声明：转载请注明来源 木马游民@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-25 13:48 厂商回复： 360安全卫士的云主防和自我保护对模拟/消息方式操纵安全卫士组件（包括卸载程序）都有完整防护。经我们测试，白帽子报告的相关方法是可以拦截的。在X64操作系统上，360安全卫士的主动防御需要开启“核晶引擎”后才能提供完整防护能力（需要CPU的VT支持）。 此报告同今年4月的报告：http:///bugs/wooyun-2014- 是相同的，白帽子可参考一下。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-29 13:47 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  win100位下，360无法启动    \n     2014-09-29 13:49 |    \t\tchock \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:15        | 今夜我们都是wooyun人，我们一定要收购长亭)\t\t \n  我很想知道，快点告诉我！！！！！！！！！！挖掘机技术到底哪家强    \n     2014-09-29 14:11 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  你好，此漏洞已在360安全应急响应中心提交过。    \n     2014-09-29 14:19 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  @MJ0011    \n     2014-09-29 14:28 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @chock 山东济南找蓝翔！    \n     2014-09-29 14:30 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  蓝翔，威。。。。。。。武    \n     2014-09-29 15:08 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  收藏此类漏洞~    \n     2014-09-29 15:17 |    \t\t小小泥娃 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | 高二)\t\t \n  前排    \n     2014-09-29 15:24 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n   WooYun: 未经用户许可以及自身保护前提下可卸载360安全卫士    \n     2014-09-29 15:38 |    \t\t木马游民 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:8        | I love LSD!)\t\t \n  我不晓得100个64位的360用户中有几个开了屌晶引擎。以后64位上写木马能过扫描就行了，只要一跑起来。分分钟先把你丫卸了、    \n     2014-09-29 15:45 |    \t\tAno_Tom \t\t\t( 普通白帽子  |\t\t\t        Rank:368 漏洞数:40        | Talk is cheap.:)\t\t \n  我只想问一下，挖掘机技术到底哪家强？@奇虎360    \n     2014-09-29 15:54 |    \t\t假马 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:18        | 我存在,你婶婶的脑海里.)\t\t \n  @Ano_Tom 山东济南找刘翔！    \n     2014-09-29 17:21 |    \t\t1c3z \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:29        | 我读书少，你可别骗我！！！)\t\t \n  骗我，根本没有公开！！1    \n     2014-09-29 21:21 |    \t\t木马游民 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:8        | I love LSD!)\t\t \n   WooYun: 绕过360核晶引擎再次强制结束360进程(x64) 再忽略我就无语鸟    \n     2014-09-29 22:40 |    \t\t依恋安静 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 渗透师)\t\t \n  好屌的样子    \n     2014-09-30 13:41 |    \t\tdgdg \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:5        | 乌云币:10000)\t\t \n  @木马游民 哈哈 赤裸裸的打脸    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}