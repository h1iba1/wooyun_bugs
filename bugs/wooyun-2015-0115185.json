{"id": 30978, "wybug_id": "wooyun-2015-0115185", "wybug_title": "上海市通信管理局某系统存在任意文件上传漏洞", "wybug_corp": "上海市通信管理局", "wybug_author": "路人甲", "wybug_date": "2015-05-20 17:43", "wybug_open_date": "2015-07-09 11:02", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向公众公开  简要描述： 任意文件上传漏洞，已入服务器 详细说明：  上海市通信管理局电信业务管理系统地址：http://61.129.53.155\n\n\n\n问题原因出在系统用户的附件上传处要进入附件上传这一步骤，首先你得注册一个帐号，注册帐号需要填入正确的手机或正确的邮箱，来接收密码\n\n\n\n这一处附件上传，可以通过抓包的方式，修改上传文件的后缀，达到上传shell的目的，虽然能成功上传，但你不知道上传后的文件名和访问地址，所以你必须登录该系统。（注意用户名那些数据是否重复）我直接在服务器验证过，新用户抓包上传，jsp文件已躺在服务器上\n\n\n\n拿到密码，进一步登录系统提供一个测试帐号guguji,密码123456\n\n登录系统后在用户信息修改处，可以看到刚才上传附件的下载地址\n\n在用户信息修改处，一样可以进行shell的上传（抓包改文件后缀）   漏洞证明：  shell地址：http://61.129.53.155/7872/Enroll/12799349212265712.jsp密码：xfg\n\n\n\n\n\n因为服务器3389未关所以\ncmd.exe /c net user admin woo0yun@123 /add\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n类似这样包含资产负债等的doc文件有7000+\n\n\n\n   修复方案：  上传点过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-05-25 11:00 厂商回复： CNVD确认所述情况,已经转由CNCERT下发给上海分中心,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}