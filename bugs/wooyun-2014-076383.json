{"id": 1193, "wybug_id": "wooyun-2014-076383", "wybug_title": "乌云众测某处功能存在逻辑漏洞", "wybug_corp": "乌云官方", "wybug_author": "px1624", "wybug_date": "2014-09-23 18:46", "wybug_open_date": "2014-09-23 19:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-23：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 开发工具测试数据的时候，不小心发现的。之前提交了一次，感觉应该是自己写的太简单了，没给审核，就重新发一个详细的。 详细说明：  经过测试，众测提交漏洞的那个功能，只有第一次的时候会验证那个页面的验证码。也就是说，如果抓包后请求的话，第一次验证码为空，会提示验证码错误。 然后第二次就会请求成功，第三次、第四次......以后的提交请求都可以在验证码为空的情况下成功提交表单。然后也测试了一下主站，貌似不存在此问题。   漏洞证明：  \n\n\n这个地址的测试数据麻烦管理给清理下。http://ce.wooyun.org/project/6\n   修复方案：  猜测这里是代码逻辑的问题。比如用于接收验证码的变量是code，验证的时候会和服务器上的code1去对比，然后code=code1的话，验证码就验证成功，然后成功提交表单。如果code和code1不一样的话，会提示错误，然后可能会防止验证码多次使用，应该是验证了一次后，又将code重新给赋值了，比如，验证完一次后执行代码 code1=\"\";这样就会导致第二次验证的时候，输入了空验证码code=\"\";刚好服务器上的是code1=\"\";然后code=code1 然后就验证成功了，成功的绕过验证码验证机制。当然以上只是个人猜测的代码逻辑，至于具体产生此问题的原因，还希望厂商在确认验证后，能给出详细的解答。谢谢~   版权声明：转载请注明来源 px1624@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2014-09-23 18:47 厂商回复： 感谢您的提交，所有漏洞会由乌云众测管理员进行严格审核，目前已经新加一层漏洞审核机制，反复提交无用数据，该用户会被残暴管理员处理掉。由于漏洞提交机制目前还是依靠白帽子们自觉，根据目前业务运行的实际情况看，该问题对实际业务影响不大，故评低。 最新状态： 2014-09-23：漏洞已经修复  ", "replys": "漏洞评价：\n评论\n     2014-09-23 19:48 |    \t\t安然意境 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:79        | 无论是你的事业还是你的个人，可能走的过程...)\t\t \n  该用户会被残暴管理员处理掉    \n     2014-09-23 20:41 |    \t\t黑色的屌丝 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:5        | →_→→_→)\t\t \n  此处暴露了@xsser 的残暴本性    \n     2014-09-23 21:12 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  。。。我去，一个礼拜了，终于给通过了    \n     2014-09-23 21:33 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @黑色的屌丝 @安然意境 以后还是不提交乌云的了，审核太慢了。。。这个主要的利用价值是可以自动化了    \n     2014-09-24 06:00 |    \t\tMurk Emissary \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:14        | 低调做人 低调行事)\t\t \n  该用户会被残暴管理员处理掉    \n     2014-09-24 09:40 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  ＠乌云官方  话说这个问题产生的原因是啥啊？    \n     2014-09-29 09:54 |    \t\tnzk1912 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:10        | 软件开发8年了，也来挖挖漏洞，为创建安全...)\t\t \n  “反复提交无用数据”---- 其实提交人一般来讲，都是发现了什么，可能没有表达清楚~~“该用户会被残暴管理员处理掉” ======怕怕啊~咋处理啊？不会把我的帐封了吧~偶灰常珍惜它的啊~    \n     2014-09-29 10:26 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @nzk1912 表达的是很清楚了，就是这个验证码的验证可以被绕过，其实这个最大的利用价值是可以写自动化脚本了。。。    \n     2014-09-29 10:38 |    \t\tnzk1912 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:10        | 软件开发8年了，也来挖挖漏洞，为创建安全...)\t\t \n  @px1624 悄悄问下，我如何能升级为实习白帽子啊？又何时能升级为普通白帽子啊，核心估计没戏了~可是一直路人不太爽啊~    \n     2014-09-29 12:01 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @nzk1912 普通貌似100rank以上吧。。。擦 你还是路人啊！    \n     2014-09-29 12:36 |    \t\tnzk1912 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:10        | 软件开发8年了，也来挖挖漏洞，为创建安全...)\t\t \n  @px1624 是啊~还是路人~~我看有些人，只有23RANK，就实习了，我还是路人啊~啥时候转正啊~是不是管理员把我遗漏了啊~ @xsser    \n     2014-09-29 14:19 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @nzk1912 估计你那3个漏洞确认了你就变实习了    \n     2014-09-29 14:50 |    \t\tnzk1912 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:10        | 软件开发8年了，也来挖挖漏洞，为创建安全...)\t\t \n  @px1624 嗯，期待中~~虽都是小洞，但应该能凑够5RANK    \n     2014-10-15 10:23 |    \t\tlove of red moon \t\t\t( 实习白帽子  |\t\t\t        Rank:46 漏洞数:11        | )\t\t \n  残暴管理员23333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333333    \n     2014-10-17 17:27 |    \t\tDocuments \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 感谢李大牛)\t\t \n  哎  看不懂    \n     2014-10-24 09:40 |    \t\t狂人 \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:13        | Rank:999999999 漏洞数:999999999 | 小学生...)\t\t \n  残暴的管理员。。？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}