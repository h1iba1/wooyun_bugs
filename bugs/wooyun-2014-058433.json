{"id": 3693, "wybug_id": "wooyun-2014-058433", "wybug_title": "中国邮政旗下某平台任意帐号密码重置", "wybug_corp": "中国邮政集团公司信息技术局", "wybug_author": "魇", "wybug_date": "2014-04-25 15:06", "wybug_open_date": "2014-06-09 15:07", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-09：\t细节向公众公开  简要描述： 感谢 @U神 @李旭敏 对本人的大力帮助... 详细说明：  http://www.183read.com/ 中邮阅读网中邮阅读网(www.183read.com)是集期刊、图书、有声阅读、数字订阅于一体的新媒体平台，由中国邮政主办, 是中国邮政旗下唯一的数字媒体发行平台，是邮政报刊发行由单一的实物发行走向实物与数字出版发行相结合的标志性网站。按照正常找回密码流程，找回密码，到邮箱内查看找回密码链接。找回密码链接为：\nhttp://www.183read.com/user/login/getpassword3/user_id/164008/code/1779f20a42a8ecfe9dd580c486784aab\n该链接由user_id：164008跟一个不知名MD5加密组成，这里我的想法是将其猜解出来，然后构造找回密码链接..在google浏览器F12开发者选项下，点击找回邮箱，发现这个id值已经返回了\n\n那么只剩下code后面的这串MD5，这串MD5如果经过一番猜测加密无果..后直接到CMD5解密1779f20a42a8ecfe9dd580c486784aab （第一次发送）解密为139840049055cb902c5b1b83486b71e3aa13a7a931 （第二次发送）解密为1398400853对比之下，只有后三位数有变动，但是前七位因为找回帐号不同也会变动..但经过测试，前七位也可以通过google浏览器F12查看到\n\n现在我们可控的有user_id以及MD5解密后的前7位数字也就是说我们只要将1398400100-1398400999进行批量MD5加密，再对加密后的MD5进行爆破就可以枚举出正确的找回密码链接（其实只是三位数的加密跟爆破，速度很快，弄的话不用几分钟）为了简去繁琐的过程，我用自己的另一个帐号wooyunyana@126.com测试演示：发送找回密码链接，获取到user_id:163902\n\n32位MD5解密后的前七位数字为：1398408\n\n然后批量生成后三位：1398408100-1398408999（burpsuite有自带的可以生成，导出文本）\n\n然后网上随便找个批量加密的工具，批量生成..然后我们到wooyunyana@126.com的邮箱比对一下生成的MD5\n\n\nhttp://www.183read.com/user/login/getpassword3/user_id/163902/code/53ee32982f5c1de87fb7f7c54d3a2e3e\n这个是我用工具生成的批量MD5的文本\n\n完全一致，证明了这个方法的可行性..这个洞是有史以来耗费过巨资的一次...因为是CMD5的付费解密第一次让@李旭敏帮忙解了一个，第二次有些想法需要测试再解几个对比，但又不好意思再麻烦他于是自己冲了20元到CMD5..简直...   漏洞证明：  20RMB知道你们补不了给我补20RANK 可好..   修复方案：     版权声明：转载请注明来源 魇@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-04-25 15:46 厂商回复： 谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-25 15:20 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  /zj    \n     2014-04-25 18:26 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  @U神 @李旭敏 厂商确认神速，快来挖洞小伙伴    \n     2014-04-25 23:39 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  @魇 求带    \n     2014-06-09 17:58 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  高富帅    \n     2014-06-09 18:01 |    \t\tdlevr \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:10        | 菜鸟一只，大神勿喷！)\t\t \n  中国邮政得罪你们了吗？？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}