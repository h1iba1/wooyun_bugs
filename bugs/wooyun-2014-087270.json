{"id": 47114, "wybug_id": "wooyun-2014-087270", "wybug_title": "支付宝某功能越权可影响其他企业与用户", "wybug_corp": "支付宝", "wybug_author": "bey0nd", "wybug_date": "2014-12-15 19:23", "wybug_open_date": "2015-02-04 16:26", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "17", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-15：\t该漏洞正等待厂商内部评估\t\t\t\t\t\t\t\t\t2014-12-16：\t厂商已经确认，与白帽子共同解决该漏洞中，漏洞信息仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-04：\t细节向公众公开  简要描述： 感谢表哥的支付宝号来测试 详细说明： 在双12的时候看到支付宝服务窗这个地方有活动。\n\n然后糊里糊涂的随便进了一个服务号来看消息，通过url进到了登陆的系统。https://fuwu.alipay.com/platform/material.htm登陆后即可创建服务号。然后试了一些功能，其中在素材库的地方有点问题。图文广播如下图。\n\n其中有个messageId。直接改messageId来编辑是不可以的，有权限验证，在保存的时候却没有验证了。不敢直接去保存其他公司的，毕竟支付宝的流量挺大，改错了影响到什么业务什么的。。找表哥借了个号，新建一个服务号如下。\n\n然后在第一个号编辑素材保存的时候抓包。如下：\n\n\n\n然后直接提交，虽然服务器提示无权修改，但是已经修改成功了。来到第二个号来看下\n\n\n\n越权修改成功地址：https://tfsimg.alipay.com/images/partner/T1PuXeXniLXXbMsGbX.html涉及到支付宝的业务，不敢乱改别人的了。改到官方的就不好了。  漏洞证明： https://tfsimg.alipay.com/images/partner/T1PuXeXniLXXbMsGbX.html  修复方案： 权限验证  版权声明：转载请注明来源 bey0nd@乌云\n ", "wybug_reply": "漏洞回应 厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-12-16 16:25 厂商回复： 感谢您对支付宝安全的关注，此问题正在修复中。 最新状态： 暂无 ", "replys": "漏洞评价：\n评论\n     2015-02-04 16:56 |    \t\twooyuners \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | 众筹之路)\t\t \n  支付宝好手笔20    \n     2015-02-04 16:58 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  5K rmb 吧？    \n     2015-02-04 17:20 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  表弟，我支付宝的十万块什么时候还给我？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}