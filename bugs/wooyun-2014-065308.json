{"id": 2509, "wybug_id": "wooyun-2014-065308", "wybug_title": "百度票务合作伙伴永乐票务可任意修改其他用户密码", "wybug_corp": "228.com.cn", "wybug_author": "Know", "wybug_date": "2014-06-17 22:36", "wybug_open_date": "2014-08-01 22:38", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "安全意识不足", "未授权访问", "用户敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-17：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-08-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 话说这个永乐票务（www.228.com.cn）是百度票务的合作伙伴，因为在百度票务（piao.baidu.com）官网的下方有他们的logo。so，贱贱的我就去了。sorry，说了好多废话。。。主题开始吧 详细说明：  由于涉及接口缺陷，可以通过手机短信验证码方式修改任意用户密码。为了不损害用户，我注册了两个账号customersid = 50515914（账号A）  和  customersid = 50515929（账号B）好了，开始具体的操作吧。1，找回密码页面输入账号B的账号（当然了，这个账号是可以猜测的，因为有验证，告知是否这个账号存在）http://www.228.com.cn/customer/forgotpassword.html\n\n2，下一步，可以通过两种方式找回密码，邮箱或者手机，实验发现邮箱找回有点不太可能。那换个手机的方式吧。\n\n3，抓包发现发送验证码居然调用了一个带明文userPhone和customersid参数的接口，虽然指定的手机收不到验证码，那就用自己的手机查收吧，而且，这个customersid还能先通过发送验证码接口抓包得到。\n\n4，我擦，居然成功了，还能收到\n\n5，好试着输入到之前的验证码输入框吧，居然成功输入，而且到达了设置新密码页面\n\n6，还等什么，速度将密码改之\n\n   漏洞证明：  关键的customersid可以通过第一次发送验证码的接口获取，只需要给正确的手机，发一次验证码，获取一下customersid，随后就可以用自己的手机和他人的customersid来获取验证码了。而且需要找回的账号可以猜测获得，一般用户为了买到票联系，都会输入自己的手机号。截个图，证明下吧：\n\n\n\n   修复方案：  我描述的已经非常详细了，该怎么修复，你们应该比我清楚，嘻嘻～   版权声明：转载请注明来源 Know@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-06-17 22:48 |    \t\t草榴社区 \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:26        | 未满18周岁,不准进入.)\t\t \n  中华人民共和国境内XX机房百度合作伙伴,中国电信大客户,绿盟大客户.永乐票务.这样看起来更唬人.    \n     2014-06-18 11:39 |    \t\tKnow \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | K)\t\t \n  @草榴社区 哈哈  原来可以更唬人    \n     2014-06-18 12:47 |    \t\t假马 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:18        | 我存在,你婶婶的脑海里.)\t\t \n  厂商不会认领的！    \n     2014-06-18 18:08 |    \t\tKnow \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | K)\t\t \n  @假马 看态度吧，爱领不领。哈哈～    \n     2014-06-19 02:59 |    \t\t小鸡鸡 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:10        )\t\t \n  @草榴社区  能给我个邀请码吗吗吗吗吗吗    \n     2014-06-19 10:37 |    \t\thappylyang \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:9        | 业余计算机爱好者)\t\t \n  试了试，找回密码似乎点开后直接跳到首页了。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}