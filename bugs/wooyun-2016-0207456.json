{"id": 88093, "wybug_id": "wooyun-2016-0207456", "wybug_title": "鱼泡泡APP任意用户登录可影响用户账户余额（app sign绕过技巧）                                      ", "wybug_corp": "yupaopao.cn", "wybug_author": "Zhe", "wybug_date": "2016-05-11 14:02", "wybug_open_date": "2016-06-25 14:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-25：\t细节向公众公开  简要描述：  详细说明：  1.详细说明下载地址http://android.myapp.com/myapp/detail.htm?apkName=cn.yupaopao.crop1.1 漏洞触发页面以及对应功能APP会话授权问题。可对任意用户进行操作1.2漏洞复现过程a.信息收集阶段访问任意用户的资料。从数据包中可收集以下字段\n\n记下id跟user_token\n\nmask 区域\n*****6f6655f10**********d30f529ac1*****\n\n\n\n数据包中有签名，直接修改数据，将返回签名验证失败。所以采用其他方式用自己的账号登录后，对APP的本地文件进行修改地址：/data/data/cn.yupaopao.crop/shared_prefs/logininfo_preferences.xml内容如下图\n\n分别替换其中的红框中内容的值，并保存重启APP，即可登录账号可进行各种操作\n\n\n\n\n\n\n\n\n\n部分数据包泄露用户的关键信息银行卡\n\n电话\n\n最后说明一点，该越权还可对其他用户打赏，也就是给别人钱测试借用一块钱，给你们另一个客服打赏一元\n\n\n\n成功了。分分钟钱就被打赏出去了。1.3 危害说明授权存在问题，用户无需密码即可登录任意用户，并通过正常操作将用户账户的余额打赏出去，再又被打赏账号进行提现。分分钟啊   漏洞证明：     修复方案：  为啥会有token在数据包里面，没想明白给个20Rank吧。谢谢   版权声明：转载请注明来源 Zhe@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-05-11 14:09 厂商回复： 产品确实有这个问题，会导致资金损失。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-05-11 14:03 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  剑走偏锋    \n     2016-05-11 14:03 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:905 漏洞数:163        | raw_input(\"你知道我要输入什么？\"))\t\t \n  @疯狗 还在聊天，快点来审洞子    \n     2016-05-11 14:15 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @Aasron 来了 ：P    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}