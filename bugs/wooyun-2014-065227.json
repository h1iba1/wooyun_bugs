{"id": 54202, "wybug_id": "wooyun-2014-065227", "wybug_title": "群英网络一分钱购买香港空间", "wybug_corp": "群英网络", "wybug_author": "小震", "wybug_date": "2014-06-17 18:41", "wybug_open_date": "2014-08-01 18:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "支付行业敏感"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-17：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-08-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 支付控制不严，改下url就可以1分钱购买。。 详细说明：  本来是买了个域名，结果还送一个月的香港空间。然后客服说。这500M+50mysql的空间一年568..现在五折，仅限三天内续费。（这么贵我当然不会买..）但是出于好奇点了续费。\n\n结果发现URL是这样的。：http://host.qycn.com/api_pay/payment_pay_client.php?o_fee=269&o_id=VS_1402975333662680V&tokenkey=ikvIA%252FxwE93eGodSJ3T3WOLXOtIqV0VIdsYye%252F3DNsBIXEjaPS415OnJsB5%252FJBU31iDbxPpf%252BBX%252B10XC6R%252BGpTKOjgxoLOhtZw33M%252F4HnUPKJ8JIOFCpxwwxh0PXX%252BB%252FzdQ3Rf4CEzbqV%252BvcFJWN3q1M%252BF0mYKRf8eV4OiDkdeFVj5yJhKkOIqbA1%252BhuAaQ%252FJrH4b7rOHePdIpvsWvEHTNkViVbuVp4YyzdRya2tyaKLxFr1VPWL%252BFRKKKWqPk6iUaZDIQQ&o_pay_type=1&o_type=1&goods_info=%E9%80%82%E5%90%88%E7%BD%91%E5%BA%97%E3%80%81%E4%B8%93%E4%B8%9A%E8%B5%84%E8%AE%AF%E7%AD%89%E4%B8%AD%E5%B0%8F%E5%9E%8B%E7%BD%91%E7%AB%99&goods_name=%E9%A6%99%E6%B8%AF%E4%BC%81%E4%B8%9AII%E5%9E%8B%2F1%E5%B9%B4&extra_param=12925%2F1%2Ff&time=1402975333于是。。你看到269了么。，直接秒为0.01，结果发现还是这样的：\n\n难道是跟产品id绑定了？于是顺便带着改了o_id这个参数。随便改了个数。于是。：\n\n好吧，支付~ 支付之后，支付宝返回的信息，他接收到返回了一个错误。（没截图。）本以为白费了，但是过了一会，邮件来了。。\n\n于是乎，看后台订单状态，已付款。看到期时间，2016...成功，\n\n先来个已付款的订单。改了一个1块钱的跟1分钱的。然后竟然成功了。\n\n   漏洞证明：  本来是买了个域名，结果还送一个月的香港空间。然后客服说。这500M+50mysql的空间一年568..现在五折，仅限三天内续费。（这么贵我当然不会买..）但是出于好奇点了续费。\n\n结果发现URL是这样的。：http://host.qycn.com/api_pay/payment_pay_client.php?o_fee=269&o_id=VS_1402975333662680V&tokenkey=ikvIA%252FxwE93eGodSJ3T3WOLXOtIqV0VIdsYye%252F3DNsBIXEjaPS415OnJsB5%252FJBU31iDbxPpf%252BBX%252B10XC6R%252BGpTKOjgxoLOhtZw33M%252F4HnUPKJ8JIOFCpxwwxh0PXX%252BB%252FzdQ3Rf4CEzbqV%252BvcFJWN3q1M%252BF0mYKRf8eV4OiDkdeFVj5yJhKkOIqbA1%252BhuAaQ%252FJrH4b7rOHePdIpvsWvEHTNkViVbuVp4YyzdRya2tyaKLxFr1VPWL%252BFRKKKWqPk6iUaZDIQQ&o_pay_type=1&o_type=1&goods_info=%E9%80%82%E5%90%88%E7%BD%91%E5%BA%97%E3%80%81%E4%B8%93%E4%B8%9A%E8%B5%84%E8%AE%AF%E7%AD%89%E4%B8%AD%E5%B0%8F%E5%9E%8B%E7%BD%91%E7%AB%99&goods_name=%E9%A6%99%E6%B8%AF%E4%BC%81%E4%B8%9AII%E5%9E%8B%2F1%E5%B9%B4&extra_param=12925%2F1%2Ff&time=1402975333于是。。你看到269了么。，直接秒为0.01，结果发现还是这样的：\n\n难道是跟产品id绑定了？于是顺便带着改了o_id这个参数。随便改了个数。于是。：\n\n好吧，支付~ 支付之后，支付宝返回的信息，他接收到返回了一个错误。（没截图。）本以为白费了，但是过了一会，邮件来了。。\n\n于是乎，看后台订单状态，已付款。看到期时间，2016...成功，\n\n先来个已付款的订单。改了一个1块钱的跟1分钱的。然后竟然成功了。\n\n   修复方案：  你们比我懂。顺便这个空间还要删除么。。。   版权声明：转载请注明来源 小震@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-06-17 20:31 |    \t\t小震 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | ~)\t\t \n  空间时间恢复原状，客服给了我2块钱。。    \n     2014-08-08 22:07 |    \t\t小指头 \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:19        | 不想当大拇指的小指头，不是个好手。)\t\t \n  好有意义！    \n     2014-08-09 09:33 |    \t\t小震 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | ~)\t\t \n  @小指头 ...第一个篡改URL就可以实现的= = 太简单了。。    \n     2014-10-11 09:38 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  有这种事情，改个url就行。。。坑爹啊    \n     2014-10-11 10:10 |    \t\t小震 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | ~)\t\t \n  @机器猫 是哦- -     \n     2015-01-23 13:01 |    \t\t蛇精病 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:10        | 你连棒棒糖都没有，还谈什么狗屁爱情？)\t\t \n  垃圾厂商 忽略 然后默默修复    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}