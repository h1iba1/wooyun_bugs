{"id": 13960, "wybug_id": "wooyun-2013-018146", "wybug_title": "走秀网账户手机绑定及密码取回缺陷", "wybug_corp": "走秀网", "wybug_author": "小胖子", "wybug_date": "2013-01-31 09:25", "wybug_open_date": "2013-03-17 09:25", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["手机短信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-02-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-02-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-03-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-17：\t细节向公众公开  简要描述： 大道理一样，有点小技巧，这次是完全盲测试。 详细说明：  先说密码重置吧问题如下：1.单个手机号码，每天只能接受3次重置验证码，我最先用我的手机号测试了验证码结构，得到4位随机数字，验证码太弱。2.得到验证码，我不提交，再点发送验证码，得到一样的验证码，第三次依旧，第四次就提示每天只能三次，而且，逻辑错误是，每次验证码一样，只要上一个验证码没被使用，那么第二次第三次依旧是这个，那就有点隐患，建议是，每次验证码不一样，而且次数限制。过程如下，得到验证码结构，那我来一次盲测。用13666666666这个号码。\n\n手机号不知是谁，不知验证码，随便输入一个4位数，burp抓包（这里没截图，绑定那里有截图），设置好验证码参数爆破，从1000到8000，大概也就这范围了。\n\n开始爆破，大概4分钟后，得到结果。\n\n验证码7629，我设置到8000，好险，差点出范围。看返回信息。\n\n可以看到结果是成功，那验证码就是这个。但是！但是！现在直接在窗口输入验证码，会提示验证码错误，那，现在，问题1里面的逻辑就派上用场了，因为只要第一次没用，后面都一样，点击再次获取，输入7629，重置密码成功。\n\n进去一看，原来是管理人员自己的测试帐号。\n\n问题二、绑定手机，这个原理一样不再多说，补两张图。我用我停机的手机卡测试，根本收不到短信的。绑定的burp截图\n\n认证通过。\n\n绑定成功。\n\n过程完。   漏洞证明：  见详细过程。   修复方案：  1.三次次数限制是对的，但是每次验证码要不一样才行啊。2.限制提交次数，提交多少次后验证码失效，此手机当日不能再获取验证码。3.检查所有跟登录和密码找回有关的接口和地址。   版权声明：转载请注明来源 小胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-02-01 09:56 厂商回复： 非常感谢提醒，此漏洞是基于知道注册用户手机的前提，有一定的风险。再次感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-31 09:30 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:143        | 心在，梦在)\t\t \n  重置密码最近很火呀~    \n     2013-01-31 09:33 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  这个网站都倒闭了    \n     2013-01-31 09:36 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:143        | 心在，梦在)\t\t \n  @小胖胖要减肥 这你都知道？    \n     2013-01-31 09:57 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @带馅儿馒头 反正他们wooyun的人离职了，公司经营状况确实不好，网站还没关，    \n     2013-01-31 10:03 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:143        | 心在，梦在)\t\t \n  @小胖胖要减肥 流逼呀，他们负责wooyun的人是你基友吧！    \n     2013-01-31 10:13 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @带馅儿馒头 不是 你看漏洞状态不就知道了     \n     2013-01-31 10:14 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @带馅儿馒头 错了 记错厂商了 ，，，，，这次丢人丢大了  @走秀网 我记错了    \n     2013-01-31 10:16 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @小胖胖要减肥 坑爹呢    \n     2013-01-31 10:18 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xsser 删了吧 哥哥啊 求求您老了     \n     2013-01-31 10:20 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @小胖胖要减肥 我发之前我都看看厂商反应如何的，人家微博今天都还在刷，前几天的漏洞也确认了的，有小道消息说走秀资金支撑不住，这，运营端咱就不关心了吧～～    \n     2013-01-31 10:22 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @小胖胖要减肥 你说的谁啊    \n     2013-01-31 10:25 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xsser 我的啊 不过电商走下坡路确实没办法 求哥把我的回复都删了    \n     2013-01-31 10:33 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:143        | 心在，梦在)\t\t \n  @小胖子 @xsser @小胖胖要减肥  不是说麦考林倒闭了么    \n     2013-01-31 10:36 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @带馅儿馒头 好像美国还没摘牌吧 低于1美元了 应该快了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}