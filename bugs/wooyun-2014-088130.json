{"id": 41653, "wybug_id": "wooyun-2014-088130", "wybug_title": "光明网绕过抓包限制和统一登录平台继续爆破", "wybug_corp": "gmw.cn", "wybug_author": "花心h", "wybug_date": "2014-12-22 14:25", "wybug_open_date": "2015-02-05 14:26", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "搞笑有爱"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向公众公开  简要描述： @疯狗 狗哥这样可以不走小厂商了吧？ 详细说明：  这回不从分站入手，直接在主站入手， 首先还是在顶条的登陆口抓包。 \n\n 抓得包如下 \n\n \n\n 有两个包。无视第一个直接用带do函数的。 发送后返回 \n\n 按照之前技术支持的逻辑思维来看，应该是验证本地的cookie值 去掉Cookie发现从3次变成了4次机会。 而且重复发包也是这个证明已成功绕过抓包限制。 关于验证码机制的问题我分析了下 应该只有在统一登陆平台的时候是需要验证码的。 在顶登陆条的验证机制应该是 用户名和密码正确，已GET方式传输到服务器验证>登陆成功 用户名或密码不正确，已GET方式传输到服务器验证>登陆失败并且限制登陆次数 而统一验证平台的机制是 用户名和密码和验证码正确，已POST方式传输到服务器验证>登陆成功 用户名和密码正确验证码不正确，已POST方式传输到服务器验证>验证码不正确 用户名正确，密码不正确，验证码正确，已POST方式传输到服务器验证>密码错误 用户名不正确，密码不正确，验证码正确，已POST方式传输到服务器验证>用户不存在,或者被删除 少了一个验证码验证。从而就绕过了验证码。在intruder下，发送包如下\n\n设置变量在用户名那里爆破成功的用户在证明内   漏洞证明：  部分账号，麻烦在公开前打下马赛克\n\nmask 区域\n*****\t123**********l\t12**********2\t12**********e\t12**********s\t12**********\t123**********n\t12**********n\t12**********L\t12**********y\t12**********s\t12**********\t123**********ia\t1**********2\t12**********\t123**********c\t12**********\t123**********s\t12**********6\t12**********1\t12**********\t123**********1234**********\t123**********is\t1**********l\t12**********\t123**********s\t12**********\t123**********n\t12**********\t123**********2\t12**********e\t12**********1234**********1234**********1234**********1234**********\t123**********\t123**********\t123**********1\t12**********\t123**********\t123**********\t123**********l\t12**********\t123**********1234**********1234**********s\t12**********1234**********n\t12**********\t123**********\t123**********\t123**********g\t12**********\t123**********s\t12**********\t123**********\t123**********t\t12**********\t123**********\t123**********\t123**********s\t12**********\t123**********1234**********ua\t1**********1234**********1234**********s\t12**********s\t12**********\t123**********\t123**********1234**********s\t12**********1234**********e\t12**********\t123**********\t123**********s\t12**********\t123**********\t123**********1234**********\t123**********\t123**********\t123**********n\t12**********\t123**********\t123**********1234**********1234**********\t123**********\t123**********\t123**********3\t12**********\t123**********\t12**********1234**********\t123**********\t123**********\t123**********1234**********1234**********N\t12**********1234**********e\t12**********\t123**********\t123**********4\t12**********1\t12**********1234**********\t123**********1234**********c\t12**********1234**********1234**********1234**********1234**********1234**********\t123**********4\t12**********1234**********1234**********1234**********\t123**********1234**********\t123**********1234**********\t123**********\t123**********r\t12**********\t123**********\t123**********1234**********1234**********1234**********1234**********\t123**********\t123**********1234**********1234**********1234**********1234**********\t123**********1234**********s\t12**********on\t1**********1234**********\t123**********\t123**********1234**********\t123**********\t123**********\t123**********1234**********\t12**********\t123**********\t123**********1234**********\t123**********l\t12**********1234**********n\t12**********1234**********\t123**********\t123**********\t12**********\t123**********1234**********1234**********\t123**********\t123**********e\t12**********\t123**********a\t12**********\t123**********\t123**********\t123**********\t123**********\t123**********\t123**********m\t12**********1234**********1234**********1234**********\t123**********1234**********g\t12**********4\t12**********\t123**********1234**********1234**********1234**********\t123**********1234**********1234**********1234**********1234**********\t123**********1234**********\t123**********\t123**********1234**********1234**********1234**********\t123**********1234**********\t123**********\t123**********\t123**********y\t12**********3\t12**********3\t12**********1234**********1234**********1234**********1234**********\t123**********1234**********\t123**********1234**********\t123**********1234**********1\t12**********\t12**********1234**********\t123**********1234**********1234**********1234**********1234**********1234**********1234**********\t123**********1234**********\t123**********\t123**********1234**********1234**********1234**********1234**********1234**********\t123**********1234**********1234**********1234**********\t123**********1\t12**********\t123**********1234**********1234**********1234**********1234**********b\t12**********\t12**********\t123**********1234**********1234**********1234**********\t123**********1234**********1234**********1234**********\t123**********1234**********\t123**********s\t12**********r\t12**********e\t12**********1234**********n\t1*****\n\n   修复方案：  你懂的   版权声明：转载请注明来源 花心h@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-12-22 17:52 厂商回复： 感谢您对我们的帮助！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}