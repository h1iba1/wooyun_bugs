{"id": 47191, "wybug_id": "wooyun-2014-087773", "wybug_title": "百度某业务CSRF取得BDUSS", "wybug_corp": "百度", "wybug_author": "qwerty472123", "wybug_date": "2014-12-19 09:49", "wybug_open_date": "2015-02-02 09:50", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-02：\t细节向公众公开  简要描述： CSRF取得BDUSS 看着很多标题和这个漏洞描述很像 于是 等了10多天 还没修复 于是来发了 详细说明：  百度登录（passport.baidu.com）有一个二维码登录 有一次无聊直接把二维码扫到电脑（已电脑百度的浏览器）里打开竟然发现可以打开一个网页 点确定按钮即可在获得二维码的浏览器(原未登录)上登录赶紧抓包看了一下 貌似确定发送的内容后没有Token 可以CSRF 于是开始构造一个恶意页面测试演示页面:chouthree.jd-app.com/cr/index.htm打开该页面后如果已登录百度就会显示BDUSS反正全是前端也就不说什么了 就是先用srciptCallback的XSS模拟百度登录页面那样 获得一个二维码页面地址 直接根据sign获得二维码页面地址 然后CSRF伪造点击确定的请求   漏洞证明：  演示页面:chouthree.jd-app.com/cr/index.htm\n\n   修复方案：  加个Token   版权声明：转载请注明来源 qwerty472123@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-12-19 16:39 厂商回复： 感谢提交，已通知业务部门处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-19 09:51 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  哟哟切克闹    \n     2015-01-08 16:44 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  @pandas 煎饼果子来一套    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}