{"id": 50451, "wybug_id": "wooyun-2014-077788", "wybug_title": "到喜啦重置任意用户密码", "wybug_corp": "到喜啦", "wybug_author": "小饼仔", "wybug_date": "2014-09-29 16:31", "wybug_open_date": "2014-11-13 16:34", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-29：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-11-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 那啥，挖掘机哪家强？快回答我~ 详细说明：  1.网站 www.daoxila.com 首先注册个号,这里为 wooyunxbz@163.com\n\n2. 到登入界面点击忘记密码\n\n3.这里有两种方式，邮箱和手机，这里先测试邮箱\n\n4.网站会向邮箱发送一封邮件\n\n5.打开邮箱，点击里面的链接\n\n6.然后到修改密码界面，账号显示为wooyunxbz@163.com,不能更改,然后输入新密码\n\n7.Burp抓包\n\n8.发现有一个account的参数，直接修改成任意一个账号，之前去注册界面测试过admin@daoxila.com这个账号已经被注册，所以就决定是你了\n\n9.修改成功，转到登入界面，账号admin@daoxila.com 密码wooyun123\n\n10.成功登入，账号显示为admin@daoxila.com\n\n那这个时候邮箱账号怎么来，之前我找到过一个SQL注入， WooYun: 到喜啦SQL注入一枚泄露用户订单等信息 ，里面可以拿到邮箱、手机号前面找回密码界面还有个通过手机找回密码，首先登入原来的账号，然后到基本资料里面，填写手机号，上面提示手机号也可以作为登入用户名，我拿自己的手机号测试了下\n\n然后到找回密码界面，选择手机,然后会给手机发一个6为验证码，没有说多久有效，可能可以爆破，没测试。然后填写完后，会到重置密码界面，这个就和刚才邮箱的类似了，burp抓包，修改account参数，这里通过前面的SQL注入，拿到一些手机号，13611844158137615442771334180976513917217272138187129561550171088713301906121随便挑一个\n\n成功登入\n\n   漏洞证明：  那啥，挖掘机哪家强？快回答我~   修复方案：  山东济南找蓝翔   版权声明：转载请注明来源 小饼仔@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}