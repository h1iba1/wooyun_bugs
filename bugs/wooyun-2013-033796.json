{"id": 9487, "wybug_id": "wooyun-2013-033796", "wybug_title": "海尔集团之3某系统SQL注射及源码下载", "wybug_corp": "海尔集团", "wybug_author": "小胖子", "wybug_date": "2013-08-08 11:37", "wybug_open_date": "2013-09-22 11:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "管理后台对外", "后台被猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-22：\t细节向公众公开  简要描述： 小胖子完成了一次三杀！！小胖子正在大杀特杀！！ 详细说明：  系统：http://travel.haier.com/travel 千辛万苦发现一个这个地址：http://travel.haier.com/travel/BaseInfo/SupplierSelect.aspx在查询处没有过滤导致注入。\n\n然后查询抓包，包好大啊！！！【经过跟管理员的协商。把包删除掉了！！！】\n\n\n\n有注射进入后台也没什么问题的。\n\nweb目录发现http://travel.haier.com/travel/web.zip  源码被下载。\n\n\n\nsa弱口令。还有一张不传了，太慢了速度。upload目录下PolicyUpLoad.aspx对上传没有没有很好的限制导致可以上传webshell。   漏洞证明：  见详细说明。\navailable databases [17]:[*] Back_Travel[*] ExhibitionsManagement[*] gobak[*] GOPSf[*] GOPSWGG[*] lumigent[*] master[*] model[*] msdb[*] mwdb[*] mwxb[*] PTMS[*] SBCBFX[*] tempdb[*] Travel[*] VipCard[*] xiechengDB\n   修复方案：  0x1:注射请尽快修复，过滤，你们的系统打开都好慢啊，桑心。0x2：sa弱口令这个也是很严重的。0x3：备份怎么能放在web目录？   版权声明：转载请注明来源 小胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-08-09 13:21 厂商回复： 首先感谢 @小胖子 的工作，其次抱歉，业务单位说这是老版系统，所以只肯给“中”，我也只能给中里最高的10rank。所做整改如下：屏蔽链接，封闭数据库注入入口；目前数据库的密码不是sa，但是为了安全起见，我们重新更改数据库密码，加强数据库密码安全；更改IIS虚拟目录资源访问模式，目录浏览；清理程序目录下的备份文件；排查程序代码，在可能数据库注入处添加参数限制条件。请白帽子们持续友好地监督海尔信息安全工作，并及时指正，非常感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-08 11:41 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @Finger 大宝贝，这个首页不显示难道走小厂商流程！？？不科学！！！你给我个解释了我去砍死xsser！！！    \n     2013-08-08 11:45 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @小胖子 谁让你不跑出东西来了    \n     2013-08-08 11:55 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2013-08-08 12:03 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @Finger 帮我补一下数据，昨晚太困了，可能提交的时候迷糊了，确认是有数据的。亲。    \n     2013-08-08 12:05 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @Finger 我编辑一下你再审核下吧亲，确实是忘了填写数据。    \n     2013-08-08 12:23 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @Finger 亲麻烦再审核一下，绝对是提交全部的数据，我的文件夹内的图片都传了的，不知道什么原因，你看我的漏洞修复里面提到了sa，原来的详细说明有sa弱口令这一项的，这个比较严重了，只是提交时候不知道出什么问题了，求不小厂商。3Q    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}