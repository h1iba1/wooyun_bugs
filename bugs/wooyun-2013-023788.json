{"id": 10688, "wybug_id": "wooyun-2013-023788", "wybug_title": "PHPCMS-存储型XSS漏洞（有利用条件）", "wybug_corp": "phpcms", "wybug_author": "独自等待", "wybug_date": "2013-05-16 15:46", "wybug_open_date": "2013-08-14 15:47", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "黑盒测试技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-24：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-07-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-14：\t细节向公众公开  简要描述： PHPCMS某处由于没有对用户输入进行正确处理，导致存在存储型XSS漏洞。 详细说明：  漏洞成因：在发表文章时，没有对文章标题内容进行过滤，导致XSS漏洞。漏洞利用条件：用户需要有发表文章的权限PHPCMS默认权限划分：PHPCMS默认有多种角色，不同角色对应有相应权限。要想成功利用该漏洞，需要有发表文章的权限。\n\n测试版本：PHPCMS V9.3.2，其他版本未测试   漏洞证明：  说明：要成功利用该漏洞，必须事先要获取一个有发表文章权限的帐号及相应密码。因为是测试，所以我这里新建了一个低权限的帐号，名为xsstest，该帐号有发布文章的权限。漏洞测试过程一：漏洞利用代码：</a><script>alert(document.cookie)</script>1.用xsstest登录后台，发布一篇文章，在文章标题处插入XSS测试代码，如下图：\n\n2.然后在推荐位处将“网站顶部推荐”前的复选框选中，如下图：\n\n3.最后发布文章，现在访问网站任意页面，均会触发漏洞。\n\n\n\n漏洞测试过程二：漏洞利用代码：\"/onmouseover=alert(/xss1/)//除了通过闭合<a>标签来触发漏洞外，还可以在其他地方通过事件来触发漏洞。具体如下图：\n\n\n\n\n\n   修复方案：  对用户输入的标题内容在输入和输出时进行过滤。   版权声明：转载请注明来源 独自等待@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-05-21 11:34 厂商回复： 漏洞之前修复过！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}