{"id": 13603, "wybug_id": "wooyun-2013-019036", "wybug_title": "百度经验存储型Xss跨任意用户", "wybug_corp": "百度", "wybug_author": "‫‌", "wybug_date": "2013-02-22 12:04", "wybug_open_date": "2013-04-08 12:05", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-02-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-03-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-03-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-04-08：\t细节向公众公开  简要描述： 先对我的错误，表示深深的忏悔。！百度经验是一个用户分享生活经验的一个平台。由于百度经验在提交内容时对某处没过滤，导致直接插了脚本进去。再由于审核出现的问题（没有检查），除了盗cookie的通过，居然弹框也通过了。 详细说明：  是这样的。百度经验在用户分享经验时，有这么几个功能：1.描述 2.图片插入 3.视频插入先不去管它审核是否能过，先来测试下能不能构成self-xss。经过自己的一番测试，发现在描述时过滤代码采用白名单，插入后点击预览会清除代码，直接看下一点。图片插入我没有测试，点击视频插入时发现需要输入视频页面URL，如图。\n\n按照我们惯用的手法，试图实现一下。先来找一个视频。由于需要的是视频页面，随便来找一个56的。http://www.56.com/u58/v_ODY5ODgzMTE.html我们插入\nhttp://www.56.com/u58/v_ODY5ODgzMTE.html\"><img src=# onerror=alert(1)>\n随便填写下描述什么的，点击预览。发现页面还没有加载完毕就弹了。如图。可以看到下面透明的字。\n\n   漏洞证明：  既然能弹，就能搞cookie了。可是我居然手贱点了发布。心里想着必然不会审核通过，那么就再写一发吧。试图写个很完整的经验然后偷偷插入xsserme的代码。我只好各种努力百度。找了个seo的站点发现有一篇写如何鉴别翡翠的。那么就这么定了，写完然后找个同样题目的视频，给URL加代码插进去。提交审核。然后抱着满心的憧憬等待管理后台的cookie到位。可惜没有。而令我诧异的是两篇经验却同时审核过了。尽管审核过了，却米有管理的cookie。只好看看代码是否还在，发现确实能弹，能收cookie。两篇经验地址：http://jingyan.baidu.com/article/3052f5a1b5263897f31f8613.htmlhttp://jingyan.baidu.com/article/7c6fb42845711f80642c9013.html代码还在，尽快修复。   修复方案：  过滤+严格检查，再出审核bug就不好玩了。   版权声明：转载请注明来源 ‫‌@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2013-02-22 12:28 厂商回复： 感谢提交，我们马上安排修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-02-25 18:19 |    \t\t百度(乌云厂商)\t\t \n  hi，漏洞作者，感谢您提交安全漏洞。因无法给您短信。故在此通知您：请于3月1日前，私信您的联系方式（邮编、地址、收件人、联系电话）给百度，我们将送出礼品一份，谢谢！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}