{"id": 66099, "wybug_id": "wooyun-2015-0139097", "wybug_title": "看我如何进入途牛内网访问大量内部系统与权限", "wybug_corp": "途牛旅游网", "wybug_author": "if、so", "wybug_date": "2015-09-05 11:27", "wybug_open_date": "2015-10-20 12:10", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-20：\t细节向公众公开  简要描述： 好久没提交漏洞了，晚上一直睡不着，半夜背着老婆爬起来做做渗透，就有了今天的漫游，内部系统很给力，火车票啥的都是浮云！ 详细说明：  “途牛网内网用户弱口令\"这个漏洞只爆破出来一个普通内网的用户密码，原本指望直接漫游的，没想到不能登陆邮箱，很是不甘心。于是开始全面的分析排查途牛网的各个系统。发现\nhttps://218.94.7.120/prx/000/http/localhost/login\n是途牛的vpn，以前没有发现，应该是新部署的vpn\n\n用之前爆破到的wangbing 1qaz@WSX登陆不成功，没有vpn权限。那现在怎么办了？陷入了僵局。无数案例告诉我，不要偷懒，要按照科学系统的渗透体系来尝试，于是开始扫描这个vpn机器的端口\nscan results2253443888892229888\n访问https://218.94.7.120:8888/ 发现是array的vpn，在众测的几次项目里面遇到过\n\n尝试了几个弱口令都失败https://218.94.7.120:9888同样是array的登陆口，应该都是负责管理vpn的这时候，我便猜测，vpn是刚部署上来的，有没有可能会存在默认口令了？可是array的默认口令不知道啊，于是构造了几个分别尝试登陆果然，https://218.94.7.120:9888 尝试 \narrary admin\n成功登陆，被里面功能吓尿了！\n\n功能十分强大，可以说有了这个系统权限，内网已经沦陷，可是对网络架构知识不熟悉，不敢乱动配置，只能翻翻有没有什么vpn账号密码啥的，果然发现了一个本地账户，也就是不是通过tuniu ldap认证的账号，俗称预设账号- -。\n\n看到有2个账号，一个是tuniu，一个demo，将账号导出后，发现密码加密了。\n[[user_name]]\t[[user_passwd]]tuniu\tXXXXXXXXXFZ40VmII/2j9cdemo\tXXXXXXXXXVX6TmBzCDsuJA\n看这个demo应该是系统自带账号，去\nhttps://218.94.7.120/prx/000/http/localhost/login\n尝试弱口令登陆demo demo成功登陆，也是醉了。。\n\n既然登陆进去了，那就开始漫游呗，大爽特爽！首先登陆crm系统，用之前爆破出来的wangbing登陆\n\n通讯录\n\n可管理主站广告\n\n\n\n实时会员管理，为了证明数据是实时更新，特地去注册了会员，果然碉堡！下面是更吊的，可以直接购买火车票，免费的哟，只是没胆子买！\n\n尝试弱口令登陆服务器\n\n在域里面，只要重复抓密码，登陆，抓密码，拿到域控权限会很easy\n\n内网系统图已经呈现\n\nconfluence系统\n\nappserver\n\n\n\n途牛主站后台管理系统\n\n不一一列举。。。   漏洞证明：  \n\n\nhttps://218.94.7.120/prx/000/http/localhost/login\n   修复方案：  修改相关弱口令，vpn做acl，只允许访问特定资源。其实做安全工作确实比较蛋疼，一个点出问题，就会导致重大纰漏，本次测试没有恶意，纯粹的技术挑战，希望与厂商共同进步   版权声明：转载请注明来源 if、so@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-09-05 12:09 厂商回复： 感谢if、so关注途牛安全，我们会尽快修复，醉了也是! 最新状态： 2015-09-05：又一次深刻体会到安全是一个整体，对于这次vpn相关弱口令安全这边是有很大责任的，之前vpn一直是it那边在管，最近有过vpn升级，我们也完全不知道。默认口令是开给厂商用的，管理口一直没关，内网安全就更不用说了。接下来口令、访问控制、多因素认证、内网安全有太多的事可以做，啥都不说了，再次感谢if、so！  ", "replys": "漏洞评价：\n评论\n     2015-09-05 11:27 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  给力！    \n     2015-09-05 11:44 |    \t\tsqlfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:167 漏洞数:28        | who?)\t\t \n  给力！    \n     2015-09-05 11:47 |    \t\tf4ck \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:7        | 有些人很牛B，一个漏洞能刷成N个。)\t\t \n  给力！    \n     2015-09-05 11:53 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:980 漏洞数:170        )\t\t \n  给力！    \n     2015-09-05 11:58 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1307 漏洞数:190        | 。)\t\t \n  大师傅    \n     2015-09-05 12:03 |    \t\twps2015 \t\t\t( 普通白帽子  |\t\t\t        Rank:537 漏洞数:70        | 不叫一日荒废)\t\t \n  厉害    \n     2015-09-05 12:04 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1615 漏洞数:193        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  给力！    \n     2015-09-05 12:12 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2823 漏洞数:649        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  你老婆居然不知道……    \n     2015-09-05 12:30 |    \t\t高小厨 \t\t\t( 普通白帽子  |\t\t\t        Rank:821 漏洞数:74        | 不会吹牛的小二不是好厨子！)\t\t \n  给力!    \n     2015-09-05 13:07 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1144 漏洞数:113        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  给力!疯子一走各种不给面子啊    \n     2015-09-05 15:25 |    \t\t白无常 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:7        )\t\t \n  @疯狗 @Coody @子非海绵宝宝 审核一下http://www.wooyun.org/bugs/wooyun-2015-0139009/trace/e3bba7698faf9ed7da767c09b8504472啊 马上要去学校 等着呢    \n     2015-09-05 17:30 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  背是第一声么……    \n     2015-09-05 21:25 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  @子非海绵宝宝 怪我咯？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}