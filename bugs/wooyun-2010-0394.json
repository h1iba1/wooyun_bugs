{"id": 24077, "wybug_id": "wooyun-2010-0394", "wybug_title": "QQMail高危XSS漏洞，影响所有用户", "wybug_corp": "腾讯", "wybug_author": "CnCxzSec(衰仔)", "wybug_date": "2010-09-01 18:25", "wybug_open_date": "2010-10-01 21:00", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["盲目信任用户数据", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-09-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2010-09-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2010-09-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2010-09-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2010-10-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2010-10-01：\t细节向公众公开  简要描述： QQ邮箱存在一个很诡异的（逻辑？）漏洞，导致可以发送包含任意html代码内容的邮件，并在收件方得到执行。 详细说明：  这个跨站确实很诡异，想了好久没想清楚问题出在哪。貌似是服务端那边逻辑判断的时候出了点问题。纯猜测。下面用流水账的方式描述：1.用QQ邮箱A给QQ邮箱B发邮件，收件人，标题填好后，对邮件正文内容做一次这样的操作：用邮件编辑器自带的插入图片功能，插入一个“网络照片”（地址随便写，asdf也没关系），之后在编辑器中该“插入的图片”的后面，输入任意html代码即可，如<script>alert(1)</script>，发送。2.B收到邮件，代码不会执行，当B意图回复该邮件，点击回复时，框框弹出来了。测试了一下，确实是任意html代码都可以执行。虽然在回复编辑框中的“原始邮件内容”处过滤了script taotao等tag，但是跨站产生的根本原因是直接把邮件正文的html代码输出到<pre id=\"source\"..>中。重现漏洞的关键就是“插入网络照片”这一个小步骤，如果没有这个小步骤的话，是不会成功的。思考很久，追踪变量很久，都没想出来这“关键的一步\"为什么成了关键的一步。希望tx的同学把洞补了后能交流一下这漏洞成因啊~   漏洞证明：  尝试去重现一下就明白了。。   修复方案：  嗯。。你懂的。。   版权声明：转载请注明来源 CnCxzSec(衰仔)@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2010-09-01 18:33 厂商回复： thanks 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-10-10 11:08 |    \t\t狗样的男人 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:11        )\t\t \n  确实很YD啊这个洞    \n     2011-10-20 15:09 |    \t\tQQ852451559 \t\t\t( 实习白帽子  |\t\t\t        Rank:79 漏洞数:18        | 学生党)\t\t \n  修复了么？昨天才听说的洞。    \n     2014-11-17 11:29 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  额，现在看来原理很简单，就是二次DOM输出的时候没有过滤。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}