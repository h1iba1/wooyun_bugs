{"id": 47522, "wybug_id": "wooyun-2014-086365", "wybug_title": "我乐网主站某服务配置不当", "wybug_corp": "56.com", "wybug_author": "路人甲", "wybug_date": "2014-12-08 13:30", "wybug_open_date": "2015-01-22 13:32", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "默认配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-22：\t细节向公众公开  简要描述： 我乐网主站某服务配置不当 详细说明：  我乐网 squid ACL配置当导致信息泄露。\nlala@lala:~$ squidclient -h www.56.com -p 80 mgr:HTTP/1.0 200 OKServer: Cdn Cache Server V2.0Date: Mon, 08 Dec 2014 05:11:40 GMTContent-Type: text/plainExpires: Mon, 08 Dec 2014 05:11:40 GMTLast-Modified: Mon, 08 Dec 2014 05:11:40 GMTX-Via: 1.0 sccdxx14:4 (Cdn Cache Server V2.0)Connection: close mem                   \tMemory Utilization\tpublic cbdata                \tCallback Data Registry Contents\tpublic events                \tEvent Queue\tpublic squidaio_counts       \tAsync IO Function Counters\tpublic coss                  \tCOSS Stats\tpublic config                \tCurrent Squid Configuration\thidden plugin                \tplugin info\tpublic ipcache               \tIP Cache Stats and Contents\tpublic ipaccess              \tIP Access Stats and Contents\tpublic fqdncache             \tFQDN Cache Stats and Contents\tpublic idns                  \tInternal DNS Statistics\tpublic external_acl          \tExternal ACL stats\tpublic http_headers          \tHTTP Header Statistics\tpublic menu                  \tThis Cachemanager Menu\tpublic ##注意这个！##shutdown              \tShut Down the Squid Process\thidden offline_toggle        \tToggle offline_mode setting\thidden malloc_print          \tPrint malloc statistic\tpublic denyattack_dynconf    \tThis Cachemanager denyattack_dynconf\tpublic denyattack_dynconf_del\tThis Cachemanager denyattack_dynconf_del\tpublic denyattack_dynconf_print\tThis Cachemanager denyattack_dynconf_print\tpublic put_ip_blackwhite_list\tThis Cachemanager put_ip_blackwhite_list\tpublic del_ip_blackwhite_list\tThis Cachemanager del_ip_blackwhite_list\tpublic get_ip_blackwhite_list\tThis Cachemanager get_ip_blackwhite_list\tpublic put_url_blackwhite_list\tThis Cachemanager put_url_blackwhite_list\tpublic del_url_blackwhite_list\tThis Cachemanager del_url_blackwhite_list\tpublic get_url_blackwhite_list\tThis Cachemanager get_url_blackwhite_list\tpublic get_ahtml_content     \tThis Cachemanager get_ahtml_content\tpublic put_rate_limit        \tThis Cachemanager put_rate_limit\tpublic del_rate_limit        \tThis Cachemanager del_rate_limit\tpublic put_miss_rate_limit   \tThis Cachemanager put_miss_rate_limit\tpublic del_miss_rate_limit   \tThis Cachemanager del_miss_rate_limit\tpublic put_miss_times_limit  \tThis Cachemanager put_miss_times_limit\tpublic del_miss_times_limit  \tThis Cachemanager del_miss_times_limit\tpublic put_times_limit       \tThis Cachemanager put_times_limit\tpublic del_times_limit       \tThis Cachemanager del_times_limit\tpublic put_bwctrl_para       \tThis Cachemanager put_bwctrl_para\tpublic put_max_conns         \tThis Cachemanager put_max_conns\tpublic get_bwctrl_limit      \tThis Cachemanager get_bwctrl_limit\tpublic reconfigure           \tInterface for dynamic reconfigure\tpublic host_list             \tInterface for list host info\tpublic forward_warning       \tForward Error Warning \tpublic traffic               \tTraffic count by host\tpublic traffic_n             \tTraffic count by host\tpublic traffic_time          \tTraffic count by host(cleared every 5 min)\tpublic traffic_bw            \tTraffic count by host for bwctrl\tpublic process_info          \tget the ports that are listened by precesses\tpublic 404                   \tRequest count by host\tpublic status                \tResponse status code count by host\tpublic info                  \tGeneral Runtime Information\tpublic qos_stat              \tGet QoS Statistics\tpublic qos                   \tGet QoS Statistics\tpublic filedescriptors       \tProcess Filedescriptor Allocation\tpublic objects               \tAll Cache Objects\tpublic vm_objects            \tIn-Memory and In-Transit Objects\tpublic openfd_objects        \tObjects with Swapout files open\tpublic pending_objects       \tObjects being retreived from the network\tpublic client_objects        \tObjects being sent to clients\tpublic io                    \tServer-side network read() size histograms\tpublic counters              \tTraffic and Resource Counters\tpublic peer_select           \tPeer Selection Algorithms\tpublic digest_stats          \tCache Digest and ICP blob\tpublic 5min                  \t5 Minute Average of Counters\tpublic 60min                 \t60 Minute Average of Counters\tpublic utilization           \tCache Utilization\tpublic histograms            \tFull Histogram Counts\tpublic active_requests       \tClient-side Active Requests\tpublic ssd_hot               \tshow top hot file of every cache dir\tpublic conns_table           \tshow host cons num\tpublic websocket             \tWebSocket information\tpublic purge_dir             \tPurge Dir Stats\tpublic storedir              \tStore Directory Stats\tpublic lrulist               \tlrulist\tpublic store_check_cachable_stats\tstoreCheckCachable() Stats\tpublic store_io              \tStore IO Interface Stats\tpublic store_stat_by_domain  \tNumber of Files, Store Size and The Oldest Lastref Time according to host\tpublic tcp_retrans           \ttcp_retrans\tpublic pconn                 \tPersistent Connection Utilization Histograms\tpublic refresh               \tRefresh Algorithm Statistics\tpublic delay                 \tDelay Pool Levels\tpublic forward               \tRequest Forwarding Statistics\tpublic server_list           \tPeer Cache Statistics\tpublic carp                  \tCARP information\tpublic client_list           \tCache Client List\tpublic asndb                 \tAS Number Database\tpublic\n   漏洞证明：  \n~$ squidclient -h www.56.com -p 80 mgr:idnsHTTP/1.0 200 OKServer: Cdn Cache Server V2.0Date: Mon, 08 Dec 2014 05:14:22 GMTContent-Type: text/plainExpires: Mon, 08 Dec 2014 05:14:22 GMTLast-Modified: Mon, 08 Dec 2014 05:14:22 GMTX-Via: 1.0 cdxx63:6 (Cdn Cache Server V2.0)Connection: closeInternal DNS Statistics:The Queue:                       DELAY SINCE  ID   SIZE SENDS FIRST SEND LAST SEND------ ---- ----- ---------- ---------Nameservers:IP ADDRESS      #NHOST # QUERIES # REPLIES--------------- ------ --------- ---------115.x.x.90     3953      6925      6728121.x.x.73      3953       197       19761.x.x.200     3953        12        12111.x.x.88     3953        12        12218.x.x.86     3953        12        12202.x.x.166      7       378       37861.x.x.254       7         0         0202.x.x.55        7         0         0Rcode Matrix:RCODE ATTEMPT1 ATTEMPT2 ATTEMPT3    0     6979        0        0    1        0        0        0    2        0        0        0    3      312        0        0    4        0        0        0    5        0        0        0\n   修复方案：  cachemgr_passwd password_here all   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-12-08 16:50 厂商回复： 很感激漏洞发现者，已经修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}