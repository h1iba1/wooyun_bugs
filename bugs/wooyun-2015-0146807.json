{"id": 83773, "wybug_id": "wooyun-2015-0146807", "wybug_title": "当乐游戏中心windows版存在两处DLL劫持", "wybug_corp": "d.cn", "wybug_author": "tmplazy", "wybug_date": "2015-10-20 14:25", "wybug_open_date": "2016-01-20 19:00", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["客户端程序设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-25：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-20：\t细节向公众公开  简要描述： 存在DLL劫持。 详细说明：  下载当乐游戏中心后，发现打不开程序。用OD看了一下，却发现了存在DLL劫持。   漏洞证明：  \n\n\n\n从图中可以看出程序在安装目录下查找这两个DLL，如果没有找到会到system32目录下寻找。但是当乐游戏中心安装后却没有这两个DLL，所以可以将恶意DLL释放到这两个目录下，就造成了DLL劫持。\n\n感觉还是有危害性的，毕竟可以直接通过USB在安卓手机上安装应用。\nBOOL APIENTRY DllMain( HMODULE hModule,                       DWORD  ul_reason_for_call,                       LPVOID lpReserved\t\t\t\t\t ){\tswitch (ul_reason_for_call)\t{\tcase DLL_PROCESS_ATTACH:\t\tMessageBox(NULL, L\"hello world\", L\"hello\", 0);\t\tbreak;\tcase DLL_THREAD_ATTACH:\tcase DLL_THREAD_DETACH:\tcase DLL_PROCESS_DETACH:\t\tbreak;\t}\treturn TRUE;}\n   修复方案：  加入这两个DLL   版权声明：转载请注明来源 tmplazy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2015-10-22 18:53 厂商回复： 感谢使用我公司产品并提出漏洞，此问题为使用第三方库所致，此产品之后不会再更新，下载游戏可以选择我们手机版的当乐游戏中心，提供了最新最好的游戏。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}