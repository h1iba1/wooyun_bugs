{"id": 1294, "wybug_id": "wooyun-2014-065644", "wybug_title": "我是这样以系统管理员权限进入天生创想任意用户的OA系统", "wybug_corp": "天生创想", "wybug_author": "JJ Fly", "wybug_date": "2014-06-20 23:06", "wybug_open_date": "2014-09-18 23:08", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-18：\t细节向公众公开  简要描述： 之前提交了一个漏洞。http://wooyun.org/bugs/wooyun-2014-063844后来看了下，漏洞也没有修复。唉，难道真的不重要吗。也许你觉的，oa系统吗。人家不中csrf xss那就没事。下面了一发不用csrf以及xss的。全版本。可以配合上一个漏洞，进行getshell。之前的漏洞也是所有版本的，不只是免费版（包括付费的政务版等等） 详细说明：  还是先说免费版的。本地测试。我们先登录上去，会生成如下的cookies\n\n\nPO_auth=MQk5ZjFmNDhmZTgyMGM2OTU0NzBhMGY1M2E5ODI4ZmY5Nw==\n我们来解密下1\t9f1f48fe820c695470a0f53a9828ff97前面的1应该就是代表用户的id了。我们讲上面得解密内容替换为。1\t11111111111111111111111111111111加密下\nMQkxMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMQo=\n我们将上面的cookies进行替换成我们重新加密的cookies。\n\n下面我们拿官网的政务版进行演示\nhttp://demo1.515158.com/login.php\n我们先登录一个测试帐号看下他的cookies的参数名\n\n解密之后如下2\t8a98bfb0e0097ef41764414889929798我们用MQkxMTExMTExMTExMTExMTExMTExMTExMTExMTExMTExMQo=来进行替换\n\n下面也是官网的一个演示站\nhttp://oa.515158.com/index.php\n\n\n   漏洞证明：  由于是oa系统。收录的不多。下面我们拿一个进行测试。（未进行其他任何操作）\n\n剩下的拿shell就不说了。希望这次官网能重视。把漏洞都修复下。不然的话 ，谁还会用你们的oa系统。\n\n求一个高rank。毕竟那么多用户呢。。。。。1w没有几千应该有吧。   修复方案：  \n你们更专业。\n   版权声明：转载请注明来源 JJ Fly@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-06-25 14:45 厂商回复： CNVD仍然继续尝试处置该漏洞，待有反馈的时候再进行状态更新。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-21 01:49 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  你非要这么写描述嘛我也没有办法，你们这些洞阔嘛就是喜欢弄个大新闻    \n     2014-06-21 08:21 |    \t\tJJ Fly \t\t\t( 普通白帽子  |\t\t\t        Rank:317 漏洞数:59        | 今天播下一颗种子。)\t\t \n  @动后河 大牛你好，初到乌云，有所不懂，还望见谅。    \n     2014-09-19 09:48 |    \t\t小康 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 小人物)\t\t \n  @JJ Fly 哥，我想问下哦！加密时候用1111…替换为什么可以生成管理员的cookies？？？？不解，本人菜逼，大牛勿喷    \n     2014-09-19 09:51 |    \t\tJJ Fly \t\t\t( 普通白帽子  |\t\t\t        Rank:317 漏洞数:59        | 今天播下一颗种子。)\t\t \n  @小康 @小康 代码好像是解密之后，然后只取前面的id进行调用，也就是那个1，跟后面没有关系。    \n     2014-09-19 11:24 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  服帖    \n     2014-09-19 16:51 |    \t\t小康 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 小人物)\t\t \n  @JJ Fly 哥，后面的是什么东东，也就是说系统默认的是管理员是第一个用户，然后你拿到的是加密后的id ，解密后，把1加密就得到了加密的cookies.然后程序就傻了！（能不能私密发一下QQ，拜学了，还有点问题）    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}