{"id": 10036, "wybug_id": "wooyun-2013-025065", "wybug_title": "ecshop绕过验证码暴利破解2", "wybug_corp": "ShopEx", "wybug_author": "ksc", "wybug_date": "2013-06-03 14:47", "wybug_open_date": "2013-09-01 14:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-07-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-01：\t细节向公众公开  简要描述： rt但是绕过方法比上一个http://wooyun.org/bugs/wooyun-2013-025053更简单 - -！ 详细说明：  \n\n\n漏洞文件/admin/privilege.phpelseif ($_REQUEST['act'] == 'signin'){    if (!empty($_SESSION['captcha_word']) && (intval($_CFG['captcha']) & CAPTCHA_ADMIN)){        include_once(ROOT_PATH . 'includes/cls_captcha.php');        /* 检查验证码是否正确 */        $validator = new captcha();        if (!empty($_POST['captcha']) && !$validator->check_word($_POST['captcha']))        {//此处有严重逻辑错误，也就是说我不post验证码就可以不检查验证码了            sys_msg($_LANG['captcha_error'], 1);        }    }    $_POST['username'] = isset($_POST['username']) ? trim($_POST['username']) : '';    $_POST['password'] = isset($_POST['password']) ? trim($_POST['password']) : '';........\n   漏洞证明：  同http://wooyun.org/bugs/wooyun-2013-025053只是不需要提交captcha字段   修复方案：  不存在captcha直接提示验证码不存在   版权声明：转载请注明来源 ksc@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-06-03 17:14 厂商回复： 非常感谢您为shopex信息安全做的贡献我们将尽快修复非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-03 15:07 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  不带这么刷分了！    \n     2013-06-03 15:11 |    \t\t夜 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 小夜，一个苦逼程序员)\t\t \n  不带这么欺负人的！    \n     2013-06-03 15:15 |    \t\tksc \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:9        | 张三的好朋友)\t\t \n  @齐迹 额不是故意的其实两个漏洞的性质不是很一样，评论里貌似不能说的太详细    \n     2013-06-03 15:17 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @ksc 我证明他代码还是看得不错的    \n     2013-06-03 15:55 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  @ksc ec最近被靠蛋疼了 歇歇在搞！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}