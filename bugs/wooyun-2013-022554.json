{"id": 12313, "wybug_id": "wooyun-2013-022554", "wybug_title": "手机QQ某扫描结果页反射型XSS", "wybug_corp": "腾讯", "wybug_author": "oott123", "wybug_date": "2013-04-26 12:21", "wybug_open_date": "2013-06-10 12:22", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "2", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-10：\t细节向公众公开  简要描述： 手机QQ扫描二维码时显示的结果页面未经过滤显示URL中的参数导致可能的XSS 详细说明：  腾讯新版的手机QQ二维码扫描结果，二维码中只含文字的情况下会显示在这个页面。\nhttp://qm.qq.com/cgi-bin/result?p=a&r=content\n查看页面源码可以得知，这个页面为纯静态页面，由js将URL中的参数r取出，然后经过一系列的正则匹配处理后进行显示。而这个正则处理并不是基于安全， 而仅仅是将其中的链接和手机号码加上a标签，而没有对可能的XSS攻击等进行处理。由于页面是qq.com的二级域名，众所周知qq会在.qq.com中存储一些cookies，其中包括用户的登录状态，用户上次登录的QQ号码等消息。   漏洞证明：  直戳：\nhttp://qm.qq.com/cgi-bin/result?p=a&r=<iframe%20src=\"javascript:var%20a=parent;var%20b=(a.document);var%20c=b.cookie;alert(c)\"%20/>\n\n\n   修复方案：  对参数进行编码处理后显示   版权声明：转载请注明来源 oott123@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-04-26 14:11 厂商回复： 非常感谢您的报告。这个问题我们已经确认，正在与业务部门进行沟通制定解决方案。如有任何新的进展我们将会及时同步。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}