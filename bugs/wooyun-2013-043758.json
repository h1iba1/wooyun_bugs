{"id": 60316, "wybug_id": "wooyun-2013-043758", "wybug_title": "TCCMS SQL注入漏洞", "wybug_corp": "teamcen.com", "wybug_author": "Matt", "wybug_date": "2013-11-25 15:13", "wybug_open_date": "2014-02-23 15:14", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-23：\t细节向公众公开  简要描述： TCCMS SQL注入漏洞 详细说明：  /app/controller/index.class.phppublic function search() {\t\t$_Obj = M(\"news\");\t\t$skey = $_POST[\"key\"];\t\t$where = empty($skey) ? \"1=1\" : \"title like '%$skey%'\";//注入\t\t$_Obj->field(\"id,uid,classid,smallmemo,title,photo,photo_s,addtime,hits,isphoto,levels,top,flashpic,special,reply\");\t\t$_Obj->pageSize = 40;\t\t$_Obj->where($where);\t\t$objAry = $_Obj->getList();\t\t$categoryObj = M(\"category\");\t\t$classId = intval($_GET['classid']);\t\t$isParent = $categoryObj->ifHavePid($classId);\t\t$categoryAry = array();\t\tif (empty($classId)) { //没有栏目ID\t\t\t$categoryAry = $categoryObj->field(\"id, pid, name\")->where(\"mid=1 and pid = 0\")->limit(1000)->find();\t\t} else if ($isParent) { //有子栏目\t\t\t$categoryAry = $categoryObj->field(\"id, pid, name\")->where(\"mid=1 and pid = \" . $classId)->limit(1000)->find();\t\t} else { //无子栏目\t\t\t$pObj = $categoryObj->load($classId);\t\t\t$pId = $pObj->pid;\t\t\t$categoryAry = $categoryObj->field(\"id, pid, name\")->where(\"mid=1 and pid = \" . $pId)->limit(1000)->find();\t\t}\t\t//关键字   漏洞证明：  测试方法127.0.0.1/tccms//index.php?ac=index_searchkey=1111111121'可以绕过防注入的~~\n\n   修复方案：  过滤   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-11-25 15:17 厂商回复： 这几天忙没来得及去处理，又给你机会了。感谢对开源软件TCCMS的关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}