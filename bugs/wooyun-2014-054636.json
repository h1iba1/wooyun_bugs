{"id": 4355, "wybug_id": "wooyun-2014-054636", "wybug_title": "中国科学技术大学生命科学实验中心网站设计缺陷可注册管理员用户", "wybug_corp": "中国科学技术大学", "wybug_author": "zinrokh", "wybug_date": "2014-03-26 15:36", "wybug_open_date": "2014-05-10 15:36", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-10：\t细节向公众公开  简要描述： 中国科学技术大学生命科学实验中心大型仪器自动化管理系统开放给公众的注册页面权限管理不严，可以直接注册系统管理员账户，获取自动化管理系统的所有权限。同样，已注册用户可以通过同样的方式在个人信息页面中提升自己的权限为管理员。 详细说明：  问题出在用户注册页面的参数上。系统的注册页面URL为：http://biotech.ustc.edu.cn/BiotechWeb/BioTech/Pages/BT10/BT100200.aspx?businessId=Default在这个页面上有一个参数为“角色”，根据网站的需求这个角色应当是仅能为“注册用户”。但页面加载的过程中将这个参数的所有值都加载进来了，通过chrome的审查元素功能或ie f12 以及firebug插件均可以绕过页面锁定进行修改。详细步骤如下：1、进入注册页面：http://biotech.ustc.edu.cn/BiotechWeb/BioTech/Pages/BT10/BT100200.aspx?businessId=Default2、使用chrome的审查元素功能，或其他的类似浏览器插件，找到“角色”的参数值；\n\n3、修改这一段代码的disabled=\"enable\"、下一行的value修改为  value=\"3\"；\n\n4、输入任意用户名，点击“检查用户名”就会发现，角色已经修改成了“系统管理员”。5、输入注册信息，完成注册就可以得到中国科学技术大学生命科学实验中心大型仪器设备管理系统的超级管理员权限。   漏洞证明：  \n\n\n\n   修复方案：  取消web注册页面的角色属性   版权声明：转载请注明来源 zinrokh@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2014-03-26 15:52 厂商回复： 已通知科大进行处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-26 15:51 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  。。。。。。。。。。    \n     2014-03-26 15:53 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  秒确认？    \n     2014-03-26 15:54 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  真是好漏洞啊     \n     2014-03-26 16:11 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:143        | 心在，梦在)\t\t \n  @疯狗 有何妙处？    \n     2014-03-26 16:38 |    \t\tCoffee \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:15        | Corie, a student of RDFZ.)\t\t \n  闪电了？！    \n     2014-03-27 07:51 |    \t\t毕月乌 \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:16        | 猜猜我是谁？)\t\t \n  好东西留个名    \n     2014-03-27 11:11 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  you shan dian, mark    \n     2014-03-27 11:13 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @带馅儿馒头 很有想法的漏洞 很奇妙    \n     2014-03-27 11:16 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @带馅儿馒头 逻辑设计类漏洞都很有意思    \n     2014-03-27 13:12 |    \t\tPnig0s \t\t\t( 实习白帽子  |\t\t\t        Rank:46 漏洞数:2        | The quiter you are,the more you're able ...)\t\t \n  我猜是管理员后加unicode字符，通过服务端验证，但进入Mysql数据库时由于编码问题被截断，admin的信息被更新。    \n     2014-03-27 14:56 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @Pnig0s 你说的这个案例也非常经典，就是现在好少见了，可惜：（    \n     2014-03-30 21:50 |    \t\tzinrokh \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:1        | 某安全公司小土鳖一只)\t\t \n  其实这个漏洞很简单的，如果你们看到页面了一定也会想到~典型的前端控制错误~    \n     2014-04-25 23:24 |    \t\tj0ck \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:5        | hello~)\t\t \n  又见奇葩程序员，    \n     2014-05-10 20:35 |    \t\tSura、Rain \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:8        | 关注Java WEB安全)\t\t \n  这个程序员很可爱啊，以为网页禁用就禁用了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}