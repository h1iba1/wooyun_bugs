{"id": 34726, "wybug_id": "wooyun-2015-0115425", "wybug_title": "p2p金融安全之安心贷重要功能设计缺陷(影响全站用户)", "wybug_corp": "anxin.com", "wybug_author": "her0ma", "wybug_date": "2015-05-26 20:56", "wybug_open_date": "2015-05-31 20:58", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-31：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 继续方便面大牛的脚步，P2P金融安全系列 详细说明：  安心贷（www.anxin.com）是君安信（北京）科技有限公司的独立品牌。安心贷成立于2011年，是中国较早开始运营的P2P网贷平台。安心贷以金融从业者严谨务实的态度，逐步发展起来。安心贷是最早一批对于投资人进行风险保障的平台，并始终要求借款人用资产进行超额抵押。通过严格的风控，安心贷成为中国网贷行业违约率最低的平台之一。手机找回密码功能存在设计缺陷，可以重置任意用户的密码。具体功能URL：http://www.anxin.com/Usercenter/safety/getbackPasswd.html选择通过手机号码找回，输入要攻击的手机号码，点击发送验证码，抓包请求如下：POST /ajax/ajax_validate.ashx HTTP/1.1Host: www.anxin.comCmd=sendmsgandgraphic&phoneNum=13521231478&gcode=3pwt&vflag=moblievalidate   漏洞证明：  直接将phoneNum的值修改为自己的手机号码，然后提交该请求，自己的手机就能收到验证码了，用收到的验证码就可以重置需要攻击的手机号的密码了。亲测成功。   修复方案：  这种逻辑漏洞是由于没有判断手机好对应验证码的关系吧？我也很好奇咋形成的，厂商能贴代码出来了解一下么？   版权声明：转载请注明来源 her0ma@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-05-31 20:58 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-22 12:05 |    \t\t管管侠 \t\t\t( 核心白帽子 |\t\t\t        Rank:1368 漏洞数:108        | 休息几日，让你们先装会！！！)\t\t \n  跟着大表哥的步伐，似魔鬼的步伐    \n     2015-06-01 09:18 |    \t\tsql小神 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 有些漏洞可以提，有些漏洞不可以提。)\t\t \n  这个漏洞要15rank，？不懂为什么这么贵    \n     2015-06-01 11:43 |    \t\ther0ma \t\t\t( 核心白帽子 |\t\t\t        Rank:598 漏洞数:84        | 专注小厂商三十年！)\t\t \n  @sql小神 不是我的贵了，是你的便宜了，任意用户密码重置，这必须算高危的啊……虽然漏洞本身没啥技术含量，不过漏洞的高低看影响，不是看发现的过程是否曲折，是否有技术含量……    \n     2015-06-01 13:01 |    \t\tsql小神 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 有些漏洞可以提，有些漏洞不可以提。)\t\t \n  原来是这样啊，我还以为是，看渗透难度呢    \n     2015-06-04 21:19 |    \t\tkazaf \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:5        | 待学者、程序猿)\t\t \n  想问一下这个是怎么跟其他用户的账号对应的，那个手机号不是改成你自己的了的麽？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}