{"id": 699, "wybug_id": "wooyun-2014-068734", "wybug_title": "Ucenter Home 2.0 SQL注入2枚（最新版）", "wybug_corp": "Ucenter Home", "wybug_author": "ecbug", "wybug_date": "2014-07-16 15:37", "wybug_open_date": "2014-10-14 15:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-14：\t细节向公众公开  简要描述： 去官网下载了最新版本并打上了最新补丁后审计出来几处漏洞。估计厂商又要忽略，还是提交给cert吧！ 详细说明：  先提交2个gpc=off的注射，该程序还有getshell看看厂商的态度再考虑发不发。1.cp_profile.php\n//隐私$inserts = array();foreach ($_POST['friend'] as $key => $value) {    $value = intval($value);    $inserts[] = \"('base','$key','$space[uid]','$value')\";}if($inserts) {    $_SGLOBAL['db']->query(\"DELETE FROM \".tname('spaceinfo').\" WHERE uid='$space[uid]' AND type='base'\");    $_SGLOBAL['db']->query(\"INSERT INTO \".tname('spaceinfo').\" (type,subtype,uid,friend)        VALUES \".implode(',', $inserts));}\nkey未过滤即带入数据库造成注射。   漏洞证明：  第二处注入：cp_privacy.php\nforeach ($filter_note as $key => $value) {\t\tlist($type, $uid) = explode('|', $key);\t\t$types[$key] = $type;\t\t$uids[$key] = $uid;\t\tif(is_numeric($type)) {\t\t\t$appids[$key] = $type;\t\t}\t}\tif($uids) {\t\t$query = $_SGLOBAL['db']->query(\"SELECT uid, username FROM \".tname('space').\" WHERE uid IN (\".simplode($uids).\")\");\t\twhile ($value = $_SGLOBAL['db']->fetch_array($query)) {\t\t\t$users[$value['uid']] = $value['username'];\t\t}\t}\n一样是key未做过滤。案例1证明：\n\n案例2证明:\n\n   修复方案：  key也过滤下   版权声明：转载请注明来源 ecbug@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-07-20 22:29 厂商回复： CNVD确认并复现所述情况，由CNVD尝试联系软件生产厂商——北京康盛新创科技有限责任公司。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-16 18:22 |    \t\t老笨蛋 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:8        | 老笨蛋一个)\t\t \n  汝甚屌，家人知否？    \n     2014-07-16 20:55 |    \t\tCoxxs \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:8        | 节操数:233 | ww)\t\t \n  DZ现在反应快起来了..有危害的都确认了 /corp_detail.php?corp=Discuz!    \n     2014-07-17 16:08 |    \t\tHmily \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 吾爱破解论坛)\t\t \n  @Coxxs 反应快不给发补丁还是废物。。。    \n     2014-07-17 23:51 |    \t\tecbug \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:15        | hello wooyun)\t\t \n  @Hmily 黑米粒大哥用的uchome？要不要我给你几个补丁    \n     2014-07-18 13:54 |    \t\tHmily \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 吾爱破解论坛)\t\t \n  @ecbug 以前7.x用过，现在x系统好像没有了吧？    \n     2014-10-14 17:27 |    \t\tnzk1912 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:10        | 软件开发8年了，也来挖挖漏洞，为创建安全...)\t\t \n  敢问这两个$$，是DZ出？还是wooyun出？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}