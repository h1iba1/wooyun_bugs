{"id": 73118, "wybug_id": "wooyun-2015-0160648", "wybug_title": "中国电信集团股份有限公司某系统服务器Getshell", "wybug_corp": "中国电信", "wybug_author": "朱元璋", "wybug_date": "2015-12-12 10:56", "wybug_open_date": "2016-01-28 17:10", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向公众公开  简要描述：  详细说明：  \n\n\n\n链接地址http://**.**.**.**:59009/VIPNMS/login.action存在命令执行漏洞\n\n直接上传木马到服务器\n\n\n\n   漏洞证明：  \n[/inm/nmsapp/opt/tomcat/tomcat3/webapps/VIPNMS/VIPNMS/]$ chkconfig --listNetworkManager \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offabrt-ccpp      \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offabrt-oops      \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offabrtd          \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offacpid          \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offatd            \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offauditd         \t0:off\t1:off\t2:on\t3:on\t4:on\t5:off\t6:offautofs         \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offavahi-daemon   \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offbluetooth      \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offcertmonger     \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offcgconfig       \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offcgred          \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offcpuspeed       \t0:off\t1:on\t2:off\t3:off\t4:off\t5:off\t6:offcrond          \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offcups           \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offdnsmasq        \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offebtables       \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offfirstboot      \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offhaldaemon      \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offhttpd          \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offip6tables      \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offiptables       \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offirqbalance     \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offiscsi          \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offiscsid         \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offkdump          \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offksm            \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offksmtuned       \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offlibvirt-guests \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offlibvirtd       \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offlvm2-monitor   \t0:off\t1:on\t2:on\t3:on\t4:on\t5:on\t6:offmatahari-broker\t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offmatahari-host  \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offmatahari-network\t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offmatahari-service\t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offmatahari-sysconfig\t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offmdmonitor      \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offmessagebus     \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offnetconsole     \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offnetfs          \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offnetwork        \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offnfs            \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offnfslock        \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offntpd           \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offntpdate        \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offoddjobd        \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offportreserve    \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offpostfix        \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offpsacct         \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offqpidd          \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offquota_nld      \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offradvd          \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offrdisc          \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offrestorecond    \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offrhnsd          \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offrhsmcertd      \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offrpcbind        \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offrpcgssd        \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offrpcidmapd      \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offrpcsvcgssd     \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offrsyslog        \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offsalt-minion    \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offsaslauthd      \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offsmartd         \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offsnmpd          \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offsnmptrapd      \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offspice-vdagentd \t0:off\t1:off\t2:off\t3:off\t4:off\t5:on\t6:offsshd           \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offsssd           \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offsysstat        \t0:off\t1:on\t2:on\t3:on\t4:on\t5:on\t6:offudev-post      \t0:off\t1:on\t2:on\t3:on\t4:on\t5:on\t6:offvirt-who       \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offvmware-tools   \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offwdaemon        \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offwpa_supplicant \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offypbind         \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:off/bin/sh: line 0: cd: /inm/nmsapp/opt/tomcat/tomcat3/webapps/VIPNMS/VIPNMS/: No such file or directory[/inm/nmsapp/opt/tomcat/tomcat1/bin/]$ cat /etc/passwdroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinuucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinusbmuxd:x:113:113:usbmuxd user:/:/sbin/nologinrpc:x:32:32:Rpcbind Daemon:/var/cache/rpcbind:/sbin/nologinavahi-autoipd:x:170:170:Avahi IPv4LL Stack:/var/lib/avahi-autoipd:/sbin/nologinoprofile:x:16:16:Special user account to be used by OProfile:/home/oprofile:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinrtkit:x:499:497:RealtimeKit:/proc:/sbin/nologinabrt:x:173:173::/etc/abrt:/sbin/nologinhsqldb:x:96:96::/var/lib/hsqldb:/sbin/nologinsaslauth:x:498:76:\"Saslauthd user\":/var/empty/saslauth:/sbin/nologinpostfix:x:89:89::/var/spool/postfix:/sbin/nologinqpidd:x:497:496:Owner of Qpidd Daemons:/var/lib/qpidd:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:65534:65534:Anonymous NFS User:/var/lib/nfs:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinapache:x:48:48:Apache:/var/www:/sbin/nologinradvd:x:75:75:radvd user:/:/sbin/nologinqemu:x:107:107:qemu user:/:/sbin/nologinavahi:x:70:70:Avahi mDNS/DNS-SD Stack:/var/run/avahi-daemon:/sbin/nologinpulse:x:496:494:PulseAudio System Daemon:/var/run/pulse:/sbin/nologingdm:x:42:42::/var/lib/gdm:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologintcpdump:x:72:72::/:/sbin/nologinctinm:x:500:500:ctinm:/home/ctinm:/bin/bashultrainm:x:901:900::/home/ultrainm:/bin/bashnmsapp:x:902:902::/inm/nmsapp:/bin/bashpatrol:x:911:900::/home/patrol:/bin/bashctsi:x:920:920::/inm/ctsi:/bin/bash[/inm/nmsapp/opt/tomcat/tomcat1/bin/]$ ifconfigeth1      Link encap:Ethernet  HWaddr 02:00:74:55:00:22            inet addr:**.**.**.**  Bcast:**.**.**.**  Mask:**.**.**.**          inet6 addr: fe80::74ff:fe55:22/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:155790146 errors:0 dropped:0 overruns:0 frame:0          TX packets:79493301 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:85258288251 (79.4 GiB)  TX bytes:18338520710 (17.0 GiB)lo        Link encap:Local Loopback            inet addr:**.**.**.**  Mask:**.**.**.**          inet6 addr: ::1/128 Scope:Host          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:129344319 errors:0 dropped:0 overruns:0 frame:0          TX packets:129344319 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:6468625231 (6.0 GiB)  TX bytes:6468625231 (6.0 GiB)[/inm/nmsapp/opt/tomcat/tomcat1/bin/]$ cat /etc/resolv.conf# Generated by NetworkManager# No nameservers found; try putting DNS servers into your# ifcfg files in /etc/sysconfig/network-scripts like so:## DNS1=xxx.xxx.xxx.xxx# DNS2=xxx.xxx.xxx.xxx# DOMAIN=**.**.**.** **.**.**.**[/inm/nmsapp/opt/tomcat/tomcat1/bin/]$ bash prompt:bash: prompt:: No such file or directory[/inm/nmsapp/opt/tomcat/tomcat1/bin/]$ lsb_release -aLSB Version:\t:core-4.0-amd64:core-4.0-noarch:graphics-4.0-amd64:graphics-4.0-noarch:printing-4.0-amd64:printing-4.0-noarchDistributor ID:\tRedHatEnterpriseServerDescription:\tRed Hat Enterprise Linux Server release 6.2 (Santiago)Release:\t6.2Codename:\tSantiago[/inm/nmsapp/opt/tomcat/tomcat1/bin/]$ uname -aLinux inmlcntest01 2.6.32-220.el6.x86_64 #1 SMP Wed Nov 9 08:03:13 EST 2011 x86_64 x86_64 x86_64 GNU/Linux[/inm/nmsapp/opt/tomcat/tomcat1/bin/]$ iduid=902(nmsapp) gid=902(nmsapp) groups=902(nmsapp),10(wheel) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023[/inm/nmsapp/opt/tomcat/tomcat1/bin/]$\n   修复方案：  加强安全意识   版权声明：转载请注明来源 朱元璋@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-12-16 19:08 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国电信集团公司通报,由其后续协调网站管理部门处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}