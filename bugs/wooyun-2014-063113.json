{"id": 2866, "wybug_id": "wooyun-2014-063113", "wybug_title": "搜狐焦点某安全机制绕过漏洞", "wybug_corp": "搜狐", "wybug_author": "qwerty", "wybug_date": "2014-06-02 13:07", "wybug_open_date": "2014-07-17 15:29", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-17：\t细节向公众公开  简要描述： 搜狐焦点网对于攻击行为有个防御机制，但是可被绕过呢~ 妈妈再也不用担心熊孩子脱不了库啦 @浩天 详细说明：  使用某扫描工具对焦点网进行扫描，或者使用sqlmap脱裤的时候，会触发搜狐的防御机制，对该IP地址进行屏蔽，返回403错误。比如这个熊孩子IP就被禁过，嘻嘻 http://wooyun.org/bugs/wooyun-2014-057374http://wooyun.org/bugs/wooyun-2014-057319屏蔽效果见图\n\n但是我们机智的发现，这里是针对IP地址进行屏蔽的。那么能不能进行绕过呢？尝试截包，加入X-Forwarded-For: 8.8.8.8 头字段.\n\n成功绕过IP限制。看看两次的访问对比效果,添加IP伪造字段后，返回码正常了。\n\n不加X-Forwarded-For头字段,则又被屏蔽了。\n\nX-Forwarded-For头字段的值，可以由客户端随意伪造。这样的话，搜狐的IP屏蔽机制就形同虚设啦。   漏洞证明：  证明见详细说明。绕过前后对比：\n\n\n\n刷分中，上次存储跨站只给了低危，今天过节，多给点分啦~   修复方案：  不要使用X-Forwarded-For字段来判断客户端IP。    版权声明：转载请注明来源 qwerty@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-06-02 14:14 厂商回复： 感谢支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-02 14:19 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  关注，这个很有用。    \n     2014-06-03 16:28 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  @qwerty 你这名字起的太弱口令了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}