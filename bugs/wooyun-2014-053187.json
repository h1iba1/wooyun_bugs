{"id": 3739, "wybug_id": "wooyun-2014-053187", "wybug_title": "qibocms B2b 注入一枚", "wybug_corp": "齐博CMS", "wybug_author": "′雨。", "wybug_date": "2014-03-09 14:11", "wybug_open_date": "2014-06-07 14:11", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-20：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-07：\t细节向公众公开  简要描述： 在wooyun上看了看qibo。  忽略了全部xss. 那我就不提xss了。  来几枚注入， 求不忽略可好? 详细说明：  B2B系统。在news/js.php中\nf($type=='hot'||$type=='com'||$type=='new'||$type=='lastview'||$type=='like'){\tif($f_id)\t{\t\tif(is_numeric($f_id)){\t\t\t$SQL=\" fid=$f_id \";\t\t}else{\t\t\t$detail=explode(\",\",$f_id);\t\t\t$SQL=\" fid IN ( \".implode(\",\",$detail).\" ) \";\t\t}\t}\telse\t{\t\t$SQL=\" 1 \";\t}\tif($type=='com')\t{\t\t$SQL.=\" AND levels=1 \";\t\t$ORDER=' list ';\t\t$_INDEX=\" USE INDEX ( list ) \";\t}\telseif($type=='hot')\t{\t\t$ORDER=' hits ';\t\t$_INDEX=\" USE INDEX ( hits ) \";\t}\telseif($type=='new')\t{\t\t$ORDER=' list ';\t\t$_INDEX=\" USE INDEX ( list ) \";\t}\telseif($type=='lastview')\t{\t\t$ORDER=' lastview ';\t\t$_INDEX=\" USE INDEX ( lastview ) \";\t}\telseif($type=='like')\t{\t\t\t\t$SQL.=\" AND id!='$id' \";\t\tif(!$keyword)\t\t{\t\t\textract($db->get_one(\"SELECT keywords AS keyword FROM {$_pre}content WHERE id='$id'\"));\t\t}\t\tif($keyword){\t\t\t$SQL.=\" AND ( \";\t\t\t$keyword=urldecode($keyword);\t\t\t$detail=explode(\" \",$keyword);\t\t\tunset($detail2);\t\t\tforeach( $detail AS $key=>$value){\t\t\t\t$detail2[]=\" BINARY title LIKE '%$value%' \";\t\t\t}\t\t\t$str=implode(\" OR \",$detail2);\t\t\t$SQL.=\" $str ) \";\t\t\t\t\t}else{\t\t\t$SQL.=\" AND 0 \";\n看到keyword 解码了。  所以无视了全局的转义了。然后用空格来切割。就不能用空格了。 官网测试成功。   漏洞证明：  \n\n   修复方案：  求过滤 求保养求20.   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-03-17 13:23 厂商回复： 感谢提出来！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-09 15:05 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  顶下    \n     2014-03-09 20:33 |    \t\t404 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        )\t\t \n  Mark.    \n     2014-06-07 15:00 |    \t\tXser \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:61        | JDSec)\t\t \n  keyword哪里有说是用get接受了？    \n     2015-08-06 00:02 |    \t\t昌维 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | QQ：867597730，百度贴吧ID：昌维001)\t\t \n  @Xser 他贴出的代码里面当然没有啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}