{"id": 14732, "wybug_id": "wooyun-2012-016373", "wybug_title": "果壳传媒一处设计缺陷+存储型xss突破", "wybug_corp": "果壳传媒", "wybug_author": "se55i0n", "wybug_date": "2012-12-23 13:48", "wybug_open_date": "2013-02-06 13:49", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-02-06：\t细节向公众公开  简要描述： 哈哈，看见你们发礼物了，路过特来求礼物~ 详细说明：  1.一处设计缺陷可导致果壳传媒的系统邮件攻击任何邮件账户；1)首先来到用户注册处，注册一枚用户；\n\n2）填写注册信息并提交；\n\n3）这时看到旁边有个“重新发送”；\n\n4）点击重新发送，注意到链接地址的变化如下：\nhttp://www.guokr.com/reg_success/?m=XXX@sina.com&r=1\n参数\"r=1\"，对，你猜的没错，这是代表重发邮件的次数；以此类推，\"r=1\"重发第一次，\"r=n\"重发第n次，果断点了几下，正如我的猜想;\n\n5)登陆邮箱果然收到一堆果壳的系统邮件（1+6）；\n\n2.头像上传处存储型xss，这里就危险了，你懂的；1）点击头像上传，上传一张图片提交并抓包；\n\n2）抓包发现数据中存在大小头像的图片的src属性，貌似能够利用下；\n\n3）经过一番测试，发现在src属性值后加上以下xss code可绕过系统的防御；\n\n4）不骗你，真的弹窗了；\n\n\n\n   漏洞证明：  见详细说明~   修复方案：  ps：我真的过来求礼物的   版权声明：转载请注明来源 se55i0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-12-25 10:47 厂商回复： 低危害，可能导致脏数据，可能导致客户端数据泄漏。旧系统中，图片裁剪后提交修改时的校验不充分，导致此XSS漏洞。可加以修复，修复优先级中高。新系统中，图片裁剪的漏洞不存在。新系统中为防止脏数据，对输入的hashkey进行了强校验（检验字段合法性和用户本人上传）。注册发邮件这个可能对他人邮箱造成轰炸，这个是之前没有考虑到的。比较安全的做法是每一次发邮件都要求验证码确认。修复优先级低。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-23 20:14 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  不好意思先生，礼物已经发放完毕了，请等待明年的12月23日，谢谢合作。    \n     2012-12-23 20:37 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @鬼魅羊羔 ... 哈哈，你的ipad啥时候到哇？    \n     2012-12-23 20:44 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @se55i0n 你觉得会给么？人家only_guest他们才给了个U盘，我估计最多也就是个企鹅。。。但愿不是年底给我个龙年吉祥物。。刚拿上，就蛇年了。。    \n     2012-12-23 20:52 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @鬼魅羊羔 哈哈，只要礼品都不错~    \n     2012-12-23 22:50 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @se55i0n 有刷分嫌疑啊    \n     2012-12-23 22:52 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @xsser 回大人，看到他们在发礼物~就找个洞洞发了撒，明鉴呀~    \n     2012-12-23 23:04 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @xsser 这个洞洞的防御绕过，还是经过了不少尝试的 -_-||    \n     2012-12-23 23:05 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @se55i0n =   =||    \n     2012-12-23 23:07 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @xsser 大人仔细看下图应该就知道了~    \n     2012-12-23 23:49 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @xsser 大人，我觉得此案有很多疑点，请大人允许卑职前往果壳，一探究竟。    \n     2012-12-24 09:16 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @鬼魅羊羔 ...    \n     2012-12-24 13:57 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  @鬼魅羊羔 @se55i0n 你说我们几个也搞个PKAV的那样来刷分怎么样？哈哈哈    \n     2012-12-24 14:13 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @疯子 我现在就等PKAV过来收我当倒水的呢。。。    \n     2012-12-24 14:15 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @鬼魅羊羔 坏淫，你要过来抢我饭碗...    \n     2012-12-24 14:40 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  @se55i0n 还好我去年就预定了送盒饭的位置。    \n     2012-12-24 14:46 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @疯子 哈哈~这可是个肥差呀~老实交代，是不是给@only_guest献菊花了-_-    \n     2012-12-24 17:26 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  @se55i0n 别这样，当初没有我的菊花，你们绝对不可能在乌云存活那么久。    \n     2012-12-24 17:27 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @疯子 你跟剑心还有和肾斗士三角关系。。。鉴定完毕。。    \n     2012-12-25 10:52 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @果壳传媒 厂商对待漏洞的态度值得赞一个~哈哈~能求个新年礼物不？    \n     2012-12-25 10:53 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @se55i0n 上果壳性情找啊    \n     2012-12-25 10:55 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @xsser 大人，你要表达什么意思啊？    \n     2012-12-25 13:24 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @se55i0n 你就不要问了，大人自有妙计，我等今后佳音便是。    \n     2013-01-12 20:02 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @鬼魅羊羔 真被你说重了 龙年企鹅 存货 哈哈    \n     2013-01-12 20:31 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @小胖胖要减肥 嗯，我怀疑我是乌鸦嘴。。    \n     2013-02-06 20:54 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @xsser 这个不算刷分吧？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}