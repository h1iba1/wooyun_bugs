{"id": 7942, "wybug_id": "wooyun-2013-035686", "wybug_title": "全方位绕过电脑安全管家", "wybug_corp": "腾讯", "wybug_author": "n0bele", "wybug_date": "2013-08-31 14:44", "wybug_open_date": "2013-11-29 14:57", "wybug_type": "非授权访问/认证绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-10-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-29：\t细节向公众公开  简要描述： 很久没玩bypass AV的游戏了,今天看了下. 详细说明：  最近几年rootkit、bootkit都不流行了，因为搞来搞去就是在比如何操内存.相对脚本而言就是调试门槛高了点，花样确实不怎么多.这次就不从常规的摘链、unhook、reload入手。那样就老套了.就从规则上绕过吧。自动添加到规则,绕过QQ杀毒扫描：QQPCMgr.exe调用了QMExt.dll里的函数操作C:\\Documents and Settings\\All Users\\Application Data\\Tencent\\QQPCMgr\\qmvext.db文件。测试方法:我们可以先本地生成一份规则，然后拷贝qmvext.db到目标机器上覆盖掉目标机器的qmvext.db.\n\n自动添加到规则,绕过QQ主动防御：QQPCMgr.exe调用QMCommon.dll里的函数操作,C:\\Documents and Settings\\All Users\\Application Data\\Tencent\\QQPCMgr\\QMConfig.dat相比较qmvext.db而言，QMConfig.dat是受到一定保护的，具体怎么写程序绕过我就懒得研究了，方法肯定有：）。手动测试:使用XueTr，打开磁盘解析功能操作文件将QMConfig.dat覆盖掉,查看规则生效了\n\n   漏洞证明：  已经描述得很清楚了吧.   修复方案：  他们更懂   版权声明：转载请注明来源 n0bele@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2013-09-03 11:08 厂商回复： 非常感谢您的反馈。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-31 20:11 |    \t\tn0bele \t\t\t( 普通白帽子  |\t\t\t        Rank:220 漏洞数:45        | 无耻最寂寞)\t\t \n  这个我以为你们不审核了已经提交腾讯了，撤掉吧？免得他们觉得我在骗分    \n     2013-09-03 11:59 |    \t\tliner \t\t\t( 普通白帽子  |\t\t\t        Rank:165 漏洞数:27        )\t\t \n  @n0bele 你别刷这种厂商了吧。。。 国内厂商的杀毒从来都是不杀毒的。。    \n     2013-09-03 12:05 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @liner 这是真相么    \n     2013-09-03 12:07 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  @liner 真相帝    \n     2013-09-03 12:09 |    \t\tn0bele \t\t\t( 普通白帽子  |\t\t\t        Rank:220 漏洞数:45        | 无耻最寂寞)\t\t \n  @liner 主要是国外的没礼物发，还得挨个下载测试所以懒得爆了.    \n     2013-09-03 23:38 |    \t\tACGT \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:4        | another script kiddie)\t\t \n  1rank。。腾讯这是在搞笑吗    \n     2013-09-05 14:33 |    \t\t萧然 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 喜欢一切美丽的东西！)\t\t \n  @n0bele感谢提供 不好意思 前期我在出差 运维的不懂事的确认了 我这就打电话让人事全面评审下员工基本素质    \n     2013-11-29 15:09 |    \t\tdpanda \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 0x41414141)\t\t \n  请教一下，楼主自己写的驱动去加载覆盖QMConfig.dat管家会拦截吗？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}