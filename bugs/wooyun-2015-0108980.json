{"id": 33146, "wybug_id": "wooyun-2015-0108980", "wybug_title": "优酷主站某接口撞库泄露用户登录凭据(绕过安全策略有批量账号证明)", "wybug_corp": "优酷", "wybug_author": "D＆G", "wybug_date": "2015-04-20 12:15", "wybug_open_date": "2015-06-05 18:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["撞库"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-05：\t细节向公众公开  简要描述： 撞库扫号攻击已经是Top 10 Security Risks for 2014之一.撞库以大量的用户数据为基础，利用用户相同的注册习惯（相同的用户名和密码），尝试登陆其它的网站。2011年，互联网泄密事件引爆了整个信息安全界，导致传统的用户+密码认证的方式已无法满足现有安全需求。泄露数据包括：天涯：31,758,468条，CSDN：6,428,559条，微博：4,442,915条，人人网：4,445,047条，猫扑：2,644,726条，178：9,072,819条，嘟嘟牛：13,891,418条，7K7K：18,282,404条，共1.2亿条。不管你的网站密码保护的多好，但是面对已经泄露的账号密码，撞库扫号防御还是一个相当重要的环节。 详细说明：      优酷主站登录接口没有防御撞库。对登录接口的调用没有进行限制。经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号这里这个问题是可以百分百复现的。就是首先保证当前ip是正常状态，就是登陆时候不需要输入验证码。然后撞库的时候，随机xff clientip 头，我直接用burpsuite插件，好几个头都随机了。就可以撞库。  但是估计优酷在何时出现验证码有好几个策略，所以测试过程中也出现一些问题。比如，一旦ip被标识为异常，开始出现验证码，再随机xff头也需要验证码。测试发现有时候跑个5000次左右，真实的ip会被标识为异常。因为黑盒测试，所以后端逻辑也没有搞的很清楚，有问题可以联系我。   漏洞证明：  经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号.目前互联网上公开的账号都有数亿的规模，真要被利用的话危害还是很大的。\n\nmask 区域\n*****sohu.com\t**********om\thuh**********.com\tbutj**********126.co**********3.com\t**********com\t49**********ail.com**********26.com\t**********com\tmqq**********.com\t**********.com\t**********com\twh1**********6.com\th**********cn.com**********3.com\t**********q.com\t**********l.com\t3**********@126.com\t**********3.com\t1**********com\t57**********3.com\t**********l.com\tl**********com\t136**********163.com**********.com\t84**********mail.com**********.com\th**********.com\t2**********m\twebo**********126.com**********com\t82**********.com\t20**********.com\tzh**********.com\t87**********com\t11**********63.com\tsz**********q.com\t**********6.com\t6**********163.com\t1**********163.com**********.com\tdar**********com\tcy**********cn.com**********o.com.cn**********3.com\t**********com\tb0**********1@163.co**********a.com\ts**********com\txu**********com\t19**********com\tx8**********.net\t6**********n.com\t1**********63.com\t1**********ail.com\t**********a.com\t4**********.COM\t1**********.com.cn\t**********.com\tmy**********63.com\ts**********hu.com\t**********edu.cn\t8**********com\t30**********q.com\t**********com\thdo**********3.com\t19**********63.com\t3**********om\t7762**********u.com\txu**********.com\t00**********6.com\t7**********26.com\t**********1cn.com**********cn.com\t**********1cn.com**********.com\t**********.com\t33**********ina.co**********se.com\t**********com\t69**********com\t833**********om\t817**********.com\t1**********om\t345**********.com\t**********3.com\tSw**********.com\t19**********com\tad**********com\t52**********com\tthi**********tmail.com**********n.com\t**********.com\tz**********163.com\t**********com\t12**********q.com\t**********com\t78**********l.com\tal**********n.com\t**********oo.com**********com\t139**********3.com\t1984**********ohu.com**********u.com\t5**********3.com\t1**********u.com\t**********.com\t8**********.com\t7**********ail.com\t**********a.com\tsta**********ina.com\t1**********3.com\ts**********a.com\tb**********om\t797**********3.net\tt**********.com\t7**********e.sh.c**********n\t8888**********163.com**********.com\tsu**********.com\t8**********63.com\t**********.com\ty**********com\tra**********3.com\t1**********ail.com\t**********.com\t8**********.net\twa**********ail.com**********com\tcu**********63.net\t**********163.com**********63.com\t**********.com\t**********3.com\t**********ina.co**********.com\tbi**********net\tro**********net\tjy**********.com\tzx**********om\txzc**********com\tta**********com\tlw**********.com\t**********com\txi**********com\t50**********sohu.com**********cod*****\n\n\n\n\n\n\n\n   修复方案：  撞库防御参考资料:http://stayliv3.github.io/2015/04/15/%E6%92%9E%E5%BA%93%E6%94%BB%E5%87%BB%E9%98%B2%E5%BE%A1%E6%96%B9%E6%A1%88/   版权声明：转载请注明来源 D＆G@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-04-21 18:30 厂商回复： 感谢关注优酷，漏洞修复中！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-20 13:41 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  求数据库呀    \n     2015-04-20 14:51 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  又是你啊，膜拜    \n     2015-04-21 18:48 |    \t\thackyandi \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:16        | 一个没有梦想的人)\t\t \n  又是你啊，膜拜    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}