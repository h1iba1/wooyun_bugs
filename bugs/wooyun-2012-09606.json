{"id": 18021, "wybug_id": "wooyun-2012-09606", "wybug_title": "自行注册用户可绕过柜台受理开通支付宝与财付通的快捷支付", "wybug_corp": "支付宝", "wybug_author": "路人甲", "wybug_date": "2012-07-13 14:24", "wybug_open_date": "2012-08-27 14:24", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-27：\t细节向公众公开  简要描述： 自行注册用户可绕过柜台受理开通支付宝与财付通的快捷支付，小额支付时仅需要验证手机短信。手机短信与账户无关。如此，将对资金安全产生威胁。 详细说明：     注册并登录中国邮政储蓄银行，点击申请开办->网上支付->签约加办，合同点同意。此时，假如没有在柜台开通网上支付业务，卡号是空的，只有一项“请选择”，但是，可以通过IE8或以上的 开发人员工具，对这个下拉选择列表的内容进行编辑，只在<option>中增加属性 value=\"卡号\"，其他按要求填写，这里请注意，手机可以任意填写，所以留下漏洞。填写完毕后点击提交，会要求输入支付密码，请正确输入，再提交，假如出现成功提交提示，即表示已成功操作。   漏洞证明：  \n\n\n\n假如需要更详细的账户信息，请直接联系我。   修复方案：  贵方一定比我懂。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2012-07-16 10:53 厂商回复： 该问题为银行端业务流程控制问题，我们已经告之银行，支付宝端签约不存在此问题。整个支付链的安全需要大家一起维护，感谢您的问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-13 14:27 |    \t\t风星剑仙 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 世界＆世界＝？永恒＋永恒＝？)\t\t \n  而且这个我提交的时候写的不是支付宝啊……写的是中国邮政储蓄……因为需要先到邮政储蓄发起申请，然后再在支付宝/财付通中更新，才算正式注册为快捷支付用户。主要问题是出在邮政储蓄这边的啊……    \n     2012-07-13 14:36 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @风星剑仙 你怎么用马甲额 支付宝会联系邮政的 这种问题一般是内部接口也有问题吧？    \n     2012-07-13 14:41 |    \t\t风星剑仙 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 世界＆世界＝？永恒＋永恒＝？)\t\t \n  @xsser 多谢，其实只要邮政做个简单的判定就好了啊，关接口什么事……完全没必要的嘛……    \n     2012-07-13 14:42 |    \t\t风星剑仙 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 世界＆世界＝？永恒＋永恒＝？)\t\t \n  @xsser 另外，嗯，悲剧的我360极速浏览器的Cookies出问题了，死活也登不了乌云，哭……我又不想清Cookies……再哭……    \n     2012-07-14 17:50 |    \t\tsaviour \t\t\t( 普通白帽子  |\t\t\t        Rank:188 漏洞数:29        | Saviour.Com.Cn 网站正在备案中)\t\t \n  @风星剑仙 这个问题 我觉得会被忽略的    \n     2012-07-20 12:02 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  财付通回复：我们完整复现了您所描述的流程，认为您提到的以下三个关键环节并不存在漏洞： 1）柜台没有开通网银的用户，通过输入卡号和取款密码等卡主才知道的信息在邮储网站上注册后，只能获得查询性质的功能，并不能开通支付相关的功能，虽然可以通过修改页面的方式强行提交卡号（无论和登陆的卡号一致还是不一致），但是银行会报“账号/卡号尚无权限进行此交易”，所以没有漏洞； 2）我们对柜台开通网银的用户和邮储网上注册的用户的修改手机进行了测试，发现在3个修改手机的入口，手机都不是随意修改的，短信验证码始终会发向开户时登记的手机；如果开户时没有登记手机或者原手机已经遗失，只能去柜台修改手机； 3）财付通目前不支持小额免支付密码，所以不存在小额免支付密码后依赖手机短信验证码的问题。 另外，借助此过程，我们也完整复核了邮储一点通签约全程的风险，确认在邮储侧和财付通侧均无可被利用的漏洞。 整个支付链的安全需要大家一起维护，感谢您的问题    \n     2012-07-20 12:50 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @xsser 咋会跑到财付通的？    \n     2012-07-20 13:02 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @horseluke 看标题    \n     2012-07-21 17:49 |    \t\tK1night \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        )\t\t \n  @xsser 我想上面那位写这个标题，阐述的主要内容是，网银自注注册账户（只有查询余额权限）可以绕过银行柜台的业务办理，开通支付宝和财付通的快捷支付。只是上面那位不了解快捷支付的流程，当前比较流行的快捷支付有两种验证方式，1短信验证 是在快捷支付渠道输入 银行卡资料 开户人姓名 开户人身份证号码 开户人卡号 开户人预留手机 提交以上完全无错误的资料预留手机会收到验证码，输入验证码无需ATM密码即可完成支付，2语音回拨电话验证 这种方式只需要卡号 身份证 和任意一个能接通电话的手机号码电话即可，在接收到支付渠道的语音声讯电话后根据提示音输入ATM密码完成支付。以上是快捷支付属于小额支付，还有一点通是第三方的支付平台帐号绑定银行卡一次，以后支付无需繁琐。现如今各大银行对这个银行卡的支付交易安全机制在各个不同的支付渠道以及不同的支付商户都会给与不同的支付限额。可以说只要知道卡号，密码，身份证，预留的手机号码，ATM. 卡不在身边，手机不再身边，一样会出现经济危机。只是走的除支付宝或财付通以外的第三方渠道。什么U盾 K宝，口令卡在那些网络小偷眼里都是浮云。    \n     2012-07-22 20:16 |    \t\t风星剑仙 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 世界＆世界＝？永恒＋永恒＝？)\t\t \n  @xsser 多谢财付通的回复，另外，我在测试的时候，并没有出现贵方所提到问题1：“账号/卡号尚无权限进行此交易”。我成功的强制提交，并且也成功的绑定了财付通账号，另外，我的卡也并没有通过柜台办理类似的业务，甚至包括网银和电话银行。但是，在查询时确实碰到了该问题，但是申请时却并不存在该问题。另外，申请时，在邮政页面上的手机是可以任意填写的。关于用户真实姓名的验证并没有做过类似的了解与调查，我当时想当然的认为可以通过办理快捷支付而直接成为实名认证的财付通。那么假使这样的话……    \n     2012-07-22 20:20 |    \t\t风星剑仙 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 世界＆世界＝？永恒＋永恒＝？)\t\t \n  @K1night 多谢你的理解    \n     2012-07-23 09:54 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @K1night 开户人预留手机？其实我一直在这个地方上犯迷糊。预留手机是指开户时填写的手机号，还是还要另外填写的？我有张卡，一直没能开通过快捷支付，就是提示没有填写预留手机号。如果现在开卡，这两个是合并处理的，那挺危险的...然后语音回拨，也是要预留手机号才成的么？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}