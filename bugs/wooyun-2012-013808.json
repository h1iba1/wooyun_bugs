{"id": 15882, "wybug_id": "wooyun-2012-013808", "wybug_title": "ThinkSNS又一个任意上传文件漏洞", "wybug_corp": "ThinkSNS", "wybug_author": "齐迹", "wybug_date": "2012-10-23 17:43", "wybug_open_date": "2012-12-07 17:43", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-10-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-10-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-11-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-11-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-07：\t细节向公众公开  简要描述： 某模块未对上传文件类型进行验证。可上传任意文件 详细说明：  之前看到有人找到一个任意上传的漏洞。所以看了一下。不知道是否和他的一致地址 WooYun: ThinkSNS 2.8 上传任意文件漏洞 代码产生位置apps\\wap\\Lib\\Action\\IndexAction.class.php263行\nif(!empty($_FILES['pic']['name'])) { // 自动发一条图片微博\t$data['pic']      = $_FILES['pic'];\t$data['content']  = '图片分享';\t$data['from']     = $this->_type_wap;\t$res = api('Statuses')->data($data)->upload();}\n未对文件类型过滤   漏洞证明：  访问wap 模块\n\n发一条微博并传图firebug 地址\n\n去掉small_然后访问http://================/data/uploads/2012/1023/17/50865d481c217.php   修复方案：  对上传类型要进行检查   版权声明：转载请注明来源 齐迹@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-10-27 22:34 厂商回复： 这个代码中确实存在，官网对格式判断遗漏的都已统一修复。不排除插件功能中还有，我们会加强测试。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-10-23 17:55 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  哥们神了……    \n     2012-10-23 23:21 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  @zzR 其实还有2处 上传问题 目前还在测试利用中    \n     2012-10-24 16:57 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  thinksns是要闹哪样？漏洞那么多fuck    \n     2012-10-24 21:20 |    \t\tyelo \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | yelo)\t\t \n  嗯确实还有, 是同样的原因。 上传写得有点乱, 为什么不统一接口呢    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}