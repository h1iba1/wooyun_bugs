{"id": 83482, "wybug_id": "wooyun-2015-0147717", "wybug_title": "东方财富网APP(1.2)可能导致数据泄漏（Android版）", "wybug_corp": "东方财富网", "wybug_author": "路人甲", "wybug_date": "2015-10-21 14:43", "wybug_open_date": "2016-01-19 16:00", "wybug_type": "用户敏感数据泄漏", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全", "手机软件安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-21：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-19：\t细节向公众公开  简要描述： 东方财富网APP（Android版）存在问题UXSS，攻击者构造特定的Intent Object，启动APP中的com.eastmoney.android.berlin.GuessActivity组件，执行任意的javascript脚本，获取本地敏感信息。 详细说明：  东方财富网APP客户端中GuessActivity Activity组件实现时，调用了默认的安卓系统WebView组件，其中webview组件中的loadurl中的url参数，是通过guessUrl传入的this.ACTIVITY_URL = paramBundle.getStringExtra(\"guessUrl\");该方法中的guessUrl参数是用户可控的，通过构造攻击参数，可以在本地文件域和任意的http域下执行任意的javascript脚本，造成任意敏感信息的读取。 利用符号链接，可以绕过文件同源性策略的限制，调用com.eastmoney.android.berlin.GuessActivity组件解析执行特定的JavaScript脚本，可以窃取任意私有文件的内容4.3以下系统，任意第三方app，不需要root权限，可以读取app私有目录（/data/data/com.eastmoney.android.washington/）下任意文件。 此外app还存在allowbackup漏洞   漏洞证明：  东方财富网APP客户端中GuessActivity Activity组件实现时，调用了默认的安卓系统WebView组件，其中webview组件中的loadurl中的url参数，是通过guessUrl传入的this.ACTIVITY_URL = paramBundle.getStringExtra(\"guessUrl\");该方法中的guessUrl参数是用户可控的，通过构造攻击参数，可以在本地文件域和任意的http域下执行任意的javascript脚本，造成任意敏感信息的读取。任意第三方app，不需要root权限，可以读取app私有目录（/data/data/com.eastmoney.android.washington/）下任意文件。 app目录\n\n获取数据库数据\n\n2.allowbackup漏洞 没有配置allowbackup=\"false\"，可导致用户帐户完全被复制备份应用数据adb backup -nosystem -noshared -apk -f com.eastmoney.android.washington.ab com.eastmoney.android.washington恢复数据adb restore com.eastmoney.android.washington.ab   修复方案：  1  对file域下符号链接进行限制2  allowbackup=\"false\"   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-01-19 16:00 厂商回复： 的确是个洞，但是根据业务场景基本没有影响。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}