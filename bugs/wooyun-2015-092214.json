{"id": 40196, "wybug_id": "wooyun-2015-092214", "wybug_title": "云锁本地权限提升漏洞", "wybug_corp": "云锁", "wybug_author": "HackBraid", "wybug_date": "2015-01-16 16:58", "wybug_open_date": "2015-04-02 10:23", "wybug_type": "权限提升", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["驱动权限提升"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-18：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向公众公开  简要描述： 多个因素导致本地权限提升 详细说明：  0x00 环境：1.apache+云锁；2.绕过云锁检查的大马DarkShell.php0x01 实战：首先，大马DarkShell.php连上后，由于是apache账户，权限较低然后我发现了云锁的更新程序：\n\n我将添加账户的useradd.exe改为YSUpdate.exe，而YSUpdate.exe是以管理员身份运行的远程端的管理员打开云锁后发现提示更新，这时用户信息如下：\n\n当管理员点击确定后，这时发现添加了账户test\n\n   漏洞证明：  0x00 环境：1.apache+云锁；2.绕过云锁检查的大马DarkShell.php0x01 实战：首先，大马DarkShell.php连上后，由于是apache账户，权限较低然后我发现了云锁的更新程序：\n\n我将添加账户的useradd.exe改为YSUpdate.exe，而YSUpdate.exe是以管理员身份运行的远程端的管理员打开云锁后发现提示更新，这时用户信息如下：\n\n当管理员点击确定后，这时发现添加了账户test\n\n   修复方案：  大马检测+文件运行前校验这次希望rank高点   版权声明：转载请注明来源 HackBraid@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-04-02 10:23 厂商回复： 感谢你一直关注我们的产品，并为我们持续改进提供动力，但是这个漏洞呢呢....怎么说呢。首先，得能绕过云锁的上传防护，将这个PHP文件上传上去。其次，云锁是有自身防护的，不存在文件被替换的可能。再次，云锁会限制网站进程的执行能力，就算能添加账户，也无法将这个账户增加到管理员组。我们后期会加入执行时的数字签名验证。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-18 23:32 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  1.云锁不能检测此类型大马2.替换文件没任何提示，表示可被替换3.这个添加账户不是用的网站进程，用的是云锁update.exe这个进程，该进程默认是管理员启动，所以不存在你说的问题    \n     2015-01-18 23:41 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @云锁 这么晚还不睡～那个大马用云锁的木马检测是测不出来的    \n     2015-01-19 12:05 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  @HackBraid 关注- -    \n     2015-01-19 16:14 |    \t\t椒图科技(乌云厂商)\t\t \n  @HackBraid hello,你看看替换文件的时候，是不是关闭了云锁的自保护呢，如有别的疑问，可联系Q76497333    \n     2015-01-21 11:41 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  替换成功了的？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}