{"id": 87532, "wybug_id": "wooyun-2016-0198385", "wybug_title": "华为手机更新包签名泄漏&amp;设计缺陷可网络欺骗刷入重新签名恶意ROM                                      ", "wybug_corp": "华为技术有限公司", "wybug_author": "路人甲", "wybug_date": "2016-04-20 08:35", "wybug_open_date": "2016-06-07 09:00", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-07：\t细节向公众公开  简要描述： 华为终端某测试软件泄漏releasekey，系统更新采用HTTP明文传输 详细说明：  1.华为手机Beta测试时提供的\n\nmask 区域\n*****aC*****\n\n内置releasekey(\n\nmask 区域\n*****pem.tes*****\n\n)，可用于签名自制更新包。\n\nmask 区域\n*****aC*****\n\n下载地址:\n\nmask 区域\n1.http://**.**.**/release/Hw*****_5.1.1.96.apk\n\n内置的releasekey\n\n2.华为手机更新检测时采用的是HTTP明文传输，可进行地址欺骗，检测更新过程通过filelist.xml取得更新包列表和文件md5，下载完毕后进行md5校验，可篡改，更新过程中recovery有对更新包进行签名校验可通过1中泄露的releasekey签名。例:\n\nmask 区域\n*****ata/files/p3/s15/G1146/*****\n\n   漏洞证明：  \n\nmask 区域\n*****aC*****\n\n内置的releasekey的证书指纹:\n\n通过\n\nmask 区域\n1.http://**.**.**/TDS/data/files/p3/s15/G1146/g104/v47803/f3/full/update.zip\n\n下载到的hota包内的CERT.RSA的证书指纹:\n\n   修复方案：  你们更专业。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2016-04-23 08:54 厂商回复： 非常感谢白帽子对华为公司安全的关注，我们已经将该漏洞通知了项目组，将会尽快整改该问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-20 08:49 |    \t\tDotaer \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:7        | 多学习，多挖洞！)\t\t \n  前排    \n     2016-04-20 08:52 |    \t\tSTCX \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:8        | 向大黑阔们致敬)\t\t \n  第二，第一次评论    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}