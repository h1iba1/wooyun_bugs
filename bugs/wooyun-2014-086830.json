{"id": 42077, "wybug_id": "wooyun-2014-086830", "wybug_title": "php云越权发面试邀请扣招聘者积分", "wybug_corp": "php云人才系统", "wybug_author": "Ader_duo", "wybug_date": "2014-12-12 14:58", "wybug_open_date": "2015-03-12 15:00", "wybug_type": "非授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-12：\t细节向公众公开  简要描述： 版本v3.1 9.23 1.控制邀请面试的参数也就那么几个，自己可以构造，无需登录可使招聘者向求职者发面试邀请。发面试邀请前提,每发一次扣去12积分。购买积分的时候1元=20个积分。 详细说明：  文件位置：/upload/model/ajax.class.php\nfunction sava_ajaxresume_action()\t{\t\t$data['uid']=(int)$_POST['uid'];//邀请面试人的uid\t\t$data['title']='面试邀请';\t\t$data['content']=iconv(\"utf-8\",\"gbk\",$_POST['content']);//邀请内容\t\t$data['fid']=$this->uid;\t\t$data['datetime']=time();\t\t$info['content']=$data['content'];\t\t$info['jobname']=iconv(\"utf-8\",\"gbk\",$_POST['jobname']);//邀请面试的职位\t\t$info['username']=iconv(\"utf-8\",\"gbk\",$_POST['username']);        $p_uid=(int)$_POST['uid'];\t\t$black=$this->obj->DB_select_once(\"blacklist\",\"`p_uid`='\".$p_uid.\"' and `c_uid`='\".$this->uid.\"'\");//查询面试人是不是在自己公司的黑名单\t\tif(!empty($black))\t\t{\t\t\t$arr['status']=8;\t\t\techo json_encode($arr);die;\t\t}\t\t$black=$this->obj->DB_select_once(\"blacklist\",\"`c_uid`='\".$p_uid.\"' and `p_uid`='\".$this->uid.\"'\");//查询公司在不在面试人的黑名单\t\tif(!empty($black))\t\t{\t\t\t$arr['status']=9;\t\t\techo json_encode($arr);die;\t\t}\t\tif(!$this->uid || !$this->username || $_COOKIE['usertype']!=2)//公司的uid，username都有值$usertype=2\t\t{\t\t\t$arr['status']=0;\t\t\techo json_encode($arr);die;\t\t}else{$umessage = $this->obj->DB_select_once(\"userid_msg\",\"`uid`='\".$p_uid.\"' AND `fid`='\".$this->uid.\"'\");//查询里面无\t\t\tif(is_array($umessage))\t\t\t{\t\t\t \t$arr['status']=7;\t\t\t}else{                               ：                               ：//前面条件满足才能发送面试邀请                         }\n综上：要想成功发邀请要满足的条件，1.互不在黑名单2.公司的uid，公司名称username都有值$usertype=23.个人的uid-面试人uid：注册时按照注册先后顺序自增的值，username-面试人姓名，jobname-申请职位自己构造包且在无用户登录状态登录公司账户查看   漏洞证明：  1.先来查看下已邀请面试人才\n\n看下公司的积分\n\n2.未登录状态，构造post包，Replay\n\n3.登录账户查看有没发送面试请求成功\n\n看下目前的积分\n\n4.少了12积分，也多了一人是用户名为11且申请职位为2222。   修复方案：  多加些靠谱的参数。   版权声明：转载请注明来源 Ader_duo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-12-12 15:01 厂商回复： 感谢您的提供，我们会尽快修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}