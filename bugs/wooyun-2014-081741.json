{"id": 48767, "wybug_id": "wooyun-2014-081741", "wybug_title": "说好的机锋网getshell来了（再次影响机锋网主要业务）", "wybug_corp": "机锋网", "wybug_author": "鸟云厂商", "wybug_date": "2014-11-02 16:39", "wybug_open_date": "2014-12-17 16:40", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["补丁不及时"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-17：\t细节向公众公开  简要描述： 我的滑板鞋时尚时尚最时尚 详细说明：  #1 漏洞成因捕捉到如下网址存在struts2命令执行漏洞，且可以成功利用http://v5op.apk.gfan.com/index.actionWEB目录/home/tomcat8088/webapps/ROOT/直接GETSHELL，ROOT权限\n\n\n网站物理路径： /home/tomcat8088/webapps/ROOT/java.home: /usr/lib/jvm/java-6-sun-1.6.0.26/jrejava.version: 1.6.0_26os.name: Linuxos.arch: amd64os.version: 2.6.35-22-serveruser.name: rootuser.home: /rootuser.dir: /home/tomcat8088java.class.version: 50.0java.class.path: /home/tomcat8088/bin/bootstrap.jarjava.library.path: /usr/lib/jvm/java-6-sun-1.6.0.26/jre/lib/amd64/server:/usr/lib/jvm/java-6-sun-1.6.0.26/jre/lib/amd64:/usr/lib/jvm/java-6-sun-1.6.0.26/jre/../lib/amd64:/usr/java/packages/lib/amd64:/usr/lib64:/lib64:/lib:/usr/libfile.separator: /path.separator: :java.vendor: Sun Microsystems Inc.java.vendor.url: http://java.sun.com/java.vm.specification.version: 1.0java.vm.specification.vendor: Sun Microsystems Inc.java.vm.specification.name: Java Virtual Machine Specificationjava.vm.version: 20.1-b02java.vm.name: Java HotSpot(TM) 64-Bit Server VMjava.specification.version: 1.6java.specification.name: Java Platform API Specificationjava.io.tmpdir: /home/tomcat8088/temp\n读取/root/下的mysql_history\nCHANGE MASTER TO MASTER_HOST='10.*.*.163', MASTER_USER='r**l', MASTER_PASSWORD='A*****h', MASTER_LOG_FILE='mysql-bin.000672', MASTER_LOG_POS=536449400;start slave;\n读取.bash_history\nscp w*****g@10.*.*.169:/home/weitong/software/replace.jar .\n/backup/目录下有整个运营后台的源代码备份\n\n配置文件里找到cookie的加密方式和密钥\n// Referenced classes of package com.gfan.appmarket.util://\t\t\tAESpublic class CookieUtil{\tpublic static final String COOKIE_NAME = \"admin_passport\";\tpublic static final String COOKIE_AES_KEY = \"L9FMH******1jQv\";\tpublic CookieUtil()\t{\t}\n之前的数据库泄露漏洞，粗略看过一部分admin_user表。后台密码应该是加密存储在数据库中的。怎么进后台呢？在对后台的测试中，我找到一个密码为123456的用户。但是只能登录，没有任何权限。看了看工具提供的history，当中有一个跳转是从index.jsp到index.action。就冲index.jsp下手，插入XSS代码。（所有登录用户在通过登录验证后必然通过这个页面跳转到后台）cookie很快到手\n\n进入后台\n\n影响机锋网运营主要业务，谁的APP想被推荐请打我电话12345678901。服务器信息：\nLinux ubuntu181 2.6.35-22-server #33-Ubuntu SMP Sun Sep 19 20:48:58 UTC 2010 x86_64 x86_64 x86_64 GNU/Linux\n\nDistributor ID:\tUbuntuDescription:\tUbuntu 12.04.4 LTSRelease:\t12.04Codename:\tprecise\n厂商请注意，这台服务器还存在bash漏洞。\n[/home/tomcat8088/webapps/ROOT/]$ env x='() { :;}; echo vulnerable'  bash -c \"echo this is a test\"vulnerablethis is a test\n鉴于是root权限，提权---内网渗透---更多机器沦陷。对Linux提权还没那么熟练，测试到此为止。   漏洞证明：     修复方案：     版权声明：转载请注明来源 鸟云厂商@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-11-02 19:17 厂商回复： 谢谢提交，修复中。。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-02 16:55 |    \t\tNoxxx \t\t\t( 普通白帽子  |\t\t\t        Rank:509 漏洞数:41        )\t\t \n  回家的路上我情不自禁    \n     2014-11-02 16:56 |    \t\tzcy \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:15        )\t\t \n  大神你还穿滑板鞋了？    \n     2014-11-02 19:17 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @Noxxx 摩擦摩擦    \n     2014-11-02 20:11 |    \t\t1c3z \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:29        | 我读书少，你可别骗我！！！)\t\t \n  摩擦 摩擦,在这光滑的地上摩擦,一步两步一步两步,一步一步似爪牙,似魔鬼的步伐    \n     2014-11-02 20:52 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  摩擦摩擦，摩擦摩擦，在@VIP 的身上摩擦~    \n     2014-11-02 23:09 |    \t\tDebug0man \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | 叽叽呗呗...)\t\t \n  我等了十年的滑板鞋，果断让我不淡定了。    \n     2014-11-03 09:51 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  似魔鬼的步伐，摩擦摩擦，在这光滑的地面摩擦。    \n     2014-11-03 10:19 |    \t\twebsec80 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 关注网络安全)\t\t \n  话说4月份我都已经getshell       \n     2014-11-03 15:03 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @websec80 哟喂 牛逼得掉渣哟,    \n     2014-12-17 18:46 |    \t\t老胖子 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        )\t\t \n  niubi    \n     2015-07-31 14:00 |    \t\t西西 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:7        | 走过路过不会错过！)\t\t \n      \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}