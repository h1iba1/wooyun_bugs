{"id": 79571, "wybug_id": "wooyun-2015-0157811", "wybug_title": "浩森时贷后台逻辑错误（个人信息/手机号/贷款额度等泄露）", "wybug_corp": "浩森时贷", "wybug_author": "我有六块腹肌", "wybug_date": "2015-12-03 21:45", "wybug_open_date": "2016-01-22 11:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(广东省信息安全测评中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "认证设计不合理", "上传过滤不严格"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-22：\t细节向公众公开  简要描述： 今天下班公司门口销售MM给我发广告单~~发现是浩森时贷的广告单，于是小试牛刀里面发现一些信贷的个人信息比如信贷额、手机号码什么的其实我本来只是想进去找找玲玉MM的照片的 详细说明：  本来想选的是后台弱口令，可是事实上是我并没有使用正确的密码，也没有用类似SQL注入的方式去绕过就登陆了。感觉写这个系统，至少是登陆系统的哥们应该是个初学web开发的学生吧。详细见证明吧＝＝＝＝＝＝　　　　　　　　　　　||　　　　　　　　　　　||　　　　　　　　　　　||　　　　　 　　 　　　\\/   漏洞证明：  0x01 缘起一张销售MM的广告单下班有一个长得还不错的MM给我发了一张广告单，心想要是能找到MM的照片就好了，于是我找到了后台：http://**.**.**.**/manage/sign_in\n\n0x02 本以为密码很难简单的分析后，发现首先验证码是固定的，可以暴力破解。暴力破解前先试几个弱口令。这里发现常见的弱口令和sql注入都不能攻破。后来不知道怎么刷新以后登录成功了，我都瞎了。。。于是看了页面的源码，其中一段如下：\nvar username=$.trim($(\"#username\").val());            var password=$.trim($(\"#password\").val());            var v_code=$.trim($(\"#v_code\").val());            $.ajax({                type: \"post\",                url: \"/manage/login\",                async:false,                data: {\"username\":username,\"password\":password,\"v_code\":v_code},                success: function(result){                \tvar s = result.result_a;\t\t\t\t\tif(s==\"登录成功\"){\t\t\t\t\t\tlocation.href=\"/manage\";//location.href实现客户端页面的跳转  \t\t\t\t\t}else{\t\t\t\t\t\talert(s);  \t\t\t\t\t}                    }            });\n发现本地有一个跳转，我就考虑是不是只要从登录界面跳转过来就ok了，根本不用输密码什么的。于是删除后台链接中的sign_in直接回车，登录成功（小学生后台逻辑...）。\n\n里面有一些个人数据信息，这是其中一部分：\n\n0x03 本想上传shell本来是想上传一个shell的可惜上传一个shell链接出错一次就会锁定大约一个小时，所以。。。不过最终我发现在上传图片的地方，可以通过绕过的方式（在.jsp后面加一个空格），上传一个.jsp文件。\n\n最终目录在**.**.**.**/udeImage/2015/12/20151202*****.jsp这里。上传之后这个目录应该是可以执行的，因为我执行后直接报了Java的错误，不过我现在被锁定了不能确认。   修复方案：  先把后台改了，设置一个不用登陆就可以访问的后台我也是醉了。。。后台图片上传过滤不严格导致可以上传shell给我介绍个销售MM吧~~   版权声明：转载请注明来源 我有六块腹肌@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-12-08 14:42 厂商回复： 非常感谢您的报告。报告中的问题已确认并复现.影响的数据：高攻击成本：低造成影响：高综合评级为：高，rank：10正在联系相关网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}