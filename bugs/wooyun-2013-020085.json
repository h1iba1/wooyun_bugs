{"id": 13172, "wybug_id": "wooyun-2013-020085", "wybug_title": "国家交通运输部某直属单位网站任意文件上传漏洞，导致拿shell被黑", "wybug_corp": "某交通部", "wybug_author": "非米特尼克", "wybug_date": "2013-03-15 12:10", "wybug_open_date": "2013-04-29 12:11", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "配置不当", "国家某交通部", "被黑", "完整渗透"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-04-29：\t细节向公众公开  简要描述： 无意中发现国家某交通部官网存在目录遍历漏洞，由此渗透出~~~最终导致被黑，详见漏洞证明。 详细说明：  交通运输部规划研究院官网(www.tpri.gov.cn)存在诸多漏洞，导致最终成功获取webshell与系统用户，过程如下：1、首先通过google发现该站存在目录遍历漏洞;2、再者通过目录遍历漏洞了解系统相关结构，从中发现本系统有使用FCKeditor网页编辑器，经测试该版本过低，存在上传漏洞；3、因上传目录可执行脚本，最终成功拿到webshell，可操作C、E盘，在线执行CMD命令、连接ORACLE数据库（数据库连接密码竟然还是弱口令）；4、通过webshell成功添加wooyun用户，因时间关系未进行远程登录测试；5、最后还发现，该系统存在struts2 远程执行漏洞，非常严重~~~文字描述就到这里吧，详见下图片。   漏洞证明：  1、目录遍历漏洞\n\n\n\n2、FCKeditor上传漏洞\n\n3、获取webshell\n\n4、通过webshell添加用户（远程登录未验证）\n\n\n\n5、通过webshell在线链接和执行数据库（远程链接未验证）\n\n6、通过webshell操作硬盘资料\n\n7、struts2 远程执行漏洞截图\n\n   修复方案：  1、正确配置中间件，上传目录不允许执行脚本；2、升级FCKeditor网页编辑器；3、WEB服务器的配置文件进行加密；4、增强数据库密码的复杂度；5、升级中间件，避免struts2 远程执行漏洞；本文就到此，希望贵单位赶紧修复，以后多加注意。希望全民重视信息安全，避免我们成为电子信息战的傀儡。   版权声明：转载请注明来源 非米特尼克@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2013-03-19 21:39 厂商回复： CNVD确认并复现所述情况，正按流程拟上报国家上级信息安全协调机构，由其联系网站管理方所在部委信息化管理部门处置。按多个漏洞进行评分,rank=6+6=12 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}