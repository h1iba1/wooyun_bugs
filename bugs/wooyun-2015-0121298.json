{"id": 9013, "wybug_id": "wooyun-2015-0121298", "wybug_title": "中国联通某省分公司综合运维系统沦陷(涉及联通全省员工信息+大量企业订单信息+无法言尽的内部信息)已Getshell", "wybug_corp": "中国联通", "wybug_author": "几何黑店", "wybug_date": "2015-06-18 09:22", "wybug_open_date": "2015-08-07 08:42", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄漏", "渗透测试思路", "内部敏感信息泄漏", "运维管理不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-07：\t细节向公众公开  简要描述： 目录遍历越权+JBOSS 代码执行+tomcat中间件弱口令+用户弱口令+未授权访问+获取所有用户密码应该是记全了,也有可能没记全的 详细说明：  首先,通过搜索引擎搜索到http://61.241.82.144/这个IP,看这个系统的名字就觉得高大上.于是开启nmap扫一下端口,发现381这个端口是jboss的,那么利用jboss的getshell方法来拿个shell,乌云随便一搜就大把的案例, 由于篇幅有限,这里就不赘述了.拿到http://61.241.82.144:381/upload5warn/index_bak.jsp\n\n\n\n\n\n可以看到在内网,应该是内网有多台服务器,映射了端口出来.还是ROOT权限翻了很久,也只翻到一些数据库信息,试了很久,也没连上.\n\n这里先不管他了,我们来看其他的HTTP端口.http://61.241.82.144:2585/tomcat中间件弱口令admin/admin那就再传个SHELL上去吧,看看这个端口是哪台内网机器\n\n\nhttp://61.241.82.144:2585/exp/ashura.jsp\n\n\n是台WINDOWS的系统\n\n翻了很久,也是没发现可深入利用的,再次放弃.回到运维系统的登录界面,试了SQL注入,也没跑出来,就随便手工试了几个默认的管理员密码,可是都不成功,但其中有一次密码错误回退登陆框的时候出现了系统内部的界面,很奇怪,多试了几次以后,发现能够把页面停止,不让它跳转回登录界面,但这时已经看到系统长什么样子也是一种安慰吧,习惯性看了一下框架源代码.发现有个文件地址可以直接访问.\n\n\nhttp://61.241.82.144:2181/WebApp/emoss/getMessages.jsp#none\n是个公告的页面,而且附件还可以下载\n\n下个运维系统说明文档看看,说不定能有些默认的用户名密码之类的.\n\n果然,有张图里有几个用户名,这下终于知道管理员长什么样子了.试了几个用户弱口令都不对,最后抱着试最后一个,不对,就算了.谁知道,还真猜中了.zhugejing/zhugejing123功夫不负有心人啊,终于是进来了   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n虽然涉及到非常多的信息了,但是总觉的少了点,因为这个账户的权限比较低,还有很多看不了,看来只有拿到系统管理员权限的账号才行了.继续找了1个小时,发现了目录遍历\nhttp://61.241.82.144:2181/WebApp/emoss/files/account/\n试了几个文件,都是可以未授权访问,直接可以访问页面的内容.http://61.241.82.144:2181/WebApp/emoss/files/account/ifAAUserApplyGrid.jsp找到用户管理的页面,这个应该是管理员权限才可以访问的.但有个问题是不登录任何用户的情况下,只能看到\n\n这个页面,并不能编辑用户,提示没有登录.那我们就去登录一下前面获得的用户\n\n从源代码里,可以直接查看到用户的密码\n\n\n\n\n\n试了几个账户,都能正常登录系统,系统管理员账户终于进来了.\n\n\n\n8000多员工信息,人事管理资料,大客户资料,大客户订单合同信息,终于是全部弄完了,好累,从下午一直到凌晨4点才全部弄完,光写这个报告,就写了2个多小时.   修复方案：  你懂的   版权声明：转载请注明来源 几何黑店@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-06-23 08:40 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国联通集团公司通报,由其后续协助网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-18 10:01 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:19        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  几何大哥  求别打码。。。我也找到一个后台，，，就差帐号和密码呢。。。。    \n     2015-06-18 10:24 |    \t\t几何黑店 \t\t\t( 核心白帽子 |\t\t\t        Rank:1527 漏洞数:231        | 我要低调点儿.......)\t\t \n  @’‘Nome 已打码    \n     2015-06-18 10:31 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:19        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  @几何黑店 你不打码 我们还是好基友。。。。    \n     2015-06-18 21:43 |    \t\twe8_ \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:7        | 嗯。)\t\t \n  @几何大哥，能否留个联系方式啊？    \n     2015-08-07 08:48 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  功夫不负有心人    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}