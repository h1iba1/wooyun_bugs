{"id": 46442, "wybug_id": "wooyun-2015-090898", "wybug_title": "微信红包随便领(发家致富奔小康，日薪百万不是梦)", "wybug_corp": "腾讯", "wybug_author": "only_guest", "wybug_date": "2015-01-09 21:37", "wybug_open_date": "2015-02-23 21:38", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "客户端程序设计错误", "手机应用", "搞笑有爱"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-23：\t细节向公众公开  简要描述： 团队的小伙伴们总让我发红包给他们，发了几千块还不满意！就找个漏洞来给他们发红包吧！自己手工测试了下。一分钟领了200块的红包，也还算不错吧。估计写成程序一天几百万不是问题！发家致富奔小康就靠你了！战斗吧！微信红包！ 详细说明：  微信红包领取页面URL：https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx6fa7e3bab7e15415&redirect_uri=https://wxapp.tenpay.com/v2/hybrid/www/weixin/hongbao/receive.shtml?showwxpaytitle=1&sendid=1000000000201501092047478999&channelid=1&msgtype=1&from=singlemessage&isappinstalled=0&us=***********&ver=1&sign=***********&clientversion=26000238&devicetype=android-19&pass_ticket=***********&timeguid=14207873040300.4459930493030697&response_type=code&scope=snsapi_base&state=STATE&connect_redirect=1#wechat_redirect上面的URL是我们领取红包时的URL。地址中的sendid是对应的红包ID下面的星号是我的身份信息，所以我屏蔽了。sendid前面10位是固定的，中间是日期，后面10位是红包ID只要去遍历后面的10位ID就可以随意领取其他人的红包了！我遍历了40个ID，下面是一些成功截图：\n\n\n\n\n\n\n\n不小心领了一个兄弟发给他朋友的结婚红包，实在是。。。。腾讯帮我把钱还给他！！！然后大家可能觉得不过瘾，我们来批量探测红包是否存在。\n\n既然已经可以重放了，干脆写个程序自动领吧！\n\n我发了888个包来遍历红包。一共212个红包是存在可以领取的。先截个我的钱包余额截图：\n\n程序跑了几分钟后！\n\n   漏洞证明：  \n\n   修复方案：  你们懂得！   版权声明：转载请注明来源 only_guest@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-01-11 22:54 厂商回复： 非常感谢您的报告。这个问题我们已经确认，正在与业务部门进行沟通制定解决方案。如有任何新的进展我们将会及时同步。 最新状态： 2015-03-05：已经在漏洞报告当天修复漏洞，感谢关注  ", "replys": "漏洞评价：\n评论\n     2015-01-09 21:41 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  东，你来激活核心+打卡    \n     2015-01-09 22:55 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  是啊，一般小漏洞又懒得发    \n     2015-01-09 22:58 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  为毛还是普通？    \n     2015-01-09 23:40 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  20分钟之后你就是核心了    \n     2015-01-10 09:02 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  我等了一晚上，你是欺负我不识字？还是普通    \n     2015-01-11 22:57 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  厉害！    \n     2015-01-11 23:00 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  CCTV，这里    \n     2015-01-11 23:00 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  要火，mark～～～～～    \n     2015-01-11 23:00 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  上面全是大牛啊。。    \n     2015-01-11 23:13 |    \t\t红客十年 \t\t\t( 普通白帽子  |\t\t\t        Rank:334 漏洞数:63        | 去年离职富士康，回到家中上蓝翔，蓝翔毕业...)\t\t \n  都是大牛……抢个位置    \n     2015-01-11 23:13 |    \t\t炯炯虾 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我来自地球)\t\t \n  改个参数当然算普通啦    \n     2015-01-11 23:25 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  大牛们又出来冒泡了    \n     2015-01-11 23:27 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  又是一个会玩微信的大牛    \n     2015-01-11 23:32 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  哈哈，还是普通    \n     2015-01-11 23:37 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  难过群里大家都说“张瑞冬复活了！！！！”    \n     2015-01-11 23:41 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  这个屌    \n     2015-01-11 23:59 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  CCAV  Here！    \n     2015-01-12 00:02 |    \t\t牧马 \t\t\t( 普通白帽子  |\t\t\t        Rank:107 漏洞数:17        | 我是要成为猪猪侠的男人。。。。)\t\t \n  哇,上面全是大牛,好紧张...    \n     2015-01-12 00:03 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  膜拜ing    \n     2015-01-12 00:20 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  我勒个来啊-_-#    \n     2015-01-12 00:30 |    \t\t3King \t\t\t( 普通白帽子  |\t\t\t        Rank:1129 漏洞数:92        | 【study at HNUST】非常感谢大家的关注~ 大...)\t\t \n  啤酒饮料矿泉水 花生瓜子八宝粥 脚让一让勒~    \n     2015-01-12 06:30 |    \t\t香草 \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:14        | javascript,xss,jsp、aspx)\t\t \n  红包红包    \n     2015-01-12 08:00 |    \t\tcold \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 生命不息，折腾不止。)\t\t \n  上头条来了    \n     2015-01-12 08:05 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  不能激活该核心白帽子称号，请在短时内进行充值。谢谢合作    \n     2015-01-12 08:12 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  好叼。    \n     2015-01-12 08:20 |    \t\tredsin \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:6        )\t\t \n  赶紧留名。CCTV CNTV XXTVi am here另外 膜拜大神    \n     2015-01-12 08:29 |    \t\t炊烟 \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:44        | 每一天都需要努力。)\t\t \n  红包红包    \n     2015-01-12 09:16 |    \t\t闪电小子 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:5        | PKAV技术宅社区！---闪电小子！)\t\t \n  几千块的红包呢！！！    \n     2015-01-12 09:58 |    \t\t香草 \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:14        | javascript,xss,jsp、aspx)\t\t \n  表示没看到几千块的红包    \n     2015-01-12 10:03 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  是核心啊，可能跑的慢一点    \n     2015-01-12 10:06 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  红包呢？    \n     2015-01-12 10:22 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @xsser  看来是有新闻早就报告过了？http://business.sohu.com/20140208/n394624353.shtml?qq-pf-to=pcqq.discussion1年过去了。。不知道是否有人利用这个漏洞已经成为千万富翁了。    \n     2015-01-12 10:23 |    \t\t伟大娃娃 \t\t\t( 普通白帽子  |\t\t\t        Rank:130 漏洞数:10        | 改变世界)\t\t \n  @gainover 二哥注意队形!几千块的红包呢！！！    \n     2015-01-12 10:28 |    \t\t闪电小子 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:5        | PKAV技术宅社区！---闪电小子！)\t\t \n  @gainover 如果真如新闻所说，那不得了。千万富翁也是分分钟的事情。。上亿才恐怖。    \n     2015-01-12 10:31 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  二哥注意队形! 几千块的红包呢！！！    \n     2015-01-12 12:04 |    \t\t晶晶妹 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 安全宝代言人)\t\t \n  红包。。。。    \n     2015-01-12 14:17 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  我去。。。好NB！    \n     2015-01-12 15:55 |    \t\t小火苗 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 我是一只小火苗呀，春风吹又生呀...)\t\t \n  几千块的红包！    \n     2015-01-12 16:25 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  洞主已成为百万富翁，即将赢取白富美，走上人生巅峰。国家政策允许先富带动后富，下次还有这样的事请带上我    \n     2015-01-13 09:43 |    \t\tjeary \t\t\t( 普通白帽子  |\t\t\t        Rank:296 漏洞数:106        | (:‮.kcaH eb nac gnihtynA))\t\t \n  红包在哪..    \n     2015-01-15 10:28 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:71        | I'm Me_Fortune)\t\t \n  【微信红包被指存在技术漏洞，安全性受质疑】一名用户通过绑定银行卡往微信红包系统支付了100元，但让她生气的是，两位朋友没有收到红包，而她银行卡的钱却已经被划走了。“我给朋友发了两次，朋友都说没有收到款项‘。还有人指微信红包存在技术漏洞，会误将绑定的银行卡及红包提现记录错发给好友。——洞主不给我红包就报警    \n     2015-01-15 11:25 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  握了颗草    \n     2015-01-15 14:23 |    \t\tGrayTrack \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:14        | 灰色轨迹)\t\t \n  钱只是数字而已    \n     2015-01-15 15:21 |    \t\t大亮 \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:65        | 慢慢挖洞)\t\t \n  我去，时隔一年多，我终于看到only_guest又发洞了，好激动啊    \n     2015-01-15 15:26 |    \t\t大亮 \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:65        | 慢慢挖洞)\t\t \n  看到这个 我像知道og大神得到奖励了吗http://security.tencent.com/index.php/announcement/msg/67    \n     2015-01-15 15:33 |    \t\tsdj \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:6        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @大亮 2、       漏洞未在外部公开，且需要提供可用的Exploit3、       通过腾讯“安全漏洞反馈平台”提交    \n     2015-01-15 19:24 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:71        | I'm Me_Fortune)\t\t \n  @浅蓝 大牛你好，请来一分钟禁言套餐 =。=    \n     2015-01-15 19:35 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  @Me_Fortune Me_Fortune被管理员禁言1分钟    \n     2015-01-20 16:44 |    \t\thack2012 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:3        | 关注信息安全 http://www.waitalone.cn/)\t\t \n  大牛们，收徒弟不呀？    \n     2015-01-21 15:46 |    \t\tWinck \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | http://weibo.com/hackwinck hackwinck  By...)\t\t \n  100哭爱都不给我    \n     2015-01-22 17:34 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  我去，发家致富啊    \n     2015-01-29 18:13 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  @wefgod 嗯。我已经富了！你要不要一起！    \n     2015-01-29 18:20 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  @大亮 嗯。他们好多人都在微信，QQ，微搏上感谢我呢。这个奖励够不？    \n     2015-01-31 23:48 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @only_guest 微信领取红包是http传输？直接burp可以抓到？怎么记得微信和QQ都是socket啊    \n     2015-02-02 21:16 |    \t\t伟大娃娃 \t\t\t( 普通白帽子  |\t\t\t        Rank:130 漏洞数:10        | 改变世界)\t\t \n  @px1624 本来是socket的,张主任用意念改变了它.    \n     2015-02-02 23:03 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @伟大娃娃 。。。看他截图burp可以抓到啊    \n     2015-02-06 14:24 |    \t\t小乐天 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:14        | From KnownSec)\t\t \n  @only_guest 发家致富就靠你了    \n     2015-02-10 23:56 |    \t\tgoubuli \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:61        )\t\t \n  这个真正是太吊了，腾讯应该给洞主3个$    \n     2015-02-11 21:42 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  。。。这要提现 TX会给提吗    \n     2015-02-12 10:20 |    \t\tpapaver \t\t\t( 普通白帽子  |\t\t\t        Rank:197 漏洞数:35        | 95后，高一学生一枚... 萌萌哒..)\t\t \n  吼吼，棒棒嗒    \n     2015-02-12 11:15 |    \t\txsser_w \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:33        | 哎)\t\t \n  你是怎么抓到那个URL的阿？    \n     2015-02-17 03:39 |    \t\t世纪缘 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | 专注无线网络安全！)\t\t \n  求个红包！    \n     2015-02-17 16:36 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  @xsser_w 电脑上装安卓模拟器？    \n     2015-02-23 22:20 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n      \n     2015-02-24 11:11 |    \t\t刘海哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:114 漏洞数:28        | 索要联系方式但不送礼物的厂商定义为无良厂...)\t\t \n  不说了我自己手动抢得眼睛块没用了！还没人家几分钟...    \n     2015-02-24 14:54 |    \t\t无 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | null)\t\t \n  过年抢红包的时候，产生过遍历红包id这个想法，感觉这么简单的漏洞不该存在啊    \n     2015-02-24 20:48 |    \t\t一纸情书 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:5        | 专注信息安全.)\t\t \n   求红包嘛大黑阔- -    \n     2015-02-25 20:11 |    \t\tCacker \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:6        | 小菜鸟。大神见笑了。)\t\t \n  这个叼啊，刷钱啊。    \n     2015-02-26 14:03 |    \t\tTank \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:21        | 专注于白帽子渗透测试)\t\t \n  这个牛    \n     2015-02-28 14:47 |    \t\trrrfff \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:2        | 核心黑帽子 | Rank:-100 漏洞数:0)\t\t \n  类似的漏洞中国移动的流量红包也有    \n     2015-02-28 15:04 |    \t\trrrfff \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:2        | 核心黑帽子 | Rank:-100 漏洞数:0)\t\t \n  <img src=\"http://static.wooyun.org/wooyun/upload/201501/09180921fb7a8bb1f1151ef5d6d7a9389eccf217.jpg\" alt=\"\" />    \n     2015-03-05 16:50 |    \t\tYinkan \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 码农)\t\t \n  碉堡    \n     2015-03-05 18:27 |    \t\thellokuku \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        )\t\t \n  火前留名。。。    \n     2015-03-05 20:16 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  从这个漏洞可以看出，“非常感谢您的报告。这个问题我们已经确认，正在与业务部门进行沟通制定解决方案。如有任何新的进展我们将会及时同步。”，腾讯的“及时”同步真的只是个“敷衍”而已。    \n     2015-03-06 08:39 |    \t\tsaga \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 世界上只有10种人，懂二进制的，和不懂二进...)\t\t \n  火速围观  不知道cctv还能不能看到这里！    \n     2015-03-06 10:17 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  @gainover 你又说实话！    \n     2015-03-06 11:50 |    \t\tSofia \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:6        | 不会渗透的SEOer不是好站长)\t\t \n  我尼玛，我的致富梦就这么破灭了吗    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}