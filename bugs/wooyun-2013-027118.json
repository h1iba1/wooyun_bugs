{"id": 10719, "wybug_id": "wooyun-2013-027118", "wybug_title": "百度搜索域名伪装和劫持搜索结果", "wybug_corp": "百度", "wybug_author": "NULL0", "wybug_date": "2013-06-28 18:02", "wybug_open_date": "2013-08-12 18:03", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["跳转", "安全策略绕过", "跳转导致钓鱼"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-12：\t细节向公众公开  简要描述： 当通过百度搜索页面列表进入其他网站时候,其他网站可以写入代码控制劫持百度搜索页面成功替换成自己的页面,从而钓鱼或进行非法行为(当然更多的是伪造搜索了..) 详细说明：  无趣见突然发现了这么个玩意,在百度从搜索 '泡沫尿' \n\n点击www.xywz120.com 的网站就能进入了,但发现了猫腻..如图\n\n百度搜索主页被劫持了,而且还劫持的真像http://www.baidu.com.whmsyy.net/ ....而搜索内容当然也都换成了自己的网站相关内容(武汉名仕医院)..不在意的话完全看不出来...   漏洞证明：  本以为是百度推广存在xss,经过分析之后发现不是,而是攻击发起在新打开的网站,看图就明白了\n\n原来是在自己页面用了window.opener操作了百度搜索页面...同样我自己测试了一把百度搜索http://www.malaso.com ,点击进去,百度搜索页面直接变谷歌额...如图\n\n   修复方案：  这个问题不应该犯额..... 当打开域外地址的时候使用打开的其他域网站不应有本网页权限.用<a href=\"js:window.open(\"url\").opener=null;void 0;\">open</a> 替换直接href就行   版权声明：转载请注明来源 NULL0@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2013-07-01 16:05 厂商回复： 已知问题，我们反馈给业务部门！谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-28 18:31 |    \t\trandom_ \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:50        | 推动开源推动网络安全)\t\t \n  把人家黑了，这叫什么搜索伪造。。。。    \n     2013-06-28 18:32 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @random_ 他不是这个意思     \n     2013-06-28 18:33 |    \t\tNULL0 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:3        | ..............)\t\t \n  @random_ 把谁黑了呀?    \n     2013-06-28 18:34 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @NULL0 他以为你把那个网站黑了    \n     2013-06-28 21:09 |    \t\t小E \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:12        )\t\t \n  @xsser 原理跟小偷程序差不多吧？    \n     2013-07-01 16:15 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  应该是这样的:（js)window.opener.location.href=\"http://wooyun.org\";    \n     2013-07-01 16:15 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  浏览器特性    \n     2013-07-01 16:17 |    \t\tNULL0 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:3        | ..............)\t\t \n  @VIP w3c标准    \n     2013-08-13 12:39 |    \t\t聆听 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | why are you so diao ！)\t\t \n  洞主搜索词亮了    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}