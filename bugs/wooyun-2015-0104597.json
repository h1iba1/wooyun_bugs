{"id": 41062, "wybug_id": "wooyun-2015-0104597", "wybug_title": "爱点科技/酷虎游戏厂商管理后台存在命令执行漏洞造成全线业务沦陷", "wybug_corp": "广州爱点信息科技有限公司", "wybug_author": "路人甲", "wybug_date": "2015-03-30 10:14", "wybug_open_date": "2015-05-14 10:16", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行", "补丁不及时"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-30：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-05-14：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 爱点科技,酷虎游戏厂商管理后台存在命令执行漏洞造成全线业务沦陷struts2命令执行漏洞照成公司全线业务沦陷（我所发现的在线业务）可执行任意命令,ROOT权限全服文件读写权限可替换游戏APP文件数据库泄露影响13个站点等~~~~~~ 详细说明：  爱点科技,酷虎游戏厂商管理后台存在命令执行漏洞造成全线业务沦陷struts2命令执行漏洞照成公司全线业务沦陷（我所发现的在线业务）可执行任意命令,ROOT权限可替换游戏APP文件数据库泄露影响13个站点等~~~~~~造成影响站点：\nIP地址：58.67.159.23 http://www.koohoo.cn/app/88720140508120908953.html -> www.koohoo.cnhttp://bbs.koohoo.cn/ -> 提示信息 - 酷虎游戏－游戏活动、攻略和礼包站http://idiantech.com/RELEASE-NOTES.txt -> idiantech.comhttp://kuaihuu.com/ -> 快虎市场官网http://www.idiantech.com/index.html -> 爱点科技 - 爱玩手机，更快一点 | 广州爱点信息科技有限公司http://weili68.com/ -> 微力—国内最大的微信公众服务平台http://wifi.kuai51.com/ -> 手机门店软件推广系统http://weili68.com/site/kefu.html -> 微力—国内最大的微信公众服务平台http://www.koohoo.cn/special/49.html -> 午后休闲时光 - 酷虎游戏中心 - 最好玩的手机游戏下载 安卓 ...http://ll.kuai51.com/ -> 流量助手官网_最受欢迎的安卓手机流量监控工具 ...-android流量http://bbs.koohoo.cn/thread-258-1-1.html -> 提示信息 - 酷虎游戏－游戏活动、攻略和礼包站http://m.koohoo.cn/app/35020131113213407466.html -> GrooveMixer - 音乐制作_GrooveMixer - 音乐制作官网 ...http://kuaihuu.com/file/kuaihu.apk -> kuaihuu.com\n   漏洞证明：  \n漏洞地址：http://cp.koohoo.cn/sdkcp_login.action\n\n命令执行证明\n\n\n\ngetshell\n\n\n\n未做细致整理,深入附上两张影响站点图\n\n\n\n\n\n贴出部分数据库/敏感信息\n\n#jdbcjdbc.driverClassName=com.mysql.jdbc.Driverjdbc.url=jdbc:mysql://127.0.0.1:3306/ada_two_dbjdbc.username=rootjdbc.password=aidian20121117# Hibernate configurationhibernate.dialect=org.hibernate.dialect.MySQLDialecthibernate.query.substitutions=true 'T', false 'F';hibernate.hbm2ddl.auto=updatehibernate.c3p0.minPoolSize=1hibernate.c3p0.maxPoolSize=20hibernate.c3p0.timeout=600hibernate.c3p0.max_statement=50hibernate.c3p0.testConnectionOnCheckout=false;hibernate.show_sql=truehibernate.connection.useUnicode=truehibernate.connection.characterEncoding=UTF-8\n\n##################################################log4j.rootLogger=INFO, CONSOLE,serviceAppender#log4j.logger.com.wallimn.JDBC=INFO,JDBC ####################################################log4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender log4j.appender.CONSOLE.Threshold=DEBUG log4j.appender.CONSOLE.Target=System.out log4j.appender.CONSOLE.layout=org.apache.log4j.PatternLayoutlog4j.appender.CONSOLE.layout.ConversionPattern=[log] %d - %c -%-4r [%t] %-5p %c %x - %m%n## everyDay #log4j.appender.serviceAppender=org.apache.log4j.DailyRollingFileAppender#log4j.appender.serviceAppender.File=${bbs.webapp.root}/WEB-INF/logs/services.log#log4j.appender.serviceAppender.File=${catalina.base}/WebRoot/log/services.loglog4j.appender.serviceAppender.DatePattern='.'yyyy-MM-dd log4j.appender.serviceAppender.Append=falselog4j.appender.serviceAppender.layout=org.apache.log4j.PatternLayoutlog4j.appender.serviceAppender.layout.ConversionPattern=%p %c{1} %-d{HH:mm:ss} %m%n#insert into DataBase###log4j.appender.JDBC=org.apache.log4j.jdbc.JDBCAppender ##log4j.appender.JDBC.URL=jdbc:mysql://127.0.0.1:3306/db_bbs ##log4j.appender.JDBC.driver=com.mysql.jdbc.Driver ##log4j.appender.JDBC.user=root ##log4j.appender.JDBC.password=root ##log4j.appender.JDBC.sql=INSERT INTO LOG4J (Message) VALUES ([log] %d - %c -%-4r [%t] %-5p %c %x - %m%n') ##log4j.appender.JDBC.layout=org.apache.log4j.PatternLayout ##log4j.appender.JDBC.layout.ConversionPattern=[log]  %d     -   %c  -%-4r  [%t]  %-5p %c %x - %m%n\n支付请求地址,可做钓鱼/恶意跳转哦~等~\n#商户编号p1_MerId=10012085546#商户密钥keyValue=039348961JbTA8U1FmR94W51VPE475wr0j14RxR5Y87a2tn89o5NQC76Nl44#支付请求正式地址annulCardReqURL=https\\://www.yeepay.com/app-merchant-proxy/command.action#annulCardReqURL=http\\://tech.yeepay.com\\:8080/robot/debug.action\n酷虎游戏论坛数据库信息:\ndefine('UC_CONNECT', 'mysql');\t\t\t\t// 杩?? UCenter ???寮? mysql/NULL, 榛??涓虹┖?朵负 fscoketopen(), mysql ????ヨ??ョ??版?搴? 涓轰????, 寤鸿???? mysql// ?版?搴????(mysql 杩????define('UC_DBHOST', 'localhost');\t\t\t// UCenter ?版?搴?富??define('UC_DBUSER', 'root');\t\t\t\t// UCenter ?版?搴???峰?define('UC_DBPW', 'root');\t\t\t\t// UCenter ?版?搴????define('UC_DBNAME', 'ucenter');\t\t\t\t// UCenter ?版?搴??绉?define('UC_DBCHARSET', 'utf8');\t\t\t\t// UCenter ?版?搴??绗??define('UC_DBTABLEPRE', '`ucenter`.uc_');\t\t// UCenter ?版?搴?〃???define('UC_DBCONNECT', '0');\t\t\t\t// UCenter ?版?搴??涔????0=?抽?, 1=???// ??俊?稿?define('UC_KEY', 'yeN3g9EbNfiaYfodV63dI1j8Fbk5HaL7W4yaW4y7u2j4Mf45mfg2v899g451k576');\t// 涓?UCenter ???淇″??? 瑕?? UCenter 淇??涓??define('UC_API', 'http://localhost/ucenter/branches/1.5.0/server'); // UCenter ??URL ?板?, ?ㄨ??ㄥご???渚??姝ゅ父??define('UC_CHARSET', 'utf-8');\t\t\t\t// UCenter ???绗??define('UC_IP', '127.0.0.1');\t\t\t\t// UCenter ??IP, 褰?UC_CONNECT 涓洪? mysql ?瑰??? 骞朵?褰??搴??????ㄨВ??????????? 璇疯?缃????define('UC_APPID', '1');\t\t\t\t// 褰??搴????ID\n\n疑似全服数据库,带部分数据库截图合成\n\n\n\n\n   修复方案：  升级,打补丁,然后从新配一下权限吧~  这都是跨目录的权限过高造成的大概就深入到这里了~~~话说越详细rank越高对吗？这下够详细了吧~~~算通用吗？加$吗？能高rank？有礼品吗？不过这个公司还真的让人挺捉急的~~一个漏洞照成的~~哎~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}