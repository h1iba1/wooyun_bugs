{"id": 88095, "wybug_id": "wooyun-2016-0206069", "wybug_title": "中国联通某省某系统未授权访问任意文件上传可GetShell（涉及违章/用户/传真/内部硬件监控/电影卡/游戏卡等信息）                                      ", "wybug_corp": "中国联通", "wybug_author": "路人甲", "wybug_date": "2016-05-07 18:10", "wybug_open_date": "2016-06-25 14:50", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传内容未检查", "文件上传漏洞", "文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-25：\t细节向公众公开  简要描述： 1.上传页面未授权访问；2.上传模块限制不严格，任意文件上传；3.浏览可以定位文件的附件位置；4.大量的数据库，泄漏大量企业以及个人等信息。 详细说明：  测试地址：**.**.**.**:9080/agent/\n\n默认上传目录：**.**.**.**:9080/info/maintain/new.jsp?fatherid=&fathertitle=&dsName=default\n\n存在任意文件上传，直接可以GetShell。上传路径在/suntek_eap_info_file_dir/attach/public/下：\n\nGetShell：**.**.**.**:9080/suntek_eap_info_file_dir/attach/public/wooyun.jspx  密码：w@@y.\n\n   漏洞证明：  数据库连接帐号和密码，sysbase数据库连接配置信息：\n\n多个数据库：\n\n1.64723条违章记录：\n\n\n\n2.用户身份信息：\n\n\n\n3.传真帐号密码：\n\n4.硬件监控信息：\n\n5.其他应用用户信息：\n\n登录帐号信息：\n\n\n\n信息岗用户信息：\n\n6.电影卡信息：\n\n7.7243条游戏卡记录：\n\n\n\n其他就不一一截图了，多个库，你们懂得。   修复方案：  1.上传页面配置访问授权认证信息；2.上传模块对于上传文件进行严格限制；3.服务降权。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2016-05-11 14:44 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给内蒙古分中心，由内蒙古分中心后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}