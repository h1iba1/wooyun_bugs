{"id": 21374, "wybug_id": "wooyun-2012-04406", "wybug_title": "魅族登录网站认证服务第三方劫持漏洞", "wybug_corp": "魅族科技", "wybug_author": "Ambulong", "wybug_date": "2012-02-11 01:37", "wybug_open_date": "2012-02-11 01:37", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证设计不合理", "跳转", "用户认证信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-11：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-02-11：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 和先前的小米一样http://www.wooyun.org/bugs/wooyun-2010-03608目的一样，求手机啦，小米人家都送了，魅族也该表示下吧漏洞几乎一模一样别忽略啊～受不起啊～ 详细说明：  魅族用户登录地址（没测试是appuri还是useruri参数导致跳转）：https://member.meizu.com/login.jsp?appuri=RETURN_URL&useruri=RETURN_URL&service=uc一样的RETURN_URL没有做域校验，可以返回到任意网站。返回地址形式依然含有token，邪恶的我们可以获取中招用户的token登录用户中心，魅族的用户中心貌似还有个“我的账户”，里面有(￥_￥)啊返回地址：http://RETURN_URL/login?passive=true&useruri=USERURI&token=TOKEN利用的方式也很简单啦，跳转地址加个获取TOKEN的文件，获取后直接重新定向到魅族的网站入口。（token的认证入口不用我找了吧？）直接进入用户中心...   漏洞证明：  https://member.meizu.com/login.jsp?appuri=RETURN_URL&useruri=RETURN_URL&service=ucRETURN_URL换成跳转的地址   修复方案：  对跳转的地址进行域校验。可以的话联系我啦！   版权声明：转载请注明来源 Ambulong@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：5 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2012-02-11 12:53 |    \t\tAmbulong \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:14        | 保佑中啊～放了一星期的东西，别误会啦～)\t\t \n  小米与魅族的差距啊～连rank也没了，唉～    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 5, "Ranks": null}