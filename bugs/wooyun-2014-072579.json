{"id": 52026, "wybug_id": "wooyun-2014-072579", "wybug_title": "无意的一次测试获得通用型漏洞(关系某省的公安信息)", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "xlz0iza1", "wybug_date": "2014-08-18 12:05", "wybug_open_date": "2014-10-02 12:08", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-02：\t细节向公众公开  简要描述： RT 详细说明：  好无聊啊，无意弄到一点SA了，虽然不是很多，我喜欢跟别人不一样的密码，既让我遇上了降权的，实战记录的此文档，所以写得比较简洁了点，SA权限能执行cmd命令赋予guest权限。某公安互助报警综合服务系统。http://58.221.185.221:88/\n\n一次无意的挖掘。   漏洞证明：  相关案例：\n通用的sa密码：      58.221.185.221 用户sa 密码：sqlpwd      218.91.211.2   用户sa 密码：sqlpwd      218.91.211.3   用户sa 密码：sqlpwd      通用的web程序：      http://58.221.185.221:88/      http://218.91.211.3:88/      http://218.91.211.2:88/\n开始记录全部过程吧，获得通用的sa密码，然后想进一步的谅解。无意发现了这个枚sa密码，\n\n于是想提权，比较渗透测试中，要为用户列举到最大危害程度，和修复方案。通过常用的命令收集信息。\n\n\n\n发现web端口为88，远程终端为9001\n\nsa降权了，不过还是有guest的权限，果断来写shell吧。\n\n提权步骤就不详细说明了，因为这用了很多时间，服务器补丁和限制很多、开始一提权服务器就挂掉。\n\n好吧，我想说我是无奈，等到服务器重启以后，换了一个exp果断的提权下了服务器。\n\n提权到服务器，于是果断进入服务器看源码，挖掘下源码中有撒权限的。文件：/charger/upinc/upload_flash.asp（3~6行）\nuppath=request(\"uppath\")&\"/\"\t\t\tfilelx=request(\"filelx\")\t\t\t\tformName=request(\"formName\")\t\t\tEditName=request(\"EditName\")\n很明显这里的uppath是自己定义的&\"/\"\t后面的”/”是把文件上传的跟目录的意思\n\n完全没有对uppath进行任何处理，然后我们再来看upfile_flash.asp文件，代码我就不贴出来了。\n\n很明显只是对filelx进行了判断，白名单后缀~对于IIS漏洞来说结合利用的话，过来没有很合作用啊。然后下面案例复现上传漏洞：\n\n直接上传一句话木马啊，嘎嘎~Getshell就这么出来啦，嘎嘎~\n\n\n\n案例二：\n\n\n\n通过上面，不怎么清晰的讲解中，获得了通用的sa弱口令，上传漏洞。   修复方案：  不要忽视小安全~   版权声明：转载请注明来源 xlz0iza1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-08-23 11:58 厂商回复： CNVD确认所述情况，未能确认软件开发厂商，根据测试实例，已经转由CNCERT下发给江苏分中心处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}