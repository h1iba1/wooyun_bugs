{"id": 47308, "wybug_id": "wooyun-2014-081470", "wybug_title": "qibocms 地方门户系统文件包含致无限制Getshell", "wybug_corp": "齐博CMS", "wybug_author": "′雨。", "wybug_date": "2014-10-31 13:59", "wybug_open_date": "2015-01-29 14:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-03：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向公众公开  简要描述： 好歹是一般应用  注入都走了小厂商 这个上个首页把。无需登录 无任何限制条件。demo测试 详细说明：  在/hr/listperson.php中\n$template_file=getTpl(\"list_$fidDB[mid]\",$FidTpl['list']);//注意这里的$FidTpl 这里并没有初始化 导致可以控制fetch_label_value(array('pagetype'=>'4','file'=>$template_file,'module'=>$webdb['module_id']));require(ROOT_PATH.\"inc/head.php\");require($template_file)//包含;\ngetTpl 来看看这个\nfunction getTpl($html,$tplpath=''){\tglobal $STYLE;//这里的$tplpath可控的\tif($tplpath&&file_exists($tplpath)){\t\treturn $tplpath;//如果文件存在 那么就直接return\t}elseif($tplpath&&file_exists(Mpath.$tplpath)){\t\treturn Mpath.$tplpath;\t}elseif(file_exists(Mpath.\"template/$STYLE/$html.htm\")){\t\treturn Mpath.\"template/$STYLE/$html.htm\";\t}else{\t\treturn Mpath.\"template/default/$html.htm\";\t}}\nrequire($template_file) //return后就直接包含了 没限制后缀 导致了可以直接包含任意格式的 所以 无需截断 。再找找哪里能上传图片。 找了半天  都是需要登录的上传。终于找到了一处不需要登录的上传http://life5.qibosoft.com/hy/choose_pic.php上传后 直接包含\n\nGetshell   漏洞证明：  \n\n   修复方案：  限制后缀啥的?不懂。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-10-31 14:15 厂商回复： 感谢提出来！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-31 14:01 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  尼玛、还来    \n     2014-10-31 14:10 |    \t\t一只寂寞的小鸟 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:3        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  你叼    \n     2014-10-31 16:11 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:31        | Hacked by @ringzero 我錯了)\t\t \n  说好的好好高考呢    \n     2014-10-31 16:29 |    \t\t1c3z \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:29        | 我读书少，你可别骗我！！！)\t\t \n  6666666666666666666    \n     2014-10-31 19:40 |    \t\tJewer \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 我很苦逼。)\t\t \n  还要不要人活啊！    \n     2014-11-02 19:08 |    \t\tMxx \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 没有)\t\t \n  你关注的白帽子 ′雨。 发表了漏洞 qibocms 地方门户系统文件包含致无限制Getshell    \n     2014-11-05 17:30 |    \t\tgoubuli \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:61        )\t\t \n  Mark    \n     2014-11-06 09:01 |    \t\tnzk1912 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:10        | 软件开发8年了，也来挖挖漏洞，为创建安全...)\t\t \n   靠，又是两$    \n     2014-11-16 21:26 |    \t\t发条橙子 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:6        | ∑(っ °Д °;)っ)\t\t \n  FidTpl[list]    \n     2014-12-05 22:30 |    \t\t微尘 \t\t\t( 普通白帽子  |\t\t\t        Rank:218 漏洞数:74        )\t\t \n  好像都打补丁了、    \n     2015-01-29 20:22 |    \t\t风炫 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:5        | 菊花残，满地伤)\t\t \n  你这里的可控是指register_globals开启的情况下吗？    \n     2015-01-29 21:01 |    \t\t′雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @风炫 不需要 qibo是伪全局，    \n     2015-02-26 14:46 |    \t\tsseeoo \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:3        | 度娘学习)\t\t \n  http://www.465200.cn/hy/choose_pic.phphttp://zqjv.com/hy/choose_pic.phphttp://shiguangbao.cn/hy/choose_pic.phphttp://www.11111xinxiwang.com/hy/choose_pic.phphttp://www.juexing.net/hy/choose_pic.phphttp://www.cgxxw.cn/hy/choose_pic.phphttp://www.7-jz.com/hy/choose_pic.phphttp://www.wxtxgj.com/hy/choose_pic.phphttp://www.gdylhm.com/hy/choose_pic.phphttp://www.zhentou.net/hy/choose_pic.phphttp://www.369bx.com/hy/choose_pic.phphttp://www.chongdiandianchi.net/hy/choose_pic.phphttp://www.chinayyw.net/hy/choose_pic.phphttp://www.gxylnews.com/hy/choose_pic.phphttp://www.88gq.com/hy/choose_pic.phphttp://www.aiteel.com/hy/choose_pic.phphttp://hechi.xjwy.cn/hy/choose_pic.phphttp://zhidianxy.com/hy/choose_pic.php怎么利用？？？上传只能GIF和JPG啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}