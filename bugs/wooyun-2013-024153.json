{"id": 11715, "wybug_id": "wooyun-2013-024153", "wybug_title": "淘宝网 -- 商品页面强制弹出任意网页漏洞，又是前端“黑客”？", "wybug_corp": "淘宝网", "wybug_author": "路人甲", "wybug_date": "2013-05-20 16:50", "wybug_open_date": "2013-07-04 16:51", "wybug_type": "恶意信息传播", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["恶意", "利用", "恶意信息传播", "钓鱼欺诈"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-04：\t细节向公众公开  简要描述： 看到乌云今天报告的这个“点击劫持”漏洞，想起我也遇到过强行被店铺弹窗的经历！ 详细说明：  店铺地址是这个，重现可以来这里看。\nhttp://item.taobao.com/item.htm?spm=a230r.1.14.69.zk34BW&id=25101676408&_u=k3jfumt58e4\n访问被强行调到天猫，带有淘宝客ID\nhttp://www.tmall.com/?ali_trackid=2:mm_34019173_0_0:1369039267_3k9_1575965793\n分析了一下，应该是店铺所有者在CSS样式中插入了一个“恶意”flash文件，达到任意跳转店铺访问的目的。图1：源码中店铺调用该样式等信息的地方\n\n图2：“恶意”swf文件地址，http://yun.taosoft.com.cn/taoflash/swf/1666424963/1367227913539.swf?cid=tb1666424963&pid=c3dmLzE2NjY0MjQ5NjMvMTM2NzIyNzkxMzUzOS5zd2Y=\n\n图3：“恶意”swf文件，强制弹出连接 http://www.locailed.com/cc/cc1.html\n\n直接curl也可看到最终跳转的页面地址\ncurl \"http://yun.taosoft.com.cn/taoflash/swf/1666424963/1367227913539.swf?cid=tb1666424963&pid=c3dmLzE2NjY0MjQ5NjMvMTM2NzIyNzkxMzUzOS5zd2Y=\"FWQ8    DC???/?+http://www.locailed.com/cc/cc1.html_blank@\n可能是通过cid或pid来调换跳转地址吧，这个swf是通用的抢弹程序（此处猜测）~   漏洞证明：  最终cc1.html文件源码\n<html><head><meta http-equiv=\"Content-Language\" content=\"zh-CN\"><meta HTTP-EQUIV=\"Content-Type\" CONTENT=\"text/html; charset=gb2312\"><meta http-equiv=\"refresh\" content=\"0.1;url=http://light.lz.taobao.com/index.php?fid=77&flag=1&r=http://%73%2E%63%6C%69%63%6B%2E%74%61%6F%62%61%6F%2E%63%6F%6D%2F%74%3F%65%3D%7A%47%55%33%34%43%41%37%4B%25%32%42%50%6B%71%42%30%35%25%32%42%6D%37%72%66%47%47%6A%6C%59%36%30%6F%48%63%63%37%62%6B%4B%4F%51%69%51%7A%69%67%34%6E%7A%6F%67%4D%42%58%50%72%62%50%32%70%52%50%42%53%4F%6B%42%53%35%44%68%48%35%48%46%35%76%51%49%68%69%34%66%4A%37%37%55%33%61%4B%64%4B%47%75%75%36%5A%76%37%70%39%46%50%38%69%33%74%70%65%77%48%64%49%68%48%36%75%44%4D%65%41%25%33%44%25%33%44\"><title></title></head><body></body></html>\n经过meta这个跳转的几跳后，到了最终的天猫+淘宝客ID连接上，看图吧\n\n   修复方案：  新人，求带！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2013-05-20 18:41 厂商回复： 非常感谢您对我们的支持与关注，该问题我们正在修复~~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-20 16:53 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  连载是怎么着？    \n     2013-05-20 17:00 |    \t\t大肠精 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 业余兴趣而已)\t\t \n  我去，那不是任意劫持购买么    \n     2013-05-20 17:11 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @大肠精 不知情的用户会在新填出的连接内购买么？是这个逻辑不。    \n     2013-05-20 17:12 |    \t\t蓝小灰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:5        | 找工作！PHP开发方向)\t\t \n  要是弹mm_id那可牛逼大了    \n     2013-05-20 17:13 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @蓝小灰 又是啥，你们说的我都不懂，能讲解下么    \n     2013-05-20 21:33 |    \t\t大肠精 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 业余兴趣而已)\t\t \n  @疯狗 XSS或者CSRF呀...成功利用的话可以做很多事情啊,什么退货,删除物品,修改收货信息什么的    \n     2013-05-20 22:40 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @大肠精 啊，我是说mm_id    \n     2013-05-21 09:50 |    \t\t大肠精 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 业余兴趣而已)\t\t \n  @疯狗 大概是淘宝的某些认证ID吧，好比QQ的appkey，这个得专门研究淘宝的才知道哦    \n     2013-06-13 09:45 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:170        | 力不从心)\t\t \n  rank4?感觉还是不厚道    \n     2013-07-04 16:56 |    \t\tf19ht \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:15        | 依依不舍的还是你的菊花。)\t\t \n  好好的一条赚钱的路子,.就被你这么毁了 赔我毛爷爷.....你赔我    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}