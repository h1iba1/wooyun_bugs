{"id": 67958, "wybug_id": "wooyun-2015-0150981", "wybug_title": "烟台大学Online Judge系统拿服务器root权限", "wybug_corp": "烟台大学", "wybug_author": "system-admin", "wybug_date": "2015-11-02 09:33", "wybug_open_date": "2015-11-07 09:34", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT 详细说明：  YTU Online Judge，意外拿到的root权限，服务器IP **.**.**.**，22端口对外开放看**.**.**.**/status.php是正在使用的系统，查了下mysql数据库jol.users注册用户数5457扫描目录得到**.**.**.**/setlang.php~带了个小尾巴，访问得<?php require_once(\"./include/db_info.inc.php\");\trequire_once(\"./include/my_func.inc.php\");\t\t$newlang=strval($_GET['lang']);\tif(is_valid_user_name($newlang)&&strlen($newlang)<3){\t\t$_SESSION['OJ_LANG']=$newlang;\t}\t\techo \"<script language='javascript'>\\n\";\t\techo \"history.go(-1);\\n\";\t\techo \"</script>\"; ?>然后访问上面代码中出现的**.**.**.**/include/db_info.inc.php~，得<?php @session_start();\tini_set(\"display_errors\",\"Off\");static \t$DB_HOST=\"localhost\";static \t$DB_NAME=\"jol\";static \t$DB_USER=\"root\";static \t$DB_PASS=\"!@#$112358lalala\";\t// connect db static \t$OJ_NAME=\"HUSTOJ\";static \t$OJ_HOME=\"./\";static \t$OJ_ADMIN=\"root@localhost\";static \t$OJ_DATA=\"/home/judge/data\";static \t$OJ_BBS=\"discuss\";//\"bbs\" for phpBB3 bridge or \"discuss\" for mini-forumstatic  $OJ_ONLINE=false;static  $OJ_LANG=\"en\";static  $OJ_SIM=true; static  $OJ_DICT=true;static  $OJ_LANGMASK=4080; //1mC 2mCPP 4mPascal 8mJava 16mRuby 32mBash 1008 for security reason to mask all other languagestatic  $OJ_EDITE_AREA=true;//true: syntax highlighting is activestatic  $OJ_AUTO_SHARE=false;//true: One can view all AC submit if he/she has ACed it onece.static  $OJ_CSS=\"hoj.css\";static  $OJ_SAE=false; //using sina application enginestatic  $OJ_VCODE=true;static  $OJ_APPENDCODE=true;//是否启用自动添加代码，启用的话，提交时会参考$OJ_DATA对应目录里是否有append.c一类的文件，有的话会把其中代码附加到对应语言的答案之后，巧妙使用可以指定main函数而要求学生编写main部分调用的函数static  $OJ_MEMCACHE=false;static  $OJ_MEMSERVER=\"**.**.**.**\";static  $OJ_MEMPORT=11211;static  $SAE_STORAGE_ROOT=\"http://**.**.**.**/\";static  $OJ_TEMPLATE=\"bs\";if(isset($_GET['tp'])) $OJ_TEMPLATE=$_GET['tp'];static  $OJ_LOGIN_MOD=\"hustoj\";static  $OJ_RANK_LOCK_PERCENT=1;static  $OJ_SHOW_DIFF=false;  //显示错误信息static  $OJ_TEST_RUN=true;static $OJ_OPENID_PWD = '8a367fe87b1e406ea8e94d7d508dcf01';//Add by njt and sys on 2015.7.3static  $OJ_VIP_CONTEST=true;//true:only can see the source code of contest's problem;static  $OJ_LOCKIP=true; //锁定IP ,需配合$OJ_VIP_CONTEST同时使用static  $OJ_LOCKMAIL=true; //锁定mail ,需配合$OJ_VIP_CONTEST同时使用static  $OJ_CLOSE_WRONGMESSAGE= true;  //关闭题目错误时的出错提示信息static  $OJ_TEST_RESET=false; //是否显示代码提交时的testrun 和 reset 按钮 ,false 显示static  $OJ_SIM_SHOW_VALUE=80;  //BY LYH 2013.12.1 相似度显示阈值 static  $OJ_SHOW_CONTEST_TIME =-12;  //by lyh 2014.1.6 ,-12 表示显示一年以内的竟赛  -1 表示显示本年度的竞赛 /* weibo config here */static  $OJ_WEIBO_AUTH=false;static  $OJ_WEIBO_AKEY='1124518951';static  $OJ_WEIBO_ASEC='df709a1253ef8878548920718085e84b';static  $OJ_WEIBO_CBURL='**.**.**.**/JudgeOnline/login_weibo.php';/* renren config here */static  $OJ_RR_AUTH=false;static  $OJ_RR_AKEY='d066ad780742404d85d0955ac05654df';static  $OJ_RR_ASEC='c4d2988cf5c149fabf8098f32f9b49ed';static  $OJ_RR_CBURL='**.**.**.**/JudgeOnline/login_renren.php';/* qq config here */static  $OJ_QQ_AUTH=false;static  $OJ_QQ_AKEY='1124518951';static  $OJ_QQ_ASEC='df709a1253ef8878548920718085e84b';static  $OJ_QQ_CBURL='**.**.**.**';//if(date('H')<5||date('H')>21||isset($_GET['dark'])) $OJ_CSS=\"dark.css\";if (isset($_SESSION['OJ_LANG'])) $OJ_LANG=$_SESSION['OJ_LANG'];\tif($OJ_SAE)\t{\t\t$OJ_DATA=\"saestor://data/\";\t//  for **.**.**.**\t\tmysql_connect(SAE_MYSQL_HOST_M.':'.SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);\t\t$DB_NAME=SAE_MYSQL_DB;\t}else{\t\t//for normal install\t\tif(!mysql_pconnect($DB_HOST,$DB_USER,$DB_PASS)) \t\t\tdie('Could not connect: ' . mysql_error());\t}\t// use db\tmysql_query(\"set names utf8\");  //if(!$OJ_SAE)mysql_set_charset(\"utf8\"); \tif(!mysql_select_db($DB_NAME))\t\tdie('Can\\'t use foo : ' . mysql_error());\t//sychronize php and mysql server\tdate_default_timezone_set(\"PRC\");\tmysql_query(\"SET time_zone ='+8:00'\"); ?>用上面代码出现的mysql账户信息root/!@#$112358lalala登陆ssh，成功进入！   漏洞证明：  ssh：root !@#$112358lalala   修复方案：  \n\n清除上述目录中出现了带.php~小尾巴的文件,还有/.svn最好删除掉   版权声明：转载请注明来源 system-admin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-11-07 09:34 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}