{"id": 52691, "wybug_id": "wooyun-2014-070447", "wybug_title": "某医院系统任意目录遍历&amp;任意文件上传至getshell", "wybug_corp": "台州华顶网络技术有限公司", "wybug_author": "冰火九天", "wybug_date": "2014-07-31 18:31", "wybug_open_date": "2014-10-29 18:32", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-08：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-29：\t细节向公众公开  简要描述： 继续深入挖掘这套医院系统 详细说明：  百度关键字 inurl:info.aspx?Code=任意目录遍历http://www.312000.net/admin/dialog/FileList.aspx?code=0&show=true&path=./Admin\n\nhttp://www.dyhospital.com/admin/dialog/FileList.aspx?code=0&show=true&path=./\n\nhttp://www.wlsph.com/admin/dialog/FileList.aspx?code=0&show=true&path=./Admin/Dialog\n\n在上一个目录遍历漏洞的基础上查找可利用的上传点无聊的翻目录过程中······终于找到上传文件/admin/dialog/fileupload.aspx似乎默认上传路径不给执行咱构造一下http://www.312000.net/admin/dialog/fileupload.aspx?type=1&path=./Admin/Dialoghttp://www.dyhospital.com/admin/dialog/fileupload.aspx?type=1&path=./Admin/Dialoghttp://www.wlsph.com/admin/dialog/fileupload.aspx?type=1&path=./Admin/Dialog上传后文件被重命名，怎么办之前的目录遍历正好派上用场   漏洞证明：  以http://www.312000.net/为例进行证明\n\n在http://www.312000.net/admin/dialog/FileList.aspx?code=0&show=true&path=./Admin/Dialog找到文件（浏览器需要禁用js脚本）\n\n访问一下http://www.312000.net/Admin/Dialog/201407301026743.txt\n\n   修复方案：  目录限制上传文件白名单   版权声明：转载请注明来源 冰火九天@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-08-05 09:07 厂商回复： CNVD未能确认生产厂商，对于所述案例暂未建立直接处置渠道。待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}