{"id": 72100, "wybug_id": "wooyun-2015-0150987", "wybug_title": "艺龙旅行网内网漫游可查全国开房记录（可查实时手机验证码\\任意密码重置\\可获得主站源代码\\订单数据库配置等）", "wybug_corp": "艺龙旅行网", "wybug_author": "鸟云厂商", "wybug_date": "2015-11-01 08:01", "wybug_open_date": "2015-12-19 10:18", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["渗透测试思路"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-19：\t细节向公众公开  简要描述： 艺龙旅行网内网漫游可查全国开房记录（可查实时手机验证码\\任意密码重置\\可获得主站源代码\\订单数据库配置等） 详细说明：  今天升级了自己的小字典通过百度搜索知道了艺龙邮箱的格式名字全拼.姓氏全拼@elong.com邮件地址https://mail.corp.elong.comOWA，可爆破最后得到一枚无权限账户（邮箱只有入职指南）\n\nmask 区域\n*****@elon**********34*****\n\n在入职指南的文档中得到VPN地址\n1、VPN权限2、文件、财务服务器访问3、商业软件安装VPN登录地址：http://211.***.***.152 ，权限开通后，使用您的邮箱账户进行登录即可。\n用邮箱账号密码登录成功，VPN没有任何系统权限，但是此时已经处于内网环境开启探测使用子域名工具得知http://tech.corp.elong.com指向某内网IP打开页面是艺龙Wiki\n\nWiki往往是敏感信息最多的地方在wiki中收集信息，得到elong内网的各网段说明文档厂商注意，下面贴出的网段列表内容处于乌云mask标签中，其他白帽子看不到内容，请放心\n\nmask 区域\n***** (Office内部**********24 (ebj-b2 Of**********cp1-a.bjs和cp1-**********30 (互联通I********** /24 (edodo^**********23 (Travelsky********** /24 (中信**********.9.0 /24 (**********(公司高管^**********4 (无线局^**********4 (无线局^**********.50 /32 (交**********.200 /31 (Gu**********30 (B28-交通^**********0 /31 (广发**********^^交通银行专**********24 (VM-home-vi**********.161.0 /24**********.162.0 /24**********.0 /24 (XICI********** (XICI IDC网^********** c3560-a.wht/c3560**********roxy1.xici.bjc连**********(c3560-a.wht连^**********asa5500-1.ebj-b2**********21 (分公司^**********(到中国银行********** (IDC1新增交********** 10 VLAN 20--CAE-I**********.0 /24 (Set 11 VLAN 21**********.0 /24 (Set 12 VLAN 22**********c3825-2.ebj-b2，**********8.11.0 /24**********8.12.0 /24**********^^国电信合作**********(中国电信合**********6亦庄IDC^**********e网络设备管**********网络设备管^**********^^络设备管^**********bjy ---- n7010-b.**********.bjy ---- c4948-b**********.bjy ---- c4948-a**********.bjy ---- c4948-b**********.bjs ----- n7010-**********.bjs ----- n7010-**********7K-A.BJS----N7**********7K-B.BJS----N7**********0 (N7K-A.BJY**********0 (N7K-B.BJY**********0 (C4948-C.B**********(N7K-A.BJY---********** (internet ^*****\n\n这样就给了内网扫描器很好的素材对几个资源丰富的网段扫了一番发现了SVN\n\n此处登录可以查看SVN权限\nhttp://192.168.0.171/submin/login/\n 此链接可以直达SVN目录\nhttp://192.168.0.171/svn/Code\nSVN的Web登录界面没有验证码和防爆机制用字典爆破出几个弱口令用户,密码123456\n\nmask 区域\n*****nv_R**********.zha**********alu**********feng.**********ing**********un.*****\n\n\n\n登录其中一个账号，权限是\nonlineweb_java_devonlineweb__devmobile_dev\n在Wiki中检索信息onlineweb__dev这个目录看起来会有好东西翻了翻Svn，发现了elong主站源代码\nm.elong.com\n\n\n对比一下SVN和线上代码，一毛一样SVN：\n\n线上：\n\n\n<link rel='dns-prefetch' href='http://m.elong.com'>    \t<title>酒店预订专家_艺龙网移动版</title>    <!-- 由main.sass 生成    -->\t<link rel=\"stylesheet\" href=\"/slarkjs/dist/hotel/homepage.css\" />\t<link rel=\"stylesheet\" href=\"/slarkjs/lib/idangerous.swiper.css\" />\t<style>\t</style></head><body>\t<div class=\"pages\">\t \t<div class=\"page\">\t\t\t<div class=\"page-content page-search\">\t\t\t\t<span class=\"logo\"></span>\t\t\t\t<div class=\"swiper-container\">\t\t\t        <div class=\"swiper-wrapper\">\t\t\t\t\t\t<div class=\"swiper-slide\"  style=\"background:url(http://m.elongstatic.com/static/webapp/hotel/2015/08/v6/img/loadingimg.gif) no-repeat center;\"></div>\t\t\t        </div>\t\t\t        <!-- Add Pagination -->\t\t\t        <div class=\"swiper-pagination\"></div>\t\t\t    </div>\t\t\t    <div class=\"search-wrap\">\t\t\t    \t<div class=\"search-lb\">\t\t\t\t\t\t<ul class=\"search-list\">\t\t\t\t\t\t\t<li class=\"addr\">\t\t\t\t\t\t\t\t<i class=\"addr\"></i>\t\t\t\t\t\t\t\t<p class=\"cityname\" city-id=\"\"></p>\t\t\t\t\t\t\t\t<i class=\"icon-left\"></i>\t\t\t\t\t\t\t\t<b class=\"right isnearby\"><i class=\"icon-nearby\"></i><span>附近</span></b>\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t<li class=\"date\">\t\t\t\t\t\t\t\t<i class=\"icon-time\"></i>\t\t\t\t\t\t\t\t<div class=\"d1\"><p class=\"type\">入住<span class=\"night\" style=\"visibility: hidden\">深夜</span></p><p><span class=\"indate\" data-value=\"\"></span><span class=\"startweek\"></span></p></div>\t\t\t\t\t\t\t\t<div class=\"d2\"></div>\t\t\t\t\t\t\t\t<div class=\"d3\"><p class=\"type\">离店</p><p><span class=\"outdate\" data-value=\"\"></span><span class=\"endweek\"></span></p></div>\t\t\t\t\t\t\t\t<div class=\"d4 total\"></div>\t\t\t\t\t\t\t\t<i class=\"icon-left\"></i>\t\t\t\t\t\t\t</li>\t\t\t\t\t\t\t<li class=\"name\"><!--输入内容添加on-->\t\t\t\t\t\t\t\t<div class=\"sea-box\">\t\t\t\t\t\t\t\t\t<i class=\"name\"></i>\t\t\t\t\t\t\t\t\t<input type=\"input\" value=\"\" placeholder=\"酒店名称/位置不限\" readonly=\"readonly\">\t\t\t\t\t\t\t\t\t<i class=\"icon-left\"></i>\t\t\t\t\t\t\t\t</div>\n酒店业务数据接口\nmport com.elong.titan.hotel.agent.resp.GetPayTokenResp;import com.elong.titan.hotel.agent.resp.GetPoiDetailInfoResq;import com.elong.titan.hotel.agent.resp.HasHotelFavoriteResp;import com.elong.titan.hotel.agent.resp.HotelDestinationSugResp;import com.elong.titan.hotel.agent.resp.HotelOrderPayResp;/** * @Description: 酒店业务数据接口实现类 * @author jun.ma1 * @date 2015年4月23日 */@Servicepublic class HotelAgentImpl implements IHotelAgent {////\t/**//\t * 获取酒店详情//\t *//\t * @author Fasheng.Dai//\t * @since 2015-4-3 下午4:55:37//\t * @param req//\t * @return//\t * @throws Exception//\t *///\t@MEncrypt//\tpublic GetHotelDetailByRoomGroupResp getHotelDetailByRoomGroupResp(GetHotelDetailByRoomGroupReq req) throws Exception {//\t\t// http://mobile-api2011.elong.com/hotel/hotelDetailV4 4000//\t\t/*//\t\t * String mapiUrl = BaseConfig.HotelApiUrl.getValue() + \"/hotelDetailV4?\"; return HttpHelper.doGet(mapiUrl + req.getAesParams(), req.getHttpHeader(),//\t\t * GetHotelDetailResp.class, 4000);//\t\t *///\t\tString mapiUrl = BaseConfig.HotelApiUrl.getValue() + \"/getHotelDetailByRoomGroup?\";//\t\treturn HttpHelper.doGet(mapiUrl + req.getAesParams(), req.getHt\n酒店、团购数据库、订单数据库接口（密码也有）\n\n\n\nmask 区域\n*****^^史服^**********istorySer*****1.://**.**.**//192.168.64.22/CommonService/CreditCardHistory.asmx</ServiceUrl>_*****t;300<**********HistorySe********************^客史^**********HistoryS*****2.://**.**.**//192.168.64.21:8080/DebitCardHistoryService/DebitCardHistoryInfoRequest/</ServiceUrl>_*****imeOu**********gt;3000</**********t;3000</O**********gt;5000</R**********t;30000</**********TimeO**********istorySer********************积分^**********intsSer*****3.://**.**.**//crmws.vip.elong.com/ElongPointsWs/MemPoints.asmx</ServiceUrl>_*****30000</**********ointsSe**********^^收^**********ectionSe*****4.://**.**.**//192.168.64.21/EmailCollection.WebService/EmailCollection.asmx</ServiceUrl>_*****30000</**********lectionS*****\n\n 礼品卡等线上代码\n\n运维平台\n\n====================================某处可查艺龙系统发送给用户的短信导致任意密码重置、全国开房记录查询艺龙商务旅行信息查询系统http://eds.elong.com/mis/index2.asp之前已经收集了艺龙内部系统用户名了对该系统进行弱口令探测得到数十个弱口令账号随机选择一个登录wenwen.ren q1q1q1此处可查全国短信\nhttp://eds.elong.com/mis/sms/sms_find_new.asp\n以下是证明,验证码实时可查导致任意账户登录\\任意密码重置\\查询订单信息\n\n\n\n查询开房记录 可以通过手机号、订单号查询开房记录\n\n\n\n\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 鸟云厂商@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-11-04 10:17 厂商回复： 正在修复，感谢白帽子！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-11-01 11:47 |    \t\tTaro \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:51        | 走向最远的方向，哪怕前路迷茫；抱着最大的...)\t\t \n  这个。。。    \n     2015-11-01 11:48 |    \t\ther0ma \t\t\t( 普通白帽子  |\t\t\t        Rank:641 漏洞数:92        | 专注小厂商三十年！)\t\t \n  据说有闪电？    \n     2015-11-01 11:57 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  还有订单和源代码？坐等几个大闪电。    \n     2015-11-01 15:26 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1218 漏洞数:322        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  我猜是司马  哈哈    \n     2015-11-01 15:40 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1077 漏洞数:139        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  居然查我开房记录，干死你。。nnd 不带这样子玩的。    \n     2015-11-01 18:05 |    \t\t行侠 \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:18        )\t\t \n  那你想咋玩？。。。。。。。。。。。    \n     2015-11-01 18:08 |    \t\t鸟云厂商  \t\t\t( 核心白帽子 |\t\t\t        Rank:1477 漏洞数:153        | 中国菜鸟)\t\t \n  @zeracker 那你想咋玩？    \n     2015-11-01 20:23 |    \t\t坏男孩-A_A \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:5        | 菜鸟一枚)\t\t \n  @zeracker 那你想咋玩-.-    \n     2015-11-01 21:02 |    \t\tx7iao \t\t\t( 普通白帽子  |\t\t\t        Rank:366 漏洞数:47        | 文能床上控萝莉，武能床上定人妻)\t\t \n  666    \n     2015-11-01 21:25 |    \t\tnony \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:14        | Not do is die...)\t\t \n  坐等忽略    \n     2015-11-04 09:33 |    \t\t鸟云厂商  \t\t\t( 核心白帽子 |\t\t\t        Rank:1477 漏洞数:153        | 中国菜鸟)\t\t \n  厂商人呢。。。    \n     2015-11-04 11:39 |    \t\t梧桐树下 \t\t\t( 普通白帽子  |\t\t\t        Rank:313 漏洞数:48        | 一大波洞正在过来……)\t\t \n  闪电还是如期而至。    \n     2015-11-23 15:32 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1755 漏洞数:281        | ...........................................)\t\t \n  膜拜渗透大牛    \n     2015-12-04 10:29 |    \t\t心云 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | Rank:200 漏洞数:55 | Rank:300 漏洞数:70 ...)\t\t \n  膜拜    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}