{"id": 88686, "wybug_id": "wooyun-2016-0213399", "wybug_title": "从百度智能微校新项目到拿下中国青少年基金系统（可篡改捐款金额）                                      ", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "Aasron", "wybug_date": "2016-05-27 15:09", "wybug_open_date": "2016-07-15 11:20", "wybug_type": "用户资料大量泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄漏", "用户敏感数据泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-06-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-15：\t细节向公众公开  简要描述： 上个厕所的功夫，看到这个广告，来测试了一下 详细说明：  \n为响应李克强总理“十年内解决村小硬件问题”和“互联网+”的号召，切实解决贫困地区教学基础设施的现实问题，百度携手希望工程及中国青少年发展基金会，引入物联网技术，开创“互联网+公益”全新模式联合五位顶尖建筑设计师，一同走进广西壮族自治区和的5个偏远山区贫困小学，共启“5元新校舍”公益活动，为这里的孩子建设低成本智能化新校舍，建成真正以学生学校实际需求为导向的智能希望小学。\n\n\n这个项目不错，是个福利，使用我的工具找到一处注入，\nGET /netpay/Bankpayment.aspx?DynamicKey=dba9a062-ed84-406e-a383-d4745bc41e3a&OrderNo=W1605270637&ExpTime=-1 HTTP/1.1Accept: text/html, application/xhtml+xml, */*Accept-Language: zh-CNUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like GeckoConnection: closeAccept-Encoding: gzip, deflateCache-Control: no-cacheHost: **.**.**.**Pragma: no-cache\n\n注入参数#DynamicKey\n\nOnSetStateFailLog PCharitableProject PCharitableProject PManageUser PMapItems PayOrder Pro_ProjectItem Pro_ProjectItem Pro_Types Puserinfo Sfa_City Sfa_Rovince Sys_Config Sys_Deptment Sys_DeptmentType Sys_Emplates Sys_Files Sys_Foundation Sys_LockKey Sys_MapItems Sys_Maps Sys_Module Sys_ModuleType Sys_Msg Sys_NoRule Sys_NoRuleType Sys_Notice Sys_OnlineUser Sys_RolePermission Sys_Roles Sys_UserPermission Sys_UserRoles Sys_UserType Sys_Users Sys_tabs V_Projects donate_Donman donate_OrderItems donate_Orders netpay_AliData netpay_CYDFWeb netpay_ConfigSet netpay_EpayData netpay_HaierPayData netpay_TengData netpay_WxAccount netpay_WxQcode netpay_ZhaoData por_PortalModules tb_temp1 tb_temp1 temp_1 temp_Project temp_url tmp_ProjectCount vw_ProjectCount vw_Years\n   漏洞证明：  \n\n看到了一个365，估计是办公系统的库，这个暂且不管，先看本库，有2014年至2016年的全部捐款信息，权限DBA，可垮裤查询\n\n有支付订单的痕迹共26W+捐款人信息\n\"AuditDate\",\"datetime\"\"ExpTime\",\"int\"\"FeeRateType\",\"int\"\"IsSendDon\",\"int\"\"IsSendReqWeb\",\"int\"\"Note\",\"varchar\"\"NoticeUrl\",\"varchar\"\"PayCharitable\",\"varchar\"PayDate\",\"datetime\"\"PayID\",\"varchar\"\"Payment\",\"int\"\"PayMoney\",\"numeric\"\"PayOrder\",\"varchar\"\"PayPayee\",\"varchar\"\"PayState\",\"int\"\"PayType\",\"varchar\"\"PayUser\",\"varchar\"\"ProCode\",\"varchar\"\"QualeID\",\"int\"\"RequestUrl\",\"varchar\"\"ShowUrl\",\"varchar\"\n找找C段，得到几个系统第一个微信捐款系统\nhttp://**.**.**.**/login/index\n存在弱口令问题\nadmin/123456\n\n\n在下面可修改捐款金额，可怕\n\n\n\n打开微信公众号看下\n\n\n\n是没有限制捐款额度的\n\n我这里修改定额为1000，页面效果\n\n\n注：为了证明危害修改了一下，目前已修改回来\n其它系统，就不用测试，这个SQL注射数据库高权限，可以把所有的库给拖下来了，包括捐款人绑定的电话号码，地址，姓名等数据不深入了   修复方案：  过滤弱口令问题   版权声明：转载请注明来源 Aasron@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-05-31 11:10 厂商回复： CNVD未直接复现所述情况，暂未建立与网站管理单位的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-05-27 16:44 |    \t\t黑色的屌丝 \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:6        | →_→→_→)\t\t \n  楼主想诈捐？    \n     2016-05-31 11:14 |    \t\t美食家L \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:14        | http://bbs.404.so 朋友开的论坛 .没人~慢...)\t\t \n  楼主想诈捐？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}