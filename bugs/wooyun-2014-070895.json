{"id": 52550, "wybug_id": "wooyun-2014-070895", "wybug_title": "某用户量较大的高校系统从搜索型注入到Getshell【多数root权限】", "wybug_corp": "Cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2014-08-04 14:36", "wybug_open_date": "2014-11-02 14:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-02：\t细节向公众公开  简要描述： 让高校系统上一次首页吧！！ 详细说明：  \n***********************************关于网轩高校系统注入漏洞的报告*****************************\n0x00：厂商：\nhttp://www.wangxuankj.com/IndexAction.do   杭州网轩科技有限公司\n该系统比较多人使用：\n\n0x01:搜索型注入漏洞：\n\n\n\n   漏洞证明：  【声明：以下案例仅供国家互联网应急中心测试使用，其它人不可利用漏洞进行恶意破坏，否则后果自负，以下漏洞在厂商确认后均做打码处理，感谢您的支持与理解！】TEST A：抓个包看看：\nPOST /search.do HTTP/1.1Host: www.hcxsgz.zjut.edu.cnProxy-Connection: keep-aliveContent-Length: 12Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://www.hcxsgz.zjut.edu.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.125 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://www.hcxsgz.zjut.edu.cn/ShowNewsPageAction.do?newsID=6426Accept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=3326DF761EC4122ACA8BE74F3AE45FC3searchInfo=a\n存在注入的参数是searchInfo，通过测试可以转化为GET形式来注入，以下其它案例将会转为GET形式进行测试，放入sqlmap测试一下。\n\n\n\nTEST B：\nhttp://www.msexsgz.zjut.edu.cn/search.do?searchInfo=\n\n\nTEST C:\nhttp://www.zjctaa.org.cn/search.do?searchInfo=\n\n\nTEST D:\nhttp://www.xyysq.cn/search.do?searchInfo=\n\n\nTEST E:\nhttp://www.gu.zjut.edu.cn/search.do?searchType=1&searchInfo=a&image.x=10&image.y=18\n\n\n一般来说root权限是可以--os-shell的，这里我就不多说了，该SQL注入非常的严重，可以导致管理员账号信息泄露，从而可能导致后台被上传任意文件。\n\n以上面第二例实例来证明后台可上传任意文件，在发布新闻处选择“是”首页专题则会出现一个上传点。此处存在任意文件上传漏洞：\n\n\n\n点到为止，以上仅为测试，未影响任何程序运行，未获取任何有效数据，请速速修复漏洞咯~测试上传的文件已删除！   修复方案：  参数化吧，国家互联网应急中心快点把这些下发至分中心处理吧~同时上报杭州网轩科技有限公司吧，求回复处置报告！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-08-09 09:40 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}