{"id": 15547, "wybug_id": "wooyun-2012-014403", "wybug_title": "爱顾商城作废任意未支付订单", "wybug_corp": "爱顾商城", "wybug_author": "小胖胖要减肥", "wybug_date": "2012-11-09 15:50", "wybug_open_date": "2012-12-24 15:50", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-12-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-12-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-24：\t细节向公众公开  简要描述： 爱顾商城前台可以作废任意未支付订单 详细说明：  由于是测试没有进行支付，用户A登陆下单，用户B在另一台电脑登陆下单，用户B点击作废订单，http截断post数据，修改sosysno为用户A所下的订单号，提交，可以看到用户A的订单作废了，用户B的订单状态未变。可以用burpsuite执行post信息，只要有任意一个账户的cookies就可以，订单规则为+38，前台随便下2个单据就知道了，跑100或1000个线程执行1天，那么所有单子全部作废   漏洞证明：  \n\n该图片为post数据，已修改订单号\n\n该图为post后看到的结果，订单号已改为已作废   修复方案：  绑定customsysno就可以了，或者直接绑定cookies的用户，就像还有一个无关紧要的漏洞是用户A可以支付用户B的订单，就是因为cookies或session未绑定，测试的时候可以适当的了解下代码逻辑，这样能设计更好的用例，也能知道风险在哪里   版权声明：转载请注明来源 小胖胖要减肥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-11-12 17:10 厂商回复： customersysno虽作为参数但实际未作校验引起的bug，可以利用此漏洞批量作废订单从而引起其他正常客户的利益受到影响。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-11-06 09:23 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  亲，既然可以取消说明鉴权是存在问题的，不如看看修改订单查看订单类    \n     2012-11-06 09:38 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xsser 试过啦 亲 修改的话下单后是不能修改的，查看订单有关联用户哦，美特斯邦威网一样的问题，审核下，这种问题就是个地雷，不出事还好，出了事就倒大霉     \n     2012-11-06 10:32 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @小胖胖要减肥 谨慎的怀疑中...    \n     2012-11-06 10:42 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xsser 我只是一个tester，不是黑阔，对于影响只能YY    \n     2012-11-12 20:14 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xsser 帮忙看看新蛋网的帐号现在是谁拿的呗    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}