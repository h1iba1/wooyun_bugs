{"id": 15205, "wybug_id": "wooyun-2013-016955", "wybug_title": "大众点评评论存在严重漏洞，可劫持大量用户帐号，甚至传播蠕虫", "wybug_corp": "大众点评", "wybug_author": "龙臣", "wybug_date": "2013-01-05 18:26", "wybug_open_date": "2013-01-10 18:26", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-10：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 大众点评，大家都懂，是看评论的，但是很不解在评论地方会出这种问题。而且x来的cookie随便用，你们是大网站啊，亲。打管理员什么的就不干了，我是你们的好用户，盼修复。 详细说明：  在任何一个添加评论的地方，注意你们这里处理的都不好，最要命的是在添加停车信息处，完全没做任何过滤，这里的xss可以整站蠕虫，后面的我就不多说了，你们是大站，我在你们站有好几个号，看到这里我很无语，唉，直接看图。这里是访问评论后触发xss的效果\n\n这里是劫持cookie的效果，（不知道帐号是谁的，只做测试，没做其他的）\n\n或者访问http://www.dianping.com/shop/507560/review_more观看效果，由于我的评论比较靠前，应该不需翻页就可以看到效果。注：所有帐号均为测试，图1中的为个人小号，麻烦不要封杀，可以送点折扣券什么的，谢谢。   漏洞证明：  \n\n\n\n   修复方案：  你们是大站，这个真的是小case。另：cookie的关键字段加上httponly属性。   版权声明：转载请注明来源 龙臣@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-01-10 18:26 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-05 19:13 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  沙发，我也去转下~    \n     2013-01-05 19:18 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  刚看了下，这个厂商貌似XSS都会忽略。。。    \n     2013-01-05 19:53 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  这个有人发过了把 @xsser 蠕虫蛮难的，需要用户点击，点评论不支持网页格式，管理员也不是后台管理员管理员根本不看评论的，这个站的最主要的蠕虫点不是xss    \n     2013-01-05 19:58 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小胖胖要减肥 刚去转了下 也挖到了xss，不知道和这个说的是不是一个。。。    \n     2013-01-05 20:09 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @px1624 最明显的就一个地方，一个晚上几百上千个帐号了，不过没什么意思，后台打不到，前台的管理员用的也是前台，上传漏洞也没有，二次渲染没办法    \n     2013-01-05 20:47 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小胖胖要减肥 。。。是找到了，但是感觉利用价值不大，还是先放着吧。。    \n     2013-01-06 09:55 |    \t\t龙臣 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:5        | 人生就是一个缓慢被骗的过程。)\t\t \n  @px1624 应该不是一个    \n     2013-01-06 09:58 |    \t\t龙臣 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:5        | 人生就是一个缓慢被骗的过程。)\t\t \n  @小胖胖要减肥 不需要点击啊，直接触发啊，不过管理员确实是前台的。没打啊。    \n     2013-01-06 10:02 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @龙臣 直接触发的靠src=123.js你试试能不能成功，不过我感觉大蠕虫蠕不起来，或者说写的脚本需要比较复杂，小蠕虫很容易    \n     2013-01-06 10:08 |    \t\t龙臣 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:5        | 人生就是一个缓慢被骗的过程。)\t\t \n  @小胖胖要减肥 亲，可以的，那你以为我怎么抓的cookie的呢？后台有什么办法莫 ？    \n     2013-01-06 10:15 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @龙臣 抓cookies只不过那个字段没过滤，蠕虫你自己试试能不能蠕就知道了，有没有效果，后台只有靠扫的，估计不对外，网站java，服务器nginx，看看有没有配置错误了，碰运气    \n     2013-01-06 12:34 |    \t\twhoami \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:4        | alert\\\\)\t\t \n  @小胖胖要减肥 http://zone.wooyun.org/content/1111  后台确实在内网 而且必须用内部vpn才能登录    \n     2013-01-07 09:03 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @whoami 是啊，这种问题我也遇到过，拿到后台地址和cookie了，但是就是等不了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}