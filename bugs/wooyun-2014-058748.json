{"id": 56144, "wybug_id": "wooyun-2014-058748", "wybug_title": "文件存在上传漏洞导致系统被谷歌爬虫遍历目录", "wybug_corp": "东莞市疾病预防控制中心", "wybug_author": "咸鱼", "wybug_date": "2014-04-28 16:29", "wybug_open_date": "2014-06-12 16:30", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(广东省信息安全测评中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传内容未检查", "谷歌爬虫遍历目录"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-12：\t细节向公众公开  简要描述： 误打误撞在谷歌里看到的有意思的东西 直接可以下载站上面的源代码等敏感的信息 详细说明：   \n\n发现网站以被人入侵\n\n大概分析了下 是dw.jsp 上传时出了问题 导致遍历目录 文件上传内容未检查  任意文件上传\n<%@ page contentType=\"text/html;charset=gb2312\" import=\"dgtc.conBean,com.jspsmart.upload.*\" %><%conBean conbean=new conBean();String url=request.getParameter(\"path\");String action=request.getParameter(\"action\");\tSmartUpload su = new SmartUpload();\tsu.initialize(pageContext);\tif(action.equals(\"down\")){\tsu.setContentDisposition(null);\tsu.downloadFile(conbean.getStr(url));\t}else if(action.equals(\"up\")){\tsu.upload();\tcom.jspsmart.upload.File file = su.getFiles().getFile(0);\turl=su.getRequest().getParameter(\"path\");\tif(url==null){\tfile.saveAs(\"/up/\" + file.getFileName());\t}else{\tfile.saveAs(url + file.getFileName());\t}\tout.println(\"<script language=javascript>\"); \tout.println(\"alert('上传成功!');\"); \tout.println(\"javascript:history.go(-1);\"); \tout.println(\"</script>\");\tout.flush();\t}%>\n   漏洞证明：  \n\n直接管理员权限 内网渗透有木有\n\nInterface: 10.145.199.168 --- 0x2  Internet Address      Physical Address      Type  10.145.199.13         d0-0d-38-03-07-78     dynamic     10.145.199.100        00-22-19-af-f4-cc     dynamic     10.145.199.101        d0-0d-90-47-45-c9     dynamic     10.145.199.179        00-14-22-19-cb-9f     dynamic     10.145.199.254        00-00-0c-07-ac-64     dynamic      修复方案：  降权 过滤 管理员是临时工还是合同工？   版权声明：转载请注明来源 咸鱼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-04-29 16:30 厂商回复： 非常感谢您的报告。报告中的问题已确认并复现,典型的文件上传漏洞，能被进一步利用，危害性较大.影响的数据：中攻击成本：低造成影响：高综合评级为：高，rank：15正在联系相关网站管理单位处置 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}