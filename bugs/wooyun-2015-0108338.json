{"id": 34715, "wybug_id": "wooyun-2015-0108338", "wybug_title": "平安银行某处设计缺陷导致暴力破解用户查询密码", "wybug_corp": "平安银行", "wybug_author": "胡小树", "wybug_date": "2015-04-16 13:36", "wybug_open_date": "2015-05-31 21:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-31：\t细节向公众公开  简要描述： 小问题 详细说明：  1.http://wap-ebank.pingan.com/weixin/modules/register/index.html?from=login\n\n平安银行信用卡网银注册页面。验证码的判断逻辑存在问题，可以绕过。点击下一步时候，先判断验证码再判断用户名密码。顺便说一下，这个验证码太渣了，pkav的神器可以百分百识别2.直接提交用户名密码请求\n\n密码是rsa加密传输的，但服务端并没有对密码的次数进行校验，而且错误提示过于明显，密码是六位数纯数字，导致被爆破的风险。3.看下密码怎么来的https://wap-ebank.pingan.com//xinyongka/public.do?operationType=getPwdKey获取公钥rsa加密算法在本地js中，找下http://wap-ebank.pingan.com//weixin/js_lib/tools/unionrsa.js自己写个js生成RSA字典，比较简单而且写的太渣就不拿出来了。4.搞好字典，太大了，burp，pkav的神器都挂了，自己写php脚本跑时候好像被管理员发现了，禁用了fsockopen等函数。用Python写个脚本get请求，然后正则匹配下，怕被管理员捅菊花，只做下测试\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 胡小树@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-04-16 21:31 厂商回复： 感谢！问题正在定位。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-16 13:36 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  真屌    \n     2015-04-16 13:40 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  真屌    \n     2015-04-16 14:15 |    \t\t孤独行者 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:44        | 时光如水，总是无言。你若安好，便是晴天)\t\t \n  真吊    \n     2015-04-16 14:31 |    \t\t崔超杰 \t\t\t( 普通白帽子  |\t\t\t        Rank:192 漏洞数:53        | 知仙)\t\t \n  假吊    \n     2015-04-16 15:40 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  略屌    \n     2015-04-16 19:04 |    \t\tX5st \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:6        | 合伙搞世界)\t\t \n  屌丝    \n     2015-04-16 19:17 |    \t\tconqu3r \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:21        | 没有思想，没有道德，没有自由，没有人权的...)\t\t \n  坏屌    \n     2015-04-16 19:35 |    \t\tdo9gy \t\t\t( 实习白帽子  |\t\t\t        Rank:61 漏洞数:15        | Dog loves God。)\t\t \n  @conqu3r 坏屌    \n     2015-06-01 14:28 |    \t\t小吨吨 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 鲜肉鲜肉，永远不皱)\t\t \n  屌坏    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}