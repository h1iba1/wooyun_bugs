{"id": 75439, "wybug_id": "wooyun-2016-0167489", "wybug_title": "小牛电动设计缺陷&amp;越权操作", "wybug_corp": "niu.com", "wybug_author": "路人甲", "wybug_date": "2016-01-05 17:04", "wybug_open_date": "2016-02-22 21:46", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向公众公开  简要描述： 小牛电动设计缺陷&越权操作，求首页，求20R 详细说明：   WooYun: 庖丁解牛之一小牛售后系统N多弱口令乱入  WooYun: 小牛电动某站越权可以获取其他管理员明文密码 结合前两个漏洞一起来看，两个均修复了。http://sh.niu.com/这个后台，厂商增加了验证码，防止爆破\n\n但是此处验证码设计有缺陷，登陆失败，验证码不刷新，导致验证码可以一直使用，因此导致可以继续暴力破解登陆登陆的数据包如下\nPOST /Account/LogOn?identification=0.040708905551582575Password=35323031333134&UserName=liujing&oValidCode=YT4P&iValidCode=YT4P\n返回包是{\"msg\":\"用户名密码错误\",\"sessionid\":\"\"}\n\n收集用户名，弱密码，暴力破解，密码简单的ascii hex一下即可，爆破出来好多弱口令账号随便登陆一个lvyue / 1q2w3e4r\n\n登陆一个看看，发现权限没有上次那个什么薛龙的高，菜单只有几个，于是想着去看看越权的问题还在不在直接按照 WooYun: 小牛电动某站越权可以获取其他管理员明文密码 ，构造查看其他用户信息的链接\nGET /RightSet/Exec?ECEvent=OPEN&itemid=1&userright=BNEDCU&winid=setRight&sessionid=2d861c04-34ab-4413-800d-4d96a46a9870&seriod_content_no=0.3636090673971921 HTTP/1.1\n这里sessionid换成这次lvyue的用户的即可\n\n可以看到越权仍然存在，我普通用户还是能看到用户档案等功能只不过跟上次相比，看不到hex保存的密码了，不过越权还是很大的一个问题。   漏洞证明：  见详细描述   修复方案：  彻底修复   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-01-09 20:05 厂商回复： 感谢对小牛电动安全的关注. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}