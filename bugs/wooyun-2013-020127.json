{"id": 13149, "wybug_id": "wooyun-2013-020127", "wybug_title": "Interlib图书馆集群管理系统存在注射漏洞，百万读者信息泄露", "wybug_corp": "广州图创计算机软件开发有限公司", "wybug_author": "ghy459", "wybug_date": "2013-03-16 11:08", "wybug_open_date": "2013-04-30 11:09", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "用户敏感信息泄漏", "用户敏感数据泄漏", "注射", "整形注射", "用户密码泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-04-30：\t细节向公众公开  简要描述： Interlib图书馆集群管理系统页面存在SQL注入漏洞，构造语句可获得系统内所有读者详细信息（姓名，身份证，地址，电话等）。一个挺老的图书馆系统，不过还有不少图书馆使用中。 详细说明：  Interlib图书馆集群管理系统采用的是JSP+Oracle数据库设计，默认以DBA权限运行，库名默认为INTERLIB，读者信息存放在READER表中。在图创软件公司网站的用户案例（http://www.interlib.com.cn/tcsoft/web/information.do?actionCmd=childList&pid=9&id=57&isChild=0）中，有不少城市图书馆采用了INTERLIB这套系统。所以这个漏洞影响巨大，泄露的个人信息已百万计，下面会进行证明。在图书详细介绍页面里，以广州图书馆为例：http://210.72.4.33/interlib/websearch/bookSearch?cmdACT=detailmarc&xsl=listdetailmarc.xsl&bookrecno=243630bookrecno存在参数过滤不严问题，导致注入发生。   漏洞证明：  上面已经提到库名默认为INTERLIB，读者信息存放在READER表中。用sqlmap直捣黄龙sqlmap.py -u \"http://my1.hzlib.net/lib2/websearch/bookSearch?cmdACT=detailmarc&xsl=listdetailmarc.xsl&bookrecno=243630\" -p bookrecno -D INTERLIB -T READER --count\n\n可以看到杭州图书馆的读者记录有108w条随机抽取了10条信息进行导出\n\n再尝试另外的图书馆，苏州图书馆数量是80w左右（http://reader.szlib.com/opac/websearch/bookSearch?cmdACT=detailmarc&xsl=listdetailmarc.xsl&bookrecno=243630）\n\n其它就不多试了，就这两个加起来都快200w了。不过这系统出来好久了，目测有心人该干的都干了吧。   修复方案：  加个防注入就好   版权声明：转载请注明来源 ghy459@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-03-19 21:35 厂商回复： CNVD确认并复现所述情况，并已根据所述情况提取网络检测特征，已在19日联系上软件生产厂商。按照CNVD处置流程，根据处置配合情况进行后续操作，如：发布行业通报。按完全影响机密性进行评分，rank=7.79*1.1*2.0=17.138鼓励应用软件漏洞的挖掘，考虑到信息泄露的危害，rank 加满吧。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-30 13:28 |    \t\tpiaoye \t\t\t( 普通白帽子  |\t\t\t        Rank:343 漏洞数:53        | ww)\t\t \n  sqlmap怎么读取中文数据而不是问号？    \n     2013-05-01 01:25 |    \t\tghy459 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:5        | 深挖洞，广积shell。)\t\t \n  @piaoye 我没有设置任何东西，它自己就导出中文了。可能是编码问题吧。    \n     2013-05-01 08:19 |    \t\tpiaoye \t\t\t( 普通白帽子  |\t\t\t        Rank:343 漏洞数:53        | ww)\t\t \n  @ghy459 应该是python版本问题 我是在win环境下 出来都是？？？    \n     2013-05-01 14:16 |    \t\tghy459 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:5        | 深挖洞，广积shell。)\t\t \n  @piaoye 我上面用的是bt里面的sqlmap，那有可能是它的库是utf-8吧    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}