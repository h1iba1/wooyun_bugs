{"id": 56414, "wybug_id": "wooyun-2014-057801", "wybug_title": "中国网创科技SQL注入导致删除任意解析记录", "wybug_corp": "中国网创科技", "wybug_author": "Rain", "wybug_date": "2014-04-20 13:36", "wybug_open_date": "2014-06-04 13:37", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-04：\t细节向公众公开  简要描述： SQL注入导致删除任意解析记录 详细说明：  SQL注入导致删除任意解析记录   漏洞证明：  http://admin.16wc.com/domain/idccdme_rec.asp?act=del_dns&rrid=350100必须登录到他们的域名管理，登录地址http://admin.16wc.com/登录成功之后，测试发现注入点地址http://admin.16wc.com/domain/idccdme_rec.asp?act=del_dns&rrid=350100由于涉及安全性问题，所以就不提供测试账号，可以通知厂商自行利用测试账号测试漏洞，落得具体证明以图片为准先说明一下漏洞的危险度1.通过SQL注入，添加 or 2=2之类的肯定为真的sql语句如http://admin.16wc.com/domain/idccdme_rec.asp?act=del_dns&rrid=350100 or 2=2可以导致删除全表的记录，这里不做测试避免风险太高，影响太大2.通过注入，可以删除其他任意用户创建的dns解析记录，导致他人网站无法正常访问，首先任意想一个id值出来http://admin.16wc.com/domain/idccdme_rec.asp?act=del_dns&rrid=350041可以看到，可以正常删除，虽然350041的id不是自己添加的dns，照样删除了，具体效果看截图\n\n如果我再次访问上面这个url地址http://admin.16wc.com/domain/idccdme_rec.asp?act=del_dns&rrid=350041可以看到，这个时候asp脚本报错，因为记录已经被之前执行的代码删除过了\n\n发现注入点的原因在于如访问下面的url地址http://admin.16wc.com/domain/idccdme_rec.asp?act=del_dns&rrid=350040 and 1=3\n\n可以看出来，似乎id 350040是不存在，其实不然，主要是1=3这个永远为假，不信可以自己直接访问http://admin.16wc.com/domain/idccdme_rec.asp?act=del_dns&rrid=350040\n\n没有错误返回，这样就可以成功删除了无意删除测试记录，仅作测试，请谅解，赶快修复吧。。。   修复方案：  你懂得   版权声明：转载请注明来源 Rain@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2014-04-25 08:04 厂商回复： cnvd确认并复现所述情况，由cnvd尝试通过公开渠道联系网站管理单位，电话0595-（接通后挂断），后续将简要通报发送至网站和邮箱中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}