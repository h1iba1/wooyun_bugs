{"id": 88535, "wybug_id": "wooyun-2016-0212079", "wybug_title": "中国联通某系统存在任意文件上传漏洞可越权修改28W商户信息数10W资质文件                                      ", "wybug_corp": "中国联通", "wybug_author": "路人甲", "wybug_date": "2016-05-23 19:40", "wybug_open_date": "2016-07-10 10:20", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-06-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-10：\t细节向公众公开  简要描述： 任意文件上传&信息遍历 详细说明：  http://**.**.**.**音乐名片管理系统\n\n注册个用户，需要经过审核，不管审核是否通过，都可以登录系统就像是me，\n\n帐号是我的手机号就不报出来了，因为登录是需要手机验证码的，复现需要注册一个帐号\n\n在这个系统中存在多处上传，貌似都有问题比如信息推送处\n\n新建个活动，可以上传图片，直接传jsp即可，保存后返回查看可以得到shell地址\n\nhttp://**.**.**.**/DiyFile/image/2016/05/23/15/13850030861-6362e0e4-4b5e-4b91-a1a1-c6e1afa4e466.jsp其实也就是http://**.**.**.**/DiyFile/image/2016/05/23/15/13850030861-6362e0e4-4b5e-4b91-a1a1-c6e1afa4e466.jsp密码是023\n\n   漏洞证明：  活动信息遍历（id）http://**.**.**.**/user/Push-beforeStepOne.action?id=91\n\nhttp://**.**.**.**/user/Push-beforeStepOne.action?id=96\n\n28W商户信息遍历可修改（AuserID）http://**.**.**.**/user/Auser-getAUser.action?action=edit&AuserID=284611\n\nhttp://**.**.**.**/user/Auser-getAUser.action?action=edit&AuserID=184611\n\nhttp://**.**.**.**/user/Auser-getAUser.action?action=edit&AuserID=84611\n\nhttp://**.**.**.**/user/Auser-getAUser.action?action=edit&AuserID=4611\n\n给他加个邮箱再访问时，邮箱已保存成功\n\n反正信息是各种遍历数10W资质文件遍历下载（fileid）http://**.**.**.**/sFile-image.action?fileid=9316\n\nhttp://**.**.**.**/sFile-image.action?fileid=39316\n\nhttp://**.**.**.**/sFile-image.action?fileid=109316\n\n服务器内看看大量的彩铃审核日志/data/app/appmcard/wwwroot/aitoneweb/DiyFile/xlsfile/tempfile/\n\n\n\n大量的商家合成音乐名片\n\n各种敏感信息汇集在/data/app/appmcard/wwwroot/aitoneweb/DiyFile/操作流水\n\n大量企业内部员工号\n\n貌似可以越权删除企业底下的员工http://**.**.**.**/user/Apersonnel-delete.action?apersonnelId=1000140，看序号已经百万了资质及身份证盖手印/data/app/appmcard/wwwroot/aitoneweb/DiyFile/DiyFile/image/\n\n数据库就不看了\n\n   修复方案：  删除shell，下线or补丁   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2016-05-26 10:17 厂商回复： CNVD未复现所述情况,已经转由CNCERT向中国联通集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}