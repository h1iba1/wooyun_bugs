{"id": 21449, "wybug_id": "wooyun-2012-04171", "wybug_title": "6KBBS v8.0 普通用户提权漏洞", "wybug_corp": "6KBBS", "wybug_author": "insight-labs", "wybug_date": "2012-02-03 13:39", "wybug_open_date": "2012-02-03 13:39", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "设计缺陷", "缺乏过滤", "参数未过滤", "源码审核", "提权"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-03：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-02-03：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 普通用户提权漏洞，可以提升为管理员权限。 详细说明：  <漏洞分析>ajaxmember.phpcase \"modifyDetails\": $user = $_POST['user']; if(getPopedom(5) == 0) {     $user['usertitle'] = ''; }  if($user[\"email\"] == \"\") {     exit(\"资料不完整。\"); } foreach(explode(\",\", $cache_settings['reservedkeyword']) as $rkey) {     if(!empty($rkey) && stristr($user['usertitle'], $rkey))     {         exit(\"自定义头衔含有禁用关键字\");     } } $db->row_update(\"users\", $user, \"id={$lg['userid']}\"); succeedFlag();  break;   user 数组未做任何限制导致用户POST一个user[groupid]=203的字段，row_update就会更新users表的groupid字段，把普通用户的权限更改为管理员。   漏洞证明：  <漏洞利用>1、\t注册并登陆一个用户。2、\t向/ajaxmember.php?action=modifyDetails页面post数据user%5Bgroupid%5D=203&user%5Bemail%5D=aaaa%40aaaa.com3、重新登录用户，即为管理员权限。   修复方案：  在更新之前加上验证语句，只保留允许更新的字段。   版权声明：转载请注明来源 insight-labs@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：8 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2012-02-05 02:15 |    \t\tBlackeagle \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 向WooYun致敬)\t\t \n  修复了么？怎么鄙人测试N边都是“No Such Action”呀？    \n     2013-06-19 09:01 |    \t\t暴暴 \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | 呃。。。)\t\t \n  。。NM，这怎么可能利用成功。人家官方发了补丁包，你再来公布。http://www.6kbbs.net/view-487.html人家发补丁包在2010年就发布，官方怎么可能鸟你，乌云也不注意 。    \n     2013-06-19 23:42 |    \t\tinsight-labs  \t\t\t( 普通白帽子  |\t\t\t        Rank:623 漏洞数:75        | Security guys)\t\t \n  @暴暴 下载了你所说的那个补丁文件，也是存在漏洞的。我们当时下载的最新版本的代码，同时发布的代码跟发布的补丁代码是一致的，漏洞依然是存在的。这位同学可以看一下，呵呵!    \n     2013-06-19 23:44 |    \t\tinsight-labs  \t\t\t( 普通白帽子  |\t\t\t        Rank:623 漏洞数:75        | Security guys)\t\t \n  @暴暴 修正一下，这里公布出来的代码补丁中的代码是一致的。    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 8, "Ranks": null}