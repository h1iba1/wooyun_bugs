{"id": 47501, "wybug_id": "wooyun-2014-086215", "wybug_title": "交通银行业务流程审核逻辑不严导致可枚举任意信用卡cvv码", "wybug_corp": "交通银行", "wybug_author": "Taki", "wybug_date": "2014-12-09 11:08", "wybug_open_date": "2015-01-23 11:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-23：\t细节向公众公开  简要描述： 可通过在线银行枚举用户信用卡校验码(CVV)，而交行的验证码又很容易被程序识别 详细说明：  通过注册网银可以刺探用户是否开通网银（如果用户没注册，可以用于暴力破解查询密码）如果开通，可以通过重置密码服务的第2步要求输入信用卡有效期，校验码(cvv),身份证，验证码界面，输入任意信息后确认，在下一步的业务处理逻辑中由于会优先判断用户cvv码是否正确，导致即使其他信息错误，也会先提示cvv码错误。由于已知cvv码为3为数字，且用户不得更改，所以此业务逻辑可以用来刺探用户cvv信息。同时信用卡有效期为年月且一般为3-5年，所以在填写正确cvv后，同理也可枚举信用卡有效期。   漏洞证明：  下列网址可以刺探用户是否开通网银（如果用户没注册，可以用于暴力破解查询密码）\n\nmask 区域\n1.https://**.**.**/***/***.jspreqCardNo=622253******1251\n\n 此处16位数字为信用卡卡号，该测试卡号为随机卡号。如果开通，可以通过下面网址重置密码\n\nmask 区域\n1.https://**.**.**/***/***/syResetpwd.do\n\n此处：\n\nmask 区域\n1.https://**.**.**/***/***.jspreqCardNo=信用卡号\n\n重置密码第2步要求输入信用卡有效期，校验码(cvv),身份证，验证码，任意输入信息后确认，在下一步的业务处理逻辑中，会优先判断用户cvv码，由于已知cvv码为3为数字，且用户不得更改，所以此业务逻辑可以用来刺探用户cvv信息。同时信用卡有效期为年月且一般为3-5年，所以在填写正确cvv后，同理也可枚举信用卡有效期。\n\n交行的验证码又很容易被程序识别：\n\n证明：\n\n\n\n   修复方案：  可以优先判断身份证信息，然后判断有效期，最后判断cvv吗。   版权声明：转载请注明来源 Taki@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2014-12-14 00:28 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给上海分中心，由其后续协调网站管理单位处置 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-09 11:13 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  神产品设计    \n     2014-12-09 11:25 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  略屌    \n     2014-12-09 11:25 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  好叼的感觉    \n     2014-12-09 11:35 |    \t\t紫衣大侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:201 漏洞数:21        | 愿结天下有识之士)\t\t \n  CCAV 看这里。。。    \n     2014-12-09 11:41 |    \t\tWoodee \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 乌云路人甲，打脸pa pa pa)\t\t \n  目测很屌    \n     2014-12-09 11:56 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  啪啪啪    \n     2014-12-09 12:08 |    \t\tonlycjeg \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:5        | 我就看看,我不说话.)\t\t \n  cvv啊！～    \n     2014-12-09 12:42 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  牛逼    \n     2014-12-09 16:06 |    \t\t路人N \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        )\t\t \n  biu~biu    \n     2014-12-09 16:16 |    \t\tTaki \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:1        | 看主页)\t\t \n  认领此bug,欢迎关注,好戏多的是,哈哈。    \n     2014-12-09 16:55 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @Taki 坐等    \n     2014-12-09 21:07 |    \t\t柯腾 \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:19        | 飞天科技-柯腾)\t\t \n  @CCAV  看这里    \n     2014-12-09 21:42 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  这是怎么做到的    \n     2014-12-10 17:00 |    \t\t帅气小狼狗 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 汪汪汪)\t\t \n  屌爆了    \n     2014-12-12 17:35 |    \t\tccav \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | ccav)\t\t \n  你好 我是ccav 我看到你了    \n     2014-12-14 13:09 |    \t\tMujj \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:4        | IDC商)\t\t \n  前排    \n     2015-01-05 19:36 |    \t\t马云 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:5        | 啪啪啪啪啪啪啪啪)\t\t \n  马克    \n     2015-01-14 11:24 |    \t\tlove of red moon \t\t\t( 实习白帽子  |\t\t\t        Rank:46 漏洞数:11        | )\t\t \n  吊炸天，cvv相当于密码啊......    \n     2015-01-26 21:07 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}