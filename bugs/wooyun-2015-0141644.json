{"id": 68190, "wybug_id": "wooyun-2015-0141644", "wybug_title": "某市汽车站网上售票系统取票密码获取漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "HCocoa", "wybug_date": "2015-09-18 21:00", "wybug_open_date": "2015-11-04 17:56", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "敏感接口未加权限认证", "安全意识不足", "未授权访问", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-20：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-09-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-04：\t细节向公众公开  简要描述： 无需登陆即可遍历获取所有订单的订单号和取票密码，仅凭借订单号和取票密码即可以去自动取票机拿到纸质车票，甚至直接上车。 详细说明：  网站会为每个订单生成一个二维码，二维码包含订单号和取票密码。通过订单号和取票密码可以拿到纸质车票，甚至直接上车。\n\n但是该二维码的访问没有做权限限制，无需登陆即可访问所有二维码。\nhttp://**.**.**.**/dzsw/viewOrder.ashx?order_id=20150916000001\n\nhttp://**.**.**.**/dzsw/viewOrder.ashx?order_id=20150916000002\n\nhttp://**.**.**.**/dzsw/viewOrder.ashx?order_id=20150916000003\n   漏洞证明：  直接访问\nhttp://**.**.**.**/dzsw/viewOrder.ashx?order_id=20150916000001\n，可以看到二维码，解析后得到订单号和取票密码。\n\n（上图解析出来订单号为20150916000001，取票密码为507747）\n\n（凭借订单号密码可以直接拿到纸质车票）URL：http://**.**.**.**/dzsw/viewOrder.ashx?order_id=20150916000001order_id格式很明显，前面是日期20150916，后面直接从1开始遍历，即可获得所有日期的所有车票二维码，解析可得所有取票密码。   修复方案：  为二维码访问页面增加访问控制   版权声明：转载请注明来源 HCocoa@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-09-20 17:54 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给安徽分中心，由安徽分中心后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}