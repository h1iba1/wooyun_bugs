{"id": 16324, "wybug_id": "wooyun-2012-014684", "wybug_title": "DEDECMS SQL注射漏洞", "wybug_corp": "DEDECMS", "wybug_author": "kiss", "wybug_date": "2012-11-13 09:33", "wybug_open_date": "2012-11-13 09:33", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-13：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-11-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 可注射到管理员密码。会员等 详细说明：  plus/bookfeedback.php.   小说模块。变量未初始化。导致注射。  不过默认不安装此模块。\nrequire_once(dirname(__FILE__).\"/../include/common.inc.php\");require_once(DEDEINC.\"/filter.inc.php\");require_once(DEDEINC.\"/channelunit.func.php\");..............\t//保存评论内容\tif($comtype == 'comments')\t{\t\t$arctitle = addslashes($arcRow['arctitle']);\t\t$arctitle = $arcRow['arctitle'];\t\tif($msg!='')\t\t{\t\t\t$inquery = \"INSERT INTO `#@__bookfeedback`(`aid`,`catid`,`username`,`arctitle`,`ip`,`ischeck`,`dtime`, `mid`,`bad`,`good`,`ftype`,`face`,`msg`)\t               VALUES ('$aid','$catid','$username','$bookname','$ip','$ischeck','$dtime', '{$cfg_ml->M_ID}','0','0','$feedbacktype','$face','$msg'); \";\t\t\t$rs = $dsql->ExecuteNoneQuery($inquery);\t\t\tif(!$rs)\t\t\t{\t\t\t\techo $dsql->GetError();\t\t\t\texit();\t\t\t}\t\t}\t}\t//引用回复\telseif ($comtype == 'reply')\t{\t\t$row = $dsql->GetOne(\"Select * from `#@__bookfeedback` where id ='$fid'\");\t\t$arctitle = $row['arctitle'];\t\t$aid =$row['aid'];\t\t$msg = $quotemsg.$msg;\t\t$msg = HtmlReplace($msg,2);\t\t$inquery = \"INSERT INTO `#@__bookfeedback`(`aid`,`typeid`,`username`,`arctitle`,`ip`,`ischeck`,`dtime`,`mid`,`bad`,`good`,`ftype`,`face`,`msg`)\t\t\t\tVALUES ('$aid','$typeid','$username','$arctitle','$ip','$ischeck','$dtime','{$cfg_ml->M_ID}','0','0','$feedbacktype','$face','$msg')\";\t\t$dsql->ExecuteNoneQuery($inquery);\t}\n$catid变量以及$typeid变量未初始化。造成   漏洞证明：  \n\n   修复方案：  对$catid变量以及$typeid变量未初始赋值   版权声明：转载请注明来源 kiss@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-11-13 12:17 |    \t\t小菜虫 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:5        )\t\t \n  怎么回事？？？一下就公开了啊    \n     2012-11-13 14:45 |    \t\t花开若相惜 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:8        | 技术无止境.)\t\t \n  跟上次发feedback.php的同样的问题    \n     2012-11-13 22:23 |    \t\tconqu3r \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:21        | 没有思想，没有道德，没有自由，没有人权的...)\t\t \n  确实    \n     2012-11-14 05:42 |    \t\t邪少 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:7        )\t\t \n  @conqu3r 。。我是菜鸟。。怎么利用    \n     2012-11-14 09:37 |    \t\tconqu3r \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:21        | 没有思想，没有道德，没有自由，没有人权的...)\t\t \n  @邪少 上面都说了是变量覆盖啊，直接在评论的地方，添加变量名和值，值就是注入语句撒。这个自己研究。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}