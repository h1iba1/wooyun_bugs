{"id": 80660, "wybug_id": "wooyun-2015-0155455", "wybug_title": "急速PDF阅读器任意账号激活及密码重置", "wybug_corp": "jisupdftoword.com", "wybug_author": "北海巨妖", "wybug_date": "2015-12-03 11:38", "wybug_open_date": "2016-01-19 18:20", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计缺陷", "急速"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-19：\t细节向公众公开  简要描述： 目标网址：http://www.jisupdftoword.com起因：老婆让我把一篇PDF转成word，于是下载了PDF阅读器，结果一看，我擦，PDF转word竟然不是免费的，看看支付宝，余额不过一份面包钱。于是，心里黑暗的那一面蠢蠢欲动...... 详细说明：  1.先用自己的QQ账号注册了一个会员，邮箱邮件激活 \n\n  看了一下显然，email字段是我的邮箱，sign是一个base64加密，随手解密了一下，一看，  我擦，竟然是我的邮箱......为了验证这货到底管不管用，我们注意到发件人的邮箱 10007@jisupdfto.com，用这个邮箱注册一个账号，结果发现已注册。算了，试试10000@jisupdfto.com吧，还好，不提示邮箱已注册，看来，自己家的网站都不捧场，好吧....\n\n密码是123456然后访问网址 http://www.jisupdftoword.com/user_validate?email=10000@jisupdfto.com&sign=MTAwMDBAamlzdXBkZnRvLmNvbQ== 进行激活\n\n激活成功，登录瞄瞄\n\n至此，任意邮箱注册账号并激活已经完成。2.试一试忘记密码，流程是，往邮箱发送一封邮件，里面有一个验证码，6为纯数字，然后输入进行重置密码。此处的6位纯数字，可以用burpsuite来爆破，因为貌似并木有什么次数限制。为了省时间，不这么玩。在接收验证码时，有如下情况\n\n嗯，ajax验证，返回0，就成功，好吧，我们假装它返回了0，直接访问跳转链接http://www.jisupdftoword.com/user_gotoresetpwd?email=10007@jisupdfto.com\n\n我擦...直接进入重置页面，未授权访问？输入123456  123456 确定\n\n修改成功，登录试试\n\n\n\n不懂为什么已经注册过的邮箱还要提示激活？难道从来就木有激活过？这可是内部邮箱哦...不过不怕，有前面的激活网址，咱自己激活http://www.jisupdftoword.com/user_validate?email=10007@jisupdfto.com&sign=MTAwMDdAamlzdXBkZnRvLmNvbQ==再次登录\n\nOK，登录成功，我晕，话说，为什么账户余额还是0...   漏洞证明：  如上。   修复方案：  1.稍微搞个麻烦点的加密2.ajax验证之后，服务器还是要验证的...对了，还有那个验证码，加个失效时间吧   版权声明：转载请注明来源 北海巨妖@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-12-05 16:02 厂商回复： 已修复，非常感谢@北海巨妖提供！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}