{"id": 67079, "wybug_id": "wooyun-2015-0143569", "wybug_title": "华润万家供应商服务系统XSS漏洞加系统越权（XSS可打到管理员）", "wybug_corp": "华润E万家", "wybug_author": "纳米翡翠", "wybug_date": "2015-09-26 13:32", "wybug_open_date": "2015-11-14 09:16", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-14：\t细节向公众公开  简要描述： 华润万家供应商服务系统XSS漏洞，可打到管理员越权可查看任意用户信息 详细说明：  供应商系统：http://121.34.249.229这个IP是遍历了一下主站的C段找到的（建议所有站前端放cdn，至少可以隐藏服务器真实IP ）进来之后点击下面的：原OLE、华东、西北、华北、全国供应商、原华南大超/标超的用户请点本链接进行登陆\n\n看到这下面的提示了吧，直接有一个账号，而就是这个账号，直接进了系统用户名19000016 密码123456\n\n\n\n进来之后点击消息管理--邮件--写邮件\n\n可以给管理员发邮件，也可以给其它人发邮件为了防止造成不良影响，这里给自己发个邮件，证明一下XSS的存在\n\n点击发送并抓包\n\n在收件箱看到刚给自己发送的邮件\n\nXSS已经成功执行\n\n由于cookie没有做httponly，所以直接拿过cookie即可登录成功\n\n那么只要给管理员发一封邮件，即可打到管理员的cookie,进而登录管理员账号再附加几个越权漏洞，即通过遍历ID可查看，删除别人的邮件和消息 查看邮件其实是调用了：\nhttp://121.34.249.229/scm/DaemonMail?operation=read&type=100&mailid=71267\n这里只要遍历mailid即可查看所有的邮件\n\n还可以通过\nhttp://121.34.249.229/scm/DaemonFileDownload?fileid=90374\n遍历别人上传的文件\n\n通过以下两个链接先后执行可查看其它用户的企业信息\nhttp://121.34.249.229/scm/DaemonSCMUserVender?operation=set&venderid=000016&buid=19&timestamp=1443240601506&\n\nhttp://121.34.249.229/scm/DaemonSCMVenderAdmin?focus=venderdiy&operation=list\n一定要两个先后执行，比如要查看000014用户的信息先执行\nhttp://121.34.249.229/scm/DaemonSCMUserVender?operation=set&venderid=000014&buid=19&timestamp=1443240601506&\n再执行\nhttp://121.34.249.229/scm/DaemonSCMVenderAdmin?focus=venderdiy&operation=list\n即可看到该企业的信息\n\n\n\n   漏洞证明：     修复方案：  xss邮件已经删除   版权声明：转载请注明来源 纳米翡翠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2015-09-30 09:14 厂商回复： 感谢提交 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}