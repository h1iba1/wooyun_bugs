{"id": 84873, "wybug_id": "wooyun-2016-0170518", "wybug_title": "腾讯企业邮存储型xss漏洞", "wybug_corp": "腾讯", "wybug_author": "小威", "wybug_date": "2016-01-17 08:59", "wybug_open_date": "2016-02-27 11:49", "wybug_type": "XSS 跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-27：\t细节向公众公开  简要描述： 经常翻看m大师傅的洞，偶尔茅塞顿开 详细说明：  企业邮移动端 http://m.exmail.qq.com/测试环境：firefox 最新版去年测试时候，腾讯已经我的payload进行了过滤，今天偶然翻看m大师傅发的漏洞，茅塞顿开！所以就有了此漏洞！在pc端 发送邮件，编辑时使用源码方式进行编辑\n\n因为腾讯对我的payload已经进行了过滤，所以猜测：如果我的payload有一万条呢？过滤器是不是会挨个给我过滤掉呢？测试中我用了一万五千多条payload， 粘贴进去，直接点击发送！收到邮件，看看效果！\n\n   漏洞证明：  \n\n   修复方案：  1.对后端不是很了解，大致就叫他过滤器吧，应该对邮件字符长度进行匹配，超出了长度，必然会导致跨站执行2.没有测试邮件内容长度有没有限制，如果可以，在邮件内容长度这里限制一下！   版权声明：转载请注明来源 小威@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-01-18 12:11 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-17 11:14 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:527 漏洞数:85        | 活到老，学到老!)\t\t \n  求个雷    \n     2016-01-18 12:14 |    \t\t玉林嘎  \t\t\t( 核心白帽子 |\t\t\t        Rank:933 漏洞数:107        )\t\t \n  吊吊吊    \n     2016-01-18 12:17 |    \t\tthewind \t\t\t( 普通白帽子  |\t\t\t        Rank:149 漏洞数:37        | 小白……)\t\t \n  前排混眼熟    \n     2016-01-18 12:22 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:76        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  我擦。。。我怎么就没想到。。。    \n     2016-01-18 12:34 |    \t\t红客十年 \t\t\t( 普通白帽子  |\t\t\t        Rank:376 漏洞数:76        | 去年离职富士康，回到家中上蓝翔，蓝翔毕业...)\t\t \n  终于看你放出来了    \n     2016-01-18 13:49 |    \t\t大师兄 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:8        | 每日必关注乌云)\t\t \n  原来是这样绕过的啊！    \n     2016-01-18 13:51 |    \t\t盛大网络(乌云厂商)\t\t \n  原来是这样绕过的啊！    \n     2016-01-18 13:54 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1081 漏洞数:182        | px1624)\t\t \n  这雷不了    \n     2016-01-18 14:00 |    \t\t岛云首席鉴黄师 \t\t\t( 普通白帽子  |\t\t\t        Rank:460 漏洞数:125        | icisaw.cn 超低价虚拟主机VPS 购买返现 支...)\t\t \n  @盛大网络 说的你好像知道了一样~吊吊的~    \n     2016-01-18 14:02 |    \t\tsword2 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:7        | 姿势很重要。)\t\t \n  原来是这样绕过的啊！    \n     2016-01-18 17:52 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:388 漏洞数:85        | 一个逗逼运维)\t\t \n  是每次cn修复了不修复enen修复了不修复企业企业修复了不修复移动端的pattern让你看出来了么 哈哈    \n     2016-01-18 18:08 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:527 漏洞数:85        | 活到老，学到老!)\t\t \n  @mramydnei 我提了个pc端 一个移动端， 然后说是重复的,其实他们都不一定知道    \n     2016-01-18 22:53 |    \t\t404notfound \t\t\t( 普通白帽子  |\t\t\t        Rank:259 漏洞数:71        | 考研中，有事请留言)\t\t \n  都特么搞腾讯    \n     2016-02-10 10:41 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1218 漏洞数:323        | 啥都不会....)\t\t \n  求你那一万五千多条payload    \n     2016-02-15 11:09 |    \t\t齐迹 \t\t\t( 普通白帽子  |\t\t\t        Rank:790 漏洞数:102        | 重庆地区招聘安全工程师。sec.zbj.com欢迎...)\t\t \n  求你那一万五千多条payload    \n     2016-02-18 17:08 |    \t\t#6c6c6c \t\t\t( 普通白帽子  |\t\t\t        Rank:300 漏洞数:50        | 像一条狗孤独的活着，渴望的活着，绝望的活...)\t\t \n  @齐迹 @M4sk 应该是复制粘贴，这里说的应该是长度问题    \n     2016-02-18 17:19 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:76        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  @mramydnei    哈哈，就在这个地方。反射xss，企业的，，我提交tsrc了。。。笑死了。。。这句话真经典。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}