{"id": 60179, "wybug_id": "wooyun-2013-044419", "wybug_title": "主机屋富文本编辑器提交内容未过滤导致存储型xss", "wybug_corp": "主机屋", "wybug_author": "路人甲", "wybug_date": "2013-12-05 15:19", "wybug_open_date": "2013-12-10 15:20", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-10：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 发现主机屋用户后台基本上有编辑器的地方都可以随便写代码，除了'号会被删除（貌似是处理sql时滤了），其他的都原封不动的保存并显示，这样的问题别人在乌云上也提交过，但没被重视，看样子总经理被沦陷也不见怪。一下内容是猜想的:页面被注入后，可以修改主框架内容，从而控制框架内的所有本域名下的数据，在框架没有被关闭的情况下可以所有内容到指定的服务器，还可以定期获取服务器端脚本命令执行，所有动作都在总经理不知情的情况下发生了。。。靠谱不？ 详细说明：  \n\n这个是总经理处理过的内容。只获取了页面的标题和cookie而已，如果要获取body里的内容也是轻而易举的。。管理后台简单的框架结构:\n{\t\"xss\":[\t\t{//iframe\t\t\t\"url\":\"http://admin.vhost.com/Jingliban.asp\",\t\t\t\"title\":\"经理办公室\",\t\t\t\"cookie\":\"ASPSESSIONIDAABBSDDQ=CLFJBJDDFKCAIDPLMJDKLEBF; ASPSESSIONIDACCDSAAQ=JILFHNGDDKOKAJGAIBDCPGHP; ASPSESSIONIDCACCRADQ=CAMLLDGDMHMLMJONICDDAJDK; SessionID=YYVMHMBCI9GYYFSQJ7369WGU4Z; ASPSESSIONIDCCDBQBDQ=MLEHPJGDAFAPODKODGPJFFOL; ASPSESSIONIDAABBSAAQ=DPBFNKFDAPFHFPAEKIMEKGLO; ASPSESSIONIDCAAARDDR=ABEPKFNDHDFOCFNAKBHDPCKG; ASPSESSIONIDCCADSADQ=BBNJIMFDHPDJENCGOKHJNIJN; ASPSESSIONIDCCCCSADQ=AKCBPKFDHMDNKBGPMMJBDLAL; ASPSESSIONIDCACBQBCQ=ADEPLKLDJBIEDJHGKJJNPHLN; ASPSESSIONIDAAAASACR=CGFBGNLDMOLGHOKIKMNKEEPA; ASPSESSIONIDCCBBRDDQ=JELJFFAAKFMOLMFMOELEJIAP; HTTP%5FREFERER=%2Fcmd%2FSys%5FCmd%2Easp%3Fcmd%3Dbmdok\"\t\t},\t\t{//main\t\t\t\"url\":\"http://admin.vhost.com/\",\t\t\t\"title\":\"主机屋后台管理中心\"\t\t}\t],\t\"time\":\"2013/11/29 14:00:20\",\t\"ip\":\"111.67.197.211\"}\n   漏洞证明：  见详细说明   修复方案：  对用户输入数据进行过滤，今天分析了一下QQ空间的的回复人家都用ubb代码返回服务器。。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-12-10 15:20 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}