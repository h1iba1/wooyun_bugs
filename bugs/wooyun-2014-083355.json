{"id": 46820, "wybug_id": "wooyun-2014-083355", "wybug_title": "安朗宽带认证计费解决方案缺陷可踢指定IP用户下线", "wybug_corp": "安朗", "wybug_author": "Knight", "wybug_date": "2014-11-15 11:34", "wybug_open_date": "2015-02-13 11:36", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "缺乏校验"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-13：\t细节向公众公开  简要描述： 整个网内的所有用户，任何网段，任何客户端（网页版，软件版）都受影响。受害者不会收到任何提示。可让全内网断网，独享光纤。影响用户包括但不止：http://www.amnoon.com/html/list_49.html 详细说明：  安朗宽带认证计费解决方案中有个网页版的认证方法。具体来说就是用户登录前打开的任何外网网页都将被劫持到网页版的认证地址。url类似于http://192.168.*.*/portalReceiveAction.do?wlanuserip=用户的IP&wlanacname=这个可以自定义这个url基本上都会被改得面目全非，就不截图了。如何确定是安朗？打开http://192.168.*.*登录你的账号密码。\n\n\n\n网页版客户端下线请求如图：\n\nwlanuserip字段即为当前电脑IP，由于网站后台并未对wlanuserip进行验证，当攻击目标IP所在网段wlanacname与本机相同时，通过修改该字段为攻击目标IP即可伪造其下线请求导致其下线。当攻击目标IP所在网段wlanuserip与本机不相同时，需要知道目标IP所在网段在内网的wlanacname（需要到与目标IP所在网段寻找），访问http://192.168.*.*/portalReceiveAction.do?wlanuserip=任意IP&wlanacname=目标IP所在网段的wlanacname，页面内会有wlanacip字段，相应修改wlanacname和wlanacip便可相应地伪造下线请求。发送下线请求后服务器回应如图：\n\n注：wlanacname和wlanacip出错时服务器仍会显示请求成功，但此时目标IP不会受到影响，一个内网内一般有一两个wlanacname，wlanacname与wlanacip一一对应。成功伪造下线请求使目标IP下线后目标IP不会收到任何提示（软件版客户端也一样没有任何提示），只是突然间访问的页面就被服务器劫持到网页认证，服务器对用户下线频率没有限制，可以不断伪造下线请求。通过伪造整个内网活动IP的下线请求即可让全内网断网，独享光纤。   漏洞证明：  \n\n提供测试代码有点鸡肋，毕竟大家都有burp。但说不定就有人给wb了呢？   修复方案：  后端验证   版权声明：转载请注明来源 Knight@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-11-20 08:17 厂商回复： cnvd未直接复现所述情况，由于未建立与设备厂商的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-15 12:45 |    \t\tevavus \t\t\t( 实习白帽子  |\t\t\t        Rank:80 漏洞数:11        | @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@...)\t\t \n  mark    \n     2014-11-15 14:31 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:31        | Hacked by @ringzero 我錯了)\t\t \n  @evavus 大表哥你好    \n     2014-11-16 09:14 |    \t\tRainShine \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:4        )\t\t \n  Mark    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}