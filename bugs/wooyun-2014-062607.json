{"id": 1872, "wybug_id": "wooyun-2014-062607", "wybug_title": "逐浪CMS特定版本疑似存在一个鸡肋后门", "wybug_corp": "逐浪CMS", "wybug_author": "wefgod", "wybug_date": "2014-05-28 14:11", "wybug_open_date": "2014-08-23 14:12", "wybug_type": "默认配置不当", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "敏感信息泄漏", "默认配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-02：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-23：\t细节向公众公开  简要描述： 特定版本有。包我都是从官网下的啊，文件的来源引人遐想。 详细说明：  Zoomla!CMS2_X1.0和Zoomla!CMS2_X1.1的插件文件夹下存在一个Plugins\\baike_editor\\uploadsss.php官方包下载地址：http://www.zoomla.cn/down/Zoomla!CMS2_X1.0.rarhttp://www.zoomla.cn/down/Zoomla!CMS2_x1.1.rar其它版本均未存在此文件。为什么说他鸡肋呢，先提下：1.php的，需要在iis集成了php的组件时才可能有机会利用；2.我一下子没想到他是否有更好的利用场景   漏洞证明：  \n<?php//中文$errno\t= 0;if (!isset($_FILES['userfile']) || 0 != $_FILES['userfile']['error']) {\t//上传失败\t$errno\t= 3;}if ($_FILES['userfile']['size'] > (1024 * 1024 * 3)) {\t//大于3M\t$errno\t= 1;}$clip\t= array();if (!isset($_FILES['userfile']['type']) || 0 === preg_match('~^image/(gif|jpeg|png)$~i', $_FILES['userfile']['type'], $clip)) { //mime头是image的就可以了\t//请求的mime-type不匹配\t$errno\t= 2;}$extName\t= $clip[1];$filePath\t= 'upload_files_demo/upload.' . $extName; //这也是鸡肋点if (!@move_uploaded_file($_FILES['userfile']['tmp_name'], $filePath)) {\t//保存失败\t$errno\t= 3;}?>\n本地随便测试了下：\n<html><form action=http://localhost:9000/z/Plugins/baike_editor/uploadsss.php  name=\"form\" method=\"post\" enctype=\"multipart/form-data\"><input type=file name=\"userfile\"  size=23 /><input type=submit value=Submit /></form></html>\n\n\n不过确实挺鸡肋的。   修复方案：  改下两个版本的包，去掉这个文件。   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-08-23 14:12 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-28 14:19 |    \t\twhat_news \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:48        | 小菜一个 希望成为大菜)\t\t \n  大牛 ！！！！！！    \n     2014-05-28 14:23 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  牛逼    \n     2014-05-28 14:49 |    \t\txlz0iza1 \t\t\t( 普通白帽子  |\t\t\t        Rank:1027 漏洞数:207        | \"><script/src=data:,alert(1)%2b\")\t\t \n  楼主开启了刷洞模式~    \n     2014-05-28 15:11 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  这个cms做的漏洞不是一般的多....    \n     2014-05-28 15:37 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @xlz0iza1 @光刃 @what_news 都蛋定，一个无用的小后门而已。实际中估计做不了什么。我本来认定这次就算可以通过也是小厂商流程的……不过因为我不擅长某语言，感觉看了半天没看出其它用法，就没办法深入了    \n     2014-05-28 20:09 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  这个cms做的漏洞不是一般的多....为什么我一个找不到    \n     2014-05-28 20:13 |    \t\twhat_news \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:48        | 小菜一个 希望成为大菜)\t\t \n  @在路上 有全局处理函数 能绕过就有漏洞了    \n     2014-05-28 20:48 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @what_news 以前的函数处理没那么严格    \n     2014-05-28 21:14 |    \t\tMoc \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:12        | 屌丝何苦为难屌丝)\t\t \n  @wefgod 大哥，逐浪都被你玩坏了    \n     2014-05-28 21:29 |    \t\txlz0iza1 \t\t\t( 普通白帽子  |\t\t\t        Rank:1027 漏洞数:207        | \"><script/src=data:,alert(1)%2b\")\t\t \n  @wefgod @Moc 应该说大汉和逐浪 都给他玩坏了。    \n     2014-05-28 22:37 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @xlz0iza1 没有，大汉是属于路人甲的    \n     2014-05-28 22:43 |    \t\txlz0iza1 \t\t\t( 普通白帽子  |\t\t\t        Rank:1027 漏洞数:207        | \"><script/src=data:,alert(1)%2b\")\t\t \n  @wefgod 你开的头嘛~粉木耳以黑。    \n     2014-05-29 18:44 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  @what_news 哦 @wefgod 打开电脑一看全是尼玛相关提醒    \n     2014-07-02 20:21 |    \t\twhat_news \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:48        | 小菜一个 希望成为大菜)\t\t \n  这版本有点低了吧 还有php代码。    \n     2014-07-03 10:03 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @what_news 提交的时候只到1.4，反正官方的包里面的，不排除别人会用到    \n     2014-08-24 08:41 |    \t\t老阎 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 求师傅带)\t\t \n  逐浪CMS无视本地测试、、、    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}