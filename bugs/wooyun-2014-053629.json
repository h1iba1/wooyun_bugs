{"id": 4533, "wybug_id": "wooyun-2014-053629", "wybug_title": "中国电信一个测试帐号引发的八个站点沦陷(shell+root)", "wybug_corp": "中国电信", "wybug_author": "Mr .LZH", "wybug_date": "2014-03-14 18:09", "wybug_open_date": "2014-04-28 18:10", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-28：\t细节向公众公开  简要描述： 猜解测试帐号一枚，后台强取shell，root权限。。。。。 详细说明：  地址：http://xj.bnet.cn/si/session/logout.do帐号：test  密码：000000进后台->产品流程管理->添加上传格式只做前端验证，上传截断，修改jpg成jsp\n\n上传成功，出现增加的项目\n\n进入，查看图片地址\n\n菜刀连接之，查看权限  root\n\n查看目录\n\n查看网站数目\n\n8个，而且都是什么管理平台的接下来看数据库？？不必了吧，下载网站的class反编译一下，得到数据库密码，直接菜刀连接数据库，如此简单的动作，不演示了。   漏洞证明：  \n\n\n\n\n\n\n\n   修复方案：  弱口令+上传漏洞+root权限+8个站点=rank 20 可否？？友情提示：产品流程管理里测试需要新建了2个项目，测试帐号无法删除，里面上传的2个webshell（一个不能使用）也还没删除，麻烦自己搞定吧。测试过程未留其他后门，未获取数据库内容   版权声明：转载请注明来源 Mr .LZH@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-03-20 22:29 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT直接通报给中国电信集团公司，由其后续着手处置，按信息泄露风险以及运行风险进行综合评分，rank 18 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-14 18:48 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  为什么点你的名字，迅雷会弹出下载框    \n     2014-03-14 20:00 |    \t\tMr .LZH \t\t\t( 普通白帽子  |\t\t\t        Rank:583 漏洞数:75        | 非妹子勿扰···)\t\t \n  @U神 额。。。你说的是什么情况，不是吧    \n     2014-03-14 20:04 |    \t\tMr .LZH \t\t\t( 普通白帽子  |\t\t\t        Rank:583 漏洞数:75        | 非妹子勿扰···)\t\t \n  @U神 我的名字里有半角的点号，应该是迅雷识别错误，以为Mr .LZH是文件名    \n     2014-03-16 16:04 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  @Mr .LZH 。此处应该有个猥琐的思路    \n     2014-03-16 16:57 |    \t\tMr .LZH \t\t\t( 普通白帽子  |\t\t\t        Rank:583 漏洞数:75        | 非妹子勿扰···)\t\t \n  @Master 可惜了，不猥琐    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}