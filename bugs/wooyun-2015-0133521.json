{"id": 67090, "wybug_id": "wooyun-2015-0133521", "wybug_title": "国家电网自动充值机程序设计问题可篡改数据库暴露用户信息", "wybug_corp": "国家电网公司", "wybug_author": "ChristopereRussell", "wybug_date": "2015-08-12 13:42", "wybug_open_date": "2015-11-13 18:26", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "越权", "国家电网", "浏览器漏洞利用技巧", "篡改数据库"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-10-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-13：\t细节向公众公开  简要描述： 国家电网公司的几乎所有自动充值都有的一个可越权的操作 详细说明：  现在的国家电网自动充值柜台机上面的架构是Apache和IE6/7浏览器，机器是触摸屏，很容易框选字符，很容易调出右键菜单，调出后可以选择所有加速器，然后就可以看到任务栏了，通过显示桌面和开始菜单可以进入我的电脑，通过输入法自带的键盘，和机器内预装的XP屏幕触摸程序，可以使用屏幕键盘，就可以篡改程序和数据库，每一个充值机器都是断网的，都是一个单独的客户端。包括可以关掉监控，删除监控，篡改数据库，修改PHP程序给自己充钱等等\n\n   漏洞证明：  这是越权之后查看系统属性的图片，\n\n\n\n\n\n\n\n   修复方案：  采用本地软件的形式，不要用APACHE+IE的这种架构，或者自己写一个浏览器取消右键菜单   版权声明：转载请注明来源 ChristopereRussell@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2015-08-15 18:24 厂商回复： 已实地验证，单一设备的配置问题，不是本地PHP程序，设备加有隔离，对数据无任何影响，且部分截图伪造，夸大漏洞危害。具体漏洞什么情况相信洞主心里明白，故1分。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-15 18:27 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:567 漏洞数:108        | 低调求发展)\t\t \n  =_=什么情况    \n     2015-08-15 19:26 |    \t\t大物期末不能挂 \t\t\t( 普通白帽子  |\t\t\t        Rank:132 漏洞数:23        | 1.一个学渣，只求每门都不挂2.想把漏洞提...)\t\t \n  厂商的迷之回复，坐等公开看详情    \n     2015-08-15 23:25 |    \t\tChristopereRussell \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 高中生一只，爱好计算机)\t\t \n  不知道厂商什么意思，四川成都这边我验证了3台，都有这个问题，如果不是本地php至少有apache。    \n     2015-08-15 23:28 |    \t\tChristopereRussell \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 高中生一只，爱好计算机)\t\t \n  试问，如果不是本地php试问apache用来做什么？    \n     2015-08-16 00:55 |    \t\t柯腾 \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:19        )\t\t \n  留名，等公开看看到底啥情况    \n     2015-08-16 19:12 |    \t\tSamsong \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | Student.)\t\t \n  关注了    \n     2015-08-22 14:07 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1205 漏洞数:261        | 爱生活、爱腾讯、爱网络！)\t\t \n  厂商说你伪造    \n     2015-08-22 14:25 |    \t\tChristopereRussell \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 高中生一只，爱好计算机)\t\t \n  @机器猫 I see,有些原因你懂的。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}