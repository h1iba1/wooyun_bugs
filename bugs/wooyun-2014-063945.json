{"id": 1576, "wybug_id": "wooyun-2014-063945", "wybug_title": "万户ezOFFICE无限制任意文件上传可getshell3（7处打包）", "wybug_corp": "万户", "wybug_author": "北京方便面", "wybug_date": "2014-06-07 20:05", "wybug_open_date": "2014-09-05 20:06", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "任意文件上传", "文件上传安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-05：\t细节向公众公开  简要描述： 万户ezOFFICE无限制任意文件上传可getshell3（7处打包）被说剽窃 真破坏心情 详细说明：  1、defaultroot/public/editor/tpsc.jsp2、defaultroot/public/editor/1_tpsc.jsp3、defaultroot/work_flow/formOptJSPUpload.jsp （上传后路径：/defaultroot/work_flow/文件名）4、defaultroot/work_flow/formStartJSPUpload.jsp（上传后路径：/defaultroot/work_flow/文件名）5、http://oa.polyfilm.net:7001/defaultroot/govezoffice/custom_documentmanager/smartUpload.jsp?path=innerMailbox&fileName=innerMailFileName&saveName=innerMailSaveName&tableName=innerMaildisplaytable&fileMaxSize=0&fileMaxNum=0&fileType=&fileMinHeight=0&fileMinWidth=0&fileMaxHeight=0&fileMaxWidth=06、http://hljxwjtheb.vicp.cc:7001/defaultroot/custom_form/smartUpload.jsp?path=innerMailbox&fileName=innerMailFileName&saveName=innerMailSaveName&tableName=innerMaildisplaytable&fileMaxSize=0&fileMaxNum=0&fileType=&fileMinHeight=0&fileMinWidth=0&fileMaxHeight=0&fileMaxWidth=0\n<%if(request.getParameter(\"flag\") != null){    myUpload.initialize(pageContext);    myUpload.upload();    for(int j=0;j<myUpload.getFiles().getCount();j++){        com.jspsmart.upload.File myFile = myUpload.getFiles().getFile(j);        if(!\"jsp\".equals(myFile.getFileExt())){            %>            <script language=\"javascript\">            alert(\"<bean:message bundle=\"workflow\" key=\"workflow.workflowuploadjspfile\"/>\");            </script>            <%        }else{            myFile.saveAs(\"\\\\work_flow\\\\\" + myFile.getFileName());            %>            <script language=\"javascript\">            opener.document.all.startJSPName.value = '<%=myFile.getFileName()%>';            window.close();            </script>            <%        }    }}%>\n7、http://hljxwjtheb.vicp.cc:7001//defaultroot/public/jsp/goodsphotoupload.jsp?path=goodspic&visualName=goodsPicName&hiddenName=goodsPicName&del=yeshttp://oa.polyfilm.net:7001/defaultroot/public/editor/1_tpsc.jsphttp://www.baidu.com/s?cl=3&wd=Wanhu+ezOFFICEhttp://74.125.227.77/#newwindow=1&q=Wanhu+ezOFFICE&start=20   漏洞证明：  \n\n\n\nhttp://oa.zjcof.com.cn/defaultroot/public/editor/tpsc.jsphttp://oa.polyfilm.net:7001/defaultroot/public/editor/tpsc.jsphttp://hljxwjtheb.vicp.cc:7001/defaultroot/public/editor/tpsc.jsphttp://61.191.17.216:7001/defaultroot/public/editor/tpsc.jsphttp://222.178.221.54:7001/defaultroot/public/editor/tpsc.jsphttp://lnjoa.vicp.net:88/defaultroot/public/editor/tpsc.jsphttp://219.136.247.248:7001/defaultroot/public/editor/tpsc.jsp   修复方案：     版权声明：转载请注明来源 北京方便面@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-06-11 16:42 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-07 20:20 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  顶洞主，支持wooyun。。    \n     2014-06-07 20:22 |    \t\t么么哒 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 么么哒)\t\t \n  为什么这系统这么多上传功能的jsp。。。。    \n     2014-06-07 20:42 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  信洞主    \n     2014-06-07 23:02 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  2014-06-05，提交漏洞2014-06-05，漏洞概要通过验证2014-06-05，已同意360估价2014-06-05，上传了漏洞并等待确认2014-06-06，已通知厂商    \n     2014-06-07 23:04 |    \t\t么么哒 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 么么哒)\t\t \n  @U神 哇，大神好厉害呀，又去360刷rmb啦。    \n     2014-06-07 23:21 |    \t\t北京方便面  \t\t\t( 核心白帽子 |\t\t\t        Rank:876 漏洞数:66        | 我爱吃北京方便面)\t\t \n  呵呵    \n     2014-06-07 23:34 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  我信洞主！    \n     2014-06-07 23:59 |    \t\t0749orz \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:4        | 厌了，烦了~~~)\t\t \n  我信洞主！得永生    \n     2014-06-11 21:51 |    \t\t好基友一辈子 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:37        )\t\t \n  @xsser  心情很不美丽，同样是万户的通用洞，，我的任意下载就一个rank都没有。。就说了一句忘了给了。。。    \n     2014-06-11 22:00 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  @好基友一辈子 不是给你发钱了么。。    \n     2014-06-12 06:57 |    \t\t好基友一辈子 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:37        )\t\t \n  @瘦蛟舞 哈哈发发牢骚而已，，    \n     2014-09-05 22:36 |    \t\tyinian \t\t\t( 实习白帽子  |\t\t\t        Rank:67 漏洞数:22        | 代 码 审 计 求 交 流)\t\t \n  LZ赚翻了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}