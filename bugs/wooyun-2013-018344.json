{"id": 13857, "wybug_id": "wooyun-2013-018344", "wybug_title": "寺库网（SECOO）查看任意用户订单，全是奢侈品啊", "wybug_corp": "寺库中国", "wybug_author": "xfkxfk", "wybug_date": "2013-02-05 11:08", "wybug_open_date": "2013-03-22 11:08", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "敏感接口未加权限认证", "越权操作", "用户敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-02-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-02-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-03-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-22：\t细节向公众公开  简要描述： 寺库网（SECOO）——寺库是目前国内规模最大、品类最全的高端奢侈品折扣平台。存在查看任意用户订单漏洞，里面全是几千几万的奢侈品啊，都是有钱淫。。。 详细说明：  \n这里是测试，不想注册，就随便试了几个账户，然后就拿tester这个用户进行测试了。\n1、首先自己下了个订单，然后看了下我的订单详情：\nurl地址：http://www.secoo.com/userCenter/orderCtrl/detail?orderId=201302044685\n看见url里面有个orderId，然后就好奇了，能不能看其他订单信息呢？然后就随便改一个orderId号：\nurl地址：http://www.secoo.com/userCenter/orderCtrl/detail?orderId=201302044682\n果然看到了订单详细信息，大喜，我的乖乖的，里面都是好东西，不好的是，用户的信息全部泄露了，姓名，手机号码，详细送货地址，邮箱，邮编等等，太可怕了，赤裸裸了。。。2、刚开始以为这个orderId是有当前年月日+4位伪随机数组成，为了证明订单号的规律，然后就暴力遍历了一下，我从\n20130204111——20130204555\n为payload，开始遍历了一下哪些是有效的订单号，最后发现这个订单号的4位随机数是连续的！！！从遍历的结果中可以看出来。3、下面我们来看看漏洞证明：   漏洞证明：  1、我自己生成的订单：\n\n2、随机猜测的订单号：\n\n3、暴力遍历一下有效订单号，从返回长度很容易看出哪些payload是有效订单号：\n\n\n\n4、看一下遍历出来的有效订单的详细信息，这里就列出其中三个。\n\n\n\n\n\n   修复方案：  控制用户权限。求rank，求礼物，求修复。。。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2013-02-05 13:43 厂商回复： 该漏洞已弥补，感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-02-05 11:46 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:143        | 心在，梦在)\t\t \n  有特么一个奇葩厂家呀-_-||    \n     2013-02-05 11:50 |    \t\t瓜瓜 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:25        )\t\t \n  你好，我是寺库中国技术负责人，我公司已发现并弥补该漏洞，请去除该漏洞信息，谢谢。..这个简介。。。    \n     2013-02-05 11:53 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @瓜瓜 你好，我是没办法取出的，请@wooyun    \n     2013-02-05 11:59 |    \t\t瓜瓜 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:25        )\t\t \n  @xfkxfk 呃。。我不是厂商。。。我看到厂商的简介了。。。@xsser     \n     2013-02-05 12:37 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @瓜瓜 哦，吓死我了，我以为你就是厂商列，才看到厂商信息    \n     2013-02-05 13:54 |    \t\t寺库中国(乌云厂商)\t\t \n  你们好，我是寺库中国技术负责人，请@xfkxfk确认漏洞修复，请@wooyun协助消除该消息。谢谢。    \n     2013-02-05 14:43 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @风萧萧  @se55i0n 好像厂商不欢迎我们 你们上    \n     2013-02-05 14:56 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @寺库中国 验证已修复，不能看到其他用户的信息了，挺快的额    \n     2013-02-05 14:57 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @小胖胖要减肥 @风萧萧 @se55i0n 能来wooyun的厂商应该都挺关注安全的，它们不会这么小气吧？！    \n     2013-02-05 17:07 |    \t\t寺库中国(乌云厂商)\t\t \n  各位好 @瓜瓜 @小胖胖要减肥 @风萧萧 @se55i0n @xfkxfk ，首先感谢各位为寺库中国的漏洞做出的建议，我们很欢迎各位在网站安全方面做出的贡献，对于已经发现了漏洞我们已经在进行修改，只是处于安全考虑，请在公开的漏洞描述中简单描述问题，不要过于详细，防止别有用心的人理解问题所在，进行恶意炒作，也请理解我们的顾虑，再次感谢各位。    \n     2013-02-05 18:36 |    \t\tO.o \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:12        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  这。。。。厂商略犇    \n     2013-02-05 21:01 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @小胖胖要减肥 你@我干什么，奇葩厂商没兴趣~    \n     2013-02-06 10:19 |    \t\t \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:3        | 博客寻友链 http://imlonghao.com/)\t\t \n  在我的记忆中乌云没有删过一个漏洞，除了手快发多的。。    \n     2013-02-06 13:47 |    \t\tO.o \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:12        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  @ 你的ID很不错啊~    \n     2013-03-07 21:20 |    \t\tTituX \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | <script></script>)\t\t \n  请求删除漏洞的违反乌云精神了吧    \n     2013-03-22 21:34 |    \t\tcircus \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:4        | 你会为一件事去说一句话,也会为一句话去干...)\t\t \n  @寺库中国 已经公开了好不好- -既然漏洞修复了 也无妨了。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}