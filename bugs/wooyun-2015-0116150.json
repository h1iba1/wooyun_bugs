{"id": 14590, "wybug_id": "wooyun-2015-0116150", "wybug_title": "篱笆网重置任意用户密码（管理员帐户测试）", "wybug_corp": "篱笆网", "wybug_author": "千斤拨四两", "wybug_date": "2015-06-03 09:04", "wybug_open_date": "2015-07-22 13:24", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-22：\t细节向公众公开  简要描述： 篱笆网，原名无忧团购网对于商家篱笆网是宣传媒体，是营销顾问，是销售渠道。通过篱笆网，商家可以针对准确的目标客户群进行产品最有效的宣传，网站还可以为商家提供专业的营销顾问服务，协助商家轻松开拓网络销售渠道，快速提升销售量。篱笆网是交流平台，是采购顾问，是消费保镖。通过篱笆网，会员可以学习交流消费知识、消费信息，更可通过网站、电话、团购卡等方式与网站商家进行交易，在享受优惠价格的同时，获得消费安全保障。 详细说明：  0x1:申请了个账号熟悉重置密码的流程，拿关键点来说吧！\n\n输入正确的验证码抓取响应包返回重置密码的正确地址！\nHTTP/1.1 200 OKDate: Mon, 25 May 2015 10:02:00 GMTServer: ApacheX-Powered-By: PHP/5.2.9Set-Cookie: sessionhash=deleted; expires=Sun, 25-May-2014 10:01:59 GMT; path=/; domain=.liba.comSet-Cookie: f_sm_vc=deleted; expires=Sun, 25-May-2014 10:01:59 GMT; path=/; domain=.liba.comVary: Accept-Encoding,User-AgentContent-Length: 123Keep-Alive: timeout=1, max=100Connection: Keep-AliveContent-Type: text/html;charset=utf-8{\"status\":1,\"result\":\"\",\"message\":\"RIGHT_MOBILE_VERIFY_CODE\",\"redirect\":\"findPassword.php?step=5&t=mobile&user_name=doum0\"}\n现在重要的数据抓到了，就来测试admin的用户！0x2：输入管理员的帐户！\n\n点击下一步可以看到admin没有绑定手机号，那就用自己申请的用户绑定了手机号，看下面操作。\n\n在点击手机号时截断数据包，修改username为admin不过这还没完继续向下看！\n\n输入doum0对应的手机号是不能获取到验证码的，会说与用户名不匹配，但是admin又没有绑定手机号。\n\n这里就要修改响应包的数据，把0改成1就能将显示已发送验证码，但是不会接到验证！\n\n   漏洞证明：  0x4：现在随意在输入验证码，下一步截断数据修改响应包。\n\n把我们第一次到重置密码页面的响应包对应修改，我们随意输入的手机号和验证码肯定是错误的！\n\n修改数据如下，就能轻松绕过！\n\n到了重置密码的页面，修改密码wooyun123\n\n\n\n重置成功！\n\n登录admin验证！\n\n\n\n   修复方案：  完善服务端的验证机制！有没有礼物啊，求礼物啊，啊哈哈！！！   版权声明：转载请注明来源 千斤拨四两@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-06-07 13:22 厂商回复： 已安排修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-03 09:22 |    \t\tnull_z \t\t\t( 普通白帽子  |\t\t\t        Rank:251 漏洞数:30        )\t\t \n  看来思路不同，关注。    \n     2015-07-24 00:18 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @千斤拨四两 为什么不直接访问step5的页面，或者在step6时替换用户名？反正没其他验证    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}