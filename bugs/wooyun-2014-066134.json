{"id": 2316, "wybug_id": "wooyun-2014-066134", "wybug_title": "某省电信可任意查询该省电信用户当前余额或欠费（发现土豪）", "wybug_corp": "中国电信", "wybug_author": "路人甲", "wybug_date": "2014-06-25 08:28", "wybug_open_date": "2014-08-09 08:30", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "17", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-09：\t细节向公众公开  简要描述： 可批量快速查询土豪话费余额，导出为excel 详细说明：  【山东电信】 接口地址： http://sd.189.cn/selfservice/pay/getOweCharge漏洞页面：http://sd.189.cn/selfservice/promotion/campus该活动只限学生用户参加，但是如果输入一个普通的山东电信的手机号码，可以通过修改第一个请求的返回值来触发第二个查询话费余额的请求。第一个请求是查询是否是校园用户\n\n第一个请求的返回值\n\n第一个请求的返回值修改只是为了触发第二个请求；第二个请求查询是否欠费（实际上返回的是用户的余额）\n\n第二个请求的返回值\n\n【上图的balance为用户余额，owecharge为用户欠费】下图为通过该用户的微信营业厅查询的实际余额，确实为上述余额\n\nowecharge为欠费，可通过代码查看到对于owecharge的处理\n\n修改owecharge的返回值可看到页面显示用户的欠费金额，故可确认该处确实为用户的欠费金额。\n\n   漏洞证明：  批量获取土豪手机话费余额或欠费\n\n发现土豪！！！ 余额7k多。。。   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-06-29 21:22 厂商回复： CNVD确认并复现所述情况（由山东分中心协助验证），已经转由CNCERT下发给山东分中心，由其后续协调当地基础电信企业处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-25 09:16 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  如何土豪啊？我见过一次是有几万话费的，最高等级……    \n     2014-06-25 09:21 |    \t\tJJFly \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | <a href=\"www.yidianjiujijifly.com\">www.y...)\t\t \n  何为壕，见过有欠费几万的。。还继续用着的。。    \n     2014-06-25 11:53 |    \t\treality0ne \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:7        )\t\t \n  mark等公开~有些公司里预付费的账户欠费可怕照样能用= =    \n     2014-08-31 13:53 |    \t\t炊烟 \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:44        | 每一天都需要努力。)\t\t \n  这号码真好    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}