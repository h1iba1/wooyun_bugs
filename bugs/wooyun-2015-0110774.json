{"id": 32599, "wybug_id": "wooyun-2015-0110774", "wybug_title": "猫扑网配置不当，导致CSRF漏洞劫持登录任意用户", "wybug_corp": "猫扑", "wybug_author": "q601333824", "wybug_date": "2015-04-28 09:33", "wybug_open_date": "2015-07-27 13:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "逻辑错误", "设计不当导致攻击界面扩大"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-01：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-27：\t细节向公众公开  简要描述： 为了和微博妹子聊天，昨天和BUG吧吧主借了新浪微博的大V帐号想去找妹子搭讪，但是事后想想算了，如果聊到最后，他突然把密码改了，妹子跟他跑了咋办...........嗯，太机智了 详细说明：     1.这次这个是第五个例子，都是因为对于快速用户的疏忽导致的   和 WooYun: 乐视网CSRF漏洞可重置任意用户密码 原理一样  2.用第三方帐号登录网站，然后会看到一个邮箱激活的地方，抓包 \n\n \n\n  3.写成一个post表单 \n<html><body><form id=\"csrf\" name=\"csrf\" action=\"http://hi.mop.com/user/profile/sendActiveEmail\" method=\"POST\"><input type=\"text\" name=\"email\" value=\"601333824@qq.com\" /><script>\tdocument.csrf.submit();</script></body></html>\n   4.当用户的访问表单的时候，会往601333824@qq.com发送一封激活邮箱的邮件   但是并不会更改用户的邮箱，而是直接登录用户帐号，所以说，只要对方访问表单，我就得到一个连接，然后就能不用密码登录他的帐号，如图(我用两个浏览器测试，因为效果比较明显)  ①.现在是360极速浏览器登录帐号\n\n  ②.访问表单。 \n\n  ③.打开火狐浏览器登录QQ邮箱，可以看到已经接受到邮件了，这个时候火狐浏览器的猫扑帐号没有登录，如图 \n\n  ④.邮件里面的连接\n\n  ⑤。访问连接，看吧，在访问连接的时候，火狐浏览器已经成功登录对方的帐号了 \n\n   ⑥.看吧，最后效果，就是，对方访问了CSRF连接，这个时候邮件把连接发到我的邮箱，我只要访问那个连接，就能登录对方帐号了............................. \n\n-----------------------------------------------------------------------------------   以前提交的漏洞，加上这次，算起来应该是第五次了，都是因为忽视快了速登录导致的，虽然效果不一样，但是实现的原理基本是一样，利用的就是一些厂家对快速登录帐号的忽视    ①. WooYun: 爱拍原创视频网csrf任意用户密码重置漏洞 (这个是因为快速登录之后接口校验不严格)   ②. WooYun: 百度传课物理路径泄漏 (这个也是因为快速登录接口校验不严格)   ③. WooYun: 乐视网CSRF漏洞可重置任意用户密码 (这个额也是因为快速登录接口校验不严格)  ④。 WooYun: 凤凰网首页XSS  Rookit可向用户推送广告(影响多个分站) （这个也是因为对快速登录校验不严格，随便创建无用的数据）    漏洞证明：    1.漏洞证明看上面，  2.审核人的测试的时候可以改成自己的邮箱测试   3.还有就是，一个邮箱，可以接收好几个帐号的激活邮件，意思就是说，只要我把这个发布到社区，邮件能拿到很多帐号(我是好人，不干这种事),如图(这些是我测试帐号，为了证明一个邮件能接受好多帐号的邮件，图上就已经接受了两个了) \n\n   修复方案：     ①.还是那句话，不要小看快速登录帐号了  ②.修复你们比我懂  ③.顺便求高点的rank,一直都是5分，6分的.....=_=....   版权声明：转载请注明来源 q601333824@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-04-28 13:00 厂商回复： 谢谢，非常感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}