{"id": 55380, "wybug_id": "wooyun-2014-061139", "wybug_title": "PHPEMS (在线考试系统) 注入 第一枚。", "wybug_corp": "PHPEMS", "wybug_author": "′雨。", "wybug_date": "2014-05-19 17:50", "wybug_open_date": "2014-08-17 17:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-19：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-08-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 过滤不严。 详细说明：  \npublic function getClientIp()\t{\t\tif(!isset($this->e['ip']))\t\t{\t\t\tif (getenv(\"HTTP_CLIENT_IP\") && strcasecmp(getenv(\"HTTP_CLIENT_IP\"), \"unknown\"))\t\t\t\t$ip = getenv(\"HTTP_CLIENT_IP\");\t\t\telse if (getenv(\"HTTP_X_FORWARDED_FOR\") && strcasecmp(getenv(\"HTTP_X_FORWARDED_FOR\"), \"unknown\"))\t\t\t\t$ip = getenv(\"HTTP_X_FORWARDED_FOR\");\t\t\telse if (getenv(\"REMOTE_ADDR\") && strcasecmp(getenv(\"REMOTE_ADDR\"), \"unknown\"))\t\t\t\t$ip = getenv(\"REMOTE_ADDR\");\t\t\telse if (isset($_SERVER['REMOTE_ADDR']) && $_SERVER['REMOTE_ADDR'] && strcasecmp($_SERVER['REMOTE_ADDR'], \"unknown\"))\t\t\t\t$ip = $_SERVER['REMOTE_ADDR'];\t\t\telse\t\t\t\t$ip = \"unknown\";\t\t\t$this->e['ip'] = $ip;\t\t}\t\treturn $this->e['ip'];\t}\n这里x-forwarded-for可控 无过滤。在注册的时候调用了这个函数。造成了注入。   漏洞证明：  测试一下官网。\n\n成功。   修复方案：  过滤。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}