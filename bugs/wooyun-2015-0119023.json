{"id": 13756, "wybug_id": "wooyun-2015-0119023", "wybug_title": "苏宁某重要站点7处SQL注射三到六打包提交", "wybug_corp": "江苏苏宁易购电子商务有限公司", "wybug_author": "DloveJ", "wybug_date": "2015-06-09 11:24", "wybug_open_date": "2015-07-24 12:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-24：\t细节向公众公开  简要描述： 苏宁某重要站点7处SQL注射三 详细说明：  3.没有重复,具体看包\n注入点：弹性计算>云服务器>搜索\n\n\n\nGET /api.htm?noCache=1433836062162&active=&command=queryVmInstances&keyword=1&pageNumber=1 HTTP/1.1Host: sws.suning.comProxy-Connection: keep-aliveAccept: application/json, text/plain, */*User-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36Referer: http://sws.suning.com/console.htmlAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: ZONE_ID=z-nj1; JSESSIONID=fIU5qrxIh1xaM6tjgYJxZ-uD.master:fserver2\n\n注入参数:keyword=1\n\n1正常；1'错误\n\n\n\nPreparedStatementCallback; bad SQL grammar [SELECT COUNT(*) count FROM T_INSTANCE_INFO_VIEW WHERE vmStatus != 0 AND zoneId = ? AND userId = ? AND (vmUuid like '%1'%' OR vmName like '%1'%') ]; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '%' OR vmName like '%1'%')' at line 1\n\nSELECT COUNT(*) count FROM T_INSTANCE_INFO_VIEW\n   漏洞证明：  4.\nhttp://sws.suning.com/\n弹性计算>硬盘>搜索\n搜索1正常\n\n\n\n搜索1'错误\n\n\n\nPreparedStatementCallback; bad SQL grammar [SELECT COUNT(*) count FROM T_VOLUMES WHERE STATUS != 0 AND RDS_TYPE = 0 AND USER_ID = ? AND ZONE_ID = ? AND (UUID like '%1'%' OR NAME like '%1'%')]; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '%' OR NAME like '%1'%')' at line 1\n\nSELECT COUNT(*) count FROM T_VOLUMES\n5.\nhttp://sws.suning.com/\n弹性计算>备份>搜索\n搜索1正常\n\n\n\n搜索1'错误\n\n\n\nPreparedStatementCallback; bad SQL grammar [SELECT COUNT(*) count FROM T_BACKUPS_INFO_VIEW WHERE STATUS != 0 AND USER_ID = ? AND ZONE_ID = ? AND ( UUID like '%1'%' OR NAME like '%1'%' ) ]; nested exception is com.mysql.jdbc.exceptions.jdbc4.MySQLSyntaxErrorException: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '%' OR NAME like '%1'%' )' at line 1\n\nSELECT COUNT(*) count FROM T_BACKUPS_INFO_VIEW\n6.\nhttp://sws.suning.com/\n\n第一处：弹性计算>网络>搜索>\n\n\n\n第二处:弹性计算>公网ip>搜索\n\n\n\n第三处:弹性计算>SSH密钥>搜索\n\n\n\n第四处:弹性计算>影像>搜索\n\n\n   修复方案：  你懂的。。   版权声明：转载请注明来源 DloveJ@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-06-09 11:42 厂商回复： 感谢提交，请证明能获取到数据。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-09 12:25 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  @江苏苏宁易购电子商务有限公司 我就一个小菜，我是不能获取数据。sql语句也没学过！你要是觉得危害不大或者没有危害，就不要修复。你把漏洞公开看看，看看乌云上的大牛可不可以把数据拿下！！！    \n     2015-06-09 13:33 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @DloveJ 有10rank，满足吧    \n     2015-06-09 13:40 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  @px1624 但是厂商的意思好像没有危害啊    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}