{"id": 10720, "wybug_id": "wooyun-2013-023731", "wybug_title": "ecshop最新版本存储XSS至后台", "wybug_corp": "ShopEx", "wybug_author": "blue", "wybug_date": "2013-05-14 17:53", "wybug_open_date": "2013-08-12 17:53", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-17：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-07-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-12：\t细节向公众公开  简要描述： 存储XSS，你懂的，赠送给乌云，俺貌似只是可能大概想连载下～ 详细说明：  下订单时，收货人信息里，未对电子邮件地址进行有效的过滤（未过滤双引号），导致在后台订单列表页及订单详情页可XSS.\n/flow.php  373行        $consignee = array(            'address_id'    => empty($_POST['address_id']) ? 0  :   intval($_POST['address_id']),            'consignee'     => empty($_POST['consignee'])  ? '' :   compile_str(trim($_POST['consignee'])),            'country'       => empty($_POST['country'])    ? '' :   intval($_POST['country']),            'province'      => empty($_POST['province'])   ? '' :   intval($_POST['province']),            'city'          => empty($_POST['city'])       ? '' :   intval($_POST['city']),            'district'      => empty($_POST['district'])   ? '' :   intval($_POST['district']),            'email'         => empty($_POST['email'])      ? '' :   compile_str($_POST['email']), //compile_str只是对<>进行了处理            'address'       => empty($_POST['address'])    ? '' :   compile_str($_POST['address']),            'zipcode'       => empty($_POST['zipcode'])    ? '' :   compile_str(make_semiangle(trim($_POST['zipcode']))),            'tel'           => empty($_POST['tel'])        ? '' :   compile_str(make_semiangle(trim($_POST['tel']))),            'mobile'        => empty($_POST['mobile'])     ? '' :   compile_str(make_semiangle(trim($_POST['mobile']))),            'sign_building' => empty($_POST['sign_building']) ? '' :compile_str($_POST['sign_building']),            'best_time'     => empty($_POST['best_time'])  ? '' :   compile_str($_POST['best_time']),        );\n   漏洞证明：  \n\n后台订单列表\n\n后台订单详情\n\ncookie收集\n\n   修复方案：  后台输出时escape   版权声明：转载请注明来源 blue@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2013-05-14 19:46 厂商回复： 非常感谢您为shopex信息安全做的贡献我们将尽快修复非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-14 17:54 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  赠送给乌云啊...    \n     2013-05-14 18:08 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @xsser 额，奖金捐给乌云了额。    \n     2013-05-14 18:16 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  @xsser 真有奖金吗    \n     2013-05-14 18:40 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Rookie 理论上是有的    \n     2013-05-16 15:37 |    \t\tby:安全者 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 只做安全者，不做入侵者！)\t\t \n  我发现太邪恶了大牛我来学习了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}