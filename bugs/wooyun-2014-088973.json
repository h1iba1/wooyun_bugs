{"id": 46899, "wybug_id": "wooyun-2014-088973", "wybug_title": "机锋网某JBOSS中间件部署接口未删除", "wybug_corp": "机锋网", "wybug_author": "路人甲", "wybug_date": "2014-12-27 19:52", "wybug_open_date": "2015-02-10 19:54", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-10：\t细节向公众公开  简要描述： 机锋网某JBOSS中间件部署接口未删除，存在安全隐患 详细说明：  \nhttp://data.gfan.com/invoker/JMXInvokerServlet/\nJboss在默认安装的时候，会安装http-invoker.sar站点,其web.xml配置如下：\n\n可知当请求invoker/JMXInvokerServlet或invoker/EJBInvokerServlet会调用org.jboss.invocation.http.servlet.InvokerServlet.class处理请求。该类对GET请求和POST请求，统一调用processRequest函数处理.\n\n该漏洞主要原因是jboss直接获得客户端提交数据进行反序列化，获得对象，然后调用对象。\n\n因此，攻击者需要自己构造一个jboss的类，并且将其序列化，然后将序列化的数据直接提交到存在漏洞站点的invoker/JMXInvokerServlet页面，恶意代码将会被执行。   漏洞证明：  \nsr $org.jboss.invocation.MarshalledValue晏嘌鬔袡  xpz     椰?sr (org.jboss.invocation.InvocationException蟃憹觿J L causet Ljava/lang/Throwable;xr java.lang.Exception旋>;?  xr java.lang.Throwable掌5'9w杆 L causeq ~ L detailMessaget Ljava/lang/String;[ stackTracet [Ljava/lang/StackTraceElement;xpq ~ pur [Ljava.lang.StackTraceElement;F*<<?9  xp   sr java.lang.StackTraceElementa\t艢&6輩 I lineNumberL declaringClassq ~ L fileNameq ~ L methodNameq ~ xp   紅 0org.jboss.invocation.http.servlet.InvokerServlett InvokerServlet.javat processRequestsq ~ \t   謖 ~ q ~ t doGetsq ~ \t  it javax.servlet.http.HttpServlett HttpServlet.javat servicesq ~\n   修复方案：  删除改接口   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2014-12-27 22:53 厂商回复： 已处理，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}