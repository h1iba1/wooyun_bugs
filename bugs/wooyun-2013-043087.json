{"id": 6956, "wybug_id": "wooyun-2013-043087", "wybug_title": "华文网报某报刊生成系统任意文件上传导致近百家网报沦陷——一个弱验证码引发的血案", "wybug_corp": "华文网报", "wybug_author": "RedFree", "wybug_date": "2013-11-20 19:42", "wybug_open_date": "2014-01-04 19:43", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传内容未检查", "文件上传漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-20：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-01-04：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 华文网报某报刊生成系统采用PHP开发，该套系统后台路径可轻易被猜解，且登录的验证码太过简单可轻易被识别；导致了爆破攻击》后台弱口令》上传PHP脚本》获得主机X权限…… 详细说明：      华文网报是一家比较大的网络报刊公司，经查询全国有近百家报刊使用此系统生成：\n\n    这套系统的模式如下图：\n\n    所以一但Web端出现了问题，就会导致使用该系统的近百家报刊沦陷。但经测试，该系统Web端是存在问题的。首先：轻易得到了管理后台路径（Web端相同，使用88个域名中的任一域名访问都可以）http://ptxyb.cuepa.cn/admin/admin_login.php\n\n经过简单的代码书写，验证码可以被轻易的识别。配置完爆破选项后，开始了弱口令爆破。\n\n    最终得到管理员弱口令，用户：admin 密码：adminadmin    使用管理口令访问，跳到了一个不存在的页面（管理员都使用做好的客户端生成报纸，所以不会使用这个页面登录的。有Bug可以理解）。\n\n    将页面地址填为完整路径再访问，进了管理后台……http://ptxyb.cuepa.cn/admin/admin_login.php?tran=87efca281fd740e0c2b50a5b27bd711f370682ccdd503f39d4f2c1696e6472ffb9240c267258\n\n    在测试版面发布一期报刊，附件选择附件为php一句话上传，获得文件链接。至此，轻易得到了webshell。\n\n    连接数据库：<T>MYSQL</T><H>localhost</H><U>root</U><P>netnewscn</P><L>huiyi</L>\n\n   漏洞证明：  \n\n\n\n   修复方案：  0、后台路径不要被猜好不1、验证码搞复杂一点好不2、后台不要有弱口令好不3、上传文件用白名单好不4、上传目录不可执行好不5、站、库分离Mysql低权限好不(不要坐等被提权好不)5、服务器装上狗、神、盾、卫士哥(增加点难度好不)   版权声明：转载请注明来源 RedFree@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-01-04 22:22 |    \t\t笑看天下 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:10        )\t\t \n  楼主那款密码查询器能传我一个吗？？    \n     2014-01-05 11:35 |    \t\t花少也是War  \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 我是小屁孩)\t\t \n   同求爆破密码的    \n     2014-01-05 11:51 |    \t\tRedFree \t\t\t( 普通白帽子  |\t\t\t        Rank:180 漏洞数:40        | 每个系统都有它自身的弱点，无论是相对的还...)\t\t \n  @花少也是War  @笑看天下 源码已在wooyun社区共享。    \n     2014-01-05 11:56 |    \t\t花少也是War  \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 我是小屁孩)\t\t \n  @RedFree 3Q    \n     2014-01-05 11:58 |    \t\t花少也是War  \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 我是小屁孩)\t\t \n  @RedFree 不过  能不能给下链接    \n     2014-01-05 13:56 |    \t\t笑看天下 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:10        )\t\t \n  @RedFree 具体源码在哪呀 求给个链接行吗？    \n     2014-01-23 07:38 |    \t\tStranger \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 我注意你很久了.....)\t\t \n  贴个地址嘛....    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}