{"id": 59173, "wybug_id": "wooyun-2014-048355", "wybug_title": "TCCMS SQL注入漏洞", "wybug_corp": "teamcen.com", "wybug_author": "xfkxfk", "wybug_date": "2014-01-09 14:07", "wybug_open_date": "2014-04-09 14:08", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "数字类型注射", "逻辑错误", "安全意识不足", "源码审核", "注射漏洞利用技巧", "源码分析", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-09：\t细节向公众公开  简要描述： TCCMS SQL注入漏洞，可任意用户登陆 详细说明：  前台会员登录处：app/controller/user.class.php：\n/* 前台会员登陆 */\tpublic function loginIn() {\t\t$userObj = M ( 'user' );\t\t$username = trim ( $_POST ['username'] );//注入\t\t$password = trim ( $_POST ['password'] );\t\t$checkError = $this->checkErrorLogin ( $userObj, $username, $password );\t\tif (empty ( $username ) || empty ( $password )) {\t\t\tStringUtil::jsback ( Config::lang ( \"USERNAMEORPASSWORDWRONG\" ) );\t\t}\t\t$isLogin = $userObj->checkUserLogin ( $username, $password );\n$username, $password未过滤，进入checkUserLogin，跟进：app/model/userAction.class.php：\npublic function checkUserLogin($username, $password) {        $pwd1 = md5(trim($password));        $sql = \"select * from \" . $this->table . \" where username='\".$username.\"' and password='\".$pwd1.\"' and status=1\";        $sql = str_replace(\"#\", '', $sql);        $sql = str_replace(\"-\", '', $sql);        $rt = $this->db->query($sql);        $row = mysql_fetch_array($rt);        if (!$row) {            return false;        } else {            return $row;        }    }\n直接进入sql语句。   漏洞证明：  我们注册一个用户111111，密码111111.然后用错误密码123登陆：\n\n错误密码登陆失败。\n\n错误密码登陆成功。\n\nSQL语句执行记录。   修复方案：  过一下啊   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-01-09 15:05 厂商回复： fix,很给力 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}