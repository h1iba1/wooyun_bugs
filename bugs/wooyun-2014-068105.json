{"id": 1824, "wybug_id": "wooyun-2014-068105", "wybug_title": "咕咚网任意用户密码重置", "wybug_corp": "咕咚网", "wybug_author": "海绵宝宝", "wybug_date": "2014-07-10 19:41", "wybug_open_date": "2014-08-24 19:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-24：\t细节向公众公开  简要描述： 收到了乌云集市发的咕咚笑，重置密码时候发现可重置任意用户密码 详细说明：  用户在忘记密码的时候，找回密码\n\n然后邮箱收到邮件\n\n看到没有，重置密码的链接格式http://www.codoon.com/verify_email?email=邮箱地址&code=时间戳时间戳是提交找回密码时发送的时间分钟和秒数那么，我在找回密码的时候，用Wireshark抓包，可轻易抓到这个时间戳\n\n此时抓到的时间是19:28:38那么我们构造urlhttp://www.codoon.com/verify_email?email=邮箱地址&code=2838会发现code不对\n\n由于存在延迟，所以我们把code=2838依次向后叠加，发现当code=2840时，可以找回密码http://www.codoon.com/verify_email?email=邮箱地址&code=2840\n\n我们再来看看邮件收到是url\n\n与构造的url是一致的   漏洞证明：  修改密码后登录\n\nps：测试使用的均为自己注册的号，未更改其他用户密码   修复方案：  找回密码验证方式过于简单   版权声明：转载请注明来源 海绵宝宝@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-07-11 11:16 厂商回复： 谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-10 20:23 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  收到了乌云集市发的咕咚笑，重置密码时候发现可重置任意用户密码 ._.    \n     2014-07-11 08:59 |    \t\tRinima \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        )\t\t \n  厂商表示躺着就被你测漏了    \n     2014-07-11 14:14 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  手机号码爆破？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}