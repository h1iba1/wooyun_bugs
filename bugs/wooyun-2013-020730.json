{"id": 12906, "wybug_id": "wooyun-2013-020730", "wybug_title": "ThinkSNS V3缺陷-01", "wybug_corp": "ThinkSNS", "wybug_author": "zzR", "wybug_date": "2013-03-26 23:33", "wybug_open_date": "2013-05-10 23:34", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "类型应用", "漏洞利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-10：\t细节向公众公开  简要描述： ThinkSNS V3正式放出，特表示祝贺。不带刷的，友情检测（因为我们公司要用！） 详细说明：  刷粉丝漏洞！可CSRF，可首页蠕虫。仅测试！目测现在官方V3 用户3K+，若要刷粉，请看这里。站点：\nhttp://demo.thinksns.com\n还是个demo啊，就要好好测试。未对CSRF设防，加关注、取消关注，直接为GET方式，可导致CSRF蠕虫。看两个请求：关注某人：\nGET /t3/index.php?app=public&mod=Follow&act=doFollow&fid=39XX HTTP/1.1\n取消关注：\nGET /t3/index.php?app=public&mod=Follow&act=unFollow&fid=39XX HTTP/1.1\n当然，这个fid就是需要被照顾的对象啦！刷起来   漏洞证明：  利用方式可以在ThinkSNS 站内任何地方插入此链接，当然，最直接的就是放到首页去了！\n\n任何人看到首页的这条动态信息，点击就能自动关注此fid当然，为了效果更好，你可以把内容做的更具有吸引力！当其他用户点击了此条动态效果\n\n关注成功。\n\n关注失败，因为这是我自己，自己不能关注自己。很快，就收到新粉丝通知\n\n不管你是写日志，更新状态，都可以讲此动态同步到首页，发一条微博，让大家都来关注你！仅测试，未蠕   修复方案：  防csRF，各种加token啥的。   版权声明：转载请注明来源 zzR@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-03-27 09:18 厂商回复： 感谢白帽，立即解决。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}