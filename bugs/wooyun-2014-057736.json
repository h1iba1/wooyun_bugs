{"id": 56427, "wybug_id": "wooyun-2014-057736", "wybug_title": "世界大学城一处越权漏洞", "wybug_corp": "世界大学城", "wybug_author": "芙兰朵露斯卡雷特", "wybug_date": "2014-04-22 12:38", "wybug_open_date": "2014-06-06 12:38", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "越权操作"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-22：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-06-06：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 影响到世界大学城全站，大量的学校站点受到影响。。。说多了就漏了。。不说了。。求邀请码QAQ 详细说明：  去表哥的学校转了转。。无聊挖出来的可越权直接删除评论。因为没有条件也懒得去测试删除文章的权限了，不过估计有相同的问题（新手第一次大牛不要喷我...）首先注册账号发了一个评论，截到：\nPOST /Ajax/Ajax_Comment.aspx HTTP/1.1Host: www.worlduc.comPOSTDATA: op=SubmitBlogComment&bid=22435299&content=testmsg\n然后ajax会重载帖子评论，在重载的数据里面可以得到评论的id，比如：\nop=BindBlogComment&bid=22435299&page=1&tid=0&type=0得到id='leaveword3688221'\n然后删除自己的评论得到：\nop=DeleteBlogComment&id=3688221&bid=22435299\n然后喜闻乐见的发包（不需要cookie，也不需要UA）\n\n（不要吐槽易语言。。其实写点小软件还是很方便的）网站返回一个0然后评论就被删掉了原因：对于用户提交的数据过于信任，没有在后端做合法性检测   漏洞证明：  http://www.worlduc.com/e/blog.aspx?bid=22435299在这里测试的，如果有后台的话不妨查一查日志   修复方案：  加入UA和cookie的检查   版权声明：转载请注明来源 芙兰朵露斯卡雷特@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-04-27 23:52 |    \t\t芙兰朵露斯卡雷特 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 看我闪现逃走闪现逃走六不六)\t\t \n  截止目前仍未修复    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}