{"id": 73047, "wybug_id": "wooyun-2015-0161211", "wybug_title": "富驿时尚酒店Getshell（控内网近10个主域名+近20库+近200万用户信息+60多万会员卡）", "wybug_corp": "富驿时尚酒店", "wybug_author": "cmwl", "wybug_date": "2015-12-14 15:04", "wybug_open_date": "2016-01-25 18:01", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["上传", "注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-14：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-01-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 注入、上传拿全部控制权这里必须得说一句，很多厂商给的礼品都太小气了，幸好我们是小白帽，不是小黑帽。。。。。。这回必须得对得起为个洞的礼品了！！！！！！！！！！！！！！！！！！！！！！！！ 详细说明：  www.fxhotels.com主站存在SQL注入：\nURL:http://www.fxhotels.com/index.aspxPOST数据：act=hotels&citycode=NKG\n管理后台存在任意文件上传：\nURL:http://www.fxhotels.com/addhotels.aspx\n   漏洞证明：  首先来看注入点，列出的数据库列表：\n\n然后查看了一个ibe数据库的表项和对应数据行数：\n\n再找，发现了一个DUser表，然后dump一下表内容，完全的明文登录名和密码：\n\n高兴了一小下，一看就是后台登录的用户名和密码，但是突然发现还少一样东西：登录页面，于是又继续寻找，扫了扫端口发现8089端口开放着的，于是就访问了一下，果然是后台登录点，用admin:fx1234登录：\n\n这个后台的管理功能太少了，于是大致浏览了一下，发现了一个任意文件上传点：\n\n寻找到webshell落地点（http://pic.fxhotels.com:8081/news/Aspnet.aspx），访问：\n\nok，已获取系统控制权，下一步就是发现一些具有价值的东西，看了一下目录结构，发现这个web包含了众多的域名：\n\n几乎就富驿的所有主站点！！！也就是说直接把富驿的网站全控制了下面查看了一些数据库的连接：\n\n\n\n经过一翻探索，发现大家感兴趣的数据在CRM里：\n\n查看了一下住房登记表的条目，近200万条：\n\n列出几条详细信息，太多的在这儿就不列出来了，毕竟是隐私嘛：\n\n其它的信息，这儿就不多贴上来了以上列出的所有域名和数据库信息均未做改动webshell请自行删除，路径已给   修复方案：  参数转义、上传限制   版权声明：转载请注明来源 cmwl@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}