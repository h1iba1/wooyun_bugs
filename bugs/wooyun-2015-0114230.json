{"id": 23557, "wybug_id": "wooyun-2015-0114230", "wybug_title": "中通手机版越权打包(影响订单)", "wybug_corp": "中通速递", "wybug_author": "answer", "wybug_date": "2015-05-15 12:36", "wybug_open_date": "2015-06-29 14:14", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-29：\t细节向公众公开  简要描述： 好像是第一次发逻辑漏洞 详细说明：  ps:据说众测的通过率要看主站的漏洞，要多交不同类型的漏洞，哈哈。真的很拼了。漏洞网址:wap.zto.cn测试的时候记得改user-agent哦。首先注册了两个。先登录账号一，然后去到下单的地方存在以下几个越权。一：任意给别人下单\n\n\n\n填好订单，提交的时候burp抓包\n\n可以看到出现userid,感觉有越权，我事先已经知道我另一个账号的userid是1360224，所以我现在把userid换成1360224，提交。然后登陆我的userid为1360224的账号\n\n果然有订单，存在越权。如果遍历userid，哈哈你懂的。二：任意删除别人的订单。找到其中的一个订单点击删除\n\n\n\n呵呵 ，这种出现越权的情况太大了，我把订单换成其他的订单号\n\n换成截图中的，果然就删除了。（如果遍历订单号不是就可以删除所有人的订单吗，哈哈）三：可以遍历所有的订单（这个危害最大）来到查看订单的地方\n\n可以看到产看订单就只要userid和订单号，我们换一换\n\n果然，这个订单是我另一个号的。这个地方只需要遍历userid和订单号，进行组合爆破，理论上就能获得所有订单。这真的不难，只是时间问题.这里我就测试了，比较耗时间   漏洞证明：  ps:据说众测的通过率要看主站的漏洞，要多交不同类型的漏洞，哈哈。真的很拼了。漏洞网址:wap.zto.cn测试的时候记得改user-agent哦。首先注册了两个。先登录账号一，然后去到下单的地方存在以下几个越权。一：任意给别人下单\n\n\n\n填好订单，提交的时候burp抓包\n\n可以看到出现userid,感觉有越权，我事先已经知道我另一个账号的userid是1360224，所以我现在把userid换成1360224，提交。然后登陆我的userid为1360224的账号\n\n果然有订单，存在越权。如果遍历userid，哈哈你懂的。二：任意删除别人的订单。找到其中的一个订单点击删除\n\n\n\n呵呵 ，这种出现越权的情况太大了，我把订单换成其他的订单号\n\n换成截图中的，果然就删除了。（如果遍历订单号不是就可以删除所有人的订单吗，哈哈）三：可以遍历所有的订单（这个危害最大）来到查看订单的地方\n\n可以看到产看订单就只要userid和订单号，我们换一换\n\n果然，这个订单是我另一个号的。这个地方只需要遍历userid和订单号，进行组合爆破，理论上就能获得所有订单。这真的不难，只是时间问题。这里我就测试了，比较耗时间   修复方案：     版权声明：转载请注明来源 answer@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-05-15 14:13 厂商回复： 非常感谢白帽子对我公司的关注 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-15 13:22 |    \t\tanswer \t\t\t( 普通白帽子  |\t\t\t        Rank:347 漏洞数:45        | 答案)\t\t \n  @浩天 @疯狗 @xsser 这不科学啊 这都走小厂商啊    \n     2015-05-15 14:23 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  @浩天  棒棒哒    \n     2015-05-15 14:23 |    \t\tanswer \t\t\t( 普通白帽子  |\t\t\t        Rank:347 漏洞数:45        | 答案)\t\t \n  @浩天 棒棒哒    \n     2015-05-15 15:08 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  @answer 你又上错号啦？    \n     2015-05-15 15:39 |    \t\tanswer \t\t\t( 普通白帽子  |\t\t\t        Rank:347 漏洞数:45        | 答案)\t\t \n  @玉林嘎 老教授手抖了。。。    \n     2015-06-29 14:49 |    \t\t镱鍚 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 。。！)\t\t \n  嚯嚯大牛带我飞。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}