{"id": 82781, "wybug_id": "wooyun-2015-0149975", "wybug_title": "OneAPM源码泄露及登录接口可撞库", "wybug_corp": "oneapm.com", "wybug_author": "0x0d", "wybug_date": "2015-10-28 10:05", "wybug_open_date": "2015-12-14 11:50", "wybug_type": "账户体系控制不严", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向公众公开  简要描述： 在v2ex上看到OneAPM的广告，既然号称中国的NewRelic安全应该不错吧。 详细说明：  在GitHub上搜 oneapm password 有不少记录，找到个有趣的账户：https://github.com/manageyunying\n\n里面有生产数据和运营等系统的源码，还在更新中。随后收集了一大堆密码准备进内网瞧瞧，结果发现大部分都是阿里云的RDS，根本连不上：\nFTPusername=\"oneapm\"password=\"d0I63*6M5NEI\"address=\"123.57.22.56\"jdbcUrl=jdbc:mysql://127.0.0.1/manage?useUnicode=true&ampuser=managepassword=s23fsdl9dsl@s&jdbc.url=jdbc:mysql://10.128.7.247:3306/mobileprivatetrace?useUnicode=true&ampjdbc.username=rootjdbc.password=oneapmjdbc.url= jdbc\\:mysql\\://10.128.14.157\\:3306/testjdbc.username=adminjdbc.password=adminjdbcUrl=jdbc:mysql://100.98.70.86:3306/managerdbjdbcUrl=jdbc:mysql://rds1p2w2yitw263r3ygu.mysql.rds.aliyuncs.com/mobilebasicjdbcUrl=jdbc:mysql://rds54mgaqv8osck2y467.mysql.rds.aliyuncs.com/browserxhrdatajdbcUrl=jdbc:mysql://rdsbp0m36ou1p84t8349.mysql.rds.aliyuncs.com/tpmsaasjdbcUrl=jdbc:mysql://rds858w9g04b5598k070.mysql.rds.aliyuncs.com/mobileprivatedatajdbcUrl=jdbc:mysql://rds3em7yjj9rm36bfr1u.mysql.rds.aliyuncs.com/analyticsjdbcUrl=jdbc:mysql://rds84584weefk677y690.mysql.rds.aliyuncs.com/usercenterjdbcUrl=jdbc:mysql://10.251.126.18/tpmsaasjdbcUrl=jdbc:mysql://10.104.15.224/tpmsaasuser=manage_saaspassword=3acr89Mc0bc2ajdbc:mysql://db-server:3306/ymy_test?user=zhaohaijun&password=676892String jdbcurl = \"jdbc:hive2://10.128.17.21:10000\";String username = \"hadoop\";String password = \"\";<?xml version=\"1.0\" encoding=\"UTF-8\" ?><xml-body>\t<!--静态资源地址 -->\t<!-- <staticPath>http://manage.oneapm.com/</staticPath> -->\t<staticPath>http://manage.oneapm.com/</staticPath>\t<!--项目地址 -->\t<!-- <basePath>http://manage.oneapm.com/</basePath> -->\t <basePath>http://manage.oneapm.com/</basePath> \t<fileSystem>/oneapm/filesystem/</fileSystem>\t<!--工单地址 -->\t<crmAddress>https://oneapm.kf5.com/</crmAddress>\t<!--mongodb参数 -->\t<mongodb>\t\t<mongodata>\t\t\t<!-- <serverNode>10.128.8.80</serverNode>  -->\t\t\t<serverNode>manager.mgo.010251193010.ali.bj</serverNode>\t\t\t<!-- <serverNode>manager.mgo.010251193010.ali.bj</serverNode> -->\t\t\t<serverPort>27017</serverPort>\t\t\t<autoConnectRetry>true</autoConnectRetry>\t\t\t<connectionsPerHost>300</connectionsPerHost>\t\t\t<maxWaitTime>50000</maxWaitTime>\t\t\t<defauledb>saas</defauledb>\t\t</mongodata>\t</mongodb>\t<redis>\t\t<manage>\t\t\t<serverNode>31b0ed9225774881.m.cnbja.kvstore.aliyuncs.com</serverNode>\t\t\t<poolSize>10</poolSize>\t\t\t<serverPort>6379</serverPort>\t\t\t<password>31b0ed9225774881:HCmqeD1jTTAm</password>\t\t</manage>\t</redis>\t<mysql>\t\t<manage>\t\t\t<driver>com.mysql.jdbc.Driver</driver>\t\t\t<url>jdbc:mysql://100.98.70.86:3306/managerdb</url>\t\t\t<username>manage_saas</username>\t\t\t<password>3acr89Mc0bc2a:HCmqeD1jTTAm</password> \t\t\t<!-- <driver>com.mysql.jdbc.Driver</driver>\t\t\t<url>jdbc:mysql://119.29.28.190:3306/webhook</url>\t\t\t<username>root</username>\t\t\t<password>qinh_webhook123</password> -->\t\t</manage>\t</mysql></xml-body>\n不过找到一个密码为 123456 的用户登录成功：\n\n该用户可以管理 oneapm 的 club：\n\n在后台收集了一些员工邮箱准备爆破。发现登录接口没有验证码，虽然 post 的密码经过加密了，但是……\n\n把 encode 改成 false 就能绕过。爆破成功了几个账户：\n\n工单系统：\n\n   漏洞证明：  \n\n   修复方案：  完善员工安全意识   版权声明：转载请注明来源 0x0d@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-10-30 11:49 厂商回复： 谢谢0x0d  谢谢乌云，我们已经在处理中，非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}