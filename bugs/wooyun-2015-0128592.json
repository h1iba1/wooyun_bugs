{"id": 46060, "wybug_id": "wooyun-2015-0128592", "wybug_title": "我是怎么任意篡改20万用户的网页内容的（控制用户端广告插件规则）", "wybug_corp": "ad-safe.com", "wybug_author": "Drizzle.Risk", "wybug_date": "2015-07-24 13:14", "wybug_open_date": "2015-09-07 14:50", "wybug_type": "恶意信息传播", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["挂马", "恶意信息传播", "钓鱼欺诈", "运维管理不当", "业务风险"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-07：\t细节向公众公开  简要描述： ADSafe用了很久了，昨天顺手测试了下，结果...以后再也不敢用了。有ADSafe的小伙伴们，你们重启下程序，然后访问乌云试试看？ 详细说明：  其实过程挺简单的。1. 首先是一个数据后台系统\n\n2.经典的SQL注入，任意用户登录\n\n3.在官网提交我们的规则\n\n\n\n4.在系统内审核通过\n\n5.去洗个澡\n\n6.等业务那边不明真相的操作员把审核过的规则，加入到运营规则中（命苦的临时工）\n\n7.然后，见证奇迹了（感谢各位好基友提供截图）\n\n\n\n\n\n\n\n这个漏洞其实不止改个网页这么简单，仁者见仁，ADSafe还有个拦截程序广告的功能，规则也在上面，如果设计好规则，个人感觉是可以实现任意程序执行的。不过因为这厮装机量还挺大，就不试了。   漏洞证明：  迅速装一个ADSafe，然后打开乌云。   修复方案：  1.修改SQL注入漏洞，对数据后台系统进行访问控制2.优化规则审核的内部工作流程，防范信任边界被控制   版权声明：转载请注明来源 Drizzle.Risk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2015-07-24 14:48 厂商回复： 后台整理一时疏忽导致，该BUG已修复，感谢漏洞作者的积极反馈！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-23 11:52 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这个严重关注！！！    \n     2015-07-23 12:11 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @Drizzle.Risk 这个能写入任意脚本不    \n     2015-07-23 12:19 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:81        )\t\t \n  很有趣的样子！    \n     2015-07-23 12:21 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  @疯狗 可以啊，可以随便写。。    \n     2015-07-23 12:46 |    \t\tBear baby \t\t\t( 普通白帽子  |\t\t\t        Rank:183 漏洞数:20        | 善攻者，不知其所守。善守者，不知其所攻。)\t\t \n  我勒个擦。。我给中了。。刚开始还以为wooyun咋了呢。。把ADsafe关了就正常了。。洞主666666    \n     2015-07-23 13:05 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @Drizzle.Risk 呃，求改回规则，有白帽中招了，另外有秋秋么？    \n     2015-07-23 13:40 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  @疯狗 上午我的规则生效后，就把规则删了，ADSafe那边运营规则还没有更新吧     \n     2015-07-23 14:09 |    \t\t海绵宝宝 \t\t\t( 普通白帽子  |\t\t\t        Rank:243 漏洞数:50        | 唯有梦想与好姑娘不可辜负.)\t\t \n  商总，我要给你生孩子    \n     2015-07-23 15:23 |    \t\tp0di \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:17        | 1+1 = 2 ？)\t\t \n  @海绵宝宝 先让XX宏怀上再说。    \n     2015-07-23 16:23 |    \t\t咚咚呛 \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:10        | 我是一只小毛驴咿呀咿呀呦~~)\t\t \n  商从此你有好多孩子了。。。。    \n     2015-07-23 17:23 |    \t\tqiaoy \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:15        )\t\t \n  .    \n     2015-07-23 18:22 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:165        | 。)\t\t \n  好叼    \n     2015-07-23 19:19 |    \t\tn0bele \t\t\t( 普通白帽子  |\t\t\t        Rank:220 漏洞数:45        | 无耻最寂寞)\t\t \n  这个感觉像是添加规则源没校验的问题？    \n     2015-07-23 22:13 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:170        | 力不从心)\t\t \n  爽，哈哈    \n     2015-07-23 23:20 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:111        | 收wb   1：5 无限量收   [平台担保])\t\t \n  没有什么是安全的了，知道的越多越是水深火热    \n     2015-07-24 00:23 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  服了ADSafe，现在规则还没改回来呢。http://www.wooyun.org/    \n     2015-07-24 08:23 |    \t\tToom \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 啊)\t\t \n  @Drizzle.Risk 昨天我乍一看以为乌云被黑了 吓死宝宝了    \n     2015-07-24 08:58 |    \t\t上官元恒 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:3        | 屌丝程序员一枚，上能修电脑，下能装系统。)\t\t \n  屌    \n     2015-07-24 09:00 |    \t\t上官元恒 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:3        | 屌丝程序员一枚，上能修电脑，下能装系统。)\t\t \n  把“逛网站无干扰”关闭就行    \n     2015-07-24 13:35 |    \t\tquanxian \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:2        | This is QuanXian.)\t\t \n  原来是你劫持的。。。。    \n     2015-07-24 13:39 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 每日必关注乌云)\t\t \n  幸好我不用这个...    \n     2015-07-24 13:48 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:75        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  干 ，你吓着我了 ，赔钱    \n     2015-07-24 13:50 |    \t\t魂淡、 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:1        | 么么哒)\t\t \n  23333新技能get    \n     2015-07-24 15:06 |    \t\tdepycode \t\t\t( 普通白帽子  |\t\t\t        Rank:275 漏洞数:42        | 关注网络安全，提高技术！)\t\t \n  我用的ADBlock    \n     2015-07-24 15:11 |    \t\t上官元恒 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:3        | 屌丝程序员一枚，上能修电脑，下能装系统。)\t\t \n  @depycode ADBlock只是chrome插件 而已    \n     2015-07-24 16:05 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  厂商响应挺快，我现在想知道乌云那条规则下没下 T_T    \n     2015-07-24 16:33 |    \t\tQ1NG \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:16        | 临 兵 斗 者 皆 阵 列 前 行 !)\t\t \n  果然有这问题 ! 吓到我了    \n     2015-07-24 18:06 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  厂商响应挺快，测试规则已经下线了..    \n     2015-08-06 08:51 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:170        | 力不从心)\t\t \n  这个可以。不过居然有这种漏洞……洞主敬业啊，洗澡去还配图    \n     2015-08-09 14:16 |    \t\tilll \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:8        | 轻吟一句情话，执笔一副情画。绽放一地情...)\t\t \n  还好我不用    \n     2015-08-17 00:15 |    \t\t火日攻天 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:1        | 什么都不会啊)\t\t \n  drizzle.Risk2.org 我还奇怪呢一搜索就到这了    \n     2015-09-07 22:04 |    \t\tBird \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:24        | Stay hungry. Stay foolish.)\t\t \n  @Drizzle.Risk 可以在本地实现任意程序执行？我看到它的本地弹窗规则都是抓窗体的啊。应该只可以获得任意网页上的信息吧。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}