{"id": 75324, "wybug_id": "wooyun-2016-0167805", "wybug_title": "茅台又一处含有爆炸能量的小漏洞", "wybug_corp": "emaotai.cn", "wybug_author": "ksss", "wybug_date": "2016-01-07 13:47", "wybug_open_date": "2016-02-20 15:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-20：\t细节向公众公开  简要描述： 安全无小事，一个小弱点含有引爆所有业务的能量危害这么大，不过知道不会给我送茅台的，那就给个20吧 详细说明：  爆炸能量包含主站shell、所有用户、订单、支付线沦陷#1首先是一个一处未授权访问的接口http://www.emaotai.cn:90/oAPI/API/eCenter/Member/GetMemberlist这个接口用于输出用户信息，然后用khmc接收参数来进行限定http://www.emaotai.cn:90/oAPI/API/eCenter/Member/GetMemberlist?khmc=%E4%B9%B0%E4%B9%90%E4%B9%90这个算一个小小的用户数据泄露吧，然后接着往下，可以直接获取到积分、余额、住址、联系方式等等\n\n#2然而这个接口的能量远不止如此，它对接收的参数的宽容性导致了，提交什么都直接放入语句中执行，下面这张图就可以看出来了主站50W会员的数据表，包括账号密码地址联系方式，而且涉及账户金额，这个密码泄露还是危害蛮大的。。。。注入点http://www.emaotai.cn:90/oAPI/API/eCenter/Member/GetMemberlist?khmc=%E4%B9%B0%E4%B9%90%E4%B9%90dba权限，感觉所有数据库都在这了，数据量非常大\n\n\n\n#3然而管理员信息也泄露了，后台可以直接getshell，而且付款什么的设置都在这儿，这个被篡改了危害相当严重啊\n\n\n\n\n\n主站shell，直接中间商平台内部销售平台等等都在这儿shell地址,修漏洞的时候记得删：http://www.emaotai.cn/Storage/master/banner/20160106102147_8175.aspx厂商也蛮良心的，仅测试、未做任何改动，未动任何数据~~   漏洞证明：  \n\n\n\n   修复方案：  1.还是权限问题，接口安全必须注意2.为什么能找到这么隐蔽的接口，因为开发把源码放git上了，让人白盒测试可得非常经得起考验啊3.至于注入点修复应该不是什么难题   版权声明：转载请注明来源 ksss@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-01-08 09:30 厂商回复： 感谢您的反馈，我们将尽快修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}