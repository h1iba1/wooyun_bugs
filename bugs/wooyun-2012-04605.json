{"id": 21328, "wybug_id": "wooyun-2012-04605", "wybug_title": "QQ邮箱邮件收发时间未以服务器时间为依据", "wybug_corp": "腾讯", "wybug_author": "梦想肥羊", "wybug_date": "2012-02-17 20:05", "wybug_open_date": "2012-02-17 22:08", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-02-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： QQ邮箱邮件收发时间未以服务器时间为依据，而是以邮件发送人的电脑上的时间为准~把本机的时间调成2007年~然后通过smtp用其他的邮箱给QQ发送邮件  在QQ邮箱里面 打开邮件，邮件上面显示的时间为2007年~~而不是现在的2012~~~这样就相当于我可以伪造我的邮件很久以前就发送给对方了~~（种种事情发生纠纷后，伪造邮件收发时间作为证据~可用于非法途径） 详细说明：  QQ邮箱邮件收发时间未以服务器时间为依据，而是以邮件发送人的电脑上的时间为准~把本机的时间调成2007年~然后通过smtp用其他的邮箱给QQ发送邮件  在QQ邮箱里面 打开邮件，邮件上面显示的时间为2007年~~而不是现在的2012~~~这样就相当于我可以伪造我的邮件很久以前就发送给对方了~~（种种事情发生纠纷后，伪造邮件收发时间作为证据~可用于非法途径）\n\n\n\n   漏洞证明：  \n\n\n\n   修复方案：  你懂的~   版权声明：转载请注明来源 梦想肥羊@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-02-17 22:08 厂商回复： 之前我们已经解决过，而且是个bug 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-02-17 22:08 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  我觉得这个不应该算是QQ邮箱的问题.举例,我有一封邮件,是通过某邮箱昨天下午发送的,恰巧这个邮箱服务器上很多待发邮件,这封邮件一直到今天才发送出去,那么QQ邮箱该显示发送时间为昨天下午还是今天呢?只能说是发送端的服务器不该采取客户机的发送时间为推送时间.因为QQ邮箱接收到的这封邮件的发送时间本就是2007年.难道要显示今天?这个问题应该归结到SMTP的协议上去.因为SMTP的协议中.时间戳本身就是来自客户端的,会跟随在DATA下.有空可以分析下SMTP协议,SMTP的基本语法中,由客户端发送的data后面跟的就是时间,所以QQ邮箱这样做没有问题.顶多只能在邮件正文上加注一条:接收时间为:2012年2月17日 否则的话,难道现在要推翻这个协议?肥羊兄自己想想哦...虽然腾讯每次不给我发礼物...但是这样的问题我还是要站出来说一下的...    \n     2012-02-17 22:26 |    \t\t梦想肥羊 \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:18        | 博客：dnswalk.blog.163.com)\t\t \n  楼上说的有理～    应当同时显示发送端的发送时间和接收端的到达时间……>:-<    \n     2012-02-17 22:57 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  恩，TX产品经理出来，采纳沙发的方案，附加显示服务器接受该邮件的时间。并给楼主和沙发发礼物！！！    \n     2012-02-18 00:19 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  lake牛现在指不定怎么狠我呢...还发礼物...    \n     2012-02-18 01:48 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @only_guest good!!!!    \n     2012-02-18 02:03 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  good个妹啊..答应我的0day啥时候给我啊...再不给我就要悲剧了    \n     2012-02-18 09:23 |    \t\tFrankie \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 你存在,我的代码里...Line 0://你)\t\t \n  擦,早有了吧.尤其是外国和港澳台地区的邮件进来..有明显的时间问题.......蛋疼着呢.    \n     2012-02-18 10:14 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  一楼是正解 ，这个确实是协议问题~包括伪造发件人的问题~    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}