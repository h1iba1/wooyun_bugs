{"id": 14468, "wybug_id": "wooyun-2015-0118231", "wybug_title": "青橙设计不当重置任意用户密码(公司邮箱测试/泄露用户地址/订单)", "wybug_corp": "上海青橙", "wybug_author": "千斤拨四两", "wybug_date": "2015-06-04 16:52", "wybug_open_date": "2015-07-23 09:04", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "安全意识不足", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向公众公开  简要描述： 搜索了网站的邮箱，都可进行重置，操作见下。 详细说明：  0x1:正确流程走下，抓取手机响应包数据。\n\n此步就要抓取手机响应包的信息。\nHTTP/1.1 200 OKServer: nginx/1.0.11Date: Thu, 04 Jun 2015 06:27:07 GMTContent-Type: text/html; charset=utf-8Connection: keep-aliveVary: Accept-EncodingCache-Control: no-cachePragma: no-cacheExpires: -1X-AspNetMvc-Version: 4.0X-AspNet-Version: 4.0.30128X-Powered-By: ASP.NETContent-Length: 8398<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><title>\tæ¾åå¸æ·å¯ç -éæ©ææº</title><meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" /><link href=\"/reference/css/common.css?20150225\" rel=\"stylesheet\" type=\"text/css\" /><link href=\"/reference/css/proregister.css?20150225\" rel=\"stylesheet\" type=\"text/css\" /><link href=\"/reference/css/bootstrap.css\" rel=\"stylesheet\" type=\"text/css\" /><link href=\"/reference/css/qc.shop.css.pc.css?20150225\" rel=\"stylesheet\" type=\"text/css\" />    <script type=\"text/javascript\" src=\"/reference/scripts/knockout-3.2.0.js?20150225\"></script>    <script type=\"text/javascript\" src=\"/reference/scripts/jquery-2.1.3.min.js?20150225\"></script>        <script type=\"text/javascript\" src=\"/reference/scripts/bootstrap.min.js?20150225\"></script>    <script type=\"text/javascript\" src=\"/reference/scripts/validator.js?20150225\"></script>    <script type=\"text/javascript\" src=\"/reference/scripts/public.js?20150225\"></script>    <script type=\"text/javascript\" src=\"/reference/scripts/ajax.js?20150225\"></script>    <script type=\"text/javascript\" src=\"/reference/scripts/p/findpwd.js?20150225\"></script>         <style type=\"text/css\">       .showtext,.reg_input_txt{ float:left; display:block;height:40px;line-height:40px;color:#FF6600;font-family:Verdana,Geneva,sans-serif;font-weight:bold;}       #emailpsbt .reg_botton_btn,#mobilepsbt .reg_botton_btn,#updatepsbt .reg_botton_btn{background-color: #f99114; border: 1px solid #dd621f;color: #ffffff;cursor: pointer;display: block;float: left;font: 700 16px/40px \"å¾®è½¯éé»\",\"å®ä½\",\"é»ä½\",Arial;height: 40px;width: 130px;}       #mobilepsbt,#updatepsbt{ margin-top:10px;float:left;}       #emailpsbt dd,#mobilepsbt dd,#UpdatePassWord dd{ display:block; float:left;font-size:12px; margin:0; text-align:left; padding-left:20px; height:40px; line-height:40px; margin-left:10px;}       #emailpsbt .tip,#mobilepsbt .tip,#UpdatePassWord .tip{color:#999; background:url(/reference/images/tip.png) no-repeat left center;}       #emailpsbt .error,#mobilepsbt .error,#UpdatePassWord .error{color:red; background:url(/reference/images/error.png) no-repeat left center;}       #emailpsbt .ajax,#mobilepsbt .ajax,#UpdatePassWord .ajax{color:#999; background:url(/reference/images/ajax.gif) no-repeat left center;}       #emailpsbt .success,#mobilepsbt .success,#UpdatePassWord .success{background:url(/reference/images/reg-menu.gif) no-repeat 0px -20px;color:Green;}       .go{ float:left; display:block; width:100%; height:23px; line-height:23px;color:#999;}       .go font{color:#FF6600;font-weight:bold;font-size:13px;margin:0 3px;}       #formReg .reg_input .reg_input_title{ font-weight:normal;width:140px;}       #formReg .reg_input .reg_input_txt{ width:auto;}       #mobileCode{ margin-left:15px;color:#333; padding:0 5px;cursor:pointer;}       #vCode,#newps,#cfnewps{ margin-top:6px;}       #txtMobileTip,#txtVcodeTip,#dddcfnewps,#txtNewpsTip,#txtCfnewpsTip{ line-height:40px;color:#999; margin-left:10px; float:left;}       #updatepsbt{ padding-left:140px;}    </style>    <script type=\"text/javascript\">        function initPage() {            mobileno = \"130*****882\";            account = \"doubao\";            token = \"B37D451B8AF92E611980E4E8874030FB\";            token = \"24903690C1ABFE9A8631999A743D7A82\";        }    </script>  </head><body>    <link href=\"/reference/css/proothertop.css?20150225\" rel=\"stylesheet\" type=\"text/css\" /><div class=\"other_top\">    <div class=\"other_top_logo\">        <a href=\"http://www.qingcheng.com\">            <img src=\"/reference/images/v5_top_logo.png\" alt=\"éæ©logo\" title=\"éæ©logo\" />        </a>    </div></div>    <div id=\"proregister\">        <div id=\"proregister_content\">            <div class=\"proregister_content_top\">                <span>æ¾åå¸æ·å¯ç </span>            </div>            <div class=\"proregister_content_form\">                <form id=\"formFindPwd\" method=\"post\">                    <div id=\"divMsg\" data-bind=\"html: message, visible: showMessage, attr: { class: messageClass }\" role=\"alert\" style=\"display:none;padding-left:0px\">                        message                    </div>                    <div id=\"divFindMethods\" class=\"defaultinput\">                        <div class=\"btn-group\" style=\"width:100%;\">                          <button type=\"button\" class=\"btn btn-default dropdown-toggle\" data-toggle=\"dropdown\" aria-expanded=\"false\" data-bind=\"html:selectedMethod\">                             <span class=\"caret\"></span>                          </button>                          <ul class=\"dropdown-menu\" role=\"menu\" style=\"margin-left:10px;padding-left:10px;\"><li><a href=\"#\" data-bind=\"click:clickShowMobile\">éè¿ææºæ¾å</a></li></ul></div>                    </div>                    <div id=\"divFindByEmail\" class=\"defaultinput\"  data-bind=\"visible: showEmail\">                        <div id=\"emailps\" class=\"reg_input\">                            <div class=\"defaultinput\" style=\"text-align:left;padding-left:0px;width:100%\"><h5><span data-bind=\"text: email\"></span></h5>                            </div>                        </div>                                            <div id=\"emailpsbt\" class=\"defaultinput\" style=\"width:100%\">                            <input type=\"button\" id=\"btnSendEmail\" data-bind=\"click: sendEmail\" class=\"btn btn-warning btn-lg btn_standard\"  value=\"åéé®ä»¶\" />                        </div>                    </div>                    <div id=\"divFindByMobile\" class=\"defaultinput\"  data-bind=\"visible: showMobile\">                        <div id=\"mobileps\" class=\"defaultinput\" style=\"text-align:left;padding-left:0px;width:100%\">                            <h5><span data-bind=\"text: mobileno\"></span></h5>                        </div>                        <div id=\"divMVCode\" class=\"defaultinput\" data-bind=\"visible: showMobile\" style=\"width:100%\">                            <input name=\"txtCode\" id=\"txtCode\" type=\"text\" data-bind=\"value: mvcode\" class=\"form-control w60\" style=\"float:left;\" placeholder=\"ç­ä¿¡éªè¯ç \"/>                            <input name=\"btnSendSMSCode\" id=\"btnSendSMSCode\" type=\"button\" class=\"btn btn-default w40 mobileVeryfyCode\" data-bind=\"click: sendSMSCode\" style=\"cursor:pointer\" value=\"è·åç­ä¿¡éªè¯ç \" />                        </div>                        <div id=\"mobilepsbt\" class=\"defaultinput\" style=\"width:100%\" >                            <input type=\"button\" id=\"btnMobileNext\" data-bind=\"click: mobileNextAction\" class=\"btn btn-warning btn-lg btn_standard\"  value=\"ä¸ä¸æ­¥\" />                        </div>                    </div>                    <div id=\"divCannot\" class=\"defaultinput short\" data-bind=\"visible: showCannot\">                        <div id=\"loginid\" class=\"reg_input\"><div class=\"reg_input_txt\" style=\"color:#333;\">æ±æ­ï¼è¯¥è´¦å·æªç»å®é®ç®±åææºï¼æ æ³æ¾åå¯ç ï¼<a href=\"/m/login/index\">éæ°ç»å½</a></div><span></span></div>                                          </div>            </form>            </div>        </div>    </div>    <link href=\"/reference/css/prootherfoot.css?20150225\" rel=\"stylesheet\" type=\"text/css\" /><div class=\"other_foot\">    <ul>        <li>            <span><a href=\"http://www.qingcheng.com\">éæ©å®ç½</a></span>        </li>        <li class=\"line\">|</li>        <li>            <span><a href=\"http://bbs.qingcheng.com\">éæ©è®ºå</a></span>        </li>        <li class=\"line\">|</li>        <li>            <span><a href=\"http://go.qingcheng.com\">æ©åé¨è½</a></span>        </li>        <li class=\"line\">|</li>        <li>            <span><a href=\"http://www.myuios.com\">MYUI</a></span>        </li>        <li class=\"line\">|</li>        <li>            <span><a href=\"http://www.qingcheng.com/contact\">èç³»æä»¬</a></span>        </li>        <li class=\"line\">|</li>        <li>            <span class=\"other_foot_icp\">éæ©å¬å¸çæææ-æ²ªICPå¤12006100å·</span>        </li>    </ul></div></body></html>\n可以查看到account ，token的值。所以我们可以抓取任意用户的token值。0x2:继续下去，到了获取验证码这一步，不用获取验证码，可直接绕过，在输入框任意输入一串6位数字，修改响应包！\n\n返回的信息肯定是错误，把验证码错误-->success，放行。\n\n0x3:此步再次抓取响应包。\n\n\nHTTP/1.1 200 OKServer: nginx/1.0.11Date: Thu, 04 Jun 2015 06:40:50 GMTContent-Type: text/html; charset=utf-8Connection: keep-aliveVary: Accept-EncodingCache-Control: no-cachePragma: no-cacheExpires: -1X-AspNetMvc-Version: 4.0X-AspNet-Version: 4.0.30128X-Powered-By: ASP.NETContent-Length: 5210<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><title>\tæ¾åå¸æ·å¯ç -éæ©ææº</title><meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" /><link href=\"/reference/css/common.css?20150225\" rel=\"stylesheet\" type=\"text/css\" /><link href=\"/reference/css/proregister.css?20150225\" rel=\"stylesheet\" type=\"text/css\" /><link href=\"/reference/css/bootstrap.css?20150225\" rel=\"stylesheet\" type=\"text/css\" /><link href=\"/reference/css/qc.shop.css.pc.css?20150225\" rel=\"stylesheet\" type=\"text/css\" />    <script type=\"text/javascript\" src=\"/reference/scripts/knockout-3.2.0.js?20150225\"></script>    <script type=\"text/javascript\" src=\"/reference/scripts/jquery-2.1.3.min.js?20150225\"></script>        <script type=\"text/javascript\" src=\"/reference/scripts/bootstrap.min.js?20150225\"></script>    <script type=\"text/javascript\" src=\"/reference/scripts/validator.js?20150225\"></script>    <script type=\"text/javascript\" src=\"/reference/scripts/public.js?20150428\"></script>    <script type=\"text/javascript\" src=\"/reference/scripts/ajax.js?20150428\"></script>    <script type=\"text/javascript\" src=\"/reference/scripts/p/findpwde.js?20150225\"></script>      \t<script type=\"text/javascript\" src=\"/reference/scripts/aes.js?20150225\"></script>        <script type=\"text/javascript\">        function initPage() {            account = \"doubao\";            token = \"B37D451B8AF92E611980E4E8874030FB\";            message = \"\";        }    </script>  </head><body>    <link href=\"/reference/css/proothertop.css?20150225\" rel=\"stylesheet\" type=\"text/css\" /><div class=\"other_top\">    <div class=\"other_top_logo\">        <a href=\"http://www.qingcheng.com\">            <img src=\"/reference/images/v5_top_logo.png\" alt=\"éæ©logo\" title=\"éæ©logo\" />        </a>    </div></div>    <div id=\"proregister\">        <div id=\"proregister_content\">            <div class=\"proregister_content_top\">                <span>æ¾åå¸æ·å¯ç </span>            </div>            <div class=\"proregister_content_form\">                <form id=\"formReg\">                    <div id=\"divMsg\" data-bind=\"html: message, visible: showMessage, attr: { class: messageClass }\" role=\"alert\" style=\"display:none\">                        message                    </div>                    <div data-bind=\"visible: isCorrect\">                        <div id=\"loginid\" class=\"defaultinput\" style=\"text-align:left;padding-left:10px;\"><h4>è´¦æ·å<span style=\"padding-left:10px;\" data-bind=\"text: account\"></span></h4></div>                        <div id=\"divPassword\" class=\"defaultinput short\">                            <input type=\"password\" name=\"txtPassword\" id=\"txtPassword\" data-bind=\"value: password, event: { blur: blurPassword }\" class=\"form-control\" placeholder=\"æ°å¯ç \" />                        </div>                        <div id=\"divRepassword\" class=\"defaultinput short\">                            <input type=\"password\" name=\"txtPassword2\" id=\"txtPassword2\" data-bind=\"value: repassword, event: { blur: blurPassword }\" class=\"form-control\" placeholder=\"ç¡®è®¤æ°å¯ç \" />                        </div>                        <div id=\"divVCode\" class=\"defaultinput short\">                            <input type=\"text\" value=\"\" id=\"txtVCode\" data-bind=\"value: vcode\" class=\"form-control w60\" style=\"float:left\" placeholder=\"æ³¨åéªè¯ç \">                            <img alt=\"ç¹å»æ¢ä¸å¼ \" class=\"img_01 w40 veryfyCodeImage\" src=\"/reference/plugin/VerifyCode.aspx\" onclick=\"this.src='/reference/plugin/VerifyCode.aspx?t='+Math.random();\" style=\"cursor:pointer\">                        </div>                        <div id=\"reg_botton\" class=\"defaultinput_button\">                            <button type=\"button\" id=\"btnUpdatePs\" data-bind=\"click: updatePassword\" class=\"btn btn-warning btn-lg btn_standard\" >æäº¤ä¿®æ¹</button>                        </div>                    </div>                </form>            </div>        </div>    </div>    <link href=\"/reference/css/prootherfoot.css?20150225\" rel=\"stylesheet\" type=\"text/css\" /><div class=\"other_foot\">    <ul>        <li>            <span><a href=\"http://www.qingcheng.com\">éæ©å®ç½</a></span>        </li>        <li class=\"line\">|</li>        <li>            <span><a href=\"http://bbs.qingcheng.com\">éæ©è®ºå</a></span>        </li>        <li class=\"line\">|</li>        <li>            <span><a href=\"http://go.qingcheng.com\">æ©åé¨è½</a></span>        </li>        <li class=\"line\">|</li>        <li>            <span><a href=\"http://www.myuios.com\">MYUI</a></span>        </li>        <li class=\"line\">|</li>        <li>            <span><a href=\"http://www.qingcheng.com/contact\">èç³»æä»¬</a></span>        </li>        <li class=\"line\">|</li>        <li>            <span class=\"other_foot_icp\">éæ©å¬å¸çæææ-æ²ªICPå¤12006100å·</span>        </li>    </ul></div></body></html>\n\n\n就这样轻松的绕弱验证即可修改密码，这是绑定了手机号的用户绕过验证码的方法，下面说说邮箱没有绑定手机号的方法。\n\n   漏洞证明：  \ngreenorange@51greenorange.com邮箱测试\n0x4：在第一步输入用户名下一步截断信息，提取token值，修改响应包。\n\n把手机响应包修改用0x1的数据替换掉，注意把accont和token值也要替换掉。放行就能到手机获取验证码页面。\n\n0x5:不在复现绕过验证码的方法，修改响应包数据，用0x2抓到的数据替换，accont和token值也要更换。\n\n修改放行。\n\n修改密码wooyun1230x6：登录验证！\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 千斤拨四两@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-06-08 09:04 厂商回复： 确认漏洞，非常感谢千斤拨四两 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-04 22:50 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:71        | I'm Me_Fortune)\t\t \n  密码逻辑漏洞小能手= =     \n     2015-06-08 09:39 |    \t\t千斤拨四两 \t\t\t( 普通白帽子  |\t\t\t        Rank:510 漏洞数:88        | 是时候表演真正的技术了。。。)\t\t \n  @上海青橙 有小礼物么，哦吼吼~~~~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}