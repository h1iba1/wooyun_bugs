{"id": 44331, "wybug_id": "wooyun-2015-0101055", "wybug_title": "乐彩任意账号密码直接重置漏洞（非爆破）", "wybug_corp": "乐彩", "wybug_author": "恋锋", "wybug_date": "2015-03-13 14:10", "wybug_open_date": "2015-04-27 14:12", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-27：\t细节向公众公开  简要描述： 乐彩任意账号密码重置漏洞（非爆破），影响整站所有用户账号安全，深夜挖洞不易，忘良心厂商回馈高rank。 详细说明：  1、使用手机号找回密码处可绕过短信验证码校验。2、首先使用已知手机号码进行一次正常的找回密码流程，记录第二步（信息验证）时返回的响应包，如下：\nHTTP/1.1 200 OKDate: Thu, 12 Mar 2015 15:20:35 GMTServer: nginx/1.2.5Content-Type: text/html; charset=utf-8X-Powered-By: PHP/5.5.13Expires: Thu, 12 Mar 2015 15:20:38 GMTCache-Control: max-age=3Pragma: no-cachecTag: 230X-Via: 1.1 xj18:9 (Cdn Cache Server V2.0)Connection: keep-aliveContent-Length: 105{\"code\":0,\"message\":\"\",\"data\":true,\"redirect\":\"\",\"datetime\":\"2015-03-12 23:20:35\",\"timestamp\":1426173635}\n3、再做一次找回密码操作，如下图\n\n4、在第二步中输入任意短信码（此处为111111），提交请求\n\n5、返回响应包如下图\n\n6、用第一次重置密码操作得到的响应包替代此处，如下\n\n7、释放请求后，进入重置密码页面，重置密码为1111qqqq\n\n8、重置密码成功，可利用该密码成功登录系统\n\n   漏洞证明：  见漏洞详细说明   修复方案：  完善服务端认证机制   版权声明：转载请注明来源 恋锋@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-03-13 16:07 厂商回复： 漏洞确认。非常感觉对乐彩的关注。 最新状态： 2015-03-13：漏洞已修复。再次感谢。  ", "replys": "漏洞评价：\n评论\n     2015-03-13 14:15 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  看来一点就透啊    \n     2015-03-13 15:49 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  望不是忘....弄错了 意思就完全不一样了啊    \n     2015-03-13 16:07 |    \t\t恋锋 \t\t\t( 普通白帽子  |\t\t\t        Rank:261 漏洞数:42        | 为了成为一名优秀的白帽子而继续努力！)\t\t \n  @子非海绵宝宝 多谢大神提醒啊^_^    \n     2015-03-13 17:00 |    \t\t恋锋 \t\t\t( 普通白帽子  |\t\t\t        Rank:261 漏洞数:42        | 为了成为一名优秀的白帽子而继续努力！)\t\t \n  @乐彩 感谢良心厂商，都已经找我索取联系方式，准备发送礼物了，多谢！    \n     2015-03-13 18:51 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  @恋锋 妥妥的    \n     2015-04-03 00:08 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  66666666666666666666666666666    \n     2015-04-27 15:34 |    \t\tLonely \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:27        | 人生如梦,始终都游不过当局者迷的悲哀。)\t\t \n  专业重置    \n     2015-04-28 02:52 |    \t\t孔卡 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:12        | 我已经过了那个餐桌上只有一条鸡腿就一定能...)\t\t \n  @恋峰  我特想知道你改响应包的工具是什么？    \n     2015-04-28 09:46 |    \t\t恋锋 \t\t\t( 普通白帽子  |\t\t\t        Rank:261 漏洞数:42        | 为了成为一名优秀的白帽子而继续努力！)\t\t \n  @孔卡 一款业界主流的抓包工具    \n     2015-09-25 19:54 |    \t\thope \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | 一个小菜)\t\t \n  @恋锋 私密个联系方式 谢谢！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}