{"id": 71751, "wybug_id": "wooyun-2015-0157556", "wybug_title": "新时代证券某管理系统SQL注入（system权限）", "wybug_corp": "xsdzq.cn", "wybug_author": "路人甲", "wybug_date": "2015-12-02 11:32", "wybug_open_date": "2015-12-07 11:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： rt。脱裤，拿服务器，甚至进一步搞内网，都可以了~~~吼吼。 详细说明：  该证券公司的OA系统登录框存在post注入：主站链接：http://www.xsdzq.cn/\n\nOA系统URL：http://oa.xsdzq.cn/C6/Jhsoft.Web.login/PassWordSlide.aspx\n\n存在注入的链接，该OA系统的管理登陆URL：http://oa.xsdzq.cn/C6/Jhsoft.mobileapp/login/login.html\n\n此处存在POST注入，开始吧。登陆过程抓包：\n\n修改user和pwd参数，如下图：\n\n扔SQLMAP尝试：\n\n可以看到相关系统及数据库信息，继续查看当前用户：\n\n验证是否是dba：\n\n查看数据库内容：\n\n因为是MSSQL数据库，故尝试调用xp_cmdshell。成功调用，执行命令“whoami”：\n\n至此，system权限。脱裤，提权，进一步搞内网。干啥不行？说个思路吧，用现在这个有system权限的shell，如果有绝对路径的话，可以直接echo写shell，转常规渗透。如果找不到绝对路径，可以执行ftp命令从远程下载个端口抓发的工具。转出3389，用这个shell加个用户。分分钟上桌面，进一步就可以搜集信息搞内网了。吼吼。不过。本菜就挖挖洞，到此为止了，不深入了，厂商赶紧把洞补了吧。：）   漏洞证明：  送一个修改后的post包吧：\nPOST /C6/Jhsoft.mobileapp/login/CheckPwd.ashx HTTP/1.1Host: oa.xsdzq.cnContent-Length: 89Accept: */*Origin: http://oa.xsdzq.cnX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://oa.xsdzq.cn/C6/Jhsoft.mobileapp/login/login.htmlAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: ASP.NET_SessionId=3wlkeqr5ikhqkfypshqa4255; ASPSESSIONIDCQTRCBDB=JBELEIBDHNMLCMIMIOKDLNIP; myie=false<root><User>admin</User><Pwd>admin</Pwd><type>login</type></root>\n   修复方案：  过滤。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-12-07 11:34 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}