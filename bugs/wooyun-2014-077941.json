{"id": 49497, "wybug_id": "wooyun-2014-077941", "wybug_title": "中国联通某漏洞导致数十万客户信息泄露(姓名、电话、余额、套餐使用详情、积分)", "wybug_corp": "中国联通", "wybug_author": "鸟云厂商", "wybug_date": "2014-10-06 09:48", "wybug_open_date": "2014-11-20 09:50", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["补丁不及时"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-20：\t细节向公众公开  简要描述： 中国联通某漏洞导致数十万客户信息泄露（姓名、电话、余额、套餐详情、积分） 详细说明：  \n\n福建联通的微信公众号有账户查询的功能（绑定手机号之后），看了一下显示信息的页面。http://210.13.199.140/acc/accountQry.action?openid=******命令执行，ST2-2010Target: http://210.13.199.140/acc/accountQry.actionWhoami: rootWebPath: /home/imccweb/webapps/fjUnicomOS.Name: LinuxOS.Version: 2.6.32-220.el6.x86_64Java.Home: /usr/java/jdk1.6.0_37/jreJava.Version: 1.6.0_37OS.arch: amd64User.Name: rootUser.Home: /rootUser.Dir: /home/imccweb/run/tomcat_server/binJava.Class.Path: /home/imccweb/run/tomcat_server/bin/bootstrap.jarJava.IO.Tmpdir: /home/imccweb/run/tomcat_server/temp#1敏感配置泄露 <!--###数据连接配置###  \t<db>     \t<admin>      \t\t<driverClass>oracle.jdbc.driver.OracleDriver</driverClass>       \t\t<url>jdbc:oracle:thin:@ (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.10.37)(PORT = ***)) ) (CONNECT_DATA = (SID = ORCL) ) )</url>             <username>u***1</username>             <password>p***31</password>              <driverClass>com.microsoft.sqlserver.jdbc.SQLServerDriver</driverClass>            <url>jdbc:sqlserver://10.**.**.4:1433; DatabaseName=i**c;</url>             <username>i**c</username>             <password>i***19</password>            <hostTel>10000</hostTel>     \t</admin>   \t</db>   \t-->      <socketInfo>   \t\t<ip>1****91</ip>   \t\t<port>8587</port>   \t</socketInfo>不列举太多配置信息了，证明即可#2修改首页文件盗取cookie/home/imccweb/webapps/fjUnicom/pages/bill/accountQry.jsp是查询页面的文件其中插入XSS代码，半个小时有150条cookiecookie内容：location : http://210.13.199.140/acc/accountQry.action?openid=ofmG7uNF6baOpJ6MI0WbPjja2xU8toplocation : http://210.13.199.140/acc/accountQry.action?openid=ofmG7uNF6baOpJ6MI0WbPjja2xU8cookie : JSESSIONID=3DC1BC86D240E13A535AED3B7FDE42F9opener :HTTP_REFERER : http://210.13.199.140/acc/accountQry.action?openid=ofmG7uNF6baOpJ6MI0WbPjja2xU8HTTP_USER_AGENT : Mozilla/5.0 (Linux; Android 4.4.2; LG-F240L Build/KOT49I.F240L20c) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/30.0.0.0 Mobile Safari/537.36 MicroMessenger/5.4.0.51_r798589.480 NetType/3gnetREMOTE_ADDR : 211.97.130.202, 211.97.130.202http://210.13.199.140/acc/accountQry.action?openid=ofmG7uNF6baOpJ6MI0WbPjja2xU8这个页面直接打开就是账单查询页面（同时有姓名、电话、余额、套餐详情、积分）\n\n\n\n#3找到数据库备份文件之前的描述可以看出，openid是一个很重要的参数，是用户身份的唯一证明参数。然后，在/home/imccweb/webapps/fjUnicom/pages/下有1个1.txt来看看内容,足足有77672条openidupdate  IM_SM_CUSTOMER t set  t.cus_email='厦门' where t.OPENID='ofmG******UIls';update  IM_SM_CUSTOMER t set  t.cus_email='漳州' where t.OPENID='ofm******5fslfk';update  IM_SM_CUSTOMER t set  t.cus_email='福州' where t.OPENID='ofmG7************Jag0';update  IM_SM_CUSTOMER t set  t.cus_email='厦门' where t.OPENID='ofmG7uP-6IvWC******hY';update  IM_SM_CUSTOMER t set  t.cus_email='漳州' where t.OPENID='ofmG7u******NoHozM';update  IM_SM_CUSTOMER t set  t.cus_email='漳州' where t.OPENID='ofmG******df4smg';update  IM_SM_CUSTOMER t set  t.cus_email='福州' where t.OPENID='ofmG7uD0lgZLy5QKOTW94QvaJmZ4';update  IM_SM_CUSTOMER t set  t.cus_email='泉州' where t.OPENID='ofmG7uFMo_Uvg-******aDJ8';update  IM_SM_CUSTOMER t set  t.cus_email='泉州' where t.OPENID='ofmG******JgYjY';update  IM_SM_CUSTOMER t set  t.cus_email='厦门' where t.OPENID='ofmG******PjA';update  IM_SM_CUSTOMER t set  t.cus_email='宁德' where t.OPENID='ofmG******IXkejo';update  IM_SM_CUSTOMER t set  t.cus_email='福州' where t.OPENID='ofmG7uF_O-cZ******00';   漏洞证明：  \n\n截至我提交漏洞，已经有210条cookie进来了   修复方案：     版权声明：转载请注明来源 鸟云厂商@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-10-11 16:09 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-06 10:39 |    \t\t上缮若水 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 本人会注入，会上传，会Xss，会破解，会嗅...)\t\t \n  屌爆了，求裤子    \n     2014-10-06 10:49 |    \t\t0x_Jin \t\t\t( 普通白帽子  |\t\t\t        Rank:319 漏洞数:37        | 微博：http://weibo.com/J1n9999)\t\t \n  这个是上次那个刷流量  然后深挖，挖到的？    \n     2014-10-06 12:04 |    \t\t鸟云厂商  \t\t\t( 核心白帽子 |\t\t\t        Rank:1313 漏洞数:146        | 中国菜鸟)\t\t \n  @0x_Jin 不是 两个站不同    \n     2014-11-20 10:07 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  专注联通三十年？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}