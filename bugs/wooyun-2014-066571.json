{"id": 2185, "wybug_id": "wooyun-2014-066571", "wybug_title": "豆瓣某API扫号和暴力破解的问题", "wybug_corp": "豆瓣", "wybug_author": "lijiejie", "wybug_date": "2014-06-28 20:31", "wybug_open_date": "2014-08-12 20:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["扫号"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-12：\t细节向公众公开  简要描述： 豆瓣网API扫号和暴力破解的小问题 详细说明：  还是一年多前曾经提到过的API：http://www.douban.com/j/app/login?email={email}&password={password}&app_name=radio_desktop_win&version=50现在依然存在的问题是：1) 可以拿泄露的库扫号，当然，用很老的库扫出来的号已经提示被临时锁定了，这一点豆瓣网是做得非常好的。说明豆瓣重视安全2) 错误提示过于详细，可以猜解邮箱/手机号是否存在2) 可以在只知道手机号或邮箱的情况下批量扫号。  测试发现在一定时间内是可以错误一定次数的。这个不太好利用，但仍旧可以撞号。比如： 维护一个10万账号的队列，以及一个top 100的密码队列，批量撞号。一旦遇到被锁定，就把账号挂到队列尾部，等待下次继续撞号。如此反复。可参考我之前扫人人网账号的方式：    WooYun: 人人网暴力破解及两处验证码安全问题[破解10万，成功2123]   漏洞证明：  简单破解几位豆瓣邮箱的用户：\nemail=douban@douban.com&password=123456789email=gelei@douban.com&password=000000email=mijun@douban.com&password=111111email=yuzhe@douban.com&password=123456789\n猜解豆瓣用户名：\na@douban.comall@douban.combook@douban.comevent@douban.comhelp@douban.comliterature@douban.commovie@douban.compartner@douban.comread@douban.comrich@douban.comsky@douban.comsystem@douban.comteam@douban.comtest@douban.comchangdong@douban.comchenbin@douban.comchengang@douban.comchengeng@douban.comchenjing@douban.comchenlin@douban.comchennuo@douban.comchenwei@douban.comchentuo@douban.comchenxi@douban.comchenyang@douban.comchenyi@douban.comchenzhi@douban.comchengang@douban.comchengbai@douban.comcongrong@douban.comdahai@douban.comdajin@douban.comdaluo@douban.comdanglu@douban.comdingning@douban.comdingwei@douban.comdingyi@douban.comdongyu@douban.comdouban@douban.comduanxu@douban.comfangjian@douban.comfangshan@douban.comfujian@douban.comfuyao@douban.comgao@douban.comgaobin@douban.comgaocheng@douban.comgaolei@douban.comgaoyan@douban.comgelei@douban.comgenglin@douban.comgonghao@douban.comguanyu@douban.comguojing@douban.comguoxin@douban.comhaibo@douban.comhaidong@douban.comhaoyi@douban.comhetao@douban.comhexu@douban.comhexuan@douban.comhoumai@douban.comhujing@douban.comhuming@douban.comhuwei@douban.comhuashan@douban.comhuanghuang@douban.comhuanghuan@douban.comhuangjian@douban.comhuangjie@douban.comhuanglei@douban.comhuangjin@douban.comhuangqian@douban.comhuiming@douban.comjiang@douban.comjianing@douban.comjiawei@douban.comjiangou@douban.comjiangou@douban.comjiangning@douban.comjiangpeng@douban.comjiaojiao@douban.comjinchao@douban.comkanglu@douban.comkangnan@douban.comkebin@douban.comkongzhen@douban.comlaiwei@douban.comlantian@douban.comleiye@douban.comlifei@douban.comlijian@douban.comlijun@douban.comlile@douban.comlina@douban.comlishun@douban.comliyan@douban.comliying@douban.comliyang@douban.comlizheng@douban.comliaofeng@douban.comlina@douban.comlinju@douban.comlingling@douban.comliuhe@douban.comliujia@douban.comliujin@douban.comliukang@douban.comliulu@douban.comliumao@douban.comliuwei@douban.comliuyan@douban.comliuye@douban.comliuyue@douban.comluchen@douban.comluchuan@douban.comlukun@douban.comluying@douban.comluoxi@douban.comluoxin@douban.commati@douban.commanchun@douban.commaoyun@douban.commenghan@douban.commengmeng@douban.commengwei@douban.commijun@douban.commiaomiao@douban.comminchi@douban.comningan@douban.comningan@douban.comqiwei@douban.comqingfeng@douban.comrenfei@douban.comruhan@douban.comruishan@douban.comshangting@douban.comshenfei@douban.comshiqun@douban.comshuo@douban.comsihuan@douban.comsongni@douban.comsongye@douban.comsujia@douban.comsurui@douban.comsuannai@douban.comsunhao@douban.comsunyi@douban.comsunzhen@douban.comtajia@douban.comtanglei@douban.comtifa@douban.comtianlei@douban.comtianqian@douban.comtongyu@douban.comwangchen@douban.comwangcheng@douban.comwangfang@douban.comwangfei@douban.comwanghu@douban.comwangjie@douban.comwanglong@douban.comwangqiong@douban.comwangxin@douban.comwangye@douban.comwangying@douban.comwangzhe@douban.comweina@douban.comweizhen@douban.comwenjing@douban.comwenzhu@douban.comwoai@douban.comwudi@douban.comwuhong@douban.comwuning@douban.comwuqi@douban.comwuwei@douban.comxiliang@douban.comxiachen@douban.comxiaochou@douban.comxiaoyan@douban.comxinxin@douban.comxuhua@douban.comxujun@douban.comxuyong@douban.comxueming@douban.comxueqin@douban.comxueya@douban.comyanjun@douban.comyanwei@douban.comyanxiao@douban.comyangfan@douban.comyanghang@douban.comyangjing@douban.comyangjie@douban.comyangliu@douban.comyangping@douban.comyangqing@douban.comyangrong@douban.comyangsong@douban.comyangyi@douban.comyaofeng@douban.comyejing@douban.comyeke@douban.comyangwei@douban.comyingsi@douban.comyongbin@douban.comyoujian@douban.comyuan@douban.comyudong@douban.comyuguang@douban.comyuzhe@douban.comyunwang@douban.comyunxi@douban.comzhangchao@douban.comzhangchi@douban.comzhangdan@douban.comzhanggan@douban.comzhanglei@douban.comzhangmiao@douban.comzhangnan@douban.comzhangqi@douban.comzhangqian@douban.comzhangqing@douban.comzhangsi@douban.comzhangying@douban.comzhangyang@douban.comzhangyu@douban.comzhangzhe@douban.comzhaofeng@douban.comzhaoling@douban.comzhaolin@douban.comzhaoyuan@douban.comzhaoyu@douban.comzhengzhong@douban.comzhouyao@douban.comzhuliang@douban.comzhuna@douban.comzhuofan@douban.comzhuna@douban.comzouyin@douban.com\n   修复方案：  只是一点建议，可参考:1) 太老版本的APP，可不再支持调用API，强制要求更新2) APP上也需要考虑加入验证码，在某些条件下强制要求输入3) 错误提示不要过于详细   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-06-28 23:07 厂商回复： 谢谢反馈，立即组织修复〜 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-29 08:39 |    \t\t发条橙子 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:6        | ∑(っ °Д °;)っ)\t\t \n  客户端比较容易出现这个问题- -    \n     2014-06-29 09:07 |    \t\tlijiejie  \t\t\t( 核心白帽子 |\t\t\t        Rank:2210 漏洞数:294        | Just for fun.)\t\t \n  @发条橙子 能扫号、暴力破解的API确实非常多，这块儿目前受重视程度不够    \n     2014-07-19 22:26 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  暴露了小号    \n     2014-08-06 13:21 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  @lijiejie 请问这个豆瓣邮箱在哪里登录啊？5WB求一个豆瓣邮箱装逼..跪求    \n     2014-08-06 13:25 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  发信给测试成功的几个帐号都退信了，说邮箱不存在    \n     2015-01-30 10:15 |    \t\t牛博恩 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:3        | Oh god my savior)\t\t \n  @冷静 内部使用的邮箱    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}