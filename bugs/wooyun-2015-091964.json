{"id": 40289, "wybug_id": "wooyun-2015-091964", "wybug_title": "天地行手机接口处理不当，导致暴力破解用户", "wybug_corp": "真旅网集团", "wybug_author": "Ano_Tom", "wybug_date": "2015-01-16 12:08", "wybug_open_date": "2015-03-02 12:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-02：\t细节向公众公开  简要描述： 天地行手机接口处理不当，导致暴力破解用户 详细说明：  1.下载安装IOS最新版后，设置代理获得请求的数据包，未加密，全部http明文传输，如图\n\n且多次提交请求无限制，从而可暴力破解任意用户密码我们用已知的帐号测试，生成一个200多个密码的常用字典，载入intruder字典如图，正确密码放入190行\n\n载入intruder后，根据响应大小找出成功登录的，登录失败如图\n\n成功如图\n\n继续破解其他用户，如何获得用户名？将username设置为变量，载入用户字典，根据响应内容判断是否存在用户，若不存在会提示用户名不存在，存在则提示密码不正确，然后继续猜解密码即可。如图\n\n猜解部分结果如图\n\n\n\n\n\n\n\n然后一不小心就找到了管理员的\n\n还有11万的余额，额。\n\n\n\n   漏洞证明：  如上   修复方案：  限制请求次数，添加相关验证，加密传输等   版权声明：转载请注明来源 Ano_Tom@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-01-16 13:11 厂商回复： 谢谢,您对我们站点的关心！欢迎和鼓励白帽子在不影响系统、破坏系统以及窃取数据的前提下，对我们真旅网旗下各个平台做安全检测。我们将根据漏洞等级/严重程度给予报告漏洞的白帽子发放相应的Rank及礼物。新系统列表(含里面菜单包括的所有模块)：天地行：www_tdxinfo_com (主平台)运营商：op_tdxinfo_com供应商：provider_tdxinfo_comB2G： vipcorp_travelzen_com注：1，请大家对我们列表的站点进行检测，列表外的特别是废弃不用的系统，我们将不再给予礼物发放哦，谢谢谅解！2，漏洞细节严禁包含密码、敏感资料等内容，未做处理的一律给予1分并不发送礼物，请大家注意哦~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}