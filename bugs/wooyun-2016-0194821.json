{"id": 87236, "wybug_id": "wooyun-2016-0194821", "wybug_title": "某GPRS调度系统漏洞导致可修改全国出租车LED顶灯屏幕内容（可发送调度指令/拍照指令/语音监听）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "Aasron", "wybug_date": "2016-04-11 11:51", "wybug_open_date": "2016-05-29 15:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["越权操作", "渗透测试", "利用技巧", "指令发送", "用户权限控制"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-29：\t细节向公众公开  简要描述： 某GPRS调度系统漏洞导致可修改全国出租车LED顶灯屏幕内容（可发送调度指令/拍照指令/语音监听）除了出租车在用，还有商务及个人用户，所以影响比较广 详细说明：  求雷劈！浩天哥，么么哒#前言这套系统是全国智能交通开发的一套GPRS调度管理系统，不过功能太强大了全球GPS定位系统\nhttp://**.**.**.**/\n\n\n#2登录框首先就存在着一处注入，过滤了，使用space2mysqldash能绕过不过我看了看表我还是放弃了\n\n\n\n5000多张表，等跑完了不知道何年何月了，果断放弃！经过前期观察发现页面并没有添加验证码等机制，进行了爆破，准备了字典，跑了半天发现根本没有什么结果\n\n结果在最顶上，我以为不存在的问题竟然有，后台登录验证绕过\n\n\nadmin'%20or%201%3d1--\n这个能直接进入后台，但进入后台发现NM，一直谈错误信息，且得不到任何有价值的东西，我想了想，会不会是构造的语句有问题？\n\n后面想了想，闭合了单引号，即 \nadmin 'or 1='1\n或 \n'or 1='1\n#3  等待进入中...\n\n等待了半天出现了我想的页面，刚开始进去 报警的汽车会发出声音，还被吓了一跳不小心抖了一下，处理了一个警报\n\n看了看功能着实强大信息比较详细\n\n在点击车辆，有命令操作的功能\n\n\n\n可直接断开油路，发送拍照指令#你以为这样就完了？在更多界面的，我们可以看到更全的\n\n\n\n如果车辆在线的话，可以直接进行LED屏幕内容的修改，我在官网上找了一张图\n\n修改的是出租车的顶灯LED屏幕以及带有LED后屏的车辆\n\n可发送拍照指令语音监听只要在语音监听回报号码中填写任意号码就能接听到\n\n最奇葩的是还可以控制引擎开关，这到底是个什么系统啊？\n\n当前是由于无在线车辆所以无法发送指令\n\n   漏洞证明：  #5  在管理界面，我找到了另外几处漏洞，可越权操作\n\n在查询时抓取到一个接口\n/Ajax/GetAllDevicesPage?_=1460289571446&userId=177&pageSize=10&page=1&key=1\n其中userId代表查询的当前用户终端，于是开始遍历\n\n\n\n\n\n\n\nTel参数及SIM参数为手机号，我马赛克了，有些拥有的汽车终端量不小在更改上级的时候将参数修改为其它人的参数就能轻易管理别人的汽车了\nPOST /Ajax/ChangeParent HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:45.0) Gecko/20100101 Firefox/45.0Accept: application/json, text/javascript, */*Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: http://**.**.**.**/Manage/ChangeParent?id=177&type=2&KeepThis=true&Content-Length: 24Cookie: 马赛克Connection: closeUserId=177&Id=177&Type=2\n我这里将Id参数修改为1，但是什么车辆都没有\n\n同理也可以修改将自己修改为别人的上级,修改之前遍历成功的userId参数，成功添加\n\n这里成功添加自己为别人的上级，与其说成为别人的上级不如说直接控制了别人的账户，因为这里直接将L1客户的帐号强制绑定到当前帐号来了,如果拥有车辆终端的话，意味着就可以随人控制他人车辆终端了。\n\n#6按道理来说，在指令发送页面进行指令发送的时候，抓包将汽车的值更换为其它车的值，是不是就可以任意发送指令给别的车辆和控制别人的车辆了呢？   修复方案：     版权声明：转载请注明来源 Aasron@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2016-04-14 15:49 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给广东分中心，由广东分中心后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-11 14:11 |    \t\t小红猪 \t\t\t( 普通白帽子  |\t\t\t        Rank:323 漏洞数:59        | little red pig!)\t\t \n  这个好玩，哈哈哈哈...    \n     2016-04-11 16:13 |    \t\trange \t\t\t( 普通白帽子  |\t\t\t        Rank:192 漏洞数:40        | 刷洞买mac)\t\t \n  GPRS，通用分组无线服务技术（General Packet Radio Service）的简称，它是GSM移动电话用户可用的一种移动数据业务。GPRS可说是GSM的延续。感觉有点不对劲    \n     2016-04-11 20:23 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 看人生万般无奈，看世间千姿百态...)\t\t \n  这个洞很值钱，可惜了。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}