{"id": 46902, "wybug_id": "wooyun-2014-082378", "wybug_title": "支付宝安全插件及其安装包可信路径权限提升", "wybug_corp": "支付宝", "wybug_author": "wefgod", "wybug_date": "2014-11-12 18:06", "wybug_open_date": "2015-02-10 18:08", "wybug_type": "权限提升", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["提权", "权限提升"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-10：\t细节向公众公开  简要描述： 安装的时候、开机启动的时候，均存在该问题 详细说明：  之前有一个类似的问题，是被提交给了阿里巴巴： WooYun: Alipay Service Trusted Path Privilege Escalation Vulnerability 我也不知道具体你们几个账号是如何分配的，但是这个既然是支付宝的插件，就放到支付宝来。支付宝控件安装的时候和开机启动的时候，可能由于createProcess参数配置出错，导致可以执行c盘下的program.exe。   漏洞证明：  版本信息：https://download.alipay.com/sec/edit/aliedit.exe\n\n安装过程：\n\n\n\n一看命令行就知道了，调用HotFixTool.exe的时候……没处理好，调用到了program.exe好吧，接着关闭program.exe，继续安装，在启动支付宝的服务的时候还会调用出错：\n\n\n\n其它不再一一描述前面是安装程序，下面是安装好之后的调用情况：开机启动的时候调用程序错误，直接弹出了4个program.exe：\n\n查看相关信息，看看命令行：\n\n很明显，还是在调用HotFixTool.exe时createProcess的参数处理不正确，导致调用错误。   修复方案：   WooYun: Alipay Service Trusted Path Privilege Escalation Vulnerability  WooYun: 百度输入法调用CreateProcess函数漏洞  WooYun: 腾讯TM2013Preview2可信路径权限提升 http://www.nsfocus.net/vulndb/8240或官方文档http://msdn.microsoft.com/en-us/library/ms682425.aspx   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2014-11-12 18:15 厂商回复： 感谢您对支付宝安全的关注，已经联系相关同学进行处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-10 20:47 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @阿里巴巴 你们家这位同学好像忽略了不少漏洞啊    \n     2014-11-12 16:42 |    \t\tBeep \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:4        | 专注PHP漏洞挖掘)\t\t \n  这个还自评高  有点坑  阿里100%忽略    \n     2014-11-12 21:08 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Beep 好像还真没忽略    \n     2014-11-13 09:20 |    \t\tBeep \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:4        | 专注PHP漏洞挖掘)\t\t \n  @wefgod 这个不能算是权限提升 而是劫持启动类似的  他的服务没有这个问题    \n     2014-11-13 10:24 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Beep 不知道啊，好像见一开始乌云就是写类似的标题    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}