{"id": 42528, "wybug_id": "wooyun-2015-0102940", "wybug_title": "WebKit 处理疏忽造成浏览器 crash", "wybug_corp": "WebKit", "wybug_author": "kamael", "wybug_date": "2015-03-25 14:32", "wybug_open_date": "2015-05-09 14:34", "wybug_type": "拒绝服务", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["浏览器", "拒绝服务", "浏览器安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-25：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-05-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： WebKit 对 JS 代码处理疏忽导致可以设计恶意页面导致用户浏览器 crash。该问题在所有使用 JavascriptCore（也就是WebKit原生配套JS引擎）的浏览器（比如 Safari）和库里都存在。 详细说明：  PoC：\n<img src=x onerror=\"alert(1)});alert(2);f = ({\">\nWebKit在对事件和内嵌入代码进行绑定时，使用如下方式：\n(function(event) { [code] }\\n)\n其中 code 为我们写入的代码。代码里并没有检测闭合。但是在代码即将被执行前，WebKit 会做一个检查，检查该代码是否是一个单一的函数，如果不是，则直接 crash 掉。crash 代码在 http://trac.webkit.org/browser/trunk/Source/JavaScriptCore/runtime/CodeCache.cpp#L156156行。由于组合后不是单一函数，statement = 0x0，于是 crash。\n// This function assumes an input string that would result in a single function declaration.155\t    StatementNode* statement = program->singleStatement();156\t    ASSERT(statement);157\t    ASSERT(statement->isBlock());158\t    if (!statement || !statement->isBlock())159\t        return nullptr;\n   漏洞证明：  以下代码插入页面中， 用 WebKit 内核浏览器访问即可。\n<img src=x onerror=\"alert(1)});alert(2);f = ({\">\n   修复方案：  这里返回空函数，或者在拼接之前进行 Parse 合法性检查就好了，直接页面崩溃不太好吧。。   版权声明：转载请注明来源 kamael@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}