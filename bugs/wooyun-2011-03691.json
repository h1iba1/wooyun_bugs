{"id": 21708, "wybug_id": "wooyun-2011-03691", "wybug_title": "中关村在线用户注册邮件验证绕过缺陷", "wybug_corp": "中关村在线", "wybug_author": "路人甲", "wybug_date": "2011-12-21 12:35", "wybug_open_date": "2011-12-21 12:51", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计错误", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-12-21：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2011-12-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 中关村在线用户注册邮件验证时存在严重的逻辑缺陷，导致邮件验证失效 详细说明：  中关村在线用户注册时，需要向注册用户邮箱发送含有加密字符串的激活链接进行激活，如http://service.zol.com.cn/user/register_email_ok.php?uid=***&email=**@123.com&code=9c7aef28a6e7742cb1157a4d2f0b7375, 但加密字符串在”重新发送邮件“功能处泄露，如图:\n\n导致可以猜到code处的 参数，直接拼接url http://service.zol.com.cn/user/register_email_ok.php?uid=***&email=***@123.com&code=5addd7dec4e1a4df6c0efc6441e5c41c 进行激活。\n\n邮件验证形同虚设，导致恶意灌水注册。   漏洞证明：  注册新用户，邮箱随便填写，提交。\n\n点击查看 源代码，找”再次发送注册邮件链接“取出code参数，拼接链接(uid为注册名称)http://service.zol.com.cn/user/register_email_ok.php?uid=***&email=***@123.com&code=5addd7dec4e1a4df6c0efc6441e5c41c 并访问，提示激活成功。\n\n   修复方案：  修改激活链接和 重新发送链接 以及 更换邮箱链接里的code参数一致的缺陷   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：6 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2011-12-21 12:51 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  Great!!!    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 6, "Ranks": null}