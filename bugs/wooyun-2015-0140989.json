{"id": 66684, "wybug_id": "wooyun-2015-0140989", "wybug_title": "万银财富基金另一分站存在多处SQL注入（DBA权限+几千万数据库信息泄漏）", "wybug_corp": "万银财富", "wybug_author": "路人甲", "wybug_date": "2015-09-16 15:12", "wybug_open_date": "2015-11-02 15:08", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-02：\t细节向公众公开  简要描述： 存在多处SQL注入，且为DBA权限，可致几千万敏感信息泄漏 详细说明：  首先主站的 WooYun: 基金安全之万银财富基金主站SQL注入两枚（涉及多个库大量数据） \nhttp://www.wy-fund.com/index.php?m=instarea&c=inbrok&a=init&inst_id=55   参数inst_id存在注入www.wy-fund.com/index.php?m=instarea&c=infund&inst_code=80000220         inst_code布尔型盲注\n依旧没有修复\n我们来看看分站的！~~~http://micro.wy-fund.com话说好像写着乐视财经，跟乐视有关系么？http://finance.letv.com/这个连接里面好像有这样的连接到micro这边来哦？“沪深300走势图”和“收益排行”这两个板块都有连接到micro.wy-fund.com这里您好，乐视是万银财富官方战略合作伙伴，万银财富网是证监会批准的第三方基金销售机构，资格号是：000000320\n在在http://micro.wy-fund.com/?leshi/home.info/270025抓包有两处注入的地方，分别为下面的注入1和注入3了！~~~\n\n1、在\nhttp://micro.wy-fund.com/?leshi/home.info/270025\n以及\nhttp://leshi.wy-fund.com/\n这个界面抓包获得get的地址\nhttp://micro.wy-fund.com/api.php?fundId=000001&date1=20150901&date2=20150903&amount=111111 (GET)http://leshi.wy-fund.com/api.php?fundId=000001&date1=20150902&date2=20150904&amount=1222222 (GET)\n经测试，fundId存在注入，DBA权限，可以获取几千万数据信息。但是\nhttp://leshi.wy-fund.com/api.php?fundId=000001&date1=20150902&date2=20150904&amount=1222222 (GET)\n经测试，这个的fundId不能注入了，能不能绕过就没有继续了！~~~\n\n\n\n\n\n\n\n\n\n\n\n\n\n2、\nhttp://micro.wy-fund.com/?leshi/home.info/270025\n测试\nhttp://micro.wy-fund.com/?leshi/home.info/270025'\n返回\nFatal error: Uncaught SoapFault exception: [Client] looks like we got no XML document in /workspace/microphp/application/modules/Leshi/controllers/home.php:155 Stack trace: #0 /workspace/microphp/application/modules/Leshi/controllers/home.php(155): SoapClient->__call('run', Array) #1 /workspace/microphp/application/modules/Leshi/controllers/home.php(155): SoapClient->run('{\"class\":\"FundD...') #2 [internal function]: Home->doInfo('270025'') #3 /workspace/microphp/MicroPHP.min.php(855): call_user_func_array(Array, Array) #4 /workspace/microphp/index.php(472): WoniuRouter::loadClass() #5 {main} thrown in /workspace/microphp/application/modules/Leshi/controllers/home.php on line 155\n猜测存在注入，然后用sqlmap测试存在时间盲注，速度超级慢，也是DBA权限，获取的信息如上因时间盲注，只能静静等待，我在测试中翻看网页，结果就猜解过程中出错了，可能我网速实在太慢的原因？这个可谓测试了半个小时才获取了这些点信息，留给有耐心的人去测试吧！~~~用上面的就速度快，这样就可以了！~~~\n\n\n\n3、资产配置---数据截止时间这里更改时间抓包，可以得到POST数据\nhttp://micro.wy-fund.com/getcode.php (POST)date=20150630&fund=270025\nfund存在注入，且看sqlmap测试，剩下的比较慢，就看第一个点的就行了！~~~\n\n\n\n\n\n   漏洞证明：  如上   修复方案：  过滤修复权限限制   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-09-18 15:06 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向证券业信息化主管部门通报,由其后续协调网站管理单位处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-14 17:11 |    \t\tCh丶0nly \t\t\t( 普通白帽子  |\t\t\t        Rank:205 漏洞数:50        | 专注网络30年。)\t\t \n  毛来的几千万啊。。。。  几十万我信    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}