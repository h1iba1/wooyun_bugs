{"id": 30836, "wybug_id": "wooyun-2015-0110138", "wybug_title": "中国电信某短信业务存在命令执行可getshell", "wybug_corp": "中国电信", "wybug_author": "JiuShao", "wybug_date": "2015-04-24 16:27", "wybug_open_date": "2015-06-12 09:58", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-12：\t细节向公众公开  简要描述： 中国电信挂机短信业务存在命令执行可getshell 详细说明：  中国电信挂机短信业务存在命令执行可getshell站点:http://116.228.55.149:8082/helpdesk/privilege/loginAction!login2.actionst2  就不多说  写了个shell  shell地址:http://116.228.55.149:8082/helpdesk/jiushao.jsp  jiushao   菜刀敏感信息:\n<database>                   <jndi-name>jdbc/hd_main_db</jndi-name>                              <driver type=\"com.mysql.jdbc.Driver\">                                           <url>jdbc:mysql://192.168.139.220:3306/helpdesk_g3</url>                                                        <user>root</user>                                                                     <password>123456</password>                                                                                 </driver>                                                                                             <prepared-statement-cache-size>0</prepared-statement-cache-size>                                                                                                         <max-connections>350</max-connections>                                                                                                                     <max-idle-time>15s</max-idle-time>                                                                                                                               </database>                                                                                                                                         <database>                    <jndi-name>jdbc/hd_ext_db</jndi-name>                               <driver type=\"com.mysql.jdbc.Driver\">                                            <url>jdbc:mysql://192.168.139.220:3306/helpdesk_g3</url>                                                         <user>root</user>                                                                      <password>123456</password>                                                                                  </driver>                                                                                              <prepared-statement-cache-size>0</prepared-statement-cache-size>                                                                                                          <max-connections>350</max-connections>                                                                                                                      <max-idle-time>15s</max-idle-time>                                                                                                                                </database>                                                                                                                                         <database>                   <jndi-name>jdbc/hd_qrtz_db</jndi-name>                              <driver type=\"com.mysql.jdbc.Driver\">                                           <url>jdbc:mysql://192.168.139.220:3306/helpdesk_g3_quartz</url>                                                        <user>root</user>                                                                     <password>123456</password>                                                                                 </driver>                                                                                             <prepared-statement-cache-size>0</prepared-statement-cache-size>                                                                                                         <max-connections>20</max-connections>                                                                                                                     <max-idle-time>15s</max-idle-time>                                                                                                                               </database>    <!--       - Default host configuration applied to all virtual hosts.      -->    <host-default>      <!--         - With another web server, like Apache, this can be commented out         - because the web server will log this information.        -->      <access-log path=\"log/access.log\"             format='%h %l %u %t \"%r\" %s %b \"%{Referer}i\" \"%{User-Agent}i\"'            rollover-period=\"1W\"/>      <!-- creates the webapps directory for .war expansion -->      <web-app-deploy path=\"webapps\"/>    </host-default>    <!-- configures a deployment directory for virtual hosts -->    <host-deploy path=\"hosts\">      <host-default>        <resin:import path=\"host.xml\" optional=\"true\"/>      </host-default>    </host-deploy>    <!-- configures the default host, matching any host name -->    <host id=\"\" root-directory=\".\">      <!--         - configures an explicit root web-app matching the         - webapp's ROOT        -->            <web-app id=\"/helpdesk\" root-directory=\"/home/zcb/resin-4.0.10/apps/helpdesk_g3\">\t\t<error-page>\t\t\t<error-code>404</error-code>\t\t\t<location>/appframe/error404Page.jsp</location>\t\t</error-page>\t\t<error-page>\t\t\t<error-code>500</error-code>\t\t\t<location>/appframe/error500Page.jsp</location>\t\t</error-page>\t\t<error-page>\t\t\t<error-code>503</error-code>\t\t\t<location>/appframe/error503Page.jsp</location>\t\t</error-page>\t\t<error-page>\t\t\t<error-code>504</error-code>\t\t\t<location>/appframe/error504Page.jsp</location>\t\t</error-page>\t  </web-app>    </host>  </cluster>    </resin>\n\n\n\n\n肯定有人问我为啥知道这是电信的业务  我只能说 从这来进去的 公司有账号 所以登陆就到st2地址了 。http://card.118114.net:8080/sdm/   漏洞证明：  中国电信挂机短信业务存在命令执行可getshell站点:http://116.228.55.149:8082/helpdesk/privilege/loginAction!login2.actionst2  就不多说  写了个shell  shell地址:http://116.228.55.149:8082/helpdesk/jiushao.jsp  jiushao   菜刀敏感信息:\n<database>                   <jndi-name>jdbc/hd_main_db</jndi-name>                              <driver type=\"com.mysql.jdbc.Driver\">                                           <url>jdbc:mysql://192.168.139.220:3306/helpdesk_g3</url>                                                        <user>root</user>                                                                     <password>123456</password>                                                                                 </driver>                                                                                             <prepared-statement-cache-size>0</prepared-statement-cache-size>                                                                                                         <max-connections>350</max-connections>                                                                                                                     <max-idle-time>15s</max-idle-time>                                                                                                                               </database>                                                                                                                                         <database>                    <jndi-name>jdbc/hd_ext_db</jndi-name>                               <driver type=\"com.mysql.jdbc.Driver\">                                            <url>jdbc:mysql://192.168.139.220:3306/helpdesk_g3</url>                                                         <user>root</user>                                                                      <password>123456</password>                                                                                  </driver>                                                                                              <prepared-statement-cache-size>0</prepared-statement-cache-size>                                                                                                          <max-connections>350</max-connections>                                                                                                                      <max-idle-time>15s</max-idle-time>                                                                                                                                </database>                                                                                                                                         <database>                   <jndi-name>jdbc/hd_qrtz_db</jndi-name>                              <driver type=\"com.mysql.jdbc.Driver\">                                           <url>jdbc:mysql://192.168.139.220:3306/helpdesk_g3_quartz</url>                                                        <user>root</user>                                                                     <password>123456</password>                                                                                 </driver>                                                                                             <prepared-statement-cache-size>0</prepared-statement-cache-size>                                                                                                         <max-connections>20</max-connections>                                                                                                                     <max-idle-time>15s</max-idle-time>                                                                                                                               </database>    <!--       - Default host configuration applied to all virtual hosts.      -->    <host-default>      <!--         - With another web server, like Apache, this can be commented out         - because the web server will log this information.        -->      <access-log path=\"log/access.log\"             format='%h %l %u %t \"%r\" %s %b \"%{Referer}i\" \"%{User-Agent}i\"'            rollover-period=\"1W\"/>      <!-- creates the webapps directory for .war expansion -->      <web-app-deploy path=\"webapps\"/>    </host-default>    <!-- configures a deployment directory for virtual hosts -->    <host-deploy path=\"hosts\">      <host-default>        <resin:import path=\"host.xml\" optional=\"true\"/>      </host-default>    </host-deploy>    <!-- configures the default host, matching any host name -->    <host id=\"\" root-directory=\".\">      <!--         - configures an explicit root web-app matching the         - webapp's ROOT        -->            <web-app id=\"/helpdesk\" root-directory=\"/home/zcb/resin-4.0.10/apps/helpdesk_g3\">\t\t<error-page>\t\t\t<error-code>404</error-code>\t\t\t<location>/appframe/error404Page.jsp</location>\t\t</error-page>\t\t<error-page>\t\t\t<error-code>500</error-code>\t\t\t<location>/appframe/error500Page.jsp</location>\t\t</error-page>\t\t<error-page>\t\t\t<error-code>503</error-code>\t\t\t<location>/appframe/error503Page.jsp</location>\t\t</error-page>\t\t<error-page>\t\t\t<error-code>504</error-code>\t\t\t<location>/appframe/error504Page.jsp</location>\t\t</error-page>\t  </web-app>    </host>  </cluster>    </resin>\n\n\n\n\n肯定有人问我为啥知道这是电信的业务  我只能说 从这来进去的 公司有账号 所以登陆就到st2地址了 。http://card.118114.net:8080/sdm/   修复方案：  修复吧   版权声明：转载请注明来源 JiuShao@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-04-28 09:57 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国电信集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-24 21:31 |    \t\tJiuShao \t\t\t( 普通白帽子  |\t\t\t        Rank:405 漏洞数:94        | ╮(╯▽╰)╭锄禾日当午)\t\t \n  怎么我后面补充编辑的没显示出来？    \n     2015-04-25 15:37 |    \t\torange \t\t\t( 普通白帽子  |\t\t\t        Rank:185 漏洞数:38        | 戒骄戒躁。)\t\t \n  @JiuShao 需要联系help #wooyun.org再次审核    \n     2015-06-12 14:09 |    \t\t010 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:4        | 性别男，爱好女。)\t\t \n  可怕    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}