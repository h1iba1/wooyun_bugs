{"id": 19275, "wybug_id": "wooyun-2012-07386", "wybug_title": "乐峰网用户认证体系存在逻辑漏洞，可修改任意用户密码", "wybug_corp": "乐蜂网", "wybug_author": "unic02n", "wybug_date": "2012-05-21 18:03", "wybug_open_date": "2012-07-05 18:03", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计错误", "逻辑错误", "敏感接口缺乏认证", "敏感接口未加权限认证", "敏感接口缺乏校验", "敏感数据未加密"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-05-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-06-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-06-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-05：\t细节向公众公开  简要描述： 乐峰网用户认证体系存在逻辑漏洞，可修改任意用户密码本来单条漏洞不至于到15，但是这里考虑到 利用难度，影响范围，重复利用等影响方面，并且攻击的是用户的认证体系。所以自己感觉危害比较大。这里不能说的太详细，， 详细说明：  1，找回密码部分：两种方式，mail和phone，但是验证码都是6位数字，（邮箱）是24小时有效。可以暴力。2，使用后的验证码并未销毁，24小时内可以再次使用，这里就很危险了，只要你找回了密码，24小时内，还可以被修改。3，综合1，2，写个程序跑下可以将24小时内使用了找回密码的链接都找出来，并且给他们重置密码。这里有个问题，因为修改密码并不知道修改的是谁的，所以，在定点攻击的时候会有些麻烦，需要改多个url对应的密码，但是，交给程序还是小菜。   漏洞证明：  1，程序跑到一个\n\n2，\n\n   修复方案：  1，减少验证码有效时间2，使用后即销毁3，增加验证码复杂程序，整个md5 不困难吧，4，限制该功能单个ip提交频率   版权声明：转载请注明来源 unic02n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2012-05-21 18:29 厂商回复： 多谢，我们会安排修补整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-21 22:44 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  效率真高啊！赞一个！    \n     2012-05-22 10:03 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  可以自评20。对于互联网企业，用户是根本。    \n     2012-05-22 11:00 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  @凤凰 本来是20，后来改了15，考虑到这个漏洞攻击的范围目前并不是所有用户，而想攻击所有用户的话，还需要其他的东西，所以给了15.    \n     2012-05-22 14:48 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  @unic02n 原来如此。。。很负责的态度!    \n     2012-06-11 09:33 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  这个很高深 虽然没看懂     \n     2012-06-11 18:20 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  @possible 哈哈，不难懂的，    \n     2012-06-20 18:50 |    \t\tHenry:bobo \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:22        | 本胖吊！~又高又肥2个奶奶像地雷)\t\t \n  我瞬间就懂了    \n     2012-06-21 17:13 |    \t\tMoments \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 2)\t\t \n  攻击的就是24小时内进行过密码找回的用户    \n     2012-06-21 17:28 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  @Moments 你其实可以帮他点找回密码的，    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}