{"id": 51107, "wybug_id": "wooyun-2014-075686", "wybug_title": "正方教务管理系统鸡肋XSS+过滤不严上传webshell", "wybug_corp": "杭州正方", "wybug_author": "ki11y0u", "wybug_date": "2014-09-15 10:46", "wybug_open_date": "2014-12-14 10:48", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-14：\t细节向公众公开  简要描述： 不知道版本是多少，无聊拿自家学校测试，结果出现问题了。提交下吧，也不知道通用不~~~ 详细说明：  无聊登录学校的教务系统如图（也不知道是啥版本）：\nhttp://xxx.xxxx.cn\n\n\n由于学生老师，帐号密码存在弱口令（可爆破），然后随便找了一个学生，登录测试。鸡肋XSS:1.点击\n公告信息\n\n通知文件\n随便打开个连接，\n\n找个美女图片连接，在URL2014前插入试试：\n\n成功插入，来个对话框~\n\n2.存储XSS?点击\n个人信息\n\n信息发送\n找个老师发送带有XSS的消息；\n\n查看发送已发送消息，测试：\n\n登录老师帐号后，查看消息，结果所有信息都是重定向：\n\n又向老师发送正常消息测试，还是如此。用老师帐号向学生发送正常消息和XSS消息结果，不能用：\n\n不知道是管理员禁用了，阉割了，，难道早知道有XSS了给修复了？如果消息功能正常的话，应该可以打到老师cookie，（可上传webshell）3.上传webshell登录另一老师帐号，点击\n教师教案上传\n看到上传功能，常规脚步格式过滤，打开Brupsuite，在aspx后加了个空格，成功绕过：\n\n\n\n打开shell地址：\n\n\n\n貌似用的Oracle数据裤，当初挂了几科。。。拿到shell后也没再深入了，想办法还是给学校管理员说声吧~   漏洞证明：  \n\n   修复方案：  你们都是专业的~~~~   版权声明：转载请注明来源 ki11y0u@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-09-20 08:52 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-16 14:59 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  不是吧？正方拿shell?    \n     2014-09-16 15:42 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  真的啊，不是老版本的。    \n     2014-09-16 15:43 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  @夏殇 真的啊，不是老版本的。    \n     2014-09-16 15:51 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  @ki11y0u 牛了，几版的.通用么    \n     2014-09-16 21:08 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  @夏殇 我是渣渣啊，彩笔。不知道版本多少，没有标识。交个朋友吧～    \n     2014-09-16 21:43 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  @ki11y0u 嗯,一起学习了    \n     2014-09-21 04:36 |    \t\twellsun \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | www.wellsun.com)\t\t \n  @夏殇 正方研究交流群：310068074 加着注WOOYUN名    \n     2014-12-31 20:02 |    \t\tca1n \t\t\t( 普通白帽子  |\t\t\t        Rank:100 漏洞数:22        | not yet)\t\t \n  ....你这个正方怎么看上去好老    \n     2014-12-31 22:45 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  @ca1n 我是不知道啥版本。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}