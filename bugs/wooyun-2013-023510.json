{"id": 10805, "wybug_id": "wooyun-2013-023510", "wybug_title": "cmseasy{易通CMS}v5.5最新getshell漏洞", "wybug_corp": "cmseasy", "wybug_author": "ziwen", "wybug_date": "2013-05-11 18:08", "wybug_open_date": "2013-08-09 18:09", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-17：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-07-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-09：\t细节向公众公开  简要描述： 利用该漏洞可以直接上传webshell等恶意文件，危害巨大且目前官方还未出任何补丁，这里做一下简单的漏洞分析。 详细说明：  漏洞利用入口文件位于：editor/editor/dialog/imageuser_mt_mt.php/index.php?case=user&act=log：\n\n通过该页面就可以上传任意文件到服务器了。看下imageuser_mt_mt.php的代码：$_GET=array('case'=>'user','act'=>'fckupload');include_once dirname(dirname(dirname(dirname(__FILE__)))).'/index.php';包含了index.php并指定了case和act，因为cmseasy实现各个功能的文件都在\\lib\\default\\目录下，我们到该目录下找到user_act.php文件并定位到fckupload函数：    function fckupload_action() {        $uploads=array();        if(is_array($_FILES)) {            $upload=new upload();            foreach($_FILES as $name=>$file) {                $uploads[$name]=$upload->run($file);            }            $this->view->uploads=$uploads;        }        $this->render('../admin/system/fckupload.php');        exit;    }进入进入run()函数(位于\\lib\\tool\\front_class.php)   漏洞证明：  就在上面   修复方案：  修改函数，增加过滤机制   版权声明：转载请注明来源 ziwen@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-05-14 18:43 厂商回复： 感谢，已经修正 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-11 18:14 |    \t\tx7iao \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:41        | 文能床上控萝莉，武能床上定人妻)\t\t \n  http://www.2cto.com/Article/201305/209910.html 目测是这个    \n     2013-05-11 18:17 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  补丁不是出了么？    \n     2013-05-11 18:47 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  临时工把代码回滚了！！！    \n     2013-05-11 18:53 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @猪猪侠 看到微博上发了。。。代码竟然回滚了。。。    \n     2013-05-11 22:47 |    \t\tziwen \t\t\t( 实习白帽子  |\t\t\t        Rank:49 漏洞数:4        | 活着为了乐还是为了苦？)\t\t \n  @梧桐雨 求指教什么叫回滚    \n     2013-05-11 22:48 |    \t\tziwen \t\t\t( 实习白帽子  |\t\t\t        Rank:49 漏洞数:4        | 活着为了乐还是为了苦？)\t\t \n  @x7iao 他发的比我晚，明显为转载！    \n     2013-05-11 22:51 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @ziwen 就是打了补丁的源码被没打补丁的源码覆盖了。就是回滚了，就是回到之前没打补丁的状态的意思    \n     2013-05-12 12:27 |    \t\tziwen \t\t\t( 实习白帽子  |\t\t\t        Rank:49 漏洞数:4        | 活着为了乐还是为了苦？)\t\t \n  @梧桐雨 哦哦，懂了，谢谢    \n     2013-05-14 18:45 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @ziwen 这个漏洞是您转载过来的吧，按照我们的要求，估计木有奖金了    \n     2013-05-14 20:29 |    \t\t邪少 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:7        )\t\t \n  就那个任意上传把。    \n     2013-05-16 22:08 |    \t\tziwen \t\t\t( 实习白帽子  |\t\t\t        Rank:49 漏洞数:4        | 活着为了乐还是为了苦？)\t\t \n  @xsser 我日，为什么是转载啊    \n     2013-10-27 14:22 |    \t\tBadCat \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:21        | 悲剧的我什么都不会)\t\t \n  @ziwen因为..这里..http://www.2cto.com/Article/201305/209910.html    \n     2013-10-28 16:57 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  @ziwen http://www.pnigos.com/?p=125 你提交漏洞的时间是2013-05-11 18:08   他发布漏洞的时间是2013.05.05  呵呵，他做时光机回到过去转载你的文章？    \n     2015-05-12 13:51 |    \t\tHero \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:31        | 药药切克闹,充气娃娃迷幻药)\t\t \n  @李旭敏 不是所有鸡都叫时光鸡！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}