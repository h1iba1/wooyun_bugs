{"id": 79923, "wybug_id": "wooyun-2015-0157035", "wybug_title": "GTA国泰安某管理平台SQL注入两枚（MSSQL高权限注入）", "wybug_corp": "GTA国泰安", "wybug_author": "路人甲", "wybug_date": "2015-12-01 21:51", "wybug_open_date": "2016-01-15 21:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-01：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-01-15：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 两处SQL注入，一处GET，一处POST。administrator权限。脱裤，拿服务器，想干嘛不行？ 详细说明：  网站URL：http://oa.gtadata.com/C6/Jhsoft.Web.login/PassWordNew.aspx\n\nGET型注入：存在注入的URL：http://oa.gtadata.com/C6/Jhsoft.Web.login/NewView.aspx?id=1\n\n扔进神器，可以看到是个MSSQL2008的数据库：\n\n注入第二处，POST：OA系统管理登陆：http://oa.gtadata.com/C6/Jhsoft.mobileapp/login/login.html\n\n登陆过程抓下post包：\n\n修改user和pwd字段为如下所示：\n\n上神器吧：\n\n查看当前用户：\n\n查看数据库内容：\n\n因为是MSSQL数据库。故尝试调用xp_cmdshell成功，执行命令“whoami”：\n\n看到是administrator权限。至此，脱裤，拿服务器，啥不能干？点到为止。不深入了。   漏洞证明：  既然要证明，贴上修改后的post包吧：\nPOST /C6/Jhsoft.mobileapp/login/CheckPwd.ashx HTTP/1.1Host: oa.gtadata.comContent-Length: 65Accept: */*Origin: http://oa.gtadata.comX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://oa.gtadata.com/C6/Jhsoft.mobileapp/login/login.htmlAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: ASPSESSIONIDASACACSS=IOAGNHJBNECFEBOCMPCADMDG; ASP.NET_SessionId=ymj3dwze2gp5nri025rf5w3g; myie=false<root><User>admin</User><Pwd>admin</Pwd><type>login</type></root>\n   修复方案：  过滤。吼吼。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}