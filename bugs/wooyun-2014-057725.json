{"id": 3810, "wybug_id": "wooyun-2014-057725", "wybug_title": "新浪某站SQL注入(涉及2百多张表)", "wybug_corp": "新浪", "wybug_author": "nextdoor", "wybug_date": "2014-04-20 13:48", "wybug_open_date": "2014-06-04 13:49", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-04：\t细节向公众公开  简要描述： 新浪某站sql注入(涉及2百多张表) 详细说明：  注入点http://food.gd.sina.com.cn/article.php?t=rstrt&id=25671可以爆出管理用户和密码有50多个用户名不一一列举，后台http://food.gd.sina.com.cn/admin/login.php50多个用户肯定有弱口令，时间关系未进一步深入测试测试过程如下：\n\n爆出的表，有二百多个\n\n用户名和密码\n\n\n\n\n\n   漏洞证明：  用户名和密码\n\n\n\n   修复方案：  参数化查询语句,按照自己表的格式作对应修改<?php$name = $_GET['name'];$db = new mysqli(\"localhost\", \"dbuser\", \"dbpass\", \"db\");  if (mysqli_connect_errno()){ printf(\"Error:%s\\n\",mysqli_connect_error()); exit; }else{ \tif($stmt = $db->prepare(\"SELECT sname,age,score,snum FROM student WHERE sname like ?\")){\t$sname = $name.\"%\";\t\t\t$stmt->bind_param('s', $sname); \t$stmt->execute();         $stmt->store_result();\t$stmt->bind_result($sname,$age,$score,$snum);\twhile($stmt->fetch()){         echo $sname,$age,$score,$snum,\"<br />\";\t}\t$stmt->close();\t}\t$db->close();\t}?>   版权声明：转载请注明来源 nextdoor@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-04-21 10:21 厂商回复： 多谢，地方站点问题较多，已经着手处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-21 09:14 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  求细节    \n     2014-04-21 14:25 |    \t\tnextdoor \t\t\t( 普通白帽子  |\t\t\t        Rank:325 漏洞数:74        )\t\t \n  @孤独雪狼 未脱裤子    \n     2014-06-04 18:13 |    \t\tAnonymous.L \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:8        | 最后一位关注xxxx的人 , 孤独之人)\t\t \n  不得不说你这修复方案PHP代码写的很XX，都什么时候了输出还要用printf？？？out了    \n     2014-06-05 01:25 |    \t\tnextdoor \t\t\t( 普通白帽子  |\t\t\t        Rank:325 漏洞数:74        )\t\t \n  @Anonymous.L 重点不是printf而是参数化查询语句，这个只是例子，还要，根据自己的数据库进行修改，不要纠结用printf还是echo的问题上。    \n     2014-06-06 02:06 |    \t\tAnonymous.L \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:8        | 最后一位关注xxxx的人 , 孤独之人)\t\t \n  @nextdoor 从这代码里可以看出是一个非常老的程序员写的码。不仅是echo问题    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}