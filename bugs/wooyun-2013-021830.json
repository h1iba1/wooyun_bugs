{"id": 12219, "wybug_id": "wooyun-2013-021830", "wybug_title": "红联Linux门户命令执行漏洞", "wybug_corp": "红联", "wybug_author": "s3cur1ty", "wybug_date": "2013-04-16 14:13", "wybug_open_date": "2013-06-14 10:45", "wybug_type": "文件包含", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "文件包含漏洞", "源码审核", "源码分析", "白盒测试", "越权操作", "渗透测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-16：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-06-14：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 一个低级错误引发的血案! 详细说明：  用了一个叫Supsite的CMS系统，主页面index.php开头包含common.php，这里问题就出在common.php代码中， \n$lang = $_GET['lang'];  if ($lang)  {    setcookie ('suplangid', $lang, 0, $cookiepath, $cookiedomain);  }  else  {    $lang = $_COOKIE['suplangid'];  }  $langinifile = (((SUPSITE_ROOT.'./lang/').$lang).'.php');  if (!file_exists ($langinifile))  {$lang = $ds['lang'];setcookie ('suplangid', $lang, 0, $cookiepath, $cookiedomain);    $langinifile = (((SUPSITE_ROOT.'./lang/').$lang).'.php');  }require_once $langinifile;\n此处$lang参数直接从GET表单中获取用户输入值，随后$lang被添加到$langinfile变量当中，最终被require_once函数包含，可以发现整个过程没有做任何过滤，造成本地文件包含。这里有一个admin/admin_edit.php文件可以编辑php文件，但是有验证不能直接执行，所以利用文件包含执行这个admin_edit.php。   漏洞证明：  PoC:\nhttp://www.linuxdiyf.com/index.php?lang=../admin/admin_edit\n有图有真相：\n\n\n\n   修复方案：  过滤、过滤！   版权声明：转载请注明来源 s3cur1ty@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}