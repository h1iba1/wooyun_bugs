{"id": 11653, "wybug_id": "wooyun-2013-021363", "wybug_title": "phpmpsV2.3 用户cookies伪造漏洞", "wybug_corp": "phpmps", "wybug_author": "knife", "wybug_date": "2013-04-08 10:41", "wybug_open_date": "2013-07-07 10:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "设计缺陷", "设计不当导致攻击界面扩大", "认证缺陷", "认证设计不合理", "源码审核", "欺骗", "源码分析", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-08：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-07-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 只是提个醒 详细说明：  \n问题出在member.php.................../**/省略无关代码./**/require dirname(__FILE__) . '/include/common.php';if($CFG['uc'])require PHPMPS_ROOT . 'include/uc.inc.php';require PHPMPS_ROOT . 'include/json.class.php';require PHPMPS_ROOT . 'include/pay.fun.php';.................../**/省略无关代码./**/if(empty($_userid)) { '判断userid    if (!in_array($act, $not_login)) {        if (in_array($act, $must_login)) {            showmsg('请先登录', 'member.php?act=login&refer='.$PHP_URL);        } else {\t\t\tshowmsg('请不要提交非法请求！');\t\t}    }}.................../**/省略无关代码./**/查看include/common.phpif(!get_magic_quotes_gpc()) {\tif (!empty($_GET))$_GET  = addslashes_deep($_GET);    if (!empty($_POST))$_POST = addslashes_deep($_POST);    $_COOKIE   = addslashes_deep($_COOKIE);    $_REQUEST  = addslashes_deep($_REQUEST);}'get_magic_quotes_gpc  ╮(╯▽╰)╭.................../**/省略无关代码./**/'关键的部分$_userid = 0; '初始化 $_username = '';$uid = $_SESSION['userid'] ? $_SESSION['userid'] : $_COOKIE['userid']; ‘cookie 你懂的啦~if(!empty($uid)) {\t$user_info = $db->getRow(\"select userid,username,lastposttime,status from {$table}member where userid='$uid' \");\tif($user_info) {\t\t$_userid = $user_info['userid'];\t\t$_username = $user_info['username'];\t\t$_lastposttime = $user_info['lastposttime'];\t\t$_status = $user_info['status'];\t}}userid=1 ~\n   漏洞证明：  \n问题出在member.php.................../**/省略无关代码./**/require dirname(__FILE__) . '/include/common.php';if($CFG['uc'])require PHPMPS_ROOT . 'include/uc.inc.php';require PHPMPS_ROOT . 'include/json.class.php';require PHPMPS_ROOT . 'include/pay.fun.php';.................../**/省略无关代码./**/if(empty($_userid)) { '判断userid    if (!in_array($act, $not_login)) {        if (in_array($act, $must_login)) {            showmsg('请先登录', 'member.php?act=login&refer='.$PHP_URL);        } else {\t\t\tshowmsg('请不要提交非法请求！');\t\t}    }}.................../**/省略无关代码./**/查看include/common.phpif(!get_magic_quotes_gpc()) {\tif (!empty($_GET))$_GET  = addslashes_deep($_GET);    if (!empty($_POST))$_POST = addslashes_deep($_POST);    $_COOKIE   = addslashes_deep($_COOKIE);    $_REQUEST  = addslashes_deep($_REQUEST);}'get_magic_quotes_gpc  ╮(╯▽╰)╭.................../**/省略无关代码./**/'关键的部分$_userid = 0; '初始化 $_username = '';$uid = $_SESSION['userid'] ? $_SESSION['userid'] : $_COOKIE['userid']; ‘cookie 你懂的啦~if(!empty($uid)) {\t$user_info = $db->getRow(\"select userid,username,lastposttime,status from {$table}member where userid='$uid' \");\tif($user_info) {\t\t$_userid = $user_info['userid'];\t\t$_username = $user_info['username'];\t\t$_lastposttime = $user_info['lastposttime'];\t\t$_status = $user_info['status'];\t}}userid=1 ~\n   修复方案：  $uid = $_SESSION['userid'] ? $_SESSION['userid']   版权声明：转载请注明来源 knife@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：10 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 10, "Ranks": null}