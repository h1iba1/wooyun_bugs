{"id": 1043, "wybug_id": "wooyun-2014-067447", "wybug_title": "WDC前台getshell一枚", "wybug_corp": "wdlinux", "wybug_author": "Matt", "wybug_date": "2014-07-04 22:30", "wybug_open_date": "2014-09-29 22:32", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["淫荡思路"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-09：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向公众公开  简要描述： 广告位：codescan.cn呵呵 详细说明：  mysql/add_user.php\n<?/*# WDlinux Control Panel, online management of Linux servers, virtual hosts# Author:wdlinux QQ:12571192# Url:http://www.wdlinux.cn/wdcp# Last Updated 2011.03*/require_once \"../inc/common.inc.php\";if (isset($_POST['Submit_add'])) {\t$user=chop($_POST['user']);\t$password=chop($_POST['password']);\t$dbname=chop($_POST['dbname']);\tcheck_user($user);\tcheck_string($password);\tcheck_string($dbname);\tcreate_db_user($user,$password,$host);\tgrant_db_user($user,$host,$dbname);\tmysql_add_user($user,$password,$host,$dbname,$rtime);\toptlog($wdcdn_uid,\"增加mysql数据库 $user\",0,0);\tstr_go_url(\"数据库用户增加成功!\",0);}$member_list=member_list();$site_list=site_list();$db_list=db_list();require_once(G_T(\"mysql/add_user.htm\"));?>\n这个文件没有验证权限（其实是验证的，不知道为什么被注释了）那么我们可以利用这个添加一个mysql的账户但是不能外连，只能localhost，貌似没什么用database可以抓包篡改的观众：这又个jB用别急，朋友wdcp下面有一个phpmyadmin直接访问，http://xxx：8080/phpmyadmin提示输入mysql账号密码上面我们正好能加一个MySQL、用户只需在加mysql用户的时候，把这个用户指定一个数据库即可，我们就可以登录phpmyadmin去读取这个数据库啦观众：那也没吊用啊，除非你知道人家网站的数据库名称，鸡肋啊淡定！正好，wdcp有一个默认的数据库，就叫wdcp呵呵，不用多说了，直接可以读取到wdcp的管理密码，ftp，mysql，所有的所有。。。后面的就不多提了   漏洞证明：  我是四有青年   修复方案：  1,增加文件验证2,根本的方法，就是，给8080增加一个401的认证，安装之后，后台提示设置，这样以后就万无一失了，改不改端口都无所谓，你改了端口人家能扫啊这样双重认证安全多了   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-09-29 22:32 厂商回复：  漏洞Rank：12  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-04 22:33 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  我端根板凳来坐着围观！    \n     2014-07-05 00:07 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  mark一下    \n     2014-07-05 00:13 |    \t\tHaswell \t\t\t( 普通白帽子  |\t\t\t        Rank:167 漏洞数:18        | HorizonSec @ RDFZ)\t\t \n  马克，codescan.cn已牢记    \n     2014-07-05 00:39 |    \t\t大白菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:19        )\t\t \n  马克，codescan.cn已牢记    \n     2014-07-05 14:02 |    \t\t爱小菜 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:5        | 本人菜鸟一枚，努力学习天天向上！希望能让...)\t\t \n  马克，codescan.cn已牢记    \n     2014-07-05 22:51 |    \t\ty35u \t\t\t( 普通白帽子  |\t\t\t        Rank:364 漏洞数:38        | yesu)\t\t \n  求这个细节，重谢，请PM我    \n     2014-07-05 23:14 |    \t\t三十度 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 本屌精通各种花式撸管，装逼32式炉火纯青。...)\t\t \n  求这个细节，重谢，请PM我    \n     2014-07-09 23:00 |    \t\t忆苦思甜 \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:25        )\t\t \n  @y35u DZ7.2    \n     2014-07-09 23:00 |    \t\t忆苦思甜 \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:25        )\t\t \n  @三十度 DZ7.2    \n     2014-07-10 11:33 |    \t\tz7y丶 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 我是z7y的表弟)\t\t \n  马克，codescan.cn已牢记    \n     2014-08-17 00:22 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  require_once \"../inc/common.inc.php\";require_once \"../login.php\";//require_once \"../inc/admlogin.php\";//if ($wdcp_gid!=1) exit;if (isset($_POST['Submit_add'])) {\t$user=chop($_POST['user']);\t$sid=intval($_POST['sid']);为毛我之前的版本都 require_once \"../login.php\";了。    \n     2014-09-13 11:05 |    \t\t默秒全 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | a....)\t\t \n  不是叫wdcpdb么←_←    \n     2014-09-19 21:58 |    \t\t江南的鱼 \t\t\t( 普通白帽子  |\t\t\t        Rank:137 漏洞数:15        | 天生庸才！)\t\t \n  哦，我8月初就用此漏洞拿过一站。还以为没人发现呢！    \n     2014-09-20 01:06 |    \t\tSunshine \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:10        | Nothing.)\t\t \n  @江南的鱼 大牛你手里到底有多少0day    \n     2014-09-29 22:58 |    \t\t实习白帽子 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:5        | 我是一个很短的介绍.)\t\t \n  http://www.wdlinux.cn/bbs/thread-37476-1-1.html忽略然后自己修复？    \n     2014-09-30 09:56 |    \t\t宝宝 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:33        | 我是好宝宝)\t\t \n  刚发现某个比较大的IDC商，全部用的是wdcp的虚拟主机，这下他们技术国庆要加班了......    \n     2014-11-03 17:54 |    \t\thack2012 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:3        | 关注信息安全 http://www.waitalone.cn/)\t\t \n  大牛，源码是如何解密的？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}