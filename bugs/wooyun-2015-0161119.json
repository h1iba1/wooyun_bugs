{"id": 73114, "wybug_id": "wooyun-2015-0161119", "wybug_title": "高德导航某接口XML实体注入", "wybug_corp": "高德软件", "wybug_author": "Aasron", "wybug_date": "2015-12-14 09:05", "wybug_open_date": "2016-01-28 17:10", "wybug_type": "文件包含", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用", "任意文件读取", "文件包含漏洞", "文件包含漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向公众公开  简要描述： 我不能再默默无闻下去了...PS:我上次听说你们是要送礼物的？ 详细说明：  \n\n在我对高德地图离线版进行测试时抓到一个接口\nhttp://us.autonavi.com\n便进行了深入测试实际产生漏洞的接口:\nhttp://us.autonavi.com/navisoftware/tips\n一个正常的页面\n\n抓包内容：\nPOST /navisoftware/tips HTTP/1.1Host: us.autonavi.comContent-Type: application/x-www-form-urlencodedAccept: */*userid: syscode: 41001apkversion: 14os: 9.1Accept-Language: zh-cnAccept-Encoding: gzip, deflatemapversion: 30.1.031005.0010imei: 4EFFB44F-E719-4F74-950E-CDC055EA9E89User-Agent: %E9%AB%98%E5%BE%B7%E5%AF%BC%E8%88%AA/9.6.4 CFNetwork/758.1.6 Darwin/15.0.0Content-Length: 242Connection: keep-alivepid: 2model: iPhoneresolution: 1242x2208sign: 3a175d2b8a0ddb113c60fad427ffa8ac\n测试了一下发现存在XML注入构造代码读取etc/passwd 成功返回，root权限\n\n\nroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinuucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinabrt:x:173:173::/etc/abrt:/sbin/nologinsaslauth:x:499:76:\"Saslauthd user\":/var/empty/saslauth:/sbin/nologinpostfix:x:89:89::/var/spool/postfix:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologintcpdump:x:72:72::/:/sbin/nologinoprofile:x:16:16:Special user account to be used by OProfile:/home/oprofile:/sbin/nologinbacula:x:133:133:Bacula Backup System:/var/spool/bacula:/sbin/nologinradiusd:x:95:95:radiusd user:/home/radiusd:/sbin/nologinmysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bashdovecot:x:97:97:Dovecot IMAP server:/usr/libexec/dovecot:/sbin/nologindovenull:x:498:499:Dovecot's unauthorized user:/usr/libexec/dovecot:/sbin/nologinapache:x:48:48:Apache:/var/www:/sbin/nologinqpidd:x:497:498:Owner of Qpidd Daemons:/var/lib/qpidd:/sbin/nologinautonavi:x:500:500::/home/autonavi:/bin/bashnagios:x:501:501::/home/nagios:/sbin/nologinzabbix:x:502:502::/home/zabbix:/bin/bashzongning:x:503:503::/home/zongning:/bin/bash\n危害挺大，可以进行其它操作，或构造XML语句进行攻击！   漏洞证明：  \n\n在我对高德地图离线版进行测试时抓到一个接口\nhttp://us.autonavi.com\n便进行了深入测试实际产生漏洞的接口:\nhttp://us.autonavi.com/navisoftware/tips\n一个正常的页面\n\n抓包内容：\nPOST /navisoftware/tips HTTP/1.1Host: us.autonavi.comContent-Type: application/x-www-form-urlencodedAccept: */*userid: syscode: 41001apkversion: 14os: 9.1Accept-Language: zh-cnAccept-Encoding: gzip, deflatemapversion: 30.1.031005.0010imei: 4EFFB44F-E719-4F74-950E-CDC055EA9E89User-Agent: %E9%AB%98%E5%BE%B7%E5%AF%BC%E8%88%AA/9.6.4 CFNetwork/758.1.6 Darwin/15.0.0Content-Length: 242Connection: keep-alivepid: 2model: iPhoneresolution: 1242x2208sign: 3a175d2b8a0ddb113c60fad427ffa8ac\n测试了一下发现存在XML注入构造代码读取etc/passwd 成功返回，root权限\n\n\nroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinuucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinabrt:x:173:173::/etc/abrt:/sbin/nologinsaslauth:x:499:76:\"Saslauthd user\":/var/empty/saslauth:/sbin/nologinpostfix:x:89:89::/var/spool/postfix:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologintcpdump:x:72:72::/:/sbin/nologinoprofile:x:16:16:Special user account to be used by OProfile:/home/oprofile:/sbin/nologinbacula:x:133:133:Bacula Backup System:/var/spool/bacula:/sbin/nologinradiusd:x:95:95:radiusd user:/home/radiusd:/sbin/nologinmysql:x:27:27:MySQL Server:/var/lib/mysql:/bin/bashdovecot:x:97:97:Dovecot IMAP server:/usr/libexec/dovecot:/sbin/nologindovenull:x:498:499:Dovecot's unauthorized user:/usr/libexec/dovecot:/sbin/nologinapache:x:48:48:Apache:/var/www:/sbin/nologinqpidd:x:497:498:Owner of Qpidd Daemons:/var/lib/qpidd:/sbin/nologinautonavi:x:500:500::/home/autonavi:/bin/bashnagios:x:501:501::/home/nagios:/sbin/nologinzabbix:x:502:502::/home/zabbix:/bin/bashzongning:x:503:503::/home/zongning:/bin/bash\n危害挺大，可以进行其它操作，或构造XML语句进行攻击！   修复方案：  你们更专业   版权声明：转载请注明来源 Aasron@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-12-16 16:32 厂商回复： 亲，漏洞已经在处理中，感谢您对阿里巴巴的关注和支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-14 12:16 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:208 漏洞数:57        | 工欲善其事，必先利其器)\t\t \n  我还以为跟百度一样的要打个雷！    \n     2015-12-14 12:40 |    \t\t紫霞仙子  \t\t\t( 普通白帽子  |\t\t\t        Rank:2223 漏洞数:301        | 天天向上 ！！！)\t\t \n  @Aasron 额。。。。还没打雷那么屌。快多刷些洞来。    \n     2015-12-14 13:12 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:208 漏洞数:57        | 工欲善其事，必先利其器)\t\t \n  @紫霞仙子 好，等我刷起来了，再和你愉快的玩耍    \n     2015-12-15 15:35 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:208 漏洞数:57        | 工欲善其事，必先利其器)\t\t \n  @紫霞仙子 是不是要忽略的节奏    \n     2016-01-05 17:03 |    \t\t小红猪 \t\t\t( 普通白帽子  |\t\t\t        Rank:285 漏洞数:48        | little red pig!)\t\t \n  怎么是阿里巴巴？！    \n     2016-01-06 02:48 |    \t\tXiaoXu \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | ?)\t\t \n  @小红猪 因为高德地图被阿里收购了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}