{"id": 20290, "wybug_id": "wooyun-2012-05679", "wybug_title": "在jason数据处理时未加验证，爆出异常。", "wybug_corp": "新浪", "wybug_author": "marker", "wybug_date": "2012-03-31 11:01", "wybug_open_date": "2012-05-15 11:02", "wybug_type": "异常处理", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-03-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-03-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-04-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-04-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-04-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-05-15：\t细节向公众公开  简要描述： 在jason数据处理时未加验证，爆出异常。 详细说明：  http://2.49.web1.im.weibo.com/im?jsonp=parent.org.cometd.script._callback57&message=[{%22channel%22:%22/meta/connect%22%3E;%3Cimg%20src=e%20onerror=alert%281234%29%3E%22,%22connectionType%22:%22callback-polling%22,%22id%22:58,%22clientId%22:%221s1wcv8qe8ap74hddzu%22}]&1333160737516   漏洞证明：  HTTP ERROR 404Problem accessing /error.html. Reason:    NOT_FOUNDCaused by:java.lang.Error: [{\"channel\":\"/meta/connect\">;<img src=e onerror=alert(1234)>\",\"connectionType\":\"callback-polling\",\"id\":58,\"clientId\":\"1s1wcv8qe8ap74hddzu\"}]\tat org.mortbay.cometd.AbstractCometdServlet.getMessages(AbstractCometdServlet.java:343)\tat org.mortbay.cometd.continuation.ContinuationCometdServlet.service(ContinuationCometdServlet.java:71)\tat org.mortbay.cometd.AbstractCometdServlet.service(AbstractCometdServlet.java:249)\tat org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)\tat org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)\tat filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:134)\tat org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)\tat org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)\tat org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)\tat org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)\tat org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)\tat org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)\tat org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)\tat org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)\tat org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\tat org.mortbay.jetty.handler.StatisticsHandler.handle(StatisticsHandler.java:53)\tat cn.vika.webim.servlet.RequestStat.handle(RequestStat.java:51)\tat org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\tat org.mortbay.jetty.Server.handle(Server.java:326)\tat org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)\tat org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)\tat org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:547)\tat org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)\tat org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)\tat org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)\tat org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)Caused by: java.lang.IllegalStateException: Unexpected '>' while seeking one of ',}'\tat org.mortbay.util.ajax.JSON.seekTo(JSON.java:1167)\tat org.mortbay.util.ajax.JSON.parseObject(JSON.java:812)\tat org.mortbay.util.ajax.JSON.parse(JSON.java:745)\tat org.mortbay.util.ajax.JSON.parseArray(JSON.java:880)\tat org.mortbay.util.ajax.JSON.parse(JSON.java:747)\tat org.mortbay.cometd.MessagePool.parseTo(MessagePool.java:151)\tat org.mortbay.cometd.AbstractCometdServlet.getMessages(AbstractCometdServlet.java:331)\t... 25 moreCaused by:java.lang.IllegalStateException: Unexpected '>' while seeking one of ',}'\tat org.mortbay.util.ajax.JSON.seekTo(JSON.java:1167)\tat org.mortbay.util.ajax.JSON.parseObject(JSON.java:812)\tat org.mortbay.util.ajax.JSON.parse(JSON.java:745)\tat org.mortbay.util.ajax.JSON.parseArray(JSON.java:880)\tat org.mortbay.util.ajax.JSON.parse(JSON.java:747)\tat org.mortbay.cometd.MessagePool.parseTo(MessagePool.java:151)\tat org.mortbay.cometd.AbstractCometdServlet.getMessages(AbstractCometdServlet.java:331)\tat org.mortbay.cometd.continuation.ContinuationCometdServlet.service(ContinuationCometdServlet.java:71)\tat org.mortbay.cometd.AbstractCometdServlet.service(AbstractCometdServlet.java:249)\tat org.mortbay.jetty.servlet.ServletHolder.handle(ServletHolder.java:511)\tat org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1166)\tat filters.SetCharacterEncodingFilter.doFilter(SetCharacterEncodingFilter.java:134)\tat org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1157)\tat org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:388)\tat org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)\tat org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)\tat org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:765)\tat org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:418)\tat org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)\tat org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)\tat org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\tat org.mortbay.jetty.handler.StatisticsHandler.handle(StatisticsHandler.java:53)\tat cn.vika.webim.servlet.RequestStat.handle(RequestStat.java:51)\tat org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)\tat org.mortbay.jetty.Server.handle(Server.java:326)\tat org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)\tat org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:923)\tat org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:547)\tat org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)\tat org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)\tat org.mortbay.io.nio.SelectChannelEndPoint.run(SelectChannelEndPoint.java:409)\tat org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)Powered by Jetty://   修复方案：  验证输入,增加异常处理   版权声明：转载请注明来源 marker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2012-03-31 12:07 厂商回复： 感谢提供 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}