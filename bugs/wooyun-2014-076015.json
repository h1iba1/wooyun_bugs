{"id": 51019, "wybug_id": "wooyun-2014-076015", "wybug_title": "phpyun多漏洞组合写shell(有条件限制)", "wybug_corp": "php云人才系统", "wybug_author": "JJ Fly", "wybug_date": "2014-09-16 14:12", "wybug_open_date": "2014-12-15 14:14", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-19：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-15：\t细节向公众公开  简要描述： phpyun多漏洞组合写shell(有条件限制) 详细说明：  1.Phpyun的后台基本都有token。之所以说基本，是因为还漏掉了一个关键的地方。\n\nPhpyun的管理员帐号密码都在phpyun_admin_user表中。用上面的方法进行备份，是没有token的\n\n限制条件  \nhttp://wooyun.org/bugs/wooyun-2014-064004   感谢u神\n然后如下。\n\n2.好的，再来说如果实现上面这个get的问题。我们注册一个企业用户。然后在添加一个表情，然后修改图片属性，地址。\n\n\n\n把图片的url改成我们上面的地址。然后等管理员，审核企业信息的时候就行了。（觉得速度慢，可以加点社工。）3.进入后台数据库删除\n\n\n\n对提交的参数没有进行过滤，可以删除lock文件Sql那个参数那改成 ../phpyun .lock然后我们就可以重新安装phpyun了。   漏洞证明：  4.下面就可以重新安装了。重新安装的话在数据库名称那，可以抓包对数据库名进行修改，页面有js限制。\n\n由于没有读取到数据库的帐号密码，我们只能尝试外联。(图中为本机)抓包修改数据库名   xx',1=>eval($_POST[c]),'xx'=>'\n\n然后 db.config.php 如下\n\n   修复方案：     版权声明：转载请注明来源 JJ Fly@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-09-16 14:24 厂商回复： 感谢您的提供，我们会尽快修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}