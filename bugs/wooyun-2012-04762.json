{"id": 20813, "wybug_id": "wooyun-2012-04762", "wybug_title": "招商银行ATM自助取款机权限绕过漏洞", "wybug_corp": "招商银行", "wybug_author": "Lee", "wybug_date": "2012-02-23 22:23", "wybug_open_date": "2012-04-08 22:24", "wybug_type": "权限控制绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-02-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-02-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-04-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-04-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-05-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-04-08：\t细节向公众公开  简要描述： 招商银行自助ATM机器，是集自助取款、查询等功能为一体的金融服务终端，其查询模块是基于windows xp系统的flash沙盘，在反复提交某些错误的输入后会造成查询性能短暂的假死并出现错误，对沙盘系统会产生崩溃现象得以绕过沙盘，在触摸屏选择屏幕键盘后可以进一步对其进行扩大利用。 详细说明：  \n\n\n\n\n\n\n\n\n\n招商银行自助ATM机器，是集自助取款、查询等功能为一体的金融服务终端，其查询模块是基于windows xp系统的flash沙盘，在反复提交某些错误的输入后会造成查询性能短暂的假死并出现错误，对沙盘系统会产生崩溃现象得以绕过沙盘，在触摸屏选择屏幕键盘后可以进一步对其进行扩大利用。漏洞测试：国债查询页面，反复查询和输入，大约12次，出现某个dll初始化失败；选择“否”后出现错误，程序自动关闭。   漏洞证明：  \n\n\n\n\n\n\n\n\n\n招商银行自助ATM机器，是集自助取款、查询等功能为一体的金融服务终端，其查询模块是基于windows xp系统的flash沙盘，在反复提交某些错误的输入后会造成查询性能短暂的假死并出现错误，对沙盘系统会产生崩溃现象得以绕过沙盘，在触摸屏选择屏幕键盘后可以进一步对其进行扩大利用。漏洞测试：国债查询页面，反复查询和输入，大约12次，出现某个dll初始化失败；选择“否”后出现错误，程序自动关闭。   修复方案：  1、优化哑终端。2、程序优化。   版权声明：转载请注明来源 Lee@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2012-02-24 08:25 厂商回复： CNVD未能直接复现，根据图片确认。根据此前建行、农行、交行类似漏洞的评级，rank 3。谢谢Lee近期做的系列检测。请xsser后续点评。 最新状态： 2012-02-24：招商银行总行已经与CNVD联系，确认位置信息后着即处置。  ", "replys": "漏洞评价：\n评论\n     2012-02-23 22:26 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  求学习，求认识。    \n     2012-02-23 22:27 |    \t\t乌龟 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        | 网络安全爱好者)\t\t \n  最近ATM频繁中枪。。    \n     2012-02-24 00:17 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  权限饶过之后可以让ATM吐钱吗？虽然就算吐了也不敢拿……    \n     2012-02-24 08:48 |    \t\tLee \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:24        | wataru@eviloctal.com)\t\t \n  @zeracker http://wenku.baidu.com/search?word=ncr%20配置&lm=0&od=0http://wenku.baidu.com/search?word=ncr&lm=0&od=0&fr=top_search    \n     2012-02-24 10:34 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Lee 这个貌似真是atm呢    \n     2012-02-24 10:50 |    \t\tLee \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:24        | wataru@eviloctal.com)\t\t \n  @xsser 昨晚吃料理，看见，好漂亮的，进去了，用N900拍照，闪光灯很厉害，结果那玩意提示什么“金融设备不允许拍照，你的行为已记录”，当时我立马出去开车就走。    \n     2012-02-24 11:04 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @Lee ...    \n     2012-02-24 11:35 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @Lee  好好看看。谢谢    \n     2012-02-24 11:49 |    \t\tMicro Da \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:7        | Micro Da)\t\t \n  哈哈。膜拜    \n     2012-02-24 13:44 |    \t\t蚊虫 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:12        | 我装逼这么牛可还是没妞喜欢我)\t\t \n  @Lee 金融设备真神奇....    \n     2012-03-08 09:40 |    \t\tcharles \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 研究web安全,0day,漏洞挖掘,关注国内安全动...)\t\t \n  呵呵.这个挖下真不错    \n     2012-03-25 10:44 |    \t\tenab1e \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 热爱信息安全，希望能为安全作出一点点贡献...)\t\t \n  膜拜～～～    \n     2012-03-27 20:36 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  终端Hacking I love thank LZ 。    \n     2012-04-09 14:00 |    \t\tlivers \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:6        | mov esp,0jmp espcrash.....)\t\t \n  邪吧的啊 亲    \n     2013-05-28 14:50 |    \t\traulronaldo \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 小白一枚)\t\t \n  这个攻击非常牛~~~之前浦发银行的终端也崩溃，得到桌面权限，蛮好入侵下看看哈哈。。。太仁慈了，打客服电话告知，我真是失败啊。。。。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}