{"id": 23751, "wybug_id": "wooyun-2010-0969", "wybug_title": "Sohu某站点目录遍历和任意代码泄露", "wybug_corp": "Sohu.com", "wybug_author": "路人甲", "wybug_date": "2010-12-16 11:42", "wybug_open_date": "2010-12-21 12:00", "wybug_type": "系统/服务运维配置不当", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "目录遍历", "代码泄漏", "服务器配置错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-12-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2010-12-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： Sohu某站点由于配置不当导致目录遍历和任意代码泄露 详细说明：  \nhttp://pic.pp.sohu.com/\n   漏洞证明：  \n<%@ page contentType=\"text/html; charset=GBK\" %><%@ page import=\"com.sohu.photoserver.loadbalance.*, com.sohu.photoserver.upload.util.BeanUtil\" %><html><head><title>refresh</title></head><body bgcolor=\"#ffffff\"><h1>服务器分组刷新管理</h1><form method=\"post\" action=\"refresh.jsp\">  确认要刷新服务器分组吗？<br><br><input type=\"submit\" name=\"refresh\" value=\"确认\"><input type=\"reset\" value=\"Reset\"></form><%  String oper = request.getParameter(\"refresh\");  if (oper != null) {    BalancerRefreshThread thread = (BalancerRefreshThread) BeanUtil.getBean(request.getSession().getServletContext(), \"balancerRefreshThread\");    thread.refreshServers(3);    ServerBalancer imageFileBalancer = thread.getImageFileBalancer();    LoadBalanceImpl fileload = (LoadBalanceImpl) imageFileBalancer.getLoadBalance();    out.print(\"<br>文件服务器:<br>\"+fileload.getLoadMatrix());    thread.refreshServers(2);    ServerBalancer imageUploadBalancer = thread.getImageUploadBalancer();    LoadBalanceImpl uploadload = (LoadBalanceImpl) imageUploadBalancer.getLoadBalance();    out.print(\"<br>上传服务器:<br>\"+uploadload.getLoadMatrix());      }%></body></html>\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2010-12-21 12:00 厂商回复：  漏洞Rank：5  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}