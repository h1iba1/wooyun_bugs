{"id": 66132, "wybug_id": "wooyun-2015-0138639", "wybug_title": "海尔智能APP多漏洞组合爆破用户信息间接控制用户设备", "wybug_corp": "海尔集团", "wybug_author": "纳米翡翠", "wybug_date": "2015-09-02 16:46", "wybug_open_date": "2015-10-21 10:22", "wybug_type": "用户资料大量泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-21：\t细节向公众公开  简要描述： 某一个炙热的夏天，你买回一个海尔智能空调，连上wifi，朋友圈各种嘚瑟，APP远程设置好温度，想着今天可以美美的睡一觉了，结果后半夜突然热醒了，一看自己家的空调竟然开着制热39度在狂吹，是空调坏了还是你的空调已经被别人控制了?? 详细说明：  废话不多说了，这次主题就是爆破，爆破用户名、爆破密码1.爆用户名海尔的APP也真是多，一个产品一个APP\n\n这还只是其中的几个，之所以下载这么多，目的就是看看不同APP工作原理，按照开发惯例，同一个公司的不同产品，会有很多共同点，以下是针对海尔不同APP的探索总结：--->所有的产品共用一个用户表，同一个用户可以登录不同的APP，这一点无可厚非--->不同的产品可以使用不同的头像，头像保存在http://203.130.41.40:80/download/resource/下面的不同的产品目录里面--->登录接口未做防爆处理，可以无限尝试登录在经过对海尔APP多次研究和信息收集之后，爆破开始：1.1 收集用户ID海尔APP登录的时候会从http://203.130.41.40:80/download/resource下载用户的头像，幸运的是该目录可以列目录\n\n经过分析发现海尔不同的APP将用户的头像保存在不同的目录下面，并且以用户的ID为目录名：\n\n于是乎不管三七二十一把所有目录下面的id号都收集了一下，结果收集到ID共38772条（有遗漏）\n\n拿到ID之后，下一步就是通过ID拿到用户的用户名经过一些探索，发现在海尔好空气app的论坛处存在id与用户名的对应关系\n\n打开一个帖子，并抓包，可看到返回的json里面有id与loginName的对应：\n\n点击评论，提交评论并抓包，发现评论处可以填入其它用户的ID：\n\n这样的话我们只需要把ID更改为之前我们收集到的id列表，然后遍历用户名，丢给burpsuite\n\n之后再访问之前的贴子，即可在评论处拿到所有遍历的用户的信息\n\n抓包拿到该评论列表的json数据：\n\n整理后提取用户名，如下：\n\n2.爆破密码，拿到用户名了，爆破密码成不成功就是看字典强不强大了，这里只使用了简单的几个密码：\n\nburpsuite抓包拿到APP登录的地址，然后丢到Intruder,导入用户名列表，接下来等,由于用户多，爆破慢所以就提前结束了\n\n整理爆破的结果，一共969条数据\n\n3.拿个用户登录尝试一下\n\n即可控制该用户空调   漏洞证明：  5700多用户，爆破完成80%，弱口令字典简单的情况下竟然有969条爆破成功的数据，接近20%的成功率，我只想说不要把安全寄予到用户身上，更多的需要企业方来做好安全   修复方案：  绑定设备，增加校验   版权声明：转载请注明来源 纳米翡翠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-09-06 10:21 厂商回复： 感谢乌云平台白帽子的测试与提醒，我方已安排人员进行处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}