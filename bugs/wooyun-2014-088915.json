{"id": 41408, "wybug_id": "wooyun-2014-088915", "wybug_title": "最佳东方阶段1打包漏洞", "wybug_corp": "最佳东方", "wybug_author": "todaro", "wybug_date": "2014-12-29 15:02", "wybug_open_date": "2015-02-12 15:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "字符类型注射", "源码泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-12：\t细节向公众公开  简要描述： 你们也是太懒，所有的网站只用了一个数据库。。。。 详细说明：  看漏洞证明。   漏洞证明：  先说你们的SQL注入吧。注入点：http://hotel.medeen.net/book/book?product_id=5218&join_type=1看图。\n\n42个，各个可看~其中的一个Database: df_cms[245 tables]+------------------------------+| md_9first_contact_exp        || md_9first_contact_exp_data   || md_9first_contact_team       || md_9first_contact_team_data  || md_9first_contacts_news      || md_9first_contacts_news_data || md_activity                  || md_admin                     | | md_admin_panel               || md_admin_role                || md_admin_role_priv           || md_allowip                   || md_announce                  || md_article                   || md_article_data              || md_attachment                || md_attachment_index          || md_badword                   || md_billboard                 || md_billboard_data            || md_block                     || md_block_history             || md_block_priv                || md_cache                     || md_category                  || md_category_copy             || md_category_priv             || md_collection_content        || md_collection_history        || md_collection_node           || md_collection_program        || md_column                    || md_column_data               || md_comment                   || md_comment_check             || md_comment_data_1            || md_comment_setting           || md_comment_table             || md_company                   || md_company_data              || md_company_logo              || md_company_logo_data         || md_content_check             || md_copyfrom                  || md_datacall                  || md_dbsource                  || md_dianping                  || md_dianping_data             || md_dianping_type             || md_download                  || md_download_data             || md_downservers               || md_example                   || md_example_data              || md_expert                    || md_expert_data               || md_extend_setting            || md_favorite                  || md_findjob                   || md_findjob_data              || md_first9_content            || md_first9_content_data       || md_form_analysis             || md_form_comments             || md_form_earn_start           || md_form_elite                || md_form_feedback_24hour      || md_form_firm                 || md_form_group_apply          || md_form_meadin_personbrand   || md_form_medeen               || md_form_micro_train          || md_form_mss_hefei            || md_form_mss_hefei2           || md_form_mss_introduction     || md_form_mss_ningbo           || md_form_mss_shanghai         || md_form_mss_yiwu             || md_form_new_shanghai         || md_form_online               || md_form_person_apply         || md_form_reading_feedbook     || md_form_reporter             || md_form_smart_hotel          || md_form_talent               || md_form_talent_show          || md_form_tech_trail           || md_form_vote_company         || md_form_xjs4                 || md_group_news                || md_group_news_data           || md_guyi_article              || md_guyi_article_data         || md_hits                      || md_honor                     || md_honor_data                || md_hot_jobs                  || md_hot_jobs_data             || md_ihma_manager              || md_ihma_manager_data         || md_ihma_news                 || md_ihma_news_data            || md_ipbanned                  || md_job                       || md_job_data                  || md_jobbon_article            || md_jobbon_article_data       || md_jobbon_common             || md_jobbon_common_data        || md_jobbon_team               || md_jobbon_team_data          || md_jobs                      || md_jobs_data                 || md_keylink                   || md_keyword                   || md_keyword_data              || md_link                      || md_linkage                   || md_links                     || md_links_data                || md_log                       || md_me_review                 || md_meadin_keyword            || md_meadin_keyword_list       || md_member                    || md_member_detail             || md_member_group              || md_member_menu               || md_member_verify             || md_member_vip                || md_menu                      || md_message                   || md_message_data              || md_message_group             || md_model                     || md_model_field               || md_module                    || md_mood                      || md_mss                       || md_mss_data                  || md_news                      || md_news2                     || md_news2_data                || md_news4                     || md_news4_data                || md_news_data                 || md_newsclass                 || md_newsclass1                || md_nominees                  || md_nominees_data             || md_ns_news                   || md_ns_news_pic               || md_oldspecial                || md_page                      || md_pay_account               || md_pay_payment               || md_pay_spend                 || md_person_news               || md_person_news_data          || md_picture                   || md_picture_data              || md_position                  || md_position_data             || md_poster                    || md_poster_201303             || md_poster_201304             || md_poster_201305             || md_poster_201306             || md_poster_201307             || md_poster_201308             || md_poster_201309             || md_poster_201310             || md_poster_201311             || md_poster_201312             || md_poster_201401             || md_poster_201402             || md_poster_201403             || md_poster_201404             || md_poster_201405             || md_poster_201406             || md_poster_201407             || md_poster_201408             || md_poster_201409             || md_poster_201410             || md_poster_201411             || md_poster_201412             || md_poster_space              || md_praise                    || md_queue                     || md_release_point             || md_search                    || md_search_keyword            || md_seo                       || md_session                   || md_simple_9first             || md_simple_9first_data        || md_site                      || md_slider                    || md_slider_data               || md_sms_report                || md_special                   || md_special_c_data            || md_special_content           || md_sphinx_counter            || md_sso_admin                 || md_sso_applications          || md_sso_members               || md_sso_messagequeue          || md_sso_session               || md_sso_settings              || md_standard_9first           || md_standard_9first_data      || md_standard_hotel            || md_standard_hotel_data       || md_standard_veryeast         || md_standard_veryeast_data    || md_study_9first              || md_study_9first_data         || md_tag                       || md_template_bak              || md_times                     || md_type                      || md_urlrule                   || md_user_example              || md_user_example_data         || md_user_speech               || md_user_speech_data          || md_video                     || md_video_content             || md_video_data                || md_video_store               || md_views                     || md_views_data                || md_vote_data                 || md_vote_logs                 || md_vote_option               || md_vote_subject              || md_vote_theme                || md_wap                       || md_wap_type                  || md_workflow                  || md_xianzhi_news              || md_xianzhi_news_data         || md_zt_tj                     || md_zt_tj_data                |+------------------------------+其中的一些数据\n\n再看\n\n放心吧  没有获取。包括上面的有一个bbs也是。对你们用户的数据不感兴趣，不是做那行的料，也怕查水表。什么该有的什么不该有的数据库都在里面了，呵呵。恩SQL就到这吧。下面是你们大公司的通病，源码又放到Github了。https://github.com/jami918/m.mea/  这个是你们的源码地址，基本上贡献源码的有3个程序员主力军，好好的教育一下信息安全的东西吧。整个的源码泄露，也用一些账号登陆成功了。\"smtp.163.com\";'dfwsgroup2010@163.com','dfwsgroup2011@163.com','dfwsgroup2012@163.com','dfwsgroup2013@163.com','dfwsgroup2014@163.com','dfwsgroup2015@163.com',Password = \"veryeast.com\";这些都是能登陆的，还有你们的FTP'host' => '122.224.97.233','username' => 'vip_veryeast_cn_company_pic','password' => 'vip_veryeast_cn_company_pic_#$%78#'\n\n找路径就找死我了。技巧是找到一张图片，里面有名称成诚 铁板烧 日本料理关键字搜索。。site:veryeast.cn   成诚 铁板烧 日本料理找到网站：http://job.veryeast.cn/915072/index.htm终于让我找到路径了。。。。http://f3.v.veimg.cn/company_picture/000/915/072/logo/14122506227116.jpg最后服务器居然是不解析，不然shell就给你挂上去了。。。然后最后是一个简单的自己插自己的存储型xss，就先只看了一个地方的，本想找可以群发的地方，结果没找到。http://home.9first.com/account/set 这里\n\n\n\n第一阶段就到这吧，我没有留后手。如果你们欢迎，有机会我还帮你们看看。如果不欢迎，就不干了，我是来学习交流的，你们不愿意让我做的事情，我就不做了，留给其他黑产去做吧，他们会很喜欢你们的那个什么工作招聘的。呵呵   修复方案：  借用大牛的话，安全是整体的，一个疏漏，所有都疏漏。sql这个地方，只试了这个地方，像这种intval就能解决的东西，不知道你们怎么想的。Github，共享精神可嘉，但是你们有些地方最好打码什么的。   版权声明：转载请注明来源 todaro@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-12-29 18:28 厂商回复： 千里之堤，溃于蚁穴。紧急修复中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-29 20:28 |    \t\ttodaro \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:12        | 完结。)\t\t \n  @最佳东方  为什么你们给了20，我才得到4？    \n     2015-01-10 11:38 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  @todaro 小厂商额。。。    \n     2015-01-18 20:09 |    \t\t淡蓝色の忧伤 \t\t\t( 普通白帽子  |\t\t\t        Rank:172 漏洞数:26        | 开启审计php代码模式      (⊙v⊙)嗯)\t\t \n  如果不欢迎，就不干了，我是来学习交流的，你们不愿意让我做的事情，我就不做了，留给其他黑产去做吧，他们会很喜欢你们的那个什么工作招聘的。   洞主你这是在威胁厂商嘛 -_-||    \n     2015-01-19 11:24 |    \t\ttodaro \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:12        | 完结。)\t\t \n  @淡蓝色の忧伤   有点意思。因为之前的源码都在我手上了，有想做审计的打算，只是懒也没时间。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}