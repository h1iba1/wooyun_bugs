{"id": 52521, "wybug_id": "wooyun-2014-070977", "wybug_title": "Doyo建站系统验证缺陷（可遍历订单）", "wybug_corp": "Doyo", "wybug_author": "贫道来自河北", "wybug_date": "2014-08-04 17:43", "wybug_open_date": "2014-11-02 17:44", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-02：\t细节向公众公开  简要描述： 一个比较有点危害不可以小看的问题。 详细说明：  由于官方的DEMO无法生产订单，只能本地搭建来测试了首先来看一下关键的代码function pay(){\t\t$oid=$this->syArgs('id',1);\t\t$pid=$this->syArgs('payment',1);\t\tif($oid=='')message(\"请指定订单号\");\t\tif($pid=='')message(\"请选择支付平台\");\t\t$order=$this->c->find(array('id'=>$oid));\t\tif(!$order)message(\"订单不存在或已被删除\");\t\tif($order['state']!=0){jump('?c=member&a=myorder&oid='.$order['id']);}\t\t$subject='订单号：'.$order['orderid'];这就是存在缺陷的核心代码，我就不多说了，相信大家都看的懂。   漏洞证明：  我是本地搭建的\n\n首先可以注册两个账号账号1：aizai2010账号2：aizai2011首先登陆账号1，下一订单\n\n\n\nhttp://127.0.0.1:8888/index.php?c=pay&a=order&oid=103  后面的oid的参数是关键登陆账号2，下一个订单\n\n\n\nhttp://127.0.0.1:8888/index.php?c=pay&a=order&oid=104然后最关键的一部，我们来吧账号2订单的oid参数改为103\n\n\n\n看到没有已经成功查看到账号1的订单数据，而且登陆的账号还是账号2.还有，我想说一下这个被忽略的漏洞http://www.wooyun.org/bugs/wooyun-2014-070843/trace/e01b64512338155e41a488609a055d1a虽然官方DEMO测试不成功，但是从官网上下载的源码搭建起来的环境切实存在该漏洞。   修复方案：  官方会修的   版权声明：转载请注明来源 贫道来自河北@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-08-09 09:42 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-03 16:24 |    \t\t用来怀念 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 不是什么人都一定要去拥有，有的东西最好用...)\t\t \n  话说洞主看这套程序还有其他漏洞吗?    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}