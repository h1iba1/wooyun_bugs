{"id": 55440, "wybug_id": "wooyun-2014-060965", "wybug_title": "某通用型高校数字化学习中心平台自定义页面getshell", "wybug_corp": "http://www.dascomsoft.com", "wybug_author": "爱上襄阳", "wybug_date": "2014-05-20 14:26", "wybug_open_date": "2014-08-18 14:28", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传内容未检查"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-18：\t细节向公众公开  简要描述： 多所学校使用该系统，影响较大。 详细说明：  http://wooyun.org/bugs/wooyun-2014-059478 重复得实信息科技有限公司（http://www.dascomsoft.com/）开发的高校数字化学习中心系统存在自定义页面等多处上传漏洞，由于很多学校使用该系统，影响非常大。这个来自官网的层共案例连接：http://www.dascomsoft.com/website/cases.aspx列出了300所高校使用该系统。\n\n拿襄阳职业技术学院数字化学习中心为例1.得实数字化教学中心，自定义页面管理一个测试帐户：一个普通老师用户，登录到数字化学习中心后台进入【我建设的课程】-【课程管理中心】-【班级管理】-【网站管理】-【自定义页面管理】\n\n根据此漏洞，直接获取到一个shell\n\n2、系统设计的不合理，获取了一个老师的账号即可查看到所有老师和学生的账号信息。\n\n通过此设计，弱口令暴破可以登录很多老师和学生账号。3、教学系统存在目录遍历漏洞，可以查看下载到一些敏感信息　　　http://27.22.85.54:18080/suite/images/　　　http://27.22.85.54:18080/suite/include/　　　http://27.22.85.54:18080/suite/bin/　　　http://27.22.85.54:18080/suite/download　　　http://27.22.85.54:18080/suite/bin　　　http://27.22.85.54:18080/suite/tools　　　http://27.22.85.54:18080/suite/wap     （通用型，仅以此站为例）      http://www.hceb.edu.cn:8080/suite/include/ 河南经贸学院的4、任意文件上传2处　　　登录到数字化学习中心后台，网盘里可直接上传jsp文件，上传没有进行严格的过滤；进入课程管理中心，编译器直接上传jsp文件\n\n   漏洞证明：  谷歌关键词：inurl:portal/portalView.doinurl:/suite/login.do\n\n仅以襄阳职业技术学院为例，通过登录一名普通教师的账号，即可拿到getshell。\n\n   修复方案：  你们懂的·   版权声明：转载请注明来源 爱上襄阳@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-05-25 09:11 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-28 20:12 |    \t\t小懒虫 \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:37        )\t\t \n  哇，想不到挖出来的洞洞可以20rank，会有钱不？    \n     2014-05-29 00:55 |    \t\t爱上襄阳 \t\t\t( 普通白帽子  |\t\t\t        Rank:345 漏洞数:86        | ...)\t\t \n  乌云就给了4RANK好不好···    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}