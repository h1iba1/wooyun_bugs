{"id": 7576, "wybug_id": "wooyun-2013-041105", "wybug_title": "大公司诟病系列#1 重置京东任意用户密码", "wybug_corp": "京东商城", "wybug_author": "猪猪侠", "wybug_date": "2013-10-26 19:46", "wybug_open_date": "2013-12-10 19:47", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "逻辑错误", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-10：\t细节向公众公开  简要描述： 本系列将介绍一些大公司常有的诟病，随处可见的安全隐患，任意一个小问题都能引发企业安全的崩盘。由于大多数应用系统自身的业务特性，会开放许多接口用于处理数据，如果接口或功能未进行严谨的安全控制或判断，将会促进骇客加快攻击应用程序的过程，大大降低了骇客发现威胁的人力成本。同时随着模块化的自动化攻击工具包越来越趋向完善，将给应用、业务系统带来最大的威胁。本报告内涉及的安全隐患，足矣间接导致京东商城遭受脱裤风险，介于安全测试，未深入研究！ 详细说明：  #1 描述2011年，互联网泄密事件引爆了整个信息安全界，导致传统的用户+密码认证的方式已无法满足现有安全需求。泄露数据包括：天涯：31,758,468条，CSDN：6,428,559条，微博：4,442,915条，人人网：4,445,047条，猫扑：2,644,726条，178：9,072,819条，嘟嘟牛：13,891,418条，7K7K：18,282,404条，共1.2亿条。同时，搜索引擎越来越多的收录了企业的相关信息；#2 风险描述通过theharvester工具，和baidu.com、google.com搜索引擎，收集所有关于京东商城的员工信息。得到如下京东商城员工列表信息：\n360buy@360buy.comasd@360buy.com\n\nmask 区域\n\n*****0buy.**********360bu**********@360b**********@360bu**********360bu**********360bu**********60buy**********@360bu**********60buy**********@360b**********360buy**********@360b**********@360b**********360bu**********360bu**********ang@36**********e@360b**********360bu**********60buy**********@360bu**********g@360b**********360buy**********ng@360**********@360bu**********0buy.**********60buy**********0buy**********@360b**********360bu**********@360b**********60bu**********60buy**********360buy**********360buy**********60buy**********@360bu**********g@360b**********60buy**********360buy**********@360b**********ang@36**********@360bu**********@360bu**********360bu**********@360bu**********360buy**********360buy**********0buy.**********60buy**********360buy**********@360b**********@360b**********360buy**********0buy**********60bu**********n@360b**********60buy**********60bu**********360buy**********n@360b**********0buy.**********60buy**********360bu**********60buy**********0buy.**********@360bu**********360bu**********360bu**********g@360b**********60buy**********360buy**********@360b**********60bu**********360buy**********360buy**********60bu**********@360bu**********360buy**********@360bu**********360bu**********360buy**********@360bu**********60buy**********360buy**********g@360b**********@360bu**********360buy**********0buy.**********360buy**********@360bu**********0buy.**********360bu**********360bu**********60buy**********60buy**********0buy.**********@360b**********@360b**********360buy**********360bu**********60bu**********@360b**********0buy**********60buy**********0buy.**********0buy.**********360bu**********0buy.**********360buy**********360bu**********@360bu**********60buy**********@360bu**********@360b**********@360bu**********60bu**********@360b**********@360b**********360buy**********360buy**********360buy**********@360b**********@360b**********@360bu**********@360b**********60buy**********60buy**********360bu**********@360bu**********@360b**********@360b**********360bu**********360buy**********0buy**********@360b**********360bu**********0buy**********@360b**********360bu**********@360b**********60bu**********360bu**********@360b**********@360b**********360buy**********60buy**********@360b**********360buy**********@360b**********60bu**********60buy**********360bu**********60buy**********@360bu**********0buy**********@360bu**********0buy.**********@360bu**********360bu**********@360b**********360bu**********i@360b**********360buy**********360buy**********360buy**********i@360b**********@360b**********60buy**********ng@360**********360buy**********0buy.**********360buy**********60buy**********60bu**********360buy**********0buy.**********360bu**********360buy**********360buy**********@360b**********360bu**********@360bu**********360buy**********360bu**********@360b**********@360bu**********360bu**********60buy**********@360bu**********360buy**********@360b**********360bu**********@360b**********360bu**********@360b**********g@360b**********60buy**********@360bu**********360buy**********@360bu**********@360b**********@360bu**********nfo@36**********360buy**********@360b**********0buy.**********360buy**********0buy.**********60buy**********0buy.**********@360b**********0buy**********0buy**********360buy**********@360bu**********360buy**********n@360b**********jie@360**********@360b**********60buy**********360buy**********60buy**********360buy**********0buy.**********@360b**********360bu**********@360bu**********@360b**********@360b**********60bu**********360bu**********@360b**********buy.**********360bu**********360bu**********g@360b**********g@360b**********60buy**********360buy**********360buy**********60buy**********buy.**********@360b**********@360bu**********360buy**********@360bu**********60bu**********60bu**********@360bu**********@360b**********uy.c**********360buy**********@360b**********360bu**********360bu**********0buy**********60buy**********360buy**********@360b**********@360b**********@360b**********n@360b**********g@360b**********o@360b**********@360b**********@360bu**********@360b**********@360bu**********ng@360**********360bu**********@360bu**********@360bu**********ng@360**********n@360b**********60buy**********g@360b**********@360bu**********g@360b**********@360b**********an@360**********360buy**********360buy**********360buy**********360buy**********360buy**********360buy**********60buy**********@360b**********u@360b**********u@360b**********@360b**********g@360b**********ang@36**********360buy**********@360bu**********60buy**********60buy**********@360b**********@360b**********@360bu**********g@360b**********@360bu**********360buy**********360bu**********60bu**********037@360**********11@360**********@360b**********60bu**********@360b**********@360b**********60buy**********360bu**********ech*****\n\n\n\n360buy.com\n#3 找到可用的登陆接口验证口令https://mail.jd.com/owa/auth/logon.aspx京东的邮件服务使用了微软的Microsoft Exchange套件，无验证码限制，直接FUZZ。#4 FUZZ规则建立大公司人员的习惯研究，公司做得越来越大的时候，总会出现那么几个安全意识薄弱的人员（俗称猪一样的队友），他们往往会做出一些让人无法理解的事情，比如：直接点击邮件内的 EXE 附件，或者使用和用户名一样的密码，或者用户名+当前年份的密码。我构建的密码规则：\n%username% = 用户名%domain% = 公司域名%username%%domain%%username%1%username%12%username%123%username%1234%username%12345%username%123456%username%@123%username%@123.com%username%@163%username%@163.com%username%163%username%8%username%88%username%888%username%999%username%666%username%2008%username%2009%username%2010%username%2011%username%2012%username%2013%username%@2008%username%@2009%username%@2010%username%@2011%username%@2012%username%@2013%username%!@#\n#5 成功Fuzz出某个用户的密码，再结合Exchange的通讯录功能，导出所有用户名列表! 京东原CFO，首席财务官\n\n! 若干人员\n\n推荐一个自动导出所有Exchange联系人的工具：Exchange-Spigothttp://exchangespigot.codeplex.com/\n\n#6 是的，现阶段，你已经拥有了所以京东员工的联系信息列表重复使用#4提到的FUZZ规则，弱口令用户一堆一堆的，然后你就可以进入那些人的邮箱里面找猛料了，这里只是测试，没办法提供相关结果信息。测试后回显成功找到了2865名员工的密码，均为弱口令！   漏洞证明：  #7 漏洞证明,找到你们的安全部门、数据库部门\n\n\n\n#8 整理获取到的信息间接进行测试，最终证明可重置京东任意用户密码http://safe.jd.com/findPwd/index.action，填入用户的邮箱，系统将会使用customer_service@jd.com用户发送重置密码链接，去邮件服务器搜索到就行了。\n\n\n\n   修复方案：  #1 安全意识培训到每个人#2 加入TOKEN校验机制，或者验证码#3 第三条，你们在互联网上表现得比谁都专业，自己想办法吧   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-10-30 13:55 厂商回复： 逻辑很清晰，感谢支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-26 19:52 |    \t\tNicky \t\t\t( 普通白帽子  |\t\t\t        Rank:477 漏洞数:69        | http://www.droidsec.cn 安卓安全中文站)\t\t \n  火前留名    \n     2013-10-26 19:53 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  写这个系列准备了至少3个月时间才把逻辑凑齐。    \n     2013-10-26 19:54 |    \t\tccc008 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:4        | ccc008)\t\t \n  @猪猪侠 京东已报平平安安，楼主请收好水表    \n     2013-10-26 19:57 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  前排出售TT，火前留名    \n     2013-10-26 20:03 |    \t\t天朝城管 \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:35        | 不要等到命玩你的时候才开始玩命)\t\t \n  本系列将介绍一些大公司常有的诟病，随处可见的安全隐患    \n     2013-10-26 20:04 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @猪猪侠 3个月前的逻辑现在你好记得啊？！    \n     2013-10-26 20:06 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  如果是通用问题应该修复后预警    \n     2013-10-26 20:15 |    \t\tX防部 \t\t\t( 普通白帽子  |\t\t\t        Rank:487 漏洞数:137        )\t\t \n  哈哈哈  让我们最后再看一眼洞主吧！再见吧朋友 啊再见吧朋友 啊再见吧 再见吧 再见吧！    \n     2013-10-26 20:20 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  让我再看你一眼 是否还会有感觉    \n     2013-10-26 20:56 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  真给力    \n     2013-10-26 21:04 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @猪猪侠 憋了这么久，难为你了！    \n     2013-10-26 21:06 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  不会会投诉洞主呢 ？？    \n     2013-10-26 21:14 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @猪猪侠 很给力  昨天我还跟狗哥他们说此处是一个特别脆弱的点呢    \n     2013-10-26 21:34 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  果然闪电了，猪哥出品，必属经典！    \n     2013-10-26 21:59 |    \t\tinsight-labs  \t\t\t( 普通白帽子  |\t\t\t        Rank:623 漏洞数:75        | Security guys)\t\t \n  又是wordpress么？    \n     2013-10-26 22:05 |    \t\t好人 \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:6        | 多少人曾爱慕你年轻的容颜)\t\t \n  马克    \n     2013-10-26 22:10 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  要火    \n     2013-10-26 22:12 |    \t\tSpid3r \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:10        | 常年撒网打鱼.)\t\t \n  必火    \n     2013-10-26 22:13 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  吊炸天    \n     2013-10-26 22:16 |    \t\txxw \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:18        | 中国梦)\t\t \n  mark    \n     2013-10-26 22:19 |    \t\t好人 \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:6        | 多少人曾爱慕你年轻的容颜)\t\t \n  吹过的牛逼要兑现   WooYun: WEIPHONE威锋网任意用户密码修改 直探700万用户数据    \n     2013-10-26 22:39 |    \t\t0x0F \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:60        | 尖刀安全 (JDSec.Com).......................)\t\t \n  二哥要换人了乌云要变天了    \n     2013-10-26 23:43 |    \t\t猪是念着倒V \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:8        | 世间没有大牛这样的称号，只有逐渐走向大牛...)\t\t \n  Mark坐等厂商回复.    \n     2013-10-26 23:47 |    \t\tbig、face \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:36        | |上天请赐我一个洞|想要一件乌云衣服|)\t\t \n  猪哥逻辑帝！    \n     2013-10-27 00:17 |    \t\tTang \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:5        | 忙碌状态)\t\t \n  mark    \n     2013-10-27 01:19 |    \t\tjadore \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:6        | .....)\t\t \n  目测是120秒内爆破，因为这段时间内的尝试次数没做处理。这个貌似我一个月前就给我基友提过了    \n     2013-10-27 01:31 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  这是要火啊    \n     2013-10-27 08:35 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  要火的节奏。。。    \n     2013-10-27 13:29 |    \t\tB1acken \t\t\t( 普通白帽子  |\t\t\t        Rank:174 漏洞数:56        | 渣渣)\t\t \n  又是连续剧    \n     2013-10-27 13:30 |    \t\twangbing86 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 慢慢学习路)\t\t \n  又是系列啊    \n     2013-10-27 13:58 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  系列的节奏啊    \n     2013-10-27 14:52 |    \t\t啦绯哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:107 漏洞数:20        )\t\t \n  估计低分或忽略，大公司\"挨踢\"很要面子的，还特别喜欢抢公关的工作...    \n     2013-10-27 15:12 |    \t\t雷锋小号 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 乌云现在就缺我这种默默顶贴从来不求脸熟的...)\t\t \n  洞主，您的水表。请收好    \n     2013-10-27 16:13 |    \t\tGrayTrack \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:14        | 灰色轨迹)\t\t \n  mark    \n     2013-10-27 16:59 |    \t\tJumbo \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:29        | 猫 - http://www.chinabaiker.com)\t\t \n  本报告内涉及的安全隐患，足矣间接导致京东商城遭受脱裤风险，介于安全测试，未深入研究！    \n     2013-10-27 18:16 |    \t\tprint_0x0000 \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:22        | 一枚苦逼的农民工.)\t\t \n  mark~    \n     2013-10-27 18:19 |    \t\tHuc-Unis \t\t\t( 普通白帽子  |\t\t\t        Rank:1055 漏洞数:292        | 诶，现在通用奖励越来越低了；离买保时捷卡...)\t\t \n  @猪猪侠 开门！送快递！    \n     2013-10-27 19:17 |    \t\t艾特绅 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 愿意为网络安全做出我的贡献)\t\t \n  看连续剧咯    \n     2013-10-27 21:19 |    \t\tqueen787 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 哇咔咔~~小菜菜)\t\t \n  最爱 未完待续~~    \n     2013-10-28 15:58 |    \t\tMr.Jen \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:2        | 开放自由)\t\t \n  水表    \n     2013-10-28 15:59 |    \t\tHonker红颜 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:51        | 皖南人士,90后宅男,自学成才,天朝教育失败....)\t\t \n  前几天我接到消息，有人再卖京东最新的订单数据库呢    \n     2013-10-28 16:02 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @Honker红颜 真假呀？    \n     2013-10-28 16:04 |    \t\tHonker红颜 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:51        | 皖南人士,90后宅男,自学成才,天朝教育失败....)\t\t \n  @Coody 真的，一个台湾的人在收，看到他刷群，我问他的时候他说前几天已经收了2万多块钱的数据额    \n     2013-10-30 18:53 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  二哥好    \n     2013-10-30 19:06 |    \t\tHuGtion \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:10        | 学习安全技术。)\t\t \n  @猪猪侠 二哥好    \n     2013-11-15 09:21 |    \t\t 飞鞋拍小强 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 小强)\t\t \n  一哥了    \n     2013-11-20 10:46 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  京东给20给力    \n     2013-11-27 09:22 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  确实值40    \n     2013-12-01 21:32 |    \t\tACGT \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:4        | another script kiddie)\t\t \n  竟然没拿下域控。。    \n     2013-12-02 09:57 |    \t\twinsyk \t\t\t( 普通白帽子  |\t\t\t        Rank:108 漏洞数:16        | 越长大越孤单)\t\t \n  @ACGT 看下最后一张图。    \n     2013-12-02 10:31 |    \t\tif、so  \t\t\t( 核心白帽子 |\t\t\t        Rank:1008 漏洞数:91        | 梦想还是要有的，万一实现了呢？)\t\t \n  @猪猪侠 ，请问fuzz Exchange会不会把域用户账户锁住了，有时候域策略会限制密码错误次数的    \n     2013-12-10 20:30 |    \t\t炯炯虾 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我来自地球)\t\t \n  京东的邮箱系统竟然没密保。。。。  邮箱里竟然存那么多密码    \n     2013-12-11 02:17 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  修复方案的#3 意思很多啊    \n     2013-12-11 09:43 |    \t\t正好五个字 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:15        )\t\t \n  俗称猪一样的队友。。。    \n     2013-12-11 16:14 |    \t\tcircus \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:4        | 你会为一件事去说一句话,也会为一句话去干...)\t\t \n  @if、so owa登录mail的方式应该是不会限制密码错误次数的。    \n     2013-12-12 16:55 |    \t\trivers \t\t\t( 实习白帽子  |\t\t\t        Rank:85 漏洞数:10        | research on web security)\t\t \n  侏罗纪果然犀利，点个赞    \n     2013-12-13 14:15 |    \t\t笑看天下 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:10        )\t\t \n  @jadore 请问下那个邮箱FUZZ测试是真没爆破的呢？用的什么工具 求解    \n     2013-12-13 14:16 |    \t\t笑看天下 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:10        )\t\t \n  @jadore 怎么爆破的呢？请问下    \n     2013-12-26 17:36 |    \t\t廷廷 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 有很强的好奇心，爱好广泛，求女女带走。。...)\t\t \n  太厉害了！！！膜拜！    \n     2015-01-02 18:51 |    \t\tPower \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:22        | 还需要等待.........)\t\t \n  膜拜    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}