{"id": 26938, "wybug_id": "wooyun-2015-0127301", "wybug_title": "永和大王上海店61万用户订单泄露", "wybug_corp": "永和大王", "wybug_author": "wps2015", "wybug_date": "2015-07-17 21:27", "wybug_open_date": "2015-09-06 00:00", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向公众公开  简要描述： 听说永和大王有回锅油条，是不是比回锅肉还好吃呢。。 详细说明：  问题出在：http://www.4000979797.com/yhkonline/index.jsp?lang=zh_CN这里先要选择城市，这里先选择上海，在订单查询处http://e.4000979797.com/Order/OrderQuery先注册一个账号： blkdflkfd@126.com  admin123  (希望能把邮箱打个码，谢谢。。)这里我先下了一个订单\n\n点击详情http://e.4000979797.com/Order/OrderDetail?orderCodeOnline=611724  (无需登录)\n\n发现目前的订单号为611724随意更改100-611724之间的订单号\n\n\n\n\n\n然后又想去切换一下城市，发现切换后账号失效，这里再去北京注册一个账号，用同样的方法注册一个账号，得到如下url\nhttp://www.4000979797.com/yhkonline/yhkonline/order/orderItem.jsp?key=cfb1b7787d57ae2036132d7c23cca21a7daf373f1f315f89e9c6aaa06c85057805e60a31f1f56f5364929ee23fd5b09f8d046b4c3f&orderCodeOnline=4370996755\n发现orderCodeOnline也可以遍历，但是订单号不连续，所以无法判断出泄露多少订单\n\n还有南京，深圳等城市，我就不去一一尝试了，估计也有问题。。   漏洞证明：  \n\n   修复方案：  验证权限   版权声明：转载请注明来源 wps2015@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-07-21 09:29 厂商回复： CNVD确认所述漏洞情况，暂未建立与网站管理单位的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}