{"id": 88021, "wybug_id": "wooyun-2016-0206592", "wybug_title": "艺龙某系统逻辑错误导致可以修改任意用户密码(查询账号信息等)                                      ", "wybug_corp": "艺龙旅行网", "wybug_author": "Angoddess", "wybug_date": "2016-05-09 12:23", "wybug_open_date": "2016-06-23 14:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-23：\t细节向公众公开  简要描述： 逻辑错误，设计缺陷 详细说明：  http://ebooking.elong.com/ebkauth/forgotpwd\n\n输入任意用户名，拦截数据包\n\n经测试，验证码可重复利用，根据返回数据包可判断用户是否存在获取到大量用户名，包括管理员用户adminadmin1yangjiezhouminyangminzhangxiufangyangmeilixiumeilimeizhangfengyingzhangweiliuhuanlixiangwangliliwangtingyangxueyangliuliweiwangyangzhangchunmeiliyingliyingzhangruiwanglonglifenghuangminlijianhualiyangliyangliyangliubingwanglulilinlilinliqinwangchaozhangbinzhangfeichenhaoyangweiliuxiawangrongliujingwangtaowangjianhuazhangxiumeiwangdongzhangnaliumeiwangguixiangwangjuanzhangxiulanwangqinzhangyingzhangyingzhangyingzhoulizhangningyanglingchenchenyangbochenlinchenlinyangyangyangyanglixuewangyuwanghaozhangjianzhangjianwangweiliuqinlixinlixinchenyinglichaoliqianyangfangchenqiangwangqiangwangxuzhangfenglitingwanglihuaxuweiyangjuanwangzhiqiangliuchangzhangbozhangboyangjunliutaolihaozhanghongmeiwanggangzhoujiechenfangchenyongyangpinglileizhangxiuyingchenjunchenjunchenbolixiuyunzhaominzhangpengsunweiyangfanliqiangzhangxuwangdanchenleiliujianjunliuliliulichenfeiyangmingchenmingzhanghuizhanghuiwangminliunalijinglijingliuchaozhangjunzhangjunlixiufangchenxinliuyunlihaiyanwangpengwangshuyinglipenglijianlijianzhangliangzhangxiurongchenjiechenjieyangliliukaiwangpingwangpingwangpinglidongmeiliuhaozhangqiangliubinlitaozhoujingwangxinwangxinlifangwangchengzhanghaoyanghongyanglinliuxinliufeiwanghuanwangyingwangyingwangyingwangjingwangjinglixiuzhenzhaoyongchenlonglifeiwangjunwangjunwangyonggaofengchenganglihuilihuichenlingzhouyongliyanliyanliyanzhanglizhanglizhanglichenmeiliwenliulingliuqiangzhaoweizhangleizhangleilihongmeiliudanzhangqinhuangyongzhangxinliuhongzhangjianguowangjiewangbinwangbinwangjianwangjianlijialilongliuhuiliuhuilixiuyingliubolichunmeiliuyanliuyanhuangweiliujunliujunliyunchenxiuyingzhangjingzhangjinglijianjunlibingwangfangliuweiwangliliminzhangyonglijielijunlixialiujieliufanglipinglilinglidanlipingchenweilihongzhanglinglibinzhangyuwangkaiwangbowanglizhangjuanwangxuewanghuachentaowangnazhangtingchenhongzhanglinliyumeiwangmeiwangqianzhaojingchenchaochenliangyanghuazhanglongwangruichenhuiliutingliumingzhanghaiyanyangleichenyunzhangyulijiewangbolibinliufenglixiuhualiuyuhuazhaolizhanglinzhangxiuhuazhaojunyangbinzhangnanliuyuwanglizhangfanzhangyuxujingzhangwen利用任意存在用户名（这里使用yangjie做测试），修改返回数据包中的手机号码，我改成我自己的号码了\n\n然后选择获取验证码\n\n这里要说一下，截取获取验证码的数据包可以看到，直接含手机号，估计只要修改这里的手机号就可以了，而且这里的号码直接显示我的号码，应该是从页面获取来的\n\n验证码直接发到我手机了，然后就进入密码重置页面了，直接输入新密码修改成功（密码改为wooyun123）\n\n就只测试了这个账号，其他账号木有改动（审核大大辛苦了，求帮忙打码）   漏洞证明：  \n\n   修复方案：  逻辑呀逻辑，罪过罪过发送手机验证码的手机号就不要从客户端页面获取啦！求好评！   版权声明：转载请注明来源 Angoddess@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2016-05-09 14:01 厂商回复： 感谢白帽子！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-05-09 12:38 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这个屌的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}