{"id": 88798, "wybug_id": "wooyun-2016-0215221", "wybug_title": "微博一个some攻击的漏洞/只需点我的链接就可实现关注我等操作                                      ", "wybug_corp": "新浪微博", "wybug_author": "呆子不开口", "wybug_date": "2016-06-01 20:20", "wybug_open_date": "2016-07-18 16:40", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-06-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-06-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-06-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-07-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-18：\t细节向公众公开  简要描述： 微博一个some攻击的漏洞，只需点我的链接就可实现关注我等操作。漏洞资料可参考 http://www.benhayak.com/2015/06/same-origin-method-execution-some.html。我的例子在chrome下只要访问我的页面就中招，不用再点一次去绕过chrome的popup blocker 详细说明：  微博一个some攻击的漏洞，只需点我的链接就可实现关注我微博账号等操作漏洞资料可参考 http://www.benhayak.com/2015/06/same-origin-method-execution-some.html。我的例子在chrome下只要访问我的页面就中招，不用再点一次去绕过chrome的popup blocker漏洞的url为http://weibo.com/ajaxlogin.php?framelogin=1&callback=window.opener.methodcallback参数虽然做了很多非法字符的限制，无法形成xss漏洞。但可以自定义字母和点符号所以我可以使用同源方法调用的方式来执行Weibo.com域页面里的敏感操作，比如实现用户的关注按钮的点击 所以先打开一个页面，这是我的微博页面Ahttp://weibo.com/277634777再打开我们的漏洞页面Bhttp://weibo.com/ajaxlogin.php?framelogin=1&callback=window.opener.document.body.firstElementChild.firstElementChild.firstElementChild.nextElementSibling.firstElementChild.firstElementChild.firstElementChild.firstElementChild.firstElementChild.firstElementChild.nextElementSibling.firstElementChild.nextElementSibling.nextElementSibling.nextElementSibling.firstElementChild.firstElementChild.firstElementChild.click微博的登陆用户访问我构造的页面的话，就相当于利用页面B去点击了页面A中的关注按钮。就实现了对我的关注我的例子在chrome下只要访问我的页面就中招，不用再点一次去绕过chrome的popup blocker具体实现方式这里就先不写了……可以见下面视频，在我访问了那个链接后，我就关注了一个陌生网友   漏洞证明：     修复方案：  做些白名单限制，或者写死函数   版权声明：转载请注明来源 呆子不开口@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-06-03 16:38 厂商回复： 感谢关注新浪安全，问题修复中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-06-01 20:22 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:415 漏洞数:99        | 别摸我，我怕热……  |  Tr3jer@Gmail.com ...)\t\t \n  刚在微博上看到    \n     2016-06-01 20:26 |    \t\t山鹰 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:28        | 拒绝搞基，啊哈)\t\t \n  前排膜拜呆子大牛，我要听段子    \n     2016-06-01 21:08 |    \t\t田老板 \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:14        | 学校杀手)\t\t \n  快发给我   我要点    \n     2016-06-01 21:12 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:259 漏洞数:96        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  对方不想跟你说话并丢了一个链接给你。    \n     2016-06-01 21:27 |    \t\t大师兄 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:8        | 记不清多久没撸站了......但每日必关注乌云)\t\t \n  6    \n     2016-06-01 22:01 |    \t\tniexinming \t\t\t( 普通白帽子  |\t\t\t        Rank:335 漏洞数:55        | 好好学习，天天日站)\t\t \n  http://blog.safedog.cn/?p=13这个讲的很不错    \n     2016-06-01 22:03 |    \t\tGo7hic \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        )\t\t \n  伟哥艹我    \n     2016-06-01 22:29 |    \t\t偶然 \t\t\t( 普通白帽子  |\t\t\t        Rank:609 漏洞数:142        | 我是天空里一片云。)\t\t \n  难道这次不是点我就上了我吗？    \n     2016-06-01 22:41 |    \t\tdiguoji \t\t\t( 普通白帽子  |\t\t\t        Rank:505 漏洞数:122        | 中国吉林长春,高考230分,现在家里务农。☯...)\t\t \n  一言不合就发链接    \n     2016-06-02 00:34 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:408 漏洞数:36        | 求各种兼职)\t\t \n  @niexinming 国内翻译的有点问题，光jsonp接口是不可以的    \n     2016-06-02 00:47 |    \t\t孤梦° \t\t\t( 普通白帽子  |\t\t\t        Rank:151 漏洞数:52        )\t\t \n  对方不想跟你说话并丢了一个链接给你。    \n     2016-06-02 09:15 |    \t\t安全狗(乌云厂商)\t\t \n  @呆子不开口 补充：之前翻译实践的时候，有个点没有说清楚，也就是同源下的一个callback函数名可控的同时，还要求callback函数能被JavaScript执行（比如在script标签中或者在flash中能被执行）。  23333333333333333    \n     2016-06-02 09:38 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:408 漏洞数:36        | 求各种兼职)\t\t \n  @安全狗 赞    \n     2016-06-02 09:47 |    \t\tloli  \t\t\t( 普通白帽子  |\t\t\t        Rank:649 漏洞数:59        | 每个男人心中都住着一个叫小红的88号技师。)\t\t \n  一言不合就发链接    \n     2016-06-02 10:35 |    \t\tniexinming \t\t\t( 普通白帽子  |\t\t\t        Rank:335 漏洞数:55        | 好好学习，天天日站)\t\t \n  @安全狗 赞    \n     2016-06-02 11:25 |    \t\t安全狗(乌云厂商)\t\t \n  @niexinming 没想到还真有人去看我们的博客。哈哈哈    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}