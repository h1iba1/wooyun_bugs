{"id": 6901, "wybug_id": "wooyun-2014-046654", "wybug_title": "QQ电脑管家一处错误导致本地提权", "wybug_corp": "腾讯", "wybug_author": "yeless", "wybug_date": "2014-01-03 16:08", "wybug_open_date": "2014-01-07 09:37", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 安装腾讯电脑管家的机器可从任意普通用户获取系统权限，导致用户重要数据泄露。 详细说明：  话说这个也是我无意间发现的一个权限提升漏洞。学校嘛，电脑老是给我们一个普通用户权限，网络都不给我们连，而且电脑的C盘是还原的。我们都是无比蛋疼，不过上有政策，下有对策嘛。。一天我去机房上机，还是像往常一样提权，然后上网。突然发现提权失败了，然后检查了一下，发现重做系统了，以前的那个提权漏洞不存在了,然后就找啊找，没发现什么，就是每台电脑上都装有qq电脑管家。因为以前用shift后门用习惯了，还是像以前一样，想到了shift后门。不过普通用户肯定是无法替换sethc.exe的，如图\n\n然后我又尝试先删除sethc.exe，跟想象的一样，没权限删除system32文件夹下的任何东西。\n\n然后我想怎么才能删除sethc.exe呢，。然后一想，普通用户是不能安装安全软件的，比如QQ电脑管家，没有管理员权限是安装不了的。那学校的机房管理人员肯定是通过管理员权限安装电脑管家的。然后我就想能不能借助电脑管家的权限去删除sethc.exe呢。然后我就想能不能自定义添加病毒路径，让电脑管家把sethc.exe给查杀了，。事实证明真没这功能，然后就想其他办法吧，。然后就让我想到了文件粉碎功能。因为要查杀病毒或者粉碎文件时需要较高权限的，而且安装电脑管家只能是管理员权限安装，我认为肯定是安装的时候就给电脑管家授权了管理员权限了。如果不授权那么普通用户用电脑管家有病毒的时候也只能看看了，是没有权限查杀的，那显然是不合理的。利用这一点，如图。\n\n\n\n然后电脑管家会提示删除成功。接着就可以替换sethc.exe了。。\n\n至此提权结束了。   漏洞证明：  然后就是提权的过程了，替换了sethc.exe之后就简单了。\n\n\n\n至此。。。   修复方案：  根据用户组合理分配权限！   版权声明：转载请注明来源 yeless@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-01-07 09:37 厂商回复： 非常感谢您的报告。这个问题我们经过评估，暂未发现可以对用户或者业务产生影响，故不作处理。如果您有任何的疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}