{"id": 61990, "wybug_id": "wooyun-2013-037275", "wybug_title": "百度百科奇葩的设计缺陷权限绕过(获取VIP部分特权)", "wybug_corp": "百度", "wybug_author": "bing", "wybug_date": "2013-09-16 10:52", "wybug_open_date": "2013-10-31 10:52", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "2", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-31：\t细节向公众公开  简要描述： 绕过啊绕过 详细说明：     发现百科中，对于弱势用户，头像很单调没得换啊，这么多好看的头像只有高端核心用户才能拥有~随后就试出该奇葩漏洞。我先来分析下原因，不对的话可以骂我，但不准打脸~   首先我们可以看到post包中其中主要参数为params，参数内容为avatar=2，并且也确实存在权限上的判断，如果权限不足的话会提示errNotVip，但是当添加特殊字符\"',等，返回成功~所以过程我认为是，首先服务端在接收2'并没有对特殊字符过滤，服务端判断2'是不是为vip角色拥有，如果不是，在通过更新头像之前对字符2'中存在的特殊字符进行了过滤，然后设置成。POST /user/ajax/setting HTTP/1.1Host: baike.baidu.comProxy-Connection: keep-aliveContent-Length: 36Origin: http://baike.baidu.comUser-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/535.12 (KHTML, like Gecko) Maxthon/3.0 Chrome/26.0.1410.43 Safari/535.12X-Requested-With: XMLHttpRequestContent-Type: application/x-www-form-urlencodedAccept: */*DNT: 1Referer: http://baike.baidu.com/uc/usercardAccept-Encoding: gzip,deflateAccept-Language: zh-CNAccept-Charset: GBK,utf-8;q=0.7,*;q=0.3Cookie: [马赛克]action=setAvatar&params=avatar%3D2'   漏洞证明：  可以看到下面头像为核心vip用户才能使用的~http://www.baidu.com/p/勤奋的bing?from=wk\n\n   修复方案：  你懂   版权声明：转载请注明来源 bing@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2013-09-16 18:46 厂商回复： 感谢对百度安全的关注，我们马上处理此问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}