{"id": 20535, "wybug_id": "wooyun-2012-05283", "wybug_title": "QQ辅助好友申述被滥用可导致指定用户QQ被盗（无需知道用户密码）", "wybug_corp": "腾讯", "wybug_author": "路人甲", "wybug_date": "2012-03-15 18:08", "wybug_open_date": "2012-04-29 18:09", "wybug_type": "账户体系控制不严", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-03-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-03-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-03-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-04-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-04-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-04-29：\t细节向公众公开  简要描述： QQ辅助好友申述被滥用可导致指定用户QQ被盗，黑客甚至无需知道该用户的密码。相关的详细信息在：http://www.91ri.org/2939.html要注意的是，好友申述中需要利用的“好友”不一定需要通过好友克隆进行，还有其它途径获取。 详细说明：  方法一（即链接中描述的方法）：（1）黑客用帐号A加受害者QQ号，受害者通过了；（2）黑客通过克隆帐号A，到几个小号（B/C/D/E..），这几个小号因为克隆的关系会向受害者QQ发送为好友的请求，好友通过；（3）黑客此时去申述受害者QQ号，证据为这几个QQ（A/B/C/D/E...）都是受害者QQ号的好友，此时得到申述回执。（4）黑客轮番使用这几个QQ（A/B/C/D/E...）打开辅助好友申述页，填写申述回执和相关信息，并提交（5）过几个小时后，申述成功。此方法适合批量。方法二：（1）黑客通过社工，将受害者QQ号的好友列表获取出来。最简单的方法是引诱受害者QQ号码批量转发嵌套了N多层的邮件，这些邮件转发后天然含有该QQ号的好友列表。（2）黑客利用这些好友列表，获取能够临时会话的受害者QQ的好友用户，开始进行初步社工。（3）黑客此时去申述受害者QQ号，证据中加入以上正在社工的好友，此时得到申述回执。（4）黑客继续社工，引诱受害者QQ的好友自愿填写申述回执和相关信息，并提交（5）过几个小时后，申述成功。此方法不适合批量，但更难防御，因为你可以拒绝他人加你为好友，但难以拒绝他人社工你好友。   漏洞证明：  \n\n   修复方案：  我也想知道......看某人回答也是个老大难问题：http://weibo.com/2006464163/ya0qfm8Sn   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2012-03-15 20:00 厂商回复： thx 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-03-15 18:33 |    \t\tdoosit \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:4        | 木有介绍。)\t\t \n  这个我今天看了，可以增加被克隆的验证。    \n     2012-03-15 21:10 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @腾讯 忘了讲，克隆确实是个大问题，很容易绕过添加好友的诸多限制，也令这个漏洞更易批量化利用。所以原文提及的改善克隆机制使之不易被恶用这个方向是对的。至于社工问题，仍需其它机制配合。    \n     2012-03-16 15:10 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @horseluke 之前尝试过社工加申诉，那时候还没二代密保，找到无保的5-6位的，不是很难；所以，这个申诉真心是个双刃剑    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}