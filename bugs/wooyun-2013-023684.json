{"id": 10827, "wybug_id": "wooyun-2013-023684", "wybug_title": "phpcms_v9.3.2某管理模块逻辑校验漏洞", "wybug_corp": "phpcms", "wybug_author": "Code_Sec", "wybug_date": "2013-05-14 08:38", "wybug_open_date": "2013-08-09 08:39", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-19：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-07-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-09：\t细节向公众公开  简要描述： phpcms_v9某管理模块逻辑校验存在漏洞，可被绕过并非法使用。 详细说明：  在文件\\modules\\sms\\sms.php中：\nclass sms extends admin {\tfunction __construct() {\t\t$this->log_db = pc_base::load_model('sms_report_model');\t\t$this->module_db = pc_base::load_model('module_model');\t\t$this->member_db = pc_base::load_model('member_model');\t\t\t\t//获取短信平台配置信息\t\t$siteid = get_siteid();\t\t$this->sms_setting_arr = getcache('sms');\t\tif(!empty($this->sms_setting_arr[$siteid])) {\t\t\t$this->sms_setting = $this->sms_setting_arr[$siteid];\t\t} else {\t\t\t$this->sms_setting = array('userid'=>'', 'productid'=>'', 'sms_key'=>'');\t\t}\t\t\t\t//初始化smsapi\t\tpc_base::load_app_class('smsapi', '', 0);\t\t$this->smsapi = new smsapi($this->sms_setting['userid'], $this->sms_setting['productid'], $this->sms_setting['sms_key']);\t}\n类sms作为子类，类admin作为父类。而phpcms的后台功能权限校验是放在父类admin的构造函数中，但是子类sms在继承父类admin后，在sms的构造函数function __construct()中并没有调用父类的构造函数，即sms该类的没有任何权限校验。导致可以直接使用该模块的管理功能。与其他模块\\modules\\tag\\search_admin.php对比：\nclass search_admin extends admin {\tfunction __construct() {\t\tparent::__construct(); //父类admin的构造函数，有权限校验功能\t\t$this->siteid = $this->get_siteid();\t\t$this->db = pc_base::load_model('search_model');\t\t$this->module_db = pc_base::load_model('module_model');\t\t$this->type_db = pc_base::load_model('type_model');\t}\n对比sms类的构造函数中缺少了调用父类的构造函数parent::__construct(); 而phpcms的管理权限校验功能放在父类admin的构造函数中   漏洞证明：  构造数据POST，可以直接修改sms模块的配置信息localhost/index.php?m=sms&c=sms&a=setting   修复方案：  增加缺失的构造函数   版权声明：转载请注明来源 Code_Sec@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-08-09 08:39 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-09 09:09 |    \t\tsoftbug \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:10        | 为人类设计最好的软件，解放人的双手,一起...)\t\t \n  检查的狠细致    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}