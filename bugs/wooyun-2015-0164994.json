{"id": 76410, "wybug_id": "wooyun-2015-0164994", "wybug_title": "中国电信四川区部活动红包无限领取（现金）", "wybug_corp": "中国电信", "wybug_author": "komas", "wybug_date": "2015-12-28 13:18", "wybug_open_date": "2016-02-12 18:49", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-12：\t细节向公众公开  简要描述： 当朋友今天给我楼下有个中国电信有个活动能领取现金 当然我也是路过也看了眼http://c2c.sc.189.cn/wh/ 是成都武侯区光网进万家邀请朋友就能获取现金红包的活动，然后这个活动在青羊区的时候已经举办过一次了，这次来到武侯区，那么下次有可能还会继续活动到其它几个区举办。 详细说明：  http://**.**.**.**/wh/  先用自己的手机号注册成为一个主推广人http://**.**.**.**/wh/views/rewardQuery.jsp?flag=3&code=xxxxcode=xxxx就代表自己的推广ID号然后进入**.**.**.**/wh/?code=xxxx 就是自己的推广页面，然后输入朋友的手机号就会收到四位数字短信，点击领取第一次是10元，此后每邀请一个增加5元现金。    漏洞证明：   测试 \n\n 抓包\n\n分别是自己输入的手机号和验证码的base64加密{\"telephone\":\"xxxxxxxxxxxxx\",\"ranNum\":\"6112\",\"code\":\"000000\",\"key\":\"f3:46:xx:df:xx:06:f3:xx:57:dd:xx:xx:8c:xx:a3:xx\",\"os_type\":\"02\",\"terminal_type\":\"02\",\"timestamp\":\"1451121286248\"p把加密的验证码加入burp中intruder功能已知道是四位数那么写个循环<?phpfor($i=1;$i<9999;$i++){$x = '\"ranNum\":\"'.$i.'\"';echo base64_encode($x).\"<br>\";}?>生成的结果去除前999对加密的验证增加变量带入开始跑 毕竟四位数那么就会很快得到验证码然后进行解密得到红包可无限刷\n\n\n\n \n\n\n\n手机上的验证码也正是我们跑出来的验证码解密后的值然后小生又拿别人陌生人的号测试随便输入的号码\n\n   小量测试是可以成功领取的如果是多线程同时跑那么是可怕的 日入上万！！！   修复方案：     版权声明：转载请注明来源 komas@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-12-31 19:53 厂商回复： CNVD未直接复现所述情况,已经转由CNCERT向中国电信集团公司通报,由其后续协调网站管理部门处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}