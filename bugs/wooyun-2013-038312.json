{"id": 7196, "wybug_id": "wooyun-2013-038312", "wybug_title": "fluxbb存在PHP本地文件包含漏洞", "wybug_corp": "fluxbb", "wybug_author": "Code_Sec", "wybug_date": "2013-09-27 10:44", "wybug_open_date": "2013-12-26 10:44", "wybug_type": "文件包含", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件包含漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-27：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-12-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 很明显的本地包含 详细说明：  文件：install.php// If we've been passed a default language, use it$install_lang = isset($_REQUEST['install_lang']) ? pun_trim($_REQUEST['install_lang']) : 'English';// If such a language pack doesn't exist, or isn't up-to-date enough to translate this page, default to Englishif (!file_exists(PUN_ROOT.'lang/'.$install_lang.'/install.php'))\t$install_lang = 'English';require PUN_ROOT.'lang/'.$install_lang.'/install.php';if (file_exists(PUN_ROOT.'config.php')){\t// Check to see whether FluxBB is already installed\tinclude PUN_ROOT.'config.php';\t// If we have the 1.3-legacy constant defined, define the proper 1.4 constant so we don't get an incorrect \"need to install\" message\tif (defined('FORUM'))\t\tdefine('PUN', FORUM);\t// If PUN is defined, config.php is probably valid and thus the software is installed\tif (defined('PUN'))\t\texit($lang_install['Already installed']);很明显$install_lang存在本地文件包含漏洞，且安装完后该文件不会主动删除函数pun_trim：function pun_trim($str, $charlist = false){\treturn is_string($str) ? utf8_trim($str, $charlist) : '';}跟进utf8_trim：function utf8_trim( $str, $charlist=false){\tif($charlist === false)\t\treturn trim($str);\treturn utf8_ltrim(utf8_rtrim($str, $charlist), $charlist);}最终pun_trim($_REQUEST['install_lang'])变成：trim($_REQUEST['install_lang'])所以对于漏洞利用没啥影响   漏洞证明：  \n\n   修复方案：  最好不修复^_^   版权声明：转载请注明来源 Code_Sec@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-12-26 12:02 |    \t\tYwiSax \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:4        | 淡定。)\t\t \n  fluxbb和punbb都是类似这样的代码。不过install.php怎么传上去也是个问题。。。总之，mark一下。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}