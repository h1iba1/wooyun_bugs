{"id": 13992, "wybug_id": "wooyun-2013-018059", "wybug_title": "好乐买手机版再现用户密码重置漏洞", "wybug_corp": "好乐买", "wybug_author": "xfkxfk", "wybug_date": "2013-01-29 15:47", "wybug_open_date": "2013-03-15 15:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "手机短信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-29：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-03-15：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 手机版——好乐买：中国最大正品鞋购物网站。 详细说明：  1.是好乐买的手机版，进入手机版好乐买的账号登陆页面： \nhttp://www.okbuy.com/topic/show/521\n  当然我们这里不登陆，而是点击【忘记密码？】按钮，进入密码重置流程：\n\n2.注册过的用户都得用手机验证，才能用手机号进行密码找回，从提示也能看出来。  填写需要重置的账号，即验证的手机号码，由于只是测试漏洞存在，这里只用了我自己的账号：\n\n3.点击提交，此时已经给我的手机号发送了重置密码的短信验证码了。   漏洞证明：  4.查看手机收到的短信码为【38330】,我首先输入任意的5位纯数字短信码38331，点击提交，则返回如下错误，记得此时设置好浏览器代理：\n\n5.同时，看到的抓包请求为：\nPOST /member/getpwdok HTTP/1.1Host: m.okbuy.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:18.0) Gecko/20100101 Firefox/18.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://m.okbuy.com/member/getpwd?mobile=150********&sid=********21a761359440142~sjbjsy_1&ref_1=&ref_2=&ref_3=&httprefer=http://m.okbuy.com&ref_1=&ref_2=&ref_3=Cookie: OK_SES=1358728501246_74201451; ********; obsid=**********7g83ncmfkdojc9c4Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 109username=150********&code=§38331§&pwd=******&sid=********21a761359440142%7Esjbjsy_1&ref_1=&ref_2=&ref_3=&step=1\n上面的参数code=38331为短信码，而参数username=150********为手机号码。6.写了那么多，开始吧：设置好参数code为需要爆破的参数，开始暴力猜测，这里由于是测试我从37330开始：\n\n\n\n7.通过返回的字节数或者返回的内容得出正确的短信码：短信码错误时，返回的字节数为5947，而短信码正确时字节数为529,很明显啦！\n\n8.那么使用爆破完的短信码重置账号吧！\n\n9.成功重置密码：\n\n   修复方案：  1.这里5位纯数字短信码的爆破，即平均1万次的请求，我使用了burpsuite测试单台机器100线程，5分钟不到即可重置任意一个手机账号！危险啊2.短信码可以为5位纯数字；可以不设置图片验证码；甚至可以不用设置短信码的10分钟有效期。但是为什么不设置连续几次尝试失败就锁定本次密码重置的请求呢？3.求20rank，求礼物！   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-01-29 16:58 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  lz  要不要这么淫荡！    \n     2013-01-29 17:04 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @围剿 从何说起？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}