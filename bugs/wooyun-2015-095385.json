{"id": 38824, "wybug_id": "wooyun-2015-095385", "wybug_title": "爱丽网日志处存储型XSS（2）", "wybug_corp": "aili.com", "wybug_author": "我是小号", "wybug_date": "2015-02-04 14:22", "wybug_open_date": "2015-03-21 14:24", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-21：\t细节向公众公开  简要描述： 富文本跨站脚本过滤器缺陷 详细说明：  原理：XSS Filter过滤器对HTML 事件属性过滤不严编辑器里面提供的标签是<img>和<a>，<img>标签可以应用多个HTML事件属性的，之前报告过onload属性已经被加入了Filter如果使用Firebug向<img>标签插入这个Window 事件属性经过过滤会变成1，成功避免了xss攻击。\n\n可是<img>标签可以使用事件属性可不止onload哦经过测试以下事件属性并没有被Editor的XSS Filter过滤：\nMouse 事件   由鼠标或类似用户动作触发的事件onmousedown                             当元素上按下鼠标按钮时触发onmousemove                             当鼠标指针移动到元素上时触发 onmouseout                              当鼠标指针移出元素时触发onmouseover                             当鼠标指针移动到元素上时触发onmouseup                               当在元素上释放鼠标按钮时触发\n故利用这些事件属性仍然可以成功弹出窗口的E.g. 在编辑器页面Firebug编辑<img标签>插入\nonmouserover=\"alert(1)\"\n\n\n看来XSS Filter的过滤策略应该是对指定的事件进行了黑名单过滤，这可不是一种好办法哦   漏洞证明：  FireFox+IE11测试均弹出窗口\n\n\n\n   修复方案：  通过htmlparser可以解析出HTML代码的事件。在过滤符文本时，“事件”应该被严格禁止。   版权声明：转载请注明来源 我是小号@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-02-04 14:58 厂商回复： 感谢报告，希望继续支持爱丽 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}