{"id": 21048, "wybug_id": "wooyun-2012-05516", "wybug_title": "完美时空任意文件上传BUG", "wybug_corp": "完美时空", "wybug_author": "kobin97", "wybug_date": "2012-03-24 09:06", "wybug_open_date": "2012-03-24 16:16", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-03-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-03-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 完美时空任意文件上传，由于服务器设置限制，所以暂没办法想到利用，暂定为BUG 详细说明：  上传地址：http://event1.wanmei.com/jsp/playershow/upswf.jsp?siteid=8抓包改包上传。那可以上传任意文件类型文件。但由于服务器执行限制，文件不能执行。但想到了可以上传和执行 shtml 类型，再参考：http://www.htmer.com/article/730.htm可以通过 include：包含某些内容，记得在win环境下可以包含从以获取文件的内容，但在linux下是直接执行。但经测试，好像也是服务器有限制了，不能包含上级目录的文件。大家可以讨论下还有什么可以利用的。。。   漏洞证明：  POST /servlet/upload HTTP/1.1Accept: text/*Content-Type: multipart/form-data; boundary=----------Ij5GI3Ef1gL6ae0Ij5KM7Ij5Ij5cH2User-Agent: Shockwave FlashHost: event1.wanmei.comContent-Length: 440------------Ij5GI3Ef1gL6ae0Ij5KM7Ij5Ij5cH2Content-Disposition: form-data; name=\"Filename\"xxx------------Ij5GI3Ef1gL6ae0Ij5KM7Ij5Ij5cH2Content-Disposition: form-data; name=\"upload\"; filename=\"xx.shtml\"Content-Type: application/octet-stream<!--#echo var=\"SERVER_ADDR\" -->------------Ij5GI3Ef1gL6ae0Ij5KM7Ij5Ij5cH2Content-Disposition: form-data; name=\"Upload\"Submit Query------------Ij5GI3Ef1gL6ae0Ij5KM7Ij5Ij5cH2--http://event1.wanmei.com/cb/response/upload/images/new/flash_servlet/1332579836532_file.shtml   修复方案：  修一下吧。   版权声明：转载请注明来源 kobin97@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-03-24 16:16 厂商回复： 感谢kobin97对完美世界的关注，我们暂时认为这不是一个安全问题，因为我们已经做了很严格的限制。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-03-24 11:44 |    \t\t请叫我大神 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 我叫大仙，法力无边)\t\t \n  为啥xss都能算个中，这个问题职能算个低？faint    \n     2012-03-24 11:59 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  大神！这是不同厂商对不同用应的安全要求的不同。例如：一个大型SNS站点，存在xss问题，如果能实现xss蠕虫，那这个xss就是终极武器！    \n     2012-03-24 12:06 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  @shine “用”与“应”位置调换一下！^-^    \n     2012-03-24 12:20 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @shine 这位洞主很明白乌云所要提倡的东西啊 哈哈    \n     2012-03-24 12:29 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  @xsser 恩！但我认为洞主的“简要描述”是合理的，急了点！哈哈！    \n     2012-03-24 12:31 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @shine 有的洞主对自己要求也很高 大漏洞也要求是个低    \n     2012-03-24 12:38 |    \t\t请叫我大神 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 我叫大仙，法力无边)\t\t \n  哈哈，我主要是看之前wanmei对于xss的评价才说的    \n     2012-03-24 16:37 |    \t\tJannock  \t\t\t( 核心白帽子 |\t\t\t        Rank:2278 漏洞数:204        | 关注技术与网络安全（招人中，有兴趣请私信...)\t\t \n  就算不是严重漏洞，也算是安全问题吧？可以上传 html 等文件来进行欺骗钓鱼？ 比xss 更严重？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}