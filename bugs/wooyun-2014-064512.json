{"id": 3655, "wybug_id": "wooyun-2014-064512", "wybug_title": "某方法可以无视CDN查找真实IP导致真实站点遭受DDOS或入侵", "wybug_corp": "各大云防护厂商", "wybug_author": "苦咖啡", "wybug_date": "2014-06-11 17:13", "wybug_open_date": "2014-06-11 17:24", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-11：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 这个漏洞，=_=应该不算漏洞吧。但是影响范围极大，目前加速乐、网站卫士、百度云加速、安全宝等等CDN打得不亦乐乎~，各种高防DDOS和CC防御~，但是这个洞洞可以无视CDN防御，实现入侵和流量攻击，鄙人想了很久也没找到个解决办法~只能来提交下CDN厂商了,希望CDN厂商们注意下 详细说明：  1、首先注册目标网站、90%的网站都需要邮箱验证2、如没有邮箱验证，选择找回密码，实现邮箱验证3、打开邮箱，找到验证邮件，点击显示原文4、在原文中，可以发现服务器真实IP5、绑定host ，是否可以打开目标网站，就是真实IP6、对真实IP进行入侵测试，DDOS流量攻击，CC等等，实现无视CDN防御   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  CDN厂商出一个类似sendcloud邮件转发，或者出个安全邮箱，不记录IP   版权声明：转载请注明来源 苦咖啡@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-06-11 17:24 厂商回复： 可以先公开让大家看看。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-11 17:23 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  这种方法只是实现引诱敲门，不具有通用性。    \n     2014-06-11 17:34 |    \t\t苦咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 我就一菜逼，来看大牛装逼的)\t\t \n  @cncert国家互联网应急中心 但是大多数网站都有邮箱验证 密码找回功能！    \n     2014-06-11 17:41 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  这个ip能伪造    \n     2014-06-11 17:42 |    \t\t苦咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 我就一菜逼，来看大牛装逼的)\t\t \n  @浩天 求伪造方法。。。。    \n     2014-06-11 17:52 |    \t\tDarkY \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | hello world)\t\t \n  思路很不错 ，让目标机主动发请求出来    \n     2014-06-11 18:02 |    \t\t记得 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | 人 生 若 只 如 初 見)\t\t \n  @浩天  求伪造方法    \n     2014-06-11 18:10 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  @浩天 求伪造方法    \n     2014-06-11 18:15 |    \t\t小怿 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:6        | )\t\t \n  估计这些做web防护的厂商没考虑这一点吧，小的网站因为节省成本，会把mail和web用同一个服务器吧。    \n     2014-06-11 18:17 |    \t\t苦咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 我就一菜逼，来看大牛装逼的)\t\t \n  @小怿 discuz直接是在一起的  而且。。。就算用企业邮箱一样暴露IP！！    \n     2014-06-11 18:19 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  这种很难推广利用，因为大部分网站都通过smtp或者第三方平台来进行发送。    \n     2014-06-11 18:22 |    \t\t苦咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 我就一菜逼，来看大牛装逼的)\t\t \n  @无敌L.t.H smtp或者企业邮箱也可以看真实IP  利用率非常高！！！    \n     2014-06-11 18:44 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  赞    \n     2014-06-11 19:04 |    \t\t鱼化石 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:18        | 介绍不能为空)\t\t \n  这种很难推广利用，因为大部分网站都通过smtp或者第三方平台来进行发送。    \n     2014-06-11 19:09 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  @记得 居然有人想到伪造  我理解了 理论上脑袋里复现了伪造邮件IP的一次攻击     \n     2014-06-11 20:35 |    \t\t苦咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 我就一菜逼，来看大牛装逼的)\t\t \n  @鱼化石 ....第三方和smtp一样记录服务器真实IP！！！    \n     2014-06-11 20:57 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  @苦咖啡 你确定你能从一堆Received: from domain.com (localhost.localdomain [127.0.0.1])里面找出真实IP？    \n     2014-06-11 21:06 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  @苦咖啡 有时间一块讨论下 我认为 可以伪造了     \n     2014-06-11 21:31 |    \t\t苦咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 我就一菜逼，来看大牛装逼的)\t\t \n  @无敌L.t.H 你确定是127.0.0.1？？    \n     2014-06-11 21:31 |    \t\t苦咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 我就一菜逼，来看大牛装逼的)\t\t \n  @abaddon 可以试试。。。反正用企业邮箱没有成功！全部记录真实IP    \n     2014-06-11 22:07 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  @苦咖啡 是的，很多时候就是这样。很多人因为这个还被加入了垃圾邮件黑名单。    \n     2014-06-12 08:14 |    \t\t苦咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 我就一菜逼，来看大牛装逼的)\t\t \n  @无敌L.t.H ....你那个是说邮件伪造吧~   这个是网站通过企业邮箱stmp发信  记录服务器真实IP~~~    \n     2014-06-12 09:28 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  @苦咖啡 你自己装几个邮件服务器实验就知道了，因为是SMTP本身就是本地，127.0.0.1也是真实IP……    \n     2014-06-12 09:33 |    \t\t苦咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 我就一菜逼，来看大牛装逼的)\t\t \n  @无敌L.t.H .......那个是本地邮件服务器  我说的是企业邮箱  目前90%的站都用的企业邮箱吧~    \n     2014-06-12 10:48 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  @苦咖啡 我估计没有这么多，大多数还是直接用sendmail发的，毕竟不是很多人会设置SMTP。    \n     2014-06-12 19:03 |    \t\t苦咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 我就一菜逼，来看大牛装逼的)\t\t \n  @无敌L.t.H =_=我测试 90%都是smtp  smtp很简单的好吧~    \n     2014-06-12 19:57 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  @苦咖啡 只能说你遇到都是小白而已。    \n     2014-06-12 19:58 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  @苦咖啡 如果你遇到的是用VPS或者独立服务器的你就知道了，各种奇葩地址。    \n     2014-06-12 20:10 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  @苦咖啡 要么你就自己搭一个邮件服务器，把域名绑上去，然后再记录连接的地址。    \n     2014-08-24 22:28 |    \t\t魂淡、 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 么么哒)\t\t \n  @苦咖啡 这个要发就发到zone。云防理论上本来也防不住这个。    \n     2014-09-01 12:21 |    \t\t苦咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 我就一菜逼，来看大牛装逼的)\t\t \n  @魂淡、 .....这东西没人管....    \n     2015-01-27 17:31 |    \t\t0x 80 \t\t\t( 普通白帽子  |\t\t\t        Rank:1301 漏洞数:398        | 某安全公司招聘系统运维、渗透测试、安全运...)\t\t \n  思路还是不错的    \n     2015-09-03 22:13 |    \t\t90Snake \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:42        | 最大的漏洞就是人)\t\t \n  这个几百年前的老套路了。。还思路不错。。楼上的白帽子果然是“|白帽子”    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}