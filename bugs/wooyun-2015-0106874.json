{"id": 34250, "wybug_id": "wooyun-2015-0106874", "wybug_title": "商务部下属某系统设计不当，可造成系统内部信息泄漏", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-04-10 17:54", "wybug_open_date": "2015-05-29 18:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-29：\t细节向公众公开  简要描述： 首页你得注册个帐号，才会有下面的事：设计缺陷，造成路径泄漏，导致越权，进而造成信息泄漏，可获取系统内已注册企业的明文密码，以及企业上报的数据，例如共计75W人员信息 详细说明：  目标地址：http://fwwbqy.fwmys.mofcom.gov.cn/\n\n通过系统的注册功能，注册一个帐号\n\n在注册地里，你可以得到类似以下的链接\nhttp://fwwbqy.fwmys.mofcom.gov.cn/pages/information/NwbZoneInfoPopList_$DirectLink_2.html?session=T&sp=S00&sp=S\n其实我是想要试注入的~http://fwwbqy.fwmys.mofcom.gov.cn/pages/information/NwbZoneInfoPopList_$DirectLink_2.html?session=T&sp=S00'&sp=S然后你就会发现报了一堆的信息出来\n\n仔细看一下有什么\n\n这里也许有注入，手工注比较差，我就不试了\ncatalina.base /usr/local/ciecc/appsvr/apache-tomcat-6.0.29 catalina.home /usr/local/ciecc/appsvr/apache-tomcat-6.0.29 catalina.useNaming true common.loader ${catalina.base}/lib,${catalina.base}/lib/*.jar,${catalina.home}/lib,${catalina.home}/lib/*.jar file.encoding GB18030 file.encoding.pkg sun.io file.separator / jasper.reports.compile.class.path /usr/local/ciecc/appsvr/apache-tomcat-6.0.29/webapps/ROOT/WEB-INF/lib/jasperreports-0.5.2.jar  /usr/local/ciecc/appsvr/apache-tomcat-6.0.29/webapps/ROOT/WEB-INF/classes jasper.reports.compile.temp /usr/local/ciecc/appsvr/apache-tomcat-6.0.29/webapps/ROOT/reports java.awt.graphicsenv sun.awt.X11GraphicsEnvironment java.awt.printerjob sun.print.PSPrinterJob java.class.path /usr/local/ciecc/appsvr/apache-tomcat-6.0.29/bin/bootstrap.jar java.class.version 50.0 java.endorsed.dirs /usr/local/ciecc/appsvr/apache-tomcat-6.0.29/endorsed java.ext.dirs /usr/local/ciecc/appsvr/jdk1.6.0_23/jre/lib/ext:/usr/java/packages/lib/ext java.home /usr/local/ciecc/appsvr/jdk1.6.0_23/jre java.io.tmpdir /usr/local/ciecc/appsvr/apache-tomcat-6.0.29/temp java.library.path /usr/local/ciecc/appsvr/jdk1.6.0_23/jre/lib/i386/server  /usr/local/ciecc/appsvr/jdk1.6.0_23/jre/lib/i386  /usr/local/ciecc/appsvr/jdk1.6.0_23/jre/../lib/i386  /usr/java/packages/lib/i386  /lib  /usr/lib java.naming.factory.initial org.apache.naming.java.javaURLContextFactory java.naming.factory.url.pkgs org.apache.naming java.runtime.name Java(TM) SE Runtime Environment java.runtime.version 1.6.0_23-b05 java.specification.name Java Platform API Specification java.specification.vendor Sun Microsystems Inc. java.specification.version 1.6 java.util.logging.config.file /usr/local/ciecc/appsvr/apache-tomcat-6.0.29/conf/logging.properties java.util.logging.manager org.apache.juli.ClassLoaderLogManager java.vendor Sun Microsystems Inc. java.vendor.url http://java.sun.com/ java.vendor.url.bug http://java.sun.com/cgi-bin/bugreport.cgi java.version 1.6.0_23 java.vm.info mixed mode java.vm.name Java HotSpot(TM) Server VM java.vm.specification.name Java Virtual Machine Specification java.vm.specification.vendor Sun Microsystems Inc. java.vm.specification.version 1.0 java.vm.vendor Sun Microsystems Inc. java.vm.version 19.0-b09 line.separator  os.arch i386 os.name Linux os.version 2.6.9-11.19AXsmp package.access sun.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,org.apache.jasper.,sun.beans. package.definition sun.,java.,org.apache.catalina.,org.apache.coyote.,org.apache.tomcat.,org.apache.jasper. path.separator : server.loader  shared.loader  sun.arch.data.model 32 sun.boot.class.path /usr/local/ciecc/appsvr/jdk1.6.0_23/jre/lib/resources.jar  /usr/local/ciecc/appsvr/jdk1.6.0_23/jre/lib/rt.jar  /usr/local/ciecc/appsvr/jdk1.6.0_23/jre/lib/sunrsasign.jar  /usr/local/ciecc/appsvr/jdk1.6.0_23/jre/lib/jsse.jar  /usr/local/ciecc/appsvr/jdk1.6.0_23/jre/lib/jce.jar  /usr/local/ciecc/appsvr/jdk1.6.0_23/jre/lib/charsets.jar  /usr/local/ciecc/appsvr/jdk1.6.0_23/jre/lib/modules/jdk.boot.jar  /usr/local/ciecc/appsvr/jdk1.6.0_23/jre/classes sun.boot.library.path /usr/local/ciecc/appsvr/jdk1.6.0_23/jre/lib/i386 sun.cpu.endian little sun.cpu.isalist  sun.io.unicode.encoding UnicodeLittle sun.java.launcher SUN_STANDARD sun.jnu.encoding GB18030 sun.management.compiler HotSpot Tiered Compilers sun.os.patch.level unknown tomcat.util.buf.StringCache.byte.enabled true user.country CN user.dir / user.home /root user.language zh user.name root user.timezone GMT+08:00\n然后你还可以找到一堆的可疑链接\ncontext:/pages/org/NwbFullBankEdit.html\t65context:/pages/corp/NwbAuditCorpAuthEdit.html\t248context:/pages/jour/NwbAuditHistoryList.html\t21context:/pages/corp/NwbModifyHistoryEdit.html\t52context:/pages/corp/NwbCorpAuthEdit.html\t239context:/pages/cont/NwbRecConsList.html\t158context:/pages/news/city/tianjin.html\t1context:/pages/information/DeptList.html\t94context:/pages/information/NwbAllDeptInfoPopList.html\t58context:/pages/licence/NwbAuditLicInfoList.html\t129context:/pages/licence/NwbLicInfoView.html\t154context:/pages/report/ReportCorp.html\t27context:/pages/cont/NwbConExecInfoPopEdit.html\t115context:/pages/corp/NwbFileCorpView.html\t93context:/pages/news/DeptWindowList.html\t53context:/pages/corp/NwbNewPeopleView.html\t65context:/pages/train/NwbFullBankEdit.html\t89context:/pages/information/PasswordEdit3.html\t38context:/pages/corp/NotPassCorpAuthEdit.html\t221context:/pages/news/RecWbMessageList2.html\t85context:/pages/information/ShowZoneCodeList.html\t36context:/pages/Ajax.html\t2context:/components/TiebaBorder.html\t54context:/pages/org/OrgUserEdit.html\t54context:/pages/cont/ReceiveprintStub.html\t50context:/pages/train/corp/TrainCorpList.html\t306context:/pages/cont/NwbDahuiConsList.html\t32context:/pages/NwbAnnounceList.html\t66context:/pages/information/PasswordEdit.html\t41context:/pages/corp/NwbPeopleInfoEdit.html\t148context:/pages/corp/NwbFileCorpEdit.html\t216context:/pages/news/city/dalian.html\t1context:/pages/cont/NwbAuditContChangeList.html\t178context:/pages/cont/ReportRecCons.html\t68context:/pages/Page.html\t30context:/pages/train/corp/Trainview.html\t190context:/components/RecCorpInfoBorder.html\t80context:/pages/cont/NwbRecConsAdd.html\t189context:/pages/org/NwbOrgInfoList.html\t117context:/pages/corp/NwbFullBankList.html\t132context:/pages/train/org/TrainHistoryCorpList.html\t133context:/pages/cont/NwbAuditConsEdit.html\t246classpath:/org/apache/tapestry/html/RequestDisplay.html\t23classpath:/org/apache/tapestry/pages/Exception.html\t22classpath:/org/apache/tapestry/pages/StaleSession_zh.html\t8context:/pages/train/corp/Trainedit.html\t207context:/pages/report/QueryReportCustomCorp.html\t70context:/pages/corp/NwbCorpAuthView.html\t205context:/pages/questions.html\t1context:/pages/corp/NwbAuditNewPeopleList.html\t113context:/pages/query/NwbQueryCustomEdit.html\t82context:/pages/lad/NwbLadCorpFileList.html\t60context:/pages/information/DeptUserAdd.html\t76context:/pages/report/QueryReportCustom.html\t57context:/pages/corp/NwbNewPeopleList.html\t113context:/pages/corp/NwbCorpInfoEdit.html\t190context:/pages/KfPassWord.html\t69context:/pages/news/city/nanjing.html\t1context:/pages/news/city/jinan.html\t1context:/pages/train/org/TrainPrint.html\t56context:/components/LadBorder.html\t136context:/pages/cont/Receiveprint.html\t50context:/components/OrgBorder.html\t212classpath:/org/apache/tapestry/pages/StaleSession.html\t9context:/pages/coin/NwbCoinRateExcEdit.html\t28context:/pages/corp/NwbModifyHistoryEditView.html\t26context:/pages/corp/NwbAuditPeopleInfoEdit.html\t154context:/pages/corp/NotPassCorpInfoEdit.html\t190context:/pages/corp/NwbRecCorpInfoCheckList.html\t76context:/pages/report/QueryReport.html\t75context:/pages/tieba/NwbTiebaReviewList.html\t37context:/pages/information/QueryZoneList.html\t83context:/rbac/CasLogin.html\t0context:/pages/tieba/NwbTiebaFloorList.html\t53context:/pages/DeptAjaxInfo.html\t2context:/pages/information/NwbCountryPopList.html\t37context:/pages/corp/NwbCorpAuthList.html\t87context:/pages/report/Report.html\t284classpath:/com/cofortune/framework/web/ui/paging/PageNavigation.html\t110context:/pages/lad/NwbLadTrainList.html\t143context:/pages/CorpIndex.html\t74context:/pages/corp/NwbAuditModifyHistoryEdit.html\t77context:/pages/AjaxSession.html\t2context:/pages/corp/NwbAuditCorpInfoEdit.html\t444context:/rbac/auth/Logout.html\t1context:/pages/information/DeptEdit.html\t68context:/pages/news/RecWbMessageList.html\t86context:/pages/train/NwbAuditTrainList.html\t248context:/pages/train/corp/TrainHistoryCorpList.html\t133context:/pages/information/DeptShow.html\t19context:/pages/corp/NwbAuditCorpInfoList.html\t180context:/pages/corp/NwbRecCorpInfoCheckEdit.html\t36context:/pages/corp/AjaxRecCorpCodeCheck.html\t2context:/pages/train/TrainHistoryCorpList.html\t124context:/pages/corp/NwbModifyCorpInfoEditAndMoList.html\t74context:/pages/licence/NwbLicInfoList.html\t117context:/pages/cont/NwbRecConsEdit.html\t149context:/pages/NwbUserProfileConfig.html\t15context:/components/TishiBorder.html\t59context:/rbac/auth/Exception.html\t4context:/pages/news/NewsShow.html\t34context:/pages/org/NwbOrgInfoEdit2.html\t92context:/Home.html\t4context:/pages/coin/NwbCoinRateList.html\t64context:/pages/org/NwbOrgInfoEdit.html\t59context:/pages/information/DeptUserList.html\t62context:/pages/question/NwbQuestionDeptList.html\t30context:/pages/corp/NwbAuditPeopleInfoView.html\t108context:/pages/DeptIndex.html\t339context:/pages/corp/NwbRecCorpInfoEdit.html\t187context:/pages/cont/NwbAuditBatchConsList.html\t161context:/components/CorpBorder.html\t251context:/pages/org/NwbFullBankList.html\t124context:/pages/information/ModifyDeptInfo.html\t61context:/pages/corp/NwbModifyHistoryList.html\t113context:/pages/cont/NwbAuditBatchConExecInfoList.html\t170context:/pages/report/NwbReportWzAllTotalCorp.html\t94context:/pages/org/NwbFileOrgInfoList.html\t73context:/pages/corp/NwbFileCorpInfoList.html\t84context:/pages/news/city/xiamen.html\t1context:/pages/corp/NwbAuditModifyHistoryList.html\t152context:/pages/corp/NwbAuditPeopleInfoList.html\t135context:/pages/cont/NwbRecConsLoadExecList.html\t141context:/rbac/auth/Login.html\t88context:/pages/question/NwbQuestionCorpView.html\t384context:/pages/corp/NwbFullBankEdit.html\t65context:/pages/question/NwbQuestionDeptEdit.html\t467context:/pages/cont/AjaxConsCodeCheck.html\t2context:/pages/cont/NwbAuditConsList.html\t197context:/pages/query/NwbQueryCustomList.html\t60context:/pages/query/NwbQueryCustomQuery.html\t86context:/pages/tieba/NwbTiebaTitleList.html\t32context:/pages/cont/NwbAuditConExecInfoList.html\t356context:/pages/train/QueryTrainReport.html\t67context:/pages/corp/NwbModifyCorpInfoList.html\t95classpath:/org/apache/tapestry/pages/StaleLink.html\t12context:/pages/question/NwbQuestionCorpList.html\t30context:/pages/information/PasswordEdit2.html\t38context:/pages/corp/NwbPeopleInfoView.html\t108context:/components/AppBorder.html\t244context:/pages/news/base/tianjin.html\t1context:/pages/news/city/wuhan.html\t1context:/pages/corp/NwbRecCorpAuthEdit.html\t218context:/pages/cont/NwbAuditContChangeEdit.html\t73context:/pages/query/NwbQueryCustomTemplateList.html\t45context:/components/KfBorder.html\t104context:/pages/corp/NwbFullBankView.html\t39context:/pages/cont/NwbRecConsPrint.html\t126context:/pages/org/ShowWbOrgInfo.html\t33context:/pages/news/ShowRecMessage.html\t33context:/pages/corp/NwbRecPeopleInfoEdit.html\t121context:/pages/train/NwbFullBankList.html\t124context:/pages/train/org/Trainview.html\t208context:/pages/corp/NwbCorpJfzxPopList.html\t83context:/pages/AjaxAuto.html\t2context:/pages/cont/NwbConsFwwbTongji.html\t52context:/pages/news/city/chengdu.html\t1context:/pages/train/NwbFullBankView.html\t42context:/pages/corp/NotPassPeopleInfoEdit.html\t121context:/pages/corp/RecCorpInfoMsg.html\t32context:/pages/corp/NwbNewPeopleEdit.html\t106context:/pages/cont/Tishi.html\t54context:/rbac/auth/SessionTimeOut.html\t8classpath:/com/cofortune/framework/web/ui/paging/OrderColumn.html\t17classpath:/org/apache/tapestry/html/ExceptionDisplay.html\t47context:/pages/corp/NwbAuditCorpAuthList.html\t132context:/pages/corp/NwbPeopleInfoList.html\t87context:/pages/org/OrgUserList.html\t63context:/pages/corp/NwbAuditCorpAuthView.html\t205context:/pages/org/NwbFullBankView.html\t39context:/pages/question/NwbQuestionCorpEdit.html\t387context:/pages/report/QueryReportLic.html\t36context:/components/PopBorder.html\t68context:/pages/Qbs.html\t120context:/pages/OrgIndex.html\t27context:/pages/train/org/TrainCorpList.html\t302context:/pages/information/CorpUserList.html\t41context:/pages/news/base/shanghai.html\t1context:/pages/news/SendWbMessageList.html\t78context:/pages/cont/NwbContChangePopEdit.html\t78context:/pages/report/NwbReportWzEndTotalCorp.html\t94context:/pages/news/NwbMessageEdit.html\t55context:/pages/org/NwbFileOrgEdit.html\t189context:/pages/information/NwbZoneInfoPopList.html\t96context:/pages/cont/NwbAuditConExecInfoEdit.html\t150context:/pages/corp/NotPassCorpInfo.html\t56\n然后回头，我们继续注册一个帐号吧，这里注册帐号虽然需要审核，但是在未审核通过之前仍然可以登录系统，接着就可以尝试越权这里我注册了一个帐号：帐号0502595596180密码0502595596180\n\n   漏洞证明：  登录系统后我发现了越权的几个页面\nhttp://fwwbqy.fwmys.mofcom.gov.cn/pages/corp/NwbFileCorpEdit.htmlhttp://fwwbqy.fwmys.mofcom.gov.cn/pages/news/NewsList.htmlhttp://fwwbqy.fwmys.mofcom.gov.cn/pages/information/CorpUserList.html http://fwwbqy.fwmys.mofcom.gov.cn/pages/information/NwbCorpUserAdd.htmlhttp://fwwbqy.fwmys.mofcom.gov.cn/pages/KfPassWord.htmlhttp://fwwbqy.fwmys.mofcom.gov.cn/pages/data/NfwwbStaStatusList.htmlhttp://fwwbqy.fwmys.mofcom.gov.cn/pages/Qbs.htmlhttp://fwwbqy.fwmys.mofcom.gov.cn/pages/OrgIndex.htmlhttp://fwwbqy.fwmys.mofcom.gov.cn/pages/tieba/NwbTiebaTitleList.html\n其中http://fwwbqy.fwmys.mofcom.gov.cn/pages/news/NewsList.html可对系统新闻进行新增修改与删除\n\nhttp://fwwbqy.fwmys.mofcom.gov.cn/pages/information/CorpUserList.html可查看到系统内所有注册用户的帐号密码\n\n另一个页面也可以看http://fwwbqy.fwmys.mofcom.gov.cn/pages/KfPassWord.html\n\n可对帐号进行禁用接着，可查看所有企业的人才信息（75W条记录）http://fwwbqy.fwmys.mofcom.gov.cn/pages/train/NwbTrainCardNoList.html\n\n以浪潮集团山东通用软件有限公司为例\n\n因为需要进行保存操作，我就不影响该企业的数据填报工作了，我们可以获取到该公司的以下信息\n合同信息 接包列表   数据统计 人力资源 企业认证 资金申报 人才培训     国际认证     资料附件上传     资金到位信息 企业信息 企业信息   注册地和审核部门修改   新录用人员信息 用户信息\n   修复方案：  控制权限   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-04-14 18:30 厂商回复： CNVD未直接复现所述情况,已经转由CNCERT向国家上级信息安全协调机构上报,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}