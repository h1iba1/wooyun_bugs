{"id": 73618, "wybug_id": "wooyun-2016-0167386", "wybug_title": "豆丁网vip服务支付漏洞", "wybug_corp": "豆丁网", "wybug_author": "想谁谁", "wybug_date": "2016-01-05 09:25", "wybug_open_date": "2016-01-10 09:26", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-10：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： vip服务的支付漏洞 详细说明：  1.正常的支付流程注册好豆丁网帐号之后 进入开通vip服务：http://www.docin.com/app/jump_adv/pay_vip.do?channelid=0313&buyVipFrom=4选择需要开通的月份 点击立即开通\n\n选择付款方式 点击确认付款\n\n跳转到支付宝付款页面 支付完成就行\n\n2.跳过支付流程以上是正常的支付流程，关键是第2步，选择开通的月份为6个月vip，不要点立即开通这里用到的工具是fiddle  设置f11好拦截数据进行抓包，点击立即开通 确认支付 点击确认之后工具左侧出现拦截的网址数据，双击进去，右侧选项卡选择webforms，只要把vip-type后面的数值（月数）改成大于6以上的数据（小于6未做测试），鼠标点击左栏下方红色箭头两下，释放数据。然后点击右下侧绿色run to ... 网页即可自动跳转到已购买页面，并且显示购买到期时间。\n\n   漏洞证明：  豆丁网http://www.docin.com新注册个帐号qwe921234 密码a121212进入vip购买服务fiddle设置好拦截数据 点击确认付款\n\n然后修改拦截后的数据 月份为120个月 即为10年 \n\n然后释放拦截数据再点击run to... 网页直接跳转到http://www.docin.com/app/my/caseVip显示自己的vip时长\n\n这是账单明细\n\n   修复方案：  1.对所需要购买的支付数据进行加密2.利用公式进行账单结算，在优惠的基础上购买时长越多，产生订单金额越多。3.对所购买的会员服务，不止要对购买所列出的月数产生金额，也要对自定义月数产生订单金额。   版权声明：转载请注明来源 想谁谁@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-01-10 09:26 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-05 09:32 |    \t\t染血の雪 \t\t\t( 普通白帽子  |\t\t\t        Rank:205 漏洞数:31        | 你挖 或者不挖漏洞就在哪儿不多 不少)\t\t \n  坐等忽略    \n     2016-01-05 13:35 |    \t\t想谁谁 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 小白)\t\t \n  @染血の雪 为什么才提交就被公布了?不应该会保密吗    \n     2016-01-05 13:41 |    \t\t染血の雪 \t\t\t( 普通白帽子  |\t\t\t        Rank:205 漏洞数:31        | 你挖 或者不挖漏洞就在哪儿不多 不少)\t\t \n  @想谁谁 没公布啊，是你的漏洞你才看得到吧~    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}