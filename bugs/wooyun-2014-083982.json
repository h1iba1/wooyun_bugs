{"id": 48161, "wybug_id": "wooyun-2014-083982", "wybug_title": "铁威马私人云储存服务器多处安全漏洞可泄漏大量敏感数据", "wybug_corp": "铁威马", "wybug_author": "快到碗裏來", "wybug_date": "2014-11-20 15:27", "wybug_open_date": "2015-01-04 15:28", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-20：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-01-04：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 之前我简单提交过，乌云直接忽略了，然后发邮件给厂商，厂商也不里不睬的。当然，当时只是随便地说了登录界面存在注入....... 详细说明：  随便在登录界面输入主机名字，然后点击登录，获得http://www.mydisk.biz/redirect.php，和HostName:asdf字段。\n\n然后拿出sqlmap任意文件下载etc/passwd\n\n注入点：\n\n数据库帐号：\n\n数据库权限：\n\n数据库：\n\n表：\n\n利用任意文件读取，把index.php读取了下来，查看代码：\n\n\n<?php\tinclude('INCLUDE/Connect_DB.php');\tinclude('INCLUDE/Language.php');\t\t\tif ($_GET['fn'] <> '' || $_GET['err'] <> '')\t\t$Message = $Response_Message;?>\n然后追下去，把Connect_DB.php下载下来\n\n直接查看源码：\n\n爆出来了，连MD5都可以不用去跑\n<?php\t$DB_Host = 'localhost';\t$DB_User = 'root';\t$DB_Password = '2848021212345';\t$DB_Name = 'codetek_cloud_server';\t$DB_LINK = mysql_connect($DB_Host, $DB_User, $DB_Password) or die('Could not connect: ' .mysql_error());\t\tmysql_select_db($DB_Name) or die('Could not select database');\tmysql_query(\"SET NAMES 'UTF8'\", $DB_LINK);\t\tif($Restriction !== false){\t\tinclude('Restriction.php');\t}?>\n别小看1=1   漏洞证明：  随便在登录界面输入主机名字，然后点击登录，获得http://www.mydisk.biz/redirect.php，和HostName:asdf字段。\n\n然后拿出sqlmap任意文件下载etc/passwd\n\n注入点：\n\n数据库帐号：\n\n数据库权限：\n\n数据库：\n\n表：\n\n利用任意文件读取，把index.php读取了下来，查看代码：\n\n\n<?php\tinclude('INCLUDE/Connect_DB.php');\tinclude('INCLUDE/Language.php');\t\t\tif ($_GET['fn'] <> '' || $_GET['err'] <> '')\t\t$Message = $Response_Message;?>\n然后追下去，把Connect_DB.php下载下来\n\n直接查看源码：\n\n爆出来了，连MD5都可以不用去跑\n<?php\t$DB_Host = 'localhost';\t$DB_User = 'root';\t$DB_Password = '2848021212345';\t$DB_Name = 'codetek_cloud_server';\t$DB_LINK = mysql_connect($DB_Host, $DB_User, $DB_Password) or die('Could not connect: ' .mysql_error());\t\tmysql_select_db($DB_Name) or die('Could not select database');\tmysql_query(\"SET NAMES 'UTF8'\", $DB_LINK);\t\tif($Restriction !== false){\t\tinclude('Restriction.php');\t}?>\n别小看1=1   修复方案：  过滤   版权声明：转载请注明来源 快到碗裏來@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-11-20 16:52 |    \t\t快到碗裏來 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 這傢伙很懶，什麼也沒有留下！)\t\t \n  可以通過反彈getshell，不過沒深入，另對於這種把產品開發了出來，但又對其不理不睬的廠商，真心覺得LJ,收了用戶的錢，確不對用戶的資料負責    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}