{"id": 6917, "wybug_id": "wooyun-2014-047595", "wybug_title": "我是这样挖掘x-forwarded-for注入到成功注射的", "wybug_corp": "zhujia360.com", "wybug_author": "剑无名", "wybug_date": "2014-01-01 12:23", "wybug_open_date": "2014-01-06 12:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-06：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：   RT，我下面如果说错了不要喷我。因为我不知道对不对@sex is not show谢谢你的帮助.祝贺wooyun全体白帽子和管理新年快乐:) 详细说明：     如何查找这种注入，以前一直也很困惑啊，如果我手工一个一个测试，如果被我遇到了真的是人品大爆发了。问过@小胖子他当时说是可遇不可求的。但是我也不是就这么信了。好了说真题。   xx年xx月xx日我浏览一个网站的时候发现\n\n   我当时很震惊，为啥这一进去网站就爆sql注入。后来仔细一看8.8.8.8'的时候，我明白了，就在不久前，我下载过火狐的一个x-forwarded-for然后鬼使神差的在填写ip的地方加了个'   然后就有了当时的一幕\n\n   然后我抓包，直接丢sqlmap里面跑。但是我在x-forwarded-for后面加的*被无视了。不是吧，刚好看到zone里面也在讨论，他们提出的方法也是加-p参数、加--level等等，但是我全部测试，都没行。弄的本屌很伤心，只能找朋友@sex is not show帮忙，他说他读出了数据！！！   漏洞证明：     好了，既然这样那就是我的sqlmap的问题了。本屌当时很纠结了，各种想不通，他使用的是kali系统，但是我使用win下的和bt5下面的都跑不出来。难道是版本太老了？好吧，我去更新了下sqlmap的版本。最后成功注入出来贴下图\n\n   对了，这是抓包数据\nGET / HTTP/1.1Host: hz.zhujia360.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:26.0) Gecko/20100101 Firefox/26.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: Hm_lvt_26ab71a0888a7c7ba96d0e45748d4dc2=1387942718,1387976626,1388500568; sgsa_id=zhujia360.com|1387942718722749; PHPSESSID=cd37aeed800e5af6ef7e61c51fd53eaa; Hm_lpvt_26ab71a0888a7c7ba96d0e45748d4dc2=1388500568; sgsa_vt_90977_93493=1388500568431; stat_mac=EF00CEA2771AC60BX-Forwarded-For: 8.8.8.8*Connection: keep-aliveCache-Control: max-age=0\n   修复方案：    自从有了这个神器，貌似x-forwarded-for的注射就可以自动探测了。可能你们早就知道了...   版权声明：转载请注明来源 剑无名@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-01-06 12:24 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-01 12:33 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  顶一下！！！！！！！11    \n     2014-01-01 16:02 |    \t\t剑无名 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:32        | 此剑无名。)\t\t \n  @光刃 溢出牛...    \n     2014-01-01 16:40 |    \t\t小驴牙牙 \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:43        | 不断学习，进步！)\t\t \n  顶一下！！！！！！！11     \n     2014-01-01 18:49 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  赞一个！！！！！！！！！！！！！！    \n     2014-01-06 13:22 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  除非对我很有价值的站，不然我不会这么去费神费力的，可遇不可求啊！    \n     2014-01-06 13:45 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  MARK    \n     2014-01-06 14:38 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  最新版的sqlmap支持 -p \"x-froward-for\"但是我遇到的这个sqlmap识别不了，只能手注。。。    \n     2014-01-06 16:44 |    \t\tVigoss_Z \t\t\t( 普通白帽子  |\t\t\t        Rank:404 漏洞数:63        | 楞娃)\t\t \n  @Mody --headers\"x:x\"*    \n     2014-01-07 19:11 |    \t\tnick被注册 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:20        | 天一)\t\t \n  没错，有个php的主机管理系统也存在这个问题，同事的kali下的sqlmap可以注，我的BT5就不行，升级下版本ok    \n     2014-01-08 17:20 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  赞楼主分享精神    \n     2014-11-24 13:26 |    \t\tdmst \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:8        )\t\t \n  感谢楼主分享，mark一下    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}