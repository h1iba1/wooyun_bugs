{"id": 88606, "wybug_id": "wooyun-2016-0226583", "wybug_title": "不小心闯进1905某站后台/我发誓真的是不小心                                      ", "wybug_corp": "M1905.COM", "wybug_author": "黑骑士", "wybug_date": "2016-07-06 14:10", "wybug_open_date": "2016-07-11 19:00", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["渗透测试思路"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-07-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-07-06：\t厂商已查看当前漏洞内容,细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-07-11：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 不小心闯进1905某站后台，权限高得吓人，我发誓真的是不小心！！！我是无辜的。。。故事非常曲折，原本想去找注入，顺带看了下逻辑漏洞，结果不小心进后台了。。。ORZ本人为更改任何系统设置，未盗取任何系统信息，躺枪的账号已设置为强密码 详细说明：  http://yun.1905.com\n\n原本看到这个站有过注入就想转转，然后发现重置密码页面好像有点意思http://yun.1905.com/index.php?m=Home&c=User&a=findPassword\n\n注册个账号分析下数据包感觉闻到了cookie混淆的味道使用我的账号进行正常找回密码流程获取验证码，停留在输入验证码页面\n\n这时在同一浏览器打开新的网页，用被害账号test进行正常找回流程停止输入手机验证码页面\n\n然后在我的账号的新密码页面输入新密码提交后收到200返回包重置成功，test的密码被重置了！！\n\n这里是因为验证码与cookie绑定而两账号此时cookie相同造成了混淆这里强烈批评该网站不会报错模糊化处理，这是我进入后台的关键\n\n\n\n此处不经过验证码便可以猜解用户名，我就这样找到了test这个用户，以为这么随便的名字肯定是个没人用的客户，就拿他做了测试，谁知登陆时出现了下图！！！\n\n居然是管理员！！！既然前台不让登陆，那就找一下后台试验到http://yun.1905.com/admin.php时发现Duang的一下跳到了后台！http://yun.1905.com/admin.php?s=/Public/login是你逼我来这的啊，不是我的错\n\n登陆一看，权限好高，编辑其他管理员，管理用户审核视频啥都能干\n\n   漏洞证明：  \n\n\n\n\n\n密码重置为DK123~   修复方案：  报错模糊化，管理员密码找回取消改由人工认证，取消后台自动跳转，修复找回密码逻辑漏洞   版权声明：转载请注明来源 黑骑士@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-07-11 19:00 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-07-06 14:12 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1865 漏洞数:288        | 以大多数人的努力程度之低，根本轮不到去拼...)\t\t \n  我发誓真的是不小心...    \n     2016-07-06 14:34 |    \t\tRaven \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:9        | 人称乌云吴彦祖)\t\t \n  就是他，就是那个人    \n     2016-07-06 14:35 |    \t\tMurk Emissary \t\t\t( 实习白帽子  |\t\t\t        Rank:74 漏洞数:14        | 低调做人 低调行事)\t\t \n  躺枪的账号已设置为强密码    \n     2016-07-06 14:38 |    \t\t小白G \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:30        | 黑夜给了我黑色的眼睛，而我却用它寻找光明...)\t\t \n  警察叔叔：你有权保持沉默,但你所说的一切都将成为呈堂证供！黑骑士：我要见律师 我要见律师！      \n     2016-07-06 15:54 |    \t\t黑骑士 \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:27        | 黑色的骑士守护着光明)\t\t \n  @小白G 全程都是系统在提示我：这个账号不存在、这个账号存在、你重置的这个账号是个管理员、管理员不在前台登陆、后台url不是这样的应该是这样的。。。然后我就进去了，我什么都没做，我是无辜的    \n     2016-07-07 14:37 |    \t\tPost \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:12        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  是她，就是他，我们的火麒麟    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}