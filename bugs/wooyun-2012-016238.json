{"id": 14792, "wybug_id": "wooyun-2012-016238", "wybug_title": "中国联通上网卡查询系统存在SQL注入，泄密了", "wybug_corp": "中国联合网络通信集团有限公司", "wybug_author": "ghy459", "wybug_date": "2012-12-20 10:44", "wybug_open_date": "2013-02-03 10:44", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "数据库账户权限过高"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-02-03：\t细节向公众公开  简要描述： 在一次正常查询中没填号码就按提交了，结果返回SQL错误提示，于是有了下面事情的发生。站上还有phpmyadmin，root权限，各种弱口令。（注：这个网站只有用联通上网卡的设备才能访问） 详细说明：  查询页面：http://10.10.10.3/chaxun.html（这个网站要用联通上网卡才能访问，普通3G卡也不行。我的卡是北京联通的，不知道跟地域有没有关系。）返回结果页面：http://10.10.10.3/chaxun.php?cardNumber=+861454009xxxx（上网卡号码）\n\n加单引号返回错误提示。\n\n之后就是各种爆神马的。。\n\n   漏洞证明：  拿sqlmap跑一下,权限是root。\n\n然后跑了下密码，发现各种123456，幸好root不是。。\n\n站上还有个phpmyadmin，那就更适合了。。我看有个radius库，应该跟计费有关系吧，具体没看了。好像还有alipay神马的。裤的内容都没看，因为没流量了。。。。   修复方案：  修复你懂的   版权声明：转载请注明来源 ghy459@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-12-24 00:22 厂商回复： CNVD根据图片确认（涉及内部网络信息系统，未复现），已在21号转由CNCERT直接协调中国联通集团公司处置。按相邻网络攻击，完全影响机密性，部分影响可用性和完整性进行评分，rank 10 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}