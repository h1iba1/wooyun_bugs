{"id": 42160, "wybug_id": "wooyun-2014-086601", "wybug_title": "湖北经济学院商法学院教务管理系统入侵", "wybug_corp": "湖北经济学院", "wybug_author": "路人甲", "wybug_date": "2014-12-10 11:50", "wybug_open_date": "2014-12-15 11:52", "wybug_type": "成功的入侵事件", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["湖北经济学院商法学院教务管理系统入侵"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-15：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 可获得注入获得最高权限管理员账号 详细说明：  首先做了和正方的字典  然后倒入御剑开始扫扫敏感信息218.197.80.9\n\n感觉是权限设置有点问题  敏感文件真不少然后感觉这个页面是可以注入的http://218.197.80.9/login.html使用sqlmap 进行post注入 这个注入很简单  但是很耗时间注入语法Post登陆框注入:./sqlmap.py -r *.txt -p tfUPasssqlmap -u http://218.197.80.9 --formssqlmap -u url \"tfUName=1(可为任意数)&tfUPass=1(可为任意数)\"谁便以这种都可以我就使用sqlmap -u http://218.197.80.9 --forms自动收索了因为简单呵呵！ 接下来就是长规指令很无聊  而且因为时间太长   就不重复了正方的管理和老师的表名是yhb  乌云上知道的  感谢乌云的学习平台接下来注入得到管理账号和md5jwc01 {MD5}a1VWdNt5nYbW7SBamrAr4w== md5我改掉了两位  为了防止别人拿去乱搞接下来问题来了  这是个22位的md5  来看看怎么解这种md5谁便找个22位md5为例下面就走个流程, 看看怎么把E5Ia47UWnXs19vyWWsjKbg还原成出来: 先列个东西,  等会要用:00        A        16        Q        32        g        48        w01        B        17        R        33        h        49        x02        C        18        S        34        i        50        y03        D        19        T        35        j        51        z04        E        20        U        36        k        52        005        F        21        V        37        l        53        106        G        22        W        38        m        54        207        H        23        X        39        n        55        308        I        24        Y        40        o        56        409        J        25        Z        41        p        57        510        K        26        a        42        q        58        611        L        27        b        43        r        59        712        M        28        c        44        s        60        813        N        29        d        45        t        61        914        O        30        e        46        u        62        +15        P        31        f        47        v        63        /复制代码① 把E5Ia47UWnXs19vyWWsjKbg根据上面的表还原出来数值: 04 57 08 26 56 59 20 22 39 23 44 53 61 47 50 22② 把04 57 08 26 56 59 20 22 39 23 44 53 61 47 50 22转成Bin值: 04        0000010057        0011100108        0000100026        0001101056        0011100059        0011101120        0001010022        0001011039        0010011123        0001011144        0010110053        0011010161        0011110147        0010111150        0011001022        0001011022        0001011044        0010110035        0010001110        0000101027        0001101132        00100000③ 一共有22个, 前21个把开头的00去掉, 最后一个除了去掉开头的00还要去掉末尾的0000得到这个:00010011 10010010 00011010 11100011 10110101 00010110 10011101 01111011 00110101 11110110 11111100 10010110 01011010 11001000 11001010 01101110复制代码④ 把Bin转换成Hex:00010011        1310010010        9200011010        1A11100011        E310110101        B500010110        1610011101        9D01111011        7B00110101        3511110110        F611111100        FC10010110        9601011010        5A11001000        C811001010        CA01101110        6E复制代码⑤ 最后得到: 13921AE3B5169D7B35F6FC965AC8CA6E这个够眼熟了吧? 32位的自己反查吧...其实我不懂, 上面都是我瞎编的, 实在编不下去了;P.S. 这种MD5(d_Base64)的方式在asp.net的Membership中自带了;方法一样  就这样   漏洞证明：  为可证明漏洞冒死等了下管理的号\n\n不知道为什么前几个都没过  管理好人给个好   修复方案：  过滤  正确设置权限   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-15 11:52 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-15 23:35 |    \t\tsin \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:2        | 寻找最优雅的解决方案)\t\t \n  小伙子,你的想法很危险呐...貌似不通用额你在习科看的这个22位md5转换吧....前端时间刚好批量转换+md5api机密这个...稍微看了下.习科上面的那位给出的其实有点瑕疵....    \n     2014-12-15 23:43 |    \t\tsin \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:2        | 寻找最优雅的解决方案)\t\t \n  另外你到底是什么注入的?老版本确实挺多注入,但这个应该md5后的版本应该不容易吧....注入纯静态html....欲盖弥彰???    \n     2015-02-27 00:11 |    \t\twellsun \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | www.wellsun.com)\t\t \n  @sin 其实我跟你的想法一样.再加上,login.html 递交的表单也不是 tfUName 跟 tfpass..    \n     2015-03-20 21:08 |    \t\txbuther \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 多多交流，一起进步。。。O(∩_∩)O~)\t\t \n  注入纯静态html  楼主好666    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}