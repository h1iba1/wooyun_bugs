{"id": 14908, "wybug_id": "wooyun-2012-015990", "wybug_title": "南方航空多个站点沦陷，偏爱JBoss，导致用户信息可能会泄露", "wybug_corp": "中国南方航空", "wybug_author": "rivers", "wybug_date": "2012-12-14 10:16", "wybug_open_date": "2013-01-28 10:17", "wybug_type": "应用配置错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "第三方框架", "配置不当", "远程命令执行", "任意文件上传", "内部敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-28：\t细节向公众公开  简要描述： JBoss JMX控制台存在弱口令，导致如HEAD、PUT或DELETE等未在配置文件中允许的方法能够直接以jbossadmin身份调用GET处理器，并可以通过JBoss的HtmlAdaptor模块部署WebShell。另：攻击者可能通过Struts2远程代码执行漏洞查看系统所有文件、远程执行系统命令、上传后门程序等，危害系统安全。 详细说明：  Xwork:http://skypearl.csair.com/skypearl/cn/toExchangeStandard.actionhttp://58.248.41.226/web/productAction!queryProduct.action?prodId=10077见漏洞证明：   漏洞证明：  南航机务维修移动网：http://58.248.41.204/\n\n发现JMX-console\n\n通过HEAD绕过认证上传webshell\n\n执行系统命令：\n\n\n\n还没完A380宣传页面：http://58.248.41.220/\n\n绕过认证部署webshell后执行命令：\n\n南航明珠俱乐部：http://58.248.41.226/\n\n通过HEAD绕过认证上传webshell\n\nhttp://skypearl.csair.com/cn/\n\n查看服务器信息：\n\n远程执行命令：\n\nhttp://58.248.41.226\n\n查看服务器信息：\n\n查看配置文件，看见抽奖规则：\n\n   修复方案：  删除$JBOSS_HOME/[server]/all/deploy和$JBOSS_HOME/[server]/default/deploy下的Jmx-console.war、Web-console.war文件卸载控制台。   版权声明：转载请注明来源 rivers@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-12-14 16:01 厂商回复： CNVD确认并复现所述情况，并已转由CNCERT广东分中心协调涉事单位，同时结合14日出现的多起南航相关网站事件，拟在下周将这多起事件统一通报民航行业信息化主管部门。按完全影响机密性，部分影响可用性及完整性进行评分，基本危害评分8.97（高危），发现技术难度系数1.0，涉及行业或单位影响系数1.5，综合rank=13.455，同时加上通用软件漏洞评分 6 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-15 10:05 |    \t\tttvip11 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 这个人很懒，什么都不会)\t\t \n  求教，那个HEAD绕过认证具体是怎么绕的呢？经常遇到jboss    \n     2013-01-15 13:37 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @ttvip11 同求，对jsp不了解。    \n     2013-01-16 08:48 |    \t\t九死还魂草 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | V)\t\t \n  同上 请教使用burp那段具体如何绕过？    \n     2013-01-28 10:38 |    \t\tunxss \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:4        )\t\t \n  jboss head绕过请关注  CVE-2010-0738    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}