{"id": 19709, "wybug_id": "wooyun-2012-06427", "wybug_title": "国家电网某电子商务平台几个漏洞", "wybug_corp": "国家电网", "wybug_author": "kamatyo", "wybug_date": "2012-05-04 00:21", "wybug_open_date": "2012-06-18 00:22", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用", "字符型注射", "黑盒", "任意文件读取"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-05-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-05-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-06-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-06-18：\t细节向公众公开  简要描述： 存在注入和目录遍历漏洞，造成信息泄露 详细说明：  国家电网电子商务平台有两个网站：https://ecp.sgcc.com.cnhttp://newbidding.sgcc.com.cn1、SQL注入http://newbidding.sgcc.com.cn/lcExpertRegForm.xhtml?method=initReg选择工作单位，parentOrgID未过滤。\n\n一眼望去，一片弱口令啊。。2、目录遍历https://ecp.sgcc.com.cn使用的下载功能有目录遍历。\n\n其实两个网站的下载好像都是这个模块。3、貌似上传也有问题http://newbidding.sgcc.com.cn/lcExpertRegForm.xhtml?method=initReg照片能直接传jsp（客户端验证）。图片显示不是url，而且二进制输出，不能直接利用（如果上传位置在web根目录下的话）。https://ecp.sgcc.com.cn的供应商申请里，似乎可以00截断，但要看到回显似乎要通过人工审核，太麻烦没验证。\n\n   漏洞证明：  \n\n   修复方案：  都是过滤。如果上传在web目录下，建议上传功能也改了吧。   版权声明：转载请注明来源 kamatyo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2012-05-04 15:24 厂商回复： CNVD确认漏洞并复现所述部分过程，已转由CNCERT通报国网公司电力科学研究院处置。对漏洞评分如下：CVSS：(AV:R/AC:L/Au:NR/C:P/A:N/I:N/B:N) score:4.96（最高10分，中危）即：远程攻击、攻击难度低、不需要用户认证，对机密性造成部分影响。技术难度系数：1.2（多个漏洞一并发现不容易，分析详细）影响危害系数：1.3（较严重，涉及重要信息系统部门业务系统）CNVD综合评分：4.96*1.2*1.3=7.737 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-26 09:35 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @kamatyo 大神呀 分析的很好求指教一下 jsp 可以使用00截断么？我怎么没有成功   jsp会进行url两次url解码？%252e ->.    \n     2012-06-04 12:56 |    \t\tkamatyo \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:3        | 木有)\t\t \n  @possible 00截断我不知道能否成功，因为看不到回显，也许是截断失败的。为啥用二次编码，应该是他代码自己解码了一次，为啥解码就不知道了。我试过如果只一次编码就无法成功    \n     2012-06-04 13:07 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @kamatyo 哦 谢谢 测试jsp版fck漏洞，发现是可以使用00截断    \n     2012-06-18 13:06 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  洞主这是什么测试工具    \n     2012-06-25 20:21 |    \t\tkamatyo \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:3        | 木有)\t\t \n  @xsser 这不就是burp么。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}