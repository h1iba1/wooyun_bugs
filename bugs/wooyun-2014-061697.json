{"id": 1932, "wybug_id": "wooyun-2014-061697", "wybug_title": "PageAdmin CMS最新版任意文件删除可GetShell", "wybug_corp": "PageAdmin", "wybug_author": "cmd", "wybug_date": "2014-05-22 23:18", "wybug_open_date": "2014-08-20 23:24", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-30：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-20：\t细节向公众公开  简要描述： PageAdmin CMS最新版任意文件删除可GetShell 详细说明：  在上个漏洞wooyun-2014-061609中，我提到了FCK编辑器可以绕过的问题，但是只是用来列目录，查看代码，我发现它还可以删除任意文件，没有过滤。if (text5 == \"DelFile\") {    this.GrIdOC5LQ(xmlNode, text, text2);}path = current.Server.MapPath(current.Request[\"FileUrl\"]);flag = !File.Exists(path);if (flag)     mLl4TDlFjua8ECRxcG.aHPyXJTts(base.Response, 1, \" unable to locate file \");else    File.Delete(path);系统安装文件/e/install/index.aspx检测了/e/install/install.lock是否存在如果不存在的话，就可以重装网站，所以我们就可以用这个漏洞删除掉install.lock文件。首先把Cookie改成 Master=1&UID=9999&Valicate=17b62103fec08a1333215b141bb18217f11c8e13a然后访问/e/incs/fckeditor/editor/filemanager/connectors/aspx/connector.aspx?Command=DelFile&Type=File&CurrentFolder=&FileUrl=../../../../../../install/install.lock这样就删掉了install.lock，然后访问/e/install/，这里可以直接修改管理员密码，或者执行sql添加管理员账号。\n\n\n\n   漏洞证明：  这里拿官方DEMO测试一下。删文件+添加用户\n\n用户名test，密码admin登陆后台，点增加专题，专题内容里面写ASPX代码，就可以拿shell了\n\n添加后，用专题管理，找到专题，访问一下，shell就生成好了，地址是/e/zt/xx.aspx\n\n   修复方案：  过滤   版权声明：转载请注明来源 cmd@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-05-27 14:07 厂商回复： 由CNVD统一汇总后练习厂商处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-22 00:17 |    \t\tAZURE[传道士] \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 无)\t\t \n  你好方便 留个联系方式么 我有相关问题要请教你    \n     2014-09-12 15:40 |    \t\tGuoKer（ZhuLiu） \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:21        | 在校学生党的路过   霸气侧漏)\t\t \n  把拿shell的代码提出来！    \n     2014-10-17 23:03 |    \t\thzh4k \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 基情四射)\t\t \n  把拿shell的代码交出来！     \n     2014-10-19 21:49 |    \t\tPageAdmin(乌云厂商)\t\t \n  PageAdmin 2014-10-10版已经修复此问题，谢谢白帽子    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}