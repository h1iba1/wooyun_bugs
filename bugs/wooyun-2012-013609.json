{"id": 15959, "wybug_id": "wooyun-2012-013609", "wybug_title": "联想慧盾（5.x）密码泄漏", "wybug_corp": "联想", "wybug_author": "某熊", "wybug_date": "2012-10-20 14:18", "wybug_open_date": "2012-12-04 14:19", "wybug_type": "用户敏感数据泄漏", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-10-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-10-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-10-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-12-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-12-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-04：\t细节向公众公开  简要描述： 联想慧盾（联想硬盘保护系统）5.x是与北京海光公司合作推出的产品，在学校的机房常能见到。由于产品设计存在缺陷，允许任意用户在硬盘保护系统启用的状态下读取管理员密码。 详细说明：  联想慧盾将包括密码在内的一系列配置信息存储在0柱面0磁头3扇区中。该扇区在硬盘保护系统启用的状态下（保护模式）也可以被任意具有管理员权限的用户读取（直接读\\\\.\\PhysicalDrive0），没有做任何保护。联想慧盾存储管理员密码时，仅进行了可逆变换，导致任意具有管理员权限的用户可以读取包括管理员密码在内的配置信息。存在这个问题的系统，配置扇区（0柱面0磁头3扇区）的开头几个字节为?? ?? 4b 2d 31 30，可以作为特征加以鉴别。   漏洞证明：  \n\n   修复方案：  1.修改windows下的驱动，至少不要允许在保护模式下读取配置扇区吧2.修改密码存储方式，不要使用可逆变换3.对于机房管理员，可以给管理员帐号设置密码暂时解决这个问题   版权声明：转载请注明来源 某熊@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2012-10-23 17:46 厂商回复： 谢谢。这是想哥处理的最后一条漏洞了，后续会有新的想哥来和大家合作。@root，邮件通知功能该检查下了，这条漏洞想哥没收到邮件通知。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-10-20 15:43 |    \t\t某熊 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:5        )\t\t \n  说明一下，管理员权限指的是windows的administrator权限，管理密码就是联想慧盾的管理员密码啦    \n     2012-10-23 18:42 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @联想 想哥这是要走了么？我们会怀念你的！    \n     2012-10-23 20:48 |    \t\t陌路 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:5        | 安全爱好者！)\t\t \n  在windows下可以获取密码?    \n     2012-10-23 22:42 |    \t\t某熊 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:5        )\t\t \n  @陌路 是啊，而且是开了保护照样获取    \n     2012-10-24 08:28 |    \t\t陌路 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:5        | 安全爱好者！)\t\t \n  @某熊 在保护模式下直接读管理员密码?你试6X版本了吗?    \n     2012-10-24 12:41 |    \t\t某熊 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:5        )\t\t \n  @陌路 6x换西安三茗了，没试过    \n     2012-11-06 19:57 |    \t\t小丑鱼 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:2        | 瞎混中。。。)\t\t \n  联想的保护系统漏洞我以前也发现过，制作了录像发给联想，可惜人家不甩我，当时也不知道乌云，就没管它了。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}