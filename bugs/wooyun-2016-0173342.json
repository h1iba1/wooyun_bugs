{"id": 86038, "wybug_id": "wooyun-2016-0173342", "wybug_title": "万户OA多个漏洞打包(任意文件上传.XXE.SQL注射)", "wybug_corp": "万户网络", "wybug_author": "loopx9", "wybug_date": "2016-01-28 21:29", "wybug_open_date": "2016-05-02 21:40", "wybug_type": "", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "代码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-02：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-03-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-02：\t细节向公众公开  简要描述： 万户ezoffice系统. 详细说明：  web.xml配置得有session过滤器，只有白名单内的url放行，没有登录的话会强制跳转到登录页面。\n\n\nSELECT  SECU_URL FROM  EZ_SECU_PAGELIST  WHERE LIST_TYPE=1\n从数据库中可以得到一份白名单URL:\n\n挑几个感兴趣的来看。0x1 任意文件上传 url: /UploadServlet\n\n\n\n\n\n最后上传的文件路径就是: uploadFolder/path/fileId.substring(0, 6)/fileId，path和fileId两个参数可控，所以可以上传任意文件了官方demo演示:\n\n0x2 xfire xml实体注入webservice使用了xfire框架，存在xxe漏洞\n\njmx-console 存在默认口令: admin/ezoffice，网上搜一下基本没改。\n\n0x3 SQL注射webservice服务需要一个通信密码，但官方自己留了一个万能密码：auth.key.whir2012\n\n有了这个key，webservice都能使用。可以进行添加、删除用户等操作。\n\nwebservice很多地方没有使用参数查询还是拼接sql，存在SQL注射：\n\n\n\n   漏洞证明：  \nhttp://**.**.**.**:7055/defaultroot/upload/test/123456/123456.jspx\n\n\n\n\n\n\n   修复方案：  .   版权声明：转载请注明来源 loopx9@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-05-02 21:40 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-07 22:29 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1712 漏洞数:261        )\t\t \n  大师傅要不要这么贵-。-，我都想去卖屁股了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}