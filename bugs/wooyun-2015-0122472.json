{"id": 8913, "wybug_id": "wooyun-2015-0122472", "wybug_title": "饿了么某系统绕过防护继续注入到进入多个系统(OA/邮箱/ehr/wiki/费控等)", "wybug_corp": "饿了么", "wybug_author": "蓝冰", "wybug_date": "2015-06-24 14:52", "wybug_open_date": "2015-08-07 09:57", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-07：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 求礼物 么么嗒 详细说明：  首先突破点是OA系统http://fast.ele.me/用的泛微的系统原先的上传注入都补了,抱着怀疑的态度继续尝试了之前爆过的注入点,发现了一些蛛丝马迹http://fast.ele.me/homepage/LoginHomepage.jsp?hpid=11&isfromportal=1提交 11-1e0返回正常 提交 11 and 1=1弹出非法字符由此可知并没有对hpid参数进行int()转换而是 加了过滤,不断尝试后发现/**/and/**/1=1可以绕过\n\n奇怪的是当写这篇报告的时候发现 貌似防护又没了 直接提交 and 1=1 也返回正常 不懂...同理 http://fast.ele.me:89/login.do 移动端的登录框POST也可以注入然后就是注出用户密码并登录,但是对所有用户开启了短信动态密码验证,猜测没有对sysadmin默认管理员开启 于是注出sysadmin的密码破解登录之\n\n然后就是从OA撞各个系统的密码了邮箱\n\n\n\nehr\n\nwiki\n\n也开启了动态验证 暂时没什么想法 有待研究费用控制系统从邮箱搞到的\n\n身份证可以从OA系统中查看\n\nsso 这个比较蛋疼还是手机认证....\n\n最后........嘿嘿\n\n我也想要嘛~~   漏洞证明：  已证明   修复方案：  修复要彻底~   版权声明：转载请注明来源 蓝冰@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-06-24 15:08 厂商回复： 问题已经确认，感谢你对饿了么安全的关注。 最新状态： 2015-08-07：漏洞已修复，感谢大家对饿了么的关注。  ", "replys": "漏洞评价：\n评论\n     2015-06-24 22:55 |    \t\t叫我阿米 \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:18        | 想好了，就去做，没想好，就去试错)\t\t \n  说好的休息呢！！！！！    \n     2015-06-25 15:15 |    \t\t蓝冰 \t\t\t( 核心白帽子 |\t\t\t        Rank:627 漏洞数:50        | -.-)\t\t \n  @叫我阿米 额呵呵呵呵~    \n     2015-06-26 23:21 |    \t\tucifer \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:52        | 萌萌哒~)\t\t \n  肾上腺激素旺盛，搞得运维都睡不好了。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}