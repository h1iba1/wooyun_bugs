{"id": 48030, "wybug_id": "wooyun-2014-084468", "wybug_title": "中国电信天翼统一积分商户自助平台存在WebDAV写权限漏洞", "wybug_corp": "中国电信", "wybug_author": "covertops", "wybug_date": "2014-11-24 18:11", "wybug_open_date": "2015-01-08 18:12", "wybug_type": "应用配置错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["配置错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-08：\t细节向公众公开  简要描述： 首先说明，并未利用该漏洞获取Webshell，但是可以直接PUT文件上去也是危害比较大的，且天翼平台较重要，故自评为中危5。过程写的详细些，望前辈指导 详细说明：  网站首页：\n\n存在写权限的漏洞目录为http://116.228.55.142:7006/permerchant/首先通过OPTIONS方法探测allow的方法：可以看到并没有PUT或者MOVE方法\n\n但是尝试通过PUT上传文件却成功了。。。：响应中的allow又有了。。\n\n成功访问上传后的文件：\n\n尝试通过MOVE方法，结合IIS6解析漏洞变为可执行，但是发包过去未响应，推测是实际没有开启MOVE方法：\n\n问题来了，这个网站的响应时而开启时而未开启的不知道到底是什么情况。。。望评论指点   漏洞证明：  \n\n   修复方案：  关闭目录的写权限，或者直接禁用WebDAV   版权声明：转载请注明来源 covertops@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-11-28 16:36 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT通报给中国电信集团公司，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-24 18:19 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  是并未还是不能？    \n     2014-11-25 09:10 |    \t\tcovertops \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:23        | wooyun)\t\t \n  @pandas MOVE方法貌似没开，没找到方法getshell    \n     2014-11-25 17:18 |    \t\tcovertops \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:23        | wooyun)\t\t \n  @pandas PUT .jpg的一句话上去成功->201created，且返回包在allow里有PUT和MOVE方法；然后通过MOVE结合解析拿shell，我不知道是MOVE方法构造有错误，还是实际上没有开这个方法，反正就是无响应。而且有的时候OPTIONS过去又没有MOVE方法了，就不知道什么情况了。难道是有负载，然后分配到其它机器上，所以有时成功，有时失败么？求指点    \n     2015-01-08 20:04 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  电信现在居然还有这种洞    \n     2015-01-09 13:58 |    \t\tshe11 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 混个脸熟)\t\t \n  @covertops 可能是web集群，其中一台开启了put和move，每次响应不是同一台    \n     2015-01-09 14:01 |    \t\tcovertops \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:23        | wooyun)\t\t \n  @she11 恩，好像是这个问题，感谢    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}