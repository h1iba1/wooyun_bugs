{"id": 10893, "wybug_id": "wooyun-2013-026658", "wybug_title": "酒美网某站任意用户密码重置", "wybug_corp": "酒美网", "wybug_author": "带馅儿馒头", "wybug_date": "2013-06-22 20:41", "wybug_open_date": "2013-08-06 20:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-06：\t细节向公众公开  简要描述： 听说你们送酒哇！ 详细说明：  \n问题站点：union.winenice.com\n1.注册的时候发现已经有admin账户，也不知道是不是系统的管理员；\n\n2.使用“忘记密码”功能进行密码重置；\n\n3.点击获取验证码并抓包得到如下数据；\nPOST /Handler/RetrievePwdHandler.ashx HTTP/1.1Host: union.winenice.comUser-Agent: Accept: */*Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://union.winenice.com/Help/RetrievePwd_Step2.aspxContent-Length: 16Cookie: Connection: keep-alivePragma: no-cacheCache-Control: no-cachetxt_Mail=&step=5\n4.没有使用邮箱注册，我们就添个邮箱吧，将txt_Mail参数值设为“2xxxxxx@qq.com”并提交，企鹅的邮箱马上就收到邮件了；\n\n5.填入收到的验证码，直接来到密码重置页面；\n\n6.填入新密码即可完成密码重置；\n\n7.使用重置后的密码成功登录；\n\nPS：winenice不知道是不是系统帐号，验证码只有4位，很容易暴力破解哟！   漏洞证明：  见详细说明   修复方案：  严格校验用户身份合法性   版权声明：转载请注明来源 带馅儿馒头@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-06-24 11:47 厂商回复： @带馅儿馒头 3Q洞主,此账户为演示账号,没啥权限,不过依然送出礼品~洞主继续~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-22 22:04 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @xsser  WooYun: 我是如何重置酒美网任意用户密码的  没修不？？    \n     2013-06-23 07:38 |    \t\t熊猫 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:33        | panda)\t\t \n  呼。。又是这样，感觉审核真的。。    \n     2013-06-23 10:54 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:143        | 心在，梦在)\t\t \n  @熊猫 别瞎说，行不，也不自己试下，，，    \n     2013-06-23 11:22 |    \t\t熊猫 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:33        | panda)\t\t \n  @带馅儿馒头  = = 我没说什么呀~~    \n     2013-06-24 12:13 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:143        | 心在，梦在)\t\t \n  @酒美网 我只是拿这个帐号来进行演示，当然其他的帐号一样可以搞定，你说呢：）    \n     2013-08-07 09:17 |    \t\tsoftbug \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:10        | 为人类设计最好的软件，解放人的双手,一起...)\t\t \n  厂商态度不错，值得表扬    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}