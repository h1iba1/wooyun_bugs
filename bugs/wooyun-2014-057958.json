{"id": 4505, "wybug_id": "wooyun-2014-057958", "wybug_title": "科讯KESION CMS最新版任意文件上传WEBSHELL", "wybug_corp": "kesion.com", "wybug_author": "小恒", "wybug_date": "2014-04-25 12:36", "wybug_open_date": "2014-04-30 12:37", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["上传漏洞", "科讯"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 最新版本上传漏洞哦^_^ 详细说明：  会员上传文件漏洞，可以上传任意后缀user/swfupload.asp文件漏洞If UpFileObj.Form(\"NoReName\")=\"1\" Then  '不更名Dim PhysicalPath,FsoObj:Set FsoObj = KS.InitialObject(KS.Setting(99))PhysicalPath = Server.MapPath(replace(TempFileStr,\"|\",\"\"))TempFileStr= mid(TempFileStr,1, InStrRev(TempFileStr, \"/\")) &  FileTitlesIf FsoObj.FileExists(PhysicalPath)=true ThenFsoObj.MoveFile PhysicalPath,server.MapPath(TempFileStr)End IfEnd If会员注册登录后，手工构造一NoReName参数即可上传自定义文件名绕过危险代码可以用<!--#include file=\"\"-->类型来包含图片即可，可以用远程下载或者修改/user/User_Blog.asp?action=BlogEdit里的LOGO文件来上传代码文件（不检查危险代码的哦）    漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  过滤。。。   版权声明：转载请注明来源 小恒@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-04-30 12:37 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-25 17:31 |    \t\tLet a person cry. \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:9        | xxoo)\t\t \n  前排坐等.可以留邮箱不,哈哈    \n     2014-04-30 14:01 |    \t\tieasyi \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  中排跟上。    \n     2014-04-30 18:16 |    \t\tAnnabelle \t\t\t( 实习白帽子  |\t\t\t        Rank:46 漏洞数:15        | .)\t\t \n  后排接力    \n     2014-04-30 19:03 |    \t\topen \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:5        | ;alert('robert');//)\t\t \n  测试了下，好像触发的都是swfupload.swf而不是user/swfupload.asp。。。    \n     2014-05-02 17:36 |    \t\t小恒 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:2        | 黑夜中……跟雨捉迷藏)\t\t \n  真不负责，补丁出来了都忽略    \n     2014-05-07 16:08 |    \t\t风的传奇 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | 没有什么了不起，混迹于茫茫网络而已。)\t\t \n  exp    \n     2014-08-05 21:30 |    \t\t小小泥娃 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | 高二)\t\t \n  加了NoReName后提示文件过大？    \n     2014-08-05 22:04 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  kesion ICMS那个漏洞和这个是一个原理    \n     2014-08-06 09:40 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  ..Mark    \n     2015-03-08 22:21 |    \t\t写个七 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 一点一点积累。)\t\t \n  。。。。。。。。。。   老漏洞了    \n     2015-03-22 08:59 |    \t\t小清新 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 以后再写)\t\t \n  明明补上了   却忽略  太没责任心了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}