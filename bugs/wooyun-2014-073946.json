{"id": 51613, "wybug_id": "wooyun-2014-073946", "wybug_title": "百利网漏洞集合", "wybug_corp": "xabaili.com", "wybug_author": "蓝冰", "wybug_date": "2014-08-27 11:18", "wybug_open_date": "2014-09-01 11:20", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 为什么没通过呢 http://www.wooyun.org/bugs/wooyun-2010-028736的确有这个厂商啊 花了大半天时间去检测的 T_T这回把漏洞扩大了 集合 还是不通过那就算了去数据库看了下 的确小提个建议 要是觉得厂商小的话 那就T掉就好了嘛 明明有这个厂商的信息啊 我个菜鸟花大把时间去检测 不是想得到这种结果的 详细说明：  #1设计缺陷导致重置密码点开找回密码页面 选择找回方式为手机 \n\n \n\n 发送验证手机转到重置密码页面 审查元素 找到发送给手机的4位随机数字 \n\n 最后重置成功 \n\n 手机版站点同样存在该问题 http://m.xabaili.com \n\n 注册的时候需要用手机号注册 危害大#2 sql注入导致获取webshell问题页面：http://m.xabaili.com/shop/detail.php?goods_id=80root权限 可读可写web物理路径 在这里泄露了 http://webmail.xabaili.com/index.php\n\n成功导出 连接菜刀\n\n#3邮箱服务器信息泄露导致 获取数据库权限http://mail.xabaili.com/update/ 目录权限不严格导致泄露其中 mail_path.sh 泄露了数据库信息#!/bin/bash#last update at 2014-3-12mysql -uroot -pwest263mysqlisgood -e \"use vpopmail;alter table vpopmail add counts int(11) NULL DEFAULT 0;\"mysql -uroot -pwest263mysqlisgood -e \"use vpopmail;alter table vpopmail add islock int(11) NULL DEFAULT 0;\"mysql -uroot -pwest263mysqlisgood -e \"use vpopmail;alter table vpopmail add userislock int(11) NULL DEFAULT 0;\"mysql -uroot -pwest263mysqlisgood -e \"use vpopmail;alter table vpopmail add retrycounts int(20) NULL DEFAULT 0;\"mysql -uroot -pwest263mysqlisgood -e \"use vpopmail;alter table vpopmail add retryfailurecounts int(20) NULL DEFAULT 0;\"mysql -uroot -pwest263mysqlisgood -e \"use vpopmail;alter table vpopmail add totalmailcounts int(20) NULL DEFAULT 0;\"mysql -uroot -pwest263mysqlisgood -e \"use vpopmail;alter table vpopmail add yesterdaycounts int(11) NULL DEFAULT 0;\"mysql -uroot -pwest263mysqlisgood -e \"use vpopmail;alter table send_logs add result varchar(5000) NOT NULL DEFAULT '';\"mysql -uroot -pwest263mysqlisgood -e \"alter table vpopmail.vpopmail modify netdisk int(11) DEFAULT 500;\"mysql -uroot -pwest263mysqlisgood -e \"use vpopmail;update vpopmail set pw_gid=2048 where pw_name='postmaster';\"echo '#!/bin/shqmailctl stopkillall -9 svscankillall -9 supervisekillall -9 qmail-sendkillall -9 qmail-remotekillall -9 /var/qmail/bin/qmail-smtpdkillall -9 /var/qmail/bin/qmail-popupkillall -9 /var/qmail/bin/qmail-pop3dkillall -9 /usr/bin/tcpserver'>/root/killqmail.shchmod 705  /home/vpopmailcd ~wget ftp://west263down:west264down@61.139.126.12/wwwroot/mail/text.tar.gztar zxf /root/text.tar.gz -C /VER=`uname -m`远程连接mysql数据库\n\n   漏洞证明：  已证明   修复方案：  0.0   版权声明：转载请注明来源 蓝冰@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-09-01 11:20 厂商回复：  最新状态： 2014-09-02：我司已确认漏洞，正在努力修复。感谢蓝冰！  ", "replys": "漏洞评价：\n评论\n     2014-09-01 10:30 |    \t\t蓝冰 \t\t\t( 核心白帽子 |\t\t\t        Rank:627 漏洞数:50        | -.-)\t\t \n  又要忽略了 哦～no T_T    \n     2014-09-02 11:33 |    \t\t蓝冰 \t\t\t( 核心白帽子 |\t\t\t        Rank:627 漏洞数:50        | -.-)\t\t \n  确认晚了哦 　rank都没有 T_T    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}