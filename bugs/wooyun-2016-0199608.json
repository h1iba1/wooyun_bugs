{"id": 87544, "wybug_id": "wooyun-2016-0199608", "wybug_title": "中国铁塔公司某系统漏洞打包(可控制332台发票机工作)                                      ", "wybug_corp": "chinatowercom.com", "wybug_author": "路人甲", "wybug_date": "2016-04-23 12:32", "wybug_open_date": "2016-06-08 02:50", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程命令执行", "弱口令"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-08：\t细节向公众公开  简要描述： 涉及发票内容 详细说明：  \nhttp://123.126.34.179:7002/login\n中国铁塔股份有限公司的发票管理系统#1 使用的是weblogic，存在命令执行，得到shell\nhttp://123.126.34.179:7002/cmd.jsp\n可以看到在15年下半年就已经被入侵了，应该是得到了weblogic的后台密码\n\n经过测试发现后台存在弱口令weblogic/weblogic123\n\n得到数据库配置信息，数据库用户名密码相同\njdbc:oracle:thin:@(DESCRIPTION =(load_balance=off)(failover=on)(ADDRESS = (PROTOCOL = TCP)(Host = 192.168.19.233)(Port = 1521))(ADDRESS = (PROTOCOL = TCP)(Host = 192.168.19.234)(Port = 1521))(CONNECT_DATA = (SERVICE_NAME = imsdb)(FAILOVER_MODE = (BACKUP = imsdb2)(TYPE = SESSION)(METHOD = BASIC))))xxfp/xxfp\n\n\n   漏洞证明：  #2 后台弱口令\nhttp://123.126.34.179:7002/login\n没有验证码，可以爆破，得到管理员密码admin/Abc123,登陆管理后台，找到了用户管理，导出来，进一步爆破，得到一大批弱口令用户20多个分公司的750多个用户，导出来\n\n\n\n\n\n可是都是一般职员的账号，没有更大的权限，还得从数据库里面找，用户名有700多个，与数据库对应的大约有三个，依次试试\n\n\n\n用户名0000，但是属性是admin，应该就是他了，登陆查看，既可以管理用户，又可以查看发票数据\n\n\n\n\n\n开票监控，目前在线61台\n\n开票机控制，总共332台，可以对开票机参数修改，并可控制开关\n\n\n\n\n\n7000多次开票记录，感觉不应该这么少啊，不过数据还是蛮大的，千万级别的数据\n\n\n\n   修复方案：  打补丁，改密码，清除马   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-04-24 02:46 厂商回复： 感谢支持，紧急修复中 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-23 20:22 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:883 漏洞数:181        )\t\t \n  发票机66666    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}