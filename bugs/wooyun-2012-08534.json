{"id": 18615, "wybug_id": "wooyun-2012-08534", "wybug_title": "湖北省企业投资项目备案系统SQL注入漏洞，致服务器沦陷，大量数据危险", "wybug_corp": "湖北省发改委", "wybug_author": "adwin", "wybug_date": "2012-06-20 11:40", "wybug_open_date": "2012-08-04 11:41", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射", "设计不当导致攻击界面扩大", "服务器配置失误", "服务器配置不当", "数据库账户权限过高", "任意文件写入利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-04：\t细节向公众公开  简要描述： 湖北省企业投资项目备案系统出现SQL注入漏洞，MSSQL，SA权限，显错模式，一路进入服务器如履平地，最后发现服务器上还有大量数据，其中不乏一些企业的信息（就是偷偷瞄一眼，没敢看，没敢动...） 详细说明：  http://www.hbinvest.gov.cn/prws/display.aspx?transtr=420000A1A7A17AA18A37A29&newsid=2635本来newsid这个参数是在前面的，transtr参数在后面，transtr参数不知道是干啥的，反正不能注入，可是newsid这个参数出现注入了，还是显错模式。为了放在工具里面跑比较方便，我就把newsid这个参数放在后面了...\n\nSA，权限不小，不出意外的话可以直接写shell了。显错模式下得到web路径显然就很简单了。\n\npangolin下尝试使用log backup和sp_makewebtask写文件，结果不能创建临时表，不过可以换换别的方式写，比如用啊D\n\n直接写入成功webshell里查看web.config的源码直接拿到sa的密码，然后...权限实在是太大了，见所未见，webshell里面就直接可以全盘浏览了。服务器里不少数据什么的（备份好多...），貌似还有一些企业的信息什么的（只是偷偷瞄一小下，具体都有啥我也没看...）\n\n\n\n\n\n   漏洞证明：  \n\n\n\n\n\n   修复方案：  过滤注入，降权   版权声明：转载请注明来源 adwin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2012-06-21 10:27 厂商回复： CNVD确认漏洞并复现所述部分情况，转由CNCERT湖北分中心协调涉事单位处置。对漏洞评分如下：CVSS：(AV:R/AC:L/Au:NR/C:C/A:P/I:C/B:N) score:9.67（最高10分，高危）即：远程攻击、攻击难度低、不需要用户认证，对机密性、完整性构成完全影响，对可用性构成部分影响。技术难度系数：1.0影响危害系数：1.3（较严重，涉及省厅级政府部门业务系统，构成信息泄露和运行安全风险）CNVD综合评分：9.67*1.0*1.3=12.571 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-20 12:17 |    \t\t斯文的鸡蛋 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:41        | 我在这头，你在那头~)\t\t \n  建议洞主以后发表洞洞的时候能加码，嗯嗯~就这样    \n     2012-06-20 13:46 |    \t\trootsecurity \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:20        | 关注开源，关注网络安全！INSERT INTO `w...)\t\t \n  这种什么什么委，估计没管的。里面都是一帮吃闲饭的。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}