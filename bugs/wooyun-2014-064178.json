{"id": 2710, "wybug_id": "wooyun-2014-064178", "wybug_title": "友情测试科大讯飞系统#7（呵呵，再忽略以后就不会提了）", "wybug_corp": "iflytek.com", "wybug_author": "无力落地の白", "wybug_date": "2014-06-09 15:38", "wybug_open_date": "2014-07-24 15:40", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-24：\t细节向公众公开  简要描述： 进入www.iflytek.com内网中。 详细说明：    先让我用个暴漫表达下我的心情。\n\n开讲：之前进了你们好多分站，你们表示很淡定，所以我立志要进主站内网。所以我的目标定到了www.iflytek.com。 主站不过DNS域传送的漏洞，相信提了你们也会忽略，但是在这说下，你们自己让技术人员学习下。学习链接：http://www.wooyun.org/searchbug.php?q=DNS%E5%9F%9F%E4%BC%A0%E9%80%81\n\n  还是从主站入手，查查主站的旁站。\n\n看到上面图 红色的网站。安徽省工商联。 其实我不大明白这个和讯飞有什么关联，但是经过ping，确定确实用了同一个公网ip。目测他们是你的客户？（入侵是从这里的开始的，后面我会证明这和讯飞有很大关系，要是你真的觉得和讯飞没有关系，那就把这个漏洞转给cncert ，而你也千万别修复，让工商联修复，好嘛？  ^ ^） 漏洞点：http://www.ahgcc.cn/siteserver/   siteserver3.5存在某漏洞，可以登录后台。上传shell，shell地址http://www.ahgcc.cn/sitefiles/temporaryfiles/contents/iis.aspx\n\n  具体什么漏洞，想知道的话就私信告诉你把，目测你们不感兴趣  哎，你们就当弱口令出来吧。。拿到shell了以后 我们干嘛呢？ 提权吗？权限确实不高。Argument: whoamiiis apppool\\ahgcc.cn怎么提呢？ 本地溢出？目测2003还能秒杀了。然是systeminfo 看了一下  win2008  r2  X64   好家伙，我哪有这EXP啊。 数据库提权？ netstat -an 一下  没有一个跟数据库相关的端口。 原来站库分离啊。来看看web.config\n\nserver=192.168.75.66;uid=sa;pwd=iflytek;database=ahgcc_new终于，找到和讯飞的联系了，如果不是你们维护的，密码不应该这样吧？192.168.75.66这台服务器有了sa权限，那么提权不就so easy的事情么。可以看到很多数据库：\n\n可以执行系统命令：\n\n别担心，未做破坏性动作。小结一下：到现在我们拿到了http://www.ahgcc.cn  内网ip（192.168.75.61）的webshell（权限较低） 和内网另外一台数据库服务器的system权限。接下来，我们继续挖掘。查看这台服务器上还有哪些网站。\n\n可以看出来，应该都是讯飞的客户。再看看每个网站的web.config文件我就不截图 直接贴出来啦server=192.168.82.188;User ID=devil;Password=devil;database=StatisticSystemserver=192.168.75.66;User ID=sa;Password=iflytek;database=IEPSserver=192.168.75.88;uid=sa;pwd=gf910)YZ;database=siteserverserver=192.168.75.66;uid=sa;pwd=gf910)YZ;database=huishang_gov这样  理论上 又有两台服务器被攻破了，是不是？哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈哈其实前面都是铺垫。因为我的目标是www.iflytek.comshowtime  机智的少年：\n\n看到没。直接返回了 www.iflytek.com 的内网ip。192.168.75.28到这 如果厂家还认为和讯飞无关的话，那就忽略吧 。。感觉不会再爱了。 再看思路要渗透192.168.75.28 内网渗透肯定会简单很多，当然，我只是有一个shell做跳板，最好的 当然是获得个远程登录的跳板机，思路还是先提权入口服务器。http://www.ahgcc.cn oh yeah  发现FZ。\n\n利用FZ提权。由于FZ在内网中，利用portmap端口转发14147  然后远程连接上去，添加 test账号 共享C盘。\n\n准备端口转发出21号，端口，但应该是不可以的。当我满心欢喜 ，公网ip 60.166.12.119 开放了21号端口时，却发现好像被。。。墙了。。当当当。各位看官，到此结束啦，其实木有提权成功啦。  也不敢再继续深入下去了，怕讯飞找我喝茶啊。。。。   漏洞证明：     上面说的很详细。我觉得挺危险的。\n\n   修复方案：  1. 删除后门，防止删的不全，可以用工具扫描。比方说D盾。上次提供给你们了。2. 升级siteserver到最新。（其实我也不知道最新是不是安全的。）3。 修改各个密码。4.给辛苦的白帽子个小礼物吧。。。听说讯飞有很多产品 啊  哇哈哈   版权声明：转载请注明来源 无力落地の白@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-06-10 17:24 厂商回复： 你好！感谢你的支持。漏洞我们已经重现并确认，目前已经安排修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-09 15:40 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  看了下这厂商 很装x的回复~    \n     2014-06-09 15:40 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  忽略的欢迎找乌云补    \n     2014-06-09 15:41 |    \t\t计算姬 \t\t\t( 普通白帽子  |\t\t\t        Rank:398 漏洞数:90        | 看我看我看我啊)\t\t \n  HR姐姐倒还是不错    \n     2014-06-09 15:42 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  @xsser http://wooyun.org/bugs/wooyun-2014-061396  http://wooyun.org/bugs/wooyun-2014-061965  http://wooyun.org/bugs/wooyun-2014-061388  http://wooyun.org/bugs/wooyun-2014-061549    \n     2014-06-09 15:45 |    \t\t无力落地の白 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:19        | 新人)\t\t \n  @xsser come  baby 怎么补。 你看看 我之前友情测试系列 #1 到#4 看看值不值得补？反正洞洞是修补了。还有 #5忘记登录就发了  好尴尬。能纳到我这个ID么？  WooYun: 友情测试科大讯飞已入内网#5      剑心大人 大人 大大人！明察！！秋毫！！    \n     2014-06-09 15:45 |    \t\t无力落地の白 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:19        | 新人)\t\t \n  @计算姬 前台很漂亮。。。。。    \n     2014-06-09 15:50 |    \t\t计算姬 \t\t\t( 普通白帽子  |\t\t\t        Rank:398 漏洞数:90        | 看我看我看我啊)\t\t \n  @无力落地の白 没见过啊。po个图啊    \n     2014-06-09 20:04 |    \t\t无力落地の白 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:19        | 新人)\t\t \n  @xsser 厂商找我要联系方式送礼物 不会要社工我吧？ = = 能给么    \n     2014-06-09 20:43 |    \t\t小怿 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:6        | )\t\t \n  @乐乐、  确实啊。。既然问题存在，因为他们自己未及时确认导致忽略然后细节公开公众了，还抱歉白帽子。。    \n     2014-06-10 15:32 |    \t\t那个夏天骚年未老 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 呵呵，呵，呵呵呵)\t\t \n  面试的机会都不给，尼玛人家就要211 985    \n     2014-06-11 10:13 |    \t\tzinrokh \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:1        | 某安全公司小土鳖一只)\t\t \n  X飞的安全专家 都是用阿d，穿山甲之类的大牛 ~    \n     2014-06-11 10:25 |    \t\t计算姬 \t\t\t( 普通白帽子  |\t\t\t        Rank:398 漏洞数:90        | 看我看我看我啊)\t\t \n  @那个夏天骚年未老 人家是上市公司，门槛肯定要高啊。不过安全做的不好就是他们的错了    \n     2014-07-24 16:18 |    \t\tCoffeeSafe \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:37        )\t\t \n  真的很讨厌那些不重视漏洞的厂商~ 真恶心！     \n     2014-07-24 16:39 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @无力落地の白 看了前面的，貌似你提交的狠多都被忽略了，真悲剧啊，加个qq号吧    \n     2014-07-24 17:15 |    \t\t无力落地の白 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:19        | 新人)\t\t \n  @CoffeeSafe - -#    \n     2014-07-25 10:58 |    \t\ttodaro \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:12        | 完结。)\t\t \n  大神带我如何。。。。。    \n     2014-07-25 12:50 |    \t\t无力落地の白 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:19        | 新人)\t\t \n  @todaro 菜鸡一枚    \n     2014-07-25 17:29 |    \t\ttodaro \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:12        | 完结。)\t\t \n  @无力落地の白 yer  完全正确    \n     2014-07-25 17:32 |    \t\ttodaro \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:12        | 完结。)\t\t \n  @无力落地の白 哎 我操  我以为你说我，如果是说我 完全正确，但是与你就不是这样了！！    \n     2014-07-25 22:46 |    \t\t无力落地の白 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:19        | 新人)\t\t \n  @todaro 哈哈 我是我是    \n     2014-08-19 02:25 |    \t\t_July \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | - 你是猴子请来的逗逼么.)\t\t \n  求siteserver漏洞！！！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}