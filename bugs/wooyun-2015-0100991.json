{"id": 36846, "wybug_id": "wooyun-2015-0100991", "wybug_title": "PHPEMS多处存在水平权限问题", "wybug_corp": "PHPEMS", "wybug_author": "路人甲", "wybug_date": "2015-03-12 18:50", "wybug_open_date": "2015-04-30 18:48", "wybug_type": "非授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["越权操作"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-12：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-04-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： PHPEMS多处存在水平权限问题 详细说明：  7.多处逻辑漏洞导致平行权限问题Phems中多处存在平行权限问题，因为要杜绝这个问题必须每次数据库操作都要带上_session[user]但是phems的程序员却非常不配合，导致了多处存在平行权限的问题，我查阅了/app/exam/app.php这一页代码，给出具体出现的问题如下1.2108行附近//删除一个错题记录//            平行权限漏洞case 'delrecord':$recordid = $this->ev->get('questionid');$this->favor->delRecord($recordid);危害：可以用来删除任意人的错题记录2.2120行附近$ehid = $this->ev->get('ehid');               //平行权限漏洞$eh = $this->favor->getExamHistoryById($ehid);危害：可以查看任意人的错题历史记录3. 2173行附近$favorid = $this->ev->get('questionid');$this->favor->delFavorById($favorid);危害：可以删除任意人的收藏记录4. 2267行附近$eh = $this->favor->getExamHistoryById($ehid);$questype = $this->basic->getQuestypeList();危害：可以查看任意人的历史记录列表5.2284行附近$ehid = $this->ev->get('ehid');$eh = $this->favor->getExamHistoryById($ehid);危害：可以查看任意人的历史记录列表6.2300行附近$ehid = $this->ev->get('ehid');$eh = $this->favor->getExamHistoryById($ehid);危害：可以查看任意人的历史记录列表验证，理论上是没有问题的，问题是我安装系统的时候乱码，加之该想法在之前提交的论文中有验证，就不叙述了，注意下改了就好/app/exam/Phone.php、/app/exam/teacher.php中也存在大量越权操作，实在太多，不多列举了   漏洞证明：  因为网页乱码，不知道运行逻辑，但是漏洞肯定是没有问题的！验证的话不太好演示，就是查看别人，删除内容。。   修复方案：  增加_session[username]验证   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}