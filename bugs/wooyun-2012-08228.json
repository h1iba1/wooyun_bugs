{"id": 18762, "wybug_id": "wooyun-2012-08228", "wybug_title": "安帮网上传资料页面提交验证时过滤不良导致post型注入", "wybug_corp": "北京谷安天下科技有限公司", "wybug_author": "HelloKitty", "wybug_date": "2012-06-13 23:03", "wybug_open_date": "2012-07-28 23:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-28：\t细节向公众公开  简要描述： 安帮网，在共享资料的时候，点击提交时，需要进行一次post验证，此处过滤不良导致sql注入并能窃取所有用户数据资料 详细说明：  今天收到一个邀请，让我加入神马信息安全我帮您的一个专业网站。进去一看，里面各种神牛啊！！从本科信息安全专业到信息安全工程师，资料应有尽有，是一个专业指导信息安全的网站。这里当然也推荐大家没事去看看共享个资料神马的。接着就对这个网站进行了一次渗透，php的，URL不显示后缀，目测get注入不能成功。正在纠结于上传资料那个地方，看能不能直接上传脚本。。传上去了php的，但是不能获得路径。在抓包过程中突然发现，再点击上传那个按钮后竟然还有进行一次post验证。无意识地把抓来的包放进sqlmap，OK，vulnerable！后来还发现，网站中貌似有一个页面存在xss。页面如下：http://www.sec580.com/index.php?app=home&mod=Public&act=tags_result&tag=%58%53%53%C2%A9%B6%B4%DF%E3%A3%BF不过我修改了参数以后发现出现了404页面，估计是防火墙，当然也有可能是本人才疏学浅。就这样，求个邀请码。嘿嘿。   漏洞证明：  这是我抓的包：\n\nsqlmap提示可以注入：\n\n获取到数据库名：\n\n不想再接着渗透了，找不到后台地址。就这样一个sql注入点就可以dump数据了。。想一想，中国从事信息安全专业的人员的数据。。嘿嘿…   修复方案：  建议验证post包时进行参数验证。   版权声明：转载请注明来源 HelloKitty@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2012-06-13 23:19 厂商回复： 添加对漏洞的补充说明以及做出评价的理由 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-04 16:39 |    \t\tAsuimu \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:46        )\t\t \n  目视有点像 thinksns 程序~~    \n     2012-07-29 01:04 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @Asuimu YES    \n     2012-07-29 09:29 |    \t\t神刀 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:3        | www.shellsec.com内射那么牛，虾米没妹子？)\t\t \n  thinkphp    \n     2012-07-29 11:49 |    \t\tHelloKitty \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | The quieter you became,the more you are ...)\t\t \n  @神刀 是thinkphp？那这算0day咩？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}