{"id": 12141, "wybug_id": "wooyun-2013-022973", "wybug_title": "160W+中国造血干细胞捐献者资料总库可被渗透（马伊俐，厉娜，温兆伦等明星继续中枪）", "wybug_corp": "中国红十字会", "wybug_author": "Z-0ne", "wybug_date": "2013-05-03 10:14", "wybug_open_date": "2013-06-17 10:14", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["渗透测试思路", "安全意识不足", "用户敏感信息泄露", "内部系统对外"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-17：\t细节向公众公开  简要描述： 上次那10W+只是一个地区分库的资料，这次讲讲如何渗透到总库的，160W+个人详细资料，HLA配型资料等，不多说，大家都懂的继上一批王小丫，鞠萍等捐献及个人详细资料泄露，这次所有人可全悲剧了关于中国造血干细胞捐献者资料库http://baike.baidu.com/view/3172925.htm新闻连接http://news.baidu.com/ns?word=%D6%D0%BB%AA%B9%C7%CB%E8%BF%E2&tn=news话说要带上几个公众人物才有影响力么？，→_→ 总之一切有图有真相  详细说明：  涉事地址将通过私信抄送cncert0,获取到总库WEB管理地址后首先尝试admin,user,test,0001,bj,china等等等等账户以及多种常规密码组合，结果未果\n\n1,这里一番折腾后突然想到了分库中的用户命名规则一般是姓名拼音第一个字母的缩写或者是直接姓名或地区的缩写，想一想总库上面可能同样也是如此，然后对骨髓库的领导百度了一把，如图\n\n2,在使用百度到的领导拼音缩写作为用户名，用弱口令尝试了几次，成功登录，不过权限显然只是某个分库的负责人，如图\n\n3,在上图发现了可爱的eWebEditor，顺手看了一下源码，找到路径加上login.jsp,后台就出来了，使用admin/admin成功登录\n\n\n\n4，通过修改图片的上传类型，解除对上传文件的限制，连接上模板......./eWebEditor/ewebeditor.jsp?id=content&style=full,成功上传shell\n\n\n\n\n\n\n\n5，目标使用oracle库站分离，获取到数据库的信息后使用oracle连接工具成功连接到了数据库，首先SELECT * FROM USER_TABLES查看了一下用户表的情况，表的数量比较庞大，不过发现了某些表的NUM_ROWS高达160W+，进而确认了捐献者资料存放表的位置\n\n6，select count(*) from TB_VOLU_DATA 计算了一下行数，又用SELECT * FROM TB_USER where USER_NAME = 'admin'，获取了管理员的未加密密码\n\n\n\n7，以管理员身份成功登录总库系统，确认查询功能，以及库中捐献者资料\n\n   漏洞证明：  \n\n\n\n\n\n\n\n\n\n   修复方案：  完整阉割第三方编辑器上传目录禁止脚本执行加强安全意识修改所有弱口令用户密码   版权声明：转载请注明来源 Z-0ne@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2013-05-07 22:21 厂商回复： CNVD确认并复现所述情况，终于在7日下午通过公开联系渠道联系上网站管理方负责人老师，已对漏洞情况进行预警。按信息泄露风险进行评估，rank 18 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-03 11:05 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  这几个不算明星吧    \n     2013-05-03 11:49 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  @xsser 有几张图露点了，加了一下码，麻烦审核一下，thx! PS：你知道的太多了 = =！    \n     2013-05-03 14:06 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  @xsser 算几线？    \n     2013-05-04 01:14 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:6        )\t\t \n  这。。。。。    \n     2013-05-08 09:38 |    \t\twinsyk \t\t\t( 普通白帽子  |\t\t\t        Rank:108 漏洞数:16        | 越长大越孤单)\t\t \n  底线。。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}