{"id": 22086, "wybug_id": "wooyun-2011-02849", "wybug_title": "新浪微博跨域劫持漏洞", "wybug_corp": "新浪", "wybug_author": "rayh4c", "wybug_date": "2011-09-21 18:44", "wybug_open_date": "2011-10-21 18:44", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["劫持"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-09-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-09-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-10-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-10-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-10-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-10-21：\t细节向公众公开  简要描述： 新浪微博的一个接口存在跨域劫持漏洞，可以使用该接口使用微博的一些重要功能。 详细说明：  新版微博的IM功能接口存在安全隐患，未防止json劫持，同时设置了Access- Control-Allow-Origin：*，导致支持HTML5的浏览器可以任意跨域AJAX操作该接口。   漏洞证明：  1.通过固定的URL获取JSON数据中的clientidhttp://3.58.web1.im.weibo.com/im?message=%5B%7B%22version%22%3A%221.0%22%2C%22minimumVersion%22%3A%220.9%22%2C%22channel%22%3A%22%2Fmeta%2Fhandshake%22%2C%22supportedConnectionTypes%22%3A%7B%220%22%3A%22callback-polling%22%7D%2C%22id%22%3A1%7D%5D&jsonp=parent.org.cometd.script._callback1&1316600927500http://3.58.web1.im.weibo.com/im?message=[{\"version\":\"1.0\",\"minimumVersion\":\"0.9\",\"channel\":\"/meta/handshake\",\"supportedConnectionTypes\":{\"0\":\"callback-polling\"},\"id\":1}]&jsonp=parent.org.cometd.script._callback1&13166009275002.然后即可根据clientid构造请求参数，获取聊天记录或群发私信。\n\n   修复方案：  1.获取clientid的URL加入随机token2.Access- Control-Allow-Origin跨域设置设定新浪信任的服务器3.json数据格式的头部加入while(1)，防止JSON劫持。   版权声明：转载请注明来源 rayh4c@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2011-09-22 10:49 厂商回复： 多谢提供 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-09-21 22:42 |    \t\t犯罪嫌疑猪 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 也暂无)\t\t \n  坐等围观    \n     2011-09-21 22:50 |    \t\tQQ852451559 \t\t\t( 实习白帽子  |\t\t\t        Rank:79 漏洞数:18        | 学生党)\t\t \n  等待真相。    \n     2011-09-22 00:58 |    \t\tzhuowater \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 程序员一枚，求妹子一枚)\t\t \n  围观茄子    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}