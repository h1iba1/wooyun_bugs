{"id": 19451, "wybug_id": "wooyun-2012-07057", "wybug_title": "sohu svn 一个pmis系统任意文件上传", "wybug_corp": "搜狐", "wybug_author": "我了个去", "wybug_date": "2012-05-13 17:22", "wybug_open_date": "2012-06-27 17:23", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-05-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-06-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-06-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-06-27：\t细节向公众公开  简要描述：   RT,虽然是一个小洞，但后期可开发性很强，去年就发现了，当时一直没时间开发，往外扔过一次，随后就被一些人挂页了，后来黑页被删了，我想运维也该知道是哪的问题了，于是也就没管，今天好奇上来看看，发现shell还在，漏洞没补，可能是木有意识到危害性吧，好吧，那么俺就小show一下，本来打算慢慢玩的，但由于一是实在没时间，二是自从我第一次扔出来后，没想到已经有人在搞了，现在估计快成马场了，ok ,fllow me ,come on ~ 详细说明：  罪恶的源头http://svn.go.sohu.com/pmis/factory/\n\n没什么可解释的吧，直接上传任意文件   漏洞证明：  拿到shellhttp://svn.go.sohu.com/photo/2010/intel-ideas/11-11-04/2010.php\n\n可反弹shell，执行命令，下面是去年用nmap扫描网段中机器的一小部分：# Nmap 4.11 scan initiated Thu Nov 24 21:57:13 2011 as: nmap -o test.xml -sTV 10.11.5.76/24 Interesting ports on 10.11.5.1:Not shown: 1675 closed portsPORT     STATE SERVICE       VERSION135/tcp  open  msrpc         Microsoft Windows RPC139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds  Microsoft Windows 2003 microsoft-ds1025/tcp open  msrpc         Microsoft Windows RPC3389/tcp open  microsoft-rdp Microsoft Terminal ServiceService Info: OS: WindowsInteresting ports on 10.11.5.5:Not shown: 1672 closed portsPORT     STATE SERVICE          VERSION22/tcp   open  ssh              OpenSSH 4.3 (protocol 1.5)80/tcp   open  http             Apache httpd 2.2.3 ((Red Hat))427/tcp  open  tcpwrapped873/tcp  open  rsync             (protocol version 29)1080/tcp open  http             Apache httpd 2.2.3 ((Red Hat))8009/tcp open  ajp13?8080/tcp open  http             Apache Tomcat/Coyote JSP engine 1.18082/tcp open  blackice-alerts?Interesting ports on 10.11.5.19:Not shown: 1673 closed portsPORT     STATE SERVICE VERSION21/tcp   open  ftp     ProFTPD 1.3.0rc522/tcp   open  ssh     SCS sshd 1.2.33 (protocol 1.5)25/tcp   open  smtp    Sendmail 8.12.11.20060308/8.12.1180/tcp   open  http    Apache httpd 1.3.34 ((Unix) Resin/2.1.17)199/tcp  open  smux    Linux SNMP multiplexer2301/tcp open  http    HP Proliant System Management 2.1.7.168 (CompaqHTTPServer 9.9)8080/tcp open  http    Caucho Resin JSP engine 2.1.17Service Info: Host: 5.19; OSs: Unix, LinuxInteresting ports on 10.11.5.20:Not shown: 1669 closed portsPORT     STATE SERVICE       VERSION22/tcp   open  ssh           SCS sshd 1.2.33 (protocol 1.5)81/tcp   open  hosts2-ns?82/tcp   open  xfer?83/tcp   open  mit-ml-dev?84/tcp   open  ctf?85/tcp   open  mit-ml-dev?86/tcp   open  mfcobol?87/tcp   open  priv-term-l?88/tcp   open  kerberos-sec?199/tcp  open  smux          Linux SNMP multiplexer2301/tcp open  http          HP Proliant System Management 2.1.10.186 (CompaqHTTPServer 9.9)Service Info: OS: Linux有windows,linux,用的是hp的pc server ???扫描出来有什么用呢？直接上图吧，不解释了，你懂的\n\n\n\n\n\n内网往往很脆弱，因为他们相信外网的火墙足够的强壮，so 这只是冰山一角，考虑到对中国互联网的尊重，再者俺确实是个良民，所以就不再搞了，防跨，防请喝茶，不过可以适当的给俺送礼物哦亲 -_*   修复方案：    这个....此处省略1w字   版权声明：转载请注明来源 我了个去@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2012-05-15 11:21 厂商回复： thanks 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-13 17:29 |    \t\t我了个去 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:14        | 4892057@qq.com                          ...)\t\t \n  沙发自己坐了，内网好多机器唉，如果给我足够的时间，一顿exp狂溢出    \n     2012-05-13 18:05 |    \t\tSay \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:4        | 谁又会鉴定谁正常？)\t\t \n  @我了个去 好支持顶    \n     2012-06-27 18:05 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  phpcms系统么？    \n     2015-06-01 19:02 |    \t\tSkull \t\t\t( 实习白帽子  |\t\t\t        Rank:95 漏洞数:33        | 菜鸟一枚。)\t\t \n  求php代理文件    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}