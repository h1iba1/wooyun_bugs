{"id": 3869, "wybug_id": "wooyun-2015-0124763", "wybug_title": "乌云社区某删除功能存在CSRF漏洞（简单利用需诱骗管理员触发）", "wybug_corp": "乌云官方", "wybug_author": "phith0n", "wybug_date": "2015-07-06 16:30", "wybug_open_date": "2015-08-20 16:34", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-20：\t细节向公众公开  简要描述： 某漏洞可删帖，不多说了否则被你们一下猜到了么么哒 详细说明：  CSRF删帖，利用十分简单。zone删（回）帖的函数：\nfunction DelComment(commentId){\tif(confirm(\"确定删除此内容?\")){\t\t$.get('/index.php?do=edit&act=delcomment',{\"fun\":\"ajax\",\"id\":commentId,\"r\":Math.random()},function(re){\t\t\t$(\"#commentLi_\"+commentId).remove();\t\t});\t}}\n特征：GET请求，没有Token，也没有验证Referer（验不验证referer不重要，后面有说到）。目标URL：http://zone.wooyun.org/index.php?do=edit&act=delcomment&fun=ajax&id=311946311946即为需要删除的帖子id：\n\n（PS：这个id是可以遍历的，也就是我构造一个页面让剑心访问，可以把zone里的帖子删光、。。逃~）可以任意删帖，但需要有权限的人访问你的页面才行，有点鸡肋。但如果我能构造个更好的利用方法就不鸡肋了。好方法当然是，如果能直接在zone里发贴，管理员或领主浏览帖子以后即可删帖。原本是很简单的，只要我帖子里发一张图片就好。但zone里，如果我发的不是图片就显示不出来：\n\n所以需要变通一下：插入图片地址：http://mhz.pw/test_311951.gif，然后302跳转到http://zone.wooyun.org/index.php?do=edit&act=delcomment&fun=ajax&id=311951即可：\n\n\n\n领主或管理员访问该页面，即可触发，删除目标帖子。   漏洞证明：  见上面。   修复方案：  增加token。验证Referer也是无效的，因为该请求就来自zone.wooyun.org。   版权声明：转载请注明来源 phith0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-07-06 16:32 厂商回复： 漏洞真实存在，感谢\t@phith0n 的细心，我们立刻安排伙伴修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-06 16:33 |    \t\tJumbo \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:29        | 猫 - http://www.chinabaiker.com)\t\t \n  ....然后就可以封号了    \n     2015-07-06 16:36 |    \t\tanswer \t\t\t( 普通白帽子  |\t\t\t        Rank:347 漏洞数:45        | 答案)\t\t \n  ....然后就可以封号了    \n     2015-07-06 16:46 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  ....然后就可以封号了    \n     2015-07-06 16:50 |    \t\t番茄师傅 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:59        | http://www.tomatoyu.com/)\t\t \n  ....然后就可以封号了    \n     2015-07-06 16:54 |    \t\tSunshie \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:10        | http://phpinfo.me)\t\t \n  ....然后就可以封号了    \n     2015-07-06 17:34 |    \t\t大物期末不能挂 \t\t\t( 普通白帽子  |\t\t\t        Rank:132 漏洞数:23        | 1.一个学渣，只求每门都不挂2.想把漏洞提...)\t\t \n  ....然后就可以封号了    \n     2015-07-06 17:38 |    \t\tshlhack‘s bother \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:5        | 大哥是shlhack,二哥是大禹888，lol青铜杀手...)\t\t \n  ....然后就可以封号了     \n     2015-07-06 17:39 |    \t\t鸟云 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 乌云)\t\t \n  ....然后就可以封号了    \n     2015-07-06 17:42 |    \t\t窝窝哥 \t\t\t( 实习白帽子  |\t\t\t        Rank:86 漏洞数:29        | 没WB啊啊啊啊！)\t\t \n  ....然后就可以封号了    \n     2015-07-06 17:47 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  ....然后就可以封号了    \n     2015-07-06 17:52 |    \t\t末影人 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:9        | 末影人(Enderman)是一个三个方格高的人形生...)\t\t \n  ....然后就可以封号了     \n     2015-07-06 17:59 |    \t\tAnnabelle \t\t\t( 实习白帽子  |\t\t\t        Rank:46 漏洞数:15        | .)\t\t \n  专业破坏队形    \n     2015-07-06 18:03 |    \t\t有一种精神叫helen \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:22        )\t\t \n  专业破坏队形    \n     2015-07-06 19:17 |    \t\t晏子 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 无)\t\t \n  ....然后就可以封号了    \n     2015-07-06 19:41 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  ....然后就可以封号了   ----这里是王松，不是Mosuan，我在用Mosuan的号。。。    \n     2015-07-06 22:08 |    \t\tAnonymous.L \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:8        | 最后一位关注xxxx的人 , 孤独之人)\t\t \n  ....然后就可以封号了    \n     2015-07-10 09:12 |    \t\t冰@封 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 凄凄黑夜间，残影舞指间。)\t\t \n  ....然后就可以封号了    \n     2015-07-26 18:10 |    \t\t番茄师傅 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:59        | http://www.tomatoyu.com/)\t\t \n  ....然后就可以封号了     \n     2015-08-06 20:08 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  我的乌云币：27   可用的乌云币：27   冻结的乌云币：0为啥我还是进不去社区    \n     2015-08-06 20:09 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  WB低于5不能进入社区，需要前往主站或知识库共享内容如果长时间没有跳转，请点击这里@疯狗    \n     2015-08-20 17:02 |    \t\tFormat_smile \t\t\t( 普通白帽子  |\t\t\t        Rank:167 漏洞数:67        | ···孰能无过，谁是谁非！渗透穷三代，黑...)\t\t \n  然后就封号了 哈哈    \n     2015-08-21 10:17 |    \t\t3ang \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 风往北吹，你走的好干脆！)\t\t \n  ....然后就可以封号了     \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}