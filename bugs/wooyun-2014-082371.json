{"id": 47074, "wybug_id": "wooyun-2014-082371", "wybug_title": "南大尚城内容管理系统任意用户密码重置漏洞", "wybug_corp": "南大尚城", "wybug_author": "小马", "wybug_date": "2014-11-07 17:51", "wybug_open_date": "2015-02-05 17:52", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-07：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-02-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 南大尚城内容管理系统密码重置漏洞 详细说明：  南大尚城内容管理系统 JCMS  刚开始以为是大汉的呢,结果不是....以下内容摘自官网：江苏南大尚诚高科技集团成立于2006年11月，是一家以自主科技创新为动力、以科技创新型产业为核心 的高科技企业。尚诚集团以国内外知名高校和知名企业为依托，引进吸纳香港上市公司环康集团（股票代码： 8169.HK）、苏高新集团(股票代码：600736)等优质海内外企业成为投资方，具备丰富的文化、技术、市场、 人才、品牌、管理等优质资源，主要从事软件开发......   漏洞证明：  /jcms/User/ResetPass.jsp代码：\n<%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\"%><jsp:directive.page import=\"java.sql.*\"/><jsp:directive.page import=\"com.jcms.beans.DBconnection\"/><jsp:directive.page import=\"com.jcms.beans.Currency\"/><!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\"><html>  <head>    <title>ResetPass.jsp</title>\t<meta http-equiv=\"pragma\" content=\"no-cache\">\t<meta http-equiv=\"cache-control\" content=\"no-cache\">\t<meta http-equiv=\"expires\" content=\"0\">    \t<meta http-equiv=\"keywords\" content=\"keyword1,keyword2,keyword3\">\t<meta http-equiv=\"description\" content=\"This is my page\">\t<link href=\"../Css/base.css\" rel=\"stylesheet\" type=\"text/css\" />  </head>  <body>    <%     String userName = request.getParameter(\"Name\");     String userID = request.getParameter(\"ID\");     if(!\"\".equals(userName)&&!\"\".equals(userID)){  //只判断是否为空      \tDBconnection link=new DBconnection(\"jscms\");     \tConnection db=link.getCon();//初始化数据库连接     \tString md5Passed=Currency.getMD5Code(\"111111\");//对密码进行加密     \tString sql = \"update Admin set PassWord = '\"+md5Passed+\"' where ID=? and UserName=?\";     \ttry{\t     \tPreparedStatement stmt = db.prepareStatement(link.getSql(sql));\t     \tstmt.setInt(1,Integer.parseInt(userID));\t     \tstmt.setString(2,userName);\t     \tstmt.executeUpdate();\t     \tstmt.close();     \t}catch(Exception e){     \t\te.printStackTrace();     \t}finally{     \t\tlink.closeDB();     \t}     }    %>    <script language=\"javascript\">    \talert('初始化密码成功！');    \thistory.back();    </script>\n if(!\"\".equals(userName)&&!\"\".equals(userID)){  只判断了是否为空,不为空的话就update,程序员在坑爹吗....重置后密码为 111111这个由于测试了一个站，莫怪莫怪\n\n\n\n   修复方案：  你们更专业   版权声明：转载请注明来源 小马@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}