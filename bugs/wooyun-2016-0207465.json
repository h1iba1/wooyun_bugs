{"id": 88273, "wybug_id": "wooyun-2016-0207465", "wybug_title": "北京中科恒业某体检中心微信平台存在漏洞可导致大量客户体检报告泄露                                      ", "wybug_corp": "北京中科恒业科技有限公司", "wybug_author": "路人甲", "wybug_date": "2016-05-17 10:11", "wybug_open_date": "2016-07-01 11:40", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(海淀区信息安全等级保护办公室)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["体检中心", "体检报告泄露", "微信平台"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-01：\t细节向公众公开  简要描述： 北京中科恒业运维的某连锁体检中心微信平台通过访问特定url，可以绕过授权，直接访问客户体检报告等敏感信息。 详细说明：  以万佳体检中心为例，通过分析微信平台上面提供的客户自助查询体检报告的功能发现，访问以下特定url，可以绕过权限检查，访问到客户的体检报告，泄露大量客户的体检信息。http://**.**.**.**//hwx/wxrp.aspx?tp=Health_relative_report.aspx&studyid=${客户体检编号}&Tc=130001其中，${客户体检编号}由yyMMdd+四位数字组成。例如：1604200002\n\n此处获取一个有效的cookie值，因为它是永不失效的，所以我们可以一直使用。\n\n抓取了几个万佳体检中心客户的体检报告，基本信息（姓名，体检日期，身高，体重...），注意这是一份很详尽的体检报告，敏感性、危害性都比较大。\n\n   漏洞证明：  通过访问以下url可以绕过权限检查。http://**.**.**.**//hwx/wxrp.aspx?tp=Health_relative_report.aspx&studyid=1604200002&Tc=130001\n\n其中，体检编号可以替换但不仅限于以下：160420019216042001951604200203160420020516042002071604200217160420022316042102331604210234160421023516042102361604210238160421023916042002341604200240160421026516042002571604210271160420026516042002671604200268160420027516042002791604200290160420030216042003091604200319   修复方案：  验证权限，仅限本人访问自己的体检报告。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-05-17 11:38 厂商回复： 已通知厂商处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}