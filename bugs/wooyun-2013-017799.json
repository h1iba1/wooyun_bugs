{"id": 14116, "wybug_id": "wooyun-2013-017799", "wybug_title": "乐淘网任意用户密码重置漏洞", "wybug_corp": "乐淘网", "wybug_author": "小胖子", "wybug_date": "2013-01-24 14:03", "wybug_open_date": "2013-03-10 14:04", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-02-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-10：\t细节向公众公开  简要描述： 有session也不能阻止爆破的节奏。 详细说明：  问题关键点：主站登录处没有次数限制，而且有session限制每个session只能提交10次，后面就失效，貌似是这样滴，所以对于爆破限制很大，溯雪也不能提交表单，只好祭出brup，用户用手机重置密码，这次不是验证码了，直接给密码，4位随机数，让用户登录后修改。这个就给了充足的时间。没仔细研究代码，等下去看看逻辑，不多说，看图。1：主站登录，抓包，看到这样的东西，虽然经过编码，brup还是认出来了。\n\n我尝试在主登录界面来爆破，最终发现提示，没个session只有10次机会，只好作罢。我重置密码得到的是5xxx\n\n此时用溯雪，也不行，不能抓取到表单，尼玛这根本就不是表单。屌丝难道就此放弃？ON！找到另一个登录口，wap！\n\n这里一看就觉得有问题，密码直接说text-type，然后代理brup抓包。\n\n\n\n设置好标记，以前剑心说我不严谨，我这里测试了三次，第一次，用10个密码跑，也就是5X00到5X10 结果跑出来了，但是这不够，万一还是限制10次呢，第二次，一百个密码跑，也跑出来了，现在为了更准确，也尽量节约时间，我设置1000个密码。\n\n然后提交完了之后看到。\n\n看来确实是没限制了，这下就可以拿基友的帐号测试了。   漏洞证明：  \n\n   修复方案：  密码找回逻辑有点小问题，太短，第二，主站登录最好还是加上验证码，因为哪怕每次10个，还是用不了多久，也能突破，第三，wap登录做好限制。过年了，求礼物，瓦咔咔   版权声明：转载请注明来源 小胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2013-01-28 16:56 厂商回复： 确认存在对密码错误重试未进行频率封禁，且临时密码过于简单。已经解决问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-24 15:40 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  爆破验证码神马的 最近很火    \n     2013-01-24 16:18 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @围剿 不是验证码,直接搞密码哦亲~    \n     2013-01-24 16:51 |    \t\t灬相随灬 \t\t\t( 普通白帽子  |\t\t\t        Rank:369 漏洞数:68        | 大胆天下去得，小心寸步难行。)\t\t \n  好厉害的感觉    \n     2013-01-24 18:53 |    \t\tz7y \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:9        | 关注技术与网络安全)\t\t \n  - -似乎真的好厉害。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}