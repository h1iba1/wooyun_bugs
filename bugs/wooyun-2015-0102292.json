{"id": 45551, "wybug_id": "wooyun-2015-0102292", "wybug_title": "同程旅交汇低价支付高价订单订单随意修改（另种支付漏洞隐患）", "wybug_corp": "苏州同程旅游网络科技有限公司", "wybug_author": "纳米翡翠", "wybug_date": "2015-03-19 12:42", "wybug_open_date": "2015-03-20 13:33", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-20：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 17u.net现在叫旅交汇，不知道什么意思 详细说明：  \n\n不知道后台计算的时候是按什么计算的，总之前台是可以通过url修改订单，而且是不需要权限的修改   漏洞证明：  首先注册一个号码：13111112343，然后正常下单：\n\n到订单里面点查看订单：\n\n点击返回修改\n\n点提交\n\n抓包\n\n重点就在这条url:http://www.17u.net/WDHandler/LineOrder.ashx?action=updateLine&Platform=net&lineid=4593689&b2bMemberId=207967&TotalPrice=2750.00&TotalMan=1&TotalChild=0&b2cname=13111112343&b2cphone=13111112343&b2cemail=&remark=&dateText=2015-3-19%200:00:00&orderid=254831经过测试，这条url，可以在不登录的情况下更新订单，也就是只要知道orderid，就可以更新订单，更重要的是orderid是自增值，很容易推测orderid号接下来，我们来更改我刚才下的单，从上面的url里面有两个地方一个是lineid，一个是totalprice，这两个经过尝试是要与网站里面已有的产品一样的，所以我找了一个便宜的产品，\n\n这个产品的id是1806901，价格是50，然后拿出上面记录的url，修改http://www.17u.net/WDHandler/LineOrder.ashx?action=updateLine&Platform=net&lineid=1806901&b2bMemberId=207967&TotalPrice=50&TotalMan=1&TotalChild=0&b2cname=13111112343&b2cphone=13111112343&b2cemail=&remark=&dateText=2015-3-19%200:00:00&orderid=254831然后执行一下，随便在哪执行都行，然后再到订单里面看我们的订单,已经变成50块了，\n\n\n\n\n\n但毕竟是预定，有人为审核在里面，所以即便改了，也没什么大碍，但从程序上来讲，感觉应该算是个bug.先这样吧   修复方案：  DUANG   版权声明：转载请注明来源 纳米翡翠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-03-19 12:47 厂商回复： 感谢关注同程旅游，请洞主发下联系方式。 最新状态： 2015-03-20：公开，让大家看看思路  ", "replys": "漏洞评价：\n评论\n     2015-03-19 12:44 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  有意思，别总想着免费的午餐，说不定有惊喜。    \n     2015-03-19 20:37 |    \t\t纳米翡翠 \t\t\t( 普通白帽子  |\t\t\t        Rank:316 漏洞数:42        | 翡翠虽小、价值极高，追求极致、共建安全)\t\t \n  谢谢同程，礼物收到。    \n     2015-03-19 21:02 |    \t\t苏州同程旅游网络科技有限公司(乌云厂商)\t\t \n  @纳米翡翠 哥，看你就在附近公司，要不什么时候出来聊聊    \n     2015-03-19 22:22 |    \t\t纳米翡翠 \t\t\t( 普通白帽子  |\t\t\t        Rank:316 漏洞数:42        | 翡翠虽小、价值极高，追求极致、共建安全)\t\t \n  @苏州同程旅游网络科技有限公司 是的啊，好多以前同仁现在都到贵公司了。    \n     2015-03-20 13:33 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  @纳米翡翠 聊聊    \n     2015-03-21 12:16 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @纳米翡翠 @苏州同程旅游网络科技有限公司 @疯子 开个房呗    \n     2015-03-23 17:34 |    \t\tkydhzy \t\t\t( 普通白帽子  |\t\t\t        Rank:362 漏洞数:62        | 软件测试)\t\t \n  @纳米翡翠 @苏州同程旅游网络科技有限公司 @疯子   3p么？    \n     2015-03-23 22:11 |    \t\t静默 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:6        | 安全小白)\t\t \n  好厂商    \n     2015-03-24 17:03 |    \t\t我不得踢噶 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | Hello world!)\t\t \n  @苏州同程旅游网络科技有限公司 聊一聊是不是准备挖人？    \n     2015-04-05 17:33 |    \t\t小小黑 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:3        | ...)\t\t \n  @我不得踢噶 你以为是？？难道仅仅是3p这么简单么？    \n     2015-04-06 20:05 |    \t\tganggang \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 这个号是来乌云聊天的....)\t\t \n  就冲厂商这一声  哥  你也应该去聊聊    \n     2015-04-06 21:35 |    \t\t纳米翡翠 \t\t\t( 普通白帽子  |\t\t\t        Rank:316 漏洞数:42        | 翡翠虽小、价值极高，追求极致、共建安全)\t\t \n  @ganggang 厂商是好厂商，暂不敢高攀,不够格    \n     2015-04-13 20:37 |    \t\t屠龙宝刀点击就送 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 简要介绍不能为空)\t\t \n  开房聊聊    \n     2015-04-27 21:55 |    \t\tMr.R \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:14        | 求大神带我飞 qq2584110147)\t\t \n  @苏州同程旅游网络科技有限公司 聊聊 说 人挖走了吗    \n     2015-04-29 11:52 |    \t\t一根寒毛 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 野火烧不尽，春风吹又生！)\t\t \n  这些东西就是能改 也不能去碰他的...    \n     2015-08-12 10:23 |    \t\t刘洪泽 \t\t\t( 普通白帽子  |\t\t\t        Rank:130 漏洞数:35        | 一个到处找密码的小号..........)\t\t \n  @纳米翡翠 @苏州同程旅游网络科技有限公司 开个房呗    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}