{"id": 3375, "wybug_id": "wooyun-2014-059947", "wybug_title": "天津航空重置任意用户密码（账户安全关键敏感信息泄漏）", "wybug_corp": "天津航空", "wybug_author": "gongshw", "wybug_date": "2014-05-09 12:28", "wybug_open_date": "2014-06-23 12:28", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["信息泄露", "重置密码", "天津航空"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-23：\t细节向公众公开  简要描述： 天津航空网站重置密码存在设计漏洞，只要知道用户名，就可以重置用户密码，登录之后可以对查看订单信息，导致信息泄露。PS：该航空公司已经出现信息泄漏导致的诈骗案例！ 详细说明：  1、进入找回密码页面2、输入任意用户名，例如123，点击下一步\n\n3、这里要回答验证问题，可是网站并没有在服务器端验证输入，而是直接使用了如下代码\nfunction secondStep() {\t\tvar input = document.getElementById(\"answer\").value;\t\tif (input == \"\") {\t\t\tjqalert(\"请输入密码保护问题答案\");\t\t} else if (input == seanswer) {\t\t\tchangeTable(\"3\");\t\t} else {\t\t\tjqalert(\"您输入的密码保护问题答案不正确\");\t\t}\t}\n3、也就是说，这一步完全形同虚设，seanswer这个全局变量直接存储了验证问题的答案。4、进一步分析页面，发现重置密码是通过如下代码实现的:\nfunction resetPwd() {\t\tvar url = '/frontend/users/modifyinfo/GetUser!resetPwd.action';\t\tvar params = {newPwd: document.getElementById('pwd1').value, userId: userId};\t\tjQuery.ajax({\t\t\turl: url,\t\t\ttype: 'POST',\t\t\tdataType: 'json',\t\t\tdata: params,\t\t\tasync: false,\t\t\tsuccess: processResetPwd\t\t});\t}\n5、也就是说，可以不进行任何验证，直接重置用户密码。6、骗子们显然已经开始利用这样的漏洞了吧。\n\n   漏洞证明：  \n\n\n\n\n\n登录成功\n\n   修复方案：  密保问题的验证需要在服务器端进行。   版权声明：转载请注明来源 gongshw@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2014-05-12 18:05 厂商回复： CNVD已确认所述情况，通过公开联系渠道向网站管理方天津航空有限责任公司通报处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-09 12:29 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这种案例啊哎！    \n     2014-05-09 14:09 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  又是航空公司....    \n     2014-06-02 22:40 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  好在没坐过这公司的    \n     2014-06-23 16:58 |    \t\twugui \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:4        | wugui@lcx.cc)\t\t \n  身边有这类事件发生 机票刚出就收到退订信息拨打 400退订 。。    \n     2014-06-23 22:19 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  。。我去，这代码写的真心霸气啊 哈哈    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}