{"id": 34041, "wybug_id": "wooyun-2015-0107375", "wybug_title": "森动网（原团IDC）论坛漏洞导致用户可刷积分获得VPS续费码", "wybug_corp": "森动网", "wybug_author": "Htroy", "wybug_date": "2015-04-14 14:19", "wybug_open_date": "2015-05-29 14:20", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-14：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-05-29：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 森动网（原团IDC）漏洞导致用户可刷积分获得VPS续费码www.sendong.net 详细说明：  采用Discuz X3.2以下版本的论坛存在道具刷分以及任务刷分   漏洞证明：  \n\n呵呵，这是我刷的\n\n账号证明   修复方案：  在完成任务时（home.php?mod=draw&do=view&id=xx），任务先前的状态缺少判断完成任务的链接形如：home.php?mod=draw&do=view&id=xx这个地址最终在 source\\class\\class_task.php 中被处理约第370行：\nfunction draw($id) {        global $_G;        if(!($this->task = C::t('common_task')->fetch_by_uid($_G['uid'], $id))) {                showmessage('task_nonexistence');        } elseif($this->task['status'] != 0) {                showmessage('task_not_underway');        } elseif($this->task['tasklimits'] && $this->task['achievers'] >= $this->task['tasklimits']) {                return -1;        }......\n之后就是获得任务奖励了总觉得上面这一段少了些什么判断？我们对比下其他代码约第473行：\nfunction giveup($id) {        global $_G;        if($_GET['formhash'] != FORMHASH) {                showmessage('undefined_action');        } elseif(!($this->task = C::t('common_task')->fetch_by_uid($_G['uid'], $id))) {                showmessage('task_nonexistence');        } elseif($this->task['status'] != '0') {                showmessage('task_not_underway');        }\n修复方案：\n在 source\\class\\class_task.php 中的 draw 函数部分，加入任务是否领取的判断即加上......elseif($this->task['status'] != '0') {        showmessage('task_not_underway');}\n这样，再次使用漏洞时，就会提示：不是进行中的任务   版权声明：转载请注明来源 Htroy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}