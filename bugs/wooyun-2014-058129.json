{"id": 4639, "wybug_id": "wooyun-2014-058129", "wybug_title": "七牛云存储逻辑缺陷漏洞大礼包", "wybug_corp": "七牛云存储", "wybug_author": "伟哥", "wybug_date": "2014-04-23 10:19", "wybug_open_date": "2014-04-23 15:47", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口未加权限认证", "安全意识不足", "越权操作"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 小厂商流程木有爱  详细说明：  某日无聊看到 WooYun: 七牛云储存某处设计缺陷 虽然看不到详情 但是感觉应该存在 平行权限漏洞 所以就检查了一次0x01 删除任意空间0x02 申请绑定任意域名0x01 删除任意空间\n\n\n\nhttps://portal.qiniu.com/operate-confirm/delete-bucket?bucket=adminfw如图可以看到判断直接用url判断 - -这到底是有多随便啊 如果从来个穷举是不是就可以删除所有空间了？ 危害貌似不大0x02 绑定、删除任意域名\n\n先给admin空间绑定wooyunweige\n\n然后自己绑定一下 发现这个域名被占用了 任意账号绑定成功！\n\n然后删除admin账号的wooyunweige域名\n\n自己绑定一下  绑定成功 OK 任意删除 成功！0x03 404页面 防盗链 都存在这类的漏洞 404挂上黑页会怎么样 挂上SEO的黑链又会怎么样 防盗链 把所有域名的防盗链都换成 127.0.0.1 会怎么样    漏洞证明：  最终证明 用户大部分操作都 存在平行权限点到即止 话说有礼物吗    修复方案：  漏洞细节 或者不懂的 就乌云私戳我吧   版权声明：转载请注明来源 伟哥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-04-23 15:47 厂商回复： 一个奇妙bug引发的问题。    首先，七牛云存储的bucket是关联到个人，而域名是公共的。也就是说，对某个bucket的操作，一定要有uid才能进行，否则无法确定这个bucket指的是哪个。    而后先看问题01，删除任意空间。url为https:///operate-confirm/delete-bucket?bucket=adminfw，里面只含有bucket。这是因为在使用的session中，包含了调用者的uid。因此才能明确所删除的目标。我们从描述中，并没有发现有什么办法够越过uid，删除别人的bucket。    其次，问题02，申请绑定任意域名。这是一个很微妙的bug。直接调用api的话，可以为一个不存在的bucket绑定一个域名。但是根据我们的测试，这个bucket仍然是调用者自身的。当调用者创建这个bucket时，会发现里面已经存在一个绑定域名。除此外和普通的域名绑定并没有什么区别——别人已经绑定的域名不能取得，也不能操作。因此，我们判断这个问题为一个普通bug，而并不是漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-24 12:37 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @七牛云存储 厂商靠谱啊，过程以及现有机制都说清楚了，问题清晰。    \n     2014-04-25 05:57 |    \t\t伟哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:29        | 不怕流氓有文化,就怕色狼有耐心,那么一只起...)\t\t \n  @疯狗 是我乌龙了  没仔细测试 应该再建一个账号测试的 懒了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}