{"id": 8119, "wybug_id": "wooyun-2013-035199", "wybug_title": "Discuz!NT 后台任意文件上传", "wybug_corp": "Discuz!", "wybug_author": "江南的鱼", "wybug_date": "2013-08-25 14:27", "wybug_open_date": "2013-11-23 14:27", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-10-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-23：\t细节向公众公开  简要描述： Discuz!NT 不知道是不是官方放弃了，官网都打不开了。Discuz!NT 3.6.601 等高版本，后台存在上传任意文件的漏洞，通过设置，能上传任意文件! 详细说明：  Discuz!NT 管理后台可以自定义文件类型，从而造成任意文件上传，测试过程中 aspx文件，目录并不会解析。所以需要能解析 asp 或者php等。过程演示【程序版本：Discuz!NT 3.6.601】：1. 登陆 Discuz!NT 后台，【全局】-->【附件设置】-->【附件尺寸】-->【添加附件类型】添加需要上传的文件类型。如图，我添加了ASP\n\n2. 给用户组加上上传ASP的权限。【用户】-->【分组与级别】-->【编辑用户组】-->【编辑系统组】-->【管理员】，勾选上添加的ASP 类型。\n\n3.去前台上传上传asp文件。【附件】-->【批量上传】，选择ASP文件。如图：\n\n4.进入后台找shell。【内容】-->【附件管理】-->【搜索附件】。如图：\n\n   漏洞证明：  成功执行了代码，拿到shell！\n\n   修复方案：  全局限制可执行文件的后缀。   版权声明：转载请注明来源 江南的鱼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-08-26 09:57 厂商回复： 感谢您的提供，我们尽快处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-10 15:21 |    \t\t大肠精 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 业余兴趣而已)\t\t \n  都进后台了，啥事不能做哦    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}