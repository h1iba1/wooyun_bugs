{"id": 18768, "wybug_id": "wooyun-2012-08270", "wybug_title": "陕西省教育厅某成绩查询系统任意用户信息查询", "wybug_corp": "陕西省教育厅", "wybug_author": "mgOrange", "wybug_date": "2012-06-13 20:42", "wybug_open_date": "2012-07-28 20:43", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["边界越位", "用户敏感信息泄漏", "敏感接口缺乏认证", "敏感接口未加权限认证", "平行权限"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-28：\t细节向公众公开  简要描述： 陕西省教育部某成绩查询系统不需要任何信息和验证可以查询任意参加该考试的同学的姓名、性别、准考证号、考试类型、成绩以及最可怕的身份证号！利用简单、有心人可以很容易写爬虫获取全库信息。 详细说明：  陕西省2012年中小学教师资格教育基础理论知识考试成绩查询系统http://117.34.1.18/（同样适用于2011年的）轻松绕过登录，可以不需要任何验证信息查询到所有考生的成绩，而且还可以爆后台错误。（估计还有大头可以玩，这段时间事多，就不研究了）只要知道了ScoreReport这个aspx名，一切随意啊。http://117.34.1.18/ScoreReport.aspx?i=NTU1NQ==http://117.34.1.18:8080/ScoreReport.aspx?i=NTU1NQ==无session验证，要查询的数据id直接GET获得。i后面的参数直接就是Base64加密的，2011年的原文是从1531递增到xxxx的，2012年的是从1开始递增的，具体到多少没试，但是20000个是有了，二分一下就找到上限了，有心人一个爬虫很快就把整个数据表爬到了，几万个姓名+身份证号啊   漏洞证明：  证明：http://117.34.1.18/ScoreReport.aspx?i=NTU1NQ==\n\n轻松写爬虫啊有没有：\n\n2011年的同理：http://117.34.1.18:8080/ScoreReport.aspx?i=NTU1NQ==   修复方案：  登录的代码改两行，不要光查一个id就形成连接跳转了。ScoreReport用session获取数据，不要用GET了。麻烦不了多少，而且不用base64了，不用生产连接了，代码应该还更短。   版权声明：转载请注明来源 mgOrange@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2012-06-18 12:45 厂商回复： CNVD确认并复现部分所述情况，转由CNCERT陕西分中心处置。参考评分原则，以部分机密性影响计，考虑到涉及教育部门考试系统，评分如下：4.96(中危，对机密性构成部分影响)*1.1（参数构造）*1.3（较严重）=7.092 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-14 11:29 |    \t\tubuntu \t\t\t( 普通白帽子  |\t\t\t        Rank:148 漏洞数:12        | 一切皆有可能……)\t\t \n  期待结果……    \n     2012-06-18 13:16 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  没照片的都是耍流氓    \n     2012-06-21 16:03 |    \t\tmgOrange \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:2        | 对安全很感兴趣的小白一个)\t\t \n  @xsser 这流氓当的让我情何以堪啊    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}