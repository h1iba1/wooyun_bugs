{"id": 49337, "wybug_id": "wooyun-2015-0126355", "wybug_title": "中国联通某商城密码找回逻辑漏洞/泄露40多W用户敏感数据", "wybug_corp": "中国联通", "wybug_author": "timem", "wybug_date": "2015-07-13 00:02", "wybug_open_date": "2015-08-30 14:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "手机短信", "用户信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-30：\t细节向公众公开  简要描述： 中国联通某商城密码找回逻辑漏洞，泄露40多W用户敏感数据。刚才提交的好像出问题了，如果重复了，请删除。 详细说明：  前台地址：http://mall.gd10010.cn/component_lib/user/login.do后台地址：http://manage.gd10010.cn/wcsweb/sysLogin/toLogin.do先从后台入手，看到有忘记密码不自觉就尝试一把，不费吹灰之力就重置好了，真是无语...\n\n找回密码分4步，但其实只要第一步和第四步就可以了，中间2步可以绕过。\n\n第一步，测试账号是否存在\n\n第四步，直接重置密码。好了，重置了manager的密码后，就登录后台。后来发现超级用户应该是super，不过没有测试了。\n\n在订单查询可以看到所有订单信息\n\n可以看到有422023条记录，上方有导出功能\n\n导出后能看到详细的订单信息，包含购买用户的姓名，身份证，住址，电话等。（补充说明，我没有导出全量数据）。后台就到此，神马上传GETSHELL之类的就算了，你们自己查吧。前台和后台的找回密码功能是一样的，同理就可以进入前台。不过前台账号名不好猜，还有在后台找到一些前台账号的记录。\n\n\n\n\n\n登录前台\n\n\n\n可以下单买东西，不过价钱签名了，好像改不了。下单时需要验证身份证，不过发现可以绕过，直接修改前台代码就行，你们应该懂的。这个商城应该是渠道代理商使用，身份验证可以绕过，实名制真的能保证吗？不用说都知道了实名制问题，央视已有报道。另，首页上的帮助说明也有泄露用户信息的嫌疑哦。把别人的身份证信息显示出来了，事主知道吗？   漏洞证明：  \n\n\n\n上面已详细证明   修复方案：  你们都懂的，只是不做而已。1.修复密码找回逻辑2.敏感信息模糊化3.实名制验证放后台做。4.对外发布的页面，不要含用户信息。企业要对我们用户信息负责，非经允许不得滥用！   版权声明：转载请注明来源 timem@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-07-16 14:41 厂商回复： 转由CNCERT下发给广东分中心，根据广东分中心和厂商反馈情况，未复现所述情况，且不能确认风险点是否存活，暂未列入处置流程。先按历史风险评分，rank 11 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}