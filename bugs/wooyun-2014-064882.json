{"id": 54309, "wybug_id": "wooyun-2014-064882", "wybug_title": "Discuz CSRF删除群组分类", "wybug_corp": "Discuz!", "wybug_author": "Matt", "wybug_date": "2014-06-17 13:51", "wybug_open_date": "2014-09-15 13:52", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-20：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-15：\t细节向公众公开  简要描述：  详细说明：  admin_group.php\n} elseif($operation == 'deletetype') {//没有验证fromhash导致可以csrf删除\t$fid = $_GET['fid'];\t$ajax = $_GET['ajax'];\t$confirmed = $_GET['confirmed'];\t$finished = $_GET['finished'];\t$total = intval($_GET['total']);\t$pp = intval($_GET['pp']);\t$currow = intval($_GET['currow']);\tif($ajax) {\t\tob_end_clean();\t\trequire_once libfile('function/post');\t\t$tids = array();\t\tforeach(C::t('forum_thread')->fetch_all_by_fid($fid, $pp) as $thread) {\t\t\t$tids[] = $thread['tid'];\t\t}\t\trequire_once libfile('function/delete');\t\tdeletethread($tids);//这里便直接删除了\n   漏洞证明：  开启群组功能之后发帖添加一个img标签 图片志向http://127.0.0.1/x32/admin.php?action=group&operation=deletetype&fid=11&confirmed=1&ajax=1&pp=2000&total=0&currow=0其中的fid便是分类的id 可以遍历一下 即可删除所有分组   修复方案：  fromhash验证   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-06-17 15:23 厂商回复： 感谢您提供的信息。我们尽快予以修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-17 14:01 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这种基本无所谓了    \n     2014-06-17 14:12 |    \t\tFireweed \t\t\t( 普通白帽子  |\t\t\t        Rank:107 漏洞数:14        | Show me the #)\t\t \n  @xsser 这种也有银子莫，剑总    \n     2014-06-17 14:12 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Fireweed 估计很少很少很少很少.....    \n     2014-06-17 14:14 |    \t\tFireweed \t\t\t( 普通白帽子  |\t\t\t        Rank:107 漏洞数:14        | Show me the #)\t\t \n  @xsser 嗯这种要是有那我大乌云一统江湖就指日可待了    \n     2014-06-17 14:22 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  看到这个我才发的我那个 结果发完过看到来大老板说银子很少很少很少…… 伤心    \n     2014-06-17 14:42 |    \t\t我是小号 \t\t\t( 普通白帽子  |\t\t\t        Rank:334 漏洞数:51        | Martin)\t\t \n  @Fireweed CSRF KING！    \n     2014-06-17 14:55 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @mramydnei 你发的哪个？    \n     2014-06-17 14:57 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  @xsser http://wooyun.org/bugs/wooyun-2014-065249    \n     2014-06-19 12:41 |    \t\tMatt  \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:107        | 承接代码审计 http://codescan.cn/)\t\t \n  @xsser 那个那个托裤子的给多少钱啊 给高危的么    \n     2014-06-19 12:43 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Matt 嗯    \n     2014-06-19 12:48 |    \t\tMatt  \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:107        | 承接代码审计 http://codescan.cn/)\t\t \n  @xsser 发财了 顺便把我剩下的漏洞也审核了呗    \n     2014-06-19 13:01 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Matt @疯狗    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}