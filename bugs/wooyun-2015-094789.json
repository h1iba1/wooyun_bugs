{"id": 39098, "wybug_id": "wooyun-2015-094789", "wybug_title": "国家电网江苏省分公司某平台缺陷泄露大量用户信息", "wybug_corp": "国家电网公司", "wybug_author": "Mik3y_14", "wybug_date": "2015-01-31 12:04", "wybug_open_date": "2015-03-17 12:06", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-17：\t细节向公众公开  简要描述： 某平台缺陷泄露大量用户信息 详细说明：  国家电网江苏省分公司某平台缺陷泄露大量用户信息                     lxx                   weixin.jssgcc.com.cn   漏洞证明：  地址：微信公众账号关注“国网江苏省电力公司 ”漏洞：服务器泄露其他用户重要信息。打开我的用电->密码初始化\n\n填入用户编号和身份证号后，会首先对用户编号进行检测是否是未初始化的用户编号，报文如下\n\n成功返回access，失败返回fail。电力客户编号是10位数字，我们对用电客户编号后6位进行暴力探测\n\n可以看到很多异常返回报文，这些异常返回报文中包含大量其他用户的返回报文信息。如下，返回其他用户户号和姓名地址及电卡中余额。\n\n如下，返回其他用户openid和缴费记录网址。\n\n由于该公众账号多个功能页面使用openid来识别用户，而微信对于同一公众账号，不同用户的openid是唯一的，也就是说利用该openid我们可以以该用户身份访问江苏电力微信公众号，获取该用户信息。获取的信息如下：\n\n\n\n等等。目测该功能是由于后台某处存在溢出问题，在大规模频繁报文发送时，其他用户返回报文被错误发送到其他用户，导致信息泄露，根据时间戳判断，泄露的应是最近访问的内容。如对该系统进行不间断探测，可以获取近期访问所有用户信息。   修复方案：  你们自己来吧.... 有小礼品嘛~   版权声明：转载请注明来源 Mik3y_14@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-01-31 14:01 厂商回复： 谢谢  高并发引起的线程安全问题 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}