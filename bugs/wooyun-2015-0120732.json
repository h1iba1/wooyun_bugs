{"id": 40695, "wybug_id": "wooyun-2015-0120732", "wybug_title": "安全狗SQL-UNION注入防护策略Bypass", "wybug_corp": "安全狗", "wybug_author": "蜗牛的贝壳", "wybug_date": "2015-06-15 22:32", "wybug_open_date": "2015-09-14 10:28", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-19：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-14：\t细节向公众公开  简要描述： 网站安全狗对sql注入过滤不全面,使得针对PHP的GET、POST请求都可以轻松绕过. 详细说明：  在此次测试环境中,用来绕过的主要代码是: \nunion /*!50000select/*!*/ name from test#\n经过测试,可以绕过最新版的安全狗,应该对全版本都有效吧...   漏洞证明：  先来看看测试环境：最新的IIS版安全狗,要用到的两个表内容如下图：\n\n\nusers表\n\n\n\ntest表\nPOST请求：\n正常请求：\n\n\n\n被拦截了：\n\n\n\n绕过了：\n\n\nGET请求：\n正常请求：\n\n\n\n被拦截了：\n\n\n\n绕过了：\n\n\n   修复方案：  完善过滤   版权声明：转载请注明来源 蜗牛的贝壳@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-06-16 10:26 厂商回复： 洞主是我们的好朋友，你们不要打他。我们诚心邀请任何人来挖，原则是在客观的情况下，分数会有所更加。另，开发真是人高马大，不骗你们，是真的，真是真的。最后，这个漏洞我们会尽快修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-15 22:51 |    \t\t牛肉包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:55        )\t\t \n  醉~    \n     2015-06-16 00:26 |    \t\tjeary \t\t\t( 普通白帽子  |\t\t\t        Rank:296 漏洞数:89        | (:‮.kcaH eb nac gnihtynA))\t\t \n  让自己无路可走。    \n     2015-06-16 00:57 |    \t\tangelc0de \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        )\t\t \n  哎。。。    \n     2015-06-16 08:38 |    \t\tDevi1o \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:3        )\t\t \n  恭喜,又对了一条规则    \n     2015-06-16 09:59 |    \t\tgreg.wu \t\t\t( 普通白帽子  |\t\t\t        Rank:815 漏洞数:88        | 打酱油的~)\t\t \n  你就这么缺wb吗？！    \n     2015-06-16 10:05 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:30        | Hacked by @ringzero 我錯了)\t\t \n  你就这么缺wb吗？！    \n     2015-06-16 10:12 |    \t\tsco4x0 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:12        | O_o)\t\t \n  看你们以后遇到狗怎么办    \n     2015-06-16 10:16 |    \t\t嗯哼！ \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 人才有点二！)\t\t \n  要不是开发人高马大，早就被我揍死了。    \n     2015-06-16 10:18 |    \t\t小饭 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 吃一口饭啊一口饭)\t\t \n  我的天。。难度又要上升了    \n     2015-06-16 10:25 |    \t\tLooke \t\t\t( 普通白帽子  |\t\t\t        Rank:619 漏洞数:38        | 可顺势而为，何必逆水行舟)\t\t \n  你就这么缺wb吗？！    \n     2015-06-16 10:57 |    \t\tsauren \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:10        | 天天打DOTA，快乐你我他~)\t\t \n  你就这么缺wb吗？！    楼下别乱    \n     2015-06-16 11:08 |    \t\thh2014 \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:11        | 继续)\t\t \n  你就这么缺wb吗？！    \n     2015-06-16 12:24 |    \t\tmenmen519 \t\t\t( 普通白帽子  |\t\t\t        Rank:762 漏洞数:140        | http://menmen519.blog.sohu.com/)\t\t \n  @安全狗，应该把waf规则开源 所有白帽子一起帮你们审核    \n     2015-06-16 13:38 |    \t\thuoji \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:9        | 目标是当个农民)\t\t \n  当正则完全无洞可挖之时,也就是安全狗的全胜时期。@安全狗 我倒觉得你们应该专门成立一个挖洞小组,以现金的形式奖励一下~ 就不会出现喷人现象~    \n     2015-06-16 15:42 |    \t\t安全狗(乌云厂商)\t\t \n  @menmen519 可以考虑。    \n     2015-06-16 15:44 |    \t\t安全狗(乌云厂商)\t\t \n  @huoji 现金暂时没有，但是可以去我们自己的漏洞提交中心看看，我们是有奖品兑换的，有一批人已经兑换过了，并且兑换奖品的难度，我觉得还是比较容易的。包括在乌云，我们也赠送过礼品，主要就是看白帽子的挖掘深度，以及对整个安全狗的贡献程度，其实更是对整个中小企业的安全的贡献。    \n     2015-06-18 22:19 |    \t\tPany自留地 \t\t\t( 普通白帽子  |\t\t\t        Rank:114 漏洞数:24        | 0day just like a joke.)\t\t \n  大概已经猜到     \n     2015-06-19 11:46 |    \t\t90_ \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:10        | 关注网络信息安全。)\t\t \n  安全狗才给7WB？   呵呵    \n     2015-06-19 19:28 |    \t\t魂淡、 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:1        | 么么哒)\t\t \n  @90_ 7WB我觉得这个价挺合适的。说实话现在安全狗和以前安全狗给人的感觉都变了，以前要么忽略要么1rank，估计是厂商号换人了    \n     2015-06-21 18:44 |    \t\tkav \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        )\t\t \n  你就这么缺wb吗？    \n     2015-08-30 11:03 |    \t\thuoji \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:9        | 目标是当个农民)\t\t \n  事实证明,安全狗对/**/拦截规则不是很好. D盾的是一看到 /**/不论什么就拦截。。。。     \n     2015-09-14 13:07 |    \t\tYuku \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:10        | 酱油哥)\t\t \n  洞主是我们的好朋友，你们不要放过他。    \n     2015-09-14 17:53 |    \t\tJ0e \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 心若苍井空似水)\t\t \n  要不是开发人高马大，早就被我揍死了。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}