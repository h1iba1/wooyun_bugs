{"id": 73168, "wybug_id": "wooyun-2015-0155116", "wybug_title": "华泰电话车险任意命令执行导致Getshell", "wybug_corp": "华泰财产保险有限公司", "wybug_author": "Blunber", "wybug_date": "2015-11-23 09:45", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行", "补丁不及时", "远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： getshell时发现已经有不少马在上面了，一旦数据库方面信息泄露，会涉及到一大波车险订单，在华泰上过车险的小伙伴注意喽！ 详细说明：  Struts2漏洞危害：1、可远程执行服务器脚本代码[2] 用户可以构造http://host/struts2-blank/example/X.action?action:%25{(new+java.lang.ProcessBuilder(new+java.lang.String[]{'command','goes','here'})).start()}链接，command goes here可以换成是破坏脚本的路径和参数，比如fdisk -f等，造成破环系统无法运行的目的。2、重定向漏洞[3] 用户可以构造如知名网站淘宝的重定向连接，形如<a href=\"http://www.淘宝.com/item00001.html?redirect:http://黑客/getyourPassword\">打折新款</a>,引导用户点击后进入钓鱼网站，在界面上让其进行登陆用以获取用户的密码。具体过程：1、官网地址\n\n2、汽车保单流程使用action方法，判断是struts2\n\n   漏洞证明：  3、果然有Struts2，而且还是root\n\n4、看来不少人已经来过了\n\n5、系统信息查看\n\n6、配置文件\n\n7、由于一直连接不上，所以没有进一步测试\n\n   修复方案：  可以参考：\nhttp://blog.csdn.net/mydwr/article/details/18727627\n 文章针对Struts2-016有详细的修复方案。   版权声明：转载请注明来源 Blunber@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-11-23 10:26 厂商回复： 非常感谢，马上进行修复 最新状态： 2015-11-25：属于停用系统，现在已停止，网站已关闭 2015-12-02：停用系统，已删除 2015-12-16：停用、删除  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}