{"id": 10690, "wybug_id": "wooyun-2013-034261", "wybug_title": "蘑菇街任意重置别人密码（爆破）", "wybug_corp": "蘑菇街", "wybug_author": "小龙", "wybug_date": "2013-08-13 16:35", "wybug_open_date": "2013-08-14 15:20", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "安全意识不足", "客户端程序设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-14：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 问题还是在找回密码哪里，弱爆了。https://www.mogujie.com/usersecurity/findpwd我们按找回密码。 用手机方式用burp抓包。。。 抓那个错误验证码蘑菇街里面的妹纸穿的衣服好潮流- -  求七夕礼品打包一大波(妹纸)过来，不要充气娃娃！  妹纸，今天七夕节不是你单身就是我单身，来吧！ 详细说明：  \n\n\n\n\n\n\n\n\n\n   漏洞证明：  \n\n\n\n\n\n\n\n\n\n   修复方案：  验证码建议到6位，并且在输入验证码输错5次就几分钟后重试之类的，   版权声明：转载请注明来源 小龙@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-08-14 15:20 厂商回复： 感谢您的报告，已经有次数验证机制，不可能存在爆破。上面的图证明您收到的验证码是8043，而输入的验证码是1234，谢谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-14 15:31 |    \t\tB1acken \t\t\t( 普通白帽子  |\t\t\t        Rank:174 漏洞数:56        | 渣渣)\t\t \n  楼主手机号漏了    \n     2013-08-14 15:31 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  上面的图证明您收到的验证码是8043，而输入的验证码是1234，谢谢。笑了。。。    \n     2013-08-14 16:30 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @Coody 尼玛，我是图上传差了，差第五附图。。。无语。    \n     2013-08-14 17:30 |    \t\tsun \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:12        )\t\t \n  上面的图证明您收到的验证码是8043，而输入的验证码是1234，谢谢。笑了。。    \n     2013-08-14 17:57 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @sun - -    \n     2013-08-14 19:41 |    \t\t心伤的黑子 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | \"><img>bbb)\t\t \n  @sun @Coody 蘑菇街这里已经对爆破次数进行了限制，所以即使是4位数字，也是爆破不出来的，所以结论是楼主根本就没有去试，或者试了失败了，但是还是发上来想骗过。@xsser 你怎么看    \n     2013-08-14 20:01 |    \t\tsun \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:12        )\t\t \n  @心伤的黑子 暴力破解不会促发次数限制的    \n     2013-08-14 20:19 |    \t\t心伤的黑子 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | \"><img>bbb)\t\t \n  @sun 。。。啥叫不会促发，你有试没？人家官网对于这个验证码的post请求已经做了限制了，同一天超过多少次错误就不会在请求成功了，比如你4位纯数字，爆破需要10*10*10*10需要1W次请求，按照1/2的概率来算，也需要5000次才能破解出来一个帐号，而官方限制的肯定也就错误10次左右就会给予限制。所以说根本爆破不出来，不然你看洞主为啥没有截图那个爆破的图？    \n     2013-08-14 20:36 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @sun 我不知道哦，反正就是length这个返回值是不一样的，正确会返回一个不一样的值，如果正确的话他会返回一个全部一样的值。。    \n     2013-08-14 20:36 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @心伤的黑子 我不知道哦，反正就是length这个返回值是不一样的，正确会返回一个不一样的值，如果正确的话他会返回一个全部一样的值。。    \n     2013-08-14 20:46 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @小龙 你确实爆破成功过么？    \n     2013-08-14 20:47 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n   @sun 非也非也，如果不会触发整个世界都去爆破去了，不是么？ @心伤的黑子    \n     2013-08-14 20:52 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @Coody 我说了，length 如果正确验证码length这个也就是最后面哪里会返回不一样的数值，只是第五附图被我上传差了，但是确实用这个可以辨别啊。。。他遇到正确只有length这个返回错误，相反过来的，蛋疼。他们厂商不承认，图也被我啦回收站给清空了。。。    \n     2013-08-14 21:10 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @小龙 我懂你的意思，人家厂商的意思是加了次数的验证，但你正好把关键的图给忘记上传了，，，，是吧？    \n     2013-08-14 21:58 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @Coody 对，但是他妈的确实正确返回一个不一样的数字给你，蛋疼，我用软件恢复要钱的，奶奶个腿- - 我刚才找啊找，找到一处存储形的小松鼠了，哈哈- - 刚测试能打到自己cookie~    \n     2013-08-14 21:59 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @Coody 厂商还把我拉黑了，蛋疼- -我彻底无语，当时有个种子搜索器在桌面被我删掉了，家人回来了，我就赶紧删掉。。然后不小心清空了，这样的情况你能想象出来吧？... 真实故事。。。    \n     2013-08-14 22:00 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @小龙 你这是要暴走的节奏啊····    \n     2013-08-14 22:02 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @Coody 明天他们开了我再试试，如果测试和上次不一样，我敢肯定里面代码又被动手脚了，现在找回密码那个页面他们还没打开，如果4位验证码变成6我就只能说坑爹了，4变6...     \n     2013-08-15 07:15 |    \t\tsun \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:12        )\t\t \n  @小龙 4变6。。那你可以暴走了。。    \n     2013-08-15 09:25 |    \t\t蘑菇街(乌云厂商)\t\t \n  @小龙 您好，昨天您拿测试新浪的截图和我们说您觉得有理吗？您那张新浪的截图里返回值不一样，告诉您图里显示那是302跳转了，怎么就成蘑菇街会302跳转？接着您就爆粗口，“日”、“屁”。我们的版本控制里可以看到做了哪些修改，但您这样没有必要了，所以拉黑了。至于您上面说的“敢肯定代码被动手脚”、“4变6”，属于您的肆意揣测，在没有任何事实的情况下请不要随意下结论，谢谢。蘑菇街一直以来对白帽子们都是非常欢迎的，过程也很愉快，对此次事情的发展表示遗憾。    \n     2013-08-15 11:05 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @蘑菇街 哦哦，过几天再试试吧，他遇到正确的那个确实会返回啊。。。。    \n     2013-08-15 11:09 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @蘑菇街 我只是给你打个比方，OK？另外遇到正确的验证码他这个值length会返回一个不正确的，只是前面那里没有，不知道是你们的哪里错误了还是我就不知道了，    \n     2013-08-15 11:10 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @小龙 说错。。。  另外遇到正确的验证码他这个值length会返回一个不一样的数字    \n     2013-08-15 11:10 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @蘑菇街  说错。。。 另外遇到正确的验证码他这个值length会返回一个不一样的数字     \n     2013-08-16 19:21 |    \t\t心伤的黑子 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | \"><img>bbb)\t\t \n  @sun @蘑菇街 @小龙 @Coody 洞主本来这种判断就是有问题的，根据length只是一个局部的判断，要正确的判断的话，必须要去网页进行验证一下。而洞主根本就没有去验证就说存在，这个显然是片面的，蘑菇街完全可以把301 301 500这种页面跳转给设置一个特定的length。并不是说和输入错误的length不一样，就一定是输入正确，也可以是输入过于频繁给的一个length。。。    \n     2013-08-16 19:28 |    \t\t心伤的黑子 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | \"><img>bbb)\t\t \n  @蘑菇街 @小龙 至于说那个什么关键的图没有传上来被自己清空了，这些话还是别说了吧，首先，清空的情况下是可以有免费软件恢复的，比如easy****破解版，避免打广告，这里点到为止的提一下。其次，如果你把那个图传上来那么事实就更明了了，那时候你不承认都没办法了，所以还是给自己留退路吧。。。要是真的的话，你可能也不会这么急的来回爆粗口了。纯属个人猜测，请勿谩骂~    \n     2013-08-17 13:31 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @心伤的黑子 谢谢黑阔的提醒，这个就让他沉下去吧- -    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}