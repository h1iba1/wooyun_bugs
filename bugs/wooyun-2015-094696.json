{"id": 44255, "wybug_id": "wooyun-2015-094696", "wybug_title": "联发科ota升级后台管理sql注入", "wybug_corp": "联发科", "wybug_author": "路人甲", "wybug_date": "2015-01-30 12:26", "wybug_open_date": "2015-04-30 18:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "联发科"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-30：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-04-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 联发科的所有android ota升级(整包和差分包)后台，登陆逻辑没处理sql注入，直接就可以登陆，进入后可以直接删除对应的所有发布版本，更直接的是如果上传了其他差分包，如安装某个软件orz 详细说明：  登陆后台的逻辑直接通过$_POST拼接sql,可以通过sql注入直接登陆，如图\nrequire_once('db.php');session_start();unset($_SESSION['username']);$userName=$_POST['username'];$passWord=$_POST['password'];$access=$_GET['access'];...$sql1='select username,is_admin from user where username=\"'.$userName.'\" and password=\"'.$passWord.'\"';\t\t$query1=mysql_query($sql1);\t\tif(mysql_affected_rows()==1)...\n   漏洞证明：  \n\nen,i in...\n\nen,wo...\n\nen,第二个\n\n\n\n   修复方案：  过滤一下获取值既可$userName = mysql_real_escape_string($userName);$passWord = mysql_real_escape_string($passWord);觉得这个低级错误就不要出现了吧。。。。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}