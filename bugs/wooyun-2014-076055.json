{"id": 344, "wybug_id": "wooyun-2014-076055", "wybug_title": "益盟操盘手分站目录历遍导致分站脱裤主站MSSQL注入", "wybug_corp": "益盟操盘手", "wybug_author": "子非海绵宝宝", "wybug_date": "2014-09-15 12:27", "wybug_open_date": "2014-10-30 12:30", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "默认配置不当", "源代码泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-15：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-10-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 炒股票的朋友让我写个股票的计算脚本无意间发现的....漏洞缘起于一个目录历遍漏洞,导致了分站mysql数据库泄漏,微信劫持,主页挂马,主站后台MSSQL注入点等....危害不小 详细说明：  本来想帮朋友写个读取某只股票的一些信息作为脚本计算的参数的,对整站IP端进行的一次扫描.扫描的过程中发现IP地址:180.153.25.224  直接80端口访问发现是直接的一个目录历遍这个是个人为的运维不当 没有关闭目录历遍造成的.然后开始翻找目录 发现后台 http://180.153.25.224/WeixinManagerWEB/Account/Login.aspx但是由于存在目录历遍 所以开始翻找越权页面找到了一些可以越权并且有危害的地方\n\n这个应该是微信发布的一个平台,泄漏的微信AppId AppSecret Token等继续添加添加后有个上传二维码没有做过滤 但是会重新命名 并且命名不可控 所以放弃...(本人新手 估计还是有大牛可以通过IIS7.5的畸形解析拿shell 这里我就不拿了)其他的一些越权包括咨询更新添加 早知道的主题添加等可以对用户实行批量的钓鱼继续无进展 回到主目录继续翻找 发现关键文件Web.config但是可惜删掉了 继续找发现备份文件...web.rar\n\n下载 发现新大陆\n\n进MYSQL看了下 有点小失望 这个数据库并不是主数据库 应该是信息发布用的数据库什么的 具体不是很了解 但是也包涵了一些敏感信息\n\n具体信息我就不截图了 证明下就可以了难道就这样结束了?回头想了想不甘心 就再翻了下后台  因为既然存在越权 那么肯定对网站后台安全不是很重视  那就找找有没有什么注入点找了一会我发现 还是微信那块存在注入http://180.153.25.224/WeixinManagerWEB/weixinUser/weixinUserAdd.aspx?id=1数据库为MSSQL数据库这里的数据可就全了WinxinManager_TestWinxinManagerEMoney_WeiXin_Test2e_learn_newEMoney_WeiXin_TestEMoney_WeiXin_NewemlearnDataTransfer_SyncEMoney_PromotionEMoney_TongJiEmoney_IStock_ActCloudStockEMoney_RedirectEmoney_IStockEmoney_IStockPromotionEMoney_Fuwue-learnEMoney_ActivitysimulateEm_schoolEMoney_WeiXinEMoney_WebAPIEMoney_RDZZQEMoney_ProductCenteryicaiEMoney_VideoEMoney_QQCPSEmoney_PayEMoney_NewsEMoney_WebEMoney_MonitorDailyWebEMoney_SoftZXChinaCPSwebdbtransferemoney_streakSDUserReportServerTempDBReportServermsdbmodeltempdbmaster由于时间关系 (着急出去吃饭 - -!!! ) 我就没有注意去扫了  估计拿下主站shell应该是轻而易举的了站点目标性用户较多 而且基于对网站的信任 可能有很多个人信息 如果泄漏 后果可能很严重希望加强对运维的培训  一些小地方可能会造成大问题....   漏洞证明：  WinxinManager_TestWinxinManagerEMoney_WeiXin_Test2e_learn_newEMoney_WeiXin_TestEMoney_WeiXin_NewemlearnDataTransfer_SyncEMoney_PromotionEMoney_TongJiEmoney_IStock_ActCloudStockEMoney_RedirectEmoney_IStockEmoney_IStockPromotionEMoney_Fuwue-learnEMoney_ActivitysimulateEm_schoolEMoney_WeiXinEMoney_WebAPIEMoney_RDZZQEMoney_ProductCenteryicaiEMoney_VideoEMoney_QQCPSEmoney_PayEMoney_NewsEMoney_WebEMoney_MonitorDailyWebEMoney_SoftZXChinaCPSwebdbtransferemoney_streakSDUserReportServerTempDBReportServermsdbmodeltempdbmaster   修复方案：  你们更专业   版权声明：转载请注明来源 子非海绵宝宝@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}