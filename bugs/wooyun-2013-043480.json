{"id": 6965, "wybug_id": "wooyun-2013-043480", "wybug_title": "APP终结者#从某一APP安全到万千厂商APP沦陷", "wybug_corp": "道有道", "wybug_author": "zzR", "wybug_date": "2013-11-20 14:54", "wybug_open_date": "2014-01-04 14:55", "wybug_type": "重要敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "默认配置不当", "内部敏感信息泄漏", "平台安全", "安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-20：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-01-04：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 话说怎么这么多的恶意APP呢，就是这样来的吧！从点到面，APP云端安全不闹！ 详细说明：  首先关注了中粮的一个app，在抓包分析的过程中发现其数据并不是到中粮，而是到了另外的站点请求如下：\nGET api.cy.daoyoudao.com/app/diydishlist.do?groupid=11016&shopid=12112&curpage=1&pagesize=15&type=commend&clientid=201311201117453907286&versionrelease=ios_ HTTP/1.1Host: api.cy.daoyoudao.comAccept-Encoding: gzipUser-Agent: ä¸­ç²®åé¡¶åæ¦ 2.2.1 (iPhone; iPhone OS 7.0.4; zh_CN)Connection: keep-aliveProxy-Connection: keep-alive\n根据Host找到他的官网\nhttp://www.daoyoudao.com/全球领先的APP开放平台iDian是全球领先的集APP制作、发布、管理、统计于一体的开放平台。通过这个平台，iDian平台合作伙伴不需要任何技术背景，就可以帮助客户轻松制作、发布、管理APP。iDian开放平台不但承载道有道研发的APP产品，同时还不断吸纳出色的开发者，汇聚企业APP行业最丰富、最优秀、最具性价比的产品。选择iDian，选择APP行业。iDian现正面向全球招募合作伙伴。\n 是一个平台哦，看看是不是有其他的客户app\n\n客户还不少，再次去下载一个app（西部影城）查看其中的请求\nGET /app/gettourmenulist.do?tenantid=10296&shopid=0&systype=ios HTTP/1.1Host: api.sh2.daoyoudao.comAccept-Encoding: gzipUser-Agent: è¥¿é¨å½±å 2.4.0 (iPhone; iPhone OS 7.0.4; zh_CN)Connection: keep-aliveProxy-Connection: keep-alive\n确实是出自同一平台！要是能……的确他还确实存在远程命令执行   漏洞证明：  接下来就简单了GETshell\n\n目测几万APP~恣意更改呀！\n[/usr/local/industry/sh2/api/]$ iduid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel) context=root:system_r:java_t:SystemLow-SystemHigh[/usr/local/industry/sh2/api/]$ cat /etc/passwdroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinnews:x:9:13:news:/etc/news:uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologinnscd:x:28:28:NSCD Daemon:/:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinpcap:x:77:77::/var/arpwatch:/sbin/nologinrpc:x:32:32:Portmapper RPC user:/:/sbin/nologinmailnull:x:47:47::/var/spool/mqueue:/sbin/nologinsmmsp:x:51:51::/var/spool/mqueue:/sbin/nologinapache:x:48:48:Apache:/var/www:/sbin/nologinoprofile:x:16:16:Special user account to be used by OProfile:/home/oprofile:/sbin/nologinntp:x:38:38::/etc/ntp:/sbin/nologinhsqldb:x:96:96::/var/lib/hsqldb:/sbin/nologinxfs:x:43:43:X Font Server:/etc/X11/fs:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:4294967294:4294967294:Anonymous NFS User:/var/lib/nfs:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinavahi:x:70:70:Avahi daemon:/:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinavahi-autoipd:x:100:104:avahi-autoipd:/var/lib/avahi-autoipd:/sbin/nologingdm:x:42:42::/var/gdm:/sbin/nologinmysql:x:500:500::/home/mysql:/bin/bashnagios:x:501:501::/home/nagios:/bin/bash[/usr/local/industry/sh2/api/]$ [/usr/local/industry/sh2/api/]$ ipconfig/bin/sh: ipconfig: command not found[/usr/local/industry/sh2/api/]$ ifconfigeth0      Link encap:Ethernet  HWaddr F0:1F:AF:DC:E9:31            inet addr:211.144.132.51  Bcast:211.144.132.63  Mask:255.255.255.224          inet6 addr: fe80::f21f:afff:fedc:e931/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:306157769 errors:0 dropped:0 overruns:0 frame:0          TX packets:323832613 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:166805423119 (155.3 GiB)  TX bytes:276261539837 (257.2 GiB)          Interrupt:177 lo        Link encap:Local Loopback            inet addr:127.0.0.1  Mask:255.0.0.0          inet6 addr: ::1/128 Scope:Host          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:80762571 errors:0 dropped:0 overruns:0 frame:0          TX packets:80762571 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:252860008976 (235.4 GiB)  TX bytes:252860008976 (235.4 GiB)\n话说怎么这么多的恶意APP呢，就是这样来的吧！   修复方案：  人民群众需要安全的平台！   版权声明：转载请注明来源 zzR@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-11-20 16:55 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  你在乌云这么淫荡，你家里人知道吗？    \n     2013-11-20 16:59 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @小胖子 你猜·    \n     2013-11-20 17:55 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  淫荡啊    \n     2013-11-22 15:37 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  这么给力？    \n     2013-11-22 16:15 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @wefgod @niliu 事情呢就是这么个事情，情况呢就是这么个情况    \n     2013-11-22 18:50 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @zzR 速速公开。    \n     2014-01-04 16:17 |    \t\t乌云 \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:14        | a)\t\t \n  我擦。。。这就忽略了。。。。    \n     2014-12-31 21:45 |    \t\t大亮 \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:65        | 慢慢挖洞)\t\t \n  远程命令执行是怎么弄的？？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}