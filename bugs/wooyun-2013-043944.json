{"id": 8060, "wybug_id": "wooyun-2013-043944", "wybug_title": "爱毒霸社区存在高危敏感信息泄露风险", "wybug_corp": "金山毒霸", "wybug_author": "猪猪侠", "wybug_date": "2013-11-24 21:39", "wybug_open_date": "2013-11-25 11:04", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "错误信息未屏蔽"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-25：\t厂商提前公开漏洞，细节向公众公开  简要描述： 由于没有一个通用标准的防御规则保护好中间件配置信息、DNS信息、业务数据信息、用户信息、源码备份文件、版本管理工具信息、系统错误信息和敏感地址信息(后台或测试地址)的泄露，攻击者可能会通过收集这些保护不足的数据，利用这些信息对系统实施进一步的攻击。 详细说明：  #1 信息泄露原因由于论坛管理员在更新服务器文件时，未注意到编辑器会默认创建各种.bak文件用来规避错误编辑时引发的数据丢失风险，从而造成了更严重的信息安全问题。#2 泄露地址网站: http://bbs.m.duba.com 存在信息泄露:文件1：http://bbs.m.duba.com/config/config_global.php.bak文件2：http://bbs.m.duba.com/config/config_ucenter.php.bak #3 泄露内容\n<?php$_config = array();// ---------------------------- CONFIG DB ----------------------------- //$_config['db']['1']['dbhost'] = 'localhost';$_config['db']['1']['dbuser'] = 'root';$_config['db']['1']['dbpw'] = '62***29';$_config['db']['1']['dbcharset'] = 'gbk';$_config['db']['1']['pconnect'] = '0';$_config['db']['1']['dbname'] = 'bbs_iappsafe';$_config['db']['1']['tablepre'] = 'safe_';$_config['db']['common']['slave_except_table'] = '';\n\n<?phpdefine('UC_CONNECT', 'mysql');define('UC_DBHOST', '114.112.**.***');define('UC_DBUSER', 'root');define('UC_DBPW', 'kingsoft***11');define('UC_DBNAME', 'dybiduba');define('UC_DBCHARSET', 'gbk');define('UC_DBTABLEPRE', '`dybiduba`.cdb_uc_');define('UC_DBCONNECT', 0);define('UC_CHARSET', 'gbk');define('UC_KEY', 'q8c8X96253G0d8*****************aB4H8G2k1Gbb0GbA589mc');define('UC_API', 'http://bbs.duba.net/uc_server');define('UC_APPID', '1');define('UC_IP', '114.112.36.184');define('UC_PPP', 20);\n   漏洞证明：  #4 漏洞证明 (有UC_KEY，Discuz等于可以做任何事)详细利用方法参见： WooYun: 途牛网某服务配置失误 导致论坛敏感文件泄露(致使百万用户信息告急) #5 使用铁军的用户登陆\n\n#6 利用细节由于Discuz UC_SERVER 的updateapps接口未严格校验客户端提交的数据，导致可写入任意代码至/config/config_ucenter.php。\n$code=urlencode(_authcode(\"time=$timestamp&action=updateapps\", 'ENCODE', $uc_key));\n鉴于!Discuz在乌云已经属于无良厂商，这里不纰漏详细代码参照： WooYun: 又一次失败的漫游腾讯内部网络过程 #2   修复方案：  #1 网络边界需要认真对待。#2 杜绝为了方便而造成的不必要的信息泄露。#3 安全是一个整体，保证安全不在于强大的地方有多强大，而在于真正薄弱的地方在哪里。   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-11-25 08:42 厂商回复： 非常感谢猪猪侠的报告，我们尽快修复 最新状态： 2013-11-25：问题已修复，删除了相关备份文件，并且为防止再次发生，在webserver端屏蔽了对.bak的请求，再次感谢猪猪侠的报告，漏洞提前公开，供小伙伴们学习  ", "replys": "漏洞评价：\n评论\n     2013-11-24 21:40 |    \t\tdaige13 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        )\t\t \n  沙发    \n     2013-11-24 21:47 |    \t\t天朝城管 \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:35        | 不要等到命玩你的时候才开始玩命)\t\t \n  板凳    \n     2013-11-24 22:05 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  黑哥又出手了    \n     2013-11-24 23:31 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  前排    \n     2013-11-25 00:41 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @Hray    \n     2013-11-25 10:36 |    \t\tHRay \t\t\t( 普通白帽子  |\t\t\t        Rank:196 漏洞数:28        | 018)\t\t \n  @小胖胖要减肥 感谢提醒，已联系开发人员修复    \n     2013-11-25 12:58 |    \t\t花生^_^ \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 加强学习~~)\t\t \n  供小伙伴们学习~~~    \n     2013-11-25 13:46 |    \t\tshack2 \t\t\t( 普通白帽子  |\t\t\t        Rank:470 漏洞数:71        | QQ:1341413415 一个热爱编程(Java),热爱网...)\t\t \n  猪猪侠，专扫bak文件    \n     2013-11-25 14:43 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  铁军~~~态度转变了许多    \n     2013-11-25 16:24 |    \t\tHuc-Unis \t\t\t( 普通白帽子  |\t\t\t        Rank:1055 漏洞数:292        | 诶，现在通用奖励越来越低了；离买保时捷卡...)\t\t \n  猪哥要当老大了    \n     2013-12-10 21:01 |    \t\t炯炯虾 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我来自地球)\t\t \n  这个updateapps接口写任意代码需要网站是GBK才行  UTF8无效    \n     2013-12-26 22:21 |    \t\tlhshaoren \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:7        | OM)\t\t \n  流弊，思路真好    \n     2014-01-08 16:18 |    \t\t野驴~ \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 充满强烈好奇心的菜鸟。)\t\t \n  bak文件也不能直接访问也下载不了啊？求教大牛    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}