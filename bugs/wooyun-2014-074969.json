{"id": 593, "wybug_id": "wooyun-2014-074969", "wybug_title": "Discuz! 多数版本可被暴力破解，包括UCenter", "wybug_corp": "Discuz!", "wybug_author": "lijiejie", "wybug_date": "2014-09-04 09:41", "wybug_open_date": "2014-10-19 09:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向公众公开  简要描述： Discuz! 多数版本均可被暴力破解，包括UCcenter，我只测试了几个例子，有些深入的工作没有做。若是要写个全自动化的工具，还得多花点心思。  :) 详细说明：  很简单的问题，Discuz取不到用户的真实IP，可以被X-Forwarded-For头和Client-IP头绕过，伪造欺骗源IP。导致攻击者可以无限次数发起登录请求。以锤子手机的论坛为例： Discuz! X3。找到ID为1的管理员用户是webmaster： http://bbs.smartisan.cn/home.php?mod=space&uid=1\n\n锤子论坛没有验证码，胡乱输入错误5次，提示错误次数过多：\n\n在FirFox的扩展中设置X-Forwarded-For头为114.114.114.114，发现又可以尝试登录了：\n\n经测试，UCenter的登陆页照样有效：http://bbs.smartisan.cn/uc_server/admin.php?m=user&a=login&iframe=&sid=修改Request Header可以无限次数尝试登录。将验证码保存到本地不做处理，用tesseract识别结果如下：\n\n解决验证码识别率的问题后，即可完成一个自动化的暴力破解工具。未进一步测试。   漏洞证明：  http://www.discuz.net(Discuz! X3.2)和http://xy2.netease.com/(Discuz! 7.2)测试，均有效当大话西游BBS提示“密码错误次数过多，请 15 分钟后重新登录”后，只要修改X-Forwarded-For或Client-IP的值，即可继续尝试登录（大话西游的BBS无验证码）。http://www.discuz.net会要求输入验证码，但绕过单个IP的登录次数限制，同理。攻击时可以先收集管理员和版主的uid列表，再挂个密码字典。   修复方案：  解决被X-Forwarded-For和Client-IP绕过   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-09-04 12:12 厂商回复： 感谢您提出的问题，我们尽快予以处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-04 09:44 |    \t\t′  雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  client ip？    \n     2014-09-04 10:29 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  .........    \n     2014-09-04 15:31 |    \t\tcnrstar \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:23        | Be my personal best!)\t\t \n  UCenter怎么爆破的？有验证码吧。。    \n     2014-09-05 10:59 |    \t\tHmily \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 吾爱破解论坛)\t\t \n  @Discuz! ，现在你也就在乌云确认的快，能内部推动下安全补丁发布吗，上次更新还是6月份，中间这几个月N个漏洞都公开了补丁还没发布，任意删文件，随便拿shell，网站都日完了，光确认有个屁用啊？    \n     2014-09-05 12:13 |    \t\tcnrstar \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:23        | Be my personal best!)\t\t \n  @Hmily 52pojie被脱裤了么？    \n     2014-09-05 13:59 |    \t\tHmily \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 吾爱破解论坛)\t\t \n  @cnrstar 没有发现被脱，只是吐槽不争气的官方。    \n     2014-09-05 14:24 |    \t\tcnrstar \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:23        | Be my personal best!)\t\t \n  @Hmily 哈哈，公司越大效率越低，没办法。PS：瞻仰您很久了，赞啊赞。    \n     2014-09-10 08:57 |    \t\t铁汉 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 向各种大神学习之)\t\t \n  exp会很快放出    \n     2014-10-05 15:47 |    \t\t风花雪月 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:44        | []+[]|[]-[][][][][]%[][]|[]\\[]%[][]|[]\\[...)\t\t \n  @铁汉 坐等    \n     2014-10-06 20:56 |    \t\tcnrstar \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:23        | Be my personal best!)\t\t \n  你妹的，就是伪造IP嘛，我还以为你绕过验证码了。。    \n     2014-10-21 17:19 |    \t\t可乐 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:5        | QQ:442167492)\t\t \n  我擦，这就给10rank，尼玛，我发农行的注入点才13rank    \n     2014-10-25 20:57 |    \t\t暖暖 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:2        | 屌丝一个。)\t\t \n  我去= =    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}