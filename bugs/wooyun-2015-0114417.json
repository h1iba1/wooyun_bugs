{"id": 31288, "wybug_id": "wooyun-2015-0114417", "wybug_title": "爱卡汽车网重置手机绑定以及某处鸡肋型xss", "wybug_corp": "爱卡汽车网", "wybug_author": "SheepGuest", "wybug_date": "2015-05-18 10:20", "wybug_open_date": "2015-07-02 10:38", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当", "跨站脚本攻击"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-02：\t细节向公众公开  简要描述： 本来想搞个xss蠕虫，来配合重置手机绑定，各种扫描器都不想用了，手工找找可能存在xss的地方，结果自己阅历太低，找到一个用起来比较鸡肋的xss,我日... 详细说明：  好了,开始...  本来我是想测试手机号方面的漏洞，但本人最近很穷，买不起新号，所以想到官网解绑自己的手机，结果发现只能更换无法解绑，后来无意中发现轻轻更改下参数即可解绑，本以为只是自慰版的，结果刷新界面之后真的解绑了，才有了下文...\n登陆爱卡网，并查看自己，我这里已经绑定手机号了，显示一个标识\n\n\n\n接着来到手机绑定页面，选择《更改号码》\n\n\n\n问题就出在h这个参数上，将2改成4即可重置手机绑定...\n\n\n\nhttp://my.xcar.com.cn/set/mobile.php?h=4  提示取消，回过头看下个人主页发现手机标识不见了\n\n\n\n\n   漏洞证明：  \n达到目的了自然，但问题是没啥用...所以就想找xss利用下，探索半小时，发现了一个似储存型非储存型的xss，诶，所以开头我把它称为鸡肋型xss..最终的蠕虫poc也随之泡汤了..\n\n问题出在这里 消息==》短消息==》发送短消息 ... 这里我建了一个小号，方便站内发送以便验证漏洞.. 用ie8打开爱卡网，登陆自己的小号，然后编辑短消息，发送给 360浏览器的大号\n\nie8（小号）--》360(大号) 就是这个样子，下面是结果..\n\n\n\n\n\n弹了，哈哈，但问题是只能弹一次 /(ㄒoㄒ)/~~ 而且必须是对方正在和你说话的时候才能触发...因为我发的代码在发完之后就自动过滤掉了script，明显用的黑名单规则，而接收方也只是一瞬间才能看到...重新刷新就会出现如下的情况..\n\n\n\n即使这样依然可以盗cookie，也可以将手机号码重置，为了节省文本，重置我就不掩饰了，相信连小学生都会..这里我只给cookie截个图吧\n\n\n\n到这里 我的蠕虫节奏就彻底跟我说拜拜了，相信我日后一定能在重新来过..另外也请爱卡网的技术大大赶快修复此漏洞吧，别让不法分子利用了，只要找到合适的xss肯定会引起一场暴乱...\n   修复方案：  技术大大们更专业...   版权声明：转载请注明来源 SheepGuest@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-05-18 10:37 厂商回复： 感谢@SheepGuest的帮助，问题已经确认，我们会尽快修复此问题！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-18 13:05 |    \t\tblast \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:57        | 五仁委员会)\t\t \n  你关注的白帽子 SheepGuest 发表了漏洞 爱卡汽车网重置手机绑定以及某处鸡肋型xss    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}