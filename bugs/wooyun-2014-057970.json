{"id": 4617, "wybug_id": "wooyun-2014-057970", "wybug_title": "腾讯QQ android 客户端存在用户敏感信息泄漏", "wybug_corp": "腾讯", "wybug_author": "路人甲", "wybug_date": "2014-04-23 18:37", "wybug_open_date": "2014-04-24 14:45", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：   腾讯qq客户端，里面声明了如下的一个acitivity<activity android:name=\".activity.ForwardRecentActivity\" android:launchMode=\"singleTop\" android:screenOrientation=\"portrait\" android:configChanges=\"locale|keyboardHidden|orientation\" android:alwaysRetainTaskState=\"true\" android:windowSoftInputMode=\"adjustPan\">            <intent-filter>                <action android:name=\"com.tencent.intent.QQ_FORWARD\" />                <category android:name=\"android.intent.category.DEFAULT\" />            </intent-filter>        </activity>  根据android 的官方说明，如果acitity，默认没有声明export，其在声明了filter，该acitity将默认发布出去。  攻击着，采用显示intent调用component： com.tencent.mobileqq   com.tencent.mobileqq.activity.ForwardRecentActivity 能够唤起页面，这个里面含有最近联系人信息，且点击 qq好友能够看到好友分组全部信息，信息泄漏（此时用户可以不处于登录状态）   1：登录qq   2：注销 qq   3：发送一个intent，可以唤起页面【里面有历史聊天人员】\n\n   4：可以点击，[qq好友] 按钮，看到所有的分组和qq好友信息【泄漏】。 \n\n   漏洞证明：  Intent qq = new Intent();\t ComponentName com = new ComponentName(\"com.tencent.mobileqq\",\t \"com.tencent.mobileqq.activity.ForwardRecentActivity\");\t qq.setComponent(com);\t startActivity(qq);   修复方案：  1、业务上控制，当前页面进行拦截，如果发现没有登录，跳转到登录页面2、如果该activity只是qq内部使用，建议将sign级别的签名或者干脆就不要暴露出去，即添加android:exported=\"false\"   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-04-24 14:45 厂商回复： 非常感谢您的报告，经评估该问题在官方最新版本4.7下并不存在。如有其它发现，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-23 18:38 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  前排关注！    \n     2014-04-23 20:02 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  是匿名递交的 还是新人报道可以远程不    \n     2014-04-23 20:09 |    \t\t浅兮 \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:30        )\t\t \n  怎么泄露的，像QQshell那种？    \n     2014-04-23 20:19 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  感觉会被忽略    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}