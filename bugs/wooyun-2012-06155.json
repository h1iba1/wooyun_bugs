{"id": 20624, "wybug_id": "wooyun-2012-06155", "wybug_title": "139邮箱XSS漏洞，发个邮件弹死你，应该可以蠕动一下", "wybug_corp": "中国移动", "wybug_author": "一刀终情", "wybug_date": "2012-04-17 17:59", "wybug_open_date": "2012-04-22 17:59", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-04-22：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 139邮箱XSS漏洞，发个邮件弹死你，应该可以蠕动一下。某两处可控的写入部分，其中一处似乎完全未过滤，一处仅过滤了引号，似乎是可以蠕动一下，水平不够。其他的邮箱看了一下，网易、gmail，qq似乎这里都没有过滤，但是不会构造，没能成功，大家研究一下~ 详细说明：  问题在，显示邮件发件人、发送邮箱部分。\n\n图中框出部分~这部分内容是可控的，研究过smtp的知道，显示的发件人、收件人都是可以伪造的；跟实际发送者无关，所用测试代码<iframe onload=alert(/a/);>，测试代码前后都加了些引号及<>，看看屏蔽内容的，不是太会描述，大家可以去研究其他的邮箱系统看看   漏洞证明：  \n\n\n\n   修复方案：  过滤？转义？   版权声明：转载请注明来源 一刀终情@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-04-22 17:59 厂商回复：  漏洞Rank：7  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-04-17 23:04 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @网易 网易成功弹窗    \n     2012-04-18 01:56 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  mk 地球太危险了    \n     2012-04-18 09:19 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  @一刀终情 弱弱的猜下 expression的？    \n     2012-04-18 09:29 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @wanglaojiu 没那么高级，直接写的；前后能闭合就行，没过滤    \n     2012-04-18 10:07 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  @一刀终情 是不是只能IE6，7的那个洞子？还是别的？    \n     2012-04-18 10:13 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @wanglaojiu 经测试，ie8，chrome有效，其他没测试；应该通用    \n     2012-04-18 10:20 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  @一刀终情 测试下看是不是Coremail通杀，Coremail的不同种类更新有细微差别。    \n     2012-04-18 12:06 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @wanglaojiu 应该是通杀了 果然是一刀的啊    \n     2012-04-18 13:42 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  @xsser 通杀的给力，不然不会引起太大的重视。    \n     2012-04-18 15:00 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @xsser 求大神测试其他的邮箱服务器，我实在太弱了……    \n     2012-04-18 15:30 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  @一刀终情 好多邮箱都是一些企业或者部门内部邮箱，不存在注册框，所以外人想测试其洞子并不容易。    \n     2012-04-18 16:02 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @wanglaojiu 我是觉得其他大的邮件服务商，可能也有这个问题，比如qq,gmail等，我不会了@@    \n     2012-04-18 16:53 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  @一刀终情 如何联系，我试试gmail看能搞搞不    \n     2012-04-18 16:57 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @wanglaojiu 私信已发    \n     2012-04-18 17:10 |    \t\tbeastk \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:11        | 一不小心高潮了)\t\t \n  求私信，我也想看看    \n     2012-04-18 17:45 |    \t\tpestu \t\t\t( 普通白帽子  |\t\t\t        Rank:170 漏洞数:13        | 关注计算机网络安全 lnmpa技术)\t\t \n  @一刀终情 关注    \n     2012-04-18 19:00 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  gainover@QQ.COM 同求。    \n     2012-04-18 19:43 |    \t\t冷冷的夜 \t\t\t( 普通白帽子  |\t\t\t        Rank:135 漏洞数:12        )\t\t \n  求细节    \n     2012-04-19 14:21 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  弹弹弹    \n     2012-04-19 14:24 |    \t\tEoh \t\t\t( 普通白帽子  |\t\t\t        Rank:286 漏洞数:35        )\t\t \n  @一刀终情 求私信    \n     2012-04-19 16:36 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  求私信    \n     2012-04-19 16:42 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @一刀终情 @wanglaojiu @beastk @gainover @冷冷的夜 @Eoh @Rookie 你们拿这个干嘛？    \n     2012-04-19 17:24 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @xsser 我没想法……就想知道是否对其他有效，但是没这本事~    \n     2012-04-19 21:20 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  @xsser 没事..只是学习一下 木啥恶意 淫荡 想法    \n     2012-04-20 08:53 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  @xsser 在学习中求进步。    \n     2012-04-20 09:11 |    \t\tgoderci \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:47        | http://www.yunday.org)\t\t \n  @一刀终情 求细节！    \n     2012-04-22 22:01 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  通过伪造发件人来xss,nice....    \n     2012-04-23 09:51 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @coremail 来看看？    \n     2012-04-23 10:12 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @horseluke 私信联系过了~判断是实现的问题，跟coremail无关    \n     2012-04-23 10:18 |    \t\tanyunix \t\t\t( 实习白帽子  |\t\t\t        Rank:86 漏洞数:8        | 号被盗。)\t\t \n  @一刀终情 ,网易测试成功？开玩笑吧。N年前就测试过了没有。。    \n     2012-04-23 10:44 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @anyunix 没必要忽悠大家~~    \n     2012-04-23 11:12 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @一刀终情 @anyunix 可能是功能变更    \n     2012-04-23 11:47 |    \t\tyoustar \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:8        | 我们人啊~)\t\t \n  这个是受了某个洞的启发    \n     2012-04-23 14:06 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @youstar 是的，word文档那个    \n     2012-07-14 09:57 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  PM球指教    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}