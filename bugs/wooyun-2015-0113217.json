{"id": 25715, "wybug_id": "wooyun-2015-0113217", "wybug_title": "盛大网络旗下之起点中文某服务器配置不当导致源码泄露", "wybug_corp": "盛大网络", "wybug_author": "greg.wu", "wybug_date": "2015-05-10 14:30", "wybug_open_date": "2015-06-25 09:46", "wybug_type": "重要敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向公众公开  简要描述： 配置失误导致源代码泄露 详细说明：  \nrsync 221.231.130.170::houtaidrwxr-xr-x        4096 2015/05/05 09:44:22 .-rw-r--r--           0 2015/04/15 14:49:46 1-rw-r--r--        2320 2015/05/04 16:15:25 index.php-rw-r--r--        1127 2015/04/27 16:39:04 login.php-rw-r--r--        1492 2015/04/29 14:31:24 tree.php-rw-r--r--         354 2015/04/04 13:02:53 yytree.phpdrwxr-xr-x        4096 2015/05/05 09:44:23 Releasedrwxr-xr-x        4096 2015/05/04 16:15:25 admindrwxr-xr-x        4096 2015/04/29 14:21:00 commondrwxr-xr-x        4096 2015/05/06 10:19:11 configdrwxr-xr-x        4096 2015/05/07 09:44:07 htmldrwxr-xr-x        4096 2015/03/31 13:40:01 imagedrwxr-xr-x        4096 2015/03/31 13:40:01 jquerydrwxr-xr-x        4096 2015/04/27 16:39:04 jsdrwxr-xr-x        4096 2015/03/31 13:40:01 logdrwxr-xr-x        4096 2015/03/31 13:40:01 styledrwxr-xr-x        4096 2015/05/04 16:15:25 utilrsync 221.231.130.170::www drwxr-xr-x        4096 2015/05/10 13:25:04 .-rw-r--r--           0 2015/04/14 17:52:08 1-rw-r--r--         109 2015/04/27 17:30:12 jump.html-rw-------          12 2015/05/10 13:25:04 test.txtdrwxr-xr-x        4096 2015/05/05 09:23:29 Releasedrwxr-xr-x        4096 2015/04/25 15:44:50 apidrwxr-xr-x        4096 2015/05/10 13:24:34 configdrwxr-xr-x        4096 2015/05/06 17:29:47 documentdrwxr-xr-x        4096 2015/05/08 17:13:56 htmldrwxr-xr-x        4096 2015/05/08 16:36:16 imagedrwxr-xr-x        4096 2015/04/14 17:41:34 logdrwxr-xr-x        4096 2015/04/14 17:40:22 publicdrwxr-xr-x        4096 2015/05/08 15:05:51 qdreaddrwxr-xr-x        4096 2015/04/14 17:41:34 qqreaddrwxr-xr-x        4096 2015/05/05 15:44:48 test\n   漏洞证明：  翻了下配置文件，是game.qidian.com相关的源码，有后台有前台，没有写权限，相关的数据库服务器好像也没法外联，就不进一步利用了\nspl_autoload_register('qd_autoLoad');//日志配置$logconfig = array('log_level' => 'DEBUG', 'log_type' => 'ConsoleLog', 'log_path' => ROOT_PATH . 'log' . DIRECTORY_SEPARATOR);//缓存服务器配置$cacheconfig = array(\t'type' => 'redis',\t'host' => '****.qidian.com',\t'port' => 6379,\t'timeout' => false,\t'persistent' => true,\t'expire' => 14400,\t'prefix' => 'game_qidian_',);//数据库连接配置$pdoconfig = array(\t'type' => 'mysql', // 数据库类型\t'hostname' => 'db1.game.qidian.com', // 服务器地址\t'database' => 'db_***_sy', // 数据库名\t'username' => 'db_***_user', // 用户名\t'password' => 'O*******Z', // 密码\t'hostport' => '3306', // 端口\t'dsn' => '', //\t'params' => array(PDO::ATTR_PERSISTENT => false), // 数据库连接参数\t'charset' => 'utf8', // 数据库编码默认采用utf8\t'prefix' => '', // 数据库表前缀);//模板配置信息$tplconfig = array(\t'tpl_dir' => ROOT_PATH . 'html' . DIRECTORY_SEPARATOR,\t'tpl_compile_dir' => ROOT_PATH . 'html' . DIRECTORY_SEPARATOR . 'compile' . DIRECTORY_SEPARATOR,\t'tpl_cache_dir' => ROOT_PATH . 'html' . DIRECTORY_SEPARATOR . 'cache' . DIRECTORY_SEPARATOR,);// cookie默认设置$cookieconfig = array(\t// cookie 名称前缀\t'prefix' => 'qdgc_',\t'path' => '', // cookie 保存路径\t'domain' => 'game.qidian.com', //cookie 有效域名);qidian\\Qidian::init();?>\n   修复方案：  屏蔽873或者访问控制   版权声明：转载请注明来源 greg.wu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-05-11 09:44 厂商回复： 谢谢报告，起点不属于盛大网络！！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}