{"id": 11341, "wybug_id": "wooyun-2013-025263", "wybug_title": "城通网盘VIP订单存在业务隐患,可在线提权", "wybug_corp": "城通网盘", "wybug_author": "imlonghao", "wybug_date": "2013-06-06 17:46", "wybug_open_date": "2013-07-21 17:47", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计错误", "搞笑有爱", "支付行业敏感"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-06：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-07-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 城通网盘(400gb.com)VIP订单存在隐患，一键开通VIP+系统管理员 (不过貌似没什么权限)貌似也很久没发洞了...-,-;;一直想发些好玩的东西，但，没找到 - -http://imlonghao.com/post/2013-06-06/城通网盘vip订单存在业务隐患  （骗流量的.在已修复的情况下可能会公开 -,-） 详细说明：  城通网盘对VIP服务进行支付时，运用的是相对安全的订单id支付，相对于直接使用金额来传输的话相对安全一些。但是，对于订单的id而言，和大多数厂商一样，都是采用简单的1,2,3,4,......,n-1,n这种格式的，因此，对于这种id格式的，可以进行遍历，这貌似在《白帽子讲web安全》里面有这个剧情...自行查阅课本..- -简单的看了看，城通网盘总共有9个不同的套餐第一个是2这里就发现问题了，第一个不是1，而是2，说明id=1的时候要么被删除了，要么是另外一个不显示的方案。于是乎，将购买链接改成：\nhttp://home.400gb.com/mydisk.php?item=vip&action=pay&viptype=1\n提交，妥妥的存在这个订单..完了发现，这还是个神奇的订单。。免费开通了个VIP，然后头衔变成了系统管理员.....可见，viptype=1这个套餐为管理员用的一个不对外公开的套餐。但是，由于viptype可以被遍历，于是=1这个套餐也就被公开掉了。(另外，可以越权删除别人的文件，请自行测试。若需帮助，请指出！)   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  viptype=1这种东西还是自己后台对着指定用户改吧。测试用户：imlonghao 以及 wooyun可以试试将viptype这个参数改为比较随机的、不容易被遍历的参数viptype=r14718y4viptype=hg894h0gviptype=g3d289dgetc.   版权声明：转载请注明来源 imlonghao@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-06-06 20:51 |    \t\tNicky \t\t\t( 普通白帽子  |\t\t\t        Rank:477 漏洞数:69        | http://www.droidsec.cn 安卓安全中文站)\t\t \n  0.0求个VIP    \n     2013-06-07 15:31 |    \t\t小乐天 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:14        | From KnownSec)\t\t \n  同求啊    \n     2013-07-21 19:02 |    \t\tITLynn \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:5        | 还有几天就去从军了，野战兵!)\t\t \n  楼主细心，涨姿势了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}