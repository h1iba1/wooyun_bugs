{"id": 21671, "wybug_id": "wooyun-2011-03417", "wybug_title": "Discuz! x2 201110版 报物理路径", "wybug_corp": "Discuz!", "wybug_author": "Php0day", "wybug_date": "2011-11-24 23:12", "wybug_open_date": "2011-12-24 23:13", "wybug_type": "敏感信息泄露", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["路径泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-11-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-11-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-11-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-01-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-01-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-02-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-12-24：\t细节向公众公开  简要描述：  详细说明：  \n<?php/** *      [Discuz!] (C)2001-2099 Comsenz Inc. *      This is NOT a freeware, use is subject to license terms * *      $Id: function_connect.php 24725 2011-10-09 14:48:51Z yangli $ *///这里没有加IN_DISCUZ常量判断//直接包函了文件require_once libfile('function/cloud');function connect_output_javascript($jsurl) {\treturn '<script type=\"text/javascript\">_attachEvent(window, \\'load\\', function () { appendscript(\\''.$jsurl.'\\', \\'\\', 1, \\'utf-8\\') }, document);</script>';}function connect_output_php($url, $postData = '') {\tglobal $_G;\t$response = dfsockopen($url, 0, $postData, '', false, $_G['setting']['cloud_api_ip']);\t$result = (array) unserialize($response);\treturn $result;}\n所以直接访问这个文件是会报错的   漏洞证明：  TestUrl:http://www.test.com/source/function/function_connect.php   修复方案：  加上判断\nif(!defined('IN_DISCUZ')) {\texit('Access Denied');}\n   版权声明：转载请注明来源 Php0day@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2011-11-25 17:20 厂商回复： 感谢您的细心和支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-11-26 15:17 |    \t\trootsecurity \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:20        | 关注开源，关注网络安全！INSERT INTO `w...)\t\t \n  看了下uc_server/control/admin/下的几个文件都有判断头，就db.php没有，看来是官方人员忘了。加!defined('IN_UC') && exit('ACCESS DENIED');就搞定了。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}