{"id": 71423, "wybug_id": "wooyun-2015-0145891", "wybug_title": "华为某处SQL注入涉及大量员工用户信息(已进入某国企\\高校等企业员工邮箱)", "wybug_corp": "华为技术有限公司", "wybug_author": "wooyun_def", "wybug_date": "2015-10-11 09:14", "wybug_open_date": "2015-11-27 18:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-27：\t细节向公众公开  简要描述： 我听大表哥说华为有礼物所以就来了，猜猜我大表哥是谁？ 详细说明：  漏洞源于http://wooyun.org/bugs/wooyun-2015-0128244快3个月了，仅仅是改了一下管理员密码，sql注入还没修复注入点http://enterprisehw.com/showlocalnews.php?id=441\n\n\navailable databases [3]:                                                       [*] ebgapp[*] information_schema[*] mysql\n\nDatabase: ebgapp                                                               [33 tables]+------------------+| admin            || classtree        || contacts         || contenttype      || devicelist       || doccache         || doccachetop      || documentpic      || forgetpass       || lang             || localnews        || messages         || msglog           || myfavorate       || papers           || praiselog        || prizelist        || purchase_consult || questions        || readlog          || related_app      || reviewlog        || scorelog         || searchkeywords   || sharelog         || sjbuseranswer    || sjbwinners       || toppic           || useranswer       || userinfo         || video_view_log   || video_view_stat  || winners          |+------------------+\n\n\n\n+---------+-----------+---------------+| AdminID | AdminName | AdminPassword |+---------+-----------+---------------+| 1       | admin     | \n\nmask 区域\n\n*****aaa*****\n\n\n\n   |+---------+-----------+---------------+\nadmin改了之后还是弱口令……下面是userinfo表中的内容\n\n\n\n2k多用户，里面不少华为员工的账号密码，于是就拿md5去破解得到71个华为员工的密码，成功率约为40%\n\nmask 区域\n*****0804   X1********** #@!32********** nina@********** Sunri********** @wy20********** admin**********   0o**********uawei&a**********   w1********** 7ujm***********   1@********** dlyd7**********wanghen********** Huawe********** Zxcv1**********   !Q********** a9000********** *Ensc**********   9o********** World********** ~123q********** Huawe********** huawe**********   Ma********** User@********** Pengh**********   as********** dw@88********** 12358********** Lucky********** micha**********   cd**********   l@********** Dupin********** forev**********   pi**********   1q********** xiaoc**********   l_********** 8ik,***********   Wi**********   DR**********   3e**********   MY********** ydy51**********   Pe********** qiu13********** 1qaz@********** @happ********** Wyy83********** huawe********** 12345**********   @4********** Jing-********** LJZ#1**********   ZZ********** chang********** Youwl********** oldfo********** QAZ12**********2345!@#********** !asdz********** @Sony********** 2wsx#**********   $R********** !Q2w3**********   ro********** @ming********** Apple********** tcy_1**********n123..&l*****\n\n尝试用以上密码登录w3mobile客户端，但 是 我 一 个 都 登 陆 不 上！！！看来密码都改过了，然而这样自私的漏洞修复行为是会影响其他企业的，部分已破解的邮箱密码：\n\nmask 区域\n*****.cn     Asdf@J*****\n\n\n\n众多攻城狮\n\n\n\nmask 区域\n*****du.cn    yizey*****\n\n\n\n\n\nmask 区域\n*****89.cn     w18*****\n\n\n\n\n\nmask 区域\n*****com      Whit*****\n\n人家众多简历泄露，这样真的好吗\n\n还有一个歪果仁\n\nmask 区域\n*****ud.com    Jam*****\n\n\n\n以上只是一部分，自己去看看数据库吧   漏洞证明：  如上   修复方案：  过滤，上WAF相关企业请找华为，程序员说：怪我咯？   版权声明：转载请注明来源 wooyun_def@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-10-13 18:23 厂商回复： 感谢wooyun_def对华为公司安全的关注，我们已经通知业务部门整改该问题。 最新状态： 2015-10-20：经核查，对存在漏洞的旧版APP已做下线处理，账号密码均已于2年前失效且无法正常登陆该系统。同时，我们已通知提醒受影响的用户修改密码。  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}