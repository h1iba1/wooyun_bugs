{"id": 50665, "wybug_id": "wooyun-2014-077196", "wybug_title": "设计逻辑错误导致账号密码泄露", "wybug_corp": "酒仙网", "wybug_author": "酱油君", "wybug_date": "2014-09-25 10:26", "wybug_open_date": "2014-11-09 10:28", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-09：\t细节向公众公开  简要描述： 由于逻辑设计存在缺陷，导致可以泄露用户账号密码 详细说明：  由于登陆的接口错误计数超过一定次数就会弹出验证码，但是由于计数的信息依赖于客户端，而不是在服务器段做验证，那么客户端可以随时伪造相关信息，就可以不用弹出验证，导致黑客可以进行扫号，爆账号密码。   漏洞证明：  1. 首先打开登陆页面https://login.jiuxian.com/login.htm2. 登陆几次之后，弹出验证码，如下图：\n\n3. 然后清除一下cookie, 再次刷新一下，就没有验证码了，如下图：\n\n根据这个原理，我们就弄个脚边，自动用来用爆账号密码。用之前扫出来的几十个账号，然后爆密码，就爆出来几个，如下图：\n\n\n\n\n\n还有部分，我就懒得去测试了，该漏洞可以被用来进行扫号。   修复方案：    危险程度比较高，容易被用来扫号。  1. 错误的计数信息不要依赖于客户端的返回数据，最好根据IP来做限制。   版权声明：转载请注明来源 酱油君@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2014-09-25 10:46 厂商回复： 您好，非常感谢您对酒仙网安全的关注，该问题确实存在，但我们之前已通过其他防御措施解决。谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}