{"id": 20553, "wybug_id": "wooyun-2012-05257", "wybug_title": "5sing.com借助第三方连接可创建重复昵称账户", "wybug_corp": "5sing.com", "wybug_author": "葫芦", "wybug_date": "2012-03-14 16:51", "wybug_open_date": "2012-04-28 16:51", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-03-14：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-04-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 绕过个人中心设置页面对昵称是否重复的校验，创建重复昵称。 详细说明：  5sing默认设置用户昵称不能重复，在个人中心修改时会在程序中校验。通过第三方连接，如“用QQ登陆”“微博登陆”功能注册时，会抓取第三方网站的昵称过来，直接写入到数据库作为昵称（数据库name字段应该没有unique）。这样一来，就能绕过程序中对昵称是否重复的校验。成功条件：要连接的第三方OAuth授权传回的昵称等于要伪造的昵称，可以是要伪造的昵称在5sing注册了，在第三方没有注册。或者是第三方不做重复性校验，比较典型的，豆瓣/QQ。个人想法：开始的时候觉得会不会是5sing的产品就是这么设计的，连接过来的昵称可以重复？但是试验过后在设置中把昵称改成另外的，再想改回来，是不行的。所以觉得这个是设计上或者开发上没有想周全。   漏洞证明：  以QQ登陆为例1.修改自己QQ昵称为现有用户昵称，为了方便，我这里就用首页推荐的“林妙可”作昵称\n\n2.在首页选择QQ登陆，授权连接。如果之前用自己的QQ连接过此网站，那么在管理中心-连接分享-设置中解除连接，安全退出以后重新用QQ登陆创建账号（5sing每一次解除再授权，会新建通行证，如果不绑定现有通行证的话）\n\n3.额。。试一试就知道了= = 找的现有用户不是个人针对，只是在首页随便找的，而且全部是汉字让大家能看清点\n\n   修复方案：  改呗。。没什么难度，就是可能耗点人工。   版权声明：转载请注明来源 葫芦@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-03-15 08:39 |    \t\tSGKer \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 乌拉轼)\t\t \n  等待披露~~ HOHO    \n     2012-03-30 12:10 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  外部关联：https://research.microsoft.com/pubs/160659/websso-final.pdf（原因：《Signing Me onto Your Accounts through Facebook and Google: a Traffic-Guided Security Study of Commercially Deployed Single-Sign-On Web Services》；第三方帐号连接安全）    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}