{"id": 58371, "wybug_id": "wooyun-2014-051444", "wybug_title": "OI in Hand可以登录任意用户", "wybug_corp": "www.oiinhand.info", "wybug_author": "路人甲", "wybug_date": "2014-02-21 19:04", "wybug_open_date": "2014-04-07 19:04", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-07：\t细节向公众公开  简要描述： 在api授权的时候可以利用设计缺陷使用一个不存在或别的用户的账户。 详细说明：  在使用OI in Hand云笔记的时候是用OI in Hand的账户登陆，在api授权的时候，开发人员直接把用户名POST给需要授权的应用，导致可以使用不存在的用户使用OI in Hand的各项功能。   漏洞证明：  首先在http://note.oiinhand.info/里点击“登录”登录。输入存在且正确的用户名和密码，点击登陆（先禁用JavaScript，否则会自动跳转，无法查看源代码）。\n\n查看“http://www.oiinhand.info/login_toapi.php”的源代码，发现有这么一行\n<input type=\"hidden\" value=\"XXX(你刚才登陆的用户名)\" name=\"login\" >\n例如我是用“soha”登陆的。\n\n好，我们再新建一个“crackoih.html”文件，把“http://www.oiinhand.info/login_toapi.php”的源代码复制进去，把XXX(你刚才登陆的用户名)换成别的任意字符串。\n\n这里我输入的是“hello,oih.i am cracking you~~”保存，运行“crackoih.html”（别忘了启用JavaScript），然后页面自动跳转到云笔记。看页面上方，果然是一个没有注册过的用户\n\n而且他们的主站貌似是和云笔记共用cookies的，所以在主站上为非作歹（当然我没有这么做），ip也不会被记录，因为你没有真正登陆。\n\n（貌似还可以通过这个查看别人的云笔记~（笑））   修复方案：  用些更安全的通信方式连接，或对传递的数据进行加密   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-02-21 19:12 厂商回复： 感谢对OIH的支持，我们会做得更好的~ 最新状态： 2014-02-22：漏洞已经修复  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}