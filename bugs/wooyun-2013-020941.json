{"id": 12825, "wybug_id": "wooyun-2013-020941", "wybug_title": "【盛大180天渗透纪实】第五章.无心插柳柳成萌 （某站上传漏洞导致服务器..，涉及一些用户文件）", "wybug_corp": "盛大在线", "wybug_author": "3King", "wybug_date": "2013-03-30 02:36", "wybug_open_date": "2013-05-14 02:37", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "设计不当导致攻击界面扩大", "任意文件上传", "解析漏洞", "数据库密码泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-14：\t细节向公众公开  简要描述： 小声明~【盛大180天渗透纪实】系列漏洞受到关注，表示灰常感谢~~·学生党一枚~ 不懂编程，不是大牛= =，所以这个专题完全是站在网络爱好者的角度来复现当时的思路，尽可能地还原真实环境，所以写得细了些~·本人提交这个系列的初衷，一是为了提醒厂商修复漏洞，二是为了和新人分享、交流渗透思路，共同提高~~所以欢迎各位专业人士、大牛来吐槽，指正~~Tips：·由于时间较长，有些漏洞可能已经更改或修复，所以某些场景只能通过以前截图来还原事件环境。·本次渗透可能涉及一些数据资料，但绝未脱库，谢绝跨省o(︶︿︶)o （相信盛大不是这样滴厂商~）  详细说明：  中间休息了一些天。。某日云游乌云，看到某牛提交盲打客服的漏洞。。寻思着，是不是盛大也有xss漏洞。。？怀着试试看的心情，来到了盛大客服。选择了网络接待。。在排队的过程中，手一抖。。点了一下查看源文件。。。向下翻的过程中，突然看到了一行闪亮的upload代码。。于是顺着代码来到了http://chjd.sdo.com/uploadimage.aspx\n\n选择了一个文件名为genimg.jpg的图片后上传，上传成功，返回的地址为：\n\n图片文件上传到了http://img.os.sdo.com/于是走进一看，win2003系统。在地址后面随意输入文件名，加后缀asp访问，没有出现执行限制。\n\n返回看图片上传规则，是%ID%-%原文件名%.jpg于是构造了一个畸形文件名，测试是否有IIS解析漏洞。。上传后去img.os.sdo.com一看，出现了可爱的execute报错。。\n\n菜刀连接之。。。\n\n数据库信息\n\n\n\n貌似这是玩家咨询客服时的资料上传站，内含大量用户上传信息，如身份证截图等。一旦被不法分子获取，后果将比较严重。。。   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  貌似这是玩家咨询客服时的资料上传站，内含大量用户上传信息，如身份证截图等。一旦被不法分子获取，后果将比较严重。。。·上传服务器严格设置执行权限·查找并确认服务器内是否还有web木马·修改本例中涉及的数据库密码·注意上传文件命名规则·求礼物~   版权声明：转载请注明来源 3King@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2013-04-01 15:26 厂商回复： 谢谢3King对盛大安全的关注！ 我们尽快修复，谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-30 06:06 |    \t\t小野 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 低调~)\t\t \n  兄弟，恭喜你搞笑成功了！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}