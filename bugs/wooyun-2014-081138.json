{"id": 378, "wybug_id": "wooyun-2014-081138", "wybug_title": "盛大游戏《夺冠之路》某活动系统未授权访问引发蝴蝶效应，涉及大量激活码、玩家数据", "wybug_corp": "盛大游戏", "wybug_author": "3King", "wybug_date": "2014-10-29 00:20", "wybug_open_date": "2014-10-29 11:00", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-29：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： http://www.wooyun.org/bugs/wooyun-2014-080889，盛大认为这是正常的业务设计，不是漏洞，评无影响或忽略，那今天就给你们演示演示如何通过这个产生影响。当初你们游戏送我鼠标垫的原因就是活动的未授权访问，现在我把人情还给你们。从此两清。希望你们sdg从此以后不要再拿鼠标垫来怀疑我的人品。否则这不是一个市值17亿公司的处事风格。 详细说明：  通过 WooYun: 盛大某系统设计缺陷可导致上千后台地址暴露 ，我们可以通过脚本批量获取所有接入盛大统一应用管理平台的后台管理地址。经过确认，目前最新的后台应用id为3373。如果只获取到很少数量的后台地址，那么没什么意义，因为这些后台业务都需要经过UAM的验证才能登入，否则都做未授权处理而被跳出。但是， WooYun: 盛大某系统设计缺陷可导致上千后台地址暴露 可以获取到大规模的后台地址，完全可以根据这些数据做出一些分析，然后举一反三。从这些后台地址可以分析出，盛大各大游戏平台的活动应用相当多，达到一千多个。这么多数量的活动，运维难免会出现一些疏忽。而 WooYun: 盛大某系统设计缺陷可导致上千后台地址暴露 获取到的后台地址是实时更新的，甚至包含前台未上线活动，那么完全可以猜测是否存在一般测试系统常见问题，如弱口令、未授权访问等。通过对这些后台地址进行遍历，发现http://act.fd.sdo.com/sys/admin_app/存在未授权访问。\n\n激活码。\n\n用户资料不贴。你们自己清楚。通过查看cookies发现，它对应的session path为站点根目录，而不是该应用路径。\n\n那么我们猜测，是否可以通过这个已经授权的session登录其它同域名下未授权登录的后台？于是从获取到的所有后台列表内查找act.fd.sdo.com相关后台，找到6个。\nhttp://act.fd.sdo.com/Project/GetCode/admin_app/http://act.fd.sdo.com/Project/Lottery/admin_app/Default.aspxhttp://act.fd.sdo.com/bbs/web1/admin_app/Default.aspxhttp://act.fd.sdo.com/lj/admin/Default.aspxhttp://act.fd.sdo.com/Project/sjbjc/admin_app/Default.aspxhttp://act.fd.sdo.com/Project/RLR/admin_app/Default.aspx\n于是这几个原本安全、需要统一验证才能登录的后台，由于这个未授权访问产生的session，全部变成未授权访问了。   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  ·当初你们游戏送我鼠标垫的原因就是活动的未授权访问，我通过这个漏洞把人情还给你们。从此两清。希望你们sdg不要再拿鼠标垫说事。这不是个市值17亿公司的处事风格。·自求多福。   版权声明：转载请注明来源 3King@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-10-29 01:15 厂商回复： 收到，已着手进行解决 最新状态： 2014-10-29：   ", "replys": "漏洞评价：\n评论\n     2014-10-29 00:23 |    \t\t健宇 \t\t\t( 普通白帽子  |\t\t\t        Rank:131 漏洞数:14        | tools kid)\t\t \n  你关注的白帽子 3King 发表了漏洞 盛大游戏《夺冠之路》某活动系统未授权访问引发蝴蝶效应，涉及大量激活码、玩家数据    \n     2014-10-29 00:26 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  否则这不是一个市值17亿公司的处事风格。.... 陈天桥要被气死了... 怎么可能才17亿....... @盛大 上个漏洞的态度的确欠妥, 我相信不是安全团队leader本人所为吧。  奖励是小，希望能够正视问题，端正态度。 ：）    \n     2014-10-29 00:57 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  这个屌!~    \n     2014-10-29 01:08 |    \t\t宝宝 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:33        | 我是好宝宝)\t\t \n  啥？还有鼠标垫送？我上次发的漏洞为啥木有提到鼠标垫......    \n     2014-10-29 01:20 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  @盛大网络 真能熬夜....1点多了 不睡觉的?    \n     2014-10-29 08:17 |    \t\tAerfa21 \t\t\t( 普通白帽子  |\t\t\t        Rank:165 漏洞数:44        )\t\t \n  3King真和盛大结仇了，期待更多盛大洞    \n     2014-10-29 08:19 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  叼。    \n     2014-10-29 08:27 |    \t\t盛大网络(乌云厂商)\t\t \n  发放开始时间是8月 发放结束时间是？    \n     2014-10-29 08:46 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  才17亿市值，不太可能吧？连小米的零头都不到啊。。。    \n     2014-10-29 09:46 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  给力    \n     2014-10-29 10:38 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @zeracker 哈哈，盛大早超过75亿了吧    \n     2014-10-29 10:40 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  发放开始时间是8月 发放结束时间是？   不知道盛大这回复啥    \n     2014-10-29 11:09 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  @wefgod 盛大在乌云这么火，都传到陈天桥了，陈天桥直接fire了这位小童鞋，小童鞋经受不住鸭梨，已经言语不清了，大牛你说我推测的正确不？    \n     2014-10-29 11:21 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  厂商很智慧，迅速确认，修复，公开，防止了一件事    \n     2014-10-29 11:32 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @浩天 防止了什么事？    \n     2014-10-29 11:39 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  @px1624 通过，确认，公开 每一步都很慢处理的话，会上3次首页，连续处理一次就够了，不出意外，下午晚些时候，或者明天首页就再也看不到了    \n     2014-10-29 11:40 |    \t\tki11y0u \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:23        | 好好学习，求带飞~~~~~~~~~~~~~~~~~~~~~~...)\t\t \n  3King 牛，威武。    \n     2014-10-29 12:03 |    \t\t盛大网络(乌云厂商)\t\t \n  @浩天 你想多了 处理完干嘛不公开呢    \n     2014-10-29 12:12 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  @盛大网络 你做的对，3king 又送来一个    \n     2014-10-29 12:39 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @浩天 。。额 原来如此，难怪我之前那个乌云众测的漏洞被这样处理了。哈哈    \n     2014-10-29 18:19 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Mody 哈哈同意    \n     2014-10-29 18:23 |    \t\t盛大网络(乌云厂商)\t\t \n  @Mody  请注意看图啊 观察要仔细     \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}