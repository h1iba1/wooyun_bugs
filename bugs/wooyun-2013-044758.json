{"id": 6654, "wybug_id": "wooyun-2013-044758", "wybug_title": "百度知道一处xss引发的一些问题", "wybug_corp": "百度", "wybug_author": "黑匣子", "wybug_date": "2013-12-03 10:21", "wybug_open_date": "2014-01-17 10:22", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型", "黑盒测试技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-17：\t细节向公众公开  简要描述： 百度知道一处xss，后台做了限制，找了很久方法都没有突破。猜想可以通过这个方法突破http://www.wooyun.org/bugs/wooyun-2010-026212。于是... 详细说明：  XSS漏洞细节地址:http://zhidao.baidu.com/prof/apply?step=2\n\n输入自己的XSS代码，不久就可以看到Cookie，\n\n可惜后台做了限制，访问不了，于是开始寻找“百度转码的URL漏洞”( WooYun: 我是如何漫游腾讯内部网络的  类似这样的漏洞)。看到乌云上已经发过类似的漏洞，就知道想在主站找到这个漏洞肯定没戏，于是我把目光放到了分站新闻站上\n\n打开连接修改后面的SRC=wooyun.org发现可以访问http://wap.baidu.com/ssid=0/from=0/bd_page_type=1/uid=0/pu=sz@224_220,ta@middle___3_537/t=news_top/tc?order=1&pfr=3-11-bdindex-top-6--&m=0&src=http%3A%2F%2Fwww.wooyun.org于是我修改成后台地址，发现报以下错误，看到报错，心情小激动，看来有戏了。http://wap.baidu.com/ssid=0/from=0/bd_page_type=1/uid=0/pu=sz@224_220,ta@middle___3_537/t=news_top/tc?order=1&pfr=3-11-bdindex-top-6--&m=0&src=http://xxxxx.baidu.com/mis/pgc_applylist?rn=10&keytype=&keyvalue=&order=time&type=1&pn=60\n\n改了Cookie重新访问了下，发现并没有什么变化。接下来又测试以下URL希望可以得到什么有用的信息，可是依然没有变化http://m.baidu.com/ssid=0/from=381a/bd_page_type=1/uid=0/pu=sz%40224_220%2Cta%40middle____/t=news_top/tc?order=1&pfr=3-11-bdindex-top-6--&m=0&src=http://admin@admin:xxxx.baidu.com:8080/mis/index于是我猜想可能是这个链接转码存在问题，功夫不苦有心人，又在小说处找到一处类似漏洞http://m.baidu.com/ssid=0/from=381a/bd_page_type=1/uid=0/pu=sz%40224_220%2Cta%40middle____/t=news_top/tc?order=1&pfr=3-11-bdindex-top-6--&m=0&src= http://xxxxx.baidu.com/mis/pgc_applylist?rn=10&keytype=&keyvalue=&order=time&type=1&pn=60赶紧测试了下，可是依然存在同样的问题，测试到这里，才知道前面的猜想都是错的，后台的访问权限可能只是给了某些IP，好想XSS个马继续搞，可惜那是黑客的行为，知道自己还不够格，就不继续了，呵呵。   漏洞证明：  \n\nhttp://wap.baidu.com/ssid=0/from=0/bd_page_type=1/uid=0/pu=sz@224_220,ta@middle___3_537/t=news_top/tc?order=1&pfr=3-11-bdindex-top-6--&m=0&src=http://www.wooyun.orghttp://m.baidu.com/ssid=0/from=381a/bd_page_type=1/uid=0/pu=sz%40224_220%2Cta%40middle____/t=news_top/tc?order=1&pfr=3-11-bdindex-top-6--&m=0&src=http://www.wooyun.org   修复方案：  XSS可能存在专家介绍或者工作单位这两处   版权声明：转载请注明来源 黑匣子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2013-12-03 10:48 厂商回复： 感谢提交，安全组立即处理此问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}