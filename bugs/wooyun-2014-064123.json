{"id": 1556, "wybug_id": "wooyun-2014-064123", "wybug_title": "跨站跨站再跨站导致快捷酒店管家裤子泄漏+getshell", "wybug_corp": "上海智展", "wybug_author": "s0mun5", "wybug_date": "2014-06-09 09:43", "wybug_open_date": "2014-09-07 09:44", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-09：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-09-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 只需30秒，找到身边的如家、汉庭、7天…再用30秒，会员价完成预订！连锁酒店官方合作，随时都能订到房内置导航功能，到店无忧！覆盖数百个城市，近万家分店，走到哪儿，订到哪儿，真正的订房利器！ 详细说明：  \n\n客户端留言反馈xss跨到后台http://h.133.cn/hotel/message/view?m=3xxxxm为客户id\n\n这个后台是不需要认证的 也可以改id遍历所有用户这里客户端反馈添加图片可以上传任意文件 burp做代理抓包改报可以 绕过方式比较奇葩 有时成功又是不成功http://h.133.cn/cr/message/upimages/1403311714283119_..2.jpg20140331170036.5518190440721.php_.html http://h.133.cn/cr/message/upimages/1403311712419434_..2.jpg20140331170036.5518190440721.php_.php这就属于成功的这里还能发送任意短信\n\n\n\n   漏洞证明：  然后注入\nhttp://h.133.cn/hotel/message/v?t=hotel&k2=1601&k1=020%27%20and%201=2%20union%20select%20user(),database(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17%23\n这就是主数据库 后面getshell后验证了\n\n然后各种链接看网页源码找到一个后台 http://dz.133.cn/login.jsp这里可以任意注册进去后随便找一个分店认领 \n\n资料图片可以任意上传 绕过方式比较奇葩 三个后缀名就可以了.jsp.jpg.jsp然后备注资料写入xss代码 可以跨到 http://dz.133.cn/admin/login.jsp这个后台 查看shell地址这里cookie已经失效 就不截图了然后就getshell了\n\n数据就漏了 各种用户的信息\n\n   修复方案：  不要试图找我是谁了 我又没搞破坏：)权限控制好 代码过滤好吧   版权声明：转载请注明来源 s0mun5@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：12 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2014-06-09 10:08 |    \t\t小杰 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 低调的一个人)\t\t \n  抢占第一排，兜售洞主的裤子！    \n     2014-06-09 22:30 |    \t\tKuuki \t\t\t( 普通白帽子  |\t\t\t        Rank:158 漏洞数:23        | :P)\t\t \n  ...表示关注    \n     2014-09-07 13:03 |    \t\tArthur \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:33        | USA，I am coming！！！！！)\t\t \n  .......拒绝了，楼主什么时候开始散播裤子？    \n     2014-12-02 16:02 |    \t\t7z1 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:14        | 黑客：探险家、网络中的幽灵、用技术捍卫正...)\t\t \n   表示看楼主提交的洞含金量太高，持续关注  ~~~ ;P    \n     2015-01-13 14:26 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  @s0mun5，怎么想到用连续三个.jsp绕过的？fuzz？    \n     2015-01-13 14:55 |    \t\ts0mun5  \t\t\t( 普通白帽子  |\t\t\t        Rank:493 漏洞数:24        | .)\t\t \n  @luwikes 手贱    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 12, "Ranks": null}