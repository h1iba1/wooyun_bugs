{"id": 47825, "wybug_id": "wooyun-2014-085337", "wybug_title": "百度某站奇葩姿势getshell", "wybug_corp": "百度", "wybug_author": "if、so", "wybug_date": "2014-11-30 16:17", "wybug_open_date": "2015-01-14 16:18", "wybug_type": "应用配置错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-14：\t细节向公众公开  简要描述： 这一次我服了我自己，觉得是个不错的思路，哈哈哈哈哈 详细说明：  今天没事在看漏洞，看到了 WooYun: 百度某分站可getshell 这个漏洞，里面给出了webshell地址，随手访问了一下http://bbs.mgame.baidu.com/config/config_ucenter.php，菜刀连接失败，确实被修补了可是菜刀已经打开，有点不甘心啊！然后我就在意淫厂商修复漏洞的过程。感觉是这样：妈的，又被黑了！ssh连到服务器上，一般先是处理后门，找到config_ucenter.php，由于uckey getshell是修改uc_api的，所以要把uc_api还原，去掉后门代码，而且config_ucenter.php里面包含了数据库连接信息。管理员想，妈的，数据库账号密码我还记不住，我先备份一下吧，防止忘了，然后再去修改新的uc_key,uc_api。于是管理员备份了一个config_ucenter.php.bak有了这个思路，我尝试访问下http://bbs.mgame.baidu.com/config/config_ucenter.php.bak发现返回空白，什么都没有，没戏心想。可是过了2秒钟我恍然大悟，返回空白，那已经执行了啊，因为Apache有解析漏洞啊，而且根据我的设想，里面肯定有后门代码果断菜刀连接http://bbs.mgame.baidu.com/config/config_ucenter.php.bak，密码1成功连上\n\n这里的重点是利用了解析漏洞，因为假如bak文件不解析，里面配置文件可以显示出来了也没有用，因为uckey肯定改过了，数据库也一般在内网，无法利用。而且赌了这里肯定有后门代码。   漏洞证明：  \n\n   修复方案：  ..   版权声明：转载请注明来源 if、so@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-12-01 09:58 厂商回复： 感谢提交，已通知业务部门处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-30 16:18 |    \t\t90sid \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | (*^__^*))\t\t \n  mark.    \n     2014-11-30 16:21 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:157        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  mark.    \n     2014-11-30 16:28 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  前排观看新姿势    \n     2014-11-30 16:36 |    \t\t鸟云厂商  \t\t\t( 核心白帽子 |\t\t\t        Rank:1313 漏洞数:146        | 中国菜鸟)\t\t \n  百度和你什么仇什么怨？    \n     2014-11-30 17:35 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  mark    \n     2014-11-30 18:36 |    \t\tlaoyao \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:5        | ด้้้้้็็็็็้้้้้็็็็...)\t\t \n  表示关注    \n     2014-11-30 19:19 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  短板啊.....     \n     2014-11-30 19:57 |    \t\tif、so  \t\t\t( 核心白帽子 |\t\t\t        Rank:1008 漏洞数:91        | 梦想还是要有的，万一实现了呢？)\t\t \n  @zeracker 其实我也没抱多大希望，哈哈    \n     2014-12-01 09:08 |    \t\t狂人 \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:13        | Rank:999999999 漏洞数:999999999 | 小学生...)\t\t \n  前排出售百度shell一枚。。。    \n     2014-12-01 11:16 |    \t\t宝-宝 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:8        | 爱Web，也爱内核。 爱渗透，不爱暴力。爱0d...)\t\t \n  卧槽，屌爆了。。    \n     2014-12-22 09:04 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  我勒个去，这也可以………………给力的思路    \n     2014-12-22 12:27 |    \t\tif、so  \t\t\t( 核心白帽子 |\t\t\t        Rank:1008 漏洞数:91        | 梦想还是要有的，万一实现了呢？)\t\t \n  @wefgod 是的    \n     2014-12-31 10:10 |    \t\tPower \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:22        | 还需要等待.........)\t\t \n  ....    \n     2014-12-31 10:15 |    \t\t淡蓝色の忧伤 \t\t\t( 普通白帽子  |\t\t\t        Rank:172 漏洞数:26        | 开启审计php代码模式      (⊙v⊙)嗯)\t\t \n  长见识了……    \n     2014-12-31 10:17 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  脑洞太大了    \n     2014-12-31 13:58 |    \t\tObserver \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:8        | 我在夕阳下奔跑，那是我逝去的青春)\t\t \n  这。。。。确实够奇葩    \n     2015-01-08 12:35 |    \t\tsmarttang \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 乌云两个帐号都是我的...t.qq.com/mojige...)\t\t \n  我擦。。。这种意淫果然牛摆。。。    \n     2015-01-14 19:28 |    \t\ttodaro \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:12        | 完结。)\t\t \n  我去，你这脑洞开的太大了。    \n     2015-01-14 20:37 |    \t\t小涛 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 跟随大大们的脚本来的)\t\t \n  混脸熟    \n     2015-01-14 22:42 |    \t\t何文阳 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 我是小白 白帽)\t\t \n  一个漏洞竟能被利用三次...百度还是小心点别被利用四次    \n     2015-01-14 23:26 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  我擦，这样也行    \n     2015-01-15 09:51 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  我擦，这样也行    \n     2015-01-15 13:09 |    \t\t子墨 \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:22        | 天地不仁,以万物为刍狗;圣人不仁,以百姓为...)\t\t \n  我去    \n     2015-01-15 13:19 |    \t\tif、so  \t\t\t( 核心白帽子 |\t\t\t        Rank:1008 漏洞数:91        | 梦想还是要有的，万一实现了呢？)\t\t \n  @todaro @子墨 @px1624 @xsjswt 是啊，我就问这个洞该不该给闪电？    \n     2015-01-15 13:50 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @if、so 问我们有毛用，问管理。以创新思维方面，可以闪电啊    \n     2015-01-15 13:58 |    \t\tif、so  \t\t\t( 核心白帽子 |\t\t\t        Rank:1008 漏洞数:91        | 梦想还是要有的，万一实现了呢？)\t\t \n  @px1624 开玩笑的，无所谓了    \n     2015-01-15 14:00 |    \t\ttodaro \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:12        | 完结。)\t\t \n  @if、so  我是觉得可以了。运维是在想什么，也是蛮好奇的。    \n     2015-01-15 14:02 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  真的是脑洞极大啊！    \n     2015-02-12 10:57 |    \t\tdeepweb \t\t\t( 实习白帽子  |\t\t\t        Rank:67 漏洞数:9        | 2)\t\t \n  换位思考 好NB    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}