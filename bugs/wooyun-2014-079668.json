{"id": 49230, "wybug_id": "wooyun-2014-079668", "wybug_title": "联通某平台shell导致联通106短信随意发送/或可伪造任意号码发送", "wybug_corp": "中国联通", "wybug_author": "s0mun5", "wybug_date": "2014-10-16 21:52", "wybug_open_date": "2014-11-30 21:54", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-30：\t细节向公众公开  简要描述： 联通某平台shell导致联通106短信随意发送目测连接联通核心短信接口，或可伪造任意号码发送 详细说明：  http://www.ums86.com/联通的一信通 企业信息服务平台\nhttp://wenku.baidu.com/link?url=UAxsPIr3meNd8QOFLQ-UaoBPrdGbA0X5_7X-oq5QJqq9cyNFdKZGEed4T-fjmp_AABgHGBDfXj1srqkatqCCUzPRA4zjUkhNgfQRW31Mmxu\n这里是对企业短信发送接口的详细介绍访问主站后有一个账号规则变更的提示\n\n记下演示账号 101234在豆丁上找到内部资料得知企业账号开通后 对应的企业编号下有一个admin用户\n\n然后 密码找回存在漏洞\nhttp://www.ums86.com/pages/retrieveMotifyPass.jsp?spCode=101234\nspCode是企业id 直接访问这个页面可以绕过验证改密码\n\n\n\n101234用admin登陆提示用户名错误，验证码不过期，遍历id 100000-110000 匹配admin出现大量提示密码错误的，说明id正确，admin正确。随便选一个重置密码。进入管理界面。\n\n   漏洞证明：  导入通讯录功能可上传任意文件拿shell。\n\n有数台服务器在轮询但是数据相同海量配置信息 备份文件 共享磁盘  泄露只贴出部分以证明。\n<?xml version=\"1.0\" encoding=\"utf-8\"?><!-- the proxool configuration can be embedded within your own application's.\tAnything outside the \"proxool\" tag is ignored. --><something-else-entirely>\t<proxool>\t\t<alias>db_common</alias>                <driver-url>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.235)(PORT = 1521))(ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.234)(PORT = 1521))(LOAD_BALANCE = yes)(CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = ltdb) (FAILOVER_MODE = (TYPE = SELECT) (METHOD = BASIC)(RETRIES = 180) (DELAY = 5))))</driver-url>         <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>\t\t<driver-properties>\t\t\t<property name=\"user\" value=\"**_common\" />\t\t\t<property name=\"password\" value=\"**_common\" />\t\t</driver-properties>\t\t<house-keeping-sleep-time>300000</house-keeping-sleep-time>\t\t<simultaneous-build-throttle>20</simultaneous-build-throttle>\t\t<prototype-count>2</prototype-count>\t\t<maximum-connection-count>50</maximum-connection-count>\t\t<maximum-active-time>3600000</maximum-active-time>\t\t<minimum-connection-count>2</minimum-connection-count>\t\t<trace>true</trace>\t\t<test-before-use>false</test-before-use>\t\t<test-after-use>false</test-after-use>\t\t<house-keeping-test-sql>SELECT SYSDATE FROM DUAL</house-keeping-test-sql>\t</proxool>\t<proxool>\t\t<alias>db_nx</alias>                <driver-url>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.235)(PORT = 1521))(ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.234)(PORT = 1521))(LOAD_BALANCE = yes)(CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = ltdb) (FAILOVER_MODE = (TYPE = SELECT) (METHOD = BASIC)(RETRIES = 180) (DELAY = 5))))</driver-url>        <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>\t\t<driver-properties>\t\t\t<property name=\"user\" value=\"**_nx\" />\t\t\t<property name=\"password\" value=\"**_nx\" />\t\t</driver-properties>\t\t<house-keeping-sleep-time>300000</house-keeping-sleep-time>\t\t<simultaneous-build-throttle>2</simultaneous-build-throttle>\t\t<prototype-count>2</prototype-count>\t\t<maximum-connection-count>15</maximum-connection-count>\t\t<maximum-active-time>3600000</maximum-active-time>\t\t<minimum-connection-count>2</minimum-connection-count>\t\t<trace>true</trace>\t\t<test-before-use>false</test-before-use>\t\t<test-after-use>false</test-after-use>\t\t<house-keeping-test-sql>SELECT SYSDATE FROM DUAL</house-keeping-test-sql>\t</proxool>\t<proxool>\t\t<alias>db_cq</alias>                <driver-url>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.235)(PORT = 1521))(ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.234)(PORT = 1521))(LOAD_BALANCE = yes)(CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = ltdb) (FAILOVER_MODE = (TYPE = SELECT) (METHOD = BASIC)(RETRIES = 180) (DELAY = 5))))</driver-url>                <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>\t\t<driver-properties>\t\t\t<property name=\"user\" value=\"**_cq\" />\t\t\t<property name=\"password\" value=\"**_cq\" />\t\t</driver-properties>\t\t<house-keeping-sleep-time>300000</house-keeping-sleep-time>\t\t<simultaneous-build-throttle>2</simultaneous-build-throttle>\t\t<prototype-count>2</prototype-count>\t\t<maximum-connection-count>15</maximum-connection-count>\t\t<maximum-active-time>3600000</maximum-active-time>\t\t<minimum-connection-count>2</minimum-connection-count>\t\t<trace>true</trace>\t\t<test-before-use>false</test-before-use>\t\t<test-after-use>false</test-after-use>\t\t<house-keeping-test-sql>SELECT SYSDATE FROM DUAL</house-keeping-test-sql>\t</proxool>\t<proxool>                <alias>db_zx</alias>                <driver-url>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.235)(PORT = 1521))(ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.234)(PORT = 1521))(LOAD_BALANCE = yes)(CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = ltdb) (FAILOVER_MODE = (TYPE = SELECT) (METHOD = BASIC)(RETRIES = 180) (DELAY = 5))))</driver-url>                <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>                <driver-properties>                        <property name=\"user\" value=\"**_zx\" />                        <property name=\"password\" value=\"**_zx\" />                </driver-properties>                <house-keeping-sleep-time>300000</house-keeping-sleep-time>                <simultaneous-build-throttle>20</simultaneous-build-throttle>                <prototype-count>2</prototype-count>                <maximum-connection-count>100</maximum-connection-count>                <maximum-active-time>3600000</maximum-active-time>                <minimum-connection-count>2</minimum-connection-count>                <trace>true</trace>                <test-before-use>false</test-before-use>                <test-after-use>false</test-after-use>                <house-keeping-test-sql>SELECT SYSDATE FROM DUAL</house-keeping-test-sql>        </proxool>\t<proxool>                <alias>db_sh</alias>                <driver-url>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.235)(PORT = 1521))(ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.234)(PORT = 1521))(LOAD_BALANCE = yes)(CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = ltdb) (FAILOVER_MODE = (TYPE = SELECT) (METHOD = BASIC)(RETRIES = 180) (DELAY = 5))))</driver-url>                <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>                <driver-properties>                        <property name=\"user\" value=\"**_sh\" />                        <property name=\"password\" value=\"**_sh\" />                </driver-properties>                <house-keeping-sleep-time>300000</house-keeping-sleep-time>                <simultaneous-build-throttle>2</simultaneous-build-throttle>                <prototype-count>2</prototype-count>                <maximum-connection-count>25</maximum-connection-count>                <maximum-active-time>3600000</maximum-active-time>                <minimum-connection-count>2</minimum-connection-count>                <trace>true</trace>                <test-before-use>false</test-before-use>                <test-after-use>false</test-after-use>                <house-keeping-test-sql>SELECT SYSDATE FROM DUAL</house-keeping-test-sql>        </proxool>\t\t<proxool>                <alias>db_bh</alias>                <driver-url>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.235)(PORT = 1521))(ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.234)(PORT = 1521))(LOAD_BALANCE = yes)(CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = ltdb) (FAILOVER_MODE = (TYPE = SELECT) (METHOD = BASIC)(RETRIES = 180) (DELAY = 5))))</driver-url>                <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>                <driver-properties>                        <property name=\"user\" value=\"**_bh\" />                        <property name=\"password\" value=\"**_bh\" />                </driver-properties>                <house-keeping-sleep-time>300000</house-keeping-sleep-time>                <simultaneous-build-throttle>2</simultaneous-build-throttle>                <prototype-count>2</prototype-count>                <maximum-connection-count>25</maximum-connection-count>                <maximum-active-time>3600000</maximum-active-time>                <minimum-connection-count>2</minimum-connection-count>                <trace>true</trace>                <test-before-use>false</test-before-use>                <test-after-use>false</test-after-use>                <house-keeping-test-sql>SELECT SYSDATE FROM DUAL</house-keeping-test-sql>        </proxool>\t\t<proxool>                <alias>db_gd</alias>                <driver-url>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.235)(PORT = 1521))(ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.234)(PORT = 1521))(LOAD_BALANCE = yes)(CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = ltdb) (FAILOVER_MODE = (TYPE = SELECT) (METHOD = BASIC)(RETRIES = 180) (DELAY = 5))))</driver-url>              <!--<driver-url>jdbc:oracle:thin:@*.*.*.5:1521:orcl</driver-url>-->                <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>                <driver-properties>                        <property name=\"user\" value=\"**_gd\" />                        <property name=\"password\" value=\"**_gd\" />                </driver-properties>                <house-keeping-sleep-time>300000</house-keeping-sleep-time>                <simultaneous-build-throttle>10</simultaneous-build-throttle>                <prototype-count>2</prototype-count>                <maximum-connection-count>50</maximum-connection-count>                <maximum-active-time>3600000</maximum-active-time>                <minimum-connection-count>2</minimum-connection-count>                <trace>true</trace>                <test-before-use>false</test-before-use>                <test-after-use>false</test-after-use>                <house-keeping-test-sql>SELECT SYSDATE FROM DUAL</house-keeping-test-sql>        </proxool>\t\t<proxool>                <alias>db_sd</alias>                <driver-url>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.235)(PORT = 1521))(ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.234)(PORT = 1521))(LOAD_BALANCE = yes)(CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = ltdb) (FAILOVER_MODE = (TYPE = SELECT) (METHOD = BASIC)(RETRIES = 180) (DELAY = 5))))</driver-url>               <!--<driver-url>jdbc:oracle:thin:@*.*.*.5:1521:orcl</driver-url>-->                <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>                <driver-properties>                        <property name=\"user\" value=\"**_sd\" />                        <property name=\"password\" value=\"**_sd\" />                </driver-properties>                <house-keeping-sleep-time>300000</house-keeping-sleep-time>                <simultaneous-build-throttle>5</simultaneous-build-throttle>                <prototype-count>2</prototype-count>                <maximum-connection-count>25</maximum-connection-count>                <maximum-active-time>3600000</maximum-active-time>                <minimum-connection-count>2</minimum-connection-count>                <trace>true</trace>                <test-before-use>false</test-before-use>                <test-after-use>false</test-after-use>                <house-keeping-test-sql>SELECT SYSDATE FROM DUAL</house-keeping-test-sql>        </proxool>\t\t<proxool>                <alias>db_fj</alias>                <driver-url>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.235)(PORT = 1521))(ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.234)(PORT = 1521))(LOAD_BALANCE = yes)(CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = ltdb) (FAILOVER_MODE = (TYPE = SELECT) (METHOD = BASIC)(RETRIES = 180) (DELAY = 5))))</driver-url>                <!--<driver-url>jdbc:oracle:thin:@*.*.*.5:1521:orcl</driver-url>-->                <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>                <driver-properties>                        <property name=\"user\" value=\"**_fj\" />                        <property name=\"password\" value=\"**_fj\" />                </driver-properties>                <house-keeping-sleep-time>300000</house-keeping-sleep-time>                <simultaneous-build-throttle>5</simultaneous-build-throttle>                <prototype-count>2</prototype-count>                <maximum-connection-count>25</maximum-connection-count>                <maximum-active-time>3600000</maximum-active-time>                <minimum-connection-count>2</minimum-connection-count>                <trace>true</trace>                <test-before-use>false</test-before-use>                <test-after-use>false</test-after-use>                <house-keeping-test-sql>SELECT SYSDATE FROM DUAL</house-keeping-test-sql>        </proxool>\t\t<proxool>                <alias>db_ss</alias>                <driver-url>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.235)(PORT = 1521))(ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.234)(PORT = 1521))(LOAD_BALANCE = yes)(CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = ltdb) (FAILOVER_MODE = (TYPE = SELECT) (METHOD = BASIC)(RETRIES = 180) (DELAY = 5))))</driver-url>                <!--<driver-url>jdbc:oracle:thin:@*.*.*.5:1521:orcl</driver-url>-->                <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>                <driver-properties>                        <property name=\"user\" value=\"**_ss\" />                        <property name=\"password\" value=\"**_ss\" />                </driver-properties>                <house-keeping-sleep-time>300000</house-keeping-sleep-time>                <simultaneous-build-throttle>2</simultaneous-build-throttle>                <prototype-count>2</prototype-count>                <maximum-connection-count>25</maximum-connection-count>                <maximum-active-time>3600000</maximum-active-time>                <minimum-connection-count>2</minimum-connection-count>                <trace>true</trace>                <test-before-use>false</test-before-use>                <test-after-use>false</test-after-use>                <house-keeping-test-sql>SELECT SYSDATE FROM DUAL</house-keeping-test-sql>        </proxool>\t\t<proxool>        <alias>db_imessage</alias>\t\t<driver-url>jdbc:oracle:thin:@(DESCRIPTION =(ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.223)(PORT = 1521))\t\t\t(CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = orcl)))</driver-url>                 <!--<driver-url>jdbc:oracle:thin:@*.*.*.5:1521:orcl</driver-url>-->                <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>                <driver-properties>                        <property name=\"user\" value=\"imessage\" />                        <property name=\"password\" value=\"yxt1m\" />                </driver-properties>                <house-keeping-sleep-time>300000</house-keeping-sleep-time>                <simultaneous-build-throttle>10</simultaneous-build-throttle>                <prototype-count>2</prototype-count>                <maximum-connection-count>100</maximum-connection-count>                <maximum-active-time>3600000</maximum-active-time>                <minimum-connection-count>2</minimum-connection-count>                <trace>true</trace>                <test-before-use>false</test-before-use>                <test-after-use>false</test-after-use>                <house-keeping-test-sql>SELECT SYSDATE FROM DUAL</house-keeping-test-sql>        </proxool>\t <proxool>\t<alias>db_imessage1</alias>                <driver-url>jdbc:oracle:thin:@(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.235)(PORT = 1521))(ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.234)(PORT = 1521))(LOAD_BALANCE = yes)(CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = ltdb) (FAILOVER_MODE = (TYPE = SELECT) (METHOD = BASIC)(RETRIES = 180) (DELAY = 5))))</driver-url>                <!--<driver-url>jdbc:oracle:thin:@*.*.*.5:1521:orcl</driver-url>-->                <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>                <driver-properties>                        <property name=\"user\" value=\"imessage\" />                        <property name=\"password\" value=\"yxt1m\" />                </driver-properties>                <house-keeping-sleep-time>300000</house-keeping-sleep-time>                <simultaneous-build-throttle>2</simultaneous-build-throttle>                <prototype-count>2</prototype-count>                <maximum-connection-count>25</maximum-connection-count>                <maximum-active-time>3600000</maximum-active-time>                <minimum-connection-count>2</minimum-connection-count>                <trace>true</trace>                <test-before-use>false</test-before-use>                <test-after-use>false</test-after-use>                <house-keeping-test-sql>SELECT SYSDATE FROM DUAL</house-keeping-test-sql>        </proxool>\t<proxool>        <alias>db_union_prov</alias>                <driver-url>jdbc:oracle:thin:@(DESCRIPTION =(ADDRESS = (PROTOCOL = TCP)(HOST = *.*.*.223)(PORT = 1521))                        (CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = orcl)))</driver-url>                <!--<driver-url>jdbc:oracle:thin:@*.*.*.223:1521:orcl</driver-url>-->                <driver-class>oracle.jdbc.driver.OracleDriver</driver-class>                <driver-properties>                        <property name=\"user\" value=\"**_union_prov\" />                        <property name=\"password\" value=\"ton9y1pl\" />                </driver-properties>                <house-keeping-sleep-time>300000</house-keeping-sleep-time>                <simultaneous-build-throttle>100</simultaneous-build-throttle>                <prototype-count>2</prototype-count>                <maximum-connection-count>200</maximum-connection-count>                <maximum-active-time>240000</maximum-active-time>                <minimum-connection-count>2</minimum-connection-count>                <trace>true</trace>                <test-before-use>false</test-before-use>                <test-after-use>false</test-after-use>                <house-keeping-test-sql>SELECT SYSDATE FROM DUAL</house-keeping-test-sql>        </proxool></something-else-entirely>\n\n\n\n\n\n\n至于内部短信接口，数不胜数。这是联通官方业务，所以猜测最终接口可以伪造任意号码发送。顾忌影响业务，不深入测试。还有一个http://ibss.ums86.com/业务支撑系统用户名存在注入。\n\n库名CSP。   修复方案：  内部信息不对外。优化逻辑。   版权声明：转载请注明来源 s0mun5@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-10-20 13:33 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-16 22:58 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  发短信给10086 ，成天发骚扰短信    \n     2014-10-17 09:23 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  好像很厉害的样子！    \n     2014-10-17 09:53 |    \t\t大漠長河 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:7        | ̷̸̨̀͒̏̃ͦ̈́̾( 天龙源景区欢迎您...)\t\t \n  应该是个代理服务器吧 等公开    \n     2014-10-17 13:11 |    \t\tby灰客 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:12        )\t\t \n  扥公开    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}