{"id": 628, "wybug_id": "wooyun-2014-074760", "wybug_title": "完美世界商城SQL注入POST注射（四）", "wybug_corp": "完美时空", "wybug_author": "darkrerror", "wybug_date": "2014-09-02 13:52", "wybug_open_date": "2014-10-17 13:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-17：\t细节向公众公开  简要描述： 在乌云搜了一下，还没人发shop商城下的注入 详细说明：  之前发现的一个注入，在提交前看了下完美的漏洞，发现又有人提交了，目前还没修复。 WooYun: 完美时空分站SQL盲注 那就来一发POST姿势，将该请求的cookie去掉：POST http://event.shop.wanmei.com/qtshop/qtShopLoginAction.do HTTP/1.1Host: event.shop.wanmei.comProxy-Connection: keep-aliveContent-Length: 38Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://event.shop.wanmei.comUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://event.shop.wanmei.com/jsp/qtshop/login.jspAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6account=admin&password=admin&rand=1111受影响的数据库：\n\n数据库“huodong1_6”中包含上千个表：\n\n\n\n其他小问题：越权：对任意账号进行解封http://esales.wanmei.com/e/users/getsafecode.jsp?safeType=releaseurl跳转：http://event7.wanmei.com:8888/chibi/cbcomesfortuna/user.action?redirect:http://www.baidu.comhttp://event8.wanmei.com/wulin2/wllegend/essence!list.action?redirect:Http://www.baidu.com   漏洞证明：  \n\n   修复方案：  跪求礼物   版权声明：转载请注明来源 darkrerror@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-09-04 17:51 厂商回复： 感谢洞主对完美世界的关注，漏洞已确认存在，我们将尽快修复，谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-03 17:42 |    \t\tdarkrerror \t\t\t( 普通白帽子  |\t\t\t        Rank:263 漏洞数:44        )\t\t \n  @完美时空 快确认啊    \n     2014-09-04 10:51 |    \t\t完美时空(乌云厂商)\t\t \n  Get类型的可以直接一条URL就够了，但是既然是post类型的，那能把post的位置点说一下吗，谢谢！    \n     2014-09-04 14:18 |    \t\tdarkrerror \t\t\t( 普通白帽子  |\t\t\t        Rank:263 漏洞数:44        )\t\t \n  @完美时空 给您发私信了 ：）    \n     2014-09-05 16:27 |    \t\tdarkrerror \t\t\t( 普通白帽子  |\t\t\t        Rank:263 漏洞数:44        )\t\t \n  没礼物，不提交了，唉    \n     2014-09-10 15:05 |    \t\tdarkrerror \t\t\t( 普通白帽子  |\t\t\t        Rank:263 漏洞数:44        )\t\t \n  @完美时空 这次修复的挺快啊，我都想给你发礼物了。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}