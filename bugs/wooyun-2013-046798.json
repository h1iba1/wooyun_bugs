{"id": 6188, "wybug_id": "wooyun-2013-046798", "wybug_title": "MTVCHINA敏感信息泄露间接导致服务器沦陷", "wybug_corp": "mtvchina.com", "wybug_author": "猪猪侠", "wybug_date": "2013-12-23 13:34", "wybug_open_date": "2014-02-06 13:34", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "用户敏感信息泄漏", "后台被猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-23：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-02-06：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 由于没有一个通用标准的防御规则保护好中间件配置信息、DNS信息、业务数据信息、用户信息、源码备份文件、版本管理工具信息、系统错误信息和敏感地址信息(后台或测试地址)的泄露，攻击者可能会通过收集这些保护不足的数据，利用这些信息对系统实施进一步的攻击。 详细说明：  #1 信息泄露原因由于MTVCHINA管理员在设置httpd中间件管理用户的主目录时，未注意到bash会默认创建各种.bash_history、.bash_profile文件用来生成对应的SHELL环境，从而造成了更严重的信息安全问题。#2 泄露内容网站：http://www.mtvchina.com泄露文件：http://www.mtvchina.com:80/.bash_history#3 泄露内容\nls -laFpwdexitsu -su -clearps -efuptimedf -hpwdls -laFexitdf -hps -efsu -pwdsu -exitsu -exitsu -exitsu -exitps -efssh webmast@223.202.40.227ifconfig -a |moreps -efsu -exitsu -exitsu -exitsu -exitsu -exitsu -ls -lsu -exitsu -exitsu -exitsu -exitexitexitsu -ps -efsu -exitscreen -lssu -pwdwhoamissh-keygenssh-copy-id -i ~/.ssh/id_rsa.pub 203.90.245.2ssh 203.90.245.2screen -lssu -exitsu -exitsu -exitps -efexitpwdcd ..ls -lcd mmh.mtvchina.com/ls -lcd wwwls -lsu -exitsu -pwdsu -exitsu -exitsu -exitsu -exitsu -exitsu -exitsu -exitsu -exitsu -exitsu -exitsu -ps -efclearps -efuptimeexitvi index.php cd homelsvi index.php cd ../inclscd phplscd ../csslsvi randombg.php cd ../phplsclearls -lvi header.phpclearls -lcd ../l;spwdcd..cd homelscd ..lscd wwwlscd homelsvi index.php cd inccd phplscd ..lscd inccd phplsvi script.phpcd ..lscd ..cd homevi index.php pwdcd phplscd ../lscd inc/phplsls -ltvi header.phpvi functions.phpvi script.phpclearls -lcd ../ionccd ../csslsclearls -lclearls -lclearls -lclearls -lclearpwdvi randombgvi randombg.php clearls -lexitclearls -lpwdcd imagescd background/ls -lcd ..lsclearls -lcd ..lsls -llscd inclscd csslsclearls -lvi randombg.php cd ..lscd imageslscd background/lsls -lcd inclscd cssvi randombg.php clearmysql -h localhost -u root -pmysql -verisonmservice mysqldservice mysqld startnetstat -an |moremysql -versionmysql -u rootservice mysqldservice mysqld statussuiptablesiptables -hcleartelnet whereis telnetwhereis mysql/usr/bin/mysql -h mtvasia-dev.cceh89v04vih.ap-southeast-1.rds.amazonaws.com -u mtvasia -plspwdcd adminlscd homelsvi index.php cd ../inclscd phplsvi security.php cd cDbcon.php vi cDbcon.php mysql -u root -PukWioHW40mysqlmysql -h 127.0.0.1 -u root -pexitmysql -h localhost -u root -pmysql -h 127.0.0.1 -u root -pmysql -h localhost -u root -pmysql -h 127.0.0.1 -u root -pmysql -h 127.0.0.1 -u root .pmysql -h 127.0.0.1 -u root -pmysqldump -u root -p ukWioHW40 cms_mtvchina > /data/htdocs/mtvchina.com/www/db_2******8.sqlmysqldump -u root -p cms_mtvchina > /data/htdocs/mtvchina.com/www/db_2******8.sqlmysqldump -h 127.0.0.1 -u root -p cms_mtvchina > /data/htdocs/mtvchina.com/www/db_2******8.sqlmysqldump -h 127.0.0.1 -u root -p --default-character-set=gbk cms_mtvchina > /data/htdocs/mtvchina.com/www/db_2******8_utf8.sqlmysql -h 127.0.0.1 -u root -pmysqldump -h 127.0.0.1 -u root -p --default-character-set=utf8 cms_mtvchina > /data/htdocs/mtvchina.com/www/db_2******8_utf8.sqlmysql -h 127.0.0.1 -u root -pmysql -h 192.168.0.123 -u root -pmysql -h 127.0.0.1 -u root -pcat /proc/versionservice httpd restart/sbin/service httpd restartsu -su -su -\n   漏洞证明：  #4 泄露数据利用\nmysqldump -u root -p ukWioHW40 cms_mtvchina > /data/htdocs/mtvchina.com/www/db_2******8.sql 这里管理员利用mysqldump备份了数据库至WEB目录，可以从WEB端访问下载。\n\n\n#5 管理后台http://www.mtvchina.com/admin/home/#6 登陆后台\n\n#7 获取SHELL，进而服务器沦陷\n\n   修复方案：  #1 网络边界需要认真对待#2 杜绝为了方便而造成的不必要的信息泄露#3 安全是一个整体，保证安全不在于强大的地方有多强大，而在于真正薄弱的地方在哪里   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：10 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2013-12-23 14:27 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:2738 漏洞数:547        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  我是来膜拜滴    \n     2013-12-23 20:35 |    \t\tAnonymous \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:30        | 园长是大傻逼)\t\t \n  - 服务器沦陷    \n     2013-12-23 20:48 |    \t\t233 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 小孩子看了根本把持不住)\t\t \n  3L这么靠前    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 10, "Ranks": null}