{"id": 5670, "wybug_id": "wooyun-2014-049051", "wybug_title": "360webscan 0.1.1.9 XSS防御绕过", "wybug_corp": "奇虎360", "wybug_author": "mramydnei", "wybug_date": "2014-01-16 13:49", "wybug_open_date": "2014-03-02 13:50", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-02：\t细节向公众公开  简要描述： 防御正则存在严重缺陷 详细说明：  先来一段你们防御XSS+SQLi的正则：\n$getfilter = \"<[^>]*?=[^>]*?&#[^>]*?>|\\\\b(alert\\\\(|confirm\\\\(|expression\\\\(|prompt\\\\()|<[^>]*?\\\\b(onerror|onmousemove|onload|onclick|onmouseover)\\\\b[^>]*?>|^\\\\+\\\\/v(8|9)|\\\\b(and|or)\\\\b\\\\s*?([\\\\(\\\\)'\\\"\\\\d]+?=[\\\\(\\\\)'\\\"\\\\d]+?|[\\\\(\\\\)'\\\"a-zA-Z]+?=[\\\\(\\\\)'\\\"a-zA-Z]+?|>|<|\\s+?[\\\\w]+?\\\\s+?\\\\bin\\\\b\\\\s*?\\(|\\\\blike\\\\b\\\\s+?[\\\"'])|\\\\/\\\\*.+?\\\\*\\\\/|<\\\\s*script\\\\b|\\\\bEXEC\\\\b|UNION.+?SELECT|UPDATE.+?SET|INSERT\\\\s+INTO.+?VALUES|(SELECT|DELETE).+?FROM|(CREATE|ALTER|DROP|TRUNCATE)\\\\s+(TABLE|DATABASE)\";\n存在的问题大致可以分为两类：第一，onerror,onmousemove,onload.onclick,onmouseover作为属性出现在没有闭合的标签内时，不会被拦截。但是这种没有闭合的标签都会被后面的标签所闭合，导致可以植入恶意代码。比如说:\n<img src=x onerror=print()%20\n第二，过滤关键字alert(),confirm(),prompt()和expression()从某种意义上说是可以拦截一部分扫描工具的检测，但是没有实际意义。举个简单的bypass例子:\n<img src=x onerror=window[/aler/.source%2b/t/.source](1)%20\n这种关键字完全是可以拆分的，即使实在GPC开启的情况下也没有办法拦截，因为单双引号都有完美的替代品就是//.souce   漏洞证明：  \n\n   修复方案：  我不懂正则，但是你们可以根据绕过方案做针对性修改   版权声明：转载请注明来源 mramydnei@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2014-01-16 18:07 厂商回复： 感谢关注和反馈，该问题在新版中进行修复。考虑到性能和简单性，这个脚本只提供了基础的功能防护，目标是为了进行最基础的SQL注入和XSS防护。完整功能请使用360网站卫士：wangzhan.360.cn 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-16 14:00 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  前排关注！    \n     2014-01-16 14:53 |    \t\t狗狗侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:497 漏洞数:55        | 我是狗狗侠)\t\t \n  能绕过注入么，大神    \n     2014-01-16 16:03 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  webscan是他们的扫描器还是防护产品？    \n     2014-01-20 19:20 |    \t\t小逸 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | 说你能做的,做你说过的.)\t\t \n  有点业务合作，亲，加下我扣扣  3389802    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}