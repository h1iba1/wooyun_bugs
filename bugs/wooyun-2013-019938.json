{"id": 13957, "wybug_id": "wooyun-2013-019938", "wybug_title": "YY客户端本地存储密码bug", "wybug_corp": "广州多玩", "wybug_author": "rvey", "wybug_date": "2013-03-12 11:38", "wybug_open_date": "2013-03-17 11:38", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 鸡肋的东西，自娱自乐而已。。看看能不能骗两个rank 详细说明：  嗯。。鸡肋的东西   漏洞证明：  嗯。。。如题 今天玩了一会yy。。感觉很不爽。。。 于是看一下这个无比搓的程序。。 另外。我不是搞逆向神马的。。只是简单的看一下。。期待大神分析 yy缓存+配置信息    就是你不手动清理永远留在c盘那种垃圾。。最高可达到N个G的文件（鄙视一下yy程序员） \nC:\\Users\\Administrator\\AppData\\Roaming\\duowan\n登录配置信息 \nC:\\Users\\Administrator\\AppData\\Roaming\\duowan\\yy4.0\\account\n说明一下： \n<?xml version=\"1.0\"?><account> <name>YWJjY2VyMw==</name>   ---base64加密 就是账号id <uniqueid>4gufQaqQzvg2</uniqueid> <imstatus>Q8VULnOFagk=</imstatus> <loginType>MA==</loginType> <logoindex>-1</logoindex> <hash3>fEeoWaE6IPTRLjeqsHfGrqR7iaBkbr4vNzBt9EDMhrYefXYNTTphBwBoGuq8pxvvV1EV7Iw7sae7wvcmDs6prirVeLeXy+/9Ido6bHYv3oq+ShZPiEm2NqKD4gZlmH7OMmI5ZTA=</hash3>      ----密码hash <saved>dHJ1ZQ==</saved>     --base64加密   true（是否正确） </account>\n继续吐槽楼上所说的hash   当然简单的copy这个account信息到另一台机器上是无法登录的 但是。。坑爹的事情来了。。。 我经过对比5组hash文件。。得出的结论 = = 仔细观察 \nfEeoWaE6IPTRLjeqsHfGrqR7iaBkbr4v   NzBt9EDMhrY   efXYNTTphBwBoGuq8pxvvV1EV7Iw7s  ae7wvcmDs6prirVeLeXy+/9Ido6bHYv3oq+ShZPiEm2NqKD4gZlmH7OMmI5ZTA=   a2 fEeoWaE6IPTRLjeqsHfGrqR7iaBkbr4v   NzBt9EDMhrY   efXYNTTphBwBoGuq8pxvvV1EV7Iw7s  ae7wvcmDs6prirVeLeXy+/9Ido6bHYv3oq+ShZPiEm2NqKD4gZlmH7OMmI5ZTA=   a3 fEeoWaE6IPTRLjeqsHfGrqR7iaBkbr4v   NzBt9EDMhrY   efXYNTTphBwBoGuq8pxvvV1EV7Iw7s  adlw+inTNKuhFMNnLJdwN5cC5eHtC21orhGwW9DyGZBiKvfxyc+tEYyZjA3ZmI=   a1 fEeoWaE6IPTRLjeqsHfGrqR7iaBkbr4v   Y/l30VWUbow   efXYNTTphBwBoGuq8pxvvV1EV7Iw7s  ae7wvcmDs6prirVeLeXy+/9Ido6bHYv3oq+ShZPiEm2NqKD4gZlmH7OMmI5ZTA=   b-a2-1 fEeoWaE6IPTRLjeqsHfGrqR7iaBkbr4v   Y/l30VWUbow   efXYNTTphBwBoGuq8pxvvV1EV7Iw7s  ae7wvcmDs6prirVeLeXy+/9Ido6bHYv3oq+ShZPiEm2NqKD4gZlmH7OMmI5ZTA=   b-a2\n说明： \na2/a3/a1在a机器登录   b-a2/b-a2-1在b机器登录 a2/a3/b-a2/t-b2-1密码相同 a1密码不同 b-a2-1与其他网络环境不同（这个测试可能有问题）\n现在大家可以一目了然了。。 hash前32位（木有搞懂代表的什么，需要继续对比） 33-43 这十一位字符应该是判断当前机器。和某个东东对比，正确则可以使用account信息登录。 后63位字符就是密码hash了。。。（加密方式求大神分析） 经测试。。 \n1、把a机器的a1登录文件copy到b机器（此时不能登录） 2、使用b机器的b-a2的hash前74个字符覆盖a1的前74个字符就可以登录了\n呼呼~~~  大功告成。。。   修复方案：  更换客户端。效验方式   版权声明：转载请注明来源 rvey@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-03-17 11:38 厂商回复：  最新状态： 2013-04-01：感谢rvey对于欢聚时代(多玩/YY)的安全工作支持,后续会及时联系并派发礼物给你！谢谢，欢迎关注欢聚时代的安全工作！  ", "replys": "漏洞评价：\n评论\n     2013-03-14 08:02 |    \t\t剑指天涯 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 我是来乌云打酱油的，没提过漏洞，没拿过ra...)\t\t \n  沙发……    \n     2013-03-17 12:01 |    \t\t猫友 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 毕业于中国人民公安大学，现为某市公安特警...)\t\t \n  板凳    \n     2013-03-18 11:06 |    \t\t剑指天涯 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 我是来乌云打酱油的，没提过漏洞，没拿过ra...)\t\t \n  @猫友 你好基友…    \n     2013-04-01 17:25 |    \t\trvey \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:3        )\t\t \n  三天前联系的我。。说是工作失误忽略了 @xsser    \n     2013-04-01 17:28 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @rvey 永远工作失误... 这些人    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}