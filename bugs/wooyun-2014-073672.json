{"id": 851, "wybug_id": "wooyun-2014-073672", "wybug_title": "中国电信云某站任意上传可内网漫游", "wybug_corp": "中国电信", "wybug_author": "scanf", "wybug_date": "2014-08-24 17:22", "wybug_open_date": "2014-10-08 17:26", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传内容未检查"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-08：\t细节向公众公开  简要描述： 内网里面真是有意思啊！ 详细说明：  http://www.71etop.com/index.phpphpcms改的\n\n\n\n\n\n\n\n然后改包\n\n\n\n\n\n然后GO\n\n\n\n   漏洞证明：  然后弹个shell\nStarting Nmap 4.11 ( http://www.insecure.org/nmap/ ) at 2014-08-24 13:03 CSTInteresting ports on 172.16.11.19:Not shown: 1676 closed portsPORT     STATE SERVICE135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds3389/tcp open  ms-term-servInteresting ports on 172.16.11.21:Not shown: 1676 closed portsPORT    STATE SERVICE80/tcp  open  http135/tcp open  msrpc139/tcp open  netbios-ssn445/tcp open  microsoft-dsInteresting ports on 172.16.11.23:Not shown: 1674 closed portsPORT     STATE SERVICE80/tcp   open  http135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds1433/tcp open  ms-sql-s3389/tcp open  ms-term-servInteresting ports on 172.16.11.24:Not shown: 1674 closed portsPORT     STATE SERVICE80/tcp   open  http135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds1433/tcp open  ms-sql-s3389/tcp open  ms-term-servInteresting ports on 172.16.11.25:Not shown: 1674 closed portsPORT     STATE SERVICE80/tcp   open  http135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds1433/tcp open  ms-sql-s3389/tcp open  ms-term-servInteresting ports on 172.16.11.28:Not shown: 1671 closed portsPORT     STATE SERVICE53/tcp   open  domain80/tcp   open  http135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds3005/tcp open  deslogin3389/tcp open  ms-term-serv7007/tcp open  afs3-bos8080/tcp open  http-proxyInteresting ports on 172.16.11.29:Not shown: 1674 closed portsPORT     STATE SERVICE135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds3306/tcp open  mysql3389/tcp open  ms-term-serv4899/tcp open  radminInteresting ports on 172.16.11.41:Not shown: 1676 closed portsPORT    STATE SERVICE80/tcp  open  http135/tcp open  msrpc139/tcp open  netbios-ssn445/tcp open  microsoft-dsInteresting ports on 172.16.11.42:Not shown: 1674 closed portsPORT     STATE SERVICE80/tcp   open  http135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds1521/tcp open  oracle3389/tcp open  ms-term-servInteresting ports on 172.16.11.44:Not shown: 1675 closed portsPORT     STATE SERVICE80/tcp   open  http135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds3389/tcp open  ms-term-servInteresting ports on www.fjec.org.cn (172.16.11.45):Not shown: 1668 closed portsPORT     STATE SERVICE80/tcp   open  http81/tcp   open  hosts2-ns135/tcp  open  msrpc139/tcp  open  netbios-ssn443/tcp  open  https446/tcp  open  ddm-rdb1433/tcp open  ms-sql-s1521/tcp open  oracle3389/tcp open  ms-term-serv5001/tcp open  commplex-link8009/tcp open  ajp138081/tcp open  blackice-icecapInteresting ports on 172.16.11.46:Not shown: 1674 closed portsPORT     STATE SERVICE80/tcp   open  http135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds1521/tcp open  oracle3389/tcp open  ms-term-servInteresting ports on 172.16.11.52:Not shown: 1676 closed portsPORT     STATE SERVICE135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds3389/tcp open  ms-term-servInteresting ports on 172.16.11.53:Not shown: 1676 closed portsPORT     STATE SERVICE135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds3389/tcp open  ms-term-servInteresting ports on 172.16.11.54:Not shown: 1676 closed portsPORT     STATE SERVICE135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds3389/tcp open  ms-term-servInteresting ports on 172.16.11.55:Not shown: 1676 closed portsPORT     STATE SERVICE135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds3389/tcp open  ms-term-servInteresting ports on 172.16.11.56:Not shown: 1676 closed portsPORT     STATE SERVICE135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds3389/tcp open  ms-term-servInteresting ports on 172.16.11.57:Not shown: 1676 closed portsPORT     STATE SERVICE135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds3389/tcp open  ms-term-servInteresting ports on 172.16.11.59:Not shown: 1676 closed portsPORT     STATE SERVICE135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds3389/tcp open  ms-term-servInteresting ports on 172.16.11.68:Not shown: 1670 closed portsPORT     STATE SERVICE22/tcp   open  ssh111/tcp  open  rpcbind621/tcp  open  unknown950/tcp  open  oftep-rpc997/tcp  open  maitrd2049/tcp open  nfs5001/tcp open  commplex-link8009/tcp open  ajp138081/tcp open  blackice-icecap8082/tcp open  blackice-alertsInteresting ports on 172.16.11.69:Not shown: 1672 closed portsPORT     STATE SERVICE22/tcp   open  ssh111/tcp  open  rpcbind1015/tcp open  unknown5802/tcp open  vnc-http-26002/tcp open  X11:28009/tcp open  ajp138081/tcp open  blackice-icecap8082/tcp open  blackice-alertsInteresting ports on 172.16.11.70:Not shown: 1676 closed portsPORT     STATE SERVICE22/tcp   open  ssh111/tcp  open  rpcbind918/tcp  open  unknown1521/tcp open  oracleInteresting ports on 172.16.11.84:Not shown: 1674 closed portsPORT     STATE SERVICE21/tcp   open  ftp80/tcp   open  http135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds1025/tcp open  NFS-or-IISInteresting ports on 172.16.11.101:Not shown: 1675 closed portsPORT     STATE SERVICE80/tcp   open  http135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds3389/tcp open  ms-term-servInteresting ports on 172.16.11.102:Not shown: 1676 closed portsPORT     STATE SERVICE135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds3389/tcp open  ms-term-servInteresting ports on 172.16.11.103:Not shown: 1676 closed portsPORT     STATE SERVICE135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds3389/tcp open  ms-term-servInteresting ports on 172.16.11.116:Not shown: 1665 closed portsPORT      STATE SERVICE80/tcp    open  http81/tcp    open  hosts2-ns135/tcp   open  msrpc139/tcp   open  netbios-ssn445/tcp   open  microsoft-ds1025/tcp  open  NFS-or-IIS1026/tcp  open  LSA-or-nterm1027/tcp  open  IIS1031/tcp  open  iad21032/tcp  open  iad31500/tcp  open  vlsi-lm2030/tcp  open  device28080/tcp  open  http-proxy8082/tcp  open  blackice-alerts27000/tcp open  flexlm0Interesting ports on 172.16.11.117:Not shown: 1674 closed portsPORT     STATE SERVICE80/tcp   open  http81/tcp   open  hosts2-ns135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds2030/tcp open  device2Interesting ports on 172.16.11.118:Not shown: 1674 closed portsPORT      STATE SERVICE80/tcp    open  http81/tcp    open  hosts2-ns135/tcp   open  msrpc139/tcp   open  netbios-ssn445/tcp   open  microsoft-ds27000/tcp open  flexlm0Interesting ports on 172.16.11.119:Not shown: 1673 closed portsPORT      STATE SERVICE80/tcp    open  http135/tcp   open  msrpc139/tcp   open  netbios-ssn445/tcp   open  microsoft-ds1521/tcp  open  oracle5560/tcp  open  isqlplus27000/tcp open  flexlm0Interesting ports on 172.16.11.120:Not shown: 1676 closed portsPORT     STATE SERVICE111/tcp  open  rpcbind1521/tcp open  oracle8080/tcp open  http-proxy8082/tcp open  blackice-alertsInteresting ports on 172.16.11.121:Not shown: 1678 closed portsPORT     STATE SERVICE111/tcp  open  rpcbind1521/tcp open  oracleInteresting ports on 172.16.11.122:Not shown: 1677 closed portsPORT    STATE SERVICE135/tcp open  msrpc139/tcp open  netbios-ssn445/tcp open  microsoft-dsInteresting ports on 172.16.11.123:Not shown: 1676 closed portsPORT     STATE SERVICE111/tcp  open  rpcbind1521/tcp open  oracle8080/tcp open  http-proxy8082/tcp open  blackice-alertsInteresting ports on 172.16.11.124:Not shown: 1678 closed portsPORT     STATE SERVICE111/tcp  open  rpcbind1521/tcp open  oracleInteresting ports on 172.16.11.148:Not shown: 1677 closed portsPORT     STATE SERVICE21/tcp   open  ftp8009/tcp open  ajp139090/tcp open  zeus-adminInteresting ports on 172.16.11.149:Not shown: 1677 closed portsPORT     STATE SERVICE111/tcp  open  rpcbind8009/tcp open  ajp139090/tcp open  zeus-adminInteresting ports on 172.16.11.150:Not shown: 1677 closed portsPORT     STATE SERVICE80/tcp   open  http88/tcp   open  kerberos-sec8009/tcp open  ajp13Interesting ports on 172.16.11.164:Not shown: 1677 closed portsPORT     STATE SERVICE111/tcp  open  rpcbind1521/tcp open  oracle8082/tcp open  blackice-alertsInteresting ports on 172.16.11.196:Not shown: 1672 closed portsPORT     STATE SERVICE111/tcp  open  rpcbind648/tcp  open  unknown732/tcp  open  unknown2049/tcp open  nfs5801/tcp open  vnc-http-15901/tcp open  vnc-16001/tcp open  X11:18082/tcp open  blackice-alertsInteresting ports on 172.16.11.197:Not shown: 1679 closed portsPORT    STATE SERVICE111/tcp open  rpcbindInteresting ports on 172.16.11.198:Not shown: 1675 closed portsPORT     STATE SERVICE22/tcp   open  ssh111/tcp  open  rpcbind139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds1521/tcp open  oracleInteresting ports on 172.16.11.199:Not shown: 1670 closed portsPORT     STATE SERVICE111/tcp  open  rpcbind139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds792/tcp  open  unknown806/tcp  open  unknown2049/tcp open  nfs5801/tcp open  vnc-http-15901/tcp open  vnc-16001/tcp open  X11:18081/tcp open  blackice-icecapInteresting ports on 172.16.11.200:Not shown: 1678 closed portsPORT     STATE SERVICE111/tcp  open  rpcbind8082/tcp open  blackice-alertsInteresting ports on 172.16.11.212:Not shown: 1678 closed portsPORT     STATE SERVICE111/tcp  open  rpcbind2012/tcp open  ttyinfoInteresting ports on 172.16.11.213:Not shown: 1675 closed portsPORT     STATE SERVICE80/tcp   open  http111/tcp  open  rpcbind2000/tcp open  callbook8082/tcp open  blackice-alerts8888/tcp open  sun-answerbookInteresting ports on 172.16.11.214:Not shown: 1679 closed portsPORT    STATE SERVICE111/tcp open  rpcbindInteresting ports on 172.16.11.215:Not shown: 1678 closed portsPORT     STATE SERVICE111/tcp  open  rpcbind1521/tcp open  oracleInteresting ports on 172.16.11.216:Not shown: 1678 closed portsPORT     STATE SERVICE111/tcp  open  rpcbind8082/tcp open  blackice-alertsInteresting ports on 172.16.11.217:Not shown: 1678 closed portsPORT     STATE SERVICE111/tcp  open  rpcbind8082/tcp open  blackice-alertsInteresting ports on 172.16.11.218:Not shown: 1678 closed portsPORT     STATE SERVICE111/tcp  open  rpcbind2046/tcp open  sdfuncInteresting ports on 172.16.11.228:Not shown: 1675 closed portsPORT     STATE SERVICE135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds5432/tcp open  postgres8000/tcp open  http-altInteresting ports on 172.16.11.244:Not shown: 1676 closed portsPORT      STATE SERVICE21/tcp    open  ftp80/tcp    open  http111/tcp   open  rpcbind10000/tcp open  snet-sensor-mgmtInteresting ports on 172.16.11.245:Not shown: 1677 closed portsPORT     STATE SERVICE111/tcp  open  rpcbind1521/tcp open  oracle3306/tcp open  mysqlInteresting ports on 172.16.11.246:Not shown: 1679 closed portsPORT    STATE SERVICE111/tcp open  rpcbindNmap finished: 255 IP addresses (100 hosts up) scanned in 195.043 seconds\n然后开个代理进内网看看http://172.16.11.84/default.aspx弱口令admin / 123456\n\n\n\n   修复方案：  这个应该不要用本地js验证吧   版权声明：转载请注明来源 scanf@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2014-08-29 08:21 厂商回复： CNVD确认并复现所述情况，转由CNCERT向中国电信集团公司通报，由其后续协调省公司处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-24 22:09 |    \t\tflying \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 呵呵)\t\t \n  一楼不是偶然，    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}