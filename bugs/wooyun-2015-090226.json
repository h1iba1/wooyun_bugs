{"id": 46559, "wybug_id": "wooyun-2015-090226", "wybug_title": "中兴某网站任意用户密码重置漏洞（经典设计缺陷案例）", "wybug_corp": "中兴通讯股份有限公司", "wybug_author": "深度安全实验室", "wybug_date": "2015-01-06 16:46", "wybug_open_date": "2015-02-20 16:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-20：\t细节向公众公开  简要描述： 中兴某网站任意用户密码重置漏洞 详细说明：  中兴某网站任意用户密码重置漏洞   漏洞证明：  1.还是之前提交的那个中兴的应用之星网站\nhttp://www.appstar.com.cn\n，上面有积分可以换充值卡。\n WooYun: 中兴某网站的积分商城充值卡等礼品任意兑换漏洞 \n2.上面还有一个任意用户密码重置漏洞，找回密码链接的token不够随机，貌似就是当前时间。可以任意找回用户的密码而不用去查看邮箱中的找回链接是啥，重置别人的密码后就可以用别人的积分在积分商城里面来换取礼品。3.首先用2个账号同时找回密码来进行对比，开2个窗口，2个账号同时点击找回密码：\n\n\n\n4.去邮箱里面去查看找回密码的链接：\n\n随机token只相差4，我这里网络有点卡，如果是网络好，应该只相差1-2，token轻易被猜出来。5.接下来就是用构造的链接，找回密码了：\n\n6.可以在注册功能那块找到已经注册过的邮箱，已经注册过的邮箱会提示一个小红叉表示已经被注册过：\n\n没被注册\n\n已被注册   修复方案：  增强随机token   版权声明：转载请注明来源 深度安全实验室@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-01-07 08:45 厂商回复： 多谢~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-20 19:56 |    \t\tJumbo \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:29        | 猫 - http://www.chinabaiker.com)\t\t \n  不会过期吗    \n     2015-03-12 10:37 |    \t\tRipZ \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:38        | 安装tc130精神扰乱装置)\t\t \n  @Jumbo 修改的时候也是两个窗口几乎同时点击找回，看自己邮件里的token再小范围遍历对方账号的token，感觉也用不了几分钟吧。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}