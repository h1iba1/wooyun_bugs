{"id": 52416, "wybug_id": "wooyun-2014-071296", "wybug_title": "phpyun sql注入两处", "wybug_corp": "php云人才系统", "wybug_author": "′king", "wybug_date": "2014-08-09 19:50", "wybug_open_date": "2014-11-07 19:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-07：\t细节向公众公开  简要描述： 20140804. 详细说明：  刚下的20140804版本第一处 在wap/member/model/index.class.php中\nfunction saveresume_action()\t{ \t\tif($_POST['submit'])\t\t{\t\t\tif($_POST['eid']>0)\t\t\t{\t\t\t\t$table=\"resume_\".$_POST['table'];\t\t\t\t\t\t\t$id=(int)$_POST['id'];\t\t\t\t$url=$_POST['table'];\t\t\t\tunset($_POST['submit']);\t\t\t\tunset($_POST['table']);\t\t\t\tunset($_POST['id']);\n$table=\"resume_\".$_POST['table'];这里 没对$_POST[table] 进行限制 所以这里我们可以控制$table这里我们找一个能直接回显出数据的地方 Insert一个简历resume_expect\n\n然后直接去看简历\n\n直接出了数据。第二处 member/model/index.class.php中\nfunction resume_ajax_action()\t{\t\tinclude(PLUS_PATH.\"user.cache.php\");\t\t$table=\"resume_\".$_POST['type'];\t\t$id=(int)$_POST['id'];\t\t$info=$this->obj->DB_select_once($table,\"`id`='\".$id.\"'\");\n没有对$_POST['type']做限制 然后直接带入到了select中可以盲注。   漏洞证明：  \n\n   修复方案：  像这些post来的用in_array 限制一下。   版权声明：转载请注明来源 ′king@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-08-10 14:19 厂商回复： 感谢您的提供，我们会尽快修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}