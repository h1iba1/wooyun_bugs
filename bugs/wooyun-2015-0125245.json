{"id": 4503, "wybug_id": "wooyun-2015-0125245", "wybug_title": "吉祥人寿某分站(逻辑错误,敏感信息泄漏,SQL注入)漏洞打包", "wybug_corp": "吉祥人寿保险股份有限公司", "wybug_author": "茜茜公主", "wybug_date": "2015-07-07 22:32", "wybug_open_date": "2015-08-18 16:49", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-18：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 漏洞打包一起发，求高一点的rank 详细说明：  吉祥人寿赠险系统http://weixin.jxlife.com.cn/jxlife/jsp/traffic_mobile_index.jsp?FromUserName=\n\n问题1#利用抓包重放可达到短信任意发送\nPOST http://weixin.jxlife.com.cn/jxlife/jsp/getPhoneCode HTTP/1.1Accept: application/json, text/javascript, */*; q=0.01Content-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://weixin.jxlife.com.cn/jxlife/jsp/traffic_mobile_index.jsp?FromUserName=Accept-Language: zh-cnAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Host: weixin.jxlife.com.cnContent-Length: 22Connection: Keep-AlivePragma: no-cacheCookie: 229667067=0; JSESSIONID=D93E48BFF14BB07ECA416A5D0CACCF6B; CNZZDATA1254189807=1614033562-1436270012-%7C1436270012AppntPhone=你所指定的电话号码\n我大概在1分钟内，利用重放，给自己发了11条，当然，还可以更多。\n\n2#系统设计缺陷，短信验证码直接明文返回给用户，导致赠险可以任意领\n\n我用13888888888的号码给自己领了份赠险\n\n   漏洞证明：  3#sql注入\nhttp://weixin.jxlife.com.cn/jxlife/jsp/trafficDetailQuery.page?ContNo=900004299434&way=&QAppntIDNo=110101198808085638&QAppntPhone=13888888888\n\nParameter: ContNo (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause\n\n\n\n\n表LRPOL\n\n\n\n时间关系，不一一截图了，跑得比较慢   修复方案：  sql注入：请修改程序，参数化查询短信任意发送：后台程序判断发送次数与时间间隔，增加黑名单删除前台的验证码返回值求一个高点的rank，感谢   版权声明：转载请注明来源 茜茜公主@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-07-09 14:20 厂商回复： 谢谢，我们正核实修复。 最新状态： 2015-07-28：已经修复，谢谢。 2015-08-18：已修复！  ", "replys": "漏洞评价：\n评论\n     2015-07-09 14:44 |    \t\tBear baby \t\t\t( 普通白帽子  |\t\t\t        Rank:183 漏洞数:20        | 善攻者，不知其所守。善守者，不知其所攻。)\t\t \n  公主，厂商这rank给的。。有点低啊    \n     2015-08-18 20:24 |    \t\t小洞主 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 小打小闹挖小洞)\t\t \n  类似这种，把库托了rank就高了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}