{"id": 88152, "wybug_id": "wooyun-2016-0207810", "wybug_title": "对海南航空的一次测试过程发现多处安全漏洞（小问题导致的大风险）                                      ", "wybug_corp": "hnair.com", "wybug_author": "Sia_water", "wybug_date": "2016-05-12 14:40", "wybug_open_date": "2016-06-27 12:30", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-27：\t细节向公众公开  简要描述： 求高rank&礼物 详细说明：  最近智联招聘给我打电话说海南航空招飞行员..还以为是骗子于是就上网找了找海南航空的网站终于找到一个突破口https://www.hnagroup.net/prx/000/http/vpnweb.hnair.com/Default.aspx海南的协同办公首先是对找回密码进行的测试尝试了很多账号，有的账号没有绑定邮箱和手机，不能找回，而且有的账号登陆的时候会有一个手机验证码\n\n最终找到一个绑定了邮箱且登陆不需要手机验证的账号 ：zhangweihttp://service.eking-tech.com/hnaAct/getBackPwd在第二部验证身份的时候把请求包里的他原来的邮箱替换为自己的邮箱\n\n\n\n用接受到的验证码直接重置了，然后登陆，这个账号很好，直接等了vpn进了内网\n\n\n\n进入内网后，对10.2.1.0/24端的IP扫了一下  http://10.2.1.241/Frameset/login.html10.2.1.252 VCenter虚拟化的这个账号只用了半天时间就被修改回去了，根据在内网收集的信息 重置了一个权限大一点的账号shuang_wang   首席执行  \n\n赠送一个xss。 在 e学习网 我的状态 处 可xss\n\n\n\n运行网，多数的系统都可进入\n\n这个账号用了半天又被修改回去了，又对另一个绑定手机、邮箱的账号进行了测试，猜测，绑定手机的账号会在登陆时需要手机验证码，，，然而在登陆https://www.hnagroup.net/prx/000/http/vpnweb.hnair.com/Default.aspx获取验证码后，验证码在返回的包中了，\n\n  然后就登陆了~这个账号就更有意思了，有个VIP乘客信息~这里应该是海航整理的政要的喜好。。。\n\n\n\n\n\n还有一个可以查询最近航班上的vip我是11号的截图，可以查到12号各航班vip信息，，领导真的不少呢\n\n从起飞时间各种信息   漏洞证明：  哎。。在内网本来已经找到海南下 易建科技的信息了，idc运维部的账号已经收集好了，但是运维同事的账号都是绑定了手机在测试登陆绕过手机验证码的时候估计弄的太过了，被他们有所察觉了。。。还是too young 没经验啊。。本准备用一天晚上时间多在运维的账号里搜集点信息，然后再在内网折腾一番的。。\n\n\n\n本来想我多弄几个运维账号，没准就能出几个服务器账号什么的。没准就通杀了呢。。\n\n现在我的ip已经访问不了海航的协同了。。   修复方案：  首先修复验证码方面的吧。。求高rank~~礼物~~   版权声明：转载请注明来源 Sia_water@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-05-13 11:33 厂商回复： 谢谢，我们会立即安排整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}