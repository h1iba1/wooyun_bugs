{"id": 12744, "wybug_id": "wooyun-2013-021181", "wybug_title": "微信公众平台api的几个设计问题", "wybug_corp": "腾讯", "wybug_author": "pysolve", "wybug_date": "2013-04-03 10:44", "wybug_open_date": "2013-05-18 10:45", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-18：\t细节向公众公开  简要描述： 几个微信公众平台的小问题，见下。 详细说明：  \n\n如图，给用户单发信息处，没用token，导致csrf。\nhttp://mp.weixin.qq.com/cgi-bin/singlesend?t=ajax-response&lang=zh_CN&type=1&content=1111111111&error=false&ajax=1&tofakeid=14****3660\n前天测试的时候是可以用get方式提交的，现在貌似只能post了，这么快就补了？不过post同样不能防御csrf。但这个csrf价值不大，因为要用到fakeid。同时，api请求没限制频率。两种利用方式：1、给用户发送“微信炸弹”2、突破每天的群发次数限制。我们知道，公众账号是限制了每天只有一次的群发机会，对认证的账号每天有两次。由于没限制频率，导致可突破限制。fakeid可通过修改如下url中pagesize的数量从而使所用用户显示在同一页面来实现批量获取。\nhttp://mp.weixin.qq.com/cgi-bin/contactmanagepage?t=wxm-friend&lang=zh_CN&pagesize=10&pageidx=0&type=0&groupid=0\n\n\n综上，考虑到可突破群发产生的影响，给予漏洞等级为中。如有不妥，请指正。   漏洞证明：  发给一朋友时的测试截图：\n\n   修复方案：  1、token2、请求频率限制   版权声明：转载请注明来源 pysolve@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-04-03 14:02 厂商回复： 对于第1个问题，我们已确认并且修复完毕；第2个问题在后台已有相应策略限制，非常感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-03 10:51 |    \t\tpysolve \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:3        | Time is killing u when ur killing time!)\t\t \n  不要礼物不要公仔不要ipad，只跪求一个公众平台菜单接口内测资格。    \n     2013-04-03 12:02 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:41        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @pysolve 准奏    \n     2013-04-03 12:54 |    \t\tpysolve \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:3        | Time is killing u when ur killing time!)\t\t \n  @鬼魅羊羔 谢主隆恩~    \n     2013-04-27 21:44 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @pysolve 哈哈    \n     2013-05-20 00:40 |    \t\t双人份 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | 打发点咯)\t\t \n  别这样撒，现在超时的消息怎么发给用户？    \n     2013-05-20 19:55 |    \t\t双人份 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | 打发点咯)\t\t \n  @鬼魅羊羔 厚着脸皮，能不能也求一个菜单接口资格？吾皇万岁万岁万万岁    \n     2013-05-20 21:32 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:41        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @双人份 这个朕做不了主。。。你得问吴三桂。。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}