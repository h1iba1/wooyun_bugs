{"id": 54076, "wybug_id": "wooyun-2014-065631", "wybug_title": "设计缺陷导致抽奖功能存在刷次数情况", "wybug_corp": "M1905.COM", "wybug_author": "路人甲", "wybug_date": "2014-06-20 17:57", "wybug_open_date": "2014-06-20 18:39", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计错误", "搞笑有爱"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-20：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 使用了不安全的方法记录用户操作，导致可以通过简单的方法增加抽奖次数。 详细说明：  漏洞页面 http://t4.m1905.com/（变形金刚4官网）6月20号变4首映，该网站发布一个抽奖活动。活动规则为 每日签到和分享都可以获得一次抽奖次数。然而，在数据库中并没有记录用户是否参与了这两个任务，记录的方式竟然是通过cookie记录，如果cookie存在，则把按钮变成已完成无可点击状态。所以，只要删除相应cookie，变可以继续抽奖。此次抽奖有蛮多实物奖品。   漏洞证明：  首先，注册账号进入相应页面 http://t4.m1905.com/，来到抽奖部分\n\n然后做完两个任务，抽两次奖。抽完后页面如下\n\n然后，删除两个cookie，分别为shared_t42014 和 logind_t42014\n\n刷新页面，看到，又可以做任务了。然后又可以抽奖了。。\n\n如果愿意的话，，，ipad啥的应该不是问题。虽然不晓得最后发奖品的时候会不会检查log。。   修复方案：  在数据库存储下一个用户是否分享和每日签到好吗？   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-06-20 18:39 厂商回复： 无 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-21 23:56 |    \t\t西顾 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 保守主义，展元爱好者，啥都不会)\t\t \n  这种漏洞是怎么测试的？  本地检测cookie?  还是提交的时候用cookie验证？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}