{"id": 21348, "wybug_id": "wooyun-2012-04482", "wybug_title": "分享曾经破解的一个web应用Flex小插件", "wybug_corp": "盘特", "wybug_author": "shine", "wybug_date": "2012-02-13 22:04", "wybug_open_date": "2012-02-13 22:04", "wybug_type": "破解", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["算法破解", "逆向破解思路"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-13：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-02-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：    今天在乌云微薄上看到这样一句话：“自由共享曾是这个行业最伟大的精神 现在封闭狭隘已经成为这个行业的最普遍的陋习”  突然想到了自由软件精神（虽然这方面的理论知识我还未去查看过！），同时也想到了自己一年前破解的一个小插件。开始急需这个Flex插件，破解后，由于种种原因又不需要了。今天找了很久才把它翻出来，给大家分享一下，或许有人用得着，免得浪费了！ 详细说明：     PanTe Painter在线图像编辑器（官网：www.21441.com）， 是一款不错的增进用户交互体验的编辑器工具插件。当时，向官方咨询收费情况： 1、一个域名授权 RMB 3K 2、提供源代码  RMB  8K  太贵了！用不起啊！只能这样做了！    漏洞证明：     所以尝试去破解它，由于破解方面是我的盲区，更不懂ActionScript语法（幸好跟Java差不多），没有方向，所以开始弄起来比较吃力。 后来发现，这个软件的授权是根据本地验证，判断该软件是根据浏览器的url地址对比保留在插件中的某个常量值来进行验证的。 于是，先反编译.swf文件再说，得到源代码后，重构原工程太麻烦了（尝试过），便开始找那个负责验证的as类文件。在com\\pante\\managers这个包下的LicenseManager.as文件就是授权验证as类文件源代码如下：\npackage com.pante.managers {    import mx.core.*;    import mx.managers.*;    import flash.display.*;    import flash.events.*;    import com.pante.components.*;    public class LicenseManager extends EventDispatcher {        private static var availableURLS:String = \"localhost:8080\";        private static var fullUrlValidate:Boolean = false;        private static var alertWindows:AlertWindows;        public function LicenseManager(_arg1:IEventDispatcher=null){            super(_arg1);        }        public static function urlValidating(_arg1:String=null):Boolean{            if (_arg1 == null){                _arg1 = availableURLS;            };            var _local2:String = FlexGlobals.topLevelApplication.url.toLowerCase();            _local2 = _local2.toLocaleLowerCase();            _local2 = _local2.replace(\"http://\", \"\");            _local2 = _local2.replace(\"file://\", \"\");            if (_local2.indexOf(\"/\") != -1){                _local2 = _local2.substring(0, _local2.indexOf(\"/\"));                if ((((fullUrlValidate == false)) && ((_local2.split(\".\").length > 2)))){                    _local2 = _local2.substring((_local2.indexOf(\".\") + 1));                };            };            var _local3:Array = _arg1.toLowerCase().split(\",\");            var _local4:Number = 0;            while (_local4 < _local3.length) {                if (_local3[_local4].toString() == _local2){                    return (true);                };                _local4++;            };            return (false);        }        public static function openBadLicenseWindows():void{            if (alertWindows == null){                alertWindows = new AlertWindows();            };            alertWindows.alertLabel.text = \"非授权应用，请联系盘特在线图像编辑器官方客服！\";            alertWindows.width = 320;            PopUpManager.addPopUp(alertWindows, (FlexGlobals.topLevelApplication as DisplayObject), true);            PopUpManager.centerPopUp(alertWindows);        }    }}\n  仔细查看验证算法是有缺陷的，某些特定的字符串是可以绕过的，在查看两个版本中的验证程序是不一样的，说明该程序员是有这方面的安全意识的。如果使用特殊字符串去构造url地址，那插件就没什么实用性了。后来，我发现我太关注代码结构了，忽视了availableURLS这个常量，只要修改这个常量值不就ok了吗！  经过多方寻找软件，最终找了ASV（Action Script Viewer），它能修改swf的常量值，辛苦了两天终于搞定了，太累了，所以后来再也不敢搞这方面的尝试了！上图：\n\n   那位想靠它挣钱的兄弟别怪我啊！在乌云帮你打个免费广告，或许能卖得更好！  第一次尝试软件破解，所以软件破解方面的大牛们别嘲讽啊！   修复方案：  或许采用远程授权验证更不错！   版权声明：转载请注明来源 shine@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：8 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2012-02-14 11:49 |    \t\tlivers \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:6        | mov esp,0jmp espcrash.....)\t\t \n  你这个只是类似爆破，真正累的是逆向，写注册机，游戏外挂    \n     2012-02-14 12:43 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  @livers 恩！乌云需要点高端点的case ，那些看代码挖洞的大牛们，多放点危害小点的0day啊！也好普及普及~！    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 8, "Ranks": null}