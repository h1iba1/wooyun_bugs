{"id": 9409, "wybug_id": "wooyun-2013-034101", "wybug_title": "中国人寿任意用户密码重置（秒改）用户保单信息全部泄漏", "wybug_corp": "中国人寿", "wybug_author": "xfkxfk", "wybug_date": "2013-08-11 16:05", "wybug_open_date": "2013-09-25 16:05", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感接口缺乏校验", "逻辑错误", "设计不当", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-25：\t细节向公众公开  简要描述： 中国人寿任意用户密码重置，可秒改，导致用户保单信息，投保人信息等全部泄漏 详细说明：  先看看我们自己注册的用户，这里的用户在“在线自出服务”面的全部功能都是同用的。\n\n我们先来重置自己的密码，发送重置密码连接到我的邮箱。\n\n下面我们随便找一个用户，在注册处有一个示例用户邮箱wangwei@gmail.com：\n\n发现这个邮箱被人注册过了\n\n好了，那么我们就拿这个用户进行测试吧\n\n\n\n好了，现在我们点击第二步那里，我们重置自己密码的连接地址：\n\n输入新用户名密码，然后抓包，因为这个连接使我们自己的，所以这里把email地址改为目标wangwei@gmail.com这个地址：\n\n从返回信息可以看出，密码重置成功了：\n\n   漏洞证明：  我们来登录一下看是否成功：\n\n成功登录。\n\n看看其他信息，这里这个wangwei@gmail.com应该是中国人寿的工作人员，这里们有用户保单，还有投保人信息等大量用户信息。什么都没动，用户敏感信息已大码。   修复方案：  验证用户邮箱是否是重置密码连接的当前用户邮箱。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2013-08-12 08:20 厂商回复： 非常感谢您对中国人寿网站的关注，谢谢。 最新状态： 2013-08-29：已整改，麻烦您复测，谢谢。  ", "replys": "漏洞评价：\n评论\n     2013-08-11 16:55 |    \t\tlucky \t\t\t( 普通白帽子  |\t\t\t        Rank:409 漏洞数:84        | 三人行必有我师焉########################...)\t\t \n  @xfkxfk 现在改密码页面好像不能访问了是吗？    \n     2013-08-11 17:10 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @lucky 可以啊    \n     2013-08-11 17:19 |    \t\tlucky \t\t\t( 普通白帽子  |\t\t\t        Rank:409 漏洞数:84        | 三人行必有我师焉########################...)\t\t \n  @xfkxfk 哦，那我看看    \n     2013-08-11 17:59 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  8rank的节奏！？！    \n     2013-08-11 18:34 |    \t\tManning \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:78        | 就恨自己服务器太少)\t\t \n  6 8 10     \n     2013-08-11 21:54 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @Manning @小胖子 这个节奏不好说哦    \n     2013-08-12 08:46 |    \t\tManning \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:78        | 就恨自己服务器太少)\t\t \n  @xfkxfk 准不？    \n     2013-08-12 09:07 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @小胖子 @Manning 准了    \n     2013-09-25 21:29 |    \t\tMas \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:15        )\t\t \n  @xsser 涉及到密码随意修改了才那么点rank 这不是逗人玩吗    \n     2013-09-26 08:49 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @Mas 习惯就好    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}