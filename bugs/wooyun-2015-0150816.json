{"id": 68135, "wybug_id": "wooyun-2015-0150816", "wybug_title": "西外主页以及旁站存在sql注入和文件上传最终拿到远程桌面", "wybug_corp": "西安外国语学校", "wybug_author": "Rowin", "wybug_date": "2015-10-31 10:56", "wybug_open_date": "2015-11-05 10:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["管理后台对外", "内部系统对外", "任意命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 西外主页以及旁站陕西戏剧协会存在sql注入和文件上传，最终拿到远程桌面。所有旁站信息和数据库一览无余，包括部分学生信息。 详细说明：  西外主页以及旁站陕西戏剧协会存在sql注入和文件上传，最终拿到远程桌面。所有旁站信息和数据库一览无余，包括部分学生信息。   漏洞证明：  西外主页存在SQL注入，并且拿到的权限是root权限，可以访问服务器下所有数据库。找到一个爆路径的漏洞，然后就可以读取到数据库的配置文件。\n\n\n\n文件上传漏洞来自于同一服务器上的旁站：陕西剧协弱密码登录后台，后台寻找上传位置。siteengine虽然对文件名做了限制，最终还是上传成功。顺便发现，已经有黑客来过了==\n\n菜刀上去之后，发现目录是被限制在该域名之下。郁闷。既然可以上传了，接着来php大马。大马上去之后，既然知道了数据库的root用户名和密码，那就用SQL-CMD执行命令：\n\n顺便添加自己的远程用户。然后坑爹地发现了一个问题：服务器竟然放在路由器下面**.**.**.**\n\n本着不拿桌面不罢休的死磕精神，继续想办法。服务器被放在路由器下面，应该是才用了端口映射。仅仅开放了80端口给外部链接，恩，的确很安全。然后我想到了以一个绝招：1，停止Apache服务器对80端口的占用，2，让远程桌面接管80端口。3，然后就可以通过80端口远程桌面吼吼吼\n\n以上代码写成bat文件，start执行。然后就拿桌面咯，，，吼吼吼这时候80端口是远程桌面，而不是服务器。相应的网页服务已经暂停，容易被管理员发现，所以要赶紧逃，然后重启服务器。   修复方案：  不知道怎么修复好。1，先去把戏剧协会后台的密码换成强密码吧。2，不要使用sa权限（root）给任何一个网站，我说的就是西外主站。   版权声明：转载请注明来源 Rowin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-11-05 10:58 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}