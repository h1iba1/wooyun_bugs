{"id": 5184, "wybug_id": "wooyun-2013-047226", "wybug_title": "yxcms任意文件删除 导致的重新安装漏洞", "wybug_corp": "YXcms", "wybug_author": "Matt", "wybug_date": "2013-12-30 19:00", "wybug_open_date": "2014-03-30 19:01", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-30：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-03-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： yxcms任意文件删除 导致的重新安装漏洞 详细说明：  \nyxcms任意文件删除 导致的重新安装漏洞protected/apps/members/contoller/newscontroller.php\t\t\tif (empty($_FILES['picture']['name']) === false){                $tfile=date(\"Ymd\");\t\t\t\t$imgupload= $this->upload($this->uploadpath.$tfile.'/',config('imgupSize'),'jpg,bmp,gif,png');                $imgupload->saveRule='thumb_'.time();\t\t\t\tif(!empty($_POST['oldpicture']) && $_POST['oldpicture']!=$this->nopic){\t\t\t\t\t$picpath=$this->uploadpath.$_POST['oldpicture'];\t\t\t\t\techo $picpath;\t\t\t\t\tif(file_exists($picpath)) @unlink($picpath);//删除文艺文件\t\t\t\t}\n   漏洞证明：  可以删除任意文件 这样我们就能二次安装了。首先注册一个用户 完了之后打开 http://127.0.0.1/yxcms/index.php?r=member/news/add 随便新建一个帖子 需要上传一张图片完了之后 在跳转时候的网页里点击编辑 就是我们刚发布的文章现在打开burp 在编辑的界面里面选择一个新的图片上传 点击确认完了 切换到burp修改oldpicture 为 ../../../protected/apps/install/install.lock删除掉安装的锁定文件完了在打开 http://127.0.0.1/yxcms/index.php?r=install就能再次安装了\n\n\n\n\n\n\n\n   修复方案：  你猜，你们install文件的del_dir没有作用啊 有作用就能不会导致二次安装了   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-12-30 19:25 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  一般重新安装不是需要数据库用户密码么？    \n     2013-12-31 21:48 |    \t\tphith0n  \t\t\t( 核心白帽子 |\t\t\t        Rank:656 漏洞数:107        | 一个想当文人的黑客~)\t\t \n  @袋鼠妈妈 可以外连    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}