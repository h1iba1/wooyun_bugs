{"id": 6749, "wybug_id": "wooyun-2013-044345", "wybug_title": "多玩旗下YY某游戏论坛存在sql注入，可更新用户级别", "wybug_corp": "广州多玩", "wybug_author": "浩天", "wybug_date": "2013-11-28 19:34", "wybug_open_date": "2014-01-12 19:35", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "数据库账户权限过高", "注射技巧", "第三方不可信程序"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-12：\t细节向公众公开  简要描述： 可以更新用户在论坛所属组的级别，都是管理员！还真没敢这么干！！ 详细说明：  YY网页游戏社区：http://yaoguobbs.duowan.com/注入类型：update   漏洞证明：  复现过程说明：需要按步骤来1、首先注册多玩账号2、然后在http://yaoguobbs.duowan.com/这里登录，第一次登录会让你填写论坛的昵称3、加单引号即可注入，没有过滤，看图\n\n4、可以注入groupid的值，改成1，不出意外应该会是管理员，看图\n\n5、继续分析下注入位置限制是了字符长度：21个，也就是昵称，注入的位置写入如下语句，正好21个字符admin',groupid='1'--那么执行的update就应该是这样的：update [table]sessions set uid='4040480',username='admin',groupid='1'--后果可想而知，没敢试，目测400W+的用户但是试来一下下面的语句：admin',groupid='1发现没有报错，是执行了，但是后面的groupid又重新负值成25了OK，就到这里吧，就不给yy添乱了   修复方案：  你们懂的！   版权声明：转载请注明来源 浩天@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-12-02 16:39 厂商回复： 感谢对于欢聚时代安全工作的支持，我们会尽快修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-28 19:42 |    \t\t剑无名 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:32        | 此剑无名。)\t\t \n  dz？    \n     2013-11-29 10:40 |    \t\tjeary \t\t\t( 普通白帽子  |\t\t\t        Rank:296 漏洞数:106        | (:‮.kcaH eb nac gnihtynA))\t\t \n  帮我更新个级别！！    \n     2013-11-29 13:22 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  这个怎么不认领，什么情况    \n     2014-01-12 21:08 |    \t\talso \t\t\t( 普通白帽子  |\t\t\t        Rank:424 漏洞数:52        | 招渗透/php/前端/ios&android安全，广州地...)\t\t \n  限制了长度的    \n     2014-03-18 15:31 |    \t\tMax \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:7        | When you see this sentence, I have been ...)\t\t \n  - -腰果这玩意儿好久了。没报。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}