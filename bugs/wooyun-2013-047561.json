{"id": 6041, "wybug_id": "wooyun-2013-047561", "wybug_title": "APP结界师唯品会SQL注入泄露大量信息", "wybug_corp": "唯品会", "wybug_author": "HackBraid", "wybug_date": "2013-12-31 20:23", "wybug_open_date": "2014-02-14 20:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-14：\t细节向公众公开  简要描述： 唯品会APP的SQL注入一枚，感谢@zzR感谢@wooyun 详细说明：  APP端的SQL注入，抓包，注入！   漏洞证明：  抓包语句如下，由于涉及到自己的账户信息，故打码：\n\n首先跑出数据库名：\navailable databases [2]:[*] information_schema[*] mpms\n用户：\ncurrent user:    'm_pms@%'\nmpms数据库：\nDatabase: mpms[110 tables]+--------------------------------------+| apns_app                             || apns_app_20130315                    || apns_device                          || apns_device_20130315                 || apns_device_20130829                 || apns_device_20131129                 || apns_device_backup_20131217          || apns_device_history                  || apns_device_new                      || apns_queue                           || apns_queue20130313                   || apns_queue_20130305                  || apns_queue_20130314                  || apns_queue_20130406                  || apns_queue_20130419                  || apns_queue_20130428                  || apns_queue_20130509                  || apns_queue_20130518                  || apns_queue_20130523                  || apns_queue_20130605                  || apns_queue_20130607                  || apns_queue_20130619                  || apns_queue_history                   || apns_queue_history20130313           || apns_queue_history_130305            || apns_queue_history_20130428          || apns_queue_history_20130518          || apns_queue_history_20130605          || apns_queue_history_20130607          || apns_queue_history_20130702          || apns_queue_history_20130711          || apns_queue_history_20130809          || apns_queue_history_bak               || apns_queue_hobi                      || apns_queue_push_error                || apns_queue_push_error_20130314       || appname_mapping                      || brand                                || brand_20130315                       || dim_date                             || dim_vipsmobile_api                   || dim_vipsmobile_api_130315            || dw_vipsmobile_request                || dwm_vipsmobile_request_hour          || dwm_vipsmobile_request_hour_130315   || dwm_vipsmobile_service_api           || dwm_vipsmobile_service_api_130315    || message_cache_config                 || message_cache_config20131203         || message_delivery_mode                || push_daily_count                     || push_daily_gather                    || push_daily_message                   || push_id                              || push_message                         || push_message20131203                 || push_message_history                 || push_message_history20131203         || push_message_history_1               || push_message_history_10              || push_message_history_11              || push_message_history_12              || push_message_history_13              || push_message_history_14              || push_message_history_15              || push_message_history_16              || push_message_history_17              || push_message_history_18              || push_message_history_19              || push_message_history_2               || push_message_history_20              || push_message_history_21              || push_message_history_22              || push_message_history_23              || push_message_history_24              || push_message_history_25              || push_message_history_26              || push_message_history_27              || push_message_history_28              || push_message_history_29              || push_message_history_3               || push_message_history_30              || push_message_history_31              || push_message_history_4               || push_message_history_5               || push_message_history_6               || push_message_history_7               || push_message_history_8               || push_message_history_9               || push_month_gather                    || st_recommend_brand_fdt0              || st_recommend_brand_fdt1              || st_vipsmobile_request                || st_vipsmobile_request_130315         || subsc_config                         || subsc_config_20130315                || subsc_mobile_result                  || subsc_mobile_result_20130315         || subsc_mobile_subscribe               || subsc_mobile_subscribe_20130315      || subsc_mobile_subscribe_backup        || subsc_mobile_subscribe_backup_130315 || subsc_subscribe_data                 || subsc_subscribe_data_backup          || subsc_subscribe_data_backup_130315   || t1                                   || transport_code                       || transport_content                    || user_group                           || user_group_push                      |+--------------------------------------+\n修复吧！   修复方案：  修复！   版权声明：转载请注明来源 HackBraid@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-01-02 11:52 厂商回复： 感谢提供，已经修复，请关注我们的官方微博:http://weibo.com/VSRC  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-31 20:31 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  - -！我标题的#号没了。。。@疯狗 这是为什么啊    \n     2013-12-31 20:53 |    \t\tchange \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:15        | 核心白帽子)\t\t \n  @HackBraid 主要是你人品不好    \n     2013-12-31 20:54 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @change 好吧，小白一枚，谢谢指教！    \n     2014-01-01 00:50 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  APP结界师，我靠！    \n     2014-01-02 16:24 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @HackBraid 标题尽量严谨专业，少一些符号，都是汉字描述即可。    \n     2014-01-02 16:30 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @疯狗 嗯，好的！    \n     2014-01-02 16:48 |    \t\t剑无名 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:32        | 此剑无名。)\t\t \n  @疯狗 @屌丝不会高端大气的专业用词捏    \n     2014-01-02 17:28 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @剑无名 那就大概标题提交就行 不妥的话后台审核会帮忙修改    \n     2014-01-22 12:41 |    \t\tPgHook \t\t\t( 普通白帽子  |\t\t\t        Rank:964 漏洞数:115        | ...........................................)\t\t \n  @HackBraid 可以告诉我是那个字段存漏洞么，记得这里一搞就挂。    \n     2014-01-22 13:19 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @PgHook不是version就是token，已经修复了…    \n     2014-01-22 14:25 |    \t\tPgHook \t\t\t( 普通白帽子  |\t\t\t        Rank:964 漏洞数:115        | ...........................................)\t\t \n  @HackBraid 我弄的时候，总是搞挂去，你就木有出现过么？？？    \n     2014-01-22 15:47 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  @PgHook出现过，那天可能例外吧…    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}