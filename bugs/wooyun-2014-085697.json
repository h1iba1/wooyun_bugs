{"id": 47719, "wybug_id": "wooyun-2014-085697", "wybug_title": "4399某游戏MONGOD泄露影响归纳（敏感数据库信息）", "wybug_corp": "4399小游戏", "wybug_author": "路人甲", "wybug_date": "2014-12-03 12:42", "wybug_open_date": "2015-01-17 12:44", "wybug_type": "重要敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-17：\t细节向公众公开  简要描述： 各种MONGODB泄露查找归纳除了扫描端口还可以用搜索引擎~~为什么厂商是4399哪，只是他运气不太好，排在搜索第一条。以他为例，做个事例。可以给大家做个告警。 详细说明：  \n\n先上图（远古封神管理员表）.\n\n再上图.看一下最终效果。那个进去后的什么看密码、看用户留言、订单信息那是后话，爱干什么干什么，反正我没干。其实找MONGODB真心没啥技术含量，我也只是来混个脸熟，顺便刷个分。方法1：使用工具，开足马力扫描27017端口，C段，B段看带宽和服务器资源了。干这个事主流工具NMAP,xscan  比较非主流的工具么NC,WVS都可以就是效率没有前面的开，当然还有这个Python写的小脚本，不过个人感觉一个NMAP也就够了。这个不是重点，不多说，各位自己扫。方法2：通过搜索引擎来找，baidu,google,bing 选一个来，前提是你能访问的了搜索网站（如GOOGLE）.先用天朝局域网BAIDU搜索来举例：关键字：intitle:mongod inurl:28017 即可28017是MONGODB的一个状态检测页面。有他在一般都会有27017端口在（99.9%成立）。\n\n如果觉得这么找像大海捞针，找不到啥有价值的，一堆测试站，那么你就需要发挥一下闹补功效，比如把关键字加一个：intitle:mongod inurl:28017 admin于是就有了最上面的图。有MONGODB怎么找到链接的网站或应用哪？很简单：28017 看上面的信息，外部链接IP是哪些，\n\n然后再IP反向域名解析查一下，一般就OK了(似乎这个例子中不行)。但是也有可能是像我这样的白帽发现了这个端口，友情测试一把。所以就有了另一种方法，进去看信息（这个傻瓜都知道，你不知道所以你不是傻瓜），哈哈。其他办法么，就是同网段扫80端口，链接外部地址扫80端口。这里可以扩展C类地址10个IP扫，没有的话再扩展10个，依次类推。如果开放了80端口又登不上，怎么办？反向域名解析一下。   漏洞证明：  如上   修复方案：  封外网端口，内部访问   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-12-03 15:12 厂商回复： 该问题已经由相关人员确认并处理，谢谢你的支持和关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-03 13:09 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  感觉有点意思。    \n     2014-12-03 13:35 |    \t\tS冒 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:5        | S冒做S事，提S问题)\t\t \n  补充知识库mongoDB:http://drops.wooyun.org/%E8%BF%90%E7%BB%B4%E5%AE%89%E5%85%A8/2470其他redis couchbase memcache 也有同样问题可自行搜索补缺。技术不高，危害不低。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}