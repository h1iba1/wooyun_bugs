{"id": 5403, "wybug_id": "wooyun-2013-046266", "wybug_title": "腾讯TM2013Preview2可信路径权限提升", "wybug_corp": "腾讯", "wybug_author": "我是小号", "wybug_date": "2013-12-19 12:58", "wybug_open_date": "2014-03-19 12:58", "wybug_type": "权限提升", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["权限提升"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-22：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-02-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-19：\t细节向公众公开  简要描述： 腾讯TM2013Preview2可信路径权限提升(打包） 详细说明：  TM2013版本：\n\n\n在引用的路径上并没有加入双引号括起来 ，而windows有执行文件的搜索特性，会优先执行c盘下面的Program.exe 若在该目录下面放一个Program.exe 会导致权限提升\n漏洞一：TM2013预览版2安装程序存在可信任路径权限提升漏洞，安装进行到最后一步的时候，如果安装根目录（比如：C:/ D:/ E:/下）存在Program.exe，那么因为默认勾选了安装完成运行TM2013会运行Program.exe导致权限提升（当然如果这个Program.exe是一个cmd.exe做成的话）漏洞二：如果安装根目录（比如：C:/ D:/ E:/下）存在Program.exe，用户双击桌面快捷方式TM2013启动的时候将会自动在后台启动Program.exe\n\n漏洞三：因为TM2013在聊天过程中会调用QExternal，这边代码又没有写好，导致Program.exe会自动后台启动。\n\n   漏洞证明：  \n\n//这是我最后一次测试这种漏洞   修复方案：  修改代码。   版权声明：转载请注明来源 我是小号@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-12-19 19:25 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}