{"id": 24404, "wybug_id": "wooyun-2015-0113824", "wybug_title": "沪江网校某处失误可导致大量用户信息泄漏、订单泄漏并可以修改订单金额，任意充值、任意开课等", "wybug_corp": "hujiang.com", "wybug_author": "小杰哥", "wybug_date": "2015-05-13 10:17", "wybug_open_date": "2015-06-27 11:20", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感数据泄漏", "用户敏感信息泄露", "数据库泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-27：\t细节向公众公开  简要描述： 沪江网作为全国最大的互联网学习平台，专注于提供专业、高效的互联网学习服务。旗下业务包括教育门户网站、网络SNS社区、教育电商平台以及国内首创的在线互动教学平台沪江网校等。学习内容涵盖10多种语言、中小学教育、亲子启蒙、职场技能、艺术兴趣等，产品覆盖电脑端、平板端、手机端及电视端，为3岁到70岁全年龄段人群提供全方位的学习服务。沪江网诞生于2001年，历经5年公益化运营后，自2006年开始公司化运营，现已成为拥有700名全职员工、2000名兼职员工，影响力辐射2亿学习者、7000万注册用户、300万学员的大型互联网教育企业，在行业居于龙头地位，也是上海市唯一一家获得由国家教育部直接颁发现代远程教育资质的互联网教育企业。近年来，随着互联网教育行业的迅速发展，作为国内最大的互联网学习平台，沪江网致力于与国内外的伙伴们一起为全世界的亿万学习者提供最优质的学习资源。截止到2013年底，已有近2000家机构和名师与沪江网展开深度合作，其中包括国际巨擘麦格劳-希尔教育集团、牛津大学出版社、哈珀•柯林斯集团等..... 标题取得那么吊会不会被打？说明一下:沪江网校的订单交易量真的很大,而且金额都不少,一门课程都是几千、几万的！危害巨大！ 详细说明：  \n\nmask 区域\n*****^^在挖沪江的漏洞！ ^********************活着,但是我却忘^********************://f2.c.h********************jfile.cn/test.aspx ********************^^据库服务**********de&g**********68.0.1**********5.21,**********5.22,**********5.23,**********5.25,**********5.27,*****\n\n基本集中与192.168.25.21~192.168.25.30 </code>其中包括了比较重要的用户信息服务器和商品订单服务器网店地址:http://buy.hujiang.com/你们网站的学币和RMB的比例是1：1的 如果上面的学币的数据库服务器泄漏了 那将是不可设想的恐怖啊！\n\nmask 区域\n*****2,2433;user id=user_class*****\n\n</mask>订单裤：HJ_VIP   订单表:ShopOrder只需要几条SQL语句就可以给自己充值N多钱..还可以直接拿去选课几千几万的学费都不在话下...也能直接修改课程报名的金额..构造一条SQL语句直接将1000元的订单修改为0.01\n\n执行SQL:update ShopOrder set TotalFee='1000',DealFee='0.01',DiscountFee='999.99',PreIncome='1000' where OrderID=订单ID\n\n我用自己的帐号测试了充值学币！ 充值1000元 只花了0.01\n\n由于本人的原因,所以测试都是隔几天的,谅解一下  在学校上不了网,只能放一边！有空在弄\n\n在测试的时候我帐号一共充值了1203个学币,其中的03是我自己真金白银自己充值的,其他的我一个也没用！ 请收回吧！众多数据裤信息泄漏！ \n\n用户订单,每分钟都N多订单\n\n用户信息和金额..\n\nshell 还泄漏了一个管理员的网站！\n\n我记得有一次我一个一个裤的打开来看的时候看到几个用户表有三千多万的用户信息,帐号密码邮箱什么的都有.. 做社工库都够了另外还有几个数据库的用户表都是百万级千万级的帐号密码用户信息也全部都有.. 如果数据一旦泄漏那得有多少人为广大的社工库贡献了一份密码啊！..还好我没有脱裤... 我可是好孩子...众多的数据库连接信息泄漏！\n\nmask 区域\n*****ode**********;password=Dsf#$5BFjd3**********lo2007;password=bulo7**********r_yuliao;password=7**********ser_mis;password=7**********.**********一点点,太多********************^^模的^**********cod*****\n\n额...  还有一个,请把我修改过的订单号！修改过的金额全部都收回去吧！充值的学币和开的课也拿回去吧！(好像开了课,忘记了！)</mask></mask>   漏洞证明：  \n\nmask 区域\n*****2f6790529bbfe5881725ae5f.jpg********************ode**********;password=Dsf#$5BFjd3**********lo2007;password=bulo7**********r_yuliao;password=7**********ser_mis;password=7**********;/co*****\n\n</mask>   修复方案：  听说你们没有安全部？你们一个管理支付那一块的人员告诉我的真不敢相信,那么大的网站竟然没有专门做安全维护的...能不走小厂商了么....再挖的心情都没有了！   版权声明：转载请注明来源 小杰哥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-05-13 11:18 厂商回复： 收到，正在处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-13 11:06 |    \t\t浮世浮城 \t\t\t( 普通白帽子  |\t\t\t        Rank:284 漏洞数:60        | 我存于这俗世烟火的浮世，我爱这时光倒影的...)\t\t \n  吓死我了 还好我从来没读过书     \n     2015-05-13 12:09 |    \t\tMr.R \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:14        | 求大神带我飞 qq2584110147)\t\t \n  小杰 你是看上沪江了吗 你不是在传智么 还挖洞     \n     2015-05-13 12:51 |    \t\tJJ Fly \t\t\t( 普通白帽子  |\t\t\t        Rank:317 漏洞数:59        | 今天播下一颗种子。)\t\t \n  不来个 全套课程的 帐号合适吗。     \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}