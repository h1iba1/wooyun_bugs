{"id": 73435, "wybug_id": "wooyun-2016-0171431", "wybug_title": "哇哈哈某系统口令修改处越权漏洞造成大量员工资料泄露", "wybug_corp": "wahaha.com.cn", "wybug_author": "路人甲", "wybug_date": "2016-01-24 13:05", "wybug_open_date": "2016-01-29 13:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-29：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 哇哈哈某系统口令修改处越权漏洞 详细说明：  测试账号:53405185719731739884902764185916091623109610695211033189393642339484154197322552595996823317381378904210827469359305290619221929199227513651105213531655961093971049120909619196459722948896149686101227069284密码均为123456hr1.wahaha.com.cn 存在密码修改处存在越权漏洞，可修改任意用户的密码口令修改接口:/front/query/memberInfoModify.jsp修改密码，抓包，把工号user_id为工号 nick_name为昵称吧user_id修改为其他工号nick_name随便改成一个不存在的(因为不可以重复)然后发送，就可以修改那个用户的密码，所以只要知道一个用户的工号，就可以修改他的密码通过接口/ajax/memberCheck.do 爆破到了一千三百多个工号2456950904151718191122252627282132343539364748455759546965777385878294979992003008101209201302303305306309301402407401505509606708802906018019012113118111215219212313315316319317411513515511612615618619612715718711819811912915917918919911023026027028029021123126121226227229226323525521625622725723824826829821922924925928929921034035038039033134137139232335331433536537532639635739734835838839832934938939931047048049041148148242832343343247345441545549447649641742745747742846847848841942948941052054059051157151256254842356359356458454355557552659651755755859852954955956958951062069061162166169161367361465466462565567569565668669665766762867866967969961071562076077071172175176178171274769271373379379471572574575576579571675677678671772777771872872976972085086089081182188182287284181383385387389381486481582587589587688683785787785887881982789984096098091196199193295297297398395492594595599591698691792794795799791897891999991000110091002300140094002700280019001010201022102310931014109410151095101610961027109710281098101120212091201220222014209420252026202820182019202920113021309330243094309630283098301930993021401340234093401640264097402840194010501150125093501550255017509950106011601260926093609460256022709270137015702570977019701180228093801480248094802680278091902290929093909490179098902301960127011801990111112111221193111411941115111611261128119911112121211321932194211521252116212821982199211031223193311431243115312531163127319731983129311241134123412441254116412641964127411541974119412941994110511151225193519651175197511851285199512061116122619261136194611561256117612861986119611071927113712671967118711971108121811281928123811581109112919291139193912491949115911691179197911891199123029302140216029602280219021012911212121412941215129512261296122712281229121122212291221322232293221422942215222622172297222822982219229922123222322332933214322532163218329832193210421242234224429442154225421642974218429842994210521352935224521552255296529752185299521062116221622262926293621762976228621962996291722272937294721672137228721972218293822482948215822682968227829782198292921492249296921792210391031203230314031503160397039803190399032013211312132313931315131613271398139913102311232123132393231423152316232623962317232823972399231033982321331233253396331133173397331833283329332043214311431243234325439643184320531153215313539353245325532653965318539953106311639163926393631563256396639763107319631173217392731373947397731973108391831283228392831483248326831783188391932293929393931593259317931893289398931004120414041504160496042704180428049804290410141114121422149314141494141614961498149914222413249324142494241524103421341534163496341144124423442444944425442744974428449844294499442154815413542354155426549654185419542954995410641264226493641564176428649864996411749174127492749474157425741674967417749774187428741974108431849184928415849684978418842884209421949294139493949694179427949794189498942005210512052205130593051405150596052705970518052805290599051015111593151415941516152815191529159915212591251325142515252525262518259825123523359335253526359635183528351935293510452045214512452345934594451545264596452745174518452845984519451055115522559455165597551955995510651165916522651365936515659175127522759275947515751775977518752875987519751085118512859285938514852685968518851985109590959295139593952495259527951895989519951006120613061406240626069606270619062906990693161416941615161616961627169816102611269126932614261626103611362436943626361736983619362046214623469346244694461346264696462746974618469846194610561156215691562256135694569656975618569856106620661166916622661366246625662766217691762276137623769376947616769776287612869286138694861586968627861986109620969096919622961296139614962496159696962796189628969896199610072007120722079307150725079607980729071217931714179417151726179617971728179817912712271327932714279427282729272437943725371637963797371837283719379937104721471247134723479347244726479747294799472257135793571557265796579757185799571267226793672467946711671667266797671967107720771177927713779377157718772877987792879387948796871787278713879787998710972097229793972497159725972697189798971008110821089108120822089308950816082608960897081808290899081118911812181318241894181618261897182818191811289128122893282428262896289728992820381138133823389338243815381738293810482148234815489648194899481058215891581258225893589458155896589758185828589858106820681168916812689268136893682568966899681178217812782278927813789478177810889188138814889488928896889788919813989398909826981998100911091209940915099509160927099709280998092909990911191319941915191419261927191819281919192919102911291229932914292429152925291629962928291929992920391139233913399439153925399639173997391839193929391249934926491949105991591359935924592559975918592859106920692269926921691169946915699769286991792279237915799679177928799879108922899289138915899689978928892299929913999399269927992599所以此越权漏洞至少导致一千三百多员工的工资信息，姓名，身份证，手机号，学历，学校职位，出生日期等信息泄露   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  密码修改处做好权限验证，防止一个用户的权限可以用来修改其他用户的   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-01-29 13:10 厂商回复：  漏洞Rank：2  (WooYun评价) 最新状态： 2016-01-29：已联系开发人员处理  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}