{"id": 12541, "wybug_id": "wooyun-2013-021722", "wybug_title": "有利网 也可以任意用户密码重置额~", "wybug_corp": "yooli.com", "wybug_author": "px1624", "wybug_date": "2013-04-15 19:23", "wybug_open_date": "2013-05-30 19:24", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当导致攻击界面扩大", "认证缺陷", "盲目信任用户数据", "密码破解", "易猜解接口", "手机短信", "任意密码修改", "验证码爆破"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-30：\t细节向公众公开  简要描述： 有利网也可以重置任意用户密码额，虽然和以往的稍微有些区别，不过还是可以重置任意用户密码的，吼吼，求礼物~ 详细说明：  缺陷位置：密码重置链接中，参数newValidCode设置过于简单（6位纯数字），且发送请求时，无次数限制，可以通过爆破重置任意用户密码。测试过程1 老规矩，点击忘记密码。图1\n\n2 可以看到，让填邮箱地址，这个也就是可以用来登录用的邮箱。那就果断填上小号的邮箱呗。图2\n\n3 填好邮箱后，点击下一步，邮箱中会收到如下图所示的，一个重置密码的链接。（看不见图上的字就点击看大图吧）图3 \n\n4 用小号多次测试后，可以得到图3中的分析，主要就是那个newValidCode的字符串在验证。访问链接，可以看到可以直接修改密码了。图4\n\n5 所以问题变的很简单了，只要爆破newValidCode就可以了。6 打开burps，随便输入新密码，抓包。这里注意地址栏的地址将newValidCode写成任意的6位数字，因为我们重置密码的时候是不清楚这个数据是多少的。mailAuthenId这个可以自己用自己的帐号重置自己密码去查看，然后重置别人的时候，将之前自己得到的数字加1就可以了。（ps：无论newValidCode参数是什么，访问那个链接都会正常显示修改密码的页面，不过newValidCode不正确的话，不会修改密码成功而已）控制变量，只留下图中所示的待爆破的变量即可。图5\n\n7 然后爆破请求，可以看到这里出现了明显的变动，说明这里就是正确的密码。图6\n\n8 用变动位置的数据去测试修改密码的地址会出现如下图。这个图就说明密码已经修改成功了，修改密码的链接失效了而已。去用爆破出的密码去测试登录，成功登录。图7\n\n由于newValidCode参数的验证字符只有6位纯数字，所以多线程去爆破，很快就可以重置密码了。。。   漏洞证明：  burp爆破证据，吼吼~~\n\n   修复方案：  修补：1 newValidCode设置的复杂点，最好是26个字母（区分大小写）和10个数字的组合。2 提交修改密码的请求限制下，可以在提交请求的时候加上验证码，或者限制每天重置错误10次当天就不得在重置密码。3 理财的网站，应该比较大方，给发个礼物不是啥问题吧。这样漏洞就会越来越少的，嘿嘿~~   版权声明：转载请注明来源 px1624@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-04-15 20:27 厂商回复： 谢谢关注，我们立刻修复。 最新状态： 2013-04-19：礼物已送出，希望有更多的白帽子关注，谢谢~~  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}