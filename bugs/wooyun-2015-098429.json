{"id": 38005, "wybug_id": "wooyun-2015-098429", "wybug_title": "有货app问题一（多处越权）", "wybug_corp": "YOHO!有货", "wybug_author": "hkAssassin", "wybug_date": "2015-02-27 10:11", "wybug_open_date": "2015-04-13 16:58", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["越权操作", "未授权访问", "用户敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-13：\t细节向公众公开  简要描述： 我已不知道该说什么！（审核的同学就算不能做操作，任意登陆用户账号，也不至于审核不通过啊！）。 详细说明：  \nhttp://www.wooyun.org/bugs/wooyun-2015-097271/trace/75422c0616bb8a959bd6583893ee0136 本来就是这个问题，请问为什么审核不通过？就算不能做操作吧，这个漏洞也不至于审核不通过啊！况且我的标题写的和漏洞证明里面给的也是一致的啊，请问“具体原因： 反馈信息经过验证存在问题或者提交信息不准确  ”此话怎么讲？？？哎！既然你要能证明可以做操作的图，那就补一张呗。\napp权限控制有问题。感觉会和 WooYun: 有货官方某交易APP存在越权漏洞可拿到他人账户 这个漏洞重复，如果真重复了请审核的同学忽略即可！  漏洞内容： \n安卓app客户端用户中心校验的时候有问题，没有从服务端的session中读取用户登陆信息。简单的从客户端的uid参数来判断用户登陆情况。我申请了两个账号通过对uid对比发现uid成等差数列递增差值为88.这样的话自己注册一个账户很容易得到所有用户的uid。得到uid之后即可在安卓app客户端通过抓包替换uid登陆任意用户的账号，请看下图，我随便登陆了两个别人的账号用作漏洞证明\n 替换下图中的uid即可登陆任意用户账号 \n\n\n\n首先，在有货app端登录自己的账号，然后点击我的此时同时抓包，然后把uid替换成需要登录的其他账户的uid即可登陆。上面两张图就可以证明可以登录任意账户，或者查看任意账户。然后要修改用户信息的时候，同样需要截断数据包吧uid替换成需要修改的用户uid即可。下面的截图为修改的数据包地址。\n\n最后一张图通过bp的重复提交功能即可证明，用户的信息已经被修改了！（此处我修改的是地址管理中的收货地址，我新添加了一个收货地址）。\n\n   漏洞证明：  \nhttp://www.wooyun.org/bugs/wooyun-2015-097271/trace/75422c0616bb8a959bd6583893ee0136 本来就是这个问题，请问为什么审核不通过？就算不能做操作吧，这个漏洞也不至于审核不通过啊！况且我的标题写的和漏洞证明里面给的也是一致的啊，请问“具体原因： 反馈信息经过验证存在问题或者提交信息不准确  ”此话怎么讲？？？哎！既然你要能证明可以做操作的图，那就补一张呗。\napp权限控制有问题。感觉会和 WooYun: 有货官方某交易APP存在越权漏洞可拿到他人账户 这个漏洞重复，如果真重复了请审核的同学忽略即可！  漏洞内容： \n安卓app客户端用户中心校验的时候有问题，没有从服务端的session中读取用户登陆信息。简单的从客户端的uid参数来判断用户登陆情况。我申请了两个账号通过对uid对比发现uid成等差数列递增差值为88.这样的话自己注册一个账户很容易得到所有用户的uid。得到uid之后即可在安卓app客户端通过抓包替换uid登陆任意用户的账号，请看下图，我随便登陆了两个别人的账号用作漏洞证明\n 替换下图中的uid即可登陆任意用户账号 \n\n\n\n首先，在有货app端登录自己的账号，然后点击我的此时同时抓包，然后把uid替换成需要登录的其他账户的uid即可登陆。上面两张图就可以证明可以登录任意账户，或者查看任意账户。然后要修改用户信息的时候，同样需要截断数据包吧uid替换成需要修改的用户uid即可。下面的截图为修改的数据包地址。\n\n最后一张图通过bp的重复提交功能即可证明，用户的信息已经被修改了！（此处我修改的是地址管理中的收货地址，我新添加了一个收货地址）。\n\n   修复方案：  权限控制   版权声明：转载请注明来源 hkAssassin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-02-27 10:30 厂商回复： 感谢@hkAssassin 我们尽快修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-27 14:03 |    \t\thkAssassin \t\t\t( 普通白帽子  |\t\t\t        Rank:358 漏洞数:66        | 我是一只毛毛虫。)\t\t \n  私信个联系方式，我私下给你们提交吧！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}