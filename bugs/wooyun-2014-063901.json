{"id": 54603, "wybug_id": "wooyun-2014-063901", "wybug_title": "凤凰网配置失误导致监控邮箱信息及 企业通讯录泄露", "wybug_corp": "凤凰网", "wybug_author": "孩子他爸", "wybug_date": "2014-06-10 18:36", "wybug_open_date": "2014-07-25 18:44", "wybug_type": "系统/服务运维配置不当", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-25：\t细节向公众公开  简要描述：  详细说明：     漏洞证明：  rsync 220.181.67.131::mail_class.php<?php/** * * 每天检查一下前一天异常的情况 */require(dirname(__FILE__) . '/log.php' );require(dirname(__FILE__) . '/mail_class.php' );date_default_timezone_set('Asia/Chongqing');require(dirname(__FILE__). \"/PHPMailer/class.phpmailer.php\");runlog();ob_start();$tmp = read_data_from_db();?><table width=\"100%\" border=\"1\">  <caption>    今日画图异常统计  </caption>  <tr>    <th scope=\"col\">类型</th>    <th scope=\"col\">数量</th>    <th scope=\"col\">详情</th>  </tr><?phpforeach($tmp as $k => $v){?>  <tr>    <td><?php echo $v['type'];?></td>    <td><?php echo $v['num'];?></td>    <td><a href=\"http://172.30.204.36/pic_monitor/list.php?type=<?php echo $v['type'];?>\">详情》》</a></td>  </tr><?php }?></table><?$mail = new PHPMailer();$mail->CharSet = 'utf-8';$mail->IsSMTP();                                      // set mailer to use SMTP$mail->SMTPKeepAlive = true;$mail->SMTPAuth = true;$mail->Username = 'ucenter_project';$mail->Password = '1qazXSW@';$mail->Host     = \"mail.ifeng.com\"; // SMTP server$mail->From     = \"ucenter_project@ifeng.com\";$mail->FromName = \"财经画图监控(\".date(\"Y-m-d H:i:s\").\")\";$to_arr = array(\t'gaohua@ifeng.com',\t'wangfang@ifeng.com',\t'duxue@ifeng.com',\t'fangxiao@Ifeng.com',\t'liuxp@ifeng.com',\t'yimin@ifeng.com',\t'wangyong@ifeng.com',\t'zhang_yunlei@ifeng.com',\t'zhuyl@ifeng.com',\t// 'zhongxl@ifeng.com',\t// 'hezl@ifeng.com',\t// 'xiaoyq@ifeng.com',\t// 'lilei@ifeng.com',\t// 'lanln@ifeng.com',\t// 'lizy@ifeng.com',\t// 'xingzw@ifeng.com',\t// 'yufang@ifeng.com',\t// 'huhj@ifeng.com',\t// 'libing@ifeng.com',\t// 'zhangyw@ifeng.com',\t// 'yangxw@ifeng.com',\t// 'zongyx@ifeng.com');foreach($to_arr as $one){\t$mail->AddAddress($one);}$mail->IsHTML(true);                                  // set email format to HTML$mail->Subject = \"财经画图监控(\".date(\"Y-m-d H:i:s\").\")\";$mail->Body    = ob_get_contents();ob_end_clean();if(!$mail->Send()){   errlog('fatal error', \"Mailer Error: \" . $mail->ErrorInfo);   exit;}runlog(); function read_data_from_db(){\t$link = mysql_connect('10.11.2.77:3306', 'monitor', 'm0nit0r');\tif (!$link) {\t\terrlog('fatal error', 'Could not connect: ' . mysql_error());\t}\tmysql_select_db(\"monitor\");\t$sql = \"select type,count(*) as num from monitor where check_time>\". (time()-24*3600).\" group by type\";\t$result = mysql_query($sql);\t$res = array();\twhile ($row = mysql_fetch_assoc($result)) {\t\t$res[] = $row;    }    mysql_free_result($result);\tmysql_close($link);\treturn $res; } ?>   修复方案：     版权声明：转载请注明来源 孩子他爸@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-06-11 10:40 厂商回复： 非常非常感谢您对凤凰网信息安全的关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}