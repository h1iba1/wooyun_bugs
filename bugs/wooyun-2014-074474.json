{"id": 49284, "wybug_id": "wooyun-2014-074474", "wybug_title": "通过大姨妈某隐私管理软件教你如何从8千万佳丽中选取理想的搭讪对象", "wybug_corp": "yoloho.com", "wybug_author": "路人甲", "wybug_date": "2014-08-30 23:10", "wybug_open_date": "2014-11-28 23:12", "wybug_type": "用户敏感数据泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "手机安全", "敏感数据未加密", "手机软件安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-30：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-11-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 喜欢身材高挑的？喜欢体重匀称的？喜欢芳龄十八的？喜欢经期28天的？喜欢八卦八婆的？喜欢有男朋友的？不论喜欢啥样的，大姨妈，全都有。 详细说明：  #1 先说明一下漏洞细节影响软件：yoloho旗下 大姨吗android版（ios未测试）影响范围：登录后的大多数信息获取接口均存在越权访问。官方数据：软件用户超过8千万。影响用户：活跃用户（即登录后关闭软件时没有清除登录状态的用户）漏洞成因：大姨吗安卓版本在用户登录之后，未注销登录之前均使用token来进行用户身份校验。token的格式83265386%23c490cb762cc444f84fbb0009f141dcd，即uid#hash的格式，经过测试发现服务器只检查了uid和hash是否存在，并未校验hash是否正确。只需遍历uid即可获知其他用户各种敏感信息。如下图（hash删减到1个字符仍可获得用户信息）\n\n#2 进入正题：教学环节\n第一步：广撒网，信息收集\n8千万太多，先取200个来看一下佳丽们的基本情况，第一个接口可以获得如下信息：昵称，年龄，月经周期，上一次月经时间，近期有没有病情，身高，体重等burp instruder设置如下：position：\n\npayload：\n\n处理结果：首先：根据响应包的大小，去除那些注销登录的佳丽们（lenght=281）\n\n然后：将获取到的佳丽们信息，根据你关注的进行筛选（比如身高，年龄大小，上一次经期时间等等）。\n\n筛选后的结果如下（比如对身高感兴趣，就可以对身高列由高到低排序）\n\n\n第二步：经过信息筛选，比较感兴趣的佳丽已经被锁定了，那么该如何与佳丽取得联系呢？\n首先:肯定是想知道佳丽们的电话号码了。\n\n\n\n然后：万一你心仪的佳丽没有绑定电话号码，咋办？别急，试试这个接口看是否绑定了邮箱？有了邮箱通过古典的邮件方式交流，妹子肯定觉着你好有情怀。\n\n\n\n再然后：万一手机，邮箱，qq都没有咋办，别急，通过猜测，老衲又帮你找到一处获取邮箱接口，如果妹子是老用户，拿去碰碰运气吧。\n\n\n第三步：所谓知己知彼百战不殆，既然联系方式被你拿到了，那么来看看妹子是哪的，是不是跟你同一个城市，抑或是天南海北各自一方？【注：后续不在使用instruder，只贴出接口】\n\n\n\n第四步：搭讪总得有点话题吧，看看妹子平时关注什么？\n\n\n\n\n\n\n\n\n\n\n\n第五步：得到了这么多妹子的关注点，与她聊起天来，妹子会觉着你简直就是比闺蜜还了解自己啦，在你幻想跟妹子关系突飞猛进的时候，你是不是忘记了什么？嗯？那就是，这妹子有没有男朋友？有没有别问我，但是下面这个接口可以告诉你一点点辅助信息\n\n\n最后，哥只能帮你们到这里了。   漏洞证明：  如上所提到的接口均存在越权。   修复方案：  修复很容易，不懂来问我。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-08-31 00:31 |    \t\t氦 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 纯手工酱油)\t\t \n  吊了~    \n     2014-08-31 01:31 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  大姨妈    \n     2014-08-31 16:35 |    \t\tS4M \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:8        | 吴彦祖)\t\t \n  今日最佳漏洞    \n     2014-09-01 13:57 |    \t\t路人N \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        )\t\t \n  .....    \n     2014-11-28 23:55 |    \t\t默之 \t\t\t( 普通白帽子  |\t\t\t        Rank:334 漏洞数:67        | 沉淀。)\t\t \n  碉堡了！    \n     2014-11-29 00:26 |    \t\t不知道2017 \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:6        | 专注信息安全领域)\t\t \n  骚年无敌啊    \n     2014-11-29 01:16 |    \t\tmó-wáng \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | hello ,world !)\t\t \n  今日最佳漏洞     \n     2014-11-29 08:54 |    \t\t好基友一辈子 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:37        )\t\t \n  一个大老爷们为什么用这个软件    \n     2014-11-29 10:12 |    \t\tWoodee \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 乌云路人甲，打脸pa pa pa)\t\t \n  @好基友一辈子 你怎么知道洞主是老爷们，而不是老娘们呢    \n     2014-11-29 11:11 |    \t\t银荡的小帅哥 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 银荡的小帅哥)\t\t \n  牛瘪啊.....骚年无敌    \n     2014-11-29 11:57 |    \t\t偸懶の猫 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | ...)\t\t \n  你这么叼，家里人知道么    \n     2014-12-01 17:27 |    \t\t❤ \t\t\t( 普通白帽子  |\t\t\t        Rank:276 漏洞数:69        | ❤)\t\t \n  为什么要匿名呢，大牛求抱大腿把妹啊    \n     2014-12-02 09:59 |    \t\t小卖部部长 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:3        | 别拿部长不当干部！)\t\t \n  洞主真淫荡，连别人的大姨妈都不放过。。。    \n     2014-12-02 13:53 |    \t\t看灰机 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 1)\t\t \n  好湿的洞，加了一个，芳龄三十八 了还用这软件。我深深的被伤害了~切记，可能年龄有偏差各位小伙伴！     \n     2015-03-11 20:13 |    \t\t嗯哼！ \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 人才有点二！)\t\t \n  让我脑洞大开，。。。。    \n     2015-03-12 10:15 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  这漏洞屌，结合这漏洞完全可以写个产品化的东西了。哈哈哈    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}