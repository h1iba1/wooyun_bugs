{"id": 403, "wybug_id": "wooyun-2015-0125894", "wybug_title": "我是如何利用5A流量充值网站免费送流量活动可无限为任意手机刷流量的", "wybug_corp": "5A流量", "wybug_author": "路人甲", "wybug_date": "2015-07-10 14:18", "wybug_open_date": "2015-08-28 17:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "2", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-28：\t细节向公众公开  简要描述： 该免费送流量活动需要关注某一微信公众号，并在朋友圈分享送流量页面后跳转到免费充值流量网页（以下简称网页A），该网页存在漏洞，可无限为任一手机号（已测移动联通电信三大运营商均可）充值无限（已测充值不超过10余次，理论无限）流量。 详细说明：  网页A，向网页B（后台充值接口）发送包括手机号/openid/nickname/flow/activityid等五个参数。经初步分析，后台只对openid/flow/activityid三个参数进行唯一性检测，其中flow默认为-1，activityid暂不清楚，测试时有失败的也有成功的（根据名字判断应该是激活充值的序号，但实测数字6和8均可，应该其他数字应该也可以，但测试时三位数字不成功）。openid可见微信公众平台开发文档。后台只判断该值是否重复而不进行判断是否有效（可能跟微信官方未提供判断该值是否有效有关）。了解这些之后，只需要抓包简单分析就可进行充值。   漏洞证明：  \n\n\n\n\n\n更改openid即可充值。   修复方案：  从关注者数据库中获取openid做验证，需要先关注再领取，可在一定程度上减少刷取流量。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-07-14 17:14 厂商回复： CNVD确认所述漏洞情况，暂未建立与软件生产厂商或网站管理单位的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-10 14:26 |    \t\t噬魂 \t\t\t( 普通白帽子  |\t\t\t        Rank:141 漏洞数:37        | 08安全团队)\t\t \n  你是谁，，你这漏洞我也发现了..为毛你发出来了    \n     2015-07-10 17:04 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @噬魂 你怎么不给你龙哥刷一点阿，^_^    \n     2015-07-10 17:35 |    \t\t噬魂 \t\t\t( 普通白帽子  |\t\t\t        Rank:141 漏洞数:37        | 08安全团队)\t\t \n  @小龙 我胆小，，，不敢刷    \n     2015-08-29 10:17 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n   openid 能伪造么？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}