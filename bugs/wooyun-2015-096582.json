{"id": 38331, "wybug_id": "wooyun-2015-096582", "wybug_title": "tipask注入漏洞2", "wybug_corp": "Tipask", "wybug_author": "路人甲", "wybug_date": "2015-02-13 16:04", "wybug_open_date": "2015-04-30 18:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-13：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-04-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 没有啥条件限制，如果说要gpc 、 全局变量条件限制的都不是好漏洞。 详细说明：  众测来打洞，然后白盒代码就读起来了。。。（0day)http://ce.wooyun.org/content/7045\nfunction onaddcomment() {        if (isset($this->post['content'])) {            $content = htmlspecialchars($this->post['content']);            $answerid = intval($this->post['answerid']);            $replyauthorid = intval($this->post['replyauthor']);            $answer = $_ENV['answer']->get($answerid);            $_ENV['answer_comment']->add($answerid, $content, $this->user['uid'], $this->user['username']);\n增加评论其中看 $_ENV['answer_comment']->add($answerid, $content, $this->user['uid'], $this->user['username']);$this->user['username'] 为我们可控，注册test12345a\\此类畸形用户名，见上篇分析跟踪add方法\nfunction add($answerid, $conmment,$authorid,$author) {        //echo 'INSERT INTO `' . DB_TABLEPRE . \"answer_comment`(`aid`,`authorid`,`author`,`content`,`time`) values ($answerid,$authorid,'$author','$conmment',\" . $this->base->time . \")\";exit();        $this->db->query('INSERT INTO `' . DB_TABLEPRE . \"answer_comment`(`aid`,`authorid`,`author`,`content`,`time`) values ($answerid,$authorid,'$author','$conmment',\" . $this->base->time . \")\");        $this->db->query(\"UPDATE \" . DB_TABLEPRE . \"answer SET comments=comments+1 WHERE `id`=$answerid\");    }\n另外content也控我们content让它为,user(),1)#  即可\n\n然后评论就是root@localhost了详情可参考众测   漏洞证明：  \n\n然后评论就是root@localhost了   修复方案：  更新程序，对username进行转义   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}