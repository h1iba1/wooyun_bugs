{"id": 72559, "wybug_id": "wooyun-2015-0156880", "wybug_title": "华泰保险安全之绕过远程沙盒内网漫游", "wybug_corp": "华泰财产保险有限公司", "wybug_author": "_Thorns", "wybug_date": "2015-11-29 17:41", "wybug_open_date": "2016-01-14 12:10", "wybug_type": "后台弱口令", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-14：\t细节向公众公开  简要描述： 华泰保险之绕过远程沙盒漫游 详细说明：  1>信息收集利用百度和谷歌还有自己的社工库查询等，收集了100+的企业邮箱帐号。\n\n2>fuzz，尝试自己组合了几种针对华泰保险的密码\nHutai123Ht123456Huatai520HT1234huatai123ht123456huatai520ht1234....\n3>成功fuzz出几个帐号，这里我拿其中一个举例。\nzhangqingzhao  Hutai123\n\n\n4>获取敏感信息。我获取了一个vpn登录帐号\nhttps://219.141.242.12VPN用户名：2398VPN密   码：4519\n\n\n登录发现获取到的地址只是172的地址，不对套路阿。于是乎，我扫描了172的其他地址。\n\n利用之前信息收集中的信息，成功登录一个核心系统。\n\n再快没有头绪不想继续搞下去的时候，我看了下厂商的漏洞列表。发现内网地址确实是10开头的。莫非... 还有其他的VPN？我扫描了202.108.103.0/24的443端口。\n\n找到了这个登陆地址，尝试利用刚才的VPN帐号密码登录，果然提示错误.后来测试很多默认口令。test testsangfor sangfor等...这个VPN登录帐号密码，会不会就是OA和邮箱的密码？或者说是域密码？我又回头看了下OA和邮箱。\n\n果然如此尝试利用邮箱帐号登录VPN\n\n成功，上天还是眷恋我的。登录进来打开系统链接，发现自己虽然连接上了VPN，但是却没有获取内网IP地址。猜测是内网的堡垒机进行了中转后，利用IE浏览器来直接执行。\n\n\n\n文件-打开-直接可以绕过这个简单的沙盒。\n\n\n\n\n\n民用燃气保险卡数据导入平台注入http://10.100.1.83:7001/teamserver/faces/home.jsp \n\n\n\n\n\n\n\n\n\n至此，进入内网，但还是对整个内网不熟悉。所以，我的淫抓伸向了网络设置。利用上面的cmd telnet 网络设备，尝试口令猜解。\n\n\n\n用doc扫描了下，telnet获取了一下网络设备，密码都是弱密码。show version了下，整理了一份列表。（土豪企业，全是思科）\nCISCO7609\t10.100.*.248CISCO3825\t10.100.*.2CISCO3725\t10.100.*.254CISCO4510R\t10.100.*.254CISCO3750G\t10.100.*.252CISCO32960G-01\t10.100.*.249CISCO32960G-02\t10.100.*.246CISCO32960G-03\t10.100.*.245CISCO32960G-04\t10.100.*.247CISCO3560G\t10.100.*.254CISCO2960G\t10.100.*.251ASA5510-01\t10.100.*.248ASA5510-02\t10.100.*.253ASA5510-03\t10.100.*.247ASA5510-04\t10.100.*.252Juniper NS204\t10.100.*.249Huawei Edm200\t10.100.*.250CISCO3560G\t10.100.*.254PIX525\t10.100.*.245CISCO2960G-01\t10.100.*.252CISCO2960G-02\t10.100.*.251CISCO3550-03\t10.100.*.250CISCO3550-04\t10.100.*.249CISCO2960G-01\t10.100.*.248CISCO2960G-02\t10.100.*.247CISCO2960G-03\t10.100.*.244CISCO2960G-01\t10.100.*.246\n大部分网络构架也算是搞明白了，自己画了个小拓扑，历时3个小时的简单测试也算告一段落了。\n\n   漏洞证明：  1>信息收集利用百度和谷歌还有自己的社工库查询等，收集了100+的企业邮箱帐号。\n\n2>fuzz，尝试自己组合了几种针对华泰保险的密码\nHutai123Ht123456Huatai520HT1234huatai123ht123456huatai520ht1234....\n3>成功fuzz出几个帐号，这里我拿其中一个举例。\nzhangqingzhao  Hutai123\n\n\n4>获取敏感信息。我获取了一个vpn登录帐号\nhttps://219.141.242.12VPN用户名：2398VPN密   码：4519\n\n\n登录发现获取到的地址只是172的地址，不对套路阿。于是乎，我扫描了172的其他地址。\n\n利用之前信息收集中的信息，成功登录一个核心系统。\n\n再快没有头绪不想继续搞下去的时候，我看了下厂商的漏洞列表。发现内网地址确实是10开头的。莫非... 还有其他的VPN？我扫描了202.108.103.0/24的443端口。\n\n找到了这个登陆地址，尝试利用刚才的VPN帐号密码登录，果然提示错误.后来测试很多默认口令。test testsangfor sangfor等...这个VPN登录帐号密码，会不会就是OA和邮箱的密码？或者说是域密码？我又回头看了下OA和邮箱。\n\n果然如此尝试利用邮箱帐号登录VPN\n\n成功，上天还是眷恋我的。登录进来打开系统链接，发现自己虽然连接上了VPN，但是却没有获取内网IP地址。猜测是内网的堡垒机进行了中转后，利用IE浏览器来直接执行。\n\n\n\n文件-打开-直接可以绕过这个简单的沙盒。\n\n\n\n\n\n民用燃气保险卡数据导入平台注入http://10.100.1.83:7001/teamserver/faces/home.jsp \n\n\n\n\n\n\n\n\n\n至此，进入内网，但还是对整个内网不熟悉。所以，我的淫抓伸向了网络设置。利用上面的cmd telnet 网络设备，尝试口令猜解。\n\n\n\n用doc扫描了下，telnet获取了一下网络设备，密码都是弱密码。show version了下，整理了一份列表。（土豪企业，全是思科）\nCISCO7609\t10.100.*.248CISCO3825\t10.100.*.2CISCO3725\t10.100.*.254CISCO4510R\t10.100.*.254CISCO3750G\t10.100.*.252CISCO32960G-01\t10.100.*.249CISCO32960G-02\t10.100.*.246CISCO32960G-03\t10.100.*.245CISCO32960G-04\t10.100.*.247CISCO3560G\t10.100.*.254CISCO2960G\t10.100.*.251ASA5510-01\t10.100.*.248ASA5510-02\t10.100.*.253ASA5510-03\t10.100.*.247ASA5510-04\t10.100.*.252Juniper NS204\t10.100.*.249Huawei Edm200\t10.100.*.250CISCO3560G\t10.100.*.254PIX525\t10.100.*.245CISCO2960G-01\t10.100.*.252CISCO2960G-02\t10.100.*.251CISCO3550-03\t10.100.*.250CISCO3550-04\t10.100.*.249CISCO2960G-01\t10.100.*.248CISCO2960G-02\t10.100.*.247CISCO2960G-03\t10.100.*.244CISCO2960G-01\t10.100.*.246\n大部分网络构架也算是搞明白了，自己画了个小拓扑，历时3个小时的简单测试也算告一段落了。\n\n   修复方案：  默认口令一定要修改！！！   版权声明：转载请注明来源 _Thorns@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-11-30 12:08 厂商回复： 非常感谢，我们尽快修复 最新状态： 2015-12-16：密码已经更改，再次感谢  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}