{"id": 45259, "wybug_id": "wooyun-2015-0103111", "wybug_title": "买卖宝重置任意密码漏洞（非爆破）", "wybug_corp": "无锡买卖宝信息技术有限公司", "wybug_author": "恋锋", "wybug_date": "2015-03-23 14:55", "wybug_open_date": "2015-03-28 14:56", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 买卖宝成立于2006年，是国内最早涉足移动电子商务的专业平台，致力于为农民、农民工及三四线城市居民提供平等的购物机会。团队积极进取、努力创新，历时多年，已发展成为国内市场份额最高的移动B2C商城。存在设计缺陷，可重置任意用户密码，非爆破方式，深夜挖洞不易，望良心厂商回馈高rank。请叫我红领巾，谢谢！ 详细说明：  a.简单复现方式：1.手机绑定自己的账号，然后用手机接收修改密码的短信2.用下面链接[小贴士]位置找回密码，抓包改username就可以改任意账号密码了。http://12094.mmb.cn/wap/findpassword/sendBandPhoneNum.dob.复杂复现方式：1、问题存在wap版本，通过如下链接进行重置密码\nhttp://12094.mmb.cn/wap/findpassword/sendBandPhoneNum.do?findPasswordIndex=1&uuniq=1427032972658239\n2、首先走一遍正常重置密码的流程，记录正确短信码校验后的响应数据包，如下\nHTTP/1.1 200 OKServer: nginxDate: Sun, 22 Mar 2015 13:38:00 GMTContent-Type: text/html;charset=utf-8Connection: keep-aliveCache-Control: no-cacheContent-Length: 5028<!DOCTYPE HTML><html ><head>\t<meta charset=\"utf-8\" http-equiv=\"Content-Type\" />\t<title>买卖宝-修改密码</title>    \t<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;\" />\t<meta name=\"apple-mobile-web-app-capable\" content=\"yes\" />\t<meta name=\"apple-mobile-web-app-status-bar-style\" content=\"black\" />\t<meta name=\"format-detection\" content=\"telephone=no\" />\t<meta name=\"keywords\" content=\"买卖宝,买卖宝商城,mmb,mmb.cn,买卖宝货到付款,手机购物,移动电商,女装,男装,情侣装,手机,手机配件,箱包,时尚女鞋,时尚男鞋 ,运动鞋,日用百货,内衣,数码,电脑\"/>\t<meta name=\"description\" content=\"买卖宝商城，天天低价，全国货到付款，30天包退换。提供3C、服饰、护肤、彩妆、鞋类、箱包、饰品、家居百货等10万余种商品，全场保真！买卖宝一直致力于为中国5亿手机网民提供物美价廉的商品和便捷高效的服务！\"/>\t<link rel=\"stylesheet\" type=\"text/css\" href=\"http://rep.mmb.cn/wap/upload/touch/newWap/css/common.css\" />\t<link rel=\"stylesheet\" type=\"text/css\" href=\"http://rep.mmb.cn/wap/upload/touch/newWap/css/proList.css\" />\t<link rel=\"stylesheet\" type=\"text/css\" href=\"http://rep.mmb.cn/wap/upload/touch/newWap/css/usermember.css\" />\t<script type=\"text/javascript\" src=\"http://rep.mmb.cn/wap/upload/touch/javascript/jquery-1.7.2.min.js\"></script>\t<script type=\"text/javascript\" src=\"http://rep.mmb.cn/wap/upload/touch/newWap/js/password.js\"></script></head><body>\t<div class=\"new_wap_con\">\t\t<script type=\"text/javascript\">\t\tfunction click_a(divDisplay){\t        document.getElementById(divDisplay).style.display = \"none\";\t    }\t</script>\t<script>\t    window.onload=function(){  \t        setTimeout(function() {\t        \tif(document.getElementById('scroll')){\t        \t\tif(!(document.getElementById('scroll').value>0)){\t            \t\twindow.scrollTo(0, 1)  \t        \t\t}\t        \t}else{\t        \t\twindow.scrollTo(0, 1)  \t        \t}\t        }, 0);\t    };  \t</script>  <div class=\"header\">\t\t<div class=\"head_fl\">\t\t\t<a href=\"javascript:history.back()\"><img alt=\"\" src=\"http://rep.mmb.cn/wap/upload/touch/newWap/icon/return.png\"></a>\t\t</div>\t\t<div class=\"head_fm\">\t\t\t<h1>重置密码</h1>\t\t</div>\t\t<div class=\"head_fr\">\t\t\t<a href=\"/wap/wapIndex.jsp?uuniq=1427031480085560\"><img alt=\"\" src=\"http://rep.mmb.cn/wap/upload/touch/newWap/icon/home.png\"></a>\t\t</div>\t</div>\t<div class=\"clear top_border\"></div><div class=\"password_main\">\t\t\t<form id=\"form1\" action=\"/wap/touch/login.do?method=inputNewPassword\" method=\"post\">\t\t\t\t<div class=\"pass_border\">\t\t\t\t<input type=\"hidden\" name=\"userName\" value=\"kevin219\"/>\t\t\t\t\t设置新密码：<input type=\"password\" name=\"password\"  placeholder=\"请输入新的密码\"/>\t\t\t\t</div>\t\t\t\t<div class=\"pass_border\">\t\t\t\t\t确认密码：<input type=\"password\" name=\"password2\"  placeholder=\"请再次输入新的密码\"/>\t\t\t\t</div>\t\t\t\t<div style=\"width:94%;margin:0 auto;text-align:center;\">\t\t\t\t\t<input class=\"sub\" type=\"submit\" value=\"确定\"/>\t\t\t\t</div>\t\t\t</form>\t\t</div>\t\t\t<div class=\"bai_heig\"></div>\t<div class=\"footer\">\t\t<ul>\t\t\t<li>\t\t\t\t<a href=\"/wap/wapIndex.jsp?uuniq=1427031480085716\">\t\t\t\t\t首页\t\t\t\t</a> \t\t\t</li>\t\t\t<li>\t\t\t\t<a href=\"/wap/touch/catalog.do\">\t\t\t\t\t分类\t\t\t\t</a> \t\t\t</li>\t\t\t<li>\t\t\t\t<a href=\"/wap/touch/StaticPage.do?alias=help05\">\t\t\t\t\t帮助\t\t\t\t</a> \t\t\t</li>\t\t\t<li class=\"fo_li_last\">\t\t\t\t<a href=\"/wap/touch/guestbook/guestBookIndex.jsp\">\t\t\t\t\t意见反馈\t\t\t\t</a> \t\t\t</li>\t\t\t<li class=\"fo_li_last\">\t\t\t\t<a href=\"/wap/touch/StaticPage.do?alias=about\">\t\t\t\t\t关于我们\t\t\t\t</a>\t\t\t</li>\t\t</ul>\t\t<div class=\"foot_con\">\t\t\t<p>\t\t\t\t买卖宝客服热线：<a href=\"tel:4008869499\">400-886-9499</a>\t\t\t</p>\t\t\t<p>\t\t\t\t<a class=\"foot_cli\" href=\"/wap/wap4/changeV.jsp?toV=2\">\t\t\t\t\t\tWAP版\t\t\t\t</a> \t\t\t\t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\t\t\t\t<a href=\"javascript:void(0)\">\t\t\t\t\t<span>触屏版</span>\t\t\t\t</a>\t\t\t</p>\t\t\t<p>\t\t\t\t<a href='http://www.jsgsj.gov.cn:60101/keyLicense/templet/Company10-60.jsp'>\t\t\t\t\t<img src='http://rep.mmb.cn/wap/upload/touch/newWap/icon/fo_dz.png' width='30px'/>\t\t\t\t</a>\t\t\t\t<span class=\"fo_ba\">&nbsp;&nbsp;MMB.CN（苏ICP备10122122）</span>\t\t\t</p>\t\t</div>\t</div>    <span style='display:none' id='sheep_url'>/wap/login.do?backto=%2Fwap%2Ftouch%2Fuser%2FinputNewPassword.jsp%3Fuuniq%3D1427031400767860%26r%3D1</span>        <span style='display:none' id='sheep_do'>/wap/touch/findSheep.do?r=0.29827094004312193</span>    <script type='text/javascript' src='http://rep.mmb.cn/wap/upload/touch/newWap/js/sheep18.js'></script>        <link rel='stylesheet' href='http://rep.mmb.cn/wap/upload/touch/newWap/css/sheep.css'/>    <span style=\"display:none\" id='sheep_return'>false</span>    <span style=\"display:none\" id='sheep_back'>false</span>    </div></body></html>\n3、以本人的账号作为测试，只是证明漏洞存在，请勿查水表。如下，下发短信码后，提交任意短信码（此处为123456）\n\n4、提交该请求后，第一次返回如下内容（响应包内容为：1）\n\n5、修改响应数据包为：0，释放请求\n\n6、接着会返回如下响应，内容提示：验证码错误\n\n7、使用前面步骤2记录的正常流程返回的响应包替代此处\n\n8、释放该请求后，进行重置新密码页面，设置新密码为：888qqq\n\n9、重置密码成功\n\n   漏洞证明：  参见详细说明   修复方案：  不只是在客户端校验，服务端校验同样很重要   版权声明：转载请注明来源 恋锋@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-03-28 14:56 厂商回复：  漏洞Rank：12  (WooYun评价) 最新状态： 2015-05-12：前段时间负责乌云同事离职，现已修复  ", "replys": "漏洞评价：\n评论\n     2015-03-23 14:57 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  你这复现过程也忒复杂了，敢不敢简洁点，然后没用的部分去掉，复测很容易走弯路，@@~    \n     2015-03-23 15:04 |    \t\t恋锋 \t\t\t( 普通白帽子  |\t\t\t        Rank:261 漏洞数:42        | 为了成为一名优秀的白帽子而继续努力！)\t\t \n  @浩天 回头抽空改哈，多谢提醒哈    \n     2015-03-23 15:08 |    \t\t0x 80 \t\t\t( 普通白帽子  |\t\t\t        Rank:1301 漏洞数:398        | 某安全公司招聘系统运维、渗透测试、安全运...)\t\t \n  参数    \n     2015-03-24 20:52 |    \t\t恋锋 \t\t\t( 普通白帽子  |\t\t\t        Rank:261 漏洞数:42        | 为了成为一名优秀的白帽子而继续努力！)\t\t \n  @买卖宝  良心厂商，不会是忽略的节奏吧    \n     2015-05-12 13:00 |    \t\t恋锋 \t\t\t( 普通白帽子  |\t\t\t        Rank:261 漏洞数:42        | 为了成为一名优秀的白帽子而继续努力！)\t\t \n  @浩天 求补发rank，谢谢    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}