{"id": 60057, "wybug_id": "wooyun-2013-044963", "wybug_title": "某地区万科服务器存安全漏洞可导致网站用户信息泄漏", "wybug_corp": "万科集团", "wybug_author": "Kuuki", "wybug_date": "2013-12-05 09:55", "wybug_open_date": "2014-01-19 09:55", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "渗透测试思路", "管理后台对外", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-05：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-01-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 针对长沙万科的渗透测试，从官网到服务器一锅端 详细说明：  http://www.csvanke.com 官网点进去发现thinkphphttp://www.csvanke.com/index.php/csvk_listed4/id/351 发现存在注入点加引号直接报错，绝对路径和语句都爆出来了。\nFatal error: Uncaught exception 'Chili_Db_Exception' with message '1064 Sql Error: SELECT * FROM voreds_post WHERE id = '351'' You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''351''' at line 1' in D:\\web\\csvanke\\library\\chili\\db\\select.php:204 Stack trace: #0 D:\\web\\csvanke\\library\\chili\\db\\table.php(145): Chili_Db_Select->excute('FETCH') #1 [internal function]: Chili_Db_Table->find('id', '351'') #2 D:\\web\\csvanke\\library\\chili\\common.php(19): call_user_func_array(Array, Array) #3 D:\\web\\csvanke\\application\\view\\csvk\\listed4.phtml(5): excute('Db_Csvk', 'find', Array) #4 D:\\web\\csvanke\\library\\chili.php(64): require_once('D:\\web\\csvanke\\...') #5 D:\\web\\csvanke\\index.php(32): Chili::excute() #6 {main} thrown in D:\\web\\csvanke\\library\\chili\\db\\select.php on line 204\n用sqlmap进行自动化测试 发现没有root权限 测试写shell失败接着发现后台http://www.csvanke.com/admin.php根据logo发现是套自主研制的看房系统，在库里面发现同名表段，查询到密码\n\n成功登陆进后台随便找个传图片的地方传一个php马\n\n去前台看看 发现并没有被改名，直接上菜刀\n\n原来还有其他分站  找到户主bbs的表看一看\n\n不是administrator权限 不过权限也够用了 想看的都能看提权就不提了 阿里云的主机...   漏洞证明：  \n\n   修复方案：  \n1.sql语句过滤（thinkphp升级好像可以解决）2.后台上传做限制其实权限上面都控制的不错，不知道为什么基本的攻击手段没有做防御措施\n   版权声明：转载请注明来源 Kuuki@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}