{"id": 7506, "wybug_id": "wooyun-2013-041444", "wybug_title": "腾讯邮箱漂流瓶可泄露对方邮箱和QQ（匿名也中招）", "wybug_corp": "腾讯", "wybug_author": "sdj", "wybug_date": "2013-10-30 12:04", "wybug_open_date": "2013-12-14 12:04", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-14：\t细节向公众公开  简要描述： 腾讯邮箱漂流瓶可泄露对方邮箱和QQ。你还敢在漂流瓶里放开自己毫无顾忌的什么也说吗？有一天你捞到一封xx邮件，一看，源头竟然是你女朋友发的，情何以堪？ 详细说明：  抓取邮箱读取邮件的url，抓取漂流瓶打开瓶子的url，两者一对比，很多相同的地方啊。比如都有一个最显眼的mailid，那为什么邮件可以显示对方邮箱，漂流瓶不会呢。把访问某封邮件时提交的数据里面的mailid替换成打开漂流瓶时的mailid，其中读取邮件的mailid为ZC4025-V6GbGgjdI8qjHjJgExxxxxx 这样的，漂流瓶的为UY1647C8F90E6AF1B7_LP0030-8mEtDko19WkZLEASxxxxxx，第一次提交成UY1647C8F90E6AF1B7_LP0030-8mEtDko19WkZLEASxxxxxx，发现报错，接着把前面的UY1647C8F90E6AF1B7_去掉，只提交LP0030-8mEtDko19WkZLEASxxxxxx，猜猜看我发现了什么。   漏洞证明：  1：下图为读取邮件时提交的数据：\n\n2：下图为打开漂流瓶时：\n\n3：正常流程：\n\n4：替换mailid访问一下看看：\n\n嗯，睡觉不流口水的妹子不是萌妹子。经审核测试 标准版大多数会提示：\n\n而基本版则无此问题\n\n   修复方案：  开发人员懂哇。   版权声明：转载请注明来源 sdj@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-10-31 11:38 厂商回复： 非常感谢您的报告。这个问题我们已经确认，正在与业务部门进行沟通制定解决方案。如有任何新的进展我们将会及时同步。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-30 12:50 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  mark    \n     2013-10-30 13:06 |    \t\tprint_0x0000 \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:22        | 一枚苦逼的农民工.)\t\t \n  哈哈哈～有一天你捞到一封xx邮件，一看，源头竟然是你女朋友发的关注一下.    \n     2013-10-30 13:36 |    \t\tsdj \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:6        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  感谢审核人员的补充，摸摸大    \n     2013-10-30 14:05 |    \t\t蛋炒饭 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 秘密)\t\t \n  目测是xss    \n     2013-10-30 15:51 |    \t\tM0nster \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:17        | 允许我国的艺术家先富起来)\t\t \n  @蛋炒饭 好牛逼的目测    \n     2013-10-30 16:59 |    \t\tMr.Jen \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:2        | 开放自由)\t\t \n  情何以堪？    \n     2013-10-30 22:37 |    \t\t→Ｈack涛 \t\t\t( 普通白帽子  |\t\t\t        Rank:158 漏洞数:55        | 好好学习，天天向上！)\t\t \n  XXXSSSXXXSS    \n     2013-11-20 08:47 |    \t\t啊L川 \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:39        | 菜鸟 ，菜渣， 菜呀！)\t\t \n  哈哈哈～ 有一天你捞到一封xx邮件，一看，源头竟然是你女朋友发的 关注一下    \n     2013-11-20 18:40 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  ONS？北京？来Q号，哈哈    \n     2013-11-30 13:15 |    \t\tMoogong \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:8        | 伪法医)\t\t \n  吊了    \n     2013-12-01 08:52 |    \t\t花生^_^ \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 加强学习~~)\t\t \n  高端洋气~~    \n     2013-12-14 13:33 |    \t\t阿布 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:5        )\t\t \n  RP?    \n     2013-12-14 13:52 |    \t\t北洋贱队 \t\t\t( 普通白帽子  |\t\t\t        Rank:252 漏洞数:25        )\t\t \n  不公开多好    \n     2013-12-14 14:22 |    \t\tT-MAC \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:2        )\t\t \n  有一天你捞到一封xx邮件，一看，源头竟然是你女朋友发的    \n     2013-12-14 16:45 |    \t\t麻花藤 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | ด้้้้้็็็็็้้้้้็็็็...)\t\t \n  有一天你捞到一封xx邮件，一看，源头竟然是你女朋友发的    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}