{"id": 761, "wybug_id": "wooyun-2014-074186", "wybug_title": "途牛旅游网某后台无验证导致getshell内网漫游", "wybug_corp": "途牛旅游网", "wybug_author": "一个狗", "wybug_date": "2014-08-28 12:04", "wybug_open_date": "2014-10-12 12:08", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["管理后台对外", "安全意识不足", "后台被猜解", "内网毫", "防御力"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-12：\t细节向公众公开  简要描述： 途牛网站某后台无验证访问且可以getshell，之后导致了整个内网沦陷。 详细说明：  一个类似后台的地方暴露上传接口，然后用00截断就能任意上传。首先，漏洞出现的地方是：\n\nburp截包看数据：\n\n上传的文件会以focus_x.txt的形式保存在当前目录，其中x可控。可以在recommendTitle中写入一句话木马，之后通过00截断可以绕过txt的后缀检查，上传一个简单的shell。   漏洞证明：  执行了一些命令。\n\n\n\n\n\n34后面应该负载了几台服务器，用菜刀连上来看了看。10.10.0.103\n\n10.10.0.95\n\n10.10.0.108\n\n10.10.0.102\n\n看一下netstat\n\n发现了zabbix_agent之后反弹了shell到一个服务器上，用tmux保存了一下session，暂时睡觉了。第二天咯，把内网啪啪啪转发了出来，zabbix不是弱密码，看来运维的安全意识比youku土豆强一些XD发现了一个WordPress，看看用户名。\n\n\n\n发现一个phpmyadmin，用万能密码能进来，之后又尝试，发现弱密码root/root\n\n写shell，上菜刀，发现了一些厉害的事情。\n\n\n\nPwdump7.exeAdministrator:500:A1A072F580871DC3B14FD58A657A9CA6:B29B766F15B2656ECBDA4BD4D9162879:::Guest:501:NO PASSWORD*********************:31D6CFE0D16AE931B73C59D7E0C089C0:::admin:1003:32CE7A3887D3C2BFAAD3B435B51404EE:AF8E92EBC4D8A71C21BDA8F29C7338CD:::__vmware_user__:1006:NO PASSWORD*********************:NO PASSWORD*********************:::wps:1008:640D673C94B89529AAD3B435B51404EE:79369B32EE1E36EF16FFB708FD5F5BA8:::postgres:1011:A1A072F580871DC3B14FD58A657A9CA6:B29B766F15B2656ECBDA4BD4D9162879:::pentest:1013:C170CDC8BAD80F1A2430574B6E34A817:C90D069B9B5EBA845349B042DBAF1BC3:::administrator tuniu2906\n\n另外一台弱口令的服务器10.10.10.120administrator tuniu520\n\n财务报表?利用mssql命令执行搞定172.22.0.110用户名： siweb  密码：     siweb\n\n这个机器里面的数据库应该很多东西吧～XD如果dump一下是不是又是大裤子一枚？只是本狗太有节操了，没zuosi。截图太累了到此为止吧～   修复方案：  开发的安全意识太差，后台暴露，而且代码也有bug，在内网各种弱密码，觉得内网就能安全了吗？有点遗憾的是本狗搞了两天忘了放后门，忙了忙别的事情。结果过了一个礼拜那个后台403了外面没法访问了，不然还能继续探索内网。给开发们统一上上课，至少别在到处乱用弱密码了。   版权声明：转载请注明来源 一个狗@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-08-28 12:26 厂商回复： 感谢一只狗提交的漏洞，这漏洞在我们安全人员去参加kcon v3 的时候已经从小伙伴那边得知，不知洞主是否是我们安全人员认识的小伙伴，这漏洞给了我们一个很好的提醒，先确认再后续处理后门shell的问题，漏洞也已经修补，Thanks，欢迎继续测试！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-28 12:06 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  一个狗提交了途牛旅游网某后台无验证导致getshell内网漫游    \n     2014-08-28 13:02 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @疯子 你关注的 疯子 发表了评论    \n     2014-08-28 14:41 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @xsser 厂商回复:感谢一只狗提交的漏洞    \n     2014-08-28 16:39 |    \t\tgreg.wu \t\t\t( 普通白帽子  |\t\t\t        Rank:815 漏洞数:99        | 打酱油的~)\t\t \n  感谢一只狗提交的漏洞    \n     2014-08-28 17:00 |    \t\tdepycode \t\t\t( 普通白帽子  |\t\t\t        Rank:275 漏洞数:44        | 关注网络安全，提高技术！)\t\t \n  感谢一只狗提交的漏洞    \n     2014-08-28 17:01 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  感谢一只狗提交的漏洞    \n     2014-08-28 17:36 |    \t\tloli  \t\t\t( 普通白帽子  |\t\t\t        Rank:550 漏洞数:52        )\t\t \n  @xsser  你关注的  xsser 发表了评论    \n     2014-09-17 15:52 |    \t\t大大灰狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:248 漏洞数:53        | Newbie)\t\t \n  他叫一个狗    \n     2014-10-13 09:48 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  他叫一个狗    \n     2014-10-31 21:28 |    \t\tredrain有节操 \t\t\t( 普通白帽子  |\t\t\t        Rank:183 漏洞数:26        | ztz这下子有165了！>_<'/&\\)\t\t \n  膜拜我家一个狗    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}