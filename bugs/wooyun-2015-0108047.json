{"id": 33765, "wybug_id": "wooyun-2015-0108047", "wybug_title": "分分钟搞定邮箱大师手势密码", "wybug_corp": "网易", "wybug_author": "Nicky", "wybug_date": "2015-04-15 10:55", "wybug_open_date": "2015-07-15 15:54", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["客户端程序设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-19：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-15：\t细节向公众公开  简要描述： 邮箱大师某设计缺陷可导致手势密码完全失效 详细说明：  1.上个提交的漏洞有的人可能还会说，我设置了手势密码，黑客就算盗了我应用所有数据，他打开应用一样要输入手势密码才能登录，其实，对黑客来说这些都不是事2.在/data/data/com.netease.mail/shared_prefs/下的android-lockpattern-xxx.xml中保存着邮箱大师手势密码配置\n\n3.当用户未开启手势密码时，文件内容是这样的：\n<?xml version='1.0' encoding='utf-8' standalone='yes' ?><map>    <null name=\"alp.pkey.sys.pattern\" />    <int name=\"alp.pkey.display.cur_retry\" value=\"0\" />    <boolean name=\"alp.pkey.sys.auto_save_pattern\" value=\"false\" /></map>\n4.开启后是这样的：\n\n5.可以看到手势密码是加密过的（alp.pkey.sys.pattern值），看着很安全？但安全都相对的6.如果用户手机已经root或者被盗，再或者就是上个漏洞讲的被黑客接触一分钟，手势就是如同虚设了（话说手势密码的出现就是为了解决手机被盗这类问题的吧）   漏洞证明：  利用方式：1.通过ADB，复制应用数据后如发现有手势密码，直接替换相关android-lockpattern-xxx.xml文件为如下内容，重启邮箱大师APP，手势密码会自动清除：\n<?xml version='1.0' encoding='utf-8' standalone='yes' ?><map>    <null name=\"alp.pkey.sys.pattern\" />    <int name=\"alp.pkey.display.cur_retry\" value=\"0\" />    <boolean name=\"alp.pkey.sys.auto_save_pattern\" value=\"false\" /></map>\n2.用户手机被盗，同样可利用以上方式破解补充内容：1.后来测试发现是可以直接无手势密码时的文件（修改xml文件内容无法清除）来清除手势密码，估计还是有一定验证的2.然后想到一个更轻松的方法。。。就是直接删android-lockpattern-xxx.xml文件，实测可成功清除手势密码！   修复方案：  不用xml方式配置手势密码怎么样？或者检测到xml文件被修改后直接清空登录凭证   版权声明：转载请注明来源 Nicky@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-04-16 15:52 厂商回复： 感谢您对网易的关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-15 10:56 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  三连发哈哈！！！    \n     2015-04-15 11:37 |    \t\t小荷才露尖尖角 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:13        | less is more)\t\t \n  开启刷洞模式    \n     2015-04-15 12:45 |    \t\t庙口大王 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:6        | 呵呵)\t\t \n  啪啪啪、三连发    \n     2015-04-15 14:27 |    \t\t周周 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:2        | 开发)\t\t \n  啪啪啪    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}