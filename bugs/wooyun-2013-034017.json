{"id": 9432, "wybug_id": "wooyun-2013-034017", "wybug_title": "海尔集团之9当SQL Injection遭遇SSL", "wybug_corp": "海尔集团", "wybug_author": "小胖子", "wybug_date": "2013-08-10 08:58", "wybug_open_date": "2013-09-24 08:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "注射", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-24：\t细节向公众公开  简要描述： 小胖子正在暴走！！小胖子已经如同神一般了！！求求谁去杀了他吧！！这回不是老系统了吧，我找到了你们的新C段，哈哈 详细说明：  系统地址：海尔TRC系统https://58.56.128.8/tcs\n\n其实SQL Injection遭遇SSL的时候是很难过的，常规工具不好用，直接停止工作，所以需要抓一下SSL的包。这个过程我想我会写一个drops到乌云。登陆的地方没有验证，但是貌似又预编译，没射成功，就找到了如下地址。https://58.56.128.8/tcs/Frm_HaierCustReg.aspx在这里注册的时候，检测用户名时候可用，直接带进数据库查询的，导致注入。\n\n千辛万苦抓了包。\nPOST https://58.56.128.8/tcs/Frm_HaierCustReg.aspx HTTP/1.1Accept: image/jpeg, application/x-ms-application, image/gif, application/xaml+xml, image/pjpeg, application/x-ms-xbap, application/x-shockwave-flash, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*Referer: https://58.56.128.8/tcs/Frm_HaierCustReg.aspxAccept-Language: zh-CNUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: 58.56.128.8Content-Length: 2130Connection: Keep-AliveCache-Control: no-cacheCookie: ASP.NET_SessionId=icmldl55rqjvub45pfwgyy2t__EVENTTARGET=&__EVENTARGUMENT=&__VIEWSTATE=dDwyODI4MzgyNzA7dDw7bDxpPDE%2BOz47bDx0PDtsPGk8NT47aTw3PjtpPDEzPjtpPDIzPjtpPDI1Pjs%2BO2w8dDx0PHA8cDxsPERhdGFUZXh0RmllbGQ7RGF0YVZhbHVlRmllbGQ7PjtsPGNkZXBBYmJOYW1lO2RlcGNvZGU7Pj47Pjt0PGk8NTM%2BO0A8LS3or7fpgInmi6ktLTvljJfkuqw75aSp5rSlO%2BWUkOWxsTvlkbzlkozmtannibk755%2Bz5a625bqEO%2BWkquWOnzvkuIrmtbc75p2t5beeO%2BWNl%2BS6rDvlroHms6I75peg6ZShO%2Ba1juWNlzvlvpDlt54754Of5Y%2BwO%2Ba1juWugTvpnZLlsps75ZCI6IKlO%2BWNl%2BaYjDvmsojpmLM76ZW%2F5pilO%2BmUpuW3njvlpKfov5475ZOI5bCU5ruoO%2Bilv%2BWuiTvlhbDlt5476ZO25bedO%2Bilv%2BWugTvkuYzpsoHmnKjpvZA75oiQ6YO9O%2BmHjeW6hjvotLXpmLM75piG5piOO%2BW5v%2BW3njvmt7HlnLM756aP5beeO%2BWOpumXqDvmtbflj6M75Y2X5a6BO%2BatpuaxiTvpg5Hlt5476ZW%2F5rKZO%2BilhOaoijvnlJ%2FnianljLvnlpc7RVBHO%2BaAu%2BWFrOWPuDvpgJrorq876K6h566X5py6O%2BeUteacujvnlLXmjqc75paw5p2Q5paZO%2BeJuemSojvnvo7lsJTnsonmnKs7PjtAPC0t6K%2B36YCJ5oupLS07MTAxMDEwMTsxMDEwMTAyOzEwMTAxMDM7MTAxMDEwNDsxMDEwMjAxOzEwMTAyMDI7MTAxMDMwMTsxMDEwMzAyOzEwMTAzMDM7MTAxMDMwNDsxMDEwMzA1OzEwMTA0MDE7MTAxMDQwMjsxMDEwNDAzOzEwMTA0MDQ7MTAxMDQwNTsxMDEwNTAxOzEwMTA1MDI7MTAxMDYwMTsxMDEwNjAyOzEwMTA2MDM7MTAxMDYwNDsxMDEwNjA1OzEwMTA3MDE7MTAxMDcwMjsxMDEwNzAzOzEwMTA3MDQ7MTAxMDcwNTsxMDEwODAxOzEwMTA4MDI7MTAxMDgwMzsxMDEwODA0OzEwMTA5MDE7MTAxMDkwMjsxMDEwOTAzOzEwMTA5MDQ7MTAxMDkwNTsxMDEwOTA2OzEwMTEwMDE7MTAxMTAwMjsxMDExMDAzOzEwMTEwMDQ7MTAxMjAwMTsxMDEyMDAyOzEwMTIwMDM7MTAxMjAwNDsxMDEyMDA2OzEwMTMwMDE7MTAxMzAwMjsxMDEzMDAzOzEwMTMwMDQ7MTAxMzAwNTs%2BPjs%2BOzs%2BO3Q8dDw7O2w8aTwwPjs%2BPjs7Pjt0PHQ8cDxwPGw8RGF0YVRleHRGaWVsZDtEYXRhVmFsdWVGaWVsZDs%2BO2w8Y3JvbGVuYW1lO2Nyb2xlY29kZTs%2BPjs%2BO3Q8aTw0PjtAPC0t6K%2B36YCJ5oupLS075oC757uP55CGO%2Bi0ouWKoeS6uuWRmDvkuJrliqHkurrlkZg7PjtAPC0t6K%2B36YCJ5oupLS07MTAwMTg7MTAwMTk7MTAwMjA7Pj47Pjs7Pjt0PHA8O3A8bDxvbmNsaWNrOz47bDxyZXR1cm4gQ2hlY2soKVw7Oz4%2BPjs7Pjt0PHA8O3A8bDxvbmNsaWNrOz47bDxqYXZhc2NyaXB0OndpbmRvdy5jbG9zZSgpXDs7Pj4%2BOzs%2BOz4%2BOz4%2BOz78LmESah3PB70h35k8zD7kl45DmA%3D%3D&Texusername=a&btn_test=%E6%B5%8B%E8%AF%95%E8%B4%A6%E5%8F%B7&ddlGM=--%E8%AF%B7%E9%80%89%E6%8B%A9--&ddlCustType=0&txtusercode=&txtUserName=&Drprole=--%E8%AF%B7%E9%80%89%E6%8B%A9--&txtEmail=&txttel=&TxtCustDJNum=&GMCode=&Hcustcode_sp=\n肯定是注入了。\n\n数据库权限永远很高\n\n得到的数据库，想进去看看jump了下表，抱歉。\n\n数据库\navailable databases [8]:[*] CMI[*] Invoice[*] lumigent[*] master[*] model[*] msdb[*] TCS[*] tempdb\n   漏洞证明：  \navailable databases [8]:[*] CMI[*] Invoice[*] lumigent[*] master[*] model[*] msdb[*] TCS[*] tempdb\n   修复方案：  0x1：账户权限过高。0x2：过滤。任何post都不能放过，SSL也不是万能的。   版权声明：转载请注明来源 小胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-08-13 08:53 厂商回复： 感谢 @小胖子 的工作。漏洞描述：在客户注册时进行账号测试的时候使用了数据库的管理员用户，导致可以访问系统表，可以查询到TCS系统中的数据表。这个漏洞预计在2013-08-13晚上程序发布时修复。请白帽子们持续友好监督海尔信息安全工作，非常感谢。另外1，我看经常有人评论或留言时出现错误，现给各位普及一下：海尔不是国企。另外2，海尔有人做网络，但是海尔首先是制造业，并不是IT业，百度、淘宝、新浪等有一样有漏洞，海尔也不可避免，能有各位帮助监督整改，海尔表示非常感谢。另外3，海尔希望曝出问题和漏洞，然后针对性整改，就像当年张首席砸冰箱一样，条条大路通罗马，保证质量的友好真诚行为，海尔一概接受，并不会出现抓狂情况。以上，仅供参考，如有不明，请跟贴。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-10 09:01 |    \t\tB1acken \t\t\t( 普通白帽子  |\t\t\t        Rank:174 漏洞数:56        | 渣渣)\t\t \n  海尔正在抓狂中……    \n     2013-08-10 09:05 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2013-08-10 09:16 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @VIP 你起得比鸡还早啊！    \n     2013-08-10 09:19 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小胖子 因为鸡饿了啊    \n     2013-08-10 09:24 |    \t\t小痞子 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:21        | <xss>alert(\"a\")</xss>￥&@&……dssKhwjcw...)\t\t \n  @小胖子 你还有完没有啊~~受不鸟了~    \n     2013-08-10 09:25 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @小痞子 还有提交了在审核的。。。客官骚等。。。    \n     2013-08-10 09:37 |    \t\t小痞子 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:21        | <xss>alert(\"a\")</xss>￥&@&……dssKhwjcw...)\t\t \n  @小胖子 需要代劳么？ 我帮你交几个吧...     \n     2013-08-10 11:05 |    \t\t随时回来 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:11        | 今年收成不好，喂的猪一点都没长，明早还得...)\t\t \n  胖哥这是跟国企闹别扭么    \n     2013-08-10 11:08 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @随时回来 因为我家没电视！！！！@海尔集团    \n     2013-08-10 11:09 |    \t\t随时回来 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:11        | 今年收成不好，喂的猪一点都没长，明早还得...)\t\t \n  @小胖子 看短信息 给你发站内了   求冰箱一台    \n     2013-08-10 12:00 |    \t\t随时回来 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:11        | 今年收成不好，喂的猪一点都没长，明早还得...)\t\t \n  @小胖子 胖子哥   能顺带帮我拿一个冰箱不，天气热，家里的饭菜经常过期    \n     2013-08-10 12:12 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  再逼下去，海尔一口气全忽略了。。。     \n     2013-08-10 22:17 |    \t\t灬相随灬 \t\t\t( 普通白帽子  |\t\t\t        Rank:369 漏洞数:68        | 大胆天下去得，小心寸步难行。)\t\t \n  海尔还真是麻烦，没人做网络啊、、、http://www.haierabc.com/    \n     2013-08-10 22:25 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @灬相随灬 我靠，还有这个玩意儿啊。。。扫C段扫死我了~~~目测这里面一大半的系统被我拿下了~我都提交到12了，只是管理员还没来得及审核~~~    \n     2013-08-10 23:17 |    \t\t灬相随灬 \t\t\t( 普通白帽子  |\t\t\t        Rank:369 漏洞数:68        | 大胆天下去得，小心寸步难行。)\t\t \n  @小胖子 额...合理运用搜索引擎....net 和.com 会出来一大堆后台。。。    \n     2013-08-10 23:30 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @灬相随灬 还有很多其他域名哟，能搜索出来的基本都搞了~除了几个IBM的和cisco的    \n     2013-08-11 00:13 |    \t\ttxcbg \t\t\t( 普通白帽子  |\t\t\t        Rank:391 漏洞数:53        | 说点什么呢？)\t\t \n  神了    \n     2013-08-11 01:09 |    \t\tz7y \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:9        | 关注技术与网络安全)\t\t \n  哇哈哈哈哈，我家胖子没人想来终结一下么！！！    \n     2013-08-13 09:09 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @小痞子 @乐乐、 @随时回来 @灬相随灬  @txcbg @z7y @VIP @xsser @海尔集团 @疯狗 @Finger  来看看厂商回复啊，这样的厂商真的是碉堡了，漏洞反馈可以说是乌云最好的，果断去厂商主页好评，@海尔集团 要是能送个电视什么的，就好了，哈哈哈哈    \n     2013-08-13 09:09 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小胖子 好厂商    \n     2013-08-13 09:38 |    \t\t灬相随灬 \t\t\t( 普通白帽子  |\t\t\t        Rank:369 漏洞数:68        | 大胆天下去得，小心寸步难行。)\t\t \n  @小胖子 不错不错,难得难得    \n     2013-09-24 23:08 |    \t\tsoftbug \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:10        | 为人类设计最好的软件，解放人的双手,一起...)\t\t \n  绕过那些可怜的企业吧 你们这些黑客    \n     2013-09-25 09:30 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  哈哈，其实海尔作为厂商，回复的字挺多的，感觉还算有诚意    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}