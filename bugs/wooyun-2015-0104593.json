{"id": 23723, "wybug_id": "wooyun-2015-0104593", "wybug_title": "小米MIUI系统任意第三方APP可呼出系统自带权限管理界面", "wybug_corp": "小米科技", "wybug_author": "罗杨", "wybug_date": "2015-03-30 15:52", "wybug_open_date": "2015-06-29 11:04", "wybug_type": "非授权访问/认证绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "安全", "手机软件安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-03：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-29：\t细节向公众公开  简要描述： 由于小米手机MIUI V6系统的设计缺陷，导致任意第三方应用可以呼出系统内置的权限管理界面，该设置与MIUI自带的安全中心不兼容，会造成配置异常甚至是安全威胁。 详细说明：  AppOps是Android 4.3开始Android系统内置的权限管理界面，在Android 4.4中为了安全考虑，Google已经将该界面的入口移除，但是在MIUI最新开发版MIUI 5.3.27（适配MI 4LTE-CMCC）中却重启了AppOps的入口，导致任何第三方应用可以通过一段代码呼出AppOps进行权限控制，这会造成两方面问题：1）第三方恶意应用呼出AppOps后，可能会利用模拟点击等操作在AppOps界面进行权限设置，从而修改整个系统的权限。2）官方AppOps与MIUI自带的安全中心的“授权管理”功能重叠，但这两者却互不兼容，一旦用户在AppOps中误操作进行了权限设置，在安全中心“授权管理”页面是无法改回来的。因此给普通用户也造成了困扰。综上，AppOps的存在既带来了安全隐患，功能也冗余，应该删除。   漏洞证明：  在第三方应用中利用下面代码可呼出AppOps界面进行权限管理：\nIntent localIntent = new Intent();                localIntent.setClassName(\"com.android.settings\", \"com.android.settings.Settings\");                localIntent.setAction(\"android.intent.action.MAIN\");                localIntent.addCategory(\"android.intent.category.DEFAULT\");                localIntent.setFlags(8421376);                localIntent.putExtra(\":android:show_fragment\", \"com.android.settings.applications.AppOpsSummary\");                startActivity(localIntent);\n   修复方案：  在ROM中删除掉AppOps相关的代码：1）在系统源码packages\\apps\\Settings\\AndroidManifest.xml中将与Settings$AppOpsSummaryActivity有关的内容注释掉。2）删除packages\\apps\\Settings\\src\\com\\android\\settings\\applications下所有AppOps开头的源文件。   版权声明：转载请注明来源 罗杨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-03-31 11:03 厂商回复： 感谢您对小米安全的关注，我们会尽快修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}