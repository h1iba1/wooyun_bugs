{"id": 15524, "wybug_id": "wooyun-2012-014599", "wybug_title": "光棍节屌丝的逆袭专场NO.3---凡客诚品网修改任意妹子账号密码漏洞", "wybug_corp": "凡客诚品", "wybug_author": "风萧萧", "wybug_date": "2012-11-10 18:38", "wybug_open_date": "2012-12-25 18:38", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "设计错误", "设计缺陷", "手机短信"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-11-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-11-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-11-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-12-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-12-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-12-25：\t细节向公众公开  简要描述： 屌丝继续逆袭，当你拿到妹子的婚恋网站账号密码成功登陆网站时，看到的都是虚假的信息吧！那么你还想了解她更多的资料么？想知道她的购物历史么？想给她的真实地址寄送礼物么？来凡客吧！以上想法纯属意淫，以下测试实属危险，各位屌丝请勿模仿！ 详细说明：  1.出问题的是移动客户端访问的站点：m.vancl.com：\n\n2.点击右上角【登录】按钮，看到【取回密码】没有？问题就来了：\n\n3.输入需要重置密码的用户名吧，这里由于是测试，我使用了自己的账号：\n\n4.输入图片验证码后，点击【提交】，进入重置密码的下一个页面，同时手机上也收到一个6位纯数字的短信码（这里为区别图片验证码称为短信码）【053472】，我随意填写一个短信码000000，这里注意将浏览器设置好代理准备抓包：\n\n5.抓包的内容如下所示：\nPOST /User/RetrieveStep2 HTTP/1.1Host: m.vancl.comProxy-Connection: keep-aliveContent-Length: 40Cache-Control: max-age=0Origin: http://m.vancl.comUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.13 (KHTML, like Gecko) Chrome/24.0.1284.2 Safari/537.13Content-Type: application/x-www-form-urlencodedAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Referer: http://m.vancl.com/User/RetrieveStep1Accept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Accept-Charset: GBK,utf-8;q=0.7,*;q=0.3Cookie: LBSPageKey_1=0; _vuca=***********txtSMSVerity=000000&txtphone=1*********9\n很容易看出来参数txtphone为重置的手机号码，txtSMSVerity为短信码了！将该请求发送到burpsuite的intruder模块，配置爆破的参数为txtSMSVerity，并且设置线程数为100：\n\n\n\n\n\n   漏洞证明：  5.我们可以通过返回内容的字节数进行判断是否获取到正确的短信码，在这里7946个字节表示短信码不正确，而7662个字节表示成功获取到短信码；同时也可通过返回的内容不同区别错误与正确的短信码：\n\n\n\n6.好吧，我测试了4W次请求，只需2分钟时间！最后拿获取到的短信码进行修改密码吧！\n\n7.我等屌丝再次成功逆袭！\n\n\n\n   修复方案：  1.测试时我密码取回了几次，每次发送的短信码的第一位都是0，那么这里便是5位纯数字短信码的爆破，即平均5万次的请求，我使用了burpsuite测试单台机器100线程，4分钟即可重置任意一个手机账号！危险啊2.短信码可以为6位纯数字，甚至可以缩短为4为纯数字；可以不设置图片验证码，甚至可以不用设置短信码的有效期。但是为什么不设置连续5次尝试失败就锁定本次密码重置的请求呢？3.求20rank，求礼物！   版权声明：转载请注明来源 风萧萧@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2012-11-12 11:44 厂商回复： 已提交相关部门进行评估整改，感谢您对我们的关注与支持！PS：马总微信出来后已经在对此类问题重新评估，您的测试推动了我们对此类问题的关注，感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-11-10 18:39 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  洞主、虾米情况？    \n     2012-11-10 18:39 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  ..........    \n     2012-11-10 18:44 |    \t\tMetasploit \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:7        | http://www.metasploit.cn/)\t\t \n  好强大啊 待会会不会放手机号？    \n     2012-11-10 18:53 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  銱丝的福气啊    \n     2012-11-10 18:59 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  求……继续求……各种求    \n     2012-11-10 19:23 |    \t\troofsec \t\t\t( 普通白帽子  |\t\t\t        Rank:151 漏洞数:19        )\t\t \n  围观 连载啊~    \n     2012-11-10 19:47 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  银行卡 修改任意妹子账号密码漏洞    \n     2012-11-10 20:16 |    \t\tSeay \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:8        )\t\t \n  下一个，光棍节屌丝的逆袭专场NO.3---邮政银行修改任意妹子账号密码漏洞    \n     2012-11-10 20:19 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  @鬼魅羊羔 明天挖漏洞玩啊 和她冷战ing  明天过光棍节    \n     2012-11-10 21:18 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  @Finger 光棍节，我计划看一天的鬼片。。。    \n     2012-11-13 13:28 |    \t\t纷纭 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:8        | 学习者。)\t\t \n  一说马总就知道大概什么个思路了。手机验证码取回。    \n     2012-12-25 19:52 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  问题是有哪个妹子会去凡客\"陈\"品？还是找回iTunes密码吧。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}