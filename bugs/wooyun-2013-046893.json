{"id": 59567, "wybug_id": "wooyun-2013-046893", "wybug_title": "飞马企业网站系统-FeimaCMS多处sql注入及留言板存储型xss", "wybug_corp": "飞马企业网站系统", "wybug_author": "随页清风", "wybug_date": "2013-12-24 18:17", "wybug_open_date": "2014-02-07 18:18", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "存储"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-24：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-02-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 多个页面存在sql注入漏洞。留言处存在存储型xss 详细说明：  tupianfenlei.php等多个页面id未经过滤直接入库查询\n<?php  $fenleiId = $_REQUEST['id'];include(\"include/conn.php\");$queryImgFenlei=\"select * from hyimgfenlei_table where id=$fenleiId\";$resultImgFenlei=mysql_query($queryImgFenlei);$rowImgFenlei = mysql_fetch_array($resultImgFenlei);?>\nliuyan.php提交到include/liuyan.php中的留言未过滤就存储到数据库\n<?phpheader('Content-Type: text/html; charset=utf-8');include(\"conn.php\");$xingming = $_POST['xingming'];$tel = $_POST['tel'];$QQ = $_POST['QQ'];$Email = $_POST['Email'];$biaoti = $_POST['biaoti'];$neirong = $_POST['neirong'];$date = date('Y-m-j');$sql = \"INSERT INTO hyliuyan_table (name_ziduan,tel_ziduan,qq_ziduan,email_ziduan,title_ziduan,content_ziduan,date_ziduan) values('$xingming','$tel','$QQ','$Email','$biaoti','$neirong','$date')\";$result = mysql_query($sql);if($result) echo \"<script language=\\\"JavaScript\\\">alert(\\\"留言提交成功！\\\");</script>\";mysql_close();\n   漏洞证明：  sql的没改代码，没添加文章进行测试xss存储型漏洞\n\n\n\n   修复方案：  sql注入漏洞对相应参数过滤。xss漏洞通过htmlspecialchars() 过滤，或者自定义函数过滤   版权声明：转载请注明来源 随页清风@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}