{"id": 16709, "wybug_id": "wooyun-2012-012146", "wybug_title": "sql查询过滤不严，大量人才信息泄露", "wybug_corp": "苏州高新人才网", "wybug_author": "tiebuchen", "wybug_date": "2012-09-13 14:01", "wybug_open_date": "2012-10-28 14:02", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-09-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-10-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-10-28：\t细节向公众公开  简要描述： 苏州高新人才网，档案查询出现问题。在该网站可以查询不同地区的档案。查询条件是 姓名+生日。但是通过连接后台的sql查询的url，并修改url中的查询字段时，只要查询姓名他就会出现改姓名的信息，输入生日（姓名不填），他就会出现所有相同生日的人的信息。而且他的后台有好多不同地区的个人档案，都是通过url查询，好多地区的查询都有问题。 详细说明：  首先到网站的主页：http://www.sndhr.com/SNDHRWeb/YZSFW/WebPage/Aspx/Index.aspx\n\n然后点击档案查询，姓名和生日可以任意填写（比如姓名填写一个‘王’字），点击查询\n\n这个地区的包含这个字的姓名都会出现，而且带有个人信息。打开查询之后的网站的源代码：\n\n可以看到，有好多的不同网站都是通过url进行对数据库进行查询的。只要简单的对url中查询字段进行修改就可以简单的查到想要的信息。进入：http://www.sndhr.com/FilesChaining/Default.aspx?CName=&Birthday=1988-08-08把CName=字段置空，只设置生日，确定，就会出现所有该生日的人的信息\n\n同样，只输入正确的人名，不输入生日同样可以查到想要的信息。\n\n以上只是 苏州市高新区人力资源开发管理中心 的数据库库。还有好多的数据库都有问题。比如：常熟市人力资源管理服务中心 ，只要查姓名中的一个字，他就会出现所有包含这个字的人名。\n\n\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /><title>常熟人才就业网</title><link href=\"/css/css.css\" rel=\"stylesheet\" type=\"text/css\" /><script language=\"javascript\">\tfunction ok1(){\t\tvar txt = document.getElementById(\"txtFind\").value;\t\tif(txt==''){\t\t\talert('请输入查询姓名');\t\t\tdocument.getElementById(\"txtFind\").focus();\t\t\treturn false;\t\t}\t\telse\t\t{\t\t   \t\t   var newUrl = window.location.protocol + \"//\" + window.location.host + \"/suzhou/searchda.php?name=\" + document.form1.txtFind.value ;\t\t\t\t//window.location.href=newUrl;\t\t    document.location.replace(newUrl);\t\t\t\t//return true;\t\t}\t}</script></head><body><table width=\"835\" border=\"0\" align=\"center\" cellpadding=\"0\" cellspacing=\"0\">        <tr>          <td  align=\"left\" valign=\"top\">          <form id=\"form1\" name=\"form1\" method=\"post\" action=\"searchda.php\"  onsubmit=\"return ok();\" >          <input name=\"active\" type=\"hidden\" value=\"search\" />\t\t\t\t\t\t<div style=\"font-size: 11pt; color: Chocolate\">\t\t\t\t\t\t\t\t\t\t\t    常熟市人力资源管理服务中心档案查询电话：0512-52805358<br/>\t\t\t\t\t    <br/>            </div>\t\t\t<div style=\"display:none;\">&nbsp;&nbsp;&nbsp;&nbsp;查询姓名：                        <input name=\"txtFind\" type=\"text\" id=\"txtFind\" style=\"width:200px;\"  value=\"王\"/>                        &nbsp;&nbsp;\t\t\t\t\t\t<input name=\"btnFind\" type=\"submit\" id=\"Button1\"  value=\"查找\"  />                        &nbsp;&nbsp;                        <input id=\"chkSearch\" type=\"checkbox\" name=\"chkSearch\" checked=\"checked\" value=\"yes\" />                        <label for=\"chkSearch\">使用模糊查询</label>                        <br />            </div>                       <table border=\"1\" cellpadding=\"0\" cellspacing=\"0\" width=\"830px\" bordercolor=\"#99CCFF\"        style=\"text-align: left; border-collapse: collapse\">        <tr style=\"font-weight: bold; height: 25px; font-size: 10pt;\">                          <td align=\"center\" width=\"60\" >姓名</td>                          <td align=\"center\" width=\"80\" >出生年月</td>                          <td align=\"center\" width=\"222\">毕业院校（单位）</td>\t\t\t\t\t\t  <td align=\"center\" width=\"80\" >毕业时间</td>\t\t\t\t\t\t  <td align=\"center\" width=\"59\">是否在库</td>            \t\t\t  <td align=\"center\" width=\"73\">来档时间</td>            \t\t\t  <td align=\"center\" >转往单位</td>\t\t                            </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王铭丹</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;1985.10.13</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;苏州大学07届（市内）</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;2008.3.20</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王治国</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;77.9.29</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;清华大学01届</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;2008.1.3</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;2008.4.17转人事部全国人才流动中心</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王雁涯</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;1970.2.12</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;中国农业银行辞职</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;2008.1.3</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;2008.2.14转常熟市农村商业银行</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王佳斌</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;1986.4.15</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;苏州工业园区职业技术学院07届</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;2008.1.3</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王婷</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;1986.8.21</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;镇江市高等专科学校07届</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;2008.1.8</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王仁皎</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;1982.4</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;05学档转入</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;2008.1.9</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王秋宏</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;1988.8.13</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;常州物资学校07届（市外）</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;2008.6.6</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王玉苗</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;1988.9.9</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;常州物资学校07届（市外）</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;2008.6.6</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王福保</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;1969.10</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;河南省人才交流中心（省外）</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;2008.6.12</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;2011.1.20转苏州市人才服务中心流动中介</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王和平</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;1984.2.17</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;常熟理工学院08届（市内）</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;2008.7.11</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王荣</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;1985.9.4</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;常熟理工学院08届（市内）</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;2008.7.11</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王俭</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;1985.5.13</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;常熟理工学院08届（市内）</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;2008.7.11</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;2009.5.4转张家港人才中心</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王倩</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;1986.4</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;常熟理工学院08届（市内）</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;2008.7.11</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王志红</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;苏州电视中专</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;8/24/1999</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王静香</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;省人口学校</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;8/3/1999</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王锋</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;省司法学校</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;8/16/1999</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王欢明</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;湖北航天工业学校</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;8/24/1999</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王欢</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;苏州丝绸学校</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;9/23/1999</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王晓红</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;省丝绸学校</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;11/18/1999</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>\t\t\t\t\t\t                           </tr>                                                <tr style=\"height: 25px; font-size: 9pt;\">                          <td class=\"table_td\" align=\"center\" >&nbsp;王佳</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;1986.7.13</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;常州信息职业技术学院07届</td>                          <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >--</td>\t\t\t\t\t\t  \t\t\t\t\t\t  <td class=\"table_td\" align=\"center\" >&nbsp;2008.1.10</td>                          <td class=\"table_td\" align=\"center\" >&nbsp;</td>\t\t\t\t\t\t                           </tr>                                                                   </table>                                    </div>            </form></td>        </tr>      </table></td>  </tr></table></body></html>\n这个是网站框架的源代码，全部都能看见。感觉个人信息放在上面太不安全了，只要动点心思，就是想看就看的。希望他们真心能够好好改一改，个人信息的泄密，很危险。我并非针对这个网站，而是我的档案在这里，但是查不到，我才想了这个办法，直接输入名字，不用生日，就可以查询个人信息了，才知道我的生日被弄错了。。。如果不改的话，这个漏洞就别发了，感觉不安全。   漏洞证明：  \n\n\n\n在详细说明中都有，就不举例子了。   修复方案：  这个大家都懂   版权声明：转载请注明来源 tiebuchen@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-09-17 23:22 厂商回复： CNVD确认并复现所述情况，确认为不安全参数引用情形，这在很多人才网站和人力资源、社保网站的查询功能中常见。按完全影响机密性进行评分，rank=7.79*1.0*1.3=10.127 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-09-13 15:21 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  描述测漏了    \n     2012-09-13 17:18 |    \t\ttiebuchen \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 新手一枚)\t\t \n  @Vty 修改了，不知道啥时能审核通过。第一次报漏洞，谢谢提醒啊，看见的就当做没看见吧    \n     2012-09-13 23:12 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  @tiebuchen 嘿嘿，测漏的好，加油，小伙儿    \n     2012-09-14 10:07 |    \t\tzhq445078388 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:19        | 请牢记\"杀进程点康姆\")\t\t \n  ...这是简要描述?....附上url都能做漏洞报告了    \n     2012-09-14 11:15 |    \t\ttiebuchen \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 新手一枚)\t\t \n  @zhq445078388 我的第一次，改了了好几次，没有人审查通过，郁闷    \n     2012-09-17 17:03 |    \t\tWdot \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:12        | it came too later)\t\t \n  @zhq445078388  相关厂商已经写得很清楚了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}