{"id": 9444, "wybug_id": "wooyun-2013-033938", "wybug_title": "V5SHOP某分站SQL注入以及程序泄露发现多处注射(大量代理商数据)", "wybug_corp": "V5shop", "wybug_author": "小痞子", "wybug_date": "2013-08-09 12:46", "wybug_open_date": "2013-09-23 12:47", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-23：\t细节向公众公开  简要描述： V5SHOP 某分站注入 以及某处敏感信息泄露 详细说明：  http://service.v5shop.com/statistics.aspx 这里未设置权限访问 泄露1150条客户信息 同时一些代理商登录账号也暴露了\n\nhttp://service.v5shop.com/system/system.rar\n\n这里源码包没有删除 可以下载源码包。包内有几处可能存在注入例如页面 AgentAccount_SelectS.aspxprotected void Page_Load(object sender, EventArgs e)        {            if (!IsPostBack)            {                agentID = Request[\"AgentName\"];                Bind();            }        }        private void Bind()        {            DataSet ds = IoCFactory.Instance.Container.Resolve<IAgentService>().GetOneAgentList(agentID);            if (ds.Tables.Count > 0 && ds.Tables[0].Rows.Count > 0)            {                agentName = ds.Tables[0].Rows[0][\"LoginName\"].ToString();            }            ds = IoCFactory.Instance.Container.Resolve<IAgentService>().GetAgentPriceListS(agentName);            if (ds != null && ds.Tables[0] != null && ds.Tables[0].Rows.Count > 0)            {                GridViewList.DataSource = ds.Tables[0].DefaultView;                GridViewList.DataBind();            }        }参数未进行任何过滤http://root.v5shop.com.cn/Admin/Managementlogin.aspx此处登录存在sql 注入构造 admin' or 1=1-- 输入任意密码即可登录\n\n进入后台也存在多处注入 权限较高可垮裤 可拿shell\n\n存在了250个库 危害较大..   漏洞证明：  求多给点rank ~ 谢谢    修复方案：     版权声明：转载请注明来源 小痞子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2013-08-09 13:00 厂商回复： 这个漏洞很给力,可是跨库什么的菜菜不是提交了吗 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-09 13:57 |    \t\t小痞子 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:21        | <xss>alert(\"a\")</xss>￥&@&……dssKhwjcw...)\t\t \n  额 看不到他提交的 貌似他是弱口令  这个是注入... 不一样的。注入危害很大..好吧估计你不是很懂    \n     2013-08-28 10:40 |    \t\t雨夜 \t\t\t( 普通白帽子  |\t\t\t        Rank:207 漏洞数:30        | 别和我谈感情，太伤钱……)\t\t \n  @V5shop 厂商应该多学习啊……    \n     2013-08-30 07:45 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @V5shop 速去确认我的漏洞啊。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}