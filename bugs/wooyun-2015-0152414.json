{"id": 72246, "wybug_id": "wooyun-2015-0152414", "wybug_title": "搜狐邮箱存储型xss一枚", "wybug_corp": "搜狐", "wybug_author": "影子哥", "wybug_date": "2015-11-06 19:53", "wybug_open_date": "2015-12-24 10:20", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向公众公开  简要描述： 搜狐网盘上传文件未对文件名进行重命名，可以在linux下面创建一个带有xss代码的文件名，上传后触发存储型xss，不过漏洞有限，只能插自己，根据分享功能分享到邮箱后，也是只能插自己。后想到qq邮箱上传附件也未对文件名重命名，将上传的带有xss代码的附件发给搜狐邮箱后，触发搜狐邮箱存储型xss。 详细说明：  首先从搜狐网盘开始，由于没有对文件名过滤和重命名，所以上传一个如下名字的文件。\n<img src=x onerror=\"alert(1)\">\n\n\n\n\n成功触发，不过只能插自己，通过分享功能分享到邮箱页面，同样弹了。\n\n但是发给他人之后，浏览却不会触发，发现搜狐对其进行了过滤。\n\n接着我们在下面的快捷回复框里面回复如下代码：\n<img src=x onerror=\"alert(1)\">\n点击收件箱刚刚回复的邮件查看详细同样触发，不过刷新整个页面后被过滤掉。\n\n\n\n以上xss都没有什么实际作用。在陷入困境的时候，想到用qq邮箱发封邮件给搜狐试试，于是在qq邮箱中上传刚刚的带有xss代码的附件。\n\n这个时候发现qq邮箱也有这个缺陷，文件名不被重新命名，网页也可以被注入代码，但是今天的主题不是qq邮箱，就先不管了。\n\n搜狐打开邮件，从源代码中发现附件的名字被注入到了网页中，现在只需要闭合双引号，用onmousemove这样的事件属性就可以触发xss。于是将附件名字改成如下：\n\" onmousemove=\"alert(2)\">.txt\n\n\n继续用qq邮箱发送，打开后鼠标移动到附件名字上触发弹框，如上图。\n\n可以看到代码被注入网页弹一下cookie\n\n   漏洞证明：  如上面   修复方案：  过滤   版权声明：转载请注明来源 影子哥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-11-09 10:19 厂商回复： 感谢支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-11-06 19:58 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1218 漏洞数:322        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  这个简述！ 66666    \n     2015-11-06 20:50 |    \t\t撸管 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:6        | QQ94170844 不再玩wooyun)\t\t \n  这个简述！ 66666    \n     2015-11-06 21:26 |    \t\tago \t\t\t( 普通白帽子  |\t\t\t        Rank:521 漏洞数:84        )\t\t \n  这个简述！ 66666     \n     2015-11-06 21:42 |    \t\tSecurity \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:12        )\t\t \n  这个简述！66666    \n     2015-11-06 22:24 |    \t\t慢慢 \t\t\t( 普通白帽子  |\t\t\t        Rank:773 漏洞数:201        | 低调求发展)\t\t \n  这个简述！66666    \n     2015-11-06 22:25 |    \t\tNelion \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:30        | 老实，腼腆，潜力股；不谈情，不说爱，只泡...)\t\t \n  这个简述！66666    \n     2015-11-06 23:01 |    \t\t狂人 \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:13        | Rank:999999999 漏洞数:999999999 | 小学生...)\t\t \n  这个描述是漏洞详情吧.....    \n     2015-11-06 23:02 |    \t\tDaryl \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:5        | '\"><img/src=1 onerror=alert('干啥啥不会'...)\t\t \n  这个简述！66666    \n     2015-11-08 10:55 |    \t\t路人毛 \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:18        | 呵呵)\t\t \n  这个简述！ 66666    \n     2015-11-09 13:07 |    \t\tVirink \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 呵呵)\t\t \n  这个简述！ 66666     \n     2015-11-09 13:08 |    \t\tVirink \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 呵呵)\t\t \n  这个简述！ 66666     \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}