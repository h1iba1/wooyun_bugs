{"id": 54987, "wybug_id": "wooyun-2014-062507", "wybug_title": "某教学平台通用SQL注入漏洞第二弹(不需要登录)", "wybug_corp": "某教学平台", "wybug_author": "路人甲", "wybug_date": "2014-05-27 14:30", "wybug_open_date": "2014-08-25 14:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-25：\t细节向公众公开  简要描述： RT 详细说明：  web程序名称：信息技术教学辅助平台3.0关键词：intitle:信息技术教学辅助平台3.0用户很多：\n\n漏洞成因： 对参数未做任何过滤，导致注入产生是否需要登录：否漏洞存在文件：/student/SaveHandler.ashx\npublic class SaveHandler : IHttpHandler {    public void ProcessRequest(HttpContext context)    {        context.Response.ContentType = \"text/plain\";        string mysnum = context.Request.QueryString[\"Mysnum\"].ToString();//获取参数        string myspd = context.Request.QueryString[\"Myspd\"].ToString();        string rstr = \"0\";        bool isok = saveSpeed(mysnum, myspd); //跟入方法saveSpeed        if (isok)        {            rstr = \"1\";        }        context.Response.Write(rstr);    }     public bool IsReusable {        get {            return false;        }    }    private bool saveSpeed(string Pnum, string Pspd)    {        Pfinger pbll = new Pfinger();        return pbll.saveSpd(Pnum, Pspd);//跟入方法saveSpd    }}public class Pfinger{    private readonly Pfinger_dal dal = new Pfinger_dal();    public bool saveSpd(string psnum, string myspd)    {        return this.dal.saveSpd(psnum, myspd);//跟入方法dal.saveSpd    }}public class Pfinger_dal{        public bool saveSpd(string psnum, string myspd)    {        bool flag = false;        if ((psnum.Trim() != \"\") && (myspd.Trim() != \"\"))        {            DateTime now = DateTime.Now;            int year = now.Year;            int month = now.Month;            decimal pspd = decimal.Parse(myspd);            string s = this.ExistsPsnum(psnum); //跟入方法ExistsPsnum            if (s != \"\")            {                return this.UpdatePspd(int.Parse(s), pspd, now);            }            Pfinger_model model = new Pfinger_model();                            model.Psnum = psnum;                model.Pspd = new decimal?(pspd);                model.Pyear = new int?(year);                model.Pmonth = new int?(month);                model.Pdate = new DateTime?(now);                model.Pdegree = 0;                        //model.Pgrade = new LearnSite.BLL.Students().GetSgrade(psnum);            //model.Pterm = int.Parse(XmlHelp.GetTerm());            if (this.Add(model) > 0)            {                flag = true;            }        }        return flag;    }    public string ExistsPsnum(string Psnum) //最终到这，拼接SQL语句，参数未处理    {        return DbHelperSQL.FindString(\"select top 1 Pid from Pfinger where Psnum='\" + Psnum + \"'\", new SqlParameter[0]);    }}\n实例演示：http://wsyj.dg6z.net:81/student/SaveHandler.ashx?Mysnum=1&Myspd=2\n\nhttp://www.fzwgyxx.cn:83/student/SaveHandler.ashx?Mysnum=1&Myspd=2\n\nhttp://61.175.224.187:888/student/SaveHandler.ashx?Mysnum=1&Myspd=2\n\nhttp://www.fhbdxx.cn:8080/student/SaveHandler.ashx?Mysnum=1&Myspd=2\n\nhttp://jsxx.dyedu.cn/student/SaveHandler.ashx?Mysnum=1&Myspd=2\n\nhttp://www.zhbz.net:808/student/SaveHandler.ashx?Mysnum=1&Myspd=2\n\nhttp://it.wzsxfx.com/student/SaveHandler.ashx?Mysnum=1&Myspd=2\n\n   漏洞证明：  见详细   修复方案：  过滤。。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-05-30 22:18 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}