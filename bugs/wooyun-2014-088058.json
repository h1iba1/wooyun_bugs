{"id": 47107, "wybug_id": "wooyun-2014-088058", "wybug_title": "万达某系统任意用户密码修改+注入", "wybug_corp": "大连万达集团股份有限公司", "wybug_author": "s3xy", "wybug_date": "2014-12-22 01:02", "wybug_open_date": "2015-02-05 01:04", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "敏感接口未加权限认证"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向公众公开  简要描述： 万达某系统任意用户密码修改+注入 详细说明：  系统地址https://tender.wanda.cn/COST找回密码https://tender.wanda.cn/COST/contractweb/forgetpd.aspx验证码获取后随便写，保存时抓包。\n\n返回的数据包\n\n可见提示错误了。我们把整条数据替换为{\"d\":\"{\\u0027isSuccess\\u0027:\\u0027Y\\u0027,\\u0027type\\u0027:\\u0027normal\\u0027}\"}\n\n成功修改admin密码为admin123\n\n   漏洞证明：  基本遍地都是注入https://tender.wanda.cn//COST/ContractWeb/ContractDetail.aspx?a=67f9190dc313549daa98b4a81890e86410ddd12d&cid=106%20and%201=1 正常https://tender.wanda.cn//COST/ContractWeb/ContractDetail.aspx?a=67f9190dc313549daa98b4a81890e86410ddd12d&cid=106%20and%201=2 错误目测与http://wooyun.org/bugs/wooyun-2014-085446注入相仿，不再证明。   修复方案：  增强验证过滤注入   版权声明：转载请注明来源 s3xy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-12-22 10:18 厂商回复： 感谢s3xy同学的关注与贡献！此漏洞确认存在，马上通知业务整改！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-22 10:24 |    \t\t大连万达集团(乌云厂商)\t\t \n  请私信留个Q，确认礼物事宜。    \n     2015-02-05 06:51 |    \t\t \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | )\t\t \n  奇怪，按理说不应该会被改的，改返回是自慰，密码真给改了，会不会密码本来就是admin123    \n     2015-02-05 08:39 |    \t\tMark \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 渗透你的心)\t\t \n  改返回是什么个原理？    \n     2015-02-05 10:22 |    \t\tM4ster \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:7        | www.m4ster@gmail.com)\t\t \n  不科学-_-\"    \n     2015-02-05 10:39 |    \t\t大物期末不能挂 \t\t\t( 普通白帽子  |\t\t\t        Rank:132 漏洞数:23        | 1.一个学渣，只求每门都不挂2.想把漏洞提...)\t\t \n  不科学+1    \n     2015-02-05 14:24 |    \t\t福建网龙(乌云厂商)\t\t \n  不科学+1    \n     2015-02-05 17:07 |    \t\ts3xy \t\t\t( 核心白帽子 |\t\t\t        Rank:832 漏洞数:113        | 相濡以沫，不如相忘于江湖)\t\t \n  @福建网龙 @大物期末不能挂 @M4ster @Mark @ 其实是这样的道理。改了返回后，本地会当成验证成功，然后发出下一步数据包。而这种方法能成功，实际上是因为下一步的接口没做验证。    \n     2015-02-05 17:50 |    \t\t大物期末不能挂 \t\t\t( 普通白帽子  |\t\t\t        Rank:132 漏洞数:23        | 1.一个学渣，只求每门都不挂2.想把漏洞提...)\t\t \n  @s3xy 多谢大牛赐教    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}