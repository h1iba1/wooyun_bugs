{"id": 32325, "wybug_id": "wooyun-2015-0109129", "wybug_title": "国家互联网应急中心某外部探测系统配置不当可命令执行", "wybug_corp": "国家互联网应急中心", "wybug_author": "fuckadmin", "wybug_date": "2015-04-20 08:30", "wybug_open_date": "2015-06-08 09:18", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["默认配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-08：\t细节向公众公开  简要描述： 不小心发现的，深入看了下，还挺严重了。 详细说明：  一、基本信息系统名：基于云计算的网络安全风险探知系统IP：111.205.121.12(还有IPV6地址哦)\ntcp        0      0 111.205.121.12:49170        193.0.202.245:443           ESTABLISHED tcp        0      0 111.205.121.12:34465        193.0.202.24:443            ESTABLISHED tcp        0      0 111.205.121.12:54542        193.0.202.24:443            ESTABLISHED tcp        0      0 111.205.121.12:59601        193.0.202.24:443            ESTABLISHED tcp        0      0 111.205.121.12:48729        193.0.202.24:443            ESTABLISHED tcp        0      0 ::ffff:111.205.121.12:80    ::ffff:219.128.219.1:2069   ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:53306      ::ffff:127.0.0.1:42664      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:42718      ::ffff:127.0.0.1:15006      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:53306      ::ffff:127.0.0.1:42612      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:53306      ::ffff:127.0.0.1:42665      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:38577      ::ffff:127.0.0.1:15005      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:53306      ::ffff:127.0.0.1:42636      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:15006      ::ffff:127.0.0.1:42718      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:42612      ::ffff:127.0.0.1:53306      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:42637      ::ffff:127.0.0.1:53306      ESTABLISHED tcp        0      0 2001:da8:a0:102::f125:55379 2001:da8:a0:102::f002:30000 ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:42665      ::ffff:127.0.0.1:53306      ESTABLISHED tcp        0      0 2001:da8:a0:102::f125:60806 2001:da8:a0:102::f128:61616 ESTABLISHED tcp        0      0 2001:da8:a0:102::f125:58106 2001:da8:a0:102::f128:61616 ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:15005      ::ffff:127.0.0.1:38577      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:42636      ::ffff:127.0.0.1:53306      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:53306      ::ffff:127.0.0.1:42637      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:42664      ::ffff:127.0.0.1:53306      ESTABLISHED tcp        0      0 2001:da8:a0:102::f125:60807 2001:da8:a0:102::f128:61616 ESTABLISHED\n开发商：天融信（稍后给出分析）二、存在的问题根据深入分析后，该系统应该是天融信为cncert独立开发（网上找不到该系统说明）。由于该系统采用了Jboss做为通信中间件，同时invoker/JMXInvokerServlet又对外开放，也未进行访问限制。\n\n\n\n三、getshell深入\n\n部署人员的参考手册\n\n证实了我的想法天融信的模板文件\n<?xml version=\"1.0\" encoding=\"utf-8\"?><configs xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://www.topsec.com.cn\"xsi:schemaLocation=\"http://www.topsec.com.cn config.xsd\">\t<global>\t\t<injects>\t\t\t<!-- inject key=\"sysmailserver\" springbean=\"testinject\"/ -->\t\t\t<inject key=\"sysmailserver\" class=\"com.topsec.tsm.tal.response.respimp.mail.MailCfgCatcher\"/>\t\t\t<inject key=\"sysbackuppath\" class=\"com.topsec.tsm.tal.response.respimp.archive.BackupCfgCatcher\"/>\t\t</injects>\t\t<blocks>\t\t     <block key=\"connectport\" name=\"璇烽??╅?璁???? desc=\"杩???扮‖浠剁???>\t\t\t\t<item key=\"smscomport\" value=\"COM3\" name=\"杩???朵娇??N)\" itemtype=\"SelectItem\" showArgs=\"COM1=:COM1;;COM2=:COM2;;COM3=:COM3;;COM4=:COM4\"/>\t\t\t\t<item key=\"smsbaudrate\" value=\"9600\" name=\"姣??浣??(B)\" itemtype=\"SelectItem\" showArgs=\"9600=:9600;;57600=:57600;;115200=:115200\"/>\t\t\t</block>\t\t\t<block key=\"msgnotify\" name=\"???娑??\" desc=\"???娑??\">\t\t\t\t<item key=\"title\" value=\"\" name=\"???\" valuetype=\"string\" itemtype=\"InputItem\" notnull=\"true\" size=\"100\"/>\t\t\t\t<item key=\"content\" value=\"\" name=\"???\" valuetype=\"special_str\" itemtype=\"EditItem\" notnull=\"true\" size=\"100\"/>\t\t\t</block>\t\t\t<block key=\"mailserver\" name=\"??欢????? type=\"hide\" inject_class=\"sysmailserver\"/>\t\t\t<block key=\"backuppath\" name=\"澶?唤璺??\" type=\"hide\" inject_class=\"sysbackuppath\"/>\t\t</blocks>\t</global>\t\t<!-- 绯荤???疆锛??浠舵??″? -->\t<config key=\"sys_cfg_mailserver\" name=\"??欢????? desc=\"??欢???浠ュ?璁″??ヨ〃涓???????欢??娇?ㄧ???欢????ㄤ俊?? type=\"action.type.system\" subType=\"system\">\t\t<defaultblock>\t\t\t<item key=\"serverip\" value=\"\" name=\"??欢?????P\" valuetype=\"ip\" itemtype=\"InputItem\"/>\t\t\t<item key=\"serverport\" value=\"\" name=\"??欢????ㄧ??? valuetype=\"num\" itemtype=\"InputItem\" size=\"65535\"/>\t\t\t<item key=\"mailsender\" value=\"\" name=\"??欢???浜? valuetype=\"mail\" itemtype=\"InputItem\" size=\"100\"/>\t\t\t<item key=\"loginaccount\" value=\"\" name=\"?ㄦ??? itemtype=\"InputItem\" size=\"100\"/>\t\t\t<item key=\"loginpwd\" value=\"\" name=\"?ｄ护\" itemtype=\"PasswordItem\" size=\"100\"/>\t\t</defaultblock>\t</config>\t</configs>\n四、某些重要的配置文件1.Mysql数据库配置文件\n<?xml version=\"1.0\" encoding=\"UTF-8\"?><datasources>  <local-tx-datasource>    <jndi-name>SIM_DS</jndi-name>    <connection-url><![CDATA[jdbc:mysql://127.0.0.1:53306/sim?useUnicode=true&characterEncoding=utf8]]></connection-url>    <driver-class>com.mysql.jdbc.Driver</driver-class>    <user-name>root</user-name>    <password>talent123</password>    <min-pool-size>5</min-pool-size>    <max-pool-size>50</max-pool-size>  </local-tx-datasource></datasources>\n2.节点配置文件\ntopsec.tsm.node.id=Linux-Servicetopsec.tsm.node.name=servicetopsec.tsm.node.type=Servicetopsec.tsm.node.autonomy=falsetopsec.tsm.node.ip=[2001:da8:a0:102::f125]topsec.tsm.node.commandTimeout=5000topsec.tsm.node.superip=[2001:da8:1:fffe::f128]topsec.tsm.node.superport=61616topsec.tsm.node.localip=[2001:da8:1:fffe::f128]topsec.tsm.node.basepath=../conf/nodetopsec.tsm.node.local.jms.type=ACTIVEMQ_CONNECTORtopsec.tsm.node.local.jms.url=failover:(tcp://%s:61616?wireFormat.maxInactivityDuration=300000)topsec.tsm.node.local.jms.ip=[2001:da8:1:fffe::f128]topsec.tsm.node.local.jms.keystore.file=./node/myclient.kstopsec.tsm.node.local.jms.keystore.pass=passwordtopsec.tsm.node.local.jms.truststore.file=./node/myclient.tstopsec.tsm.node.local.jms.truststore.pass=passwordtopsec.tsm.node.superior.jms.type=ACTIVEMQ_CONNECTORtopsec.tsm.node.superior.jms.url=failover:(tcp://%s:61616?wireFormat.maxInactivityDuration=300000)topsec.tsm.node.superior.jms.ip=[2001:da8:1:fffe::f128]topsec.tsm.node.superior.jms.keystore.file=./node/myclient.kstopsec.tsm.node.superior.jms.keystore.pass=passwordtopsec.tsm.node.superior.jms.truststore.file=./node/myclient.tstopsec.tsm.node.superior.jms.truststore.pass=password\nmessageconfiguration.xml\n<?xml version=\"1.0\" encoding=\"utf-8\" ?> <messageconfiguration>  <placeholderlocations>\t  <placeholderlocation location=\"../conf/node/node.properties\"/>  </placeholderlocations>  <sessions>  \t<session name=\"Local\">\t   \t\t<destination type=\"TOPIC\" name=\"LOCAL_COMMAND\" realname=\"com.topsec.tsm.topic.smpcommand\" isrecv=\"true\" selector=\"MDNd='.' OR MDNd='SMP'\"/>  \t\t<destination type=\"TOPIC\" name=\"LOCAL_KEEPALIVE\" realname=\"com.topsec.tsm.topic.smpkeepalive\" isrecv=\"true\" selector=\"MDNd='.' OR MDNd='SMP'\"/>  \t\t<destination type=\"TOPIC\" name=\"LOCAL_RAWEVENT\" realname=\"com.topsec.tsm.topic.smpsecurityevent\" isrecv=\"true\" />  \t\t<destination type=\"TOPIC\" name=\"LOCAL_COMPRESSRAWEVENT\" realname=\"com.topsec.tsm.topic.smpcompresssecurityevent\" isrecv=\"true\"/>  \t\t<destination type=\"TOPIC\" name=\"LOCAL_AUDIT\" realname=\"com.topsec.tsm.topic.audit\" isrecv=\"false\" selector=\"MDNd='.' OR MDNd='SMP'\"/>  \t\t<destination type=\"TOPIC\" name=\"LOCAL_LOG\" realname=\"com.topsec.tsm.topic.smplog\" isrecv=\"true\" selector=\"MDNd='.' OR MDNd='SMP'\"/>  \t\t<destination type=\"TOPIC\" name=\"LOCAL_ALARM\" realname=\"com.topsec.tsm.topic.smpalarm\" isrecv=\"true\" selector=\"MDNd='.' OR MDNd='SMP'\" />  \t\t<destination type=\"TOPIC\" name=\"LOCAL_MONITOR\" realname=\"com.topsec.tsm.topic.smpmonitor\" isrecv=\"true\" selector=\"MDNd='.' OR MDNd='SMP'\" />  \t\t<destination type=\"TOPIC\" name=\"LOCAL_DEVMONITOR\" realname=\"com.topsec.tsm.topic.smpdevmonitor\" isrecv=\"true\" selector=\"MDNd='.' OR MDNd='SMP'\" />  \t\t<destination type=\"TOPIC\" name=\"LOCAL_LICENSE\" realname=\"com.topsec.tsm.topic.smplicense\" isrecv=\"true\"/>  \t\t<!--destination type=\"TOPIC\" name=\"LU_LOCAL_KEEPALIVE\" realname=\"com.topsec.tsm.topic.smplukeepalive\" isrecv=\"true\" selector=\"MDNd='.' OR MDNd='SMP'\"/-->  \t</session>  </sessions>  <connectors>  \t<connector type=\"ACTIVEMQ_CONNECTOR\" name=\"Local\" ip=\"localhost\" urlpattern=\"tcp://${topsec.tsm.node.local.jms.ip}:61616?wireFormat.maxInactivityDuration=300000\" testtimes=\"3\" testinterval=\"5\"  user=\"admin\" pass=\"secretjms\">  \t\t<session name=\"Local\"/>  \t</connector>  \t<!--  \t<connector type=\"ACTIVEMQ_CONNECTOR\" name=\"Local\" ip=\"localhost\" urlpattern=\"vm://localhost\" testtimes=\"3\" testinterval=\"5\"  user=\"admin\" pass=\"secretjms\">  \t\t<session name=\"Local\"/>  \t</connector>  \t<connector type=\"ACTIVEMQ_SSL_CONNECTOR\" name=\"AQ_72.112\" ip=\"192.168.72.229\" urlpattern=\"ssl://%s:61617\" testtimes=\"3\" testinterval=\"5\">  \t\t<context>  \t\t\tkeystore.file=../server/default/conf/myclient.ks  \t\t\tkeystore.password=password  \t\t\ttruststore.file=../server/default/conf/myclient.ts  \t\t\ttruststore.password=password  \t\t</context>  \t\t<session name=\"AQ_72.112\"/>  \t</connector>\t\t-->  </connectors>  <channelgroup>  \t<cluster type=\"SEQUENCE_EQUALIZER_BACKUP\">  \t\t<connector name=\"Local\"/>  \t</cluster>  \t<channel name=\"LOCAL_COMMAND\" messagetype=\"OBJECT_MESSAGE\"/>  \t<channel name=\"LOCAL_KEEPALIVE\" messagetype=\"OBJECT_MESSAGE\"/>  \t<channel name=\"LOCAL_RAWEVENT\" messagetype=\"OBJECT_MESSAGE\"/>  \t<channel name=\"LOCAL_MONITOR\" messagetype=\"OBJECT_MESSAGE\"/>  \t<channel name=\"LOCAL_COMPRESSRAWEVENT\" messagetype=\"OBJECT_MESSAGE\"/>  \t<channel name=\"LOCAL_AUDIT\" messagetype=\"OBJECT_MESSAGE\"/>  \t<channel name=\"LOCAL_ALARM\" messagetype=\"OBJECT_MESSAGE\"/>  \t<!--channel name=\"LU_LOCAL_COMMAND\" messagetype=\"OBJECT_MESSAGE\"/>  \t<channel name=\"LU_LOCAL_KEEPALIVE\" messagetype=\"OBJECT_MESSAGE\"/-->  </channelgroup></messageconfiguration>\n还有好多配置文件呢，夜深了，不挖了。   漏洞证明：  一、基本信息系统名：基于云计算的网络安全风险探知系统IP：111.205.121.12(还有IPV6地址哦)\ntcp        0      0 111.205.121.12:49170        193.0.202.245:443           ESTABLISHED tcp        0      0 111.205.121.12:34465        193.0.202.24:443            ESTABLISHED tcp        0      0 111.205.121.12:54542        193.0.202.24:443            ESTABLISHED tcp        0      0 111.205.121.12:59601        193.0.202.24:443            ESTABLISHED tcp        0      0 111.205.121.12:48729        193.0.202.24:443            ESTABLISHED tcp        0      0 ::ffff:111.205.121.12:80    ::ffff:219.128.219.1:2069   ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:53306      ::ffff:127.0.0.1:42664      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:42718      ::ffff:127.0.0.1:15006      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:53306      ::ffff:127.0.0.1:42612      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:53306      ::ffff:127.0.0.1:42665      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:38577      ::ffff:127.0.0.1:15005      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:53306      ::ffff:127.0.0.1:42636      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:15006      ::ffff:127.0.0.1:42718      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:42612      ::ffff:127.0.0.1:53306      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:42637      ::ffff:127.0.0.1:53306      ESTABLISHED tcp        0      0 2001:da8:a0:102::f125:55379 2001:da8:a0:102::f002:30000 ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:42665      ::ffff:127.0.0.1:53306      ESTABLISHED tcp        0      0 2001:da8:a0:102::f125:60806 2001:da8:a0:102::f128:61616 ESTABLISHED tcp        0      0 2001:da8:a0:102::f125:58106 2001:da8:a0:102::f128:61616 ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:15005      ::ffff:127.0.0.1:38577      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:42636      ::ffff:127.0.0.1:53306      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:53306      ::ffff:127.0.0.1:42637      ESTABLISHED tcp        0      0 ::ffff:127.0.0.1:42664      ::ffff:127.0.0.1:53306      ESTABLISHED tcp        0      0 2001:da8:a0:102::f125:60807 2001:da8:a0:102::f128:61616 ESTABLISHED\n开发商：天融信（稍后给出分析）二、存在的问题根据深入分析后，该系统应该是天融信为cncert独立开发（网上找不到该系统说明）。由于该系统采用了Jboss做为通信中间件，同时invoker/JMXInvokerServlet又对外开放，也未进行访问限制。\n\n\n\n三、getshell深入\n\n部署人员的参考手册\n\n证实了我的想法天融信的模板文件\n<?xml version=\"1.0\" encoding=\"utf-8\"?><configs xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns=\"http://www.topsec.com.cn\"xsi:schemaLocation=\"http://www.topsec.com.cn config.xsd\">\t<global>\t\t<injects>\t\t\t<!-- inject key=\"sysmailserver\" springbean=\"testinject\"/ -->\t\t\t<inject key=\"sysmailserver\" class=\"com.topsec.tsm.tal.response.respimp.mail.MailCfgCatcher\"/>\t\t\t<inject key=\"sysbackuppath\" class=\"com.topsec.tsm.tal.response.respimp.archive.BackupCfgCatcher\"/>\t\t</injects>\t\t<blocks>\t\t     <block key=\"connectport\" name=\"璇烽??╅?璁???? desc=\"杩???扮‖浠剁???>\t\t\t\t<item key=\"smscomport\" value=\"COM3\" name=\"杩???朵娇??N)\" itemtype=\"SelectItem\" showArgs=\"COM1=:COM1;;COM2=:COM2;;COM3=:COM3;;COM4=:COM4\"/>\t\t\t\t<item key=\"smsbaudrate\" value=\"9600\" name=\"姣??浣??(B)\" itemtype=\"SelectItem\" showArgs=\"9600=:9600;;57600=:57600;;115200=:115200\"/>\t\t\t</block>\t\t\t<block key=\"msgnotify\" name=\"???娑??\" desc=\"???娑??\">\t\t\t\t<item key=\"title\" value=\"\" name=\"???\" valuetype=\"string\" itemtype=\"InputItem\" notnull=\"true\" size=\"100\"/>\t\t\t\t<item key=\"content\" value=\"\" name=\"???\" valuetype=\"special_str\" itemtype=\"EditItem\" notnull=\"true\" size=\"100\"/>\t\t\t</block>\t\t\t<block key=\"mailserver\" name=\"??欢????? type=\"hide\" inject_class=\"sysmailserver\"/>\t\t\t<block key=\"backuppath\" name=\"澶?唤璺??\" type=\"hide\" inject_class=\"sysbackuppath\"/>\t\t</blocks>\t</global>\t\t<!-- 绯荤???疆锛??浠舵??″? -->\t<config key=\"sys_cfg_mailserver\" name=\"??欢????? desc=\"??欢???浠ュ?璁″??ヨ〃涓???????欢??娇?ㄧ???欢????ㄤ俊?? type=\"action.type.system\" subType=\"system\">\t\t<defaultblock>\t\t\t<item key=\"serverip\" value=\"\" name=\"??欢?????P\" valuetype=\"ip\" itemtype=\"InputItem\"/>\t\t\t<item key=\"serverport\" value=\"\" name=\"??欢????ㄧ??? valuetype=\"num\" itemtype=\"InputItem\" size=\"65535\"/>\t\t\t<item key=\"mailsender\" value=\"\" name=\"??欢???浜? valuetype=\"mail\" itemtype=\"InputItem\" size=\"100\"/>\t\t\t<item key=\"loginaccount\" value=\"\" name=\"?ㄦ??? itemtype=\"InputItem\" size=\"100\"/>\t\t\t<item key=\"loginpwd\" value=\"\" name=\"?ｄ护\" itemtype=\"PasswordItem\" size=\"100\"/>\t\t</defaultblock>\t</config>\t</configs>\n四、某些重要的配置文件1.Mysql数据库配置文件\n<?xml version=\"1.0\" encoding=\"UTF-8\"?><datasources>  <local-tx-datasource>    <jndi-name>SIM_DS</jndi-name>    <connection-url><![CDATA[jdbc:mysql://127.0.0.1:53306/sim?useUnicode=true&characterEncoding=utf8]]></connection-url>    <driver-class>com.mysql.jdbc.Driver</driver-class>    <user-name>root</user-name>    <password>talent123</password>    <min-pool-size>5</min-pool-size>    <max-pool-size>50</max-pool-size>  </local-tx-datasource></datasources>\n2.节点配置文件\ntopsec.tsm.node.id=Linux-Servicetopsec.tsm.node.name=servicetopsec.tsm.node.type=Servicetopsec.tsm.node.autonomy=falsetopsec.tsm.node.ip=[2001:da8:a0:102::f125]topsec.tsm.node.commandTimeout=5000topsec.tsm.node.superip=[2001:da8:1:fffe::f128]topsec.tsm.node.superport=61616topsec.tsm.node.localip=[2001:da8:1:fffe::f128]topsec.tsm.node.basepath=../conf/nodetopsec.tsm.node.local.jms.type=ACTIVEMQ_CONNECTORtopsec.tsm.node.local.jms.url=failover:(tcp://%s:61616?wireFormat.maxInactivityDuration=300000)topsec.tsm.node.local.jms.ip=[2001:da8:1:fffe::f128]topsec.tsm.node.local.jms.keystore.file=./node/myclient.kstopsec.tsm.node.local.jms.keystore.pass=passwordtopsec.tsm.node.local.jms.truststore.file=./node/myclient.tstopsec.tsm.node.local.jms.truststore.pass=passwordtopsec.tsm.node.superior.jms.type=ACTIVEMQ_CONNECTORtopsec.tsm.node.superior.jms.url=failover:(tcp://%s:61616?wireFormat.maxInactivityDuration=300000)topsec.tsm.node.superior.jms.ip=[2001:da8:1:fffe::f128]topsec.tsm.node.superior.jms.keystore.file=./node/myclient.kstopsec.tsm.node.superior.jms.keystore.pass=passwordtopsec.tsm.node.superior.jms.truststore.file=./node/myclient.tstopsec.tsm.node.superior.jms.truststore.pass=password\nmessageconfiguration.xml\n<?xml version=\"1.0\" encoding=\"utf-8\" ?> <messageconfiguration>  <placeholderlocations>\t  <placeholderlocation location=\"../conf/node/node.properties\"/>  </placeholderlocations>  <sessions>  \t<session name=\"Local\">\t   \t\t<destination type=\"TOPIC\" name=\"LOCAL_COMMAND\" realname=\"com.topsec.tsm.topic.smpcommand\" isrecv=\"true\" selector=\"MDNd='.' OR MDNd='SMP'\"/>  \t\t<destination type=\"TOPIC\" name=\"LOCAL_KEEPALIVE\" realname=\"com.topsec.tsm.topic.smpkeepalive\" isrecv=\"true\" selector=\"MDNd='.' OR MDNd='SMP'\"/>  \t\t<destination type=\"TOPIC\" name=\"LOCAL_RAWEVENT\" realname=\"com.topsec.tsm.topic.smpsecurityevent\" isrecv=\"true\" />  \t\t<destination type=\"TOPIC\" name=\"LOCAL_COMPRESSRAWEVENT\" realname=\"com.topsec.tsm.topic.smpcompresssecurityevent\" isrecv=\"true\"/>  \t\t<destination type=\"TOPIC\" name=\"LOCAL_AUDIT\" realname=\"com.topsec.tsm.topic.audit\" isrecv=\"false\" selector=\"MDNd='.' OR MDNd='SMP'\"/>  \t\t<destination type=\"TOPIC\" name=\"LOCAL_LOG\" realname=\"com.topsec.tsm.topic.smplog\" isrecv=\"true\" selector=\"MDNd='.' OR MDNd='SMP'\"/>  \t\t<destination type=\"TOPIC\" name=\"LOCAL_ALARM\" realname=\"com.topsec.tsm.topic.smpalarm\" isrecv=\"true\" selector=\"MDNd='.' OR MDNd='SMP'\" />  \t\t<destination type=\"TOPIC\" name=\"LOCAL_MONITOR\" realname=\"com.topsec.tsm.topic.smpmonitor\" isrecv=\"true\" selector=\"MDNd='.' OR MDNd='SMP'\" />  \t\t<destination type=\"TOPIC\" name=\"LOCAL_DEVMONITOR\" realname=\"com.topsec.tsm.topic.smpdevmonitor\" isrecv=\"true\" selector=\"MDNd='.' OR MDNd='SMP'\" />  \t\t<destination type=\"TOPIC\" name=\"LOCAL_LICENSE\" realname=\"com.topsec.tsm.topic.smplicense\" isrecv=\"true\"/>  \t\t<!--destination type=\"TOPIC\" name=\"LU_LOCAL_KEEPALIVE\" realname=\"com.topsec.tsm.topic.smplukeepalive\" isrecv=\"true\" selector=\"MDNd='.' OR MDNd='SMP'\"/-->  \t</session>  </sessions>  <connectors>  \t<connector type=\"ACTIVEMQ_CONNECTOR\" name=\"Local\" ip=\"localhost\" urlpattern=\"tcp://${topsec.tsm.node.local.jms.ip}:61616?wireFormat.maxInactivityDuration=300000\" testtimes=\"3\" testinterval=\"5\"  user=\"admin\" pass=\"secretjms\">  \t\t<session name=\"Local\"/>  \t</connector>  \t<!--  \t<connector type=\"ACTIVEMQ_CONNECTOR\" name=\"Local\" ip=\"localhost\" urlpattern=\"vm://localhost\" testtimes=\"3\" testinterval=\"5\"  user=\"admin\" pass=\"secretjms\">  \t\t<session name=\"Local\"/>  \t</connector>  \t<connector type=\"ACTIVEMQ_SSL_CONNECTOR\" name=\"AQ_72.112\" ip=\"192.168.72.229\" urlpattern=\"ssl://%s:61617\" testtimes=\"3\" testinterval=\"5\">  \t\t<context>  \t\t\tkeystore.file=../server/default/conf/myclient.ks  \t\t\tkeystore.password=password  \t\t\ttruststore.file=../server/default/conf/myclient.ts  \t\t\ttruststore.password=password  \t\t</context>  \t\t<session name=\"AQ_72.112\"/>  \t</connector>\t\t-->  </connectors>  <channelgroup>  \t<cluster type=\"SEQUENCE_EQUALIZER_BACKUP\">  \t\t<connector name=\"Local\"/>  \t</cluster>  \t<channel name=\"LOCAL_COMMAND\" messagetype=\"OBJECT_MESSAGE\"/>  \t<channel name=\"LOCAL_KEEPALIVE\" messagetype=\"OBJECT_MESSAGE\"/>  \t<channel name=\"LOCAL_RAWEVENT\" messagetype=\"OBJECT_MESSAGE\"/>  \t<channel name=\"LOCAL_MONITOR\" messagetype=\"OBJECT_MESSAGE\"/>  \t<channel name=\"LOCAL_COMPRESSRAWEVENT\" messagetype=\"OBJECT_MESSAGE\"/>  \t<channel name=\"LOCAL_AUDIT\" messagetype=\"OBJECT_MESSAGE\"/>  \t<channel name=\"LOCAL_ALARM\" messagetype=\"OBJECT_MESSAGE\"/>  \t<!--channel name=\"LU_LOCAL_COMMAND\" messagetype=\"OBJECT_MESSAGE\"/>  \t<channel name=\"LU_LOCAL_KEEPALIVE\" messagetype=\"OBJECT_MESSAGE\"/-->  </channelgroup></messageconfiguration>\n还有好多配置文件呢，夜深了，不挖了。   修复方案：  1.删除接口2.限制访问   版权声明：转载请注明来源 fuckadmin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-04-24 09:17 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT协调内部部门处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-20 08:34 |    \t\t孤独行者 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:44        | 时光如水，总是无言。你若安好，便是晴天)\t\t \n  前排。。沙发    \n     2015-04-20 08:47 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  命令执行....这~    \n     2015-04-20 09:18 |    \t\t圣路西法 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 围观大神ส็็็็็็ ̷̸̨̀͒̏̃ͦ...)\t\t \n  围观    \n     2015-04-20 09:55 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  这个ip段值得扫一下    \n     2015-04-20 10:33 |    \t\tJotPot \t\t\t( 实习白帽子  |\t\t\t        Rank:61 漏洞数:10        | 小菜)\t\t \n  大哥被搞了    \n     2015-04-24 11:35 |    \t\tf4ck \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:7        | 有些人很牛B，一个漏洞能刷成N个。)\t\t \n  叼    \n     2015-06-01 15:08 |    \t\t大漠長河 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:7        | ̷̸̨̀͒̏̃ͦ̈́̾( 天龙源景区欢迎您...)\t\t \n  显然我来晚了。。。。。吊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}