{"id": 11447, "wybug_id": "wooyun-2013-022023", "wybug_title": "易想购物（easethink）存在sql注入漏洞，附利用测试POC", "wybug_corp": "易想购物", "wybug_author": "lxsec", "wybug_date": "2013-04-17 15:06", "wybug_open_date": "2013-07-16 15:06", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "字符类型注射", "源码分析", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-17：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-07-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 易想购物cms存在注入漏洞，剩下的自己YY了。 详细说明：  根目录下message.php页面存在关键字过滤不严谨的问题。出问题的代码如下\nif($_REQUEST['act'] == 'add')   //request获取的act变量只有这个if后面就没有判读过了，导致了注入{\tif(!$user_info)\t{\t\tshowErr($GLOBALS['lang']['PLEASE_LOGIN_FIRST']);\t}....else{\t$rel_table = $_REQUEST['act'];\t//echo \"select * from \".DB_PREFIX.\"message_type where type_name='\".$rel_table.\"'\"; //这句是自己添加的演示语句，一会可以查看到被注入的语句\t$message_type = $GLOBALS['db']->getRowCached(\"select * from \".DB_PREFIX.\"message_type where type_name='\".$rel_table.\"'\");\t\tif(!$message_type||$message_type['is_fix']==0)\t{\t\t$message_type_list = $GLOBALS['db']->getAllCached(\"select * from \".DB_PREFIX.\"message_type where is_fix = 0 order by sort desc\");\t\tif(!$message_type_list)\t\t{\t\t\tshowErr($GLOBALS['lang']['INVALID_MESSAGE_TYPE']);\t\t}\t\telse\t\t{\t\t\tif(!$message_type)\t\t\t$message_type = $message_type_list[0];\t\t\tforeach($message_type_list as $k=>$v)\t\t\t{\t\t\t\tif($v['type_name'] == $message_type['type_name'])\t\t\t\t{\t\t\t\t\t$message_type_list[$k]['current'] = 1;\t\t\t\t}\t\t\t\telse\t\t\t\t{\t\t\t\t\t$message_type_list[$k]['current'] = 0;\t\t\t\t}\t\t\t}\t\t\t$GLOBALS['tmpl']->assign(\"message_type_list\",$message_type_list);\t\t}\t}.....\n   漏洞证明：  \n\n图片一句是插入自定义sql语句后生成的注入语句很明显的注入了   修复方案：  还是对关键字的过滤问题   版权声明：转载请注明来源 lxsec@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：13 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2013-04-17 16:06 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这个团购程序好像蛮有名气的，去年关注过，后来就没音信了，是跟团购的倒塌有影响吧    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 13, "Ranks": null}