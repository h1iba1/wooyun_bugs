{"id": 6313, "wybug_id": "wooyun-2013-041801", "wybug_title": "所有国产浏览器拖曳跨特权域漏洞", "wybug_corp": "所有国产浏览器", "wybug_author": "爱梅小礼", "wybug_date": "2013-11-03 00:37", "wybug_open_date": "2014-02-01 00:38", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["浏览器"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-01：\t细节向公众公开  简要描述： 主流国产浏览器全部沦陷（小众的浏览器没测）：360、金山猎豹、遨游、搜狗、QQ、百度全部中招。漏洞本身不算严重，但涉及产品较多，挨个提交加起来不止20rank把 详细说明：  漏洞成因演示：随便找个文本框中输入本地文件的地址（要带file协议头），Ctrl+A全选，如图所示\n\n然后再文本框上用鼠标拖曳下，浏览器就打开了本地HTML文件，跨本地域完成。而正常情况下你无法在HTTP域中通过<a>点击到file域的。这个洞要想成功的exploit，必须与其他的漏洞相互配合，需要特权域内路径固定的一个DOM XSS，很多第三方应用都可能有这种XSS，例如VMvare Tools的一个版本。（还可以利用浏览器缓存，不过路径要靠运气）   漏洞证明：  测试环境：XP浏览器版本：全是从官方下得最新版本我已经做了一个DEMO来显示这个洞并非你想的那么鸡肋，因为我想到了传说中的ClickJack和拖曳攻击，而且全选操作室可以由js来完成的，那么唯一需要用户做的就是拖曳鼠标，哪怕是一毫米。下载地址：http://www.kuaipan.cn/file/id_6470239382408403.htm密码：7agGju压缩包里有两个html，和一个图片，解压到Web目录里面，用HTTP协议访问demo.html，拖曳之后会访问：file:///C:/WINDOWS/Web/tip.htm  （XP下有这个文件，WIN7下没有）\n\n   修复方案：  修复很简单，这里多两句嘴。一次成功的exploit往往需要目标的很多弱点，举个例子： Mysql注射+足够权限+Web路径 = 成功写入WebShell，三个条件缺一不可。假如你的网站只有Web路径泄露，虽不具备exploit的条件，但你不可否认Web路径泄露不是弱点，你由于偷懒不去修复，哪天赶上网站升级维护，三个条件一旦满足，网站立马完蛋。这个漏洞也是这样，你也许认为他不是个漏洞，因为它在干净的系统上很难利用。但假如今后的一天，某个用户量较大的第三方应用爆出了DOM XSS，恐怕那时又要掀起一丝波澜。   版权声明：转载请注明来源 爱梅小礼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-11-07 20:33 厂商回复： 先行确认，但该情况仍在漏洞认定过程中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-03 00:41 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  这个有点碉堡    \n     2013-11-03 08:21 |    \t\t233 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:4        | 小孩子看了根本把持不住)\t\t \n  0.0好厉害的感觉    \n     2013-11-03 09:12 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  挨个提交后面的会不漏洞真实存在。但是影响不大    \n     2013-11-03 10:40 |    \t\tblast \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:57        | 五仁委员会)\t\t \n  神马情况0 0    \n     2013-11-03 10:41 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  关于拖拽我之前想的是可以将一个互联网上的exe拖拽到启动栏里 但是也有权限提示 洞主可以一起研究下不    \n     2013-11-03 12:53 |    \t\tHRay \t\t\t( 普通白帽子  |\t\t\t        Rank:196 漏洞数:28        | 018)\t\t \n  @xsser 这个中枪的厂商们应该咋认领。。    \n     2013-11-03 19:33 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @HRay 让cncert群发邮件吧    \n     2013-11-04 13:18 |    \t\tD_r0ck \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:3        | 可能是最帅的歌~)\t\t \n  不明觉厉    \n     2013-11-11 11:51 |    \t\t乌云最帅的淫 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:23        | 不以淫荡惊天下,就以闷骚动世人)\t\t \n  @xsser 帮审核下新提交的洞把.很严重的洞 .很深    \n     2013-12-07 22:05 |    \t\ttxcbg \t\t\t( 普通白帽子  |\t\t\t        Rank:391 漏洞数:53        | 说点什么呢？)\t\t \n  你在乌云这么吊你家里知道吗？    \n     2013-12-23 10:44 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  一次成功的exploit往往需要目标的很多弱点，多么nice的一句话。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}