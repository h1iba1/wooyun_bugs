{"id": 51298, "wybug_id": "wooyun-2014-075065", "wybug_title": "Mallbuilder(多用户商城)CSRF执行任意SQL", "wybug_corp": "Mallbuilder", "wybug_author": "路人甲", "wybug_date": "2014-09-09 12:29", "wybug_open_date": "2014-12-08 12:30", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-09：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-12-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： NULL 详细说明：  1.漏洞点网站后台 /admin/up_db.php 可执行任意SQL语句，并未加CSRF防护，以官网后台Demo http://cn.mall-builder.com/admin/ 为例，管理员admin:admin登陆后，向http://cn.mall-builder.com/admin/up_db.phpPOST如下数据，即可执行drop table mallbuilder_feed\n{sql:'drop table mallbuilder_feed',action:'submit'}\n\n\n2.利用为了放大利用，除了引诱管理员访问指定页面外，还可利用该系统本身存在的XSS漏洞，以官网前台Demo http://democn.mall-builder.com/为例，\n\n用户注册后，访问http://democn.mall-builder.com/main.php?m=member&s=admin_member修改个人资料，其中，头像下方的<input>未经过滤，可插入XSS payload，配合jquery比如，\nx\" onerror=\"$.post('/admin/up_db.php',{sql:'drop table mallbuilder_feed',action:'submit'})\n提交，当管理员访问含有该用户头像的所有页面时，便会触发XSS->CSRF->SQL执行，这些页面包括：http://democn.mall-builder.com/home.php?uid=537http://democn.mall-builder.com/main.php?action=main评论来访者……等等   漏洞证明：  \n\n可看到已发送POST请求   修复方案：  Anti-CSRF token   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}