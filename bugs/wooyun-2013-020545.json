{"id": 12970, "wybug_id": "wooyun-2013-020545", "wybug_title": "搜狐社区某功能缺陷导致储存xss，还可以用来刷微博粉丝呢 o(∩_∩)o 哈哈", "wybug_corp": "搜狐", "wybug_author": "px1624", "wybug_date": "2013-03-24 10:47", "wybug_open_date": "2013-05-08 10:48", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "14", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "类型应用", "使用", "蠕虫", "内容", "实现漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-08：\t细节向公众公开  简要描述： 搞了网易论坛，自然要联想到搜狐社区，嗯，和网易是同一个点的漏洞。嘿嘿，多发点大公司的，有助于提高曝光率，你懂的~~  详细说明：  测试地址：http://club.baobao.sohu.com/?action=read&forumid=mom_daugh&threadid=1cgwdnckddv1 发个帖子，给帖子内容写几个字，添加点css属性，我这里加入了颜色和字体大小。（ps：搜狐的验证码很霸气！~）图1\n\n2 看到有style，测试插入expression，发现没过滤，这里省去若干测试过，直接截图证明插外链js文件。post数据中的验证码可以配合网页发帖去获得，由于网页用了jq（从源文件中看的），所以我直接调用jq的函数。图2\n\n3 发送了修改后的数据，用谷歌浏览器F12去看下（个人习惯用谷歌浏览器看），发现成功插入了。图3\n\n4 用小号切换IE浏览器去访问了下，成功被抓到了cookie。（说明插入外部js文件是成功的）图4\n\n5 看下源文件，发现有下面的那句代码，把IE浏览器都以IE7执行，所以就通杀所有IE浏览器版本了。图5\n\n6 由于搜狐微博和搜狐社区的cookie是通用的，所以利用就很简单了，在微博发个美女性感照片，然后把这个论坛的链接插上去，描述为“！@#￥%……&*”，大家懂的。。图6\n\n也可以用来刷搜狐微博的粉丝，给比较火热的帖子发个回复（回复和发帖是一样的编辑器），或者在比较火的社区中发帖子，或者......大家可以尽量意淫、。 由于是通杀所有IE浏览器版本的，所以危害还是蛮大的。   漏洞证明：  如上，很详细。   修复方案：  过滤。ps： 剑心，求把我之前的那些待审核的漏洞，给审核通过下吧，不和要求的就直接给pass~~~堆那都攒够两桌麻将了、、、   版权声明：转载请注明来源 px1624@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-03-25 13:47 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-24 19:15 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:172        )\t\t \n  @px1624 骚年，搜狐负责安全的人休年假了，等着忽略吧    \n     2013-03-24 20:20 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @se55i0n 擦，休年假？？    \n     2013-03-24 20:48 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:172        )\t\t \n  @px1624 搜狐刚忽略了一个注入，下个是我提的洞子，再下个...    \n     2013-03-25 14:11 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @se55i0n 。。额。我的还给扔了5rank。满足了~    \n     2013-03-25 14:13 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:172        )\t\t \n  @px1624 擦，你们的洞子都认了，居然不认领我的-_-|    \n     2013-03-25 14:23 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @se55i0n 嗯，我跟前那个sql给了10rank，没认领你的目测要忽略额    \n     2013-03-25 14:24 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:172        )\t\t \n  @px1624 ...    \n     2013-11-23 10:20 |    \t\t啊L川 \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:37        | 菜鸟 ，菜渣， 菜呀！)\t\t \n  刚提交，才发现有个一模一样的洞在这里，情何以堪啊！！！    \n     2013-11-23 10:26 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @啊L川 。。。我去，这么久还没修补？    \n     2013-11-23 16:46 |    \t\t啊L川 \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:37        | 菜鸟 ，菜渣， 菜呀！)\t\t \n  @px1624 是啊 我就纳闷了 怎么说搜狐还算个大公司，实在无语啊    \n     2013-11-23 16:47 |    \t\t啊L川 \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:37        | 菜鸟 ，菜渣， 菜呀！)\t\t \n  @px1624  提交的还有很多洞，貌似都没有修改呢    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}