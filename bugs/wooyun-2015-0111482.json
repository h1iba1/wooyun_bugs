{"id": 32378, "wybug_id": "wooyun-2015-0111482", "wybug_title": "盛大主站两个URL跳转漏洞", "wybug_corp": "盛大在线", "wybug_author": "大物期末不能挂", "wybug_date": "2015-05-04 10:33", "wybug_open_date": "2015-05-09 10:34", "wybug_type": "URL跳转", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["跳转"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 我有一个愿望，把每一个wooyun漏洞提交都写成wooyun知识库。辛勤的劳动人民早起挖洞了！五一劳动节快乐！ 详细说明：  由于有一个是主站的url跳转漏洞，并且看起来主站跳转的使用频率比较高，所以自评rank选择了中。厂商请直接看漏洞证明，详细说明部分只是写一些我学到的知识。参考http://drops.wooyun.org/papers/58；http://drops.wooyun.org/papers/154URL跳转漏洞0x00:请看wooyun知识库,成因和危害就不多说了，知识库里已经很清楚了。0x01:www.sdo.com主站的url跳转漏洞#1；\nhttp://www.sdo.com/go#http://www.sdo.com:@www.baidu.com\n发现可以跳转之后找了找盛大以前的跳转漏洞， WooYun: 盛大在线主站URL跳转(钓鱼)  WooYun: 盛大在线主站URL跳转(钓鱼) 二 可以发现此处以前被报过，过滤规则修复过。但是修复的时候忽略了一点：当web服务器需要你用账号密码访问的时候，实际上你可以这样访问:http://账号:密码@网址，所以当url中是通过是否有某个域名来判断的话，可以通过@绕过。关于这个部分的内容在ftp上有很好的体现，用账号密码登录ftp后，右键文件查看属性就可以看到。\n\n这个方法感觉是经常被忽略的，所以在这里说一下。0x02 www.sdo.com主站的url跳转漏洞#2；其实刚开始的时候我只找出了0x01的跳转漏洞，但是想把问题提交写成知识库，所以就搜索了wooyun上以往的url跳转漏洞，受启发找到了这个。\n WooYun: 人人网主站任意URL跳转漏洞 http://www.sdo.com/go#http://baidusf.www-sdo.com\n过滤不严就不多说了。（多吐槽一句：http://baidusf.www-sdo.com居然是alert(1)）0x03 某分站url跳转漏洞：google一下:site:sdo.com inurl:url很容易就找到了这个地方，没有做任何的过滤。0x04 往期wooyun奇葩url漏洞这个部分就和这个洞没有关系了，纯属娱乐。 WooYun: 奇虎360某站设计缺陷域名可导致被恶意利用(可用于绿标,博彩,钓鱼等) 360自己挖坑自己跳的url跳转漏洞。 WooYun: 百度url跳转及反射型xss  WooYun: 银率网一处url跳转漏洞可钓鱼 神奇的base64编码跳转漏洞（个人观点：虽说base64编码之后不容易被人发现这是一个url跳转，但是这样无疑无法过滤了。一旦被人发现跳转，很容易就很利用，而且还会非常隐蔽。） WooYun: Flash+chrome绕过腾讯URL跳转安全检测策略 利用浏览器特性造成的url跳转，个人觉得还是值得一看的。   漏洞证明：  1.主站的URL跳转漏洞http://www.sdo.com/go#http://www.sdo.com:@www.baidu.comhttp://www.sdo.com/go#http://baidusf.www-sdo.com过滤规则不全造成的跳转。\n\n\n\n2.某分站url跳转漏洞http://gh.aion.sdo.com/gh2/link.php?do=blog&id=32806&url=http://aion.duowan.com/0901/96292181713.htmlURL完全没有过滤。3.在发现了2中的url跳转漏洞之后，又发现了这个站的mysql报错回显没有关。\n\n理论上报错回显存在可以采用报错注入的方式获取数据的。由于现在是无法连接到数据库，所以什么都获取不了。不过也说一下吧，建议关闭错误回显。 WooYun: 哇塞网mysql报错注入（附一只新手学习如何利用报错注入的过程）    修复方案：  1.补充规则2.关闭错误回显   版权声明：转载请注明来源 大物期末不能挂@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-05-09 10:34 厂商回复：  漏洞Rank：2  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-15 13:45 |    \t\t夜尽天明 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 即将毕业实习的小子)\t\t \n  盛大总是太恶心，我的帐号被异地登陆不但不冻结，骗子修改密码还从不验证注册信息，当申诉找回帐号却会各种刁难，没见过这种公司的    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}