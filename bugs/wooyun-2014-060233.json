{"id": 55677, "wybug_id": "wooyun-2014-060233", "wybug_title": "飞飞影视最新版SQL注入一枚", "wybug_corp": "飞飞影视", "wybug_author": "′雨。", "wybug_date": "2014-05-10 22:15", "wybug_open_date": "2014-08-08 22:16", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-10：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-08-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 无视gpc。直接出数据。 详细说明：  在Lib\\Lib\\Action\\Home\\HitsAction.class.php中\npublic function show(){\t\t$id\t= intval($_GET['id']);\t\t$sid = trim($_GET['sid']);\t\t\t\t$type = trim($_GET['type']);\t\t$where[$sid.'_id'] = $id;\t\t$rs = M(ucfirst($sid));\t\t$array = $rs->field($sid.'_id,'.$sid.'_hits,'.$sid.'_hits_month,'.$sid.'_hits_week,'.$sid.'_hits_day,'.$sid.'_addtime,'.$sid.'_hits_lasttime')->where($where)->find();\t\t\tif($type == 'insert'){\t\t\t$this->hits_insert($sid,$array);\t\t}else{\t\t\tif($array){\t\t\t\techo(\"document.write('\".$array[$type].\"');\");\t\t\t}else{\t\t\t\techo(\"document.write('0');\");\t\t\t}\t\t}    }\n这里$sid可控,且直接做了table。补全一下语句 然后注释掉后面的。可以直接输出数据，。   漏洞证明：  \n\n测试了下官方网站上的演示站\n\n   修复方案：  限制   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}