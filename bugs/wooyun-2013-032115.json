{"id": 9862, "wybug_id": "wooyun-2013-032115", "wybug_title": "看我如何重置篱笆网任意账户密码（秒改）", "wybug_corp": "篱笆网", "wybug_author": "xfkxfk", "wybug_date": "2013-07-24 16:20", "wybug_open_date": "2013-09-07 16:20", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当", "认证设计不合理", "设计错误", "搞笑有爱"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-07：\t细节向公众公开  简要描述： 看我如何重置篱笆网任意账户密码（秒改） 详细说明：  先注册两个用户xfkxfk，testertester然后找回密码\n\n选择通过邮箱找回\n\n看看重置密码的链接\n\n我们输入新密码然后抓包\n\n因为这里我们重置的是xfkxfk的密码，看看xfkxfk的user_ID\n\n下面是重置xfkxfk的请求信息\n\n我们把来看看受害者testertester的user_ID\n\n然后我们把重置xfkxfk密码的请求中uid=7540861，referer中的uid换成testertester的uid=7540883，把user_name也换成testertester,最不应该的是这里的code却没起作用，但是code的键值还是必须存在，值为32位任意值。然后来重置testertester的密码：\n\n从返回信息中成功重置了testertester的密码。   漏洞证明：  因为我们可以访问任意用户的空间：\nhttp://i.liba.com/7540861\n这是xfkxfk的空间，只要我们变换http://i.liba.com/后面的这个uid就能访问到任意用户空间，从而得到用户的uid和user_name，下面我们随便找一个用户uid=1的会员：\n\n\n\n   修复方案：  1、不要把验证code放到referer里面啊！2、及时放到referer里面也要验证一下这个code的值是否正确唯一啊！   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-07-25 09:20 厂商回复： 已修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-24 16:21 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  新来的厂商不容易啊    \n     2013-07-24 16:23 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @篱笆网 不好意思，为了验证漏洞，我改了一个账户的密码，但是没做任何操作，敏感信息也打码了，谢谢    \n     2013-07-24 16:23 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @M4sk 嗯，相当不容易啊，都是先苦后甜的嘛    \n     2013-07-24 16:24 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  我来了，走了。    \n     2013-07-24 16:27 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  我也测试成功了，进入了admin帐号    \n     2013-07-24 16:28 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  脱裤ing    \n     2013-07-24 16:34 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  你们太坏了。    \n     2013-07-24 16:57 |    \t\t小痞子 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:21        | <xss>alert(\"a\")</xss>￥&@&……dssKhwjcw...)\t\t \n  不许动  举起鸟来！    \n     2013-07-24 16:57 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  = =# 终于测试成功了。。。    \n     2013-07-24 17:02 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @VIP @淡漠天空 @Coody 你们太坏了，厂商都哭了，积点德行不行    \n     2013-07-24 17:03 |    \t\tLove \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 学习)\t\t \n  彭拜    \n     2013-07-24 17:04 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @VIP 谁说测试admin账户了？？？现在都禁用了。。。。@xfkxfk 其实就是你标题中“秒改”吸引了我，，，，    \n     2013-07-24 18:27 |    \t\t钝刀的老王 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 挑水，你桶漏的；扫地，你扫不干净；刀钝了...)\t\t \n  @M4sk 很别催啊。。。。新厂商我带来的，结果我提交的漏洞被雪藏。。。    \n     2013-07-24 19:41 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @钝刀的老王   厂商不要哭 ~    \n     2013-07-24 21:15 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @钝刀的老王 @Coody @篱笆网 怎么厂商还不来认领咧。。。    \n     2013-07-24 23:36 |    \t\tling \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:35        | 我是屌丝、我为自己代言 。)\t\t \n  @xfkxfk 思路是什么    \n     2013-07-25 08:19 |    \t\tB1acken \t\t\t( 普通白帽子  |\t\t\t        Rank:174 漏洞数:56        | 渣渣)\t\t \n  @xfkxfk 亲怎么秒改，求方法，求交流    \n     2013-07-25 08:48 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @B1acken @ling 等厂商认领了再说吧，可以自己测试一下    \n     2013-07-28 23:57 |    \t\t佩佩 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:8        | 一个热衷于网络安全的白帽子,具有很强的逻...)\t\t \n  @xfkxfk 这个洞封没... 没封去测试下的说     \n     2013-07-29 08:59 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @佩佩 厂商回复：已修复    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}