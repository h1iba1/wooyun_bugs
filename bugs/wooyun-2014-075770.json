{"id": 429, "wybug_id": "wooyun-2014-075770", "wybug_title": "全棉时代某页面存在SQL注入漏洞", "wybug_corp": "全棉时代", "wybug_author": "hashcode", "wybug_date": "2014-09-11 10:57", "wybug_open_date": "2014-10-26 11:00", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-11：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-10-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 某页面存在SQL注入漏洞，可以获取数据库表结构等相关信息。 详细说明：  全棉时代一个广告语投票页面 http://www.purcotton.com/mall/mianroujin/vote.ihtml通过查看页面js源码 http://res.purcotton.com/mres/res/mall/js/member/vote.js 可以发现里面有个获取投票数的服务 http://www.purcotton.com/mall/zixunvote/getVoteNum.ihtml此服务接受key为zxid的post参数，value为vote1、vote2...等等\n\n通过设置参数zxid=vote1 发现返回的是{num:116}然后通过设置参数zxid=vote1%27 发现返回的是 {num:-1}，猜测应该是服务报错，返回了出错后的返回值。再通过设置参数zxid=vote1%27%20%27 发现返回的是{num:116}，确认可以注入。通过参数参数zxid=vote1%27%20--%20- 以及 zxid=vote1%27%20AND%20MID(VERSION(),1,1)%20=%20%275%27%20--%20- 返回结果都是{num:5}，猜测这个SQL语句后面应该还有查询条件，而且使用的是MYSQL5。找到注入点了，直接就通过盲注从information_schema.tables 及 information_schema.columns中获取到数据库结构信息。   漏洞证明：  \n\n如图，通过盲注获取到数据库表名。   修复方案：  过滤提交数据，防止SQL注入。   版权声明：转载请注明来源 hashcode@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-09-11 13:07 |    \t\thashcode \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 野生程序猿)\t\t \n  又找到的新的乐子，感觉评分低了....    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}