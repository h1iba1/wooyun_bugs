{"id": 46457, "wybug_id": "wooyun-2014-084657", "wybug_title": "天清汉马USG防火墙越权操作", "wybug_corp": "北京启明星辰信息安全技术有限公司", "wybug_author": "老周", "wybug_date": "2014-11-25 15:25", "wybug_open_date": "2015-02-23 15:26", "wybug_type": "权限控制绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["越权操作"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-01：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-23：\t细节向公众公开  简要描述： 由于对用户权限控制不严格，低权限用户可以对系统中管理员访问权限、管理员信息以及其他非本账户权限功能进行操作。 详细说明：  由于程序对用户权限的控制仅仅是让用户界面中不出现相应的菜单及功能模块，但是用户可以通过修改菜单ID的方式访问其他权限的系统内容，属于垂直越权操作。例如，使用audit审计用户登录系统，在点击菜单是，将识别参数修改为system.admin，这时，audit用户就拥有修改管理员信息以及权限的能力。下图为修改参数截图\n\n下图为修改参数后进入管理员管理界面截图\n\n下图为将useradmin账户权限设置为最大截图\n\n下图为使用useradmin账户的新权限登录截图\n\n   漏洞证明：  下图为修改参数截图\n\n下图为修改参数后进入管理员管理界面截图\n\n下图为将useradmin账户权限设置为最大截图\n\n下图为使用useradmin账户的新权限登录截图\n\n   修复方案：  建议优化权限控制   版权声明：转载请注明来源 老周@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-11-28 01:23 厂商回复： 感谢漏洞发现 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-29 12:57 |    \t\t想要减肥的胖纸 \t\t\t( 普通白帽子  |\t\t\t        Rank:250 漏洞数:42        )\t\t \n  直接访问别的用户url···    \n     2014-12-03 16:05 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  呃    \n     2014-12-18 09:30 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n   启明也玩这种错误    \n     2014-12-18 12:22 |    \t\tsql  \t\t\t( 核心白帽子 |\t\t\t        Rank:1127 漏洞数:145        | 带着两个MM（mysql,mssql），玩3p（asp,php...)\t\t \n  呃    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}