{"id": 2246, "wybug_id": "wooyun-2014-060871", "wybug_title": "用友办公平台任意文件上传getshell", "wybug_corp": "用友软件", "wybug_author": "路人甲", "wybug_date": "2014-05-15 18:18", "wybug_open_date": "2014-08-10 18:20", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-20：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-10：\t细节向公众公开  简要描述：  详细说明：  无需登录，通杀用友办公平台。。。http://oa.bamatea.comhttp://oa.moonbasa.comhttp://oa.etonetech.comhttp://oa.ztcz.cnhttp://218.249.130.74http://119.146.190.170:9988http://zhidao.baidu.comhttp://wenku.baidu.comhttp://223.4.22.36http://222.243.160.83:9090http://www.chipshow.cnhttp://116.205.96.170:9090http://www.sxjbjt.com:9090http://122.225.203.168:8888http://oa.chinabed.comhttp://oa.lutongnet.comhttp://oa.zetacn.com:9090http://oa.zhcpt.edu.cnhttp://www.doc88.comhttp://oa.sinodata.com.cnhttp://www.docin.comhttp://www.koyochem.com:8080http://61.186.155.27http://oa.nyinn.cnhttp://115.236.65.115:9090http://119.146.190.118:8089http://219.137.250.133http://123.133.29.174:9090http://koa.ecp888.comhttp://www.cting.com.cnhttp://oa.suncorps.cnhttp://59.41.47.211http://oa.bamatea.com:9090http://oa.zhenaiws.comhttp://www.koyochem.com:9191http://60.208.131.46:9090http://219.131.221.174:9090http://oa.bnuz.edu.cn:8080http://183.238.59.61:9090http://218.205.208.22:9090http://oa.xhlbdc.comhttp://124.193.165.174:9090http://218.75.87.186:9090http://oa.eva-group.com:511http://113.106.92.16:9090http://oa.cqmsy.comhttp://cting.com.cnhttp://220.231.158.211http://oa.tiholding.cnhttp://124.172.170.141:9090http://oa.hengdigroup.com:9090http://www1.elkay.com.cn:9090http://www.gzpiano.comhttp://oa.zaffer.cnhttp://oa.gdisg.com依然是上传问题，这次在femail/uploadAccessory.jsp中<%@ page contentType=\"text/html; charset=GBK\" language=\"java\"%><%@ page import=\"fe.util.BaseFunc,fe.ufmail.MailServer\"%><jsp:directive.page import=\"fe.upload.UploadFile\"/><jsp:directive.page import=\"java.io.File\" /><html>    <head>        <title>${FE_SYS_TITLE }</title>        <link href=\"/style1.css\" rel=\"stylesheet\" type=\"text/css\">        <meta http-equiv=\"Content-Type\" content=\"text/html; charset=GBK\">        <style type=\"text/css\">        <!--        body {            margin-left: 0px;            margin-right: 0px;            margin-top: 0px;            background-color: #EEEEEE;        }        -->        </style>    </head>    <script language=\"javascript\" src=\"/js/BaseFunc.js\"></script>    <script language=\"javascript\" src=\"/js/BaseFun.js\"></script>    <body>        <%            String flelst = request.getParameter(\"fileList\");            String action = request.getParameter(\"action\");            String strpath = BaseFunc.ISOToGBK(request.getParameter(\"temppath\"));//获取路径。。。这里可以自定义，构造好我们的路径即可。。。            int saveFlag = -1;            if ( flelst != null && flelst.length() > 0 )                flelst = BaseFunc.ISOToGBK(flelst);            else                flelst = \"\";                /*            int allowsize = MailServer.getDefaultAccessSize();            if ( flelst.length() > 0 ){                String file[] = flelst.split(\";;\");                for ( int i = 0; i < file.length; i++ ){                    String fleinfo[] = file[i].split(\";\");                    File file1=new File(strpath,fleinfo[0]);                    allowsize=allowsize-(int)file1.length();                }            }            */            String msgStr = \"\";\t\t\tint allowsize = MailServer.getDefaultAccessSize()+1024*1024*10;                        //original value 10M            if (action!=null && action.equals(\"save\")){这里将temppath 定义为../../jboss/server/default/deploy/fe.war/即可，这里即可将我们的马直接写到网站根目录当中\n\n然后上传成功之后，右击源代码，即可看到shell地址\n\n连接www.xxx.com/1400082691416.jsp即是shell，目前通杀。。。。如\n\n直接即可添加管理员（因为都是administrator权限，直接执行系统命令，获取服务器），如图：\n\n   漏洞证明：  \n\n直接即可添加管理员（因为都是administrator权限，直接执行系统命令，获取服务器），如图：\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-08-10 18:20 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-10 22:23 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  厂商忽略，==，难以置信    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}