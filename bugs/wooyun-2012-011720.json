{"id": 16943, "wybug_id": "wooyun-2012-011720", "wybug_title": "微信任意用户密码修改漏洞", "wybug_corp": "腾讯", "wybug_author": "only_guest", "wybug_date": "2012-09-04 05:09", "wybug_open_date": "2012-10-19 05:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-09-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-09-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-10-19：\t细节向公众公开  简要描述： 腾讯微信任意用户密码修改. 详细说明：  今天发现个微信群发的漏洞.还没玩.就被修补了.于是就有了这个漏洞的产生.同样问题产生在重置用户密码的环节.在微信官方的首页上发现新增了如下功能模块\n\n访问后看到这个功能.来了兴趣\n\n在这个页面输入一个已经注册了微信的手机号.\n\n得到如下提示\n\n选择我已收到验证码就跳转到一个修改密码的页面,如下\n\n在这一步抓包.得到如下包文\ncheck=false&phone=18666666666&t=w_password_phone&isemail=0&value=18666666666&method=reset&country=A86&getmethod=web&password=zzzzzz&password2=zzzzzz&verifycode=1234\n将包文中的verifycode进行重复提交后发现会提示\n\n这样的话.就要想办法去突破.经过一系列尝试后发现如果在phone=18666666666的号码后面添加不为数字的字符时,可以绕过此限制.于是推理出其判断方法如果phone=18666666666的尝试次数大于阀值,则提示请求过于频繁但在这一步之前没有对phone进行提纯.所以可以将特殊字符带入但在下一步的时候进行了提纯.只取了phone中的数字部分.然后在取出此号码的verifycode进行比对.比对成功则修改密码\n\n修改密码成功.这个地方的薄弱环节在于微信重置密码的验证码为4-5位纯数字.且数字范围在1000-20000之间也就是说.我只要尝试19000次.我用50个线程发包.3分钟即可成功修改一个密码.在发现此漏洞后.我修改了两个人的微信帐号.一个是最近很喜欢的明星柳岩的经纪人柳岩在微搏上公布了经纪人的手机号.成功修改进入后.通过微信自带的离线消息查看功能.可以成功查看其所有QQ好友于是得到了柳岩的QQ号..但是拒绝添加好友了..伤心这里由于隐私原因.就不上图了.另外一个是腾讯的某高管.我在百度上搜索到了腾讯高管的list然后通过list里的手机号修改了其密码.和尊敬的马化腾马大哥进行了一次亲密的交谈.由于夜深了.他不在线.所以没收到其回应.附图几张.\n\n\n\n和马哥开了个小玩笑.然后找到了最近正好很火的周鸿祎手机泄漏的视频.同样通过音频分析得到号码.尝试修改其微信密码..发现周哥果然没有注册微信.放弃了尝试.   漏洞证明：  \n\n   修复方案：  增强下机制吧.   版权声明：转载请注明来源 only_guest@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-09-04 10:58 厂商回复： 感谢反馈，我们正在跟进处理。 最新状态： 2012-09-04：我们已经修复了此问题，非常感谢您的报告。 2012-09-04：感谢乌云社区和这位漏洞发现者。收到乌云通知之后，我们已第一时间屏蔽该BUG，避免被恶意利用。  ", "replys": "漏洞评价：\n评论\n     2012-09-04 05:13 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  www.pkav.net发表了漏洞详情.会在漏洞修复后公开但是鉴于乌云的WB查看漏洞机制.会晚点公开.    \n     2012-09-04 07:00 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  我信洞主    \n     2012-09-04 07:13 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  楼主又风骚了!    \n     2012-09-04 08:22 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  骚年    \n     2012-09-04 08:36 |    \t\tJannock  \t\t\t( 核心白帽子 |\t\t\t        Rank:2278 漏洞数:204        | 关注技术与网络安全（招人中，有兴趣请私信...)\t\t \n  @only_guest 昨天才说，今天大牛就发表了。。。赞。。。    \n     2012-09-04 09:15 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  好骚年~    \n     2012-09-04 09:25 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  我信洞主    \n     2012-09-04 09:37 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  ......逆天吧你就！    \n     2012-09-04 09:46 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  李先生在微信里么 有好友列表么？    \n     2012-09-04 09:48 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @xsser = =李开复么？哈哈    \n     2012-09-04 10:01 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @gainover 更相信是李彦宏呢    \n     2012-09-04 10:09 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  微信验证码短，且数字确实能搞    \n     2012-09-04 10:11 |    \t\tp.z  \t\t\t( 普通白帽子  |\t\t\t        Rank:411 漏洞数:40        )\t\t \n  @gainover @xsser想和27.5G的主角合影已经不是一天两天的事了。    \n     2012-09-04 10:12 |    \t\tbing  \t\t\t( 普通白帽子  |\t\t\t        Rank:332 漏洞数:34        | bingsec)\t\t \n  洞主日李万吉啊    \n     2012-09-04 11:02 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  你知道的忒多了    \n     2012-09-04 11:03 |    \t\tdavie \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:4        | 关注安全)\t\t \n  楼主瓣膜    \n     2012-09-04 11:05 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @p.z -_-||    \n     2012-09-04 11:10 |    \t\trootkit \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 打酱油的)\t\t \n  膜拜啊    \n     2012-09-04 11:15 |    \t\tdengyunxuan \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 重围)\t\t \n  求密码    \n     2012-09-04 11:23 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @p.z 原来如此～～    \n     2012-09-04 12:07 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  最帅的男人也是预言师,感觉有漏洞就真的有-_-    \n     2012-09-04 12:15 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  @xsser 还真忘了...只记得去搞周鸿祎了    \n     2012-09-04 14:08 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  帅呆了，插一脚    \n     2012-09-07 10:00 |    \t\t街球幽灵 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:5        | 社会工程学研究，手机维修工程师。)\t\t \n  膜拜洞主~    \n     2012-09-10 09:39 |    \t\t冷冷的夜 \t\t\t( 普通白帽子  |\t\t\t        Rank:135 漏洞数:12        )\t\t \n  我草，膜拜下    \n     2012-09-10 11:19 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  从多处看 @p.z  大神真是个淫荡的大神~~求证@xsser    \n     2012-09-10 12:03 |    \t\tp.z  \t\t\t( 普通白帽子  |\t\t\t        Rank:411 漏洞数:40        )\t\t \n  @一刀终情 这些都是xsser言传身教的结果，@xsser 节日好。    \n     2012-09-10 17:27 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @p.z @xsser 剑老师，节日好    \n     2012-09-11 15:22 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  外部关联：http://pkav.net/2012/09/%E5%BE%AE%E4%BF%A1%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9%E6%BC%8F%E6%B4%9E/     \n     2012-09-11 15:23 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @horseluke 坑爹啊 还等着赚乌云币呢    \n     2012-09-11 15:34 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @xsser ，@only_guest 都已经赚了不少wb了吧......连超级玛丽都给他充值了......    \n     2012-09-13 09:43 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  \"经过一系列尝试后发现如果在phone=18666666666的号码后面添加不为数字的字符时,可以绕过此限制\" 虽然一句话带过 但是感觉过程之艰辛    \n     2012-10-19 11:30 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @none 懂的人这是    \n     2012-12-10 21:50 |    \t\tTituX \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | <script></script>)\t\t \n  来拜一下乌云神贴之一    \n     2012-12-30 14:31 |    \t\tinvader \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        )\t\t \n  各位可以去尝试一下国内的其它类似的东西，很多都是没有过滤字符和限制输出长度的，验证甚么的甚至包括OAUTH也都是非常简单的处理了，另外可以伪造代理、证书校验、DNS这样来欺骗设备。    \n     2014-04-20 10:52 |    \t\tzhangjie \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 我什么都不知道)\t\t \n  膜拜一下~~也可能是周xx 没绑定手机。另外想问下洞主，漏洞证明里的贴图的软件是什么软件呢？谢谢！    \n     2014-10-12 16:32 |    \t\t荆科 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | www.jingke.info)\t\t \n  神贴~    \n     2015-03-29 14:53 |    \t\tmikecracker \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | none of my business)\t\t \n  神贴！    \n     2015-06-11 11:39 |    \t\t暴雪寒极 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:4        | 晓风凉如水，夜尽入枕愁)\t\t \n  楼主太骚了    \n     2015-06-27 22:46 |    \t\t昌维 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | QQ：867597730，百度贴吧ID：昌维001)\t\t \n  原来都是根据phone之类的来判断是否频繁啊，，，    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}