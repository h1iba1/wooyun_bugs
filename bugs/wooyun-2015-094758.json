{"id": 39112, "wybug_id": "wooyun-2015-094758", "wybug_title": "TCL内部员工商城二次突破前台任意账户登录", "wybug_corp": "TCL官方网上商城", "wybug_author": "黑暗游侠", "wybug_date": "2015-01-30 18:54", "wybug_open_date": "2015-03-16 18:54", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-16：\t细节向公众公开  简要描述： TCL内部员工商城二次突破前台任意账户登录 详细说明：   http://www.pengpengmall.com/TCL内部员工商城员工登录和会员登录均存在漏洞漏洞存在于忘记密码处，如图：\n\n任意输入账号名称，比如我输入admin\n\n下一步后，提示密码邮件已经发送到邮箱，而且邮件地址都显示出来了。。（这是很关键的一步，为后面我们的二次突破提供了条件）\n\n 点击重新发送，抓包，然后修改邮箱为自己的其他任意邮箱，用户名不变还是admin\n\n然后发送数据包，密码找回连接已经躺在里面了\n\n点击即可修改用户admin的密码\n\n直接修改密码是不成功的，提示找不到该用户，为什么呢，抓包来看下\n\n默认post提交的邮箱是我们之前使用的自己的邮箱，所以这里改为之前找回密码处显示的原始邮箱即可，进行二次突破\n\n如图，发送数据包后即可成功更新admin用户密码，我重置为了asdasdasd之后商城登陆如图\n\n并不是所有叫admin的都是管理员，看来俺没蒙对管理员账号不是所有的admin都是管理员测试到此为止，发现问题即可。   漏洞证明：   http://www.pengpengmall.com/TCL内部员工商城员工登录和会员登录均存在漏洞漏洞存在于忘记密码处，如图：\n\n任意输入账号名称，比如我输入admin\n\n下一步后，提示密码邮件已经发送到邮箱，而且邮件地址都显示出来了。。（这是很关键的一步，为后面我们的二次突破提供了条件）\n\n 点击重新发送，抓包，然后修改邮箱为自己的其他任意邮箱，用户名不变还是admin\n\n然后发送数据包，密码找回连接已经躺在里面了\n\n点击即可修改用户admin的密码\n\n直接修改密码是不成功的，提示找不到该用户，为什么呢，抓包来看下\n\n默认post提交的邮箱是我们之前使用的自己的邮箱，所以这里改为之前找回密码处显示的原始邮箱即可，进行二次突破\n\n如图，发送数据包后即可成功更新admin用户密码，我重置为了asdasdasd之后商城登陆如图\n\n并不是所有叫admin的都是管理员，看来俺没蒙对管理员账号不是所有的admin都是管理员测试到此为止，发现问题即可。   修复方案：  2处都得修复，安全是一个整体，20rank谢谢咯，过年快乐！   版权声明：转载请注明来源 黑暗游侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-01-31 22:29 厂商回复： 感谢你的关注，已转交相关单位修复，谢谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}