{"id": 65075, "wybug_id": "wooyun-2013-019335", "wybug_title": "爱丽团购给任意用户绑定任意手机", "wybug_corp": "aili.com", "wybug_author": "xfkxfk", "wybug_date": "2013-02-28 16:27", "wybug_open_date": "2013-03-08 16:22", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口未加权限认证", "越权操作", "未授权访问", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-02-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-03-08：\t厂商提前公开漏洞，细节向公众公开  简要描述： 爱丽团购，由于没有限制用户权限，可以给任意用户绑定到任意手机，解除任意用户已绑定的任意手机号码被比人绑定，而且还修改了用户的账户信息，挺严重的。 详细说明：  \n测试环境：攻击者：tester，用户user_id:2856430受害者：xfkxfk,用户user_id:2837024\n0、首先看看我们要攻击的对象xfkxfk是没有绑定手机的：\n\n1、我们用tester账户进行手机绑定，在这之前我们先看看他的user_id为2856430。\n\n2、现在开始为tester绑定手机号码：\n\n3、截包看看请求数据：\n请求的url：http://tuan.27.cn/ajax/sms.php?action=loginmobilebindcheck&mobile=150***9543&user_id=2856430&verifycode=rjpo&r=0.25387939011119365\n\n\n4、修改用户的user_id为2837024后，再发送请求，验证码成功发送到手机上:\n\n5、在输入手机验证码是截包，在看到发送的请求中的user_id为我们修改后的xfkxfk的user_id:2837024，这里的手机验证码是716392：\n\n   漏洞证明：  6、界面上看到成功绑定手机：\n\n7、我们来看看用户xfkxfk成功绑定了我们输入的手机号码：\n\n而且从用户的账户信息中也能看到用户的联系方式，手机号码编程了我们绑定的手机号码，而且现象被置灰，是不能修改的：\n\n8、====================================================危害：1、这里我只是那两个用户测试了一下，也用了自己的手机号码，可以为任意用户绑定这个手机号码，而且当我的手机号码被用户A绑定后，还可以被用户B绑定，从而用户A的绑定解除。2、我也可以使用任意手机号码，因为这里的手机验证码是6位随机数，没有次数和时间限制，太给力了，输入任意手机号码，暴力破解6位验证码太快了。3、这样一来我们就可以为任意用户绑定任意手机号码了，还能任意解除绑定的号码。4、还修改了用户的联系方式。5、危害杠杠的。。。6、求礼物啊。。。   修复方案：  添加用户权限控制。设置验证码验证次数。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-02-28 16:41 厂商回复： 惊出一身冷汗！ 最新状态： 2013-03-08：已修复！  ", "replys": "漏洞评价：\n评论\n     2013-02-28 17:49 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  惊出一身冷汗！    \n     2013-03-01 11:35 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  厂商很有爱的样子    \n     2013-03-08 16:51 |    \t\t苏南同学 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:5        | 苏南同学，就是苏南同学~~~)\t\t \n  这种弱智错误很多年前就有......我很多年前就挖出来过这样的漏洞.....    \n     2013-03-20 09:24 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  厂商挺有意思的    \n     2013-03-22 21:20 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  。。。6位 爆破真的很快吗？？    \n     2013-03-22 23:15 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  厂商提前公开漏洞，细节向公众公开。发现爱丽网似乎是乌云里最有意思的厂商。很给力哦 @爱丽网    \n     2014-12-03 23:28 |    \t\t胡小树 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:11        | 我是一颗小小树)\t\t \n  @wefgod 不像有些恶心的厂商，忽略后偷偷修补    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}