{"id": 49, "wybug_id": "wooyun-2014-072596", "wybug_title": "SiteServer BBS V4.0可无视登陆验证码爆破，无视注册验证码无限注册，无视提示信息注册任意不规则用户名", "wybug_corp": "百容千域软件技术开发有限责任公司", "wybug_author": "zph", "wybug_date": "2014-08-18 15:11", "wybug_open_date": "2014-11-13 15:12", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感接口缺乏校验", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-23：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-13：\t细节向公众公开  简要描述： no see login verification horse boom broken 无视登陆验证码爆破no see register verification horse no limit register 无视注册验证码无限注册no see hint message register arbitrarily no rule username 无视提示信息注册任意不规则用户名啦啦啦，无视所有验证马~~ 详细说明：  由于涉及到验证码，用户名处使用js本地验证，直接禁用js可以绕过验证本漏洞挖掘灵感由第49期众测而来……因为阁下用的是siteserver，并且找到漏洞后奖金池已经被打空了（很给力啊），就只能提交主站了……0x01 配置环境配置环境就自己配置环境……不解释 :)这里我用的是iis8.5和sql server 2012   漏洞证明：  0x02 no see login verification horse 无视登陆验证码\n\n输入用户名，密码后，直接点击提交\n\n{\"success\":\"true\",\"errorMessage\":\"\\u767B\\u5F55\\u5931\\u8D25\\uFF0C\"}\\u767B\\u5F55\\u5931\\u8D25\\uFF0C解密后：登录失败？！！！我擦，怎么会酱紫呢？？返回前台发现，已经登陆成功\n\n再一看之前的json\"success\":\"true\"汗啊……0x03 no see register verification horse 无视注册验证码\n\n随意填写验证码，点击注册访问：http://127.0.0.1/user.aspx?publishmentSystemID=1&userName=testtest（userName为刚刚注册的用户名）发现用户已经注册成功了\n\n0x04 no see hint message register arbitrarily no rule username 无视提示信息注册任意不规则用户名\n\n注册用户名为：no_see_you~.asp点击注册因为头像目录以用户名命名，所以以此可以构造出iis6~7解析漏洞（iis8搞不了呃……）输入no_see_you~.asp和密码，登陆alert出了这个\n\n\"=\"附近有语法错误（坏笑），不知是否有sql注入，但是这不是这个洞的重点……访问：http://127.0.0.1/user.aspx?publishmentSystemID=1&userName=no_see_you~.asp\n\n已经注册成功一杯咖啡后，再次登陆，已经可以登陆鸟（不知道这是为毛）\n\n0x05 失败的任意文件上传有了iis解析漏洞后，理论上就可以任意文件上传导致代码执行辣但是不然用copy /b 1.jpg+1.asp 123.jpg后，上传合成后的图片上传后会被服务器重新进行某种操作，导致webshell代码被K掉……即是这个帖子……http://zone.wooyun.org/content/14560后续大牛们可以突破突破……   修复方案：  “验证”码要验证啊 要不就摆设了 :)另外可以像dz那样，将头像目录改为用uid或者其他纯数字，这样能避免一下iis解析漏洞（毕竟这个.net系统只能在iis下运行……）   版权声明：转载请注明来源 zph@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-11-13 15:12 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-23 19:25 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  忽略？    \n     2014-08-23 20:27 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  @wefgod 哎，没办法，忽略就忽略了呗    \n     2014-08-23 20:43 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  不过清一色的no see……    \n     2014-08-25 19:07 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  @wefgod :)    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}