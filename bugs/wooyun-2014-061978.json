{"id": 3081, "wybug_id": "wooyun-2014-061978", "wybug_title": "drops文章《上传文件的陷阱》实例应用", "wybug_corp": "乌云官方", "wybug_author": "索马里的海贼", "wybug_date": "2014-05-23 13:19", "wybug_open_date": "2014-07-07 13:20", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-07：\t细节向公众公开  简要描述： 上一个实例一激动没检查就发了，审核直接无视就好了。。千万别通过。。这个实例应该没问题了。通过两个乌云的“疏忽”来控制任何人的乌云主站功能可以偷偷把你乌云奖金捐赠或者提现到我的支付宝哦感谢@Mramydnei M哥的帮助 详细说明：  http://drops.wooyun.org/tips/2031说的问题很清楚我也不重复了，乌云的几个上传好像都没做文件内容的检查 包括发布漏洞编辑器zone编辑器drops编辑器第一次测试的结果很不顺利主站发布处上传的图片有referer检查zone的上传到wzone.sinaapp.com了drops的传完了打开居然是0字节原本已经想放弃了，盯着fiddler里的http头看了半天索性死马当活马医试试referer的校验机制，结果第一次尝试修改referer为http://www.baidu.com/www.wooyun.org/就成功了看来哪里都有加班写错代码的程序猿啊referer解决了 其他就好办了 新建一个flash项目，先get一下http://www.wooyun.org/teams/（选这个没别的理由，就因为页面内容少。。速度快一点 token几乎每个页面都有）获取/user.php?action=logout&token=xxxxxx这里的token然后用token该干嘛干嘛。这里拿修改联系方式中的支付宝来演示。\n\n然后导出swf 后缀名改为.jpg 在乌云发布漏洞处上传图片得到地址然后在自己的网站新建一个名为www.wooyun.org的目录 poc页面放到这里面就能绕过乌云的referer检查了\n\n好了 把这个页面的地址 http://xxx.com/www.wooyun.org/csrf.html丢到zone 提现就哗哗到我的支付宝了   漏洞证明：  访问http://qaz.me/www.wooyun.org/csrf.html查看控制面板\n\n   修复方案：  referer上传   版权声明：转载请注明来源 索马里的海贼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-05-27 17:25 厂商回复： 漏洞确实存在，感谢 @索马里海盗 对乌云的报告 ：） 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-23 13:22 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  擦，尼玛我点了下中招了，还我wb和奖金    \n     2014-05-23 13:22 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  洞主好文艺啊...    \n     2014-05-23 13:23 |    \t\tFocusstart \t\t\t( 普通白帽子  |\t\t\t        Rank:574 漏洞数:163        | 努力让某某某成为最幸福的女人！)\t\t \n  洞主是不是提现一夜成爆发富？求分赃    \n     2014-05-23 13:23 |    \t\t龙翔 \t\t\t( 实习白帽子  |\t\t\t        还没有发布任何漏洞        | 世界上有10种人，懂二进制的和不懂二进制的)\t\t \n  我也中招了    \n     2014-05-23 13:23 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  支持一个  期待详细的文档    \n     2014-05-23 13:26 |    \t\t索马里的海贼 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:24        | http://tieba.baidu.com/f?kw=WOW)\t\t \n  @寂寞的瘦子 提现功能是人工审核的，wb转账早关了 zone没有crossdomain.xml根本过不去连感谢都不能。。。你的wb和奖金肯定是狗哥私吞了。。。    \n     2014-05-23 13:26 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  @寂寞的瘦子 你不一共才11个吗  买完衣服就1WB了。。。    \n     2014-05-23 13:29 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @索马里的海贼 @乐乐、 嘿嘿，开个玩笑，不过我真的只剩下一个wb，你妹的，害我重新写了一次联系方式：（    \n     2014-05-23 13:32 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  @寂寞的瘦子 哈哈哈哈    \n     2014-05-23 13:32 |    \t\t索马里的海贼 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:24        | http://tieba.baidu.com/f?kw=WOW)\t\t \n  @寂寞的瘦子 转账功能没关的话你的1个WB肯定是我的了 XD    \n     2014-05-23 13:33 |    \t\t乐乐、 \t\t\t( 普通白帽子  |\t\t\t        Rank:853 漏洞数:189        )\t\t \n  @索马里的海贼 擦 你有内幕。。。。。    \n     2014-05-23 13:34 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  索马里的海贼\t转账给路人 索马里的海贼\t支出\t-1\t2014-05-23    \n     2014-05-23 13:36 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @索马里的海贼 果然是海盗啊， 从此不敢乱点链接了    \n     2014-05-23 13:37 |    \t\t索马里的海贼 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:24        | http://tieba.baidu.com/f?kw=WOW)\t\t \n  @YY-2012 骗子...我还屁颠屁颠真跑去看WB了...    \n     2014-05-23 13:54 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  还好我点的时候打开的是IE木有自动登陆    \n     2014-05-27 15:59 |    \t\tcnrstar \t\t\t( 普通白帽子  |\t\t\t        Rank:157 漏洞数:23        | Be my personal best!)\t\t \n  @索马里的海贼 大神，你还缺朋友么    \n     2014-05-27 19:15 |    \t\t懒懒滴1994 \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:24        | 偶尔是个乖乖仔，不作恶，世界从来没有安全...)\t\t \n  都中招了？    \n     2014-05-28 00:35 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  哈哈。给力哦    \n     2014-05-28 02:33 |    \t\tT0XD88 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 会写代码的心理咨询师)\t\t \n  点的链接在哪儿？    \n     2014-05-28 04:01 |    \t\t马丁 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:23        | 大爷~给口饭吧。)\t\t \n  @索马里的海贼 我日 WOW吧主也会逛乌云？  果然是大睾丸    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}