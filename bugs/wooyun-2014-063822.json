{"id": 1597, "wybug_id": "wooyun-2014-063822", "wybug_title": "360/加速乐/百度云加速/安全宝等所有waf产品某些条件下绕过", "wybug_corp": "360/加速乐/百度云加速/安全宝", "wybug_author": "sql", "wybug_date": "2014-06-06 23:23", "wybug_open_date": "2014-09-04 23:24", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["产品绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-04：\t细节向公众公开  简要描述： 360/加速乐/百度云加速/安全宝等所有waf产品绕过 详细说明：  测试了下市面上 360/加速乐/百度云加速/安全宝这四个waf产品  在某种条件下均可以绕过 顺利注射出数据库信息。首先我自己搭建了环境 mssql+asp  构造了一个 数字型的报错注入点。http://192.168.1.106:81/asp/num.asp?id=host_name()\n\nhttp://192.168.1.106:81/asp/num.asp?id=user\n\nhttp://192.168.1.106:81/asp/num.asp?id=APP_NAME()\n\n等等 可以根据内置变量爆出很多想要的信息。另外 如果能猜到字段名还可以这样。\n\n爆出了用户名与密码。在测试 做了 360网站卫士/加速乐/百度云加速/安全宝 保护的网站之后对这种情况的注射都 束手无策，全部都放行。这里仅用一例 说明下面是加速乐保护的http://www.cert.org.cn/num.asp?id=username%2b':'%2bpassword\n\n顺利放行。以上所有测试url  这些waf产品均没有拦截广大基友可以根据我抛出的砖发扬一下，弄出更厉害的东西出来。   漏洞证明：  同上   修复方案：  你们看着办   版权声明：转载请注明来源 sql@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-06-11 16:15 厂商回复： CNVD未直接确认，已经转报给360网站卫士、百度加速乐、安全宝等网站防护平台。根据初步反馈情况，涉及统一防护规则，各家都需要避免误拦截，因此对于白帽子所述情况，还需要进一步验证和测试。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-06 23:25 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  mark下睡觉    \n     2014-06-06 23:55 |    \t\t江南的鱼 \t\t\t( 普通白帽子  |\t\t\t        Rank:137 漏洞数:15        | 天生庸才！)\t\t \n  是真实IP绕过吗？Mark下    \n     2014-06-07 00:04 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n  mark    \n     2014-06-07 01:16 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  加速乐本身就会回源的。。不算漏洞吧    \n     2014-06-07 09:06 |    \t\tquanxian \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:2        | This is QuanXian.)\t\t \n  host么    \n     2014-06-07 10:15 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  @蟋蟀哥哥 难道是流量打回源？逗我呢？    \n     2014-06-09 20:51 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @疯子 流量大了，自动回源    \n     2014-06-11 16:30 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  关注一下    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}