{"id": 70937, "wybug_id": "wooyun-2015-0132401", "wybug_title": "湖北某地方政府网站mysql注入getshell", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "3ky7in4", "wybug_date": "2015-08-13 10:47", "wybug_open_date": "2015-09-28 12:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-14：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-08-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-28：\t细节向公众公开  简要描述： 在某个页面存在mysql注入，当前用户是root权限，可以写入一句话木马。可能导致政府相关人员信息泄露 详细说明：     这个站点上，有两个数据库，一个mssql的，一个mysql。mssql的权限控制的很好，同时页面上存在注入点的基本都是mssql注入，另外一个mysql则权限没有细分。是root的权限。1、漏洞页面（mysql）：注入点：http://**.**.**.**/ShowDetail.php?DEPCODE=1\n\n可以看到这里是root权限2、写入一句话木马\n\n3、测试一句话木马是否写入成功\n\n   漏洞证明：  4、菜刀连接一句话木马\n\n5、查看一下当前用户\n\n可以看到是管理员权限，权限很高。6、mssql账号和密码账号：sa密码：1983519mssql这个密码有点简单，希望管理员看到之后进行修改7、mysql账号和密码账号：root密码：jmxzzx.1q2w3e4r8、3389端口开启了，处理一下。webshell地址：http://**.**.**.**/401.phphttp://**.**.**.**/404.php同时存在注入点的地方：1）http://**.**.**.**/ShowDetail.php?DEPNO=1492）http://**.**.**.**/ShowDetail.php?HZBH=15041701016700023)http://**.**.**.**/Cms_Reply.php?Type=20的搜索页面   修复方案：  网站虽然使用了安全狗服务，可是这并不代表自己可以偷懒，全权交给第三方1、请彻查没有那些没有RESET url的页面，那些页面估计是以前旧的，没有修改过来因而大部分都有sql注入的风险2、请使用mysql_real_escape_string过滤传入的查询参数或者表单参数3、建议新建一个mysql 用户，仅仅服务web cms数据库的管理权限   版权声明：转载请注明来源 3ky7in4@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-08-14 12:32 厂商回复： CNVD确认所述情况，已经转由CNCERT下发给湖北分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}