{"id": 45339, "wybug_id": "wooyun-2014-088599", "wybug_title": "有道词典的插件不当导致在选中英文的时候弹cookie", "wybug_corp": "网易", "wybug_author": "憨厚的王小胖", "wybug_date": "2014-12-26 11:52", "wybug_open_date": "2015-03-26 11:54", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-01：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-02-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-26：\t细节向公众公开  简要描述： 360急速浏览器和chrome浏览器，反正是chrome内核的浏览器再装有有道取词插件的时候可以盗取cookie 。用这个插件的，就都有可能出问题。而且。这个绝对不只是自己弹自己。也是可以弹别人的。必须是有道词典那个插件查询了，也就是说在浏览器这里只要选中这段代码就可以触发。 详细说明：  下面是问题代码<p style=\"font-size:12px;\">&lt;img src=1 onerror=alert(6) /&gt;<img src=1 onerror=alert(document.domain) /><img src=1 onerror=alert(document.cookie) /></p>chorme的插件下载地址https://chrome.google.com/webstore/search/%E6%9C%89%E9%81%93%E8%AF%8D%E5%85%B8?hl=zh-CN360急速的下载地址https://ext.chrome.360.cn/webstore/detail/eopjamdnofihpioajgfdikhhbobonhbb关于弹出的cookie和domian，这个要说明一下。这个是当前域名的。也就是你把代码复制在那个页面。那个页面就会弹。而且必须是全选上代码。恩脑补一下场景。就可以说这是史上最全的xss poc。大家快来复制走。然后弹弹下面分别有弹sina 和百度的。其他就不做测试了。\n\n\n\n\n\n\n\n   漏洞证明：  \n\n   修复方案：  这个是浏览器厂商是要禁用这个插件？还是有道那边修？ 这个应该可以通过吧。用这个插件的，就都有可能出问题。而且。这个绝对不只是自己弹自己。也是可以弹别人的   版权声明：转载请注明来源 憨厚的王小胖@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2014-12-29 15:38 厂商回复：  最新状态： 2014-12-29：感谢您对网易的关注，新版本即将上线。  ", "replys": "漏洞评价：\n评论\n     2014-12-26 11:53 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  有点意思    \n     2014-12-26 13:11 |    \t\t乌云小生 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | 活该酱油一辈子)\t\t \n  mark    \n     2014-12-26 13:45 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  有点意思    \n     2014-12-26 15:10 |    \t\tConer \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        )\t\t \n  哈哈，客户端的也有问题，不过插件的有利用价值，    \n     2014-12-29 15:53 |    \t\t憨厚的王小胖 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:1        | 我肯定憨厚啊)\t\t \n  我只是想知道这个插件为啥可以跨域啊。触发xss。是因为搜索没有img 这个词，然后就输出整个xss poc 。可是弹出的域名为啥不是网易的，而是当前页面的域名。不懂。。    \n     2015-01-01 23:43 |    \t\t小森森 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 不中二 枉少年)\t\t \n  @憨厚的王小胖 应该是因为浏览器扩展修改的是当前页面，在当前页面插入了DOM元素和脚本？    \n     2015-01-04 18:38 |    \t\t憨厚的王小胖 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:1        | 我肯定憨厚啊)\t\t \n  @小森森 哦哦，明白了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}