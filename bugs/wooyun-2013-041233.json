{"id": 60982, "wybug_id": "wooyun-2013-041233", "wybug_title": "金立官方商城任意用户收货地址删除", "wybug_corp": "gionee.com", "wybug_author": "带馅儿馒头", "wybug_date": "2013-10-28 10:20", "wybug_open_date": "2013-12-12 10:21", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "敏感接口未加权限认证", "越权操作", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-12：\t细节向公众公开  简要描述： 看了zone里的暴走图，要是来个遍历所有用户的地址都没了！哈哈，听说你们送手机~ 详细说明：  \n哈哈，百密一疏呀，看我如何猥琐的删除任意用户的收货地址~\n1.老规矩，注册两个用户，其中一个用户先添加一个收货地址，见下图；\n\n2.现在给另一个用户添加一个收货地址如下；\n\n3.点击提交，并抓包得到下面的数据；\naddress_id=&consignee=WooYun&mobile=13900139000&tel=&country=1&province=14&city=197&district=1649&address_name=%E4%B8%AD%E5%9B%BD%E6%B9%96%E5%8D%97%E9%95%BF%E6%B2%99%E5%A4%A9%E5%BF%83%E5%8C%BA&address=%E6%B5%8B%E8%AF%95%E6%B5%8B%E8%AF%95%E6%B5%8B%E8%AF%95&zipcode=029000&email=&sign_building=&best_time=\n4.在数据中我们发现有个address_id参数为空，好像有点意思，将其赋值为6999并提交；\n\n5.系统返回了一个TRUE，那么应该提交成功了；\n\n6.返回页面刷新下，发现第二个用户成功添加了一个id为6999的收货地址；\n\n7.再看看第一个用户的情况，发现地址已经被删除了；\n\nPS：那么我们只需要来一个address_id的遍历请求，那么就可以删除所有用户的收货地址了，你说呢？   漏洞证明：  见详细说明   修复方案：  严格校验用户身份的合法性   版权声明：转载请注明来源 带馅儿馒头@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-10-31 17:12 厂商回复： 非常感谢“带馅儿馒头”对金立公司的安全作出贡献 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}