{"id": 55333, "wybug_id": "wooyun-2014-061306", "wybug_title": "iwebshop可让任意用户为我们付款(可配合xss)", "wybug_corp": "iwebshop", "wybug_author": "Hxai11", "wybug_date": "2014-05-18 22:09", "wybug_open_date": "2014-08-16 22:10", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-08-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 不知不觉，我本来不想买的东西就已经发货了，怎么回事？ 详细说明：  首先，本次试验为两个用户，分别为t1 和 t2 这两个用户为了试验，他们两个分别都给了预存1000元如图\n\n好我们开始，首先是用t2是攻击者，t2看中选中商品，之后提交订单\n\n可以看到价格是55，点击立即购买之后再确认订单这里随便填，但是支付方式那里要选预存款支付记得\n\n之后我们确认订单，可以看到加上邮费是一共75我们点确认无误，提交订单\n\n之后我们来到这个页面，但是我们不要提交，将鼠标移动到右上角那个查看订单状态那里可以看到订单编号，我们记录一下是17之后我们用brup截断看看，但记住不要提交\n\n可以看到一串post请求，我们记录下来，但不要提交之后我们随便找个地方测试，比如我在这个网页中嵌入了xss代码，用iframe可以后台执行，将刚刚post上的请求输入到src那里，之后我们保存，退出当前这个t2用户用t1用户登录这个时候看看t1账户信息，1000块没扣。。\n\n好我们这个时候我们已经确认登录上t1了，假设我们t1是个无知的用户，不小心访问到我们黑客已经种下xss的网页就刚刚那个index.html，我们访问看看\n\n表面正常的网页，但是此时此刻，你已经为黑客t2支付了75块，你却毫不知情回到t1账户信息那里看看\n\n看到总金额那里了吗，刚刚的1000变成了现在的925，我们在回到t2，也就是黑客的账户看看\n\n啥都没变，变得只是有人帮我们支付了订单，等待发货就行了。。。   漏洞证明：  \n\n   修复方案：  表单严格   版权声明：转载请注明来源 Hxai11@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}