{"id": 1363, "wybug_id": "wooyun-2014-065714", "wybug_title": "Safari 7.0.4某功能会导致多数XSS防御机制被绕过（有条件）", "wybug_corp": "Apple", "wybug_author": "mramydnei", "wybug_date": "2014-06-21 13:52", "wybug_open_date": "2014-09-16 13:54", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-26：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-16：\t细节向公众公开  简要描述： 折腾了很多次，感觉已经没有进一步加大可行性的空间了还有一个safari8的，先提交这个看看水深 详细说明：   对于URL context的XSS防御，很多厂家都会选择检测URL的开头的字符，比如前七个字符是不是“http://” or 前八个字符是不是\"https://\"。从效果上来看，这种方法到现在还是非常凑效的。 不过由于safari的设计缺陷，当功能“允许在智能栏里使用JavaScript”开启时（我一般都会开启，因为这对我来说便于做一些测试），会导致上述的防御URL context的机制被绕过。\n\n  以mail.qq.com为例，我们现在向受害者写一封邮件，并在内容中填上：\n<a href=\"http://javascript:%0c//mail.qq.com/cgi-bin/frame_html?sid=ajetBhzNxRO3GUAT&r=588c3348231f8ab20df088c03c0a5284'%0aalert(document.domain)\">click me</a>\n  就像上面所描述的那样，由于URL是http://开头的，所以mail.qq.com不会对这段URL进行任何过滤处理。当受害者收到邮件并点击这个Anchor时，我们可以看到这样的画面：\n\n  由于Javascript没有立刻被执行。这里第一个会让人想到的是“我知道，protocol被隐藏了”。按照常理来说应该是那样的，但实际上我们的\"http://\"是被strip掉了。 让我们试着在地址栏里按一下回车：\n\n 从图中可以看到JS在mail.qq.com下被执行了。而对于其它浏览器来说这是根本不可能的。 如果你是一个没有耐心的用户，看页面一片空白，就想着在地址栏里按下回车试图重新加载，这个时候你可能就已经遭受到跨站脚本攻击了。   漏洞证明：  证明如上   修复方案：  暂无   版权声明：转载请注明来源 mramydnei@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-09-16 13:54 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-21 13:54 |    \t\t我是小号 \t\t\t( 普通白帽子  |\t\t\t        Rank:334 漏洞数:51        | Martin)\t\t \n  前排围观    \n     2014-06-21 13:57 |    \t\t残雪 \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:7        | 屌丝一枚擅长扯淡)\t\t \n  出售西瓜    \n     2014-06-21 14:18 |    \t\tMeirLin \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:30        | 号借人)\t\t \n  Mac os下的Safari吗?    \n     2014-06-21 14:21 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  @MeirLin 嗯    \n     2014-06-21 14:28 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  申请cve的节奏。    \n     2014-06-21 16:14 |    \t\tJack.Chalres \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:15        | ..............)\t\t \n  Mark    \n     2014-06-21 16:47 |    \t\t1fn0 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:7        | 我是运维 不要开除我)\t\t \n  Marked  before it is famous     \n     2014-06-22 04:28 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  @D＆G 鸡肋问题而已，哪可能刷CVE    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}