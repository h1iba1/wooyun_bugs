{"id": 12267, "wybug_id": "wooyun-2013-022675", "wybug_title": "有优酷COOKIE，就能获得用户邮箱、用户密码等信息", "wybug_corp": "优酷", "wybug_author": "猪猪侠", "wybug_date": "2013-04-28 15:57", "wybug_open_date": "2013-06-12 15:58", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-12：\t细节向公众公开  简要描述： 优酷某个应用系统的API，在输出用户信息时未进行严格的业务逻辑设计，直接输出了用户的邮箱、用户名、用户密码、用户登录IP等敏感信息。 详细说明：  在浏览器URL栏给http://open.youku.com，页面赋值COOKIE = yktk；\njavascript:document.cookie = \"yktk=1|1366959328|15|aWQ6NzkyLG5uOklydm****%3D%3D|4b78234d9d0ea906ce5fb91978a0****|f6009d674b4e230d5ee5b4b8b4c5fa9d7ca096ff|1\";\n访问如下API：http://open.youku.com/developer/is_login\n{\"errno\":0,\"data\":[{\"email_status\":1,\"uid\":2071704,\"reason\":null,\"status\":0,\"nickname\":\"panzhiqi\",\"bflag\":0,\"from\":null,\"nameCheckStatus\":0,\"ctime\":1319197231644,\"password\":\"06fdf768fb38****c7f9a12d41324425\",\"ip\":\"***.129.39.207\",\"username\":\"panz****\",\"email\":\"panz****@gmail.com\",\"loginIP\":\"218.30.180.177\",\"passKey\":\"581b911f505022b724dddacede9fca70\",\"domain\":\"panz****\",\"tmpEmail\":\"\",\"oldUsername\":null,\"login\":1367118594128,\"password_status\":0,\"nameVersion\":0,\"mobile\":\"\"}],\"errText\":\"\\u6210\\u529f\",\"is_developer\":true}\n这个API将直接返回COOKIE对应用户的大量敏感信息，危害特别严重。   漏洞证明：  用破解出来的密码，直接登录优酷前台。\n\n   修复方案：  不该输出的信息还是尽量不要输出。   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-04-29 11:47 厂商回复： 修复中，谢谢大家。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-29 00:29 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  你妹    \n     2013-04-29 00:30 |    \t\tdiscovery \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | www.google.com)\t\t \n  你妹的    \n     2013-04-29 11:58 |    \t\tSka \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        )\t\t \n  厂商还是反应很快的啊。。。    \n     2013-04-30 06:26 |    \t\tsafe121 \t\t\t( 实习白帽子  |\t\t\t        Rank:98 漏洞数:11        | http://www.gov.cn)\t\t \n  看来是明文？    \n     2013-04-30 20:53 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  @safe121 真相了    \n     2013-05-01 15:10 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  我日，明文密码。。日了日了    \n     2013-05-02 16:39 |    \t\tdiscovery \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | www.google.com)\t\t \n  @蟋蟀哥哥 不是明文，是MD5加密。    \n     2013-05-02 16:47 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  这样的话跨站也是严重级别了吧？    \n     2013-05-02 19:05 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @discovery 一次MD5么?    \n     2013-05-02 22:34 |    \t\tdiscovery \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | www.google.com)\t\t \n  @蟋蟀哥哥 对，就是普通的MD5。    \n     2013-05-02 22:37 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @discovery 那也是明文了。    \n     2013-05-02 22:59 |    \t\tdiscovery \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | www.google.com)\t\t \n  @蟋蟀哥哥 很多直接就破出来了。    \n     2013-05-30 06:44 |    \t\t廷廷 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 有很强的好奇心，爱好广泛，求女女带走。。...)\t\t \n  等到电脑试试    \n     2013-05-31 11:53 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:68        | 潜心学习~~~)\t\t \n  测了，我去暴露了，顶洞主请问洞主，是怎么想到用http://open.youku.com/developer/is_login这个链接看得呢？哪儿跳转过去的啊，表示没找到    \n     2013-06-02 12:11 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:89        | 一名普通的phper开发者，关注web安全。)\t\t \n  漏洞还存在 优酷的人伤不起啊。。密码简单的md5在伤不起！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}