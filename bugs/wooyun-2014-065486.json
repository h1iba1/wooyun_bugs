{"id": 1305, "wybug_id": "wooyun-2014-065486", "wybug_title": "Tipask全版本通杀持久型XSS漏洞", "wybug_corp": "TipAsk", "wybug_author": "wutongyu", "wybug_date": "2014-06-20 17:17", "wybug_open_date": "2014-09-18 17:18", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "7", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "持久型", "源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-20：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-09-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： Tipask问答系统是一款开放源码的PHP仿百度知道程序。以国人的使用习惯为设计理念，采用MVC构架，系统具有速度快，SEO友好，界面操作简洁明快等特点。天极网、戴尔中国、WPS office等大型网站均采用了该系统。 详细说明：  Tipask问答系统在对用户提问的时候允许上传附件类型存在安全隐患：文件 /control/attach.php有如下代码：\nfunction onupload() {        //上传配置        $config = array(            \"uploadPath\" => \"data/attach/\", //保存路径            \"fileType\" => array(\".rar\", \".doc\", \".docx\", \".zip\", \".pdf\", \".txt\", \".swf\", \".wmv\", \"xsl\"), //文件允许格式            \"fileSize\" => 10 //文件大小限制，单位MB        );\n虽是不允许上传html，但是却允许swf上传，那么我们就可以构造一个带有xss代码的swf上传之后访问，就能生成一个持久型的xss了。   漏洞证明：  发表一个问题，然后在上传的地方：上传一个带有缺陷的swf，这里我以swfupload.swf为例，大家都知道 swfupload.swf 老版本存在一个跨站漏洞。so。。\n\n然后构造好访问：\nhttp://localhost/tipask/data/attach/1406/nMHzHAXB.swf?movieName=%22])}catch(e){if(!window.x){window.x=1;alert(/xss/)}}//\n截图证明：\n\n   修复方案：  设置不允许上传swf组件吧。毕竟还是有点威胁的。   版权声明：转载请注明来源 wutongyu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-10-03 01:21 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  这是反射型的    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}