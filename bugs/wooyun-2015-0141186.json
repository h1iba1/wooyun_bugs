{"id": 68619, "wybug_id": "wooyun-2015-0141186", "wybug_title": "微金移动金融服务配置不当可shell", "wybug_corp": "北京微金汇通科技有限公司", "wybug_author": "j1ang_y0u", "wybug_date": "2015-09-15 08:32", "wybug_open_date": "2015-10-30 08:34", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "默认配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-15：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-10-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 码字辛苦，给高rank呗 详细说明：  扫了一下，发现服务器开了6379端口，redis默认端口哈redis默认配置是未授权访问，遇到很大一部分redis服务器都是可以未授权访问redis要getshell需要三个条件\n1．Redis未授权或者弱口令访问2．网站开启web服务3．知道web的路径\n前面两个条件都有了，最后一个条件是最难搞的，要么靠猜，靠报错各种漏洞，要么靠人品，要么就是做个有心人，说不定有所发现哈\n\nlinux，apache，主要是xampp，看着就像和wamp类似的一键搭建php环境的。然后就百度一下，找到这个文章\nhttp://zzjnet.blog.51cto.com/323001/318778\n\n\n看到么，默认路径是/opt/lampp/htdocs,额，好吧，rp不错，这就对了。。。Redis写shell乌云上也有案例无需细讲\n\n马地址\nhttps://42.121.52.97/sec.php\n 密码sec007redis生成的马有点大，可能连接会慢点，又传了一个\nhttps://42.121.52.97/ttt.php\n 密码sec007多个站点沦陷了\n\n随手一翻，数据库密码\n\n数据库连接，可跨库，大量数据库沦陷\n\n帮你扫了一下，在根目录还发现两个马(2011.php和paybill.php)，可能是用注入漏洞进后台或弱口令进后台，因为看了一下不是redis生成的马，而且3月19日那时候redis getshell国内还没火吧。   漏洞证明：  大量数据库暴露，多个站点沦陷，找其中一个实验一下。。站点\nhttps://42.121.52.97/vgoldpay_sharing/\n从sharing数据库中扒一个帐号密码就可登录\n\n   修复方案：  我的3个马sec.php , ttt.php , b374k.php外加早些2个2011.php, paybill.php删除了吧。更改mysql密码吧，这边暴露了，各种管理员弱口令也得更改了Reids放内网吧，或者配置授权访问最低权限原则，别跨目录，跨库了对网站再进行深层马的查杀吧，对系统进行木马查杀，看是否被中了rookit等   版权声明：转载请注明来源 j1ang_y0u@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}