{"id": 6262, "wybug_id": "wooyun-2013-041728", "wybug_title": "突破Sandboxie及其衍生产品", "wybug_corp": "Sandboxie及其衍生产品", "wybug_author": "Arno", "wybug_date": "2013-11-04 15:39", "wybug_open_date": "2014-02-02 15:40", "wybug_type": "非授权访问/认证绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "安全桌面"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-02：\t细节向公众公开  简要描述： 沙箱技术的好处不用多说，现今有些厂商利用沙箱技术实现在终端计算机设备上的“一机两用”甚至“一机多用”的环境，也就是所谓的“安全桌面”，用来防止内部人员有意或者无意泄漏企事业单位机密信息。但沙盒技术的特点是“防外不防内”，“安全桌面”真的可以“防内”么？扯！ 详细说明：  沙箱机制在内存方面的天然安全缺陷，在沙箱内的写操作能够进行隔离(其实现方式是对进程的I/O操作进行分割)，普通的写操作均被控制到沙盒内，对应沙箱外的进程来说，沙箱内的数据是不可见的，不能读取沙箱内的数据。但是沙箱没能实现对普通内存资源分配、读、写进行分割，沙箱内的进程把沙盒内的文件内容读到内存，然后沙箱外的进程通过读取内存来就可以获取到沙箱的内的数据了。   漏洞证明：  通过在沙箱内的程序不停的分配内存，超过操作系统物理内存，操作系统会将内存数据写入虚拟内存分页文件，此文件将明文写入磁盘中。沙箱外程序可以通过读取此文件得到此内存数据，导致沙箱内程序可以通过沙箱外程序的配合，将沙箱内数据写入沙箱外。第一步：将沙箱穿透工具拷贝到电脑随意位置，如本地桌面。该工具分为32位版本（A_B.exe和A_Bfuan.exe）和64位版本（A_B64.exe和A_B64fuan.exe），其中A_B和A_B64运行在本地桌面用于接收穿透的信息，A_Bfuan和A_B64fuan运行在沙箱中用于获取内存信息。第二步：在电脑上安装一个沙箱程序，直接从网上下载Sandboxie，运行后在右下角会生成一个沙箱系统图标。第三步：右键点击沙箱选择浏览保存内容，将沙箱穿透工具A_Bfuan.exe复制到C:\\Sandbox\\Administrator\\DefaultBox\\drive\\C\\tool路径下\n\n\n\n第四步：右键点击沙箱图标选择“运行任意程序”，出现下图界面，选择想在沙箱中运行的程序如notepad.exe。\n\n\n\n第五步：在沙箱打开notepad，填写内容后关闭时命名为test.txt选择保存在桌面。但在本地桌面上无法看到此文件。\n\n第六步：重复第四步，选择运行A_Bfuan.exe进程。如下图。点击“浏览”选中刚创建的test.txt，勾选“new fun”，然后点击“A_FUN”，等待程序提示。\n\n\n\n第七步：在本地系统双击打开A_B.exe，全部默认，直接点击B_FUN即可。运行成功即可在该程序所在目录下生成穿透出来的文件信息，以时间和原文件名命名。\n\n\n\n\n\n这个小工具已发给那个不招女友招php程序员的家伙了（你懂的）。怕被说传播黑阔工具跨省呀，就不提供下载了...   修复方案：  无解。那些用沙箱技术的做“安全桌面”的厂商自省吧，牛B不要吹得太大，会破的...   版权声明：转载请注明来源 Arno@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2013-11-08 22:48 厂商回复： 至8日，该案例仍然在验证中，需要后续进一步确认。暂评rank 12，该绕过方法是否可利用于绕过某些杀软，还需进一步评估。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-09 00:38 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  貌似很牛逼    \n     2013-11-09 22:24 |    \t\ticeyes \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:6        | 老马塞个里！)\t\t \n  @Arno 百度70万职位向你招手！     \n     2013-11-09 22:29 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @Arno 好大的马甲号。    \n     2013-11-19 13:46 |    \t\t静默 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:6        | 安全小白)\t\t \n  又中枪了。。    \n     2013-11-19 13:52 |    \t\tstevenliu \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:2        | 从事信息网络完全)\t\t \n  不会吧 怎么还没公布呢？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}