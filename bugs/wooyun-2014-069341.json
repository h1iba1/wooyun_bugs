{"id": 52985, "wybug_id": "wooyun-2014-069341", "wybug_title": "某网络监管系统SQL注入、信息泄漏、越权小合集", "wybug_corp": "北京中农信达信息技术有限公司", "wybug_author": "sex is not show", "wybug_date": "2014-07-23 19:06", "wybug_open_date": "2014-10-21 19:08", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-31：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-21：\t细节向公众公开  简要描述： 地方政府部门的监管系统，涉及土地、财务、合同等信息。 合集话说能上首页么？现在首页真心难 详细说明：  开发公司：北京中农信达信息技术有限公司（http://www.agrij.com/）程序名称：中农信达农村集体三资网络监管系统漏洞类型：SQL注入、敏感信息泄漏、越权漏洞文件：show_village.jsp?pdm=0101    SQL注入          test11.jsp  输出数据库密码          server.xml 信息泄漏          main.jsp?flag=0 越权访问是否需要登录：否关键字：inurl:login_form.jsp        intitle:中农信达农村集体三资网络监管系统影响用户：百度了几个案例(案例不全)，方便演示：\nhttp://202.99.207.13:8081/finance11n/show_village.jsp?pdm=0101http://124.164.240.217:8080/finance03/show_village.jsp?pdm=0101http://111.12.148.194:7005/finance_qhld/show_village.jsp?pdm=0101http://61.185.74.147:8080/finance67/show_village.jsp?pdm=0101http://nat.nat123.net:11158/finance/show_village.jsp?pdm=0101http://www.cldwcwgk.gov.cn:8083/finance80/show_village.jsp?pdm=0101http://116.255.135.35:8082/finance_glx/show_village.jsp?pdm=0101http://221.131.81.143:7001/finance_oracle/show_village.jsp?pdm=0101\n一、注入：show_village.jsp?pdm=0101 文件的pdm参数存在注入案例1：http://202.99.207.13:8081/finance11n/show_village.jsp?pdm=0101\n\n案例2：http://124.164.240.217:8080/finance03/show_village.jsp?pdm=0101\n\n案例3：http://111.12.148.194:7005/finance_qhld/show_village.jsp?pdm=0101\n\n案例4：http://61.185.74.147:8080/finance67/show_village.jsp?pdm=0101\n\n案例5：http://nat.nat123.net:11158/finance/show_village.jsp?pdm=0101\n\n二、敏感信息泄漏1. server.xml 信息泄漏，数据库等配置信息泄漏http://61.185.74.147:8080/finance67/server.xmlhttp://nat.nat123.net:11158/finance/server.xmlhttp://www.cldwcwgk.gov.cn:8083/finance80/server.xmlhttp://116.255.135.35:8082/finance_glx/server.xmlhttp://221.131.81.143:7001/finance_oracle/server.xml\n\n\n\n不一一截图了2. test11.jsp  输出数据库密码http://61.185.74.147:8080/finance67/test11.jsphttp://nat.nat123.net:11158/finance/test11.jsphttp://www.cldwcwgk.gov.cn:8083/finance80/test11.jsphttp://202.99.207.13:8081/finance11n/test11.jsphttp://221.131.81.143:7001/finance_oracle/test11.jsp部分代码，获得数据库密码输出：\nContext ctx = null;String password=\"\";String errmsg=\"\";    try {            ctx = new InitialContext();            password=(String)ctx.lookup(\"java:comp/env/dbname\");        } catch (NamingException e){            errmsg=e.toString();        }%>数据库：<%=password%><br><%=errmsg%>\n\n\n\n\n\n\n   漏洞证明：  三：越权访问main.jsp?flag=0 越权访问http://111.12.148.194:7005/finance_qhld/main.jsp?flag=0http://61.185.74.147:8080/finance67/main.jsp?flag=0http://nat.nat123.net:11158/finance/main.jsp?flag=0http://www.cldwcwgk.gov.cn:8083/finance80/main.jsp?flag=0http://221.131.81.143:7001/finance_oracle/main.jsp?flag=0\n\n\n\n\n\n\n\n   修复方案：  sql参数过滤测试文件删除加权限控制   版权声明：转载请注明来源 sex is not show@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-07-28 09:50 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过公开联系渠道电话和邮件向软件生产厂商，北京中农信达公司通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}