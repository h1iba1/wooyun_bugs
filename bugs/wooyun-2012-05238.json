{"id": 20561, "wybug_id": "wooyun-2012-05238", "wybug_title": "《程序员》订阅金额漏洞", "wybug_corp": "CSDN开发者社区", "wybug_author": "liu001", "wybug_date": "2012-03-13 17:29", "wybug_open_date": "2012-04-27 17:29", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "2", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-03-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-03-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-03-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-04-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-04-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-04-27：\t细节向公众公开  简要描述： http://vipnews.csdn.net/programmer/pay.aspx?pointid=201101firebug或chrome开起来，可任意修改金额，我相信你懂的由http://www.wooyun.org/bugs/wooyun-2010-05216，联想到的 详细说明：     漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 liu001@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2012-03-14 10:02 厂商回复： 漏洞已经确认，正在修复中 最新状态： 2012-03-14：漏洞已经修复，谢谢！ 2012-04-27：漏洞已经修复，谢谢！  ", "replys": "漏洞评价：\n评论\n     2012-03-13 17:48 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  好吧，蠢爆了，和 WooYun: 顺丰宝业务逻辑漏洞 如出一辙。    \n     2012-03-13 17:59 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @popok 感情是个通用问题呢啊？    \n     2012-03-13 18:04 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @xsser @空虚浪子心 能简单分析下么~~    \n     2012-03-13 18:19 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  @xsser 生成订单时根本没检查金额是否正确，就直接生成并“签名”，跳往支付宝了。这显然是商户自己的问题。    \n     2012-03-13 18:21 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @popok 嗯 这个可以沉淀作为一种很好的漏洞类型了 ：）    \n     2012-03-13 18:38 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  这个NB。学习了。(*^__^*)     \n     2012-03-13 20:43 |    \t\tZ-0ne  \t\t\t( 普通白帽子  |\t\t\t        Rank:559 漏洞数:38        | 目前专注于工控安全基础研究，工业数据采集...)\t\t \n  受教了，非常给力的举一反三    \n     2012-03-13 20:53 |    \t\t黑龙 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:4        | http://bit.ly/zCr8h5)\t\t \n  @xsser 支付漏洞，触目惊心    \n     2012-03-13 22:22 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  这个简要描述得太漏眼了吧。。    \n     2012-03-14 08:59 |    \t\t冰锋刺客 \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:14        | 请在监护人陪同下与本人交流)\t\t \n  1分钱，测试了一份，哈哈    \n     2012-03-14 09:46 |    \t\tpestu \t\t\t( 普通白帽子  |\t\t\t        Rank:170 漏洞数:13        | 关注计算机网络安全 lnmpa技术)\t\t \n  服务器端程序没有判断订单金额就直接生成订单签名发送至支付宝支付网关。像这种固定年费的，根本没必要采用客户端提交的金额，直接在服务器端固定就好。如果像电话卡那种，有好几种面额的，比如20,50,100，在网页上直接以type=a,b,c 代替，支付金额则由服务器端根据用户提交的type决定，交易数据就没法篡改了。    \n     2012-03-14 09:51 |    \t\tpestu \t\t\t( 普通白帽子  |\t\t\t        Rank:170 漏洞数:13        | 关注计算机网络安全 lnmpa技术)\t\t \n  支付前订单做签名，支付网关返回支付结果以后再校验一次。有时候你这里的程序没问题，但是有些小银行可能没有验证你的订单签名就直接支付了，然后返回一个支付成功的状态。。你懂的    \n     2012-03-14 09:55 |    \t\t黑龙 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:4        | http://bit.ly/zCr8h5)\t\t \n  @pestu 可能是为了以后涨价方便，没有在服务器端把金额固定 : )    \n     2012-03-14 09:58 |    \t\tpestu \t\t\t( 普通白帽子  |\t\t\t        Rank:170 漏洞数:13        | 关注计算机网络安全 lnmpa技术)\t\t \n  @黑龙 这个对程序员来说是小case，做个后台设定金额的功能，生成订单的时候直接从数据库读取这个金额    \n     2012-03-14 10:31 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @pestu@黑龙 有些订单是根据用户输入的数量进行确认金额的（比如买sae云豆等），这种情况下就不能搞后台设定金额了。 根本之道只能是再三核对支付金额、订单号等重要信息了（当然如果出现@pestu 说的那种小银行和小支付平台直接返回成功而没有返回成功金额、订单号等那就真得得哭了-_-||）    \n     2012-03-14 10:34 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  漏洞关联：（1） WooYun: 我用5块钱买了10000颗云豆  （2） WooYun: 豆丁网购买豆元后可以将豆元倍增    \n     2012-03-14 10:41 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  漏洞关联：（3） WooYun: 花一分钱给地铁里回收旧报纸的老人订了半年《新京报》    \n     2012-03-14 10:50 |    \t\t黑龙 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:4        | http://bit.ly/zCr8h5)\t\t \n  @pestu 学习了您的云豆漏洞和以上的技术分析，多谢分享！    \n     2012-03-14 11:11 |    \t\t凤凰 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 涅磐)\t\t \n  漏洞关联：（4） WooYun: 顺丰宝业务逻辑漏洞    \n     2012-03-14 11:21 |    \t\tliu001 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 业余捉虫队)\t\t \n  作为一个商户，订单金额能被随便改，真的很不应该尤其还是个技术社区    \n     2012-03-14 12:06 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  才2分？？？技术真不值钱    \n     2012-03-14 18:28 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  @黑龙 更可能是因为为了方便打折，    \n     2012-03-14 18:29 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  @zeracker 那也不是，LZ自己设置的2分    \n     2012-03-14 19:29 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @popok 这是乌云的错，没有把互动和评价体系完善起来    \n     2012-03-14 22:08 |    \t\t瓜瓜 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:25        )\t\t \n  快拍拍测试通过了...    \n     2012-03-15 11:32 |    \t\tliu001 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 业余捉虫队)\t\t \n  @popok 第一次发布，不知道该打几分    \n     2012-04-27 17:46 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  5 6年前玩的东西。现在才兴起，有些悲哀呀！！！！！！    \n     2012-04-27 17:51 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  修复了两次么~    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}