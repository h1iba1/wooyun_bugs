{"id": 41954, "wybug_id": "wooyun-2014-087208", "wybug_title": "金蝶某重要系统sql注入漏洞（多参数配合）", "wybug_corp": "金蝶", "wybug_author": "greg.wu", "wybug_date": "2014-12-15 18:40", "wybug_open_date": "2015-01-29 18:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向公众公开  简要描述： 最近很喜欢从已公开的漏洞中找漏洞，看看哪些厂商修复的时候不够仔细认真。。。 详细说明：  缘起这个漏洞  WooYun: 金蝶网重要分站sql注射漏洞  ，之前报的是显错注入，乍一看厂商好像已经修复了，实际测试之后发现还是可以盲注的，但是需要多参数配合进行注入。漏洞所在分站：http://reg.kingdee.com/getpass.asp产品注册页面，表单提交的数据如下：\n\n由于不知道真实的产品序列号和email，所以没办法定位条件为真时的数据，刚好有两个参数，两个参数都存在注入，所以可以让userid永真，payload为userid=1212121'%0aor%0a'1'='1，这样email就可以正常进行基于and的布尔盲注了。看图：\n\n网站有狗和360webscan，所以sqlmap跑不了，只能手工作业了。判断用户名长度为3：\n\n然后通过email=qq%40qq.com'%0aand%0aascii(substr(SYS_CONTEXT('USERENV','CURRENT_USER'),1,1))=1%0aAND%0a'qX'='qX逐位判断，不多说，大家都懂的。   漏洞证明：  以上，求高分   修复方案：  你懂   版权声明：转载请注明来源 greg.wu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-12-16 11:51 厂商回复： 已经通知研发修复，目前漏洞页面已经删除掉，后期会更换新系统。非常感谢给我们反馈漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-15 20:43 |    \t\tgreg.wu \t\t\t( 普通白帽子  |\t\t\t        Rank:815 漏洞数:99        | 打酱油的~)\t\t \n  我去，这也走小厂商@疯狗    \n     2014-12-16 00:46 |    \t\t黑吃黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:29        | 倚楼听风雨，淡看江湖路...)\t\t \n  @greg.wu 呵呵    \n     2014-12-16 11:28 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @greg.wu 嗯？啥系统我看看。    \n     2014-12-16 11:29 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @greg.wu 能影响到敏感数据么    \n     2014-12-16 11:59 |    \t\tgreg.wu \t\t\t( 普通白帽子  |\t\t\t        Rank:815 漏洞数:99        | 打酱油的~)\t\t \n  @疯狗，必须能啊，可以盲注数据的，已经给出current-user的例子    \n     2014-12-16 12:01 |    \t\tgreg.wu \t\t\t( 普通白帽子  |\t\t\t        Rank:815 漏洞数:99        | 打酱油的~)\t\t \n  @疯狗，管理员不是随便看么，金蝶这个必须大厂商啊    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}