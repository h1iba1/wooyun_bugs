{"id": 45288, "wybug_id": "wooyun-2015-096498", "wybug_title": "某客运网上售票系统设计缺陷导致任意用户密码重置(两种方法)", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-02-10 15:17", "wybug_open_date": "2015-03-27 15:18", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感接口缺乏校验", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-27：\t细节向公众公开  简要描述： 某客运网上售票系统设计缺陷导致任意用户密码重置，可以使用两种不同方法 详细说明：  \n西安公路客运网上售票系统http://www.xaglkp.com/\n前面一个漏洞发现了电子客票遍历预览，打印，可以免费乘车的问题。然后有测试了下其他地方，果然哪还有密码重置问题这里有两个方法重置密码。下面来看第一种方法：首先上一个漏洞我们知道我们遍历用户的电子客票电子客票上有用户名，身份证号，虽然身份照号使用了部分星号，但是这里的星号是用户的生日中的年份，这不就跟没有隐藏一样么\n\n然后来看看找回密码的地方：\nhttp://www.xaglkp.com/Account/Getpwd\n\n\n这里必须输入身份证号和email，其他的任意输入一个就行，我们输入真实姓名，这个因为在电子客票上都有了然后发送请求：\nhttp://www.xaglkp.com/Account/GetpwdAction2usname=&rlname=%E5%88%98%E4%B8%96%E5%AE%81&idcd=612301198705081918&tel=&mail=*********%40qq.com\n\n\n这里的身份证号只需要简单的手工遍历一下就ok了这里最关键的地方就是：只验证了身份证号与真实姓名，没有验证email，所以这里的email可以随便填然后身份证号与真实姓名验证正确，就会把密码发到email里面\n\n来登录一下这个账号：\n\n这里的信息就都泄露了啊~~~第二种方法：在会员信息地方\nhttp://www.xaglkp.com/TicketOrder/UserInfo\n这里可以修改会员信息奇葩的时，这里可以直接发送请求，不用登陆在修改信息时，修改一下用户id就能修改任意会员的信息包括这里的注册名，电话，真实姓名，身份证号码，邮箱，密码无需登录，直接发送请求：\nhttp://www.xaglkp.com/TicketOrder/UserInfoUpdate?abc=saveuserid=14851&regtime=2009-9-28+13%3A54%3A26&usertype=1&status=1&online=1&pwdanswer=&pwdquestion=&username=11111111&telephone=15011111111&truename=11111111&idcard=111111118911111111&useremail=11111111%40qq.com&password=11111111\n然后来登陆一下：\n\nok，全部信息都被修改了。。。   漏洞证明：  \n\n\n\n   修复方案：  验证邮箱，控制权限   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-02-13 10:08 厂商回复： CNVD未直接复现所述情况，按照漏洞报送者所述情况整理通报，转由CNCERT下发给陕西分中心，由陕西分中心后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}