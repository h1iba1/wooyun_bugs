{"id": 48619, "wybug_id": "wooyun-2014-082366", "wybug_title": "淘宝某接口通过文件上传可盗取用户cookies信息", "wybug_corp": "淘宝网", "wybug_author": "路人甲", "wybug_date": "2014-11-07 16:44", "wybug_open_date": "2014-12-22 16:46", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-22：\t细节向公众公开  简要描述： 通过一个上传接口可以上传任意文件，可盗取用户cookies。 详细说明：  该漏洞存在手机旺信发送图片的上传接口中，由于没有限制上传文件类型，虽然JSP等脚本文件不能执行，但可以上传HTML文件，可执行JS代码，进而可以盗取用户cookies等敏感信息！上传接口：POST /ul HTTP/1.1Connection: Keep-AliveContent-Type: multipart/form-data; boundary=2344fcfd9fe0468182661bae96c90690Accept-Charset: utf-8Content-Range: bytes 0-20459/21262User-Agent: Dalvik/1.6.0 (Linux; U; Android 4.0.2; sdk Build/ICS_MR0)Host: slice.wangxin.taobao.comAccept-Encoding: gzipContent-Length: 21584存在漏洞的地方：{\"height\":480,\"to_id\":\"cnhhupanXXX\",\"from_id\":\"cnhhupanXXXX\",\"width\":640,\"msg_type\":0,\"msg_id\":6269103436953812994,\"type\":1,\"suffix\":\"jpg\",\"size\":21262}suffix 就是上传文件类型，可修改文件类型。经测试可以上传html文件，可执行JS代码，利用未深入，应该利用的地方很多。比如盗取用户cookies  制作钓鱼页面，装逼传个黑页上去说淘宝被我黑了，对于淘宝负面影响也不小。   漏洞证明：  写了个上传测试程序http://yunpan.cn/csIwcLgPSLWPm （提取码：f15a）下面两个是我自己上传后的链接：http://interface.im.taobao.com/mobileimweb/fileupload/downloadPriFile.do?type=2&fileId=86a821fd237f976a17a55fb463cb183d.html&suffix=html&width=78&height=26&mediaSize=220\n\nhttp://interface.im.taobao.com/mobileimweb/fileupload/downloadPriFile.do?type=2&fileId=17cc4eedab872ff5a26c19df3010d078.html&suffix=html&width=78&height=26&mediaSize=250一个是测试弹出用户cookies信息的  一个是装逼涂鸦的页面。   修复方案：  限制上传文件类型对用户上传的文件进行检测   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2014-11-10 09:52 厂商回复： 感谢你对我们的支持与关注，该问题我们正在修复~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-07 16:45 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  提走了我部分cookie，哎    \n     2014-12-23 08:02 |    \t\tlaoyao \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:5        | ด้้้้้็็็็็้้้้้็็็็...)\t\t \n  好像听@xsser说过类似的话,预言家！！！，那些可以上传 html的 会不会引来一场 钓鱼 盗cookie的风险    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}