{"id": 20435, "wybug_id": "wooyun-2012-05459", "wybug_title": "中国工商银行迪堡ATM异常处理绕过", "wybug_corp": "中国工商银行", "wybug_author": "Lee", "wybug_date": "2012-03-22 17:33", "wybug_open_date": "2012-05-06 17:34", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-03-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-03-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-04-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-04-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-04-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-05-06：\t细节向公众公开  简要描述： 中国工商银行迪堡系列ATM机器，是基于windows xp系统的自助取款机，型号未知（不支持屏幕触摸），在转账模块中通过某些方式输入非法金额和账号后，由于服务错误绕过ATMC软件直接访问操作系统。 详细说明：  中国工商银行迪堡系列ATM机器，仅测试了编号00021021120904，插入卡后，转账卡号为自身，卡号带“.”，金额带“.”，输入后提示“暂停服务”并且atmc软件通信出错。两次测试均成功触发，怀疑配置问题。DIEBOLD这几年在国外不断爆出bug，最终客户建议让atm工程师查看下log看下错误原因。故此没有用漏洞为标题，怀疑bug。   漏洞证明：  \n\n\n\n   修复方案：  你懂的。00021021120904   版权声明：转载请注明来源 Lee@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2012-03-23 08:37 厂商回复： CNVD未进行实测复现，根据提供的产品名称以及测试图片确认，今天上午通报银监会信息化主管部门处置，应该会有及时的响应。又见Lee同学的大作。CNVD评分评级：(AV:L/AC:L/Au:R/C:N/A:C/I:N/B:N) score:4.27(中危）解释：发起本地攻击、攻击难度低、需要强用户认证（记录银行卡）、对可用性造成完全影响，不影响机密性、完整性。技术难度系数：1.0 (一般，构造畸型数据)影响危害系数：1.0（一般，目前还需要工商银行进行多案例测试）综合评分：4.27*1.0*1.0=4.27对应rank 4. 最新状态： 2012-03-24：回复一下大家的讨论。工行在23号上午也及时进行了反馈，自查流程按产品型号来进行测试，测试方式先行按lee同学给出的构造方式进行。对于流水号的的方式需要另外发送补充说明给工行。关于近期的ATM机绕过或者一些终端机绕过的情况，这个CNVD觉得有必要作个汇总，联合银行业监督管理委员会发布一个行业性的通报，提供必要的技术支持。感谢大家的讨论，有很多关于沙盘、关于虚拟系统的技术方案CNVD正进一步汇总。虽然每个漏洞整体评分不高，但这一系列事件的意义应该说是重大的。  ", "replys": "漏洞评价：\n评论\n     2012-03-22 18:47 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  我擦。昨天在地铁站想玩，妈的，保安盯着。不敢搞    \n     2012-03-22 20:21 |    \t\tCplusHua \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:33        | 乌云奖金:-1)\t\t \n  最近几天，报告好多基于XP系统的终端机漏洞问题    \n     2012-03-23 09:46 |    \t\tLee \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:24        | wataru@eviloctal.com)\t\t \n  @cncert国家互联网应急中心 ATM的编号已经在详细描述里了。可以让工作人员检查下流水号是否是因为这个原因触发了bug。    \n     2012-03-23 09:52 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  这个简要描述貌似和这个漏洞有相似之处，都是非法输入处理异常？： WooYun: 简单入侵中国移动话费充值终端机    \n     2012-03-23 09:53 |    \t\th4k3r \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:5        | 一个普通快乐2B的文艺青年)\t\t \n  用尽一切方法，弹个错误窗口就可以绕过ATM界面了。现在这些终端机不都是这个问题嘛    \n     2012-03-23 09:59 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @h4k3r ORZ，所以这个笑话的改编还是合理的：http://weibo.com/1814392721/yb3fegTqe    \n     2012-03-23 10:01 |    \t\tLee \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:24        | wataru@eviloctal.com)\t\t \n  @horseluke 是非法输入处理异常，但是软件的本身是会进行过滤处理，关键是和招商银行不同的是返回的错误码是通信错误的，错误代码查不到是什么原因（ATM的通信错误不是网络的通信错误，而是软件和ATM机的驱动通信错误）所造成的权限绕过。这里需要反复测试才能定论，怀疑是操作员在操作后门的管理面板忘记锁定用户面板，具体的原因需要银行方面去检测当时的DIEBOLD日志。    \n     2012-03-23 10:04 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @Lee 受教......等公众公开后再仔细揣摩......    \n     2012-03-23 10:15 |    \t\tLee \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:24        | wataru@eviloctal.com)\t\t \n  @h4k3r ATM机器不是那么容易被绕过的。容易绕过的带金属键盘的自助服务机、触屏机。绕过的不是atm，而是atmc及软件。带金属键盘自助服务机、触屏终端50%以上是深圳证通，搞过触屏机见过szzt这个文件夹基本就是，绕过它的方法是比较通用的；紫金是用在atm上比较多，目前的绕过方法都不通用。ATM机器原理性介绍：NCR ATMhttp://wenku.baidu.com/search?word=NCR+ATM&lm=0&od=0&fr=top_search迪堡 ATMhttp://wenku.baidu.com/search?word=%B5%CF%B1%A4+ATM&lm=0&od=0&fr=top_search日立、御银、运通资料较少。    \n     2012-04-02 02:40 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @Lee 学习了。    \n     2012-04-23 11:47 |    \t\tlazze \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | )\t\t \n  @Lee 这样做会不会吞卡那？    \n     2012-04-24 15:22 |    \t\tLee \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:24        | wataru@eviloctal.com)\t\t \n  @lazze 我有被吞过。    \n     2012-04-25 06:26 |    \t\tSnow \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:6        | 换马甲  擦擦擦)\t\t \n  @lazze @Lee  被吞？  还是不要玩了...    \n     2012-05-06 23:06 |    \t\tConcorde \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 不是所有飞机都是可以被人打下来的)\t\t \n  工行的程序猿们有没有想过看看Lee同学的真面目啊= =，通过流水号的时间来查看监控录像    \n     2012-07-26 11:46 |    \t\t小蝎 \t\t\t( 普通白帽子  |\t\t\t        Rank:140 漏洞数:21        )\t\t \n  貌似楼主很喜欢找ATM的问题哦。。。就是喜欢让ATM[try 按、按、按出BUG finally 没按出BUG就取钱逛街去]    \n     2014-04-23 14:16 |    \t\t小贱人 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 资深菜鸟，)\t\t \n  mark    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}