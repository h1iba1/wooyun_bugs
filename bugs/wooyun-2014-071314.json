{"id": 52412, "wybug_id": "wooyun-2014-071314", "wybug_title": "某商业链系统SQL注入漏洞", "wybug_corp": "Cncert国家互联网应急中心", "wybug_author": "sex is not show", "wybug_date": "2014-08-07 13:58", "wybug_open_date": "2014-11-05 14:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-05：\t细节向公众公开  简要描述： RT 详细说明：  开发公司：青岛海信智能商用股份有限公司（http://www.hisense.com）程序名称：供应链管理系统漏洞类型：SQL注入漏洞文件：ScmSup/MaintnPasswd.aspx漏洞参数：tbUserCode、tb_Exml是否需要登录：否关键字：海信供应链管理系统/供应链管理系统. Ver:3.5.5影响用户：几十家吧\n\n搜集一些用户列表\n中泽商业物流供应链管理系统http://123.235.56.106:8080/(S(ygruigzv3w5c2f55zlxcmk45))/ScmSup/MaintnPasswd.aspx中山市及时便利连锁有限公司-供应链管理系统http://125.92.248.29:8888/(S(l4b0tw45zawtsk55atajfn55))/ScmSup/MaintnPasswd.aspx海宁华联供应链管理系统http://218.75.63.158:8001/ScmSup/MaintnPasswd.aspx泰安凌云经贸有限公司供应链管理系统http://221.1.178.18:8080/ScmSup/MaintnPasswd.aspx 招远金都百货供应链管理系统http://221.214.208.51/(S(zgka40n2fydrmibazhstkd55))/ScmSup/MaintnPasswd.aspx鑫利精品生活超市供应链管理系统http://shangjia.jqxlsc.com/ScmSup/MaintnPasswd.aspx东营商业大厦供应链管理系统http://58.57.130.134/ScmSup/MaintnPasswd.aspx青 岛 海 信 广 场http://sup.hisense-plaza.com/ScmSup/MaintnPasswd.aspx星力百货供应链管理系统http://scm.xinglico.com:8888/ScmSup/MaintnPasswd.aspx利客来供应链管理系统http://124.129.157.189:90/ScmSup/MaintnPasswd.aspxhttp://60.209.125.94:8123/ScmSup/MaintnPasswd.aspx乌海市通用时代广场供应链管理系统http://120.193.178.207/(S(jzibo545a1zgogq1rwodti45))/ScmSup/MaintnPasswd.aspx青岛会生活商贸有限公司供应链管理系统http://supply.granvida.cn/(S(axxlwr45iexaqk55abp2wm45))/ScmSup/MaintnPasswd.aspx山东圣豪供应链管理系统http://119.185.1.162:8088/(S(c5grpx55mnz0sp45hrne0p55))/ScmSup/MaintnPasswd.aspx富万家商贸有限责任公司供应链管理系统http://114.135.67.38:81/(S(k3bqrr55hmivwz4505f2j145))/ScmSup/MaintnPasswd.aspx\n用户太多，上面只是一部分代码分析：\nprotected void btnLogin_Click(object sender, EventArgs e){    this._busi = new Hisensoft.SCM.Business.Business();    this._busi.ObjectName = \"tScmSup\";    string searchString = \" LoginID ='\" + this.tb_UserCode.Text.Trim() + \"' And Email='\" + this.tb_Exml.Text.Trim() + \"'\";  ///此处拼接查询条件，为过滤导致注入    if (this.CheckInfo() && (this._busi.ExitRecords(searchString) > 0))    {        this.Session[\"lgid\"] = this.tb_UserCode.Text.Trim();        base.Response.Redirect(\"MakePasswd.aspx\");    }}\n实例演示：1.http://221.214.208.51/(S(bafjzf45z0r3jp55g0g5gz3r))//ScmSup/MaintnPasswd.aspx\n\n\n\n2.http://58.57.130.134/ScmSup/MaintnPasswd.aspx\n\n3.http://125.92.248.29:8888/(S(0wep1gyyx4es5155zrwgloa0))/ScmSup/MaintnPasswd.aspx\n\n   漏洞证明：  4.http://218.75.63.158:8001/ScmSup/MaintnPasswd.aspx\n\n5.http://119.185.1.162:8088/(S(nnx4kifcyutcij55jah0c155))/ScmSup/MaintnPasswd.aspx\n\n   修复方案：  参数过滤or参数化查询   版权声明：转载请注明来源 sex is not show@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2014-08-12 09:19 厂商回复： CNVD确认并复现所述漏洞情况(非首报)，已经由CNVD通过以往处置渠道，向软件生产厂商青岛海信智能商用股份有限公司公开邮箱通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}