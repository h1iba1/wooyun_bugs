{"id": 10322, "wybug_id": "wooyun-2015-0121304", "wybug_title": "某政府建设工程质量监督系统20处SQL注入打包和任意用户密码重置（下篇）", "wybug_corp": "中国建筑科学研究院建研科技股份有限公司", "wybug_author": "独孤求败", "wybug_date": "2015-06-18 11:32", "wybug_open_date": "2015-09-21 08:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向公众公开  简要描述： rt：还有个中篇忘记发了， 详细说明：  某政府建设工程质量监督系统20处SQL注入打包和任意用户密码重置（下篇）。20处SQL注入，包含16处POST注入，4处GET注入。案例如下所示：http://www.ccjdw.com/INFOBLXX.aspxhttp://218.7.239.170:81/INFOBLXX.aspxhttp://www.jljszj.gov.cn/INFOBLXX.aspxhttp://www.thszjz.com/INFOBLXX.aspxhttp://www.spjdz.com/INFOBLXX.aspxhttp://www.ccjdw.com/pkpmbs/jdmanage/TJdSgyuanList.aspxhttp://218.7.239.170:81/pkpmbs/jdmanage/TJdSgyuanList.aspxhttp://www.jljszj.gov.cn/pkpmbs/jdmanage/TJdSgyuanList.aspxhttp://www.thszjz.com/pkpmbs/jdmanage/TJdSgyuanList.aspxhttp://www.spjdz.com/pkpmbs/jdmanage/TJdSgyuanList.aspxhttp://www.ccjdw.com/pkpmbs/jdmanage/TJdShejidanweiList.aspxhttp://218.7.239.170:81/pkpmbs/jdmanage/TJdShejidanweiList.aspxhttp://www.jljszj.gov.cn/pkpmbs/jdmanage/TJdShejidanweiList.aspxhttp://www.thszjz.com/pkpmbs/jdmanage/TJdShejidanweiList.aspxhttp://www.spjdz.com/pkpmbs/jdmanage/TJdShejidanweiList.aspxhttp://www.ccjdw.com/pkpmbs/jdmanage/TJdShentudanweiList.aspxhttp://218.7.239.170:81/pkpmbs/jdmanage/TJdShentudanweiList.aspxhttp://www.jljszj.gov.cn/pkpmbs/jdmanage/TJdShentudanweiList.aspxhttp://www.thszjz.com/pkpmbs/jdmanage/TJdShentudanweiList.aspxhttp://www.spjdz.com/pkpmbs/jdmanage/TJdShentudanweiList.aspxhttp://www.ccjdw.com/pkpmbs/jdmanage/TJdShigongdanweiList.aspxhttp://218.7.239.170:81/pkpmbs/jdmanage/TJdShigongdanweiList.aspxhttp://www.jljszj.gov.cn/pkpmbs/jdmanage/TJdShigongdanweiList.aspxhttp://www.thszjz.com/pkpmbs/jdmanage/TJdShigongdanweiList.aspxhttp://www.spjdz.com/pkpmbs/jdmanage/TJdShigongdanweiList.aspxhttp://www.ccjdw.com/pkpmbs/jdmanage/TJdXmjlList.aspxhttp://218.7.239.170:81/pkpmbs/jdmanage/TJdXmjlList.aspxhttp://www.jljszj.gov.cn/pkpmbs/jdmanage/TJdXmjlList.aspxhttp://www.thszjz.com/pkpmbs/jdmanage/TJdXmjlList.aspxhttp://www.spjdz.com/pkpmbs/jdmanage/TJdXmjlList.aspxhttp://www.ccjdw.com/pkpmbs/jdmanage/TJdZjyuanList.aspxhttp://218.7.239.170:81/pkpmbs/jdmanage/TJdZjyuanList.aspxhttp://www.jljszj.gov.cn/pkpmbs/jdmanage/TJdZjyuanList.aspxhttp://www.thszjz.com/pkpmbs/jdmanage/TJdZjyuanList.aspxhttp://www.spjdz.com/pkpmbs/jdmanage/TJdZjyuanList.aspxhttp://www.ccjdw.com/pkpmbs/manager/userfolderlist.aspxhttp://218.7.239.170:81/pkpmbs/manager/userfolderlist.aspxhttp://www.jljszj.gov.cn/pkpmbs/manager/userfolderlist.aspxhttp://www.thszjz.com/pkpmbs/manager/userfolderlist.aspxhttp://www.spjdz.com/pkpmbs/manager/userfolderlist.aspxhttp://www.ccjdw.com//pkpmbs/portal/InfocontentList.aspxhttp://218.7.239.170:81//pkpmbs/portal/InfocontentList.aspxhttp://www.jljszj.gov.cn//pkpmbs/portal/InfocontentList.aspxhttp://www.thszjz.com//pkpmbs/portal/InfocontentList.aspxhttp://www.spjdz.com//pkpmbs/portal/InfocontentList.aspxhttp://www.ccjdw.com//pkpmbs/portal/InfoContentTreeList.aspxhttp://218.7.239.170:81/pkpmbs/portal/InfoContentTreeList.aspxhttp://www.jljszj.gov.cn/pkpmbs/portal/InfoContentTreeList.aspxhttp://www.thszjz.com/pkpmbs/portal/InfoContentTreeList.aspxhttp://www.spjdz.com/pkpmbs/portal/InfoContentTreeList.aspxhttp://www.ccjdw.com//pkpmbs/portal/YzgcList.aspxhttp://218.7.239.170:81//pkpmbs/portal/YzgcList.aspxhttp://www.jljszj.gov.cn/pkpmbs/portal/YzgcList.aspxhttp://www.thszjz.com/pkpmbs/portal/YzgcList.aspxhttp://www.spjdz.com/pkpmbs/portal/YzgcList.aspxhttp://www.ccjdw.com/pkpmbs//jdmanage/jdprojarchivesmenulist.aspxhttp://218.7.239.170:81/pkpmbs//jdmanage/jdprojarchivesmenulist.aspxhttp://www.jljszj.gov.cn/pkpmbs//jdmanage/jdprojarchivesmenulist.aspxhttp://www.thszjz.com/pkpmbs//jdmanage/jdprojarchivesmenulist.aspxhttp://www.spjdz.com/pkpmbs//jdmanage/jdprojarchivesmenulist.aspxhttp://www.ccjdw.com/pkpmbs//jdmanage/GlobalItmViewOutColList.aspxhttp://218.7.239.170:81/pkpmbs//jdmanage/GlobalItmViewOutColList.aspxhttp://www.jljszj.gov.cn/pkpmbs//jdmanage/GlobalItmViewOutColList.aspxhttp://www.thszjz.com/pkpmbs//jdmanage/GlobalItmViewOutColList.aspxhttp://www.spjdz.com/pkpmbs//jdmanage/GlobalItmViewOutColList.aspxhttp://www.ccjdw.com//pkpmbs/jddoc/googlemap/addProjectLocation.aspxhttp://218.7.239.170:81/pkpmbs/jddoc/googlemap/addProjectLocation.aspxhttp://www.jljszj.gov.cn/pkpmbs/jddoc/googlemap/addProjectLocation.aspxhttp://www.thszjz.com/pkpmbs/jddoc/googlemap/addProjectLocation.aspxhttp://www.spjdz.com/pkpmbs/jddoc/googlemap/addProjectLocation.aspxhttp://www.ccjdw.com//pkpmbs/jddoc/googlemap/AddGPS.aspxhttp://218.7.239.170:81//pkpmbs/jddoc/googlemap/AddGPS.aspxhttp://www.jljszj.gov.cn//pkpmbs/jddoc/googlemap/AddGPS.aspxhttp://www.thszjz.com//pkpmbs/jddoc/googlemap/AddGPS.aspxhttp://www.spjdz.com//pkpmbs/jddoc/googlemap/AddGPS.aspxhttp://www.ccjdw.com/pkpmbs/manager/sysuserlist.aspxhttp://218.7.239.170:81/pkpmbs/manager/sysuserlist.aspxhttp://www.jljszj.gov.cn/pkpmbs/manager/sysuserlist.aspxhttp://www.thszjz.com/pkpmbs/manager/sysuserlist.aspxhttp://www.spjdz.com/pkpmbs/manager/sysuserlist.aspxhttp://www.ccjdw.com//pkpmbs/consmodel/TBpModifyLogList.aspx?ClassName=CESChttp://www.jljszj.gov.cn//pkpmbs/consmodel/TBpModifyLogList.aspx?ClassName=CESChttp://www.thszjz.com//pkpmbs/consmodel/TBpModifyLogList.aspx?ClassName=CESChttp://www.spjdz.com//pkpmbs/consmodel/TBpModifyLogList.aspx?ClassName=CESChttp://218.7.239.170:81//pkpmbs/consmodel/TBpModifyLogList.aspx?ClassName=CESChttp://www.ccjdw.com/pkpmbs/jddoc/iSignature/Signature_DocEdit.aspx?exist=&page=1&ITMID=&CODE=http://218.7.239.170:81/pkpmbs/jddoc/iSignature/Signature_DocEdit.aspx?exist=&page=1&ITMID=&CODE=http://www.jljszj.gov.cn/pkpmbs/jddoc/iSignature/Signature_DocEdit.aspx?exist=&page=1&ITMID=&CODE=http://www.thszjz.com/pkpmbs/jddoc/iSignature/Signature_DocEdit.aspx?exist=&page=1&ITMID=&CODE=http://www.spjdz.com/pkpmbs/jddoc/iSignature/Signature_DocEdit.aspx?exist=&page=1&ITMID=&CODE=http://www.ccjdw.com/pkpmbs/CMQuery/CommonManager/QueryParameterList.aspx?queryid=1http://www.jljszj.gov.cn//pkpmbs/CMQuery/CommonManager/QueryParameterList.aspx?queryid=1http://www.thszjz.com//pkpmbs/CMQuery/CommonManager/QueryParameterList.aspx?queryid=1http://www.spjdz.com//pkpmbs/CMQuery/CommonManager/QueryParameterList.aspx?queryid=1http://218.7.239.170:81//pkpmbs/CMQuery/CommonManager/QueryParameterList.aspx?queryid=1http://www.ccjdw.com/pkpmbs/CMQuery/QueryParameter.aspx?__queryid__=VdCc%2biXrsP0%3dhttp://218.27.1.143//pkpmbs/CMQuery/QueryParameter.aspx?__queryid__=VdCc%2biXrsP0%3dhttp://www.jljszj.gov.cn//pkpmbs/CMQuery/QueryParameter.aspx?__queryid__=VdCc%2biXrsP0%3dhttp://www.thszjz.com/pkpmbs/CMQuery/QueryParameter.aspx?__queryid__=VdCc%2biXrsP0%3dhttp://www.spjdz.com/pkpmbs/CMQuery/QueryParameter.aspx?__queryid__=VdCc%2biXrsP0%3d   漏洞证明：  SQL注入漏洞证明：POST例：http://www.ccjdw.com/INFOBLXX.aspx搜索：单引号注入报错\n\n手工注入：搜索 1' and @@version=1 and '%'=' 报错曝出数据库版本\n\n搜索 1' and db_name()=1 and '%'=' 报错曝出数据库表名\n\nGET注入例：http://www.ccjdw.com//pkpmbs/consmodel/TBpModifyLogList.aspx?ClassName=CESC\n\n\n\n全站任意用户密码重置：越权查看：http://www.ccjdw.com/pkpmbs/manager/sysuserlist.aspx越权修改密码：http://www.ccjdw.com/pkpmbs/manager/modiuserpwd.aspx两处越权综合利用，可修改任意会员密码等其他信息。证明如下：\n\n\n\n\n\n   修复方案：  .....   版权声明：转载请注明来源 独孤求败@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-06-23 08:50 厂商回复： CNVD确认并复现所述情况,根据实测案例,已经转由CNCERT下发给吉林和黑龙江分中心,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}