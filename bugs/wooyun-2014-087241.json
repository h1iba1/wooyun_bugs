{"id": 41941, "wybug_id": "wooyun-2014-087241", "wybug_title": "美团网CSRF可以删除其他用户站内消息", "wybug_corp": "美团网", "wybug_author": "北冥之鱼", "wybug_date": "2014-12-16 11:45", "wybug_open_date": "2014-12-16 14:46", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 美团网CSRF可以删除其他用户站内消息 详细说明：  删除站内消息的post请求没有token,可以进行CSRF来删除他人消息。   漏洞证明：  \n\n   修复方案：  加token   版权声明：转载请注明来源 北冥之鱼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-16 14:46 厂商回复： 感谢楼主的关注，不知道楼主是否有POC提供，如果没有的话，目前我们打算先忽略因为我们前端的CSRF框架对所有非ajax的请求都会验证token，而您提交的这个post请求是ajax的，我们的系统不会有token验证机制因为目前主流的post的csrf利用都是利用form表单远程提交，所以说如果您用form提交的话，服务端会验证token的。而我了解到的目前的浏览器安全机制，是不允许跨域发起ajax的post请求的。至于是否在某些浏览器可以，是否在某些flash漏洞下可以，是否在某些条件比如服务端允许跨域下可以，我们觉得这些不是此漏洞能承受的当然，我们也觉得ajax的请求加上token会让攻击者更难伪造，但由于代码框架的历史原因，我们还没精力做到那么完美，所以目前暂先信任浏览器的安全机制如果楼主或谁可以就此漏洞找到一个让大部分用户在大部分场景都能中招的POC，哪怕是浏览器或flash的漏洞，只要对大部分用户有害，我们一定给最高的RANK 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-16 15:48 |    \t\t美团网(乌云厂商)\t\t \n  我们的服务端是用X-Requested-With:XMLHttpRequest来判断是否是ajax的，chrome下ajax是可以发出post请求，但是跨域的时候貌似设置不了X-Requested-With:XMLHttpRequest    \n     2015-01-24 10:31 |    \t\t蛇精病 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:10        | 你连棒棒糖都没有，还谈什么狗屁爱情？)\t\t \n  厂商好负责任的说    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}