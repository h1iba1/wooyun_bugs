{"id": 18971, "wybug_id": "wooyun-2012-07887", "wybug_title": "”用qq登陆“api接口xss", "wybug_corp": "腾讯", "wybug_author": "random_", "wybug_date": "2012-06-05 13:44", "wybug_open_date": "2012-07-20 13:45", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "持久型", "设计不当导致攻击界面扩大", "腾讯认证", "未正确设置"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-06-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-20：\t细节向公众公开  简要描述： “用qq登录”是一种快捷登录方式。现在很多论坛都使用第三方登陆，如用微博账号登陆、用人人账号登陆、用搜狐账号登陆等。由于qq的平台基础，用qq登陆使用人数最多，dz论坛附带用qq登录功能，使用率很高。 详细说明：  这是一个由应用程序qq.exe导致的网站的xss，而且波及较广。一部分已提交到腾讯漏洞平台，但不被重视，而且反馈很慢。所以就把最新的发现报告给乌云。   漏洞证明：  【证明】\n\n\n\napi地址：http://qzonestyle.gtimg.cn/qzone/openapi/qc-1.0.1.js【举例】豆丁文档用qq登陆导致xss\n\nCNTV\n\n优酷\n\n   修复方案：  对api过滤。对程序昵称转意后保存。   版权声明：转载请注明来源 random_@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2012-06-06 09:41 厂商回复： 非常感谢你的报告，我们已经在解决此类问题 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-05 13:53 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  马    \n     2012-06-05 14:45 |    \t\tAdra1n \t\t\t( 普通白帽子  |\t\t\t        Rank:437 漏洞数:68        )\t\t \n  mark    \n     2012-06-05 18:35 |    \t\tadwin \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:11        | 小菜请多指教。)\t\t \n  马，要火    \n     2012-07-20 14:43 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个很有意思，官方的文档里应该给出一个提示请进行安全过滤，相信很多网站会漏掉吧    \n     2012-07-20 14:53 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:25        | 求各种兼职)\t\t \n  @xsser 第三方网站是调用腾讯js实现的，数据是腾讯自己输出的，应该是由腾讯js自己来过滤最方便，第三方做的话难度太大，而且兼容性差。不过这种都是调用自己的数据，危害小一点    \n     2012-07-20 15:02 |    \t\tCp0204 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:4        | 著名艺术家)\t\t \n  @xsser 我想说的是…这不是自己的资料吗？自己改昵称来跨自己？...    \n     2012-07-20 15:04 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:25        | 求各种兼职)\t\t \n  @Cp0204 只能说危害小，有时候看应用场景    \n     2012-07-20 15:07 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @呆子不开口 不是这样吧，第三方给出了昵称后，应用是要入库的，这就可能产生SQL注射，而如果是要把昵称显示到其他地方就可能导致xss，不过洞主没有把这个逻辑往下走而已    \n     2012-07-20 15:20 |    \t\tCp0204 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:4        | 著名艺术家)\t\t \n  @xsser 明白了，就是说，第三方站的其它用户看你的资料，这样来xss…    \n     2012-07-20 15:26 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Cp0204 别这么想啊 看你资料是一部分 你还可以主动利用其他可能使用昵称的地方啊    \n     2012-07-20 15:49 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:25        | 求各种兼职)\t\t \n  @xsser 我是针对这个漏洞来说的，这个漏洞是用的腾讯的jssdk，这个漏洞是出在腾讯生成的登陆后状态的代码html，看此页，http://wiki.opensns.qq.com/wiki/%E3%80%90QQ%E7%99%BB%E5%BD%95%E3%80%91JS_SDK%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E#2.4._.E6.A3.80.E6.B5.8B.E5.BD.93.E5.89.8D.E7.99.BB.E5.BD.95.E7.8A.B6.E6.80.81 。给网站用户的使用是很简单的代码，<script type=\"text/javascript\">    QC.Login({       btnId:\"qqLoginBtn\"\t//插入按钮的节点id});</script>，所以说用户在这个层面来改的话难度很大，这块得官方自己做比较合适。你说的问题是api接口的问题，jssdk里也有方法，网站可以调用来获得用户信息，当然这个时候数据的安全就得站方自己负责了，如果站方走的自己的注册接口有漏洞的话，那说明他原来的注册接口就是有漏洞的    \n     2012-07-20 15:53 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  人才啊..    \n     2012-07-20 16:10 |    \t\tCp0204 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:4        | 著名艺术家)\t\t \n  @xsser 只是其中一种设想嘛，一般发帖什么的都会展示资料的，场景就丰富了    \n     2012-07-20 16:20 |    \t\t Jesus \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:18        | 天地不仁,以万物为刍狗！)\t\t \n  关注新思维    \n     2012-07-20 17:13 |    \t\tPiaCa \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:10        | 简单点!啪......嚓~~)\t\t \n  这个接口前两天还看到过呢，很多地方都只是进行了js编码，并且没有指定Content-Type，当时只是觉得可以在腾讯某处利用，但是没想到却能够应用到第三方网站，不错    \n     2012-07-20 17:14 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @PiaCa 鄙视不通过乌云报漏洞的人    \n     2012-07-20 17:23 |    \t\tPiaCa \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:10        | 简单点!啪......嚓~~)\t\t \n  @xsser 我有的好不啦，只是最近开了点小差。    \n     2012-07-20 17:28 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @PiaCa 下次见面别怪我不和你打招呼 哼哼    \n     2012-07-20 17:30 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:25        | 求各种兼职)\t\t \n  @PiaCa 你不通过乌云报漏洞的话，你这辈子注定得不到小雪，以后有机会笔者在微博上传授你一些爱情的心得    \n     2012-07-20 17:42 |    \t\tPiaCa \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:10        | 简单点!啪......嚓~~)\t\t \n  @xsser 我今天会在你家门口守着你的。@呆子不开口 少年，小雪是注定不会跟你的，先为你默哀下！    \n     2012-07-20 17:42 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  这个有意思    \n     2012-07-20 20:28 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  ...    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}