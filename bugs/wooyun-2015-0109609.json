{"id": 14679, "wybug_id": "wooyun-2015-0109609", "wybug_title": "东软某系统文件上传导致任意代码执行漏洞(影响众多政务、住房公积金、社保系统数据安全)", "wybug_corp": "东软集团", "wybug_author": "Coody", "wybug_date": "2015-04-22 10:31", "wybug_open_date": "2015-07-21 16:48", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-25：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-21：\t细节向公众公开  简要描述： 还没到公司，就收到同事发来了一则新闻“超30省市曝管理漏洞：数千万社保用户信息或泄露”数千万社保用户信息泄露，吓死人了……身为一名白帽子，有必要为国内信息安全（防止信息泄露）付出努力！ 详细说明：  系统名称：东软通用门户软件 UniPortal 1.2漏洞说明：该系统中某页面存在未授权访问，可上传任意文件（包含jsp脚本），秒杀该系统，影响重大，望 CnCert国家互联网应急中心 敦促修复该漏洞。搜索：inurl:ecdomain在百度收集了部分案例如下(远比下面给出的40个案例多的多)：\n\nmask 区域\n1.http://**.**.**/_2.http://**.**.**/_3.http://**.**.**/_4.http://**.**.**/_5.http://**.**.**/_6.http://**.**.**/_7.http://**.**.**/_8.http://**.**.**/_9.http://**.**.**/_10.http://**.**.**/_11.http://**.**.**/_12.http://**.**.**/_13.http://**.**.**/_14.http://**.**.**/_15.http://**.**.**/_16.http://**.**.**/_17.http://**.**.**/_18.http://**.**.**/_19.http://**.**.**/_20.http://**.**.**/_21.http://**.**.**/_22.http://**.**.**/_23.http://**.**.**/_24.http://**.**.**/_25.http://**.**.**/_26.http://**.**.**/_27.http://**.**.**/_28.http://**.**.**/_29.http://**.**.**/_30.http://**.**.**/_31.http://**.**.**/_32.http://**.**.**/_33.http://**.**.**/_34.http://**.**.**/_35.http://**.**.**/_36.http://**.**.**/_37.http://**.**.**/_38.http://**.**.**/_39.http://**.**.**/_40.http://**.**.**/_*****^*****\n\n给出上传测试的jsp脚本代码如下：\nwooyun.jsp<%out.print(\"just4test....From WooYun.Org\");%>\n   漏洞证明：  漏洞利用：\n\n1）问题链接可从 [测试代码] 区域查看。2）上传时，抓包wooyun.jpg 修改为 wooyun.jsp。3）成功后访问 http://website/ecdomain/portal/webpages/web/网站名称/images/文件名称.jsp4）“网站名称”的获取方法为：打开问题链接\n\n给出几个上传的成功的案例：1）http://www.mzsi.gov.cn/http://www.mzsi.gov.cn/ecdomain/portal/webpages/web/mzsi/images/wooyun.jsp\n\n2）http://www.gslz.lss.gov.cn/http://www.gslz.lss.gov.cn/ecdomain/portal/webpages/web/lzrs20140120/images/wooyun.jsp\n\n3）http://www.lnpj.hrss.gov.cn/http://www.lnpj.hrss.gov.cn/ecdomain/portal/webpages/web/pj/images/wooyun.jsp\n\n更多案例可自行测试：）   修复方案：  0x01:修复未授权访问0x02:限制上传文件的格式（尽量在服务端做验证，并非本地验证）   版权声明：转载请注明来源 Coody@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-04-22 16:48 厂商回复： 非常感谢作者提供的信息，但同时也希望作者能第一时间通知我们。对于该漏洞，我们相关业务部门进行了分析，发现确实存在。由于该基础软件开发时间较早，安全方面考虑不周，导致该漏洞的出现。我们已经安排相关业务部门与客户联系，限期完成补丁的修复。再次感谢作者对于东软应用安全的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-22 10:42 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  目测struts    \n     2015-04-22 10:51 |    \t\t10457793 \t\t\t( 普通白帽子  |\t\t\t        Rank:867 漏洞数:128        | 说好的借，为什么从来不还？O(∩_∩)O)\t\t \n  目测不出来    \n     2015-04-22 10:59 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这个牛！    \n     2015-04-22 11:14 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  这个牛！    \n     2015-04-22 11:28 |    \t\t大大灰狼 \t\t\t( 普通白帽子  |\t\t\t        Rank:248 漏洞数:53        | Newbie)\t\t \n  目测不出来    \n     2015-04-22 11:28 |    \t\tBlunber \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:13        )\t\t \n  这个牛！    \n     2015-04-22 14:14 |    \t\txsser_w \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:33        | 哎)\t\t \n  东软就是个垃圾公司 真的...  写的东西完全不安全 我深刻体会到了    \n     2015-04-22 14:15 |    \t\tan0nym0u5 \t\t\t( 普通白帽子  |\t\t\t        Rank:172 漏洞数:31        )\t\t \n  目测洞主是某数字公司~    \n     2015-04-22 16:55 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  面对大部分cms，苦于没有帐号无法深入    \n     2015-04-22 17:00 |    \t\txsser_w \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:33        | 哎)\t\t \n  @茜茜公主 大神带我飞阿      \n     2015-04-22 17:02 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @东软集团 联系方式在哪里？    \n     2015-04-22 17:05 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  @Coody 自己赞自己哈    \n     2015-04-22 17:06 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @茜茜公主 哈哈哈，被你看出来了    \n     2015-04-23 09:05 |    \t\tboger \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 这个人很懒，什么都没有留下)\t\t \n  这个牛    \n     2015-04-26 13:25 |    \t\tbobbi \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:6        | 人生真是寂寞如雪)\t\t \n  sssss    \n     2015-04-30 16:33 |    \t\tsql小神 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 有些漏洞可以提，有些漏洞不可以提。)\t\t \n  东软集团不好多漏洞的，我们学校的shell上传点大于6处    \n     2015-04-30 16:44 |    \t\t茜茜公主 \t\t\t( 普通白帽子  |\t\t\t        Rank:2360 漏洞数:406        | 家里二宝出生，这几个月忙着把屎把尿...忒...)\t\t \n  @sql小神 你应该把系统外网地址发出来，顺便给个仇人帐号，比如你上铺的兄弟    \n     2015-04-30 16:56 |    \t\tsql小神 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 有些漏洞可以提，有些漏洞不可以提。)\t\t \n  @茜茜公主 茜茜姐，你的想法可以的，我喜欢。    \n     2015-07-22 09:29 |    \t\t酷帥王子 \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:34        | 天朗日清，和风送闲，可叹那俊逸如我顾影自...)\t\t \n  这个牛，赞一个，哈哈，屌屌的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}