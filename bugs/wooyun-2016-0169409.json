{"id": 74441, "wybug_id": "wooyun-2016-0169409", "wybug_title": "中国移动综合资源管理系统（涉及海量数据信息/大量合作单位信息/多达30个数据库）", "wybug_corp": "中国移动", "wybug_author": "路人甲", "wybug_date": "2016-01-13 12:53", "wybug_open_date": "2016-02-27 11:49", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-27：\t细节向公众公开  简要描述：  详细说明：  **.**.**.**/irms/jsp/login.jsp  存在命令执行，但是只能写入jsx的一句话，大马会被杀掉。不知道为什么，找到数据库配置，通过改良办法成功读取数据库，涉及各类信息约合1亿。看来是个大系统，菜刀的数据库读的太慢了，只截取部分作为证明。   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<T>XDB</T> <X> oracle.jdbc.driver.OracleDriver jdbc:oracle:thin:@**.**.**.**:1521cq_irmsCQIRMS#2012irmsdb</X>\n数据库配置\n**.**.**.**/irms/jsp/1.jspx 7\n\nselect t.TABLE_NAME,t.NUM_ROWS from user_tables t order by NUM_ROWS descT_BPM_INTERDATA_4_SUB\t56600672T_BPM_ACTIVITY_DEAL_INFO\t15488839WF_H_WIPARTICIPANT\t10676822WFACTIVITYINST\t4624669WFTRANSITION\t3910673WFTRANSCTRL\t3910612WFWORKITEM\t3259731T_BPM_FORM_REMIND\t2409779T_WFD_RESSERVICE_MAIN\t2408583T_SYS_OP_LOG\t2196761T_BPM_ACTIVITY_INFO\t1789329WFPROCESSINST\t741131T_BPM_FORM_INFO\t730834T_FAM_OVERTIME\t724724T_RES_FAMILYMAINSCHEMA\t709276T_BPM_INTER_LOG\t703606T_BPM_INTERDATA_4_MAIN\t690043T_WFD_RESSERVICE_SUB\t673932T_FAM_CUSTOMER_APPOINTMENT\t664281T_FAM_NET_OPEN\t603114T_BPM_FORM_IFNO_BAK140818\t453669T_FAM_NET_OPEN_BAK140818\t434267T_FAM_NET_OPEN_BAK140526\t381783T_RES_FAMILYMAINSCHEMA_140526\t371476SYN_IRMS_CRM\t235915T_APPOINTMENT_BAK0307\t142041WFWIPARTICIPANT\t140500SYS_LOG\t139557T_FAM_NET_REMOVE\t105386T_BPM_FORM_BAK0309\t73684LOGON_HISTORY\t48583T_DAY_REPORT_INFO\t17208T_BPM_FORM_BAK0904\t14214M_RESATTRIBUTE\t10742M_SCHEME_ATTR\t9150M_SCHEME_ATTR_BAK0329\t9110M_SCHEME_ATTR_BAK\t8276M_RESATTRIBUTE_BAK\t7200T_FAM_NET_REMOVE_TEMP_140928\t3567P_BSN_WORKSHEET429\t3058T_FAM_NET_MOVE\t1724T_FAM_NET_OPEN_TEMP_0903\t1558T_FAM_NET_REMOVE_TEMP_140701\t1496T_WFD_PROCESS_LINE\t1267T_BNS_TRANSLINE_OPEN_POINT\t1253T_WFD_PROCESS_NODE\t1158XCKT_ZYPZ_DEAL_BAK\t950T_FAM_OVERTIME_BAK0614\t950C_NE_INTERNET_LINE\t884T_FAM_NET_MOVE_BAK140526\t867P_BSN_REALVALUE\t823T_WFD_PROCESS_NODE_FORM\t782T_FAM_CUS_APPOINTMENT_BAK0614\t698PBOSS_INT2FIELD_MAPPING\t672M_NE_FLOW\t657T_WFD_SHARE_MAPPING\t656M_SCHEME_CONFIG\t624T_FAM_NET_REMOVE_TEMP_DEL_0928\t621M_SCHEME_INFORMATION\t620M_SCHEME_INFORMATION_BAK\t575T_SYS_CODER\t566T_BNS_POINT_CITY_SURVEY\t566WFPROCESSINSTATTR\t557TC_BSC1_NEW\t548T_WFD_PROCESS_NODE_ROLE\t487T_FAM_NET_OPEN_TEMP_BAK140817\t465T_FAM_NET_OPEN_TEMP_BAK140301\t459P_BSN_WORKSHEET\t452T_WFD_AUTOSER_INPARAM_MAP\t383SYS_LANGUAGE\t368T_WFD_FORM\t366T_FAM_NET_REMOVE_TEMP_BAK\t348SYS_CONFIG_TREE_BAK\t305SYS_MENU\t298GSO_NWD_SCHEME_NWROLE\t287T_WFD_SHARE_FORMITEM\t280T_WFD_PROCESS_DOT\t267T_SERVICE_ASSEMBLE\t237GSO_NWD_NET_SCHEME_DEVICE\t207M_RESCLASS\t201T_WFD_PROCESS_NODE_RESOURCE\t200T_FAM_NET_REMOVE_TEMP_140808\t195SYS_DICTIONARY\t192SYS_CONFIG_TREE\t175T_BPM_INT2FIELD_MAPPING\t165T_BPM_GROUP_USER\t164T_WFD_AUTOSER_MAPPING\t149T_BNS_BUSINESS_ZINFO\t147T_FAM_NET_REMOVE_TEMP_140817\t141T_RES_CATAMANAGE\t137T_WFD_CATAMANAGE\t136SYS_ELEMENT\t130T_BPM_GROUP_USER_BAK130419\t129T_BNS_PHONE_LINE_OPEN\t128T_BNS_BUSINESS_INFO\t126T_WFD_ROLE\t124T_FAM_NET_MOVE_TEMP141231\t124T_WFD_AUTOSER_INPARAM\t124PBOSS_INTERDATA_4_SUB\t118T_BPM_ATTACHMENT\t114GSO_NWD_SCHEME\t96T_TEST_BAK\t94T_TEST_FLOWID\t93T_WFD_PROCESS_INFO\t83C_NE_TRANS_LINE\t83A_APPLY_DETAIL_CIRCUIT\t82TEST_HE\t80C_NE_SPEECH_LINE\t80V_P_无线性能合计_MSC\t78WFPROCESSDEFINE\t77GSO_PD_SCHEME_PIPE_BUDGET\t74GSO_PD_SCHEME_CABEL_BUDGET\t70T_WFD_NODE\t69T_BPM_GROUP_BAK141013\t67WFPROCESSDEFINETEMP\t67T_BPM_GROUP\t67T_BNS_NET_OPEN_BAK\t66T_BNS_NET_BUSINESS_INFO\t64GSO_PD_SCHEME_NWROLE\t62T_FAM_LEADER\t60TEST_JYL_CRM_SERIALNO_140818\t60T_FAM_NETOPEM_TEMPBAK1210\t58GSO_PD_SCHEME_OEQUIP_BUDGET\t57T_BPM_CUSTOM_FORM\t56TC_MSC3_NEW\t55T_BNS_CIRCUIT_OPEN\t55P_BSN_EXPECTATION\t54T_BNS_COMMONLINE_SURVEY\t53REPORT_DIMS\t52T_BPM_PROCESS_RELATIONS\t50T_BPM_TASK_OPERATION\t48T_AREA_CONFIGURE\t47P_RES_REPORT_DATA\t47M_DIAGRAM_CLASS_NETENTER\t47T_FAM_NET_REMOVE_TEMP_140626\t44T_FAM_NET_REMOVE_TEMP_ROOM0808\t44T_FAM_NET_REMOVE_TEMP_140814\t43P_BSN_CUSTOMVALUE\t41T_FAM_NET_REMOVE_TEMP_140723\t41T_CITY\t41EOS_DICT_ENTRY\t40T_BNS_PROVINCE_TRANSSURVEY\t38WARN_COMPANY\t38T_COMPANY_INFO_150130\t38T_RES_ITMS_VLAN\t38T_COMPANY_INFO\t38GSO_TEMPLATE_DICT\t38T_BNS_COMMONLINE_SURVEY_BAK\t37A_APPLY_OPEN_DETAIL\t37T_BNS_NET_OPEN\t36T_FAM_NET_REMOVE_TEMP_ROOM0723\t36T_COMPANY_INFO_BAK20140305\t36T_BNS_PHONE_BUSINESS_INFO\t34GSO_PD_SCHEME\t31SYS_ELECLASS\t30T_FAM_NET_REMOVE_TEMP_ROOM0814\t29GSO_NWD_SCHEME_DEVICE\t28T_BNS_LINE_SURVEY\t27T_RES_ITEM\t27T_BNS_CHECKDATA\t27GSO_NWD_SCHEME_CABEL_CON\t26T_FAM_EXPANSION\t26T_EXPANSION_CELL\t26T_WFD_CUSTOM_FORM_COMP\t26REPORT_REPORT\t26T_SYS_PRO_DICTIONARY\t25M_SCHEME_FLOW\t25T_FAM_MAINTAIN\t23T_WFD_NODE_ROLE\t21T_WFD_NODE_RESOURCE\t21O_OPERATOR\t20T_BNS_PROVINCE_TRANS\t20T_WFD_AUTOSER_SERVICE\t18T_BNS_LINE_SURVEY_BAK\t18T_BNS_PHONE_LINE_OPEN_BAK\t17T_BPM_FORM_CONF\t17T_BPM_FORM_DIS_CONF\t17T_BNS_TRANSLINE_OPEN\t16P_WRK_URLSETUP\t16CIRCUIT_INDEX\t15REPORT_DIR\t14REPORT_PICS\t13RMS_CITY\t13T_RES_BROADBAND_CVLAN\t13C_NE_REGION\t12WF_H_PROCESSINSTATTR\t11T_WFD_NODE_FORM\t11T_RES_VOICE_PORTNUMBER\t10REGION_CIRCUIT_OPEN_APPLY\t10GSO_TEMPLATE_DIC_ROOMTYPE\t9M_SCHEME_INFO\t9REGION_CIRCUIT\t9EOS_UNIQUE_TABLE\t8M_RELATION\t8M_SCHEME_RELACLASS\t8EOS_DICT_TYPE\t8GSO_TEMPLATE_DIC_RO0MTYPE\t8T_BPM_RELATIONS_OPEN\t8T_WFD_CUSTOM_FORM\t8P_NET_WORKSHEET\t7WFSYSTEMINFO\t7T_BPM_TASK_DISPATCH\t7T_BPM_QRTZ_CUSTOM\t7REPORT_KPITABLECOLOR\t6T_RES_ACCESSINFO\t6T_EXPORTFIELD\t6T_RES_SCHEMEINFODESIGN\t5T_BNS_BS_OPEN\t5M_SCHEME_STEP\t5T_BPM_QRTZ_LOCKS\t5GSO_TEMPLATE_DIC_EQUIPMENTYPE\t5WFBIZ_CATALOG_INFO\t5GSO_TEMPLATE_DIC_LINETYPE\t4T_BPM_FORM_DIS_CONF_CHILD\t4WFBIZ_VAR_INFO\t4O_ORG\t4P_RES_REPORT_MAIN\t4WFBIZ_VAR_INST\t3T_RES_BROADBAND_SVLAN\t3T_ORDER_SIZE\t3WFBIZ_HUMANTASK_INST\t3WFBIZ_HUMANTASK_INFO\t3UPLOADFILE\t3T_RES_SCHEMESUMMARY\t3PBOSS_INTER_LOG\t3PBOSS_BUSINESS_MAIN\t3ANNOUNCEMENT_MAIN\t3REPORT_GROUP\t2T_RES_BUSINESSTEMPLATERULE\t2REPORT_SORT\t2T_SYS_USERACCOUNT_PERRIOD\t2M_SCHEME_ATTR_LOCAL_BAK\t2PBOSS_INTERDATA_4_MAIN\t2GSO_TEMPLATE_DIC_NWROLE\t2T_RES_VLANRULE\t2REPORT_KPIFILTERS\t2WLGJ_MIDDLE\t1T_FAM_NET_OPEN_TEMP\t1T_RES_USERIDRULE\t1MESSAGE_INFO\t1T_SYS_MAX_ONLINE\t1T_RES_AUTH_MW_REGION_MAPPING\t1T_BNS_PHONE_LINE_RECOVER\t1T_RES_POSPORTRULE\t1T_EXPORT_SIZE\t1WFBIZ_CALENDAR_INFO\t1WFBIZ_OPERATION_INST\t1WFBIZ_OPERATION_INFO\t1M_SCHEME_ATTR_LOCAL\t1T_BNS_BS_ADJUST\t1P_BSN_WORK\t1T_RES_FLOW\t1T_RES_CHECKEDIT\t0T_RES_CIRCUIT_APPLY\t0T_RES_CIRCUIT_APPLY_INFO\t0T_RES_CIRCUIT_PORT_INFO\t0T_RES_CONFIG_TASKS\t0T_RES_CORE_CONFIG\t0T_RES_CUSBUSDATAMAKE\t0T_RES_CUSTOMDEVICEINSTAL\t0T_RES_CUSTOMEQUIPDATAMAKE\t0EXPENSECHECK\t0GSO_PD_SCHEME_EQUIP_BUDGET\t0GSO_TEMPLATE\t0GSO_TEMPLATE_DIC_OP\t0GSO_TEMPLATE_LINE\t0GSO_TEMPLATE_NETYPE\t0GSO_TEMPLATE_NWROLE\t0OR_PROPERTIES\t0O_CONTACTS\t0T_BNS_BS_BELONGS\t0T_BNS_BS_OPEN_BDCOM\t0T_BNS_BS_OUT\t0T_BNS_BS_STOP\t0T_BNS_BTS_IN\t0T_BNS_CIRCUIT_CLOSE\t0T_BNS_COMMONLINE_SURVEY_TEMP\t0T_BNS_CONSTRUCT_OPEN\t0T_BNS_CORE_NE_ADJUST\t0T_BNS_CORE_NE_CUTOVER\t0T_BNS_CORE_NE_DEBUG\t0T_BNS_MMS_OPEN\t0T_BNS_MMS_RECOVER\t0T_BNS_MMS_REMOVE\t0T_BNS_MMS_SERVICEHALT\t0T_BNS_NEW_CELL_IN\t0T_BNS_OPTICAL_CLOSE\t0T_BNS_OPTICAL_OPEN\t0T_BNS_PHONE_LINE_ADJUST\t0AQUA_EXPLAIN_18352846\t0TMP_TEST14\t0AQUA_EXPLAIN_127850000\t0T_FAM_TEMP\t0AQUA_EXPLAIN_177519136\t0T_FAM_RESOURCE_CHANGE\t0T_FAM_RESOURCE_CHANGE_TEMP\t0AQUA_EXPLAIN_162348662\t0AQUA_EXPLAIN_145640704\t0AQUA_EXPLAIN_143849700\t0AQUA_EXPLAIN_138602915\t0AQUA_EXPLAIN_134894201\t0T_WARN_INFO\t0AQUA_EXPLAIN_5821044\t0T_RES_C_GRE_INFO\t0T_RES_DUCTDEGS\t0T_RES_FLOW_ATTRIBUTE\t0T_RES_GX_SIGRECORD\t0T_RES_HLR_INFO\t0T_RES_LOG\t0T_RES_MESSAGEINFOS\t0T_RES_MMSCONFIGINFO\t0T_RES_OLT\t0T_RES_OPTICALPATH_APPLY\t0T_RES_OPTICS\t0T_RES_P_GRE_INFO\t0T_RES_RESOURCE_CONFIG\t0T_RES_RESOURCE_STATUS\t0T_RES_SCHEMEDESIGN\t0T_RES_SCHEMEQUIPINFO\t0T_RES_SDH_NE\t0T_RES_SMSCONFIGINFO\t0T_RES_TOPO_EQUIP\t0T_RES_VOICEDATAMAKE\t0T_RES_VOICE_PORTINTEGER\t0T_WFD_AUTOSER_REPARAM\t0T_WFD_AUTOSER_REPARAM_MAP\t0V_P_无线性能合计_BSC\t0WFAGENT\t0WFAGENTITEM\t0WFAGENTSCOPE\t0WFAUDITRECORD\t0WFBIZMAPPING\t0WFBIZ_CALENDAR_DETAIL\t0WFBIZ_CALEPARTI_RELATION\t0WFBIZ_CATAPERM_RELATION\t0T_BNS_SMS_OPEN\t0T_BNS_SMS_RECOVER\t0T_BNS_SMS_REMOVE\t0T_BNS_TRANSLINE_OPEN_BAK\t0T_BNS_TRANSLINE_OPEN_TEMP_BAK\t0T_BNS_TRANSLINE_REMOVE\t0T_BNS_TRANSLINE_SERHALT\t0T_BNS_TRANSLINE_SURVEY\t0T_BPM_ACTIVITY_CONF\t0T_BPM_ACTIVITY_PROC_CONF\t0T_BPM_ATTACHMENT_ARCHIVE\t0T_BPM_QRTZ_BLOB_TRIGGERS\t0T_BPM_QRTZ_CALENDARS\t0T_BPM_QRTZ_CRON_TRIGGERS\t0T_BPM_QRTZ_FIRED_TRIGGERS\t0T_BPM_QRTZ_JOB_DETAILS\t0T_BPM_QRTZ_PAUSED_TRIGGER_GRPS\t0T_BPM_QRTZ_SCHEDULER_STATE\t0T_BPM_QRTZ_SIMPLE_TRIGGERS\t0T_BPM_QRTZ_TRIGGERS\t0T_BPM_STAGE_DEAL\t0T_BPM_TASK_COOPERATION\t0T_BPM_TASK_TRANSCRIBE\t0T_BPM_TEMPSAVE\t0T_NE_EQUIPROOM_PROFESSEQUIP\t0T_RES_ADD_RECORD\t0T_RES_APN_INFO\t0T_RES_BOSES_ONU\t0T_RES_BOUNDARY\t0T_RES_BTS_CHECK_DETAIL\t0T_RES_BTS_CHECK_STANDARD\t0T_BNS_PHONE_LINE_OPEN_TEMP\t0T_FAM_NET_REMOVE_TEMP\t0PLSQL_PROFILER_UNITS\t0T_FAM_OVERTIME\t0T_FAM_LN_NET_OPEN\t0EOS_DICT_ENTRY_I18N\t0EOS_DICT_TYPE_I18N\t0EOS_SERVICE_ENDPOINT\t0EXPENSEINFO\t0REPORT_PUBLISHDIMS\t0PBOSS_BUSINESS_SUB\t0T_FAM_NET_MOVE_TEMP\t0PLSQL_PROFILER_DATA\t0PLSQL_PROFILER_RUNS\t0REPORTS_CHARTS\t0SYS_PORTLET\t0SYS_USER_CONFIGURE\t0T_BNS_NET_OPEN_TEMP\t0T_BNS_NET_RECOVER\t0T_BNS_NET_REMOVE\t0T_BNS_NET_SERVICEHALT\t0T_BNS_RRU_OPEN\t0T_BNS_SMS_ADJUST\t0T_BNS_SMS_SERVICEHALT\t0T_BNS_TRANSLINEBUS_INFO\t0T_BNS_GPRS_RECOVER\t0T_BNS_GPRS_REMOVE\t0T_BNS_GPRS_SERVICEHALT\t0T_BNS_LINE_SURVEY_TEMP\t0T_BNS_MMS_ADJUST\t0T_BNS_NET_ADJUST\t0T_BNS_PHONE_LINE_REMOVE\t0T_BNS_PHONE_LINE_SERVICEHALT\t0T_BNS_TRANSLINE_ADJUSTMENT\t0T_BNS_TRANSLINE_CIRCUIT\t0T_BPM_QRTZ_TRIGGER_LISTENERS\t0T_BNS_CORE_NE_OUT\t0T_BNS_CORE_NE_STOP\t0T_BNS_GCB_OPE_SOUND_TEMP_2\t0T_BNS_GPRS_ADJUST\t0T_BNS_GPRS_OPEN\t0T_BNS_TRANSLINE_OPEN_TEMP\t0T_BNS_TRANSLINE_RECOVER\t0WFBIZINFO\t0T_BPM_QRTZ_JOB_LISTENERS\t0WF_H_ACTIVITYINST\t0WFBIZ_RES_RELATION\t0AQUA_EXPLAIN_1382920\t0AQUA_EXPLAIN_1423910\t0ACCOUNTINFO\t0REPORT_DATASOURCE\t0REPORT_PARAMETER\t0REPORT_PUBLISHDEFINE\t0REPORT_PUBLISHOFFLINE\t0REPORT_PUBLISHSUBSCRIBE\t0WFBIZ_RULE_INFO\t0WFBIZ_RULE_INST\t0WFPERSONINFO\t0WFTIMER\t0WF_H_BIZINFO\t0WF_H_PROCESSINST\t0WF_H_TRANSCTRL\t0WF_H_TRANSITION\t0WF_H_WORKITEM\t0\n数据库结构   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2016-01-15 18:15 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国移动集团公司通报,由其后续协调网站管理部门处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}