{"id": 3327, "wybug_id": "wooyun-2014-060316", "wybug_title": "SAE用户越权操作随机用户代码仓库", "wybug_corp": "新浪", "wybug_author": "路人甲", "wybug_date": "2014-05-11 18:16", "wybug_open_date": "2014-06-25 18:16", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["越权操作", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-25：\t细节向公众公开  简要描述： SAE用户越权操作随机用户代码仓库，可导致平台大量随机用户的某版本应用无法使用。 详细说明：  诶，问题描述不敢多写啊，怕看了标题和描述就猜到了，影响平台用户使用呀~嘿嘿。   漏洞证明：  进入SAE控制面板\n\n在代码管理中，创建一个新版本，并获取其VerID\n\n为了不对正常用户的使用造成影响，我们这里使用一个用户A创建一个代码仓库，其版本ID为977091，该ID将作为将要被其他用户删除的VerIDHacking Start…….(^_^)使用一个新的用户身份登录系统，并随机找到一个应用，点击删除操作，并截取数据包，修改VerID为随机的版本库ID（此处为不影响正常用户，修改为用户A的版本ID 977091）\n\nApp_id=my***，为用户B的应用，VerId为用户A刚刚创建的应用。提交该请求之后提示【删除成功】，由于bootstrap的那个窗口很快就关闭了，没来得及截图删除成功的提示窗口。此时再到用户A得到代码管理位置看代码仓库的版本，发现已经被删除了。\n\n此时再查看用户管理记录，发现【管理记录】中有删除这个应用版本的用户的安全邮箱，但是这个用户真真的不是应用管理员啊！！！！！呜呜~~\n\n--------------------------------------------------割----------------------------------------------然后如果在删除应用的地方，遍历VerId，应该可以将SAE上所有用户的版本库删掉吧？！！这个没试，危害性太大，理论上是可行的。--------------------------------------------------割----------------------------------------------   修复方案：  对用户权限的校验不应该只校验app_id，如果是全局id比如VerId也应该做校验；或者前后台对ID进行转换对应，比如前台app_id和用户自己的版本号user_ver_id对应数据库全局用户的VerId.[不知道说得清不清楚，我不是做开发的~~~~ ^_^]SAE是国内起步最早的App Engine，是率先支持PHP Runtime的云计算提供商，相对于国内其他App Engine，SAE拥有更大的优势和更好的稳定性，希望越做越好！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-05-12 10:03 厂商回复： 感谢关注新浪安全，目前漏洞已经修复上线 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-11 18:42 |    \t\tHaswell \t\t\t( 普通白帽子  |\t\t\t        Rank:167 漏洞数:18        | HorizonSec @ RDFZ)\t\t \n  前排(O_O)    \n     2014-05-11 19:18 |    \t\t坠落。 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | -.- 屌丝一枚,菜鸟一个,擅长windows/linux...)\t\t \n  卧槽      \n     2014-05-11 20:00 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  有没有试试wooyun    \n     2014-05-11 20:24 |    \t\txyang \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:51        | stay hungry stay foolish)\t\t \n  --    \n     2014-05-11 20:30 |    \t\tMr .LZH \t\t\t( 普通白帽子  |\t\t\t        Rank:583 漏洞数:75        | 非妹子勿扰···)\t\t \n  把wooyun拖了的节奏啊    \n     2014-05-11 21:13 |    \t\tFire ant \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:26        | 他们回来了................)\t\t \n  我草   我的站    \n     2014-05-11 21:47 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  我去，这个算不算通用型加精的漏洞？    \n     2014-05-11 22:06 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  这个看标题好高端啊    \n     2014-05-11 22:08 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  我怎么感觉是强大的google把链接给爬了....    \n     2014-05-12 10:17 |    \t\t新浪(乌云厂商)\t\t \n  路人甲怎么发礼物啊,    \n     2014-05-12 10:32 |    \t\tCplusHua \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:33        | 乌云奖金:-1)\t\t \n  @新浪 厂商是不是都送大眼睛啊，雨伞啊，便签纸啊，哈    \n     2014-05-12 15:01 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @新浪 路人甲的礼品发到wooyun，本楼回复的抽奖@xsser @疯狗    \n     2014-05-12 15:24 |    \t\t香草 \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:14        | javascript,xss,jsp、aspx)\t\t \n  这个一定要加精    \n     2014-05-12 17:52 |    \t\tCplusHua \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:33        | 乌云奖金:-1)\t\t \n  @一刀终情 我的礼物。。。    \n     2014-05-12 18:41 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  擦！擦擦！！    \n     2014-06-02 22:55 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @疯狗 狗哥，为何擦？难道乌云牺牲过……    \n     2014-06-25 19:51 |    \t\t铁蛋火车侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:31        | Q群371620085 技术交流群 有漂亮妹纸！)\t\t \n  路人甲的礼品请发给我    \n     2014-06-25 20:11 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  居然还会有这等洞。吓    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}