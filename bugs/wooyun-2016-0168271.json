{"id": 74268, "wybug_id": "wooyun-2016-0168271", "wybug_title": "华润燃气某系统漏洞（涉及近百万工单/涉及大量维修记录以及内部信息/涉及三个数据库/探测内网）", "wybug_corp": "华润燃气(集团)有限公司", "wybug_author": "路人甲", "wybug_date": "2016-01-08 09:44", "wybug_open_date": "2016-02-22 16:48", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向公众公开  简要描述：  详细说明：  http://27.17.7.236  存在命令执行，通过读取配置文件发现是华润燃气郑州市，存在多个APP下载界面，通过对数据库配置，发现三个库，大量数据外泄，可入综合内网具体情况看截图，数据过多，只截取部分作为证明，   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n<url>jdbc:oracle:thin:@172.22.3.10:1521:cisalpha</url>    <driver-name>oracle.jdbc.OracleDriver</driver-name>    <properties>      <property>        <name>user</name>        <value>gas_ia</value>      </property>    </properties>    <password-encrypted>{AES}EPm+fsxb8xLBgm4wLhIRlgHt0s5RVhdVafcizyuMnnA=</password-encrypted>    <url>jdbc:oracle:thin:@172.22.3.10:1521:cisalpha</url>    <driver-name>oracle.jdbc.OracleDriver</driver-name>    <properties>      <property>        <name>user</name>        <value>lspf_bpm</value>      </property>    </properties>    <password-encrypted>{AES}hjOiF7aUu3IhfGyVoSfkuu9+kg+lBeMQZSBoCADmGmM=</password-encrypted> nkuB_VJ9P-KG2D    <url>jdbc:oracle:thin:@172.22.3.10:1521:cisalpha</url>    <driver-name>oracle.jdbc.OracleDriver</driver-name>    <properties>      <property>        <name>user</name>        <value>lspf_support</value>      </property>    </properties>    <password-encrypted>{AES}rTG4WHhLu2aUHQ/bedLAy3Q/qqhzr++gafiJ1C9CpmI=</password-encrypted>  rkJX_8TYW-8AIJ  <jdbc-driver-params>    <url>jdbc:oracle:thin:@172.22.3.10:1521:cisalpha</url>    <driver-name>oracle.jdbc.OracleDriver</driver-name>    <properties>      <property>        <name>user</name>        <value>bsp</value>      </property>    </properties>    <password-encrypted>{AES}OnCaoqHGtt9ReKP2HQGKf8PPYGyxde8N42dX6g1JeX0=</password-encrypted>  ZUkI_T59N-RW0K\n数据库配置以及解密的密码\nQuery#0 : select t.TABLE_NAME,t.NUM_ROWS from user_tables t order by NUM_ROWS descTABLE_NAMEVARCHAR2\tNUM_ROWSNUMBERT_CS_AREA_SEARCH\t PF_LANG\t PF_LANG_TYPE\t TAB_PF_DUTY_OBJECT_RELA\t682000PF_DUTY_OBJECT_RELA\t318950PF_TD_EXT_LOG\t89968PF_DUTY_OBJECT_RELA_0518\t83270PF_TD_FIRED_TRIGGERS_HIS\t81765PF_ONLINE_USER\t52860PF_OBJECT_EXTEND\t52615PF_DUTY_FUNCTION_GROUP_RELA\t35630PF_DUTY_OBJECT_RELA_ZS0325\t26120PF_FUNCTION_GROUP_OBJECT_RELA\t26058TMP_FUNCTION_GROUP_OBJECT_0516\t24548TMP_PF_DUTY_OBJECT_R\t8714PF_STAFF_ZS0505\t6533PF_ACCOUNT_0330\t6195PF_ACCOUNT_DUTY_RELA_0413\t5859PF_FUNCTION_GROUP_OBJ_RELA_ZS\t5354PF_OBJECT\t4447PF_CODE\t3987PF_DUTY_ORG_RELA\t3531PF_ACCOUNT_DUTY_RELA\t3433PF_DUTY\t3425TAB_PF_ACCOUNT_DUTY_RELA\t3264PF_ACCOUNT_DUTY_RELA_ZS0505\t3258PF_ACCOUNT_DUTY_RELA_GHF\t2926SP_LOG\t2214PF_ACCOUNT_ZS0325\t2201TAB_PF_DUTY_ORG_RELA\t2188PF_DUTY_ORG_RELA_ZS0505\t2181PF_STAFF_ORG_ORGRELATYPE_RELA\t1483PF_ORG_RELA_ZS0505\t1445PF_DUTY_0505\t1344TAB_GHF0521\t1295DUTY_GROUP_TMP\t1295TMP_DUTY_IMP\t1172TMP_PF_DUTY_FUNCTION_GROUP_R\t1132PF_ACCOUNT_INNER_ROLE_RELA\t1076PF_STAFF_ORG_ORGRELATYPE_ZS\t981PF_DUTY_ORG_RELA_GHF\t960PF_DUTY_ORG_RELA_TMP\t960TAB_DD\t960PF_ORG_ZS0505\t920PF_ORG_RELA\t899SP_QUERY_CONT_DEF_REQ_LOG\t892SP_GRID_MODEL_LOG\t730PF_FUNCTION_GROUP\t716PF_STAFF\t702TAB_PF_DUTY\t674PF_DUTY_GHF\t664PF_MENU\t654PF_ACCOUNT\t634DATAPUSH_DATA_USERS\t629PF_CODE_SORT\t572PF_MENU_BAK_20150122\t525PF_PARAM_ACCESS_LEVEL_CONTROL\t522PF_USER_PROFILE\t491PF_ORG_GHF\t459TAB_ORGTMP\t457PF_ORG_RELA_GHF\t457PF_ORG\t436SP_GRID_COL_CFG\t350SP_QUERY_PARA_DEF_REQ_LOG\t325SP_QUERY_CONT_DEF\t319PF_MSG_SEND_HISTROY\t300PF_REPORT_TYPE\t249TMP_FUNCTION_GROUP_0516\t215PF_PARAM\t164TAB_DUTY_TMP\t161TMP_PF_DUTY_ORG_R\t144TMP_PF_DUTY\t144SP_QUERY_PARA_DEF\t132PF_HOLIDAY_CODE\t132SP_QUERY_USELOG\t130PF_REPORT_SORT\t129PF_MSG_RCV\t104PF_MSG_RCV_HISTORY\t90REPORT_TEST1\t89SP_QUERY_DEF_REQ_LOG\t88PF_TD_EXT_JOB_EXHDL\t82SP_GRID_TEMPLET\t81PF_DUTY_FUNCTION_GROUP_RELA_ZS\t73PF_MSG_USERINFO\t67SP_GRID_MODEL\t58PF_TD_EXT_EXEC_CPNT\t46PF_TD_EXT_GROUP\t45PF_TD_JOB_DETAILS\t44PF_WORKDEST_SHORTCUT\t44PF_TD_EXT_JOB_DTL\t44PF_PARAM_SORT\t42PF_PASSWORD_HISTORY\t42PF_DUTY_OBJECT_EXCEPT_ZS0325\t41PF_TD_EXT_JOB_EXEC\t39PF_TD_EXT_JOB_DTL_HIS\t38PF_TD_JOB_DETAILS_HIS\t38PF_PARAM_VALUE\t35SP_QUERY_DEF\t34PF_TD_TRIGGERS\t33PF_INNER_ROLE\t32SP_QUERY_CONT_CONFIG\t32PF_TD_CRON_TRIGGERS\t30SP_QUERY_CONT_CONFIG_REQ_LOG\t28DATAPUSH_DATA\t28PF_TD_EXT_JOB_EXEC_HIS\t25PF_TD_EXT_DATA_DICT\t23PF_FUNCTION_GROUP_ZS0325\t22PF_MSG_SEND\t21PF_MSG_RCV_EXTENDGG\t20PF_TD_EXT_LISTENER\t20PF_OBJECT_EXTENDATTR\t19PF_STAFF_ERR150327\t18PF_SAFECONFIG\t17PF_DROOLS_TYPE\t14QUERY_MORE_TEST\t12PF_APPLICTION\t11PF_MSG_TYPE\t11PF_DROOLS_FORMDRL\t11PF_TD_EXT_EXEC_CPNT_HIS\t10PF_MSG_USERGROUP\t10PF_DEMO_LEAVE\t10SP_SCHEDULE\t9PF_PLATFORM\t7TAB_PF_DUTY_OBJECT_EXCEPT\t7REPORT_TEST2\t6PF_TD_CPNT_AUTH\t6PF_MSG_CONSTANT\t5PF_MSG_SORT\t4WL_SERVLET_SESSIONS\t4PF_TD_SIMPLE_TRIGGERS\t3PF_WORKDESK\t3SP_HOLIDAY\t2PF_TD_LOCKS\t2PF_MSG_USER_CONFIG\t1PF_SAFECONFIGS\t1PF_TD_EXT_LISTENER_TYPE\t1PF_DROOLS_DRLFUNC\t1PF_DROOLS_FORMVALIDATE\t1PF_TD_SCHEDULER_STATE\t1SP_QUERY_CONT_DEF_REQ\t0PF_TD_BLOB_TRIGGERS\t0SP_QUERY_DEF_ATTR\t0SP_QUERY_DEF_ATTR_REQ\t0SP_QUERY_DEF_ATTR_REQ_LOG\t0SP_QUERY_DEF_REQ\t0SP_QUERY_PARA_DEF_REQ\t0SP_QUERY_PRO\t0SP_QUERY_PRO_REQ\t0SP_QUERY_PRO_REQ_LOG\t0PF_SERVICEMANAGER_INFO\t0PF_DUTY_OBJECT_EXCEPT\t0PF_FILE_RECORD\t0PF_MSG_ATTR\t0PF_TD_FIRED_TRIGGERS\t0PF_TD_PAUSED_TRIGGER_GRPS\t0PF_TD_SIMPROP_TRIGGERS\t0PF_WORKDESK_ATTR\t0PF_OBJECT_BAK050411\t0PF_TD_CALENDARS\t0SP_QUERY_CONT_CONFIG_REQ\t0\n数据库表结构\nhttp://27.17.7.236/static/2.jsp carry\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2016-01-11 11:15 厂商回复： 感谢提交 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}