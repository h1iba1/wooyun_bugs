{"id": 22167, "wybug_id": "wooyun-2011-02757", "wybug_title": "支付宝权限绕过任意登录他人用户漏洞", "wybug_corp": "支付宝", "wybug_author": "hack", "wybug_date": "2011-09-01 22:35", "wybug_open_date": "2011-10-01 22:37", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证缺陷", "认证设计不合理", "逻辑错误", "敏感操作逻辑错误", "点卡", "认证绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-09-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-09-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2011-09-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-09-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-10-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-10-01：\t细节向公众公开  简要描述： 支付宝权限认证体系存在缺陷，通过一定的逻辑操作可以随意进入他人支付宝账户，查看历史交易记录，现有账户余额信息等等操作 详细说明：  支付宝的认证体系存在一定的缺陷，其中的账号封锁机制存在问题，可能在登录情况下将自己的账号换成其他人的账号，从而直接登录他人的账号进行操作   漏洞证明：  1 登录自己的支付宝\n\n2 开启多窗口浏览器的另外一个标签页，在其中登录他人的支付宝\n\n3 一直输入错误的密码直到出现\n\n和\n\n4 第一个窗口里的用户已经成为其他人了，其中可以任意浏览他人的交易额，历史记录等等，甚至下订单和其他操作\n\n\n\n\n\n\n\n   修复方案：  寻找其中的逻辑错误并且修复   版权声明：转载请注明来源 hack@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2011-09-05 11:04 厂商回复： 由于近期支付宝进行相关应用系统升级，过程中发生能够查看一类少量用户账号信息的应用BUG（该BUG不会导致用户资损问题），发现问题后已经迅速发布补丁进行修复，感谢wooyun和漏洞报告者，支付宝会提供相应奖励表示感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2011-09-01 23:15 |    \t\tGaRY \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:3        | 真悲剧平男君)\t\t \n  这个洞牛叉大发了，关注之。等公开    \n     2011-09-02 00:08 |    \t\trayh4c \t\t\t( 普通白帽子  |\t\t\t        Rank:240 漏洞数:23        )\t\t \n  擦，没隐私了。    \n     2011-09-02 00:11 |    \t\txy7 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | javascript:alert(1))\t\t \n  mark 等细节……    \n     2011-09-02 00:28 |    \t\tSurp4ss \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 不以风骚惊天下，就以淫荡动世人。)\t\t \n  坐等细节    \n     2011-09-02 00:29 |    \t\tJoey Yin \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:5        )\t\t \n  关注，等细节。    \n     2011-09-02 02:11 |    \t\tMeck \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        )\t\t \n  围观    \n     2011-09-02 02:25 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  半夜醒来围观    \n     2011-09-02 06:13 |    \t\tMatrix \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:5        | NOD)\t\t \n  关注 等细节    \n     2011-09-02 07:29 |    \t\tpestu \t\t\t( 普通白帽子  |\t\t\t        Rank:170 漏洞数:13        | 关注计算机网络安全 lnmpa技术)\t\t \n  大牛是如何发现的，坐等细节    \n     2011-09-02 07:42 |    \t\t但丁 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 比較懶 沒什麽好介紹的)\t\t \n  不明真相.....    \n     2011-09-02 07:43 |    \t\tP w \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:14        | -这家伙很懒,什么都没有留下。其实我真的很...)\t\t \n  坐等方法 前排站位关注    \n     2011-09-02 09:11 |    \t\tdotey \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:3        | 低调做人，你会一次比一次稳健；高调做事，...)\t\t \n  关注 等细节    \n     2011-09-02 09:25 |    \t\txixi \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:8        | 别瞎BB。。。。。。。。。。)\t\t \n  关注。。    \n     2011-09-02 09:30 |    \t\tThanks \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:5        | 极品屌丝)\t\t \n  mark    \n     2011-09-02 10:05 |    \t\t咸鱼 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:20        | 唯一好的是知识，唯一坏的是无知)\t\t \n  围观呀    \n     2011-09-02 11:03 |    \t\tsoftbug \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:10        | 为人类设计最好的软件，解放人的双手,一起...)\t\t \n  无敌了，但厂商回应依然是暂无，是不是他们对这样的安全漏洞先要自我消化才能产生响应啊。    \n     2011-09-02 11:37 |    \t\t薄雾ing \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:4        | 写点什么呢？还处于学习阶段。期待与更多业...)\t\t \n  等细节。    \n     2011-09-02 11:44 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @softbug我猜测是在修复 然后想办法消除影响    \n     2011-09-02 12:55 |    \t\twhoami \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:4        | alert\\\\)\t\t \n  排队。。。 等细节。。    \n     2011-09-02 13:09 |    \t\tXhm1n9 \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:13        | bug)\t\t \n  牛13    \n     2011-09-02 13:24 |    \t\t蚊虫 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:12        | 我装逼这么牛可还是没妞喜欢我)\t\t \n  如果能转帐就完美了.    \n     2011-09-02 14:18 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  太牛比了这个漏洞，mark！    \n     2011-09-02 17:02 |    \t\t肉火烧 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 卖火烧的~)\t\t \n  排队等细节~    \n     2011-09-02 17:21 |    \t\tp.z  \t\t\t( 普通白帽子  |\t\t\t        Rank:411 漏洞数:40        )\t\t \n  日啊 可以刷楼了    \n     2011-09-02 18:52 |    \t\t少帅 \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:14        )\t\t \n  ...坐等....    \n     2011-09-03 00:52 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  以前遇到过，不知道是不是控件问题。    \n     2011-09-03 12:14 |    \t\txcrypt \t\t\t( 实习白帽子  |\t\t\t        Rank:87 漏洞数:9        | 暂无介绍~)\t\t \n  和众牛人一起排队等细节。。。    \n     2011-09-03 23:42 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  呵呵，玄乎~    \n     2011-09-04 22:54 |    \t\tkkmylove \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | QQ:417438592)\t\t \n  牛啊    \n     2011-09-06 22:52 |    \t\t冷冷的夜 \t\t\t( 普通白帽子  |\t\t\t        Rank:135 漏洞数:12        )\t\t \n  好牛逼，围观    \n     2011-09-07 15:19 |    \t\ttenzy \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:21        | Need not to know)\t\t \n  坐等公开    \n     2011-09-08 09:22 |    \t\t神刀 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:3        | www.shellsec.com内射那么牛，虾米没妹子？)\t\t \n  求求~    \n     2011-09-08 17:25 |    \t\t Jesus \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:18        | 天地不仁,以万物为刍狗！)\t\t \n  咳，dark利用了多少年啦...    \n     2011-10-02 03:48 |    \t\t黑夜 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        )\t\t \n   好鸡肋、、 差一点就能转账了。    \n     2011-10-02 11:11 |    \t\t顺子 \t\t\t( 普通白帽子  |\t\t\t        Rank:236 漏洞数:36        | 0-0努力像正常青年靠近，再也不当上错图的2...)\t\t \n  这个叼爆了！    \n     2011-10-02 11:30 |    \t\tzhuowater \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 程序员一枚，求妹子一枚)\t\t \n  我勒个去    \n     2011-11-21 00:26 |    \t\t帅气凌云 \t\t\t( 普通白帽子  |\t\t\t        Rank:314 漏洞数:60        | 弱点扫描{Www.VulScan.CN} 为网站健康检查...)\t\t \n  牛逼啊，这个要出现现金奖励啦……    \n     2012-10-12 13:42 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  我去，这是个奇葩洞    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}