{"id": 13154, "wybug_id": "wooyun-2013-020129", "wybug_title": "且看我如何重置尚品网任意用户密码", "wybug_corp": "尚品网", "wybug_author": "xfkxfk", "wybug_date": "2013-03-16 10:15", "wybug_open_date": "2013-04-30 10:16", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄漏", "认证设计不合理", "设计缺陷", "设计不当", "敏感接口缺乏认证", "用户敏感信息泄露", "权限验证不足", "手机短信", "加密算法设计错误", "敏感接口缺乏校验", "任意密码修改"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-16：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-04-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 尚品网ShangPin.com_领先的高端时尚和奢侈品购物网站。这个任意用户密码重置漏洞真的是很有意思。。。且看我细细道来。。。 详细说明：  1、这个任意用户密码重置漏洞真的是很有意思。。。且看我细细道来。。。2、首先我注册了一个帐号，我们进行找回密码步骤，这时会让你输入你的注册邮箱。\n\n3、然后，你会收到重置密码的连接，初看没什么问题，很平常的连接：\n\n4、我们打开这个连接，然后我用的是QQ邮箱，邮箱会提示你是否继续，这时出现端倪，看看这里的连接和前面的不一样了：\n\n5、可以看到后面的一堆字符一看就是base64编码的，我们解码看看：\n编码的：dT1zaGFuZ3BpbiZtPWNsJmNvb3JkPTYxLDEzNTgyNTgxLDEzODkwNDM0LDI4MDc2NzE1MQ==解码的：u=shangpin&m=cl&coord=61,13582581,13890434,280767151\n6、感觉这里肯定有问题，然后我又重复了上面的操作，找找规律。果然，在参数u=shangpin&m=cl&coord=61,13582581,13890434,280767151中，后面3组的数字是变化的，而且是递增的，第一个数字是不变的。7、这样就好办了，我们可以重置其他用户的密码了。只要我们把后面的3组数字递归正确就ok。8、这里我们要用到前面的漏洞“尚品网xss盲打成功登录后台，用户敏感信息泄漏--http://wooyun.org/bugs/wooyun-2013-020128”，从这里得到我们想要的用户的邮箱地址，真实天助我也啊，哈哈哈。。。9、然后重置密码开始。我再注册了一个帐号，然后分别发三次密码找回的请求。第一次我的账户的请求，第二次为任意账户的密码找回请求，第三次我的账户的请求。这三次顺序发出请求。10、然后我的连个账户邮箱都收到重置密码连接。对比参数变化范围，第二次的任意账户的参数我们就知道了。\n\n11、成功获取任意用户的重置密码连接：\n\n12、成功重置任意用户密码，并登陆。\n\n\n\n   漏洞证明：  \n\n   修复方案：  1、把后面的参数尽量随机化，不要看出什么规律。2、连接的有效性限制。3、求礼物   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：13 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2013-03-16 10:16 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  洞主要火啊    \n     2013-03-16 10:19 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @xsser 哈哈，我把自己劝了一下，火不了了。。。    \n     2013-03-16 11:03 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  @xfkxfk 火吧    \n     2013-03-16 14:01 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  @xfkxfk 此贴有我必火    \n     2013-03-16 17:33 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @Rookie 嗨，这年头，火了也难过啊。。。    \n     2013-03-16 17:35 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @围剿 你在此贴，你也必火    \n     2013-04-30 12:12 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @xsser ...全被忽略了。。。    \n     2013-04-30 20:57 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @px1624 @xsser 嗨，这厂商，我给他们客服说在wooyun上报了他们的漏洞，他们说我是宣传网站的。。。。。无语    \n     2015-02-24 21:00 |    \t\t阿萨帝 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:62        | 不发礼物的索要联系方式都是耍流氓。)\t\t \n  他们说我是宣传网站的。。。。。    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 13, "Ranks": null}