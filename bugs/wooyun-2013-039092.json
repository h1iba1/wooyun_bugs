{"id": 61527, "wybug_id": "wooyun-2013-039092", "wybug_title": "北大方正#1 某系统数据库等信息泄露", "wybug_corp": "北大方正", "wybug_author": "爱上平顶山", "wybug_date": "2013-10-08 15:24", "wybug_open_date": "2013-11-22 15:24", "wybug_type": "网络敏感信息泄漏", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["服务配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-22：\t细节向公众公开  简要描述： 0.0 详细说明：  北大方正人寿某系统数据库等信息泄露proxool一个数据库连接池框架  Proxool 0.9.0RC3地址：https://sp.pkufi.com/admin   未授权直接访问图：\n\n\n\n地址信息等：alias:\tmyblogdbdriver-url:\tjdbc:microsoft:sqlserver://192.168.101.35:1433;DatabaseName=EMAPdriver-class:\tcom.microsoft.jdbc.sqlserver.SQLServerDriveruser (delegated):\tsalesportalpassword (delegated):\t******sql = select count(1) from emap.dbo.EMAP_SM_MT_SENT_LOG where RESERVED4='7ACB36E6-E4FC-450B-A2E3-FF48A29917C9';sql = select count(1) from emap.dbo.EMAP_SM_MT_UNSENT_LOG where RESERVED4='7ACB36E6-E4FC-450B-A2E3-FF48A29917C9';proxy = 345d6fbedelegate = 1b833243url = jdbc:microsoft:sqlserver://192.168.101.35:1433;DatabaseName=EMAPalias:\tbusinessDbdriver-url:\tjdbc:oracle:thin:@192.168.101.23:6820:salesportaldriver-class:\toracle.jdbc.driver.OracleDriveruser (delegated):\ttoipassword (delegated):\t******dll (delegated):\tocijdbc9protocol (delegated):\tthinsql = select count(1) from policy a,relation_person_info b,coverage c, person_info d,relation_person_info e,value_table v,relation_ap p Where a.policy_no = c.policy_no and c.rider='01' and a.policy_no = b.policy_no and b.relation='O' and c.insured1=d.client_no and a.policy_no = e.policy_no and a.policy_no=p.policy_no and p.relation='S' and a.system='CAPSIL' and p.agent_code = '1002280A60' and e.relation in ('A','P') and e.credit_cat='M' and e.bank_code = v.value and v.value_type='BANK_NAME' and to_date(e.credit_exp_date,'yyyy-mm-dd')-to_date('2013-09-01','yyyy-MM-dd')>=0 and to_date(e.credit_exp_date,'yyyy-mm-dd')-to_date('2013-10-31','yyyy-MM-dd')<=0 and length(trim(e.credit_exp_date))=10 order by e.credit_exp_date desc ;proxy = 74548ffcdelegate = 32addcb7url = jdbc:oracle:thin:@192.168.101.23:6820:salesportalalias:\tSQSdbdriver-url:\tjdbc:oracle:thin:@192.168.101.23:6820:SALESPORTALdriver-class:\toracle.jdbc.driver.OracleDriveruser (delegated):\tsalesportalpassword (delegated):\t******dll (delegated):\tocijdbc9protocol (delegated):\tthinsql = select count(*) from lsactivitydata4day where usercode ='1002280A60' and datadate = '2013-10-01' and ((newcus is null or newcus ='') and (telact is null or telact ='') and (demandinter is null or demandinter ='') and (dealinter is null or dealinter ='') and (newcand is null or newcand ='') and (recuinter is null or recuinter ='') and (PrpNum is null or PrpNum ='') and (IidNum is null or IidNum ='') and (FodNum is null or FodNum =''));proxy = 3974ba55delegate = 1e753feburl = jdbc:oracle:thin:@192.168.101.23:6820:SALESPORTALok   漏洞证明：  alias:\tmyblogdbdriver-url:\tjdbc:microsoft:sqlserver://192.168.101.35:1433;DatabaseName=EMAPdriver-class:\tcom.microsoft.jdbc.sqlserver.SQLServerDriveruser (delegated):\tsalesportalpassword (delegated):\t******sql = select count(1) from emap.dbo.EMAP_SM_MT_SENT_LOG where RESERVED4='7ACB36E6-E4FC-450B-A2E3-FF48A29917C9';sql = select count(1) from emap.dbo.EMAP_SM_MT_UNSENT_LOG where RESERVED4='7ACB36E6-E4FC-450B-A2E3-FF48A29917C9';proxy = 345d6fbedelegate = 1b833243url = jdbc:microsoft:sqlserver://192.168.101.35:1433;DatabaseName=EMAPalias:\tbusinessDbdriver-url:\tjdbc:oracle:thin:@192.168.101.23:6820:salesportaldriver-class:\toracle.jdbc.driver.OracleDriveruser (delegated):\ttoipassword (delegated):\t******dll (delegated):\tocijdbc9protocol (delegated):\tthinsql = select count(1) from policy a,relation_person_info b,coverage c, person_info d,relation_person_info e,value_table v,relation_ap p Where a.policy_no = c.policy_no and c.rider='01' and a.policy_no = b.policy_no and b.relation='O' and c.insured1=d.client_no and a.policy_no = e.policy_no and a.policy_no=p.policy_no and p.relation='S' and a.system='CAPSIL' and p.agent_code = '1002280A60' and e.relation in ('A','P') and e.credit_cat='M' and e.bank_code = v.value and v.value_type='BANK_NAME' and to_date(e.credit_exp_date,'yyyy-mm-dd')-to_date('2013-09-01','yyyy-MM-dd')>=0 and to_date(e.credit_exp_date,'yyyy-mm-dd')-to_date('2013-10-31','yyyy-MM-dd')<=0 and length(trim(e.credit_exp_date))=10 order by e.credit_exp_date desc ;proxy = 74548ffcdelegate = 32addcb7url = jdbc:oracle:thin:@192.168.101.23:6820:salesportalalias:\tSQSdbdriver-url:\tjdbc:oracle:thin:@192.168.101.23:6820:SALESPORTALdriver-class:\toracle.jdbc.driver.OracleDriveruser (delegated):\tsalesportalpassword (delegated):\t******dll (delegated):\tocijdbc9protocol (delegated):\tthinsql = select count(*) from lsactivitydata4day where usercode ='1002280A60' and datadate = '2013-10-01' and ((newcus is null or newcus ='') and (telact is null or telact ='') and (demandinter is null or demandinter ='') and (dealinter is null or dealinter ='') and (newcand is null or newcand ='') and (recuinter is null or recuinter ='') and (PrpNum is null or PrpNum ='') and (IidNum is null or IidNum ='') and (FodNum is null or FodNum =''));proxy = 3974ba55delegate = 1e753feburl = jdbc:oracle:thin:@192.168.101.23:6820:SALESPORTAL   修复方案：  做权限控制。 礼物？ `(*∩_∩*)′   版权声明：转载请注明来源 爱上平顶山@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2013-10-12 22:33 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}