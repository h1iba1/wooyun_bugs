{"id": 44037, "wybug_id": "wooyun-2015-0112024", "wybug_title": "网易某重要接口撞库泄露用户登录凭据(有批量账号证明)", "wybug_corp": "网易", "wybug_author": "路人甲", "wybug_date": "2015-05-04 19:30", "wybug_open_date": "2015-05-05 10:56", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 撞库扫号攻击已经是Top 10 Security Risks for 2014之一.撞库以大量的用户数据为基础，利用用户相同的注册习惯（相同的用户名和密码），尝试登陆其它的网站。2011年，互联网泄密事件引爆了整个信息安全界，导致传统的用户+密码认证的方式已无法满足现有安全需求。泄露数据包括：天涯：31,758,468条，CSDN：6,428,559条，微博：4,442,915条，人人网：4,445,047条，猫扑：2,644,726条，178：9,072,819条，嘟嘟牛：13,891,418条，7K7K：18,282,404条，共1.2亿条。不管你的网站密码保护的多好，但是面对已经泄露的账号密码，撞库扫号防御还是一个相当重要的环节。 详细说明：      主站登录接口没有防御撞库。对登录接口的调用没有进行限制。经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号。   登录接口抓包如下：由于网易账号是一站式的。所以，所有可以或得各种关联系统的权限，包括微博，博客，邮箱。等等能。\nPOST /logins.jsp HTTP/1.1Host: reg.163.comConnection: closeContent-Length: 230Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://www.163.comUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://www.163.com/Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: usertrack=c+5+hVVAxQLBxR9jBeWgAg==; _ntes_nnid=4fc0b7199a1c9834e05c0d696f1cb9ea,1430308107352; SID=a8ff61f3-e067-46cd-9c83-0b8f7d314f9a; _ntes_nuid=4fc0b7199a1c9834e05c0d696f1cb9ea; Province=0571; City=0571; vjuids=eb751fe52.14d05bd1d69.0.e1a6c9db; JSESSIONID=dacaeQeXDF-5IbyK9xi0u; T_INFO=CE1F7243882AAA0FEBB261E71A3B9FA41F903565B4C9497BE810CD4E3FDFD8878098BA0EB3F9DE7E303573B8C0BB5B31EF33BC42C912FF0C2D77EE9BB51D0928; ui_tip_cookie=xzou@21cn.com%261%261%260%7Cshmilyclytze@yeah.net%261%261%260%7C; URS_Analyze=1; ne_analysis_trace_id=1430728079918; pver_n_f_l_n3=a; n_ht_s=1; P_INFO=shmilyclytze@yeah.net|1430721918|2|urs|10&15|not_found&1430721790&163#zhj&330100#0#0#0|151519&0|163&urs|shmilyclytze@yeah.net; vjlast=1430320389.1430728080.13; vinfo_n_f_l_n3=efd1f43a14527912.1.0.1430320389504.0.1430728196488; s_n_f_l_n3=efd1f43a145279121430320389505RA-Ver: 2.10.0RA-Sid: 7B9DD012-20150303-080129-82895f-fb68a9AlexaToolbar-ALX_NS_PH: AlexaToolbar/alxg-3.3username=570138905@qq%2ecom&password=wxl5927101&type=1&product=163&savelogin=0&url=http%3A%2F%2Fwww.163.com%2Fspecial%2F0077450P%2Flogin_frame.html&url2=http%3A%2F%2Fwww.163.com%2Fspecial%2F0077450P%2Flogin_frame.html&noRedirect=1\n   漏洞证明：  经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号.\nahbbliuhm@163.com\tlhm32411111jiangjuncool2008@sina.com\tjun13788578250njyc_zhuhancheng@126.com\tnjzhu045justdoityzh@yeah.net\tjjzj334553086weinastory29@126.com\twn1000015218jimmyzeng1004@126.com\td3y47tjimmyzengshmilyclytze@yeah.net\thewotiaowubakeepinwithmyself@126.com\t4034ljmenghuanqiuyue@126.com\t13990844111570138905@qq.com\twxl5927101ufo0112@sina.com\tAllen0112bruce0com0cn@hotmail.com\t11556688linken1989@126.com\tn19880308nhuangtengqing@163.com\t53286566lzbsky2580@126.com\tlzb3227521yanzhongsheng@126.com\t198552200agnes.lee@yeah.net\t159357qtoetu634645765@qq.com\tXRKSHI11jay2006easonl@126.com\tjay998849888xujiqian_5956@qq.com\txujiqiangsunyonghai559@gmail.com\tilovewen99@lijie_0316@126.COM\tqqq3394724weiyong123.good@163.com\tailing123mail.liuli@gmail.com\t19811103sunrunbang@gmail.com\thy197610937113519@qq.com\t19870925heliangri2009@126.com\t08327656314tz_wang@yeah.net\tzl191215weichong666@163.com\tw270811credandelion@126.com\t04151403lele009wangxiang@163.com\t13309492097tengjianquanliuxia@163.com\ttjq19880219lvhaixin@hotmail.com\tfox165910oyzoyzoyz@yahoo.com.cn\t85282465wenhao7716@gmail.com\tzy840614chenxiaofeng520@163.com\t19900419wangzhiguo_image@163.com\t19780917yanghailong5201@163.com\t123456789kero990@gmail.com\t19831210chenjinmyin@qq.com\tcheng911yiyuxing_29@126.com\t123yiyaajudymaxiao@126.com\t2008532752141066578831@QQ.COM\tzzp19900919kgi_hhy@yahoo.com.cn\thjjzsfjingke777771234@163.com\tjingjingmy_last_love@163.com\t881129sjjfoyemeizhe@sina.com\t2119861020ssvod110@126.com\t2007198817916613618@qq.com\t513148977ilovexiaozhuzai@163.com\txiaozhu1117334897465@qq.com\t5731381431langhaitao.2008@163.com\tlang__1984luoluo320@163.com\t36991019sthinboy@21cn.com\tshallinkent1234562007@163.com\tkent123456394646235@qq.com\twdqq19870618chifanlaha@yahoo.cn\twoaimama610824453@qq.com\t55036081ni-aiwoma@126.com\tniaiwoma475391161@QQ.COM\t88995234675262590@qq.com\tJay261012zhulaosi001@163.com\t24248423304016779@qq.com\thj8229651513072290@qq.com\tz19891110maplekurt@163.com\tfeng_1321774727705@qq.com\twxy3844989183059067@qq.com\tbecky362329293448308@qq.com\tLWZL139791603029359@qq.com\t85651051369756826@qq.com\t6967446sky309711878@qq.com\tlaure9797450616144@qq.com\ta34416912lxs2liweilxs@163.com\tlw198718w2212886@163.com\ty2212886854905374@qq.com\tpa87722857523489309@qq.com\tkaaiqkwmmo58664201@QQ.com\t68728883kevinke_82@yahoo.cn\t!qazxsw@461564869@qq.com\t46731007jjdyl2@126.com\t19761102378493553@qq.com\tQJJ0325521140qwezxc3020@sina.com\t79532448zx466427048@163.com\t466427048shlijun@126.com\t671223lanlan120190@163.com\tfengyu051513036718@qq.com\taiwind1314314225220@qq.com\t19880623lubony@sina.com\t82250755xyzlxw@21cn.com\tmicrolab475712408@qq.com\t1325747445jianlin4.1@163.com\tq514082801407604960@qq.com\ticc1234567wh5355@gmail.com\twanghao110huangdexin83@163.com\t813813813734718161@qq.com\t1030238333yangyibo999@163.com\t124592203372490596@qq.com\ta3142895774043804@qq.com\tma2312251ahzylok@163.com\tpasswordkmczzmj@126.com\t30214401304532576@qq.com\t26362511940659881@qq.com\tzw8112151183889716@qq.com\t123456ascanxue945@163.com\t1358061713915898858587@163.com\tsha543DAN521n305185564n@163.com\t305185564qq378296678@163.com\tllg67986512668975@qq.com\tchuanqicnzcy4123@163.com\tgreed412382000752@qq.com\tsenaiqian315769601@qq.com\t63506729blue1000100@163.com\twoainimabi772409791@qq.com\t19870424348544218@qq.com\tliuxiao1991912520555@qq.com\tnibiaoma563378747@qq.com\t820834502gaol622@gmail.com\tgaoli123598010251@qq.com\tkele0628taofada1@163.com\t74185288404391922@qq.com\thsb123569529885364@qq.com\t73366227342557373@QQ.com\t520bafndxhyqclcls@163.com\thuayinqiu135794494454xqb@163.com\t19850821wgstudio@163.com\tking2000scz210@163.com\tossjzlzldaweed.zhu@163.com\tzzw034012shixianglx@163.com\t461518252045647849@qq.com\twoaidudulht747@126.com\tlht237lhtliyangslam@163.com\t1989527918911165032704@qq.com\t58929176dtlyzx@126.com\t0515-8106236deet1@163.com\t07307635920408736638@163.com\t123327854425120438@qq.com\tfanchiqianghuyin_ok@163.com\thuyin2915610XMYXZ@126.COM\tXMYXZ197807xc19820719@163.com\t820719123tangy799@163.com\tt123a456y4171757197@163.com\t1695174717shxluog@163.com\tluo198706leiman-1@163.com\t19820425cwho@21cn.com\t65580321zdf_aaa@163.com\t7258725899wjsth@qq.com\tsth198557ego002@126.com\tthugherobabygirlhl@163.com\tsenling52btmguan@163.com\t830814guanjkjkjk09@163.com\tjkjkjk2009lq_lxj@126.com\t1984011033553@163.com\ty90139529hcc1989@163.com\tarsenal0577xzou@21cn.com\tlordwolfjy02192915@163.com\tly86710467a673634110@163.com\t919293729qslsist@163.com\tqushuliang0426zhankay@163.com\tkaizhangsd122__8@163.com\t07178682en8023em@163.com\tgaoermaolawd@163.com\tyzhao888abc_7768@163.com\tsy12345678gbefg@163.com\t13639160383461263@163.COM\t13432438925\n\n\n\n\n\n\n   修复方案：  撞库防御参考资料:http://stayliv3.github.io/2015/04/15/%E6%92%9E%E5%BA%93%E6%94%BB%E5%87%BB%E9%98%B2%E5%BE%A1%E6%96%B9%E6%A1%88/   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-05-05 10:56 厂商回复： 感谢您对网易的关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-05 15:14 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:544 漏洞数:107        | 低调求发展)\t\t \n  忽略，233    \n     2015-05-06 09:51 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  @疯狗 说好的自动补rank机制么~    \n     2015-05-07 18:06 |    \t\t无力落地の白 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:19        | 新人)\t\t \n  ...真叼 这都不管···    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}