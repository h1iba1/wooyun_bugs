{"id": 72714, "wybug_id": "wooyun-2015-0157673", "wybug_title": "北京移动某站命令执行Getshell涉及上百万用户信息", "wybug_corp": "北京移动", "wybug_author": "403", "wybug_date": "2015-12-02 17:46", "wybug_open_date": "2016-01-18 16:10", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向公众公开  简要描述： 上一个漏洞管理员死活不给过，伤心.....@浩天 @啊L川 详细说明：  问题如下：北京移动app存在Struts2漏洞**.**.**.**/activity/clickExCode.do1、可以执行命令、getshell 2013 S2-019\n\n\n\n2、从WEB-INF下面找到数据库连接文件，菜刀连接数据库出错，read basic information failed，尝试数次未果，后面网上找到原因，可能是数据库太大，用菜刀连接会超时出错，直接上大马解决。从数据库里可以看到app一键登录的账号密码，大概有四百多万。\n\n\n\n\n\n3、发现一个集团钻卡用户，试着登录看看，直接用代理登陆不上，只能先通过重放找到跳转地址，然后修改代理包登录，发现移动集团员工福利真好，只需花2元，流量哗哗哗。\n\n\n\n\n\n4、找到一个管理员账号密码库，但是找不到管理后台。还可以查看用户手机上装的哪些app，耗费流量统计。\n\n\n\n好了，就这些吧，没有动数据，菜刀马及大马已删除。   漏洞证明：  如上   修复方案：  升级版本   版权声明：转载请注明来源 403@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-12-04 16:10 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国移动集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-02 17:50 |    \t\tzgwd \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 爱好信息安全 希望提升 交流)\t\t \n  sofa    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}