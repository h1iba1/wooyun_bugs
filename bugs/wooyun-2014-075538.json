{"id": 51146, "wybug_id": "wooyun-2014-075538", "wybug_title": "擎天科技SKYWCM全版本CSRF漏洞，可执行任意SQL", "wybug_corp": "南京擎天科技", "wybug_author": "Asuri", "wybug_date": "2014-09-15 11:51", "wybug_open_date": "2014-12-14 11:52", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-14：\t细节向公众公开  简要描述： 原先都觉得这个地方没什么太大问题，毕竟必须要登陆才能访问，危害就不会那么严重，后来发现这里还有CSRF，就不一样了。目前skywcm的版本主要是v3.0，v3.1，v3.2， M这几个版本中都存在这个问题 详细说明：  漏洞页面:/skywcm/skywcm/bat/cmd.jsp\n\n也是搞不懂这里放一个执行SQL到底有什么意义，并且整个后台没有指向这个页面的链接，我就理解为是开发过程中放在这里的一个调试页面吧。可以执行任意SQL语句，但是只会返回\"执行成功\"或\"执行失败“\n\n另外，这里存在CSRF漏洞用BurpSuite生成CSRF_POC\n\n保存成HTML文件，然后在登陆skywcm后台的情况下点击提交\n\n那么，通过任何方式获悉了skywcm后端数据库结构的人，都可以构造一个添加管理员的CSRF表单，里面是添加管理员的SQL语句，然后诱使任何能够登陆后台的用户点击。主注意，这个页面只需要能够登陆后台就可以访问，不需要管理员身份，所以即使是权限很低的用户都可以在这个页面上执行SQL语句   漏洞证明：  \n<html>  <!-- CSRF PoC - generated by Burp Suite Professional -->  <body>    <form action=\"http://www.target.com/skywcm/skywcm/bat/cmd_do.jsp\" method=\"POST\">      <input type=\"hidden\" name=\"biz_action\" value=\"3\" />      <input type=\"hidden\" name=\"sql\" value=\"select 1 from dual \" />      <input type=\"submit\" value=\"Submit request\" />    </form>  </body></html>\n这个....估计不是很方便验证，因为都需要登陆才能访问。不登陆的情况下提交这个表单，都会被重定向到后台登陆页面，同时也说明，这个文件确实存在。   修复方案：  和之前发布的任意文件下载漏洞一样，不如直接把这个页面去掉吧如果确实有需要，也做一下CSRF的防御，验证表单来源或者token   版权声明：转载请注明来源 Asuri@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-09-20 08:54 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}