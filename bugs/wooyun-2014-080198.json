{"id": 49110, "wybug_id": "wooyun-2014-080198", "wybug_title": "某保险经纪公司电商网站多处漏洞（获得webshell）", "wybug_corp": "某保险经纪有限公司", "wybug_author": "wsys", "wybug_date": "2014-10-21 15:20", "wybug_open_date": "2014-12-05 15:22", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["保险"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-21：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-12-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： sql注入都弱爆了，是sql都能执行、任意文件下载、webshell 详细说明：  1、网站http://www.auib.com.cn/product/是个管理页面，刚开始用awvs扫描发现的，用chrome打开空白页面，只能看到title，遂想到会不会浏览器版本的问题，换成IE7兼容模式果然看到如图页面\n\n2、点击页面查看源码，如图\n\n3、看了一下http://www.auib.com.cn/product/common/easyQueryVer3/EasyQueryVer3.js源码，其中有如图所示代码\n\n4、将2步骤中看到的sql作为参数进行访问http://www.auib.com.cn/product/common/easyQueryVer3/EasyQueryVer3Window.jsp?strSql=select%20*%20from%20fduserlogin，如图\n\n，顺手试了试查询所有用户，结果当前数据库用户权限大得惊人，如图\n\n5、第4步看到的数据包含iP地址，猜测是登录日志表，看到有一个fduser表，数据果然包含管理员相关账户，如图\n\n6、执行sql的功能你以为只能是query吗？这你就错了!!!curd中试了update、delete都没有问题，没有尝试insert，update了上图中的001密码，进入了系统，上图中的有些账户存在弱口令（fanxj密码就为一个a）。delete了4步骤本次的登录日志，用同样的方法进入cms系统，使用的泽元cms，如图\n\n7、进入第一个系统后随便找了个上传图片的功能，没有做任何的过滤，直接能够上传jsp等文件，如图\n\n8、从awvs中发现一个下载文件的地址，试了可以下载任意文件http://www.auib.com.cn/product/download/download.jsp?FileName=../../../../../../../../../../etc/passwd，如图\n\n   漏洞证明：  1、页面可以直接执行SQL\n\n权限够大，获取所有用户\n\n2、文件上传未过滤，webshell\n\n3、任意文件下载\n\n   修复方案：  建议提交国家互联网应急中心转交保监会，由保监会通知厂商处理，保险电商网站信息安全值得担忧。\n1、去掉EasyQuery相关代码2、后台相关的系统严格控制访问，不要直接暴露在外网3、文件下载过滤../4、awvs显示仍有很多sql inject，xss漏洞，需要对全站做安全检查\n   版权声明：转载请注明来源 wsys@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-12-05 16:29 |    \t\tAnonymous \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:30        | 园长是大傻逼)\t\t \n  混脸熟，技术朋友加QQ 5737796    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}