{"id": 26147, "wybug_id": "wooyun-2015-0112255", "wybug_title": "三亚机场WIFI系统多处认证绕过漏洞（经典认证逻辑测试思路）", "wybug_corp": "三亚机场无线网络", "wybug_author": "独孤城", "wybug_date": "2015-05-05 18:44", "wybug_open_date": "2015-06-23 16:32", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "9", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-23：\t细节向公众公开  简要描述： 三亚出差，经过机场简单看了一下WIFI系统。三亚机场WIFI系统Web Portal认证系统存在逻辑错误，任意用户可绕过系统身份认证进行登陆，实现匿名上网，并可监听其他合法用户网络数据包。想干坏事去机场哈 详细说明：  可进行登陆密码穷举：连接机场WIFI网络。连接网络后我们打开浏览器，访问任意地址。此时请求会重定向到Web认证服务器。此时服务器要求提交用户手机号码，作为身份认证凭证访问网络。提交可用手机号后，发现验证密码是4位数字。简单检查系统，发现并未设置验证码，也未对登陆次数进行限制。截取登陆数据包：\nGET /portal/ajaxlogin?user=86********{此处为冒充的手机号码}&password=${Gen_7}&language=1&_=1429299379639 HTTP/1.1Host: 192.168.1.253Connection: keep-aliveAccept: application/json, text/javascript, */*; q=0.01X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/36.0.1985.143 Safari/537.36Referer: http://192.168.1.253/portalAccept-Encoding: gzip,deflate,sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: PHPSESSID=f6ncf0e1kf3ue6ephvh4qf8g70; from_url=http%3A%2F%2F192.168.1.253%2F\n我们用WVS自带工具进行穷举攻击。\n\n几分钟之内我们便可找到任意用户的验证码。结果如下：\n\n使用该验证码可成功通过portal系统验证，接入互联网。摆脱big brother监控，实现匿名上网。各种坏事随意干哈。另外通过抓包一次正常的登陆过程，发现可以可以发现登陆成功后存在一个访问连接：http://192.168.1.253/portal/success?uid=86****{手机号码}&sip=10.10.0.250&mac=c4017c*******&client_mac=74e543********&ssid=%23Airport-Free-WiFi%20SanYa&vlan=&res=success&url=http%3a%2f%2fwp.mail.qq.com74e543********此处为注册上网的mac地址。修改此处mac地址注册其他设备上网，同样实现了匿名上网。想干坏事去机场哈。   漏洞证明：  另外简单用dspolit对网络进行了一下监听，公共wifi问题也是大大的。装有dspolit手机接入以上WIFI系统。可对网络数据包进行监听，窃取信息。具体证明如下：\n\n打开我们监听的数据包：\n\n有人在访问微信朋友圈哈。   修复方案：  1.对于登陆认证绕过和密码穷举问题。      做好基本的逻辑，程序员你懂的。2.数据包监听。      还是别用WIFI了。   版权声明：转载请注明来源 独孤城@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-05-09 16:30 厂商回复： CNVD未直接复现所述情况,已经转由CNCERT向民航行业测评中心通报,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-05 18:57 |    \t\t孤独行者 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:44        | 时光如水，总是无言。你若安好，便是晴天)\t\t \n  这。。。。真是走到哪，黑到哪。    \n     2015-05-05 19:48 |    \t\t小人物Reno \t\t\t( 普通白帽子  |\t\t\t        Rank:471 漏洞数:110        | X)\t\t \n  真是走到哪，黑到哪。 警察叔叔，就是他！    \n     2015-05-07 10:18 |    \t\t独孤城 \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:3        )\t\t \n  @迈外迪    \n     2015-05-13 17:25 |    \t\t夜未央 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 漏洞分析爱好者)\t\t \n  漏洞细节能否公开啊？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}