{"id": 54994, "wybug_id": "wooyun-2014-062489", "wybug_title": "某教学平台通用SQL注入漏洞", "wybug_corp": "Cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2014-06-10 10:24", "wybug_open_date": "2014-09-08 10:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-17：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-08：\t细节向公众公开  简要描述： rt 详细说明：  程序名称：信息技术教学辅助平台3.0  ITtools关键字：intitle:信息技术教学辅助平台3.0案例：\nhttp://ittools.lhspzx.com/teacher/weboffice/GetExtname.ashx?id=1http://fzpt.hyxyxx.com/teacher/weboffice/GetExtname.ashx?id=1http://it.qzgjzx.cn/teacher/weboffice/GetExtname.ashx?id=1http://61.175.224.187:888/teacher/weboffice/GetExtname.ashx?id=1http://wsyj.dg6z.net:81/teacher/weboffice/GetExtname.ashx?id=1\n漏洞文件：GetExtname.ashxid参数未过滤就带入查询，导致注入产生\n<%@ WebHandler Language=\"VB\" Class=\"GenericHandler2\" %>Imports System.IOImports SystemImports System.WebImports System.DataImports System.Data.SqlClientImports System.Web.ConfigurationPublic Class GenericHandler2 : Implements IHttpHandler    Dim cndata As New SqlConnection    Dim cmdSQL As New SqlCommand    Dim rd As SqlDataReader    Dim context As HttpContext    Public Sub ProcessRequest(ByVal context As HttpContext) Implements IHttpHandler.ProcessRequest        context.Response.ContentType = \"text/plain\"        Dim fileid As String = context.Request.QueryString(\"id\") //这里取得参数ID        Dim fileurl As String = \"\"        cndata.ConnectionString = WebConfigurationManager.ConnectionStrings(\"chenbin\").ConnectionString        cmdSQL.Connection = cndata        cndata.Open()        cmdSQL.CommandText = \"SELECT [url],course,list  FROM it_stuupfile  WHERE id=\" & fileid        '                              0      1     2    //这里直接带入查询了        rd = cmdSQL.ExecuteReader        If rd.Read Then            fileurl = \"~/uploadfile/stufile/course/\" & rd.GetValue(1) & \"/\" & rd.GetValue(2) & \"/\" & rd.GetValue(0)        End If        rd.Close()        cndata.Close()        fileurl = HttpContext.Current.Server.MapPath(fileurl)        fileurl = Mid(System.IO.Path.GetExtension(fileurl), 2)        context.Response.Write(fileurl)        context.Response.End()            End Sub         Public ReadOnly Property IsReusable() As Boolean Implements IHttpHandler.IsReusable        Get            Return False        End Get    End PropertyEnd Class\n实例演示：http://61.175.224.187:888/teacher/weboffice/GetExtname.ashx?id=1\n\n\n\nhttp://ittools.lhspzx.com/teacher/weboffice/GetExtname.ashx?id=1\n\nhttp://fzpt.hyxyxx.com/teacher/weboffice/GetExtname.ashx?id=1\n\nhttp://it.qzgjzx.cn/teacher/weboffice/GetExtname.ashx?id=1\n\nhttp://wsyj.dg6z.net:81/teacher/weboffice/GetExtname.ashx?id=1\n\nover!   漏洞证明：  \n\n\n\n   修复方案：  过滤处理   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-06-14 22:40 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}