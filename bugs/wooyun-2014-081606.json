{"id": 48342, "wybug_id": "wooyun-2014-081606", "wybug_title": "12306手机SO加密算法被破解", "wybug_corp": "中国铁道科学研究院", "wybug_author": "路人甲", "wybug_date": "2014-11-01 11:46", "wybug_open_date": "2014-12-30 14:44", "wybug_type": "非授权访问/认证绕过", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-06：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向公众公开  简要描述： 12306手机端APP 每次请求服务器均由手机调用so库，根据传入的baseDTO.time_str的值和设备id的值来生成一个加密字串baseDTO.check_code的值用于提交服务器验证是否非法。8月1号android版本升级了算法，现在又已经被破解，以致有人利用该算法软件模拟手机端来非法囤积车票。 详细说明：  12306手机端APP 每次请求服务器均由手机调用so库，根据传入的baseDTO.time_str的值和设备id的值来生成一个加密字串baseDTO.check_code的值用于提交服务器验证是否非法。8月1号android版本升级了算法，iPhone版本APP没有生活，已经有人利用iPhone接口做新的APP，运行在其他平台，同时现在android版本又已经被破解，有人利用该算法在电脑上模拟手机端大量发送请求，给官网造成很大压力，也有人非法囤积车票。   漏洞证明：  \n\nhttps://mobile.12306.cn/otsmobile/apps/services/api/MobileTicket/android/query通过抓包，看到短时间内大量请求官网数据请官方技术进行验证：baseDTO.time_str = 20181101113536baseDTO.device_no = bcbe66a4d1fafa5根据以上两个值可以计算出baseDTO.check_code = 075e150b08b17fcc552b4ceec7d2585d现在android智行订票抢票软件就是使用的iPhone接口   修复方案：  对手机APP源代码加密，同时升级android，iPhone加密SO算法   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-30 14:44 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-01 11:53 |    \t\t天地不仁 以万物为刍狗 \t\t\t( 普通白帽子  |\t\t\t        Rank:977 漏洞数:264        | 天地本不仁 万物为刍狗)\t\t \n  又被破了？前排····CCAV 带我飞    \n     2014-11-01 12:06 |    \t\treality0ne \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:7        )\t\t \n  so文件以后要加壳了。。？    \n     2014-11-01 14:05 |    \t\tJack.Chalres \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:15        | ..............)\t\t \n  记者同志看这里    \n     2014-11-06 12:49 |    \t\t第四维度 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:34        | 谦谦君子，温润如玉)\t\t \n  忽略呵呵    \n     2014-11-06 13:41 |    \t\t番茄师傅 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:59        | http://www.tomatoyu.com/)\t\t \n  我是@番茄师傅   CCAV拍这里    \n     2014-11-06 21:34 |    \t\t10457793 \t\t\t( 普通白帽子  |\t\t\t        Rank:867 漏洞数:128        | 说好的借，为什么从来不还？O(∩_∩)O)\t\t \n  看这里 看这里    \n     2014-11-07 14:52 |    \t\t老慢 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 人老手慢)\t\t \n  这算法也就是简单校验一下有效性，是一个没办法保护的东西。    \n     2014-11-07 22:31 |    \t\t雅柏菲卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:1213 漏洞数:234        | 雙魚座聖鬥士雅柏菲卡)\t\t \n  记者同志看这里    \n     2014-11-08 08:21 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:15        | Talk is cheap,show me the shell.)\t\t \n  2分钟之内忽略？    \n     2014-11-08 08:22 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:15        | Talk is cheap,show me the shell.)\t\t \n  擦我这眼神…撸多了…    \n     2014-12-30 21:40 |    \t\tAngelic47 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        )\t\t \n  忽略！CCTV看这里~    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}