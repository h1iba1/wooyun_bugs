{"id": 52251, "wybug_id": "wooyun-2014-071863", "wybug_title": "证大金融借贷平台的越权+存储型跨站+CSRF", "wybug_corp": "证大e贷", "wybug_author": "lucky_fn", "wybug_date": "2014-08-11 14:57", "wybug_open_date": "2014-09-25 14:58", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["越权操作", "跨站"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-11：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-09-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 证大金融www.onlinecredit.cn画面：修改昵称越权+存储型跨站+CSRF问题参数user_id是可推测的数字，存在越权+存储型跨站+CSRF，我如果循环提交，使大量用户登录时执行跨站。一个画面存在三个问题，关键字ID还是可推测的，这下屌爆了。 详细说明：  1：帐号A登录，确认昵称帐号A昵称：lucky_fn7POST值：id=2644836&user_id=2810739&residents_info_id=2644874&nick_name=jamfong%40hotmail.com&residents_info=2：帐号B登录帐号B昵称：lucky_fn4POST值：id=2644835&user_id=2810738&residents_info_id=2644873&nick_name=lucky_fn@126.com&residents_info=3：帐号B访问URL，把user_id改成帐号A的值，nick_name里输入跨站脚本。帐号B的最上面的昵称自动便新了，执行了跨站，但帐号B底下昵称没变修改昵称URL：https://www.onlinecredit.cn/EDAIWeb/PersonalCenter/updateUserInfo?id=2644835&user_id=2810739&residents_info_id=2644873&nick_name=lucky_fn8@126.com\"><script>alert(/xss/)</script>&residents_info=4：帐号A刷新页面，确认昵称已被修改，但跨站没有执行5：帐号A重新登录，跨站了！   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  提交时权限验证，XSS过滤，TOKEN验证   版权声明：转载请注明来源 lucky_fn@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}