{"id": 6579, "wybug_id": "wooyun-2015-0122148", "wybug_title": "向上360某功能逻辑缺陷可以任意重置用户密码", "wybug_corp": "京证大向上金融信息服务有限公司", "wybug_author": "月无痕", "wybug_date": "2015-06-29 15:21", "wybug_open_date": "2015-08-13 15:22", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-29：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-08-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 向上360是北京证大向上网络科技有限公司推出的互联网理财服务平台，成立于2013年7月，注册资金1000万人民币，上海证大集团为主要股东。公司的经营团队由来自金融、电子商务、互联网等领域的专业人士组成。为用户提供投资理财、财务管理及财富规划等服务.. 详细说明：  今天测试p2p登录安全，找到向上360这个平台，短信改密这块测了很长时间没有突破。后来发现可以通过邮箱登录及利用邮箱更改密码。顺手测了一下...发现邮箱改密这块逻辑存在漏洞，可以绕过邮箱验证重置用户密码。1.登录页面及注册处无法遍历邮箱名，如图：\n\n注册处只能用手机号注册，同样无法遍历邮箱，如图：\n\n这样只能通过暴力破解来获得邮箱名了..2.忘记密码处却可以通过邮箱来重置密码，如图：\n\n3.注册两个测试账号，分别绑定邮箱，如图：尾号为574，邮箱为m打头的163邮箱：\n\n尾号394，邮箱为f打头的163邮箱：\n\n   漏洞证明：  1.改密开始，使用尾号为574的账号，发送邮件进行重置密码，如图：\n\n2.登录m打头的163邮箱，找到重置密码的邮件，并复制连接，进行重置密码并抓包，如图：\n\n\n\n发现里面有randomcode及referfer和cookie，先看下正常的返回结果，如图：1>请求包\n\n2>响应包\n\n3.讲请求包进行回放，并且去掉referer和randomcode，并把密码再改一次为123.com，发现返回包没有变化，如图：\n\n用123.com这个密码进行登录，成功。如图：\n\n4.将账号换成f打头的163邮箱进行测试，发现同样成功（密码改为123qwe），如图：\n\n用123qwe这个密码对f打头163邮箱的账号进行登录，成功。如图：\n\n   修复方案：  重置密码逻辑中加入对邮箱验证码的验证。   版权声明：转载请注明来源 月无痕@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}