{"id": 1783, "wybug_id": "wooyun-2014-062696", "wybug_title": "逐浪CMS任意文件删除漏洞（官网演示）", "wybug_corp": "逐浪CMS", "wybug_author": "wefgod", "wybug_date": "2014-05-29 10:11", "wybug_open_date": "2014-08-27 10:12", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-01：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-27：\t细节向公众公开  简要描述： 不知道有人提交过没有。最近看大家SQL太爽了，换点别的口味来吧。演示只用了一个无所谓的文件，所以大可放心，不影响业务。 详细说明：  User\\UserZone\\Images\\ftb\\ftb.imagegallery.aspx这页面之前在正方之类的，似乎很火。要点如下：1.正常情况下点击删除页面会自动提交RootImagesFolder和CurrentImagesFolder这两个参数，但是实际上这两个参数没啥用；2.HttpContext.Current.Request.PhysicalApplicationPath获取的是网站根目录的绝对路径，默认删除的文件路径是根目录下的Images文件夹。其它自行看代码分析了。   漏洞证明：  用官网来做演示吧。首先我们找到了一个目测木有啥用的文件：http://www.zoomla.cn/log.txt\n\n应该是记录错误信息的打开http://www.zoomla.cn/User/UserZone/Images/ftb/ftb.imagegallery.aspx\n\n最下方有一个删除按钮。我们直接点击（也避免了你要想其它办法去获取他的viewstate），看包：\n\n有一个FileToDelete，这就是用来指定需要删除的文件了前面提到，默认路径是根目录下的images，提交../log.txt\n\n页面会自动返回信息：\n\n已删除，访问log.txt试试：\n\n呵呵呵呵呵呵呵了。各种不说话。也许我们还在加班，但比你想象中快乐！   修复方案：  厂商肯定懂。   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-05-29 19:35 厂商回复： 感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-29 10:12 |    \t\tMoc \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:12        | 屌丝何苦为难屌丝)\t\t \n  大哥你这种姿势，逐浪会很疼的    \n     2014-05-29 10:16 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Moc 没有。还好。木有空了今天上班做事    \n     2014-06-04 16:11 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n   传说中的渣浪难道就是他···我一直以为是新浪    \n     2014-06-04 23:35 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @李旭敏 非新浪啊    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}