{"id": 3628, "wybug_id": "wooyun-2014-053633", "wybug_title": "drcom自助系统Struts2+校园上网充值卡、学生老师部分信息数据泄漏", "wybug_corp": "drcom自助系统", "wybug_author": "嘿ME", "wybug_date": "2014-03-14 19:09", "wybug_open_date": "2014-06-12 19:10", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["渗透测试思路", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-12：\t细节向公众公开  简要描述： 我们学校用的是drcom的一款校园网计费系统，由于在校园内网，外网不能访问，所以drcom公司、电信、学校都没有及时修复过这个漏洞。下面会详细讲。。。 详细说明：  www.doctorcom.com首先说，学校电信营业厅的老板真心坑，多的不说了，懒得吐槽了。贴吧上很多同学想抵制，但是有什么办法呢？学校上网是电信垄断了的。。。那么我是否能免费上网呢？所以就有了下文。。。。。下图就是自助系统\n\n可以看到XXX.action，那么我们就猜一猜，得到地址直接验证\n\n存在Struts2漏洞。那么就看看目录\n\n我人工遍历了所有文件夹，发现数据库不在这台服务器上，这台服务器只是一个web服务器，没有什么可以利用的东西。我们的目的是免费上网，提权什么没必要，而且这是在学校内网，外网不能访问，提权了也没用。现在我们就需要找到数据库服务器的地址。上图我们可以看到有两个奇怪的doc文件，并且他尽然在这个位置，很可疑，下载看看。\n\n其中一个居然是安装说明！！！再看看他写了些什么：\n\n问题一下就简单了。那我们就去找到这个配置文件。\n\n下载，这就是我们想要的：\n\n好了，脱裤就行了。哦不，我是好孩子，我不脱裤，我们看看就走。表很多啊，找我们需要的就行了。先看看这个\n\n对，校园上网的充值卡卡号！！！那么我们的目的已经达到了。算算，一张30，我们低调一点，全校那么多人，我们每个月只卖100张。哇塞！3K，我3个月的生活费了啊！！！搞黑产就赚大了啊。不过我是好学生，自己用用就行了。好了，我们再看看其他东西。\n\n哇，帐号密码！帐号就是同学的学号，老师是工号。但是密码是加密的啊。不怕！学生中drcom的仇恨值是很高的，所以加密算法已经被破解了。通过ascii，每位加的数值都不一样，array(28,57,86,19,47,76,9,38,66,95,28,57,86,18,47,76) 这个数组对于大家破drcom密码相当有用，我已经写了一个解密工具了，算了好多同学的密码啊~~照应题目，还有什么信息数据啊？\n\n第一个就是周元，他肯定就是那个老板。。。。下面还有老师的数据，学生的数据，我们可以知道老师住在什么地方，也知道了他们的手机和身份证号码。这还不够，这儿，求删除啊，为什么后面有银行？难道数据库里面还有什么不为人知的秘密？我是好孩子，就不去关心那个东西了。学校有个统一信息门户系统\n\n初始密码是身份证后六位。。。啊，后面就不是今天要讨论的东西了。。。。   漏洞证明：  这个。。。。图片很多，过程也很详细。但是。。。。。是在学校内网，外网不能访问，所以你们要测试的话可能就不行了。如果需要其他信息，比如学校名字什么的就私信吧~   修复方案：  这个漏洞都知道。有过修改，求通过   版权声明：转载请注明来源 嘿ME@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-03-20 22:42 厂商回复： CNVD未直接复现所述情况，根据测试截图进行确认，已经由CNVD直接通报给教育网应急组织（CCERT和上海交通大学） 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-14 19:17 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  哎呀，用的strut2利用工具是什么？分享一下不    \n     2014-03-14 19:21 |    \t\t嘿ME \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:6        | http://zhangtory.com)\t\t \n  @动后河 也是别人的，网上能搜索到很多    \n     2014-03-14 19:27 |    \t\t飞扬风 \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:125        | 追求安全，热爱技术)\t\t \n  Mark 求详情    \n     2014-03-14 19:28 |    \t\t嘿ME \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:6        | http://zhangtory.com)\t\t \n  @飞扬风 想知道什么    \n     2014-03-20 17:20 |    \t\t冉冉升起 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | ...)\t\t \n  这个什么的最喜欢了    \n     2014-03-20 20:31 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  我靠 我上大学那会儿就是用的这系统！    \n     2014-03-20 20:34 |    \t\t嘿ME \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:6        | http://zhangtory.com)\t\t \n  @xsser 从新编辑过，求过    \n     2014-03-21 09:54 |    \t\tj2ck3r \t\t\t( 普通白帽子  |\t\t\t        Rank:406 漏洞数:92        | 别关注我，跟你不熟。)\t\t \n  上海交通大学 洞主牛逼    \n     2014-03-21 11:19 |    \t\t嘿ME \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:6        | http://zhangtory.com)\t\t \n  @j2ck3r 我不是上海交大，没那么牛，就一二本而已    \n     2014-03-25 22:00 |    \t\t坏猫 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | ....)\t\t \n  好东西，坐等公开    \n     2014-04-23 18:54 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  我一直纠结 对网络系统的正常操作的定义是什么他们又不出说明书说的详细点 直说不能反汇编之类的 还有工信部也不出台个什么规范 更加细化什么叫做正常操作和入侵我一直纠结什么交正常使用目测楼主已经受到处罚    \n     2014-04-24 13:23 |    \t\t0x01 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | XXOO)\t\t \n  上海交通大学......    \n     2014-05-24 11:39 |    \t\t橘子 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | 呢个...羞射高中生一枚。带上大神@Haswell...)\t\t \n  洞主求struct2的利用工具QAQ    \n     2014-05-29 19:31 |    \t\tcooFool \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 终于通过了。)\t\t \n  求问那个后台你怎么找的。    \n     2014-06-14 17:12 |    \t\tEnjoy_Hacking \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:8        | 时间无言，如此这般。)\t\t \n  我知道是哪个大学了- -！    \n     2014-06-22 02:41 |    \t\tComver \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:2        | Comver)\t\t \n  楼主牛逼 TAT    \n     2014-06-24 14:09 |    \t\tend \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | ....)\t\t \n  你可能完蛋了    \n     2014-10-15 14:37 |    \t\tcat73 \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:6        | 喵爱吃鱼, 喵要吃好多好多鱼~~地址栏输入...)\t\t \n  http://zone.wooyun.org/content/11262    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}