{"id": 65667, "wybug_id": "wooyun-2015-0136483", "wybug_title": "Time-Based SSRF-美丽说一处SSRF", "wybug_corp": "美丽说", "wybug_author": "Wulala", "wybug_date": "2015-08-24 13:26", "wybug_open_date": "2015-10-08 15:12", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-08：\t细节向公众公开  简要描述： 一个设计缺陷而已... 详细说明：  1. 媒体管理页面,可以添加网站 \n\n2. 我们测试四个个IP地址    114.114.114.114  - DNS服务器    124.202.144.88   - Web服务器    182.92.165.58    - Web服务器     115.115.115.115  - 非存活主机 3. 验证响应   182. \n\n   124 \n\n   114. \n\n   115. \n\n4. 从上面的结论可以看出   对于非存活主机,HTTP请求会返回 408 Request time out   对于存活主机-非Web服务器，HTTP返回网络访问异常   对于Web服务器-自定义404 返回内容不相符   对于Web服务器-非自定义404 则返回未找到root.txt5. 我们可以通过返回的code判断主机是否存活以及是否是Web服务器6. 内网ＩＰ测试 \n\n7. 上面我们可以通过code来作为判断主机存活的一个依据，也可以使用time来作为判断依据8.  CURL的一个小功能 \n\n \n\n   漏洞证明：     修复方案：  虽然在添加媒体是对主机做了一些限制：比如不能添加meilishuo相关的条目但是没对IP做过滤，适当做一个过滤吧.   版权声明：转载请注明来源 Wulala@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-08-24 15:11 厂商回复： 非常感谢您对美丽说安全的关注，经验证该漏洞真实存在，已联系相关人员紧急修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-24 13:42 |    \t\tWulala \t\t\t( 普通白帽子  |\t\t\t        Rank:227 漏洞数:24        | ^..^ ^..^ ^↓^ ^..^ ^..^)\t\t \n  这只是一个扩展，昨天的越权漏洞还没有审核.http://www.wooyun.org/bugs/wooyun-2015-0136376/trace/a0087b5d1dac5c7b43765834e25bd7e7@疯狗    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}