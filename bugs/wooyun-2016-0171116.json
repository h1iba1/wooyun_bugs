{"id": 85006, "wybug_id": "wooyun-2016-0171116", "wybug_title": "中国移动某客户端无需密码可看任意人的资料和余额和套餐和姓名", "wybug_corp": "中国移动", "wybug_author": "爱捣蛋的鬼", "wybug_date": "2016-01-19 16:30", "wybug_open_date": "2016-03-05 09:52", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-03-05：\t细节向公众公开  简要描述： 由于我的苹果碎了，换了个android的，然后升了4G，然后就下了客户端。。。然后就。。。求打雷 详细说明：  下载移动营业厅的APP后， 我尼玛发现居然不要密码，就能登陆看到我的余额，套餐，账单。。我感到了好奇，果然加代理，抓请求发现每次请求会带这个参数\n\n那么这个参数是怎么来的经过多次发现，只有首次安装了该app才会发请求，见下图\n\n好吧，就是要构造左边的参数，肯定是加密了，那是什么加密呢。。\n\n左思右想，一般要穿加密的到后台都会base64一下，这个居然没有，此时必有蹊跷，直接看HEX, 发现一个点， 就是 “1F8B”，这是GZIP头标识，来试试解压那么问题来了， burp怎么导出数据让我解压呢， 我是直接右键，然后saveItems，然后base64打钩就可以了，拿到了样本\n\n下面这个是解压代码\n\n解压出来的数据(请原谅我传不了，想死了。。)\nauth=yes&appKey=11100&cstamp=null&sign=D1D7943D338B7BA2481F541876769012&internet=wifi&sys_version=5.0.2&screen=1080×1794&model=PLK-TL00&imsi=&imei=&longitude=&latitude=&deviceid=BC71BCAF7930178921193F9ACE22F0D1&jsonParam=[{\"dynamicURI\":\"/simLogin\",\"dynamicParameter\":{\"method\":\"queryUserInfo\"},\"dynamicDataNodeName\":\"shortNum_Node\"}]&md5sign=9E6680672CA39A9BC7E1C9A1EDAAFED3\n注意注意，高能来了，高能来了那个参数imsi就是漏洞点，可以遍历的。。而且看似有md5sign和sign但是尼玛没用然后我写一个脚本来遍历数据, 见证明吧   漏洞证明：  \n\n   修复方案：  想不到好的方法规避   版权声明：转载请注明来源 爱捣蛋的鬼@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-01-22 11:08 厂商回复： CNVD确认所述情况,已经转由CNCERT向中国移动集团公司通报,由其后续协调网站管理部门处置.  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-19 16:37 |    \t\t我的邻居王婆婆 \t\t\t( 普通白帽子  |\t\t\t        Rank:2991 漏洞数:508        | 刚发现个好洞网站就挂了)\t\t \n  任意人    \n     2016-01-19 16:37 |    \t\tMieless \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:10        | 我是来打酱油的。)\t\t \n  今天。。    \n     2016-01-19 16:45 |    \t\t大饭刚 \t\t\t( 实习白帽子  |\t\t\t        Rank:82 漏洞数:17        | 吃饭，喝酒，挖洞洞)\t\t \n  mark    \n     2016-01-19 16:49 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  今天。。    \n     2016-01-19 16:53 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1423 漏洞数:203        | 。)\t\t \n  额 4g那个吗？    \n     2016-01-19 16:58 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1561 漏洞数:234        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  这个漏洞成本可够高的    \n     2016-01-19 17:06 |    \t\t爱捣蛋的鬼 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:6        | 爱捣蛋的鬼)\t\t \n  求私信乌云群啊，来了好久还没进入到组织里面    \n     2016-01-19 17:10 |    \t\tj14n \t\t\t( 普通白帽子  |\t\t\t        Rank:711 漏洞数:135        )\t\t \n  @爱捣蛋的鬼 qun.wooyun.org    \n     2016-01-19 17:22 |    \t\t无名 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:9        | 我是一只小菜鸟呀，伊雅伊尔哟。)\t\t \n  - -     \n     2016-01-19 19:22 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:217 漏洞数:78        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  路过    \n     2016-01-19 19:29 |    \t\t404notfound \t\t\t( 普通白帽子  |\t\t\t        Rank:259 漏洞数:71        | 考研中，有事请留言)\t\t \n  前排卖瓜子    \n     2016-01-19 20:29 |    \t\tQ1NG \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:21        | 临 兵 斗 者 皆 阵 列 前 行 !)\t\t \n  前排瓜子水果,CCTV看这里    ^-^    \n     2016-01-19 21:26 |    \t\tHacker 麒神 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 人生如棋，谁见我后退一步？)\t\t \n  路过    \n     2016-01-19 21:44 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 承接:钻井，架工，木工，电工，水暖工，力...)\t\t \n  移动不是早就被乌云开除党籍了么。挖到移动的直接卖给hacker叔叔就行了    \n     2016-01-19 23:58 |    \t\tlang \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 关注网络安全。)\t\t \n  求私信乌云群啊，来了好久还没进入到组织里面    \n     2016-01-23 02:17 |    \t\tWinck \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 华人安全网 www.systemsec.cn 719811394)\t\t \n  求私信乌云群啊，来了好久还没进入到组织里面    \n     2016-02-01 12:15 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1561 漏洞数:234        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  诶呀呀，又学会一招，洞主好机智    \n     2016-02-13 13:25 |    \t\t高小厨  \t\t\t( 普通白帽子  |\t\t\t        Rank:904 漏洞数:82        | 不会吹牛的小二不是好厨子！)\t\t \n  好机智    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}