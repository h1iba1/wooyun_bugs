{"id": 84769, "wybug_id": "wooyun-2015-0142445", "wybug_title": "致翔企业OA系统同一原因导致多处SQL注入#影响众多企业", "wybug_corp": "广州致翔计算机科技有限公司", "wybug_author": "路人甲", "wybug_date": "2015-09-24 15:43", "wybug_open_date": "2015-12-24 17:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-28：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-11-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向公众公开  简要描述： 大概找了３５处了，前面已经提交了１１处，最后一提２４处；一个神奇的注入参数. 详细说明：   诶！通用奖金好慢，快五个月了，节前等着奖金呢。　　最后一提该系统了，有些系统研究久了，洞儿多了会很累的。如何获取Post数据？可以通过SQLMAP的--form参数获得数据或者通过抓包等手段获取，或者直接点的扫描器也是可以的。官网显示的部分案例：\n\nSQL Injection:\n1、/WorkFlow/WorkFlowListAll.aspx 2、/WorkFlow/WorkFlowList_blz.aspx3、/WorkFlow/WorkFlowList_ybj.aspx4、/WorkFlow/WorkFlowList.aspx5、/Resources/ResMg/MyResSyApplyYsp.aspx6、/YuSuan/Shenpi/Huankuan/HuankuanYSp.aspx 7、/YuSuan/Shenpi/Jiekuan/JiekuanYSp.aspx  8、/YuSuan/Shenpi/Baoxiao/BaoxiaoYSp.aspx  9、/InfoManage/zhiao/MyPage_wt.aspx   自行抓包10、/InfoManage/zhiao/MyPage_hd.aspx  11、/InfoManage/zhiao/MyPage_zl.aspx  自行抓包12、/InfoManage/zhiao/MyPage_yxz.aspx 自行抓包13、/InfoManage/zhiao/MyPage_ph.aspx 14、/MyWork/wjk/Folders_show.aspx?id=015、/InfoManage/zhiao/ziliao_all.aspx 16、/InfoManage/zhiao/wenti_yjj.aspx 17、/InfoManage/zhiao/wenti_all.aspx18、/InfoManage/zhiao/wenti_wjj.aspx19、/InfoManage/zhiao/wenti_xiaolei.aspx?ParentNodesID=1&id=0  以下自行扫出20、/InfoManage/zhiao/ziliao_xiaolei.aspx?ParentNodesID=4&id=0 21、/InfoManage/zhiao/wenti_xiaolei_wjj.aspx?ParentNodesID=1&id=0 22、/InfoManage/zhiao/wenti_xiaolei_wjj.aspx?ParentNodesID=1&id=023、/InfoManage/zhiao/ziliao_tj.aspx24、/InfoManage/zhiao/ziliao_xzph.aspx\nCase：【每处来5发案例】\n\nmask 区域\n*****案^**********ow/WorkFlo*****1.http://**.**.**//WorkFlow/WorkFlowListAll.aspx_2.http://**.**.**//WorkFlow/WorkFlowListAll.aspx_3.http://**.**.**//WorkFlow/WorkFlowListAll.aspx_4.http://**.**.**//WorkFlow/WorkFlowListAll.aspx_***************案^*****5.http://**.**.**///WorkFlow/WorkFlowList_blz.aspx_6.http://**.**.**//WorkFlow/WorkFlowList_blz.aspx_7.http://**.**.**//WorkFlow/WorkFlowList_blz.aspx_8.http://**.**.**//WorkFlow/WorkFlowList_blz.aspx_9.http://**.**.**//WorkFlow/WorkFlowList_blz.aspx_***************案^*****10.http://**.**.**//WorkFlow/WorkFlowList_blz.aspx_11.http://**.**.**//WorkFlow/WorkFlowList_ybj.aspx_12.http://**.**.**//WorkFlow/WorkFlowList_ybj.aspx_13.http://**.**.**//WorkFlow/WorkFlowList_ybj.aspx_14.http://**.**.**//WorkFlow/WorkFlowList_ybj.aspx_*************************案^*****15.http://**.**.**//WorkFlow/WorkFlowList.aspx_16.http://**.**.**//WorkFlow/WorkFlowList.aspx_17.http://**.**.**//WorkFlow/WorkFlowList.aspx_18.http://**.**.**//WorkFlow/WorkFlowList.aspx_19.http://**.**.**//WorkFlow/WorkFlowList.aspx_***************案^*****20.http://**.**.**/Resources/ResMg/MyResSyApplyYsp.aspx_21.http://**.**.**/Resources/ResMg/MyResSyApplyYsp.aspx_22.http://**.**.**/Resources/ResMg/MyResSyApplyYsp.aspx_23.http://**.**.**/Resources/ResMg/MyResSyApplyYsp.aspx_24.http://**.**.**/Resources/ResMg/MyResSyApplyYsp.aspx_***************案^*****25.http://**.**.**/YuSuan/Shenpi/Huankuan/HuankuanYSp.aspx_26.http://**.**.**/YuSuan/Shenpi/Huankuan/HuankuanYSp.aspx_27.http://**.**.**/YuSuan/Shenpi/Huankuan/HuankuanYSp.aspx_28.http://**.**.**/YuSuan/Shenpi/Huankuan/HuankuanYSp.aspx_29.http://**.**.**/YuSuan/Shenpi/Huankuan/HuankuanYSp.aspx_***************案^*****30.http://**.**.**/YuSuan/Shenpi/Jiekuan/JiekuanYSp.aspx_31.http://**.**.**/YuSuan/Shenpi/Jiekuan/JiekuanYSp.aspx_32.http://**.**.**/YuSuan/Shenpi/Jiekuan/JiekuanYSp.aspx_33.http://**.**.**/YuSuan/Shenpi/Jiekuan/JiekuanYSp.aspx_34.http://**.**.**/YuSuan/Shenpi/Jiekuan/JiekuanYSp.aspx_***************案^*****35.http://**.**.**/YuSuan/Shenpi/Baoxiao/BaoxiaoYSp.aspx_36.http://**.**.**/YuSuan/Shenpi/Baoxiao/BaoxiaoYSp.aspx_37.http://**.**.**/YuSuan/Shenpi/Baoxiao/BaoxiaoYSp.aspx_38.http://**.**.**/YuSuan/Shenpi/Baoxiao/BaoxiaoYSp.aspx_39.http://**.**.**/YuSuan/Shenpi/Baoxiao/BaoxiaoYSp.aspx_***************案^**********e/zhiao/MyP*****40.http://**.**.**/InfoManage/zhiao/MyPage_wt.aspx_41.http://**.**.**/InfoManage/zhiao/MyPage_wt.aspx_42.://**.**.**/InfoManage/zhiao/MyPage_wt.aspx_43.http://**.**.**/InfoManage/zhiao/MyPage_wt.aspx_***************案^*****44.http://**.**.**/InfoManage/zhiao/MyPage_hd.aspx_45.http://**.**.**/InfoManage/zhiao/MyPage_hd.aspx_46.http://**.**.**/InfoManage/zhiao/MyPage_hd.aspx_47.http://**.**.**/InfoManage/zhiao/MyPage_hd.aspx_48.http://**.**.**/InfoManage/zhiao/MyPage_hd.aspx_*************************^案^*****49.http://**.**.**/InfoManage/zhiao/MyPage_zl.aspx_50.http://**.**.**/InfoManage/zhiao/MyPage_zl.aspx_51.http://**.**.**/InfoManage/zhiao/MyPage_zl.aspx_52.http://**.**.**/InfoManage/zhiao/MyPage_zl.aspx_53.http://**.**.**/InfoManage/zhiao/MyPage_zl.aspx_***************^案^*****54.http://**.**.**/InfoManage/zhiao/MyPage_yxz.aspx_55.http://**.**.**/InfoManage/zhiao/MyPage_yxz.aspx_56.http://**.**.**/InfoManage/zhiao/MyPage_yxz.aspx_57.http://**.**.**//InfoManage/zhiao/MyPage_yxz.aspx_58.http://**.**.**/InfoManage/zhiao/MyPage_yxz.aspx_***************^案^*****59.http://**.**.**/InfoManage/zhiao/MyPage_ph.aspx_60.http://**.**.**/InfoManage/zhiao/MyPage_ph.aspx_61.http://**.**.**/InfoManage/zhiao/MyPage_ph.aspx_62.http://**.**.**//InfoManage/zhiao/MyPage_ph.aspx_63.http://**.**.**/InfoManage/zhiao/MyPage_ph.aspx_***************^案^*****64.http://**.**.**//MyWork/wjk/Folders_show.aspxid=0_65.http://**.**.**/MyWork/wjk/Folders_show.aspxid=0_66.http://**.**.**/MyWork/wjk/Folders_show.aspxid=0_67.http://**.**.**/MyWork/wjk/Folders_show.aspxid=0_68.http://**.**.**/MyWork/wjk/Folders_show.aspxid=0_***************^案^**********e/zhiao/zil*****69.http://**.**.**/InfoManage/zhiao/ziliao_all.aspx_70.http://**.**.**/InfoManage/zhiao/ziliao_all.aspx_71.://**.**.**/InfoManage/zhiao/ziliao_all.aspx_72.http://**.**.**/InfoManage/zhiao/ziliao_all.aspx_***************^案^*****73.http://**.**.**/InfoManage/zhiao/wenti_yjj.aspx_74.http://**.**.**/InfoManage/zhiao/wenti_yjj.aspx_75.http://**.**.**/InfoManage/zhiao/wenti_yjj.aspx_76.http://**.**.**/InfoManage/zhiao/wenti_yjj.aspx_77.http://**.**.**//InfoManage/zhiao/wenti_yjj.aspx_***************^案^*****78.http://**.**.**//InfoManage/zhiao/wenti_all.aspx_79.http://**.**.**/InfoManage/zhiao/wenti_all.aspx_80.http://**.**.**/InfoManage/zhiao/wenti_all.aspx_81.http://**.**.**/InfoManage/zhiao/wenti_all.aspx_82.http://**.**.**/InfoManage/zhiao/wenti_all.aspx_***************^案^*****83.http://**.**.**/InfoManage/zhiao/wenti_wjj.aspx_84.http://**.**.**//InfoManage/zhiao/wenti_wjj.aspx_85.http://**.**.**//InfoManage/zhiao/wenti_wjj.aspx_86.http://**.**.**/InfoManage/zhiao/wenti_wjj.aspx_87.http://**.**.**/InfoManage/zhiao/wenti_wjj.aspx_***************^案^*****88.http://**.**.**/InfoManage/zhiao/wenti_xiaolei.aspxParentNodesID=1&id=0_89.http://**.**.**/InfoManage/zhiao/wenti_xiaolei.aspxParentNodesID=1&id=0_90.http://**.**.**/InfoManage/zhiao/wenti_xiaolei.aspxParentNodesID=1&id=0_91.http://**.**.**/InfoManage/zhiao/wenti_xiaolei.aspxParentNodesID=1&id=0_*****i_xiaolei.aspx?Pa********************^案^*****92.http://**.**.**/InfoManage/zhiao/ziliao_xiaolei.aspxParentNodesID=4&id=0_93.http://**.**.**//InfoManage/zhiao/ziliao_xiaolei.aspxParentNodesID=4&id=0_94.http://**.**.**//InfoManage/zhiao/ziliao_xiaolei.aspxParentNodesID=4&id=0_95.http://**.**.**//InfoManage/zhiao/ziliao_xiaolei.aspxParentNodesID=4&id=0_*****o_xiaolei.aspx?Par********************^处^*****96.http://**.**.**/InfoManage/zhiao/wenti_xiaolei_wjj.aspxParentNodesID=1&id=0_97.http://**.**.**//InfoManage/zhiao/wenti_xiaolei_wjj.aspxParentNodesID=1&id=0_98.http://**.**.**//InfoManage/zhiao/wenti_xiaolei_wjj.aspxParentNodesID=1&id=0_99.http://**.**.**//InfoManage/zhiao/wenti_xiaolei_wjj.aspxParentNodesID=1&id=0_*****_xiaolei_wjj.aspx?********************^处^*****100.http://**.**.**/InfoManage/zhiao/wenti_xiaolei_wjj.aspxParentNodesID=1&id=0_101.http://**.**.**/InfoManage/zhiao/wenti_xiaolei_yjj.aspxParentNodesID=1&id=0_102.http://**.**.**/InfoManage/zhiao/wenti_xiaolei_yjj.aspxParentNodesID=1&id=0_103.http://**.**.**/InfoManage/zhiao/wenti_xiaolei_yjj.aspxParentNodesID=1&id=0_*****xiaolei_yjj.aspx?P********************^处^*****104.http://**.**.**/InfoManage/zhiao/ziliao_tj.aspx_105.http://**.**.**//InfoManage/zhiao/ziliao_tj.aspx_106.http://**.**.**/InfoManage/zhiao/ziliao_tj.aspx_107.http://**.**.**/InfoManage/zhiao/ziliao_tj.aspx_*****e/zhiao/zil********************^处^*****108.http://**.**.**/InfoManage/zhiao/ziliao_xzph.aspx _109.http://**.**.**//InfoManage/zhiao/ziliao_xzph.aspx _110.http://**.**.**//InfoManage/zhiao/ziliao_xzph.aspx _111.http://**.**.**/InfoManage/zhiao/ziliao_xzph.aspx _112.http://**.**.**/InfoManage/zhiao/ziliao_xzph.aspx\n\n   漏洞证明：  Security Testing:本页漏洞内容仅为漏洞报告交由CNCERT/CNVD通知厂商处理，并非利用方法，请勿仿照漏洞报告进行恶意攻击入侵站点，由此带来的后果，漏洞作者概不负责！注意：有些可以使用--form参数获取表单，有些需要通过抓包工具获取表单；有些需要手工测试，有些需要SQLMAP测试；在禁用javascript脚本下测试；有些支持报错，有些支持盲注。\n第一处案例测试证明:/WorkFlow/WorkFlowListAll.aspx\n\n第二处案例测试证明:/WorkFlow/WorkFlowList_blz.aspx\n\n\n\n第三处案例测试证明:/WorkFlow/WorkFlowList_blz.aspx\n\n\n\n第四处案例测试证明:/WorkFlow/WorkFlowList.aspx\n\n\n\n第五处案例测试证明:/Resources/ResMg/MyResSyApplyYsp.aspx\n\n\n\n第六处案例测试证明:/YuSuan/Shenpi/Huankuan/HuankuanYSp.aspx\n\n\n\n\n\n\n\n第七处案例测试证明:/YuSuan/Shenpi/Jiekuan/JiekuanYSp.aspx\n\n\n\n第八处案例测试证明:/YuSuan/Shenpi/Baoxiao/BaoxiaoYSp.aspx\n\n\n\n\n\n\n\n第九处案例测试证明:/InfoManage/zhiao/MyPage_wt.aspx\n\n\n\n第十处案例测试证明:/InfoManage/zhiao/MyPage_hd.aspx\n\n\n\n第十一处案例测试证明:/InfoManage/zhiao/MyPage_zl.aspx\n\n\n\n第十二处案例测试证明:/InfoManage/zhiao/MyPage_yxz.aspx\n\n\n\n第十三处案例测试证明:/InfoManage/zhiao/MyPage_ph.aspx\n\n\n\n第十四处案例测试证明:/MyWork/wjk/Folders_show.aspx?id=0\n\n\n\n第十五处案例测试证明:/InfoManage/zhiao/ziliao_all.aspx\n\n\n\n第十六处案例测试证明:/InfoManage/zhiao/wenti_yjj.aspx\n\n\n\n第十七处案例测试证明:/InfoManage/zhiao/wenti_all.aspx\n\n\n\n第十八处案例测试证明:/InfoManage/zhiao/wenti_wjj.aspx\n\n\n\n第十九处案例测试证明:/InfoManage/zhiao/wenti_xiaolei.aspx?ParentNodesID=1&id=0 \n\n\n\n第二十处案例测试证明：\n\n\n\n第二十一处案例测试证明：\n\n\n\n第二十二处案例测试证明：\n\n\n\n第二十三处案例测试证明：\n\n\n\n第二十四处案例测试证明：\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-09-25 17:32 厂商回复： CNVD确认并复现所述情况，已由CNVD通过软件生产厂商公开联系渠道向其邮件通报，由其后续提供解决方案并协调相关用户单位处置。 按多个风险点评分,rank 20 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}