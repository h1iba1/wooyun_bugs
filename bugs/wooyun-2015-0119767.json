{"id": 29322, "wybug_id": "wooyun-2015-0119767", "wybug_title": "天涯论坛xss跨站一枚", "wybug_corp": "天涯社区", "wybug_author": "洪流", "wybug_date": "2015-06-11 14:11", "wybug_open_date": "2015-07-26 17:42", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["天涯", "跨站"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-26：\t细节向公众公开  简要描述： 天涯社区过滤不严导致用户发帖可插入<embed>标签，执行任意js代码。如被恶意利用，可通过跳转、弹窗、钓鱼、网马等方式令用户遭受损失，令平台信誉度降低。 详细说明：  天涯社区也存在这样的漏洞，例如：http://bbs.tianya.cn/post-193260-76-1.shtml整个板块都被人用来发广告了http://bbs.tianya.cn/list-193260-1.shtml其中帖子里被插入的关键代码如下：\n<embed class=\"video\" class=\"video\" src=http:\\/\\/tianya.cn.rc.090912.com\\/vodhtml/155.html width=120 height=120></embed><br>\n直接跳转到了一个视频网站。试想一下，如果换成其他的js代码呢？网马、弹窗钓鱼、替换链接……危害不是很大么？其中的链接“http:\\/\\/tianya.cn.rc.090912.com\\/vodhtml/155.html”应该是对链接过滤规则不对造成的，本来应该是指向“http://www.090912.com/vodhtml/155.html”这个链接。天涯社区可能只匹配了“http://”和“tianya.cn”，所以导致了<embed>标签可嵌入任意的符合该规则的链接，造成了该类型的跨站脚本攻击。参照之前的一个帖子 WooYun: 天涯社区过滤不严导致任意js代码执行，可用于跳转、弹窗、钓鱼等危害甚大 ,评个15Rank可以不~~   漏洞证明：  整个板块都被人用来发广告了\n\n这个是我用视频录制软件录下来之后截得图，打开之后显示不到一秒就跳转到视频网站去了\n\n跳转到了域名包含“tianya.cn”的视频网站\n\n天涯社区帖子的关键代码\n\n   修复方案：  过滤一下<embed>标签，还有修正一下链接过滤规则   版权声明：转载请注明来源 洪流@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-06-11 17:41 厂商回复： 非常感谢洪流提供的这个安全漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}