{"id": 82691, "wybug_id": "wooyun-2015-0150251", "wybug_title": "厦门机场官网存在sql注入漏洞", "wybug_corp": "厦空港集团", "wybug_author": "AnD", "wybug_date": "2015-10-29 14:50", "wybug_open_date": "2015-12-17 15:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄露", "注入", "隐私安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： RT  详细说明：  http://**.**.**.**/hbxx/hbxx.aspx?hkgs=MFhkgs参数存在注入漏洞\n\n   漏洞证明：  最近在研究sqlmap，网站服务器貌似比较脆弱，不小心弄成了503，sorry。考虑到系统比较重要，就不搞了，请各位大神帮忙解答下几个困惑吧，能留个联系方式最好了：1.网站数据库是mssql，--current-user取到的用户是\"sa\"，查看源码发现是\"SELECT value FROM storage WHERE id=?\", (hash_,)。这里的得到的用户。2.在获取用户的过程中hash_ = HashDB.hashKey(“SELECT SYSTEM_USER”)，先转成hash_，在根据hash_从storage表中取？3.sqlmap在执行上步时，用户‘sa’已经存入到了seesion.sqlite的storage表中，这个用户名是什么时候得到的，怎么得到的，又是什么时候存进去的呢。4.这个用户名获取的过程中，是如何绕过狗的呢。   修复方案：  另外这个洞，上次路过发现依然存在：  http://**.**.**.**/bugs/wooyun-2015-0141156   版权声明：转载请注明来源 AnD@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-11-02 15:28 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发对应分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}