{"id": 17583, "wybug_id": "wooyun-2012-010437", "wybug_title": "奇智堡垒机（linux）用户权限限制绕过漏洞", "wybug_corp": "奇智", "wybug_author": "unic02n", "wybug_date": "2012-08-01 12:30", "wybug_open_date": "2012-09-15 12:30", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-08-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-09-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-09-15：\t细节向公众公开  简要描述： linux用户权限，可从堡垒机里对该用户可执行的命令进行限制，但是存在绕过漏洞，可执行任意命令。但是鉴于堡垒机本身具有审计功能，所以这个漏洞的危害不会太大。但是作为安全设备自身的功能设计存在问题，就太不应该了。所以给10分。注：因为只测试公司自己的堡垒机，所以不确定其他公司的是否也存在此问题。本来想等确认了再发，但是没有条件做其他堡垒机测试，就先发出来。不谨慎一次吧。 详细说明：  利用管道可绕过堡垒机对命令权限的限制。堡垒机应该是没有验证管道后面的命令的权限。如执行id，没有权限。可以echo 1 | id,成功执行。   漏洞证明：  \n\n   修复方案：  你们自己看吧。   版权声明：转载请注明来源 unic02n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2012-08-03 11:35 厂商回复： CNVD根据图片确认漏洞情况（未直接复现，同时已经在内部积极测试其他厂商的堡垒机产品），昨天厂商（浙江齐治科技）已经主动联络，其反馈如下：感谢unic02n提出该问题。该问题并非产品漏洞，而是用户对产品功能的误解和使用不当。齐治堡垒机中的命令权限的原理是根据管理员设定的策略匹配用户 的输入，然后根据策略设定决定是否允许执行。因为Linux\\Unix设备中的命令行非常灵活，因此该功能在设计之初只建议用于网络设备。如果用户希望将该功能用于Linux\\Unix设备，我们建议使用白名单机制或者仅用于敏感命令的监控。如果方便请unic02n致电021-50270256，我们可以进一步沟通该问题的更多细节。另外，我们公司去年就已经更名为浙江齐治科技，而不是以前的杭州奇智信息科技。根据厂商建议,rank 3 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-08-01 13:16 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  有条件测试的兄弟可以试试，    \n     2012-08-02 09:15 |    \t\tleehenwu \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:24        | 撸·啊·撸)\t\t \n  公开后测试测试！！    \n     2012-08-02 09:32 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  @leehenwu 你有条件测试的话，可以给我个邮箱，你先测试测试，    \n     2012-08-02 09:56 |    \t\tTASS_傅奎 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:5        | Leander)\t\t \n  就是vi一个sh文件吧？单靠命令防火墙不行的，关键是权限控制和操作审计。    \n     2012-08-02 11:54 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  @TASS_傅奎 不是vi，那个属于间接，这个是直接bypass    \n     2012-08-03 10:27 |    \t\tleehenwu \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:24        | 撸·啊·撸)\t\t \n  @unic02n 349008242@qq.com 发我测试一下     \n     2012-08-03 11:51 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  比较高深 堡垒机 不懂    \n     2012-08-03 13:33 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  今天又看了下配置哪里，设备里是做不到拦截测试里绕过的方法的。也就是，基本可确定是设备的逻辑问题。并非是官方说的那样。你们叫什么也与我无关。你们给几分我也不会在意。大家看着呢，嘿嘿，    \n     2012-08-03 13:36 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  @leehenwu 发了，    \n     2012-09-03 15:14 |    \t\twsh_mars \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 世界没有不破的网)\t\t \n  唉，你们公司不会开除你？公开自己公司产品漏洞，牛白啊    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}