{"id": 66363, "wybug_id": "wooyun-2015-0140315", "wybug_title": "乐视网某系统配置不当导致Getshell", "wybug_corp": "乐视网", "wybug_author": "蓝冰", "wybug_date": "2015-09-10 21:40", "wybug_open_date": "2015-10-26 10:12", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["补丁不及时", "配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-26：\t细节向公众公开  简要描述： RT 详细说明：  \n历史漏洞:  WooYun: 乐视网某站SQL注入导致泄漏多个数据库 \nURL: http://bbs.g.letv.com当时通过注入 把uckey给注出来了,结果你们没有更换.对DZ接触不多搞了很久第一种姿势:从网上找了dzx系列利用uckey来getshell的代码,结果给我报了非法字符错误.后来知道是防灌水机制,需要带一个formhash参数就没事了.然后带了formhash不报错了.但还是失败,于是下了个dzx3.2到本地测试发现没有从单引号逃逸出去,目测打了补丁.另一种可能就是配置文件没有写权限.第二种姿势\n WooYun: 途牛网某服务配置失误 导致论坛敏感文件泄露(致使百万用户信息告急) \n本地搭建一个dz利用uckey重置目标网站任意用户.登录到后台,利用已公布的后台getshell方法均失败.第三种姿势\nhttp://drops.wooyun.org/papers/7830\nPOST一段xml数据\n\n然后利用这个代码\n$code = 'time='.$time.'&uid=1&username=admin&action=synlogin';\n登录任意用户发送短消息\n\n成功执行phpinfo()\n\n成功Getshell!!!\n\n   漏洞证明：  已证明全程只需一个UCKEY   修复方案：  运维配置要及时,当有人上报漏洞后,要及时更换重要的配置信息否则漏洞公开后会造成不必要的损失:)   版权声明：转载请注明来源 蓝冰@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-09-11 10:10 厂商回复： 感谢提交！该站为第三方合作站点，明确告知过合作方要更新漏洞中所提的配置信息，论坛未运行过，目前直接下线。感谢蓝冰！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-11 10:02 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1707 漏洞数:273        | ...........................................)\t\t \n  mark!蓝冰师傅就是屌    \n     2015-09-11 10:05 |    \t\tY4ngshu \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:7        | 十年磨一剑。)\t\t \n  蓝冰师傅又来瞎jb飞了    \n     2015-09-11 12:28 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1307 漏洞数:190        | 。)\t\t \n  又来日了    \n     2015-09-11 14:13 |    \t\t蓝冰 \t\t\t( 核心白帽子 |\t\t\t        Rank:652 漏洞数:52        | -.-)\t\t \n  @HackBraid  bin师傅你都大v了 ^_^    \n     2015-09-21 11:37 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1307 漏洞数:190        | 。)\t\t \n  好可怕 我就是那个重置密码搞不定 第三种学习了    \n     2015-09-21 11:40 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1307 漏洞数:190        | 。)\t\t \n  想起来了我利用的时候被自带的防护给拦了 求科普    \n     2015-09-21 12:43 |    \t\t蓝冰 \t\t\t( 核心白帽子 |\t\t\t        Rank:652 漏洞数:52        | -.-)\t\t \n  @scanf 是不是 error错误?  带上form hash参数就行啦  进首页或者其他页面都行  源代码搜索formhash 把值复制出来就行了 利用的时候带上这个值    \n     2015-09-21 13:03 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1307 漏洞数:190        | 。)\t\t \n  不是 是dz自带的拦截 而且就是这个站    \n     2015-09-21 16:18 |    \t\t蓝冰 \t\t\t( 核心白帽子 |\t\t\t        Rank:652 漏洞数:52        | -.-)\t\t \n  @scanf  没错啊 不带formhash 确实会被拦截的 你试过带这个参数了吗    \n     2015-09-21 21:27 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1307 漏洞数:190        | 。)\t\t \n  带了 看来写的脚本提交有时候不可靠    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}