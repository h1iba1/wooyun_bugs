{"id": 63927, "wybug_id": "wooyun-2013-028381", "wybug_title": "60度™ CMS 1.0后台COOKIE欺骗以及后台直接GETWEBSHELL", "wybug_corp": "60du.net", "wybug_author": "老黑", "wybug_date": "2013-07-11 23:34", "wybug_open_date": "2013-10-06 23:34", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "任意文件写入利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-16：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-09-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-06：\t细节向公众公开  简要描述： 60度™ CMS 1.0后台COOKIE绕过可导致直接拿下WEBSHELL 详细说明：  官方下载地址：http://60du.net/index.html核心文件是：管理员目录下的check.asp\n<!--#include file=\"../inc/md5.asp\"--><%'判断用户是否登陆if session(\"cmsname\")=\"\" and instr(CStr(Request.ServerVariables(\"SCRIPT_NAME\")),site_install&AdminPath&\"/login.asp\")=0 then    if request.Cookies(\"cmsname\")=\"\" then //判断cookie中cmsname是否为空        response.Redirect(site_install&AdminPath&\"/login.asp\")    elseif Session(\"admin_id\") =null then /判断cookie中cmsname是否为空     Response.Write(\"<script>alert('登陆超时！');parent.location = '\"&site_install&AdminPath&\"/login.asp';</script>\")    else        session(\"cmsname\")=request.Cookies(\"cmsname\")         session(\"cmsid\")=request.Cookies(\"cmsid\")    end ifend if%>\n直接伪造cookie,添加cmsname为任意数字 cmsid为1 然后刷新即可示例：对使用本套程序的一个WEB进行检测\n\n然后后台有文件编辑功能，可直接编辑ASP文件插入一句话\n\n    漏洞证明：  官方下载地址：http://60du.net/index.html核心文件是：管理员目录下的check.asp\n<!--#include file=\"../inc/md5.asp\"--><%'判断用户是否登陆if session(\"cmsname\")=\"\" and instr(CStr(Request.ServerVariables(\"SCRIPT_NAME\")),site_install&AdminPath&\"/login.asp\")=0 then    if request.Cookies(\"cmsname\")=\"\" then //判断cookie中cmsname是否为空        response.Redirect(site_install&AdminPath&\"/login.asp\")    elseif Session(\"admin_id\") =null then /判断cookie中cmsname是否为空     Response.Write(\"<script>alert('登陆超时！');parent.location = '\"&site_install&AdminPath&\"/login.asp';</script>\")    else        session(\"cmsname\")=request.Cookies(\"cmsname\")         session(\"cmsid\")=request.Cookies(\"cmsid\")    end ifend if%>\n直接伪造cookie,添加cmsname为任意数字 cmsid为1 然后刷新即可示例：对使用本套程序的一个WEB进行检测\n\n然后后台有文件编辑功能，可直接编辑ASP文件插入一句话\n\n    修复方案：  你们程序员比我专业   版权声明：转载请注明来源 老黑@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-10-06 23:34 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-16 18:33 |    \t\t老黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:161 漏洞数:61        | 最爱红颜不老。)\t\t \n  @60度CMS 还没确认么    \n     2013-07-17 12:00 |    \t\t老黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:161 漏洞数:61        | 最爱红颜不老。)\t\t \n  无影响厂商忽略  节操啊。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}