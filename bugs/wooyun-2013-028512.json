{"id": 10352, "wybug_id": "wooyun-2013-028512", "wybug_title": "某省重大危险源监督综合管理系统漏洞（数据众多，已控制服务器）", "wybug_corp": "广东省安全生产监督管理局", "wybug_author": "小胖子", "wybug_date": "2013-07-11 10:15", "wybug_open_date": "2013-08-25 10:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(广东省信息安全测评中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "管理后台对外", "字符类型注射", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-25：\t细节向公众公开  简要描述： 话不多说，尽在掌握，没敢其他事，好多表差点把我读死机。 详细说明：  相关单位：广东省安全生产监督管理局相关系统：mhi.gdsafety.gov.cn 广东省重大危险源监督综合管理系统相关问题：登陆处未做过滤，可以进行post注射，高权限，直接拿到服务器，同服全部沦陷，三个管理系统。测试过程：http://mhi.gdsafety.gov.cn/ 尝试用' 等字符判断，报错，果断是注射。登录，抓包，丢进SQLmap。\n\n发现确定是注入，且数据库账户权限很高，直接是DBA，且为2003系统，SQL2000，秒杀可能性很大。尝试读取数据库和表，不读不知道，一读吓一跳。数据库众多\navailable databases [26]:[*] cnooc[*] dgsafety[*] dgsde[*] dgtxsafety[*] gdmonitor[*] gdsafety[*] gdsafetynew[*] gdsafetyRescue[*] gdsafetyRescueBAK[*] gdsafetyTest[*] gdsafetyUpload[*] hmgsafety[*] jjsafety[*] master[*] model[*] msdb[*] Northwind[*] OA[*] pubs[*] sde[*] swsafety[*] tempdb[*] www_gdsafety_gov_cn[*] zhgxsafety[*] zqsafety[*] zssafetynew\n且当前数据库表也很多，差点把我读死机。本来想登陆进去看看，算了，不宜。直接OS-SHELL 添加名字为wooyun的账户。\n\n成功进入服务器：\n\n且觉得内网还有很多东西，不敢造次，赶紧上报。\n\n   漏洞证明：  见详细说明。\n\n   修复方案：  0x1：登陆处的username等参数过滤。0x2：数据库账户降权。0x3：一些系统不需要的组件请删除掉，不要给别人执行命令的权限。   版权声明：转载请注明来源 小胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-07-11 11:08 厂商回复： 感谢您的支持，我们会尽快处理相关问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-11 10:16 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2013-07-11 11:20 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  我公司？    \n     2013-07-19 17:20 |    \t\t爹 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:4        | 想...想活捉一枚处男...ing...)\t\t \n  哥哥坏    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}