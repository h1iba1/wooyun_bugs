{"id": 54929, "wybug_id": "wooyun-2014-062765", "wybug_title": "某通用图书管理系统多处漏洞导致getshell", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "飞扬风", "wybug_date": "2014-06-05 11:42", "wybug_open_date": "2014-09-03 11:44", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-03：\t细节向公众公开  简要描述： 前面发的不知道怎么标题错乱了一直没审核，还是重新提交下吧 详细说明：  天睿电子图书管理系统 WooYun: 天睿电子图书管理系统SQL注射0day（SA权限秒杀无数中小学网站服务器） 给出过该套系统的多处SQL注入以及该套系统搜索的方法inurl:mafen.asp?shuxing= 这里要说的漏洞主要是注入&&未授权访问&&上传无限制，导致最终getshell0x1 首先是后台登陆处存在SQL注入（绕过登陆） 后台登陆位置在/guanli.asp举例说明，例如平明小学http://221.181.233.195:10003/index.asp?shuxing=%E9%A6%96%E9%A1%B5后台登陆页面http://221.181.233.195:10003/guanli.asp用admin':admin登陆尝试一下登陆\n\n\n\n注入比较明显，可以用admin' or 'a'='a：admin直接登陆\n\ngetshell的话，直接在后台书籍管理->书籍添加处上传文件\n\n上传一句话\n\n\n\n\n\n   漏洞证明：  0x2 拿下后台之后发现上传点存在未授权访问的问题，无需登陆后台即可实现上传，这是直接getshell的节奏上传点1：/upfile_1.asp（即为0x1中的上传点）例如：http://ts.gylyxx.com/upfile_1.asp\n\n上传点2：/upload.asp例如：http://222.189.45.162/dzts/upload.asp\n\n上传点3：/upfile_bf.asp例如：http://222.189.45.162/dzts/upfile_bf.asp\n\n   修复方案：  0x1 后台登陆处应该加强过滤，避免bypass0x2 上传点不允许未授权访问0x3 上传文件后缀名进行控制   版权声明：转载请注明来源 飞扬风@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-06-10 09:44 厂商回复： CNVD暂未能通过公开联系方式建立处置渠道，暂未列入处置流程。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}