{"id": 41032, "wybug_id": "wooyun-2015-090122", "wybug_title": "华为网盘储存型xss一枚", "wybug_corp": "华为技术有限公司", "wybug_author": "roker", "wybug_date": "2015-01-06 16:48", "wybug_open_date": "2015-02-20 16:50", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-20：\t细节向公众公开  简要描述： RT。 thk  @/fd. 详细说明：  买了荣耀6.就测试下咯。。上传文件。发布外链。修改外链名称发现对\" 实体编码可以制造出一个输出点。\n<meta name=\"keywords\" content=\"\",输出点,网盘,华为网盘,DBank网盘,免费网盘,网络硬盘,网盘下载,网络存储空间,云存储\"/>\n两种利用方法，第一种 http-equiv=\"Refresh\"插入代码 \n0,url=data&#58;text&#47;html;base64,PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4K&#34;http-equiv=&#34;Refresh&#34;.txt\n\n\n\n\n由于是 data。无法传递cookie。但是发现华为大部分操作没有token 所以可以利用 cors (Cross-Origin Resource Sharing) post数据 造成蠕虫之类的影响。第二种。ie only利用代码 \n\"charset=utf-7 +AD4APA-script+AD4-alert(document.cookie)+ADw-/script+AD4-\nie 或者 qq浏览器（ie内核的浏览器即可） 打开 http://dl.vmall.com/c0iem6xdrx?v=149900454&%3Cmeta%20http-equiv%3D\n\n这个就能传递cookie之类的数据了。缺点是 浏览器限制以及 类似于反射性xss了原理是 get的数据带上了 <meta http-equiv> 利用xss filter 处理调了原先的 charset。   漏洞证明：  如上所述   修复方案：  加强过滤~~   版权声明：转载请注明来源 roker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-01-07 16:02 厂商回复： 非常感谢您对华为公司的关注，我们已经通知业务部门进行整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-06 16:52 |    \t\t牛肉包子 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:64        )\t\t \n  我又来膜拜爷爷了    \n     2015-01-27 17:58 |    \t\tCroxy \t\t\t( 普通白帽子  |\t\t\t        Rank:513 漏洞数:54        | 只会送人头)\t\t \n   偷偷MARK  学习了>.<    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}