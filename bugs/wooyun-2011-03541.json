{"id": 65244, "wybug_id": "wooyun-2011-03541", "wybug_title": "phpdisk网盘上传解析漏洞", "wybug_corp": "phpdisk.com", "wybug_author": "小航", "wybug_date": "2011-12-05 18:28", "wybug_open_date": "2011-12-26 12:38", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["解析漏洞", "服务器配置不当", "文件上传安全", "上传目录权限控制不当", "系统影响", "影响应用程序安全性"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-12-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-12-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： phpdisk系统，用的蛮多，这个解析漏洞有点鸡肋，phpdisk版本不是通杀。 详细说明：  近期搞个网盘站发现的一个解析漏洞，phpdisk系统，用的蛮多，这个解析漏洞有点鸡肋，phpdisk版本不是通杀。\n\n因为是PHP程序，所以服务器一定支持PHP，这程序后台限制了php.asp.aspx.php2.等一些脚本上传。但是可以上传1.php;rar.这样的程序，利用IIS6的解析漏洞。我们把PHP马改成1.php;rar，如果改成1.php;.rar就不行了，因为他会自动变名字的。1.php;rar他变名字但是.php;rar不会被变。上传后找路径。\n\n右键电信下载1.然后属性。\n\n基本是这样的， 上传到的目录地址从robots.txt可以知道Disallow: /filestores/这个目录是默认上传目录木马地址就是 这是IIS6 的漏洞。nginx 的 可以直接传一个图片一句话马，配合 2种解析漏洞。第一种是http://www.xxx.com/filestores/2011/11/27/9fd4b463a22085ee4a3f011a592ed4a7.jpg/1.phpnginx还有一个解析漏洞，关注的人不多。格式如下。http://www.xxxx.com/filestores/2011/11/27/9fd4b463a22085ee4a3f011a592ed4a7.jpg%00.php   漏洞证明：  你懂得你懂得你懂得你懂得你懂得你懂得你懂得你懂得你懂得你懂得你懂得你懂得你懂得你懂得你懂得   修复方案：  总结与修补：此漏洞是后台过滤关键字不严格。修补方法1.在后台设置过滤掉的后缀。2。修改默认的上传目录。或者不给脚本权限。3.nginx的提高版本。4.隐藏下载地址。   版权声明：转载请注明来源 小航@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2011-12-26 12:38 厂商回复：  漏洞Rank：5  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-20 10:51 |    \t\t小小泥娃 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | 高二)\t\t \n  求详细图片！    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}