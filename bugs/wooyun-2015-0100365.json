{"id": 44479, "wybug_id": "wooyun-2015-0100365", "wybug_title": "联想某商城SQL INSERT注入", "wybug_corp": "联想", "wybug_author": "bey0nd", "wybug_date": "2015-03-09 18:41", "wybug_open_date": "2015-04-23 18:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧", "类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-23：\t细节向公众公开  简要描述： INSERT注入技巧~~ 详细说明：  站点：http://club.lenovo.com.cn/联想积分商城get注入\nhttp://club.lenovo.com.cn/idea/club/index.php?m=shop&c=index&f=collect&goods_id=78231246ce8711e381a446631c66a91e\n其中goods_id可以注入，虽然编号是加密的，但是不影响注入哈~~goods_id随便写个，测试下\n\n看到insert操作。\nsql:insert into c_goods_collect(user_id, goods_id,cdate) values('3002307','1231'','2015-03-09 18:02:07')\n其中我们可控的只有goods_id，工具的话跑不出来。但是我们可以构造一个多条插入的操作，例如\ninsert into c_goods_collect(user_id, goods_id,cdate) values('3002307','1231'','2015-03-09 18:02:07'),('3002307','1231'','2015-03-09 18:02:07')\n这样的话可以插入两条记录，其中前面部分就可以控制了。\n\n这样的话，插入的第一条可控、列cdate就可以控制了，其中cdate是datetime类型。直接插入其他类型就会直接报错，就有了报错注入 。如下\n\n直接爆一下\n\n具体数据就不整了吧。。商城的...数据大大的   漏洞证明：  \n\n   修复方案：  过滤   版权声明：转载请注明来源 bey0nd@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-03-10 09:43 厂商回复： 谢谢您对联想安全工作的支持,我们会尽快修复漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-24 12:25 |    \t\tAerfa21 \t\t\t( 普通白帽子  |\t\t\t        Rank:165 漏洞数:44        )\t\t \n  利用goods_id参数构造出多条插入语句实在是巧妙呀，构造出的第一条语句可控，不过那为啥要选构造出的cdate不选goods_id进行注入呢？再返回去想想，为啥不直接使用goods_id进行报错注入？PS：很好奇goods_id是什么编码？    \n     2015-04-24 13:51 |    \t\tbey0nd \t\t\t( 普通白帽子  |\t\t\t        Rank:895 漏洞数:142        | 相忘于江湖，不如相濡以沫)\t\t \n  @Aerfa21 选cdate是为了让服务器报错，因为类型不符，为什么不选googs_id是因为他服务器没有回显。因为是插入操作，所有他的回显只是说执行结果，这个我是试过的。这个要分具体情况来看    \n     2015-04-24 17:15 |    \t\tAerfa21 \t\t\t( 普通白帽子  |\t\t\t        Rank:165 漏洞数:44        )\t\t \n  @bey0nd 看来手工之路巧妙、艰辛呀    \n     2015-04-24 17:18 |    \t\tbey0nd \t\t\t( 普通白帽子  |\t\t\t        Rank:895 漏洞数:142        | 相忘于江湖，不如相濡以沫)\t\t \n  @Aerfa21 其实我也是半吊子。。工具老不好使，没办法    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}