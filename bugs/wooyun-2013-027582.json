{"id": 10603, "wybug_id": "wooyun-2013-027582", "wybug_title": "汽车之家漏洞系列-越权修改用户数据", "wybug_corp": "汽车之家", "wybug_author": "带馅儿馒头", "wybug_date": "2013-07-03 14:09", "wybug_open_date": "2013-08-17 14:10", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "敏感接口未加权限认证", "越权操作", "未授权访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-17：\t细节向公众公开  简要描述： RT 详细说明：  \n问题站点k.autohome.com.cn\n1.注册两个用户，各发表一篇某车型的使用口碑帖子；\n\n\n\n2.首先我们尝试在第二个用户登录的情况下，修改第一个用户的帖子，我们发现修改帖子请求如下；\nhttp://k.autohome.com.cn/form/carinput/edit/185651\n3.如果我们直接访问的话，系统会提示口碑不存在；\n\n4.于是我们修改第二个用户的帖子信息如下；\n\n5.点击提交并抓包，修改id信息为第一个用户的帖子id；\n\n6.提交后系统提示我们修改成功了；\n\n7.我们返回页面刷新，发现第一个用户的帖子信息被成功修改；\n\nPS：这里未校验referer，也可通过csrf发布帖子！---------------------------------------------------------------------------CSRF问题：系统收听某人和给某人发消息都是post请求，但这里对接口校验不严格导致可使用get方式提交请求，再合适的场景下可能诱发蠕虫；收听某人：http://i.autohome.com.cn/ajax/relations/addfollower?fuid=7905255\n\n给某人发送消息：http://i.service.autohome.com.cn/clubapp/Message/SendMessage?txtName=nocar_guy&txtContent=test&ReturnType=3\n\n   漏洞证明：  见详细说明   修复方案：  在请求的每个阶段都严格校验用户身份；严格校验敏感操作接口；敏感操作处严格校验referer；   版权声明：转载请注明来源 带馅儿馒头@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-07-03 16:54 厂商回复： 正在修复，感谢对汽车之家的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-03 14:19 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  有礼物没    \n     2013-07-03 14:20 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:143        | 心在，梦在)\t\t \n  @小胖胖要减肥 大牛发个试试就知道了：）    \n     2013-07-03 14:23 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  越权要火啊    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}