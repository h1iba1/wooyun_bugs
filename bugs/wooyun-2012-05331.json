{"id": 21143, "wybug_id": "wooyun-2012-05331", "wybug_title": "大量政府网站使用的安徽商网的建站系统存在sql注入(续)", "wybug_corp": "安徽商网", "wybug_author": "possible", "wybug_date": "2012-03-18 15:04", "wybug_open_date": "2012-03-18 15:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-03-18：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-03-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 以前发过http://www.wooyun.org/bugs/wooyun-2010-04869今天没事重新测试一下，看看修复没有... 简单把利用方法总结一下，由于没有看源码，应该问题比较多，其它的漏洞厂商自己发现吧。当然最主要是希望被收录，及时修复漏洞，最后赏点rank，就感激不尽，不枉忙乎1一个小时，呵呵。不收录仅当娱乐... 详细说明：  安徽省境内大量政府、学校、企业使用的安徽商网建站系统php版存在sql注入，该漏洞的利用方法很简单，通过sql注入获得管理员用户名和密码，直接登录后台，后台的上传功能，将上传的x.php文件重命名x.php.off，利用apache的解析漏洞直接获得webshell。   漏洞证明：  声明:以下内容只是为了证明漏洞存在以及危害，没有做任何与破坏有关事情，请不要catch我，谢谢!如果认为该漏洞有价值，请给点rank就可以了...首先 安徽商网自身主站没有修复，继续注入http://www.ishang.net/include/content_view.php?id=216+and+1=2+union+select+1,2,concat_ws%280x3A,username,password%29,4,5,6,7,8,89,10,11,12,13,14+from+web_user\n\n随便找一个站点测试一下:http://www.ahhfjxjx.com/include/web_content.php?id=342+and+1=2%20+union+select+1,2,concat_ws%280x3a,username,password%29,4,5,6,7,8,9,10,11,12,13+from+web_user%23\n\n初次看到这个密码，让人摸不到头脑，其实这套系统自己构造了一个对密码加密的方法，如果没有源码还真难弄，而且不是开源的cms。（我也是运气，知道了这个加密方法)加密与解密函数（在myweb.class.php文件中）:\n\n因此4d4e46484b 对应的明文密码是:21974 登录后台:\n\n利用后台文件管理上传功能获得webshell:\n\n拿到shell看一下发现，基本上使用安徽商网的站都在上面，\n\n在shell中查看一下:\n\n可以跨站访问，从a到z每个子目录下都有站\n\n没有具体去看到底有多少，基本上是政府、学校、企业。当然有很多站点被旁注如:中国妈妈 http://www.china-mama.com/  就会这点，其它的seo、挂马啥的 不会，但是感觉这个服务器很适合做这些...   修复方案：  修复都懂，只是想请教管理员这个服务器是怎么配置的？为什么httpd.conf中并没有配置这么多虚拟主机？在哪里配置的谢谢？   版权声明：转载请注明来源 possible@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-03-18 21:33 |    \t\tc4rp3nt3r \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:10        | 人生的意义就在于从一个圈子跳到另一个更大...)\t\t \n  这个注射漏洞几年前就爆出来了,有一期黑客防线上有记录.大约2年了.    \n     2012-03-18 21:34 |    \t\tc4rp3nt3r \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:10        | 人生的意义就在于从一个圈子跳到另一个更大...)\t\t \n  加密方法黑盒就能猜出来    \n     2012-03-19 09:03 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  @c4rp3nt3r 哦 我又孤陋了...    \n     2012-04-08 05:27 |    \t\tSinCoder \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n    遇到了个 mysql 3.2 的 。。。蛋疼了。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}