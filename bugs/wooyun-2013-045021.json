{"id": 6554, "wybug_id": "wooyun-2013-045021", "wybug_title": "劫持中国电信天翼用户中心注册用户【理论篇】", "wybug_corp": "中国电信", "wybug_author": "李旭敏", "wybug_date": "2013-12-06 17:17", "wybug_open_date": "2014-01-20 17:18", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "19", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-20：\t细节向公众公开  简要描述： 之所以说是理论篇，只是理论上可以成功···并没有真正成功。故自评19rank下一集更精彩 详细说明：  本想社下我的宿敌高富帅的电信的号码，189开头···通过百度，找到了http://e.189.cn/一个天翼用户中心····好像是新出的。这个是后话了···找回密码\n\n不能密保问题找回，只能通过发送验证码到手机找回····在这之前我用自己的手机测试了一下，发现验证码是4位数的·保质限是30分钟\n\n有图有真相···\n\n\n\n我公司的网速是10MB/s的，爆破4位数的话也就几分钟的事情···通过记事本的替换功能，我快速找到了正确的验证码2905···真当我开心的填入验证码的时候，他提示验证码错误，我以为是爆破失误了，我自己拿自己的手机测试了一下，验证码是1234，我用burp suit爆破一遍，的确也提示1234的返回长度和其他的不一样。但是我再去网页填写验证码1234的时候，提示仍然是错误。几番折腾后，大概晓得咋回事，burp suit爆破的时候，把正确的验证码post出去，然后返回了一个修改密码页面的数据。从而，我们判断这个才是正确的验证码，但是如果，我在了浏览器输入的时候，他提示错误，那是因为返回数据的时候，这个验证码已经被输入使用了。但是burp suit返回的时候是不能浏览页面的。所以这个页面自然也就失效了···我请教了园长姐姐，请教了肉肉和IDF实验室的好人叔叔（真心好人）。他说这种必然是保持会话才能判断是否已经发送过验证码，换个机子或者重新连接后手动发送验证码就可以收到应答页面了。我用肉总的电脑试了一下，还是失败了···果然是一次性验证啊···故失败了···但理论是肯定行得通的。差个爆破工具   漏洞证明：  利用一个可以爆破时返回浏览界面的工具，比如网上可以找到webshell爆破工具，就是自动填入字典密码，然后模拟用户点击下一步，如果页面跳转了。那么就自动停止提示爆破成功。又或者是百度找的那种半自动注册邮箱软件，比如他会自动帮你写入邮箱，你手动写入验证码后可以自动点击下一步····以上漏洞应该在burp suit是行不通的。可以通过溯雪试试，我用溯雪的时候不知道怎么自定义表段·······我本人编程渣，测试不了。有心人可以自己测试。有连载，求过····   修复方案：  1.限制每日找回密码的次数2.验证码延伸至8位数字，或者加上字母3.装个WAF吧，我今天尝试爆破不下十次了，发了这么多请求网站都没拦截，肯定没装安全软件。   版权声明：转载请注明来源 李旭敏@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-12-10 22:12 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-05 17:19 |    \t\t　 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | 　)\t\t \n  哎哟，不错哦~    \n     2013-12-05 18:02 |    \t\t坠落。 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:2        | -.- 屌丝一枚,菜鸟一个,擅长windows/linux...)\t\t \n  mark    \n     2013-12-05 22:11 |    \t\t撸王之王撸断肠 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | 撸不动了)\t\t \n  mark    \n     2013-12-05 22:23 |    \t\t丶潇洒哥 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 我是一枚农民工。)\t\t \n  前排，广告位出租、。    \n     2013-12-06 08:13 |    \t\t Jesus \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:18        | 天地不仁,以万物为刍狗！)\t\t \n  mark    \n     2013-12-10 22:57 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  我记得不是公开了吗！？被追回了！？    \n     2013-12-31 09:41 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  burp差个功能，我觉得首先让你手动测试一个验证码，然后返回基本上是失败的，这个失败的长度我们可以知道。然后再进行遍历，当长度返回不一样的时候，把返回页面显示。    \n     2014-01-10 09:28 |    \t\t爷 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        | 道可道，非常道。)\t\t \n  我想说楼主 不错， 但是问的几个兄弟就2B了，这么简单的一个问题都这么复杂。因为爆破时，已经把正切的验证码给使用了， 在去用同一个验证码，肯定是不行的。直接用BurpSuite的 show response 不就得了吗？。。。今早脱离娱乐圈！！！  什么鸟实验室，这么简答的一个问题。    \n     2014-01-20 19:16 |    \t\t蜉蝣 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:24        )\t\t \n  点击数据包长度栏，即可重新按小到高排列数据包，看到正确返回参数分分秒，何必保存txt？    \n     2014-03-13 02:11 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  这个问题我也遇到过，洞主现在有方法解决了么    \n     2014-03-13 10:29 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  @魇 8L好像有解决方法··    \n     2014-03-13 10:43 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  @爷 @李旭敏 BURP的show response 求详解？     \n     2014-03-13 10:53 |    \t\t李旭敏 \t\t\t( 普通白帽子  |\t\t\t        Rank:469 漏洞数:71        | ฏ๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎๎...)\t\t \n  @魇 我也没了解他说的功能··目前最好的方法就是如文中所说，写一个自动爆破验证码的工具，并且可以自定义线程    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}