{"id": 46645, "wybug_id": "wooyun-2015-089974", "wybug_title": "某大型支付机构电子支付客户关系管理系统整站源码可下载", "wybug_corp": "chinapay.com", "wybug_author": "路人甲", "wybug_date": "2015-01-04 22:29", "wybug_open_date": "2015-02-18 22:30", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-18：\t细节向公众公开  简要描述： 某大型支付机构电子支付客户关系管理系统整站源码可下载，且还存在SQL注入漏洞，敏感部门的敏感系统，不敢进一步测试。 详细说明：  http://crm.chinapay.com/\n\n\n整站源码可下载http://crm.chinapay.com/www.rar\nSQL注入漏洞 WooYun: 用友TurboCRM SQL盲注(通杀所有版本)   漏洞证明：  \n\n\n$dd = TDD_GetDatadict();//装载数据词典$dealconn = mssql_connect(SQL_DEALSYS_IP,SQL_DEALSYSACCOUNT,SQL_DEALSYSPASSWD) or die('连接数据库错误');$dealconn = mssql_connect('10.*.**.239','crm_login','chinapay') or die('连接数据库错误');mssql_select_db('CPDataWarehouse');$day = date('Y-m-d',time()-24*60*60);$day = gmdate('Y-m-d');$day = '2013-08-26';   $nowtime = time();     $nowstr = gmdate('Y-m-d H:i:s', ($nowtime+8*60*60));$dqrq=date(\"Y-m-d\",$nowstr);//当前日期$day=date(\"Y-m-d\",strtotime(\"-2 day\",strtotime($dqrq)));echo($day);$startDay = $day.' 00:00:00';$endDay = $day.' 23:59:59';$crmdate = gmdate('Y-m-d H:i:s');//支付控台$get1Sql = \"select *,DailyTransDate as TransDate,SucceedTransCount as Count,SucceedTransAmount as Amount from SQLCP.CPDataWarehouse.dbo.FactDailyTrans where DailyTransDate >= '$startDay' and DailyTransDate <= '$endDay'\";//ORA代付平台$get2Sql = \"select CPDate as TransDate,MerchantNo,sum(TransCount) as Count,SUM(TransAmount) as Amount    from SQLCP.CPDataWarehouse.dbo.Table_OraTransSum    where CPDate >= '$startDay'    and CPDate <= '$endDay'   group by CPDate,MerchantNo\";//基金转账$get3Sql = \"SELECT MerchantNo,TransDate,sum(TransAmt) as Amount,count(MerchantNo) as  Count  FROM SQLCP.CPDataWarehouse.dbo.Table_TrfTransLog    where   TransDate >= '$startDay' and TransDate <= '$endDay'  group by MerchantNo,TransDate\";  //西联汇款表$get4Sql = \"select MerchantNo,TransDate,COUNT(MerchantNo)as Count,sum(DestTransAmount)as Amount    from SQLCP.CPDataWarehouse.dbo.Table_WUTransLog   where TransDate >= '$startDay'   and TransDate <= '$endDay'   group by MerchantNo,TransDate\";\n   修复方案：  删除   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-01-09 17:08 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向网站管理单位通报,其反馈已经及时修复漏洞.按备份文件信息风险评分,rank 7 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}