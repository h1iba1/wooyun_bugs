{"id": 6747, "wybug_id": "wooyun-2013-039724", "wybug_title": "我是如何破解哈工大VPN", "wybug_corp": "vpn.hit.edu.cn", "wybug_author": "zhengzheng", "wybug_date": "2013-10-14 22:40", "wybug_open_date": "2014-01-12 22:41", "wybug_type": "权限控制绕过", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-20：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-12-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-12：\t细节向公众公开  简要描述： 哈尔滨工业大学只是在每年寒暑假期间会为学生开通VPN，学生登陆方式为学号@student+密码，但是平时即使有正确的帐号和密码也是登录不进去的，利用火狐+firefox插件的形式可以通过修改html代码的方式，绕过浏览器，将数据向后台进行提交，从而获得登录VPN的权限。 详细说明：  在Realm后边的下拉列表中，如果在寒暑假期间会有这样一个option属性：<option value=\"Student\">Student</option>,但是在正常教学工作周内是没有这样的选项，一开始以为网络中心的老师不仅去掉了前台的html代码，而且还在后台加入了验证，所以导致平时无法登录，后来想想，老师也有偷懒的时候吗，也许他只删掉了前台html代码呢？好了，那就大胆设想，小心求证，利用firefox插件很容易的实现了我的想法，并通过了验证，下图就是我用自己的帐号登录的哦~各位身在哈工大却没有开通校园网的童鞋有福利了！将这行代码<option value=\"Users-Realm\">Users-Realm</option>修改为<option value=\"Student\">Student</option>，然后输入正确的学号密码就可以登录了！不过注意username字段正确的格式应该为：学号@student，密码为校园身份统一认证密码！\n\n   漏洞证明：  \n\n\n\n   修复方案：  后台添加验证，哈工大的童鞋不要拍我呀~我可耻的行为是为了拿到乌云的帐号~   版权声明：转载请注明来源 zhengzheng@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2013-10-17 22:47 厂商回复： CNVD确认所述情况，已经转由CNCERT同时通报教育部教育管理信息中心、CCERT以及上海交通大学网络信息中心，借助上述教育网机构处置渠道进行处置。firefox有很强大的插件或测试组件，该案例较为经典，可供各白帽子参考。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-14 23:38 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  看到简要描述，我忍不住说一句：哎呀我去~~    \n     2013-11-07 10:17 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  这rank，感觉偏高……    \n     2014-01-12 23:28 |    \t\thacker@sina.cn \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:27        | ANONYMOUS)\t\t \n  呵呵，这种只有内部人才知道。    \n     2014-09-15 16:52 |    \t\twooOver \t\t\t( 普通白帽子  |\t\t\t        Rank:318 漏洞数:83        | 我要控制我自己)\t\t \n  我当年发现这个小秘密后一直这么用于出差的时候查论文，只不过我是本地修改HTML文件把用户名密码固定死再添加书签，用起来非常方便，后来有一天突然不好使了...今天看到原来是你报告到乌云上了...    \n     2014-10-07 01:33 |    \t\t飞天鼠 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 努力学习)\t\t \n  @wooOver 老师是工大的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}