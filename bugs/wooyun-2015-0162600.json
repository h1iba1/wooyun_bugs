{"id": 73706, "wybug_id": "wooyun-2015-0162600", "wybug_title": "拉手网主站SQL注入（绕过过滤机制）", "wybug_corp": "拉手网", "wybug_author": "沦沦", "wybug_date": "2015-12-19 09:26", "wybug_open_date": "2016-02-01 19:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-01：\t细节向公众公开  简要描述： 拉手网主站SQL注入（绕过过滤机制） 详细说明：  \nPOST /ajax/address.php?modify=m HTTP/1.1Host: www.lashou.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:42.0) Gecko/20100101 Firefox/42.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://www.lashou.com/account/address/Cookie: client_key=2f06c4d7dfb3f8281ddff967ca8d600e; visit_city_string=beijing; __utma=1.1169558814.1450413021.1450441806.1450449931.3; __utmz=1.1450413021.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); uuid=9abe7913c3df1c973089208e4923e0f968eejxu15676286184; downBanner=1; history=9028797%2C10895388; lastpay=alipay; __utmv=1.|2=%E8%B4%AD%E4%B9%B0%E7%8A%B6%E6%80%81=%E9%A6%96%E6%AC%A1%E8%B4%AD%E4%B9%B0=1; ThinkID=7v2nkos6s8l9v63npm1k8c7ie3; __utmc=1; login_name2=per1sh; pwd2=f4a95c006e7939b1b7c68cd30c1c79cf; city_b=2419; show_index_qr=1; view_goods=%5B%2211981290%22%2C%2211939804%22%5D; weatherinfo=%u5317%u4EAC%2C1%2C11%2C%u591A%u4E91%2C32%u2103%7E19%u2103X-Forwarded-For: 8.8.8.8Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 281id=27198894&id=27198894&username=1111&province=130000&city=130300&town=110228&address=111111111111111111&code=100001&phone1=&phone2=&phone3=&mobliephone=130****0764&real_mobliephone=130****0764\nid参数没进行过滤，可进行延进注入延时3秒\n\n延时2秒\n\n判断长度当前数据库长度为4\n\n由于过滤了一部份关健字包括ascii被过滤了，但还是能绕过的\n\ndatabase:logs   漏洞证明：  \nPOST /ajax/address.php?modify=m HTTP/1.1Host: www.lashou.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:42.0) Gecko/20100101 Firefox/42.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://www.lashou.com/account/address/Cookie: client_key=2f06c4d7dfb3f8281ddff967ca8d600e; visit_city_string=beijing; __utma=1.1169558814.1450413021.1450441806.1450449931.3; __utmz=1.1450413021.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); uuid=9abe7913c3df1c973089208e4923e0f968eejxu15676286184; downBanner=1; history=9028797%2C10895388; lastpay=alipay; __utmv=1.|2=%E8%B4%AD%E4%B9%B0%E7%8A%B6%E6%80%81=%E9%A6%96%E6%AC%A1%E8%B4%AD%E4%B9%B0=1; ThinkID=7v2nkos6s8l9v63npm1k8c7ie3; __utmc=1; login_name2=per1sh; pwd2=f4a95c006e7939b1b7c68cd30c1c79cf; city_b=2419; show_index_qr=1; view_goods=%5B%2211981290%22%2C%2211939804%22%5D; weatherinfo=%u5317%u4EAC%2C1%2C11%2C%u591A%u4E91%2C32%u2103%7E19%u2103X-Forwarded-For: 8.8.8.8Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 281id=27198894&id=27198894&username=1111&province=130000&city=130300&town=110228&address=111111111111111111&code=100001&phone1=&phone2=&phone3=&mobliephone=130****0764&real_mobliephone=130****0764\nid参数没进行过滤，可进行延进注入延时3秒\n\n延时2秒\n\n判断长度当前数据库长度为4\n\n由于过滤了一部份关健字包括ascii被过滤了，但还是能绕过的\n\ndatabase:logs   修复方案：  过滤   版权声明：转载请注明来源 沦沦@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2015-12-19 11:01 厂商回复： 谢谢您的反馈,我们正在处理. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-19 09:46 |    \t\tago \t\t\t( 普通白帽子  |\t\t\t        Rank:544 漏洞数:93        )\t\t \n  掐指一算，有第三发    \n     2015-12-19 12:46 |    \t\tBear baby \t\t\t( 普通白帽子  |\t\t\t        Rank:187 漏洞数:22        | 进步的唯一方式是坚持学习)\t\t \n  沦总，求装备。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}