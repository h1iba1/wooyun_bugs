{"id": 35230, "wybug_id": "wooyun-2015-0104405", "wybug_title": "指付通官网命令执行漏洞", "wybug_corp": "指付通", "wybug_author": "路人甲", "wybug_date": "2015-03-30 17:37", "wybug_open_date": "2015-05-14 17:38", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行", "补丁不及时"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-30：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-05-14：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 指付通官网数字域名网站存在struts2命令执行漏洞可执行任意命令可getshell等。。涉及数据库量大 详细说明：  \n指付通官网数字域名网站存在struts2命令执行漏洞可执行任意命令可getshell等。。涉及数据库量大《只贴出部分》\n\n\n\n\n   漏洞证明：  漏洞地址：http://www.x6868.com:8081/htjAction!getShanghuByshId.action?sh_id=141数据库信息就不贴出来了\n\n以getshell\n\n算了还是贴一部分吧。。。部分数据库信息\n<!--<bean id=\"dataSource\"\t\tclass=\"org.springframework.jndi.JndiObjectFactoryBean\">\t\t<property name=\"jndiName\" value=\"java:comp/env/jdbc/fps\"/>   \t\t</bean>--> \t<bean id=\"propertyConfigurer\"\t\tclass=\"org.springframework.beans.factory.config.PropertyPlaceholderConfigurer\">\t\t<property name=\"location\"\t\t\tvalue=\"classpath:db1.properties\" />\t</bean>\t<!-- ora9i????????疆 -->\t<bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\">\t <!-- \t\t<property name=\"driverClassName\" value=\"oracle.jdbc.driver.OracleDriver\" />\t\t<property name=\"url\" value=\"jdbc:oracle:thin:@db01.UAT.livebytouch.com:1521:LBT\" />\t\t<property name=\"username\" value=\"fps\"/>\t\t<property name=\"password\" value=\"fps\"/>\t -->\t\t\t<!--\t\t\t<property name=\"driverClassName\" value=\"oracle.jdbc.driver.OracleDriver\" />\t\t<property name=\"url\" value=\"jdbc:oracle:thin:@192.168.1.10:1521:ora9i\" />\t\t<property name=\"username\" value=\"fps\"/>\t\t<property name=\"password\" value=\"fps\"/>\t\t-->\t\t<!--\t\t\t<property name=\"driverClassName\" value=\"oracle.jdbc.driver.OracleDriver\" />\t\t<property name=\"url\" value=\"jdbc:oracle:thin:@lbtoracledb.livebytouch.com:1521:LBT\" />\t\t<property name=\"username\" value=\"fps\"/>\t\t<property name=\"password\" value=\"fps\"/>\t\t-->\t\t\t\t\t<property name=\"driverClassName\" value=\"${ORACLE_DRIVER}\" />\t\t<property name=\"url\" value=\"${ORACLE_FPS_URL}\" />\t\t<property name=\"username\" value=\"${ORACLE_FPS_USER}\"/>\t\t<property name=\"password\" value=\"${ORACLE_FPS_PWD}\"/>\t</bean>\n\n<bean id=\"dataSource1\" class=\"org.apache.commons.dbcp.BasicDataSource\">\t\t<!-- \t\t<property name=\"driverClassName\" value=\"oracle.jdbc.driver.OracleDriver\" />\t\t<property name=\"url\" value=\"jdbc:oracle:thin:@db01.UAT.livebytouch.com:1521:LBT\" />\t\t<property name=\"username\" value=\"lbtweb\"/>\t\t<property name=\"password\" value=\"lbtwebt\"/>\t\t -->\t\t<!-- \t\t<property name=\"driverClassName\" value=\"oracle.jdbc.driver.OracleDriver\" />\t\t<property name=\"url\" value=\"jdbc:oracle:thin:@192.168.1.25:1521:TLBTWEB\" />\t\t<property name=\"username\" value=\"tlbtweb\"/>\t\t<property name=\"password\" value=\"tlbtweb\"/>\t\t -->\t\t<!-- \t\t<property name=\"driverClassName\" value=\"oracle.jdbc.driver.OracleDriver\" />\t\t<property name=\"url\" value=\"jdbc:oracle:thin:@LBTreplicateDB.livebytouch.com:1521:LBTREP\" />\t\t<property name=\"username\" value=\"lbtweb\"/>\t\t<property name=\"password\" value=\"U6zDdGqvvj\"/>\t\t -->\t\t<property name=\"driverClassName\" value=\"${ORACLE_DRIVER}\" />\t\t<property name=\"url\" value=\"${ORACLE_TLBTWEB_URL}\" />\t\t<property name=\"username\" value=\"${ORACLE_TLBTWEB_USER}\"/>\t\t<property name=\"password\" value=\"${ORACLE_TLBTWEB_PWD}\"/>\t</bean>\n\n#Mysql ConnectionMYSQL_DRIVER=com.mysql.jdbc.DriverMYSQL_URL=jdbc:mysql://LBTmysqlDB.livebytouch.com:3306/paybyfinger?useUnicode=true&characterEncoding=utf-8&zeroDateTimeBehavior=convertToNullMYSQL_USER=paybyfingerMYSQL_PWD=q24fmZ73QdKM#Oracle FPS ConnectionORACLE_DRIVER=oracle.jdbc.driver.OracleDriverORACLE_FPS_URL=jdbc:oracle:thin:@LBToracleDB.livebytouch.com:1521:LBTORACLE_FPS_USER=fpsORACLE_FPS_PWD=fps#Oracle Update UserORACLE_PLAT_USER=platformORACLE_PLAT_PWD=platform#Oracle TLBTWEB ConnectionORACLE_TLBTWEB_URL=jdbc:oracle:thin:@LBTreplicateDB.livebytouch.com:1521:LBTREPORACLE_TLBTWEB_USER=lbtwebORACLE_TLBTWEB_PWD=U6zDdGqvvj#mobile_api url#MOBILEAPI_URL=http://192.168.1.17:9000/mapi#MOBILEAPI_URL=http://sns.x6868.com###UAT#MYSQL_URL=jdbc:mysql://db01.UAT.livebytouch.com:3306/paybyfinger?useUnicode=true&characterEncoding=utf-8#MYSQL_USER=paybyfinger#MYSQL_PWD=dyNwLeTJd5#ORACLE_FPS_URL=jdbc:oracle:thin:@db01.UAT.livebytouch.com:1521:LBT#ORACLE_FPS_USER=fps#ORACLE_FPS_PWD=fps#ORACLE_PLAT_USER=fps#ORACLE_PLAT_PWD=fps#ORACLE_TLBTWEB_URL=jdbc:oracle:thin:@db01.UAT.livebytouch.com:1521:LBT#ORACLE_TLBTWEB_USER=lbtweb#ORACLE_TLBTWEB_PWD=lbtweb#MOBILEAPI_URL=uat.x6868.com:9000###x6868#MYSQL_URL=jdbc:mysql://192.168.1.18:3306/paybyfinger?useUnicode=true&characterEncoding=utf-8#MYSQL_USER=root#MYSQL_PWD=18#ORACLE_FPS_URL=jdbc:oracle:thin:@192.168.1.10:1521:ora9i#ORACLE_FPS_USER=fps#ORACLE_FPS_PWD=fps#ORACLE_PLAT_USER=platform#ORACLE_PLAT_PWD=platform#ORACLE_TLBTWEB_URL=jdbc:oracle:thin:@192.168.1.10:1521:ora9i#ORACLE_TLBTWEB_USER=tlbtweb#ORACLE_TLBTWEB_PWD=tlbtwebMOBILEAPI_URL=http://172.16.0.213:9000initialSize=1maxActive=5maxIdle=1minIdle=1###MAILMAIL_HOST=mail.livebytouch.comMAIL_FROM=service@livebytouch.comMAIL_USERNAME=service@livebytouch.comMAIL_PASSWORD=123456\n   修复方案：  这个得问你们的开发打补丁,升级啊~~A:能过吗？B:你猜A:猜你个大头鬼啊B:应该可以吧~~~A:能高rank或者加￥吗？B:你搞懂加￥的规则了吗？A:就是没搞懂啊B:那你还问A:就是不懂才问啊~B:等看审核的心情吧。。。A:哦,原来是看心情啊。。。。。。。。。。。。。。。求高rank咯~~~   未细致深入。。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}