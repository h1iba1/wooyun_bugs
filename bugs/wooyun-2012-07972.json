{"id": 19917, "wybug_id": "wooyun-2012-07972", "wybug_title": "Wordpree某插件代码审计不严", "wybug_corp": "Wordpress插件-评论啦", "wybug_author": "shell2us", "wybug_date": "2012-06-06 23:28", "wybug_open_date": "2012-06-06 23:28", "wybug_type": "敏感信息泄露", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "敏感信息泄露", "源码审核", "错误信息未屏蔽", "未屏蔽错误信息"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-06：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-06-06：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： shell2us成员血狼访问某站，wordpress系统，那B浏览器禁用了javascript，发现评论处出现网站路径泄露，从wordpress官网插件下载频道下载此插件，发现问题还有很多！请往下看 详细说明：  访问某站，wordpree系统，浏览器禁用了javascript，发现评论处出网站路径泄露，从wordpree插件下载频道下载此插件，发现问题还很多，请往下看访问http://www.cnluc.com/看文章时，浏览器默认禁用javascript出来下面的效果，有图有真相\n\n原因：comments.php\n<script type=\"text/javascript\" src=\"http://s2.pinglun.la/md/pinglun.la.js\" charset=\"utf-8\"></script>\n问题二：直接访问该文件：comments.php\n\n原因：第四行\n$pinglunla_seo = get_option(\"pinglunla_seo\", 0);\n变量get_option()没有被声明贴出这万恶的文件代码：\n<?phpinclude_once(dirname(__FILE__).\"/pinglunla-utils.php\");$pinglunla_seo = get_option(\"pinglunla_seo\", 0);$webpage_url = \"http://\".PLL_URL.\"/comment_box/plugin/get_comments?url=\".urlencode(pinglunla_cur_page_url());?><!-- Pll Begin --><div id=\"pinglunla_here\"><?phpif($pinglunla_seo == 1) {echo file_get_contents($webpage_url);}?></div><a href=\"http://pinglun.la/\" id=\"logo-pinglunla\">评论啦</a><script type=\"text/javascript\" src=\"http://s2.pinglun.la/md/pinglun.la.js\" charset=\"utf-8\"></script><!-- Pll End -->\n第三个问题：源程序sinaweibo文件夹下index.php\n\n\n<?phpsession_start();include_once( 'config.php' );include_once( 'saetv2.ex.class.php' );\n未在文件夹中发现有那个saetv2.ex.class.php，倒是有个saetv2.php贴出某中标网站：http://www.cnluc.com/wp-content/plugins/pinglunla/readme.txthttp://www.cnluc.com/wp-content/plugins/pinglunla/comments.phphttp://www.cnluc.com/wp-content/plugins/pinglunla/sinaweibo/http://www.iamle.com/wp-content/plugins/pinglunla/readme.txt程序下载地址：http://downloads.wordpress.org/plugin/pinglunla.zip   漏洞证明：  \n\n\n\n\n\n   修复方案：  全国的第三方程序开发神牛，望重视安全问题！！   版权声明：转载请注明来源 shell2us@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：4 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2012-06-07 10:12 |    \t\tLinuxPad \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:1        | LinuxPad@AdLab.Venus)\t\t \n  soga    \n     2012-06-19 12:54 |    \t\t Jesus \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:18        | 天地不仁,以万物为刍狗！)\t\t \n  http://www.cnluc.com/博主，多有冒犯，多多包含    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 4, "Ranks": null}