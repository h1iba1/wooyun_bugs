{"id": 81753, "wybug_id": "wooyun-2015-0152929", "wybug_title": "舍得商城手机APP管理后台Struts2漏洞及后台弱口令漏洞", "wybug_corp": "舍得商城", "wybug_author": "APTs之会飞的猪", "wybug_date": "2015-11-25 12:13", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行", "后台弱口令"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-25：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-01-11：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  舍得商城手机APP管理后台Struts2漏洞及后台弱口令漏洞漏洞URL:http://203.171.237.78/login.jsp呵呵，周末在家闲的没事，上上乌云（wooyun),看看各位技术大牛发的技术帖，心里实在痒痒，就想练练手，这不，随便扫描了一个C类IP段，竟然发现了这个漏洞：舍得商城手机APP管理后台Struts2漏洞及后台弱口令漏洞具体发现流程，待我慢慢道来：这是发现后台的地址：\n\n呵呵，先尝试若口令呗，输入：用户名admin,密码：12345，呵呵，报错竟然发现链接URL里有调用.action文件，呵呵，随即上K8判断一下，是否具有Struts2漏洞，不试不知道，一试吓一跳，呵呵，竟然存在Struts2漏洞，web路径立马爆出来，而且是system权限，并且可以任意命令执行。如图：\n\n\n\n呵呵，至于后面的传马，我就不在这里秀了--------------节操，注意节操（时刻提醒自己）随后，我准备判断判断这个管理后台的逻辑，打算用BP抓包看一下，谁知道，随便输入了几个按键,比如：用户名123，密码123，呵呵，竟然进去后台了，呵呵，我那个高兴啊！-------（经证实，这是我一贯保持节操的作风啊，呵呵，人品大爆发，呵呵，开个玩笑！！！）\n\n进去后，各种敏感信息一目眼前，如：管理员信息，会员列表，如图：\n\n会员列表，如图：\n\n呵呵，这是会员信息的操作界面，呵呵，可以随便修改会员的各种信息，比如级别等等，呵呵，节操，注意节操----------\n\n这是屏幕广告界面的管理操作界面，如图：\n\n这是公告管理操作界面，尝试的跟手机界面同步一下，呵呵，竟然是一样的，节操，注意节操----，如图：\n\n\n\n\n\n这是商城的各种商品管理操作界面：如图：\n\n呵呵，这是某个商品管理操作界面，可以随便修改商品名称，价目等信息，呵呵，心动啊，随便改个价码，呵呵，大家可就赚大发了，呵呵，开个玩笑，节操，注意节操------，如图：\n\n呵呵，这是会员通过支付宝进行的各种支付列表，可以随意修改订单或者取消订单，呵呵，节操，注意节操----------哎呀，白花花的银子啊.....，如图：\n\n   漏洞证明：  漏洞证明：\n\n\n\n\n\n\n\n   修复方案：  进行Struts系统版本升级并修改后台管理账号口令，呵呵，我漏洞信息写的这么详细，还望审核大牛能多给些rank值啊，谢谢！！！求厂家礼物，呵呵！！！符一个厂家联系方式：\n\n   版权声明：转载请注明来源 APTs之会飞的猪@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}