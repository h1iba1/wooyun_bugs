{"id": 40060, "wybug_id": "wooyun-2015-092552", "wybug_title": "商务中国CSRF漏洞", "wybug_corp": "商务中国", "wybug_author": "蛇精病", "wybug_date": "2015-01-19 10:23", "wybug_open_date": "2015-03-05 10:24", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["商务中国"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-05：\t细节向公众公开  简要描述： 商务CSRF更改域名dns服务器，在用户不知情的情况下恶意更改域名解析 详细说明：  商务CSRF更改域名dns服务器，在用户不知情的情况下恶意更改域名解析   漏洞证明：  首先我们需要在商务中国，来进行测试，我们登录之后，我们任意找一处有修改权限的地方例如1、这里\n\n然后用burp截断\n\n又例如修改密码处，同样可以截断\n\n\n\n我们抓包发现，是POST型，且没有token验证机制，故我们可以构造csrf可以构造的提交页面（包括但不限于这几处）1、http://www.bizcn.com/domainbacthdeal2、http://www.bizcn.com/dnsresolve这里我们拿修改解析为例！首先我们按照抓包的内容，如图2 构造一个表单html页面\n\n1处填写域名 2 、3处写DNS地址OK  构造完成！以上是挖掘过程接下来是测试阶段，为了更好的演示效果，我们用另外一个小号来测试首先我们正常登陆商务中国，然后打开我们生成的html文件的链接\n\n   修复方案：  加验证   版权声明：转载请注明来源 蛇精病@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-01-22 14:51 厂商回复： 正在修改中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}