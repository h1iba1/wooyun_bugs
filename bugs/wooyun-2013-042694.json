{"id": 60579, "wybug_id": "wooyun-2013-042694", "wybug_title": "今题网某处基于URL跳转导致钓鱼欺骗", "wybug_corp": "jinti.com", "wybug_author": "xfkxfk", "wybug_date": "2013-11-12 17:44", "wybug_open_date": "2013-12-27 17:45", "wybug_type": "URL跳转", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["跳转", "钓鱼欺诈", "跳转利用", "跳转导致钓鱼", "跳转漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-27：\t细节向公众公开  简要描述： 今题网某处基于URL跳转，可导致钓鱼欺骗 详细说明：  嗨，好久没发漏洞了。。。第一次发这样的漏洞，今天研究URL跳转，看到了@xsser的\nhttp://drops.wooyun.org/papers/58\n然后就随便找个了厂商，试了下，呵呵，在登陆哪个地方就找到了一个。今题网登陆的时候URl：http://passport.jinti.com/login.aspx可以再后面加一个参数reurl，URL：http://passport.jinti.com/login.aspx?reurl=http://www.reurl.com，reurl的值就是登陆成功后跳转的地址。   漏洞证明：  URL：http://passport.jinti.com/login.aspx?reurl=http://www.wooyun.org\n\n抓包，看看请求：\n\n由于登陆成功后，直接跳转到了reurl地址，没有进入今题网，所以用户不知道是否登录成功，这样可以用来进行钓鱼，欺骗等，更加方便。\n\n   修复方案：  修复方案引用@xsser的话：\n理论上讲，url跳转属于CSRF的一种，我们需要对传入的URL做有效性的认证，保证该URL来自于正确的地方，限制的方式同防止csrf一样可以包括：1 referer的限制如果确定传递URL参数进入的来源，我们可以通过该方式实现安全限制，保证该URL的有效性，避免恶意用户自己生成跳转链接2 加入有效性验证Token我们保证所有生成的链接都是来自于我们可信域的，通过在生成的链接里加入用户不可控的Token对生成的链接进行校验，可以避免用户生成自己的恶意链接从而被利用，但是如果功能本身要求比较开放，可能导致有一定的限制。\n   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2013-11-14 14:26 厂商回复： 已经提交给相应技术去处理! 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}