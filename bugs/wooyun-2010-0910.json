{"id": 23698, "wybug_id": "wooyun-2010-0910", "wybug_title": "支付宝一处上传过滤缺陷", "wybug_corp": "支付宝", "wybug_author": "her0ma", "wybug_date": "2010-12-08 14:05", "wybug_open_date": "2011-01-07 18:00", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["图片上传验证不严", "文件头解析缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2010-12-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2010-12-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2010-12-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2011-02-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2011-02-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2011-02-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2011-01-07：\t细节向公众公开  简要描述： 支付宝一处上传过滤缺陷，可能上传具有代码执行功能的伪造png文件。可以被利用者用来钓鱼，挂马等等。 详细说明：  \n<html><body><meta http-equiv=\"refresh\" content=\"0.0;url=http://login.taotao.com.auctleom-htm.co.cc/memeber/item_0db1-25078006/&cid=&url=832432.html\"></body></html>\n这段代码 伪造成png文件。访问该png，会跳转到 http://login.taotao.com.auctleom-htm.co.cc/memeber/item_0db1-25078006/&cid=&url=832432.html  这个比较简单，请看漏洞证明！   漏洞证明：  http://img.alipay.com/images/credit/2088002/621/657/054/shanghai_credit_report.png打开可以看到 虽然要跳转的站访问不了 但是确实存在跳转。具体的利用 期待高手继续探究。没有找到具体的上传地方，只找到支付宝头像修改 上传后有类似的图片链接！   修复方案：  找到此上传地方，做好过滤限制！   版权声明：转载请注明来源 her0ma@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2010-12-08 15:01 厂商回复： 谢谢her0ma！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}