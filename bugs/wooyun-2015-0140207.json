{"id": 84849, "wybug_id": "wooyun-2015-0140207", "wybug_title": "PHPOK一处因 UEditor 而产生的存储型 XSS （包括百度自身业务也在使用，如安全中心）", "wybug_corp": "www.phpok.com", "wybug_author": "Bird", "wybug_date": "2015-09-10 18:37", "wybug_open_date": "2015-12-14 10:32", "wybug_type": "XSS跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-18：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向公众公开  简要描述： PHPOK一处因 UEditor 而产生的存储型 XSS （包括百度自身业务也在使用，如安全中心） 详细说明：  这几天在找好用的免费的CMS，发现不少开源CMS采用了百度的 UEditor，顺手测试一下这些CMS普遍采用该组件用于站内信编辑器和评论编辑器等UE存在正文存储型XSS。开发者对正文进行了大量转义，对<script>进行了过滤，却没考虑<img>在代码模式里直接插入<img src=# onerror=>即可审核大大告诉我说乌云不接受这类的富文本编辑器自身的存储型XSS- - 所以我就举例了该组件导致 PHPOK 这个 CMS 出现 XSS 可以导致后台低级别管理员通过 XSS 获得系统管理员权限。   漏洞证明：  UE官网demo\n\n百度安全中心\n\nPHPOK 利用流程（1）获得（或自己就拥有）一个低级别的有后台权限的账户（2）登录该账户发一篇文章，内嵌XSS代码（3）当管理员看到此文章时触发XSS截图如下：\n\n\n\n   修复方案：  考虑 <img>    版权声明：转载请注明来源 Bird@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-09-15 10:30 厂商回复： 收到，我们这就尽快修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-02-16 14:09 |    \t\ttoomi \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:4        | 小菜一枚)\t\t \n  貌似还没修复嘛    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}