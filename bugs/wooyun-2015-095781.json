{"id": 45471, "wybug_id": "wooyun-2015-095781", "wybug_title": "通过设计缺陷猥琐查询安邦保险订单与保单等详细信息", "wybug_corp": "安邦保险", "wybug_author": "小指头", "wybug_date": "2015-02-05 14:52", "wybug_open_date": "2015-03-22 14:54", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-22：\t细节向公众公开  简要描述： 最近在研究核保业务流程，发现安邦的核保做的还是挺好的，只有很小一部分能绕过，这里不谈。现在说说平行权限问题，安邦的订单查询很有意思，未支付的订单只显示投保人及被保险人信息；已支付的订单，会多显示一项保单号，这就是真实客户信息了。 详细说明：  查询订单链接http://www.ab95569.com/user/myorderId.htm?orderId=20150204173203529571955&productType=8现在我们来分析下该链接：后面的prodeuctType代表险种，orderId由几部分组成：年+月+日+时+分+秒+随机数，其中代表时间的前14位订单号其实就是\"下单时间\"，\n\n理论上暴力破解orderId就可以猜解出用户信息，但位数太多，成功率太低，没意思。进一步分析发现，其实可以明确知道在一个时间段内多少有客户下单。关键就在“订单编号”，同一款险种的订单编号在服务器端是连续生成的，如安邦养老乐享1号，在2015年02月04日16：44：34到17：32：03之间，应该是有5个人下了订单，这样暴破起来就更有针对性了。\n\n   漏洞证明：  未支付订单\n\n已支付订单（带保单号）\n\n   修复方案：  完善权限控制，个人觉得orderId加密会比较好   版权声明：转载请注明来源 小指头@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-02-10 08:45 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}