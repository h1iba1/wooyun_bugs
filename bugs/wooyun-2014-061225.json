{"id": 2086, "wybug_id": "wooyun-2014-061225", "wybug_title": "TRS系统任意文件下载漏洞", "wybug_corp": "北京拓尔思信息技术股份有限公司", "wybug_author": "路人甲", "wybug_date": "2014-05-18 10:06", "wybug_open_date": "2014-08-16 10:08", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-25：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-16：\t细节向公众公开  简要描述：  详细说明：  此系统多为大型政府新闻发布站点（新闻源），如一旦被某些（博彩集团）控制，估计后果危害不是一般大。。。http://123.131.133.150:8080/wcm/ 临沂日报报业集团http://61.153.63.94/wcm 云和县政府所有发布站点http://www.cflac.org.cn/wcm 中国文联http://wcm.xxz.gov.cn:8080/wcm/ 湘西州政府站群http://www.jscnt.gov.cn/wcm/ 江苏省文化厅http://www.sccnt.gov.cn 四川省文化厅http://218.94.123.203/wcm 江苏长安网http://203.86.89.25/wcm/ 中国书籍出版社http://www.lfcgs.gov.cn:8080/wcm/ 廊坊车管所http://iwr.cass.cn/wcm/ 中国社会科学院http://www.whxinzhou.gov.cn:9090/wcm/ 新洲区人民政府公众网http://123.131.133.150:8080/wcm/ 琅琊网http://122.224.174.82:8090/wcm/ 中国美术学院http://www.qhepb.gov.cn 青海省环保厅http://211.154.254.113:8080/wcm/ 佛教在线……等等分析：TRS WCM中读取上传图片的：wcm/app/system/read_image.jsp\nString sFileName = currRequestHelper.getString(\"FileName\");//这里直接获取文件名，未进行任何判断，也未做任何过滤处理if(sFileName == null || sFileName.trim().length()==0)    throw new WCMException(ExceptionNumber.ERR_PARAM_INVALID, \"传入文件名为空! \");\n\ntry{    if(true) {\t    FilesMan currFilesMan = FilesMan.getFilesMan();\t\tsFileName = currFilesMan.mapFilePath(sFileName, FilesMan.PATH_LOCAL) + sFileName;//未对文件名进行有效判断。只检测是否为空}else{     java.io.File f = new java.io.File(sFileName);\t if(f.exists()){\t     sFileName = f.getAbsolutePath();\t }else {\t  ......//省略若干代码\n顾可通过构造好的链接下载任意文件，例如可下载tomcat配置文件，如tomcat/conf/tomcat-users.xml通过跳转字符../ 或者 ..\\ 可跳转到tomcat目录，或者下载源码演示如下：\n\n\n\n在对下载文件的过程中，应对../ 以及 ..\\ 这样的字符进行充分判断。。。   漏洞证明：  \n\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2014-05-22 13:54 厂商回复： 感谢反馈，此问题在3月份已发布安全补丁，公司会继续督促前线人员对未更新案例进行跟踪。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-05-18 11:28 |    \t\tBloodwolf \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:8        | whoami)\t\t \n  ...还有任意命令执行！    \n     2014-05-18 18:08 |    \t\tj2ck3r \t\t\t( 普通白帽子  |\t\t\t        Rank:406 漏洞数:92        | 别关注我，跟你不熟。)\t\t \n  @Bloodwolf 详细过程？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}