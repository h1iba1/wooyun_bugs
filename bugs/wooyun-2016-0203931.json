{"id": 86068, "wybug_id": "wooyun-2016-0203931", "wybug_title": "中国国旅多个系统存在漏洞/后台沦陷/十几个数据库可操控/泄露千万客户信息/几十万注册用户密码", "wybug_corp": "中国国旅", "wybug_author": "z_zz_zzz", "wybug_date": "2016-04-30 23:48", "wybug_open_date": "2016-05-09 09:00", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 中国国旅多个系统存在漏洞，导致后台沦陷，十几个数据库可操控，泄露千万客户信息，包括姓名/证件号/手机号/旅行信息/航班信息等，以及几十万注册用户密码 详细说明：  只查询了少量信息证明漏洞，没有做坏事，不要查我的水表中国国旅以下服务器均存在JAVA weblogic反序列化漏洞\n\n先看看第一台，连上服务器，已经有人来过了\n\n换下一台，连上服务器\n\n这台服务器的网站打开后会跳转到中国国旅某应用，可能会有些信息\n\n连上数据库\n\n数据库里的信息都是百万千万级的-.-，由于数量实在太多，select count耗时太久，直接看oracle视图里的NUM_ROWS吧\n\n证件信息，1154W\n\n客户信息，1205W\n\n航班信息，895W\n\n还是客户信息，569W\n\n员工账号信息\n\n随便找一个登录后台管理系统\n\n随便看一看\n\n\n\n\n\n\n\n\n\n\n\n貌似最近刚上线了新系统\n\n找个管理员的用户看下\n\n使用管理员账户登录，权限大了很多，能做的事更多了，还是不要乱玩了，免得弄出问题了\n\n员工账号共有一万多个\n\n短信下行记录，75W\n\n\n\n短信上行记录，70W\n\n不知道短信上行能做啥\n\n换台服务器登录\n\n这么一堆数据库配置，也是吓尿我了=.=\n\n\n\n再换台服务器登录，从主机名看是测试用的服务器\n\n再换台服务器登录\n\n这台服务器里有这个应用\n\n也有好多数据库配置\n\n\n\n连上数据库\n\n数据量也是几百万几千万的\n\n团队信息，1284W\n\n证件信息，1126W\n\n短信记录，116W\n\n\n\n注册用户信息，45W\n\n\n\n随便找一个登录一下\n\n   漏洞证明：  见详细说明   修复方案：  打补丁可以参考：修复weblogic的JAVA反序列化漏洞的多种方法http://drops.wooyun.org/web/13470   版权声明：转载请注明来源 z_zz_zzz@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2016-05-09 09:00 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}