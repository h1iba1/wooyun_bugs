{"id": 55717, "wybug_id": "wooyun-2014-060122", "wybug_title": "CSDJCMS 程式舞曲 最新 Sql 一枚。 (无需登录,测试官网成功)", "wybug_corp": "chshcms.com", "wybug_author": "′雨。", "wybug_date": "2014-05-10 09:58", "wybug_open_date": "2014-08-08 10:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-08：\t细节向公众公开  简要描述：  周末已到, 躁起来。 。。 又更新了 我要继续继续挖。 无需登录。 详细说明：  在app/controllers/open.php中\npublic function bang()\t{             $user['CS_Name'] = $this->input->get_post('username', TRUE);   //username\t\t\t            $user['CS_Pass'] = $this->input->get_post('userpass', TRUE);   //userpass            $user['CS_Nichen'] = $this->input->get_post('usernichen', TRUE);   //usernichen            $user['CS_Email'] = $this->input->get_post('useremail', TRUE);   //useremail            $user['CS_Qqid'] = $this->input->get_post('openid', TRUE);   //openid            $username=$user['CS_Name'];            $userpass=$user['CS_Pass'];            $useremail=$user['CS_Email'];            if(empty($user['CS_Qqid'])) $this->CsdjSkins->Msg_url('没有获取到openid!',site_url('user/login/'));               //--------------------------------------可选字段-------------------------------------------------------------------                $user['CS_City'] = $this->input->get_post('usercity', TRUE);                 $user['CS_QQ']   = $this->input->get_post('userqq', TRUE);                $user['CS_Sex']  = intval($this->input->get_post('usersex', TRUE));                $user['CS_Logo'] = $this->input->get_post('userlogo', TRUE);             $denglu = $this->security->xss_clean($this->input->get_post('denglu', TRUE));   //qquser            if($denglu=='login'){ //绑定登入                 if(empty($user['CS_Name'])) $this->CsdjSkins->Msg_url('帐号不能为空!','javascript:history.back();');                   if(empty($user['CS_Pass'])) $this->CsdjSkins->Msg_url('密码不能为空!','javascript:history.back();');                     //可以用ID、会员名、邮箱来进行登入                    $sqlu=\"SELECT CS_Pass,CS_SID,CS_ID,CS_Name,CS_LogNum,CS_Cion,CS_LogTime FROM \".CS_SqlPrefix.\"user where cs_id='\".$username.\"' or cs_name='\".$username.\"' or cs_email='\".$username.\"'\";\t\t\t\t    $row=$this->CsdjDB->get_all($sqlu);\t\t    if(!$row){\n不是一般都要xss_clean么。 $user['CS_Name'] 这个竟然都没有clean。直接带入到了查询当中。。注入把。测试demo   漏洞证明：  \n\n   修复方案：  过滤呗。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-05-10 12:37 厂商回复： 经过确定 漏洞存在，感谢您的支持~！ 最新状态： 2014-05-10：漏洞已经修复~！  ", "replys": "漏洞评价：\n评论\n     2014-10-14 11:26 |    \t\t切克脑 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:9        | z..)\t\t \n  这个是不是受gpc的@′ 雨。    \n     2014-11-05 22:41 |    \t\t′雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @切克脑 嗯    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}