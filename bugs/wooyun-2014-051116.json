{"id": 5132, "wybug_id": "wooyun-2014-051116", "wybug_title": "百度某功能存储型xss漏洞", "wybug_corp": "百度", "wybug_author": "梧桐雨", "wybug_date": "2014-02-16 18:22", "wybug_open_date": "2014-04-02 18:23", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-02-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-02-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-02-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-02：\t细节向公众公开  简要描述： 某处输入未过滤导致的存储型xss 详细说明：  百度相册在用户输入输出做了大量的处理，但是百密必有一疏的地方。例如在这：http://image.baidu.com/channel?c=%E7%BE%8E%E9%A3%9F&t=%E5%85%A8%E9%83%A8&s=0我们随意找到一个好吃的（好吃的真多啊！！）\n\n有一个收藏功能，收藏功能里头有一个描述，我们试试输入跨站代码。\n\n但是直接这样添加，会被百度的过滤器过滤掉。\n\n过滤了这里，我们试试创建一个专辑<script>alert(1)</script> 然后收藏之后访问会怎么样呢？\n\n   漏洞证明：  以上两个条件缺一不可。得到链接，访问就会被弹窗：http://image.baidu.com/albumlist/2788001601#from=0&column=&album_id=400823071&user_id=698263241&tag=<script>alert(1)</script>&album_id=400823071&pic_num=1&album_name=<script>alert(1)</script>\n\n最后通过查看源码，找到存在缺陷的地方：\n\nalbum_name参数还可以控制，不限制长度哦。http://image.baidu.com/albumlist/2788001601#from=0&column=&album_id=400823071&user_id=698263241&tag=<script>alert(1)</script>&album_id=400823071&pic_num=1&album_name=<script>alert(document.cookie)</script>弹出自己的cookie   修复方案：  都加了httponly了，只能弹弹窗，钓钓鱼了。过滤输出点，上面已经给出了：）   版权声明：转载请注明来源 梧桐雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2014-02-16 18:26 厂商回复： 感谢提交，我们会尽快处理此问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-02 20:53 |    \t\tlaoyao \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:5        | ด้้้้้็็็็็้้้้้็็็็...)\t\t \n  2014年4月2日测试该问题还存在@百度    \n     2014-04-02 21:48 |    \t\tGrayTrack \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:14        | 灰色轨迹)\t\t \n  对呀，还是存在哦    \n     2014-04-03 10:10 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  还是存在    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}