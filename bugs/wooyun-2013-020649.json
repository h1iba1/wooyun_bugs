{"id": 13785, "wybug_id": "wooyun-2013-020649", "wybug_title": "智思留言本4.1正式版上传漏洞", "wybug_corp": "智思网（zhisi.net)", "wybug_author": "n.j", "wybug_date": "2013-03-26 16:00", "wybug_open_date": "2013-03-26 16:00", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "任意文件上传", "智思留言本"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-26：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-03-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 智思留言本4.1正式版,发表留言上传附件可以直接上传ASP执行文件. 详细说明：  \n'If Action=\"addsave\" Then KeywordsFilter(FilterKeyWord)Dim RequestU,intCount,i,formName,FileSavePath,FileSaveName,uploadsDirVarRelatePath=\"\"FileSavePath=\"./ufiles/\"&Year(Date())&\"/\"&Right(\"0\"&Month(Date()),2)&\"/\"'\"ufiles/2009/\"'Set RequestU=new UpLoadClass'RequestU.FileType=\"gif/jpg/rar/zip/7z/swf/bmp/png/jpeg\"'RequestU.SavePath=FileSavePath'RequestU.MaxSize=20000*1024 '20M'RequestU.Charset=\"UTF-8\"'RequestU.Open()Set RequestU=New FreeASPUpload'If HasPermission(9) Then\t'uploadsDirVar=Server.MapPath(FileSavePath)\t'RequestU.Save(uploadsDirVar)\tRequestU.Upload()'End If\n   漏洞证明：  \n\n   修复方案：  你懂的..   版权声明：转载请注明来源 n.j@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：10 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2013-03-26 21:31 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  我想说。。他代码有过滤呀。怎么看出来可以传asp的。    \n     2013-03-26 23:53 |    \t\t暗夜清风 \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:10        | 大哥,你的娃娃掉了.举手之劳,不必以身相许)\t\t \n  @Black Angel 截断 没文化真可怕    \n     2013-03-27 09:04 |    \t\tpiaoye \t\t\t( 普通白帽子  |\t\t\t        Rank:343 漏洞数:53        | ww)\t\t \n  ...过滤代码被注释了，任意文件上传。    \n     2013-03-27 10:05 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Black Angel 注释了    \n     2013-03-27 15:38 |    \t\t暗夜清风 \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:10        | 大哥,你的娃娃掉了.举手之劳,不必以身相许)\t\t \n  @xsser 辍笔。。。。瞎了我的狗眼。。居然没看到单引号    \n     2013-03-27 16:16 |    \t\tFalcon \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 专业从事，暗杀，刺杀，投毒，潜伏，搏击，...)\t\t \n  @暗夜清风 擦。。。。。 这话说的。。。瞎了你的狗眼啊！。。。。单引号那么大字居然么看到！其实我发现我屏幕上面在单引号的地方有个黑点当初没在意！以为没有后来才发现。。。。。那个黑点里面还有个单引号！    \n     2013-03-27 16:20 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @暗夜清风  我是没有看到单引号,一眼望过去就看到有过滤参数,没有注意单引号而已. @xsser 谢了..~     \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 10, "Ranks": null}