{"id": 8028, "wybug_id": "wooyun-2013-039466", "wybug_title": "快乐购网站备份BAK文件任意下载（泄漏数据库信息）", "wybug_corp": "快乐购物股份有限公司", "wybug_author": "xlz0iza1", "wybug_date": "2013-10-12 10:28", "wybug_open_date": "2013-11-26 10:28", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件操作不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-26：\t细节向公众公开  简要描述： 管理员备份文件也太那个了把，直接在备份文件后面加BAK格式！导致文件直接下载，包括数据库信息泄漏！ 详细说明：  源码和数据库信息泄漏：http://3g.happigo.com/webconfig.php.bak还有一些我就懒得下载了哦！下面是一些关键信息的截图！\n\n\n\n数据库信息！\n\n   漏洞证明：  \n<?php//数据库连接信息define(\"ORDERDB_DB\",\t\t\t\t\"orderdb\");define(\"ORDERDB_HOST\",\t\t\t\t\"localhost\");define(\"ORDERDB_USER\",\t\t\t\t\"wap\");define(\"ORDERDB_PASS\",\t\t\t\t\"happiwap12320130523\");define(\"GOODSADMIN_DB\",\t\t\t\t\"goods_admin\");define(\"GOODSADMIN_HOST\",\t\t\t\"localhost\");define(\"GOODSADMIN_USER\",\t\t\t\"wap\");define(\"GOODSADMIN_PASS\",\t\t\t\"happiwap12320130523\");define(\"APP_DB\",\t\t\t\t\t\"app_manager\");define(\"APP_HOST\",\t\t\t\t\t\"localhost\");define(\"APP_USER\",\t\t\t\t\t\"wap\");define(\"APP_PASS\",\t\t\t\t\t\"happiwap12320130523\");define(\"TOUCH_DB\",\t\t\t\t\t\"touch_manager\");define(\"TOUCH_HOST\",\t\t\t\t\"localhost\");define(\"TOUCH_USER\",\t\t\t\t\"wap\");define(\"TOUCH_PASS\",\t\t\t\t\"happiwap12320130523\");define(\"WAP_DB\",\t\t\t\t\t\"wap_manager\");define(\"WAP_HOST\",\t\t\t\t\t\"localhost\");define(\"WAP_USER\",\t\t\t\t\t\"wap\");define(\"WAP_PASS\",\t\t\t\t\t\"happiwap12320130523\");define(\"ZT_DB\",\t\t\t\t\t\t\t\"msg\");define(\"ZT_HOST\",\t\t\t\t\t\t\"10.10.66.101\");define(\"ZT_USER\",\t\t\t\t\t\t\"cmsgogo\");define(\"ZT_PASS\",\t\t\t\t\t\t\"XWW3U011\");/*define(\"ZT_DB\",\t\t\t\t\t\t\t\"wap_manager\");define(\"ZT_HOST\",\t\t\t\t\t\t\"localhost\");define(\"ZT_USER\",\t\t\t\t\t\t\"root\");define(\"ZT_PASS\",\t\t\t\t\t\t\"\");define(\"ZT_DB\",\t\t\t\t\t\t\t\"msg\");define(\"ZT_HOST\",\t\t\t\t\t\t\"10.10.66.101\");define(\"ZT_USER\",\t\t\t\t\t\t\"cmsgogo\");define(\"ZT_PASS\",\t\t\t\t\t\t\"XWW3U011\");*/define(\"TS_DB\",\t\t\t\t\t\t\"goods_admin\");define(\"TS_HOST\",\t\t\t\t\t\"10.10.66.46\");define(\"TS_USER\",\t\t\t\t\t\"tongji\");define(\"TS_PASS\",\t\t\t\t\t\"zxcasdqwe\");define(\"LOGDIR\",\t\t\t\t\t\"/tmp/\");define(\"MAXROWS\",\t\t\t\t\t\"300\");define(\"WAPDNS\",\t\t\t\t\t\"http://m.happigo.com/\");define(\"IMAGEPHP\",\t\t\t\t\t\"http://g1.happimg.com\");define(\"DATAIURL\",\t\t\t\t\t\"http://m.happigo.com/datai/bus.php?cps_id=33&\");define(\"TOUCHDNS\",\t\t\t\t\t\"http://3g.happigo.com/\");define(\"WEBDATAURL\",\t\t\t\t\"http://www.happigo.com/system/crontab/wap/wap_save_opinion.php\");//自定义参数define(\"URLPARAMS\",\t\t\t\t\t\"cps_id,cps_u_id,uid,sessionid,acckey,mobile,from,ysrc,ychannel,ycid,ywi,yurl\");//用户登录define('LOGIN_URL',\t\t\t\t\t'http://member.happigo.com/index.php?app=user');//单点登录请求地址define('LOGIN_KEY',\t\t\t\t\t'weiry2374934wehfkdsfsaqw67123hd623hd'); // 与用户中心的通信密钥, define('APPID',\t\t\t\t\t\t'100'); // 用户中心接口交互使用的id//韵味湖南define(\"CPS_YWHN\",\t\t\t\t\t\"17\");//中广睛彩商城define(\"CPS_CMMB\",\t\t\t\t\t\"20\");//快乐通宝define('HAPPIPAY_ACC_KEY',\t\t\t'sd4Sdf34ggg4k');//搜索关键字define('SEARCH_KEYWORD',\t\t\t'');//手机支付-联合登录define('CMPAY_LOGIN_KEY',\t\t\t'o$p@e!n*apib'); // 移动手机支付联合登录的通信密钥, define('CO_LOGIN_URL',\t\t\t\t'http://www.happigo.com/cache/api_co_login/wapcall.php?');define('CO_LOGIN_PWD_KEY',\t\t\t'_*&Wn|!9');define('PROMOTIONID_10YUAN',        '201301010003');//自助订购立减10元促销id$g_gift_coupon= array(\t\t\t\t'HG4007051111' => '181,182,183,184','quan20' => '402','quan30' => '403','quan50' => '404',);?>\n   修复方案：  删除备份文件，修改数据库和一些接口信息！   版权声明：转载请注明来源 xlz0iza1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2013-10-14 16:00 厂商回复： 感谢xlz0iza1对漏洞的提交！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-22 21:30 |    \t\txlz0iza1 \t\t\t( 普通白帽子  |\t\t\t        Rank:1027 漏洞数:207        | \"><script/src=data:,alert(1)%2b\")\t\t \n  @快乐购物股份有限公司  礼物撒时候发啊，亲！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}