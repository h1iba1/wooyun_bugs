{"id": 37567, "wybug_id": "wooyun-2015-099405", "wybug_title": "某通用健康体检档案管理系统越权/泄露敏感信息/getshell（可影响大量社会公民信息）", "wybug_corp": "中卫信软件", "wybug_author": "BMa", "wybug_date": "2015-03-06 15:40", "wybug_open_date": "2015-06-09 10:56", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-09：\t细节向公众公开  简要描述： 某通用健康体检档案管理系统越权/泄露敏感信息/getshell（可影响大量社会公民信息）影响数据量粗略估计145W +  详细说明：   WooYun: 某通用健康体检档案管理系统getshell（可影响大量社会公民信息） 根据上面那个漏洞拿到源码看看，发现了一些问题：公司：中卫信软件地址：http://www.chiscdc.com/简介：中卫信软件成立以来以“传递科技，控制疾病”为使命，致力于中国公共卫生事业信息化建设，在社会各界的大力支持下，通过全体员工的不懈的努力，在公共卫生行业信息建设方面取得了良好的业绩。公司开发的相关软件产品覆盖江苏省公共卫生领域近70%的市场份额，用户数达1500多家，成为江苏省公共卫生领域信息化建设的领先企业。 案例：\n上海市化工职业病防治院体检查询系统\thttp://www.shhgzf.com:8280/dwcx/grdetail.asp?bhkidx=1泰州市健康体检查询系统\thttp://221.230.140.60:8080//dwcx/grdetail.asp?bhkidx=1宿迁市健康体检档案管理系统\thttp://218.93.201.187:8888/dwcx/grdetail.asp?bhkidx=1镇江市健康体检档案管理系统\thttp://221.230.8.231:8081//dwcx/grdetail.asp?bhkidx=1南通市健康体检档案管理系统\thttp://222.184.250.2:8001//dwcx/grdetail.asp?bhkidx=1以http://www.shhgzf.com:8280/dwcx/\n以http://www.shhgzf.com:8280/dwcx/grdetail.asp?bhkidx=1为例：上海市化工职业病防治为例1、越权+用户敏感信息泄露：所有的动作都需要用户通过身份认证才能查询\nhttp://www.shhgzf.com:8280/dwcx/grdetail.asp?bhkidx=10076http://www.shhgzf.com:8280/dwcx/grdetail.asp?bhkidx=10077http://www.shhgzf.com:8280/dwcx/grdetail.asp?bhkidx=10078http://www.shhgzf.com:8280/dwcx/grdetail.asp?bhkidx=10079http://www.shhgzf.com:8280/dwcx/grdetail.asp?bhkidx=10080\n\n\n\n\n\nsql-shell> select count(idx) from td_tj_bhk;select count(idx) from td_tj_bhk;:    '200494'\n2、注入及getshell/执行系统命令http://www.shhgzf.com:8280/dwcx/grdetail.asp?bhkidx=10079文件：/dwcx/grdetail.asp?bhkidx=1参数：bhkidx代码：\n<% bhkidx=request(\"bhkidx\") if bhkidx=\"\" then response.write(\"参数错误，请联系管理员！\") response.end end if set cn=getConn() set rs=server.createObject(\"adodb.recordset\") sql=\"select * from td_tj_bhk where idx=\"&bhkidx rs.open sql,cn,1,3\n\n\n\n\n\n\n附其他例子截图：\n\n\n\n\n\n\n\n\n\n   漏洞证明：     修复方案：     版权声明：转载请注明来源 BMa@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-03-11 10:55 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过网站公开联系方式向软件生产厂商通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}