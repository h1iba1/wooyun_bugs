{"id": 18244, "wybug_id": "wooyun-2012-09175", "wybug_title": "小米MIUI漏洞可能导致硬件资源消耗", "wybug_corp": "小米科技", "wybug_author": "Claud", "wybug_date": "2012-07-03 15:30", "wybug_open_date": "2012-08-17 15:31", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "手机安全", "安全", "手机软件安全", "手机应用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-08-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-09-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-09-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-17：\t细节向公众公开  简要描述： 危害极低，比较搞笑的漏洞，主要效果是可以把用户吓一跳……不过作为攻击案例，非常典型。 详细说明：  MIUI内置的手电筒软件Stk.apk中，TorchService服务没有对广播来源进行验证，导致任何程序可以调用这个服务，打开或关闭手电筒。利用这个漏洞，可以导致系统电源迅速消耗。（以及在大半夜把用户吓一跳）   漏洞证明：  漏洞利用代码片段：\nIntent intent = new Intent();        intent.setAction(\"net.cactii.flash2.TOGGLE_FLASHLIGHT\");        sendBroadcast(intent);\n   修复方案：  三种方法任选一个：1. 在AndroidManifest.xml中，将TorchService申明为export=\"false\"的；2. 在AndroidManifest.xml中，申明一个私有权限，级别为signature，并为TorchService申明需要这个权限；3. 在TorchService的实现代码中，检查Intent的来源是否Stk.apk自身。   版权声明：转载请注明来源 Claud@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2012-07-03 18:39 厂商回复： 感谢上报！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-03 15:36 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  强烈要求@小米科技 奖励小米手机    \n     2012-07-03 19:38 |    \t\tLittlePig \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | </html>)\t\t \n  小米因为被检测出安全问题已经送了多少手机了？    \n     2014-12-24 23:33 |    \t\tzt22172 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 跟着大家一起前进，做一个思想开放，思路开...)\t\t \n  额，这都行？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}