{"id": 16962, "wybug_id": "wooyun-2012-011695", "wybug_title": "百度100G网盘分享功能存储型XSS", "wybug_corp": "百度", "wybug_author": "gainover", "wybug_date": "2012-09-03 14:25", "wybug_open_date": "2012-10-18 14:26", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-09-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-09-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-09-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-09-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-10-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-10-18：\t细节向公众公开  简要描述： 标题貌似有歧义！是100G的网盘，不是100G的XSS！！今天不少群里在讨论100G的百度网盘，也有不少人为了做任务，给其他人发分享链接的！如果这个分享页面存在XSS，受众还是挺广的么！！再加上，在百度贴吧留链接的！邮箱留种子的.... 在这个百度网盘正处于活动任务宣传期的阶段！！挺有意思的！ 详细说明：  1. 首先我随便上传了一张图片，抓了下包！2. 可以看到主要是2个请求。请求一：上传文件的请求。http://pcs.baidu.com/rest/2.0/pcs/file?method=upload&type=tmpfile&app_id=250528&BDUSS=56ZGZCbFBzYmlXWUlucDhpNU96WllJeDB0UEltN1pPSnlmYTAtMjNZTll0Q3RSQVFBQUFBJCQAAAAAAAAAAAomjxcmmz8AZ2Fpbm92ZXIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAYIArMAAAAOAqJXUAAAAAmWdCAAAAAAAxMC4zNi4xNFhmPlBYZj5QTk返回的内容是一个MD5值：{\"md5\":\"cc99e700ed6e009c7d08ce4117179a5c\",\"request_id\":3976866536}请求二：http://pan.baidu.com/api/create?a=commit&channel=chunlei&clienttype=0&web=1path\t/2.jpgisdir\t0size\t4711block_list\t[\"cc99e700ed6e009c7d08ce4117179a5c\"]method\tpost可以看到，发送的参数里有一个MD5的字段。\n\n3. 接着我们将上传的这个图片生成一个分享链接！打开分享链接，查看源代码！\n\n同样也有该md5值4. 直接修改http://pan.baidu.com/api/create请求中，md5值为cc99e700ed6e009c7d08ce4117179a5c</script>。再看看分享页面\n\n未做任何过滤。5. 构造利用代码，调用外部JS\n\n   漏洞证明：  见详细说明   修复方案：  对http://pan.baidu.com/api/create请求中，block_list中的md5值进行正则判断。   版权声明：转载请注明来源 gainover@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2012-09-03 14:42 厂商回复： 感谢你对百度安全的关注，我们马上安排处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-09-03 14:27 |    \t\t0ps \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:10        | xo)\t\t \n  mark    \n     2012-09-03 14:30 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  这就开场了？    \n     2012-09-03 16:10 |    \t\tFlyR4nk \t\t\t( 普通白帽子  |\t\t\t        Rank:119 漏洞数:18        )\t\t \n  @gainover速度很快啊    \n     2012-09-03 16:12 |    \t\t不懂xx \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:5        | 虚空假面,去哪儿)\t\t \n  @FlyR4nk 给力啊    \n     2012-09-03 16:12 |    \t\t不懂xx \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:5        | 虚空假面,去哪儿)\t\t \n  等待公开    \n     2012-09-03 22:13 |    \t\t啤酒 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:8        | 道不同.喝酒结盟)\t\t \n  哈哈..g牛你说有洞那就真有洞.肯定还有    \n     2013-04-13 20:17 |    \t\t残影小L \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 我还是我。)\t\t \n  大大，你泄露BDUSS了..    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}