{"id": 14816, "wybug_id": "wooyun-2012-016193", "wybug_title": "交通银行免费买车漏洞", "wybug_corp": "交通银行", "wybug_author": "only_guest", "wybug_date": "2012-12-18 21:18", "wybug_open_date": "2013-02-01 21:18", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "认证设计不合理", "设计缺陷", "支付行业敏感"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-02-01：\t细节向公众公开  简要描述： 交通银行支付逻辑漏洞.问题很严重.据说可以免费买车.上次刷人民币.有钱了,这次刷个车吧. 详细说明：  今天在逛网商,无意看到了交通银行的在线商城.于是就测试了下.发现存在重大逻辑问题.首先我们先找一个商品,这里我来买辆车.\n\n随便选了一辆.我们来买买看.在添加到购物车时抓包.将数量改为负值.\n\n这一步我们看到已经修改成功了.但是我们还不能确定问题存在,因为很多在线商城都会在下一步支付的时候进行认证.我们继续来看.\n\n这个时候我们发现,金额任然是负数.我们下单看下.\n\n这时我们可以看到,金额已经恢复成正数,但是由于数量是负值.导致最终金额也变为负值.\n\n由于银行无法支付负值,所以导致我们在这一步的时候失败了.我们换个思路.买不起车.买卷纸吧.具体干什么你们懂的.\n\n我们可以看到下图.邮费是按照商品购买数量来计算的.商品数量是负值,所以邮费也是负值.所以最后得到的金额还是负数,无法购买成功.\n\n如果我们在确定邮费的环节.将邮费修改成一个我们想要的负值呢?如下图\n\n9800块的纸巾被修改成了1块钱.\n\n可以支付.换个金额少的订单支付一下.\n\n\n\n可以成功支付.等待发货.确定问题存在.回到标题.想买车的话,就少买点纸巾.   漏洞证明：  \n\n   修复方案：  逻辑错误修复下吧.   版权声明：转载请注明来源 only_guest@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2012-12-20 17:06 厂商回复： CNVD确认漏洞情况，已转由CNCERT通报银行业信息化主管部门（银监会信息中心）处置。据20日上午反馈情况，交通银行已经在着手修复漏洞。按部分影响完整性、可用性进行评分，基本危害评分6.42（中危），发现技术难度系数1.1（测试多种逻辑），涉及行业或单位影响系数1.6，综合rank=6.42*1.1*1.6=11.299 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-18 21:21 |    \t\t闪电小子 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:5        | PKAV技术宅社区！---闪电小子！)\t\t \n  坐等查水表    \n     2012-12-18 21:21 |    \t\tMoments \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:10        | 2)\t\t \n  下次来光大吧~ 哈哈    \n     2012-12-18 21:21 |    \t\t伟大娃娃 \t\t\t( 普通白帽子  |\t\t\t        Rank:130 漏洞数:10        | 改变世界)\t\t \n  坐等查水表    \n     2012-12-18 21:21 |    \t\tSogili \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:27        )\t\t \n  广告位。。    \n     2012-12-18 21:21 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  尼玛，全是炸弹级的呀~    \n     2012-12-18 21:22 |    \t\tL1well \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:3        | PKAV技术宅社区!--誓与AV抢宅男！)\t\t \n  有车咯~~~~~~~~~~~·    \n     2012-12-18 21:22 |    \t\tyoustar \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:8        | 我们人啊~)\t\t \n  @only_guest 你敢买么~    \n     2012-12-18 21:23 |    \t\t心伤的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:147 漏洞数:21        | 严肃点~此号为虚拟小号，并不存在实体...)\t\t \n  客官，来辆越野吧～～    \n     2012-12-18 21:26 |    \t\tonly_guest  \t\t\t( 普通白帽子  |\t\t\t        Rank:800 漏洞数:75        | PKAV技术宅社区-专心做技术.PKAV已经暂停...)\t\t \n  @youstar 不敢.    \n     2012-12-18 21:34 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  你敢买么？    \n     2012-12-18 21:34 |    \t\t胖子变瘦了 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 伤心的胖子,伤心的瘦子,以及其他所有胖子瘦...)\t\t \n  弱爆了!!!看哥连载一百集银行漏洞!!!!    \n     2012-12-18 21:36 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  不早说。。我去刷个车啊。。    \n     2012-12-18 21:48 |    \t\t蓝风 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:25        | 崬汸慾哓 嗼檤焄垳皁 沓猵圊屾亾沬荖 颩憬...)\t\t \n  来个诺亚方舟吧    \n     2012-12-18 21:55 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  坐等查水表    \n     2012-12-18 22:24 |    \t\tTrueByte \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 超级不靠谱小青年)\t\t \n  来个方舟卖票吧。    \n     2012-12-18 23:01 |    \t\t猥琐 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 学习什么的最重要！)\t\t \n  还剩三天，使劲啊    \n     2012-12-18 23:30 |    \t\tsafe121 \t\t\t( 实习白帽子  |\t\t\t        Rank:98 漏洞数:11        | http://www.gov.cn)\t\t \n  查水表    \n     2012-12-18 23:36 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  不买辆坦克么？    \n     2012-12-19 01:03 |    \t\tBlackeagle \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 向WooYun致敬)\t\t \n  @胖子变瘦了 挺你    \n     2012-12-19 01:39 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  使劲搞银行？    \n     2012-12-19 08:45 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  马上世界末日了，怕神马查水表。。赶紧免费买辆诺亚方车跑路吧亲。。    \n     2012-12-19 08:53 |    \t\tJ4nker \t\t\t( 普通白帽子  |\t\t\t        Rank:136 漏洞数:35        | I have a dream)\t\t \n  神人漏洞~    \n     2012-12-19 09:06 |    \t\tc4bbage \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:7        | var_dump($me);)\t\t \n  元芳，来辆桑塔纳吧～～    \n     2012-12-19 10:14 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  亲，打包日本车。    \n     2012-12-19 10:22 |    \t\tleehenwu \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:24        | 撸·啊·撸)\t\t \n  全买了    \n     2012-12-19 10:38 |    \t\t墨水心_Len \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:15        | PKAV技术宅 | 每一个有文化的东西，我们都...)\t\t \n  锁定CCTV新闻频道，坐等LZ上电视：）关注...    \n     2012-12-19 10:48 |    \t\tby_奇奇 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:7        | 2)\t\t \n  这。。@only_guest   LZ每次都提交那么重量级的漏洞，擦擦擦。。吓人呀。    \n     2012-12-19 11:23 |    \t\tcharles \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 研究web安全,0day,漏洞挖掘,关注国内安全动...)\t\t \n  @only_guest 这次你费了.肯定得查水表~    \n     2012-12-19 14:32 |    \t\tshack2 \t\t\t( 普通白帽子  |\t\t\t        Rank:470 漏洞数:71        | QQ:1341413415 一个热爱编程(Java),热爱网...)\t\t \n  @only_guest 开门查电表    \n     2012-12-19 17:28 |    \t\t七叶 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 求妹纸，求激情)\t\t \n  锁定CCtv 坐等楼主上镜、、    \n     2012-12-19 20:58 |    \t\tazuer \t\t\t( 普通白帽子  |\t\t\t        Rank:127 漏洞数:30        )\t\t \n   要过年了 越来越给力了！！    \n     2012-12-19 21:48 |    \t\t期待爱 \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | 这个家伙很精明 连条内裤也没有留下！！！)\t\t \n  锁定CCtv 坐等楼主上镜、    \n     2012-12-20 11:27 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  逆天了。。。。。。。。    \n     2012-12-20 17:30 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  哥，你这是要闹哪样啊    \n     2012-12-29 09:43 |    \t\tliyang \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:11        | 低调 沉默 守望)\t\t \n  想看看到底是怎么弄的。。。    \n     2013-01-01 21:35 |    \t\tMax \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:7        | When you see this sentence, I have been ...)\t\t \n  逆天了    \n     2013-01-22 11:09 |    \t\t黑云 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 米有)\t\t \n  前端验证害死人啊    \n     2013-01-29 00:28 |    \t\t专业查水表 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:5        | \"><script>alert(/我是\"J.L\"的大号/);</scr...)\t\t \n  查水表的来了~~~爆破组预备~    \n     2013-02-02 01:12 |    \t\tfox \t\t\t( 普通白帽子  |\t\t\t        Rank:159 漏洞数:16        | fox)\t\t \n  想买车的话,就少买点纸巾    \n     2013-04-29 15:06 |    \t\t剑走偏锋 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 剑走偏锋丨Zoupian Jian-feng)\t\t \n  其实咱们乌云有人利用支付漏洞有买过iphone5的，花了一分钱，其实利用支付娄底没事去看些一些收费视频网站的妹子还是可以的，哈哈。    \n     2013-06-16 14:53 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  @剑走偏锋 求网址    \n     2015-06-27 23:11 |    \t\t昌维 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | QQ：867597730，百度贴吧ID：昌维001)\t\t \n  我要买十辆，开一辆砸一辆    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}