{"id": 8004, "wybug_id": "wooyun-2013-035518", "wybug_title": "小米MIUI安全锁形同虚设（可以绕过后任意操作手机）", "wybug_corp": "小米科技", "wybug_author": "px1624", "wybug_date": "2013-08-28 18:24", "wybug_open_date": "2013-11-26 18:25", "wybug_type": "非授权访问/认证绕过", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "小米"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-05：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-10-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-26：\t细节向公众公开  简要描述： 通杀图案锁和数字锁！求小米3的F码吧，米3还没发布，不急，可以等发布了再给送。(*^__^*) 嘻嘻 详细说明：  漏洞存在原因：HOME键惹的祸。1 绕过条件，天天动听（酷我音乐盒这类都可以）有在运行。2 绕过方法，纯手动操作，配合使用锁屏键和HOME键即可。3 绕过原理（自己猜测的，看下面分析）设置手机锁屏后，这里要说到几个界面的关系。一、小米锁屏页面（最前端）。此页面中，除了解锁和长按HOME打开手电筒，不能进行任何操作。\n\n二、安全锁页面（图案锁或者数字锁）。此页面除了解锁操作和拨打紧急电话以及长按HOME打开手电筒，也不能进行任何操作。\n\n三、系统桌面可以进行任何对手机的操作。\n\n四、天天动听锁屏页面（理论上来说任何第三方锁屏都可以）\n\n绕过原理，运行天天动听后，四页面会替换掉一页面。然后配合使用锁屏键和HOME键，会导致在极短的时间里二、三、四页面都是可以操作的。但是只有在卡到了背景显示的是三页面的时候，才可以进入系统，所以这个时间点非常重要。一开始可能会有点难度，多练习几次就OK了。   漏洞证明：  3个视频密码都是wooyun1 数字安全锁绕过（盲按法）  （同事的拍摄水平有点搓啊，都没有对焦。。。）优酷地址：http://v.youku.com/v_show/id_XNjAyMDU0NzQ0.html2 图案安全锁绕过（盲按法）优酷地址：http://v.youku.com/v_show/id_XNjAyMDU2NzUy.html3 图案安全锁绕过（卡点法）（数字安全锁通用适用）卡准那个时间点，按两下锁屏键然后长按HOME键，之间的节奏是成功的关键。优酷地址：http://v.youku.com/v_show/id_XNjAyMDU3NDU2.html测试的时候，建议可以用那两种盲按法绕过，卡点法是需要节奏一定的练习才能成功的。   修复方案：  修补，HOME键的确很方便，很好用，希望不要因此而废了HOME键。建议增加一个设置，无论何种情况，锁屏状态将一页面置顶。或者你们更专业，想一个两全其美的方法吧。   版权声明：转载请注明来源 px1624@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-09-02 11:51 厂商回复： 内部已经提交漏洞给相关人员。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-28 18:36 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  你关注的白帽子 px1624 发表了漏洞 小米MIUI安全锁形同虚设（可以绕过后任意操作手机）    \n     2013-08-28 18:36 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  我现在都还用的米1青春版 哎。    \n     2013-08-28 19:17 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @Black Angel 我也是啊，米1s青春版。想买红米和小米3又抢不到，所以发漏洞求F码    \n     2013-08-28 21:17 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @px1624 直接叫厂商给送一个嘛 我知道小米很大方的。~    \n     2013-08-28 21:33 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @Black Angel 送手机这个你说说的。。。F码他们还要申请呢。月牛逼的厂商基本就越严格    \n     2013-08-28 21:49 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @px1624 嘿嘿 等结业考完了我也试试去挖一个洞子~ 然后让他们申请送米三~    \n     2013-08-28 22:01 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @Black Angel 。。。送米3手机你就别想了    \n     2013-08-29 15:15 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  @px1624 需要连接电脑么?    \n     2013-08-29 15:30 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @冷静 不需要，纯粹手工拼操作的节奏~    \n     2013-09-02 12:27 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  @px1624 90度冰天雪地里跪求    \n     2013-09-02 12:48 |    \t\t猥琐 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 学习什么的最重要！)\t\t \n  2S路过，我刚买完就降到1699！！！    \n     2013-09-02 13:15 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  5rank @px1624  你真悲催~~准备好哟，这个月哥的某公司20连发又要来了哟~~    \n     2013-09-02 15:03 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小胖子 不悲剧啊，F码已经到手了，吼吼，可以去买手机了。    \n     2013-09-05 18:11 |    \t\t冬冬 \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:16        | 学习中.....)\t\t \n  @猥琐 买了第三天1699的在这呢    \n     2013-09-11 14:56 |    \t\t0x12 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | <script>alert(/0x12/)</script>)\t\t \n  -.-屏幕开花了，求米3F码    \n     2013-11-27 13:14 |    \t\tdpanda \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 0x41414141)\t\t \n  这算是天天静听的还是小米的？    \n     2013-11-27 13:46 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  这个怎么说呢，或许在天天静听开来听歌就不应该锁屏。我以前也用的小米和天天静听，也发现了这问题。    \n     2013-11-27 16:44 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @园长 。。。你错了，我后面有发现，在锁屏状态是可以用某种方法使音乐播放器自己启动的！    \n     2013-11-27 16:44 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @dpanda 肯定算小米的啊，这个还是因为miui的设计问题。    \n     2013-11-27 18:42 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  @px1624 插入苹果耳机小米就自动播放了....    \n     2013-11-27 20:44 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @园长 。。。不是啊，真相是 WooYun: 小米锁屏设计缺陷，可利用后绕过手机安全锁，任意操作用户手机    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}