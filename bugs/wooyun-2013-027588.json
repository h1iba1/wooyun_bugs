{"id": 10598, "wybug_id": "wooyun-2013-027588", "wybug_title": "快乐购xss劫持任意用户+用户登陆访问权限控制不严", "wybug_corp": "快乐购物股份有限公司", "wybug_author": "xfkxfk", "wybug_date": "2013-07-03 15:33", "wybug_open_date": "2013-08-17 15:34", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["存储型", "黑盒测试技巧", "权限设置不当", "登陆验证设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-17：\t细节向公众公开  简要描述： 快乐购xss盲打，用户登陆访问权限控制不严，绕过直接登陆。 详细说明：  一、xss劫持任意用户一\nurl：3g.happigo.com/yijian.php\n在商品意见反馈出，反馈内容为xss code，未作任何过滤，导致xss。\n\n\n\n\n\n\n\n从上图看出，意见反馈处劫持到了管理后台地址，用户cookie二、xss劫持任意用户二\nurl：m.happigo.com/user/myword.php\n用户留言处，留言内容未过滤，导致xss。过程同上，xss劫持任意用户一，此处不再赘述。三、用户登陆访问权限控制不严通过上面的xss我们劫持到用户cookie可以直接登录。\n\n我们再来看另外一个劫持到的cookie\n\n如图我们劫持到的用户登陆url：\nhttp://m.happigo.com/help.php?search_key=&pno=2&uid=1286052&acckey=eQeFTlnkKzn91nqPAX15aSnOAf5xOwxf\n地址中就存在uid和acckey，只要我们劫持用户的这两个登陆url参数，我们直接访问这个url就可以直接登陆此用户，而不需要劫持到用户的cookie。\n\n再来看以个劫持到的用户，直接用acckey登陆。\n\n\n\n上面劫持到的两个用户都是翡翠级和白金级的会员啊，里面的积分、快乐点都是多多的四、危害分析首先是XSS的危害：1、在用户意见处可以直接劫持客服或者管理员的后台地址，登陆cookie信息。2、在我要留言处可以直接劫持任意用户登陆凭证，登陆cookie。3、这样就可以劫持任意用户然后再看看用户登陆权限访问控制不严造成的危害：1、不用输入用户名密码，不用登陆cookie，只要劫持到uid和acckey就可以直接登陆账户2、像这些高级用户的账户里面积分，快乐点，优惠劵，心意卡什么的肯定都很多，就可以被用来使用，兑换东西了。3、至于这些用户的登陆账户信息，地址信息，订单信息状态等都可以直接修改。4、由于流量很大，就在两天时间里，劫持到了200多个用户的登陆cookie和登陆凭证。这些大量用户信息的泄露也是很大问题五、声明由于流量大，劫持到较多高级用户，但是没有更改任何用户信息，以及进行任何非法操作。   漏洞证明：  见详细说明。   修复方案：  1、过滤用户输入2、控制用户登陆验证权限。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2013-07-03 16:00 厂商回复： 感谢xfkxfk的提交，我们将尽快修复！  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}