{"id": 35285, "wybug_id": "wooyun-2015-0104306", "wybug_title": "某大型P2P理财网站邮箱认证缺陷可绕过（任意邮箱认证绑定）", "wybug_corp": "nonobank.com", "wybug_author": "天地不仁 以万物为刍狗", "wybug_date": "2015-03-30 10:12", "wybug_open_date": "2015-05-14 10:22", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-14：\t细节向公众公开  简要描述： 拜金的年月，人们都已经完全忘记了生活最终的目标是什么了 详细说明：  先上两幅图 \n\n\n\ntest@wooyun.org 这个邮箱是不存在的 就算存在也不是我有的 可是现在却是绑定了的 那么我是怎么绕过的呢？\n\n这是第一次发送到我邮箱的连接 圈出来的部分是时间戳的MD5加密后的数据 在cmd5中是可解的 \n\n这两条就是我解出来的这里我说下他们这个认证的加密方法 把当前的时间转换为十位数时间戳 在发送出去的那一秒开始 加 15(正负一) 后 再将得到的时间戳进行md5加密 这里暂时不说理论的东西了 实践出真理\n帐号：wooyun999密码：a123456\n\n\n我们将绑定 test123@wooyun.com 首先我们先打开时间戳的页面 http://tool.chinaz.com/Tools/unixtime.aspx 再开启我们的burp 这里开启 burp 是为了 将发送时间戳控制在我们能看见的范围内 不然你一点发送 时间戳都没看见 怎么算加密呢？开好 burp 后 我们点击 发送邮件\n\n这里因为截图需要时间 所以我选定的时间戳为 1427465630 将它加上15 在md5加密后得到 6475ab7c3789a49479ab7f415a69fb5c \n\n我们将连接拼接后得到 http://www.nonobank.com/Account/degreeMailyz/test123@wooyun.org/6475ab7c3789a49479ab7f415a69fb5c这个连接 可是打开后 我们会发现 \n\n提示我们链接已经过期 请重新认证   难道我们的算法不对？别急 可能我们早了一秒发送 （因为眼睛的频率问题）我们将刚刚得到的时间戳 1427465645 再减去 1 得到 1427465644再加密成md5字符串得到 连接：http://www.nonobank.com/Account/degreeMailyz/test123@wooyun.org/19b42c2ef2a5e765ab6dab8a3dfed3cc这时我们在打开 \n\nOK了 我们在重新认证试试 \n\n\n\n   漏洞证明：     修复方案：  修改加密算法····   版权声明：转载请注明来源 天地不仁 以万物为刍狗@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2015-03-30 10:20 厂商回复： 谢谢，此算法可进一步调整。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-30 19:44 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  厉害啊。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}