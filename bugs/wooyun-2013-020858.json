{"id": 12854, "wybug_id": "wooyun-2013-020858", "wybug_title": "QQ2013发送消息局域网任意程序执行", "wybug_corp": "腾讯", "wybug_author": "Drizzle.Risk", "wybug_date": "2013-03-28 23:52", "wybug_open_date": "2013-05-12 23:52", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当导致攻击界面扩大", "边界绕过", "盲目信任用户数据", "设计缺陷", "客户端程序设计错误", "客户端安全", "客户端限制绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-12：\t细节向公众公开  简要描述： QQ设计缺陷，发送指定消息，可诱骗执行局域网内任意程序 详细说明：  1.QQ2013（包括之前版本）设计缺陷，对诸如 \\MYPC1  (双反斜杠+计算机名)等局域网共享格式链接，在消息框内采用URL形式显示2.QQ校验是否为可信网址，也存在缺陷，诸如 \\www.qq.com 等，验证为可信\n\n于是，怎么利用呢... 你们一定想到了，局域网共享..修改计算机名称的时候，是不能直接用小数点的，但是可以通过直接修改注册表内实现\n\n\n\n修改完重启下，然后开启共享然后在另一台电脑上测试...\n\n可信的，可以直接点击触发...\n\n然后运行吧...\n\n然后你们就懂了..公司局域网内的妹子们......我来了...   漏洞证明：  1.先在局域网找个主机修改主机名（通过注册表直接修改），修改成www.qq.com获随便其他的可信网站2.建立共享文件夹，构造一些吸引人的文件名3.关了防火墙，重启下4.然后在另一台主机测试就行，限制是应该只能在同一个域内，跨域的没试   修复方案：  你懂的！   版权声明：转载请注明来源 Drizzle.Risk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-03-29 14:54 厂商回复： 感谢反馈，此问题已在处理中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-28 23:58 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:172        )\t\t \n  围观    \n     2013-03-29 00:04 |    \t\tiiiiiiiii \t\t\t( 普通白帽子  |\t\t\t        Rank:680 漏洞数:89        | )\t\t \n  围观    \n     2013-03-29 00:11 |    \t\tEl4pse \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:7        | 世界上从来没有不可能这几个字，可不可能完...)\t\t \n  马克    \n     2013-03-29 00:12 |    \t\t钱途 \t\t\t( 普通白帽子  |\t\t\t        Rank:273 漏洞数:44        )\t\t \n  难道是../../../cmd?    \n     2013-03-29 00:30 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @钱途 。。。这个早过时了额、、    \n     2013-03-29 08:49 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:89        | 一名普通的phper开发者，关注web安全。)\t\t \n  连接问题？    \n     2013-03-29 09:03 |    \t\t蓝风 \t\t\t( 普通白帽子  |\t\t\t        Rank:125 漏洞数:25        | 崬汸慾哓 嗼檤焄垳皁 沓猵圊屾亾沬荖 颩憬...)\t\t \n  局域网内任意程序 的有//吧    \n     2013-03-29 09:33 |    \t\tRookie \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:78        | 123)\t\t \n  围观    \n     2013-03-29 10:29 |    \t\trqndx \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:3        | 种子发我邮箱：01010101010101010101010101...)\t\t \n  是不是聊天窗口发送 “死机”  对方电脑就关机了啊~    \n     2013-03-29 10:49 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:170        | 力不从心)\t\t \n  @rqndx 哈哈，估计是    \n     2013-03-29 10:51 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  @rqndx @wefgod Bingo!    \n     2013-03-29 11:09 |    \t\t苏南同学 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:5        | 苏南同学，就是苏南同学~~~)\t\t \n  还能有这事？？    \n     2013-03-29 11:13 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:170        | 力不从心)\t\t \n  @Drizzle.Risk 真相了！    \n     2013-03-29 14:00 |    \t\tDefa \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:13        | <img src=1 onerror=alert(1)>)\t\t \n  围观    \n     2013-03-29 14:24 |    \t\t小痞子 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:21        | <xss>alert(\"a\")</xss>￥&@&……dssKhwjcw...)\t\t \n  占楼！    \n     2013-03-29 14:33 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  @腾讯 还木有确认呀.. 不会要忽略吧.. :-D    \n     2013-03-29 15:45 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:29        | Focus On Web Secur1ty)\t\t \n  牛逼！    \n     2013-03-29 16:41 |    \t\tjeffreys125 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:14        | 懒人。。)\t\t \n  马克    \n     2013-03-29 21:05 |    \t\ttxcbg \t\t\t( 普通白帽子  |\t\t\t        Rank:391 漏洞数:53        | 说点什么呢？)\t\t \n  围观    \n     2013-03-29 22:25 |    \t\tJoker \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:6        | while(age++) {\tmake(rmb);\tif (outOf(...)\t\t \n  V587...我以前还用这样的\\\\hostname\\xx.exe骗人呢..日咯    \n     2013-04-08 17:28 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  这个挺有意思     \n     2013-04-18 15:52 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:170        | 力不从心)\t\t \n  看见鸟…………    \n     2013-05-13 08:54 |    \t\tth000 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | 安全初段～)\t\t \n  ...  qq.com 局域网就不能用了。    \n     2013-05-18 16:38 |    \t\tStream \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 低头要有勇气，抬头要有底气!)\t\t \n  -_- 有意思    \n     2013-06-02 15:22 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  X    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}