{"id": 46679, "wybug_id": "wooyun-2014-083946", "wybug_title": "某烟草行业通用系统存在任意文件备份漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "wefgod", "wybug_date": "2014-11-20 11:40", "wybug_open_date": "2015-02-18 11:42", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当导致攻击界面扩大"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-28：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-18：\t细节向公众公开  简要描述： 某烟草行业通用系统存在任意文件备份漏洞 详细说明：  漏洞页面是ycportal/jsp/backup/backupfile.jsp可以直接浏览网站目录下的目录，同时还可以直接备份指定的文件夹（比如WEB-INF）到指定位置，以上操作都不用登录   漏洞证明：  首先我们要知道下web的路径http://www.rzdonggang.gov.cn/ycportal/jsp/backup/backupfile.jsp先点击选择性备份的“下一步”\n\n得到web路径G:\\rzdonggang\\tomcat-dongying\\webapps\\ycportal\\返回http://www.rzdonggang.gov.cn/ycportal/jsp/backup/backupfile.jsp\n\n选择性备份，输入保存的路径G:/rzdonggang/tomcat-dongying/webapps/ycportal/styleimages（这个文件夹是上次我们上传文件获取到的路径，你也可以写到其它可以获取到并且可写的路径）\n\n下一步之后或看到所有目录\n\n选择WEB-INF，一下子就备份成功了：\n\n构造好url直接访问：http://www.rzdonggang.gov.cn/ycportal/styleimages/WEB-INF/database.xml\n\n来个数据库的http://www.rzdonggang.gov.cn/ycportal/styleimages/WEB-INF/conf/jdbcSupport.xml\n\n由于不能外链（服务器在内网）所以不进一步测试了，WEB-INF备份出来的文件夹已经删除\nhttp://www.jxfdacdc.cn/ycportal/jsp/backup/backupfile.jsphttp://www.dtycgs.cn/ycportal/jsp/backup/backupfile.jsphttp://121.30.232.54:9080/ycportal/jsp/backup/backupfile.jsphttp://sxlfyc.com/ycportal/jsp/backup/backupfile.jsphttp://www.lvlyc.com.cn/ycportal/jsp/backup/backupfile.jsphttp://59.53.245.105/ycportal/jsp/backup/backupfile.jsphttp://szycgs.cn/ycportal/jsp/backup/backupfile.jsp\n   修复方案：  验证登录权限   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2014-11-25 10:49 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-20 11:42 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  都是我的错。。。。。千不该万不该……    \n     2014-11-20 11:51 |    \t\tMr.leo \t\t\t( 普通白帽子  |\t\t\t        Rank:1314 漏洞数:176        | 说点神马呢！！)\t\t \n  @Coody 你做错什么了，女神不要你了？    \n     2014-11-20 11:54 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  @Coody 你大大错特错了，现在搞得万人轮了吧    \n     2014-11-20 11:54 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @Mr.leo 各种漏洞百出了     \n     2014-11-20 12:01 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @Mr.leo @贫道来自河北 是啊、CnCert说联系不上厂家。。。反正测试的时候都注意点就好啊、以发现问题为止。    \n     2014-11-20 12:04 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  @Coody 我之前测试半天 复现几个案例准备提交结果发现了你的一句话..果断放弃    \n     2014-11-20 12:13 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  哈哈    \n     2014-11-20 12:18 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  你们这群黑客再这么搞下去早晚出事    \n     2014-11-20 12:28 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @魇 @Coody @贫道来自河北 站都被你们搞塌了几个啊~    \n     2014-11-20 12:34 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @U神 你这么说话就不太好了哈、这套系统我不测试都好长时间了。    \n     2014-11-20 12:41 |    \t\t贫道来自河北 \t\t\t( 普通白帽子  |\t\t\t        Rank:1395 漏洞数:423        | 一个立志要把乌云集市变成零食店的男人)\t\t \n  @U神 带头大哥又出现了    \n     2015-02-19 11:01 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @贫道来自河北 @U神 带头大哥，带我飞可好    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}