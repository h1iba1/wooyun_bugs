{"id": 46835, "wybug_id": "wooyun-2014-081724", "wybug_title": "北方网内容管理系统管理员密码泄露", "wybug_corp": "天津北方网新媒体集团股份有限公司", "wybug_author": "刺刺", "wybug_date": "2014-11-14 22:09", "wybug_open_date": "2015-02-12 22:10", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-20：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-31：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-12：\t细节向公众公开  简要描述： RT:北方网内容管理系统管理员密码泄露北方网客户案例：http://products.enorth.com.cn/bfnrglxt/client/index.html看着都是报业居多。 详细说明：  北方网内容管理系统webservice接口，查询结果带有用户密码；具体linkhttp://work.hebei.com.cn:9001/pub/services/NbCmsServer?wsdlSoapUI中提交数据 GetuserbyId  userid 修改为1\n\n结果中除了超级管理员root之外，还带出了root的密码。   漏洞证明：  验证用户登录：\n\n登入成功，超级管理员，可以为所欲为的。\n\n举例：后台不是太好找，不过最多的是 work pub\n\n举例10个：http://enorth.zjol.com.cn:7001/pub/http://work.dbw.cn:6001/pub/http://sou.qhnews.com:8080/pub/http://edit.pub.hsw.cn:8080/pub/http://work.thip.gov.cn:8080/pub/http://work8.enorth.com.cn:8080/pub/http://work5.enorth.com.cn:5001/pub/http://work.nmgnews.com.cn:8080/pub/http://work.hebei.com.cn:9001/pub/http://work.hzrb.cn:9001/pub/http://work.qtv.com.cn:8080/pub/http://work2.enorth.com.cn:7001/pub/   修复方案：  1. 确认该webservice接口的用途；是否必须；必须的话是否需要传输明文密码？2. webservice接口是否需增加接入IP的验证等；   版权声明：转载请注明来源 刺刺@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-11-17 18:17 厂商回复： 非常感谢刺刺的反馈，我们已经根据刺刺提供的信息及时修复了相关系统中的漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-15 14:39 |    \t\t李宏 \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 白天岂懂夜的黑)\t\t \n  前排围观，瓜子，可乐，汽水！小板凳伺候！    \n     2015-02-13 10:42 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @刺刺  求教怎么实现的?    \n     2015-02-13 10:56 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  @BMa 问题很早就已经修复了。第一张图使用的软件是SoapUI。厂商给顺丰了一箱新年礼物，超赞的。    \n     2015-02-13 11:11 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @刺刺 图中的意思是通过SoapUI 发送了soap查询userid，但是没有限制，导致所有用户都可以查出来？ soap这种情况在wooyun比较少见，所以比较感兴趣怎么发现的，并非纠缠这个漏洞    \n     2015-07-03 12:47 |    \t\tbotak \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:6        | 只为xsser邀请码)\t\t \n  @BMa 一般是拿到源码看的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}