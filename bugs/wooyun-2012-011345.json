{"id": 17093, "wybug_id": "wooyun-2012-011345", "wybug_title": "苏宁易购某站点应用设计缺陷！", "wybug_corp": "江苏苏宁易购电子商务有限公司", "wybug_author": "有礼物送上", "wybug_date": "2012-08-26 10:06", "wybug_open_date": "2012-10-10 10:07", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-09-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-09-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-09-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-10-10：\t细节向公众公开  简要描述：  RT! 详细说明：   \n应用太混乱了，简单说明一下，然后详细说明其中一个：  大量管理页面无权限控制：  http://campus.suning.com/snjyw/user.jsp  结合上下文Struts2 Action?method=add 开发人员的CRUD操作后缀名命名习惯，找到大量管理链接：\n\nhttp://campus.suning.com/snjyw/sn_group.do?method=addFormhttp://campus.suning.com/snjyw/sn_user.do?method=addhttp://campus.suning.com/snjyw/sn_user.do?method=showListhttp://campus.suning.com/snjyw/sn_user.do?method=editForm&userid=22http://campus.suning.com/snjyw/sn_group.do?method=checkUpdateName&groupId=11&groupname=22\n\n\n\n\n\n\n\nhttp://campus.suning.com/snjyw/sn_videoSort.do?method=showListhttp://campus.suning.com/snjyw/sn_video.do?method=showList\n\n这个页面http://campus.suning.com/snjyw/select.jsp找到下面管理链接：（提交后会有个struts2访问的链接地址，http://campus.suning.com/snjyw/sn_houseproject.do?method=test改一下method，上文说的命名后缀就好了！如：http://campus.suning.com/snjyw/sn_houseproject.do?method=add）\n\nhttp://campus.suning.com/snjyw/sn_houseproject.do?method=addhttp://campus.suning.com/snjyw/sn_projectsort.do?method=addhttp://campus.suning.com/snjyw/sn_projectsort.do?method=showListhttp://campus.suning.com/snjyw/sn_material.do?method=selecthttp://campus.suning.com/snjyw/sn_material.do?method=showList\n\n\n \n\n（FreeMarker模版引擎爆异常了！选择一下“分类”查询就好了！）\n\n   漏洞证明：    重点说下面一个问题（上下文结合）：  在用户注册成功提交信息后，http://campus.suning.com/snjyw/member.do?method=register把后面的method=register换成method=add我汗！直接就是用户列表管理页面了，怎么把用户权限与管理权限的链接做到一个Action类里？开发人员典型的偷懒！好歹里面有4000个无辜的大学生参赛者啊！\n\n\n\n\n\n查看html代码，所以能找到上文中method增、查、改、删的命名规则，上面的所有功能的list页js域中都包含对应的链接，任意CRUD信息！\n\n\n另外，使用所有用户信息的excel导出功能，发现一些小有意思的东西，以前攻击者测试时的注册用户名信息，尝试：XSS、sql注射、文件读取、命令执行等，手法多姿多彩，这个人应该是个高手！\n\n\n  最少一个对外应用做成这样，应该很容易就被坏蛋入侵！   修复方案：    这个应用是在修复漏洞吗？SSH开源框架的死开发模式，程序结构调整起来不方便？烦琐吗？ 又是一个赶工期的应用？   版权声明：转载请注明来源 有礼物送上@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-08-27 09:32 厂商回复： 感谢您对苏宁易购的关注，我们将尽快解决此问题！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-19 15:28 |    \t\tlivers \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:6        | mov esp,0jmp espcrash.....)\t\t \n  这人会用wvs.    \n     2013-01-20 12:14 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个好    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}