{"id": 33845, "wybug_id": "wooyun-2015-0107880", "wybug_title": "宏景世纪EHR又一处SQL注入", "wybug_corp": "北京宏景世纪软件股份有限公司", "wybug_author": "孔卡", "wybug_date": "2015-04-21 12:39", "wybug_open_date": "2015-07-23 11:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向公众公开  简要描述： 乌云已经有2个关于此厂商的漏洞，但是没有我发现的这个，请审核费心细看 详细说明：  \nhttp://60.190.203.25:59999/templates/index/hrlogon.jsphttp://ehr.topsearch.com.hk/templates/index/hrlogon.jsphttp://221.123.128.41/templates/index/hrlogon.jsphttp://hr.bjn3cc.com/templates/index/hrlogon.jsphttp://202.205.112.6/templates/index/hrlogon.jsphttp://27.112.9.28:8081/templates/index/hrlogon.jsphttp://intranet.topsearch.com.hk/templates/index/hrlogon.jsphttp://218.64.68.150:8888/templates/index/hrlogon.jsphttp://hr.airport.gx.cn:8089/templates/index/hrlogon.jsphttp://61.133.218.206:8888/templates/index/hrlogon.jsp\n之前提交的第一处\n WooYun: 宏景EHR系统3处SQL注射漏洞 \n第二处\n WooYun: 某人才管理系统通用SQL注射打包 \n以上两处报告已经看过了 没有我发现的注射点~~~~~客户案例就不列举了，上面两位仁兄的链接里有大量案例~~~~~  首先声明是在自己公司内网测试的，版本信息如下图\n\n囧的是注入的链接，上面2处注入中提及的默认路径和我测试的环境是一样的（他们的注入点在我这里是全部OK的），但是该应用在不同公司有另外模块的个性路径，有点懵，直接贴包吧\nGET /个性路径（一般是公司名）/reqPost.jsp?a0100=00000926&jobid=000030A003 HTTP/1.1Accept: application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, */*Referer: http://ehr.XXXX.com.cn/templates/index/mainpanel.do?b_query=link&module=-1Accept-Language: zh-CNUser-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E; InfoPath.3)Accept-Encoding: gzip, deflateHost: ehr.XXXX.com.cnProxy-Connection: Keep-AliveCookie: _ga=GA1.3.711326240.1420596995; JSESSIONID=14DCA585043F2FBD444FF196BBA9F9BE; bosflag=h\n路径够奇葩吧，所以利用的话只能是内部员工来利用，关键字我也不知道该怎么搜，找到目标站点可以试下猜测路径，内部人士的话一目了然；而且无须cookie可直接开搞，如：\nhttp://ehr.XXXX.com.cn/个性路径/reqPost.jsp?a0100=00000926&jobid=000030A003\n可以在查个人职位/职能时候抓包，抓出该个性路径\n\n\n\na0100和jobid两个参数都可以注入\n\n于是乎，公司在职员工的个人信息，工资明细都dump出来了~~~~不方便截图了。P.S 已经找另一个小伙伴在他们公司测试，亦有此注入点，也看到了工资，诶~~~他要跳槽了~~~~   漏洞证明：  \nhttp://ehr.XXXX.com.cn/个性路径/reqPost.jsp?a0100=00000926&jobid=000030A003\n可以在查个人职位/职能时候抓包，抓出该个性路径\n\n\n\na0100和jobid两个参数都可以注入\n\n   修复方案：  参数过滤~~~厂商大大快点发补丁吧，否则看了工资人都跑完了~~~~~~   版权声明：转载请注明来源 孔卡@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-04-24 11:41 厂商回复： CNVD未直接复现漏洞情况，暂未建立与软件生产厂商（或网站管理单位）的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}