{"id": 26446, "wybug_id": "wooyun-2015-0128625", "wybug_title": "熊猫推拿o2o网站某漏洞导致用户资料泄露", "wybug_corp": "熊猫推拿", "wybug_author": "路人甲", "wybug_date": "2015-07-23 15:21", "wybug_open_date": "2015-09-06 15:22", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-23：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-09-06：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 可用正常用户的cookie访问网站,然后修改cookie中的unique code获得用户订单,用户手机号码,消费详情等信息. 详细说明：  1.用正常用户身份登陆,进入订单链接http://m.nanapanda.cn/order/list?start=1&limit=5获得session,可看下图\n\n图中NANA_UCODE是关键，可通过枚举这个UCODE获得其它客人的订单信息。NANA_UOPCODE是当前客人的手机号码。可通过枚举之后获取orderId,orderNumber,服务项目，服务时间，按摩师等信息2.有了orderNumber，可通过请求以下链接获取客人姓名，服务地点，如下图http://m.nanapanda.cn/pay/wxpay/?orderNo=XXXXXX\n\n3.有了UCODE可通过以下链接获取客人手机号码http://m.nanapanda.cn/user/center 同样与第1步一样，只要修改cookie中的UCODE即可\n\n4.至此获得了客人姓名，手机号码，服务时间地点，服务按摩师，消费金额，消费项目   漏洞证明：  通过把UCODE从319001开始枚举到319500，已经获取了部分顾客消费信息，如下图：\n\n   修复方案：  放在session中的UCODE不要连续存放，或者一个hash值，防止程序枚举   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}