{"id": 64378, "wybug_id": "wooyun-2013-026062", "wybug_title": "壹心理多处CSRF", "wybug_corp": "xinli001.com", "wybug_author": "caunion", "wybug_date": "2013-06-17 17:15", "wybug_open_date": "2013-08-01 17:16", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "2", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-06-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-01：\t细节向公众公开  简要描述： 壹心理是个有些类似豆瓣的网站，有FM,小组等。多处存在跨站漏洞。主要原因是没有后台过滤。 详细说明：  评论区只做了前端的htmlencode。。。直接用fiddler截包，修改内容，再replay就行了   漏洞证明：  \n\n\n\n\n\n然后随便就可以拿一堆cookie，不少还是核心用户的。\n\n值得注意的是：1.这个网站所有的几乎评论区都有这个问题，一些热门的帖子只要挂了这个所有看帖的人都中招。。2.网站的cookie中的sessionid被标记为httpOnly了，没法利用cookie登录他人的账户。但是搞个欺骗登录或者挂广告什么的都还是可以的。3.后端过滤很重要！这里用<script>测试都过了,可以想象利用iframe,style expression/javascript, onload事件等等跨站方法应该都可行。4.这个网站提供的FM真的很不错。   修复方案：  注意后台过滤！   版权声明：转载请注明来源 caunion@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-06-17 17:34 厂商回复： 非常感谢这位热心人的漏洞反馈，我们会加强这方面的安全过滤。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-12 23:39 |    \t\tfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:664 漏洞数:80        | 想刷个6D)\t\t \n  这是csrf还是xss?    \n     2013-08-02 09:58 |    \t\t壹心理(乌云厂商)\t\t \n  cookie是怎么拿的？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}