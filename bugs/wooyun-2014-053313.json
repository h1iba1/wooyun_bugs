{"id": 4596, "wybug_id": "wooyun-2014-053313", "wybug_title": "新浪某分站用户所有资料被重置漏洞(包括密码)", "wybug_corp": "新浪", "wybug_author": "气质鸵鸟", "wybug_date": "2014-03-11 17:59", "wybug_open_date": "2014-04-25 17:59", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-04-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-25：\t细节向公众公开  简要描述： 验证存在漏洞导致可以重置任一用户任何信息。 详细说明：  漏洞所在域名：zhongyi.sina.com用户注册的验证存在漏洞导致可以重置任一用户任何信息。\n\n这里重置了admin用户的资料以及密码。   漏洞证明：  先进行注册\n\n当填写用户名完成并进行下一步的时候会用ajax进行验证用户名有没有被注册过。服务器发包回来的时候我们再看一下包的内容。\n\n这里通过ajax来进行验证后服务器返回了exist（存在）此用户。经测试当不存在的时候返回noexist，我们来进行验证：\n\n这里我把回来的包改成noexist看看结果：\n\n看上图，验证通过，服务器认为些用户名不存在，而且后面也不会再检查是否存在这个号就直接写入数据库，当然我们设置的密码也会把此用户名原来的密码给替换，我们进一步进行验证：\n\n上图是填写完成的资料。我们点下一步：\n\n这里的资料就看你自由发挥了，这里填的将全部更新此账号里面的对应信息。下面我们直接到最后一步：\n\n不知道是不是因为此号已经存大，所以没有收到激活的邮件。   修复方案：  大哥啊，不能在中途验证完了后面提交整个表单的时候就不管了啊，中间被XXOO了怎么办？修复方案你懂的   版权声明：转载请注明来源 气质鸵鸟@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2014-03-11 18:11 厂商回复： 感谢关注新浪安全，新浪中医是第三方合作站点，账号体系跟新浪没有关系，所以评分较低，马上将该漏洞反馈给响应人员 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-01 00:28 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  你这个修改的 noexist 实在返回数据中还是在post请求的数据中修改的？    \n     2014-04-11 09:44 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  @px1624 看图是在返回的数据中修改的，然后本地验证，ajax发包，所以目测本地也可以直接构造数据包的。。。不知理解有误没有    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}