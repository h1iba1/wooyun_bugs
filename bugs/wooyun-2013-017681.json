{"id": 14164, "wybug_id": "wooyun-2013-017681", "wybug_title": "乐宿客任意用户订单取消任意用户订单查询", "wybug_corp": "乐宿客", "wybug_author": "se55i0n", "wybug_date": "2013-01-22 17:05", "wybug_open_date": "2013-03-08 17:06", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-02-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-08：\t细节向公众公开  简要描述： 求礼物，求给力~ 详细说明：  注册两枚用户，136xxxxx，139xxxxx，你们这个注册的时候也不验证下，可随意注册手机号呀；1）任意用户订单取消（直接影响业务）；1.1）使用139xxxxx的用户下一个订单；\n\n1.2）点击取消订单并抓包，获取该操作生成的URL如下；\nhttp://www.lesuke.com/front/order_cancelOrder?orderNo=3xxxxxx\n1.3）打开另一个浏览器，使用136xxxxxx的用户登陆；登陆后直接在浏览器提交上面的url请求，服务器返回\"true\";\n\n1.4)在139用户下刷新订单页面，发现订单已经被取消；\n\n2）任意用户订单查询（可泄漏用户隐私信息，你懂的）；2.1）该漏洞和上面属于同一类型，在139用户下查看我们刚刚取消的订单详情，获取url查询请求；2.2）在136用户下直接请求该url，获取到该订单详情；\n\n3）可生成负数订单（这个不知道你们怎看）；3.1）选定一家酒店，点击提交并抓包；\n\n3.2）发现参数中有房间价格和房间数量，修改价格无效后，尝试将放假数量修改成“-1”并提交（截图后补，和上图参数有出入）；\n\nPS：系统生成的订单号为：3+“6位数字”虽然不是连续的数字，但是纯数字我们通过遍历即可获取所有有效订单号，实际危害你们评估下吧！！哈哈，最后求个新年礼物!   漏洞证明：  见详细说明~   修复方案：     版权声明：转载请注明来源 se55i0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2013-01-23 09:56 厂商回复： 该漏洞已核实。非常感谢@se55i0n的发现。欢迎继续监督。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-22 17:12 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xsser 我的51比购的不够审么，今天回家发个其他网站给力的    \n     2013-01-22 17:25 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @小胖胖要减肥 你每次都是发基本没什么太大实际意义的    \n     2013-01-22 17:28 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xsser 。。。。都漏洞打包了 51的危害是不够大，没仔细测试，但之前连csrf加关注都能过，这个不能过说不过去了把，而且我辛苦码了那么多字，今天回家发个影响大的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}