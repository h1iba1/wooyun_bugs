{"id": 79213, "wybug_id": "wooyun-2015-0158631", "wybug_title": "华润万家购物网站任意修改用户密码漏洞", "wybug_corp": "华润E万家", "wybug_author": "yonghao", "wybug_date": "2015-12-07 12:14", "wybug_open_date": "2016-01-21 18:22", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-21：\t细节向公众公开  简要描述： 相约华润万家，畅享冬天里的故事 详细说明：  http://www.ewj.com/find_password.html爆破可重置任意用户密码  这里为了不影响其他账号，我就自己注册了一个账号进行测试在测试的时候，发现华润E万家在重置密码的控制上，对验证码没有任何时间限制，此时验证码是纯数字，验证也没有任何验证限制，爆破简单且粗暴。\n\n废话少说，进行验证码爆破\n\n这是返回正确的数据\nHTTP/1.1 200 OKDate: Sat, 05 Dec 2015 12:45:02 GMTServer: Apache/2.4.10 (Unix) OpenSSL/0.9.8e-fips-rhel5Content-Type: text/html;charset=UTF-8Content-Length: 165Accept-Ranges: bytesVia: 1.1 Xcache_EWJ_1X-Via: 1.1 jszjdx84:0 (Cdn Cache Server V2.0)Connection: close{\"state\":true,\"errorCode\":\"\",\"webUrl\":\"https://www.ewj.com\",\"encode\":\"SjhpcU9yK2ZoaDJEbWJtZzloMlpZMG1y\",\"loginId\":\"jianai\",\"skey\":\"Q8HzQCGcHch85fEi2RSCJaYxG8ddYR2A\"}\n抓包放回错误的\nHTTP/1.1 200 OKDate: Sat, 05 Dec 2015 12:45:02 GMTServer: Apache/2.4.10 (Unix) OpenSSL/0.9.8e-fips-rhel5Content-Type: text/html;charset=UTF-8Content-Length: 165Accept-Ranges: bytesVia: 1.1 Xcache_EWJ_1X-Via: 1.1 jszjdx84:0 (Cdn Cache Server V2.0)Connection: close{\"state\":true,\"errorCode\":\"\",\"webUrl\":\"https://www.ewj.com\",\"encode\":\"SjhpcU9yK2ZoaDJEbWJtZzloMlpZMG1y\",\"loginId\":\"jianai\",\"skey\":\"Q8HzQCGcHch85fEi2RSCJaYxG8ddYR2A\"}\n重置任意账号   漏洞证明：  \n\n这是返回正确的数据\nHTTP/1.1 200 OKDate: Sat, 05 Dec 2015 12:45:02 GMTServer: Apache/2.4.10 (Unix) OpenSSL/0.9.8e-fips-rhel5Content-Type: text/html;charset=UTF-8Content-Length: 165Accept-Ranges: bytesVia: 1.1 Xcache_EWJ_1X-Via: 1.1 jszjdx84:0 (Cdn Cache Server V2.0)Connection: close{\"state\":true,\"errorCode\":\"\",\"webUrl\":\"https://www.ewj.com\",\"encode\":\"SjhpcU9yK2ZoaDJEbWJtZzloMlpZMG1y\",\"loginId\":\"jianai\",\"skey\":\"Q8HzQCGcHch85fEi2RSCJaYxG8ddYR2A\"}\n抓包放回错误的\nHTTP/1.1 200 OKDate: Sat, 05 Dec 2015 12:45:02 GMTServer: Apache/2.4.10 (Unix) OpenSSL/0.9.8e-fips-rhel5Content-Type: text/html;charset=UTF-8Content-Length: 165Accept-Ranges: bytesVia: 1.1 Xcache_EWJ_1X-Via: 1.1 jszjdx84:0 (Cdn Cache Server V2.0)Connection: close{\"state\":true,\"errorCode\":\"\",\"webUrl\":\"https://www.ewj.com\",\"encode\":\"SjhpcU9yK2ZoaDJEbWJtZzloMlpZMG1y\",\"loginId\":\"jianai\",\"skey\":\"Q8HzQCGcHch85fEi2RSCJaYxG8ddYR2A\"}\n   修复方案：  加时间验证加强验证码等等   版权声明：转载请注明来源 yonghao@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-12-09 11:13 厂商回复： 感谢提交 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}