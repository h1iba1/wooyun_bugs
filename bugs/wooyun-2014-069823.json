{"id": 52873, "wybug_id": "wooyun-2014-069823", "wybug_title": "某政府监察平台通用SQL注入大礼包", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "sex is not show", "wybug_date": "2014-07-28 14:32", "wybug_open_date": "2014-10-26 14:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-05：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-26：\t细节向公众公开  简要描述： 根据宪法规定：发政府的洞，十个中要有一个上首页 详细说明：  开发公司：北京中农信达信息技术有限公司（http://www.agrij.com/）程序名称：中农信达农村集体三资网络监管系统漏洞类型：SQL注入漏洞文件：\n/monitor/szgk_form.jsp?village_dm=010101        参数：village_dm        /reports/homepage.jsp?pdm=010101           参数：pdm         /monitor/in_out_list.jsp?village_dm=0100&ny1=2013&ny2=2014&pageno=1          参数：village_dm\n是否需要登录：否关键字：inurl:login_form.jsp        intitle:中农信达农村集体三资网络监管系统影响用户：百度了几个案例(案例不全)，方便演示：\nhttp://202.99.207.13:8081/finance11n/http://124.164.240.217:8080/finance03/http://111.12.148.194:7005/finance_qhld/http://61.185.74.147:8080/finance67/http://nat.nat123.net:11158/finance/http://www.cldwcwgk.gov.cn:8083/finance80/http://116.255.135.35:8082/finance_glx/http://221.131.81.143:7001/finance_oracle/\n共3个注入点，源码分析+实例演示：<b>注入点1：</b>/monitor/szgk_form.jsp?village_dm=010101\n...String village_dm=request.getParameter(\"village_dm\"); //(String)session.getAttribute(\"village_dm\");java.sql.ResultSet rs=null;String village_name=\"\";try{\trs=dBBean.openRs(\"select * from zt where dm='\"+village_dm.substring(0,4)+\"' or  dm='\"+village_dm+\"' order by dm\");//参数直接带入查询\tif(rs!=null){\t\trs.next();\t\t\t\tvillage_name=rs.getString(\"name\");\t\trs.next();\t\tsls=rs.getString(\"name\");\t\tvillage_name=village_name.trim()+sls.trim();\t}}...\n实例演示：1.http://124.164.240.217:8080/finance03/monitor/szgk_form.jsp?village_dm=010101\n\n2.http://61.185.74.147:8080/finance67/monitor/szgk_form.jsp?village_dm=010101\n\n3.http://219.157.74.6:8080/finance/monitor/szgk_form.jsp?village_dm=010101\n\n4.http://116.255.135.35:8082/finance_glx/monitor/szgk_form.jsp?village_dm=010101\n\n5.http://221.131.81.143:7001/finance_oracle/monitor/szgk_form.jsp?village_dm=010101\n\n<b>注入点2：</b>/reports/homepage.jsp?pdm=010101   \nString pdm=request.getParameter(\"pdm\");//传入参数java.text.SimpleDateFormat formatter =new java.text.SimpleDateFormat (\"yyyy-MM-dd\", Locale.getDefault());Date today=new Date();formatter.applyPattern(\"yyyy-MM-dd\");String stoday= formatter.format(today);\tString sls=stoday.substring(0,4)+stoday.substring(5,7);int i_year=Integer.parseInt(sls.substring(0,4));int i_month=Integer.parseInt(sls.substring(4,6));try{\trs=dBBean.openRs(\"select name from zt where dm='\"+pdm+\"'\");//未过滤，导致注入\trs.next();\tString town=rs.getString(\"name\");}\n实例演示：1.http://202.99.207.13:8081/finance11n/reports/homepage.jsp?pdm=010101\n\n2.http://124.164.240.217:8080/finance03/reports/homepage.jsp?pdm=010101\n\n3.http://111.12.148.194:7005/finance_qhld/reports/homepage.jsp?pdm=010101\n\n4.http://116.255.135.35:8082/finance_glx/reports/homepage.jsp?pdm=010101\n\n5.http://61.185.74.147:8080/finance67/reports/homepage.jsp?pdm=010101%27\n\n   漏洞证明：  <b>注入点3：</b>/monitor/in_out_list.jsp?village_dm=0100&ny1=2013&ny2=2014&pageno=1\nString village_dm=request.getParameter(\"village_dm\");String ny1=request.getParameter(\"ny1\"); String ny2=request.getParameter(\"ny2\"); String sls=\"\";if(Integer.parseInt(ny1)>Integer.parseInt(ny2)){\tsls=ny2;\tny2=ny1;\tny1=sls;}sls=request.getParameter(\"pageno\");if(sls==null)\tsls=\"0\";int pageno=Integer.parseInt(sls);if(pageno<1)\tpageno=1;java.sql.ResultSet rs=null;String village_name=\"\";try{\trs=dBBean.openRs(\"select * from zt where dm='\"+village_dm.substring(0,4)+\"' or  dm='\"+village_dm+\"' order by dm\"); //<b>参数未过滤直接带入查询</b>\tif(rs!=null){\n 实例演示：随便找两个站演示：1.注入点：http://61.185.74.147:8080/finance67/monitor/in_out_list.jsp?village_dm=0100&ny1=2013&ny2=2014&pageno=1\n\n\n\n2.注入点：http://www.cldwcwgk.gov.cn:8083/finance80/monitor/in_out_list.jsp?village_dm=0100&ny1=2013&ny2=2014&pageno=1\n\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 sex is not show@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：19  确认时间：2014-08-02 09:35 厂商回复：   最新状态： 2014-08-04：CNVD确认并复现所述情况，已经由CNVD按近期建立的处置渠道邮件向软件生产厂商通报。  ", "replys": "漏洞评价：\n评论\n     2014-07-30 20:04 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  乌云不遵守宪法以及中华人民共和国平等法，建议严惩乌云！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 19, "Ranks": null}