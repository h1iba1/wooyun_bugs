{"id": 52999, "wybug_id": "wooyun-2014-069268", "wybug_title": "YXcms可打后台xss", "wybug_corp": "yxcms.net", "wybug_author": "zxx", "wybug_date": "2014-07-22 11:09", "wybug_open_date": "2014-10-17 11:10", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-27：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-17：\t细节向公众公开  简要描述： 过滤不严格，xss可打后台。 详细说明：  \n输入：Protected/member/controller/inforController.php中\t    public function index()\t    {        if(!$this->isPost()){           $auth=$this->auth;           $id=$auth['id'];           $info=model('members')->find(\"id='{$id}'\");           $this->info=$info;           $this->path=__ROOT__.'/upload/member/image/';           $this->twidth=config('HEAD_W');           $this->theight=config('HEAD_H');           $this->display();        }else{           $id=intval($_POST['id']);           $data['nickname']=in(trim($_POST['nickname']));           $acc=model('members')->find(\"id!='{$id}' AND nickname='\".$data['nickname'].\"'\");           if(!empty($acc['nickname'])) $this->error('该昵称已经有人使用~');           if (empty($_FILES['headpic']['name']) === false){                $tfile=date(\"Ymd\");                $imgupload= $this->upload($this->uploadpath.$tfile.'/',config('imgupSize'),'jpg,bmp,gif,png');                $imgupload->saveRule='thumb_'.time();                $imgupload->upload();                $fileinfo=$imgupload->getUploadFileInfo();                $errorinfo=$imgupload->getErrorMsg();                if(!empty($errorinfo)) $this->alert($errorinfo);                else{                    if(!empty($_POST['oldheadpic'])){                       $picpath=$this->uploadpath.$_POST['oldheadpic'];                       if(file_exists($picpath)) @unlink($picpath);                    }                    $data['headpic']=$tfile.'/'.$fileinfo[0]['savename'];                }                }           $data['email']=$_POST['email']; //直接将$_POST[‘email’]传入，没有过滤，也没有对email的格式进行验证           $data['tel']=in($_POST['tel']);           $data['qq']=in($_POST['qq']);           model('members')->update(\"id='{$id}'\",$data);//更新到数据库           $this->success('信息编辑成功~');        }\t    }输出：Protected/apps/member/controller/adminmemberController.php\tpublic function edit()\t{\t\tif(!$this->isPost()){\t\t\t$id=$_GET['id'];\t\t\tif(empty($id)) $this->error('参数错误');\t\t\t$info=model('members')->find(\"id='$id'\");//直接从数据库中查询\t\t\t$info['rrmb']=$info['rmb']-$info['crmb'];\t\t\t$group=model('memberGroup')->select(\"id !='1'\",\"id,name\");\t\t\tforeach ($group as $val) {\t\t\t\t$select.=($val['id']==$info['groupid'])?\"<option selected='selected' value='{$val['id']}'>{$val['name']}</option>\":\"<option value='{$val['id']}'>{$val['name']}</option>\";\t\t\t}\t\t\t$this->select=$select;\t\t\t$this->info=$info;\t\t\t$this->display();//调用Protected/apps/member/view/adminmember_edit.php\t\t}else{\t\t\t。。。。\t\t}\t}Protected/apps/member/view/adminmember_edit.php中            <tr>               <td align=\"right\">邮箱：</td>               <td><input type=\"text\" name=\"email\" value=\"{$info['email']}\"></td>               <td class=\"inputhelp\"></td>            </tr>直接输出没有过滤\n   漏洞证明：  \n\n管理会员信息时，显示email\n\n   修复方案：  还是过滤吧   版权声明：转载请注明来源 zxx@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-10-17 11:10 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}