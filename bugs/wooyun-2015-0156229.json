{"id": 80292, "wybug_id": "wooyun-2015-0156229", "wybug_title": "赶集房产帮帮某登录处存在撞库攻击（奇葩过程）", "wybug_corp": "赶集网", "wybug_author": "指尖上的故事", "wybug_date": "2015-11-27 10:37", "wybug_open_date": "2016-01-14 17:52", "wybug_type": "基础设施弱口令", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["弱口令", "管理后台对外", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-14：\t细节向公众公开  简要描述： 感谢自己手贱......哈哈 详细说明：  \nhttps://passport.ganji.com/login.php?next=http%3A%2F%2Fwww.ganji.com%2Fsite%2Fu%2F\n这是赶集房产帮帮某登录处（一般登陆处在这里）在这里爆破是不可能的因为有验证码...后来我找到了这个地址：\nhttp://fangvip.ganji.com/auth.php?do=login\n经过测试后发现这里存在问题 抓包如下：\nPOST /auth.php?do=login HTTP/1.1Host: fangvip.ganji.comContent-Length: 57Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://fangvip.ganji.comUpgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/45.0.2454.101 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://fangvip.ganji.com/auth.php?do=loginAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: __utmganji_v20110909=0x811969610839150x5503f80ed4b2e35; ganji_uuid=9983304235117631124735; ganji_xuuid=8dc13f51-ad84-4a07-d453-f28d5b26d804.1446221201992; undefined=9c7361d7-88c4-44bd-a114-471f5496ccb3; sscode=gyKSQ1F0HYVSVRGCgyWjzTPz; GanjiUserName=wooyunj; GanjiUserInfo=%7B%22user_id%22%3A567410792%2C%22email%22%3A%22%22%2C%22username%22%3A%22wooyunj%22%2C%22user_name%22%3A%22wooyunj%22%2C%22nickname%22%3A%22%22%7D; bizs=%5B%5D; supercookie=AGL3AQRjAmxlWQSvAwx5ZwyyAmV2AmV1LzRmZGWzMJD3ZQt5LwRkMzVkZ2HkBGHlZTZ%3D; jy_reg_recommend_userids_jsonstr=%5B%2228562388%22%2C%22170796109%22%2C%2289132486%22%2C%2254979472%22%2C%22155668923%22%5D; jy_reg_flag_pop=reg; GANJISESSID=6b42f1685d16aa0e3e7080c091a6a342; __utmt=1; __utma=32156897.721529753.1446221098.1446221098.1448567063.2; __utmb=32156897.13.10.1448567063; __utmc=32156897; __utmz=32156897.1448567063.2.2.utmcsr=baidu|utmccn=(organic)|utmcmd=organicnext=&no_cookie_test=1&username=111111&password=111111111\nusername=111111 password=111111111 传输数据没有加密明文递交  也没有验证码..果断拿起Burp爆破  账号可分为：用户名  邮箱 手机号我拿姓名TOP500+123456测试出以下用户\n\nmask 区域\n*****iang\t**********hua\t1**********ing\t1**********ua\t12**********ng\t1**********ng\t1**********ng\t1**********\t123**********ng\t12**********an\t12**********en\t12**********g\t12**********n\t123**********g\t12**********a\t123**********ng\t12**********g\t12**********n\t12**********g\t123**********ui\t12**********\t123**********ng\t1**********n\t123**********un\t1**********\t123**********1234**********n\t12**********g\t123**********\t123**********de\t1**********1234**********n\t12**********ng\t1**********1234**********1234**********\t123**********\t12**********\t12**********1234**********1234**********\t12*****\n\n输出账号和密码，点击登录  提示:你输出的用户名和密码错误！（到此奇葩事出现了）这个时候点击页面底部的“修改/删除信息 ” 就发现账号其实已经登录了...当然也可以直接在这里https://passport.ganji.com/login.php?next=http%3A%2F%2Fwww.ganji.com%2Fsite%2Fu%2F  输出账号和密码登陆   漏洞证明：  随便登录个账号证明一下吧 (管理员自己测试一下吧)\n\n\n\n\n\n\n\n当然也可以直接把爆破出来的结果拿去：https://passport.ganji.com/login.php?next=%2Fvip%2F  进接登录   修复方案：  ..你们更专业   版权声明：转载请注明来源 指尖上的故事@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-11-30 17:52 厂商回复： 确认漏洞存在，感谢提交！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-11-30 01:04 |    \t\t指尖上的故事 \t\t\t( 普通白帽子  |\t\t\t        Rank:617 漏洞数:131        | 放手不是我们不合适 | 而是成就你们更适合)\t\t \n  @赶集网   什么情况还不确认  这是要忽略的节奏吗    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}