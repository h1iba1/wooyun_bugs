{"id": 63906, "wybug_id": "wooyun-2013-028583", "wybug_title": "龙腾卡网站存在命令执行漏洞", "wybug_corp": "龙腾卡", "wybug_author": "Welsmann", "wybug_date": "2013-07-11 18:10", "wybug_open_date": "2013-08-25 18:11", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程命令执行", "远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-11：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-08-25：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 龙腾卡网站存在命令执行漏洞，年代比较久远似乎，同时发现若干前人光顾痕迹 详细说明：  从http://dragonpass.com.cn/f-news-show?news.id=47959这种地址大致猜想news.id对应后台的对象与属性，猜测应该是用了struts框架，就试了下是否存在命令执行的问题，果然还是存在的。   漏洞证明：  \n\nEmail配置：#\\u53d1\\u9001\\u90ae\\u4ef6\\u53c2\\u6570\\u914d\\u7f6ehost=mail.toprand.comusername=wangxing@toprand.compassword=toprand123mail.smtp.auth=true数据库配置：pool.driverClassName=oracle.jdbc.driver.OracleDriverpool.url=jdbc:oracle:thin:@(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.100.3)(PORT=1521))(ADDRESS=(PROTOCOL=TCP)(HOST=192.168.100.4)(PORT=1521))(LOAD_BALANCE=yes)(FAILOVER=on))(CONNECT_DATA=(SERVICE_NAME=dragon)))pool.ip=192.168.100.3pool.port=1521pool.database=dragonpool.username=tupaipool.password=kjDGe1ka8kdHpool.maxActive=30pool.maxIdle=100pool.maxWait=5000 pool.initialSize=100pool.defaultAutoCommit=false#\\u662f\\u5426\\u81ea\\u52a8\\u56de\\u6536\\u8d85\\u65f6\\u8fde\\u63a5pool.removeAbandoned=true #\\u8bbe\\u7f6e\\u88ab\\u9057\\u5f03\\u7684\\u8fde\\u63a5\\u7684\\u8d85\\u65f6\\u7684\\u65f6\\u95f4\\uff08\\u4ee5\\u79d2\\u6570\\u4e3a\\u5355\\u4f4d\\uff09\\uff0c\\u5373\\u5f53\\u4e00\\u4e2a\\u8fde\\u63a5\\u88ab\\u9057\\u5f03\\u7684\\u65f6\\u95f4\\u8d85\\u8fc7\\u8bbe\\u7f6e\\u7684\\u65f6\\u95f4\\uff0c\\u5219\\u5b83\\u4f1a\\u81ea\\u52a8\\u8f6c\\u6362\\u6210\\u53ef\\u5229\\u7528\\u7684\\u8fde\\u63a5\\u3002\\u9ed8\\u8ba4\\u7684\\u8d85\\u65f6\\u65f6\\u95f4\\u662f300\\u79d2\\u3002 pool.removeAbandonedTimeout=60 #\\u7ed9\\u51fa\\u4e00\\u6761\\u7b80\\u5355\\u7684sql\\u8bed\\u53e5\\u8fdb\\u884c\\u9a8c\\u8bc1 pool.validationQuery=select 1 from dual #\\u5728\\u53d6\\u51fa\\u8fde\\u63a5\\u65f6\\u8fdb\\u884c\\u6709\\u6548\\u9a8c\\u8bc1 pool.testOnBorrow=truehibernate.showSQL=falsehibernate.dialect=org.hibernate.dialect.OracleDialecthibernate.format_sql=falsehibernate.hbm2ddl=updatehibernate.current_session_context_class=threadhibernate.connection.release_mode=after_transaction   修复方案：  补，删。   版权声明：转载请注明来源 Welsmann@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}