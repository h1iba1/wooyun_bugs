{"id": 56548, "wybug_id": "wooyun-2014-057379", "wybug_title": "上海移动某旗下商城购买数量无校验可篡改", "wybug_corp": "上海移动", "wybug_author": "DeLETe", "wybug_date": "2014-04-17 11:01", "wybug_open_date": "2014-06-01 11:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-01：\t细节向公众公开  简要描述： 数量可截包改为负数，然后有购物车，然后你们懂的。。 详细说明：  http://www.12580emall.com/emall/index.jsp提前说一下，利用这个漏洞买商品的时候只能在同一个商家里买，保证一个商家里提交子订单的金额为正，否则最后跳转到支付页面的时候过不了校验。首先随便在一商家里买点什么，然后在同一商家买个贵的东西截包把数量改成负数：\n\n最后在购物车里结算的时候，金额就会作加减运算啦~\n\n一路勾选，最后来到支付跳转页面：\n\n成功跳转到银行的网银支付页面：\n\n因为该商城里卖的东西都比较高端自己又没什么想买的又只能在同一商家里买。。而且同一商家里差价小的东西比较少，贵的东西付钱了又怕最后退钱的时候出问题，所以最后没有付钱。但是从已经成功跳转网银的支付界面来看，支付成功是妥妥的事情。厂商可以自查一下。   漏洞证明：  \n\n\n\n   修复方案：  对购买数量在服务器端进行校验   版权声明：转载请注明来源 DeLETe@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-04-22 08:33 厂商回复： CNVD未直接复现完整过程，对于此类订单支付类逻辑漏洞，已经多次向基础电信企业通报，该案例已经转由CNCERT直接向中国移动集团公司通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}