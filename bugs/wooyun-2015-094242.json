{"id": 45768, "wybug_id": "wooyun-2015-094242", "wybug_title": "天天网任意账号密码重置(非暴力温柔修改)", "wybug_corp": "tiantian.com", "wybug_author": "蓝冰", "wybug_date": "2015-01-28 10:55", "wybug_open_date": "2015-03-14 10:56", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-14：\t细节向公众公开  简要描述： RT 详细说明：  首先我们先来看一下 找回密码的流程1.填好邮箱和验证码 下一步\n\n\n\n返回了邮箱2.填写正确的验证码 抓包看一看\n\n\n\n可以看到返回了一串加密字符串这个很重要 等会再说 经过测试证明 cookie中的 值对找回密码没有影响3.重置密码\n\n可以看到URL中的 一串加密字符串正是 第二步中 返回的那串字符串因为证明 cookie中的 值对找回密码没有影响 所以只要拿到这个加密字符串就可以 任意重置密码那么怎么得到这个字符串呢\n\n这个是第二步中抓到的包 把cookie中的 LoginOrRegOftiantianUser值 改成要重置的账号这里我拿service@tiantian.com 测试可以看到 成功返回了 加密字符串既然拿到了 字符串 下一步就是重置密码了首先输入邮箱和验证码 点击下一步 这一步是必须要做的 要不然不会成功\n\n然后直接用 拿到的字符串 访问重置密码的页面 假如 上一步没有做的话 到这一步会直接302跳转\n\n重置成功\n\n\n\nOK 密码被重置为 wooyun123   漏洞证明：  已证明   修复方案：  对找回密码这一块 建议重构代码   版权声明：转载请注明来源 蓝冰@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-01-28 11:48 厂商回复： 多谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-28 11:26 |    \t\tY4ngshu \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:7        | 十年磨一剑。)\t\t \n  - -又是走大厂商啊 人品爆了啊  么么哒    \n     2015-01-28 13:16 |    \t\tucifer \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:52        | 萌萌哒~)\t\t \n  大厂商，偶现在还挖不动啊。。@蓝冰求带    \n     2015-04-20 20:13 |    \t\tredare \t\t\t( 实习白帽子  |\t\t\t        Rank:49 漏洞数:13        )\t\t \n  重复 WooYun: 天天网任意账户密码重置（二）    \n     2015-04-21 13:58 |    \t\t蓝冰 \t\t\t( 核心白帽子 |\t\t\t        Rank:627 漏洞数:50        | -.-)\t\t \n  @redare 没重复 一个是 输入用户 后 直接返回字符串 然后厂商把那个字符串 放到了 输入随机验证码 后返回    \n     2015-04-21 14:41 |    \t\tredare \t\t\t( 实习白帽子  |\t\t\t        Rank:49 漏洞数:13        )\t\t \n  @蓝冰 确实，不好意思看错了，厂商真任性一定要返回这个值    \n     2015-04-21 14:49 |    \t\t蓝冰 \t\t\t( 核心白帽子 |\t\t\t        Rank:627 漏洞数:50        | -.-)\t\t \n  @redare :)  厂商 太任性  要是不重新设计代码的话 这个字符串一定要返回    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}