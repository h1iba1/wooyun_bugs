{"id": 12298, "wybug_id": "wooyun-2013-025226", "wybug_title": "139邮箱邮件正文存储型跨站漏洞", "wybug_corp": "139移动互联", "wybug_author": "Liuz5O69", "wybug_date": "2013-06-06 11:41", "wybug_open_date": "2013-06-11 11:41", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-11：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 139 web 邮箱对邮件内容中嵌套的div 的样式存在过滤不严问题，导致可以实施存储型跨站攻击。 详细说明：  成功触发该漏洞可以在提交的恶意DIV之上再嵌套一个DIV，并且在第一层DIV 中要满足一定数量的代码片段被过滤,例如：<DIV STYLE=\"background-image:\\0075\\0072\\006c\\0028\\006a\\0061\\0076\\0061\\0073\\0063\\0072\\0069\\0070\\0074\\003a\\0061\\006c\\0065\\0072\\0074\\0028\\0027\\0058\\0053\\0053\\005f\\0030\\0030\\0027\\0029\\0029\"><DIV STYLE=\"background-image:expression((window.r==1)?'':(window.r=1,alert('OK_xSS')));\">提交之后第一层DIV里的\"\\\"会全部被替换为空，但是第二层里的expression便不再被替换了   漏洞证明：  上述验证如图：\n\n然后下面的脚本就可以在IE中触发，如图：\n\n通过实验第一层background-image后的代码可以精简到5个字节左右，例如下面的也同样可以触发：<DIV STYLE=\"background-image:\\0075\\0072\\006c\\0028\\006a\\0061\">而直接提交恶意DIV 或第一层div 任意写则不会触发该漏洞，如图：\n\nexpression被替换为expresionx_   修复方案：  对嵌套的div层的关键字过滤需要重新设计。   版权声明：转载请注明来源 Liuz5O69@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-06-11 11:41 厂商回复：  漏洞Rank：7  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-09 11:48 |    \t\tLiuz5O69 \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:8        | 一个默默的学习者。)\t\t \n  其它如<img src=\"\" onerror 或是 onmouseenter= 都不会被过滤，其实就是第二层过滤不太严了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}