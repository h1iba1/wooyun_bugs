{"id": 33659, "wybug_id": "wooyun-2015-0109159", "wybug_title": "中通快递可遍历查询任意淘宝订单信息", "wybug_corp": "中通速递", "wybug_author": "firexp", "wybug_date": "2015-04-20 11:47", "wybug_open_date": "2015-06-04 14:58", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-04：\t细节向公众公开  简要描述： 简要描述 详细说明：  从这里从这里下载了你们的中天系统http://wangpan.baidu.com/wap/link?shareid=3085359792&uk=2772822685&third=1&dir=%2FK8%E7%B3%BB%E7%BB%9F&page=1&是C#开发的,拿出神器ILSpy反编译.看一下OrderSDK.dll的OrderRequest函数\npublic static class OrderRequest\t{\t\tpublic static string Send(string data, string url, Encoding encoding, bool isBase64, string sign, string messageType, string companyId)\t\t{\t\t\tbyte[] md5HashBytes = Encrypt.GetMd5HashBytes(data + sign, encoding);\t\t\tstring text = isBase64 ? Convert.ToBase64String(md5HashBytes) : encoding.GetString(md5HashBytes);\t\t\ttext = HttpUtility.UrlEncode(text);\t\t\tDictionary<string, string> formData = new Dictionary<string, string>\t\t\t{\t\t\t\t\t\t\t\t{\t\t\t\t\t\"data\",\t\t\t\t\tdata\t\t\t\t},\t\t\t\t\t\t\t\t{\t\t\t\t\t\"data_digest\",\t\t\t\t\ttext\t\t\t\t},\t\t\t\t\t\t\t\t{\t\t\t\t\t\"msg_type\",\t\t\t\t\tmessageType\t\t\t\t},\t\t\t\t\t\t\t\t{\t\t\t\t\t\"company_id\",\t\t\t\t\tcompanyId\t\t\t\t}\t\t\t};\t\t\treturn RequestUtility.HttpPost(url, null, formData, encoding);\t\t}\t}\ndata_digest的加密算法是base64(md5(data + sign)),data是运单编号,重要的是拿到sign.看一下调用函数处\nstring value = OrderRequest.Send(billCode[0], ZtoInterfaceUrlUtil.BillUrl, System.Text.Encoding.UTF8, true, ZtoInterfaceUrlUtil.BillInterfaceSign, MsgType.GET, \"ZHONGTIAN\", null);\nsign是一个固定值QLASI2asUMp/hhuNMS2==,接下来就好办了.看截图\n\n   漏洞证明：     修复方案：  不会啊   版权声明：转载请注明来源 firexp@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-04-20 14:56 厂商回复： 我们的客户端验证机制有缺陷，多谢白帽子同学的提醒，我们会尽快修正。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-20 11:59 |    \t\tganggang \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 这个号是来乌云聊天的....)\t\t \n  一不小心，查到隔壁少妇买的zw棒....然后...然后....然后....┗|｀O′|┛ 嗷~~    \n     2015-04-20 15:02 |    \t\tprolog \t\t\t( 普通白帽子  |\t\t\t        Rank:544 漏洞数:107        | 低调求发展)\t\t \n  @ganggang 肛肛你怎么嗷了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}