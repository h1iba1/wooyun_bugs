{"id": 45482, "wybug_id": "wooyun-2014-088099", "wybug_title": "一封邮件即可控制21cn用户邮箱今后的邮件", "wybug_corp": "21CN", "wybug_author": "路人甲", "wybug_date": "2014-12-22 00:55", "wybug_open_date": "2015-03-22 00:56", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-02-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-22：\t细节向公众公开  简要描述： 两个漏洞综合利用即可永久查看其它用户邮箱今后的邮件 详细说明：  21CN网站邮箱系统存在多个大小漏洞，成功同时利用该几个小漏洞便造成严重问题。漏洞一：对HTML代码过滤不严格，导致可插入特定HTML代码漏洞二：重要操作无TOKEN，而且不验证GET/POST请求导致CSRF攻击代码可参考测试代码   漏洞证明：  使用任意邮箱给21CN邮箱发送一封邮件\n\n用户点击该邮件即可自动创建一条邮件规则，从而劫持用户邮件。\n\n   修复方案：  漏洞一：对HTML代码进行较为严格的白名单过滤和输出编码漏洞二：重要操作需要有Token，防止CSRF攻击。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-12-26 17:13 厂商回复： CNVD确认所述漏洞情况，已经由CNVD通过以往建立的处置渠道向中国电信通报 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-22 08:10 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  mark,要验证一下.    \n     2015-02-06 16:42 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  这种攻击向量配合起来还真是有意思    \n     2015-03-22 08:08 |    \t\tZtz \t\t\t( 普通白帽子  |\t\t\t        Rank:152 漏洞数:40        | 自由职业)\t\t \n  膜拜一下    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}