{"id": 13874, "wybug_id": "wooyun-2013-018339", "wybug_title": "搜狐某应用远程Groovy代码执行！", "wybug_corp": "搜狐", "wybug_author": "shine", "wybug_date": "2013-02-04 12:58", "wybug_open_date": "2013-03-21 12:59", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["未授权访问", "内部系统对外"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-02-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-02-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-03-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-21：\t细节向公众公开  简要描述： RT（最后发个bug回家过年了，也给乌云各位拜个早年！）! 详细说明：  \nhudson管理软件，管理地址对外，而且可以匿名访问：http://220.181.26.142:8080/\n   漏洞证明：  \n好象主要是做cvs服务的：\n\n\n\n\n\n\n\n这个管理软件不太了解，找到个可以执行Groovy命令的地方（查了一下Groovy，与java代码类似）：\n\n\n执行Groovy代码，读取服务器本地/etc/passwd文件：\ntry{    text = new File(\"/etc/passwd\").getText();    out.print text} catch(Exception e){ }\n\n\n   修复方案：  刚看了一下，如果都这样的话，有压力啊！   版权声明：转载请注明来源 shine@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-02-04 15:17 厂商回复： 感谢提供 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-02-04 13:02 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  我说，别走啊～    \n     2013-02-04 13:18 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  大牛的标题 我都没有看懂    \n     2013-02-04 13:45 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @xsser 明显大家很多回家了 亲 你什么时候回家    \n     2013-02-04 14:44 |    \t\tEvilMoon \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | EM@Light4Freedom)\t\t \n  hudson？    \n     2013-02-04 15:16 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  走好    \n     2013-02-04 15:23 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  一路平安，我也准备走咯！    \n     2013-02-04 15:25 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @EvilMoon 和hudson有什么关系 ，hudson不是持续集成工具么    \n     2013-02-04 21:56 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  搜狐每次都舍得给rank啊    \n     2013-02-04 22:13 |    \t\tEvilMoon \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | EM@Light4Freedom)\t\t \n  @小胖胖要减肥 因为hudson里面就有集成groovy 我猜是hudson  信不信~    \n     2013-02-04 22:23 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @EvilMoon 你的意思hudson地址对外了？    \n     2013-02-04 22:57 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n   @xsser 难道回家过年都不准啊？ @possible 不要被标题迷惑了（不过，应该是漏洞正确的描述标题！） @EvilMoon 别猜，哥有压力，不小心发现的。厂商修复了，所以回答是：hudson ^-^ 刚搜索一下乌云，发现已经有案例了： WooYun: sohu Hudson任意命令执行漏洞 WooYun: 首家实名制相亲平台我在找你任意命令执行 WooYun: 网易一处任意命令执行和弱口令一枚  其实，结合环境变量的配置信息获得路径，然后一行Groovy代码写入jsp文件获得一个webshell就可以了！ 厂商rank是给得有点多了，我只是读取文件，又没有写入jsp文件 ！ 另外，各位都不回家过年吗？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}