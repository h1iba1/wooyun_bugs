{"id": 8185, "wybug_id": "wooyun-2013-034978", "wybug_title": "多个客户端应用dll劫持漏洞（Skype，优酷，新浪，快车，奇艺，百度音乐，Cbox）", "wybug_corp": "多个应用厂商", "wybug_author": "YY-2012", "wybug_date": "2013-08-22 19:32", "wybug_open_date": "2013-11-20 19:32", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "设计错误", "客户端程序设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-30：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-10-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-20：\t细节向公众公开  简要描述： 2013.8.22最新版本Version: 4.1.0.18响应版本4.1.0.18和4.1.0.0，其它旧版本未测试。 详细说明：  经过第三方软件测试发现SHPlayer.exe运行时会加载一个不存在的DLL文件ieframe.dll 。只要自己写一个ieframe.dll与SHPlayer.exe放在同一目录，这样就可以在运行SHPlayer.exe的时候会同时加载ieframe.dll，这个ieframe.dll可以为自制的任意恶意dll。此方法可用于劫持启动木马病毒。（我这里放入特定的dll后，运行SHPlayer.exe会弹出一个特定的框显示\"Hello from MyDLL!\"，如下图）       当时劫持时使用的DLL下载地址：密码58n6http://pan.baidu.com/share/link?shareid=172262024&uk=4164057933其他应用：Skype 2013.8.22影响最新版本Version: 6.6.4.14 其它版本没作测试。   avrt.dll优酷PC客户端 2013.8.22影响最新版本Version: 4.0.2.8051 其它版本没作测试。ieframe.dll新浪UC客户端 dwmapi.dll快车客户端 ieframe.dll爱奇艺视频桌面版 mfc90chs.dll,mfc90cht.dll和mfc90loc.dll百度音乐2013体验版 tak_deco_lib.dllCBox客户端 ieframe.dll新浪视频pc客户端 dwmapi.dll   漏洞证明：  \n\n\n\n\n\n\n\n\n\n   修复方案：  你们比我懂！！！   版权声明：转载请注明来源 YY-2012@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2013-08-27 08:32 厂商回复： CNVD经过本地实例复现，确认所述情况，同时发现了一些其他新的情况。拟在本周内分别协调涉及的软件生产厂商处置。由于需要本地攻击，评估认为发起大规模攻击的风险不算太大。根据涉及的软件种类，rank 17 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-22 21:43 |    \t\tFakehac \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:1        | 菜鸟刚来，努力挖洞洞。。。)\t\t \n  白加黑，白天吃白片，睡得香。。    \n     2013-10-08 09:57 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  漏洞证明第一张图片是什么软件啊，求介绍    \n     2013-10-08 09:58 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  @luwikes 请感谢自动介绍    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}