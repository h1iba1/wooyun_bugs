{"id": 48132, "wybug_id": "wooyun-2014-084044", "wybug_title": "比亚迪系列(一)某站点中间件配置不当导致getshell", "wybug_corp": "bydauto.com.cn", "wybug_author": "fuckadmin", "wybug_date": "2014-11-21 15:09", "wybug_open_date": "2015-01-05 15:10", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-05：\t细节向公众公开  简要描述： 某站点中间件配置不当，导致getshell 详细说明：  #1发现漏洞站点：res.byd.cn/invoker/JMXInvokerServlet 直接getshell\n\n#2福利出现但在getshell过程中发现：站点：http://res.byd.cn/jbossws13/返回：it works! Linux 2.6.18-194.el5 i386 ->||<- 很明显已有前辈进来过。查看shell密码得心中暗喜，gainover~~~~~~~~~~~~~~\n#3权限root[/usr/webshare/jboss-4.2.3.GA/server/default/./deploy/jbossws13.war/jbossws13/]$ whoamiroot/bin/sh: line 0: cd: /usr/webshare/jboss-4.2.3.GA/server/default/./deploy/jbossws13.war/jbossws13/: No such file or directory[/usr/webshare/jboss-4.2.3.GA/bin/]$ ifconfigeth0      Link encap:Ethernet  HWaddr 00:50:56:81:4D:98            inet addr:10.9.33.87  Bcast:10.9.33.255  Mask:255.255.255.0          inet6 addr: fe80::250:56ff:fe81:4d98/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:105179280 errors:0 dropped:0 overruns:0 frame:0          TX packets:16662536 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:18806834122 (17.5 GiB)  TX bytes:6839843222 (6.3 GiB)eth1      Link encap:Ethernet  HWaddr 00:50:56:81:4D:99            inet addr:183.62.214.230  Bcast:183.62.214.255  Mask:255.255.255.224          inet6 addr: fe80::250:56ff:fe81:4d99/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:260454550 errors:0 dropped:0 overruns:0 frame:0          TX packets:5887708 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:23568635535 (21.9 GiB)  TX bytes:5310527865 (4.9 GiB)lo        Link encap:Local Loopback            inet addr:127.0.0.1  Mask:255.0.0.0          inet6 addr: ::1/128 Scope:Host          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:38484 errors:0 dropped:0 overruns:0 frame:0          TX packets:38484 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:5772892 (5.5 MiB)  TX bytes:5772892 (5.5 MiB)[/usr/webshare/jboss-4.2.3.GA/bin/]$ hostnameps-EPRI-neweb[/usr/webshare/jboss-4.2.3.GA/bin/]$\n#4来点图\n\n#5数据库到手\n<local-tx-datasource>    <jndi-name>Dess_2201</jndi-name>    <connection-url>jdbc:sqlserver://10.9.37.87:1433;DatabaseName=Station_2201</connection-url>    <driver-class>com.microsoft.sqlserver.jdbc.SQLServerDriver</driver-class>    <user-name>sa</user-name>    <password>2012@dlynemc</password>\n   漏洞证明：  #1发现漏洞站点：res.byd.cn/invoker/JMXInvokerServlet 直接getshell\n\n#2福利出现但在getshell过程中发现：站点：http://res.byd.cn/jbossws13/返回：it works! Linux 2.6.18-194.el5 i386 ->||<- 很明显已有前辈进来过。查看shell密码得心中暗喜，gainover~~~~~~~~~~~~~~\n#3权限root[/usr/webshare/jboss-4.2.3.GA/server/default/./deploy/jbossws13.war/jbossws13/]$ whoamiroot/bin/sh: line 0: cd: /usr/webshare/jboss-4.2.3.GA/server/default/./deploy/jbossws13.war/jbossws13/: No such file or directory[/usr/webshare/jboss-4.2.3.GA/bin/]$ ifconfigeth0      Link encap:Ethernet  HWaddr 00:50:56:81:4D:98            inet addr:10.9.33.87  Bcast:10.9.33.255  Mask:255.255.255.0          inet6 addr: fe80::250:56ff:fe81:4d98/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:105179280 errors:0 dropped:0 overruns:0 frame:0          TX packets:16662536 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:18806834122 (17.5 GiB)  TX bytes:6839843222 (6.3 GiB)eth1      Link encap:Ethernet  HWaddr 00:50:56:81:4D:99            inet addr:183.62.214.230  Bcast:183.62.214.255  Mask:255.255.255.224          inet6 addr: fe80::250:56ff:fe81:4d99/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:260454550 errors:0 dropped:0 overruns:0 frame:0          TX packets:5887708 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:23568635535 (21.9 GiB)  TX bytes:5310527865 (4.9 GiB)lo        Link encap:Local Loopback            inet addr:127.0.0.1  Mask:255.0.0.0          inet6 addr: ::1/128 Scope:Host          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:38484 errors:0 dropped:0 overruns:0 frame:0          TX packets:38484 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:5772892 (5.5 MiB)  TX bytes:5772892 (5.5 MiB)[/usr/webshare/jboss-4.2.3.GA/bin/]$ hostnameps-EPRI-neweb[/usr/webshare/jboss-4.2.3.GA/bin/]$\n#4来点图\n\n#5数据库到手\n<local-tx-datasource>    <jndi-name>Dess_2201</jndi-name>    <connection-url>jdbc:sqlserver://10.9.37.87:1433;DatabaseName=Station_2201</connection-url>    <driver-class>com.microsoft.sqlserver.jdbc.SQLServerDriver</driver-class>    <user-name>sa</user-name>    <password>2012@dlynemc</password>\n   修复方案：  喜欢BYD汽车，相信你们更专业.   版权声明：转载请注明来源 fuckadmin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-11-24 16:31 厂商回复： 已确认问题，在整改中。感谢支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-10 21:31 |    \t\t胡小树 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:11        | 我是一颗小小树)\t\t \n  站点：res.byd.cn/invoker/JMXInvokerServlet 直接getshell  ，利用什么漏洞的啊，远程命令执行？ CVE-2013-4810  这个？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}