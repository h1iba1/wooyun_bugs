{"id": 84264, "wybug_id": "wooyun-2015-0145344", "wybug_title": "中国物品编码中心绕过WAF注入涉及商家信息", "wybug_corp": "中国物品编码中心", "wybug_author": "Down", "wybug_date": "2015-10-08 15:19", "wybug_open_date": "2015-11-26 16:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-26：\t细节向公众公开  简要描述： 听说网站带了中国两个字就很高大上呢！ 详细说明：  搜索地方加个单引号，出现500错误\n\n上看到aspx差不多就是sqlserver了，上and和--试试\n\n居然被waf拦下了，当时一慌张，上%00试试\n\nOK，拿下，不过并不是显错注入，没关系我们上另外的注入点，收集下信息，尝试单双引号\n\n\n\n居然是insert，没办法，上个分号执行多行试试\n\n不是sa，估计也不是dba，之后发现只要出现sysobjects就会被WAF ban下，查不出表怎么办，慌了下打了个member居然没报错\n\nOK，接下来爆字段喽\n\n接下来在之前的搜索框联合查询就好了\n\n   漏洞证明：  登陆之后发现用户量居然有60W之多，有WAF所以不容易getshell，后台和查询所有用户的敏感信息\n\n\n\nhttp://**.**.**.**   修复方案：  给表加个前缀不好嘛，WAF用个高级点的不好嘛。不要显错不好嘛。你们应该比我懂。。。   版权声明：转载请注明来源 Down@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-10-12 16:38 厂商回复：     CNVD确认并复现所述情况,已经转由CNCERT尝试向其上级主管部门通报,由其后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}