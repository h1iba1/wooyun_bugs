{"id": 6398, "wybug_id": "wooyun-2013-045786", "wybug_title": "万达集团万汇网（电商平台）SQL注射漏洞", "wybug_corp": "大连万达集团股份有限公司", "wybug_author": "0x334", "wybug_date": "2013-12-13 11:05", "wybug_open_date": "2014-01-27 11:05", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-27：\t细节向公众公开  简要描述： 万达集团万汇网SQL注射漏洞，可导致信息泄露、网站被入侵等。地产开始搞电商，记住安全很重要啊。 详细说明：  万达集团万汇网SQL注射漏洞，可导致信息泄露、网站被入侵等http://game.wanhui.cn/game_view.php?game_id=3./sqlmap.py  -u \"http://game.wanhui.cn/game_view.php?game_id=3\" --user-agent \"Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 5.2; Trident/4.0; .NET CLR 1.1.4322; .NET CLR 2.0.50727; .NET CLR 3.0.04506.648; .NET CLR 3.5.21022; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)\" --dbs\n\n\n\n   漏洞证明：  如上   修复方案：  1.\t所有的查询语句都使用数据库提供的参数化查询接口，参数化的语句使用参数而不是将用户输入变量嵌入到SQL语句中。当前几乎所有的数据库系统都提供了参数化SQL语句执行接口，使用此接口可以非常有效的防止SQL注入攻击。2.\t对进入数据库的特殊字符（'\"\\尖括号&*;等）进行转义处理，或编码转换。3.\t严格限制变量类型，比如整型变量就采用intval()函数过滤，数据库中的存储字段必须对应为int型。4.\t数据长度应该严格规定，能在一定程度上防止比较长的SQL注入语句无法正确执行。5.\t网站每个数据层的编码统一，建议全部使用UTF-8编码，上下层编码不一致有可能导致一些过滤模型被绕过。6.\t严格限制网站用户的数据库的操作权限，给此用户提供仅仅能够满足其工作的权限，从而最大限度的减少注入攻击对数据库的危害。7.\t避免网站显示SQL错误信息，比如类型错误、字段不匹配等，防止攻击者利用这些错误信息进行一些判断。8.\t在网站发布之前建议使用一些专业的SQL注入检测工具进行检测，及时修补这些SQL注入漏洞。   版权声明：转载请注明来源 0x334@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2013-12-13 11:06 厂商回复： 感谢0x334同学的关注与贡献！通知业务部门立即整改！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}