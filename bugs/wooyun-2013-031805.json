{"id": 9918, "wybug_id": "wooyun-2013-031805", "wybug_title": "sohu一个比较隐秘的命令执行漏洞（直接影响内网）", "wybug_corp": "搜狐", "wybug_author": "梧桐雨", "wybug_date": "2013-07-22 16:01", "wybug_open_date": "2013-09-05 16:02", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程命令执行", "远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-05：\t细节向公众公开  简要描述： 命令执行没什么好说的了。。但这个比较特殊 详细说明：  很多人都以为只有action,或者do才有命令执行，实际上并非如此。很多时候，网页后缀都是可以自定义的。哪怕是后缀是html一样会有命令执行，url的规则并不能真正的把这个执行命令的漏洞隐藏起来，或许只能拦截一部分脚本小子。问题出现在:http://220.181.61.111/index 是之前连载的时候发现并且记录下来的。当时没发现什么问题。但这回顺着st2的爆发，结果这个站点也一并遭殃了。虽然不是action或者do后缀，但，这不也是一样存在命令执行的吗？\n\n之前通过网段判断，这回能执行命令了，直接就能确定是sohu的站点\n\n同样的，存在内网，一样是可以拿来当内网渗透的。\n\n没继续深入了，wget的马也删除了。你们尽快打补丁吧！顺便求个sohu抱枕啊！   漏洞证明：  \n\n\n\n\n\n都在图上了。。不多说   修复方案：  官方更清楚啦。   版权声明：转载请注明来源 梧桐雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-07-22 17:09 厂商回复： 感谢支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-22 16:13 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2013-07-22 16:16 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  应该是Struts吧，都快一周了还没补全？其实感觉Struts的另个恶心的地方就是如果你网站的架构设计失误，可能导致直接接触内部网络 ：（    \n     2013-07-22 16:18 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @疯狗 还有个恶心地方是要提防开发回滚    \n     2013-07-22 16:23 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @xsser 又提醒我了，还还有个恶心的地方就是，如果通过waf类产品暂时阻挡而实质上没有修复的话，在出现一些绕过问题，比如旧版struts漏洞的unicode绕过，开发又要难忘今宵了    \n     2013-07-22 16:24 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @疯狗 总之是比较苦逼的事情了 愿天堂没有struts    \n     2013-07-22 16:50 |    \t\t有妹子送上 \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:28        | 杭州最帅的男人)\t\t \n  虽然不知道楼上面在说什么，但是看起来好像很厉害的样子。    \n     2013-07-22 17:55 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  虽然不知道楼上面在说什么，但是看起来好像很厉害的样子。    \n     2013-07-22 19:25 |    \t\t大白菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:19        )\t\t \n  - -第二次这么激动了    \n     2013-09-06 09:15 |    \t\t我勒个去 \t\t\t( 实习白帽子  |\t\t\t        Rank:98 漏洞数:8        | 我勒个去)\t\t \n  我比较好奇，楼主为什么想起来拿struts工具试这个    \n     2013-09-06 10:35 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @我勒个去 菜鸟是不能理解高手的思路的    \n     2013-09-06 10:48 |    \t\t我勒个去 \t\t\t( 实习白帽子  |\t\t\t        Rank:98 漏洞数:8        | 我勒个去)\t\t \n  @xsser 咱的问题，我理解比其他人的提问更有意义吧，嘿嘿    \n     2013-09-06 10:49 |    \t\t我勒个去 \t\t\t( 实习白帽子  |\t\t\t        Rank:98 漏洞数:8        | 我勒个去)\t\t \n  @我勒个去 没营养的更贴回贴，活跃社区需要，但是对技术氛围不利，啥都在娱乐化了    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}