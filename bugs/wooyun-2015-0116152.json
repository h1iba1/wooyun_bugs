{"id": 281, "wybug_id": "wooyun-2015-0116152", "wybug_title": "致远A8协同管理软件v3.2以上版本存在后门口令", "wybug_corp": "seeyon.com", "wybug_author": "守望", "wybug_date": "2015-05-25 19:14", "wybug_open_date": "2015-08-28 19:17", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-30：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-07-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-28：\t细节向公众公开  简要描述： 管理界面存在后门口令，导致之前的日志安全策略全部失效。网站信息泄露，用户session泄露。 详细说明：  I-回顾    先参看一下之前爆出的几个漏洞：    (1).致远A8-V5协同管理软件日志信息泄露(通杀V5)     \n WooYun: 致远A8-V5协同管理软件日志信息泄露(通杀V5) \n    (2).致远A8协同管理系统\"后门\"一样的Log泄露JSESSIONID可登陆用户\n WooYun: 致远A8协同管理系统\"后门\"一样的Log泄露JSESSIONID可登陆用户 \n    (3).上传getshell等等II-漏洞原因    回顾的意义在于看一看以前问题的点，官方对/seeyon/management/status.jsp 和/logs/下的日志访问处理是，在/managenment/index.jsp这个文件中加入了密码验证处理,未授权访问management文件夹下内容时会跳转到首页，访问logs文件夹内容时会报异常。那么这个index.jsp中的密码验证是如何进行的呢？上图。    index.jsp:\n<%InfoOpenManager infoOpenManager = (InfoOpenManager)ApplicationContextHolder.getBean(\"infoOpenManager\");if(infoOpenManager.isAccess(request.getRemoteAddr(),request.getParameter(\"password\")){\tsession.setAttribute(\"GoodLuckA8\", Boolean.TRUE);\tString serverInfo = getServletContext().getServerInfo();\tif (serverInfo != null && serverInfo.contains(\"WebSphere\")) {\t\tresponse.sendRedirect(\"status4WAS.jsp\");\t}\telse{\t\tresponse.sendRedirect(\"status.jsp\");\t}}%>\n    由infoOpenManager.isAccess()进行验证.反编译相关class文件，infoOpenManager.isAccess()的实现：\npublic boolean isAccess(String remoteAddress, String password)  {    if ((password == null) || (remoteAddress == null)) {      return false;    }    if ((\"127.0.0.1\".equals(remoteAddress)) || (\"localhost\".equalsIgnoreCase(remoteAddress)) || (\"WLCCYBD@SEEYON\".equals(password))) {      return true;    }    InfoOpen infoOpen = get();        return (infoOpen.isEnabled()) && (Strings.isNotBlank(infoOpen.getEndTime())) && (Datetimes.parseDatetimeWithoutSecond(infoOpen.getEndTime()).after(new Date())) && (password.equals(TextEncoder.decode(infoOpen.getPassword())));  }\n     if...不用多说了吧，幸亏remoteAddress是用request.getRemoteAddr()来取的。iii-效果    随便找一个(其实也不是随便)看看效果——南京交通集团。    (1).试图进行未授权访问/seeyon/management/status.jsp时，302到index.jsp。\n\n    (2).尝试访问/logs/login.log时，报异常。\n\n    (3).利用后门口令登陆后\n\n    信息泄露：\n\n    系统操作及异常日志：\n\n    用户登录日志：\n\n    登陆效果：\n\n    getshell跟本漏洞无关，所以不继续跟进，但并不表明这个漏洞的危害小。III-影响版本及范围    v3.2以上、fofa   漏洞证明：  见详细说明栏。   修复方案：  。   版权声明：转载请注明来源 守望@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-08-28 19:17 厂商回复：  漏洞Rank：8  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-25 19:26 |    \t\tPgHook \t\t\t( 普通白帽子  |\t\t\t        Rank:964 漏洞数:115        | ...........................................)\t\t \n  牛逼    \n     2015-05-26 20:55 |    \t\t白非白 \t\t\t( 普通白帽子  |\t\t\t        Rank:447 漏洞数:60        | ♫ Freedom - Anthony Hamilton ♫)\t\t \n  diao~    \n     2015-08-27 20:03 |    \t\t动感超人 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:10        | 小心动感光波)\t\t \n  但是最后那个MD5不是登陆密码吧，，那是什么啊？    \n     2015-08-28 20:18 |    \t\t东方不败 \t\t\t( 普通白帽子  |\t\t\t        Rank:440 漏洞数:66        | 日出东方，唯我不败。)\t\t \n  最后一个是什么加密啊。。不是MD5啊    \n     2015-08-28 21:13 |    \t\t金枪银矛小霸王 \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:25        | 不会挖洞洞的猿猿不是好学生)\t\t \n  @动感超人 @东方不败 最后一个是类似于cookie的东西    \n     2015-08-30 12:13 |    \t\t东方不败 \t\t\t( 普通白帽子  |\t\t\t        Rank:440 漏洞数:66        | 日出东方，唯我不败。)\t\t \n  @金枪银矛小霸王 恩 是JSESSIONID，没仔细看- - 多谢    \n     2015-09-12 00:56 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @守望 求教怎么getshell？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}