{"id": 9297, "wybug_id": "wooyun-2013-034484", "wybug_title": "好愿网多处root权限SQL注射秒读数据", "wybug_corp": "joinwish.com", "wybug_author": "小胖子", "wybug_date": "2013-08-16 10:56", "wybug_open_date": "2013-09-30 10:57", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数字类型注射", "数据库账户权限过高", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-30：\t细节向公众公开  简要描述： 听说好愿网很爱发礼物，所以我就来了。 详细说明：  全站基本做了伪静态，但是仔细翻还是能翻到有动态参数的地方。注入点：\nGET /wishservice/sponsors?uid=1&wid=10067221&sval=id HTTP/1.1Referer: http://www.joinwish.com/wish/show/id/10067221Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; .NET CLR 1.1.4322; Netsparker)Cache-Control: no-cacheAccept-Language: en-us,en;q=0.5Host: www.joinwish.comCookie: PHPSESSID=1km4sivvelstuqmolpqjspjq62Accept-Encoding: gzip, deflate\n注入参数uid，DBA权限，time based，读数据秒读。\n\n还有很多其他地方也存在注射，参数不同，请都一并自查并修复。\n\n有注射的地方以及参数。\n\n数据库还是蛮多的。\n\nover。   漏洞证明：  数据库：\navailable databases [9]:[*] huluwu[*] huluwu_dev[*] information_schema[*] joinwish_product[*] joinwish_verify[*] logs[*] mysql[*] performance_schema[*] test\n当前数据库joinwish_product的数据表。\nDatabase: joinwish_product[132 tables]+------------------------------+| account_freeze_tx            || account_topups               || account_transfers            || account_tx                   || account_withdraws            || accounts                     || alipay_transfer              || alipay_transfer_batch        || areas                        || auth_group                   || auth_group_permissions       || auth_permission              || auth_user                    || auth_user_groups             || auth_user_user_permissions   || backend_tx                   || backends                     || bank_cities                  || bank_provinces               || barcode_types                || biz_card_bindings            || brands                       || c2c_topup_requests           || card_items                   || cities                       || cs_logs                      || cs_roles                     || cs_user_functions            || cs_user_role_functions       || cs_user_roles                || cs_users                     || django_admin_log             || django_content_type          || django_session               || django_site                  || errors                       || exchanges_users              || favorite_wishes              || gateway_audit                || gateway_audit_result         || gateway_order                || give_user_brand              || hulu_card_no_libs            || invitees                     || merchants                    || mptopup_orders               || offline_transfers            || p2p_catalogs                 || p2p_comment                  || p2p_commodities              || p2p_exchange_0               || p2p_exchange_1               || p2p_merchant                 || p2p_order                    || p2p_send_transaction         || p2p_send_withdraw            || p2p_settlement_payment_batch || p2p_ticket                   || p2p_ticket_batch             || payment_card_logs            || payment_channels             || payment_orders               || properties                   || provinces                    || public_utility_orders        || refunded_transactions        || settlement                   || settlement_detail            || shopping_items               || shopping_orders              || terminal_requests            || transaction_details          || transactions                 || tx_types                     || user_addresses               || user_backends                || user_friends                 || user_mp_verify_codes         || user_reg_requests            || user_saved_cards             || user_sessions                || user_uploaded_pic_catalogs   || user_uploaded_pics           || user_wish_statistics         || users                        || weibo_template               || wish_albums                  || wish_amount_increase_logs    || wish_award_logs              || wish_base                    || wish_cash_coupons            || wish_comments                || wish_commodities             || wish_cs_roles                || wish_cs_user_functions       || wish_cs_user_role_functions  || wish_cs_user_roles           || wish_cs_users                || wish_details                 || wish_exchange_items          || wish_exchange_tocheck_users  || wish_exchange_view           || wish_exchanges               || wish_fans                    || wish_gifts                   || wish_give_logs               || wish_give_tx                 || wish_guest_infos             || wish_hp_use_logs             || wish_join_requests           || wish_members                 || wish_mer_exchange            || wish_merchants               || wish_msgs                    || wish_pdts                    || wish_praise_statistical      || wish_prop_logs               || wish_pub_logs                || wish_solutions               || wish_themes                  || wish_transfers               || wish_user_banding            || wish_user_guides             || wish_user_notification       || wish_user_verification       || wish_users                   || wish_visit_logs              || wishes                       || withdraw_fee_rate            || ym_sms                       || ym_sms_mo                    || ym_sms_mt                    |+------------------------------+\n   修复方案：  0x1：预编译，过滤，等等方式。0x2：数据库权限太高了。0x3：我是厚着脸皮要礼物的。   版权声明：转载请注明来源 小胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-08-19 14:44 厂商回复： 已修复，今天统一发布 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-16 11:25 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2013-08-20 10:17 |    \t\t好愿网(乌云厂商)\t\t \n  您的手机号码非支付宝账号，请私信回复您的支付宝账号    \n     2013-09-30 15:33 |    \t\tchoit \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 你懂的)\t\t \n  @好愿网 还给rmb呀！！！！！    \n     2013-10-03 00:37 |    \t\txx123 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 雷锋)\t\t \n  @小胖子    大神，你那截图是什么扫描器啊。求神器。。    \n     2013-10-03 09:21 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @xx123 awvs9    \n     2013-10-03 11:56 |    \t\txx123 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 雷锋)\t\t \n  @小胖子 搜噶。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}