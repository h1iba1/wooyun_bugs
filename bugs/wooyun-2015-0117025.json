{"id": 28937, "wybug_id": "wooyun-2015-0117025", "wybug_title": "中国银行网银业务系统任意文件包含漏洞（文件遍历、任意文件读取）", "wybug_corp": "中国银行", "wybug_author": "Drizzle.Risk", "wybug_date": "2015-05-29 20:14", "wybug_open_date": "2015-06-16 13:42", "wybug_type": "文件包含", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "\t\t\t\t\t\t\t\t已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-16：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 还是承接之前发的科蓝的通用漏洞，这次是新玩法。服务器文件遍历、任意文件读取、数据库配置文件、服务器配置文件、.class文件,当然还有war！balabala...另，真的是网银系统 :-)  详细说明：  网银系统入口地址（看起来是澳门分行的网银系统入口）：https://its.bocmacau.com/prelogin.do?_locale=zh_CN&BankId=9999&LoginType=R\n\n找到一个合适的链接：\n\n还是利用_viewReferer这个参数强制覆写。然后新利用方法，把POST转为GET，用%00截断：\n\n接下来就是各种配置文件、class文件、war等：\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n注：因为未经授权，故我只是简单的看了下，并未产生任何真实攻击行为。   漏洞证明：  详细漏洞说明。重放上面的数据包即可复现漏洞。   修复方案：  尽快修复程序问题。另建议可通过文件和目录权限控制、或通过防护设备规则，来进行临时的补救。   版权声明：转载请注明来源 Drizzle.Risk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2015-05-30 10:53 厂商回复： 感谢作者的发现，我们已进行了修复。 最新状态： 2015-06-16：已修复  ", "replys": "漏洞评价：\n评论\n     2015-05-29 20:15 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  为啥给cert啊？不是有厂商么    \n     2015-05-29 20:28 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  厂商也可以看到，cert属于监管部门    \n     2015-05-29 20:30 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  @浩天 哦了 Thx 应该把CBRC拉入伙..    \n     2015-05-29 20:30 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @Drizzle.Risk 嗯金融银行类的对社会影响比较大，需要cert帮忙处理，这个影响不是一家企业的事儿，需要监管：）    \n     2015-05-29 20:43 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  @疯狗 现在想得闪电很难了啊，我记得原来比较松。我之前以为这个通用漏洞应该可以挂个闪呢 ：）    \n     2015-05-29 20:48 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  @Drizzle.Risk 等这几个漏洞厂商回复，没准可以闪一下    \n     2015-05-29 21:09 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  @浩天 这些算重复漏洞吗    \n     2015-05-31 12:28 |    \t\tqwerty \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:16        | 已注销)\t\t \n  确认了    \n     2015-06-03 13:50 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  @Drizzle.Risk 科蓝的已经在跟进了，还有不少在测试。    \n     2015-06-05 21:25 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  @Drizzle.Risk 影响较大 故通过CNCERT    \n     2015-06-16 14:13 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:54        | 潜心代码审计。)\t\t \n  思路猥琐啊    \n     2015-06-16 16:50 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  坐等黄易、渣浪、企鹅等无良小编    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}