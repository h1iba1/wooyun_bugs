{"id": 72141, "wybug_id": "wooyun-2015-0151989", "wybug_title": "极客学院某站存储XSS到主站后台(影响主站170+W用户数据)", "wybug_corp": "jikexueyuan.com", "wybug_author": "c26", "wybug_date": "2015-11-05 11:41", "wybug_open_date": "2015-12-20 12:42", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-20：\t细节向公众公开  简要描述： 某站存储XSS数据库影响主站数据 详细说明：  \nxsshttp://jiuye.jikexueyuan.com/assistant/apply\n\n\n\n\n\n\n\n\n\n后台找到一处盲注\n\nGET /admin.php/system/updateadmin.html?id=136252 HTTP/1.1Host: jiuye.jikexueyuan.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:41.0) Gecko/20100101 Firefox/41.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateCookie: Hm_lvt_f3c68d41bda15331608595c98e9c3915=1446626399; _ga=GA1.2.708734741.1441338219; stat_uuid=1441338222756488985253; PHPSESSID=iv8cm88mvc6tchthcdnivjs7v5; QINGCLOUDELB=2377a0539de61b7d01052585200c71bcd562b81daa2a899c46d3a1e304c7eb2b|Vjq/D|Vjq+h; Hm_lvt_c808ddaeb87f11e7e72f550be53a59cf=1446690442; Hm_lpvt_c808ddaeb87f11e7e72f550be53a59cf=1446690442; _gat=1; MECHAT_LVTime=1446690444714X-Forwarded-For: 8.8.8.8'Connection: keep-aliveCache-Control: max-age=0\n\n\n看到jkxy_v4感觉和主站有点关系，随手敲个admin.jikexueyuan.com就找到了(╯‵□′)╯︵┻━┻使用的是ThinkPHP框架，并且开了Debug模式\nhttp://admin.jikexueyuan.com/Public/login\n\n\n可以看到是管理表是think_admin表我就直接跑jkxy_v4的表了然后发现了think_admin了，吃惊\n\n然后--sql-shell吧数据查出来了 发现是MD5加密，不过有的不对 估计这是之前的管理表，但是还是有办法的 发现123456的MD5 有几个弱口令的还是可以登录的进去\n\n\n[*] 86, liudongyi, e10adc3949ba59abbe56e057f20f883eliudongyi:123456后台可以加会员可以禁言重置密码功能很多\n\n\n找了个用户查了一下 用户表\n\n看一下用户数量 170+W\n\n   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  过滤输入数据库用户权限的分配拒绝弱口令求个礼物   版权声明：转载请注明来源 c26@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-11-05 12:41 厂商回复： 非常感谢~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-11-05 11:46 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:709 漏洞数:141        | 收WB~~1：7手续费协商，个位数到三位数量都...)\t\t \n  我可是好几年的会员啊。表哥留情    \n     2015-11-05 11:57 |    \t\t尊-折戟 \t\t\t( 实习白帽子  |\t\t\t        Rank:72 漏洞数:18        | 与时俱进！=忘本)\t\t \n  大神，不是最近有领免费VIP吗?    \n     2015-11-05 12:10 |    \t\ther0ma \t\t\t( 普通白帽子  |\t\t\t        Rank:641 漏洞数:92        | 专注小厂商三十年！)\t\t \n  后台是有导出数据的功能吗？还是有批量修改用户各种数据的功能？不然咋能影响170W+的用户数据？？？    \n     2015-11-05 12:37 |    \t\t咖啡 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:20        )\t\t \n  @her0ma 。。。。。。。     \n     2015-11-05 12:42 |    \t\tSubmit \t\t\t( 普通白帽子  |\t\t\t        Rank:504 漏洞数:111        | 下一个会是我吗？)\t\t \n  极客学院的粉丝    \n     2015-11-05 14:38 |    \t\tSecurity \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:12        )\t\t \n  @her0ma 标题非常重要！！！！！！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}