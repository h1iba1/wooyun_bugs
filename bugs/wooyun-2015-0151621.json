{"id": 72204, "wybug_id": "wooyun-2015-0151621", "wybug_title": "联通某APP导致密码重置问题可批量", "wybug_corp": "中国联通", "wybug_author": "大亮", "wybug_date": "2015-11-03 23:30", "wybug_open_date": "2015-12-21 16:00", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-21：\t细节向公众公开  简要描述： 我的女朋友是标准的白富美，每次我带我女朋友出门逛街总是吸引很多人的目光，有一次我和我女朋友去吃火锅，火锅店的服务员过来送底料一直盯着我女朋友看，我心里暗爽这小子心里肯定满满的羡慕嫉妒恨啊，然后他转头对我说：先生麻烦您能把它挪一下吗别烫漏气了！ 详细说明：  1.联通沃宽的app，在这里吐槽一下北京联通的宽带网速十分不稳定。首先，打开app，点击登录，进入登录页面之后，点忘记密码\n\n2.填写手机号，如果手机号不存在，点击下一步，提示用户名不存在，如果存在，可以通过\n\n\n\n3.此时查看burp中截取的请求，发现如果存在返回1，不存在返回2，温馨提示，手机电脑同一局域网内，设置手机代理为电脑Ip，burp相同设置，可截取手机请求。\n\n然后是重置密码过程，我认为此漏洞可以当作重置密码的经典案例来讲了。1.随便选择一个通过的号码，然后发送请求，通过burp请求响应可知此操作返回的是页面数据，而不是调用api，返回的json格式数据，那么我们可以在浏览器中模拟app请求。\n\n重置方法1，修改接收号码。在请求中重置密码的手机号修改为自己手机号，接收到验证码信息，填入，可以重置成功。\n\n\n\n重置方法2：暴力破解法。此验证码为6位数字验证码，通过暴力破解，是可以成功破解出正确的验证码的，正确返回1，不正确返回2，具体可以查看我以前发布的漏洞\n\n重置方法3：修改响应值。上面已经说过，正确返回1，错误返回2，将错误的返回值改为1，页面也可以跳转到重置密码页面\n\n\n\n\n\n重置方法4：越权修改法。可以重置自己的密码，当到最后一步，发送请求中存在手机号，将此手机号修改为别人的手机号，也可以将别人密码重置成功。\n\n   漏洞证明：   134011604781234asdf\n\n为了证明此问题的严重性，据我所知，北京联通装宽带，可能都会要求安装此app，可以用来加速，那么究竟能重置多少用户呢，本屌在手机通讯录中随便选了3个北京联系人，固定前8为数字，暴力破后4为数字，看能有多少人，随便3个就不少用户啊。几乎随便爆破一下都有。\n\n\n\n\n\n联通20rank吧   修复方案：  重新设计吧   版权声明：转载请注明来源 大亮@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-11-06 15:58 厂商回复： CNVD确认所述情况,已经转由CNCERT向中国联通集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}