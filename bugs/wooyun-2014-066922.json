{"id": 53645, "wybug_id": "wooyun-2014-066922", "wybug_title": "CmsEasy最新 V5.5-UTF8 正式版暴力注入", "wybug_corp": "cmseasy", "wybug_author": "HackBraid", "wybug_date": "2014-07-02 10:44", "wybug_open_date": "2014-09-30 10:48", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核", "任意文件写入利用", "写"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-07：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-30：\t细节向公众公开  简要描述： 官网下载最新版为20140605注入+后台getshell 详细说明：  cmseasy最新版后台无验证码，导致管理员账户可被暴力破解：1.cmseasy后台无验证码导致可暴力破解管理员密码登陆后台；2.后台模板编辑html文件，发现html里可执行php代码，利用php的写文件函数写shell。   漏洞证明：  \n0x01:爆破登陆后台\n1.后台点击登陆后抓包：\n\n2.burp爆破，通过回显得知管理员密码：\n\n3.成功登陆后台：\n\n\n0x02:后台模板编辑getshell\n后台模板编辑处，我们先看left.html，点击编辑后发现是一堆<?php ?>代码。那我添加写文件的代码不就getshell了么！\n\n需要执行上面代码，那点击这个链接：http://localhost/cmseasy/index.php?case=archive&act=show&aid=9（加载left.html）shell:\n\n\n0x03:另外几处可getshell的地方\n经测试除了left.html外，footer.html和position.html均存在同样的漏洞，可直接写php脚本。   修复方案：  后台加个验证码防止爆破；写shell的那个我也不清楚，你们要是有解决方案也请感谢告知，3ks！   版权声明：转载请注明来源 HackBraid@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-07-04 08:56 厂商回复： 感谢，立即修正 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}