{"id": 21240, "wybug_id": "wooyun-2012-05031", "wybug_title": "TP LINK无线路由器后台使用不安全的密码框", "wybug_corp": "深圳普联TP-LINK", "wybug_author": "TASS_傅奎", "wybug_date": "2012-03-06 17:17", "wybug_open_date": "2012-03-06 17:17", "wybug_type": "设计不当", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-03-06：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-03-06：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： TP LINK W89741N无线路由器，后台各种密码框以星号显示当前系统中存储的密码，但实际通过查看网页源代码可以读取密码明文信息！个别密码框，完全明文显示。虽然这只是一款家用路由器，但是相信很多中小企业都在使用。如果因为某种原因导致此类敏感信息泄露，可能会对用户系统造成安全隐患。 详细说明：  软件版本：1.0.3 Build 110119 Rel.42432s 硬件版本：W89741N v1 00000000泄露信息：宽带上网账号和密码、无线SSID连接密码、动态域名服务器（如花生壳）账号和密码等……\n<input name=\"pwd\" class=\"text\" onfocus=\"doFocus();\" type=\"password\" size=\"20\" maxLength=\"63\" value=\"this is password !\"/>\n   漏洞证明：  网页源代码包含宽带账号和密码：\n\n无线SSID连接密码明文显示：\n\n网页源代码包含花生壳服务器账号密码信息：\n\n   修复方案：  虽然input可以设置password类型，但是在返回给用户数据时不应将当前数据写入value中，建议直接使用六个星号：******。\n<input name=\"pwd\" class=\"text\" onfocus=\"doFocus();\" type=\"password\" size=\"20\" maxLength=\"63\" value=\"******\"/>\n   版权声明：转载请注明来源 TASS_傅奎@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-03-06 17:41 |    \t\tJian(64bit) \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:15        | 世界上有10种人,懂二进制的和不懂的.)\t\t \n  请问不进路由器如何看到源代码？    \n     2012-03-06 18:15 |    \t\triusksk \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:8        )\t\t \n  坑爹到处有，乌云特别多！    \n     2012-03-06 18:29 |    \t\tSmallay \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 空)\t\t \n  @Jian 如果路由器配置页面本身没加密码或弱密码（如默认是admin之类）的话，直接访问配置页面即可找到源代码，甚至即使设置了无线SSID密码的情况下，只要有线连接进去也可以直接访问    \n     2012-03-06 20:47 |    \t\tJian(64bit) \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:15        | 世界上有10种人,懂二进制的和不懂的.)\t\t \n  @Smallay 既然连进去了何必这么麻烦 看什么密码呢 直接星号密码查看器不就解决了么？没有任何意义    \n     2012-03-06 20:58 |    \t\tTASS_傅奎 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:5        | Leander)\t\t \n  谢谢@Jian的关注！事实上无需密码直接进入路由器或者下载路由器配置文件的情况常常发生;国内家庭路由器中存在风险漏洞的情况还不少。 欢迎交流！    \n     2012-03-06 21:50 |    \t\tdoosit \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:4        | 木有介绍。)\t\t \n  @TASS_傅奎  说话一般的星号查看器，要查看网页的，藐视只支持windows IE ？    \n     2012-03-06 23:25 |    \t\tJian(64bit) \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:15        | 世界上有10种人,懂二进制的和不懂的.)\t\t \n  @TASS_傅奎 哈哈 就是交流 大部分都存在风险 应为bt5可以暴力破解还有弱口令    \n     2012-03-07 00:05 |    \t\tTASS_傅奎 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:5        | Leander)\t\t \n  @doosit 对于网页中的星号密码，可以通过以下步骤查看：IE8+、Firefox(Firebug+)、Chromium页面浏览状态，通过快捷键F12呼出开发人员工具，使用元素捕获器就可以迅速找到你要的。    \n     2012-03-07 02:23 |    \t\t北洋贱队 \t\t\t( 普通白帽子  |\t\t\t        Rank:252 漏洞数:25        )\t\t \n  真坑爹    能进去还说  ssh或者telnet都是默认口令   进去直接查看任何想得到的密码    \n     2012-03-07 09:35 |    \t\tSmallay \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 空)\t\t \n  @Jian(64bit) 问题就在这里啊，不管星号密码查看器，还是看源代码，查看的都是网页中保存的密码内容，本质上是一样的。漏洞作者说要把密码框的内容改为*字符，这样不就连查看器也看不了了吗？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}