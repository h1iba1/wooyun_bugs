{"id": 45108, "wybug_id": "wooyun-2015-097371", "wybug_title": "掌阅ireader手机APP存在设计缺陷可使用任意他人账户消费", "wybug_corp": "zhangyue.com", "wybug_author": "MelodyZX", "wybug_date": "2015-02-16 10:20", "wybug_open_date": "2015-04-02 10:22", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["支付设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向公众公开  简要描述： RT 详细说明：  问题是由于服务器在部分功能中对用户ID以及登录ID验证的关联认证不够完善所导致的。在用户个人信息中，其抓取的URL格式如下\nhttp://ah2.zhangyue.com/zybook/u/p/user.php?key=1U1&usr=iXXXX7591&rgt=7&p1=150213162338630022&pc=10&p2=108695&p3=770003&p4=501603&p5=19&p6=&p7=JJAAAFFFJJGIEH&p9=2&p12=&p16=Coolpad+V1-C&p21=3&p22=4.4.4&zysid=d295ceb19323e12b7bb4c8b0760620c0&zysign=R0mUI23JFammzJpCL3noDVYCh6eetuq2VVm%2BMJODSDzNu1O9hrdC70saZ9%2FD%2BBnuI4R2ALb32BRucuRx0YcgKQ%3D%3D\n其中usr字段表示的用户的掌阅帐号，APP端和抓包的结果如下。\n\n\n\n遍历url，可以获得用户的阅币情况（可用来购买付费书籍），结果如下（只选取了1000的样本）\n\n这样，就完成了前期对用户情况的收集，用于后续的支付环节。在选取某一付费书籍以后，点击购买，会弹出如下结果。\n\n抓包的结果如下\n\n发现usr的字段同样是可以操控的，改帐号iXXXX7905，其支付界面的显示结果如下\n\n因此在该处可以利用他人的帐号支付购买付费书籍。   漏洞证明：  新申请帐号为：4921     余额 0/11\n\n扫描获得帐号：7905 当前购买数量：4，余额3222/42\n\n购买书籍支付结果对比：\n\n\n\n7905的帐号剩余     3133/0；购买书籍数量变为5\n\n后续测试中虽然跨帐号下载书籍会提示错误，但是他人帐号里的费用是确确实实被扣了PS:BURP抓包时好像不太稳定~   修复方案：  加强认证措施吧   版权声明：转载请注明来源 MelodyZX@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-02-28 15:42 厂商回复： 非常感谢@MelodyZX 对掌阅安全的关注，已通知研发部门尽快修复。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}