{"id": 27292, "wybug_id": "wooyun-2015-0102085", "wybug_title": "第三方某售票系统通用型二十处越权漏洞泄露多家公司的员工和订单信息（姓名、手机、证件号、航班号和起飞时间等）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "HackBraid", "wybug_date": "2015-03-18 13:21", "wybug_open_date": "2015-06-21 08:10", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["越权操作", "设计不当导致攻击界面扩大"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-26：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-21：\t细节向公众公开  简要描述： 都是经典的越权，一针见血~ 详细说明：  http://www.piaoyou.org/case_web.htm 票友软件的案例随意注册企业号：18200110000，密码也是这个，由于现在只能注册企业号，所以下面的越权和注入都是基于企业账户，其他账户也可能存在功能性的越权。一、cookie存在越权（伪造member id很直接）：1.系统管理处（四处越权）/System/myinfo.aspx/member/Group.aspx/member/Flag.aspx/member/Personnel.aspx先来看看企业信息处，直接查看所有账户明文密码，这里以神华为例，抓包修改cookie的member id参数为3：\n\n1.订单查询处（五处越权）\n\n/Order/flight.aspx/Order/hotel.aspx/Order/train.aspx/Order/Return.aspx/Order/scgq_list.aspx2.订单审核处（三处越权）/Check/flight.aspx /Check/hotel.aspx/Check/train.aspx3.差旅报表处（六处越权）/Report/flight.aspx/Report/train.aspx/Report/hotel.aspx/Report/visa.aspx/Report/bx.aspx/Report/other.aspx二、财务的查询功能都存在四处越权漏洞（伪造POST参数中的member id,同样直接）：1.财务管理的综合统计处/Financial/orders_all.aspx 2.财务管理的付款申请记录处/Financial/fksq_meb.aspx 3.财务管理的行程单交接处/Financial/xcd_orders.aspx 4.财务管理的已付款记录处/Financial/pay_history.aspx    漏洞证明：  案例一、http://www.h-h.com.cn/1.系统管理处的查看密码详细说明提到过了，这里来个查看神华所有员工信息（做个字典也好）http://www.h-h.com.cn/member/Personnel.aspx，抓包修改cookie的member id参数为3，这样深化员工信息就泄露了，左边的员工操作也可以越权\n\n\n\n系统管理处的其它操作也存在这样的越权\n\n2.http://www.h-h.com.cn/Order/flight.aspx，抓包修改cookie的member id参数0-640都行\n\n当然burp的intruder功能可以窥探所有人员的航班信息了\n\n3.http://www.h-h.com.cn/Order/hotel.aspx，修改cookie的member id为9\n\n4.http://www.h-h.com.cn/Order/train.aspx，修改cookie的member id为32\n\n5.http://www.h-h.com.cn/Order/Return.aspx\n\n6.http://www.h-h.com.cn/Check/hotel.aspx，修改cookie的member id为9\n\n7.http://www.h-h.com.cn/Check/train.aspx，修改cookie的member id为69\n\n8.http://www.h-h.com.cn/Report/flight.aspx，修改cookie的member id为1\n\n9.http://www.h-h.com.cn/Report/train.aspx，修改cookie的member id为55\n\n10.http://www.h-h.com.cn/Report/hotel.aspx，修改cookie的member id为9\n\n11.http://www.h-h.com.cn/Report/visa.aspx，修改cookie的member id为69\n\n12.http://www.h-h.com.cn/Report/bx.aspx，修改cookie的member id为69\n\n13.http://www.h-h.com.cn/Report/other.aspx，修改cookie的member id为69\n\n14.http://www.h-h.com.cn/Financial/orders_all.aspx，修改POST中的mid为3\n\n汇总下来不到一年用了40W+\n\n也有公司花了400W，是海之梦\n\n15.http://www.h-h.com.cn/Financial/fksq_meb.aspx ，修改POST中的mid为86\n\n\n\n案例二、http://www.4008836868.com1.越权查看其它企业密码\n\n2.越权查看其它企业员工信息（身份证、护照）\n\n3.订单查询处\n\n4.订单审核处\n\n5.差旅报表处\n\n6.财务管理处\n\n案例3.http://hhcl.h-h.com.cn/1.越权查看其它企业密码\n\n2.越权查看其它企业员工信息（身份证、护照）这个近2000员工信息\n\n3.订单查询处\n\n4.订单审核处\n\n5.差旅报表处\n\n6.财务管理处 200多万的\n\n   修复方案：  很严重吧加上session端的验证吧   版权声明：转载请注明来源 HackBraid@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-03-23 08:08 厂商回复： CNVD确认并复现所述情况，暂未确认软件生产厂商以及暂未建立与对应网站的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}