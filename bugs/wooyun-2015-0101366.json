{"id": 45573, "wybug_id": "wooyun-2015-0101366", "wybug_title": "麦当劳(中国)有限公司某子站之获取全国10多W员工密码", "wybug_corp": "麦当劳(中国)有限公司", "wybug_author": "路人甲", "wybug_date": "2015-03-14 21:27", "wybug_open_date": "2015-03-19 21:28", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-19：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 有麦当劳礼物送不？批量返回用户密码！~~~ 详细说明：  看如何获取员工密码\nhttp://intheloop.mcdonalds.com.cn/readme.aspx\n\n\n了解到了员工编号，以及通过\nhttp://intheloop.mcdonalds.com.cn/sendpass.aspx\n获取了员工邮箱信息，那么就可以去猜解员工的找回密码问题的答案了，至少会有一些信息可以从邮箱获得是吧，比如生日信息，姓名等，因为有很多人会有用姓名拼音或者生日信息作为邮箱，或许邮箱名来作为员工密码也说不定？\n\n1、提问过于比较简单，问题回答比较容易那么我们先测试下面三个员工信息：10001033、10001035、10001036，发现问题过于简单，回答的问题简直小学生都会了，而且发现了什么？根本不用抓包，直接将密码显示出来了，请看下图！~~~\n\n\n\n\n\n2、根本没有问题和回答的继续测试几个帐号，我们用10001001、10001002来测试，发现注册早的用户有些根本没有问题，那么直接点确定，直接返回密码信息！~~~发现有些员工的密码还是有字母大小写什么的混合的嘛，或许是开始管理员给员工设置的密码吧！~~~\n\n\n\n3、邮箱名做密码的，或者直接问题就是邮箱是什么，那么有了用户邮箱信息还不好确定问题答案么？前面说过了，用用户邮箱名作为密码的也说不定，那么还真发现了一个，而且所用的密码问题简直就让人不假思索了，返回的密码信息跟邮箱名一模一样\n\n4、餐厅编号来作为问题的，通过邮箱信息就能才出来@bigmac.com.cn这类邮箱，邮箱会用到餐厅编号，通过用户名，比较，猜测，不难猜出答案，请看\n\n5、那么先回到获取邮箱信息的那个员工10001034这个来如何通过密码验证吧！~~~从返回的邮箱可以看到xuli19791117@126.com，有生日吧，他的验证问题就是生日多少，输入19791117、1117均不能成功，那么会是多少？就在这个里面猜，那就继续把，猜不到，用burpsuite来枚举吧！~~~可惜没有猜出来，就不继续了，可能有其他答案或者日期格式吧！~~~6、上面说到有些员工用的是管理员给的密码，那么验证问题也就一样了，来爆破试试，还是获取到邮箱信息的999个员工10001001~~10001999，999个员工，总共可以返回335个密码，33.53%，命中率还挺高的，那么10W员工会有多少呢？3W多个会不会有？\n\n\n\n\n\n7、其他的根据用户的提问，以及邮箱，或者其他信息，是否也可以爆破呢？就不继续测试了8、用获取的员工返回的密码，登录，可以查看员工信息哦\n\n\n\n   漏洞证明：  \n\n\n\n   修复方案：  加强验证，问题设置不能过于简单，或者直接取缔掉问题回答，要不多几个验证什么的，总之你们比我知道得多！~~~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-03-19 21:28 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-14 21:34 |    \t\t无心、 \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:20        | 你不是风儿，我也不是沙，再怎么缠绵也到不...)\t\t \n  路人甲无法送礼 妖孽，现身吧。    \n     2015-03-14 22:04 |    \t\t独孤求败 \t\t\t( 普通白帽子  |\t\t\t        Rank:1214 漏洞数:331        )\t\t \n  @无心、 可以送吧？怕就是要了地址，又不给你送礼物    \n     2015-03-14 22:10 |    \t\t无心、 \t\t\t( 实习白帽子  |\t\t\t        Rank:71 漏洞数:20        | 你不是风儿，我也不是沙，再怎么缠绵也到不...)\t\t \n  不行的哟，路人甲就是完全匿名了，厂商也不知道你是谁的。所以不还是快点取消匿名吧。。。    \n     2015-03-14 23:39 |    \t\tzkj \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 本人不才，请各路大牛指点！)\t\t \n  有是这样的，跟12306一样！    \n     2015-03-19 22:35 |    \t\tsherlock \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 这个人很懒 标点符号都没留下)\t\t \n  居然被忽略了。。。    \n     2015-03-20 06:23 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  社工滴啊。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}