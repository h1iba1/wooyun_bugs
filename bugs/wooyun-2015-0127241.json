{"id": 69363, "wybug_id": "wooyun-2015-0127241", "wybug_title": "益用TMS v6在线培训系统2处文件上传漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-07-20 22:26", "wybug_open_date": "2015-10-20 17:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-25：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-09-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-10-20：\t细节向公众公开  简要描述： 只需爆破三位数 详细说明：      成都益用科技有限公司开发的益用在线培训系统（Euse training management system ，Euse TMS）融合了现代网络技术、多媒体技术、现代培训e-learning教育管理理念，对教育培训流程进行科学规划，课程资源统筹配置，建立基于网络信息化、数字化的学习型组织-----政府（企业）网络大学将成为教育培训工作的主流形式，并将网络教育培训推向低成本、高效率和专业化的发展方向；它是全员培训、终身学习的基础，是实现人力资源战略的重。Upload Vulnerability：\n/js/JQueryUpload/UploadKnowledge.aspx  通过测试代码区域的表单可以直接上传任意文件，文件名字是：文件名(年月日时分秒+三位数爆破).asp\nCase:\nhttp://**.**.**.**/js/JQueryUpload/UploadKnowledge.aspxhttp://**.**.**.**:801/js/JQueryUpload/UploadServerFile.aspxhttp://**.**.**.**/js/JQueryUpload/UploadKnowledge.aspxhttp://**.**.**.**:6088/js/JQueryUpload/UploadKnowledge.aspxhttp://**.**.**.**/js/JQueryUpload/UploadKnowledge.aspxhttp://**.**.**.**:801/js/JQueryUpload/UploadKnowledge.aspxhttp://**.**.**.**/js/JQueryUpload/UploadKnowledge.aspxhttp://**.**.**.**/js/JQueryUpload/UploadServerFile.aspx...more..\n没有任何限制直接获取WEBSHELL。Upload Vulnerability：<code>/js/JQueryUpload/UploadServerFile.aspx   虽提示需要登录，但其实已经成功上传   漏洞证明：  Security Testing:\n测试：http://**.**.**.**:6088/js/JQueryUpload/UploadKnowledge.aspx通过表单上传；开启Burp抓包；这里上传一个文件名为wooyun.asp；可以发现返回的是500错误，但其实是因为这个站点有点儿问题，别的站点不会返回500；但是不需要急，经测试这是成功上传；那么最后再看返回时间，由于本人的Burp不知道哪里时钟出现问题，现在时间是19点，而不是11点，看样子是走慢了8小时，所以这里返回的时间应该是：2015-07-16 19:50：00 正好整点；那么文件名将会是：wooyun(20150716195000???).asp\n\n根据burp的返回时间得到了文件：wooyun(20150716195000???).asp，那么后面三位将是一个随机数字，三位数？对于burp来说只需要短短几十秒就可以爆破成功；上传的文件躺在我们设置的“folder”下。先随机访问以下抓包后丢入Intruder中~\n\n\n\n三位数字太简短了，短短30秒（我这网速还算很慢4M的），成功获取shell完整名！\n\n\n\n连接测试用的shell，可以看到时间是完全不差毫秒的！\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-07-22 17:15 厂商回复： CNVD确认并复现所述情况，已由CNVD通过软件生产厂商公开联系渠道向其邮件通报，由其后续提供解决方案并协调相关用户单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}