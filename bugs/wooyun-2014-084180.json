{"id": 48112, "wybug_id": "wooyun-2014-084180", "wybug_title": "优酷网某后台验证码绕过(破解管理员两枚)", "wybug_corp": "优酷", "wybug_author": "lijiejie", "wybug_date": "2014-11-21 21:06", "wybug_open_date": "2015-01-05 21:08", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-11-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-12-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-05：\t细节向公众公开  简要描述： 优酷网某后台验证码绕过，破解弱口令两枚。这个漏洞我8月份已经提到360库带了，他们给了报酬的。我是在破解出新的账号后，才昧着良心再提交到wooyun。希望360库带的小伙伴见谅，再次道个歉。  :) 详细说明：  优酷土豆第三方素材替换平台： \nhttp://211.151.146.175:8080/login.do\n存在逻辑缺陷，导致被攻击者轻易攻破。1. 验证码可绕过这是很多公司外网暴露的系统存在的通病，看起来有验证码，实际多数都可绕过、可逆向、可识别。此站点，固定Cookie中JSESSIONID和参数code的值，即可进行暴力破解。2. 提示信息过详细 不存在的用户和存在的用户，提示不一样，攻击者轻易猜解出哪些用户是存在的。（指数级减小了破解尝试次数）此处存在的用户，提示“用户名或密码错误，请重新输入”不存在的用户，则提示“您没有该系统权限，请联系管理员！”挂个小字典，很快即可小范围锁定用户名列表，我跑出来少量用户：\nadmin jintuotudouyoukuzhousu\n利用密码字典再跑一遍，命中用户：\ntudou，密码tudou123456youku, 密码youku888\n   漏洞证明：  \n\n   修复方案：  一点建议：1. 验证码使用一次，立即过期2. 强化用户密码3. 条件允许，对敏感系统做二次验证   版权声明：转载请注明来源 lijiejie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-11-22 14:37 厂商回复： 多谢提醒，马上修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-21 22:17 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1044 漏洞数:106        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  ....良心大大的坏    \n     2014-11-21 22:49 |    \t\t疯狂的dabing \t\t\t( 实习白帽子  |\t\t\t        Rank:33 漏洞数:9        | Hehe is golden.)\t\t \n  你这是高级黑呢？8月份提交过去，这都11月了你又爆破出两枚帐号，意思是这么久没修复？    \n     2014-11-21 23:02 |    \t\t炯炯虾 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我来自地球)\t\t \n  昧着良心    \n     2014-11-21 23:19 |    \t\tgreg.wu \t\t\t( 普通白帽子  |\t\t\t        Rank:815 漏洞数:99        | 打酱油的~)\t\t \n  刷rank可耻    \n     2014-11-21 23:23 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  欢迎洞主    \n     2014-11-22 00:10 |    \t\tSuner \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:2        | 洞次打次)\t\t \n  两边都刷分，你好机智啊    \n     2014-11-22 00:13 |    \t\tlijiejie  \t\t\t( 核心白帽子 |\t\t\t        Rank:2210 漏洞数:294        | Just for fun.)\t\t \n  @疯狂的dabing  可能是因为优酷没有去认领漏洞，相信360已经发过通知邮件了。 两个平台的漏洞公开机制不同，优酷没看到漏洞详情，是可能的。    \n     2014-11-22 00:47 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @lijiejie 。。还是那个弱口令么，360貌似这种局势10-50块吧    \n     2014-11-22 02:00 |    \t\tWoodee \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 乌云路人甲，打脸pa pa pa)\t\t \n  Just for fun.    \n     2014-11-22 13:05 |    \t\t老笨蛋 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:8        | 老笨蛋一个)\t\t \n  顶一下牛人。    \n     2014-11-22 21:51 |    \t\t昔阳 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 菜鸟来装逼)\t\t \n  洞主机智！    \n     2014-11-25 08:19 |    \t\t你大爷在此 百无禁忌 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:6        | Hello 各位小伙伴们 大家好 我是王尼玛)\t\t \n  你永远不明白我这句话的真正含义    \n     2015-01-06 06:44 |    \t\t狂人 \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:13        | Rank:999999999 漏洞数:999999999 | 小学生...)\t\t \n  楼主能否共享下字典？    \n     2015-01-06 09:25 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  tudou，密码tudou123456youku, 密码youku888哈哈哈    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}