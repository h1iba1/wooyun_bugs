{"id": 43239, "wybug_id": "wooyun-2015-0130081", "wybug_title": "比亚迪迪粉汇重置任意用户密码包括管理员账号（机智的分析思路）", "wybug_corp": "bydauto.com.cn", "wybug_author": "纳米翡翠", "wybug_date": "2015-07-29 10:03", "wybug_open_date": "2015-09-13 15:06", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-13：\t细节向公众公开  简要描述： 从来没要过20rank，这次要一个吧，因为用户量之大，泄漏利用成本之低，方式之简单 详细说明：  59万迪粉我来了\n\n   漏洞证明：  时间不早了，不说废话，直接入题1.打开迪粉汇http://club.bydauto.com.cn/portal.php2.点击登录-->忘记密码或者直接访问以下链接http://webcasqa2.byd.com.cn/sso/member.php?mod=lostpasswd用户名输入admin输入验证码\n\n说到验证码，这里小小吐槽一下，验证码放在cookie里面不是可以直接爆破了吗？3.显示出admin用户的邮箱，虽然打了码，但是在cookie里面又一览无余。\n\n\n\n这段看似乱七八糟的东西只是做了一个url编码，解码后如下：a:5:{s:6:\"mobile\";s:0:\"\";s:5:\"email\";s:19:\"zhong.ge@byd.com.cn\";s:8:\"password\";s:32:\"b08bf72c18097d850930fa9b3abe660c\";s:8:\"username\";s:5:\"admin\";s:3:\"uid\";s:1:\"1\";}貌似连用户的密码一起返回了，不过md5加了盐值，破解不是很容易，但感觉不应该返回密码数据4.下一步伪造邮箱，让邮箱验证发到指定的邮箱里面\n\n这里有点小插曲，就是伪造邮箱的长度一定要和用户自己邮箱的长度一样，否则发送不成功，我也是偶然发现的（这里就是bug根源）于是伪造一个和原来一样长度的邮箱bydautocomcn@qq.com替换之\n\n成功截获邮件\n\n访问里面的url，直接重置admin密码\n\n\n\n访问后台看看\n\n到了后台拿个uc key 上传个shell很容易的事情，就不演示了,只为说明问题严重性.说声抱歉，admin的密码改成bydauto了，请修改。   修复方案：  逻辑控制   版权声明：转载请注明来源 纳米翡翠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-07-30 15:05 厂商回复： 感谢您对比亚迪的关注及测试，因返回用户信息并存储在COOKIE，且在发邮件时并未做二次验证导致该漏洞的产生。另外，验证码没有加密，存在用户密码被穷举爆破的可能性。目前漏洞我们已经修复，谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-05 20:22 |    \t\tBurn Egg \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:8        | 经验，范围，字典，思维)\t\t \n  占座，洞主演义第一个。厂商回复看着露得不少啊    \n     2015-08-06 10:52 |    \t\tSeven.Sea \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:18        | 唯有安全与美食不可辜负。)\t\t \n  洞主演义过来的=.=围观思路.    \n     2015-08-19 16:23 |    \t\t进击的zjx \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:49        | 工作需要，暂别一段时间)\t\t \n  挖洞思路的确厉害！不过程序员的编码思路更厉害！233    \n     2015-09-24 15:32 |    \t\tbaoz \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | python、树莓派、linux)\t\t \n   求教这个验证邮箱长度是几个意思？为什么会想到验证长度？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}