{"id": 39213, "wybug_id": "wooyun-2015-094545", "wybug_title": "一亩田交易网逻辑漏洞（木桶原理）", "wybug_corp": "一亩田", "wybug_author": "路人甲", "wybug_date": "2015-01-29 16:01", "wybug_open_date": "2015-03-15 16:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-15：\t细节向公众公开  简要描述： 一亩田交易网漏洞打包包，求高rank 详细说明：  看到首页有一亩田密码重置的问题了，就来挖一挖了http://www.ymt360.com/首先注册用户，手机号，发送验证码，是6位数字不截图了这里，发送手机号1分钟能发一次，服务端有限制。然后手机版http://m.ymt360.com/可以无限进行发送短信，造成短信轰炸，手机验证码还是6位数字\nGET /user/send_msg?mobile=13800xxxxx HTTP/1.1Host: m.ymt360.comresponse  {\"status\":1,\"msg\":16595}\n到这里漏洞审核肯定说无危害啊，因为没有一个短信轰炸被通过的。然后我们来到了手机APP客户端，以安卓的为例吧首先也是短信轰炸，这个不多说了然后就是，短信验证码为4位数字，这个爆破起来是分分钟啊\n\n然后这个可能也没什么，其实想说的是一个设计缺陷\nPOST /v8/phone/verify?mac=cATa3T986UgODE7YgoSZ9h4yJoI. HTTP/1.1X-App-Version: V3.3.2X-User-Agent: 0X-User-Id: 93873X-DOMAIN: appContent-Type: application/jsonAccept-Encoding: gzip,deflate,sdchContent-Length: 57Host: api.ymt360.com{\"seqNo\":\"16768\",\"vcode\":\"1111\",\"code\":\"aifbc6c0eo5sgzi\"}\n上面就是验证验证码的的请求1111可以直接爆破然后验证失败response返回{\"status\":-1}现在我们直接不进行爆破，截获返回包，修改为{\"status\":0}则直接验证通过进入账户页面\n\n然后更重要的一点就是，可以知道其他用户的手机号，直接登录任意用户账号   漏洞证明：  看到首页有一亩田密码重置的问题了，就来挖一挖了http://www.ymt360.com/首先注册用户，手机号，发送验证码，是6位数字不截图了这里，发送手机号1分钟能发一次，服务端有限制。然后手机版http://m.ymt360.com/可以无限进行发送短信，造成短信轰炸，手机验证码还是6位数字\nGET /user/send_msg?mobile=13800xxxxx HTTP/1.1Host: m.ymt360.comresponse  {\"status\":1,\"msg\":16595}\n到这里漏洞审核肯定说无危害啊，因为没有一个短信轰炸被通过的。然后我们来到了手机APP客户端，以安卓的为例吧首先也是短信轰炸，这个不多说了然后就是，短信验证码为4位数字，这个爆破起来是分分钟啊\n\n然后这个可能也没什么，其实想说的是一个设计缺陷\nPOST /v8/phone/verify?mac=cATa3T986UgODE7YgoSZ9h4yJoI. HTTP/1.1X-App-Version: V3.3.2X-User-Agent: 0X-User-Id: 93873X-DOMAIN: appContent-Type: application/jsonAccept-Encoding: gzip,deflate,sdchContent-Length: 57Host: api.ymt360.com{\"seqNo\":\"16768\",\"vcode\":\"1111\",\"code\":\"aifbc6c0eo5sgzi\"}\n上面就是验证验证码的的请求1111可以直接爆破然后验证失败response返回{\"status\":-1}现在我们直接不进行爆破，截获返回包，修改为{\"status\":0}则直接验证通过进入账户页面\n\n然后更重要的一点就是，可以知道其他用户的手机号，直接登录任意用户账号   修复方案：  ~~   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-01-29 16:42 厂商回复： 多谢关注，我们会一一排查改进，希望继续帮助一亩田改善安全。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-04 21:58 |    \t\tzkj \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 本人不才，请各路大牛指点！)\t\t \n  这应该属于绕过验证吧！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}