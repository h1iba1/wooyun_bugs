{"id": 3277, "wybug_id": "wooyun-2014-054912", "wybug_title": "建站之星 Sitestar 注入漏洞一枚", "wybug_corp": "建站之星", "wybug_author": "′雨。", "wybug_date": "2014-03-30 09:55", "wybug_open_date": "2014-06-28 09:55", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-03：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-28：\t细节向公众公开  简要描述： 过滤不严。 详细说明：  在module/mod_email.php 中\npublic function do_mail(){    \t\tglobal $db;    \t$title = ParamHolder::get(\"title\");\t    \t$msg = ParamHolder::get(\"email_s\");    \t$msg .= ParamHolder::get(\"email_m\");    \t$roles = ParamHolder::get(\"role\");    \t$type = ParamHolder::get(\"type\");    \t$user_email = ParamHolder::get('users'); \t\t    \t$send_id = SessionHolder::get(\"user/id\");\n省略一点\nelse{\t\t\t//邮件群发\t\t\tforeach ($roles as $k=>$row){\t\t\t\t\t\t$sql = \"select id,login,email from \".Config::$tbl_prefix.\"users where s_role='{\".$row.\"}'\";\t\t\t\t\t\t\t    $res = $db->query($sql);\t\t\t    $emails = $res->fetchRows();\t\t\t\tif (!empty($emails)) {\t    \t\t\tforeach ($emails as $eml){\t\t\t\t        if($this->send_mail($title,$msg,$eml['email'])){\t\t\t\t        \t$ok++;\t\t\t\t        \t$sql = \"insert into \".Config::$tbl_prefix.\"email\n这里对他遍历 然后直接带入查询当中。 并没有什么过滤。 直接注入。   漏洞证明：  \n\n注入成功。   修复方案：  过滤。   版权声明：转载请注明来源 ′雨。@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-03-31 10:01 厂商回复： 处理中，感谢 最新状态： 2014-04-03：补丁已经发布，请去官网更新补丁或下载最新安装包，谢谢。  ", "replys": "漏洞评价：\n评论\n     2014-03-30 11:18 |    \t\t走火入魔 \t\t\t( 路人 |\t\t\t        Rank:18 漏洞数:2        | 多读书，多看报，少吃零食，多睡觉。)\t\t \n  雨大牛 你这是刷漏洞吗    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}