{"id": 12416, "wybug_id": "wooyun-2013-025270", "wybug_title": "[腾讯QQ漏洞]简单三分钟教你如何获取上司的QQ密码", "wybug_corp": "腾讯", "wybug_author": "路人甲", "wybug_date": "2013-06-06 15:08", "wybug_open_date": "2013-06-06 16:46", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-06-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-06-06：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： QQ作为国内互联网即时通讯的老大，其用户量甚至超越手机用户，有了QQ认识新的朋友时更多的不是交换手机号码，而是加一下我的QQ。作为一个如此重要的通讯工具，其安全性也是大家关注的焦点。尽管说黑客无处不在，但是只要你上网安份一点，一般也没有什么安全问题。不过，如果是QQ本身产品有漏洞，那这个安全隐患就实在是令人担忧了。今天就让我来说说腾讯QQ的一个安全漏洞。这个漏洞早在2010年我就发现，那时候只是一时兴起，通过这个漏洞窃取了同个培训班同学的QQ，当然了，只是玩的心态，没有触犯别人的任何利益。这几年来我也一直有关注这个问题，时不时试一下。今天试了一下，令人惊讶的是这个漏洞至今还在。PS：时不时试一下的场景主要是和朋友炫耀，并没有损害别人的财产利益，也没有损害公共财产利益，不要想多了。这个产品漏洞就是QQ申诉。在2010年的时候我突然选择性失忆地忘记了QQ密码，然后想要回密码当然是验证密保了，但是密保居然也不记得(事实上长时间不改密保的话很，很少人会记得自己捏造出来的问题和答案)，那只好申诉了。我到QQ申诉平台去简单填写了一下我的名字，和常在地区，其他的都没有填。申诉结果是令人欢喜令人忧。令人欢喜的是申诉成功了，我可以重置密码了。令人忧的是，这么容易就通过审核，这个审核到底还有什么意义?作为一个菜鸟极客的我一样拥有敏锐的触觉(稍微自恋一下，哈哈)，我马上就意识到这是一个漏洞。所谓发散性思维在这个时候就起了关键作用，我马上联想到QQ上经常出现的一个提醒“您的好友不在常在地区登录”，对，地区。腾讯审核系统就是用地区作为判断条件，细化一点来说就是IP地址，因为我常在那个培训班的局域网里上网，QQ经常在那里登录，所以QQ已经把那里的IP地址列入白名单列入QQ申诉审核条件之一。通过QQ申诉获取修改QQ密保最低条件：一、在常登录地区(IP地址)电脑申诉。二、知道平时在QQ上使用的名字，和近期常在登录地区。(这里选的是城市)好了。知道这些条件，有了理论，接下来就是测试。那时候我拿了一个同学的QQ测试。结果是成功了。截至今天(2013年6月6日)，这个方法依然有效，我早上还测试了一下。下面我把测试的步骤截图发上来。有图有真相。 详细说明：  第一步：打开QQ申诉网页，填写申诉QQ号。 \n\n 第二步：填写QQ真实姓名(如果是你的上司，就写你上司的名字)和接收结果的方式。 \n\n 第三步：填写验证码和选择QQ常在登录地区(你身边的人你不会不知道他们常在哪里吧?)。 \n\n 第四步：填写用过的密保资料，知道就填吧，我相信你不知道，所以不用填了。 \n\n 第五步：邀请好友辅助申诉，没有，就不填了。\n\n 第六步：提示说资料少，难通过，下面的图就说明了是不是难通过。 \n\n 第七步：提交完毕有回执，这个保存不保存都一样，因为系统会发一份给你的。 \n\n 第八步：看，邮箱收到的回执(注意：时间是中午11：40)。 \n\n 第九步：申诉成功(注意：时间是中午11：41)，居然只要一分钟?真的是系统审核么? \n\n 简简单单三分钟，你就可以获取你上司的QQ密码;简简单单三分钟，你就可以获取你爱人的QQ密码。因为现在聊天记录漫游了，还可以看TA们的聊天记录，我的天呐，这还有隐私么?!!!虽然TA们一样可以申诉拿回帐号，但是TA申诉这些时间里我想干的早就干完了。   漏洞证明：  如上   修复方案：  无   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-06-06 16:46 厂商回复： 非常感谢您的报告。您反馈的这个问题已经被公开，我们已从其他渠道获悉，故我们选择“忽略”。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-06-06 15:09 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  前排围观，出售瓜子花生矿泉水。    \n     2013-06-06 15:13 |    \t\t园长 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:14        | 你在身边就是缘，缘分写在数据库里面。)\t\t \n  申诉.... 你一个密码都不提交，用姓名和白名单IP也能过么？一般来说有辅助好友认证能过的几率9成。    \n     2013-06-06 15:20 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  http://www.iheima.com/archives/42226.html    \n     2013-06-06 15:21 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:89        | 一名普通的phper开发者，关注web安全。)\t\t \n  目测会忽略！    \n     2013-06-06 15:30 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:6        )\t\t \n  话说在很早以前同班一同学通过这种方法成功的盗取一个6位QQ，但是这不能算是漏洞吧，我记得填写的少是不行的，申诉失败的。就算你是在IP白名单。围观下吧    \n     2013-06-06 15:32 |    \t\tlucky \t\t\t( 普通白帽子  |\t\t\t        Rank:409 漏洞数:81        | 三人行必有我师焉########################...)\t\t \n  这也行呀！    \n     2013-06-06 15:35 |    \t\tnauscript \t\t\t( 普通白帽子  |\t\t\t        Rank:291 漏洞数:57        | 我淫荡啊我淫荡)\t\t \n  @梧桐雨 目测抄袭转载混邀请嫌疑    \n     2013-06-06 15:36 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @nauscript 混邀请吧，文章发布我第一时间问了下lake2  估计会忽略的    \n     2013-06-06 15:36 |    \t\t虾米 \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:13        )\t\t \n  目测会忽略！    \n     2013-06-06 15:36 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:89        | 一名普通的phper开发者，关注web安全。)\t\t \n  @梧桐雨 已经把老大的帐号进行了测试。。。看看有木有效果    \n     2013-06-06 15:45 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  这社工太严重了吧..目测忽略    \n     2013-06-06 16:22 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:208        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  @梧桐雨 http://www.iheima.com/archives/42226.html 这篇文章也是6月6日发布的    \n     2013-06-06 16:23 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:67        | 活到老，学到老!)\t\t \n  负分~ 呼叫彩色哥关小黑屋    \n     2013-06-06 16:31 |    \t\tksc \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:8        | 张三的好朋友)\t\t \n  这都行？我一个QQ号新注册的也是密保忘了，申诉没有通过理由是辅助好友认证太少 至少三个可我起注册了一共才加一个QQ号为好友    \n     2013-06-06 16:45 |    \t\ther0ma \t\t\t( 核心白帽子 |\t\t\t        Rank:598 漏洞数:83        | 专注小厂商三十年！)\t\t \n  只能说你RP大爆发而已，就地区和其他信息显然会申诉失败的，腾讯没那么水！！！！    \n     2013-06-06 16:49 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  是原作者么？    \n     2013-06-06 17:02 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:134        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  这种审核机制，就算是人工审核也很难识别吧？ 比如真正要对你身边的人下手做类似的操作，防不胜防。    \n     2013-06-06 17:53 |    \t\tnone \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:5        | 十次十次啊 hack it then know more~)\t\t \n  @xsser 建议漏洞分类也可以改改 加个原创漏洞(0day) 以及 现有漏洞利用 以及漏洞播报等     \n     2013-06-06 19:01 |    \t\t酷帥王子 \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:33        | 天朗日清，和风送闲，可叹那俊逸如我顾影自...)\t\t \n  我现在用的635833就是朋友用申诉办法搞到的，并且把他的10个好友密码保护都改了，其实之前我在乌云上也发了腾讯无密保改密码的瑕疵，可是腾讯忽略了，哈哈没办法    \n     2013-06-06 19:28 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:41        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  居然忽略了。下午都测试成功了。。    \n     2013-06-06 19:48 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  @小威 屌丝何苦为难屌丝    \n     2013-06-06 19:53 |    \t\tfreed0m \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | null)\t\t \n  下手晚了？没成~~    \n     2013-06-06 21:03 |    \t\tTitanium \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | I am titanium.)\t\t \n  这是申诉机制的问题，人工审核终究会出现失误。    \n     2013-06-06 21:03 |    \t\t一号扛把子 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 这片山头我说了算)\t\t \n  毕竟这样无聊的人很少    \n     2013-09-15 13:30 |    \t\t彩色哥 \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:1        | D8是我的天下！)\t\t \n  @小威 已经小黑屋，10天循环。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}