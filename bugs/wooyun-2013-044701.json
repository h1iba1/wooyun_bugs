{"id": 6671, "wybug_id": "wooyun-2013-044701", "wybug_title": "Fuzzing之#携程旅行网某中心存在弱口令", "wybug_corp": "携程旅行网", "wybug_author": "xfkxfk", "wybug_date": "2013-12-02 15:53", "wybug_open_date": "2014-01-16 15:54", "wybug_type": "后台弱口令", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "敏感接口缺乏校验", "设计不当", "认证设计不合理", "设计错误", "搞笑有爱"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-12-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-16：\t细节向公众公开  简要描述： 最近一朋友被携程旅行网挖过去了，回家逛了一下携程网，顺便测试了下。本次测试，将通过携程旅行网的自身业务逻辑，结合Fuzzing，漏洞自动化挖掘，对携程旅行网进行的一次白帽测试。 详细说明：  此测试时针对wordpress的，大家都知道Wordpress在核心代码安全系数很高，而在逻辑设计上，却有很多问题。遍历用户名：\nhttp://ued.ctrip.com/blog/?author=1\n\n\n\nhttp://ued.ctrip.com/blog/?author=55\n\n\n通过如上链接，你只需要不停的更换author的id，就能遍历出整个Wordpress数据库内用户的username。本次测试过程中，获取到携程旅行网http://ued.ctrip.com/blog/的用户名如下：\n1==>用户名：admin2==>用户名：Lucky3==>用户名：阿瞬4==>用户名：GreatHan5==>用户名：nnMA6==>用户名：Neao7==>用户名：小飞猪8==>用户名：祝9==>用户名：子子10==>用户名：m11==>用户名：Slli12==>用户名：小灰灰13==>用户名：≮流光恋羽≯14==>用户名：PhoDynamite15==>用户名：匪徒田老大16==>用户名：nyanhan17==>用户名：Paul18==>用户名：蓝带鱼19==>用户名：boston20==>用户名：liuff21==>用户名：雄关漫道真如铁22==>用户名：jenny_zhuzhu23==>用户名：xujia24==>用户名：ycao26==>用户名：e面包27==>用户名：点头猪28==>用户名：wayos29==>用户名：lexrus30==>用户名：Summer32==>用户名：布衣ui34==>用户名：浩子35==>用户名：linxz36==>用户名：henry37==>用户名：liuh38==>用户名：wt39==>用户名：chxu40==>用户名：linpan41==>用户名：songchen42==>用户名：decques43==>用户名：weixj44==>用户名：S++45==>用户名：labuladuo646==>用户名：heiwang47==>用户名：苏昊48==>用户名：火柴49==>用户名：dewnerxu50==>用户名：ScectVonVor51==>用户名：CoigreeIrrict52==>用户名：heisizipronee53==>用户名：test54==>用户名：hfliu55==>用户名：豚豚56==>用户名：hualv57==>用户名：pencilstub58==>用户名：neper59==>用户名：密封罐头60==>用户名：DLive61==>用户名：Dailey62==>用户名：xiaoda63==>用户名：lqzhang64==>用户名：Harry65==>用户名：LYuShine_宇轩\n存在缺陷的登录设计无验证码、无错误密码登录次数限制，更操蛋的是，你输入一个不存在的用户名，它还会告诉你是否存在，输入真确的用户名，错误密码，会提示用户的密码错误,无语......\nhttp://ued.ctrip.com/blog/wp-login.php\n既然知道了用户名，而且登录接口毫无阻挡，那就开启fuzzing了，测试开始。对于Fuzzing的工具很多，这里自己用python写了一个，方便测试，速度还不错。结合上面手机的用户名，在针对大数据，加上弱口令，很快就出来几个......\n*** Multiple Threads ***The Target Is: http://ued.ctrip.com/blog/Slli<==>Slli, may True ...PhoDynamite<==>PhoDynamite, may True ...nnMA<==>nnMA, may True ...*** All Done ***\n   漏洞证明：  \n\n操作后台数据，留后门什么的都没动，后台数据没做任何操作，谢谢。然后，就是继续收集信息咯，各种个人资料收集中......期待续集......还个问题，这个wordpress是3.3.1的，好像3.3.1的wordpress有几个漏洞的，没测试，管理可以升级了。   修复方案：  # 后台管理路口加IP限制。# 登录接口加入限制。# 提高员工的安全意识，这才是王道。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-12-02 16:02 厂商回复： wordpress后台暴力破解的问题，已通知相关业务处理，感谢对携程信息安全的支持！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-02 15:58 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @疯狗，谢谢修正    \n     2014-02-11 13:51 |    \t\t笑看天下 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:10        )\t\t \n  @xfkxfk 请问下上文中的密码规则究竟是怎么生成的 求细节 这方面不太懂 你可以详细告诉我下吗？    \n     2014-02-11 13:54 |    \t\txfkxfk  \t\t\t( 核心白帽子 |\t\t\t        Rank:2179 漏洞数:338        | 呵呵！)\t\t \n  @笑看天下 什么密码规则？    \n     2014-02-11 17:18 |    \t\t笑看天下 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:10        )\t\t \n  就是你生成FUZZ的密码规则 方便留个邮箱什么的吗？    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}