{"id": 20788, "wybug_id": "wooyun-2012-04789", "wybug_title": "KFC 4008823823.com 手机号订餐验证可绕过，致用户真实信息泄露及其他问题", "wybug_corp": "kfc 肯德基", "wybug_author": "unic02n", "wybug_date": "2012-02-25 16:35", "wybug_open_date": "2012-04-10 16:35", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-25：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-04-10：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 电话订餐手机验证码可绕过，致用户真实信息泄露及其他问题。这里不能说的太细，，那个，以后别涨价了，太贵了，， 详细说明：  订餐页面，选择曾成功电话订餐，输入手机号，点发送验证码，正常流程是该手机号收到验证码，但是，burp抓包会发现，验证码返回到客户端了。于是，验证码形同虚设，输入验证码，可看到该手机号的订餐地址，真实的。\n\n   漏洞证明：  \n\n造成2个后果：1，客户真实信息泄露2，如果mc跟你捣乱，替客户下订单。。。。损失的可是真金白银，所以rank我给高些。   修复方案：  那个，1，这个验证码不能发到客户端去，2，缩短有效时间，3，限制提交间隔，防暴力破解。这么详细，哥可真是正儿八经的白帽子！   版权声明：转载请注明来源 unic02n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2012-02-25 21:30 |    \t\tfym \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:2        | 关注安全)\t\t \n  经测试,确实如此..    \n     2012-02-25 21:32 |    \t\tfym \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:2        | 关注安全)\t\t \n  8过拿不到有哪些手机号有过订餐记录,是没什么意思.    \n     2012-02-25 21:41 |    \t\tfym \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:2        | 关注安全)\t\t \n  如果利用这处,扫描到有过订餐记录的手机号,即为已验证,直接取订餐地址,代为下单,KFC得赔多少钱啊...    \n     2012-02-26 11:50 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @fym 高手    \n     2012-02-26 19:01 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  @fym，，这个就是我所说的被mc利用的话.......，嘿嘿，，    \n     2012-02-26 19:07 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  @fym 可以暴力的猜那些有过记录，    \n     2012-02-26 20:34 |    \t\tfym \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:2        | 关注安全)\t\t \n  穷举就可以得到各种订过餐的手机号了,只不过他们为会每一个订过餐的付一条短信的钱.KFC应该有钱,短信数量应该非常多吧,可能短期内不会发现短信量被大量利用.这些号给MDL用,,哈哈...看来有生财之道了,,,,    \n     2012-02-27 09:09 |    \t\t神刀 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:3        | www.shellsec.com内射那么牛，虾米没妹子？)\t\t \n  @fym 高手    \n     2012-02-27 10:11 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  @fym 有过成功记录的，手机号正确的，才会发短信，所以，短信数量应该不会太多，毕竟少部分才有订餐记录。问题在于，这样也可以获取这些手机号的详细地址信息，再者就是你说的，下大量的kfc不得不处理的订单，最后人家却没定，拒不付款。    \n     2012-02-27 15:41 |    \t\tfym \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:2        | 关注安全)\t\t \n  所以说,很严重的问题.    \n     2012-03-12 12:08 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  果然是 无人认领啊，    \n     2012-03-27 16:56 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  不是一个月自动公开？？    \n     2012-03-27 16:57 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  @xsser 不是一个月自动公开？？    \n     2012-03-27 17:40 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @unic02n 45天了？    \n     2012-04-10 18:19 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  无人认领，这下KFC真成悲剧了......修复了没？    \n     2012-04-11 10:26 |    \t\tubuntu \t\t\t( 普通白帽子  |\t\t\t        Rank:148 漏洞数:12        | 一切皆有可能……)\t\t \n  这家伙无人认领，rank值也没给，有悲剧的，有失望的。    \n     2012-04-11 10:36 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @ubuntu wooyun会对没有rank的但有价值的进行评分    \n     2012-04-11 16:00 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  看来这个是没有价值喽，，    \n     2012-04-11 16:10 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @unic02n 汗，这个是定期进行的，有tag的属于整理过的，没有tag的是没有整理的，人手实在有限，平时还得上班儿呢..... 希望理解....    \n     2012-04-13 11:49 |    \t\tunic02n \t\t\t( 实习白帽子  |\t\t\t        Rank:73 漏洞数:9        | 我是来学习的！)\t\t \n  @xsser 玩笑话，别当真，    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}