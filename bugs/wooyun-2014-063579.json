{"id": 54714, "wybug_id": "wooyun-2014-063579", "wybug_title": "某网站群系统存在通用SQL注射+任意文件下载#可入后台getshell", "wybug_corp": "Cncert国家互联网应急中心", "wybug_author": "U神", "wybug_date": "2014-06-04 22:58", "wybug_open_date": "2014-09-02 23:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-08-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-02：\t细节向公众公开  简要描述： 投票地方存在注入 详细说明：  #1.通用型建站程序介绍：\n1、建站程序类型：JSP+MSSql2、漏洞类型：SQL注入3、缺陷文件：vote/voteok2.jsp 或vote/voteok.jsp4、注入参数：researchId=5、涉及版本：未知7、危害程度：高危8、涉及厂商：安徽汇能信息技术有限公司9、厂商网站：http://www.hnkj.com.cn/10、安装量：大11、是否拥有源代码分析：暂无12、关键字：inurl:newinfo.do?infoId13、是否默认配置：是14、枚举案例【应乌云的要求，枚举5例】：【声明：以下提供的全部案例一方面证明通用型，一方面是给CNVD或Cncert测试，其他人不得用此作非法用途或者破坏操作，否则后果自负】http://www.***.gov.cn/vote/voteok2.jsp?researchId=2http://www.a***w.gov.cn/vote/voteok2.jsp?researchId=3http://www.***y.gov.cn/vote/voteok2.jsp?researchId=2http://www.a***.org.cn/vote/voteok2.jsp?researchId=3http://www.***.ah.cn/vote/voteok2.jsp?researchId=3.....等等\n\n\n   漏洞证明：  #2.注入证明（不测试gov站点）：\nhttp://www.***.com/vote/voteok2.jsp?researchId=3\n明文密码：\n\n\nhttp://www.***w.com/vote/voteok2.jsp?researchId=3\n\n\n\nhttp://www.a***j.com/vote/voteok2.jsp?researchId=3\n\n\n\nhttp://www.j***.ah.cn/vote/voteok2.jsp?researchId=3\n\n\n\nhttp://www.a***g.com.cn/vote/voteok2.jsp?researchId=3\n\n\n\n#3.任意文件下载：漏洞文件：addcontent/webEditor/upload/files/file_down.jsp?filename=其中filename没有正确的判断下载文件的合法性，导致可以下载任意文件。枚举三例：http://www.a***y.cn/sjxyjyw/addcontent/webEditor/upload/files/file_down.jsp?filename=../../.../../../../index.jsp\n\nhttp://zm71c.***gc.com/addcontent/webEditor/upload/files/file_down.jsp?filename=./file_down.jsp\n\n\n\nhttp://www.ah***z.com/addcontent/webEditor/upload/files/file_down.jsp?filename=./../../../../admin/main.jsp\n\n\n\n\n\n#3.可getshell，利用注入出的帐号密码，进入后台可以上传webshell，增加栏目的地方。\n\n然后可以getshell\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 U神@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：17  确认时间：2014-06-08 22:20 厂商回复： CNVD确认并复现多个实例情况，已经转由CNCERT下发给安徽分中心（仅处置实例，未确认软件生产厂商） 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-05 16:59 |    \t\tMosuan \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:175        | 尘封此号，不装逼了，再见孩子们。by Mosua...)\t\t \n  你是什么时候提交的？    \n     2014-06-26 19:05 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  其它注入已提交至360库带    \n     2014-07-12 09:10 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  好叼、源生..    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 17, "Ranks": null}