{"id": 17040, "wybug_id": "wooyun-2012-011477", "wybug_title": "联想的最后一个沦陷站点", "wybug_corp": "联想", "wybug_author": "风萧萧", "wybug_date": "2012-08-28 21:04", "wybug_open_date": "2012-10-12 21:05", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-09-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-09-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-09-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-10-12：\t细节向公众公开  简要描述： 哎，没有乐phone，这是我发的最后联想的洞了！不给力啊！！！！ 详细说明：  1.老规矩了，是这个站点呢\nhttp://ask.lenovomobile.com/\n联想乐问吧，是咨询关于联想产品问题的地方吧！这次不牛B了。\n\n2.我也来问个问题吧，这里只是测试呢！一不小心瞅到有个上传图片的地方呢！have a try！我上传一个正常图片看看先。\n\n3.上传test.jpg吧，我最常用的头像，哈哈！点击上传咯\n\n4.上传的时候，顺便抓个包看下怎么个上传的，看到filename=\"test.jpg\",这里是不是可以改下呢？\n\n\n\n5.看下返回的结果吧，可能包含有文件上传后的相对地址哦！果不其然呢！\n\n6.访问下这个地址，结果如下：\n\n   漏洞证明：  7.再次上传，不过这个时候要抓包将filename的值test.jpg改成test.php，截图如下：\n\n8.再看看返回的地址呗，哎呦我操，服务端真的没做判断呢，后缀还是.php\n\n9.啥也不说了，操上菜刀：\n\n   修复方案：  1.客户端的过滤判断都是浮云，服务端还是需要做判断的；2.文件名是改成随机命名了，但是后缀也要改下啊；3.建议是将上传的文件存到另一个内网服务器，或者是另一台专门存放静态文件的服务器，这样即使上传成功了php文件，也不能执行了；4.如果是在没有条件的话，建议设置上传文件的目录不可执行权限！5.乐phone俺是不要了，20rank还是要的。谢谢！   版权声明：转载请注明来源 风萧萧@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-08-28 22:58 厂商回复： 1.攻击步骤能不能别这么详细，你这是教唆……2.修复方案这次写的很详细，赞一下…… 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n          这些评论似乎很乌云~~~思密达          2012-08-29 09:13 |\t\t\t\t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t\t\t\tRank:1020 漏洞数:76\t\t\t| 人这一辈子总要动真格的爱上什么人)\t\t\t\t\t\t\t\n  @upload @Tea 所以就会要求： 1 提交漏洞的时候尽量展现你的思路和想法体现技术价值； 2 完成必要的证明的截图和文字体现你的漏洞价值。 否则可能就会让你获得的rank降低的，推荐@gainover 的漏洞报告乌云体    ：）    \n   \n \n     2012-08-28 22:00 |    \t\t波波虎 \t\t\t( 普通白帽子  |\t\t\t        Rank:266 漏洞数:51        | 11111111111)\t\t \n  你已经发了很多了    \n     2012-08-28 23:54 |    \t\tupload \t\t\t( 普通白帽子  |\t\t\t        Rank:251 漏洞数:43        | 此处略--！)\t\t \n  厂商回复：1.攻击步骤能不能别这么详细，你这是教唆……    \n     2012-08-29 08:55 |    \t\tTea \t\t\t( 普通白帽子  |\t\t\t        Rank:297 漏洞数:37        | Can't We Be Young.)\t\t \n  1.攻击步骤能不能别这么详细，你这是教唆……    \n     2012-08-29 09:13 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @upload @Tea 所以就会要求： 1 提交漏洞的时候尽量展现你的思路和想法体现技术价值； 2 完成必要的证明的截图和文字体现你的漏洞价值。 否则可能就会让你获得的rank降低的，推荐@gainover 的漏洞报告乌云体    ：）    \n     2012-08-29 09:15 |    \t\t波波虎 \t\t\t( 普通白帽子  |\t\t\t        Rank:266 漏洞数:51        | 11111111111)\t\t \n  @风萧萧  你写的是发现思路，不是攻击步骤    \n     2012-08-29 09:19 |    \t\tupload \t\t\t( 普通白帽子  |\t\t\t        Rank:251 漏洞数:43        | 此处略--！)\t\t \n  @风萧萧 还看不见内容....坐等    \n     2012-08-29 09:22 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @波波虎  虎兄，你能看到俺的攻击步骤不？俺写的是思路啊！啊啊！！啊啊啊！！！    \n     2012-08-29 11:25 |    \t\tEl4pse \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:7        | 世界上从来没有不可能这几个字，可不可能完...)\t\t \n  还看不见。。坐等学习思路    \n     2012-08-29 11:51 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  思路万岁！    \n     2012-09-05 09:03 |    \t\tqiaoy \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:16        )\t\t \n  求被教唆.....    \n     2012-09-27 23:40 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  攻击步骤能不能别这么详细，你这是教唆……教唆……    \n     2012-09-28 00:22 |    \t\tRa1nker \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | TeST)\t\t \n  xx87080x。楼主懂的    \n     2012-09-28 09:55 |    \t\t白胡子 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:3        )\t\t \n  这确实是思路,不是攻击步骤    \n     2012-09-28 12:00 |    \t\t褪色的黑 \t\t\t( 实习白帽子  |\t\t\t        Rank:68 漏洞数:20        | 啄木鸟。。。。。。。。。。)\t\t \n  这个代理抓包软件burp越来越火爆了    \n     2012-09-29 10:10 |    \t\tSeay \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:8        )\t\t \n  1.攻击步骤能不能别这么详细，你这是教唆……建议下次提交直接在详细说明那写“你懂的...”，漏洞证明上个拿下的图就是，你懂的    \n     2012-09-29 13:49 |    \t\txcl0ud \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        )\t\t \n  现在的这些厂商真j8奇葩。你少写两句吧，他说这洞没价值，看不到危害，你写详细点吧，他又说你教唆。    \n     2012-10-05 11:22 |    \t\tLittlePig \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | </html>)\t\t \n  联想这么说也不是没有道理。很有可能在联想的其他地方存在着同样的漏洞。你直接把方法捅出来了让那群[咳咳]程序员们情何以堪啊~    \n     2012-10-12 22:00 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  最后一次 不信爱情了    \n     2012-10-12 22:39 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @风萧萧 看来，你是没看过他们给我的回复，，，我已经不再相信爱情了。。。你懂的。。。。    \n     2012-10-12 22:41 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  @Coody 看过给我的答复，连基情都不信了。。。    \n     2012-10-12 22:51 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @Coody @瘦蛟舞 不好意思，看了联想给你们的回复我笑射了！哈哈哈哈    \n     2012-10-12 22:59 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  。。。。你们都是共犯，哈哈。    \n     2012-10-12 23:04 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @瘦蛟舞 哎。。。。。他们的回复真让这些白帽子心寒啊。。。。。    \n     2012-10-12 23:04 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @风萧萧 亲，你是不是连@xsser都不相信了？哈哈    \n     2012-10-12 23:06 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  楼上的两位，你们这是在基情……不要单独回复，虽然我也能看见。。    \n     2012-10-13 06:08 |    \t\t邪少 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:7        )\t\t \n  厂商回复： 1.攻击步骤能不能别这么详细，你这是教唆……    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}