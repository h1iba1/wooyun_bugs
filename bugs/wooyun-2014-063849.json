{"id": 2748, "wybug_id": "wooyun-2014-063849", "wybug_title": "59互联可登录任意VPS控制面板", "wybug_corp": "59互联", "wybug_author": "zcgonvh", "wybug_date": "2014-06-07 09:32", "wybug_open_date": "2014-07-23 21:58", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-23：\t细节向公众公开  简要描述： 由于某处未验证vps的所有者，导致可以登录任意VPS控制面板，进行重置密码/重装系统等操作。测试了两个vps，证明可登录控制面板后即退出，未进行任何其他操作。 详细说明：  59互联的VPS控制面板登录地址为：http://cp.dns-china.com/vpsadm/，在vps管理页面可以获取到控制面板的登录密码。控制面板的登录名为vps+ip后六位，例如ip为XXX.XX1.23.234的登录名为vps123234。vps管理页面提供了找回密码功能，此功能将ip和管理页面url中的id提交到http://sys.59.cn/System/ajax.asp?act=getvpspass，如果成功会刷新vps管理页面的登录密码。由于未验证ip是否与当前id相对应，导致获取到任意ip的vps控制面板登录密码，再根据ip猜测登录名，即可登录vps控制面板。最后，找回密码接口未限制频率也没有验证码，vps登录页面同样没有验证码，编写脚本进行批量获取也是可行的。   漏洞证明：  这是我的vps，ip尾数为4，密码为123456：\n\n这是我的vps控制面板，云服务器名就是登录名，打码的部分与ip打码部分的数字相同：\n\n用别人vps的ip找回密码，这个ip尾数是2，操作成功：\n\n刷新自己的vps管理页面，密码已经更改为3xxxxxx2：\n\n根据ip构造vps控制面板登录名，使用之前获取的密码成功登录：\n\n   修复方案：  校验ip与id的对应关系   版权声明：转载请注明来源 zcgonvh@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-06-10 10:55 厂商回复： 该漏洞已修复，感谢白帽 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}