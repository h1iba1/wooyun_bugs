{"id": 20234, "wybug_id": "wooyun-2015-0106392", "wybug_title": "Foxmail邮箱客户端持久型XSS跨站脚本攻击漏洞（收邮件就触发）", "wybug_corp": "腾讯", "wybug_author": "sunny6", "wybug_date": "2015-04-07 16:52", "wybug_open_date": "2015-07-07 15:40", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-08：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-07：\t细节向公众公开  简要描述： Foxmail邮箱客户端持久型XSS跨站脚本攻击漏洞（收邮件就触发） 详细说明：  版本7.1测试不存在这一的漏洞7.2build 5.140存在\n\n存在跨站漏洞，对一些危险的标签未进行过滤foxmail客户端对img和script参数进行了过滤，但是对object和iframe等标签未进行过滤导致可以执行js代码   漏洞证明：  搭建一个存在XSS漏洞的邮箱服务器在正文中插入一下代码利用的XSS的POC<object data=data:text/html;base64,PHNjcmlwdD5hbGVydCgvdGVzdC8pOzwvc2NyaXB0Pg==></object>\n\n我们有foxmail打开以下收到的邮件\n\n插入的代码执行下面我们看看iframe标签<iframe src=http://www.qq.com</iframe>\n\n用foxmail客户端接受文件看一下\n\n可以直接挂马钓鱼也可以了   修复方案：  过滤危险标签   版权声明：转载请注明来源 sunny6@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-07-07 15:40 厂商回复： 感谢反馈，在官方最新版中已修复此问题，http:///win 漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-07 16:53 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  邮件客户端直接XSS，好久没见过这样的漏洞了    \n     2015-04-07 21:28 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  厉害！    \n     2015-04-07 21:59 |    \t\tsunny6 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | 安全无处不在)\t\t \n  @zeracker @疯狗 多谢狗哥，三哥捧场    \n     2015-04-08 15:43 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  应该是老版本，不过关注一下。    \n     2015-04-08 15:47 |    \t\tchock \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:15        | 今夜我们都是wooyun人，我们一定要收购长亭)\t\t \n  哇，好叼的样子，前来围观    \n     2015-04-08 15:54 |    \t\tnextdoor \t\t\t( 普通白帽子  |\t\t\t        Rank:325 漏洞数:74        )\t\t \n  感觉还会影响一大部分用户的    \n     2015-04-08 16:17 |    \t\t屠龙宝刀点击就送 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 简要介绍不能为空)\t\t \n  这种的如果客户端不强制升级肯定还会影响很大的范围的。    \n     2015-04-08 18:43 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  居然忽略了好吧    \n     2015-04-08 20:47 |    \t\tcrazykb \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | The quieter you become, the more you are...)\t\t \n  无图无真相    \n     2015-04-09 08:43 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @疯狗 不然怎么办，官方早就修复了，用户不升级，怎么处理好？强制升级？    \n     2015-04-09 09:37 |    \t\tMixes \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:19        | :))\t\t \n  foxmail还是有很多xss的    \n     2015-04-09 11:21 |    \t\tNeeke \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:24        | 求传授刷Rank方法？)\t\t \n  这个niubility    \n     2015-04-09 19:21 |    \t\tan0nym0u5 \t\t\t( 普通白帽子  |\t\t\t        Rank:172 漏洞数:31        )\t\t \n  显示公开了怎么还不能看~    \n     2015-04-09 22:17 |    \t\t′雨。 \t\t\t( 普通白帽子  |\t\t\t        Rank:1231 漏洞数:190        | Only Code Never Lie To Me.)\t\t \n  @疯狗 - -乌云为啥要把厂商回复的url地址都吃掉? 遇到几次了。    \n     2015-04-10 00:08 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  看看    \n     2015-04-10 00:20 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  放在最新公开里边。但是看不到......    \n     2015-04-10 17:57 |    \t\tnoob \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:18        | 向各位大神学习，向各位大神致敬)\t\t \n  最新公开里面不是应该看得到的么    \n     2015-04-10 18:50 |    \t\t淡蓝色の忧伤 \t\t\t( 普通白帽子  |\t\t\t        Rank:172 漏洞数:26        | 开启审计php代码模式      (⊙v⊙)嗯)\t\t \n  最新公开里面，竟然看不到。。。。。    \n     2015-04-11 00:05 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  @sunny6 刚来就这么厉害，这还了得！    \n     2015-04-11 07:45 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  没人搞outlook么    \n     2015-04-11 11:16 |    \t\tForever80s \t\t\t( 普通白帽子  |\t\t\t        Rank:820 漏洞数:110        )\t\t \n  这个客户端都是离线的邮件吧？    \n     2015-04-12 19:23 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  看到楼上的那一堆xxx 我也醉了    \n     2015-04-12 23:04 |    \t\t狂人 \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:13        | Rank:999999999 漏洞数:999999999 | 小学生...)\t\t \n  ฐ้้ฐ้้้ฐ้้้้ฐ้้้้้ฐ้้้้้้ฐ้้้้้้้ฐ้้้้้้้้ฐ้้้้้้้้้ฐ้้้้้้้้้้ฐ้้้้้้้้้้้ฐ้้้้้้้้้้้้ฐ้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้ฐ้้้้้้้้้ฐ้้้้้้้้้้ฐ้้้้้้้้้้้ฐ้้้้้้้้้้้้ฐ้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้้้ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ ฐ้้ฐ้้้ฐ้้้้ฐ้้้้้ฐ้้้้้้ฐ้้้้้้้ฐ้้้้้้้้ฐ้้้้้้้้้ฐ้้้้้้้้้้ฐ้้้้้้้้้้้ฐ้้้้้้้้้้้้ฐ้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้ฐ้้้้้้้้้ฐ้้้้้้้้้้ฐ้้้้้้้้้้้ฐ้้้้้้้้้้้้ฐ้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้ฐ้้้ฐ้้้้ฐ้้้้้ฐ้้้้้้ฐ้้้้้้้ฐ้้้้้้้้ฐ้้้้้้้้้ฐ้้้้้้้้้้ฐ้้้้้้้้้้้ฐ้้้้้้้้้้้้ฐ้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้ฐ้้้้้้้้้ฐ้้้้้้้้้้ฐ้้้้้้้้้้้ฐ้้้้้้้้้้้้ฐ้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้ฐ้้้ฐ้้้้ฐ้้้้้ฐ้้้้้้ฐ้้้้้้้ฐ้้้้้้้้ฐ้้้้้้้้้ฐ้้้้้้้้้้ฐ้้้้้้้้้้้ฐ้้้้้้้้้้้้ฐ้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้ฐ้้้้้้้้้ฐ้้้้้้้้้้ฐ้้้้้้้้้้้ฐ้้้้้้้้้้้้ฐ้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้้้้้้้้้้้้้้้ฐ้้้้้้้้้้้้้    \n     2015-04-13 15:11 |    \t\tCode_Monkey \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:7        | Code Monkey think someday he have everyt...)\t\t \n  @从容 醉了    \n     2015-07-08 13:38 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:221 漏洞数:75        | Enjoy Hacking Just Because It's Fun :)  ...)\t\t \n  @Code_Monkey what?    \n     2015-07-09 13:48 |    \t\t呆萌sky \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 呆萌痴傻)\t\t \n  请问一下，在客户端上怎么查看html源代码？    \n     2015-07-09 13:49 |    \t\t呆萌sky \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 呆萌痴傻)\t\t \n  @sunny6 请问一下，在客户端上怎么查看html源代码？    \n     2015-07-10 01:45 |    \t\t#6c6c6c \t\t\t( 普通白帽子  |\t\t\t        Rank:291 漏洞数:47        | 像一条狗孤独的活着，渴望的活着，绝望的活...)\t\t \n  @呆萌sky 他那应该是在网页端看的吧，    \n     2015-07-13 14:00 |    \t\t呆萌sky \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 呆萌痴傻)\t\t \n  @#6c6c6c 感觉客户端和网页端是不是应该不一样    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}