{"id": 9602, "wybug_id": "wooyun-2013-033387", "wybug_title": "任意用户密码重置之ELLE中国", "wybug_corp": "ellechina.com", "wybug_author": "niliu", "wybug_date": "2013-08-03 12:38", "wybug_open_date": "2013-09-17 12:39", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当", "认证设计不合理", "设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-17：\t细节向公众公开  简要描述： 设计缺陷... 详细说明：  问题出在ELLESHOP...由于是购物站，所以危害还是比较大的...\nhttp://www.elleshop.com.cn/women.shtml\n登陆是点忘记密码，来到密码找回页面...\nhttp://passport.elleshop.com.cn/getpassword.aspx###\n\n\n选择手机找回密码，点获取手机校验码，系统给目标手机发送一个6位数的验证码...由于提交时没有验证码，导致可以对校验码进行破解...随便写个校验码'111111'提交时抓包...\n\n对校验码ConfirmKey参数进行破解...\n\n得到真实的验证码...填入得到的验证码提交，发现验证码已经失效，原来验证码有效性只有一次...\n\n继续返回去，看破解验证码返回的数据包...错误验验证码返回包：\nHTTP/1.1 200 OKCache-Control: no-cachePragma: no-cacheContent-Length: 162Content-Type: application/json; charset=gb2312Expires: -1Server: Microsoft-IIS/7.5X-AspNet-Version: 2.0.50727X-Powered-By: ASP.NETDate: Sat, 03 Aug 2013 03:53:05 GMTConnection: close\n正确验证码返回包：\nHTTP/1.1 200 OKCache-Control: no-cachePragma: no-cacheContent-Length: 179Content-Type: application/json; charset=gb2312Expires: -1Server: Microsoft-IIS/7.5X-AspNet-Version: 2.0.50727X-Powered-By: ASP.NETDate: Sat, 03 Aug 2013 03:53:05 GMTConnection: close<input id=\"prompttype\" type=\"hidden\" value=\"validated\" /><div id=\"messinfo\">        </div><input id=\"token\" type=\"hidden\" value=\"9a50a3a**********2b5c2d3\" />\n发现一段md5加密的code...感觉应该跟找回密码有关，于是又用邮箱找回密码，收到邮件如下...\n\n于是组合重置密码连接：\nhttp://passport.elleshop.com.cn/setnewpassword.aspx?token=\n + \n9a50a3a**********2b5c2d3\n（正确验证码返回包中value的值）即可重置用户密码！   漏洞证明：  如上...   修复方案：  提交时加验证码防止爆破...求礼物！求高rank！   版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-08-03 18:37 厂商回复： 感谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-03 13:11 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  你这是刷rank的节奏啊    \n     2013-08-03 13:19 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  希望厂商不是忽略的节奏 (⊙o⊙)…    \n     2013-08-03 13:22 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @niliu 估计是了。。。我这还有他们的一个站的shell    \n     2013-08-03 13:23 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @mango 我还有一个ELLE的没过呢    \n     2013-08-03 13:28 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @niliu  - - 不送礼物我都不提交    \n     2013-08-03 13:31 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @mango 不知道这次有没有礼物啊     \n     2013-08-03 13:33 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @niliu  - -估计悬    \n     2013-08-03 13:37 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @mango 别忽略就知足了    \n     2013-08-03 13:46 |    \t\t360安全卫士 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 360安全卫士就是好)\t\t \n  应该不会忽略！    \n     2013-08-03 14:02 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  @360安全卫士  - -我以为是厂商呢    \n     2013-08-03 14:04 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @360安全卫士 太唬人了...    \n     2013-08-03 14:10 |    \t\t360安全卫士 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 360安全卫士就是好)\t\t \n  @niliu @mango 呵呵！新人多多指导！    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}