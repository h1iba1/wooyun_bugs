{"id": 1351, "wybug_id": "wooyun-2014-065448", "wybug_title": "Discuz某默认插件存在本地文件包含漏洞（需后台配置权限可拿shell）", "wybug_corp": "Discuz!", "wybug_author": "Net4ky", "wybug_date": "2014-06-19 10:47", "wybug_open_date": "2014-09-17 10:48", "wybug_type": "文件包含", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["文件包含漏洞", "文件包含漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-22：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-17：\t细节向公众公开  简要描述： 18号更新了程序 所以我们首当其冲的先来检测检测 详细说明：  \n\n看见木有有个微信登陆功能漏洞也出现在这里无截断  所以不鸡肋接下来看代码文件在source\\plugin\\wechat\\wechat.class.php\nstatic public function redirect($type) {\t\tglobal $_G;\t\t$hook = unserialize($_G['setting']['wechatredirect']);\t\tif (!$hook || !in_array($hook['plugin'], $_G['setting']['plugins']['available'])) {\t\t\treturn;\t\t}\t\tinclude_once DISCUZ_ROOT . 'source/plugin/' . $hook['plugin'] . '/' . $hook['include'];\t\tif (!class_exists($hook['class'], false)) {\t\t\treturn;\t\t}\t\t$class = new $hook['class'];\t\tif (!method_exists($class, $hook['method'])) {\t\t\treturn;\t\t}\t\t$return = $class->$hook['method']($type);\t\tif($return) {\t\t\treturn $return;\t\t}\t}\n对discuz有了解的人都知道它的$_G这个变量 他的$hook怎么来的我就不多说了if判断了$hook['plugin'] 所以$hook['plugin']必须是'wechat','pcmgr_url_safeguard','mobile'其中一个至于$hook['include']嘛   你懂得~~~~unserialize($_G['setting']['wechatredirect'])反序列化 所以我们就要填入序列化的值\n\n   漏洞证明：  \n\n   修复方案：  呵呵二字  留下无限遐想~~~~~~   版权声明：转载请注明来源 Net4ky@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2014-06-19 12:04 厂商回复： 感谢您提供的信息，我们会尽快予以处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-19 11:33 |    \t\t麻花藤 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:1        | ด้้้้้็็็็็้้้้้็็็็...)\t\t \n  二楼要怀孕ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็    \n     2014-06-19 14:20 |    \t\t1fn0 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:7        | 我是运维 不要开除我)\t\t \n  ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็我来插一楼    \n     2014-06-22 18:18 |    \t\t邪恶大咖 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        )\t\t \n  ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็ 这是神马东东？    \n     2014-06-22 22:08 |    \t\t切克脑 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:9        | z..)\t\t \n  卧槽..什么东西    \n     2014-06-22 22:09 |    \t\t切克脑 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:9        | z..)\t\t \n  ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็     \n     2014-07-06 15:14 |    \t\t浩森 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:6        )\t\t \n  http://www.xxx.com/plugin.php?id=milu_seotool:sitemap&myac=../../robots.txt%00  说的是这个吗    \n     2014-07-09 17:28 |    \t\tdarkrerror \t\t\t( 普通白帽子  |\t\t\t        Rank:263 漏洞数:44        )\t\t \n  这是啥？： \"ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็\"    \n     2014-09-11 21:25 |    \t\tpigzhu \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 网络共享！)\t\t \n  前排！！！    \n     2014-09-17 10:52 |    \t\t10457793 \t\t\t( 普通白帽子  |\t\t\t        Rank:867 漏洞数:128        | 说好的借，为什么从来不还？O(∩_∩)O)\t\t \n  对于我等小白 没有详细利用方法就是扯淡 能不能把参数和利用方法贴出来 别贴图片 谢谢 谢谢    \n     2014-09-17 10:53 |    \t\t乌云最帅的淫 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:23        | 不以淫荡惊天下,就以闷骚动世人)\t\t \n  ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็   这是啥     \n     2015-06-18 10:44 |    \t\t纳米翡翠 \t\t\t( 普通白帽子  |\t\t\t        Rank:316 漏洞数:42        | 翡翠虽小、价值极高，追求极致、共建安全)\t\t \n  ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็็็ด้้้้้็็็็็้้้้้็็    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}