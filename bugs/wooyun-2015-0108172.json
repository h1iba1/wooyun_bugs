{"id": 33723, "wybug_id": "wooyun-2015-0108172", "wybug_title": "湖南大学教学服务系统资料备份链接泄漏+SQL注入+getshell", "wybug_corp": "hnu.cn;www.hnu.edu.cn", "wybug_author": "孔卡", "wybug_date": "2015-04-16 10:10", "wybug_open_date": "2015-06-02 09:50", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露", "错误信息未屏蔽"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-02：\t细节向公众公开  简要描述： 一个小小的资料泄露引发N多账号密码+毕业生信息泄露+进去后又发现SQL注入点+物理路径爆出==最终getshell 一个馒头引发血案啊！！！！ 详细说明：  首先 扫对方的教务系统 扫出一个备份链接  如下\nhttp://hdjw.hnu.cn/p.rar\n  118.83MB一共 下载后包含2部分  学生照片+txt格式学生个人信息 下面截图证明\n\n\n\n好吧 目前为止问题似乎还不是那么严重~~~~~~~我们分析txt中任意一条信息 举例吧\n20111402224\t贺正池\t2011\t生物学院\t李达生物科学\t2011李达生物班\t511028199203013230\t四川省\n20111402224是学号  而按照我大学时期，一般大家喜欢把身份证后6位设置成密码 我们试下 这里就是013230OK，进来了~~~~~~~\n\n注意看，住址，电话什么的都有了---可以用于诈骗家里父母，或者毕业生找工作诈骗等等如果这里还感觉不严重的话，我们继续-----手贱乱点了一下，爆出物理路径了\n\n\nD:\\KINGOSOFT\\KINGOJOGL\\JOWEB\\_data\\RULE\\CJ_GLGD.xml\n好吧，信息先留着，继续深入下，点击查询成绩，然后抓包\nPOST /xscj/Stu_MyScore_rpt.aspx HTTP/1.1Accept: application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, */*Referer: http://hdjw.hnu.cn/xscj/Stu_MyScore.aspxAccept-Language: zh-CNUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET4.0C; .NET4.0E; InfoPath.3)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: hdjw.hnu.cnContent-Length: 91Proxy-Connection: Keep-AlivePragma: no-cacheCookie: ASP.NET_SessionId=hljjhkulwrejdo55inmags45SJ=1&sel_tntx=201100004689&btn_search=%BC%EC%CB%F7&SelXNXQ=0&txt_xm=201100004689&zfx_flag=0\n用sqlmap跑一下看看----\n\n好吧  txt_xm 这个参数可以注入\n\nIIS6.0 。。。。配合物理路径能getshell 不用解释了吧 算了~~~~到此为止，没有传shell和提权    漏洞证明：  见详细说明，不再赘述   修复方案：  1.首先尽快删除p.rar2.叫txt里涉及的一票同学们改下密码？3.过滤问题参数，把注入漏洞补上先，又是湖南青果软件，问下有木有补丁什么的。。。   版权声明：转载请注明来源 孔卡@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-04-18 09:49 厂商回复： 确认 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-16 13:22 |    \t\t孔卡 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:12        | 我已经过了那个餐桌上只有一条鸡腿就一定能...)\t\t \n  ~—~ 估计是被忽略的节奏，今年这个厂商就没给过rank，估计是换人了？    \n     2015-04-17 08:53 |    \t\t湖南大学(乌云厂商)\t\t \n  确认，并尽快修复    \n     2015-06-02 19:20 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  这是入驻了吗    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}