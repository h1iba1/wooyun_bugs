{"id": 87300, "wybug_id": "wooyun-2016-0196634", "wybug_title": "中关村在线网上商城设计缺陷可登录任意账户(外送注册任意手机号/短信炸弹)", "wybug_corp": "中关村在线", "wybug_author": "杨某某", "wybug_date": "2016-04-15 17:48", "wybug_open_date": "2016-05-30 21:20", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-30：\t细节向公众公开  简要描述： 中关村在线网上商城设计缺陷可登录任意账户(外送注册任意手机号/短信炸弹) 详细说明：  1.登陆任意账户1.1首先是用户注册界面\n\n在输入手机号后，鼠标焦点转移到其它输入框，此时网页会发送一个ajax请求，验证手机号是否注册：\n\n\n\n手机号已注册返回flag为0，未注册flag为1可以burp暴力跑出已注册手机号1.2登陆处\n管理补充：任意账号登录1.先输入自己的手机号，接收验证码2.替换要登录的手机号3.将自己手机号收到的验证码输入，即可登录他人账号\n有两种登陆方式，我们选手机验证码登陆\n\n这里填我们自己的手机号，收到验证码后，把手机号改为前一步跑出的已注册用户，验证码用我们收到的，成功登陆：\n\n2.注册任意用户上一个洞第二步，如果输入未注册的手机号，登陆，系统会默认这次登陆行为等同为注册，通过1.1的步骤可以证明：\n\n登陆前，显示为未注册\n\n登陆后，手机号已注册，手机号原主人无法注册了3.短信炸弹：还是登陆处，这里对发送验证码做了两个限制：\n\n1.限制发送周期2.需要填写手机号和正确的验证码这里的两个限制并不能杜绝短信炸弹：1.在js里限制发送周期是没用的，包重放就绕过了2.验证码在生命周期内可以反复使用如图：\n\n\n\n   漏洞证明：  \n\n\n\n   修复方案：  1.验证码和手机号绑定，而不是一段时期内有效2.在服务端限制验证码发送周期3.这一点可以参考是否正确：不要在收入手机号后就显示是否已注册，这点同样可以用在账号，银行卡号等上面，只有在点击注册后才能知晓结果，并且该注册操作要防范包重放攻击，毕竟正常用户不会用别人的手机去注册，所以也对用户体验影响个人认为不大   版权声明：转载请注明来源 杨某某@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-04-15 21:12 厂商回复： 已经修复，谢谢检测。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-04-15 17:50 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:925 漏洞数:80        | 哈！躁起来！)\t\t \n  鞭打研发小屁屁    \n     2016-04-15 22:21 |    \t\t杨某某 \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:35        | 魂之挽歌)\t\t \n  多谢浩天大神补充，我那部分是表述得不太清楚    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}