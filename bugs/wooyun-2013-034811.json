{"id": 62664, "wybug_id": "wooyun-2013-034811", "wybug_title": "爱丽网某分站client-ip处SQL注射一枚", "wybug_corp": "aili.com", "wybug_author": "雨夜", "wybug_date": "2013-08-20 17:00", "wybug_open_date": "2013-10-04 17:01", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-04：\t细节向公众公开  简要描述： 爱丽网某分站存在header注入 详细说明：  /p/目录下的所有页面都存在header注入，目测gpc和过滤都不起作用如\nGET /p/%BC%D3%C2%A1%CF%C8%C9%FA HTTP/1.1user-agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)client-ip: 192.168.1.1Referer: http://member.aili.com:80/Cookie: PHPSESSID=ed4b3c8d7b44bc427fbb3ec757bcce52....Host: member.aili.comConnection: Keep-aliveAccept-Encoding: gzip,deflateAccept: */*\ncookie请自行补全，问题出在header中的client-ip: 192.168.1.1上了，输入单引号看一下\n\n在其他原注入点如果输入单引号是会被转义的，但是header中却没有做过滤，估计是PHP版本比较低引起的   漏洞证明：  \n\n上图可以看出是一条SELECT语句和一条insert语句引起的注入，我们只要构造好其中一条语句就可以拿到我们想要的东西，但是我实在懒得去仔细搞了，注意看图中的SQL语句都没有被过滤。   修复方案：  修复吧，求礼物   版权声明：转载请注明来源 雨夜@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-08-20 17:02 厂商回复： 20 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-21 20:22 |    \t\tSct7p \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 懂与不懂之间只隔了一层纸，懂的人会觉得很...)\t\t \n  又是20RANK     \n     2013-11-06 16:30 |    \t\t绝情刀 \t\t\t( 普通白帽子  |\t\t\t        Rank:132 漏洞数:24        | .)\t\t \n  @雨夜。这种注入是怎么被发现的，貌似很少见    \n     2013-11-06 16:49 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @绝情刀 抓包看参数，然后试试http头！    \n     2013-11-06 16:52 |    \t\t绝情刀 \t\t\t( 普通白帽子  |\t\t\t        Rank:132 漏洞数:24        | .)\t\t \n  @小胖子 那不是很难难难难找！    \n     2013-11-06 16:53 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @绝情刀 可遇不可求！    \n     2013-11-06 16:53 |    \t\t绝情刀 \t\t\t( 普通白帽子  |\t\t\t        Rank:132 漏洞数:24        | .)\t\t \n  @小胖子 难道@雨夜是你马甲！还是你发现了我什么    \n     2013-11-06 16:54 |    \t\t绝情刀 \t\t\t( 普通白帽子  |\t\t\t        Rank:132 漏洞数:24        | .)\t\t \n  @小胖子 soga。靠rp啊    \n     2013-11-06 21:33 |    \t\t雨夜 \t\t\t( 普通白帽子  |\t\t\t        Rank:207 漏洞数:30        | 别和我谈感情，太伤钱……)\t\t \n  @绝情刀 躺枪了……    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}