{"id": 44047, "wybug_id": "wooyun-2015-094681", "wybug_title": "Umail邮件系统存在后门xss漏洞成功实现劫持帐号获取信息", "wybug_corp": "Umail邮件系统", "wybug_author": "路人甲", "wybug_date": "2015-01-30 09:15", "wybug_open_date": "2015-05-05 08:22", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "黑盒测试技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-07：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-05：\t细节向公众公开  简要描述：    Umail邮件系统多为政府部门在使用，安全检查了一次，发现存在后门漏洞，实现劫持帐号。 详细说明：     Umail邮件系统多为政府部门在使用，安全检查了一次，发现存在后门漏洞，实现劫持帐号。    测试网站：http://mail.jxgzw.gov.cn/webmail/    测试帐号\"1\"：lijian@jxgzw.gov.cn    测试帐号\"2\"：chendi@jxgzw.gov.cn     首先登录测试帐号\"1\"：此处只做友情测试，里面信件没做变动。登录测试帐号\"1\"之后，点击\"选项\"-->\"个人资料\"，在里面\"中文名\"输入框里面填写后门代码：1111<title><img src=\"</title><img src=x onerror=alert(2)//\">，后保存，如图： \n\n   之后选择写信，给测试帐号\"2\"，写一封信件，登录测试帐号\"2\"，打开信件后，点击\"回复\" 或者点击\"回复所有\" 或者点击\"转发\"都可以实现xss弹框效果，如图： \n\n   但是这个距离我们要的劫持还有差距，我们关掉这封信，重新来写一封信，我们点击\"写信\"按钮，此时亮点出现如图(下图中的发件人处的代码是仿照上面继续埋的后门)： \n\n   也就是说，我们无论给谁发信，当我们点击\"写信\"按钮的时候就能触发xss漏洞，从而实现对对测试帐号\"2\"的劫持，从而将测试帐号\"2\"的cookie信息回传到攻击者的后台。    因为只是进行劫持测试，故对埋设的后门代码不做隐藏化处理，具体利用的回传cookie的js代码只需要在onerror事件后面添加上即可，安全起见，这里不做编写。   漏洞证明：     修复方案：       对个人资料处做防御xss攻击处理。避免执行后门代码。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-02-04 08:21 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-30 11:50 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  这个后门二字感觉有点歧义呢    \n     2015-01-30 12:56 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @疯狗 哈哈，怎么没给改标题    \n     2015-02-04 13:26 |    \t\tAno_Tom \t\t\t( 普通白帽子  |\t\t\t        Rank:368 漏洞数:40        | Talk is cheap.:)\t\t \n  脚本监控显示这个路人甲是U神 @U神    \n     2015-02-04 14:38 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:142        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @Ano_Tom 你的脚步好厉害！    \n     2015-05-05 10:04 |    \t\tDark4ce \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:4        )\t\t \n  http-only的话,还能传回cookie????    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}