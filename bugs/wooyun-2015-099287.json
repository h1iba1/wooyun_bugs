{"id": 37626, "wybug_id": "wooyun-2015-099287", "wybug_title": "通用型酒店系统存在高危越权和DBA权限SQL注入漏洞", "wybug_corp": "广州市问途信息技术有限公司", "wybug_author": "路人甲", "wybug_date": "2015-03-05 16:35", "wybug_open_date": "2015-06-08 14:18", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-13：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-04：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-14：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-24：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-08：\t细节向公众公开  简要描述： 越权和SQL注入漏洞，影响国内近200酒店业务 详细说明：  危害参见： WooYun: 一个漏洞沦陷至少全国各地170家酒店及酒店集团（可查开房信息，国庆你还开房吗） 1. 首先介绍下公司名称： 广州市问途信息技术有限公司网址：http://www.wintour.cn/介绍：中国酒店业最为专业的网络营销技术公司,运用互联网技术提升酒店收益,为酒店打造网络直销及客户服务平台以及酒店网络营销服务。包括酒店官方网站,多渠道预订引擎,客户会员营销管理系统,智能手机客户端和社会性媒体营销管理系统等。keywords：酒店网络营销,酒店网站,酒店网站建设,酒店在线直销,酒店移动互联网营销,智能手机客户端,收益管理系统,预订引擎,微博营销,酒店会员管理,酒店,酒店网站开发,移动营销常客计划2. 客户群官网有一些最新的客户案例，如图\n\n当然这只是一部分，根据官网的案例，得到关键字：技术伙伴:问途酒店网络营销顾问 html, 因为该公司之前好像有做过一套aspx的系统，新系统是php + mysql的，所以加上了个html，下面是搜索结果：\n\n结果不少，这里列举一些例子，证明其通用性：\n河南天地粤海酒店\thttp://www.skyland-hotel.com/博鳌和悦海景度假酒店\thttp://www.holliyardhotel.com/青岛CHINA公社\thttp://www.chinagongshe.com/河源市龙源温泉大酒店有限公司\thttp://www.lyhotspring.com/成都天府阳光\thttp://www.tfsunshinehotel.com/英德仙湖温泉度假区\thttp://www.singwood.com.cn/上海御庭集团\thttp://www.rhgresorts.com/首旅酒店集团\thttp://www.btghotels.com/首旅建国酒店管理有限公司\thttp://www.hotelsjianguo.com/成都钓鱼台精品酒店\thttp://www.dytchengdu.com/君廷国际酒店集团\thttp://www.baronyhotels.com/广东欧亚企业管理集团有限公司 \thttp://www.ouyahotels.com/湖南湘投阳光集团有限公司\thttp://www.hnsunshinegroup.com/厦门建发旅游集团股份有限公司 \thttp://cndhotels.com/粤海集团\thttp://www.gdhhotels.com/通程国际酒店管理有限责任公司\thttp://www.dolton-hotels.com/奥园养生酒店\thttp://www.aoyuanhealthhotel.com/凯荣都国际酒店\thttp://www.krdhotel.com/上海久阳滨江酒店\twww.eversunshinehotel.com/昆泰嘉华酒店\thttp://www.kuntairoyalhotel.com/广州远洋宾馆\thttp://www.oceanhotel.com.cn/广东东方国际饭店\thttp://www.mandarinhotelgd.com/get_password.html青海兴鼎安大酒店\thttp://www.xingdingan.com/get_password.html三亚柏瑞精品海景酒店\thttp://www.sanyabarry.com/get_password.html南沙奥园养生酒店\thttp://www.aoyuanhealthhotel.net/special_offer_3.html广州鸣泉居度假村\thttp://www.mqjgz.cn/get_password.html昆山新港湾大酒店\thttp://www.ksnewporthotel.com/get_password.html广东东方国际饭店\thttp://mandarin-hotel.com.cn/get_password.html北京应物会议中心\thttp://hy.yingwu.com.cn/get_password.html北大荒国际饭店\thttp://www.ebdh-hotel.com/get_password.html三亚中亚国际大酒店\thttp://www.joyahotel.com.cn/get_password.html常州九洲环宇\thttp://www.eco-hotel.com.cn/get_password.html广州逸林假日酒店\thttp://www.easelandhotel.com/get_password.html广东亚洲国际大酒店\thttp://www.aihotel.com/get_password.html桂林桂山华星酒店\thttp://www.guishanhotel.com/get_password.html嘉鸿华美达\thttp://www.ramadaplazagz.com/get_password.html深圳求水山酒店\thttp://www.qsshotel.com/get_password.html最佳西方武汉五月花大酒店\thttp://www.bwmayflowers.com.cn/get_password.html常州福记逸高酒店\thttp://www.happiness-hotel.com/苏州市冠云大酒店\thttp://www.glamorhotel.com/get_password.html三亚宝宏大酒店\thttp://www.baohonghotel.com/get_password.html五指山亚泰雨林度假酒店\thttp://www.wuzhishanyatai.com/get_password.html广州威尼國际酒店\thttp://www.vilihotel.com/get_password.html四会岭南东方酒店\thttp://www.lndfhotel-sh.com/get_password.html海南亚泰温泉酒店\thttp://www.hainanyataihotel.com/get_password.html佛山铂顿国际公寓\thttp://www.jbstel.com/get_password.html青城（豪生）国际酒店\thttp://www.87198677.com/get_password.html三亚湾玛格瑞特酒店\thttp://www.margaretresort.com/get_password.html江苏省南通市文峰饭店\thttp://www.wenfenghotel.com/get_password.html福州永泰香米拉温泉酒店\thttp://www.ytxml.com/get_password.html华北电力大厦\thttp://www.hbdlds.com/get_password.html北京四川五粮液龙爪树宾馆\thttp://www.lzshotel.com/get_password.html广东裕通大酒店有限公司\thttp://www.gdyutonghotel.com/get_password.html金燕国际温泉酒店\thttp://www.jinyanhotspring.com/login.html山东良友富临大酒店\thttp://www.sdlyfl.com/get_password.html红星剧院\thttp://www.xn--cerp49b31r6wv.com/member_forget.html\n   漏洞证明：  一、SQL注入漏洞：1.http://www.skyland-hotel.com/ 先注册账户，然后预定一个房间取消订单处抓包\n\nsqlmap：\n\n查看敏感信息\n\n2.http://www.holliyardhotel.com/ 取消订单处抓包如下：client_account存在注入\nGET /saas/Booking/cancelOrder/?jsoncallback=jQuery183014082620618864894_1425371096398&client_account=qh_hyhj&language=zh-cn&order_id=2225&_=1425371187541 HTTP/1.1Host: www.holliyardhotel.comProxy-Connection: keep-aliveAccept: text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01X-Requested-With: XMLHttpRequestUser-Agent: Mozilla/5.0 (Windows NT 6.2; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2214.94 Safari/537.36Referer: http://www.holliyardhotel.com/room_reservation.html?start_date=1425312000000&end_date=1425398400000&res_total=1Accept-Encoding: gzip, deflate, sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: PHPSESSID=rlcitg4pa3rlof58mrl51l3m24; _gat=1; think_language=zh-cn; _ga=GA1.2.994985118.1425371021; checkCookie=check\n\n\n3.http://www.chinagongshe.com/同上，也是client_account存在注入\n\n4.http://www.tfsunshinehotel.com/同上，也是client_account存在注入\n\n... ...注入通用型证明上述4例二、越权删除和查看别人订单：http://www.chinagongshe.com/为例，注册两个号王某和李某http://www.chinagongshe.com/order_info.html?order_no=00010459 订单号遍历可看别人的信息\n\n越权的删除订单王某和李某都有一个订单\n\n\n\n用王某的账户删除订单抓包，修改466为464\n\n成功删除李某订单\n\n其它的危害：邮件和短信炸弹\n\n   修复方案：  过滤注入点越权处session验证   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2015-03-10 14:16 厂商回复： CNVD确认并复现所述情况，目前还在尝试建立与软件生产厂商的直接处置渠道，待进一步完成处置流程。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}