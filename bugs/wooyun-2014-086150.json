{"id": 48953, "wybug_id": "wooyun-2014-086150", "wybug_title": "暴风某站WebShell泄露大量信息&amp;&amp;疑似可修改客户端视频接口", "wybug_corp": "暴风影音", "wybug_author": "pangshenjie", "wybug_date": "2014-12-06 16:42", "wybug_open_date": "2014-12-11 16:44", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-12-11：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 弱口令引发的血案。疑似可影响暴风影音客户端。 详细说明：  Ucenter弱口令：bbs.shouji.baofeng.com/uc_serveradmin\n\n可获取webshell。拿shell的过程就不说了。\n\n在/opt/modu***/nginx/conf/nginx.conf文件中看了下nginx的配置：\nlisten              80;         root                /opt/live;         server_name 127.0.0.1 img.shouji.baofeng.com api.shouji.baofeng.com ipad.shouji.* iphone.shouji.* live.shouji.baofeng.com;\n看到还绑了几个其他域名，从域名判断应该是客户端的一些api继续找数据库配置文件：\n/opt/thu***/settings.py:conf = {}conf['cover-db'] = 'live'conf['cover-host'] = '192.168.1.78'conf['cover-port'] = 27017conf['cover-user'] = ''conf['cover-pwd'] = ''conf['replicaset'] = 'rs0'conf['timeout'] = 5000if USE_TEST_MONGO:    conf[\"host\"] = \"192.168.1.144\"    conf[\"cover-user\"] = None    conf['cover-pwd'] = Noneelse:    conf[\"cover-user\"] = \"live_**\"    conf['cover-pwd'] = 'live_****ongodb'    if PRODUCTION:        conf['cover-host'] = \"192.168.2.15\"    else:        conf['cover-host'] = \"114.112.82.15\"\n尝试用得到的密码连了下公网的那个mongodb：\n\n吓尿，看起来是设置视频直播源的db，可修改台标cover_url、视频地址live_urlcover_url http://i0.letvimg.com/phone/201208/17/201208171335166961.pnglive_url:http://live.gslb.letv.com/gslb?stream_id=zhejiang&tag=live&ext=m3u8&sign=live_phone继续看了下，/opt/live/****/settings.py 找到另一处配置文件：\nDATABASES = {    'default': {        'ENGINE': 'django.db.backends.mysql', # Add 'postgresql_psycopg2', 'mysql', 'sqlite3' or 'oracle'.        'NAME': 'live',                      # Or path to database file if using sqlite3.        'USER': 'live***',        'PASSWORD': 'ndi1T****',        'HOST': '192.168.3.6*',                      # Empty for localhost through domain sockets or '127.0.0.1' for localhost through TCP.        'PORT': '3306',                      # Set to empty string for default.    }}\n可成功连接：\n\n\n\n视频数量也很大，通过表结构，发现这个数据库可控制http://live.shouji.baofeng.com/live/channel_detail/?channel_id=16&os_version=ipad&bf_version=3.6.5 这个接口的信息。同样的还有api.shouji.baofeng.com 等api的返回。可以YY一下，这个地方改一下，就要上头条了。   漏洞证明：  \n\n\n\n\n\n\n\n   修复方案：  改密码。过程获取的所有信息已删除。   版权声明：转载请注明来源 pangshenjie@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-12-11 16:44 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-12-06 19:22 |    \t\tRainShine \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:4        )\t\t \n  卧槽，那不是helen的Webshell么？    \n     2014-12-09 10:10 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  @RainShine 吓尿。    \n     2014-12-11 19:26 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  @暴风影音 无影响？呵呵    \n     2014-12-11 19:30 |    \t\tdir \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | http://www.wooyun.org/)\t\t \n  @暴风影音 无影响？？？节操何在？？？    \n     2014-12-11 19:32 |    \t\t小鸡鸡 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:10        )\t\t \n  @pangshenjie 怎么拿的shell    \n     2014-12-11 20:01 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  @小鸡鸡  WooYun: Discuz UC_Server 本地文件包含漏洞（有条件限制）    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}