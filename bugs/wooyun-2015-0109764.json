{"id": 44312, "wybug_id": "wooyun-2015-0109764", "wybug_title": "买卖宝设计不当可重置任意用户密码", "wybug_corp": "www.mmbao.com", "wybug_author": "千斤拨四两", "wybug_date": "2015-04-23 10:04", "wybug_open_date": "2015-04-28 10:06", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "客户端程序设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 看来各种重置密码漏洞，心动的也想挖一下，真的很辛苦啊，给过了吧 详细说明：  先是自己申请一个买卖宝账户，用来测试，可是万万没想到的是，网站在设计方面是漏洞百出，那就一点一点从小问题来说吧！0x1：在申请的用户里，用户若是修改账户账户密码或是绑定手机，邮箱，午休输入旧密码即可修改，所以在第一步的验证输入旧密码犹如虚设！这里我都已经绑定好了，手机，邮箱，可以看到需要手机验证，但是直接输入第二步的URL，直接修改密码！\n\n\n\n在刚开始需要绑定手机和邮箱时需要旧密码验证，方法同上，直接找到绑定地址即可，不在赘述！0x2：网站存在一些尚未实现的功能，譬如说绑定了邮箱，邮箱收到修改密码的地址，却说失效，不能修改密码，这些是小问题，关键是可以通过忘记密码功能修改原来账户绑定的手机号，邮箱，从而重置任意用户密码！\nhttp://user.mmbao.com/findPassword.html\n我们就用admin来做测试吧!\n\n可以看到admin没有设置任何绑定方式，需要联系客服，但是我们这里可以绑定任意手机，邮箱，但是邮箱功能不能使用，就通过绑定手机，修改密码吧！\n\nbrupsuite截断，可以看到memberphone，memberemail值是空的，在memberphone添加要绑定的手机号，就我我自己的吧！\n\n放行即可，就可以看到发送验证码的页面！\n\n发送验证码，输入验证码之后就能到修改密码的页面！\n\n密码修改成了：wooyun123\n\n   漏洞证明：  0x3：这里就是说到任意修改用户绑定的邮箱，手机号！用测试账户douba！\n\n可以看到初始时设置的邮箱是3***9@qq.com，现在提交数据截断修改membermail的值！\n\n修改成了9*****8@qq.com，放行看下结果!\n\n这个时候我修改的休想回收到一个链接，点击链接，就会绑定到新的邮箱上！\n\n但点开链接并不会出现重置密码的页面而是链接失效！\n\n现在我们重复上上面的过程看看绑定成功没！\n\nOK，测试成功！   修复方案：  挖了那么久，过程写的也是蛮拼的，求给良心rank给过啊！修补方案啊，重新构造修改密码框架吧！   版权声明：转载请注明来源 千斤拨四两@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-04-28 10:06 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 2015-05-12：远东买卖宝网络科技有限公司公司网站，非我司（无锡买卖宝信息技术有限公司）网站：mmb.cn  ", "replys": "漏洞评价：\n评论\n     2015-04-29 08:54 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  不仅仅存在这个问题    \n     2015-04-29 09:47 |    \t\t千斤拨四两 \t\t\t( 普通白帽子  |\t\t\t        Rank:510 漏洞数:88        | 是时候表演真正的技术了。。。)\t\t \n  @BMa 还有撒问题？    \n     2015-04-29 13:53 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @千斤拨四两  WooYun: 买卖宝任意密码重置/管理员账号演示    \n     2015-05-04 12:35 |    \t\tHax0rs \t\t\t( 路人 |\t\t\t        Rank:9 漏洞数:4        | Hax0rs)\t\t \n  还有其他问题，你们信吗    \n     2015-05-04 13:43 |    \t\t千斤拨四两 \t\t\t( 普通白帽子  |\t\t\t        Rank:510 漏洞数:88        | 是时候表演真正的技术了。。。)\t\t \n  @BMa admin我已经证明过了，为撒还能给你过了，无语。。。    \n     2015-05-04 14:43 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:200        )\t\t \n  @千斤拨四两 通过其他方法重置了admin的密码，为什么不能过？    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}