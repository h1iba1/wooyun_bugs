{"id": 12700, "wybug_id": "wooyun-2013-021314", "wybug_title": "从某知名厂商MIS软件逻辑缺陷谈对某工控网络的渗透 第二份案例", "wybug_corp": "国家安全生产监督管理总局", "wybug_author": "Z-0ne", "wybug_date": "2013-04-06 21:12", "wybug_open_date": "2013-05-21 21:13", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "安全意识不足", "服务权限设置不当", "权限过高", "服务配置不当", "渗透测试思路", "运维管理不当", "内部邮件地址泄漏", "数据库账户权限过高", "越权操作", "敏感操作校验不足", "敏感接口缺乏校验", "任意命令执行", "平行权限", "内部敏感信息泄露", "工业控制系统", "内部系统对外"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-04-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-04-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-05-21：\t细节向公众公开  简要描述： 本文可以作为对上文的一个补充，继续来探讨深入渗透后是否能对实体生产环境产生影响，以上2篇文章非SHOW，其旨在提醒软件厂商提高软件安全度的同时，提醒生产厂商对工业网络安全的重视，其中存在的技术问题，欢迎拍砖:-)以下敏感信息均已打码，相关系统信息将会私信给cncert。 详细说明：  接上文，我们谈到了SyncPlant中存在的越权问题，由于是单个案例不方便确认他的通用性，但根据所属公司业绩来看在多个现场工程案例中均使用了SyncPlant，特此献上第二份案例用来进行佐证，以便cncert来进行确认   漏洞证明：  1，远程WEB登录\n\n2，问题如上篇文章所提到的，在对该系统进行测试时同样存在越权\n\n\n\n\n\n3，到此我们可以继续深入，就以当前测试环境而言，系统开启了远程桌面,netstat确认安装了SQL server,web.config拿到了sa密码，接下来使用SQL扩展xp_cmdshell成功运行了系统命令，并通过转发，成功登录测试服务器\n\n4，上一篇中我们提到了Syncbase通过协议驱动采集下端的DCS等控制设备的数据为前端的WEB提供实时数据，该环境同样如此\n\n5，从该图我们可以看出DCS操作员站通过Moudbus TCP协议将数据转出与Syncbase实时通讯，并与测试服务器为同一网段。通过该图我们可以看出DCS下面二个AI DI数据块，其分别为DCS定义的模拟量输入(一般表示温度、压力、转速、电流等连续变化的量)与开关量输入（一般反馈各种仪表的开，关），此外一般还有AO（模拟量的控制信号，如连续可调的执行器开度控制），DO（控制器发出的开关控制信号），如图在此也为他们定义了相关的数据位置\n\n\n\n\n\n6，同理我们同样可以Client方式连接，此处我们使用｛#3锅炉给水流量｝进行测试，这里成功获取到了数据，此处数据显示不同是由于web刷新时间导致。\n\n\n\n7，根据当前测试环境我们可以大概判断位于192.168.0.17的DCS通过组态王等组态软件对下面的现场总线实时监 ，数据采集、报警控制等等，并使用类似第一篇中的SYNCMB通过标准的Modbus协议将数据进行转发提供给SIS等程序，与第一案例不同的是，目标网络可能没有网闸等工控网络安全隔离设备，这样一来生产环境的网络是比较危险的，站在攻击者的立场上想如果攻击者对DCS等系统进行渗透或者对数据进行下置操作，都有可能直接或者间接的威胁生产的网络安全，故到此没有继续深入。\n\n\n\n   修复方案：  联系软件厂商寻求技术支持不在公网开放内部系统   版权声明：转载请注明来源 Z-0ne@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-04-08 08:57 厂商回复： 根据白帽子提供的测试入口，CNVD在与wooyun-2013-021250相同的两个实例上复现所述情况（考虑到风险，未对在线系统内部网络进行测试）。同时根据生产厂商软件应用特征，找到另外两个实例，但在两个实例上未发现所述漏洞风险，因此通用性上暂未能进一步确认。如果白帽子有第三个案例，也可以继续提供。转由CNCERT通过正式函件向国家上级信息安全主管机构报送。两个案例均涉及在线生产系统，每个rank 20 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-06 21:57 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:134        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  学习一下    \n     2013-04-09 07:48 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  等公开    \n     2013-04-30 15:10 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:125        | 如果大海能够带走我的矮丑...)\t\t \n  这个太给力了！！    \n     2013-05-21 21:28 |    \t\tDrizzle.Risk \t\t\t( 普通白帽子  |\t\t\t        Rank:255 漏洞数:19        | You have an error in your SQL syntax; ch...)\t\t \n  很给力...    \n     2013-05-22 08:52 |    \t\tdebug \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:5        )\t\t \n  学习了    \n     2013-12-06 09:13 |    \t\t大海捞针 \t\t\t( 实习白帽子  |\t\t\t        Rank:54 漏洞数:15        | 踏清风而来)\t\t \n  苏州市江远热电有限公司 ？？？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}