{"id": 14589, "wybug_id": "wooyun-2013-016790", "wybug_title": "SKINFOOD（思亲肤）中国任意用户密码修改", "wybug_corp": "SKINFOOD（思亲肤）", "wybug_author": "px1624", "wybug_date": "2013-01-01 17:23", "wybug_open_date": "2013-02-15 17:24", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计缺陷", "漏洞", "破解", "修改密码"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-01：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-02-15：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 不知道什么时候注册了这个网站的会员（可能是以前弄qq钻吧），最近总是给我邮箱发垃圾软件，于是就点去看了下，然后忘记了自己当时注册的密码了，于是就有了下面的故事... 详细说明：  SKINFOOD（思亲肤）中国任意用户密码修改发现过程：1 输入自己用户名，点击 找回密码。\n\n2 输入自己的找回密码的邮箱，点击找回密码。\n\n3 连续给邮箱发了5次找回指令，发现新密码的组合式以字母“l”开头，加5位数字。\n\n4 登录选项中没有验证码选项，于是理论上来说可以用字典破解5位数字的组合密码。这个是我用burpsuite去暴力破解的结果，由于只有5位数字，所以只有10w中情况，一般家庭用户破解需要大概3小时，要是有几百M或者几千M的服务器的话会快很多。\n\n5 得出结论后，其他人需要破解的时候，只需知道用户名，然后随便输入密码，然后用burpsuite 抓一个登陆的post包，导入字典去暴力破解就可以了，并不需要知道找回邮箱是什么，从而达到修改任意用户密码。   漏洞证明：  看上面的图和分析过程。   修复方案：  1 登录选项添加验证码。2 最好不要直接把新密码发到用户的邮箱中，可以给发一个修改密码的链接（要有时效性的那种）。如果非要直接发新密码，也应该将密码的组成结构弄的复杂些。不知道厂商会不会忽略，或者有么有啥礼物。。。   版权声明：转载请注明来源 px1624@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}