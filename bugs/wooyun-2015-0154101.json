{"id": 81271, "wybug_id": "wooyun-2015-0154101", "wybug_title": "卖客疯手机APP侧漏用户订单等敏感数据", "wybug_corp": "卖客疯", "wybug_author": "路人甲", "wybug_date": "2015-11-22 17:11", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["应用敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-22：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2016-01-11：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： APP加密方式不严格，使得任意用户可以遍历所有其他用户订单数据！ 详细说明：  问题出在请求段这个地方：\nGET http://api.mkf.com/api.php?mkfstr=YjVhYjE3ODhhYzA4ODY0ODJlMjdhY2Q2ODZhYjg4Y2NleUp1YjNkd1lXZGxJam9pTVNJc0ltRWlP%0D%0AaUp2Y21SbGNreHBjM1FpTENKdElqb2lUM0prWlhJaWZRPT0NCg==%0D%0A&g=Api2_1_1&os=android&user_id=1**1929 HTTP/1.1Content-Length: 0Host: api.mkf.comConnection: Keep-AliveCookie: PHPSESSID=582i2of22a9gopic87595q6og1; SERVER_ID=ba73389a-30dd1cd6Cookie2: $Version=1Accept-Encoding: gzip\n从raw中可以看出存在user_id这个参数！\n\n下一步替换ID：\n\n可以看出返回值非常大!下一步我们进行解密！卖客疯使用的加密方式是2次BASE64加密，但base64加密可逆 so……\n\n\n\n解密后发现强大的结果！！从图中可以看出ordid！ 那么我们直接使用手机访问这个订单中的信息\n\n\n\n当看到这最后一张图的时候我们通过抓包软件就能抓到他的请求包。通过这个请求包我们可以使用上面的方法遍历出其他用户的订单id（orderid）然后带入以此达到看他人订单的效果。\n\n虽不知用户量多少但是可以肯定用户量绝不在少数！手写一个脚本看结果\n\n   漏洞证明：  问题出在请求段这个地方：\nGET http://api.mkf.com/api.php?mkfstr=YjVhYjE3ODhhYzA4ODY0ODJlMjdhY2Q2ODZhYjg4Y2NleUp1YjNkd1lXZGxJam9pTVNJc0ltRWlP%0D%0AaUp2Y21SbGNreHBjM1FpTENKdElqb2lUM0prWlhJaWZRPT0NCg==%0D%0A&g=Api2_1_1&os=android&user_id=1**1929 HTTP/1.1Content-Length: 0Host: api.mkf.comConnection: Keep-AliveCookie: PHPSESSID=582i2of22a9gopic87595q6og1; SERVER_ID=ba73389a-30dd1cd6Cookie2: $Version=1Accept-Encoding: gzip\n从raw中可以看出存在user_id这个参数！\n\n下一步替换ID：\n\n可以看出返回值非常大!下一步我们进行解密！卖客疯使用的加密方式是2次BASE64加密，但base64加密可逆 so……\n\n\n\n解密后发现强大的结果！！从图中可以看出ordid！ 那么我们直接使用手机访问这个订单中的信息\n\n\n\n当看到这最后一张图的时候我们通过抓包软件就能抓到他的请求包。通过这个请求包我们可以使用上面的方法遍历出其他用户的订单id（orderid）然后带入以此达到看他人订单的效果。\n\n虽不知用户量多少但是可以肯定用户量绝不在少数！手写一个脚本看结果\n\n   修复方案：  不要只是封IP，封IP现在没啥用！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评价\n     2015-12-02 22:36 |    \t\tMr Grey \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | To be or not to be,that is a question.)\t\t \n  笑而不语    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}