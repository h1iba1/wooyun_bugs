{"id": 49854, "wybug_id": "wooyun-2014-079810", "wybug_title": "国内最权威最大型期刊采编发系统Store XSS + 逻辑发送机制绕过 #2", "wybug_corp": "find.cb.cnki.net", "wybug_author": "路人甲", "wybug_date": "2014-10-26 23:01", "wybug_open_date": "2015-01-24 23:02", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-03：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-24：\t细节向公众公开  简要描述： 国内最权威最大型期刊采编发系统Store XSS + 逻辑发送机制绕过 #2 详细说明：  国内最权威最大型期刊采编发系统Store XSS + 逻辑发送机制绕过 #2http://find.cb.cnki.net/index.html中国知网的期刊协同采编系统，属于国内最权威最大的通用采编系统应用的教育类、企业类、期刊类、学术类网站无数   漏洞证明：  例举部分案例名单：\n比较法研究 钢结构 工业建筑 国际贸易问题 国际商务(对外经济贸易大学学报) 核电子学与探测技术 核科学与工程 环境工程 林业经济 农业技术经济 农业经济问题 清华大学学报（哲学社会科学） 石油教育 食品工业科技 世界汉语教学 数学的实践与认识 卫生研究 现代仪器 心肺血管病杂志 针刺研究 中国艾滋病性病 中国法学 中国考试 中国科技论文 中国运动医学杂志 中外法学 总装备部医学学报 祖国 微生物学免疫学进展 特区经济 现代医院 湛江师范学院学报 衡水学院学报 无线电通信技术 医学动物防制 河南科技 三门峡职业技术学院学报 中国水土保持 成人教育 东北农业大学学报 黑龙江交通科技 土壤与作物 微循环学杂志 吉林大学学报(医学版) 临床肝胆病杂志 中国生物制品学杂志 蚕业科学 实用中西医结合临床 大连海洋大学学报 环境保护科学 临床军医杂志 中华中医药学刊 腹腔镜外科杂志 山东理工大学学报（自然科学版） 山东行政学院学报 现代妇产科进展 中国中西医结合影像学杂志 电力学报 机械科学与技术 生殖与避孕 世界贸易组织动态与研究 中国新药与临床杂志 四川理工学院学报(自然科学版) 中国测试 英语教师 疾病预防控制通报 安庆师范学院学报(社会科学版) 安庆师范学院学报(自然科学版) 皖南医学院学报 中国学校卫生 北京工商大学学报(自然科学版) 北京工业大学学报 北京科技大学学报 北京科技大学学报（社会科学版） 北京农学院学报 学报用户安徽广播电视大学学报 安徽商贸职业技术学院学报(社会科学版) 安徽卫生职业技术学院学报 安徽行政学院学报 池州学院学报 滁州学院学报 阜阳师范学院学报(社科版) 阜阳师范学院学报(自然科学版) 北京工业大学学报（社会科学版） 北京工业职业技术学院学报 北京教育学院学报 北京信息科技大学学报(自然科学版) 福建农林大学学报(哲学社会科学版) 福建农林大学学报(自然科学版) 福建师范大学学报(哲学社会科学版) 莆田学院学报 甘肃高师学报 甘肃政法学院学报 陇东学院学报 西北成人教育学报 西北民族大学学报(哲学社会科学版) 广东石油化工学院学报 广东药学院学报 广州社会主义学院学报 嘉应学院学报 汕头大学学报(人文社会科学版) 汕头大学学报（自然科学版） 顺德职业技术学院学报 贵阳市委党校学报 贵州师范大学学报(社会科学版) 贵州师范大学学报(自然科学版) 海南医学院学报 河北大学学报(自然科学版) 河北经贸大学学报 河北科技大学学报 河北农业大学学报 河北农业大学学报(农林教育版) 河北软件职业技术学院学报 华北电力大学学报(自然科学版) 华北农学报 唐山学院学报 中国环境管理干部学院学报 河南城建学院学报 河南工业大学学报(自然科学版) 河南工业大学学报编辑部 河南科技大学学报(社会科学版) 河南科技大学学报：自然科学版 河南理工大学学报（社会科学版） 河南理工大学学报（自然科学版） 济源职业技术学院学报 洛阳师范学院学报 信阳师范学院学报(哲学社会科学版) 信阳师范学院学报(自然科学版) 大庆石油学院学报 东北农业大学学报(社会科学版) 黑龙江教育学院学报 湖北汽车工业学院学报 湖北医药学院学报 十堰职业技术学院学报 湖南工业职业技术学院学报 吉首大学学报(社会科学版) 长春教育学院学报 长春中医药大学学报 吉林大学社会科学学报编辑部 延边大学医学学报 江苏大学学报(自然科学版) 江苏大学学报:医学版 江苏经贸职业技术学院学报 无锡商业职业技术学院学报 无锡职业技术学院学报 江西蓝天学院学报 江西农业大学学报(社会科学版) 江西农业学报 大连工业大学学报 内蒙古财经学院学报 内蒙古财经学院学报(综合版) 内蒙古农业大学学报(自然科学版) 内蒙古师范大学学报(自然科学汉文版) 宁夏大学学报(人文社会科学版) 宁夏大学学报(自然科学版) 滨州学院学报 济南大学学报(社会科学版) 济南大学学报(自然科学版) 齐鲁师范学院学报 青岛农业大学学报(社会科学版) 青岛远洋船员学院学报 潍坊科技学院学报 烟台大学学报(哲学社会科学版) 山西农业大学学报(社会科学版) 太原大学学报 陕西师范大学学报(哲学社会科学版) 陕西师范大学学报(自然科学版) 西安石油大学学报(自然科学版) 西安体育学院学报 西北大学学报(哲学社会科学版) 西北大学学报(自然科学版) 延安职业技术学院学报 成都电子机械高等专科学校学报 川北医学院学报 泸州职业技术学院学报 攀枝花学院学报 四川大学学报(哲学社会科学版) 四川工程职业技术学院学报 四川烹饪高等专科学校学报 西华大学学报（自然科学版） 宜宾学院学报 天津科技大学学报编辑部 天津理工大学学报 天津师范大学学报(自然科学版) 天津中医药大学学报 现代财经(天津财经大学学报) 石河子大学学报(哲学社会科学版) 红河学院学报 云南民族大学学报(哲学社会科学版) 宁波教育学院学报 宁波职业技术学院学报 浙江艺术职业学院学报 中国计量学院学报 重庆城市管理职业学院学报 重庆交通大学学报(自然科学版) 重庆文理学院学报(社会科学版) 山西农业大学学报(自然科学版) 科技类用户视听 照明工程学报 真空科学与技术学报 中国安全科学学报 矿物学报 灌溉排水学报 果树学报 土木工程与管理学报 经济动物学报 生物数学学报 高校化学工程学报 大学数学 工业用水与废水 测绘科学 工程质量 交通节能与环保 科技创新导报 煤矿开采 农村电气化期刊社 食品与发酵工业 铁道机车车辆 铁道勘察 中国城市林业 中国科技信息 中国食品 中国食品添加剂 中国畜牧杂志 综合运输 福建建筑 机电技术 岩性油气藏 河北工业科技 物探装备 选煤技术 创新科技 河南科学 河南农业科学 机械传动 人民黄河 低温建筑技术 黑龙江科技信息 煤炭技术 饲料博览 中国马铃薯 淡水渔业 水电能源科学 系统工程 作物研究 菌物研究 工矿自动化 化学工业与工程技术 环境科技 铜业工程 聚氯乙烯 可再生能源 氯碱工业 世界海运 饲料工业 塑料科技 干旱区资源与环境 内蒙古农业科技 宁夏工程技术 农业科学研究 青海气象 海洋地质前沿 山东煤炭科技 中国粉体技术 中国铸造装备与技术 电脑开发与应用 山西建筑 种子科技 高压电器 棉纺织技术 应用化工 化工装备技术 计算机工程 建筑钢结构进展 内燃机工程 钢铁钒钛 建筑安全 内江科技 食品与发酵科技 四川地质 天然气化工(C1化学与化工) 通信技术 精细石油化工 热固性树脂 水道港口 天津农业科学 新疆农业科学 热带农业科技 兵器材料科学与工程 茶叶科学 科技通报 浙江电力 农家科技 三峡环境与生态 重庆建筑 艺术科技 社科类用户大学图书馆学报 安徽文学(下半月) 财贸研究 科教文汇 研究生教育研究 管理评论 管理世界 会计研究 计算机教育 科技与出版 神州 现代教育技术 行政法学研究 语言教学与研究 运动 中国党政干部论坛 中国集体经济 中国经贸导刊 中国农村金融 中国商贸 中国市场 中国学术期刊（光盘版）电子杂志社 中国学校体育 自然辩证法研究 东南传播 林业经济问题 素质教育博览 开发研究 西部法学评论 产经评论 科技管理研究 体育师友 大舞台 大众文艺 价值工程 经济与管理 学周刊 中小企业管理与科技(上旬刊) 快乐阅读 流行歌曲 中学生数理化(学研版) 黑龙江史志 求是学刊 数理化学习 武汉金融 学习与实践 民族论坛 企业技术开发 参花 参花（文化世界） 东北亚论坛 人口学刊 现代教育科学 小学时代(教育研究) 产业经济研究 江苏高教 体育与科学 图书情报研究 职教论坛 中学课程资源 语文学刊（外语教育与教学） 青海社会科学 东岳论丛 科学与管理 山东纺织经济 新校园杂志社 中国体卫艺教育 中学时代 法制博览 会计之友 西北医学教育 中学生物教学 国际商务研究 世界经济研究 哲学分析 中等职业教育（理论） 民族学刊 软科学 新闻界 中文信息 高职教育研究 理论与现代化 天津社会科学 云南社会科学 医学类用户中药材 中医药临床杂志 风湿病与关节炎 临床药物治疗杂志 协和医学杂志 中国保健营养 中国法医学杂志 中国防痨杂志 中国康复医学杂志 中国民康医学 中国乡村医药 中国心血管杂志 中国性科学 中国医学创新 中国医学影像学杂志 中国医药指南 中华护理教育 中华护理杂志 中华临床免疫和变态反应杂志 中华临床医师杂志(电子版) 中华医院感染学杂志 西北国防医学杂志 中国兽医科学 按摩与康复医学 分子诊断与治疗杂志 解剖学研究 临床医学工程 河北医学 临床合理用药杂志 中国健康心理学杂志 河南外科学杂志 河南医学研究 河南预防医学杂志 中国公共卫生管理 神经损伤与功能重建 中国心脏起搏与心电生理杂志 中南药学 吉林中医药 中风与神经疾病杂志 江苏预防医学 实用临床医药杂志 中华男科学杂志 解剖科学进展 辽宁中医杂志 实用药物与临床 社区医学杂志 实用医药杂志 实用骨科杂志 动物医学进展 神经解剖学杂志 中国皮肤性病学杂志 中成药 中国输血杂志 中药药理与临床 环境与健康杂志 生物医学工程与临床 浙江预防医学 中国地方病防治杂志 基层医学研究 药物评价 更多\n其实官网已经给出了一些用户，可以访问以下URL查看，但是google dork 关键字一下，远不止这些案例\nhttp://find.cb.cnki.net/TypicalUser.html\n演示案例：总装备部医学学报\nhttp://zzyx.cbpt.cnki.net/\n注册一个作者号并登陆然后点击发送消息，如下图两处都是一模一样的\n\n#1 发送机制绕过此套系统的短信机制是必须有管理给你发了短消息提示，比如审核通过或者稿费的情况等，你才能回复管理员，否则你直接发送消息是发送不了的，收件人字段是readonly属性，就算修改了html标签里readonly属性，然后填写admin并发送，一样会提示不存在，如图图1，未修改过的节点是 readonly 属性，无法输入任何字符\n\n图2，删除掉readonly属性并输入admin，然后发送消息依然失败，提示不存在\n\n绕过这个必须有信息才能被动回复管理员逻辑机制的方法：发送短消息的URL格式如下：\nhttp://zzyx.cbpt.cnki.net/EditorA3N/StationMail/StationNews_xie.aspx?receiverID=0\n来看receiverID这个参数，直接修改成admin系统会自动数据库用户表搜索并放入readonly这个逻辑可以调试jquery看到，新手不建议直接调试jquery修改后的短消息发送URL，访问TA：\nhttp://zzyx.cbpt.cnki.net/EditorA3N/StationMail/StationNews_xie.aspx?receiverID=admin\n如图，成功绕过消息机制逻辑，突破被动发送\n\n#2 Store XSS短消息前端做了JS验证，提交类似<>\\\"=等字符都会提示“存在不允许的字符，无法提交”如图\n\n这点突破更简单，先随意填写任意字符，然后发送绕过前端JS判断验证后在数据包里修改需要的恶意代码即可“主题”这里没有做任何过滤，直接插入恶意代码\n\n管理点击查看即触发XSS，客户端接收后台cookie\n\n\n\n   修复方案：  逻辑校验+过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-10-31 17:39 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}