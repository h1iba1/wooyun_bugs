{"id": 23523, "wybug_id": "wooyun-2015-0104493", "wybug_title": "网站安全狗WebShell上传拦截Bypass", "wybug_corp": "安全狗", "wybug_author": "RedFree", "wybug_date": "2015-03-31 10:40", "wybug_open_date": "2015-06-29 15:12", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "客户端程序设计错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-31：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-03：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-05-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-29：\t细节向公众公开  简要描述：     你还在为上传.asp/.aspx/.php……而被安全狗拦截而苦恼、而发愁吗？来吧，让我们一起打狗吧！ 详细说明：      最新版安全狗上传数据包长度处理存在缺陷，导致上传过滤功能失效。安全狗版本：\n\n先上传一个asp文件看一下吧：\n\n意料之中，被拦截了。然后对数据包进行修改测试，结果发现安全狗对Content-Disposition:的长度处理的不是很好。当长度增加到48930的时候，安全狗的上传防御就失效了。结果如下图：\n\n\n\n   漏洞证明：  \n\n\n\n   修复方案：  用正则了吗？   版权声明：转载请注明来源 RedFree@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-03-31 15:11 厂商回复： 会在新版本中修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-03-31 12:29 |    \t\tloli  \t\t\t( 普通白帽子  |\t\t\t        Rank:550 漏洞数:52        )\t\t \n  还能不能好好玩耍了。    \n     2015-03-31 13:12 |    \t\tANS5 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 爱生活，爱挖洞，更爱妹纸。)\t\t \n  还能不能好好玩耍了。     \n     2015-03-31 15:26 |    \t\t空格 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 呃？)\t\t \n  还能不能好好玩耍了。    \n     2015-04-04 04:05 |    \t\t风中追风的少年 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:2        )\t\t \n  还能不能好好玩耍了。    \n     2015-04-21 01:04 |    \t\tZtz \t\t\t( 普通白帽子  |\t\t\t        Rank:152 漏洞数:40        | 自由职业)\t\t \n  脱裤有理，我的一根打狗棒。    \n     2015-06-29 15:14 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:84        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  突破长度啊 好像hack80公开视频有 哈哈    \n     2015-06-29 22:56 |    \t\tkav \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        )\t\t \n  就给你5Rank，真的值得么？嗯，不对！你手里还有很多方法，所以你不怕。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}