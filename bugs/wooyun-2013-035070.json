{"id": 9132, "wybug_id": "wooyun-2013-035070", "wybug_title": "联想系列3之某业务系统隐蔽SQL注射，大量数据", "wybug_corp": "联想", "wybug_author": "小胖子", "wybug_date": "2013-08-23 13:13", "wybug_open_date": "2013-10-07 13:13", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["管理后台对外", "注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-09-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-07：\t细节向公众公开  简要描述： 无聊就到处逛咯~~~ 详细说明：  系统地址：联想员工内购ESS系统\ness.lenovomobile.com\n登陆框注射？NO！有过滤！注册邮箱检测用户名检测注射？NO！有过滤！伤了心，然后到处找，找到一个这样的地址。（感谢百度）http://ess.lenovomobile.com/regiStep3.aspx?MbrID=6975&code=912348B2-1CE5-4695-9EA0-C4F6F283EAE8居然是激活用户的code没过滤，导致注射、\n\n权限很高的账户 DBA。\n\nover   漏洞证明：  数据库。\navailable databases [12]:[*] DirectBuy_Test[*] LeShopSite[*] LeShopSite_Test[*] lm_db[*] lm_db_test[*] LmShop[*] LmShop_test[*] master[*] model[*] msdb[*] ServerMonitor[*] tempdb\n当前数据库的表，user表里面用户不少，泄露了一部分，我没有保存，测试完就删除了。\nDatabase: LmShop[89 tables]+------------------------------+| dbo.EssCarDtl                || dbo.EssCarMst                || dbo.EssCmpRegiForm           || dbo.EssFavorites             || dbo.EssGoods                 || dbo.EssGoodsColor            || dbo.EssGoodsPresent          || dbo.EssGoodsPrice_Log        || dbo.EssMember                || dbo.EssOrder                 || dbo.EssSales                 || dbo.EssSalesGoods            || dbo.EssSalesMail             || dbo.EssVerifyCode            || dbo.JB_QuickLogin            || dbo.MailBasSet               || dbo.MailSet                  || dbo.MailTemplate             || dbo.MailToDtl                || dbo.MailToGrp                || dbo.MstCode                  || dbo.MstCsErr                 || dbo.MstCsLog                 || dbo.MstCsMenu                || dbo.MstCsUser                || dbo.MstMenu                  || dbo.MstMessage               || dbo.MstRole                  || dbo.MstRoleMenu              || dbo.MstRoleUser              || dbo.MstUser                  || dbo.PmtActivities            || dbo.PmtAttach                || dbo.PmtAttendance            || dbo.PmtFee                   || dbo.PmtGoods                 || dbo.PmtImg                   || dbo.PmtImgSize               || dbo.PmtOrder                 || dbo.PmtOrderWithDraw         || dbo.PmtPromoter              || dbo.PmtQA                    || dbo.PmtSettle                || dbo.PmtSettleDtl             || dbo.PmtSettleOrder           || dbo.PmtSettleOrderTmp        || dbo.PmtSettleSim             || dbo.PmtSettleSimDtl          || dbo.PmtVerifyCode            || dbo.RECEIVE                  || dbo.SEND                     || dbo.SellBigOrder             || dbo.SellCustomize            || dbo.SellJoinEnterprise       || dbo.SellJoinPerson           || dbo.ShopCard                 || dbo.SmsBasSet                || dbo.SmsClass                 || dbo.SmsDueSend               || dbo.SmsDueSendRec            || dbo.SmsNormalIF              || dbo.SmsNormalIFCC111021      || dbo.SmsNormalIfRec           || dbo.SmsReceive               || dbo.SmsReceiveType           || dbo.SmsSend                  || dbo.SmsSend100601            || dbo.SmsSend100602            || dbo.SmsSendRec               || dbo.SmsSysSet                || dbo.SmsTempIF                || dbo.SmsTempIfRec             || dbo.SmsTemplate              || dbo.SmsUserRight             || dbo.SmsWhiteBlackBill        || dbo.TrnFeedback              || dbo.TrnNews                  || dbo.V_EssGoodsPrice          || dbo.V_GetPayTypeByDistrictID || dbo.V_OrderGoodsType         || dbo.V_PmtFee                 || dbo.V_UserMenu               || dbo.ZSmsNormalIF100601       || dbo.ZSmsNormalIF110916       || dbo.ZSmsNormalIF111018       || dbo.bakUp_LMmbrid            || dbo.dtproperties             || dbo.pangolin_test_table      || dbo.sms.SmsNormalIFCC        |+------------------------------+\n   修复方案：  0x1：任何一个点，只要带进数据库，都不能疏忽。0x2：账户权限太高。0x3：能透露下礼物是啥不？0x4：如果有什么细节不了解欢迎私信。   版权声明：转载请注明来源 小胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2013-08-23 16:27 厂商回复： 感谢小胖子同学对联想安全做出的贡献！我们将立即评估与修复相关漏洞 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-23 13:18 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  mark    \n     2013-08-23 13:21 |    \t\tCroxy \t\t\t( 普通白帽子  |\t\t\t        Rank:513 漏洞数:54        | 只会送人头)\t\t \n  联想怒跪。。    \n     2013-08-23 13:37 |    \t\t78基佬 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:20        | 不会日站的设计师不是好产品经理)\t\t \n  联想最近。。好惨    \n     2013-08-23 13:47 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @78基佬 还好他没去众测，不然就得下血本了。    \n     2013-09-26 14:11 |    \t\tIvan \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:9        | 小菜逼一个)\t\t \n  我才不信你删了……    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}