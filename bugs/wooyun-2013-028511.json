{"id": 10360, "wybug_id": "wooyun-2013-028511", "wybug_title": "汽车之家设计逻辑错误可导致全场商品12元购(订单已付款成功)", "wybug_corp": "汽车之家", "wybug_author": "小囧", "wybug_date": "2013-07-11 02:16", "wybug_open_date": "2013-08-25 02:16", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-25：\t细节向公众公开  简要描述： 订单已付款成功，坐等收货~~~ 详细说明：  原因分析：购物车程序逻辑设计不严谨，导致数据错乱。购物车错乱数据，直接生成订单，造成该漏洞。利用价值蛮高的，伪装下，订单若没有人工仔细审核的话，可能导致经济损失哈~~购物车数据\n\n生成订单的时候，商品名称，图片就对了，说明这里有用到 商品id， 金额未变，因为使用了被修改的 pkid!\n\n重新拍一个商品，付款去了，\n\n\n\n付款成功，坐等收货。   漏洞证明：  \n\n12块买两千多的~~~   修复方案：  \n\n估计，pkid 引起的商品价格混乱，不知道pkid什么意思，应该是商品下不同属性（颜色，配置，大小）价格不同的单独标识（后面对应的价格）， 问题就在于它没有判断这个pkid是否属于当前的这个商品。   版权声明：转载请注明来源 小囧@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-07-11 10:41 厂商回复： 已经修复，感谢对汽车之家的支持。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-11 02:17 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  挖到两点呀~    \n     2013-07-11 02:31 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @小囧 我也刚提交了一个，打完游戏，无聊随意逛逛，结果发现一个，同为屌丝啊~    \n     2013-07-11 02:34 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:143        | 心在，梦在)\t\t \n  @小囧 骚年，看来收货不小嘛，目测你要专注这家了，哈哈    \n     2013-07-11 02:36 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  @小胖子 @带馅儿馒头 哎，一个人的夜晚睡不着啊... 没有专注哈，随便玩玩，我一般去看下什么厂商发礼物的就去看看哈    \n     2013-07-11 02:39 |    \t\t带馅儿馒头 \t\t\t( 普通白帽子  |\t\t\t        Rank:1278 漏洞数:143        | 心在，梦在)\t\t \n  @小囧 果然大家都同为屌丝呀    \n     2013-07-11 08:33 |    \t\t78基佬 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:20        | 不会日站的设计师不是好产品经理)\t\t \n  给我来一打法拉利458    \n     2013-07-11 08:51 |    \t\tcharles \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 研究web安全,0day,漏洞挖掘,关注国内安全动...)\t\t \n  我也订了一份.看来确实便宜啊~    \n     2013-07-11 11:22 |    \t\t熊猫 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:33        | panda)\t\t \n  来辆~    \n     2013-07-31 13:47 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @小囧 收到货没？    \n     2013-07-31 13:49 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  @zzR 你猜~ 哈哈    \n     2013-07-31 13:50 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  @zzR 没有收到，价格 改得太悬殊了，相差个400 500应该有机会收到    \n     2013-07-31 13:50 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  @小囧 换了个水表？    \n     2013-08-10 22:54 |    \t\tBeyond \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | xxs)\t\t \n  试问  楼主怎么知道这个链接和商品有关？  小弟只是想搞清楚    \n     2013-10-12 10:50 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小囧 哈哈，没收到钱给你退不？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}