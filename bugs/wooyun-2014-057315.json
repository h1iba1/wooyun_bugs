{"id": 56567, "wybug_id": "wooyun-2014-057315", "wybug_title": "广州医科大学信息发布系统存在任意文件上传", "wybug_corp": "广州医科大学", "wybug_author": "U神", "wybug_date": "2014-04-16 17:45", "wybug_open_date": "2014-04-21 17:46", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-21：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  #1.某信息发布系统某个上传页面没有过滤任何文件类型导致任意文件上传：例如：\n上传地址：http://jwc.gzhmc.edu.cn/editor_new/upload.jsp\n上传脚本文件后源码：\n<script language=javascript>config.attachSeq=-1;parent.UploadSaved('/UploadFile/f/5/58d1b755259686908bb63a98810e075f.jsp');var obj=parent.dialogArguments.dialogArguments;if (!obj) obj=parent.dialogArguments;try{obj.addUploadFile('JSPAword.jsp', '58d1b755259686908bb63a98810e075f.jsp', '/UploadFile/f/5/58d1b755259686908bb63a98810e075f.jsp');} catch(e){};history.back()</script>\n返回了shell地址：\n\n   漏洞证明：  2.再例如：\nhttp://www.kygl-training.com/editor_new/upload.jsp\n返回的地址：\n<script language=javascript>config.attachSeq=3760;parent.UploadSaved('/UploadFile/6/1/74104f04ce773d4ed233228874d8b916.jsp');var obj=parent.dialogArguments.dialogArguments;if (!obj) obj=parent.dialogArguments;try{obj.addUploadFile('1.jsp', '74104f04ce773d4ed233228874d8b916.jsp', '/UploadFile/6/1/74104f04ce773d4ed233228874d8b916.jsp');} catch(e){};history.back()</script>\n\n\n#3.再例如：\nhttp://210.38.57.70:8083/editor_new/upload.jsp\n返回源代码中：\n<script language=javascript>config.attachSeq=4296;parent.UploadSaved('/UploadFile/c/f/f5aab7f5b12789c98c85f2331b1224fc.jsp');var obj=parent.dialogArguments.dialogArguments;if (!obj) obj=parent.dialogArguments;try{obj.addUploadFile('JSPAword.jsp', 'f5aab7f5b12789c98c85f2331b1224fc.jsp', '/UploadFile/c/f/f5aab7f5b12789c98c85f2331b1224fc.jsp');} catch(e){};history.back()</script>\n\n\n   修复方案：     版权声明：转载请注明来源 U神@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-04-21 17:46 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-16 18:32 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  顶长今！    \n     2014-04-16 21:41 |    \t\t3yst1m \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:4        | 我发现我的思路还不够猥琐)\t\t \n  阳顶天    \n     2014-04-22 23:11 |    \t\t小博博 \t\t\t( 实习白帽子  |\t\t\t        还没有发布任何漏洞        | .)\t\t \n  新人求教：返回源代码 如何截取？    \n     2014-04-22 23:12 |    \t\t小博博 \t\t\t( 实习白帽子  |\t\t\t        还没有发布任何漏洞        | .)\t\t \n  @魇 新人求教：返回源代码 如何截取？    \n     2014-04-23 00:45 |    \t\tU神 \t\t\t( 核心白帽子 |\t\t\t        Rank:1285 漏洞数:87        | 感谢乌云，知恩不忘，其实我一直都在乌云默...)\t\t \n  @小博博 戳，源代码不是返回了地址吗？切记不可破坏！否则后果自负    \n     2014-04-24 18:05 |    \t\t小博博 \t\t\t( 实习白帽子  |\t\t\t        还没有发布任何漏洞        | .)\t\t \n  @U神 恩     \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}