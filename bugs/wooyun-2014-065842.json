{"id": 1261, "wybug_id": "wooyun-2014-065842", "wybug_title": "URP综合教务系统通杀（无需登录，可操作数据，学籍信息，影响几百所大学）", "wybug_corp": "URP综合教务系统", "wybug_author": "HackPanda", "wybug_date": "2014-06-22 18:35", "wybug_open_date": "2014-09-20 18:36", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用", "任意文件读取", "源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-06-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-06-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-08-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-09：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-20：\t细节向公众公开  简要描述： 有一天，我听到有人管我叫深澜杀手...哥不只搞深澜好嘛...最近缺钱，求之前几个加上这个的通用的奖励喔亲~ 详细说明：  1.38 1.5通杀。用我挂了的高数算一下，百度大约有33页 一页10个 330个学校 大约一所学校3-5w 人，算下来是千万级别的。没有源码我是不敢来滴，话说这个已经由p1aywind大牛发了，这个是一个点，不过大牛单纯了，这个漏洞实际是不需要登录的，而且可以轻易读取数据库连接信息，还有shadow，这就是这个漏洞的真正危害所在。求轻轻地雷劈我一下~哈哈\npublic void service(HttpServletRequest req, HttpServletResponse res)\t{\t\tBufferedReader br;\t\tPrintWriter pw;\t\tbr = null;\t\tpw = null;\t\tres.setContentType(\"text/html;charset=GBK\");\t\tpw = res.getWriter();\t\tString filename = req.getParameter(\"file\"); //直接取得file\t\tbr = new BufferedReader(new InputStreamReader(getClass().getResourceAsStream(filename), \"GBK\"));\t\tString s;\t\twhile ((s = br.readLine()) != null) \t\t\tpw.print(s + \"\\n\");\t\tException e;\n   漏洞证明：  特征为 intitle:urp综合教务系统-登录随便点一个进去了不用登陆构造http://x.x.x.x/servlet/com.runqian.base.util.ReadJavaScriptServlet?file=../../../../../../../../conf/resin.conf查看页面源文件。\n\n有了这个就可以登录到其对应的oracle数据库了，一般这个是部署在内网的，不过搞一台内网的主机对大牛们来说很简单，只要有webshell就可以，或者许多学校提供有VPN可以接入，这个默认密码一般就是跟学号一样的，需要学号的话可以去学校贴吧搜索，或者去文库搜索某某学校奖学金，然后用burp爆破即可，甚至你可以去这个学校，或者你本身就是在这个学校想操作自己成绩的坏蜀黍~这是其中之一\n\n来个破解VPN的，轻松操作数据库（这里用burp破解到大连某学校的一个账号）\n\n再来个部署在外网的，影响10W+数据，密码再长也没用..求不要暴漏在外网..\n\n\n\n当然这个漏洞光读取应用内信息也不太优秀，再来一发shadow？\n\n\n\n   修复方案：  限制可读取目录，过滤跨目录的关键字，限制在本应用。   版权声明：转载请注明来源 HackPanda@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-06-26 22:24 厂商回复： CNVD确认并复现所述情况（验证工作由上海交通大学网络信息中心协助完成），已经由CNVD按以下步骤处置：（1）联系软件生产厂商，北京清元优软公司，（分机***），将通报发送至前处置的cicsupp*** 和yyx 邮箱中；（2）根据测试实例情况，将相关案例转报给教育网应急组织——赛尔网络公司，抄报CCERT处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-06-22 18:40 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  杀手你好    \n     2014-06-22 19:05 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:15        | Talk is cheap,show me the shell.)\t\t \n  @xsser 老板表闹～啊呀肥皂掉了…    \n     2014-06-22 19:06 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:15        | Talk is cheap,show me the shell.)\t\t \n  @xsser 我们这下雨了…雷 阵雨…    \n     2014-06-22 21:19 |    \t\t惆惆怅XD \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | CNU)\t\t \n  卧槽。这个猛    \n     2014-06-22 21:35 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:758 漏洞数:96        )\t\t \n  mark    \n     2014-06-23 03:22 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  特意加个几百所大学就是为了骗通用奖金吗？ =_=能shell吗？仅仅读文件吗？    \n     2014-06-23 07:59 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:15        | Talk is cheap,show me the shell.)\t\t \n  @动后河 拿shell为了啥？老大教育过我们数据是核心。@xsser     \n     2014-06-23 17:36 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  @HackPanda 能不能透露一下数据库配置文件的相对路径？配置文件是application.xml吗？    \n     2014-06-24 15:26 |    \t\t浮萍 \t\t\t( 普通白帽子  |\t\t\t        Rank:555 漏洞数:118        | 默默潜水)\t\t \n  后排    \n     2014-06-24 19:05 |    \t\tsyjzwjj \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:3        )\t\t \n  @动后河 你想脱裤嘛    \n     2014-06-25 01:32 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  @syjzwjj 说话应该委婉一些    \n     2014-06-27 11:03 |    \t\t雏鹰 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 关注互联网的那些事、关注web安全、关注安...)\t\t \n  这个厉害，够猛！    \n     2014-07-12 05:27 |    \t\twellsun \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | www.wellsun.com)\t\t \n  @HackPanda 免登录？漏洞类型： 任意文件遍历/下载 难道是/reportXX？    \n     2014-07-15 12:15 |    \t\tLogining \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 评论专用)\t\t \n  吓死我了，还以为是方正教务    \n     2014-08-13 13:28 |    \t\tsyjzwjj \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:3        )\t\t \n  这个洞不是有人提交过嘛    \n     2014-08-13 17:31 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  我敢确定，洞主肯定拿到过shell了...    \n     2014-09-03 18:00 |    \t\twellsun \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | www.wellsun.com)\t\t \n  欢迎大家加入通杀教务系统漏洞 交流QQ群  310068074      \n     2014-09-20 22:09 |    \t\t丸子响当当 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:5        | 学习温习•••••••)\t\t \n  好猛。    \n     2015-08-31 11:13 |    \t\t北京清元优软科技有限公司(乌云厂商)\t\t \n  此漏洞已经修复，已经通知相关学校升级，谢谢您的提交。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}