{"id": 10962, "wybug_id": "wooyun-2013-023132", "wybug_title": "phpwind最新版SQL注射可控制程序", "wybug_corp": "phpwind", "wybug_author": "赏金猎人", "wybug_date": "2013-05-05 19:06", "wybug_open_date": "2013-08-03 19:07", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "源码审核", "字符集安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-05-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-10：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-07-01：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-07-11：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-07-21：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-03：\t细节向公众公开  简要描述： 乌云说提交站点程序漏洞可以获得奖励，我就看了下列表里的phpwind，发现最新版存在高危漏洞建议大家谨慎安装 详细说明：  \nclass WindMysqlPdoAdapter extends AbstractWindPdoAdapter {\t/* (non-PHPdoc)\t * @see AbstractWindPdoAdapter::setCharset()\t */\tpublic function setCharset($charset) {\t\t$charset && $this->query(\"set names \" . $this->quote($charset) . \";\");\t}\t/**\t * 创建数据表\t * \t * 添加数据表,支持三个参数'数据表明,字段定义,是否覆盖已存在表'.'$values'举例如下,当数据表名称未定义,或者当'fields'字段未定义,或者为空时抛出异常:\t * $values = array(\t * 'fields' => \"`id` smallint(5) unsigned NOT NULL auto_increment,\t * `name` varchar(30) NOT NULL default '',PRIMARY KEY  (`id`)\",\t * 'charset' => \"utf-8\",\t * 'autoIncrement' => 'id',\t * 'engine' => 'InnerDB');\t * <note><b>注意:</b>最后一个参数'$replace',有两个取值'true,false',当值为false时表示如果数据表存在不创建新表,\t * 值为true时则删除已经存在的数据表并创建新表<te>\t * \t * @param string $tableName 数据表名称\t * @param string|array $values 数据表字段信息\t * @param boolean $replace 如果表已经存在是否覆盖,接收两个值true|false\t * @see AbstractWindPdoAdapter::createTable()\t * @return boolean\t * @throws WindDbException\n看到没看到没看到没\n$charset && $this->query(\"set names \" . $this->quote($charset) . \";\");\n这是字符集问题的节奏啊，搞起来！   漏洞证明：  \n\n   修复方案：  记得感谢我啊，记得发钱啊   版权声明：转载请注明来源 赏金猎人@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2013-05-07 13:02 厂商回复： 非常感谢您对我们的支持与关注，该漏洞我们正在修复~~ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-05-05 19:08 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  牛逼啊！！！！！！    \n     2013-05-05 19:47 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  这次通用奖励 估计重点厂商要花血本了 哈哈    \n     2013-05-05 19:52 |    \t\t钱途 \t\t\t( 普通白帽子  |\t\t\t        Rank:273 漏洞数:44        )\t\t \n  @xsser 集市的书发货了么？    \n     2013-05-05 19:54 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  碉堡    \n     2013-05-05 19:57 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @钱途 你让管理员休息休息相个亲啥的吧    \n     2013-05-05 20:48 |    \t\t钱途 \t\t\t( 普通白帽子  |\t\t\t        Rank:273 漏洞数:44        )\t\t \n  @xsser 嘻嘻！    \n     2013-05-05 20:54 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @钱途 应该下周他从青岛回来就可以发了    \n     2013-05-05 21:03 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  这个重点关注下，    \n     2013-05-05 21:39 |    \t\tmomo \t\t\t( 实习白帽子  |\t\t\t        Rank:91 漏洞数:24        | ★精华漏洞数:24 | WooYun认证√)\t\t \n  niu B   a     \n     2013-05-05 21:41 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @xsser 相亲结果怎么样？  我有一个洞那天发给你了还没审核？以后审核了没过的直接打到未通过吧，不然心里一直想着去看看~    \n     2013-05-05 21:43 |    \t\t‫‌ \t\t\t( 实习白帽子  |\t\t\t        Rank:76 漏洞数:14        )\t\t \n  n b?    \n     2013-05-06 00:10 |    \t\t小威 \t\t\t( 普通白帽子  |\t\t\t        Rank:492 漏洞数:76        | 活到老，学到老!)\t\t \n  phpwind 貌似是1w 卧槽撸主这是要逆天    \n     2013-05-06 08:58 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  可否get？    \n     2013-05-06 09:17 |    \t\tpossible \t\t\t( 普通白帽子  |\t\t\t        Rank:373 漏洞数:32        | everything is possible!)\t\t \n  有钱 真是有动力呀    \n     2013-05-06 09:25 |    \t\t黑云 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 米有)\t\t \n  我擦    \n     2013-05-07 12:41 |    \t\t小黑要低调 \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:4        | 小黑一枚)\t\t \n  一看这马甲的ID就够专业    \n     2013-05-07 13:44 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  这厂商太坑爹了 洞主不难过 是高的啊    \n     2013-05-27 14:07 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  10000￥ 逆天了啊！    \n     2013-05-27 14:47 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @小胖子 什么情况？这个1万？ @xsser    \n     2013-05-27 14:48 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @wefgod 10000￥    \n     2013-05-27 14:52 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  @xsser 我擦，太可以了吧？真那么多啊…………比数字哥给力多了    \n     2013-05-31 09:07 |    \t\tclzzy \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:18        )\t\t \n  专业留爪~~    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}