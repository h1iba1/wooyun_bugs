{"id": 87838, "wybug_id": "wooyun-2016-0204848", "wybug_title": "LOCKet(臻至科技)漏洞一枚可直接内网渗透(Mail泄露/Getshell/Gitlab/Redis可致服务器沦陷)                                      ", "wybug_corp": "zenzet.com", "wybug_author": "爱上平顶山", "wybug_date": "2016-05-04 13:15", "wybug_open_date": "2016-06-18 18:00", "wybug_type": "重要敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-18：\t细节向公众公开  简要描述： 臻至科技是一个专注于独立第三方的数据安全团队，现已获得著名投资方投资。目前成员大多是来自于世界500强和纳斯达克上市的知名企业，我们年轻，不安于现状，想做一些多年后值得回忆、能和别人“吹牛海侃”的事情。年轻，不仅指我们的年龄，还指我们所做的领域。 详细说明：  臻至科技安全团队招人吧~1、http://blog.zenzet.com:8010/wordpress/blog 123456789a\n\n可以直接根据 plugins 插件写shell\n\n内网：\n/>uname -aLinux ubuntu-14-04-3 3.19.0-25-generic #26~14.04.1-Ubuntu SMP Fri Jul 24 21:16:20 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux/>ifconfigeth0      Link encap:Ethernet  HWaddr 00:0c:29:02:1a:20            inet addr:192.168.10.161  Bcast:192.168.10.255  Mask:255.255.255.0          inet6 addr: fe80::20c:29ff:fe02:1a20/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:285900085 errors:0 dropped:137967 overruns:0 frame:0          TX packets:268148077 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:38541408148 (38.5 GB)  TX bytes:53052633261 (53.0 GB)lo        Link encap:Local Loopback            inet addr:127.0.0.1  Mask:255.0.0.0          inet6 addr: ::1/128 Scope:Host          UP LOOPBACK RUNNING  MTU:65536  Metric:1          RX packets:610735383 errors:0 dropped:0 overruns:0 frame:0          TX packets:610735383 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:52625363320 (52.6 GB)  TX bytes:52625363320 (52.6 GB)/>arp -a? (192.168.10.32) at 94:eb:cd:53:d7:bd [ether] on eth0zenzet (192.168.10.39) at a0:99:9b:04:8e:53 [ether] on eth0? (192.168.10.79) at 6c:40:08:bf:c4:e8 [ether] on eth0? (192.168.10.182) at 00:0c:29:a0:1e:8b [ether] on eth0zpf (192.168.10.33) at a4:5e:60:f3:16:61 [ether] on eth0Rongde-iPhone (192.168.10.40) at 60:92:17:88:0d:b2 [ether] on eth0? (192.168.10.66) at a4:5e:60:ef:f6:11 [ether] on eth0? (192.168.10.22) at ec:55:f9:69:8d:33 [ether] on eth0? (192.168.10.29) at 1c:5c:f2:b8:31:f7 [ether] on eth0? (192.168.10.176) at 00:0c:29:bc:df:2d [ether] on eth0? (192.168.10.198) at 00:0c:29:d7:43:04 [ether] on eth0? (192.168.10.96) at 78:f5:fd:6c:a6:7a [ether] on eth0? (192.168.10.85) at 70:3e:ac:ed:e2:d0 [ether] on eth0android-3313730458e50d0a (192.168.10.34) at ac:cf:85:ca:af:73 [ether] on eth0? (192.168.10.246) at dc:53:60:6f:04:64 [ether] on eth0? (192.168.10.41) at 60:92:17:88:0d:b2 [ether] on eth0? (192.168.10.67) at fc:3d:93:16:b0:d7 [ether] on eth0? (192.168.10.30) at a4:5e:60:ef:f6:11 [ether] on eth0? (192.168.10.166) at 00:0c:29:cf:ff:78 [ether] on eth0DESKTOP-L19Q5EU (192.168.10.97) at dc:53:60:6f:04:64 [ether] on eth0? (192.168.10.199) at 00:0c:29:bc:5f:3f [ether] on eth0? (192.168.10.53) at b8:e8:56:34:ec:ba [ether] on eth0Janky (192.168.10.35) at b8:e8:56:34:ec:ba [ether] on eth0? (192.168.10.42) at ac:bc:32:89:32:63 [ether] on eth0xuzhens-iPhone (192.168.10.93) at f4:31:c3:61:5a:c9 [ether] on eth0android-c2dde5ee21615c29 (192.168.10.68) at f0:25:b7:80:aa:17 [ether] on eth0? (192.168.10.24) at 48:6b:2c:a6:ae:eb [ether] on eth0? (192.168.10.178) at <incomplete> on eth0JeffinBaos-Air (192.168.10.6) at 2c:f0:ee:07:40:ee [ether] on eth0xiaogeer (192.168.10.31) at 80:ea:96:4a:5d:9d [ether] on eth0? (192.168.10.98) at ac:cf:85:ca:af:73 [ether] on eth0? (192.168.10.61) at a4:5e:60:c0:fe:0f [ether] on eth0? (192.168.10.36) at a4:5e:60:f3:16:61 [ether] on eth0Cc-2 (192.168.10.94) at 6c:40:08:bf:c4:e8 [ether] on eth0? (192.168.10.43) at b8:e8:56:34:ec:ba [ether] on eth0? (192.168.10.99) at 78:92:9c:7e:54:3e [ether] on eth0wangziruideMBP (192.168.10.37) at 6c:40:08:a9:72:2e [ether] on eth0caolinjdeiPhone (192.168.10.44) at 70:48:0f:44:11:98 [ether] on eth0suxiaobgandeAir (192.168.10.70) at a4:d1:8c:f1:4c:f2 [ether] on eth0? (192.168.10.95) at fc:3d:93:16:b0:d7 [ether] on eth0router.asus.com (192.168.10.1) at c4:04:15:25:31:48 [ether] on eth0heysbkukanzheli (192.168.10.100) at fc:e9:98:7c:2f:ba [ether] on eth0? (192.168.10.82) at 6c:40:08:a9:72:2e [ether] on eth0? (192.168.10.63) at 60:c5:47:05:b7:3e [ether] on eth0? (192.168.10.71) at 2c:d0:5a:b1:6c:d3 [ether] on eth0? (192.168.10.2) at c4:04:15:25:31:48 [ether] on eth0? (192.168.10.196) at 00:0c:29:10:7b:08 [ether] on eth0\n2、Redis未授权访问115.29.203.54:6379115.29.203.54:7000115.29.203.54:6789\nConnected.115.29.203.54:0>info# Serverredis_version:2.8.17redis_git_sha1:00000000redis_git_dirty:0redis_build_id:899a50dd343b0f96redis_mode:standaloneos:Linux 2.6.32-358.6.2.el6.x86_64 x86_64arch_bits:64multiplexing_api:epollgcc_version:4.4.7process_id:20493run_id:29a859ecf22adfa374f77a992289339978377132tcp_port:6379uptime_in_seconds:35225407uptime_in_days:407hz:10lru_clock:2710515config_file:# Clientsconnected_clients:13client_longest_output_list:0client_biggest_input_buf:0blocked_clients:0# Memoryused_memory:1067992used_memory_human:1.02Mused_memory_rss:7475200used_memory_peak:1117904used_memory_peak_human:1.07Mused_memory_lua:33792mem_fragmentation_ratio:7.00mem_allocator:jemalloc-3.6.0# Persistenceloading:0rdb_changes_since_last_save:4rdb_bgsave_in_progress:0rdb_last_save_time:1449471155rdb_last_bgsave_status:errrdb_last_bgsave_time_sec:0rdb_current_bgsave_time_sec:-1aof_enabled:0aof_rewrite_in_progress:0aof_rewrite_scheduled:0aof_last_rewrite_time_sec:-1aof_current_rewrite_time_sec:-1aof_last_bgrewrite_status:okaof_last_write_status:ok# Statstotal_connections_received:4169total_commands_processed:21271instantaneous_ops_per_sec:0rejected_connections:0sync_full:0sync_partial_ok:0sync_partial_err:0expired_keys:4785evicted_keys:0keyspace_hits:5340keyspace_misses:156pubsub_channels:0pubsub_patterns:0latest_fork_usec:291# Replicationrole:masterconnected_slaves:0master_repl_offset:0repl_backlog_active:0repl_backlog_size:1048576repl_backlog_first_byte_offset:0repl_backlog_histlen:0# CPUused_cpu_sys:13952.89used_cpu_user:9476.04used_cpu_sys_children:2241.05used_cpu_user_children:175.00# Keyspacedb0:keys=1,expires=0,avg_ttl=0115.29.203.54:0>keys *crackit\n貌似被人撸了 \n\n\n\n\n\n赶紧查查3、gitlabhttp://git.zenzet.com/  可以http://git.zenzet.com/explore 直接看所有项目\n\n\n\n\n\n4、Mail\n\nok其他的\nblog.zenzet.com:122.234.56.66sso.zenzet.com:121.40.222.125smtp.zenzet.com:42.120.219.29ftp.zenzet.com:192.168.10.168dev.zenzet.com:115.29.203.54monitor.zenzet.com:121.40.222.125m.zenzet.com:42.121.103.112wiki.zenzet.com:115.29.203.54jobs.zenzet.com:120.55.249.149pop3.zenzet.com:42.120.219.25reg.zenzet.com:192.168.10.188developer.zenzet.com:120.55.196.208cas.zenzet.com:121.40.222.125imap.zenzet.com:42.120.219.28bi.zenzet.com:192.168.10.166seo.zenzet.com:122.234.56.66jira.zenzet.com:115.29.203.54mail.zenzet.com:42.156.140.99vm.zenzet.com:122.234.56.66nexus.zenzet.com:192.168.10.188git.zenzet.com:120.26.71.228solr.zenzet.com:122.234.56.66console.zenzet.com:120.55.199.46review.zenzet.com:115.29.203.54jump.zenzet.com:122.234.56.66zk.zenzet.com:122.234.56.66openapi.zenzet.com:120.55.139.31jenkins.zenzet.com:192.168.10.188http://review.zenzet.com/admin/login-default.dohttp://115.29.203.54:8060/loginhttp://115.29.203.54:8090/forgotuserpassword.actionhttp://jira.zenzet.com/secure/Dashboard.jspa\n等等。。。 不在测试 ok 就这样   漏洞证明：  ···   修复方案：  努力加强安全   版权声明：转载请注明来源 爱上平顶山@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2016-05-04 17:59 厂商回复： 非常感谢白帽子@爱上平顶山 对我公司的关注与支持，收到提示后我们立刻进行确认和响应，对问题逐一进行排查，现已将发现的漏洞修复，修复情况通报如下：ess 弱密码被破解决方案：已使用强密码替换。ess 插件被利用解决方案：禁用不必要插件，规范第三方组件的使用，并在以后加强对第三方产品的审核、验证。 未加安全访问限制解决方案： 该 Redis 实为废弃数据库，已在2015年初停止使用，现已彻底下线。以后必将及时下线历史废弃服务。 公开项目可被外部直接访问解决方案：加强内部开发人员权限控制和安全培训，禁止建立公开项目5.员工测试邮箱账户通过公开项目泄露解决方案： 加强内部开发人员权限控制和安全培训，禁止使用个人邮箱进行开发测试作为一家初创企业, 此次事件暴露公司在内部管理方面存在不足，尤其是在新员工内部账户管理培训衔接上存在问题。团队相关负责人和事故责任人晚上睡不好觉了，因为负责人明天例会时得给大家做检讨，老板要求他做到漏洞问题讲解到市场部和行政部的同事也能听懂。并且，后续公司在加强管理和严格执行制度流程方面，这次事件要作为案例了。 最新状态： 2016-05-04：补充未显示部分1.WordPress 弱密码被破2.WordPress 插件被利用3.Redis 未加安全访问限制4.GitLab 公开项目可被外部直接访问  ", "replys": "漏洞评价：\n评价\n     2016-05-04 13:19 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:5372 漏洞数:415        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  动不动就沦陷啊    \n     2016-05-04 13:19 |    \t\tFreebug \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:39        | 流氓是一种高尚的职业！)\t\t \n  动不动就沦陷啊    \n     2016-05-04 13:37 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1809 漏洞数:214        | 不接单、不黑产；如遇冒名顶替接单收徒、绝...)\t\t \n  引用山山的一句话:我猜是mail    \n     2016-05-04 13:39 |    \t\thecate \t\t\t( 普通白帽子  |\t\t\t        Rank:823 漏洞数:128        | ®高级安全工程师 | WooYun认证√)\t\t \n  diao    \n     2016-05-04 13:58 |    \t\tgetshell1993  \t\t\t( 普通白帽子  |\t\t\t        Rank:1219 漏洞数:131        | ~！@#￥%……&*)\t\t \n  我猜是github    \n     2016-05-04 14:09 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:3139 漏洞数:625        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  @Coody 不是 shell直接内网了    \n     2016-05-04 14:10 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1672 漏洞数:236        | 。)\t\t \n  我猜是github泄漏mail然后在xxoo    \n     2016-05-04 14:10 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:3139 漏洞数:625        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  @getshell1993 不是的。。    \n     2016-05-04 18:06 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1888 漏洞数:156        | 不要患得患失，我羡慕你，但是我还是选择做...)\t\t \n  厂商好赞啊    \n     2016-05-04 18:37 |    \t\t高小厨  \t\t\t( 普通白帽子  |\t\t\t        Rank:998 漏洞数:91        | 不会吹牛的小二不是好厨子！)\t\t \n  这响应速度    \n     2016-05-04 19:30 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1672 漏洞数:236        | 。)\t\t \n  厂商不错啊 不知道以后有没有礼物    \n     2016-05-04 19:54 |    \t\tmonburan \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:3        | 对这个世界的知识充满好奇)\t\t \n  厂商响应给好评！    \n     2016-05-04 21:17 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:1744 漏洞数:269        | 以大多数人的努力程度之低，根本轮不到去拼...)\t\t \n  厂商响应速度和态度非常棒,加油.    \n     2016-05-04 22:00 |    \t\tzeracker  \t\t\t( 普通白帽子  |\t\t\t        Rank:1077 漏洞数:139        | 爱吃小龙虾。)\t\t \n  我要为厂商写篇公众号.... 这么棒的企业    \n     2016-05-04 23:09 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1809 漏洞数:214        | 不接单、不黑产；如遇冒名顶替接单收徒、绝...)\t\t \n  我要为厂商挖洞.... 这么棒的企业    \n     2016-05-05 08:54 |    \t\tDNS \t\t\t( 普通白帽子  |\t\t\t        Rank:803 漏洞数:85        | root@qisec.com)\t\t \n  谁要为厂商生孩子    \n     2016-06-18 18:03 |    \t\tMr_Java \t\t\t( 普通白帽子  |\t\t\t        Rank:166 漏洞数:41        | 高三党，当，档，裆！)\t\t \n  厂商响应速度和态度非常棒,加油.这企业会壮大的！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}