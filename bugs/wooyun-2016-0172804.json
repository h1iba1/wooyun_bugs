{"id": 85581, "wybug_id": "wooyun-2016-0172804", "wybug_title": "p2p金融安全之易贷网某站存在SQL注入导致用户(真实姓名\\银行卡\\电话号码)等信息泄露", "wybug_corp": "edai.com", "wybug_author": "路人甲", "wybug_date": "2016-01-26 15:00", "wybug_open_date": "2016-03-10 16:42", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-02-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-03-10：\t细节向公众公开  简要描述： 过滤不是你这么玩儿的. 详细说明：  存在注入点的URL为http://xyk.edai.com/xyk/shenqing/card/?cardId=2152，\n\n经过简单的测试方发现过滤了AND SELECT等常规的注入关键词。不过and可以使用or进行替换\n\n.然而select却被无情的替换为空\n\n然后想到既然是SELECT被替换为空了，如果使用SEL+SELECT+ECT来替代，然后替换了SELECT为空，不是又还原了SELECT了么。尝试了下，发现我的想法是即成立的\n\n果然出数据了。然后立马查看了下sqlmap的tamper里面的各种tamper，发现了一个类似的nonrecursivereplacement 主要是在(\"UNION\", \"SELECT\", \"INSERT\", \"UPDATE\", \"FROM\", \"WHERE\")中间继续填充一个关键词。把UNION SELECT转换为UNIOUNIONN SELESELECTCT。然而这里我们测试发现仅仅需要替换select就可以了。于是稍作修改，丢到sqlmap里面试试\n\n。然后打算跑其中的某个表，发现返回结果为空.使用 -v 3 得到的语句丢到浏览器发现报错了\n\n。那么只能手工玩玩了。自己组合了一个语句丢进去\n\n成功报错出字段。使用burp跑了会\n\n   漏洞证明：  sqlmap出表\n\nburp协助跑字段\n\n为了确保里面的信息正确，查看其中的10个内容\n\n包含银行卡，真实姓名，手机号，余额等~   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2016-01-26 15:27 厂商回复： 被放弃的产品，隔离部署的，不影响正式环境,产品已经下线 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}