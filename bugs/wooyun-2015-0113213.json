{"id": 25737, "wybug_id": "wooyun-2015-0113213", "wybug_title": "盛大某站源码泄露（token泄露可能对微信公账号造成影响）", "wybug_corp": "盛大网络", "wybug_author": "杀器王子", "wybug_date": "2015-05-10 16:02", "wybug_open_date": "2015-06-25 09:44", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向公众公开  简要描述： 盛大某站源码泄露 微信公账号 key泄露 测试可用 详细说明：  221.231.130.170rsync服务开启\nsync_dl        \tsyncfiletongji         \tsyncfilehoutai         \tsyncfilelibrary        \tsyncfilewww            \tsyncfileact            \tsyncfiledatagame       \tsyncfileapi            \tsyncfile\n   漏洞证明：  act 对应 http://act.game.qidian.com/act/www 对应 http://xs.qidian.com/http://act.game.qidian.com/act/weixin/wechat.php 直接获取token 可以对公众号进行任意操作获取用户分组\n\n对xs进行简单审计 发现注入www/Release/api/syxs/usercenter\n$sUserid = rq::getParameterString('ud');    \t$iType = rq::getParameterInt('ty');    \t$iStage = rq::getParameterInt('st');    \t$iOb = rq::getParameterInt('ob');\t\t$iPageSize = rq::getParameterInt('ps');\t\t$iPageIndex =rq::getParameterInt('pi');\t\t$i = ($iPageIndex - 1) * $iPageSize;        if (empty($sUserid) || ($iType!=2 && $iType!=3) || ($iStage!=1 && $iStage!=2) || ($iOb!=1 && $iOb!=2) || $iPageSize<=0 || $iPageIndex<=0) {\t\t  $rd=new ResultData(0,'参数错误！');\t\t  echo $rd->getJson();\t\t  return;\t\t} \t\t$where = ' 1=1 and t1.sUserID = \"' . $sUserid . '\" and t2.iType=' . $iType . ' and t1.iStage=' . $iStage; \t\tif($iOb==1){        \t$sOrderBy = ' order by t1.iGrade desc ';        }        if($iOb==2){\t\t\t$sOrderBy = ' order by t2.sCreateDateTime desc ';        }       \t\t$sqlcount  = 'select count(*) count from sy_xs_user_bag t1,sy_xs_bag t2 where ' . $where;\n   修复方案：  关闭rsync   版权声明：转载请注明来源 杀器王子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2015-05-11 09:43 厂商回复： 谢谢报告，起点已经不属于盛大！！！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-10 16:13 |    \t\t糖剩七颗 \t\t\t( 普通白帽子  |\t\t\t        Rank:430 漏洞数:61        | 天涯何处无屌丝)\t\t \n  token是什么来的？    \n     2015-05-10 23:07 |    \t\t炯炯虾 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我来自地球)\t\t \n  这个上次有人提交过了吧    WooYun: 盛大某网站配置错误导致泄露源码（疑似影响微信公众平台KEY）    \n     2015-05-11 14:42 |    \t\t美囤妈妈(乌云厂商)\t\t \n  新厂商入住，欢迎各位白帽子光临！奖品多多！    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}