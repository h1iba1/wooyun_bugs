{"id": 9742, "wybug_id": "wooyun-2013-032731", "wybug_title": "暴风影音某处CSRF可重置任意用户密保", "wybug_corp": "暴风影音", "wybug_author": "xfkxfk", "wybug_date": "2013-07-29 19:05", "wybug_open_date": "2013-09-12 19:05", "wybug_type": "CSRF", "wybug_level": "低", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["漏洞利用", "设计缺陷", "利用技巧", "利用", "防护策略绕过"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-08-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-09-12：\t细节向公众公开  简要描述： 暴风影音某处CSRF可重置任意用户密保 详细说明：  问题在个人中心的密码保护问题上。我们先看看xfkxfk123用户的密码问题：\n\n下面我们来设置tester123用户的密保问题，然后抓包：\n\n\n\n\n\n这里是GET请求，没有限制csrf。\n重点是：1、这里的请求有username参数，但是这个username没有的话也是一样的2、这里有些用户已经设置了密码问题，再页面上重新设置时，需要回答之前的问题。但是在这里我们抓包测试，可以跳过回答问题，直接重置密码问题\n我们构造好请求连接：\nhttp://user.baofeng.com/user/?a=setQuestion&question1=%E6%9A%B4%E9%A3%8E%E5%BD%B1%E9%9F%B3&answer1=%E6%9A%B4%E9%A3%8E%E5%BD%B1%E9%9F%B3&callback=Security.setQuestionResult\n问题和答案都是：暴风影音然后xfkxfk123访问了这个连接后就会重置其密保问题：\n\n\n\n通过返回状态，以及从页面上看都已经成功重置了xfkfk123的密保，也没有输入之前的密保问题，成功绕过。如果用户没有设置密保也一样为其设置了我们控制的密保。再回到忘记功能上：1、如果用户没有设置密保，输入用户名则，直接发送密码重置连接。2、如果用户设置了密保，输入用户名后，会让输入密保问题，然后发送密码重置连接。利用传送门 WooYun: 看我如重置暴风影音账户密码（需要与用户互交） ——邮箱绑定CSRF结合这里密保重置的CSRF也可以重置用户密码。   漏洞证明：  见详细说明   修复方案：  防止csrf就差不多了还有重置密保前必须回答之前密保。   版权声明：转载请注明来源 xfkxfk@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2013-07-30 12:08 厂商回复： 感谢@xfkxfk发现并提交漏洞，我们已经尽快将漏洞修复，稍后会联系您，赠送您一份小礼品。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-30 02:25 |    \t\t佩佩 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:8        | 一个热衷于网络安全的白帽子,具有很强的逻...)\t\t \n  @xfkxfk 上次团800重置任意密码的 我测试了还没测试出来.大牛求指教    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}