{"id": 88314, "wybug_id": "wooyun-2016-0209443", "wybug_title": "亚信科技某系统任意用户注册登录导致命令执行/涉及多个内网数据库连接信息/可探测260+内网主机                                      ", "wybug_corp": "北京亚信品联信息技术有限公司", "wybug_author": "路人甲", "wybug_date": "2016-05-18 14:16", "wybug_open_date": "2016-07-02 15:20", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-06-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-07-02：\t细节向公众公开  简要描述： rt 详细说明：  \n\nmask 区域\n1.http://**.**.**/\n\n\n\njenkins 随便注册一个用户这里我注册的是522 密码522 登录之后就有了系统管理选项\n\n随便丢几个用户证明是亚信的系统 \n\nmask 区域\n1.http://**.**.**/user/liuhy6/configure_***************iainf*****\n\n\n\n\n\nmask 区域\n1.http://**.**.**/user/guohong/configure_***************siain*****\n\n随便丢几个内网的数据库配置http://117.121.97.3:9080/view/dmp/job/dmp-console/ws/target/classes/application.properties/*view*/\nosfc.i18n.baseName=classpath:insiteosfc.i18n.defaultEncoding=utf-8\n\nmask 区域\n\n*****p_console?useUnicode=tru**********rname=dmp**********assword=**********/dmp_console?useUnicode=t**********username=d**********d.passwor**********dmp_console?useUnicode=tr**********p.userna**********dsp.pas*****\n\n\n\n\n\n\n\nmask 区域\n\n*****/dmp_console_test?useUnicod**********onsole_test?useUnicode=tr**********ername=d**********ssword=c**********p_console_test?useUnicode=**********.username**********.password**********p_console_test?useUnicode**********sername=d**********assword=c********************3306/dsp?useUnicode=tru**********xid.user**********d.passwor*****\n\n\n\n\n\n\n\nmask 区域\n\n*****ame:dmp_co**********assword:********************Name:net.sf.l********************sName=com.my********************:org.hibernate.**********maxActi**********l.maxI**********initial**********stOnBorr**********dationQue**********toReconn**********ibernate.diale********************ssName=com.my**********sp.maxA**********sp.maxI**********.initial**********.testOnB**********idationQue**********utoReconn**********g.hibernate.di**********sp.pool**********.maxPool********************/115.28.220.15**********.apache.hadoop.h**********se=dmp**********_dsp=dm********************ate.ddl-a**********ow-sql:**********lineDataDao._s********************ath=/dmp**********port*****\n\n\n\n\n\n\n\nmask 区域\n\n*****onsolesrcmain\\reso********************.ip=10.1**********er.port**********ername=efd**********password=**********etry.m**********xp.def********************.0.0.1:8081**********7.0.0.1:808********************://localhost:********************y_tim********************le:8085/monitor/mai********************xcute_********************653e\\u8ba2\\**********er.i**********f6\\u95f4\\uff08\\**********er.e********************://10.1.253.1**********userna**********passwo********************//10.1.253.123**********.usern**********.passw********************e_time**********login,login.**********:/log*****\n\n\n\n\n\n\n\nmask 区域\n\n*****isPrope**********10.1.2**********ort=**********assw**********58\\u8bb**********ry.ma**********ault = **********009\\u62e9 me********** = mem********************e = r********** 10.1.252**********= 10.1.2**********ire =********************bas**********pache.phoenix.j**********phoenix:d********************ob a**********y = mi**********69782d64******************************hos**********27.0.**********=oem********************t = 0**********= http********************lassName=com.**********id.maxAc**********ixid.ma**********id.initi**********.testOnBo**********alidationQ**********.autoReco**********g.hibernate.dia**********ixid.po**********id.maxPo****************************** mail.asi**********P_POR**********hanxq@asi**********ORD = **********hanxq@asi********************e =**********wel_pa**********_page********************://10.1.50********************jinxing6@*****\n\n\n\n#指标监控数据文件入mysql数据库\n\n\n\nmask 区域\n\n*****vice.int**********nDir = /work**********pDir = /works********************s =10.1.**********=10.1.3.**********is=10.1.********************=10.1.3.********** =10.1.3**********10.1.3.1**********s=127.0.**********5:6389,10.1.3.125:6399,1**********7.0.0.1:6379**********is.maxI**********is.time**********.testOnB********************ath = /works********************10.1.3.200:8090**********//10.1.3.200:80**********/10.1.51.58:809********************me  =********************ID#&keytype=#KEYTYPE#&province=#PROVINCE#&ctype=#CTYPE#&**********32f297a57a5a743894a0e4a801fc3&key=#QUERYID#&**********ince=#PROVINCE#&ctype=#CTYPE#&filter={\"typeids\":[\"0\",\"1&q**********32f297a57a5a743894a0e4a801fc3&key=#QUERYID#&a**********face.proxy=1*****\n\n\n\n\n\n\n\nmask 区域\n\n*****E0000,E0001,E0002,E0003,E0004,E*****\n\n\n\n#reqreslistener=下警戒值,上警戒值,发送邮件是否需要身份验证,服务器,发送邮箱,密码（若不需要则为0）,收件人（可以为多个）\n\n\n\nmask 区域\n\n*****engxy3@asiainfo.com,liuhy6@asiainfo.com,wuc**********2.19,message@mixdat*****\n\n\n\n#MemListener警戒值设定，发送邮件是否需要身份验证,服务器,发送邮箱,密码（若不需要则为0）,收件人\n\n\n\nmask 区域\n\n*****2.19,message@mixdata.********************il=jinxing*****\n\n\n\n\n\n\n上面这只是一个项目源码的服务器上有这么一堆\n\n在来几个命令执行ifconfig -a\nens160: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500        inet 10.1.3.9  netmask 255.255.255.0  broadcast 10.1.3.255        ether 00:50:56:a9:79:e4  txqueuelen 1000  (Ethernet)        RX packets 48845843  bytes 3254589633 (3.0 GiB)        RX errors 0  dropped 10789  overruns 0  frame 0        TX packets 40543252  bytes 32125871005 (29.9 GiB)        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0ens192: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500        inet 117.121.97.3  netmask 255.255.255.224  broadcast 117.121.97.31        ether 00:50:56:a9:13:64  txqueuelen 1000  (Ethernet)        RX packets 33417041  bytes 5465684323 (5.0 GiB)        RX errors 0  dropped 3786  overruns 0  frame 0        TX packets 19309215  bytes 14972938105 (13.9 GiB)        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536        inet 127.0.0.1  netmask 255.0.0.0        loop  txqueuelen 0  (Local Loopback)        RX packets 10302477  bytes 28435532840 (26.4 GiB)        RX errors 0  dropped 0  overruns 0  frame 0        TX packets 10302477  bytes 28435532840 (26.4 GiB)        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n看看这个内网有多大\n127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n\nmask 区域\n\n*****sqlSer**********sqlSer**********FtpSe**********6\tRe**********stemMo**********BigDa**********9\tBu**********ystemM**********ysqlSe**********13\tP**********21\tN**********22\tN**********23\tN**********24\tN**********25\tN**********26\tN**********27\tN**********28\tN**********29\tN**********30\tN**********31\tN**********32\tN**********33\tN**********34\tN**********35\tN********** \tNgi**********37\tN**********2\tNgi**********3\tNgi**********51\tL**********spCons**********spCons**********\tPush**********icServ**********icServ**********mpCons**********mpCons**********\tMoni**********\tCraw**********70\tL**********idServ**********idServ**********idServ**********idServ**********idServ**********   BidS**********idServ**********idServ**********idServ**********idServ**********   BidS**********   BidS**********   BidS**********   BidS**********   BidS**********   BidS**********   BidS**********   BidS**********   BidS**********   BidS**********idServ**********91\tA**********lgoMon**********\tAlgo**********ViewSe**********ViewSe**********ViewSe**********ViewSe**********ViewSe**********ViewSe**********ViewSe**********ClickS**********ClickS**********ClickS**********   Clic**********okieMap**********okieMap**********okieMap********** CookieM********** CookieM********** CookieM********************AdServ**********AdServ**********AdServ**********AdServ**********AdServ**********AdServ**********AdServ**********DmpPro**********2\tDmp**********3\tRed**********4\tRed**********5\tRed**********6\tRed**********7\tRed**********2\tRed**********06\tRe**********7\tRed**********8\tRed**********3\tDmp**********4\tRed**********   DmpP**********8\tDmp**********9\tDmp**********0\tDmp**********211\t**********212\t**********DspMan**********Operat**********DmpCon**********5\tDmp**********6\tRed**********Monito**********DspCon**********PushSe**********FtpSer**********FtpSer**********4\tCen**********   tr**********   tr********** mixna********** mixna********** mixda********** mixda********** mixda********** mixda********** mixda********** mixda********** mixda********** mixda********** mixda**********0  mi****************************************sqlser**********sqlser**********ftpse**********6\tre**********stemmo**********bigda**********9\tbu**********ystemm**********ysqlse**********21\tn**********22\tn**********23\tn**********24\tn**********25\tn**********26\tn**********27\tn**********28\tn**********29\tn**********30\tn**********31\tn**********32\tn**********33\tn**********34\tn**********35\tn**********36\tn**********     n**********     n**********     n**********51\tl**********spcons**********spcons**********\tpush**********icserv**********icserv**********mpcons**********mpcons**********\tmoni**********\tcraw**********70\tl**********idserv**********idserv**********idserv**********idserv**********idserv**********   bids**********   bids**********   bids**********   bids**********   bids**********   bids**********   bids**********   bids**********   bids**********   bids**********   bids**********91\ta**********lgomon**********\talgo**********viewse**********viewse**********viewse**********viewse**********viewse**********viewse**********viewse**********clicks**********clicks**********clicks**********clicks**********okiemap**********okiemap**********okiemap********** cookiem********** cookiem********** cookiem********************adserv**********adserv**********adserv**********adserv**********adserv**********adserv**********adserv**********dmppro**********2\tdmp**********3\tred**********4\tred**********5\tred**********6\tred**********7\tred**********2\tred**********     D**********     r**********dmppro**********     r**********8\tred**********8\tdmp**********9\tdmp**********0\tdmp**********211\t**********212\t**********dspman**********operat**********dmpcon**********5\tdmp**********6\tred**********monito**********dspcon**********pushse**********ftpser**********ftpser**********4\tcen**********   tr**********   tr********** mixna********** mixna********** mixda********** mixda********** mixda********** mixda********** mixda********** mixda********** mixda********** mixda********** mixda******************** craw********** craw********** craw********** craw********** craw*****\n\n\n\n\n</mask>   漏洞证明：  \n\nmask 区域\n*****:/root:/**********bin:/sbi**********:/sbin:/sb**********r/adm:/sb**********ool/lpd:/s**********:/sbin:/**********wn:/sbin:/s**********:/sbin:/**********/spool/mail**********tor:/root:/**********/usr/games:**********/var/ftp:/s**********body:/:/s**********sage bus:/:/**********for polkitd:**********ck:/var/run/avahi-**********Stack:/var/lib/avah********** for libstoragemgmt:**********c/abrt:/sb**********d SSH:/var/empty**********pool/postfix**********/ntp:/sbi**********lib/chrony:/**********::/:/sbi**********ata1/user/je**********ata1/user/n**********ta1/user/ocha**********user/jenkins/rel**********home/zabbix*****\n\n\n127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4::1         localhost localhost.localdomain localhost6 localhost6.localdomain6\n\nmask 区域\n\n*****sqlSer**********sqlSer**********FtpSe**********6\tRe**********stemMo**********BigDa**********9\tBu**********ystemM**********ysqlSe**********13\tP**********21\tN**********22\tN**********23\tN**********24\tN**********25\tN**********26\tN**********27\tN**********28\tN**********29\tN**********30\tN**********31\tN**********32\tN**********33\tN**********34\tN**********35\tN********** \tNgi**********37\tN**********2\tNgi**********3\tNgi**********51\tL**********spCons**********spCons**********\tPush**********icServ**********icServ**********mpCons**********mpCons**********\tMoni**********\tCraw**********70\tL**********idServ**********idServ**********idServ**********idServ**********idServ**********   BidS**********idServ**********idServ**********idServ**********idServ**********   BidS**********   BidS**********   BidS**********   BidS**********   BidS**********   BidS**********   BidS**********   BidS**********   BidS**********   BidS**********idServ**********91\tA**********lgoMon**********\tAlgo**********ViewSe**********ViewSe**********ViewSe**********ViewSe**********ViewSe**********ViewSe**********ViewSe**********ClickS**********ClickS**********ClickS**********   Clic**********okieMap**********okieMap**********okieMap********** CookieM********** CookieM********** CookieM********************AdServ**********AdServ**********AdServ**********AdServ**********AdServ**********AdServ**********AdServ**********DmpPro**********2\tDmp**********3\tRed**********4\tRed**********5\tRed**********6\tRed**********7\tRed**********2\tRed**********06\tRe**********7\tRed**********8\tRed**********3\tDmp**********4\tRed**********   DmpP**********8\tDmp**********9\tDmp**********0\tDmp**********211\t**********212\t**********DspMan**********Operat**********DmpCon**********5\tDmp**********6\tRed**********Monito**********DspCon**********PushSe**********FtpSer**********FtpSer**********4\tCen**********   tr**********   tr********** mixna********** mixna********** mixda********** mixda********** mixda********** mixda********** mixda********** mixda********** mixda********** mixda********** mixda**********0  mi****************************************sqlser**********sqlser**********ftpse**********6\tre**********stemmo**********bigda**********9\tbu**********ystemm**********ysqlse**********21\tn**********22\tn**********23\tn**********24\tn**********25\tn**********26\tn**********27\tn**********28\tn**********29\tn**********30\tn**********31\tn**********32\tn**********33\tn**********34\tn**********35\tn**********36\tn**********     n**********     n**********     n**********51\tl**********spcons**********spcons**********\tpush**********icserv**********icserv**********mpcons**********mpcons**********\tmoni**********\tcraw**********70\tl**********idserv**********idserv**********idserv**********idserv**********idserv**********   bids**********   bids**********   bids**********   bids**********   bids**********   bids**********   bids**********   bids**********   bids**********   bids**********   bids**********91\ta**********lgomon**********\talgo**********viewse**********viewse**********viewse**********viewse**********viewse**********viewse**********viewse**********clicks**********clicks**********clicks**********clicks**********okiemap**********okiemap**********okiemap********** cookiem********** cookiem********** cookiem********************adserv**********adserv**********adserv**********adserv**********adserv**********adserv**********adserv**********dmppro**********2\tdmp**********3\tred**********4\tred**********5\tred**********6\tred**********7\tred**********2\tred**********     D**********     r**********dmppro**********     r**********8\tred**********8\tdmp**********9\tdmp**********0\tdmp**********211\t**********212\t**********dspman**********operat**********dmpcon**********5\tdmp**********6\tred**********monito**********dspcon**********pushse**********ftpser**********ftpser**********4\tcen**********   tr**********   tr********** mixna********** mixna********** mixda********** mixda********** mixda********** mixda********** mixda********** mixda********** mixda********** mixda********** mixda******************** craw********** craw********** craw********** craw********** craw*****\n\n\n\n\n   修复方案：  任意用户注册   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2016-05-18 15:12 厂商回复： jenkins是以root帐户启动的，并且jenkins可以执行shell命令．造成此漏洞原因主要是因为工作人员流动，以致没有专门维护人员所致．现已半闭该外网ip． 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-05-18 15:12 |    \t\t北京亚信品联信息技术有限公司(乌云厂商)\t\t \n  感谢漏洞作者的工作，这个发现对我们很重要．这个发现可以让领导认识到运维岗位的重要性，让内部工作人员认识到信息安全的重要性．同时给维护人员上了一课，推动业务能力的提高！再次感谢    \n     2016-05-18 15:20 |    \t\tj14n \t\t\t( 普通白帽子  |\t\t\t        Rank:2345 漏洞数:421        )\t\t \n  @北京亚信品联信息技术有限公司 哈哈 没给5分就好。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}