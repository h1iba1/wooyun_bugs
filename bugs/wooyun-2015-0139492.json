{"id": 24632, "wybug_id": "wooyun-2015-0139492", "wybug_title": "中国中化集团某管理系统延时注入（报错延时+短暂性过waf）", "wybug_corp": "中国中化集团公司", "wybug_author": "路人甲", "wybug_date": "2015-09-07 12:02", "wybug_open_date": "2015-09-07 13:25", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 23333333 详细说明：  1、供应商管理系统http://xmsstst1.sinochem.com/vendorlogin.aspx?ReturnUrl=http://vendorms-dev01.sinochem.com/index.aspx\n\n(1)用户填写admin'  报错\n\n(2)刚开始可以短暂性过狗，使用\nadmin' and user>0 and ''='\n语句可以测试得到(现在不行了，估计waf)current-user:\n在将 nvarchar 值 'xmsdbuser' 转换成数据类型 int 时失败。\n(3)测试看看存在延时测试语句\n123'/**/IF(76=76)/**/WAITFOR/**/DELAY/**/'0:0:20'--\n很显然504timeout,存在延时注入\n\n(4)不过sqlmap跑的不好，绕waf脚本欠缺，只测试了db_ower权限非DBA权限\n\n到此为止   漏洞证明：  1、供应商管理系统http://xmsstst1.sinochem.com/vendorlogin.aspx?ReturnUrl=http://vendorms-dev01.sinochem.com/index.aspx\n\n(1)用户填写admin'  报错\n\n(2)刚开始可以短暂性过狗，使用\nadmin' and user>0 and ''='\n语句可以测试得到(现在不行了，估计waf)current-user:\n在将 nvarchar 值 'xmsdbuser' 转换成数据类型 int 时失败。\n(3)测试看看存在延时测试语句\n123'/**/IF(76=76)/**/WAITFOR/**/DELAY/**/'0:0:20'--\n很显然504timeout,存在延时注入\n\n(4)不过sqlmap跑的不好，绕waf脚本欠缺，只测试了db_ower权限非DBA权限\n\n到此为止   修复方案：  估计李姐姐那种大牛可以全部跑出来！   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-09-07 13:25 厂商回复： 具体有什么危害？如何修补？ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-07 12:19 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:84        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  坑，早知道不提交了    \n     2015-09-07 13:46 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:84        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  @中国中化集团公司 没事 注入没危害    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}