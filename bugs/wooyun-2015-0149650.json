{"id": 73387, "wybug_id": "wooyun-2015-0149650", "wybug_title": "Juniper VPN 存在缺陷可绕过短信\\token验证导致漫游内网", "wybug_corp": "Juniper", "wybug_author": "if、so", "wybug_date": "2015-10-26 20:52", "wybug_open_date": "2015-12-17 14:48", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-02：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 全球知名网络设备提供商juniper存在缺陷可绕过短信、token验证。好像是oday~ 详细说明：  其实很简单juniper一般是通过AD域验证或者预设账号验证，但是现在安全意识越来越好了，厂商们纷纷加入了短信，动态token验证，这样即使有了对应的账号密码也无法登陆vpn如何绕过了?juniper vpn的登陆地址是：https://xxx/dana-na/auth/url_default/welcome.cgi仔细看是default出卖了自己，因为juniper可以自己修改vpn页面或者开通多个vpn登陆入口所以为绕过安全策略埋下伏笔   漏洞证明：  以金山为例https://**.**.**.**/dana-na/auth/url_default/welcome.cgi默认页面是这个，不用想肯定有动态码、短信验证\n\n改成https://**.**.**.**/dana-na/auth/url_2/welcome.cgi页面发生了变化\n\n\ntz_offset=480&username=test&password=xxx#&realm=test&btnSubmit=Sign+In\n登陆请求发现分组已经是test了果断爆破，用户名就选test吧，成功爆破，登陆成功\n\n\n\n再贴一个测试成功的案例\n\n\n\n\n\n总结：想绕过动态码验证，更改url_default为url_1或者url_2或者3,4,5只要厂商自定义了其他页面，那就可能突破成功   修复方案：  只允许用户访问特定页面   版权声明：转载请注明来源 if、so@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-10-30 17:04 厂商回复： CNVD确认并复现所述情况，已经由CNVD通过网站公开联系方式向网站管理单位通报。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-10-26 20:56 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1717 漏洞数:204        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  竟然发出来了？    \n     2015-10-26 20:57 |    \t\tqhwlpg \t\t\t( 普通白帽子  |\t\t\t        Rank:260 漏洞数:63        | 潜心代码审计。)\t\t \n  厉害！    \n     2015-10-26 20:59 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:3247 漏洞数:681        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  发出来了？。。    \n     2015-10-26 21:03 |    \t\thecate \t\t\t( 普通白帽子  |\t\t\t        Rank:720 漏洞数:108        | ®高级安全工程师 | WooYun认证√)\t\t \n  强了猪哥的头条    \n     2015-10-26 21:09 |    \t\tMieless \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:10        | 我是来打酱油的。)\t\t \n  ？    \n     2015-10-26 21:09 |    \t\t子非海绵宝宝  \t\t\t( 核心白帽子 |\t\t\t        Rank:1278 漏洞数:128        | 发扬海绵宝宝的精神!你不是海绵宝宝,你怎...)\t\t \n  居然舍得发出来    \n     2015-10-26 21:10 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1841 漏洞数:292        | HackBraid昵称的由来是一款名为Braid的游戏...)\t\t \n  居然舍得发出来    \n     2015-10-26 21:14 |    \t\tDloveJ \t\t\t( 普通白帽子  |\t\t\t        Rank:1200 漏洞数:218        | Web安全测试培训  QQ269787775)\t\t \n  居然舍得发出来L7NG    \n     2015-10-26 21:18 |    \t\t珈蓝夜宇 \t\t\t( 普通白帽子  |\t\t\t        Rank:226 漏洞数:33        | 人不彻底绝望一次，就不会懂得什么是自己最...)\t\t \n  这几天平均两天一个雷,这是怎么了?    \n     2015-10-26 21:33 |    \t\tonpu \t\t\t( 普通白帽子  |\t\t\t        Rank:167 漏洞数:37        | 勿忘初心)\t\t \n  竟然发出来了？    \n     2015-10-26 21:55 |    \t\twy007 \t\t\t( 普通白帽子  |\t\t\t        Rank:108 漏洞数:11        | 其实我是一名卧底...)\t\t \n  怎么舍得发出来啊？    \n     2015-10-26 22:03 |    \t\tanswer  \t\t\t( 普通白帽子  |\t\t\t        Rank:397 漏洞数:49        | 答案)\t\t \n  膜拜膜拜    \n     2015-10-26 22:18 |    \t\t随风的风 \t\t\t( 普通白帽子  |\t\t\t        Rank:201 漏洞数:67        | 微信公众号：233sec  不定期分享各种漏洞思...)\t\t \n  怎么舍得发出来啦？？要抢猪哥的头条？    \n     2015-10-26 22:47 |    \t\tSai、 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | for fun……)\t\t \n  我靠，这都舍得发出来，膜膜膜    \n     2015-10-26 23:16 |    \t\t数据流  \t\t\t( 普通白帽子  |\t\t\t        Rank:738 漏洞数:93        | 没关系啊，我们还有音乐)\t\t \n  mark    \n     2015-10-26 23:18 |    \t\t小红猪 \t\t\t( 普通白帽子  |\t\t\t        Rank:285 漏洞数:48        | little red pig!)\t\t \n  膜拜    \n     2015-10-26 23:28 |    \t\tzeracker  \t\t\t( 普通白帽子  |\t\t\t        Rank:1077 漏洞数:139        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  牛逼啊。    \n     2015-10-27 00:01 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1334 漏洞数:195        | 。)\t\t \n  这日狗啊 牛逼⋯⋯    \n     2015-10-27 09:37 |    \t\t浩天  \t\t\t( 核心白帽子 |\t\t\t        Rank:925 漏洞数:80        | 哈！躁起来！)\t\t \n  案例内容实际挺low，但是我给了精华，if、so 关注的点不错    \n     2015-10-27 09:40 |    \t\tfuckadmin \t\t\t( 普通白帽子  |\t\t\t        Rank:616 漏洞数:87        | 千里之堤溃于蚁穴)\t\t \n  @浩天 现在都喜欢刷国外厂商了，NB    \n     2015-10-27 09:43 |    \t\tif、so  \t\t\t( 核心白帽子 |\t\t\t        Rank:1054 漏洞数:95        | 梦想还是要有的，万一实现了呢？)\t\t \n  @浩天 一一、你要我进去先漫游一通在交上来吗？重点就是绕过验证码    \n     2015-10-27 11:23 |    \t\t胡小树 \t\t\t( 实习白帽子  |\t\t\t        Rank:66 漏洞数:13        | 我是一颗小小树)\t\t \n  吊吊吊    \n     2015-10-28 17:38 |    \t\tDNS \t\t\t( 普通白帽子  |\t\t\t        Rank:696 漏洞数:73        | root@qisec.com)\t\t \n  案例内容实际挺low，但是我给了精华，if、so 关注的点不错    \n     2015-10-30 17:07 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:1593 漏洞数:230        | 闭关修炼易筋经)\t\t \n  @DNS 表哥这B可以，菊花交出来吧    \n     2015-10-30 17:17 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:28        | 开发真是日了狗了)\t\t \n  屌屌屌    \n     2015-10-30 17:23 |    \t\t高小厨  \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:80        | 不会吹牛的小二不是好厨子！)\t\t \n  膜拜    \n     2015-11-02 18:00 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        )\t\t \n  最近天不好。经常打雷    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}