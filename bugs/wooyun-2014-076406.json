{"id": 285, "wybug_id": "wooyun-2014-076406", "wybug_title": "某市公交查询网存在Struts2远程命令执行漏洞(可getshell、可漫游内网数据库)", "wybug_corp": "爱巴仕", "wybug_author": "cf_hb", "wybug_date": "2014-09-17 23:28", "wybug_open_date": "2014-11-01 23:30", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-09-17：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-11-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 这一个漏洞成了，能让我成普通白帽子吗？？？求10rank就行！PS(并发现才不久有人留下的webshell 3 个) 详细说明：  商家域名：www.jt168.com漏洞类型：S2-005 和 S2-016 详细介绍参加官方说明：http://struts.apache.org/release/2.3.x/docs/s2-016.htmlhttp://struts.apache.org/release/2.2.x/docs/s2-005.htmlStruts2版本更新升级不及时，导致远程命令执行漏洞被利用。可以被拿下webshell,任意操作站点文件，漫游内网，因为数据库权限和web用户权限很大可以被利用进一步提权拿下服务器。测试中，利用远程命令执行漏洞成功上传webshell，通过webshell可以对服务器上文件进行任意操作。通过分析，找到数据库服务器，并成功登陆进去发现大量用户隐私数据。漏洞证明截图如下：   漏洞证明：  证明身份：\n\n远程命令执行：\n\n主机名:           PC-20140626WKFEOS 名称:          Microsoft(R) Windows(R) Server 2003, Enterprise EditionOS 版本:          5.2.3790 Service Pack 2 Build 3790OS 制造商:        Microsoft CorporationOS 配置:          独立服务器OS 构件类型:      Multiprocessor Free注册的所有人:     微软用户注册的组织:       微软中国产品 ID:          69813-640-0582553-45431初始安装日期:     2014-6-26, 15:54:09系统启动时间:     16 天 1 小时 37 分 33 秒系统制造商:       To be filled by O.E.M.系统型号:         To be filled by O.E.M.系统类型:         X86-based PC处理器:           安装了 8 个处理器。                  [01]: x86 Family 6 Model 58 Stepping 9 GenuineIntel ~3292 Mhz                  [02]: x86 Family 6 Model 58 Stepping 9 GenuineIntel ~3292 Mhz                  [03]: x86 Family 6 Model 58 Stepping 9 GenuineIntel ~3292 Mhz                  [04]: x86 Family 6 Model 58 Stepping 9 GenuineIntel ~3292 Mhz                  [05]: x86 Family 6 Model 58 Stepping 9 GenuineIntel ~3292 Mhz                  [06]: x86 Family 6 Model 58 Stepping 9 GenuineIntel ~3292 Mhz                  [07]: x86 Family 6 Model 58 Stepping 9 GenuineIntel ~3292 Mhz                  [08]: x86 Family 6 Model 58 Stepping 9 GenuineIntel ~3292 MhzBIOS 版本:        ALASKA - 1072009Windows 目录:     C:\\WINDOWS系统目录:         C:\\WINDOWS\\system32启动设备:         \\Device\\HarddiskVolume1系统区域设置:     zh-cn;中文(中国)输入法区域设置:   暂缺时区:             (GMT+08:00) 北京，重庆，香港特别行政区，乌鲁木齐物理内存总量:     16,348 MB可用的物理内存:   14,509 MB页面文件: 最大值: 18,143 MB页面文件: 可用:   14,873 MB页面文件: 使用中: 3,270 MB页面文件位置:     C:\\pagefile.sys域:               WORKGROUP登录服务器:       暂缺修补程序:         安装了 366 个修补程序。                  [01]: File 1拿下webshell并看到源码文件:\n\n发现被人留下的webshell:\n\n翻到配置文件，看到内网数据库配置信息：\n\n利用开源的Adminer.php连上数据库：\n\n看到好多用户隐私信息：\n\n应该是Led设备登陆账号： \n\n数据库用户是root权限:\n\n通过webshell可以继续内网渗透：\n\n菜鸟不会内网渗透，就测试到这里咯！！   修复方案：  参照官方建议升级Struts2版本进行修复   版权声明：转载请注明来源 cf_hb@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2014-09-18 10:21 |    \t\tkydhzy \t\t\t( 普通白帽子  |\t\t\t        Rank:362 漏洞数:62        | 软件测试)\t\t \n  目测没10个    \n     2014-09-18 10:38 |    \t\t袋鼠妈妈 \t\t\t( 普通白帽子  |\t\t\t        Rank:449 漏洞数:61        | 故乡的原风景.MP3)\t\t \n  感觉求厂商认领    \n     2014-09-18 12:21 |    \t\tcf_hb \t\t\t( 普通白帽子  |\t\t\t        Rank:119 漏洞数:17        | 爱生活，爱安全！)\t\t \n  @袋鼠妈妈 求认领求带走啊    \n     2014-09-18 12:22 |    \t\tcf_hb \t\t\t( 普通白帽子  |\t\t\t        Rank:119 漏洞数:17        | 爱生活，爱安全！)\t\t \n  @kydhzy 目测没人认领    \n     2014-11-02 18:06 |    \t\t小卖部部长 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:3        | 别拿部长不当干部！)\t\t \n  洞主没能在 公交车LED上显示 路人甲到此一游，实在遗憾。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}