{"id": 14968, "wybug_id": "wooyun-2012-015779", "wybug_title": "人人网七年活动摇奖机可突破限制无限摇奖", "wybug_corp": "人人网", "wybug_author": "TituX", "wybug_date": "2012-12-11 11:27", "wybug_open_date": "2013-01-25 11:28", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-12-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-12-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-12-21：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-12-31：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-01-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-01-25：\t细节向公众公开  简要描述： 对用户是否摇过奖的判断仅停留在表面，造成可以突破限制不断摇奖。 详细说明：  \nhttp://seven.renren.com/websitecelebrate\n这里有个摇奖机，摇一下，结果没中，提示下一次摇要在下一个小时。\n\n\nhttp://s.xnimg.cn/a49632/actimg/12anniversary/js/anniversary.js\n发现了这么一个JS文件，包含7周年页面的基本全部。\nXN.act.embedFlash();\t\t//设置抽奖按钮不可点击\t\tif(isLotteryed){\t\t\tjQuery('.lottery-btn').addClass('lottery-btn-un');\t\t\tjQuery('.lottery-btn').click(function(){\t\t\t\treturn false;\t\t   \t\t});\t\t}else{\t\t\tjQuery('.lottery-btn').click(function(){\t    \t\tif((this).className.indexOf('lottery-btn-un') == -1){\t    \t\t\tjQuery('.lottery-btn').addClass('lottery-btn-un');\t\t\t\t\tXN.act.run();\t\t\t\t\treturn false;\t\t\t\t\t}\t   \t\t});\n只是把抽奖按钮禁用了，又看到了XN.act.run();，把这个搬到页面里随便别的链接的onclick事件下。\n<a onclick=\"XN.act.run();return false;\" href=\"javascript:;\" class=\"lottery-check\">查看最新中奖名单&gt;&gt;</a>\n每次单击“查看中奖名单”这个链接，就可以看到老虎机开转了。   漏洞证明：  \n\n\n\n   修复方案：  验证不光停留在本地，也不要只对本地按钮操作，在服务器端保存是否摇过奖的数据并限制摇奖机的启动。   版权声明：转载请注明来源 TituX@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2012-12-11 14:34 厂商回复： 哥们你有点无聊啊。。。。你也没刷到奖品不是～ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-12-11 18:53 |    \t\t双人份 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | 打发点咯)\t\t \n  看，他们早知道刷不出奖品。⊙ω⊙    \n     2012-12-11 21:56 |    \t\tTituX \t\t\t( 路人 |\t\t\t        Rank:19 漏洞数:3        | <script></script>)\t\t \n  厂商透露真相了，不解释    \n     2012-12-12 17:50 |    \t\tI am XiaoM \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:4        | 看着大家的Rank我深深被伤了...)\t\t \n  厄...一语道破了！！！    \n     2012-12-14 18:37 |    \t\tpysolve \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:3        | Time is killing u when ur killing time!)\t\t \n  漏嘴了，该客服妹子工位已被锁定    \n     2012-12-14 22:48 |    \t\tmario \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 可以省略吗)\t\t \n  看，他们早知道刷不出奖品......    \n     2012-12-14 23:11 |    \t\t齐迹 \t\t\t( 核心白帽子 |\t\t\t        Rank:784 漏洞数:100        | 一名普通的phper开发者，关注web安全。)\t\t \n  厂商回复是亮点！    \n     2012-12-15 00:21 |    \t\tBlackeagle \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 向WooYun致敬)\t\t \n  人人再次坑了。。    \n     2012-12-18 17:26 |    \t\txiaoshi \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:2        )\t\t \n  厂商说出了真相啊！你妹的    \n     2012-12-23 16:33 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  这个...何必说出实话...    \n     2013-01-01 01:48 |    \t\txiaokinghk \t\t\t( 实习白帽子  |\t\t\t        Rank:82 漏洞数:16        | 【DBA】)\t\t \n  厂商很自信。你多线程刷也白搭    \n     2013-01-08 15:59 |    \t\tkoohik \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:63        | 没什么介绍的http://www.koohik.com/)\t\t \n  哈哈，你也不是没有刷到奖品么？哈哈哈，厂商回复太牛X了    \n     2013-01-10 20:21 |    \t\t漠惘 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 专注护妹三十年，没有高潮不要钱！)\t\t \n  漏洞在手都刷不出奖品，很显然这网站很扯淡啊....    \n     2013-01-11 06:09 |    \t\t小牟东 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 小菜菜)\t\t \n  笑死个人都。    \n     2013-01-11 09:17 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  来看厂商回复的。。。    \n     2013-01-15 17:43 |    \t\t鬼魅羊羔 \t\t\t( 普通白帽子  |\t\t\t        Rank:299 漏洞数:42        | (#‵′)凸(#‵′)凸(#‵′)凸(#‵′)凸(#‵...)\t\t \n  哈哈，这厂商太逗了。。    \n     2013-01-15 17:52 |    \t\ther0ma \t\t\t( 核心白帽子 |\t\t\t        Rank:598 漏洞数:84        | 专注小厂商三十年！)\t\t \n  可以写成笑话一则 ~！    \n     2013-01-15 18:05 |    \t\t店小弎 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:13        | 关注web安全)\t\t \n  厂商碉堡了。    \n     2013-01-15 19:36 |    \t\tSeay \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:8        )\t\t \n  厂商哥们说出真相了    \n     2013-01-25 12:05 |    \t\t斯文的鸡蛋 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:41        | 我在这头，你在那头~)\t\t \n  厂商碉堡了    \n     2013-01-25 12:26 |    \t\tCNOS \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:6        | 小白一个)\t\t \n  所以说每次抽检送iphone送ipad 都是坑爹的    \n     2013-01-25 13:41 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  人人厂商回复总是让我有回复的冲动    \n     2013-01-25 14:22 |    \t\tSay \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:4        | 谁又会鉴定谁正常？)\t\t \n  哈哈哈厂商真是碉堡了...    \n     2013-01-25 22:43 |    \t\tJonasen \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:9        | have no)\t\t \n  人人 你碉堡了！！！    \n     2013-01-26 11:28 |    \t\tStream \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 低头要有勇气，抬头要有底气!)\t\t \n  被人人笑爆了    \n     2013-02-08 21:06 |    \t\tXiaoLu \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 我是一直小小小小小小鸟。)\t\t \n  笑死我了    \n     2013-02-09 11:18 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  你也没刷到奖品不是～            真相了~    \n     2014-03-26 00:25 |    \t\t伟哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:29        | 不怕流氓有文化,就怕色狼有耐心,那么一只起...)\t\t \n  笑死    \n     2014-04-24 16:50 |    \t\tdebbbbie \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:2        | 深藏功与名 - A Rubyist)\t\t \n  我是从隔壁知乎转过来的，厂商太牛啦    \n     2015-08-02 13:55 |    \t\t无边落木 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | winter is coming！)\t\t \n  知乎观光    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}