{"id": 19862, "wybug_id": "wooyun-2012-06376", "wybug_title": "百度帐号邮箱验证绕过", "wybug_corp": "百度", "wybug_author": "水滴", "wybug_date": "2012-04-25 14:44", "wybug_open_date": "2012-06-09 14:44", "wybug_type": "未授权访问/权限绕过", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "设计不当导致攻击界面扩大", "逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-04-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-04-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-05-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-05-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-05-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-06-09：\t细节向公众公开  简要描述： 百度帐号邮箱验证绕过 详细说明：  百度帐号邮箱验证绕过修改密码，换绑手机估计也一样绑定了邮箱后，更换邮箱需要发送验证码到原邮箱   漏洞证明：  A为要解绑的帐号，B为我的\n获得邮箱\n\n\nparam是B的邮箱地址加密后的东西\n发送验证信\n\n\n虽然不知怎么加密的，但是可以用A号把验证码发到我的邮箱里\n确认验证码\n\n\n\n验证成功\n\n\n得到了token，time\n绑定邮箱\n\n\n绑定一个新邮箱，再加上刚才的俩参数\n更换邮箱成功\n\n\n整个过程没有登录A号的原邮箱   修复方案：  \n\n   版权声明：转载请注明来源 水滴@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2012-04-25 16:44 厂商回复： 感谢提交，邮件及短信部分均以验证，我们会尽快修复！！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-04-25 14:57 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  百度的仇家，又来啦！~.~    \n     2012-04-25 15:00 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  @疯子 近视型大疯狗，又来啦！ ~.~    \n     2012-04-25 15:02 |    \t\td4rkwind \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:2        | 关注web 安全，产品安全)\t\t \n  牛叉大了。赞    \n     2012-04-25 16:33 |    \t\tEoh \t\t\t( 普通白帽子  |\t\t\t        Rank:286 漏洞数:35        )\t\t \n  @水滴 搞垮百度，骚扰百度。 -_-!    \n     2012-04-25 16:42 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  ...... 何必呢    \n     2012-04-25 16:43 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  MARK，顶    \n     2012-04-25 16:46 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  @水滴 尼玛，百度就是你仇家，没事就高别人~~~    \n     2012-04-25 16:55 |    \t\tpfdz \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:13        | Stay hungry. Stay foolish.)\t\t \n  @疯子 不能这么说吧，百度有问题也是问题啊。。还能区别对待？    \n     2012-04-25 17:11 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  @pfdz 这个就不一样了，自己看他公布的漏洞。十个里面9个百度，在乌云第一次看到这样的~.~ 百度哭了    \n     2012-04-25 17:18 |    \t\tpfdz \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:13        | Stay hungry. Stay foolish.)\t\t \n  @疯子 其实吧，我觉得人家找洞，你有问题，专注百度，我觉得也没有啥过不去，既然百度有问题，水滴能找到，就应该值得……水滴找，和别人找也都一样，起码水滴是“白帽子”，如果不暴露出来问题不还是存在嘛。。我个人感觉还是支持水滴的。    \n     2012-04-25 17:19 |    \t\tpfdz \t\t\t( 实习白帽子  |\t\t\t        Rank:99 漏洞数:13        | Stay hungry. Stay foolish.)\t\t \n  @pfdz 擦，这地方的\"你有问题“是指百度。。    \n     2012-04-25 20:42 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  百度的邮件老是被qq拦截    \n     2012-05-02 14:06 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  - -其实不用这么麻烦    \n     2012-05-02 16:40 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @水滴 有新进展？最好能像几年前，yahoo的算法给破解，那太NB了    \n     2012-05-02 16:45 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @一刀终情 yahoo被破解是有原因的，百度不应该    \n     2012-06-13 16:01 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  @百度 还修不修了    \n     2012-06-13 16:38 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @水滴 就给4分啊？    \n     2012-06-13 18:23 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  @一刀终情 。。。还没修    \n     2012-06-14 08:34 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @水滴 额，今晚回家试试看~这个漏洞的关键是能把A的验证邮件发到B？这个感觉跟支付漏洞一样，可能会有普遍性~~这个漏洞真心满牛b的~我觉得@xsser 可以考虑精华    \n     2012-06-14 09:08 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  @一刀终情 其实没上面写的那么复杂，只要token跟time能对得上，所有帐号都能使用，而且无论验证码正确与否都会返回一个正确的token、time，。。{\"errno\":190009,\"errmsg\":\"security param empty\",\"token\":\"ec0aa7ed46f05c511729775ec5bad834\",\"time\":1339636090}    \n     2012-06-14 09:24 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  @一刀终情 发送邮件只要邮件那个参数填对了就能发送，邮件地址经过了简单加密，重点是token和time对所有帐号都是有效的，并非某一帐号在某一时间对应一个token，，，    \n     2012-06-14 11:26 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @水滴 明白了，只验证了token time对应关系，没有验证token与邮箱账户的关系；而且错误居然也返回有效的……最佩服这种逻辑上的漏洞了~挖到了有成就感    \n     2012-06-15 10:20 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  @一刀终情 提交前，填错验证码看到返回的errno不是0就以为不能用，才弄出这么麻烦的方法。。。    \n     2012-07-17 12:06 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  多少啊，高山流水呀，你是百度的知音啊    \n     2012-07-17 13:15 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  @百度 才4分。。。    \n     2012-07-17 16:13 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  @水滴 我觉得至少14分~    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}