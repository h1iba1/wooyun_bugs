{"id": 35574, "wybug_id": "wooyun-2015-0103631", "wybug_title": "某智能停车管理网站getshell", "wybug_corp": "广东省信息安全测评中心", "wybug_author": "路人甲", "wybug_date": "2015-03-26 16:23", "wybug_open_date": "2015-05-14 10:46", "wybug_type": "命令执行", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(广东省信息安全测评中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架", "远程命令执行", "补丁不及时"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-14：\t细节向公众公开  简要描述： #某智能停车管理网站getshell&包含多处数据库信息 详细说明：   迅停（深圳）智能停车管理有限公司是中国专业的智能停车管理运营服务商， 是国内首家以城市级为单位规划和运营智能停车业务并且已经在多个城市运营智能停车业务的公司。\nhttp://www.sspplan.com/web/newsAction!queryNewsDetail.action存在Struts2命令执行可以让黑客getshell从而进一步利用\n\n\n   漏洞证明：  \njdbc.driverClassName=com.mysql.jdbc.Driverjdbc.url=jdbc\\:mysql\\://116.31.92.180\\:3306/emailjdbc.username=adminjdbc.password=qpark8##杩??姹???ㄦ????濮??jdbc.initialSize=5##杩??姹????ぇ??jdbc.maxActive=10##??ぇ绌洪???褰??杩??涓??宄版??村?锛???ユ???互?㈡?灏?凡缁??涓??????ユ??㈤??句??ㄥ?锛???村?灏??maxIdle涓烘?jdbc.maxIdle=3## ???绌洪???褰?┖?茬?杩???板?浜???兼?锛???ユ?灏变?棰??璇峰?涓??杩??锛?互??椽宄版??舵?涓???宠?jdbc.minIdle=1\n\n#log4j.rootLogger=INFO, Console,Rlog4j.rootLogger=INFO, Console#log4j.appender.CONSOLE.Target=System.outlog4j.appender.Console=org.apache.log4j.ConsoleAppenderlog4j.appender.Console.layout=org.apache.log4j.PatternLayoutlog4j.appender.Console.layout.ConversionPattern=(%r ms)  [%t] %-5p: %c#%M %x: %m%nlog4j.logger.com.genuitec.eclipse.sqlexplorer=DEBUGlog4j.logger.org.apache=WARNlog4j.logger.org.hibernate=WARN###========================================= to one file#log4j.appender.FILE=org.apache.log4j.FileAppender#log4j.appender.FILE.File=/tmp/JDiy.log#log4j.appender.FILE.Append=false#log4j.appender.FILE.layout=org.apache.log4j.PatternLayout#log4j.appender.FILE.layout.ConversionPattern=%d - %c -%-4r [%t] %-5p %c %x - %m%n###========================================= to daily rolling file (eg: file2010-03-23.log)#log4j.appender.R=org.apache.log4j.DailyRollingFileAppender#log4j.appender.R.Append=true#log4j.appender.R.File=./log/log#log4j.appender.R.DatePattern='.'yyyy-MM-dd-HH-mm'.log'#log4j.appender.R.Threshold=INFO#log4j.appender.R.layout=org.apache.log4j.PatternLayout#log4j.appender.R.layout.ConversionPattern=%d{yyyy-MM-dd HH\\:mm\\:ss,SSS} [%p] - %m%n#####=========================================  to one file rolling(max size: X kb)#log4j.appender.ROLLING_FILE=org.apache.log4j.RollingFileAppender#log4j.appender.ROLLING_FILE.Threshold=INFO#log4j.appender.ROLLING_FILE.File=rolling.log#log4j.appender.ROLLING_FILE.Append=true#log4j.appender.ROLLING_FILE.MaxFileSize=10KB#log4j.appender.ROLLING_FILE.MaxBackupIndex=1#log4j.appender.ROLLING_FILE.layout=org.apache.log4j.PatternLayout#log4j.appender.ROLLING_FILE.layout.ConversionPattern=[framework] %d - %c -%-4r [%t] %-5p %c %x - %m%n####========================================= to socket#log4j.appender.SOCKET=org.apache.log4j.RollingFileAppender#log4j.appender.SOCKET.RemoteHost=localhost#log4j.appender.SOCKET.Port=5001#log4j.appender.SOCKET.LocationInfo=true## Set up for Log Facter 5#log4j.appender.SOCKET.layout=org.apache.log4j.PatternLayout#log4j.appender.SOCET.layout.ConversionPattern=[start]%d{DATE}[DATE]%n%p[PRIORITY]%n%x[NDC]%n%t[THREAD]%n%c[CATEGORY]%n%m[MESSAGE]%n%n### Log Factor 5 Appender#log4j.appender.LF5_APPENDER=org.apache.log4j.lf5.LF5Appender#log4j.appender.LF5_APPENDER.MaxNumberOfRecords=2000####========================================= to E-mail#log4j.appender.MAIL=org.apache.log4j.net.SMTPAppender#log4j.appender.MAIL.Threshold=FATAL#log4j.appender.MAIL.BufferSize=10#log4j.appender.MAIL.From=web@www.wuset.com#log4j.appender.MAIL.SMTPHost=www.wusetu.com#log4j.appender.MAIL.Subject=Log4J Message#log4j.appender.MAIL.To=web@www.wusetu.com#log4j.appender.MAIL.layout=org.apache.log4j.PatternLayout#log4j.appender.MAIL.layout.ConversionPattern=[framework] %d - %c -%-4r [%t] %-5p %c %x - %m%n####========================================= to database#log4j.appender.DATABASE=org.apache.log4j.jdbc.JDBCAppender#log4j.appender.DATABASE.URL=jdbc:mysql://localhost:3306/test#log4j.appender.DATABASE.driver=com.mysql.jdbc.Driver#log4j.appender.DATABASE.user=root#log4j.appender.DATABASE.password=#log4j.appender.DATABASE.sql=INSERT INTO LOG4J (Message) VALUES ('[framework] %d - %c -%-4r [%t] %-5p %c %x - %m%n')#log4j.appender.DATABASE.layout=org.apache.log4j.PatternLayout#log4j.appender.DATABASE.layout.ConversionPattern=[framework] %d - %c -%-4r [%t] %-5p %c %x - %m%n#log4j.appender.A1=org.apache.log4j.DailyRollingFileAppender#log4j.appender.A1.File=SampleMessages.log4j#log4j.appender.A1.DatePattern=yyyyMMdd-HH'.log4j#log4j.appender.A1.layout=org.apache.log4j.xml.XMLLayout####========================================= custom Appender#log4j.appender.im = net.cybercorlin.util.logger.appender.IMAppender#log4j.appender.im.host = mail.cybercorlin.net#log4j.appender.im.username = username#log4j.appender.im.password = password#log4j.appender.im.recipient = corlin@cybercorlin.net#log4j.appender.im.layout=org.apache.log4j.PatternLayout#log4j.appender.im.layout.ConversionPattern =[framework] %d - %c -%-4r [%t] %-5p %c %x - %m%n\n\nmail.smtp.host\tlocalhostmail.smtp.port\t2525mail.from\t\tnoreply@jbpm.org\n   修复方案：  Ps.命令执行补丁   数据库重新划分   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-03-30 10:45 厂商回复： 非常感谢您的报告。报告中的问题已确认并复现.影响的数据：高攻击成本：低造成影响：高综合评级为：高，rank：10正在联系相关网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}