{"id": 48571, "wybug_id": "wooyun-2015-0135507", "wybug_title": "全时某重要产品任意用户密码重置（CEO帐号证明）", "wybug_corp": "全时", "wybug_author": "px1624", "wybug_date": "2015-08-20 10:22", "wybug_open_date": "2015-09-24 11:50", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经修复", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-20：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-30：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-09：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-19：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-24：\t厂商已经修复漏洞并主动公开，细节向公众公开  简要描述： 之前发了个漏洞，厂商来认领了，并且索要了地址发礼物，而且还修补后第一时间进行了主动公开，厂商对安全的态度值得赞扬。这样俺也有动力，继续帮厂商找些更严重的漏洞，从而帮助厂商更好的解决安全问题了。求20rank！ 详细说明：  1 问题产品，全时蜜蜂。\n\n2 由于这玩意没有开放注册，所以没法自己申请测试帐号。那么就直接点击找回密码进行纯黑盒测试吧。\n\n3 和之前一样，直接通过百度搜索 全时CEO 就可以获取到姓名。\n\n4 然后根据全时邮箱的规则，就可以获取到其邮箱帐号为 xuejun.chen@quanshi.com 。然后输入帐号点击下一步，会给帐号对应的手机发送一个验证码进行验证。\n\n5 这里我也不知道验证码发的是啥东西，但是一般这里的设计都是4位、5位或者6位纯数字的验证码。如果这里对验证码的错误次数的校验没有做限制的话，那么就可以通过爆破而绕过这个验证码验证。6 那么我先试试验证码是不是4位纯数字，直接爆破0000~9999\n\n7 如图，成功爆破出了正确的验证码，通过请求的length可以直接判断出来，看来这里的设计是4位纯数字的验证码。8 然后填写正确的手机验证码，点击确认就会进入新密码修改界面，然后输入新密码就将CEO帐号的密码给重置了。9 这里我将密码改成了 wooyun123456789  你们确认漏洞后给重新修改下吧。   漏洞证明：  10 重置密码后的帐号和密码。xuejun.chen@quanshi.com   wooyun123456789下面是CEO帐号的一些截图证明。\n\n\n\n\n\n\n\n\n\n   修复方案：  1 CEO帐号应该进行特殊化，不要也根据名字就可以直接猜出来。2 手机号不要直接输出泄漏，中间几位马赛克下。3 验证码最好设置为6位数字以上，然后错误上限进行下限制。4 可能贵公司之前并没有对，公司的网站和产品的安全问题进行过重视，与其以后被黑客利用，而现在有平台和白帽子免费给予帮助，还请贵公司后续给予安全方面的重视。   版权声明：转载请注明来源 px1624@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-08-20 17:43 厂商回复： 非常感谢您的测试，我们会马上处理。另外，烦请把我们全时相关的账号和手机都涂擦掉，谢谢！ 最新状态： 2015-09-24：已经修复，另外请将邮件和手机模糊一下，谢谢！  ", "replys": "漏洞评价：\n评论\n     2015-08-20 10:41 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  跪拜庞总3分钟！    \n     2015-08-20 11:25 |    \t\tChora \t\t\t( 普通白帽子  |\t\t\t        Rank:337 漏洞数:22        | 生存、生活、生命。)\t\t \n  庞总刚旅游玩就回来搞CEO了    \n     2015-08-20 18:59 |    \t\tM4sk \t\t\t( 普通白帽子  |\t\t\t        Rank:1199 漏洞数:319        | 国内信息安全任重而道远，还需要厂商和白帽...)\t\t \n  说好的20    \n     2015-08-20 22:21 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @全时 我抹不掉，乌云管理才有权限，之前的漏洞我帮你们联系了，但是不能以后都让我联系吧。另外重置CEO密码危害程度菜5分？XSS盲打+未授权访问+sql注入才5分？懂不懂安全！？一点都不尊重白帽子的劳动成果，就知道在那喊着要抹数据、抹数据，难怪网站和产品这么不堪一击。。。    \n     2015-09-24 12:07 |    \t\t三秋 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:2        | xxx)\t\t \n  发漏洞也不打码，泄露CEO邮箱和电话，你也有点不尊重厂商啊。他们有你联系方式，小心来搞你^_^    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}