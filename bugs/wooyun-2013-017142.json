{"id": 14198, "wybug_id": "wooyun-2013-017142", "wybug_title": "爱爱医某分站任意文件上传", "wybug_corp": "爱爱医", "wybug_author": "Black Angel", "wybug_date": "2013-01-21 17:11", "wybug_open_date": "2013-03-07 17:11", "wybug_type": "成功的入侵事件", "wybug_level": "中", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件上传"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-21：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-07：\t细节向公众公开  简要描述： 爱爱医某分站任意文件上传,对上传文件类型限制不严谨. 详细说明：  \n<?phperror_reporting(E_ALL);/*require_once './include/common.inc.php';\tif(!in_array($groupid,array(1,2,40,44,36,33,45,30,27,3))) {    showmessage('group_nopermission', NULL, 'NOPERM');\t\t}*/set_time_limit(0);function genPassword($min = 5, $max = 8){\t$validchars= \"abcdefghijklmnopqrstuvwxyz123456789\";\t$max_char  = strlen($validchars)-1;\t$length    = mt_rand($min,$max);\t$password  = \"\";\tfor($i=0;$i<$length;$i++)\t{\t\t$password.=$validchars[mt_rand(0,$max_char)];\t}\treturn $password;}?><html> <head> <title>论坛调用图片FLASH专用通道</title> <meta HTTP-EQUIV=Content-Type content=\"text/html; charset=gb2312\"><style>body {margin-right:40%}</style> </head> <br><br><br><br><a href=\"http://w2tools.iiyibbs.com/bbs/uploadimg/\" target=\"_blank\">图片FLASH浏览</a><?phpif(!empty($_GET['action']) && $_GET['action'] == 'upfile') {\t$name= $_POST['name']; \t$ext = substr($_FILES['photo']['name'],-4);\tif(preg_match('/jpeg/i', $ext)){\t\t$ext=substr($_FILES['photo']['name'],-5);\t}\t$target_path = 'uploadimg/z'.time().genPassword().$ext;\t//copy($_FILES['photo']['tmp_name'], $target_path);\tmove_uploaded_file($_FILES['photo']['tmp_name'], $target_path);\tif(file_exists($target_path)) { \t\techo $name.'<font color=\"green\">上传成功</font><a href=upimg.php>继续上传</a><br>'; ?><script> \tfunction oCopy(obj){ \t\tobj.select(); \t\tjs=obj.createTextRange(); \t\tjs.execCommand(\"Copy\") \t} </script>  点击即可复制 <input class=\"input\" onclick=\"oCopy(this)\" value=\"http://w2tools.iiyibbs.com/bbs/<?echo $target_path?>\" size=\"70\"><br /><br /><br /><img src=\"http://w2tools.iiyibbs.com/bbs/<?echo $target_path ?>\"><?php\t}else{ \t\techo '<font color=\"red\">上传失败</font>'; \t} \t\texit; \t} ?> <form action=\"upimg.php?action=upfile\" method=\"post\" name=\"UForm\" enctype=\"multipart/form-data\"> \t<fieldset> \t\t<legend>文件上传（仅支持FLASH和图片以及音频视频格式不大于16M）</legend> \t\t<ul> \t\t\t<li>图片或者FLASH<input type=\"file\" name=\"photo\"></li> \t\t\t<li>说明<input type=\"text\" name=\"name\"></li> \t\t\t<li><button type=\"submit\">上传</button> </li> \t\t</ul>  \t</fieldset> </form> </body> </html>\n我想问一下 上面写的只允许传FLASH类型文件是写着玩的么亲?    漏洞证明：  \n\n\n\n\n\n\n\n\n\n   修复方案：  就不告诉你.   版权声明：转载请注明来源 Black Angel@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2013-01-21 17:23 厂商回复： 感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-17 21:02 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  厂商  妹的,漏洞修复了不来认领.我戳,!    \n     2013-01-17 22:54 |    \t\t小囧 \t\t\t( 普通白帽子  |\t\t\t        Rank:396 漏洞数:62        | 在通往牛B的路上一路狂奔)\t\t \n  额，，咱们公司的 我反映了哈。没鸟我    \n     2013-01-18 23:19 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @小囧 好吧 - - 哥们 努力一下看能否招进一个新厂商。    \n     2013-01-21 17:18 |    \t\t爱爱医(乌云厂商)\t\t \n  感谢  @Black Angel @小囧 正在处理漏洞。    \n     2013-01-21 18:52 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @爱爱医 招进一个新厂商 木有礼物送么亲.    \n     2013-01-21 19:12 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  哈哈嘿,@爱爱医给我发礼物了 谢咯~     \n     2013-01-22 22:15 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @Black Angel 啥子礼物能透露下不？    \n     2013-01-22 22:36 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  @风萧萧 暂时还不晓得,他们昨天联系的我,今天发的,还没到,  你是不是打算挖他几个洞?  /坏笑  我太聪明了 我是天才..    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}