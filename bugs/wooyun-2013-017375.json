{"id": 14315, "wybug_id": "wooyun-2013-017375", "wybug_title": "拉卡拉各种逻辑设计缺陷(可更改他人密码)", "wybug_corp": "拉卡拉网络技术有限公司", "wybug_author": "se55i0n", "wybug_date": "2013-01-16 15:16", "wybug_open_date": "2013-03-02 15:17", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-17：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-03-02：\t细节向公众公开  简要描述： 欢迎送礼物哈：D 详细说明：  1）问题一：邮箱找回密码可形成邮件炸弹；  1.1）填入需要找回的邮箱帐号并提交；\n\n  1.2）系统提示邮件已发送到相应邮箱帐号；\n\n  1.3）发现旁边有个“点击重新发送邮件”按钮，一阵猛点之后，发现邮箱收到一堆系统邮件，当然我们也可抓包，直接构造请求发送（未测试）；\n\n2）问题二：任意手机号码绑定；  2.1）用户登陆后，在主页面上有个手机号码绑定；输入手机号码，点击获取验证码发现为一个4位纯数字，填入一个4位数验证码提交并抓包开始爆破；  2.2）测试发现，系统未对校验错误次数做限制，我们可根据response字节长度和localtion内容确认真正的验证码； \n\n     校验错误时，localtion内容为：\nhttp://user.lakala.com/public/accountMobileActive.jsp?msg=error&mobile=13xxxxxx\n  2.3）当然我们根本不用去管哪个是真正的校验码，因为当爆破到真正的校验码时，系统系统会直接绑定手机号码成功；\n\n3）问题三（最重要）：任意用户密码重置；  3.1）在测试第二个问题的时候，我们发现系统未对校验错误次数做限制，那么使用手机号码找回密码当然也就可行了； \n\n  3.2）这里仅仅做漏洞利用演示，输入我自己的手机号码，获取到一个6位数字验证码，随意填入一个6位数字验证码，点击提交并抓包； \n\n  3.3）我们设置verCode参数值为一个包含真实验证码的较小的6位数字区间，开始爆破，发现我们可根据response的字节长度确定真正的验证码；\n\n  3.4）使用获取到的真实验证码替代verCode参数值即可来到密码重置页面；\n\n  3.5）输入我们要重置的密码即可（漏洞利用演示完成）；\n\n    漏洞证明：  见详细说明~   修复方案：     版权声明：转载请注明来源 se55i0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2013-01-17 19:31 厂商回复： 目前拉卡拉用户中心内部数据，如手机号，卡号等关键敏感数据绝大部分已经做了屏蔽处理，基本不会泄露用户的敏感数据。我们将这2天内修复该漏洞！感谢您的反馈和关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-16 15:19 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @拉卡拉网络技术有限公司 有处描述有点小小错误，不过应该不影响你们对漏洞的理解，，    \n     2013-01-16 15:22 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @se55i0n 你这个是上班还是每天来要礼物啊，小心你们老大看到你，哈哈    \n     2013-01-16 15:26 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @小胖胖要减肥 哈哈，为了妹纸的新年礼物呀，，，    \n     2013-01-16 15:28 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @se55i0n 你这句话信息量很大啊    \n     2013-01-17 07:05 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @小胖胖要减肥   ……何解？    \n     2013-01-17 08:33 |    \t\t小胖胖要减肥  \t\t\t( 普通白帽子  |\t\t\t        Rank:686 漏洞数:101        )\t\t \n  @se55i0n 你以为你的妹子一定是女娃么，你以为你一定不是女娃啊，    \n     2013-01-17 10:14 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @小胖胖要减肥 擦……    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}