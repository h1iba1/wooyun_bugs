{"id": 7825, "wybug_id": "wooyun-2013-040163", "wybug_title": "华为商城某功能设计权限导致可劫持任意用户账户", "wybug_corp": "华为技术有限公司", "wybug_author": "带馅儿馒头", "wybug_date": "2013-10-18 15:05", "wybug_open_date": "2013-12-02 15:05", "wybug_type": "CSRF", "wybug_level": "中", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏校验", "漏洞利用", "逻辑缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-21：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-31：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-11-10：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-11-20：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-12-02：\t细节向公众公开  简要描述： RT 详细说明：  \n测试站点：www.vmall.com\n1.注册一个用户（邮箱帐号xxxx@sina.com）；\n\n2.在个人信息里需要验证邮箱，点击验证邮箱抓包改写了下邮箱为xxxxx@qq.com并提交，发现提交成功了，登陆QQ邮箱成功收到系统的验证邮件；\n\n3.点击邮箱中的验证链接成功验证（汗...）,并且验证后直接成功登陆帐号；\n\n\n\n4.这时我们发现，已经验证成功的用户帐号，居然还能继续验证，这里需要构造请求来完成，look，这是我们刚刚验证过的帐号；\n\n5.我们发现邮箱验证功能，这个地方可反复多次验证任意邮箱，并且在收到系统发送的验证邮件后，点击可直接登陆用户帐号；所以，如果能够让用户发送邮箱验证请求到攻击者的邮箱，那攻击者就能劫持该用户的帐号；6.很幸运，我们发现这个邮箱验证功能存在CSRF的安全问题，例子PoC如下：\n<html><form id=\"test\" name=\"test\" action=\"http://www.vmall.com/member/account/sendEmail.json\" method=\"POST\"><input type=\"hidden\" name=\"email\" value=\"hacker@qq.com\" /><input type=\"submit\" value=\"submit\"></from><script>  document.test.submit();</script></html>\n7.用户在登陆的情况下访问该页面的话，那么你懂的，而且在测试后发现，华为的很多系统能够通用cookies，这又增加了攻击成功的可能；\n\nso....到这里吧，后面的就不多解释了！   漏洞证明：  见详细说明   修复方案：  验证功能验证不严呀，敏感操作加入token吧   版权声明：转载请注明来源 带馅儿馒头@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2013-10-21 09:18 厂商回复： 业务整改中，感谢提醒！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-12-13 15:57 |    \t\t乌帽子 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 学习黑客哪家强 | 中国山东找蓝翔 | sql...)\t\t \n  哎哟 挺吊的！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}