{"id": 50107, "wybug_id": "wooyun-2014-078866", "wybug_title": "thinksaas2.2beta 越权修改置顶删除任意小组帖子", "wybug_corp": "thinksaas.cn", "wybug_author": "路人甲", "wybug_date": "2014-10-14 14:22", "wybug_open_date": "2015-01-12 14:24", "wybug_type": "非授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-12：\t细节向公众公开  简要描述： 已经被很多前辈找过很多了。但是越权这种类型没有统一一次性的防御方案。只能在每个操作的点进行权限验证，一旦出现遗漏就会存在问题。ps:thinksaas厂商比较友好开放，所以来凑个热闹。 详细说明：  这次出问题的点在groupapp的topicmove.php\n\n没有进行权限验证，所以用户可以将任意帖子移动到任意小组当中。这样子看起来危害不是很大，不过后来想到可以将任意帖子移动到自己建立的小组中进行编辑，删除，置顶，加精等操作，之后再移动回以前的小组，从而实现了对任意帖子的任意操作。在任意小组发表置顶贴之类的操作。相当于具有了所有小组管理员的一个权限。这里采用test12 和admin两个账户建立多个小组，test11模拟进行越权测试。直接post帖子id和目的小组id，可以将帖子移动到任意小组。移动到自己建立的小组就有了编辑管理的权限。\n\n使用test11用户发送如下请求，即可移动帖子。将id为7的帖子移动到小组id为3的小组中。\n\n\n\n   漏洞证明：  \n\n\n\n   修复方案：  添加认证   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：5  确认时间：2014-10-15 13:44 厂商回复： 已经把修复同步到git上，未进行下载版本的更新。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 5, "Ranks": null}