{"id": 32003, "wybug_id": "wooyun-2015-0112512", "wybug_title": "百合网某接口撞库泄露用户登录凭据(有批量账号证明)", "wybug_corp": "百合网", "wybug_author": "路人甲", "wybug_date": "2015-05-07 10:07", "wybug_open_date": "2015-05-12 10:08", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["撞库"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-12：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 撞库扫号攻击已经是Top 10 Security Risks for 2014之一.撞库以大量的用户数据为基础，利用用户相同的注册习惯（相同的用户名和密码），尝试登陆其它的网站。2011年，互联网泄密事件引爆了整个信息安全界，导致传统的用户+密码认证的方式已无法满足现有安全需求。泄露数据包括：天涯：31,758,468条，CSDN：6,428,559条，微博：4,442,915条，人人网：4,445,047条，猫扑：2,644,726条，178：9,072,819条，嘟嘟牛：13,891,418条，7K7K：18,282,404条，共1.2亿条。不管你的网站密码保护的多好，但是面对已经泄露的账号密码，撞库扫号防御还是一个相当重要的环节。 详细说明：      主站登录接口没有防御撞库。对登录接口的调用没有进行限制。经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号。   登录接口抓包如下：\nGET /Getinterlogin/gotoLogin?jsonCallBack=jQuery18309600474163889885_1430910053606&event=3&spmp=4.20.53.225.685&txtLoginEMail=patic@163%2ecom&txtLoginPwd=patic1986&chkRememberMe=0&codeId=&codeValue=&_=1430910121714 HTTP/1.1Host: my.baihe.comProxy-Connection: keep-aliveAccept: text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01X-Requested-With: XMLHttpRequestUser-Agent: Opera/9.80 (Windows NT 6.0) Presto/2.12.388 Version/12.14Referer: http://my.baihe.com/loginAccept-Encoding: gzip, deflate, sdchAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: accessID=20150506190031335976; cookie_pcc=701%7C%7Cwww.hao123.com%7C%7C%7C%7Chttp%3A//www.hao123.com/; ca_sessionid=300FB84A0D9D40CB84D27C84DCA58958; ca_uid=D44AEC46660743F19F82C24E5C96C48A; ca_ftime=1430910032068; ca_ltime=1430910032068; ca_stime=1430910032068; join_key=D44AEC46660743F19F82C24E5C96C48A_300FB84A0D9D40CB84D27C84DCA58958_1430910032070; ca_se=http%3A//www.hao123.com/; accessToken=BH1430910053750851371; Hm_lvt_5caa30e0c191a1c525d4a6487bf45a9d=1430910032; Hm_lpvt_5caa30e0c191a1c525d4a6487bf45a9d=1430910054; _fmdata=064B772F4E2BCBC400BE34341D6F4DDB929988D183D0175A388F80F24AAE6E6A73F1FA0C376C840441AA1D740809E18A217AACAEF57DEF4CRA-Ver: 2.10.0RA-Sid: 7B9DD012-20150303-080129-82895f-fb68a9AlexaToolbar-ALX_NS_PH: AlexaToolbar/alxg-3.3Connection: close\n   漏洞证明：  经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号.\npretty_boy_pr@163.com\t04110826doushuling_betty@yeah.net\tdsl900119chenchao81828647@sohu.com\t19870126lifeifeilove@yahoo.com.cn\tlifeifei10xiaoyaoqishi_001@163.com\t19861002bolalisi_double@126.com\t51166382003415liuyong19850202@163.com\ta121522434liangchendemeng@163.com\twodeweilaikamendeqingren@sohu.com\tkamendeqing1984cuiming9903@hotmail.com\t19103348zxr17335049@163.com\t67518335zhangxiaogai326@126.com\tzxg19860326zhangxingang439@163.com\t19830627caohaini1234567@163.com\tcaohainijiaochunlei0210@163.com\t19841210zhangxing850212@163.com\tzx850212gonadarush@yahoo.com.cn\t63875682oumengzhi@gmail.com\tcatherinewintrysea@gamesong.net\tj714285xwzhouzizhou2006@126.com\tyang0728yanghu_1987_01@163.com\tyanghu1987xiangkuanmeng@yahoo.com.cn\t11111111wangtuo220@hotmail.com\tsnake_wtMAIDOUBUBU2006@126.COM\t274743523aitiancai1986@yahoo.com.cn\t8491690119alitianyi-0455@163.com\tcute1986415edithbianyuhua@163.com\t19861224nickleback@126.com\tvanhalenguyingfeng5219@126.com\tguyingfengleechao123@hotmail.com\tcgzlctksfeili178@yahoo.com.cn\ta19811207quanquan_1101@126.com\t13469847409willchou1@126.com\t055056iorichuhonmin@163.com\t19840618haotianyiqing@126.com\t1451392ctrobot2008@yahoo.com\t22274135hy2239642@163.com\t109523398xuhaibing1437@163.com\txhb313926499hqdjaydd@yahoo.com.cn\t19872192418longxp888@hotmail.com\t1988108qempiredy@yahoo.com.cn\t198534dyxiejingjingcy@163.com\t64168627djm_19821127@163.com\t19821127heng19861229@163.com\theng1025rain19890502@126.com\t19890502asdfg110linliyun0608@126.com\t110120linliyunweilianzhong@126.com\t66966720hualong_ning@163.com\t19620520bluecard0436@163.com\tblood0a0hongyevjsp@gmail.com\tbaohua1984papty002@163.com\t65154193wuzhongyin@gmail.com\tmylizimmjwung@yahoo.com.cn\tcallifyoumissshyntiantang@163.com\tshyn1984kj_yuanqiang@126.com\t19760119liyanjun9505@163.com\t02368209505sunyan841225@163.com\tsun8792011yancaozjian4616@126.com\tjiandotcomchengyangdiy@163.com\t19871118aimtezhong@gmail.com\ts7wvie7bxiaoaogongji@163.com\t62597758yuxingky2005@126.com\t19821224yuanzhan_6553@qq.com\t19841112wjsuper@yahoo.com.cn\twj1228BBFLYDD@YAHOO.COM.CN\t9718966624Jfeng.liu@gmail.com\t12345678andylee2008@163.com\tdark130320greenapple0613@eyou.com\t19820613bluefire168@163.com\tBr168kinglx262853530@163.com\tlx19891029qwezxc3020@sina.com\t79532448amanda.bear@163.com\tamanita626387hao_1033286@163.com\t1033286haoninaikuang@sohu.com\twonaikuangqq153998056@163.com\t153998056dingcharleyge@gmail.com\t19881018zhouhuashao@126.com\tshengyuqinliuzheng265@126.com\t090330226daixiangyun@163.com\t357357YXF852943_4@163.COM\t1027543677xixihua3166.com@163.com\t13129860474uueveryday@sohu.com\t123654789huashan1122@163.com\thuashan54260843zhaoxupear@sina.com\t25859626xuhuairuogu1978@163.com\thanfei***chizyhj0210@163.com\tchizy0210dawei.hu@qmul.ac.uk\tdawei129kivin@vip.sina.com\twk770630hmogy@sina.com\t117111ly19820730@163.com\t1982073086920zhang@163.com\tzhanghanbendan911@sohu.com\tiloveyoutangjiaxz@sina.com\t231623xztony871018@126.com\ttony5212129lvqian0425@126.com\twoaimamagoodtwoboy@163.com\t19841210chenjinmyin@qq.com\tcheng911murfy.jo@gmail.com\t8416103zjaezy168@qq.com\taezy1661681377711@qq.com\tNintendokamijofox@yahoo.cn\trenyun198877folioy@hotmail.com\tfreefreedchao_1983@126.com\tdchao1984jiangwengg@tom.com\tzj724jwmyofficexp@163.com\tsunfenglailmh1225lmh@126.com\tjxlchf521liuran_aly@126.com\t111213lrshimuzhen@sohu.com\tzxa7508318sunbogaoqi@163.com\twoaishiyecy_xyz@hotmail.com\t013114810548103820@sina.com\tmosquitowangcity@gmail.com\t12345678moxuesagsagsag@163.com\t25211119huanna1108@163.com\t06199127jg992home@hotmail.com\tjg992homeyu_dong99@126.com\t62312371burningma@live.cn\tburningma841128zhl602418@163.com\t1988602418jy3204183@163.com\thjwisatc375800435@163.com\t32783784zongc1989@163.com\tdick19890725xinyehaoshuai@163.com\t19860420cfgzw8877@163.com\t375884312qnsky_cn@sohu.com\tqiannianihking001@163.com\t8081101381mauvesky@sina.com\t54byw52jqzephyr883@163.com\t66524432cdy163com@163.com\tcdy515620lotoren@gmail.com\trlt2880009guankun@gmail.com\tlbdzjclzqliuzhiwei0132@163.com\tsuperstarterry277@sina.com\tterry277shyleehom@126.com\tshy861216sjz518lgw@163.com\t5188999ioprgj1012@gmail.com\t751012481scagsau@gmail.com\t7632511chinaleee@163.com\t000000zhaokeyi@sohu.com\tzhaokeyidrizzt430@hotmail.com\t52506526gundamyu@sohu.com\tgundamyuld800910@yahoo.com.cn\t800910dingyuki_kulosawa@msn.com\t138165028xiaotuizi0220@126.com\t19840220yjsochris@163.com\t697542wangfengbo88@eyou.com\twangfengbodbseti520@163.com\tviviandbsetibugle2008@163.com\tchabuglesarahho28@hotmail.com\tsarahho6823053166885@163.com\twoainiazmlwkq139788@tom.com\tws.t.f.lwuhao0860@163.com\t840102jamstang@163.com\tjamstangmordecai@163.com\tthinking123enetwell@163.com\trs791004yangdong001@sina.com\t19811216jcz-1987@126.com\t2080346680455911327@qq.com\twuguanru1234feirenzx@126.com\tzhangxin854865481@qq.com\tdaerdaolv770827543@qq.com\t56770165540739018@qq.com\thz1989711psq10000@163.com\t22882288hzhudd@gmail.com\t110410714pilipaca@126.com\t85798579touallen@126.com\tabcd1234765298874@qq.com\tluoyu1989529885364@qq.com\t73366227412348154@qq.com\t7758521sweet596160213@qq.com\t15995882379584116558@qq.com\tying584116558cwzxhlsl@163.com\t19840330shini-910904@163.com\tlsntracy272476625@qq.com\tq62531298375232234@qq.com\t13978697546838918117@qq.com\tsun3234084598010251@qq.com\tkele0628236078746@qq.com\tlhg123456392899568@qq.com\troval880223200608178@qq.com\tzwwczx060817690013185@qq.com\tmarseille919685771@qq.com\t4206827H402800665@qq.com\t40280066517867471@163.COM\t5201314ting000@sina.com\tsting000a5225944@163.com\t44793355xgnh1000@hotmail.com\t677679jingzi39@163.com\tlijinglittle.rain@eyou.com\t440126731437ztj@21cn.com\t131420149296641@qq.com\tainibubianparcolxr@163.com\tlxr4renxian7280094589@qq.com\t280094589apple_11@126.com\t13161252188sh1986ye@163.com\t19861107kirilenko110@163.com\t520131421517044529@qq.com\t86582417delta500@126.com\t350128198112018935@163.com\t13086250068happieme@163.com\t2336110399538697@qq.com\tyjtfqihcxiao2603@163.com\tjordan23yqing_77@126.com\t7788qingjengjeng@163.com\t790915sequoya@163.com\t820818okhouzhanglin@126.com\t57466432cdx5451@126.com\t545102325nbh1991@163.com\tguangzhimiebkr2001@163.com\tbkr54127xyq3721@126.com\t8952429210212227@qq.com\t68086390dudiboy@163.com\tmusic123znsdcr@sina.com\tzn3358255tzdaqwd@163.com\t397119632sxycwn@sohu.com\twn19900809zhexin-1950@163.com\t1982122020730432@QQ.com\t19880118hit_man@live.cn\tliuyajingjyk1101@163.com\tjiayongkukenfanx@126.com\tkenfanxhyhy456@163.com\t1q2w3e4rzcp1981@163.com\t198188tank711@126.com\t15152615chengcf0809@126.com\t527862ccfwxf2005@tom.com\t12345678pku_jjc@163.com\tjjc112358xzd2734@163.com\t273400tianh13@163.com\thuang0016gengjiayuan@163.com\t19871124gllh310@163.com\t310930lshonboo@sina.com\t16800123mylvyan@hotmail.com\tasdfdsasaalaw1020@126.com\tloving51xxxxxhk@163.com\timissyousj055xy@126.com\txy123456silverliu@km169.net\tQsc!152216guowenj@163.com\twoaizijiwzl1025@163.com\t961114427wzllvjinshan39@163.com\t1980392008xiantao1008@163.com\t1111111113574773@qq.com\taccessorieslj103bhyself@163.com\t043612jkgg_0@yahoo.com.cn\t6745638745071967@qq.com\t7777777777qianfanblue@163.com\t1983041783853692@qq.com\t19831014h_sun@sina.com\t781006itang@21cn.com\t780228gyxalxl_21@163.com\t19850115richal_cyt@163.com\t19821224qun213@126.com\tlaotou00213798213887@qq.com\tqq123456zwc722@126.com\t19870722124lzalmy@126.com\tliuzhe123zx6414@126.com\t13564143501ydq_gd@163.com\t800408gdid0769@126.com\tzl2726002tjs019@163.com\tyutaotjshf5341@163.com\thf6205341phoful@163.com\t19831208yaojunwei@eyou.com\tyaojunwei21west@163.com\tzzzzzzmahui0614@yahoo.com.cn\t46144255vpezpb@hotmail.com\t68460017mcbkec@163.com\t19730913mqt052@163.com\tjccg1000yy2wwy@163.com\t14941797zudyac@163.com\t22048682195255@qq.com\t2002195255ls1277@qq.com\t19880818yuhappy_8@163.com\t19810101whgfu@163.com\t2114009217feiyang47@126.com\tfeiyang47ttyygghh00122@163.com\t7856391zfjalis@163.com\t1314521jalislilyglp@sina.com\t750614284479065@qq.com\t123123123nnde@163.com\t2525775alex7676@126.com\talex7676zhimo000@163.com\t52199999jiang8853007@163.com\tjiang8853007ghiro520@163.com\t19821547soox@163.com\t12344321s.hong.l@163.com\t13824042929XDWSSHH@SOHU.COM\t712307395176577@qq.com\t1415926278101213@qq.com\t89215439ac168_lm@163.com\t17031703lcx119@21cn.com\t85100617\n\n\n\n\n   修复方案：  撞库防御参考资料:http://stayliv3.github.io/2015/04/15/%E6%92%9E%E5%BA%93%E6%94%BB%E5%87%BB%E9%98%B2%E5%BE%A1%E6%96%B9%E6%A1%88/   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-05-12 10:08 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}