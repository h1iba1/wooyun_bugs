{"id": 49609, "wybug_id": "wooyun-2014-080736", "wybug_title": "某大学统一身份认证平台重置任意用户密码，泄露全校师生信息", "wybug_corp": "CCERT教育网应急响应组", "wybug_author": "小饼仔", "wybug_date": "2014-10-27 12:02", "wybug_open_date": "2014-12-11 12:04", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(CCERT教育网应急响应组)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑缺陷", "重置任意用户密码"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-11-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-11：\t细节向公众公开  简要描述： 学生的个人信息、家人信息、成绩、奖学金...老师的工资...无法直视全校师生信息都泄露了，不给上首页，不给20RANK，对不起天地良心啊~~~ 详细说明：  中南大学采用统一身份认证平台来管理师生登入地址:http://ca.its.csu.edu.cn/home/login界面：\n\n点击找回密码：\n\n大学要注意上面链接的结尾的数字1，这里很可疑要求输入学工号，那么问题来了，学工号是什么？搜一搜便可得知。1.从中南大学百度贴吧（链接：http://tieba.baidu.com/p/1482903508?pid=18336668015&cid=0#18336668015）找到的一个学工号111612527，得知前两位是代表11级。\n\n2.然后又找到一个中南大学捡获卡查询信息的页面，上面直接有学工号\n\n学工号唰唰的一片，那么我们找一个人测试下，我们选择第一个陈元元同学，学工号141611166在找回密码页面输入该学工号，然后到了第二步，回答问题\n\n接下来就是重点了，我们把链接http://my.its.csu.edu.cn/MyInformation/MyPasswordModify_2/141611166 中的MyPasswordModify_2改成MyPasswordModify_3，回车，然后我们就直接到了重置密码的步骤，跳过了验证身份的第二步\n\n重置该用户的密码为wooyun,然后我们点击确定,跳转到登入页面输入账号密码，成功登入\n\n成功登入后，我们来看一下可以获得什么信息，左边有很多菜单\n\n我们随便选一个进去看下（对于菜单部分，不同学生界面不同，有的多有的少，例如本科和研究生就不同，这里以研究生的为例）1. 点击研究生教务，进入系统\n\n可以获得如学籍信息\n\n学生基本信息\n\n家庭信息\n\n成绩信息\n\n等等等等，基本上关于该学生的所有信息都查得到，左边导航栏还有一堆，\n\n这里就不在列出来了要是诈骗的人拿到这些信息，后果不堪设想~学工号的组成其实是有一些规则的，比如前面找到学生学工号前两位代表XX级，剩下数字的规则要找到其实非常容易，那么其他学生的信息我同样可以得到那么对于老师来说，学工号貌似不同，在系统中有一个确认导师的选项，我们点开，然后点击选择( 要测试请在IE内核的浏览器下打开，其他内核浏览器会无法正常打开)\n\n二级单位是可以随便选的\n\n导师查询功能，我们随便查询一个，得到结果\n\n我们来看下网页源代码，里面有一串数字，经验证是学工号，\n\n我们选择一个138056,罗新星按照前面的步骤重置密码，然后成功登入\n\n左边菜单，我们选几个看一看，比如工资\n\n体检结果：\n\n然后研究生教务\n\n貌似可以发助学金和该成绩，不深入了。按照上面导师查询的办法，可以得到所有老师的学工号，然后就....   漏洞证明：     修复方案：  全校师生的信息啊，赶快修复吧   版权声明：转载请注明来源 小饼仔@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2014-10-31 11:19 厂商回复： 已通知相关学校处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-11-20 16:42 |    \t\t爱Gail \t\t\t( 普通白帽子  |\t\t\t        Rank:237 漏洞数:38        | 爱漏洞、爱编程、爱旅游、爱Gail)\t\t \n  才给了个中    \n     2014-11-25 22:37 |    \t\t小饼仔 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:48        | 不告诉你)\t\t \n  @爱Gail 中还是小厂商~    \n     2014-12-28 19:20 |    \t\t命运 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 我是来乌云秀智商下限的~~)\t\t \n  不给低就不错了     \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}