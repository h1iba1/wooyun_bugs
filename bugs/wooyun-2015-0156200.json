{"id": 80302, "wybug_id": "wooyun-2015-0156200", "wybug_title": "广之旅用户越权访问订单导致大量敏感信息泄露（含身份证）", "wybug_corp": "gzl.com.cn", "wybug_author": "taonese", "wybug_date": "2015-11-27 10:50", "wybug_open_date": "2016-01-16 08:30", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["身份证", "广之旅", "订单泄露", "销售量"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-02：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-16：\t细节向公众公开  简要描述： 未做好访问控制措施，导致用户可以越权访问所有其它订单，导致订单的姓名，手机号，身份证等敏感信息泄露。 详细说明：  0x00：随便用一个手机注册0x01: 登录后，查询订单位置http://www.gzl.com.cn/b2c-web/member/order/201511260000289/Tour.html其中201511260000289是订单编号修改该值可以越权查询其它人的订单，订单号由日期+7位数字拼接而成。随机改几个数即可查到其它人订单。\n\n\n\n\n\n\n\n\n\n0x02:后果1)存在身份证、手机号、邮箱、出行等敏感信息泄露2)从订单号可以猜测出每天的订单量貌似推测广之旅每天的订单数量以及订单金额为测试一下想法，试了一下，2015年11月25日，订单量为275单。严重声明：只是跑了一下这一天的订单，未保存订单数据，更也未统计订单金额，仅仅看一下一天的订单量，其它什么都没看，我保证。\n\n   漏洞证明：  同上   修复方案：  1）是不是可以在访问查询订单前先再验证一下权限？2）我对广之旅的产品还是挺感兴趣的，因为经常在上面购买旅游产品，真不知道我的信息被卖了几回了~~ 。 最主要是我没看到提供删除订单的功能，让我的信息都暴露在大庭广众之下，我被逼无奈才赶紧提交漏洞，希望广之旅赶紧修复。   版权声明：转载请注明来源 taonese@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2015-12-02 08:28 厂商回复： 已确认，谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}