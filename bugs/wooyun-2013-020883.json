{"id": 13705, "wybug_id": "wooyun-2013-020883", "wybug_title": "DEDECMS 一个很久前的文件包含漏洞", "wybug_corp": "Dedecms", "wybug_author": "路人甲", "wybug_date": "2013-03-29 16:34", "wybug_open_date": "2013-04-03 16:35", "wybug_type": "文件包含", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "文件包含漏洞", "源码审核", "文件包含", "本地文件包含利用", "文件包含漏洞利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-03-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-03：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： DEDECMS 一个很久前的文件包含漏洞，这个漏洞长达几年，跨了几个版本，网上也公开过了，不知道是厂商不懂，还是什么，就是不修复。。。很多情况直接导致拿shell 详细说明：  http://www.shellsec.com/tech/3016.html详细描述在这里。。本地试了一下，最新版本一样可行。首先利用cookie修改工具，加上 code=alipay  然后访问http://www.xxx.com/plus/carbuyaction.php?dopost=return&code=../../uploads/userup/xx/myface.gif%00直接包含成功利用条件为GPC OFF ，或者某些环境下的截断。可以在会员中心里上传个图片木马进行拿shell。还可以包含dede自身文件进行更多利用，这里就不详细了。   漏洞证明：  \n\n   修复方案：  赶紧修复吧。。。。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-04-03 16:35 厂商回复：  漏洞Rank：10  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-03-29 13:40 |    \t\t苦战 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:4        | 人称苦战？乃南方蛮荒之人！相平，谓正不如...)\t\t \n  是plus/carbuyaction.php那个？    \n     2013-03-29 14:21 |    \t\t小痞子 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:21        | <xss>alert(\"a\")</xss>￥&@&……dssKhwjcw...)\t\t \n  @路人甲    \n     2013-03-29 17:41 |    \t\t小鸡鸡 \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:10        )\t\t \n  没管理权限的能拿到shell 嘛？    \n     2013-03-30 20:20 |    \t\t小沛 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:3        | 大数据时代来领,求租大数据 531827272#qq.c...)\t\t \n  做等公开    \n     2013-03-31 13:56 |    \t\tyy520 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:12        )\t\t \n  carbuyaction 的话， 我可以告诉你网上那个和这个的点是不一样么....    \n     2013-04-03 18:01 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  @yy520 必须不一样的。这个是二次覆盖了cookies->get 你懂的    \n     2013-04-28 20:23 |    \t\tb4dboy \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:3        | good bye)\t\t \n  那尼    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}