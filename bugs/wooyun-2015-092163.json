{"id": 46212, "wybug_id": "wooyun-2015-092163", "wybug_title": "奇虎360一处SSRF可探测内网(附送url跳转)", "wybug_corp": "奇虎360", "wybug_author": "kttzd", "wybug_date": "2015-01-16 10:15", "wybug_open_date": "2015-03-02 10:16", "wybug_type": "敏感信息泄露", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-16：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-01-16：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-01-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-02-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-02：\t细节向公众公开  简要描述： 一处ssrf及url跳转 详细说明：  ssrf问题地址：        http://ce.cloud.360.cn/其中\"网站评分\"可以访问到内网本地127.0.0.1测试\n\n未进行过多测试，通过 WooYun: 利用两个鸡肋SSRF探测360内网 地址得到10.108.79.189/24网段存在大量80端口测试：\n\n\n\n比较有意思的一个.\n\n但是在本人提交漏洞的前夕，又进行了一次测试。发现输入ip后返回检测超时或者其他错误信息。这时候我又发现了一处ssrf。通过ping检测，检测http://10.108.79.176:80返回很多节点的信息，查找到ping通的节点(ping通既为同一内网，同时页面也返回了节点信息)，挂上代理服务器，点击get，抓包。我选取的是106号节点\n\n返回\n\n如果是端口探测，例如10.108.79.123直接在http://10.108.79.123后面加上端口。如果存在者返回Failure when receiving data from the peer，不存在返回Couldn't connect to server点到为止，这个比之前那个快多了。返回的信息也更多url跳转：地址        http://errsug.se.360.cn/errsug.htm?ver=5.0.3.9&url=http://target.com/&domain=target.com&code=2146697211&ed其中url和domain为问题参数。domain可为任意参数。但是不能缺省这个url跳转有一定的限制  url处只能为http://360.cn这种，而不能是http://www.360.cn 测试        http://errsug.se.360.cn/errsug.htm?ver=5.0.3.9&url=http://360.cn/&domain=360.cn&code=2146697211&ed      http://errsug.se.360.cn/errsug.htm?ver=5.0.3.9&url=http://baidu.com/&domain=baidu.com&code=2146697211&ed     http://errsug.se.360.cn/errsug.htm?ver=5.0.3.9&url=http://baidu.com/&domain=1&code=2146697211&ed未进一步测试   漏洞证明：  略   修复方案：  你们更懂   版权声明：转载请注明来源 kttzd@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-01-16 15:06 厂商回复： 感谢您的反馈，相关业务已进行修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-16 10:24 |    \t\t袋鼠爸爸 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:5        | \"><img src=x onerror=alert(1);</img>)\t\t \n  最近大家都喜欢ssrf了么？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}