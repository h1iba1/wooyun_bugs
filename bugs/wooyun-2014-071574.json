{"id": 134, "wybug_id": "wooyun-2014-071574", "wybug_title": "骑士CMS存储型等XSS", "wybug_corp": "74c,s.com", "wybug_author": "随随意意", "wybug_date": "2014-08-11 17:19", "wybug_open_date": "2014-11-09 17:20", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-16：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-09：\t细节向公众公开  简要描述： 你们防护做的挺好，我X的十分不容易，加上漏洞影响，自评16rank/*,*/走小厂商又只有1/4rank不如给20吧  —，— 详细说明：  #1      先来个 反射型xss 当开胃小菜地址：http://demo.74cms.com/jobs/jobs-list.php?key=%c0%22;eval(String.fromCharCode(97,108,101,114,116,40,100,111,99,117,109,101,110,116,46,99,111,111,107,105,101,41))//影响：通杀全部浏览器详情：主页搜所后源码定位\n\n搜索框有一定的限制，直接在key输入想写的语句http://demo.74cms.com/jobs/jobs-list.php?key=输入引号会闭合会被过滤为\\\"因为是gb系列编码，引号前面输入%c0把\\杀死就ok了起初我以为;分号也被过滤，地址栏把分号换为换行符%0a同样执行。\n\n#2      这里过滤严格，让我十分蛋疼地址：http://demo.74cms.com/train/train-agency-show.php?id=36影响：所有版本IE（测试了6-8）详情：\n\n机构名称出写入\"style=a:expre/**/ssion(&#97;lert(1))就可以绕过过滤了。\n\n这是我们可控的地址，很不幸过滤的很完善，我测试时差点放弃，3种弹框全被杀，还有其他诡异情况。\n\n顺便说下，本来我想的是插入width和height加大图片面积，再插入个事件，后来准备利用eval，但是好像长度不够，但长度可以firebug或者抓包突破，应该可以通杀浏览器了，我现在太疲惫就不在测试了。   漏洞证明：  你们好好修复吧。\n\n   修复方案：  引号过滤，你们过滤很完善，但可能有些许遗漏，比如eval之类的感觉我说的很清楚了呢。提交bug好卡，传个图片10分钟。   版权声明：转载请注明来源 随随意意@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2014-08-13 13:48 厂商回复： 感谢反馈 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-08-12 12:13 |    \t\t随随意意 \t\t\t( 普通白帽子  |\t\t\t        Rank:160 漏洞数:35        | 我对XSS并非真爱(┬＿┬)最近有人冒充该...)\t\t \n  第二处可以通杀，等修复后再去看看，如果修复完善就算啦，不完善再提交    \n     2015-06-18 10:48 |    \t\tundefined \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | none)\t\t \n  @随随意意 expression  只有老版本的IE可以搞吧？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}