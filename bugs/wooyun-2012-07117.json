{"id": 19414, "wybug_id": "wooyun-2012-07117", "wybug_title": "新浪微博 XSS漏洞", "wybug_corp": "新浪", "wybug_author": "WebSPRing", "wybug_date": "2012-05-14 17:27", "wybug_open_date": "2012-06-28 17:27", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "12", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-05-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-05-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-05-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-06-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-06-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-06-28：\t细节向公众公开  简要描述： 新浪微博搜索存储型XSS漏洞：两洞结合利用 详细说明：  客户端绕过漏洞：新浪微博“发起投票”功能对标题（25字）、选项（20字）都进行了字数限制，但是只是客户端限制，通过代理可绕过。注入脚本如图1所示。XSS漏洞：直接到投票页，注入的脚本会被HTML转义。但是通过微博的搜索功能，用脚本相关的关键词（如：iframe onload）进行 投票搜索 时，出现的搜索结果包含注入的脚本，并触发脚本执行！如图2所示。简单利用：只需将搜索连接放到微博中，点击即中。   漏洞证明：  \n\n图1 注入脚本\n\n图2 脚本执行   修复方案：  服务端验证输入限制，对所有搜索输出的内容审查一下吧   版权声明：转载请注明来源 WebSPRing@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2012-05-14 18:16 厂商回复： 感谢提供 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-05-14 17:32 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  关注。。。  weibo的。。。  能不能蠕虫？    \n     2012-05-14 17:36 |    \t\tAdra1n \t\t\t( 普通白帽子  |\t\t\t        Rank:437 漏洞数:68        )\t\t \n  关注下，微薄的xss    \n     2012-05-14 17:36 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  同上....    \n     2012-05-15 10:02 |    \t\tWebSPRing \t\t\t( 普通白帽子  |\t\t\t        Rank:176 漏洞数:18        | Focus on Web Security (wspringox@gmail.c...)\t\t \n  @蟋蟀哥哥 可以    \n     2012-05-15 10:11 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  @WebSPRing 额。。那就牛了呢    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}