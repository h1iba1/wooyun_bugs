{"id": 47201, "wybug_id": "wooyun-2015-094215", "wybug_title": "再探广东广电U互动网络电视机顶盒服务（大量敏感信息泄漏）", "wybug_corp": "广东省广播电视网络股份有限公司", "wybug_author": "路人甲", "wybug_date": "2015-01-27 17:06", "wybug_open_date": "2015-02-01 17:08", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-01-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-02-01：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 如题。 详细说明：  上一次对该服务进行探测的时候，采用的是“由点及面，遍地撒网”的方式。而这一次，通过对机顶盒与有线网络的通讯进行监听，我将有针对性的指出其中尚存在问题的地方。一.在打开机顶盒后，首先出现的便是这个画面\n\n（图一）同时，机顶盒发出了两条请求：http://172.24.200.171/portal/demand/getRecommendNew.action?identify=notice\n\n（图二）和http://172.24.200.171/portal/demand/getRecommendNew.action?identify=index\n\n（图三）。而这个页面起的就是导航的作用。不难发现，第一个链接请求的是图一中下方文字部分，第二个链接请求的是旁边的配图。\n\n\n\n（图四—图五）。在收看某一频道的的节目预告时，机顶盒会发出一个指向同一ip的请求：http:// 172.24.200.171/GetPrograms?client=xxx&resultType=json&channelIds=1409&month=1&day=25。所以，就观看电视而言，172.24.200.171 这个ip提供的服务的重要性不言而喻。但是，该机器上所使用的struct框架存在s2-009漏洞\n\n（图六）。在getshell的过程中，发现nginx的配置文件中禁止了jsp文件的执行\n\n（图七）。为了不影响该系统的正常工作，我未对该配置文件做修改。此次测试到此为止，仅作说明。二.在使用机顶盒中的“营业厅”服务时，机顶盒会发送一条请求：http://10.205.22.158/appweb/login/login!checkLoginfoFromTV?keyno=xxx&regionCode=aaaa来获取用户的信息。其中keyno为用户的服务编号，存在于用户IC卡中。该请求将会返回用户的证件号码，住址，联系方式。而该系统在处理这一请求时未严格验证用户身份，导致用户信息可遍历。虽然存在regionCode这一参数，但实际测试时发现只要keyno存在，不管regionCode为什么值，用户信息都会返回（详见图八最上方两小图），所以理论上整个省的信息都可遍历得到。以下是部分用户信息：\n\n\n\n（图8-9）   漏洞证明：  有图有真相。   修复方案：  引用猪猪侠的一句话吧：“安全是一个整体，保证安全不在于强大的地方有多强大，而在于真正薄弱的地方在哪里。”。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-02-01 17:08 厂商回复：  漏洞Rank：20  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-01-27 17:13 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  问题似乎比之前还严重了？    \n     2015-01-27 17:26 |    \t\tf4ck \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:7        | 有些人很牛B，一个漏洞能刷成N个。)\t\t \n  存在的问题一直没改。真让人失望。    \n     2015-01-27 17:31 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  喝茶时间到    \n     2015-01-27 19:03 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  CCAV看这里！    \n     2015-02-01 18:02 |    \t\t看灰机 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 1)\t\t \n  你敢动，就有人抓。这种漏洞不补也不会有人轻易去拿来干嘛。    \n     2015-02-01 19:06 |    \t\tYinz \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | //)\t\t \n  求教一下洞主是怎么抓的机顶盒的包的？    \n     2015-02-02 09:26 |    \t\tLongY \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:11        | 强行送一血)\t\t \n  求教一下洞主是怎么抓的机顶盒的包的？    \n     2015-02-04 12:00 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  补分完毕    \n     2015-08-28 23:12 |    \t\tsOnsec \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:24        | 安全是什么...)\t\t \n  连接是怎么抓到的啊    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}