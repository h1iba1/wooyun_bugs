{"id": 48859, "wybug_id": "wooyun-2014-081213", "wybug_title": "京东某处可以重复领取退款以及多处业务控制不严导致的问题", "wybug_corp": "京东商城", "wybug_author": "ddy", "wybug_date": "2014-10-30 13:56", "wybug_open_date": "2014-12-14 13:58", "wybug_type": "网络设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-30：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-11-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-11-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-11-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-12-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-12-14：\t细节向公众公开  简要描述： 0x00本来懒得提交乌云的，但是你们的客服太懒了，我只好来提交吧重复领钱+钓鱼+明文泄漏密保信息，严重吗？妹子快来，和哥哥一起探索京东购物任意金额都可以免运费的大洞洞！ 详细说明：  0x01京东某处可以重复领取退款首先，我买了一个16块包邮的无线鼠标，第三天貌似就坏了，本来想退的，但是客服对我卖萌，我就不好意思退了，于是申请换货\n\nP.S 为了避免打广告的嫌疑，我就涂掉一点点换货之后，貌似很久都没见他们给我退邮费回来于是10月份初我找京东客服问，他当时找我要了订单号，然后说帮我催上周我看余额还没到账，又找客服催一下，这时候客服找我要服务单的单号（就是提交换货申请时候新生成的单号）昨天去京东自营买个飞利浦充电的剃须刀，看到帐号上面有30块余额，就用去了下单好了之后觉得我不应该有这么多余额啊，然后查了下余额明细\n\n估计是我换货的订单给我申请了一次退款，然后申请换货的单又给我申请了一次退款吧\n\n\n\n本来懒得提交乌云的，但是你们的客服太懒了，我只好来提交吧\n\n==============================0x02刚刚在http://zone.wooyun.org/看到有人说京东难URL跳转外站我试了试www.jd.com/pinpai/authcode.php?returnUrl=http%3A%2F%2Fwww.jd.com%2Fpinpai%2F672-14523.html把returnUrl后面参数改了下，真的跳不到外站，而是【机智】地跳回京东首页了刚刚去领顺丰优惠券，居然领取不到，http://active.coupon.jd.com/ilink/couponActiveFront/front_index.action?key=a86e346c8fe14e07b75ea3bd2ba97900&roleId=368219&to=sfbest.jd.com我又看到&to=sfbest.jd.com我淘气地改一下http://active.coupon.jd.com/ilink/couponActiveFront/front_index.action?key=a86e346c8fe14e07b75ea3bd2ba97900&roleId=368219&to=www.qq.com哈哈，点击“返回活动页”跳到企鹅网去了 = =貌似我没注意看页面的文字，只是习惯点一下左边第一个框框而已= ===============================0x03貌似我提交了，好像忽略了 WooYun: 京东某处泄漏用户密保手机和密保邮箱(应加*显示) \nTmxweEt6WlpSMVExY0dsMk5XOXBValZNYlV3MVdXMU9JMlJrZVRyb3I3ZmxqcnZtam9ubWlKRWpOa2xsY1RWaVpYZzFZVWR5TlZsaFdqVk1hVXMxV1NOa1pIazY2SyszNVk2NzVvNko1b2lSSXpZM05UVnhSVFZhUTFnM04zbG1OVnBUU2pWTWFVNDFOalpvTlV4eFJ3PT0=\n==============================0x04比如我们要买一个3块钱的牛肉丝，但是又不想给运费，那怎么办呢\n\n\n\n\n\n我去，买一个 3 块钱的牛肉丝，要给 5 块钱运费啊路人甲说过，乌云的白帽子买东西是不能给运费的！（路人甲：喂！我什么时候说过了。。。）好吧，我们去买一个其他商品加进去，让订单看起来钱多一点\n\n好了，终于免运费了然后提交订单，如果是货到付款的童鞋就跳过这一步，在线支付的就先付款吧然后\n\n\n\n喝一杯茶，然后继续看\n\n\n尊敬的客户，由于您的商品在不同库房或属于不同商家，所以您的订单被拆分为多个子订单分开配送，给您带来的不便还请谅解。\nddy：哈哈没事，拆分吧！我谅解的！\n\n\n\n\n\n\n\n\n\n好了，把不要的取消掉，然后收货的时候只要付3块钱就能免运费拿到牛肉干了，因为订单拆分了如果是在线付款的话，钱会退回到原来支付方式的\n\n============   漏洞证明：  \nVm0wd2QyUXlVWGxXYTJoV1YwZG9WbFl3WkZOVU1WcHpXa2M1VjFKc2JETlhhMk0xVjBaS2MySkVUbGhoTVhCUVZtMTRTMk15VGtWUmJVWlhWakZLU1ZacVNqUlpWMUpYVW01T2FWSnVRazlVVkVKTFUxWmtWMXBJY0d4U2JHdzFWa2QwYzJGR1NuTmpSbWhWVmtWd2RsbHFSbXRYUjFKSVVteFNUbUpGY0VsV2JUQXhWREpHVjFOdVRsaGlSMmhoV1ZSS2IxSkdjRmRYYlVacVlrWmFlVmRyV25kV01rcEpVV3hzVjJGcmEzaFdSRVpyVTBaT2NtRkhhRk5sYlhoWFZtMHhORmxWTUhoV1dHaFlZbFZhY2xWc1VrZFdiRnBZWlVaT1ZXSkdjRmxhU0hCSFZqSkZlVlZZWkZoV2JIQlVXWHBHYTJSV1VuTlZiV3hvWld4YWIxWnRNVEJXTVUxM1RVaG9XR0V4Y0ZsWmJGWmhWa1pTVjFwR1RrNVNia0pIVmpKNGExWlhTa2RqUmxwWFlsaFNNMVpxUm1GU2JVbDZXa1p3VjFKV2NGbFhhMVpoVXpKT1YxcElVbWxTYXpWd1ZtcEtiMWRzV25KWGJHUm9UVlpXTlZaWGVHdFdiVXBIWTBac1dtSkdXbWhXTVZwWFl6RldjMXBHYUZkaVdGRjZWbXBLTUZReFdYZE5XRXBYWVdzMVlWUlZXbmRXUmxweFVtMUdWMDFyTlVoV1J6RkhWVEZLVjJORlZsZGlSMUV3VlZSR1lWWnJNVlpXYXpWVFVrVkZOUT09\n   修复方案：  1.申请退款(补偿)的时候，多填写几个，比如填写订单号，或者售后补偿的单号，检测一下重复的就人工看下吧2.再机智一点，在领取优惠券那边做个钓鱼页。估计能钓到不少（笑话时间：情人节，我大方地给了女朋友1000元支付宝，然后她兴高采烈打开逃堡，我改了本地host文件，盗取了她的支寸宝的钱，结果没多久她哭着来说被骗了，钱丢了，我拍拍她肩膀说，只要她人没丢就好，又给了她1000元）呃我想说，领取优惠券如果跳到钓鱼页，很容易就能盗取到各种信息的3.\nVm0xMGEwNUdiRmhWV0doVllURndUMVp0ZUdGWFJteHpWbTFHVjFKdVFsbGFSVnBoWWtkS1IxTnVhRmRTZWxaUVZteGtSMDVzV25OYVIwWlRVbFJXTmxZeFdtdFdNazE0V2toS1QxWXdXbFJaYkdSdlZVWmFSMWR0ZEZWTlZuQkpWbGQwYTFkSFJqWmlSbWhoVm5wRk1GUlVSbUZqTVhCSldrWmtUbUpGV1RGV2JHUTBWakZXYzFkcldsaGlSbkJYV1ZkMGRrMUdXblJsUms1cVRWWndlRlpYTVhkVk1rcFpZVVpTVjFaV2NGTmFSRVpEVld4Q1ZVMUVNRDA9\n4.\nVm0weE1HRXdOVWRpUm1oV1YwZG9WbGxVUm5kVU1WcDBaVWRHV0ZKdGVIcFdiVEZIVmpGS2RWRnNiR0ZTVm5Cb1dXdGtTMUl4VG5WaFJtUlRaV3hhVVZadGVHdFNNRFZ6VjI1T1lWSXdXbFJWYkZKWFRteFplRmR0ZEZkTmF6RTBWMnRvUzFReFdYZFhiRkphWWtkU2RsWlZXbUZTTVdSMFpFWldUbFp1UWtwV2JHUXdZVEZrU0ZKcVdtbFNiV2hvVm01d1JrMUdVbFZTYlVacVRWaENTbGRyV210VWJVcEdWMVJHVjJKSFVUQldha1pYWXpGa2NsZHNhR2xTYmtKWVYxWmtNR1JyTVVkWGJsSnNVbXMxY1ZSV1duZGxSbHBZVFZoa1ZrMXJjRnBaVlZwVFZqRmFWMk5HVG1GU1JWcEVWbGQ0UTFaVk1VVk5SREE5\n话说，帮我催一下[mask]\n\nmask 区域\n*****860*****\n\n[/mask]这个订单，全部都是京东自营商品，24号下午下单的，我在211限时达送达地区，本来应该是25号（星期六）上午到，中午有个联(yue)谊(pao)Party，结果到现在（2014-10-29 15:59:06）还没开始发货！麻烦快点啊啊啊求京豆 求Rank 求礼物 求各种！！   版权声明：转载请注明来源 ddy@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：2  确认时间：2014-11-03 17:11 厂商回复： 非常感谢您对京东的关注！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-30 14:13 |    \t\t浩天  \t\t\t( 普通白帽子  |\t\t\t        Rank:915 漏洞数:79        | 度假中...)\t\t \n  重复退款楼主给花了是吧    \n     2014-10-30 14:46 |    \t\tddy \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:16        | 其实第一次要我挖洞我是拒绝的。因为，你不...)\t\t \n  @浩天 @京东 和客服说了，重复退款，但是客服好像没看懂我的意思，然后。。我就。。来乌云提交算了    \n     2014-10-30 15:54 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @ddy 还是乌云靠谱    \n     2014-10-30 18:51 |    \t\t第四维度 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:34        | 谦谦君子，温润如玉)\t\t \n  求细节    \n     2014-11-03 17:53 |    \t\tchar \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 中国平安，不只保险这么简单。)\t\t \n  你好请开门，京东快递。    \n     2014-11-04 16:30 |    \t\t维京海盗 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | nothing)\t\t \n  运费那个能不提么...以后还怎么买东西...    \n     2014-11-18 16:34 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @疯狗 不靠谱    \n     2014-11-19 18:45 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @小龙 为毛    \n     2014-11-19 22:18 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @疯狗 因为我另一个号的洞还没发钱    \n     2014-11-23 23:58 |    \t\tF4K3R \t\t\t( 普通白帽子  |\t\t\t        Rank:297 漏洞数:31        | 学习)\t\t \n  我很想知道你的牛肉干吃了没有！！！    \n     2014-11-24 15:15 |    \t\tddy \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:16        | 其实第一次要我挖洞我是拒绝的。因为，你不...)\t\t \n  @F4K3R 提交完洞，顺便也取消掉了= =    \n     2014-11-24 16:25 |    \t\tF4K3R \t\t\t( 普通白帽子  |\t\t\t        Rank:297 漏洞数:31        | 学习)\t\t \n  @ddy - -！    \n     2014-11-24 23:00 |    \t\tddy \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:16        | 其实第一次要我挖洞我是拒绝的。因为，你不...)\t\t \n  @F4K3R 现在貌似修复了，取消也要扣500豆（约5元，即不满39元要给的5元运费）    \n     2014-12-14 14:45 |    \t\tEv1l \t\t\t( 实习白帽子  |\t\t\t        Rank:68 漏洞数:20        | 问题真实存在但影响不大。联系邮箱security...)\t\t \n  2rank 同时 感觉洞主打的一手好码……推荐洞主用苏菲夜用 防止个人信息侧漏哦~    \n     2014-12-14 21:09 |    \t\tddy \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:16        | 其实第一次要我挖洞我是拒绝的。因为，你不...)\t\t \n  @Ev1l http://security.jd.com/index.php/Index/montop    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 2, "Ranks": null}