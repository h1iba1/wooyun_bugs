{"id": 74148, "wybug_id": "wooyun-2016-0167996", "wybug_title": "联行支付某站小口子撕开（涉及多个大学学生缴费情况及个人信息/已获取主server邮件系统/多个数据库信息量巨大）", "wybug_corp": "联行支付", "wybug_author": "路人甲", "wybug_date": "2016-01-07 11:05", "wybug_open_date": "2016-02-20 15:48", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-07：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-06：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-20：\t细节向公众公开  简要描述： 附上:写shell技巧不知道联行支付具体位置在山东哪？公司招聘运维安全人员嘛？ 详细说明：  60.208.86.109  从没有任何标识到分析config.xml 到最后的写马，尝试多次均失败。weblogic的配置太过于复杂，分析不出host，而且反查也查不到域名，http://sdau.ecpay.cn发现个山东农业大学报名缴费系统，联行支持的，忽然想到，可以用find + css文件定位，实践成功写马，http://sdau.ecpay.cn/2.jsp carry  进去了才发现别有洞天，reg.ecpay.cn service.ecpay.cn 都绑定在这个IP上，通过分析，获取到三个可用数据库配置以及主server mail账号，通过对数据库的配置发现大量学生缴费以及个人信息，还有大量的账户信息，涉及到部分注册账号。成功登陆到mail系统，大量的收发邮件。。。\n<value>smtp.ecpay.cn</value>\t\t</property>\t\t<property name=\"mailServerPort\">\t\t<value>25</value>\t\t</property>\t\t\t<property name=\"fromAddress\">\t\t<value>server@ecpay.cn</value>\t\t</property>\t\t<property name=\"username\">\t\t<value>server@ecpay.cn</value>\t\t</property>\t\t<property name=\"password\">\t\t<value>server163@@</value>\t\t</property>\t\t<property name=\"subject\">  <jdbc-driver-params>    <url>jdbc:oracle:thin:@192.168.10.22:1521:cecpay</url>    <driver-name>oracle.jdbc.OracleDriver</driver-name>    <properties>      <property>        <name>user</name>        <value>reg</value>      </property>    </properties>    <password-encrypted>{AES}CUlK34Fwu5TusdBz69CgGYEqXv/nZHwjUDYtERSTz3M=</password-encrypted>  qazsew123a?  <jdbc-driver-params>    <url>jdbc:oracle:thin:@192.168.10.22:1521:cecpay</url>    <driver-name>oracle.jdbc.OracleDriver</driver-name>    <properties>      <property>        <name>user</name>        <value>service</value>      </property>    </properties>    <password-encrypted>{AES}I9taZwwh9svbyZHG19KL2Xb0+DZthHCuor7hufFuzdY=</password-encrypted>  123456  <jdbc-driver-params>    <url>jdbc:oracle:thin:@192.168.10.22:1521:cecpay</url>    <driver-name>oracle.jdbc.OracleDriver</driver-name>    <properties>      <property>        <name>user</name>        <value>verify</value>      </property>    </properties>    <password-encrypted>{AES}K5z7yElWRy9IaLF/XkuCfRqEyCRDcMC3doHOyUzQtNA=</password-encrypted> 123456\n附上数据库及mail配置数据。   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nQuery#0 : select t.TABLE_NAME,t.NUM_ROWS from user_tables t order by NUM_ROWS descTABLE_NAMEVARCHAR2\tNUM_ROWSNUMBERAPPLY_UPDATE_LOG\t EXAM_20152016NCZXJF\t EXAM_2015NXBNYJSYYYSLJBMKS\t EXAM_2015NXBNYYSLJBMKS\t EXAM_KS\t EXAM_NDXYYSLJBMKS\t EXAM_NFJNPT\t EXAM_NYYSLJBMKS\t EXAM_QUERY\t EXAM_QUERY_GROUP\t EXAM_QUERY_LOG\t EXAM_ZZYJSZYKRXKSJFPT\t REG_ACCOUNT\t REG_ACC_EXAM\t REG_ACC_EXAM_PAYMENT\t REG_ACC_EXAM_PAYMENT_LS\t REG_BILL\t REG_BILLD_ETAIL\t REG_DATA_RIGHT\t REG_DIC\t REG_DIC_COPY\t REG_DIC_DATA\t REG_DIC_DATA_COPY\t REG_ENTRY_FORM\t REG_ENTRY_FORM_ADVANCE\t REG_ENTRY_FORM_ADVANCE_COPY\t REG_ENTRY_FORM_COPY\t REG_ENTRY_FORM_FIELD\t REG_ENTRY_FORM_FIELD_COPY\t REG_EXAM\t REG_EXAM_INSTRUCTION\t REG_EXAM_NAME\t REG_EXAM_PAYMENT\t REG_EXAM_UPLOAD\t REG_EXAM_UPLOAD_FILE\t REG_FUNCTION_FOLDER\t REG_INTERFACE_TEMPLATE\t REG_MOUDLE\t REG_ORGCODE\t REG_RESOURCE\t REG_RESOURCE_RIGHT\t REG_ROLE\t REG_STUDENT_INFO_META\t REG_TRANSACTION\t REG_USERCODE\t REG_VALIDATE_RULE\n某个数据库结构。   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2016-01-07 12:23 厂商回复： 非常感谢您的报告，问题已处理。如果有任何问题，欢迎反馈，我们会有专人跟进处理。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2016-01-07 11:14 |    \t\t帅 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:2        | 一个正经的JAVA程序猿)\t\t \n  济南高新区舜华路    \n     2016-01-07 11:26 |    \t\tk0_pwn \t\t\t( 实习白帽子  |\t\t\t        Rank:95 漏洞数:12        | 专注且自由)\t\t \n  小口子。。。    \n     2016-01-07 11:45 |    \t\tAasron \t\t\t( 普通白帽子  |\t\t\t        Rank:210 漏洞数:59        | 工欲善其事，必先利其器)\t\t \n  我是来看教程的    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}