{"id": 21457, "wybug_id": "wooyun-2012-04157", "wybug_title": "深圳地铁 带票出站漏洞", "wybug_corp": "深圳地铁", "wybug_author": "网络骑士", "wybug_date": "2012-02-02 17:20", "wybug_open_date": "2012-02-02 17:20", "wybug_type": "设计不当", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当", "支付行业敏感", "非安全类", "地铁"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-02-02：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2012-02-02：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 购买单程地铁票，在出站时是需要将票投入闸机以便回收利用的。哥蹲坑的时候突发灵感，想出一个非常规的出站方法，发现不用将票回收也可以出站。经过测试，证实方法可行。 详细说明：  方法很简单，买单程票，到站不下车，故意坐过站坐到下一站，然后到出站口将票投入闸机，会提示余额不足而不开门并将地铁票退回（最好投入奇数次，建议投3次），但是此时，该地铁票的状态已经被修改为已出站状态。然后拿着退回来的票，坐回买票时输入的车站，出站的时候，将票投入闸机，会因为该票为已出站状态而当成进站动作处理。于是闸机的门会打开，同时，票依然会退出来给你。然后就可以拿着出站了。   漏洞证明：  从东门站买到深大站的票，进站，坐到深大站不下车，到桃园站下。到出口闸机，将票投入闸机并取回来3次，坐回深大站，正常将票投入闸机，将退还的票带着出站。至于带出来的票是否能再次进站，暂时还没去验证，若是能的话，等于买一次地铁票，可以永久免费坐地铁了。   修复方案：  不要把责任推给无证程序员就是了。   版权声明：转载请注明来源 网络骑士@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：8 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2012-02-02 17:43 |    \t\tnodexy \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | nodexy - Another developer)\t\t \n  那下次进站的时候如果真的还可以用，就夸张了。我改天也试试    \n     2012-02-02 17:50 |    \t\tubuntu \t\t\t( 普通白帽子  |\t\t\t        Rank:148 漏洞数:12        | 一切皆有可能……)\t\t \n  有意思，O(∩_∩)O哈哈~ 官方有可能解释是临时工干的……    \n     2012-02-02 18:03 |    \t\ticefish \t\t\t( 普通白帽子  |\t\t\t        Rank:104 漏洞数:8        | 欢迎大家和我用邮件进行交流~)\t\t \n  我勒个去，现在漏洞真是各种各样啊     \n     2012-02-02 18:08 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  呵呵 我看到作者的 那个剩下的票    \n     2012-02-02 18:10 |    \t\t网络骑士 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:4        | 低调是最NB的炫耀！高调是要被打的征兆！)\t\t \n  其实我手头还有个免费坐地铁的漏洞    \n     2012-02-02 18:11 |    \t\tking \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:2        | 喜爱安全，网络游戏安全应用漏洞挖掘)\t\t \n  什么漏洞 透露下呗    \n     2012-02-02 18:11 |    \t\t网络骑士 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:4        | 低调是最NB的炫耀！高调是要被打的征兆！)\t\t \n  进站时..跳过去...出站时..跳出来...All Free...    \n     2012-02-02 19:46 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @网络骑士 我也有修复方案 跳的时候放狗    \n     2012-02-02 19:47 |    \t\tredzl \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | Let's exploit it!)\t\t \n  跳进去太...了.钻过去才低调    \n     2012-02-02 20:15 |    \t\t疏懒 \t\t\t( 普通白帽子  |\t\t\t        Rank:359 漏洞数:42        | 不能尽如人意，但求知足常乐~！)\t\t \n  呵呵...这也可以啊......    \n     2012-02-02 21:40 |    \t\tJian(64bit) \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:15        | 世界上有10种人,懂二进制的和不懂的.)\t\t \n  北京地跌也可以 上次做4号线 买了票最后出站不用回收卡 好像都故障了 最后把票带回了山东 ；）    \n     2012-02-02 22:59 |    \t\t神刀 \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:3        | www.shellsec.com内射那么牛，虾米没妹子？)\t\t \n  有张特权卡路过，你懂的    \n     2012-02-02 23:17 |    \t\t小雨 \t\t\t( 普通白帽子  |\t\t\t        Rank:105 漏洞数:19        | phper)\t\t \n  北京地铁进出站俩人并排走那个很宽的给轮椅用的门就可以的，俩人只需要刷一次卡。    \n     2012-02-02 23:44 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  放狗    \n     2012-02-02 23:45 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  哈哈。明天去罗湖接人，测试一下     \n     2012-02-03 00:12 |    \t\tEnjoy_Hacking \t\t\t( 实习白帽子  |\t\t\t        Rank:84 漏洞数:8        | 时间无言，如此这般。)\t\t \n  哈哈、过几天去测试一下没想到深圳的黑阔这么多    \n     2012-02-03 09:35 |    \t\t水泥中的鱼 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:4        | 我就是我，尘世中一迷途小书童。)\t\t \n  原来黑阔也可以如此欢乐，上海地铁不知道有没有类似的漏洞。    \n     2012-02-03 09:39 |    \t\t网络骑士 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:4        | 低调是最NB的炫耀！高调是要被打的征兆！)\t\t \n  上海地铁为了杜绝地铁销售、乞讨的行为，设置有时间限制，超时出站要补票的，所以在上海不好操作的。    \n     2012-02-03 10:58 |    \t\t疏懒 \t\t\t( 普通白帽子  |\t\t\t        Rank:359 漏洞数:42        | 不能尽如人意，但求知足常乐~！)\t\t \n  在上海，最好的方式还是：跳过去，跳出来，嘿嘿    \n     2012-02-03 13:17 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  直接从出站口上面跳过去就OK了    \n     2012-02-09 09:33 |    \t\tubuntu \t\t\t( 普通白帽子  |\t\t\t        Rank:148 漏洞数:12        | 一切皆有可能……)\t\t \n  这个还上地铁早8点了，O(∩_∩)O哈哈~    \n     2012-02-09 09:45 |    \t\t网络骑士 \t\t\t( 实习白帽子  |\t\t\t        Rank:43 漏洞数:4        | 低调是最NB的炫耀！高调是要被打的征兆！)\t\t \n  呵呵，去测试了一下，那张带出来的票票不能再次进站，不晓得是不是补掉了。    \n     2012-02-22 23:14 |    \t\tsaga \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:2        | 世界上只有10种人，懂二进制的，和不懂二进...)\t\t \n  有人看着应该不太好搞，会被盘问    \n     2012-02-24 23:29 |    \t\tby china \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  看监控的被你迷糊了、、、    \n     2012-03-05 18:52 |    \t\tadwin \t\t\t( 普通白帽子  |\t\t\t        Rank:112 漏洞数:11        | 小菜请多指教。)\t\t \n  = =，哪位黑阔搞个坐火车或者灰机不用买票的洞洞出来。    \n     2012-03-07 12:47 |    \t\t大肠 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 入侵研究 seo技术)\t\t \n  有才    \n     2012-03-07 13:36 |    \t\tJian(64bit) \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:15        | 世界上有10种人,懂二进制的和不懂的.)\t\t \n  @adwin 藏在飞机下面 趴在飞机上面     \n     2012-03-27 22:06 |    \t\tFrankie \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 你存在,我的代码里...Line 0://你)\t\t \n  这 ....话说来深圳许久为用过那玩意...    \n     2012-04-30 13:29 |    \t\tSay \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:4        | 谁又会鉴定谁正常？)\t\t \n  = = 这个欢乐 ....    \n     2012-05-03 12:46 |    \t\t神倦懒言 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 从事php开发以及服务器的运维工作，还是菜...)\t\t \n  怎么有点奇思妙想的感觉，神奇的思维，这才叫为国家做贡献啊，让老外搞几个这种漏洞就不好了— —！    \n     2012-05-11 00:52 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  @xsser @网络骑士 红外线+血滴子，完美组合，割断你们这群屌丝的狗腿，哈    \n     2012-05-27 11:54 |    \t\tadsltsee \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 这个家伙很懒，什么也没留下...)\t\t \n  深圳人民有福了。。哈哈 。。广州的谁去测试下    \n     2012-05-28 12:52 |    \t\t小博 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:4        | 一个关注与信息安全 程序开发的IT程序员)\t\t \n  在上海  还有种方法 就是一人在投票的时候你紧跟着前面那人一起出去 表示和同事 尝试过 哈哈    \n     2012-05-31 17:44 |    \t\tMaster \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:10        )\t\t \n  我表示北京地铁一号线这边的闸门很一般，一下就能出去N个人，广州那边就没有那么好了，人刚过去就关闭了。    \n     2012-06-08 10:58 |    \t\tisno \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:3        | test)\t\t \n  其实我也研究出了我们公司大厦停车刷卡计费的漏洞了，不过就不在这里发了。    \n     2012-06-08 10:59 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @isno 不发木有小jj    \n     2012-07-10 14:26 |    \t\tVty \t\t\t( 普通白帽子  |\t\t\t        Rank:199 漏洞数:37        )\t\t \n  黑阔啊，这样也行    \n     2012-08-08 20:38 |    \t\tDolphin \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:2        | 这个人很懒，只留下一直海豚，哈哈哈！)\t\t \n  程序漏洞真是无处不在啊。    \n     2012-09-07 17:06 |    \t\t一个人穷浪漫 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 供职于国内某大型IT公司,爱好Windows批处理...)\t\t \n  有意思哈哈    \n     2012-09-07 17:35 |    \t\tNimda \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 人的欲望就是一个超级大坑，永远也填不满。...)\t\t \n  我擦，这也行 哈哈    \n     2012-10-15 08:40 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  这个真是太有爱了    \n     2012-11-30 19:25 |    \t\tBlack World \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 无孔不入)\t\t \n  人才 。。    \n     2013-04-03 14:20 |    \t\t小野 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:2        | 低调~)\t\t \n  @ubuntu 官方解释你都想好了 哈哈    \n     2013-05-13 04:22 |    \t\tFu2k \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | Hacker is an art, a kind of spirit, do n...)\t\t \n  有空我去研究一下SH地铁看看是否会出现这种情况  哈哈。    \n     2013-06-13 12:27 |    \t\tJ4mins \t\t\t( 实习白帽子  |\t\t\t        Rank:39 漏洞数:12        | Location: London,Ontario)\t\t \n  同是深圳人!     \n     2013-07-13 16:53 |    \t\t乔治 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        )\t\t \n  哇，8错！    \n     2013-07-20 10:45 |    \t\t白细胞 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:6        )\t\t \n  @网络骑士 淫才，这个漏洞我也知道，就怕跨度太大跳不过去。    \n     2013-07-22 17:59 |    \t\tHuc-Unis \t\t\t( 普通白帽子  |\t\t\t        Rank:1055 漏洞数:292        | 诶，现在通用奖励越来越低了；离买保时捷卡...)\t\t \n  这种漏洞都出的来！淫才啊！    \n     2013-07-22 21:58 |    \t\t鸟嘌呤 \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:1        | 热爱生活，热爱网络)\t\t \n  淫才。。。    \n     2013-07-28 03:38 |    \t\tjuuxdd \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | ส)\t\t \n  哈哈，神奇的乌云！    \n     2013-08-20 14:55 |    \t\tIron.Xia \t\t\t( 路人 |\t\t\t        Rank:2 漏洞数:3        | 小菜鸟一个，从事IT风险管理)\t\t \n  好猥琐，上海的有嘛！    \n     2013-08-23 16:11 |    \t\tmine \t\t\t( 路人 |\t\t\t        Rank:23 漏洞数:2        | 大道至简)\t\t \n  拿出去以后是否可以再利用呢？    \n     2013-09-01 21:09 |    \t\th35h4n9 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 92后网络安全爱好者)\t\t \n  我了个擦这个漏洞。。。。人才    \n     2013-09-16 04:01 |    \t\tmramydnei \t\t\t( 普通白帽子  |\t\t\t        Rank:348 漏洞数:80        )\t\t \n  其实日本的电车也有这个洞    \n     2013-09-17 18:26 |    \t\t船长 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:4        )\t\t \n  采用了  3Q    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 8, "Ranks": null}