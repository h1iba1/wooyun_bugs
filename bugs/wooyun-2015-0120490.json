{"id": 11412, "wybug_id": "wooyun-2015-0120490", "wybug_title": "苏宁易购漏洞大礼包（某内部系统5W+弱口令、任意文件上传、1566台服务器密码泄漏）", "wybug_corp": "江苏苏宁易购电子商务有限公司", "wybug_author": "niliu", "wybug_date": "2015-06-14 19:20", "wybug_open_date": "2015-07-30 18:12", "wybug_type": "内部绝密信息泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "内部敏感信息泄露"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向公众公开  简要描述： 由于信息比较敏感，不便深入测试了，希望厂商尽快修复吧。 详细说明：  这次主要以内部系统和通讯平台为主。先说一下内部平台问题1.\nhttp://ydxuexi.cnsuning.com/clp/redirectLogin.htm\n 内部云店学习平台\n\n无验证码，后端也没有放爆破机制看了下源文件\nif (self != top) {\ttop.location = self.location;};$().ready( function() {\tvar $errorMsgTip=$(\"#errorMsgTip\");\t$(\"#login-btn\").click(function(){\t\tvar $username = $(\"#j_username\");\t\tvar $password = $(\"#j_password\");\t\tif ($username.val() == \"请输入SOA工号\" || $username.val() == \"\") {\t\t\t$errorMsgTip.html(\"请输入SOA工号\");\t\t\t$errorMsgTip.show();\t\t\treturn false;\t\t}\n发现苏宁的内部系统都是以工号进行认证的，并且通用。只要其中一个系统接口有问题，撞出来的密码其他内部系统都可以登录。\n\n同时内部社区也可以登录2.内部云店社区\nhttp://ydxuexi.cnsuning.com/clp/bbs/login.htm\n\n\n3.苏宁人系统\nhttp://snr.cnsuning.com/snr/redirectLogin.htm\n都是通用的\n\n这些系统接口都没有验证。另外苏宁人--个人中心头像上传没有任何限制，可传任意文件\nPOST /snr/personCenter/uploadHeadImg.htm HTTP/1.1Host: snr.cnsuning.comUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.9; rv:38.0) Gecko/20100101 Firefox/38.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://snr.cnsuning.com/snr/info/index.htmCookie: Connection: keep-aliveContent-Type: multipart/form-data; boundary=---------------------------69963336012649141951472253712Content-Length: 5246-----------------------------69963336012649141951472253712Content-Disposition: form-data; name=\"root\"/snr/res/images/headimg-----------------------------69963336012649141951472253712Content-Disposition: form-data; name=\"headfile\"; filename=\"touxiang.txt\"Content-Type: application/octet-streamniliu@wooyun-----------------------------69963336012649141951472253712--\n目录可控，后缀可控，只是所有可用目录无执行权限...证明http://snr.cnsuning.com/static/1434267359613.txt\n\n另外还有一处信息泄露\nhttp://snr.cnsuning.com/server-status\n\n\n另一处信息泄露\nhttp://sso.cnsuning.com/server-status\n\n\n   漏洞证明：  最重要的是员工号命名规则被猜解出，仅仅撞了一个固定弱口令就撞出来5W+弱口令相关接口\nPOST /IMuserAPI/v1/login/getimurl.do HTTP/1.1Host: imapp.suning.comUM_SYSTEM=UWPPORTAL&UUM_COMPANYCODE=oa.cnsuning.com&username=§10****01§&password=§****§\n根据用户名命名规则生产了一个72W的用户名字典，测试成功如下\n\n这些弱口令配合上一个漏洞里提到的内部豆芽系统，登录了几个账号看了一下。豆芽是苏宁自己开发的类似QQ和微信的软件。里面有企业所有的组织架构，员工联系方式，手机号，邮箱，职位信息等等。其中APP接口可以批量获取数据。除了这些基本信息，登录后会同步改用户之前的所有聊天记录，云盘文件等等。其中登录到了几个运维部门的账号 发现泄漏的信息太敏感，就没再深入测试了。\n\n\n\n\n\n另外发现一个excel表格，打开后吓尿了...9个工作表统计了一下620+138+306+301+30+171=1566台服务器IP+密码等信息\n\n就不过多的截图不证明了。如果配合一个内网shell或vpn后果将不堪设想。请厂商赶紧修复吧！   修复方案：  我觉得问题的根源身份认证方式1.内部系统对外接口没有限制，可猜测大量的账号密码。\n建议内部系统统一一个认证接口登陆，加强认证防止撞库。可加入手机短信认证等\n2.系统间身份认证又是通用的，才导致进一步的严重信息泄漏。\n不同系统最好使用不同的密码，通用密码害死人啊。。\n3.密码使用规则没有统一标准要求。豆芽系统重要程度不亚于邮件系统。\n加强内部系统密码生产强度，特殊字符，大小写字母，数字，长度等方面\n4。测试的时候发现厂商可能已经检测到此次测试行为，并对泄漏的密码进行了限制登录。这一点还是比较赞的。希望没对厂商业务造成影响。实在抱歉！   版权声明：转载请注明来源 niliu@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-06-15 18:11 厂商回复： 感谢提交，稍后送上礼品卡。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-14 19:25 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  ..................要不要这么屌    \n     2015-06-14 19:54 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @小川 再打个雷就更好了    \n     2015-06-14 20:04 |    \t\tluwikes \t\t\t( 普通白帽子  |\t\t\t        Rank:512 漏洞数:77        | 潜心学习~~~)\t\t \n  雷了..    \n     2015-06-14 20:07 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @niliu 5W个弱口令。、、    \n     2015-06-14 20:07 |    \t\t高小厨 \t\t\t( 普通白帽子  |\t\t\t        Rank:814 漏洞数:74        | 不会吹牛的小二不是好厨子！)\t\t \n  屌    \n     2015-06-14 20:08 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @px1624 其实远远不止    \n     2015-06-14 20:15 |    \t\t爱上平顶山  \t\t\t( 核心白帽子 |\t\t\t        Rank:2738 漏洞数:547        | [不戴帽子]异乡过客.曾就职于天朝某机构.IT...)\t\t \n  赞    \n     2015-06-14 21:10 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  @niliu 弱口令才是王道啊    \n     2015-06-14 21:19 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  目测应该是初始密码。员工安全意识不足    \n     2015-06-14 21:37 |    \t\tniliu  \t\t\t( 核心白帽子 |\t\t\t        Rank:1542 漏洞数:206        | 逆流而上)\t\t \n  @小川 川神见笑了哈    \n     2015-06-14 21:50 |    \t\t卡卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:447 漏洞数:52        | <script>alert('安全团队长期招人')</scrip...)\t\t \n  1566台服务器！！！    \n     2015-06-14 21:58 |    \t\t0x 80 \t\t\t( 普通白帽子  |\t\t\t        Rank:1301 漏洞数:398        | 某安全公司招聘系统运维、渗透测试、安全运...)\t\t \n  苏宁怎么了    \n     2015-06-14 22:20 |    \t\t小龙 \t\t\t( 普通白帽子  |\t\t\t        Rank:1208 漏洞数:316        | 乌云有着这么一群人，在乌云学技术，去某数...)\t\t \n  @0x 80 苏宁最近怀孕了    \n     2015-06-14 22:37 |    \t\t泪雨无魂 \t\t\t( 实习白帽子  |\t\t\t        Rank:94 漏洞数:32        )\t\t \n  屌。。    \n     2015-06-14 22:38 |    \t\t大亮 \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:65        | 慢慢挖洞)\t\t \n  膜拜。。    \n     2015-06-14 23:38 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  牛逼    \n     2015-06-15 00:00 |    \t\t毕月乌 \t\t\t( 普通白帽子  |\t\t\t        Rank:120 漏洞数:16        | 猜猜我是谁？)\t\t \n  好大的礼包~    \n     2015-06-15 08:58 |    \t\tzzR  \t\t\t( 核心白帽子 |\t\t\t        Rank:1382 漏洞数:122        | 收wb   1：5 无限量收   [平台担保])\t\t \n  当年我发现主站所有生产环境服务器、数据库全用户名、密码，奖励了50大洋!！哼！    \n     2015-06-15 23:10 |    \t\t黑吃黑 \t\t\t( 普通白帽子  |\t\t\t        Rank:139 漏洞数:29        | 倚楼听风雨，淡看江湖路...)\t\t \n  目测很多初始密码，弱口令是永远的硬伤    \n     2015-06-16 00:04 |    \t\t秋风 \t\t\t( 普通白帽子  |\t\t\t        Rank:438 漏洞数:44        | 码农一枚，关注互联网安全)\t\t \n  NB!    \n     2015-06-16 00:11 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  牛逼啊！    \n     2015-06-17 16:34 |    \t\tNorth \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:5        | 123456789)\t\t \n  大神，请收下我的膝盖。     \n     2015-08-17 22:00 |    \t\tsuolong \t\t\t( 实习白帽子  |\t\t\t        Rank:47 漏洞数:11        | 我有个野心，就是要成为世界第一的贱士！！)\t\t \n  跪了 ！     \n     2015-08-17 22:05 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:186        | 。)\t\t \n  目测固定口令应该是123456 或者是suning123    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}