{"id": 12062, "wybug_id": "wooyun-2013-023171", "wybug_title": "信景商城产品早期版本的漏洞汇总", "wybug_corp": "广州市信景技术有限公司", "wybug_author": "刺刺", "wybug_date": "2013-05-06 19:40", "wybug_open_date": "2013-06-20 19:41", "wybug_type": "重要敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-06：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-06-20：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 商城产品早期版本的漏洞汇总；（乌云上你的客户都不来确认和修复，你快来wooyun吧，绝对超值！） 详细说明：  1. 敏感信息泄漏，这个可以参考：演示就不截图了。 WooYun: 海信商城dwr类测试地址暴露,可查询内部敏感信息 但是这个里面，dwr/test/DWRSearchUserService可以看到部分用户，或者说是管理员权限的用户，有了用户名，配合弱口令（123456），完全可以登录后台管理；（海信商城恰恰存在，已经在wooyun提交了。）2. 直接上传jsp脚本；  比如目前在认领区的“大商网”； WooYun: 大商网任意文件上传，直接webshell   漏洞证明：  1. 敏感信息配合弱口令，拿下官网：   http://www.infoscape.com.cn/dwr/test/DWRSearchUserService猜解了一个管理员的密码，权限极高，系统配置增加jsp类型： \n\n调用OurHome\\htmleditor\\extendfile\\UploadFile.jsp上传jsp脚本木马；取得权限\n\n同样存在类似问题的还有：http://www.taocg.com/dwr/test/DWRSearchUserService权限极高：\n\n这里就不演示上传脚本了。2. 直接上传的问题，\\htmleditor\\extendfile\\UploadFile.jsp注册后调用，除了大商网之外，目前还发现：    http://www.juegg.com    http://www.gg1994.com （这个站点除此之外还有一个会员的头像图片上传，js验证文件类型，可以被绕过上传jsp脚本。）   当然了，这些站点同样存在dwr信息泄漏的问题，但是上传取得权限比较直接和简单，至于有没有弱口令，还请自测。   修复方案：  1. 敏感信息的处理；（确认功能用途，是否可以关闭）2. 弱口令；（检查用户权限，特别是管理员组；培训用户安全意识；程序上可以开发对应的功能，如果检测发现帐号密码是弱口令或者常见口令，强制用户修改；）3. 上传；（确认功能用途，可否删除；如果使用，程序上增加服务端和客户端有关的文件类型的验证；）（上传的jsp脚本一般在upload目录，限制该目录对jsp jspx的执行；时常检查该目录的文件情况；）4.开启架构软件（apache nginx tomcat）的访问日志，制定计划进行分析，或许会发现隐藏的jsp后门或者class类型的后门。（“黑客”无处不在，你们的客户都是电商，不留个后门太可惜了。）   版权声明：转载请注明来源 刺刺@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2013-05-07 08:45 |    \t\t无尾熊 \t\t\t( 路人 |\t\t\t        Rank:14 漏洞数:2        | 菜鸟一枚。。。学习安全技术中。 。。)\t\t \n  Mark一下。。求细节～～    \n     2013-05-07 10:07 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  的确不错的说    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}