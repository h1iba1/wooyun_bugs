{"id": 14518, "wybug_id": "wooyun-2013-016934", "wybug_title": "蘑菇街xss两枚，绕过滤拿妹纸cookie", "wybug_corp": "蘑菇街", "wybug_author": "hqdvista", "wybug_date": "2013-01-05 15:30", "wybug_open_date": "2013-02-19 15:31", "wybug_type": "xss跨站脚本攻击", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-05：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-01-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-04：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-02-19：\t细节向公众公开  简要描述： 蘑菇街xss两枚，可绕过过滤拿妹纸cookie 详细说明：  先来重点的：首先是一个dom型xss，url参数输出在js里面。原始url在http://www.mogujie.com/upload/addpic?callback=parent;prompt(/test/);//&code=3002\n\n刚开始弹窗很容易，可是剑心告诉我们缺乏可以影响他人帐号或数据的证明案例，于是要进一步利用。果然弹document.cookie就弹不出来了\n\n原来是被卡擦掉了，更换大小写也不行。包括document.write document.body.append都被卡擦掉了。但是妹纸还是要跨的，怎么绕？用object.func 等同于object[\"func\"]，于是有document.cookie === document[String.fromCharCode(99,111,111,107,105,101)]\n\n成功pia出。然后构造payload时用document[String.fromCharCode(119,114,105,116,101)] 代替 document.write。这个网页木有body，所以调用document.body.append会null object... 还是用document.append。调用外部js效果如下\n\n——————————————另外一个就是平常的反射xss了，直接弹cookie，木有过滤http://www.mogujie.com/magic/brand/1qi?keyword=1%3C%2ftitle%3E%3Cscript%3Eprompt%28document.cookie%29%3C/script%3E\n\n   漏洞证明：  \n\n   修复方案：  输出的时候encode一下？   版权声明：转载请注明来源 hqdvista@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：6  确认时间：2013-01-05 15:35 厂商回复： 谢谢 朋友， 我们尽快修复！  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-05 19:15 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  楼主V5，我也去蘑菇街转了会，都么找到。。。诶，丧心    \n     2013-01-05 20:03 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @px1624 继续努力撒！蘑菇街礼物很给力的，关键还有一封CTO写的感谢信！    \n     2013-01-05 20:55 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @风萧萧 能透漏下啥礼物不？其实我也觉得蘑菇街挺好 只要确认漏洞 就给送礼    \n     2013-01-06 12:59 |    \t\thqdvista \t\t\t( 普通白帽子  |\t\t\t        Rank:154 漏洞数:31        | N/A)\t\t \n  @风萧萧 球礼物啊，现在还没消息...    \n     2013-01-06 13:20 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @hqdvista 。。。我也发了蘑菇街的 都还没审核。。    \n     2013-01-13 20:00 |    \t\thqdvista \t\t\t( 普通白帽子  |\t\t\t        Rank:154 漏洞数:31        | N/A)\t\t \n  礼物收到了，妹子表示还不错~    \n     2013-04-10 13:41 |    \t\t盛大网络(乌云厂商)\t\t \n  这个还没有彻底修复啊。    \n     2013-04-11 12:26 |    \t\t苏南同学 \t\t\t( 实习白帽子  |\t\t\t        Rank:41 漏洞数:5        | 苏南同学，就是苏南同学~~~)\t\t \n  document.cookie === document[String.fromCharCode(99,111,111,107,105,101) 学习了...    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 6, "Ranks": null}