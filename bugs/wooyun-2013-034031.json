{"id": 10664, "wybug_id": "wooyun-2013-034031", "wybug_title": "安全狗测试--注入篇", "wybug_corp": "安全狗", "wybug_author": "在路上", "wybug_date": "2013-08-10 15:06", "wybug_open_date": "2013-08-15 15:06", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-08-10：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-08-15：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 简单闲的蛋疼，从官方网站上下载http://www.anquangou.cn/  IISv3.0 安装  简单测试一下...希望以此文，庆祝自己变成普通白帽子... 详细说明：  构造一个简单的注入页面asp+sqlserver 开始测试:\n\n绕过:\n\n原来如此简单,顿时信心百倍二、基础篇1.数据流向http://zone.wooyun.org/content/5091学习剑总大作感觉受益匪浅(没有办法这年头不拍马屁，不给过)，正向剑总说的，对于一个请求，在有防护的情况下，数据的流向:data->安全狗->webserver->app->database可见，一个数据流在整个流程中会经过多个\"程序\",而安全狗是优先对数据进行处理，检查到危险就会阻断请求。2.所谓的安全狗被绕过:对于一个有效攻击，安全狗没有正确识别成功阻断，导致攻击成功。3.安全狗被绕过的原因:对于同样的一个请求，安全狗与webserver、app、database理解不同，导致安全狗被绕过。三、测试对于注入，当然是希望获得数据库里面保存的数据了，因此测试:\n\n额，安全狗毫无反应，难道安全狗认为这个没有必要么？也是这个危害是小了一些继续测试 select from\n\n\n\n原来安全狗防护的是select from怎么绕过?就要用到各种安全狗理解上的不同了...1)复参测试首先想到的是80sec牛人说的那个iis复参问题了\n\n发现失败了，安全狗可以识别。2)iis对%解码特性测试有人分析说iis的asp.dll在进行参数url解码存在特性:IIS下的asp.dll文件在对asp文件后参数串进行url解码时，会直接过滤掉09-0d、20、%(下两个字符有一个不是十六进制)字符。将Get请求变成post请求，然后再from的f后面添加一个空格:\n\n绕过成功.3)Unicode编码测试IIS支持unicode编码，因此使用unicode编码看看安全狗是否会拦截?\n\n安全狗没有进行unicode解码4)mssql特性测试\n\n也可以，但是有点鸡肋，在某些情况下可以..四、总结这里仅使用知道的几种方法，测试了一下select from规则，发现安全狗做的还是不错的，但是也存在一定程度的绕过。作为一个网络层防护软件目标应该是实现0攻击，但是在真实环境中,网络层防御的作用是提高攻击的门槛，因为它要考虑一个叫误报的东西…   漏洞证明：  如上   修复方案：  考虑到各种特殊情况即可   版权声明：转载请注明来源 在路上@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-08-15 15:06 厂商回复：  漏洞Rank：10  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-08-10 15:33 |    \t\t有妹子送上 \t\t\t( 实习白帽子  |\t\t\t        Rank:89 漏洞数:28        | 杭州最帅的男人)\t\t \n  在路上杀狗了    \n     2013-08-10 15:37 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  看样子是连载了，洞主先给我签个名吧，不然到时候排队难受~~    \n     2013-08-10 15:45 |    \t\tD＆G \t\t\t( 普通白帽子  |\t\t\t        Rank:523 漏洞数:103        | going)\t\t \n  周末也不出去泡妹子，还在这刷wooyun @有妹子送上 @小胖子     \n     2013-08-10 16:21 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  目测1rank or 忽略    \n     2013-08-10 16:54 |    \t\tQQ852451559 \t\t\t( 实习白帽子  |\t\t\t        Rank:79 漏洞数:18        | 学生党)\t\t \n  玩绕过的.关注先    \n     2013-08-10 17:12 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @VIP 亲爱的上扣扣，找你有事。    \n     2013-08-10 17:22 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @小胖子 求乌云短消息    \n     2013-08-10 18:34 |    \t\t菜菜 \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:7        | 人，可以白手起家，但不可以手无寸铁，紧记...)\t\t \n  看样子是连载了，洞主先给我签个名吧，不然到时候排队难受~~    \n     2013-08-10 19:01 |    \t\t小伟 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:2        | )\t\t \n  火速刘明     \n     2013-08-10 19:33 |    \t\t小痞子 \t\t\t( 普通白帽子  |\t\t\t        Rank:106 漏洞数:21        | <xss>alert(\"a\")</xss>￥&@&……dssKhwjcw...)\t\t \n  忽略吧  让他成不了 普通白帽子 HOHO    \n     2013-08-10 22:13 |    \t\tGrayTrack \t\t\t( 实习白帽子  |\t\t\t        Rank:75 漏洞数:14        | 灰色轨迹)\t\t \n  挖洞，抓老鼠。可妹子不会感兴趣    \n     2013-08-10 23:20 |    \t\tLee Swagger \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:5        | 洗洗睡吧)\t\t \n  狗的 上传 拦截 无法突破上传 JS 来XSS下载 ？  安全狗云备份？    \n     2013-08-11 07:57 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  呵呵，大家都上当了，其实是没有连载的! 最近发几个漏洞总结出来，如果标题太低调，就会被忽略，必须给管理员发邮件...因此这些起个好迷糊的标题，果然秒过...    \n     2013-08-11 10:24 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @在路上 厉害    \n     2013-08-11 11:57 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  @xsser 果然拍马屁有效果，剑总都来礼尚往来    \n     2013-08-11 11:59 |    \t\t脚本小伙 \t\t\t( 实习白帽子  |\t\t\t        Rank:52 漏洞数:15        | 小书童)\t\t \n  这是要杀母狗了！ 屌屌  放出去的小狗这还不得遭殃    \n     2013-08-11 16:09 |    \t\tLee Swagger \t\t\t( 路人 |\t\t\t        Rank:28 漏洞数:5        | 洗洗睡吧)\t\t \n  安全狗 菊花？ 哪位大神 来个Oday 一堆服务器啊 - -。    \n     2013-08-15 19:12 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  @xsser 被忽略了...都不说送2rank也让俺晋级呀 ，这心里 哇凉哇凉的     \n     2013-08-15 19:37 |    \t\tQQ852451559 \t\t\t( 实习白帽子  |\t\t\t        Rank:79 漏洞数:18        | 学生党)\t\t \n  ...这个绕过方法和我一样..你发出来了。。我。。    \n     2013-08-15 19:40 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  @QQ852451559 没事的 厂商都没有看到 不会补的 接着用    \n     2013-08-15 21:26 |    \t\tQQ852451559 \t\t\t( 实习白帽子  |\t\t\t        Rank:79 漏洞数:18        | 学生党)\t\t \n  @在路上 嗯。我鄙视偷偷修复的厂商~    \n     2013-08-16 09:37 |    \t\t大大大哥 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:1        | hello world)\t\t \n  这个可以有    \n     2013-08-16 09:41 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  无影响厂商忽略    \n     2013-08-16 10:15 |    \t\tMr.x \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:7        | 啊啊啊啊啊。。。)\t\t \n  @在路上 不科谱下\"f rom\"为何可以绕过吗？    \n     2013-08-16 18:35 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  @Mr.x 我也是看别人写的 想到的 WooYun: 智创网站专业级防火墙可被绕过   这里面写的比较详细了    \n     2013-08-16 21:37 |    \t\tMr.x \t\t\t( 路人 |\t\t\t        Rank:26 漏洞数:7        | 啊啊啊啊啊。。。)\t\t \n  @在路上 放出来，就有办法补，安全狗的人还是很灵活的，各种奇人淫技。这里纠正一下楼主，安全狗是工作在应用层，非网络层，，，    \n     2013-08-16 23:31 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  @Mr.x 补不补不关心 我就知道 没有得rank 还不如什么宝，以后也不会弄它了 没有意思    \n     2013-08-28 16:39 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @在路上 20分送上    \n     2013-08-28 23:03 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  @xsser 额 谢谢呀 终于晋级了     \n     2015-02-25 11:54 |    \t\txiaobai \t\t\t( 实习白帽子  |\t\t\t        Rank:40 漏洞数:1        | 别看资料看聊效)\t\t \n  @在路上 求教大侠，用的是什么软件啊    \n     2015-04-05 08:29 |    \t\t在路上 \t\t\t( 普通白帽子  |\t\t\t        Rank:193 漏洞数:13        | 在学习的路上、在成长的路上...)\t\t \n  @xiaobai hackbar  和 burp ?    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}