{"id": 17527, "wybug_id": "wooyun-2012-010561", "wybug_title": "再爆苏宁某站点重大漏洞", "wybug_corp": "江苏苏宁易购电子商务有限公司", "wybug_author": "风萧萧", "wybug_date": "2012-08-04 12:44", "wybug_open_date": "2012-09-18 12:44", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-08-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-08-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-08-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-08-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-09-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-09-18：\t细节向公众公开  简要描述： 好吧，我承认我和苏宁的同事有基情 详细说明：  1.存在漏洞的是主站哦\nhttp://www.suning.com/emall/city_10052_10051_9264_.html\n\n\n2.支付漏洞，模拟下如何使用1元钱买ipad的吧，下面这张图选择一键购\n\n   漏洞证明：  3.填写好想要信息之后，进入到付款页面，注意看金额，这里是原价2866.00元\n\n4.下面是重点了，提交订单，在跳转到银行支付的页面时，抓包，将金额改成￥1.00\n\n5.具体的参数信息如下，Amount肯定就是金额了 \nBranchID=0025&CoNo=004624&BillNo=0023258647&Amount=2866.00&Date=20120804&MerchantUrl=https%3A%2F%2Fcallback.suning.com%2FNetPayment%2Fcallback%2FpageCallBack.action&MerchantPara=23258647\n6.转到银行支付页面时，需要支付的金额只需要1元了：\n\n7.后面没有进一步测试了。   修复方案：  厂商懂的，不过建议彻查下吧！   版权声明：转载请注明来源 风萧萧@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2012-08-04 17:13 厂商回复： 非常感谢风萧萧同学对苏宁易购安全的关注，我们尽快修复！ 最新状态： 2012-09-20：苏宁易购总部金额产品中心回复：虽然该金额被篡改，但是在招行支付成功回调易付宝后，易付宝会用原金额和银行支付金额判断，如果不一致，该交易会拒绝，不会出现1元买ipad这种情况。后续，我司已于招行联系，完成了接口升级，如果金额被篡改，签名校验不通过，招行拒绝交易，无法进行支付。  ", "replys": "漏洞评价：\n评论\n     2012-08-04 14:14 |    \t\t蟋蟀哥哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:57        | 巴蜀人士,80后宅男,自学成才,天朝教育失败...)\t\t \n  早就知道有基情了    \n     2012-08-04 14:18 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @蟋蟀哥哥 好似哥哥与快乐购一般    \n     2012-08-04 14:45 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @蟋蟀哥哥 @风萧萧 两位都基情无限，哈哈~    \n     2012-08-04 14:52 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @se55i0n 哈哈！招聘的事情帮我宣传下，thx！    \n     2012-08-04 14:53 |    \t\tse55i0n \t\t\t( 普通白帽子  |\t\t\t        Rank:1567 漏洞数:173        )\t\t \n  @风萧萧 要得哈~~    \n     2012-08-04 15:04 |    \t\tkoohik \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:63        | 没什么介绍的http://www.koohik.com/)\t\t \n  哈哈哈，这年代，基情就跟耍朋友似的    \n     2012-08-07 16:58 |    \t\tneal \t\t\t( 普通白帽子  |\t\t\t        Rank:219 漏洞数:23        )\t\t \n  @风萧萧    发现 兄台 基友不少啊..    \n     2012-08-30 08:56 |    \t\tby_奇奇 \t\t\t( 实习白帽子  |\t\t\t        Rank:35 漏洞数:7        | 2)\t\t \n  应该支付就算成功，，也会会出现支付异常吧，，    \n     2012-08-30 09:15 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  @by_奇奇 嗯是的如果有对帐的话    \n     2012-09-03 23:48 |    \t\tStuckCpu \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:4        | ...... /  /    /    /)\t\t \n  曾经对某站的时候...成功过了付款！在等待他们消息的第三天发现核对账号的时候露馅了~    \n     2012-09-20 15:27 |    \t\twokao \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | 郁闷)\t\t \n  好基友    \n     2012-09-20 15:29 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  如果有对账的话，这种攻击好像没什么意义哦。求楼主指点。    \n     2012-09-20 17:00 |    \t\t风萧萧  \t\t\t( 核心白帽子 |\t\t\t        Rank:1020 漏洞数:76        | 人这一辈子总要动真格的爱上什么人)\t\t \n  嗯，如你所述    \n     2012-09-21 14:26 |    \t\thorseluke \t\t\t( 普通白帽子  |\t\t\t        Rank:116 漏洞数:18        | Realize the dream in earnest.)\t\t \n  缺陷关联： WooYun: 当当网严重的支付问题 （原因：支付接口签名；招行接口安全性讨论）     \n     2014-04-20 22:15 |    \t\t小贱人 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | 资深菜鸟，)\t\t \n  mark    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}