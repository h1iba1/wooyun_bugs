{"id": 56315, "wybug_id": "wooyun-2014-058230", "wybug_title": "美丽说任意商品0元购", "wybug_corp": "美丽说", "wybug_author": "nextdoor", "wybug_date": "2014-04-24 12:23", "wybug_open_date": "2014-06-08 12:24", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "设计不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-05-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-05-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-05-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-08：\t细节向公众公开  简要描述： 美丽说任意商品0元购 详细说明：  美丽说任意商品0元购逻辑漏洞导致任意商品的数量可以为负数，且可以修改用户提交订单的价格，导致我们提交的订单可以任意修改过程如下：客户端修改订单的数量\n\n用burp suite修改客户端的数量，也可在提交订单时修改价格\n\n在提交时虽然提交失败，其实订单已经生成了提交成功的订单\n\n即使服务器会对提交的负数进行判断，但是我们可以买一件贵的商品和一个便宜的商品(便宜的商品设为负值）从而生成的订单价格为正数，也可以修改price的值为一个小的正数，从而完成我们的付款。既可以购买任意商品。   漏洞证明：  提交成功的订单\n\n   修复方案：  提交的数量不能为0，为负，在服务端对提交的变量进行绝对值函数即可对于提交的每个商品的price不要从客户端获得值   版权声明：转载请注明来源 nextdoor@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-04-25 15:29 厂商回复： 感谢提交。我们已经修复了。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-04-24 13:22 |    \t\tnextdoor \t\t\t( 普通白帽子  |\t\t\t        Rank:325 漏洞数:74        )\t\t \n  @xsser 大半夜挖个漏洞容易吗，美丽说的还不走大厂商    \n     2014-04-24 13:30 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  @nextdoor 看漏洞不看厂商    \n     2014-04-24 13:41 |    \t\tnextdoor \t\t\t( 普通白帽子  |\t\t\t        Rank:325 漏洞数:74        )\t\t \n  @xsser 毕竟牵扯到厂商的利益，漏洞的危害性很高，而且可以直接利用的。    \n     2014-04-24 15:12 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  @nextdoor 这些都是前端的 后端订单会有一次审核的 也就是说这个可能是“半个”漏洞    \n     2014-04-24 16:56 |    \t\tnextdoor \t\t\t( 普通白帽子  |\t\t\t        Rank:325 漏洞数:74        )\t\t \n  @xsser 好吧    \n     2014-04-24 17:05 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:17        | 当我又回首一切,这个世界会好吗?)\t\t \n  @nextdoor :)    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}