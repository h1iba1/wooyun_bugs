{"id": 710, "wybug_id": "wooyun-2014-074384", "wybug_title": "慈铭体检集团云健康管理平台远程命令执行漏洞", "wybug_corp": "慈铭体检集团", "wybug_author": "猪猪侠", "wybug_date": "2014-08-29 20:32", "wybug_open_date": "2014-10-13 20:34", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方框架"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-29：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2014-10-13：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 慈铭体检集团云健康管理平台 远程命令执行漏洞现在连体检公司居然都用上云了。。。 详细说明：  # 漏洞网站http://health.ciming.com/loginMessage.action\n\n   漏洞证明：  \n\n\n>whoamigpmsuser>ifconfig -aeth0      Link encap:Ethernet  HWaddr 00:50:56:83:57:6D            inet addr:10.10.12.41  Bcast:10.10.12.255  Mask:255.255.255.0          inet6 addr: fe80::250:56ff:fe83:576d/64 Scope:Link          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1          RX packets:32863746 errors:0 dropped:0 overruns:0 frame:0          TX packets:96947840 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:1000           RX bytes:7805494566 (7.2 GiB)  TX bytes:59550582633 (55.4 GiB)lo        Link encap:Local Loopback            inet addr:127.0.0.1  Mask:255.0.0.0          inet6 addr: ::1/128 Scope:Host          UP LOOPBACK RUNNING  MTU:16436  Metric:1          RX packets:502 errors:0 dropped:0 overruns:0 frame:0          TX packets:502 errors:0 dropped:0 overruns:0 carrier:0          collisions:0 txqueuelen:0           RX bytes:29960 (29.2 KiB)  TX bytes:29960 (29.2 KiB)>cat /etc/hosts127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4::1         localhost localhost.localdomain localhost6 localhost6.localdomain610.10.12.41\tGaiRuiApp0158.247.75.246     api.ykservice.com10.2.201.41 www.wincome.org10.2.201.41 pns.gareahealth.com>last -10root     pts/1        10.1.6.50        Wed Aug 27 10:10 - 10:41  (00:30)    root     pts/1        10.1.6.50        Wed Aug 27 09:25 - 09:54  (00:29)    root     pts/1        10.1.6.50        Mon Aug 25 16:45 - 19:03  (02:18)    root     pts/1        10.1.6.50        Mon Aug 25 10:57 - 11:00  (00:02)    root     pts/1        10.1.6.50        Mon Aug 25 08:16 - 08:22  (00:06)    root     pts/1        10.1.6.50        Fri Aug 15 17:00 - 17:07  (00:07)    root     pts/1        10.1.6.50        Fri Aug 15 15:53 - 16:45  (00:51)    root     pts/1        10.1.6.50        Fri Aug 15 15:24 - 15:28  (00:03)    root     pts/1        10.1.6.50        Fri Aug 15 08:25 - 08:26  (00:01)    root     pts/0        10.10.10.22      Tue Aug 12 09:08   still logged in   wtmp begins Thu Jun 26 21:04:55 2014>ps -efUID        PID  PPID  C STIME TTY          TIME CMDroot         1     0  0 Jul30 ?        00:00:02 /sbin/initroot         2     0  0 Jul30 ?        00:00:00 [kthreadd]root         3     2  0 Jul30 ?        00:00:00 [migration/0]root         4     2  0 Jul30 ?        00:00:35 [ksoftirqd/0]root         5     2  0 Jul30 ?        00:00:00 [migration/0]root         6     2  0 Jul30 ?        00:00:04 [watchdog/0]root         7     2  0 Jul30 ?        00:00:00 [migration/1]root         8     2  0 Jul30 ?        00:00:00 [migration/1]root         9     2  0 Jul30 ?        00:00:28 [ksoftirqd/1]root        10     2  0 Jul30 ?        00:00:03 [watchdog/1]root        11     2  0 Jul30 ?        00:01:47 [events/0]root        12     2  0 Jul30 ?        00:02:36 [events/1]root        13     2  0 Jul30 ?        00:00:00 [cgroup]root        14     2  0 Jul30 ?        00:00:00 [khelper]root        15     2  0 Jul30 ?        00:00:00 [netns]root        16     2  0 Jul30 ?        00:00:00 [async/mgr]root        17     2  0 Jul30 ?        00:00:00 [pm]root        18     2  0 Jul30 ?        00:00:11 [sync_supers]root        19     2  0 Jul30 ?        00:00:13 [bdi-default]root        20     2  0 Jul30 ?        00:00:00 [kintegrityd/0]root        21     2  0 Jul30 ?        00:00:00 [kintegrityd/1]root        22     2  0 Jul30 ?        00:00:15 [kblockd/0]root        23     2  0 Jul30 ?        00:00:13 [kblockd/1]root        24     2  0 Jul30 ?        00:00:00 [kacpid]root        25     2  0 Jul30 ?        00:00:00 [kacpi_notify]root        26     2  0 Jul30 ?        00:00:00 [kacpi_hotplug]root        27     2  0 Jul30 ?        00:16:26 [ata/0]root        28     2  0 Jul30 ?        00:04:40 [ata/1]root        29     2  0 Jul30 ?        00:00:00 [ata_aux]root        30     2  0 Jul30 ?        00:00:00 [ksuspend_usbd]root        31     2  0 Jul30 ?        00:00:00 [khubd]root        32     2  0 Jul30 ?        00:00:00 [kseriod]root        33     2  0 Jul30 ?        00:00:00 [md/0]root        34     2  0 Jul30 ?        00:00:00 [md/1]root        35     2  0 Jul30 ?        00:00:00 [md_misc/0]root        36     2  0 Jul30 ?        00:00:00 [md_misc/1]root        37     2  0 Jul30 ?        00:00:02 [khungtaskd]root        38     2  0 Jul30 ?        00:00:21 [kswapd0]root        39     2  0 Jul30 ?        00:00:00 [ksmd]root        40     2  0 Jul30 ?        00:00:36 [khugepaged]root        41     2  0 Jul30 ?        00:00:00 [aio/0]root        42     2  0 Jul30 ?        00:00:00 [aio/1]root        43     2  0 Jul30 ?        00:00:00 [crypto/0]root        44     2  0 Jul30 ?        00:00:00 [crypto/1]root        49     2  0 Jul30 ?        00:00:00 [kthrotld/0]root        50     2  0 Jul30 ?        00:00:00 [kthrotld/1]root        51     2  0 Jul30 ?        00:00:00 [pciehpd]root        53     2  0 Jul30 ?        00:00:00 [kpsmoused]root        54     2  0 Jul30 ?        00:00:00 [usbhid_resumer]root        83     2  0 Jul30 ?        00:00:00 [kstriped]root       246     2  0 Jul30 ?        00:00:00 [scsi_eh_0]root       247     2  0 Jul30 ?        00:15:05 [scsi_eh_1]root       320     2  0 Jul30 ?        00:00:00 [scsi_eh_2]root       321     2  0 Jul30 ?        00:00:00 [vmw_pvscsi_wq_2]root       365     2  0 Jul30 ?        00:01:17 [jbd2/sda1-8]root       366     2  0 Jul30 ?        00:00:00 [ext4-dio-unwrit]root       367     2  0 Jul30 ?        00:00:00 [ext4-dio-unwrit]root       447     1  0 Jul30 ?        00:00:00 /sbin/udevd -droot       450     2  0 Jul30 ?        00:00:59 [flush-8:0]root       604     2  0 Jul30 ?        00:00:40 [vmmemctl]root       959     2  0 Jul30 ?        00:00:00 [kauditd]root      1172     1  0 Jul30 ?        00:37:45 /usr/sbin/vmtoolsdroot      1343     1  0 Jul30 ?        00:00:03 auditdroot      1368     1  0 Jul30 ?        00:00:01 /sbin/rsyslogd -i /var/run/syslogd.pid -c 5rpc       1386     1  0 Jul30 ?        00:00:04 rpcbinddbus      1401     1  0 Jul30 ?        00:00:00 dbus-daemon --systemavahi     1413     1  0 Jul30 ?        00:00:02\n   修复方案：  # 及时补丁It is strongly recommended to upgrade to Struts 2.3.15.1, which contains the corrected Struts2-Core library.http://struts.apache.org/release/2.3.x/docs/s2-016.htmlhttp://struts.apache.org/release/2.3.x/docs/s2-017.html   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝 漏洞Rank：15 (WooYun评价)  ", "replys": "漏洞评价：\n评论\n     2014-08-29 20:35 |    \t\twinsyk \t\t\t( 普通白帽子  |\t\t\t        Rank:108 漏洞数:16        | 越长大越孤单)\t\t \n  小哥，你不用休息的吗。。    \n     2014-08-29 20:38 |    \t\t光头强 \t\t\t( 路人 |\t\t\t        Rank:30 漏洞数:3        | 惹我光头强，揍你没商量！)\t\t \n  First blood     \n     2014-08-29 20:38 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @光头强 惹我光头强，揍你没商量！    \n     2014-08-29 20:41 |    \t\t动后河 \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:13        | ☭)\t\t \n  今年流行 医疗类    \n     2014-08-29 20:43 |    \t\tCoffee \t\t\t( 普通白帽子  |\t\t\t        Rank:144 漏洞数:15        | Corie, a student of RDFZ.)\t\t \n  猪哥迷上体检了……    \n     2014-08-29 20:51 |    \t\tHackPanda \t\t\t( 普通白帽子  |\t\t\t        Rank:113 漏洞数:15        | Talk is cheap,show me the shell.)\t\t \n  镜头往下拉阿    \n     2014-08-29 21:06 |    \t\t炊烟 \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:44        | 每一天都需要努力。)\t\t \n  我要上前排！！    \n     2014-08-29 21:12 |    \t\t猪猪侠  \t\t\t( 核心白帽子 |\t\t\t        Rank:3224 漏洞数:254        | 你都有那么多超级棒棒糖了，还要自由干吗？)\t\t \n  @winsyk 现在是下班时间啊。    \n     2014-08-29 21:39 |    \t\twkc_2014 \t\t\t( 普通白帽子  |\t\t\t        Rank:164 漏洞数:45        | 2014-)\t\t \n  最近公司要组织体检……也不知道会选哪家！！    \n     2014-08-29 21:41 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  卧槽。慈铭...    \n     2014-08-29 22:01 |    \t\t花花酱 \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:6        | 花花酱)\t\t \n  @猪猪侠 大神总是引领潮流    \n     2014-08-29 22:08 |    \t\t铁汉 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:6        | 向各种大神学习之)\t\t \n  大神无论做什么都是潮流，哪怕是杜蕾斯    \n     2014-08-31 00:08 |    \t\t卡卡 \t\t\t( 普通白帽子  |\t\t\t        Rank:447 漏洞数:52        | <script>alert('安全团队长期招人')</scrip...)\t\t \n  我就看看，不说话    \n     2014-09-01 23:59 |    \t\tDebug0man \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | 叽叽呗呗...)\t\t \n  我是来膜拜猪侠的.    \n     2014-09-02 10:16 |    \t\t尼玛椰子树 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 简单，守护心中那份沉静。疯狂，爆破黎明的...)\t\t \n  求师傅求妹子求神器！！！~~~    \n     2014-09-06 20:08 |    \t\t沦沦 \t\t\t( 普通白帽子  |\t\t\t        Rank:504 漏洞数:127        | 爱老婆，爱生活)\t\t \n  猪猪侠就是牛X，刷高质量漏洞跟本停不下来    \n     2014-09-12 22:19 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  今天见到到猪猪侠的真面目，好帅气！@猪猪侠    \n  \n\n\n", "wybug_level_fromcorp": "未能联系到厂商或者厂商积极拒绝", "wybug_rank_fromcorp": 15, "Ranks": null}