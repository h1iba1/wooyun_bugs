{"id": 86782, "wybug_id": "wooyun-2016-0182337", "wybug_title": "票付通某处存在设计缺陷涉及大量企业（可套钱）", "wybug_corp": "12301.cc", "wybug_author": "路人甲", "wybug_date": "2016-03-29 18:42", "wybug_open_date": "2016-05-16 16:10", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-03-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-11：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-21：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-01：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-16：\t细节向公众公开  简要描述： RT 详细说明：  网址：http://www.12301.cc/一、登陆处可撞库。这里是没有限制的，我看到提示用户名为商户ID或者手机号，随手用13333333333和密码123456进行尝试，竟然登陆进去了！二、“合作供应商”处存在越权。第一步账号登陆后，查看“合作供应商”，点击“企业名称”后，遍历ID可越权查看8万7千多用户的账号、账号名和手机号等。三、获取大量登陆用户。结合第一、二步漏洞，用简单的123456弱口令获得4437个可登陆用户！登陆后输入：http://www.12301.cc/buyProduct.html，可看到已买到的产品。这里以百度糯米网账号为例，可看到已支付但未使用的订单，可根据订单号、取票人手机以及凭证号从而使用别人的订单（简直是免费蹭吃蹭喝蹭玩啊。。。）四、可隐秘套钱。以账号100009为例，其账号存在185.2元，这个钱可以进行提现和转账，提现主要需要添加银行卡。转账这有个有趣的地方，这需要输入绑定手机的验证码，而我发现修改绑定手机码根本无验证，这就很容易进行转账，但是转完账后，为了避免被用户知道是谁转了账，就需要修改回原来绑定的手机，但这时如何知道重新绑定原来手机时，那个手机收到的验证码呢，刚开始想爆破，发现是6位的就停止挣扎了。这时抓包发现修改绑定手机的逻辑是：先对需要绑定的手机进行验证看是否已被其他用户绑定了，若绑定了就提示已被绑定，若没有就向这个手机发送验证码，但是这里是分两步走，可以通过修改第二步中发送验证码的链接参数mobile为自己手机，从而收到验证码，改回绑定手机为原用户的手机号，无声无息地进行了转账。这里我用账号100009和124138互转0.1元进行了证明。部分账号（密码123456）：\n123545100009124138123719523370123624521044123886515963123914520788523601504979125289522458523412123914123651124623123918123917123900pftxh51992051877210001412425412392113898886675138050850455138291898717117015280047800186500741630001dy504222xp2015jtywqsz13057389911511436mengshan8625431770709778013202772126XXY666666tiamu001513498cgp12301tbc12301wys12301blr12301lhg12301hxl1230151399213397571234186153599511531866580313664783797yg001600836qxtfqxhqTicketingfangxiaoqinglushuaichengST7169111LT2300111longlongxianggang861496tssxy011597220839715800956133pandashuaiminjiangzhiyuanchenxiufanghaoyuangongcqsmfyang123wanghuayingcewli12312422813770626440lgn00118748171696513709shengxiaosongyunhuaycunhaixiaohonga123456aalvtingtinglaiyangwenlichengbin504520jkq12345686260515880013096123456tdcszh99009zgw147258jff200000A0001wuhongxia51208551375718808920066qiong871103yujunsws2014xiaolingsjhlypft12301517063cldy51268751269851277151396951397051397151397251402713452739120514342A18970053878lhld123456tkefuzhangshengyjx01test0755SZYD001WLYD001XSYZ317ZZCJ002ZZCJ003861211y861211z861211xchenjianshun862875513962yuangong2yg003ztr123456mmcsa13459752442100mimmimtest00000ND001h2962562756zhonglitingcldygjinchengcdhlgyg002kf001\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  。。。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：18  确认时间：2016-04-01 16:05 厂商回复： 前期开发考虑不周，感谢。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 18, "Ranks": null}