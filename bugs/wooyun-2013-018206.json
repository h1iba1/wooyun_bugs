{"id": 65118, "wybug_id": "wooyun-2013-018206", "wybug_title": "梦洁家纺隐蔽SQL注射可导致渗透", "wybug_corp": "mendale.com", "wybug_author": "小胖子", "wybug_date": "2013-02-01 10:57", "wybug_open_date": "2013-02-06 10:57", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["数据库账户权限过高", "搜索类型注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-02-01：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-02-06：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 礼物不到手誓不罢休！ 详细说明：  存在问题站点：http://www.minehome.cn 很多帽子初看一眼全是flash就走了，我找找，找到一处SQL，然后丢给我亲爱的SQLMAP，它居然告诉我说DBA！SQL注射：http://www.minehome.cn/News.aspx?SearchInfo=1 搜索型注入 \n\n穿山甲能认出来，但是得不到数据，只有map跑。数据库和IIS和net的版本。\n\n居然是DBA权限，果断OS-SHELL\n\n\n\n本以为到此结束，谁知，竟然不能ftp get一个shell回来copy到web目录，那没3389，加用户也枉然，webshell提吧。老老实实跑数据表\n\n\nDatabase: Mine2011[45 tables]+-------------------------------------------+| dbo.AdMenu                                || dbo.AdplyUsers                            || dbo.City                                  || dbo.DatiStetistics                        || dbo.IPAddress                             || dbo.IPAlacklitt                           || dbo.IPVisit                               || dbo.ManageUser                            || dbo.Media                                 || dbo.Member                                || dbo.Member2011                            || dbo.MemberVoice                           || dbo.Menu                                  || dbo.MonitoringSys                         || dbo.NewType                               || dbo.News                                  || dbo.OWStoreCity                           || dbo.OWStoreProvince                       || dbo.OpStore                               || dbo.OperationLog                          || dbo.OperationType                         || dbo.PrkzesSetring                         || dbo.ProdcutLargeUype                      || dbo.ProdcutLmallType                      || dbo.Product                               || dbo.Products                              || dbo.Provincg                              || dbo.Roles                                 || dbo.Scratch                               || dbo.SeoMenu                               || dbo.Statea                                || dbo.StatisvicsTypg                        || dbo.StoreCityA                            || dbo.StoreMsg                              || dbo.StoreProvince                         || dbo.SuoMember                             || dbo.UserLogynLog                          || dbo.[KeyWords#]                           || dbo.[MediaSpacq]                          || dbo.[Member2011Wmnners]                   || dbo.[MemberLottery]                       || dbo.[MonitorEata]                         || dbo.[SeoSystem]                           || dbo.dtpropeyties                          || dbo.sqlmqpoutput                          |+-------------------------------------------+\n得到管理的登录名和密码\n\n\n\n这里密码位数回显不正常，但是常识判断，密码是1，是32位MD5的最后那段。帐号密码都是1，你们是要有多大意啊！！！！！拿到后台，看了下正确的md5值。\n\n拿shell就不说了，也不提权了，权限大得很。\n\n   漏洞证明：  \n\nhttp://www.minehome.cn/upload/news/images/2013252916.aspx 一句话木马地址，请删除http://www.minehome.cn/wooyun.txt  请删除   修复方案：  1.用户名密码要不要那么弱啊，后台地址改啊，让黑扩猜不到啊！2.SQL缺陷修复，再全面自查，其他分站也自查。3.说好的礼物呢？求给力，求20rank。   版权声明：转载请注明来源 小胖子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-02-06 10:57 厂商回复：  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-02-01 10:59 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  @小胖子 我发了好几个了，还没满足“多”的概念...    \n     2013-02-01 11:00 |    \t\tleaf \t\t\t( 普通白帽子  |\t\t\t        Rank:948 漏洞数:121        | 真的没影响么？)\t\t \n  @小胖子 @xsser 我刚也发了个他们的注入店，怎么就要等审核呢？    \n     2013-02-01 11:01 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @xsser 感谢帮忙修改标题～    \n     2013-02-01 11:02 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  @leaf 我们俩的站点可能不一样～    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}