{"id": 18499, "wybug_id": "wooyun-2012-08728", "wybug_title": "腾讯安全认证可以成为手机短信攻击工具", "wybug_corp": "腾讯", "wybug_author": "winston", "wybug_date": "2012-06-24 21:17", "wybug_open_date": "2012-08-08 21:18", "wybug_type": "设计错误", "wybug_level": "中", "wybug_rank_0": "8", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["手机短信", "恶意信息传播", "短信攻击"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-06-24：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-06-25：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-07-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-07-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-07-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-08-08：\t细节向公众公开  简要描述： 腾讯的QQDNA安全认证，在手机认证的过程中，没有对手机的号码接收的次数进行验证，进而造成了反复的利用，成为了手机短信攻击工具。同时由于其发送的短信号码相同，所以还有可能被一些过滤软件认为是恶意号码提交给数据库进行过滤 详细说明：  腾讯的QQDNA中有一个密保绑定手机的功能，其使用的是AJAX验证登陆的QQ是多少。在提交的时候可以接受外部链接的提交http://aq.qq.com/cn2/manage/mobile/active_sms_ajax?mobile_number=xxxxxxxxxxx&flow_type=dna其中mobile_number是手机号，其它的不用更改。然后你登陆任何一个QQ号，就可以连续的对这一个号码发送4条短信。发送完成以后你更换QQ号码后依然可以再次对这个号码进行提交短信发送。在整个过程中，腾讯只是考虑了对QQ号码一天内的发送次数，但是没有考虑到一个手机可以提交的次数。而且数据的链接是可以外部提交的。这样可以使提交的过程工具化。进而成为了利用的工具。   漏洞证明：  \n\n返回成功的数值\n\n返回后已经代表这个QQ号码今天已经无法再发送了\n\n一个QQ号码成功接收到4条短信。而且短信号码是同一个   修复方案：  你们都是专业的，我是业余的。你比我要明白如何修补。   版权声明：转载请注明来源 winston@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2012-06-25 10:49 厂商回复： thanks，我们正在跟进处理中 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-06-24 21:49 |    \t\t斯文的鸡蛋 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:41        | 我在这头，你在那头~)\t\t \n  30秒发送那个？    \n     2012-06-25 13:45 |    \t\t顺子 \t\t\t( 普通白帽子  |\t\t\t        Rank:236 漏洞数:36        | 0-0努力像正常青年靠近，再也不当上错图的2...)\t\t \n  @斯文的鸡蛋 如果抓包直接post的话，会不会可以无限    \n     2012-06-25 21:46 |    \t\twinston \t\t\t( 实习白帽子  |\t\t\t        Rank:46 漏洞数:7        | nothing)\t\t \n  当时没有觉得这个很重要，只是想到了相同的手机号码如果被恶意的发送，那么这个号码可能会被认为是垃圾短信发送号码，这样可以被一些软件给屏蔽了，这就麻烦了！    \n     2012-06-25 22:09 |    \t\t斯文的鸡蛋 \t\t\t( 普通白帽子  |\t\t\t        Rank:173 漏洞数:41        | 我在这头，你在那头~)\t\t \n  @顺子 求实验啊！！！    \n     2012-06-26 00:34 |    \t\t顺子 \t\t\t( 普通白帽子  |\t\t\t        Rank:236 漏洞数:36        | 0-0努力像正常青年靠近，再也不当上错图的2...)\t\t \n  @斯文的鸡蛋 同求啊！    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}