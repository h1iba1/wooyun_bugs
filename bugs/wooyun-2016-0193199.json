{"id": 86988, "wybug_id": "wooyun-2016-0193199", "wybug_title": "东航旗下上海航空国际旅游某分站SQL注入导致主站疑似全网用户账号密码泄露（含个人信息）", "wybug_corp": "中国东方航空股份有限公司", "wybug_author": "低调的瘦子", "wybug_date": "2016-04-06 18:29", "wybug_open_date": "2016-05-22 10:00", "wybug_type": "用户资料大量泄漏", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-04-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-04-07：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-04-17：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-04-27：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-05-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-05-22：\t细节向公众公开  简要描述： RT。。小漏洞大问题。好多敏感信息，这次给个20rank呗 详细说明：  注入地址：http://en.satrip.com/AboutUs/Contact.asp?Flag=3  注入参数Flag这个英文站注入点太多了，厂商没用就更新下或者换掉吧。此处随便拿这个注入地址进行注入，共34个数据库。这里选择\nsh962008\n该数据库进行操作列表名\nWEB_FREETRAVEL_BOOK_REMARKCEAIR_CTRAVEL_ROUTEWEB_QUNARHDS_HOTELIMAGE_OLDWEB_QUNARHDS_HOTELBRAND_OLDCMS_ORDER_VISA_MATERIALWEB_GUEST_ALL*CMS_OPERATOR_ROLEWEB_FREETRAVEL_BOOK_ACCOUNTXIANGHONG_DEPARTMENTWEB_INSURANCE_ALLIANZ_BOOK_PERSONXIANGHONG_USERWEB_FREETRAVEL_BOOK_PAYMENTWEB_INSURANCE_CHARTIS_BOOK_PERSONWEB_INVOICEXIANGHONG_MANAGERXIANGHONG_PAYMENTWEB_NEWS_FLAGWEB_FLIGHT_BOOK_FLIGHTS_GUESTCITYCODE_CHS*WEB_ETRAVEL_BOOK_ITEMCMS_ORDER_PAYMENTWEB_TOPIC_FLAGWEB_SITE_MANAGER_EXPRESSCMS_ORDER_HOTEL_ROOMSWEB_ETRAVEL_BOOK_PRICEWEB_FLIGHT_BOOK_REMARKWEB_VOUCHERCITYCODE_INT*WEB_SITE_MANAGER_EXPRESS_REMARKWEB_FREETRAVEL_BOOK_PRICEWEB_SITE_MANAGER_PACTWEB_AIR_AIRWAYSWEB_ETRAVEL_BOOK_PAYMENTWEB_FLIGHT_BOOK_FLIGHTSWEB_BBS_TOPICCMS_ORDER_CLAUSEWEB_MAIL_LOGXIANGHONG_PAYMETHODWEB_FLIGHT_RULESCMS_OPERATOR_DEPARTMENTWEB_CTRAVEL_BOOKWEB_CHINAPAY_STATUSELONG_EHOTEL_LOCALTIONAspNet_SqlCacheTablesForChangeNotificationWEB_MEMBER_VOUCHER*WEB_SITE_MANAGER_KPI_RECEPTIONWEB_FLIGHT_MANAGERELONG_HOTEL_BRANDWEB_FREETRAVEL_ITEM*CMS_ORDER_HOTELELONG_HOTEL_BUSINESSZONEWEB_FREETRAVEL_BOOK_ROUTEELONG_HOTEL_CODEELONG_HOTEL_ERROR_LOGWEB_FREETRAVEL_SPECIAL*WEB_HOTEL_CATCHELONG_HOTEL_FEATUREWEB_VOUCHER_REMARKWEB_FLIGHT_CUSTOMERELONG_HOTEL_LANDMARKSHH_SalesDepartWEB_SCENERYWEB_CTRAVEL_BOOK_PAYMENTELONG_HOTEL_ORDERWEB_SITE_LOGIN_LOGSHH_TripInfoWEB_GUEST_ALL_1*WEB_FLIGHT_BOOK_PRICEELONG_HOTEL_ORDER_ACCOUNTWEB_COMPLAIN_REMARKWEB_INTENTION_BOOKELONG_HOTEL_ORDER_COSTCMS_PRODUCT_VISAWEB_HOTEL_BRANDWEB_CANCEL_CAUSEELONG_HOTEL_ORDER_GUESTWEB_INTENTION_BOOK_REMARKELONG_HOTEL_ORDER_HOTELINFOWEB_ITEM_DESTINATIONELONG_HOTEL_ORDER_INVOICEWEB_FREETRAVEL_PORNAME*WEB_FEEDBACKCMS_EXPRESS_THINGSELONG_HOTEL_ORDER_ITEMCEAIR_ROUTE_TOPICWEB_HOTEL_LANDMARKELONG_HOTEL_ORDER_PAYMENTWEB_SITE_MANAGER_ORDERELONG_HOTEL_ORDER_PRICEELONG_HOTEL_ORDER_REMARKWEB_CITYCODECMS_PRODUCT_VISA_MATERIALELONG_HOTEL_PROVIDERWEB_HOTEL_ROOMCMS_PAY_LOGWEB_ERR_LOGELONG_HOTEL_ROOMWEB_CTRAVEL_BOOK_PRICEELONG_HOTEL_ROOM_RATEPLANWEB_AIR_BOOKWEB_OPID_SENDSMS_LOGELONG_HOTEL_ROOM_RATEPLAN_RATEWEB_MEMBER_BUSWEB_SITE_MANAGER_USERTYPECMS_OPERATOR_ROLE_CONTROLWEB_HOTEL*WEB_FREETRAVEL_ROUTE*sysdiagramsWEB_HOTEL_CREDITCARDSWEB_HOTEL_BOOK_COSTpangolin_test_tableCMS_PRODUCT_OPERATOR_LOGWEB_DEPTWEB_TEMPWEB_AIR_BOOK_FLIGHTWEB_BBS_IMGWEB_EN_CITY_INFOCMS_OPERATORWEB_FLIGHT_BOOK_ACCOUNTWEB_SITE_INFOWEB_SITE_MANAGER_GROUPWEB_FREETRAVEL_NOTICE*MLS_QUESWEB_SITE_MANAGER_KPI_EVENTWEB_HOTEL_CONTACT*CEAIR_ETRAVELWEB_PUBLIC_CODEWEB_FREETRAVEL_FLIGHT_AGREEWEB_HOTEL_BOOKWEB_FREETRAVEL_BOOKWEB_INSURANCE_CHARTIS_ERRORCODEWEB_AIR_BOOK_REMARKWEB_CACHE_ETRAVELCMS_ORDER_OPERATOR_LOGWEB_HOTEL_CACHE_TEMP*WEB_QUNARHDS_CITYLISTWEB_SITE_MANAGER_CLAIMREFUNDWEB_HOTEL_CACHE*WEB_QUNARHDS_HOTELBRANDWEB_FLIGHT_BOOK_PAYMENTdtpropertiesWEB_INSURANCE_CXWEB_ROUTE_PROMOTIONWEB_EN_TOURWEB_ACT_BOOK*syscommandWEB_AIR_BOOK_ACCOUNTWEB_CTRAVEL_BOOK_ACCOUNTWEB_COMPLAIN_RESPONSIBLE*WEB_DATUM_AREAWEB_THINGS_REFUNDWEB_FREETRAVEL_PROVIDERWEB_INSURANCE_CX_BOOKWEB_BBS_BOARDWEB_ROUTEWEB_ETRAVEL_BOOK_ACCOUNTWEB_POINTWEB_LOTTERYWEB_ETRAVELCMS_ORDER_PRICEWEB_TEAM_BOOKWEB_FLIGHT_REMARKWEB_ADMIN_NEWSELONG_HOTEL_IMGWEB_FREETRAVEL_BOOK_COSTCMS_IMG_BANNERWEB_AIR_BOOK_COSTWEB_ETRAVEL_BOOK_COSTWEB_FREETRAVEL_BOOK_PEOPLES_MATERIALWEB_CURRENCYWEB_FREETRAVEL_FLIGHTWEB_ETRAVEL_ITEMWEB_SITE_MANAGER_KPI_CALLERWEB_HOTEL_PORNAME*WEB_FLIGHT_TOSTAYWEB_MEMBER_GUESTWEB_FREETRAVEL_ROUTE_CONTENT*WEB_DATUMCMS_ORDER_PROMOTIONWEB_HOTEL_FEATURE*WEB_CTRAVEL_BOOK_COSTWEB_HOTEL_ROOM*CEAIR_CTRAVELWEB_HOTEL_DISTRICTWEB_ROUTE_COMMENTWEB_ETRAVEL_BOOK_PEOPLES_MATERIALWEB_CONTINENTCODE*ELONG_HOTEL_DISTRICTCMS_PRODUCTWEB_ETRAVEL_MATERIALWEB_FREETRAVEL_BOOK_PEOPLESWEB_USERGROUPWEB_FLIGHT_CLEARWEB_HOTEL_ROOM_PRICE*CITYCODE_COUNTRYWEB_COUNTRYCODE*WEB_ETRAVEL_DESTINATIONWEB_SITE_MANAGERCMS_PRODUCT_PRICEWEB_EN_DESTINATIONWEB_BOOK_COMPACTWEB_ETRAVEL_BOOK_CLAUSEWEB_INSURANCE_CPIC_BOOKWEB_FREETRAVEL_DESTINATIONWEB_FLIGHT_OPENTICKETWEB_VOUCHER_CONSUMEWEB_FLIGHT_AIRLINEWEB_AIR_SEATS*WEB_FREETRAVEL_FLIGHT_CUSTOMERCMS_SMS_TEMPLATEWEB_HOTEL_GORUPCMS_ORDER_EVERYDAYWEB_ROUTE_HOT_DESTINATIONCEAIR_USERWEB_FREETRAVEL_FLIGHT_ROUTECMS_PRODUCT_FILECMS_NOTICEsystree*WEB_FLIGHT_PLANETYPEWEB_HOTEL_BOOK_INVOICEsysfile1*WEB_FREETRAVEL_BOOK_FEEDBACKWEB_INSURANCE_CHARTIS_BOOKDFXZ_QAWEB_HOTEL_THEMED99_TmpWEB_MEMBERWEB_TEAM_BOOK_REMARKWEB_HOTEL_BOOK_GUESTWEB_CTRAVEL_BOOK_INVOICEWEB_MEMBER_VOUCHER**WEB_INSURANCE_CX_BOOK_PERSONWEB_CTRAVEL_BOOK_ROUTE_EVERYDAYWEB_TOPICWEB_CACHE_CTRAVEL_DESTINATIONWEB_ORDERNAMEWEB_ETRAVEL_AREA*CMS_PUBLIC_CODEWEB_NEWSWEB_FLIGHT_BOOK_INVOICEWEB_FLIGHT_ROUTECMS_COUNT_ROUTECMS_ORDER_FLIGHTSWEB_HOTEL_BOOK_ACCOUNTWEB_ETRAVEL_BOOK_PEOPLES_CERTIFICATEWEB_SITE_MANAGER_CLAIMREFUND_REMARKWEB_SUPPLYWEB_VOTING_KOREA*WEB_FLIGHT_FLIGHTCMS_INSURANCECITYCODECMS_ORDER_GUEST_MATERIALWEB_QUNARHDS_HOTELCITYWEB_HOTEL_BOOK_PAYMENTWEB_LOTTERY_ORDERWEB_SITE_MANAGER_EXTNUMCMS_ORDER_OPOPERATORWEB_SITE_MANAGER_KPI_DEPTWEB_VOTING_KOREA_MOBILECHECK*CMS_PROVIDERSPELLCMS_ORDER_COSTWEB_FREETRAVEL_BOOK_INVOICESQLinWEB_COMPLAINWEB_HOTEL_BOOK_PIRCECMS_OPERATOR_ROLE_PAGEWEB_SITE_MANAGER_KPICMS_ERR_LOGWEB_SITE_MANAGER_KPI_DESCCMS_ORDER_GUESTWEB_VOTING_KOREA_WB*WEB_FLIGHT_BOOKWEB_HOTEL_PIC_ERROR*CMS_ORDER_APPOINTWEB_VOTING_KOREA_MEMBER*WEB_CACHE_ETRAVEL_DESTINATIONWEB_FREETRAVEL_BOOK_HOTELWEB_FREETRAVEL_FLIGHT_SALEWEB_AIR_PLANE*WEB_ETRAVEL_KEYWORD_STATICCMS_ORDER_OPERATORXIANGHONG_TEMP_MEMBERWEB_VOTING_KOREA_HIT*WEB_POINT_CONSUMEWEB_ETRAVEL_BOOKWEB_CTRAVEL_CITY*WEB_ETRAVEL_BOOK_CANCELLATIONMOBILE_BLOG_APPMOBILE_PRODUCT_ADVERTWEB_ORDERSTATUSWEB_ETRAVEL_BOOK_INVOICEWEB_CTRAVEL_KEYWORD_STATICMOBILE_SYSTEM_VERSIONWEB_DATUM_COUNTRYWEB_CTRAVEL_DESTINATIONWEB_ROUTE_TOPICWEB_KMGOP_BOOK*WEB_TOPIC_TEMPWEB_AIR_BOOK_PAYMENTWEB_ETRAVEL_BUSCMS_ORDERWEB_SPECIAL_ROUTE_SMSWEB_EN_INFOWEB_SMSCMS_EXPRESSWEB_ROUTE_POSITIONWEB_ETRAVEL_BOOK_PEOPLESCMS_VISA_MATERIAL_TEMPLATEWEB_EN_EXCHANGEWEB_HOTEL_BUSINESSZONEWEB_CHINAPAYWEB_EN_INFO_FLAGWEB_DEPT_SERVICE_LOGWEB_KMGOP_BOOK_EVENT*WEB_QUNARHDS_HOTELLISTWEB_EN_WEATHERWEB_AIR_FLIGHTTYPEWEB_ETRAVEL_BOOK_REMARKCMS_ORDER_EVENTWEB_FREETRAVEL_BUSWEB_HOTEL_ROOM_CACHE*WEB_FREETRAVEL_BOOK_FCTAIWAN_HOTEL*WEB_EN_CITY_CODETOPIC_314WEB_AIR_BOOK_INVOICEWEB_FREETRAVEL_ROUTE_HOTEL*WEB_ETRAVEL_KEYWORDWEB_VOTING*WEB_POINT_SALWEB_FREETRAVEL_BOOK_FCTAIWAN_FLIGHT*WEB_SPECIAL_ROUTEWEB_ROUTE_FILTERWEB_SITE_MANAGER_EXPRESS_THINGSWEB_SPECIAL_ROUTE_EMAILWEB_HOTELCMS_OPERATOR_DEPARTMENT_JOBWEB_SITE_MANAGER_KPI_OPERATIONWEB_ETRAVEL_BOOK_ROUTE_EVERYDAYWEB_INSURANCE_ALLIANZWEB_HOTEL_IMGWEB_MATERIAL_ERROR_LOGWEB_FLIGHTWEB_CITYCODE_SCENICCMS_ORDER_INSURANCEWEB_HOTEL_BOOK_REMARKWEB_FREETRAVEL_BOOK_FLIGHTWEB_HOTEL_BOOK_ITEMWEB_SITE_MANAGER_KPI_DESC_FACTNUMWEB_ETRAVEL_BOOK_ROUTECMS_OPERATOR_LOGIN_LOGWEB_CTRAVEL_BOOK_REMARKWEB_INSURANCE_CHARTISWEB_IBE_RULESELONG_HOTELWEB_AIR_INFO*WEB_FREETRAVEL_BOOK_CLAUSECMS_PRODUCT_CLAUSEWEB_AIR_MEMBER*CMS_PUBLIC_TOKENWEB_CTRAVEL_BOOK_PEOPLESWEB_INSURANCE_CPICWEB_INSURANCE_ALLIANZ_BOOKWEB_TMALL_ROUTEWEB_QUNARHDS_HOTELDETAILCMS_ORDER_DEPOSITWEB_AIR_RULES*CMS_ORDER_VISAWEB_POINT_ITEMWEB_QUNARHDS_HOTELIMAGEWEB_INSURANCE_CPIC_BOOK_PERSONWEB_QUNARHDS_HOTELLIST_OLDWEB_SCENERY_IMGWEB_MEMBER_COLLECTIONCEAIR_ETRAVEL_ROUTEWEB_FREETRAVEL_BOOK_ITEMWEB_TMALL_ROUTE_EVERYDAYWEB_QUNARHDS_CITYLIST_OLDWEB_AIR_BOOK_PEOPLESWEB_VOUCHER_TEMPLATEWEB_QUNARHDS_HOTELDETAIL_OLDWEB_BOOK_PROMOTIONWEB_ORDERSTATUS_OPERATIONWEB_FLIGHT_BOOK_COSTCMS_ORDER_INVOICE\n里面信息很多，翻了好久，然后在web_member翻到N多用户账号信息，通过得到的password解密后在主站登录发现都可以登录！！！！具体该裤子是之前的还是现在的无法查证， 厂商自行评估。另外一个危害较大的是疑似你们家运维的邮箱帐号密码被我翻出来了，还想去新网重置下密码发现不是用你们公司的邮箱注册的，目测是用aliyun的邮箱。邮箱帐号：alanqiu@satrip.com  密码 jietao 这密码强度实在不敢恭维。涉及该运维人员小米、京东账号。另外你们公司的appstore账号：\n> 账号：web@satrip.com> 密码：S马赛克8\n，应该可以替换你们家的app吧？？   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n   修复方案：  过滤，加waf！   版权声明：转载请注明来源 低调的瘦子@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：5  确认时间：2016-04-07 09:52 厂商回复： 十分感谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 5, "Ranks": null}