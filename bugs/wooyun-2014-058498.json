{"id": 2715, "wybug_id": "wooyun-2014-058498", "wybug_title": "未经用户许可以及自身保护前提下可卸载360安全卫士", "wybug_corp": "奇虎360", "wybug_author": "cat73", "wybug_date": "2014-04-28 11:20", "wybug_open_date": "2014-07-24 11:22", "wybug_type": "拒绝服务", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["拒绝服务", "客户端安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-28：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-06-22：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-07-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-24：\t细节向公众公开  简要描述： 如题啦喵~~鉴于利用过程需要特定条件 自评1吧- - 详细说明：  最近看了一本网络杂志上的一篇文章 得到了点灵感 然后就找到了一个类似的漏洞利用方式漏洞利用过程很简单 利用模拟键盘鼠标即可完成具体的 读注册表找到360的安装路径使用资源管理器打开此文件夹然后选中卸载程序 回车键打开即可(根据我看的内篇文章的分析 这样不会被拦截 如果直接运行会被拦下)然后用模拟鼠标点击即可卸载360安全卫士如果利用此漏洞同时检测用户有多久没操作电脑 超过几分钟的时候才运行卸载再做好善后工作干掉卸载反馈提示框等等甚至可以伪造一个360等等的   漏洞证明：  视频演示以及演示代码下载链接: http://pan.baidu.com/s/1eQgj4iQ 密码: oaju持久下载地址http://wydrops-wordpress.stor.sinaapp.com/uploads/2014/04/test360_pack.7z   修复方案：  你们专业的==============分割线==============我个人的建议 卸载时带上验证码   版权声明：转载请注明来源 cat73@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-07-24 11:22 厂商回复： 360安全卫士的云主防和自我保护对模拟点击运行，和模拟/消息方式操纵安全卫士组件（包括卸载程序）都有完整防护。经我们测试，白帽子报告的相关方法都会被拦截。通过观察白帽子提供的视频，我们发现白帽子应该是在X64操作系统上进行的测试。在X64操作系统上，360安全卫士的主动防御需要开启“核晶引擎”后才能提供完整防护能力（需要CPU的VT支持）。我们在X64下开启核晶引擎后，测试白帽子提供的程序，也可以正常拦截。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n          这些评论似乎很乌云~~~思密达          2014-04-30 09:54 |\t\t\t\t\txsjswt \t\t\t( 普通白帽子  | \t\t\t\t\t\tRank:156 漏洞数:49\t\t\t| 我思故我猥琐，我猥琐故我强大)\t\t\t\t\t\t\t\n  @疯狗 VT本身与X64还是X32无关，而是WIN7下，有一个很屌的机制，微软给自己带了一个铁做的避孕套，一般人都插进系统核心。所以WIN7下360只能靠所谓的核晶VT保护自己。于是逻辑是这样的。1. 非win7下，大家都可以搞驱动，搞死360分分钟2. win7 32位下，大部分cpu不支持VT，大家都不好搞，用作者的方法就能搞死3603. win7 64位下，大部分cpu可能支持VT，但是360默认没开，所以还是用作者的方法搞死360    \n   \n \n     2014-04-28 14:09 |    \t\t假马 \t\t\t( 普通白帽子  |\t\t\t        Rank:142 漏洞数:18        | 我存在,你婶婶的脑海里.)\t\t \n  霸气写肉！    \n     2014-04-28 14:16 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  核晶引擎默认情况下是开启的不？    \n     2014-04-28 17:08 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  VT开了想干嘛都可以，秒你360就更加快了    \n     2014-04-28 17:09 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  @疯狗 开了VT死得更快，所以不要管开没开VT了。    \n     2014-04-28 17:35 |    \t\tmj0011 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 360safe security researcher & programmer)\t\t \n  @xsjswt 1.开了VT后防护就完整了，驱动加载不了，也有不了VT 2.开了VT后VM被独占了，有驱动都用不了VT    \n     2014-04-28 20:21 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  赞一个     \n     2014-04-28 20:28 |    \t\tcat73 \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:6        | 喵爱吃鱼, 喵要吃好多好多鱼~~地址栏输入...)\t\t \n  @疯狗 视频演示中不就是 直接安装啥设置都没改就测试成功了还有我很纳闷的就是咋看出来的这是x64捏    \n     2014-04-28 20:30 |    \t\tcat73 \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:6        | 喵爱吃鱼, 喵要吃好多好多鱼~~地址栏输入...)\t\t \n  @xsjswt 其实我比较纳闷 模拟鼠标点击这种层面的东东跟VT这种底层的东东有啥关系- -    \n     2014-04-28 20:39 |    \t\tcat73 \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:6        | 喵爱吃鱼, 喵要吃好多好多鱼~~地址栏输入...)\t\t \n  @cat73 好吧 找到了 文件夹路径里包含(x86)字样    \n     2014-04-28 21:22 |    \t\tmj0011 \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 360safe security researcher & programmer)\t\t \n  @cat73 x64下有patchguard，常规方式比较难提供完整的防护（比如对模拟点击，需要处理系统的NtUserSendInput函数，而无论是针对Shadow SSDT挂钩或win32k inline hook都会导致被PatchGuard报警而蓝屏），360主防的核晶引擎需要使用VT技术绕过PatchGuard来实现拦截处理x86下则没有这个问题。    \n     2014-04-28 23:44 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @cat73 x64下核晶引擎是默认开启的不？开启的话是会被拦截的，要是不开启就是录像的效果咯？    \n     2014-04-29 12:13 |    \t\tcat73 \t\t\t( 实习白帽子  |\t\t\t        Rank:34 漏洞数:6        | 喵爱吃鱼, 喵要吃好多好多鱼~~地址栏输入...)\t\t \n  @mj0011 好吧 学习了 没考虑的那么深层 只是试试模拟点击能不能成来着- -    \n     2014-04-29 14:19 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  @mj0011 马甲，你神奇的粗线了    \n     2014-04-29 14:20 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  @cat73 你不懂玩底层的思路。玩底层的都觉得上层应用造成的问题都不是问题，反正我是有能力搞你的，就看我想不想搞你    \n     2014-04-29 14:21 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  @疯狗 你知道得太多了。VT默认就没几个会开，耗电。    \n     2014-04-29 14:35 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @xsjswt 也就是说这种情况能不能防不重要（x64），而是能防御此类攻击的功能默认没开（x64），用户默认情况下（x64）还是可能受到影响咯？    \n     2014-04-29 21:14 |    \t\teGirlAsm \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:2        | 其实我就是传说中风流倜傥,英俊潇洒的...屌...)\t\t \n  人家作者粗线了    \n     2014-04-30 09:54 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  @疯狗 VT本身与X64还是X32无关，而是WIN7下，有一个很屌的机制，微软给自己带了一个铁做的避孕套，一般人都插进系统核心。所以WIN7下360只能靠所谓的核晶VT保护自己。于是逻辑是这样的。1. 非win7下，大家都可以搞驱动，搞死360分分钟2. win7 32位下，大部分cpu不支持VT，大家都不好搞，用作者的方法就能搞死3603. win7 64位下，大部分cpu可能支持VT，但是360默认没开，所以还是用作者的方法搞死360    \n     2014-04-30 12:57 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  五一去研究360 这货装的时候未经用户授权 值得敲打    \n     2014-04-30 14:44 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @xsjswt 感谢分析，我终于明白了。这个用户和白帽子也清楚了，这个问题在啥条件下可能受到影响，问题圆满。    \n     2014-04-30 16:13 |    \t\tabaddon \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:10        | 我叫什么名字)\t\t \n  @xsjswt @疯狗 虽然没权限看细节 但是看各位的评论和厂商回复受益匪浅    \n     2014-04-30 16:23 |    \t\t疯狗  \t\t\t( 实习白帽子  |\t\t\t        Rank:44 漏洞数:2        | 阅尽天下漏洞，心中自然无码。)\t\t \n  @abaddon 厂商和白帽子加入互动其实会释放出更多的价值：）    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}