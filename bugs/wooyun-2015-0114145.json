{"id": 31377, "wybug_id": "wooyun-2015-0114145", "wybug_title": "易多财富P2P平台任意重置密码和支付密码（账户密码已经泄露前提）", "wybug_corp": "易多财富", "wybug_author": "孔卡", "wybug_date": "2015-05-14 18:30", "wybug_open_date": "2015-06-28 18:32", "wybug_type": "未授权访问/权限绕过", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["敏感接口缺乏认证", "越权操作"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-14：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2015-06-28：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 无需原密码或者原支付密码，直接可以修改成想要的密码 详细说明：  12306撞库事件给大家敲响了警钟，进入账户后再能任意修改支付密码该有多可怕~~~~~~这个小知识是从乌云学来的----不过自己看了几个漏洞，发现一个共性：似乎但凡有这种漏洞的地方，修改密码时应用发的POST包一般分为两步（是魔鬼的步伐……）：1.post “oldpassword”去查询 就是原密码，然后得到一个响应包，如果响应包正确的话，就会继续第2步；不正确的话，就没有然后了，提示原密码错误；2.post  “newpassword”去update，就是设置新密码了。1和2是有先后之分的OK 说了这么多 不知道理解到位不----还望各位指导。下面贴图证明吧   漏洞证明：  我们直接看修改交易密码吧，就是这里咯\n\n然后先用真正的交易密码正常修改一次，目的是为了抓取正确的响应包\n\n  这是一次post包 查询旧密码是否一致\n\n  这是正确的响应包，好的我们记录下来正确的响应包，这相当于一把万能钥匙啊\nHTTP/1.1 200 OKServer: Apache-Coyote/1.1Content-Type: application/json;charset=UTF-8Date: Thu, 14 May 2015 08:13:25 GMTContent-Length: 76{\"success\":true,\"errMsg\":null,\"otherMsg\":null,\"data\":null,\"spreadCode\":null}\n好的，接下来我们直奔主题，随便修改支付密码\n\n原来的密码随便乱输  新支付密码我设置的是1234567然后点“修改”，burp的截断开启，\n\n如上图，设置截断响应包，然后继续点击forward，准备修改响应包\n\n现在的响应包是错误的响应包，上面我已经把正确的响应包代码贴出来了，直接粘贴覆盖到现在的响应包上，点击forward即可（注意观察可发现虽然2个响应包结构类似，但其实不一样，大家来找茬...）OK，现在把截断关闭吧，剩下的数据包传输叫他按正常流程来就好，会自动update我们的新支付密码过去的。看结果\n\n现在我的支付密码是1234567了 ，怕我截图作假的话厂商可自行按步骤验证，大家伙也可以找例子验证；再看下他的post包流程，也就是我介绍里说的一步两步，是魔鬼的步伐~~\n\n更改用户密码的机制和步骤等等和更改支付密码一模一样；也就是说同一个问题出现了两次！不再赘述了。   修复方案：  程序的逻辑问题~~~说出来解决就不难了~~~为了用户资金安全，请增加支付密码等弱口令禁止录入机制   版权声明：转载请注明来源 孔卡@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n     2015-05-14 18:34 |    \t\t孔卡 \t\t\t( 实习白帽子  |\t\t\t        Rank:42 漏洞数:12        | 我已经过了那个餐桌上只有一条鸡腿就一定能...)\t\t \n  @浩天  恋锋那里的洞你说些的太复杂了，还有更简单的办法，酱紫算比较简单的不~~~~~~    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}