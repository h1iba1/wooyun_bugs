{"id": 28276, "wybug_id": "wooyun-2015-0122970", "wybug_title": "XML架构安全之航天信息股份有限公司利用XML信息读取代码可绕过登录", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "0x 80", "wybug_date": "2015-06-26 18:16", "wybug_open_date": "2015-08-14 09:50", "wybug_type": "应用配置错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["错误信息未屏蔽", "配置错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-30：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-10：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-20：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-30：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-14：\t细节向公众公开  简要描述： XML架构安全之航天信息股份有限公司利用XML信息读取代码可绕过登录读到XML各种配置信息，呵呵 详细说明：  http://ahnsfw.aisino.com/ahwsbsdt/login.jsp\n\n登陆处直接利用XML\nWEB-INF/struts-config.xml\n读到http://ahnsfw.aisino.com/ahwsbsdt/WEB-INF/struts-config.xml\n\n发现两个信息：<forward name=\"postslistforadmin\" path=\"/adminpostlist.jsp\"/><forward name=\"viewpostslist\" path=\"/postlist.jsp\"/>直接看下path的结果http://ahnsfw.aisino.com/ahwsbsdt/adminpostlist.jsp直接绕过登录了，没有做任何权限验证\n\n=========================================http://ahnsfw.aisino.com/ahwsbsdt//WEB-INF/applicationContext.xml还读到oracle敏感信息\n\n\t<bean id=\"bsdtDS\" class=\"org.apache.commons.dbcp.BasicDataSource\"\t\tdestroy-method=\"close\">\t\t<property name=\"driverClassName\">\t\t\t<value>oracle.jdbc.OracleDriver</value>\t\t</property>\t\t<property name=\"url\">\t\t\t<value>jdbc:oracle:thin:@172.16.1.196:1521:nsfwdb</value>\t\t</property>\t\t<property name=\"username\">\t\t\t<value>htxx</value>\t\t</property>\t\t<property name=\"password\">\t\t\t<value>oracle</value>\t\t</property>\t</bean>以及内网地址<property name=\"serviceUrl\" value=\"http://61.190.68.67/nssbweb_ais/RpcServlet\"/><property name=\"serviceInterface\" value=\"aisino.nssb.ejb.NSSBRpc\"/></bean><bean id=\"declarationAuthenticationService\" class=\"org.springframework.remoting.caucho.HessianProxyFactoryBean\"><property name=\"serviceUrl\" value=\"http://192.168.2.13:8011/ahwsbsdt/servlet/RpcServlet\"/><property name=\"serviceInterface\" value=\"com.aisino.ahbsdt.rpc.INssbRPC\"/></bean>   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 0x 80@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-06-30 09:49 厂商回复： CNVD确认所述情况，已经转由CNCERT下发给安徽分中心，由其后续协调网站管理单位处置。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}