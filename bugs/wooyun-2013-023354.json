{"id": 10880, "wybug_id": "wooyun-2013-023354", "wybug_title": "易想团购（easethink）sql注入漏洞", "wybug_corp": "易想团购", "wybug_author": "lxsec", "wybug_date": "2013-05-09 12:20", "wybug_open_date": "2013-08-07 12:20", "wybug_type": "SQL注射漏洞", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "未联系到厂商或者厂商积极忽略", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["第三方不可信程序", "字符类型注射", "盲注", "源码分析"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-05-09：\t积极联系厂商并且等待厂商认领中，细节不对外公开\t\t\t\t\t\t\t\t\t2013-08-07：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 意想团购存在sql注入漏洞 详细说明：  ./subscribe.php这个页面存在问题其中除了$_REQUEST['act']=='mail'选项未添加页面发送信息外，其余选项都拼接了用户发送信息。属于post表单信息。   漏洞证明：  \nelseif($_REQUEST['act']=='unsubscribe'){\t$email_code = trim($_REQUEST['code']);  //只去掉了两端预定义字符\t$email = base64_decode($email_code);   //简单的base64_decode编码 之后就带入了语句\tif($GLOBALS['db']->getOne(\"select count(*) from \".DB_PREFIX.\"mail_list where mail_address='\".$email.\"'\")==0)\t{\t\tshowErr($GLOBALS['lang']['MAIL_NOT_EXIST'],0,APP_ROOT);\t}\telse\t{\t\tsend_unsubscribe_mail($email);\t\tshowSuccess($GLOBALS['lang']['MAIL_UNSUBSCRIBE_VERIFY'],0,APP_ROOT);\t}\t}elseif($_REQUEST['act']=='dounsubscribe'){\t$email_code = trim($_REQUEST['code']); //和以上一样的错误\t$email_code =  base64_decode($email_code);\t$arr = explode(\"|\",$email_code);\t$GLOBALS['db']->query(\"delete from \".DB_PREFIX.\"mail_list where code = '\".$arr[0].\"' and mail_address = '\".$arr[1].\"'\");\t$rs = $GLOBALS['db']->affected_rows();\tif($rs)\t{\t\tshowSuccess($GLOBALS['lang']['MAIL_UNSUBSCRIBE_SUCCESS'],0,APP_ROOT);\t}\telse\t{\t\tshowErr($GLOBALS['lang']['MAIL_UNSUBSCRIBE_FAILED'],0,APP_ROOT);\t}}\n可以看到用户输入很简单的带入了sql语句中，不过最终结果并未直接显示在页面上。还是靠页面返回信息来判断语句执行是否成功   修复方案：  过滤关键字老生常谈了！   版权声明：转载请注明来源 lxsec@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 未能联系到厂商或者厂商积极拒绝  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}