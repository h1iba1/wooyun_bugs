{"id": 47862, "wybug_id": "wooyun-2014-079358", "wybug_title": "国内绝大部分Android APP存在信任所有证书漏洞", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "Guardian", "wybug_date": "2014-10-15 10:25", "wybug_open_date": "2015-01-13 10:26", "wybug_type": "非授权访问/认证绕过", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "手机软件安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-10-15：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-10-20：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-10-23：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-12-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-12-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-01-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-13：\t细节向公众公开  简要描述： 漏洞危害：信任所有证书极易导致中间人攻击，完全可以控制整个通信内容。业界公认高危漏洞。 详细说明：  当当网4处\n\n滴滴打车2处\n\n前程无忧1处\n\n   漏洞证明：  京东商城官方android客户端存在两处信任所有证书漏洞\n\n最新版天猫android客户端信任所有证书漏洞\n\n美团网官方android客户端存在两处信任所有证书漏洞\n\n新浪微盘最新版官方客户端存在信任所有证书漏洞\n\n新浪口袋乐居线上最新版android客户端存在信任所有证书漏洞\n\n中国移动最新官方飞信android客户端存在信任所有证书漏洞\n\n携程旅行网最新官方android客户端存在三处信任所有证书漏洞\n\n赶集网最新android客户端存在6处信任所有证书漏洞\n\n最新版墨迹天气android客户端存在三处信任所有证书漏洞\n\n拉手网拉手团购客户端android最新版存在5处信任所有证书漏洞\n\n大众点评-1分钱吃喝玩乐最新android客户端存在一处信任所有证书漏洞\n\n   修复方案：  升级使用的存在安全问题的SDK.改SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER为SSLSocketFactory.STRICT_HOSTNAME_VERIFIER验证。   版权声明：转载请注明来源 Guardian@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2014-10-20 08:18 厂商回复： 作为通用漏洞的案例，不再一一确认和处置，该漏洞需要由系统补丁和开发方自行进行解决。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-10-15 11:52 |    \t\tonlycjeg \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:5        | 我就看看,我不说话.)\t\t \n  有的APP，检查到证书有异常，应该就直接退出了，或者让重新下载新的版本..反    \n     2014-10-16 16:17 |    \t\tGuardian \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:20        | I'm from the Internet and be here to hel...)\t\t \n  @onlycjeg 巨汗，说的不是一码事，你是我亲哥。你讲的是apk的签名，我说的是通信过程。    \n     2014-10-16 16:21 |    \t\tGuardian \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:20        | I'm from the Internet and be here to hel...)\t\t \n  各大SRC已经着手修复，小厂商意识不到漏洞危害。sslv3漏洞是降级，而这个漏洞（具体说是开发人员安全意识的缺乏）是直接信任所有证书，中间人攻击。    \n     2014-10-20 11:17 |    \t\tGuardian \t\t\t( 实习白帽子  |\t\t\t        Rank:96 漏洞数:20        | I'm from the Internet and be here to hel...)\t\t \n  该漏洞跟系统补丁无关，是纯开发的问题，安全意识不够。    \n     2014-10-21 13:21 |    \t\tCplusHua \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:33        | 乌云奖金:-1)\t\t \n  欸。。。。不说了。那可不可以提交一个国内所有应用信任设备上已经安装根证书的xxxxxx    \n     2014-10-21 13:22 |    \t\tCplusHua \t\t\t( 普通白帽子  |\t\t\t        Rank:238 漏洞数:33        | 乌云奖金:-1)\t\t \n  @Guardian 大部分是信任的，除了app内置证书（内置证书可以修改掉。。。）问题是不是很多？    \n     2015-01-13 13:48 |    \t\tHackBraid  \t\t\t( 核心白帽子 |\t\t\t        Rank:1545 漏洞数:260        | ...........................................)\t\t \n  通过什么知识可以了解这种漏洞危害    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}