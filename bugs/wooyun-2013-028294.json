{"id": 10402, "wybug_id": "wooyun-2013-028294", "wybug_title": "上海证券交易所业务系统任意脚本文件源码读取风险", "wybug_corp": "sse.com.cn", "wybug_author": "猪猪侠", "wybug_date": "2013-07-09 13:58", "wybug_open_date": "2013-08-23 13:59", "wybug_type": "系统/服务运维配置不当", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["安全意识不足", "服务配置不当"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-07-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-07-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-07-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-08-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-08-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-08-23：\t细节向公众公开  简要描述： 上海证券交易所官网某处配置不当，导致可读取整个业务系统+主站脚本程序源码。 详细说明：  # 概述在测试过程中，发现上交所的主站与静态页面采取了负载均衡切割的架构，静态文件通过http://static.sse.com.cn这个域名来访问，而与服务器交互的动态脚本采用各业务系统的二级域，或主站的www.sse.com.cn来解析。static的配置，并不解析JSP脚本，而中间件的WEB目录却指向了真是的生产源码路径。所以，间接导致了，通过http://static.sse.com.cn/WEB-INF/web.xml 这个中间件的入口，就可以读取整个www.sse.com.cn业务线的所有脚本文件源码。# 利用1 -- 业务平台\n\n\n\n上市公司登陆接口的验证码生成文件http://biz.sse.com.cn/sseportal/cs/zhs/yzm/CreadGeneratedCode.jsp读登录接口验证码生成器的源码，间接暴力破解http://static.sse.com.cn/sseportal/cs/zhs/yzm/CreadGeneratedCode.jsp\n\n# 主站的WEB-INF/web.xml 配置信息读取\n\n# CA 认证中心http://biz.sse.com.cn/sseportal/ps/zhs/ca/ca_intro.jsphttp://static.sse.com.cn/sseportal/ps/zhs/ca/ca_intro.jsp   漏洞证明：  # EDU 二级域名频道http://edu.sse.com.cn/sseportal/newedu/jsp/c200401_p1979.jsp?INCLUEPAGE=/newedu/static/7771.jsp\n\nhttp://static.sse.com.cn/sseportal/newedu/jsp/c200401_p1979.jsphttp://static.sse.com.cn/sseportal//newedu/static/7771.jsp# bond.sse.com.cn 二级域名也可以，自由发挥。# 5万多个文件，等你来读！\n\n   修复方案：  做到完全静态隔离，而不是静态和动态的文件同步在一起。   版权声明：转载请注明来源 猪猪侠@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：11  确认时间：2013-07-13 23:21 厂商回复： 暂无 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-07-09 14:15 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  经典！！！ 没想到过这里还有逻辑！！！    \n     2013-07-09 15:25 |    \t\txsjswt \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:49        | 我思故我猥琐，我猥琐故我强大)\t\t \n  @xsser 球详情    \n     2013-07-09 17:12 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  @xsser 新玩儿法？    \n     2013-07-10 21:32 |    \t\t树熊 \t\t\t( 实习白帽子  |\t\t\t        Rank:38 漏洞数:7        | 关注技术、关注安全)\t\t \n  @xsser 求详情    \n     2013-08-13 10:29 |    \t\tPasser_by \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:21        | 问题真实存在但是影响不大（腾讯微博Passer...)\t\t \n  加雷！    \n     2013-08-23 16:26 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  看到ChinaCache我就知道怎么玩了。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 11, "Ranks": null}