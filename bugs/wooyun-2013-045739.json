{"id": 59878, "wybug_id": "wooyun-2013-045739", "wybug_title": "djcc舞曲网任意用户密码重置漏洞（已证明）", "wybug_corp": "www.dj.cc", "wybug_author": "px1624", "wybug_date": "2013-12-13 16:42", "wybug_open_date": "2013-12-18 16:43", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["逻辑错误", "重置密码", "舞曲网"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-12-13：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-12-18：\t厂商已经主动忽略漏洞，细节向公众公开  简要描述： 看到有人说你们网站给送了块表，羡慕嫉妒恨啊（虽然对我没一点用）！我是来求礼物的，为了证明漏洞的严重性与真实性，我已经去成功重置了两个官方的工作人员的帐号。 详细说明：  1 去dj.cc或者djcc.com随便注册个帐号，然后去找回密码。填写好登录邮箱和验证码后，点击找回密码，会显示给邮箱发个邮件。\n\n2 执行1中的过程同时抓包，可以看到是一个post请求，3个参数，username是邮箱，rvcode是验证码，sid猜测应该是用来校验的。\n\n3 打开邮箱，发现了那个重置密码的链接，有一个key用来校验URL。\n\n4 观察了一下，看起来是个32位的md5加密，扔到cmd5解密不出来。然后我去试着将那个post请求中的sid进行32位md5加密，与邮箱中的key对照，发现也不对。5 到这步可能很多人已经放弃了吧。不过我们怎么能这么轻易就放弃呢，然后我去试试（邮箱+sid）的组合进行md5加密，发现和邮箱中的key对应了。\n\n6 总结，看来这里的重置密码验证方式就如我上面猜测的那样，sid是用来对应用户的邮箱。然后php端的加密的代码基本就下面这句了吧。\n$key=$username.$sid;\n   漏洞证明：  上面说的那么牛逼，但是到底是不是可以呢？剑心教导过我们，不以事实说话的漏洞都是耍流氓，所以这里我们要去找几个帐号去重置下他们的密码。重置一般用户没啥意思，这里我要去重置下他们工作人员的帐号。随便在网站里转了转，发现了两个目标。1 这里重置密码的时候，不是有个客服的求助qq么，那么我们就去重置下他的密码。\n\n2 填写好后，点击找回密码并抓包。\n\n3 然后根据username和sid去生成key。\n\n4 生成key后用那个组合好的url去重置密码就可以了。\n\n5 重置好密码后，就可以随便登录了。可以看到的确是一个官方的人员。\n\n6 对账户是完全控制的节奏啊。\n\n7 djcc.com这个域名也是通杀的！用的是一个登录系统的帐号和密码。\n\n8 嘿嘿，又看到一个官方的工作人员。\n\n9 果断重置其帐号密码（注意，和上面那个不是一个帐号额，名字头像有点像而已）。\n\n   修复方案：  1 最好别用md5加密2 如果用md5加密，也不要只加密一次3 就算加密一次，也不要用这么简单的组合方式4 重置的两个工作人员的帐号是1117113@qq.com和919543721@qq.com，密码都改为了a1234565 安全无小事，却从小事做起，希望你们认真做好网站，为用户提供一个更加安全的网络空间，最后祝你们网站越来越好（ps：如果可以，可以不可以给送点礼物或者啥奖励之类的....如果不可以的话那就算了....）   版权声明：转载请注明来源 px1624@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2013-12-18 16:43 厂商回复：  最新状态： 2013-12-19：不好意思，确认晚了。已修复。  ", "replys": "漏洞评价：\n评论\n     2013-12-13 16:52 |    \t\t小川  \t\t\t( 核心白帽子 |\t\t\t        Rank:1344 漏洞数:216        | 一个致力要将乌云变成搞笑论坛的男人)\t\t \n  新厂商又要被虐    \n     2013-12-13 16:56 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小川 终于通过审核了，貌似还是走的小厂商流程。。。真悲催，都对不起我写那么多内容诶。。    \n     2013-12-13 18:46 |    \t\t小胖子  \t\t\t( 核心白帽子 |\t\t\t        Rank:1727 漏洞数:140        | 如果大海能够带走我的矮丑...)\t\t \n  多拿点公仔，我擦，好羡慕！    \n     2013-12-13 18:59 |    \t\tpx1624 \t\t\t( 普通白帽子  |\t\t\t        Rank:1036 漏洞数:175        | px1624)\t\t \n  @小胖子 诶，现在WB真难弄。。。    \n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}