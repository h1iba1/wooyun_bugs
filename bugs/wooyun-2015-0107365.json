{"id": 36303, "wybug_id": "wooyun-2015-0107365", "wybug_title": "土豆网主站存储型xss(可以批量盗取用户cookie登录)", "wybug_corp": "土豆网", "wybug_author": "梧桐雨", "wybug_date": "2015-04-12 21:51", "wybug_open_date": "2015-05-28 15:20", "wybug_type": "xss跨站脚本攻击", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "技巧"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-04-12：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-04-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-04-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-05-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-05-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-05-28：\t细节向公众公开  简要描述： 这个也是附带品。。 详细说明：  在提交的上一个漏洞，我发现看完视频。土豆有一个功能，提供下一个视频：访问:http://www.tudou.com/programs/view/wmQHmEEyM4E/在快看完视频的过程，发现居然弹窗了。\n\n\n\n跳转到的下个视频标题\n\n也就是说取决于别人对我视频的敏感度了。我思考了一下，有2个点子，可以把危害瞬间升级。1）土豆的算法是别人点击率计算视频热门度的，如果我们把视频多点击几次。就有可能把危害升级，2）另外，多推送一些http://www.tudou.com/programs/view/wmQHmEEyM4E/ 此类标题的视频，并且将播放时间设置为几秒，那么踩中我们埋下的雷就非常容易了。 概率将会大大提高。   漏洞证明：  按照上面的说明，我推送了几个类似这样的视频，审核比较慢。获取了十多个cookie，成功登录了两个。\n\n\n\n注，这里仅仅用了2个小时。如果时间越久，危害则越大。   修复方案：  过滤该功能处的xss代码。   版权声明：转载请注明来源 梧桐雨@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2015-04-13 15:19 厂商回复： 多谢梧桐雨，已提交漏洞。 最新状态： 2015-04-15：已修复  ", "replys": "漏洞评价：\n评论\n     2015-04-12 22:51 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  其实我挺喜欢洞主这个妹子的。    \n     2015-04-12 22:59 |    \t\tkeny \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:21        )\t\t \n  @明月影  他是妹子？真的假的！    \n     2015-04-12 23:15 |    \t\t机器猫 \t\t\t( 普通白帽子  |\t\t\t        Rank:1141 漏洞数:253        | 爱生活、爱腾讯、爱网络！)\t\t \n  不错    \n     2015-04-12 23:24 |    \t\t明月影 \t\t\t( 路人 |\t\t\t        Rank:12 漏洞数:8        | 学姿势，学思路。)\t\t \n  @keny 悄悄的。是她......    \n     2015-04-12 23:34 |    \t\tkeny \t\t\t( 实习白帽子  |\t\t\t        Rank:50 漏洞数:21        )\t\t \n  @明月影 我也去土豆混了，洞主  约？    \n     2015-04-12 23:36 |    \t\tssss \t\t\t( 实习白帽子  |\t\t\t        Rank:80 漏洞数:19        | 虫子是给早起的勤奋的鸟儿七的。)\t\t \n  前排组队求联系方式。。。。    \n     2015-04-13 00:37 |    \t\tizy \t\t\t( 普通白帽子  |\t\t\t        Rank:111 漏洞数:22        | http://1zy.pw/)\t\t \n  又想起优酷 xss ddos了T_T    \n     2015-04-13 01:11 |    \t\t1937nick \t\t\t( 实习白帽子  |\t\t\t        Rank:97 漏洞数:32        | 水能载舟,亦能煮粥。物尽其用,人尽其能。)\t\t \n  @keny 有女女？...    \n     2015-04-13 07:06 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:19        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  雨哥，求思路。。。。    \n     2015-04-13 08:02 |    \t\tCoody  \t\t\t( 核心白帽子 |\t\t\t        Rank:1565 漏洞数:189        | 不接单、不黑产；如遇接单收徒、绝非本人所...)\t\t \n  我是来看梧桐妹的～    \n     2015-04-13 08:45 |    \t\tganggang \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | 这个号是来乌云聊天的....)\t\t \n  这个只是附带品，真正的大头还没放出来..@土豆程序员 做好准备吧    \n     2015-04-13 09:45 |    \t\t梧桐雨  \t\t\t( 核心白帽子 |\t\t\t        Rank:1576 漏洞数:184        | 关注技术与网络安全)\t\t \n  @ganggang 这个是找浏览器漏洞捡的…我不是故意黑土豆的    \n     2015-04-13 10:00 |    \t\t’‘Nome \t\t\t( 实习白帽子  |\t\t\t        Rank:55 漏洞数:19        | 在此感谢 @M4sk @mango @裤裆 @泳少 @5up3r...)\t\t \n  @梧桐雨 雨哥，，， 每次你发洞都说是捡的，每次捡的洞都这么厉害，求神技！    \n     2015-08-07 16:56 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  你思考了一下，有2个点子，可以把危害瞬间升级。    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}