{"id": 22044, "wybug_id": "wooyun-2015-0114509", "wybug_title": "安邦保险命令执行漏洞致泄漏百套人才简历及四套内网数据库", "wybug_corp": "安邦保险集团", "wybug_author": "火风暴", "wybug_date": "2015-05-18 12:03", "wybug_open_date": "2015-07-02 18:00", "wybug_type": "系统/服务补丁不及时", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["远程命令执行"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-05-18：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-05-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-05-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-06-07：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-06-17：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-07-02：\t细节向公众公开  简要描述： 命令执行漏洞致getshll百套人才简历，含姓名、手机号、邮箱、身份证号、学历、爱好、家庭住址。目测为男屌女屌带来福利。内网四套数据库含用户名密码等字段。 详细说明：  1.struts2漏洞，getshellhttp://campus.ab95569.com/index.do\n\n\n\n2.翻翻文件，找到一些敏感的PDF文件，后来打开发现，原来是安邦人才超级交流中心的人才简历。简历信息很详细。除了个人数据外，还可借此找个女神聊聊。小伙看你啦（教给你如何口算和目测各种妹子），不要998不要880，给点rank女神男神带回家，既能么么哒还能啪啪啪。\n\n\n\n\n\n\n\n男神男神，快到碗里来\n\n3.翻查数据库配置文件，挂上WEB代理（reGeorgSocksProxy.py）,直接连接内网数据库数据库配置文件路径，如下/usr/local/tomcat/webapps/ROOT/WEB-INF/classes/spring/usr/local/tomcat/conf/context.xml\n-->        \t<Resource \t\t\t  name=\"jdbc/Recruitment\"\t\t\t  auth=\"Container\"\t\t\t  type=\"javax.sql.DataSource\"\t\t\t  factory=\"org.apache.tomcat.jdbc.pool.DataSourceFactory\"\t\t\t  testWhileIdle=\"true\"\t\t\t\t\t  testOnBorrow=\"true\"\t\t\t\t\t  testOnReturn=\"true\"\t\t\t\t\t  validationQuery=\"select 1 from dual\"\t\t\t\t\t  validationInterval=\"60000\"\t\t\t  timeBetweenEvictionRunsMillis=\"300000\"\t\t\t\t  maxActive=\"300\"\t\t\t\t\t\t\t  maxidle=\"300\"\t\t\t\t\t\t\t\t  minIdle=\"20\"\t\t\t\t\t\t\t\t  maxWait=\"10000\"\t\t\t\t\t\t\t  initialSize=\"20\" \t\t\t\t\t\t\t  removeAbandonedTimeout=\"120\"\t\t\t\t  removeAbandoned=\"true\"\t\t\t\t\t  logAbandoned=\"true\"\t\t\t\t\t\t  minEvictableIdleTimeMillis=\"300000\"\t\t\t\t  jmxEnabled=\"true\"\t\t\t  jdbcInterceptors= \"org.apache.tomcat.jdbc.pool.interceptor.ConnectionState;org.apache.tomcat.jdbc.pool.interceptor.StatementFinalizer\"\t\t\t  username=\"wangshen\"\t\t\t  password=\"wangshen123\"\t\t\t  driverClassName=\"oracle.jdbc.OracleDriver\"\t\t\t  url=\"jdbc:oracle:thin:@10.4.1.227:1521:slistest\"/> \t<Resource \t\t\t  name=\"jdbc/Rapid_Security\"\t\t\t  auth=\"Container\"\t\t\t  type=\"javax.sql.DataSource\"\t\t\t  factory=\"org.apache.tomcat.jdbc.pool.DataSourceFactory\"\t\t\t  testWhileIdle=\"true\"\t\t\t\t\t  testOnBorrow=\"true\"\t\t\t\t\t  testOnReturn=\"true\"\t\t\t\t\t  validationQuery=\"select 1 from dual\"\t\t\t\t\t  validationInterval=\"60000\"\t\t\t  timeBetweenEvictionRunsMillis=\"300000\"\t\t\t\t  maxActive=\"300\"\t\t\t\t\t\t\t  maxidle=\"300\"\t\t\t\t\t\t\t\t  minIdle=\"20\"\t\t\t\t\t\t\t\t  maxWait=\"10000\"\t\t\t\t\t\t\t  initialSize=\"20\" \t\t\t\t\t\t\t  removeAbandonedTimeout=\"120\"\t\t\t\t  removeAbandoned=\"true\"\t\t\t\t\t  logAbandoned=\"true\"\t\t\t\t\t\t  minEvictableIdleTimeMillis=\"300000\"\t\t\t\t  jmxEnabled=\"true\"\t\t\t  jdbcInterceptors= \"org.apache.tomcat.jdbc.pool.interceptor.ConnectionState;org.apache.tomcat.jdbc.pool.interceptor.StatementFinalizer\"\t\t\t  username=\"Recruitment_Job\"\t\t\t  password=\"Recruitment_123\"\t\t\t  driverClassName=\"oracle.jdbc.OracleDriver\"\t\t\t  url=\"jdbc:oracle:thin:@10.2.1.191:1521:abydkf1\"/>\n\n\n挂上WEB代理后，数据库连接器上，有mysql 有oracel\n\n\n\n\n\n\n\n\n\n\n\n4.当然还翻到一些备份文件，可以进一步跨站点渗透\n\n   漏洞证明：  见详细说明\n\n   修复方案：  1.升级struts2框架2.增强安全意识   版权声明：转载请注明来源 火风暴@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：10  确认时间：2015-05-18 17:59 厂商回复： 1、谢谢对我们工作的支持2、我们会尽快修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-05-18 17:59 |    \t\t安邦保险集团(乌云厂商)\t\t \n  很好    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 10, "Ranks": null}