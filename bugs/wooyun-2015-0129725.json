{"id": 44760, "wybug_id": "wooyun-2015-0129725", "wybug_title": "Bilibili 成功的内网漫游（用户数据库  / 后台）", "wybug_corp": "bilibili.com", "wybug_author": "Ricter", "wybug_date": "2015-07-27 16:48", "wybug_open_date": "2015-09-10 20:40", "wybug_type": "成功的入侵事件", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["渗透测试思路", "安全意识不足"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-07-27：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-07-27：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-08-06：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-08-16：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-08-26：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-09-10：\t细节向公众公开  简要描述： 从一台 CDN 到用户数据库。 详细说明：  通过寻找子域名的方式拿下一台 CDN，登陆后在 /usr/local/mincdn_cache 中的某个 nodejs cdn 系统文件存在命令执行漏洞。此漏洞通杀 B 站所有 CDN 服务器。可以进入 cp.bilibili.co。\n\n\n\n其中储存各个服务器的明文账号密码：\n\n可进入主站负载均衡服务器，从源码找到用户数据库密码：\ndefine(\"DYNAMIC_WR_HOST\",'172.16.1.100');define(\"DYNAMIC_RD_HOST\",'172.16.1.110');define(\"DYNAMIC_NAME\",'bilibili');define(\"DYNAMIC_USER\",'bilibili');define(\"DYNAMIC_PASS\",'vkBC3*********');\n可以查证，并未脱裤 :D   漏洞证明：  \n\n\n\n\n\n   修复方案：  修复命令执行漏洞即可。   版权声明：转载请注明来源 Ricter@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2015-07-27 20:39 厂商回复： 谢谢 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2015-07-27 16:50 |    \t\t小杨 \t\t\t( 路人 |\t\t\t        Rank:22 漏洞数:4        | 。)\t\t \n  mark    \n     2015-07-27 16:52 |    \t\t小孩 \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:2        | 杀器王子的小太阳)\t\t \n  憋得难受啊    \n     2015-07-27 16:55 |    \t\t染血の雪 \t\t\t( 普通白帽子  |\t\t\t        Rank:117 漏洞数:16        | 击缻)\t\t \n  我擦，我就缺一台内网的机器，不然B站所有站点全沦陷啊    \n     2015-07-27 16:56 |    \t\tRicter \t\t\t( 实习白帽子  |\t\t\t        Rank:59 漏洞数:15        | 渣渣一个)\t\t \n  @染血の雪 666    \n     2015-07-27 16:57 |    \t\terevus \t\t\t( 普通白帽子  |\t\t\t        Rank:177 漏洞数:30        | Hacked by @ringzero 我錯了)\t\t \n  @染血の雪 6666    \n     2015-07-27 17:04 |    \t\t端端 \t\t\t( 普通白帽子  |\t\t\t        Rank:133 漏洞数:18        | niconiconi~)\t\t \n  @染血の雪 666    \n     2015-07-27 17:30 |    \t\ts3xy \t\t\t( 核心白帽子 |\t\t\t        Rank:832 漏洞数:94        | 相濡以沫，不如相忘于江湖)\t\t \n  @染血の雪 666    \n     2015-07-27 22:21 |    \t\t不二 \t\t\t( 实习白帽子  |\t\t\t        Rank:58 漏洞数:5        | 如果遇到从前的我，请把他带回来。QQ:71017...)\t\t \n  @染血の雪 666。    \n     2015-07-27 22:44 |    \t\t金枪银矛小霸王 \t\t\t( 普通白帽子  |\t\t\t        Rank:103 漏洞数:25        | 不会挖洞洞的猿猿不是好学生)\t\t \n  @染血の雪 666    \n     2015-07-27 23:39 |    \t\t_Thorns \t\t\t( 普通白帽子  |\t\t\t        Rank:882 漏洞数:55        | 收wb 1：5 无限量收 [平台担保]))\t\t \n  @染血の雪 快放呀！！！    \n     2015-07-27 23:47 |    \t\t无敌L.t.H \t\t\t( 路人 |\t\t\t        Rank:21 漏洞数:4        | ‮……肉肉捉活，亭长放解)\t\t \n  CDN开始从保护后端变成了殃及后端    \n     2015-07-27 23:48 |    \t\tPyNerd \t\t\t( 普通白帽子  |\t\t\t        Rank:156 漏洞数:28        | Just for shell.)\t\t \n  居然又黑我大B站！！！    \n     2015-07-28 07:20 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:165        | 。)\t\t \n  2333     \n     2015-07-28 09:28 |    \t\t刘海哥 \t\t\t( 普通白帽子  |\t\t\t        Rank:114 漏洞数:26        | 索要联系方式但不送礼物的厂商定义为无良厂...)\t\t \n  裤子都被你扯到能看到内裤了！    \n     2015-07-30 12:46 |    \t\tdangge \t\t\t( 路人 |\t\t\t        Rank:1 漏洞数:1        | 菜鸟一枚 努力学习中。)\t\t \n  流石    \n     2015-07-30 13:11 |    \t\tredrain有节操 \t\t\t( 普通白帽子  |\t\t\t        Rank:183 漏洞数:26        | ztz这下子有165了！>_<'/&\\)\t\t \n  洞主渗透的时候我已经全程录像了，可以提供给警方！    \n     2015-07-30 13:31 |    \t\tscanf \t\t\t( 核心白帽子 |\t\t\t        Rank:1232 漏洞数:165        | 。)\t\t \n  什么？学长你被人录像了？@redrain有节操 @Ricter    \n     2015-08-17 11:14 |    \t\tBMa \t\t\t( 普通白帽子  |\t\t\t        Rank:1776 漏洞数:192        )\t\t \n  @Ricter 能不能把前面的步骤写详细点？    \n     2015-09-10 20:45 |    \t\tBeenQuiver \t\t\t( 普通白帽子  |\t\t\t        Rank:101 漏洞数:26        | 专注而高效，坚持好的习惯千万不要放弃)\t\t \n  前面怎么拿下cdn的？    \n     2015-09-11 07:23 |    \t\tBig show \t\t\t( 路人 |\t\t\t        Rank:4 漏洞数:2        | Big show)\t\t \n  能说详细点么    \n     2015-09-11 14:00 |    \t\troger \t\t\t( 路人 |\t\t\t        Rank:13 漏洞数:3        | 请多多关注！)\t\t \n  能说详细点么    \n     2015-09-11 14:37 |    \t\t-路人甲- \t\t\t( 路人 |\t\t\t        Rank:11 漏洞数:3        | 你的是我的,是我的还是我的，拿走也没用。)\t\t \n  入了和不入区别好大。    \n     2015-09-11 18:26 |    \t\t八云紫 \t\t\t( 实习白帽子  |\t\t\t        Rank:64 漏洞数:11        | 普建出长门，大建出大和)\t\t \n  666    \n     2015-09-12 12:35 |    \t\t斯杰 \t\t\t( 路人 |\t\t\t        Rank:10 漏洞数:4        | By：S丶jer)\t\t \n  竟然没脱裤    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}