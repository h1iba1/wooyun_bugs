{"id": 3301, "wybug_id": "wooyun-2014-054857", "wybug_title": "destoon最新版某敏感功能xss指哪打哪", "wybug_corp": "DESTOON", "wybug_author": "phith0n", "wybug_date": "2014-03-28 19:00", "wybug_open_date": "2014-06-26 19:01", "wybug_type": "xss跨站脚本攻击", "wybug_level": "低", "wybug_rank_0": "15", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["持久型", "存储型", "源码审核"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-03-28：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-04-01：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-04-04：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-05-26：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-06-05：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-06-15：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-06-26：\t细节向公众公开  简要描述： 之前提交过，官方说补了http://www.wooyun.org/bugs/wooyun-2014-053573于是我看看修补以后的效果。 详细说明：  这是最新版的过滤富文本xss的函数：\n\n　　已经解决了之前的问题。用expressi0n替换了expression。看似似乎没问题了。　　其实还有各种问题。IE还有一个容错特性，那就是expression，其中加斜杠\\，在IE6789上是可以触发的（当然我没测试更高版本）。所以，利用这个特性，可以绕过dsafe函数的过滤。　　这时候，我们测试：\n<img style=xss:expre\\ssion(alert(document.cookie))>\n　　照弹无误：\n\n    这是IE6789下都能触发的。比较鸡肋，来一个全部浏览器，点击触发的。利用超链接的伪协议来执行：\n<a href=javascript:alert(/a/)>click</a>\n　　dsafe函数将script过滤成了scr-pt，所以javascript就变成了javascr-pt。但还是那句老话，html属性中是可以用字符编码绕过的，所以我们可以把javascript写成java&#115;cript。　　但还有一点要注意了，dsafe函数的第一个正则是/&#([a-z0-9]+)([;]*)/i，先就考虑了你使用html实体的情况，所以java&#115;cript又会被过滤成javacript，中间少个s，啥都干不了。　　继续绕过吧。它既然把&#115;替换成了空，我们就嵌套一层，变成&&#115;#115;，这样中间的&#115;被替换成了空，正好两边的组成了一个&#115;。　　所以最后我们的poc就是：\n<a href=\"java&&#115#115;cript:alert(/a/)\">click</a>\n　　我们试试，发送一封含有该poc的短消息，就是需要点击：\n\n　　点击后触发：\n\n   漏洞证明：  见详细说明。   修复方案：  使用白名单过滤富文本。   版权声明：转载请注明来源 phith0n@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：15  确认时间：2014-04-01 08:09 厂商回复： 感谢反馈，我们会尽快修复 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2014-03-28 19:34 |    \t\t404 \t\t\t( 路人 |\t\t\t        Rank:20 漏洞数:4        )\t\t \n  T.t    \n     2014-06-26 20:02 |    \t\tMody \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:27        | \"><img src=x onerror=alert(1);> <img s...)\t\t \n  mrak了    \n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 15, "Ranks": null}