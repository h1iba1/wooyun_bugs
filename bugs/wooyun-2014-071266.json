{"id": 52426, "wybug_id": "wooyun-2014-071266", "wybug_title": "某通用型校园点播系统SQL注入", "wybug_corp": "cncert国家互联网应急中心", "wybug_author": "xlz0iza1", "wybug_date": "2014-08-06 16:01", "wybug_open_date": "2014-11-04 16:02", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "15", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2014-08-06：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2014-08-11：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2014-08-14：\t细节向第三方安全合作伙伴开放\t\t\t\t\t\t\t\t\t2014-10-05：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2014-10-15：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2014-10-25：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2014-11-04：\t细节向公众公开  简要描述： RT 详细说明：  关键词：inurl:/VOD2005文件：\\VOD2005\\VodCenter\\Videocast.asp\nDim ID\tID = SafeRequestString(\"ID\")\t'是否使用mediaplayer直接打开\tsSql = \"select SettingValue from B_B_Syssetting where SettingName='OpenLiveInMP'\"\tOpenLiveInMP = oDB.GetOneData(sSql)\t\t'---------------------------------------------------------------\t'得到直播的路径\tDim sUrl\tSet oRes = Server.CreateObject(\"ASVodIA.UniCastMng\")\tsUrl = oRes.PlayLiveFile(ID)\t\tif OpenLiveInMP = \"1\" then\t\tsUrl = oRes.DecodeURL(sUrl)\tend if\t\t\tntype = 1\tif oDB.IsMySQL() = 1 then\t\tsSql = \"select concat((case type when 1 then '广播:' else '直播:' end),Name) as name,type,liveGuid from JV_BCStations where id=\"&ID\telse\t\tsSql = \"select (case type when 1 then '广播:' else '直播:' end)+Name as  name,type,liveGuid from JV_BCStations where id=\"&ID\tend if\t'sName = oDB.GetOneData(sSql)\tset oRs = oDB.GetRecordSet(sSql)\tif not oRs is nothing then\t\tif not oRs.eof then\t\t\tntype = oRs(\"type\")\t\t\tsName = oRs(\"name\")\t\tend if\tend if\n可以看到这里的ID参数经过SafeRequestString处理。\n<!--#include virtual=\"/VOD2005/Public/Asp/CommonFun.asp\" -->\n\nFunction SafeRequestString(ParaName)\t\t    \tDim ParaValue\tDim TmpValue\tParaValue = Request(ParaName)\tTmpValue = ParaValue\tif ParaValue=\"\" then\t    SafeRequestString = ParaValue\t    Exit Function\tend if\t\t\tif not isValidStr(TmpValue) then\t    response.Write ParaName&\"=\"&ParaValue\t    response.Write \"请不要在参数中包含非法字符尝试注入！\"\t    SafeRequestString = \"\"\t    Response.End \telse\t\tParaValue=replace(ParaValue,\"'\",\"''\")\tSafeRequestString = ParaValue\tend if\n可以看到上面的过滤简直是无法直视。   漏洞证明：  相关案例：\nhttp://vod.ahlib.com/VOD2005/VodCenter/Videocast.asp?id=1http://118.112.184.145:88/VOD2005/VodCenter/Videocast.asp?id=1http://vod.whedu.net/VOD2005/VodCenter/Videocast.asp?id=1http://www.sdwhys.com/vOD2005/VodCenter/Videocast.asp?id=1http://xinzhongedu.vicp.net/vOD2005/VodCenter/Videocast.asp?id=1http://222.89.247.24:83/vOD2005/VodCenter/Videocast.asp?id=1http://www.zjk2z.cn/vOD2005/VodCenter/Videocast.asp?id=1http://v.gzqjy.cn/vOD2005/VodCenter/Videocast.asp?id=1\n案例好友很多就不一一的列举出来了，拿其中几个坐下测试。\n\n\n\n   修复方案：  过滤啊，亲~   版权声明：转载请注明来源 xlz0iza1@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：12  确认时间：2014-08-11 10:28 厂商回复： CNVD确认所述情况，暂未确认软件生产厂商或建立与厂商联系渠道，待认领。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 12, "Ranks": null}