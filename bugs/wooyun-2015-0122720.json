{"id": 28372, "wybug_id": "wooyun-2015-0122720", "wybug_title": "中国电信tv189备份服务器任意文件下载(包括前端后台)", "wybug_corp": "天翼视讯传媒有限公司", "wybug_author": "路人甲", "wybug_date": "2015-06-25 17:26", "wybug_open_date": "2015-08-13 17:56", "wybug_type": "任意文件遍历/下载", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["任意文件读取", "任意文件遍历下载"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-06-25：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-06-29：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-07-09：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-07-19：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-07-29：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-08-13：\t细节向公众公开  简要描述： 备份服务器任意文件下载暴露敏感信息by:冰箭 详细说明：  \n任意文件遍历下载，泄露源码API相关等\n\n涉及相关域名：http://taste.tv189.com /http://v.tv189.com/http://so.tv189.com/http://ifengvip.tv189.com/http://hi.tv189.com/http://my.tv189.com/http://yx.tv189.com/\n   漏洞证明：  \nhttp://180.166.93.75/preview_env/\n\n\n\n三方相关接口：腾讯 2.0接口新浪微信等\n\npublic function actionTxwbcallbacklogin()    {\t\t\theader('Content-Type: text/html; charset=utf-8');        $LogicOauth = new LogicOauth;        $mykey = Yii::app()->request->getParam($this->mykey);        $mykeys = LogicRedis::get($mykey);\t\t//var_dump($mykeys);        $last_key = $LogicOauth->getTXToken('', '', '',$mykey);\t\t$roamSystemKey = md5(Yii::app()->params['txwb'] . '_key_' . $last_key['data']['name']);\t\t$roamSystemSecret = md5(Yii::app()->params['txwb'] . '_secret_' . $last_key['data']['name']);         //第三方账户登录        $logininfo = $LogicOauth->getNewThridInfo($roamSystemKey,$roamSystemSecret,Yii::app()->params['txwb'],$last_key['data']['name']);\t\t        //var_dump($logininfo,'<br/>');exit;        if($logininfo['result'] == 0)        {            $accountinfo = $LogicOauth->getNewAccountInfo($logininfo,$logininfo['tokenId']);            if($accountinfo['result'] == 0)            {                $LogicOauth->setNewUserInfo($accountinfo['userInfos'][0],$logininfo['tokenId'],$call_back_url);                 $this->renderPartial('windowclose');               // $this->redirect('http://my.tv189.com');            }        }\t\t    }\n\nAPI:\n\n\n\n文件列表\n\n\n   修复方案：  配置修改   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：8  确认时间：2015-06-29 17:54 厂商回复： CNVD确认并复现所述情况,已经转由CNCERT向中国电信集团公司通报,由其后续协调网站管理部门处置. 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 8, "Ranks": null}