{"id": 8515, "wybug_id": "wooyun-2013-037327", "wybug_title": "中国国际航空股份有限公司多处逻辑错误", "wybug_corp": "中国国际航空股份有限公司", "wybug_author": "noah", "wybug_date": "2013-09-17 00:45", "wybug_open_date": "2013-11-01 00:45", "wybug_type": "设计缺陷/逻辑错误", "wybug_level": "高", "wybug_rank_0": "16", "wybug_status": "厂商已经确认", "wybug_from": "http://www.wooyun.org", "wybug_tags": ["设计缺陷", "逻辑错误"], "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2013-09-17：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2013-09-18：\t厂商已经确认，细节仅向厂商公开\t\t\t\t\t\t\t\t\t2013-09-28：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2013-10-08：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2013-10-18：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2013-11-01：\t细节向公众公开  简要描述： 看见厂商确认漏洞了，我也来一个 详细说明：  问题一：篡改改他人注册邮箱1、注册两账号：账号A\n\n账号B\n\n2、使用账号A登录，进行绑定邮箱操作，\n\n3、抓包将邮箱改成自己可控的邮箱，username、userid改成账户B的\n\n4、成功更改账户B的邮箱\n\n5、实际攻击环境中，我们可能只知道用户的username,userid可能无法获得，因此可以在第三步中对userid进行遍历(实测从9190000-9196639，6千个ID)\n\n6、成功修改账户B的邮箱，且账户A与账户B的邮箱一样了，可见没有对邮箱做唯一性检查就存进数据库了\n\n\n\n本来想测试下密码找回功能，但是好像邮件系统有问题，没收到重置密码的邮件。问题二：账户手机修改处验证码为4位数字，且有没重试阀值限制，导致可注册任意手机号码\n\n问题三：可随意删除他人用户设置的“乘机人管理-乘客信息”1、随便用一个账户进行“乘客信息”删除操作，并抓包\n\n2、将delID进行遍历可删除全站用户的“乘客信息”   漏洞证明：  如上   修复方案：  1、重要操作处添加验证码2、服务端对客户身份进行验证   版权声明：转载请注明来源 noah@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：中 漏洞Rank：7  确认时间：2013-09-18 16:45 厂商回复： 待确认。 最新状态： 暂无  ", "replys": "漏洞评价：\n评论\n     2013-09-17 01:10 |    \t\thacker@sina.cn \t\t\t( 普通白帽子  |\t\t\t        Rank:288 漏洞数:27        | ANONYMOUS)\t\t \n  楼下的就是基友    \n     2013-09-22 16:08 |    \t\tnoah \t\t\t( 普通白帽子  |\t\t\t        Rank:384 漏洞数:40        )\t\t \n  @中国国际航空股份有限公司  话说有礼物?    \n  \n\n\n", "wybug_level_fromcorp": "中", "wybug_rank_fromcorp": 7, "Ranks": null}